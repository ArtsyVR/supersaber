(function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};return __webpack_require__.d(getter,'a',getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p='',__webpack_require__(__webpack_require__.s=132)})([function(module){var g=function(){return this}();try{g=g||Function('return this')()||(1,eval)('this')}catch(e){'object'==typeof window&&(g=window)}module.exports=g},function(module){module.exports=function clone(obj){return JSON.parse(JSON.stringify(obj))}},function(module){module.exports.getS3FileUrl=function getS3FileUrl(id,name){return`${'https://saber.supermedium.com'}/${id}-${name}?v=1`}},function(module){var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString;module.exports=function forEach(obj,fn,ctx){if('[object Function]'!==toString.call(fn))throw new TypeError('iterator must be a function');var l=obj.length;if(l===+l)for(var i=0;i<l;i++)fn.call(ctx,obj[i],i,obj);else for(var k in obj)hasOwn.call(obj,k)&&fn.call(ctx,obj[k],k,obj)}},function(module){function defaultSetTimout(){throw new Error('setTimeout has not been defined')}function defaultClearTimeout(){throw new Error('clearTimeout has not been defined')}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;(function(){try{cachedSetTimeout='function'==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout='function'==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}})();var queue=[],draining=!1,queueIndex=-1,currentQueue;process.nextTick=function(fun){var args=Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title='browser',process.browser=!0,process.env={},process.argv=[],process.version='',process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(){return[]},process.binding=function(){throw new Error('process.binding is not supported')},process.cwd=function(){return'/'},process.chdir=function(){throw new Error('process.chdir is not supported')},process.umask=function(){return 0}},function(module,exports,__webpack_require__){'use strict';function AlgoliaSearchError(message,extraProperties){var forEach=__webpack_require__(3),error=this;'function'==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):error.stack=new Error().stack||'Cannot get a stacktrace, browser is too old',this.name='AlgoliaSearchError',this.message=message||'Unknown error',extraProperties&&forEach(extraProperties,function addToErrorObject(value,key){error[key]=value})}function createCustomError(name,message){function AlgoliaSearchCustomError(){var args=Array.prototype.slice.call(arguments,0);'string'!=typeof args[0]&&args.unshift(message),AlgoliaSearchError.apply(this,args),this.name='AlgoliaSearch'+name+'Error'}return inherits(AlgoliaSearchCustomError,AlgoliaSearchError),AlgoliaSearchCustomError}var inherits=__webpack_require__(18);inherits(AlgoliaSearchError,Error),module.exports={AlgoliaSearchError:AlgoliaSearchError,UnparsableJSON:createCustomError('UnparsableJSON','Could not parse the incoming response as JSON, see err.more for details'),RequestTimeout:createCustomError('RequestTimeout','Request timedout before getting a response'),Network:createCustomError('Network','Network issue, see err.more for details'),JSONPScriptFail:createCustomError('JSONPScriptFail','<script> was loaded but did not call our provided callback'),JSONPScriptError:createCustomError('JSONPScriptError','<script> unable to load due to an `error` event on it'),Unknown:createCustomError('Unknown','Unknown error occured')}},function(module,exports,__webpack_require__){var foreach=__webpack_require__(3);module.exports=function map(arr,fn){var newArr=[];return foreach(arr,function(item,itemIndex){newArr.push(fn(item,itemIndex,arr))}),newArr}},function(module){module.exports={OFF:'#111',RED:'#ff3a7b',BLUE:'#08bfa2',UI_ACCENT:'#08bfa2',UI_ACCENT2:'#f01978',SKY_OFF:'#297547',SKY_BLUE:'#840d42',SKY_RED:'#154136',BG_OFF:'#081a0f',BG_BLUE:'#379f5e',BG_BRIGHTBLUE:'#4fd983',BG_RED:'#ff1f81',BG_BRIGHTRED:'#ff6bb0',NEON_OFF:'#000',NEON_BLUE:'#008a70',NEON_BRIGHTBLUE:'#87c2ff',NEON_RED:'#f01978',NEON_BRIGHTRED:'#ff70b5',TEXT_OFF:'#000',TEXT_NORMAL:'#444',TEXT_BOLD:'#888',BEAT_RED:'#660338',BEAT_BLUE:'#036657',MINE_RED:'#1c060e',MINE_RED_EMISSION:'#2a0d1b',MINE_BLUE:'#011114',MINE_BLUE_EMISSION:'#072020'}},function(module,exports,__webpack_require__){(function(process){exports.log=function log(...args){return'object'==typeof console&&console.log&&console.log(...args)},exports.formatArgs=function formatArgs(args){if(args[0]=(this.useColors?'%c':'')+this.namespace+(this.useColors?' %c':' ')+args[0]+(this.useColors?'%c ':' ')+'+'+module.exports.humanize(this.diff),!this.useColors)return;const c='color: '+this.color;args.splice(1,0,c,'color: inherit');let index=0,lastC=0;args[0].replace(/%[a-zA-Z%]/g,match=>{'%%'===match||(index++,'%c'===match&&(lastC=index))}),args.splice(lastC,0,c)},exports.save=function save(namespaces){try{namespaces?exports.storage.setItem('debug',namespaces):exports.storage.removeItem('debug')}catch(error){}},exports.load=function load(){let r;try{r=exports.storage.getItem('debug')}catch(error){}return!r&&'undefined'!=typeof process&&'env'in process&&(r=process.env.DEBUG),r},exports.useColors=function useColors(){return'undefined'!=typeof window&&window.process&&('renderer'===window.process.type||window.process.__nwjs)||('undefined'!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:'undefined'!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||'undefined'!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||'undefined'!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||'undefined'!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},exports.storage=function localstorage(){try{return localStorage}catch(error){}}(),exports.colors=['#0000CC','#0000FF','#0033CC','#0033FF','#0066CC','#0066FF','#0099CC','#0099FF','#00CC00','#00CC33','#00CC66','#00CC99','#00CCCC','#00CCFF','#3300CC','#3300FF','#3333CC','#3333FF','#3366CC','#3366FF','#3399CC','#3399FF','#33CC00','#33CC33','#33CC66','#33CC99','#33CCCC','#33CCFF','#6600CC','#6600FF','#6633CC','#6633FF','#66CC00','#66CC33','#9900CC','#9900FF','#9933CC','#9933FF','#99CC00','#99CC33','#CC0000','#CC0033','#CC0066','#CC0099','#CC00CC','#CC00FF','#CC3300','#CC3333','#CC3366','#CC3399','#CC33CC','#CC33FF','#CC6600','#CC6633','#CC9900','#CC9933','#CCCC00','#CCCC33','#FF0000','#FF0033','#FF0066','#FF0099','#FF00CC','#FF00FF','#FF3300','#FF3333','#FF3366','#FF3399','#FF33CC','#FF33FF','#FF6600','#FF6633','#FF9900','#FF9933','#FFCC00','#FFCC33'],module.exports=__webpack_require__(138)(exports);const{formatters}=module.exports;formatters.j=function(v){try{return JSON.stringify(v)}catch(error){return'[UnexpectedJSONParseError]: '+error.message}}}).call(exports,__webpack_require__(4))},function(module){module.exports=Array.isArray||function(arr){return'[object Array]'==Object.prototype.toString.call(arr)}},function(module,__webpack_exports__){'use strict';const BEAT_WARMUP_SPEED=155;__webpack_exports__.a=BEAT_WARMUP_SPEED;__webpack_exports__.b=1e3*(25/BEAT_WARMUP_SPEED)},function(module){function getGridUvs(row,column,totalRows,totalColumns){const columnWidth=1/totalColumns,rowHeight=1/totalRows;return uvs[0].set(columnWidth*column,rowHeight*row+rowHeight),uvs[1].set(columnWidth*column,rowHeight*row),uvs[2].set(columnWidth*column+columnWidth,rowHeight*row),uvs[3].set(columnWidth*column+columnWidth,rowHeight*row+rowHeight),uvs}var uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2,new THREE.Vector2];AFRAME.registerComponent('atlas-uvs',{dependencies:['geometry'],schema:{totalColumns:{type:'int',default:1},totalRows:{type:'int',default:1},column:{type:'int',default:1},row:{type:'int',default:1}},update:function(){const data=this.data,uvs=getGridUvs(data.row-1,data.column-1,data.totalRows,data.totalColumns),geometry=this.el.getObject3D('mesh').geometry;geometry.faceVertexUvs[0][0][0].copy(uvs[0]),geometry.faceVertexUvs[0][0][1].copy(uvs[1]),geometry.faceVertexUvs[0][0][2].copy(uvs[3]),geometry.faceVertexUvs[0][1][0].copy(uvs[1]),geometry.faceVertexUvs[0][1][1].copy(uvs[2]),geometry.faceVertexUvs[0][1][2].copy(uvs[3]),geometry.uvsNeedUpdate=!0}}),AFRAME.registerComponent('dynamic-texture-atlas',{schema:{canvasId:{default:'dynamicAtlas'},canvasHeight:{default:1024},canvasWidth:{default:1024},debug:{default:!1},numColumns:{default:8},numRows:{default:8}},multiple:!0,init:function(){const canvas=this.canvas=document.createElement('canvas');canvas.id=this.data.canvasId,canvas.height=this.data.canvasHeight,canvas.width=this.data.canvasWidth,this.ctx=canvas.getContext('2d'),document.body.appendChild(canvas),this.data.debug&&(canvas.style.left=0,canvas.style.top=0,canvas.style.position='fixed',canvas.style.zIndex=9999999999)},drawTexture:function(image,row,column,width,height){const canvas=this.canvas,data=this.data;image.complete||(image.onload=()=>{this.drawTexture(image,row,column)});const gridHeight=height||canvas.height/data.numRows,gridWidth=width||canvas.width/data.numColumns;return this.ctx.drawImage(image,gridWidth*row,gridWidth*column,gridWidth,gridHeight),getGridUvs(row,column,data.numRows,data.numColumns)}}),module.exports.getGridUvs=getGridUvs},function(){THREE.BufferGeometryUtils={computeTangents:function(geometry){function handleTriangle(a,b,c){vA.fromArray(positions,3*a),vB.fromArray(positions,3*b),vC.fromArray(positions,3*c),uvA.fromArray(uvs,2*a),uvB.fromArray(uvs,2*b),uvC.fromArray(uvs,2*c);var x1=vB.x-vA.x,x2=vC.x-vA.x,y1=vB.y-vA.y,y2=vC.y-vA.y,z1=vB.z-vA.z,z2=vC.z-vA.z,s1=uvB.x-uvA.x,s2=uvC.x-uvA.x,t1=uvB.y-uvA.y,t2=uvC.y-uvA.y,r=1/(s1*t2-s2*t1);sdir.set((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r),tdir.set((s1*x2-s2*x1)*r,(s1*y2-s2*y1)*r,(s1*z2-s2*z1)*r),tan1[a].add(sdir),tan1[b].add(sdir),tan1[c].add(sdir),tan2[a].add(tdir),tan2[b].add(tdir),tan2[c].add(tdir)}function handleVertex(v){n.fromArray(normals,3*v),n2.copy(n),t=tan1[v],tmp.copy(t),tmp.sub(n.multiplyScalar(n.dot(t))).normalize(),tmp2.crossVectors(n2,t),test=tmp2.dot(tan2[v]),w=0>test?-1:1,tangents[4*v]=tmp.x,tangents[4*v+1]=tmp.y,tangents[4*v+2]=tmp.z,tangents[4*v+3]=w}var index=geometry.index,attributes=geometry.attributes;if(null===index||void 0===attributes.position||void 0===attributes.normal||void 0===attributes.uv)return void console.warn('THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()');var indices=index.array,positions=attributes.position.array,normals=attributes.normal.array,uvs=attributes.uv.array,nVertices=positions.length/3;attributes.tangent===void 0&&geometry.addAttribute('tangent',new THREE.BufferAttribute(new Float32Array(4*nVertices),4));for(var tangents=attributes.tangent.array,tan1=[],tan2=[],k=0;k<nVertices;k++)tan1[k]=new THREE.Vector3,tan2[k]=new THREE.Vector3;var vA=new THREE.Vector3,vB=new THREE.Vector3,vC=new THREE.Vector3,uvA=new THREE.Vector2,uvB=new THREE.Vector2,uvC=new THREE.Vector2,sdir=new THREE.Vector3,tdir=new THREE.Vector3,groups=geometry.groups;0===groups.length&&(groups=[{start:0,count:indices.length}]);for(var j=0,jl=groups.length;j<jl;++j)for(var group=groups[j],start=group.start,count=group.count,i=start,il=start+count;i<il;i+=3)handleTriangle(indices[i+0],indices[i+1],indices[i+2]);for(var tmp=new THREE.Vector3,tmp2=new THREE.Vector3,n=new THREE.Vector3,n2=new THREE.Vector3,j=0,jl=groups.length,w,t,test;j<jl;++j)for(var group=groups[j],start=group.start,count=group.count,i=start,il=start+count;i<il;i+=3)handleVertex(indices[i+0]),handleVertex(indices[i+1]),handleVertex(indices[i+2])},mergeBufferGeometries:function(geometries,useGroups){for(var isIndexed=null!==geometries[0].index,attributesUsed=new Set(Object.keys(geometries[0].attributes)),morphAttributesUsed=new Set(Object.keys(geometries[0].morphAttributes)),attributes={},morphAttributes={},mergedGeometry=new THREE.BufferGeometry,offset=0,i=0,geometry;i<geometries.length;++i){if(geometry=geometries[i],isIndexed!=(null!==geometry.index))return null;for(var name in geometry.attributes){if(!attributesUsed.has(name))return null;void 0===attributes[name]&&(attributes[name]=[]),attributes[name].push(geometry.attributes[name])}for(var name in geometry.morphAttributes){if(!morphAttributesUsed.has(name))return null;void 0===morphAttributes[name]&&(morphAttributes[name]=[]),morphAttributes[name].push(geometry.morphAttributes[name])}if(mergedGeometry.userData.mergedUserData=mergedGeometry.userData.mergedUserData||[],mergedGeometry.userData.mergedUserData.push(geometry.userData),useGroups){var count;if(isIndexed)count=geometry.index.count;else if(void 0!==geometry.attributes.position)count=geometry.attributes.position.count;else return null;mergedGeometry.addGroup(offset,count,i),offset+=count}}if(isIndexed){for(var indexOffset=0,indexList=[],i=0,index;i<geometries.length;++i){if(index=geometries[i].index,0<indexOffset){index=index.clone();for(var j=0;j<index.count;++j)index.setX(j,index.getX(j)+indexOffset)}indexList.push(index),indexOffset+=geometries[i].attributes.position.count}var mergedIndex=this.mergeBufferAttributes(indexList);if(!mergedIndex)return null;mergedGeometry.index=mergedIndex}for(var name in attributes){var mergedAttribute=this.mergeBufferAttributes(attributes[name]);if(!mergedAttribute)return null;mergedGeometry.addAttribute(name,mergedAttribute)}for(var name in morphAttributes){var numMorphTargets=morphAttributes[name][0].length;if(0===numMorphTargets)break;mergedGeometry.morphAttributes=mergedGeometry.morphAttributes||{},mergedGeometry.morphAttributes[name]=[];for(var i=0,morphAttributesToMerge;i<numMorphTargets;++i){morphAttributesToMerge=[];for(var j=0;j<morphAttributes[name].length;++j)morphAttributesToMerge.push(morphAttributes[name][j][i]);var mergedMorphAttribute=this.mergeBufferAttributes(morphAttributesToMerge);if(!mergedMorphAttribute)return null;mergedGeometry.morphAttributes[name].push(mergedMorphAttribute)}}return mergedGeometry},mergeBufferAttributes:function(attributes){for(var arrayLength=0,i=0,TypedArray,itemSize,normalized,attribute;i<attributes.length;++i){if(attribute=attributes[i],attribute.isInterleavedBufferAttribute)return null;if(void 0==TypedArray&&(TypedArray=attribute.array.constructor),TypedArray!==attribute.array.constructor)return null;if(void 0==itemSize&&(itemSize=attribute.itemSize),itemSize!==attribute.itemSize)return null;if(void 0==normalized&&(normalized=attribute.normalized),normalized!==attribute.normalized)return null;arrayLength+=attribute.array.length}for(var array=new TypedArray(arrayLength),offset=0,j=0;j<attributes.length;++j)array.set(attributes[j].array,offset),offset+=attributes[j].array.length;return new THREE.BufferAttribute(array,itemSize,normalized)}}},function(module,exports,__webpack_require__){'use strict';function createFirebaseNamespace(){function app(name){return name=name||DEFAULT_ENTRY_NAME,contains(apps_,name)||error('no-app',{name:name}),apps_[name]}function getApps(){return Object.keys(apps_).map(function(name){return apps_[name]})}function callAppHooks(app,eventName){Object.keys(factories).forEach(function(serviceName){var factoryName=useAsService(app,serviceName);null===factoryName||appHooks[factoryName]&&appHooks[factoryName](eventName,app)})}function useAsService(app,name){if('serverAuth'===name)return null;app.options;return name}var apps_={},factories={},appHooks={},namespace={__esModule:!0,initializeApp:function initializeApp(options,rawConfig){if(void 0===rawConfig&&(rawConfig={}),'object'!=typeof rawConfig||null===rawConfig){var name_1=rawConfig;rawConfig={name:name_1}}var config=rawConfig;void 0===config.name&&(config.name=DEFAULT_ENTRY_NAME);var name=config.name;'string'==typeof name&&name||error('bad-app-name',{name:name+''}),contains(apps_,name)&&error('duplicate-app',{name:name});var app=new FirebaseAppImpl(options,config,namespace);return apps_[name]=app,callAppHooks(app,'create'),app},app:app,apps:null,Promise:Promise,SDK_VERSION:'5.5.0',INTERNAL:{registerService:function registerService(name,createService,serviceProperties,appHook,allowMultipleInstances){factories[name]&&error('duplicate-service',{name:name}),factories[name]=createService,appHook&&(appHooks[name]=appHook,getApps().forEach(function(app){appHook('create',app)}));var serviceNamespace=function(appArg){return void 0===appArg&&(appArg=app()),'function'!=typeof appArg[name]&&error('invalid-app-argument',{name:name}),appArg[name]()};return void 0!==serviceProperties&&util.deepExtend(serviceNamespace,serviceProperties),namespace[name]=serviceNamespace,FirebaseAppImpl.prototype[name]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var serviceFxn=this._getService.bind(this,name);return serviceFxn.apply(this,allowMultipleInstances?args:[])},serviceNamespace},createFirebaseNamespace:createFirebaseNamespace,extendNamespace:function extendNamespace(props){util.deepExtend(namespace,props)},createSubscribe:util.createSubscribe,ErrorFactory:util.ErrorFactory,removeApp:function removeApp(name){var app=apps_[name];callAppHooks(app,'delete'),delete apps_[name]},factories:factories,useAsService:useAsService,Promise:Promise,deepExtend:util.deepExtend}};return util.patchProperty(namespace,'default',namespace),Object.defineProperty(namespace,'apps',{get:getApps}),util.patchProperty(app,'App',FirebaseAppImpl),namespace}function error(code,args){throw appErrors.create(code,args)}Object.defineProperty(exports,'__esModule',{value:!0});var util=__webpack_require__(38),contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},DEFAULT_ENTRY_NAME='[DEFAULT]',tokenListeners=[],FirebaseAppImpl=function(){function FirebaseAppImpl(options,config,firebase_){this.firebase_=firebase_,this.isDeleted_=!1,this.services_={},this.name_=config.name,this._automaticDataCollectionEnabled=config.automaticDataCollectionEnabled||!1,this.options_=util.deepCopy(options),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(callback){tokenListeners.push(callback),setTimeout(function(){return callback(null)},0)},removeAuthTokenListener:function(callback){tokenListeners=tokenListeners.filter(function(listener){return listener!==callback})}}}return Object.defineProperty(FirebaseAppImpl.prototype,'automaticDataCollectionEnabled',{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(val){this.checkDestroyed_(),this._automaticDataCollectionEnabled=val},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,'name',{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,'options',{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),FirebaseAppImpl.prototype.delete=function(){var _this=this;return new Promise(function(resolve){_this.checkDestroyed_(),resolve()}).then(function(){_this.firebase_.INTERNAL.removeApp(_this.name_);var services=[];return Object.keys(_this.services_).forEach(function(serviceKey){Object.keys(_this.services_[serviceKey]).forEach(function(instanceKey){services.push(_this.services_[serviceKey][instanceKey])})}),Promise.all(services.map(function(service){return service.INTERNAL.delete()}))}).then(function(){_this.isDeleted_=!0,_this.services_={}})},FirebaseAppImpl.prototype._getService=function(name,instanceIdentifier){if(void 0===instanceIdentifier&&(instanceIdentifier=DEFAULT_ENTRY_NAME),this.checkDestroyed_(),this.services_[name]||(this.services_[name]={}),!this.services_[name][instanceIdentifier]){var instanceSpecifier=instanceIdentifier===DEFAULT_ENTRY_NAME?void 0:instanceIdentifier,service=this.firebase_.INTERNAL.factories[name](this,this.extendApp.bind(this),instanceSpecifier);this.services_[name][instanceIdentifier]=service}return this.services_[name][instanceIdentifier]},FirebaseAppImpl.prototype.extendApp=function(props){var _this=this;util.deepExtend(this,props),props.INTERNAL&&props.INTERNAL.addAuthTokenListener&&(tokenListeners.forEach(function(listener){_this.INTERNAL.addAuthTokenListener(listener)}),tokenListeners=[])},FirebaseAppImpl.prototype.checkDestroyed_=function(){this.isDeleted_&&error('app-deleted',{name:this.name_})},FirebaseAppImpl}();FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log('dc');var appErrors=new util.ErrorFactory('app','Firebase',{"no-app":'No Firebase App \'{$name}\' has been created - '+'call Firebase App.initializeApp()',"bad-app-name":'Illegal App name: \'{$name}',"duplicate-app":'Firebase App named \'{$name}\' already exists',"app-deleted":'Firebase App named \'{$name}\' already deleted',"duplicate-service":'Firebase service named \'{$name}\' already registered',"sa-not-supported":'Initializing the Firebase SDK with a service '+'account is only allowed in a Node.js environment. On client '+'devices, you should instead initialize the SDK with an api key and '+'auth domain',"invalid-app-argument":'firebase.{$name}() takes either no argument or a '+'Firebase App instance.'}),firebase=createFirebaseNamespace();exports.firebase=firebase,exports.default=firebase},function(module){const decorations=function(){const funcMap=new WeakMap;return{add:function add(func,decorator){const parent=funcMap.has(func)?func:void 0,decoratedFunc=function(){func.apply(this,arguments)};return funcMap.set(decoratedFunc,{parent:parent,decorator:decorator}),decoratedFunc},getAll:function getAll(func){for(var iter=funcMap.get(func),decorators=[];iter!==void 0;)decorators.push(iter.decorator),iter=iter.parent;return decorators},isFunctionDecorated:function isFunctionDecorated(func){return funcMap.has(func)}}}();(function(){function executeDecoratorsOnNewComponent(component){const prot=Object.getPrototypeOf(component);Object.getOwnPropertyNames(prot).forEach(function(name){const prop=prot[name];'function'==typeof prop&&decorations.isFunctionDecorated(prop)&&decorations.getAll(prop).forEach(function(decorator){component[name]=decorator.call(component,name,prop)})})}function wrapComponent(name){const orig=AFRAME.components[name].Component;AFRAME.components[name].Component=function(){this.init=function(){delete this.init,executeDecoratorsOnNewComponent(this),this.init.apply(this,arguments)},orig.apply(this,arguments)},AFRAME.components[name].Component.prototype=orig.prototype}Object.keys(AFRAME.components).forEach(function(c){wrapComponent(c)}),function wrapRegister(){const origRegister=AFRAME.registerComponent;AFRAME.registerComponent=function(name){return origRegister.apply(AFRAME,arguments),wrapComponent(name)}}()})(),module.exports.decorate=function decorate(func,decoratorFunc){return decorations.add(func,decoratorFunc)}},function(module,exports,__webpack_require__){if('undefined'==typeof AFRAME)throw new Error('aframe-event-decorators was loaded before AFRAME was available');const eventBinder=__webpack_require__(40),decorate=__webpack_require__(14).decorate;module.exports.bindEvent=eventBinder.bindEvent,module.exports.bindEventPlayPause=eventBinder.bindEventPlayPause,module.exports.decorate=decorate},function(module,exports,__webpack_require__){module.exports=function buildSearchMethod(queryParam,url){return function search(query,args,callback){if('function'==typeof query&&'object'==typeof args||'object'==typeof callback)throw new errors.AlgoliaSearchError('index.search usage is index.search(query, params, cb)');0===arguments.length||'function'==typeof query?(callback=query,query=''):(1===arguments.length||'function'==typeof args)&&(callback=args,args=void 0),'object'==typeof query&&null!==query?(args=query,query=void 0):(void 0===query||null===query)&&(query='');var params='';void 0!==query&&(params+=queryParam+'='+encodeURIComponent(query));var additionalUA;return void 0!==args&&(args.additionalUA&&(additionalUA=args.additionalUA,delete args.additionalUA),params=this.as._getSearchParams(args,params)),this._search(params,url,callback,additionalUA)}};var errors=__webpack_require__(5)},function(module,exports,__webpack_require__){module.exports=function omit(obj,test){var keys=__webpack_require__(144),foreach=__webpack_require__(3),filtered={};return foreach(keys(obj),function doFilter(keyName){!0!==test(keyName)&&(filtered[keyName]=obj[keyName])}),filtered}},function(module){module.exports='function'==typeof Object.create?function inherits(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},function(module,__webpack_exports__,__webpack_require__){'use strict';function __values(o){var m='function'==typeof Symbol&&o[Symbol.iterator],i=0;return m?m.call(o):{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}}}function __read(o,n){var m='function'==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),ar=[],r,e;try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i['return'])&&m.call(i)}finally{if(e)throw e.error}}return ar}function __await(v){return this instanceof __await?(this.v=v,this):new __await(v)}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0}),__webpack_exports__.__extends=function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},__webpack_require__.d(__webpack_exports__,'__assign',function(){return __assign}),__webpack_exports__.__rest=function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&0>e.indexOf(p)&&(t[p]=s[p]);if(null!=s&&'function'==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)0>e.indexOf(p[i])&&(t[p[i]]=s[p[i]]);return t},__webpack_exports__.__decorate=function __decorate(decorators,target,key,desc){var c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;0<=i;i--)(d=decorators[i])&&(r=(3>c?d(r):3<c?d(target,key,r):d(target,key))||r);return 3<c&&r&&Object.defineProperty(target,key,r),r},__webpack_exports__.__param=function __param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}},__webpack_exports__.__metadata=function __metadata(metadataKey,metadataValue){if('object'==typeof Reflect&&'function'==typeof Reflect.metadata)return Reflect.metadata(metadataKey,metadataValue)},__webpack_exports__.__awaiter=function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator['throw'](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__webpack_exports__.__generator=function __generator(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError('Generator is already executing.');for(;_;)try{if(f=1,y&&(t=y[2&op[0]?'return':op[0]?'throw':'next'])&&!(t=t.call(y,op[1])).done)return t;switch((y=0,t)&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if((t=_.trys,!(t=0<t.length&&t[t.length-1]))&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue;}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var _={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},'function'==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},__webpack_exports__.__exportStar=function __exportStar(m,exports){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])},__webpack_exports__.__values=__values,__webpack_exports__.__read=__read,__webpack_exports__.__spread=function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar},__webpack_exports__.__await=__await,__webpack_exports__.__asyncGenerator=function __asyncGenerator(thisArg,_arguments,generator){function verb(n){g[n]&&(i[n]=function(v){return new Promise(function(a,b){1<q.push([n,v,a,b])||resume(n,v)})})}function resume(n,v){try{step(g[n](v))}catch(e){settle(q[0][3],e)}}function step(r){r.value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}function fulfill(value){resume('next',value)}function reject(value){resume('throw',value)}function settle(f,v){(f(v),q.shift(),q.length)&&resume(q[0][0],q[0][1])}if(!Symbol.asyncIterator)throw new TypeError('Symbol.asyncIterator is not defined.');var g=generator.apply(thisArg,_arguments||[]),q=[],i;return i={},verb('next'),verb('throw'),verb('return'),i[Symbol.asyncIterator]=function(){return this},i},__webpack_exports__.__asyncDelegator=function __asyncDelegator(o){function verb(n,f){o[n]&&(i[n]=function(v){return(p=!p)?{value:__await(o[n](v)),done:'return'===n}:f?f(v):v})}var i,p;return i={},verb('next'),verb('throw',function(e){throw e}),verb('return'),i[Symbol.iterator]=function(){return this},i},__webpack_exports__.__asyncValues=function __asyncValues(o){if(!Symbol.asyncIterator)throw new TypeError('Symbol.asyncIterator is not defined.');var m=o[Symbol.asyncIterator];return m?m.call(o):'function'==typeof __values?__values(o):o[Symbol.iterator]()},__webpack_exports__.__makeTemplateObject=function __makeTemplateObject(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,'raw',{value:raw}):cooked.raw=raw,cooked},__webpack_exports__.__importStar=function __importStar(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result},__webpack_exports__.__importDefault=function __importDefault(mod){return mod&&mod.__esModule?mod:{default:mod}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},__assign=Object.assign||function __assign(t){for(var i=1,n=arguments.length,s;i<n;i++)for(var p in s=arguments[i],s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}},function(){function copyArray(dest,source){var i;for(dest.length=0,i=0;i<source.length;i++)dest[i]=source[i]}if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var OBSERVER_CONFIG={childList:!0,attributes:!0,subtree:!0};AFRAME.registerComponent('aabb-collider',{schema:{collideNonVisible:{default:!1},debug:{default:!1},enabled:{default:!0},interval:{default:80},objects:{default:''}},init:function(){this.centerDifferenceVec3=new THREE.Vector3,this.clearedIntersectedEls=[],this.closestIntersectedEl=null,this.boundingBox=new THREE.Box3,this.boxCenter=new THREE.Vector3,this.boxHelper=new THREE.BoxHelper,this.boxMax=new THREE.Vector3,this.boxMin=new THREE.Vector3,this.hitClosestClearEventDetail={},this.hitClosestEventDetail={},this.intersectedEls=[],this.objectEls=[],this.newIntersectedEls=[],this.prevCheckTime=void 0,this.previousIntersectedEls=[],this.setDirty=this.setDirty.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.hitStartEventDetail={intersectedEls:this.newIntersectedEls}},play:function(){this.observer.observe(this.el.sceneEl,OBSERVER_CONFIG),this.el.sceneEl.addEventListener('object3dset',this.setDirty),this.el.sceneEl.addEventListener('object3dremove',this.setDirty)},remove:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener('object3dset',this.setDirty),this.el.sceneEl.removeEventListener('object3dremove',this.setDirty)},tick:function(time){var boundingBox=this.boundingBox,centerDifferenceVec3=this.centerDifferenceVec3,clearedIntersectedEls=this.clearedIntersectedEls,intersectedEls=this.intersectedEls,el=this.el,newIntersectedEls=this.newIntersectedEls,objectEls=this.objectEls,prevCheckTime=this.prevCheckTime,previousIntersectedEls=this.previousIntersectedEls,self=this,boxHelper,closestCenterDifference,newClosestEl,i;if(this.data.enabled&&!(prevCheckTime&&time-prevCheckTime<this.data.interval)){for(this.prevCheckTime=time,this.dirty&&this.refreshObjects(),boundingBox.setFromObject(el.object3D),this.boxMin.copy(boundingBox.min),this.boxMax.copy(boundingBox.max),boundingBox.getCenter(this.boxCenter),this.data.debug&&(this.boxHelper.setFromObject(el.object3D),!this.boxHelper.parent&&el.sceneEl.object3D.add(this.boxHelper)),copyArray(previousIntersectedEls,intersectedEls),intersectedEls.length=0,i=0;i<objectEls.length;i++)if(objectEls[i]!==this.el){if(!this.data.collideNonVisible&&!objectEls[i].getAttribute('visible')){this.data.debug&&(boxHelper=objectEls[i].object3D.boxHelper,boxHelper&&(el.sceneEl.object3D.remove(boxHelper),objectEls[i].object3D.boxHelper=null));continue}this.isIntersecting(objectEls[i])&&intersectedEls.push(objectEls[i])}for(newIntersectedEls.length=0,i=0;i<intersectedEls.length;i++)-1===previousIntersectedEls.indexOf(intersectedEls[i])&&newIntersectedEls.push(intersectedEls[i]);for(clearedIntersectedEls.length=0,i=0;i<previousIntersectedEls.length;i++)-1===intersectedEls.indexOf(previousIntersectedEls[i])&&(previousIntersectedEls[i].hasAttribute('aabb-collider')||previousIntersectedEls[i].emit('hitend'),clearedIntersectedEls.push(previousIntersectedEls[i]));for(i=0;i<newIntersectedEls.length;i++)newIntersectedEls[i]!==this.el&&(newIntersectedEls[i].hasAttribute('aabb-collider')||newIntersectedEls[i].emit('hitstart'));for(i=0;i<intersectedEls.length;i++)intersectedEls[i]!==this.el&&(centerDifferenceVec3.copy(intersectedEls[i].object3D.boundingBoxCenter).sub(this.boxCenter),(void 0==closestCenterDifference||centerDifferenceVec3.length()<closestCenterDifference)&&(closestCenterDifference=centerDifferenceVec3.length(),newClosestEl=intersectedEls[i]));!intersectedEls.length&&this.closestIntersectedEl?(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit('hitclosestclear'),this.closestIntersectedEl=null,el.emit('hitclosestclear',this.hitClosestClearEventDetail)):newClosestEl!==this.closestIntersectedEl&&(this.closestIntersectedEl&&(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit('hitclosestclear',this.hitClosestClearEventDetail)),newClosestEl&&(newClosestEl.emit('hitclosest'),this.closestIntersectedEl=newClosestEl,this.hitClosestEventDetail.el=newClosestEl,el.emit('hitclosest',this.hitClosestEventDetail))),clearedIntersectedEls.length&&el.emit('hitend'),newIntersectedEls.length&&el.emit('hitstart',this.hitStartEventDetail)}},isIntersecting:function(){var boundingBox=new THREE.Box3;return function(el){var boxMin,boxMax;return boundingBox.setFromObject(el.object3D),this.data.debug&&(!el.object3D.boxHelper&&(el.object3D.boxHelper=new THREE.BoxHelper(el.object3D,new THREE.Color(Math.random(),Math.random(),Math.random())),el.sceneEl.object3D.add(el.object3D.boxHelper)),el.object3D.boxHelper.setFromObject(el.object3D)),boxMin=boundingBox.min,boxMax=boundingBox.max,el.object3D.boundingBoxCenter=el.object3D.boundingBoxCenter||new THREE.Vector3,boundingBox.getCenter(el.object3D.boundingBoxCenter),this.boxMin.x<=boxMax.x&&this.boxMax.x>=boxMin.x&&this.boxMin.y<=boxMax.y&&this.boxMax.y>=boxMin.y&&this.boxMin.z<=boxMax.z&&this.boxMax.z>=boxMin.z}}(),setDirty:function(){this.dirty=!0},refreshObjects:function(){var data=this.data;this.objectEls=data.objects?this.el.sceneEl.querySelectorAll(data.objects):this.el.sceneEl.children,this.dirty=!1}})},function(){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var audioBufferCache={};AFRAME.registerComponent('audioanalyser',{schema:{buffer:{default:!1},beatDetectionDecay:{default:0.99},beatDetectionMinVolume:{default:15},beatDetectionThrottle:{default:250},enabled:{default:!0},enableBeatDetection:{default:!0},enableLevels:{default:!0},enableWaveform:{default:!0},enableVolume:{default:!0},fftSize:{default:2048},smoothingTimeConstant:{default:0.8},src:{parse:function(val){return val.constructor===String?val.startsWith('#')||val.startsWith('.')?document.querySelector(val):val:val}},unique:{default:!1}},init:function(){var data=this.data,analyser,gainNode;this.audioEl=null,this.context=new AudioContext,this.levels=null,this.waveform=null,this.volume=0,this.xhr=null,analyser=this.analyser=this.context.createAnalyser(),gainNode=this.gainNode=this.context.createGain(),gainNode.connect(analyser),analyser.connect(this.context.destination),analyser.fftSize=data.fftSize,analyser.smoothingTimeConstant=data.smoothingTimeConstant,this.levels=new Uint8Array(analyser.frequencyBinCount),this.waveform=new Uint8Array(analyser.fftSize)},update:function(oldData){var analyser=this.analyser,data=this.data;(oldData.fftSize!==data.fftSize||oldData.smoothingTimeConstant!==data.smoothingTimeConstant)&&(analyser.fftSize=data.fftSize,analyser.smoothingTimeConstant=data.smoothingTimeConstant,this.levels=new Uint8Array(analyser.frequencyBinCount),this.waveform=new Uint8Array(analyser.fftSize));data.src&&this.refreshSource()},tick:function(t,dt){var data=this.data,volume;if(data.enabled){if((data.enableLevels||data.enableVolume)&&this.analyser.getByteFrequencyData(this.levels),data.enableWaveform&&this.analyser.getByteTimeDomainData(this.waveform),data.enableVolume||data.enableBeatDetection){for(var sum=0,i=0;i<this.levels.length;i++)sum+=this.levels[i];this.volume=sum/this.levels.length}data.enableBeatDetection&&(volume=this.volume,!this.beatCutOff&&(this.beatCutOff=volume),volume>this.beatCutOff&&volume>this.data.beatDetectionMinVolume?(this.el.emit('audioanalyserbeat',null,!1),this.beatCutOff=1.5*volume,this.beatTime=0):this.beatTime<=this.data.beatDetectionThrottle?this.beatTime+=dt:(this.beatCutOff*=this.data.beatDetectionDecay,this.beatCutOff=Math.max(this.beatCutOff,this.data.beatDetectionMinVolume)))}},refreshSource:function(){var analyser=this.analyser,data=this.data;data.buffer&&data.src.constructor===String?this.getBufferSource().then(source=>{this.source=source,this.source.connect(this.gainNode)}):(this.source=this.getMediaSource(),this.source.connect(this.gainNode))},suspendContext:function(){this.context.suspend()},resumeContext:function(){this.context.resume()},fetchAudioBuffer:function(src){return audioBufferCache[src]?audioBufferCache[src].constructor===Promise?audioBufferCache[src]:Promise.resolve(audioBufferCache[src]):(audioBufferCache[src]=new Promise(resolve=>{const xhr=this.xhr=new XMLHttpRequest;xhr.open('GET',src),xhr.responseType='arraybuffer',xhr.addEventListener('load',()=>{this.context.decodeAudioData(xhr.response).then(audioBuffer=>{audioBufferCache[src]=audioBuffer,resolve(audioBuffer)}).catch(console.error)}),xhr.send()}),audioBufferCache[src])},getBufferSource:function(){var data=this.data;return this.fetchAudioBuffer(data.src).then(()=>{var source;return source=this.context.createBufferSource(),source.buffer=audioBufferCache[data.src],this.el.emit('audioanalyserbuffersource',source,!1),source}).catch(console.error)},getMediaSource:function(){return this.data.src.constructor===String?(!this.audio&&(this.audio=document.createElement('audio'),this.audio.crossOrigin='anonymous'),this.audio.setAttribute('src',this.data.src)):this.audio=this.data.src,this.context.createMediaElementSource(this.audio)}})},function(){var styleParser=AFRAME.utils.styleParser;if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('event-set',{schema:{default:'',parse:function(value){return styleParser.parse(value)}},multiple:!0,init:function(){this.eventHandler=null,this.eventName=null},update:function(){this.removeEventListener(),this.updateEventListener(),this.addEventListener()},remove:function(){this.removeEventListener()},pause:function(){this.removeEventListener()},play:function(){this.addEventListener()},updateEventListener:function(){var data=this.data,el=this.el,event,target,targetEl;event=data._event||this.id,target=data._target,targetEl=target?el.sceneEl.querySelector(target):el,this.eventName=event,this.eventHandler=function handler(){for(var propName in data)'_event'!==propName&&'_target'!==propName&&AFRAME.utils.entity.setComponentProperty.call(this,targetEl,propName,data[propName])}},addEventListener:function(){this.el.addEventListener(this.eventName,this.eventHandler)},removeEventListener:function(){this.el.removeEventListener(this.eventName,this.eventHandler)}})},function(module,exports,__webpack_require__){THREE.BufferGeometryUtils||__webpack_require__(41),AFRAME.registerComponent('geometry-merger',{schema:{preserveOriginal:{default:!1}},init:function(){var self=this;this.geometry=new THREE.Geometry,this.mesh=new THREE.Mesh(this.geometry),this.el.setObject3D('mesh',this.mesh),this.faceIndex={},this.vertexIndex={},this.el.object3D.traverse(function(mesh){'Mesh'!==mesh.type||mesh===self.mesh||(self.faceIndex[mesh.parent.uuid]=[self.geometry.faces.length,self.geometry.faces.length+mesh.geometry.faces.length-1],self.vertexIndex[mesh.parent.uuid]=[self.geometry.vertices.length,self.geometry.vertices.length+mesh.geometry.vertices.length-1],mesh.parent.updateMatrix(),self.geometry.merge(mesh.geometry,mesh.parent.matrix),!self.data.preserveOriginal&&mesh.parent.remove(mesh))})}}),AFRAME.registerComponent('buffer-geometry-merger',{schema:{preserveOriginal:{default:!1}},init:function(){var geometries=[];this.el.sceneEl.object3D.updateMatrixWorld(),this.el.object3D.traverse(function(mesh){'Mesh'!==mesh.type||mesh.el===self.el||(mesh.geometry.applyMatrix(mesh.matrixWorld),geometries.push(mesh.geometry.clone()),mesh.parent.remove(mesh))});const geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);this.mesh=new THREE.Mesh(geometry),this.el.setObject3D('mesh',this.mesh)}})},function(){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('haptics',{dependencies:['tracked-controls'],schema:{actuatorIndex:{default:0},dur:{default:100},enabled:{default:!0},events:{type:'array'},eventsFrom:{type:'string'},force:{default:1}},multiple:!0,init:function(){var data=this.data,self=this;if(this.callPulse=function(){self.pulse()},this.el.components['tracked-controls'].controller){if(this.gamepad=this.el.components['tracked-controls'].controller,!this.gamepad||!this.gamepad.hapticActuators.length)return;this.addEventListeners()}else this.el.addEventListener('controllerconnected',function init(){setTimeout(function(){self.gamepad=self.el.components['tracked-controls'].controller,self.gamepad&&self.gamepad.hapticActuators.length&&self.addEventListeners()},150)})},remove:function(){this.removeEventListeners()},pulse:function(force,dur){var data=this.data,actuator;data.enabled&&this.gamepad&&this.gamepad.hapticActuators&&(actuator=this.gamepad.hapticActuators[data.actuatorIndex],actuator.pulse(force||data.force,dur||data.dur))},addEventListeners:function(){var data=this.data,i,listenTarget;for(listenTarget=data.eventsFrom?document.querySelector(data.eventsFrom):this.el,i=0;i<data.events.length;i++)listenTarget.addEventListener(data.events[i],this.callPulse)},removeEventListeners:function(){var data=this.data,i,listenTarget;for(listenTarget=data.eventsFrom?document.querySelector(data.eventsFrom):this.el,i=0;i<data.events.length;i++)listenTarget.removeEventListener(data.events[i],this.callPulse)}})},function(module){function getBoxPositions(data,numChildren,marginDefined){var rows=Math.ceil(numChildren/data.columns),column,marginColumn,marginRow,offsetColumn,offsetRow,row;for(marginColumn=data.marginColumn,marginRow=data.marginRow,marginDefined&&(marginColumn=data.margin,marginRow=data.margin),offsetRow=getOffsetItemIndex(data.align,rows),offsetColumn=getOffsetItemIndex(data.align,data.columns),row=0;row<rows;row++)for(column=0;column<data.columns;column++)positionHelper.set(0,0,0),0===data.plane.indexOf('x')&&(positionHelper.x=(column-offsetColumn)*marginColumn),0===data.plane.indexOf('y')&&(positionHelper.y=(column-offsetColumn)*marginColumn),1===data.plane.indexOf('y')&&(positionHelper.y=(row-offsetRow)*marginRow),1===data.plane.indexOf('z')&&(positionHelper.z=(row-offsetRow)*marginRow),pushPositionVec3(positionHelper);return positions}function getCirclePositions(data,numChildren){var i,rad;for(i=0;i<numChildren;i++)rad,rad=isNaN(data.angle)?i*(2*Math.PI)/numChildren:0.01745329252*(i*data.angle),positionHelper.set(0,0,0),0===data.plane.indexOf('x')&&(positionHelper.x=data.radius*_Mathcos(rad)),0===data.plane.indexOf('y')&&(positionHelper.y=data.radius*_Mathcos(rad)),1===data.plane.indexOf('y')&&(positionHelper.y=data.radius*_Mathsin(rad)),1===data.plane.indexOf('z')&&(positionHelper.z=data.radius*_Mathsin(rad)),pushPositionVec3(positionHelper);return positions}function getLinePositions(data,numChildren){return data.columns=numChildren,getBoxPositions(data,numChildren,!0)}function getCubePositions(data){return pushPositions(1,0,0,0,1,0,0,0,1,-1,0,0,0,-1,0,0,0,-1),scalePositions(data.radius/2),positions}function getDodecahedronPositions(data){var PHI=(1+2.23606797749979)/2,B=1/PHI,C=2-PHI,NB=-1*B,NC=-1*C;return pushPositions(-1,C,0,-1,NC,0,0,-1,C,0,-1,NC,0,1,C,0,1,NC,1,C,0,1,NC,0,B,B,B,B,B,NB,B,NB,B,B,NB,NB,C,0,1,C,0,-1,NB,B,B,NB,B,NB,NB,NB,B,NB,NB,NB,NC,0,1,NC,0,-1),scalePositions(data.radius/2),positions}function getPyramidPositions(data){var NEG_SQRT_1_3=-1/1.7320508075688772;return pushPositions(0,0,1.7320508075688772+NEG_SQRT_1_3,-1,0,NEG_SQRT_1_3,1,0,NEG_SQRT_1_3,0,2*0.816496580927726,0),scalePositions(data.radius/2),positions}function getOffsetItemIndex(align,numItems){return'start'===align?numItems-1:'center'===align?(numItems-1)/2:'end'===align?0:void 0}function scalePositions(scale){var i;for(i=0;i<positions.length;i++)positions[i]*=scale}function setPositions(els,positions,orderAttribute){var value,i,orderIndex;if(orderAttribute){for(i=0;i<els.length;i++)(value=els[i].getAttribute(orderAttribute),null!==value&&void 0!==value)&&(orderIndex=3*parseInt(value,10),els[i].object3D.position.set(positions[orderIndex],positions[orderIndex+1],positions[orderIndex+2]));return}for(i=0;i<positions.length;i+=3){if(!els[i/3])return;els[i/3].object3D.position.set(positions[i],positions[i+1],positions[i+2])}}function pushPositions(){var i;for(i=0;i<arguments.length;i++)positions.push(i)}function pushPositionVec3(vec3){positions.push(vec3.x),positions.push(vec3.y),positions.push(vec3.z)}var _Mathsin=Math.sin,_Mathcos=Math.cos,positions=[],positionHelper=new THREE.Vector3;AFRAME.registerComponent('layout',{schema:{angle:{type:'number',default:!1,min:0,max:360,if:{type:['circle']}},columns:{default:1,min:0,if:{type:['box']}},margin:{default:1,min:0,if:{type:['box','line']}},marginColumn:{default:1,min:0,if:{type:['box']}},marginRow:{default:1,min:0,if:{type:['box']}},orderAttribute:{default:''},plane:{default:'xy'},radius:{default:1,min:0,if:{type:['circle','cube','dodecahedron','pyramid']}},reverse:{default:!1},type:{default:'line',oneOf:['box','circle','cube','dodecahedron','line','pyramid']},fill:{default:!0,if:{type:['circle']}},align:{default:'end',oneOf:['start','center','end']}},init:function(){var self=this,el=this.el;this.children=el.getChildEntities(),this.initialPositions=[],this.children.forEach(function getInitialPositions(childEl){function _getPositions(){self.initialPositions.push(childEl.object3D.position.x),self.initialPositions.push(childEl.object3D.position.y),self.initialPositions.push(childEl.object3D.position.z)}return childEl.hasLoaded?_getPositions():void childEl.addEventListener('loaded',_getPositions)}),this.handleChildAttached=this.handleChildAttached.bind(this),this.handleChildDetached=this.handleChildDetached.bind(this),el.addEventListener('child-attached',this.handleChildAttached),el.addEventListener('child-detached',this.handleChildDetached),el.addEventListener('layoutrefresh',this.update.bind(this))},update:function(){var children=this.children,data=this.data,el=this.el,definedData,numChildren,positionFn;switch(numChildren=children.length,data.type){case'box':{positionFn=getBoxPositions;break}case'circle':{positionFn=getCirclePositions;break}case'cube':{positionFn=getCubePositions;break}case'dodecahedron':{positionFn=getDodecahedronPositions;break}case'pyramid':{positionFn=getPyramidPositions;break}default:positionFn=getLinePositions;}definedData=el.getDOMAttribute('layout'),positions.length=0,positions=positionFn(data,numChildren,'string'==typeof definedData?-1!==definedData.indexOf('margin'):'margin'in definedData),data.reverse&&positions.reverse(),setPositions(children,positions,data.orderAttribute)},remove:function(){this.el.removeEventListener('child-attached',this.handleChildAttached),this.el.removeEventListener('child-detached',this.handleChildDetached),setPositions(this.children,this.initialPositions)},handleChildAttached:function(evt){var el=this.el;evt.detail.el.parentNode!==el||(this.children.push(evt.detail.el),this.update())},handleChildDetached:function(evt){-1===this.children.indexOf(evt.detail.el)||(this.children.splice(this.children.indexOf(evt.detail.el),1),this.initialPositions.splice(this.children.indexOf(evt.detail.el),1),this.update())}}),module.exports.getBoxPositions=getBoxPositions,module.exports.getCirclePositions=getCirclePositions,module.exports.getLinePositions=getLinePositions,module.exports.getCubePositions=getCubePositions,module.exports.getDodecahedronPositions=getDodecahedronPositions,module.exports.getPyramidPositions=getPyramidPositions},function(module,exports,__webpack_require__){__webpack_require__(42),AFRAME.registerComponent('orbit-controls',{dependencies:['camera'],schema:{autoRotate:{type:'boolean'},autoRotateSpeed:{default:2},dampingFactor:{default:0.1},enabled:{default:!0},enableDamping:{default:!0},enableKeys:{default:!0},enablePan:{default:!0},enableRotate:{default:!0},enableZoom:{default:!0},initialPosition:{type:'vec3'},keyPanSpeed:{default:7},minAzimuthAngle:{type:'number',default:Infinity},maxAzimuthAngle:{type:'number',default:Infinity},maxDistance:{default:1e3},maxPolarAngle:{default:AFRAME.utils.device.isMobile()?90:120},minDistance:{default:1},minPolarAngle:{default:0},minZoom:{default:0},panSpeed:{default:1},rotateSpeed:{default:0.05},screenSpacePanning:{default:!1},target:{type:'vec3'},zoomSpeed:{default:0.5}},init:function(){var el=this.el,oldPosition;this.controls=new THREE.OrbitControls(el.getObject3D('camera'),el.sceneEl.renderer.domElement),oldPosition=new THREE.Vector3,el.sceneEl.addEventListener('enter-vr',()=>{(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!1,el.hasAttribute('look-controls')&&(el.setAttribute('look-controls','enabled',!0),oldPosition.copy(el.getObject3D('camera').position),el.getObject3D('camera').position.set(0,0,0)))}),el.sceneEl.addEventListener('exit-vr',()=>{(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!0,el.getObject3D('camera').position.copy(oldPosition),el.hasAttribute('look-controls')&&el.setAttribute('look-controls','enabled',!1))}),document.body.style.cursor='grab',document.addEventListener('mousedown',()=>{document.body.style.cursor='grabbing'}),document.addEventListener('mouseup',()=>{document.body.style.cursor='grab'}),this.target=new THREE.Vector3,el.getObject3D('camera').position.copy(this.data.initialPosition)},update:function(){var controls=this.controls,data=this.data;controls.target=this.target.copy(data.target),controls.autoRotate=data.autoRotate,controls.autoRotateSpeed=data.autoRotateSpeed,controls.dampingFactor=data.dampingFactor,controls.enabled=data.enabled,controls.enableDamping=data.enableDamping,controls.enableKeys=data.enableKeys,controls.enablePan=data.enablePan,controls.enableRotate=data.enableRotate,controls.enableZoom=data.enableZoom,controls.keyPanSpeed=data.keyPanSpeed,controls.maxPolarAngle=THREE.Math.degToRad(data.maxPolarAngle),controls.maxDistance=data.maxDistance,controls.minDistance=data.minDistance,controls.minPolarAngle=THREE.Math.degToRad(data.minPolarAngle),controls.minZoom=data.minZoom,controls.panSpeed=data.panSpeed,controls.rotateSpeed=data.rotateSpeed,controls.screenSpacePanning=data.screenSpacePanning,controls.zoomSpeed=data.zoomSpeed},tick:function(){var controls=this.controls,data=this.data;!data.enabled||controls.enabled&&(controls.enableDamping||controls.autoRotate)&&this.controls.update()}})},function(){AFRAME.registerComponent('proxy-event',{schema:{captureBubbles:{default:!1},enabled:{default:!0},event:{type:'string'},from:{type:'string'},to:{type:'string'},as:{type:'string'},bubbles:{default:!1}},multiple:!0,init:function(){var data=this.data,el=this.el,self=this,from,i,to;if(data.from?'PARENT'===data.from?from=[el.parentNode]:from=document.querySelectorAll(data.from):'CHILDREN'===data.to?to=el.querySelectorAll('*'):'SELF'===data.to?to=[el]:to=document.querySelectorAll(data.to),data.from)for(i=0;i<from.length;i++)this.addEventListenerFrom(from[i]);else el.addEventListener(data.event,function(evt){var data=self.data;if(data.enabled&&(data.captureBubbles||evt.target===el))for(i=0;i<to.length;i++)to[i].emit(data.as||data.event,evt.detail?evt.detail:null,data.bubbles)})},addEventListenerFrom:function(fromEl){var data=this.data,self=this;fromEl.addEventListener(data.event,function(evt){var data=self.data;data.enabled&&(data.captureBubbles||evt.target===fromEl)&&self.el.emit(data.as||data.event,evt.detail?evt.detail:null,!1)})}})},function(module){(function webpackUniversalModuleDefinition(root,factory){module.exports=factory()})('undefined'==typeof self?this:self,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};return __webpack_require__.d(getter,'a',getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p='',__webpack_require__(__webpack_require__.s=0)}([function(module,exports,__webpack_require__){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerShader('ring',{schema:{blur:{default:0.01,is:'uniform'},color:{type:'color',is:'uniform'},progress:{default:0,is:'uniform'},radiusInner:{default:0.85,is:'uniform'},radiusOuter:{default:1,is:'uniform'}},vertexShader:__webpack_require__(1),fragmentShader:__webpack_require__(2)})},function(module){module.exports='varying vec2 vUv;\n\nvoid main () {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n'},function(module){module.exports='#define PI 3.14159265358979\nuniform float blur;\nuniform float progress;\nuniform float radiusInner;\nuniform float radiusOuter;\nuniform vec3 color;\n\nvarying vec2 vUv;\n\nvoid main () {\n  vec2 uv = vec2(vUv.x * 2. - 1., vUv.y * 2. - 1.);\n  float r = uv.x * uv.x + uv.y * uv.y;\n  float col = (1.0 - smoothstep(radiusOuter, radiusOuter + blur, r)) * smoothstep(radiusInner, radiusInner + blur, r);\n  float a = smoothstep(-PI, PI, atan(uv.y, uv.x));\n  float p = 1.0 - progress - blur;\n  col *= smoothstep(p, p + blur, a);\n  gl_FragColor = vec4(color * col, col);\n}\n'}])})},function(){function parseSide(side){return'back'===side?THREE.BackSide:'double'===side?THREE.DoubleSide:THREE.FrontSide}if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('slice9',{schema:{width:{default:1,min:0},height:{default:1,min:0},left:{default:0,min:0},right:{default:0,min:0},bottom:{default:0,min:0},top:{default:0,min:0},side:{default:'front',oneOf:['front','back','double']},padding:{default:0.1,min:0.01},color:{type:'color',default:'#fff'},opacity:{default:1,min:0,max:1},transparent:{default:!0},debug:{default:!1},src:{type:'map'}},multiple:!1,init:function(){var data=this.data,material=this.material=new THREE.MeshBasicMaterial({color:data.color,opacity:data.opacity,transparent:data.transparent,wireframe:data.debug}),geometry=this.geometry=new THREE.PlaneBufferGeometry(data.width,data.height,3,3),textureLoader=new THREE.TextureLoader;this.plane=new THREE.Mesh(geometry,material),this.el.setObject3D('mesh',this.plane),this.textureSrc=null},updateMap:function(){function setMap(texture){this.material.map=texture,this.material.needsUpdate=!0,this.regenerateMesh()}var src=this.data.src;return src?src===this.textureSrc?void 0:(this.textureSrc=src,void this.el.sceneEl.systems.material.loadTexture(src,{src:src},setMap.bind(this))):void(!this.material.map||setMap(null))},regenerateMesh:function(){function setPos(id,x,y){pos[3*id]=x,pos[3*id+1]=y}function setUV(id,u,v){uvs[2*id]=u,uvs[2*id+1]=v}var data=this.data,pos=this.geometry.attributes.position.array,uvs=this.geometry.attributes.uv.array,image=this.material.map.image;if(image){var uv={left:data.left/image.width,right:data.right/image.width,top:data.top/image.height,bottom:data.bottom/image.height};setUV(1,uv.left,1),setUV(2,uv.right,1),setUV(4,0,uv.bottom),setUV(5,uv.left,uv.bottom),setUV(6,uv.right,uv.bottom),setUV(7,1,uv.bottom),setUV(8,0,uv.top),setUV(9,uv.left,uv.top),setUV(10,uv.right,uv.top),setUV(11,1,uv.top),setUV(13,uv.left,0),setUV(14,uv.right,0);var w2=data.width/2,h2=data.height/2,left=-w2+data.padding,right=w2-data.padding,top=h2-data.padding,bottom=-h2+data.padding;setPos(0,-w2,h2),setPos(1,left,h2),setPos(2,right,h2),setPos(3,w2,h2),setPos(4,-w2,top),setPos(5,left,top),setPos(6,right,top),setPos(7,w2,top),setPos(8,-w2,bottom),setPos(9,left,bottom),setPos(10,right,bottom),setPos(11,w2,bottom),setPos(13,left,-h2),setPos(14,right,-h2),setPos(12,-w2,-h2),setPos(15,w2,-h2),this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0}},update:function(oldData){var data=this.data;this.material.color.setStyle(data.color),this.material.opacity=data.opacity,this.material.transparent=data.transparent,this.material.wireframe=data.debug,this.material.side=parseSide(data.side);var diff=AFRAME.utils.diff(data,oldData);'src'in diff?this.updateMap():('width'in diff||'height'in diff||'padding'in diff||'left'in diff||'top'in diff||'bottom'in diff||'right'in diff)&&this.regenerateMesh()},remove:function(){},pause:function(){},play:function(){}})},function(module){(function webpackUniversalModuleDefinition(root,factory){module.exports=factory()})('undefined'==typeof self?this:self,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};return __webpack_require__.d(getter,'a',getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p='',__webpack_require__(__webpack_require__.s=1)}([function(module){'use strict';function generateExpression(str){return str=str.replace(DOT_NOTATION_RE,'["$1"]'),str=str.replace(ROOT_STATE_SELECTOR_RE,'$1state["$2"]'),str=str.replace(STATE_SELECTOR_RE,'$1$2$3state["$4"]'),str=str.replace(ITEM_RE,'item'),str}function composeFunctions(){var functions=arguments;return function(){var i;for(i=0;i<functions.length;i++)functions[i].apply(this,arguments)}}function parseKeyToWatch(str){var dotIndex;return str=stripNot(str.trim()),dotIndex=str.indexOf('.'),-1===dotIndex?str:str.substring(0,str.indexOf('.'))}function stripNot(str){if(0===str.indexOf('!!'))return str.replace('!!','');return 0===str.indexOf('!')?str.replace('!',''):str}function split(str,delimiter){return(SPLIT_CACHE[delimiter]||(SPLIT_CACHE[delimiter]={}),SPLIT_CACHE[delimiter][str])?SPLIT_CACHE[delimiter][str]:(SPLIT_CACHE[delimiter][str]=str.split(delimiter),SPLIT_CACHE[delimiter][str])}var selectFunctions={};module.exports.select=function select(state,selector,item){return selectFunctions[selector]||(selectFunctions[selector]=new Function('state','item','return '+generateExpression(selector)+';')),selectFunctions[selector](state,item)};var DOT_NOTATION_RE=/\.([A-Za-z][\w_-]*)/g,WHITESPACE_RE=/\s/g,STATE_SELECTOR_RE=/([=&|!?:+-])(\s*)([\(]?)([A-Za-z][\w_-]*)/g,ROOT_STATE_SELECTOR_RE=/^([\(]?)([A-Za-z][\w_-]*)/g,ITEM_RE=/state\["item"\]/g;module.exports.generateExpression=generateExpression,module.exports.clearObject=function clearObject(obj){for(var key in obj)delete obj[key]},module.exports.composeHandlers=function composeHandlers(){var inputHandlers=arguments,actionName,i,outputHandlers;for(outputHandlers={},i=0;i<inputHandlers.length;i++)for(actionName in inputHandlers[i])actionName in outputHandlers?outputHandlers[actionName].constructor===Array?outputHandlers[actionName].push(inputHandlers[i][actionName]):outputHandlers[actionName]=[outputHandlers[actionName],inputHandlers[i][actionName]]:outputHandlers[actionName]=inputHandlers[i][actionName];for(actionName in outputHandlers)outputHandlers[actionName].constructor===Array&&(outputHandlers[actionName]=composeFunctions.apply(this,outputHandlers[actionName]));return outputHandlers},module.exports.composeFunctions=composeFunctions;var NO_WATCH_TOKENS=['||','&&','!=','!==','==','===','>','<','<=','>='],WHITESPACE_PLUS_RE=/\s+/;module.exports.parseKeysToWatch=function parseKeysToWatch(keys,str,isBindItem){var i,tokens;for(tokens=split(str,WHITESPACE_PLUS_RE),i=0;i<tokens.length;i++)if(-1===NO_WATCH_TOKENS.indexOf(tokens[i])&&!tokens[i].startsWith('\'')&&-1===keys.indexOf(tokens[i])){if(isBindItem&&'item'===tokens[i])continue;keys.push(parseKeyToWatch(tokens[i]))}};var SPLIT_CACHE={};module.exports.split=split,module.exports.copyArray=function copyArray(dest,src){var i;for(dest.length=0,i=0;i<src.length;i++)dest[i]=src[i]}},function(module,exports,__webpack_require__){'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&'function'==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};__webpack_require__(2);var diff=__webpack_require__(3),lib=__webpack_require__(0),wrapArray=__webpack_require__(4).wrapArray,State={initialState:{},nonBindedStateKeys:[],handlers:{},computeState:function computeState(){}},TYPE_OBJECT='object',WHITESPACE_REGEX=/s+/;AFRAME.registerState=function(definition){AFRAME.utils.extend(State,definition)},AFRAME.registerSystem('state',{init:function init(){var _this=this,key;for(key in this.arrays=[],this.dirtyArrays=[],this.diff={},this.state=AFRAME.utils.clone(State.initialState),this.subscriptions=[],this.initEventHandlers(),this.state)this.state[key]&&this.state[key].constructor===Array&&(this.arrays.push(key),this.state[key].__dirty=!0,wrapArray(this.state[key]));this.lastState=AFRAME.utils.clone(this.state),this.eventDetail={lastState:this.lastState,state:this.state},this.el.addEventListener('loaded',function(){var i;for(State.computeState(_this.state,'@@INIT'),i=0;i<_this.subscriptions.length;i++)_this.subscriptions[i].onStateUpdate(_this.state)})},dispatch:function dispatch(actionName,payload){var i,key;for(key in State.handlers[actionName](this.state,payload),State.computeState(this.state,actionName,payload),this.diff)delete this.diff[key];for(diff(this.lastState,this.state,this.diff,State.nonBindedStateKeys),this.dirtyArrays.length=0,i=0;i<this.arrays.length;i++)this.state[this.arrays[i]].__dirty&&this.dirtyArrays.push(this.arrays[i]);for(i=0;i<this.subscriptions.length;i++){if('bind-for'===this.subscriptions[i].name){if(!this.state[this.subscriptions[i].keysToWatch[0]].__dirty)continue;}else if(!this.shouldUpdate(this.subscriptions[i].keysToWatch,this.diff,this.dirtyArrays))continue;this.subscriptions[i].onStateUpdate()}for(key in this.state)this.state[key]&&this.state[key].constructor===Array&&(this.state[key].__dirty=!1);this.copyState(this.lastState,this.state),this.eventDetail.action=actionName,this.eventDetail.payload=payload,this.el.emit('stateupdate',this.eventDetail)},copyState:function copyState(lastState,state,isRecursive){for(var key in state)if(isRecursive||-1===State.nonBindedStateKeys.indexOf(key)){if(state[key]&&state[key].constructor===Object){if(!(key in lastState)){lastState[key]=AFRAME.utils.clone(state[key]);continue}this.copyState(lastState[key],state[key],!0);continue}lastState[key]=state[key]}},subscribe:function subscribe(component){this.subscriptions.push(component)},unsubscribe:function unsubscribe(component){this.subscriptions.splice(this.subscriptions.indexOf(component),1)},shouldUpdate:function shouldUpdate(keysToWatch,diff,dirtyArrays){for(var i=0;i<keysToWatch.length;i++)if(keysToWatch[i]in diff||-1!==dirtyArrays.indexOf(keysToWatch[i]))return!0;return!1},initEventHandlers:function initEventHandlers(){function registerListener(actionName){var _this2=this;this.el.addEventListener(actionName,function(evt){_this2.dispatch(actionName,evt.detail)})}var registeredActions=[],self=this,actionName;for(actionName in registerListener=registerListener.bind(this),State.handlers)-1===registeredActions.indexOf(actionName)&&(registeredActions.push(actionName),registerListener(actionName))},renderTemplate:function(){var interpRegex=/{{\s*(\w*\.)?([\w.]+)\s*}}/g;return function(template,data,asString){var match,str;if(str=template,data)for(;match=interpRegex.exec(template);)str=str.replace(match[0],('undefined'==typeof data?'undefined':_typeof(data))===TYPE_OBJECT?lib.select(data,match[2])||'':data);return asString?str:document.createRange().createContextualFragment(str)}}(),select:lib.select}),AFRAME.registerComponent('bind',{schema:{default:{},parse:function parse(value){var data,i,properties,pair;if(value.constructor===Object)return value;if(-1===value.indexOf(':'))return value;for(data={},properties=lib.split(value,';'),i=0;i<properties.length;i++)pair=lib.split(properties[i].trim(),':'),data[pair[0]]=pair[1].trim();return data}},multiple:!0,init:function init(){var data=this.data,componentId;this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system=this.el.sceneEl.systems.state,this.id&&(componentId=lib.split(this.id,'__')[0]),this.isNamespacedBind=this.id&&componentId in AFRAME.components&&!AFRAME.components[componentId].isSingleProp||componentId in AFRAME.systems,this.lastData={},this.updateObj={},this.system.subscribe(this),this.onStateUpdate=this.onStateUpdate.bind(this)},update:function update(){var data=this.data,key;if(this.keysToWatch.length=0,'string'==typeof data)lib.parseKeysToWatch(this.keysToWatch,data);else for(key in data)lib.parseKeysToWatch(this.keysToWatch,data[key]);this.onStateUpdate()},onStateUpdate:function onStateUpdate(){var hasKeys=!1,el=this.el,propertyName,stateSelector,state,value;if(el.parentNode){if(this.isNamespacedBind&&lib.clearObject(this.updateObj),state=this.system.state,_typeof(this.data)!==TYPE_OBJECT){try{value=lib.select(state,this.data)}catch(e){throw new Error('[aframe-state-component] Key \''+this.data+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}return('undefined'==typeof value?'undefined':_typeof(value))!==TYPE_OBJECT&&_typeof(this.lastData)!==TYPE_OBJECT&&this.lastData===value?void 0:(AFRAME.utils.entity.setComponentProperty(el,this.id,value),void(this.lastData=value))}for(propertyName in this.data){stateSelector=this.data[propertyName].trim();try{value=lib.select(state,stateSelector)}catch(e){throw console.log(e),new Error('[aframe-state-component] Key \''+stateSelector+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}if(('undefined'==typeof value?'undefined':_typeof(value))===TYPE_OBJECT||_typeof(this.lastData[propertyName])===TYPE_OBJECT||this.lastData[propertyName]!==value){if(propertyName in AFRAME.components&&void 0===value)return void el.removeAttribute(propertyName);this.isNamespacedBind?this.updateObj[propertyName]=value:AFRAME.utils.entity.setComponentProperty(el,propertyName,value),this.lastData[propertyName]=value}}for(hasKeys in this.updateObj);this.isNamespacedBind&&hasKeys&&el.setAttribute(this.id,this.updateObj)}},remove:function remove(){this.system.unsubscribe(this)}}),AFRAME.registerComponent('bind-toggle',{schema:{type:'string'},multiple:!0,init:function init(){this.system=this.el.sceneEl.systems.state,this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system.subscribe(this),this.onStateUpdate()},update:function update(){this.keysToWatch.length=0,lib.parseKeysToWatch(this.keysToWatch,this.data)},onStateUpdate:function onStateUpdate(){var el=this.el,state,value;state=this.system.state;try{value=lib.select(state,this.data)}catch(e){throw new Error('[aframe-state-component] Key \''+this.data+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}value?el.setAttribute(this.id,''):el.removeAttribute(this.id)},remove:function remove(){this.system.unsubscribe(this)}}),module.exports={composeFunctions:lib.composeFunctions,composeHandlers:lib.composeHandlers,select:lib.select}},function(module,exports,__webpack_require__){'use strict';var lib=__webpack_require__(0),ITEM_RE=/item/,ITEM_PREFIX_RE=/item./,ITEM_SELECTOR_RE=/item.(\w+)/;AFRAME.registerComponent('bind-for',{schema:{delay:{default:0},for:{type:'string',default:'item'},in:{type:'string'},key:{type:'string'},pool:{default:0},template:{type:'string'},updateInPlace:{default:!1}},init:function init(){this.system=this.el.sceneEl.systems.state,this.onStateUpdate=this.onStateUpdate.bind(this),this.keysToWatch=[],this.renderedKeys=[],this.system.subscribe(this),this.template=this.el.children[0]&&'TEMPLATE'===this.el.children[0].tagName?this.el.children[0].innerHTML.trim():document.querySelector(this.data.template).innerHTML.trim();for(var i=0;i<this.data.pool;i++)this.el.appendChild(this.generateFromTemplate(null,i))},update:function update(){this.keysToWatch[0]=lib.split(this.data.in,'.')[0],this.onStateUpdate()},onStateUpdateNaive:function(){var activeKeys=[];return function(){var data=this.data,el=this.el,list;try{list=lib.select(this.system.state,data.in)}catch(e){throw new Error('[aframe-state-component] Key \''+data.in+'\' not found in state.'+(' #'+el.getAttribute('id')+'['+this.attrName+']'))}activeKeys.length=0;for(var i=0,item;i<list.length;i++)item=list[i],activeKeys.push(data.key?item[data.key].toString():item.toString());for(var toRemoveEls=this.getElsToRemove(activeKeys,this.renderedKeys),_i=0;_i<toRemoveEls.length;_i++)toRemoveEls[_i].parentNode.removeChild(toRemoveEls[_i]);list.length&&this.renderItems(list,activeKeys,0)}}(),renderItems:function renderItems(list,activeKeys,i){var _this=this,data=this.data,el=this.el,item=list[i],keyValue=data.key?item[data.key].toString():item.toString(),itemEl;if(-1===this.renderedKeys.indexOf(keyValue))itemEl=this.generateFromTemplate(item,i),el.appendChild(itemEl),this.renderedKeys.push(keyValue);else{if(list.length&&list[0].constructor===String){var _keyValue=data.key?item[data.key].toString():item.toString();itemEl=el.querySelector('[data-bind-for-value="'+_keyValue+'"]'),itemEl.setAttribute('data-bind-for-key',i)}else{var bindForKey=this.getBindForKey(item,i);itemEl=el.querySelector('[data-bind-for-key="'+bindForKey+'"]')}itemEl.emit('bindforupdate',item,!1)}list[i+1]&&(this.data.delay?setTimeout(function(){_this.renderItems(list,activeKeys,i+1)},this.data.delay):this.renderItems(list,activeKeys,i+1))},onStateUpdateInPlace:function(){var activeKeys=[];return function(){var data=this.data,el=this.el,list,keyValue;try{list=lib.select(this.system.state,data.in)}catch(e){throw console.log(e),new Error('[aframe-state-component] Key \''+data.in+'\' not found in state.'+(' #'+el.getAttribute('id')+'['+this.attrName+']'))}activeKeys.length=0;for(var i=0,item;i<list.length;i++)item=list[i],keyValue=data.key?item[data.key].toString():item.toString(),activeKeys.push(keyValue);for(var toRemoveEls=this.getElsToRemove(activeKeys,this.renderedKeys),_i2=0;_i2<toRemoveEls.length;_i2++)toRemoveEls[_i2].object3D.visible=!1,toRemoveEls[_i2].setAttribute('data-bind-for-active','false'),toRemoveEls[_i2].removeAttribute('data-bind-for-key'),toRemoveEls[_i2].removeAttribute('data-bind-for-value'),toRemoveEls[_i2].emit('bindfordeactivate',null,!1),toRemoveEls[_i2].pause();list.length&&this.renderItemsInPlace(list,activeKeys,0)}}(),renderItemsInPlace:function renderItemsInPlace(list,activeKeys,i){var _this2=this,data=this.data,el=this.el,item=list[i],bindForKey=this.getBindForKey(item,i),keyValue=data.key?item[data.key].toString():item.toString(),itemEl;if(-1===this.renderedKeys.indexOf(keyValue)){if(!el.querySelector(':scope > [data-bind-for-active="false"]')){var _itemEl=this.generateFromTemplate(item,i);_itemEl.addEventListener('loaded',function(){_itemEl.emit('bindforupdateinplace',item,!1)}),el.appendChild(_itemEl)}else itemEl=el.querySelector('[data-bind-for-active="false"]'),itemEl.setAttribute('data-bind-for-key',bindForKey),itemEl.setAttribute('data-bind-for-value',keyValue),itemEl.object3D.visible=!0,itemEl.play(),itemEl.setAttribute('data-bind-for-active','true'),itemEl.emit('bindforupdateinplace',item,!1);this.renderedKeys.push(keyValue)}else-1!==activeKeys.indexOf(keyValue)&&(list.length&&list[0].constructor===String?(itemEl=el.querySelector('[data-bind-for-value="'+keyValue+'"]'),itemEl.setAttribute('data-bind-for-key',i)):itemEl=el.querySelector('[data-bind-for-key="'+bindForKey+'"]'),itemEl.emit('bindforupdateinplace',item,!1));list[i+1]&&(this.data.delay?setTimeout(function(){_this2.renderItemsInPlace(list,activeKeys,i+1)},this.data.delay):this.renderItemsInPlace(list,activeKeys,i+1))},generateFromTemplate:function generateFromTemplate(item,i){var data=this.data;this.el.appendChild(this.system.renderTemplate(this.template,item));var newEl=this.el.children[this.el.children.length-1];if(!item)return newEl.setAttribute('data-bind-for-key',''),newEl.setAttribute('data-bind-for-active','false'),newEl;var bindForKey=this.getBindForKey(item,i);return newEl.setAttribute('data-bind-for-key',bindForKey),data.key||newEl.setAttribute('data-bind-for-value',item),newEl.setAttribute('data-bind-for-active','true'),newEl},getElsToRemove:function(){var toRemove=[];return function(activeKeys,renderedKeys){var data=this.data,el=this.el;toRemove.length=0;for(var i=0;i<el.children.length;i++)if('TEMPLATE'!==el.children[i].tagName){var key=data.key?el.children[i].getAttribute('data-bind-for-key'):el.children[i].getAttribute('data-bind-for-value');-1===activeKeys.indexOf(key)&&-1!==renderedKeys.indexOf(key)&&(toRemove.push(el.children[i]),renderedKeys.splice(renderedKeys.indexOf(key),1))}return toRemove}}(),getBindForKey:function getBindForKey(item,i){return this.data.key?item[this.data.key].toString():i.toString()},onStateUpdate:function onStateUpdate(){this.data.updateInPlace?this.onStateUpdateInPlace():this.onStateUpdateNaive()}}),AFRAME.registerComponent('bind-item',{schema:{type:'string'},multiple:!0,init:function init(){this.itemData=null,this.keysToWatch=[],this.prevValues={};var rootEl=this.rootEl=this.el.closest('[data-bind-for-key]');if(!rootEl)throw new Error('bind-item component must be attached to entity under a bind-for item.');rootEl.addEventListener('bindforupdateinplace',this.updateInPlace.bind(this)),rootEl.addEventListener('bindfordeactivate',this.deactivate.bind(this)),this.el.sceneEl.systems.state.subscribe(this)},update:function update(){this.parseSelector()},updateInPlace:function updateInPlace(evt){var propertyMap=this.propertyMap;if('false'!==this.rootEl.getAttribute('data-bind-for-active'))for(var property in evt&&(this.itemData=evt.detail),propertyMap){var value=this.select(this.itemData,propertyMap[property]);value!==this.prevValues[property]&&(AFRAME.utils.entity.setComponentProperty(this.el,property,value),this.prevValues[property]=value)}},onStateUpdate:function onStateUpdate(){this.updateInPlace()},select:function select(itemData,selector){return lib.select(this.el.sceneEl.systems.state.state,selector,itemData)},deactivate:function deactivate(){this.prevValues={}},parseSelector:function parseSelector(){var propertyMap=this.propertyMap={};this.keysToWatch.length=0;var componentName=lib.split(this.id,'__')[0];if(componentName in AFRAME.components&&!AFRAME.components[componentName].isSingleProp){for(var propertySplitList=lib.split(this.data,';'),i=0,propertySplit;i<propertySplitList.length;i++)propertySplit=lib.split(propertySplitList[i],':'),propertyMap[this.id+'.'+propertySplit[0].trim()]=propertySplit[1].trim(),lib.parseKeysToWatch(this.keysToWatch,propertySplit[1].trim(),!0);return}propertyMap[this.id]=this.data,lib.parseKeysToWatch(this.keysToWatch,this.data,!0)}})},function(module){'use strict';module.exports=function(){var keys=[];return function(a,b,targetObject,ignoreKeys){var aVal,bVal,bKey,diff,key,i,isComparingObjects;for(key in diff=targetObject||{},keys.length=0,a)keys.push(key);if(!b)return diff;for(bKey in b)-1===keys.indexOf(bKey)&&keys.push(bKey);for(i=0;i<keys.length;i++)(key=keys[i],!(ignoreKeys&&-1!==ignoreKeys.indexOf(key)))&&(aVal=a[key],bVal=b[key],isComparingObjects=aVal&&bVal&&aVal.constructor===Object&&bVal.constructor===Object,(!isComparingObjects||AFRAME.utils.deepEqual(aVal,bVal))&&(isComparingObjects||aVal===bVal)||(diff[key]=bVal));return diff}}()},function(module){'use strict';function makeCallDirty(arr,fn){var originalFn=arr[fn];arr[fn]=function(){originalFn.apply(arr,arguments),arr.__dirty=!0}}var fns=['push','pop','shift','unshift','splice'];module.exports.wrapArray=function wrapArray(arr){var i;if(!arr.__wrapped){for(i=0;i<fns.length;i++)makeCallDirty(arr,fns[i]);arr.__wrapped=!0}}}])})},function(){var TYPE_PAD='PAD',TYPE_STICK='STICK',ANGLES=[0,90,180,270],DIRECTIONS=['right','up','left','down'],EVENTS={NULL:{START:'thumbstart',END:'thumbend'}};DIRECTIONS.forEach(direction=>{EVENTS[direction]={},EVENTS[direction].START='thumb'+direction+'start',EVENTS[direction].END='thumb'+direction+'end'});var SIZE=240;AFRAME.registerComponent('thumb-controls',{dependencies:['tracked-controls'],schema:{thresholdAngle:{default:89.5},thresholdPad:{default:0.05},thresholdStick:{default:0.75}},init:function(){var el=this.el;this.onTrackpadDown=this.onTrackpadDown.bind(this),this.onTrackpadUp=this.onTrackpadUp.bind(this),this.directionStick='',this.directionTrackpad='',this.type=TYPE_STICK,el.addEventListener('controllerconnected',evt=>'oculus-touch-controls'===evt.detail.name||'windows-motion-controls'===evt.detail.name?void(this.type=TYPE_STICK):void(this.type=TYPE_PAD)),this.axis=el.components['tracked-controls'].axis},play:function(){var el=this.el;el.addEventListener('trackpaddown',this.onTrackpadDown),el.addEventListener('trackpadup',this.onTrackpadUp)},pause:function(){var el=this.el;el.removeEventListener('trackpaddown',this.onTrackpadDown),el.removeEventListener('trackpadup',this.onTrackpadUp)},onTrackpadDown:function(){var el=this.el,direction;this.getDistance()<this.data.thresholdPad||(direction=this.getDirection(),direction&&(this.directionTrackpad=direction,el.emit(EVENTS.NULL.START,null,!1),el.emit(EVENTS[this.directionTrackpad].START,null,!1)))},onTrackpadUp:function(){var el=this.el;this.directionTrackpad&&(el.emit(EVENTS.NULL.END,null,!1),el.emit(EVENTS[this.directionTrackpad].END,null,!1),this.directionTrackpad='')},tick:function(){var el=this.el,direction;return this.type===TYPE_PAD?void 0:!this.directionStick&&this.getDistance()>this.data.thresholdStick?(direction=this.getDirection(),!direction)?void 0:(this.directionStick=direction,el.emit(EVENTS.NULL.START,null,!1),void el.emit(EVENTS[this.directionStick].START,null,!1)):void(this.directionStick&&this.getDistance()<this.data.thresholdStick&&(el.emit(EVENTS.NULL.END,null,!1),el.emit(EVENTS[this.directionStick].END,null,!1),this.directionStick=''))},getDistance:function(){var axis=this.axis;return Math.sqrt(axis[1]*axis[1]+axis[0]*axis[0])},getDirection:function(){var angle,bottomThreshold,i,threshold,topThreshold;for(angle=this.getAngle(),threshold=this.data.thresholdAngle/2,i=0;i<ANGLES.length;i++){if(topThreshold=ANGLES[i]+threshold,360<topThreshold&&(topThreshold-=360),bottomThreshold=ANGLES[i]-threshold,0>bottomThreshold&&(angle>=360+bottomThreshold&&360>=angle||0<=angle&&angle<=topThreshold))return DIRECTIONS[i];if(angle>=bottomThreshold&&angle<=topThreshold)return DIRECTIONS[i]}},getAngle:function(){var axis=this.axis,angle,flipY;return flipY=this.type===TYPE_STICK?-1:1,angle=Math.atan2(axis[1]*flipY,axis[0]),0>angle&&(angle=2*Math.PI+angle),THREE.Math.radToDeg(angle)}}),AFRAME.registerComponent('thumb-controls-debug',{dependencies:['thumb-controls','tracked-controls'],schema:{controllerType:{type:'string'},hand:{type:'string'},enabled:{default:!1}},init:function(){var el=this.el,data=this.data,isActive,axis,axisMoveEventDetail,canvas;(data.enabled||AFRAME.utils.getUrlParameter('debug-thumb'))&&(console.log('%c debug-thumb','background: #111; color: red'),el.components['tracked-controls'].handleAxes=()=>{},axis=[0,0,0],axisMoveEventDetail={axis:axis},el.components['tracked-controls'].axis=axis,el.components['thumb-controls'].axis=axis,canvas=this.createCanvas(),canvas.addEventListener('click',()=>{'vive-controls'===this.data.controllerType?isActive?el.emit('trackpadup'):el.emit('trackpaddown'):isActive&&(axis[0]=0,axis[1]=0,el.emit('axismove',axisMoveEventDetail,!1)),isActive=!isActive}),canvas.addEventListener('mousemove',evt=>{var rect;isActive&&(rect=canvas.getBoundingClientRect(),axis[0]=2*((evt.clientX-rect.left)/SIZE)-1,axis[1]=2*((evt.clientY-rect.top)/SIZE)-1,el.emit('axismove',axisMoveEventDetail,!1))}),canvas.addEventListener('mouseleave',()=>{isActive&&(axis[0]=0,axis[1]=0,el.emit('axismove',axisMoveEventDetail,!1))}))},createCanvas:function(){var canvas,ctx;return canvas=document.createElement('canvas'),canvas.classList.add('debugThumb'),canvas.height=SIZE,canvas.width=SIZE,canvas.style.bottom=0,canvas.style.borderRadius='250px',canvas.style.opacity=0.5,canvas.style.position='fixed',canvas.style.zIndex=999999999,'left'===this.data.hand?canvas.style.left=0:canvas.style.right=0,ctx=canvas.getContext('2d'),ctx.fillStyle='#333',ctx.fillRect(0,0,SIZE,SIZE),document.body.appendChild(canvas),canvas}})},function(module,exports,__webpack_require__){var content=__webpack_require__(135);'string'==typeof content&&(content=[[module.i,content,'']]);var options={hmr:!0},transform;options.transform=transform,options.insertInto=void 0;__webpack_require__(148)(content,options);content.locals&&(module.exports=content.locals),!1},function(module,exports,__webpack_require__){function webpackContext(req){return __webpack_require__(webpackContextResolve(req))}function webpackContextResolve(req){var id=map[req];if(!(id+1))throw new Error('Cannot find module \''+req+'\'.');return id}var map={"./active-color.js":59,"./audio-columns.js":60,"./beams.js":61,"./beat-hit-sound.js":62,"./beat-loader.js":63,"./beat.js":64,"./console-shortcuts.js":65,"./copy-texture.js":66,"./cursor-laser.js":67,"./cursor-mesh.js":68,"./debug-beat-loader.js":69,"./debug-controller.js":70,"./debug-cursor.js":71,"./debug-song-time.js":72,"./debug-state.js":73,"./fake-glow.js":74,"./floor-shader.js":75,"./gameover.js":76,"./gpu-preloader.js":77,"./hack.js":78,"./hand-swapper.js":79,"./haptics-saber.js":80,"./haptics-wall.js":81,"./history.js":82,"./intro-song.js":83,"./keyboard-raycastable.js":84,"./leaderboard.js":85,"./logo-light.js":86,"./logoflicker.js":87,"./materials.js":88,"./menu-controls.js":89,"./menu-difficulty-select.js":90,"./menu-selected-challenge-image.js":91,"./menu-slide-animation.js":92,"./mine-fragments-loader.js":93,"./multiplier-ring.js":94,"./particleplayer.js":95,"./pause.js":96,"./pauser.js":97,"./play-sound.js":98,"./raycaster-target.js":99,"./recenter.js":100,"./saber-controls.js":101,"./saber-particles.js":102,"./score-beat.js":103,"./score-texts.js":104,"./search-thumbnail-atlas.js":105,"./search.js":106,"./song-preview.js":107,"./song-progress-ring.js":108,"./song.js":109,"./stage-colors.js":110,"./stage-lasers.js":111,"./stage-shader.js":112,"./stats-param.js":113,"./stepback.js":114,"./sub-object.js":115,"./super-keyboard.js":116,"./supercutfx-shader.js":117,"./supercutfx.js":118,"./text-counter.js":119,"./text-uppercase.js":120,"./toggle-pause-play.js":121,"./trail.js":122,"./tutorial-2d.js":123,"./twister.js":124,"./vertex-colors-buffer.js":125,"./victory-accuracy-ring.js":126,"./victory-rank.js":127,"./visible-raycastable.js":128,"./wall-shader.js":129,"./wall.js":130};webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=33},function(module,exports,__webpack_require__){function webpackContext(req){return __webpack_require__(webpackContextResolve(req))}function webpackContextResolve(req){var id=map[req];if(!(id+1))throw new Error('Cannot find module \''+req+'\'.');return id}var map={"./index.js":134};webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=34},function(module,exports,__webpack_require__){'use strict';var _Mathmin=Math.min,_Mathfloor=Math.floor,_Mathmax=Math.max;(function(process){function getLogLevel(){return logClient.logLevel===logger.LogLevel.DEBUG?LogLevel.DEBUG:logClient.logLevel===logger.LogLevel.SILENT?LogLevel.SILENT:LogLevel.ERROR}function setLogLevel(newLevel){newLevel===LogLevel.DEBUG?logClient.logLevel=logger.LogLevel.DEBUG:newLevel===LogLevel.ERROR?logClient.logLevel=logger.LogLevel.ERROR:newLevel===LogLevel.SILENT?logClient.logLevel=logger.LogLevel.SILENT:logClient.error('Firestore ('+SDK_VERSION+'): Invalid value passed to `setLogLevel`')}function debug(tag,msg){for(var obj=[],_i=2;_i<arguments.length;_i++)obj[_i-2]=arguments[_i];if(logClient.logLevel<=logger.LogLevel.DEBUG){var args=obj.map(argToString);logClient.debug.apply(logClient,['Firestore ('+SDK_VERSION+') ['+tag+']: '+msg].concat(args))}}function error(msg){for(var obj=[],_i=1;_i<arguments.length;_i++)obj[_i-1]=arguments[_i];if(logClient.logLevel<=logger.LogLevel.ERROR){var args=obj.map(argToString);logClient.error.apply(logClient,['Firestore ('+SDK_VERSION+'): '+msg].concat(args))}}function argToString(obj){if('string'==typeof obj)return obj;var platform=PlatformSupport.getPlatform();try{return platform.formatJSON(obj)}catch(e){return obj}}function fail(failure){var message='FIRESTORE ('+SDK_VERSION+') INTERNAL ASSERTION FAILED: '+failure;throw error(message),new Error(message)}function assert(assertion,message){assertion||fail(message)}function emptyByteString(){return PlatformSupport.getPlatform().emptyByteString}function makeConstructorPrivate(cls,optionalMessage){function PublicConstructor(){var error='This constructor is private.';throw optionalMessage&&(error+=' ',error+=optionalMessage),new FirestoreError(Code.INVALID_ARGUMENT,error)}for(var staticProperty in PublicConstructor.prototype=cls.prototype,cls)cls.hasOwnProperty(staticProperty)&&(PublicConstructor[staticProperty]=cls[staticProperty]);return PublicConstructor}function contains(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}function defaulted(value,defaultValue){return value===void 0?defaultValue:value}function forEachNumber(obj,fn){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var num=+key;isNaN(num)||fn(num,obj[key])}}function values(obj){var vs=[];return forEach(obj,function(_,v){return vs.push(v)}),vs}function forEach(obj,fn){for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&fn(key,obj[key])}function isEmpty(obj){for(var key in assert(null!=obj&&'object'==typeof obj,'isEmpty() expects object parameter.'),obj)if(Object.prototype.hasOwnProperty.call(obj,key))return!1;return!0}function shallowCopy(obj){assert(obj&&'object'==typeof obj,'shallowCopy() expects object parameter.');var result={};for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(result[key]=obj[key]);return result}function validateExactNumberOfArgs(functionName,args,numberOfArgs){if(args.length!==numberOfArgs)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires '+formatPlural(numberOfArgs,'argument')+', but was called with '+formatPlural(args.length,'argument')+'.')}function validateAtLeastNumberOfArgs(functionName,args,minNumberOfArgs){if(args.length<minNumberOfArgs)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires at least '+formatPlural(minNumberOfArgs,'argument')+', but was called with '+formatPlural(args.length,'argument')+'.')}function validateBetweenNumberOfArgs(functionName,args,minNumberOfArgs,maxNumberOfArgs){if(args.length<minNumberOfArgs||args.length>maxNumberOfArgs)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires between '+minNumberOfArgs+' and '+(maxNumberOfArgs+' arguments, but was called with ')+formatPlural(args.length,'argument')+'.')}function validateNamedArrayAtLeastNumberOfElements(functionName,value,name,minNumberOfElements){if(!(value instanceof Array)||value.length<minNumberOfElements)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+name+' argument to be an '+'array with at least '+(formatPlural(minNumberOfElements,'element')+'.'))}function validateArgType(functionName,type,position,argument){validateType(functionName,type,ordinal(position)+' argument',argument)}function validateOptionalArgType(functionName,type,position,argument){argument!==void 0&&validateArgType(functionName,type,position,argument)}function validateNamedType(functionName,type,optionName,argument){validateType(functionName,type,optionName+' option',argument)}function validateNamedOptionalType(functionName,type,optionName,argument){argument!==void 0&&validateNamedType(functionName,type,optionName,argument)}function validateArrayElements(functionName,optionName,typeDescription,argument,validator){if(!(argument instanceof Array))throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+optionName+' '+('option to be an array, but it was: '+valueDescription(argument)));for(var i=0;i<argument.length;++i)if(!validator(argument[i]))throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires all '+optionName+' '+('elements to be '+typeDescription+', but the value at index '+i+' ')+('was: '+valueDescription(argument[i])))}function validateOptionalArrayElements(functionName,optionName,typeDescription,argument,validator){argument!==void 0&&validateArrayElements(functionName,optionName,typeDescription,argument,validator)}function validateNamedPropertyEquals(functionName,inputName,optionName,input,expected){for(var expectedDescription=[],_i=0,expected_1=expected,val;_i<expected_1.length;_i++){if(val=expected_1[_i],val===input)return;expectedDescription.push(valueDescription(val))}var actualDescription=valueDescription(input);throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid value '+actualDescription+' provided to function '+functionName+'() for option '+('"'+optionName+'". Acceptable values: '+expectedDescription.join(', ')))}function validateNamedOptionalPropertyEquals(functionName,inputName,optionName,input,expected){input!==void 0&&validateNamedPropertyEquals(functionName,inputName,optionName,input,expected)}function validateType(functionName,type,inputName,input){var valid=!1;if(valid='object'===type?isPlainObject(input):'non-empty string'===type?'string'==typeof input&&''!==input:typeof input==type,!valid){var description=valueDescription(input);throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+inputName+' '+('to be of type '+type+', but it was: '+description))}}function isPlainObject(input){return'object'==typeof input&&null!==input&&(Object.getPrototypeOf(input)===Object.prototype||null===Object.getPrototypeOf(input))}function valueDescription(input){if(input===void 0)return'undefined';if(null===input)return'null';if('string'==typeof input)return 20<input.length&&(input=input.substring(0,20)+'...'),JSON.stringify(input);if('number'==typeof input||'boolean'==typeof input)return''+input;if('object'==typeof input){if(input instanceof Array)return'an array';var customObjectName=tryGetCustomObjectType(input);return customObjectName?'a custom '+customObjectName+' object':'an object'}return'function'==typeof input?'a function':fail('Unknown wrong type: '+typeof input)}function tryGetCustomObjectType(input){if(input.constructor){var funcNameRegex=/function\s+([^\s(]+)\s*\(/,results=funcNameRegex.exec(input.constructor.toString());if(results&&1<results.length)return results[1]}return null}function validateDefined(functionName,position,argument){if(argument===void 0)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires a valid '+ordinal(position)+' '+'argument, but it was undefined.')}function validateOptionNames(functionName,options,optionNames){forEach(options,function(key){if(0>optionNames.indexOf(key))throw new FirestoreError(Code.INVALID_ARGUMENT,'Unknown option \''+key+'\' passed to function '+functionName+'(). '+'Available options: '+optionNames.join(', '))})}function invalidClassError(functionName,type,position,argument){var description=valueDescription(argument);return new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+ordinal(position)+' '+('argument to be a '+type+', but it was: '+description))}function ordinal(num){return 1===num?'first':2===num?'second':3===num?'third':num+'th'}function formatPlural(num,str){return num+' '+str+(1===num?'':'s')}function primitiveComparator(left,right){return left<right?-1:left>right?1:0}function equals(left,right){return null!==left&&void 0!==left?!!(right&&left.isEqual(right)):left===right}function arrayEquals(left,right){if(left.length!==right.length)return!1;for(var i=0;i<left.length;i++)if(!left[i].isEqual(right[i]))return!1;return!0}function immediateSuccessor(s){return s+'\0'}function assertUint8ArrayAvailable(){if('undefined'==typeof Uint8Array)throw new FirestoreError(Code.UNIMPLEMENTED,'Uint8Arrays are not available in this environment.')}function assertBase64Available(){if(!PlatformSupport.getPlatform().base64Available)throw new FirestoreError(Code.UNIMPLEMENTED,'Blobs are unavailable in Firestore in this environment.')}function numericComparator(left,right){return left<right?-1:left>right?1:left===right?0:isNaN(left)?isNaN(right)?0:-1:1}function numericEquals(left,right){return left===right?0!==left||1/left==1/right:left!==left&&right!==right}function isNullOrUndefined(value){return null===value||value===void 0}function isSafeInteger(value){return isInteger(value)&&value<=MAX_SAFE_INTEGER&&value>=MIN_SAFE_INTEGER}function coercedFieldValuesArray(value){return value instanceof ArrayValue?value.internalValue.slice():[]}function isPermanentError(code){return code===Code.OK?fail('Treated status OK as error'):code===Code.CANCELLED||code===Code.UNKNOWN||code===Code.DEADLINE_EXCEEDED||code===Code.RESOURCE_EXHAUSTED||code===Code.INTERNAL||code===Code.UNAVAILABLE||code===Code.UNAUTHENTICATED?!1:code===Code.INVALID_ARGUMENT||code===Code.NOT_FOUND||code===Code.ALREADY_EXISTS||code===Code.PERMISSION_DENIED||code===Code.FAILED_PRECONDITION||code===Code.ABORTED||code===Code.OUT_OF_RANGE||code===Code.UNIMPLEMENTED||code===Code.DATA_LOSS||fail('Unknown status code: '+code)}function mapCodeFromRpcStatus(status){var code=RpcCode[status];return void 0===code?void 0:mapCodeFromRpcCode(code)}function mapCodeFromRpcCode(code){if(void 0===code)return error('GRPC error has no .code'),Code.UNKNOWN;return code===RpcCode.OK?Code.OK:code===RpcCode.CANCELLED?Code.CANCELLED:code===RpcCode.UNKNOWN?Code.UNKNOWN:code===RpcCode.DEADLINE_EXCEEDED?Code.DEADLINE_EXCEEDED:code===RpcCode.RESOURCE_EXHAUSTED?Code.RESOURCE_EXHAUSTED:code===RpcCode.INTERNAL?Code.INTERNAL:code===RpcCode.UNAVAILABLE?Code.UNAVAILABLE:code===RpcCode.UNAUTHENTICATED?Code.UNAUTHENTICATED:code===RpcCode.INVALID_ARGUMENT?Code.INVALID_ARGUMENT:code===RpcCode.NOT_FOUND?Code.NOT_FOUND:code===RpcCode.ALREADY_EXISTS?Code.ALREADY_EXISTS:code===RpcCode.PERMISSION_DENIED?Code.PERMISSION_DENIED:code===RpcCode.FAILED_PRECONDITION?Code.FAILED_PRECONDITION:code===RpcCode.ABORTED?Code.ABORTED:code===RpcCode.OUT_OF_RANGE?Code.OUT_OF_RANGE:code===RpcCode.UNIMPLEMENTED?Code.UNIMPLEMENTED:code===RpcCode.DATA_LOSS?Code.DATA_LOSS:fail('Unknown status code: '+code)}function mapRpcCodeFromCode(code){if(code===void 0)return RpcCode.OK;return code===Code.OK?RpcCode.OK:code===Code.CANCELLED?RpcCode.CANCELLED:code===Code.UNKNOWN?RpcCode.UNKNOWN:code===Code.DEADLINE_EXCEEDED?RpcCode.DEADLINE_EXCEEDED:code===Code.RESOURCE_EXHAUSTED?RpcCode.RESOURCE_EXHAUSTED:code===Code.INTERNAL?RpcCode.INTERNAL:code===Code.UNAVAILABLE?RpcCode.UNAVAILABLE:code===Code.UNAUTHENTICATED?RpcCode.UNAUTHENTICATED:code===Code.INVALID_ARGUMENT?RpcCode.INVALID_ARGUMENT:code===Code.NOT_FOUND?RpcCode.NOT_FOUND:code===Code.ALREADY_EXISTS?RpcCode.ALREADY_EXISTS:code===Code.PERMISSION_DENIED?RpcCode.PERMISSION_DENIED:code===Code.FAILED_PRECONDITION?RpcCode.FAILED_PRECONDITION:code===Code.ABORTED?RpcCode.ABORTED:code===Code.OUT_OF_RANGE?RpcCode.OUT_OF_RANGE:code===Code.UNIMPLEMENTED?RpcCode.UNIMPLEMENTED:code===Code.DATA_LOSS?RpcCode.DATA_LOSS:fail('Unknown status code: '+code)}function mapCodeFromHttpStatus(status){return 200===status?Code.OK:400===status?Code.INVALID_ARGUMENT:401===status?Code.UNAUTHENTICATED:403===status?Code.PERMISSION_DENIED:404===status?Code.NOT_FOUND:409===status?Code.ABORTED:416===status?Code.OUT_OF_RANGE:429===status?Code.RESOURCE_EXHAUSTED:499===status?Code.CANCELLED:500===status?Code.UNKNOWN:501===status?Code.UNIMPLEMENTED:503===status?Code.UNAVAILABLE:504===status?Code.DEADLINE_EXCEEDED:200<=status&&300>status?Code.OK:400<=status&&500>status?Code.FAILED_PRECONDITION:500<=status&&600>status?Code.INTERNAL:Code.UNKNOWN}function maybeDocumentMap(){return EMPTY_MAYBE_DOCUMENT_MAP}function documentMap(){return EMPTY_DOCUMENT_MAP}function documentVersionMap(){return EMPTY_DOCUMENT_VERSION_MAP}function documentKeySet(){return EMPTY_DOCUMENT_KEY_SET}function targetIdSet(){return EMPTY_TARGET_ID_SET}function documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}function assertPresent(value,description){assert(!isNullOrUndefined(value),description+' is missing')}function parseInt64(value){return'number'==typeof value?value:'string'==typeof value?+value:fail('can\'t parse '+value)}function hasTag(obj,type,tag){return type===tag||!type&&tag in obj}function encode(path){for(var result='',i=0;i<path.length;i++)0<result.length&&(result=encodeSeparator(result)),result=encodeSegment(path.get(i),result);return encodeSeparator(result)}function encodeSegment(segment,resultBuf){for(var result=resultBuf,length=segment.length,i=0,c;i<length;i++)c=segment.charAt(i),result+='\0'===c?escapeChar+encodedNul:c===escapeChar?escapeChar+encodedEscape:c;return result}function encodeSeparator(result){return result+escapeChar+encodedSeparatorChar}function decode$1(path){var length=path.length;if(assert(2<=length,'Invalid path '+path),2===length)return assert(path.charAt(0)===escapeChar&&path.charAt(1)===encodedSeparatorChar,'Non-empty path '+path+' had length 2'),ResourcePath.EMPTY_PATH;for(var segments=[],segmentBuilder='',start=0,end;start<length;){end=path.indexOf(escapeChar,start),(0>end||end>length-2)&&fail('Invalid encoded resource path: "'+path+'"');var next=path.charAt(end+1);switch(next){case encodedSeparatorChar:var currentPiece=path.substring(start,end),segment=void 0;0===segmentBuilder.length?segment=currentPiece:(segmentBuilder+=currentPiece,segment=segmentBuilder,segmentBuilder=''),segments.push(segment);break;case encodedNul:segmentBuilder+=path.substring(start,end),segmentBuilder+='\0';break;case encodedEscape:segmentBuilder+=path.substring(start,end+1);break;default:fail('Invalid encoded resource path: "'+path+'"');}start=end+2}return new ResourcePath(segments)}function wrapRequest(request){return new PersistencePromise(function(resolve,reject){request.onsuccess=function(event){var result=event.target.result;resolve(result)},request.onerror=function(event){reject(event.target.error)}})}function documentGlobalStore(txn){return IndexedDbPersistence.getStore(txn,DbRemoteDocumentGlobal.store)}function isDocumentChangeMissingError(err){return err.code===Code.DATA_LOSS&&err.message===REMOTE_DOCUMENT_CHANGE_MISSING_ERR_MSG}function remoteDocumentsStore(txn){return IndexedDbPersistence.getStore(txn,DbRemoteDocument.store)}function documentChangesStore(txn){return IndexedDbPersistence.getStore(txn,DbRemoteDocumentChanges.store)}function dbKey(docKey){return docKey.path.toArray()}function dbDocumentSize(doc){var value;if(doc.document)value=doc.document;else if(doc.unknownDocument)value=doc.unknownDocument;else if(doc.noDocument)value=doc.noDocument;else throw fail('Unknown remote document type');return JSON.stringify(value).length}function createPrimaryClientStore(db){db.createObjectStore(DbPrimaryClient.store)}function createMutationQueue(db){db.createObjectStore(DbMutationQueue.store,{keyPath:DbMutationQueue.keyPath});var mutationBatchesStore=db.createObjectStore(DbMutationBatch.store,{keyPath:DbMutationBatch.keyPath,autoIncrement:!0});mutationBatchesStore.createIndex(DbMutationBatch.userMutationsIndex,DbMutationBatch.userMutationsKeyPath,{unique:!0}),db.createObjectStore(DbDocumentMutation.store)}function upgradeMutationBatchSchemaAndMigrateData(db,txn){var v1MutationsStore=txn.store(DbMutationBatch.store);return v1MutationsStore.loadAll().next(function(existingMutations){db.deleteObjectStore(DbMutationBatch.store);var mutationsStore=db.createObjectStore(DbMutationBatch.store,{keyPath:DbMutationBatch.keyPath,autoIncrement:!0});mutationsStore.createIndex(DbMutationBatch.userMutationsIndex,DbMutationBatch.userMutationsKeyPath,{unique:!0});var v3MutationsStore=txn.store(DbMutationBatch.store),writeAll=existingMutations.map(function(mutation){return v3MutationsStore.put(mutation)});return PersistencePromise.waitFor(writeAll)})}function createRemoteDocumentCache(db){db.createObjectStore(DbRemoteDocument.store)}function createDocumentGlobalStore(db){db.createObjectStore(DbRemoteDocumentGlobal.store)}function createQueryCache(db){var targetDocumentsStore=db.createObjectStore(DbTargetDocument.store,{keyPath:DbTargetDocument.keyPath});targetDocumentsStore.createIndex(DbTargetDocument.documentTargetsIndex,DbTargetDocument.documentTargetsKeyPath,{unique:!0});var targetStore=db.createObjectStore(DbTarget.store,{keyPath:DbTarget.keyPath});targetStore.createIndex(DbTarget.queryTargetsIndexName,DbTarget.queryTargetsKeyPath,{unique:!0}),db.createObjectStore(DbTargetGlobal.store)}function dropQueryCache(db){db.deleteObjectStore(DbTargetDocument.store),db.deleteObjectStore(DbTarget.store),db.deleteObjectStore(DbTargetGlobal.store)}function writeEmptyTargetGlobalEntry(txn){var globalStore=txn.store(DbTargetGlobal.store),metadata=new DbTargetGlobal(0,0,SnapshotVersion.MIN.toTimestamp(),0);return globalStore.put(DbTargetGlobal.key,metadata)}function createRemoteDocumentChangesStore(db){db.createObjectStore(DbRemoteDocumentChanges.store,{keyPath:'id',autoIncrement:!0})}function createClientMetadataStore(db){db.createObjectStore(DbClientMetadata.store,{keyPath:DbClientMetadata.keyPath})}function mutationQueueContainsKey(txn,userId,key){var indexKey=DbDocumentMutation.prefixForPath(userId,key.path),encodedPath=indexKey[1],startRange=IDBKeyRange.lowerBound(indexKey),containsKey=!1;return documentMutationsStore(txn).iterate({range:startRange,keysOnly:!0},function(key,value,control){var userID=key[0],keyPath=key[1],_=key[2];userID===userId&&keyPath===encodedPath&&(containsKey=!0),control.done()}).next(function(){return containsKey})}function mutationQueuesContainKey(txn,docKey){var found=!1;return mutationQueuesStore(txn).iterateSerial(function(userId){return mutationQueueContainsKey(txn,userId,docKey).next(function(containsKey){return containsKey&&(found=!0),PersistencePromise.resolve(!containsKey)})}).next(function(){return found})}function removeMutationBatch(txn,userId,batch){var mutationStore=txn.store(DbMutationBatch.store),indexTxn=txn.store(DbDocumentMutation.store),promises=[],range=IDBKeyRange.only(batch.batchId),numDeleted=0,removePromise=mutationStore.iterate({range:range},function(key,value,control){return numDeleted++,control.delete()});promises.push(removePromise.next(function(){assert(1==numDeleted,'Dangling document-mutation reference found: Missing batch '+batch.batchId)}));for(var removedDocuments=[],_i=0,_a=batch.mutations;_i<_a.length;_i++){var mutation=_a[_i],indexKey=DbDocumentMutation.key(userId,mutation.key.path,batch.batchId);promises.push(indexTxn.delete(indexKey)),removedDocuments.push(mutation.key)}return PersistencePromise.waitFor(promises).next(function(){return removedDocuments})}function convertStreamToken(token){return token instanceof Uint8Array?(assert('YES'===process.env.USE_MOCK_PERSISTENCE,'Persisting non-string stream tokens is only supported with mock persistence.'),token.toString()):token}function mutationsStore(txn){return IndexedDbPersistence.getStore(txn,DbMutationBatch.store)}function documentMutationsStore(txn){return IndexedDbPersistence.getStore(txn,DbDocumentMutation.store)}function mutationQueuesStore(txn){return IndexedDbPersistence.getStore(txn,DbMutationQueue.store)}function targetsStore(txn){return IndexedDbPersistence.getStore(txn,DbTarget.store)}function globalTargetStore(txn){return IndexedDbPersistence.getStore(txn,DbTargetGlobal.store)}function retrieveMetadata(txn){var globalStore=SimpleDb.getStore(txn,DbTargetGlobal.store);return globalStore.get(DbTargetGlobal.key).next(function(metadata){return assert(null!==metadata,'Missing metadata row.'),metadata})}function getHighestListenSequenceNumber(txn){return retrieveMetadata(txn).next(function(targetGlobal){return targetGlobal.highestListenSequenceNumber})}function documentTargetStore(txn){return IndexedDbPersistence.getStore(txn,DbTargetDocument.store)}function isDocumentQuery(dbQuery){return dbQuery.documents!==void 0}function bufferEntryComparator(_a,_b){var aSequence=_a[0],aIndex=_a[1],bSequence=_b[0],bIndex=_b[1],seqCmp=primitiveComparator(aSequence,bSequence);return 0===seqCmp?primitiveComparator(aIndex,bIndex):seqCmp}function isPrimaryLeaseLostError(err){return err.code===Code.FAILED_PRECONDITION&&err.message===PRIMARY_LEASE_LOST_ERROR_MSG}function primaryClientStore(txn){return txn.store(DbPrimaryClient.store)}function clientMetadataStore(txn){return txn.store(DbClientMetadata.store)}function sentinelKey(key){return[0,encode(key.path)]}function sentinelRow(key,sequenceNumber){return new DbTargetDocument(0,encode(key.path),sequenceNumber)}function writeSentinelKey(txn,key){return documentTargetStore(txn).put(sentinelRow(key,txn.currentSequenceNumber))}function documentSizeMap(){return new SortedMap(DocumentKey.comparator)}function compareChangeType(c1,c2){var order=function(change){return change===ChangeType.Added?1:change===ChangeType.Modified?2:change===ChangeType.Metadata?2:change===ChangeType.Removed?0:fail('Unknown ChangeType: '+change)};return order(c1)-order(c2)}function fromWebStorageSequenceNumber(seqString){var sequenceNumber=ListenSequence.INVALID;if(null!=seqString)try{var parsed=JSON.parse(seqString);assert('number'==typeof parsed,'Found non-numeric sequence number'),sequenceNumber=parsed}catch(e){error(LOG_TAG$10,'Failed to read sequence number from WebStorage',e)}return sequenceNumber}function fromDotSeparatedString(path){var found=path.search(RESERVED);if(0<=found)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field path ('+path+'). Paths must not contain '+'\'~\', \'*\', \'/\', \'[\', or \']\'');try{return new(FieldPath$1.bind.apply(FieldPath$1,[void 0].concat(path.split('.'))))}catch(e){throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field path ('+path+'). Paths must not be empty, '+'begin with \'.\', end with \'.\', or contain \'..\'')}}function makeCredentialsProvider(credentials){if(!credentials)return new EmptyCredentialsProvider;switch(credentials.type){case'gapi':return new FirstPartyCredentialsProvider(credentials.client,credentials.sessionIndex||'0');case'provider':return credentials.client;default:throw new FirestoreError(Code.INVALID_ARGUMENT,'makeCredentialsProvider failed due to invalid credential type');}}function isPartialObserver(obj){return implementsAnyMethods$1(obj,['next','error','complete'])}function implementsAnyMethods$1(obj,methods){if('object'!=typeof obj||null===obj)return!1;for(var object=obj,_i=0,methods_1=methods,method;_i<methods_1.length;_i++)if(method=methods_1[_i],method in object&&'function'==typeof object[method])return!0;return!1}function isWrite(dataSource){switch(dataSource){case UserDataSource.Set:case UserDataSource.MergeSet:case UserDataSource.Update:return!0;case UserDataSource.Argument:return!1;default:throw fail('Unexpected case for UserDataSource: '+dataSource);}}function looksLikeJsonObject(input){return'object'==typeof input&&null!==input&&!(input instanceof Array)&&!(input instanceof Date)&&!(input instanceof Timestamp)&&!(input instanceof GeoPoint)&&!(input instanceof Blob)&&!(input instanceof DocumentKeyReference)&&!(input instanceof FieldValueImpl)}function validatePlainObject(message,context,input){if(!looksLikeJsonObject(input)||!isPlainObject(input)){var description=valueDescription(input);if('an object'===description)throw context.createError(message+' a custom object');else throw context.createError(message+' '+description)}}function fieldPathFromArgument(methodName,path){if(path instanceof FieldPath$1)return path._internalPath;if('string'==typeof path)return fieldPathFromDotSeparatedString(methodName,path);throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+methodName+'() called with invalid data. '+'Field path arguments must be of type string or FieldPath.')}function fieldPathFromDotSeparatedString(methodName,path){try{return fromDotSeparatedString(path)._internalPath}catch(e){var message=errorMessage(e);throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+methodName+'() called with invalid data. '+message)}}function errorMessage(error){return error instanceof Error?error.message:error.toString()}function throwDocChangesMethodError(){throw new FirestoreError(Code.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a '+'method, so usages like "querySnapshot.docChanges" should become '+'"querySnapshot.docChanges()"')}function validateSetOptions(methodName,options){if(void 0===options)return{merge:!1};if(validateOptionNames(methodName,options,['merge','mergeFields']),validateNamedOptionalType(methodName,'boolean','merge',options.merge),validateOptionalArrayElements(methodName,'mergeFields','a string or a FieldPath',options.mergeFields,function(element){return'string'==typeof element||element instanceof FieldPath$1}),void 0!==options.mergeFields&&void 0!==options.merge)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid options passed to function '+methodName+'(): You cannot specify both "merge" '+'and "mergeFields".');return options}function validateSnapshotOptions(methodName,options){return void 0===options?{}:(validateOptionNames(methodName,options,['serverTimestamps']),validateNamedOptionalPropertyEquals(methodName,'options','serverTimestamps',options.serverTimestamps,['estimate','previous','none']),options)}function validateGetOptions(methodName,options){validateOptionalArgType(methodName,'object',1,options),options&&(validateOptionNames(methodName,options,['source']),validateNamedOptionalPropertyEquals(methodName,'options','source',options.source,['default','server','cache']))}function validateReference(methodName,documentRef,firestore){if(!(documentRef instanceof DocumentReference))throw invalidClassError(methodName,'DocumentReference',1,documentRef);else if(documentRef.firestore!==firestore)throw new FirestoreError(Code.INVALID_ARGUMENT,'Provided document reference is from a different Firestore instance.');else return documentRef}function changesFromSnapshot(firestore,includeMetadataChanges,snapshot){if(snapshot.oldDocs.isEmpty()){var index_1=0,lastDoc_1;return snapshot.docChanges.map(function(change){var doc=new QueryDocumentSnapshot(firestore,change.doc.key,change.doc,snapshot.fromCache,snapshot.mutatedKeys.has(change.doc.key));return assert(change.type===ChangeType.Added,'Invalid event type for first snapshot'),assert(!lastDoc_1||0>snapshot.query.docComparator(lastDoc_1,change.doc),'Got added events in wrong order'),lastDoc_1=change.doc,{type:'added',doc:doc,oldIndex:-1,newIndex:index_1++}})}var indexTracker_1=snapshot.oldDocs;return snapshot.docChanges.filter(function(change){return includeMetadataChanges||change.type!==ChangeType.Metadata}).map(function(change){var doc=new QueryDocumentSnapshot(firestore,change.doc.key,change.doc,snapshot.fromCache,snapshot.mutatedKeys.has(change.doc.key)),oldIndex=-1,newIndex=-1;return change.type!==ChangeType.Added&&(oldIndex=indexTracker_1.indexOf(change.doc.key),assert(0<=oldIndex,'Index for document not found'),indexTracker_1=indexTracker_1.delete(change.doc.key)),change.type!==ChangeType.Removed&&(indexTracker_1=indexTracker_1.add(change.doc),newIndex=indexTracker_1.indexOf(change.doc.key)),{type:resultChangeType(change.type),doc:doc,oldIndex:oldIndex,newIndex:newIndex}})}function resultChangeType(type){return type===ChangeType.Added?'added':type===ChangeType.Modified||type===ChangeType.Metadata?'modified':type===ChangeType.Removed?'removed':fail('Unknown change type: '+type)}function configureForFirebase(firebase$$1){firebase$$1.INTERNAL.registerService('firestore',function(app){return new Firestore(app)},shallowCopy(firestoreNamespace))}function registerFirestore(instance){configureForFirebase(instance)}var _NumberPOSITIVE_INFINITY=Number.POSITIVE_INFINITY,_NumberNEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Object.defineProperty(exports,'__esModule',{value:!0});var firebase=function _interopDefault(ex){return ex&&'object'==typeof ex&&'default'in ex?ex['default']:ex}(__webpack_require__(13)),logger=__webpack_require__(36),tslib_1=__webpack_require__(19),webchannelWrapper=__webpack_require__(39),SDK_VERSION=firebase.SDK_VERSION,logClient=new logger.Logger('@firebase/firestore'),LogLevel;(function(LogLevel){LogLevel[LogLevel.DEBUG=0]='DEBUG',LogLevel[LogLevel.ERROR=1]='ERROR',LogLevel[LogLevel.SILENT=2]='SILENT'})(LogLevel||(LogLevel={}));var PlatformSupport=function(){function PlatformSupport(){}return PlatformSupport.setPlatform=function(platform){PlatformSupport.platform&&fail('Platform already defined'),PlatformSupport.platform=platform},PlatformSupport.getPlatform=function(){return PlatformSupport.platform||fail('Platform not set'),PlatformSupport.platform},PlatformSupport}(),Code={OK:'ok',CANCELLED:'cancelled',UNKNOWN:'unknown',INVALID_ARGUMENT:'invalid-argument',DEADLINE_EXCEEDED:'deadline-exceeded',NOT_FOUND:'not-found',ALREADY_EXISTS:'already-exists',PERMISSION_DENIED:'permission-denied',UNAUTHENTICATED:'unauthenticated',RESOURCE_EXHAUSTED:'resource-exhausted',FAILED_PRECONDITION:'failed-precondition',ABORTED:'aborted',OUT_OF_RANGE:'out-of-range',UNIMPLEMENTED:'unimplemented',INTERNAL:'internal',UNAVAILABLE:'unavailable',DATA_LOSS:'data-loss'},FirestoreError=function(_super){function FirestoreError(code,message){var _this=_super.call(this,message)||this;return _this.code=code,_this.message=message,_this.name='FirebaseError',_this.toString=function(){return _this.name+': [code='+_this.code+']: '+_this.message},_this}return tslib_1.__extends(FirestoreError,_super),FirestoreError}(Error),AutoId=function(){function AutoId(){}return AutoId.newId=function(){for(var chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',autoId='',i=0;20>i;i++)autoId+=chars.charAt(_Mathfloor(Math.random()*chars.length));return assert(20===autoId.length,'Invalid auto ID: '+autoId),autoId},AutoId}(),Blob=function(){function Blob(binaryString){assertBase64Available(),this._binaryString=binaryString}return Blob.fromBase64String=function(base64){validateExactNumberOfArgs('Blob.fromBase64String',arguments,1),validateArgType('Blob.fromBase64String','string',1,base64),assertBase64Available();try{var binaryString=PlatformSupport.getPlatform().atob(base64);return new Blob(binaryString)}catch(e){throw new FirestoreError(Code.INVALID_ARGUMENT,'Failed to construct Blob from Base64 string: '+e)}},Blob.fromUint8Array=function(array){if(validateExactNumberOfArgs('Blob.fromUint8Array',arguments,1),assertUint8ArrayAvailable(),!(array instanceof Uint8Array))throw invalidClassError('Blob.fromUint8Array','Uint8Array',1,array);var binaryString=Array.prototype.map.call(array,function(char){return String.fromCharCode(char)}).join('');return new Blob(binaryString)},Blob.prototype.toBase64=function(){return validateExactNumberOfArgs('Blob.toBase64',arguments,0),assertBase64Available(),PlatformSupport.getPlatform().btoa(this._binaryString)},Blob.prototype.toUint8Array=function(){validateExactNumberOfArgs('Blob.toUint8Array',arguments,0),assertUint8ArrayAvailable();for(var buffer=new Uint8Array(this._binaryString.length),i=0;i<this._binaryString.length;i++)buffer[i]=this._binaryString.charCodeAt(i);return buffer},Blob.prototype.toString=function(){return'Blob(base64: '+this.toBase64()+')'},Blob.prototype.isEqual=function(other){return this._binaryString===other._binaryString},Blob.prototype._compareTo=function(other){return primitiveComparator(this._binaryString,other._binaryString)},Blob}(),PublicBlob=makeConstructorPrivate(Blob,'Use Blob.fromUint8Array() or Blob.fromBase64String() instead.'),GeoPoint=function(){function GeoPoint(latitude,longitude){if(validateExactNumberOfArgs('GeoPoint',arguments,2),validateArgType('GeoPoint','number',1,latitude),validateArgType('GeoPoint','number',2,longitude),!isFinite(latitude)||-90>latitude||90<latitude)throw new FirestoreError(Code.INVALID_ARGUMENT,'Latitude must be a number between -90 and 90, but was: '+latitude);if(!isFinite(longitude)||-180>longitude||180<longitude)throw new FirestoreError(Code.INVALID_ARGUMENT,'Longitude must be a number between -180 and 180, but was: '+longitude);this._lat=latitude,this._long=longitude}return Object.defineProperty(GeoPoint.prototype,'latitude',{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(GeoPoint.prototype,'longitude',{get:function(){return this._long},enumerable:!0,configurable:!0}),GeoPoint.prototype.isEqual=function(other){return this._lat===other._lat&&this._long===other._long},GeoPoint.prototype._compareTo=function(other){return primitiveComparator(this._lat,other._lat)||primitiveComparator(this._long,other._long)},GeoPoint}(),Timestamp=function(){function Timestamp(seconds,nanoseconds){if(this.seconds=seconds,this.nanoseconds=nanoseconds,0>nanoseconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp nanoseconds out of range: '+nanoseconds);if(1e9<=nanoseconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp nanoseconds out of range: '+nanoseconds);if(-62135596800>seconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp seconds out of range: '+seconds);if(253402300800<=seconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp seconds out of range: '+seconds)}return Timestamp.now=function(){return Timestamp.fromMillis(Date.now())},Timestamp.fromDate=function(date){return Timestamp.fromMillis(date.getTime())},Timestamp.fromMillis=function(milliseconds){var seconds=_Mathfloor(milliseconds/1e3);return new Timestamp(seconds,1e6*(milliseconds-1e3*seconds))},Timestamp.prototype.toDate=function(){return new Date(this.toMillis())},Timestamp.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Timestamp.prototype._compareTo=function(other){return this.seconds===other.seconds?primitiveComparator(this.nanoseconds,other.nanoseconds):primitiveComparator(this.seconds,other.seconds)},Timestamp.prototype.isEqual=function(other){return other.seconds===this.seconds&&other.nanoseconds===this.nanoseconds},Timestamp.prototype.toString=function(){return'Timestamp(seconds='+this.seconds+', nanoseconds='+this.nanoseconds+')'},Timestamp}(),DatabaseInfo=function(){return function DatabaseInfo(databaseId,persistenceKey,host,ssl){this.databaseId=databaseId,this.persistenceKey=persistenceKey,this.host=host,this.ssl=ssl}}(),DEFAULT_DATABASE_NAME='(default)',DatabaseId=function(){function DatabaseId(projectId,database){this.projectId=projectId,this.database=database?database:DEFAULT_DATABASE_NAME}return Object.defineProperty(DatabaseId.prototype,'isDefaultDatabase',{get:function(){return this.database===DEFAULT_DATABASE_NAME},enumerable:!0,configurable:!0}),DatabaseId.prototype.isEqual=function(other){return other instanceof DatabaseId&&other.projectId===this.projectId&&other.database===this.database},DatabaseId.prototype.compareTo=function(other){return primitiveComparator(this.projectId,other.projectId)||primitiveComparator(this.database,other.database)},DatabaseId}(),DOCUMENT_KEY_NAME='__name__',Path=function(){function Path(segments,offset,length){this.init(segments,offset,length)}return Path.prototype.init=function(segments,offset,length){void 0===offset?offset=0:offset>segments.length&&fail('offset '+offset+' out of range '+segments.length),void 0===length?length=segments.length-offset:length>segments.length-offset&&fail('length '+length+' out of range '+(segments.length-offset)),this.segments=segments,this.offset=offset,this.len=length},Path.prototype.construct=function(segments,offset,length){var path=Object.create(Object.getPrototypeOf(this));return path.init(segments,offset,length),path},Object.defineProperty(Path.prototype,'length',{get:function(){return this.len},enumerable:!0,configurable:!0}),Path.prototype.isEqual=function(other){return 0===Path.comparator(this,other)},Path.prototype.child=function(nameOrPath){var segments=this.segments.slice(this.offset,this.limit());return nameOrPath instanceof Path?nameOrPath.forEach(function(segment){segments.push(segment)}):'string'==typeof nameOrPath?segments.push(nameOrPath):fail('Unknown parameter type for Path.child(): '+nameOrPath),this.construct(segments)},Path.prototype.limit=function(){return this.offset+this.length},Path.prototype.popFirst=function(size){return size=void 0===size?1:size,assert(this.length>=size,'Can\'t call popFirst() with less segments'),this.construct(this.segments,this.offset+size,this.length-size)},Path.prototype.popLast=function(){return assert(!this.isEmpty(),'Can\'t call popLast() on empty path'),this.construct(this.segments,this.offset,this.length-1)},Path.prototype.firstSegment=function(){return assert(!this.isEmpty(),'Can\'t call firstSegment() on empty path'),this.segments[this.offset]},Path.prototype.lastSegment=function(){return assert(!this.isEmpty(),'Can\'t call lastSegment() on empty path'),this.segments[this.limit()-1]},Path.prototype.get=function(index){return assert(index<this.length,'Index out of range'),this.segments[this.offset+index]},Path.prototype.isEmpty=function(){return 0===this.length},Path.prototype.isPrefixOf=function(other){if(other.length<this.length)return!1;for(var i=0;i<this.length;i++)if(this.get(i)!==other.get(i))return!1;return!0},Path.prototype.isImmediateParentOf=function(potentialChild){if(this.length+1!==potentialChild.length)return!1;for(var i=0;i<this.length;i++)if(this.get(i)!==potentialChild.get(i))return!1;return!0},Path.prototype.forEach=function(fn){for(var i=this.offset,end=this.limit();i<end;i++)fn(this.segments[i])},Path.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},Path.comparator=function(p1,p2){for(var len=_Mathmin(p1.length,p2.length),i=0;i<len;i++){var left=p1.get(i),right=p2.get(i);if(left<right)return-1;if(left>right)return 1}return p1.length<p2.length?-1:p1.length>p2.length?1:0},Path}(),ResourcePath=function(_super){function ResourcePath(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_1.__extends(ResourcePath,_super),ResourcePath.prototype.canonicalString=function(){return this.toArray().join('/')},ResourcePath.prototype.toString=function(){return this.canonicalString()},ResourcePath.fromString=function(path){if(0<=path.indexOf('//'))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid path ('+path+'). Paths must not contain // in them.');var segments=path.split('/').filter(function(segment){return 0<segment.length});return new ResourcePath(segments)},ResourcePath.EMPTY_PATH=new ResourcePath([]),ResourcePath}(Path),identifierRegExp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,FieldPath=function(_super){function FieldPath(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_1.__extends(FieldPath,_super),FieldPath.isValidIdentifier=function(segment){return identifierRegExp.test(segment)},FieldPath.prototype.canonicalString=function(){return this.toArray().map(function(str){return str=str.replace('\\','\\\\').replace('`','\\`'),FieldPath.isValidIdentifier(str)||(str='`'+str+'`'),str}).join('.')},FieldPath.prototype.toString=function(){return this.canonicalString()},FieldPath.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===DOCUMENT_KEY_NAME},FieldPath.keyField=function(){return new FieldPath([DOCUMENT_KEY_NAME])},FieldPath.fromServerFormat=function(path){for(var segments=[],current='',i=0,addCurrentSegment=function(){if(0===current.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field path ('+path+'). Paths must not be empty, begin '+'with \'.\', end with \'.\', or contain \'..\'');segments.push(current),current=''},inBackticks=!1,c;i<path.length;)if(c=path[i],'\\'===c){if(i+1===path.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Path has trailing escape character: '+path);var next=path[i+1];if('\\'!==next&&'.'!==next&&'`'!==next)throw new FirestoreError(Code.INVALID_ARGUMENT,'Path has invalid escape sequence: '+path);current+=next,i+=2}else'`'===c?(inBackticks=!inBackticks,i++):'.'!==c||inBackticks?(current+=c,i++):(addCurrentSegment(),i++);if(addCurrentSegment(),inBackticks)throw new FirestoreError(Code.INVALID_ARGUMENT,'Unterminated ` in path: '+path);return new FieldPath(segments)},FieldPath.EMPTY_PATH=new FieldPath([]),FieldPath}(Path),DocumentKey=function(){function DocumentKey(path){this.path=path,assert(DocumentKey.isDocumentKey(path),'Invalid DocumentKey with an odd number of segments: '+path.toArray().join('/'))}return DocumentKey.prototype.isEqual=function(other){return null!==other&&0===ResourcePath.comparator(this.path,other.path)},DocumentKey.prototype.toString=function(){return this.path.toString()},DocumentKey.comparator=function(k1,k2){return ResourcePath.comparator(k1.path,k2.path)},DocumentKey.isDocumentKey=function(path){return 0==path.length%2},DocumentKey.fromSegments=function(segments){return new DocumentKey(new ResourcePath(segments.slice()))},DocumentKey.fromPathString=function(path){return new DocumentKey(ResourcePath.fromString(path))},DocumentKey.EMPTY=new DocumentKey(new ResourcePath([])),DocumentKey}(),MaybeDocument=function(){function MaybeDocument(key,version){this.key=key,this.version=version}return MaybeDocument.compareByKey=function(d1,d2){return DocumentKey.comparator(d1.key,d2.key)},MaybeDocument}(),Document=function(_super){function Document(key,version,data,options){var _this=_super.call(this,key,version)||this;return _this.data=data,_this.hasLocalMutations=!!options.hasLocalMutations,_this.hasCommittedMutations=!!options.hasCommittedMutations,_this}return tslib_1.__extends(Document,_super),Document.prototype.field=function(path){return this.data.field(path)},Document.prototype.fieldValue=function(path){var field=this.field(path);return field?field.value():void 0},Document.prototype.value=function(){return this.data.value()},Document.prototype.isEqual=function(other){return other instanceof Document&&this.key.isEqual(other.key)&&this.version.isEqual(other.version)&&this.data.isEqual(other.data)&&this.hasLocalMutations===other.hasLocalMutations&&this.hasCommittedMutations===other.hasCommittedMutations},Document.prototype.toString=function(){return'Document('+this.key+', '+this.version+', '+this.data.toString()+', '+('{hasLocalMutations: '+this.hasLocalMutations+'}), ')+('{hasCommittedMutations: '+this.hasCommittedMutations+'})')},Object.defineProperty(Document.prototype,'hasPendingWrites',{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Document.compareByField=function(field,d1,d2){var v1=d1.field(field),v2=d2.field(field);return void 0!==v1&&void 0!==v2?v1.compareTo(v2):fail('Trying to compare documents on fields that don\'t exist')},Document}(MaybeDocument),NoDocument=function(_super){function NoDocument(key,version,options){var _this=_super.call(this,key,version)||this;return _this.hasCommittedMutations=!!(options&&options.hasCommittedMutations),_this}return tslib_1.__extends(NoDocument,_super),NoDocument.prototype.toString=function(){return'NoDocument('+this.key+', '+this.version+')'},Object.defineProperty(NoDocument.prototype,'hasPendingWrites',{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),NoDocument.prototype.isEqual=function(other){return other instanceof NoDocument&&other.hasCommittedMutations===this.hasCommittedMutations&&other.version.isEqual(this.version)&&other.key.isEqual(this.key)},NoDocument}(MaybeDocument),UnknownDocument=function(_super){function UnknownDocument(key,version){return _super.call(this,key,version)||this}return tslib_1.__extends(UnknownDocument,_super),UnknownDocument.prototype.toString=function(){return'UnknownDocument('+this.key+', '+this.version+')'},Object.defineProperty(UnknownDocument.prototype,'hasPendingWrites',{get:function(){return!0},enumerable:!0,configurable:!0}),UnknownDocument.prototype.isEqual=function(other){return other instanceof UnknownDocument&&other.version.isEqual(this.version)&&other.key.isEqual(this.key)},UnknownDocument}(MaybeDocument),SortedMap=function(){function SortedMap(comparator,root){this.comparator=comparator,this.root=root?root:LLRBNode.EMPTY}return SortedMap.prototype.insert=function(key,value){return new SortedMap(this.comparator,this.root.insert(key,value,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.remove=function(key){return new SortedMap(this.comparator,this.root.remove(key,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.get=function(key){for(var node=this.root,cmp;!node.isEmpty();){if(cmp=this.comparator(key,node.key),0===cmp)return node.value;0>cmp?node=node.left:0<cmp&&(node=node.right)}return null},SortedMap.prototype.indexOf=function(key){for(var prunedNodes=0,node=this.root,cmp;!node.isEmpty();){if(cmp=this.comparator(key,node.key),0===cmp)return prunedNodes+node.left.size;0>cmp?node=node.left:(prunedNodes+=node.left.size+1,node=node.right)}return-1},SortedMap.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(SortedMap.prototype,'size',{get:function(){return this.root.size},enumerable:!0,configurable:!0}),SortedMap.prototype.minKey=function(){return this.root.minKey()},SortedMap.prototype.maxKey=function(){return this.root.maxKey()},SortedMap.prototype.inorderTraversal=function(action){return this.root.inorderTraversal(action)},SortedMap.prototype.forEach=function(fn){this.inorderTraversal(function(k,v){return fn(k,v),!1})},SortedMap.prototype.reverseTraversal=function(action){return this.root.reverseTraversal(action)},SortedMap.prototype.getIterator=function(){return new SortedMapIterator(this.root,null,this.comparator,!1)},SortedMap.prototype.getIteratorFrom=function(key){return new SortedMapIterator(this.root,key,this.comparator,!1)},SortedMap.prototype.getReverseIterator=function(){return new SortedMapIterator(this.root,null,this.comparator,!0)},SortedMap.prototype.getReverseIteratorFrom=function(key){return new SortedMapIterator(this.root,key,this.comparator,!0)},SortedMap}(),SortedMapIterator=function(){function SortedMapIterator(node,startKey,comparator,isReverse){this.isReverse=isReverse,this.nodeStack=[];for(var cmp=1;!node.isEmpty();)if(cmp=startKey?comparator(node.key,startKey):1,isReverse&&(cmp*=-1),0>cmp)node=this.isReverse?node.left:node.right;else if(0===cmp){this.nodeStack.push(node);break}else this.nodeStack.push(node),node=this.isReverse?node.right:node.left}return SortedMapIterator.prototype.getNext=function(){assert(0<this.nodeStack.length,'getNext() called on iterator when hasNext() is false.');var node=this.nodeStack.pop(),result={key:node.key,value:node.value};if(this.isReverse)for(node=node.left;!node.isEmpty();)this.nodeStack.push(node),node=node.right;else for(node=node.right;!node.isEmpty();)this.nodeStack.push(node),node=node.left;return result},SortedMapIterator.prototype.hasNext=function(){return 0<this.nodeStack.length},SortedMapIterator.prototype.peek=function(){if(0===this.nodeStack.length)return null;var node=this.nodeStack[this.nodeStack.length-1];return{key:node.key,value:node.value}},SortedMapIterator}(),LLRBNode=function(){function LLRBNode(key,value,color,left,right){this.key=key,this.value=value,this.color=null==color?LLRBNode.RED:color,this.left=null==left?LLRBNode.EMPTY:left,this.right=null==right?LLRBNode.EMPTY:right,this.size=this.left.size+1+this.right.size}return LLRBNode.prototype.copy=function(key,value,color,left,right){return new LLRBNode(null==key?this.key:key,null==value?this.value:value,null==color?this.color:color,null==left?this.left:left,null==right?this.right:right)},LLRBNode.prototype.isEmpty=function(){return!1},LLRBNode.prototype.inorderTraversal=function(action){return this.left.inorderTraversal(action)||action(this.key,this.value)||this.right.inorderTraversal(action)},LLRBNode.prototype.reverseTraversal=function(action){return this.right.reverseTraversal(action)||action(this.key,this.value)||this.left.reverseTraversal(action)},LLRBNode.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},LLRBNode.prototype.minKey=function(){return this.min().key},LLRBNode.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},LLRBNode.prototype.insert=function(key,value,comparator){var n=this,cmp=comparator(key,n.key);return n=0>cmp?n.copy(null,null,null,n.left.insert(key,value,comparator),null):0===cmp?n.copy(null,value,null,null,null):n.copy(null,null,null,null,n.right.insert(key,value,comparator)),n.fixUp()},LLRBNode.prototype.removeMin=function(){if(this.left.isEmpty())return LLRBNode.EMPTY;var n=this;return n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.removeMin(),null),n.fixUp()},LLRBNode.prototype.remove=function(key,comparator){var n=this,smallest;if(0>comparator(key,n.key))n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(key,comparator),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===comparator(key,n.key)){if(n.right.isEmpty())return LLRBNode.EMPTY;smallest=n.right.min(),n=n.copy(smallest.key,smallest.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(key,comparator))}return n.fixUp()},LLRBNode.prototype.isRed=function(){return this.color},LLRBNode.prototype.fixUp=function(){var n=this;return n.right.isRed()&&!n.left.isRed()&&(n=n.rotateLeft()),n.left.isRed()&&n.left.left.isRed()&&(n=n.rotateRight()),n.left.isRed()&&n.right.isRed()&&(n=n.colorFlip()),n},LLRBNode.prototype.moveRedLeft=function(){var n=this.colorFlip();return n.right.left.isRed()&&(n=n.copy(null,null,null,null,n.right.rotateRight()),n=n.rotateLeft(),n=n.colorFlip()),n},LLRBNode.prototype.moveRedRight=function(){var n=this.colorFlip();return n.left.left.isRed()&&(n=n.rotateRight(),n=n.colorFlip()),n},LLRBNode.prototype.rotateLeft=function(){var nl=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,nl,null)},LLRBNode.prototype.rotateRight=function(){var nr=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,nr)},LLRBNode.prototype.colorFlip=function(){var left=this.left.copy(null,null,!this.left.color,null,null),right=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,left,right)},LLRBNode.prototype.checkMaxDepth=function(){var blackDepth=this.check();return!!(Math.pow(2,blackDepth)<=this.size+1)},LLRBNode.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw fail('Red node has red child('+this.key+','+this.value+')');if(this.right.isRed())throw fail('Right child of ('+this.key+','+this.value+') is red');var blackDepth=this.left.check();if(blackDepth!==this.right.check())throw fail('Black depths differ');else return blackDepth+(this.isRed()?0:1)},LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1,LLRBNode}(),LLRBEmptyNode=function(){function LLRBEmptyNode(){this.size=0}return LLRBEmptyNode.prototype.copy=function(){return this},LLRBEmptyNode.prototype.insert=function(key,value){return new LLRBNode(key,value)},LLRBEmptyNode.prototype.remove=function(){return this},LLRBEmptyNode.prototype.isEmpty=function(){return!0},LLRBEmptyNode.prototype.inorderTraversal=function(){return!1},LLRBEmptyNode.prototype.reverseTraversal=function(){return!1},LLRBEmptyNode.prototype.minKey=function(){return null},LLRBEmptyNode.prototype.maxKey=function(){return null},LLRBEmptyNode.prototype.isRed=function(){return!1},LLRBEmptyNode.prototype.checkMaxDepth=function(){return!0},LLRBEmptyNode.prototype.check=function(){return 0},LLRBEmptyNode}();LLRBNode.EMPTY=new LLRBEmptyNode;var TypeOrder;(function(TypeOrder){TypeOrder[TypeOrder.NullValue=0]='NullValue',TypeOrder[TypeOrder.BooleanValue=1]='BooleanValue',TypeOrder[TypeOrder.NumberValue=2]='NumberValue',TypeOrder[TypeOrder.TimestampValue=3]='TimestampValue',TypeOrder[TypeOrder.StringValue=4]='StringValue',TypeOrder[TypeOrder.BlobValue=5]='BlobValue',TypeOrder[TypeOrder.RefValue=6]='RefValue',TypeOrder[TypeOrder.GeoPointValue=7]='GeoPointValue',TypeOrder[TypeOrder.ArrayValue=8]='ArrayValue',TypeOrder[TypeOrder.ObjectValue=9]='ObjectValue'})(TypeOrder||(TypeOrder={}));var ServerTimestampBehavior;(function(ServerTimestampBehavior){ServerTimestampBehavior[ServerTimestampBehavior.Default=0]='Default',ServerTimestampBehavior[ServerTimestampBehavior.Estimate=1]='Estimate',ServerTimestampBehavior[ServerTimestampBehavior.Previous=2]='Previous'})(ServerTimestampBehavior||(ServerTimestampBehavior={}));var FieldValueOptions=function(){function FieldValueOptions(serverTimestampBehavior,timestampsInSnapshots){this.serverTimestampBehavior=serverTimestampBehavior,this.timestampsInSnapshots=timestampsInSnapshots}return FieldValueOptions.fromSnapshotOptions=function(options,timestampsInSnapshots){switch(options.serverTimestamps){case'estimate':return new FieldValueOptions(ServerTimestampBehavior.Estimate,timestampsInSnapshots);case'previous':return new FieldValueOptions(ServerTimestampBehavior.Previous,timestampsInSnapshots);case'none':case void 0:return new FieldValueOptions(ServerTimestampBehavior.Default,timestampsInSnapshots);default:return fail('fromSnapshotOptions() called with invalid options.');}},FieldValueOptions}(),FieldValue=function(){function FieldValue(){}return FieldValue.prototype.toString=function(){var val=this.value();return null===val?'null':val.toString()},FieldValue.prototype.defaultCompareTo=function(other){assert(this.typeOrder!==other.typeOrder,'Default compareTo should not be used for values of same type.');var cmp=primitiveComparator(this.typeOrder,other.typeOrder);return cmp},FieldValue}(),NullValue=function(_super){function NullValue(){var _this=_super.call(this)||this;return _this.typeOrder=TypeOrder.NullValue,_this.internalValue=null,_this}return tslib_1.__extends(NullValue,_super),NullValue.prototype.value=function(){return null},NullValue.prototype.isEqual=function(other){return other instanceof NullValue},NullValue.prototype.compareTo=function(other){return other instanceof NullValue?0:this.defaultCompareTo(other)},NullValue.INSTANCE=new NullValue,NullValue}(FieldValue),BooleanValue=function(_super){function BooleanValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.BooleanValue,_this}return tslib_1.__extends(BooleanValue,_super),BooleanValue.prototype.value=function(){return this.internalValue},BooleanValue.prototype.isEqual=function(other){return other instanceof BooleanValue&&this.internalValue===other.internalValue},BooleanValue.prototype.compareTo=function(other){return other instanceof BooleanValue?primitiveComparator(this,other):this.defaultCompareTo(other)},BooleanValue.of=function(value){return value?BooleanValue.TRUE:BooleanValue.FALSE},BooleanValue.TRUE=new BooleanValue(!0),BooleanValue.FALSE=new BooleanValue(!1),BooleanValue}(FieldValue),NumberValue=function(_super){function NumberValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.NumberValue,_this}return tslib_1.__extends(NumberValue,_super),NumberValue.prototype.value=function(){return this.internalValue},NumberValue.prototype.compareTo=function(other){return other instanceof NumberValue?numericComparator(this.internalValue,other.internalValue):this.defaultCompareTo(other)},NumberValue}(FieldValue),IntegerValue=function(_super){function IntegerValue(internalValue){return _super.call(this,internalValue)||this}return tslib_1.__extends(IntegerValue,_super),IntegerValue.prototype.isEqual=function(other){return!!(other instanceof IntegerValue)&&numericEquals(this.internalValue,other.internalValue)},IntegerValue}(NumberValue),DoubleValue=function(_super){function DoubleValue(internalValue){var _this=_super.call(this,internalValue)||this;return _this.internalValue=internalValue,_this}return tslib_1.__extends(DoubleValue,_super),DoubleValue.prototype.isEqual=function(other){return!!(other instanceof DoubleValue)&&numericEquals(this.internalValue,other.internalValue)},DoubleValue.NAN=new DoubleValue(NaN),DoubleValue.POSITIVE_INFINITY=new DoubleValue(Infinity),DoubleValue.NEGATIVE_INFINITY=new DoubleValue(-Infinity),DoubleValue}(NumberValue),StringValue=function(_super){function StringValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.StringValue,_this}return tslib_1.__extends(StringValue,_super),StringValue.prototype.value=function(){return this.internalValue},StringValue.prototype.isEqual=function(other){return other instanceof StringValue&&this.internalValue===other.internalValue},StringValue.prototype.compareTo=function(other){return other instanceof StringValue?primitiveComparator(this.internalValue,other.internalValue):this.defaultCompareTo(other)},StringValue}(FieldValue),TimestampValue=function(_super){function TimestampValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.TimestampValue,_this}return tslib_1.__extends(TimestampValue,_super),TimestampValue.prototype.value=function(options){return options&&options.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},TimestampValue.prototype.isEqual=function(other){return other instanceof TimestampValue&&this.internalValue.isEqual(other.internalValue)},TimestampValue.prototype.compareTo=function(other){return other instanceof TimestampValue?this.internalValue._compareTo(other.internalValue):other instanceof ServerTimestampValue?-1:this.defaultCompareTo(other)},TimestampValue}(FieldValue),ServerTimestampValue=function(_super){function ServerTimestampValue(localWriteTime,previousValue){var _this=_super.call(this)||this;return _this.localWriteTime=localWriteTime,_this.previousValue=previousValue,_this.typeOrder=TypeOrder.TimestampValue,_this}return tslib_1.__extends(ServerTimestampValue,_super),ServerTimestampValue.prototype.value=function(options){return options&&options.serverTimestampBehavior===ServerTimestampBehavior.Estimate?new TimestampValue(this.localWriteTime).value(options):options&&options.serverTimestampBehavior===ServerTimestampBehavior.Previous?this.previousValue?this.previousValue.value(options):null:null},ServerTimestampValue.prototype.isEqual=function(other){return other instanceof ServerTimestampValue&&this.localWriteTime.isEqual(other.localWriteTime)},ServerTimestampValue.prototype.compareTo=function(other){return other instanceof ServerTimestampValue?this.localWriteTime._compareTo(other.localWriteTime):other instanceof TimestampValue?1:this.defaultCompareTo(other)},ServerTimestampValue.prototype.toString=function(){return'<ServerTimestamp localTime='+this.localWriteTime.toString()+'>'},ServerTimestampValue}(FieldValue),BlobValue=function(_super){function BlobValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.BlobValue,_this}return tslib_1.__extends(BlobValue,_super),BlobValue.prototype.value=function(){return this.internalValue},BlobValue.prototype.isEqual=function(other){return other instanceof BlobValue&&this.internalValue.isEqual(other.internalValue)},BlobValue.prototype.compareTo=function(other){return other instanceof BlobValue?this.internalValue._compareTo(other.internalValue):this.defaultCompareTo(other)},BlobValue}(FieldValue),RefValue=function(_super){function RefValue(databaseId,key){var _this=_super.call(this)||this;return _this.databaseId=databaseId,_this.key=key,_this.typeOrder=TypeOrder.RefValue,_this}return tslib_1.__extends(RefValue,_super),RefValue.prototype.value=function(){return this.key},RefValue.prototype.isEqual=function(other){return!!(other instanceof RefValue)&&this.key.isEqual(other.key)&&this.databaseId.isEqual(other.databaseId)},RefValue.prototype.compareTo=function(other){if(other instanceof RefValue){var cmp=this.databaseId.compareTo(other.databaseId);return 0===cmp?DocumentKey.comparator(this.key,other.key):cmp}return this.defaultCompareTo(other)},RefValue}(FieldValue),GeoPointValue=function(_super){function GeoPointValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.GeoPointValue,_this}return tslib_1.__extends(GeoPointValue,_super),GeoPointValue.prototype.value=function(){return this.internalValue},GeoPointValue.prototype.isEqual=function(other){return other instanceof GeoPointValue&&this.internalValue.isEqual(other.internalValue)},GeoPointValue.prototype.compareTo=function(other){return other instanceof GeoPointValue?this.internalValue._compareTo(other.internalValue):this.defaultCompareTo(other)},GeoPointValue}(FieldValue),ObjectValue=function(_super){function ObjectValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.ObjectValue,_this}return tslib_1.__extends(ObjectValue,_super),ObjectValue.prototype.value=function(options){var result={};return this.internalValue.inorderTraversal(function(key,val){result[key]=val.value(options)}),result},ObjectValue.prototype.forEach=function(action){this.internalValue.inorderTraversal(action)},ObjectValue.prototype.isEqual=function(other){if(other instanceof ObjectValue){for(var it1=this.internalValue.getIterator(),it2=other.internalValue.getIterator();it1.hasNext()&&it2.hasNext();){var next1=it1.getNext(),next2=it2.getNext();if(next1.key!==next2.key||!next1.value.isEqual(next2.value))return!1}return!it1.hasNext()&&!it2.hasNext()}return!1},ObjectValue.prototype.compareTo=function(other){if(other instanceof ObjectValue){for(var it1=this.internalValue.getIterator(),it2=other.internalValue.getIterator();it1.hasNext()&&it2.hasNext();){var next1=it1.getNext(),next2=it2.getNext(),cmp=primitiveComparator(next1.key,next2.key)||next1.value.compareTo(next2.value);if(cmp)return cmp}return primitiveComparator(it1.hasNext(),it2.hasNext())}return this.defaultCompareTo(other)},ObjectValue.prototype.set=function(path,to){if(assert(!path.isEmpty(),'Cannot set field for empty path on ObjectValue'),1===path.length)return this.setChild(path.firstSegment(),to);var child=this.child(path.firstSegment());child instanceof ObjectValue||(child=ObjectValue.EMPTY);var newChild=child.set(path.popFirst(),to);return this.setChild(path.firstSegment(),newChild)},ObjectValue.prototype.delete=function(path){if(assert(!path.isEmpty(),'Cannot delete field for empty path on ObjectValue'),1===path.length)return new ObjectValue(this.internalValue.remove(path.firstSegment()));var child=this.child(path.firstSegment());if(child instanceof ObjectValue){var newChild=child.delete(path.popFirst());return new ObjectValue(this.internalValue.insert(path.firstSegment(),newChild))}return this},ObjectValue.prototype.contains=function(path){return void 0!==this.field(path)},ObjectValue.prototype.field=function(path){assert(!path.isEmpty(),'Can\'t get field of empty path');var field=this;return path.forEach(function(pathSegment){field=field instanceof ObjectValue?field.internalValue.get(pathSegment)||void 0:void 0}),field},ObjectValue.prototype.toString=function(){return JSON.stringify(this.value())},ObjectValue.prototype.child=function(childName){return this.internalValue.get(childName)||void 0},ObjectValue.prototype.setChild=function(childName,value){return new ObjectValue(this.internalValue.insert(childName,value))},ObjectValue.EMPTY=new ObjectValue(new SortedMap(primitiveComparator)),ObjectValue}(FieldValue),ArrayValue=function(_super){function ArrayValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.ArrayValue,_this}return tslib_1.__extends(ArrayValue,_super),ArrayValue.prototype.value=function(options){return this.internalValue.map(function(v){return v.value(options)})},ArrayValue.prototype.forEach=function(action){this.internalValue.forEach(action)},ArrayValue.prototype.isEqual=function(other){if(other instanceof ArrayValue){if(this.internalValue.length!==other.internalValue.length)return!1;for(var i=0;i<this.internalValue.length;i++)if(!this.internalValue[i].isEqual(other.internalValue[i]))return!1;return!0}return!1},ArrayValue.prototype.compareTo=function(other){if(other instanceof ArrayValue){for(var minLength=_Mathmin(this.internalValue.length,other.internalValue.length),i=0,cmp;i<minLength;i++)if(cmp=this.internalValue[i].compareTo(other.internalValue[i]),cmp)return cmp;return primitiveComparator(this.internalValue.length,other.internalValue.length)}return this.defaultCompareTo(other)},ArrayValue.prototype.toString=function(){return JSON.stringify(this.value())},ArrayValue}(FieldValue),NumberAsAny=Number,MIN_SAFE_INTEGER=NumberAsAny.MIN_SAFE_INTEGER||-(9007199254740992-1),MAX_SAFE_INTEGER=NumberAsAny.MAX_SAFE_INTEGER||9007199254740992-1,isInteger=NumberAsAny.isInteger||function(value){return'number'==typeof value&&isFinite(value)&&_Mathfloor(value)===value},Query=function(){function Query(path,explicitOrderBy,filters,limit,startAt,endAt){void 0===explicitOrderBy&&(explicitOrderBy=[]),void 0===filters&&(filters=[]),void 0===limit&&(limit=null),void 0===startAt&&(startAt=null),void 0===endAt&&(endAt=null),this.path=path,this.explicitOrderBy=explicitOrderBy,this.filters=filters,this.limit=limit,this.startAt=startAt,this.endAt=endAt,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return Query.atPath=function(path){return new Query(path)},Object.defineProperty(Query.prototype,'orderBy',{get:function(){if(null===this.memoizedOrderBy){var inequalityField=this.getInequalityFilterField(),firstOrderByField=this.getFirstOrderByField();if(null!==inequalityField&&null===firstOrderByField)this.memoizedOrderBy=inequalityField.isKeyField()?[KEY_ORDERING_ASC]:[new OrderBy(inequalityField),KEY_ORDERING_ASC];else{assert(null===inequalityField||null!==firstOrderByField&&inequalityField.isEqual(firstOrderByField),'First orderBy should match inequality field.'),this.memoizedOrderBy=[];for(var foundKeyOrdering=!1,_i=0,_a=this.explicitOrderBy,orderBy;_i<_a.length;_i++)orderBy=_a[_i],this.memoizedOrderBy.push(orderBy),orderBy.field.isKeyField()&&(foundKeyOrdering=!0);if(!foundKeyOrdering){var lastDirection=0<this.explicitOrderBy.length?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Direction.ASCENDING;this.memoizedOrderBy.push(lastDirection===Direction.ASCENDING?KEY_ORDERING_ASC:KEY_ORDERING_DESC)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),Query.prototype.addFilter=function(filter){assert(null==this.getInequalityFilterField()||!(filter instanceof RelationFilter)||!filter.isInequality()||filter.field.isEqual(this.getInequalityFilterField()),'Query must only have one inequality field.'),assert(!DocumentKey.isDocumentKey(this.path),'No filtering allowed for document query');var newFilters=this.filters.concat([filter]);return new Query(this.path,this.explicitOrderBy.slice(),newFilters,this.limit,this.startAt,this.endAt)},Query.prototype.addOrderBy=function(orderBy){assert(!DocumentKey.isDocumentKey(this.path),'No ordering allowed for document query'),assert(!this.startAt&&!this.endAt,'Bounds must be set after orderBy');var newOrderBy=this.explicitOrderBy.concat([orderBy]);return new Query(this.path,newOrderBy,this.filters.slice(),this.limit,this.startAt,this.endAt)},Query.prototype.withLimit=function(limit){return new Query(this.path,this.explicitOrderBy.slice(),this.filters.slice(),limit,this.startAt,this.endAt)},Query.prototype.withStartAt=function(bound){return new Query(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,bound,this.endAt)},Query.prototype.withEndAt=function(bound){return new Query(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,bound)},Query.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var canonicalId=this.path.canonicalString();canonicalId+='|f:';for(var _i=0,_a=this.filters,filter;_i<_a.length;_i++)filter=_a[_i],canonicalId+=filter.canonicalId(),canonicalId+=',';canonicalId+='|ob:';for(var _b=0,_c=this.orderBy,orderBy;_b<_c.length;_b++)orderBy=_c[_b],canonicalId+=orderBy.canonicalId(),canonicalId+=',';isNullOrUndefined(this.limit)||(canonicalId+='|l:',canonicalId+=this.limit),this.startAt&&(canonicalId+='|lb:',canonicalId+=this.startAt.canonicalId()),this.endAt&&(canonicalId+='|ub:',canonicalId+=this.endAt.canonicalId()),this.memoizedCanonicalId=canonicalId}return this.memoizedCanonicalId},Query.prototype.toString=function(){var str='Query('+this.path.canonicalString();return 0<this.filters.length&&(str+=', filters: ['+this.filters.join(', ')+']'),isNullOrUndefined(this.limit)||(str+=', limit: '+this.limit),0<this.explicitOrderBy.length&&(str+=', orderBy: ['+this.explicitOrderBy.join(', ')+']'),this.startAt&&(str+=', startAt: '+this.startAt.canonicalId()),this.endAt&&(str+=', endAt: '+this.endAt.canonicalId()),str+')'},Query.prototype.isEqual=function(other){if(this.limit!==other.limit)return!1;if(this.orderBy.length!==other.orderBy.length)return!1;for(var i=0;i<this.orderBy.length;i++)if(!this.orderBy[i].isEqual(other.orderBy[i]))return!1;if(this.filters.length!==other.filters.length)return!1;for(var i=0;i<this.filters.length;i++)if(!this.filters[i].isEqual(other.filters[i]))return!1;return!!this.path.isEqual(other.path)&&(null===this.startAt?null===other.startAt:!!this.startAt.isEqual(other.startAt))&&(null===this.endAt?null===other.endAt:this.endAt.isEqual(other.endAt))},Query.prototype.docComparator=function(d1,d2){for(var comparedOnKeyField=!1,_i=0,_a=this.orderBy;_i<_a.length;_i++){var orderBy=_a[_i],comp=orderBy.compare(d1,d2);if(0!==comp)return comp;comparedOnKeyField=comparedOnKeyField||orderBy.field.isKeyField()}return assert(comparedOnKeyField,'orderBy used that doesn\'t compare on key field'),0},Query.prototype.matches=function(doc){return this.matchesAncestor(doc)&&this.matchesOrderBy(doc)&&this.matchesFilters(doc)&&this.matchesBounds(doc)},Query.prototype.hasLimit=function(){return!isNullOrUndefined(this.limit)},Query.prototype.getFirstOrderByField=function(){return 0<this.explicitOrderBy.length?this.explicitOrderBy[0].field:null},Query.prototype.getInequalityFilterField=function(){for(var _i=0,_a=this.filters,filter;_i<_a.length;_i++)if(filter=_a[_i],filter instanceof RelationFilter&&filter.isInequality())return filter.field;return null},Query.prototype.hasArrayContainsFilter=function(){return void 0!==this.filters.find(function(filter){return filter instanceof RelationFilter&&filter.op===RelationOp.ARRAY_CONTAINS})},Query.prototype.isDocumentQuery=function(){return DocumentKey.isDocumentKey(this.path)&&0===this.filters.length},Query.prototype.matchesAncestor=function(doc){var docPath=doc.key.path;return DocumentKey.isDocumentKey(this.path)?this.path.isEqual(docPath):this.path.isPrefixOf(docPath)&&this.path.length===docPath.length-1},Query.prototype.matchesOrderBy=function(doc){for(var _i=0,_a=this.explicitOrderBy,orderBy;_i<_a.length;_i++)if(orderBy=_a[_i],!orderBy.field.isKeyField()&&void 0===doc.field(orderBy.field))return!1;return!0},Query.prototype.matchesFilters=function(doc){for(var _i=0,_a=this.filters,filter;_i<_a.length;_i++)if(filter=_a[_i],!filter.matches(doc))return!1;return!0},Query.prototype.matchesBounds=function(doc){return this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,doc)?!1:this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,doc)?!1:!0},Query.prototype.assertValidBound=function(bound){assert(bound.position.length<=this.orderBy.length,'Bound is longer than orderBy')},Query}(),Filter=function(){function Filter(){}return Filter.create=function(field,op,value){if(value.isEqual(NullValue.INSTANCE)){if(op!==RelationOp.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You can only perform equals comparisons on null.');return new NullFilter(field)}if(value.isEqual(DoubleValue.NAN)){if(op!==RelationOp.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You can only perform equals comparisons on NaN.');return new NanFilter(field)}return new RelationFilter(field,op,value)},Filter}(),RelationOp=function(){function RelationOp(name){this.name=name}return RelationOp.fromString=function(op){return'<'===op?RelationOp.LESS_THAN:'<='===op?RelationOp.LESS_THAN_OR_EQUAL:'=='===op?RelationOp.EQUAL:'>='===op?RelationOp.GREATER_THAN_OR_EQUAL:'>'===op?RelationOp.GREATER_THAN:'array-contains'===op?RelationOp.ARRAY_CONTAINS:fail('Unknown relation: '+op)},RelationOp.prototype.toString=function(){return this.name},RelationOp.prototype.isEqual=function(other){return this.name===other.name},RelationOp.LESS_THAN=new RelationOp('<'),RelationOp.LESS_THAN_OR_EQUAL=new RelationOp('<='),RelationOp.EQUAL=new RelationOp('=='),RelationOp.GREATER_THAN=new RelationOp('>'),RelationOp.GREATER_THAN_OR_EQUAL=new RelationOp('>='),RelationOp.ARRAY_CONTAINS=new RelationOp('array-contains'),RelationOp}(),RelationFilter=function(_super){function RelationFilter(field,op,value){var _this=_super.call(this)||this;return _this.field=field,_this.op=op,_this.value=value,_this}return tslib_1.__extends(RelationFilter,_super),RelationFilter.prototype.matches=function(doc){if(this.field.isKeyField()){assert(this.value instanceof RefValue,'Comparing on key, but filter value not a RefValue'),assert(this.op!==RelationOp.ARRAY_CONTAINS,'array-contains queries don\'t make sense on document keys.');var refValue=this.value,comparison=DocumentKey.comparator(doc.key,refValue.key);return this.matchesComparison(comparison)}var val=doc.field(this.field);return void 0!==val&&this.matchesValue(val)},RelationFilter.prototype.matchesValue=function(value){var _this=this;return this.op===RelationOp.ARRAY_CONTAINS?value instanceof ArrayValue&&void 0!==value.internalValue.find(function(element){return element.isEqual(_this.value)}):this.value.typeOrder===value.typeOrder&&this.matchesComparison(value.compareTo(this.value))},RelationFilter.prototype.matchesComparison=function(comparison){switch(this.op){case RelationOp.LESS_THAN:return 0>comparison;case RelationOp.LESS_THAN_OR_EQUAL:return 0>=comparison;case RelationOp.EQUAL:return 0===comparison;case RelationOp.GREATER_THAN:return 0<comparison;case RelationOp.GREATER_THAN_OR_EQUAL:return 0<=comparison;default:return fail('Unknown relation op'+this.op);}},RelationFilter.prototype.isInequality=function(){return this.op!==RelationOp.EQUAL&&this.op!==RelationOp.ARRAY_CONTAINS},RelationFilter.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},RelationFilter.prototype.isEqual=function(other){return!!(other instanceof RelationFilter)&&this.op.isEqual(other.op)&&this.field.isEqual(other.field)&&this.value.isEqual(other.value)},RelationFilter.prototype.toString=function(){return this.field.canonicalString()+' '+this.op+' '+this.value.value()},RelationFilter}(Filter),NullFilter=function(_super){function NullFilter(field){var _this=_super.call(this)||this;return _this.field=field,_this}return tslib_1.__extends(NullFilter,_super),NullFilter.prototype.matches=function(doc){var val=doc.field(this.field);return void 0!==val&&null===val.value()},NullFilter.prototype.canonicalId=function(){return this.field.canonicalString()+' IS null'},NullFilter.prototype.toString=function(){return this.field.canonicalString()+' IS null'},NullFilter.prototype.isEqual=function(other){return!!(other instanceof NullFilter)&&this.field.isEqual(other.field)},NullFilter}(Filter),NanFilter=function(_super){function NanFilter(field){var _this=_super.call(this)||this;return _this.field=field,_this}return tslib_1.__extends(NanFilter,_super),NanFilter.prototype.matches=function(doc){var field=doc.field(this.field),val=field&&field.value();return'number'==typeof val&&isNaN(val)},NanFilter.prototype.canonicalId=function(){return this.field.canonicalString()+' IS NaN'},NanFilter.prototype.toString=function(){return this.field.canonicalString()+' IS NaN'},NanFilter.prototype.isEqual=function(other){return!!(other instanceof NanFilter)&&this.field.isEqual(other.field)},NanFilter}(Filter),Direction=function(){function Direction(name){this.name=name}return Direction.prototype.toString=function(){return this.name},Direction.ASCENDING=new Direction('asc'),Direction.DESCENDING=new Direction('desc'),Direction}(),Bound=function(){function Bound(position,before){this.position=position,this.before=before}return Bound.prototype.canonicalId=function(){for(var canonicalId=this.before?'b:':'a:',_i=0,_a=this.position,component;_i<_a.length;_i++)component=_a[_i],canonicalId+=component.toString();return canonicalId},Bound.prototype.sortsBeforeDocument=function(orderBy,doc){assert(this.position.length<=orderBy.length,'Bound has more components than query\'s orderBy');for(var comparison=0,i=0;i<this.position.length;i++){var orderByComponent=orderBy[i],component=this.position[i];if(orderByComponent.field.isKeyField())assert(component instanceof RefValue,'Bound has a non-key value where the key path is being used.'),comparison=DocumentKey.comparator(component.key,doc.key);else{var docValue=doc.field(orderByComponent.field);assert(void 0!==docValue,'Field should exist since document matched the orderBy already.'),comparison=component.compareTo(docValue)}if(orderByComponent.dir===Direction.DESCENDING&&(comparison*=-1),0!==comparison)break}return this.before?0>=comparison:0>comparison},Bound.prototype.isEqual=function(other){if(null===other)return!1;if(this.before!==other.before||this.position.length!==other.position.length)return!1;for(var i=0;i<this.position.length;i++){var thisPosition=this.position[i],otherPosition=other.position[i];return thisPosition.isEqual(otherPosition)}return!0},Bound}(),OrderBy=function(){function OrderBy(field,dir){this.field=field,void 0===dir&&(dir=Direction.ASCENDING),this.dir=dir,this.isKeyOrderBy=field.isKeyField()}return OrderBy.prototype.compare=function(d1,d2){var comparison=this.isKeyOrderBy?Document.compareByKey(d1,d2):Document.compareByField(this.field,d1,d2);switch(this.dir){case Direction.ASCENDING:return comparison;case Direction.DESCENDING:return-1*comparison;default:return fail('Unknown direction: '+this.dir);}},OrderBy.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},OrderBy.prototype.toString=function(){return this.field.canonicalString()+' ('+this.dir+')'},OrderBy.prototype.isEqual=function(other){return this.dir===other.dir&&this.field.isEqual(other.field)},OrderBy}(),KEY_ORDERING_ASC=new OrderBy(FieldPath.keyField(),Direction.ASCENDING),KEY_ORDERING_DESC=new OrderBy(FieldPath.keyField(),Direction.DESCENDING),SnapshotVersion=function(){function SnapshotVersion(timestamp){this.timestamp=timestamp}return SnapshotVersion.fromMicroseconds=function(value){var seconds=_Mathfloor(value/1e6);return new SnapshotVersion(new Timestamp(seconds,1e3*(value%1e6)))},SnapshotVersion.fromTimestamp=function(value){return new SnapshotVersion(value)},SnapshotVersion.forDeletedDoc=function(){return SnapshotVersion.MIN},SnapshotVersion.prototype.compareTo=function(other){return this.timestamp._compareTo(other.timestamp)},SnapshotVersion.prototype.isEqual=function(other){return this.timestamp.isEqual(other.timestamp)},SnapshotVersion.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},SnapshotVersion.prototype.toString=function(){return'SnapshotVersion('+this.timestamp.toString()+')'},SnapshotVersion.prototype.toTimestamp=function(){return this.timestamp},SnapshotVersion.MIN=new SnapshotVersion(new Timestamp(0,0)),SnapshotVersion}(),QueryPurpose;(function(QueryPurpose){QueryPurpose[QueryPurpose.Listen=0]='Listen',QueryPurpose[QueryPurpose.ExistenceFilterMismatch=1]='ExistenceFilterMismatch',QueryPurpose[QueryPurpose.LimboResolution=2]='LimboResolution'})(QueryPurpose||(QueryPurpose={}));var QueryData=function(){function QueryData(query,targetId,purpose,sequenceNumber,snapshotVersion,resumeToken){void 0===snapshotVersion&&(snapshotVersion=SnapshotVersion.MIN),void 0===resumeToken&&(resumeToken=emptyByteString()),this.query=query,this.targetId=targetId,this.purpose=purpose,this.sequenceNumber=sequenceNumber,this.snapshotVersion=snapshotVersion,this.resumeToken=resumeToken}return QueryData.prototype.copy=function(overwrite){return new QueryData(this.query,this.targetId,this.purpose,void 0===overwrite.sequenceNumber?this.sequenceNumber:overwrite.sequenceNumber,void 0===overwrite.snapshotVersion?this.snapshotVersion:overwrite.snapshotVersion,void 0===overwrite.resumeToken?this.resumeToken:overwrite.resumeToken)},QueryData.prototype.isEqual=function(other){return this.targetId===other.targetId&&this.purpose===other.purpose&&this.sequenceNumber===other.sequenceNumber&&this.snapshotVersion.isEqual(other.snapshotVersion)&&this.resumeToken===other.resumeToken&&this.query.isEqual(other.query)},QueryData}(),FieldMask=function(){function FieldMask(fields){this.fields=fields}return FieldMask.prototype.covers=function(fieldPath){for(var _i=0,_a=this.fields,fieldMaskPath;_i<_a.length;_i++)if(fieldMaskPath=_a[_i],fieldMaskPath.isPrefixOf(fieldPath))return!0;return!1},FieldMask.prototype.isEqual=function(other){return arrayEquals(this.fields,other.fields)},FieldMask}(),FieldTransform=function(){function FieldTransform(field,transform){this.field=field,this.transform=transform}return FieldTransform.prototype.isEqual=function(other){return this.field.isEqual(other.field)&&this.transform.isEqual(other.transform)},FieldTransform}(),MutationResult=function(){return function MutationResult(version,transformResults){this.version=version,this.transformResults=transformResults}}(),MutationType;(function(MutationType){MutationType[MutationType.Set=0]='Set',MutationType[MutationType.Patch=1]='Patch',MutationType[MutationType.Transform=2]='Transform',MutationType[MutationType.Delete=3]='Delete'})(MutationType||(MutationType={}));var Precondition=function(){function Precondition(updateTime,exists){this.updateTime=updateTime,this.exists=exists,assert(void 0===updateTime||void 0===exists,'Precondition can specify "exists" or "updateTime" but not both')}return Precondition.exists=function(exists){return new Precondition(void 0,exists)},Precondition.updateTime=function(version){return new Precondition(version)},Object.defineProperty(Precondition.prototype,'isNone',{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),Precondition.prototype.isValidFor=function(maybeDoc){return void 0===this.updateTime?void 0===this.exists?(assert(this.isNone,'Precondition should be empty'),!0):this.exists===maybeDoc instanceof Document:maybeDoc instanceof Document&&maybeDoc.version.isEqual(this.updateTime)},Precondition.prototype.isEqual=function(other){return equals(this.updateTime,other.updateTime)&&this.exists===other.exists},Precondition.NONE=new Precondition,Precondition}(),Mutation=function(){function Mutation(){}return Mutation.prototype.verifyKeyMatches=function(maybeDoc){null!=maybeDoc&&assert(maybeDoc.key.isEqual(this.key),'Can only apply a mutation to a document with the same key')},Mutation.getPostMutationVersion=function(maybeDoc){return maybeDoc instanceof Document?maybeDoc.version:SnapshotVersion.MIN},Mutation}(),SetMutation=function(_super){function SetMutation(key,value,precondition){var _this=_super.call(this)||this;return _this.key=key,_this.value=value,_this.precondition=precondition,_this.type=MutationType.Set,_this}return tslib_1.__extends(SetMutation,_super),SetMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){this.verifyKeyMatches(maybeDoc),assert(null==mutationResult.transformResults,'Transform results received by SetMutation.');var version=mutationResult.version;return new Document(this.key,version,this.value,{hasCommittedMutations:!0})},SetMutation.prototype.applyToLocalView=function(maybeDoc){if(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))return maybeDoc;var version=Mutation.getPostMutationVersion(maybeDoc);return new Document(this.key,version,this.value,{hasLocalMutations:!0})},SetMutation.prototype.isEqual=function(other){return other instanceof SetMutation&&this.key.isEqual(other.key)&&this.value.isEqual(other.value)&&this.precondition.isEqual(other.precondition)},SetMutation}(Mutation),PatchMutation=function(_super){function PatchMutation(key,data,fieldMask,precondition){var _this=_super.call(this)||this;return _this.key=key,_this.data=data,_this.fieldMask=fieldMask,_this.precondition=precondition,_this.type=MutationType.Patch,_this}return tslib_1.__extends(PatchMutation,_super),PatchMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){if(this.verifyKeyMatches(maybeDoc),assert(null==mutationResult.transformResults,'Transform results received by PatchMutation.'),!this.precondition.isValidFor(maybeDoc))return new UnknownDocument(this.key,mutationResult.version);var newData=this.patchDocument(maybeDoc);return new Document(this.key,mutationResult.version,newData,{hasCommittedMutations:!0})},PatchMutation.prototype.applyToLocalView=function(maybeDoc){if(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))return maybeDoc;var version=Mutation.getPostMutationVersion(maybeDoc),newData=this.patchDocument(maybeDoc);return new Document(this.key,version,newData,{hasLocalMutations:!0})},PatchMutation.prototype.isEqual=function(other){return other instanceof PatchMutation&&this.key.isEqual(other.key)&&this.fieldMask.isEqual(other.fieldMask)&&this.precondition.isEqual(other.precondition)},PatchMutation.prototype.patchDocument=function(maybeDoc){var data;return data=maybeDoc instanceof Document?maybeDoc.data:ObjectValue.EMPTY,this.patchObject(data)},PatchMutation.prototype.patchObject=function(data){for(var _i=0,_a=this.fieldMask.fields,fieldPath;_i<_a.length;_i++)if(fieldPath=_a[_i],!fieldPath.isEmpty()){var newValue=this.data.field(fieldPath);data=void 0===newValue?data.delete(fieldPath):data.set(fieldPath,newValue)}return data},PatchMutation}(Mutation),TransformMutation=function(_super){function TransformMutation(key,fieldTransforms){var _this=_super.call(this)||this;return _this.key=key,_this.fieldTransforms=fieldTransforms,_this.type=MutationType.Transform,_this.precondition=Precondition.exists(!0),_this}return tslib_1.__extends(TransformMutation,_super),TransformMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){if(this.verifyKeyMatches(maybeDoc),assert(null!=mutationResult.transformResults,'Transform results missing for TransformMutation.'),!this.precondition.isValidFor(maybeDoc))return new UnknownDocument(this.key,mutationResult.version);var doc=this.requireDocument(maybeDoc),transformResults=this.serverTransformResults(maybeDoc,mutationResult.transformResults),version=mutationResult.version,newData=this.transformObject(doc.data,transformResults);return new Document(this.key,version,newData,{hasCommittedMutations:!0})},TransformMutation.prototype.applyToLocalView=function(maybeDoc,baseDoc,localWriteTime){if(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))return maybeDoc;var doc=this.requireDocument(maybeDoc),transformResults=this.localTransformResults(localWriteTime,baseDoc),newData=this.transformObject(doc.data,transformResults);return new Document(this.key,doc.version,newData,{hasLocalMutations:!0})},TransformMutation.prototype.isEqual=function(other){return other instanceof TransformMutation&&this.key.isEqual(other.key)&&arrayEquals(this.fieldTransforms,other.fieldTransforms)&&this.precondition.isEqual(other.precondition)},TransformMutation.prototype.requireDocument=function(maybeDoc){assert(maybeDoc instanceof Document,'Unknown MaybeDocument type '+maybeDoc);var doc=maybeDoc;return assert(doc.key.isEqual(this.key),'Can only transform a document with the same key'),doc},TransformMutation.prototype.serverTransformResults=function(baseDoc,serverTransformResults){var transformResults=[];assert(this.fieldTransforms.length===serverTransformResults.length,'server transform result count ('+serverTransformResults.length+') '+('should match field transform count ('+this.fieldTransforms.length+')'));for(var i=0;i<serverTransformResults.length;i++){var fieldTransform=this.fieldTransforms[i],transform=fieldTransform.transform,previousValue=null;baseDoc instanceof Document&&(previousValue=baseDoc.field(fieldTransform.field)||null),transformResults.push(transform.applyToRemoteDocument(previousValue,serverTransformResults[i]))}return transformResults},TransformMutation.prototype.localTransformResults=function(localWriteTime,baseDoc){for(var transformResults=[],_i=0,_a=this.fieldTransforms;_i<_a.length;_i++){var fieldTransform=_a[_i],transform=fieldTransform.transform,previousValue=null;baseDoc instanceof Document&&(previousValue=baseDoc.field(fieldTransform.field)||null),transformResults.push(transform.applyToLocalView(previousValue,localWriteTime))}return transformResults},TransformMutation.prototype.transformObject=function(data,transformResults){assert(transformResults.length===this.fieldTransforms.length,'TransformResults length mismatch.');for(var i=0;i<this.fieldTransforms.length;i++){var fieldTransform=this.fieldTransforms[i],fieldPath=fieldTransform.field;data=data.set(fieldPath,transformResults[i])}return data},TransformMutation}(Mutation),DeleteMutation=function(_super){function DeleteMutation(key,precondition){var _this=_super.call(this)||this;return _this.key=key,_this.precondition=precondition,_this.type=MutationType.Delete,_this}return tslib_1.__extends(DeleteMutation,_super),DeleteMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){return this.verifyKeyMatches(maybeDoc),assert(null==mutationResult.transformResults,'Transform results received by DeleteMutation.'),new NoDocument(this.key,mutationResult.version,{hasCommittedMutations:!0})},DeleteMutation.prototype.applyToLocalView=function(maybeDoc){return(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))?maybeDoc:(maybeDoc&&assert(maybeDoc.key.isEqual(this.key),'Can only apply mutation to document with same key'),new NoDocument(this.key,SnapshotVersion.forDeletedDoc()))},DeleteMutation.prototype.isEqual=function(other){return other instanceof DeleteMutation&&this.key.isEqual(other.key)&&this.precondition.isEqual(other.precondition)},DeleteMutation}(Mutation),ServerTimestampTransform=function(){function ServerTimestampTransform(){}return ServerTimestampTransform.prototype.applyToLocalView=function(previousValue,localWriteTime){return new ServerTimestampValue(localWriteTime,previousValue)},ServerTimestampTransform.prototype.applyToRemoteDocument=function(previousValue,transformResult){return transformResult},ServerTimestampTransform.prototype.isEqual=function(other){return other instanceof ServerTimestampTransform},ServerTimestampTransform.instance=new ServerTimestampTransform,ServerTimestampTransform}(),ArrayUnionTransformOperation=function(){function ArrayUnionTransformOperation(elements){this.elements=elements}return ArrayUnionTransformOperation.prototype.applyToLocalView=function(previousValue){return this.apply(previousValue)},ArrayUnionTransformOperation.prototype.applyToRemoteDocument=function(previousValue){return this.apply(previousValue)},ArrayUnionTransformOperation.prototype.apply=function(previousValue){for(var result=coercedFieldValuesArray(previousValue),_loop_1=function(toUnion){result.find(function(element){return element.isEqual(toUnion)})||result.push(toUnion)},_i=0,_a=this.elements,toUnion;_i<_a.length;_i++)toUnion=_a[_i],_loop_1(toUnion);return new ArrayValue(result)},ArrayUnionTransformOperation.prototype.isEqual=function(other){return other instanceof ArrayUnionTransformOperation&&arrayEquals(other.elements,this.elements)},ArrayUnionTransformOperation}(),ArrayRemoveTransformOperation=function(){function ArrayRemoveTransformOperation(elements){this.elements=elements}return ArrayRemoveTransformOperation.prototype.applyToLocalView=function(previousValue){return this.apply(previousValue)},ArrayRemoveTransformOperation.prototype.applyToRemoteDocument=function(previousValue){return this.apply(previousValue)},ArrayRemoveTransformOperation.prototype.apply=function(previousValue){for(var result=coercedFieldValuesArray(previousValue),_loop_2=function(toRemove){result=result.filter(function(element){return!element.isEqual(toRemove)})},_i=0,_a=this.elements,toRemove;_i<_a.length;_i++)toRemove=_a[_i],_loop_2(toRemove);return new ArrayValue(result)},ArrayRemoveTransformOperation.prototype.isEqual=function(other){return other instanceof ArrayRemoveTransformOperation&&arrayEquals(other.elements,this.elements)},ArrayRemoveTransformOperation}(),ExistenceFilter=function(){function ExistenceFilter(count){this.count=count}return ExistenceFilter.prototype.isEqual=function(other){return other&&other.count===this.count},ExistenceFilter}(),RpcCode;(function(RpcCode){RpcCode[RpcCode.OK=0]='OK',RpcCode[RpcCode.CANCELLED=1]='CANCELLED',RpcCode[RpcCode.UNKNOWN=2]='UNKNOWN',RpcCode[RpcCode.INVALID_ARGUMENT=3]='INVALID_ARGUMENT',RpcCode[RpcCode.DEADLINE_EXCEEDED=4]='DEADLINE_EXCEEDED',RpcCode[RpcCode.NOT_FOUND=5]='NOT_FOUND',RpcCode[RpcCode.ALREADY_EXISTS=6]='ALREADY_EXISTS',RpcCode[RpcCode.PERMISSION_DENIED=7]='PERMISSION_DENIED',RpcCode[RpcCode.UNAUTHENTICATED=16]='UNAUTHENTICATED',RpcCode[RpcCode.RESOURCE_EXHAUSTED=8]='RESOURCE_EXHAUSTED',RpcCode[RpcCode.FAILED_PRECONDITION=9]='FAILED_PRECONDITION',RpcCode[RpcCode.ABORTED=10]='ABORTED',RpcCode[RpcCode.OUT_OF_RANGE=11]='OUT_OF_RANGE',RpcCode[RpcCode.UNIMPLEMENTED=12]='UNIMPLEMENTED',RpcCode[RpcCode.INTERNAL=13]='INTERNAL',RpcCode[RpcCode.UNAVAILABLE=14]='UNAVAILABLE',RpcCode[RpcCode.DATA_LOSS=15]='DATA_LOSS'})(RpcCode||(RpcCode={}));var SortedSet=function(){function SortedSet(comparator){this.comparator=comparator,this.data=new SortedMap(this.comparator)}return SortedSet.fromMapKeys=function(map){var keys=new SortedSet(map.comparator);return map.forEach(function(key){keys=keys.add(key)}),keys},SortedSet.prototype.has=function(elem){return null!==this.data.get(elem)},SortedSet.prototype.first=function(){return this.data.minKey()},SortedSet.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(SortedSet.prototype,'size',{get:function(){return this.data.size},enumerable:!0,configurable:!0}),SortedSet.prototype.indexOf=function(elem){return this.data.indexOf(elem)},SortedSet.prototype.forEach=function(cb){this.data.inorderTraversal(function(k){return cb(k),!1})},SortedSet.prototype.forEachInRange=function(range,cb){for(var iter=this.data.getIteratorFrom(range[0]),elem;iter.hasNext();){if(elem=iter.getNext(),0<=this.comparator(elem.key,range[1]))return;cb(elem.key)}},SortedSet.prototype.forEachWhile=function(cb,start){var iter;for(iter=void 0===start?this.data.getIterator():this.data.getIteratorFrom(start);iter.hasNext();){var elem=iter.getNext(),result=cb(elem.key);if(!result)return}},SortedSet.prototype.firstAfterOrEqual=function(elem){var iter=this.data.getIteratorFrom(elem);return iter.hasNext()?iter.getNext().key:null},SortedSet.prototype.add=function(elem){return this.copy(this.data.remove(elem).insert(elem,!0))},SortedSet.prototype.delete=function(elem){return this.has(elem)?this.copy(this.data.remove(elem)):this},SortedSet.prototype.isEmpty=function(){return this.data.isEmpty()},SortedSet.prototype.unionWith=function(other){var result=this;return other.forEach(function(elem){result=result.add(elem)}),result},SortedSet.prototype.isEqual=function(other){if(!(other instanceof SortedSet))return!1;if(this.size!==other.size)return!1;for(var thisIt=this.data.getIterator(),otherIt=other.data.getIterator();thisIt.hasNext();){var thisElem=thisIt.getNext().key,otherElem=otherIt.getNext().key;if(0!==this.comparator(thisElem,otherElem))return!1}return!0},SortedSet.prototype.toArray=function(){var res=[];return this.forEach(function(targetId){res.push(targetId)}),res},SortedSet.prototype.toString=function(){var result=[];return this.forEach(function(elem){return result.push(elem)}),'SortedSet('+result.toString()+')'},SortedSet.prototype.copy=function(data){var result=new SortedSet(this.comparator);return result.data=data,result},SortedSet}(),EMPTY_MAYBE_DOCUMENT_MAP=new SortedMap(DocumentKey.comparator),EMPTY_DOCUMENT_MAP=new SortedMap(DocumentKey.comparator),EMPTY_DOCUMENT_VERSION_MAP=new SortedMap(DocumentKey.comparator),EMPTY_DOCUMENT_KEY_SET=new SortedSet(DocumentKey.comparator),EMPTY_TARGET_ID_SET=new SortedSet(primitiveComparator),DocumentSet=function(){function DocumentSet(comp){this.comparator=comp?function(d1,d2){return comp(d1,d2)||DocumentKey.comparator(d1.key,d2.key)}:function(d1,d2){return DocumentKey.comparator(d1.key,d2.key)},this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}return DocumentSet.emptySet=function(oldSet){return new DocumentSet(oldSet.comparator)},DocumentSet.prototype.has=function(key){return null!=this.keyedMap.get(key)},DocumentSet.prototype.get=function(key){return this.keyedMap.get(key)},DocumentSet.prototype.first=function(){return this.sortedSet.minKey()},DocumentSet.prototype.last=function(){return this.sortedSet.maxKey()},DocumentSet.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},DocumentSet.prototype.indexOf=function(key){var doc=this.keyedMap.get(key);return doc?this.sortedSet.indexOf(doc):-1},Object.defineProperty(DocumentSet.prototype,'size',{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),DocumentSet.prototype.forEach=function(cb){this.sortedSet.inorderTraversal(function(k){return cb(k),!1})},DocumentSet.prototype.add=function(doc){var set=this.delete(doc.key);return set.copy(set.keyedMap.insert(doc.key,doc),set.sortedSet.insert(doc,null))},DocumentSet.prototype.delete=function(key){var doc=this.get(key);return doc?this.copy(this.keyedMap.remove(key),this.sortedSet.remove(doc)):this},DocumentSet.prototype.isEqual=function(other){if(!(other instanceof DocumentSet))return!1;if(this.size!==other.size)return!1;for(var thisIt=this.sortedSet.getIterator(),otherIt=other.sortedSet.getIterator();thisIt.hasNext();){var thisDoc=thisIt.getNext().key,otherDoc=otherIt.getNext().key;if(!thisDoc.isEqual(otherDoc))return!1}return!0},DocumentSet.prototype.toString=function(){var docStrings=[];return this.forEach(function(doc){docStrings.push(doc.toString())}),0===docStrings.length?'DocumentSet ()':'DocumentSet (\n  '+docStrings.join('  \n')+'\n)'},DocumentSet.prototype.copy=function(keyedMap,sortedSet){var newSet=new DocumentSet;return newSet.comparator=this.comparator,newSet.keyedMap=keyedMap,newSet.sortedSet=sortedSet,newSet},DocumentSet}(),ChangeType;(function(ChangeType){ChangeType[ChangeType.Added=0]='Added',ChangeType[ChangeType.Removed=1]='Removed',ChangeType[ChangeType.Modified=2]='Modified',ChangeType[ChangeType.Metadata=3]='Metadata'})(ChangeType||(ChangeType={}));var SyncState;(function(SyncState){SyncState[SyncState.Local=0]='Local',SyncState[SyncState.Synced=1]='Synced'})(SyncState||(SyncState={}));var DocumentChangeSet=function(){function DocumentChangeSet(){this.changeMap=new SortedMap(DocumentKey.comparator)}return DocumentChangeSet.prototype.track=function(change){var key=change.doc.key,oldChange=this.changeMap.get(key);return oldChange?void(change.type!==ChangeType.Added&&oldChange.type===ChangeType.Metadata?this.changeMap=this.changeMap.insert(key,change):change.type===ChangeType.Metadata&&oldChange.type!==ChangeType.Removed?this.changeMap=this.changeMap.insert(key,{type:oldChange.type,doc:change.doc}):change.type===ChangeType.Modified&&oldChange.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Modified,doc:change.doc}):change.type===ChangeType.Modified&&oldChange.type===ChangeType.Added?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Added,doc:change.doc}):change.type===ChangeType.Removed&&oldChange.type===ChangeType.Added?this.changeMap=this.changeMap.remove(key):change.type===ChangeType.Removed&&oldChange.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Removed,doc:oldChange.doc}):change.type===ChangeType.Added&&oldChange.type===ChangeType.Removed?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Modified,doc:change.doc}):fail('unsupported combination of changes: '+JSON.stringify(change)+' after '+JSON.stringify(oldChange))):void(this.changeMap=this.changeMap.insert(key,change))},DocumentChangeSet.prototype.getChanges=function(){var changes=[];return this.changeMap.inorderTraversal(function(key,change){changes.push(change)}),changes},DocumentChangeSet}(),ViewSnapshot=function(){function ViewSnapshot(query,docs,oldDocs,docChanges,mutatedKeys,fromCache,syncStateChanged,excludesMetadataChanges){this.query=query,this.docs=docs,this.oldDocs=oldDocs,this.docChanges=docChanges,this.mutatedKeys=mutatedKeys,this.fromCache=fromCache,this.syncStateChanged=syncStateChanged,this.excludesMetadataChanges=excludesMetadataChanges}return ViewSnapshot.fromInitialDocuments=function(query,documents,mutatedKeys,fromCache){var changes=[];return documents.forEach(function(doc){changes.push({type:ChangeType.Added,doc:doc})}),new ViewSnapshot(query,documents,DocumentSet.emptySet(documents),changes,mutatedKeys,fromCache,!0,!1)},Object.defineProperty(ViewSnapshot.prototype,'hasPendingWrites',{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),ViewSnapshot.prototype.isEqual=function(other){if(this.fromCache!==other.fromCache||this.syncStateChanged!==other.syncStateChanged||!this.mutatedKeys.isEqual(other.mutatedKeys)||!this.query.isEqual(other.query)||!this.docs.isEqual(other.docs)||!this.oldDocs.isEqual(other.oldDocs))return!1;var changes=this.docChanges,otherChanges=other.docChanges;if(changes.length!==otherChanges.length)return!1;for(var i=0;i<changes.length;i++)if(changes[i].type!==otherChanges[i].type||!changes[i].doc.isEqual(otherChanges[i].doc))return!1;return!0},ViewSnapshot}(),RemoteEvent=function(){function RemoteEvent(snapshotVersion,targetChanges,targetMismatches,documentUpdates,resolvedLimboDocuments){this.snapshotVersion=snapshotVersion,this.targetChanges=targetChanges,this.targetMismatches=targetMismatches,this.documentUpdates=documentUpdates,this.resolvedLimboDocuments=resolvedLimboDocuments}return RemoteEvent.createSynthesizedRemoteEventForCurrentChange=function(targetId,current){var targetChanges=(_a={},_a[targetId]=TargetChange.createSynthesizedTargetChangeForCurrentChange(targetId,current),_a);return new RemoteEvent(SnapshotVersion.MIN,targetChanges,targetIdSet(),maybeDocumentMap(),documentKeySet());var _a},RemoteEvent}(),TargetChange=function(){function TargetChange(resumeToken,current,addedDocuments,modifiedDocuments,removedDocuments){this.resumeToken=resumeToken,this.current=current,this.addedDocuments=addedDocuments,this.modifiedDocuments=modifiedDocuments,this.removedDocuments=removedDocuments}return TargetChange.createSynthesizedTargetChangeForCurrentChange=function(targetId,current){return new TargetChange(emptyByteString(),current,documentKeySet(),documentKeySet(),documentKeySet())},TargetChange}(),DocumentWatchChange=function(){return function DocumentWatchChange(updatedTargetIds,removedTargetIds,key,newDoc){this.updatedTargetIds=updatedTargetIds,this.removedTargetIds=removedTargetIds,this.key=key,this.newDoc=newDoc}}(),ExistenceFilterChange=function(){return function ExistenceFilterChange(targetId,existenceFilter){this.targetId=targetId,this.existenceFilter=existenceFilter}}(),WatchTargetChangeState;(function(WatchTargetChangeState){WatchTargetChangeState[WatchTargetChangeState.NoChange=0]='NoChange',WatchTargetChangeState[WatchTargetChangeState.Added=1]='Added',WatchTargetChangeState[WatchTargetChangeState.Removed=2]='Removed',WatchTargetChangeState[WatchTargetChangeState.Current=3]='Current',WatchTargetChangeState[WatchTargetChangeState.Reset=4]='Reset'})(WatchTargetChangeState||(WatchTargetChangeState={}));var WatchTargetChange=function(){return function WatchTargetChange(state,targetIds,resumeToken,cause){void 0===resumeToken&&(resumeToken=emptyByteString()),void 0===cause&&(cause=null),this.state=state,this.targetIds=targetIds,this.resumeToken=resumeToken,this.cause=cause}}(),TargetState=function(){function TargetState(){this.pendingResponses=0,this.documentChanges=snapshotChangesMap(),this._resumeToken=emptyByteString(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(TargetState.prototype,'current',{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(TargetState.prototype,'resumeToken',{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(TargetState.prototype,'isPending',{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(TargetState.prototype,'hasPendingChanges',{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),TargetState.prototype.updateResumeToken=function(resumeToken){0<resumeToken.length&&(this._hasPendingChanges=!0,this._resumeToken=resumeToken)},TargetState.prototype.toTargetChange=function(){var addedDocuments=documentKeySet(),modifiedDocuments=documentKeySet(),removedDocuments=documentKeySet();return this.documentChanges.forEach(function(key,changeType){changeType===ChangeType.Added?addedDocuments=addedDocuments.add(key):changeType===ChangeType.Modified?modifiedDocuments=modifiedDocuments.add(key):changeType===ChangeType.Removed?removedDocuments=removedDocuments.add(key):fail('Encountered invalid change type: '+changeType)}),new TargetChange(this._resumeToken,this._current,addedDocuments,modifiedDocuments,removedDocuments)},TargetState.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=snapshotChangesMap()},TargetState.prototype.addDocumentChange=function(key,changeType){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(key,changeType)},TargetState.prototype.removeDocumentChange=function(key){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(key)},TargetState.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},TargetState.prototype.recordTargetResponse=function(){this.pendingResponses-=1},TargetState.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},TargetState}(),WatchChangeAggregator=function(){function WatchChangeAggregator(metadataProvider){this.metadataProvider=metadataProvider,this.targetStates={},this.pendingDocumentUpdates=maybeDocumentMap(),this.pendingDocumentTargetMapping=documentTargetMap(),this.pendingTargetResets=new SortedSet(primitiveComparator)}return WatchChangeAggregator.prototype.handleDocumentChange=function(docChange){for(var _i=0,_a=docChange.updatedTargetIds,targetId;_i<_a.length;_i++)targetId=_a[_i],docChange.newDoc instanceof Document?this.addDocumentToTarget(targetId,docChange.newDoc):docChange.newDoc instanceof NoDocument&&this.removeDocumentFromTarget(targetId,docChange.key,docChange.newDoc);for(var _b=0,_c=docChange.removedTargetIds,targetId;_b<_c.length;_b++)targetId=_c[_b],this.removeDocumentFromTarget(targetId,docChange.key,docChange.newDoc)},WatchChangeAggregator.prototype.handleTargetChange=function(targetChange){var _this=this;this.forEachTarget(targetChange,function(targetId){var targetState=_this.ensureTargetState(targetId);switch(targetChange.state){case WatchTargetChangeState.NoChange:_this.isActiveTarget(targetId)&&targetState.updateResumeToken(targetChange.resumeToken);break;case WatchTargetChangeState.Added:targetState.recordTargetResponse(),targetState.isPending||targetState.clearPendingChanges(),targetState.updateResumeToken(targetChange.resumeToken);break;case WatchTargetChangeState.Removed:targetState.recordTargetResponse(),targetState.isPending||_this.removeTarget(targetId),assert(!targetChange.cause,'WatchChangeAggregator does not handle errored targets');break;case WatchTargetChangeState.Current:_this.isActiveTarget(targetId)&&(targetState.markCurrent(),targetState.updateResumeToken(targetChange.resumeToken));break;case WatchTargetChangeState.Reset:_this.isActiveTarget(targetId)&&(_this.resetTarget(targetId),targetState.updateResumeToken(targetChange.resumeToken));break;default:fail('Unknown target watch change state: '+targetChange.state);}})},WatchChangeAggregator.prototype.forEachTarget=function(targetChange,fn){0<targetChange.targetIds.length?targetChange.targetIds.forEach(fn):forEachNumber(this.targetStates,fn)},WatchChangeAggregator.prototype.handleExistenceFilter=function(watchChange){var targetId=watchChange.targetId,expectedCount=watchChange.existenceFilter.count,queryData=this.queryDataForActiveTarget(targetId);if(queryData){var query=queryData.query;if(!query.isDocumentQuery()){var currentSize=this.getCurrentDocumentCountForTarget(targetId);currentSize!==expectedCount&&(this.resetTarget(targetId),this.pendingTargetResets=this.pendingTargetResets.add(targetId))}else if(0===expectedCount){var key=new DocumentKey(query.path);this.removeDocumentFromTarget(targetId,key,new NoDocument(key,SnapshotVersion.forDeletedDoc()))}else assert(1===expectedCount,'Single document existence filter with count: '+expectedCount)}},WatchChangeAggregator.prototype.createRemoteEvent=function(snapshotVersion){var _this=this,targetChanges={};forEachNumber(this.targetStates,function(targetId,targetState){var queryData=_this.queryDataForActiveTarget(targetId);if(queryData){if(targetState.current&&queryData.query.isDocumentQuery()){var key=new DocumentKey(queryData.query.path);null!==_this.pendingDocumentUpdates.get(key)||_this.targetContainsDocument(targetId,key)||_this.removeDocumentFromTarget(targetId,key,new NoDocument(key,snapshotVersion))}targetState.hasPendingChanges&&(targetChanges[targetId]=targetState.toTargetChange(),targetState.clearPendingChanges())}});var resolvedLimboDocuments=documentKeySet();this.pendingDocumentTargetMapping.forEach(function(key,targets){var isOnlyLimboTarget=!0;targets.forEachWhile(function(targetId){var queryData=_this.queryDataForActiveTarget(targetId);return queryData&&queryData.purpose!==QueryPurpose.LimboResolution?(isOnlyLimboTarget=!1,!1):!0}),isOnlyLimboTarget&&(resolvedLimboDocuments=resolvedLimboDocuments.add(key))});var remoteEvent=new RemoteEvent(snapshotVersion,targetChanges,this.pendingTargetResets,this.pendingDocumentUpdates,resolvedLimboDocuments);return this.pendingDocumentUpdates=maybeDocumentMap(),this.pendingDocumentTargetMapping=documentTargetMap(),this.pendingTargetResets=new SortedSet(primitiveComparator),remoteEvent},WatchChangeAggregator.prototype.addDocumentToTarget=function(targetId,document){if(this.isActiveTarget(targetId)){var changeType=this.targetContainsDocument(targetId,document.key)?ChangeType.Modified:ChangeType.Added,targetState=this.ensureTargetState(targetId);targetState.addDocumentChange(document.key,changeType),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(document.key,document),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(document.key,this.ensureDocumentTargetMapping(document.key).add(targetId))}},WatchChangeAggregator.prototype.removeDocumentFromTarget=function(targetId,key,updatedDocument){if(this.isActiveTarget(targetId)){var targetState=this.ensureTargetState(targetId);this.targetContainsDocument(targetId,key)?targetState.addDocumentChange(key,ChangeType.Removed):targetState.removeDocumentChange(key),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(key,this.ensureDocumentTargetMapping(key).delete(targetId)),updatedDocument&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(key,updatedDocument))}},WatchChangeAggregator.prototype.removeTarget=function(targetId){delete this.targetStates[targetId]},WatchChangeAggregator.prototype.getCurrentDocumentCountForTarget=function(targetId){var targetState=this.ensureTargetState(targetId),targetChange=targetState.toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(targetId).size+targetChange.addedDocuments.size-targetChange.removedDocuments.size},WatchChangeAggregator.prototype.recordPendingTargetRequest=function(targetId){var targetState=this.ensureTargetState(targetId);targetState.recordPendingTargetRequest()},WatchChangeAggregator.prototype.ensureTargetState=function(targetId){return this.targetStates[targetId]||(this.targetStates[targetId]=new TargetState),this.targetStates[targetId]},WatchChangeAggregator.prototype.ensureDocumentTargetMapping=function(key){var targetMapping=this.pendingDocumentTargetMapping.get(key);return targetMapping||(targetMapping=new SortedSet(primitiveComparator),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(key,targetMapping)),targetMapping},WatchChangeAggregator.prototype.isActiveTarget=function(targetId){return null!==this.queryDataForActiveTarget(targetId)},WatchChangeAggregator.prototype.queryDataForActiveTarget=function(targetId){var targetState=this.targetStates[targetId];return targetState&&targetState.isPending?null:this.metadataProvider.getQueryDataForTarget(targetId)},WatchChangeAggregator.prototype.resetTarget=function(targetId){var _this=this;assert(!this.targetStates[targetId].isPending,'Should only reset active targets'),this.targetStates[targetId]=new TargetState;var existingKeys=this.metadataProvider.getRemoteKeysForTarget(targetId);existingKeys.forEach(function(key){_this.removeDocumentFromTarget(targetId,key,null)})},WatchChangeAggregator.prototype.targetContainsDocument=function(targetId,key){var existingKeys=this.metadataProvider.getRemoteKeysForTarget(targetId);return existingKeys.has(key)},WatchChangeAggregator}(),DIRECTIONS=function(){var dirs={};return dirs[Direction.ASCENDING.name]='ASCENDING',dirs[Direction.DESCENDING.name]='DESCENDING',dirs}(),OPERATORS=function(){var ops={};return ops[RelationOp.LESS_THAN.name]='LESS_THAN',ops[RelationOp.LESS_THAN_OR_EQUAL.name]='LESS_THAN_OR_EQUAL',ops[RelationOp.GREATER_THAN.name]='GREATER_THAN',ops[RelationOp.GREATER_THAN_OR_EQUAL.name]='GREATER_THAN_OR_EQUAL',ops[RelationOp.EQUAL.name]='EQUAL',ops[RelationOp.ARRAY_CONTAINS.name]='ARRAY_CONTAINS',ops}(),ISO_REG_EXP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/),JsonProtoSerializer=function(){function JsonProtoSerializer(databaseId,options){this.databaseId=databaseId,this.options=options}return JsonProtoSerializer.prototype.emptyByteString=function(){return this.options.useProto3Json?'':new Uint8Array(0)},JsonProtoSerializer.prototype.unsafeCastProtoByteString=function(byteString){return byteString},JsonProtoSerializer.prototype.fromRpcStatus=function(status){var code=void 0===status.code?Code.UNKNOWN:mapCodeFromRpcCode(status.code);return new FirestoreError(code,status.message||'')},JsonProtoSerializer.prototype.toInt32Value=function(val){return isNullOrUndefined(val)?void 0:{value:val}},JsonProtoSerializer.prototype.fromInt32Value=function(val){var result;return result='object'==typeof val?val.value:val,isNullOrUndefined(result)?null:result},JsonProtoSerializer.prototype.toTimestamp=function(timestamp){return{seconds:timestamp.seconds,nanos:timestamp.nanoseconds}},JsonProtoSerializer.prototype.fromTimestamp=function(date){if('string'==typeof date)return this.fromIso8601String(date);assert(!!date,'Cannot deserialize null or undefined timestamp.');var seconds=parseInt64(date.seconds||'0'),nanos=date.nanos||0;return new Timestamp(seconds,nanos)},JsonProtoSerializer.prototype.fromIso8601String=function(utc){var nanos=0,fraction=ISO_REG_EXP.exec(utc);if(assert(!!fraction,'invalid timestamp: '+utc),fraction[1]){var nanoStr=fraction[1];nanoStr=(nanoStr+'000000000').substr(0,9),nanos=+nanoStr}var date=new Date(utc),seconds=_Mathfloor(date.getTime()/1e3);return new Timestamp(seconds,nanos)},JsonProtoSerializer.prototype.toBytes=function(bytes){return this.options.useProto3Json?bytes.toBase64():this.unsafeCastProtoByteString(bytes.toUint8Array())},JsonProtoSerializer.prototype.fromBlob=function(blob){return'string'==typeof blob?(assert(this.options.useProto3Json,'Expected bytes to be passed in as Uint8Array, but got a string instead.'),Blob.fromBase64String(blob)):(assert(!this.options.useProto3Json,'Expected bytes to be passed in as string, but got something else instead.'),Blob.fromUint8Array(blob))},JsonProtoSerializer.prototype.toVersion=function(version){return this.toTimestamp(version.toTimestamp())},JsonProtoSerializer.prototype.fromVersion=function(version){return assert(!!version,'Trying to deserialize version that isn\'t set'),SnapshotVersion.fromTimestamp(this.fromTimestamp(version))},JsonProtoSerializer.prototype.toResourceName=function(databaseId,path){return this.fullyQualifiedPrefixPath(databaseId).child('documents').child(path).canonicalString()},JsonProtoSerializer.prototype.fromResourceName=function(name){var resource=ResourcePath.fromString(name);return assert(this.isValidResourceName(resource),'Tried to deserialize invalid key '+resource.toString()),resource},JsonProtoSerializer.prototype.toName=function(key){return this.toResourceName(this.databaseId,key.path)},JsonProtoSerializer.prototype.fromName=function(name){var resource=this.fromResourceName(name);return assert(resource.get(1)===this.databaseId.projectId,'Tried to deserialize key from different project: '+resource.get(1)+' vs '+this.databaseId.projectId),assert(!resource.get(3)&&!this.databaseId.database||resource.get(3)===this.databaseId.database,'Tried to deserialize key from different database: '+resource.get(3)+' vs '+this.databaseId.database),new DocumentKey(this.extractLocalPathFromResourceName(resource))},JsonProtoSerializer.prototype.toQueryPath=function(path){return 0===path.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,path)},JsonProtoSerializer.prototype.fromQueryPath=function(name){var resourceName=this.fromResourceName(name);return 4===resourceName.length?ResourcePath.EMPTY_PATH:this.extractLocalPathFromResourceName(resourceName)},Object.defineProperty(JsonProtoSerializer.prototype,'encodedDatabaseId',{get:function(){var path=new ResourcePath(['projects',this.databaseId.projectId,'databases',this.databaseId.database]);return path.canonicalString()},enumerable:!0,configurable:!0}),JsonProtoSerializer.prototype.fullyQualifiedPrefixPath=function(databaseId){return new ResourcePath(['projects',databaseId.projectId,'databases',databaseId.database])},JsonProtoSerializer.prototype.extractLocalPathFromResourceName=function(resourceName){return assert(4<resourceName.length&&'documents'===resourceName.get(4),'tried to deserialize invalid key '+resourceName.toString()),resourceName.popFirst(5)},JsonProtoSerializer.prototype.isValidResourceName=function(path){return 4<=path.length&&'projects'===path.get(0)&&'databases'===path.get(2)},JsonProtoSerializer.prototype.toValue=function(val){if(val instanceof NullValue)return{nullValue:'NULL_VALUE'};if(val instanceof BooleanValue)return{booleanValue:val.value()};if(val instanceof IntegerValue)return{integerValue:''+val.value()};if(val instanceof DoubleValue){var doubleValue=val.value();if(this.options.useProto3Json){if(isNaN(doubleValue))return{doubleValue:'NaN'};if(doubleValue===Infinity)return{doubleValue:'Infinity'};if(doubleValue===-Infinity)return{doubleValue:'-Infinity'}}return{doubleValue:val.value()}}return val instanceof StringValue?{stringValue:val.value()}:val instanceof ObjectValue?{mapValue:this.toMapValue(val)}:val instanceof ArrayValue?{arrayValue:this.toArrayValue(val)}:val instanceof TimestampValue?{timestampValue:this.toTimestamp(val.internalValue)}:val instanceof GeoPointValue?{geoPointValue:{latitude:val.value().latitude,longitude:val.value().longitude}}:val instanceof BlobValue?{bytesValue:this.toBytes(val.value())}:val instanceof RefValue?{referenceValue:this.toResourceName(val.databaseId,val.key.path)}:fail('Unknown FieldValue '+JSON.stringify(val))},JsonProtoSerializer.prototype.fromValue=function(obj){var _this=this,type=obj.value_type;if(hasTag(obj,type,'nullValue'))return NullValue.INSTANCE;if(hasTag(obj,type,'booleanValue'))return BooleanValue.of(obj.booleanValue);if(hasTag(obj,type,'integerValue'))return new IntegerValue(parseInt64(obj.integerValue));if(hasTag(obj,type,'doubleValue')){if(this.options.useProto3Json){if('NaN'===obj.doubleValue)return DoubleValue.NAN;if('Infinity'===obj.doubleValue)return DoubleValue.POSITIVE_INFINITY;if('-Infinity'===obj.doubleValue)return DoubleValue.NEGATIVE_INFINITY}return new DoubleValue(obj.doubleValue)}if(hasTag(obj,type,'stringValue'))return new StringValue(obj.stringValue);if(hasTag(obj,type,'mapValue'))return this.fromFields(obj.mapValue.fields||{});if(hasTag(obj,type,'arrayValue')){assertPresent(obj.arrayValue,'arrayValue');var values$$1=obj.arrayValue.values||[];return new ArrayValue(values$$1.map(function(v){return _this.fromValue(v)}))}if(hasTag(obj,type,'timestampValue'))return assertPresent(obj.timestampValue,'timestampValue'),new TimestampValue(this.fromTimestamp(obj.timestampValue));if(hasTag(obj,type,'geoPointValue')){assertPresent(obj.geoPointValue,'geoPointValue');var latitude=obj.geoPointValue.latitude||0,longitude=obj.geoPointValue.longitude||0;return new GeoPointValue(new GeoPoint(latitude,longitude))}if(hasTag(obj,type,'bytesValue')){assertPresent(obj.bytesValue,'bytesValue');var blob=this.fromBlob(obj.bytesValue);return new BlobValue(blob)}if(hasTag(obj,type,'referenceValue')){assertPresent(obj.referenceValue,'referenceValue');var resourceName=this.fromResourceName(obj.referenceValue),dbId=new DatabaseId(resourceName.get(1),resourceName.get(3)),key=new DocumentKey(this.extractLocalPathFromResourceName(resourceName));return new RefValue(dbId,key)}return fail('Unknown Value proto '+JSON.stringify(obj))},JsonProtoSerializer.prototype.toMutationDocument=function(key,fields){return{name:this.toName(key),fields:this.toFields(fields)}},JsonProtoSerializer.prototype.toDocument=function(document){return assert(!document.hasLocalMutations,'Can\'t serialize documents with mutations.'),{name:this.toName(document.key),fields:this.toFields(document.data),updateTime:this.toTimestamp(document.version.toTimestamp())}},JsonProtoSerializer.prototype.fromDocument=function(document,hasCommittedMutations){return new Document(this.fromName(document.name),this.fromVersion(document.updateTime),this.fromFields(document.fields||{}),{hasCommittedMutations:!!hasCommittedMutations})},JsonProtoSerializer.prototype.toFields=function(fields){var _this=this,result={};return fields.forEach(function(key,value){result[key]=_this.toValue(value)}),result},JsonProtoSerializer.prototype.fromFields=function(object){var _this=this,result=ObjectValue.EMPTY;return forEach(object,function(key,value){result=result.set(new FieldPath([key]),_this.fromValue(value))}),result},JsonProtoSerializer.prototype.toMapValue=function(map){return{fields:this.toFields(map)}},JsonProtoSerializer.prototype.toArrayValue=function(array){var _this=this,result=[];return array.forEach(function(value){result.push(_this.toValue(value))}),{values:result}},JsonProtoSerializer.prototype.fromFound=function(doc){assert(!!doc.found,'Tried to deserialize a found document from a missing document.'),assertPresent(doc.found.name,'doc.found.name'),assertPresent(doc.found.updateTime,'doc.found.updateTime');var key=this.fromName(doc.found.name),version=this.fromVersion(doc.found.updateTime),fields=this.fromFields(doc.found.fields||{});return new Document(key,version,fields,{})},JsonProtoSerializer.prototype.fromMissing=function(result){assert(!!result.missing,'Tried to deserialize a missing document from a found document.'),assert(!!result.readTime,'Tried to deserialize a missing document without a read time.');var key=this.fromName(result.missing),version=this.fromVersion(result.readTime);return new NoDocument(key,version)},JsonProtoSerializer.prototype.fromMaybeDocument=function(result){var type=result.result;return hasTag(result,type,'found')?this.fromFound(result):hasTag(result,type,'missing')?this.fromMissing(result):fail('invalid batch get response: '+JSON.stringify(result))},JsonProtoSerializer.prototype.toWatchTargetChangeState=function(state){return state===WatchTargetChangeState.Added?'ADD':state===WatchTargetChangeState.Current?'CURRENT':state===WatchTargetChangeState.NoChange?'NO_CHANGE':state===WatchTargetChangeState.Removed?'REMOVE':state===WatchTargetChangeState.Reset?'RESET':fail('Unknown WatchTargetChangeState: '+state)},JsonProtoSerializer.prototype.toTestWatchChange=function(watchChange){if(watchChange instanceof ExistenceFilterChange)return{filter:{count:watchChange.existenceFilter.count,targetId:watchChange.targetId}};if(watchChange instanceof DocumentWatchChange){if(watchChange.newDoc instanceof Document){var doc=watchChange.newDoc;return{documentChange:{document:{name:this.toName(doc.key),fields:this.toFields(doc.data),updateTime:this.toVersion(doc.version)},targetIds:watchChange.updatedTargetIds,removedTargetIds:watchChange.removedTargetIds}}}if(watchChange.newDoc instanceof NoDocument){var doc=watchChange.newDoc;return{documentDelete:{document:this.toName(doc.key),readTime:this.toVersion(doc.version),removedTargetIds:watchChange.removedTargetIds}}}if(null===watchChange.newDoc)return{documentRemove:{document:this.toName(watchChange.key),removedTargetIds:watchChange.removedTargetIds}}}if(watchChange instanceof WatchTargetChange){var cause;return watchChange.cause&&(cause={code:mapRpcCodeFromCode(watchChange.cause.code),message:watchChange.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(watchChange.state),targetIds:watchChange.targetIds,resumeToken:this.unsafeCastProtoByteString(watchChange.resumeToken),cause:cause}}}return fail('Unrecognized watch change: '+JSON.stringify(watchChange))},JsonProtoSerializer.prototype.fromWatchChange=function(change){var type=change.response_type,watchChange;if(hasTag(change,type,'targetChange')){assertPresent(change.targetChange,'targetChange');var state=this.fromWatchTargetChangeState(change.targetChange.targetChangeType||'NO_CHANGE'),targetIds=change.targetChange.targetIds||[],resumeToken=change.targetChange.resumeToken||this.emptyByteString(),causeProto=change.targetChange.cause,cause=causeProto&&this.fromRpcStatus(causeProto);watchChange=new WatchTargetChange(state,targetIds,resumeToken,cause||null)}else if(hasTag(change,type,'documentChange')){assertPresent(change.documentChange,'documentChange'),assertPresent(change.documentChange.document,'documentChange.name'),assertPresent(change.documentChange.document.name,'documentChange.document.name'),assertPresent(change.documentChange.document.updateTime,'documentChange.document.updateTime');var entityChange=change.documentChange,key=this.fromName(entityChange.document.name),version=this.fromVersion(entityChange.document.updateTime),fields=this.fromFields(entityChange.document.fields||{}),doc=new Document(key,version,fields,{}),updatedTargetIds=entityChange.targetIds||[],removedTargetIds=entityChange.removedTargetIds||[];watchChange=new DocumentWatchChange(updatedTargetIds,removedTargetIds,doc.key,doc)}else if(hasTag(change,type,'documentDelete')){assertPresent(change.documentDelete,'documentDelete'),assertPresent(change.documentDelete.document,'documentDelete.document');var docDelete=change.documentDelete,key=this.fromName(docDelete.document),version=docDelete.readTime?this.fromVersion(docDelete.readTime):SnapshotVersion.forDeletedDoc(),doc=new NoDocument(key,version),removedTargetIds=docDelete.removedTargetIds||[];watchChange=new DocumentWatchChange([],removedTargetIds,doc.key,doc)}else if(hasTag(change,type,'documentRemove')){assertPresent(change.documentRemove,'documentRemove'),assertPresent(change.documentRemove.document,'documentRemove');var docRemove=change.documentRemove,key=this.fromName(docRemove.document),removedTargetIds=docRemove.removedTargetIds||[];watchChange=new DocumentWatchChange([],removedTargetIds,key,null)}else if(hasTag(change,type,'filter')){assertPresent(change.filter,'filter'),assertPresent(change.filter.targetId,'filter.targetId');var filter=change.filter,count=filter.count||0,existenceFilter=new ExistenceFilter(count),targetId=filter.targetId;watchChange=new ExistenceFilterChange(targetId,existenceFilter)}else return fail('Unknown change type '+JSON.stringify(change));return watchChange},JsonProtoSerializer.prototype.fromWatchTargetChangeState=function(state){return'NO_CHANGE'===state?WatchTargetChangeState.NoChange:'ADD'===state?WatchTargetChangeState.Added:'REMOVE'===state?WatchTargetChangeState.Removed:'CURRENT'===state?WatchTargetChangeState.Current:'RESET'===state?WatchTargetChangeState.Reset:fail('Got unexpected TargetChange.state: '+state)},JsonProtoSerializer.prototype.versionFromListenResponse=function(change){var type=change.response_type;if(!hasTag(change,type,'targetChange'))return SnapshotVersion.MIN;var targetChange=change.targetChange;return targetChange.targetIds&&targetChange.targetIds.length?SnapshotVersion.MIN:targetChange.readTime?this.fromVersion(targetChange.readTime):SnapshotVersion.MIN},JsonProtoSerializer.prototype.toMutation=function(mutation){var _this=this,result;if(mutation instanceof SetMutation)result={update:this.toMutationDocument(mutation.key,mutation.value)};else if(mutation instanceof DeleteMutation)result={delete:this.toName(mutation.key)};else if(mutation instanceof PatchMutation)result={update:this.toMutationDocument(mutation.key,mutation.data),updateMask:this.toDocumentMask(mutation.fieldMask)};else if(mutation instanceof TransformMutation)result={transform:{document:this.toName(mutation.key),fieldTransforms:mutation.fieldTransforms.map(function(transform){return _this.toFieldTransform(transform)})}};else return fail('Unknown mutation type '+mutation.type);return mutation.precondition.isNone||(result.currentDocument=this.toPrecondition(mutation.precondition)),result},JsonProtoSerializer.prototype.fromMutation=function(proto){var _this=this,precondition=proto.currentDocument?this.fromPrecondition(proto.currentDocument):Precondition.NONE;if(proto.update){assertPresent(proto.update.name,'name');var key=this.fromName(proto.update.name),value=this.fromFields(proto.update.fields||{});if(proto.updateMask){var fieldMask=this.fromDocumentMask(proto.updateMask);return new PatchMutation(key,value,fieldMask,precondition)}return new SetMutation(key,value,precondition)}if(proto.delete){var key=this.fromName(proto.delete);return new DeleteMutation(key,precondition)}if(proto.transform){var key=this.fromName(proto.transform.document),fieldTransforms=proto.transform.fieldTransforms.map(function(transform){return _this.fromFieldTransform(transform)});return assert(!0===precondition.exists,'Transforms only support precondition "exists == true"'),new TransformMutation(key,fieldTransforms)}return fail('unknown mutation proto: '+JSON.stringify(proto))},JsonProtoSerializer.prototype.toPrecondition=function(precondition){return assert(!precondition.isNone,'Can\'t serialize an empty precondition'),void 0===precondition.updateTime?void 0===precondition.exists?fail('Unknown precondition'):{exists:precondition.exists}:{updateTime:this.toVersion(precondition.updateTime)}},JsonProtoSerializer.prototype.fromPrecondition=function(precondition){return void 0===precondition.updateTime?void 0===precondition.exists?Precondition.NONE:Precondition.exists(precondition.exists):Precondition.updateTime(this.fromVersion(precondition.updateTime))},JsonProtoSerializer.prototype.fromWriteResult=function(proto,commitTime){var _this=this,version=proto.updateTime?this.fromVersion(proto.updateTime):this.fromVersion(commitTime),transformResults=null;return proto.transformResults&&0<proto.transformResults.length&&(transformResults=proto.transformResults.map(function(result){return _this.fromValue(result)})),new MutationResult(version,transformResults)},JsonProtoSerializer.prototype.fromWriteResults=function(protos,commitTime){var _this=this;return protos&&0<protos.length?(assert(void 0!==commitTime,'Received a write result without a commit time'),protos.map(function(proto){return _this.fromWriteResult(proto,commitTime)})):[]},JsonProtoSerializer.prototype.toFieldTransform=function(fieldTransform){var _this=this,transform=fieldTransform.transform;if(transform instanceof ServerTimestampTransform)return{fieldPath:fieldTransform.field.canonicalString(),setToServerValue:'REQUEST_TIME'};if(transform instanceof ArrayUnionTransformOperation)return{fieldPath:fieldTransform.field.canonicalString(),appendMissingElements:{values:transform.elements.map(function(v){return _this.toValue(v)})}};if(transform instanceof ArrayRemoveTransformOperation)return{fieldPath:fieldTransform.field.canonicalString(),removeAllFromArray:{values:transform.elements.map(function(v){return _this.toValue(v)})}};throw fail('Unknown transform: '+fieldTransform.transform)},JsonProtoSerializer.prototype.fromFieldTransform=function(proto){var _this=this,type=proto.transform_type,transform=null;if(hasTag(proto,type,'setToServerValue'))assert('REQUEST_TIME'===proto.setToServerValue,'Unknown server value transform proto: '+JSON.stringify(proto)),transform=ServerTimestampTransform.instance;else if(hasTag(proto,type,'appendMissingElements')){var values$$1=proto.appendMissingElements.values||[];transform=new ArrayUnionTransformOperation(values$$1.map(function(v){return _this.fromValue(v)}))}else if(hasTag(proto,type,'removeAllFromArray')){var values$$1=proto.removeAllFromArray.values||[];transform=new ArrayRemoveTransformOperation(values$$1.map(function(v){return _this.fromValue(v)}))}else fail('Unknown transform proto: '+JSON.stringify(proto));var fieldPath=FieldPath.fromServerFormat(proto.fieldPath);return new FieldTransform(fieldPath,transform)},JsonProtoSerializer.prototype.toDocumentsTarget=function(query){return{documents:[this.toQueryPath(query.path)]}},JsonProtoSerializer.prototype.fromDocumentsTarget=function(documentsTarget){var count=documentsTarget.documents.length;assert(1===count,'DocumentsTarget contained other than 1 document: '+count);var name=documentsTarget.documents[0];return Query.atPath(this.fromQueryPath(name))},JsonProtoSerializer.prototype.toQueryTarget=function(query){var result={structuredQuery:{}};if(query.path.isEmpty())result.parent=this.toQueryPath(ResourcePath.EMPTY_PATH);else{var path=query.path;assert(0!=path.length%2,'Document queries with filters are not supported.'),result.parent=this.toQueryPath(path.popLast()),result.structuredQuery.from=[{collectionId:path.lastSegment()}]}var where=this.toFilter(query.filters);where&&(result.structuredQuery.where=where);var orderBy=this.toOrder(query.orderBy);orderBy&&(result.structuredQuery.orderBy=orderBy);var limit=this.toInt32Value(query.limit);return void 0!==limit&&(result.structuredQuery.limit=limit),query.startAt&&(result.structuredQuery.startAt=this.toCursor(query.startAt)),query.endAt&&(result.structuredQuery.endAt=this.toCursor(query.endAt)),result},JsonProtoSerializer.prototype.fromQueryTarget=function(target){var path=this.fromQueryPath(target.parent),query=target.structuredQuery,fromCount=query.from?query.from.length:0;if(0<fromCount){assert(1===fromCount,'StructuredQuery.from with more than one collection is not supported.');var from=query.from[0];path=path.child(from.collectionId)}var filterBy=[];query.where&&(filterBy=this.fromFilter(query.where));var orderBy=[];query.orderBy&&(orderBy=this.fromOrder(query.orderBy));var limit=null;query.limit&&(limit=this.fromInt32Value(query.limit));var startAt=null;query.startAt&&(startAt=this.fromCursor(query.startAt));var endAt=null;return query.endAt&&(endAt=this.fromCursor(query.endAt)),new Query(path,orderBy,filterBy,limit,startAt,endAt)},JsonProtoSerializer.prototype.toListenRequestLabels=function(queryData){var value=this.toLabel(queryData.purpose);return null==value?null:{"goog-listen-tags":value}},JsonProtoSerializer.prototype.toLabel=function(purpose){return purpose===QueryPurpose.Listen?null:purpose===QueryPurpose.ExistenceFilterMismatch?'existence-filter-mismatch':purpose===QueryPurpose.LimboResolution?'limbo-document':fail('Unrecognized query purpose: '+purpose)},JsonProtoSerializer.prototype.toTarget=function(queryData){var query=queryData.query,result;return result=query.isDocumentQuery()?{documents:this.toDocumentsTarget(query)}:{query:this.toQueryTarget(query)},result.targetId=queryData.targetId,0<queryData.resumeToken.length&&(result.resumeToken=this.unsafeCastProtoByteString(queryData.resumeToken)),result},JsonProtoSerializer.prototype.toFilter=function(filters){var _this=this;if(0!==filters.length){var protos=filters.map(function(filter){return filter instanceof RelationFilter?_this.toRelationFilter(filter):_this.toUnaryFilter(filter)});return 1===protos.length?protos[0]:{compositeFilter:{op:'AND',filters:protos}}}},JsonProtoSerializer.prototype.fromFilter=function(filter){var _this=this;return filter?void 0===filter.unaryFilter?void 0===filter.fieldFilter?void 0===filter.compositeFilter?fail('Unknown filter: '+JSON.stringify(filter)):filter.compositeFilter.filters.map(function(f){return _this.fromFilter(f)}).reduce(function(accum,current){return accum.concat(current)}):[this.fromRelationFilter(filter)]:[this.fromUnaryFilter(filter)]:[]},JsonProtoSerializer.prototype.toOrder=function(orderBys){var _this=this;return 0===orderBys.length?void 0:orderBys.map(function(order){return _this.toPropertyOrder(order)})},JsonProtoSerializer.prototype.fromOrder=function(orderBys){var _this=this;return orderBys.map(function(order){return _this.fromPropertyOrder(order)})},JsonProtoSerializer.prototype.toCursor=function(cursor){var _this=this;return{before:cursor.before,values:cursor.position.map(function(component){return _this.toValue(component)})}},JsonProtoSerializer.prototype.fromCursor=function(cursor){var _this=this,before=!!cursor.before,position=cursor.values.map(function(component){return _this.fromValue(component)});return new Bound(position,before)},JsonProtoSerializer.prototype.toDirection=function(dir){return DIRECTIONS[dir.name]},JsonProtoSerializer.prototype.fromDirection=function(dir){return'ASCENDING'===dir?Direction.ASCENDING:'DESCENDING'===dir?Direction.DESCENDING:void 0},JsonProtoSerializer.prototype.toOperatorName=function(op){return OPERATORS[op.name]},JsonProtoSerializer.prototype.fromOperatorName=function(op){return'EQUAL'===op?RelationOp.EQUAL:'GREATER_THAN'===op?RelationOp.GREATER_THAN:'GREATER_THAN_OR_EQUAL'===op?RelationOp.GREATER_THAN_OR_EQUAL:'LESS_THAN'===op?RelationOp.LESS_THAN:'LESS_THAN_OR_EQUAL'===op?RelationOp.LESS_THAN_OR_EQUAL:'ARRAY_CONTAINS'===op?RelationOp.ARRAY_CONTAINS:'OPERATOR_UNSPECIFIED'===op?fail('Unspecified relation'):fail('Unknown relation')},JsonProtoSerializer.prototype.toFieldPathReference=function(path){return{fieldPath:path.canonicalString()}},JsonProtoSerializer.prototype.fromFieldPathReference=function(fieldReference){return FieldPath.fromServerFormat(fieldReference.fieldPath)},JsonProtoSerializer.prototype.toPropertyOrder=function(orderBy){return{field:this.toFieldPathReference(orderBy.field),direction:this.toDirection(orderBy.dir)}},JsonProtoSerializer.prototype.fromPropertyOrder=function(orderBy){return new OrderBy(this.fromFieldPathReference(orderBy.field),this.fromDirection(orderBy.direction))},JsonProtoSerializer.prototype.toRelationFilter=function(filter){return filter instanceof RelationFilter?{fieldFilter:{field:this.toFieldPathReference(filter.field),op:this.toOperatorName(filter.op),value:this.toValue(filter.value)}}:fail('Unrecognized filter: '+JSON.stringify(filter))},JsonProtoSerializer.prototype.fromRelationFilter=function(filter){return new RelationFilter(this.fromFieldPathReference(filter.fieldFilter.field),this.fromOperatorName(filter.fieldFilter.op),this.fromValue(filter.fieldFilter.value))},JsonProtoSerializer.prototype.toUnaryFilter=function(filter){return filter instanceof NanFilter?{unaryFilter:{field:this.toFieldPathReference(filter.field),op:'IS_NAN'}}:filter instanceof NullFilter?{unaryFilter:{field:this.toFieldPathReference(filter.field),op:'IS_NULL'}}:fail('Unrecognized filter: '+JSON.stringify(filter))},JsonProtoSerializer.prototype.fromUnaryFilter=function(filter){switch(filter.unaryFilter.op){case'IS_NAN':var nanField=this.fromFieldPathReference(filter.unaryFilter.field);return new NanFilter(nanField);case'IS_NULL':var nullField=this.fromFieldPathReference(filter.unaryFilter.field);return new NullFilter(nullField);case'OPERATOR_UNSPECIFIED':return fail('Unspecified filter');default:return fail('Unknown filter');}},JsonProtoSerializer.prototype.toDocumentMask=function(fieldMask){return{fieldPaths:fieldMask.fields.map(function(field){return field.canonicalString()})}},JsonProtoSerializer.prototype.fromDocumentMask=function(proto){var paths=proto.fieldPaths||[],fields=paths.map(function(path){return FieldPath.fromServerFormat(path)});return new FieldMask(fields)},JsonProtoSerializer}(),isReactNative=function(){return'object'==typeof navigator&&'ReactNative'===navigator.product},ERROR_NAME='FirebaseError',captureStackTrace=Error.captureStackTrace,FirebaseError=function(){return function FirebaseError(code,message){if(this.code=code,this.message=message,captureStackTrace)captureStackTrace(this,ErrorFactory.prototype.create);else try{throw Error.apply(this,arguments)}catch(err){this.name=ERROR_NAME,Object.defineProperty(this,'stack',{get:function(){return err.stack}})}}}();FirebaseError.prototype=Object.create(Error.prototype),FirebaseError.prototype.constructor=FirebaseError,FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors,this.pattern=/\{\$([^}]+)}/g}return ErrorFactory.prototype.create=function(code,data){void 0===data&&(data={});var template=this.errors[code],fullCode=this.service+'/'+code,message;message=void 0===template?'Error':template.replace(this.pattern,function(match,key){var value=data[key];return void 0===value?'<'+key+'?>':value.toString()}),message=this.serviceName+': '+message+' ('+fullCode+').';var err=new FirebaseError(fullCode,message);for(var prop in data)data.hasOwnProperty(prop)&&'_'!==prop.slice(-1)&&(err[prop]=data[prop]);return err},ErrorFactory}(),Hash=function(){return function Hash(){this.blockSize=-1}}(),Sha1=function(_super){function Sha1(){var _this=_super.call(this)||this;_this.chain_=[],_this.buf_=[],_this.W_=[],_this.pad_=[],_this.inbuf_=0,_this.total_=0,_this.blockSize=512/8,_this.pad_[0]=128;for(var i=1;i<_this.blockSize;++i)_this.pad_[i]=0;return _this.reset(),_this}return tslib_1.__extends(Sha1,_super),Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,opt_offset){opt_offset||(opt_offset=0);var W=this.W_;if('string'==typeof buf)for(var i=0;16>i;i++)W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3),opt_offset+=4;else for(var i=0;16>i;i++)W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3],opt_offset+=4;for(var i=16,t;80>i;i++)t=W[i-3]^W[i-8]^W[i-14]^W[i-16],W[i]=4294967295&(t<<1|t>>>31);for(var a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],i=0,f,k;80>i;i++){40>i?20>i?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):60>i?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=4294967295&(a<<5|a>>>27)+f+e+k+W[i];e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=4294967295&this.chain_[0]+a,this.chain_[1]=4294967295&this.chain_[1]+b,this.chain_[2]=4294967295&this.chain_[2]+c,this.chain_[3]=4294967295&this.chain_[3]+d,this.chain_[4]=4294967295&this.chain_[4]+e},Sha1.prototype.update=function(bytes,opt_length){if(null!=bytes){void 0===opt_length&&(opt_length=bytes.length);for(var lengthMinusBlock=opt_length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<opt_length;){if(0==inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if('string'==typeof bytes){for(;n<opt_length;)if(buf[inbuf]=bytes.charCodeAt(n),++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<opt_length;)if(buf[inbuf]=bytes[n],++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=opt_length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;56>this.inbuf_?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;56<=i;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);for(var n=0,i=0;5>i;i++)for(var j=24;0<=j;j-=8)digest[n]=255&this.chain_[i]>>j,++n;return digest},Sha1}(Hash),StreamBridge=function(){function StreamBridge(args){this.sendFn=args.sendFn,this.closeFn=args.closeFn}return StreamBridge.prototype.onOpen=function(callback){assert(!this.wrappedOnOpen,'Called onOpen on stream twice!'),this.wrappedOnOpen=callback},StreamBridge.prototype.onClose=function(callback){assert(!this.wrappedOnClose,'Called onClose on stream twice!'),this.wrappedOnClose=callback},StreamBridge.prototype.onMessage=function(callback){assert(!this.wrappedOnMessage,'Called onMessage on stream twice!'),this.wrappedOnMessage=callback},StreamBridge.prototype.close=function(){this.closeFn()},StreamBridge.prototype.send=function(msg){this.sendFn(msg)},StreamBridge.prototype.callOnOpen=function(){assert(void 0!==this.wrappedOnOpen,'Cannot call onOpen because no callback was set'),this.wrappedOnOpen()},StreamBridge.prototype.callOnClose=function(err){assert(void 0!==this.wrappedOnClose,'Cannot call onClose because no callback was set'),this.wrappedOnClose(err)},StreamBridge.prototype.callOnMessage=function(msg){assert(void 0!==this.wrappedOnMessage,'Cannot call onMessage because no callback was set'),this.wrappedOnMessage(msg)},StreamBridge}(),LOG_TAG='Connection',RPC_NAME_REST_MAPPING={BatchGetDocuments:'batchGet',Commit:'commit'},WebChannelConnection=function(){function WebChannelConnection(info){this.databaseId=info.databaseId,this.pool=new webchannelWrapper.XhrIoPool;var proto=info.ssl?'https':'http';this.baseUrl=proto+'://'+info.host}return WebChannelConnection.prototype.modifyHeadersForRequest=function(headers,token){if(token)for(var header in token.authHeaders)token.authHeaders.hasOwnProperty(header)&&(headers[header]=token.authHeaders[header]);headers['X-Goog-Api-Client']='gl-js/ fire/'+SDK_VERSION},WebChannelConnection.prototype.invokeRPC=function(rpcName,request,token){var _this=this,url=this.makeUrl(rpcName);return new Promise(function(resolve,reject){_this.pool.getObject(function(xhr){xhr.listenOnce(webchannelWrapper.EventType.COMPLETE,function(){try{switch(xhr.getLastErrorCode()){case webchannelWrapper.ErrorCode.NO_ERROR:var json=xhr.getResponseJson();debug(LOG_TAG,'XHR received:',JSON.stringify(json)),resolve(json);break;case webchannelWrapper.ErrorCode.TIMEOUT:debug(LOG_TAG,'RPC "'+rpcName+'" timed out'),reject(new FirestoreError(Code.DEADLINE_EXCEEDED,'Request time out'));break;case webchannelWrapper.ErrorCode.HTTP_ERROR:var status_1=xhr.getStatus();debug(LOG_TAG,'RPC "'+rpcName+'" failed with status:',status_1,'response text:',xhr.getResponseText()),0<status_1?reject(new FirestoreError(mapCodeFromHttpStatus(status_1),'Server responded with status '+xhr.getStatusText())):(debug(LOG_TAG,'RPC "'+rpcName+'" failed'),reject(new FirestoreError(Code.UNAVAILABLE,'Connection failed.')));break;default:fail('RPC "'+rpcName+'" failed with unanticipated '+'webchannel error '+xhr.getLastErrorCode()+': '+xhr.getLastError()+', giving up.');}}finally{debug(LOG_TAG,'RPC "'+rpcName+'" completed.'),_this.pool.releaseObject(xhr)}});var requestString=JSON.stringify(request);debug(LOG_TAG,'XHR sending: ',url+' '+requestString);var headers={"Content-Type":'text/plain'};_this.modifyHeadersForRequest(headers,token),xhr.send(url,'POST',requestString,headers,15)})})},WebChannelConnection.prototype.invokeStreamingRPC=function(rpcName,request,token){return this.invokeRPC(rpcName,request,token)},WebChannelConnection.prototype.openStream=function(rpcName,token){var urlParts=[this.baseUrl,'/','google.firestore.v1beta1.Firestore','/',rpcName,'/channel'],webchannelTransport=webchannelWrapper.createWebChannelTransport(),request={backgroundChannelTest:!0,httpSessionIdParam:'gsessionid',initMessageHeaders:{},messageUrlParams:{database:'projects/'+this.databaseId.projectId+'/databases/'+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(request.initMessageHeaders,token),isReactNative()||(request.httpHeadersOverwriteParam='$httpHeaders');var url=urlParts.join('');debug(LOG_TAG,'Creating WebChannel: '+url+' '+request);var channel=webchannelTransport.createWebChannel(url,request),opened=!1,closed=!1,streamBridge=new StreamBridge({sendFn:function(msg){closed?debug(LOG_TAG,'Not sending because WebChannel is closed:',msg):(!opened&&(debug(LOG_TAG,'Opening WebChannel transport.'),channel.open(),opened=!0),debug(LOG_TAG,'WebChannel sending:',msg),channel.send(msg))},closeFn:function(){return channel.close()}}),unguardedEventListen=function(type,fn){channel.listen(type,function(param){try{fn(param)}catch(e){setTimeout(function(){throw e},0)}})};return unguardedEventListen(webchannelWrapper.WebChannel.EventType.OPEN,function(){closed||debug(LOG_TAG,'WebChannel transport opened.')}),unguardedEventListen(webchannelWrapper.WebChannel.EventType.CLOSE,function(){closed||(closed=!0,debug(LOG_TAG,'WebChannel transport closed'),streamBridge.callOnClose())}),unguardedEventListen(webchannelWrapper.WebChannel.EventType.ERROR,function(err){closed||(closed=!0,debug(LOG_TAG,'WebChannel transport errored:',err),streamBridge.callOnClose(new FirestoreError(Code.UNAVAILABLE,'The operation could not be completed')))}),unguardedEventListen(webchannelWrapper.WebChannel.EventType.MESSAGE,function(msg){if(!closed){var msgData=msg.data[0];assert(!!msgData,'Got a webchannel message without data.');var error$$1=msgData.error||msgData[0]&&msgData[0].error;if(error$$1){debug(LOG_TAG,'WebChannel received error:',error$$1);var status_2=error$$1.status,code=mapCodeFromRpcStatus(status_2),message=error$$1.message;void 0===code&&(code=Code.INTERNAL,message='Unknown error status: '+status_2+' with message '+error$$1.message),closed=!0,streamBridge.callOnClose(new FirestoreError(code,message)),channel.close()}else debug(LOG_TAG,'WebChannel received:',msgData),streamBridge.callOnMessage(msgData)}}),setTimeout(function(){streamBridge.callOnOpen()},0),streamBridge},WebChannelConnection.prototype.makeUrl=function(rpcName){var urlRpcName=RPC_NAME_REST_MAPPING[rpcName];assert(void 0!==urlRpcName,'Unknown REST mapping for: '+rpcName);var url=[this.baseUrl,'/','v1beta1','/projects/',this.databaseId.projectId,'/databases/',this.databaseId.database,'/documents',':',urlRpcName];return url.join('')},WebChannelConnection}(),BrowserPlatform=function(){function BrowserPlatform(){this.emptyByteString='',this.base64Available='undefined'!=typeof atob}return Object.defineProperty(BrowserPlatform.prototype,'document',{get:function(){return'undefined'==typeof document?null:document},enumerable:!0,configurable:!0}),Object.defineProperty(BrowserPlatform.prototype,'window',{get:function(){return'undefined'==typeof window?null:window},enumerable:!0,configurable:!0}),BrowserPlatform.prototype.loadConnection=function(databaseInfo){return Promise.resolve(new WebChannelConnection(databaseInfo))},BrowserPlatform.prototype.newSerializer=function(databaseId){return new JsonProtoSerializer(databaseId,{useProto3Json:!0})},BrowserPlatform.prototype.formatJSON=function(value){return JSON.stringify(value)},BrowserPlatform.prototype.atob=function(encoded){return atob(encoded)},BrowserPlatform.prototype.btoa=function(raw){return btoa(raw)},BrowserPlatform}();PlatformSupport.setPlatform(new BrowserPlatform);var ListenSequence=function(){function ListenSequence(previousValue,sequenceNumberSyncer){var _this=this;this.previousValue=previousValue,sequenceNumberSyncer&&(sequenceNumberSyncer.sequenceNumberHandler=function(sequenceNumber){return _this.setPreviousValue(sequenceNumber)},this.writeNewSequenceNumber=function(sequenceNumber){return sequenceNumberSyncer.writeSequenceNumber(sequenceNumber)})}return ListenSequence.prototype.setPreviousValue=function(externalPreviousValue){return this.previousValue=_Mathmax(externalPreviousValue,this.previousValue),this.previousValue},ListenSequence.prototype.next=function(){var nextValue=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(nextValue),nextValue},ListenSequence.INVALID=-1,ListenSequence}(),Deferred$1=function(){return function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve,_this.reject=reject})}}(),TimerId;(function(TimerId){TimerId.All='all',TimerId.ListenStreamIdle='listen_stream_idle',TimerId.ListenStreamConnectionBackoff='listen_stream_connection_backoff',TimerId.WriteStreamIdle='write_stream_idle',TimerId.WriteStreamConnectionBackoff='write_stream_connection_backoff',TimerId.OnlineStateTimeout='online_state_timeout',TimerId.ClientMetadataRefresh='client_metadata_refresh'})(TimerId||(TimerId={}));var DelayedOperation=function(){function DelayedOperation(asyncQueue,timerId,targetTimeMs,op,removalCallback){this.asyncQueue=asyncQueue,this.timerId=timerId,this.targetTimeMs=targetTimeMs,this.op=op,this.removalCallback=removalCallback,this.deferred=new Deferred$1,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(){})}return DelayedOperation.createAndSchedule=function(asyncQueue,timerId,delayMs,op,removalCallback){var targetTime=Date.now()+delayMs,delayedOp=new DelayedOperation(asyncQueue,timerId,targetTime,op,removalCallback);return delayedOp.start(delayMs),delayedOp},DelayedOperation.prototype.start=function(delayMs){var _this=this;this.timerHandle=setTimeout(function(){return _this.handleDelayElapsed()},delayMs)},DelayedOperation.prototype.skipDelay=function(){return this.handleDelayElapsed()},DelayedOperation.prototype.cancel=function(reason){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(Code.CANCELLED,'Operation cancelled'+(reason?': '+reason:''))))},DelayedOperation.prototype.handleDelayElapsed=function(){var _this=this;this.asyncQueue.enqueueAndForget(function(){return null===_this.timerHandle?Promise.resolve():(_this.clearTimeout(),_this.op().then(function(result){return _this.deferred.resolve(result)}))})},DelayedOperation.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},DelayedOperation}(),AsyncQueue=function(){function AsyncQueue(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return AsyncQueue.prototype.enqueueAndForget=function(op){this.enqueue(op)},AsyncQueue.prototype.enqueue=function(op){var _this=this;this.verifyNotFailed();var newTail=this.tail.then(function(){return _this.operationInProgress=!0,op().catch(function(error$$1){_this.failure=error$$1,_this.operationInProgress=!1;var message=error$$1.stack||error$$1.message||'';throw error('INTERNAL UNHANDLED ERROR: ',message),0>message.indexOf('Firestore Test Simulated Error')&&setTimeout(function(){throw error$$1},0),error$$1}).then(function(result){return _this.operationInProgress=!1,result})});return this.tail=newTail,newTail},AsyncQueue.prototype.enqueueAfterDelay=function(timerId,delayMs,op){var _this=this;this.verifyNotFailed(),assert(0<=delayMs,'Attempted to schedule an operation with a negative delay of '+delayMs),assert(!this.containsDelayedOperation(timerId),'Attempted to schedule multiple operations with timer id '+timerId+'.');var delayedOp=DelayedOperation.createAndSchedule(this,timerId,delayMs,op,function(op){return _this.removeDelayedOperation(op)});return this.delayedOperations.push(delayedOp),delayedOp},AsyncQueue.prototype.verifyNotFailed=function(){this.failure&&fail('AsyncQueue is already failed: '+(this.failure.stack||this.failure.message))},AsyncQueue.prototype.verifyOperationInProgress=function(){assert(this.operationInProgress,'verifyOpInProgress() called when no op in progress on this queue.')},AsyncQueue.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},AsyncQueue.prototype.containsDelayedOperation=function(timerId){for(var _i=0,_a=this.delayedOperations,op;_i<_a.length;_i++)if(op=_a[_i],op.timerId===timerId)return!0;return!1},AsyncQueue.prototype.runDelayedOperationsEarly=function(lastTimerId){var _this=this;return this.drain().then(function(){assert(lastTimerId===TimerId.All||_this.containsDelayedOperation(lastTimerId),'Attempted to drain to missing operation '+lastTimerId),_this.delayedOperations.sort(function(a,b){return a.targetTimeMs-b.targetTimeMs});for(var _i=0,_a=_this.delayedOperations,op;_i<_a.length&&(op=_a[_i],op.skipDelay(),lastTimerId===TimerId.All||op.timerId!==lastTimerId);_i++);return _this.drain()})},AsyncQueue.prototype.removeDelayedOperation=function(op){var index=this.delayedOperations.indexOf(op);assert(0<=index,'Delayed operation not found.'),this.delayedOperations.splice(index,1)},AsyncQueue}(),escapeChar='\x01',encodedSeparatorChar='\x01',encodedNul='\x10',encodedEscape='\x11',BATCHID_UNKNOWN=-1,MutationBatch=function(){function MutationBatch(batchId,localWriteTime,mutations){this.batchId=batchId,this.localWriteTime=localWriteTime,this.mutations=mutations,assert(0<mutations.length,'Cannot create an empty mutation batch')}return MutationBatch.prototype.applyToRemoteDocument=function(docKey,maybeDoc,batchResult){maybeDoc&&assert(maybeDoc.key.isEqual(docKey),'applyToRemoteDocument: key '+docKey+' should match maybeDoc key\n        '+maybeDoc.key);var mutationResults=batchResult.mutationResults;assert(mutationResults.length===this.mutations.length,'Mismatch between mutations length\n      ('+this.mutations.length+') and mutation results length\n      ('+mutationResults.length+').');for(var i=0,mutation;i<this.mutations.length;i++)if(mutation=this.mutations[i],mutation.key.isEqual(docKey)){var mutationResult=mutationResults[i];maybeDoc=mutation.applyToRemoteDocument(maybeDoc,mutationResult)}return maybeDoc},MutationBatch.prototype.applyToLocalView=function(docKey,maybeDoc){maybeDoc&&assert(maybeDoc.key.isEqual(docKey),'applyToLocalDocument: key '+docKey+' should match maybeDoc key\n        '+maybeDoc.key);for(var baseDoc=maybeDoc,i=0,mutation;i<this.mutations.length;i++)mutation=this.mutations[i],mutation.key.isEqual(docKey)&&(maybeDoc=mutation.applyToLocalView(maybeDoc,baseDoc,this.localWriteTime));return maybeDoc},MutationBatch.prototype.keys=function(){for(var keySet=documentKeySet(),_i=0,_a=this.mutations,mutation;_i<_a.length;_i++)mutation=_a[_i],keySet=keySet.add(mutation.key);return keySet},MutationBatch.prototype.isEqual=function(other){return this.batchId===other.batchId&&arrayEquals(this.mutations,other.mutations)},MutationBatch}(),MutationBatchResult=function(){function MutationBatchResult(batch,commitVersion,mutationResults,streamToken,docVersions){this.batch=batch,this.commitVersion=commitVersion,this.mutationResults=mutationResults,this.streamToken=streamToken,this.docVersions=docVersions}return MutationBatchResult.from=function(batch,commitVersion,results,streamToken){assert(batch.mutations.length===results.length,'Mutations sent '+batch.mutations.length+' must equal results received '+results.length);for(var versionMap=documentVersionMap(),mutations=batch.mutations,i=0;i<mutations.length;i++)versionMap=versionMap.insert(mutations[i].key,results[i].version);return new MutationBatchResult(batch,commitVersion,results,streamToken,versionMap)},MutationBatchResult}(),PersistencePromise=function(){function PersistencePromise(callback){var _this=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,callback(function(value){_this.isDone=!0,_this.result=value,_this.nextCallback&&_this.nextCallback(value)},function(error){_this.isDone=!0,_this.error=error,_this.catchCallback&&_this.catchCallback(error)})}return PersistencePromise.prototype.catch=function(fn){return this.next(void 0,fn)},PersistencePromise.prototype.next=function(nextFn,catchFn){var _this=this;return this.callbackAttached&&fail('Called next() or catch() twice for PersistencePromise'),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(catchFn,this.error):this.wrapSuccess(nextFn,this.result):new PersistencePromise(function(resolve,reject){_this.nextCallback=function(value){_this.wrapSuccess(nextFn,value).next(resolve,reject)},_this.catchCallback=function(error){_this.wrapFailure(catchFn,error).next(resolve,reject)}})},PersistencePromise.prototype.toPromise=function(){var _this=this;return new Promise(function(resolve,reject){_this.next(resolve,reject)})},PersistencePromise.prototype.wrapUserFunction=function(fn){try{var result=fn();return result instanceof PersistencePromise?result:PersistencePromise.resolve(result)}catch(e){return PersistencePromise.reject(e)}},PersistencePromise.prototype.wrapSuccess=function(nextFn,value){return nextFn?this.wrapUserFunction(function(){return nextFn(value)}):PersistencePromise.resolve(value)},PersistencePromise.prototype.wrapFailure=function(catchFn,error){return catchFn?this.wrapUserFunction(function(){return catchFn(error)}):PersistencePromise.reject(error)},PersistencePromise.resolve=function(result){return new PersistencePromise(function(resolve){resolve(result)})},PersistencePromise.reject=function(error){return new PersistencePromise(function(resolve,reject){reject(error)})},PersistencePromise.waitFor=function(all){return new PersistencePromise(function(resolve,reject){var expectedCount=0,resolvedCount=0,done=!1;all.forEach(function(element){++expectedCount,element.next(function(){++resolvedCount,done&&resolvedCount==expectedCount&&resolve()},function(err){return reject(err)})}),done=!0,resolvedCount==expectedCount&&resolve()})},PersistencePromise.or=function(predicates){for(var p=PersistencePromise.resolve(!1),_loop_1=function(predicate){p=p.next(function(isTrue){return isTrue?PersistencePromise.resolve(isTrue):predicate()})},_i=0,predicates_1=predicates,predicate;_i<predicates_1.length;_i++)predicate=predicates_1[_i],_loop_1(predicate);return p},PersistencePromise.forEach=function(collection,f){var _this=this,promises=[];return collection.forEach(function(r,s){promises.push(f.call(_this,r,s))}),this.waitFor(promises)},PersistencePromise}(),ObjectMap=function(){function ObjectMap(mapKeyFn){this.mapKeyFn=mapKeyFn,this.inner={}}return ObjectMap.prototype.get=function(key){var id=this.mapKeyFn(key),matches=this.inner[id];if(void 0!==matches)for(var _i=0,matches_1=matches;_i<matches_1.length;_i++){var _a=matches_1[_i],otherKey=_a[0],value=_a[1];if(otherKey.isEqual(key))return value}},ObjectMap.prototype.has=function(key){return void 0!==this.get(key)},ObjectMap.prototype.set=function(key,value){var id=this.mapKeyFn(key),matches=this.inner[id];if(void 0===matches)return void(this.inner[id]=[[key,value]]);for(var i=0;i<matches.length;i++)if(matches[i][0].isEqual(key))return void(matches[i]=[key,value]);matches.push([key,value])},ObjectMap.prototype.delete=function(key){var id=this.mapKeyFn(key),matches=this.inner[id];if(void 0===matches)return!1;for(var i=0;i<matches.length;i++)if(matches[i][0].isEqual(key))return 1===matches.length?delete this.inner[id]:matches.splice(i,1),!0;return!1},ObjectMap.prototype.forEach=function(fn){forEach(this.inner,function(_,entries){for(var _i=0,entries_1=entries;_i<entries_1.length;_i++){var _a=entries_1[_i],k=_a[0],v=_a[1];fn(k,v)}})},ObjectMap.prototype.isEmpty=function(){return isEmpty(this.inner)},ObjectMap}(),RemoteDocumentChangeBuffer=function(){function RemoteDocumentChangeBuffer(){this.changes=maybeDocumentMap(),this.documentSizes=new ObjectMap(function(key){return key.toString()})}return RemoteDocumentChangeBuffer.prototype.addEntry=function(maybeDocument){var changes=this.assertChanges();this.changes=changes.insert(maybeDocument.key,maybeDocument)},RemoteDocumentChangeBuffer.prototype.getEntry=function(transaction,documentKey){var _this=this,changes=this.assertChanges(),bufferedEntry=changes.get(documentKey);return bufferedEntry?PersistencePromise.resolve(bufferedEntry):this.getFromCache(transaction,documentKey).next(function(getResult){return null===getResult?(_this.documentSizes.set(documentKey,0),null):(_this.documentSizes.set(documentKey,getResult.size),getResult.maybeDocument)})},RemoteDocumentChangeBuffer.prototype.apply=function(transaction){var result=this.applyChanges(transaction);return this.changes=null,result},RemoteDocumentChangeBuffer.prototype.assertChanges=function(){return assert(null!==this.changes,'Changes have already been applied.'),this.changes},RemoteDocumentChangeBuffer}(),LOG_TAG$1='SimpleDb',SimpleDb=function(){function SimpleDb(db){this.db=db}return SimpleDb.openOrCreate=function(name,version,schemaConverter){return assert(SimpleDb.isAvailable(),'IndexedDB not supported in current environment.'),debug(LOG_TAG$1,'Opening database:',name),new PersistencePromise(function(resolve,reject){var request=window.indexedDB.open(name,version);request.onsuccess=function(event){var db=event.target.result;resolve(new SimpleDb(db))},request.onblocked=function(){reject(new FirestoreError(Code.FAILED_PRECONDITION,'Cannot upgrade IndexedDB schema while another tab is open. '+'Close all tabs that access Firestore and reload this page to proceed.'))},request.onerror=function(event){reject(event.target.error)},request.onupgradeneeded=function(event){debug(LOG_TAG$1,'Database "'+name+'" requires upgrade from version:',event.oldVersion);var db=event.target.result,txn=new SimpleDbTransaction(request.transaction);schemaConverter.createOrUpgrade(db,txn,event.oldVersion,SCHEMA_VERSION).next(function(){debug(LOG_TAG$1,'Database upgrade to version '+SCHEMA_VERSION+' complete')})}}).toPromise()},SimpleDb.delete=function(name){return debug(LOG_TAG$1,'Removing database:',name),wrapRequest(window.indexedDB.deleteDatabase(name)).toPromise()},SimpleDb.isAvailable=function(){if('undefined'==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return'YES'===process.env.USE_MOCK_PERSISTENCE;var ua=window.navigator.userAgent;return 0<ua.indexOf('MSIE ')||0<ua.indexOf('Trident/')||0<ua.indexOf('Edge/')?!1:!0},SimpleDb.getStore=function(txn,store){return txn.store(store)},SimpleDb.prototype.runTransaction=function(mode,objectStores,transactionFn){var transaction=SimpleDbTransaction.open(this.db,mode,objectStores),transactionFnResult=transactionFn(transaction).catch(function(error$$1){transaction.abort(error$$1)}).toPromise();return transaction.completionPromise.then(function(){return transactionFnResult})},SimpleDb.prototype.close=function(){this.db.close()},SimpleDb}(),IterationController=function(){function IterationController(dbCursor){this.dbCursor=dbCursor,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(IterationController.prototype,'isDone',{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(IterationController.prototype,'skipToKey',{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(IterationController.prototype,'cursor',{set:function(value){this.dbCursor=value},enumerable:!0,configurable:!0}),IterationController.prototype.done=function(){this.shouldStop=!0},IterationController.prototype.skip=function(key){this.nextKey=key},IterationController.prototype.delete=function(){return wrapRequest(this.dbCursor.delete())},IterationController}(),SimpleDbTransaction=function(){function SimpleDbTransaction(transaction){var _this=this;this.transaction=transaction,this.aborted=!1,this.completionDeferred=new Deferred$1,this.transaction.oncomplete=function(){_this.completionDeferred.resolve()},this.transaction.onabort=function(){transaction.error?_this.completionDeferred.reject(transaction.error):_this.completionDeferred.resolve()},this.transaction.onerror=function(event){_this.completionDeferred.reject(event.target.error)}}return SimpleDbTransaction.open=function(db,mode,objectStoreNames){return new SimpleDbTransaction(db.transaction(objectStoreNames,mode))},Object.defineProperty(SimpleDbTransaction.prototype,'completionPromise',{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),SimpleDbTransaction.prototype.abort=function(error$$1){error$$1&&this.completionDeferred.reject(error$$1),this.aborted||(debug(LOG_TAG$1,'Aborting transaction:',error$$1?error$$1.message:'Client-initiated abort'),this.aborted=!0,this.transaction.abort())},SimpleDbTransaction.prototype.store=function(storeName){var store=this.transaction.objectStore(storeName);return assert(!!store,'Object store not part of transaction: '+storeName),new SimpleDbStore(store)},SimpleDbTransaction}(),SimpleDbStore=function(){function SimpleDbStore(store){this.store=store}return SimpleDbStore.prototype.put=function(keyOrValue,value){var request;return void 0===value?(debug(LOG_TAG$1,'PUT',this.store.name,'<auto-key>',keyOrValue),request=this.store.put(keyOrValue)):(debug(LOG_TAG$1,'PUT',this.store.name,keyOrValue,value),request=this.store.put(value,keyOrValue)),wrapRequest(request)},SimpleDbStore.prototype.add=function(value){debug(LOG_TAG$1,'ADD',this.store.name,value,value);var request=this.store.add(value);return wrapRequest(request)},SimpleDbStore.prototype.get=function(key){var _this=this,request=this.store.get(key);return wrapRequest(request).next(function(result){return void 0===result&&(result=null),debug(LOG_TAG$1,'GET',_this.store.name,key,result),result})},SimpleDbStore.prototype.delete=function(key){debug(LOG_TAG$1,'DELETE',this.store.name,key);var request=this.store.delete(key);return wrapRequest(request)},SimpleDbStore.prototype.count=function(){debug(LOG_TAG$1,'COUNT',this.store.name);var request=this.store.count();return wrapRequest(request)},SimpleDbStore.prototype.loadAll=function(indexOrRange,range){var cursor=this.cursor(this.options(indexOrRange,range)),results=[];return this.iterateCursor(cursor,function(key,value){results.push(value)}).next(function(){return results})},SimpleDbStore.prototype.deleteAll=function(indexOrRange,range){debug(LOG_TAG$1,'DELETE ALL',this.store.name);var options=this.options(indexOrRange,range);options.keysOnly=!1;var cursor=this.cursor(options);return this.iterateCursor(cursor,function(key,value,control){return control.delete()})},SimpleDbStore.prototype.iterate=function(optionsOrCallback,callback){var options;callback?options=optionsOrCallback:(options={},callback=optionsOrCallback);var cursor=this.cursor(options);return this.iterateCursor(cursor,callback)},SimpleDbStore.prototype.iterateSerial=function(callback){var cursorRequest=this.cursor({});return new PersistencePromise(function(resolve,reject){cursorRequest.onerror=function(event){reject(event.target.error)},cursorRequest.onsuccess=function(event){var cursor=event.target.result;return cursor?void callback(cursor.primaryKey,cursor.value).next(function(shouldContinue){shouldContinue?cursor.continue():resolve()}):void resolve()}})},SimpleDbStore.prototype.iterateCursor=function(cursorRequest,fn){var results=[];return new PersistencePromise(function(resolve,reject){cursorRequest.onerror=function(event){reject(event.target.error)},cursorRequest.onsuccess=function(event){var cursor=event.target.result;if(!cursor)return void resolve();var controller=new IterationController(cursor),userResult=fn(cursor.primaryKey,cursor.value,controller);if(userResult instanceof PersistencePromise){var userPromise=userResult.catch(function(err){return controller.done(),PersistencePromise.reject(err)});results.push(userPromise)}controller.isDone?resolve():null===controller.skipToKey?cursor.continue():cursor.continue(controller.skipToKey)}}).next(function(){return PersistencePromise.waitFor(results)})},SimpleDbStore.prototype.options=function(indexOrRange,range){var indexName;return void 0!==indexOrRange&&('string'==typeof indexOrRange?indexName=indexOrRange:(assert(void 0===range,'3rd argument must not be defined if 2nd is a range.'),range=indexOrRange)),{index:indexName,range:range}},SimpleDbStore.prototype.cursor=function(options){var direction='next';if(options.reverse&&(direction='prev'),options.index){var index=this.store.index(options.index);return options.keysOnly?index.openKeyCursor(options.range,direction):index.openCursor(options.range,direction)}return this.store.openCursor(options.range,direction)},SimpleDbStore}(),REMOTE_DOCUMENT_CHANGE_MISSING_ERR_MSG='The remote document changelog no longer contains all changes for all '+'local query views. It may be necessary to rebuild these views.',IndexedDbRemoteDocumentCache=function(){function IndexedDbRemoteDocumentCache(serializer,keepDocumentChangeLog){this.serializer=serializer,this.keepDocumentChangeLog=keepDocumentChangeLog,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(IndexedDbRemoteDocumentCache.prototype,'lastProcessedDocumentChangeId',{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),IndexedDbRemoteDocumentCache.prototype.start=function(transaction){var store=SimpleDb.getStore(transaction,DbRemoteDocumentChanges.store);return this.synchronizeLastDocumentChangeId(store)},IndexedDbRemoteDocumentCache.prototype.addEntries=function(transaction,entries,sizeDelta){var promises=[];if(0<entries.length){for(var documentStore=remoteDocumentsStore(transaction),changedKeys=documentKeySet(),_i=0,entries_1=entries;_i<entries_1.length;_i++){var _a=entries_1[_i],key=_a.key,doc=_a.doc;promises.push(documentStore.put(dbKey(key),doc)),changedKeys=changedKeys.add(key)}this.keepDocumentChangeLog&&promises.push(documentChangesStore(transaction).put({changes:this.serializer.toDbResourcePaths(changedKeys)})),promises.push(this.updateSize(transaction,sizeDelta))}return PersistencePromise.waitFor(promises)},IndexedDbRemoteDocumentCache.prototype.removeEntry=function(transaction,documentKey){var store=remoteDocumentsStore(transaction),key=dbKey(documentKey);return store.get(key).next(function(document){return document?store.delete(key).next(function(){return dbDocumentSize(document)}):PersistencePromise.resolve(0)})},IndexedDbRemoteDocumentCache.prototype.getEntry=function(transaction,documentKey){var _this=this;return remoteDocumentsStore(transaction).get(dbKey(documentKey)).next(function(dbRemoteDoc){return dbRemoteDoc?_this.serializer.fromDbRemoteDocument(dbRemoteDoc):null})},IndexedDbRemoteDocumentCache.prototype.getSizedEntry=function(transaction,documentKey){var _this=this;return remoteDocumentsStore(transaction).get(dbKey(documentKey)).next(function(dbRemoteDoc){return dbRemoteDoc?{maybeDocument:_this.serializer.fromDbRemoteDocument(dbRemoteDoc),size:dbDocumentSize(dbRemoteDoc)}:null})},IndexedDbRemoteDocumentCache.prototype.getDocumentsMatchingQuery=function(transaction,query){var _this=this,results=documentMap(),startKey=query.path.toArray(),range=IDBKeyRange.lowerBound(startKey);return remoteDocumentsStore(transaction).iterate({range:range},function(key,dbRemoteDoc,control){var maybeDoc=_this.serializer.fromDbRemoteDocument(dbRemoteDoc);query.path.isPrefixOf(maybeDoc.key.path)?maybeDoc instanceof Document&&query.matches(maybeDoc)&&(results=results.insert(maybeDoc.key,maybeDoc)):control.done()}).next(function(){return results})},IndexedDbRemoteDocumentCache.prototype.getNewDocumentChanges=function(transaction){var _this=this;assert(this.keepDocumentChangeLog,'Can only call getNewDocumentChanges() when document change log is enabled');var changedKeys=documentKeySet(),changedDocs=maybeDocumentMap(),range=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),firstIteration=!0,changesStore=documentChangesStore(transaction);return changesStore.iterate({range:range},function(_,documentChange){return firstIteration&&(firstIteration=!1,_this._lastProcessedDocumentChangeId+1!==documentChange.id)?_this.synchronizeLastDocumentChangeId(changesStore).next(function(){return PersistencePromise.reject(new FirestoreError(Code.DATA_LOSS,REMOTE_DOCUMENT_CHANGE_MISSING_ERR_MSG))}):void(changedKeys=changedKeys.unionWith(_this.serializer.fromDbResourcePaths(documentChange.changes)),_this._lastProcessedDocumentChangeId=documentChange.id)}).next(function(){var documentPromises=[];return changedKeys.forEach(function(key){documentPromises.push(_this.getEntry(transaction,key).next(function(maybeDocument){var doc=maybeDocument||new NoDocument(key,SnapshotVersion.forDeletedDoc());changedDocs=changedDocs.insert(key,doc)}))}),PersistencePromise.waitFor(documentPromises)}).next(function(){return changedDocs})},IndexedDbRemoteDocumentCache.prototype.removeDocumentChangesThroughChangeId=function(transaction,changeId){var range=IDBKeyRange.upperBound(changeId);return documentChangesStore(transaction).delete(range)},IndexedDbRemoteDocumentCache.prototype.synchronizeLastDocumentChangeId=function(documentChangesStore){var _this=this;return this._lastProcessedDocumentChangeId=0,documentChangesStore.iterate({keysOnly:!0,reverse:!0},function(key,value,control){_this._lastProcessedDocumentChangeId=key,control.done()})},IndexedDbRemoteDocumentCache.prototype.newChangeBuffer=function(){return new IndexedDbRemoteDocumentChangeBuffer(this)},IndexedDbRemoteDocumentCache.prototype.getSize=function(txn){return this.getMetadata(txn).next(function(metadata){return metadata.byteSize})},IndexedDbRemoteDocumentCache.prototype.getMetadata=function(txn){return documentGlobalStore(txn).get(DbRemoteDocumentGlobal.key).next(function(metadata){return assert(!!metadata,'Missing document cache metadata'),metadata})},IndexedDbRemoteDocumentCache.prototype.setMetadata=function(txn,metadata){return documentGlobalStore(txn).put(DbRemoteDocumentGlobal.key,metadata)},IndexedDbRemoteDocumentCache.prototype.updateSize=function(txn,sizeDelta){var _this=this;return this.getMetadata(txn).next(function(metadata){return metadata.byteSize+=sizeDelta,_this.setMetadata(txn,metadata)})},IndexedDbRemoteDocumentCache}(),IndexedDbRemoteDocumentChangeBuffer=function(_super){function IndexedDbRemoteDocumentChangeBuffer(documentCache){var _this=_super.call(this)||this;return _this.documentCache=documentCache,_this}return tslib_1.__extends(IndexedDbRemoteDocumentChangeBuffer,_super),IndexedDbRemoteDocumentChangeBuffer.prototype.applyChanges=function(transaction){var _this=this,changes=this.assertChanges(),delta=0,toApply=[];return changes.forEach(function(key,maybeDocument){var doc=_this.documentCache.serializer.toDbRemoteDocument(maybeDocument),previousSize=_this.documentSizes.get(key);assert(void 0!==previousSize,'Attempting to change document '+key.toString()+' without having read it first');var size=dbDocumentSize(doc);delta+=size-previousSize,toApply.push({key:key,doc:doc})}),this.documentCache.addEntries(transaction,toApply,delta)},IndexedDbRemoteDocumentChangeBuffer.prototype.getFromCache=function(transaction,documentKey){return this.documentCache.getSizedEntry(transaction,documentKey)},IndexedDbRemoteDocumentChangeBuffer}(RemoteDocumentChangeBuffer),SCHEMA_VERSION=6,SchemaConverter=function(){function SchemaConverter(serializer){this.serializer=serializer}return SchemaConverter.prototype.createOrUpgrade=function(db,txn,fromVersion,toVersion){var _this=this;assert(fromVersion<toVersion&&0<=fromVersion&&toVersion<=SCHEMA_VERSION,'Unexpected schema upgrade from v'+fromVersion+' to v{toVersion}.'),1>fromVersion&&1<=toVersion&&(createPrimaryClientStore(db),createMutationQueue(db),createQueryCache(db),createRemoteDocumentCache(db));var p=PersistencePromise.resolve();return 3>fromVersion&&3<=toVersion&&(0!==fromVersion&&(dropQueryCache(db),createQueryCache(db)),p=p.next(function(){return writeEmptyTargetGlobalEntry(txn)})),4>fromVersion&&4<=toVersion&&(0!==fromVersion&&(p=p.next(function(){return upgradeMutationBatchSchemaAndMigrateData(db,txn)})),p=p.next(function(){createClientMetadataStore(db),createRemoteDocumentChangesStore(db)})),5>fromVersion&&5<=toVersion&&(p=p.next(function(){return _this.removeAcknowledgedMutations(txn)})),6>fromVersion&&6<=toVersion&&(p=p.next(function(){return createDocumentGlobalStore(db),_this.addDocumentGlobal(txn)})),p},SchemaConverter.prototype.addDocumentGlobal=function(txn){var byteCount=0;return txn.store(DbRemoteDocument.store).iterate(function(_,doc){byteCount+=dbDocumentSize(doc)}).next(function(){var metadata=new DbRemoteDocumentGlobal(byteCount);return txn.store(DbRemoteDocumentGlobal.store).put(DbRemoteDocumentGlobal.key,metadata)})},SchemaConverter.prototype.removeAcknowledgedMutations=function(txn){var _this=this,queuesStore=txn.store(DbMutationQueue.store),mutationsStore=txn.store(DbMutationBatch.store);return queuesStore.loadAll().next(function(queues){return PersistencePromise.forEach(queues,function(queue){var range=IDBKeyRange.bound([queue.userId,BATCHID_UNKNOWN],[queue.userId,queue.lastAcknowledgedBatchId]);return mutationsStore.loadAll(DbMutationBatch.userMutationsIndex,range).next(function(dbBatches){return PersistencePromise.forEach(dbBatches,function(dbBatch){assert(dbBatch.userId===queue.userId,'Cannot process batch '+dbBatch.batchId+' from unexpected user');var batch=_this.serializer.fromDbMutationBatch(dbBatch);return removeMutationBatch(txn,queue.userId,batch).next(function(){})})})})})},SchemaConverter}(),DbTimestamp=function(){return function DbTimestamp(seconds,nanoseconds){this.seconds=seconds,this.nanoseconds=nanoseconds}}(),DbPrimaryClient=function(){function DbPrimaryClient(ownerId,allowTabSynchronization,leaseTimestampMs){this.ownerId=ownerId,this.allowTabSynchronization=allowTabSynchronization,this.leaseTimestampMs=leaseTimestampMs}return DbPrimaryClient.store='owner',DbPrimaryClient.key='owner',DbPrimaryClient}(),DbMutationQueue=function(){function DbMutationQueue(userId,lastAcknowledgedBatchId,lastStreamToken){this.userId=userId,this.lastAcknowledgedBatchId=lastAcknowledgedBatchId,this.lastStreamToken=lastStreamToken}return DbMutationQueue.store='mutationQueues',DbMutationQueue.keyPath='userId',DbMutationQueue}(),DbMutationBatch=function(){function DbMutationBatch(userId,batchId,localWriteTimeMs,mutations){this.userId=userId,this.batchId=batchId,this.localWriteTimeMs=localWriteTimeMs,this.mutations=mutations}return DbMutationBatch.store='mutations',DbMutationBatch.keyPath='batchId',DbMutationBatch.userMutationsIndex='userMutationsIndex',DbMutationBatch.userMutationsKeyPath=['userId','batchId'],DbMutationBatch}(),DbDocumentMutation=function(){function DbDocumentMutation(){}return DbDocumentMutation.prefixForUser=function(userId){return[userId]},DbDocumentMutation.prefixForPath=function(userId,path){return[userId,encode(path)]},DbDocumentMutation.key=function(userId,path,batchId){return[userId,encode(path),batchId]},DbDocumentMutation.store='documentMutations',DbDocumentMutation.PLACEHOLDER=new DbDocumentMutation,DbDocumentMutation}(),DbNoDocument=function(){return function DbNoDocument(path,readTime){this.path=path,this.readTime=readTime}}(),DbUnknownDocument=function(){return function DbUnknownDocument(path,version){this.path=path,this.version=version}}(),DbRemoteDocument=function(){function DbRemoteDocument(unknownDocument,noDocument,document,hasCommittedMutations){this.unknownDocument=unknownDocument,this.noDocument=noDocument,this.document=document,this.hasCommittedMutations=hasCommittedMutations}return DbRemoteDocument.store='remoteDocuments',DbRemoteDocument}(),DbRemoteDocumentGlobal=function(){function DbRemoteDocumentGlobal(byteSize){this.byteSize=byteSize}return DbRemoteDocumentGlobal.store='remoteDocumentGlobal',DbRemoteDocumentGlobal.key='remoteDocumentGlobalKey',DbRemoteDocumentGlobal}(),DbTarget=function(){function DbTarget(targetId,canonicalId,readTime,resumeToken,lastListenSequenceNumber,query){this.targetId=targetId,this.canonicalId=canonicalId,this.readTime=readTime,this.resumeToken=resumeToken,this.lastListenSequenceNumber=lastListenSequenceNumber,this.query=query}return DbTarget.store='targets',DbTarget.keyPath='targetId',DbTarget.queryTargetsIndexName='queryTargetsIndex',DbTarget.queryTargetsKeyPath=['canonicalId','targetId'],DbTarget}(),DbTargetDocument=function(){function DbTargetDocument(targetId,path,sequenceNumber){this.targetId=targetId,this.path=path,this.sequenceNumber=sequenceNumber,assert(0===targetId==(void 0!==sequenceNumber),'A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number')}return DbTargetDocument.store='targetDocuments',DbTargetDocument.keyPath=['targetId','path'],DbTargetDocument.documentTargetsIndex='documentTargetsIndex',DbTargetDocument.documentTargetsKeyPath=['path','targetId'],DbTargetDocument}(),DbTargetGlobal=function(){function DbTargetGlobal(highestTargetId,highestListenSequenceNumber,lastRemoteSnapshotVersion,targetCount){this.highestTargetId=highestTargetId,this.highestListenSequenceNumber=highestListenSequenceNumber,this.lastRemoteSnapshotVersion=lastRemoteSnapshotVersion,this.targetCount=targetCount}return DbTargetGlobal.key='targetGlobalKey',DbTargetGlobal.store='targetGlobal',DbTargetGlobal}(),DbRemoteDocumentChanges=function(){function DbRemoteDocumentChanges(changes){this.changes=changes}return DbRemoteDocumentChanges.store='remoteDocumentChanges',DbRemoteDocumentChanges.keyPath='id',DbRemoteDocumentChanges}(),DbClientMetadata=function(){function DbClientMetadata(clientId,updateTimeMs,networkEnabled,inForeground,lastProcessedDocumentChangeId){this.clientId=clientId,this.updateTimeMs=updateTimeMs,this.networkEnabled=networkEnabled,this.inForeground=inForeground,this.lastProcessedDocumentChangeId=lastProcessedDocumentChangeId}return DbClientMetadata.store='clientMetadata',DbClientMetadata.keyPath='clientId',DbClientMetadata}(),V1_STORES=[DbMutationQueue.store,DbMutationBatch.store,DbDocumentMutation.store,DbRemoteDocument.store,DbTarget.store,DbPrimaryClient.store,DbTargetGlobal.store,DbTargetDocument.store],V4_STORES=V1_STORES.concat([DbClientMetadata.store,DbRemoteDocumentChanges.store]),V6_STORES=V4_STORES.concat([DbRemoteDocumentGlobal.store]),ALL_STORES=V6_STORES,IndexedDbMutationQueue=function(){function IndexedDbMutationQueue(userId,serializer,referenceDelegate){this.userId=userId,this.serializer=serializer,this.referenceDelegate=referenceDelegate,this.documentKeysByBatchId={}}return IndexedDbMutationQueue.forUser=function(user,serializer,referenceDelegate){assert(''!==user.uid,'UserID must not be an empty string.');var userId=user.isAuthenticated()?user.uid:'';return new IndexedDbMutationQueue(userId,serializer,referenceDelegate)},IndexedDbMutationQueue.prototype.checkEmpty=function(transaction){var empty=!0,range=IDBKeyRange.bound([this.userId,_NumberNEGATIVE_INFINITY],[this.userId,_NumberPOSITIVE_INFINITY]);return mutationsStore(transaction).iterate({index:DbMutationBatch.userMutationsIndex,range:range},function(key,value,control){empty=!1,control.done()}).next(function(){return empty})},IndexedDbMutationQueue.prototype.acknowledgeBatch=function(transaction,batch,streamToken){return this.getMutationQueueMetadata(transaction).next(function(metadata){var batchId=batch.batchId;return assert(batchId>metadata.lastAcknowledgedBatchId,'Mutation batchIDs must be acknowledged in order'),metadata.lastAcknowledgedBatchId=batchId,metadata.lastStreamToken=convertStreamToken(streamToken),mutationQueuesStore(transaction).put(metadata)})},IndexedDbMutationQueue.prototype.getLastStreamToken=function(transaction){return this.getMutationQueueMetadata(transaction).next(function(metadata){return metadata.lastStreamToken})},IndexedDbMutationQueue.prototype.setLastStreamToken=function(transaction,streamToken){return this.getMutationQueueMetadata(transaction).next(function(metadata){return metadata.lastStreamToken=convertStreamToken(streamToken),mutationQueuesStore(transaction).put(metadata)})},IndexedDbMutationQueue.prototype.addMutationBatch=function(transaction,localWriteTime,mutations){var _this=this,documentStore=documentMutationsStore(transaction),mutationStore=mutationsStore(transaction);return mutationStore.add({}).next(function(batchId){assert('number'==typeof batchId,'Auto-generated key is not a number');var batch=new MutationBatch(batchId,localWriteTime,mutations),dbBatch=_this.serializer.toDbMutationBatch(_this.userId,batch);_this.documentKeysByBatchId[batchId]=batch.keys();for(var promises=[],_i=0,mutations_1=mutations;_i<mutations_1.length;_i++){var mutation=mutations_1[_i],indexKey=DbDocumentMutation.key(_this.userId,mutation.key.path,batchId);promises.push(mutationStore.put(dbBatch)),promises.push(documentStore.put(indexKey,DbDocumentMutation.PLACEHOLDER))}return PersistencePromise.waitFor(promises).next(function(){return batch})})},IndexedDbMutationQueue.prototype.lookupMutationBatch=function(transaction,batchId){var _this=this;return mutationsStore(transaction).get(batchId).next(function(dbBatch){return dbBatch?(assert(dbBatch.userId===_this.userId,'Unexpected user \''+dbBatch.userId+'\' for mutation batch '+batchId),_this.serializer.fromDbMutationBatch(dbBatch)):null})},IndexedDbMutationQueue.prototype.lookupMutationKeys=function(transaction,batchId){var _this=this;return this.documentKeysByBatchId[batchId]?PersistencePromise.resolve(this.documentKeysByBatchId[batchId]):this.lookupMutationBatch(transaction,batchId).next(function(batch){if(batch){var keys=batch.keys();return _this.documentKeysByBatchId[batchId]=keys,keys}return null})},IndexedDbMutationQueue.prototype.getNextMutationBatchAfterBatchId=function(transaction,batchId){var _this=this;return this.getMutationQueueMetadata(transaction).next(function(metadata){var nextBatchId=_Mathmax(batchId,metadata.lastAcknowledgedBatchId)+1,range=IDBKeyRange.lowerBound([_this.userId,nextBatchId]),foundBatch=null;return mutationsStore(transaction).iterate({index:DbMutationBatch.userMutationsIndex,range:range},function(key,dbBatch,control){dbBatch.userId===_this.userId&&(assert(dbBatch.batchId>=nextBatchId,'Should have found mutation after '+nextBatchId),foundBatch=_this.serializer.fromDbMutationBatch(dbBatch)),control.done()}).next(function(){return foundBatch})})},IndexedDbMutationQueue.prototype.getAllMutationBatches=function(transaction){var _this=this,range=IDBKeyRange.bound([this.userId,BATCHID_UNKNOWN],[this.userId,_NumberPOSITIVE_INFINITY]);return mutationsStore(transaction).loadAll(DbMutationBatch.userMutationsIndex,range).next(function(dbBatches){return dbBatches.map(function(dbBatch){return _this.serializer.fromDbMutationBatch(dbBatch)})})},IndexedDbMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKey=function(transaction,documentKey){var _this=this,indexPrefix=DbDocumentMutation.prefixForPath(this.userId,documentKey.path),indexStart=IDBKeyRange.lowerBound(indexPrefix),results=[];return documentMutationsStore(transaction).iterate({range:indexStart},function(indexKey,_,control){var userID=indexKey[0],encodedPath=indexKey[1],batchId=indexKey[2],path=decode$1(encodedPath);return userID===_this.userId&&documentKey.path.isEqual(path)?mutationsStore(transaction).get(batchId).next(function(mutation){if(!mutation)throw fail('Dangling document-mutation reference found: '+indexKey+' which points to '+batchId);assert(mutation.userId===_this.userId,'Unexpected user \''+mutation.userId+'\' for mutation batch '+batchId),results.push(_this.serializer.fromDbMutationBatch(mutation))}):void control.done()}).next(function(){return results})},IndexedDbMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKeys=function(transaction,documentKeys){var _this=this,uniqueBatchIDs=new SortedSet(primitiveComparator),promises=[];return documentKeys.forEach(function(documentKey){var indexStart=DbDocumentMutation.prefixForPath(_this.userId,documentKey.path),range=IDBKeyRange.lowerBound(indexStart),promise=documentMutationsStore(transaction).iterate({range:range},function(indexKey,_,control){var userID=indexKey[0],encodedPath=indexKey[1],batchID=indexKey[2],path=decode$1(encodedPath);return userID===_this.userId&&documentKey.path.isEqual(path)?void(uniqueBatchIDs=uniqueBatchIDs.add(batchID)):void control.done()});promises.push(promise)}),PersistencePromise.waitFor(promises).next(function(){return _this.lookupMutationBatches(transaction,uniqueBatchIDs)})},IndexedDbMutationQueue.prototype.getAllMutationBatchesAffectingQuery=function(transaction,query){var _this=this;assert(!query.isDocumentQuery(),'Document queries shouldn\'t go down this path');var queryPath=query.path,immediateChildrenLength=queryPath.length+1,indexPrefix=DbDocumentMutation.prefixForPath(this.userId,queryPath),indexStart=IDBKeyRange.lowerBound(indexPrefix),uniqueBatchIDs=new SortedSet(primitiveComparator);return documentMutationsStore(transaction).iterate({range:indexStart},function(indexKey,_,control){var userID=indexKey[0],encodedPath=indexKey[1],batchID=indexKey[2],path=decode$1(encodedPath);return userID===_this.userId&&queryPath.isPrefixOf(path)?void(path.length!==immediateChildrenLength||(uniqueBatchIDs=uniqueBatchIDs.add(batchID))):void control.done()}).next(function(){return _this.lookupMutationBatches(transaction,uniqueBatchIDs)})},IndexedDbMutationQueue.prototype.lookupMutationBatches=function(transaction,batchIDs){var _this=this,results=[],promises=[];return batchIDs.forEach(function(batchId){promises.push(mutationsStore(transaction).get(batchId).next(function(mutation){if(null===mutation)throw fail('Dangling document-mutation reference found, '+'which points to '+batchId);assert(mutation.userId===_this.userId,'Unexpected user \''+mutation.userId+'\' for mutation batch '+batchId),results.push(_this.serializer.fromDbMutationBatch(mutation))}))}),PersistencePromise.waitFor(promises).next(function(){return results})},IndexedDbMutationQueue.prototype.removeMutationBatch=function(transaction,batch){var _this=this;return removeMutationBatch(transaction.simpleDbTransaction,this.userId,batch).next(function(removedDocuments){return _this.removeCachedMutationKeys(batch.batchId),PersistencePromise.forEach(removedDocuments,function(key){return _this.referenceDelegate.removeMutationReference(transaction,key)})})},IndexedDbMutationQueue.prototype.removeCachedMutationKeys=function(batchId){delete this.documentKeysByBatchId[batchId]},IndexedDbMutationQueue.prototype.performConsistencyCheck=function(txn){var _this=this;return this.checkEmpty(txn).next(function(empty){if(!empty)return PersistencePromise.resolve();var startRange=IDBKeyRange.lowerBound(DbDocumentMutation.prefixForUser(_this.userId)),danglingMutationReferences=[];return documentMutationsStore(txn).iterate({range:startRange},function(key,_,control){var userID=key[0];if(userID!==_this.userId)return void control.done();var path=decode$1(key[1]);danglingMutationReferences.push(path)}).next(function(){assert(0===danglingMutationReferences.length,'Document leak -- detected dangling mutation references when queue is empty. '+'Dangling keys: '+danglingMutationReferences.map(function(p){return p.canonicalString()}))})})},IndexedDbMutationQueue.prototype.containsKey=function(txn,key){return mutationQueueContainsKey(txn,this.userId,key)},IndexedDbMutationQueue.prototype.getMutationQueueMetadata=function(transaction){var _this=this;return mutationQueuesStore(transaction).get(this.userId).next(function(metadata){return metadata||new DbMutationQueue(_this.userId,BATCHID_UNKNOWN,'')})},IndexedDbMutationQueue}(),RESERVED_BITS=1,GeneratorIds;(function(GeneratorIds){GeneratorIds[GeneratorIds.QueryCache=0]='QueryCache',GeneratorIds[GeneratorIds.SyncEngine=1]='SyncEngine'})(GeneratorIds||(GeneratorIds={}));var TargetIdGenerator=function(){function TargetIdGenerator(generatorId,seed){this.generatorId=generatorId,assert((generatorId&RESERVED_BITS)===generatorId,'Generator ID '+generatorId+' contains more than '+RESERVED_BITS+' reserved bits'),this.seek(void 0===seed?this.generatorId:seed)}return TargetIdGenerator.prototype.next=function(){var nextId=this.nextId;return this.nextId+=1<<RESERVED_BITS,nextId},TargetIdGenerator.prototype.after=function(targetId){return this.seek(targetId+(1<<RESERVED_BITS)),this.next()},TargetIdGenerator.prototype.seek=function(targetId){assert((targetId&RESERVED_BITS)===this.generatorId,'Cannot supply target ID from different generator ID'),this.nextId=targetId},TargetIdGenerator.forQueryCache=function(){var targetIdGenerator=new TargetIdGenerator(GeneratorIds.QueryCache,2);return targetIdGenerator},TargetIdGenerator.forSyncEngine=function(){return new TargetIdGenerator(GeneratorIds.SyncEngine)},TargetIdGenerator}(),IndexedDbQueryCache=function(){function IndexedDbQueryCache(referenceDelegate,serializer){this.referenceDelegate=referenceDelegate,this.serializer=serializer,this.targetIdGenerator=TargetIdGenerator.forQueryCache()}return IndexedDbQueryCache.prototype.allocateTargetId=function(transaction){var _this=this;return this.retrieveMetadata(transaction).next(function(metadata){return metadata.highestTargetId=_this.targetIdGenerator.after(metadata.highestTargetId),_this.saveMetadata(transaction,metadata).next(function(){return metadata.highestTargetId})})},IndexedDbQueryCache.prototype.getLastRemoteSnapshotVersion=function(transaction){return this.retrieveMetadata(transaction).next(function(metadata){return SnapshotVersion.fromTimestamp(new Timestamp(metadata.lastRemoteSnapshotVersion.seconds,metadata.lastRemoteSnapshotVersion.nanoseconds))})},IndexedDbQueryCache.prototype.getHighestSequenceNumber=function(transaction){return getHighestListenSequenceNumber(transaction.simpleDbTransaction)},IndexedDbQueryCache.prototype.setTargetsMetadata=function(transaction,highestListenSequenceNumber,lastRemoteSnapshotVersion){var _this=this;return this.retrieveMetadata(transaction).next(function(metadata){return metadata.highestListenSequenceNumber=highestListenSequenceNumber,lastRemoteSnapshotVersion&&(metadata.lastRemoteSnapshotVersion=lastRemoteSnapshotVersion.toTimestamp()),highestListenSequenceNumber>metadata.highestListenSequenceNumber&&(metadata.highestListenSequenceNumber=highestListenSequenceNumber),_this.saveMetadata(transaction,metadata)})},IndexedDbQueryCache.prototype.addQueryData=function(transaction,queryData){var _this=this;return this.saveQueryData(transaction,queryData).next(function(){return _this.retrieveMetadata(transaction).next(function(metadata){return metadata.targetCount+=1,_this.updateMetadataFromQueryData(queryData,metadata),_this.saveMetadata(transaction,metadata)})})},IndexedDbQueryCache.prototype.updateQueryData=function(transaction,queryData){return this.saveQueryData(transaction,queryData)},IndexedDbQueryCache.prototype.removeQueryData=function(transaction,queryData){var _this=this;return this.removeMatchingKeysForTargetId(transaction,queryData.targetId).next(function(){return targetsStore(transaction).delete(queryData.targetId)}).next(function(){return _this.retrieveMetadata(transaction)}).next(function(metadata){return assert(0<metadata.targetCount,'Removing from an empty query cache'),metadata.targetCount-=1,_this.saveMetadata(transaction,metadata)})},IndexedDbQueryCache.prototype.removeTargets=function(txn,upperBound,activeTargetIds){var _this=this,count=0,promises=[];return targetsStore(txn).iterate(function(key,value){var queryData=_this.serializer.fromDbTarget(value);queryData.sequenceNumber<=upperBound&&void 0===activeTargetIds[queryData.targetId]&&(count++,promises.push(_this.removeQueryData(txn,queryData)))}).next(function(){return PersistencePromise.waitFor(promises)}).next(function(){return count})},IndexedDbQueryCache.prototype.forEachTarget=function(txn,f){var _this=this;return targetsStore(txn).iterate(function(key,value){var queryData=_this.serializer.fromDbTarget(value);f(queryData)})},IndexedDbQueryCache.prototype.retrieveMetadata=function(transaction){return retrieveMetadata(transaction.simpleDbTransaction)},IndexedDbQueryCache.prototype.saveMetadata=function(transaction,metadata){return globalTargetStore(transaction).put(DbTargetGlobal.key,metadata)},IndexedDbQueryCache.prototype.saveQueryData=function(transaction,queryData){return targetsStore(transaction).put(this.serializer.toDbTarget(queryData))},IndexedDbQueryCache.prototype.updateMetadataFromQueryData=function(queryData,metadata){var updated=!1;return queryData.targetId>metadata.highestTargetId&&(metadata.highestTargetId=queryData.targetId,updated=!0),queryData.sequenceNumber>metadata.highestListenSequenceNumber&&(metadata.highestListenSequenceNumber=queryData.sequenceNumber,updated=!0),updated},IndexedDbQueryCache.prototype.getQueryCount=function(transaction){return this.retrieveMetadata(transaction).next(function(metadata){return metadata.targetCount})},IndexedDbQueryCache.prototype.getQueryData=function(transaction,query){var _this=this,canonicalId=query.canonicalId(),range=IDBKeyRange.bound([canonicalId,_NumberNEGATIVE_INFINITY],[canonicalId,_NumberPOSITIVE_INFINITY]),result=null;return targetsStore(transaction).iterate({range:range,index:DbTarget.queryTargetsIndexName},function(key,value,control){var found=_this.serializer.fromDbTarget(value);query.isEqual(found.query)&&(result=found,control.done())}).next(function(){return result})},IndexedDbQueryCache.prototype.addMatchingKeys=function(txn,keys,targetId){var _this=this,promises=[],store=documentTargetStore(txn);return keys.forEach(function(key){var path=encode(key.path);promises.push(store.put(new DbTargetDocument(targetId,path))),promises.push(_this.referenceDelegate.addReference(txn,key))}),PersistencePromise.waitFor(promises)},IndexedDbQueryCache.prototype.removeMatchingKeys=function(txn,keys,targetId){var _this=this,store=documentTargetStore(txn);return PersistencePromise.forEach(keys,function(key){var path=encode(key.path);return PersistencePromise.waitFor([store.delete([targetId,path]),_this.referenceDelegate.removeReference(txn,key)])})},IndexedDbQueryCache.prototype.removeMatchingKeysForTargetId=function(txn,targetId){var store=documentTargetStore(txn),range=IDBKeyRange.bound([targetId],[targetId+1],!1,!0);return store.delete(range)},IndexedDbQueryCache.prototype.getMatchingKeysForTargetId=function(txn,targetId){var range=IDBKeyRange.bound([targetId],[targetId+1],!1,!0),store=documentTargetStore(txn),result=documentKeySet();return store.iterate({range:range,keysOnly:!0},function(key){var path=decode$1(key[1]),docKey=new DocumentKey(path);result=result.add(docKey)}).next(function(){return result})},IndexedDbQueryCache.prototype.containsKey=function(txn,key){var path=encode(key.path),range=IDBKeyRange.bound([path],[immediateSuccessor(path)],!1,!0),count=0;return documentTargetStore(txn).iterate({index:DbTargetDocument.documentTargetsIndex,keysOnly:!0,range:range},function(_a,_,control){var targetId=_a[0],path=_a[1];0!==targetId&&(count++,control.done())}).next(function(){return 0<count})},IndexedDbQueryCache.prototype.getQueryDataForTarget=function(transaction,targetId){var _this=this;return targetsStore(transaction).get(targetId).next(function(found){return found?_this.serializer.fromDbTarget(found):null})},IndexedDbQueryCache}(),LocalSerializer=function(){function LocalSerializer(remoteSerializer){this.remoteSerializer=remoteSerializer}return LocalSerializer.prototype.fromDbRemoteDocument=function(remoteDoc){if(remoteDoc.document)return this.remoteSerializer.fromDocument(remoteDoc.document,!!remoteDoc.hasCommittedMutations);if(remoteDoc.noDocument){var key=DocumentKey.fromSegments(remoteDoc.noDocument.path),version=this.fromDbTimestamp(remoteDoc.noDocument.readTime);return new NoDocument(key,version,{hasCommittedMutations:!!remoteDoc.hasCommittedMutations})}if(remoteDoc.unknownDocument){var key=DocumentKey.fromSegments(remoteDoc.unknownDocument.path),version=this.fromDbTimestamp(remoteDoc.unknownDocument.version);return new UnknownDocument(key,version)}return fail('Unexpected DbRemoteDocument')},LocalSerializer.prototype.toDbRemoteDocument=function(maybeDoc){if(maybeDoc instanceof Document){var doc=this.remoteSerializer.toDocument(maybeDoc),hasCommittedMutations=maybeDoc.hasCommittedMutations;return new DbRemoteDocument(null,null,doc,hasCommittedMutations)}if(maybeDoc instanceof NoDocument){var path=maybeDoc.key.path.toArray(),readTime=this.toDbTimestamp(maybeDoc.version),hasCommittedMutations=maybeDoc.hasCommittedMutations;return new DbRemoteDocument(null,new DbNoDocument(path,readTime),null,hasCommittedMutations)}if(maybeDoc instanceof UnknownDocument){var path=maybeDoc.key.path.toArray(),readTime=this.toDbTimestamp(maybeDoc.version);return new DbRemoteDocument(new DbUnknownDocument(path,readTime),null,null,!0)}return fail('Unexpected MaybeDocumment')},LocalSerializer.prototype.toDbTimestamp=function(snapshotVersion){var timestamp=snapshotVersion.toTimestamp();return new DbTimestamp(timestamp.seconds,timestamp.nanoseconds)},LocalSerializer.prototype.fromDbTimestamp=function(dbTimestamp){var timestamp=new Timestamp(dbTimestamp.seconds,dbTimestamp.nanoseconds);return SnapshotVersion.fromTimestamp(timestamp)},LocalSerializer.prototype.toDbMutationBatch=function(userId,batch){var _this=this,serializedMutations=batch.mutations.map(function(m){return _this.remoteSerializer.toMutation(m)});return new DbMutationBatch(userId,batch.batchId,batch.localWriteTime.toMillis(),serializedMutations)},LocalSerializer.prototype.fromDbMutationBatch=function(dbBatch){var _this=this,mutations=dbBatch.mutations.map(function(m){return _this.remoteSerializer.fromMutation(m)}),timestamp=Timestamp.fromMillis(dbBatch.localWriteTimeMs);return new MutationBatch(dbBatch.batchId,timestamp,mutations)},LocalSerializer.prototype.toDbResourcePaths=function(keys){var encodedKeys=[];return keys.forEach(function(key){encodedKeys.push(encode(key.path))}),encodedKeys},LocalSerializer.prototype.fromDbResourcePaths=function(encodedPaths){for(var keys=documentKeySet(),_i=0,encodedPaths_1=encodedPaths,documentKey;_i<encodedPaths_1.length;_i++)documentKey=encodedPaths_1[_i],keys=keys.add(new DocumentKey(decode$1(documentKey)));return keys},LocalSerializer.prototype.fromDbTarget=function(dbTarget){var version=this.fromDbTimestamp(dbTarget.readTime),query;return query=isDocumentQuery(dbTarget.query)?this.remoteSerializer.fromDocumentsTarget(dbTarget.query):this.remoteSerializer.fromQueryTarget(dbTarget.query),new QueryData(query,dbTarget.targetId,QueryPurpose.Listen,dbTarget.lastListenSequenceNumber,version,dbTarget.resumeToken)},LocalSerializer.prototype.toDbTarget=function(queryData){assert(QueryPurpose.Listen===queryData.purpose,'Only queries with purpose '+QueryPurpose.Listen+' may be stored, got '+queryData.purpose);var dbTimestamp=this.toDbTimestamp(queryData.snapshotVersion),queryProto;queryProto=queryData.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(queryData.query):this.remoteSerializer.toQueryTarget(queryData.query);var resumeToken;return queryData.resumeToken instanceof Uint8Array?(assert('YES'===process.env.USE_MOCK_PERSISTENCE,'Persisting non-string stream tokens is only supported with mock persistence .'),resumeToken=queryData.resumeToken.toString()):resumeToken=queryData.resumeToken,new DbTarget(queryData.targetId,queryData.query.canonicalId(),dbTimestamp,resumeToken,queryData.sequenceNumber,queryProto)},LocalSerializer}(),RollingSequenceNumberBuffer=function(){function RollingSequenceNumberBuffer(maxElements){this.maxElements=maxElements,this.buffer=new SortedSet(bufferEntryComparator),this.previousIndex=0}return RollingSequenceNumberBuffer.prototype.nextIndex=function(){return++this.previousIndex},RollingSequenceNumberBuffer.prototype.addElement=function(sequenceNumber){var entry=[sequenceNumber,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(entry);else{var highestValue=this.buffer.last();0>bufferEntryComparator(entry,highestValue)&&(this.buffer=this.buffer.delete(highestValue).add(entry))}},Object.defineProperty(RollingSequenceNumberBuffer.prototype,'maxValue',{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),RollingSequenceNumberBuffer}(),LruGarbageCollector=function(){function LruGarbageCollector(delegate){this.delegate=delegate}return LruGarbageCollector.prototype.calculateTargetCount=function(txn,percentile){return this.delegate.getTargetCount(txn).next(function(targetCount){return _Mathfloor(percentile/100*targetCount)})},LruGarbageCollector.prototype.nthSequenceNumber=function(txn,n){var _this=this;if(0===n)return PersistencePromise.resolve(ListenSequence.INVALID);var buffer=new RollingSequenceNumberBuffer(n);return this.delegate.forEachTarget(txn,function(target){return buffer.addElement(target.sequenceNumber)}).next(function(){return _this.delegate.forEachOrphanedDocumentSequenceNumber(txn,function(sequenceNumber){return buffer.addElement(sequenceNumber)})}).next(function(){return buffer.maxValue})},LruGarbageCollector.prototype.removeTargets=function(txn,upperBound,activeTargetIds){return this.delegate.removeTargets(txn,upperBound,activeTargetIds)},LruGarbageCollector.prototype.removeOrphanedDocuments=function(txn,upperBound){return this.delegate.removeOrphanedDocuments(txn,upperBound)},LruGarbageCollector}(),PersistenceTransaction=function(){return function PersistenceTransaction(){}}(),LOG_TAG$2='IndexedDbPersistence',MAX_CLIENT_AGE_MS=1e3*(60*30),MAX_PRIMARY_ELIGIBLE_AGE_MS=5e3,PRIMARY_LEASE_LOST_ERROR_MSG='The current tab is not in the required state to perform this operation. '+'It might be necessary to refresh the browser tab.',PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG='Another tab has exclusive access to the persistence layer. '+'To allow shared access, make sure to invoke '+'`enablePersistence()` with `experimentalTabSynchronization:true` in all tabs.',IndexedDbTransaction=function(_super){function IndexedDbTransaction(simpleDbTransaction,currentSequenceNumber){var _this=_super.call(this)||this;return _this.simpleDbTransaction=simpleDbTransaction,_this.currentSequenceNumber=currentSequenceNumber,_this}return tslib_1.__extends(IndexedDbTransaction,_super),IndexedDbTransaction}(PersistenceTransaction),IndexedDbPersistence=function(){function IndexedDbPersistence(persistenceKey,clientId,platform,queue,serializer,multiClientParams){if(this.persistenceKey=persistenceKey,this.clientId=clientId,this.queue=queue,this.multiClientParams=multiClientParams,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=_NumberNEGATIVE_INFINITY,this.primaryStateListener=function(){return Promise.resolve()},!IndexedDbPersistence.isAvailable())throw new FirestoreError(Code.UNIMPLEMENTED,'This platform is either missing'+' IndexedDB or is known to have an incomplete implementation. Offline'+' persistence has been disabled.');if(this.referenceDelegate=new IndexedDbLruDelegate(this),this.dbName=persistenceKey+IndexedDbPersistence.MAIN_DATABASE,this.serializer=new LocalSerializer(serializer),this.document=platform.document,this.allowTabSynchronization=void 0!==multiClientParams,this.queryCache=new IndexedDbQueryCache(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new IndexedDbRemoteDocumentCache(this.serializer,this.allowTabSynchronization),platform.window&&platform.window.localStorage)this.window=platform.window,this.webStorage=this.window.localStorage;else throw new FirestoreError(Code.UNIMPLEMENTED,'IndexedDB persistence is only available on platforms that support LocalStorage.')}return IndexedDbPersistence.getStore=function(txn,store){if(txn instanceof IndexedDbTransaction)return SimpleDb.getStore(txn.simpleDbTransaction,store);throw fail('IndexedDbPersistence must use instances of IndexedDbTransaction')},IndexedDbPersistence.createIndexedDbPersistence=function(persistenceKey,clientId,platform,queue,serializer){return tslib_1.__awaiter(this,void 0,void 0,function(){var persistence;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return persistence=new IndexedDbPersistence(persistenceKey,clientId,platform,queue,serializer),[4,persistence.start()];case 1:return _a.sent(),[2,persistence];}})})},IndexedDbPersistence.createMultiClientIndexedDbPersistence=function(persistenceKey,clientId,platform,queue,serializer,multiClientParams){return tslib_1.__awaiter(this,void 0,void 0,function(){var persistence;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return persistence=new IndexedDbPersistence(persistenceKey,clientId,platform,queue,serializer,multiClientParams),[4,persistence.start()];case 1:return _a.sent(),[2,persistence];}})})},IndexedDbPersistence.prototype.start=function(){var _this=this;return assert(!this.started,'IndexedDbPersistence double-started!'),assert(null!==this.window,'Expected \'window\' to be defined'),SimpleDb.openOrCreate(this.dbName,SCHEMA_VERSION,new SchemaConverter(this.serializer)).then(function(db){_this.simpleDb=db}).then(function(){return _this.startRemoteDocumentCache()}).then(function(){return _this.attachVisibilityHandler(),_this.attachWindowUnloadHook(),_this.updateClientMetadataAndTryBecomePrimary().then(function(){return _this.scheduleClientMetadataAndPrimaryLeaseRefreshes()})}).then(function(){return _this.simpleDb.runTransaction('readonly',[DbTargetGlobal.store],function(txn){return getHighestListenSequenceNumber(txn).next(function(highestListenSequenceNumber){var sequenceNumberSyncer=_this.multiClientParams?_this.multiClientParams.sequenceNumberSyncer:void 0;_this.listenSequence=new ListenSequence(highestListenSequenceNumber,sequenceNumberSyncer)})})}).then(function(){_this._started=!0}).catch(function(reason){return _this.simpleDb&&_this.simpleDb.close(),Promise.reject(reason)})},IndexedDbPersistence.prototype.startRemoteDocumentCache=function(){var _this=this;return this.simpleDb.runTransaction('readonly',ALL_STORES,function(txn){return _this.remoteDocumentCache.start(txn)})},IndexedDbPersistence.prototype.setPrimaryStateListener=function(primaryStateListener){var _this=this;return this.primaryStateListener=function(primaryState){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.started?[2,primaryStateListener(primaryState)]:[2]})})},primaryStateListener(this.isPrimary)},IndexedDbPersistence.prototype.setNetworkEnabled=function(networkEnabled){var _this=this;this.networkEnabled!==networkEnabled&&(this.networkEnabled=networkEnabled,this.queue.enqueueAndForget(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2];}})})}))},IndexedDbPersistence.prototype.updateClientMetadataAndTryBecomePrimary=function(){var _this=this;return this.simpleDb.runTransaction('readwrite',ALL_STORES,function(txn){var metadataStore=clientMetadataStore(txn);return metadataStore.put(new DbClientMetadata(_this.clientId,Date.now(),_this.networkEnabled,_this.inForeground,_this.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(_this.isPrimary)return _this.verifyPrimaryLease(txn).next(function(success){success||(_this.isPrimary=!1,_this.queue.enqueueAndForget(function(){return _this.primaryStateListener(!1)}))})}).next(function(){return _this.canActAsPrimary(txn)}).next(function(canActAsPrimary){var wasPrimary=_this.isPrimary;return(_this.isPrimary=canActAsPrimary,wasPrimary!==_this.isPrimary&&_this.queue.enqueueAndForget(function(){return _this.primaryStateListener(_this.isPrimary)}),wasPrimary&&!_this.isPrimary)?_this.releasePrimaryLeaseIfHeld(txn):_this.isPrimary?_this.acquireOrExtendPrimaryLease(txn):void 0})})},IndexedDbPersistence.prototype.verifyPrimaryLease=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(primaryClient){return PersistencePromise.resolve(_this.isLocalClient(primaryClient))})},IndexedDbPersistence.prototype.removeClientMetadata=function(txn){var metadataStore=clientMetadataStore(txn);return metadataStore.delete(this.clientId)},IndexedDbPersistence.prototype.maybeGarbageCollectMultiClientState=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,activeClients_1,inactiveClients_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,MAX_CLIENT_AGE_MS)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),inactiveClients_1=[],[4,this.runTransaction('maybeGarbageCollectMultiClientState','readwrite-primary',function(txn){var metadataStore=IndexedDbPersistence.getStore(txn,DbClientMetadata.store);return metadataStore.loadAll().next(function(existingClients){activeClients_1=_this.filterActiveClients(existingClients,MAX_CLIENT_AGE_MS),inactiveClients_1=existingClients.filter(function(client){return-1===activeClients_1.indexOf(client)})}).next(function(){return PersistencePromise.forEach(inactiveClients_1,function(inactiveClient){return metadataStore.delete(inactiveClient.clientId)})}).next(function(){if(activeClients_1=activeClients_1.filter(function(client){return client.clientId!==_this.clientId}),0<activeClients_1.length){var processedChangeIds=activeClients_1.map(function(client){return client.lastProcessedDocumentChangeId||0}),oldestChangeId=_Mathmin.apply(Math,processedChangeIds);return _this.remoteDocumentCache.removeDocumentChangesThroughChangeId(txn,oldestChangeId)}})})]);case 1:_a.sent(),inactiveClients_1.forEach(function(inactiveClient){_this.window.localStorage.removeItem(_this.zombiedClientLocalStorageKey(inactiveClient.clientId))}),_a.label=2;case 2:return[2];}})})},IndexedDbPersistence.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var _this=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(TimerId.ClientMetadataRefresh,4e3,function(){return _this.updateClientMetadataAndTryBecomePrimary().then(function(){return _this.maybeGarbageCollectMultiClientState()}).then(function(){return _this.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},IndexedDbPersistence.prototype.isLocalClient=function(client){return!!client&&client.ownerId===this.clientId},IndexedDbPersistence.prototype.canActAsPrimary=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(currentPrimary){var currentLeaseIsValid=null!==currentPrimary&&_this.isWithinAge(currentPrimary.leaseTimestampMs,MAX_PRIMARY_ELIGIBLE_AGE_MS)&&!_this.isClientZombied(currentPrimary.ownerId);if(currentLeaseIsValid){if(_this.isLocalClient(currentPrimary)&&_this.networkEnabled)return!0;if(!_this.isLocalClient(currentPrimary)){if(!currentPrimary.allowTabSynchronization)throw new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG);return!1}}return _this.networkEnabled&&_this.inForeground||clientMetadataStore(txn).loadAll().next(function(existingClients){var preferredCandidate=_this.filterActiveClients(existingClients,MAX_PRIMARY_ELIGIBLE_AGE_MS).find(function(otherClient){if(_this.clientId!==otherClient.clientId){var otherClientHasBetterNetworkState=!_this.networkEnabled&&otherClient.networkEnabled,otherClientHasBetterVisibility=!_this.inForeground&&otherClient.inForeground,otherClientHasSameNetworkState=_this.networkEnabled===otherClient.networkEnabled;if(otherClientHasBetterNetworkState||otherClientHasBetterVisibility&&otherClientHasSameNetworkState)return!0}return!1});return void 0===preferredCandidate})}).next(function(canActAsPrimary){return _this.isPrimary!==canActAsPrimary&&debug(LOG_TAG$2,'Client '+(canActAsPrimary?'is':'is not')+' eligible for a primary lease.'),canActAsPrimary})},IndexedDbPersistence.prototype.shutdown=function(deleteData){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction('readwrite',[DbPrimaryClient.store,DbClientMetadata.store],function(txn){return _this.releasePrimaryLeaseIfHeld(txn).next(function(){return _this.removeClientMetadata(txn)})})];case 1:return _a.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),deleteData?[4,SimpleDb.delete(this.dbName)]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2];}})})},IndexedDbPersistence.prototype.filterActiveClients=function(clients,activityThresholdMs){var _this=this;return clients.filter(function(client){return _this.isWithinAge(client.updateTimeMs,activityThresholdMs)&&!_this.isClientZombied(client.clientId)})},IndexedDbPersistence.prototype.getActiveClients=function(){var _this=this;return this.simpleDb.runTransaction('readonly',[DbClientMetadata.store],function(txn){return clientMetadataStore(txn).loadAll().next(function(clients){return _this.filterActiveClients(clients,MAX_CLIENT_AGE_MS).map(function(clientMetadata){return clientMetadata.clientId})})})},Object.defineProperty(IndexedDbPersistence.prototype,'started',{get:function(){return this._started},enumerable:!0,configurable:!0}),IndexedDbPersistence.prototype.getMutationQueue=function(user){return assert(this.started,'Cannot initialize MutationQueue before persistence is started.'),IndexedDbMutationQueue.forUser(user,this.serializer,this.referenceDelegate)},IndexedDbPersistence.prototype.getQueryCache=function(){return assert(this.started,'Cannot initialize QueryCache before persistence is started.'),this.queryCache},IndexedDbPersistence.prototype.getRemoteDocumentCache=function(){return assert(this.started,'Cannot initialize RemoteDocumentCache before persistence is started.'),this.remoteDocumentCache},IndexedDbPersistence.prototype.runTransaction=function(action,mode,transactionOperation){var _this=this;return debug(LOG_TAG$2,'Starting transaction:',action),this.simpleDb.runTransaction('readonly'===mode?'readonly':'readwrite',ALL_STORES,function(simpleDbTxn){return'readwrite-primary'===mode?_this.verifyPrimaryLease(simpleDbTxn).next(function(success){if(!success)throw error('Failed to obtain primary lease for action \''+action+'\'.'),_this.isPrimary=!1,_this.queue.enqueueAndForget(function(){return _this.primaryStateListener(!1)}),new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_LOST_ERROR_MSG);return transactionOperation(new IndexedDbTransaction(simpleDbTxn,_this.listenSequence.next()))}).next(function(result){return _this.acquireOrExtendPrimaryLease(simpleDbTxn).next(function(){return result})}):_this.verifyAllowTabSynchronization(simpleDbTxn).next(function(){return transactionOperation(new IndexedDbTransaction(simpleDbTxn,_this.listenSequence.next()))})})},IndexedDbPersistence.prototype.verifyAllowTabSynchronization=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(currentPrimary){var currentLeaseIsValid=null!==currentPrimary&&_this.isWithinAge(currentPrimary.leaseTimestampMs,MAX_PRIMARY_ELIGIBLE_AGE_MS)&&!_this.isClientZombied(currentPrimary.ownerId);if(currentLeaseIsValid&&!_this.isLocalClient(currentPrimary)&&!currentPrimary.allowTabSynchronization)throw new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG)})},IndexedDbPersistence.prototype.acquireOrExtendPrimaryLease=function(txn){var newPrimary=new DbPrimaryClient(this.clientId,this.allowTabSynchronization,Date.now());return primaryClientStore(txn).put(DbPrimaryClient.key,newPrimary)},IndexedDbPersistence.isAvailable=function(){return SimpleDb.isAvailable()},IndexedDbPersistence.buildStoragePrefix=function(databaseInfo){var database=databaseInfo.databaseId.projectId;return databaseInfo.databaseId.isDefaultDatabase||(database+='.'+databaseInfo.databaseId.database),'firestore/'+databaseInfo.persistenceKey+'/'+database+'/'},IndexedDbPersistence.prototype.releasePrimaryLeaseIfHeld=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(primaryClient){return _this.isLocalClient(primaryClient)?(debug(LOG_TAG$2,'Releasing primary lease.'),store.delete(DbPrimaryClient.key)):PersistencePromise.resolve()})},IndexedDbPersistence.prototype.isWithinAge=function(updateTimeMs,maxAgeMs){var now=Date.now(),maxAcceptable=now;return!(updateTimeMs<now-maxAgeMs)&&(!(updateTimeMs>maxAcceptable)||(error('Detected an update time that is in the future: '+updateTimeMs+' > '+maxAcceptable),!1))},IndexedDbPersistence.prototype.attachVisibilityHandler=function(){var _this=this;null!==this.document&&'function'==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){_this.queue.enqueueAndForget(function(){return _this.inForeground='visible'===_this.document.visibilityState,_this.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener('visibilitychange',this.documentVisibilityHandler),this.inForeground='visible'===this.document.visibilityState)},IndexedDbPersistence.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(assert(null!==this.document&&'function'==typeof this.document.addEventListener,'Expected \'document.addEventListener\' to be a function'),this.document.removeEventListener('visibilitychange',this.documentVisibilityHandler),this.documentVisibilityHandler=null)},IndexedDbPersistence.prototype.attachWindowUnloadHook=function(){var _this=this;'function'==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){_this.markClientZombied(),_this.queue.enqueueAndForget(function(){return _this.shutdown()})},this.window.addEventListener('unload',this.windowUnloadHandler))},IndexedDbPersistence.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(assert('function'==typeof this.window.removeEventListener,'Expected \'window.removeEventListener\' to be a function'),this.window.removeEventListener('unload',this.windowUnloadHandler),this.windowUnloadHandler=null)},IndexedDbPersistence.prototype.isClientZombied=function(clientId){try{var isZombied=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(clientId));return debug(LOG_TAG$2,'Client \''+clientId+'\' '+(isZombied?'is':'is not')+' zombied in LocalStorage'),isZombied}catch(e){return error(LOG_TAG$2,'Failed to get zombied client id.',e),!1}},IndexedDbPersistence.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),Date.now()+'')}catch(e){error('Failed to set zombie client id.',e)}},IndexedDbPersistence.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},IndexedDbPersistence.prototype.zombiedClientLocalStorageKey=function(clientId){return'firestore_zombie'+'_'+this.persistenceKey+'_'+clientId},IndexedDbPersistence.MAIN_DATABASE='main',IndexedDbPersistence}(),IndexedDbLruDelegate=function(){function IndexedDbLruDelegate(db){this.db=db,this.garbageCollector=new LruGarbageCollector(this)}return IndexedDbLruDelegate.prototype.getTargetCount=function(txn){return this.db.getQueryCache().getQueryCount(txn)},IndexedDbLruDelegate.prototype.forEachTarget=function(txn,f){return this.db.getQueryCache().forEachTarget(txn,f)},IndexedDbLruDelegate.prototype.forEachOrphanedDocumentSequenceNumber=function(txn,f){return this.forEachOrphanedDocument(txn,function(docKey,sequenceNumber){return f(sequenceNumber)})},IndexedDbLruDelegate.prototype.setInMemoryPins=function(inMemoryPins){this.inMemoryPins=inMemoryPins},IndexedDbLruDelegate.prototype.addReference=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.removeReference=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.removeTargets=function(txn,upperBound,activeTargetIds){return this.db.getQueryCache().removeTargets(txn,upperBound,activeTargetIds)},IndexedDbLruDelegate.prototype.removeMutationReference=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.isPinned=function(txn,docKey){return this.inMemoryPins.containsKey(docKey)?PersistencePromise.resolve(!0):mutationQueuesContainKey(txn,docKey)},IndexedDbLruDelegate.prototype.removeOrphanedDocuments=function(txn,upperBound){var _this=this,count=0,bytesRemoved=0,promises=[],iteration=this.forEachOrphanedDocument(txn,function(docKey,sequenceNumber){if(sequenceNumber<=upperBound){var p=_this.isPinned(txn,docKey).next(function(isPinned){if(!isPinned)return count++,_this.removeOrphanedDocument(txn,docKey).next(function(documentBytes){bytesRemoved+=documentBytes})});promises.push(p)}});return iteration.next(function(){return PersistencePromise.waitFor(promises)}).next(function(){return _this.db.getRemoteDocumentCache().updateSize(txn,-bytesRemoved)}).next(function(){return count})},IndexedDbLruDelegate.prototype.removeOrphanedDocument=function(txn,docKey){var totalBytesRemoved=0,documentCache=this.db.getRemoteDocumentCache();return PersistencePromise.waitFor([documentTargetStore(txn).delete(sentinelKey(docKey)),documentCache.removeEntry(txn,docKey).next(function(bytesRemoved){totalBytesRemoved+=bytesRemoved})]).next(function(){return totalBytesRemoved})},IndexedDbLruDelegate.prototype.removeTarget=function(txn,queryData){var updated=queryData.copy({sequenceNumber:txn.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(txn,updated)},IndexedDbLruDelegate.prototype.updateLimboDocument=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.forEachOrphanedDocument=function(txn,f){var store=documentTargetStore(txn),nextToReport=ListenSequence.INVALID,nextPath;return store.iterate({index:DbTargetDocument.documentTargetsIndex},function(_a,_b){var targetId=_a[0],docKey=_a[1],path=_b.path,sequenceNumber=_b.sequenceNumber;0===targetId?(nextToReport!==ListenSequence.INVALID&&f(new DocumentKey(decode$1(nextPath)),nextToReport),nextToReport=sequenceNumber,nextPath=path):nextToReport=ListenSequence.INVALID}).next(function(){nextToReport!==ListenSequence.INVALID&&f(new DocumentKey(decode$1(nextPath)),nextToReport)})},IndexedDbLruDelegate}(),LocalDocumentsView=function(){function LocalDocumentsView(remoteDocumentCache,mutationQueue){this.remoteDocumentCache=remoteDocumentCache,this.mutationQueue=mutationQueue}return LocalDocumentsView.prototype.getDocument=function(transaction,key){var _this=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(transaction,key).next(function(batches){return _this.getDocumentInternal(transaction,key,batches)})},LocalDocumentsView.prototype.getDocumentInternal=function(transaction,key,inBatches){return this.remoteDocumentCache.getEntry(transaction,key).next(function(doc){for(var _i=0,inBatches_1=inBatches,batch;_i<inBatches_1.length;_i++)batch=inBatches_1[_i],doc=batch.applyToLocalView(key,doc);return doc})},LocalDocumentsView.prototype.getDocuments=function(transaction,keys){var _this=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(transaction,keys).next(function(batches){var promises=[],results=maybeDocumentMap();return keys.forEach(function(key){promises.push(_this.getDocumentInternal(transaction,key,batches).next(function(maybeDoc){maybeDoc||(maybeDoc=new NoDocument(key,SnapshotVersion.forDeletedDoc())),results=results.insert(key,maybeDoc)}))}),PersistencePromise.waitFor(promises).next(function(){return results})})},LocalDocumentsView.prototype.getDocumentsMatchingQuery=function(transaction,query){return DocumentKey.isDocumentKey(query.path)?this.getDocumentsMatchingDocumentQuery(transaction,query.path):this.getDocumentsMatchingCollectionQuery(transaction,query)},LocalDocumentsView.prototype.getDocumentsMatchingDocumentQuery=function(transaction,docPath){return this.getDocument(transaction,new DocumentKey(docPath)).next(function(maybeDoc){var result=documentMap();return maybeDoc instanceof Document&&(result=result.insert(maybeDoc.key,maybeDoc)),result})},LocalDocumentsView.prototype.getDocumentsMatchingCollectionQuery=function(transaction,query){var _this=this,results;return this.remoteDocumentCache.getDocumentsMatchingQuery(transaction,query).next(function(queryResults){return results=queryResults,_this.mutationQueue.getAllMutationBatchesAffectingQuery(transaction,query)}).next(function(matchingMutationBatches){for(var _i=0,matchingMutationBatches_1=matchingMutationBatches,batch;_i<matchingMutationBatches_1.length;_i++){batch=matchingMutationBatches_1[_i];for(var _a=0,_b=batch.mutations;_a<_b.length;_a++){var mutation=_b[_a],key=mutation.key;if(query.path.isImmediateParentOf(key.path)){var baseDoc=results.get(key),mutatedDoc=mutation.applyToLocalView(baseDoc,baseDoc,batch.localWriteTime);results=mutatedDoc instanceof Document?results.insert(key,mutatedDoc):results.remove(key)}}}}).next(function(){return results.forEach(function(key,doc){query.matches(doc)||(results=results.remove(key))}),results})},LocalDocumentsView}(),ReferenceSet=function(){function ReferenceSet(){this.refsByKey=new SortedSet(DocReference.compareByKey),this.refsByTarget=new SortedSet(DocReference.compareByTargetId)}return ReferenceSet.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},ReferenceSet.prototype.addReference=function(key,id){var ref=new DocReference(key,id);this.refsByKey=this.refsByKey.add(ref),this.refsByTarget=this.refsByTarget.add(ref)},ReferenceSet.prototype.addReferences=function(keys,id){var _this=this;keys.forEach(function(key){return _this.addReference(key,id)})},ReferenceSet.prototype.removeReference=function(key,id){this.removeRef(new DocReference(key,id))},ReferenceSet.prototype.removeReferences=function(keys,id){var _this=this;keys.forEach(function(key){return _this.removeReference(key,id)})},ReferenceSet.prototype.removeReferencesForId=function(id){var _this=this,emptyKey=DocumentKey.EMPTY,startRef=new DocReference(emptyKey,id),endRef=new DocReference(emptyKey,id+1),keys=[];return this.refsByTarget.forEachInRange([startRef,endRef],function(ref){_this.removeRef(ref),keys.push(ref.key)}),keys},ReferenceSet.prototype.removeAllReferences=function(){var _this=this;this.refsByKey.forEach(function(ref){return _this.removeRef(ref)})},ReferenceSet.prototype.removeRef=function(ref){this.refsByKey=this.refsByKey.delete(ref),this.refsByTarget=this.refsByTarget.delete(ref)},ReferenceSet.prototype.referencesForId=function(id){var emptyKey=DocumentKey.EMPTY,startRef=new DocReference(emptyKey,id),endRef=new DocReference(emptyKey,id+1),keys=documentKeySet();return this.refsByTarget.forEachInRange([startRef,endRef],function(ref){keys=keys.add(ref.key)}),keys},ReferenceSet.prototype.containsKey=function(key){var ref=new DocReference(key,0),firstRef=this.refsByKey.firstAfterOrEqual(ref);return null!==firstRef&&key.isEqual(firstRef.key)},ReferenceSet}(),DocReference=function(){function DocReference(key,targetOrBatchId){this.key=key,this.targetOrBatchId=targetOrBatchId}return DocReference.compareByKey=function(left,right){return DocumentKey.comparator(left.key,right.key)||primitiveComparator(left.targetOrBatchId,right.targetOrBatchId)},DocReference.compareByTargetId=function(left,right){return primitiveComparator(left.targetOrBatchId,right.targetOrBatchId)||DocumentKey.comparator(left.key,right.key)},DocReference}(),LocalStore=function(){function LocalStore(persistence,initialUser){this.persistence=persistence,this.localViewReferences=new ReferenceSet,this.queryDataByTarget={},assert(persistence.started,'LocalStore was passed an unstarted persistence implementation'),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=persistence.getMutationQueue(initialUser),this.remoteDocuments=persistence.getRemoteDocumentCache(),this.queryCache=persistence.getQueryCache(),this.localDocuments=new LocalDocumentsView(this.remoteDocuments,this.mutationQueue)}return LocalStore.prototype.handleUserChange=function(user){var _this=this;return this.persistence.runTransaction('Handle user change','readonly',function(txn){var oldBatches;return _this.mutationQueue.getAllMutationBatches(txn).next(function(promisedOldBatches){return oldBatches=promisedOldBatches,_this.mutationQueue=_this.persistence.getMutationQueue(user),_this.localDocuments=new LocalDocumentsView(_this.remoteDocuments,_this.mutationQueue),_this.mutationQueue.getAllMutationBatches(txn)}).next(function(newBatches){for(var removedBatchIds=[],addedBatchIds=[],changedKeys=documentKeySet(),_i=0,oldBatches_1=oldBatches,batch;_i<oldBatches_1.length;_i++){batch=oldBatches_1[_i],removedBatchIds.push(batch.batchId);for(var _a=0,_b=batch.mutations,mutation;_a<_b.length;_a++)mutation=_b[_a],changedKeys=changedKeys.add(mutation.key)}for(var _c=0,newBatches_1=newBatches,batch;_c<newBatches_1.length;_c++){batch=newBatches_1[_c],addedBatchIds.push(batch.batchId);for(var _d=0,_e=batch.mutations,mutation;_d<_e.length;_d++)mutation=_e[_d],changedKeys=changedKeys.add(mutation.key)}return _this.localDocuments.getDocuments(txn,changedKeys).next(function(affectedDocuments){return{affectedDocuments:affectedDocuments,removedBatchIds:removedBatchIds,addedBatchIds:addedBatchIds}})})})},LocalStore.prototype.localWrite=function(mutations){var _this=this;return this.persistence.runTransaction('Locally write mutations','readwrite',function(txn){var localWriteTime=Timestamp.now(),batch;return _this.mutationQueue.addMutationBatch(txn,localWriteTime,mutations).next(function(promisedBatch){batch=promisedBatch;var keys=batch.keys();return _this.localDocuments.getDocuments(txn,keys)}).next(function(changedDocuments){return{batchId:batch.batchId,changes:changedDocuments}})})},LocalStore.prototype.lookupMutationDocuments=function(batchId){var _this=this;return this.persistence.runTransaction('Lookup mutation documents','readonly',function(txn){return _this.mutationQueue.lookupMutationKeys(txn,batchId).next(function(keys){return keys?_this.localDocuments.getDocuments(txn,keys):PersistencePromise.resolve(null)})})},LocalStore.prototype.acknowledgeBatch=function(batchResult){var _this=this;return this.persistence.runTransaction('Acknowledge batch','readwrite-primary',function(txn){var affected=batchResult.batch.keys(),documentBuffer=_this.remoteDocuments.newChangeBuffer();return _this.mutationQueue.acknowledgeBatch(txn,batchResult.batch,batchResult.streamToken).next(function(){return _this.applyWriteToRemoteDocuments(txn,batchResult,documentBuffer)}).next(function(){return documentBuffer.apply(txn)}).next(function(){return _this.mutationQueue.performConsistencyCheck(txn)}).next(function(){return _this.localDocuments.getDocuments(txn,affected)})})},LocalStore.prototype.rejectBatch=function(batchId){var _this=this;return this.persistence.runTransaction('Reject batch','readwrite-primary',function(txn){var affectedKeys;return _this.mutationQueue.lookupMutationBatch(txn,batchId).next(function(batch){return assert(null!==batch,'Attempt to reject nonexistent batch!'),affectedKeys=batch.keys(),_this.mutationQueue.removeMutationBatch(txn,batch)}).next(function(){return _this.mutationQueue.performConsistencyCheck(txn)}).next(function(){return _this.localDocuments.getDocuments(txn,affectedKeys)})})},LocalStore.prototype.getLastStreamToken=function(){var _this=this;return this.persistence.runTransaction('Get last stream token','readonly',function(txn){return _this.mutationQueue.getLastStreamToken(txn)})},LocalStore.prototype.setLastStreamToken=function(streamToken){var _this=this;return this.persistence.runTransaction('Set last stream token','readwrite-primary',function(txn){return _this.mutationQueue.setLastStreamToken(txn,streamToken)})},LocalStore.prototype.getLastRemoteSnapshotVersion=function(){var _this=this;return this.persistence.runTransaction('Get last remote snapshot version','readonly',function(txn){return _this.queryCache.getLastRemoteSnapshotVersion(txn)})},LocalStore.prototype.applyRemoteEvent=function(remoteEvent){var _this=this,documentBuffer=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction('Apply remote event','readwrite-primary',function(txn){var promises=[],authoritativeUpdates=documentKeySet();forEachNumber(remoteEvent.targetChanges,function(targetId,change){var queryData=_this.queryDataByTarget[targetId];if(queryData){change.addedDocuments.forEach(function(key){authoritativeUpdates=authoritativeUpdates.add(key)}),change.modifiedDocuments.forEach(function(key){authoritativeUpdates=authoritativeUpdates.add(key)}),promises.push(_this.queryCache.removeMatchingKeys(txn,change.removedDocuments,targetId).next(function(){return _this.queryCache.addMatchingKeys(txn,change.addedDocuments,targetId)}));var resumeToken=change.resumeToken;if(0<resumeToken.length){var oldQueryData=queryData;queryData=queryData.copy({resumeToken:resumeToken,snapshotVersion:remoteEvent.snapshotVersion}),_this.queryDataByTarget[targetId]=queryData,LocalStore.shouldPersistQueryData(oldQueryData,queryData,change)&&promises.push(_this.queryCache.updateQueryData(txn,queryData))}}});var changedDocKeys=documentKeySet();remoteEvent.documentUpdates.forEach(function(key,doc){changedDocKeys=changedDocKeys.add(key),promises.push(documentBuffer.getEntry(txn,key).next(function(existingDoc){null==existingDoc||doc.version.isEqual(SnapshotVersion.MIN)||authoritativeUpdates.has(doc.key)&&!existingDoc.hasPendingWrites||0<=doc.version.compareTo(existingDoc.version)?documentBuffer.addEntry(doc):debug('LocalStore','Ignoring outdated watch update for ',key,'. Current version:',existingDoc.version,' Watch version:',doc.version)})),remoteEvent.resolvedLimboDocuments.has(key)&&promises.push(_this.persistence.referenceDelegate.updateLimboDocument(txn,key))});var remoteVersion=remoteEvent.snapshotVersion;if(!remoteVersion.isEqual(SnapshotVersion.MIN)){var updateRemoteVersion=_this.queryCache.getLastRemoteSnapshotVersion(txn).next(function(lastRemoteVersion){return assert(0<=remoteVersion.compareTo(lastRemoteVersion),'Watch stream reverted to previous snapshot?? '+remoteVersion+' < '+lastRemoteVersion),_this.queryCache.setTargetsMetadata(txn,txn.currentSequenceNumber,remoteVersion)});promises.push(updateRemoteVersion)}return PersistencePromise.waitFor(promises).next(function(){return documentBuffer.apply(txn)}).next(function(){return _this.localDocuments.getDocuments(txn,changedDocKeys)})})},LocalStore.shouldPersistQueryData=function(oldQueryData,newQueryData,change){if(0===newQueryData.resumeToken.length)return!1;if(0===oldQueryData.resumeToken.length)return!0;var timeDelta=newQueryData.snapshotVersion.toMicroseconds()-oldQueryData.snapshotVersion.toMicroseconds();if(timeDelta>=this.RESUME_TOKEN_MAX_AGE_MICROS)return!0;var changes=change.addedDocuments.size+change.modifiedDocuments.size+change.removedDocuments.size;return 0<changes},LocalStore.prototype.notifyLocalViewChanges=function(viewChanges){var _this=this;return this.persistence.runTransaction('notifyLocalViewChanges','readwrite',function(txn){return PersistencePromise.forEach(viewChanges,function(viewChange){return _this.localViewReferences.addReferences(viewChange.addedKeys,viewChange.targetId),_this.localViewReferences.removeReferences(viewChange.removedKeys,viewChange.targetId),PersistencePromise.forEach(viewChange.removedKeys,function(key){return _this.persistence.referenceDelegate.removeReference(txn,key)})})})},LocalStore.prototype.nextMutationBatch=function(afterBatchId){var _this=this;return this.persistence.runTransaction('Get next mutation batch','readonly',function(txn){return void 0===afterBatchId&&(afterBatchId=BATCHID_UNKNOWN),_this.mutationQueue.getNextMutationBatchAfterBatchId(txn,afterBatchId)})},LocalStore.prototype.readDocument=function(key){var _this=this;return this.persistence.runTransaction('read document','readonly',function(txn){return _this.localDocuments.getDocument(txn,key)})},LocalStore.prototype.allocateQuery=function(query){var _this=this;return this.persistence.runTransaction('Allocate query','readwrite',function(txn){var queryData;return _this.queryCache.getQueryData(txn,query).next(function(cached){return cached?(queryData=cached,PersistencePromise.resolve()):_this.queryCache.allocateTargetId(txn).next(function(targetId){return queryData=new QueryData(query,targetId,QueryPurpose.Listen,txn.currentSequenceNumber),_this.queryCache.addQueryData(txn,queryData)})}).next(function(){return assert(!_this.queryDataByTarget[queryData.targetId],'Tried to allocate an already allocated query: '+query),_this.queryDataByTarget[queryData.targetId]=queryData,queryData})})},LocalStore.prototype.releaseQuery=function(query,keepPersistedQueryData){var _this=this,mode=keepPersistedQueryData?'readwrite':'readwrite-primary';return this.persistence.runTransaction('Release query',mode,function(txn){return _this.queryCache.getQueryData(txn,query).next(function(queryData){assert(null!=queryData,'Tried to release nonexistent query: '+query);var targetId=queryData.targetId,cachedQueryData=_this.queryDataByTarget[targetId],removed=_this.localViewReferences.removeReferencesForId(targetId);return delete _this.queryDataByTarget[targetId],keepPersistedQueryData?PersistencePromise.resolve():PersistencePromise.forEach(removed,function(key){return _this.persistence.referenceDelegate.removeReference(txn,key)}).next(function(){return _this.persistence.referenceDelegate.removeTarget(txn,cachedQueryData)})})})},LocalStore.prototype.executeQuery=function(query){var _this=this;return this.persistence.runTransaction('Execute query','readonly',function(txn){return _this.localDocuments.getDocumentsMatchingQuery(txn,query)})},LocalStore.prototype.remoteDocumentKeys=function(targetId){var _this=this;return this.persistence.runTransaction('Remote document keys','readonly',function(txn){return _this.queryCache.getMatchingKeysForTargetId(txn,targetId)})},LocalStore.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},LocalStore.prototype.removeCachedMutationBatchMetadata=function(batchId){this.mutationQueue.removeCachedMutationKeys(batchId)},LocalStore.prototype.setNetworkEnabled=function(networkEnabled){this.persistence.setNetworkEnabled(networkEnabled)},LocalStore.prototype.applyWriteToRemoteDocuments=function(txn,batchResult,documentBuffer){var _this=this,batch=batchResult.batch,docKeys=batch.keys(),promiseChain=PersistencePromise.resolve();return docKeys.forEach(function(docKey){promiseChain=promiseChain.next(function(){return documentBuffer.getEntry(txn,docKey)}).next(function(remoteDoc){var doc=remoteDoc,ackVersion=batchResult.docVersions.get(docKey);assert(null!==ackVersion,'ackVersions should contain every doc in the write.'),(!doc||0>doc.version.compareTo(ackVersion))&&(doc=batch.applyToRemoteDocument(docKey,doc,batchResult),doc?documentBuffer.addEntry(doc):assert(!remoteDoc,'Mutation batch '+batch+' applied to document '+remoteDoc+' resulted in null'))})}),promiseChain.next(function(){return _this.mutationQueue.removeMutationBatch(txn,batch)})},LocalStore.prototype.getQueryForTarget=function(targetId){var _this=this;return this.queryDataByTarget[targetId]?Promise.resolve(this.queryDataByTarget[targetId].query):this.persistence.runTransaction('Get query data','readonly',function(txn){return _this.queryCache.getQueryDataForTarget(txn,targetId).next(function(queryData){return queryData?queryData.query:null})})},LocalStore.prototype.getNewDocumentChanges=function(){var _this=this;return this.persistence.runTransaction('Get new document changes','readonly',function(txn){return _this.remoteDocuments.getNewDocumentChanges(txn)})},LocalStore.RESUME_TOKEN_MAX_AGE_MICROS=1e6*(60*5),LocalStore}(),MemoryMutationQueue=function(){function MemoryMutationQueue(referenceDelegate){this.referenceDelegate=referenceDelegate,this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=BATCHID_UNKNOWN,this.lastStreamToken=emptyByteString(),this.batchesByDocumentKey=new SortedSet(DocReference.compareByKey)}return MemoryMutationQueue.prototype.checkEmpty=function(){return PersistencePromise.resolve(0===this.mutationQueue.length)},MemoryMutationQueue.prototype.acknowledgeBatch=function(transaction,batch,streamToken){var batchId=batch.batchId;assert(batchId>this.highestAcknowledgedBatchId,'Mutation batchIDs must be acknowledged in order');var batchIndex=this.indexOfExistingBatchId(batchId,'acknowledged');assert(0===batchIndex,'Can only acknowledge the first batch in the mutation queue');var check=this.mutationQueue[batchIndex];return assert(batchId===check.batchId,'Queue ordering failure: expected batch '+batchId+', got batch '+check.batchId),this.highestAcknowledgedBatchId=batchId,this.lastStreamToken=streamToken,PersistencePromise.resolve()},MemoryMutationQueue.prototype.getLastStreamToken=function(){return PersistencePromise.resolve(this.lastStreamToken)},MemoryMutationQueue.prototype.setLastStreamToken=function(transaction,streamToken){return this.lastStreamToken=streamToken,PersistencePromise.resolve()},MemoryMutationQueue.prototype.addMutationBatch=function(transaction,localWriteTime,mutations){assert(0!==mutations.length,'Mutation batches should not be empty');var batchId=this.nextBatchId;if(this.nextBatchId++,0<this.mutationQueue.length){var prior=this.mutationQueue[this.mutationQueue.length-1];assert(prior.batchId<batchId,'Mutation batchIDs must be monotonically increasing order')}var batch=new MutationBatch(batchId,localWriteTime,mutations);this.mutationQueue.push(batch);for(var _i=0,mutations_1=mutations,mutation;_i<mutations_1.length;_i++)mutation=mutations_1[_i],this.batchesByDocumentKey=this.batchesByDocumentKey.add(new DocReference(mutation.key,batchId));return PersistencePromise.resolve(batch)},MemoryMutationQueue.prototype.lookupMutationBatch=function(transaction,batchId){return PersistencePromise.resolve(this.findMutationBatch(batchId))},MemoryMutationQueue.prototype.lookupMutationKeys=function(transaction,batchId){var mutationBatch=this.findMutationBatch(batchId);return assert(null!=mutationBatch,'Failed to find local mutation batch.'),PersistencePromise.resolve(mutationBatch.keys())},MemoryMutationQueue.prototype.getNextMutationBatchAfterBatchId=function(transaction,batchId){var nextBatchId=_Mathmax(batchId,this.highestAcknowledgedBatchId)+1,rawIndex=this.indexOfBatchId(nextBatchId),index=0>rawIndex?0:rawIndex;return PersistencePromise.resolve(this.mutationQueue.length>index?this.mutationQueue[index]:null)},MemoryMutationQueue.prototype.getAllMutationBatches=function(){return PersistencePromise.resolve(this.mutationQueue.slice())},MemoryMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKey=function(transaction,documentKey){var _this=this,start=new DocReference(documentKey,0),end=new DocReference(documentKey,_NumberPOSITIVE_INFINITY),result=[];return this.batchesByDocumentKey.forEachInRange([start,end],function(ref){assert(documentKey.isEqual(ref.key),'Should only iterate over a single key\'s batches');var batch=_this.findMutationBatch(ref.targetOrBatchId);assert(null!==batch,'Batches in the index must exist in the main table'),result.push(batch)}),PersistencePromise.resolve(result)},MemoryMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKeys=function(transaction,documentKeys){var _this=this,uniqueBatchIDs=new SortedSet(primitiveComparator);return documentKeys.forEach(function(documentKey){var start=new DocReference(documentKey,0),end=new DocReference(documentKey,_NumberPOSITIVE_INFINITY);_this.batchesByDocumentKey.forEachInRange([start,end],function(ref){assert(documentKey.isEqual(ref.key),'For each key, should only iterate over a single key\'s batches'),uniqueBatchIDs=uniqueBatchIDs.add(ref.targetOrBatchId)})}),PersistencePromise.resolve(this.findMutationBatches(uniqueBatchIDs))},MemoryMutationQueue.prototype.getAllMutationBatchesAffectingQuery=function(transaction,query){var prefix=query.path,immediateChildrenPathLength=prefix.length+1,startPath=prefix;DocumentKey.isDocumentKey(startPath)||(startPath=startPath.child(''));var start=new DocReference(new DocumentKey(startPath),0),uniqueBatchIDs=new SortedSet(primitiveComparator);return this.batchesByDocumentKey.forEachWhile(function(ref){var rowKeyPath=ref.key.path;return!!prefix.isPrefixOf(rowKeyPath)&&(rowKeyPath.length===immediateChildrenPathLength&&(uniqueBatchIDs=uniqueBatchIDs.add(ref.targetOrBatchId)),!0)},start),PersistencePromise.resolve(this.findMutationBatches(uniqueBatchIDs))},MemoryMutationQueue.prototype.findMutationBatches=function(batchIDs){var _this=this,result=[];return batchIDs.forEach(function(batchId){var batch=_this.findMutationBatch(batchId);null!==batch&&result.push(batch)}),result},MemoryMutationQueue.prototype.removeMutationBatch=function(transaction,batch){var _this=this,batchIndex=this.indexOfExistingBatchId(batch.batchId,'removed');assert(0===batchIndex,'Can only remove the first entry of the mutation queue'),this.mutationQueue.shift();var references=this.batchesByDocumentKey;return PersistencePromise.forEach(batch.mutations,function(mutation){var ref=new DocReference(mutation.key,batch.batchId);return references=references.delete(ref),_this.referenceDelegate.removeMutationReference(transaction,mutation.key)}).next(function(){_this.batchesByDocumentKey=references})},MemoryMutationQueue.prototype.removeCachedMutationKeys=function(){},MemoryMutationQueue.prototype.containsKey=function(txn,key){var ref=new DocReference(key,0),firstRef=this.batchesByDocumentKey.firstAfterOrEqual(ref);return PersistencePromise.resolve(key.isEqual(firstRef&&firstRef.key))},MemoryMutationQueue.prototype.performConsistencyCheck=function(){return 0===this.mutationQueue.length&&assert(this.batchesByDocumentKey.isEmpty(),'Document leak -- detected dangling mutation references when queue is empty.'),PersistencePromise.resolve()},MemoryMutationQueue.prototype.indexOfExistingBatchId=function(batchId,action){var index=this.indexOfBatchId(batchId);return assert(0<=index&&index<this.mutationQueue.length,'Batches must exist to be '+action),index},MemoryMutationQueue.prototype.indexOfBatchId=function(batchId){if(0===this.mutationQueue.length)return 0;var firstBatchId=this.mutationQueue[0].batchId;return batchId-firstBatchId},MemoryMutationQueue.prototype.findMutationBatch=function(batchId){var index=this.indexOfBatchId(batchId);if(0>index||index>=this.mutationQueue.length)return null;var batch=this.mutationQueue[index];return assert(batch.batchId===batchId,'If found batch must match'),batch},MemoryMutationQueue}(),MemoryQueryCache=function(){function MemoryQueryCache(persistence){this.persistence=persistence,this.queries=new ObjectMap(function(q){return q.canonicalId()}),this.lastRemoteSnapshotVersion=SnapshotVersion.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new ReferenceSet,this.targetCount=0,this.targetIdGenerator=TargetIdGenerator.forQueryCache()}return MemoryQueryCache.prototype.getTargetCount=function(){return PersistencePromise.resolve(this.targetCount)},MemoryQueryCache.prototype.forEachTarget=function(txn,f){return this.queries.forEach(function(_,queryData){return f(queryData)}),PersistencePromise.resolve()},MemoryQueryCache.prototype.getLastRemoteSnapshotVersion=function(){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)},MemoryQueryCache.prototype.getHighestSequenceNumber=function(){return PersistencePromise.resolve(this.highestSequenceNumber)},MemoryQueryCache.prototype.allocateTargetId=function(){var nextTargetId=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=nextTargetId,PersistencePromise.resolve(nextTargetId)},MemoryQueryCache.prototype.setTargetsMetadata=function(transaction,highestListenSequenceNumber,lastRemoteSnapshotVersion){return lastRemoteSnapshotVersion&&(this.lastRemoteSnapshotVersion=lastRemoteSnapshotVersion),highestListenSequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=highestListenSequenceNumber),PersistencePromise.resolve()},MemoryQueryCache.prototype.saveQueryData=function(queryData){this.queries.set(queryData.query,queryData);var targetId=queryData.targetId;targetId>this.highestTargetId&&(this.highestTargetId=targetId),queryData.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=queryData.sequenceNumber)},MemoryQueryCache.prototype.addQueryData=function(transaction,queryData){return assert(!this.queries.has(queryData.query),'Adding a query that already exists'),this.saveQueryData(queryData),this.targetCount+=1,PersistencePromise.resolve()},MemoryQueryCache.prototype.updateQueryData=function(transaction,queryData){return assert(this.queries.has(queryData.query),'Updating a non-existent query'),this.saveQueryData(queryData),PersistencePromise.resolve()},MemoryQueryCache.prototype.removeQueryData=function(transaction,queryData){return assert(0<this.targetCount,'Removing a target from an empty cache'),assert(this.queries.has(queryData.query),'Removing a non-existent target from the cache'),this.queries.delete(queryData.query),this.references.removeReferencesForId(queryData.targetId),this.targetCount-=1,PersistencePromise.resolve()},MemoryQueryCache.prototype.removeTargets=function(transaction,upperBound,activeTargetIds){var _this=this,count=0,removals=[];return this.queries.forEach(function(key,queryData){queryData.sequenceNumber<=upperBound&&!activeTargetIds[queryData.targetId]&&(_this.queries.delete(key),removals.push(_this.removeMatchingKeysForTargetId(transaction,queryData.targetId)),count++)}),PersistencePromise.waitFor(removals).next(function(){return count})},MemoryQueryCache.prototype.getQueryCount=function(){return PersistencePromise.resolve(this.targetCount)},MemoryQueryCache.prototype.getQueryData=function(transaction,query){var queryData=this.queries.get(query)||null;return PersistencePromise.resolve(queryData)},MemoryQueryCache.prototype.getQueryDataForTarget=function(){return fail('Not yet implemented.')},MemoryQueryCache.prototype.addMatchingKeys=function(txn,keys,targetId){this.references.addReferences(keys,targetId);var referenceDelegate=this.persistence.referenceDelegate,promises=[];return referenceDelegate&&keys.forEach(function(key){promises.push(referenceDelegate.addReference(txn,key))}),PersistencePromise.waitFor(promises)},MemoryQueryCache.prototype.removeMatchingKeys=function(txn,keys,targetId){this.references.removeReferences(keys,targetId);var referenceDelegate=this.persistence.referenceDelegate,promises=[];return referenceDelegate&&keys.forEach(function(key){promises.push(referenceDelegate.removeReference(txn,key))}),PersistencePromise.waitFor(promises)},MemoryQueryCache.prototype.removeMatchingKeysForTargetId=function(txn,targetId){return this.references.removeReferencesForId(targetId),PersistencePromise.resolve()},MemoryQueryCache.prototype.getMatchingKeysForTargetId=function(txn,targetId){var matchingKeys=this.references.referencesForId(targetId);return PersistencePromise.resolve(matchingKeys)},MemoryQueryCache.prototype.containsKey=function(txn,key){return PersistencePromise.resolve(this.references.containsKey(key))},MemoryQueryCache}(),MemoryRemoteDocumentCache=function(){function MemoryRemoteDocumentCache(sizer){this.sizer=sizer,this.docs=documentSizeMap(),this.newDocumentChanges=documentKeySet(),this.size=0}return MemoryRemoteDocumentCache.prototype.addEntries=function(transaction,entries,sizeDelta){for(var _i=0,entries_1=entries;_i<entries_1.length;_i++){var entry=entries_1[_i],key=entry.maybeDocument.key;this.docs=this.docs.insert(key,entry),this.newDocumentChanges=this.newDocumentChanges.add(key)}return this.size+=sizeDelta,PersistencePromise.resolve()},MemoryRemoteDocumentCache.prototype.removeEntry=function(transaction,documentKey){var entry=this.docs.get(documentKey);return entry?(this.docs=this.docs.remove(documentKey),this.size-=entry.size,PersistencePromise.resolve(entry.size)):PersistencePromise.resolve(0)},MemoryRemoteDocumentCache.prototype.getEntry=function(transaction,documentKey){var entry=this.docs.get(documentKey);return PersistencePromise.resolve(entry?entry.maybeDocument:null)},MemoryRemoteDocumentCache.prototype.getSizedEntry=function(transaction,documentKey){return PersistencePromise.resolve(this.docs.get(documentKey))},MemoryRemoteDocumentCache.prototype.getDocumentsMatchingQuery=function(transaction,query){for(var results=documentMap(),prefix=new DocumentKey(query.path.child('')),iterator=this.docs.getIteratorFrom(prefix);iterator.hasNext();){var _a=iterator.getNext(),key=_a.key,maybeDocument=_a.value.maybeDocument;if(!query.path.isPrefixOf(key.path))break;maybeDocument instanceof Document&&query.matches(maybeDocument)&&(results=results.insert(maybeDocument.key,maybeDocument))}return PersistencePromise.resolve(results)},MemoryRemoteDocumentCache.prototype.forEachDocumentKey=function(transaction,f){return PersistencePromise.forEach(this.docs,function(key){return f(key)})},MemoryRemoteDocumentCache.prototype.getNewDocumentChanges=function(){var _this=this,changedDocs=maybeDocumentMap();return this.newDocumentChanges.forEach(function(key){var entry=_this.docs.get(key),changedDoc=entry?entry.maybeDocument:new NoDocument(key,SnapshotVersion.forDeletedDoc());changedDocs=changedDocs.insert(key,changedDoc)}),this.newDocumentChanges=documentKeySet(),PersistencePromise.resolve(changedDocs)},MemoryRemoteDocumentCache.prototype.newChangeBuffer=function(){return new MemoryRemoteDocumentChangeBuffer(this.sizer,this)},MemoryRemoteDocumentCache.prototype.getSize=function(){return PersistencePromise.resolve(this.size)},MemoryRemoteDocumentCache}(),MemoryRemoteDocumentChangeBuffer=function(_super){function MemoryRemoteDocumentChangeBuffer(sizer,documentCache){var _this=_super.call(this)||this;return _this.sizer=sizer,_this.documentCache=documentCache,_this}return tslib_1.__extends(MemoryRemoteDocumentChangeBuffer,_super),MemoryRemoteDocumentChangeBuffer.prototype.applyChanges=function(transaction){var _this=this,changes=this.assertChanges(),delta=0,docs=[];return changes.forEach(function(key,maybeDocument){var previousSize=_this.documentSizes.get(key);assert(void 0!==previousSize,'Attempting to change document '+key.toString()+' without having read it first');var size=_this.sizer(maybeDocument);delta+=size-previousSize,docs.push({maybeDocument:maybeDocument,size:size})}),this.documentCache.addEntries(transaction,docs,delta)},MemoryRemoteDocumentChangeBuffer.prototype.getFromCache=function(transaction,documentKey){return this.documentCache.getSizedEntry(transaction,documentKey)},MemoryRemoteDocumentChangeBuffer}(RemoteDocumentChangeBuffer),MemoryPersistence=function(){function MemoryPersistence(clientId,isEager,serializer){var _this=this;this.clientId=clientId,this.mutationQueues={},this.listenSequence=new ListenSequence(0),this._started=!1,this._started=!0,this.referenceDelegate=isEager?new MemoryEagerDelegate(this):new MemoryLruDelegate(this,new LocalSerializer(serializer)),this.queryCache=new MemoryQueryCache(this);this.remoteDocumentCache=new MemoryRemoteDocumentCache(function(doc){return _this.referenceDelegate.documentSize(doc)})}return MemoryPersistence.createLruPersistence=function(clientId,serializer){return new MemoryPersistence(clientId,!1,serializer)},MemoryPersistence.createEagerPersistence=function(clientId,serializer){return new MemoryPersistence(clientId,!0,serializer)},MemoryPersistence.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(MemoryPersistence.prototype,'started',{get:function(){return this._started},enumerable:!0,configurable:!0}),MemoryPersistence.prototype.getActiveClients=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return[2,[this.clientId]]})})},MemoryPersistence.prototype.setPrimaryStateListener=function(primaryStateListener){return primaryStateListener(!0)},MemoryPersistence.prototype.setNetworkEnabled=function(){},MemoryPersistence.prototype.getMutationQueue=function(user){var queue=this.mutationQueues[user.toKey()];return queue||(queue=new MemoryMutationQueue(this.referenceDelegate),this.mutationQueues[user.toKey()]=queue),queue},MemoryPersistence.prototype.getQueryCache=function(){return this.queryCache},MemoryPersistence.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},MemoryPersistence.prototype.runTransaction=function(action,mode,transactionOperation){var _this=this;debug('MemoryPersistence','Starting transaction:',action);var txn=new MemoryTransaction(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),transactionOperation(txn).next(function(result){return _this.referenceDelegate.onTransactionCommitted(txn).next(function(){return result})}).toPromise()},MemoryPersistence.prototype.mutationQueuesContainKey=function(transaction,key){return PersistencePromise.or(values(this.mutationQueues).map(function(queue){return function(){return queue.containsKey(transaction,key)}}))},MemoryPersistence}(),MemoryTransaction=function(){return function MemoryTransaction(currentSequenceNumber){this.currentSequenceNumber=currentSequenceNumber}}(),MemoryEagerDelegate=function(){function MemoryEagerDelegate(persistence){this.persistence=persistence}return MemoryEagerDelegate.prototype.setInMemoryPins=function(inMemoryPins){this.inMemoryPins=inMemoryPins},MemoryEagerDelegate.prototype.addReference=function(txn,key){return this.orphanedDocuments.delete(key),PersistencePromise.resolve()},MemoryEagerDelegate.prototype.removeReference=function(txn,key){return this.orphanedDocuments.add(key),PersistencePromise.resolve()},MemoryEagerDelegate.prototype.removeMutationReference=function(txn,key){return this.orphanedDocuments.add(key),PersistencePromise.resolve()},MemoryEagerDelegate.prototype.removeTarget=function(txn,queryData){var _this=this,cache=this.persistence.getQueryCache();return cache.getMatchingKeysForTargetId(txn,queryData.targetId).next(function(keys){keys.forEach(function(key){return _this.orphanedDocuments.add(key)})}).next(function(){return cache.removeQueryData(txn,queryData)})},MemoryEagerDelegate.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},MemoryEagerDelegate.prototype.onTransactionCommitted=function(txn){var _this=this,cache=this.persistence.getRemoteDocumentCache();return PersistencePromise.forEach(this.orphanedDocuments,function(key){return _this.isReferenced(txn,key).next(function(isReferenced){return isReferenced?PersistencePromise.resolve():cache.removeEntry(txn,key).next(function(){})})})},MemoryEagerDelegate.prototype.updateLimboDocument=function(txn,key){var _this=this;return this.isReferenced(txn,key).next(function(isReferenced){isReferenced?_this.orphanedDocuments.delete(key):_this.orphanedDocuments.add(key)})},MemoryEagerDelegate.prototype.documentSize=function(){return 0},MemoryEagerDelegate.prototype.isReferenced=function(txn,key){var _this=this;return PersistencePromise.or([function(){return _this.persistence.getQueryCache().containsKey(txn,key)},function(){return _this.persistence.mutationQueuesContainKey(txn,key)},function(){return PersistencePromise.resolve(_this.inMemoryPins.containsKey(key))}])},MemoryEagerDelegate}(),MemoryLruDelegate=function(){function MemoryLruDelegate(persistence,serializer){this.persistence=persistence,this.serializer=serializer,this.orphanedSequenceNumbers=new ObjectMap(function(k){return encode(k.path)}),this.garbageCollector=new LruGarbageCollector(this)}return MemoryLruDelegate.prototype.onTransactionStarted=function(){},MemoryLruDelegate.prototype.onTransactionCommitted=function(){return PersistencePromise.resolve()},MemoryLruDelegate.prototype.forEachTarget=function(txn,f){return this.persistence.getQueryCache().forEachTarget(txn,f)},MemoryLruDelegate.prototype.getTargetCount=function(txn){return this.persistence.getQueryCache().getTargetCount(txn)},MemoryLruDelegate.prototype.forEachOrphanedDocumentSequenceNumber=function(txn,f){var _this=this;return PersistencePromise.forEach(this.orphanedSequenceNumbers,function(key,sequenceNumber){return _this.isPinned(txn,key,sequenceNumber).next(function(isPinned){return isPinned?PersistencePromise.resolve():f(sequenceNumber)})})},MemoryLruDelegate.prototype.setInMemoryPins=function(inMemoryPins){this.inMemoryPins=inMemoryPins},MemoryLruDelegate.prototype.removeTargets=function(txn,upperBound,activeTargetIds){return this.persistence.getQueryCache().removeTargets(txn,upperBound,activeTargetIds)},MemoryLruDelegate.prototype.removeOrphanedDocuments=function(txn,upperBound){var _this=this,count=0,cache=this.persistence.getRemoteDocumentCache(),p=cache.forEachDocumentKey(txn,function(key){return _this.isPinned(txn,key,upperBound).next(function(isPinned){return isPinned?PersistencePromise.resolve():(count++,cache.removeEntry(txn,key).next())})});return p.next(function(){return count})},MemoryLruDelegate.prototype.removeMutationReference=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.removeTarget=function(txn,queryData){var updated=queryData.copy({sequenceNumber:txn.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(txn,updated)},MemoryLruDelegate.prototype.addReference=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.removeReference=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.updateLimboDocument=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.documentSize=function(maybeDoc){var remoteDocument=this.serializer.toDbRemoteDocument(maybeDoc),value;if(remoteDocument.document)value=remoteDocument.document;else if(remoteDocument.unknownDocument)value=remoteDocument.unknownDocument;else if(remoteDocument.noDocument)value=remoteDocument.noDocument;else throw fail('Unknown remote document type');return JSON.stringify(value).length},MemoryLruDelegate.prototype.isPinned=function(txn,key,upperBound){var _this=this;return PersistencePromise.or([function(){return _this.persistence.mutationQueuesContainKey(txn,key)},function(){return PersistencePromise.resolve(_this.inMemoryPins.containsKey(key))},function(){return _this.persistence.getQueryCache().containsKey(txn,key)},function(){var orphanedAt=_this.orphanedSequenceNumbers.get(key);return PersistencePromise.resolve(void 0!==orphanedAt&&orphanedAt>upperBound)}])},MemoryLruDelegate}(),ExponentialBackoff=function(){function ExponentialBackoff(queue,timerId,initialDelayMs,backoffFactor,maxDelayMs){this.queue=queue,this.timerId=timerId,this.initialDelayMs=initialDelayMs,this.backoffFactor=backoffFactor,this.maxDelayMs=maxDelayMs,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return ExponentialBackoff.prototype.reset=function(){this.currentBaseMs=0},ExponentialBackoff.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},ExponentialBackoff.prototype.backoffAndRun=function(op){var _this=this;this.cancel();var desiredDelayWithJitterMs=_Mathfloor(this.currentBaseMs+this.jitterDelayMs()),delaySoFarMs=_Mathmax(0,Date.now()-this.lastAttemptTime),remainingDelayMs=_Mathmax(0,desiredDelayWithJitterMs-delaySoFarMs);0<this.currentBaseMs&&debug('ExponentialBackoff','Backing off for '+remainingDelayMs+' ms '+('(base delay: '+this.currentBaseMs+' ms, ')+('delay with jitter: '+desiredDelayWithJitterMs+' ms, ')+('last attempt: '+delaySoFarMs+' ms ago)')),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,remainingDelayMs,function(){return _this.lastAttemptTime=Date.now(),op()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},ExponentialBackoff.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},ExponentialBackoff.prototype.jitterDelayMs=function(){return(Math.random()-0.5)*this.currentBaseMs},ExponentialBackoff}(),LOG_TAG$6='PersistentStream',PersistentStreamState;(function(PersistentStreamState){PersistentStreamState[PersistentStreamState.Initial=0]='Initial',PersistentStreamState[PersistentStreamState.Starting=1]='Starting',PersistentStreamState[PersistentStreamState.Open=2]='Open',PersistentStreamState[PersistentStreamState.Error=3]='Error',PersistentStreamState[PersistentStreamState.Backoff=4]='Backoff'})(PersistentStreamState||(PersistentStreamState={}));var PersistentStream=function(){function PersistentStream(queue,connectionTimerId,idleTimerId,connection,credentialsProvider,listener){this.queue=queue,this.idleTimerId=idleTimerId,this.connection=connection,this.credentialsProvider=credentialsProvider,this.listener=listener,this.state=PersistentStreamState.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new ExponentialBackoff(queue,connectionTimerId,1e3,1.5,1e3*60)}return PersistentStream.prototype.isStarted=function(){return this.state===PersistentStreamState.Starting||this.state===PersistentStreamState.Open||this.state===PersistentStreamState.Backoff},PersistentStream.prototype.isOpen=function(){return this.state===PersistentStreamState.Open},PersistentStream.prototype.start=function(){return this.state===PersistentStreamState.Error?void this.performBackoff():void(assert(this.state===PersistentStreamState.Initial,'Already started'),this.auth())},PersistentStream.prototype.stop=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.isStarted()?[4,this.close(PersistentStreamState.Initial)]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2];}})})},PersistentStream.prototype.inhibitBackoff=function(){assert(!this.isStarted(),'Can only inhibit backoff in a stopped state'),this.state=PersistentStreamState.Initial,this.backoff.reset()},PersistentStream.prototype.markIdle=function(){var _this=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,1e3*60,function(){return _this.handleIdleCloseTimer()}))},PersistentStream.prototype.sendRequest=function(msg){this.cancelIdleCheck(),this.stream.send(msg)},PersistentStream.prototype.handleIdleCloseTimer=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.isOpen()?[2,this.close(PersistentStreamState.Initial)]:[2]})})},PersistentStream.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},PersistentStream.prototype.close=function(finalState,error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return assert(this.isStarted(),'Only started streams should be closed.'),assert(finalState===PersistentStreamState.Error||isNullOrUndefined(error$$1),'Can\'t provide an error when not in an error state.'),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,finalState===PersistentStreamState.Error?error$$1&&error$$1.code===Code.RESOURCE_EXHAUSTED?(error(error$$1.toString()),error('Using maximum backoff delay to prevent overloading the backend.'),this.backoff.resetToMax()):error$$1&&error$$1.code===Code.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken():this.backoff.reset(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=finalState,[4,this.listener.onClose(error$$1)];case 1:return _a.sent(),[2];}})})},PersistentStream.prototype.tearDown=function(){},PersistentStream.prototype.auth=function(){var _this=this;assert(this.state===PersistentStreamState.Initial,'Must be in initial state to auth'),this.state=PersistentStreamState.Starting;var dispatchIfNotClosed=this.getCloseGuardedDispatcher(this.closeCount),closeCount=this.closeCount;this.credentialsProvider.getToken().then(function(token){_this.closeCount===closeCount&&_this.startStream(token)},function(error$$1){dispatchIfNotClosed(function(){var rpcError=new FirestoreError(Code.UNKNOWN,'Fetching auth token failed: '+error$$1.message);return _this.handleStreamClose(rpcError)})})},PersistentStream.prototype.startStream=function(token){var _this=this;assert(this.state===PersistentStreamState.Starting,'Trying to start stream in a non-starting state');var dispatchIfNotClosed=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(token),this.stream.onOpen(function(){dispatchIfNotClosed(function(){return assert(_this.state===PersistentStreamState.Starting,'Expected stream to be in state Starting, but was '+_this.state),_this.state=PersistentStreamState.Open,_this.listener.onOpen()})}),this.stream.onClose(function(error$$1){dispatchIfNotClosed(function(){return _this.handleStreamClose(error$$1)})}),this.stream.onMessage(function(msg){dispatchIfNotClosed(function(){return _this.onMessage(msg)})})},PersistentStream.prototype.performBackoff=function(){var _this=this;assert(this.state===PersistentStreamState.Error,'Should only perform backoff when in Error state'),this.state=PersistentStreamState.Backoff,this.backoff.backoffAndRun(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return assert(this.state===PersistentStreamState.Backoff,'Backoff elapsed but state is now: '+this.state),this.state=PersistentStreamState.Initial,this.start(),assert(this.isStarted(),'PersistentStream should have started'),[2]})})})},PersistentStream.prototype.handleStreamClose=function(error$$1){return assert(this.isStarted(),'Can\'t handle server close on non-started stream'),debug(LOG_TAG$6,'close with error: '+error$$1),this.stream=null,this.close(PersistentStreamState.Error,error$$1)},PersistentStream.prototype.getCloseGuardedDispatcher=function(startCloseCount){var _this=this;return function(fn){_this.queue.enqueueAndForget(function(){return _this.closeCount===startCloseCount?fn():(debug(LOG_TAG$6,'stream callback skipped by getCloseGuardedDispatcher.'),Promise.resolve())})}},PersistentStream}(),PersistentListenStream=function(_super){function PersistentListenStream(queue,connection,credentials,serializer,listener){var _this=_super.call(this,queue,TimerId.ListenStreamConnectionBackoff,TimerId.ListenStreamIdle,connection,credentials,listener)||this;return _this.serializer=serializer,_this}return tslib_1.__extends(PersistentListenStream,_super),PersistentListenStream.prototype.startRpc=function(token){return this.connection.openStream('Listen',token)},PersistentListenStream.prototype.onMessage=function(watchChangeProto){this.backoff.reset();var watchChange=this.serializer.fromWatchChange(watchChangeProto),snapshot=this.serializer.versionFromListenResponse(watchChangeProto);return this.listener.onWatchChange(watchChange,snapshot)},PersistentListenStream.prototype.watch=function(queryData){var request={database:this.serializer.encodedDatabaseId,addTarget:this.serializer.toTarget(queryData)},labels=this.serializer.toListenRequestLabels(queryData);labels&&(request.labels=labels),this.sendRequest(request)},PersistentListenStream.prototype.unwatch=function(targetId){var request={};request.database=this.serializer.encodedDatabaseId,request.removeTarget=targetId,this.sendRequest(request)},PersistentListenStream}(PersistentStream),PersistentWriteStream=function(_super){function PersistentWriteStream(queue,connection,credentials,serializer,listener){var _this=_super.call(this,queue,TimerId.WriteStreamConnectionBackoff,TimerId.WriteStreamIdle,connection,credentials,listener)||this;return _this.serializer=serializer,_this.handshakeComplete_=!1,_this}return tslib_1.__extends(PersistentWriteStream,_super),Object.defineProperty(PersistentWriteStream.prototype,'handshakeComplete',{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),PersistentWriteStream.prototype.start=function(){this.handshakeComplete_=!1,_super.prototype.start.call(this)},PersistentWriteStream.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},PersistentWriteStream.prototype.startRpc=function(token){return this.connection.openStream('Write',token)},PersistentWriteStream.prototype.onMessage=function(responseProto){if(assert(!!responseProto.streamToken,'Got a write response without a stream token'),this.lastStreamToken=responseProto.streamToken,!this.handshakeComplete_)return assert(!responseProto.writeResults||0===responseProto.writeResults.length,'Got mutation results for handshake'),this.handshakeComplete_=!0,this.listener.onHandshakeComplete();this.backoff.reset();var results=this.serializer.fromWriteResults(responseProto.writeResults,responseProto.commitTime),commitVersion=this.serializer.fromVersion(responseProto.commitTime);return this.listener.onMutationResult(commitVersion,results)},PersistentWriteStream.prototype.writeHandshake=function(){assert(this.isOpen(),'Writing handshake requires an opened stream'),assert(!this.handshakeComplete_,'Handshake already completed');var request={};request.database=this.serializer.encodedDatabaseId,this.sendRequest(request)},PersistentWriteStream.prototype.writeMutations=function(mutations){var _this=this;assert(this.isOpen(),'Writing mutations requires an opened stream'),assert(this.handshakeComplete_,'Handshake must be complete before writing mutations'),assert(0<this.lastStreamToken.length,'Trying to write mutation without a token');var request={streamToken:this.lastStreamToken,writes:mutations.map(function(mutation){return _this.serializer.toMutation(mutation)})};this.sendRequest(request)},PersistentWriteStream}(PersistentStream),Datastore=function(){function Datastore(queue,connection,credentials,serializer){this.queue=queue,this.connection=connection,this.credentials=credentials,this.serializer=serializer}return Datastore.prototype.newPersistentWriteStream=function(listener){return new PersistentWriteStream(this.queue,this.connection,this.credentials,this.serializer,listener)},Datastore.prototype.newPersistentWatchStream=function(listener){return new PersistentListenStream(this.queue,this.connection,this.credentials,this.serializer,listener)},Datastore.prototype.commit=function(mutations){var _this=this,params={database:this.serializer.encodedDatabaseId,writes:mutations.map(function(m){return _this.serializer.toMutation(m)})};return this.invokeRPC('Commit',params).then(function(response){return _this.serializer.fromWriteResults(response.writeResults,response.commitTime)})},Datastore.prototype.lookup=function(keys){var _this=this,params={database:this.serializer.encodedDatabaseId,documents:keys.map(function(k){return _this.serializer.toName(k)})};return this.invokeStreamingRPC('BatchGetDocuments',params).then(function(response){var docs=maybeDocumentMap();response.forEach(function(proto){var doc=_this.serializer.fromMaybeDocument(proto);docs=docs.insert(doc.key,doc)});var result=[];return keys.forEach(function(key){var doc=docs.get(key);assert(!!doc,'Missing entity in write response for '+key),result.push(doc)}),result})},Datastore.prototype.invokeRPC=function(rpcName,request){var _this=this;return this.credentials.getToken().then(function(token){return _this.connection.invokeRPC(rpcName,request,token)}).catch(function(error){throw error.code===Code.UNAUTHENTICATED&&_this.credentials.invalidateToken(),error})},Datastore.prototype.invokeStreamingRPC=function(rpcName,request){var _this=this;return this.credentials.getToken().then(function(token){return _this.connection.invokeStreamingRPC(rpcName,request,token)}).catch(function(error){throw error.code===Code.UNAUTHENTICATED&&_this.credentials.invalidateToken(),error})},Datastore}(),Transaction=function(){function Transaction(datastore){this.datastore=datastore,this.readVersions=documentVersionMap(),this.mutations=[],this.committed=!1}return Transaction.prototype.recordVersion=function(doc){var docVersion;if(doc instanceof Document)docVersion=doc.version;else if(doc instanceof NoDocument)docVersion=SnapshotVersion.forDeletedDoc();else throw fail('Document in a transaction was a '+doc.constructor.name);var existingVersion=this.readVersions.get(doc.key);if(null===existingVersion)this.readVersions=this.readVersions.insert(doc.key,docVersion);else if(!docVersion.isEqual(existingVersion))throw new FirestoreError(Code.ABORTED,'Document version changed between two reads.')},Transaction.prototype.lookup=function(keys){var _this=this;return this.committed?Promise.reject('Transaction has already completed.'):0<this.mutations.length?Promise.reject('Transactions lookups are invalid after writes.'):this.datastore.lookup(keys).then(function(docs){return docs.forEach(function(doc){doc instanceof NoDocument||doc instanceof Document?_this.recordVersion(doc):fail('Document in a transaction was a '+doc.constructor.name)}),docs})},Transaction.prototype.write=function(mutations){if(this.committed)throw new FirestoreError(Code.FAILED_PRECONDITION,'Transaction has already completed.');this.mutations=this.mutations.concat(mutations)},Transaction.prototype.precondition=function(key){var version=this.readVersions.get(key);return version?Precondition.updateTime(version):Precondition.NONE},Transaction.prototype.preconditionForUpdate=function(key){var version=this.readVersions.get(key);if(version&&version.isEqual(SnapshotVersion.forDeletedDoc()))throw new FirestoreError(Code.FAILED_PRECONDITION,'Can\'t update a document that doesn\'t exist.');else return version?Precondition.updateTime(version):Precondition.exists(!0)},Transaction.prototype.set=function(key,data){this.write(data.toMutations(key,this.precondition(key)))},Transaction.prototype.update=function(key,data){this.write(data.toMutations(key,this.preconditionForUpdate(key)))},Transaction.prototype.delete=function(key){this.write([new DeleteMutation(key,this.precondition(key))]),this.readVersions=this.readVersions.insert(key,SnapshotVersion.forDeletedDoc())},Transaction.prototype.commit=function(){var _this=this,unwritten=this.readVersions;return this.mutations.forEach(function(mutation){unwritten=unwritten.remove(mutation.key)}),unwritten.isEmpty()?this.datastore.commit(this.mutations).then(function(){_this.committed=!0}):Promise.reject(Error('Every document read in a transaction must also be written.'))},Transaction}(),OnlineState;(function(OnlineState){OnlineState[OnlineState.Unknown=0]='Unknown',OnlineState[OnlineState.Online=1]='Online',OnlineState[OnlineState.Offline=2]='Offline'})(OnlineState||(OnlineState={}));var OnlineStateSource;(function(OnlineStateSource){OnlineStateSource[OnlineStateSource.RemoteStore=0]='RemoteStore',OnlineStateSource[OnlineStateSource.SharedClientState=1]='SharedClientState'})(OnlineStateSource||(OnlineStateSource={}));var MAX_WATCH_STREAM_FAILURES=1,ONLINE_STATE_TIMEOUT_MS=1e3*10,OnlineStateTracker=function(){function OnlineStateTracker(asyncQueue,onlineStateHandler){this.asyncQueue=asyncQueue,this.onlineStateHandler=onlineStateHandler,this.state=OnlineState.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return OnlineStateTracker.prototype.handleWatchStreamStart=function(){var _this=this;0===this.watchStreamFailures&&(this.setAndBroadcast(OnlineState.Unknown),assert(null===this.onlineStateTimer,'onlineStateTimer shouldn\'t be started yet'),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(TimerId.OnlineStateTimeout,ONLINE_STATE_TIMEOUT_MS,function(){return _this.onlineStateTimer=null,assert(_this.state===OnlineState.Unknown,'Timer should be canceled if we transitioned to a different state.'),_this.logClientOfflineWarningIfNecessary('Backend didn\'t respond within '+ONLINE_STATE_TIMEOUT_MS/1e3+' '+'seconds.'),_this.setAndBroadcast(OnlineState.Offline),Promise.resolve()}))},OnlineStateTracker.prototype.handleWatchStreamFailure=function(error$$1){this.state===OnlineState.Online?(this.setAndBroadcast(OnlineState.Unknown),assert(0===this.watchStreamFailures,'watchStreamFailures must be 0'),assert(null===this.onlineStateTimer,'onlineStateTimer must be null')):(this.watchStreamFailures++,this.watchStreamFailures>=MAX_WATCH_STREAM_FAILURES&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary('Connection failed '+MAX_WATCH_STREAM_FAILURES+' '+('times. Most recent error: '+error$$1.toString())),this.setAndBroadcast(OnlineState.Offline)))},OnlineStateTracker.prototype.set=function(newState){this.clearOnlineStateTimer(),this.watchStreamFailures=0,newState===OnlineState.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(newState)},OnlineStateTracker.prototype.setAndBroadcast=function(newState){newState!==this.state&&(this.state=newState,this.onlineStateHandler(newState))},OnlineStateTracker.prototype.logClientOfflineWarningIfNecessary=function(details){var message='Could not reach Cloud Firestore backend. '+details+'\n'+'This typically indicates that your device does not have a healthy '+'Internet connection at the moment. The client will operate in offline '+'mode until it is able to successfully connect to the backend.';this.shouldWarnClientIsOffline?(error(message),this.shouldWarnClientIsOffline=!1):debug('OnlineStateTracker',message)},OnlineStateTracker.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},OnlineStateTracker}(),LOG_TAG$8='RemoteStore',RemoteStore=function(){function RemoteStore(localStore,datastore,asyncQueue,onlineStateHandler){this.localStore=localStore,this.datastore=datastore,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.onlineStateTracker=new OnlineStateTracker(asyncQueue,onlineStateHandler),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return RemoteStore.prototype.start=function(){return this.enableNetwork()},RemoteStore.prototype.enableNetwork=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _a;return tslib_1.__generator(this,function(_b){switch(_b.label){case 0:return(this.networkEnabled=!0,!this.canUseNetwork())?[3,3]:(_a=this.writeStream,[4,this.localStore.getLastStreamToken()]);case 1:return _a.lastStreamToken=_b.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(OnlineState.Unknown),[4,this.fillWritePipeline()];case 2:_b.sent(),_b.label=3;case 3:return[2];}})})},RemoteStore.prototype.disableNetwork=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return _a.sent(),this.onlineStateTracker.set(OnlineState.Offline),[2];}})})},RemoteStore.prototype.disableNetworkInternal=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return[4,this.writeStream.stop()];case 1:return _a.sent(),[4,this.watchStream.stop()];case 2:return _a.sent(),0<this.writePipeline.length&&(debug(LOG_TAG$8,'Stopping write stream with '+this.writePipeline.length+' pending writes'),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2];}})})},RemoteStore.prototype.shutdown=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return debug(LOG_TAG$8,'RemoteStore shutting down.'),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return _a.sent(),this.onlineStateTracker.set(OnlineState.Unknown),[2];}})})},RemoteStore.prototype.listen=function(queryData){assert(!contains(this.listenTargets,queryData.targetId),'listen called with duplicate targetId!'),this.listenTargets[queryData.targetId]=queryData,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(queryData)},RemoteStore.prototype.unlisten=function(targetId){assert(contains(this.listenTargets,targetId),'unlisten called without assigned target ID!'),delete this.listenTargets[targetId],this.watchStream.isOpen()&&this.sendUnwatchRequest(targetId),isEmpty(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(OnlineState.Unknown))},RemoteStore.prototype.getQueryDataForTarget=function(targetId){return this.listenTargets[targetId]||null},RemoteStore.prototype.getRemoteKeysForTarget=function(targetId){return this.syncEngine.getRemoteKeysForTarget(targetId)},RemoteStore.prototype.sendWatchRequest=function(queryData){this.watchChangeAggregator.recordPendingTargetRequest(queryData.targetId),this.watchStream.watch(queryData)},RemoteStore.prototype.sendUnwatchRequest=function(targetId){this.watchChangeAggregator.recordPendingTargetRequest(targetId),this.watchStream.unwatch(targetId)},RemoteStore.prototype.startWatchStream=function(){assert(this.shouldStartWatchStream(),'startWatchStream() called when shouldStartWatchStream() is false.'),this.watchChangeAggregator=new WatchChangeAggregator(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},RemoteStore.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!isEmpty(this.listenTargets)},RemoteStore.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},RemoteStore.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},RemoteStore.prototype.onWatchStreamOpen=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this;return tslib_1.__generator(this,function(){return forEachNumber(this.listenTargets,function(targetId,queryData){_this.sendWatchRequest(queryData)}),[2]})})},RemoteStore.prototype.onWatchStreamClose=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return void 0===error$$1&&assert(!this.shouldStartWatchStream(),'Watch stream was stopped gracefully while still needed.'),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(error$$1),this.startWatchStream()):this.onlineStateTracker.set(OnlineState.Unknown),[2]})})},RemoteStore.prototype.onWatchStreamChange=function(watchChange,snapshotVersion){return tslib_1.__awaiter(this,void 0,void 0,function(){var lastRemoteSnapshotVersion;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.onlineStateTracker.set(OnlineState.Online),watchChange instanceof WatchTargetChange&&watchChange.state===WatchTargetChangeState.Removed&&watchChange.cause)?[2,this.handleTargetError(watchChange)]:(watchChange instanceof DocumentWatchChange?this.watchChangeAggregator.handleDocumentChange(watchChange):watchChange instanceof ExistenceFilterChange?this.watchChangeAggregator.handleExistenceFilter(watchChange):(assert(watchChange instanceof WatchTargetChange,'Expected watchChange to be an instance of WatchTargetChange'),this.watchChangeAggregator.handleTargetChange(watchChange)),snapshotVersion.isEqual(SnapshotVersion.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return lastRemoteSnapshotVersion=_a.sent(),0<=snapshotVersion.compareTo(lastRemoteSnapshotVersion)?[4,this.raiseWatchSnapshot(snapshotVersion)]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2];}})})},RemoteStore.prototype.raiseWatchSnapshot=function(snapshotVersion){var _this=this;assert(!snapshotVersion.isEqual(SnapshotVersion.MIN),'Can\'t raise event for unknown SnapshotVersion');var remoteEvent=this.watchChangeAggregator.createRemoteEvent(snapshotVersion);return forEachNumber(remoteEvent.targetChanges,function(targetId,change){if(0<change.resumeToken.length){var queryData=_this.listenTargets[targetId];queryData&&(_this.listenTargets[targetId]=queryData.copy({resumeToken:change.resumeToken,snapshotVersion:snapshotVersion}))}}),remoteEvent.targetMismatches.forEach(function(targetId){var queryData=_this.listenTargets[targetId];if(queryData){_this.listenTargets[targetId]=queryData.copy({resumeToken:emptyByteString()}),_this.sendUnwatchRequest(targetId);var requestQueryData=new QueryData(queryData.query,targetId,QueryPurpose.ExistenceFilterMismatch,queryData.sequenceNumber);_this.sendWatchRequest(requestQueryData)}}),this.syncEngine.applyRemoteEvent(remoteEvent)},RemoteStore.prototype.handleTargetError=function(watchChange){var _this=this;assert(!!watchChange.cause,'Handling target error without a cause');var error$$1=watchChange.cause,promiseChain=Promise.resolve();return watchChange.targetIds.forEach(function(targetId){promiseChain=promiseChain.then(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return contains(this.listenTargets,targetId)?(delete this.listenTargets[targetId],this.watchChangeAggregator.removeTarget(targetId),[2,this.syncEngine.rejectListen(targetId,error$$1)]):[2]})})})}),promiseChain},RemoteStore.prototype.fillWritePipeline=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var lastBatchIdRetrieved,batch;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.canAddToWritePipeline()?(lastBatchIdRetrieved=0<this.writePipeline.length?this.writePipeline[this.writePipeline.length-1].batchId:BATCHID_UNKNOWN,[4,this.localStore.nextMutationBatch(lastBatchIdRetrieved)]):[3,4];case 1:return(batch=_a.sent(),null!==batch)?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(batch),[4,this.fillWritePipeline()];case 3:_a.sent(),_a.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2];}})})},RemoteStore.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},RemoteStore.prototype.outstandingWrites=function(){return this.writePipeline.length},RemoteStore.prototype.addToWritePipeline=function(batch){assert(this.canAddToWritePipeline(),'addToWritePipeline called when pipeline is full'),this.writePipeline.push(batch),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(batch.mutations)},RemoteStore.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&0<this.writePipeline.length},RemoteStore.prototype.startWriteStream=function(){assert(this.shouldStartWriteStream(),'startWriteStream() called when shouldStartWriteStream() is false.'),this.writeStream.start()},RemoteStore.prototype.onWriteStreamOpen=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.writeStream.writeHandshake(),[2]})})},RemoteStore.prototype.onWriteHandshakeComplete=function(){var _this=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var _i=0,_a=_this.writePipeline,batch;_i<_a.length;_i++)batch=_a[_i],_this.writeStream.writeMutations(batch.mutations)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},RemoteStore.prototype.ignoreIfPrimaryLeaseLoss=function(err){if(isPrimaryLeaseLostError(err))debug(LOG_TAG$8,'Unexpectedly lost primary lease');else throw err},RemoteStore.prototype.onMutationResult=function(commitVersion,results){var _this=this;assert(0<this.writePipeline.length,'Got result for empty write pipeline');var batch=this.writePipeline.shift(),success=MutationBatchResult.from(batch,commitVersion,results,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(success).then(function(){return _this.fillWritePipeline()})},RemoteStore.prototype.onWriteStreamClose=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,errorHandling;return tslib_1.__generator(this,function(){return void 0===error$$1&&assert(!this.shouldStartWriteStream(),'Write stream was stopped gracefully while still needed.'),error$$1&&0<this.writePipeline.length?(errorHandling=void 0,errorHandling=this.writeStream.handshakeComplete?this.handleWriteError(error$$1):this.handleHandshakeError(error$$1),[2,errorHandling.then(function(){_this.shouldStartWriteStream()&&_this.startWriteStream()})]):[2]})})},RemoteStore.prototype.handleHandshakeError=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this;return tslib_1.__generator(this,function(){return isPermanentError(error$$1.code)||error$$1.code===Code.ABORTED?(debug(LOG_TAG$8,'RemoteStore error before completed handshake; resetting stream token: ',this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=emptyByteString(),[2,this.localStore.setLastStreamToken(emptyByteString()).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})]):[2]})})},RemoteStore.prototype.handleWriteError=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,batch;return tslib_1.__generator(this,function(){return isPermanentError(error$$1.code)?(batch=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(batch.batchId,error$$1).then(function(){return _this.fillWritePipeline()})]):[2]})})},RemoteStore.prototype.createTransaction=function(){return new Transaction(this.datastore)},RemoteStore.prototype.handleCredentialChange=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.canUseNetwork()?(debug(LOG_TAG$8,'RemoteStore restarting streams for new credential'),this.networkEnabled=!1,[4,this.disableNetworkInternal()]):[3,3];case 1:return _a.sent(),this.onlineStateTracker.set(OnlineState.Unknown),[4,this.enableNetwork()];case 2:_a.sent(),_a.label=3;case 3:return[2];}})})},RemoteStore.prototype.applyPrimaryState=function(isPrimary){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.isPrimary=isPrimary,isPrimary&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return _a.sent(),[3,4];case 2:return isPrimary?[3,4]:[4,this.disableNetworkInternal()];case 3:_a.sent(),this.onlineStateTracker.set(OnlineState.Unknown),_a.label=4;case 4:return[2];}})})},RemoteStore}(),QueryListenersInfo=function(){return function QueryListenersInfo(){this.listeners=[]}}(),EventManager=function(){function EventManager(syncEngine){this.syncEngine=syncEngine,this.queries=new ObjectMap(function(q){return q.canonicalId()}),this.onlineState=OnlineState.Unknown,this.syncEngine.subscribe(this)}return EventManager.prototype.listen=function(listener){var query=listener.query,firstListen=!1,queryInfo=this.queries.get(query);return queryInfo||(firstListen=!0,queryInfo=new QueryListenersInfo,this.queries.set(query,queryInfo)),queryInfo.listeners.push(listener),listener.applyOnlineStateChange(this.onlineState),queryInfo.viewSnap&&listener.onViewSnapshot(queryInfo.viewSnap),firstListen?this.syncEngine.listen(query).then(function(targetId){return queryInfo.targetId=targetId,targetId}):Promise.resolve(queryInfo.targetId)},EventManager.prototype.unlisten=function(listener){return tslib_1.__awaiter(this,void 0,void 0,function(){var query,lastListen,queryInfo,i;return tslib_1.__generator(this,function(){return query=listener.query,lastListen=!1,queryInfo=this.queries.get(query),queryInfo&&(i=queryInfo.listeners.indexOf(listener),0<=i&&(queryInfo.listeners.splice(i,1),lastListen=0===queryInfo.listeners.length)),lastListen?(this.queries.delete(query),[2,this.syncEngine.unlisten(query)]):[2]})})},EventManager.prototype.onWatchChange=function(viewSnaps){for(var _i=0,viewSnaps_1=viewSnaps;_i<viewSnaps_1.length;_i++){var viewSnap=viewSnaps_1[_i],query=viewSnap.query,queryInfo=this.queries.get(query);if(queryInfo){for(var _a=0,_b=queryInfo.listeners,listener;_a<_b.length;_a++)listener=_b[_a],listener.onViewSnapshot(viewSnap);queryInfo.viewSnap=viewSnap}}},EventManager.prototype.onWatchError=function(query,error){var queryInfo=this.queries.get(query);if(queryInfo)for(var _i=0,_a=queryInfo.listeners,listener;_i<_a.length;_i++)listener=_a[_i],listener.onError(error);this.queries.delete(query)},EventManager.prototype.onOnlineStateChange=function(onlineState){this.onlineState=onlineState,this.queries.forEach(function(_,queryInfo){for(var _i=0,_a=queryInfo.listeners,listener;_i<_a.length;_i++)listener=_a[_i],listener.applyOnlineStateChange(onlineState)})},EventManager}(),QueryListener=function(){function QueryListener(query,queryObserver,options){this.query=query,this.queryObserver=queryObserver,this.raisedInitialEvent=!1,this.onlineState=OnlineState.Unknown,this.options=options||{}}return QueryListener.prototype.onViewSnapshot=function(snap){if(assert(0<snap.docChanges.length||snap.syncStateChanged,'We got a new snapshot with no changes?'),!this.options.includeMetadataChanges){for(var docChanges=[],_i=0,_a=snap.docChanges,docChange;_i<_a.length;_i++)docChange=_a[_i],docChange.type!==ChangeType.Metadata&&docChanges.push(docChange);snap=new ViewSnapshot(snap.query,snap.docs,snap.oldDocs,docChanges,snap.mutatedKeys,snap.fromCache,snap.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(snap)&&this.queryObserver.next(snap):this.shouldRaiseInitialEvent(snap,this.onlineState)&&this.raiseInitialEvent(snap),this.snap=snap},QueryListener.prototype.onError=function(error){this.queryObserver.error(error)},QueryListener.prototype.applyOnlineStateChange=function(onlineState){this.onlineState=onlineState,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,onlineState)&&this.raiseInitialEvent(this.snap)},QueryListener.prototype.shouldRaiseInitialEvent=function(snap,onlineState){if(assert(!this.raisedInitialEvent,'Determining whether to raise first event but already had first event'),!snap.fromCache)return!0;var maybeOnline=onlineState!==OnlineState.Offline;return this.options.waitForSyncWhenOnline&&maybeOnline?(assert(snap.fromCache,'Waiting for sync, but snapshot is not from cache'),!1):!snap.docs.isEmpty()||onlineState===OnlineState.Offline},QueryListener.prototype.shouldRaiseEvent=function(snap){if(0<snap.docChanges.length)return!0;var hasPendingWritesChanged=this.snap&&this.snap.hasPendingWrites!==snap.hasPendingWrites;return(snap.syncStateChanged||hasPendingWritesChanged)&&!0===this.options.includeMetadataChanges},QueryListener.prototype.raiseInitialEvent=function(snap){assert(!this.raisedInitialEvent,'Trying to raise initial events for second time'),snap=ViewSnapshot.fromInitialDocuments(snap.query,snap.docs,snap.mutatedKeys,snap.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(snap)},QueryListener}(),LocalViewChanges=function(){function LocalViewChanges(targetId,addedKeys,removedKeys){this.targetId=targetId,this.addedKeys=addedKeys,this.removedKeys=removedKeys}return LocalViewChanges.fromSnapshot=function(targetId,viewSnapshot){for(var addedKeys=documentKeySet(),removedKeys=documentKeySet(),_i=0,_a=viewSnapshot.docChanges,docChange;_i<_a.length;_i++)switch(docChange=_a[_i],docChange.type){case ChangeType.Added:addedKeys=addedKeys.add(docChange.doc.key);break;case ChangeType.Removed:removedKeys=removedKeys.add(docChange.doc.key);break;default:}return new LocalViewChanges(targetId,addedKeys,removedKeys)},LocalViewChanges}(),AddedLimboDocument=function(){return function AddedLimboDocument(key){this.key=key}}(),RemovedLimboDocument=function(){return function RemovedLimboDocument(key){this.key=key}}(),View=function(){function View(query,_syncedDocuments){this.query=query,this._syncedDocuments=_syncedDocuments,this.syncState=null,this.current=!1,this.limboDocuments=documentKeySet(),this.mutatedKeys=documentKeySet(),this.documentSet=new DocumentSet(query.docComparator.bind(query))}return Object.defineProperty(View.prototype,'syncedDocuments',{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),View.prototype.computeDocChanges=function(docChanges,previousChanges){var _this=this,changeSet=previousChanges?previousChanges.changeSet:new DocumentChangeSet,oldDocumentSet=previousChanges?previousChanges.documentSet:this.documentSet,newMutatedKeys=previousChanges?previousChanges.mutatedKeys:this.mutatedKeys,newDocumentSet=oldDocumentSet,needsRefill=!1,lastDocInLimit=this.query.hasLimit()&&oldDocumentSet.size===this.query.limit?oldDocumentSet.last():null;if(docChanges.inorderTraversal(function(key,newMaybeDoc){var oldDoc=oldDocumentSet.get(key),newDoc=newMaybeDoc instanceof Document?newMaybeDoc:null;newDoc&&(assert(key.isEqual(newDoc.key),'Mismatching keys found in document changes: '+key+' != '+newDoc.key),newDoc=_this.query.matches(newDoc)?newDoc:null);var oldDocHadPendingMutations=!!oldDoc&&_this.mutatedKeys.has(oldDoc.key),newDocHasPendingMutations=!!newDoc&&(newDoc.hasLocalMutations||_this.mutatedKeys.has(newDoc.key)&&newDoc.hasCommittedMutations),changeApplied=!1;if(oldDoc&&newDoc){var docsEqual=oldDoc.data.isEqual(newDoc.data);docsEqual?oldDocHadPendingMutations!==newDocHasPendingMutations&&(changeSet.track({type:ChangeType.Metadata,doc:newDoc}),changeApplied=!0):!_this.shouldWaitForSyncedDocument(oldDoc,newDoc)&&(changeSet.track({type:ChangeType.Modified,doc:newDoc}),changeApplied=!0,lastDocInLimit&&0<_this.query.docComparator(newDoc,lastDocInLimit)&&(needsRefill=!0))}else!oldDoc&&newDoc?(changeSet.track({type:ChangeType.Added,doc:newDoc}),changeApplied=!0):oldDoc&&!newDoc&&(changeSet.track({type:ChangeType.Removed,doc:oldDoc}),changeApplied=!0,lastDocInLimit&&(needsRefill=!0));changeApplied&&(newDoc?(newDocumentSet=newDocumentSet.add(newDoc),newMutatedKeys=newDocHasPendingMutations?newMutatedKeys.add(key):newMutatedKeys.delete(key)):(newDocumentSet=newDocumentSet.delete(key),newMutatedKeys=newMutatedKeys.delete(key)))}),this.query.hasLimit())for(;newDocumentSet.size>this.query.limit;){var oldDoc=newDocumentSet.last();newDocumentSet=newDocumentSet.delete(oldDoc.key),newMutatedKeys=newMutatedKeys.delete(oldDoc.key),changeSet.track({type:ChangeType.Removed,doc:oldDoc})}return assert(!needsRefill||!previousChanges,'View was refilled using docs that themselves needed refilling.'),{documentSet:newDocumentSet,changeSet:changeSet,needsRefill:needsRefill,mutatedKeys:newMutatedKeys}},View.prototype.shouldWaitForSyncedDocument=function(oldDoc,newDoc){return oldDoc.hasLocalMutations&&newDoc.hasCommittedMutations&&!newDoc.hasLocalMutations},View.prototype.applyChanges=function(docChanges,updateLimboDocuments,targetChange){var _this=this;assert(!docChanges.needsRefill,'Cannot apply changes that need a refill');var oldDocs=this.documentSet;this.documentSet=docChanges.documentSet,this.mutatedKeys=docChanges.mutatedKeys;var changes=docChanges.changeSet.getChanges();changes.sort(function(c1,c2){return compareChangeType(c1.type,c2.type)||_this.query.docComparator(c1.doc,c2.doc)}),this.applyTargetChange(targetChange);var limboChanges=updateLimboDocuments?this.updateLimboDocuments():[],synced=0===this.limboDocuments.size&&this.current,newSyncState=synced?SyncState.Synced:SyncState.Local,syncStateChanged=newSyncState!==this.syncState;if(this.syncState=newSyncState,0===changes.length&&!syncStateChanged)return{limboChanges:limboChanges};var snap=new ViewSnapshot(this.query,docChanges.documentSet,oldDocs,changes,docChanges.mutatedKeys,newSyncState===SyncState.Local,syncStateChanged,!1);return{snapshot:snap,limboChanges:limboChanges}},View.prototype.applyOnlineStateChange=function(onlineState){return this.current&&onlineState===OnlineState.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new DocumentChangeSet,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},View.prototype.shouldBeInLimbo=function(key){return!this._syncedDocuments.has(key)&&!!this.documentSet.has(key)&&!this.documentSet.get(key).hasLocalMutations},View.prototype.applyTargetChange=function(targetChange){var _this=this;targetChange&&(targetChange.addedDocuments.forEach(function(key){return _this._syncedDocuments=_this._syncedDocuments.add(key)}),targetChange.modifiedDocuments.forEach(function(key){return assert(_this._syncedDocuments.has(key),'Modified document '+key+' not found in view.')}),targetChange.removedDocuments.forEach(function(key){return _this._syncedDocuments=_this._syncedDocuments.delete(key)}),this.current=targetChange.current)},View.prototype.updateLimboDocuments=function(){var _this=this;if(!this.current)return[];var oldLimboDocuments=this.limboDocuments;this.limboDocuments=documentKeySet(),this.documentSet.forEach(function(doc){_this.shouldBeInLimbo(doc.key)&&(_this.limboDocuments=_this.limboDocuments.add(doc.key))});var changes=[];return oldLimboDocuments.forEach(function(key){_this.limboDocuments.has(key)||changes.push(new RemovedLimboDocument(key))}),this.limboDocuments.forEach(function(key){oldLimboDocuments.has(key)||changes.push(new AddedLimboDocument(key))}),changes},View.prototype.synchronizeWithPersistedState=function(localDocs,remoteKeys){this._syncedDocuments=remoteKeys,this.limboDocuments=documentKeySet();var docChanges=this.computeDocChanges(localDocs);return this.applyChanges(docChanges,!0)},View.prototype.computeInitialSnapshot=function(){return ViewSnapshot.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===SyncState.Local)},View}(),LOG_TAG$9='SyncEngine',QueryView=function(){return function QueryView(query,targetId,view){this.query=query,this.targetId=targetId,this.view=view}}(),LimboResolution=function(){return function LimboResolution(key){this.key=key}}(),SyncEngine=function(){function SyncEngine(localStore,remoteStore,sharedClientState,currentUser){this.localStore=localStore,this.remoteStore=remoteStore,this.sharedClientState=sharedClientState,this.currentUser=currentUser,this.syncEngineListener=null,this.queryViewsByQuery=new ObjectMap(function(q){return q.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new SortedMap(DocumentKey.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new ReferenceSet,this.mutationUserCallbacks={},this.limboTargetIdGenerator=TargetIdGenerator.forSyncEngine(),this.isPrimary=void 0,this.onlineState=OnlineState.Unknown}return Object.defineProperty(SyncEngine.prototype,'isPrimaryClient',{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),SyncEngine.prototype.subscribe=function(syncEngineListener){assert(null!==syncEngineListener,'SyncEngine listener cannot be null'),assert(null===this.syncEngineListener,'SyncEngine already has a subscriber.'),this.syncEngineListener=syncEngineListener},SyncEngine.prototype.listen=function(query){return tslib_1.__awaiter(this,void 0,void 0,function(){var targetId,viewSnapshot,queryView,queryData,status_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.assertSubscribed('listen()'),queryView=this.queryViewsByQuery.get(query),!queryView)?[3,1]:(targetId=queryView.targetId,this.sharedClientState.addLocalQueryTarget(targetId),viewSnapshot=queryView.view.computeInitialSnapshot(),[3,4]);case 1:return[4,this.localStore.allocateQuery(query)];case 2:return queryData=_a.sent(),status_1=this.sharedClientState.addLocalQueryTarget(queryData.targetId),targetId=queryData.targetId,[4,this.initializeViewAndComputeSnapshot(queryData,'current'===status_1)];case 3:viewSnapshot=_a.sent(),this.isPrimary&&this.remoteStore.listen(queryData),_a.label=4;case 4:return this.syncEngineListener.onWatchChange([viewSnapshot]),[2,targetId];}})})},SyncEngine.prototype.initializeViewAndComputeSnapshot=function(queryData,current){var _this=this,query=queryData.query;return this.localStore.executeQuery(query).then(function(docs){return _this.localStore.remoteDocumentKeys(queryData.targetId).then(function(remoteKeys){var view=new View(query,remoteKeys),viewDocChanges=view.computeDocChanges(docs),synthesizedTargetChange=TargetChange.createSynthesizedTargetChangeForCurrentChange(queryData.targetId,current&&_this.onlineState!==OnlineState.Offline),viewChange=view.applyChanges(viewDocChanges,!0===_this.isPrimary,synthesizedTargetChange);assert(0===viewChange.limboChanges.length,'View returned limbo docs before target ack from the server.'),assert(!!viewChange.snapshot,'applyChanges for new view should always return a snapshot');var data=new QueryView(query,queryData.targetId,view);return _this.queryViewsByQuery.set(query,data),_this.queryViewsByTarget[queryData.targetId]=data,viewChange.snapshot})})},SyncEngine.prototype.synchronizeViewAndComputeSnapshot=function(queryView){var _this=this;return this.localStore.executeQuery(queryView.query).then(function(docs){return _this.localStore.remoteDocumentKeys(queryView.targetId).then(function(remoteKeys){return tslib_1.__awaiter(_this,void 0,void 0,function(){var viewSnapshot;return tslib_1.__generator(this,function(){return viewSnapshot=queryView.view.synchronizeWithPersistedState(docs,remoteKeys),this.isPrimary&&this.updateTrackedLimbos(queryView.targetId,viewSnapshot.limboChanges),[2,viewSnapshot]})})})})},SyncEngine.prototype.unlisten=function(query){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,queryView,targetRemainsActive;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.assertSubscribed('unlisten()'),queryView=this.queryViewsByQuery.get(query),assert(!!queryView,'Trying to unlisten on query not found:'+query),!this.isPrimary)?[3,3]:(this.sharedClientState.removeLocalQueryTarget(queryView.targetId),targetRemainsActive=this.sharedClientState.isActiveQueryTarget(queryView.targetId),targetRemainsActive?[3,2]:[4,this.localStore.releaseQuery(query,!1).then(function(){_this.sharedClientState.clearQueryState(queryView.targetId),_this.remoteStore.unlisten(queryView.targetId),_this.removeAndCleanupQuery(queryView)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})]);case 1:_a.sent(),_a.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(queryView),[4,this.localStore.releaseQuery(query,!0)];case 4:_a.sent(),_a.label=5;case 5:return[2];}})})},SyncEngine.prototype.write=function(batch,userCallback){var _this=this;return this.assertSubscribed('write()'),this.localStore.localWrite(batch).then(function(result){return _this.sharedClientState.addPendingMutation(result.batchId),_this.addMutationCallback(result.batchId,userCallback),_this.emitNewSnapsAndNotifyLocalStore(result.changes)}).then(function(){return _this.remoteStore.fillWritePipeline()})},SyncEngine.prototype.wrapUpdateFunctionError=function(error$$1){return error$$1},SyncEngine.prototype.runTransaction=function(updateFunction,retries){var _this=this;void 0===retries&&(retries=5),assert(0<=retries,'Got negative number of retries for transaction.');var transaction=this.remoteStore.createTransaction();return function(){try{var userPromise=updateFunction(transaction);return!isNullOrUndefined(userPromise)&&userPromise.catch&&userPromise.then?userPromise.catch(function(e){return Promise.reject(_this.wrapUpdateFunctionError(e))}):Promise.reject(Error('Transaction callback must return a Promise'))}catch(e){return Promise.reject(_this.wrapUpdateFunctionError(e))}}().then(function(result){return transaction.commit().then(function(){return result}).catch(function(error$$1){return 0===retries?Promise.reject(error$$1):_this.runTransaction(updateFunction,retries-1)})})},SyncEngine.prototype.applyRemoteEvent=function(remoteEvent){var _this=this;return this.assertSubscribed('applyRemoteEvent()'),this.localStore.applyRemoteEvent(remoteEvent).then(function(changes){return forEach(remoteEvent.targetChanges,function(targetId,targetChange){var limboResolution=_this.limboResolutionsByTarget[targetId];limboResolution&&(assert(1>=targetChange.addedDocuments.size+targetChange.modifiedDocuments.size+targetChange.removedDocuments.size,'Limbo resolution for single document contains multiple changes.'),0<targetChange.addedDocuments.size?limboResolution.receivedDocument=!0:0<targetChange.modifiedDocuments.size?assert(limboResolution.receivedDocument,'Received change for limbo target document without add.'):0<targetChange.removedDocuments.size&&(assert(limboResolution.receivedDocument,'Received remove for limbo target document without add.'),limboResolution.receivedDocument=!1))}),_this.emitNewSnapsAndNotifyLocalStore(changes,remoteEvent)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},SyncEngine.prototype.applyOnlineStateChange=function(onlineState,source){if(this.isPrimary&&source===OnlineStateSource.RemoteStore||!this.isPrimary&&source===OnlineStateSource.SharedClientState){var newViewSnapshots_1=[];this.queryViewsByQuery.forEach(function(query,queryView){var viewChange=queryView.view.applyOnlineStateChange(onlineState);assert(0===viewChange.limboChanges.length,'OnlineState should not affect limbo documents.'),viewChange.snapshot&&newViewSnapshots_1.push(viewChange.snapshot)}),this.syncEngineListener.onOnlineStateChange(onlineState),this.syncEngineListener.onWatchChange(newViewSnapshots_1),this.onlineState=onlineState,this.isPrimary&&this.sharedClientState.setOnlineState(onlineState)}},SyncEngine.prototype.rejectListen=function(targetId,err){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,limboResolution,limboKey,documentUpdates,resolvedLimboDocuments,event_1,queryView_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.assertSubscribed('rejectListens()'),this.sharedClientState.updateQueryState(targetId,'rejected',err),limboResolution=this.limboResolutionsByTarget[targetId],limboKey=limboResolution&&limboResolution.key,!limboKey)?[3,1]:(this.limboTargetsByKey=this.limboTargetsByKey.remove(limboKey),delete this.limboResolutionsByTarget[targetId],documentUpdates=new SortedMap(DocumentKey.comparator),documentUpdates=documentUpdates.insert(limboKey,new NoDocument(limboKey,SnapshotVersion.forDeletedDoc())),resolvedLimboDocuments=documentKeySet().add(limboKey),event_1=new RemoteEvent(SnapshotVersion.MIN,{},new SortedSet(primitiveComparator),documentUpdates,resolvedLimboDocuments),[2,this.applyRemoteEvent(event_1)]);case 1:return queryView_1=this.queryViewsByTarget[targetId],assert(!!queryView_1,'Unknown targetId: '+targetId),[4,this.localStore.releaseQuery(queryView_1.query,!1).then(function(){return _this.removeAndCleanupQuery(queryView_1)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})];case 2:_a.sent(),this.syncEngineListener.onWatchError(queryView_1.query,err),_a.label=3;case 3:return[2];}})})},SyncEngine.prototype.applyBatchState=function(batchId,batchState,error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var documents;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.assertSubscribed('applyBatchState()'),[4,this.localStore.lookupMutationDocuments(batchId)];case 1:return documents=_a.sent(),null===documents?(debug(LOG_TAG$9,'Cannot apply mutation batch with id: '+batchId),[2]):'pending'===batchState?[4,this.remoteStore.fillWritePipeline()]:[3,3];case 2:return _a.sent(),[3,4];case 3:'acknowledged'===batchState||'rejected'===batchState?(this.processUserCallback(batchId,error$$1?error$$1:null),this.localStore.removeCachedMutationBatchMetadata(batchId)):fail('Unknown batchState: '+batchState),_a.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(documents)];case 5:return _a.sent(),[2];}})})},SyncEngine.prototype.applySuccessfulWrite=function(mutationBatchResult){var _this=this;this.assertSubscribed('applySuccessfulWrite()');var batchId=mutationBatchResult.batch.batchId;return this.processUserCallback(batchId,null),this.localStore.acknowledgeBatch(mutationBatchResult).then(function(changes){return _this.sharedClientState.updateMutationState(batchId,'acknowledged'),_this.emitNewSnapsAndNotifyLocalStore(changes)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},SyncEngine.prototype.rejectFailedWrite=function(batchId,error$$1){var _this=this;return this.assertSubscribed('rejectFailedWrite()'),this.processUserCallback(batchId,error$$1),this.localStore.rejectBatch(batchId).then(function(changes){return _this.sharedClientState.updateMutationState(batchId,'rejected',error$$1),_this.emitNewSnapsAndNotifyLocalStore(changes)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},SyncEngine.prototype.addMutationCallback=function(batchId,callback){var newCallbacks=this.mutationUserCallbacks[this.currentUser.toKey()];newCallbacks||(newCallbacks=new SortedMap(primitiveComparator)),newCallbacks=newCallbacks.insert(batchId,callback),this.mutationUserCallbacks[this.currentUser.toKey()]=newCallbacks},SyncEngine.prototype.processUserCallback=function(batchId,error$$1){var newCallbacks=this.mutationUserCallbacks[this.currentUser.toKey()];if(newCallbacks){var callback=newCallbacks.get(batchId);callback&&(assert(batchId===newCallbacks.minKey(),'Mutation callbacks processed out-of-order?'),error$$1?callback.reject(error$$1):callback.resolve(),newCallbacks=newCallbacks.remove(batchId)),this.mutationUserCallbacks[this.currentUser.toKey()]=newCallbacks}},SyncEngine.prototype.removeAndCleanupQuery=function(queryView){var _this=this;if(this.sharedClientState.removeLocalQueryTarget(queryView.targetId),this.queryViewsByQuery.delete(queryView.query),delete this.queryViewsByTarget[queryView.targetId],this.isPrimary){var limboKeys=this.limboDocumentRefs.referencesForId(queryView.targetId);this.limboDocumentRefs.removeReferencesForId(queryView.targetId),limboKeys.forEach(function(limboKey){var isReferenced=_this.limboDocumentRefs.containsKey(limboKey);isReferenced||_this.removeLimboTarget(limboKey)})}},SyncEngine.prototype.removeLimboTarget=function(key){var limboTargetId=this.limboTargetsByKey.get(key);null===limboTargetId||(this.remoteStore.unlisten(limboTargetId),this.limboTargetsByKey=this.limboTargetsByKey.remove(key),delete this.limboResolutionsByTarget[limboTargetId])},SyncEngine.prototype.updateTrackedLimbos=function(targetId,limboChanges){for(var _i=0,limboChanges_1=limboChanges,limboChange;_i<limboChanges_1.length;_i++)if(limboChange=limboChanges_1[_i],limboChange instanceof AddedLimboDocument)this.limboDocumentRefs.addReference(limboChange.key,targetId),this.trackLimboChange(limboChange);else if(limboChange instanceof RemovedLimboDocument){debug(LOG_TAG$9,'Document no longer in limbo: '+limboChange.key),this.limboDocumentRefs.removeReference(limboChange.key,targetId);var isReferenced=this.limboDocumentRefs.containsKey(limboChange.key);isReferenced||this.removeLimboTarget(limboChange.key)}else fail('Unknown limbo change: '+JSON.stringify(limboChange))},SyncEngine.prototype.trackLimboChange=function(limboChange){var key=limboChange.key;if(!this.limboTargetsByKey.get(key)){debug(LOG_TAG$9,'New document in limbo: '+key);var limboTargetId=this.limboTargetIdGenerator.next(),query=Query.atPath(key.path);this.limboResolutionsByTarget[limboTargetId]=new LimboResolution(key),this.remoteStore.listen(new QueryData(query,limboTargetId,QueryPurpose.LimboResolution,ListenSequence.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(key,limboTargetId)}},SyncEngine.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},SyncEngine.prototype.emitNewSnapsAndNotifyLocalStore=function(changes,remoteEvent){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,newSnaps,docChangesInAllViews,queriesProcessed;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return newSnaps=[],docChangesInAllViews=[],queriesProcessed=[],this.queryViewsByQuery.forEach(function(_,queryView){queriesProcessed.push(Promise.resolve().then(function(){var viewDocChanges=queryView.view.computeDocChanges(changes);return viewDocChanges.needsRefill?_this.localStore.executeQuery(queryView.query).then(function(docs){return queryView.view.computeDocChanges(docs,viewDocChanges)}):viewDocChanges}).then(function(viewDocChanges){var targetChange=remoteEvent&&remoteEvent.targetChanges[queryView.targetId],viewChange=queryView.view.applyChanges(viewDocChanges,!0===_this.isPrimary,targetChange);if(_this.updateTrackedLimbos(queryView.targetId,viewChange.limboChanges),viewChange.snapshot){_this.isPrimary&&_this.sharedClientState.updateQueryState(queryView.targetId,viewChange.snapshot.fromCache?'not-current':'current'),newSnaps.push(viewChange.snapshot);var docChanges=LocalViewChanges.fromSnapshot(queryView.targetId,viewChange.snapshot);docChangesInAllViews.push(docChanges)}}))}),[4,Promise.all(queriesProcessed)];case 1:return _a.sent(),this.syncEngineListener.onWatchChange(newSnaps),[4,this.localStore.notifyLocalViewChanges(docChangesInAllViews)];case 2:return _a.sent(),[2];}})})},SyncEngine.prototype.ignoreIfPrimaryLeaseLoss=function(err){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){if(isPrimaryLeaseLostError(err))debug(LOG_TAG$9,'Unexpectedly lost primary lease');else throw err;return[2]})})},SyncEngine.prototype.assertSubscribed=function(fnName){assert(null!==this.syncEngineListener,'Trying to call '+fnName+' before calling subscribe().')},SyncEngine.prototype.handleCredentialChange=function(user){return tslib_1.__awaiter(this,void 0,void 0,function(){var userChanged,result;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return userChanged=!this.currentUser.isEqual(user),this.currentUser=user,userChanged?[4,this.localStore.handleUserChange(user)]:[3,3];case 1:return result=_a.sent(),this.sharedClientState.handleUserChange(user,result.removedBatchIds,result.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(result.affectedDocuments)];case 2:_a.sent(),_a.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return _a.sent(),[2];}})})},SyncEngine.prototype.applyPrimaryState=function(isPrimary){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,activeTargets,activeQueries,_i,activeQueries_1,queryData,activeTargets_1,p_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return!0!==isPrimary||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return _a.sent(),activeTargets=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(activeTargets.toArray())];case 2:for(activeQueries=_a.sent(),_i=0,activeQueries_1=activeQueries;_i<activeQueries_1.length;_i++)queryData=activeQueries_1[_i],this.remoteStore.listen(queryData);return[3,7];case 3:return!1!==isPrimary||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,activeTargets_1=[],p_1=Promise.resolve(),forEachNumber(this.queryViewsByTarget,function(targetId,queryView){_this.sharedClientState.isLocalQueryTarget(targetId)?activeTargets_1.push(targetId):p_1=p_1.then(function(){return _this.unlisten(queryView.query)}),_this.remoteStore.unlisten(queryView.targetId)}),[4,p_1]);case 4:return _a.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(activeTargets_1)];case 5:return _a.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:_a.sent(),_a.label=7;case 7:return[2];}})})},SyncEngine.prototype.resetLimboDocuments=function(){var _this=this;forEachNumber(this.limboResolutionsByTarget,function(targetId){_this.remoteStore.unlisten(targetId)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new SortedMap(DocumentKey.comparator)},SyncEngine.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(targets){for(var _this=this,p=Promise.resolve(),activeQueries=[],newViewSnapshots=[],_loop_1=function(targetId){p=p.then(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){var queryData,queryView,viewChange,query;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return queryView=this.queryViewsByTarget[targetId],queryView?[4,this.localStore.releaseQuery(queryView.query,!0)]:[3,4];case 1:return _a.sent(),[4,this.localStore.allocateQuery(queryView.query)];case 2:return queryData=_a.sent(),[4,this.synchronizeViewAndComputeSnapshot(queryView)];case 3:return viewChange=_a.sent(),viewChange.snapshot&&newViewSnapshots.push(viewChange.snapshot),[3,8];case 4:return assert(!0===this.isPrimary,'A secondary tab should never have an active query without an active view.'),[4,this.localStore.getQueryForTarget(targetId)];case 5:return query=_a.sent(),assert(!!query,'Query data for target '+targetId+' not found'),[4,this.localStore.allocateQuery(query)];case 6:return queryData=_a.sent(),[4,this.initializeViewAndComputeSnapshot(queryData,!1)];case 7:_a.sent(),_a.label=8;case 8:return activeQueries.push(queryData),[2];}})})})},_i=0,targets_1=targets,targetId;_i<targets_1.length;_i++)targetId=targets_1[_i],_loop_1(targetId);return p.then(function(){return _this.syncEngineListener.onWatchChange(newViewSnapshots),activeQueries})},SyncEngine.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},SyncEngine.prototype.applyTargetState=function(targetId,state,error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,_a,queryView;return tslib_1.__generator(this,function(_b){switch(_b.label){case 0:return this.isPrimary?(debug(LOG_TAG$9,'Ignoring unexpected query state notification.'),[2]):this.queryViewsByTarget[targetId]?(_a=state,'current'===_a?[3,1]:'not-current'===_a?[3,1]:'rejected'===_a?[3,2]:[3,4]):[3,5];case 1:return[2,this.localStore.getNewDocumentChanges().then(function(changes){return tslib_1.__awaiter(_this,void 0,void 0,function(){var synthesizedRemoteEvent;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return synthesizedRemoteEvent=RemoteEvent.createSynthesizedRemoteEventForCurrentChange(targetId,'current'===state),[4,this.emitNewSnapsAndNotifyLocalStore(changes,synthesizedRemoteEvent)];case 1:return _a.sent(),[2];}})})},function(err){return tslib_1.__awaiter(_this,void 0,void 0,function(){var activeTargets_2;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return isDocumentChangeMissingError(err)?(activeTargets_2=[],forEachNumber(this.queryViewsByTarget,function(target){return activeTargets_2.push(target)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(activeTargets_2)]):[3,2];case 1:return _a.sent(),[3,3];case 2:throw err;case 3:return[2];}})})})];_b.label=2;case 2:return queryView=this.queryViewsByTarget[targetId],this.removeAndCleanupQuery(queryView),[4,this.localStore.releaseQuery(queryView.query,!0)];case 3:return _b.sent(),this.syncEngineListener.onWatchError(queryView.query,error$$1),[3,5];case 4:fail('Unexpected target state: '+state),_b.label=5;case 5:return[2];}})})},SyncEngine.prototype.applyActiveTargetsChange=function(added,removed){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,_i,added_1,targetId,query,queryData,_loop_2,this_1,_a,removed_1,targetId;return tslib_1.__generator(this,function(_b){switch(_b.label){case 0:if(!this.isPrimary)return[2];_i=0,added_1=added,_b.label=1;case 1:return _i<added_1.length?(targetId=added_1[_i],assert(!this.queryViewsByTarget[targetId],'Trying to add an already active target'),[4,this.localStore.getQueryForTarget(targetId)]):[3,6];case 2:return query=_b.sent(),assert(!!query,'Query data for active target '+targetId+' not found'),[4,this.localStore.allocateQuery(query)];case 3:return queryData=_b.sent(),[4,this.initializeViewAndComputeSnapshot(queryData,!1)];case 4:_b.sent(),this.remoteStore.listen(queryData),_b.label=5;case 5:return _i++,[3,1];case 6:_loop_2=function(targetId){var queryView;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return queryView=this_1.queryViewsByTarget[targetId],queryView?[4,this_1.localStore.releaseQuery(queryView.query,!1).then(function(){_this.remoteStore.unlisten(targetId),_this.removeAndCleanupQuery(queryView)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2];}})},this_1=this,_a=0,removed_1=removed,_b.label=7;case 7:return _a<removed_1.length?(targetId=removed_1[_a],[5,_loop_2(targetId)]):[3,10];case 8:_b.sent(),_b.label=9;case 9:return _a++,[3,7];case 10:return[2];}})})},SyncEngine.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},SyncEngine.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},SyncEngine.prototype.getRemoteKeysForTarget=function(targetId){var limboResolution=this.limboResolutionsByTarget[targetId];return limboResolution&&limboResolution.receivedDocument?documentKeySet().add(limboResolution.key):this.queryViewsByTarget[targetId]?this.queryViewsByTarget[targetId].view.syncedDocuments:documentKeySet()},SyncEngine}(),User=function(){function User(uid){this.uid=uid}return User.prototype.isAuthenticated=function(){return null!=this.uid},User.prototype.toKey=function(){return this.isAuthenticated()?'uid:'+this.uid:'anonymous-user'},User.prototype.isEqual=function(otherUser){return otherUser.uid===this.uid},User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User('google-credentials-uid'),User.FIRST_PARTY=new User('first-party-uid'),User}(),LOG_TAG$10='SharedClientState',CLIENT_STATE_KEY_PREFIX='firestore_clients',MUTATION_BATCH_KEY_PREFIX='firestore_mutations',QUERY_TARGET_KEY_PREFIX='firestore_targets',MutationMetadata=function(){function MutationMetadata(user,batchId,state,error$$1){this.user=user,this.batchId=batchId,this.state=state,this.error=error$$1,assert(void 0!==error$$1==('rejected'===state),'MutationMetadata must contain an error iff state is \'rejected\'')}return MutationMetadata.fromWebStorageEntry=function(user,batchId,value){var mutationBatch=JSON.parse(value),validData='object'==typeof mutationBatch&&-1!==['pending','acknowledged','rejected'].indexOf(mutationBatch.state)&&(void 0===mutationBatch.error||'object'==typeof mutationBatch.error),firestoreError=void 0;return validData&&mutationBatch.error&&(validData='string'==typeof mutationBatch.error.message&&'string'==typeof mutationBatch.error.code,validData&&(firestoreError=new FirestoreError(mutationBatch.error.code,mutationBatch.error.message))),validData?new MutationMetadata(user,batchId,mutationBatch.state,firestoreError):(error(LOG_TAG$10,'Failed to parse mutation state for ID \''+batchId+'\': '+value),null)},MutationMetadata.prototype.toWebStorageJSON=function(){var batchMetadata={state:this.state,updateTimeMs:Date.now()};return this.error&&(batchMetadata.error={code:this.error.code,message:this.error.message}),JSON.stringify(batchMetadata)},MutationMetadata}(),QueryTargetMetadata=function(){function QueryTargetMetadata(targetId,state,error$$1){this.targetId=targetId,this.state=state,this.error=error$$1,assert(void 0!==error$$1==('rejected'===state),'QueryTargetMetadata must contain an error iff state is \'rejected\'')}return QueryTargetMetadata.fromWebStorageEntry=function(targetId,value){var targetState=JSON.parse(value),validData='object'==typeof targetState&&-1!==['not-current','current','rejected'].indexOf(targetState.state)&&(void 0===targetState.error||'object'==typeof targetState.error),firestoreError=void 0;return validData&&targetState.error&&(validData='string'==typeof targetState.error.message&&'string'==typeof targetState.error.code,validData&&(firestoreError=new FirestoreError(targetState.error.code,targetState.error.message))),validData?new QueryTargetMetadata(targetId,targetState.state,firestoreError):(error(LOG_TAG$10,'Failed to parse target state for ID \''+targetId+'\': '+value),null)},QueryTargetMetadata.prototype.toWebStorageJSON=function(){var targetState={state:this.state,updateTimeMs:Date.now()};return this.error&&(targetState.error={code:this.error.code,message:this.error.message}),JSON.stringify(targetState)},QueryTargetMetadata}(),RemoteClientState=function(){function RemoteClientState(clientId,activeTargetIds){this.clientId=clientId,this.activeTargetIds=activeTargetIds}return RemoteClientState.fromWebStorageEntry=function(clientId,value){for(var clientState=JSON.parse(value),validData='object'==typeof clientState&&clientState.activeTargetIds instanceof Array,activeTargetIdsSet=targetIdSet(),i=0;validData&&i<clientState.activeTargetIds.length;++i)validData=isSafeInteger(clientState.activeTargetIds[i]),activeTargetIdsSet=activeTargetIdsSet.add(clientState.activeTargetIds[i]);return validData?new RemoteClientState(clientId,activeTargetIdsSet):(error(LOG_TAG$10,'Failed to parse client data for instance \''+clientId+'\': '+value),null)},RemoteClientState}(),SharedOnlineState=function(){function SharedOnlineState(clientId,onlineState){this.clientId=clientId,this.onlineState=onlineState}return SharedOnlineState.fromWebStorageEntry=function(value){var onlineState=JSON.parse(value),validData='object'==typeof onlineState&&void 0!==OnlineState[onlineState.onlineState]&&'string'==typeof onlineState.clientId;return validData?new SharedOnlineState(onlineState.clientId,OnlineState[onlineState.onlineState]):(error(LOG_TAG$10,'Failed to parse online state: '+value),null)},SharedOnlineState}(),LocalClientState=function(){function LocalClientState(){this.activeTargetIds=targetIdSet()}return LocalClientState.prototype.addQueryTarget=function(targetId){assert(!this.activeTargetIds.has(targetId),'Target with ID \''+targetId+'\' already active.'),this.activeTargetIds=this.activeTargetIds.add(targetId)},LocalClientState.prototype.removeQueryTarget=function(targetId){this.activeTargetIds=this.activeTargetIds.delete(targetId)},LocalClientState.prototype.toWebStorageJSON=function(){var data={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(data)},LocalClientState}(),WebStorageSharedClientState=function(){function WebStorageSharedClientState(queue,platform,persistenceKey,localClientId,initialUser){if(this.queue=queue,this.platform=platform,this.persistenceKey=persistenceKey,this.localClientId=localClientId,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!WebStorageSharedClientState.isAvailable(this.platform))throw new FirestoreError(Code.UNIMPLEMENTED,'LocalStorage is not available on this platform.');var escapedPersistenceKey=persistenceKey.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');this.storage=this.platform.window.localStorage,this.currentUser=initialUser,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey='firestore_sequence_number'+'_'+persistenceKey,this.activeClients[this.localClientId]=new LocalClientState,this.clientStateKeyRe=new RegExp('^'+CLIENT_STATE_KEY_PREFIX+'_'+escapedPersistenceKey+'_([^_]*)$'),this.mutationBatchKeyRe=new RegExp('^'+MUTATION_BATCH_KEY_PREFIX+'_'+escapedPersistenceKey+'_(\\d+)(?:_(.*))?$'),this.queryTargetKeyRe=new RegExp('^'+QUERY_TARGET_KEY_PREFIX+'_'+escapedPersistenceKey+'_(\\d+)$'),this.onlineStateKey='firestore_online_state'+'_'+persistenceKey,this.platform.window.addEventListener('storage',this.storageListener)}return WebStorageSharedClientState.isAvailable=function(platform){return!!(platform.window&&null!=platform.window.localStorage)},WebStorageSharedClientState.prototype.start=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,existingClients,_i,existingClients_1,clientId,storageItem,clientState,onlineStateJSON,onlineState,_a,_b,event_1;return tslib_1.__generator(this,function(_c){switch(_c.label){case 0:return assert(!this.started,'WebStorageSharedClientState already started'),assert(null!==this.syncEngine,'syncEngine property must be set before calling start()'),assert(null!==this.onlineStateHandler,'onlineStateHandler property must be set before calling start()'),[4,this.syncEngine.getActiveClients()];case 1:for(existingClients=_c.sent(),_i=0,existingClients_1=existingClients;_i<existingClients_1.length;_i++)(clientId=existingClients_1[_i],clientId!==this.localClientId)&&(storageItem=this.getItem(this.toWebStorageClientStateKey(clientId)),storageItem&&(clientState=RemoteClientState.fromWebStorageEntry(clientId,storageItem),clientState&&(this.activeClients[clientState.clientId]=clientState)));for(this.persistClientState(),onlineStateJSON=this.storage.getItem(this.onlineStateKey),onlineStateJSON&&(onlineState=this.fromWebStorageOnlineState(onlineStateJSON),onlineState&&this.handleOnlineStateEvent(onlineState)),(_a=0,_b=this.earlyEvents);_a<_b.length;_a++)event_1=_b[_a],this.handleWebStorageEvent(event_1);return this.earlyEvents=[],this.platform.window.addEventListener('unload',function(){return _this.shutdown()}),this.started=!0,[2];}})})},WebStorageSharedClientState.prototype.writeSequenceNumber=function(sequenceNumber){this.setItem(this.sequenceNumberKey,JSON.stringify(sequenceNumber))},WebStorageSharedClientState.prototype.getAllActiveQueryTargets=function(){var activeTargets=targetIdSet();return forEach(this.activeClients,function(key,value){activeTargets=activeTargets.unionWith(value.activeTargetIds)}),activeTargets},WebStorageSharedClientState.prototype.isActiveQueryTarget=function(targetId){for(var clientId in this.activeClients)if(this.activeClients.hasOwnProperty(clientId)&&this.activeClients[clientId].activeTargetIds.has(targetId))return!0;return!1},WebStorageSharedClientState.prototype.addPendingMutation=function(batchId){this.persistMutationState(batchId,'pending')},WebStorageSharedClientState.prototype.updateMutationState=function(batchId,state,error$$1){this.persistMutationState(batchId,state,error$$1),this.removeMutationState(batchId)},WebStorageSharedClientState.prototype.addLocalQueryTarget=function(targetId){var queryState='not-current';if(this.isActiveQueryTarget(targetId)){var storageItem=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(targetId));if(storageItem){var metadata=QueryTargetMetadata.fromWebStorageEntry(targetId,storageItem);metadata&&(queryState=metadata.state)}}return this.localClientState.addQueryTarget(targetId),this.persistClientState(),queryState},WebStorageSharedClientState.prototype.removeLocalQueryTarget=function(targetId){this.localClientState.removeQueryTarget(targetId),this.persistClientState()},WebStorageSharedClientState.prototype.isLocalQueryTarget=function(targetId){return this.localClientState.activeTargetIds.has(targetId)},WebStorageSharedClientState.prototype.clearQueryState=function(targetId){this.removeItem(this.toWebStorageQueryTargetMetadataKey(targetId))},WebStorageSharedClientState.prototype.updateQueryState=function(targetId,state,error$$1){this.persistQueryTargetState(targetId,state,error$$1)},WebStorageSharedClientState.prototype.handleUserChange=function(user,removedBatchIds,addedBatchIds){var _this=this;removedBatchIds.forEach(function(batchId){_this.removeMutationState(batchId)}),this.currentUser=user,addedBatchIds.forEach(function(batchId){_this.addPendingMutation(batchId)})},WebStorageSharedClientState.prototype.setOnlineState=function(onlineState){this.persistOnlineState(onlineState)},WebStorageSharedClientState.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener('storage',this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},WebStorageSharedClientState.prototype.getItem=function(key){var value=this.storage.getItem(key);return debug(LOG_TAG$10,'READ',key,value),value},WebStorageSharedClientState.prototype.setItem=function(key,value){debug(LOG_TAG$10,'SET',key,value),this.storage.setItem(key,value)},WebStorageSharedClientState.prototype.removeItem=function(key){debug(LOG_TAG$10,'REMOVE',key),this.storage.removeItem(key)},WebStorageSharedClientState.prototype.handleWebStorageEvent=function(event){var _this=this;if(event.storageArea===this.storage){if(debug(LOG_TAG$10,'EVENT',event.key,event.newValue),event.key===this.localClientStorageKey)return void error('Received WebStorage notification for local change. Another client might have '+'garbage-collected our state');this.queue.enqueueAndForget(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){var clientState,clientId,mutationMetadata,queryTargetMetadata,onlineState,sequenceNumber;return tslib_1.__generator(this,function(){if(!this.started)return this.earlyEvents.push(event),[2];if(null===event.key)return[2];if(this.clientStateKeyRe.test(event.key)){if(null==event.newValue)return clientId=this.fromWebStorageClientStateKey(event.key),[2,this.handleClientStateEvent(clientId,null)];if(clientState=this.fromWebStorageClientState(event.key,event.newValue),clientState)return[2,this.handleClientStateEvent(clientState.clientId,clientState)]}else if(this.mutationBatchKeyRe.test(event.key)){if(null!==event.newValue&&(mutationMetadata=this.fromWebStorageMutationMetadata(event.key,event.newValue),mutationMetadata))return[2,this.handleMutationBatchEvent(mutationMetadata)];}else if(this.queryTargetKeyRe.test(event.key)){if(null!==event.newValue&&(queryTargetMetadata=this.fromWebStorageQueryTargetMetadata(event.key,event.newValue),queryTargetMetadata))return[2,this.handleQueryTargetEvent(queryTargetMetadata)];}else if(event.key!==this.onlineStateKey)event.key===this.sequenceNumberKey&&(assert(!!this.sequenceNumberHandler,'Missing sequenceNumberHandler'),sequenceNumber=fromWebStorageSequenceNumber(event.newValue),sequenceNumber!==ListenSequence.INVALID&&this.sequenceNumberHandler(sequenceNumber));else if(null!==event.newValue&&(onlineState=this.fromWebStorageOnlineState(event.newValue),onlineState))return[2,this.handleOnlineStateEvent(onlineState)];return[2]})})})}},Object.defineProperty(WebStorageSharedClientState.prototype,'localClientState',{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),WebStorageSharedClientState.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},WebStorageSharedClientState.prototype.persistMutationState=function(batchId,state,error$$1){var mutationState=new MutationMetadata(this.currentUser,batchId,state,error$$1),mutationKey=this.toWebStorageMutationBatchKey(batchId);this.setItem(mutationKey,mutationState.toWebStorageJSON())},WebStorageSharedClientState.prototype.removeMutationState=function(batchId){var mutationKey=this.toWebStorageMutationBatchKey(batchId);this.removeItem(mutationKey)},WebStorageSharedClientState.prototype.persistOnlineState=function(onlineState){var entry={clientId:this.localClientId,onlineState:OnlineState[onlineState]};this.storage.setItem(this.onlineStateKey,JSON.stringify(entry))},WebStorageSharedClientState.prototype.persistQueryTargetState=function(targetId,state,error$$1){var targetKey=this.toWebStorageQueryTargetMetadataKey(targetId),targetMetadata=new QueryTargetMetadata(targetId,state,error$$1);this.setItem(targetKey,targetMetadata.toWebStorageJSON())},WebStorageSharedClientState.prototype.toWebStorageClientStateKey=function(clientId){return assert(-1===clientId.indexOf('_'),'Client key cannot contain \'_\', but was \''+clientId+'\''),CLIENT_STATE_KEY_PREFIX+'_'+this.persistenceKey+'_'+clientId},WebStorageSharedClientState.prototype.toWebStorageQueryTargetMetadataKey=function(targetId){return QUERY_TARGET_KEY_PREFIX+'_'+this.persistenceKey+'_'+targetId},WebStorageSharedClientState.prototype.toWebStorageMutationBatchKey=function(batchId){var mutationKey=MUTATION_BATCH_KEY_PREFIX+'_'+this.persistenceKey+'_'+batchId;return this.currentUser.isAuthenticated()&&(mutationKey+='_'+this.currentUser.uid),mutationKey},WebStorageSharedClientState.prototype.fromWebStorageClientStateKey=function(key){var match=this.clientStateKeyRe.exec(key);return match?match[1]:null},WebStorageSharedClientState.prototype.fromWebStorageClientState=function(key,value){var clientId=this.fromWebStorageClientStateKey(key);return assert(null!==clientId,'Cannot parse client state key \''+key+'\''),RemoteClientState.fromWebStorageEntry(clientId,value)},WebStorageSharedClientState.prototype.fromWebStorageMutationMetadata=function(key,value){var match=this.mutationBatchKeyRe.exec(key);assert(null!==match,'Cannot parse mutation batch key \''+key+'\'');var batchId=+match[1],userId=void 0===match[2]?null:match[2];return MutationMetadata.fromWebStorageEntry(new User(userId),batchId,value)},WebStorageSharedClientState.prototype.fromWebStorageQueryTargetMetadata=function(key,value){var match=this.queryTargetKeyRe.exec(key);assert(null!==match,'Cannot parse query target key \''+key+'\'');var targetId=+match[1];return QueryTargetMetadata.fromWebStorageEntry(targetId,value)},WebStorageSharedClientState.prototype.fromWebStorageOnlineState=function(value){return SharedOnlineState.fromWebStorageEntry(value)},WebStorageSharedClientState.prototype.handleMutationBatchEvent=function(mutationBatch){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return mutationBatch.user.uid===this.currentUser.uid?[2,this.syncEngine.applyBatchState(mutationBatch.batchId,mutationBatch.state,mutationBatch.error)]:(debug(LOG_TAG$10,'Ignoring mutation for non-active user '+mutationBatch.user.uid),[2])})})},WebStorageSharedClientState.prototype.handleQueryTargetEvent=function(targetMetadata){return this.syncEngine.applyTargetState(targetMetadata.targetId,targetMetadata.state,targetMetadata.error)},WebStorageSharedClientState.prototype.handleClientStateEvent=function(clientId,clientState){var _this=this,existingTargets=this.getAllActiveQueryTargets();clientState?this.activeClients[clientId]=clientState:delete this.activeClients[clientId];var newTargets=this.getAllActiveQueryTargets(),addedTargets=[],removedTargets=[];return newTargets.forEach(function(targetId){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return existingTargets.has(targetId)||addedTargets.push(targetId),[2]})})}),existingTargets.forEach(function(targetId){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return newTargets.has(targetId)||removedTargets.push(targetId),[2]})})}),this.syncEngine.applyActiveTargetsChange(addedTargets,removedTargets)},WebStorageSharedClientState.prototype.handleOnlineStateEvent=function(onlineState){this.activeClients[onlineState.clientId]&&this.onlineStateHandler(onlineState.onlineState)},WebStorageSharedClientState}(),MemorySharedClientState=function(){function MemorySharedClientState(){this.localState=new LocalClientState,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return MemorySharedClientState.prototype.addPendingMutation=function(){},MemorySharedClientState.prototype.updateMutationState=function(){},MemorySharedClientState.prototype.addLocalQueryTarget=function(targetId){return this.localState.addQueryTarget(targetId),this.queryState[targetId]||'not-current'},MemorySharedClientState.prototype.updateQueryState=function(targetId,state){this.queryState[targetId]=state},MemorySharedClientState.prototype.removeLocalQueryTarget=function(targetId){this.localState.removeQueryTarget(targetId)},MemorySharedClientState.prototype.isLocalQueryTarget=function(targetId){return this.localState.activeTargetIds.has(targetId)},MemorySharedClientState.prototype.clearQueryState=function(targetId){delete this.queryState[targetId]},MemorySharedClientState.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},MemorySharedClientState.prototype.isActiveQueryTarget=function(targetId){return this.localState.activeTargetIds.has(targetId)},MemorySharedClientState.prototype.start=function(){return this.localState=new LocalClientState,Promise.resolve()},MemorySharedClientState.prototype.handleUserChange=function(){},MemorySharedClientState.prototype.setOnlineState=function(){},MemorySharedClientState.prototype.shutdown=function(){},MemorySharedClientState.prototype.writeSequenceNumber=function(){},MemorySharedClientState}(),LOG_TAG$11='FirestoreClient',FirestoreClient=function(){function FirestoreClient(platform,databaseInfo,credentials,asyncQueue){this.platform=platform,this.databaseInfo=databaseInfo,this.credentials=credentials,this.asyncQueue=asyncQueue,this.clientId=AutoId.newId()}return FirestoreClient.prototype.start=function(persistenceSettings){var _this=this,initializationDone=new Deferred$1,persistenceResult=new Deferred$1,initialized=!1;return this.credentials.setChangeListener(function(user){initialized?_this.asyncQueue.enqueueAndForget(function(){return _this.handleCredentialChange(user)}):(initialized=!0,_this.initializePersistence(persistenceSettings,persistenceResult,user).then(function(){return _this.initializeRest(user)}).then(initializationDone.resolve,initializationDone.reject))}),this.asyncQueue.enqueueAndForget(function(){return initializationDone.promise}),persistenceResult.promise},FirestoreClient.prototype.enableNetwork=function(){var _this=this;return this.asyncQueue.enqueue(function(){return _this.syncEngine.enableNetwork()})},FirestoreClient.prototype.initializePersistence=function(persistenceSettings,persistenceResult,user){var _this=this;return persistenceSettings.enabled?this.startIndexedDbPersistence(user,persistenceSettings).then(persistenceResult.resolve).catch(function(error$$1){return(persistenceResult.reject(error$$1),!_this.canFallback(error$$1))?Promise.reject(error$$1):(console.warn('Error enabling offline storage. Falling back to'+' storage disabled: '+error$$1),_this.startMemoryPersistence())}):(persistenceResult.resolve(),this.startMemoryPersistence())},FirestoreClient.prototype.canFallback=function(error$$1){return error$$1 instanceof FirestoreError?error$$1.code===Code.FAILED_PRECONDITION||error$$1.code===Code.UNIMPLEMENTED:'undefined'!=typeof DOMException&&error$$1 instanceof DOMException?error$$1.code===22||error$$1.code===20:!0},FirestoreClient.prototype.startIndexedDbPersistence=function(user,settings){var _this=this;assert(settings.enabled,'Should only start IndexedDb persitence with offline persistence enabled.');var storagePrefix=IndexedDbPersistence.buildStoragePrefix(this.databaseInfo),serializer=new JsonProtoSerializer(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){var _a,_b;return tslib_1.__generator(this,function(_c){switch(_c.label){case 0:if(settings.experimentalTabSynchronization&&!WebStorageSharedClientState.isAvailable(this.platform))throw new FirestoreError(Code.UNIMPLEMENTED,'IndexedDB persistence is only available on platforms that support LocalStorage.');return settings.experimentalTabSynchronization?(this.sharedClientState=new WebStorageSharedClientState(this.asyncQueue,this.platform,storagePrefix,this.clientId,user),_a=this,[4,IndexedDbPersistence.createMultiClientIndexedDbPersistence(storagePrefix,this.clientId,this.platform,this.asyncQueue,serializer,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return _a.persistence=_c.sent(),[3,4];case 2:return this.sharedClientState=new MemorySharedClientState,_b=this,[4,IndexedDbPersistence.createIndexedDbPersistence(storagePrefix,this.clientId,this.platform,this.asyncQueue,serializer)];case 3:_b.persistence=_c.sent(),_c.label=4;case 4:return[2];}})})})},FirestoreClient.prototype.startMemoryPersistence=function(){var serializer=new JsonProtoSerializer(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=MemoryPersistence.createEagerPersistence(this.clientId,serializer),this.sharedClientState=new MemorySharedClientState,Promise.resolve()},FirestoreClient.prototype.initializeRest=function(user){var _this=this;return debug(LOG_TAG$11,'Initializing. user=',user.uid),this.platform.loadConnection(this.databaseInfo).then(function(connection){return tslib_1.__awaiter(_this,void 0,void 0,function(){var _this=this,serializer,datastore,remoteStoreOnlineStateChangedHandler,sharedClientStateOnlineStateChangedHandler;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.localStore=new LocalStore(this.persistence,user),serializer=this.platform.newSerializer(this.databaseInfo.databaseId),datastore=new Datastore(this.asyncQueue,connection,this.credentials,serializer),remoteStoreOnlineStateChangedHandler=function(onlineState){return _this.syncEngine.applyOnlineStateChange(onlineState,OnlineStateSource.RemoteStore)},sharedClientStateOnlineStateChangedHandler=function(onlineState){return _this.syncEngine.applyOnlineStateChange(onlineState,OnlineStateSource.SharedClientState)},this.remoteStore=new RemoteStore(this.localStore,datastore,this.asyncQueue,remoteStoreOnlineStateChangedHandler),this.syncEngine=new SyncEngine(this.localStore,this.remoteStore,this.sharedClientState,user),this.sharedClientState.onlineStateHandler=sharedClientStateOnlineStateChangedHandler,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new EventManager(this.syncEngine),[4,this.sharedClientState.start()];case 1:return _a.sent(),[4,this.remoteStore.start()];case 2:return _a.sent(),[4,this.persistence.setPrimaryStateListener(function(isPrimary){return _this.syncEngine.applyPrimaryState(isPrimary)})];case 3:return _a.sent(),[2];}})})})},FirestoreClient.prototype.handleCredentialChange=function(user){return this.asyncQueue.verifyOperationInProgress(),debug(LOG_TAG$11,'Credential Changed. Current user: '+user.uid),this.syncEngine.handleCredentialChange(user)},FirestoreClient.prototype.disableNetwork=function(){var _this=this;return this.asyncQueue.enqueue(function(){return _this.syncEngine.disableNetwork()})},FirestoreClient.prototype.shutdown=function(options){var _this=this;return this.asyncQueue.enqueue(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return[4,this.remoteStore.shutdown()];case 1:return _a.sent(),[4,this.sharedClientState.shutdown()];case 2:return _a.sent(),[4,this.persistence.shutdown(options&&options.purgePersistenceWithDataLoss)];case 3:return _a.sent(),this.credentials.removeChangeListener(),[2];}})})})},FirestoreClient.prototype.listen=function(query,observer,options){var _this=this,listener=new QueryListener(query,observer,options);return this.asyncQueue.enqueueAndForget(function(){return _this.eventMgr.listen(listener)}),listener},FirestoreClient.prototype.unlisten=function(listener){var _this=this;this.asyncQueue.enqueueAndForget(function(){return _this.eventMgr.unlisten(listener)})},FirestoreClient.prototype.getDocumentFromLocalCache=function(docKey){var _this=this;return this.asyncQueue.enqueue(function(){return _this.localStore.readDocument(docKey)}).then(function(maybeDoc){if(maybeDoc instanceof Document)return maybeDoc;if(maybeDoc instanceof NoDocument)return null;throw new FirestoreError(Code.UNAVAILABLE,'Failed to get document from cache. (However, this document may '+'exist on the server. Run again without setting \'source\' in '+'the GetOptions to attempt to retrieve the document from the '+'server.)')})},FirestoreClient.prototype.getDocumentsFromLocalCache=function(query){var _this=this;return this.asyncQueue.enqueue(function(){return _this.localStore.executeQuery(query)}).then(function(docs){var remoteKeys=documentKeySet(),view=new View(query,remoteKeys),viewDocChanges=view.computeDocChanges(docs);return view.applyChanges(viewDocChanges,!1).snapshot})},FirestoreClient.prototype.write=function(mutations){var _this=this,deferred=new Deferred$1;return this.asyncQueue.enqueueAndForget(function(){return _this.syncEngine.write(mutations,deferred)}),deferred.promise},FirestoreClient.prototype.databaseId=function(){return this.databaseInfo.databaseId},FirestoreClient.prototype.transaction=function(updateFunction){var _this=this;return this.asyncQueue.enqueue(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return[2]})})}).then(function(){return _this.syncEngine.runTransaction(updateFunction)})},FirestoreClient}(),AsyncObserver=function(){function AsyncObserver(observer){this.observer=observer,this.muted=!1}return AsyncObserver.prototype.next=function(value){this.scheduleEvent(this.observer.next,value)},AsyncObserver.prototype.error=function(error){this.scheduleEvent(this.observer.error,error)},AsyncObserver.prototype.mute=function(){this.muted=!0},AsyncObserver.prototype.scheduleEvent=function(eventHandler,event){var _this=this;this.muted||setTimeout(function(){_this.muted||eventHandler(event)},0)},AsyncObserver}(),FieldPath$1=function(){function FieldPath$$1(){for(var fieldNames=[],_i=0;_i<arguments.length;_i++)fieldNames[_i]=arguments[_i];validateNamedArrayAtLeastNumberOfElements('FieldPath',fieldNames,'fieldNames',1);for(var i=0;i<fieldNames.length;++i)if(validateArgType('FieldPath','string',i,fieldNames[i]),0===fieldNames[i].length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field name at argument $(i + 1). '+'Field names must not be empty.');this._internalPath=new FieldPath(fieldNames)}return FieldPath$$1.documentId=function(){return FieldPath$$1._DOCUMENT_ID},FieldPath$$1.prototype.isEqual=function(other){if(!(other instanceof FieldPath$$1))throw invalidClassError('isEqual','FieldPath',1,other);return this._internalPath.isEqual(other._internalPath)},FieldPath$$1._DOCUMENT_ID=new FieldPath$$1(FieldPath.keyField().canonicalString()),FieldPath$$1}(),RESERVED=/[~\*\/\[\]]/,OAuthToken=function(){return function OAuthToken(value,user){this.user=user,this.type='OAuth',this.authHeaders={Authorization:'Bearer '+value}}}(),EmptyCredentialsProvider=function(){function EmptyCredentialsProvider(){this.changeListener=null}return EmptyCredentialsProvider.prototype.getToken=function(){return Promise.resolve(null)},EmptyCredentialsProvider.prototype.invalidateToken=function(){},EmptyCredentialsProvider.prototype.setChangeListener=function(changeListener){assert(!this.changeListener,'Can only call setChangeListener() once.'),this.changeListener=changeListener,changeListener(User.UNAUTHENTICATED)},EmptyCredentialsProvider.prototype.removeChangeListener=function(){assert(null!==this.changeListener,'removeChangeListener() when no listener registered'),this.changeListener=null},EmptyCredentialsProvider}(),FirebaseCredentialsProvider=function(){function FirebaseCredentialsProvider(app){var _this=this;this.app=app,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){_this.tokenCounter++,_this.currentUser=_this.getUser(),_this.changeListener&&_this.changeListener(_this.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return FirebaseCredentialsProvider.prototype.getToken=function(){var _this=this;assert(null!=this.tokenListener,'getToken cannot be called after listener removed.');var initialTokenCounter=this.tokenCounter,forceRefresh=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(forceRefresh).then(function(tokenData){if(_this.tokenCounter!==initialTokenCounter)throw new FirestoreError(Code.ABORTED,'getToken aborted due to token change.');else return tokenData?(assert('string'==typeof tokenData.accessToken,'Invalid tokenData returned from getToken():'+tokenData),new OAuthToken(tokenData.accessToken,_this.currentUser)):null})},FirebaseCredentialsProvider.prototype.invalidateToken=function(){this.forceRefresh=!0},FirebaseCredentialsProvider.prototype.setChangeListener=function(changeListener){assert(!this.changeListener,'Can only call setChangeListener() once.'),this.changeListener=changeListener,this.currentUser&&changeListener(this.currentUser)},FirebaseCredentialsProvider.prototype.removeChangeListener=function(){assert(null!=this.tokenListener,'removeChangeListener() called twice'),assert(null!==this.changeListener,'removeChangeListener() called when no listener registered'),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},FirebaseCredentialsProvider.prototype.getUser=function(){var currentUid=this.app.INTERNAL.getUid();return assert(null===currentUid||'string'==typeof currentUid,'Received invalid UID: '+currentUid),new User(currentUid)},FirebaseCredentialsProvider}(),FirstPartyToken=function(){function FirstPartyToken(gapi,sessionIndex){this.gapi=gapi,this.sessionIndex=sessionIndex,this.type='FirstParty',this.user=User.FIRST_PARTY,assert(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,'unexpected gapi interface')}return Object.defineProperty(FirstPartyToken.prototype,'authHeaders',{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),FirstPartyToken}(),FirstPartyCredentialsProvider=function(){function FirstPartyCredentialsProvider(gapi,sessionIndex){this.gapi=gapi,this.sessionIndex=sessionIndex,assert(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,'unexpected gapi interface')}return FirstPartyCredentialsProvider.prototype.getToken=function(){return Promise.resolve(new FirstPartyToken(this.gapi,this.sessionIndex))},FirstPartyCredentialsProvider.prototype.setChangeListener=function(changeListener){changeListener(User.FIRST_PARTY)},FirstPartyCredentialsProvider.prototype.removeChangeListener=function(){},FirstPartyCredentialsProvider.prototype.invalidateToken=function(){},FirstPartyCredentialsProvider}(),FieldValueImpl=function(){function FieldValueImpl(_methodName){this._methodName=_methodName}return FieldValueImpl.delete=function(){return DeleteFieldValueImpl.instance},FieldValueImpl.serverTimestamp=function(){return ServerTimestampFieldValueImpl.instance},FieldValueImpl.arrayUnion=function(){for(var elements=[],_i=0;_i<arguments.length;_i++)elements[_i]=arguments[_i];return validateAtLeastNumberOfArgs('FieldValue.arrayUnion',arguments,1),new ArrayUnionFieldValueImpl(elements)},FieldValueImpl.arrayRemove=function(){for(var elements=[],_i=0;_i<arguments.length;_i++)elements[_i]=arguments[_i];return validateAtLeastNumberOfArgs('FieldValue.arrayRemove',arguments,1),new ArrayRemoveFieldValueImpl(elements)},FieldValueImpl.prototype.isEqual=function(other){return this===other},FieldValueImpl}(),DeleteFieldValueImpl=function(_super){function DeleteFieldValueImpl(){return _super.call(this,'FieldValue.delete')||this}return tslib_1.__extends(DeleteFieldValueImpl,_super),DeleteFieldValueImpl.instance=new DeleteFieldValueImpl,DeleteFieldValueImpl}(FieldValueImpl),ServerTimestampFieldValueImpl=function(_super){function ServerTimestampFieldValueImpl(){return _super.call(this,'FieldValue.serverTimestamp')||this}return tslib_1.__extends(ServerTimestampFieldValueImpl,_super),ServerTimestampFieldValueImpl.instance=new ServerTimestampFieldValueImpl,ServerTimestampFieldValueImpl}(FieldValueImpl),ArrayUnionFieldValueImpl=function(_super){function ArrayUnionFieldValueImpl(_elements){var _this=_super.call(this,'FieldValue.arrayUnion')||this;return _this._elements=_elements,_this}return tslib_1.__extends(ArrayUnionFieldValueImpl,_super),ArrayUnionFieldValueImpl}(FieldValueImpl),ArrayRemoveFieldValueImpl=function(_super){function ArrayRemoveFieldValueImpl(_elements){var _this=_super.call(this,'FieldValue.arrayRemove')||this;return _this._elements=_elements,_this}return tslib_1.__extends(ArrayRemoveFieldValueImpl,_super),ArrayRemoveFieldValueImpl}(FieldValueImpl),PublicFieldValue=makeConstructorPrivate(FieldValueImpl,'Use FieldValue.<field>() instead.'),RESERVED_FIELD_REGEX=/^__.*__$/,ParsedSetData=function(){function ParsedSetData(data,fieldMask,fieldTransforms){this.data=data,this.fieldMask=fieldMask,this.fieldTransforms=fieldTransforms}return ParsedSetData.prototype.toMutations=function(key,precondition){var mutations=[];return null===this.fieldMask?mutations.push(new SetMutation(key,this.data,precondition)):mutations.push(new PatchMutation(key,this.data,this.fieldMask,precondition)),0<this.fieldTransforms.length&&mutations.push(new TransformMutation(key,this.fieldTransforms)),mutations},ParsedSetData}(),ParsedUpdateData=function(){function ParsedUpdateData(data,fieldMask,fieldTransforms){this.data=data,this.fieldMask=fieldMask,this.fieldTransforms=fieldTransforms}return ParsedUpdateData.prototype.toMutations=function(key,precondition){var mutations=[new PatchMutation(key,this.data,this.fieldMask,precondition)];return 0<this.fieldTransforms.length&&mutations.push(new TransformMutation(key,this.fieldTransforms)),mutations},ParsedUpdateData}(),UserDataSource;(function(UserDataSource){UserDataSource[UserDataSource.Set=0]='Set',UserDataSource[UserDataSource.Update=1]='Update',UserDataSource[UserDataSource.MergeSet=2]='MergeSet',UserDataSource[UserDataSource.Argument=3]='Argument'})(UserDataSource||(UserDataSource={}));var ParseContext=function(){function ParseContext(dataSource,methodName,path,arrayElement,fieldTransforms,fieldMask){this.dataSource=dataSource,this.methodName=methodName,this.path=path,this.arrayElement=arrayElement,void 0===fieldTransforms&&this.validatePath(),this.arrayElement=void 0!==arrayElement&&arrayElement,this.fieldTransforms=fieldTransforms||[],this.fieldMask=fieldMask||[]}return ParseContext.prototype.childContextForField=function(field){var childPath=null==this.path?null:this.path.child(field),context=new ParseContext(this.dataSource,this.methodName,childPath,!1,this.fieldTransforms,this.fieldMask);return context.validatePathSegment(field),context},ParseContext.prototype.childContextForFieldPath=function(field){var childPath=null==this.path?null:this.path.child(field),context=new ParseContext(this.dataSource,this.methodName,childPath,!1,this.fieldTransforms,this.fieldMask);return context.validatePath(),context},ParseContext.prototype.childContextForArray=function(){return new ParseContext(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},ParseContext.prototype.createError=function(reason){var fieldDescription=null===this.path||this.path.isEmpty()?'':' (found in field '+this.path.toString()+')';return new FirestoreError(Code.INVALID_ARGUMENT,'Function '+this.methodName+'() called with invalid data. '+reason+fieldDescription)},ParseContext.prototype.contains=function(fieldPath){return void 0!==this.fieldMask.find(function(field){return fieldPath.isPrefixOf(field)})||void 0!==this.fieldTransforms.find(function(transform){return fieldPath.isPrefixOf(transform.field)})},ParseContext.prototype.validatePath=function(){if(null!==this.path)for(var i=0;i<this.path.length;i++)this.validatePathSegment(this.path.get(i))},ParseContext.prototype.validatePathSegment=function(segment){if(isWrite(this.dataSource)&&RESERVED_FIELD_REGEX.test(segment))throw this.createError('Document fields cannot begin and end with __')},ParseContext}(),DocumentKeyReference=function(){return function DocumentKeyReference(databaseId,key){this.databaseId=databaseId,this.key=key}}(),UserDataConverter=function(){function UserDataConverter(preConverter){this.preConverter=preConverter}return UserDataConverter.prototype.parseSetData=function(methodName,input){var context=new ParseContext(UserDataSource.Set,methodName,FieldPath.EMPTY_PATH);validatePlainObject('Data must be an object, but it was:',context,input);var updateData=this.parseData(input,context);return new ParsedSetData(updateData,null,context.fieldTransforms)},UserDataConverter.prototype.parseMergeData=function(methodName,input,fieldPaths){var context=new ParseContext(UserDataSource.MergeSet,methodName,FieldPath.EMPTY_PATH);validatePlainObject('Data must be an object, but it was:',context,input);var updateData=this.parseData(input,context),fieldMask,fieldTransforms;if(!fieldPaths)fieldMask=new FieldMask(context.fieldMask),fieldTransforms=context.fieldTransforms;else{for(var validatedFieldPaths=[],_i=0,fieldPaths_1=fieldPaths;_i<fieldPaths_1.length;_i++){var stringOrFieldPath=fieldPaths_1[_i],fieldPath=void 0;if(stringOrFieldPath instanceof FieldPath$1)fieldPath=stringOrFieldPath._internalPath;else if('string'==typeof stringOrFieldPath)fieldPath=fieldPathFromDotSeparatedString(methodName,stringOrFieldPath);else throw fail('Expected stringOrFieldPath to be a string or a FieldPath');if(!context.contains(fieldPath))throw new FirestoreError(Code.INVALID_ARGUMENT,'Field \''+fieldPath+'\' is specified in your field mask but missing from your input data.');validatedFieldPaths.push(fieldPath)}fieldMask=new FieldMask(validatedFieldPaths),fieldTransforms=context.fieldTransforms.filter(function(transform){return fieldMask.covers(transform.field)})}return new ParsedSetData(updateData,fieldMask,fieldTransforms)},UserDataConverter.prototype.parseUpdateData=function(methodName,input){var _this=this,context=new ParseContext(UserDataSource.Update,methodName,FieldPath.EMPTY_PATH);validatePlainObject('Data must be an object, but it was:',context,input);var fieldMaskPaths=[],updateData=ObjectValue.EMPTY;forEach(input,function(key,value){var path=fieldPathFromDotSeparatedString(methodName,key),childContext=context.childContextForFieldPath(path);if(value=_this.runPreConverter(value,childContext),value instanceof DeleteFieldValueImpl)fieldMaskPaths.push(path);else{var parsedValue=_this.parseData(value,childContext);null!=parsedValue&&(fieldMaskPaths.push(path),updateData=updateData.set(path,parsedValue))}});var mask=new FieldMask(fieldMaskPaths);return new ParsedUpdateData(updateData,mask,context.fieldTransforms)},UserDataConverter.prototype.parseUpdateVarargs=function(methodName,field,value,moreFieldsAndValues){var context=new ParseContext(UserDataSource.Update,methodName,FieldPath.EMPTY_PATH),keys=[fieldPathFromArgument(methodName,field)],values$$1=[value];if(0!=moreFieldsAndValues.length%2)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+methodName+'() needs to be called with an even number '+'of arguments that alternate between field names and values.');for(var i=0;i<moreFieldsAndValues.length;i+=2)keys.push(fieldPathFromArgument(methodName,moreFieldsAndValues[i])),values$$1.push(moreFieldsAndValues[i+1]);for(var fieldMaskPaths=[],updateData=ObjectValue.EMPTY,i=0;i<keys.length;++i){var path=keys[i],childContext=context.childContextForFieldPath(path),value_1=this.runPreConverter(values$$1[i],childContext);if(value_1 instanceof DeleteFieldValueImpl)fieldMaskPaths.push(path);else{var parsedValue=this.parseData(value_1,childContext);null!=parsedValue&&(fieldMaskPaths.push(path),updateData=updateData.set(path,parsedValue))}}var mask=new FieldMask(fieldMaskPaths);return new ParsedUpdateData(updateData,mask,context.fieldTransforms)},UserDataConverter.prototype.parseQueryValue=function(methodName,input){var context=new ParseContext(UserDataSource.Argument,methodName,FieldPath.EMPTY_PATH),parsed=this.parseData(input,context);return assert(null!=parsed,'Parsed data should not be null.'),assert(0===context.fieldTransforms.length,'Field transforms should have been disallowed.'),parsed},UserDataConverter.prototype.runPreConverter=function(input,context){try{return this.preConverter(input)}catch(e){var message=errorMessage(e);throw context.createError(message)}},UserDataConverter.prototype.parseData=function(input,context){if(input=this.runPreConverter(input,context),looksLikeJsonObject(input))return validatePlainObject('Unsupported field value:',context,input),this.parseObject(input,context);if(input instanceof FieldValueImpl)return this.parseSentinelFieldValue(input,context),null;if(context.path&&context.fieldMask.push(context.path),input instanceof Array){if(context.arrayElement)throw context.createError('Nested arrays are not supported');return this.parseArray(input,context)}return this.parseScalarValue(input,context)},UserDataConverter.prototype.parseObject=function(obj,context){var _this=this,result=new SortedMap(primitiveComparator);return isEmpty(obj)?context.path&&0<context.path.length&&context.fieldMask.push(context.path):forEach(obj,function(key,val){var parsedValue=_this.parseData(val,context.childContextForField(key));null!=parsedValue&&(result=result.insert(key,parsedValue))}),new ObjectValue(result)},UserDataConverter.prototype.parseArray=function(array,context){for(var result=[],entryIndex=0,_i=0,array_1=array;_i<array_1.length;_i++){var entry=array_1[_i],parsedEntry=this.parseData(entry,context.childContextForArray(entryIndex));null==parsedEntry&&(parsedEntry=NullValue.INSTANCE),result.push(parsedEntry),entryIndex++}return new ArrayValue(result)},UserDataConverter.prototype.parseSentinelFieldValue=function(value,context){if(!isWrite(context.dataSource))throw context.createError(value._methodName+'() can only be used with update() and set()');if(null===context.path)throw context.createError(value._methodName+'() is not currently supported inside arrays');if(value instanceof DeleteFieldValueImpl){if(context.dataSource===UserDataSource.MergeSet)context.fieldMask.push(context.path);else if(context.dataSource===UserDataSource.Update)throw assert(0<context.path.length,'FieldValue.delete() at the top level should have already'+' been handled.'),context.createError('FieldValue.delete() can only appear at the top level '+'of your update data');else throw context.createError('FieldValue.delete() cannot be used with set() unless you pass '+'{merge:true}');}else if(value instanceof ServerTimestampFieldValueImpl)context.fieldTransforms.push(new FieldTransform(context.path,ServerTimestampTransform.instance));else if(value instanceof ArrayUnionFieldValueImpl){var parsedElements=this.parseArrayTransformElements(value._methodName,value._elements),arrayUnion=new ArrayUnionTransformOperation(parsedElements);context.fieldTransforms.push(new FieldTransform(context.path,arrayUnion))}else if(value instanceof ArrayRemoveFieldValueImpl){var parsedElements=this.parseArrayTransformElements(value._methodName,value._elements),arrayRemove=new ArrayRemoveTransformOperation(parsedElements);context.fieldTransforms.push(new FieldTransform(context.path,arrayRemove))}else fail('Unknown FieldValue type: '+value)},UserDataConverter.prototype.parseScalarValue=function(value,context){if(null===value)return NullValue.INSTANCE;if('number'==typeof value)return isSafeInteger(value)?new IntegerValue(value):new DoubleValue(value);if('boolean'==typeof value)return BooleanValue.of(value);if('string'==typeof value)return new StringValue(value);if(value instanceof Date)return new TimestampValue(Timestamp.fromDate(value));if(value instanceof Timestamp)return new TimestampValue(new Timestamp(value.seconds,1e3*_Mathfloor(value.nanoseconds/1e3)));if(value instanceof GeoPoint)return new GeoPointValue(value);if(value instanceof Blob)return new BlobValue(value);if(value instanceof DocumentKeyReference)return new RefValue(value.databaseId,value.key);throw context.createError('Unsupported field value: '+valueDescription(value))},UserDataConverter.prototype.parseArrayTransformElements=function(methodName,elements){var _this=this;return elements.map(function(element,i){var context=new ParseContext(UserDataSource.Argument,methodName,FieldPath.EMPTY_PATH);return _this.parseData(element,context.childContextForArray(i))})},UserDataConverter}(),DEFAULT_SSL=!0,FirestoreSettings=function(){function FirestoreSettings(settings){if(void 0===settings.host){if(void 0!==settings.ssl)throw new FirestoreError(Code.INVALID_ARGUMENT,'Can\'t provide ssl option if host option is not set');this.host='firestore.googleapis.com',this.ssl=DEFAULT_SSL}else validateNamedType('settings','non-empty string','host',settings.host),this.host=settings.host,validateNamedOptionalType('settings','boolean','ssl',settings.ssl),this.ssl=defaulted(settings.ssl,DEFAULT_SSL);validateOptionNames('settings',settings,['host','ssl','credentials','timestampsInSnapshots']),validateNamedOptionalType('settings','object','credentials',settings.credentials),this.credentials=settings.credentials,validateNamedOptionalType('settings','boolean','timestampsInSnapshots',settings.timestampsInSnapshots),this.timestampsInSnapshots=defaulted(settings.timestampsInSnapshots,!1)}return FirestoreSettings.prototype.isEqual=function(other){return this.host===other.host&&this.ssl===other.ssl&&this.timestampsInSnapshots===other.timestampsInSnapshots&&this.credentials===other.credentials},FirestoreSettings}(),FirestoreConfig=function(){return function FirestoreConfig(){}}(),PersistenceSettings=function(){function PersistenceSettings(enabled,settings){this.enabled=enabled,assert(enabled||!settings,'Can only provide PersistenceSettings with persistence enabled'),settings=settings||{},this.experimentalTabSynchronization=defaulted(settings.experimentalTabSynchronization,!1)}return PersistenceSettings.prototype.isEqual=function(other){return this.enabled===other.enabled&&this.experimentalTabSynchronization===other.experimentalTabSynchronization},PersistenceSettings}(),Firestore=function(){function Firestore(databaseIdOrApp){var _this=this;this._queue=new AsyncQueue,this.INTERNAL={delete:function(options){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this._firestoreClient?[2,this._firestoreClient.shutdown(options)]:[2]})})}};var config=new FirestoreConfig;if('object'==typeof databaseIdOrApp.options){var app=databaseIdOrApp;config.firebaseApp=app,config.databaseId=Firestore.databaseIdFromApp(app),config.persistenceKey=config.firebaseApp.name,config.credentials=new FirebaseCredentialsProvider(app)}else{var external_1=databaseIdOrApp;if(!external_1.projectId)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide projectId');config.databaseId=new DatabaseId(external_1.projectId,external_1.database),config.persistenceKey='[DEFAULT]',config.credentials=new EmptyCredentialsProvider}config.settings=new FirestoreSettings({}),this._config=config,this._databaseId=config.databaseId}return Firestore.prototype.settings=function(settingsLiteral){if(validateExactNumberOfArgs('Firestore.settings',arguments,1),validateArgType('Firestore.settings','object',1,settingsLiteral),contains(settingsLiteral,'persistence'))throw new FirestoreError(Code.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to '+'firestore.enablePersistence().');var newSettings=new FirestoreSettings(settingsLiteral);if(this._firestoreClient&&!this._config.settings.isEqual(newSettings))throw new FirestoreError(Code.FAILED_PRECONDITION,'Firestore has already been started and its settings can no longer '+'be changed. You can only call settings() before calling any other '+'methods on a Firestore object.');this._config.settings=newSettings,void 0!==newSettings.credentials&&(this._config.credentials=makeCredentialsProvider(newSettings.credentials))},Firestore.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},Firestore.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},Firestore.prototype.enablePersistence=function(settings){if(this._firestoreClient)throw new FirestoreError(Code.FAILED_PRECONDITION,'Firestore has already been started and persistence can no longer '+'be enabled. You can only call enablePersistence() before calling '+'any other methods on a Firestore object.');return this.configureClient(new PersistenceSettings(!0,settings))},Firestore.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new PersistenceSettings(!1)),this._firestoreClient},Firestore.prototype.configureClient=function(persistenceSettings){var _this=this;assert(!!this._config.settings.host,'FirestoreSettings.host cannot be falsey'),this._config.settings.timestampsInSnapshots||error('\nThe behavior for Date objects stored in Firestore is going to change\nAND YOUR APP MAY BREAK.\nTo hide this warning and ensure your app does not break, you need to add the\nfollowing code to your app before calling any other Cloud Firestore methods:\n\n  const firestore = firebase.firestore();\n  const settings = {/* your settings... */ timestampsInSnapshots: true};\n  firestore.settings(settings);\n\nWith this change, timestamps stored in Cloud Firestore will be read back as\nFirebase Timestamp objects instead of as system Date objects. So you will also\nneed to update code expecting a Date to instead expect a Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get(\'created_at\');\n  // New:\n  const timestamp = snapshot.get(\'created_at\');\n  const date = timestamp.toDate();\n\nPlease audit all existing usages of Date when you enable the new behavior. In a\nfuture release, the behavior will change to the new behavior, so if you do not\nfollow these steps, YOUR APP MAY BREAK.'),assert(!this._firestoreClient,'configureClient() called multiple times');var databaseInfo=new DatabaseInfo(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl);return this._dataConverter=new UserDataConverter(function(value){if(value instanceof DocumentReference){var thisDb=_this._config.databaseId,otherDb=value.firestore._config.databaseId;if(!otherDb.isEqual(thisDb))throw new FirestoreError(Code.INVALID_ARGUMENT,'Document reference is for database '+(otherDb.projectId+'/'+otherDb.database+' but should be ')+('for database '+thisDb.projectId+'/'+thisDb.database));return new DocumentKeyReference(_this._config.databaseId,value._key)}return value}),this._firestoreClient=new FirestoreClient(PlatformSupport.getPlatform(),databaseInfo,this._config.credentials,this._queue),this._firestoreClient.start(persistenceSettings)},Firestore.databaseIdFromApp=function(app){var options=app.options;if(!contains(options,'projectId'))throw new FirestoreError(Code.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var projectId=options.projectId;if(!projectId||'string'!=typeof projectId)throw new FirestoreError(Code.INVALID_ARGUMENT,'projectId must be a string in FirebaseApp.options');return new DatabaseId(projectId)},Object.defineProperty(Firestore.prototype,'app',{get:function(){if(!this._config.firebaseApp)throw new FirestoreError(Code.FAILED_PRECONDITION,'Firestore was not initialized using the Firebase SDK. \'app\' is '+'not available');return this._config.firebaseApp},enumerable:!0,configurable:!0}),Firestore.prototype.collection=function(pathString){if(validateExactNumberOfArgs('Firestore.collection',arguments,1),validateArgType('Firestore.collection','non-empty string',1,pathString),!pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide a non-empty collection path to collection()');return this.ensureClientConfigured(),new CollectionReference(ResourcePath.fromString(pathString),this)},Firestore.prototype.doc=function(pathString){if(validateExactNumberOfArgs('Firestore.doc',arguments,1),validateArgType('Firestore.doc','non-empty string',1,pathString),!pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide a non-empty document path to doc()');return this.ensureClientConfigured(),DocumentReference.forPath(ResourcePath.fromString(pathString),this)},Firestore.prototype.runTransaction=function(updateFunction){var _this=this;return validateExactNumberOfArgs('Firestore.runTransaction',arguments,1),validateArgType('Firestore.runTransaction','function',1,updateFunction),this.ensureClientConfigured().transaction(function(transaction){return updateFunction(new Transaction$1(_this,transaction))})},Firestore.prototype.batch=function(){return this.ensureClientConfigured(),new WriteBatch(this)},Object.defineProperty(Firestore,'logLevel',{get:function(){switch(getLogLevel()){case LogLevel.DEBUG:return'debug';case LogLevel.ERROR:return'error';case LogLevel.SILENT:return'silent';default:return fail('Unknown log level: '+getLogLevel());}},enumerable:!0,configurable:!0}),Firestore.setLogLevel=function(level){switch(validateExactNumberOfArgs('Firestore.setLogLevel',arguments,1),validateArgType('Firestore.setLogLevel','non-empty string',1,level),level){case'debug':setLogLevel(LogLevel.DEBUG);break;case'error':setLogLevel(LogLevel.ERROR);break;case'silent':setLogLevel(LogLevel.SILENT);break;default:throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid log level: '+level);}},Firestore.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},Firestore}(),Transaction$1=function(){function Transaction(_firestore,_transaction){this._firestore=_firestore,this._transaction=_transaction}return Transaction.prototype.get=function(documentRef){var _this=this;validateExactNumberOfArgs('Transaction.get',arguments,1);var ref=validateReference('Transaction.get',documentRef,this._firestore);return this._transaction.lookup([ref._key]).then(function(docs){if(!docs||1!==docs.length)return fail('Mismatch in docs returned from document lookup.');var doc=docs[0];if(doc instanceof NoDocument)return new DocumentSnapshot(_this._firestore,ref._key,null,!1,!1);if(doc instanceof Document)return new DocumentSnapshot(_this._firestore,ref._key,doc,!1,!1);throw fail('BatchGetDocumentsRequest returned unexpected document type: '+doc.constructor.name)})},Transaction.prototype.set=function(documentRef,value,options){validateBetweenNumberOfArgs('Transaction.set',arguments,2,3);var ref=validateReference('Transaction.set',documentRef,this._firestore);options=validateSetOptions('Transaction.set',options);var parsed=options.merge||options.mergeFields?this._firestore._dataConverter.parseMergeData('Transaction.set',value,options.mergeFields):this._firestore._dataConverter.parseSetData('Transaction.set',value);return this._transaction.set(ref._key,parsed),this},Transaction.prototype.update=function(documentRef,fieldOrUpdateData,value){for(var moreFieldsAndValues=[],_i=3;_i<arguments.length;_i++)moreFieldsAndValues[_i-3]=arguments[_i];var ref,parsed;return'string'==typeof fieldOrUpdateData||fieldOrUpdateData instanceof FieldPath$1?(validateAtLeastNumberOfArgs('Transaction.update',arguments,3),ref=validateReference('Transaction.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateVarargs('Transaction.update',fieldOrUpdateData,value,moreFieldsAndValues)):(validateExactNumberOfArgs('Transaction.update',arguments,2),ref=validateReference('Transaction.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateData('Transaction.update',fieldOrUpdateData)),this._transaction.update(ref._key,parsed),this},Transaction.prototype.delete=function(documentRef){validateExactNumberOfArgs('Transaction.delete',arguments,1);var ref=validateReference('Transaction.delete',documentRef,this._firestore);return this._transaction.delete(ref._key),this},Transaction}(),WriteBatch=function(){function WriteBatch(_firestore){this._firestore=_firestore,this._mutations=[],this._committed=!1}return WriteBatch.prototype.set=function(documentRef,value,options){validateBetweenNumberOfArgs('WriteBatch.set',arguments,2,3),this.verifyNotCommitted();var ref=validateReference('WriteBatch.set',documentRef,this._firestore);options=validateSetOptions('WriteBatch.set',options);var parsed=options.merge||options.mergeFields?this._firestore._dataConverter.parseMergeData('WriteBatch.set',value,options.mergeFields):this._firestore._dataConverter.parseSetData('WriteBatch.set',value);return this._mutations=this._mutations.concat(parsed.toMutations(ref._key,Precondition.NONE)),this},WriteBatch.prototype.update=function(documentRef,fieldOrUpdateData,value){for(var moreFieldsAndValues=[],_i=3;_i<arguments.length;_i++)moreFieldsAndValues[_i-3]=arguments[_i];this.verifyNotCommitted();var ref,parsed;return'string'==typeof fieldOrUpdateData||fieldOrUpdateData instanceof FieldPath$1?(validateAtLeastNumberOfArgs('WriteBatch.update',arguments,3),ref=validateReference('WriteBatch.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateVarargs('WriteBatch.update',fieldOrUpdateData,value,moreFieldsAndValues)):(validateExactNumberOfArgs('WriteBatch.update',arguments,2),ref=validateReference('WriteBatch.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateData('WriteBatch.update',fieldOrUpdateData)),this._mutations=this._mutations.concat(parsed.toMutations(ref._key,Precondition.exists(!0))),this},WriteBatch.prototype.delete=function(documentRef){validateExactNumberOfArgs('WriteBatch.delete',arguments,1),this.verifyNotCommitted();var ref=validateReference('WriteBatch.delete',documentRef,this._firestore);return this._mutations=this._mutations.concat(new DeleteMutation(ref._key,Precondition.NONE)),this},WriteBatch.prototype.commit=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.verifyNotCommitted(),this._committed=!0,0<this._mutations.length?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},WriteBatch.prototype.verifyNotCommitted=function(){if(this._committed)throw new FirestoreError(Code.FAILED_PRECONDITION,'A write batch can no longer be used after commit() '+'has been called.')},WriteBatch}(),DocumentReference=function(){function DocumentReference(_key,firestore){this._key=_key,this.firestore=firestore,this._firestoreClient=this.firestore.ensureClientConfigured()}return DocumentReference.forPath=function(path,firestore){if(0!=path.length%2)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid document reference. Document '+'references must have an even number of segments, but '+(path.canonicalString()+' has '+path.length));return new DocumentReference(new DocumentKey(path),firestore)},Object.defineProperty(DocumentReference.prototype,'id',{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentReference.prototype,'parent',{get:function(){return new CollectionReference(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentReference.prototype,'path',{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),DocumentReference.prototype.collection=function(pathString){if(validateExactNumberOfArgs('DocumentReference.collection',arguments,1),validateArgType('DocumentReference.collection','non-empty string',1,pathString),!pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide a non-empty collection name to collection()');var path=ResourcePath.fromString(pathString);return new CollectionReference(this._key.path.child(path),this.firestore)},DocumentReference.prototype.isEqual=function(other){if(!(other instanceof DocumentReference))throw invalidClassError('isEqual','DocumentReference',1,other);return this.firestore===other.firestore&&this._key.isEqual(other._key)},DocumentReference.prototype.set=function(value,options){validateBetweenNumberOfArgs('DocumentReference.set',arguments,1,2),options=validateSetOptions('DocumentReference.set',options);var parsed=options.merge||options.mergeFields?this.firestore._dataConverter.parseMergeData('DocumentReference.set',value,options.mergeFields):this.firestore._dataConverter.parseSetData('DocumentReference.set',value);return this._firestoreClient.write(parsed.toMutations(this._key,Precondition.NONE))},DocumentReference.prototype.update=function(fieldOrUpdateData,value){for(var moreFieldsAndValues=[],_i=2;_i<arguments.length;_i++)moreFieldsAndValues[_i-2]=arguments[_i];var parsed;return'string'==typeof fieldOrUpdateData||fieldOrUpdateData instanceof FieldPath$1?(validateAtLeastNumberOfArgs('DocumentReference.update',arguments,2),parsed=this.firestore._dataConverter.parseUpdateVarargs('DocumentReference.update',fieldOrUpdateData,value,moreFieldsAndValues)):(validateExactNumberOfArgs('DocumentReference.update',arguments,1),parsed=this.firestore._dataConverter.parseUpdateData('DocumentReference.update',fieldOrUpdateData)),this._firestoreClient.write(parsed.toMutations(this._key,Precondition.exists(!0)))},DocumentReference.prototype.delete=function(){return validateExactNumberOfArgs('DocumentReference.delete',arguments,0),this._firestoreClient.write([new DeleteMutation(this._key,Precondition.NONE)])},DocumentReference.prototype.onSnapshot=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];validateBetweenNumberOfArgs('DocumentReference.onSnapshot',arguments,1,4);var options={includeMetadataChanges:!1},currArg=0,observer;'object'!=typeof args[currArg]||isPartialObserver(args[currArg])||(options=args[currArg],validateOptionNames('DocumentReference.onSnapshot',options,['includeMetadataChanges']),validateNamedOptionalType('DocumentReference.onSnapshot','boolean','includeMetadataChanges',options.includeMetadataChanges),currArg++);var internalOptions={includeMetadataChanges:options.includeMetadataChanges};return isPartialObserver(args[currArg])?observer=args[currArg]:(validateArgType('DocumentReference.onSnapshot','function',currArg,args[currArg]),validateOptionalArgType('DocumentReference.onSnapshot','function',currArg+1,args[currArg+1]),validateOptionalArgType('DocumentReference.onSnapshot','function',currArg+2,args[currArg+2]),observer={next:args[currArg],error:args[currArg+1],complete:args[currArg+2]}),this.onSnapshotInternal(internalOptions,observer)},DocumentReference.prototype.onSnapshotInternal=function(options,observer){var _this=this,errHandler=function(err){console.error('Uncaught Error in onSnapshot:',err)};observer.error&&(errHandler=observer.error.bind(observer));var asyncObserver=new AsyncObserver({next:function(snapshot){if(observer.next){assert(1>=snapshot.docs.size,'Too many documents returned on a document query');var doc=snapshot.docs.get(_this._key);observer.next(new DocumentSnapshot(_this.firestore,_this._key,doc,snapshot.fromCache,snapshot.hasPendingWrites))}},error:errHandler}),internalListener=this._firestoreClient.listen(Query.atPath(this._key.path),asyncObserver,options);return function(){asyncObserver.mute(),_this._firestoreClient.unlisten(internalListener)}},DocumentReference.prototype.get=function(options){var _this=this;return validateBetweenNumberOfArgs('DocumentReference.get',arguments,0,1),validateGetOptions('DocumentReference.get',options),new Promise(function(resolve,reject){options&&'cache'===options.source?_this.firestore.ensureClientConfigured().getDocumentFromLocalCache(_this._key).then(function(doc){resolve(new DocumentSnapshot(_this.firestore,_this._key,doc,!0,!!(doc instanceof Document)&&doc.hasLocalMutations))},reject):_this.getViaSnapshotListener(resolve,reject,options)})},DocumentReference.prototype.getViaSnapshotListener=function(resolve,reject,options){var unlisten=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(snap){unlisten(),!snap.exists&&snap.metadata.fromCache?reject(new FirestoreError(Code.UNAVAILABLE,'Failed to get document because the client is '+'offline.')):snap.exists&&snap.metadata.fromCache&&options&&'server'===options.source?reject(new FirestoreError(Code.UNAVAILABLE,'Failed to get document from server. (However, this '+'document does exist in the local cache. Run again '+'without setting source to "server" to '+'retrieve the cached document.)')):resolve(snap)},error:reject})},DocumentReference}(),SnapshotMetadata=function(){function SnapshotMetadata(hasPendingWrites,fromCache){this.hasPendingWrites=hasPendingWrites,this.fromCache=fromCache}return SnapshotMetadata.prototype.isEqual=function(other){return this.hasPendingWrites===other.hasPendingWrites&&this.fromCache===other.fromCache},SnapshotMetadata}(),DocumentSnapshot=function(){function DocumentSnapshot(_firestore,_key,_document,_fromCache,_hasPendingWrites){this._firestore=_firestore,this._key=_key,this._document=_document,this._fromCache=_fromCache,this._hasPendingWrites=_hasPendingWrites}return DocumentSnapshot.prototype.data=function(options){return validateBetweenNumberOfArgs('DocumentSnapshot.data',arguments,0,1),options=validateSnapshotOptions('DocumentSnapshot.data',options),this._document?this.convertObject(this._document.data,FieldValueOptions.fromSnapshotOptions(options,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},DocumentSnapshot.prototype.get=function(fieldPath,options){if(validateBetweenNumberOfArgs('DocumentSnapshot.get',arguments,1,2),options=validateSnapshotOptions('DocumentSnapshot.get',options),this._document){var value=this._document.data.field(fieldPathFromArgument('DocumentSnapshot.get',fieldPath));if(void 0!==value)return this.convertValue(value,FieldValueOptions.fromSnapshotOptions(options,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(DocumentSnapshot.prototype,'id',{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentSnapshot.prototype,'ref',{get:function(){return new DocumentReference(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentSnapshot.prototype,'exists',{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentSnapshot.prototype,'metadata',{get:function(){return new SnapshotMetadata(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),DocumentSnapshot.prototype.isEqual=function(other){if(!(other instanceof DocumentSnapshot))throw invalidClassError('isEqual','DocumentSnapshot',1,other);return this._firestore===other._firestore&&this._fromCache===other._fromCache&&this._key.isEqual(other._key)&&(null===this._document?null===other._document:this._document.isEqual(other._document))},DocumentSnapshot.prototype.convertObject=function(data,options){var _this=this,result={};return data.forEach(function(key,value){result[key]=_this.convertValue(value,options)}),result},DocumentSnapshot.prototype.convertValue=function(value,options){if(value instanceof ObjectValue)return this.convertObject(value,options);if(value instanceof ArrayValue)return this.convertArray(value,options);if(value instanceof RefValue){var key=value.value(options),database=this._firestore.ensureClientConfigured().databaseId();return value.databaseId.isEqual(database)||error('Document '+this._key.path+' contains a document '+'reference within a different database ('+(value.databaseId.projectId+'/'+value.databaseId.database+') which is not ')+'supported. It will be treated as a reference in the current '+('database ('+database.projectId+'/'+database.database+') ')+'instead.'),new DocumentReference(key,this._firestore)}return value.value(options)},DocumentSnapshot.prototype.convertArray=function(data,options){var _this=this;return data.internalValue.map(function(value){return _this.convertValue(value,options)})},DocumentSnapshot}(),QueryDocumentSnapshot=function(_super){function QueryDocumentSnapshot(firestore,key,document,fromCache,hasPendingWrites){return _super.call(this,firestore,key,document,fromCache,hasPendingWrites)||this}return tslib_1.__extends(QueryDocumentSnapshot,_super),QueryDocumentSnapshot.prototype.data=function(options){var data=_super.prototype.data.call(this,options);return assert('object'==typeof data,'Document in a QueryDocumentSnapshot should exist'),data},QueryDocumentSnapshot}(DocumentSnapshot),Query$1=function(){function Query$$1(_query,firestore){this._query=_query,this.firestore=firestore}return Query$$1.prototype.where=function(field,opStr,value){validateExactNumberOfArgs('Query.where',arguments,3),validateArgType('Query.where','non-empty string',2,opStr),validateDefined('Query.where',3,value);var fieldPath=fieldPathFromArgument('Query.where',field),relationOp=RelationOp.fromString(opStr),fieldValue;if(fieldPath.isKeyField()){if(relationOp===RelationOp.ARRAY_CONTAINS)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid Query. You can\'t perform array-contains queries on '+'FieldPath.documentId() since document IDs are not arrays.');if('string'==typeof value){if(-1!==value.indexOf('/'))throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.where() requires its third parameter to be a '+'valid document ID if the first parameter is '+'FieldPath.documentId(), but it contains a slash.');if(''===value)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.where() requires its third parameter to be a '+'valid document ID if the first parameter is '+'FieldPath.documentId(), but it was an empty string.');var path=this._query.path.child(new ResourcePath([value]));assert(0==path.length%2,'Path should be a document key'),fieldValue=new RefValue(this.firestore._databaseId,new DocumentKey(path))}else if(value instanceof DocumentReference){fieldValue=new RefValue(this.firestore._databaseId,value._key)}else throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.where() requires its third parameter to be a '+'string or a DocumentReference if the first parameter is '+'FieldPath.documentId(), but it was: '+(valueDescription(value)+'.'))}else fieldValue=this.firestore._dataConverter.parseQueryValue('Query.where',value);var filter=Filter.create(fieldPath,relationOp,fieldValue);return this.validateNewFilter(filter),new Query$$1(this._query.addFilter(filter),this.firestore)},Query$$1.prototype.orderBy=function(field,directionStr){validateBetweenNumberOfArgs('Query.orderBy',arguments,1,2),validateOptionalArgType('Query.orderBy','non-empty string',2,directionStr);var direction;if(void 0===directionStr||'asc'===directionStr)direction=Direction.ASCENDING;else if('desc'===directionStr)direction=Direction.DESCENDING;else throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.orderBy() has unknown direction \''+directionStr+'\', '+'expected \'asc\' or \'desc\'.');if(null!==this._query.startAt)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You must not call Query.startAt() or '+'Query.startAfter() before calling Query.orderBy().');if(null!==this._query.endAt)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You must not call Query.endAt() or '+'Query.endBefore() before calling Query.orderBy().');var fieldPath=fieldPathFromArgument('Query.orderBy',field),orderBy=new OrderBy(fieldPath,direction);return this.validateNewOrderBy(orderBy),new Query$$1(this._query.addOrderBy(orderBy),this.firestore)},Query$$1.prototype.limit=function(n){if(validateExactNumberOfArgs('Query.limit',arguments,1),validateArgType('Query.limit','number',1,n),0>=n)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid Query. Query limit ('+n+') is invalid. Limit must be '+'positive.');return new Query$$1(this._query.withLimit(n),this.firestore)},Query$$1.prototype.startAt=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.startAt',arguments,1);var bound=this.boundFromDocOrFields('Query.startAt',docOrField,fields,!0);return new Query$$1(this._query.withStartAt(bound),this.firestore)},Query$$1.prototype.startAfter=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.startAfter',arguments,1);var bound=this.boundFromDocOrFields('Query.startAfter',docOrField,fields,!1);return new Query$$1(this._query.withStartAt(bound),this.firestore)},Query$$1.prototype.endBefore=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.endBefore',arguments,1);var bound=this.boundFromDocOrFields('Query.endBefore',docOrField,fields,!0);return new Query$$1(this._query.withEndAt(bound),this.firestore)},Query$$1.prototype.endAt=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.endAt',arguments,1);var bound=this.boundFromDocOrFields('Query.endAt',docOrField,fields,!1);return new Query$$1(this._query.withEndAt(bound),this.firestore)},Query$$1.prototype.isEqual=function(other){if(!(other instanceof Query$$1))throw invalidClassError('isEqual','Query',1,other);return this.firestore===other.firestore&&this._query.isEqual(other._query)},Query$$1.prototype.boundFromDocOrFields=function(methodName,docOrField,fields,before){if(validateDefined(methodName,1,docOrField),docOrField instanceof DocumentSnapshot){if(0<fields.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Too many arguments provided to '+methodName+'().');var snap=docOrField;if(!snap.exists)throw new FirestoreError(Code.NOT_FOUND,'Can\'t use a DocumentSnapshot that doesn\'t exist for '+(methodName+'().'));return this.boundFromDocument(methodName,snap._document,before)}var allFields=[docOrField].concat(fields);return this.boundFromFields(methodName,allFields,before)},Query$$1.prototype.boundFromDocument=function(methodName,doc,before){for(var components=[],_i=0,_a=this._query.orderBy,orderBy;_i<_a.length;_i++)if(orderBy=_a[_i],orderBy.field.isKeyField())components.push(new RefValue(this.firestore._databaseId,doc.key));else{var value=doc.field(orderBy.field);if(void 0!==value)components.push(value);else{var field=orderBy.field.canonicalString();throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a '+('document for which the field \''+field+'\' (used as the ')+'orderBy) does not exist.')}}return new Bound(components,before)},Query$$1.prototype.boundFromFields=function(methodName,values$$1,before){var orderBy=this._query.explicitOrderBy;if(values$$1.length>orderBy.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Too many arguments provided to '+methodName+'(). '+'The number of arguments must be less than or equal to the '+'number of Query.orderBy() clauses');for(var components=[],i=0;i<values$$1.length;i++){var rawValue=values$$1[i],orderByComponent=orderBy[i];if(orderByComponent.field.isKeyField()){if('string'!=typeof rawValue)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. Expected a string for document ID in '+(methodName+'(), but got a '+typeof rawValue));if(-1!==rawValue.indexOf('/'))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. Document ID \''+rawValue+'\' contains a slash in '+(methodName+'()'));var key=new DocumentKey(this._query.path.child(rawValue));components.push(new RefValue(this.firestore._databaseId,key))}else{var wrapped=this.firestore._dataConverter.parseQueryValue(methodName,rawValue);components.push(wrapped)}}return new Bound(components,before)},Query$$1.prototype.onSnapshot=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];validateBetweenNumberOfArgs('Query.onSnapshot',arguments,1,4);var options={},currArg=0,observer;return'object'!=typeof args[currArg]||isPartialObserver(args[currArg])||(options=args[currArg],validateOptionNames('Query.onSnapshot',options,['includeMetadataChanges']),validateNamedOptionalType('Query.onSnapshot','boolean','includeMetadataChanges',options.includeMetadataChanges),currArg++),isPartialObserver(args[currArg])?observer=args[currArg]:(validateArgType('Query.onSnapshot','function',currArg,args[currArg]),validateOptionalArgType('Query.onSnapshot','function',currArg+1,args[currArg+1]),validateOptionalArgType('Query.onSnapshot','function',currArg+2,args[currArg+2]),observer={next:args[currArg],error:args[currArg+1],complete:args[currArg+2]}),this.onSnapshotInternal(options,observer)},Query$$1.prototype.onSnapshotInternal=function(options,observer){var _this=this,errHandler=function(err){console.error('Uncaught Error in onSnapshot:',err)};observer.error&&(errHandler=observer.error.bind(observer));var asyncObserver=new AsyncObserver({next:function(result){observer.next&&observer.next(new QuerySnapshot(_this.firestore,_this._query,result))},error:errHandler}),firestoreClient=this.firestore.ensureClientConfigured(),internalListener=firestoreClient.listen(this._query,asyncObserver,options);return function(){asyncObserver.mute(),firestoreClient.unlisten(internalListener)}},Query$$1.prototype.get=function(options){var _this=this;return validateBetweenNumberOfArgs('Query.get',arguments,0,1),validateGetOptions('Query.get',options),new Promise(function(resolve,reject){options&&'cache'===options.source?_this.firestore.ensureClientConfigured().getDocumentsFromLocalCache(_this._query).then(function(viewSnap){resolve(new QuerySnapshot(_this.firestore,_this._query,viewSnap))},reject):_this.getViaSnapshotListener(resolve,reject,options)})},Query$$1.prototype.getViaSnapshotListener=function(resolve,reject,options){var unlisten=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(result){unlisten(),result.metadata.fromCache&&options&&'server'===options.source?reject(new FirestoreError(Code.UNAVAILABLE,'Failed to get documents from server. (However, these '+'documents may exist in the local cache. Run again '+'without setting source to "server" to '+'retrieve the cached documents.)')):resolve(result)},error:reject})},Query$$1.prototype.validateNewFilter=function(filter){if(filter instanceof RelationFilter)if(filter.isInequality()){var existingField=this._query.getInequalityFilterField();if(null!==existingField&&!existingField.isEqual(filter.field))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. All where filters with an inequality'+' (<, <=, >, or >=) must be on the same field. But you have'+(' inequality filters on \''+existingField.toString()+'\'')+(' and \''+filter.field.toString()+'\''));var firstOrderByField=this._query.getFirstOrderByField();null!==firstOrderByField&&this.validateOrderByAndInequalityMatch(filter.field,firstOrderByField)}else if(filter.op===RelationOp.ARRAY_CONTAINS&&this._query.hasArrayContainsFilter())throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. Queries only support a single array-contains '+'filter.')},Query$$1.prototype.validateNewOrderBy=function(orderBy){if(null===this._query.getFirstOrderByField()){var inequalityField=this._query.getInequalityFilterField();null!==inequalityField&&this.validateOrderByAndInequalityMatch(inequalityField,orderBy.field)}},Query$$1.prototype.validateOrderByAndInequalityMatch=function(inequality,orderBy){if(!orderBy.isEqual(inequality))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You have a where filter with an inequality '+('(<, <=, >, or >=) on field \''+inequality.toString()+'\' ')+('and so you must also use \''+inequality.toString()+'\' ')+'as your first Query.orderBy(), but your first Query.orderBy() '+('is on field \''+orderBy.toString()+'\' instead.'))},Query$$1}(),QuerySnapshot=function(){function QuerySnapshot(_firestore,_originalQuery,_snapshot){this._firestore=_firestore,this._originalQuery=_originalQuery,this._snapshot=_snapshot,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new SnapshotMetadata(_snapshot.hasPendingWrites,_snapshot.fromCache)}return Object.defineProperty(QuerySnapshot.prototype,'docs',{get:function(){var result=[];return this.forEach(function(doc){return result.push(doc)}),result},enumerable:!0,configurable:!0}),Object.defineProperty(QuerySnapshot.prototype,'empty',{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(QuerySnapshot.prototype,'size',{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),QuerySnapshot.prototype.forEach=function(callback,thisArg){var _this=this;validateBetweenNumberOfArgs('QuerySnapshot.forEach',arguments,1,2),validateArgType('QuerySnapshot.forEach','function',1,callback),this._snapshot.docs.forEach(function(doc){callback.call(thisArg,_this.convertToDocumentImpl(doc))})},Object.defineProperty(QuerySnapshot.prototype,'query',{get:function(){return new Query$1(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),QuerySnapshot.prototype.docChanges=function(options){options&&(validateOptionNames('QuerySnapshot.docChanges',options,['includeMetadataChanges']),validateNamedOptionalType('QuerySnapshot.docChanges','boolean','includeMetadataChanges',options.includeMetadataChanges));var includeMetadataChanges=!!(options&&options.includeMetadataChanges);if(includeMetadataChanges&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(Code.INVALID_ARGUMENT,'To include metadata changes with your document changes, you must '+'also pass { includeMetadataChanges:true } to onSnapshot().');return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===includeMetadataChanges||(this._cachedChanges=changesFromSnapshot(this._firestore,includeMetadataChanges,this._snapshot),this._cachedChangesIncludeMetadataChanges=includeMetadataChanges),this._cachedChanges},QuerySnapshot.prototype.isEqual=function(other){if(!(other instanceof QuerySnapshot))throw invalidClassError('isEqual','QuerySnapshot',1,other);return this._firestore===other._firestore&&this._originalQuery.isEqual(other._originalQuery)&&this._snapshot.isEqual(other._snapshot)},QuerySnapshot.prototype.convertToDocumentImpl=function(doc){return new QueryDocumentSnapshot(this._firestore,doc.key,doc,this.metadata.fromCache,this._snapshot.mutatedKeys.has(doc.key))},QuerySnapshot}(),docChangesPropertiesToOverride=['length','forEach','map'].concat('undefined'==typeof Symbol?[]:[Symbol.iterator]);docChangesPropertiesToOverride.forEach(function(property){try{Object.defineProperty(QuerySnapshot.prototype.docChanges,property,{get:function(){return throwDocChangesMethodError()}})}catch(err){}});var CollectionReference=function(_super){function CollectionReference(path,firestore){var _this=_super.call(this,Query.atPath(path),firestore)||this;if(1!=path.length%2)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid collection reference. Collection '+'references must have an odd number of segments, but '+(path.canonicalString()+' has '+path.length));return _this}return tslib_1.__extends(CollectionReference,_super),Object.defineProperty(CollectionReference.prototype,'id',{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(CollectionReference.prototype,'parent',{get:function(){var parentPath=this._query.path.popLast();return parentPath.isEmpty()?null:new DocumentReference(new DocumentKey(parentPath),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(CollectionReference.prototype,'path',{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),CollectionReference.prototype.doc=function(pathString){if(validateBetweenNumberOfArgs('CollectionReference.doc',arguments,0,1),0===arguments.length&&(pathString=AutoId.newId()),validateArgType('CollectionReference.doc','non-empty string',1,pathString),''===pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Document path must be a non-empty string');var path=ResourcePath.fromString(pathString);return DocumentReference.forPath(this._query.path.child(path),this.firestore)},CollectionReference.prototype.add=function(value){validateExactNumberOfArgs('CollectionReference.add',arguments,1),validateArgType('CollectionReference.add','object',1,value);var docRef=this.doc();return docRef.set(value).then(function(){return docRef})},CollectionReference}(Query$1),PublicFirestore=makeConstructorPrivate(Firestore,'Use firebase.firestore() instead.'),PublicTransaction=makeConstructorPrivate(Transaction$1,'Use firebase.firestore().runTransaction() instead.'),PublicWriteBatch=makeConstructorPrivate(WriteBatch,'Use firebase.firestore().batch() instead.'),PublicDocumentReference=makeConstructorPrivate(DocumentReference,'Use firebase.firestore().doc() instead.'),PublicDocumentSnapshot=makeConstructorPrivate(DocumentSnapshot),PublicQueryDocumentSnapshot=makeConstructorPrivate(QueryDocumentSnapshot),PublicQuery=makeConstructorPrivate(Query$1),PublicQuerySnapshot=makeConstructorPrivate(QuerySnapshot),PublicCollectionReference=makeConstructorPrivate(CollectionReference,'Use firebase.firestore().collection() instead.'),firestoreNamespace={Firestore:PublicFirestore,GeoPoint:GeoPoint,Timestamp:Timestamp,Blob:PublicBlob,Transaction:PublicTransaction,WriteBatch:PublicWriteBatch,DocumentReference:PublicDocumentReference,DocumentSnapshot:PublicDocumentSnapshot,Query:PublicQuery,QueryDocumentSnapshot:PublicQueryDocumentSnapshot,QuerySnapshot:PublicQuerySnapshot,CollectionReference:PublicCollectionReference,FieldPath:FieldPath$1,FieldValue:PublicFieldValue,setLogLevel:Firestore.setLogLevel};registerFirestore(firebase),exports.registerFirestore=registerFirestore}).call(exports,__webpack_require__(4))},function(module,__webpack_exports__,__webpack_require__){'use strict';function setLogLevel(level){instances.forEach(function(inst){inst.logLevel=level})}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0}),__webpack_require__.d(__webpack_exports__,'setLogLevel',function(){return setLogLevel}),__webpack_require__.d(__webpack_exports__,'Logger',function(){return Logger}),__webpack_require__.d(__webpack_exports__,'LogLevel',function(){return LogLevel});var instances=[],LogLevel;(function(LogLevel){LogLevel[LogLevel.DEBUG=0]='DEBUG',LogLevel[LogLevel.VERBOSE=1]='VERBOSE',LogLevel[LogLevel.INFO=2]='INFO',LogLevel[LogLevel.WARN=3]='WARN',LogLevel[LogLevel.ERROR=4]='ERROR',LogLevel[LogLevel.SILENT=5]='SILENT'})(LogLevel||(LogLevel={}));var defaultLogLevel=LogLevel.INFO,defaultLogHandler=function(instance,logType){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];if(!(logType<instance.logLevel)){var now=new Date().toISOString();switch(logType){case LogLevel.DEBUG:console.log.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.VERBOSE:console.log.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.INFO:console.info.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.WARN:console.warn.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.ERROR:console.error.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;default:throw new Error('Attempted to log a message with an invalid logType (value: '+logType+')');}}},Logger=function(){function Logger(name){this.name=name,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,instances.push(this)}return Object.defineProperty(Logger.prototype,'logLevel',{get:function(){return this._logLevel},set:function(val){if(!(val in LogLevel))throw new TypeError('Invalid value assigned to `logLevel`');this._logLevel=val},enumerable:!0,configurable:!0}),Object.defineProperty(Logger.prototype,'logHandler',{get:function(){return this._logHandler},set:function(val){if('function'!=typeof val)throw new TypeError('Value assigned to `logHandler` must be a function');this._logHandler=val},enumerable:!0,configurable:!0}),Logger.prototype.debug=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.DEBUG].concat(args))},Logger.prototype.log=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.VERBOSE].concat(args))},Logger.prototype.info=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.INFO].concat(args))},Logger.prototype.warn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.WARN].concat(args))},Logger.prototype.error=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.ERROR].concat(args))},Logger}()},function(module,__webpack_exports__,__webpack_require__){'use strict';var _Mathmin2=Math.min;(function(setImmediate,global){function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError('Promises must be constructed via new');if('function'!=typeof fn)throw new TypeError('not a function');this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;return 0===self._state?void self._deferreds.push(deferred):void(self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return void(1===self._state?resolve:reject)(deferred.promise,self._value);var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}))}function resolve(self,newValue){try{if(newValue===self)throw new TypeError('A promise cannot be resolved with itself.');if(newValue&&('object'==typeof newValue||'function'==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if('function'==typeof then)return void doResolve(bind(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled='function'==typeof onFulfilled?onFulfilled:null,this.onRejected='function'==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0_whatwg_fetch__=__webpack_require__(153),setTimeoutFunc=setTimeout;Promise.prototype['catch']=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.prototype['finally']=function(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){return constructor.reject(reason)})})},Promise.all=function(arr){return new Promise(function(resolve,reject){function res(i,val){try{if(val&&('object'==typeof val||'function'==typeof val)){var then=val.then;if('function'==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}if(!arr||'undefined'==typeof arr.length)throw new TypeError('Promise.all accepts an array');var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&'object'==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn='function'==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){'undefined'!=typeof console&&console&&console.warn('Possible Unhandled Promise Rejection:',err)};var globalNS=function(){if('undefined'!=typeof self)return self;if('undefined'!=typeof window)return window;if('undefined'!=typeof global)return global;throw new Error('unable to locate global object')}();globalNS.Promise||(globalNS.Promise=Promise);var _global=createCommonjsModule(function(module){var global=module.exports='undefined'!=typeof window&&window.Math==Math?window:'undefined'!=typeof self&&self.Math==Math?self:Function('return this')();'number'==typeof __g&&(__g=global)}),_core=createCommonjsModule(function(module){var core=module.exports={version:'2.5.5'};'number'==typeof __e&&(__e=core)}),_core_1=_core.version,_isObject=function(it){return'object'==typeof it?null!==it:'function'==typeof it},_anObject=function(it){if(!_isObject(it))throw TypeError(it+' is not an object!');return it},_fails=function(exec){try{return!!exec()}catch(e){return!0}},_descriptors=!_fails(function(){return 7!=Object.defineProperty({},'a',{get:function(){return 7}}).a}),document=_global.document,is=_isObject(document)&&_isObject(document.createElement),_domCreate=function(it){return is?document.createElement(it):{}},_ie8DomDefine=!_descriptors&&!_fails(function(){return 7!=Object.defineProperty(_domCreate('div'),'a',{get:function(){return 7}}).a}),_toPrimitive=function(it,S){if(!_isObject(it))return it;var fn,val;if(S&&'function'==typeof(fn=it.toString)&&!_isObject(val=fn.call(it)))return val;if('function'==typeof(fn=it.valueOf)&&!_isObject(val=fn.call(it)))return val;if(!S&&'function'==typeof(fn=it.toString)&&!_isObject(val=fn.call(it)))return val;throw TypeError('Can\'t convert object to primitive value')},dP=Object.defineProperty,f=_descriptors?Object.defineProperty:function defineProperty(O,P,Attributes){if(_anObject(O),P=_toPrimitive(P,!0),_anObject(Attributes),_ie8DomDefine)try{return dP(O,P,Attributes)}catch(e){}if('get'in Attributes||'set'in Attributes)throw TypeError('Accessors not supported!');return'value'in Attributes&&(O[P]=Attributes.value),O},_objectDp={f:f},_propertyDesc=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}},_hide=_descriptors?function(object,key,value){return _objectDp.f(object,key,_propertyDesc(1,value))}:function(object,key,value){return object[key]=value,object},hasOwnProperty={}.hasOwnProperty,_has=function(it,key){return hasOwnProperty.call(it,key)},id=0,px=Math.random(),_uid=function(key){return'Symbol('.concat(key===void 0?'':key,')_',(++id+px).toString(36))},_redefine=createCommonjsModule(function(module){var SRC=_uid('src'),TO_STRING='toString',$toString=Function[TO_STRING],TPL=(''+$toString).split(TO_STRING);_core.inspectSource=function(it){return $toString.call(it)},(module.exports=function(O,key,val,safe){var isFunction='function'==typeof val;isFunction&&(_has(val,'name')||_hide(val,'name',key));O[key]===val||(isFunction&&(_has(val,SRC)||_hide(val,SRC,O[key]?''+O[key]:TPL.join(key+''))),O===_global?O[key]=val:safe?O[key]?O[key]=val:_hide(O,key,val):(delete O[key],_hide(O,key,val)))})(Function.prototype,TO_STRING,function toString(){return'function'==typeof this&&this[SRC]||$toString.call(this)})}),_aFunction=function(it){if('function'!=typeof it)throw TypeError(it+' is not a function!');return it},_ctx=function(fn,that,length){return(_aFunction(fn),void 0===that)?fn:1===length?function(a){return fn.call(that,a)}:2===length?function(a,b){return fn.call(that,a,b)}:3===length?function(a,b,c){return fn.call(that,a,b,c)}:function(){return fn.apply(that,arguments)}},PROTOTYPE='prototype',$export=function(type,name,source){var IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,target=IS_GLOBAL?_global:IS_STATIC?_global[name]||(_global[name]={}):(_global[name]||{})[PROTOTYPE],exports=IS_GLOBAL?_core:_core[name]||(_core[name]={}),expProto=exports[PROTOTYPE]||(exports[PROTOTYPE]={}),key,own,out,exp;for(key in IS_GLOBAL&&(source=name),source)own=!IS_FORCED&&target&&void 0!==target[key],out=(own?target:source)[key],exp=IS_BIND&&own?_ctx(out,_global):IS_PROTO&&'function'==typeof out?_ctx(Function.call,out):out,target&&_redefine(target,key,out,type&$export.U),exports[key]!=out&&_hide(exports,key,exp),IS_PROTO&&expProto[key]!=out&&(expProto[key]=out)};_global.core=_core,$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128;var _export=$export,toString={}.toString,_cof=function(it){return toString.call(it).slice(8,-1)},_iobject=Object('z').propertyIsEnumerable(0)?Object:function(it){return'String'==_cof(it)?it.split(''):Object(it)},_defined=function(it){if(it==void 0)throw TypeError('Can\'t call method on  '+it);return it},_toObject=function(it){return Object(_defined(it))},ceil=Math.ceil,floor=Math.floor,_toInteger=function(it){return isNaN(it=+it)?0:(0<it?floor:ceil)(it)},_toLength=function(it){return 0<it?_Mathmin2(_toInteger(it),9007199254740991):0},_isArray=Array.isArray||function isArray(arg){return'Array'==_cof(arg)},SHARED='__core-js_shared__',store=_global[SHARED]||(_global[SHARED]={}),_shared=function(key){return store[key]||(store[key]={})},_wks=createCommonjsModule(function(module){var store=_shared('wks'),Symbol=_global.Symbol,USE_SYMBOL='function'==typeof Symbol,$exports=module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:_uid)('Symbol.'+name))};$exports.store=store}),SPECIES=_wks('species'),_arraySpeciesConstructor=function(original){var C;return _isArray(original)&&(C=original.constructor,'function'==typeof C&&(C===Array||_isArray(C.prototype))&&(C=void 0),_isObject(C)&&(C=C[SPECIES],null===C&&(C=void 0))),void 0===C?Array:C},_arraySpeciesCreate=function(original,length){return new(_arraySpeciesConstructor(original))(length)},_arrayMethods=function(TYPE,$create){var IS_MAP=1==TYPE,IS_EVERY=4==TYPE,IS_FIND_INDEX=6==TYPE,create=$create||_arraySpeciesCreate;return function($this,callbackfn,that){for(var O=_toObject($this),self=_iobject(O),f=_ctx(callbackfn,that,3),length=_toLength(self.length),index=0,result=IS_MAP?create($this,length):2==TYPE?create($this,0):void 0,val,res;length>index;index++)if((5==TYPE||IS_FIND_INDEX||index in self)&&(val=self[index],res=f(val,index,O),TYPE))if(IS_MAP)result[index]=res;else if(res)switch(TYPE){case 3:return!0;case 5:return val;case 6:return index;case 2:result.push(val);}else if(IS_EVERY)return!1;return IS_FIND_INDEX?-1:3==TYPE||IS_EVERY?IS_EVERY:result}},UNSCOPABLES=_wks('unscopables'),ArrayProto=Array.prototype;ArrayProto[UNSCOPABLES]==void 0&&_hide(ArrayProto,UNSCOPABLES,{});var _addToUnscopables=function(key){ArrayProto[UNSCOPABLES][key]=!0},$find=_arrayMethods(5),KEY='find',forced=!0;KEY in[]&&[,][KEY](function(){forced=!1}),_export(_export.P+_export.F*forced,'Array',{find:function find(callbackfn){return $find(this,callbackfn,1<arguments.length?arguments[1]:void 0)}}),_addToUnscopables(KEY);var find=_core.Array.find,$find$1=_arrayMethods(6),KEY$1='findIndex',forced$1=!0;KEY$1 in[]&&[,][KEY$1](function(){forced$1=!1}),_export(_export.P+_export.F*forced$1,'Array',{findIndex:function findIndex(callbackfn){return $find$1(this,callbackfn,1<arguments.length?arguments[1]:void 0)}}),_addToUnscopables(KEY$1);var findIndex=_core.Array.findIndex,_toIobject=function(it){return _iobject(_defined(it))},max=Math.max,_toAbsoluteIndex=function(index,length){return index=_toInteger(index),0>index?max(index+length,0):_Mathmin2(index,length)},shared=_shared('keys'),_sharedKey=function(key){return shared[key]||(shared[key]=_uid(key))},arrayIndexOf=function(IS_INCLUDES){return function($this,el,fromIndex){var O=_toIobject($this),length=_toLength(O.length),index=_toAbsoluteIndex(fromIndex,length),value;if(IS_INCLUDES&&el!=el){for(;length>index;)if(value=O[index++],value!=value)return!0;}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}}(!1),IE_PROTO=_sharedKey('IE_PROTO'),_objectKeysInternal=function(object,names){var O=_toIobject(object),i=0,result=[],key;for(key in O)key!=IE_PROTO&&_has(O,key)&&result.push(key);for(;names.length>i;)_has(O,key=names[i++])&&(~arrayIndexOf(result,key)||result.push(key));return result},_enumBugKeys='constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'.split(','),_objectKeys=Object.keys||function keys(O){return _objectKeysInternal(O,_enumBugKeys)},f$1=Object.getOwnPropertySymbols,_objectGops={f:f$1},f$2={}.propertyIsEnumerable,_objectPie={f:f$2},$assign=Object.assign,_objectAssign=!$assign||_fails(function(){var A={},B={},S=Symbol(),K='abcdefghijklmnopqrst';return A[S]=7,K.split('').forEach(function(k){B[k]=k}),7!=$assign({},A)[S]||Object.keys($assign({},B)).join('')!=K})?function assign(target){for(var T=_toObject(target),aLen=arguments.length,index=1,getSymbols=_objectGops.f,isEnum=_objectPie.f;aLen>index;)for(var S=_iobject(arguments[index++]),keys=getSymbols?_objectKeys(S).concat(getSymbols(S)):_objectKeys(S),length=keys.length,j=0,key;length>j;)isEnum.call(S,key=keys[j++])&&(T[key]=S[key]);return T}:$assign;_export(_export.S+_export.F,'Object',{assign:_objectAssign});var assign=_core.Object.assign,MATCH=_wks('match'),_isRegexp=function(it){var isRegExp;return _isObject(it)&&((isRegExp=it[MATCH])===void 0?'RegExp'==_cof(it):!!isRegExp)},_stringContext=function(that,searchString,NAME){if(_isRegexp(searchString))throw TypeError('String#'+NAME+' doesn\'t accept regex!');return _defined(that)+''},MATCH$1=_wks('match'),STARTS_WITH='startsWith',$startsWith=''[STARTS_WITH];_export(_export.P+_export.F*function(KEY){var re=/./;try{'/./'[KEY](re)}catch(e){try{return re[MATCH$1]=!1,!'/./'[KEY](re)}catch(f){}}return!0}(STARTS_WITH),'String',{startsWith:function startsWith(searchString){var that=_stringContext(this,searchString,STARTS_WITH),index=_toLength(_Mathmin2(1<arguments.length?arguments[1]:void 0,that.length)),search=searchString+'';return that.slice(index,index+search.length)===search}});var startsWith=_core.String.startsWith;_export(_export.P,'String',{repeat:function repeat(count){var str=_defined(this)+'',res='',n=_toInteger(count);if(0>n||n==Infinity)throw RangeError('Count can\'t be negative');for(;0<n;(n>>>=1)&&(str+=str))1&n&&(res+=str);return res}});var repeat=_core.String.repeat,_meta=createCommonjsModule(function(module){var META=_uid('meta'),setDesc=_objectDp.f,id=0,isExtensible=Object.isExtensible||function(){return!0},FREEZE=!_fails(function(){return isExtensible(Object.preventExtensions({}))}),setMeta=function(it){setDesc(it,META,{value:{i:'O'+ ++id,w:{}}})},meta=module.exports={KEY:META,NEED:!1,fastKey:function(it,create){if(!_isObject(it))return'symbol'==typeof it?it:('string'==typeof it?'S':'P')+it;if(!_has(it,META)){if(!isExtensible(it))return'F';if(!create)return'E';setMeta(it)}return it[META].i},getWeak:function(it,create){if(!_has(it,META)){if(!isExtensible(it))return!0;if(!create)return!1;setMeta(it)}return it[META].w},onFreeze:function(it){return FREEZE&&meta.NEED&&isExtensible(it)&&!_has(it,META)&&setMeta(it),it}}}),_meta_1=_meta.KEY,_meta_2=_meta.NEED,_meta_3=_meta.fastKey,_meta_4=_meta.getWeak,_meta_5=_meta.onFreeze,def=_objectDp.f,TAG=_wks('toStringTag'),_setToStringTag=function(it,tag,stat){it&&!_has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})},_wksExt={f:_wks},_library=!1,defineProperty=_objectDp.f,_wksDefine=function(name){var $Symbol=_core.Symbol||(_core.Symbol=_global.Symbol||{});'_'==name.charAt(0)||name in $Symbol||defineProperty($Symbol,name,{value:_wksExt.f(name)})},_enumKeys=function(it){var result=_objectKeys(it),getSymbols=_objectGops.f;if(getSymbols)for(var symbols=getSymbols(it),isEnum=_objectPie.f,i=0,key;symbols.length>i;)isEnum.call(it,key=symbols[i++])&&result.push(key);return result},_objectDps=_descriptors?Object.defineProperties:function defineProperties(O,Properties){_anObject(O);for(var keys=_objectKeys(Properties),length=keys.length,i=0,P;length>i;)_objectDp.f(O,P=keys[i++],Properties[P]);return O},document$1=_global.document,_html=document$1&&document$1.documentElement,IE_PROTO$1=_sharedKey('IE_PROTO'),Empty=function(){},PROTOTYPE$1='prototype',createDict=function(){var iframe=_domCreate('iframe'),i=_enumBugKeys.length,lt='<',gt='>',iframeDocument;for(iframe.style.display='none',_html.appendChild(iframe),iframe.src='javascript:',iframeDocument=iframe.contentWindow.document,iframeDocument.open(),iframeDocument.write(lt+'script'+gt+'document.F=Object'+lt+'/script'+gt),iframeDocument.close(),createDict=iframeDocument.F;i--;)delete createDict[PROTOTYPE$1][_enumBugKeys[i]];return createDict()},_objectCreate=Object.create||function create(O,Properties){var result;return null===O?result=createDict():(Empty[PROTOTYPE$1]=_anObject(O),result=new Empty,Empty[PROTOTYPE$1]=null,result[IE_PROTO$1]=O),void 0===Properties?result:_objectDps(result,Properties)},hiddenKeys=_enumBugKeys.concat('length','prototype'),f$4=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return _objectKeysInternal(O,hiddenKeys)},_objectGopn={f:f$4},gOPN=_objectGopn.f,toString$1={}.toString,windowNames='object'==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(it){try{return gOPN(it)}catch(e){return windowNames.slice()}},_objectGopnExt={f:function getOwnPropertyNames(it){return windowNames&&'[object Window]'==toString$1.call(it)?getWindowNames(it):gOPN(_toIobject(it))}},gOPD=Object.getOwnPropertyDescriptor,f$6=_descriptors?gOPD:function getOwnPropertyDescriptor(O,P){if(O=_toIobject(O),P=_toPrimitive(P,!0),_ie8DomDefine)try{return gOPD(O,P)}catch(e){}return _has(O,P)?_propertyDesc(!_objectPie.f.call(O,P),O[P]):void 0},_objectGopd={f:f$6},META=_meta.KEY,gOPD$1=_objectGopd.f,dP$1=_objectDp.f,gOPN$1=_objectGopnExt.f,$Symbol=_global.Symbol,$JSON=_global.JSON,_stringify=$JSON&&$JSON.stringify,PROTOTYPE$2='prototype',HIDDEN=_wks('_hidden'),TO_PRIMITIVE=_wks('toPrimitive'),isEnum={}.propertyIsEnumerable,SymbolRegistry=_shared('symbol-registry'),AllSymbols=_shared('symbols'),OPSymbols=_shared('op-symbols'),ObjectProto=Object[PROTOTYPE$2],USE_NATIVE='function'==typeof $Symbol,QObject=_global.QObject,setter=!QObject||!QObject[PROTOTYPE$2]||!QObject[PROTOTYPE$2].findChild,setSymbolDesc=_descriptors&&_fails(function(){return 7!=_objectCreate(dP$1({},'a',{get:function(){return dP$1(this,'a',{value:7}).a}})).a})?function(it,key,D){var protoDesc=gOPD$1(ObjectProto,key);protoDesc&&delete ObjectProto[key],dP$1(it,key,D),protoDesc&&it!==ObjectProto&&dP$1(ObjectProto,key,protoDesc)}:dP$1,wrap=function(tag){var sym=AllSymbols[tag]=_objectCreate($Symbol[PROTOTYPE$2]);return sym._k=tag,sym},isSymbol=USE_NATIVE&&'symbol'==typeof $Symbol.iterator?function(it){return'symbol'==typeof it}:function(it){return it instanceof $Symbol},$defineProperty=function defineProperty(it,key,D){return it===ObjectProto&&$defineProperty(OPSymbols,key,D),_anObject(it),key=_toPrimitive(key,!0),_anObject(D),_has(AllSymbols,key)?(D.enumerable?(_has(it,HIDDEN)&&it[HIDDEN][key]&&(it[HIDDEN][key]=!1),D=_objectCreate(D,{enumerable:_propertyDesc(0,!1)})):(!_has(it,HIDDEN)&&dP$1(it,HIDDEN,_propertyDesc(1,{})),it[HIDDEN][key]=!0),setSymbolDesc(it,key,D)):dP$1(it,key,D)},$defineProperties=function defineProperties(it,P){_anObject(it);for(var keys=_enumKeys(P=_toIobject(P)),i=0,l=keys.length,key;l>i;)$defineProperty(it,key=keys[i++],P[key]);return it},$propertyIsEnumerable=function propertyIsEnumerable(key){var E=isEnum.call(this,key=_toPrimitive(key,!0));return this===ObjectProto&&_has(AllSymbols,key)&&!_has(OPSymbols,key)?!1:E||!_has(this,key)||!_has(AllSymbols,key)||_has(this,HIDDEN)&&this[HIDDEN][key]?E:!0},$getOwnPropertyDescriptor=function getOwnPropertyDescriptor(it,key){if(it=_toIobject(it),key=_toPrimitive(key,!0),it!==ObjectProto||!_has(AllSymbols,key)||_has(OPSymbols,key)){var D=gOPD$1(it,key);return D&&_has(AllSymbols,key)&&!(_has(it,HIDDEN)&&it[HIDDEN][key])&&(D.enumerable=!0),D}},$getOwnPropertyNames=function getOwnPropertyNames(it){for(var names=gOPN$1(_toIobject(it)),result=[],i=0,key;names.length>i;)_has(AllSymbols,key=names[i++])||key==HIDDEN||key==META||result.push(key);return result},$getOwnPropertySymbols=function getOwnPropertySymbols(it){for(var IS_OP=it===ObjectProto,names=gOPN$1(IS_OP?OPSymbols:_toIobject(it)),result=[],i=0,key;names.length>i;)_has(AllSymbols,key=names[i++])&&(!IS_OP||_has(ObjectProto,key))&&result.push(AllSymbols[key]);return result};USE_NATIVE||($Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError('Symbol is not a constructor!');var tag=_uid(0<arguments.length?arguments[0]:void 0),$set=function(value){this===ObjectProto&&$set.call(OPSymbols,value),_has(this,HIDDEN)&&_has(this[HIDDEN],tag)&&(this[HIDDEN][tag]=!1),setSymbolDesc(this,tag,_propertyDesc(1,value))};return _descriptors&&setter&&setSymbolDesc(ObjectProto,tag,{configurable:!0,set:$set}),wrap(tag)},_redefine($Symbol[PROTOTYPE$2],'toString',function toString(){return this._k}),_objectGopd.f=$getOwnPropertyDescriptor,_objectDp.f=$defineProperty,_objectGopn.f=_objectGopnExt.f=$getOwnPropertyNames,_objectPie.f=$propertyIsEnumerable,_objectGops.f=$getOwnPropertySymbols,_descriptors&&!_library&&_redefine(ObjectProto,'propertyIsEnumerable',$propertyIsEnumerable,!0),_wksExt.f=function(name){return wrap(_wks(name))}),_export(_export.G+_export.W+_export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols='hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'.split(','),j=0;es6Symbols.length>j;)_wks(es6Symbols[j++]);for(var wellKnownSymbols=_objectKeys(_wks.store),k=0;wellKnownSymbols.length>k;)_wksDefine(wellKnownSymbols[k++]);_export(_export.S+_export.F*!USE_NATIVE,'Symbol',{for:function(key){return _has(SymbolRegistry,key+='')?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function keyFor(sym){if(!isSymbol(sym))throw TypeError(sym+' is not a symbol!');for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),_export(_export.S+_export.F*!USE_NATIVE,'Object',{create:function create(it,P){return P===void 0?_objectCreate(it):$defineProperties(_objectCreate(it),P)},defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),$JSON&&_export(_export.S+_export.F*(!USE_NATIVE||_fails(function(){var S=$Symbol();return'[null]'!=_stringify([S])||'{}'!=_stringify({a:S})||'{}'!=_stringify(Object(S))})),'JSON',{stringify:function stringify(it){for(var args=[it],i=1,replacer,$replacer;arguments.length>i;)args.push(arguments[i++]);if($replacer=replacer=args[1],(_isObject(replacer)||void 0!==it)&&!isSymbol(it))return _isArray(replacer)||(replacer=function(key,value){if('function'==typeof $replacer&&(value=$replacer.call(this,key,value)),!isSymbol(value))return value}),args[1]=replacer,_stringify.apply($JSON,args)}}),$Symbol[PROTOTYPE$2][TO_PRIMITIVE]||_hide($Symbol[PROTOTYPE$2],TO_PRIMITIVE,$Symbol[PROTOTYPE$2].valueOf),_setToStringTag($Symbol,'Symbol'),_setToStringTag(Math,'Math',!0),_setToStringTag(_global.JSON,'JSON',!0);var TAG$1=_wks('toStringTag'),ARG='Arguments'==_cof(function(){return arguments}()),tryGet=function(it,key){try{return it[key]}catch(e){}},_classof=function(it){var O,T,B;return it===void 0?'Undefined':null===it?'Null':'string'==typeof(T=tryGet(O=Object(it),TAG$1))?T:ARG?_cof(O):'Object'==(B=_cof(O))&&'function'==typeof O.callee?'Arguments':B};({})[_wks('toStringTag')]='z',_redefine(Object.prototype,'toString',function toString(){return'[object '+_classof(this)+']'},!0),_wksDefine('asyncIterator'),_wksDefine('observable');var symbol=_core.Symbol,_iterators={},IteratorPrototype={};_hide(IteratorPrototype,_wks('iterator'),function(){return this});var _iterCreate=function(Constructor,NAME,next){Constructor.prototype=_objectCreate(IteratorPrototype,{next:_propertyDesc(1,next)}),_setToStringTag(Constructor,NAME+' Iterator')},IE_PROTO$2=_sharedKey('IE_PROTO'),ObjectProto$1=Object.prototype,_objectGpo=Object.getPrototypeOf||function(O){return O=_toObject(O),_has(O,IE_PROTO$2)?O[IE_PROTO$2]:'function'==typeof O.constructor&&O instanceof O.constructor?O.constructor.prototype:O instanceof Object?ObjectProto$1:null},ITERATOR=_wks('iterator'),BUGGY=!([].keys&&'next'in[].keys()),KEYS='keys',VALUES='values',returnThis=function(){return this},_iterDefine=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){_iterCreate(Constructor,NAME,next);var getMethod=function(kind){return!BUGGY&&kind in proto?proto[kind]:kind===KEYS?function keys(){return new Constructor(this,kind)}:kind===VALUES?function values(){return new Constructor(this,kind)}:function entries(){return new Constructor(this,kind)}},TAG=NAME+' Iterator',DEF_VALUES=DEFAULT==VALUES,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto['@@iterator']||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT),$entries=DEFAULT?DEF_VALUES?getMethod('entries'):$default:void 0,$anyNative='Array'==NAME?proto.entries||$native:$native,methods,key,IteratorPrototype;if($anyNative&&(IteratorPrototype=_objectGpo($anyNative.call(new Base)),IteratorPrototype!==Object.prototype&&IteratorPrototype.next&&(_setToStringTag(IteratorPrototype,TAG,!0),'function'!=typeof IteratorPrototype[ITERATOR]&&_hide(IteratorPrototype,ITERATOR,returnThis))),DEF_VALUES&&$native&&$native.name!==VALUES&&(VALUES_BUG=!0,$default=function values(){return $native.call(this)}),(BUGGY||VALUES_BUG||!proto[ITERATOR])&&_hide(proto,ITERATOR,$default),_iterators[NAME]=$default,_iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:$entries},FORCED)for(key in methods)key in proto||_redefine(proto,key,methods[key]);else _export(_export.P+_export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods},$at=function(TO_STRING){return function(that,pos){var s=_defined(that)+'',i=_toInteger(pos),l=s.length,a,b;return 0>i||i>=l?TO_STRING?'':void 0:(a=s.charCodeAt(i),55296>a||56319<a||i+1===l||56320>(b=s.charCodeAt(i+1))||57343<b?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536)}}(!0);_iterDefine(String,'String',function(iterated){this._t=iterated+'',this._i=0},function(){var O=this._t,index=this._i,point;return index>=O.length?{value:void 0,done:!0}:(point=$at(O,index),this._i+=point.length,{value:point,done:!1})});var _iterStep=function(done,value){return{value:value,done:!!done}},es6_array_iterator=_iterDefine(Array,'Array',function(iterated,kind){this._t=_toIobject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,_iterStep(1)):'keys'==kind?_iterStep(0,index):'values'==kind?_iterStep(0,O[index]):_iterStep(0,[index,O[index]])},'values');_iterators.Arguments=_iterators.Array,_addToUnscopables('keys'),_addToUnscopables('values'),_addToUnscopables('entries');for(var ITERATOR$1=_wks('iterator'),TO_STRING_TAG=_wks('toStringTag'),ArrayValues=_iterators.Array,DOMIterables={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},collections=_objectKeys(DOMIterables),i=0;i<collections.length;i++){var NAME=collections[i],explicit=DOMIterables[NAME],Collection=_global[NAME],proto=Collection&&Collection.prototype,key;if(proto&&(proto[ITERATOR$1]||_hide(proto,ITERATOR$1,ArrayValues),proto[TO_STRING_TAG]||_hide(proto,TO_STRING_TAG,NAME),_iterators[NAME]=ArrayValues,explicit))for(key in es6_array_iterator)proto[key]||_redefine(proto,key,es6_array_iterator[key],!0)}_wksExt.f('iterator')}).call(__webpack_exports__,__webpack_require__(150).setImmediate,__webpack_require__(0))},function(module,exports,__webpack_require__){'use strict';function deepExtend(target,source){if(!(source instanceof Object))return source;switch(source.constructor){case Date:return new Date(source.getTime());case Object:target===void 0&&(target={});break;case Array:target=[];break;default:return source;}for(var prop in source)source.hasOwnProperty(prop)&&(target[prop]=deepExtend(target[prop],source[prop]));return target}function jsonEval(str){return JSON.parse(str)}function implementsAnyMethods(obj,methods){if('object'!=typeof obj||null===obj)return!1;for(var _i=0,methods_1=methods,method;_i<methods_1.length;_i++)if(method=methods_1[_i],method in obj&&'function'==typeof obj[method])return!0;return!1}function noop(){}function errorPrefix(fnName,argumentNumber,optional){var argName='';switch(argumentNumber){case 1:argName=optional?'first':'First';break;case 2:argName=optional?'second':'Second';break;case 3:argName=optional?'third':'Third';break;case 4:argName=optional?'fourth':'Fourth';break;default:throw new Error('errorPrefix called with argumentNumber > 4.  Need to update it?');}var error=fnName+' failed: ';return error+=argName+' argument ',error}var _StringfromCharCode=String.fromCharCode;Object.defineProperty(exports,'__esModule',{value:!0});var tslib_1=__webpack_require__(19),CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:'${JSCORE_VERSION}'},assert=function(assertion,message){if(!assertion)throw assertionError(message)},assertionError=function(message){return new Error('Firebase Database ('+CONSTANTS.SDK_VERSION+') INTERNAL ASSERT FAILED: '+message)},stringToByteArray=function(str){for(var out=[],p=0,i=0,c;i<str.length;i++)c=str.charCodeAt(i),128>c?out[p++]=c:2048>c?(out[p++]=192|c>>6,out[p++]=128|63&c):55296==(64512&c)&&i+1<str.length&&56320==(64512&str.charCodeAt(i+1))?(c=65536+((1023&c)<<10)+(1023&str.charCodeAt(++i)),out[p++]=240|c>>18,out[p++]=128|63&c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c):(out[p++]=224|c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c);return out},byteArrayToString=function(bytes){for(var out=[],pos=0,c=0;pos<bytes.length;){var c1=bytes[pos++];if(128>c1)out[c++]=_StringfromCharCode(c1);else if(191<c1&&224>c1){var c2=bytes[pos++];out[c++]=_StringfromCharCode((31&c1)<<6|63&c2)}else if(239<c1&&365>c1){var c2=bytes[pos++],c3=bytes[pos++],c4=bytes[pos++],u=((7&c1)<<18|(63&c2)<<12|(63&c3)<<6|63&c4)-65536;out[c++]=_StringfromCharCode(55296+(u>>10)),out[c++]=_StringfromCharCode(56320+(1023&u))}else{var c2=bytes[pos++],c3=bytes[pos++];out[c++]=_StringfromCharCode((15&c1)<<12|(63&c2)<<6|63&c3)}}return out.join('')},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:'ABCDEFGHIJKLMNOPQRSTUVWXYZ'+'abcdefghijklmnopqrstuvwxyz'+'0123456789',get ENCODED_VALS(){return this.ENCODED_VALS_BASE+'+/='},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+'-_.'},HAS_NATIVE_SUPPORT:'function'==typeof atob,encodeByteArray:function(input,opt_webSafe){if(!Array.isArray(input))throw Error('encodeByteArray takes an array as a parameter');this.init_();for(var byteToCharMap=opt_webSafe?this.byteToCharMapWebSafe_:this.byteToCharMap_,output=[],i=0;i<input.length;i+=3){var byte1=input[i],haveByte2=i+1<input.length,byte2=haveByte2?input[i+1]:0,haveByte3=i+2<input.length,byte3=haveByte3?input[i+2]:0,outByte3=(15&byte2)<<2|byte3>>6,outByte4=63&byte3;haveByte3||(outByte4=64,!haveByte2&&(outByte3=64)),output.push(byteToCharMap[byte1>>2],byteToCharMap[(3&byte1)<<4|byte2>>4],byteToCharMap[outByte3],byteToCharMap[outByte4])}return output.join('')},encodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?btoa(input):this.encodeByteArray(stringToByteArray(input),opt_webSafe)},decodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?atob(input):byteArrayToString(this.decodeStringToByteArray(input,opt_webSafe))},decodeStringToByteArray:function(input,opt_webSafe){this.init_();for(var charToByteMap=opt_webSafe?this.charToByteMapWebSafe_:this.charToByteMap_,output=[],i=0;i<input.length;){var byte1=charToByteMap[input.charAt(i++)],haveByte2=i<input.length,byte2=haveByte2?charToByteMap[input.charAt(i)]:0;++i;var haveByte3=i<input.length,byte3=haveByte3?charToByteMap[input.charAt(i)]:64;++i;var haveByte4=i<input.length,byte4=haveByte4?charToByteMap[input.charAt(i)]:64;if(++i,null==byte1||null==byte2||null==byte3||null==byte4)throw Error();if(output.push(byte1<<2|byte2>>4),64!=byte3){if(output.push(240&byte2<<4|byte3>>2),64!=byte4){output.push(192&byte3<<6|byte4)}}}return output},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}},base64Decode=function(str){try{return base64.decodeString(str,!0)}catch(e){console.error('base64Decode failed: ',e)}return null},Deferred=function(){function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve,_this.reject=reject})}return Deferred.prototype.wrapCallback=function(callback){var _this=this;return function(error,value){error?_this.reject(error):_this.resolve(value),'function'==typeof callback&&(_this.promise.catch(function(){}),1===callback.length?callback(error):callback(error,value))}},Deferred}(),getUA=function(){return'undefined'!=typeof navigator&&'string'==typeof navigator.userAgent?navigator.userAgent:''},ERROR_NAME='FirebaseError',captureStackTrace=Error.captureStackTrace,FirebaseError=function(){return function FirebaseError(code,message){if(this.code=code,this.message=message,captureStackTrace)captureStackTrace(this,ErrorFactory.prototype.create);else try{throw Error.apply(this,arguments)}catch(err){this.name=ERROR_NAME,Object.defineProperty(this,'stack',{get:function(){return err.stack}})}}}();FirebaseError.prototype=Object.create(Error.prototype),FirebaseError.prototype.constructor=FirebaseError,FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors,this.pattern=/\{\$([^}]+)}/g}return ErrorFactory.prototype.create=function(code,data){void 0===data&&(data={});var template=this.errors[code],fullCode=this.service+'/'+code,message;message=void 0===template?'Error':template.replace(this.pattern,function(match,key){var value=data[key];return void 0===value?'<'+key+'?>':value.toString()}),message=this.serviceName+': '+message+' ('+fullCode+').';var err=new FirebaseError(fullCode,message);for(var prop in data)data.hasOwnProperty(prop)&&'_'!==prop.slice(-1)&&(err[prop]=data[prop]);return err},ErrorFactory}(),decode=function(token){var header={},claims={},data={},signature='';try{var parts=token.split('.');header=jsonEval(base64Decode(parts[0])||''),claims=jsonEval(base64Decode(parts[1])||''),signature=parts[2],data=claims.d||{},delete claims.d}catch(e){}return{header:header,claims:claims,data:data,signature:signature}},forEach=function(obj,fn){for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&fn(key,obj[key])},extend=function(objTo,objFrom){return forEach(objFrom,function(key,value){objTo[key]=value}),objTo},findKey=function(obj,fn,opt_this){for(var key in obj)if(fn.call(opt_this,obj[key],key,obj))return key},Hash=function(){return function Hash(){this.blockSize=-1}}(),Sha1=function(_super){function Sha1(){var _this=_super.call(this)||this;_this.chain_=[],_this.buf_=[],_this.W_=[],_this.pad_=[],_this.inbuf_=0,_this.total_=0,_this.blockSize=512/8,_this.pad_[0]=128;for(var i=1;i<_this.blockSize;++i)_this.pad_[i]=0;return _this.reset(),_this}return tslib_1.__extends(Sha1,_super),Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,opt_offset){opt_offset||(opt_offset=0);var W=this.W_;if('string'==typeof buf)for(var i=0;16>i;i++)W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3),opt_offset+=4;else for(var i=0;16>i;i++)W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3],opt_offset+=4;for(var i=16,t;80>i;i++)t=W[i-3]^W[i-8]^W[i-14]^W[i-16],W[i]=4294967295&(t<<1|t>>>31);for(var a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],i=0,f,k;80>i;i++){40>i?20>i?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):60>i?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=4294967295&(a<<5|a>>>27)+f+e+k+W[i];e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=4294967295&this.chain_[0]+a,this.chain_[1]=4294967295&this.chain_[1]+b,this.chain_[2]=4294967295&this.chain_[2]+c,this.chain_[3]=4294967295&this.chain_[3]+d,this.chain_[4]=4294967295&this.chain_[4]+e},Sha1.prototype.update=function(bytes,opt_length){if(null!=bytes){void 0===opt_length&&(opt_length=bytes.length);for(var lengthMinusBlock=opt_length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<opt_length;){if(0==inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if('string'==typeof bytes){for(;n<opt_length;)if(buf[inbuf]=bytes.charCodeAt(n),++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<opt_length;)if(buf[inbuf]=bytes[n],++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=opt_length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;56>this.inbuf_?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;56<=i;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);for(var n=0,i=0;5>i;i++)for(var j=24;0<=j;j-=8)digest[n]=255&this.chain_[i]>>j,++n;return digest},Sha1}(Hash),ObserverProxy=function(){function ObserverProxy(executor,onNoObservers){var _this=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=onNoObservers,this.task.then(function(){executor(_this)}).catch(function(e){_this.error(e)})}return ObserverProxy.prototype.next=function(value){this.forEachObserver(function(observer){observer.next(value)})},ObserverProxy.prototype.error=function(error){this.forEachObserver(function(observer){observer.error(error)}),this.close(error)},ObserverProxy.prototype.complete=function(){this.forEachObserver(function(observer){observer.complete()}),this.close()},ObserverProxy.prototype.subscribe=function(nextOrObserver,error,complete){var _this=this,observer;if(void 0===nextOrObserver&&void 0===error&&void 0===complete)throw new Error('Missing Observer.');observer=implementsAnyMethods(nextOrObserver,['next','error','complete'])?nextOrObserver:{next:nextOrObserver,error:error,complete:complete},void 0===observer.next&&(observer.next=noop),void 0===observer.error&&(observer.error=noop),void 0===observer.complete&&(observer.complete=noop);var unsub=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{_this.finalError?observer.error(_this.finalError):observer.complete()}catch(e){}}),this.observers.push(observer),unsub},ObserverProxy.prototype.unsubscribeOne=function(i){void 0===this.observers||void 0===this.observers[i]||(delete this.observers[i],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},ObserverProxy.prototype.forEachObserver=function(fn){if(!this.finalized)for(var i=0;i<this.observers.length;i++)this.sendOne(i,fn)},ObserverProxy.prototype.sendOne=function(i,fn){var _this=this;this.task.then(function(){if(void 0!==_this.observers&&void 0!==_this.observers[i])try{fn(_this.observers[i])}catch(e){'undefined'!=typeof console&&console.error&&console.error(e)}})},ObserverProxy.prototype.close=function(err){var _this=this;this.finalized||(this.finalized=!0,void 0!==err&&(this.finalError=err),this.task.then(function(){_this.observers=void 0,_this.onNoObservers=void 0}))},ObserverProxy}();exports.assert=assert,exports.assertionError=assertionError,exports.base64=base64,exports.base64Decode=base64Decode,exports.base64Encode=function(str){var utf8Bytes=stringToByteArray(str);return base64.encodeByteArray(utf8Bytes,!0)},exports.CONSTANTS=CONSTANTS,exports.deepCopy=function deepCopy(value){return deepExtend(void 0,value)},exports.deepExtend=deepExtend,exports.patchProperty=function patchProperty(obj,prop,value){obj[prop]=value},exports.Deferred=Deferred,exports.getUA=getUA,exports.isMobileCordova=function(){return'undefined'!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())},exports.isNodeSdk=function(){return!0===CONSTANTS.NODE_CLIENT||!0===CONSTANTS.NODE_ADMIN},exports.isReactNative=function(){return'object'==typeof navigator&&'ReactNative'===navigator.product},exports.ErrorFactory=ErrorFactory,exports.FirebaseError=FirebaseError,exports.patchCapture=function patchCapture(captureFake){var result=captureStackTrace;return captureStackTrace=captureFake,result},exports.jsonEval=jsonEval,exports.stringify=function stringify(data){return JSON.stringify(data)},exports.decode=decode,exports.isAdmin=function(token){var claims=decode(token).claims;return'object'==typeof claims&&!0===claims.admin},exports.issuedAtTime=function(token){var claims=decode(token).claims;return'object'==typeof claims&&claims.hasOwnProperty('iat')?claims.iat:null},exports.isValidFormat=function(token){var decoded=decode(token),claims=decoded.claims;return!!claims&&'object'==typeof claims&&claims.hasOwnProperty('iat')},exports.isValidTimestamp=function(token){var claims=decode(token).claims,now=Math.floor(new Date().getTime()/1e3),validSince,validUntil;return'object'==typeof claims&&(claims.hasOwnProperty('nbf')?validSince=claims.nbf:claims.hasOwnProperty('iat')&&(validSince=claims.iat),validUntil=claims.hasOwnProperty('exp')?claims.exp:validSince+86400),now&&validSince&&validUntil&&now>=validSince&&now<=validUntil},exports.clone=function(obj){return extend({},obj)},exports.contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},exports.every=function(obj,fn){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&!fn(key,obj[key]))return!1;return!0},exports.extend=extend,exports.findKey=findKey,exports.findValue=function(obj,fn,opt_this){var key=findKey(obj,fn,opt_this);return key&&obj[key]},exports.forEach=forEach,exports.getAnyKey=function(obj){for(var key in obj)return key},exports.getCount=function(obj){var rv=0;for(var key in obj)rv++;return rv},exports.getValues=function(obj){var res=[],i=0;for(var key in obj)res[i++]=obj[key];return res},exports.isEmpty=function(obj){for(var key in obj)return!1;return!0},exports.isNonNullObject=function(obj){return'object'==typeof obj&&null!==obj},exports.map=function(obj,f,opt_obj){var res={};for(var key in obj)res[key]=f.call(opt_obj,obj[key],key,obj);return res},exports.safeGet=function(obj,key){if(Object.prototype.hasOwnProperty.call(obj,key))return obj[key]},exports.querystring=function(querystringParams){var params=[];return forEach(querystringParams,function(key,value){Array.isArray(value)?value.forEach(function(arrayVal){params.push(encodeURIComponent(key)+'='+encodeURIComponent(arrayVal))}):params.push(encodeURIComponent(key)+'='+encodeURIComponent(value))}),params.length?'&'+params.join('&'):''},exports.querystringDecode=function(querystring){var obj={},tokens=querystring.replace(/^\?/,'').split('&');return tokens.forEach(function(token){if(token){var key=token.split('=');obj[key[0]]=key[1]}}),obj},exports.Sha1=Sha1,exports.async=function async(fn,onError){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];Promise.resolve(!0).then(function(){fn.apply(void 0,args)}).catch(function(error){onError&&onError(error)})}},exports.createSubscribe=function createSubscribe(executor,onNoObservers){var proxy=new ObserverProxy(executor,onNoObservers);return proxy.subscribe.bind(proxy)},exports.errorPrefix=errorPrefix,exports.validateArgCount=function(fnName,minCount,maxCount,argCount){var argError;if(argCount<minCount?argError='at least '+minCount:argCount>maxCount&&(argError=0===maxCount?'none':'no more than '+maxCount),argError){var error=fnName+' failed: Was called with '+argCount+(1===argCount?' argument.':' arguments.')+' Expects '+argError+'.';throw new Error(error)}},exports.validateCallback=function validateCallback(fnName,argumentNumber,callback,optional){if((!optional||callback)&&'function'!=typeof callback)throw new Error(errorPrefix(fnName,argumentNumber,optional)+'must be a valid function.')},exports.validateContextObject=function validateContextObject(fnName,argumentNumber,context,optional){if((!optional||context)&&('object'!=typeof context||null===context))throw new Error(errorPrefix(fnName,argumentNumber,optional)+'must be a valid context object.')},exports.validateNamespace=function validateNamespace(fnName,argumentNumber,namespace,optional){if((!optional||namespace)&&'string'!=typeof namespace)throw new Error(errorPrefix(fnName,argumentNumber,optional)+'must be a valid firebase namespace.')},exports.stringLength=function(str){for(var p=0,i=0,c;i<str.length;i++)c=str.charCodeAt(i),128>c?p++:2048>c?p+=2:55296<=c&&56319>=c?(p+=4,i++):p+=3;return p},exports.stringToByteArray=function(str){for(var out=[],p=0,i=0,c;i<str.length;i++){if(c=str.charCodeAt(i),55296<=c&&56319>=c){var high=c-55296;i++,assert(i<str.length,'Surrogate pair missing trail surrogate.');var low=str.charCodeAt(i)-56320;c=65536+(high<<10)+low}128>c?out[p++]=c:2048>c?(out[p++]=192|c>>6,out[p++]=128|63&c):65536>c?(out[p++]=224|c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c):(out[p++]=240|c>>18,out[p++]=128|63&c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c)}return out}},function(module,__webpack_exports__,__webpack_require__){'use strict';var _Mathround=Math.round,_Mathfloor2=Math.floor,_Mathmax2=Math.max;(function(global){function l(a){return'string'==typeof a}function m(a,b){a=a.split('.'),b=b||h;for(var c=0;c<a.length;c++)if(b=b[a[c]],null==b)return null;return b}function aa(){}function ba(a){var b=typeof a;if('object'==b){if(a){if(a instanceof Array)return'array';if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if('[object Window]'==c)return'object';if('[object Array]'==c||'number'==typeof a.length&&'undefined'!=typeof a.splice&&'undefined'!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable('splice'))return'array';if('[object Function]'==c||'undefined'!=typeof a.call&&'undefined'!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable('call'))return'function'}else return'null';}else if('function'==b&&'undefined'==typeof a.call)return'object';return b}function n(a){return'array'==ba(a)}function ca(a){var b=ba(a);return'array'==b||'object'==b&&'number'==typeof a.length}function q(a){return'function'==ba(a)}function r(a){var b=typeof a;return'object'==b&&null!=a||'function'==b}function ea(a){return a.call.apply(a.bind,arguments)}function fa(a,b){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function u(){return u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf('native code')?ea:fa,u.apply(null,arguments)}function v(a){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();return b.push.apply(b,arguments),a.apply(this,b)}}function x(a,b){function c(){}c.prototype=b.prototype,a.L=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.mh=function(a,c){for(var d=Array(arguments.length-2),f=2;f<arguments.length;f++)d[f-2]=arguments[f];return b.prototype[c].apply(a,d)}}function y(a){if(Error.captureStackTrace)Error.captureStackTrace(this,y);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=a+'')}function ha(a,b){a=a.split('%s');for(var c='',d=a.length-1,f=0;f<d;f++)c+=a[f]+(f<b.length?b[f]:'%s');y.call(this,c+a[d])}function ia(a){throw new ha('Failure'+(a?': '+a:''),Array.prototype.slice.call(arguments,1))}function z(){0!=ja&&(ka[this[t]||(this[t]=++da)]=this),this.Ka=this.Ka,this.Qa=this.Qa}function pa(a){a:{for(var b=qa,c=a.length,d=l(a)?a.split(''):a,f=0;f<c;f++)if(f in d&&b.call(void 0,d[f],f,a)){b=f;break a}b=-1}return 0>b?null:l(a)?a.charAt(b):a[b]}function ra(a){if(!n(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function sa(a,b){b=la(a,b);var c;return(c=0<=b)&&Array.prototype.splice.call(a,b,1),c}function ta(){return Array.prototype.concat.apply([],arguments)}function ua(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function va(a){return /^[\s\xa0]*$/.test(a)}function xa(a,b){return a<b?-1:a>b?1:0}function B(a){return-1!=A.indexOf(a)}function Aa(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function Ba(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Ca(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Da(a){var b={},c;for(c in a)b[c]=a[c];return b}function Fa(a){for(var f=1,c,d;f<arguments.length;f++){for(c in d=arguments[f],d)a[c]=d[c];for(var g=0;g<Ea.length;g++)c=Ea[g],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Ga(a){return Ga[' '](a),a}function Ha(a,b){var c=Ia;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)}function Oa(){var a=h.document;return a?a.documentMode:void 0}function Ta(a){return Ha(a,function(){for(var b=0,c=wa(Pa+'').split('.'),d=wa(a+'').split('.'),f=_Mathmax2(c.length,d.length),g=0;0==b&&g<f;g++){var k=c[g]||'',p=d[g]||'';do{if(k=/(\d*)(\D*)(.*)/.exec(k)||['','','',''],p=/(\d*)(\D*)(.*)/.exec(p)||['','','',''],0==k[0].length&&0==p[0].length)break;b=xa(0==k[1].length?0:parseInt(k[1],10),0==p[1].length?0:parseInt(p[1],10))||xa(0==k[2].length,0==p[2].length)||xa(k[2],p[2]),k=k[3],p=p[3]}while(0==b)}return 0<=b})}function D(a,b){this.type=a,this.currentTarget=this.target=b,this.defaultPrevented=this.Ea=!1,this.Be=!0}function E(a,b){D.call(this,a?a.type:''),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key='',this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType='',this.fb=null,a&&this.Kf(a,b)}function F(a){return a&&a[ab]}function cb(a,b,c,d,f){this.listener=a,this.proxy=null,this.src=b,this.type=c,this.capture=!!d,this.Ob=f,this.key=++bb,this.Sa=this.Eb=!1}function db(a){this.src=a,this.J={},this.xb=0}function eb(a,b,c,d){for(var f=0,g;f<a.length;++f)if(g=a[f],!g.Sa&&g.listener==b&&g.capture==!!c&&g.Ob==d)return f;return-1}function ib(a,b,c,d,f){if(d&&d.once)return jb(a,b,c,d,f);if(n(b)){for(var g=0;g<b.length;g++)ib(a,b[g],c,d,f);return null}return c=kb(c),F(a)?a.nb(b,c,r(d)?!!d.capture:!!d,f):lb(a,b,c,!1,d,f)}function lb(a,b,c,d,f,g){if(!b)throw Error('Invalid event type');var k=r(f)?!!f.capture:!!f,p=G(a);if(p||(a[fb]=p=new db(a)),c=p.add(b,c,d,k,g),c.proxy)return c;if(d=mb(),c.proxy=d,d.src=a,d.listener=c,a.addEventListener)Za||(f=k),void 0===f&&(f=!1),a.addEventListener(b.toString(),d,f);else if(a.attachEvent)a.attachEvent(nb(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error('addEventListener and attachEvent are unavailable.');return c}function mb(){var a=ob,b=Xa?function(c){return a.call(b.src,b.listener,c)}:function(c){if(c=a.call(b.src,b.listener,c),!c)return c};return b}function jb(a,b,c,d,f){if(n(b)){for(var g=0;g<b.length;g++)jb(a,b[g],c,d,f);return null}return c=kb(c),F(a)?a.Oc(b,c,r(d)?!!d.capture:!!d,f):lb(a,b,c,!0,d,f)}function pb(a,b,c,d,f){if(n(b))for(var g=0;g<b.length;g++)pb(a,b[g],c,d,f);else d=r(d)?!!d.capture:!!d,c=kb(c),F(a)?a.ed(b,c,d,f):a&&(a=G(a))&&(b=a.jb(b,c,d,f))&&qb(b)}function qb(a){if('number'!=typeof a&&a&&!a.Sa){var b=a.src;if(F(b))b.Le(a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(nb(c),d):b.addListener&&b.removeListener&&b.removeListener(d),(c=G(b))?(c.ye(a),0==c.xb&&(c.src=null,b[fb]=null)):a.Vb()}}}function nb(a){return a in gb?gb[a]:gb[a]='on'+a}function rb(a,b,c,d){var f=!0;if((a=G(a))&&(b=a.J[b.toString()]))for(b=b.concat(),a=0;a<b.length;a++){var g=b[a];g&&g.capture==c&&!g.Sa&&(g=sb(g,d),f=f&&!1!==g)}return f}function sb(a,b){var c=a.listener,d=a.Ob||a.src;return a.Eb&&qb(a),c.call(d,b)}function ob(a,b){if(a.Sa)return!0;if(!Xa){var c=b||m('window.event');b=new E(c,this);var d=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(k){f=!0}(f||void 0==c.returnValue)&&(c.returnValue=!0)}for(c=[],f=b.currentTarget;f;f=f.parentNode)c.push(f);for(a=a.type,f=c.length-1;!b.Ea&&0<=f;f--){b.currentTarget=c[f];var g=rb(c[f],a,!0,b);d=d&&g}for(f=0;!b.Ea&&f<c.length;f++)b.currentTarget=c[f],g=rb(c[f],a,!1,b),d=d&&g}return d}return sb(a,new E(b,this))}function G(a){return a=a[fb],a instanceof db?a:null}function kb(a){return q(a)?a:(a[tb]||(a[tb]=function(b){return a.handleEvent(b)}),a[tb])}function H(){z.call(this),this.ka=new db(this),this.Pe=this,this.Uc=null}function vb(a,b){this.Sf=100,this.ef=a,this.ug=b,this.Zb=0,this.Pb=null}function I(){this.lc=this.Va=null}function wb(){this.next=this.scope=this.Gc=null}function yb(a){h.setTimeout(function(){throw a},0)}function Ab(){var a=h.MessageChannel;if('undefined'==typeof a&&'undefined'!=typeof window&&window.postMessage&&window.addEventListener&&!B('Presto')&&(a=function(){var a=document.createElement('IFRAME');a.style.display='none',a.src='',document.documentElement.appendChild(a);var b=a.contentWindow;a=b.document,a.open(),a.write(''),a.close();var c='callImmediate'+Math.random(),d='file:'==b.location.protocol?'*':b.location.protocol+'//'+b.location.host;a=u(function(a){('*'==d||a.origin==d)&&a.data==c&&this.port1.onmessage()},this),b.addEventListener('message',a,!1),this.port1={},this.port2={postMessage:function(){b.postMessage(c,d)}}}),'undefined'!=typeof a&&!B('Trident')&&!B('MSIE')){var b=new a,c={},d=c;return b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.rd;c.rd=null,a()}},function(a){d.next={rd:a},d=d.next,b.port2.postMessage(0)}}return'undefined'!=typeof document&&'onreadystatechange'in document.createElement('SCRIPT')?function(a){var b=document.createElement('SCRIPT');b.onreadystatechange=function(){b.onreadystatechange=null,b.parentNode.removeChild(b),b=null,a(),a=null},document.documentElement.appendChild(b)}:function(a){h.setTimeout(a,0)}}function Cb(){if(h.Promise&&h.Promise.resolve){var a=h.Promise.resolve(void 0);Bb=function(){a.then(Db)}}else Bb=function(){var a=Db;!q(h.setImmediate)||h.Window&&h.Window.prototype&&!B('Edge')&&h.Window.prototype.setImmediate==h.setImmediate?(zb||(zb=Ab()),zb(a)):h.setImmediate(a)}}function Db(){for(var a;a=Fb.remove();){try{a.Gc.call(a.scope)}catch(b){yb(b)}Fb.wg(a)}Eb=!1}function Gb(a,b){H.call(this),this.Na=a||1,this.wb=b||h,this.nd=u(this.Rg,this),this.ie=w()}function Hb(a,b,c){if(q(a))c&&(a=u(a,c));else if(a&&'function'==typeof a.handleEvent)a=u(a.handleEvent,a);else throw Error('Invalid listener argument');return 2147483647<+b?-1:h.setTimeout(a,b||0)}function Ib(a,b,c){z.call(this),this.Uf=null==c?a:u(a,c),this.Na=b,this.Xe=u(this.fg,this),this.qc=[]}function Jb(a){z.call(this),this.i=a,this.o={}}function J(a,b,c){this.reset(a,b,c,void 0,void 0)}function Mb(a){this.pe=a,this.Zd=this.uc=this.mb=this.$b=null}function K(a,b){this.name=a,this.value=b}function Vb(a){Tb||(Tb=new Mb(''),Sb['']=Tb,Tb.Ge(Qb));var b;if(!(b=Sb[a])){b=new Mb(a);var c=a.lastIndexOf('.'),d=a.substr(c+1);c=Vb(a.substr(0,c)),c.Qe(d,b),b.Fg(c),Sb[a]=b}return b}function Wb(a,b){a&&a.info(b,void 0)}function L(a,b){a&&a.lf(b)}function Xb(){this.s=Vb('goog.labs.net.webChannel.WebChannelDebug'),this.Wc=!0}function Yb(a){D.call(this,'serverreachability',a)}function N(a){M.dispatchEvent(new Yb(M,a))}function Zb(a,b){D.call(this,'statevent',a),this.stat=b}function O(a){M.dispatchEvent(new Zb(M,a))}function $b(a,b,c){D.call(this,'timingevent',a),this.size=b,this.rtt=c}function ac(a,b,c){M.dispatchEvent(new $b(M,a,b,c))}function P(a,b){if(!q(a))throw Error('Fn must not be null and must be a function');return h.setTimeout(function(){a()},b)}function dc(){}function ec(){}function fc(){D.call(this,'d')}function gc(){D.call(this,'c')}function ic(){}function R(a,b,c,d,f){this.b=a,this.a=b,this.ra=c,this.R=d,this.Xc=f||1,this.Fc=new Jb(this),this.Ua=jc,a=La?125:void 0,this.Vc=new Gb(a),this.A=null,this.S=!1,this.Da=this.pa=this.ua=this.ic=this.qb=this.hd=this.Ga=null,this.ba=[],this.h=null,this.Bb=0,this.I=this.Fa=null,this.w=-1,this.Za=!1,this.Ra=0,this.ac=null,this.lb=this.Ed=this.yc=!1}function kc(a,b){return 0===a?'Non-200 return code ('+b+')':1===a?'XMLHTTP failure (no data)':2===a?'HttpConnection timeout':'Unknown error'}function nc(a){if(a.H&&'function'==typeof a.H)return a.H();if(l(a))return a.split('');if(ca(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Ba(a)}function oc(a,b,c){if(a.forEach&&'function'==typeof a.forEach)a.forEach(b,c);else if(ca(a)||l(a))na(a,b,c);else{if(a.W&&'function'==typeof a.W)var d=a.W();else if(a.H&&'function'==typeof a.H)d=void 0;else if(ca(a)||l(a)){d=[];for(var f=a.length,g=0;g<f;g++)d.push(g)}else d=Ca(a);f=nc(a),g=f.length;for(var k=0;k<g;k++)b.call(c,f[k],d&&d[k],a)}}function S(a){this.D={},this.o=[],this.j=0;var c=arguments.length;if(1<c){if(c%2)throw Error('Uneven number of arguments');for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.addAll(a)}function T(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function qc(a,b){if(a){a=a.split('&');for(var c=0;c<a.length;c++){var d=a[c].indexOf('='),f=null;if(0<=d){var g=a[c].substring(0,d);f=a[c].substring(d+1)}else g=a[c];b(g,f?decodeURIComponent(f.replace(/\+/g,' ')):'')}}}function U(a,b){this.xa=this.zb=this.qa='',this.Ca=null,this.ib=this.K='',this.O=this.Qf=!1;var c;a instanceof U?(this.O=void 0===b?a.O:b,this.tb(a.qa),this.cd(a.zb),this.rb(a.xa),this.sb(a.Ca),this.ec(a.K),this.bd(a.P.clone()),this.$c(a.ib)):a&&(c=(a+'').match(pc))?(this.O=!!b,this.tb(c[1]||'',!0),this.cd(c[2]||'',!0),this.rb(c[3]||'',!0),this.sb(c[4]),this.ec(c[5]||'',!0),this.bd(c[6]||'',!0),this.$c(c[7]||'',!0)):(this.O=!!b,this.P=new rc(null,this.O))}function Ac(a){return a instanceof U?a.clone():new U(a,void 0)}function Bc(a,b,c,d){var f=new U(null,void 0);return a&&f.tb(a),b&&f.rb(b),c&&f.sb(c),d&&f.ec(d),f}function yc(a,b){return a?b?decodeURI(a.replace(/%25/g,'%2525')):decodeURIComponent(a):''}function sc(a,b,c){return l(a)?(a=encodeURI(a).replace(b,Cc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,'%$1')),a):null}function Cc(a){return a=a.charCodeAt(0),'%'+(15&a>>4).toString(16)+(15&a).toString(16)}function rc(a,b){this.j=this.m=null,this.ja=a||null,this.O=!!b}function Hc(a,b){this.b=a,this.a=b,this.f=this.A=null,this.bc=!1,this.K=null,this.w=-1,this.Ad=this.na=null}function Ic(){this.od=this.$d=null}function Jc(a){this.D=new S,a&&this.addAll(a)}function Kc(a){var b=typeof a;return'object'==b&&a||'function'==b?'o'+(a[t]||(a[t]=++da)):b.substr(0,1)+a}function Lc(a,b){this.Pc=a,this.map=b,this.context=null}function Mc(a){this.me=a||Nc,h.PerformanceNavigationTiming?(a=h.performance.getEntriesByType('navigation'),a=0<a.length&&('hq'==a[0].nextHopProtocol||'h2'==a[0].nextHopProtocol)):a=!!(h.vc&&h.vc.ke&&h.vc.ke()&&h.vc.ke().nh),this.Xb=a?this.me:1,this.v=null,1<this.Xb&&(this.v=new Jc),this.f=null,this.ba=[]}function Oc(){this.xg=this.rg=void 0}function Pc(){this.jg=new Oc}function Qc(a,b){var c=new Xb;c.debug('TestLoadImage: loading '+a);var d=new Image;d.onload=v(Rc,c,d,'TestLoadImage: loaded',!0,b),d.onerror=v(Rc,c,d,'TestLoadImage: error',!1,b),d.onabort=v(Rc,c,d,'TestLoadImage: abort',!1,b),d.ontimeout=v(Rc,c,d,'TestLoadImage: timeout',!1,b),h.setTimeout(function(){d.ontimeout&&d.ontimeout()},1E4),d.src=a}function Rc(a,b,c,d,f){try{a.debug(c),b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,f(d)}catch(g){a.cb(g)}}function V(a){H.call(this),this.headers=new S,this.Xa=a||null,this.ha=!1,this.mc=this.c=null,this.ge=this.Tb='',this.Pa=0,this.I='',this.Aa=this.Lc=this.Qb=this.Ec=!1,this.vb=0,this.hc=null,this.Ae=Tc,this.jc=this.lg=this.Ab=!1}function Wc(a){return C&&Ta(9)&&'number'==typeof a.timeout&&void 0!==a.ontimeout}function qa(a){return'content-type'==a.toLowerCase()}function Xc(a,b){return{type:b,lengthComputable:a.lengthComputable,loaded:a.loaded,total:a.total}}function Yc(a){var b='';return Aa(a,function(a,d){b+=d,b+=':',b+=a,b+='\r\n'}),b}function Zc(a,b,c){a:{for(d in c){var d=!1;break a}d=!0}if(d)return a;if(c=Yc(c),l(a)){if(b=encodeURIComponent(b+''),c=null==c?'':'='+encodeURIComponent(c+''),b+=c){if(c=a.indexOf('#'),0>c&&(c=a.length),d=a.indexOf('?'),0>d||d>c){d=c;var f=''}else f=a.substring(d+1,c);a=[a.substr(0,d),f,a.substr(c)],c=a[1],a[1]=b?c?c+'&'+b:b:c,a=a[0]+(a[1]?'?'+a[1]:'')+a[2]}return a}return a.l(b,c),a}function $c(a){this.Bd=22,this.De=0,this.M=[],this.a=new Xb,this.Ib=new Ic,this.na=this.md=this.hb=this.K=this.u=this.Kc=this.aa=this.gb=this.N=this.Rb=this.A=null,this.Te=!0,this.ag=this.Yb=0,this.kf=!!m('internalChannelParams.failFast',a),this.fd=this.Ja=this.wa=this.ia=this.ea=this.i=null,this.Se=!0,this.w=this.he=this.Sb=-1,this.rc=this.Ha=this.La=0,this.Ve=m('internalChannelParams.baseRetryDelayMs',a)||5E3,this.vg=m('internalChannelParams.retryDelaySeedMs',a)||1E4,this.nf=m('internalChannelParams.forwardChannelMaxRetries',a)||2,this.Od=m('internalChannelParams.forwardChannelRequestTimeoutMs',a)||2E4,this.Xa=a&&a.oh||void 0,this.Db=void 0,this.Ra=0,this.gc=a&&a.supportsCrossDomainXhr||!1,this.ra='',this.G=new Mc(a&&a.concurrentRequestLimit),this.kc=new Pc,this.ta=a&&void 0!==a.backgroundChannelTest?a.backgroundChannelTest:!0,(this.Nd=a&&a.fastHandshake||!1)&&!this.ta&&(this.a.T('Force backgroundChannelTest when fastHandshake is enabled.'),this.ta=!0),a&&a.Id&&this.a.Id()}function ad(){}function bd(){for(var b=arguments[0],c=1,d;c<arguments.length;c++)if(d=arguments[c],0==d.lastIndexOf('/',0))b=d;else{var f;(f=''==b)||(f=b.length-1,f=0<=f&&b.indexOf('/',f)==f),b=f?b+d:b+('/'+d)}return b}function cd(){if(C&&!(10<=+Ua))throw Error('Environmental error: no available transport.')}function W(a,b){H.call(this),this.b=new $c(b),this.yb=a,this.Qg=b&&b.testUrl?b.testUrl:bd(this.yb,'test'),this.s=Vb('goog.labs.net.webChannel.WebChannelBaseTransport'),this.Rc=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a['X-Client-Protocol']='webchannel':a={"X-Client-Protocol":'webchannel'}),this.b.ga(a),a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a['X-WebChannel-Content-Type']=b.messageContentType:a={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.zd&&(a?a['X-WebChannel-Client-Profile']=b.zd:a={"X-WebChannel-Client-Profile":b.zd}),this.b.Eg(a),(a=b&&b.httpHeadersOverwriteParam)&&!va(a)&&this.b.Cg(a),this.Og=b&&b.supportsCrossDomainXhr||!1,this.zg=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!va(b)&&(this.b.Dg(b),a=this.Rc,null!==a&&b in a&&(a=this.Rc,b in a&&delete a[b],(a=this.s)&&a.T('Ignore httpSessionIdParam also specified with messageUrlParams: '+b,void 0))),this.vd=new X(this)}function dd(a){fc.call(this);var b=a.__sm__;if(b){a:{for(var c in b){a=c;break a}a=void 0}(this.ne=a)&&(a=this.ne,b=null!==b&&a in b?b[a]:void 0),this.data=b}else this.data=a}function ed(a){gc.call(this),this.status=1,this.errorCode=a}function X(a){this.b=a}function gd(){this.V=[],this.Z=[]}function hd(a,b){if(z.call(this),this.oe=a||0,this.Wb=b||10,this.oe>this.Wb)throw Error(id);this.fa=new gd,this.oa=new Jc,this.Ac=0,this.Nc=null,this.Cb()}function jd(a,b){this.fe=a,this.gd=b}function kd(a){this.Y=[],a&&this.Lf(a)}function ld(){kd.call(this)}function Y(a,b){this.Gd=void 0,this.cc=new ld,hd.call(this,a,b)}function Z(a,b,c,d){this.Jf=a,this.Ab=!!d,Y.call(this,b,c)}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0}),__webpack_require__.d(__webpack_exports__,'createWebChannelTransport',function(){return src_1}),__webpack_require__.d(__webpack_exports__,'ErrorCode',function(){return src_2}),__webpack_require__.d(__webpack_exports__,'EventType',function(){return src_3}),__webpack_require__.d(__webpack_exports__,'WebChannel',function(){return src_4}),__webpack_require__.d(__webpack_exports__,'XhrIoPool',function(){return src_5});var commonjsGlobal='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,goog=goog||{},h=commonjsGlobal,t='closure_uid_'+(1E9*Math.random()>>>0),da=0,w=Date.now||function(){return+new Date},e;x(y,Error),y.prototype.name='CustomError',x(ha,y),ha.prototype.name='AssertionError';var ja=0,ka={};z.prototype.Ka=!1,z.prototype.bb=function(){if(!this.Ka&&(this.Ka=!0,this.F(),0!=ja)){var a=this[t]||(this[t]=++da);if(0!=ja)throw Error(this+' did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass\' method.');delete ka[a]}},z.prototype.F=function(){if(this.Qa)for(;this.Qa.length;)this.Qa.shift()()};var la=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if(l(a))return l(b)&&1==b.length?a.indexOf(b,0):-1;for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ma=Array.prototype.lastIndexOf?function(a,b){return Array.prototype.lastIndexOf.call(a,b,a.length-1)}:function(a,b){var c=a.length-1;if(0>c&&(c=_Mathmax2(0,a.length+c)),l(a))return l(b)&&1==b.length?a.lastIndexOf(b,c):-1;for(;0<=c;c--)if(c in a&&a[c]===b)return c;return-1},na=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=l(a)?a.split(''):a,g=0;g<d;g++)g in f&&b.call(c,f[g],g,a)},oa=Array.prototype.some?function(a,b){return Array.prototype.some.call(a,b,void 0)}:function(a,b){for(var c=a.length,d=l(a)?a.split(''):a,f=0;f<c;f++)if(f in d&&b.call(void 0,d[f],f,a))return!0;return!1},wa=String.prototype.trim?function(a){return a.trim()}:function(a){return /^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]},A;a:{var ya=h.navigator;if(ya){var za=ya.userAgent;if(za){A=za;break a}}A=''}var Ea='constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf'.split(' ');Ga[' ']=aa;var Ja=B('Opera'),C=B('Trident')||B('MSIE'),Ka=B('Edge'),La=Ka||C,Ma=B('Gecko')&&(-1==A.toLowerCase().indexOf('webkit')||B('Edge'))&&!(B('Trident')||B('MSIE'))&&!B('Edge'),Na=-1!=A.toLowerCase().indexOf('webkit')&&!B('Edge'),Pa;a:{var Qa='',Ra=function(){var a=A;return Ma?/rv:([^\);]+)(\)|;)/.exec(a):Ka?/Edge\/([\d\.]+)/.exec(a):C?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):Na?/WebKit\/(\S+)/.exec(a):Ja?/(?:Version)[ \/]?(\S+)/.exec(a):void 0}();if(Ra&&(Qa=Ra?Ra[1]:''),C){var Sa=Oa();if(null!=Sa&&Sa>parseFloat(Qa)){Pa=Sa+'';break a}}Pa=Qa}var Ia={},Va=h.document,Ua;Ua=Va&&C?Oa()||('CSS1Compat'==Va.compatMode?parseInt(Pa,10):5):void 0;var Wa=Object.freeze||function(a){return a},Xa=!C||9<=+Ua,Ya=C&&!Ta('9'),Za=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},'passive',{get:function(){a=!0}});try{h.addEventListener('test',aa,b),h.removeEventListener('test',aa,b)}catch(c){}return a}();D.prototype.stopPropagation=function(){this.Ea=!0},D.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Be=!1},x(E,D);var $a=Wa({2:'touch',3:'pen',4:'mouse'});E.prototype.Kf=function(a,b){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.currentTarget=b,!(b=a.relatedTarget))'mouseover'==c?b=a.fromElement:'mouseout'==c&&(b=a.toElement);else if(Ma){a:{try{Ga(b.nodeName);var f=!0;break a}catch(g){}f=!1}f||(b=null)}this.relatedTarget=b,null===d?(this.offsetX=Na||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=Na||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0===a.clientX?a.pageX:a.clientX,this.clientY=void 0===a.clientY?a.pageY:a.clientY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0===d.clientX?d.pageX:d.clientX,this.clientY=void 0===d.clientY?d.pageY:d.clientY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=a.button,this.keyCode=a.keyCode||0,this.key=a.key||'',this.charCode=a.charCode||('keypress'==c?a.keyCode:0),this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=l(a.pointerType)?a.pointerType:$a[a.pointerType]||'',this.state=a.state,this.fb=a,a.defaultPrevented&&this.preventDefault()},E.prototype.stopPropagation=function(){E.L.stopPropagation.call(this),this.fb.stopPropagation?this.fb.stopPropagation():this.fb.cancelBubble=!0},E.prototype.preventDefault=function(){E.L.preventDefault.call(this);var a=this.fb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Ya)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(b){}};var ab='closure_listenable_'+(0|1E6*Math.random()),bb=0;cb.prototype.Vb=function(){this.Sa=!0,this.Ob=this.src=this.proxy=this.listener=null},e=db.prototype,e.add=function(a,b,c,d,f){var g=a.toString();a=this.J[g],a||(a=this.J[g]=[],this.xb++);var k=eb(a,b,d,f);return-1<k?(b=a[k],c||(b.Eb=!1)):(b=new cb(b,this.src,g,!!d,f),b.Eb=c,a.push(b)),b},e.remove=function(a,b,c,d){if(a=a.toString(),!(a in this.J))return!1;var f=this.J[a];return b=eb(f,b,c,d),!!(-1<b)&&(f[b].Vb(),Array.prototype.splice.call(f,b,1),0==f.length&&(delete this.J[a],this.xb--),!0)},e.ye=function(a){var b=a.type;b in this.J&&sa(this.J[b],a)&&(a.Vb(),0==this.J[b].length&&(delete this.J[b],this.xb--))},e.pb=function(a){a=a&&a.toString();for(var c in this.J)if(!a||c==a){for(var d=this.J[c],f=0;f<d.length;f++)d[f].Vb();delete this.J[c],this.xb--}},e.jb=function(a,b,c,d){a=this.J[a.toString()];var f=-1;return a&&(f=eb(a,b,c,d)),-1<f?a[f]:null};var fb='closure_lm_'+(0|1E6*Math.random()),gb={},tb='__closure_events_fn_'+(1E9*Math.random()>>>0);x(H,z),H.prototype[ab]=!0,e=H.prototype,e.addEventListener=function(a,b,c,d){ib(this,a,b,c,d)},e.removeEventListener=function(a,b,c,d){pb(this,a,b,c,d)},e.dispatchEvent=function(a){var c=this.Uc,b;if(c)for(b=[];c;c=c.Uc)b.push(c);c=this.Pe;var d=a.type||a;if(l(a))a=new D(a,c);else if(a instanceof D)a.target=a.target||c;else{var f=a;a=new D(d,c),Fa(a,f)}if(f=!0,b)for(var g=b.length-1,k;!a.Ea&&0<=g;g--)k=a.currentTarget=b[g],f=k.Lb(d,!0,a)&&f;if(a.Ea||(k=a.currentTarget=c,f=k.Lb(d,!0,a)&&f,a.Ea||(f=k.Lb(d,!1,a)&&f)),b)for(g=0;!a.Ea&&g<b.length;g++)k=a.currentTarget=b[g],f=k.Lb(d,!1,a)&&f;return f},e.F=function(){H.L.F.call(this),this.pg(),this.Uc=null},e.nb=function(a,b,c,d){return this.ka.add(a+'',b,!1,c,d)},e.Oc=function(a,b,c,d){return this.ka.add(a+'',b,!0,c,d)},e.ed=function(a,b,c,d){this.ka.remove(a+'',b,c,d)},e.Le=function(a){this.ka.ye(a)},e.pg=function(){this.ka&&this.ka.pb(void 0)},e.Lb=function(a,b,c){if(a=this.ka.J[a+''],!a)return!0;a=a.concat();for(var d=!0,f=0,g;f<a.length;++f)if(g=a[f],g&&!g.Sa&&g.capture==b){var k=g.listener,p=g.Ob||g.src;g.Eb&&this.Le(g),d=!1!==k.call(p,c)&&d}return d&&0!=c.Be},e.jb=function(a,b,c,d){return this.ka.jb(a+'',b,c,d)};var ub=h.JSON.stringify;vb.prototype.get=function(){if(0<this.Zb){this.Zb--;var a=this.Pb;this.Pb=a.next,a.next=null}else a=this.ef();return a},vb.prototype.put=function(a){this.ug(a),this.Zb<this.Sf&&(this.Zb++,a.next=this.Pb,this.Pb=a)};var xb=new vb(function(){return new wb},function(a){a.reset()});I.prototype.add=function(a,b){var c=this.Af();c.set(a,b),this.lc?this.lc.next=c:this.Va=c,this.lc=c},I.prototype.remove=function(){var a=null;return this.Va&&(a=this.Va,this.Va=this.Va.next,this.Va||(this.lc=null),a.next=null),a},I.prototype.wg=function(a){xb.put(a)},I.prototype.Af=function(){return xb.get()},wb.prototype.set=function(a,b){this.Gc=a,this.scope=b,this.next=null},wb.prototype.reset=function(){this.next=this.scope=this.Gc=null};var Eb=!1,Fb=new I,zb,Bb;x(Gb,H),e=Gb.prototype,e.enabled=!1,e.B=null,e.setInterval=function(a){this.Na=a,this.B&&this.enabled?(this.stop(),this.start()):this.B&&this.stop()},e.Rg=function(){if(this.enabled){var a=w()-this.ie;0<a&&a<.8*this.Na?this.B=this.wb.setTimeout(this.nd,this.Na-a):(this.B&&(this.wb.clearTimeout(this.B),this.B=null),this.ff(),this.enabled&&(this.stop(),this.start()))}},e.ff=function(){this.dispatchEvent('tick')},e.start=function(){this.enabled=!0,this.B||(this.B=this.wb.setTimeout(this.nd,this.Na),this.ie=w())},e.stop=function(){this.enabled=!1,this.B&&(this.wb.clearTimeout(this.B),this.B=null)},e.F=function(){Gb.L.F.call(this),this.stop(),delete this.wb},x(Ib,z),e=Ib.prototype,e.Ta=!1,e.ob=0,e.B=null,e.mf=function(){this.qc=arguments,this.B||this.ob?this.Ta=!0:this.Cc()},e.stop=function(){this.B&&(h.clearTimeout(this.B),this.B=null,this.Ta=!1,this.qc=[])},e.pause=function(){this.ob++},e.resume=function(){this.ob--,this.ob||!this.Ta||this.B||(this.Ta=!1,this.Cc())},e.F=function(){Ib.L.F.call(this),this.stop()},e.fg=function(){this.B=null,this.Ta&&!this.ob&&(this.Ta=!1,this.Cc())},e.Cc=function(){this.B=Hb(this.Xe,this.Na),this.Uf.apply(null,this.qc)},x(Jb,z);var Kb=[];e=Jb.prototype,e.nb=function(a,b,c,d){return this.Tf(a,b,c,d)},e.Tf=function(a,b,c,d){n(b)||(b&&(Kb[0]=b.toString()),b=Kb);for(var f=0,g;f<b.length&&(g=ib(a,b[f],c||this.handleEvent,d||!1,this.i||this),!!g);f++)this.o[g.key]=g;return this},e.Oc=function(a,b,c,d){return this.je(a,b,c,d)},e.je=function(a,b,c,d,f){if(n(b))for(var g=0;g<b.length;g++)this.je(a,b[g],c,d,f);else{if(a=jb(a,b,c||this.handleEvent,d,f||this.i||this),!a)return this;this.o[a.key]=a}return this},e.ed=function(a,b,c,d,f){if(n(b))for(var g=0;g<b.length;g++)this.ed(a,b[g],c,d,f);else c=c||this.handleEvent,d=r(d)?!!d.capture:!!d,f=f||this.i||this,c=kb(c),d=!!d,b=F(a)?a.jb(b,c,d,f):a?(a=G(a))?a.jb(b,c,d,f):null:null,b&&(qb(b),delete this.o[b.key])},e.pb=function(){Aa(this.o,function(a,b){this.o.hasOwnProperty(b)&&qb(a)},this),this.o={}},e.F=function(){Jb.L.F.call(this),this.pb()},e.handleEvent=function(){throw Error('EventHandler.handleEvent not implemented')},J.prototype.Md=null,J.prototype.reset=function(a){this.mb=a,delete this.Md},J.prototype.Bg=function(a){this.Md=a},J.prototype.Ge=function(a){this.mb=a},K.prototype.toString=function(){return this.name};var Nb=new K('SEVERE',1E3),Ob=new K('WARNING',900),Pb=new K('INFO',800),Qb=new K('CONFIG',700),Rb=new K('FINE',500);e=Mb.prototype,e.getName=function(){return this.pe},e.getParent=function(){return this.$b},e.pf=function(){return this.uc||(this.uc={}),this.uc},e.Ge=function(a){this.mb=a},e.Qd=function(){return this.mb?this.mb:this.$b?this.$b.Qd():(ia('Root logger has no level set.'),null)},e.Pf=function(a){return a.value>=this.Qd().value},e.log=function(a,b,c){this.Pf(a)&&(q(b)&&(b=b()),this.gf(this.uf(a,b,c)))},e.uf=function(a,b,c){return a=new J(a,b+'',this.pe),c&&a.Bg(c),a},e.ca=function(a,b){this.log(Nb,a,b)},e.T=function(a,b){this.log(Ob,a,b)},e.info=function(a,b){this.log(Pb,a,b)},e.lf=function(a){this.log(Rb,a,void 0)},e.gf=function(a){for(var b=this;b;)b.We(a),b=b.getParent()},e.We=function(a){if(this.Zd)for(var b=0,c;c=this.Zd[b];b++)c(a)},e.Fg=function(a){this.$b=a},e.Qe=function(a,b){this.pf()[a]=b};var Sb={},Tb=null;e=Xb.prototype,e.Id=function(){this.Wc=!1},e.Tg=function(a,b,c,d,f){var g=this;this.info(function(){return'XMLHTTP REQ ('+c+') [attempt '+d+']: '+a+'\n'+b+'\n'+g.Xf(f)})},e.Ug=function(a,b,c,d,f,g){this.info(function(){return'XMLHTTP RESP ('+c+') [ attempt '+d+']: '+a+'\n'+b+'\n'+f+' '+g})},e.Wa=function(a,b,c){var d=this;this.info(function(){return'XMLHTTP TEXT ('+a+'): '+d.ng(b)+(c?' '+c:'')})},e.Sg=function(a){this.info(function(){return'TIMEOUT: '+a})},e.debug=function(a){L(this.s,a)},e.cb=function(a,b){var c=this.s;c&&c.ca(b||'Exception',a)},e.info=function(a){Wb(this.s,a)},e.T=function(a){var b=this.s;b&&b.T(a,void 0)},e.ca=function(a){var b=this.s;b&&b.ca(a,void 0)},e.ng=function(a){if(!this.Wc)return a;if(!a)return null;try{var b=JSON.parse(a);if(b)for(var c=0;c<b.length;c++)n(b[c])&&this.Wf(b[c]);return ub(b)}catch(d){return this.debug('Exception parsing expected JS array - probably was not JS'),a}},e.Wf=function(a){if(!(2>a.length||(a=a[1],!n(a)||1>a.length))){var b=a[0];if('noop'!=b&&'stop'!=b&&'close'!=b)for(b=1;b<a.length;b++)a[b]=''}},e.Xf=function(a){if(!this.Wc)return a;if(!a)return null;var b='';a=a.split('&');for(var c=0,d;c<a.length;c++)if(d=a[c].split('='),1<d.length){var f=d[0];d=d[1];var g=f.split('_');b=2<=g.length&&'type'==g[1]?b+(f+'='+d+'&'):b+(f+'=redacted&')}return b};var M=new H;x(Yb,D),x(Zb,D),x($b,D);var bc={NO_ERROR:0,Vg:1,bh:2,ah:3,Yg:4,$g:5,dh:6,Ne:7,TIMEOUT:8,gh:9},cc={Xg:'complete',kh:'success',Oe:'error',Ne:'abort',ih:'ready',jh:'readystatechange',TIMEOUT:'timeout',eh:'incrementaldata',hh:'progress',Zg:'downloadprogress',lh:'uploadprogress'};dc.prototype.pd=null,dc.prototype.Vd=function(){return this.pd||(this.pd=this.Mf())};var Q={OPEN:'a',Wg:'b',Oe:'c',fh:'d'};x(fc,D),x(gc,D);var hc;x(ic,dc),ic.prototype.Dd=function(){var a=this.Wd();return a?new ActiveXObject(a):new XMLHttpRequest},ic.prototype.Mf=function(){var a={};return this.Wd()&&(a[0]=!0,a[1]=!0),a},ic.prototype.Wd=function(){if(!this.be&&'undefined'==typeof XMLHttpRequest&&'undefined'!=typeof ActiveXObject){for(var a=['MSXML2.XMLHTTP.6.0','MSXML2.XMLHTTP.3.0','MSXML2.XMLHTTP','Microsoft.XMLHTTP'],b=0,c;b<a.length;b++){c=a[b];try{return new ActiveXObject(c),this.be=c}catch(d){}}throw Error('Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed')}return this.be},hc=new ic;var jc=45E3,lc={},mc={};e=R.prototype,e.ga=function(a){this.A=a},e.setTimeout=function(a){this.Ua=a},e.He=function(a){this.Ra=a},e.Gg=function(a){this.ba=a},e.la=function(){return this.ba},e.kd=function(a,b){this.ic=1,this.ua=a.clone().Ub(),this.Da=b,this.yc=!0,this.Ce(null)},e.jd=function(a,b,c){this.ic=1,this.ua=a.clone().Ub(),this.Da=null,this.yc=b,this.Ce(c)},e.Ce=function(a){this.qb=w(),this.eb(),this.pa=this.ua.clone(),this.pa.dc('t',this.Xc),this.Bb=0,this.h=this.b.Jb(this.b.fc()?a:null),0<this.Ra&&(this.ac=new Ib(u(this.Me,this,this.h),this.Ra)),this.Fc.nb(this.h,'readystatechange',this.mg),a=this.A?Da(this.A):{},this.Da?(this.Fa||(this.Fa='POST'),a['Content-Type']='application/x-www-form-urlencoded',this.h.send(this.pa,this.Fa,this.Da,a)):(this.Fa='GET',this.h.send(this.pa,this.Fa,null,a)),N(1),this.a.Tg(this.Fa,this.pa,this.R,this.Xc,this.Da)},e.mg=function(a){a=a.target;var b=this.ac;b&&3==a.ma()?(this.a.debug('Throttling readystatechange.'),b.mf()):this.Me(a)},e.Me=function(a){try{a==this.h?this.hg():this.a.T('Called back with an unexpected xmlhttp')}catch(c){if(this.a.debug('Failed call to OnXmlHttpReadyStateChanged_'),this.h&&this.h.ya()){var b=this;this.a.cb(c,function(){return'ResponseText: '+b.h.ya()})}else this.a.cb(c,'No response text')}finally{}},e.hg=function(){var a=this.h.ma(),b=this.h.Ud(),c=this.h.za();if(!(3>a)&&(3!=a||La||this.h.ya())){this.Za||4!=a||7==b||(8==b||0>=c?N(3):N(2)),this.Fb();var d=this.h.za();if(this.w=d,b=this.h.ya(),!b){var f=this;this.a.debug(function(){return'No response text for uri '+f.pa+' status '+d})}if(this.S=200==d,this.a.Ug(this.Fa,this.pa,this.R,this.Xc,a,d),this.S){if(this.Ig())if(c=this.sf())this.a.Wa(this.R,c,'Initial handshake response via X-HTTP-Initial-Response'),this.lb=!0,this.Yc(c);else return this.S=!1,this.I=3,O(12),this.a.T('XMLHTTP Missing X_HTTP_INITIAL_RESPONSE ('+this.R+')'),this.Ia(),void this.Kb();this.yc?(this.Fd(a,b),La&&this.S&&3==a&&this.Ng()):(this.a.Wa(this.R,b,null),this.Yc(b)),4==a&&this.Ia(),this.S&&!this.Za&&(4==a?this.b.Tc(this):(this.S=!1,this.eb()))}else 400==d&&0<b.indexOf('Unknown SID')?(this.I=3,O(12),this.a.T('XMLHTTP Unknown SID ('+this.R+')')):(this.I=0,O(13),this.a.T('XMLHTTP Bad status '+d+' ('+this.R+')')),this.Ia(),this.Kb()}},e.Ig=function(){return this.Ed&&!this.lb},e.sf=function(){if(this.h){var a=this.h.kb('X-HTTP-Initial-Response');if(a&&!va(a))return a}return null},e.Ag=function(){this.Ed=!0},e.Fd=function(a,b){for(var c=!0,d;!this.Za&&this.Bb<b.length;)if(d=this.vf(b),d==mc){4==a&&(this.I=4,O(14),c=!1),this.a.Wa(this.R,null,'[Incomplete Response]');break}else if(d==lc){this.I=4,O(15),this.a.Wa(this.R,b,'[Invalid Chunk]'),c=!1;break}else this.a.Wa(this.R,d,null),this.Yc(d);4==a&&0==b.length&&(this.I=1,O(16),c=!1),this.S=this.S&&c,c||(this.a.Wa(this.R,b,'[Invalid Chunked Response]'),this.Ia(),this.Kb())},e.kg=function(){if(this.h){var a=this.h.ma(),b=this.h.ya();this.Bb<b.length&&(this.Fb(),this.Fd(a,b),this.S&&4!=a&&this.eb())}},e.Ng=function(){this.Fc.nb(this.Vc,'tick',this.kg),this.Vc.start()},e.vf=function(a){var b=this.Bb,c=a.indexOf('\n',b);return-1==c?mc:(b=+a.substring(b,c),isNaN(b))?lc:(c+=1,c+b>a.length)?mc:(a=a.substr(c,b),this.Bb=c+b,a)},e.yg=function(a){this.ic=2,this.ua=a.clone().Ub(),a=!1,h.navigator&&h.navigator.sendBeacon&&(a=h.navigator.sendBeacon(this.ua.toString(),'')),!a&&h.Image&&(new Image().src=this.ua,a=!0),a||(this.h=this.b.Jb(null),this.h.send(this.ua)),this.qb=w(),this.eb()},e.cancel=function(){this.Za=!0,this.Ia()},e.tg=function(a){a&&this.setTimeout(a),this.Ga&&(this.Fb(),this.eb())},e.eb=function(){this.hd=w()+this.Ua,this.Ke(this.Ua)},e.Ke=function(a){if(null!=this.Ga)throw Error('WatchDog timer not null');this.Ga=P(u(this.gg,this),a)},e.Fb=function(){this.Ga&&(h.clearTimeout(this.Ga),this.Ga=null)},e.gg=function(){this.Ga=null;var a=w();0<=a-this.hd?this.Df():(this.a.T('WatchDog timer called too early'),this.Ke(this.hd-a))},e.Df=function(){this.S&&this.a.ca('Received watchdog timeout even though request loaded successfully'),this.a.Sg(this.pa),2!=this.ic&&(N(3),O(17)),this.Ia(),this.I=2,this.Kb()},e.Kb=function(){this.b.de()||this.Za||this.b.Tc(this)},e.Ia=function(){this.Fb();var a=this.ac;a&&'function'==typeof a.bb&&a.bb(),this.ac=null,this.Vc.stop(),this.Fc.pb(),this.h&&(a=this.h,this.h=null,a.abort(),a.bb())},e.Hc=function(){return this.I},e.Yc=function(a){try{this.b.ue(this,a),N(4)}catch(b){this.a.cb(b,'Error in httprequest callback')}},e=S.prototype,e.C=function(){return this.j},e.H=function(){this.wc();for(var a=[],b=0;b<this.o.length;b++)a.push(this.D[this.o[b]]);return a},e.W=function(){return this.wc(),this.o.concat()},e.va=function(a){return T(this.D,a)},e.X=function(){return 0==this.j},e.clear=function(){this.D={},this.j=this.o.length=0},e.remove=function(a){return!!T(this.D,a)&&(delete this.D[a],this.j--,this.o.length>2*this.j&&this.wc(),!0)},e.wc=function(){if(this.j!=this.o.length){for(var a=0,b=0,c;a<this.o.length;)c=this.o[a],T(this.D,c)&&(this.o[b++]=c),a++;this.o.length=b}if(this.j!=this.o.length){var d={};for(b=a=0;a<this.o.length;)c=this.o[a],T(d,c)||(this.o[b++]=c,d[c]=1),a++;this.o.length=b}},e.get=function(a,b){return T(this.D,a)?this.D[a]:b},e.set=function(a,b){T(this.D,a)||(this.j++,this.o.push(a)),this.D[a]=b},e.addAll=function(a){if(a instanceof S)for(var b=a.W(),c=0;c<b.length;c++)this.set(b[c],a.get(b[c]));else for(b in a)this.set(b,a[b])},e.forEach=function(a,b){for(var c=this.W(),d=0;d<c.length;d++){var f=c[d],g=this.get(f);a.call(b,g,f,this)}},e.clone=function(){return new S(this)};var pc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;e=U.prototype,e.toString=function(){var a=[],b=this.qa;b&&a.push(sc(b,tc,!0),':');var c=this.xa;return(c||'file'==b)&&(a.push('//'),(b=this.zb)&&a.push(sc(b,tc,!0),'@'),a.push(encodeURIComponent(c+'').replace(/%25([0-9a-fA-F]{2})/g,'%$1')),c=this.Ca,null!=c&&a.push(':',c+'')),(c=this.K)&&(this.Ic()&&'/'!=c.charAt(0)&&a.push('/'),a.push(sc(c,'/'==c.charAt(0)?uc:wc,!0))),(c=this.Rd())&&a.push('?',c),(c=this.ib)&&a.push('#',sc(c,xc)),a.join('')},e.resolve=function(a){var b=this.clone(),c=a.Hf();c?b.tb(a.qa):c=a.If(),c?b.cd(a.zb):c=a.Ic(),c?b.rb(a.xa):c=a.Ff();var d=a.K;if(c)b.sb(a.Ca);else if(c=a.ae()){if('/'!=d.charAt(0))if(this.Ic()&&!this.ae())d='/'+d;else{var f=b.K.lastIndexOf('/');-1!=f&&(d=b.K.substr(0,f+1)+d)}if(f=d,'..'==f||'.'==f)d='';else if(-1!=f.indexOf('./')||-1!=f.indexOf('/.')){d=0==f.lastIndexOf('/',0),f=f.split('/');for(var g=[],k=0,p;k<f.length;)p=f[k++],'.'==p?d&&k==f.length&&g.push(''):'..'==p?((1<g.length||1==g.length&&''!=g[0])&&g.pop(),d&&k==f.length&&g.push('')):(g.push(p),d=!0);d=g.join('/')}else d=f}return c?b.ec(d):c=a.Gf(),c?b.bd(a.P.clone()):c=a.Ef(),c&&b.$c(a.ib),b},e.clone=function(){return new U(this)},e.tb=function(a,b){this.U(),(this.qa=b?yc(a,!0):a)&&(this.qa=this.qa.replace(/:$/,''))},e.Hf=function(){return!!this.qa},e.cd=function(a,b){this.U(),this.zb=b?yc(a):a},e.If=function(){return!!this.zb},e.rb=function(a,b){this.U(),this.xa=b?yc(a,!0):a},e.Ic=function(){return!!this.xa},e.sb=function(a){if(this.U(),a){if(a=+a,isNaN(a)||0>a)throw Error('Bad port number '+a);this.Ca=a}else this.Ca=null},e.Ff=function(){return null!=this.Ca},e.ec=function(a,b){this.U(),this.K=b?yc(a,!0):a},e.ae=function(){return!!this.K},e.Gf=function(){return''!==this.P.toString()},e.bd=function(a,b){this.U(),a instanceof rc?(this.P=a,this.P.ad(this.O)):(b||(a=sc(a,zc)),this.P=new rc(a,this.O))},e.Rd=function(){return this.P.toString()},e.getQuery=function(){return this.Rd()},e.l=function(a,b){this.U(),this.P.set(a,b)},e.dc=function(a,b){this.U(),n(b)||(b=[b+'']),this.P.Ie(a,b)},e.$c=function(a,b){this.U(),this.ib=b?yc(a):a},e.Ef=function(){return!!this.ib},e.Ub=function(){return this.U(),this.l('zx',_Mathfloor2(2147483648*Math.random()).toString(36)+Math.abs(_Mathfloor2(2147483648*Math.random())^w()).toString(36)),this},e.removeParameter=function(a){return this.U(),this.P.remove(a),this},e.U=function(){if(this.Qf)throw Error('Tried to modify a read-only Uri')},e.ad=function(a){this.O=a,this.P&&this.P.ad(a)};var tc=/[#\/\?@]/g,wc=/[#\?:]/g,uc=/[#\?]/g,zc=/[#\?@]/g,xc=/#/g;e=rc.prototype,e.$=function(){if(!this.m&&(this.m=new S,this.j=0,this.ja)){var a=this;qc(this.ja,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g,' ')),c)})}},e.C=function(){return this.$(),this.j},e.add=function(a,b){this.$(),this.Oa(),a=this.Ma(a);var c=this.m.get(a);return c||this.m.set(a,c=[]),c.push(b),this.j+=1,this},e.remove=function(a){return this.$(),a=this.Ma(a),!!this.m.va(a)&&(this.Oa(),this.j-=this.m.get(a).length,this.m.remove(a))},e.clear=function(){this.Oa(),this.m=null,this.j=0},e.X=function(){return this.$(),0==this.j},e.va=function(a){return this.$(),a=this.Ma(a),this.m.va(a)},e.forEach=function(a,b){this.$(),this.m.forEach(function(c,d){na(c,function(c){a.call(b,c,d,this)},this)},this)},e.W=function(){this.$();for(var a=this.m.H(),b=this.m.W(),c=[],d=0;d<b.length;d++)for(var f=a[d],g=0;g<f.length;g++)c.push(b[d]);return c},e.H=function(a){this.$();var b=[];if(l(a))this.va(a)&&(b=ta(b,this.m.get(this.Ma(a))));else{a=this.m.H();for(var c=0;c<a.length;c++)b=ta(b,a[c])}return b},e.set=function(a,b){return this.$(),this.Oa(),a=this.Ma(a),this.va(a)&&(this.j-=this.m.get(a).length),this.m.set(a,[b]),this.j+=1,this},e.get=function(a,b){return a?(a=this.H(a),0<a.length?a[0]+'':b):b},e.Ie=function(a,b){this.remove(a),0<b.length&&(this.Oa(),this.m.set(this.Ma(a),ua(b)),this.j+=b.length)},e.toString=function(){if(this.ja)return this.ja;if(!this.m)return'';for(var a=[],b=this.m.W(),c=0;c<b.length;c++){var d=b[c],f=encodeURIComponent(d+'');d=this.H(d);for(var g=0,k;g<d.length;g++)k=f,''!==d[g]&&(k+='='+encodeURIComponent(d[g]+'')),a.push(k)}return this.ja=a.join('&')},e.Oa=function(){this.ja=null},e.clone=function(){var a=new rc;return a.ja=this.ja,this.m&&(a.m=this.m.clone(),a.j=this.j),a},e.Ma=function(a){return a+='',this.O&&(a=a.toLowerCase()),a},e.ad=function(a){a&&!this.O&&(this.$(),this.Oa(),this.m.forEach(function(a,c){var b=c.toLowerCase();c!=b&&(this.remove(c),this.Ie(b,a))},this)),this.O=a},e.extend=function(){for(var b=0;b<arguments.length;b++)oc(arguments[b],function(a,b){this.add(b,a)},this)},x(function Gc(){},function Fc(){}),e=Hc.prototype,e.g=null,e.ga=function(a){this.A=a},e.connect=function(a){this.K=a,a=this.b.Sd(this.K),O(3);var b=this.b.Ib.$d;null==b?(a.dc('MODE','init'),!this.b.ta&&this.b.aa&&a.dc('X-HTTP-Session-Id',this.b.aa),this.f=new R(this,this.a,void 0,void 0,void 0),this.f.ga(this.A),this.f.jd(a,!1,null),this.g=0):(this.na=this.b.$a(b[0]),this.g=1,this.xd())},e.xd=function(){this.a.debug('TestConnection: starting stage 2');var a=this.b.Ib.od;if(null!=a)this.a.debug(function(){return'Buffered'}),O(4),a?(O(10),this.b.ub(this,!1)):(O(11),this.b.ub(this,!0));else{this.f=new R(this,this.a,void 0,void 0,void 0),this.f.ga(this.A);var b=this.b.Pd(this.na,this.K);O(4),b.dc('TYPE','xmlhttp');var c=this.b.aa,d=this.b.Kc;c&&d&&b.l(c,d),this.f.jd(b,!1,this.na)}},e.Jb=function(a){return this.b.Jb(a)},e.abort=function(){this.f&&(this.f.cancel(),this.f=null),this.w=-1},e.de=function(){return!1},e.ue=function(a,b){if(this.w=a.w,0!=this.g)1==this.g&&(this.bc?O(6):'11111'==b?(O(5),this.bc=!0,this.Ze()&&(this.w=200,this.f.cancel(),this.a.debug('Test connection succeeded; using streaming connection'),O(11),this.b.ub(this,!0))):(O(7),this.bc=!1));else if(this.a.debug('TestConnection: Got data for stage 1'),this.pc(a),b){try{var c=this.b.kc.zc(b)}catch(d){return this.a.cb(d),void this.b.dd(this)}this.na=this.b.$a(c[0])}else this.a.debug('TestConnection: Null responseText'),this.b.dd(this)},e.Tc=function(){this.w=this.f.w,this.f.S?0==this.g?(this.g=1,this.a.debug('TestConnection: request complete for initial check'),this.xd()):1==this.g&&(this.a.debug('TestConnection: request complete for stage 2'),this.bc?(this.a.debug('Test connection succeeded; using streaming connection'),O(11),this.b.ub(this,!0)):(this.a.debug('Test connection failed; not using streaming'),O(10),this.b.ub(this,!1))):(this.a.debug('TestConnection: request failed, in state '+this.g),0==this.g?O(8):1==this.g&&O(9),this.b.dd(this))},e.pc=function(a){if(!this.b.ta&&(a=a.h)){var b=a.kb('X-Client-Wire-Protocol');this.Ad=b?b:null,this.b.aa&&((a=a.kb('X-HTTP-Session-Id'))?this.b.Fe(a):this.a.T('Missing X_HTTP_SESSION_ID in the handshake response'))}},e.fc=function(){return this.b.fc()},e.Ba=function(){return this.b.Ba()},e.Ze=function(){return!C||10<=+Ua},e=Jc.prototype,e.C=function(){return this.D.C()},e.add=function(a){this.D.set(Kc(a),a)},e.addAll=function(a){a=nc(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])},e.pb=function(a){a=nc(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])},e.remove=function(a){return this.D.remove(Kc(a))},e.clear=function(){this.D.clear()},e.X=function(){return this.D.X()},e.contains=function(a){return this.D.va(Kc(a))},e.H=function(){return this.D.H()},e.clone=function(){return new Jc(this)};var Nc=10;e=Mc.prototype,e.ld=function(a){this.v||-1==a.indexOf('spdy')&&-1==a.indexOf('quic')&&-1==a.indexOf('h2')||(this.Xb=this.me,this.v=new Jc,this.f&&(this.oc(this.f),this.f=null))},e.ee=function(){return!!this.f||!!this.v&&this.v.C()>=this.Xb},e.xf=function(){return this.f?1:this.v?this.v.C():0},e.Jc=function(a){return this.f?this.f==a:!!this.v&&this.v.contains(a)},e.oc=function(a){this.v?this.v.add(a):this.f=a},e.ze=function(a){this.f&&this.f==a?this.f=null:this.v&&this.v.contains(a)&&this.v.remove(a)},e.cancel=function(){this.ba=this.la(),this.f?(this.f.cancel(),this.f=null):this.v&&!this.v.X()&&(na(this.v.H(),function(a){a.cancel()}),this.v.clear())},e.la=function(){if(null!=this.f)return this.ba.concat(this.f.la());if(null!=this.v&&!this.v.X()){var a=this.ba;return na(this.v.H(),function(b){a=a.concat(b.la())}),a}return ua(this.ba)},e.Re=function(a){this.ba=this.ba.concat(a)},e.$e=function(){this.ba.length=0},Oc.prototype.stringify=function(a){return h.JSON.stringify(a,this.rg)},Oc.prototype.parse=function(a){return h.JSON.parse(a,this.xg)},Pc.prototype.hf=function(a,b,c){var d=c||'';try{oc(a,function(a,c){var f=a;r(a)&&(f=ub(a)),b.push(d+c+'='+encodeURIComponent(f))})}catch(f){throw b.push(d+'type='+encodeURIComponent('_badmap')),f}},Pc.prototype.jf=function(a,b,c){for(var d=-1,f;;){f=['count='+b],-1==d?0<b?(d=a[0].Pc,f.push('ofs='+d)):d=0:f.push('ofs='+d);for(var g=!0,k=0;k<b;k++){var p=a[k].Pc,Ub=a[k].map;if(p-=d,0>p)d=_Mathmax2(0,a[k].Pc-100),g=!1;else try{this.hf(Ub,f,'req'+p+'_')}catch(md){c&&c(Ub)}}if(g)return f.join('&')}},Pc.prototype.zc=function(a){return this.jg.parse(a)};var Sc=h.JSON.parse;x(V,H);var Tc='';V.prototype.s=Vb('goog.net.XhrIo');var Uc=/^https?$/i,Vc=['POST','PUT'];e=V.prototype,e.Je=function(a){this.Ab=a},e.send=function(a,b,c,d){if(this.c)throw Error('[goog.net.XhrIo] Object is active with another request='+this.Tb+'; newUri='+a);b=b?b.toUpperCase():'GET',this.Tb=a,this.I='',this.Pa=0,this.ge=b,this.Ec=!1,this.ha=!0,this.c=this.df(),this.mc=this.Xa?this.Xa.Vd():hc.Vd(),this.c.onreadystatechange=u(this.te,this),this.lg&&'onprogress'in this.c&&(this.c.onprogress=u(function(a){this.re(a,!0)},this),this.c.upload&&(this.c.upload.onprogress=u(this.re,this)));try{L(this.s,this.da('Opening Xhr')),this.Lc=!0,this.c.open(b,a+'',!0),this.Lc=!1}catch(g){return L(this.s,this.da('Error opening Xhr: '+g.message)),void this.Ld(g)}a=c||'';var f=this.headers.clone();d&&oc(d,function(a,b){f.set(b,a)}),d=pa(f.W()),c=h.FormData&&a instanceof h.FormData,!(0<=la(Vc,b))||d||c||f.set('Content-Type','application/x-www-form-urlencoded;charset=utf-8'),f.forEach(function(a,b){this.c.setRequestHeader(b,a)},this),this.Ae&&(this.c.responseType=this.Ae),'withCredentials'in this.c&&this.c.withCredentials!==this.Ab&&(this.c.withCredentials=this.Ab);try{this.yd(),0<this.vb&&(this.jc=Wc(this.c),L(this.s,this.da('Will abort after '+this.vb+'ms if incomplete, xhr2 '+this.jc)),this.jc?(this.c.timeout=this.vb,this.c.ontimeout=u(this.Ua,this)):this.hc=Hb(this.Ua,this.vb,this)),L(this.s,this.da('Sending request')),this.Qb=!0,this.c.send(a),this.Qb=!1}catch(g){L(this.s,this.da('Send error: '+g.message)),this.Ld(g)}},e.df=function(){return this.Xa?this.Xa.Dd():hc.Dd()},e.Ua=function(){'undefined'!=typeof goog&&this.c&&(this.I='Timed out after '+this.vb+'ms, aborting',this.Pa=8,L(this.s,this.da(this.I)),this.dispatchEvent('timeout'),this.abort(8))},e.Ld=function(a){this.ha=!1,this.c&&(this.Aa=!0,this.c.abort(),this.Aa=!1),this.I=a,this.Pa=5,this.Jd(),this.Gb()},e.Jd=function(){this.Ec||(this.Ec=!0,this.dispatchEvent('complete'),this.dispatchEvent('error'))},e.abort=function(a){this.c&&this.ha&&(L(this.s,this.da('Aborting')),this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1,this.Pa=a||7,this.dispatchEvent('complete'),this.dispatchEvent('abort'),this.Gb())},e.F=function(){this.c&&(this.ha&&(this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1),this.Gb(!0)),V.L.F.call(this)},e.te=function(){this.Ka||(this.Lc||this.Qb||this.Aa?this.se():this.eg())},e.eg=function(){this.se()},e.se=function(){if(this.ha&&'undefined'!=typeof goog)if(this.mc[1]&&4==this.ma()&&2==this.za())L(this.s,this.da('Local request error detected and ignored'));else if(this.Qb&&4==this.ma())Hb(this.te,0,this);else if(this.dispatchEvent('readystatechange'),this.Mc()){L(this.s,this.da('Request complete')),this.ha=!1;try{this.Rf()?(this.dispatchEvent('complete'),this.dispatchEvent('success')):(this.Pa=6,this.I=this.Yd()+' ['+this.za()+']',this.Jd())}finally{this.Gb()}}},e.re=function(a,b){this.dispatchEvent(Xc(a,'progress')),this.dispatchEvent(Xc(a,b?'downloadprogress':'uploadprogress'))},e.Gb=function(a){if(this.c){this.yd();var b=this.c,c=this.mc[0]?aa:null;this.mc=this.c=null,a||this.dispatchEvent('ready');try{b.onreadystatechange=c}catch(d){(a=this.s)&&a.ca('Problem encountered resetting onreadystatechange: '+d.message,void 0)}}},e.yd=function(){this.c&&this.jc&&(this.c.ontimeout=null),this.hc&&(h.clearTimeout(this.hc),this.hc=null)},e.Ba=function(){return!!this.c},e.Mc=function(){return 4==this.ma()},e.Rf=function(){var a=this.za();a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1;}return b||0===a&&!this.Of()},e.Of=function(){var a=(this.Tb+'').match(pc)[1]||null;return!a&&h.self&&h.self.location&&(a=h.self.location.protocol,a=a.substr(0,a.length-1)),Uc.test(a?a.toLowerCase():'')},e.ma=function(){return this.c?this.c.readyState:0},e.za=function(){try{return 2<this.ma()?this.c.status:-1}catch(a){return-1}},e.Yd=function(){try{return 2<this.ma()?this.c.statusText:''}catch(a){return L(this.s,'Can not get status: '+a.message),''}},e.ya=function(){try{return this.c?this.c.responseText:''}catch(a){return L(this.s,'Can not get responseText: '+a.message),''}},e.yf=function(a){if(this.c){var b=this.c.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),Sc(b)}},e.getResponseHeader=function(a){if(this.c&&this.Mc())return a=this.c.getResponseHeader(a),null===a?void 0:a},e.getAllResponseHeaders=function(){return this.c&&this.Mc()?this.c.getAllResponseHeaders()||'':''},e.kb=function(a){return this.c?this.c.getResponseHeader(a):null},e.Ud=function(){return this.Pa},e.Hc=function(){return l(this.I)?this.I:this.I+''},e.da=function(a){return a+' ['+this.ge+' '+this.Tb+' '+this.za()+']'},e=$c.prototype,e.tc=8,e.g=1,e.connect=function(a,b,c,d,f){this.a.debug('connect()'),O(0),this.K=b,this.gb=c||{},d&&void 0!==f&&(this.gb.OSID=d,this.gb.OAID=f),this.ta&&(this.a.debug('connect() bypassed channel-test.'),this.Ib.$d=[],this.Ib.od=!1),this.bf(a)},e.disconnect=function(){if(this.a.debug('disconnect()'),this.qd(),3==this.g){var a=this.Yb++,b=this.hb.clone();b.l('SID',this.ra),b.l('RID',a),b.l('TYPE','terminate'),this.Ya(b),new R(this,this.a,this.ra,a,void 0).yg(b)}this.qe()},e.bf=function(a){this.a.debug('connectTest_()'),this.Ja=new Hc(this,this.a),null===this.N&&this.Ja.ga(this.A);var b=a;this.N&&this.A&&(b=Zc(a,this.N,this.A)),this.Ja.connect(b)},e.af=function(){this.a.debug('connectChannel_()'),this.hb=this.Sd(this.K),this.Dc()},e.qd=function(){this.Ja&&(this.Ja.abort(),this.Ja=null),this.u&&(this.u.cancel(),this.u=null),this.ia&&(h.clearTimeout(this.ia),this.ia=null),this.Hb(),this.G.cancel(),this.ea&&(h.clearTimeout(this.ea),this.ea=null)},e.ga=function(a){this.A=a},e.Eg=function(a){this.Rb=a},e.Cg=function(a){this.N=a},e.Dg=function(a){this.aa=a},e.Fe=function(a){this.Kc=a},e.He=function(a){this.Ra=a},e.Hg=function(){this.gc=!0},e.Ee=function(a){this.i=a},e.Nf=function(){return!this.fd},e.Zc=function(a){1E3==this.M.length&&this.a.ca(function(){return'Already have 1000 queued maps upon queueing '+ub(a)}),this.M.push(new Lc(this.ag++,a)),3==this.g&&this.Dc()},e.qf=function(){return this.kf?0:this.nf},e.de=function(){return 0==this.g},e.getState=function(){return this.g},e.Dc=function(){this.G.ee()||this.ea||(this.ea=P(u(this.we,this),0),this.La=0)},e.Yf=function(a){return this.G.xf()>=this.G.Xb-(this.ea?1:0)?(this.a.ca('Unexpected retry request is scheduled.'),!1):this.ea?(this.a.debug('Use the retry request that is already scheduled.'),this.M=a.la().concat(this.M),!0):1==this.g||2==this.g||this.La>=this.qf()?!1:(this.a.debug('Going to retry POST'),this.ea=P(u(this.we,this,a),this.Xd(this.La)),this.La++,!0)},e.we=function(a){this.ea=null,this.Mg(a)},e.Mg=function(a){this.a.debug('startForwardChannel_'),1==this.g?a?this.a.ca('Not supposed to retry the open'):(this.ig(),this.g=2):3==this.g&&(a?this.le(a):0==this.M.length?this.a.debug('startForwardChannel_ returned: nothing to send'):this.G.ee()?this.a.ca('startForwardChannel_ returned: connection already in progress'):(this.le(),this.a.debug('startForwardChannel_ finished, sent request')))},e.ig=function(){this.a.debug('open_()'),this.Yb=_Mathfloor2(1E5*Math.random());var a=this.Yb++,b=new R(this,this.a,'',a,void 0),c=this.A;this.Rb&&(c?(c=Da(c),Fa(c,this.Rb)):c=this.Rb),null===this.N&&b.ga(c);var d=this.Hd(b),f=this.hb.clone();f.l('RID',a),0<this.Bd&&f.l('CVER',this.Bd),this.ta&&this.aa&&f.l('X-HTTP-Session-Id',this.aa),this.Ya(f),this.N&&c&&Zc(f,this.N,c),this.G.oc(b),this.Nd?(f.l('$req',d),f.l('SID','null'),b.Ag(),b.kd(f,null)):b.kd(f,d)},e.le=function(a){var b=a?a.R:this.Yb++,c=this.hb.clone();c.l('SID',this.ra),c.l('RID',b),c.l('AID',this.Sb),this.Ya(c),this.N&&this.A&&Zc(c,this.N,this.A),b=new R(this,this.a,this.ra,b,this.La+1),null===this.N&&b.ga(this.A),a&&this.sg(a),a=this.Hd(b),b.setTimeout(_Mathround(.5*this.Od)+_Mathround(.5*this.Od*Math.random())),this.G.oc(b),b.kd(c,a)},e.Ya=function(a){this.i&&oc({},function(b,c){a.l(c,b)})},e.Hd=function(a){var b=Math.min(this.M.length,1E3),c=this.i?u(this.i.Ue,this.i,this):null;return c=this.kc.jf(this.M,b,c),a.Gg(this.M.splice(0,b)),c},e.sg=function(a){this.M=a.la().concat(this.M)},e.Kd=function(){if(!this.u&&!this.ia){this.rc=1;var a=this.ve;Bb||Cb(),Eb||(Bb(),Eb=!0),Fb.add(a,this),this.Ha=0}},e.Qc=function(){return this.u||this.ia?(this.a.ca('Request already in progress'),!1):!(3<=this.Ha)&&(this.a.debug('Going to retry GET'),this.rc++,this.ia=P(u(this.ve,this),this.Xd(this.Ha)),this.Ha++,!0)},e.ve=function(){this.ia=null,this.Kg()},e.Kg=function(){this.a.debug('Creating new HttpRequest'),this.u=new R(this,this.a,this.ra,'rpc',this.rc),null===this.N&&this.u.ga(this.A),this.u.He(this.Ra);var a=this.md.clone();a.l('RID','rpc'),a.l('SID',this.ra),a.l('CI',this.fd?'0':'1'),a.l('AID',this.Sb),this.Ya(a),a.l('TYPE','xmlhttp'),this.N&&this.A&&Zc(a,this.N,this.A),this.Db&&this.u.setTimeout(this.Db),this.u.jd(a,!0,this.na),this.a.debug('New Request created')},e.ub=function(a,b){this.a.debug('Test Connection Finished');var c=a.Ad;c&&this.G.ld(c),this.fd=this.Se&&b,this.w=a.w,this.af()},e.dd=function(a){this.a.debug('Test Connection Failed'),this.w=a.w,this.sa(2)},e.ue=function(a,b){if(0!=this.g&&(this.u==a||this.G.Jc(a)))if(this.w=a.w,!a.lb&&this.G.Jc(a)&&3==this.g){try{var c=this.kc.zc(b)}catch(d){c=null}n(c)&&3==c.length?this.Cf(c,a):(this.a.debug('Bad POST response data returned'),this.sa(11))}else(a.lb||this.u==a)&&this.Hb(),va(b)||(c=this.kc.zc(b),this.dg(c,a))},e.Cf=function(a,b){0==a[0]?this.Bf(b):(this.he=a[1],b=this.he-this.Sb,0<b&&(a=a[2],this.a.debug(a+' bytes (in '+b+' arrays) are outstanding on the BackChannel'),this.Jg(a)&&!this.wa&&(this.wa=P(u(this.bg,this),6E3))))},e.Bf=function(a){if(this.a.debug('Server claims our backchannel is missing.'),this.ia)this.a.debug('But we are currently starting the request.');else{if(!this.u)this.a.T('We do not have a BackChannel established');else if(this.u.qb+3E3<a.qb)this.Hb(),this.u.cancel(),this.u=null;else return;this.Qc(),O(18)}},e.Jg=function(a){return 37500>a&&!this.Nf()&&0==this.Ha},e.$a=function(a){return this.Te?this.i?this.i.$a(a):a:null},e.bg=function(){null!=this.wa&&(this.wa=null,this.u.cancel(),this.u=null,this.Qc(),O(19))},e.Hb=function(){null!=this.wa&&(h.clearTimeout(this.wa),this.wa=null)},e.Tc=function(a){this.a.debug('Request complete');var b=null;if(this.u==a){this.Hb(),this.u=null;var c=2}else if(this.G.Jc(a))b=a.la(),this.G.ze(a),c=1;else return;if(this.w=a.w,0!=this.g)if(a.S)1==c?(ac(a.Da?a.Da.length:0,w()-a.qb,this.La),this.Dc()):this.Kd();else{var d=a.Hc();if(3==d||0==d&&0<this.w)this.a.debug('Not retrying due to error type');else{var f=this;if(this.a.debug(function(){return'Maybe retrying, last error: '+kc(d,f.w)}),1==c&&this.Yf(a)||2==c&&this.Qc())return;this.a.debug('Exceeded max number of retries')}b&&0<b.length&&this.G.Re(b),this.a.debug('Error: HTTP request failed'),1===d?this.sa(5):4===d?this.sa(10):3===d?this.sa(6):this.sa(2)}},e.Xd=function(a){var b=this.Ve+_Mathfloor2(Math.random()*this.vg);return this.Ba()||(this.a.debug('Inactive channel'),b*=2),b*a},e.pc=function(a){if(this.ta&&(a=a.h)){var b=a.kb('X-Client-Wire-Protocol');b&&this.G.ld(b),this.aa&&((a=a.kb('X-HTTP-Session-Id'))?(this.Fe(a),this.hb.l(this.aa,a)):this.a.T('Missing X_HTTP_SESSION_ID in the handshake response'))}},e.dg=function(a,b){for(var c=this.i&&this.i.sc?[]:null,d=0,f;d<a.length;d++)if(f=a[d],this.Sb=f[0],f=f[1],2!=this.g)3==this.g&&('stop'==f[0]||'close'==f[0]?(c&&0!=c.length&&(this.i.sc(this,c),c.length=0),'stop'==f[0]?this.sa(7):this.disconnect()):'noop'!=f[0]&&(c?c.push(f):this.i&&this.i.ud(f)),this.Ha=0);else if('c'==f[0]){this.ra=f[1],this.na=this.$a(f[2]);var g=f[3];null!=g&&(this.tc=g,this.a.info('VER='+this.tc)),g=f[4],null!=g&&(this.De=g,this.a.info('SVER='+this.De)),f=f[5],null!=f&&'number'==typeof f&&0<f&&(this.Db=f*=1.5,this.a.info('backChannelRequestTimeoutMs_='+f)),this.pc(b),this.g=3,this.i&&this.i.wd(),this.Lg(b)}else'stop'!=f[0]&&'close'!=f[0]||this.sa(7);c&&0!=c.length&&this.i.sc(this,c)},e.Lg=function(a){this.md=this.Pd(this.na,this.K),a.lb?(this.a.debug('Upgrade the handshake request to a backchannel.'),this.G.ze(a),a.tg(this.Db),this.u=a):this.Kd()},e.sa=function(a){if(this.a.info('Error code '+a),2==a){var b=null;this.i&&(b=null);var c=u(this.Pg,this);b||(b=new U('//www.google.com/images/cleardot.gif'),h.location&&'http'==h.location.protocol||b.tb('https'),b.Ub()),Qc(b.toString(),c)}else O(2);this.cg(a)},e.Pg=function(a){a?(this.a.info('Successfully pinged google.com'),O(2)):(this.a.info('Failed to ping google.com'),O(1))},e.cg=function(a){this.a.debug('HttpChannel: error - '+a),this.g=0,this.i&&this.i.td(a),this.qe(),this.qd()},e.qe=function(){if(this.g=0,this.w=-1,this.i){var a=this.G.la();if(0!=a.length||0!=this.M.length){var b=this;this.a.debug(function(){return'Number of undelivered maps, pending: '+a.length+', outgoing: '+b.M.length}),this.G.$e(),ua(this.M),this.M.length=0}this.i.sd()}},e.Sd=function(a){return a=this.Cd(null,a),this.a.debug('GetForwardChannelUri: '+a),a},e.Pd=function(a,b){return a=this.Cd(this.fc()?a:null,b),this.a.debug('GetBackChannelUri: '+a),a},e.Cd=function(a,b){var c=Ac(b);if(''!=c.xa)a&&c.rb(a+'.'+c.xa),c.sb(c.Ca);else{var d=h.location;c=Bc(d.protocol,a?a+'.'+d.hostname:d.hostname,+d.port,b)}return this.gb&&Aa(this.gb,function(a,b){c.l(b,a)}),a=this.aa,b=this.Kc,a&&b&&c.l(a,b),c.l('VER',this.tc),this.Ya(c),c},e.Jb=function(a){if(a&&!this.gc)throw Error('Can\'t create secondary domain capable XhrIo object.');return a=new V(this.Xa),a.Je(this.gc),a},e.Ba=function(){return!!this.i&&this.i.Ba()},e.fc=function(){return this.gc},e=ad.prototype,e.sc=null,e.wd=function(){},e.ud=function(){},e.td=function(){},e.sd=function(){},e.Ba=function(){return!0},e.Ue=function(){},e.$a=function(a){return a},cd.prototype.cf=function(a,b){return new W(a,b)},x(W,H),e=W.prototype,e.addEventListener=function(a,b,c,d){W.L.addEventListener.call(this,a,b,c,d)},e.removeEventListener=function(a,b,c,d){W.L.removeEventListener.call(this,a,b,c,d)},e.open=function(){this.b.Ee(this.vd),this.Og&&this.b.Hg(),this.b.connect(this.Qg,this.yb,this.Rc||void 0)},e.close=function(){this.b.disconnect()},e.send=function(a){if(l(a)){var b={};b.__data__=a,this.b.Zc(b)}else this.zg?(b={},b.__data__=ub(a),this.b.Zc(b)):this.b.Zc(a)},e.F=function(){this.b.Ee(null),delete this.vd,this.b.disconnect(),delete this.b,W.L.F.call(this)},x(dd,fc),x(ed,gc),x(X,ad),X.prototype.wd=function(){Wb(this.b.s,'WebChannel opened on '+this.b.yb),this.b.dispatchEvent('a')},X.prototype.ud=function(a){this.b.dispatchEvent(new dd(a))},X.prototype.td=function(a){Wb(this.b.s,'WebChannel aborted on '+this.b.yb+' due to channel error: '+a),this.b.dispatchEvent(new ed(a))},X.prototype.sd=function(){Wb(this.b.s,'WebChannel closed on '+this.b.yb),this.b.dispatchEvent('b')};var fd=v(function(a){function c(){}c.prototype=a.prototype;var d=new c;return a.apply(d,Array.prototype.slice.call(arguments,1)),d},cd);e=gd.prototype,e.Vf=function(){0==this.V.length&&(this.V=this.Z,this.V.reverse(),this.Z=[])},e.enqueue=function(a){this.Z.push(a)},e.ab=function(){return this.Vf(),this.V.pop()},e.C=function(){return this.V.length+this.Z.length},e.X=function(){return 0==this.V.length&&0==this.Z.length},e.clear=function(){this.V=[],this.Z=[]},e.contains=function(a){return 0<=la(this.V,a)||0<=la(this.Z,a)},e.remove=function(a){var b=this.V,c=ma(b,a);return 0<=c?(Array.prototype.splice.call(b,c,1),b=!0):b=!1,b||sa(this.Z,a)},e.H=function(){for(var a=[],b=this.V.length-1;0<=b;--b)a.push(this.V[b]);var c=this.Z.length;for(b=0;b<c;++b)a.push(this.Z[b]);return a},x(hd,z);var id='[goog.structs.Pool] Min can not be greater than max';e=hd.prototype,e.Mb=function(){var a=w();if(!(null!=this.Nc&&a-this.Nc<this.Ac)){var b=this.qg();return b&&(this.Nc=a,this.oa.add(b)),b}},e.og=function(a){return!!this.oa.remove(a)&&(this.nc(a),!0)},e.qg=function(){for(var a;0<this.Td()&&(a=this.fa.ab(),!this.Sc(a));)this.Cb();return!a&&this.C()<this.Wb&&(a=this.xc()),a},e.nc=function(a){this.oa.remove(a),this.Sc(a)&&this.C()<this.Wb?this.fa.enqueue(a):this.Bc(a)},e.Cb=function(){for(var a=this.fa;this.C()<this.oe;)a.enqueue(this.xc());for(;this.C()>this.Wb&&0<this.Td();)this.Bc(a.ab())},e.xc=function(){return{}},e.Bc=function(a){if('function'==typeof a.bb)a.bb();else for(var b in a)a[b]=null},e.Sc=function(a){return'function'!=typeof a.Ye||a.Ye()},e.contains=function(a){return this.fa.contains(a)||this.oa.contains(a)},e.C=function(){return this.fa.C()+this.oa.C()},e.rf=function(){return this.oa.C()},e.Td=function(){return this.fa.C()},e.X=function(){return this.fa.X()&&this.oa.X()},e.F=function(){if(hd.L.F.call(this),0<this.rf())throw Error('[goog.structs.Pool] Objects not released');delete this.oa;for(var a=this.fa;!a.X();)this.Bc(a.ab());delete this.fa},jd.prototype.getKey=function(){return this.fe},jd.prototype.clone=function(){return new jd(this.fe,this.gd)},e=kd.prototype,e.ce=function(a,b){var c=this.Y;c.push(new jd(a,b)),this.$f(c.length-1)},e.Lf=function(a){if(a instanceof kd){var b=a.W();if(a=a.H(),0>=this.C()){for(var c=this.Y,d=0;d<b.length;d++)c.push(new jd(b[d],a[d]));return}}else b=Ca(a),a=Ba(a);for(d=0;d<b.length;d++)this.ce(b[d],a[d])},e.remove=function(){var a=this.Y,b=a.length,c=a[0];if(!(0>=b))return 1==b?ra(a):(a[0]=a.pop(),this.Zf()),c.gd},e.Zf=function(){for(var a=0,b=this.Y,c=b.length,d=b[a];a<c>>1;){var f=this.tf(a),g=this.zf(a);if(f=g<c&&b[g].getKey()<b[f].getKey()?g:f,b[f].getKey()>d.getKey())break;b[a]=b[f],a=f}b[a]=d},e.$f=function(a){for(var b=this.Y,c=b[a],d;0<a&&(d=this.wf(a),b[d].getKey()>c.getKey());)b[a]=b[d],a=d;b[a]=c},e.tf=function(a){return 2*a+1},e.zf=function(a){return 2*a+2},e.wf=function(a){return a-1>>1},e.H=function(){for(var a=this.Y,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].gd);return b},e.W=function(){for(var a=this.Y,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].getKey());return b},e.va=function(a){return oa(this.Y,function(b){return b.getKey()==a})},e.clone=function(){return new kd(this)},e.C=function(){return this.Y.length},e.X=function(){return 0==this.Y.length},e.clear=function(){ra(this.Y)},x(ld,kd),ld.prototype.enqueue=function(a,b){this.ce(a,b)},ld.prototype.ab=function(){return this.remove()},x(Y,hd),e=Y.prototype,e.Mb=function(a,b){return a?void(this.cc.enqueue(void 0===b?100:b,a),this.Nb()):((a=Y.L.Mb.call(this))&&this.Ac&&(this.Gd=h.setTimeout(u(this.Nb,this),this.Ac)),a)},e.Nb=function(){for(var a=this.cc,b;0<a.C()&&(b=this.Mb(),b);)a.ab().apply(this,[b])},e.nc=function(a){Y.L.nc.call(this,a),this.Nb()},e.Cb=function(){Y.L.Cb.call(this),this.Nb()},e.F=function(){Y.L.F.call(this),h.clearTimeout(this.Gd),this.cc.clear(),this.cc=null},x(Z,Y),Z.prototype.xc=function(){var a=new V,b=this.Jf;return b&&b.forEach(function(b,d){a.headers.set(d,b)}),this.Ab&&a.Je(!0),a},Z.prototype.Sc=function(a){return!a.Ka&&!a.Ba()},cd.prototype.createWebChannel=cd.prototype.cf,W.prototype.send=W.prototype.send,W.prototype.open=W.prototype.open,W.prototype.close=W.prototype.close,bc.NO_ERROR=0,bc.TIMEOUT=8,bc.HTTP_ERROR=6,cc.COMPLETE='complete',ec.EventType=Q,Q.OPEN='a',Q.CLOSE='b',Q.ERROR='c',Q.MESSAGE='d',H.prototype.listen=H.prototype.nb,Z.prototype.getObject=Z.prototype.Mb,Z.prototype.releaseObject=Z.prototype.og,V.prototype.listenOnce=V.prototype.Oc,V.prototype.getLastError=V.prototype.Hc,V.prototype.getLastErrorCode=V.prototype.Ud,V.prototype.getStatus=V.prototype.za,V.prototype.getStatusText=V.prototype.Yd,V.prototype.getResponseJson=V.prototype.yf,V.prototype.getResponseText=V.prototype.ya,V.prototype.getResponseText=V.prototype.ya,V.prototype.send=V.prototype.send;var src={createWebChannelTransport:fd,ErrorCode:bc,EventType:cc,WebChannel:ec,XhrIoPool:Z},src_1=src.createWebChannelTransport,src_2=src.ErrorCode,src_3=src.EventType,src_4=src.WebChannel,src_5=src.XhrIoPool;__webpack_exports__['default']=src}).call(__webpack_exports__,__webpack_require__(0))},function(module,exports,__webpack_require__){function BindToEventDecorator(_event,_target,_listenIn,_removeIn){return function(propertyName,func){const scope=this,event=_event||propertyName,target=_target?document.querySelector(_target):this.el;if(!target)return void console.warn('Couldn\'t subscribe '+this.name+'.'+propertyName+' to '+event+' on '+_target+' because querySelector returned undefined.');const listenIn=_listenIn||'init',removeIn=_removeIn||'remove',listenFunc=this[listenIn],removeFunc=this[removeIn],boundFunc=func.bind(this);return this[listenIn]=function(){void 0!==listenFunc&&listenFunc.apply(scope,arguments),target.addEventListener(event,boundFunc)},this[removeIn]=function(){void 0!==removeFunc&&removeFunc.apply(scope,arguments),target.removeEventListener(event,boundFunc)},func}}const decorate=__webpack_require__(14).decorate;module.exports.bindEvent=function bindEvent(p1,p2){if('function'==typeof p1)return decorate(p1,BindToEventDecorator());if('object'==typeof p1&&'function'==typeof p2)return decorate(p2,BindToEventDecorator(p1.event,p1.target,p1.listenIn,p1.removeIn));throw new Error('bindEvent must take: (function), or a ([object], function)')},module.exports.bindEventPlayPause=function bindEventPlayPause(p1,p2){if('function'==typeof p1)return decorate(p1,BindToEventDecorator(void 0,void 0,'play','pause'));if('object'==typeof p1&&'function'==typeof p2)return decorate(p2,BindToEventDecorator(p1.event,p1.target,'play','pause'));throw new Error('bindEventPlayPause must take: (function), or a ([object], function)')}},function(){THREE.BufferGeometryUtils={computeTangents:function(geometry){function handleTriangle(a,b,c){vA.fromArray(positions,3*a),vB.fromArray(positions,3*b),vC.fromArray(positions,3*c),uvA.fromArray(uvs,2*a),uvB.fromArray(uvs,2*b),uvC.fromArray(uvs,2*c);var x1=vB.x-vA.x,x2=vC.x-vA.x,y1=vB.y-vA.y,y2=vC.y-vA.y,z1=vB.z-vA.z,z2=vC.z-vA.z,s1=uvB.x-uvA.x,s2=uvC.x-uvA.x,t1=uvB.y-uvA.y,t2=uvC.y-uvA.y,r=1/(s1*t2-s2*t1);sdir.set((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r),tdir.set((s1*x2-s2*x1)*r,(s1*y2-s2*y1)*r,(s1*z2-s2*z1)*r),tan1[a].add(sdir),tan1[b].add(sdir),tan1[c].add(sdir),tan2[a].add(tdir),tan2[b].add(tdir),tan2[c].add(tdir)}function handleVertex(v){n.fromArray(normals,3*v),n2.copy(n),t=tan1[v],tmp.copy(t),tmp.sub(n.multiplyScalar(n.dot(t))).normalize(),tmp2.crossVectors(n2,t),test=tmp2.dot(tan2[v]),w=0>test?-1:1,tangents[4*v]=tmp.x,tangents[4*v+1]=tmp.y,tangents[4*v+2]=tmp.z,tangents[4*v+3]=w}var index=geometry.index,attributes=geometry.attributes;if(null===index||void 0===attributes.position||void 0===attributes.normal||void 0===attributes.uv)return void console.warn('THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()');var indices=index.array,positions=attributes.position.array,normals=attributes.normal.array,uvs=attributes.uv.array,nVertices=positions.length/3;attributes.tangent===void 0&&geometry.addAttribute('tangent',new THREE.BufferAttribute(new Float32Array(4*nVertices),4));for(var tangents=attributes.tangent.array,tan1=[],tan2=[],i=0;i<nVertices;i++)tan1[i]=new THREE.Vector3,tan2[i]=new THREE.Vector3;var vA=new THREE.Vector3,vB=new THREE.Vector3,vC=new THREE.Vector3,uvA=new THREE.Vector2,uvB=new THREE.Vector2,uvC=new THREE.Vector2,sdir=new THREE.Vector3,tdir=new THREE.Vector3,groups=geometry.groups;0===groups.length&&(groups=[{start:0,count:indices.length}]);for(var i=0,il=groups.length;i<il;++i)for(var group=groups[i],start=group.start,count=group.count,j=start,jl=start+count;j<jl;j+=3)handleTriangle(indices[j+0],indices[j+1],indices[j+2]);for(var tmp=new THREE.Vector3,tmp2=new THREE.Vector3,n=new THREE.Vector3,n2=new THREE.Vector3,i=0,il=groups.length,w,t,test;i<il;++i)for(var group=groups[i],start=group.start,count=group.count,j=start,jl=start+count;j<jl;j+=3)handleVertex(indices[j+0]),handleVertex(indices[j+1]),handleVertex(indices[j+2])},mergeBufferGeometries:function(geometries,useGroups){for(var isIndexed=null!==geometries[0].index,attributesUsed=new Set(Object.keys(geometries[0].attributes)),morphAttributesUsed=new Set(Object.keys(geometries[0].morphAttributes)),attributes={},morphAttributes={},mergedGeometry=new THREE.BufferGeometry,offset=0,i=0,geometry;i<geometries.length;++i){if(geometry=geometries[i],isIndexed!=(null!==geometry.index))return null;for(var name in geometry.attributes){if(!attributesUsed.has(name))return null;void 0===attributes[name]&&(attributes[name]=[]),attributes[name].push(geometry.attributes[name])}for(var name in geometry.morphAttributes){if(!morphAttributesUsed.has(name))return null;void 0===morphAttributes[name]&&(morphAttributes[name]=[]),morphAttributes[name].push(geometry.morphAttributes[name])}if(mergedGeometry.userData&&(mergedGeometry.userData.mergedUserData=mergedGeometry.userData.mergedUserData||[],mergedGeometry.userData.mergedUserData.push(geometry.userData)),useGroups){var count;if(isIndexed)count=geometry.index.count;else if(void 0!==geometry.attributes.position)count=geometry.attributes.position.count;else return null;mergedGeometry.addGroup(offset,count,i),offset+=count}}if(isIndexed){for(var indexOffset=0,mergedIndex=[],i=0,index;i<geometries.length;++i){index=geometries[i].index;for(var j=0;j<index.count;++j)mergedIndex.push(index.getX(j)+indexOffset);indexOffset+=geometries[i].attributes.position.count}mergedGeometry.setIndex(mergedIndex)}for(var name in attributes){var mergedAttribute=this.mergeBufferAttributes(attributes[name]);if(!mergedAttribute)return null;mergedGeometry.addAttribute(name,mergedAttribute)}for(var name in morphAttributes){var numMorphTargets=morphAttributes[name][0].length;if(0===numMorphTargets)break;mergedGeometry.morphAttributes=mergedGeometry.morphAttributes||{},mergedGeometry.morphAttributes[name]=[];for(var i=0,morphAttributesToMerge;i<numMorphTargets;++i){morphAttributesToMerge=[];for(var j=0;j<morphAttributes[name].length;++j)morphAttributesToMerge.push(morphAttributes[name][j][i]);var mergedMorphAttribute=this.mergeBufferAttributes(morphAttributesToMerge);if(!mergedMorphAttribute)return null;mergedGeometry.morphAttributes[name].push(mergedMorphAttribute)}}return mergedGeometry},mergeBufferAttributes:function(attributes){for(var arrayLength=0,i=0,TypedArray,itemSize,normalized,attribute;i<attributes.length;++i){if(attribute=attributes[i],attribute.isInterleavedBufferAttribute)return null;if(void 0==TypedArray&&(TypedArray=attribute.array.constructor),TypedArray!==attribute.array.constructor)return null;if(void 0==itemSize&&(itemSize=attribute.itemSize),itemSize!==attribute.itemSize)return null;if(void 0==normalized&&(normalized=attribute.normalized),normalized!==attribute.normalized)return null;arrayLength+=attribute.array.length}for(var array=new TypedArray(arrayLength),offset=0,i=0;i<attributes.length;++i)array.set(attributes[i].array,offset),offset+=attributes[i].array.length;return new THREE.BufferAttribute(array,itemSize,normalized)}}},function(){var _Mathmin3=Math.min,_Mathsqrt=Math.sqrt,_MathPI=Math.PI,_Mathmax3=Math.max;THREE.OrbitControls=function(object,domElement){function getAutoRotationAngle(){return 2*_MathPI/60/60*scope.autoRotateSpeed}function getZoomScale(){return Math.pow(0.95,scope.zoomSpeed)}function rotateLeft(angle){sphericalDelta.theta-=angle}function rotateUp(angle){sphericalDelta.phi-=angle}function dollyIn(dollyScale){scope.object.isPerspectiveCamera?scale/=dollyScale:scope.object.isOrthographicCamera?(scope.object.zoom=_Mathmax3(scope.minZoom,_Mathmin3(scope.maxZoom,scope.object.zoom*dollyScale)),scope.object.updateProjectionMatrix(),zoomChanged=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),scope.enableZoom=!1)}function dollyOut(dollyScale){scope.object.isPerspectiveCamera?scale*=dollyScale:scope.object.isOrthographicCamera?(scope.object.zoom=_Mathmax3(scope.minZoom,_Mathmin3(scope.maxZoom,scope.object.zoom/dollyScale)),scope.object.updateProjectionMatrix(),zoomChanged=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),scope.enableZoom=!1)}function handleMouseDownRotate(event){rotateStart.set(event.clientX,event.clientY)}function handleMouseDownDolly(event){dollyStart.set(event.clientX,event.clientY)}function handleMouseDownPan(event){panStart.set(event.clientX,event.clientY)}function handleMouseMoveRotate(event){rotateEnd.set(event.clientX,event.clientY),rotateDelta.subVectors(rotateEnd,rotateStart);var element=scope.domElement===document?scope.domElement.body:scope.domElement;rotateLeft(2*_MathPI*rotateDelta.x/element.clientWidth*scope.rotateSpeed),rotateUp(2*_MathPI*rotateDelta.y/element.clientHeight*scope.rotateSpeed),rotateStart.copy(rotateEnd),scope.update()}function handleMouseMoveDolly(event){dollyEnd.set(event.clientX,event.clientY),dollyDelta.subVectors(dollyEnd,dollyStart),0<dollyDelta.y?dollyIn(getZoomScale()):0>dollyDelta.y&&dollyOut(getZoomScale()),dollyStart.copy(dollyEnd),scope.update()}function handleMouseMovePan(event){panEnd.set(event.clientX,event.clientY),panDelta.subVectors(panEnd,panStart),pan(panDelta.x,panDelta.y),panStart.copy(panEnd),scope.update()}function handleMouseUp(){}function handleMouseWheel(event){0>event.deltaY?dollyOut(getZoomScale()):0<event.deltaY&&dollyIn(getZoomScale()),scope.update()}function handleKeyDown(event){switch(event.keyCode){case scope.keys.UP:pan(0,scope.keyPanSpeed),scope.update();break;case scope.keys.BOTTOM:pan(0,-scope.keyPanSpeed),scope.update();break;case scope.keys.LEFT:pan(scope.keyPanSpeed,0),scope.update();break;case scope.keys.RIGHT:pan(-scope.keyPanSpeed,0),scope.update();}}function handleTouchStartRotate(event){rotateStart.set(event.touches[0].pageX,event.touches[0].pageY)}function handleTouchStartDolly(event){var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY,distance=_Mathsqrt(dx*dx+dy*dy);dollyStart.set(0,distance)}function handleTouchStartPan(event){panStart.set(event.touches[0].pageX,event.touches[0].pageY)}function handleTouchMoveRotate(event){rotateEnd.set(event.touches[0].pageX,event.touches[0].pageY),rotateDelta.subVectors(rotateEnd,rotateStart);var element=scope.domElement===document?scope.domElement.body:scope.domElement;rotateLeft(2*_MathPI*rotateDelta.x/element.clientWidth*scope.rotateSpeed),rotateUp(2*_MathPI*rotateDelta.y/element.clientHeight*scope.rotateSpeed),rotateStart.copy(rotateEnd),scope.update()}function handleTouchMoveDolly(event){var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY,distance=_Mathsqrt(dx*dx+dy*dy);dollyEnd.set(0,distance),dollyDelta.subVectors(dollyEnd,dollyStart),0<dollyDelta.y?dollyOut(getZoomScale()):0>dollyDelta.y&&dollyIn(getZoomScale()),dollyStart.copy(dollyEnd),scope.update()}function handleTouchMovePan(event){panEnd.set(event.touches[0].pageX,event.touches[0].pageY),panDelta.subVectors(panEnd,panStart),pan(panDelta.x,panDelta.y),panStart.copy(panEnd),scope.update()}function handleTouchEnd(){}function onMouseDown(event){if(!1!==scope.enabled){switch(event.preventDefault(),event.button){case scope.mouseButtons.ORBIT:if(!1===scope.enableRotate)return;handleMouseDownRotate(event),state=STATE.ROTATE;break;case scope.mouseButtons.ZOOM:if(!1===scope.enableZoom)return;handleMouseDownDolly(event),state=STATE.DOLLY;break;case scope.mouseButtons.PAN:if(!1===scope.enablePan)return;handleMouseDownPan(event),state=STATE.PAN;}state!==STATE.NONE&&(document.addEventListener('mousemove',onMouseMove,!1),document.addEventListener('mouseup',onMouseUp,!1),scope.dispatchEvent(startEvent))}}function onMouseMove(event){if(!1!==scope.enabled)switch(event.preventDefault(),state){case STATE.ROTATE:if(!1===scope.enableRotate)return;handleMouseMoveRotate(event);break;case STATE.DOLLY:if(!1===scope.enableZoom)return;handleMouseMoveDolly(event);break;case STATE.PAN:if(!1===scope.enablePan)return;handleMouseMovePan(event);}}function onMouseUp(event){!1===scope.enabled||(handleMouseUp(event),document.removeEventListener('mousemove',onMouseMove,!1),document.removeEventListener('mouseup',onMouseUp,!1),scope.dispatchEvent(endEvent),state=STATE.NONE)}function onMouseWheel(event){!1===scope.enabled||!1===scope.enableZoom||state!==STATE.NONE&&state!==STATE.ROTATE||(event.preventDefault(),event.stopPropagation(),scope.dispatchEvent(startEvent),handleMouseWheel(event),scope.dispatchEvent(endEvent))}function onKeyDown(event){!1===scope.enabled||!1===scope.enableKeys||!1===scope.enablePan||handleKeyDown(event)}function onTouchStart(event){if(!1!==scope.enabled){switch(event.touches.length){case 1:if(!1===scope.enableRotate)return;handleTouchStartRotate(event),state=STATE.TOUCH_ROTATE;break;case 2:if(!1===scope.enableZoom)return;handleTouchStartDolly(event),state=STATE.TOUCH_DOLLY;break;case 3:if(!1===scope.enablePan)return;handleTouchStartPan(event),state=STATE.TOUCH_PAN;break;default:state=STATE.NONE;}state!==STATE.NONE&&scope.dispatchEvent(startEvent)}}function onTouchMove(event){if(!1!==scope.enabled)switch(event.preventDefault(),event.stopPropagation(),event.touches.length){case 1:if(!1===scope.enableRotate)return;if(state!==STATE.TOUCH_ROTATE)return;handleTouchMoveRotate(event);break;case 2:if(!1===scope.enableZoom)return;if(state!==STATE.TOUCH_DOLLY)return;handleTouchMoveDolly(event);break;case 3:if(!1===scope.enablePan)return;if(state!==STATE.TOUCH_PAN)return;handleTouchMovePan(event);break;default:state=STATE.NONE;}}function onTouchEnd(event){!1===scope.enabled||(handleTouchEnd(event),scope.dispatchEvent(endEvent),state=STATE.NONE)}function onContextMenu(event){!1===scope.enabled||event.preventDefault()}this.object=object,this.domElement=domElement===void 0?document:domElement,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=Infinity,this.minZoom=0,this.maxZoom=Infinity,this.minPolarAngle=0,this.maxPolarAngle=_MathPI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.enableDamping=!1,this.dampingFactor=0.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return spherical.phi},this.getAzimuthalAngle=function(){return spherical.theta},this.saveState=function(){scope.target0.copy(scope.target),scope.position0.copy(scope.object.position),scope.zoom0=scope.object.zoom},this.reset=function(){scope.target.copy(scope.target0),scope.object.position.copy(scope.position0),scope.object.zoom=scope.zoom0,scope.object.updateProjectionMatrix(),scope.dispatchEvent(changeEvent),scope.update(),state=STATE.NONE},this.update=function(){var offset=new THREE.Vector3,quat=new THREE.Quaternion().setFromUnitVectors(object.up,new THREE.Vector3(0,1,0)),quatInverse=quat.clone().inverse(),lastPosition=new THREE.Vector3,lastQuaternion=new THREE.Quaternion;return function update(){var position=scope.object.position;return offset.copy(position).sub(scope.target),offset.applyQuaternion(quat),spherical.setFromVector3(offset),scope.autoRotate&&state===STATE.NONE&&rotateLeft(getAutoRotationAngle()),spherical.theta+=sphericalDelta.theta,spherical.phi+=sphericalDelta.phi,spherical.theta=_Mathmax3(scope.minAzimuthAngle,_Mathmin3(scope.maxAzimuthAngle,spherical.theta)),spherical.phi=_Mathmax3(scope.minPolarAngle,_Mathmin3(scope.maxPolarAngle,spherical.phi)),spherical.makeSafe(),spherical.radius*=scale,spherical.radius=_Mathmax3(scope.minDistance,_Mathmin3(scope.maxDistance,spherical.radius)),scope.target.add(panOffset),offset.setFromSpherical(spherical),offset.applyQuaternion(quatInverse),position.copy(scope.target).add(offset),scope.object.lookAt(scope.target),!0===scope.enableDamping?(sphericalDelta.theta*=1-scope.dampingFactor,sphericalDelta.phi*=1-scope.dampingFactor):sphericalDelta.set(0,0,0),scale=1,panOffset.set(0,0,0),(zoomChanged||lastPosition.distanceToSquared(scope.object.position)>EPS||8*(1-lastQuaternion.dot(scope.object.quaternion))>EPS)&&(scope.dispatchEvent(changeEvent),lastPosition.copy(scope.object.position),lastQuaternion.copy(scope.object.quaternion),zoomChanged=!1,!0)}}(),this.dispose=function(){scope.domElement.removeEventListener('contextmenu',onContextMenu,!1),scope.domElement.removeEventListener('mousedown',onMouseDown,!1),scope.domElement.removeEventListener('wheel',onMouseWheel,!1),scope.domElement.removeEventListener('touchstart',onTouchStart,!1),scope.domElement.removeEventListener('touchend',onTouchEnd,!1),scope.domElement.removeEventListener('touchmove',onTouchMove,!1),document.removeEventListener('mousemove',onMouseMove,!1),document.removeEventListener('mouseup',onMouseUp,!1),window.removeEventListener('keydown',onKeyDown,!1)};var scope=this,changeEvent={type:'change'},startEvent={type:'start'},endEvent={type:'end'},STATE={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},state=STATE.NONE,EPS=1e-6,spherical=new THREE.Spherical,sphericalDelta=new THREE.Spherical,scale=1,panOffset=new THREE.Vector3,zoomChanged=!1,rotateStart=new THREE.Vector2,rotateEnd=new THREE.Vector2,rotateDelta=new THREE.Vector2,panStart=new THREE.Vector2,panEnd=new THREE.Vector2,panDelta=new THREE.Vector2,dollyStart=new THREE.Vector2,dollyEnd=new THREE.Vector2,dollyDelta=new THREE.Vector2,panLeft=function(){var v=new THREE.Vector3;return function panLeft(distance,objectMatrix){v.setFromMatrixColumn(objectMatrix,0),v.multiplyScalar(-distance),panOffset.add(v)}}(),panUp=function(){var v=new THREE.Vector3;return function panUp(distance,objectMatrix){v.setFromMatrixColumn(objectMatrix,1),v.multiplyScalar(distance),panOffset.add(v)}}(),pan=function(){var offset=new THREE.Vector3;return function pan(deltaX,deltaY){var element=scope.domElement===document?scope.domElement.body:scope.domElement;if(scope.object.isPerspectiveCamera){var position=scope.object.position;offset.copy(position).sub(scope.target);var targetDistance=offset.length();targetDistance*=Math.tan(scope.object.fov/2*_MathPI/180),panLeft(2*deltaX*targetDistance/element.clientHeight,scope.object.matrix),panUp(2*deltaY*targetDistance/element.clientHeight,scope.object.matrix)}else scope.object.isOrthographicCamera?(panLeft(deltaX*(scope.object.right-scope.object.left)/scope.object.zoom/element.clientWidth,scope.object.matrix),panUp(deltaY*(scope.object.top-scope.object.bottom)/scope.object.zoom/element.clientHeight,scope.object.matrix)):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.'),scope.enablePan=!1)}}();scope.domElement.addEventListener('contextmenu',onContextMenu,!1),scope.domElement.addEventListener('mousedown',onMouseDown,!1),scope.domElement.addEventListener('wheel',onMouseWheel,!1),scope.domElement.addEventListener('touchstart',onTouchStart,!1),scope.domElement.addEventListener('touchend',onTouchEnd,!1),scope.domElement.addEventListener('touchmove',onTouchMove,!1),window.addEventListener('keydown',onKeyDown,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn('THREE.OrbitControls: .center has been renamed to .target'),this.target}},noZoom:{get:function(){return console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),!this.enableZoom},set:function(value){console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),this.enableZoom=!value}},noRotate:{get:function(){return console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),!this.enableRotate},set:function(value){console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),this.enableRotate=!value}},noPan:{get:function(){return console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),!this.enablePan},set:function(value){console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),this.enablePan=!value}},noKeys:{get:function(){return console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),!this.enableKeys},set:function(value){console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),this.enableKeys=!value}},staticMoving:{get:function(){return console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),!this.enableDamping},set:function(value){console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),this.enableDamping=!value}},dynamicDampingFactor:{get:function(){return console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor},set:function(value){console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor=value}}})},function(module,exports,__webpack_require__){var _Mathfloor3=Math.floor;(function(process){function AlgoliaSearchCore(applicationID,apiKey,opts){var debug=__webpack_require__(8)('algoliasearch'),clone=__webpack_require__(1),isArray=__webpack_require__(9),map=__webpack_require__(6),usage='Usage: algoliasearch(applicationID, apiKey, opts)';if(!0!==opts._allowEmptyCredentials&&!applicationID)throw new errors.AlgoliaSearchError('Please provide an application ID. '+usage);if(!0!==opts._allowEmptyCredentials&&!apiKey)throw new errors.AlgoliaSearchError('Please provide an API key. '+usage);this.applicationID=applicationID,this.apiKey=apiKey,this.hosts={read:[],write:[]},opts=opts||{},this._timeouts=opts.timeouts||{connect:1*1e3,read:2*1e3,write:30*1e3},opts.timeout&&(this._timeouts.connect=this._timeouts.read=this._timeouts.write=opts.timeout);var protocol=opts.protocol||'https:';if(/:$/.test(protocol)||(protocol+=':'),'http:'!==protocol&&'https:'!==protocol)throw new errors.AlgoliaSearchError('protocol must be `http:` or `https:` (was `'+opts.protocol+'`)');if(this._checkAppIdData(),!opts.hosts){var defaultHosts=map(this._shuffleResult,function(hostNumber){return applicationID+'-'+hostNumber+'.algolianet.com'}),mainSuffix=(!1===opts.dsn?'':'-dsn')+'.algolia.net';this.hosts.read=[this.applicationID+mainSuffix].concat(defaultHosts),this.hosts.write=[this.applicationID+'.algolia.net'].concat(defaultHosts)}else isArray(opts.hosts)?(this.hosts.read=clone(opts.hosts),this.hosts.write=clone(opts.hosts)):(this.hosts.read=clone(opts.hosts.read),this.hosts.write=clone(opts.hosts.write));this.hosts.read=map(this.hosts.read,prepareHost(protocol)),this.hosts.write=map(this.hosts.write,prepareHost(protocol)),this.extraHeaders={},this.cache=opts._cache||{},this._ua=opts._ua,this._useCache=void 0===opts._useCache||opts._cache||opts._useCache,this._useRequestCache=this._useCache&&opts._useRequestCache,this._useFallback=void 0===opts.useFallback||opts.useFallback,this._setTimeout=opts._setTimeout,debug('init done, %j',this)}function prepareHost(protocol){return function prepare(host){return protocol+'//'+host.toLowerCase()}}function safeJSONStringify(obj){if(void 0===Array.prototype.toJSON)return JSON.stringify(obj);var toJSON=Array.prototype.toJSON;delete Array.prototype.toJSON;var out=JSON.stringify(obj);return Array.prototype.toJSON=toJSON,out}function shuffle(array){for(var currentIndex=array.length,temporaryValue,randomIndex;0!==currentIndex;)randomIndex=_Mathfloor3(Math.random()*currentIndex),currentIndex-=1,temporaryValue=array[currentIndex],array[currentIndex]=array[randomIndex],array[randomIndex]=temporaryValue;return array}function removeCredentials(headers){var newHeaders={};for(var headerName in headers)if(Object.prototype.hasOwnProperty.call(headers,headerName)){var value;value='x-algolia-api-key'==headerName||'x-algolia-application-id'==headerName?'**hidden for security purposes**':headers[headerName],newHeaders[headerName]=value}return newHeaders}module.exports=AlgoliaSearchCore;var errors=__webpack_require__(5),exitPromise=__webpack_require__(51),IndexCore=__webpack_require__(44),store=__webpack_require__(54),RESET_APP_DATA_TIMER=process.env.RESET_APP_DATA_TIMER&&parseInt(process.env.RESET_APP_DATA_TIMER,10)||1e3*(2*60);AlgoliaSearchCore.prototype.initIndex=function(indexName){return new IndexCore(this,indexName)},AlgoliaSearchCore.prototype.setExtraHeader=function(name,value){this.extraHeaders[name.toLowerCase()]=value},AlgoliaSearchCore.prototype.getExtraHeader=function(name){return this.extraHeaders[name.toLowerCase()]},AlgoliaSearchCore.prototype.unsetExtraHeader=function(name){delete this.extraHeaders[name.toLowerCase()]},AlgoliaSearchCore.prototype.addAlgoliaAgent=function(algoliaAgent){-1===this._ua.indexOf(';'+algoliaAgent)&&(this._ua+=';'+algoliaAgent)},AlgoliaSearchCore.prototype._jsonRequest=function(initialOpts){function doRequest(requester,reqOpts){function retryRequest(){return requestDebug('retrying request'),client._incrementHostIndex(initialOpts.hostType),doRequest(requester,reqOpts)}function retryRequestWithHigherTimeout(){return requestDebug('retrying request with higher timeout'),client._incrementHostIndex(initialOpts.hostType),client._incrementTimeoutMultipler(),reqOpts.timeouts=client._getTimeoutsForRequest(initialOpts.hostType),doRequest(requester,reqOpts)}client._checkAppIdData();var startTime=new Date;if(client._useCache&&!client._useRequestCache&&(cacheID=initialOpts.url),client._useCache&&!client._useRequestCache&&body&&(cacheID+='_body_'+reqOpts.body),isCacheValidWithCurrentID(!client._useRequestCache,cache,cacheID)){requestDebug('serving response from cache');var responseText=cache[cacheID];return client._promise.resolve({body:JSON.parse(responseText),responseText:responseText})}if(tries>=client.hosts[initialOpts.hostType].length)return!hasFallback||usingFallback?(requestDebug('could not get any response'),client._promise.reject(new errors.AlgoliaSearchError('Cannot connect to the AlgoliaSearch API.'+' Send an email to support@algolia.com to report and resolve the issue.'+' Application id was: '+client.applicationID,{debugData:debugData}))):(requestDebug('switching to fallback'),tries=0,reqOpts.method=initialOpts.fallback.method,reqOpts.url=initialOpts.fallback.url,reqOpts.jsonBody=initialOpts.fallback.body,reqOpts.jsonBody&&(reqOpts.body=safeJSONStringify(reqOpts.jsonBody)),headers=client._computeRequestHeaders({additionalUA:additionalUA,headers:initialOpts.headers}),reqOpts.timeouts=client._getTimeoutsForRequest(initialOpts.hostType),client._setHostIndexByType(0,initialOpts.hostType),usingFallback=!0,doRequest(client._request.fallback,reqOpts));var currentHost=client._getHostByType(initialOpts.hostType),url=currentHost+reqOpts.url,options={body:reqOpts.body,jsonBody:reqOpts.jsonBody,method:reqOpts.method,headers:headers,timeouts:reqOpts.timeouts,debug:requestDebug,forceAuthHeaders:reqOpts.forceAuthHeaders};return requestDebug('method: %s, url: %s, headers: %j, timeouts: %d',options.method,url,options.headers,options.timeouts),requester===client._request.fallback&&requestDebug('using fallback'),requester.call(client,url,options).then(function success(httpResponse){var status=httpResponse&&httpResponse.body&&httpResponse.body.message&&httpResponse.body.status||httpResponse.statusCode||httpResponse&&httpResponse.body&&200;requestDebug('received response: statusCode: %s, computed statusCode: %d, headers: %j',httpResponse.statusCode,status,httpResponse.headers);var httpResponseOk=2===_Mathfloor3(status/100),endTime=new Date;if(debugData.push({currentHost:currentHost,headers:removeCredentials(headers),content:body||null,contentLength:void 0===body?null:body.length,method:reqOpts.method,timeouts:reqOpts.timeouts,url:reqOpts.url,startTime:startTime,endTime:endTime,duration:endTime-startTime,statusCode:status}),httpResponseOk)return client._useCache&&!client._useRequestCache&&cache&&(cache[cacheID]=httpResponse.responseText),{responseText:httpResponse.responseText,body:httpResponse.body};var shouldRetry=4!==_Mathfloor3(status/100);if(shouldRetry)return tries+=1,retryRequest();requestDebug('unrecoverable error');var unrecoverableError=new errors.AlgoliaSearchError(httpResponse.body&&httpResponse.body.message,{debugData:debugData,statusCode:status});return client._promise.reject(unrecoverableError)},function tryFallback(err){requestDebug('error: %s, stack: %s',err.message,err.stack);var endTime=new Date;return debugData.push({currentHost:currentHost,headers:removeCredentials(headers),content:body||null,contentLength:void 0===body?null:body.length,method:reqOpts.method,timeouts:reqOpts.timeouts,url:reqOpts.url,startTime:startTime,endTime:endTime,duration:endTime-startTime}),err instanceof errors.AlgoliaSearchError||(err=new errors.Unknown(err&&err.message,err)),tries+=1,err instanceof errors.Unknown||err instanceof errors.UnparsableJSON||tries>=client.hosts[initialOpts.hostType].length&&(usingFallback||!hasFallback)?(err.debugData=debugData,client._promise.reject(err)):err instanceof errors.RequestTimeout?retryRequestWithHigherTimeout():retryRequest()})}function isCacheValidWithCurrentID(useRequestCache,currentCache,currentCacheID){return client._useCache&&useRequestCache&&currentCache&&void 0!==currentCache[currentCacheID]}function interopCallbackReturn(request,callback){return isCacheValidWithCurrentID(client._useRequestCache,cache,cacheID)&&request.catch(function(){delete cache[cacheID]}),'function'==typeof initialOpts.callback?void request.then(function okCb(content){exitPromise(function(){initialOpts.callback(null,callback(content))},client._setTimeout||setTimeout)},function nookCb(err){exitPromise(function(){initialOpts.callback(err)},client._setTimeout||setTimeout)}):request.then(callback)}this._checkAppIdData();var requestDebug=__webpack_require__(8)('algoliasearch:'+initialOpts.url),additionalUA=initialOpts.additionalUA||'',cache=initialOpts.cache,client=this,tries=0,usingFallback=!1,hasFallback=client._useFallback&&client._request.fallback&&initialOpts.fallback,body,cacheID,headers;this.apiKey.length>500&&void 0!==initialOpts.body&&(void 0!==initialOpts.body.params||void 0!==initialOpts.body.requests)?(initialOpts.body.apiKey=this.apiKey,headers=this._computeRequestHeaders({additionalUA:additionalUA,withApiKey:!1,headers:initialOpts.headers})):headers=this._computeRequestHeaders({additionalUA:additionalUA,headers:initialOpts.headers}),void 0!==initialOpts.body&&(body=safeJSONStringify(initialOpts.body)),requestDebug('request start');var debugData=[];if(client._useCache&&client._useRequestCache&&(cacheID=initialOpts.url),client._useCache&&client._useRequestCache&&body&&(cacheID+='_body_'+body),isCacheValidWithCurrentID(client._useRequestCache,cache,cacheID)){requestDebug('serving request from cache');var maybePromiseForCache=cache[cacheID],promiseForCache='function'==typeof maybePromiseForCache.then?maybePromiseForCache:client._promise.resolve({responseText:maybePromiseForCache});return interopCallbackReturn(promiseForCache,function(content){return JSON.parse(content.responseText)})}var request=doRequest(client._request,{url:initialOpts.url,method:initialOpts.method,body:body,jsonBody:initialOpts.body,timeouts:client._getTimeoutsForRequest(initialOpts.hostType),forceAuthHeaders:initialOpts.forceAuthHeaders});return client._useCache&&client._useRequestCache&&cache&&(cache[cacheID]=request),interopCallbackReturn(request,function(content){return content.body})},AlgoliaSearchCore.prototype._getSearchParams=function(args,params){if(args===void 0||null===args)return params;for(var key in args)null!==key&&void 0!==args[key]&&args.hasOwnProperty(key)&&(params+=''===params?'':'&',params+=key+'='+encodeURIComponent('[object Array]'===Object.prototype.toString.call(args[key])?safeJSONStringify(args[key]):args[key]));return params},AlgoliaSearchCore.prototype._computeRequestHeaders=function(options){var forEach=__webpack_require__(3),ua=options.additionalUA?this._ua+';'+options.additionalUA:this._ua,requestHeaders={"x-algolia-agent":ua,"x-algolia-application-id":this.applicationID};return!1!==options.withApiKey&&(requestHeaders['x-algolia-api-key']=this.apiKey),this.userToken&&(requestHeaders['x-algolia-usertoken']=this.userToken),this.securityTags&&(requestHeaders['x-algolia-tagfilters']=this.securityTags),forEach(this.extraHeaders,function addToRequestHeaders(value,key){requestHeaders[key]=value}),options.headers&&forEach(options.headers,function addToRequestHeaders(value,key){requestHeaders[key]=value}),requestHeaders},AlgoliaSearchCore.prototype.search=function(queries,opts,callback){var isArray=__webpack_require__(9),map=__webpack_require__(6);if(!isArray(queries))throw new Error('Usage: client.search(arrayOfQueries[, callback])');'function'==typeof opts?(callback=opts,opts={}):void 0===opts&&(opts={});var client=this,postObj={requests:map(queries,function prepareRequest(query){var params='';return void 0!==query.query&&(params+='query='+encodeURIComponent(query.query)),{indexName:query.indexName,params:client._getSearchParams(query.params,params)}})},JSONPParams=map(postObj.requests,function prepareJSONPParams(request,requestId){return requestId+'='+encodeURIComponent('/1/indexes/'+encodeURIComponent(request.indexName)+'?'+request.params)}).join('&'),url='/1/indexes/*/queries';return void 0!==opts.strategy&&(url+='?strategy='+opts.strategy),this._jsonRequest({cache:this.cache,method:'POST',url:url,body:postObj,hostType:'read',fallback:{method:'GET',url:'/1/indexes/*',body:{params:JSONPParams}},callback:callback})},AlgoliaSearchCore.prototype.searchForFacetValues=function(queries){var isArray=__webpack_require__(9),map=__webpack_require__(6),usage='Usage: client.searchForFacetValues([{indexName, params: {facetName, facetQuery, ...params}}, ...queries])';if(!isArray(queries))throw new Error(usage);var client=this;return client._promise.all(map(queries,function performQuery(query){if(!query||query.indexName===void 0||query.params.facetName===void 0||query.params.facetQuery===void 0)throw new Error(usage);var clone=__webpack_require__(1),omit=__webpack_require__(17),indexName=query.indexName,params=query.params,facetName=params.facetName,filteredParams=omit(clone(params),function(keyName){return'facetName'===keyName}),searchParameters=client._getSearchParams(filteredParams,'');return client._jsonRequest({cache:client.cache,method:'POST',url:'/1/indexes/'+encodeURIComponent(indexName)+'/facets/'+encodeURIComponent(facetName)+'/query',hostType:'read',body:{params:searchParameters}})}))},AlgoliaSearchCore.prototype.setSecurityTags=function(tags){if('[object Array]'===Object.prototype.toString.call(tags)){for(var strTags=[],i=0;i<tags.length;++i)if('[object Array]'===Object.prototype.toString.call(tags[i])){for(var oredTags=[],j=0;j<tags[i].length;++j)oredTags.push(tags[i][j]);strTags.push('('+oredTags.join(',')+')')}else strTags.push(tags[i]);tags=strTags.join(',')}this.securityTags=tags},AlgoliaSearchCore.prototype.setUserToken=function(userToken){this.userToken=userToken},AlgoliaSearchCore.prototype.clearCache=function(){this.cache={}},AlgoliaSearchCore.prototype.setRequestTimeout=function(milliseconds){milliseconds&&(this._timeouts.connect=this._timeouts.read=this._timeouts.write=milliseconds)},AlgoliaSearchCore.prototype.setTimeouts=function(timeouts){this._timeouts=timeouts},AlgoliaSearchCore.prototype.getTimeouts=function(){return this._timeouts},AlgoliaSearchCore.prototype._getAppIdData=function(){var data=store.get(this.applicationID);return null!==data&&this._cacheAppIdData(data),data},AlgoliaSearchCore.prototype._setAppIdData=function(data){return data.lastChange=new Date().getTime(),this._cacheAppIdData(data),store.set(this.applicationID,data)},AlgoliaSearchCore.prototype._checkAppIdData=function(){var data=this._getAppIdData(),now=new Date().getTime();return null===data||now-data.lastChange>RESET_APP_DATA_TIMER?this._resetInitialAppIdData(data):data},AlgoliaSearchCore.prototype._resetInitialAppIdData=function(data){var newData=data||{};return newData.hostIndexes={read:0,write:0},newData.timeoutMultiplier=1,newData.shuffleResult=newData.shuffleResult||shuffle([1,2,3]),this._setAppIdData(newData)},AlgoliaSearchCore.prototype._cacheAppIdData=function(data){this._hostIndexes=data.hostIndexes,this._timeoutMultiplier=data.timeoutMultiplier,this._shuffleResult=data.shuffleResult},AlgoliaSearchCore.prototype._partialAppIdDataUpdate=function(newData){var foreach=__webpack_require__(3),currentData=this._getAppIdData();return foreach(newData,function(value,key){currentData[key]=value}),this._setAppIdData(currentData)},AlgoliaSearchCore.prototype._getHostByType=function(hostType){return this.hosts[hostType][this._getHostIndexByType(hostType)]},AlgoliaSearchCore.prototype._getTimeoutMultiplier=function(){return this._timeoutMultiplier},AlgoliaSearchCore.prototype._getHostIndexByType=function(hostType){return this._hostIndexes[hostType]},AlgoliaSearchCore.prototype._setHostIndexByType=function(hostIndex,hostType){var clone=__webpack_require__(1),newHostIndexes=clone(this._hostIndexes);return newHostIndexes[hostType]=hostIndex,this._partialAppIdDataUpdate({hostIndexes:newHostIndexes}),hostIndex},AlgoliaSearchCore.prototype._incrementHostIndex=function(hostType){return this._setHostIndexByType((this._getHostIndexByType(hostType)+1)%this.hosts[hostType].length,hostType)},AlgoliaSearchCore.prototype._incrementTimeoutMultipler=function(){var timeoutMultiplier=Math.max(this._timeoutMultiplier+1,4);return this._partialAppIdDataUpdate({timeoutMultiplier:timeoutMultiplier})},AlgoliaSearchCore.prototype._getTimeoutsForRequest=function(hostType){return{connect:this._timeouts.connect*this._timeoutMultiplier,complete:this._timeouts[hostType]*this._timeoutMultiplier}}}).call(exports,__webpack_require__(4))},function(module,exports,__webpack_require__){function IndexCore(algoliasearch,indexName){this.indexName=indexName,this.as=algoliasearch,this.typeAheadArgs=null,this.typeAheadValueOption=null,this.cache={}}var buildSearchMethod=__webpack_require__(16),deprecate=__webpack_require__(49),deprecatedMessage=__webpack_require__(50);module.exports=IndexCore,IndexCore.prototype.clearCache=function(){this.cache={}},IndexCore.prototype.search=buildSearchMethod('query'),IndexCore.prototype.similarSearch=buildSearchMethod('similarQuery'),IndexCore.prototype.browse=function(query,queryParameters,callback){var merge=__webpack_require__(52),indexObj=this,page,hitsPerPage;0===arguments.length||1===arguments.length&&'function'==typeof arguments[0]?(page=0,callback=arguments[0],query=void 0):'number'==typeof arguments[0]?(page=arguments[0],'number'==typeof arguments[1]?hitsPerPage=arguments[1]:'function'==typeof arguments[1]&&(callback=arguments[1],hitsPerPage=void 0),query=void 0,queryParameters=void 0):'object'==typeof arguments[0]?('function'==typeof arguments[1]&&(callback=arguments[1]),queryParameters=arguments[0],query=void 0):'string'==typeof arguments[0]&&'function'==typeof arguments[1]&&(callback=arguments[1],queryParameters=void 0),queryParameters=merge({},queryParameters||{},{page:page,hitsPerPage:hitsPerPage,query:query});var params=this.as._getSearchParams(queryParameters,'');return this.as._jsonRequest({method:'POST',url:'/1/indexes/'+encodeURIComponent(indexObj.indexName)+'/browse',body:{params:params},hostType:'read',callback:callback})},IndexCore.prototype.browseFrom=function(cursor,callback){return this.as._jsonRequest({method:'POST',url:'/1/indexes/'+encodeURIComponent(this.indexName)+'/browse',body:{cursor:cursor},hostType:'read',callback:callback})},IndexCore.prototype.searchForFacetValues=function(params,callback){var clone=__webpack_require__(1),omit=__webpack_require__(17);if(params.facetName===void 0||params.facetQuery===void 0)throw new Error('Usage: index.searchForFacetValues({facetName, facetQuery, ...params}[, callback])');var facetName=params.facetName,filteredParams=omit(clone(params),function(keyName){return'facetName'===keyName}),searchParameters=this.as._getSearchParams(filteredParams,'');return this.as._jsonRequest({method:'POST',url:'/1/indexes/'+encodeURIComponent(this.indexName)+'/facets/'+encodeURIComponent(facetName)+'/query',hostType:'read',body:{params:searchParameters},callback:callback})},IndexCore.prototype.searchFacet=deprecate(function(params,callback){return this.searchForFacetValues(params,callback)},deprecatedMessage('index.searchFacet(params[, callback])','index.searchForFacetValues(params[, callback])')),IndexCore.prototype._search=function(params,url,callback,additionalUA){return this.as._jsonRequest({cache:this.cache,method:'POST',url:url||'/1/indexes/'+encodeURIComponent(this.indexName)+'/query',body:{params:params},hostType:'read',fallback:{method:'GET',url:'/1/indexes/'+encodeURIComponent(this.indexName),body:{params:params}},callback:callback,additionalUA:additionalUA})},IndexCore.prototype.getObject=function(objectID,attrs,callback){var indexObj=this;(1===arguments.length||'function'==typeof attrs)&&(callback=attrs,attrs=void 0);var params='';if(attrs!==void 0){params='?attributes=';for(var i=0;i<attrs.length;++i)0!==i&&(params+=','),params+=attrs[i]}return this.as._jsonRequest({method:'GET',url:'/1/indexes/'+encodeURIComponent(indexObj.indexName)+'/'+encodeURIComponent(objectID)+params,hostType:'read',callback:callback})},IndexCore.prototype.getObjects=function(objectIDs,attributesToRetrieve,callback){var isArray=__webpack_require__(9),map=__webpack_require__(6);if(!isArray(objectIDs))throw new Error('Usage: index.getObjects(arrayOfObjectIDs[, callback])');var indexObj=this;(1===arguments.length||'function'==typeof attributesToRetrieve)&&(callback=attributesToRetrieve,attributesToRetrieve=void 0);var body={requests:map(objectIDs,function prepareRequest(objectID){var request={indexName:indexObj.indexName,objectID:objectID};return attributesToRetrieve&&(request.attributesToRetrieve=attributesToRetrieve.join(',')),request})};return this.as._jsonRequest({method:'POST',url:'/1/indexes/*/objects',hostType:'read',body:body,callback:callback})},IndexCore.prototype.as=null,IndexCore.prototype.indexName=null,IndexCore.prototype.typeAheadArgs=null,IndexCore.prototype.typeAheadValueOption=null},function(module,exports,__webpack_require__){'use strict';var AlgoliaSearchCore=__webpack_require__(43),createAlgoliasearch=__webpack_require__(46);module.exports=createAlgoliasearch(AlgoliaSearchCore,'(lite) ')},function(module,exports,__webpack_require__){'use strict';var global=__webpack_require__(142),Promise=global.Promise||__webpack_require__(139).Promise;module.exports=function createAlgoliasearch(AlgoliaSearch,uaSuffix){function algoliasearch(applicationID,apiKey,opts){var cloneDeep=__webpack_require__(1);return opts=cloneDeep(opts||{}),opts._ua=opts._ua||algoliasearch.ua,new AlgoliaSearchBrowser(applicationID,apiKey,opts)}function AlgoliaSearchBrowser(){AlgoliaSearch.apply(this,arguments)}var inherits=__webpack_require__(18),errors=__webpack_require__(5),inlineHeaders=__webpack_require__(47),jsonpRequest=__webpack_require__(48),places=__webpack_require__(53);uaSuffix=uaSuffix||'',!1,algoliasearch.version=__webpack_require__(55),algoliasearch.ua='Algolia for vanilla JavaScript '+uaSuffix+algoliasearch.version,algoliasearch.initPlaces=places(algoliasearch),global.__algolia={debug:__webpack_require__(8),algoliasearch:algoliasearch};var support={hasXMLHttpRequest:'XMLHttpRequest'in global,hasXDomainRequest:'XDomainRequest'in global};return support.hasXMLHttpRequest&&(support.cors='withCredentials'in new XMLHttpRequest),inherits(AlgoliaSearchBrowser,AlgoliaSearch),AlgoliaSearchBrowser.prototype._request=function request(url,opts){return new Promise(function wrapRequest(resolve,reject){function onTimeout(){timedOut=!0,req.abort(),reject(new errors.RequestTimeout)}function onConnect(){connected=!0,clearTimeout(reqTimeout),reqTimeout=setTimeout(onTimeout,opts.timeouts.complete)}if(!support.cors&&!support.hasXDomainRequest)return void reject(new errors.Network('CORS not supported'));url=inlineHeaders(url,opts.headers);var body=opts.body,req=support.cors?new XMLHttpRequest:new XDomainRequest,connected=!1,reqTimeout,timedOut;reqTimeout=setTimeout(onTimeout,opts.timeouts.connect),req.onprogress=function onProgress(){connected||onConnect()},'onreadystatechange'in req&&(req.onreadystatechange=function onReadyStateChange(){!connected&&1<req.readyState&&onConnect()}),req.onload=function onLoad(){if(!timedOut){clearTimeout(reqTimeout);var out;try{out={body:JSON.parse(req.responseText),responseText:req.responseText,statusCode:req.status,headers:req.getAllResponseHeaders&&req.getAllResponseHeaders()||{}}}catch(e){out=new errors.UnparsableJSON({more:req.responseText})}out instanceof errors.UnparsableJSON?reject(out):resolve(out)}},req.onerror=function onError(event){timedOut||(clearTimeout(reqTimeout),reject(new errors.Network({more:event})))},req instanceof XMLHttpRequest?(req.open(opts.method,url,!0),opts.forceAuthHeaders&&(req.setRequestHeader('x-algolia-application-id',opts.headers['x-algolia-application-id']),req.setRequestHeader('x-algolia-api-key',opts.headers['x-algolia-api-key']))):req.open(opts.method,url),support.cors&&(body&&('POST'===opts.method?req.setRequestHeader('content-type','application/x-www-form-urlencoded'):req.setRequestHeader('content-type','application/json')),req.setRequestHeader('accept','application/json')),body?req.send(body):req.send()})},AlgoliaSearchBrowser.prototype._request.fallback=function requestFallback(url,opts){return url=inlineHeaders(url,opts.headers),new Promise(function wrapJsonpRequest(resolve,reject){jsonpRequest(url,opts,function jsonpRequestDone(err,content){return err?void reject(err):void resolve(content)})})},AlgoliaSearchBrowser.prototype._promise={reject:function rejectPromise(val){return Promise.reject(val)},resolve:function resolvePromise(val){return Promise.resolve(val)},delay:function delayPromise(ms){return new Promise(function resolveOnTimeout(resolve){setTimeout(resolve,ms)})},all:function all(promises){return Promise.all(promises)}},algoliasearch}},function(module,exports,__webpack_require__){'use strict';module.exports=function inlineHeaders(url,headers){return url+=/\?/.test(url)?'&':'?',url+encode(headers)};var encode=__webpack_require__(146)},function(module,exports,__webpack_require__){'use strict';module.exports=function jsonpRequest(url,opts,cb){function success(){opts.debug('JSONP: success');done||timedOut||(done=!0,!cbCalled&&(opts.debug('JSONP: Fail. Script loaded but did not call the callback'),clean(),cb(new errors.JSONPScriptFail)))}function clean(){clearTimeout(ontimeout),script.onload=null,script.onreadystatechange=null,script.onerror=null,head.removeChild(script)}function removeGlobals(){try{delete window[cbName],delete window[cbName+'_loaded']}catch(e){window[cbName]=window[cbName+'_loaded']=void 0}}if('GET'!==opts.method)return void cb(new Error('Method '+opts.method+' '+url+' is not supported by JSONP.'));opts.debug('JSONP: start');var cbCalled=!1,timedOut=!1;JSONPCounter+=1;var head=document.getElementsByTagName('head')[0],script=document.createElement('script'),cbName='algoliaJSONP_'+JSONPCounter,done=!1;window[cbName]=function(data){return removeGlobals(),timedOut?void opts.debug('JSONP: Late answer, ignoring'):void(cbCalled=!0,clean(),cb(null,{body:data,responseText:JSON.stringify(data)}))},url+='&callback='+cbName,opts.jsonBody&&opts.jsonBody.params&&(url+='&'+opts.jsonBody.params);var ontimeout=setTimeout(function timeout(){opts.debug('JSONP: Script timeout'),timedOut=!0,clean(),cb(new errors.RequestTimeout)},opts.timeouts.complete);script.onreadystatechange=function readystatechange(){('loaded'===this.readyState||'complete'===this.readyState)&&success()},script.onload=success,script.onerror=function error(){opts.debug('JSONP: Script error');done||timedOut||(clean(),cb(new errors.JSONPScriptError))},script.async=!0,script.defer=!0,script.src=url,head.appendChild(script)};var errors=__webpack_require__(5),JSONPCounter=0},function(module){module.exports=function deprecate(fn,message){var warned=!1;return function deprecated(){return warned||(console.warn(message),warned=!0),fn.apply(this,arguments)}}},function(module){module.exports=function deprecatedMessage(previousUsage,newUsage){var githubAnchorLink=previousUsage.toLowerCase().replace(/[\.\(\)]/g,'');return'algoliasearch: `'+previousUsage+'` was replaced by `'+newUsage+'`. Please see https://github.com/algolia/algoliasearch-client-javascript/wiki/Deprecated#'+githubAnchorLink}},function(module){module.exports=function exitPromise(fn,_setTimeout){_setTimeout(fn,0)}},function(module,exports,__webpack_require__){var foreach=__webpack_require__(3);module.exports=function merge(destination){var sources=Array.prototype.slice.call(arguments);return foreach(sources,function(source){for(var keyName in source)source.hasOwnProperty(keyName)&&('object'==typeof destination[keyName]&&'object'==typeof source[keyName]?destination[keyName]=merge({},destination[keyName],source[keyName]):void 0!==source[keyName]&&(destination[keyName]=source[keyName]))}),destination}},function(module,exports,__webpack_require__){module.exports=function createPlacesClient(algoliasearch){return function places(appID,apiKey,opts){var cloneDeep=__webpack_require__(1);opts=opts&&cloneDeep(opts)||{},opts.hosts=opts.hosts||['places-dsn.algolia.net','places-1.algolianet.com','places-2.algolianet.com','places-3.algolianet.com'],(0===arguments.length||'object'==typeof appID||void 0===appID)&&(appID='',apiKey='',opts._allowEmptyCredentials=!0);var client=algoliasearch(appID,apiKey,opts),index=client.initIndex('places');return index.search=buildSearchMethod('query','/1/places/query'),index.getObject=function(objectID,callback){return this.as._jsonRequest({method:'GET',url:'/1/places/'+encodeURIComponent(objectID),hostType:'read',callback:callback})},index}};var buildSearchMethod=__webpack_require__(16)},function(module,exports,__webpack_require__){(function(global){function localStorageFailure(key,e){return debug('localStorage failed with',e),cleanup(),store=moduleStore,store.get(key)}function getOrSet(key,data){return 1===arguments.length?store.get(key):store.set(key,data)}function supportsLocalStorage(){try{return'localStorage'in global&&null!==global.localStorage&&(global.localStorage[localStorageNamespace]||global.localStorage.setItem(localStorageNamespace,JSON.stringify({})),!0)}catch(_){return!1}}function cleanup(){try{global.localStorage.removeItem(localStorageNamespace)}catch(_){}}var debug=__webpack_require__(8)('algoliasearch:src/hostIndexState.js'),localStorageNamespace='algoliasearch-client-js',moduleStore={state:{},set:function(key,data){return this.state[key]=data,this.state[key]},get:function(key){return this.state[key]||null}},store;store=supportsLocalStorage()?{set:function(key,data){moduleStore.set(key,data);try{var namespace=JSON.parse(global.localStorage[localStorageNamespace]);return namespace[key]=data,global.localStorage[localStorageNamespace]=JSON.stringify(namespace),namespace[key]}catch(e){return localStorageFailure(key,e)}},get:function(key){try{return JSON.parse(global.localStorage[localStorageNamespace])[key]||null}catch(e){return localStorageFailure(key,e)}}}:moduleStore,module.exports={get:getOrSet,set:getOrSet,supportsLocalStorage:supportsLocalStorage}}).call(exports,__webpack_require__(0))},function(module){'use strict';module.exports='3.29.0'},function(module){module.exports={vertexShader:`
    varying vec2 uvs;
    void main() {
      uvs.xy = uv.xy;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
  `,fragmentShader:`
    varying vec2 uvs;
    uniform sampler2D src;

    void main() {
      gl_FragColor = texture2D(src, uvs);
    }
`}},function(module){module.exports={vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 tunnelNeon;
    uniform vec3 leftLaser;
    uniform vec3 rightLaser;
    uniform vec3 floorNeon;
    uniform vec3 textGlow;
    uniform sampler2D src;

    void main() {
      float mask;
      vec4 col = texture2D(src, uvs);

      // tunnel neon
      mask = step(0.87, uvs.x) *  step(0.5, uvs.y) * (1.0 - step(0.935, uvs.x)) * ( 1.0 - step(0.75, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * tunnelNeon, mask);

      // floor & corridor neons
      mask = step(0.935, uvs.x) * step(0.5, uvs.y) * ( 1.0 - step(0.75, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * floorNeon, mask);

      // left laser
      mask = step(0.5, uvs.x) * (1.0 - step(0.625, uvs.x)) * (1.0 - step(0.5, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * leftLaser, mask);

      // right laser
      mask = step(0.625, uvs.x) * (1.0 - step(0.75, uvs.x)) * (1.0 - step(0.5, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * rightLaser, mask);

      // text glows
      mask = step(0.87, uvs.x) *  step(0.25, uvs.y) * (1.0 - step(0.935, uvs.x)) * ( 1.0 - step(0.5, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * textGlow, mask);

      gl_FragColor = col;
    }
  `}},function(module){module.exports={vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    #define FOG_RADIUS  55.0
    #define FOG_FALLOFF 48.0
    #define FOG_COLOR_MULT 0.8
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 skyColor;
    uniform vec3 backglowColor;
    uniform sampler2D src;

    void main() {
      vec4 col = texture2D(src, uvs);
      float mask;

      // bg
      mask = step(0.5, uvs.x);
      col.xyz = mix(col.xyz * skyColor, col.xyz, mask);

      // backglow
      mask = step(0.5, uvs.x) * step(0.5, uvs.y) * (1.0 - step(0.75, uvs.x));
      col.xyz = mix(col.xyz, col.xyz * backglowColor, mask);

      float fogDensity = 1.0 - pow(clamp(distance(worldPos, vec3(0., 0., -FOG_RADIUS)) / FOG_FALLOFF, 0.0, 1.0), 1.5);
      fogDensity += clamp(0.2 - pow(distance(worldPos, vec3(0.0, 0.0, worldPos.z)) / 10.0, 2.0), 0.0, 1.0);
      col.xyz = mix(col.xyz, backglowColor * FOG_COLOR_MULT, fogDensity);

      gl_FragColor = col;
    }
  `}},function(){AFRAME.registerComponent('active-color',{dependencies:['material'],schema:{active:{default:!1},color:{default:'#ffffff'}},init:function(){this.defaultColor=this.el.getAttribute('material').color,this.materialObj={color:this.data.color,opacity:1}},update:function(){var el=this.el;this.data.active?(el.setAttribute('material',this.materialObj),el.object3D.visible=!0):(el.setAttribute('material','color',this.defaultColor),el.components.animation__mouseleave&&setTimeout(()=>{el.emit('mouseleave',null,!1)}))}}),AFRAME.registerComponent('active-text-color',{dependencies:['text'],schema:{active:{default:!1},color:{default:'#333'}},init:function(){this.defaultColor=this.el.getAttribute('text').color},update:function(){var el=this.el;this.data.active?el.setAttribute('text','color',this.data.color):el.setAttribute('text','color',this.defaultColor)}})},function(){const NUM_VALUES_PER_BOX=90;AFRAME.registerComponent('audio-columns',{schema:{analyser:{type:'selector',default:'#audioAnalyser'},height:{default:1},mirror:{default:3},scale:{default:4},separation:{default:0.3},thickness:{default:0.1}},init:function(){var objData=document.getElementById('audiocolumnObj').data,loader=new THREE.OBJLoader,columnGeometry=loader.parse(objData).children[0].geometry;this.analyser=this.data.analyser.components.audioanalyser,this.frequencyBinCount=this.analyser.data.fftSize/2;const geometries=[];let zPosition=0;for(let i=0;i<this.frequencyBinCount;i++)for(let side=0;2>side;side++){const box=columnGeometry.clone();this.initBox(box,0===side?1:-1,zPosition),geometries.push(box),zPosition-=this.data.separation}this.geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);const mesh=new THREE.Mesh(this.geometry,this.el.sceneEl.systems.materials.stageNormal);this.el.setObject3D('mesh',mesh)},tick:function(){for(let i=0,yScale;i<2*this.frequencyBinCount;i+=2){if(yScale=this.data.height/2+this.analyser.levels[Math.floor(i/2)]/256*this.data.scale,isNaN(yScale))return;this.setBoxHeight(2*this.frequencyBinCount-i-1,yScale),this.setBoxHeight(2*this.frequencyBinCount-i-2,yScale),this.geometry.attributes.position.needsUpdate=!0}},initBox:function(box,flip,zPosition){const data=this.data;for(let v=0;v<box.attributes.position.array.length;v+=3)box.attributes.position.array[v+2]+=zPosition,box.attributes.position.array[v+1]*=data.height/2,box.attributes.position.array[v]+=flip*data.mirror},setBoxHeight:function(boxNumber,height){const boxIndex=boxNumber*NUM_VALUES_PER_BOX;for(let i=boxIndex,yValue;i<boxIndex+NUM_VALUES_PER_BOX;i+=3)yValue=this.geometry.attributes.position.array[i+1],this.geometry.attributes.position.array[i+1]=0<=yValue?height:-1*height}})},function(){const ANIME=AFRAME.ANIME||AFRAME.anime;AFRAME.registerComponent('beams',{schema:{isPlaying:{default:!1},poolSize:{default:3}},init:function(){this.beams=[],this.currentRed=0,this.currentBlue=0,this.clearBeams=this.clearBeams.bind(this),this.el.sceneEl.addEventListener('cleargame',this.clearBeams)},update:function(){for(let i=0;i<this.beams.length;i++)this.beams[i].time&&(this.beams[i].visible=this.data.isPlaying)},play:function(){var loader=new THREE.OBJLoader,objData,loader,redGeometry,blueGeometry;objData=document.getElementById('redbeamObj').data,redGeometry=loader.parse(objData).children[0].geometry,objData=document.getElementById('bluebeamObj').data,blueGeometry=loader.parse(objData).children[0].geometry,this.redBeams=this.createBeamPool(redGeometry,this.el.sceneEl.systems.materials.stageAdditive),this.blueBeams=this.createBeamPool(blueGeometry,this.el.sceneEl.systems.materials.stageAdditive)},tick:function(t,dt){if(this.data.isPlaying)for(let i=0,beam;i<this.beams.length;i++)(beam=this.beams[i],!!beam.visible)&&(beam.time+=dt,beam.animation.tick(beam.time))},createBeamPool:function(geometry,material){const beams=[];for(let i=0,beam;i<this.data.poolSize;i++)beam=new THREE.Mesh(geometry,material),beam.visible=!1,beam.animation=ANIME({autoplay:!1,targets:beam.scale,x:1e-5,duration:300,easing:'easeInCubic',complete:()=>{beam.visible=!1}}),this.el.object3D.add(beam),beams.push(beam),this.beams.push(beam);return beams},newBeam:function(color,position){var beam;'red'===color?(beam=this.redBeams[this.currentRed],this.currentRed=(this.currentRed+1)%this.redBeams.length,beam.position.set(position.x,position.y,position.z+this.currentRed/50)):(beam=this.blueBeams[this.currentBlue],this.currentBlue=(this.currentBlue+1)%this.blueBeams.length,beam.position.set(position.x,position.y,position.z+this.currentBlue/50)),beam.visible=!0,beam.scale.x=1,beam.time=0},clearBeams:function(){for(let i=0;i<this.beams.length;i++)this.beams[i].visible=!1,this.beams[i].time=0,this.beams[i].scale.x=1}})},function(){var audioContext=new window.AudioContext,sourceCreatedCallback;const LAYER_BOTTOM='bottom',LAYER_TOP='top',VOLUME=0.25;THREE.Audio.prototype.play=function(){if(!0===this.isPlaying)return void console.warn('THREE.Audio: Audio is already playing.');if(!1===this.hasPlaybackControl)return void console.warn('THREE.Audio: this Audio has no playback control.');var source=this.context.createBufferSource();return source.buffer=this.buffer,source.detune.value=this.detune,source.loop=this.loop,source.onended=this.onEnded.bind(this),source.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,sourceCreatedCallback&&sourceCreatedCallback(source),source.start(this.startTime,this.offset),this.isPlaying=!0,this.source=source,this.connect()},AFRAME.registerComponent('beat-hit-sound',{directionsToSounds:{up:'',down:'',upleft:'left',upright:'right',downleft:'left',downright:'right',left:'left',right:'right'},init:function(){this.currentBeatEl=null,this.currentCutDirection='',this.processSound=this.processSound.bind(this),sourceCreatedCallback=this.sourceCreatedCallback.bind(this);for(let i=1;10>=i;i++)this.el.setAttribute(`sound__beathit${i}`,{poolSize:4,src:`#hitSound${i}`,volume:VOLUME}),this.el.setAttribute(`sound__beathit${i}left`,{poolSize:4,src:`#hitSound${i}left`,volume:VOLUME}),this.el.setAttribute(`sound__beathit${i}right`,{poolSize:4,src:`#hitSound${i}right`,volume:VOLUME})},play:function(){for(let i=1;10>=i;i++)this.el.components[`sound__beathit${i}`].loaded||(this.el.setAttribute(`sound__beathit${i}`,'src',''),this.el.setAttribute(`sound__beathit${i}`,'src',`#hitSound${i}`)),this.el.components[`sound__beathit${i}left`].loaded||(this.el.setAttribute(`sound__beathit${i}left`,'src',''),this.el.setAttribute(`sound__beathit${i}left`,'src',`#hitSound${i}left`)),this.el.components[`sound__beathit${i}right`].loaded||(this.el.setAttribute(`sound__beathit${i}right`,'src',''),this.el.setAttribute(`sound__beathit${i}right`,'src',`#hitSound${i}right`))},playSound:function(beatEl,cutDirection){const rand=1+Math.floor(10*Math.random()),dir=this.directionsToSounds[cutDirection||'up'],soundPool=this.el.components[`sound__beathit${rand}${dir}`];this.currentBeatEl=beatEl,soundPool.playSound(this.processSound)},processSound:function(audio){audio.detune=0,this.currentBeatEl.object3D.getWorldPosition(audio.position)},sourceCreatedCallback:function(source){const layer=this.getLayer(this.currentBeatEl.object3D.position.y);layer===LAYER_BOTTOM?source.detune.setValueAtTime(-400,0):layer===LAYER_TOP&&source.detune.setValueAtTime(200,0),'down'===this.currentCutDirection&&source.detune.linearRampToValueAtTime(-400,1),'up'===this.currentCutDirection&&source.detune.linearRampToValueAtTime(400,1)},getLayer:function(y){return 1===y?LAYER_BOTTOM:1.7===y?LAYER_TOP:'middle'}})},function(module,__webpack_exports__,__webpack_require__){'use strict';function lessThan(a,b){return a._time-b._time}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__constants_beat__=__webpack_require__(10),__WEBPACK_IMPORTED_MODULE_1__utils__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_1__utils___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__utils__);let skipDebug=AFRAME.utils.getUrlParameter('skip')||0;skipDebug=parseInt(skipDebug,10),AFRAME.registerComponent('beat-loader',{dependencies:['stage-colors'],schema:{beatAnticipationTime:{default:1.1},beatSpeed:{default:8},beatWarmupTime:{default:__WEBPACK_IMPORTED_MODULE_0__constants_beat__.b/1e3},beatWarmupSpeed:{default:__WEBPACK_IMPORTED_MODULE_0__constants_beat__.a},challengeId:{type:'string'},difficulty:{type:'string'},isPlaying:{default:!1},menuSelectedChallengeId:{type:'string'}},orientationsHumanized:['up','down','left','right','upleft','upright','downleft','downright'],horizontalPositions:[-0.75,-0.25,0.25,0.75],horizontalPositionsHumanized:{0:'left',1:'middleleft',2:'middleright',3:'right'},positionHumanized:{topLeft:{layer:2,index:0},topCenterLeft:{layer:2,index:1},topCenterRight:{layer:2,index:2},topRight:{layer:2,index:3},middleLeft:{layer:1,index:0},middleCenterLeft:{layer:1,index:1},middleCenterRight:{layer:1,index:2},middleRight:{layer:1,index:3},bottomLeft:{layer:0,index:0},bottomCenterLeft:{layer:0,index:1},bottomCenterRight:{layer:0,index:2},bottomRight:{layer:0,index:3}},verticalPositionsHumanized:{0:'bottom',1:'middle',2:'top'},init:function(){this.audioAnalyserEl=document.getElementById('audioanalyser'),this.beatData=null,this.beatDataProcessed=!1,this.beatContainer=document.getElementById('beatContainer'),this.beatsTime=void 0,this.beatsPreloadTime=0,this.beatsPreloadTimeTotal=1e3*(this.data.beatAnticipationTime+this.data.beatWarmupTime),this.bpm=void 0,this.xhr=null,this.stageColors=this.el.components['stage-colors'],this.swordOffset=1.5,this.twister=document.getElementById('twister'),this.leftStageLasers=document.getElementById('leftStageLasers'),this.rightStageLasers=document.getElementById('rightStageLasers'),this.el.addEventListener('cleargame',this.clearBeats.bind(this))},update:function(oldData){const data=this.data;return!oldData.challengeId&&data.challengeId&&this.beatData?void this.processBeats():void(!data.menuSelectedChallengeId||!data.difficulty||(data.menuSelectedChallengeId!==oldData.menuSelectedChallengeId||data.difficulty!==oldData.difficulty)&&this.fetchBeats())},fetchBeats:function(){var el=this.el;this.xhr&&this.xhr.abort();let url=__WEBPACK_IMPORTED_MODULE_1__utils___default.a.getS3FileUrl(this.data.menuSelectedChallengeId,`${this.data.difficulty}.json`);const xhr=this.xhr=new XMLHttpRequest;el.emit('beatloaderstart'),console.log(`[beat-loader] Fetching ${url}...`),xhr.open('GET',url),xhr.addEventListener('load',()=>{this.beatData=JSON.parse(xhr.responseText),this.beatDataProcessed=!1,this.xhr=null,this.el.sceneEl.emit('beatloaderfinish',null,!1)}),xhr.send()},processBeats:function(){this.beatsTime=0,this.beatsPreloadTime=0,this.beatData._events.sort(lessThan),this.beatData._obstacles.sort(lessThan),this.beatData._notes.sort(lessThan),this.bpm=this.beatData._beatsPerMinute;const events=this.beatData._events;if(events.length&&0>events[0]._time)for(let i=0;0>events[i]._time;i++)this.generateEvent(events[i]);this.beatDataProcessed=!0,console.log('[beat-loader] Finished processing beat data.')},tick:function(time,delta){if(this.data.isPlaying&&this.data.challengeId&&this.beatData){const prevBeatsTime=this.beatsTime+skipDebug;if(void 0===this.beatsPreloadTime){const song=this.el.components.song;if(!song.isPlaying)return;this.beatsTime=1e3*(song.getCurrentTime()+this.data.beatAnticipationTime+this.data.beatWarmupTime)}else this.beatsTime=this.beatsPreloadTime;const beatsTime=this.beatsTime+skipDebug,bpm=this.beatData._beatsPerMinute,msPerBeat=1e3*60/this.beatData._beatsPerMinute,notes=this.beatData._notes;for(let i=0,noteTime;i<notes.length;++i)noteTime=notes[i]._time*msPerBeat,noteTime>prevBeatsTime&&noteTime<=beatsTime&&(notes[i].time=noteTime,this.generateBeat(notes[i]));const obstacles=this.beatData._obstacles;for(let i=0,noteTime;i<obstacles.length;++i)noteTime=obstacles[i]._time*msPerBeat,noteTime>prevBeatsTime&&noteTime<=beatsTime&&this.generateWall(obstacles[i]);const events=this.beatData._events;for(let i=0,noteTime;i<events.length;++i)noteTime=events[i]._time*msPerBeat,noteTime>prevBeatsTime&&noteTime<=beatsTime&&this.generateEvent(events[i]);void 0===this.beatsPreloadTime||(this.beatsPreloadTime>=this.beatsPreloadTimeTotal?(this.el.sceneEl.emit('beatloaderpreloadfinish',null,!1),this.beatsPreloadTime=void 0):this.beatsPreloadTime+=delta)}},generateBeat:function(){const beatObj={};return function(noteInfo){const data=this.data;let type=8===noteInfo._cutDirection?'dot':'arrow',color;0===noteInfo._type?color='red':1===noteInfo._type?color='blue':(type='mine',color=void 0);const beatEl=this.requestBeat(type,color);beatEl&&(beatObj.anticipationPosition=-data.beatAnticipationTime*data.beatSpeed-this.swordOffset,beatObj.color=color,beatObj.cutDirection=this.orientationsHumanized[noteInfo._cutDirection],beatObj.horizontalPosition=this.horizontalPositionsHumanized[noteInfo._lineIndex],beatObj.speed=this.data.beatSpeed,beatObj.type=type,beatObj.verticalPosition=this.verticalPositionsHumanized[noteInfo._lineLayer],beatObj.warmupPosition=-data.beatWarmupTime*data.beatWarmupSpeed,beatEl.setAttribute('beat',beatObj),beatEl.components.beat.updatePosition(),beatEl.play(),beatEl.components.beat.onGenerate())}}(),generateWall:function(){const wallObj={};return function(wallInfo){const el=this.el.sceneEl.components.pool__wall.requestEntity();if(el){const data=this.data,speed=this.data.beatSpeed,durationSeconds=60*(wallInfo._duration/this.bpm);wallObj.anticipationPosition=-data.beatAnticipationTime*data.beatSpeed-this.swordOffset,wallObj.durationSeconds=durationSeconds,wallObj.horizontalPosition=this.horizontalPositionsHumanized[wallInfo._lineIndex],wallObj.isCeiling=1===wallInfo._type,wallObj.speed=speed,wallObj.warmupPosition=-data.beatWarmupTime*data.beatWarmupSpeed,wallObj.width=wallInfo._width,el.setAttribute('wall',wallObj),el.play()}}}(),generateEvent:function(event){switch(event._type){case 0:this.stageColors.setColor('bg',event._value);break;case 1:this.stageColors.setColor('tunnel',event._value);break;case 2:this.stageColors.setColor('leftlaser',event._value);break;case 3:this.stageColors.setColor('rightlaser',event._value);break;case 4:this.stageColors.setColor('floor',event._value);break;case 8:this.twister.components.twister.pulse(event._value);break;case 9:this.twister.components.twister.pulse(event._value);break;case 12:this.leftStageLasers.components['stage-lasers'].pulse(event._value);break;case 13:this.rightStageLasers.components['stage-lasers'].pulse(event._value);}},requestBeat:function(type,color){var beatPoolName='pool__beat-'+type,pool;return color&&(beatPoolName+='-'+color),pool=this.el.sceneEl.components[beatPoolName],pool?pool.requestEntity():void console.warn('Pool '+beatPoolName+' unavailable')},clearBeats:function(){this.beatsPreloadTime=0,this.beatsTime=0;for(let i=0,child;i<this.beatContainer.children.length;i++)child=this.beatContainer.children[i],child.components.beat&&child.components.beat.returnToPool(!0),child.components.wall&&child.components.wall.returnToPool(!0)}})},function(module,__webpack_exports__,__webpack_require__){'use strict';function getGravityVelocity(velocity,timeDelta){return velocity+-9.8*(timeDelta/1e3)}var _MathPI2=Math.PI,_Mathmax4=Math.max;Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__constants_beat__=__webpack_require__(10);const COLORS=__webpack_require__(7),auxObj3D=new THREE.Object3D,BEAT_WARMUP_ROTATION_TIME=750,DESTROYED_SPEED=1,ONCE={once:!0},SCORE_POOL={OK:'pool__beatscoreok',GOOD:'pool__beatscoregood',GREAT:'pool__beatscoregreat',SUPER:'pool__beatscoresuper'};AFRAME.registerComponent('beat',{schema:{anticipationPosition:{default:0},color:{default:'red',oneOf:['red','blue']},cutDirection:{default:'down'},debug:{default:!1},horizontalPosition:{default:'middleleft',oneOf:['left','middleleft','middleright','right']},size:{default:0.4},speed:{default:8},type:{default:'arrow',oneOf:['arrow','dot','mine']},verticalPosition:{default:'middle',oneOf:['bottom','middle','top']},warmupPosition:{default:0}},materialColor:{blue:COLORS.BEAT_BLUE,red:COLORS.BEAT_RED},cutColor:{blue:'#fff',red:'#fff'},models:{arrow:'beatObjTemplate',dot:'beatObjTemplate',mine:'mineObjTemplate'},signModels:{arrowred:'arrowRedObjTemplate',arrowblue:'arrowBlueObjTemplate',dotred:'dotRedObjTemplate',dotblue:'dotBlueObjTemplate'},orientations:[180,0,270,90,225,135,315,45,0],rotations:{up:180,down:0,left:270,right:90,upleft:225,upright:135,downleft:315,downright:45},horizontalPositions:{left:-0.75,middleleft:-0.25,middleright:0.25,right:0.75},verticalPositions:{bottom:0.7,middle:1.2,top:1.7},init:function(){this.backToPool=!1,this.beams=document.getElementById('beams').components.beams,this.beatBoundingBox=new THREE.Box3,this.currentRotationWarmupTime=0,this.cutDirection=new THREE.Vector3,this.destroyed=!1,this.gravityVelocity=0,this.hitEventDetail={},this.hitBoundingBox=new THREE.Box3,this.poolName=void 0,this.returnToPoolTimer=800,this.rotationAxis=new THREE.Vector3,this.saberEls=this.el.sceneEl.querySelectorAll('[saber-controls]'),this.scoreEl=null,this.scoreElTime=void 0,this.startPositionZ=void 0,this.rightCutPlanePoints=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.leftCutPlanePoints=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.mineParticles=document.getElementById('mineParticles'),this.wrongElLeft=document.getElementById('wrongLeft'),this.wrongElRight=document.getElementById('wrongRight'),this.missElLeft=document.getElementById('missLeft'),this.missElRight=document.getElementById('missRight'),this.particles=document.getElementById('saberParticles'),this.mineParticles=document.getElementById('mineParticles'),this.superCuts=document.querySelectorAll('.superCutFx'),this.superCutIdx=0,this.explodeEventDetail={position:null,rotation:null},this.saberColors={right:'blue',left:'red'},this.onEndStroke=this.onEndStroke.bind(this),this.initBlock(),'mine'===this.data.type?this.initMineFragments():this.initFragments()},updatePosition:function(){const el=this.el,data=this.data;el.object3D.position.set(this.horizontalPositions[data.horizontalPosition],this.verticalPositions[data.verticalPosition],data.anticipationPosition+data.warmupPosition),el.object3D.rotation.z=THREE.Math.degToRad(this.rotations[data.cutDirection])},update:function(){this.updatePosition(),this.updateBlock(),this.updateFragments(),this.poolName='mine'===this.data.type?`pool__beat-mine`:`pool__beat-${this.data.type}-${this.data.color}`},pause:function(){this.el.object3D.visible=!1,'mine'!==this.data.type&&(this.partLeftEl.object3D.visible=!1,this.partRightEl.object3D.visible=!1)},play:function(){this.blockEl.object3D.visible=!0,this.destroyed=!1,this.el.object3D.visible=!0},tock:function(time,timeDelta){const el=this.el,data=this.data,position=el.object3D.position,rotation=el.object3D.rotation;if(this.destroyed)this.tockDestroyed(timeDelta);else{if(position.z>-1.65&&this.checkCollisions(),position.z<data.anticipationPosition){let newPositionZ=position.z+__WEBPACK_IMPORTED_MODULE_0__constants_beat__.a*(timeDelta/1e3);newPositionZ<data.anticipationPosition?position.z=newPositionZ:(position.z=data.anticipationPosition,this.beams.newBeam(this.data.color,position))}else position.z+=this.data.speed*(timeDelta/1e3),rotation.z=this.startRotationZ;if(position.z>data.anticipationPosition-0.4&&this.currentRotationWarmupTime<BEAT_WARMUP_ROTATION_TIME){const progress=AFRAME.ANIME.easings.easeOutBack(this.currentRotationWarmupTime/BEAT_WARMUP_ROTATION_TIME);el.object3D.rotation.z=this.rotationZStart+progress*this.rotationZChange,this.currentRotationWarmupTime+=timeDelta}this.backToPool=2<=position.z,this.backToPool&&this.missHit()}this.returnToPool()},onGenerate:function(){this.startRotationZ=this.el.object3D.rotation.z,this.currentRotationWarmupTime=0,this.rotationZChange=_MathPI2/5,0.5<Math.random&&(this.rotationZChange*=-1),this.el.object3D.rotation.z-=this.rotationZChange,this.rotationZStart=this.el.object3D.rotation.z,'mine'==this.data.type&&this.resetMineFragments()},initBlock:function(){var el=this.el,blockEl=this.blockEl=document.createElement('a-entity'),signEl=this.signEl=document.createElement('a-entity');blockEl.setAttribute('mixin','beatBlock'),blockEl.setAttribute('mixin','beatSign'),signEl.object3D.position.z+=0.02,blockEl.appendChild(signEl),el.appendChild(blockEl)},updateBlock:function(){const blockEl=this.blockEl,signEl=this.signEl;if(blockEl)if(blockEl.setAttribute('material',{metalness:0.7,roughness:0.1,sphericalEnvMap:'#envmapTexture',emissive:this.materialColor[this.data.color],emissiveIntensity:0.05,color:this.materialColor[this.data.color]}),this.setObjModelFromTemplate(blockEl,this.models[this.data.type]),blockEl.object3D.scale.set(1,1,1),blockEl.object3D.scale.multiplyScalar(3.45).multiplyScalar(this.data.size),'mine'===this.data.type){const model=blockEl.getObject3D('mesh');model?model.material=this.el.sceneEl.systems.materials['mineMaterial'+this.data.color]:blockEl.addEventListener('model-loaded',()=>{model.material=this.el.sceneEl.systems.materials['mineMaterial'+this.data.color]},ONCE)}else signEl.setAttribute('materials',{name:'stageAdditive'}),this.setObjModelFromTemplate(signEl,this.signModels[this.data.type+this.data.color])},initFragments:function(){var cutEl,partEl;partEl=this.partLeftEl=document.createElement('a-entity'),cutEl=this.cutLeftEl=document.createElement('a-entity'),partEl.appendChild(cutEl),this.el.appendChild(partEl),partEl=this.partRightEl=document.createElement('a-entity'),cutEl=this.cutRightEl=document.createElement('a-entity'),partEl.appendChild(cutEl),this.el.appendChild(partEl),this.initCuttingClippingPlanes()},initMineFragments:function(){var fragments=this.el.sceneEl.systems['mine-fragments-loader'].fragments.children,material=this.el.sceneEl.systems.materials['mineMaterial'+this.data.color],fragment;this.randVec=new THREE.Vector3(Math.random()*_MathPI2,Math.random()*_MathPI2,Math.random()*_MathPI2),this.mineFragments=[],this.mineBroken=document.createElement('a-entity'),this.el.appendChild(this.mineBroken);for(var i=0;i<fragments.length;i++)fragment=new THREE.Mesh(fragments[i].geometry,material),fragment.speed=new THREE.Vector3,fragment.speed.set(Math.random()-0.5,Math.random()-0.5,Math.random()-0.5),this.mineFragments.push(fragment),this.mineBroken.object3D.add(fragment)},updateFragments:function(){var cutLeftEl=this.cutLeftEl,cutRightEl=this.cutRightEl,partLeftEl=this.partLeftEl,partRightEl=this.partRightEl;return partLeftEl?'mine'===this.data.type?void this.resetMineFragments():void(partLeftEl.setAttribute('material',{metalness:0.7,roughness:0.1,sphericalEnvMap:'#envmapTexture',emissive:this.materialColor[this.data.color],emissiveIntensity:0.05,color:this.materialColor[this.data.color],side:'double'}),this.setObjModelFromTemplate(partLeftEl,this.models.dot),partLeftEl.object3D.visible=!1,cutLeftEl.setAttribute('material',{shader:'flat',color:this.data.cutColor,side:'double'}),this.setObjModelFromTemplate(cutLeftEl,this.models.dot),partRightEl.setAttribute('material',{metalness:0.7,roughness:0.1,sphericalEnvMap:'#envmapTexture',emissive:this.materialColor[this.data.color],emissiveIntensity:0.05,color:this.materialColor[this.data.color],side:'double'}),this.setObjModelFromTemplate(partRightEl,this.models.dot),partRightEl.object3D.visible=!1,cutRightEl.setAttribute('material',{shader:'flat',color:this.data.cutColor,side:'double'}),this.setObjModelFromTemplate(cutRightEl,this.models.dot)):void 0},resetMineFragments:function(){if('mine'===this.data.type)for(let i=0,fragment;i<this.mineFragments.length;i++)fragment=this.mineFragments[i],fragment.visible=!1,fragment.position.set(0,0,0),fragment.scale.set(1,1,1),fragment.speed.set(5*Math.random()-2.5,5*Math.random()-2.5,5*Math.random()-2.5)},wrongHit:function(hand){var wrongEl='left'===hand?this.wrongElLeft:this.wrongElRight;wrongEl&&(wrongEl.object3D.position.copy(this.el.object3D.position),wrongEl.object3D.position.y+=0.2,wrongEl.object3D.position.z-=0.5,wrongEl.object3D.visible=!0,wrongEl.emit('beatwrong',null,!0),this.destroyed=!0)},missHit:function(hand){var missEl='left'===hand?this.missElLeft:this.missElRight;missEl&&'mine'!==this.data.type&&(missEl.object3D.position.copy(this.el.object3D.position),missEl.object3D.position.y+=0.2,missEl.object3D.position.z-=0.5,missEl.object3D.visible=!0,missEl.emit('beatmiss',null,!0),AFRAME.utils.getUrlParameter('synctest')&&console.log(this.el.sceneEl.components.song.getCurrentTime()))},destroyBeat:function(){var parallelPlaneMaterial=new THREE.MeshBasicMaterial({color:'#00008b',side:THREE.DoubleSide}),planeMaterial=new THREE.MeshBasicMaterial({color:'grey',side:THREE.DoubleSide}),point1=new THREE.Vector3,point2=new THREE.Vector3,point3=new THREE.Vector3;return function(saberEl){var cutThickness=this.cutThickness=0.02,direction=this.cutDirection,leftBorderInnerPlane=this.leftBorderInnerPlane,leftBorderOuterPlane=this.leftBorderOuterPlane,leftCutPlane=this.leftCutPlane,rightBorderInnerPlane=this.rightBorderInnerPlane,rightBorderOuterPlane=this.rightBorderOuterPlane,rightCutPlane=this.rightCutPlane,trailPoints=saberEl.components.trail.saberTrajectory,coplanarPoint,planeGeometry,planeMesh;if(point1.copy(trailPoints[0].top),point2.copy(trailPoints[0].center),point3.copy(trailPoints[trailPoints.length-1].top),direction.copy(point1).sub(point3),this.partRightEl.object3D.position.set(0,0,0),this.partRightEl.object3D.rotation.set(0,0,0),this.partRightEl.object3D.updateMatrixWorld(),this.partRightEl.object3D.worldToLocal(this.rightCutPlanePoints[0].copy(point1)),this.partRightEl.object3D.worldToLocal(this.rightCutPlanePoints[1].copy(point2)),this.partRightEl.object3D.worldToLocal(this.rightCutPlanePoints[2].copy(point3)),this.partLeftEl.object3D.position.set(0,0,0),this.partLeftEl.object3D.rotation.set(0,0,0),this.partLeftEl.object3D.updateMatrixWorld(),this.partLeftEl.object3D.worldToLocal(this.leftCutPlanePoints[0].copy(point3)),this.partLeftEl.object3D.worldToLocal(this.leftCutPlanePoints[1].copy(point2)),this.partLeftEl.object3D.worldToLocal(this.leftCutPlanePoints[2].copy(point1)),this.generateCutClippingPlanes(),this.data.debug){coplanarPoint=new THREE.Vector3,planeGeometry=new THREE.PlaneGeometry(4,4,1,1),rightCutPlane.coplanarPoint(coplanarPoint),planeGeometry.lookAt(rightCutPlane.normal),planeGeometry.translate(coplanarPoint.x,coplanarPoint.y,coplanarPoint.z),planeMesh=new THREE.Mesh(planeGeometry,planeMaterial),this.el.sceneEl.setObject3D('rightCutPlane',planeMesh),planeGeometry=new THREE.PlaneGeometry(4,4,1,1),rightBorderOuterPlane.coplanarPoint(coplanarPoint),planeGeometry.lookAt(rightBorderOuterPlane.normal),planeGeometry.translate(coplanarPoint.x,coplanarPoint.y,coplanarPoint.z);const parallelPlaneMesh=new THREE.Mesh(planeGeometry,parallelPlaneMaterial);this.el.sceneEl.setObject3D('planeParallel',parallelPlaneMesh)}this.blockEl.object3D.visible=!1;const partRightMaterial=this.partRightEl.getObject3D('mesh').material;partRightMaterial.clippingPlanes=partRightMaterial.clippingPlanes||[],partRightMaterial.clippingPlanes.length=0,partRightMaterial.clippingPlanes.push(rightCutPlane);const cutRightMaterial=this.cutRightEl.getObject3D('mesh').material;cutRightMaterial.clippingPlanes=cutRightMaterial.clippingPlanes||[],cutRightMaterial.clippingPlanes.length=0,cutRightMaterial.clippingPlanes.push(rightBorderOuterPlane),cutRightMaterial.clippingPlanes.push(rightBorderInnerPlane);const partLeftMaterial=this.partLeftEl.getObject3D('mesh').material;partLeftMaterial.clippingPlanes=partLeftMaterial.clippingPlanes||[],partLeftMaterial.clippingPlanes.length=0,partLeftMaterial.clippingPlanes.push(leftCutPlane);const cutLeftMaterial=this.cutLeftEl.getObject3D('mesh').material;cutLeftMaterial.clippingPlanes=cutLeftMaterial.clippingPlanes||[],cutLeftMaterial.clippingPlanes.length=0,cutLeftMaterial.clippingPlanes.push(leftBorderInnerPlane),cutLeftMaterial.clippingPlanes.push(leftBorderOuterPlane),this.partLeftEl.object3D.visible=!0,this.partRightEl.object3D.visible=!0,this.el.sceneEl.renderer.localClippingEnabled=!0,this.destroyed=!0,this.gravityVelocity=0.1,this.rotationAxis.copy(this.rightCutPlanePoints[0]).sub(this.rightCutPlanePoints[1]),this.returnToPoolTimer=800,auxObj3D.up.copy(rightCutPlane.normal),auxObj3D.lookAt(direction),this.explodeEventDetail.position=this.el.object3D.position,this.explodeEventDetail.rotation=auxObj3D.rotation,this.particles.emit('explode',this.explodeEventDetail,!1)}}(),destroyMine:function(){for(let i=0;i<this.mineFragments.length;i++)this.mineFragments[i].visible=!0;this.blockEl.object3D.visible=!1,this.destroyed=!0,this.gravityVelocity=0.1,this.returnToPoolTimer=800,this.explodeEventDetail.position=this.el.object3D.position,this.explodeEventDetail.rotation=this.randVec,this.mineParticles.emit('explode',this.explodeEventDetail,!1)},initCuttingClippingPlanes:function(){this.leftCutPlanePointsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.rightCutPlanePointsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.rightCutPlane=new THREE.Plane,this.rightBorderOuterPlane=new THREE.Plane,this.rightBorderInnerPlane=new THREE.Plane,this.leftCutPlane=new THREE.Plane,this.leftBorderOuterPlane=new THREE.Plane,this.leftBorderInnerPlane=new THREE.Plane},generateCutClippingPlanes:function(){var leftBorderInnerPlane=this.leftBorderInnerPlane,leftBorderOuterPlane=this.leftBorderOuterPlane,leftCutPlane=this.leftCutPlane,leftCutPlanePointsWorld=this.leftCutPlanePointsWorld,partLeftEl=this.partLeftEl,partRightEl=this.partRightEl,rightBorderInnerPlane=this.rightBorderInnerPlane,rightBorderOuterPlane=this.rightBorderOuterPlane,rightCutPlane=this.rightCutPlane,rightCutPlanePointsWorld=this.rightCutPlanePointsWorld;partRightEl.object3D.updateMatrixWorld(),partRightEl.object3D.localToWorld(rightCutPlanePointsWorld[0].copy(this.rightCutPlanePoints[0])),partRightEl.object3D.localToWorld(rightCutPlanePointsWorld[1].copy(this.rightCutPlanePoints[1])),partRightEl.object3D.localToWorld(rightCutPlanePointsWorld[2].copy(this.rightCutPlanePoints[2])),partLeftEl.object3D.updateMatrixWorld(),partLeftEl.object3D.localToWorld(leftCutPlanePointsWorld[0].copy(this.leftCutPlanePoints[0])),partLeftEl.object3D.localToWorld(leftCutPlanePointsWorld[1].copy(this.leftCutPlanePoints[1])),partLeftEl.object3D.localToWorld(leftCutPlanePointsWorld[2].copy(this.leftCutPlanePoints[2])),rightCutPlane.setFromCoplanarPoints(rightCutPlanePointsWorld[0],rightCutPlanePointsWorld[1],rightCutPlanePointsWorld[2]),rightBorderOuterPlane.set(rightCutPlane.normal,rightCutPlane.constant+this.cutThickness),leftCutPlane.setFromCoplanarPoints(leftCutPlanePointsWorld[0],leftCutPlanePointsWorld[1],leftCutPlanePointsWorld[2]),leftBorderOuterPlane.set(leftCutPlane.normal,leftCutPlane.constant+this.cutThickness),rightBorderInnerPlane.setFromCoplanarPoints(rightCutPlanePointsWorld[2],rightCutPlanePointsWorld[1],rightCutPlanePointsWorld[0]),leftBorderInnerPlane.setFromCoplanarPoints(leftCutPlanePointsWorld[2],leftCutPlanePointsWorld[1],leftCutPlanePointsWorld[0])},returnToPool:function(force){(this.backToPool||force)&&this.el.sceneEl.components[this.poolName].returnEntity(this.el)},checkCollisions:function(){const cutDirection=this.data.cutDirection,saberColors=this.saberColors,saberEls=this.saberEls,hitBoundingBox=this.hitColliderEl&&this.hitBoundingBox.setFromObject(this.hitColliderEl.getObject3D('mesh')),beatBoundingBox=this.beatBoundingBox.setFromObject(this.blockEl.getObject3D('mesh'));var wrongHandHit;for(let i=0;i<saberEls.length;i++){let saberBoundingBox=saberEls[i].components['saber-controls'].boundingBox,saberControls,maxAngle;if(!saberBoundingBox)break;const hand=saberEls[i].getAttribute('saber-controls').hand;if(saberBoundingBox.intersectsBox(beatBoundingBox)){if(this.el.emit(`beatcollide${hand}`,null,!0),this.el.parentNode.components['beat-hit-sound'].playSound(this.el),'mine'===this.data.type){this.el.emit('minehit',null,!0),this.destroyMine();break}if(this.destroyBeat(saberEls[i]),saberEls[i].components['saber-controls'].swinging&&this.data.color===saberColors[hand]){if(this.hitSaberEl=saberEls[i],this.hitSaberEl.addEventListener('strokeend',this.onEndStroke,ONCE),saberControls=saberEls[i].components['saber-controls'],this.hitHand=hand,saberControls.maxAnglePlaneX=0,saberControls.maxAnglePlaneY=0,saberControls.maxAnglePlaneXY=0,'arrow'===this.data.type){if(saberControls.updateStrokeDirection(),!saberControls.strokeDirection[this.data.cutDirection]){this.wrongHit(hand);break}maxAngle='up'===cutDirection||'down'===cutDirection?saberControls.maxAnglePlaneX:'left'===cutDirection||'right'===cutDirection?saberControls.maxAnglePlaneY:saberControls.maxAnglePlaneXY}else maxAngle=_Mathmax4(saberControls.maxAnglePlaneX,saberControls.maxAnglePlaneY,saberControls.maxAnglePlaneXY);wrongHandHit=void 0,this.angleBeforeHit=maxAngle}else wrongHandHit=hand;break}wrongHandHit&&this.wrongHit(wrongHandHit)}},onEndStroke:function(){var cutDirection=this.data.cutDirection,hitEventDetail=this.hitEventDetail,saberControls=this.hitSaberEl.components['saber-controls'],maxAngle;const saberRotation=3.14/12;maxAngle='up'===cutDirection||'down'===cutDirection?saberControls.maxAnglePlaneX:'left'===cutDirection||'right'===cutDirection?saberControls.maxAnglePlaneY:saberControls.maxAnglePlaneXY;const angleBeforeHit=_Mathmax4(0,180*(this.angleBeforeHit-saberRotation)/_MathPI2),angleAfterHit=_Mathmax4(0,180*(maxAngle-saberRotation)/_MathPI2);let score=0;score+=85<=angleBeforeHit?70:70*(angleBeforeHit/80),score+=60<=angleAfterHit?30:30*(angleAfterHit/60),hitEventDetail.score=score,this.el.emit('beathit',hitEventDetail,!0),this.el.sceneEl.emit('textglowbold',null,!1);let beatScorePool;60>score?beatScorePool=SCORE_POOL.OK:80>score?beatScorePool=SCORE_POOL.GOOD:100>score?beatScorePool=SCORE_POOL.GREAT:(beatScorePool=SCORE_POOL.SUPER,this.superCuts[this.superCutIdx].components.supercutfx.createSuperCut(this.el.object3D.position),this.superCutIdx=(this.superCutIdx+1)%this.superCuts.length);const scoreEl=this.el.sceneEl.components[beatScorePool].requestEntity();scoreEl&&(scoreEl.object3D.position.copy(this.el.object3D.position),scoreEl.play(),scoreEl.emit('beatscorestart',null,!1))},tockDestroyed:function(){var leftCutNormal=new THREE.Vector3,leftRotation=0,rightCutNormal=new THREE.Vector3,rightRotation=0,rotationStep=2*_MathPI2/150,fragment;return function(timeDelta){if(this.gravityVelocity=getGravityVelocity(this.gravityVelocity,timeDelta),this.el.object3D.position.y+=this.gravityVelocity*(timeDelta/1e3),'mine'==this.data.type){for(var i=0;i<this.mineFragments.length;i++)(fragment=this.mineFragments[i],!!fragment.visible)&&(fragment.position.addScaledVector(fragment.speed,timeDelta/1e3),fragment.scale.multiplyScalar(0.97),0.1>fragment.scale.y&&(fragment.visible=!1));return}rightCutNormal.copy(this.rightCutPlane.normal).multiplyScalar(DESTROYED_SPEED*(timeDelta/500)),rightCutNormal.y=0,this.partRightEl.object3D.position.add(rightCutNormal),this.partRightEl.object3D.setRotationFromAxisAngle(this.rotationAxis,rightRotation),rightRotation=rightRotation>=2*_MathPI2?0:rightRotation+rotationStep,leftCutNormal.copy(this.leftCutPlane.normal).multiplyScalar(DESTROYED_SPEED*(timeDelta/500)),leftCutNormal.y=0,this.partLeftEl.object3D.position.add(leftCutNormal),this.partLeftEl.object3D.setRotationFromAxisAngle(this.rotationAxis,leftRotation),leftRotation=leftRotation>=2*_MathPI2?0:leftRotation+rotationStep,this.generateCutClippingPlanes(),this.returnToPoolTimer-=timeDelta,this.backToPool=0>=this.returnToPoolTimer}}(),setObjModelFromTemplate:function(){const geometries={};return function(el,templateId){if(!geometries[templateId]){const templateEl=document.getElementById(templateId);if(templateEl.getObject3D('mesh'))geometries[templateId]=templateEl.getObject3D('mesh').children[0].geometry;else return void templateEl.addEventListener('model-loaded',()=>{geometries[templateId]=templateEl.getObject3D('mesh').children[0].geometry,this.setObjModelFromTemplate(el,templateId)})}el.getObject3D('mesh')||el.setObject3D('mesh',new THREE.Mesh),el.getObject3D('mesh').geometry=geometries[templateId]}}()})},function(){AFRAME.registerComponent('console-shortcuts',{play:function(){window.$=val=>document.querySelector(val),window.$$=val=>document.querySelectorAll(val),window.$$$=val=>document.querySelector(`[${val}]`).getAttribute(val),window.$$$$=val=>document.querySelector(`[${val}]`).components[val],window.scene=this.el,window.state=this.el.systems.state.state}})},function(){AFRAME.registerComponent('copy-texture',{dependencies:['geometry','material'],schema:{from:{type:'selector'}},init:function(){const data=this.data;data.from.addEventListener('materialtextureloaded',()=>{this.copyTexture()}),this.copyTexture()},copyTexture:function(){const el=this.el,target=this.data.from,material=el.getObject3D('mesh').material;target.getObject3D('mesh')&&(material.map=target.getObject3D('mesh').material.map,material.map&&(material.map.needsUpdate=!0,material.needsUpdate=!0))}})},function(){AFRAME.registerComponent('cursor-laser',{dependencies:['geometry'],schema:{enabled:{default:!0}},init:function(){const el=this.el;this.saberEl=this.el.closest('.saber');const geometry=this.el.getAttribute('geometry');el.object3D.position.z=-1*geometry.height/2,this.originalSize=geometry.height,this.currentLength=geometry.height},update:function(){this.el.object3D.visible=this.data.enabled},tick:function(){const el=this.el;if(this.data.enabled){const cursor=this.saberEl.components.cursor;if(cursor){const intersectedEl=cursor.intersectedEl;if(!intersectedEl)return el.object3D.position.z=-25,el.object3D.scale.x=0.75,el.getObject3D('mesh').scale.y=50,void(this.currentLength=1);const intersection=this.saberEl.components.raycaster.intersections[0];intersection&&(el.object3D.scale.x=1,el.object3D.position.z=-intersection.distance/2,el.getObject3D('mesh').scale.y=this.currentLength=intersection.distance)}}}})},function(){AFRAME.registerComponent('cursor-mesh',{schema:{active:{default:!0},cursorEl:{type:'selector'}},init:function(){this.scenePivotEl=document.getElementById('scenePivot')},update:function(){this.el.object3D.visible=this.data.active},tick:function(){var cursorEl=this.data.cursorEl,el=this.el,scenePivotEl=this.scenePivotEl,cursor,intersection,intersectedEl;if(this.data.active&&(cursor=cursorEl.components.cursor,!!cursor)){if(intersectedEl=cursorEl.components.cursor.intersectedEl,intersectedEl)el.object3D.visible=!0;else return void(el.object3D.visible=!1);intersection=cursorEl.components.raycaster.getIntersection(intersectedEl),intersection&&(el.object3D.position.copy(intersection.point),scenePivotEl&&el.object3D.rotation.copy(scenePivotEl.object3D.rotation))}}})},function(){AFRAME.registerComponent('debug-beat-loader',{dependencies:['beat-loader'],schema:{beatEnabled:{default:!1},stageEnabled:{default:!1}},init:function(){this.beatLoader=this.el.components['beat-loader'],this.selectedBeat={color:'red',position:'middleCenterLeft',type:'arrow',orientation:'up'},this.beats={},this.onKeyDown=this.onKeyDown.bind(this),(this.data.stageEnabled||AFRAME.utils.getUrlParameter('debugstage'))&&this.addDebugStageControls(),(this.data.beatEnabled||'gameplay'===AFRAME.utils.getUrlParameter('debugstate').trim())&&(window.addEventListener('keydown',this.onKeyDown),this.addDebugBeatControls())},spawn:function(){var self=this;Object.keys(this.beats).forEach(function(key){self.generateBeat(self.beats[key])})},generateBeat:function(beatInfo){var type;return'wall'===beatInfo.type?void this.generateWall(beatInfo):void(type='mine'===beatInfo.type?3:'red'===beatInfo.color?0:1,this.beatLoader.generateBeat({_lineIndex:this.beatLoader.positionHumanized[beatInfo.position].index,_lineLayer:this.beatLoader.positionHumanized[beatInfo.position].layer,_cutDirection:'dot'===beatInfo.type?8:this.beatLoader.orientationsHumanized.indexOf(beatInfo.orientation),_type:type}))},generateWall:function(wallInfo){this.beatLoader.bpm=90,this.beatLoader.generateWall({_lineIndex:this.beatLoader.positionHumanized[wallInfo.position].index,_width:1,_duration:3})},onKeyDown:function(event){const keyCode=event.keyCode;switch(keyCode){case 32:{this.spawn();break}}},addDebugBeatControls:function(){function addMenu(name){const menuDiv=document.createElement('div');return menuDiv.id=name,menuDiv.style.marginBottom='20px',menuDiv.style.width='500px',menuDiv.style.display='inline-block',parentDiv.appendChild(menuDiv),menuDiv}function addButton(text,containerEl,clickHandler){const div=document.createElement('div');return div.classList.add('button'),div.id=text,div.style.width='100px',div.style.height='30px',div.style.background='#000',div.style.color='#fff',div.style.zIndex=999999999,div.style.padding='5px',div.style.margin='5px',div.style.font='14px sans-serif',div.style.textAlign='center',div.style.lineHeight='30px',div.style.cursor='pointer',div.style.display='inline-block',div.innerHTML=text,containerEl.appendChild(div),div.addEventListener('click',clickHandler||function onClick(){const buttons=div.parentElement.querySelectorAll('.button');for(let i=0;i<buttons.length;i++)buttons[i].style.background='#000';div.style.background='#66f',self.selectedBeat[div.parentElement.id]=this.id,self['selected'+div.parentElement.id.charAt(0).toUpperCase()+div.parentElement.id.slice(1)+'El']=this}),div}const parentDiv=document.createElement('div'),self=this;parentDiv.style.position='absolute',parentDiv.style.right='0',parentDiv.style.top='0',parentDiv.style.padding='10px',parentDiv.style.width='500px',parentDiv.style.height='600px',document.body.appendChild(parentDiv),function addTypeBeatMenu(){const menuDiv=addMenu('type');addButton('arrow',menuDiv),addButton('dot',menuDiv),addButton('mine',menuDiv),addButton('wall',menuDiv),parentDiv.appendChild(menuDiv)}(),function addColorBeatMenu(){const menuDiv=addMenu('color');addButton('blue',menuDiv),addButton('red',menuDiv),parentDiv.appendChild(menuDiv)}(),function addOrientationMenu(){const menuDiv=addMenu('orientation');addButton('top',menuDiv),addButton('left',menuDiv),addButton('right',menuDiv),addButton('down',menuDiv),parentDiv.appendChild(menuDiv)}(),function setBeatButton(){var buttonEl=addButton('Set Beat',parentDiv,function(){var color='mine'===self.selectedBeat.type?'':' '+self.selectedBeat.color,orientation='arrow'===self.selectedBeat.type?' '+self.selectedBeat.orientation:'';self.selectedBeat={position:self.selectedBeat.position,type:self.selectedBeat.type,orientation:self.selectedBeat.orientation,color:self.selectedBeat.color};self.selectedPositionEl&&(self.selectedPositionEl.innerHTML=self.selectedBeat.type+color+orientation,self.beats[self.selectedPositionEl.id]={position:self.selectedBeat.position,type:self.selectedBeat.type,orientation:self.selectedBeat.orientation,color:self.selectedBeat.color})});buttonEl.style.width='460px',buttonEl.style.bottomMargin='10px'}(),function addBeatPositionMenu(){const menuDiv=addMenu('position');addButton('topLeft',menuDiv),addButton('topCenterLeft',menuDiv),addButton('topCenterRight',menuDiv),addButton('topRight',menuDiv),addButton('middleLeft',menuDiv),addButton('middleCenterLeft',menuDiv),addButton('middleCenterRight',menuDiv),addButton('middleRight',menuDiv),addButton('bottomLeft',menuDiv),addButton('bottomCenterLeft',menuDiv),addButton('bottomCenterRight',menuDiv),addButton('bottomRight',menuDiv)}(),function addGenerateButton(){const buttonEl=addButton('Spawn (Space Bar)',parentDiv,()=>{self.spawn()});buttonEl.style.width='460px',buttonEl.style.bottomMargin='10px'}()},addDebugStageControls:function(){var currControl=0;const addControl=(i,name,type)=>{const div=document.createElement('div');div.style.position='absolute',div.id='stagecontrol'+i,div.style.width='100px',div.style.height='30px',div.style.top='element'===type?'20px':'70px',div.style.background='#000',div.style.color='#fff',div.style.zIndex=999999999,div.style.padding='5px',div.style.font='14px sans-serif',div.style.textAlign='center',div.style.cursor='pointer',div.style.left=20+120*i+'px',div.innerHTML=name,'element'===type?div.addEventListener('click',()=>{document.getElementById('stagecontrol'+currControl).style.background='#000',div.style.background='#66f',currControl=i}):div.addEventListener('click',()=>{this.beatLoader.generateEvent({_type:currControl,_value:i})}),document.body.appendChild(div)};['sky','tunnelNeon','leftStageLasers','rightStageLasers','floor'].forEach((id,i)=>{addControl(i,id,'element')}),['off','blue','blue','bluefade','','red','red','redfade'].forEach((id,i)=>{addControl(i,id,'value')})}})},function(){AFRAME.registerComponent('debug-controller',{init:function(){var primaryHand,secondaryHand;AFRAME.utils.getUrlParameter('debug')&&(console.log('%c debug-controller enabled ','background: #111; color: red'),this.isCloning=!1,this.isDeleting=!1,this.isTriggerDown=!1,window.addEventListener('mousemove',this.onMouseMove.bind(this)),primaryHand=document.getElementById('rightHand'),secondaryHand=document.getElementById('leftHand'),window.addEventListener('click',evt=>{evt.isTrusted&&(primaryHand.emit('triggerdown'),primaryHand.emit('triggerup'))}),'oculus'===AFRAME.utils.getUrlParameter('debug')?(primaryHand.emit('controllerconnected',{name:'oculus-touch-controls'}),secondaryHand.emit('controllerconnected',{name:'oculus-touch-controls'}),primaryHand.setAttribute('controller','controllerType','oculus-touch-controls'),secondaryHand.setAttribute('controller','controllerType','oculus-touch-controls')):(primaryHand.emit('controllerconnected',{name:'vive-controls'}),secondaryHand.emit('controllerconnected',{name:'vive-controls'}),primaryHand.setAttribute('controller','controllerType','vive-controls'),secondaryHand.setAttribute('controller','controllerType','vive-controls')),this.el.emit('enter-vr',null,!1),document.addEventListener('keydown',evt=>{var primaryPosition,primaryRotation,secondaryPosition,secondaryRotation;return evt.shiftKey?32===evt.keyCode?void(this.isTriggerDown?(primaryHand.emit('triggerup'),this.isTriggerDown=!1):(primaryHand.emit('triggerdown'),this.isTriggerDown=!0)):81===evt.keyCode?void(this.isSecondaryTriggerDown?(secondaryHand.emit('triggerup'),this.isSecondaryTriggerDown=!1):(secondaryHand.emit('triggerdown'),this.isSecondaryTriggerDown=!0)):void(78===evt.keyCode&&(this.secondaryGripDown?(secondaryHand.emit('gripup'),this.secondaryGripDown=!1):(secondaryHand.emit('gripdown'),this.secondaryGripDown=!0)),77===evt.keyCode&&(this.primaryGripDown?(primaryHand.emit('gripup'),this.primaryGripDown=!1):(primaryHand.emit('gripdown'),this.primaryGripDown=!0)),49===evt.keyCode&&secondaryHand.emit('menudown'),evt.ctrlKey?(secondaryPosition=secondaryHand.getAttribute('position'),72===evt.keyCode&&(secondaryPosition.x-=0.01),74===evt.keyCode&&(secondaryPosition.y-=0.01),75===evt.keyCode&&(secondaryPosition.y+=0.01),76===evt.keyCode&&(secondaryPosition.x+=0.01),(59===evt.keyCode||186===evt.keyCode)&&(secondaryPosition.z-=0.01),222===evt.keyCode&&(secondaryPosition.z+=0.01),secondaryHand.setAttribute('position',AFRAME.utils.clone(secondaryPosition))):(primaryPosition=primaryHand.getAttribute('position'),72===evt.keyCode&&(primaryPosition.x-=0.01),74===evt.keyCode&&(primaryPosition.y-=0.01),75===evt.keyCode&&(primaryPosition.y+=0.01),76===evt.keyCode&&(primaryPosition.x+=0.01),(59===evt.keyCode||186===evt.keyCode)&&(primaryPosition.z-=0.01),222===evt.keyCode&&(primaryPosition.z+=0.01),primaryHand.setAttribute('position',AFRAME.utils.clone(primaryPosition))),evt.ctrlKey?(secondaryRotation=secondaryHand.getAttribute('rotation'),89===evt.keyCode&&(secondaryRotation.x-=10),79===evt.keyCode&&(secondaryRotation.x+=10),85===evt.keyCode&&(secondaryRotation.y-=10),73===evt.keyCode&&(secondaryRotation.y+=10),secondaryHand.setAttribute('rotation',AFRAME.utils.clone(secondaryRotation))):(primaryRotation=primaryHand.getAttribute('rotation'),89===evt.keyCode&&(primaryRotation.x-=10),79===evt.keyCode&&(primaryRotation.x+=10),85===evt.keyCode&&(primaryRotation.y-=10),73===evt.keyCode&&(primaryRotation.y+=10),primaryHand.setAttribute('rotation',AFRAME.utils.clone(primaryRotation)))):void 0}))},play:function(){var primaryHand,secondaryHand;this.bounds=document.body.getBoundingClientRect();AFRAME.utils.getUrlParameter('debug')&&(primaryHand=document.getElementById('rightHand'),secondaryHand=document.getElementById('leftHand'),secondaryHand.object3D.position.set(-0.2,1.5,-0.5),primaryHand.object3D.position.set(0.2,1.5,-0.5),secondaryHand.setAttribute('rotation',{x:35,y:0,z:0}))},onMouseMove:function(){const direction=new THREE.Vector3,mouse=new THREE.Vector2,cameraPos=new THREE.Vector3;return function(evt){const bounds=this.bounds,camera=this.el.sceneEl.camera,left=evt.clientX-bounds.left,top=evt.clientY-bounds.top;mouse.x=2*(left/bounds.width)-1,mouse.y=2*(-top/bounds.height)-1,document.getElementById('camera').object3D.getWorldPosition(cameraPos),direction.set(mouse.x,mouse.y,0.5).unproject(camera).sub(cameraPos).normalize();const handPos=document.getElementById('rightHand').object3D.position,distance=-cameraPos.z/direction.z;camera.getWorldPosition(handPos).add(direction.multiplyScalar(distance)),handPos.y+=0.8}}()})},function(){AFRAME.registerComponent('debug-cursor',{init:function(){},log:function(event,intersectedEl,color){intersectedEl.id?console.log(`%c[${event}] ${intersectedEl.id}`,`color: ${color}`):(console.log(`%c[${event}]`,`color: ${color}`),console.log(intersectedEl))}})},function(){AFRAME.registerComponent('debug-song-time',{dependencies:['song'],init:function(){AFRAME.utils.getUrlParameter('debug-song-time')&&setInterval(()=>{console.log(this.el.components.song.getCurrentTime())},250)}})},function(){AFRAME.registerComponent('debug-state',{play:function(){const flags=AFRAME.utils.getUrlParameter('debugstate').trim();flags&&setTimeout(()=>{flags.split(',').forEach(flag=>{this.el.sceneEl.emit(`debug${flag.trim()}`,null,!1)})},500)}})},function(module,__webpack_exports__,__webpack_require__){'use strict';function createGeometry(color){colorHelper.set(color);const geometries=[{height:0.1831,radius:0.0055},{height:0.1832,radius:0.0065},{height:0.1833,radius:0.0075},{height:0.1834,radius:0.0085}].map((cylinderData,i)=>{const cylinder=new THREE.CylinderBufferGeometry(cylinderData.radius,cylinderData.radius,cylinderData.height),colorArray=[];for(let i=0;i<cylinder.attributes.position.array.length;i+=3)colorArray[i]=colorHelper.r,colorArray[i+1]=colorHelper.g,colorArray[i+2]=colorHelper.b;cylinder.addAttribute('color',new THREE.Float32BufferAttribute(colorArray,3));const alphaUvs=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component__.getGridUvs)(0,i,1,4),uvs=cylinder.attributes.uv.array;for(let i=0;i<uvs.length;i+=6)uvs[i]=alphaUvs[0].x,uvs[i+1]=alphaUvs[0].y,uvs[i+2]=alphaUvs[1].x,uvs[i+3]=alphaUvs[1].y,uvs[i+4]=alphaUvs[2].x,uvs[i+5]=alphaUvs[2].y;return cylinder.attributes.uv.needsUpdate=!0,cylinder}),geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);return geometry}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component__=__webpack_require__(11),__WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component__);__webpack_require__(12);const colorHelper=new THREE.Color,geometry=createGeometry(),material=new THREE.MeshBasicMaterial({alphaMap:function createAlphaMap(){const alphaCanvas=document.createElement('canvas');alphaCanvas.height=1,alphaCanvas.width=4;const ctx=alphaCanvas.getContext('2d');return ctx.fillStyle='rgb(10, 10, 10)',ctx.fillRect(0,0,1,1),ctx.fillStyle='rgb(15, 15, 15)',ctx.fillRect(1,0,1,1),ctx.fillStyle='rgb(23, 23 ,23)',ctx.fillRect(2,0,1,1),ctx.fillStyle='rgb(28, 28, 28)',ctx.fillRect(3,0,1,1),setTimeout(()=>{alphaCanvas.style.position='fixed',alphaCanvas.style.zIndex=999999999999,alphaCanvas.style.left=0,alphaCanvas.style.top=0,document.body.appendChild(alphaCanvas)},1e3),new THREE.CanvasTexture(alphaCanvas)}(),transparent:!0,vertexColors:THREE.VertexColors});AFRAME.registerComponent('fake-glow',{schema:{color:{default:'#FFF'}},play:function(){this.el.setObject3D('mesh',new THREE.Mesh(createGeometry(this.data.color),material))}})},function(module,exports,__webpack_require__){const COLORS=__webpack_require__(7),HIT_COLOR=new THREE.Color(COLORS.NEON_RED),BORDER_COLOR=new THREE.Color(COLORS.NEON_BLUE);AFRAME.registerShader('floorShader',{schema:{normalMap:{type:'map',is:'uniform'},envMap:{type:'map',is:'uniform'},hitRight:{type:'vec3',is:'uniform',default:{x:0,y:1,z:0}},hitLeft:{type:'vec3',is:'uniform',default:{x:0,y:0,z:0}}},vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 color;
    uniform sampler2D normalMap;
    uniform sampler2D envMap;
    uniform vec3 hitRight;
    uniform vec3 hitLeft;

    #define HIT_COLOR vec3(${HIT_COLOR.r}, ${HIT_COLOR.g}, ${HIT_COLOR.b})
    #define BORDER_COLOR vec3(${BORDER_COLOR.r}, ${BORDER_COLOR.g}, ${BORDER_COLOR.b})

    vec3 drawCircle(vec3 p, vec3 center, float radius, float edgeWidth, vec3 color) {
      return color*(1.0-smoothstep(radius, radius+edgeWidth, length(p-center)));
    }

    void main() {
      vec2 p = uvs.xy - 0.5;
      vec3 border = vec3(smoothstep(0.49, 0.495, abs(p.x)) + smoothstep(0.49, 0.495, abs(p.y)));
      border += BORDER_COLOR * (smoothstep(0.475, 0.495, abs(p.x)) + smoothstep(0.475, 0.495, abs(p.y))) * .7;
      p*= 4.0;

      vec3 hitColor = HIT_COLOR;
      vec3 hit = vec3(0.0);

      hit += drawCircle(worldPos, hitRight, 0.04, 0.05, hitColor);
      hit += drawCircle(worldPos, hitRight, 0.02, 0.03, vec3(0.7, 0.7, 0.7));
      hit += drawCircle(worldPos, hitLeft, 0.04, 0.05, hitColor);
      hit += drawCircle(worldPos, hitLeft, 0.02, 0.03, vec3(0.7, 0.7, 0.7));

      vec3 normal = normalize(texture2D(normalMap, uvs).xyz);

      // environment reflection
      vec3 reflectVec = normalize(reflect(normalize(worldPos - cameraPosition), normal));
      //vec3 reflectView = normalize((viewMatrix * vec4(reflectVec, 0.0)).xyz + vec3(0.0, 0.0, 1.0));

      vec3 ref = texture2D(envMap, reflectVec.xy * vec2(0.3, 1.0) + vec2(0.75, -cameraPosition.z * 0.05)).xyz * 0.14;

      gl_FragColor = vec4(ref + border + hit, 1.0);
    }
  `})},function(){AFRAME.registerComponent('gameover',{schema:{isGameOver:{default:!1}},init:function(){this.beatContainer=document.getElementById('beatContainer'),this.gameOverEls=document.querySelectorAll('[animation__gameover]')},update:function(oldData){this.data;!oldData.isGameOver&&this.data.isGameOver&&(this.triggerAnimations(),this.countDown=1),oldData.isGameOver&&!this.data.isGameOver&&this.reset()},tick:function(time,delta){!this.data.isGameOver||0<=this.countDown&&(this.beatContainer.object3D.position.z=1.5*-Math.pow(1-this.countDown,2),this.countDown-=delta/1e3)},reset:function(){this.beatContainer.object3D.position.z=0,this.el.sceneEl.setAttribute('stage-colors','color','blue')},triggerAnimations:function(){for(let i=0;i<this.gameOverEls.length;i++)this.gameOverEls[i].emit('gameover',null,!1);this.el.emit('textglowoff',null,!1),this.el.emit('bgcolorgameover',null,!1)}})},function(){let i=0;AFRAME.registerComponent('gpu-preloader',{dependencies:['materials'],play:function(){this.preloadMineEnvMaps(),setTimeout(()=>{this.preloadAtlas(),this.preloadLogo(),this.preloadCutParticles(),this.preloadKeyboard(),this.preloadPlayButton(),this.preloadSearchPrevPage(),this.preloadGenres()},1e3)},preloadAtlas:function(){const stage=document.querySelector('#stageObj');this.preloadTexture(stage.getObject3D('mesh').children[0].material.uniforms.src.value)},preloadLogo:function(){const logo=document.querySelector('#logoBody');this.preloadTexture(logo.getObject3D('mesh').children[0].material.uniforms.src.value)},preloadBeamMap:function(){const beams=document.querySelector('[beams]');this.preloadTexture(beams.components.beams.texture)},preloadBeatEnvMap:function(){const beat=document.querySelector('#beatContainer [mixin~="beat"]');beat.object3D.traverse(node=>{node.material&&(node.material.envMap&&this.preloadTexture(node.material.envMap),node.material.map&&this.preloadTexture(node.material.map))})},preloadCutParticles:function(){const particles=document.querySelector('#saberParticles');this.preloadTexture(particles.components.particleplayer.material.map)},preloadKeyboard:function(){const keyboard=document.getElementById('keyboard').components['super-keyboard'];this.preloadTexture(keyboard.kbImg.getObject3D('mesh').material.map),this.preloadTexture(keyboard.keyColorPlane.getObject3D('mesh').material.map)},preloadMineEnvMaps:function(){const stageColors=this.el.sceneEl.components['stage-colors'];this.el.sceneEl.addEventListener('mineredenvmaploaded',()=>{this.preloadTexture(stageColors.mineEnvMap.red)}),this.el.sceneEl.addEventListener('mineblueenvmaploaded',()=>{this.preloadTexture(stageColors.mineEnvMap.blue)})},preloadMissMap:function(){const miss=document.querySelector('#missLeft');this.preloadTexture(miss.getObject3D('mesh').material.map)},preloadPlayButton:function(){const playButton=document.querySelector('#playButton');this.preloadTexture(playButton.getObject3D('mesh').material.map)},preloadSearchPrevPage:function(){const prevPage=document.querySelector('#searchPrevPage');this.preloadTexture(prevPage.children[0].getObject3D('mesh').material.map)},preloadWallMap:function(){const wall=document.querySelector('a-entity[wall]');this.preloadTexture(wall.getObject3D('mesh').material.uniforms.tex.value),this.preloadTexture(wall.getObject3D('mesh').material.uniforms.env.value)},preloadWrongMap:function(){const wrong=document.querySelector('#wrongLeft');this.preloadTexture(wrong.getObject3D('mesh').material.map)},preloadGenres:function(){const genres=document.querySelector('.genreIcon');this.preloadTexture(genres.getObject3D('mesh').material.map)},preloadTexture:function(texture){return texture&&texture.image?texture.image.complete?void this.el.renderer.setTexture2D(texture,i++%8):void console.warn('[gpu-preloader] Error preloading, image not loaded',texture):void console.warn('[gpu-preloader] Error preloading texture',texture)}})},function(){AFRAME.registerComponent('hack',{play:function(){const interval=setInterval(()=>{this.el.sceneEl.is('vr-mode')||(this.el.sceneEl.enterVR(),clearInterval(interval))},1e3)}})},function(){const events=['triggerdown','gripdown','abuttondown','bbuttondown','xbuttondown','ybuttondown','trackpaddown'];AFRAME.registerComponent('hand-swapper',{schema:{enabled:{default:!1}},init:function(){this.swapHand=this.swapHand.bind(this),events.forEach(event=>{this.el.addEventListener(event,this.swapHand)})},swapHand:function(){this.data.enabled&&this.el.sceneEl.emit('activehandswap',null,!1)}})},function(){AFRAME.registerComponent('haptics-saber',{init:function(){const el=this.el;this.isColliding=!1,this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),100),el.setAttribute('haptics__saber',{dur:100,force:0.075}),el.addEventListener('mouseenter',evt=>{if(evt.detail&&evt.detail.intersectedEl){const intersectedEl=evt.detail.intersectedEl;return intersectedEl.classList.contains('blade')&&intersectedEl!==el?void(this.isColliding=!0,this.el.components.haptics__saber.pulse()):void(this.isColliding=!1)}}),el.addEventListener('mouseleave',()=>{this.isColliding=!1})},tick:function(){this.isColliding&&this.el.components.haptics__saber.pulse()}})},function(){AFRAME.registerComponent('haptics-wall',{init:function(){const el=this.el;this.isHittingWall=!1,el.setAttribute('haptics__wall',{dur:50,force:0.075}),this.checkIfHittingWall=this.checkIfHittingWall.bind(this),el.addEventListener('mouseenter',this.checkIfHittingWall),el.addEventListener('mouseleave',this.checkIfHittingWall),this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),50)},checkIfHittingWall:function(){const intersectedEls=this.el.components.raycaster__game.intersectedEls;this.isHittingWall=!1;for(let i=0;i<intersectedEls.length;i++)if(intersectedEls[i].components.wall)return void(this.isHittingWall=!0)},tick:function(){this.isHittingWall&&this.el.components.haptics__wall.pulse()}})},function(){AFRAME.registerComponent('history',{schema:{challengeId:{type:'string'},songName:{type:'string'},songSubName:{type:'string'}},update:function(){const data=this.data;history.pushState('',data.songName,updateQueryParam(window.location.href,'challenge',data.challengeId)),document.title=`Super Saber - ${data.songName}`}})},function(){AFRAME.registerComponent('intro-song',{schema:{isPlaying:{default:!0},isSearching:{default:!1}},init:function(){this.analyserEl=document.getElementById('audioAnalyser'),this.audio=document.getElementById('introSong'),this.timeout=null},update:function(oldData){const audio=this.audio;this.el.sceneEl.isPlaying&&(oldData.isSearching||!this.data.isSearching)&&(!oldData.isPlaying&&this.data.isPlaying&&(this.analyserEl.components.audioanalyser.resumeContext(),this.analyserEl.setAttribute('audioanalyser','src',audio),this.fadeInAudio()),oldData.isPlaying&&!this.data.isPlaying&&audio.pause())},pause:function(){this.audio.pause()},play:function(){this.fadeInAudio()},fadeInAudio:function(){if(!AFRAME.utils.getUrlParameter('mute')){const context=this.analyserEl.components.audioanalyser.context,gainNode=this.analyserEl.components.audioanalyser.gainNode;gainNode.gain.setValueAtTime(0,context.currentTime),this.audio.play(),gainNode.gain.linearRampToValueAtTime(0.5,context.currentTime+0.5)}}})},function(){AFRAME.registerComponent('keyboard-raycastable',{dependencies:['super-keyboard'],schema:{condition:{default:''}},play:function(){this.el.components['super-keyboard'].kbImg.setAttribute('bind-toggle__raycastable',this.data.condition)}})},function(module,exports,__webpack_require__){const firebase=__webpack_require__(140);__webpack_require__(141);AFRAME.registerComponent('leaderboard',{schema:{apiKey:{type:'string'},authDomain:{type:'string'},databaseURL:{type:'string'},projectId:{type:'string'},storageBucket:{type:'string'},messagingSenderId:{type:'string'},challengeId:{default:''},menuSelectedChallengeId:{default:''},isVictory:{default:!1}},init:function(){this.qualifyingIndex=void 0,this.scores=[],this.eventDetail={scores:this.scores},this.addEventDetail={scoreData:void 0,index:void 0},this.username=localStorage.getItem('supersaberusername')||'Super Zealot',this.el.addEventListener('leaderboardusername',evt=>{this.username=evt.detail.value,localStorage.setItem('supersaberusername',this.username)}),this.el.addEventListener('leaderboardsubmit',this.addScore.bind(this))},update:function(oldData){!firebase.apps.length&&this.data.apiKey&&(firebase.initializeApp({apiKey:this.data.apiKey,authDomain:this.data.authDomain,databaseURL:this.data.databaseURL,projectId:this.data.projectId,storageBucket:this.data.storageBucket,messagingSenderId:this.data.messagingSenderId}),this.firestore=firebase.firestore(),this.firestore.settings({timestampsInSnapshots:!0}),this.db=this.firestore.collection('scores')),!oldData.isVictory&&this.data.isVictory&&this.checkLeaderboardQualify(),this.data.menuSelectedChallengeId&&oldData.menuSelectedChallengeId!==this.data.menuSelectedChallengeId&&this.fetchScores(this.data.menuSelectedChallengeId),this.data.challengeId&&oldData.challengeId!==this.data.challengeId&&this.fetchScores(this.data.challengeId)},addScore:function(){const state=this.el.sceneEl.systems.state.state;if(state.isVictory){const scoreData={accuracy:state.score.accuracy,challengeId:state.challenge.id,score:state.score.score,username:this.username,difficulty:state.challenge.difficulty,time:new Date};this.db.add(scoreData),this.addEventDetail.scoreData=scoreData,this.el.emit('leaderboardscoreadded',this.addEventDetail,!1)}},fetchScores:function(challengeId){const state=this.el.sceneEl.systems.state.state,query=this.db.where('challengeId','==',challengeId).where('difficulty','==',state.menuSelectedChallenge.id?state.menuSelectedChallenge.difficulty:state.challenge.difficulty).orderBy('score','desc').orderBy('time','asc').limit(10);query.get().then(snapshot=>{this.eventDetail.challengeId=challengeId,this.scores.length=0,snapshot.empty||snapshot.forEach(score=>this.scores.push(score.data())),this.el.sceneEl.emit('leaderboard',this.eventDetail,!1)}).catch(e=>{console.error('[firestore]',e)})},checkLeaderboardQualify:function(){const state=this.el.sceneEl.systems.state.state,score=state.score.score;if(this.scores.length<10)return this.qualifyingIndex=this.scores.length,void this.el.sceneEl.emit('leaderboardqualify',this.scores.length,!1);for(let i=0;i<this.scores.length;i++)if(score>this.scores[i].score)return this.qualifyingIndex=i,void this.el.sceneEl.emit('leaderboardqualify',i,!1)}})},function(){var ONCE={once:!0};AFRAME.registerComponent('logo-light',{init:function(){this.logoBack=document.getElementById('logoBack'),this.logoFront=document.getElementById('logoFront'),this.logoFrontU=document.getElementById('logoFrontU')},play:function(){setTimeout(()=>{this.el.setAttribute('light',{type:'spot',penumbra:1,intensity:5,angle:20}),this.waitAndUpdate(this.logoBack),this.waitAndUpdate(this.logoFront),this.waitAndUpdate(this.logoFrontU)},1e3)},waitAndUpdate:function(el){el.getObject3D('mesh')?el.object3D.traverse(this.updateMaterials):el.addEventListener('model-loaded',()=>{el.object3D.traverse(this.updateMaterials)},ONCE)},updateMaterials:function(node){node.material&&(node.material.needsUpdate=!0)}})},function(){var _Mathfloor4=Math.floor;AFRAME.registerComponent('logoflicker',{schema:{delay:{default:1e3},active:{default:!0}},init:function(){this.setOff=this.setOff.bind(this),this.setOn=this.setOn.bind(this),this.timeout=0,this.sparks=document.getElementById('logosparks'),this.sparkPositions=[{position:new THREE.Vector3(0,0.1,0)},{position:new THREE.Vector3(0.3,0.8,0)},{position:new THREE.Vector3(-0.3,0.8,0)}]},update:function(oldData){this.data.active!==oldData.active&&(this.data.active?this.setOn():clearTimeout(this.timeout))},setOff:function(){this.el.object3D.visible=!1,this.sparks.emit('logoflicker',this.sparkPositions[_Mathfloor4(Math.random()*this.sparkPositions.length)],!1),this.timeout=setTimeout(this.setOn,50)},setOn:function(){this.el.object3D.visible=!0,this.timeout=setTimeout(this.setOff,_Mathfloor4(3*this.data.delay/10+Math.random()*this.data.delay))}})},function(module,exports,__webpack_require__){const COLORS=__webpack_require__(7),flatShaders=__webpack_require__(56),stageAdditiveShaders=__webpack_require__(57),stageNormalShaders=__webpack_require__(58);AFRAME.registerSystem('materials',{init:function(){'loading'===document.readyState?document.addEventListener('DOMContentLoaded',this.createMaterials.bind(this)):this.createMaterials()},createMaterials:function(){this.stageNormal=new THREE.ShaderMaterial({uniforms:{skyColor:{value:new THREE.Color(COLORS.SKY_BLUE)},backglowColor:{value:new THREE.Color(COLORS.BG_BLUE)},src:{value:new THREE.TextureLoader().load(document.getElementById('atlasImg').src)}},vertexShader:stageNormalShaders.vertexShader,fragmentShader:stageNormalShaders.fragmentShader,fog:!1,transparent:!0}),this.stageAdditive=new THREE.ShaderMaterial({uniforms:{tunnelNeon:{value:new THREE.Color(COLORS.NEON_RED)},floorNeon:{value:new THREE.Color(COLORS.NEON_RED)},leftLaser:{value:new THREE.Color(COLORS.NEON_BLUE)},rightLaser:{value:new THREE.Color(COLORS.NEON_BLUE)},textGlow:{value:new THREE.Color(COLORS.TEXT_OFF)},src:{value:new THREE.TextureLoader().load(document.getElementById('atlasImg').src)}},vertexShader:stageAdditiveShaders.vertexShader,fragmentShader:stageAdditiveShaders.fragmentShader,blending:THREE.AdditiveBlending,fog:!1,transparent:!0}),this.logo=new THREE.ShaderMaterial({uniforms:{src:{value:new THREE.TextureLoader().load(document.getElementById('logotexImg').src)}},vertexShader:flatShaders.vertexShader,fragmentShader:flatShaders.fragmentShader,depthTest:!1,fog:!1,transparent:!0}),this.logoadditive=new THREE.ShaderMaterial({uniforms:{src:{value:new THREE.TextureLoader().load(document.getElementById('logotexImg').src)}},vertexShader:flatShaders.vertexShader,fragmentShader:flatShaders.fragmentShader,depthTest:!1,blending:THREE.AdditiveBlending,fog:!1,transparent:!0}),this.mineMaterialred=new THREE.MeshStandardMaterial({roughness:0.38,metalness:0.48,color:new THREE.Color(COLORS.MINE_RED),emissive:new THREE.Color(COLORS.MINE_RED_EMISSION),envMap:new THREE.TextureLoader().load('assets/img/mineenviro-red.jpg')}),this.mineMaterialblue=new THREE.MeshStandardMaterial({roughness:0.38,metalness:0.48,color:new THREE.Color(COLORS.MINE_BLUE),emissive:new THREE.Color(COLORS.MINE_BLUE_EMISSION),envMap:new THREE.TextureLoader().load('assets/img/mineenviro-blue.jpg')})}}),AFRAME.registerComponent('materials',{schema:{name:{default:''},recursive:{default:!0}},update:function(){if(''!==this.data.name){const material=this.system[this.data.name];if(!material)return void console.warn(`undefined material "${this.system[this.data.name]}"`);const mesh=this.el.getObject3D('mesh');mesh?this.applyMaterial(mesh):this.el.addEventListener('model-loaded',this.applyMaterial.bind(this))}},applyMaterial:function(obj){const material=this.system[this.data.name];obj.detail&&(obj=obj.detail.model),this.data.recursive?obj.traverse(o=>{'Mesh'===o.type&&(o.material=material)}):obj.material=material}})},function(){var keyEventsRegistered=!1,results=null,hoveredIndex;const PER_PAGE=6;AFRAME.registerComponent('menu-controls',{schema:{enabled:{default:!0},page:{default:0},selectedChallengeId:{default:''}},init:function(){const el=this.el;results=document.getElementById('searchResultList').children,this.goPrevResult=this.goPrevResult.bind(this),this.goNextResult=this.goNextResult.bind(this),this.select=this.select.bind(this),this.unselect=this.unselect.bind(this),el.addEventListener('thumbupstart',this.goPrevResult),el.addEventListener('thumbdownstart',this.goNextResult),el.addEventListener('thumbleftstart',this.unselect),el.addEventListener('thumbrightstart',this.select),el.addEventListener('mouseenter',()=>{!el.components.cursor.intersectedEl||el.components.cursor.intersectedEl.closest('#searchResultList')&&this.cancelMenuControls()}),AFRAME.utils.getUrlParameter('debug')&&!keyEventsRegistered&&(window.addEventListener('keydown',evt=>{37===evt.keyCode&&this.unselect(),38===evt.keyCode&&this.goPrevResult(),39===evt.keyCode&&this.select(),40===evt.keyCode&&this.goNextResult()}),keyEventsRegistered=!0)},goPrevResult:function(){return this.data.enabled?void 0==hoveredIndex?void this.hoverResult(0):void(0<hoveredIndex?results[hoveredIndex-1].dataset.id===this.data.selectedChallengeId?0>hoveredIndex-2?this.goPrevPage():this.hoverResult(hoveredIndex-2):this.hoverResult(hoveredIndex-1):this.goPrevPage()):void 0},goPrevPage:function(){this.hoverResult(PER_PAGE-1),this.el.sceneEl.emit('searchprevpage',null,!1)},goNextResult:function(){return this.data.enabled?void 0==hoveredIndex?void this.hoverResult(0):void(hoveredIndex<PER_PAGE-1?results[hoveredIndex+1].dataset.id===this.data.selectedChallengeId?hoveredIndex+2>PER_PAGE-1?this.goNextPage():this.hoverResult(hoveredIndex+2):this.hoverResult(hoveredIndex+1):this.goNextPage()):void 0},goNextPage:function(){this.hoverResult(0),this.el.sceneEl.emit('searchnextpage',null,!1)},select:function(){this.data.enabled&&void 0!=hoveredIndex&&this.el.sceneEl.emit('menuchallengeselect',results[hoveredIndex].dataset.id,!1)},unselect:function(){!this.data.enabled||this.data.selectedChallengeId&&this.el.sceneEl.emit('menuchallengeunselect',null,!1)},hoverResult:function(i){hoveredIndex!=void 0&&results[hoveredIndex].querySelector('.searchResultBackground').emit('mouseleave',null,!1),hoveredIndex=i,results[i].querySelector('.searchResultBackground').emit('mouseenter',null,!1)},cancelMenuControls:function(){void 0===hoveredIndex||(results[hoveredIndex].querySelector('.searchResultBackground').emit('mouseleave',null,!1),hoveredIndex=void 0)}})},function(module,exports,__webpack_require__){var bindEvent=__webpack_require__(15).bindEvent;AFRAME.registerComponent('menu-difficulty-select',{init:function(){this.el.sceneEl.addEventListener('menuchallengeselect',()=>{this.el.object3D.visible=!1,setTimeout(()=>{this.el.components.layout.update(),this.el.object3D.visible=!0},150)})},click:bindEvent(function(evt){this.el.sceneEl.emit('menudifficultyselect',evt.target.closest('.difficultyOption').dataset.difficulty,!1)})})},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__utils__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_0__utils___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__utils__);AFRAME.registerComponent('menu-selected-challenge-image',{schema:{selectedChallengeId:{type:'string'}},update:function(){const el=this.el;this.data.selectedChallengeId&&el.setAttribute('material','src',__WEBPACK_IMPORTED_MODULE_0__utils___default.a.getS3FileUrl(this.data.selectedChallengeId,'image.jpg'))}})},function(){AFRAME.registerComponent('menu-slide-animation',{schema:{isSearching:{default:!1},menuSelectedChallengeId:{type:'string'}},init:function(){this.isLeft=!1},update:function(oldData){const data=this.data;return this.isLeft?(!oldData.menuSelectedChallengeId||data.menuSelectedChallengeId||data.isSearching||this.rightMenu(),void(!oldData.isSearching||data.isSearching||data.menuSelectedChallengeId||this.rightMenu())):void(!this.isLeft&&(!oldData.menuSelectedChallengeId&&data.menuSelectedChallengeId&&this.leftMenu(),!oldData.isSearching&&data.isSearching&&this.leftMenu()))},rightMenu:function(){this.isLeft&&(this.el.components.animation__menuright.beginAnimation(),this.isLeft=!1)},leftMenu:function(){this.isLeft||(this.el.components.animation__menuleft.beginAnimation(),this.isLeft=!0)}})},function(){const objLoader=new THREE.OBJLoader;AFRAME.registerSystem('mine-fragments-loader',{init:function(){this.fragments=null;const objData=document.getElementById('mineBrokenObj');objData.addEventListener('loaded',evt=>{this.fragments=objLoader.parse(evt.target.data)})}})},function(){const COMBO_PROGRESS_MAP={0:0,1:0.5,2:0,3:0.25,4:0.5,5:0.75,6:0,7:0.125,8:0.25,9:0.375,10:0.5,11:0.625,12:0.75,13:0.875};AFRAME.registerComponent('multiplier-ring',{dependencies:['geometry','material'],schema:{combo:{default:0},multiplier:{default:1}},init:function(){this.animationSet={from:void 0,to:void 0},this.progress=this.el.getObject3D('mesh').material.uniforms.progress,this.el.setAttribute('animation',{property:'components.material.material.uniforms.progress.value',dur:100,autoplay:!1})},update:function(){this.updateRing()},updateRing:function(){const data=this.data,el=this.el,progress=this.progress;if(8===data.multiplier)return void(progress.value=1);const animationSet=this.animationSet;animationSet.from=progress.value,animationSet.to=COMBO_PROGRESS_MAP[data.combo],el.setAttribute('animation',animationSet),el.components.animation.beginAnimation()}})},function(module){function transformPlane(particleIndex,geometry,originalArray,position,rotation,scale){const array=geometry.attributes.position.array,index=particleIndex*NUM_PLANE_POSITIONS;tri.vertices[0].set(originalArray[index+0],originalArray[index+1],originalArray[index+2]),tri.vertices[1].set(originalArray[index+3],originalArray[index+4],originalArray[index+5]),tri.vertices[2].set(originalArray[index+6],originalArray[index+7],originalArray[index+8]),null!==scale&&tri.scale(scale.x,scale.y,scale.z),rotation&&(tri.rotateX(rotation.x),tri.rotateY(rotation.y),tri.rotateZ(rotation.z)),tri.vertices[0].add(position),tri.vertices[1].add(position),tri.vertices[2].add(position),array[index+0]=tri.vertices[0].x,array[index+1]=tri.vertices[0].y,array[index+2]=tri.vertices[0].z,array[index+3]=tri.vertices[1].x,array[index+4]=tri.vertices[1].y,array[index+5]=tri.vertices[1].z,array[index+6]=tri.vertices[2].x,array[index+7]=tri.vertices[2].y,array[index+8]=tri.vertices[2].z,tri.vertices[0].set(originalArray[index+3],originalArray[index+4],originalArray[index+5]),tri.vertices[1].set(originalArray[index+6],originalArray[index+7],originalArray[index+8]),tri.vertices[2].set(originalArray[index+9],originalArray[index+10],originalArray[index+11]),null!==scale&&tri.scale(scale.x,scale.y,scale.z),rotation&&(tri.rotateX(rotation.x),tri.rotateY(rotation.y),tri.rotateZ(rotation.z)),tri.vertices[0].add(position),tri.vertices[1].add(position),tri.vertices[2].add(position),array[index+9]=tri.vertices[2].x,array[index+10]=tri.vertices[2].y,array[index+11]=tri.vertices[2].z,geometry.attributes.position.needsUpdate=!0}function copyArray(dest,src){dest.length=0;for(let i=0;i<src.length;i++)dest[i]=src[i]}var _Mathfloor5=Math.floor,_MathPI3=Math.PI;const NUM_PLANE_POSITIONS=12,BLENDINGS={normal:THREE.NormalBlending,additive:THREE.AdditiveBlending,substractive:THREE.SubstractiveBlending,multiply:THREE.MultiplyBlending},SHADERS={flat:THREE.MeshBasicMaterial,lambert:THREE.MeshLambertMaterial,phong:THREE.MeshPhongMaterial,standard:THREE.MeshStandardMaterial},OFFSCREEN_VEC3=new THREE.Vector3(-99999,-99999,-99999);AFRAME.registerComponent('particleplayer',{schema:{blending:{default:'additive',oneOf:['normal','additive','multiply','substractive']},color:{default:'#fff',type:'color'},count:{default:'100%'},delay:{default:0,type:'int'},dur:{default:1e3,type:'int'},img:{type:'selector'},interpolate:{default:!1},loop:{default:'false'},on:{default:'init'},poolSize:{default:5,type:'int'},protation:{type:'vec3'},pscale:{default:1,type:'float'},scale:{default:1,type:'float'},initialScale:{type:'vec3'},finalScale:{type:'vec3'},animateScale:{default:!1},shader:{default:'flat',oneOf:['flat','lambert','phong','standard']},src:{type:'selector'}},multiple:!0,init:function(){this.frame=0,this.framedata=null,this.indexPool=null,this.lastFrame=0,this.material=null,this.msPerFrame=0,this.numFrames=0,this.numParticles=0,this.originalVertexPositions=[],this.particleCount=0,this.particleSystems=[],this.protation=!1,this.restPositions=[],this.restRotations=[],this.sprite_rotation=!1,this.systems=null,this.useRotation=!1,this.useAge=!1,this.scaleAnim=new THREE.Vector3,this.partScale=new THREE.Vector3(1,1,1)},update:function(oldData){const data=this.data;if(data.src){oldData.on!==data.on&&(oldData.on&&this.el.removeEventListener(oldData.on,this.start),'play'!==data.on&&this.el.addEventListener(data.on,this.start.bind(this))),this.partScale.set(1,1,1),this.loadParticlesJSON(data.src,data.scale),this.numFrames=this.framedata.length,this.numParticles=0<this.numFrames?this.framedata[0].length:0,this.particleCount='%'===data.count[data.count.length-1]?_Mathfloor5(parseInt(data.count)*this.numParticles/100):parseInt(data.count),this.particleCount=Math.min(this.numParticles,Math.max(0,this.particleCount)),this.msPerFrame=data.dur/this.numFrames,this.indexPool=Array(this.numParticles);const materialParams={color:new THREE.Color(data.color),side:THREE.DoubleSide,blending:BLENDINGS[data.blending],map:data.img?new THREE.TextureLoader().load(data.img.src):null,depthWrite:!1,opacity:data.opacity,transparent:!!data.img||'normal'!==data.blending||1>data.opacity};this.material=void 0===SHADERS[data.shader]?new SHADERS.flat(materialParams):new SHADERS[data.shader](materialParams),this.createParticles(data.poolSize),'init'===data.on&&this.start()}},loadParticlesJSON:function(json,scale){var alive;this.restPositions.length=0,this.restRotations.length=0;const jsonData=JSON.parse(json.data),frames=jsonData.frames,precision=jsonData.precision;this.useRotation=jsonData.rotation,this.useAge=jsonData.age!==void 0&&jsonData.age,this.sprite_rotation=!1!==jsonData.sprite_rotation&&{x:jsonData.sprite_rotation[0]/precision,y:jsonData.sprite_rotation[1]/precision,z:jsonData.sprite_rotation[2]/precision},this.framedata=Array(frames.length);for(let frameIndex=0;frameIndex<frames.length;frameIndex++){this.framedata[frameIndex]=Array(frames[frameIndex].length);for(let particleIndex=0,rawP;particleIndex<frames[frameIndex].length;particleIndex++){rawP=frames[frameIndex][particleIndex],alive=0!==rawP;let p=this.framedata[frameIndex][particleIndex]={position:alive?{x:rawP[0]/precision*scale,y:rawP[1]/precision*scale,z:rawP[2]/precision*scale}:null,alive:alive};this.useRotation&&(p.rotation=alive?{x:rawP[3]/precision,y:rawP[4]/precision,z:rawP[5]/precision}:null),this.useAge&&(p.age=alive?rawP[6]/precision:0),alive&&0===frameIndex&&(this.restPositions[particleIndex]=p.position?{x:p.position.y,y:p.position.y,z:p.position.z}:null,this.restRotations[particleIndex]=p.rotation?{x:p.rotation.y,y:p.rotation.y,z:p.rotation.z}:null)}}},createParticles:function(){const tempGeometries=[];return function(numParticleSystems){const data=this.data;var loop=parseInt(this.data.loop);this.particleSystems.length=0,isNaN(loop)&&(loop='true'===this.data.loop?Number.MAX_VALUE:0);for(let i=0,particleSystem;i<numParticleSystems;i++){particleSystem={active:!1,activeParticleIndices:Array(this.particleCount),loopCount:0,loopTotal:loop,mesh:null,time:0};const ratio=data.img?data.img.width/data.img.height:1;tempGeometries.length=0;for(let p=0,geometry;p<this.numParticles;p++)geometry=new THREE.PlaneBufferGeometry(0.1*ratio*data.pscale,0.1*data.pscale),!1===this.sprite_rotation?(geometry.rotateX(this.data.protation.x*_MathPI3/180),geometry.rotateY(this.data.protation.y*_MathPI3/180),geometry.rotateZ(this.data.protation.z*_MathPI3/180)):(geometry.rotateX(this.sprite_rotation.x),geometry.rotateY(this.sprite_rotation.y),geometry.rotateZ(this.sprite_rotation.z)),tempGeometries.push(geometry);let mergedBufferGeometry=THREE.BufferGeometryUtils.mergeBufferGeometries(tempGeometries);particleSystem.mesh=new THREE.Mesh(mergedBufferGeometry,this.material),particleSystem.mesh.visible=!1,this.el.setObject3D(`particleplayer${i}`,particleSystem.mesh),copyArray(this.originalVertexPositions,mergedBufferGeometry.attributes.position.array);for(let i=0;i<mergedBufferGeometry.attributes.position.array.length;i++)mergedBufferGeometry.attributes.position.array[i]=-99999;for(let i=0;i<particleSystem.activeParticleIndices.length;i++)particleSystem.activeParticleIndices[i]=i;this.particleSystems.push(particleSystem)}}}(),start:function(evt){0<this.data.delay?setTimeout(()=>this.startAfterDelay(evt),this.data.delay):this.startAfterDelay(evt)},startAfterDelay:function(evt){var found=-1,oldestTime=0,position=evt?evt.detail.position:null,rotation=evt?evt.detail.rotation:null,particleSystem;position instanceof THREE.Vector3||(position=new THREE.Vector3),rotation instanceof THREE.Euler||(rotation=new THREE.Euler);for(var i=0;i<this.particleSystems.length;i++){if(!1===this.particleSystems[i].active){found=i;break}this.particleSystems[i].time>oldestTime&&(found=i,oldestTime=this.particleSystems[i].time)}if(-1!==found)return particleSystem=this.particleSystems[found],particleSystem.active=!0,particleSystem.loopCount=1,particleSystem.mesh.visible=!0,particleSystem.mesh.position.copy(position),particleSystem.mesh.rotation.copy(rotation),particleSystem.time=0,this.resetParticles(particleSystem),particleSystem},doLoop:function(particleSystem){particleSystem.loopCount++,particleSystem.frame=-1,particleSystem.time=0,this.resetParticles(particleSystem)},resetParticle:function(particleSystem,particleIndex){const geometry=particleSystem.mesh.geometry;this.restPositions[particleIndex]?transformPlane(particleIndex,geometry,this.originalVertexPositions,this.restPositions[particleIndex],this.useRotation&&this.restRotations[particleIndex],null):transformPlane(particleIndex,geometry,this.originalVertexPositions,OFFSCREEN_VEC3,void 0,null)},resetParticles:function(particleSystem){var i,rand;if(this.particleCount===this.numParticles){for(i=0;i<this.numParticles;i++)this.resetParticle(particleSystem,i);return}const geometry=particleSystem.mesh.geometry;for(i=0;i<this.numParticles;i++)i<this.particleCount&&transformPlane(particleSystem.activeParticleIndices[i],geometry,this.originalVertexPositions,OFFSCREEN_VEC3,void 0,null),this.indexPool[i]=i;for(i=0;i<this.particleCount;i++)rand=i+_Mathfloor5(Math.random()*(this.numParticles-i)),particleSystem.activeParticleIndices[i]=this.indexPool[rand],this.indexPool[rand]=this.indexPool[i],this.resetParticle(particleSystem,particleSystem.activeParticleIndices[i])},tick:function(){const helperPositionVec3=new THREE.Vector3;return function(time,delta){var useRotation=this.useRotation,frame,fdata,fdataNext,frameTime,relTime,interpolate;const scaleSystem=this.data.animateScale&&!this.useAge,scaleParticle=this.data.animateScale&&this.useAge;for(let particleSystemIndex=0,particleSystem;particleSystemIndex<this.particleSystems.length;particleSystemIndex++)if(particleSystem=this.particleSystems[particleSystemIndex],!!particleSystem.active){interpolate=this.data.interpolate&&this.data.dur/this.numFrames>delta,relTime=particleSystem.time/this.data.dur,frame=relTime*this.numFrames,fdata=this.framedata[_Mathfloor5(frame)],interpolate&&(frameTime=frame-_Mathfloor5(frame),fdataNext=frame<this.numFrames-1?this.framedata[_Mathfloor5(frame)+1]:null),scaleSystem&&this.partScale.lerpVectors(this.data.initialScale,this.data.finalScale,relTime);for(let activeParticleIndex=0;activeParticleIndex<particleSystem.activeParticleIndices.length;activeParticleIndex++){let particleIndex=particleSystem.activeParticleIndices[activeParticleIndex],rotation=useRotation&&fdata[particleIndex].rotation;if(scaleParticle&&this.partScale.lerpVectors(this.data.initialScale,this.data.finalScale,fdata[particleIndex].age),!fdata[particleIndex].alive){transformPlane(particleIndex,particleSystem.mesh.geometry,this.originalVertexPositions,OFFSCREEN_VEC3,void 0,null);continue}interpolate&&fdataNext&&fdataNext[particleIndex].alive?(helperPositionVec3.lerpVectors(fdata[particleIndex].position,fdataNext[particleIndex].position,frameTime),transformPlane(particleIndex,particleSystem.mesh.geometry,this.originalVertexPositions,helperPositionVec3,rotation,this.partScale)):transformPlane(particleIndex,particleSystem.mesh.geometry,this.originalVertexPositions,fdata[particleIndex].position,rotation,this.partScale)}if(particleSystem.time+=delta,particleSystem.time>=this.data.dur){particleSystem.loopCount<particleSystem.loopTotal?(this.el.emit('particleplayerloop',null,!1),this.doLoop(particleSystem)):(this.el.emit('particleplayerfinished',null,!1),particleSystem.active=!1,particleSystem.mesh.visible=!1);continue}}}}(),_transformPlane:transformPlane});const tri=function(){const tri=new THREE.Geometry;return tri.vertices.push(new THREE.Vector3),tri.vertices.push(new THREE.Vector3),tri.vertices.push(new THREE.Vector3),tri.faces.push(new THREE.Face3(0,1,2)),tri}();module.exports.transformPlane=transformPlane},function(){AFRAME.registerComponent('pause',{schema:{isPaused:{default:!1}},update:function(){this.data.isPaused&&this.el.isPlaying?this.el.pause():!this.data.isPaused&&!this.el.isPlaying&&this.el.sceneEl.isPlaying&&this.el.play()}})},function(){AFRAME.registerComponent('pauser',{schema:{enabled:{default:!0}},init:function(){this.pauseGame=this.pauseGame.bind(this),this.el.sceneEl.addEventListener('controllerconnected',evt=>{'vive-controls'===evt.detail.name?this.el.addEventListener('menudown',this.pauseGame):this.el.addEventListener('thumbstickdown',this.pauseGame)}),document.addEventListener('visibilitychange',()=>{'hidden'===document.visibilityState&&this.pauseGame()})},pauseGame:function(){this.data.enabled&&this.el.sceneEl.emit('pausegame',null,!1)}})},function(module,exports,__webpack_require__){var SoundPool=__webpack_require__(133);AFRAME.registerSystem('play-sound',{init:function(){this.lastSoundPlayed='',this.lastSoundPlayedTime=0,this.pools={}},createPool:function(sound,volume){this.pools[sound]||(this.pools[sound]=new SoundPool(sound,volume))},playSound:function(sound,volume){this.pools[sound]||this.createPool(sound,volume),this.pools[sound].play(),this.lastSoundPlayed=sound,this.lastSoundTime=this.el.time}}),AFRAME.registerComponent('play-sound',{schema:{enabled:{default:!0},event:{type:'string'},sound:{type:'string'},volume:{type:'number',default:1}},multiple:!0,init:function(){this.el.addEventListener(this.data.event,()=>{this.data.enabled&&this.system.playSound(this.src,this.data.volume)})},update:function(){this.src=this.data.sound,this.data.sound.startsWith('#')&&(this.src=document.querySelector(this.data.sound).getAttribute('src'))}})},function(){AFRAME.registerComponent('raycaster-target',{schema:{bindToggle:{default:''},depth:{type:'number'},height:{type:'number'},position:{type:'vec3',default:{x:0,y:0,z:0}},rotation:{type:'vec3',default:{x:0,y:0,z:0}},useBoxTarget:{default:!1},width:{type:'number'}},init:function(){var boxGeometry={primitive:'box'},planeGeometry={primitive:'plane'};return function(){var data=this.data,el=this.el,geometry,raycastTarget;raycastTarget=document.createElement('a-entity'),raycastTarget.classList.add('raycasterTarget'),data.bindToggle?raycastTarget.setAttribute('bind-toggle__raycastable',data.bindToggle):raycastTarget.setAttribute('data-raycastable',''),data.useBoxTarget?(geometry=boxGeometry,geometry.depth=data.depth,geometry.height=data.height,geometry.width=data.width):(geometry=planeGeometry,geometry.height=data.height,geometry.width=data.width),raycastTarget.setAttribute('geometry',geometry),raycastTarget.object3D.visible=!1,raycastTarget.object3D.position.copy(data.position),raycastTarget.object3D.rotation.x=THREE.Math.degToRad(data.rotation.x),raycastTarget.object3D.rotation.y=THREE.Math.degToRad(data.rotation.y),raycastTarget.object3D.rotation.z=THREE.Math.degToRad(data.rotation.z),el.appendChild(raycastTarget)}}()})},function(){AFRAME.registerComponent('recenter',{schema:{enabled:{default:!0}},init:function(){this.el.sceneEl;this.recenter=this.recenter.bind(this),document.querySelectorAll('[tracked-controls]').forEach(controlEl=>{controlEl.addEventListener('menudown',this.recenter),controlEl.addEventListener('thumbstickdown',this.recenter)}),this.el.addEventListener('recenter',this.recenter)},recenter:function(){var euler=new THREE.Euler,matrix=new THREE.Matrix4,rotationMatrix=new THREE.Matrix4,translationMatrix=new THREE.Matrix4;return function(){const el=this.el;if(this.data.enabled){const camera=el.sceneEl.camera.el.object3D;matrix.identity(),euler.set(0,-1*camera.rotation.y,0),rotationMatrix.makeRotationFromEuler(euler),translationMatrix.makeTranslation(-1*camera.position.x,0,-1*camera.position.z),matrix.multiply(rotationMatrix).multiply(translationMatrix),matrix.decompose(el.object3D.position,el.object3D.quaternion,el.object3D.scale),el.object3D.updateMatrixWorld(!0),el.emit('recentered',null,!1)}}}()})},function(){AFRAME.registerComponent('saber-controls',{schema:{bladeEnabled:{default:!1},hand:{default:'right',oneOf:['left','right']},isPaused:{default:!1},strokeMinSpeed:{default:2e-3},strokeMinDuration:{default:30}},init:function(){var el=this.el,data=this.data;this.boundingBox=new THREE.Box3,this.controllerType='',this.xPlaneNormal=new THREE.Vector3(0,1,0),this.yPlaneNormal=new THREE.Vector3(1,0,0),this.xyPlaneNormal=new THREE.Vector3(1,1,0),this.bladeTipPosition=new THREE.Vector3,this.bladePosition=new THREE.Vector3,this.bladeVector=new THREE.Vector3,this.bladeTipPreviousPosition=new THREE.Vector3,this.projectedBladeVector=new THREE.Vector3,this.saberPosition=new THREE.Vector3,this.swinging=!1,this.strokeCount=0,this.distanceSamples=[],this.deltaSamples=[],this.startStrokePosition=new THREE.Vector3,this.strokeDirectionVector=new THREE.Vector3,this.strokeDirection={down:!1,left:!1,right:!1,up:!1},this.accumulatedDistance=0,this.accumulatedDelta=0,el.addEventListener('controllerconnected',this.initSaber.bind(this));const hand={hand:data.hand,model:!1};el.setAttribute('oculus-touch-controls',hand),el.setAttribute('vive-controls',hand),el.setAttribute('windows-motion-controls',hand),this.bladeEl=this.el.querySelector('.blade')},update:function(oldData){!oldData.bladeEnabled&&this.data.bladeEnabled&&this.bladeEl.emit('drawblade')},tick:function(time,delta){this.data.bladeEnabled&&(this.boundingBox.setFromObject(this.bladeEl.getObject3D('mesh')),this.detectStroke(delta))},detectStroke:function(delta){var distanceSamples=this.distanceSamples,data=this.data,distance;this.bladeTipPosition.set(0,0,-0.8),this.bladePosition.set(0,0,0);const saberObj=this.el.object3D;saberObj.parent.updateMatrixWorld(),saberObj.localToWorld(this.bladeTipPosition),saberObj.localToWorld(this.bladePosition),this.bladeVector.copy(this.bladeTipPosition).sub(this.bladePosition).normalize();var anglePlaneX=this.projectedBladeVector.copy(this.bladeTipPosition).projectOnPlane(this.xPlaneNormal).angleTo(this.bladeVector),anglePlaneY=this.projectedBladeVector.copy(this.bladeTipPosition).projectOnPlane(this.yPlaneNormal).angleTo(this.bladeVector),anglePlaneXY=this.projectedBladeVector.copy(this.bladeTipPosition).projectOnPlane(this.xyPlaneNormal).angleTo(this.bladeVector);if(distance=this.bladeTipPreviousPosition.sub(this.bladeTipPosition).length(),5===this.distanceSamples.length&&(this.accumulatedDistance-=this.distanceSamples.shift(),this.accumulatedDelta-=this.deltaSamples.shift()),this.distanceSamples.push(distance),this.accumulatedDistance+=distance,this.deltaSamples.push(delta),this.accumulatedDelta+=delta,this.accumulatedDistance/this.accumulatedDelta>this.data.strokeMinSpeed){this.swinging||(this.startStrokePosition.copy(this.bladeTipPosition),this.swinging=!0,this.strokeDuration=0,this.maxAnglePlaneX=0,this.maxAnglePlaneY=0,this.maxAnglePlaneXY=0),this.updateStrokeDirection(),this.strokeDuration+=delta;const anglePlaneXIncreased=anglePlaneX>this.maxAnglePlaneX,anglePlaneYIncreased=anglePlaneY>this.maxAnglePlaneY,anglePlaneXYIncreased=anglePlaneXY>this.maxAnglePlaneXY;this.maxAnglePlaneX=anglePlaneXIncreased?anglePlaneX:this.maxAnglePlaneX,this.maxAnglePlaneY=anglePlaneYIncreased?anglePlaneY:this.maxAnglePlaneY,this.maxAnglePlaneXY=anglePlaneXYIncreased?anglePlaneXY:this.maxAnglePlaneXY,anglePlaneXIncreased||anglePlaneYIncreased||this.endStroke()}else this.endStroke();this.bladeTipPreviousPosition.copy(this.bladeTipPosition)},endStroke:function(){if(this.swinging&&!(this.strokeDuration<this.data.strokeMinDuration)){this.el.emit('strokeend'),this.swinging=!1,this.accumulatedDistance=0,this.accumulatedDelta=0,this.maxAnglePlaneX=0,this.maxAnglePlaneY=0,this.maxAnglePlaneXY=0;for(let i=0;i<this.distanceSamples.length;i++)this.distanceSamples[i]=0;for(let i=0;i<this.deltaSamples.length;i++)this.deltaSamples[i]=0;var direction='DIRECTION ';direction+=this.strokeDirection.right?'RIGHT':'LEFT',direction+=this.strokeDirection.up?' TOP':' BOTTOM',console.log(direction),this.el.emit('strokeend')}},updateStrokeDirection:function(){this.strokeDirectionVector.copy(this.bladeTipPosition).sub(this.startStrokePosition);0===this.strokeDirectionVector.x&&0===this.strokeDirectionVector.y||(this.strokeDirection.right=0<this.strokeDirectionVector.x,this.strokeDirection.left=0>this.strokeDirectionVector.x,this.strokeDirection.up=0<this.strokeDirectionVector.y,this.strokeDirection.down=0>this.strokeDirectionVector.y)},initSaber:function(evt){this.controllerType=evt.detail.name,this.el.setAttribute('cursor',this.config[this.controllerType].cursor||{})},config:{"oculus-touch-controls":{cursor:{downEvents:['triggerdown','gripdown','abuttondown','bbuttondown','xbuttondown','ybuttondown'],upEvents:['triggerup','gripup','abuttonup','bbuttonup','xbuttonup','ybuttonup']}},"vive-controls":{cursor:{downEvents:['trackpaddown','triggerdown','gripdown'],upEvents:['trackpadup','triggerup','gripup']}},"windows-motion-controls":{cursor:{downEvents:['trackpaddown','triggerdown','gripdown'],upEvents:['trackpadup','triggerup','gripup']}}}})},function(){AFRAME.registerComponent('saber-particles',{schema:{enabled:{default:!1},hand:{type:'string'}},init:function(){this.hiddenIntersection={x:999,y:0,z:0},this.intersectedEl=null,this.particles=document.getElementById('sparkParticles'),this.particleEventDetail={position:new THREE.Vector3,rotation:new THREE.Euler},this.particleEvent={detail:this.particleEventDetail},this.particleSystem=null,this.saberEnter=this.saberEnter.bind(this),this.saberLeave=this.saberLeave.bind(this)},pause:function(){this.el.removeEventListener('mouseenter',this.saberEnter),this.el.removeEventListener('mouseleave',this.saberLeave)},play:function(){this.el.addEventListener('mouseenter',this.saberEnter),this.el.addEventListener('mouseleave',this.saberLeave),this.particlesDur=this.particles.getAttribute('particleplayer').dur},saberEnter:function(evt){this.data.enabled&&evt.target===this.el&&evt.detail.intersectedEl.hasAttribute('data-saber-particles')&&(this.intersectedEl=evt.detail.intersectedEl)},saberLeave:function(evt){if(evt.detail.target===this.el){if(this.intersectedEl.components.wall||'floor'===this.intersectedEl.id){const uniform=this.data.hand==='right'?'hitRight':'hitLeft',material=this.intersectedEl.getObject3D('mesh').material;material.uniforms[uniform].value=this.hiddenIntersection}this.intersectedEl=null,this.particleSystem=null}},tick:function(){if(this.data.enabled&&this.intersectedEl){const raycaster=this.el.components.raycaster__game,intersection=raycaster.getIntersection(this.intersectedEl);intersection&&(this.particleSystem&&this.particleSystem.active?this.particleSystem.mesh.position.copy(intersection.point):(this.particleEventDetail.position.copy(intersection.point),this.particleSystem=this.particles.components.particleplayer.startAfterDelay(this.particleEvent)))}}})},function(){AFRAME.registerComponent('score-beat',{schema:{type:{type:'string'}},play:function(){this.poolComponent=`pool__beatscore${this.data.type}`,this.startTime=this.el.sceneEl.time},tick:function(time){time>this.startTime+1200&&this.el.sceneEl.components[this.poolComponent].returnEntity(this.el)}})},function(){AFRAME.registerComponent('score-texts',{schema:{isSongLoading:{default:!1}},init:function(){this.textEls=this.el.querySelectorAll('[text]');for(let i=0;i<this.textEls.length;i++)this.textEls[i].setAttribute('animation__fadein',{autoplay:!1,property:'components.text.material.uniforms.opacity.value',delay:250,dur:750,easing:'easeInOutCubic',from:0,to:1})},update:function(oldData){if(oldData.isSongLoading&&!this.data.isSongLoading){for(let i=0;i<this.textEls.length;i++)this.textEls[i].components.animation__fadein.beginAnimation();this.el.sceneEl.emit('textglownormal',null,!1)}if(!oldData.isSongLoading&&this.data.isSongLoading){for(let i=0;i<this.textEls.length;i++)this.textEls[i].components.text.material.uniforms.opacity.value=0;this.el.sceneEl.emit('textglowoff',null,!1)}}})},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__utils__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_0__utils___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__utils__),CANVAS_HEIGHT=512,HEIGHT=64,NUM_PER_PAGE=6,WIDTH=64,IMAGE_HEIGHT_CANVAS=HEIGHT*(CANVAS_HEIGHT/(HEIGHT*NUM_PER_PAGE));AFRAME.registerComponent('search-thumbnail-atlas',{dependencies:['geometry','material'],schema:{dummyUpdater:{type:'string'}},init:function(){const canvas=this.canvas=document.createElement('canvas');canvas.setAttribute('id','thumbnailAtlasMap'),canvas.height=CANVAS_HEIGHT,canvas.width=WIDTH,this.ctx=canvas.getContext('2d'),this.clearCanvas(),document.body.appendChild(canvas);const alphaCanvas=this.alphaCanvas=document.createElement('canvas');alphaCanvas.setAttribute('id','thumbnailAlphaMap'),alphaCanvas.height=CANVAS_HEIGHT,alphaCanvas.width=WIDTH,this.alphaCtx=alphaCanvas.getContext('2d'),document.body.appendChild(alphaCanvas),this.el.components.material.material.alphaMap=new THREE.CanvasTexture(alphaCanvas),this.el.setAttribute('material','src',canvas),this.images=[],this.lastNumResults=NUM_PER_PAGE},update:function(){var el=this.el;const results=el.sceneEl.systems.state.state.searchResultsPage;for(let i=0,img;i<results.length;i++)img=this.images[i]=this.images[i]||document.createElement('img'),img.crossOrigin='anonymous',img.src=__WEBPACK_IMPORTED_MODULE_0__utils___default.a.getS3FileUrl(results[i].id,'image.jpg'),img.complete?this.draw(img,i):img.onload=()=>{this.draw(img,i)};results.length!==this.lastNumResults&&this.updateAlphaMap(results.length),this.lastNumResults=results.length},draw:function(img,i){this.ctx.drawImage(img,0,i*IMAGE_HEIGHT_CANVAS,WIDTH,IMAGE_HEIGHT_CANVAS),this.el.getObject3D('mesh').material.map.needsUpdate=!0},clearCanvas:function(){const canvas=this.canvas;this.ctx.fillStyle='#111',this.ctx.fillRect(0,0,canvas.width,canvas.height)},updateAlphaMap:function(numResults){const canvas=this.alphaCanvas,ctx=this.alphaCtx;ctx.fillStyle='#FFF',ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle='#000',ctx.fillRect(0,numResults*IMAGE_HEIGHT_CANVAS,canvas.width,canvas.height-numResults*IMAGE_HEIGHT_CANVAS),this.el.getObject3D('mesh').material.alphaMap.needsUpdate=!0,this.el.getObject3D('mesh').material.needsUpdate=!0}})},function(module,exports,__webpack_require__){var algoliasearch=__webpack_require__(45),bindEvent=__webpack_require__(15).bindEvent,client=algoliasearch('QULTOY3ZWU','be07164192471df7e97e6fa70c1d041d'),algolia=client.initIndex('supersaber');AFRAME.registerComponent('search',{init:function(){this.eventDetail={query:'',results:[]},this.popularHits=null,this.queryObject={hitsPerPage:100,query:''},this.search(''),this.queryObject.hitsPerPage=30,this.el.sceneEl.addEventListener('searchclear',()=>{this.search('')})},superkeyboardchange:bindEvent(function(evt){evt.target!==this.el||this.search(evt.detail.value)}),search:function(query){return!query&&this.popularHits?(this.eventDetail.results=this.popularHits,this.eventDetail.query='',void this.el.sceneEl.emit('searchresults',this.eventDetail)):void(this.eventDetail.query=query,this.queryObject.query=query,algolia.search(this.queryObject,(err,content)=>err?(this.el.sceneEl.emit('searcherror',null,!1),void console.error(err)):void(!query&&(this.popularHits=content.hits),this.eventDetail.results=content.hits,this.el.sceneEl.emit('searchresults',this.eventDetail))))}}),AFRAME.registerComponent('search-genre',{init:function(){this.eventDetail={isGenreSearch:!0,genre:'',results:[]},this.queryObject={filters:'',hitsPerPage:100},this.el.addEventListener('click',evt=>{this.search(evt.target.closest('.genre').dataset.bindForKey)})},search:function(genre){this.queryObject.filters='Video Games'===genre?`genre:"Video Game" OR genre:"Video Games"`:`genre:"${genre}"`,algolia.search(this.queryObject,(err,content)=>err?(this.el.sceneEl.emit('searcherror',null,!1),void console.error(err)):void(this.eventDetail.genre=genre,this.eventDetail.results=content.hits,this.el.sceneEl.emit('searchresults',this.eventDetail)))}}),AFRAME.registerComponent('search-result-list',{init:function(){const obv=new MutationObserver(mutations=>{for(let i=0;i<mutations.length;i++)'data-index'===mutations[i].attributeName&&this.refreshLayout()});obv.observe(this.el,{attributes:!0,childList:!1,subtree:!0})},refreshLayout:function(){this.el.emit('layoutrefresh',null,!1)},click:bindEvent(function(evt){this.el.sceneEl.emit('menuchallengeselect',evt.target.closest('.searchResult').dataset.id,!1)})}),AFRAME.registerComponent('search-song-name-selected',{schema:{anchor:{default:0},index:{default:0},offset:{default:0},selectedChallengeId:{default:''}},update:function(){const data=this.data,el=this.el;el.object3D.visible=!!data.selectedChallengeId&&-1!==data.index,el.object3D.position.y=data.index*data.offset+data.anchor}})},function(module,exports,__webpack_require__){var utils=__webpack_require__(2);AFRAME.registerComponent('song-preview-system',{schema:{challengeId:{default:''},debug:{default:!1},isSearching:{default:!1},isSongLoading:{default:!1},selectedChallengeId:{type:'string'}},init:function(){this.analyserEl=document.getElementById('audioAnalyser'),this.audio=document.createElement('audio'),this.audioStore={},this.preloadedAudioIds=[],this.preloadQueue=[]},update:function(oldData){const data=this.data;return!oldData.challengeId&&data.challengeId?void((0===this.analyserEl.components.audioanalyser.volume||1>this.audio.currentTime)&&this.stopSong()):(!oldData.selectedChallengeId||data.selectedChallengeId||data.isSearching||this.stopSong(),oldData.isSongLoading&&!data.isSongLoading?void this.stopSong():void(data.selectedChallengeId&&oldData.selectedChallengeId!==data.selectedChallengeId&&(this.audio&&this.stopSong(),!this.preloadedAudioIds.includes(data.selectedChallengeId)&&data.selectedChallengeId!==this.currentLoadingId&&this.prioritizePreloadSong(),this.playSong(data.selectedChallengeId))))},log:function(str){this.data.debug&&console.log(str)},prioritizePreloadSong:function(){const data=this.data,preloadQueue=this.preloadQueue;this.log(`[song-preview] Prioritizing loading of ${data.selectedChallengeId}`),this.priorityLoadingChallengeId=data.selectedChallengeId,this.audioStore[data.selectedChallengeId].addEventListener('loadeddata',()=>{this.log(`[song-preview] Finished load of priority ${data.selectedChallengeId}`),this.preloadedAudioIds.push(data.selectedChallengeId),this.priorityLoadingChallengeId='',preloadQueue.length&&(this.log(`[song-preview] Resuming queue with ${preloadQueue[0].challengeId}`),this.preloadMetadata(preloadQueue[0]))}),this.audioStore[data.selectedChallengeId].src=utils.getS3FileUrl(data.selectedChallengeId,'song.ogg');for(let i=0;i<preloadQueue.length;i++)if(preloadQueue[i].challengeId===data.selectedChallengeId){preloadQueue.splice(i,1);break}},queuePreloadSong:function(challengeId,previewStartTime){if(!this.audioStore[challengeId]){const audio=document.createElement('audio');audio.crossOrigin='anonymous',audio.dataset.previewStartTime=previewStartTime,this.audioStore[challengeId]=audio;let src=utils.getS3FileUrl(challengeId,'song.ogg');this.currentLoadingId?this.preloadQueue.push({audio:audio,challengeId:challengeId,src:src}):this.preloadMetadata({audio:audio,challengeId:challengeId,src:src})}},preloadMetadata:function(preloadItem){const audio=preloadItem.audio;this.log(`[song-preview] Preloading song preview ${preloadItem.challengeId}`),audio.addEventListener('loadedmetadata',()=>{this.log(`[song-preview] Finished preloading song preview ${preloadItem.challengeId}`),this.preloadedAudioIds.push(preloadItem.challengeId),this.currentLoadingId='',this.log(`[song-preview] ${this.preloadQueue.length} in queue`),this.preloadQueue.length&&!this.priorityLoadingChallengeId&&this.preloadMetadata(this.preloadQueue.shift())}),audio.preload='metadata',audio.src=preloadItem.src,this.currentLoadingId=preloadItem.challengeId},stopSong:function(){this.audio&&(this.audio.paused||this.audio.pause())},playSong:function(challengeId){if(challengeId){this.audio=this.audioStore[challengeId],this.audio.load(),this.audio.volume=0.5,this.audio.currentTime=this.audio.dataset.previewStartTime,this.analyserEl.setAttribute('audioanalyser','src',this.audio);const audioanalyser=this.analyserEl.components.audioanalyser;audioanalyser.resumeContext(),this.audio.play(),audioanalyser.xhr&&audioanalyser.xhr.abort(),audioanalyser.fetchAudioBuffer(utils.getS3FileUrl(challengeId,'song.ogg'))}},clearSong:function(challengeId){let audio=this.audioStore[challengeId];audio.preload='none';let index;for(let i=0;i<this.preloadQueue.length;i++)if(this.preloadQueue[i].id===challengeId){index=i;break}index&&this.preloadQueue.splice(index,1)}}),AFRAME.registerComponent('song-preview',{schema:{challengeId:{type:'string'},previewStartTime:{type:'number'}},update:function(oldData){oldData.challengeId&&this.data.challengeId!==oldData.challengeId&&this.el.sceneEl.components['song-preview-system'].clearSong(oldData.challengeId),this.el.sceneEl.components['song-preview-system'].queuePreloadSong(this.data.challengeId,this.data.previewStartTime)}})},function(){AFRAME.registerComponent('song-progress-ring',{dependencies:['geometry','material'],schema:{enabled:{default:!1}},init:function(){this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),1e3),this.progress=this.el.getObject3D('mesh').material.uniforms.progress,this.el.sceneEl.addEventListener('cleargame',()=>{this.progress.value=0})},update:function(){this.progress.value=0},updateRing:function(){const source=this.el.sceneEl.components.song.source;if(source){const progress=this.el.sceneEl.components.song.getCurrentTime()/source.buffer.duration;this.progress.value=progress}},tick:function(){this.data.enabled&&this.updateRing()}})},function(module,exports,__webpack_require__){const utils=__webpack_require__(2),GAME_OVER_LENGTH=3.5,ONCE={once:!0},BASE_VOLUME=0.75;let skipDebug=AFRAME.utils.getUrlParameter('skip');!skipDebug||(skipDebug=parseInt(skipDebug)/1e3),AFRAME.registerComponent('song',{schema:{analyserEl:{type:'selector',default:'#audioAnalyser'},challengeId:{default:''},isBeatsPreloaded:{default:!1},isGameOver:{default:!1},isPlaying:{default:!1},isVictory:{default:!1}},init:function(){this.analyserSetter={buffer:!0},this.audioAnalyser=this.data.analyserEl.components.audioanalyser,this.context=this.audioAnalyser.context,this.isPlaying=!1,this.songLoadingIndicator=document.getElementById('songLoadingIndicator'),this.songStartTime=0,this.victory=this.victory.bind(this),this.audioAnalyser.gainNode.gain.value=BASE_VOLUME,this.el.addEventListener('gamemenurestart',this.onRestart.bind(this)),this.el.addEventListener('wallhitstart',this.onWallHitStart.bind(this)),this.el.addEventListener('wallhitend',this.onWallHitEnd.bind(this)),!1},update:function(oldData){var data=this.data;return!oldData.isGameOver&&data.isGameOver?void this.onGameOver():(oldData.isGameOver&&!data.isGameOver&&(this.audioAnalyser.gainNode.value=BASE_VOLUME),!oldData.isVictory&&data.isVictory)?(this.data.analyserEl.addEventListener('audioanalyserbuffersource',evt=>{this.audioAnalyser.resumeContext();const gain=this.audioAnalyser.gainNode.gain;gain.cancelScheduledValues(0),gain.setValueAtTime(0.05,0),this.source=evt.detail,this.source.start()},ONCE),void this.audioAnalyser.refreshSource()):(!oldData.isBeatsPreloaded&&this.data.isBeatsPreloaded&&this.source&&this.startAudio(),oldData.challengeId&&!data.challengeId?void this.stopAudio():void(oldData.challengeId!==data.challengeId&&data.challengeId&&(this.el.sceneEl.emit('songloadstart',null,!1),this.getAudio().then(()=>{this.el.sceneEl.emit('songloadfinish',null,!1)}).catch(console.error)),oldData.isPlaying&&!data.isPlaying&&this.audioAnalyser.suspendContext(),!oldData.isPlaying&&data.isPlaying&&this.source&&this.audioAnalyser.resumeContext()))},getAudio:function(){const data=this.data;return this.isPlaying=!1,new Promise(resolve=>(data.analyserEl.addEventListener('audioanalyserbuffersource',evt=>{this.source=evt.detail,resolve(this.source)},ONCE),this.analyserSetter.src=utils.getS3FileUrl(data.challengeId,'song.ogg'),data.analyserEl.setAttribute('audioanalyser',this.analyserSetter),this.audioAnalyser.xhr.response?(this.songLoadingIndicator.setAttribute('material','progress',1),void this.el.sceneEl.emit('songfetchfinish',null,!1)):void this.audioAnalyser.xhr.addEventListener('progress',evt=>{this.onFetchProgress(evt)})))},stopAudio:function(){return this.source?void(this.source.stop(),this.source.disconnect(),this.source=null,this.isPlaying=!1):void console.warn('[song] Tried to stopAudio, but not playing.')},victory:function(){this.data.isPlaying&&this.el.sceneEl.emit('victory',null,!1)},onFetchProgress:function(evt){const progress=evt.loaded/evt.total;this.songLoadingIndicator.setAttribute('material','progress',progress),1<=progress&&this.el.sceneEl.emit('songfetchfinish',null,!1)},onGameOver:function(){this.isPlaying=!1;const playbackRate=this.source.playbackRate;playbackRate.setValueAtTime(playbackRate.value,this.context.currentTime),playbackRate.linearRampToValueAtTime(0,this.context.currentTime+GAME_OVER_LENGTH);const gain=this.audioAnalyser.gainNode.gain;gain.setValueAtTime(gain.value,this.context.currentTime),gain.linearRampToValueAtTime(0,this.context.currentTime+GAME_OVER_LENGTH),setTimeout(()=>{this.data.isGameOver&&this.stopAudio()},3500)},onRestart:function(){this.isPlaying=!1,this.source&&this.source.disconnect();const gain=this.audioAnalyser.gainNode.gain;gain.cancelScheduledValues(0),this.data.analyserEl.addEventListener('audioanalyserbuffersource',evt=>{this.source=evt.detail,this.el.sceneEl.emit('songloadfinish',null,!1)},ONCE),this.audioAnalyser.refreshSource()},onWallHitStart:function(){const gain=this.audioAnalyser.gainNode.gain;gain.linearRampToValueAtTime(0.2,this.context.currentTime+0.1)},onWallHitEnd:function(){const gain=this.audioAnalyser.gainNode.gain;gain.linearRampToValueAtTime(BASE_VOLUME,this.context.currentTime+0.1)},startAudio:function(){const gain=this.audioAnalyser.gainNode.gain;gain.setValueAtTime(BASE_VOLUME,this.context.currentTime),this.songStartTime=this.context.currentTime,this.source.onended=this.victory,this.source.start(0,skipDebug),this.isPlaying=!0},getCurrentTime:function(){return this.context.currentTime-this.songStartTime}})},function(){AFRAME.registerComponent('stage-colors',{dependencies:['background'],schema:{color:{default:'blue',oneOf:['blue','red']}},init:function(){this.colorCodes=['off','blue','blue','bluefade','','red','red','redfade'],this.el.addEventListener('cleargame',this.resetColors.bind(this))},update:function(){this.updateColors(this.data.color)},setColor:function(target,code){this.el.emit(`${target}color${this.colorCodes[code]}`,null,!1)},resetColors:function(){this.updateColors('blue'),this.el.emit('bgcolorblue',null,!1),this.el.emit('tunnelcolorred',null,!1),this.el.emit('floorcolorred',null,!1),this.el.emit('leftlasercolorblue',null,!1),this.el.emit('rightlasercolorblue',null,!1)},updateColors:function(){}})},function(){AFRAME.registerComponent('stage-lasers',{schema:{enabled:{default:!0}},init:function(){this.speed=0,this.lasers=[this.el.children[0].object3D,this.el.children[1].object3D,this.el.children[2].object3D]},pulse:function(speed){this.speed=speed/8},tick:function(time,delta){if(0!==this.speed)return delta/=1e3,!this.data.enabled&&(this.speed*=0.97,0.01>Math.abs(this.speed))?void(this.speed=0):void(this.lasers[0].rotation.z+=this.speed*delta,this.lasers[1].rotation.z-=1.01*(this.speed*delta),this.lasers[2].rotation.z+=1.02*(this.speed*delta))}})},function(){AFRAME.registerShader('stageShader',{schema:{color:{type:'vec3',is:'uniform',default:{x:0,y:0,z:0}},fogColor:{type:'vec3',is:'uniform',default:{x:0,y:0.48,z:0.72}},src:{type:'map',is:'uniform'}},vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    #define FOG_RADIUS  50.0
    #define FOG_FALLOFF 45.0
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 color;
    uniform vec3 fogColor;
    uniform sampler2D src;

    void main() {
      vec4 col = texture2D(src, uvs);
      col.xyz = mix(fogColor, col.xyz, clamp(distance(worldPos, vec3(0., 0., -FOG_RADIUS)) / FOG_FALLOFF, 0., 1.));
      gl_FragColor = col;
    }
  `})},function(){AFRAME.registerComponent('stats-param',{init:function(){'true'===AFRAME.utils.getUrlParameter('stats')&&this.el.setAttribute('stats','')}})},function(){AFRAME.registerComponent('stepback',{init:function(){this.message=document.getElementById('stepback'),this.camera=document.getElementById('camera'),this.lastTime=0,this.limit=-(this.el.getAttribute('geometry').height/2-0.6),this.throttling=300},tick:function(time){if(!(time-this.lastTime<this.throttling)){var camPos=this.camera.object3D.position,msgPos=this.message.object3D.position;camPos.z<this.limit?(this.throttling=20,this.message.object3D.visible=!0,this.message.getObject3D('mesh').material.opacity=1-Math.abs(camPos.z-msgPos.z),msgPos.x=camPos.x,msgPos.y=camPos.y):(this.message.object3D.visible=!1,this.throttling=300),this.lastTime=time}}})},function(){AFRAME.registerComponent('sub-object',{schema:{from:{type:'selector'},name:{type:'string'}},init:function(){var el=this.el,data=this.data;data.from.addEventListener('model-loaded',evt=>{const model=evt.detail.model,subset=model.getObjectByName(data.name);el.setObject3D('mesh',subset.clone()),el.setAttribute('material','shader','flat'),el.emit('subobjectloaded',null,!1)})}})},function(){function findFontChar(chars,code){for(var i=0;i<chars.length;i++)if(chars[i].id===code)return chars[i];return null}var _Mathfloor6=Math.floor,KEYBOARDS={supersaber:{wrapCount:20,inputOffsetY:8e-3,inputOffsetX:0.08,img:'keyboard.png',hoverImg:'keyboard-hover.png',layout:[{key:'1',x:0.014,y:0.024,w:0.094,h:0.183},{key:'2',x:0.108,y:0.024,w:0.094,h:0.183},{key:'3',x:0.203,y:0.024,w:0.095,h:0.183},{key:'4',x:0.299,y:0.024,w:0.094,h:0.183},{key:'5',x:0.394,y:0.024,w:0.093,h:0.183},{key:'6',x:0.487,y:0.024,w:0.095,h:0.183},{key:'7',x:0.583,y:0.024,w:0.093,h:0.183},{key:'8',x:0.677,y:0.024,w:0.095,h:0.183},{key:'9',x:0.772,y:0.024,w:0.093,h:0.183},{key:'0',x:0.866,y:0.024,w:0.093,h:0.183},{key:'q',x:0.014,y:0.215,w:0.094,h:0.183},{key:'w',x:0.108,y:0.215,w:0.094,h:0.183},{key:'e',x:0.203,y:0.215,w:0.095,h:0.183},{key:'r',x:0.299,y:0.215,w:0.094,h:0.183},{key:'t',x:0.394,y:0.215,w:0.093,h:0.183},{key:'y',x:0.487,y:0.215,w:0.095,h:0.183},{key:'i',x:0.677,y:0.215,w:0.095,h:0.183},{key:'u',x:0.583,y:0.215,w:0.093,h:0.183},{key:'o',x:0.772,y:0.215,w:0.093,h:0.183},{key:'p',x:0.866,y:0.215,w:0.093,h:0.183},{key:'a',x:0.063,y:0.405,w:0.094,h:0.183},{key:'s',x:0.158,y:0.405,w:0.094,h:0.183},{key:'d',x:0.253,y:0.405,w:0.095,h:0.183},{key:'f',x:0.349,y:0.405,w:0.094,h:0.183},{key:'g',x:0.443,y:0.405,w:0.093,h:0.183},{key:'h',x:0.537,y:0.405,w:0.095,h:0.183},{key:'j',x:0.633,y:0.405,w:0.092,h:0.183},{key:'k',x:0.726,y:0.405,w:0.095,h:0.183},{key:'l',x:0.821,y:0.405,w:0.093,h:0.183},{key:'z',x:0.111,y:0.598,w:0.093,h:0.181},{key:'x',x:0.205,y:0.598,w:0.095,h:0.181},{key:'c',x:0.301,y:0.598,w:0.095,h:0.181},{key:'v',x:0.396,y:0.598,w:0.093,h:0.181},{key:'b',x:0.49,y:0.598,w:0.094,h:0.181},{key:'n',x:0.585,y:0.598,w:0.094,h:0.181},{key:'m',x:0.68,y:0.598,w:0.093,h:0.181},{key:'Delete',x:0.777,y:0.598,w:0.137,h:0.181},{key:' ',x:0.297,y:0.788,w:0.381,h:0.201},{key:'Escape',x:0.013,y:0.797,w:0.137,h:0.181},{key:'Insert',x:0.014,y:-1e-3,w:0.01,h:5e-3}]}};if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var FontFactors={roboto:17,aileronsemibold:20,dejavu:20.5,exo2bold:20,exo2semibold:20.3,kelsonsans:22.8,monoid:19.5,mozillavr:9.5,sourcecodepro:20.3};AFRAME.registerComponent('super-keyboard',{schema:{align:{default:'left',oneOf:['left','center','right']},blinkingSpeed:{type:'int',default:400},filters:{type:'array'},font:{default:'aileronsemibold'},hand:{type:'selector'},imagePath:{default:'.'},injectToRaycasterObjects:{default:!0},inputColor:{type:'color',default:'#6699ff'},interval:{type:'int',default:50},keyBgColor:{type:'color',default:'#000'},keyColor:{type:'color',default:'#6699ff'},keyHoverColor:{type:'color',default:'#1A407F'},keyPressColor:{type:'color',default:'#5290F6'},label:{type:'string',default:''},labelColor:{type:'color',default:'#aaa'},maxLength:{type:'int',default:0},model:{default:'basic'},show:{default:!0},value:{type:'string',default:''},width:{default:0.8}},init:function(){this.el.addEventListener('click',this.click.bind(this)),this.changeEventDetail={},this.textInputObject={},this.keys=null,this.focused=!1,this.keyHover=null,this.prevCheckTime=null,this.shift=!1,this.rawValue=this.data.value,this.defaultValue=this.data.value,this.userFilterFunc=null,this.intervalId=0,this.kbImg=document.createElement('a-entity'),this.kbImg.classList.add('keyboardRaycastable'),this.kbImg.classList.add('superKeyboardImage'),this.kbImg.addEventListener('raycaster-intersected',this.hover.bind(this)),this.kbImg.addEventListener('raycaster-intersected-cleared',this.blur.bind(this)),this.el.appendChild(this.kbImg),this.label=document.createElement('a-entity'),this.label.setAttribute('text',{align:'center',font:this.data.font,baseline:'bottom',lineHeight:40,shader:'msdf',negate:!0,value:this.data.label,color:this.data.labelColor,width:this.data.width,wrapCount:30}),this.el.appendChild(this.label),this.textInput=document.createElement('a-entity'),this.textInput.setAttribute('mixin','superKeyboardTextInput'),this.textInput.setAttribute('text',{align:this.data.align,font:this.data.font,lineHeight:35,value:this.data.value,color:this.data.inputColor,width:this.data.width,wrapCount:20}),this.el.appendChild(this.textInput),this.cursor=document.createElement('a-entity'),this.cursor.object3D.position.set(0,0,1e-3),this.cursor.setAttribute('material',{shader:'flat',color:this.data.inputColor}),this.textInput.appendChild(this.cursor),this.cursorUpdated=!1,this.keyBgColor=new THREE.Color,this.keyHoverColor=new THREE.Color,this.keyPressColor=new THREE.Color;var self=this;document.addEventListener('keydown',function(ev){if('t'===ev.key){for(var ss='',s='abcdefghijklmopqrstuvQWIEUTGASDLIGKBXACQWETL102394676457',l=_Mathfloor6(20*Math.random()),i=0;i<l;i++)ss+=s[_Mathfloor6(Math.random()*s.length)];self.el.setAttribute('super-keyboard',{value:ss})}}),document.addEventListener('show',this.open.bind(this)),this.hand=null,this.handListenersSet=!1,this.raycaster=null},update:function(oldData){var kbdata=KEYBOARDS[this.data.model],w=this.data.width,h=this.data.width/2;if(void 0===kbdata)return void console.error('super-keyboard ERROR: model "'+this.data.model+'" undefined.');oldData&&this.defaultValue===oldData.defaultValue?this.updateTextInput(this.filter(this.rawValue)):(this.rawValue=this.data.value,this.defaultValue=this.data.value,this.updateTextInput(this.filter(this.data.value))),(this.data.width!==oldData.width||this.data.height!==oldData.height||this.data.keyColor!==oldData.keyColor)&&(this.kbImg.setAttribute('geometry',{primitive:'plane',width:w,height:h}),this.kbImg.setAttribute('material',{shader:'flat',src:this.data.imagePath+'/'+kbdata.img,color:this.data.keyColor,transparent:!0})),(this.data.label!==oldData.label||this.data.labelColor!==oldData.labelColor||this.data.width!==oldData.width)&&(this.label.setAttribute('text',{value:this.data.label,color:this.data.labelColor,width:this.data.width}),this.label.object3D.position.set(0,0.35*w,-0.02)),(this.data.width!==oldData.width||this.data.keyBgColor!==oldData.keyBgColor)&&this.initKeyColorPlane();var inputx='center'===this.data.align?0:kbdata.inputOffsetX*w;'right'===this.data.align&&(inputx*=-1),(this.data.font!==oldData.font||this.data.inputColor!==oldData.inputColor||this.data.width!==oldData.width||this.data.align!==oldData.align)&&this.textInput.setAttribute('text',{font:this.data.font,color:this.data.inputColor,width:w,wrapCount:kbdata.wrapCount,align:this.data.align});for(var i=0,kdata;i<kbdata.layout.length;i++)kdata=kbdata.layout[i],'Insert'===kdata.key&&(this.inputRect=kdata);this.textInput.object3D.position.set(inputx,w/4-(this.inputRect.y+this.inputRect.h/2)*w/2+kbdata.inputOffsetY*w,2e-3),this.data.width!==oldData.width&&this.cursor.setAttribute('geometry',{primitive:'plane',width:0.03*w,height:0.01*w}),this.updateCursorPosition(),this.setupHand(),this.keyBgColor.set(this.data.keyBgColor),this.keyHoverColor.set(this.data.keyHoverColor),this.keyPressColor.set(this.data.keyPressColor),this.data.show?this.open():this.close()},tick:function(time){var intersection;if(!(this.prevCheckTime&&time-this.prevCheckTime<this.data.interval)){if(!this.prevCheckTime)return void(this.prevCheckTime=time);if(this.raycaster&&this.focused&&(intersection=this.raycaster.getIntersection(this.kbImg),!!intersection))for(var uv=intersection.uv,keys=KEYBOARDS[this.data.model].layout,i=0,k;i<keys.length;i++)if(k=keys[i],uv.x>k.x&&uv.x<k.x+k.w&&1-uv.y>k.y&&1-uv.y<k.y+k.h){this.keyHover!==k&&(this.keyHover=k,this.updateKeyColorPlane(this.keyHover.key,this.keyHoverColor));break}}},play:function(){this.cursorUpdated&&this.startBlinking()},pause:function(){this.stopBlinking()},initKeyColorPlane:function(){var kbdata=KEYBOARDS[this.data.model],keyColorPlane=this.keyColorPlane=document.createElement('a-entity');keyColorPlane.classList.add('superKeyboardKeyColorPlane'),keyColorPlane.object3D.position.z=1e-3,keyColorPlane.object3D.visible=!1,keyColorPlane.setAttribute('geometry',{primitive:'plane',buffer:!1}),keyColorPlane.setAttribute('material',{shader:'flat',color:this.data.keyBgColor,transparent:!0}),kbdata.hoverImg&&keyColorPlane.setAttribute('material',{src:this.data.imagePath+'/'+kbdata.hoverImg}),keyColorPlane.addEventListener('componentinitialized',function(evt){'material'===evt.detail.name&&(kbdata.hoverImg||(this.getObject3D('mesh').material.blending=THREE.AdditiveBlending))}),this.el.appendChild(keyColorPlane)},updateKeyColorPlane:function(key,color){var kbdata=KEYBOARDS[this.data.model],keyColorPlane=this.keyColorPlane;if(!key)return void(keyColorPlane.object3D.visible=!1);for(var i=0,kdata;i<kbdata.layout.length;i++)if(kdata=kbdata.layout[i],kdata.key===key){var w=this.data.width,h=this.data.width/2,keyw=kdata.w*w,keyh=kdata.h*h;keyColorPlane.object3D.scale.x=keyw,keyColorPlane.object3D.scale.y=keyh,keyColorPlane.object3D.position.x=kdata.x*w-w/2+keyw/2,keyColorPlane.object3D.position.y=(1-kdata.y)*h-h/2-keyh/2,keyColorPlane.getObject3D('mesh').material.color.copy(color);var geometry=keyColorPlane.getObject3D('mesh').geometry,uvSet=geometry.faceVertexUvs[0],kdataY=1-kdata.y;uvSet[0][0].set(kdata.x,kdataY),uvSet[0][1].set(kdata.x,kdataY-kdata.h),uvSet[0][2].set(kdata.x+kdata.w,kdataY),uvSet[1][0].set(kdata.x,kdataY-kdata.h),uvSet[1][1].set(kdata.x+kdata.w,kdataY-kdata.h),uvSet[1][2].set(kdata.x+kdata.w,kdataY),geometry.uvsNeedUpdate=!0;break}keyColorPlane.object3D.visible=!0},setupHand:function(){if(this.hand&&this.hand.ownRaycaster&&this.hand.removeAttribute('raycaster'),this.hand=this.data.hand?this.data.hand:document.querySelector(['[cursor]','[vive-controls]','[tracked-controls]','[oculus-touch-controls]','[windows-motion-controls]','[hand-controls]','[daydream-controls] [cursor] > [raycaster]'].join(',')),!this.hand)console.error('super-keyboard: no controller found. Add <a-entity> with controller or specify with super-keyboard="hand: #selectorToController".');else{if(!this.hand.hasLoaded)return void this.hand.addEventListener('loaded',this.setupHand.bind(this));var raycaster=this.hand.components.raycaster,params={};if(!raycaster)this.hand.ownRaycaster=!0,params.showLine=this.data.show,params.enabled=this.data.show,this.data.injectToRaycasterObjects&&(params.objects='.keyboardRaycastable'),this.hand.setAttribute('raycaster',params);else if(this.hand.ownRaycaster=!1,this.data.injectToRaycasterObjects){var objs=raycaster.data.objects.split(',');-1===objs.indexOf('.keyboardRaycastable')&&objs.push('.keyboardRaycastable'),params.objects=objs.join(',').replace(/^,/,''),this.hand.setAttribute('raycaster',params)}this.raycaster=this.hand.components.raycaster}},filter:function(str){if(''===str)return'';for(var i=0;i<this.data.filters.length;i++)switch(this.data.filters[i]){case'custom':{this.userFilterFunc&&(str=this.userFilterFunc(str));break}case'allupper':{str=str.toUpperCase();break}case'alllower':{str=str.toLowerCase();break}case'title':{str=str.split(' ').map(function(s){return s[0].toUpperCase()+s.substr(1)}).join(' ');break}case'numbers':{str=str.split('').filter(function(c){return!isNaN(parseInt(c))||'.'===c}).join('');break}case'first':{str=str[0].toUpperCase()+str.substr(1);break}case'trim':{str=str.trim();break}}return 0<this.data.maxLength?str.substr(0,this.data.maxLength):str},click:function(){if(this.keyHover){switch(this.keyHover.key){case'Enter':{this.accept();break}case'Insert':return;case'Delete':{this.rawValue=this.rawValue.substr(0,this.rawValue.length-1);var newValue=this.filter(this.rawValue);this.el.setAttribute('super-keyboard','value',newValue),this.updateTextInput(newValue),this.changeEventDetail.value=newValue,this.el.emit('superkeyboardchange',this.changeEventDetail);break}case'Shift':{this.shift=!this.shift,this.keyHover.el.setAttribute('material','color',this.shift?this.data.keyHoverColor:this.data.keyBgColor);break}case'Escape':{this.dismiss();break}default:{if(0<this.data.maxLength&&this.rawValue.length>this.data.maxLength)break;this.rawValue+=this.shift?this.keyHover.key.toUpperCase():this.keyHover.key;var newValue=this.filter(this.rawValue);this.el.setAttribute('super-keyboard','value',newValue),this.updateTextInput(newValue),this.changeEventDetail.value=newValue,this.el.emit('superkeyboardchange',this.changeEventDetail);break}}this.updateKeyColorPlane(this.keyHover.key,this.keyPressColor);var self=this;setTimeout(function(){self.updateKeyColorPlane(self.keyHover.key,self.keyHoverColor)},100),this.updateCursorPosition()}},open:function(){this.el.object3D.visible=!0,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!0,enabled:!0})},close:function(){this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!1,enabled:!1})},accept:function(){this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!1,enabled:!1}),this.el.emit('superkeyboardinput',{value:this.data.value}),this.data.show=!1},dismiss:function(){this.data.value=this.defaultValue,this.updateTextInput(),this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!1,enabled:!1}),this.el.emit('superkeyboarddismiss'),this.data.show=!1},blur:function(){this.focused=!1,this.keyHover&&'Shift'!==this.keyHover.key&&this.updateKeyColorPlane(this.keyHover.key,this.keyBgColor),this.keyHover=null},hover:function(){this.focused=!0},startBlinking:function(){this.stopBlinking(),this.intervalId=window.setInterval(this.blink.bind(this),this.data.blinkingSpeed)},stopBlinking:function(){window.clearInterval(this.intervalId),this.intervalId=0},blink:function(){this.cursor.object3D.visible=!this.cursor.object3D.visible},setCustomFilter:function(f){this.userFilterFunc=f},addCustomModel:function(name,model){name&&(KEYBOARDS[name]=model)},updateCursorPosition:function(){var font=this.textInput.components.text.currentFont;if(!font){var self=this;return this.cursor.object3D.visible=!1,void window.setTimeout(function(){self.updateCursorPosition(),self.startBlinking()},700)}var w=this.data.width,kbdata=KEYBOARDS[this.data.model],posy=-this.inputRect.h/2*w/2.4+kbdata.inputOffsetY*w,ratio=this.data.width/this.textInput.components.text.data.wrapCount,pos=0,fontFactor=FontFactors[this.textInput.components.text.data.font];fontFactor===void 0&&(fontFactor=20);for(var i=0,char;i<this.data.value.length;i++)char=findFontChar(font.chars,this.data.value.charCodeAt(i)),pos+=char.width+char.xadvance*(32===char.id?2:1);'center'===this.data.align?pos=0.0011*(pos*ratio*fontFactor)/2+0.02*w:'left'===this.data.align?(pos=0.0011*(pos*ratio*fontFactor)+0.02*w,pos-=w/2):'right'===this.data.align&&(pos=0.0011*(-pos*ratio*fontFactor)-0.02*w,pos+=w/2),this.cursor.object3D.position.set(pos,posy,1e-3),this.cursorUpdated=!0},updateTextInput:function(value){this.textInputObject.value=value||this.data.value,this.textInput.setAttribute('text',this.textInputObject)}})},function(){AFRAME.registerShader('superCutFxShader',{schema:{startTime:{type:'float',is:'uniform'},timems:{type:'time',is:'uniform'}},vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
  `,fragmentShader:`
    uniform float startTime;
    uniform float timems;
    varying vec2 uvs;
    varying vec3 worldPos;

    #define COLOR vec3(0, 0.67, 0.98)

    void main() {
      float time = (timems - startTime) / 2000.0;
      vec2 p = uvs.xy - 0.5;
      float r = p.x * p.x + p.y * p.y;
      float alpha = 1.0 - smoothstep(time - 0.01, time, r);
      alpha *= smoothstep(time - 0.1, time, r);
      alpha *= 1.0 - time * 5.5;
      gl_FragColor = vec4(COLOR, alpha);
    }
  `})},function(){AFRAME.registerComponent('supercutfx',{init:function(){this.startTime=-1100},createSuperCut:function(position){const mesh=this.el.getObject3D('mesh');this.el.object3D.position.copy(position),this.el.object3D.position.z=-1,this.el.object3D.visible=!0,this.startTime=this.el.sceneEl.time,mesh.material.uniforms.startTime.value=this.startTime-50,this.el.play()},tick:function(time){time>this.startTime+1e3&&(this.el.object3D.visible=!1,this.el.pause())}})},function(){AFRAME.registerComponent('text-counter',{dependencies:['text'],schema:{decimals:{default:0},dur:{default:2e3,type:'int'},enabled:{default:!1},emit:{default:!1},prefix:{default:''},suffix:{default:''},value:{default:0,type:'float'}},init:function(){this.currentValue=0,this.hasCompleted=!1,this.textValue={value:''}},update:function(){this.currentValue=0,this.textValue.value=`${this.data.prefix}${this.decimals(0)}${this.data.suffix}`,this.el.setAttribute('text',this.textValue),this.hasCompleted=!1},tick:function(time,timeDelta){!this.data.enabled||this.hasCompleted||(this.currentValue+=this.data.value*(timeDelta/this.data.dur),this.currentValue>=this.data.value&&(this.currentValue=this.data.value,this.data.emit&&this.el.emit('textcounterdone',null,!1),this.hasCompleted=!0),this.textValue.value=`${this.data.prefix}${this.decimals(this.currentValue)}${this.data.suffix}`,this.el.setAttribute('text',this.textValue))},decimals:function(n){var d=Math.pow(10,this.data.decimals);return(parseInt(n*d)/d).toFixed(this.data.decimals)}})},function(){AFRAME.registerComponent('text-uppercase',{schema:{value:{type:'string'}},update:function(){this.el.setAttribute('text','value',this.data.value.toUpperCase())}})},function(){AFRAME.registerComponent('toggle-pause-play',{schema:{isPlaying:{default:!1}},update:function(){const action=this.data.isPlaying?'pause':'play';parent.postMessage(JSON.stringify({verify:'game-action',action}),'*')}})},function(){AFRAME.registerComponent('trail',{schema:{color:{type:'color'},enabled:{default:!1},hand:{type:'string'}},init:function(){var geometry=this.geometry=new THREE.BufferGeometry,maxPoints=this.maxPoints=12,vertices=this.vertices=new Float32Array(36*maxPoints),colors=this.colors=new Float32Array(48*maxPoints),bladeColor=this.bladeColor=new THREE.Color(this.data.color);this.bladeColor={red:bladeColor.r,green:bladeColor.g,blue:bladeColor.b,alpha:1},this.saberEl=this.el.querySelector('.blade'),this.layers=0,this.saberTrajectory=[{top:new THREE.Vector3(-0.5,0,0),center:new THREE.Vector3(0,0,0),bottom:new THREE.Vector3(0.5,0,0)},{top:new THREE.Vector3(-0.5,0.5,0),center:new THREE.Vector3(0,0.5,0),bottom:new THREE.Vector3(0.5,0.5,0)},{top:new THREE.Vector3(-0.5,1,0),center:new THREE.Vector3(0,1,0),bottom:new THREE.Vector3(0.5,1,0)}],geometry.addAttribute('position',new THREE.BufferAttribute(vertices,3).setDynamic(!0)),geometry.addAttribute('vertexColor',new THREE.BufferAttribute(colors,4).setDynamic(!0));const material=new THREE.ShaderMaterial({side:THREE.DoubleSide,vertexColors:THREE.VertexColors,transparent:!0,blending:THREE.AdditiveBlending,vertexShader:['varying vec4 vColor;','attribute vec4 vertexColor;','void main() {','vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);','vColor = vertexColor;','gl_Position = projectionMatrix * modelViewPosition;','}'].join(''),fragmentShader:['varying vec4 vColor;','void main() {','gl_FragColor = vColor;','}'].join('')}),mesh=this.mesh=new THREE.Mesh(geometry,material);mesh.frustumCulled=!1,mesh.vertices=vertices,this.el.sceneEl.setObject3D(`trail__${this.data.hand}`,mesh)},update:function(oldData){!oldData.enabled&&this.data.enabled&&(this.enabledTime=this.el.sceneEl.time,this.mesh.visible=!1),oldData.enabled&&!this.data.enabled&&(this.mesh.visible=!1)},tock:function(time){this.data.enabled&&(!this.mesh.visible&&time>this.enabledTime+250&&(this.mesh.visible=!0),this.sampleSaberPosition())},addLayer:function(length){var startX=-1,segments=this.segments,dx=2/segments,colors=this.colors,vertices=this.vertices,color=this.bladeColor;this.layers>=this.maxLayers&&(this.layers=0);const bottomLayer=this.layers*length;length=bottomLayer+length;const indexOffset=18*(this.layers*segments),colorOffset=24*(this.layers*segments);for(var i=0;i<segments;++i)vertices[indexOffset+18*i]=startX+i*dx,vertices[indexOffset+18*i+1]=bottomLayer,vertices[indexOffset+18*i+2]=0,colors[colorOffset+24*i]=color.red,colors[colorOffset+24*i+1]=color.green,colors[colorOffset+24*i+2]=color.blue,colors[colorOffset+24*i+3]=color.alpha,vertices[indexOffset+18*i+3]=startX+i*dx,vertices[indexOffset+18*i+4]=length,vertices[indexOffset+18*i+5]=0,colors[colorOffset+24*i+4]=color.red,colors[colorOffset+24*i+5]=color.green,colors[colorOffset+24*i+6]=color.blue,colors[colorOffset+24*i+7]=color.alpha,vertices[indexOffset+18*i+6]=startX+i*dx+dx,vertices[indexOffset+18*i+7]=length,vertices[indexOffset+18*i+8]=0,colors[colorOffset+24*i+8]=color.red,colors[colorOffset+24*i+9]=color.green,colors[colorOffset+24*i+10]=color.blue,colors[colorOffset+24*i+11]=color.alpha,vertices[indexOffset+18*i+9]=startX+i*dx+dx,vertices[indexOffset+18*i+10]=bottomLayer,vertices[indexOffset+18*i+11]=0,colors[colorOffset+24*i+12]=color.red,colors[colorOffset+24*i+13]=color.green,colors[colorOffset+24*i+14]=color.blue,colors[colorOffset+24*i+15]=color.alpha,vertices[indexOffset+18*i+12]=startX+i*dx,vertices[indexOffset+18*i+13]=bottomLayer,vertices[indexOffset+18*i+14]=0,colors[colorOffset+24*i+16]=color.red,colors[colorOffset+24*i+17]=color.green,colors[colorOffset+24*i+18]=color.blue,colors[colorOffset+24*i+19]=color.alpha,vertices[indexOffset+18*i+15]=startX+i*dx+dx,vertices[indexOffset+18*i+16]=length,vertices[indexOffset+18*i+17]=0,colors[colorOffset+24*i+20]=color.red,colors[colorOffset+24*i+21]=color.green,colors[colorOffset+24*i+22]=color.blue,colors[colorOffset+24*i+23]=color.alpha;this.layers++,this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.vertexColor.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0},initGeometry:function(){var saberTrajectory=this.saberTrajectory,vertices=this.geometry.attributes.position.array,colors=this.geometry.attributes.vertexColor.array,color=this.bladeColor,i,previousPoint,currentPoint,alpha,previousAlpha;for(i=1;i<saberTrajectory.length;i++)1===i&&(previousAlpha=alpha),alpha=1-(saberTrajectory.length-i)/saberTrajectory.length,currentPoint=saberTrajectory[i],previousPoint=saberTrajectory[i-1],vertices[36*i]=previousPoint.center.x,vertices[36*i+1]=previousPoint.center.y,vertices[36*i+2]=previousPoint.center.z,colors[48*i]=color.red,colors[48*i+1]=color.green,colors[48*i+2]=color.blue,colors[48*i+3]=0.2*previousAlpha,vertices[36*i+3]=currentPoint.top.x,vertices[36*i+4]=currentPoint.top.y,vertices[36*i+5]=currentPoint.top.z,colors[48*i+4]=color.red,colors[48*i+5]=color.green,colors[48*i+6]=color.blue,colors[48*i+7]=alpha,vertices[36*i+6]=previousPoint.top.x,vertices[36*i+7]=previousPoint.top.y,vertices[36*i+8]=previousPoint.top.z,colors[48*i+8]=color.red,colors[48*i+9]=color.green,colors[48*i+10]=color.blue,colors[48*i+11]=previousAlpha,vertices[36*i+9]=previousPoint.center.x,vertices[36*i+10]=previousPoint.center.y,vertices[36*i+11]=previousPoint.center.z,colors[48*i+12]=color.red,colors[48*i+13]=color.green,colors[48*i+14]=color.blue,colors[48*i+15]=0.2*previousAlpha,vertices[36*i+12]=currentPoint.center.x,vertices[36*i+13]=currentPoint.center.y,vertices[36*i+14]=currentPoint.center.z,colors[48*i+16]=color.red,colors[48*i+17]=color.green,colors[48*i+18]=color.blue,colors[48*i+19]=0.2*alpha,vertices[36*i+15]=currentPoint.top.x,vertices[36*i+16]=currentPoint.top.y,vertices[36*i+17]=currentPoint.top.z,colors[48*i+20]=color.red,colors[48*i+21]=color.green,colors[48*i+22]=color.blue,colors[48*i+23]=alpha,vertices[36*i+18]=previousPoint.bottom.x,vertices[36*i+19]=previousPoint.bottom.y,vertices[36*i+20]=previousPoint.bottom.z,colors[48*i+24]=color.red,colors[48*i+25]=color.green,colors[48*i+26]=color.blue,colors[48*i+27]=0,vertices[36*i+21]=currentPoint.center.x,vertices[36*i+22]=currentPoint.center.y,vertices[36*i+23]=currentPoint.center.z,colors[48*i+28]=color.red,colors[48*i+29]=color.green,colors[48*i+30]=color.blue,colors[48*i+31]=0.2*alpha,vertices[36*i+24]=previousPoint.center.x,vertices[36*i+25]=previousPoint.center.y,vertices[36*i+26]=previousPoint.center.z,colors[48*i+32]=color.red,colors[48*i+33]=color.green,colors[48*i+34]=color.blue,colors[48*i+35]=0.2*previousAlpha,vertices[36*i+27]=previousPoint.bottom.x,vertices[36*i+28]=previousPoint.bottom.y,vertices[36*i+29]=previousPoint.bottom.z,colors[48*i+36]=color.red,colors[48*i+37]=color.green,colors[48*i+38]=color.blue,colors[48*i+39]=0,vertices[36*i+30]=currentPoint.bottom.x,vertices[36*i+31]=currentPoint.bottom.y,vertices[36*i+32]=currentPoint.bottom.z,colors[48*i+40]=color.red,colors[48*i+41]=color.green,colors[48*i+42]=color.blue,colors[48*i+43]=0,vertices[36*i+33]=currentPoint.center.x,vertices[36*i+34]=currentPoint.center.y,vertices[36*i+35]=currentPoint.center.z,colors[48*i+44]=color.red,colors[48*i+45]=color.green,colors[48*i+46]=color.blue,colors[48*i+47]=0.2*alpha,previousAlpha=alpha;this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.vertexColor.needsUpdate=!0},sampleSaberPosition:function(){var saberEl=this.saberEl,saberObject,sample;this.saberTrajectory.length===this.maxPoints?(sample=this.saberTrajectory.shift(),sample.top.set(0,-0.4,0),sample.center.set(0,0,0),sample.bottom.set(0,0.4,0)):sample={top:new THREE.Vector3(0,-0.4,0),center:new THREE.Vector3(0,0,0),bottom:new THREE.Vector3(0,0.4,0)},saberObject=saberEl.object3D,saberObject.parent.updateMatrixWorld(),saberObject.localToWorld(sample.top),saberObject.localToWorld(sample.center),saberObject.localToWorld(sample.bottom),this.saberTrajectory.push(sample),this.initGeometry()}})},function(){AFRAME.registerComponent('tutorial-2d',{init:function(){this.el.sceneEl.canvas.style.display='none'},play:function(){this.el.sceneEl.canvas.style.display='block',document.getElementById('tutorial2d').style.display='none'}})},function(){var _Mathabs=Math.abs;const NUM_VALUES_PER_SEGMENT=75;AFRAME.registerComponent('twister',{schema:{enabled:{default:!1},twist:{default:0},vertices:{default:4,type:'int'},count:{default:12,type:'int'},positionIncrement:{default:1.4},radiusIncrement:{default:0.4},thickness:{default:0.37}},init:function(){this.currentTwist=0,this.animate=!1,this.geometry=null},pulse:function(twist){this.data.enabled&&(twist=0==twist?0.03+0.25*Math.random():Math.min(0.4*twist,0.4),twist*=0.5>Math.random()?-1:1,this.el.setAttribute('twister',{twist:twist}))},update:function(){var radius=6,segments=[];if(1e-3<_Mathabs(this.data.twist-this.currentTwist))return void(this.animate=!0);this.clear();for(var i=0;i<this.data.count;i++){let segment=this.createSegment(radius);segment.translate(0,this.data.positionIncrement*i,0),segments.push(segment),radius+=this.data.radiusIncrement}this.geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(segments);var material=this.el.sceneEl.systems.materials.stageNormal,mesh=new THREE.Mesh(this.geometry,material);this.el.object3D.add(mesh)},createSegment:function(radius){const R=this.data.thickness;var points=[new THREE.Vector2(radius-R,R),new THREE.Vector2(radius-R,-R),new THREE.Vector2(radius+R,-R),new THREE.Vector2(radius+R,R),new THREE.Vector2(radius-R,R)],geometry;geometry=new THREE.LatheBufferGeometry(points,this.data.vertices);for(let i=0;i<geometry.attributes.uv.array.length;i+=2)geometry.attributes.uv.array[i]=0.77,geometry.attributes.uv.array[i+1]=1e-3;return geometry},clear:function(){this.el.object3D.remove(this.el.object3D.children[0]),this.geometry&&this.geometry.dispose(),this.geometry=new THREE.BufferGeometry},tick:function(time,delta){if(this.animate){var posArray=this.geometry.attributes.position.array,rotation,x,y,sin,cos,diff;delta*=1e-3,diff=(this.data.twist-this.currentTwist)*delta,this.currentTwist+=diff,rotation=3*diff;for(var s=0;s<this.data.count;s++){for(var i=0;i<NUM_VALUES_PER_SEGMENT;i+=3)cos=Math.cos(rotation),sin=Math.sin(rotation),x=posArray[s*NUM_VALUES_PER_SEGMENT+i],y=posArray[s*NUM_VALUES_PER_SEGMENT+i+2],posArray[s*NUM_VALUES_PER_SEGMENT+i]=x*cos-y*sin,posArray[s*NUM_VALUES_PER_SEGMENT+i+2]=y*cos+x*sin;rotation*=1.05}this.geometry.attributes.position.needsUpdate=!0,1e-3>_Mathabs(this.data.twist-this.currentTwist)&&(this.animate=!1)}}})},function(){var colorHelper=new THREE.Color;AFRAME.registerComponent('vertex-colors-buffer',{schema:{baseColor:{type:'color'},itemSize:{default:3}},update:function(oldData){var data=this.data,el=this.el,self=this,colors,i,geometry,mesh;if(mesh=this.el.getObject3D('mesh'),!mesh||!mesh.geometry)return void el.addEventListener('object3dset',function reUpdate(evt){'mesh'!==evt.detail.type||(el.removeEventListener('object3dset',reUpdate),self.update(oldData))});if(geometry=mesh.geometry,!geometry.attributes.position)return void console.warn('Geometry has no vertices',el);for(geometry.attributes.color||geometry.addAttribute('color',new THREE.BufferAttribute(new Float32Array(geometry.attributes.position.array.length),3)),colors=geometry.attributes.color.array,colorHelper.set(data.baseColor),i=0;i<colors.length;i+=data.itemSize)colors[i]=colorHelper.r,colors[i+1]=colorHelper.g,colors[i+2]=colorHelper.b;geometry.attributes.color.needsUpdate=!0}})},function(){AFRAME.registerComponent('victory-accuracy-ring',{dependencies:['geometry','material'],schema:{accuracy:{default:0}},update:function(){this.el.getObject3D('mesh').material.uniforms.progress.value=0,this.el.setAttribute('animation','to',this.data.accuracy/100),this.el.components.animation.beginAnimation()}})},function(){AFRAME.registerComponent('victory-rank',{schema:{rank:{type:'string'}},update:function(){const rank=this.data.rank;if(rank)switch(this.el.setAttribute('text','value',rank),rank[0]){case'S':{this.setColor('#FFF');break}case'A':{this.setColor('#c2d076');break}case'B':{this.setColor('#23f0c7');break}case'C':{this.setColor('#ffe347');break}case'D':{this.setColor('#ce6c47');break}case'F':{this.setColor('#960200');break}}},setColor:function(color){this.el.setAttribute('text','color',color)}})},function(){AFRAME.registerComponent('visible-raycastable',{schema:{default:!0},update:function(){this.el.object3D.visible=this.data,this.data?this.el.setAttribute('raycastable',''):this.el.removeAttribute('raycastable','')}})},function(module,exports,__webpack_require__){const COLORS=__webpack_require__(7),WALL_COLOR=new THREE.Color(COLORS.NEON_RED),WALL_BG=new THREE.Color(COLORS.SKY_RED);AFRAME.registerShader('wallShader',{schema:{iTime:{type:'time',is:'uniform'},hitRight:{type:'vec3',is:'uniform',default:{x:0,y:1,z:0}},hitLeft:{type:'vec3',is:'uniform',default:{x:0,y:0,z:0}}},vertexShader:`
    varying vec2 uvs;
    varying vec3 nrml;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      nrml.xyz = normal.xyz;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    varying vec2 uvs;
    varying vec3 nrml;
    varying vec3 worldPos;
    uniform float iTime;
    //uniform sampler2D env;
    uniform vec3 hitRight;
    uniform vec3 hitLeft;

    #define SEED 19.1254
    #define time (3.0 + iTime)/1000.0 * 0.15

    float noise(vec3 uv) {
      return fract(sin(uv.x*123243. + uv.y*424. + uv.z*642. + SEED) * 1524.);
    }

    vec3 drawCircle(vec3 p, vec3 center, float radius, float edgeWidth, vec3 color) {
      return color * (1.0 - smoothstep(radius, radius + edgeWidth, length(p - center)));
    }

    float smoothNoise(vec3 uvw, float frec){
      vec3 luvw = vec3(smoothstep(0.0, 1.0, fract(uvw.xy * frec)), fract(uvw.z * frec));
      vec3 id = floor(uvw * frec);
      float blt = noise(id);
      float brt = noise(id + vec3(1.0, 0.0, 0.0));
      float tlt = noise(id + vec3(0.0, 1.0, 0.0));
      float trt = noise(id + vec3(1.0, 1.0, 0.0));

      float blb = noise(id + vec3(0.0, 0.0, 1.0));
      float brb = noise(id + vec3(1.0, 0.0, 1.0));
      float tlb = noise(id + vec3(0.0, 1.0, 1.0));
      float trb = noise(id + vec3(1.0, 1.0, 1.0));

      float a = mix(blt, brt, luvw.x);
      float b = mix(tlt, trt, luvw.x);
      float c = mix(a, b, luvw.y);

      float d = mix(blb, brb, luvw.x);
      float e = mix(tlb, trb, luvw.x);
      float f = mix(d, e, luvw.y);

      return mix(c, f, luvw.z);
    }

    #define WALL_COLOR vec3(${WALL_COLOR.r}, ${WALL_COLOR.g}, ${WALL_COLOR.b})
    #define WALL_BG vec3(${WALL_BG.r}, ${WALL_BG.g}, ${WALL_BG.b})

    void main() {
      vec2 uv1 = uvs.xy-0.5;
      float angle = time / 10.0;
      vec2 uv;
      uv.x = uv1.x * cos(angle) - uv1.y * sin(angle);
      uv.y = uv1.y * cos(angle) + uv1.x * sin(angle);
      uv.x += sin(uv.y * 2.7 + time / 1.7) * 0.2;
      uv.y += sin(uv.x * 3.1 + time / 2.4) * 0.3;

      float w, r, bg;
      r = smoothNoise(vec3(uv + worldPos.x, time / 2.0), 3.0) * 0.65;
      r += smoothNoise(vec3(uv, time / 6.0), 8.0) * 0.3;
      r += smoothNoise(vec3(uv, time / 14.0), 50.0) * 0.04;

      bg = smoothstep(0.5, 1.0, r) + smoothstep(0.5, 0.0, r);
      r = smoothstep(0.4, 0.50, r) - smoothstep(0.50, 0.6, r);
      w = smoothstep(0.97, 1.0, r);


      r += smoothstep(0.44, 0.50, abs(uv1.x));
      r += smoothstep(0.44, 0.50, abs(uv1.y));

      w += smoothstep(0.49, 0.498, abs(uv1.x));
      w += smoothstep(0.49, 0.498, abs(uv1.y));

      w *= 0.9;
      bg *= 0.5;

      vec3 COL = WALL_COLOR;
      vec3 BG = WALL_BG * 0.1;

      vec3 col = vec3(r * COL.r + w + BG.r, r * COL.g + w + BG.g, r * COL.b + w + BG.b);

      vec3 hit;
      hit = drawCircle(worldPos, hitRight, 0.04, 0.05, COL);
      hit += drawCircle(worldPos, hitRight, 0.02, 0.03, vec3(0.7, 0.7, 0.7));
      hit += drawCircle(worldPos, hitLeft, 0.04, 0.05, COL);
      hit += drawCircle(worldPos, hitLeft, 0.02, 0.03, vec3(0.7, 0.7, 0.7));

      gl_FragColor = vec4(col + hit, 0.7 + w + hit.x);
    }
`})},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__constants_beat__=__webpack_require__(10);const CEILING_THICKNESS=1.5;AFRAME.registerComponent('wall',{schema:{anticipationPosition:{default:0},durationSeconds:{default:0},height:{default:1.3},horizontalPosition:{default:'middleleft',oneOf:['left','middleleft','middleright','right']},isCeiling:{default:!1},speed:{default:1},warmupPosition:{default:0},width:{default:1}},horizontalPositions:{left:-0.75,middleleft:-0.25,middleright:0.25,right:0.75},init:function(){this.maxZ=10},update:function(){const el=this.el,data=this.data,width=data.width*0.5,halfDepth=data.durationSeconds*data.speed/2;return data.isCeiling?(el.object3D.position.set(0,1.4+CEILING_THICKNESS/2,data.anticipationPosition+data.warmupPosition-halfDepth),void el.object3D.scale.set(width,CEILING_THICKNESS,data.durationSeconds*data.speed)):void(el.object3D.position.set(this.horizontalPositions[data.horizontalPosition]+width/2-0.25,data.height+0.1,data.anticipationPosition+data.warmupPosition-halfDepth),el.object3D.scale.set(width,2.5,data.durationSeconds*data.speed))},pause:function(){this.el.object3D.visible=!1,this.el.removeAttribute('data-collidable-head')},play:function(){this.el.object3D.visible=!0,this.el.setAttribute('data-collidable-head',''),this.el.setAttribute('data-saber-particles',''),this.el.setAttribute('raycastable-game','')},tock:function(time,timeDelta){const data=this.data,halfDepth=data.durationSeconds*data.speed/2,position=this.el.object3D.position;if(position.z<data.anticipationPosition-halfDepth){let newPositionZ=position.z+__WEBPACK_IMPORTED_MODULE_0__constants_beat__.a*(timeDelta/1e3);position.z=newPositionZ<data.anticipationPosition-halfDepth?newPositionZ:data.anticipationPosition-halfDepth}else position.z+=this.data.speed*(timeDelta/1e3);return this.el.object3D.position.z>this.maxZ+halfDepth?void this.returnToPool():void 0},returnToPool:function(){this.el.sceneEl.components.pool__wall.returnEntity(this.el),this.el.object3D.position.z=9999,this.el.pause(),this.el.removeAttribute('data-collidable-head'),this.el.removeAttribute('raycastable-game')}})},function(module){module.exports=[{name:'Pop',row:1,column:1},{name:'R&B',row:1,column:2},{name:'Rap',row:1,column:3},{name:'Rock',row:1,column:4},{name:'Soundtrack',row:1,column:5},{name:'Video Games',row:1,column:6},{name:'Electronic',row:2,column:1},{name:'Hip Hop',row:2,column:2},{name:'House',row:2,column:3},{name:'J-Pop',row:2,column:4},{name:'K-Pop',row:2,column:5},{name:'Meme',row:2,column:6},{name:'Alternative',row:3,column:1},{name:'Anime',row:3,column:2},{name:'Comedy',row:3,column:3},{name:'Disney',row:3,column:4},{name:'Dubstep',row:3,column:5},{name:'EDM',row:3,column:6}]},function(module,exports,__webpack_require__){function requireAll(req){req.keys().forEach(req)}__webpack_require__(12),__webpack_require__(20),__webpack_require__(11),__webpack_require__(21),__webpack_require__(22),__webpack_require__(23),__webpack_require__(24),__webpack_require__(25),__webpack_require__(26),__webpack_require__(27),__webpack_require__(28),__webpack_require__(30),__webpack_require__(29),__webpack_require__(31),requireAll(__webpack_require__(33)),requireAll(__webpack_require__(34)),__webpack_require__(32)},function(module){module.exports=function SoundPool(src,volume){var currSound=0,pool=[],sound;return sound=new Audio(src),sound.volume=volume,pool.push(sound),{play:function(){0===pool[currSound].currentTime&&pool[currSound].ended||(sound=new Audio(src),sound.volume=volume,pool.push(sound),currSound++),(0===pool[currSound].currentTime||pool[currSound].ended)&&pool[currSound].play(),currSound=(currSound+1)%pool.length}}}},function(module,exports,__webpack_require__){function computeSearchPagination(state){let numPages=_Mathceil(state.search.results.length/SEARCH_PER_PAGE);state.search.hasPrev=0<state.search.page,state.search.hasNext=state.search.page<numPages-1,state.search.songNameTexts='',state.search.songSubNameTexts='',state.searchResultsPage.length=0,state.searchResultsPage.__dirty=!0;for(let i=state.search.page*SEARCH_PER_PAGE;i<state.search.page*SEARCH_PER_PAGE+SEARCH_PER_PAGE&&!!state.search.results[i];i++)state.searchResultsPage.push(state.search.results[i]),state.search.songNameTexts+=truncate(state.search.results[i].songName,SONG_NAME_TRUNCATE).toUpperCase()+'\n',state.search.songSubNameTexts+=truncate(state.search.results[i].songSubName,SONG_SUB_NAME_TRUNCATE)+'\n';for(let i=0;i<state.searchResultsPage.length;i++)state.searchResultsPage[i].index=i;computeMenuSelectedChallengeIndex(state)}function truncate(str,length){return str?str.length>=length?str.substring(0,length-3)+'...':str:''}function difficultyComparator(a,b){const aIndex=DIFFICULTIES.indexOf(a),bIndex=DIFFICULTIES.indexOf(b);return aIndex<bIndex?-1:aIndex>bIndex?1:0}function takeDamage(state){state.isPlaying&&(state.score.combo=0,state.score.multiplier=1<state.score.multiplier?_Mathceil(state.score.multiplier/2):1,AFRAME.utils.getUrlParameter('godmode')||(state.damage++,checkGameOver(state)))}function checkGameOver(state){state.damage>=DAMAGE_MAX&&(state.damage=0,state.isGameOver=!0)}function resetScore(state){state.damage=0,state.score.beatsHit=0,state.score.beatsMissed=0,state.score.combo=0,state.score.maxCombo=0,state.score.score=0,state.score.multiplier=1}function computeMenuSelectedChallengeIndex(state){state.menuSelectedChallenge.index=-1;for(let i=0;i<state.searchResultsPage.length;i++)if(state.searchResultsPage[i].id===state.menuSelectedChallenge.id){state.menuSelectedChallenge.index=i;break}}function formatSongLength(songLength){songLength/=60;const minutes=`${_Mathfloor7(songLength)}`;return`${minutes}:${Math.round(60*(songLength-minutes))}`}function computeBeatsText(state){state.score.beatsText=`${state.score.beatsHit} / ${state.score.beatsMissed+state.score.beatsHit} BEATS`}function clearLeaderboard(state){state.leaderboard.length=0,state.leaderboard.__dirty=!0,state.leaderboardNames='',state.leaderboardScores='',state.leaderboardFetched=!1}function updateMenuSongInfo(state,challenge){state.menuSelectedChallenge.songInfoText=`By ${truncate(challenge.author,12)} ${challenge.genre&&'Uncategorized'!==challenge.genre?'/ '+challenge.genre:''}\n${challenge.downloads} Downloads\nUpvotes: ${challenge.upvotes} / Downvotes: ${challenge.downvotes}\n${formatSongLength(challenge.songDuration)} / ${challenge.numBeats[state.menuSelectedChallenge.difficulty]} beats`}function updateScoreAccuracy(state){const currentNumBeats=state.score.beatsHit+state.score.beatsMissed;state.score.accuracy=100*(state.score.score/(110*currentNumBeats))}var _Mathfloor7=Math.floor,_Mathceil=Math.ceil,utils=__webpack_require__(2);const challengeDataStore={},SEARCH_PER_PAGE=6,SONG_NAME_TRUNCATE=24,SONG_SUB_NAME_TRUNCATE=32,DAMAGE_DECAY=0.25,DAMAGE_MAX=10,DEBUG_CHALLENGE={author:'Superman',difficulty:'Expert',id:'31',image:'assets/img/molerat.jpg',songName:'Friday',songLength:100,songSubName:'Rebecca Black'};AFRAME.registerState({nonBindedStateKeys:['genres'],initialState:{activeHand:localStorage.getItem('hand')||'right',challenge:{author:'',difficulty:'',id:AFRAME.utils.getUrlParameter('challenge'),image:'',isLoading:!1,isBeatsPreloaded:!1,numBeats:void 0,songDuration:0,songName:'',songSubName:''},controllerType:'',damage:0,genre:'',genres:__webpack_require__(131),genreMenuOpen:!1,inVR:!1,isGameOver:!1,isPaused:!1,isPlaying:!1,isSearching:!1,isSongFetching:!1,isSongLoading:!1,isVictory:!1,leaderboard:[],leaderboardFetched:!1,leaderboardQualified:!1,leaderboardNames:'',leaderboardScores:'',menuActive:!0,menuDifficulties:[],menuSelectedChallenge:{author:'',difficulty:'',downloads:'',downloadsText:'',genre:'',id:'',index:-1,image:'',numBeats:void 0,songDuration:0,songInfoText:'',songLength:void 0,songName:'',songSubName:''},score:{accuracy:0,beatsHit:0,beatsMissed:0,beatsText:'',combo:0,maxCombo:0,multiplier:1,rank:'',score:0},search:{active:!0,page:0,hasError:!1,hasNext:!1,hasPrev:!1,query:'',results:[],songNameTexts:'',songSubNameTexts:''},searchResultsPage:[]},handlers:{activehandswap:state=>{state.activeHand='right'===state.activeHand?'left':'right',localStorage.setItem('activeHand',state.activeHand)},beathit:(state,payload)=>{state.damage>DAMAGE_DECAY&&(state.damage-=DAMAGE_DECAY),state.score.beatsHit++,state.score.combo++,state.score.combo>state.score.maxCombo&&(state.score.maxCombo=state.score.combo),state.score.score+=_Mathfloor7(payload.score*state.score.multiplier),state.score.multiplier=2>state.score.combo?1:6>state.score.combo?2:14>state.score.combo?4:8,updateScoreAccuracy(state)},beatmiss:state=>{state.score.beatsMissed++,takeDamage(state),updateScoreAccuracy(state)},beatwrong:state=>{state.score.beatsMissed++,takeDamage(state),updateScoreAccuracy(state)},beatloaderfinish:state=>{state.challenge.isLoading=!1},beatloaderpreloadfinish:state=>{state.menuActive||(state.challenge.isBeatsPreloaded=!0)},beatloaderstart:state=>{state.challenge.isBeatsPreloaded=!1,state.challenge.isLoading=!0},controllerconnected:(state,payload)=>{state.controllerType=payload.name},debuggameplay:state=>{resetScore(state),Object.assign(state.challenge,state.menuSelectedChallenge),state.menuActive=!1,state.menuSelectedChallenge.id='',state.isSearching=!1,state.isSongLoading=!1},debuggameover:state=>{state.isGameOver=!0,state.menuActive=!1},debugloading:state=>{DEBUG_CHALLENGE.id='-1',Object.assign(state.menuSelectedChallenge,DEBUG_CHALLENGE),Object.assign(state.challenge,DEBUG_CHALLENGE),state.menuActive=!1,state.isSongFetching=!0,state.isSongLoading=!0},debugvictory:state=>{Object.assign(state.menuSelectedChallenge,DEBUG_CHALLENGE),Object.assign(state.challenge,DEBUG_CHALLENGE),state.isVictory=!0,state.leaderboardQualified=!0,state.menuActive=!1,state.score.accuracy=74.99,state.score.beatsHit=125,state.score.beatsMissed=125,state.score.maxCombo=123,state.score.rank='C',state.score.score=9001,computeBeatsText(state)},gamemenuresume:state=>{state.isPaused=!1},gamemenurestart:state=>{resetScore(state),state.challenge.isBeatsPreloaded=!1,state.isGameOver=!1,state.isPaused=!1,state.isSongLoading=!0,state.isVictory=!1,state.leaderboardQualified=!1},gamemenuexit:state=>{resetScore(state),state.challenge.isBeatsPreloaded=!1,state.isGameOver=!1,state.isPaused=!1,state.isVictory=!1,state.menuActive=!0,state.challenge.id='',state.leaderboardQualified=!1},genreclear:state=>{state.genre=''},genremenuclose:state=>{state.genreMenuOpen=!1},genremenuopen:state=>{state.genreMenuOpen=!0},keyboardclose:state=>{state.isSearching=!1},keyboardopen:state=>{state.isSearching=!0,state.menuSelectedChallenge.id=''},leaderboard:(state,payload)=>{state.leaderboard.length=0,state.leaderboardFetched=!0,state.leaderboardNames='',state.leaderboardScores='';for(let i=0,score;i<payload.scores.length;i++)score=payload.scores[i],state.leaderboard.push(score),state.leaderboardNames+=`${score.username} (${score.accuracy||0}%)\n`,state.leaderboardScores+=`${score.score}\n`;state.leaderboardLoading=!1},leaderboardqualify:state=>{state.leaderboardQualified=!0},leaderboardscoreadded:(state,payload)=>{state.leaderboard.splice(payload.index,0,payload.scoreData),state.leaderboardNames='',state.leaderboardScores='';for(let i=0,score;i<10;i++)score=state.leaderboard[i],state.leaderboardNames+=`${score.username} (${score.accuracy||0}%)\n`,state.leaderboardScores+=`${score.score}\n`},leaderboardsubmit:state=>{state.leaderboardQualified=!1},menuchallengeselect:(state,id)=>{let challenge=challengeDataStore[id];Object.assign(state.menuSelectedChallenge,challenge),state.menuDifficulties.length=0;for(let i=0;i<challenge.difficulties.length;i++)state.menuDifficulties.unshift(challenge.difficulties[i]);state.menuDifficulties.sort(difficultyComparator),state.menuSelectedChallenge.difficulty=state.menuDifficulties[0],state.menuSelectedChallenge.image=utils.getS3FileUrl(id,'image.jpg'),updateMenuSongInfo(state,challenge),computeMenuSelectedChallengeIndex(state),state.isSearching=!1,clearLeaderboard(state),state.leaderboardLoading=!0},menuchallengeunselect:state=>{state.menuSelectedChallenge.id='',clearLeaderboard(state)},menudifficultyselect:(state,difficulty)=>{state.menuSelectedChallenge.difficulty=difficulty,updateMenuSongInfo(state,state.menuSelectedChallenge),clearLeaderboard(state),state.leaderboardLoading=!0},minehit:state=>{takeDamage(state)},pausegame:state=>{state.isPlaying&&(state.isPaused=!0)},playbuttonclick:state=>{resetScore(state),Object.assign(state.challenge,state.menuSelectedChallenge),state.menuActive=!1,state.menuSelectedChallenge.id='',state.isSearching=!1,state.isSongLoading=!0},searcherror:state=>{state.search.hasError=!0},searchprevpage:function(state){0===state.search.page||(state.search.page--,computeSearchPagination(state))},searchnextpage:function(state){state.search.page>_Mathfloor7(state.search.results.length/SEARCH_PER_PAGE)||(state.search.page++,computeSearchPagination(state))},searchresults:(state,payload)=>{var i;for(state.search.hasError=!1,state.search.page=0,state.search.query=payload.query,state.search.results=payload.results,i=0;i<payload.results.length;i++){let result=payload.results[i];result.songSubName=result.songSubName||'Unknown Artist',result.shortSongName=truncate(result.songName,SONG_NAME_TRUNCATE).toUpperCase(),result.shortSongSubName=truncate(result.songSubName,SONG_SUB_NAME_TRUNCATE),challengeDataStore[result.id]=result}computeSearchPagination(state),payload.isGenreSearch?(state.genreMenuOpen=!1,state.genre=payload.genre,state.menuSelectedChallenge.id=''):(state.genre='',computeMenuSelectedChallengeIndex(state))},songfetchfinish:state=>{state.isSongFetching=!1},songloadcancel:state=>{state.challenge.isBeatsPreloaded=!1,state.challenge.isLoading=!1,state.isSongLoading=!1,state.isSongFetching=!1,state.menuActive=!0},songloadfinish:state=>{state.isSongFetching=!1,state.isSongLoading=!1},songloadstart:state=>{state.isSongFetching=!0,state.isSongLoading=!0},"enter-vr":state=>{state.inVR=!0},"exit-vr":state=>{state.inVR=!1},victory:function(state){state.isVictory=!0;const accuracy=100*(state.score.score/(110*state.challenge.numBeats));state.score.accuracy=isNaN(accuracy)?0:accuracy,state.score.score=isNaN(state.score.score)?0:state.score.score,state.score.rank=95<=accuracy?'S':93<=accuracy?'A':90<=accuracy?'A-':88<=accuracy?'B+':83<=accuracy?'B':80<=accuracy?'B-':78<=accuracy?'C+':73<=accuracy?'C':70<=accuracy?'C-':60<=accuracy?'D':'F',computeBeatsText(state)},victoryfake:function(state){state.score.accuracy='74.99',state.score.rank='C'},wallhitstart:function(state){takeDamage(state)}},computeState:state=>{state.isPlaying=!state.menuActive&&!state.isPaused&&!state.isVictory&&!state.isGameOver&&!state.challenge.isLoading&&!state.isSongLoading&&!!state.challenge.id;const anyMenuOpen=state.menuActive||state.isPaused||state.isVictory||state.isGameOver||state.isSongLoading||state.isSongFetching;state.leftRaycasterActive=anyMenuOpen&&'left'===state.activeHand&&state.inVR,state.rightRaycasterActive=anyMenuOpen&&'right'===state.activeHand&&state.inVR,state.loadingText=state.isSongLoading?state.isSongFetching?'Downloading song...':'Processing song...':''}});const DIFFICULTIES=['Easy','Normal','Hard','Expert','ExpertPlus']},function(module,exports,__webpack_require__){var escape=__webpack_require__(137);exports=module.exports=__webpack_require__(136)(!1),exports.push([module.i,'html {\n  background: #000;\n}\n\n#vrButton {\n  position: absolute;\n  background: url('+escape(__webpack_require__(151))+') no-repeat;\n  background-size: cover;\n  border: 0;\n  cursor: pointer;\n  right: 20px;\n  bottom: 20px;\n  z-index: 9999999;\n  width: 84px;\n  height: 47px;\n}\n\n#vrButton.a-hidden {\n  visibility: hidden;\n}\n\n#vrButton:active {\n  border: 0;\n}\n\n#vrButton:hover {\n  background-position: 0 -50.5px;\n}\n\n.a-loader-title {\n  animation: loaderTitle 1s infinite alternate;\n  color: rgba(0,0,0,0);\n  background: none;\n  background-image: url('+escape(__webpack_require__(152))+');\n  height: 36.2vh;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-top: 0;\n  background-size: contain;\n  margin-left: -1vh;\n}\n\n@keyframes loaderTitle {\n  0% { opacity: 1; }\n  50% { opacity: 0.8; }\n  100% { opacity: 1; }\n}\n\n#tutorial2d {\n  position: absolute;\n  width: 60%;\n  left: 20%;\n  top: 35%;\n}\n\n@media (max-width: 1280px) {\n  #tutorial2d {\n    width: 80%;\n    left: 10%;\n  }\n}\n',''])},function(module){function cssWithMappingToString(item,useSourceMap){var content=item[1]||'',cssMapping=item[3];if(!cssMapping)return content;if(useSourceMap&&'function'==typeof btoa){var sourceMapping=toComment(cssMapping),sourceURLs=cssMapping.sources.map(function(source){return'/*# sourceURL='+cssMapping.sourceRoot+source+' */'});return[content].concat(sourceURLs).concat([sourceMapping]).join('\n')}return[content].join('\n')}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));return'/*# '+('sourceMappingURL=data:application/json;charset=utf-8;base64,'+base64)+' */'}module.exports=function(useSourceMap){var list=[];return list.toString=function toString(){return this.map(function(item){var content=cssWithMappingToString(item,useSourceMap);return item[2]?'@media '+item[2]+'{'+content+'}':content}).join('')},list.i=function(modules,mediaQuery){'string'==typeof modules&&(modules=[[null,modules,'']]);for(var alreadyImportedModules={},i=0,id;i<this.length;i++)id=this[i][0],'number'==typeof id&&(alreadyImportedModules[id]=!0);for(i=0;i<modules.length;i++){var item=modules[i];'number'==typeof item[0]&&alreadyImportedModules[item[0]]||(mediaQuery&&!item[2]?item[2]=mediaQuery:mediaQuery&&(item[2]='('+item[2]+') and ('+mediaQuery+')'),list.push(item))}},list}},function(module){module.exports=function escape(url){return'string'==typeof url?(/^['"].*['"]$/.test(url)&&(url=url.slice(1,-1)),/["'() \t\n]/.test(url)?'"'+url.replace(/"/g,'\\"').replace(/\n/g,'\\n')+'"':url):url}},function(module,exports,__webpack_require__){module.exports=function setup(env){function selectColor(namespace){let hash=0;for(let i=0;i<namespace.length;i++)hash=(hash<<5)-hash+namespace.charCodeAt(i),hash|=0;return createDebug.colors[Math.abs(hash)%createDebug.colors.length]}function createDebug(namespace){function debug(...args){if(!debug.enabled)return;const self=debug,curr=+new Date,ms=curr-(prevTime||curr);self.diff=ms,self.prev=prevTime,self.curr=curr,prevTime=curr,args[0]=createDebug.coerce(args[0]),'string'!=typeof args[0]&&args.unshift('%O');let index=0;args[0]=args[0].replace(/%([a-zA-Z%])/g,(match,format)=>{if('%%'===match)return match;index++;const formatter=createDebug.formatters[format];if('function'==typeof formatter){const val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),createDebug.formatArgs.call(self,args);const logFn=self.log||createDebug.log;logFn.apply(self,args)}let prevTime;return debug.namespace=namespace,debug.enabled=createDebug.enabled(namespace),debug.useColors=createDebug.useColors(),debug.color=selectColor(namespace),debug.destroy=destroy,debug.extend=extend,'function'==typeof createDebug.init&&createDebug.init(debug),createDebug.instances.push(debug),debug}function destroy(){const index=createDebug.instances.indexOf(this);return-1!==index&&(createDebug.instances.splice(index,1),!0)}function extend(namespace,delimiter){return createDebug(this.namespace+('undefined'==typeof delimiter?':':delimiter)+namespace)}function toNamespace(regexp){return regexp.toString().substring(2,regexp.toString().length-2).replace(/\.\*\?$/,'*')}return createDebug.debug=createDebug,createDebug.default=createDebug,createDebug.coerce=function coerce(val){return val instanceof Error?val.stack||val.message:val},createDebug.disable=function disable(){const namespaces=[...createDebug.names.map(toNamespace),...createDebug.skips.map(toNamespace).map(namespace=>'-'+namespace)].join(',');return createDebug.enable(''),namespaces},createDebug.enable=function enable(namespaces){createDebug.save(namespaces),createDebug.names=[],createDebug.skips=[];let i;const split=('string'==typeof namespaces?namespaces:'').split(/[\s,]+/),len=split.length;for(i=0;i<len;i++)split[i]&&(namespaces=split[i].replace(/\*/g,'.*?'),'-'===namespaces[0]?createDebug.skips.push(new RegExp('^'+namespaces.substr(1)+'$')):createDebug.names.push(new RegExp('^'+namespaces+'$')));for(i=0;i<createDebug.instances.length;i++){const instance=createDebug.instances[i];instance.enabled=createDebug.enabled(instance.namespace)}},createDebug.enabled=function enabled(name){if('*'===name[name.length-1])return!0;let i,len;for(i=0,len=createDebug.skips.length;i<len;i++)if(createDebug.skips[i].test(name))return!1;for(i=0,len=createDebug.names.length;i<len;i++)if(createDebug.names[i].test(name))return!0;return!1},createDebug.humanize=__webpack_require__(143),Object.keys(env).forEach(key=>{createDebug[key]=env[key]}),createDebug.instances=[],createDebug.names=[],createDebug.skips=[],createDebug.formatters={},createDebug.selectColor=selectColor,createDebug.enable(createDebug.load()),createDebug}},function(module,exports,__webpack_require__){(function(process,global){(function(global,factory){module.exports=factory()})(this,function(){'use strict';function objectOrFunction(x){var type=typeof x;return null!==x&&('object'==type||'function'==type)}function isFunction(x){return'function'==typeof x}function useVertxTimer(){return'undefined'==typeof vertxNext?useSetTimeout():function(){vertxNext(flush)}}function useSetTimeout(){var globalSetTimeout=setTimeout;return function(){return globalSetTimeout(flush,1)}}function flush(){for(var i=0;i<len;i+=2){var callback=queue[i],arg=queue[i+1];callback(arg),queue[i]=void 0,queue[i+1]=void 0}len=0}function then(onFulfillment,onRejection){var parent=this,child=new this.constructor(noop);void 0===child[PROMISE_ID]&&makePromise(child);var _state=parent._state;if(_state){var callback=arguments[_state-1];asap(function(){return invokeCallback(_state,child,callback,parent._result)})}else subscribe(parent,child,onFulfillment,onRejection);return child}function resolve$1(object){var Constructor=this;if(object&&'object'==typeof object&&object.constructor===Constructor)return object;var promise=new Constructor(noop);return resolve(promise,object),promise}function noop(){}function selfFulfillment(){return new TypeError('You cannot resolve a promise with itself')}function cannotReturnOwn(){return new TypeError('A promises callback cannot return that same promise.')}function getThen(promise){try{return promise.then}catch(error){return TRY_CATCH_ERROR.error=error,TRY_CATCH_ERROR}}function tryThen(then$$1,value,fulfillmentHandler,rejectionHandler){try{then$$1.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function handleForeignThenable(promise,thenable,then$$1){asap(function(promise){var sealed=!1,error=tryThen(then$$1,thenable,function(value){sealed||(sealed=!0,thenable===value?fulfill(promise,value):resolve(promise,value))},function(reason){sealed||(sealed=!0,reject(promise,reason))},'Settle: '+(promise._label||' unknown promise'));!sealed&&error&&(sealed=!0,reject(promise,error))},promise)}function handleOwnThenable(promise,thenable){thenable._state===FULFILLED?fulfill(promise,thenable._result):thenable._state===REJECTED?reject(promise,thenable._result):subscribe(thenable,void 0,function(value){return resolve(promise,value)},function(reason){return reject(promise,reason)})}function handleMaybeThenable(promise,maybeThenable,then$$1){maybeThenable.constructor===promise.constructor&&then$$1===then&&maybeThenable.constructor.resolve===resolve$1?handleOwnThenable(promise,maybeThenable):then$$1===TRY_CATCH_ERROR?(reject(promise,TRY_CATCH_ERROR.error),TRY_CATCH_ERROR.error=null):void 0===then$$1?fulfill(promise,maybeThenable):isFunction(then$$1)?handleForeignThenable(promise,maybeThenable,then$$1):fulfill(promise,maybeThenable)}function resolve(promise,value){promise===value?reject(promise,selfFulfillment()):objectOrFunction(value)?handleMaybeThenable(promise,value,getThen(value)):fulfill(promise,value)}function publishRejection(promise){promise._onerror&&promise._onerror(promise._result),publish(promise)}function fulfill(promise,value){promise._state!==PENDING||(promise._result=value,promise._state=FULFILLED,0!==promise._subscribers.length&&asap(publish,promise))}function reject(promise,reason){promise._state!==PENDING||(promise._state=REJECTED,promise._result=reason,asap(publishRejection,promise))}function subscribe(parent,child,onFulfillment,onRejection){var _subscribers=parent._subscribers,length=_subscribers.length;parent._onerror=null,_subscribers[length]=child,_subscribers[length+FULFILLED]=onFulfillment,_subscribers[length+REJECTED]=onRejection,0===length&&parent._state&&asap(publish,parent)}function publish(promise){var subscribers=promise._subscribers,settled=promise._state;if(0!==subscribers.length){for(var child=void 0,callback=void 0,detail=promise._result,i=0;i<subscribers.length;i+=3)child=subscribers[i],callback=subscribers[i+settled],child?invokeCallback(settled,child,callback,detail):callback(detail);promise._subscribers.length=0}}function tryCatch(callback,detail){try{return callback(detail)}catch(e){return TRY_CATCH_ERROR.error=e,TRY_CATCH_ERROR}}function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value,error,succeeded,failed;if(!hasCallback)value=detail,succeeded=!0;else if(value=tryCatch(callback,detail),value===TRY_CATCH_ERROR?(failed=!0,error=value.error,value.error=null):succeeded=!0,promise===value)return void reject(promise,cannotReturnOwn());promise._state!==PENDING||(hasCallback&&succeeded?resolve(promise,value):failed?reject(promise,error):settled===FULFILLED?fulfill(promise,value):settled===REJECTED&&reject(promise,value))}function initializePromise(promise,resolver){try{resolver(function resolvePromise(value){resolve(promise,value)},function rejectPromise(reason){reject(promise,reason)})}catch(e){reject(promise,e)}}function nextId(){return id++}function makePromise(promise){promise[PROMISE_ID]=id++,promise._state=void 0,promise._result=void 0,promise._subscribers=[]}function validationError(){return new Error('Array Methods must be provided an Array')}function needsResolver(){throw new TypeError('You must pass a resolver function as the first argument to the promise constructor')}function needsNew(){throw new TypeError('Failed to construct \'Promise\': Please use the \'new\' operator, this object constructor cannot be called as a function.')}var _isArray=Array.isArray?Array.isArray:function(x){return'[object Array]'===Object.prototype.toString.call(x)};var isArray=_isArray,len=0,vertxNext=void 0,customSchedulerFn=void 0,asap=function asap(callback,arg){queue[len]=callback,queue[len+1]=arg,len+=2,2==len&&(customSchedulerFn?customSchedulerFn(flush):scheduleFlush())},browserWindow='undefined'==typeof window?void 0:window,browserGlobal=browserWindow||{},BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver,isNode='undefined'==typeof self&&'undefined'!=typeof process&&'[object process]'==={}.toString.call(process),isWorker='undefined'!=typeof Uint8ClampedArray&&'undefined'!=typeof importScripts&&'undefined'!=typeof MessageChannel,queue=Array(1e3),scheduleFlush=void 0;scheduleFlush=isNode?function useNextTick(){return function(){return process.nextTick(flush)}}():BrowserMutationObserver?function useMutationObserver(){var iterations=0,observer=new BrowserMutationObserver(flush),node=document.createTextNode('');return observer.observe(node,{characterData:!0}),function(){node.data=iterations=++iterations%2}}():isWorker?function useMessageChannel(){var channel=new MessageChannel;return channel.port1.onmessage=flush,function(){return channel.port2.postMessage(0)}}():void 0===browserWindow&&'function'=='function'?function attemptVertx(){try{var vertx=Function('return this')().require('vertx');return vertxNext=vertx.runOnLoop||vertx.runOnContext,useVertxTimer()}catch(e){return useSetTimeout()}}():useSetTimeout();var PROMISE_ID=Math.random().toString(36).substring(2),PENDING=void 0,FULFILLED=1,REJECTED=2,TRY_CATCH_ERROR={error:null},id=0,Enumerator=function(){function Enumerator(Constructor,input){this._instanceConstructor=Constructor,this.promise=new Constructor(noop),this.promise[PROMISE_ID]||makePromise(this.promise),isArray(input)?(this.length=input.length,this._remaining=input.length,this._result=Array(this.length),0===this.length?fulfill(this.promise,this._result):(this.length=this.length||0,this._enumerate(input),0===this._remaining&&fulfill(this.promise,this._result))):reject(this.promise,validationError())}return Enumerator.prototype._enumerate=function _enumerate(input){for(var i=0;this._state===PENDING&&i<input.length;i++)this._eachEntry(input[i],i)},Enumerator.prototype._eachEntry=function _eachEntry(entry,i){var c=this._instanceConstructor,resolve$$1=c.resolve;if(resolve$$1===resolve$1){var _then=getThen(entry);if(_then===then&&entry._state!==PENDING)this._settledAt(entry._state,i,entry._result);else if('function'!=typeof _then)this._remaining--,this._result[i]=entry;else if(c===Promise$1){var promise=new c(noop);handleMaybeThenable(promise,entry,_then),this._willSettleAt(promise,i)}else this._willSettleAt(new c(function(resolve$$1){return resolve$$1(entry)}),i)}else this._willSettleAt(resolve$$1(entry),i)},Enumerator.prototype._settledAt=function _settledAt(state,i,value){var promise=this.promise;promise._state===PENDING&&(this._remaining--,state===REJECTED?reject(promise,value):this._result[i]=value),0===this._remaining&&fulfill(promise,this._result)},Enumerator.prototype._willSettleAt=function _willSettleAt(promise,i){var enumerator=this;subscribe(promise,void 0,function(value){return enumerator._settledAt(FULFILLED,i,value)},function(reason){return enumerator._settledAt(REJECTED,i,reason)})},Enumerator}(),Promise$1=function(){function Promise(resolver){this[PROMISE_ID]=nextId(),this._result=this._state=void 0,this._subscribers=[],noop!==resolver&&('function'!=typeof resolver&&needsResolver(),this instanceof Promise?initializePromise(this,resolver):needsNew())}return Promise.prototype.catch=function _catch(onRejection){return this.then(null,onRejection)},Promise.prototype.finally=function _finally(callback){var promise=this,constructor=promise.constructor;return promise.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){throw reason})})},Promise}();return Promise$1.prototype.then=then,Promise$1.all=function all(entries){return new Enumerator(this,entries).promise},Promise$1.race=function race(entries){var Constructor=this;return isArray(entries)?new Constructor(function(resolve,reject){for(var length=entries.length,i=0;i<length;i++)Constructor.resolve(entries[i]).then(resolve,reject)}):new Constructor(function(_,reject){return reject(new TypeError('You must pass an array to race.'))})},Promise$1.resolve=resolve$1,Promise$1.reject=function reject$1(reason){var Constructor=this,promise=new Constructor(noop);return reject(promise,reason),promise},Promise$1._setScheduler=function setScheduler(scheduleFn){customSchedulerFn=scheduleFn},Promise$1._setAsap=function setAsap(asapFn){asap=asapFn},Promise$1._asap=asap,Promise$1.polyfill=function polyfill(){var local;if('undefined'!=typeof global)local=global;else if('undefined'!=typeof self)local=self;else try{local=Function('return this')()}catch(e){throw new Error('polyfill failed because global object is unavailable in this environment')}var P=local.Promise;if(P){var promiseToString=null;try{promiseToString=Object.prototype.toString.call(P.resolve())}catch(e){}if('[object Promise]'===promiseToString&&!P.cast)return}local.Promise=Promise$1},Promise$1.Promise=Promise$1,Promise$1})}).call(exports,__webpack_require__(4),__webpack_require__(0))},function(module,exports,__webpack_require__){'use strict';__webpack_require__(37);var firebase=function _interopDefault(ex){return ex&&'object'==typeof ex&&'default'in ex?ex['default']:ex}(__webpack_require__(13));module.exports=firebase},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__firebase_firestore__=__webpack_require__(35),__WEBPACK_IMPORTED_MODULE_0__firebase_firestore___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__firebase_firestore__)},function(module,exports,__webpack_require__){(function(global){var win;win='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,module.exports=win}).call(exports,__webpack_require__(0))},function(module){function parse(str){if(str+='',!(100<str.length)){var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(match){var n=parseFloat(match[1]),type=(match[2]||'ms').toLowerCase();return'years'===type||'year'===type||'yrs'===type||'yr'===type||'y'===type?n*y:'days'===type||'day'===type||'d'===type?n*d:'hours'===type||'hour'===type||'hrs'===type||'hr'===type||'h'===type?n*h:'minutes'===type||'minute'===type||'mins'===type||'min'===type||'m'===type?n*m:'seconds'===type||'second'===type||'secs'===type||'sec'===type||'s'===type?n*s:'milliseconds'===type||'millisecond'===type||'msecs'===type||'msec'===type||'ms'===type?n:void 0}}}function fmtShort(ms){return ms>=d?_Mathround2(ms/d)+'d':ms>=h?_Mathround2(ms/h)+'h':ms>=m?_Mathround2(ms/m)+'m':ms>=s?_Mathround2(ms/s)+'s':ms+'ms'}function fmtLong(ms){return plural(ms,d,'day')||plural(ms,h,'hour')||plural(ms,m,'minute')||plural(ms,s,'second')||ms+' ms'}function plural(ms,n,name){return ms<n?void 0:ms<1.5*n?Math.floor(ms/n)+' '+name:Math.ceil(ms/n)+' '+name+'s'}var _Mathround2=Math.round,s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(val,options){options=options||{};var type=typeof val;if('string'==type&&0<val.length)return parse(val);if('number'==type&&!1===isNaN(val))return options.long?fmtLong(val):fmtShort(val);throw new Error('val is not a non-empty string or a valid number. val='+JSON.stringify(val))}},function(module,exports,__webpack_require__){'use strict';var has=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,slice=Array.prototype.slice,isArgs=__webpack_require__(145),isEnumerable=Object.prototype.propertyIsEnumerable,hasDontEnumBug=!isEnumerable.call({toString:null},'toString'),hasProtoEnumBug=isEnumerable.call(function(){},'prototype'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},excludedKeys={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},hasAutomationEqualityBug=function(){if('undefined'==typeof window)return!1;for(var k in window)try{if(!excludedKeys['$'+k]&&has.call(window,k)&&null!==window[k]&&'object'==typeof window[k])try{equalsConstructorPrototype(window[k])}catch(e){return!0}}catch(e){return!0}return!1}(),equalsConstructorPrototypeIfNotBuggy=function(o){if('undefined'==typeof window||!hasAutomationEqualityBug)return equalsConstructorPrototype(o);try{return equalsConstructorPrototype(o)}catch(e){return!1}},keysShim=function keys(object){var isObject=null!==object&&'object'==typeof object,isFunction='[object Function]'===toStr.call(object),isArguments=isArgs(object),isString=isObject&&'[object String]'===toStr.call(object),theKeys=[];if(!isObject&&!isFunction&&!isArguments)throw new TypeError('Object.keys called on a non-object');if(isString&&0<object.length&&!has.call(object,0))for(var i=0;i<object.length;++i)theKeys.push(i+'');if(isArguments&&0<object.length)for(var j=0;j<object.length;++j)theKeys.push(j+'');else for(var name in object)!(hasProtoEnumBug&&isFunction&&'prototype'==name)&&has.call(object,name)&&theKeys.push(name+'');if(hasDontEnumBug)for(var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object),k=0;k<dontEnums.length;++k)!(skipConstructor&&'constructor'===dontEnums[k])&&has.call(object,dontEnums[k])&&theKeys.push(dontEnums[k]);return theKeys};keysShim.shim=function shimObjectKeys(){if(Object.keys){var keysWorksWithArguments=function(){return 2===(Object.keys(arguments)||'').length}(1,2);if(!keysWorksWithArguments){var originalKeys=Object.keys;Object.keys=function keys(object){return isArgs(object)?originalKeys(slice.call(object)):originalKeys(object)}}}else Object.keys=keysShim;return Object.keys||keysShim},module.exports=keysShim},function(module){'use strict';var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value),isArgs='[object Arguments]'===str;return isArgs||(isArgs='[object Array]'!==str&&null!==value&&'object'==typeof value&&'number'==typeof value.length&&0<=value.length&&'[object Function]'===toStr.call(value.callee)),isArgs}},function(module){'use strict';function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case'string':return v;case'boolean':return v?'true':'false';case'number':return isFinite(v)?v:'';default:return'';}};module.exports=function(obj,sep,eq,name){return sep=sep||'&',eq=eq||'=',null===obj&&(obj=void 0),'object'==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):''};var isArray=Array.isArray||function(xs){return'[object Array]'===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},function(module,exports,__webpack_require__){(function(global,process){(function(global){'use strict';function setImmediate(callback){'function'!=typeof callback&&(callback=new Function(''+callback));for(var args=Array(arguments.length-1),i=0;i<args.length;i++)args[i]=arguments[i+1];var task={callback:callback,args:args};return tasksByHandle[nextHandle]=task,registerImmediate(nextHandle),nextHandle++}function clearImmediate(handle){delete tasksByHandle[handle]}function run(task){var callback=task.callback,args=task.args;switch(args.length){case 0:callback();break;case 1:callback(args[0]);break;case 2:callback(args[0],args[1]);break;case 3:callback(args[0],args[1],args[2]);break;default:callback.apply(void 0,args);}}function runIfPresent(handle){if(currentlyRunningATask)setTimeout(runIfPresent,0,handle);else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=!0;try{run(task)}finally{clearImmediate(handle),currentlyRunningATask=!1}}}}function installNextTickImplementation(){registerImmediate=function(handle){process.nextTick(function(){runIfPresent(handle)})}}function canUsePostMessage(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=!0,oldOnMessage=global.onmessage;return global.onmessage=function(){postMessageIsAsynchronous=!1},global.postMessage('','*'),global.onmessage=oldOnMessage,postMessageIsAsynchronous}}function installPostMessageImplementation(){var messagePrefix='setImmediate$'+Math.random()+'$',onGlobalMessage=function(event){event.source===global&&'string'==typeof event.data&&0===event.data.indexOf(messagePrefix)&&runIfPresent(+event.data.slice(messagePrefix.length))};global.addEventListener?global.addEventListener('message',onGlobalMessage,!1):global.attachEvent('onmessage',onGlobalMessage),registerImmediate=function(handle){global.postMessage(messagePrefix+handle,'*')}}function installMessageChannelImplementation(){var channel=new MessageChannel;channel.port1.onmessage=function(event){var handle=event.data;runIfPresent(handle)},registerImmediate=function(handle){channel.port2.postMessage(handle)}}function installReadyStateChangeImplementation(){var html=doc.documentElement;registerImmediate=function(handle){var script=doc.createElement('script');script.onreadystatechange=function(){runIfPresent(handle),script.onreadystatechange=null,html.removeChild(script),script=null},html.appendChild(script)}}function installSetTimeoutImplementation(){registerImmediate=function(handle){setTimeout(runIfPresent,0,handle)}}if(!global.setImmediate){var nextHandle=1,tasksByHandle={},currentlyRunningATask=!1,doc=global.document,attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global),registerImmediate;attachTo=attachTo&&attachTo.setTimeout?attachTo:global,'[object process]'==={}.toString.call(global.process)?installNextTickImplementation():canUsePostMessage()?installPostMessageImplementation():global.MessageChannel?installMessageChannelImplementation():doc&&'onreadystatechange'in doc.createElement('script')?installReadyStateChangeImplementation():installSetTimeoutImplementation(),attachTo.setImmediate=setImmediate,attachTo.clearImmediate=clearImmediate}})('undefined'==typeof self?'undefined'==typeof global?this:global:self)}).call(exports,__webpack_require__(0),__webpack_require__(4))},function(module,exports,__webpack_require__){function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j](item.parts[j]);for(;j<item.parts.length;j++)domStyle.parts.push(addStyle(item.parts[j],options))}else{for(var parts=[],j=0;j<item.parts.length;j++)parts.push(addStyle(item.parts[j],options));stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list,options){for(var styles=[],newStyles={},i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],css=item[1],media=item[2],sourceMap=item[3],part={css:css,media:media,sourceMap:sourceMap};newStyles[id]?newStyles[id].parts.push(part):styles.push(newStyles[id]={id:id,parts:[part]})}return styles}function insertStyleElement(options,style){var target=getElement(options.insertInto);if(!target)throw new Error('Couldn\'t find a style target. This probably means that the value for the \'insertInto\' parameter is invalid.');var lastStyleElementInsertedAtTop=stylesInsertedAtTop[stylesInsertedAtTop.length-1];if('top'===options.insertAt)lastStyleElementInsertedAtTop?lastStyleElementInsertedAtTop.nextSibling?target.insertBefore(style,lastStyleElementInsertedAtTop.nextSibling):target.appendChild(style):target.insertBefore(style,target.firstChild),stylesInsertedAtTop.push(style);else if('bottom'===options.insertAt)target.appendChild(style);else if('object'==typeof options.insertAt&&options.insertAt.before){var nextSibling=getElement(options.insertAt.before,target);target.insertBefore(style,nextSibling)}else throw new Error('[Style Loader]\n\n Invalid value for parameter \'insertAt\' (\'options.insertAt\') found.\n Must be \'top\', \'bottom\', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n')}function removeStyleElement(style){if(null===style.parentNode)return!1;style.parentNode.removeChild(style);var idx=stylesInsertedAtTop.indexOf(style);0<=idx&&stylesInsertedAtTop.splice(idx,1)}function createStyleElement(options){var style=document.createElement('style');if(void 0===options.attrs.type&&(options.attrs.type='text/css'),void 0===options.attrs.nonce){var nonce=getNonce();nonce&&(options.attrs.nonce=nonce)}return addAttrs(style,options.attrs),insertStyleElement(options,style),style}function createLinkElement(options){var link=document.createElement('link');return void 0===options.attrs.type&&(options.attrs.type='text/css'),options.attrs.rel='stylesheet',addAttrs(link,options.attrs),insertStyleElement(options,link),link}function addAttrs(el,attrs){Object.keys(attrs).forEach(function(key){el.setAttribute(key,attrs[key])})}function getNonce(){return __webpack_require__.nc}function addStyle(obj,options){var style,update,remove,result;if(options.transform&&obj.css)if(result='function'==typeof options.transform?options.transform(obj.css):options.transform.default(obj.css),result)obj.css=result;else return function(){};if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=createStyleElement(options)),update=applyToSingletonTag.bind(null,style,styleIndex,!1),remove=applyToSingletonTag.bind(null,style,styleIndex,!0)}else obj.sourceMap&&'function'==typeof URL&&'function'==typeof URL.createObjectURL&&'function'==typeof URL.revokeObjectURL&&'function'==typeof Blob&&'function'==typeof btoa?(style=createLinkElement(options),update=updateLink.bind(null,style,options),remove=function(){removeStyleElement(style),style.href&&URL.revokeObjectURL(style.href)}):(style=createStyleElement(options),update=applyToTag.bind(null,style),remove=function(){removeStyleElement(style)});return update(obj),function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}function applyToSingletonTag(style,index,remove,obj){var css=remove?'':obj.css;if(style.styleSheet)style.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=style.childNodes;childNodes[index]&&style.removeChild(childNodes[index]),childNodes.length?style.insertBefore(cssNode,childNodes[index]):style.appendChild(cssNode)}}function applyToTag(style,obj){var css=obj.css,media=obj.media;if(media&&style.setAttribute('media',media),style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}function updateLink(link,options,obj){var css=obj.css,sourceMap=obj.sourceMap,autoFixUrls=options.convertToAbsoluteUrls===void 0&&sourceMap;(options.convertToAbsoluteUrls||autoFixUrls)&&(css=fixUrls(css)),sourceMap&&(css+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+' */');var blob=new Blob([css],{type:'text/css'}),oldSrc=link.href;link.href=URL.createObjectURL(blob),oldSrc&&URL.revokeObjectURL(oldSrc)}var stylesInDom={},isOldIE=function(fn){var memo;return function(){return'undefined'==typeof memo&&(memo=fn.apply(this,arguments)),memo}}(function(){return window&&document&&document.all&&!window.atob}),getTarget=function(target,parent){return parent?parent.querySelector(target):document.querySelector(target)},getElement=function(){var memo={};return function(target,parent){if('function'==typeof target)return target();if('undefined'==typeof memo[target]){var styleTarget=getTarget.call(this,target,parent);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),singleton=null,singletonCounter=0,stylesInsertedAtTop=[],fixUrls=__webpack_require__(149);module.exports=function(list,options){if('undefined'!=typeof DEBUG&&DEBUG&&'object'!=typeof document)throw new Error('The style-loader cannot be used in a non-browser environment');options=options||{},options.attrs='object'==typeof options.attrs?options.attrs:{},options.singleton||'boolean'==typeof options.singleton||(options.singleton=isOldIE()),options.insertInto||(options.insertInto='head'),options.insertAt||(options.insertAt='bottom');var styles=listToStyles(list,options);return addStylesToDom(styles,options),function update(newList){for(var mayRemove=[],i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];domStyle.refs--,mayRemove.push(domStyle)}if(newList){var newStyles=listToStyles(newList,options);addStylesToDom(newStyles,options)}for(var i=0,domStyle;i<mayRemove.length;i++)if(domStyle=mayRemove[i],0===domStyle.refs){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}};var replaceText=function(){var textStore=[];return function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join('\n')}}()},function(module){module.exports=function(css){var location='undefined'!=typeof window&&window.location;if(!location)throw new Error('fixUrls requires window.location');if(!css||'string'!=typeof css)return css;var baseUrl=location.protocol+'//'+location.host,currentDir=baseUrl+location.pathname.replace(/\/[^\/]*$/,'/'),fixedCss=css.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(fullMatch,origUrl){var unquotedOrigUrl=origUrl.trim().replace(/^"(.*)"$/,function(o,$1){return $1}).replace(/^'(.*)'$/,function(o,$1){return $1});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(unquotedOrigUrl))return fullMatch;var newUrl;return newUrl=0===unquotedOrigUrl.indexOf('//')?unquotedOrigUrl:0===unquotedOrigUrl.indexOf('/')?baseUrl+unquotedOrigUrl:currentDir+unquotedOrigUrl.replace(/^\.\//,''),'url('+JSON.stringify(newUrl)+')'});return fixedCss}},function(module,exports,__webpack_require__){(function(global){function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}var scope='undefined'!=typeof global&&global||'undefined'!=typeof self&&self||window,apply=Function.prototype.apply;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,scope,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,scope,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout&&timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(scope,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function onTimeout(){item._onTimeout&&item._onTimeout()},msecs))},__webpack_require__(147),exports.setImmediate='undefined'!=typeof self&&self.setImmediate||'undefined'!=typeof global&&global.setImmediate||this&&this.setImmediate,exports.clearImmediate='undefined'!=typeof self&&self.clearImmediate||'undefined'!=typeof global&&global.clearImmediate||this&&this.clearImmediate}).call(exports,__webpack_require__(0))},function(module){module.exports='data:image/png;base64,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'},function(module){module.exports='data:image/jpeg;base64,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'},function(){'use strict';function isDataView(obj){return obj&&DataView.prototype.isPrototypeOf(obj)}function normalizeName(name){if('string'!=typeof name&&(name+=''),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(name))throw new TypeError('Invalid character in header field name');return name.toLowerCase()}function normalizeValue(value){return'string'!=typeof value&&(value+=''),value}function iteratorFor(items){var iterator={next:function(){var value=items.shift();return{done:void 0===value,value:value}}};return support.iterable&&(iterator[Symbol.iterator]=function(){return iterator}),iterator}function Headers(headers){this.map={},headers instanceof Headers?headers.forEach(function(value,name){this.append(name,value)},this):Array.isArray(headers)?headers.forEach(function(header){this.append(header[0],header[1])},this):headers&&Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name])},this)}function consumed(body){return body.bodyUsed?Promise.reject(new TypeError('Already read')):void(body.bodyUsed=!0)}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsArrayBuffer(blob),promise}function readBlobAsText(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsText(blob),promise}function readArrayBufferAsText(buf){for(var view=new Uint8Array(buf),chars=Array(view.length),i=0;i<view.length;i++)chars[i]=String.fromCharCode(view[i]);return chars.join('')}function bufferClone(buf){if(buf.slice)return buf.slice(0);var view=new Uint8Array(buf.byteLength);return view.set(new Uint8Array(buf)),view.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(body){this._bodyInit=body,body?'string'==typeof body?this._bodyText=body:support.blob&&Blob.prototype.isPrototypeOf(body)?this._bodyBlob=body:support.formData&&FormData.prototype.isPrototypeOf(body)?this._bodyFormData=body:support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)?this._bodyText=body.toString():support.arrayBuffer&&support.blob&&isDataView(body)?(this._bodyArrayBuffer=bufferClone(body.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):support.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(body)||isArrayBufferView(body))?this._bodyArrayBuffer=bufferClone(body):this._bodyText=body=Object.prototype.toString.call(body):this._bodyText='',this.headers.get('content-type')||('string'==typeof body?this.headers.set('content-type','text/plain;charset=UTF-8'):this._bodyBlob&&this._bodyBlob.type?this.headers.set('content-type',this._bodyBlob.type):support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)&&this.headers.set('content-type','application/x-www-form-urlencoded;charset=UTF-8'))},support.blob&&(this.blob=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error('could not read FormData body as blob');else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return readBlobAsText(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error('could not read FormData body as text');else return Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}function normalizeMethod(method){var upcased=method.toUpperCase();return-1<methods.indexOf(upcased)?upcased:method}function Request(input,options){options=options||{};var body=options.body;if(input instanceof Request){if(input.bodyUsed)throw new TypeError('Already read');this.url=input.url,this.credentials=input.credentials,options.headers||(this.headers=new Headers(input.headers)),this.method=input.method,this.mode=input.mode,this.signal=input.signal,body||null==input._bodyInit||(body=input._bodyInit,input.bodyUsed=!0)}else this.url=input+'';if(this.credentials=options.credentials||this.credentials||'same-origin',(options.headers||!this.headers)&&(this.headers=new Headers(options.headers)),this.method=normalizeMethod(options.method||this.method||'GET'),this.mode=options.mode||this.mode||null,this.signal=options.signal||this.signal,this.referrer=null,('GET'===this.method||'HEAD'===this.method)&&body)throw new TypeError('Body not allowed for GET or HEAD requests');this._initBody(body)}function decode(body){var form=new FormData;return body.trim().split('&').forEach(function(bytes){if(bytes){var split=bytes.split('='),name=split.shift().replace(/\+/g,' '),value=split.join('=').replace(/\+/g,' ');form.append(decodeURIComponent(name),decodeURIComponent(value))}}),form}function parseHeaders(rawHeaders){var headers=new Headers,preProcessedHeaders=rawHeaders.replace(/\r?\n[\t ]+/g,' ');return preProcessedHeaders.split(/\r?\n/).forEach(function(line){var parts=line.split(':'),key=parts.shift().trim();if(key){var value=parts.join(':').trim();headers.append(key,value)}}),headers}function Response(bodyInit,options){options||(options={}),this.type='default',this.status=options.status===void 0?200:options.status,this.ok=200<=this.status&&300>this.status,this.statusText='statusText'in options?options.statusText:'OK',this.headers=new Headers(options.headers),this.url=options.url||'',this._initBody(bodyInit)}function fetch(input,init){return new Promise(function(resolve,reject){function abortXhr(){xhr.abort()}var request=new Request(input,init);if(request.signal&&request.signal.aborted)return reject(new DOMException('Aborted','AbortError'));var xhr=new XMLHttpRequest;xhr.onload=function(){var options={status:xhr.status,statusText:xhr.statusText,headers:parseHeaders(xhr.getAllResponseHeaders()||'')};options.url='responseURL'in xhr?xhr.responseURL:options.headers.get('X-Request-URL');var body='response'in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))},xhr.onerror=function(){reject(new TypeError('Network request failed'))},xhr.ontimeout=function(){reject(new TypeError('Network request failed'))},xhr.onabort=function(){reject(new DOMException('Aborted','AbortError'))},xhr.open(request.method,request.url,!0),'include'===request.credentials?xhr.withCredentials=!0:'omit'===request.credentials&&(xhr.withCredentials=!1),'responseType'in xhr&&support.blob&&(xhr.responseType='blob'),request.headers.forEach(function(value,name){xhr.setRequestHeader(name,value)}),request.signal&&(request.signal.addEventListener('abort',abortXhr),xhr.onreadystatechange=function(){4===xhr.readyState&&request.signal.removeEventListener('abort',abortXhr)}),xhr.send('undefined'==typeof request._bodyInit?null:request._bodyInit)})}var support={searchParams:'URLSearchParams'in self,iterable:'Symbol'in self&&'iterator'in Symbol,blob:'FileReader'in self&&'Blob'in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:'FormData'in self,arrayBuffer:'ArrayBuffer'in self};if(support.arrayBuffer)var viewClasses=['[object Int8Array]','[object Uint8Array]','[object Uint8ClampedArray]','[object Int16Array]','[object Uint16Array]','[object Int32Array]','[object Uint32Array]','[object Float32Array]','[object Float64Array]'],isArrayBufferView=ArrayBuffer.isView||function(obj){return obj&&-1<viewClasses.indexOf(Object.prototype.toString.call(obj))};Headers.prototype.append=function(name,value){name=normalizeName(name),value=normalizeValue(value);var oldValue=this.map[name];this.map[name]=oldValue?oldValue+', '+value:value},Headers.prototype['delete']=function(name){delete this.map[normalizeName(name)]},Headers.prototype.get=function(name){return name=normalizeName(name),this.has(name)?this.map[name]:null},Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))},Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=normalizeValue(value)},Headers.prototype.forEach=function(callback,thisArg){for(var name in this.map)this.map.hasOwnProperty(name)&&callback.call(thisArg,this.map[name],name,this)},Headers.prototype.keys=function(){var items=[];return this.forEach(function(value,name){items.push(name)}),iteratorFor(items)},Headers.prototype.values=function(){var items=[];return this.forEach(function(value){items.push(value)}),iteratorFor(items)},Headers.prototype.entries=function(){var items=[];return this.forEach(function(value,name){items.push([name,value])}),iteratorFor(items)},support.iterable&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var methods=['DELETE','GET','HEAD','OPTIONS','POST','PUT'];Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var response=new Response(null,{status:0,statusText:''});return response.type='error',response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(-1===redirectStatuses.indexOf(status))throw new RangeError('Invalid status code');return new Response(null,{status:status,headers:{location:url}})};var DOMException=self.DOMException;try{new DOMException}catch(err){DOMException=function(message,name){this.message=message,this.name=name;var error=Error(message);this.stack=error.stack},DOMException.prototype=Object.create(Error.prototype),DOMException.prototype.constructor=DOMException}fetch.polyfill=!0,self.fetch||(self.fetch=fetch,self.Headers=Headers,self.Request=Request,self.Response=Response)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgYmQ5N2FkNmYyMGIzZGMzOGE1YjMiLCJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Nsb25lLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlscy5qcyIsIndlYnBhY2s6Ly8vLi9+L2ZvcmVhY2gvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9ub2RlLWxpYnMtYnJvd3Nlci9+L3Byb2Nlc3MvYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Vycm9ycy5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL21hcC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29uc3RhbnRzL2NvbG9ycy5qcyIsIndlYnBhY2s6Ly8vLi9+L2RlYnVnL3NyYy9icm93c2VyLmpzIiwid2VicGFjazovLy8uL34vaXNhcnJheS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29uc3RhbnRzL2JlYXQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtYXRsYXMtdXZzLWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi92ZW5kb3IvQnVmZmVyR2VvbWV0cnlVdGlscy5qcyIsIndlYnBhY2s6Ly8vLi9+L0BmaXJlYmFzZS9hcHAvZGlzdC9pbmRleC5janMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtZXZlbnQtZGVjb3JhdG9ycy9jb21wb25lbnQtZGVjb3JhdG9ycy5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzL2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvYnVpbGRTZWFyY2hNZXRob2QuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9vbWl0LmpzIiwid2VicGFjazovLy8uL34vaW5oZXJpdHMvaW5oZXJpdHNfYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly8vLi9+L3RzbGliL3RzbGliLmVzNi5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1hYWJiLWNvbGxpZGVyLWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1hdWRpb2FuYWx5c2VyLWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1ldmVudC1zZXQtY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWdlb21ldHJ5LW1lcmdlci1jb21wb25lbnQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtaGFwdGljcy1jb21wb25lbnQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtbGF5b3V0LWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1vcmJpdC1jb250cm9scy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1wcm94eS1ldmVudC1jb21wb25lbnQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtcmluZy1zaGFkZXIvZGlzdC9hZnJhbWUtcmluZy1zaGFkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtc2xpY2U5LWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1zdGF0ZS1jb21wb25lbnQvZGlzdC9hZnJhbWUtc3RhdGUtY29tcG9uZW50LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLXRodW1iLWNvbnRyb2xzLWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguY3NzP2NiNzMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMgXFwuanMkIiwid2VicGFjazovLy8uL3NyYy9zdGF0ZSBcXC5qcyQiLCJ3ZWJwYWNrOi8vLy4vfi9AZmlyZWJhc2UvZmlyZXN0b3JlL2Rpc3QvaW5kZXguY2pzLmpzIiwid2VicGFjazovLy8uL34vQGZpcmViYXNlL2xvZ2dlci9kaXN0L2luZGV4LmVzbS5qcyIsIndlYnBhY2s6Ly8vLi9+L0BmaXJlYmFzZS9wb2x5ZmlsbC9kaXN0L2luZGV4LmVzbS5qcyIsIndlYnBhY2s6Ly8vLi9+L0BmaXJlYmFzZS91dGlsL2Rpc3QvaW5kZXguY2pzLmpzIiwid2VicGFjazovLy8uL34vQGZpcmViYXNlL3dlYmNoYW5uZWwtd3JhcHBlci9kaXN0L2luZGV4LmVzbS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzL2V2ZW50LWJpbmRlci5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1nZW9tZXRyeS1tZXJnZXItY29tcG9uZW50L2xpYi9CdWZmZXJHZW9tZXRyeVV0aWxzLmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLW9yYml0LWNvbnRyb2xzL2xpYi9PcmJpdENvbnRyb2xzLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvQWxnb2xpYVNlYXJjaENvcmUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9JbmRleENvcmUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9icm93c2VyL2J1aWxkcy9hbGdvbGlhc2VhcmNoTGl0ZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvY3JlYXRlQWxnb2xpYXNlYXJjaC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvaW5saW5lLWhlYWRlcnMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9icm93c2VyL2pzb25wLXJlcXVlc3QuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9kZXByZWNhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9kZXByZWNhdGVkTWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2V4aXRQcm9taXNlLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvbWVyZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9wbGFjZXMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9zdG9yZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL3ZlcnNpb24uanMiLCJ3ZWJwYWNrOi8vLy4vYXNzZXRzL3NoYWRlcnMvZmxhdC5qcyIsIndlYnBhY2s6Ly8vLi9hc3NldHMvc2hhZGVycy9zdGFnZUFkZGl0aXZlLmpzIiwid2VicGFjazovLy8uL2Fzc2V0cy9zaGFkZXJzL3N0YWdlTm9ybWFsLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2FjdGl2ZS1jb2xvci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdWRpby1jb2x1bW5zLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2JlYW1zLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2JlYXQtaGl0LXNvdW5kLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2JlYXQtbG9hZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2JlYXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvY29uc29sZS1zaG9ydGN1dHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvY29weS10ZXh0dXJlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2N1cnNvci1sYXNlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jdXJzb3ItbWVzaC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1iZWF0LWxvYWRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2RlYnVnLWN1cnNvci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1zb25nLXRpbWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvZGVidWctc3RhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvZmFrZS1nbG93LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2Zsb29yLXNoYWRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9nYW1lb3Zlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9ncHUtcHJlbG9hZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2hhY2suanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaGFuZC1zd2FwcGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2hhcHRpY3Mtc2FiZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaGFwdGljcy13YWxsLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2hpc3RvcnkuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaW50cm8tc29uZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9rZXlib2FyZC1yYXljYXN0YWJsZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9sZWFkZXJib2FyZC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9sb2dvLWxpZ2h0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2xvZ29mbGlja2VyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL21hdGVyaWFscy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9tZW51LWNvbnRyb2xzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL21lbnUtZGlmZmljdWx0eS1zZWxlY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVudS1zZWxlY3RlZC1jaGFsbGVuZ2UtaW1hZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVudS1zbGlkZS1hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWluZS1mcmFnbWVudHMtbG9hZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL211bHRpcGxpZXItcmluZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9wYXJ0aWNsZXBsYXllci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9wYXVzZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9wYXVzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvcGxheS1zb3VuZC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9yYXljYXN0ZXItdGFyZ2V0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3JlY2VudGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NhYmVyLWNvbnRyb2xzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NhYmVyLXBhcnRpY2xlcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zY29yZS1iZWF0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3Njb3JlLXRleHRzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NlYXJjaC10aHVtYm5haWwtYXRsYXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2VhcmNoLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NvbmctcHJldmlldy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zb25nLXByb2dyZXNzLXJpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc29uZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zdGFnZS1jb2xvcnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc3RhZ2UtbGFzZXJzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N0YWdlLXNoYWRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zdGF0cy1wYXJhbS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zdGVwYmFjay5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zdWItb2JqZWN0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N1cGVyLWtleWJvYXJkLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N1cGVyY3V0Zngtc2hhZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N1cGVyY3V0ZnguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdGV4dC1jb3VudGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3RleHQtdXBwZXJjYXNlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3RvZ2dsZS1wYXVzZS1wbGF5LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3RyYWlsLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3R1dG9yaWFsLTJkLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3R3aXN0ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdmVydGV4LWNvbG9ycy1idWZmZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdmljdG9yeS1hY2N1cmFjeS1yaW5nLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3ZpY3RvcnktcmFuay5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy92aXNpYmxlLXJheWNhc3RhYmxlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3dhbGwtc2hhZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3dhbGwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnN0YW50cy9nZW5yZXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9saWIvc291bmRwb29sLmpzIiwid2VicGFjazovLy8uL3NyYy9zdGF0ZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguY3NzIiwid2VicGFjazovLy8uL34vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9jc3MtbG9hZGVyL2xpYi91cmwvZXNjYXBlLmpzIiwid2VicGFjazovLy8uL34vZGVidWcvc3JjL2NvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi9+L2VzNi1wcm9taXNlL2Rpc3QvZXM2LXByb21pc2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9maXJlYmFzZS9hcHAvZGlzdC9pbmRleC5janMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9maXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5lc20uanMiLCJ3ZWJwYWNrOi8vLy4vfi9nbG9iYWwvd2luZG93LmpzIiwid2VicGFjazovLy8uL34vbXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9vYmplY3Qta2V5cy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L29iamVjdC1rZXlzL2lzQXJndW1lbnRzLmpzIiwid2VicGFjazovLy8uL34vcXVlcnlzdHJpbmctZXMzL2VuY29kZS5qcyIsIndlYnBhY2s6Ly8vLi9+L3NldGltbWVkaWF0ZS9zZXRJbW1lZGlhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9zdHlsZS1sb2FkZXIvbGliL2FkZFN0eWxlcy5qcyIsIndlYnBhY2s6Ly8vLi9+L3N0eWxlLWxvYWRlci9saWIvdXJscy5qcyIsIndlYnBhY2s6Ly8vLi9+L3RpbWVycy1icm93c2VyaWZ5L21haW4uanMiLCJ3ZWJwYWNrOi8vLy4vYXNzZXRzL2ltZy9lbnRlci12ci1idXR0b24tYmFja2dyb3VuZC5wbmciLCJ3ZWJwYWNrOi8vLy4vYXNzZXRzL2ltZy9sb2FkaW5nTG9nby5qcGciLCJ3ZWJwYWNrOi8vLy4vfi93aGF0d2ctZmV0Y2gvZmV0Y2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6ImtCQUNBLHVDQU1BLHFCQUNBLDRDQUdBLDhDQUNBLEdBQ0EsU0FDQSxhQUlBLHVFQUdBLDRCQUdBLFlBQ0EsT0FJQSxzQkF6QkEsZ0NBNEJBLDhCQUdBLHNEQUEyQyxPQUFjLE1BR3pELHFEQUNBLCtCQUNBLDBDQUNBLENBQ0EsZ0JBQ0Esa0JBR0EsUUFHQSx3Q0FDQSwyQkFDQSxnQ0FBMkIsZUFBMEIsVUFDckQsNkJBQWlDLE9BQWUsT0FDaEQsMENBQ0EsUUFDQSxNQUdBLGlEQUFzRCxvREFBK0QsU0FHckgsd0JBR0Esc0VDaEVBLEdBR0EsYUFDQSxPQUNBLEtBQUMsSUFFRCxHQUVBLDBDQUNBLE9BQUMsU0FFRCxDQUNBLDRCQUNBLE9BSTRDLENBRTVDLG1DQ3BCQSxrQ0FDQSxrQ0FDQSx3QkNGTSxDQUtOLE9BQU8sUUFBdUIsYUFIOUIsUUFBUyxjQUFjLEdBQUksS0FDekIsQ0FBUSxNQUFXLEdBSEosbUNBR1UsTUFBUSxJQUNsQyx5QkNIRCw2QkFDQSxrREFFQSwyQ0FDQSxJQUNBLDREQUVBLHlDQUNBLGVBQ0EsWUFBdUIsSUFBTyxFQUM5Qix5QkFHQSxzQkFDQSxxQkFDQSx5QkFJQSx1QkNuQkEsQ0FVQSwyQkFDQSxpQkFDQSxtQ0FDQSw4QkFDQSxpQkFDQSxvQ0FDQSxDQW9CQSx3QkFDQSx1QkFFQSxpQ0FHQSxnRUFDQSxtQ0FDQSwwQkFFQSxNQUVBLDZCQUNBLEVBQUssU0FDTCxJQUVBLHVDQUNBLEVBQVMsU0FFVCx1Q0FDQSxFQUNBLENBR0EsRUFDQSxnQ0FDQSx5QkFFQSxpQ0FHQSw0RUFDQSx1Q0FDQSwwQkFFQSxXQUVBLDJCQUNBLE9BQUssU0FDTCxJQUVBLHFDQUNBLE9BQVMsU0FHVCxxQ0FDQSxPQUNBLENBSUEsQ0FDQSxDQUtBLDBCQUNB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QU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxLQUFNLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLEtBQU0sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLFNBQVUsRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElB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Q0EsMkJBQ0EsTUFFQSxXQUNBLGlEQUVBLDJDQUVBLENBQ0EsK0RBRUEsU0FHQSwrREFDQSxVQUNBLEdBMWZBLFlBQ0EsaUNBQ0EsNENBQ0EsUUFDQSxtQkFDQSxlQUNBLGlCQUNBLElBQ0EsQ0FFQSxVQURBLFFBQ08sU0FDUCxDQUNBLFFBQ0EsQ0FDQSx5QkFDQSxpQ0FDQSxPQU1BLFdBQ0EsNEJBQ0EsQ0FDQSxxQkFDQSxzQkFDQSw2QkFDQSxzQkFDQSx1QkFDQSxzQkFDQSx1QkFDQSx3QkFHQSx5QkFDQSw4QkFDQSxxQkFDQSxjQUNBLDBEQUNBLEVBdURBLDZDQUNBLG9CQUNBLDJCQUNBLDZCQUNBLGtEQUNBLE9BRUEsMENBQ0EsK0JBQ0EsUUFFQSxvQ0FDQSwyQkFDQSxvQ0FDQSxNQUVBLG9DQUNBLDhDQUNBLFFBRUEsMENBQ0EsOENBQ0EsUUFFQSxvREFDQSxzQkFDQSw0QkFDQSxpREFHQSxPQUVBLGlDQUNBLFdBQ0EsMkNBQ0EsWUFDQSxLQUNBLGVBQ0EsUUFFQSxtQ0FDQSxXQUNBLHNDQUNBLFlBQ0EsTUFDQSxlQUNBLFFBRUEsb0NBQ0EsV0FDQSwyQ0FDQSxrQkFDQSxPQUNBLGVBQ0EsTUFFQSxVQUNBLGdFQUNBLFNBb0pBLDJEQThDQSxrQ0FDQSwwQkFBNEIsVUFDNUIsYUFrQ0EsNkJBZ0JBLDhCQUVBLG1DQUNBLG9DQUNBLGFBQ0EsdUJBQ0Esb0NBQ0Esa0JBRUEsT0FFQSx5QkFDQSxpQ0FBcUMsb0JBQ3JDLDBCQUNBLFFBQ0EsVUFFQSwyQ0FFQSxzQ0FDQSxLQUNBLDBEQUdBLGlEQUE2Qix1QkFBMEIsU0FDdkQsUUFFQSxtQ0FDQSxHQUNBLElBQ0EsYUFBQyxXQUNELG9DQUNBLGNBQ0Esa0JBQ0EscUJBQ0EsMEJBQ0EsS0FDQSw2Q0FDQSw4Q0FDQSxhQXNFQSxNQUVBLGlCQUNBLG1CQUNBLG1CQUNBLHFCQUNBLHNCQUNBIiwiZmlsZSI6ImJ1aWxkL2J1aWxkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHRcbiBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTMyKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCBiZDk3YWQ2ZjIwYjNkYzM4YTViMyIsInZhciBnO1xyXG5cclxuLy8gVGhpcyB3b3JrcyBpbiBub24tc3RyaWN0IG1vZGVcclxuZyA9IChmdW5jdGlvbigpIHtcclxuXHRyZXR1cm4gdGhpcztcclxufSkoKTtcclxuXHJcbnRyeSB7XHJcblx0Ly8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApXHJcblx0ZyA9IGcgfHwgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpIHx8ICgxLGV2YWwpKFwidGhpc1wiKTtcclxufSBjYXRjaChlKSB7XHJcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcclxuXHRpZih0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiKVxyXG5cdFx0ZyA9IHdpbmRvdztcclxufVxyXG5cclxuLy8gZyBjYW4gc3RpbGwgYmUgdW5kZWZpbmVkLCBidXQgbm90aGluZyB0byBkbyBhYm91dCBpdC4uLlxyXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xyXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGc7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vICh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qc1xuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNsb25lKG9iaikge1xuICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvYmopKTtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvY2xvbmUuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiY29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly9zYWJlci5zdXBlcm1lZGl1bS5jb20nO1xuXG5mdW5jdGlvbiBnZXRTM0ZpbGVVcmwgKGlkLCBuYW1lKSB7XG4gIHJldHVybiBgJHtCQVNFX1VSTH0vJHtpZH0tJHtuYW1lfT92PTFgO1xufVxubW9kdWxlLmV4cG9ydHMuZ2V0UzNGaWxlVXJsID0gZ2V0UzNGaWxlVXJsO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWxzLmpzIiwiXG52YXIgaGFzT3duID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZm9yRWFjaCAob2JqLCBmbiwgY3R4KSB7XG4gICAgaWYgKHRvU3RyaW5nLmNhbGwoZm4pICE9PSAnW29iamVjdCBGdW5jdGlvbl0nKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2l0ZXJhdG9yIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgIH1cbiAgICB2YXIgbCA9IG9iai5sZW5ndGg7XG4gICAgaWYgKGwgPT09ICtsKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBmbi5jYWxsKGN0eCwgb2JqW2ldLCBpLCBvYmopO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgayBpbiBvYmopIHtcbiAgICAgICAgICAgIGlmIChoYXNPd24uY2FsbChvYmosIGspKSB7XG4gICAgICAgICAgICAgICAgZm4uY2FsbChjdHgsIG9ialtrXSwgaywgb2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9mb3JlYWNoL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vbm9kZS1saWJzLWJyb3dzZXIvfi9wcm9jZXNzL2Jyb3dzZXIuanNcbi8vIG1vZHVsZSBpZCA9IDRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG4vLyBUaGlzIGZpbGUgaG9zdHMgb3VyIGVycm9yIGRlZmluaXRpb25zXG4vLyBXZSB1c2UgY3VzdG9tIGVycm9yIFwidHlwZXNcIiBzbyB0aGF0IHdlIGNhbiBhY3Qgb24gdGhlbSB3aGVuIHdlIG5lZWQgaXRcbi8vIGUuZy46IGlmIGVycm9yIGluc3RhbmNlb2YgZXJyb3JzLlVucGFyc2FibGVKU09OIHRoZW4uLlxuXG52YXIgaW5oZXJpdHMgPSByZXF1aXJlKCdpbmhlcml0cycpO1xuXG5mdW5jdGlvbiBBbGdvbGlhU2VhcmNoRXJyb3IobWVzc2FnZSwgZXh0cmFQcm9wZXJ0aWVzKSB7XG4gIHZhciBmb3JFYWNoID0gcmVxdWlyZSgnZm9yZWFjaCcpO1xuXG4gIHZhciBlcnJvciA9IHRoaXM7XG5cbiAgLy8gdHJ5IHRvIGdldCBhIHN0YWNrdHJhY2VcbiAgaWYgKHR5cGVvZiBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICB9IGVsc2Uge1xuICAgIGVycm9yLnN0YWNrID0gKG5ldyBFcnJvcigpKS5zdGFjayB8fCAnQ2Fubm90IGdldCBhIHN0YWNrdHJhY2UsIGJyb3dzZXIgaXMgdG9vIG9sZCc7XG4gIH1cblxuICB0aGlzLm5hbWUgPSAnQWxnb2xpYVNlYXJjaEVycm9yJztcbiAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcic7XG5cbiAgaWYgKGV4dHJhUHJvcGVydGllcykge1xuICAgIGZvckVhY2goZXh0cmFQcm9wZXJ0aWVzLCBmdW5jdGlvbiBhZGRUb0Vycm9yT2JqZWN0KHZhbHVlLCBrZXkpIHtcbiAgICAgIGVycm9yW2tleV0gPSB2YWx1ZTtcbiAgICB9KTtcbiAgfVxufVxuXG5pbmhlcml0cyhBbGdvbGlhU2VhcmNoRXJyb3IsIEVycm9yKTtcblxuZnVuY3Rpb24gY3JlYXRlQ3VzdG9tRXJyb3IobmFtZSwgbWVzc2FnZSkge1xuICBmdW5jdGlvbiBBbGdvbGlhU2VhcmNoQ3VzdG9tRXJyb3IoKSB7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDApO1xuXG4gICAgLy8gY3VzdG9tIG1lc3NhZ2Ugbm90IHNldCwgdXNlIGRlZmF1bHRcbiAgICBpZiAodHlwZW9mIGFyZ3NbMF0gIT09ICdzdHJpbmcnKSB7XG4gICAgICBhcmdzLnVuc2hpZnQobWVzc2FnZSk7XG4gICAgfVxuXG4gICAgQWxnb2xpYVNlYXJjaEVycm9yLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIHRoaXMubmFtZSA9ICdBbGdvbGlhU2VhcmNoJyArIG5hbWUgKyAnRXJyb3InO1xuICB9XG5cbiAgaW5oZXJpdHMoQWxnb2xpYVNlYXJjaEN1c3RvbUVycm9yLCBBbGdvbGlhU2VhcmNoRXJyb3IpO1xuXG4gIHJldHVybiBBbGdvbGlhU2VhcmNoQ3VzdG9tRXJyb3I7XG59XG5cbi8vIGxhdGUgZXhwb3J0cyB0byBsZXQgdmFyaW91cyBmbiBkZWZzIGFuZCBpbmhlcml0cyB0YWtlIHBsYWNlXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgQWxnb2xpYVNlYXJjaEVycm9yOiBBbGdvbGlhU2VhcmNoRXJyb3IsXG4gIFVucGFyc2FibGVKU09OOiBjcmVhdGVDdXN0b21FcnJvcihcbiAgICAnVW5wYXJzYWJsZUpTT04nLFxuICAgICdDb3VsZCBub3QgcGFyc2UgdGhlIGluY29taW5nIHJlc3BvbnNlIGFzIEpTT04sIHNlZSBlcnIubW9yZSBmb3IgZGV0YWlscydcbiAgKSxcbiAgUmVxdWVzdFRpbWVvdXQ6IGNyZWF0ZUN1c3RvbUVycm9yKFxuICAgICdSZXF1ZXN0VGltZW91dCcsXG4gICAgJ1JlcXVlc3QgdGltZWRvdXQgYmVmb3JlIGdldHRpbmcgYSByZXNwb25zZSdcbiAgKSxcbiAgTmV0d29yazogY3JlYXRlQ3VzdG9tRXJyb3IoXG4gICAgJ05ldHdvcmsnLFxuICAgICdOZXR3b3JrIGlzc3VlLCBzZWUgZXJyLm1vcmUgZm9yIGRldGFpbHMnXG4gICksXG4gIEpTT05QU2NyaXB0RmFpbDogY3JlYXRlQ3VzdG9tRXJyb3IoXG4gICAgJ0pTT05QU2NyaXB0RmFpbCcsXG4gICAgJzxzY3JpcHQ+IHdhcyBsb2FkZWQgYnV0IGRpZCBub3QgY2FsbCBvdXIgcHJvdmlkZWQgY2FsbGJhY2snXG4gICksXG4gIEpTT05QU2NyaXB0RXJyb3I6IGNyZWF0ZUN1c3RvbUVycm9yKFxuICAgICdKU09OUFNjcmlwdEVycm9yJyxcbiAgICAnPHNjcmlwdD4gdW5hYmxlIHRvIGxvYWQgZHVlIHRvIGFuIGBlcnJvcmAgZXZlbnQgb24gaXQnXG4gICksXG4gIFVua25vd246IGNyZWF0ZUN1c3RvbUVycm9yKFxuICAgICdVbmtub3duJyxcbiAgICAnVW5rbm93biBlcnJvciBvY2N1cmVkJ1xuICApXG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Vycm9ycy5qc1xuLy8gbW9kdWxlIGlkID0gNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgZm9yZWFjaCA9IHJlcXVpcmUoJ2ZvcmVhY2gnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBtYXAoYXJyLCBmbikge1xuICB2YXIgbmV3QXJyID0gW107XG4gIGZvcmVhY2goYXJyLCBmdW5jdGlvbihpdGVtLCBpdGVtSW5kZXgpIHtcbiAgICBuZXdBcnIucHVzaChmbihpdGVtLCBpdGVtSW5kZXgsIGFycikpO1xuICB9KTtcbiAgcmV0dXJuIG5ld0Fycjtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvbWFwLmpzXG4vLyBtb2R1bGUgaWQgPSA2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0ge1xuICBPRkY6ICcjMTExJyxcbiAgUkVEOiAnI2ZmM2E3YicsXG4gIEJMVUU6ICcjMDhiZmEyJyxcblxuICBVSV9BQ0NFTlQ6ICcjMDhiZmEyJyxcbiAgVUlfQUNDRU5UMjogJyNmMDE5NzgnLFxuXG4gIFNLWV9PRkY6ICcjMjk3NTQ3JyxcbiAgU0tZX0JMVUU6ICcjODQwZDQyJyxcbiAgU0tZX1JFRDogJyMxNTQxMzYnLFxuXG4gIEJHX09GRjogJyMwODFhMGYnLFxuICBCR19CTFVFOiAnIzM3OWY1ZScsXG4gIEJHX0JSSUdIVEJMVUU6ICcjNGZkOTgzJyxcbiAgQkdfUkVEOiAnI2ZmMWY4MScsXG4gIEJHX0JSSUdIVFJFRDogJyNmZjZiYjAnLFxuXG4gIE5FT05fT0ZGOiAnIzAwMCcsXG4gIE5FT05fQkxVRTogJyMwMDhhNzAnLFxuICBORU9OX0JSSUdIVEJMVUU6ICcjODdjMmZmJyxcbiAgTkVPTl9SRUQ6ICcjZjAxOTc4JyxcbiAgTkVPTl9CUklHSFRSRUQ6ICcjZmY3MGI1JyxcblxuICBURVhUX09GRjogJyMwMDAnLFxuICBURVhUX05PUk1BTDogJyM0NDQnLFxuICBURVhUX0JPTEQ6ICcjODg4JyxcblxuICBCRUFUX1JFRDogJyM2NjAzMzgnLFxuICBCRUFUX0JMVUU6ICcjMDM2NjU3JyxcblxuICBNSU5FX1JFRDogJyMxYzA2MGUnLFxuICBNSU5FX1JFRF9FTUlTU0lPTjogJyMyYTBkMWInLFxuICBNSU5FX0JMVUU6ICcjMDExMTE0JyxcbiAgTUlORV9CTFVFX0VNSVNTSU9OOiAnIzA3MjAyMCcsXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbnN0YW50cy9jb2xvcnMuanMiLCIvKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cblxuLyoqXG4gKiBUaGlzIGlzIHRoZSB3ZWIgYnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBgZGVidWcoKWAuXG4gKi9cblxuZXhwb3J0cy5sb2cgPSBsb2c7XG5leHBvcnRzLmZvcm1hdEFyZ3MgPSBmb3JtYXRBcmdzO1xuZXhwb3J0cy5zYXZlID0gc2F2ZTtcbmV4cG9ydHMubG9hZCA9IGxvYWQ7XG5leHBvcnRzLnVzZUNvbG9ycyA9IHVzZUNvbG9ycztcbmV4cG9ydHMuc3RvcmFnZSA9IGxvY2Fsc3RvcmFnZSgpO1xuXG4vKipcbiAqIENvbG9ycy5cbiAqL1xuXG5leHBvcnRzLmNvbG9ycyA9IFtcblx0JyMwMDAwQ0MnLFxuXHQnIzAwMDBGRicsXG5cdCcjMDAzM0NDJyxcblx0JyMwMDMzRkYnLFxuXHQnIzAwNjZDQycsXG5cdCcjMDA2NkZGJyxcblx0JyMwMDk5Q0MnLFxuXHQnIzAwOTlGRicsXG5cdCcjMDBDQzAwJyxcblx0JyMwMENDMzMnLFxuXHQnIzAwQ0M2NicsXG5cdCcjMDBDQzk5Jyxcblx0JyMwMENDQ0MnLFxuXHQnIzAwQ0NGRicsXG5cdCcjMzMwMENDJyxcblx0JyMzMzAwRkYnLFxuXHQnIzMzMzNDQycsXG5cdCcjMzMzM0ZGJyxcblx0JyMzMzY2Q0MnLFxuXHQnIzMzNjZGRicsXG5cdCcjMzM5OUNDJyxcblx0JyMzMzk5RkYnLFxuXHQnIzMzQ0MwMCcsXG5cdCcjMzNDQzMzJyxcblx0JyMzM0NDNjYnLFxuXHQnIzMzQ0M5OScsXG5cdCcjMzNDQ0NDJyxcblx0JyMzM0NDRkYnLFxuXHQnIzY2MDBDQycsXG5cdCcjNjYwMEZGJyxcblx0JyM2NjMzQ0MnLFxuXHQnIzY2MzNGRicsXG5cdCcjNjZDQzAwJyxcblx0JyM2NkNDMzMnLFxuXHQnIzk5MDBDQycsXG5cdCcjOTkwMEZGJyxcblx0JyM5OTMzQ0MnLFxuXHQnIzk5MzNGRicsXG5cdCcjOTlDQzAwJyxcblx0JyM5OUNDMzMnLFxuXHQnI0NDMDAwMCcsXG5cdCcjQ0MwMDMzJyxcblx0JyNDQzAwNjYnLFxuXHQnI0NDMDA5OScsXG5cdCcjQ0MwMENDJyxcblx0JyNDQzAwRkYnLFxuXHQnI0NDMzMwMCcsXG5cdCcjQ0MzMzMzJyxcblx0JyNDQzMzNjYnLFxuXHQnI0NDMzM5OScsXG5cdCcjQ0MzM0NDJyxcblx0JyNDQzMzRkYnLFxuXHQnI0NDNjYwMCcsXG5cdCcjQ0M2NjMzJyxcblx0JyNDQzk5MDAnLFxuXHQnI0NDOTkzMycsXG5cdCcjQ0NDQzAwJyxcblx0JyNDQ0NDMzMnLFxuXHQnI0ZGMDAwMCcsXG5cdCcjRkYwMDMzJyxcblx0JyNGRjAwNjYnLFxuXHQnI0ZGMDA5OScsXG5cdCcjRkYwMENDJyxcblx0JyNGRjAwRkYnLFxuXHQnI0ZGMzMwMCcsXG5cdCcjRkYzMzMzJyxcblx0JyNGRjMzNjYnLFxuXHQnI0ZGMzM5OScsXG5cdCcjRkYzM0NDJyxcblx0JyNGRjMzRkYnLFxuXHQnI0ZGNjYwMCcsXG5cdCcjRkY2NjMzJyxcblx0JyNGRjk5MDAnLFxuXHQnI0ZGOTkzMycsXG5cdCcjRkZDQzAwJyxcblx0JyNGRkNDMzMnXG5dO1xuXG4vKipcbiAqIEN1cnJlbnRseSBvbmx5IFdlYktpdC1iYXNlZCBXZWIgSW5zcGVjdG9ycywgRmlyZWZveCA+PSB2MzEsXG4gKiBhbmQgdGhlIEZpcmVidWcgZXh0ZW5zaW9uIChhbnkgRmlyZWZveCB2ZXJzaW9uKSBhcmUga25vd25cbiAqIHRvIHN1cHBvcnQgXCIlY1wiIENTUyBjdXN0b21pemF0aW9ucy5cbiAqXG4gKiBUT0RPOiBhZGQgYSBgbG9jYWxTdG9yYWdlYCB2YXJpYWJsZSB0byBleHBsaWNpdGx5IGVuYWJsZS9kaXNhYmxlIGNvbG9yc1xuICovXG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb21wbGV4aXR5XG5mdW5jdGlvbiB1c2VDb2xvcnMoKSB7XG5cdC8vIE5COiBJbiBhbiBFbGVjdHJvbiBwcmVsb2FkIHNjcmlwdCwgZG9jdW1lbnQgd2lsbCBiZSBkZWZpbmVkIGJ1dCBub3QgZnVsbHlcblx0Ly8gaW5pdGlhbGl6ZWQuIFNpbmNlIHdlIGtub3cgd2UncmUgaW4gQ2hyb21lLCB3ZSdsbCBqdXN0IGRldGVjdCB0aGlzIGNhc2Vcblx0Ly8gZXhwbGljaXRseVxuXHRpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LnByb2Nlc3MgJiYgKHdpbmRvdy5wcm9jZXNzLnR5cGUgPT09ICdyZW5kZXJlcicgfHwgd2luZG93LnByb2Nlc3MuX19ud2pzKSkge1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0Ly8gSW50ZXJuZXQgRXhwbG9yZXIgYW5kIEVkZ2UgZG8gbm90IHN1cHBvcnQgY29sb3JzLlxuXHRpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudCAmJiBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goLyhlZGdlfHRyaWRlbnQpXFwvKFxcZCspLykpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvLyBJcyB3ZWJraXQ/IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzE2NDU5NjA2LzM3Njc3M1xuXHQvLyBkb2N1bWVudCBpcyB1bmRlZmluZWQgaW4gcmVhY3QtbmF0aXZlOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QtbmF0aXZlL3B1bGwvMTYzMlxuXHRyZXR1cm4gKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuV2Via2l0QXBwZWFyYW5jZSkgfHxcblx0XHQvLyBJcyBmaXJlYnVnPyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zOTgxMjAvMzc2NzczXG5cdFx0KHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5jb25zb2xlICYmICh3aW5kb3cuY29uc29sZS5maXJlYnVnIHx8ICh3aW5kb3cuY29uc29sZS5leGNlcHRpb24gJiYgd2luZG93LmNvbnNvbGUudGFibGUpKSkgfHxcblx0XHQvLyBJcyBmaXJlZm94ID49IHYzMT9cblx0XHQvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1Rvb2xzL1dlYl9Db25zb2xlI1N0eWxpbmdfbWVzc2FnZXNcblx0XHQodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudCAmJiBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2ZpcmVmb3hcXC8oXFxkKykvKSAmJiBwYXJzZUludChSZWdFeHAuJDEsIDEwKSA+PSAzMSkgfHxcblx0XHQvLyBEb3VibGUgY2hlY2sgd2Via2l0IGluIHVzZXJBZ2VudCBqdXN0IGluIGNhc2Ugd2UgYXJlIGluIGEgd29ya2VyXG5cdFx0KHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci51c2VyQWdlbnQgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9hcHBsZXdlYmtpdFxcLyhcXGQrKS8pKTtcbn1cblxuLyoqXG4gKiBDb2xvcml6ZSBsb2cgYXJndW1lbnRzIGlmIGVuYWJsZWQuXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5mdW5jdGlvbiBmb3JtYXRBcmdzKGFyZ3MpIHtcblx0YXJnc1swXSA9ICh0aGlzLnVzZUNvbG9ycyA/ICclYycgOiAnJykgK1xuXHRcdHRoaXMubmFtZXNwYWNlICtcblx0XHQodGhpcy51c2VDb2xvcnMgPyAnICVjJyA6ICcgJykgK1xuXHRcdGFyZ3NbMF0gK1xuXHRcdCh0aGlzLnVzZUNvbG9ycyA/ICclYyAnIDogJyAnKSArXG5cdFx0JysnICsgbW9kdWxlLmV4cG9ydHMuaHVtYW5pemUodGhpcy5kaWZmKTtcblxuXHRpZiAoIXRoaXMudXNlQ29sb3JzKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3QgYyA9ICdjb2xvcjogJyArIHRoaXMuY29sb3I7XG5cdGFyZ3Muc3BsaWNlKDEsIDAsIGMsICdjb2xvcjogaW5oZXJpdCcpO1xuXG5cdC8vIFRoZSBmaW5hbCBcIiVjXCIgaXMgc29tZXdoYXQgdHJpY2t5LCBiZWNhdXNlIHRoZXJlIGNvdWxkIGJlIG90aGVyXG5cdC8vIGFyZ3VtZW50cyBwYXNzZWQgZWl0aGVyIGJlZm9yZSBvciBhZnRlciB0aGUgJWMsIHNvIHdlIG5lZWQgdG9cblx0Ly8gZmlndXJlIG91dCB0aGUgY29ycmVjdCBpbmRleCB0byBpbnNlcnQgdGhlIENTUyBpbnRvXG5cdGxldCBpbmRleCA9IDA7XG5cdGxldCBsYXN0QyA9IDA7XG5cdGFyZ3NbMF0ucmVwbGFjZSgvJVthLXpBLVolXS9nLCBtYXRjaCA9PiB7XG5cdFx0aWYgKG1hdGNoID09PSAnJSUnKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGluZGV4Kys7XG5cdFx0aWYgKG1hdGNoID09PSAnJWMnKSB7XG5cdFx0XHQvLyBXZSBvbmx5IGFyZSBpbnRlcmVzdGVkIGluIHRoZSAqbGFzdCogJWNcblx0XHRcdC8vICh0aGUgdXNlciBtYXkgaGF2ZSBwcm92aWRlZCB0aGVpciBvd24pXG5cdFx0XHRsYXN0QyA9IGluZGV4O1xuXHRcdH1cblx0fSk7XG5cblx0YXJncy5zcGxpY2UobGFzdEMsIDAsIGMpO1xufVxuXG4vKipcbiAqIEludm9rZXMgYGNvbnNvbGUubG9nKClgIHdoZW4gYXZhaWxhYmxlLlxuICogTm8tb3Agd2hlbiBgY29uc29sZS5sb2dgIGlzIG5vdCBhIFwiZnVuY3Rpb25cIi5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5mdW5jdGlvbiBsb2coLi4uYXJncykge1xuXHQvLyBUaGlzIGhhY2tlcnkgaXMgcmVxdWlyZWQgZm9yIElFOC85LCB3aGVyZVxuXHQvLyB0aGUgYGNvbnNvbGUubG9nYCBmdW5jdGlvbiBkb2Vzbid0IGhhdmUgJ2FwcGx5J1xuXHRyZXR1cm4gdHlwZW9mIGNvbnNvbGUgPT09ICdvYmplY3QnICYmXG5cdFx0Y29uc29sZS5sb2cgJiZcblx0XHRjb25zb2xlLmxvZyguLi5hcmdzKTtcbn1cblxuLyoqXG4gKiBTYXZlIGBuYW1lc3BhY2VzYC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlc1xuICogQGFwaSBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIHNhdmUobmFtZXNwYWNlcykge1xuXHR0cnkge1xuXHRcdGlmIChuYW1lc3BhY2VzKSB7XG5cdFx0XHRleHBvcnRzLnN0b3JhZ2Uuc2V0SXRlbSgnZGVidWcnLCBuYW1lc3BhY2VzKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZXhwb3J0cy5zdG9yYWdlLnJlbW92ZUl0ZW0oJ2RlYnVnJyk7XG5cdFx0fVxuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdC8vIFN3YWxsb3dcblx0XHQvLyBYWFggKEBRaXgtKSBzaG91bGQgd2UgYmUgbG9nZ2luZyB0aGVzZT9cblx0fVxufVxuXG4vKipcbiAqIExvYWQgYG5hbWVzcGFjZXNgLlxuICpcbiAqIEByZXR1cm4ge1N0cmluZ30gcmV0dXJucyB0aGUgcHJldmlvdXNseSBwZXJzaXN0ZWQgZGVidWcgbW9kZXNcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBsb2FkKCkge1xuXHRsZXQgcjtcblx0dHJ5IHtcblx0XHRyID0gZXhwb3J0cy5zdG9yYWdlLmdldEl0ZW0oJ2RlYnVnJyk7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Ly8gU3dhbGxvd1xuXHRcdC8vIFhYWCAoQFFpeC0pIHNob3VsZCB3ZSBiZSBsb2dnaW5nIHRoZXNlP1xuXHR9XG5cblx0Ly8gSWYgZGVidWcgaXNuJ3Qgc2V0IGluIExTLCBhbmQgd2UncmUgaW4gRWxlY3Ryb24sIHRyeSB0byBsb2FkICRERUJVR1xuXHRpZiAoIXIgJiYgdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmICdlbnYnIGluIHByb2Nlc3MpIHtcblx0XHRyID0gcHJvY2Vzcy5lbnYuREVCVUc7XG5cdH1cblxuXHRyZXR1cm4gcjtcbn1cblxuLyoqXG4gKiBMb2NhbHN0b3JhZ2UgYXR0ZW1wdHMgdG8gcmV0dXJuIHRoZSBsb2NhbHN0b3JhZ2UuXG4gKlxuICogVGhpcyBpcyBuZWNlc3NhcnkgYmVjYXVzZSBzYWZhcmkgdGhyb3dzXG4gKiB3aGVuIGEgdXNlciBkaXNhYmxlcyBjb29raWVzL2xvY2Fsc3RvcmFnZVxuICogYW5kIHlvdSBhdHRlbXB0IHRvIGFjY2VzcyBpdC5cbiAqXG4gKiBAcmV0dXJuIHtMb2NhbFN0b3JhZ2V9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBsb2NhbHN0b3JhZ2UoKSB7XG5cdHRyeSB7XG5cdFx0Ly8gVFZNTEtpdCAoQXBwbGUgVFYgSlMgUnVudGltZSkgZG9lcyBub3QgaGF2ZSBhIHdpbmRvdyBvYmplY3QsIGp1c3QgbG9jYWxTdG9yYWdlIGluIHRoZSBnbG9iYWwgY29udGV4dFxuXHRcdC8vIFRoZSBCcm93c2VyIGFsc28gaGFzIGxvY2FsU3RvcmFnZSBpbiB0aGUgZ2xvYmFsIGNvbnRleHQuXG5cdFx0cmV0dXJuIGxvY2FsU3RvcmFnZTtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHQvLyBTd2FsbG93XG5cdFx0Ly8gWFhYIChAUWl4LSkgc2hvdWxkIHdlIGJlIGxvZ2dpbmcgdGhlc2U/XG5cdH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2NvbW1vbicpKGV4cG9ydHMpO1xuXG5jb25zdCB7Zm9ybWF0dGVyc30gPSBtb2R1bGUuZXhwb3J0cztcblxuLyoqXG4gKiBNYXAgJWogdG8gYEpTT04uc3RyaW5naWZ5KClgLCBzaW5jZSBubyBXZWIgSW5zcGVjdG9ycyBkbyB0aGF0IGJ5IGRlZmF1bHQuXG4gKi9cblxuZm9ybWF0dGVycy5qID0gZnVuY3Rpb24gKHYpIHtcblx0dHJ5IHtcblx0XHRyZXR1cm4gSlNPTi5zdHJpbmdpZnkodik7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0cmV0dXJuICdbVW5leHBlY3RlZEpTT05QYXJzZUVycm9yXTogJyArIGVycm9yLm1lc3NhZ2U7XG5cdH1cbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vZGVidWcvc3JjL2Jyb3dzZXIuanNcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhcnIpIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcnIpID09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2lzYXJyYXkvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiZXhwb3J0IGNvbnN0IEJFQVRfV0FSTVVQX09GRlNFVCA9IDI1O1xuZXhwb3J0IGNvbnN0IEJFQVRfV0FSTVVQX1NQRUVEID0gMTU1O1xuZXhwb3J0IGNvbnN0IEJFQVRfV0FSTVVQX1RJTUUgPSAoQkVBVF9XQVJNVVBfT0ZGU0VUIC8gQkVBVF9XQVJNVVBfU1BFRUQpICogMTAwMDtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb25zdGFudHMvYmVhdC5qcyIsIi8vIEZvciBhdXggdXNlLlxudmFyIHV2cyA9IFtcbiAgbmV3IFRIUkVFLlZlY3RvcjIoKSxcbiAgbmV3IFRIUkVFLlZlY3RvcjIoKSxcbiAgbmV3IFRIUkVFLlZlY3RvcjIoKSxcbiAgbmV3IFRIUkVFLlZlY3RvcjIoKVxuXTtcblxuLyoqXG4gKiAxLWluZGV4ZWQuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYXRsYXMtdXZzJywge1xuICBkZXBlbmRlbmNpZXM6IFsnZ2VvbWV0cnknXSxcblxuICBzY2hlbWE6IHtcbiAgICB0b3RhbENvbHVtbnM6IHt0eXBlOiAnaW50JywgZGVmYXVsdDogMX0sXG4gICAgdG90YWxSb3dzOiB7dHlwZTogJ2ludCcsIGRlZmF1bHQ6IDF9LFxuICAgIGNvbHVtbjoge3R5cGU6ICdpbnQnLCBkZWZhdWx0OiAxfSxcbiAgICByb3c6IHt0eXBlOiAnaW50JywgZGVmYXVsdDogMX1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGNvbnN0IHV2cyA9IGdldEdyaWRVdnMoZGF0YS5yb3cgLSAxLCBkYXRhLmNvbHVtbiAtIDEsIGRhdGEudG90YWxSb3dzLCBkYXRhLnRvdGFsQ29sdW1ucyk7XG5cbiAgICBjb25zdCBnZW9tZXRyeSA9IHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5nZW9tZXRyeTtcbiAgICBnZW9tZXRyeS5mYWNlVmVydGV4VXZzWzBdWzBdWzBdLmNvcHkodXZzWzBdKTtcbiAgICBnZW9tZXRyeS5mYWNlVmVydGV4VXZzWzBdWzBdWzFdLmNvcHkodXZzWzFdKTtcbiAgICBnZW9tZXRyeS5mYWNlVmVydGV4VXZzWzBdWzBdWzJdLmNvcHkodXZzWzNdKTtcbiAgICBnZW9tZXRyeS5mYWNlVmVydGV4VXZzWzBdWzFdWzBdLmNvcHkodXZzWzFdKTtcbiAgICBnZW9tZXRyeS5mYWNlVmVydGV4VXZzWzBdWzFdWzFdLmNvcHkodXZzWzJdKTtcbiAgICBnZW9tZXRyeS5mYWNlVmVydGV4VXZzWzBdWzFdWzJdLmNvcHkodXZzWzNdKTtcbiAgICBnZW9tZXRyeS51dnNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgfVxufSk7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZHluYW1pYy10ZXh0dXJlLWF0bGFzJywge1xuICBzY2hlbWE6IHtcbiAgICBjYW52YXNJZDoge2RlZmF1bHQ6ICdkeW5hbWljQXRsYXMnfSxcbiAgICBjYW52YXNIZWlnaHQ6IHtkZWZhdWx0OiAxMDI0fSxcbiAgICBjYW52YXNXaWR0aDoge2RlZmF1bHQ6IDEwMjR9LFxuICAgIGRlYnVnOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIG51bUNvbHVtbnM6IHtkZWZhdWx0OiA4fSxcbiAgICBudW1Sb3dzOiB7ZGVmYXVsdDogOH1cbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgY2FudmFzID0gdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICBjYW52YXMuaWQgPSB0aGlzLmRhdGEuY2FudmFzSWQ7XG4gICAgY2FudmFzLmhlaWdodCA9IHRoaXMuZGF0YS5jYW52YXNIZWlnaHQ7XG4gICAgY2FudmFzLndpZHRoID0gdGhpcy5kYXRhLmNhbnZhc1dpZHRoO1xuICAgIHRoaXMuY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjYW52YXMpO1xuXG4gICAgaWYgKHRoaXMuZGF0YS5kZWJ1Zykge1xuICAgICAgY2FudmFzLnN0eWxlLmxlZnQgPSAwO1xuICAgICAgY2FudmFzLnN0eWxlLnRvcCA9IDA7XG4gICAgICBjYW52YXMuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgICAgY2FudmFzLnN0eWxlLnpJbmRleCA9IDk5OTk5OTk5OTk7XG4gICAgfVxuICB9LFxuXG4gIGRyYXdUZXh0dXJlOiBmdW5jdGlvbiAoaW1hZ2UsIHJvdywgY29sdW1uLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgY29uc3QgY2FudmFzID0gdGhpcy5jYW52YXM7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGlmICghaW1hZ2UuY29tcGxldGUpIHtcbiAgICAgIGltYWdlLm9ubG9hZCA9ICgpID0+IHsgdGhpcy5kcmF3VGV4dHVyZShpbWFnZSwgcm93LCBjb2x1bW4pOyB9XG4gICAgfVxuXG4gICAgY29uc3QgZ3JpZEhlaWdodCA9IGhlaWdodCB8fCAoY2FudmFzLmhlaWdodCAvIGRhdGEubnVtUm93cyk7XG4gICAgY29uc3QgZ3JpZFdpZHRoID0gd2lkdGggfHwgKGNhbnZhcy53aWR0aCAvIGRhdGEubnVtQ29sdW1ucyk7XG5cbiAgICAvLyBpbWFnZSwgZHgsIGR5LCBkd2lkdGgsIGRoZWlnaHRcbiAgICB0aGlzLmN0eC5kcmF3SW1hZ2UoaW1hZ2UsIGdyaWRXaWR0aCAqIHJvdywgZ3JpZFdpZHRoICogY29sdW1uLCBncmlkV2lkdGgsIGdyaWRIZWlnaHQpO1xuXG4gICAgLy8gUmV0dXJuIFVWcy5cbiAgICByZXR1cm4gZ2V0R3JpZFV2cyhyb3csIGNvbHVtbiwgZGF0YS5udW1Sb3dzLCBkYXRhLm51bUNvbHVtbnMpO1xuICB9XG59KTtcblxuLyoqXG4gKiBSZXR1cm4gVVZzIGZvciBhbiB0ZXh0dXJlIHdpdGhpbiBhbiBhdGxhcywgZ2l2ZW4gdGhlIHJvdyBhbmQgY29sdW1uIGluZm8uXG4gKi9cbmZ1bmN0aW9uIGdldEdyaWRVdnMgKHJvdywgY29sdW1uLCB0b3RhbFJvd3MsIHRvdGFsQ29sdW1ucykge1xuICBjb25zdCBjb2x1bW5XaWR0aCA9IDEgLyB0b3RhbENvbHVtbnM7XG4gIGNvbnN0IHJvd0hlaWdodCA9IDEgLyB0b3RhbFJvd3M7XG5cbiAgdXZzWzBdLnNldChjb2x1bW5XaWR0aCAqIGNvbHVtbixcbiAgICAgICAgICAgICByb3dIZWlnaHQgKiByb3cgKyByb3dIZWlnaHQpO1xuICB1dnNbMV0uc2V0KGNvbHVtbldpZHRoICogY29sdW1uLFxuICAgICAgICAgICAgIHJvd0hlaWdodCAqIHJvdyk7XG4gIHV2c1syXS5zZXQoY29sdW1uV2lkdGggKiBjb2x1bW4gKyBjb2x1bW5XaWR0aCxcbiAgICAgICAgICAgICByb3dIZWlnaHQgKiByb3cpO1xuICB1dnNbM10uc2V0KGNvbHVtbldpZHRoICogY29sdW1uICsgY29sdW1uV2lkdGgsXG4gICAgICAgICAgICAgcm93SGVpZ2h0ICogcm93ICsgcm93SGVpZ2h0KTtcbiAgcmV0dXJuIHV2cztcbn1cbm1vZHVsZS5leHBvcnRzLmdldEdyaWRVdnMgPSBnZXRHcmlkVXZzO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1hdGxhcy11dnMtY29tcG9uZW50L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAxMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb20vXG4gKi9cblxuVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscyA9IHtcblxuXHRjb21wdXRlVGFuZ2VudHM6IGZ1bmN0aW9uICggZ2VvbWV0cnkgKSB7XG5cblx0XHR2YXIgaW5kZXggPSBnZW9tZXRyeS5pbmRleDtcblx0XHR2YXIgYXR0cmlidXRlcyA9IGdlb21ldHJ5LmF0dHJpYnV0ZXM7XG5cblx0XHQvLyBiYXNlZCBvbiBodHRwOi8vd3d3LnRlcmF0aG9uLmNvbS9jb2RlL3RhbmdlbnQuaHRtbFxuXHRcdC8vIChwZXIgdmVydGV4IHRhbmdlbnRzKVxuXG5cdFx0aWYgKCBpbmRleCA9PT0gbnVsbCB8fFxuXHRcdFx0IGF0dHJpYnV0ZXMucG9zaXRpb24gPT09IHVuZGVmaW5lZCB8fFxuXHRcdFx0IGF0dHJpYnV0ZXMubm9ybWFsID09PSB1bmRlZmluZWQgfHxcblx0XHRcdCBhdHRyaWJ1dGVzLnV2ID09PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLkJ1ZmZlckdlb21ldHJ5OiBNaXNzaW5nIHJlcXVpcmVkIGF0dHJpYnV0ZXMgKGluZGV4LCBwb3NpdGlvbiwgbm9ybWFsIG9yIHV2KSBpbiBCdWZmZXJHZW9tZXRyeS5jb21wdXRlVGFuZ2VudHMoKScgKTtcblx0XHRcdHJldHVybjtcblxuXHRcdH1cblxuXHRcdHZhciBpbmRpY2VzID0gaW5kZXguYXJyYXk7XG5cdFx0dmFyIHBvc2l0aW9ucyA9IGF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXk7XG5cdFx0dmFyIG5vcm1hbHMgPSBhdHRyaWJ1dGVzLm5vcm1hbC5hcnJheTtcblx0XHR2YXIgdXZzID0gYXR0cmlidXRlcy51di5hcnJheTtcblxuXHRcdHZhciBuVmVydGljZXMgPSBwb3NpdGlvbnMubGVuZ3RoIC8gMztcblxuXHRcdGlmICggYXR0cmlidXRlcy50YW5nZW50ID09PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdGdlb21ldHJ5LmFkZEF0dHJpYnV0ZSggJ3RhbmdlbnQnLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCBuZXcgRmxvYXQzMkFycmF5KCA0ICogblZlcnRpY2VzICksIDQgKSApO1xuXG5cdFx0fVxuXG5cdFx0dmFyIHRhbmdlbnRzID0gYXR0cmlidXRlcy50YW5nZW50LmFycmF5O1xuXG5cdFx0dmFyIHRhbjEgPSBbXSwgdGFuMiA9IFtdO1xuXG5cdFx0Zm9yICggdmFyIGsgPSAwOyBrIDwgblZlcnRpY2VzOyBrICsrICkge1xuXG5cdFx0XHR0YW4xWyBrIF0gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHRcdFx0dGFuMlsgayBdID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuXHRcdH1cblxuXHRcdHZhciB2QSA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXG5cdFx0XHR2QiA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXG5cdFx0XHR2QyA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXG5cblx0XHRcdHV2QSA9IG5ldyBUSFJFRS5WZWN0b3IyKCksXG5cdFx0XHR1dkIgPSBuZXcgVEhSRUUuVmVjdG9yMigpLFxuXHRcdFx0dXZDID0gbmV3IFRIUkVFLlZlY3RvcjIoKSxcblxuXHRcdFx0c2RpciA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXG5cdFx0XHR0ZGlyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuXHRcdGZ1bmN0aW9uIGhhbmRsZVRyaWFuZ2xlKCBhLCBiLCBjICkge1xuXG5cdFx0XHR2QS5mcm9tQXJyYXkoIHBvc2l0aW9ucywgYSAqIDMgKTtcblx0XHRcdHZCLmZyb21BcnJheSggcG9zaXRpb25zLCBiICogMyApO1xuXHRcdFx0dkMuZnJvbUFycmF5KCBwb3NpdGlvbnMsIGMgKiAzICk7XG5cblx0XHRcdHV2QS5mcm9tQXJyYXkoIHV2cywgYSAqIDIgKTtcblx0XHRcdHV2Qi5mcm9tQXJyYXkoIHV2cywgYiAqIDIgKTtcblx0XHRcdHV2Qy5mcm9tQXJyYXkoIHV2cywgYyAqIDIgKTtcblxuXHRcdFx0dmFyIHgxID0gdkIueCAtIHZBLng7XG5cdFx0XHR2YXIgeDIgPSB2Qy54IC0gdkEueDtcblxuXHRcdFx0dmFyIHkxID0gdkIueSAtIHZBLnk7XG5cdFx0XHR2YXIgeTIgPSB2Qy55IC0gdkEueTtcblxuXHRcdFx0dmFyIHoxID0gdkIueiAtIHZBLno7XG5cdFx0XHR2YXIgejIgPSB2Qy56IC0gdkEuejtcblxuXHRcdFx0dmFyIHMxID0gdXZCLnggLSB1dkEueDtcblx0XHRcdHZhciBzMiA9IHV2Qy54IC0gdXZBLng7XG5cblx0XHRcdHZhciB0MSA9IHV2Qi55IC0gdXZBLnk7XG5cdFx0XHR2YXIgdDIgPSB1dkMueSAtIHV2QS55O1xuXG5cdFx0XHR2YXIgciA9IDEuMCAvICggczEgKiB0MiAtIHMyICogdDEgKTtcblxuXHRcdFx0c2Rpci5zZXQoXG5cdFx0XHRcdCggdDIgKiB4MSAtIHQxICogeDIgKSAqIHIsXG5cdFx0XHRcdCggdDIgKiB5MSAtIHQxICogeTIgKSAqIHIsXG5cdFx0XHRcdCggdDIgKiB6MSAtIHQxICogejIgKSAqIHJcblx0XHRcdCk7XG5cblx0XHRcdHRkaXIuc2V0KFxuXHRcdFx0XHQoIHMxICogeDIgLSBzMiAqIHgxICkgKiByLFxuXHRcdFx0XHQoIHMxICogeTIgLSBzMiAqIHkxICkgKiByLFxuXHRcdFx0XHQoIHMxICogejIgLSBzMiAqIHoxICkgKiByXG5cdFx0XHQpO1xuXG5cdFx0XHR0YW4xWyBhIF0uYWRkKCBzZGlyICk7XG5cdFx0XHR0YW4xWyBiIF0uYWRkKCBzZGlyICk7XG5cdFx0XHR0YW4xWyBjIF0uYWRkKCBzZGlyICk7XG5cblx0XHRcdHRhbjJbIGEgXS5hZGQoIHRkaXIgKTtcblx0XHRcdHRhbjJbIGIgXS5hZGQoIHRkaXIgKTtcblx0XHRcdHRhbjJbIGMgXS5hZGQoIHRkaXIgKTtcblxuXHRcdH1cblxuXHRcdHZhciBncm91cHMgPSBnZW9tZXRyeS5ncm91cHM7XG5cblx0XHRpZiAoIGdyb3Vwcy5sZW5ndGggPT09IDAgKSB7XG5cblx0XHRcdGdyb3VwcyA9IFsge1xuXHRcdFx0XHRzdGFydDogMCxcblx0XHRcdFx0Y291bnQ6IGluZGljZXMubGVuZ3RoXG5cdFx0XHR9IF07XG5cblx0XHR9XG5cblx0XHRmb3IgKCB2YXIgaiA9IDAsIGpsID0gZ3JvdXBzLmxlbmd0aDsgaiA8IGpsOyArKyBqICkge1xuXG5cdFx0XHR2YXIgZ3JvdXAgPSBncm91cHNbIGogXTtcblxuXHRcdFx0dmFyIHN0YXJ0ID0gZ3JvdXAuc3RhcnQ7XG5cdFx0XHR2YXIgY291bnQgPSBncm91cC5jb3VudDtcblxuXHRcdFx0Zm9yICggdmFyIGkgPSBzdGFydCwgaWwgPSBzdGFydCArIGNvdW50OyBpIDwgaWw7IGkgKz0gMyApIHtcblxuXHRcdFx0XHRoYW5kbGVUcmlhbmdsZShcblx0XHRcdFx0XHRpbmRpY2VzWyBpICsgMCBdLFxuXHRcdFx0XHRcdGluZGljZXNbIGkgKyAxIF0sXG5cdFx0XHRcdFx0aW5kaWNlc1sgaSArIDIgXVxuXHRcdFx0XHQpO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHR2YXIgdG1wID0gbmV3IFRIUkVFLlZlY3RvcjMoKSwgdG1wMiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cdFx0dmFyIG4gPSBuZXcgVEhSRUUuVmVjdG9yMygpLCBuMiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cdFx0dmFyIHcsIHQsIHRlc3Q7XG5cblx0XHRmdW5jdGlvbiBoYW5kbGVWZXJ0ZXgoIHYgKSB7XG5cblx0XHRcdG4uZnJvbUFycmF5KCBub3JtYWxzLCB2ICogMyApO1xuXHRcdFx0bjIuY29weSggbiApO1xuXG5cdFx0XHR0ID0gdGFuMVsgdiBdO1xuXG5cdFx0XHQvLyBHcmFtLVNjaG1pZHQgb3J0aG9nb25hbGl6ZVxuXG5cdFx0XHR0bXAuY29weSggdCApO1xuXHRcdFx0dG1wLnN1Yiggbi5tdWx0aXBseVNjYWxhciggbi5kb3QoIHQgKSApICkubm9ybWFsaXplKCk7XG5cblx0XHRcdC8vIENhbGN1bGF0ZSBoYW5kZWRuZXNzXG5cblx0XHRcdHRtcDIuY3Jvc3NWZWN0b3JzKCBuMiwgdCApO1xuXHRcdFx0dGVzdCA9IHRtcDIuZG90KCB0YW4yWyB2IF0gKTtcblx0XHRcdHcgPSAoIHRlc3QgPCAwLjAgKSA/IC0gMS4wIDogMS4wO1xuXG5cdFx0XHR0YW5nZW50c1sgdiAqIDQgXSA9IHRtcC54O1xuXHRcdFx0dGFuZ2VudHNbIHYgKiA0ICsgMSBdID0gdG1wLnk7XG5cdFx0XHR0YW5nZW50c1sgdiAqIDQgKyAyIF0gPSB0bXAuejtcblx0XHRcdHRhbmdlbnRzWyB2ICogNCArIDMgXSA9IHc7XG5cblx0XHR9XG5cblx0XHRmb3IgKCB2YXIgaiA9IDAsIGpsID0gZ3JvdXBzLmxlbmd0aDsgaiA8IGpsOyArKyBqICkge1xuXG5cdFx0XHR2YXIgZ3JvdXAgPSBncm91cHNbIGogXTtcblxuXHRcdFx0dmFyIHN0YXJ0ID0gZ3JvdXAuc3RhcnQ7XG5cdFx0XHR2YXIgY291bnQgPSBncm91cC5jb3VudDtcblxuXHRcdFx0Zm9yICggdmFyIGkgPSBzdGFydCwgaWwgPSBzdGFydCArIGNvdW50OyBpIDwgaWw7IGkgKz0gMyApIHtcblxuXHRcdFx0XHRoYW5kbGVWZXJ0ZXgoIGluZGljZXNbIGkgKyAwIF0gKTtcblx0XHRcdFx0aGFuZGxlVmVydGV4KCBpbmRpY2VzWyBpICsgMSBdICk7XG5cdFx0XHRcdGhhbmRsZVZlcnRleCggaW5kaWNlc1sgaSArIDIgXSApO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0fSxcblxuXHQvKipcblx0ICogQHBhcmFtICB7QXJyYXk8VEhSRUUuQnVmZmVyR2VvbWV0cnk+fSBnZW9tZXRyaWVzXG5cdCAqIEByZXR1cm4ge1RIUkVFLkJ1ZmZlckdlb21ldHJ5fVxuXHQgKi9cblx0bWVyZ2VCdWZmZXJHZW9tZXRyaWVzOiBmdW5jdGlvbiAoIGdlb21ldHJpZXMsIHVzZUdyb3VwcyApIHtcblxuXHRcdHZhciBpc0luZGV4ZWQgPSBnZW9tZXRyaWVzWyAwIF0uaW5kZXggIT09IG51bGw7XG5cblx0XHR2YXIgYXR0cmlidXRlc1VzZWQgPSBuZXcgU2V0KCBPYmplY3Qua2V5cyggZ2VvbWV0cmllc1sgMCBdLmF0dHJpYnV0ZXMgKSApO1xuXHRcdHZhciBtb3JwaEF0dHJpYnV0ZXNVc2VkID0gbmV3IFNldCggT2JqZWN0LmtleXMoIGdlb21ldHJpZXNbIDAgXS5tb3JwaEF0dHJpYnV0ZXMgKSApO1xuXG5cdFx0dmFyIGF0dHJpYnV0ZXMgPSB7fTtcblx0XHR2YXIgbW9ycGhBdHRyaWJ1dGVzID0ge307XG5cblx0XHR2YXIgbWVyZ2VkR2VvbWV0cnkgPSBuZXcgVEhSRUUuQnVmZmVyR2VvbWV0cnkoKTtcblxuXHRcdHZhciBvZmZzZXQgPSAwO1xuXG5cdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgZ2VvbWV0cmllcy5sZW5ndGg7ICsrIGkgKSB7XG5cblx0XHRcdHZhciBnZW9tZXRyeSA9IGdlb21ldHJpZXNbIGkgXTtcblxuXHRcdFx0Ly8gZW5zdXJlIHRoYXQgYWxsIGdlb21ldHJpZXMgYXJlIGluZGV4ZWQsIG9yIG5vbmVcblxuXHRcdFx0aWYgKCBpc0luZGV4ZWQgIT09ICggZ2VvbWV0cnkuaW5kZXggIT09IG51bGwgKSApIHJldHVybiBudWxsO1xuXG5cdFx0XHQvLyBnYXRoZXIgYXR0cmlidXRlcywgZXhpdCBlYXJseSBpZiB0aGV5J3JlIGRpZmZlcmVudFxuXG5cdFx0XHRmb3IgKCB2YXIgbmFtZSBpbiBnZW9tZXRyeS5hdHRyaWJ1dGVzICkge1xuXG5cdFx0XHRcdGlmICggIWF0dHJpYnV0ZXNVc2VkLmhhcyggbmFtZSApICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdFx0aWYgKCBhdHRyaWJ1dGVzWyBuYW1lIF0gPT09IHVuZGVmaW5lZCApIGF0dHJpYnV0ZXNbIG5hbWUgXSA9IFtdO1xuXG5cdFx0XHRcdGF0dHJpYnV0ZXNbIG5hbWUgXS5wdXNoKCBnZW9tZXRyeS5hdHRyaWJ1dGVzWyBuYW1lIF0gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBnYXRoZXIgbW9ycGggYXR0cmlidXRlcywgZXhpdCBlYXJseSBpZiB0aGV5J3JlIGRpZmZlcmVudFxuXG5cdFx0XHRmb3IgKCB2YXIgbmFtZSBpbiBnZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXMgKSB7XG5cblx0XHRcdFx0aWYgKCAhbW9ycGhBdHRyaWJ1dGVzVXNlZC5oYXMoIG5hbWUgKSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRcdGlmICggbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0gPT09IHVuZGVmaW5lZCApIG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdID0gW107XG5cblx0XHRcdFx0bW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0ucHVzaCggZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBnYXRoZXIgLnVzZXJEYXRhXG5cblx0XHRcdG1lcmdlZEdlb21ldHJ5LnVzZXJEYXRhLm1lcmdlZFVzZXJEYXRhID0gbWVyZ2VkR2VvbWV0cnkudXNlckRhdGEubWVyZ2VkVXNlckRhdGEgfHwgW107XG5cdFx0XHRtZXJnZWRHZW9tZXRyeS51c2VyRGF0YS5tZXJnZWRVc2VyRGF0YS5wdXNoKCBnZW9tZXRyeS51c2VyRGF0YSApO1xuXG5cdFx0XHRpZiAoIHVzZUdyb3VwcyApIHtcblxuXHRcdFx0XHR2YXIgY291bnQ7XG5cblx0XHRcdFx0aWYgKCBpc0luZGV4ZWQgKSB7XG5cblx0XHRcdFx0XHRjb3VudCA9IGdlb21ldHJ5LmluZGV4LmNvdW50O1xuXG5cdFx0XHRcdH0gZWxzZSBpZiAoIGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24gIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHRcdGNvdW50ID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5jb3VudDtcblxuXHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdG1lcmdlZEdlb21ldHJ5LmFkZEdyb3VwKCBvZmZzZXQsIGNvdW50LCBpICk7XG5cblx0XHRcdFx0b2Zmc2V0ICs9IGNvdW50O1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHQvLyBtZXJnZSBpbmRpY2VzXG5cblx0XHRpZiAoIGlzSW5kZXhlZCApIHtcblxuXHRcdFx0dmFyIGluZGV4T2Zmc2V0ID0gMDtcblx0XHRcdHZhciBpbmRleExpc3QgPSBbXTtcblxuXHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgZ2VvbWV0cmllcy5sZW5ndGg7ICsrIGkgKSB7XG5cblx0XHRcdFx0dmFyIGluZGV4ID0gZ2VvbWV0cmllc1sgaSBdLmluZGV4O1xuXG5cdFx0XHRcdGlmICggaW5kZXhPZmZzZXQgPiAwICkge1xuXG5cdFx0XHRcdFx0aW5kZXggPSBpbmRleC5jbG9uZSgpO1xuXG5cdFx0XHRcdFx0Zm9yICggdmFyIGogPSAwOyBqIDwgaW5kZXguY291bnQ7ICsrIGogKSB7XG5cblx0XHRcdFx0XHRcdGluZGV4LnNldFgoIGosIGluZGV4LmdldFgoIGogKSArIGluZGV4T2Zmc2V0ICk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGluZGV4TGlzdC5wdXNoKCBpbmRleCApO1xuXHRcdFx0XHRpbmRleE9mZnNldCArPSBnZW9tZXRyaWVzWyBpIF0uYXR0cmlidXRlcy5wb3NpdGlvbi5jb3VudDtcblxuXHRcdFx0fVxuXG5cdFx0XHR2YXIgbWVyZ2VkSW5kZXggPSB0aGlzLm1lcmdlQnVmZmVyQXR0cmlidXRlcyggaW5kZXhMaXN0ICk7XG5cblx0XHRcdGlmICggIW1lcmdlZEluZGV4ICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdG1lcmdlZEdlb21ldHJ5LmluZGV4ID0gbWVyZ2VkSW5kZXg7XG5cblx0XHR9XG5cblx0XHQvLyBtZXJnZSBhdHRyaWJ1dGVzXG5cblx0XHRmb3IgKCB2YXIgbmFtZSBpbiBhdHRyaWJ1dGVzICkge1xuXG5cdFx0XHR2YXIgbWVyZ2VkQXR0cmlidXRlID0gdGhpcy5tZXJnZUJ1ZmZlckF0dHJpYnV0ZXMoIGF0dHJpYnV0ZXNbIG5hbWUgXSApO1xuXG5cdFx0XHRpZiAoICEgbWVyZ2VkQXR0cmlidXRlICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdG1lcmdlZEdlb21ldHJ5LmFkZEF0dHJpYnV0ZSggbmFtZSwgbWVyZ2VkQXR0cmlidXRlICk7XG5cblx0XHR9XG5cblx0XHQvLyBtZXJnZSBtb3JwaCBhdHRyaWJ1dGVzXG5cblx0XHRmb3IgKCB2YXIgbmFtZSBpbiBtb3JwaEF0dHJpYnV0ZXMgKSB7XG5cblx0XHRcdHZhciBudW1Nb3JwaFRhcmdldHMgPSBtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXVsgMCBdLmxlbmd0aDtcblxuXHRcdFx0aWYgKCBudW1Nb3JwaFRhcmdldHMgPT09IDAgKSBicmVhaztcblxuXHRcdFx0bWVyZ2VkR2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzID0gbWVyZ2VkR2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzIHx8IHt9O1xuXHRcdFx0bWVyZ2VkR2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0gPSBbXTtcblxuXHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgbnVtTW9ycGhUYXJnZXRzOyArKyBpICkge1xuXG5cdFx0XHRcdHZhciBtb3JwaEF0dHJpYnV0ZXNUb01lcmdlID0gW107XG5cblx0XHRcdFx0Zm9yICggdmFyIGogPSAwOyBqIDwgbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0ubGVuZ3RoOyArKyBqICkge1xuXG5cdFx0XHRcdFx0bW9ycGhBdHRyaWJ1dGVzVG9NZXJnZS5wdXNoKCBtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXVsgaiBdWyBpIF0gKTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIG1lcmdlZE1vcnBoQXR0cmlidXRlID0gdGhpcy5tZXJnZUJ1ZmZlckF0dHJpYnV0ZXMoIG1vcnBoQXR0cmlidXRlc1RvTWVyZ2UgKTtcblxuXHRcdFx0XHRpZiAoICFtZXJnZWRNb3JwaEF0dHJpYnV0ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRcdG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlc1sgbmFtZSBdLnB1c2goIG1lcmdlZE1vcnBoQXR0cmlidXRlICk7XG5cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdHJldHVybiBtZXJnZWRHZW9tZXRyeTtcblxuXHR9LFxuXG5cdC8qKlxuXHQgKiBAcGFyYW0ge0FycmF5PFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZT59IGF0dHJpYnV0ZXNcblx0ICogQHJldHVybiB7VEhSRUUuQnVmZmVyQXR0cmlidXRlfVxuXHQgKi9cblx0bWVyZ2VCdWZmZXJBdHRyaWJ1dGVzOiBmdW5jdGlvbiAoIGF0dHJpYnV0ZXMgKSB7XG5cblx0XHR2YXIgVHlwZWRBcnJheTtcblx0XHR2YXIgaXRlbVNpemU7XG5cdFx0dmFyIG5vcm1hbGl6ZWQ7XG5cdFx0dmFyIGFycmF5TGVuZ3RoID0gMDtcblxuXHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyArKyBpICkge1xuXG5cdFx0XHR2YXIgYXR0cmlidXRlID0gYXR0cmlidXRlc1sgaSBdO1xuXG5cdFx0XHRpZiAoIGF0dHJpYnV0ZS5pc0ludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdGlmICggVHlwZWRBcnJheSA9PT0gdW5kZWZpbmVkICkgVHlwZWRBcnJheSA9IGF0dHJpYnV0ZS5hcnJheS5jb25zdHJ1Y3Rvcjtcblx0XHRcdGlmICggVHlwZWRBcnJheSAhPT0gYXR0cmlidXRlLmFycmF5LmNvbnN0cnVjdG9yICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdGlmICggaXRlbVNpemUgPT09IHVuZGVmaW5lZCApIGl0ZW1TaXplID0gYXR0cmlidXRlLml0ZW1TaXplO1xuXHRcdFx0aWYgKCBpdGVtU2l6ZSAhPT0gYXR0cmlidXRlLml0ZW1TaXplICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdGlmICggbm9ybWFsaXplZCA9PT0gdW5kZWZpbmVkICkgbm9ybWFsaXplZCA9IGF0dHJpYnV0ZS5ub3JtYWxpemVkO1xuXHRcdFx0aWYgKCBub3JtYWxpemVkICE9PSBhdHRyaWJ1dGUubm9ybWFsaXplZCApIHJldHVybiBudWxsO1xuXG5cdFx0XHRhcnJheUxlbmd0aCArPSBhdHRyaWJ1dGUuYXJyYXkubGVuZ3RoO1xuXG5cdFx0fVxuXG5cdFx0dmFyIGFycmF5ID0gbmV3IFR5cGVkQXJyYXkoIGFycmF5TGVuZ3RoICk7XG5cdFx0dmFyIG9mZnNldCA9IDA7XG5cblx0XHRmb3IgKCB2YXIgaiA9IDA7IGogPCBhdHRyaWJ1dGVzLmxlbmd0aDsgKysgaiApIHtcblxuXHRcdFx0YXJyYXkuc2V0KCBhdHRyaWJ1dGVzWyBqIF0uYXJyYXksIG9mZnNldCApO1xuXG5cdFx0XHRvZmZzZXQgKz0gYXR0cmlidXRlc1sgaiBdLmFycmF5Lmxlbmd0aDtcblxuXHRcdH1cblxuXHRcdHJldHVybiBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCBhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQgKTtcblxuXHR9XG5cbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi92ZW5kb3IvQnVmZmVyR2VvbWV0cnlVdGlscy5qcyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcblxudmFyIHV0aWwgPSByZXF1aXJlKCdAZmlyZWJhc2UvdXRpbCcpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIGNvbnRhaW5zID0gZnVuY3Rpb24gKG9iaiwga2V5KSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcclxufTtcclxudmFyIERFRkFVTFRfRU5UUllfTkFNRSA9ICdbREVGQVVMVF0nO1xyXG4vLyBBbiBhcnJheSB0byBjYXB0dXJlIGxpc3RlbmVycyBiZWZvcmUgdGhlIHRydWUgYXV0aCBmdW5jdGlvbnNcclxuLy8gZXhpc3RcclxudmFyIHRva2VuTGlzdGVuZXJzID0gW107XHJcbi8qKlxyXG4gKiBHbG9iYWwgY29udGV4dCBvYmplY3QgZm9yIGEgY29sbGVjdGlvbiBvZiBzZXJ2aWNlcyB1c2luZ1xyXG4gKiBhIHNoYXJlZCBhdXRoZW50aWNhdGlvbiBzdGF0ZS5cclxuICovXHJcbnZhciBGaXJlYmFzZUFwcEltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJlYmFzZUFwcEltcGwob3B0aW9ucywgY29uZmlnLCBmaXJlYmFzZV8pIHtcclxuICAgICAgICB0aGlzLmZpcmViYXNlXyA9IGZpcmViYXNlXztcclxuICAgICAgICB0aGlzLmlzRGVsZXRlZF8gPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNlcnZpY2VzXyA9IHt9O1xyXG4gICAgICAgIHRoaXMubmFtZV8gPSBjb25maWcubmFtZTtcclxuICAgICAgICB0aGlzLl9hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQgPVxyXG4gICAgICAgICAgICBjb25maWcuYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkIHx8IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub3B0aW9uc18gPSB1dGlsLmRlZXBDb3B5KG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuSU5URVJOQUwgPSB7XHJcbiAgICAgICAgICAgIGdldFVpZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gbnVsbDsgfSxcclxuICAgICAgICAgICAgZ2V0VG9rZW46IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTsgfSxcclxuICAgICAgICAgICAgYWRkQXV0aFRva2VuTGlzdGVuZXI6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgdG9rZW5MaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7XHJcbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgY2FsbGJhY2sgaXMgY2FsbGVkLCBhc3luY2hyb25vdXNseSwgaW4gdGhlIGFic2VuY2Ugb2YgdGhlIGF1dGggbW9kdWxlXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNhbGxiYWNrKG51bGwpOyB9LCAwKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcmVtb3ZlQXV0aFRva2VuTGlzdGVuZXI6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgdG9rZW5MaXN0ZW5lcnMgPSB0b2tlbkxpc3RlbmVycy5maWx0ZXIoZnVuY3Rpb24gKGxpc3RlbmVyKSB7IHJldHVybiBsaXN0ZW5lciAhPT0gY2FsbGJhY2s7IH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLCBcImF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWRfKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZF8oKTtcclxuICAgICAgICAgICAgdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID0gdmFsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUsIFwibmFtZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWRfKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWVfO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUsIFwib3B0aW9uc1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWRfKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNfO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgX3RoaXMuY2hlY2tEZXN0cm95ZWRfKCk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmZpcmViYXNlXy5JTlRFUk5BTC5yZW1vdmVBcHAoX3RoaXMubmFtZV8pO1xyXG4gICAgICAgICAgICB2YXIgc2VydmljZXMgPSBbXTtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMoX3RoaXMuc2VydmljZXNfKS5mb3JFYWNoKGZ1bmN0aW9uIChzZXJ2aWNlS2V5KSB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhfdGhpcy5zZXJ2aWNlc19bc2VydmljZUtleV0pLmZvckVhY2goZnVuY3Rpb24gKGluc3RhbmNlS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZXMucHVzaChfdGhpcy5zZXJ2aWNlc19bc2VydmljZUtleV1baW5zdGFuY2VLZXldKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHNlcnZpY2VzLm1hcChmdW5jdGlvbiAoc2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2UuSU5URVJOQUwuZGVsZXRlKCk7XHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmlzRGVsZXRlZF8gPSB0cnVlO1xyXG4gICAgICAgICAgICBfdGhpcy5zZXJ2aWNlc18gPSB7fTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBhIHNlcnZpY2UgaW5zdGFuY2UgYXNzb2NpYXRlZCB3aXRoIHRoaXMgYXBwIChjcmVhdGluZyBpdFxyXG4gICAgICogb24gZGVtYW5kKSwgaWRlbnRpZmllZCBieSB0aGUgcGFzc2VkIGluc3RhbmNlSWRlbnRpZmllci5cclxuICAgICAqXHJcbiAgICAgKiBOT1RFOiBDdXJyZW50bHkgc3RvcmFnZSBpcyB0aGUgb25seSBvbmUgdGhhdCBpcyBsZXZlcmFnaW5nIHRoaXNcclxuICAgICAqIGZ1bmN0aW9uYWxpdHkuIFRoZXkgaW52b2tlIGl0IGJ5IGNhbGxpbmc6XHJcbiAgICAgKlxyXG4gICAgICogYGBgamF2YXNjcmlwdFxyXG4gICAgICogZmlyZWJhc2UuYXBwKCkuc3RvcmFnZSgnU1RPUkFHRSBCVUNLRVQgSUQnKVxyXG4gICAgICogYGBgXHJcbiAgICAgKlxyXG4gICAgICogVGhlIHNlcnZpY2UgbmFtZSBpcyBwYXNzZWQgdG8gdGhpcyBhbHJlYWR5XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZS5fZ2V0U2VydmljZSA9IGZ1bmN0aW9uIChuYW1lLCBpbnN0YW5jZUlkZW50aWZpZXIpIHtcclxuICAgICAgICBpZiAoaW5zdGFuY2VJZGVudGlmaWVyID09PSB2b2lkIDApIHsgaW5zdGFuY2VJZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FOyB9XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZF8oKTtcclxuICAgICAgICBpZiAoIXRoaXMuc2VydmljZXNfW25hbWVdKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VydmljZXNfW25hbWVdID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5zZXJ2aWNlc19bbmFtZV1baW5zdGFuY2VJZGVudGlmaWVyXSkge1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogSWYgYSBjdXN0b20gaW5zdGFuY2UgaGFzIGJlZW4gZGVmaW5lZCAoaS5lLiBub3QgJ1tERUZBVUxUXScpXHJcbiAgICAgICAgICAgICAqIHRoZW4gd2Ugd2lsbCBwYXNzIHRoYXQgaW5zdGFuY2Ugb24sIG90aGVyd2lzZSB3ZSBwYXNzIGBudWxsYFxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdmFyIGluc3RhbmNlU3BlY2lmaWVyID0gaW5zdGFuY2VJZGVudGlmaWVyICE9PSBERUZBVUxUX0VOVFJZX05BTUVcclxuICAgICAgICAgICAgICAgID8gaW5zdGFuY2VJZGVudGlmaWVyXHJcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgdmFyIHNlcnZpY2UgPSB0aGlzLmZpcmViYXNlXy5JTlRFUk5BTC5mYWN0b3JpZXNbbmFtZV0odGhpcywgdGhpcy5leHRlbmRBcHAuYmluZCh0aGlzKSwgaW5zdGFuY2VTcGVjaWZpZXIpO1xyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VzX1tuYW1lXVtpbnN0YW5jZUlkZW50aWZpZXJdID0gc2VydmljZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZXNfW25hbWVdW2luc3RhbmNlSWRlbnRpZmllcl07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsYmFjayBmdW5jdGlvbiB1c2VkIHRvIGV4dGVuZCBhbiBBcHAgaW5zdGFuY2UgYXQgdGhlIHRpbWVcclxuICAgICAqIG9mIHNlcnZpY2UgaW5zdGFuY2UgY3JlYXRpb24uXHJcbiAgICAgKi9cclxuICAgIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUuZXh0ZW5kQXBwID0gZnVuY3Rpb24gKHByb3BzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBDb3B5IHRoZSBvYmplY3Qgb250byB0aGUgRmlyZWJhc2VBcHBJbXBsIHByb3RvdHlwZVxyXG4gICAgICAgIHV0aWwuZGVlcEV4dGVuZCh0aGlzLCBwcm9wcyk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogSWYgdGhlIGFwcCBoYXMgb3ZlcndyaXR0ZW4gdGhlIGFkZEF1dGhUb2tlbkxpc3RlbmVyIHN0dWIsIGZvcndhcmRcclxuICAgICAgICAgKiB0aGUgYWN0aXZlIHRva2VuIGxpc3RlbmVycyBvbiB0byB0aGUgdHJ1ZSBmeG4uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBUT0RPOiBUaGlzIGZ1bmN0aW9uIGlzIHJlcXVpcmVkIGR1ZSB0byBvdXIgY3VycmVudCBtb2R1bGVcclxuICAgICAgICAgKiBzdHJ1Y3R1cmUuIE9uY2Ugd2UgYXJlIGFibGUgdG8gcmVseSBzdHJpY3RseSB1cG9uIGEgc2luZ2xlIG1vZHVsZVxyXG4gICAgICAgICAqIGltcGxlbWVudGF0aW9uLCB0aGlzIGNvZGUgc2hvdWxkIGJlIHJlZmFjdG9yZWQgYW5kIEF1dGggc2hvdWxkXHJcbiAgICAgICAgICogcHJvdmlkZSB0aGVzZSBzdHVicyBhbmQgdGhlIHVwZ3JhZGUgbG9naWNcclxuICAgICAgICAgKi9cclxuICAgICAgICBpZiAocHJvcHMuSU5URVJOQUwgJiYgcHJvcHMuSU5URVJOQUwuYWRkQXV0aFRva2VuTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdG9rZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLklOVEVSTkFMLmFkZEF1dGhUb2tlbkxpc3RlbmVyKGxpc3RlbmVyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRva2VuTGlzdGVuZXJzID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiB3aWxsIHRocm93IGFuIEVycm9yIGlmIHRoZSBBcHAgaGFzIGFscmVhZHkgYmVlbiBkZWxldGVkIC1cclxuICAgICAqIHVzZSBiZWZvcmUgcGVyZm9ybWluZyBBUEkgYWN0aW9ucyBvbiB0aGUgQXBwLlxyXG4gICAgICovXHJcbiAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLmNoZWNrRGVzdHJveWVkXyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0RlbGV0ZWRfKSB7XHJcbiAgICAgICAgICAgIGVycm9yKCdhcHAtZGVsZXRlZCcsIHsgbmFtZTogdGhpcy5uYW1lXyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpcmViYXNlQXBwSW1wbDtcclxufSgpKTtcclxuLy8gUHJldmVudCBkZWFkLWNvZGUgZWxpbWluYXRpb24gb2YgdGhlc2UgbWV0aG9kcyB3L28gaW52YWxpZCBwcm9wZXJ0eVxyXG4vLyBjb3B5aW5nLlxyXG4oRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZS5uYW1lICYmIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUub3B0aW9ucykgfHxcclxuICAgIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUuZGVsZXRlIHx8XHJcbiAgICBjb25zb2xlLmxvZygnZGMnKTtcclxuLyoqXHJcbiAqIFJldHVybiBhIGZpcmViYXNlIG5hbWVzcGFjZSBvYmplY3QuXHJcbiAqXHJcbiAqIEluIHByb2R1Y3Rpb24sIHRoaXMgd2lsbCBiZSBjYWxsZWQgZXhhY3RseSBvbmNlIGFuZCB0aGUgcmVzdWx0XHJcbiAqIGFzc2lnbmVkIHRvIHRoZSAnZmlyZWJhc2UnIGdsb2JhbC4gIEl0IG1heSBiZSBjYWxsZWQgbXVsdGlwbGUgdGltZXNcclxuICogaW4gdW5pdCB0ZXN0cy5cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZUZpcmViYXNlTmFtZXNwYWNlKCkge1xyXG4gICAgdmFyIGFwcHNfID0ge307XHJcbiAgICB2YXIgZmFjdG9yaWVzID0ge307XHJcbiAgICB2YXIgYXBwSG9va3MgPSB7fTtcclxuICAgIC8vIEEgbmFtZXNwYWNlIGlzIGEgcGxhaW4gSmF2YVNjcmlwdCBPYmplY3QuXHJcbiAgICB2YXIgbmFtZXNwYWNlID0ge1xyXG4gICAgICAgIC8vIEhhY2sgdG8gcHJldmVudCBCYWJlbCBmcm9tIG1vZGlmeWluZyB0aGUgb2JqZWN0IHJldHVybmVkXHJcbiAgICAgICAgLy8gYXMgdGhlIGZpcmViYXNlIG5hbWVzcGFjZS5cclxuICAgICAgICBfX2VzTW9kdWxlOiB0cnVlLFxyXG4gICAgICAgIGluaXRpYWxpemVBcHA6IGluaXRpYWxpemVBcHAsXHJcbiAgICAgICAgYXBwOiBhcHAsXHJcbiAgICAgICAgYXBwczogbnVsbCxcclxuICAgICAgICBQcm9taXNlOiBQcm9taXNlLFxyXG4gICAgICAgIFNES19WRVJTSU9OOiAnNS41LjAnLFxyXG4gICAgICAgIElOVEVSTkFMOiB7XHJcbiAgICAgICAgICAgIHJlZ2lzdGVyU2VydmljZTogcmVnaXN0ZXJTZXJ2aWNlLFxyXG4gICAgICAgICAgICBjcmVhdGVGaXJlYmFzZU5hbWVzcGFjZTogY3JlYXRlRmlyZWJhc2VOYW1lc3BhY2UsXHJcbiAgICAgICAgICAgIGV4dGVuZE5hbWVzcGFjZTogZXh0ZW5kTmFtZXNwYWNlLFxyXG4gICAgICAgICAgICBjcmVhdGVTdWJzY3JpYmU6IHV0aWwuY3JlYXRlU3Vic2NyaWJlLFxyXG4gICAgICAgICAgICBFcnJvckZhY3Rvcnk6IHV0aWwuRXJyb3JGYWN0b3J5LFxyXG4gICAgICAgICAgICByZW1vdmVBcHA6IHJlbW92ZUFwcCxcclxuICAgICAgICAgICAgZmFjdG9yaWVzOiBmYWN0b3JpZXMsXHJcbiAgICAgICAgICAgIHVzZUFzU2VydmljZTogdXNlQXNTZXJ2aWNlLFxyXG4gICAgICAgICAgICBQcm9taXNlOiBQcm9taXNlLFxyXG4gICAgICAgICAgICBkZWVwRXh0ZW5kOiB1dGlsLmRlZXBFeHRlbmRcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gSW5qZWN0IGEgY2lyY3VsYXIgZGVmYXVsdCBleHBvcnQgdG8gYWxsb3cgQmFiZWwgdXNlcnMgd2hvIHdlcmUgcHJldmlvdXNseVxyXG4gICAgLy8gdXNpbmc6XHJcbiAgICAvL1xyXG4gICAgLy8gICBpbXBvcnQgZmlyZWJhc2UgZnJvbSAnZmlyZWJhc2UnO1xyXG4gICAgLy8gICB3aGljaCBiZWNvbWVzOiB2YXIgZmlyZWJhc2UgPSByZXF1aXJlKCdmaXJlYmFzZScpLmRlZmF1bHQ7XHJcbiAgICAvL1xyXG4gICAgLy8gaW5zdGVhZCBvZlxyXG4gICAgLy9cclxuICAgIC8vICAgaW1wb3J0ICogYXMgZmlyZWJhc2UgZnJvbSAnZmlyZWJhc2UnO1xyXG4gICAgLy8gICB3aGljaCBiZWNvbWVzOiB2YXIgZmlyZWJhc2UgPSByZXF1aXJlKCdmaXJlYmFzZScpO1xyXG4gICAgdXRpbC5wYXRjaFByb3BlcnR5KG5hbWVzcGFjZSwgJ2RlZmF1bHQnLCBuYW1lc3BhY2UpO1xyXG4gICAgLy8gZmlyZWJhc2UuYXBwcyBpcyBhIHJlYWQtb25seSBnZXR0ZXIuXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmFtZXNwYWNlLCAnYXBwcycsIHtcclxuICAgICAgICBnZXQ6IGdldEFwcHNcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgYnkgQXBwLmRlbGV0ZSgpIC0gYnV0IGJlZm9yZSBhbnkgc2VydmljZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBBcHBcclxuICAgICAqIGFyZSBkZWxldGVkLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiByZW1vdmVBcHAobmFtZSkge1xyXG4gICAgICAgIHZhciBhcHAgPSBhcHBzX1tuYW1lXTtcclxuICAgICAgICBjYWxsQXBwSG9va3MoYXBwLCAnZGVsZXRlJyk7XHJcbiAgICAgICAgZGVsZXRlIGFwcHNfW25hbWVdO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIEFwcCBvYmplY3QgZm9yIGEgZ2l2ZW4gbmFtZSAob3IgREVGQVVMVCkuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGFwcChuYW1lKSB7XHJcbiAgICAgICAgbmFtZSA9IG5hbWUgfHwgREVGQVVMVF9FTlRSWV9OQU1FO1xyXG4gICAgICAgIGlmICghY29udGFpbnMoYXBwc18sIG5hbWUpKSB7XHJcbiAgICAgICAgICAgIGVycm9yKCduby1hcHAnLCB7IG5hbWU6IG5hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhcHBzX1tuYW1lXTtcclxuICAgIH1cclxuICAgIHV0aWwucGF0Y2hQcm9wZXJ0eShhcHAsICdBcHAnLCBGaXJlYmFzZUFwcEltcGwpO1xyXG4gICAgZnVuY3Rpb24gaW5pdGlhbGl6ZUFwcChvcHRpb25zLCByYXdDb25maWcpIHtcclxuICAgICAgICBpZiAocmF3Q29uZmlnID09PSB2b2lkIDApIHsgcmF3Q29uZmlnID0ge307IH1cclxuICAgICAgICBpZiAodHlwZW9mIHJhd0NvbmZpZyAhPT0gJ29iamVjdCcgfHwgcmF3Q29uZmlnID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lXzEgPSByYXdDb25maWc7XHJcbiAgICAgICAgICAgIHJhd0NvbmZpZyA9IHsgbmFtZTogbmFtZV8xIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjb25maWcgPSByYXdDb25maWc7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5uYW1lID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgY29uZmlnLm5hbWUgPSBERUZBVUxUX0VOVFJZX05BTUU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuYW1lID0gY29uZmlnLm5hbWU7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJyB8fCAhbmFtZSkge1xyXG4gICAgICAgICAgICBlcnJvcignYmFkLWFwcC1uYW1lJywgeyBuYW1lOiBuYW1lICsgJycgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb250YWlucyhhcHBzXywgbmFtZSkpIHtcclxuICAgICAgICAgICAgZXJyb3IoJ2R1cGxpY2F0ZS1hcHAnLCB7IG5hbWU6IG5hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBhcHAgPSBuZXcgRmlyZWJhc2VBcHBJbXBsKG9wdGlvbnMsIGNvbmZpZywgbmFtZXNwYWNlKTtcclxuICAgICAgICBhcHBzX1tuYW1lXSA9IGFwcDtcclxuICAgICAgICBjYWxsQXBwSG9va3MoYXBwLCAnY3JlYXRlJyk7XHJcbiAgICAgICAgcmV0dXJuIGFwcDtcclxuICAgIH1cclxuICAgIC8qXHJcbiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgb2YgYWxsIHRoZSBub24tZGVsZXRlZCBGaXJlYmFzZUFwcHMuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdldEFwcHMoKSB7XHJcbiAgICAgICAgLy8gTWFrZSBhIGNvcHkgc28gY2FsbGVyIGNhbm5vdCBtdXRhdGUgdGhlIGFwcHMgbGlzdC5cclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoYXBwc18pLm1hcChmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gYXBwc19bbmFtZV07IH0pO1xyXG4gICAgfVxyXG4gICAgLypcclxuICAgICAqIFJlZ2lzdGVyIGEgRmlyZWJhc2UgU2VydmljZS5cclxuICAgICAqXHJcbiAgICAgKiBmaXJlYmFzZS5JTlRFUk5BTC5yZWdpc3RlclNlcnZpY2UoKVxyXG4gICAgICpcclxuICAgICAqIFRPRE86IEltcGxlbWVudCBzZXJ2aWNlUHJvcGVydGllcy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlKG5hbWUsIGNyZWF0ZVNlcnZpY2UsIHNlcnZpY2VQcm9wZXJ0aWVzLCBhcHBIb29rLCBhbGxvd011bHRpcGxlSW5zdGFuY2VzKSB7XHJcbiAgICAgICAgLy8gQ2Fubm90IHJlLXJlZ2lzdGVyIGEgc2VydmljZSB0aGF0IGFscmVhZHkgZXhpc3RzXHJcbiAgICAgICAgaWYgKGZhY3Rvcmllc1tuYW1lXSkge1xyXG4gICAgICAgICAgICBlcnJvcignZHVwbGljYXRlLXNlcnZpY2UnLCB7IG5hbWU6IG5hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIENhcHR1cmUgdGhlIHNlcnZpY2UgZmFjdG9yeSBmb3IgbGF0ZXIgc2VydmljZSBpbnN0YW50aWF0aW9uXHJcbiAgICAgICAgZmFjdG9yaWVzW25hbWVdID0gY3JlYXRlU2VydmljZTtcclxuICAgICAgICAvLyBDYXB0dXJlIHRoZSBhcHBIb29rLCBpZiBwYXNzZWRcclxuICAgICAgICBpZiAoYXBwSG9vaykge1xyXG4gICAgICAgICAgICBhcHBIb29rc1tuYW1lXSA9IGFwcEhvb2s7XHJcbiAgICAgICAgICAgIC8vIFJ1biB0aGUgKipuZXcqKiBhcHAgaG9vayBvbiBhbGwgZXhpc3RpbmcgYXBwc1xyXG4gICAgICAgICAgICBnZXRBcHBzKCkuZm9yRWFjaChmdW5jdGlvbiAoYXBwKSB7XHJcbiAgICAgICAgICAgICAgICBhcHBIb29rKCdjcmVhdGUnLCBhcHApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVGhlIFNlcnZpY2UgbmFtZXNwYWNlIGlzIGFuIGFjY2Vzc29yIGZ1bmN0aW9uIC4uLlxyXG4gICAgICAgIHZhciBzZXJ2aWNlTmFtZXNwYWNlID0gZnVuY3Rpb24gKGFwcEFyZykge1xyXG4gICAgICAgICAgICBpZiAoYXBwQXJnID09PSB2b2lkIDApIHsgYXBwQXJnID0gYXBwKCk7IH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcHBBcmdbbmFtZV0gIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIC8vIEludmFsaWQgYXJndW1lbnQuXHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGhhcHBlbnMgaW4gdGhlIGZvbGxvd2luZyBjYXNlOiBmaXJlYmFzZS5zdG9yYWdlKCdnczovJylcclxuICAgICAgICAgICAgICAgIGVycm9yKCdpbnZhbGlkLWFwcC1hcmd1bWVudCcsIHsgbmFtZTogbmFtZSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBGb3J3YXJkIHNlcnZpY2UgaW5zdGFuY2UgbG9va3VwIHRvIHRoZSBGaXJlYmFzZUFwcC5cclxuICAgICAgICAgICAgcmV0dXJuIGFwcEFyZ1tuYW1lXSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gLi4uIGFuZCBhIGNvbnRhaW5lciBmb3Igc2VydmljZS1sZXZlbCBwcm9wZXJ0aWVzLlxyXG4gICAgICAgIGlmIChzZXJ2aWNlUHJvcGVydGllcyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHV0aWwuZGVlcEV4dGVuZChzZXJ2aWNlTmFtZXNwYWNlLCBzZXJ2aWNlUHJvcGVydGllcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE1vbmtleS1wYXRjaCB0aGUgc2VydmljZU5hbWVzcGFjZSBvbnRvIHRoZSBmaXJlYmFzZSBuYW1lc3BhY2VcclxuICAgICAgICBuYW1lc3BhY2VbbmFtZV0gPSBzZXJ2aWNlTmFtZXNwYWNlO1xyXG4gICAgICAgIC8vIFBhdGNoIHRoZSBGaXJlYmFzZUFwcEltcGwgcHJvdG90eXBlXHJcbiAgICAgICAgRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgc2VydmljZUZ4biA9IHRoaXMuX2dldFNlcnZpY2UuYmluZCh0aGlzLCBuYW1lKTtcclxuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2VGeG4uYXBwbHkodGhpcywgYWxsb3dNdWx0aXBsZUluc3RhbmNlcyA/IGFyZ3MgOiBbXSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZU5hbWVzcGFjZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUGF0Y2ggdGhlIHRvcC1sZXZlbCBmaXJlYmFzZSBuYW1lc3BhY2Ugd2l0aCBhZGRpdGlvbmFsIHByb3BlcnRpZXMuXHJcbiAgICAgKlxyXG4gICAgICogZmlyZWJhc2UuSU5URVJOQUwuZXh0ZW5kTmFtZXNwYWNlKClcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZXh0ZW5kTmFtZXNwYWNlKHByb3BzKSB7XHJcbiAgICAgICAgdXRpbC5kZWVwRXh0ZW5kKG5hbWVzcGFjZSwgcHJvcHMpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY2FsbEFwcEhvb2tzKGFwcCwgZXZlbnROYW1lKSB7XHJcbiAgICAgICAgT2JqZWN0LmtleXMoZmFjdG9yaWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChzZXJ2aWNlTmFtZSkge1xyXG4gICAgICAgICAgICAvLyBJZ25vcmUgdmlydHVhbCBzZXJ2aWNlc1xyXG4gICAgICAgICAgICB2YXIgZmFjdG9yeU5hbWUgPSB1c2VBc1NlcnZpY2UoYXBwLCBzZXJ2aWNlTmFtZSk7XHJcbiAgICAgICAgICAgIGlmIChmYWN0b3J5TmFtZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhcHBIb29rc1tmYWN0b3J5TmFtZV0pIHtcclxuICAgICAgICAgICAgICAgIGFwcEhvb2tzW2ZhY3RvcnlOYW1lXShldmVudE5hbWUsIGFwcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8vIE1hcCB0aGUgcmVxdWVzdGVkIHNlcnZpY2UgdG8gYSByZWdpc3RlcmVkIHNlcnZpY2UgbmFtZVxyXG4gICAgLy8gKHVzZWQgdG8gbWFwIGF1dGggdG8gc2VydmVyQXV0aCBzZXJ2aWNlIHdoZW4gbmVlZGVkKS5cclxuICAgIGZ1bmN0aW9uIHVzZUFzU2VydmljZShhcHAsIG5hbWUpIHtcclxuICAgICAgICBpZiAobmFtZSA9PT0gJ3NlcnZlckF1dGgnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdXNlU2VydmljZSA9IG5hbWU7XHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSBhcHAub3B0aW9ucztcclxuICAgICAgICByZXR1cm4gdXNlU2VydmljZTtcclxuICAgIH1cclxuICAgIHJldHVybiBuYW1lc3BhY2U7XHJcbn1cclxuZnVuY3Rpb24gZXJyb3IoY29kZSwgYXJncykge1xyXG4gICAgdGhyb3cgYXBwRXJyb3JzLmNyZWF0ZShjb2RlLCBhcmdzKTtcclxufVxyXG4vLyBUeXBlU2NyaXB0IGRvZXMgbm90IHN1cHBvcnQgbm9uLXN0cmluZyBpbmRleGVzIVxyXG4vLyBsZXQgZXJyb3JzOiB7W2NvZGU6IEFwcEVycm9yOiBzdHJpbmd9ID0ge1xyXG52YXIgZXJyb3JzID0ge1xyXG4gICAgJ25vLWFwcCc6IFwiTm8gRmlyZWJhc2UgQXBwICd7JG5hbWV9JyBoYXMgYmVlbiBjcmVhdGVkIC0gXCIgK1xyXG4gICAgICAgICdjYWxsIEZpcmViYXNlIEFwcC5pbml0aWFsaXplQXBwKCknLFxyXG4gICAgJ2JhZC1hcHAtbmFtZSc6IFwiSWxsZWdhbCBBcHAgbmFtZTogJ3skbmFtZX1cIixcclxuICAgICdkdXBsaWNhdGUtYXBwJzogXCJGaXJlYmFzZSBBcHAgbmFtZWQgJ3skbmFtZX0nIGFscmVhZHkgZXhpc3RzXCIsXHJcbiAgICAnYXBwLWRlbGV0ZWQnOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRuYW1lfScgYWxyZWFkeSBkZWxldGVkXCIsXHJcbiAgICAnZHVwbGljYXRlLXNlcnZpY2UnOiBcIkZpcmViYXNlIHNlcnZpY2UgbmFtZWQgJ3skbmFtZX0nIGFscmVhZHkgcmVnaXN0ZXJlZFwiLFxyXG4gICAgJ3NhLW5vdC1zdXBwb3J0ZWQnOiAnSW5pdGlhbGl6aW5nIHRoZSBGaXJlYmFzZSBTREsgd2l0aCBhIHNlcnZpY2UgJyArXHJcbiAgICAgICAgJ2FjY291bnQgaXMgb25seSBhbGxvd2VkIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC4gT24gY2xpZW50ICcgK1xyXG4gICAgICAgICdkZXZpY2VzLCB5b3Ugc2hvdWxkIGluc3RlYWQgaW5pdGlhbGl6ZSB0aGUgU0RLIHdpdGggYW4gYXBpIGtleSBhbmQgJyArXHJcbiAgICAgICAgJ2F1dGggZG9tYWluJyxcclxuICAgICdpbnZhbGlkLWFwcC1hcmd1bWVudCc6ICdmaXJlYmFzZS57JG5hbWV9KCkgdGFrZXMgZWl0aGVyIG5vIGFyZ3VtZW50IG9yIGEgJyArXHJcbiAgICAgICAgJ0ZpcmViYXNlIEFwcCBpbnN0YW5jZS4nXHJcbn07XHJcbnZhciBhcHBFcnJvcnMgPSBuZXcgdXRpbC5FcnJvckZhY3RvcnkoJ2FwcCcsICdGaXJlYmFzZScsIGVycm9ycyk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgZmlyZWJhc2UgPSBjcmVhdGVGaXJlYmFzZU5hbWVzcGFjZSgpO1xuXG5leHBvcnRzLmZpcmViYXNlID0gZmlyZWJhc2U7XG5leHBvcnRzLmRlZmF1bHQgPSBmaXJlYmFzZTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9AZmlyZWJhc2UvYXBwL2Rpc3QvaW5kZXguY2pzLmpzXG4vLyBtb2R1bGUgaWQgPSAxM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKiBnbG9iYWwgQUZSQU1FICovXHJcblxyXG4vKlxyXG4gKiBQcm92aWRlcyBhIHNpbXBsZSBBUEkgZm9yIGNyZWF0aW5nIGRlY29yYXRvciBmdW5jdGlvbnMgd2hpY2ggeW91IGNhbiBhcHBseSB0byB5b3VyIENvbXBvbmVudCBkZWZpbml0aW9ucy5cclxuICogVGhlc2UgZGVjb3JhdGVkIGZ1bmN0aW9ucyBhcmUgZXhlY3V0ZWQgd2hlbiB0aGVpciBDb21wb25lbnQgaXMgaW5zdGFudGlhdGVkLCBhbmQgaGF2ZSB0aGVpciAndGhpcycgYXR0cmlidXRlIHNldFxyXG4gKiB0byB0aGUgbmV3IENvbXBvbmVudC5cclxuICpcclxuICogRGVjb3JhdG9ycyBzaG91bGQgb25seSBiZSB1c2VkIG9uIGZ1bmN0aW9ucyB0aGF0IGFyZSBvd25lZCBieSBDb21wb25lbnQgZGVzY3JpcHRvcnMgcmVnaXN0ZXJlZCB3aXRoXHJcbiAqIEFGUkFNRS5yZWdpc3RlckNvbXBvbmVudC4gRGVjb3JhdGluZyBhbnkgb3RoZXIgZnVuY3Rpb24gd2lsbCBoYXZlIG5vIGVmZmVjdCwgYXMgdGhlIGRlY29yYXRvclxyXG4gKiBmdW5jdG9yIHdpbGwgbmV2ZXIgYmUgZXhlY3V0ZWQuXHJcbiAqL1xyXG5cclxuLypcclxuICogRGVjb3JhdGVzIGEgZnVuY3Rpb24gd2l0aCBhIGZ1bmN0b3IgdGhhdCBpcyBleGVjdXRlZCBpbiB0aGUgY29udGV4dCBvZiBlYWNoIGluc3RhbnRpYXRlZCBDb21wb25lbnQgd2hpY2ggb3ducyBpdC5cclxuICpcclxuICogQHBhcmFtIGZ1bmMgLSBGdW5jdGlvbiB0byBkZWNvcmF0ZS5cclxuICogQHBhcmFtIGRlY29yYXRvckZ1bmMgLSBGdW5jdG9yIHdoaWNoIGRlY29yYXRlcyBmdW5jLiBJdCdzIGRlZmluaXRpb24gc2hvdWxkIGFwcGVhciBsaWtlIHRoaXM6XHJcbiAqICAgIGZ1bmN0aW9uIGRlY29yYXRvckZ1bmN0b3IoZnVuY1Byb3BlcnR5TmFtZSkge1xyXG4gKiAgICAgIGNvbnN0IGZ1bmMgPSB0aGlzW2Z1bmNQcm9wZXJ0eU5hbWVdOyAvLyAndGhpcycgaXMgYXNzaWduZWQgdG8gdGhlIGluc3RhbnRpYXRlZCBDb21wb25lbnQuXHJcbiAqICAgICAgLy8gRGVjb3JhdG9yIHNob3VsZCByZXR1cm4gYSBmdW5jdGlvblxyXG4gKiAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAqICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmVsLmlkICsgXCIgaGFzIGEgZGVjb3JhdGVkIGZ1bmN0aW9uIVwiKTtcclxuICogICAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAqICAgICAgfVxyXG4gKiAgICB9XHJcbiAqXHJcbiAqIEByZXR1cm5zIEEgcGVuZGluZyBkZWNvcmF0ZWQgZnVuY3RvciB3aGljaCB3aWxsIGJlIGV4ZWN1dGVkIHdoZW4gYSBjb21wb25lbnQgdGhhdCBvd25zIGl0IGlzIGluc3RhbnRpYXRlZC5cclxuICovXHJcbmZ1bmN0aW9uIGRlY29yYXRlKGZ1bmMsIGRlY29yYXRvckZ1bmMpIHtcclxuICByZXR1cm4gZGVjb3JhdGlvbnMuYWRkKGZ1bmMsIGRlY29yYXRvckZ1bmMpO1xyXG59XHJcblxyXG4vLyBIZWxwZXIgZm9yIHN0b3JpbmcgYW5kIHJldHJpZXZpbmcgZGVjb3JhdG9yIGZ1bmN0b3JzIGZvciBhIGdpdmVuIGZ1bmN0aW9uLlxyXG5jb25zdCBkZWNvcmF0aW9ucyA9IChmdW5jdGlvbigpIHtcclxuICBjb25zdCBmdW5jTWFwID0gbmV3IFdlYWtNYXAoKTtcclxuXHJcbiAgZnVuY3Rpb24gYWRkKGZ1bmMsIGRlY29yYXRvcikge1xyXG4gICAgY29uc3QgcGFyZW50ID0gZnVuY01hcC5oYXMoZnVuYykgPyBmdW5jIDogdW5kZWZpbmVkOyAvLyBJbiBjYXNlIGRlY29yYXRvcnMgYXJlIG5lc3RlZC5cclxuICAgIGNvbnN0IGRlY29yYXRlZEZ1bmMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgfVxyXG4gICAgZnVuY01hcC5zZXQoZGVjb3JhdGVkRnVuYywge3BhcmVudDogcGFyZW50LCBkZWNvcmF0b3I6IGRlY29yYXRvcn0pO1xyXG4gICAgcmV0dXJuIGRlY29yYXRlZEZ1bmM7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRBbGwoZnVuYykge1xyXG4gICAgdmFyIGl0ZXIgPSBmdW5jTWFwLmdldChmdW5jKTtcclxuICAgIHZhciBkZWNvcmF0b3JzID0gW107XHJcbiAgICB3aGlsZSAoaXRlciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGRlY29yYXRvcnMucHVzaChpdGVyLmRlY29yYXRvcik7XHJcbiAgICAgIGl0ZXIgPSBpdGVyLnBhcmVudDtcclxuICAgIH1cclxuICAgIHJldHVybiBkZWNvcmF0b3JzO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaXNGdW5jdGlvbkRlY29yYXRlZChmdW5jKSB7XHJcbiAgICByZXR1cm4gZnVuY01hcC5oYXMoZnVuYyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgYWRkOiBhZGQsXHJcbiAgICBnZXRBbGw6IGdldEFsbCxcclxuICAgIGlzRnVuY3Rpb25EZWNvcmF0ZWQ6IGlzRnVuY3Rpb25EZWNvcmF0ZWRcclxuICB9XHJcbn0pKCk7XHJcblxyXG4vLyBIZXJlIEknbSB3cmFwcGluZyB0aGUgQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50IGZ1bmN0aW9uIGFuZCBhbHNvIGVhY2ggQ29tcG9uZW50IGNvbnN0cnVjdG9yLiBXaGVuZXZlciBhIG5ldyBjb21wb25lbnRcclxuLy8gaXMgaW5zdGFudGlhdGVkIEknbSBzY2FubmluZyBpdHMgbGlzdCBvZiBwcm9wZXJ0aWVzIGZvciBhbnkgZnVuY3Rpb25zIHdoaWNoIGhhdmUgYmVlbiBkZWNvcmF0ZWQuIEVhY2ggZGVjb3JhdGlvblxyXG4vLyBmdW5jdG9yIHdpbGwgdGhlbiBiZSBleGVjdXRlZCBpbiB0aGUgY29udGV4dCBvZiB0aGUgY29tcG9uZW50IHdoaWNoIG93bnMgdGhlIGZ1bmN0aW9uLlxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgT2JqZWN0LmtleXMoQUZSQU1FLmNvbXBvbmVudHMpLmZvckVhY2goIGZ1bmN0aW9uKGMpIHtcclxuICAgIHdyYXBDb21wb25lbnQoYylcclxuICB9KTtcclxuICB3cmFwUmVnaXN0ZXIoKTtcclxuXHJcbiAgZnVuY3Rpb24gZXhlY3V0ZURlY29yYXRvcnNPbk5ld0NvbXBvbmVudChjb21wb25lbnQpIHtcclxuICAgIGNvbnN0IHByb3QgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoY29tcG9uZW50KTtcclxuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHByb3QpLmZvckVhY2goIGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgY29uc3QgcHJvcCA9IHByb3RbbmFtZV07XHJcbiAgICAgIGlmICh0eXBlb2YgcHJvcCA9PT0gXCJmdW5jdGlvblwiICYmIGRlY29yYXRpb25zLmlzRnVuY3Rpb25EZWNvcmF0ZWQocHJvcCkpIHtcclxuICAgICAgICBkZWNvcmF0aW9ucy5nZXRBbGwocHJvcCkuZm9yRWFjaChmdW5jdGlvbihkZWNvcmF0b3IpIHtcclxuICAgICAgICAgIGNvbXBvbmVudFtuYW1lXSA9IGRlY29yYXRvci5jYWxsKGNvbXBvbmVudCwgbmFtZSwgcHJvcCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gd3JhcENvbXBvbmVudChuYW1lKSB7XHJcbiAgICBjb25zdCBvcmlnID0gQUZSQU1FLmNvbXBvbmVudHNbbmFtZV0uQ29tcG9uZW50O1xyXG5cclxuICAgIEFGUkFNRS5jb21wb25lbnRzW25hbWVdLkNvbXBvbmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAvLyBPdmVycmlkZSBpbml0IG9uIHRoZSBpbnN0YW5jZSB0byBleGVjdXRlIHRoZSBkZWNvcmF0b3IgZnVuY3RvcnMgYmVmb3JlIGluaXRpYWxpemluZy5cclxuICAgICAgdGhpcy5pbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMuaW5pdDtcclxuICAgICAgICBleGVjdXRlRGVjb3JhdG9yc09uTmV3Q29tcG9uZW50KHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB9XHJcbiAgICAgIG9yaWcuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgIH1cclxuICAgIEFGUkFNRS5jb21wb25lbnRzW25hbWVdLkNvbXBvbmVudC5wcm90b3R5cGUgPSBvcmlnLnByb3RvdHlwZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHdyYXBSZWdpc3RlcigpIHtcclxuICAgIGNvbnN0IG9yaWdSZWdpc3RlciA9IEFGUkFNRS5yZWdpc3RlckNvbXBvbmVudDtcclxuICAgIEFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgb3JpZ1JlZ2lzdGVyLmFwcGx5KEFGUkFNRSwgYXJndW1lbnRzKTtcclxuICAgICAgcmV0dXJuIHdyYXBDb21wb25lbnQobmFtZSk7XHJcbiAgICB9XHJcbiAgfVxyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMuZGVjb3JhdGUgPSBkZWNvcmF0ZTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMvY29tcG9uZW50LWRlY29yYXRvcnMuanNcbi8vIG1vZHVsZSBpZCA9IDE0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qIGdsb2JhbCBBRlJBTUUgKi9cblxuaWYgKHR5cGVvZiBBRlJBTUUgPT09ICd1bmRlZmluZWQnKSB7XG4gIHRocm93IG5ldyBFcnJvcignYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMgd2FzIGxvYWRlZCBiZWZvcmUgQUZSQU1FIHdhcyBhdmFpbGFibGUnKTtcbn1cblxuY29uc3QgZXZlbnRCaW5kZXIgPSByZXF1aXJlKFwiLi9ldmVudC1iaW5kZXJcIik7XG5jb25zdCBkZWNvcmF0ZSA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudC1kZWNvcmF0b3JzXCIpLmRlY29yYXRlO1xuXG5tb2R1bGUuZXhwb3J0cy5iaW5kRXZlbnQgPSBldmVudEJpbmRlci5iaW5kRXZlbnQ7XG5tb2R1bGUuZXhwb3J0cy5iaW5kRXZlbnRQbGF5UGF1c2UgPSBldmVudEJpbmRlci5iaW5kRXZlbnRQbGF5UGF1c2U7XG5tb2R1bGUuZXhwb3J0cy5kZWNvcmF0ZSA9IGRlY29yYXRlO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtZXZlbnQtZGVjb3JhdG9ycy9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMTVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBidWlsZFNlYXJjaE1ldGhvZDtcblxudmFyIGVycm9ycyA9IHJlcXVpcmUoJy4vZXJyb3JzLmpzJyk7XG5cbi8qKlxuICogQ3JlYXRlcyBhIHNlYXJjaCBtZXRob2QgdG8gYmUgdXNlZCBpbiBjbGllbnRzXG4gKiBAcGFyYW0ge3N0cmluZ30gcXVlcnlQYXJhbSB0aGUgbmFtZSBvZiB0aGUgYXR0cmlidXRlIHVzZWQgZm9yIHRoZSBxdWVyeVxuICogQHBhcmFtIHtzdHJpbmd9IHVybCB0aGUgdXJsXG4gKiBAcmV0dXJuIHtmdW5jdGlvbn0gdGhlIHNlYXJjaCBtZXRob2RcbiAqL1xuZnVuY3Rpb24gYnVpbGRTZWFyY2hNZXRob2QocXVlcnlQYXJhbSwgdXJsKSB7XG4gIC8qKlxuICAgKiBUaGUgc2VhcmNoIG1ldGhvZC4gUHJlcGFyZXMgdGhlIGRhdGEgYW5kIHNlbmQgdGhlIHF1ZXJ5IHRvIEFsZ29saWEuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBxdWVyeSB0aGUgc3RyaW5nIHVzZWQgZm9yIHF1ZXJ5IHNlYXJjaFxuICAgKiBAcGFyYW0ge29iamVjdH0gYXJncyBhZGRpdGlvbmFsIHBhcmFtZXRlcnMgdG8gc2VuZCB3aXRoIHRoZSBzZWFyY2hcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gW2NhbGxiYWNrXSB0aGUgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHdpdGggdGhlIGNsaWVudCBnZXRzIHRoZSBhbnN3ZXJcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfFByb21pc2V9IElmIHRoZSBjYWxsYmFjayBpcyBub3QgcHJvdmlkZWQgdGhlbiB0aGlzIG1ldGhvZHMgcmV0dXJucyBhIFByb21pc2VcbiAgICovXG4gIHJldHVybiBmdW5jdGlvbiBzZWFyY2gocXVlcnksIGFyZ3MsIGNhbGxiYWNrKSB7XG4gICAgLy8gd2FybiBWMiB1c2VycyBvbiBob3cgdG8gc2VhcmNoXG4gICAgaWYgKHR5cGVvZiBxdWVyeSA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgYXJncyA9PT0gJ29iamVjdCcgfHxcbiAgICAgIHR5cGVvZiBjYWxsYmFjayA9PT0gJ29iamVjdCcpIHtcbiAgICAgIC8vIC5zZWFyY2gocXVlcnksIHBhcmFtcywgY2IpXG4gICAgICAvLyAuc2VhcmNoKGNiLCBwYXJhbXMpXG4gICAgICB0aHJvdyBuZXcgZXJyb3JzLkFsZ29saWFTZWFyY2hFcnJvcignaW5kZXguc2VhcmNoIHVzYWdlIGlzIGluZGV4LnNlYXJjaChxdWVyeSwgcGFyYW1zLCBjYiknKTtcbiAgICB9XG5cbiAgICAvLyBOb3JtYWxpemluZyB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwgdHlwZW9mIHF1ZXJ5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAvLyBVc2FnZSA6IC5zZWFyY2goKSwgLnNlYXJjaChjYilcbiAgICAgIGNhbGxiYWNrID0gcXVlcnk7XG4gICAgICBxdWVyeSA9ICcnO1xuICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSB8fCB0eXBlb2YgYXJncyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gVXNhZ2UgOiAuc2VhcmNoKHF1ZXJ5L2FyZ3MpLCAuc2VhcmNoKHF1ZXJ5LCBjYilcbiAgICAgIGNhbGxiYWNrID0gYXJncztcbiAgICAgIGFyZ3MgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8vIEF0IHRoaXMgcG9pbnQgd2UgaGF2ZSAzIGFyZ3VtZW50cyB3aXRoIHZhbHVlc1xuXG4gICAgLy8gVXNhZ2UgOiAuc2VhcmNoKGFyZ3MpIC8vIGNhcmVmdWw6IHR5cGVvZiBudWxsID09PSAnb2JqZWN0J1xuICAgIGlmICh0eXBlb2YgcXVlcnkgPT09ICdvYmplY3QnICYmIHF1ZXJ5ICE9PSBudWxsKSB7XG4gICAgICBhcmdzID0gcXVlcnk7XG4gICAgICBxdWVyeSA9IHVuZGVmaW5lZDtcbiAgICB9IGVsc2UgaWYgKHF1ZXJ5ID09PSB1bmRlZmluZWQgfHwgcXVlcnkgPT09IG51bGwpIHsgLy8gLnNlYXJjaCh1bmRlZmluZWQvbnVsbClcbiAgICAgIHF1ZXJ5ID0gJyc7XG4gICAgfVxuXG4gICAgdmFyIHBhcmFtcyA9ICcnO1xuXG4gICAgaWYgKHF1ZXJ5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHBhcmFtcyArPSBxdWVyeVBhcmFtICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KTtcbiAgICB9XG5cbiAgICB2YXIgYWRkaXRpb25hbFVBO1xuICAgIGlmIChhcmdzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmIChhcmdzLmFkZGl0aW9uYWxVQSkge1xuICAgICAgICBhZGRpdGlvbmFsVUEgPSBhcmdzLmFkZGl0aW9uYWxVQTtcbiAgICAgICAgZGVsZXRlIGFyZ3MuYWRkaXRpb25hbFVBO1xuICAgICAgfVxuICAgICAgLy8gYF9nZXRTZWFyY2hQYXJhbXNgIHdpbGwgYXVnbWVudCBwYXJhbXMsIGRvIG5vdCBiZSBmb29sZWQgYnkgdGhlID0gdmVyc3VzICs9IGZyb20gcHJldmlvdXMgaWZcbiAgICAgIHBhcmFtcyA9IHRoaXMuYXMuX2dldFNlYXJjaFBhcmFtcyhhcmdzLCBwYXJhbXMpO1xuICAgIH1cblxuXG4gICAgcmV0dXJuIHRoaXMuX3NlYXJjaChwYXJhbXMsIHVybCwgY2FsbGJhY2ssIGFkZGl0aW9uYWxVQSk7XG4gIH07XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvYnVpbGRTZWFyY2hNZXRob2QuanNcbi8vIG1vZHVsZSBpZCA9IDE2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gb21pdChvYmosIHRlc3QpIHtcbiAgdmFyIGtleXMgPSByZXF1aXJlKCdvYmplY3Qta2V5cycpO1xuICB2YXIgZm9yZWFjaCA9IHJlcXVpcmUoJ2ZvcmVhY2gnKTtcblxuICB2YXIgZmlsdGVyZWQgPSB7fTtcblxuICBmb3JlYWNoKGtleXMob2JqKSwgZnVuY3Rpb24gZG9GaWx0ZXIoa2V5TmFtZSkge1xuICAgIGlmICh0ZXN0KGtleU5hbWUpICE9PSB0cnVlKSB7XG4gICAgICBmaWx0ZXJlZFtrZXlOYW1lXSA9IG9ialtrZXlOYW1lXTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBmaWx0ZXJlZDtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvb21pdC5qc1xuLy8gbW9kdWxlIGlkID0gMTdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaWYgKHR5cGVvZiBPYmplY3QuY3JlYXRlID09PSAnZnVuY3Rpb24nKSB7XG4gIC8vIGltcGxlbWVudGF0aW9uIGZyb20gc3RhbmRhcmQgbm9kZS5qcyAndXRpbCcgbW9kdWxlXG4gIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaW5oZXJpdHMoY3Rvciwgc3VwZXJDdG9yKSB7XG4gICAgY3Rvci5zdXBlcl8gPSBzdXBlckN0b3JcbiAgICBjdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDdG9yLnByb3RvdHlwZSwge1xuICAgICAgY29uc3RydWN0b3I6IHtcbiAgICAgICAgdmFsdWU6IGN0b3IsXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9XG4gICAgfSk7XG4gIH07XG59IGVsc2Uge1xuICAvLyBvbGQgc2Nob29sIHNoaW0gZm9yIG9sZCBicm93c2Vyc1xuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3Rvcikge1xuICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yXG4gICAgdmFyIFRlbXBDdG9yID0gZnVuY3Rpb24gKCkge31cbiAgICBUZW1wQ3Rvci5wcm90b3R5cGUgPSBzdXBlckN0b3IucHJvdG90eXBlXG4gICAgY3Rvci5wcm90b3R5cGUgPSBuZXcgVGVtcEN0b3IoKVxuICAgIGN0b3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gY3RvclxuICB9XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaW5oZXJpdHMvaW5oZXJpdHNfYnJvd3Nlci5qc1xuLy8gbW9kdWxlIGlkID0gMThcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSB5W29wWzBdICYgMiA/IFwicmV0dXJuXCIgOiBvcFswXSA/IFwidGhyb3dcIiA6IFwibmV4dFwiXSkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbMCwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgIH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlmIChvW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9OyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi90c2xpYi90c2xpYi5lczYuanNcbi8vIG1vZHVsZSBpZCA9IDE5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qIGdsb2JhbCBBRlJBTUUsIFRIUkVFICovXG5cbmlmICh0eXBlb2YgQUZSQU1FID09PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0NvbXBvbmVudCBhdHRlbXB0ZWQgdG8gcmVnaXN0ZXIgYmVmb3JlIEFGUkFNRSB3YXMgYXZhaWxhYmxlLicpO1xufVxuXG4vLyBDb25maWd1cmF0aW9uIGZvciB0aGUgTXV0YXRpb25PYnNlcnZlciB1c2VkIHRvIHJlZnJlc2ggdGhlIHdoaXRlbGlzdC5cbi8vIExpc3RlbnMgZm9yIGFkZGl0aW9uL3JlbW92YWwgb2YgZWxlbWVudHMgYW5kIGF0dHJpYnV0ZXMgd2l0aGluIHRoZSBzY2VuZS5cbnZhciBPQlNFUlZFUl9DT05GSUcgPSB7XG4gIGNoaWxkTGlzdDogdHJ1ZSxcbiAgYXR0cmlidXRlczogdHJ1ZSxcbiAgc3VidHJlZTogdHJ1ZVxufTtcblxuLyoqXG4gKiBJbXBsZW1lbnQgQUFCQiBjb2xsaXNpb24gZGV0ZWN0aW9uIGZvciBlbnRpdGllcyB3aXRoIGEgbWVzaC5cbiAqIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL01pbmltdW1fYm91bmRpbmdfYm94I0F4aXMtYWxpZ25lZF9taW5pbXVtX2JvdW5kaW5nX2JveFxuICpcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBvYmplY3RzIC0gU2VsZWN0b3Igb2YgZW50aXRpZXMgdG8gdGVzdCBmb3IgY29sbGlzaW9uLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2FhYmItY29sbGlkZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGNvbGxpZGVOb25WaXNpYmxlOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGRlYnVnOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBpbnRlcnZhbDoge2RlZmF1bHQ6IDgwfSxcbiAgICBvYmplY3RzOiB7ZGVmYXVsdDogJyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY2VudGVyRGlmZmVyZW5jZVZlYzMgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuY2xlYXJlZEludGVyc2VjdGVkRWxzID0gW107XG4gICAgdGhpcy5jbG9zZXN0SW50ZXJzZWN0ZWRFbCA9IG51bGw7XG4gICAgdGhpcy5ib3VuZGluZ0JveCA9IG5ldyBUSFJFRS5Cb3gzKCk7XG4gICAgdGhpcy5ib3hDZW50ZXIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuYm94SGVscGVyID0gbmV3IFRIUkVFLkJveEhlbHBlcigpO1xuICAgIHRoaXMuYm94TWF4ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLmJveE1pbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5oaXRDbG9zZXN0Q2xlYXJFdmVudERldGFpbCA9IHt9O1xuICAgIHRoaXMuaGl0Q2xvc2VzdEV2ZW50RGV0YWlsID0ge307XG4gICAgdGhpcy5pbnRlcnNlY3RlZEVscyA9IFtdO1xuICAgIHRoaXMub2JqZWN0RWxzID0gW107XG4gICAgdGhpcy5uZXdJbnRlcnNlY3RlZEVscyA9IFtdO1xuICAgIHRoaXMucHJldkNoZWNrVGltZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnByZXZpb3VzSW50ZXJzZWN0ZWRFbHMgPSBbXTtcblxuICAgIHRoaXMuc2V0RGlydHkgPSB0aGlzLnNldERpcnR5LmJpbmQodGhpcyk7XG4gICAgdGhpcy5vYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHRoaXMuc2V0RGlydHkpO1xuICAgIHRoaXMuZGlydHkgPSB0cnVlO1xuXG4gICAgdGhpcy5oaXRTdGFydEV2ZW50RGV0YWlsID0ge2ludGVyc2VjdGVkRWxzOiB0aGlzLm5ld0ludGVyc2VjdGVkRWxzfTtcbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5vYnNlcnZlci5vYnNlcnZlKHRoaXMuZWwuc2NlbmVFbCwgT0JTRVJWRVJfQ09ORklHKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignb2JqZWN0M2RzZXQnLCB0aGlzLnNldERpcnR5KTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignb2JqZWN0M2RyZW1vdmUnLCB0aGlzLnNldERpcnR5KTtcbiAgfSxcblxuICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLm9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignb2JqZWN0M2RzZXQnLCB0aGlzLnNldERpcnR5KTtcbiAgICB0aGlzLmVsLnNjZW5lRWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignb2JqZWN0M2RyZW1vdmUnLCB0aGlzLnNldERpcnR5KTtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSkge1xuICAgIHZhciBib3hIZWxwZXI7XG4gICAgdmFyIGJvdW5kaW5nQm94ID0gdGhpcy5ib3VuZGluZ0JveDtcbiAgICB2YXIgY2VudGVyRGlmZmVyZW5jZVZlYzMgPSB0aGlzLmNlbnRlckRpZmZlcmVuY2VWZWMzO1xuICAgIHZhciBjbGVhcmVkSW50ZXJzZWN0ZWRFbHMgPSB0aGlzLmNsZWFyZWRJbnRlcnNlY3RlZEVscztcbiAgICB2YXIgY2xvc2VzdENlbnRlckRpZmZlcmVuY2U7XG4gICAgdmFyIG5ld0Nsb3Nlc3RFbDtcbiAgICB2YXIgaW50ZXJzZWN0ZWRFbHMgPSB0aGlzLmludGVyc2VjdGVkRWxzO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGk7XG4gICAgdmFyIG5ld0ludGVyc2VjdGVkRWxzID0gdGhpcy5uZXdJbnRlcnNlY3RlZEVscztcbiAgICB2YXIgb2JqZWN0RWxzID0gdGhpcy5vYmplY3RFbHM7XG4gICAgdmFyIHByZXZDaGVja1RpbWUgPSB0aGlzLnByZXZDaGVja1RpbWU7XG4gICAgdmFyIHByZXZpb3VzSW50ZXJzZWN0ZWRFbHMgPSB0aGlzLnByZXZpb3VzSW50ZXJzZWN0ZWRFbHM7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cblxuICAgIC8vIE9ubHkgY2hlY2sgZm9yIGludGVyc2VjdGlvbiBpZiBpbnRlcnZhbCB0aW1lIGhhcyBwYXNzZWQuXG4gICAgaWYgKHByZXZDaGVja1RpbWUgJiYgKHRpbWUgLSBwcmV2Q2hlY2tUaW1lIDwgdGhpcy5kYXRhLmludGVydmFsKSkgeyByZXR1cm47IH1cbiAgICAvLyBVcGRhdGUgY2hlY2sgdGltZS5cbiAgICB0aGlzLnByZXZDaGVja1RpbWUgPSB0aW1lO1xuXG4gICAgaWYgKHRoaXMuZGlydHkpIHsgdGhpcy5yZWZyZXNoT2JqZWN0cygpOyB9XG5cbiAgICAvLyBVcGRhdGUgdGhlIGJvdW5kaW5nIGJveCB0byBhY2NvdW50IGZvciByb3RhdGlvbnMgYW5kIHBvc2l0aW9uIGNoYW5nZXMuXG4gICAgYm91bmRpbmdCb3guc2V0RnJvbU9iamVjdChlbC5vYmplY3QzRCk7XG4gICAgdGhpcy5ib3hNaW4uY29weShib3VuZGluZ0JveC5taW4pO1xuICAgIHRoaXMuYm94TWF4LmNvcHkoYm91bmRpbmdCb3gubWF4KTtcbiAgICBib3VuZGluZ0JveC5nZXRDZW50ZXIodGhpcy5ib3hDZW50ZXIpO1xuXG4gICAgaWYgKHRoaXMuZGF0YS5kZWJ1Zykge1xuICAgICAgdGhpcy5ib3hIZWxwZXIuc2V0RnJvbU9iamVjdChlbC5vYmplY3QzRCk7XG4gICAgICBpZiAoIXRoaXMuYm94SGVscGVyLnBhcmVudCkgeyBlbC5zY2VuZUVsLm9iamVjdDNELmFkZCh0aGlzLmJveEhlbHBlcik7IH1cbiAgICB9XG5cbiAgICBjb3B5QXJyYXkocHJldmlvdXNJbnRlcnNlY3RlZEVscywgaW50ZXJzZWN0ZWRFbHMpO1xuXG4gICAgLy8gUG9wdWxhdGUgaW50ZXJzZWN0ZWRFbHMgYXJyYXkuXG4gICAgaW50ZXJzZWN0ZWRFbHMubGVuZ3RoID0gMDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgb2JqZWN0RWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAob2JqZWN0RWxzW2ldID09PSB0aGlzLmVsKSB7IGNvbnRpbnVlOyB9XG5cbiAgICAgIC8vIERvbid0IGNvbGxpZGUgd2l0aCBub24tdmlzaWJsZSBpZiBmbGFnIHNldC5cbiAgICAgIGlmICghdGhpcy5kYXRhLmNvbGxpZGVOb25WaXNpYmxlICYmICFvYmplY3RFbHNbaV0uZ2V0QXR0cmlidXRlKCd2aXNpYmxlJykpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGJveCBoZWxwZXIgaWYgZGVidWcgZmxhZyBzZXQgYW5kIGhhcyBib3ggaGVscGVyLlxuICAgICAgICBpZiAodGhpcy5kYXRhLmRlYnVnKSB7XG4gICAgICAgICAgYm94SGVscGVyID0gb2JqZWN0RWxzW2ldLm9iamVjdDNELmJveEhlbHBlcjtcbiAgICAgICAgICBpZiAoYm94SGVscGVyKSB7XG4gICAgICAgICAgICBlbC5zY2VuZUVsLm9iamVjdDNELnJlbW92ZShib3hIZWxwZXIpO1xuICAgICAgICAgICAgb2JqZWN0RWxzW2ldLm9iamVjdDNELmJveEhlbHBlciA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBmb3IgaW50ZXJlY3Rpb24uXG4gICAgICBpZiAodGhpcy5pc0ludGVyc2VjdGluZyhvYmplY3RFbHNbaV0pKSB7IGludGVyc2VjdGVkRWxzLnB1c2gob2JqZWN0RWxzW2ldKTsgfVxuICAgIH1cblxuICAgIC8vIEdldCBuZXdseSBpbnRlcnNlY3RlZCBlbnRpdGllcy5cbiAgICBuZXdJbnRlcnNlY3RlZEVscy5sZW5ndGggPSAwO1xuICAgIGZvciAoaSA9IDA7IGkgPCBpbnRlcnNlY3RlZEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHByZXZpb3VzSW50ZXJzZWN0ZWRFbHMuaW5kZXhPZihpbnRlcnNlY3RlZEVsc1tpXSkgPT09IC0xKSB7XG4gICAgICAgIG5ld0ludGVyc2VjdGVkRWxzLnB1c2goaW50ZXJzZWN0ZWRFbHNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEVtaXQgY2xlYXJlZCBldmVudHMgb24gbm8gbG9uZ2VyIGludGVyc2VjdGVkIGVudGl0aWVzLlxuICAgIGNsZWFyZWRJbnRlcnNlY3RlZEVscy5sZW5ndGggPSAwO1xuICAgIGZvciAoaSA9IDA7IGkgPCBwcmV2aW91c0ludGVyc2VjdGVkRWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoaW50ZXJzZWN0ZWRFbHMuaW5kZXhPZihwcmV2aW91c0ludGVyc2VjdGVkRWxzW2ldKSAhPT0gLTEpIHsgY29udGludWU7IH1cbiAgICAgIGlmICghcHJldmlvdXNJbnRlcnNlY3RlZEVsc1tpXS5oYXNBdHRyaWJ1dGUoJ2FhYmItY29sbGlkZXInKSkge1xuICAgICAgICBwcmV2aW91c0ludGVyc2VjdGVkRWxzW2ldLmVtaXQoJ2hpdGVuZCcpO1xuICAgICAgfVxuICAgICAgY2xlYXJlZEludGVyc2VjdGVkRWxzLnB1c2gocHJldmlvdXNJbnRlcnNlY3RlZEVsc1tpXSk7XG4gICAgfVxuXG4gICAgLy8gRW1pdCBldmVudHMgb24gaW50ZXJzZWN0ZWQgZW50aXRpZXMuIERvIHRoaXMgYWZ0ZXIgdGhlIGNsZWFyZWQgZXZlbnRzLlxuICAgIGZvciAoaSA9IDA7IGkgPCBuZXdJbnRlcnNlY3RlZEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKG5ld0ludGVyc2VjdGVkRWxzW2ldID09PSB0aGlzLmVsKSB7IGNvbnRpbnVlOyB9XG4gICAgICBpZiAobmV3SW50ZXJzZWN0ZWRFbHNbaV0uaGFzQXR0cmlidXRlKCdhYWJiLWNvbGxpZGVyJykpIHsgY29udGludWU7IH1cbiAgICAgIG5ld0ludGVyc2VjdGVkRWxzW2ldLmVtaXQoJ2hpdHN0YXJ0Jyk7XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIGNsb3Nlc3QgaW50ZXJzZWN0ZWQgZW50aXR5IGJhc2VkIG9uIGNlbnRlcnMuXG4gICAgZm9yIChpID0gMDsgaSA8IGludGVyc2VjdGVkRWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoaW50ZXJzZWN0ZWRFbHNbaV0gPT09IHRoaXMuZWwpIHsgY29udGludWU7IH1cbiAgICAgIGNlbnRlckRpZmZlcmVuY2VWZWMzXG4gICAgICAgIC5jb3B5KGludGVyc2VjdGVkRWxzW2ldLm9iamVjdDNELmJvdW5kaW5nQm94Q2VudGVyKVxuICAgICAgICAuc3ViKHRoaXMuYm94Q2VudGVyKTtcbiAgICAgIGlmIChjbG9zZXN0Q2VudGVyRGlmZmVyZW5jZSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgY2VudGVyRGlmZmVyZW5jZVZlYzMubGVuZ3RoKCkgPCBjbG9zZXN0Q2VudGVyRGlmZmVyZW5jZSkge1xuICAgICAgICBjbG9zZXN0Q2VudGVyRGlmZmVyZW5jZSA9IGNlbnRlckRpZmZlcmVuY2VWZWMzLmxlbmd0aCgpO1xuICAgICAgICBuZXdDbG9zZXN0RWwgPSBpbnRlcnNlY3RlZEVsc1tpXTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbWl0IGV2ZW50cyBmb3IgdGhlIG5ldyBjbG9zZXN0IGVudGl0eSBhbmQgdGhlIG9sZCBjbG9zZXN0IGVudGl0eS5cbiAgICBpZiAoIWludGVyc2VjdGVkRWxzLmxlbmd0aCAmJiB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsKSB7XG4gICAgICAvLyBObyBpbnRlcnNlY3RlZCBlbnRpdGllcywgY2xlYXIgYW55IGNsb3Nlc3QgZW50aXR5LlxuICAgICAgdGhpcy5oaXRDbG9zZXN0Q2xlYXJFdmVudERldGFpbC5lbCA9IHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWw7XG4gICAgICB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsLmVtaXQoJ2hpdGNsb3Nlc3RjbGVhcicpO1xuICAgICAgdGhpcy5jbG9zZXN0SW50ZXJzZWN0ZWRFbCA9IG51bGw7XG4gICAgICBlbC5lbWl0KCdoaXRjbG9zZXN0Y2xlYXInLCB0aGlzLmhpdENsb3Nlc3RDbGVhckV2ZW50RGV0YWlsKTtcbiAgICB9IGVsc2UgaWYgKG5ld0Nsb3Nlc3RFbCAhPT0gdGhpcy5jbG9zZXN0SW50ZXJzZWN0ZWRFbCkge1xuICAgICAgLy8gQ2xlYXIgdGhlIHByZXZpb3VzIGNsb3Nlc3QgZW50aXR5LlxuICAgICAgaWYgKHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWwpIHtcbiAgICAgICAgdGhpcy5oaXRDbG9zZXN0Q2xlYXJFdmVudERldGFpbC5lbCA9IHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWw7XG4gICAgICAgIHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWwuZW1pdCgnaGl0Y2xvc2VzdGNsZWFyJywgdGhpcy5oaXRDbG9zZXN0Q2xlYXJFdmVudERldGFpbCk7XG4gICAgICB9XG4gICAgICBpZiAobmV3Q2xvc2VzdEVsKSB7XG4gICAgICAgIC8vIEVtaXQgZm9yIHRoZSBuZXcgY2xvc2VzdCBlbnRpdHkuXG4gICAgICAgIG5ld0Nsb3Nlc3RFbC5lbWl0KCdoaXRjbG9zZXN0Jyk7XG4gICAgICAgIHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWwgPSBuZXdDbG9zZXN0RWw7XG4gICAgICAgIHRoaXMuaGl0Q2xvc2VzdEV2ZW50RGV0YWlsLmVsID0gbmV3Q2xvc2VzdEVsO1xuICAgICAgICBlbC5lbWl0KCdoaXRjbG9zZXN0JywgdGhpcy5oaXRDbG9zZXN0RXZlbnREZXRhaWwpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjbGVhcmVkSW50ZXJzZWN0ZWRFbHMubGVuZ3RoKSB7XG4gICAgICBlbC5lbWl0KCdoaXRlbmQnKTtcbiAgICB9XG5cbiAgICBpZiAobmV3SW50ZXJzZWN0ZWRFbHMubGVuZ3RoKSB7XG4gICAgICBlbC5lbWl0KCdoaXRzdGFydCcsIHRoaXMuaGl0U3RhcnRFdmVudERldGFpbCk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBBQUJCIGNvbGxpc2lvbiBkZXRlY3Rpb24uXG4gICAqIDNEIHZlcnNpb24gb2YgaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1naHFEM2UzN1I3RVxuICAgKi9cbiAgaXNJbnRlcnNlY3Rpbmc6IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGJvdW5kaW5nQm94ID0gbmV3IFRIUkVFLkJveDMoKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIHZhciBpc0ludGVyc2VjdGluZztcbiAgICAgIHZhciBib3hIZWxwZXI7XG4gICAgICB2YXIgYm94TWluO1xuICAgICAgdmFyIGJveE1heDtcblxuICAgICAgYm91bmRpbmdCb3guc2V0RnJvbU9iamVjdChlbC5vYmplY3QzRCk7XG5cbiAgICAgIGlmICh0aGlzLmRhdGEuZGVidWcpIHtcbiAgICAgICAgaWYgKCFlbC5vYmplY3QzRC5ib3hIZWxwZXIpIHtcbiAgICAgICAgICBlbC5vYmplY3QzRC5ib3hIZWxwZXIgPSBuZXcgVEhSRUUuQm94SGVscGVyKFxuICAgICAgICAgICAgZWwub2JqZWN0M0QsIG5ldyBUSFJFRS5Db2xvcihNYXRoLnJhbmRvbSgpLCBNYXRoLnJhbmRvbSgpLCBNYXRoLnJhbmRvbSgpKSk7XG4gICAgICAgICAgZWwuc2NlbmVFbC5vYmplY3QzRC5hZGQoZWwub2JqZWN0M0QuYm94SGVscGVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbC5vYmplY3QzRC5ib3hIZWxwZXIuc2V0RnJvbU9iamVjdChlbC5vYmplY3QzRCk7XG4gICAgICB9XG5cbiAgICAgIGJveE1pbiA9IGJvdW5kaW5nQm94Lm1pbjtcbiAgICAgIGJveE1heCA9IGJvdW5kaW5nQm94Lm1heDtcbiAgICAgIGVsLm9iamVjdDNELmJvdW5kaW5nQm94Q2VudGVyID0gZWwub2JqZWN0M0QuYm91bmRpbmdCb3hDZW50ZXIgfHwgbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICAgIGJvdW5kaW5nQm94LmdldENlbnRlcihlbC5vYmplY3QzRC5ib3VuZGluZ0JveENlbnRlcik7XG4gICAgICByZXR1cm4gKHRoaXMuYm94TWluLnggPD0gYm94TWF4LnggJiYgdGhpcy5ib3hNYXgueCA+PSBib3hNaW4ueCkgJiZcbiAgICAgICAgICAgICAodGhpcy5ib3hNaW4ueSA8PSBib3hNYXgueSAmJiB0aGlzLmJveE1heC55ID49IGJveE1pbi55KSAmJlxuICAgICAgICAgICAgICh0aGlzLmJveE1pbi56IDw9IGJveE1heC56ICYmIHRoaXMuYm94TWF4LnogPj0gYm94TWluLnopO1xuICAgIH07XG4gIH0pKCksXG5cbiAgLyoqXG4gICAqIE1hcmsgdGhlIG9iamVjdCBsaXN0IGFzIGRpcnR5LCB0byBiZSByZWZyZXNoZWQgYmVmb3JlIG5leHQgcmF5Y2FzdC5cbiAgICovXG4gIHNldERpcnR5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBsaXN0IG9mIG9iamVjdHMgdG8gdGVzdCBmb3IgaW50ZXJzZWN0aW9uLlxuICAgKi9cbiAgcmVmcmVzaE9iamVjdHM6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICAvLyBJZiBvYmplY3RzIG5vdCBkZWZpbmVkLCBpbnRlcnNlY3Qgd2l0aCBldmVyeXRoaW5nLlxuICAgIHRoaXMub2JqZWN0RWxzID0gZGF0YS5vYmplY3RzXG4gICAgICA/IHRoaXMuZWwuc2NlbmVFbC5xdWVyeVNlbGVjdG9yQWxsKGRhdGEub2JqZWN0cylcbiAgICAgIDogdGhpcy5lbC5zY2VuZUVsLmNoaWxkcmVuO1xuICAgIHRoaXMuZGlydHkgPSBmYWxzZTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGNvcHlBcnJheSAoZGVzdCwgc291cmNlKSB7XG4gIHZhciBpO1xuICBkZXN0Lmxlbmd0aCA9IDA7XG4gIGZvciAoaSA9IDA7IGkgPCBzb3VyY2UubGVuZ3RoOyBpKyspIHsgZGVzdFtpXSA9IHNvdXJjZVtpXTsgfVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1hYWJiLWNvbGxpZGVyLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaWYgKHR5cGVvZiBBRlJBTUUgPT09ICd1bmRlZmluZWQnKSB7XG4gIHRocm93IG5ldyBFcnJvcignQ29tcG9uZW50IGF0dGVtcHRlZCB0byByZWdpc3RlciBiZWZvcmUgQUZSQU1FIHdhcyBhdmFpbGFibGUuJyk7XG59XG5cbnZhciBhdWRpb0J1ZmZlckNhY2hlID0ge307XG5cbi8qKlxuICogQXVkaW8gdmlzdWFsaXplciBjb21wb25lbnQgZm9yIEEtRnJhbWUgdXNpbmcgQW5hbHlzZXJOb2RlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2F1ZGlvYW5hbHlzZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGJ1ZmZlcjoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBiZWF0RGV0ZWN0aW9uRGVjYXk6IHtkZWZhdWx0OiAwLjk5fSxcbiAgICBiZWF0RGV0ZWN0aW9uTWluVm9sdW1lOiB7ZGVmYXVsdDogMTV9LFxuICAgIGJlYXREZXRlY3Rpb25UaHJvdHRsZToge2RlZmF1bHQ6IDI1MH0sXG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGVuYWJsZUJlYXREZXRlY3Rpb246IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVMZXZlbHM6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVXYXZlZm9ybToge2RlZmF1bHQ6IHRydWV9LFxuICAgIGVuYWJsZVZvbHVtZToge2RlZmF1bHQ6IHRydWV9LFxuICAgIGZmdFNpemU6IHtkZWZhdWx0OiAyMDQ4fSxcbiAgICBzbW9vdGhpbmdUaW1lQ29uc3RhbnQ6IHtkZWZhdWx0OiAwLjh9LFxuICAgIHNyYzoge1xuICAgICAgcGFyc2U6IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgaWYgKHZhbC5jb25zdHJ1Y3RvciAhPT0gU3RyaW5nKSB7IHJldHVybiB2YWw7IH1cbiAgICAgICAgaWYgKHZhbC5zdGFydHNXaXRoKCcjJykgfHwgdmFsLnN0YXJ0c1dpdGgoJy4nKSkge1xuICAgICAgICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHZhbCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIHVuaXF1ZToge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYW5hbHlzZXI7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGdhaW5Ob2RlXG5cbiAgICB0aGlzLmF1ZGlvRWwgPSBudWxsO1xuICAgIHRoaXMuY29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTtcbiAgICB0aGlzLmxldmVscyA9IG51bGw7XG4gICAgdGhpcy53YXZlZm9ybSA9IG51bGw7XG4gICAgdGhpcy52b2x1bWUgPSAwO1xuICAgIHRoaXMueGhyID0gbnVsbDtcblxuICAgIGFuYWx5c2VyID0gdGhpcy5hbmFseXNlciA9IHRoaXMuY29udGV4dC5jcmVhdGVBbmFseXNlcigpO1xuICAgIGdhaW5Ob2RlID0gdGhpcy5nYWluTm9kZSA9IHRoaXMuY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgZ2Fpbk5vZGUuY29ubmVjdChhbmFseXNlcik7XG4gICAgYW5hbHlzZXIuY29ubmVjdCh0aGlzLmNvbnRleHQuZGVzdGluYXRpb24pO1xuICAgIGFuYWx5c2VyLmZmdFNpemUgPSBkYXRhLmZmdFNpemU7XG4gICAgYW5hbHlzZXIuc21vb3RoaW5nVGltZUNvbnN0YW50ID0gZGF0YS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQ7XG4gICAgdGhpcy5sZXZlbHMgPSBuZXcgVWludDhBcnJheShhbmFseXNlci5mcmVxdWVuY3lCaW5Db3VudCk7XG4gICAgdGhpcy53YXZlZm9ybSA9IG5ldyBVaW50OEFycmF5KGFuYWx5c2VyLmZmdFNpemUpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB2YXIgYW5hbHlzZXIgPSB0aGlzLmFuYWx5c2VyO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgLy8gVXBkYXRlIGFuYWx5c2VyIHN0dWZmLlxuICAgIGlmIChvbGREYXRhLmZmdFNpemUgIT09IGRhdGEuZmZ0U2l6ZSB8fFxuICAgICAgICBvbGREYXRhLnNtb290aGluZ1RpbWVDb25zdGFudCAhPT0gZGF0YS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQpIHtcbiAgICAgIGFuYWx5c2VyLmZmdFNpemUgPSBkYXRhLmZmdFNpemU7XG4gICAgICBhbmFseXNlci5zbW9vdGhpbmdUaW1lQ29uc3RhbnQgPSBkYXRhLnNtb290aGluZ1RpbWVDb25zdGFudDtcbiAgICAgIHRoaXMubGV2ZWxzID0gbmV3IFVpbnQ4QXJyYXkoYW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQpO1xuICAgICAgdGhpcy53YXZlZm9ybSA9IG5ldyBVaW50OEFycmF5KGFuYWx5c2VyLmZmdFNpemUpO1xuICAgIH1cblxuICAgIGlmICghZGF0YS5zcmMpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5yZWZyZXNoU291cmNlKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBzcGVjdHJ1bSBvbiBlYWNoIGZyYW1lLlxuICAgKi9cbiAgdGljazogZnVuY3Rpb24gKHQsIGR0KSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIHZvbHVtZTtcblxuICAgIGlmICghZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuXG4gICAgLy8gTGV2ZWxzIChmcmVxdWVuY3kpLlxuICAgIGlmIChkYXRhLmVuYWJsZUxldmVscyB8fCBkYXRhLmVuYWJsZVZvbHVtZSkge1xuICAgICAgdGhpcy5hbmFseXNlci5nZXRCeXRlRnJlcXVlbmN5RGF0YSh0aGlzLmxldmVscyk7XG4gICAgfVxuXG4gICAgLy8gV2F2ZWZvcm0uXG4gICAgaWYgKGRhdGEuZW5hYmxlV2F2ZWZvcm0pIHtcbiAgICAgIHRoaXMuYW5hbHlzZXIuZ2V0Qnl0ZVRpbWVEb21haW5EYXRhKHRoaXMud2F2ZWZvcm0pO1xuICAgIH1cblxuICAgIC8vIEF2ZXJhZ2Ugdm9sdW1lLlxuICAgIGlmIChkYXRhLmVuYWJsZVZvbHVtZSB8fCBkYXRhLmVuYWJsZUJlYXREZXRlY3Rpb24pIHtcbiAgICAgIHZhciBzdW0gPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxldmVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICBzdW0gKz0gdGhpcy5sZXZlbHNbaV07O1xuICAgICAgfVxuICAgICAgdGhpcy52b2x1bWUgPSBzdW0gLyB0aGlzLmxldmVscy5sZW5ndGg7XG4gICAgfVxuXG4gICAgLy8gQmVhdCBkZXRlY3Rpb24uXG4gICAgaWYgKGRhdGEuZW5hYmxlQmVhdERldGVjdGlvbikge1xuICAgICAgdm9sdW1lID0gdGhpcy52b2x1bWU7XG4gICAgICBpZiAoIXRoaXMuYmVhdEN1dE9mZikgeyB0aGlzLmJlYXRDdXRPZmYgPSB2b2x1bWU7IH1cbiAgICAgIGlmICh2b2x1bWUgPiB0aGlzLmJlYXRDdXRPZmYgJiYgdm9sdW1lID4gdGhpcy5kYXRhLmJlYXREZXRlY3Rpb25NaW5Wb2x1bWUpIHtcbiAgICAgICAgdGhpcy5lbC5lbWl0KCdhdWRpb2FuYWx5c2VyYmVhdCcsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgdGhpcy5iZWF0Q3V0T2ZmID0gdm9sdW1lICogMS41O1xuICAgICAgICB0aGlzLmJlYXRUaW1lID0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLmJlYXRUaW1lIDw9IHRoaXMuZGF0YS5iZWF0RGV0ZWN0aW9uVGhyb3R0bGUpIHtcbiAgICAgICAgICB0aGlzLmJlYXRUaW1lICs9IGR0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuYmVhdEN1dE9mZiAqPSB0aGlzLmRhdGEuYmVhdERldGVjdGlvbkRlY2F5O1xuICAgICAgICAgIHRoaXMuYmVhdEN1dE9mZiA9IE1hdGgubWF4KHRoaXMuYmVhdEN1dE9mZiwgdGhpcy5kYXRhLmJlYXREZXRlY3Rpb25NaW5Wb2x1bWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHJlZnJlc2hTb3VyY2U6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYW5hbHlzZXIgPSB0aGlzLmFuYWx5c2VyO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgaWYgKGRhdGEuYnVmZmVyICYmIGRhdGEuc3JjLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHtcbiAgICAgIHRoaXMuZ2V0QnVmZmVyU291cmNlKCkudGhlbihzb3VyY2UgPT4ge1xuICAgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgICAgdGhpcy5zb3VyY2UuY29ubmVjdCh0aGlzLmdhaW5Ob2RlKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHRoaXMuZ2V0TWVkaWFTb3VyY2UoKTtcbiAgICAgIHRoaXMuc291cmNlLmNvbm5lY3QodGhpcy5nYWluTm9kZSk7XG4gICAgfVxuICB9LFxuXG4gIHN1c3BlbmRDb250ZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5jb250ZXh0LnN1c3BlbmQoKTtcbiAgfSxcblxuICByZXN1bWVDb250ZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5jb250ZXh0LnJlc3VtZSgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBGZXRjaCBhbmQgcGFyc2UgYnVmZmVyIHRvIGF1ZGlvIGJ1ZmZlci4gUmVzb2x2ZSBhIHNvdXJjZS5cbiAgICovXG4gIGZldGNoQXVkaW9CdWZmZXI6IGZ1bmN0aW9uIChzcmMpIHtcbiAgICAvLyBGcm9tIGNhY2hlLlxuICAgIGlmIChhdWRpb0J1ZmZlckNhY2hlW3NyY10pIHtcbiAgICAgIGlmIChhdWRpb0J1ZmZlckNhY2hlW3NyY10uY29uc3RydWN0b3IgPT09IFByb21pc2UpIHtcbiAgICAgICAgcmV0dXJuIGF1ZGlvQnVmZmVyQ2FjaGVbc3JjXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoYXVkaW9CdWZmZXJDYWNoZVtzcmNdKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBhdWRpb0J1ZmZlckNhY2hlW3NyY10gPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgIC8vIEZldGNoIGlmIGRvZXMgbm90IGV4aXN0LlxuICAgICAgY29uc3QgeGhyID0gdGhpcy54aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgIHhoci5vcGVuKCdHRVQnLCBzcmMpO1xuICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdhcnJheWJ1ZmZlcic7XG4gICAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgICAgdGhpcy5jb250ZXh0LmRlY29kZUF1ZGlvRGF0YSh4aHIucmVzcG9uc2UpLnRoZW4oYXVkaW9CdWZmZXIgPT4ge1xuICAgICAgICAgIGF1ZGlvQnVmZmVyQ2FjaGVbc3JjXSA9IGF1ZGlvQnVmZmVyO1xuICAgICAgICAgIHJlc29sdmUoYXVkaW9CdWZmZXIpO1xuICAgICAgICB9KS5jYXRjaChjb25zb2xlLmVycm9yKTtcbiAgICAgIH0pO1xuICAgICAgeGhyLnNlbmQoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gYXVkaW9CdWZmZXJDYWNoZVtzcmNdO1xuICB9LFxuXG4gIGdldEJ1ZmZlclNvdXJjZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHJldHVybiB0aGlzLmZldGNoQXVkaW9CdWZmZXIoZGF0YS5zcmMpLnRoZW4oKCkgPT4ge1xuICAgICAgdmFyIHNvdXJjZTtcbiAgICAgIHNvdXJjZSA9IHRoaXMuY29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcbiAgICAgIHNvdXJjZS5idWZmZXIgPSBhdWRpb0J1ZmZlckNhY2hlW2RhdGEuc3JjXTtcbiAgICAgIHRoaXMuZWwuZW1pdCgnYXVkaW9hbmFseXNlcmJ1ZmZlcnNvdXJjZScsIHNvdXJjZSwgZmFsc2UpO1xuICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICB9KS5jYXRjaChjb25zb2xlLmVycm9yKTtcbiAgfSxcblxuICBnZXRNZWRpYVNvdXJjZTogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmRhdGEuc3JjLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHtcbiAgICAgIGlmICghdGhpcy5hdWRpbykge1xuICAgICAgICB0aGlzLmF1ZGlvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXVkaW8nKTtcbiAgICAgICAgdGhpcy5hdWRpby5jcm9zc09yaWdpbiA9ICdhbm9ueW1vdXMnO1xuICAgICAgfVxuICAgICAgdGhpcy5hdWRpby5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMuZGF0YS5zcmMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmF1ZGlvID0gdGhpcy5kYXRhLnNyYztcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dC5jcmVhdGVNZWRpYUVsZW1lbnRTb3VyY2UodGhpcy5hdWRpbylcbiAgfVxufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLWF1ZGlvYW5hbHlzZXItY29tcG9uZW50L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAyMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKiBnbG9iYWwgQUZSQU1FICovXG52YXIgc3R5bGVQYXJzZXIgPSBBRlJBTUUudXRpbHMuc3R5bGVQYXJzZXI7XG5cbmlmICh0eXBlb2YgQUZSQU1FID09PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0NvbXBvbmVudCBhdHRlbXB0ZWQgdG8gcmVnaXN0ZXIgYmVmb3JlIEFGUkFNRSB3YXMgYXZhaWxhYmxlLicpO1xufVxuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2V2ZW50LXNldCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgZGVmYXVsdDogJycsXG4gICAgcGFyc2U6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHN0eWxlUGFyc2VyLnBhcnNlKHZhbHVlKTtcbiAgICB9XG4gIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZXZlbnRIYW5kbGVyID0gbnVsbDtcbiAgICB0aGlzLmV2ZW50TmFtZSA9IG51bGw7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigpO1xuICAgIHRoaXMudXBkYXRlRXZlbnRMaXN0ZW5lcigpO1xuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigpO1xuICB9LFxuXG4gIHJlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigpO1xuICB9LFxuXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCk7XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBVcGRhdGUgc291cmNlLW9mLXRydXRoIGV2ZW50IGxpc3RlbmVyIHJlZ2lzdHJ5LlxuICAgKiBEb2VzIG5vdCBhY3R1YWxseSBhdHRhY2ggZXZlbnQgbGlzdGVuZXJzIHlldC5cbiAgICovXG4gIHVwZGF0ZUV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBldmVudDtcbiAgICB2YXIgdGFyZ2V0O1xuICAgIHZhciB0YXJnZXRFbDtcblxuICAgIC8vIFNldCBldmVudCBsaXN0ZW5lciB1c2luZyBgX2V2ZW50YC5cbiAgICBldmVudCA9IGRhdGEuX2V2ZW50IHx8IHRoaXMuaWQ7XG4gICAgdGFyZ2V0ID0gZGF0YS5fdGFyZ2V0O1xuXG4gICAgLy8gRGVjaWRlIHRoZSB0YXJnZXQgdG8gYHNldEF0dHJpYnV0ZWAgb24uXG4gICAgdGFyZ2V0RWwgPSB0YXJnZXQgPyBlbC5zY2VuZUVsLnF1ZXJ5U2VsZWN0b3IodGFyZ2V0KSA6IGVsO1xuXG4gICAgdGhpcy5ldmVudE5hbWUgPSBldmVudDtcbiAgICB0aGlzLmV2ZW50SGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuICAgICAgdmFyIHByb3BOYW1lO1xuICAgICAgLy8gU2V0IGF0dHJpYnV0ZXMuXG4gICAgICBmb3IgKHByb3BOYW1lIGluIGRhdGEpIHtcbiAgICAgICAgaWYgKHByb3BOYW1lID09PSAnX2V2ZW50JyB8fCBwcm9wTmFtZSA9PT0gJ190YXJnZXQnKSB7IGNvbnRpbnVlOyB9XG4gICAgICAgIEFGUkFNRS51dGlscy5lbnRpdHkuc2V0Q29tcG9uZW50UHJvcGVydHkuY2FsbCh0aGlzLCB0YXJnZXRFbCwgcHJvcE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhW3Byb3BOYW1lXSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSxcblxuICBhZGRFdmVudExpc3RlbmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKHRoaXMuZXZlbnROYW1lLCB0aGlzLmV2ZW50SGFuZGxlcik7XG4gIH0sXG5cbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLmV2ZW50TmFtZSwgdGhpcy5ldmVudEhhbmRsZXIpO1xuICB9XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtZXZlbnQtc2V0LWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaWYgKCFUSFJFRS5CdWZmZXJHZW9tZXRyeVV0aWxzKSB7XG4gIHJlcXVpcmUoJy4vbGliL0J1ZmZlckdlb21ldHJ5VXRpbHMnKTtcbn1cblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdnZW9tZXRyeS1tZXJnZXInLCB7XG4gIHNjaGVtYToge1xuICAgIHByZXNlcnZlT3JpZ2luYWw6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGZhY2VJbmRleEVuZDtcbiAgICB2YXIgZmFjZUluZGV4U3RhcnQ7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5nZW9tZXRyeSA9IG5ldyBUSFJFRS5HZW9tZXRyeSgpO1xuICAgIHRoaXMubWVzaCA9IG5ldyBUSFJFRS5NZXNoKHRoaXMuZ2VvbWV0cnkpO1xuICAgIHRoaXMuZWwuc2V0T2JqZWN0M0QoJ21lc2gnLCB0aGlzLm1lc2gpO1xuXG4gICAgdGhpcy5mYWNlSW5kZXggPSB7fTsgIC8vIEtlZXAgaW5kZXggb2Ygb3JpZ2luYWwgZW50aXR5IFVVSUQgdG8gbmV3IGZhY2UgYXJyYXkuXG4gICAgdGhpcy52ZXJ0ZXhJbmRleCA9IHt9OyAgLy8gS2VlcCBpbmRleCBvZiBvcmlnaW5hbCBlbnRpdHkgVVVJRCB0byB2ZXJ0ZXggYXJyYXkuXG5cbiAgICB0aGlzLmVsLm9iamVjdDNELnRyYXZlcnNlKGZ1bmN0aW9uIChtZXNoKSB7XG4gICAgICBpZiAobWVzaC50eXBlICE9PSAnTWVzaCcpIHsgcmV0dXJuOyB9XG4gICAgICBpZiAobWVzaCA9PT0gc2VsZi5tZXNoKSB7IHJldHVybjsgfVxuXG4gICAgICBzZWxmLmZhY2VJbmRleFttZXNoLnBhcmVudC51dWlkXSA9IFtcbiAgICAgICAgc2VsZi5nZW9tZXRyeS5mYWNlcy5sZW5ndGgsXG4gICAgICAgIHNlbGYuZ2VvbWV0cnkuZmFjZXMubGVuZ3RoICsgbWVzaC5nZW9tZXRyeS5mYWNlcy5sZW5ndGggLSAxXG4gICAgICBdO1xuXG4gICAgICBzZWxmLnZlcnRleEluZGV4W21lc2gucGFyZW50LnV1aWRdID0gW1xuICAgICAgICBzZWxmLmdlb21ldHJ5LnZlcnRpY2VzLmxlbmd0aCxcbiAgICAgICAgc2VsZi5nZW9tZXRyeS52ZXJ0aWNlcy5sZW5ndGggKyBtZXNoLmdlb21ldHJ5LnZlcnRpY2VzLmxlbmd0aCAtIDFcbiAgICAgIF07XG5cbiAgICAgIC8vIE1lcmdlLiBVc2UgcGFyZW50J3MgbWF0cml4IGR1ZSB0byBBLUZyYW1lJ3MgPGEtZW50aXR5PihHcm91cC1NZXNoKSBoaWVyYXJjaHkuXG4gICAgICBtZXNoLnBhcmVudC51cGRhdGVNYXRyaXgoKTtcbiAgICAgIHNlbGYuZ2VvbWV0cnkubWVyZ2UobWVzaC5nZW9tZXRyeSwgbWVzaC5wYXJlbnQubWF0cml4KTtcblxuICAgICAgLy8gUmVtb3ZlIG1lc2ggaWYgbm90IHByZXNlcnZpbmcuXG4gICAgICBpZiAoIXNlbGYuZGF0YS5wcmVzZXJ2ZU9yaWdpbmFsKSB7IG1lc2gucGFyZW50LnJlbW92ZShtZXNoKTsgfVxuICAgIH0pO1xuICB9XG59KTtcblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdidWZmZXItZ2VvbWV0cnktbWVyZ2VyJywge1xuICBzY2hlbWE6IHtcbiAgICBwcmVzZXJ2ZU9yaWdpbmFsOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBnZW9tZXRyaWVzID0gW107XG5cbiAgICB0aGlzLmVsLnNjZW5lRWwub2JqZWN0M0QudXBkYXRlTWF0cml4V29ybGQoKVxuICAgIHRoaXMuZWwub2JqZWN0M0QudHJhdmVyc2UoZnVuY3Rpb24gKG1lc2gpIHtcbiAgICAgIGlmIChtZXNoLnR5cGUgIT09ICdNZXNoJyB8fCBtZXNoLmVsID09PSBzZWxmLmVsKSB7IHJldHVybjsgfVxuICAgICAgbWVzaC5nZW9tZXRyeS5hcHBseU1hdHJpeChtZXNoLm1hdHJpeFdvcmxkKTtcbiAgICAgIGdlb21ldHJpZXMucHVzaChtZXNoLmdlb21ldHJ5LmNsb25lKCkpO1xuICAgICAgbWVzaC5wYXJlbnQucmVtb3ZlKG1lc2gpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgZ2VvbWV0cnkgPSBUSFJFRS5CdWZmZXJHZW9tZXRyeVV0aWxzLm1lcmdlQnVmZmVyR2VvbWV0cmllcyhnZW9tZXRyaWVzKTtcbiAgICB0aGlzLm1lc2ggPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSk7XG4gICAgdGhpcy5lbC5zZXRPYmplY3QzRCgnbWVzaCcsIHRoaXMubWVzaCk7XG4gIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1nZW9tZXRyeS1tZXJnZXItY29tcG9uZW50L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAyM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKiBnbG9iYWwgQUZSQU1FICovXG5cbmlmICh0eXBlb2YgQUZSQU1FID09PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0NvbXBvbmVudCBhdHRlbXB0ZWQgdG8gcmVnaXN0ZXIgYmVmb3JlIEFGUkFNRSB3YXMgYXZhaWxhYmxlLicpO1xufVxuXG4vKipcbiAqIEhhcHRpY3MgY29tcG9uZW50IGZvciBBLUZyYW1lLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2hhcHRpY3MnLCB7XG4gIGRlcGVuZGVuY2llczogWyd0cmFja2VkLWNvbnRyb2xzJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgYWN0dWF0b3JJbmRleDoge2RlZmF1bHQ6IDB9LFxuICAgIGR1cjoge2RlZmF1bHQ6IDEwMH0sXG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGV2ZW50czoge3R5cGU6ICdhcnJheSd9LFxuICAgIGV2ZW50c0Zyb206IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgZm9yY2U6IHtkZWZhdWx0OiAxfVxuICB9LFxuXG4gIG11bHRpcGxlOiB0cnVlLFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgaTtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICB0aGlzLmNhbGxQdWxzZSA9IGZ1bmN0aW9uICgpIHsgc2VsZi5wdWxzZSgpOyB9O1xuXG4gICAgaWYgKHRoaXMuZWwuY29tcG9uZW50c1sndHJhY2tlZC1jb250cm9scyddLmNvbnRyb2xsZXIpIHtcbiAgICAgIHRoaXMuZ2FtZXBhZCA9IHRoaXMuZWwuY29tcG9uZW50c1sndHJhY2tlZC1jb250cm9scyddLmNvbnRyb2xsZXI7XG4gICAgICBpZiAoIXRoaXMuZ2FtZXBhZCB8fCAhdGhpcy5nYW1lcGFkLmhhcHRpY0FjdHVhdG9ycy5sZW5ndGgpIHsgcmV0dXJuOyB9XG4gICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignY29udHJvbGxlcmNvbm5lY3RlZCcsIGZ1bmN0aW9uIGluaXQgKCkge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBzZWxmLmdhbWVwYWQgPSBzZWxmLmVsLmNvbXBvbmVudHNbJ3RyYWNrZWQtY29udHJvbHMnXS5jb250cm9sbGVyO1xuICAgICAgICAgIGlmICghc2VsZi5nYW1lcGFkIHx8ICFzZWxmLmdhbWVwYWQuaGFwdGljQWN0dWF0b3JzLmxlbmd0aCkgeyByZXR1cm47IH1cbiAgICAgICAgICBzZWxmLmFkZEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIH0sIDE1MCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgcmVtb3ZlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICB9LFxuXG4gIHB1bHNlOiBmdW5jdGlvbiAoZm9yY2UsIGR1cikge1xuICAgIHZhciBhY3R1YXRvcjtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBpZiAoIWRhdGEuZW5hYmxlZCB8fCAhdGhpcy5nYW1lcGFkIHx8ICF0aGlzLmdhbWVwYWQuaGFwdGljQWN0dWF0b3JzKSB7IHJldHVybjsgfVxuICAgIGFjdHVhdG9yID0gdGhpcy5nYW1lcGFkLmhhcHRpY0FjdHVhdG9yc1tkYXRhLmFjdHVhdG9ySW5kZXhdO1xuICAgIGFjdHVhdG9yLnB1bHNlKGZvcmNlIHx8IGRhdGEuZm9yY2UsIGR1ciB8fCBkYXRhLmR1cik7XG4gIH0sXG5cbiAgYWRkRXZlbnRMaXN0ZW5lcnM6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgaTtcbiAgICB2YXIgbGlzdGVuVGFyZ2V0O1xuXG4gICAgbGlzdGVuVGFyZ2V0ID0gZGF0YS5ldmVudHNGcm9tID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkYXRhLmV2ZW50c0Zyb20pIDogdGhpcy5lbDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgZGF0YS5ldmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxpc3RlblRhcmdldC5hZGRFdmVudExpc3RlbmVyKGRhdGEuZXZlbnRzW2ldLCB0aGlzLmNhbGxQdWxzZSk7XG4gICAgfVxuICB9LFxuXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXJzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGk7XG4gICAgdmFyIGxpc3RlblRhcmdldDtcblxuICAgIGxpc3RlblRhcmdldCA9IGRhdGEuZXZlbnRzRnJvbSA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YS5ldmVudHNGcm9tKSA6IHRoaXMuZWw7XG4gICAgZm9yIChpID0gMDsgaSA8IGRhdGEuZXZlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsaXN0ZW5UYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihkYXRhLmV2ZW50c1tpXSwgdGhpcy5jYWxsUHVsc2UpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLWhhcHRpY3MtY29tcG9uZW50L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAyNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgcG9zaXRpb25zID0gW107XG52YXIgcG9zaXRpb25IZWxwZXIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG4vKipcbiAqIExheW91dCBjb21wb25lbnQgZm9yIEEtRnJhbWUuXG4gKiBTb21lIGxheW91dHMgYWRhcHRlZCBmcm9tIGh0dHA6Ly93d3cudmItaGVscGVyLmNvbS90dXRvcmlhbF9wbGF0b25pY19zb2xpZHMuaHRtbFxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2xheW91dCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgYW5nbGU6IHt0eXBlOiAnbnVtYmVyJywgZGVmYXVsdDogZmFsc2UsIG1pbjogMCwgbWF4OiAzNjAsIGlmOiB7dHlwZTogWydjaXJjbGUnXX19LFxuICAgIGNvbHVtbnM6IHtkZWZhdWx0OiAxLCBtaW46IDAsIGlmOiB7dHlwZTogWydib3gnXX19LFxuICAgIG1hcmdpbjoge2RlZmF1bHQ6IDEsIG1pbjogMCwgaWY6IHt0eXBlOiBbJ2JveCcsICdsaW5lJ119fSxcbiAgICBtYXJnaW5Db2x1bW46IHtkZWZhdWx0OiAxLCBtaW46IDAsIGlmOiB7dHlwZTogWydib3gnXX19LFxuICAgIG1hcmdpblJvdzoge2RlZmF1bHQ6IDEsIG1pbjogMCwgaWY6IHt0eXBlOiBbJ2JveCddfX0sXG4gICAgb3JkZXJBdHRyaWJ1dGU6IHtkZWZhdWx0OiAnJ30sXG4gICAgcGxhbmU6IHtkZWZhdWx0OiAneHknfSxcbiAgICByYWRpdXM6IHtkZWZhdWx0OiAxLCBtaW46IDAsIGlmOiB7dHlwZTogWydjaXJjbGUnLCAnY3ViZScsICdkb2RlY2FoZWRyb24nLCAncHlyYW1pZCddfX0sXG4gICAgcmV2ZXJzZToge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICB0eXBlOiB7ZGVmYXVsdDogJ2xpbmUnLCBvbmVPZjogWydib3gnLCAnY2lyY2xlJywgJ2N1YmUnLCAnZG9kZWNhaGVkcm9uJywgJ2xpbmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3B5cmFtaWQnXX0sXG4gICAgZmlsbDoge2RlZmF1bHQ6IHRydWUsIGlmOiB7dHlwZTogWydjaXJjbGUnXX19LFxuICAgIGFsaWduOiB7ZGVmYXVsdDogJ2VuZCcsIG9uZU9mOiBbJ3N0YXJ0JywgJ2NlbnRlcicsICdlbmQnXX1cbiAgfSxcblxuICAvKipcbiAgICogU3RvcmUgaW5pdGlhbCBwb3NpdGlvbnMgaW4gY2FzZSBuZWVkIHRvIHJlc2V0IG9uIGNvbXBvbmVudCByZW1vdmFsLlxuICAgKi9cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuXG4gICAgdGhpcy5jaGlsZHJlbiA9IGVsLmdldENoaWxkRW50aXRpZXMoKTtcbiAgICB0aGlzLmluaXRpYWxQb3NpdGlvbnMgPSBbXTtcblxuICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiBnZXRJbml0aWFsUG9zaXRpb25zIChjaGlsZEVsKSB7XG4gICAgICBpZiAoY2hpbGRFbC5oYXNMb2FkZWQpIHsgcmV0dXJuIF9nZXRQb3NpdGlvbnMoKTsgfVxuICAgICAgY2hpbGRFbC5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWQnLCBfZ2V0UG9zaXRpb25zKTtcbiAgICAgIGZ1bmN0aW9uIF9nZXRQb3NpdGlvbnMgKCkge1xuICAgICAgICBzZWxmLmluaXRpYWxQb3NpdGlvbnMucHVzaChjaGlsZEVsLm9iamVjdDNELnBvc2l0aW9uLngpO1xuICAgICAgICBzZWxmLmluaXRpYWxQb3NpdGlvbnMucHVzaChjaGlsZEVsLm9iamVjdDNELnBvc2l0aW9uLnkpO1xuICAgICAgICBzZWxmLmluaXRpYWxQb3NpdGlvbnMucHVzaChjaGlsZEVsLm9iamVjdDNELnBvc2l0aW9uLnopO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5oYW5kbGVDaGlsZEF0dGFjaGVkID0gdGhpcy5oYW5kbGVDaGlsZEF0dGFjaGVkLmJpbmQodGhpcyk7XG4gICAgdGhpcy5oYW5kbGVDaGlsZERldGFjaGVkID0gdGhpcy5oYW5kbGVDaGlsZERldGFjaGVkLmJpbmQodGhpcyk7XG5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjaGlsZC1hdHRhY2hlZCcsIHRoaXMuaGFuZGxlQ2hpbGRBdHRhY2hlZCk7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hpbGQtZGV0YWNoZWQnLCB0aGlzLmhhbmRsZUNoaWxkRGV0YWNoZWQpO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2xheW91dHJlZnJlc2gnLCB0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgfSxcblxuICAvKipcbiAgICogVXBkYXRlIGNoaWxkIGVudGl0eSBwb3NpdGlvbnMuXG4gICAqL1xuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgZGVmaW5lZERhdGE7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgbnVtQ2hpbGRyZW47XG4gICAgdmFyIHBvc2l0aW9uRm47XG5cbiAgICBudW1DaGlsZHJlbiA9IGNoaWxkcmVuLmxlbmd0aDtcblxuICAgIC8vIENhbGN1bGF0ZSBkaWZmZXJlbnQgcG9zaXRpb25zIGJhc2VkIG9uIGxheW91dCBzaGFwZS5cbiAgICBzd2l0Y2ggKGRhdGEudHlwZSkge1xuICAgICAgY2FzZSAnYm94Jzoge1xuICAgICAgICBwb3NpdGlvbkZuID0gZ2V0Qm94UG9zaXRpb25zO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ2NpcmNsZSc6IHtcbiAgICAgICAgcG9zaXRpb25GbiA9IGdldENpcmNsZVBvc2l0aW9ucztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdjdWJlJzoge1xuICAgICAgICBwb3NpdGlvbkZuID0gZ2V0Q3ViZVBvc2l0aW9ucztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdkb2RlY2FoZWRyb24nOiB7XG4gICAgICAgIHBvc2l0aW9uRm4gPSBnZXREb2RlY2FoZWRyb25Qb3NpdGlvbnM7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAncHlyYW1pZCc6IHtcbiAgICAgICAgcG9zaXRpb25GbiA9IGdldFB5cmFtaWRQb3NpdGlvbnM7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgZGVmYXVsdDoge1xuICAgICAgICAvLyBMaW5lLlxuICAgICAgICBwb3NpdGlvbkZuID0gZ2V0TGluZVBvc2l0aW9ucztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBkZWZpbmVkRGF0YSA9IGVsLmdldERPTUF0dHJpYnV0ZSgnbGF5b3V0Jyk7XG4gICAgcG9zaXRpb25zLmxlbmd0aCA9IDA7XG4gICAgcG9zaXRpb25zID0gcG9zaXRpb25GbihcbiAgICAgIGRhdGEsIG51bUNoaWxkcmVuLFxuICAgICAgdHlwZW9mIGRlZmluZWREYXRhID09PSAnc3RyaW5nJ1xuICAgICAgICA/IGRlZmluZWREYXRhLmluZGV4T2YoJ21hcmdpbicpICE9PSAtMVxuICAgICAgICA6ICdtYXJnaW4nIGluIGRlZmluZWREYXRhXG4gICAgKTtcbiAgICBpZiAoZGF0YS5yZXZlcnNlKSB7IHBvc2l0aW9ucy5yZXZlcnNlKCk7IH1cbiAgICBzZXRQb3NpdGlvbnMoY2hpbGRyZW4sIHBvc2l0aW9ucywgZGF0YS5vcmRlckF0dHJpYnV0ZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJlc2V0IHBvc2l0aW9ucy5cbiAgICovXG4gIHJlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2hpbGQtYXR0YWNoZWQnLCB0aGlzLmhhbmRsZUNoaWxkQXR0YWNoZWQpO1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2hpbGQtZGV0YWNoZWQnLCB0aGlzLmhhbmRsZUNoaWxkRGV0YWNoZWQpO1xuICAgIHNldFBvc2l0aW9ucyh0aGlzLmNoaWxkcmVuLCB0aGlzLmluaXRpYWxQb3NpdGlvbnMpO1xuICB9LFxuXG4gIGhhbmRsZUNoaWxkQXR0YWNoZWQ6IGZ1bmN0aW9uIChldnQpIHtcbiAgICAvLyBPbmx5IHVwZGF0ZSBpZiBkaXJlY3QgY2hpbGQgYXR0YWNoZWQuXG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICBpZiAoZXZ0LmRldGFpbC5lbC5wYXJlbnROb2RlICE9PSBlbCkgeyByZXR1cm47IH1cbiAgICB0aGlzLmNoaWxkcmVuLnB1c2goZXZ0LmRldGFpbC5lbCk7XG4gICAgdGhpcy51cGRhdGUoKTtcbiAgfSxcblxuICBoYW5kbGVDaGlsZERldGFjaGVkOiBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgLy8gT25seSB1cGRhdGUgaWYgZGlyZWN0IGNoaWxkIGRldGFjaGVkLlxuICAgIGlmICh0aGlzLmNoaWxkcmVuLmluZGV4T2YoZXZ0LmRldGFpbC5lbCkgPT09IC0xKSB7IHJldHVybjsgfVxuICAgIHRoaXMuY2hpbGRyZW4uc3BsaWNlKHRoaXMuY2hpbGRyZW4uaW5kZXhPZihldnQuZGV0YWlsLmVsKSwgMSk7XG4gICAgdGhpcy5pbml0aWFsUG9zaXRpb25zLnNwbGljZSh0aGlzLmNoaWxkcmVuLmluZGV4T2YoZXZ0LmRldGFpbC5lbCksIDEpO1xuICAgIHRoaXMudXBkYXRlKCk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIEdldCBwb3NpdGlvbnMgZm9yIGBib3hgIGxheW91dC5cbiAqL1xuZnVuY3Rpb24gZ2V0Qm94UG9zaXRpb25zIChkYXRhLCBudW1DaGlsZHJlbiwgbWFyZ2luRGVmaW5lZCkge1xuICB2YXIgY29sdW1uO1xuICB2YXIgbWFyZ2luQ29sdW1uO1xuICB2YXIgbWFyZ2luUm93O1xuICB2YXIgb2Zmc2V0Q29sdW1uO1xuICB2YXIgb2Zmc2V0Um93O1xuICB2YXIgcm93O1xuICB2YXIgcm93cyA9IE1hdGguY2VpbChudW1DaGlsZHJlbiAvIGRhdGEuY29sdW1ucyk7XG5cbiAgbWFyZ2luQ29sdW1uID0gZGF0YS5tYXJnaW5Db2x1bW47XG4gIG1hcmdpblJvdyA9IGRhdGEubWFyZ2luUm93O1xuICBpZiAobWFyZ2luRGVmaW5lZCkge1xuICAgIG1hcmdpbkNvbHVtbiA9IGRhdGEubWFyZ2luO1xuICAgIG1hcmdpblJvdyA9IGRhdGEubWFyZ2luO1xuICB9XG5cbiAgb2Zmc2V0Um93ID0gZ2V0T2Zmc2V0SXRlbUluZGV4KGRhdGEuYWxpZ24sIHJvd3MpO1xuICBvZmZzZXRDb2x1bW4gPSBnZXRPZmZzZXRJdGVtSW5kZXgoZGF0YS5hbGlnbiwgZGF0YS5jb2x1bW5zKTtcblxuICBmb3IgKHJvdyA9IDA7IHJvdyA8IHJvd3M7IHJvdysrKSB7XG4gICAgZm9yIChjb2x1bW4gPSAwOyBjb2x1bW4gPCBkYXRhLmNvbHVtbnM7IGNvbHVtbisrKSB7XG4gICAgICBwb3NpdGlvbkhlbHBlci5zZXQoMCwgMCwgMCk7XG4gICAgICBpZiAoZGF0YS5wbGFuZS5pbmRleE9mKCd4JykgPT09IDApIHtcbiAgICAgICAgcG9zaXRpb25IZWxwZXIueCA9IChjb2x1bW4gLSBvZmZzZXRDb2x1bW4pICogbWFyZ2luQ29sdW1uO1xuICAgICAgfVxuICAgICAgaWYgKGRhdGEucGxhbmUuaW5kZXhPZigneScpID09PSAwKSB7XG4gICAgICAgIHBvc2l0aW9uSGVscGVyLnkgPSAoY29sdW1uIC0gb2Zmc2V0Q29sdW1uKSAqIG1hcmdpbkNvbHVtbjtcbiAgICAgIH1cbiAgICAgIGlmIChkYXRhLnBsYW5lLmluZGV4T2YoJ3knKSA9PT0gMSkge1xuICAgICAgICBwb3NpdGlvbkhlbHBlci55ID0gKHJvdyAtIG9mZnNldFJvdykgKiBtYXJnaW5Sb3c7XG4gICAgICB9XG4gICAgICBpZiAoZGF0YS5wbGFuZS5pbmRleE9mKCd6JykgPT09IDEpIHtcbiAgICAgICAgcG9zaXRpb25IZWxwZXIueiA9IChyb3cgLSBvZmZzZXRSb3cpICogbWFyZ2luUm93O1xuICAgICAgfVxuICAgICAgcHVzaFBvc2l0aW9uVmVjMyhwb3NpdGlvbkhlbHBlcik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHBvc2l0aW9ucztcbn1cbm1vZHVsZS5leHBvcnRzLmdldEJveFBvc2l0aW9ucyA9IGdldEJveFBvc2l0aW9ucztcblxuLyoqXG4gKiBHZXQgcG9zaXRpb25zIGZvciBgY2lyY2xlYCBsYXlvdXQuXG4gKi9cbmZ1bmN0aW9uIGdldENpcmNsZVBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4pIHtcbiAgdmFyIGk7XG4gIHZhciByYWQ7XG5cbiAgZm9yIChpID0gMDsgaSA8IG51bUNoaWxkcmVuOyBpKyspIHtcbiAgICByYWQ7XG5cbiAgICBpZiAoaXNOYU4oZGF0YS5hbmdsZSkpIHtcbiAgICAgIHJhZCA9IGkgKiAoMiAqIE1hdGguUEkpIC8gbnVtQ2hpbGRyZW47XG4gICAgfSBlbHNlIHtcbiAgICAgIHJhZCA9IGkgKiBkYXRhLmFuZ2xlICogMC4wMTc0NTMyOTI1MjsgIC8vIEFuZ2xlIHRvIHJhZGlhbi5cbiAgICB9XG5cbiAgICBwb3NpdGlvbkhlbHBlci5zZXQoMCwgMCwgMCk7XG4gICAgaWYgKGRhdGEucGxhbmUuaW5kZXhPZigneCcpID09PSAwKSB7XG4gICAgICBwb3NpdGlvbkhlbHBlci54ID0gZGF0YS5yYWRpdXMgKiBNYXRoLmNvcyhyYWQpO1xuICAgIH1cbiAgICBpZiAoZGF0YS5wbGFuZS5pbmRleE9mKCd5JykgPT09IDApIHtcbiAgICAgIHBvc2l0aW9uSGVscGVyLnkgPSBkYXRhLnJhZGl1cyAqIE1hdGguY29zKHJhZCk7XG4gICAgfVxuICAgIGlmIChkYXRhLnBsYW5lLmluZGV4T2YoJ3knKSA9PT0gMSkge1xuICAgICAgcG9zaXRpb25IZWxwZXIueSA9IGRhdGEucmFkaXVzICogTWF0aC5zaW4ocmFkKTtcbiAgICB9XG4gICAgaWYgKGRhdGEucGxhbmUuaW5kZXhPZigneicpID09PSAxKSB7XG4gICAgICBwb3NpdGlvbkhlbHBlci56ID0gZGF0YS5yYWRpdXMgKiBNYXRoLnNpbihyYWQpO1xuICAgIH1cbiAgICBwdXNoUG9zaXRpb25WZWMzKHBvc2l0aW9uSGVscGVyKTtcbiAgfVxuICByZXR1cm4gcG9zaXRpb25zO1xufVxubW9kdWxlLmV4cG9ydHMuZ2V0Q2lyY2xlUG9zaXRpb25zID0gZ2V0Q2lyY2xlUG9zaXRpb25zO1xuXG4vKipcbiAqIEdldCBwb3NpdGlvbnMgZm9yIGBsaW5lYCBsYXlvdXQuXG4gKiBUT0RPOiAzRCBtYXJnaW5zLlxuICovXG5mdW5jdGlvbiBnZXRMaW5lUG9zaXRpb25zIChkYXRhLCBudW1DaGlsZHJlbikge1xuICBkYXRhLmNvbHVtbnMgPSBudW1DaGlsZHJlbjtcbiAgcmV0dXJuIGdldEJveFBvc2l0aW9ucyhkYXRhLCBudW1DaGlsZHJlbiwgdHJ1ZSk7XG59XG5tb2R1bGUuZXhwb3J0cy5nZXRMaW5lUG9zaXRpb25zID0gZ2V0TGluZVBvc2l0aW9ucztcblxuLyoqXG4gKiBHZXQgcG9zaXRpb25zIGZvciBgY3ViZWAgbGF5b3V0LlxuICovXG5mdW5jdGlvbiBnZXRDdWJlUG9zaXRpb25zIChkYXRhLCBudW1DaGlsZHJlbikge1xuICBwdXNoUG9zaXRpb25zKFxuICAgIDEsIDAsIDAsXG4gICAgMCwgMSwgMCxcbiAgICAwLCAwLCAxLFxuICAgIC0xLCAwLCAwLFxuICAgIDAsIC0xLCAwLFxuICAgIDAsIDAsIC0xXG4gICk7XG4gIHNjYWxlUG9zaXRpb25zKGRhdGEucmFkaXVzIC8gMik7XG4gIHJldHVybiBwb3NpdGlvbnM7XG59XG5tb2R1bGUuZXhwb3J0cy5nZXRDdWJlUG9zaXRpb25zID0gZ2V0Q3ViZVBvc2l0aW9ucztcblxuLyoqXG4gKiBHZXQgcG9zaXRpb25zIGZvciBgZG9kZWNhaGVkcm9uYCBsYXlvdXQuXG4gKi9cbmZ1bmN0aW9uIGdldERvZGVjYWhlZHJvblBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4pIHtcbiAgdmFyIFBISSA9ICgxICsgTWF0aC5zcXJ0KDUpKSAvIDI7XG4gIHZhciBCID0gMSAvIFBISTtcbiAgdmFyIEMgPSAyIC0gUEhJO1xuICB2YXIgTkIgPSAtMSAqIEI7XG4gIHZhciBOQyA9IC0xICogQztcbiAgcHVzaFBvc2l0aW9ucyhcbiAgICAtMSwgQywgMCxcbiAgICAtMSwgTkMsIDAsXG4gICAgMCwgLTEsIEMsXG4gICAgMCwgLTEsIE5DLFxuICAgIDAsIDEsIEMsXG4gICAgMCwgMSwgTkMsXG4gICAgMSwgQywgMCxcbiAgICAxLCBOQywgMCxcbiAgICBCLCBCLCBCLFxuICAgIEIsIEIsIE5CLFxuICAgIEIsIE5CLCBCLFxuICAgIEIsIE5CLCBOQixcbiAgICBDLCAwLCAxLFxuICAgIEMsIDAsIC0xLFxuICAgIE5CLCBCLCBCLFxuICAgIE5CLCBCLCBOQixcbiAgICBOQiwgTkIsIEIsXG4gICAgTkIsIE5CLCBOQixcbiAgICBOQywgMCwgMSxcbiAgICBOQywgMCwgLTFcbiAgKTtcbiAgc2NhbGVQb3NpdGlvbnMoZGF0YS5yYWRpdXMgLyAyKTtcbiAgcmV0dXJuIHBvc2l0aW9ucztcbn1cbm1vZHVsZS5leHBvcnRzLmdldERvZGVjYWhlZHJvblBvc2l0aW9ucyA9IGdldERvZGVjYWhlZHJvblBvc2l0aW9ucztcblxuLyoqXG4gKiBHZXQgcG9zaXRpb25zIGZvciBgcHlyYW1pZGAgbGF5b3V0LlxuICovXG5mdW5jdGlvbiBnZXRQeXJhbWlkUG9zaXRpb25zIChkYXRhLCBudW1DaGlsZHJlbikge1xuICB2YXIgU1FSVF8zID0gTWF0aC5zcXJ0KDMpO1xuICB2YXIgTkVHX1NRUlRfMV8zID0gLTEgLyBNYXRoLnNxcnQoMyk7XG4gIHZhciBEQkxfU1FSVF8yXzMgPSAyICogTWF0aC5zcXJ0KDIgLyAzKTtcbiAgcHVzaFBvc2l0aW9ucyhcbiAgICAwLCAwLCBTUVJUXzMgKyBORUdfU1FSVF8xXzMsXG4gICAgLTEsIDAsIE5FR19TUVJUXzFfMyxcbiAgICAxLCAwLCBORUdfU1FSVF8xXzMsXG4gICAgMCwgREJMX1NRUlRfMl8zLCAwXG4gICk7XG4gIHNjYWxlUG9zaXRpb25zKGRhdGEucmFkaXVzIC8gMik7XG4gIHJldHVybiBwb3NpdGlvbnM7XG59XG5tb2R1bGUuZXhwb3J0cy5nZXRQeXJhbWlkUG9zaXRpb25zID0gZ2V0UHlyYW1pZFBvc2l0aW9ucztcblxuLyoqXG4gKiBSZXR1cm4gdGhlIGl0ZW0gaW5kZXggaW4gYSBnaXZlbiBsaXN0IHRvIGNhbGN1bGF0ZSBvZmZzZXRzIGZyb21cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYWxpZ24gLSBPbmUgb2YgYCdzdGFydCdgLCBgJ2NlbnRlcidgLCBgJ2VuZCdgXG4gKiBAcGFyYW0ge2ludGVnZXJ9IG51bUl0ZW1zIC0gVG90YWwgbnVtYmVyIG9mIGl0ZW1zXG4gKi9cbmZ1bmN0aW9uIGdldE9mZnNldEl0ZW1JbmRleCAoYWxpZ24sIG51bUl0ZW1zKSB7XG4gIHN3aXRjaCAoYWxpZ24pIHtcbiAgICBjYXNlICdzdGFydCc6XG4gICAgICByZXR1cm4gbnVtSXRlbXMgLSAxO1xuICAgIGNhc2UgJ2NlbnRlcic6XG4gICAgICByZXR1cm4gKG51bUl0ZW1zIC0gMSkgLyAyO1xuICAgIGNhc2UgJ2VuZCc6XG4gICAgICByZXR1cm4gMDtcbiAgfVxufVxuXG4vKipcbiAqIE11bHRpcGx5IGFsbCBjb29yZGluYXRlcyBieSBhIHNjYWxlIGZhY3RvciBhbmQgYWRkIHRyYW5zbGF0ZS5cbiAqXG4gKiBAcGFyYW1zIHthcnJheX0gcG9zaXRpb25zIC0gQXJyYXkgb2YgY29vcmRpbmF0ZXMgaW4gYXJyYXkgZm9ybS5cbiAqIEByZXR1cm5zIHthcnJheX0gcG9zaXRpb25zXG4gKi9cbmZ1bmN0aW9uIHNjYWxlUG9zaXRpb25zIChzY2FsZSkge1xuICB2YXIgaTtcbiAgZm9yIChpID0gMDsgaSA8IHBvc2l0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgIHBvc2l0aW9uc1tpXSA9IHBvc2l0aW9uc1tpXSAqIHNjYWxlO1xuICB9XG59O1xuXG4vKipcbiAqIFNldCBwb3NpdGlvbiBvbiBjaGlsZCBlbnRpdGllcy5cbiAqXG4gKiBAcGFyYW0ge2FycmF5fSBlbHMgLSBDaGlsZCBlbnRpdGllcyB0byBzZXQuXG4gKiBAcGFyYW0ge2FycmF5fSBwb3NpdGlvbnMgLSBBcnJheSBvZiBjb29yZGluYXRlcy5cbiAqL1xuZnVuY3Rpb24gc2V0UG9zaXRpb25zIChlbHMsIHBvc2l0aW9ucywgb3JkZXJBdHRyaWJ1dGUpIHtcbiAgdmFyIHZhbHVlO1xuICB2YXIgaTtcbiAgdmFyIG9yZGVySW5kZXg7XG5cbiAgLy8gQWxsb3cgZm9yIGNvbnRyb2xsaW5nIG9yZGVyIGV4cGxpY2l0bHkgc2luY2UgRE9NIG9yZGVyIGRvZXMgbm90IGhhdmUgYXMgbXVjaFxuICAvLyBtZWFuaW5nIGluIEEtRnJhbWUuXG4gIGlmIChvcmRlckF0dHJpYnV0ZSkge1xuICAgIGZvciAoaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhbHVlID0gZWxzW2ldLmdldEF0dHJpYnV0ZShvcmRlckF0dHJpYnV0ZSk7XG4gICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgeyBjb250aW51ZTsgfVxuICAgICAgb3JkZXJJbmRleCA9IHBhcnNlSW50KHZhbHVlLCAxMCkgKiAzO1xuICAgICAgZWxzW2ldLm9iamVjdDNELnBvc2l0aW9uLnNldChwb3NpdGlvbnNbb3JkZXJJbmRleF0sIHBvc2l0aW9uc1tvcmRlckluZGV4ICsgMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uc1tvcmRlckluZGV4ICsgMl0pO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cblxuICBmb3IgKGkgPSAwOyBpIDwgcG9zaXRpb25zLmxlbmd0aDsgaSArPSAzKSB7XG4gICAgaWYgKCFlbHNbaSAvIDNdKSB7IHJldHVybjsgfVxuICAgIGVsc1tpIC8gM10ub2JqZWN0M0QucG9zaXRpb24uc2V0KHBvc2l0aW9uc1tpXSwgcG9zaXRpb25zW2kgKyAxXSwgcG9zaXRpb25zW2kgKyAyXSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcHVzaFBvc2l0aW9ucyAoKSB7XG4gIHZhciBpO1xuICBmb3IgKGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgcG9zaXRpb25zLnB1c2goaSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcHVzaFBvc2l0aW9uVmVjMyAodmVjMykge1xuICBwb3NpdGlvbnMucHVzaCh2ZWMzLngpO1xuICBwb3NpdGlvbnMucHVzaCh2ZWMzLnkpO1xuICBwb3NpdGlvbnMucHVzaCh2ZWMzLnopO1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1sYXlvdXQtY29tcG9uZW50L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAyNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJyZXF1aXJlKCcuL2xpYi9PcmJpdENvbnRyb2xzJyk7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnb3JiaXQtY29udHJvbHMnLCB7XG4gIGRlcGVuZGVuY2llczogWydjYW1lcmEnXSxcblxuICBzY2hlbWE6IHtcbiAgICBhdXRvUm90YXRlOiB7dHlwZTogJ2Jvb2xlYW4nfSxcbiAgICBhdXRvUm90YXRlU3BlZWQ6IHtkZWZhdWx0OiAyfSxcbiAgICBkYW1waW5nRmFjdG9yOiB7ZGVmYXVsdDogMC4xfSxcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlRGFtcGluZzoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGVuYWJsZUtleXM6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVQYW46IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVSb3RhdGU6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVab29tOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgaW5pdGlhbFBvc2l0aW9uOiB7dHlwZTogJ3ZlYzMnfSxcbiAgICBrZXlQYW5TcGVlZDoge2RlZmF1bHQ6IDd9LFxuICAgIG1pbkF6aW11dGhBbmdsZToge3R5cGU6ICdudW1iZXInLCBkZWZhdWx0OiBJbmZpbml0eX0sXG4gICAgbWF4QXppbXV0aEFuZ2xlOiB7dHlwZTogJ251bWJlcicsIGRlZmF1bHQ6IEluZmluaXR5fSxcbiAgICBtYXhEaXN0YW5jZToge2RlZmF1bHQ6IDEwMDB9LFxuICAgIG1heFBvbGFyQW5nbGU6IHtkZWZhdWx0OiBBRlJBTUUudXRpbHMuZGV2aWNlLmlzTW9iaWxlKCkgPyA5MCA6IDEyMH0sXG4gICAgbWluRGlzdGFuY2U6IHtkZWZhdWx0OiAxfSxcbiAgICBtaW5Qb2xhckFuZ2xlOiB7ZGVmYXVsdDogMH0sXG4gICAgbWluWm9vbToge2RlZmF1bHQ6IDB9LFxuICAgIHBhblNwZWVkOiB7ZGVmYXVsdDogMX0sXG4gICAgcm90YXRlU3BlZWQ6IHtkZWZhdWx0OiAwLjA1fSxcbiAgICBzY3JlZW5TcGFjZVBhbm5pbmc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgdGFyZ2V0OiB7dHlwZTogJ3ZlYzMnfSxcbiAgICB6b29tU3BlZWQ6IHtkZWZhdWx0OiAwLjV9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIG9sZFBvc2l0aW9uO1xuXG4gICAgdGhpcy5jb250cm9scyA9IG5ldyBUSFJFRS5PcmJpdENvbnRyb2xzKGVsLmdldE9iamVjdDNEKCdjYW1lcmEnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuc2NlbmVFbC5yZW5kZXJlci5kb21FbGVtZW50KTtcblxuICAgIG9sZFBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuICAgIGVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignZW50ZXItdnInLCAoKSA9PiB7XG4gICAgICBpZiAoIUFGUkFNRS51dGlscy5kZXZpY2UuY2hlY2tIZWFkc2V0Q29ubmVjdGVkKCkgJiZcbiAgICAgICAgICAhQUZSQU1FLnV0aWxzLmRldmljZS5pc01vYmlsZSgpKSB7IHJldHVybjsgfVxuICAgICAgdGhpcy5jb250cm9scy5lbmFibGVkID0gZmFsc2U7XG4gICAgICBpZiAoZWwuaGFzQXR0cmlidXRlKCdsb29rLWNvbnRyb2xzJykpIHtcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdsb29rLWNvbnRyb2xzJywgJ2VuYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgb2xkUG9zaXRpb24uY29weShlbC5nZXRPYmplY3QzRCgnY2FtZXJhJykucG9zaXRpb24pO1xuICAgICAgICBlbC5nZXRPYmplY3QzRCgnY2FtZXJhJykucG9zaXRpb24uc2V0KDAsIDAsIDApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZWwuc2NlbmVFbC5hZGRFdmVudExpc3RlbmVyKCdleGl0LXZyJywgKCkgPT4ge1xuICAgICAgaWYgKCFBRlJBTUUudXRpbHMuZGV2aWNlLmNoZWNrSGVhZHNldENvbm5lY3RlZCgpICYmXG4gICAgICAgICAgIUFGUkFNRS51dGlscy5kZXZpY2UuaXNNb2JpbGUoKSkgeyByZXR1cm47IH1cbiAgICAgIHRoaXMuY29udHJvbHMuZW5hYmxlZCA9IHRydWU7XG4gICAgICBlbC5nZXRPYmplY3QzRCgnY2FtZXJhJykucG9zaXRpb24uY29weShvbGRQb3NpdGlvbik7XG4gICAgICBpZiAoZWwuaGFzQXR0cmlidXRlKCdsb29rLWNvbnRyb2xzJykpIHtcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdsb29rLWNvbnRyb2xzJywgJ2VuYWJsZWQnLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICdncmFiJztcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoKSA9PiB7XG4gICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICdncmFiYmluZyc7XG4gICAgfSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsICgpID0+IHtcbiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gJ2dyYWInO1xuICAgIH0pO1xuXG4gICAgdGhpcy50YXJnZXQgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIGVsLmdldE9iamVjdDNEKCdjYW1lcmEnKS5wb3NpdGlvbi5jb3B5KHRoaXMuZGF0YS5pbml0aWFsUG9zaXRpb24pO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB2YXIgY29udHJvbHMgPSB0aGlzLmNvbnRyb2xzO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgY29udHJvbHMudGFyZ2V0ID0gdGhpcy50YXJnZXQuY29weShkYXRhLnRhcmdldCk7XG4gICAgY29udHJvbHMuYXV0b1JvdGF0ZSA9IGRhdGEuYXV0b1JvdGF0ZTtcbiAgICBjb250cm9scy5hdXRvUm90YXRlU3BlZWQgPSBkYXRhLmF1dG9Sb3RhdGVTcGVlZDtcbiAgICBjb250cm9scy5kYW1waW5nRmFjdG9yID0gZGF0YS5kYW1waW5nRmFjdG9yO1xuICAgIGNvbnRyb2xzLmVuYWJsZWQgPSBkYXRhLmVuYWJsZWQ7XG4gICAgY29udHJvbHMuZW5hYmxlRGFtcGluZyA9IGRhdGEuZW5hYmxlRGFtcGluZztcbiAgICBjb250cm9scy5lbmFibGVLZXlzID0gZGF0YS5lbmFibGVLZXlzO1xuICAgIGNvbnRyb2xzLmVuYWJsZVBhbiA9IGRhdGEuZW5hYmxlUGFuO1xuICAgIGNvbnRyb2xzLmVuYWJsZVJvdGF0ZSA9IGRhdGEuZW5hYmxlUm90YXRlO1xuICAgIGNvbnRyb2xzLmVuYWJsZVpvb20gPSBkYXRhLmVuYWJsZVpvb207XG4gICAgY29udHJvbHMua2V5UGFuU3BlZWQgPSBkYXRhLmtleVBhblNwZWVkO1xuICAgIGNvbnRyb2xzLm1heFBvbGFyQW5nbGUgPSBUSFJFRS5NYXRoLmRlZ1RvUmFkKGRhdGEubWF4UG9sYXJBbmdsZSk7XG4gICAgY29udHJvbHMubWF4RGlzdGFuY2UgPSBkYXRhLm1heERpc3RhbmNlO1xuICAgIGNvbnRyb2xzLm1pbkRpc3RhbmNlID0gZGF0YS5taW5EaXN0YW5jZTtcbiAgICBjb250cm9scy5taW5Qb2xhckFuZ2xlID0gVEhSRUUuTWF0aC5kZWdUb1JhZChkYXRhLm1pblBvbGFyQW5nbGUpO1xuICAgIGNvbnRyb2xzLm1pblpvb20gPSBkYXRhLm1pblpvb207XG4gICAgY29udHJvbHMucGFuU3BlZWQgPSBkYXRhLnBhblNwZWVkO1xuICAgIGNvbnRyb2xzLnJvdGF0ZVNwZWVkID0gZGF0YS5yb3RhdGVTcGVlZDtcbiAgICBjb250cm9scy5zY3JlZW5TcGFjZVBhbm5pbmcgPSBkYXRhLnNjcmVlblNwYWNlUGFubmluZztcbiAgICBjb250cm9scy56b29tU3BlZWQgPSBkYXRhLnpvb21TcGVlZDtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNvbnRyb2xzID0gdGhpcy5jb250cm9scztcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBpZiAoIWRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cbiAgICBpZiAoY29udHJvbHMuZW5hYmxlZCAmJiAoY29udHJvbHMuZW5hYmxlRGFtcGluZyB8fCBjb250cm9scy5hdXRvUm90YXRlKSkge1xuICAgICAgdGhpcy5jb250cm9scy51cGRhdGUoKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1vcmJpdC1jb250cm9scy9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBMaXN0ZW4gdG8gZXZlbnQgYW5kIGZvcndhcmQgdG8gYW5vdGhlciBlbnRpdHkgb3IgZW50aXRpZXMuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgncHJveHktZXZlbnQnLCB7XG4gIHNjaGVtYToge1xuICAgIGNhcHR1cmVCdWJibGVzOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBldmVudDoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBmcm9tOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIHRvOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIGFzOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIGJ1YmJsZXM6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgZnJvbTtcbiAgICB2YXIgaTtcbiAgICB2YXIgdG87XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgaWYgKGRhdGEuZnJvbSkge1xuICAgICAgaWYgKGRhdGEuZnJvbSA9PT0gJ1BBUkVOVCcpIHtcbiAgICAgICAgZnJvbSA9IFtlbC5wYXJlbnROb2RlXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZyb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGRhdGEuZnJvbSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChkYXRhLnRvID09PSAnQ0hJTERSRU4nKSB7XG4gICAgICAgIHRvID0gZWwucXVlcnlTZWxlY3RvckFsbCgnKicpO1xuICAgICAgfSBlbHNlIGlmIChkYXRhLnRvID09PSAnU0VMRicpIHtcbiAgICAgICAgdG8gPSBbZWxdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGRhdGEudG8pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChkYXRhLmZyb20pIHtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBmcm9tLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lckZyb20oZnJvbVtpXSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoZGF0YS5ldmVudCwgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICB2YXIgZGF0YSA9IHNlbGYuZGF0YTtcbiAgICAgICAgaWYgKCFkYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIGlmICghZGF0YS5jYXB0dXJlQnViYmxlcyAmJiBldnQudGFyZ2V0ICE9PSBlbCkgeyByZXR1cm47IH1cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHRvLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdG9baV0uZW1pdChkYXRhLmFzIHx8IGRhdGEuZXZlbnQsIGV2dFsnZGV0YWlsJ10gPyBldnQuZGV0YWlsIDogbnVsbCwgZGF0YS5idWJibGVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIGFkZEV2ZW50TGlzdGVuZXJGcm9tOiBmdW5jdGlvbiAoZnJvbUVsKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIGZyb21FbC5hZGRFdmVudExpc3RlbmVyKGRhdGEuZXZlbnQsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgIHZhciBkYXRhID0gc2VsZi5kYXRhO1xuICAgICAgaWYgKCFkYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgICBpZiAoIWRhdGEuY2FwdHVyZUJ1YmJsZXMgJiYgZXZ0LnRhcmdldCAhPT0gZnJvbUVsKSB7IHJldHVybjsgfVxuICAgICAgc2VsZi5lbC5lbWl0KGRhdGEuYXMgfHwgZGF0YS5ldmVudCwgZXZ0WydkZXRhaWwnXSA/IGV2dC5kZXRhaWwgOiBudWxsLCBmYWxzZSk7XG4gICAgfSk7XG4gIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1wcm94eS1ldmVudC1jb21wb25lbnQvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDI3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XG5cdFx0Zm9yKHZhciBpIGluIGEpICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBleHBvcnRzIDogcm9vdClbaV0gPSBhW2ldO1xuXHR9XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRpOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGw6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG4vKiBnbG9iYWwgQUZSQU1FICovXG5cbmlmICh0eXBlb2YgQUZSQU1FID09PSAndW5kZWZpbmVkJykge1xuXHR0aHJvdyBuZXcgRXJyb3IoJ0NvbXBvbmVudCBhdHRlbXB0ZWQgdG8gcmVnaXN0ZXIgYmVmb3JlIEFGUkFNRSB3YXMgYXZhaWxhYmxlLicpO1xufVxuXG5BRlJBTUUucmVnaXN0ZXJTaGFkZXIoJ3JpbmcnLCB7XG5cdHNjaGVtYToge1xuXHRcdGJsdXI6IHsgZGVmYXVsdDogMC4wMSwgaXM6ICd1bmlmb3JtJyB9LFxuXHRcdGNvbG9yOiB7IHR5cGU6ICdjb2xvcicsIGlzOiAndW5pZm9ybScgfSxcblx0XHRwcm9ncmVzczogeyBkZWZhdWx0OiAwLCBpczogJ3VuaWZvcm0nIH0sXG5cdFx0cmFkaXVzSW5uZXI6IHsgZGVmYXVsdDogMC44NSwgaXM6ICd1bmlmb3JtJyB9LFxuXHRcdHJhZGl1c091dGVyOiB7IGRlZmF1bHQ6IDEsIGlzOiAndW5pZm9ybScgfVxuXHR9LFxuXG5cdHZlcnRleFNoYWRlcjogX193ZWJwYWNrX3JlcXVpcmVfXygxKSxcblxuXHRmcmFnbWVudFNoYWRlcjogX193ZWJwYWNrX3JlcXVpcmVfXygyKVxufSk7XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IFwidmFyeWluZyB2ZWMyIHZVdjtcXG5cXG52b2lkIG1haW4gKCkge1xcbiAgdlV2ID0gdXY7XFxuICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KHBvc2l0aW9uLCAxLjApO1xcbn1cXG5cIlxuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSBcIiNkZWZpbmUgUEkgMy4xNDE1OTI2NTM1ODk3OVxcbnVuaWZvcm0gZmxvYXQgYmx1cjtcXG51bmlmb3JtIGZsb2F0IHByb2dyZXNzO1xcbnVuaWZvcm0gZmxvYXQgcmFkaXVzSW5uZXI7XFxudW5pZm9ybSBmbG9hdCByYWRpdXNPdXRlcjtcXG51bmlmb3JtIHZlYzMgY29sb3I7XFxuXFxudmFyeWluZyB2ZWMyIHZVdjtcXG5cXG52b2lkIG1haW4gKCkge1xcbiAgdmVjMiB1diA9IHZlYzIodlV2LnggKiAyLiAtIDEuLCB2VXYueSAqIDIuIC0gMS4pO1xcbiAgZmxvYXQgciA9IHV2LnggKiB1di54ICsgdXYueSAqIHV2Lnk7XFxuICBmbG9hdCBjb2wgPSAoMS4wIC0gc21vb3Roc3RlcChyYWRpdXNPdXRlciwgcmFkaXVzT3V0ZXIgKyBibHVyLCByKSkgKiBzbW9vdGhzdGVwKHJhZGl1c0lubmVyLCByYWRpdXNJbm5lciArIGJsdXIsIHIpO1xcbiAgZmxvYXQgYSA9IHNtb290aHN0ZXAoLVBJLCBQSSwgYXRhbih1di55LCB1di54KSk7XFxuICBmbG9hdCBwID0gMS4wIC0gcHJvZ3Jlc3MgLSBibHVyO1xcbiAgY29sICo9IHNtb290aHN0ZXAocCwgcCArIGJsdXIsIGEpO1xcbiAgZ2xfRnJhZ0NvbG9yID0gdmVjNChjb2xvciAqIGNvbCwgY29sKTtcXG59XFxuXCJcblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xufSk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1yaW5nLXNoYWRlci9kaXN0L2FmcmFtZS1yaW5nLXNoYWRlci5qc1xuLy8gbW9kdWxlIGlkID0gMjhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyogZ2xvYmFsIEFGUkFNRSAqL1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxuLyoqXG4gKiBTbGljZTkgY29tcG9uZW50IGZvciBBLUZyYW1lLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NsaWNlOScsIHtcbiAgc2NoZW1hOiB7XG4gICAgd2lkdGg6IHtkZWZhdWx0OiAxLCBtaW46IDB9LFxuICAgIGhlaWdodDoge2RlZmF1bHQ6IDEsIG1pbjogMH0sXG4gICAgbGVmdDoge2RlZmF1bHQ6IDAsIG1pbjogMH0sXG4gICAgcmlnaHQ6IHtkZWZhdWx0OiAwLCBtaW46IDB9LFxuICAgIGJvdHRvbToge2RlZmF1bHQ6IDAsIG1pbjogMH0sXG4gICAgdG9wOiB7ZGVmYXVsdDogMCwgbWluOiAwfSxcbiAgICBzaWRlOiB7ZGVmYXVsdDogJ2Zyb250Jywgb25lT2Y6IFsnZnJvbnQnLCAnYmFjaycsICdkb3VibGUnXX0sXG4gICAgcGFkZGluZzoge2RlZmF1bHQ6IDAuMSwgbWluOiAwLjAxfSxcbiAgICBjb2xvcjoge3R5cGU6ICdjb2xvcicsIGRlZmF1bHQ6ICcjZmZmJ30sXG4gICAgb3BhY2l0eToge2RlZmF1bHQ6IDEuMCwgbWluOiAwLCBtYXg6IDF9LFxuICAgIHRyYW5zcGFyZW50OiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZGVidWc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgc3JjOiB7dHlwZTogJ21hcCd9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFNldCBpZiBjb21wb25lbnQgbmVlZHMgbXVsdGlwbGUgaW5zdGFuY2luZy5cbiAgICovXG4gIG11bHRpcGxlOiBmYWxzZSxcblxuICAvKipcbiAgICogQ2FsbGVkIG9uY2Ugd2hlbiBjb21wb25lbnQgaXMgYXR0YWNoZWQuIEdlbmVyYWxseSBmb3IgaW5pdGlhbCBzZXR1cC5cbiAgICovXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgbWF0ZXJpYWwgPSB0aGlzLm1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtjb2xvcjogZGF0YS5jb2xvciwgb3BhY2l0eTogZGF0YS5vcGFjaXR5LCB0cmFuc3BhcmVudDogZGF0YS50cmFuc3BhcmVudCwgd2lyZWZyYW1lOiBkYXRhLmRlYnVnfSk7XG4gICAgdmFyIGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUJ1ZmZlckdlb21ldHJ5KGRhdGEud2lkdGgsIGRhdGEuaGVpZ2h0LCAzLCAzKTtcblxuICAgIHZhciB0ZXh0dXJlTG9hZGVyID0gbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKTtcbiAgICB0aGlzLnBsYW5lID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcbiAgICB0aGlzLmVsLnNldE9iamVjdDNEKCdtZXNoJywgdGhpcy5wbGFuZSk7XG4gICAgdGhpcy50ZXh0dXJlU3JjID0gbnVsbDtcbiAgfSxcblxuICB1cGRhdGVNYXA6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc3JjID0gdGhpcy5kYXRhLnNyYztcblxuICAgIGlmIChzcmMpIHtcbiAgICAgIGlmIChzcmMgPT09IHRoaXMudGV4dHVyZVNyYykgeyByZXR1cm47IH1cbiAgICAgIC8vIFRleHR1cmUgYWRkZWQgb3IgY2hhbmdlZC5cbiAgICAgIHRoaXMudGV4dHVyZVNyYyA9IHNyYztcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFsLmxvYWRUZXh0dXJlKHNyYywge3NyYzogc3JjfSwgc2V0TWFwLmJpbmQodGhpcykpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFRleHR1cmUgcmVtb3ZlZC5cbiAgICBpZiAoIXRoaXMubWF0ZXJpYWwubWFwKSB7IHJldHVybjsgfVxuICAgIHNldE1hcChudWxsKTtcblxuXG4gICAgZnVuY3Rpb24gc2V0TWFwICh0ZXh0dXJlKSB7XG4gICAgICB0aGlzLm1hdGVyaWFsLm1hcCA9IHRleHR1cmU7XG4gICAgICB0aGlzLm1hdGVyaWFsLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICAgIHRoaXMucmVnZW5lcmF0ZU1lc2goKTtcbiAgICB9XG4gIH0sXG5cbiAgcmVnZW5lcmF0ZU1lc2g6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgcG9zID0gdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5O1xuICAgIHZhciB1dnMgPSB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMudXYuYXJyYXk7XG4gICAgdmFyIGltYWdlID0gdGhpcy5tYXRlcmlhbC5tYXAuaW1hZ2U7XG5cbiAgICBpZiAoIWltYWdlKSB7cmV0dXJuO31cblxuICAgIC8qXG4gICAgICAwLS0xLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMi0tM1xuICAgICAgfCAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIHxcbiAgICAgIDQtLTUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS02LS03XG4gICAgICB8ICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgfFxuICAgICAgfCAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIHxcbiAgICAgIHwgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICB8XG4gICAgICA4LS05LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xMC0tMTFcbiAgICAgIHwgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICB8XG4gICAgICAxMi0xMy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNC0tMTVcbiAgICAqL1xuICAgIGZ1bmN0aW9uIHNldFBvcyhpZCwgeCwgeSkge1xuICAgICAgcG9zWzMgKiBpZF0gPSB4O1xuICAgICAgcG9zWzMgKiBpZCArIDFdID0geTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRVVihpZCwgdSwgdikge1xuICAgICAgdXZzWzIgKiBpZF0gPSB1O1xuICAgICAgdXZzWzIgKiBpZCArIDFdID0gdjtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgVVZTXG4gICAgdmFyIHV2ID0ge1xuICAgICAgbGVmdDogZGF0YS5sZWZ0IC8gaW1hZ2Uud2lkdGgsXG4gICAgICByaWdodDogZGF0YS5yaWdodCAvIGltYWdlLndpZHRoLFxuICAgICAgdG9wOiBkYXRhLnRvcCAvIGltYWdlLmhlaWdodCxcbiAgICAgIGJvdHRvbTogZGF0YS5ib3R0b20gLyBpbWFnZS5oZWlnaHRcbiAgICB9O1xuXG4gICAgc2V0VVYoMSwgIHV2LmxlZnQsICAxKTtcbiAgICBzZXRVVigyLCAgdXYucmlnaHQsIDEpO1xuXG4gICAgc2V0VVYoNCwgIDAsICAgICAgICB1di5ib3R0b20pO1xuICAgIHNldFVWKDUsICB1di5sZWZ0LCAgdXYuYm90dG9tKTtcbiAgICBzZXRVVig2LCAgdXYucmlnaHQsIHV2LmJvdHRvbSk7XG4gICAgc2V0VVYoNywgIDEsICAgICAgICB1di5ib3R0b20pO1xuXG4gICAgc2V0VVYoOCwgIDAsICAgICAgICB1di50b3ApO1xuICAgIHNldFVWKDksICB1di5sZWZ0LCAgdXYudG9wKTtcbiAgICBzZXRVVigxMCwgdXYucmlnaHQsIHV2LnRvcCk7XG4gICAgc2V0VVYoMTEsIDEsICAgICAgICB1di50b3ApO1xuXG4gICAgc2V0VVYoMTMsIHV2LmxlZnQsICAwKTtcbiAgICBzZXRVVigxNCwgdXYucmlnaHQsIDApO1xuXG4gICAgLy8gVXBkYXRlIHZlcnRleCBwb3NpdGlvbnNcbiAgICB2YXIgdzIgPSBkYXRhLndpZHRoIC8gMjtcbiAgICB2YXIgaDIgPSBkYXRhLmhlaWdodCAvIDI7XG4gICAgdmFyIGxlZnQgPSAtdzIgKyBkYXRhLnBhZGRpbmc7XG4gICAgdmFyIHJpZ2h0ID0gdzIgLSBkYXRhLnBhZGRpbmc7XG4gICAgdmFyIHRvcCA9IGgyIC0gZGF0YS5wYWRkaW5nO1xuICAgIHZhciBib3R0b20gPSAtaDIgKyBkYXRhLnBhZGRpbmc7XG5cbiAgICBzZXRQb3MoMCwgLXcyLCAgICBoMik7XG4gICAgc2V0UG9zKDEsIGxlZnQsICAgaDIpO1xuICAgIHNldFBvcygyLCByaWdodCwgIGgyKTtcbiAgICBzZXRQb3MoMywgdzIsICAgICBoMik7XG5cbiAgICBzZXRQb3MoNCwgLXcyLCAgICB0b3ApO1xuICAgIHNldFBvcyg1LCBsZWZ0LCAgIHRvcCk7XG4gICAgc2V0UG9zKDYsIHJpZ2h0LCAgdG9wKTtcbiAgICBzZXRQb3MoNywgdzIsICAgICB0b3ApO1xuXG4gICAgc2V0UG9zKDgsIC13MiwgICAgYm90dG9tKTtcbiAgICBzZXRQb3MoOSwgbGVmdCwgICBib3R0b20pO1xuICAgIHNldFBvcygxMCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgc2V0UG9zKDExLCB3MiwgICAgYm90dG9tKTtcblxuICAgIHNldFBvcygxMywgbGVmdCwgIC1oMik7XG4gICAgc2V0UG9zKDE0LCByaWdodCwgLWgyKTtcbiAgICBzZXRQb3MoMTIsIC13MiwgICAtaDIpO1xuICAgIHNldFBvcygxNSwgdzIsICAgIC1oMik7XG5cbiAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy51di5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gIH0sXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGNvbXBvbmVudCBpcyBhdHRhY2hlZCBhbmQgd2hlbiBjb21wb25lbnQgZGF0YSBjaGFuZ2VzLlxuICAgKiBHZW5lcmFsbHkgbW9kaWZpZXMgdGhlIGVudGl0eSBiYXNlZCBvbiB0aGUgZGF0YS5cbiAgICovXG4gICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgIHRoaXMubWF0ZXJpYWwuY29sb3Iuc2V0U3R5bGUoZGF0YS5jb2xvcik7XG4gICAgIHRoaXMubWF0ZXJpYWwub3BhY2l0eSA9IGRhdGEub3BhY2l0eTtcbiAgICAgdGhpcy5tYXRlcmlhbC50cmFuc3BhcmVudCA9IGRhdGEudHJhbnNwYXJlbnQ7XG4gICAgIHRoaXMubWF0ZXJpYWwud2lyZWZyYW1lID0gZGF0YS5kZWJ1ZztcbiAgICAgdGhpcy5tYXRlcmlhbC5zaWRlID0gcGFyc2VTaWRlKGRhdGEuc2lkZSk7XG5cbiAgICAgdmFyIGRpZmYgPSBBRlJBTUUudXRpbHMuZGlmZihkYXRhLCBvbGREYXRhKTtcbiAgICAgaWYgKCdzcmMnIGluIGRpZmYpIHtcbiAgICAgICB0aGlzLnVwZGF0ZU1hcCgpO1xuICAgICB9XG4gICAgIGVsc2UgaWYgKCd3aWR0aCcgaW4gZGlmZiB8fCAnaGVpZ2h0JyBpbiBkaWZmIHx8ICdwYWRkaW5nJyBpbiBkaWZmIHx8ICdsZWZ0JyBpbiBkaWZmIHx8wqAndG9wJyBpbiBkaWZmIHx8wqAnYm90dG9tJyBpbiBkaWZmIHx8wqAncmlnaHQnIGluIGRpZmYpIHtcbiAgICAgICB0aGlzLnJlZ2VuZXJhdGVNZXNoKCk7XG4gICAgIH1cbiAgIH0sXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGEgY29tcG9uZW50IGlzIHJlbW92ZWQgKGUuZy4sIHZpYSByZW1vdmVBdHRyaWJ1dGUpLlxuICAgKiBHZW5lcmFsbHkgdW5kb2VzIGFsbCBtb2RpZmljYXRpb25zIHRvIHRoZSBlbnRpdHkuXG4gICAqL1xuICByZW1vdmU6IGZ1bmN0aW9uICgpIHsgfSxcblxuICAvKipcbiAgICogQ2FsbGVkIG9uIGVhY2ggc2NlbmUgdGljay5cbiAgICovXG4gIC8vIHRpY2s6IGZ1bmN0aW9uICh0KSB7IH0sXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGVudGl0eSBwYXVzZXMuXG4gICAqIFVzZSB0byBzdG9wIG9yIHJlbW92ZSBhbnkgZHluYW1pYyBvciBiYWNrZ3JvdW5kIGJlaGF2aW9yIHN1Y2ggYXMgZXZlbnRzLlxuICAgKi9cbiAgcGF1c2U6IGZ1bmN0aW9uICgpIHsgfSxcblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gZW50aXR5IHJlc3VtZXMuXG4gICAqIFVzZSB0byBjb250aW51ZSBvciBhZGQgYW55IGR5bmFtaWMgb3IgYmFja2dyb3VuZCBiZWhhdmlvciBzdWNoIGFzIGV2ZW50cy5cbiAgICovXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHsgfVxufSk7XG5cbmZ1bmN0aW9uIHBhcnNlU2lkZSAoc2lkZSkge1xuICBzd2l0Y2ggKHNpZGUpIHtcbiAgICBjYXNlICdiYWNrJzoge1xuICAgICAgcmV0dXJuIFRIUkVFLkJhY2tTaWRlO1xuICAgIH1cbiAgICBjYXNlICdkb3VibGUnOiB7XG4gICAgICByZXR1cm4gVEhSRUUuRG91YmxlU2lkZTtcbiAgICB9XG4gICAgZGVmYXVsdDoge1xuICAgICAgLy8gSW5jbHVkaW5nIGNhc2UgYGZyb250YC5cbiAgICAgIHJldHVybiBUSFJFRS5Gcm9udFNpZGU7XG4gICAgfVxuICB9XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLXNsaWNlOS1jb21wb25lbnQvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDI5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XG5cdFx0Zm9yKHZhciBpIGluIGEpICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBleHBvcnRzIDogcm9vdClbaV0gPSBhW2ldO1xuXHR9XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRpOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGw6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG4vLyBQcmUtY29tcGlsZWQgZnVuY3Rpb25zLlxudmFyIHNlbGVjdEZ1bmN0aW9ucyA9IHt9O1xuXG4vKipcbiAqIFNlbGVjdCB2YWx1ZSBmcm9tIHN0b3JlLiBIYW5kbGVzIGJvb2xlYW4gb3BlcmF0aW9ucywgY2FsbHMgYHNlbGVjdFByb3BlcnR5YC5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gc3RhdGUgLSBTdGF0ZSBvYmplY3QuXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3IgLSBEb3QtZGVsaW1pdGVkIHN0b3JlIGtleXMgKGUuZy4sIGdhbWUucGxheWVyLmhlYWx0aCkuXG4gKiBAcGFyYW0ge29iamVjdH0gaXRlbSAtIEZyb20gYmluZC1pdGVtLlxuICovXG5mdW5jdGlvbiBzZWxlY3Qoc3RhdGUsIHNlbGVjdG9yLCBpdGVtKSB7XG4gIGlmICghc2VsZWN0RnVuY3Rpb25zW3NlbGVjdG9yXSkge1xuICAgIHNlbGVjdEZ1bmN0aW9uc1tzZWxlY3Rvcl0gPSBuZXcgRnVuY3Rpb24oJ3N0YXRlJywgJ2l0ZW0nLCAncmV0dXJuICcgKyBnZW5lcmF0ZUV4cHJlc3Npb24oc2VsZWN0b3IpICsgJzsnKTtcbiAgfVxuICByZXR1cm4gc2VsZWN0RnVuY3Rpb25zW3NlbGVjdG9yXShzdGF0ZSwgaXRlbSk7XG59XG5tb2R1bGUuZXhwb3J0cy5zZWxlY3QgPSBzZWxlY3Q7XG5cbnZhciBET1RfTk9UQVRJT05fUkUgPSAvXFwuKFtBLVphLXpdW1xcd18tXSopL2c7XG52YXIgV0hJVEVTUEFDRV9SRSA9IC9cXHMvZztcbnZhciBTVEFURV9TRUxFQ1RPUl9SRSA9IC8oWz0mfCE/OistXSkoXFxzKikoW1xcKF0/KShbQS1aYS16XVtcXHdfLV0qKS9nO1xudmFyIFJPT1RfU1RBVEVfU0VMRUNUT1JfUkUgPSAvXihbXFwoXT8pKFtBLVphLXpdW1xcd18tXSopL2c7XG52YXIgSVRFTV9SRSA9IC9zdGF0ZVxcW1wiaXRlbVwiXFxdL2c7XG52YXIgU1RBVEVfU1RSID0gJ3N0YXRlJztcbmZ1bmN0aW9uIGdlbmVyYXRlRXhwcmVzc2lvbihzdHIpIHtcbiAgc3RyID0gc3RyLnJlcGxhY2UoRE9UX05PVEFUSU9OX1JFLCAnW1wiJDFcIl0nKTtcbiAgc3RyID0gc3RyLnJlcGxhY2UoUk9PVF9TVEFURV9TRUxFQ1RPUl9SRSwgJyQxc3RhdGVbXCIkMlwiXScpO1xuICBzdHIgPSBzdHIucmVwbGFjZShTVEFURV9TRUxFQ1RPUl9SRSwgJyQxJDIkM3N0YXRlW1wiJDRcIl0nKTtcbiAgc3RyID0gc3RyLnJlcGxhY2UoSVRFTV9SRSwgJ2l0ZW0nKTtcbiAgcmV0dXJuIHN0cjtcbn1cbm1vZHVsZS5leHBvcnRzLmdlbmVyYXRlRXhwcmVzc2lvbiA9IGdlbmVyYXRlRXhwcmVzc2lvbjtcblxuZnVuY3Rpb24gY2xlYXJPYmplY3Qob2JqKSB7XG4gIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICBkZWxldGUgb2JqW2tleV07XG4gIH1cbn1cbm1vZHVsZS5leHBvcnRzLmNsZWFyT2JqZWN0ID0gY2xlYXJPYmplY3Q7XG5cbi8qKlxuICogSGVscGVyIHRvIGNvbXBvc2Ugb2JqZWN0IG9mIGhhbmRsZXJzLCBtZXJnaW5nIGZ1bmN0aW9ucyBoYW5kbGluZyBzYW1lIGFjdGlvbi5cbiAqL1xuZnVuY3Rpb24gY29tcG9zZUhhbmRsZXJzKCkge1xuICB2YXIgYWN0aW9uTmFtZTtcbiAgdmFyIGk7XG4gIHZhciBpbnB1dEhhbmRsZXJzID0gYXJndW1lbnRzO1xuICB2YXIgb3V0cHV0SGFuZGxlcnM7XG5cbiAgb3V0cHV0SGFuZGxlcnMgPSB7fTtcbiAgZm9yIChpID0gMDsgaSA8IGlucHV0SGFuZGxlcnMubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGFjdGlvbk5hbWUgaW4gaW5wdXRIYW5kbGVyc1tpXSkge1xuICAgICAgaWYgKGFjdGlvbk5hbWUgaW4gb3V0cHV0SGFuZGxlcnMpIHtcbiAgICAgICAgLy8gSW5pdGlhbCBjb21wb3NlL21lcmdlIGZ1bmN0aW9ucyBpbnRvIGFycmF5cy5cbiAgICAgICAgaWYgKG91dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdLmNvbnN0cnVjdG9yID09PSBBcnJheSkge1xuICAgICAgICAgIG91dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdLnB1c2goaW5wdXRIYW5kbGVyc1tpXVthY3Rpb25OYW1lXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb3V0cHV0SGFuZGxlcnNbYWN0aW9uTmFtZV0gPSBbb3V0cHV0SGFuZGxlcnNbYWN0aW9uTmFtZV0sIGlucHV0SGFuZGxlcnNbaV1bYWN0aW9uTmFtZV1dO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvdXRwdXRIYW5kbGVyc1thY3Rpb25OYW1lXSA9IGlucHV0SGFuZGxlcnNbaV1bYWN0aW9uTmFtZV07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQ29tcG9zZSBmdW5jdGlvbnMgc3BlY2lmaWVkIHZpYSBhcnJheS5cbiAgZm9yIChhY3Rpb25OYW1lIGluIG91dHB1dEhhbmRsZXJzKSB7XG4gICAgaWYgKG91dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdLmNvbnN0cnVjdG9yID09PSBBcnJheSkge1xuICAgICAgb3V0cHV0SGFuZGxlcnNbYWN0aW9uTmFtZV0gPSBjb21wb3NlRnVuY3Rpb25zLmFwcGx5KHRoaXMsIG91dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gb3V0cHV0SGFuZGxlcnM7XG59XG5tb2R1bGUuZXhwb3J0cy5jb21wb3NlSGFuZGxlcnMgPSBjb21wb3NlSGFuZGxlcnM7XG5cbmZ1bmN0aW9uIGNvbXBvc2VGdW5jdGlvbnMoKSB7XG4gIHZhciBmdW5jdGlvbnMgPSBhcmd1bWVudHM7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGk7XG4gICAgZm9yIChpID0gMDsgaSA8IGZ1bmN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgZnVuY3Rpb25zW2ldLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICB9O1xufVxubW9kdWxlLmV4cG9ydHMuY29tcG9zZUZ1bmN0aW9ucyA9IGNvbXBvc2VGdW5jdGlvbnM7XG5cbnZhciBOT19XQVRDSF9UT0tFTlMgPSBbJ3x8JywgJyYmJywgJyE9JywgJyE9PScsICc9PScsICc9PT0nLCAnPicsICc8JywgJzw9JywgJz49J107XG52YXIgV0hJVEVTUEFDRV9QTFVTX1JFID0gL1xccysvO1xuZnVuY3Rpb24gcGFyc2VLZXlzVG9XYXRjaChrZXlzLCBzdHIsIGlzQmluZEl0ZW0pIHtcbiAgdmFyIGk7XG4gIHZhciB0b2tlbnM7XG4gIHRva2VucyA9IHNwbGl0KHN0ciwgV0hJVEVTUEFDRV9QTFVTX1JFKTtcbiAgZm9yIChpID0gMDsgaSA8IHRva2Vucy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChOT19XQVRDSF9UT0tFTlMuaW5kZXhPZih0b2tlbnNbaV0pID09PSAtMSAmJiAhdG9rZW5zW2ldLnN0YXJ0c1dpdGgoXCInXCIpICYmIGtleXMuaW5kZXhPZih0b2tlbnNbaV0pID09PSAtMSkge1xuICAgICAgaWYgKGlzQmluZEl0ZW0gJiYgdG9rZW5zW2ldID09PSAnaXRlbScpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBrZXlzLnB1c2gocGFyc2VLZXlUb1dhdGNoKHRva2Vuc1tpXSkpO1xuICAgIH1cbiAgfVxufVxubW9kdWxlLmV4cG9ydHMucGFyc2VLZXlzVG9XYXRjaCA9IHBhcnNlS2V5c1RvV2F0Y2g7XG5cbmZ1bmN0aW9uIHBhcnNlS2V5VG9XYXRjaChzdHIpIHtcbiAgdmFyIGRvdEluZGV4O1xuICBzdHIgPSBzdHJpcE5vdChzdHIudHJpbSgpKTtcbiAgZG90SW5kZXggPSBzdHIuaW5kZXhPZignLicpO1xuICBpZiAoZG90SW5kZXggPT09IC0xKSB7XG4gICAgcmV0dXJuIHN0cjtcbiAgfVxuICByZXR1cm4gc3RyLnN1YnN0cmluZygwLCBzdHIuaW5kZXhPZignLicpKTtcbn1cblxuZnVuY3Rpb24gc3RyaXBOb3Qoc3RyKSB7XG4gIGlmIChzdHIuaW5kZXhPZignISEnKSA9PT0gMCkge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgnISEnLCAnJyk7XG4gIH0gZWxzZSBpZiAoc3RyLmluZGV4T2YoJyEnKSA9PT0gMCkge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgnIScsICcnKTtcbiAgfVxuICByZXR1cm4gc3RyO1xufVxuXG4vKipcbiAqIENhY2hlZCBzcGxpdC5cbiAqL1xudmFyIFNQTElUX0NBQ0hFID0ge307XG5mdW5jdGlvbiBzcGxpdChzdHIsIGRlbGltaXRlcikge1xuICBpZiAoIVNQTElUX0NBQ0hFW2RlbGltaXRlcl0pIHtcbiAgICBTUExJVF9DQUNIRVtkZWxpbWl0ZXJdID0ge307XG4gIH1cbiAgaWYgKFNQTElUX0NBQ0hFW2RlbGltaXRlcl1bc3RyXSkge1xuICAgIHJldHVybiBTUExJVF9DQUNIRVtkZWxpbWl0ZXJdW3N0cl07XG4gIH1cbiAgU1BMSVRfQ0FDSEVbZGVsaW1pdGVyXVtzdHJdID0gc3RyLnNwbGl0KGRlbGltaXRlcik7XG4gIHJldHVybiBTUExJVF9DQUNIRVtkZWxpbWl0ZXJdW3N0cl07XG59XG5tb2R1bGUuZXhwb3J0cy5zcGxpdCA9IHNwbGl0O1xuXG5mdW5jdGlvbiBjb3B5QXJyYXkoZGVzdCwgc3JjKSB7XG4gIHZhciBpO1xuICBkZXN0Lmxlbmd0aCA9IDA7XG4gIGZvciAoaSA9IDA7IGkgPCBzcmMubGVuZ3RoOyBpKyspIHtcbiAgICBkZXN0W2ldID0gc3JjW2ldO1xuICB9XG59XG5tb2R1bGUuZXhwb3J0cy5jb3B5QXJyYXkgPSBjb3B5QXJyYXk7XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbl9fd2VicGFja19yZXF1aXJlX18oMik7XG52YXIgZGlmZiA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG52YXIgbGliID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbnZhciB3cmFwQXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLndyYXBBcnJheTtcblxuLy8gU2luZ2xldG9uIHN0YXRlIGRlZmluaXRpb24uXG52YXIgU3RhdGUgPSB7XG4gIGluaXRpYWxTdGF0ZToge30sXG4gIG5vbkJpbmRlZFN0YXRlS2V5czogW10sXG4gIGhhbmRsZXJzOiB7fSxcbiAgY29tcHV0ZVN0YXRlOiBmdW5jdGlvbiBjb21wdXRlU3RhdGUoKSB7Lyogbm8tb3AgKi99XG59O1xuXG52YXIgU1RBVEVfVVBEQVRFX0VWRU5UID0gJ3N0YXRldXBkYXRlJztcbnZhciBUWVBFX09CSkVDVCA9ICdvYmplY3QnO1xudmFyIFdISVRFU1BBQ0VfUkVHRVggPSAvcysvO1xuXG5BRlJBTUUucmVnaXN0ZXJTdGF0ZSA9IGZ1bmN0aW9uIChkZWZpbml0aW9uKSB7XG4gIEFGUkFNRS51dGlscy5leHRlbmQoU3RhdGUsIGRlZmluaXRpb24pO1xufTtcblxuQUZSQU1FLnJlZ2lzdGVyU3lzdGVtKCdzdGF0ZScsIHtcbiAgaW5pdDogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdmFyIGtleTtcblxuICAgIHRoaXMuYXJyYXlzID0gW107XG4gICAgdGhpcy5kaXJ0eUFycmF5cyA9IFtdO1xuICAgIHRoaXMuZGlmZiA9IHt9O1xuICAgIHRoaXMuc3RhdGUgPSBBRlJBTUUudXRpbHMuY2xvbmUoU3RhdGUuaW5pdGlhbFN0YXRlKTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcbiAgICB0aGlzLmluaXRFdmVudEhhbmRsZXJzKCk7XG5cbiAgICAvLyBXcmFwIGFycmF5IHRvIGRldGVjdCBkaXJ0eS5cbiAgICBmb3IgKGtleSBpbiB0aGlzLnN0YXRlKSB7XG4gICAgICBpZiAodGhpcy5zdGF0ZVtrZXldICYmIHRoaXMuc3RhdGVba2V5XS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHtcbiAgICAgICAgdGhpcy5hcnJheXMucHVzaChrZXkpO1xuICAgICAgICB0aGlzLnN0YXRlW2tleV0uX19kaXJ0eSA9IHRydWU7XG4gICAgICAgIHdyYXBBcnJheSh0aGlzLnN0YXRlW2tleV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMubGFzdFN0YXRlID0gQUZSQU1FLnV0aWxzLmNsb25lKHRoaXMuc3RhdGUpO1xuXG4gICAgdGhpcy5ldmVudERldGFpbCA9IHtcbiAgICAgIGxhc3RTdGF0ZTogdGhpcy5sYXN0U3RhdGUsXG4gICAgICBzdGF0ZTogdGhpcy5zdGF0ZVxuICAgIH07XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBpO1xuICAgICAgLy8gSW5pdGlhbCBjb21wdXRlLlxuICAgICAgU3RhdGUuY29tcHV0ZVN0YXRlKF90aGlzLnN0YXRlLCAnQEBJTklUJyk7XG4gICAgICAvLyBJbml0aWFsIGRpc3BhdGNoLlxuICAgICAgZm9yIChpID0gMDsgaSA8IF90aGlzLnN1YnNjcmlwdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgX3RoaXMuc3Vic2NyaXB0aW9uc1tpXS5vblN0YXRlVXBkYXRlKF90aGlzLnN0YXRlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogRGlzcGF0Y2ggYWN0aW9uLlxuICAgKi9cbiAgZGlzcGF0Y2g6IGZ1bmN0aW9uIGRpc3BhdGNoKGFjdGlvbk5hbWUsIHBheWxvYWQpIHtcbiAgICB2YXIgZGlydHlBcnJheXM7XG4gICAgdmFyIGk7XG4gICAgdmFyIGtleTtcbiAgICB2YXIgc3Vic2NyaXB0aW9uO1xuXG4gICAgLy8gTW9kaWZ5IHN0YXRlLlxuICAgIFN0YXRlLmhhbmRsZXJzW2FjdGlvbk5hbWVdKHRoaXMuc3RhdGUsIHBheWxvYWQpO1xuXG4gICAgLy8gUG9zdC1jb21wdXRlLlxuICAgIFN0YXRlLmNvbXB1dGVTdGF0ZSh0aGlzLnN0YXRlLCBhY3Rpb25OYW1lLCBwYXlsb2FkKTtcblxuICAgIC8vIEdldCBhIGRpZmYgdG8gb3B0aW1pemUgYmluZCB1cGRhdGVzLlxuICAgIGZvciAoa2V5IGluIHRoaXMuZGlmZikge1xuICAgICAgZGVsZXRlIHRoaXMuZGlmZltrZXldO1xuICAgIH1cbiAgICBkaWZmKHRoaXMubGFzdFN0YXRlLCB0aGlzLnN0YXRlLCB0aGlzLmRpZmYsIFN0YXRlLm5vbkJpbmRlZFN0YXRlS2V5cyk7XG5cbiAgICB0aGlzLmRpcnR5QXJyYXlzLmxlbmd0aCA9IDA7XG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMuYXJyYXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5zdGF0ZVt0aGlzLmFycmF5c1tpXV0uX19kaXJ0eSkge1xuICAgICAgICB0aGlzLmRpcnR5QXJyYXlzLnB1c2godGhpcy5hcnJheXNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE5vdGlmeSBzdWJzY3JpcHRpb25zIC8gYmluZGVycy5cbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5zdWJzY3JpcHRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5zdWJzY3JpcHRpb25zW2ldLm5hbWUgPT09ICdiaW5kLWZvcicpIHtcbiAgICAgICAgLy8gRm9yIGFycmF5cyBhbmQgYmluZC1mb3IsIGNoZWNrIF9fZGlydHkgZmxhZyBvbiBhcnJheSByYXRoZXIgdGhhbiB0aGUgZGlmZi5cbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlW3RoaXMuc3Vic2NyaXB0aW9uc1tpXS5rZXlzVG9XYXRjaFswXV0uX19kaXJ0eSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXRoaXMuc2hvdWxkVXBkYXRlKHRoaXMuc3Vic2NyaXB0aW9uc1tpXS5rZXlzVG9XYXRjaCwgdGhpcy5kaWZmLCB0aGlzLmRpcnR5QXJyYXlzKSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uc1tpXS5vblN0YXRlVXBkYXRlKCk7XG4gICAgfVxuXG4gICAgLy8gVW5zZXQgYXJyYXkgZGlydHkuXG4gICAgZm9yIChrZXkgaW4gdGhpcy5zdGF0ZSkge1xuICAgICAgaWYgKHRoaXMuc3RhdGVba2V5XSAmJiB0aGlzLnN0YXRlW2tleV0uY29uc3RydWN0b3IgPT09IEFycmF5KSB7XG4gICAgICAgIHRoaXMuc3RhdGVba2V5XS5fX2RpcnR5ID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU3RvcmUgbGFzdCBzdGF0ZS5cbiAgICB0aGlzLmNvcHlTdGF0ZSh0aGlzLmxhc3RTdGF0ZSwgdGhpcy5zdGF0ZSk7XG5cbiAgICAvLyBFbWl0LlxuICAgIHRoaXMuZXZlbnREZXRhaWwuYWN0aW9uID0gYWN0aW9uTmFtZTtcbiAgICB0aGlzLmV2ZW50RGV0YWlsLnBheWxvYWQgPSBwYXlsb2FkO1xuICAgIHRoaXMuZWwuZW1pdChTVEFURV9VUERBVEVfRVZFTlQsIHRoaXMuZXZlbnREZXRhaWwpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBTdG9yZSBsYXN0IHN0YXRlIHRocm91Z2ggYSBkZWVwIGV4dGVuZCwgYnV0IG5vdCBmb3IgYXJyYXlzLlxuICAgKi9cbiAgY29weVN0YXRlOiBmdW5jdGlvbiBjb3B5U3RhdGUobGFzdFN0YXRlLCBzdGF0ZSwgaXNSZWN1cnNpdmUpIHtcbiAgICB2YXIga2V5O1xuXG4gICAgZm9yIChrZXkgaW4gc3RhdGUpIHtcbiAgICAgIC8vIERvbid0IGNvcHkgcGllY2VzIG9mIHN0YXRlIGtleXMgdGhhdCBhcmUgbm9uLWJpbmRlZCBvciB1bnRyYWNrZWQuXG4gICAgICBpZiAoIWlzUmVjdXJzaXZlICYmIFN0YXRlLm5vbkJpbmRlZFN0YXRlS2V5cy5pbmRleE9mKGtleSkgIT09IC0xKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBOZXN0ZWQgc3RhdGUuXG4gICAgICBpZiAoc3RhdGVba2V5XSAmJiBzdGF0ZVtrZXldLmNvbnN0cnVjdG9yID09PSBPYmplY3QpIHtcbiAgICAgICAgaWYgKCEoa2V5IGluIGxhc3RTdGF0ZSkpIHtcbiAgICAgICAgICAvLyBDbG9uZSBvYmplY3QgaWYgZGVzdGluYXRpb24gZG9lcyBub3QgZXhpc3QuXG4gICAgICAgICAgbGFzdFN0YXRlW2tleV0gPSBBRlJBTUUudXRpbHMuY2xvbmUoc3RhdGVba2V5XSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmVjdXJzaXZlbHkgY29weSBzdGF0ZS5cbiAgICAgICAgdGhpcy5jb3B5U3RhdGUobGFzdFN0YXRlW2tleV0sIHN0YXRlW2tleV0sIHRydWUpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ29weSBieSB2YWx1ZS5cbiAgICAgIGxhc3RTdGF0ZVtrZXldID0gc3RhdGVba2V5XTtcbiAgICB9XG4gIH0sXG5cbiAgc3Vic2NyaWJlOiBmdW5jdGlvbiBzdWJzY3JpYmUoY29tcG9uZW50KSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goY29tcG9uZW50KTtcbiAgfSxcblxuICB1bnN1YnNjcmliZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoY29tcG9uZW50KSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLnNwbGljZSh0aGlzLnN1YnNjcmlwdGlvbnMuaW5kZXhPZihjb21wb25lbnQpLCAxKTtcbiAgfSxcblxuICAvKipcbiAgICogQ2hlY2sgaWYgc3RhdGUgY2hhbmdlcyB3ZXJlIHJlbGV2YW50IHRvIHRoaXMgYmluZGluZy4gSWYgbm90LCBkb24ndCBjYWxsLlxuICAgKi9cbiAgc2hvdWxkVXBkYXRlOiBmdW5jdGlvbiBzaG91bGRVcGRhdGUoa2V5c1RvV2F0Y2gsIGRpZmYsIGRpcnR5QXJyYXlzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzVG9XYXRjaC5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGtleXNUb1dhdGNoW2ldIGluIGRpZmYgfHwgZGlydHlBcnJheXMuaW5kZXhPZihrZXlzVG9XYXRjaFtpXSkgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFByb3h5IGV2ZW50cyB0byBhY3Rpb24gZGlzcGF0Y2hlcyBzbyBjb21wb25lbnRzIGNhbiBqdXN0IGJ1YmJsZSBhY3Rpb25zIHVwIGFzIGV2ZW50cy5cbiAgICogSGFuZGxlcnMgZGVmaW5lIHdoaWNoIGFjdGlvbnMgdGhleSBoYW5kbGUuIEdvIHRocm91Z2ggYWxsIGFuZCBhZGQgZXZlbnQgbGlzdGVuZXJzLlxuICAgKi9cbiAgaW5pdEV2ZW50SGFuZGxlcnM6IGZ1bmN0aW9uIGluaXRFdmVudEhhbmRsZXJzKCkge1xuICAgIHZhciBhY3Rpb25OYW1lO1xuICAgIHZhciByZWdpc3RlcmVkQWN0aW9ucyA9IFtdO1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHJlZ2lzdGVyTGlzdGVuZXIgPSByZWdpc3Rlckxpc3RlbmVyLmJpbmQodGhpcyk7XG5cbiAgICAvLyBVc2UgZGVjbGFyZWQgaGFuZGxlcnMgdG8ga25vdyB3aGF0IGV2ZW50cyB0byBsaXN0ZW4gdG8uXG4gICAgZm9yIChhY3Rpb25OYW1lIGluIFN0YXRlLmhhbmRsZXJzKSB7XG4gICAgICAvLyBPbmx5IG5lZWQgdG8gcmVnaXN0ZXIgb25lIGhhbmRsZXIgZm9yIGVhY2ggZXZlbnQuXG4gICAgICBpZiAocmVnaXN0ZXJlZEFjdGlvbnMuaW5kZXhPZihhY3Rpb25OYW1lKSAhPT0gLTEpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICByZWdpc3RlcmVkQWN0aW9ucy5wdXNoKGFjdGlvbk5hbWUpO1xuICAgICAgcmVnaXN0ZXJMaXN0ZW5lcihhY3Rpb25OYW1lKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWdpc3Rlckxpc3RlbmVyKGFjdGlvbk5hbWUpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoYWN0aW9uTmFtZSwgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICBfdGhpczIuZGlzcGF0Y2goYWN0aW9uTmFtZSwgZXZ0LmRldGFpbCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJlbmRlciB0ZW1wbGF0ZSB0byBzdHJpbmcgd2l0aCBpdGVtIGRhdGEuXG4gICAqL1xuICByZW5kZXJUZW1wbGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIC8vIEJyYWNlcywgd2hpdGVzcGFjZSwgb3B0aW9uYWwgaXRlbSBuYW1lLCBpdGVtIGtleSwgd2hpdGVzcGFjZSwgYnJhY2VzLlxuICAgIHZhciBpbnRlcnBSZWdleCA9IC97e1xccyooXFx3KlxcLik/KFtcXHcuXSspXFxzKn19L2c7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRlbXBsYXRlLCBkYXRhLCBhc1N0cmluZykge1xuICAgICAgdmFyIG1hdGNoO1xuICAgICAgdmFyIHN0cjtcblxuICAgICAgc3RyID0gdGVtcGxhdGU7XG5cbiAgICAgIC8vIERhdGEgd2lsbCBiZSBudWxsIGlmIGluaXRpYWxpemUgcG9vbCBmb3IgYmluZC1mb3IudXBkYXRlSW5QbGFjZS5cbiAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgIHdoaWxlIChtYXRjaCA9IGludGVycFJlZ2V4LmV4ZWModGVtcGxhdGUpKSB7XG4gICAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UobWF0Y2hbMF0sICh0eXBlb2YgZGF0YSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZGF0YSkpID09PSBUWVBFX09CSkVDVCA/IGxpYi5zZWxlY3QoZGF0YSwgbWF0Y2hbMl0pIHx8ICcnIDogZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gUmV0dXJuIGFzIHN0cmluZy5cbiAgICAgIGlmIChhc1N0cmluZykge1xuICAgICAgICByZXR1cm4gc3RyO1xuICAgICAgfVxuXG4gICAgICAvLyBSZXR1cm4gYXMgRE9NLlxuICAgICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZVJhbmdlKCkuY3JlYXRlQ29udGV4dHVhbEZyYWdtZW50KHN0cik7XG4gICAgfTtcbiAgfSgpLFxuXG4gIHNlbGVjdDogbGliLnNlbGVjdFxufSk7XG5cbi8qKlxuICogQmluZCBjb21wb25lbnQgcHJvcGVydHkgdG8gYSB2YWx1ZSBpbiBzdGF0ZS5cbiAqXG4gKiBiaW5kPVwiZ2VvbWV0cnkud2lkdGg6IGNhci53aWR0aFwiXCJcbiAqIGJpbmRfX21hdGVyaWFsPVwiY29sb3I6IGVuZW15LmNvbG9yOyBvcGFjaXR5OiBlbmVteS5vcGFjaXR5XCJcbiAqIGJpbmRfX3Zpc2libGU9XCJwbGF5ZXIudmlzaWJsZVwiXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmluZCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgZGVmYXVsdDoge30sXG4gICAgcGFyc2U6IGZ1bmN0aW9uIHBhcnNlKHZhbHVlKSB7XG4gICAgICAvLyBQYXJzZSBzdHlsZS1saWtlIG9iamVjdC5cbiAgICAgIHZhciBkYXRhO1xuICAgICAgdmFyIGk7XG4gICAgICB2YXIgcHJvcGVydGllcztcbiAgICAgIHZhciBwYWlyO1xuXG4gICAgICAvLyBVc2luZyBzZXRBdHRyaWJ1dGUgd2l0aCBvYmplY3QsIG5vIG5lZWQgdG8gcGFyc2UuXG4gICAgICBpZiAodmFsdWUuY29uc3RydWN0b3IgPT09IE9iamVjdCkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFVzaW5nIGluc3RhbmNlZCBJRCBhcyBjb21wb25lbnQgbmFtZXNwYWNlIGZvciBzaW5nbGUtcHJvcGVydHkgY29tcG9uZW50LFxuICAgICAgLy8gbm90aGluZyB0byBzZXBhcmF0ZS5cbiAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCc6JykgPT09IC0xKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gUGFyc2Ugc3R5bGUtbGlrZSBvYmplY3QgYXMga2V5cyB0byB2YWx1ZXMuXG4gICAgICBkYXRhID0ge307XG4gICAgICBwcm9wZXJ0aWVzID0gbGliLnNwbGl0KHZhbHVlLCAnOycpO1xuICAgICAgZm9yIChpID0gMDsgaSA8IHByb3BlcnRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcGFpciA9IGxpYi5zcGxpdChwcm9wZXJ0aWVzW2ldLnRyaW0oKSwgJzonKTtcbiAgICAgICAgZGF0YVtwYWlyWzBdXSA9IHBhaXJbMV0udHJpbSgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICB9LFxuXG4gIG11bHRpcGxlOiB0cnVlLFxuXG4gIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdmFyIGNvbXBvbmVudElkO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBrZXk7XG5cbiAgICB0aGlzLmtleXNUb1dhdGNoID0gW107XG4gICAgdGhpcy5vblN0YXRlVXBkYXRlID0gdGhpcy5vblN0YXRlVXBkYXRlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zeXN0ZW0gPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZTtcblxuICAgIC8vIFdoZXRoZXIgd2UgYXJlIGJpbmRpbmcgYnkgbmFtZXNwYWNlIChlLmcuLCBiaW5kX19mb289XCJwcm9wMTogdHJ1ZVwiKS5cbiAgICBpZiAodGhpcy5pZCkge1xuICAgICAgY29tcG9uZW50SWQgPSBsaWIuc3BsaXQodGhpcy5pZCwgJ19fJylbMF07XG4gICAgfVxuICAgIHRoaXMuaXNOYW1lc3BhY2VkQmluZCA9IHRoaXMuaWQgJiYgY29tcG9uZW50SWQgaW4gQUZSQU1FLmNvbXBvbmVudHMgJiYgIUFGUkFNRS5jb21wb25lbnRzW2NvbXBvbmVudElkXS5pc1NpbmdsZVByb3AgfHwgY29tcG9uZW50SWQgaW4gQUZSQU1FLnN5c3RlbXM7XG5cbiAgICB0aGlzLmxhc3REYXRhID0ge307XG4gICAgdGhpcy51cGRhdGVPYmogPSB7fTtcblxuICAgIC8vIFN1YnNjcmliZSB0byBzdG9yZSBhbmQgcmVnaXN0ZXIgaGFuZGxlciB0byBkbyBkYXRhLWJpbmRpbmcgdG8gY29tcG9uZW50cy5cbiAgICB0aGlzLnN5c3RlbS5zdWJzY3JpYmUodGhpcyk7XG5cbiAgICB0aGlzLm9uU3RhdGVVcGRhdGUgPSB0aGlzLm9uU3RhdGVVcGRhdGUuYmluZCh0aGlzKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIga2V5O1xuICAgIHZhciBwcm9wZXJ0eTtcblxuICAgIC8vIEluZGV4IGBrZXlzVG9XYXRjaGAgdG8gb25seSB1cGRhdGUgc3RhdGUgb24gcmVsZXZhbnQgY2hhbmdlcy5cbiAgICB0aGlzLmtleXNUb1dhdGNoLmxlbmd0aCA9IDA7XG4gICAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuICAgICAgbGliLnBhcnNlS2V5c1RvV2F0Y2godGhpcy5rZXlzVG9XYXRjaCwgZGF0YSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAoa2V5IGluIGRhdGEpIHtcbiAgICAgICAgbGliLnBhcnNlS2V5c1RvV2F0Y2godGhpcy5rZXlzVG9XYXRjaCwgZGF0YVtrZXldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLm9uU3RhdGVVcGRhdGUoKTtcbiAgfSxcblxuICAvKipcbiAgICogSGFuZGxlIHN0YXRlIHVwZGF0ZS5cbiAgICovXG4gIG9uU3RhdGVVcGRhdGU6IGZ1bmN0aW9uIG9uU3RhdGVVcGRhdGUoKSB7XG4gICAgLy8gVXBkYXRlIGNvbXBvbmVudCB3aXRoIHRoZSBzdGF0ZS5cbiAgICB2YXIgaGFzS2V5cyA9IGZhbHNlO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIHByb3BlcnR5TmFtZTtcbiAgICB2YXIgc3RhdGVTZWxlY3RvcjtcbiAgICB2YXIgc3RhdGU7XG4gICAgdmFyIHRlbXBOb2RlO1xuICAgIHZhciB2YWx1ZTtcblxuICAgIGlmICghZWwucGFyZW50Tm9kZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc05hbWVzcGFjZWRCaW5kKSB7XG4gICAgICBsaWIuY2xlYXJPYmplY3QodGhpcy51cGRhdGVPYmopO1xuICAgIH1cblxuICAgIHN0YXRlID0gdGhpcy5zeXN0ZW0uc3RhdGU7XG5cbiAgICAvLyBTaW5nbGUtcHJvcGVydHkgYmluZC5cbiAgICBpZiAoX3R5cGVvZih0aGlzLmRhdGEpICE9PSBUWVBFX09CSkVDVCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFsdWUgPSBsaWIuc2VsZWN0KHN0YXRlLCB0aGlzLmRhdGEpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1thZnJhbWUtc3RhdGUtY29tcG9uZW50XSBLZXkgXFwnJyArIHRoaXMuZGF0YSArICdcXCcgbm90IGZvdW5kIGluIHN0YXRlLicgKyAoJyAjJyArIHRoaXMuZWwuZ2V0QXR0cmlidXRlKCdpZCcpICsgJ1snICsgdGhpcy5hdHRyTmFtZSArICddJykpO1xuICAgICAgfVxuXG4gICAgICBpZiAoKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodmFsdWUpKSAhPT0gVFlQRV9PQkpFQ1QgJiYgX3R5cGVvZih0aGlzLmxhc3REYXRhKSAhPT0gVFlQRV9PQkpFQ1QgJiYgdGhpcy5sYXN0RGF0YSA9PT0gdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBBRlJBTUUudXRpbHMuZW50aXR5LnNldENvbXBvbmVudFByb3BlcnR5KGVsLCB0aGlzLmlkLCB2YWx1ZSk7XG4gICAgICB0aGlzLmxhc3REYXRhID0gdmFsdWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZm9yIChwcm9wZXJ0eU5hbWUgaW4gdGhpcy5kYXRhKSB7XG4gICAgICAvLyBQb2ludGVyIHRvIGEgdmFsdWUgaW4gdGhlIHN0YXRlIChlLmcuLCBgcGxheWVyLmhlYWx0aGApLlxuICAgICAgc3RhdGVTZWxlY3RvciA9IHRoaXMuZGF0YVtwcm9wZXJ0eU5hbWVdLnRyaW0oKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhbHVlID0gbGliLnNlbGVjdChzdGF0ZSwgc3RhdGVTZWxlY3Rvcik7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1thZnJhbWUtc3RhdGUtY29tcG9uZW50XSBLZXkgXFwnJyArIHN0YXRlU2VsZWN0b3IgKyAnXFwnIG5vdCBmb3VuZCBpbiBzdGF0ZS4nICsgKCcgIycgKyB0aGlzLmVsLmdldEF0dHJpYnV0ZSgnaWQnKSArICdbJyArIHRoaXMuYXR0ck5hbWUgKyAnXScpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCh0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHZhbHVlKSkgIT09IFRZUEVfT0JKRUNUICYmIF90eXBlb2YodGhpcy5sYXN0RGF0YVtwcm9wZXJ0eU5hbWVdKSAhPT0gVFlQRV9PQkpFQ1QgJiYgdGhpcy5sYXN0RGF0YVtwcm9wZXJ0eU5hbWVdID09PSB2YWx1ZSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gUmVtb3ZlIGNvbXBvbmVudCBpZiB2YWx1ZSBpcyBgdW5kZWZpbmVkYC5cbiAgICAgIGlmIChwcm9wZXJ0eU5hbWUgaW4gQUZSQU1FLmNvbXBvbmVudHMgJiYgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUocHJvcGVydHlOYW1lKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXQgdXNpbmcgZG90LWRlbGltaXRlZCBwcm9wZXJ0eSBuYW1lLlxuICAgICAgaWYgKHRoaXMuaXNOYW1lc3BhY2VkQmluZCkge1xuICAgICAgICAvLyBCYXRjaCBpZiBkb2luZyBuYW1lc3BhY2VkIGJpbmQuXG4gICAgICAgIHRoaXMudXBkYXRlT2JqW3Byb3BlcnR5TmFtZV0gPSB2YWx1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIEFGUkFNRS51dGlscy5lbnRpdHkuc2V0Q29tcG9uZW50UHJvcGVydHkoZWwsIHByb3BlcnR5TmFtZSwgdmFsdWUpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmxhc3REYXRhW3Byb3BlcnR5TmFtZV0gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvLyBCYXRjaCBpZiBkb2luZyBuYW1lc3BhY2VkIGJpbmQuXG4gICAgZm9yIChoYXNLZXlzIGluIHRoaXMudXBkYXRlT2JqKSB7XG4gICAgICAvLyBTZWUgaWYgb2JqZWN0IGlzIGVtcHR5LlxuICAgIH1cbiAgICBpZiAodGhpcy5pc05hbWVzcGFjZWRCaW5kICYmIGhhc0tleXMpIHtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSh0aGlzLmlkLCB0aGlzLnVwZGF0ZU9iaik7XG4gICAgfVxuICB9LFxuXG4gIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgIHRoaXMuc3lzdGVtLnVuc3Vic2NyaWJlKHRoaXMpO1xuICB9XG59KTtcblxuLyoqXG4gKiBUb2dnbGUgY29tcG9uZW50IGF0dGFjaCBhbmQgZGV0YWNoIGJhc2VkIG9uIGJvb2xlYW4gdmFsdWUuXG4gKlxuICogYmluZC10b2dnbGVfX3JheWNhc3RhYmxlPVwiaXNSYXljYXN0YWJsZVwiXCJcbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdiaW5kLXRvZ2dsZScsIHtcbiAgc2NoZW1hOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB0aGlzLnN5c3RlbSA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlO1xuICAgIHRoaXMua2V5c1RvV2F0Y2ggPSBbXTtcbiAgICB0aGlzLm9uU3RhdGVVcGRhdGUgPSB0aGlzLm9uU3RhdGVVcGRhdGUuYmluZCh0aGlzKTtcblxuICAgIC8vIFN1YnNjcmliZSB0byBzdG9yZSBhbmQgcmVnaXN0ZXIgaGFuZGxlciB0byBkbyBkYXRhLWJpbmRpbmcgdG8gY29tcG9uZW50cy5cbiAgICB0aGlzLnN5c3RlbS5zdWJzY3JpYmUodGhpcyk7XG5cbiAgICB0aGlzLm9uU3RhdGVVcGRhdGUoKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICB0aGlzLmtleXNUb1dhdGNoLmxlbmd0aCA9IDA7XG4gICAgbGliLnBhcnNlS2V5c1RvV2F0Y2godGhpcy5rZXlzVG9XYXRjaCwgdGhpcy5kYXRhKTtcbiAgfSxcblxuICAvKipcbiAgICogSGFuZGxlIHN0YXRlIHVwZGF0ZS5cbiAgICovXG4gIG9uU3RhdGVVcGRhdGU6IGZ1bmN0aW9uIG9uU3RhdGVVcGRhdGUoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgc3RhdGU7XG4gICAgdmFyIHZhbHVlO1xuXG4gICAgc3RhdGUgPSB0aGlzLnN5c3RlbS5zdGF0ZTtcblxuICAgIHRyeSB7XG4gICAgICB2YWx1ZSA9IGxpYi5zZWxlY3Qoc3RhdGUsIHRoaXMuZGF0YSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbYWZyYW1lLXN0YXRlLWNvbXBvbmVudF0gS2V5IFxcJycgKyB0aGlzLmRhdGEgKyAnXFwnIG5vdCBmb3VuZCBpbiBzdGF0ZS4nICsgKCcgIycgKyB0aGlzLmVsLmdldEF0dHJpYnV0ZSgnaWQnKSArICdbJyArIHRoaXMuYXR0ck5hbWUgKyAnXScpKTtcbiAgICB9XG5cbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSh0aGlzLmlkLCAnJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmlkKTtcbiAgICB9XG4gIH0sXG5cbiAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgdGhpcy5zeXN0ZW0udW5zdWJzY3JpYmUodGhpcyk7XG4gIH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY29tcG9zZUZ1bmN0aW9uczogbGliLmNvbXBvc2VGdW5jdGlvbnMsXG4gIGNvbXBvc2VIYW5kbGVyczogbGliLmNvbXBvc2VIYW5kbGVycyxcbiAgc2VsZWN0OiBsaWIuc2VsZWN0XG59O1xuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGxpYiA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cbnZhciBJVEVNX1JFID0gL2l0ZW0vO1xudmFyIElURU1fUFJFRklYX1JFID0gL2l0ZW0uLztcbnZhciBJVEVNX1NFTEVDVE9SX1JFID0gL2l0ZW0uKFxcdyspLztcblxuLyoqXG4gKiBSZW5kZXIgYXJyYXkgZnJvbSBzdGF0ZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdiaW5kLWZvcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgZGVsYXk6IHsgZGVmYXVsdDogMCB9LFxuICAgIGZvcjogeyB0eXBlOiAnc3RyaW5nJywgZGVmYXVsdDogJ2l0ZW0nIH0sXG4gICAgaW46IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICBrZXk6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICBwb29sOiB7IGRlZmF1bHQ6IDAgfSxcbiAgICB0ZW1wbGF0ZTogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgIHVwZGF0ZUluUGxhY2U6IHsgZGVmYXVsdDogZmFsc2UgfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgLy8gU3Vic2NyaWJlIHRvIHN0b3JlIGFuZCByZWdpc3RlciBoYW5kbGVyIHRvIGRvIGRhdGEtYmluZGluZyB0byBjb21wb25lbnRzLlxuICAgIHRoaXMuc3lzdGVtID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMuc3RhdGU7XG4gICAgdGhpcy5vblN0YXRlVXBkYXRlID0gdGhpcy5vblN0YXRlVXBkYXRlLmJpbmQodGhpcyk7XG5cbiAgICB0aGlzLmtleXNUb1dhdGNoID0gW107XG4gICAgdGhpcy5yZW5kZXJlZEtleXMgPSBbXTsgLy8gS2V5cyB0aGF0IGFyZSBjdXJyZW50bHkgcmVuZGVyZWQuXG4gICAgdGhpcy5zeXN0ZW0uc3Vic2NyaWJlKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMuZWwuY2hpbGRyZW5bMF0gJiYgdGhpcy5lbC5jaGlsZHJlblswXS50YWdOYW1lID09PSAnVEVNUExBVEUnKSB7XG4gICAgICB0aGlzLnRlbXBsYXRlID0gdGhpcy5lbC5jaGlsZHJlblswXS5pbm5lckhUTUwudHJpbSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLmRhdGEudGVtcGxhdGUpLmlubmVySFRNTC50cmltKCk7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmRhdGEucG9vbDsgaSsrKSB7XG4gICAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMuZ2VuZXJhdGVGcm9tVGVtcGxhdGUobnVsbCwgaSkpO1xuICAgIH1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICB0aGlzLmtleXNUb1dhdGNoWzBdID0gbGliLnNwbGl0KHRoaXMuZGF0YS5pbiwgJy4nKVswXTtcbiAgICB0aGlzLm9uU3RhdGVVcGRhdGUoKTtcbiAgfSxcblxuICAvKipcbiAgICogV2hlbiBpdGVtcyBhcmUgc3dhcHBlZCBvdXQsIHRoZSBvbGQgb25lcyBhcmUgcmVtb3ZlZCwgYW5kIG5ldyBvbmVzIGFyZSBhZGRlZC4gQWxsXG4gICAqIGVudGl0aWVzIHdpbGwgYmUgcmVpbml0aWFsaXplZC5cbiAgICovXG4gIG9uU3RhdGVVcGRhdGVOYWl2ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBhY3RpdmVLZXlzID0gW107XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGNoaWxkO1xuICAgICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgICAgdmFyIGxpc3Q7XG4gICAgICB2YXIga2V5O1xuICAgICAgdmFyIGtleVZhbHVlO1xuXG4gICAgICB0cnkge1xuICAgICAgICBsaXN0ID0gbGliLnNlbGVjdCh0aGlzLnN5c3RlbS5zdGF0ZSwgZGF0YS5pbik7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW2FmcmFtZS1zdGF0ZS1jb21wb25lbnRdIEtleSBcXCcnICsgZGF0YS5pbiArICdcXCcgbm90IGZvdW5kIGluIHN0YXRlLicgKyAoJyAjJyArIGVsLmdldEF0dHJpYnV0ZSgnaWQnKSArICdbJyArIHRoaXMuYXR0ck5hbWUgKyAnXScpKTtcbiAgICAgIH1cblxuICAgICAgYWN0aXZlS2V5cy5sZW5ndGggPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBpdGVtID0gbGlzdFtpXTtcbiAgICAgICAgLy8gSWYga2V5IG5vdCBkZWZpbmVkLCB1c2UgaW5kZXggKGUuZy4sIGFycmF5IG9mIHN0cmluZ3MpLlxuICAgICAgICBhY3RpdmVLZXlzLnB1c2goZGF0YS5rZXkgPyBpdGVtW2RhdGEua2V5XS50b1N0cmluZygpIDogaXRlbS50b1N0cmluZygpKTtcbiAgICAgIH1cblxuICAgICAgLy8gUmVtb3ZlIGl0ZW1zIGJ5IHJlbW92aW5nIGVudGl0aWVzLlxuICAgICAgdmFyIHRvUmVtb3ZlRWxzID0gdGhpcy5nZXRFbHNUb1JlbW92ZShhY3RpdmVLZXlzLCB0aGlzLnJlbmRlcmVkS2V5cyk7XG4gICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgdG9SZW1vdmVFbHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvUmVtb3ZlRWxzW19pXSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChsaXN0Lmxlbmd0aCkge1xuICAgICAgICB0aGlzLnJlbmRlckl0ZW1zKGxpc3QsIGFjdGl2ZUtleXMsIDApO1xuICAgICAgfVxuICAgIH07XG4gIH0oKSxcblxuICAvKipcbiAgICogQWRkIG9yIHVwZGF0ZSBpdGVtIHdpdGggZGVsYXkgc3VwcG9ydC5cbiAgICovXG4gIHJlbmRlckl0ZW1zOiBmdW5jdGlvbiByZW5kZXJJdGVtcyhsaXN0LCBhY3RpdmVLZXlzLCBpKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGl0ZW1FbDtcbiAgICB2YXIgaXRlbSA9IGxpc3RbaV07XG5cbiAgICAvLyBJZiBrZXkgbm90IGRlZmluZWQsIHVzZSBpbmRleCAoZS5nLiwgYXJyYXkgb2Ygc3RyaW5ncykuXG4gICAgdmFyIGtleVZhbHVlID0gZGF0YS5rZXkgPyBpdGVtW2RhdGEua2V5XS50b1N0cmluZygpIDogaXRlbS50b1N0cmluZygpO1xuXG4gICAgaWYgKHRoaXMucmVuZGVyZWRLZXlzLmluZGV4T2Yoa2V5VmFsdWUpID09PSAtMSkge1xuICAgICAgLy8gQWRkLlxuICAgICAgaXRlbUVsID0gdGhpcy5nZW5lcmF0ZUZyb21UZW1wbGF0ZShpdGVtLCBpKTtcbiAgICAgIGVsLmFwcGVuZENoaWxkKGl0ZW1FbCk7XG4gICAgICB0aGlzLnJlbmRlcmVkS2V5cy5wdXNoKGtleVZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVXBkYXRlLlxuICAgICAgaWYgKGxpc3QubGVuZ3RoICYmIGxpc3RbMF0uY29uc3RydWN0b3IgPT09IFN0cmluZykge1xuICAgICAgICAvLyBVcGRhdGUgaW5kZXggZm9yIHNpbXBsZSBsaXN0LlxuICAgICAgICB2YXIgX2tleVZhbHVlID0gZGF0YS5rZXkgPyBpdGVtW2RhdGEua2V5XS50b1N0cmluZygpIDogaXRlbS50b1N0cmluZygpO1xuICAgICAgICBpdGVtRWwgPSBlbC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1iaW5kLWZvci12YWx1ZT1cIicgKyBfa2V5VmFsdWUgKyAnXCJdJyk7XG4gICAgICAgIGl0ZW1FbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3Ita2V5JywgaSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgYmluZEZvcktleSA9IHRoaXMuZ2V0QmluZEZvcktleShpdGVtLCBpKTtcbiAgICAgICAgaXRlbUVsID0gZWwucXVlcnlTZWxlY3RvcignW2RhdGEtYmluZC1mb3Ita2V5PVwiJyArIGJpbmRGb3JLZXkgKyAnXCJdJyk7XG4gICAgICB9XG4gICAgICBpdGVtRWwuZW1pdCgnYmluZGZvcnVwZGF0ZScsIGl0ZW0sIGZhbHNlKTtcbiAgICB9XG5cbiAgICBpZiAoIWxpc3RbaSArIDFdKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS5kZWxheSkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzLnJlbmRlckl0ZW1zKGxpc3QsIGFjdGl2ZUtleXMsIGkgKyAxKTtcbiAgICAgIH0sIHRoaXMuZGF0YS5kZWxheSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVuZGVySXRlbXMobGlzdCwgYWN0aXZlS2V5cywgaSArIDEpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogV2hlbiBpdGVtcyBhcmUgc3dhcHBlZCBvdXQsIHRoaXMgYWxnb3JpdGhtIHdpbGwgdXBkYXRlIGNvbXBvbmVudCB2YWx1ZXMgaW4tcGxhY2UgdXNpbmdcbiAgICogYmluZC1pdGVtLlxuICAgKi9cbiAgb25TdGF0ZVVwZGF0ZUluUGxhY2U6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYWN0aXZlS2V5cyA9IFtdO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICAgIHZhciBsaXN0O1xuICAgICAgdmFyIGtleTtcbiAgICAgIHZhciBrZXlWYWx1ZTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgbGlzdCA9IGxpYi5zZWxlY3QodGhpcy5zeXN0ZW0uc3RhdGUsIGRhdGEuaW4pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbYWZyYW1lLXN0YXRlLWNvbXBvbmVudF0gS2V5IFxcJycgKyBkYXRhLmluICsgJ1xcJyBub3QgZm91bmQgaW4gc3RhdGUuJyArICgnICMnICsgZWwuZ2V0QXR0cmlidXRlKCdpZCcpICsgJ1snICsgdGhpcy5hdHRyTmFtZSArICddJykpO1xuICAgICAgfVxuXG4gICAgICAvLyBDYWxjdWxhdGUga2V5cyB0aGF0IHNob3VsZCBiZSBhY3RpdmUuXG4gICAgICBhY3RpdmVLZXlzLmxlbmd0aCA9IDA7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGl0ZW0gPSBsaXN0W2ldO1xuICAgICAgICBrZXlWYWx1ZSA9IGRhdGEua2V5ID8gaXRlbVtkYXRhLmtleV0udG9TdHJpbmcoKSA6IGl0ZW0udG9TdHJpbmcoKTtcbiAgICAgICAgYWN0aXZlS2V5cy5wdXNoKGtleVZhbHVlKTtcbiAgICAgIH1cblxuICAgICAgLy8gUmVtb3ZlIGl0ZW1zIGJ5IHBvb2xpbmcuIERvIGJlZm9yZSBhZGRpbmcuXG4gICAgICB2YXIgdG9SZW1vdmVFbHMgPSB0aGlzLmdldEVsc1RvUmVtb3ZlKGFjdGl2ZUtleXMsIHRoaXMucmVuZGVyZWRLZXlzKTtcbiAgICAgIGZvciAodmFyIF9pMiA9IDA7IF9pMiA8IHRvUmVtb3ZlRWxzLmxlbmd0aDsgX2kyKyspIHtcbiAgICAgICAgdG9SZW1vdmVFbHNbX2kyXS5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pMl0uc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWFjdGl2ZScsICdmYWxzZScpO1xuICAgICAgICB0b1JlbW92ZUVsc1tfaTJdLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1rZXknKTtcbiAgICAgICAgdG9SZW1vdmVFbHNbX2kyXS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3ItdmFsdWUnKTtcbiAgICAgICAgdG9SZW1vdmVFbHNbX2kyXS5lbWl0KCdiaW5kZm9yZGVhY3RpdmF0ZScsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgdG9SZW1vdmVFbHNbX2kyXS5wYXVzZSgpO1xuICAgICAgfVxuXG4gICAgICBpZiAobGlzdC5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJJdGVtc0luUGxhY2UobGlzdCwgYWN0aXZlS2V5cywgMCk7XG4gICAgICB9XG4gICAgfTtcbiAgfSgpLFxuXG4gIC8qKlxuICAgKiBBZGQsIHRha2VvdmVyLCBvciB1cGRhdGUgaXRlbSB3aXRoIGRlbGF5IHN1cHBvcnQuXG4gICAqL1xuICByZW5kZXJJdGVtc0luUGxhY2U6IGZ1bmN0aW9uIHJlbmRlckl0ZW1zSW5QbGFjZShsaXN0LCBhY3RpdmVLZXlzLCBpKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBpdGVtRWw7XG5cbiAgICB2YXIgaXRlbSA9IGxpc3RbaV07XG4gICAgdmFyIGJpbmRGb3JLZXkgPSB0aGlzLmdldEJpbmRGb3JLZXkoaXRlbSwgaSk7XG4gICAgdmFyIGtleVZhbHVlID0gZGF0YS5rZXkgPyBpdGVtW2RhdGEua2V5XS50b1N0cmluZygpIDogaXRlbS50b1N0cmluZygpO1xuXG4gICAgLy8gQWRkIGl0ZW0uXG4gICAgaWYgKHRoaXMucmVuZGVyZWRLZXlzLmluZGV4T2Yoa2V5VmFsdWUpID09PSAtMSkge1xuICAgICAgaWYgKCFlbC5xdWVyeVNlbGVjdG9yKCc6c2NvcGUgPiBbZGF0YS1iaW5kLWZvci1hY3RpdmU9XCJmYWxzZVwiXScpKSB7XG4gICAgICAgIC8vIE5vIGl0ZW1zIGF2YWlsYWJsZSBpbiBwb29sLiBHZW5lcmF0ZSBuZXcgZW50aXR5LlxuICAgICAgICB2YXIgX2l0ZW1FbCA9IHRoaXMuZ2VuZXJhdGVGcm9tVGVtcGxhdGUoaXRlbSwgaSk7XG4gICAgICAgIF9pdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF9pdGVtRWwuZW1pdCgnYmluZGZvcnVwZGF0ZWlucGxhY2UnLCBpdGVtLCBmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBlbC5hcHBlbmRDaGlsZChfaXRlbUVsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRha2Ugb3ZlciBpbmFjdGl2ZSBpdGVtLlxuICAgICAgICBpdGVtRWwgPSBlbC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1iaW5kLWZvci1hY3RpdmU9XCJmYWxzZVwiXScpO1xuICAgICAgICBpdGVtRWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWtleScsIGJpbmRGb3JLZXkpO1xuICAgICAgICBpdGVtRWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLXZhbHVlJywga2V5VmFsdWUpO1xuICAgICAgICBpdGVtRWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgICAgIGl0ZW1FbC5wbGF5KCk7XG4gICAgICAgIGl0ZW1FbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3ItYWN0aXZlJywgJ3RydWUnKTtcbiAgICAgICAgaXRlbUVsLmVtaXQoJ2JpbmRmb3J1cGRhdGVpbnBsYWNlJywgaXRlbSwgZmFsc2UpO1xuICAgICAgfVxuICAgICAgdGhpcy5yZW5kZXJlZEtleXMucHVzaChrZXlWYWx1ZSk7XG4gICAgfSBlbHNlIGlmIChhY3RpdmVLZXlzLmluZGV4T2Yoa2V5VmFsdWUpICE9PSAtMSkge1xuICAgICAgLy8gVXBkYXRlIGl0ZW0uXG4gICAgICBpZiAobGlzdC5sZW5ndGggJiYgbGlzdFswXS5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7XG4gICAgICAgIC8vIFVwZGF0ZSBpbmRleCBmb3Igc2ltcGxlIGxpc3QuXG4gICAgICAgIGl0ZW1FbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJpbmQtZm9yLXZhbHVlPVwiJyArIGtleVZhbHVlICsgJ1wiXScpO1xuICAgICAgICBpdGVtRWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWtleScsIGkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaXRlbUVsID0gZWwucXVlcnlTZWxlY3RvcignW2RhdGEtYmluZC1mb3Ita2V5PVwiJyArIGJpbmRGb3JLZXkgKyAnXCJdJyk7XG4gICAgICB9XG4gICAgICBpdGVtRWwuZW1pdCgnYmluZGZvcnVwZGF0ZWlucGxhY2UnLCBpdGVtLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgaWYgKCFsaXN0W2kgKyAxXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEuZGVsYXkpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczIucmVuZGVySXRlbXNJblBsYWNlKGxpc3QsIGFjdGl2ZUtleXMsIGkgKyAxKTtcbiAgICAgIH0sIHRoaXMuZGF0YS5kZWxheSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVuZGVySXRlbXNJblBsYWNlKGxpc3QsIGFjdGl2ZUtleXMsIGkgKyAxKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGVudGl0eSBmcm9tIHRlbXBsYXRlLlxuICAgKi9cbiAgZ2VuZXJhdGVGcm9tVGVtcGxhdGU6IGZ1bmN0aW9uIGdlbmVyYXRlRnJvbVRlbXBsYXRlKGl0ZW0sIGkpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy5zeXN0ZW0ucmVuZGVyVGVtcGxhdGUodGhpcy50ZW1wbGF0ZSwgaXRlbSkpO1xuICAgIHZhciBuZXdFbCA9IHRoaXMuZWwuY2hpbGRyZW5bdGhpcy5lbC5jaGlsZHJlbi5sZW5ndGggLSAxXTs7XG5cbiAgICAvLyBGcm9tIHBvb2wudHJ1ZVxuICAgIGlmICghaXRlbSkge1xuICAgICAgbmV3RWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWtleScsICcnKTtcbiAgICAgIG5ld0VsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1hY3RpdmUnLCAnZmFsc2UnKTtcbiAgICAgIHJldHVybiBuZXdFbDtcbiAgICB9XG5cbiAgICB2YXIgYmluZEZvcktleSA9IHRoaXMuZ2V0QmluZEZvcktleShpdGVtLCBpKTtcbiAgICBuZXdFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3Ita2V5JywgYmluZEZvcktleSk7XG4gICAgaWYgKCFkYXRhLmtleSkge1xuICAgICAgbmV3RWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLXZhbHVlJywgaXRlbSk7XG4gICAgfVxuXG4gICAgLy8gS2VlcCB0cmFjayBvZiBwb29sZWQgYW5kIG5vbi1wb29sZWQgZW50aXRpZXMgaWYgdXBkYXRpbmcgaW4gcGxhY2UuXG4gICAgbmV3RWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWFjdGl2ZScsICd0cnVlJyk7XG4gICAgcmV0dXJuIG5ld0VsO1xuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgZW50aXRpZXMgbWFya2VkIGZvciByZW1vdmFsLlxuICAgKlxuICAgKiBAcGFyYW0ge2FycmF5fSBhY3RpdmVLZXlzIC0gTGlzdCBvZiBrZXkgdmFsdWVzIHRoYXQgc2hvdWxkIGJlIGFjdGl2ZS5cbiAgICogQHBhcmFtIHthcnJheX0gcmVuZGVyZWRLZXlzIC0gTGlzdCBvZiBrZXkgdmFsdWVzIGN1cnJlbnRseSByZW5kZXJlZC5cbiAgICovXG4gIGdldEVsc1RvUmVtb3ZlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRvUmVtb3ZlID0gW107XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKGFjdGl2ZUtleXMsIHJlbmRlcmVkS2V5cykge1xuICAgICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgICB2YXIgZWwgPSB0aGlzLmVsO1xuXG4gICAgICB0b1JlbW92ZS5sZW5ndGggPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbC5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoZWwuY2hpbGRyZW5baV0udGFnTmFtZSA9PT0gJ1RFTVBMQVRFJykge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBrZXkgPSBkYXRhLmtleSA/IGVsLmNoaWxkcmVuW2ldLmdldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1rZXknKSA6IGVsLmNoaWxkcmVuW2ldLmdldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci12YWx1ZScpO1xuICAgICAgICBpZiAoYWN0aXZlS2V5cy5pbmRleE9mKGtleSkgPT09IC0xICYmIHJlbmRlcmVkS2V5cy5pbmRleE9mKGtleSkgIT09IC0xKSB7XG4gICAgICAgICAgdG9SZW1vdmUucHVzaChlbC5jaGlsZHJlbltpXSk7XG4gICAgICAgICAgcmVuZGVyZWRLZXlzLnNwbGljZShyZW5kZXJlZEtleXMuaW5kZXhPZihrZXkpLCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRvUmVtb3ZlO1xuICAgIH07XG4gIH0oKSxcblxuICAvKipcbiAgICogR2V0IHZhbHVlIHRvIHVzZSBhcyB0aGUgZGF0YS1iaW5kLWZvci1rZXkuXG4gICAqIEZvciBpdGVtcywgd2lsbCBiZSB2YWx1ZSBzcGVjaWZpZWQgYnkgYGJpbmQtZm9yLmtleWAuXG4gICAqIEZvciBzaW1wbGUgbGlzdCwgd2lsbCBiZSB0aGUgaW5kZXguXG4gICAqL1xuICBnZXRCaW5kRm9yS2V5OiBmdW5jdGlvbiBnZXRCaW5kRm9yS2V5KGl0ZW0sIGkpIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLmtleSA/IGl0ZW1bdGhpcy5kYXRhLmtleV0udG9TdHJpbmcoKSA6IGkudG9TdHJpbmcoKTtcbiAgfSxcblxuICAvKipcbiAgICogSGFuZGxlIHN0YXRlIHVwZGF0ZS5cbiAgICovXG4gIG9uU3RhdGVVcGRhdGU6IGZ1bmN0aW9uIG9uU3RhdGVVcGRhdGUoKSB7XG4gICAgaWYgKHRoaXMuZGF0YS51cGRhdGVJblBsYWNlKSB7XG4gICAgICB0aGlzLm9uU3RhdGVVcGRhdGVJblBsYWNlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub25TdGF0ZVVwZGF0ZU5haXZlKCk7XG4gICAgfVxuICB9XG59KTtcblxuLyoqXG4gKiBIYW5kbGUgcGFyc2luZyBhbmQgdXBkYXRlIGluLXBsYWNlIHVwZGF0ZXMgdW5kZXIgYmluZC1mb3IuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmluZC1pdGVtJywge1xuICBzY2hlbWE6IHtcbiAgICB0eXBlOiAnc3RyaW5nJ1xuICB9LFxuXG4gIG11bHRpcGxlOiB0cnVlLFxuXG4gIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdGhpcy5pdGVtRGF0YSA9IG51bGw7XG4gICAgdGhpcy5rZXlzVG9XYXRjaCA9IFtdO1xuICAgIHRoaXMucHJldlZhbHVlcyA9IHt9O1xuXG4gICAgLy8gTGlzdGVuIHRvIHJvb3QgaXRlbSBmb3IgZXZlbnRzLlxuICAgIHZhciByb290RWwgPSB0aGlzLnJvb3RFbCA9IHRoaXMuZWwuY2xvc2VzdCgnW2RhdGEtYmluZC1mb3Ita2V5XScpO1xuICAgIGlmICghcm9vdEVsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2JpbmQtaXRlbSBjb21wb25lbnQgbXVzdCBiZSBhdHRhY2hlZCB0byBlbnRpdHkgdW5kZXIgYSBiaW5kLWZvciBpdGVtLicpO1xuICAgIH1cbiAgICByb290RWwuYWRkRXZlbnRMaXN0ZW5lcignYmluZGZvcnVwZGF0ZWlucGxhY2UnLCB0aGlzLnVwZGF0ZUluUGxhY2UuYmluZCh0aGlzKSk7XG4gICAgcm9vdEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2JpbmRmb3JkZWFjdGl2YXRlJywgdGhpcy5kZWFjdGl2YXRlLmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMuc3RhdGUuc3Vic2NyaWJlKHRoaXMpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKCkge1xuICAgIHRoaXMucGFyc2VTZWxlY3RvcigpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSdW4gd2l0aCBiaW5kLWZvciB0ZWxscyB0byB2aWEgZXZlbnQgYGJpbmRmb3J1cGRhdGVpbnBsYWNlYCwgcGFzc2luZyBpdGVtIGRhdGEuXG4gICAqL1xuICB1cGRhdGVJblBsYWNlOiBmdW5jdGlvbiB1cGRhdGVJblBsYWNlKGV2dCkge1xuICAgIHZhciBwcm9wZXJ0eU1hcCA9IHRoaXMucHJvcGVydHlNYXA7XG5cbiAgICBpZiAodGhpcy5yb290RWwuZ2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWFjdGl2ZScpID09PSAnZmFsc2UnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGV2dCkge1xuICAgICAgdGhpcy5pdGVtRGF0YSA9IGV2dC5kZXRhaWw7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgcHJvcGVydHkgaW4gcHJvcGVydHlNYXApIHtcbiAgICAgIC8vIEdldCB2YWx1ZSBmcm9tIGl0ZW0uXG4gICAgICB2YXIgdmFsdWUgPSB0aGlzLnNlbGVjdCh0aGlzLml0ZW1EYXRhLCBwcm9wZXJ0eU1hcFtwcm9wZXJ0eV0pO1xuXG4gICAgICAvLyBEaWZmIGFnYWluc3QgcHJldmlvdXMgdmFsdWUuXG4gICAgICBpZiAodmFsdWUgPT09IHRoaXMucHJldlZhbHVlc1twcm9wZXJ0eV0pIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFVwZGF0ZS5cbiAgICAgIEFGUkFNRS51dGlscy5lbnRpdHkuc2V0Q29tcG9uZW50UHJvcGVydHkodGhpcy5lbCwgcHJvcGVydHksIHZhbHVlKTtcblxuICAgICAgdGhpcy5wcmV2VmFsdWVzW3Byb3BlcnR5XSA9IHZhbHVlO1xuICAgIH1cbiAgfSxcblxuICBvblN0YXRlVXBkYXRlOiBmdW5jdGlvbiBvblN0YXRlVXBkYXRlKCkge1xuICAgIHRoaXMudXBkYXRlSW5QbGFjZSgpO1xuICB9LFxuXG4gIHNlbGVjdDogZnVuY3Rpb24gc2VsZWN0KGl0ZW1EYXRhLCBzZWxlY3Rvcikge1xuICAgIHJldHVybiBsaWIuc2VsZWN0KHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlLnN0YXRlLCBzZWxlY3RvciwgaXRlbURhdGEpO1xuICB9LFxuXG4gIGRlYWN0aXZhdGU6IGZ1bmN0aW9uIGRlYWN0aXZhdGUoKSB7XG4gICAgdGhpcy5wcmV2VmFsdWVzID0ge307XG4gIH0sXG5cbiAgcGFyc2VTZWxlY3RvcjogZnVuY3Rpb24gcGFyc2VTZWxlY3RvcigpIHtcbiAgICB2YXIgcHJvcGVydHlNYXAgPSB0aGlzLnByb3BlcnR5TWFwID0ge307XG4gICAgdGhpcy5rZXlzVG9XYXRjaC5sZW5ndGggPSAwO1xuXG4gICAgdmFyIGNvbXBvbmVudE5hbWUgPSBsaWIuc3BsaXQodGhpcy5pZCwgJ19fJylbMF07XG5cbiAgICAvLyBEaWZmZXJlbnQgcGFyc2luZyBmb3IgbXVsdGktcHJvcCBjb21wb25lbnRzLlxuICAgIGlmIChjb21wb25lbnROYW1lIGluIEFGUkFNRS5jb21wb25lbnRzICYmICFBRlJBTUUuY29tcG9uZW50c1tjb21wb25lbnROYW1lXS5pc1NpbmdsZVByb3ApIHtcbiAgICAgIHZhciBwcm9wZXJ0eVNwbGl0TGlzdCA9IGxpYi5zcGxpdCh0aGlzLmRhdGEsICc7Jyk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BlcnR5U3BsaXRMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0eVNwbGl0ID0gbGliLnNwbGl0KHByb3BlcnR5U3BsaXRMaXN0W2ldLCAnOicpO1xuICAgICAgICBwcm9wZXJ0eU1hcFt0aGlzLmlkICsgJy4nICsgcHJvcGVydHlTcGxpdFswXS50cmltKCldID0gcHJvcGVydHlTcGxpdFsxXS50cmltKCk7XG4gICAgICAgIGxpYi5wYXJzZUtleXNUb1dhdGNoKHRoaXMua2V5c1RvV2F0Y2gsIHByb3BlcnR5U3BsaXRbMV0udHJpbSgpLCB0cnVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBwcm9wZXJ0eU1hcFt0aGlzLmlkXSA9IHRoaXMuZGF0YTtcbiAgICBsaWIucGFyc2VLZXlzVG9XYXRjaCh0aGlzLmtleXNUb1dhdGNoLCB0aGlzLmRhdGEsIHRydWUpO1xuICB9XG59KTtcblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbi8qKlxuICogQ29tcHV0ZXMgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0d28gb2JqZWN0cyB3aXRoIGFiaWxpdHkgdG8gaWdub3JlIGtleXMuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGEgLSBGaXJzdCBvYmplY3QgdG8gY29tcGFyZSAoZS5nLiwgb2xkRGF0YSkuXG4gKiBAcGFyYW0ge29iamVjdH0gYiAtIFNlY29uZCBvYmplY3QgdG8gY29tcGFyZSAoZS5nLiwgbmV3RGF0YSkuXG4gKiBAcmV0dXJucyB7b2JqZWN0fVxuICogICBEaWZmZXJlbmNlIG9iamVjdCB3aGVyZSBzZXQgb2Yga2V5cyBub3RlIHdoaWNoIHZhbHVlcyB3ZXJlIG5vdCBlcXVhbCwgYW5kIHZhbHVlcyBhcmVcbiAqICAgYGJgJ3MgdmFsdWVzLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGtleXMgPSBbXTtcblxuICByZXR1cm4gZnVuY3Rpb24gKGEsIGIsIHRhcmdldE9iamVjdCwgaWdub3JlS2V5cykge1xuICAgIHZhciBhVmFsO1xuICAgIHZhciBiVmFsO1xuICAgIHZhciBiS2V5O1xuICAgIHZhciBkaWZmO1xuICAgIHZhciBrZXk7XG4gICAgdmFyIGk7XG4gICAgdmFyIGlzQ29tcGFyaW5nT2JqZWN0cztcblxuICAgIGRpZmYgPSB0YXJnZXRPYmplY3QgfHwge307XG5cbiAgICAvLyBDb2xsZWN0IEEga2V5cy5cbiAgICBrZXlzLmxlbmd0aCA9IDA7XG4gICAgZm9yIChrZXkgaW4gYSkge1xuICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgfVxuXG4gICAgaWYgKCFiKSB7XG4gICAgICByZXR1cm4gZGlmZjtcbiAgICB9XG5cbiAgICAvLyBDb2xsZWN0IEIga2V5cy5cbiAgICBmb3IgKGJLZXkgaW4gYikge1xuICAgICAgaWYgKGtleXMuaW5kZXhPZihiS2V5KSA9PT0gLTEpIHtcbiAgICAgICAga2V5cy5wdXNoKGJLZXkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBrZXkgPSBrZXlzW2ldO1xuXG4gICAgICAvLyBJZ25vcmUgc3BlY2lmaWVkIGtleXMuXG4gICAgICBpZiAoaWdub3JlS2V5cyAmJiBpZ25vcmVLZXlzLmluZGV4T2Yoa2V5KSAhPT0gLTEpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGFWYWwgPSBhW2tleV07XG4gICAgICBiVmFsID0gYltrZXldO1xuICAgICAgaXNDb21wYXJpbmdPYmplY3RzID0gYVZhbCAmJiBiVmFsICYmIGFWYWwuY29uc3RydWN0b3IgPT09IE9iamVjdCAmJiBiVmFsLmNvbnN0cnVjdG9yID09PSBPYmplY3Q7XG4gICAgICBpZiAoaXNDb21wYXJpbmdPYmplY3RzICYmICFBRlJBTUUudXRpbHMuZGVlcEVxdWFsKGFWYWwsIGJWYWwpIHx8ICFpc0NvbXBhcmluZ09iamVjdHMgJiYgYVZhbCAhPT0gYlZhbCkge1xuICAgICAgICBkaWZmW2tleV0gPSBiVmFsO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGlmZjtcbiAgfTtcbn0oKTtcblxuLyoqKi8gfSksXG4vKiA0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBmbnMgPSBbJ3B1c2gnLCAncG9wJywgJ3NoaWZ0JywgJ3Vuc2hpZnQnLCAnc3BsaWNlJ107XG5cbmZ1bmN0aW9uIHdyYXBBcnJheShhcnIpIHtcbiAgdmFyIGk7XG4gIGlmIChhcnIuX193cmFwcGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGZvciAoaSA9IDA7IGkgPCBmbnMubGVuZ3RoOyBpKyspIHtcbiAgICBtYWtlQ2FsbERpcnR5KGFyciwgZm5zW2ldKTtcbiAgfVxuICBhcnIuX193cmFwcGVkID0gdHJ1ZTtcbn1cbm1vZHVsZS5leHBvcnRzLndyYXBBcnJheSA9IHdyYXBBcnJheTtcblxuZnVuY3Rpb24gbWFrZUNhbGxEaXJ0eShhcnIsIGZuKSB7XG4gIHZhciBvcmlnaW5hbEZuID0gYXJyW2ZuXTtcbiAgYXJyW2ZuXSA9IGZ1bmN0aW9uICgpIHtcbiAgICBvcmlnaW5hbEZuLmFwcGx5KGFyciwgYXJndW1lbnRzKTtcbiAgICBhcnIuX19kaXJ0eSA9IHRydWU7XG4gIH07XG59XG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcbn0pO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtc3RhdGUtY29tcG9uZW50L2Rpc3QvYWZyYW1lLXN0YXRlLWNvbXBvbmVudC5qc1xuLy8gbW9kdWxlIGlkID0gMzBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIFRZUEVfUEFEID0gJ1BBRCc7XG52YXIgVFlQRV9TVElDSyA9ICdTVElDSyc7XG5cbnZhciBBTkdMRV9SSUdIVCA9IDA7XG52YXIgQU5HTEVfVVAgPSA5MDtcbnZhciBBTkdMRV9MRUZUID0gMTgwO1xudmFyIEFOR0xFX0RPV04gPSAyNzA7XG5cbnZhciBSSUdIVCA9ICdyaWdodCc7XG52YXIgVVAgPSAndXAnO1xudmFyIExFRlQgPSAnbGVmdCc7XG52YXIgRE9XTiA9ICdkb3duJztcblxudmFyIEFOR0xFUyA9IFtBTkdMRV9SSUdIVCwgQU5HTEVfVVAsIEFOR0xFX0xFRlQsIEFOR0xFX0RPV05dO1xudmFyIERJUkVDVElPTlMgPSBbUklHSFQsIFVQLCBMRUZULCBET1dOXTtcblxudmFyIEVWRU5UUyA9IHtOVUxMOiB7U1RBUlQ6ICd0aHVtYnN0YXJ0JywgRU5EOiAndGh1bWJlbmQnfX07XG5ESVJFQ1RJT05TLmZvckVhY2goZGlyZWN0aW9uID0+IHtcbiAgRVZFTlRTW2RpcmVjdGlvbl0gPSB7fTtcbiAgRVZFTlRTW2RpcmVjdGlvbl0uU1RBUlQgPSAndGh1bWInICsgZGlyZWN0aW9uICsgJ3N0YXJ0JztcbiAgRVZFTlRTW2RpcmVjdGlvbl0uRU5EICA9ICd0aHVtYicgKyBkaXJlY3Rpb24gKyAnZW5kJztcbn0pO1xuXG4vLyBGb3IgZGVidWcuXG52YXIgU0laRSA9IDI0MDtcblxuLyoqXG4gKiBOb3JtYWxpemUgdHJhY2twYWQgdnMgdGh1bWJzdGljayBjb250cm9scy5cbiAqIGB0aHVtYnN0YXJ0YFxuICogYHRodW1iZW5kYFxuICogYHRodW1ibGVmdHN0YXJ0YFxuICogYHRodW1ibGVmdGVuZGBcbiAqIGB0aHVtYnJpZ2h0c3RhcnRgXG4gKiBgdGh1bWJyaWdodGVuZGBcbiAqIGB0aHVtYnVwc3RhcnRgXG4gKiBgdGh1bWJ1cGVuZGBcbiAqIGB0aHVtYmRvd25zdGFydGBcbiAqIGB0aHVtYmRvd25lbmRgXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndGh1bWItY29udHJvbHMnLCB7XG4gIGRlcGVuZGVuY2llczogWyd0cmFja2VkLWNvbnRyb2xzJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgdGhyZXNob2xkQW5nbGU6IHtkZWZhdWx0OiA4OS41fSxcbiAgICB0aHJlc2hvbGRQYWQ6IHtkZWZhdWx0OiAwLjA1fSxcbiAgICB0aHJlc2hvbGRTdGljazoge2RlZmF1bHQ6IDAuNzV9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdGhpcy5vblRyYWNrcGFkRG93biA9IHRoaXMub25UcmFja3BhZERvd24uYmluZCh0aGlzKVxuICAgIHRoaXMub25UcmFja3BhZFVwID0gdGhpcy5vblRyYWNrcGFkVXAuYmluZCh0aGlzKVxuXG4gICAgdGhpcy5kaXJlY3Rpb25TdGljayA9ICcnO1xuICAgIHRoaXMuZGlyZWN0aW9uVHJhY2twYWQgPSAnJztcblxuICAgIC8vIEdldCB0aHVtYiB0eXBlIChzdGljayB2cyBwYWQpLlxuICAgIHRoaXMudHlwZSA9IFRZUEVfU1RJQ0s7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY29udHJvbGxlcmNvbm5lY3RlZCcsIGV2dCA9PiB7XG4gICAgICBpZiAoZXZ0LmRldGFpbC5uYW1lID09PSAnb2N1bHVzLXRvdWNoLWNvbnRyb2xzJyB8fFxuICAgICAgICAgIGV2dC5kZXRhaWwubmFtZSA9PT0gJ3dpbmRvd3MtbW90aW9uLWNvbnRyb2xzJykge1xuICAgICAgICB0aGlzLnR5cGUgPSBUWVBFX1NUSUNLO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnR5cGUgPSBUWVBFX1BBRDtcbiAgICB9KTtcblxuICAgIHRoaXMuYXhpcyA9IGVsLmNvbXBvbmVudHNbJ3RyYWNrZWQtY29udHJvbHMnXS5heGlzO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrcGFkZG93bicsIHRoaXMub25UcmFja3BhZERvd24pO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrcGFkdXAnLCB0aGlzLm9uVHJhY2twYWRVcCk7XG4gIH0sXG5cbiAgcGF1c2U6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYWNrcGFkZG93bicsIHRoaXMub25UcmFja3BhZERvd24pO1xuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYWNrcGFkdXAnLCB0aGlzLm9uVHJhY2twYWRVcCk7XG4gIH0sXG5cbiAgLy8gRm9yIHBhZC5cbiAgb25UcmFja3BhZERvd246IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGlyZWN0aW9uO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGk7XG4gICAgaWYgKHRoaXMuZ2V0RGlzdGFuY2UoKSA8IHRoaXMuZGF0YS50aHJlc2hvbGRQYWQpIHsgcmV0dXJuOyB9XG4gICAgZGlyZWN0aW9uID0gdGhpcy5nZXREaXJlY3Rpb24oKTtcbiAgICBpZiAoIWRpcmVjdGlvbikgeyByZXR1cm47IH1cbiAgICB0aGlzLmRpcmVjdGlvblRyYWNrcGFkID0gZGlyZWN0aW9uO1xuICAgIGVsLmVtaXQoRVZFTlRTLk5VTEwuU1RBUlQsIG51bGwsIGZhbHNlKTtcbiAgICBlbC5lbWl0KEVWRU5UU1t0aGlzLmRpcmVjdGlvblRyYWNrcGFkXS5TVEFSVCwgbnVsbCwgZmFsc2UpO1xuICB9LFxuXG4gIC8vIEZvciBwYWQuXG4gIG9uVHJhY2twYWRVcDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgaWYgKCF0aGlzLmRpcmVjdGlvblRyYWNrcGFkKSB7IHJldHVybjsgfVxuICAgIGVsLmVtaXQoRVZFTlRTLk5VTEwuRU5ELCBudWxsLCBmYWxzZSk7XG4gICAgZWwuZW1pdChFVkVOVFNbdGhpcy5kaXJlY3Rpb25UcmFja3BhZF0uRU5ELCBudWxsLCBmYWxzZSk7XG4gICAgdGhpcy5kaXJlY3Rpb25UcmFja3BhZCA9ICcnO1xuICB9LFxuXG4gIC8vIEF4aXMuXG4gIHRpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGlyZWN0aW9uO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG5cbiAgICBpZiAodGhpcy50eXBlID09PSBUWVBFX1BBRCkgeyByZXR1cm47IH1cblxuICAgIC8vIFN0aWNrIHB1bGxlZC4gU3RvcmUgZGlyZWN0aW9uIGFuZCBlbWl0IHN0YXJ0IGV2ZW50LlxuICAgIGlmICghdGhpcy5kaXJlY3Rpb25TdGljayAmJiB0aGlzLmdldERpc3RhbmNlKCkgPiB0aGlzLmRhdGEudGhyZXNob2xkU3RpY2spIHtcbiAgICAgIGRpcmVjdGlvbiA9IHRoaXMuZ2V0RGlyZWN0aW9uKCk7XG4gICAgICBpZiAoIWRpcmVjdGlvbikgeyByZXR1cm47IH1cbiAgICAgIHRoaXMuZGlyZWN0aW9uU3RpY2sgPSBkaXJlY3Rpb247XG4gICAgICBlbC5lbWl0KEVWRU5UUy5OVUxMLlNUQVJULCBudWxsLCBmYWxzZSk7XG4gICAgICBlbC5lbWl0KEVWRU5UU1t0aGlzLmRpcmVjdGlvblN0aWNrXS5TVEFSVCwgbnVsbCwgZmFsc2UpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFN0aWNrIHB1bGxlZCBiYWNrLiBSZXNldCBkaXJlY2l0b24gYW5kIGVtaXQgZW5kIGV2ZW50LlxuICAgIGlmICh0aGlzLmRpcmVjdGlvblN0aWNrICYmIHRoaXMuZ2V0RGlzdGFuY2UoKSA8IHRoaXMuZGF0YS50aHJlc2hvbGRTdGljaykge1xuICAgICAgZWwuZW1pdChFVkVOVFMuTlVMTC5FTkQsIG51bGwsIGZhbHNlKTtcbiAgICAgIGVsLmVtaXQoRVZFTlRTW3RoaXMuZGlyZWN0aW9uU3RpY2tdLkVORCwgbnVsbCwgZmFsc2UpO1xuICAgICAgdGhpcy5kaXJlY3Rpb25TdGljayA9ICcnO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogRGlzdGFuY2UgZnJvbSBjZW50ZXIgb2YgdGh1bWIuXG4gICAqL1xuICBnZXREaXN0YW5jZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBheGlzID0gdGhpcy5heGlzO1xuICAgIHJldHVybiBNYXRoLnNxcnQoYXhpc1sxXSAqIGF4aXNbMV0gKyBheGlzWzBdICogYXhpc1swXSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFRyYW5zbGF0ZSBhbmdsZSBpbnRvIGRpcmVjdGlvbi5cbiAgICovXG4gIGdldERpcmVjdGlvbjogZnVuY3Rpb24gKCkge1xuICAgIHZhciBhbmdsZTtcbiAgICB2YXIgYm90dG9tVGhyZXNob2xkO1xuICAgIHZhciBpO1xuICAgIHZhciB0aHJlc2hvbGQ7XG4gICAgdmFyIHRvcFRocmVzaG9sZDtcbiAgICBhbmdsZSA9IHRoaXMuZ2V0QW5nbGUoKTtcbiAgICB0aHJlc2hvbGQgPSB0aGlzLmRhdGEudGhyZXNob2xkQW5nbGUgLyAyO1xuICAgIGZvciAoaSA9IDA7IGkgPCBBTkdMRVMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRvcFRocmVzaG9sZCA9IEFOR0xFU1tpXSArIHRocmVzaG9sZDtcbiAgICAgIGlmICh0b3BUaHJlc2hvbGQgPiAzNjApIHsgdG9wVGhyZXNob2xkID0gdG9wVGhyZXNob2xkIC0gMzYwOyB9XG5cbiAgICAgIGJvdHRvbVRocmVzaG9sZCA9IEFOR0xFU1tpXSAtIHRocmVzaG9sZDtcbiAgICAgIGlmIChib3R0b21UaHJlc2hvbGQgPCAwKSB7XG4gICAgICAgIGlmICgoYW5nbGUgPj0gMzYwICsgYm90dG9tVGhyZXNob2xkICYmIGFuZ2xlIDw9IDM2MCkgfHxcbiAgICAgICAgICAgIChhbmdsZSA+PSAwICYmIGFuZ2xlIDw9IHRvcFRocmVzaG9sZCkpIHtcbiAgICAgICAgICByZXR1cm4gRElSRUNUSU9OU1tpXTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoYW5nbGUgPj0gYm90dG9tVGhyZXNob2xkICYmIGFuZ2xlIDw9IHRvcFRocmVzaG9sZCkge1xuICAgICAgICByZXR1cm4gRElSRUNUSU9OU1tpXTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldCBhbmdsZSBpbiBkZWdyZWVzLCB3aXRoIDAgc3RhcnRpbmcgb24gdGhlIHJpZ2h0IGdvaW5nIHRvIDM2MC4gTGlrZSB1bml0IGNpcmNsZS5cbiAgICovXG4gIGdldEFuZ2xlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFuZ2xlO1xuICAgIHZhciBheGlzID0gdGhpcy5heGlzO1xuICAgIHZhciBmbGlwWTtcbiAgICBmbGlwWSA9IHRoaXMudHlwZSA9PT0gVFlQRV9TVElDSyA/IC0xIDogMTtcbiAgICBhbmdsZSA9IE1hdGguYXRhbjIoYXhpc1sxXSAqIGZsaXBZLCBheGlzWzBdKTtcbiAgICBpZiAoYW5nbGUgPCAwKSB7IGFuZ2xlID0gMiAqIE1hdGguUEkgKyBhbmdsZTsgfVxuICAgIHJldHVybiBUSFJFRS5NYXRoLnJhZFRvRGVnKGFuZ2xlKTtcbiAgfVxufSk7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndGh1bWItY29udHJvbHMtZGVidWcnLCB7XG4gIGRlcGVuZGVuY2llczogWyd0aHVtYi1jb250cm9scycsICd0cmFja2VkLWNvbnRyb2xzJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgY29udHJvbGxlclR5cGU6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgaGFuZDoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBpc0FjdGl2ZTtcbiAgICB2YXIgYXhpcztcbiAgICB2YXIgYXhpc01vdmVFdmVudERldGFpbDtcbiAgICB2YXIgY2FudmFzO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICBpZiAoIWRhdGEuZW5hYmxlZCAmJiAhQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWctdGh1bWInKSkgeyByZXR1cm47IH1cbiAgICBjb25zb2xlLmxvZygnJWMgZGVidWctdGh1bWInLCAnYmFja2dyb3VuZDogIzExMTsgY29sb3I6IHJlZCcpO1xuXG4gICAgLy8gU3R1Yi5cbiAgICBlbC5jb21wb25lbnRzWyd0cmFja2VkLWNvbnRyb2xzJ10uaGFuZGxlQXhlcyA9ICgpID0+IHt9O1xuXG4gICAgYXhpcyA9IFswLCAwLCAwXTtcbiAgICBheGlzTW92ZUV2ZW50RGV0YWlsID0ge2F4aXM6IGF4aXN9O1xuICAgIGVsLmNvbXBvbmVudHNbJ3RyYWNrZWQtY29udHJvbHMnXS5heGlzID0gYXhpcztcbiAgICBlbC5jb21wb25lbnRzWyd0aHVtYi1jb250cm9scyddLmF4aXMgPSBheGlzO1xuXG4gICAgY2FudmFzID0gdGhpcy5jcmVhdGVDYW52YXMoKTtcblxuICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiB7XG4gICAgICBpZiAodGhpcy5kYXRhLmNvbnRyb2xsZXJUeXBlID09PSAndml2ZS1jb250cm9scycpIHtcbiAgICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgICAgZWwuZW1pdCgndHJhY2twYWR1cCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsLmVtaXQoJ3RyYWNrcGFkZG93bicpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoaXNBY3RpdmUpIHtcbiAgICAgICAgICBheGlzWzBdID0gMDtcbiAgICAgICAgICBheGlzWzFdID0gMDtcbiAgICAgICAgICBlbC5lbWl0KCdheGlzbW92ZScsIGF4aXNNb3ZlRXZlbnREZXRhaWwsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaXNBY3RpdmUgPSAhaXNBY3RpdmU7XG4gICAgfSk7XG5cbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgZXZ0ID0+IHtcbiAgICAgIHZhciByZWN0O1xuICAgICAgaWYgKCFpc0FjdGl2ZSkgeyByZXR1cm47IH1cbiAgICAgIHJlY3QgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICBheGlzWzBdID0gKGV2dC5jbGllbnRYIC0gcmVjdC5sZWZ0KSAvIFNJWkUgKiAyIC0gMTtcbiAgICAgIGF4aXNbMV0gPSAoZXZ0LmNsaWVudFkgLSByZWN0LnRvcCkgLyBTSVpFICogMiAtIDE7XG4gICAgICBlbC5lbWl0KCdheGlzbW92ZScsIGF4aXNNb3ZlRXZlbnREZXRhaWwsIGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgZXZ0ID0+IHtcbiAgICAgIGlmICghaXNBY3RpdmUpIHsgcmV0dXJuOyB9XG4gICAgICBheGlzWzBdID0gMDtcbiAgICAgIGF4aXNbMV0gPSAwO1xuICAgICAgZWwuZW1pdCgnYXhpc21vdmUnLCBheGlzTW92ZUV2ZW50RGV0YWlsLCBmYWxzZSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgY3JlYXRlQ2FudmFzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNhbnZhcztcbiAgICB2YXIgY3R4O1xuICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIGNhbnZhcy5jbGFzc0xpc3QuYWRkKCdkZWJ1Z1RodW1iJyk7XG4gICAgY2FudmFzLmhlaWdodCA9IFNJWkU7XG4gICAgY2FudmFzLndpZHRoID0gU0laRTtcbiAgICBjYW52YXMuc3R5bGUuYm90dG9tID0gMDtcbiAgICBjYW52YXMuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzI1MHB4JztcbiAgICBjYW52YXMuc3R5bGUub3BhY2l0eSA9IDAuNTtcbiAgICBjYW52YXMuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgIGNhbnZhcy5zdHlsZS56SW5kZXggPSA5OTk5OTk5OTk7XG4gICAgaWYgKHRoaXMuZGF0YS5oYW5kID09PSAnbGVmdCcpIHtcbiAgICAgIGNhbnZhcy5zdHlsZS5sZWZ0ID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FudmFzLnN0eWxlLnJpZ2h0ID0gMDtcbiAgICB9XG4gICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgY3R4LmZpbGxTdHlsZSA9IFwiIzMzM1wiO1xuICAgIGN0eC5maWxsUmVjdCgwLCAwLCBTSVpFLCBTSVpFKTtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNhbnZhcyk7XG4gICAgcmV0dXJuIGNhbnZhcztcbiAgfVxufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLXRodW1iLWNvbnRyb2xzLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMzFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiXG52YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4vaW5kZXguY3NzXCIpO1xuXG5pZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcblxudmFyIHRyYW5zZm9ybTtcbnZhciBpbnNlcnRJbnRvO1xuXG5cblxudmFyIG9wdGlvbnMgPSB7XCJobXJcIjp0cnVlfVxuXG5vcHRpb25zLnRyYW5zZm9ybSA9IHRyYW5zZm9ybVxub3B0aW9ucy5pbnNlcnRJbnRvID0gdW5kZWZpbmVkO1xuXG52YXIgdXBkYXRlID0gcmVxdWlyZShcIiEuLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2xpYi9hZGRTdHlsZXMuanNcIikoY29udGVudCwgb3B0aW9ucyk7XG5cbmlmKGNvbnRlbnQubG9jYWxzKSBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzO1xuXG5pZihtb2R1bGUuaG90KSB7XG5cdG1vZHVsZS5ob3QuYWNjZXB0KFwiISEuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuL2luZGV4LmNzc1wiLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4vaW5kZXguY3NzXCIpO1xuXG5cdFx0aWYodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07XG5cblx0XHR2YXIgbG9jYWxzID0gKGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdHZhciBrZXksIGlkeCA9IDA7XG5cblx0XHRcdGZvcihrZXkgaW4gYSkge1xuXHRcdFx0XHRpZighYiB8fCBhW2tleV0gIT09IGJba2V5XSkgcmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRpZHgrKztcblx0XHRcdH1cblxuXHRcdFx0Zm9yKGtleSBpbiBiKSBpZHgtLTtcblxuXHRcdFx0cmV0dXJuIGlkeCA9PT0gMDtcblx0XHR9KGNvbnRlbnQubG9jYWxzLCBuZXdDb250ZW50LmxvY2FscykpO1xuXG5cdFx0aWYoIWxvY2FscykgdGhyb3cgbmV3IEVycm9yKCdBYm9ydGluZyBDU1MgSE1SIGR1ZSB0byBjaGFuZ2VkIGNzcy1tb2R1bGVzIGxvY2Fscy4nKTtcblxuXHRcdHVwZGF0ZShuZXdDb250ZW50KTtcblx0fSk7XG5cblx0bW9kdWxlLmhvdC5kaXNwb3NlKGZ1bmN0aW9uKCkgeyB1cGRhdGUoKTsgfSk7XG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvaW5kZXguY3NzXG4vLyBtb2R1bGUgaWQgPSAzMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgbWFwID0ge1xuXHRcIi4vYWN0aXZlLWNvbG9yLmpzXCI6IDU5LFxuXHRcIi4vYXVkaW8tY29sdW1ucy5qc1wiOiA2MCxcblx0XCIuL2JlYW1zLmpzXCI6IDYxLFxuXHRcIi4vYmVhdC1oaXQtc291bmQuanNcIjogNjIsXG5cdFwiLi9iZWF0LWxvYWRlci5qc1wiOiA2Myxcblx0XCIuL2JlYXQuanNcIjogNjQsXG5cdFwiLi9jb25zb2xlLXNob3J0Y3V0cy5qc1wiOiA2NSxcblx0XCIuL2NvcHktdGV4dHVyZS5qc1wiOiA2Nixcblx0XCIuL2N1cnNvci1sYXNlci5qc1wiOiA2Nyxcblx0XCIuL2N1cnNvci1tZXNoLmpzXCI6IDY4LFxuXHRcIi4vZGVidWctYmVhdC1sb2FkZXIuanNcIjogNjksXG5cdFwiLi9kZWJ1Zy1jb250cm9sbGVyLmpzXCI6IDcwLFxuXHRcIi4vZGVidWctY3Vyc29yLmpzXCI6IDcxLFxuXHRcIi4vZGVidWctc29uZy10aW1lLmpzXCI6IDcyLFxuXHRcIi4vZGVidWctc3RhdGUuanNcIjogNzMsXG5cdFwiLi9mYWtlLWdsb3cuanNcIjogNzQsXG5cdFwiLi9mbG9vci1zaGFkZXIuanNcIjogNzUsXG5cdFwiLi9nYW1lb3Zlci5qc1wiOiA3Nixcblx0XCIuL2dwdS1wcmVsb2FkZXIuanNcIjogNzcsXG5cdFwiLi9oYWNrLmpzXCI6IDc4LFxuXHRcIi4vaGFuZC1zd2FwcGVyLmpzXCI6IDc5LFxuXHRcIi4vaGFwdGljcy1zYWJlci5qc1wiOiA4MCxcblx0XCIuL2hhcHRpY3Mtd2FsbC5qc1wiOiA4MSxcblx0XCIuL2hpc3RvcnkuanNcIjogODIsXG5cdFwiLi9pbnRyby1zb25nLmpzXCI6IDgzLFxuXHRcIi4va2V5Ym9hcmQtcmF5Y2FzdGFibGUuanNcIjogODQsXG5cdFwiLi9sZWFkZXJib2FyZC5qc1wiOiA4NSxcblx0XCIuL2xvZ28tbGlnaHQuanNcIjogODYsXG5cdFwiLi9sb2dvZmxpY2tlci5qc1wiOiA4Nyxcblx0XCIuL21hdGVyaWFscy5qc1wiOiA4OCxcblx0XCIuL21lbnUtY29udHJvbHMuanNcIjogODksXG5cdFwiLi9tZW51LWRpZmZpY3VsdHktc2VsZWN0LmpzXCI6IDkwLFxuXHRcIi4vbWVudS1zZWxlY3RlZC1jaGFsbGVuZ2UtaW1hZ2UuanNcIjogOTEsXG5cdFwiLi9tZW51LXNsaWRlLWFuaW1hdGlvbi5qc1wiOiA5Mixcblx0XCIuL21pbmUtZnJhZ21lbnRzLWxvYWRlci5qc1wiOiA5Myxcblx0XCIuL211bHRpcGxpZXItcmluZy5qc1wiOiA5NCxcblx0XCIuL3BhcnRpY2xlcGxheWVyLmpzXCI6IDk1LFxuXHRcIi4vcGF1c2UuanNcIjogOTYsXG5cdFwiLi9wYXVzZXIuanNcIjogOTcsXG5cdFwiLi9wbGF5LXNvdW5kLmpzXCI6IDk4LFxuXHRcIi4vcmF5Y2FzdGVyLXRhcmdldC5qc1wiOiA5OSxcblx0XCIuL3JlY2VudGVyLmpzXCI6IDEwMCxcblx0XCIuL3NhYmVyLWNvbnRyb2xzLmpzXCI6IDEwMSxcblx0XCIuL3NhYmVyLXBhcnRpY2xlcy5qc1wiOiAxMDIsXG5cdFwiLi9zY29yZS1iZWF0LmpzXCI6IDEwMyxcblx0XCIuL3Njb3JlLXRleHRzLmpzXCI6IDEwNCxcblx0XCIuL3NlYXJjaC10aHVtYm5haWwtYXRsYXMuanNcIjogMTA1LFxuXHRcIi4vc2VhcmNoLmpzXCI6IDEwNixcblx0XCIuL3NvbmctcHJldmlldy5qc1wiOiAxMDcsXG5cdFwiLi9zb25nLXByb2dyZXNzLXJpbmcuanNcIjogMTA4LFxuXHRcIi4vc29uZy5qc1wiOiAxMDksXG5cdFwiLi9zdGFnZS1jb2xvcnMuanNcIjogMTEwLFxuXHRcIi4vc3RhZ2UtbGFzZXJzLmpzXCI6IDExMSxcblx0XCIuL3N0YWdlLXNoYWRlci5qc1wiOiAxMTIsXG5cdFwiLi9zdGF0cy1wYXJhbS5qc1wiOiAxMTMsXG5cdFwiLi9zdGVwYmFjay5qc1wiOiAxMTQsXG5cdFwiLi9zdWItb2JqZWN0LmpzXCI6IDExNSxcblx0XCIuL3N1cGVyLWtleWJvYXJkLmpzXCI6IDExNixcblx0XCIuL3N1cGVyY3V0Zngtc2hhZGVyLmpzXCI6IDExNyxcblx0XCIuL3N1cGVyY3V0ZnguanNcIjogMTE4LFxuXHRcIi4vdGV4dC1jb3VudGVyLmpzXCI6IDExOSxcblx0XCIuL3RleHQtdXBwZXJjYXNlLmpzXCI6IDEyMCxcblx0XCIuL3RvZ2dsZS1wYXVzZS1wbGF5LmpzXCI6IDEyMSxcblx0XCIuL3RyYWlsLmpzXCI6IDEyMixcblx0XCIuL3R1dG9yaWFsLTJkLmpzXCI6IDEyMyxcblx0XCIuL3R3aXN0ZXIuanNcIjogMTI0LFxuXHRcIi4vdmVydGV4LWNvbG9ycy1idWZmZXIuanNcIjogMTI1LFxuXHRcIi4vdmljdG9yeS1hY2N1cmFjeS1yaW5nLmpzXCI6IDEyNixcblx0XCIuL3ZpY3RvcnktcmFuay5qc1wiOiAxMjcsXG5cdFwiLi92aXNpYmxlLXJheWNhc3RhYmxlLmpzXCI6IDEyOCxcblx0XCIuL3dhbGwtc2hhZGVyLmpzXCI6IDEyOSxcblx0XCIuL3dhbGwuanNcIjogMTMwXG59O1xuZnVuY3Rpb24gd2VicGFja0NvbnRleHQocmVxKSB7XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpKTtcbn07XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSB7XG5cdHZhciBpZCA9IG1hcFtyZXFdO1xuXHRpZighKGlkICsgMSkpIC8vIGNoZWNrIGZvciBudW1iZXIgb3Igc3RyaW5nXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIiArIHJlcSArIFwiJy5cIik7XG5cdHJldHVybiBpZDtcbn07XG53ZWJwYWNrQ29udGV4dC5rZXlzID0gZnVuY3Rpb24gd2VicGFja0NvbnRleHRLZXlzKCkge1xuXHRyZXR1cm4gT2JqZWN0LmtleXMobWFwKTtcbn07XG53ZWJwYWNrQ29udGV4dC5yZXNvbHZlID0gd2VicGFja0NvbnRleHRSZXNvbHZlO1xubW9kdWxlLmV4cG9ydHMgPSB3ZWJwYWNrQ29udGV4dDtcbndlYnBhY2tDb250ZXh0LmlkID0gMzM7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvY29tcG9uZW50cyBcXC5qcyRcbi8vIG1vZHVsZSBpZCA9IDMzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBtYXAgPSB7XG5cdFwiLi9pbmRleC5qc1wiOiAxMzRcbn07XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dChyZXEpIHtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18od2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkpO1xufTtcbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpIHtcblx0dmFyIGlkID0gbWFwW3JlcV07XG5cdGlmKCEoaWQgKyAxKSkgLy8gY2hlY2sgZm9yIG51bWJlciBvciBzdHJpbmdcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInLlwiKTtcblx0cmV0dXJuIGlkO1xufTtcbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSAzNDtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9zdGF0ZSBcXC5qcyRcbi8vIG1vZHVsZSBpZCA9IDM0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcblxuZnVuY3Rpb24gX2ludGVyb3BEZWZhdWx0IChleCkgeyByZXR1cm4gKGV4ICYmICh0eXBlb2YgZXggPT09ICdvYmplY3QnKSAmJiAnZGVmYXVsdCcgaW4gZXgpID8gZXhbJ2RlZmF1bHQnXSA6IGV4OyB9XG5cbnZhciBmaXJlYmFzZSA9IF9pbnRlcm9wRGVmYXVsdChyZXF1aXJlKCdAZmlyZWJhc2UvYXBwJykpO1xudmFyIGxvZ2dlciA9IHJlcXVpcmUoJ0BmaXJlYmFzZS9sb2dnZXInKTtcbnZhciB0c2xpYl8xID0gcmVxdWlyZSgndHNsaWInKTtcbnZhciB3ZWJjaGFubmVsV3JhcHBlciA9IHJlcXVpcmUoJ0BmaXJlYmFzZS93ZWJjaGFubmVsLXdyYXBwZXInKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKiBUaGUgc2VtdmVyICh3d3cuc2VtdmVyLm9yZykgdmVyc2lvbiBvZiB0aGUgU0RLLiAqL1xyXG52YXIgU0RLX1ZFUlNJT04gPSBmaXJlYmFzZS5TREtfVkVSU0lPTjtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBsb2dDbGllbnQgPSBuZXcgbG9nZ2VyLkxvZ2dlcignQGZpcmViYXNlL2ZpcmVzdG9yZScpO1xyXG52YXIgTG9nTGV2ZWw7XHJcbihmdW5jdGlvbiAoTG9nTGV2ZWwpIHtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiREVCVUdcIl0gPSAwXSA9IFwiREVCVUdcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiRVJST1JcIl0gPSAxXSA9IFwiRVJST1JcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiU0lMRU5UXCJdID0gMl0gPSBcIlNJTEVOVFwiO1xyXG59KShMb2dMZXZlbCB8fCAoTG9nTGV2ZWwgPSB7fSkpO1xyXG4vLyBIZWxwZXIgbWV0aG9kcyBhcmUgbmVlZGVkIGJlY2F1c2UgdmFyaWFibGVzIGNhbid0IGJlIGV4cG9ydGVkIGFzIHJlYWQvd3JpdGVcclxuZnVuY3Rpb24gZ2V0TG9nTGV2ZWwoKSB7XHJcbiAgICBpZiAobG9nQ2xpZW50LmxvZ0xldmVsID09PSBsb2dnZXIuTG9nTGV2ZWwuREVCVUcpIHtcclxuICAgICAgICByZXR1cm4gTG9nTGV2ZWwuREVCVUc7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChsb2dDbGllbnQubG9nTGV2ZWwgPT09IGxvZ2dlci5Mb2dMZXZlbC5TSUxFTlQpIHtcclxuICAgICAgICByZXR1cm4gTG9nTGV2ZWwuU0lMRU5UO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIExvZ0xldmVsLkVSUk9SO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldExvZ0xldmVsKG5ld0xldmVsKSB7XHJcbiAgICAvKipcclxuICAgICAqIE1hcCB0aGUgbmV3IGxvZyBsZXZlbCB0byB0aGUgYXNzb2NpYXRlZCBGaXJlYmFzZSBMb2cgTGV2ZWxcclxuICAgICAqL1xyXG4gICAgc3dpdGNoIChuZXdMZXZlbCkge1xyXG4gICAgICAgIGNhc2UgTG9nTGV2ZWwuREVCVUc6XHJcbiAgICAgICAgICAgIGxvZ0NsaWVudC5sb2dMZXZlbCA9IGxvZ2dlci5Mb2dMZXZlbC5ERUJVRztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5FUlJPUjpcclxuICAgICAgICAgICAgbG9nQ2xpZW50LmxvZ0xldmVsID0gbG9nZ2VyLkxvZ0xldmVsLkVSUk9SO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIExvZ0xldmVsLlNJTEVOVDpcclxuICAgICAgICAgICAgbG9nQ2xpZW50LmxvZ0xldmVsID0gbG9nZ2VyLkxvZ0xldmVsLlNJTEVOVDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgbG9nQ2xpZW50LmVycm9yKFwiRmlyZXN0b3JlIChcIiArIFNES19WRVJTSU9OICsgXCIpOiBJbnZhbGlkIHZhbHVlIHBhc3NlZCB0byBgc2V0TG9nTGV2ZWxgXCIpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGRlYnVnKHRhZywgbXNnKSB7XHJcbiAgICB2YXIgb2JqID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIG9ialtfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIGlmIChsb2dDbGllbnQubG9nTGV2ZWwgPD0gbG9nZ2VyLkxvZ0xldmVsLkRFQlVHKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBvYmoubWFwKGFyZ1RvU3RyaW5nKTtcclxuICAgICAgICBsb2dDbGllbnQuZGVidWcuYXBwbHkobG9nQ2xpZW50LCBbXCJGaXJlc3RvcmUgKFwiICsgU0RLX1ZFUlNJT04gKyBcIikgW1wiICsgdGFnICsgXCJdOiBcIiArIG1zZ10uY29uY2F0KGFyZ3MpKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBlcnJvcihtc2cpIHtcclxuICAgIHZhciBvYmogPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgb2JqW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgaWYgKGxvZ0NsaWVudC5sb2dMZXZlbCA8PSBsb2dnZXIuTG9nTGV2ZWwuRVJST1IpIHtcclxuICAgICAgICB2YXIgYXJncyA9IG9iai5tYXAoYXJnVG9TdHJpbmcpO1xyXG4gICAgICAgIGxvZ0NsaWVudC5lcnJvci5hcHBseShsb2dDbGllbnQsIFtcIkZpcmVzdG9yZSAoXCIgKyBTREtfVkVSU0lPTiArIFwiKTogXCIgKyBtc2ddLmNvbmNhdChhcmdzKSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIENvbnZlcnRzIGFuIGFkZGl0aW9uYWwgbG9nIHBhcmFtZXRlciB0byBhIHN0cmluZyByZXByZXNlbnRhdGlvbi5cclxuICovXHJcbmZ1bmN0aW9uIGFyZ1RvU3RyaW5nKG9iaikge1xyXG4gICAgaWYgKHR5cGVvZiBvYmogPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHZhciBwbGF0Zm9ybSA9IFBsYXRmb3JtU3VwcG9ydC5nZXRQbGF0Zm9ybSgpO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwbGF0Zm9ybS5mb3JtYXRKU09OKG9iaik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIENvbnZlcnRpbmcgdG8gSlNPTiBmYWlsZWQsIGp1c3QgbG9nIHRoZSBvYmplY3QgZGlyZWN0bHlcclxuICAgICAgICAgICAgcmV0dXJuIG9iajtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBVbmNvbmRpdGlvbmFsbHkgZmFpbHMsIHRocm93aW5nIGFuIEVycm9yIHdpdGggdGhlIGdpdmVuIG1lc3NhZ2UuXHJcbiAqXHJcbiAqIFJldHVybnMgYW55IHNvIGl0IGNhbiBiZSB1c2VkIGluIGV4cHJlc3Npb25zOlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBsZXQgZnV0dXJlVmFyID0gZmFpbCgnbm90IGltcGxlbWVudGVkIHlldCcpO1xyXG4gKi9cclxuZnVuY3Rpb24gZmFpbChmYWlsdXJlKSB7XHJcbiAgICAvLyBMb2cgdGhlIGZhaWx1cmUgaW4gYWRkaXRpb24gdG8gdGhyb3cgYW4gZXhjZXB0aW9uLCBqdXN0IGluIGNhc2UgdGhlXHJcbiAgICAvLyBleGNlcHRpb24gaXMgc3dhbGxvd2VkLlxyXG4gICAgdmFyIG1lc3NhZ2UgPSBcIkZJUkVTVE9SRSAoXCIgKyBTREtfVkVSU0lPTiArIFwiKSBJTlRFUk5BTCBBU1NFUlRJT04gRkFJTEVEOiBcIiArIGZhaWx1cmU7XHJcbiAgICBlcnJvcihtZXNzYWdlKTtcclxuICAgIC8vIE5PVEU6IFdlIGRvbid0IHVzZSBGaXJlc3RvcmVFcnJvciBoZXJlIGJlY2F1c2UgdGhlc2UgYXJlIGludGVybmFsIGZhaWx1cmVzXHJcbiAgICAvLyB0aGF0IGNhbm5vdCBiZSBoYW5kbGVkIGJ5IHRoZSB1c2VyLiAoQWxzbyBpdCB3b3VsZCBjcmVhdGUgYSBjaXJjdWxhclxyXG4gICAgLy8gZGVwZW5kZW5jeSBiZXR3ZWVuIHRoZSBlcnJvciBhbmQgYXNzZXJ0IG1vZHVsZXMgd2hpY2ggZG9lc24ndCB3b3JrLilcclxuICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcclxufVxyXG4vKipcclxuICogRmFpbHMgaWYgdGhlIGdpdmVuIGFzc2VydGlvbiBjb25kaXRpb24gaXMgZmFsc2UsIHRocm93aW5nIGFuIEVycm9yIHdpdGggdGhlXHJcbiAqIGdpdmVuIG1lc3NhZ2UgaWYgaXQgZGlkLlxyXG4gKi9cclxuZnVuY3Rpb24gYXNzZXJ0KGFzc2VydGlvbiwgbWVzc2FnZSkge1xyXG4gICAgaWYgKCFhc3NlcnRpb24pIHtcclxuICAgICAgICBmYWlsKG1lc3NhZ2UpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUHJvdmlkZXMgc2luZ2xldG9uIGhlbHBlcnMgd2hlcmUgc2V0dXAgY29kZSBjYW4gaW5qZWN0IGEgcGxhdGZvcm0gYXQgcnVudGltZS5cclxuICogc2V0UGxhdGZvcm0gbmVlZHMgdG8gYmUgc2V0IGJlZm9yZSBGaXJlc3RvcmUgaXMgdXNlZCBhbmQgbXVzdCBiZSBzZXQgZXhhY3RseVxyXG4gKiBvbmNlLlxyXG4gKi9cclxudmFyIFBsYXRmb3JtU3VwcG9ydCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFBsYXRmb3JtU3VwcG9ydCgpIHtcclxuICAgIH1cclxuICAgIFBsYXRmb3JtU3VwcG9ydC5zZXRQbGF0Zm9ybSA9IGZ1bmN0aW9uIChwbGF0Zm9ybSkge1xyXG4gICAgICAgIGlmIChQbGF0Zm9ybVN1cHBvcnQucGxhdGZvcm0pIHtcclxuICAgICAgICAgICAgZmFpbCgnUGxhdGZvcm0gYWxyZWFkeSBkZWZpbmVkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFBsYXRmb3JtU3VwcG9ydC5wbGF0Zm9ybSA9IHBsYXRmb3JtO1xyXG4gICAgfTtcclxuICAgIFBsYXRmb3JtU3VwcG9ydC5nZXRQbGF0Zm9ybSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIVBsYXRmb3JtU3VwcG9ydC5wbGF0Zm9ybSkge1xyXG4gICAgICAgICAgICBmYWlsKCdQbGF0Zm9ybSBub3Qgc2V0Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQbGF0Zm9ybVN1cHBvcnQucGxhdGZvcm07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBsYXRmb3JtU3VwcG9ydDtcclxufSgpKTtcclxuLyoqXHJcbiAqIFJldHVybnMgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIGVtcHR5IFwicHJvdG9cIiBieXRlIHN0cmluZyBmb3IgdGhlXHJcbiAqIHBsYXRmb3JtLlxyXG4gKi9cclxuZnVuY3Rpb24gZW1wdHlCeXRlU3RyaW5nKCkge1xyXG4gICAgcmV0dXJuIFBsYXRmb3JtU3VwcG9ydC5nZXRQbGF0Zm9ybSgpLmVtcHR5Qnl0ZVN0cmluZztcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gVE9ETyhtY2cpOiBDaGFuZ2UgdG8gYSBzdHJpbmcgZW51bSBvbmNlIHdlJ3ZlIHVwZ3JhZGVkIHRvIHR5cGVzY3JpcHQgMi40LlxyXG4vLyAgdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnZhcmlhYmxlLW5hbWUgSW50ZW5kZWQgdG8gbG9vayBsaWtlIGEgVFMgMi40IGVudW1cclxudmFyIENvZGUgPSB7XHJcbiAgICAvLyBDYXVzZXMgYXJlIGNvcGllZCBmcm9tOlxyXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcclxuICAgIC8qKiBOb3QgYW4gZXJyb3I7IHJldHVybmVkIG9uIHN1Y2Nlc3MuICovXHJcbiAgICBPSzogJ29rJyxcclxuICAgIC8qKiBUaGUgb3BlcmF0aW9uIHdhcyBjYW5jZWxsZWQgKHR5cGljYWxseSBieSB0aGUgY2FsbGVyKS4gKi9cclxuICAgIENBTkNFTExFRDogJ2NhbmNlbGxlZCcsXHJcbiAgICAvKiogVW5rbm93biBlcnJvciBvciBhbiBlcnJvciBmcm9tIGEgZGlmZmVyZW50IGVycm9yIGRvbWFpbi4gKi9cclxuICAgIFVOS05PV046ICd1bmtub3duJyxcclxuICAgIC8qKlxyXG4gICAgICogQ2xpZW50IHNwZWNpZmllZCBhbiBpbnZhbGlkIGFyZ3VtZW50LiBOb3RlIHRoYXQgdGhpcyBkaWZmZXJzIGZyb21cclxuICAgICAqIEZBSUxFRF9QUkVDT05ESVRJT04uIElOVkFMSURfQVJHVU1FTlQgaW5kaWNhdGVzIGFyZ3VtZW50cyB0aGF0IGFyZVxyXG4gICAgICogcHJvYmxlbWF0aWMgcmVnYXJkbGVzcyBvZiB0aGUgc3RhdGUgb2YgdGhlIHN5c3RlbSAoZS5nLiwgYSBtYWxmb3JtZWQgZmlsZVxyXG4gICAgICogbmFtZSkuXHJcbiAgICAgKi9cclxuICAgIElOVkFMSURfQVJHVU1FTlQ6ICdpbnZhbGlkLWFyZ3VtZW50JyxcclxuICAgIC8qKlxyXG4gICAgICogRGVhZGxpbmUgZXhwaXJlZCBiZWZvcmUgb3BlcmF0aW9uIGNvdWxkIGNvbXBsZXRlLiBGb3Igb3BlcmF0aW9ucyB0aGF0XHJcbiAgICAgKiBjaGFuZ2UgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0sIHRoaXMgZXJyb3IgbWF5IGJlIHJldHVybmVkIGV2ZW4gaWYgdGhlXHJcbiAgICAgKiBvcGVyYXRpb24gaGFzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuIEZvciBleGFtcGxlLCBhIHN1Y2Nlc3NmdWwgcmVzcG9uc2VcclxuICAgICAqIGZyb20gYSBzZXJ2ZXIgY291bGQgaGF2ZSBiZWVuIGRlbGF5ZWQgbG9uZyBlbm91Z2ggZm9yIHRoZSBkZWFkbGluZSB0b1xyXG4gICAgICogZXhwaXJlLlxyXG4gICAgICovXHJcbiAgICBERUFETElORV9FWENFRURFRDogJ2RlYWRsaW5lLWV4Y2VlZGVkJyxcclxuICAgIC8qKiBTb21lIHJlcXVlc3RlZCBlbnRpdHkgKGUuZy4sIGZpbGUgb3IgZGlyZWN0b3J5KSB3YXMgbm90IGZvdW5kLiAqL1xyXG4gICAgTk9UX0ZPVU5EOiAnbm90LWZvdW5kJyxcclxuICAgIC8qKlxyXG4gICAgICogU29tZSBlbnRpdHkgdGhhdCB3ZSBhdHRlbXB0ZWQgdG8gY3JlYXRlIChlLmcuLCBmaWxlIG9yIGRpcmVjdG9yeSkgYWxyZWFkeVxyXG4gICAgICogZXhpc3RzLlxyXG4gICAgICovXHJcbiAgICBBTFJFQURZX0VYSVNUUzogJ2FscmVhZHktZXhpc3RzJyxcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGNhbGxlciBkb2VzIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gZXhlY3V0ZSB0aGUgc3BlY2lmaWVkIG9wZXJhdGlvbi5cclxuICAgICAqIFBFUk1JU1NJT05fREVOSUVEIG11c3Qgbm90IGJlIHVzZWQgZm9yIHJlamVjdGlvbnMgY2F1c2VkIGJ5IGV4aGF1c3RpbmdcclxuICAgICAqIHNvbWUgcmVzb3VyY2UgKHVzZSBSRVNPVVJDRV9FWEhBVVNURUQgaW5zdGVhZCBmb3IgdGhvc2UgZXJyb3JzKS5cclxuICAgICAqIFBFUk1JU1NJT05fREVOSUVEIG11c3Qgbm90IGJlIHVzZWQgaWYgdGhlIGNhbGxlciBjYW4gbm90IGJlIGlkZW50aWZpZWRcclxuICAgICAqICh1c2UgVU5BVVRIRU5USUNBVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXHJcbiAgICAgKi9cclxuICAgIFBFUk1JU1NJT05fREVOSUVEOiAncGVybWlzc2lvbi1kZW5pZWQnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIHZhbGlkIGF1dGhlbnRpY2F0aW9uIGNyZWRlbnRpYWxzIGZvciB0aGVcclxuICAgICAqIG9wZXJhdGlvbi5cclxuICAgICAqL1xyXG4gICAgVU5BVVRIRU5USUNBVEVEOiAndW5hdXRoZW50aWNhdGVkJyxcclxuICAgIC8qKlxyXG4gICAgICogU29tZSByZXNvdXJjZSBoYXMgYmVlbiBleGhhdXN0ZWQsIHBlcmhhcHMgYSBwZXItdXNlciBxdW90YSwgb3IgcGVyaGFwcyB0aGVcclxuICAgICAqIGVudGlyZSBmaWxlIHN5c3RlbSBpcyBvdXQgb2Ygc3BhY2UuXHJcbiAgICAgKi9cclxuICAgIFJFU09VUkNFX0VYSEFVU1RFRDogJ3Jlc291cmNlLWV4aGF1c3RlZCcsXHJcbiAgICAvKipcclxuICAgICAqIE9wZXJhdGlvbiB3YXMgcmVqZWN0ZWQgYmVjYXVzZSB0aGUgc3lzdGVtIGlzIG5vdCBpbiBhIHN0YXRlIHJlcXVpcmVkIGZvclxyXG4gICAgICogdGhlIG9wZXJhdGlvbidzIGV4ZWN1dGlvbi4gRm9yIGV4YW1wbGUsIGRpcmVjdG9yeSB0byBiZSBkZWxldGVkIG1heSBiZVxyXG4gICAgICogbm9uLWVtcHR5LCBhbiBybWRpciBvcGVyYXRpb24gaXMgYXBwbGllZCB0byBhIG5vbi1kaXJlY3RvcnksIGV0Yy5cclxuICAgICAqXHJcbiAgICAgKiBBIGxpdG11cyB0ZXN0IHRoYXQgbWF5IGhlbHAgYSBzZXJ2aWNlIGltcGxlbWVudG9yIGluIGRlY2lkaW5nXHJcbiAgICAgKiBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsIGFuZCBVTkFWQUlMQUJMRTpcclxuICAgICAqICAoYSkgVXNlIFVOQVZBSUxBQkxFIGlmIHRoZSBjbGllbnQgY2FuIHJldHJ5IGp1c3QgdGhlIGZhaWxpbmcgY2FsbC5cclxuICAgICAqICAoYikgVXNlIEFCT1JURUQgaWYgdGhlIGNsaWVudCBzaG91bGQgcmV0cnkgYXQgYSBoaWdoZXItbGV2ZWxcclxuICAgICAqICAgICAgKGUuZy4sIHJlc3RhcnRpbmcgYSByZWFkLW1vZGlmeS13cml0ZSBzZXF1ZW5jZSkuXHJcbiAgICAgKiAgKGMpIFVzZSBGQUlMRURfUFJFQ09ORElUSU9OIGlmIHRoZSBjbGllbnQgc2hvdWxkIG5vdCByZXRyeSB1bnRpbFxyXG4gICAgICogICAgICB0aGUgc3lzdGVtIHN0YXRlIGhhcyBiZWVuIGV4cGxpY2l0bHkgZml4ZWQuIEUuZy4sIGlmIGFuIFwicm1kaXJcIlxyXG4gICAgICogICAgICBmYWlscyBiZWNhdXNlIHRoZSBkaXJlY3RvcnkgaXMgbm9uLWVtcHR5LCBGQUlMRURfUFJFQ09ORElUSU9OXHJcbiAgICAgKiAgICAgIHNob3VsZCBiZSByZXR1cm5lZCBzaW5jZSB0aGUgY2xpZW50IHNob3VsZCBub3QgcmV0cnkgdW5sZXNzXHJcbiAgICAgKiAgICAgIHRoZXkgaGF2ZSBmaXJzdCBmaXhlZCB1cCB0aGUgZGlyZWN0b3J5IGJ5IGRlbGV0aW5nIGZpbGVzIGZyb20gaXQuXHJcbiAgICAgKiAgKGQpIFVzZSBGQUlMRURfUFJFQ09ORElUSU9OIGlmIHRoZSBjbGllbnQgcGVyZm9ybXMgY29uZGl0aW9uYWxcclxuICAgICAqICAgICAgUkVTVCBHZXQvVXBkYXRlL0RlbGV0ZSBvbiBhIHJlc291cmNlIGFuZCB0aGUgcmVzb3VyY2Ugb24gdGhlXHJcbiAgICAgKiAgICAgIHNlcnZlciBkb2VzIG5vdCBtYXRjaCB0aGUgY29uZGl0aW9uLiBFLmcuLCBjb25mbGljdGluZ1xyXG4gICAgICogICAgICByZWFkLW1vZGlmeS13cml0ZSBvbiB0aGUgc2FtZSByZXNvdXJjZS5cclxuICAgICAqL1xyXG4gICAgRkFJTEVEX1BSRUNPTkRJVElPTjogJ2ZhaWxlZC1wcmVjb25kaXRpb24nLFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgb3BlcmF0aW9uIHdhcyBhYm9ydGVkLCB0eXBpY2FsbHkgZHVlIHRvIGEgY29uY3VycmVuY3kgaXNzdWUgbGlrZVxyXG4gICAgICogc2VxdWVuY2VyIGNoZWNrIGZhaWx1cmVzLCB0cmFuc2FjdGlvbiBhYm9ydHMsIGV0Yy5cclxuICAgICAqXHJcbiAgICAgKiBTZWUgbGl0bXVzIHRlc3QgYWJvdmUgZm9yIGRlY2lkaW5nIGJldHdlZW4gRkFJTEVEX1BSRUNPTkRJVElPTiwgQUJPUlRFRCxcclxuICAgICAqIGFuZCBVTkFWQUlMQUJMRS5cclxuICAgICAqL1xyXG4gICAgQUJPUlRFRDogJ2Fib3J0ZWQnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPcGVyYXRpb24gd2FzIGF0dGVtcHRlZCBwYXN0IHRoZSB2YWxpZCByYW5nZS4gRS5nLiwgc2Vla2luZyBvciByZWFkaW5nXHJcbiAgICAgKiBwYXN0IGVuZCBvZiBmaWxlLlxyXG4gICAgICpcclxuICAgICAqIFVubGlrZSBJTlZBTElEX0FSR1VNRU5ULCB0aGlzIGVycm9yIGluZGljYXRlcyBhIHByb2JsZW0gdGhhdCBtYXkgYmUgZml4ZWRcclxuICAgICAqIGlmIHRoZSBzeXN0ZW0gc3RhdGUgY2hhbmdlcy4gRm9yIGV4YW1wbGUsIGEgMzItYml0IGZpbGUgc3lzdGVtIHdpbGxcclxuICAgICAqIGdlbmVyYXRlIElOVkFMSURfQVJHVU1FTlQgaWYgYXNrZWQgdG8gcmVhZCBhdCBhbiBvZmZzZXQgdGhhdCBpcyBub3QgaW4gdGhlXHJcbiAgICAgKiByYW5nZSBbMCwyXjMyLTFdLCBidXQgaXQgd2lsbCBnZW5lcmF0ZSBPVVRfT0ZfUkFOR0UgaWYgYXNrZWQgdG8gcmVhZCBmcm9tXHJcbiAgICAgKiBhbiBvZmZzZXQgcGFzdCB0aGUgY3VycmVudCBmaWxlIHNpemUuXHJcbiAgICAgKlxyXG4gICAgICogVGhlcmUgaXMgYSBmYWlyIGJpdCBvZiBvdmVybGFwIGJldHdlZW4gRkFJTEVEX1BSRUNPTkRJVElPTiBhbmRcclxuICAgICAqIE9VVF9PRl9SQU5HRS4gV2UgcmVjb21tZW5kIHVzaW5nIE9VVF9PRl9SQU5HRSAodGhlIG1vcmUgc3BlY2lmaWMgZXJyb3IpXHJcbiAgICAgKiB3aGVuIGl0IGFwcGxpZXMgc28gdGhhdCBjYWxsZXJzIHdobyBhcmUgaXRlcmF0aW5nIHRocm91Z2ggYSBzcGFjZSBjYW5cclxuICAgICAqIGVhc2lseSBsb29rIGZvciBhbiBPVVRfT0ZfUkFOR0UgZXJyb3IgdG8gZGV0ZWN0IHdoZW4gdGhleSBhcmUgZG9uZS5cclxuICAgICAqL1xyXG4gICAgT1VUX09GX1JBTkdFOiAnb3V0LW9mLXJhbmdlJyxcclxuICAgIC8qKiBPcGVyYXRpb24gaXMgbm90IGltcGxlbWVudGVkIG9yIG5vdCBzdXBwb3J0ZWQvZW5hYmxlZCBpbiB0aGlzIHNlcnZpY2UuICovXHJcbiAgICBVTklNUExFTUVOVEVEOiAndW5pbXBsZW1lbnRlZCcsXHJcbiAgICAvKipcclxuICAgICAqIEludGVybmFsIGVycm9ycy4gTWVhbnMgc29tZSBpbnZhcmlhbnRzIGV4cGVjdGVkIGJ5IHVuZGVybHlpbmcgU3lzdGVtIGhhc1xyXG4gICAgICogYmVlbiBicm9rZW4uIElmIHlvdSBzZWUgb25lIG9mIHRoZXNlIGVycm9ycywgU29tZXRoaW5nIGlzIHZlcnkgYnJva2VuLlxyXG4gICAgICovXHJcbiAgICBJTlRFUk5BTDogJ2ludGVybmFsJyxcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHNlcnZpY2UgaXMgY3VycmVudGx5IHVuYXZhaWxhYmxlLiBUaGlzIGlzIGEgbW9zdCBsaWtlbHkgYSB0cmFuc2llbnRcclxuICAgICAqIGNvbmRpdGlvbiBhbmQgbWF5IGJlIGNvcnJlY3RlZCBieSByZXRyeWluZyB3aXRoIGEgYmFja29mZi5cclxuICAgICAqXHJcbiAgICAgKiBTZWUgbGl0bXVzIHRlc3QgYWJvdmUgZm9yIGRlY2lkaW5nIGJldHdlZW4gRkFJTEVEX1BSRUNPTkRJVElPTiwgQUJPUlRFRCxcclxuICAgICAqIGFuZCBVTkFWQUlMQUJMRS5cclxuICAgICAqL1xyXG4gICAgVU5BVkFJTEFCTEU6ICd1bmF2YWlsYWJsZScsXHJcbiAgICAvKiogVW5yZWNvdmVyYWJsZSBkYXRhIGxvc3Mgb3IgY29ycnVwdGlvbi4gKi9cclxuICAgIERBVEFfTE9TUzogJ2RhdGEtbG9zcydcclxufTtcclxuLyoqXHJcbiAqIEFuIGVycm9yIGNsYXNzIHVzZWQgZm9yIEZpcmVzdG9yZS1nZW5lcmF0ZWQgZXJyb3JzLiBJZGVhbGx5IHdlIHNob3VsZCBiZVxyXG4gKiB1c2luZyBGaXJlYmFzZUVycm9yLCBidXQgaW50ZWdyYXRpbmcgd2l0aCBpdCBpcyBvdmVybHkgYXJkdW91cyBhdCB0aGUgbW9tZW50LFxyXG4gKiBzbyB3ZSBkZWZpbmUgb3VyIG93biBjb21wYXRpYmxlIGVycm9yIGNsYXNzICh3aXRoIGEgYG5hbWVgIG9mICdGaXJlYmFzZUVycm9yJ1xyXG4gKiBhbmQgY29tcGF0aWJsZSBgY29kZWAgYW5kIGBtZXNzYWdlYCBmaWVsZHMuKVxyXG4gKi9cclxudmFyIEZpcmVzdG9yZUVycm9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRmlyZXN0b3JlRXJyb3IsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBGaXJlc3RvcmVFcnJvcihjb2RlLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgbWVzc2FnZSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5jb2RlID0gY29kZTtcclxuICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcclxuICAgICAgICBfdGhpcy5uYW1lID0gJ0ZpcmViYXNlRXJyb3InO1xyXG4gICAgICAgIC8vIEhBQ0s6IFdlIHdyaXRlIGEgdG9TdHJpbmcgcHJvcGVydHkgZGlyZWN0bHkgYmVjYXVzZSBFcnJvciBpcyBub3QgYSByZWFsXHJcbiAgICAgICAgLy8gY2xhc3MgYW5kIHNvIGluaGVyaXRhbmNlIGRvZXMgbm90IHdvcmsgY29ycmVjdGx5LiBXZSBjb3VsZCBhbHRlcm5hdGl2ZWx5XHJcbiAgICAgICAgLy8gZG8gdGhlIHNhbWUgXCJiYWNrLWRvb3IgaW5oZXJpdGFuY2VcIiB0cmljayB0aGF0IEZpcmViYXNlRXJyb3IgZG9lcy5cclxuICAgICAgICBfdGhpcy50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLm5hbWUgKyBcIjogW2NvZGU9XCIgKyBfdGhpcy5jb2RlICsgXCJdOiBcIiArIF90aGlzLm1lc3NhZ2U7IH07XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEZpcmVzdG9yZUVycm9yO1xyXG59KEVycm9yKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogSGVscGVyIGZ1bmN0aW9uIHRvIHByZXZlbnQgaW5zdGFudGlhdGlvbiB0aHJvdWdoIHRoZSBjb25zdHJ1Y3Rvci5cclxuICpcclxuICogVGhpcyBtZXRob2QgY3JlYXRlcyBhIG5ldyBjb25zdHJ1Y3RvciB0aGF0IHRocm93cyB3aGVuIGl0J3MgaW52b2tlZC5cclxuICogVGhlIHByb3RvdHlwZSBvZiB0aGF0IGNvbnN0cnVjdG9yIGlzIHRoZW4gc2V0IHRvIHRoZSBwcm90b3R5cGUgb2YgdGhlIGhpZGRlblxyXG4gKiBcImNsYXNzXCIgdG8gZXhwb3NlIGFsbCB0aGUgcHJvdG90eXBlIG1ldGhvZHMgYW5kIGFsbG93IGZvciBpbnN0YW5jZW9mXHJcbiAqIGNoZWNrcy5cclxuICpcclxuICogVG8gYWxzbyBtYWtlIGFsbCB0aGUgc3RhdGljIG1ldGhvZHMgYXZhaWxhYmxlLCBhbGwgcHJvcGVydGllcyBvZiB0aGVcclxuICogb3JpZ2luYWwgY29uc3RydWN0b3IgYXJlIGNvcGllZCB0byB0aGUgbmV3IGNvbnN0cnVjdG9yLlxyXG4gKi9cclxuZnVuY3Rpb24gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShjbHMsIG9wdGlvbmFsTWVzc2FnZSkge1xyXG4gICAgZnVuY3Rpb24gUHVibGljQ29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdmFyIGVycm9yID0gJ1RoaXMgY29uc3RydWN0b3IgaXMgcHJpdmF0ZS4nO1xyXG4gICAgICAgIGlmIChvcHRpb25hbE1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgZXJyb3IgKz0gJyAnO1xyXG4gICAgICAgICAgICBlcnJvciArPSBvcHRpb25hbE1lc3NhZ2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIGVycm9yKTtcclxuICAgIH1cclxuICAgIC8vIE1ha2Ugc3VyZSBpbnN0YW5jZW9mIGNoZWNrcyB3b3JrIGFuZCBhbGwgbWV0aG9kcyBhcmUgZXhwb3NlZCBvbiB0aGUgcHVibGljXHJcbiAgICAvLyBjb25zdHJ1Y3RvclxyXG4gICAgUHVibGljQ29uc3RydWN0b3IucHJvdG90eXBlID0gY2xzLnByb3RvdHlwZTtcclxuICAgIC8vIENvcHkgYW55IHN0YXRpYyBtZXRob2RzL21lbWJlcnNcclxuICAgIGZvciAodmFyIHN0YXRpY1Byb3BlcnR5IGluIGNscykge1xyXG4gICAgICAgIGlmIChjbHMuaGFzT3duUHJvcGVydHkoc3RhdGljUHJvcGVydHkpKSB7XHJcbiAgICAgICAgICAgIFB1YmxpY0NvbnN0cnVjdG9yW3N0YXRpY1Byb3BlcnR5XSA9IGNsc1tzdGF0aWNQcm9wZXJ0eV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFB1YmxpY0NvbnN0cnVjdG9yO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBjb250YWlucyhvYmosIGtleSkge1xyXG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7XHJcbn1cclxuLyoqIFJldHVybnMgdGhlIGdpdmVuIHZhbHVlIGlmIGl0J3MgZGVmaW5lZCBvciB0aGUgZGVmYXVsdFZhbHVlIG90aGVyd2lzZS4gKi9cclxuZnVuY3Rpb24gZGVmYXVsdGVkKHZhbHVlLCBkZWZhdWx0VmFsdWUpIHtcclxuICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiBkZWZhdWx0VmFsdWU7XHJcbn1cclxuZnVuY3Rpb24gZm9yRWFjaE51bWJlcihvYmosIGZuKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcclxuICAgICAgICAgICAgdmFyIG51bSA9IE51bWJlcihrZXkpO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKG51bSkpIHtcclxuICAgICAgICAgICAgICAgIGZuKG51bSwgb2JqW2tleV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHZhbHVlcyhvYmopIHtcclxuICAgIHZhciB2cyA9IFtdO1xyXG4gICAgZm9yRWFjaChvYmosIGZ1bmN0aW9uIChfLCB2KSB7IHJldHVybiB2cy5wdXNoKHYpOyB9KTtcclxuICAgIHJldHVybiB2cztcclxufVxyXG5mdW5jdGlvbiBmb3JFYWNoKG9iaiwgZm4pIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICBmbihrZXksIG9ialtrZXldKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaXNFbXB0eShvYmopIHtcclxuICAgIGFzc2VydChvYmogIT0gbnVsbCAmJiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JywgJ2lzRW1wdHkoKSBleHBlY3RzIG9iamVjdCBwYXJhbWV0ZXIuJyk7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcbmZ1bmN0aW9uIHNoYWxsb3dDb3B5KG9iaikge1xyXG4gICAgYXNzZXJ0KG9iaiAmJiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JywgJ3NoYWxsb3dDb3B5KCkgZXhwZWN0cyBvYmplY3QgcGFyYW1ldGVyLicpO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gb2JqW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGUgaW52b2NhdGlvbiBvZiBmdW5jdGlvbk5hbWUgaGFzIHRoZSBleGFjdCBudW1iZXIgb2YgYXJndW1lbnRzLlxyXG4gKlxyXG4gKiBGb3J3YXJkIHRoZSBtYWdpYyBcImFyZ3VtZW50c1wiIHZhcmlhYmxlIGFzIHNlY29uZCBwYXJhbWV0ZXIgb24gd2hpY2ggdGhlXHJcbiAqIHBhcmFtZXRlciB2YWxpZGF0aW9uIGlzIHBlcmZvcm1lZDpcclxuICogdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnbXlGdW5jdGlvbicsIGFyZ3VtZW50cywgMik7XHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKGZ1bmN0aW9uTmFtZSwgYXJncywgbnVtYmVyT2ZBcmdzKSB7XHJcbiAgICBpZiAoYXJncy5sZW5ndGggIT09IG51bWJlck9mQXJncykge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIHJlcXVpcmVzIFwiICtcclxuICAgICAgICAgICAgZm9ybWF0UGx1cmFsKG51bWJlck9mQXJncywgJ2FyZ3VtZW50JykgK1xyXG4gICAgICAgICAgICAnLCBidXQgd2FzIGNhbGxlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICBmb3JtYXRQbHVyYWwoYXJncy5sZW5ndGgsICdhcmd1bWVudCcpICtcclxuICAgICAgICAgICAgJy4nKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoZSBpbnZvY2F0aW9uIG9mIGZ1bmN0aW9uTmFtZSBoYXMgYXQgbGVhc3QgdGhlIHByb3ZpZGVkIG51bWJlciBvZlxyXG4gKiBhcmd1bWVudHMgKGJ1dCBjYW4gaGF2ZSBtYW55IG1vcmUpLlxyXG4gKlxyXG4gKiBGb3J3YXJkIHRoZSBtYWdpYyBcImFyZ3VtZW50c1wiIHZhcmlhYmxlIGFzIHNlY29uZCBwYXJhbWV0ZXIgb24gd2hpY2ggdGhlXHJcbiAqIHBhcmFtZXRlciB2YWxpZGF0aW9uIGlzIHBlcmZvcm1lZDpcclxuICogdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdteUZ1bmN0aW9uJywgYXJndW1lbnRzLCAyKTtcclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncyhmdW5jdGlvbk5hbWUsIGFyZ3MsIG1pbk51bWJlck9mQXJncykge1xyXG4gICAgaWYgKGFyZ3MubGVuZ3RoIDwgbWluTnVtYmVyT2ZBcmdzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgcmVxdWlyZXMgYXQgbGVhc3QgXCIgK1xyXG4gICAgICAgICAgICBmb3JtYXRQbHVyYWwobWluTnVtYmVyT2ZBcmdzLCAnYXJndW1lbnQnKSArXHJcbiAgICAgICAgICAgICcsIGJ1dCB3YXMgY2FsbGVkIHdpdGggJyArXHJcbiAgICAgICAgICAgIGZvcm1hdFBsdXJhbChhcmdzLmxlbmd0aCwgJ2FyZ3VtZW50JykgK1xyXG4gICAgICAgICAgICAnLicpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhlIGludm9jYXRpb24gb2YgZnVuY3Rpb25OYW1lIGhhcyBudW1iZXIgb2YgYXJndW1lbnRzIGJldHdlZW5cclxuICogdGhlIHZhbHVlcyBwcm92aWRlZC5cclxuICpcclxuICogRm9yd2FyZCB0aGUgbWFnaWMgXCJhcmd1bWVudHNcIiB2YXJpYWJsZSBhcyBzZWNvbmQgcGFyYW1ldGVyIG9uIHdoaWNoIHRoZVxyXG4gKiBwYXJhbWV0ZXIgdmFsaWRhdGlvbiBpcyBwZXJmb3JtZWQ6XHJcbiAqIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnbXlGdW5jdGlvbicsIGFyZ3VtZW50cywgMiwgMyk7XHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoZnVuY3Rpb25OYW1lLCBhcmdzLCBtaW5OdW1iZXJPZkFyZ3MsIG1heE51bWJlck9mQXJncykge1xyXG4gICAgaWYgKGFyZ3MubGVuZ3RoIDwgbWluTnVtYmVyT2ZBcmdzIHx8IGFyZ3MubGVuZ3RoID4gbWF4TnVtYmVyT2ZBcmdzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgcmVxdWlyZXMgYmV0d2VlbiBcIiArIG1pbk51bWJlck9mQXJncyArIFwiIGFuZCBcIiArXHJcbiAgICAgICAgICAgIChtYXhOdW1iZXJPZkFyZ3MgKyBcIiBhcmd1bWVudHMsIGJ1dCB3YXMgY2FsbGVkIHdpdGggXCIpICtcclxuICAgICAgICAgICAgZm9ybWF0UGx1cmFsKGFyZ3MubGVuZ3RoLCAnYXJndW1lbnQnKSArXHJcbiAgICAgICAgICAgICcuJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGUgcHJvdmlkZWQgYXJndW1lbnQgaXMgYW4gYXJyYXkgYW5kIGhhcyBhcyBsZWFzdCB0aGUgZXhwZWN0ZWRcclxuICogbnVtYmVyIG9mIGVsZW1lbnRzLlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lZEFycmF5QXRMZWFzdE51bWJlck9mRWxlbWVudHMoZnVuY3Rpb25OYW1lLCB2YWx1ZSwgbmFtZSwgbWluTnVtYmVyT2ZFbGVtZW50cykge1xyXG4gICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkgfHwgdmFsdWUubGVuZ3RoIDwgbWluTnVtYmVyT2ZFbGVtZW50cykge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIHJlcXVpcmVzIGl0cyBcIiArIG5hbWUgKyBcIiBhcmd1bWVudCB0byBiZSBhbiBcIiArXHJcbiAgICAgICAgICAgICdhcnJheSB3aXRoIGF0IGxlYXN0ICcgK1xyXG4gICAgICAgICAgICAoZm9ybWF0UGx1cmFsKG1pbk51bWJlck9mRWxlbWVudHMsICdlbGVtZW50JykgKyBcIi5cIikpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhlIHByb3ZpZGVkIHBvc2l0aW9uYWwgYXJndW1lbnQgaGFzIHRoZSBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlXHJcbiAqIHVzaW5nIHR5cGVvZiBjaGVja3MuXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZUFyZ1R5cGUoZnVuY3Rpb25OYW1lLCB0eXBlLCBwb3NpdGlvbiwgYXJndW1lbnQpIHtcclxuICAgIHZhbGlkYXRlVHlwZShmdW5jdGlvbk5hbWUsIHR5cGUsIG9yZGluYWwocG9zaXRpb24pICsgXCIgYXJndW1lbnRcIiwgYXJndW1lbnQpO1xyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhlIHByb3ZpZGVkIGFyZ3VtZW50IGhhcyB0aGUgbmF0aXZlIEphdmFTY3JpcHQgdHlwZSB1c2luZ1xyXG4gKiB0eXBlb2YgY2hlY2tzIG9yIGlzIHVuZGVmaW5lZC5cclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlT3B0aW9uYWxBcmdUeXBlKGZ1bmN0aW9uTmFtZSwgdHlwZSwgcG9zaXRpb24sIGFyZ3VtZW50KSB7XHJcbiAgICBpZiAoYXJndW1lbnQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZShmdW5jdGlvbk5hbWUsIHR5cGUsIHBvc2l0aW9uLCBhcmd1bWVudCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGUgcHJvdmlkZWQgbmFtZWQgb3B0aW9uIGhhcyB0aGUgbmF0aXZlIEphdmFTY3JpcHQgdHlwZSB1c2luZ1xyXG4gKiB0eXBlb2YgY2hlY2tzLlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lZFR5cGUoZnVuY3Rpb25OYW1lLCB0eXBlLCBvcHRpb25OYW1lLCBhcmd1bWVudCkge1xyXG4gICAgdmFsaWRhdGVUeXBlKGZ1bmN0aW9uTmFtZSwgdHlwZSwgb3B0aW9uTmFtZSArIFwiIG9wdGlvblwiLCBhcmd1bWVudCk7XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGUgcHJvdmlkZWQgbmFtZWQgb3B0aW9uIGhhcyB0aGUgbmF0aXZlIEphdmFTY3JpcHQgdHlwZSB1c2luZ1xyXG4gKiB0eXBlb2YgY2hlY2tzIG9yIGlzIHVuZGVmaW5lZC5cclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTmFtZWRPcHRpb25hbFR5cGUoZnVuY3Rpb25OYW1lLCB0eXBlLCBvcHRpb25OYW1lLCBhcmd1bWVudCkge1xyXG4gICAgaWYgKGFyZ3VtZW50ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWxpZGF0ZU5hbWVkVHlwZShmdW5jdGlvbk5hbWUsIHR5cGUsIG9wdGlvbk5hbWUsIGFyZ3VtZW50KTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUFycmF5RWxlbWVudHMoZnVuY3Rpb25OYW1lLCBvcHRpb25OYW1lLCB0eXBlRGVzY3JpcHRpb24sIGFyZ3VtZW50LCB2YWxpZGF0b3IpIHtcclxuICAgIGlmICghKGFyZ3VtZW50IGluc3RhbmNlb2YgQXJyYXkpKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgcmVxdWlyZXMgaXRzIFwiICsgb3B0aW9uTmFtZSArIFwiIFwiICtcclxuICAgICAgICAgICAgKFwib3B0aW9uIHRvIGJlIGFuIGFycmF5LCBidXQgaXQgd2FzOiBcIiArIHZhbHVlRGVzY3JpcHRpb24oYXJndW1lbnQpKSk7XHJcbiAgICB9XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50Lmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgaWYgKCF2YWxpZGF0b3IoYXJndW1lbnRbaV0pKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIHJlcXVpcmVzIGFsbCBcIiArIG9wdGlvbk5hbWUgKyBcIiBcIiArXHJcbiAgICAgICAgICAgICAgICAoXCJlbGVtZW50cyB0byBiZSBcIiArIHR5cGVEZXNjcmlwdGlvbiArIFwiLCBidXQgdGhlIHZhbHVlIGF0IGluZGV4IFwiICsgaSArIFwiIFwiKSArXHJcbiAgICAgICAgICAgICAgICAoXCJ3YXM6IFwiICsgdmFsdWVEZXNjcmlwdGlvbihhcmd1bWVudFtpXSkpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVPcHRpb25hbEFycmF5RWxlbWVudHMoZnVuY3Rpb25OYW1lLCBvcHRpb25OYW1lLCB0eXBlRGVzY3JpcHRpb24sIGFyZ3VtZW50LCB2YWxpZGF0b3IpIHtcclxuICAgIGlmIChhcmd1bWVudCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsaWRhdGVBcnJheUVsZW1lbnRzKGZ1bmN0aW9uTmFtZSwgb3B0aW9uTmFtZSwgdHlwZURlc2NyaXB0aW9uLCBhcmd1bWVudCwgdmFsaWRhdG9yKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoYXQgdGhlIHByb3ZpZGVkIG5hbWVkIG9wdGlvbiBlcXVhbHMgb25lIG9mIHRoZSBleHBlY3RlZCB2YWx1ZXMuXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVkUHJvcGVydHlFcXVhbHMoZnVuY3Rpb25OYW1lLCBpbnB1dE5hbWUsIG9wdGlvbk5hbWUsIGlucHV0LCBleHBlY3RlZCkge1xyXG4gICAgdmFyIGV4cGVjdGVkRGVzY3JpcHRpb24gPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMCwgZXhwZWN0ZWRfMSA9IGV4cGVjdGVkOyBfaSA8IGV4cGVjdGVkXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIHZhbCA9IGV4cGVjdGVkXzFbX2ldO1xyXG4gICAgICAgIGlmICh2YWwgPT09IGlucHV0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwZWN0ZWREZXNjcmlwdGlvbi5wdXNoKHZhbHVlRGVzY3JpcHRpb24odmFsKSk7XHJcbiAgICB9XHJcbiAgICB2YXIgYWN0dWFsRGVzY3JpcHRpb24gPSB2YWx1ZURlc2NyaXB0aW9uKGlucHV0KTtcclxuICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCB2YWx1ZSBcIiArIGFjdHVhbERlc2NyaXB0aW9uICsgXCIgcHJvdmlkZWQgdG8gZnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIGZvciBvcHRpb24gXCIgK1xyXG4gICAgICAgIChcIlxcXCJcIiArIG9wdGlvbk5hbWUgKyBcIlxcXCIuIEFjY2VwdGFibGUgdmFsdWVzOiBcIiArIGV4cGVjdGVkRGVzY3JpcHRpb24uam9pbignLCAnKSkpO1xyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhhdCB0aGUgcHJvdmlkZWQgbmFtZWQgb3B0aW9uIGVxdWFscyBvbmUgb2YgdGhlIGV4cGVjdGVkIHZhbHVlcyBvclxyXG4gKiBpcyB1bmRlZmluZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxQcm9wZXJ0eUVxdWFscyhmdW5jdGlvbk5hbWUsIGlucHV0TmFtZSwgb3B0aW9uTmFtZSwgaW5wdXQsIGV4cGVjdGVkKSB7XHJcbiAgICBpZiAoaW5wdXQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbGlkYXRlTmFtZWRQcm9wZXJ0eUVxdWFscyhmdW5jdGlvbk5hbWUsIGlucHV0TmFtZSwgb3B0aW9uTmFtZSwgaW5wdXQsIGV4cGVjdGVkKTtcclxuICAgIH1cclxufVxyXG4vKiogSGVscGVyIHRvIHZhbGlkYXRlIHRoZSB0eXBlIG9mIGEgcHJvdmlkZWQgaW5wdXQuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlVHlwZShmdW5jdGlvbk5hbWUsIHR5cGUsIGlucHV0TmFtZSwgaW5wdXQpIHtcclxuICAgIHZhciB2YWxpZCA9IGZhbHNlO1xyXG4gICAgaWYgKHR5cGUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgdmFsaWQgPSBpc1BsYWluT2JqZWN0KGlucHV0KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGUgPT09ICdub24tZW1wdHkgc3RyaW5nJykge1xyXG4gICAgICAgIHZhbGlkID0gdHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJyAmJiBpbnB1dCAhPT0gJyc7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2YWxpZCA9IHR5cGVvZiBpbnB1dCA9PT0gdHlwZTtcclxuICAgIH1cclxuICAgIGlmICghdmFsaWQpIHtcclxuICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSB2YWx1ZURlc2NyaXB0aW9uKGlucHV0KTtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSByZXF1aXJlcyBpdHMgXCIgKyBpbnB1dE5hbWUgKyBcIiBcIiArXHJcbiAgICAgICAgICAgIChcInRvIGJlIG9mIHR5cGUgXCIgKyB0eXBlICsgXCIsIGJ1dCBpdCB3YXM6IFwiICsgZGVzY3JpcHRpb24pKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogUmV0dXJucyB0cnVlIGlmIGl0J3MgYSBub24tbnVsbCBvYmplY3Qgd2l0aG91dCBhIGN1c3RvbSBwcm90b3R5cGVcclxuICogKGkuZS4gZXhjbHVkZXMgQXJyYXksIERhdGUsIGV0Yy4pLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNQbGFpbk9iamVjdChpbnB1dCkge1xyXG4gICAgcmV0dXJuICh0eXBlb2YgaW5wdXQgPT09ICdvYmplY3QnICYmXHJcbiAgICAgICAgaW5wdXQgIT09IG51bGwgJiZcclxuICAgICAgICAoT2JqZWN0LmdldFByb3RvdHlwZU9mKGlucHV0KSA9PT0gT2JqZWN0LnByb3RvdHlwZSB8fFxyXG4gICAgICAgICAgICBPYmplY3QuZ2V0UHJvdG90eXBlT2YoaW5wdXQpID09PSBudWxsKSk7XHJcbn1cclxuLyoqIFJldHVybnMgYSBzdHJpbmcgZGVzY3JpYmluZyB0aGUgdHlwZSAvIHZhbHVlIG9mIHRoZSBwcm92aWRlZCBpbnB1dC4gKi9cclxuZnVuY3Rpb24gdmFsdWVEZXNjcmlwdGlvbihpbnB1dCkge1xyXG4gICAgaWYgKGlucHV0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4gJ3VuZGVmaW5lZCc7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpbnB1dCA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiAnbnVsbCc7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgaWYgKGlucHV0Lmxlbmd0aCA+IDIwKSB7XHJcbiAgICAgICAgICAgIGlucHV0ID0gaW5wdXQuc3Vic3RyaW5nKDAsIDIwKSArIFwiLi4uXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShpbnB1dCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdudW1iZXInIHx8IHR5cGVvZiBpbnB1dCA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgcmV0dXJuICcnICsgaW5wdXQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgaWYgKGlucHV0IGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdhbiBhcnJheSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgY3VzdG9tT2JqZWN0TmFtZSA9IHRyeUdldEN1c3RvbU9iamVjdFR5cGUoaW5wdXQpO1xyXG4gICAgICAgICAgICBpZiAoY3VzdG9tT2JqZWN0TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiYSBjdXN0b20gXCIgKyBjdXN0b21PYmplY3ROYW1lICsgXCIgb2JqZWN0XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2FuIG9iamVjdCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICByZXR1cm4gJ2EgZnVuY3Rpb24nO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gd3JvbmcgdHlwZTogJyArIHR5cGVvZiBpbnB1dCk7XHJcbiAgICB9XHJcbn1cclxuLyoqIEhhY2t5IG1ldGhvZCB0byB0cnkgdG8gZ2V0IHRoZSBjb25zdHJ1Y3RvciBuYW1lIGZvciBhbiBvYmplY3QuICovXHJcbmZ1bmN0aW9uIHRyeUdldEN1c3RvbU9iamVjdFR5cGUoaW5wdXQpIHtcclxuICAgIGlmIChpbnB1dC5jb25zdHJ1Y3Rvcikge1xyXG4gICAgICAgIHZhciBmdW5jTmFtZVJlZ2V4ID0gL2Z1bmN0aW9uXFxzKyhbXlxccyhdKylcXHMqXFwoLztcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IGZ1bmNOYW1lUmVnZXguZXhlYyhpbnB1dC5jb25zdHJ1Y3Rvci50b1N0cmluZygpKTtcclxuICAgICAgICBpZiAocmVzdWx0cyAmJiByZXN1bHRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHNbMV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuLyoqIFZhbGlkYXRlcyB0aGUgcHJvdmlkZWQgYXJndW1lbnQgaXMgZGVmaW5lZC4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVEZWZpbmVkKGZ1bmN0aW9uTmFtZSwgcG9zaXRpb24sIGFyZ3VtZW50KSB7XHJcbiAgICBpZiAoYXJndW1lbnQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIHJlcXVpcmVzIGEgdmFsaWQgXCIgKyBvcmRpbmFsKHBvc2l0aW9uKSArIFwiIFwiICtcclxuICAgICAgICAgICAgXCJhcmd1bWVudCwgYnV0IGl0IHdhcyB1bmRlZmluZWQuXCIpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhlIHByb3ZpZGVkIHBvc2l0aW9uYWwgYXJndW1lbnQgaXMgYW4gb2JqZWN0LCBhbmQgaXRzIGtleXMgYW5kXHJcbiAqIHZhbHVlcyBtYXRjaCB0aGUgZXhwZWN0ZWQga2V5cyBhbmQgdHlwZXMgcHJvdmlkZWQgaW4gb3B0aW9uVHlwZXMuXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU9wdGlvbk5hbWVzKGZ1bmN0aW9uTmFtZSwgb3B0aW9ucywgb3B0aW9uTmFtZXMpIHtcclxuICAgIGZvckVhY2gob3B0aW9ucywgZnVuY3Rpb24gKGtleSwgXykge1xyXG4gICAgICAgIGlmIChvcHRpb25OYW1lcy5pbmRleE9mKGtleSkgPCAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiVW5rbm93biBvcHRpb24gJ1wiICsga2V5ICsgXCInIHBhc3NlZCB0byBmdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkuIFwiICtcclxuICAgICAgICAgICAgICAgICdBdmFpbGFibGUgb3B0aW9uczogJyArXHJcbiAgICAgICAgICAgICAgICBvcHRpb25OYW1lcy5qb2luKCcsICcpKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICogSGVscGVyIG1ldGhvZCB0byB0aHJvdyBhbiBlcnJvciB0aGF0IHRoZSBwcm92aWRlZCBhcmd1bWVudCBkaWQgbm90IHBhc3NcclxuICogYW4gaW5zdGFuY2VvZiBjaGVjay5cclxuICovXHJcbmZ1bmN0aW9uIGludmFsaWRDbGFzc0Vycm9yKGZ1bmN0aW9uTmFtZSwgdHlwZSwgcG9zaXRpb24sIGFyZ3VtZW50KSB7XHJcbiAgICB2YXIgZGVzY3JpcHRpb24gPSB2YWx1ZURlc2NyaXB0aW9uKGFyZ3VtZW50KTtcclxuICAgIHJldHVybiBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSByZXF1aXJlcyBpdHMgXCIgKyBvcmRpbmFsKHBvc2l0aW9uKSArIFwiIFwiICtcclxuICAgICAgICAoXCJhcmd1bWVudCB0byBiZSBhIFwiICsgdHlwZSArIFwiLCBidXQgaXQgd2FzOiBcIiArIGRlc2NyaXB0aW9uKSk7XHJcbn1cclxuLyoqIENvbnZlcnRzIGEgbnVtYmVyIHRvIGl0cyBlbmdsaXNoIHdvcmQgcmVwcmVzZW50YXRpb24gKi9cclxuZnVuY3Rpb24gb3JkaW5hbChudW0pIHtcclxuICAgIHN3aXRjaCAobnVtKSB7XHJcbiAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICByZXR1cm4gJ2ZpcnN0JztcclxuICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgIHJldHVybiAnc2Vjb25kJztcclxuICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgIHJldHVybiAndGhpcmQnO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBudW0gKyAndGgnO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBGb3JtYXRzIHRoZSBnaXZlbiB3b3JkIGFzIHBsdXJhbCBjb25kaXRpb25hbGx5IGdpdmVuIHRoZSBwcmVjZWRpbmcgbnVtYmVyLlxyXG4gKi9cclxuZnVuY3Rpb24gZm9ybWF0UGx1cmFsKG51bSwgc3RyKSB7XHJcbiAgICByZXR1cm4gbnVtICsgXCIgXCIgKyBzdHIgKyAobnVtID09PSAxID8gJycgOiAncycpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y2xhc3MtYXMtbmFtZXNwYWNlXHJcbnZhciBBdXRvSWQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBdXRvSWQoKSB7XHJcbiAgICB9XHJcbiAgICBBdXRvSWQubmV3SWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gQWxwaGFudW1lcmljIGNoYXJhY3RlcnNcclxuICAgICAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODknO1xyXG4gICAgICAgIHZhciBhdXRvSWQgPSAnJztcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDIwOyBpKyspIHtcclxuICAgICAgICAgICAgYXV0b0lkICs9IGNoYXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjaGFycy5sZW5ndGgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYXNzZXJ0KGF1dG9JZC5sZW5ndGggPT09IDIwLCAnSW52YWxpZCBhdXRvIElEOiAnICsgYXV0b0lkKTtcclxuICAgICAgICByZXR1cm4gYXV0b0lkO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBdXRvSWQ7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIHByaW1pdGl2ZUNvbXBhcmF0b3IobGVmdCwgcmlnaHQpIHtcclxuICAgIGlmIChsZWZ0IDwgcmlnaHQpXHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgaWYgKGxlZnQgPiByaWdodClcclxuICAgICAgICByZXR1cm4gMTtcclxuICAgIHJldHVybiAwO1xyXG59XHJcbi8qKiBIZWxwZXIgdG8gY29tcGFyZSBudWxsYWJsZSAob3IgdW5kZWZpbmVkLWFibGUpIG9iamVjdHMgdXNpbmcgaXNFcXVhbCgpLiAqL1xyXG5mdW5jdGlvbiBlcXVhbHMobGVmdCwgcmlnaHQpIHtcclxuICAgIGlmIChsZWZ0ICE9PSBudWxsICYmIGxlZnQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiAhIShyaWdodCAmJiBsZWZ0LmlzRXF1YWwocmlnaHQpKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIEhBQ0s6IEV4cGxpY2l0bHkgY2FzdCBzaW5jZSBUeXBlU2NyaXB0J3MgdHlwZSBuYXJyb3dpbmcgYXBwYXJlbnRseSBpc24ndFxyXG4gICAgICAgIC8vIHNtYXJ0IGVub3VnaC5cclxuICAgICAgICByZXR1cm4gbGVmdCA9PT0gcmlnaHQ7XHJcbiAgICB9XHJcbn1cclxuLyoqIEhlbHBlciB0byBjb21wYXJlIGFycmF5cyB1c2luZyBpc0VxdWFsKCkuICovXHJcbmZ1bmN0aW9uIGFycmF5RXF1YWxzKGxlZnQsIHJpZ2h0KSB7XHJcbiAgICBpZiAobGVmdC5sZW5ndGggIT09IHJpZ2h0Lmxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVmdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmICghbGVmdFtpXS5pc0VxdWFsKHJpZ2h0W2ldKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgdGhlIGltbWVkaWF0ZSBsZXhpY29ncmFwaGljYWxseS1mb2xsb3dpbmcgc3RyaW5nLiBUaGlzIGlzIHVzZWZ1bCB0b1xyXG4gKiBjb25zdHJ1Y3QgYW4gaW5jbHVzaXZlIHJhbmdlIGZvciBpbmRleGVkZGIgaXRlcmF0b3JzLlxyXG4gKi9cclxuZnVuY3Rpb24gaW1tZWRpYXRlU3VjY2Vzc29yKHMpIHtcclxuICAgIC8vIFJldHVybiB0aGUgaW5wdXQgc3RyaW5nLCB3aXRoIGFuIGFkZGl0aW9uYWwgTlVMIGJ5dGUgYXBwZW5kZWQuXHJcbiAgICByZXR1cm4gcyArICdcXDAnO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKiogSGVscGVyIGZ1bmN0aW9uIHRvIGFzc2VydCBVaW50OEFycmF5IGlzIGF2YWlsYWJsZSBhdCBydW50aW1lLiAqL1xyXG5mdW5jdGlvbiBhc3NlcnRVaW50OEFycmF5QXZhaWxhYmxlKCkge1xyXG4gICAgaWYgKHR5cGVvZiBVaW50OEFycmF5ID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOSU1QTEVNRU5URUQsICdVaW50OEFycmF5cyBhcmUgbm90IGF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50LicpO1xyXG4gICAgfVxyXG59XHJcbi8qKiBIZWxwZXIgZnVuY3Rpb24gdG8gYXNzZXJ0IEJhc2U2NCBmdW5jdGlvbnMgYXJlIGF2YWlsYWJsZSBhdCBydW50aW1lLiAqL1xyXG5mdW5jdGlvbiBhc3NlcnRCYXNlNjRBdmFpbGFibGUoKSB7XHJcbiAgICBpZiAoIVBsYXRmb3JtU3VwcG9ydC5nZXRQbGF0Zm9ybSgpLmJhc2U2NEF2YWlsYWJsZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOSU1QTEVNRU5URUQsICdCbG9icyBhcmUgdW5hdmFpbGFibGUgaW4gRmlyZXN0b3JlIGluIHRoaXMgZW52aXJvbm1lbnQuJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEltbXV0YWJsZSBjbGFzcyBob2xkaW5nIGEgYmxvYiAoYmluYXJ5IGRhdGEpLlxyXG4gKiBUaGlzIGNsYXNzIGlzIGRpcmVjdGx5IGV4cG9zZWQgaW4gdGhlIHB1YmxpYyBBUEkuXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCB3aGlsZSB5b3UgY2FuJ3QgaGlkZSB0aGUgY29uc3RydWN0b3IgaW4gSmF2YVNjcmlwdCBjb2RlLCB3ZSBhcmVcclxuICogdXNpbmcgdGhlIGhhY2sgYWJvdmUgdG8gbWFrZSBzdXJlIG5vLW9uZSBvdXRzaWRlIHRoaXMgbW9kdWxlIGNhbiBjYWxsIGl0LlxyXG4gKi9cclxudmFyIEJsb2IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCbG9iKGJpbmFyeVN0cmluZykge1xyXG4gICAgICAgIGFzc2VydEJhc2U2NEF2YWlsYWJsZSgpO1xyXG4gICAgICAgIHRoaXMuX2JpbmFyeVN0cmluZyA9IGJpbmFyeVN0cmluZztcclxuICAgIH1cclxuICAgIEJsb2IuZnJvbUJhc2U2NFN0cmluZyA9IGZ1bmN0aW9uIChiYXNlNjQpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdCbG9iLmZyb21CYXNlNjRTdHJpbmcnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnQmxvYi5mcm9tQmFzZTY0U3RyaW5nJywgJ3N0cmluZycsIDEsIGJhc2U2NCk7XHJcbiAgICAgICAgYXNzZXJ0QmFzZTY0QXZhaWxhYmxlKCk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIGJpbmFyeVN0cmluZyA9IFBsYXRmb3JtU3VwcG9ydC5nZXRQbGF0Zm9ybSgpLmF0b2IoYmFzZTY0KTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBCbG9iKGJpbmFyeVN0cmluZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdGYWlsZWQgdG8gY29uc3RydWN0IEJsb2IgZnJvbSBCYXNlNjQgc3RyaW5nOiAnICsgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEJsb2IuZnJvbVVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYXJyYXkpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdCbG9iLmZyb21VaW50OEFycmF5JywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICBhc3NlcnRVaW50OEFycmF5QXZhaWxhYmxlKCk7XHJcbiAgICAgICAgaWYgKCEoYXJyYXkgaW5zdGFuY2VvZiBVaW50OEFycmF5KSkge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkQ2xhc3NFcnJvcignQmxvYi5mcm9tVWludDhBcnJheScsICdVaW50OEFycmF5JywgMSwgYXJyYXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBXZSBjYW4ndCBjYWxsIGFycmF5Lm1hcCBkaXJlY3RseSBiZWNhdXNlIGl0IGV4cGVjdHMgdGhlIHJldHVybiB0eXBlIHRvXHJcbiAgICAgICAgLy8gYmUgYSBVaW50OEFycmF5LCB3aGVyZWFzIHdlIGNhbiBjb252ZXJ0IGl0IHRvIGEgcmVndWxhciBhcnJheSBieSBpbnZva2luZ1xyXG4gICAgICAgIC8vIG1hcCBvbiB0aGUgQXJyYXkgcHJvdG90eXBlLlxyXG4gICAgICAgIHZhciBiaW5hcnlTdHJpbmcgPSBBcnJheS5wcm90b3R5cGUubWFwXHJcbiAgICAgICAgICAgIC5jYWxsKGFycmF5LCBmdW5jdGlvbiAoY2hhcikge1xyXG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaGFyKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuam9pbignJyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBCbG9iKGJpbmFyeVN0cmluZyk7XHJcbiAgICB9O1xyXG4gICAgQmxvYi5wcm90b3R5cGUudG9CYXNlNjQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnQmxvYi50b0Jhc2U2NCcsIGFyZ3VtZW50cywgMCk7XHJcbiAgICAgICAgYXNzZXJ0QmFzZTY0QXZhaWxhYmxlKCk7XHJcbiAgICAgICAgcmV0dXJuIFBsYXRmb3JtU3VwcG9ydC5nZXRQbGF0Zm9ybSgpLmJ0b2EodGhpcy5fYmluYXJ5U3RyaW5nKTtcclxuICAgIH07XHJcbiAgICBCbG9iLnByb3RvdHlwZS50b1VpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnQmxvYi50b1VpbnQ4QXJyYXknLCBhcmd1bWVudHMsIDApO1xyXG4gICAgICAgIGFzc2VydFVpbnQ4QXJyYXlBdmFpbGFibGUoKTtcclxuICAgICAgICB2YXIgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fYmluYXJ5U3RyaW5nLmxlbmd0aCk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9iaW5hcnlTdHJpbmcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYnVmZmVyW2ldID0gdGhpcy5fYmluYXJ5U3RyaW5nLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBidWZmZXI7XHJcbiAgICB9O1xyXG4gICAgQmxvYi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICdCbG9iKGJhc2U2NDogJyArIHRoaXMudG9CYXNlNjQoKSArICcpJztcclxuICAgIH07XHJcbiAgICBCbG9iLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2JpbmFyeVN0cmluZyA9PT0gb3RoZXIuX2JpbmFyeVN0cmluZztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFjdHVhbGx5IHByaXZhdGUgdG8gSlMgY29uc3VtZXJzIG9mIG91ciBBUEksIHNvIHRoaXMgZnVuY3Rpb24gaXMgcHJlZml4ZWRcclxuICAgICAqIHdpdGggYW4gdW5kZXJzY29yZS5cclxuICAgICAqL1xyXG4gICAgQmxvYi5wcm90b3R5cGUuX2NvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiBwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMuX2JpbmFyeVN0cmluZywgb3RoZXIuX2JpbmFyeVN0cmluZyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJsb2I7XHJcbn0oKSk7XHJcbi8vIFB1YmxpYyBpbnN0YW5jZSB0aGF0IGRpc2FsbG93cyBjb25zdHJ1Y3Rpb24gYXQgcnVudGltZS4gVGhpcyBjb25zdHJ1Y3RvciBpc1xyXG4vLyB1c2VkIHdoZW4gZXhwb3J0aW5nIEJsb2Igb24gZmlyZWJhc2UuZmlyZXN0b3JlLkJsb2IgYW5kIHdpbGwgYmUgY2FsbGVkIEJsb2JcclxuLy8gcHVibGljbHkuIEludGVybmFsbHkgd2Ugc3RpbGwgdXNlIEJsb2Igd2hpY2ggaGFzIGEgdHlwZSBjaGVja2VkIHByaXZhdGVcclxuLy8gY29uc3RydWN0b3IuIE5vdGUgdGhhdCBCbG9iIGFuZCBQdWJsaWNCbG9iIGNhbiBiZSB1c2VkIGludGVyY2hhbmdlYWJseSBpblxyXG4vLyBpbnN0YW5jZW9mIGNoZWNrcy5cclxuLy8gRm9yIG91ciBpbnRlcm5hbCBUeXBlU2NyaXB0IGNvZGUgUHVibGljQmxvYiBkb2Vzbid0IGV4aXN0IGFzIGEgdHlwZSwgYW5kIHNvXHJcbi8vIHdlIG5lZWQgdG8gdXNlIEJsb2IgYXMgdHlwZSBhbmQgZXhwb3J0IGl0IHRvby5cclxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnZhcmlhYmxlLW5hbWUgV2UncmUgdHJlYXRpbmcgdGhpcyBhcyBhIGNsYXNzIG5hbWUuXHJcbnZhciBQdWJsaWNCbG9iID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShCbG9iLCAnVXNlIEJsb2IuZnJvbVVpbnQ4QXJyYXkoKSBvciBCbG9iLmZyb21CYXNlNjRTdHJpbmcoKSBpbnN0ZWFkLicpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEltbXV0YWJsZSBjbGFzcyByZXByZXNlbnRpbmcgYSBnZW8gcG9pbnQgYXMgbGF0aXR1ZGUtbG9uZ2l0dWRlIHBhaXIuXHJcbiAqIFRoaXMgY2xhc3MgaXMgZGlyZWN0bHkgZXhwb3NlZCBpbiB0aGUgcHVibGljIEFQSSwgaW5jbHVkaW5nIGl0cyBjb25zdHJ1Y3Rvci5cclxuICovXHJcbnZhciBHZW9Qb2ludCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEdlb1BvaW50KGxhdGl0dWRlLCBsb25naXR1ZGUpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdHZW9Qb2ludCcsIGFyZ3VtZW50cywgMik7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdHZW9Qb2ludCcsICdudW1iZXInLCAxLCBsYXRpdHVkZSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdHZW9Qb2ludCcsICdudW1iZXInLCAyLCBsb25naXR1ZGUpO1xyXG4gICAgICAgIGlmICghaXNGaW5pdGUobGF0aXR1ZGUpIHx8IGxhdGl0dWRlIDwgLTkwIHx8IGxhdGl0dWRlID4gOTApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0xhdGl0dWRlIG11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAtOTAgYW5kIDkwLCBidXQgd2FzOiAnICsgbGF0aXR1ZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWlzRmluaXRlKGxvbmdpdHVkZSkgfHwgbG9uZ2l0dWRlIDwgLTE4MCB8fCBsb25naXR1ZGUgPiAxODApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0xvbmdpdHVkZSBtdXN0IGJlIGEgbnVtYmVyIGJldHdlZW4gLTE4MCBhbmQgMTgwLCBidXQgd2FzOiAnICsgbG9uZ2l0dWRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbGF0ID0gbGF0aXR1ZGU7XHJcbiAgICAgICAgdGhpcy5fbG9uZyA9IGxvbmdpdHVkZTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHZW9Qb2ludC5wcm90b3R5cGUsIFwibGF0aXR1ZGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgdGhlIGxhdGl0dWRlIG9mIHRoaXMgZ2VvIHBvaW50LCBhIG51bWJlciBiZXR3ZWVuIC05MCBhbmQgOTAuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sYXQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VvUG9pbnQucHJvdG90eXBlLCBcImxvbmdpdHVkZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJucyB0aGUgbG9uZ2l0dWRlIG9mIHRoaXMgZ2VvIHBvaW50LCBhIG51bWJlciBiZXR3ZWVuIC0xODAgYW5kIDE4MC5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvbmc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBHZW9Qb2ludC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9sYXQgPT09IG90aGVyLl9sYXQgJiYgdGhpcy5fbG9uZyA9PT0gb3RoZXIuX2xvbmc7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBY3R1YWxseSBwcml2YXRlIHRvIEpTIGNvbnN1bWVycyBvZiBvdXIgQVBJLCBzbyB0aGlzIGZ1bmN0aW9uIGlzIHByZWZpeGVkXHJcbiAgICAgKiB3aXRoIGFuIHVuZGVyc2NvcmUuXHJcbiAgICAgKi9cclxuICAgIEdlb1BvaW50LnByb3RvdHlwZS5fY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMuX2xhdCwgb3RoZXIuX2xhdCkgfHxcclxuICAgICAgICAgICAgcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLl9sb25nLCBvdGhlci5fbG9uZykpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBHZW9Qb2ludDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBUaW1lc3RhbXAgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUaW1lc3RhbXAoc2Vjb25kcywgbmFub3NlY29uZHMpIHtcclxuICAgICAgICB0aGlzLnNlY29uZHMgPSBzZWNvbmRzO1xyXG4gICAgICAgIHRoaXMubmFub3NlY29uZHMgPSBuYW5vc2Vjb25kcztcclxuICAgICAgICBpZiAobmFub3NlY29uZHMgPCAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdUaW1lc3RhbXAgbmFub3NlY29uZHMgb3V0IG9mIHJhbmdlOiAnICsgbmFub3NlY29uZHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmFub3NlY29uZHMgPj0gMWU5KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdUaW1lc3RhbXAgbmFub3NlY29uZHMgb3V0IG9mIHJhbmdlOiAnICsgbmFub3NlY29uZHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBNaWRuaWdodCBhdCB0aGUgYmVnaW5uaW5nIG9mIDEvMS8xIGlzIHRoZSBlYXJsaWVzdCBGaXJlc3RvcmUgc3VwcG9ydHMuXHJcbiAgICAgICAgaWYgKHNlY29uZHMgPCAtNjIxMzU1OTY4MDApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1RpbWVzdGFtcCBzZWNvbmRzIG91dCBvZiByYW5nZTogJyArIHNlY29uZHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUaGlzIHdpbGwgYnJlYWsgaW4gdGhlIHllYXIgMTAsMDAwLlxyXG4gICAgICAgIGlmIChzZWNvbmRzID49IDI1MzQwMjMwMDgwMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnVGltZXN0YW1wIHNlY29uZHMgb3V0IG9mIHJhbmdlOiAnICsgc2Vjb25kcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgVGltZXN0YW1wLm5vdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gVGltZXN0YW1wLmZyb21NaWxsaXMoRGF0ZS5ub3coKSk7XHJcbiAgICB9O1xyXG4gICAgVGltZXN0YW1wLmZyb21EYXRlID0gZnVuY3Rpb24gKGRhdGUpIHtcclxuICAgICAgICByZXR1cm4gVGltZXN0YW1wLmZyb21NaWxsaXMoZGF0ZS5nZXRUaW1lKCkpO1xyXG4gICAgfTtcclxuICAgIFRpbWVzdGFtcC5mcm9tTWlsbGlzID0gZnVuY3Rpb24gKG1pbGxpc2Vjb25kcykge1xyXG4gICAgICAgIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcihtaWxsaXNlY29uZHMgLyAxMDAwKTtcclxuICAgICAgICB2YXIgbmFub3MgPSAobWlsbGlzZWNvbmRzIC0gc2Vjb25kcyAqIDEwMDApICogMWU2O1xyXG4gICAgICAgIHJldHVybiBuZXcgVGltZXN0YW1wKHNlY29uZHMsIG5hbm9zKTtcclxuICAgIH07XHJcbiAgICBUaW1lc3RhbXAucHJvdG90eXBlLnRvRGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERhdGUodGhpcy50b01pbGxpcygpKTtcclxuICAgIH07XHJcbiAgICBUaW1lc3RhbXAucHJvdG90eXBlLnRvTWlsbGlzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNlY29uZHMgKiAxMDAwICsgdGhpcy5uYW5vc2Vjb25kcyAvIDFlNjtcclxuICAgIH07XHJcbiAgICBUaW1lc3RhbXAucHJvdG90eXBlLl9jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5zZWNvbmRzID09PSBvdGhlci5zZWNvbmRzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMubmFub3NlY29uZHMsIG90aGVyLm5hbm9zZWNvbmRzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5zZWNvbmRzLCBvdGhlci5zZWNvbmRzKTtcclxuICAgIH07XHJcbiAgICBUaW1lc3RhbXAucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyLnNlY29uZHMgPT09IHRoaXMuc2Vjb25kcyAmJiBvdGhlci5uYW5vc2Vjb25kcyA9PT0gdGhpcy5uYW5vc2Vjb25kcyk7XHJcbiAgICB9O1xyXG4gICAgVGltZXN0YW1wLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKCdUaW1lc3RhbXAoc2Vjb25kcz0nICtcclxuICAgICAgICAgICAgdGhpcy5zZWNvbmRzICtcclxuICAgICAgICAgICAgJywgbmFub3NlY29uZHM9JyArXHJcbiAgICAgICAgICAgIHRoaXMubmFub3NlY29uZHMgK1xyXG4gICAgICAgICAgICAnKScpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUaW1lc3RhbXA7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRGF0YWJhc2VJbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RzIGEgRGF0YWJhc2VJbmZvIHVzaW5nIHRoZSBwcm92aWRlZCBob3N0LCBkYXRhYmFzZUlkIGFuZFxyXG4gICAgICogcGVyc2lzdGVuY2VLZXkuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGRhdGFiYXNlSWQgVGhlIGRhdGFiYXNlIHRvIHVzZS5cclxuICAgICAqIEBwYXJhbSBwZXJzaXN0ZW5jZUtleSBBIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGlzIEZpcmVzdG9yZSdzIGxvY2FsXHJcbiAgICAgKiBzdG9yYWdlICh1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggdGhlIGRhdGFiYXNlSWQpLlxyXG4gICAgICogQHBhcmFtIGhvc3QgVGhlIEZpcmVzdG9yZSBiYWNrZW5kIGhvc3QgdG8gY29ubmVjdCB0by5cclxuICAgICAqIEBwYXJhbSBzc2wgV2hldGhlciB0byB1c2UgU1NMIHdoZW4gY29ubmVjdGluZy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gRGF0YWJhc2VJbmZvKGRhdGFiYXNlSWQsIHBlcnNpc3RlbmNlS2V5LCBob3N0LCBzc2wpIHtcclxuICAgICAgICB0aGlzLmRhdGFiYXNlSWQgPSBkYXRhYmFzZUlkO1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2VLZXkgPSBwZXJzaXN0ZW5jZUtleTtcclxuICAgICAgICB0aGlzLmhvc3QgPSBob3N0O1xyXG4gICAgICAgIHRoaXMuc3NsID0gc3NsO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIERhdGFiYXNlSW5mbztcclxufSgpKTtcclxuLyoqIFRoZSBkZWZhdWx0IGRhdGFiYXNlIG5hbWUgZm9yIGEgcHJvamVjdC4gKi9cclxudmFyIERFRkFVTFRfREFUQUJBU0VfTkFNRSA9ICcoZGVmYXVsdCknO1xyXG4vKiogUmVwcmVzZW50cyB0aGUgZGF0YWJhc2UgSUQgYSBGaXJlc3RvcmUgY2xpZW50IGlzIGFzc29jaWF0ZWQgd2l0aC4gKi9cclxudmFyIERhdGFiYXNlSWQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYXRhYmFzZUlkKHByb2plY3RJZCwgZGF0YWJhc2UpIHtcclxuICAgICAgICB0aGlzLnByb2plY3RJZCA9IHByb2plY3RJZDtcclxuICAgICAgICB0aGlzLmRhdGFiYXNlID0gZGF0YWJhc2UgPyBkYXRhYmFzZSA6IERFRkFVTFRfREFUQUJBU0VfTkFNRTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEYXRhYmFzZUlkLnByb3RvdHlwZSwgXCJpc0RlZmF1bHREYXRhYmFzZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFiYXNlID09PSBERUZBVUxUX0RBVEFCQVNFX05BTUU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBEYXRhYmFzZUlkLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIERhdGFiYXNlSWQgJiZcclxuICAgICAgICAgICAgb3RoZXIucHJvamVjdElkID09PSB0aGlzLnByb2plY3RJZCAmJlxyXG4gICAgICAgICAgICBvdGhlci5kYXRhYmFzZSA9PT0gdGhpcy5kYXRhYmFzZSk7XHJcbiAgICB9O1xyXG4gICAgRGF0YWJhc2VJZC5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMucHJvamVjdElkLCBvdGhlci5wcm9qZWN0SWQpIHx8XHJcbiAgICAgICAgICAgIHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5kYXRhYmFzZSwgb3RoZXIuZGF0YWJhc2UpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRGF0YWJhc2VJZDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBET0NVTUVOVF9LRVlfTkFNRSA9ICdfX25hbWVfXyc7XHJcbi8qKlxyXG4gKiBQYXRoIHJlcHJlc2VudHMgYW4gb3JkZXJlZCBzZXF1ZW5jZSBvZiBzdHJpbmcgc2VnbWVudHMuXHJcbiAqL1xyXG52YXIgUGF0aCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFBhdGgoc2VnbWVudHMsIG9mZnNldCwgbGVuZ3RoKSB7XHJcbiAgICAgICAgdGhpcy5pbml0KHNlZ21lbnRzLCBvZmZzZXQsIGxlbmd0aCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFuIGluaXRpYWxpemF0aW9uIG1ldGhvZCB0aGF0IGNhbiBiZSBjYWxsZWQgZnJvbSBvdXRzaWRlIHRoZSBjb25zdHJ1Y3Rvci5cclxuICAgICAqIFdlIG5lZWQgdGhpcyBzbyB0aGF0IHdlIGNhbiBoYXZlIGEgbm9uLXN0YXRpYyBjb25zdHJ1Y3QgbWV0aG9kIHRoYXQgcmV0dXJuc1xyXG4gICAgICogdGhlIHBvbHltb3JwaGljIGB0aGlzYCB0eXBlLlxyXG4gICAgICovXHJcbiAgICBQYXRoLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKHNlZ21lbnRzLCBvZmZzZXQsIGxlbmd0aCkge1xyXG4gICAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvZmZzZXQgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChvZmZzZXQgPiBzZWdtZW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZmFpbCgnb2Zmc2V0ICcgKyBvZmZzZXQgKyAnIG91dCBvZiByYW5nZSAnICsgc2VnbWVudHMubGVuZ3RoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGxlbmd0aCA9IHNlZ21lbnRzLmxlbmd0aCAtIG9mZnNldDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobGVuZ3RoID4gc2VnbWVudHMubGVuZ3RoIC0gb2Zmc2V0KSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ2xlbmd0aCAnICsgbGVuZ3RoICsgJyBvdXQgb2YgcmFuZ2UgJyArIChzZWdtZW50cy5sZW5ndGggLSBvZmZzZXQpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZWdtZW50cyA9IHNlZ21lbnRzO1xyXG4gICAgICAgIHRoaXMub2Zmc2V0ID0gb2Zmc2V0O1xyXG4gICAgICAgIHRoaXMubGVuID0gbGVuZ3RoO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ29uc3RydWN0cyBhIG5ldyBpbnN0YW5jZSBvZiBQYXRoIHVzaW5nIHRoZSBzYW1lIGNvbmNyZXRlIHR5cGUgYXMgYHRoaXNgLlxyXG4gICAgICogV2UgbmVlZCB0aGlzIGluc3RlYWQgb2YgdXNpbmcgdGhlIG5vcm1hbCBjb25zdHJ1Y3RvciwgYmVjYXVzZSBwb2x5bW9ycGhpY1xyXG4gICAgICogYHRoaXNgIGRvZXNuJ3Qgd29yayBvbiBzdGF0aWMgbWV0aG9kcy5cclxuICAgICAqL1xyXG4gICAgUGF0aC5wcm90b3R5cGUuY29uc3RydWN0ID0gZnVuY3Rpb24gKHNlZ21lbnRzLCBvZmZzZXQsIGxlbmd0aCkge1xyXG4gICAgICAgIHZhciBwYXRoID0gT2JqZWN0LmNyZWF0ZShPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcykpO1xyXG4gICAgICAgIHBhdGguaW5pdChzZWdtZW50cywgb2Zmc2V0LCBsZW5ndGgpO1xyXG4gICAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXRoLnByb3RvdHlwZSwgXCJsZW5ndGhcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sZW47XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBQYXRoLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIFBhdGguY29tcGFyYXRvcih0aGlzLCBvdGhlcikgPT09IDA7XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUuY2hpbGQgPSBmdW5jdGlvbiAobmFtZU9yUGF0aCkge1xyXG4gICAgICAgIHZhciBzZWdtZW50cyA9IHRoaXMuc2VnbWVudHMuc2xpY2UodGhpcy5vZmZzZXQsIHRoaXMubGltaXQoKSk7XHJcbiAgICAgICAgaWYgKG5hbWVPclBhdGggaW5zdGFuY2VvZiBQYXRoKSB7XHJcbiAgICAgICAgICAgIG5hbWVPclBhdGguZm9yRWFjaChmdW5jdGlvbiAoc2VnbWVudCkge1xyXG4gICAgICAgICAgICAgICAgc2VnbWVudHMucHVzaChzZWdtZW50KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBuYW1lT3JQYXRoID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBzZWdtZW50cy5wdXNoKG5hbWVPclBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZmFpbCgnVW5rbm93biBwYXJhbWV0ZXIgdHlwZSBmb3IgUGF0aC5jaGlsZCgpOiAnICsgbmFtZU9yUGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdChzZWdtZW50cyk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFRoZSBpbmRleCBvZiBvbmUgcGFzdCB0aGUgbGFzdCBzZWdtZW50IG9mIHRoZSBwYXRoLiAqL1xyXG4gICAgUGF0aC5wcm90b3R5cGUubGltaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub2Zmc2V0ICsgdGhpcy5sZW5ndGg7XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUucG9wRmlyc3QgPSBmdW5jdGlvbiAoc2l6ZSkge1xyXG4gICAgICAgIHNpemUgPSBzaXplID09PSB1bmRlZmluZWQgPyAxIDogc2l6ZTtcclxuICAgICAgICBhc3NlcnQodGhpcy5sZW5ndGggPj0gc2l6ZSwgXCJDYW4ndCBjYWxsIHBvcEZpcnN0KCkgd2l0aCBsZXNzIHNlZ21lbnRzXCIpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCArIHNpemUsIHRoaXMubGVuZ3RoIC0gc2l6ZSk7XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUucG9wTGFzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMuaXNFbXB0eSgpLCBcIkNhbid0IGNhbGwgcG9wTGFzdCgpIG9uIGVtcHR5IHBhdGhcIik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0KHRoaXMuc2VnbWVudHMsIHRoaXMub2Zmc2V0LCB0aGlzLmxlbmd0aCAtIDEpO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLmZpcnN0U2VnbWVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMuaXNFbXB0eSgpLCBcIkNhbid0IGNhbGwgZmlyc3RTZWdtZW50KCkgb24gZW1wdHkgcGF0aFwiKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50c1t0aGlzLm9mZnNldF07XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUubGFzdFNlZ21lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLmlzRW1wdHkoKSwgXCJDYW4ndCBjYWxsIGxhc3RTZWdtZW50KCkgb24gZW1wdHkgcGF0aFwiKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50c1t0aGlzLmxpbWl0KCkgLSAxXTtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcclxuICAgICAgICBhc3NlcnQoaW5kZXggPCB0aGlzLmxlbmd0aCwgJ0luZGV4IG91dCBvZiByYW5nZScpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzW3RoaXMub2Zmc2V0ICsgaW5kZXhdO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoID09PSAwO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLmlzUHJlZml4T2YgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIubGVuZ3RoIDwgdGhpcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0KGkpICE9PSBvdGhlci5nZXQoaSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5pc0ltbWVkaWF0ZVBhcmVudE9mID0gZnVuY3Rpb24gKHBvdGVudGlhbENoaWxkKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubGVuZ3RoICsgMSAhPT0gcG90ZW50aWFsQ2hpbGQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmdldChpKSAhPT0gcG90ZW50aWFsQ2hpbGQuZ2V0KGkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLm9mZnNldCwgZW5kID0gdGhpcy5saW1pdCgpOyBpIDwgZW5kOyBpKyspIHtcclxuICAgICAgICAgICAgZm4odGhpcy5zZWdtZW50c1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHMuc2xpY2UodGhpcy5vZmZzZXQsIHRoaXMubGltaXQoKSk7XHJcbiAgICB9O1xyXG4gICAgUGF0aC5jb21wYXJhdG9yID0gZnVuY3Rpb24gKHAxLCBwMikge1xyXG4gICAgICAgIHZhciBsZW4gPSBNYXRoLm1pbihwMS5sZW5ndGgsIHAyLmxlbmd0aCk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgbGVmdCA9IHAxLmdldChpKTtcclxuICAgICAgICAgICAgdmFyIHJpZ2h0ID0gcDIuZ2V0KGkpO1xyXG4gICAgICAgICAgICBpZiAobGVmdCA8IHJpZ2h0KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICBpZiAobGVmdCA+IHJpZ2h0KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwMS5sZW5ndGggPCBwMi5sZW5ndGgpXHJcbiAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICBpZiAocDEubGVuZ3RoID4gcDIubGVuZ3RoKVxyXG4gICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGF0aDtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgc2xhc2gtc2VwYXJhdGVkIHBhdGggZm9yIG5hdmlnYXRpbmcgcmVzb3VyY2VzIChkb2N1bWVudHMgYW5kIGNvbGxlY3Rpb25zKVxyXG4gKiB3aXRoaW4gRmlyZXN0b3JlLlxyXG4gKi9cclxudmFyIFJlc291cmNlUGF0aCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFJlc291cmNlUGF0aCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFJlc291cmNlUGF0aCgpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBSZXNvdXJjZVBhdGgucHJvdG90eXBlLmNhbm9uaWNhbFN0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBOT1RFOiBUaGUgY2xpZW50IGlzIGlnbm9yYW50IG9mIGFueSBwYXRoIHNlZ21lbnRzIGNvbnRhaW5pbmcgZXNjYXBlXHJcbiAgICAgICAgLy8gc2VxdWVuY2VzIChlLmcuIF9faWQxMjNfXykgYW5kIGp1c3QgcGFzc2VzIHRoZW0gdGhyb3VnaCByYXcgKHRoZXkgZXhpc3RcclxuICAgICAgICAvLyBmb3IgbGVnYWN5IHJlYXNvbnMgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBmcmVxdWVudGx5KS5cclxuICAgICAgICByZXR1cm4gdGhpcy50b0FycmF5KCkuam9pbignLycpO1xyXG4gICAgfTtcclxuICAgIFJlc291cmNlUGF0aC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgcmVzb3VyY2UgcGF0aCBmcm9tIHRoZSBnaXZlbiBzbGFzaC1kZWxpbWl0ZWQgc3RyaW5nLlxyXG4gICAgICovXHJcbiAgICBSZXNvdXJjZVBhdGguZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgLy8gTk9URTogVGhlIGNsaWVudCBpcyBpZ25vcmFudCBvZiBhbnkgcGF0aCBzZWdtZW50cyBjb250YWluaW5nIGVzY2FwZVxyXG4gICAgICAgIC8vIHNlcXVlbmNlcyAoZS5nLiBfX2lkMTIzX18pIGFuZCBqdXN0IHBhc3NlcyB0aGVtIHRocm91Z2ggcmF3ICh0aGV5IGV4aXN0XHJcbiAgICAgICAgLy8gZm9yIGxlZ2FjeSByZWFzb25zIGFuZCBzaG91bGQgbm90IGJlIHVzZWQgZnJlcXVlbnRseSkuXHJcbiAgICAgICAgaWYgKHBhdGguaW5kZXhPZignLy8nKSA+PSAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBwYXRoIChcIiArIHBhdGggKyBcIikuIFBhdGhzIG11c3Qgbm90IGNvbnRhaW4gLy8gaW4gdGhlbS5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFdlIG1heSBzdGlsbCBoYXZlIGFuIGVtcHR5IHNlZ21lbnQgYXQgdGhlIGJlZ2lubmluZyBvciBlbmQgaWYgdGhleSBoYWQgYVxyXG4gICAgICAgIC8vIGxlYWRpbmcgb3IgdHJhaWxpbmcgc2xhc2ggKHdoaWNoIHdlIGFsbG93KS5cclxuICAgICAgICB2YXIgc2VnbWVudHMgPSBwYXRoLnNwbGl0KCcvJykuZmlsdGVyKGZ1bmN0aW9uIChzZWdtZW50KSB7IHJldHVybiBzZWdtZW50Lmxlbmd0aCA+IDA7IH0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgUmVzb3VyY2VQYXRoKHNlZ21lbnRzKTtcclxuICAgIH07XHJcbiAgICBSZXNvdXJjZVBhdGguRU1QVFlfUEFUSCA9IG5ldyBSZXNvdXJjZVBhdGgoW10pO1xyXG4gICAgcmV0dXJuIFJlc291cmNlUGF0aDtcclxufShQYXRoKSk7XHJcbnZhciBpZGVudGlmaWVyUmVnRXhwID0gL15bX2EtekEtWl1bX2EtekEtWjAtOV0qJC87XHJcbi8qKiBBIGRvdC1zZXBhcmF0ZWQgcGF0aCBmb3IgbmF2aWdhdGluZyBzdWItb2JqZWN0cyB3aXRoaW4gYSBkb2N1bWVudC4gKi9cclxudmFyIEZpZWxkUGF0aCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEZpZWxkUGF0aCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEZpZWxkUGF0aCgpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgc3RyaW5nIGNvdWxkIGJlIHVzZWQgYXMgYSBzZWdtZW50IGluIGEgZmllbGQgcGF0aFxyXG4gICAgICogd2l0aG91dCBlc2NhcGluZy5cclxuICAgICAqL1xyXG4gICAgRmllbGRQYXRoLmlzVmFsaWRJZGVudGlmaWVyID0gZnVuY3Rpb24gKHNlZ21lbnQpIHtcclxuICAgICAgICByZXR1cm4gaWRlbnRpZmllclJlZ0V4cC50ZXN0KHNlZ21lbnQpO1xyXG4gICAgfTtcclxuICAgIEZpZWxkUGF0aC5wcm90b3R5cGUuY2Fub25pY2FsU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRvQXJyYXkoKVxyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChzdHIpIHtcclxuICAgICAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoJ1xcXFwnLCAnXFxcXFxcXFwnKS5yZXBsYWNlKCdgJywgJ1xcXFxgJyk7XHJcbiAgICAgICAgICAgIGlmICghRmllbGRQYXRoLmlzVmFsaWRJZGVudGlmaWVyKHN0cikpIHtcclxuICAgICAgICAgICAgICAgIHN0ciA9ICdgJyArIHN0ciArICdgJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5qb2luKCcuJyk7XHJcbiAgICB9O1xyXG4gICAgRmllbGRQYXRoLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jYW5vbmljYWxTdHJpbmcoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGZpZWxkIHJlZmVyZW5jZXMgdGhlIGtleSBvZiBhIGRvY3VtZW50LlxyXG4gICAgICovXHJcbiAgICBGaWVsZFBhdGgucHJvdG90eXBlLmlzS2V5RmllbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoID09PSAxICYmIHRoaXMuZ2V0KDApID09PSBET0NVTUVOVF9LRVlfTkFNRTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBmaWVsZCBkZXNpZ25hdGluZyB0aGUga2V5IG9mIGEgZG9jdW1lbnQuXHJcbiAgICAgKi9cclxuICAgIEZpZWxkUGF0aC5rZXlGaWVsZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEZpZWxkUGF0aChbRE9DVU1FTlRfS0VZX05BTUVdKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIGZpZWxkIHN0cmluZyBmcm9tIHRoZSBnaXZlbiBzZXJ2ZXItZm9ybWF0dGVkIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiAtIFNwbGl0dGluZyB0aGUgZW1wdHkgc3RyaW5nIGlzIG5vdCBhbGxvd2VkIChmb3Igbm93IGF0IGxlYXN0KS5cclxuICAgICAqIC0gRW1wdHkgc2VnbWVudHMgd2l0aGluIHRoZSBzdHJpbmcgKGUuZy4gaWYgdGhlcmUgYXJlIHR3byBjb25zZWN1dGl2ZVxyXG4gICAgICogICBzZXBhcmF0b3JzKSBhcmUgbm90IGFsbG93ZWQuXHJcbiAgICAgKlxyXG4gICAgICogVE9ETyhiLzM3MjQ0MTU3KTogd2Ugc2hvdWxkIG1ha2UgdGhpcyBtb3JlIHN0cmljdC4gUmlnaHQgbm93LCBpdCBhbGxvd3NcclxuICAgICAqIG5vbi1pZGVudGlmaWVyIHBhdGggY29tcG9uZW50cywgZXZlbiBpZiB0aGV5IGFyZW4ndCBlc2NhcGVkLlxyXG4gICAgICovXHJcbiAgICBGaWVsZFBhdGguZnJvbVNlcnZlckZvcm1hdCA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgdmFyIHNlZ21lbnRzID0gW107XHJcbiAgICAgICAgdmFyIGN1cnJlbnQgPSAnJztcclxuICAgICAgICB2YXIgaSA9IDA7XHJcbiAgICAgICAgdmFyIGFkZEN1cnJlbnRTZWdtZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudC5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBmaWVsZCBwYXRoIChcIiArIHBhdGggKyBcIikuIFBhdGhzIG11c3Qgbm90IGJlIGVtcHR5LCBiZWdpbiBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgXCJ3aXRoICcuJywgZW5kIHdpdGggJy4nLCBvciBjb250YWluICcuLidcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VnbWVudHMucHVzaChjdXJyZW50KTtcclxuICAgICAgICAgICAgY3VycmVudCA9ICcnO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGluQmFja3RpY2tzID0gZmFsc2U7XHJcbiAgICAgICAgd2hpbGUgKGkgPCBwYXRoLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHBhdGhbaV07XHJcbiAgICAgICAgICAgIGlmIChjID09PSAnXFxcXCcpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpICsgMSA9PT0gcGF0aC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnUGF0aCBoYXMgdHJhaWxpbmcgZXNjYXBlIGNoYXJhY3RlcjogJyArIHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIG5leHQgPSBwYXRoW2kgKyAxXTtcclxuICAgICAgICAgICAgICAgIGlmICghKG5leHQgPT09ICdcXFxcJyB8fCBuZXh0ID09PSAnLicgfHwgbmV4dCA9PT0gJ2AnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdQYXRoIGhhcyBpbnZhbGlkIGVzY2FwZSBzZXF1ZW5jZTogJyArIHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3VycmVudCArPSBuZXh0O1xyXG4gICAgICAgICAgICAgICAgaSArPSAyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGMgPT09ICdgJykge1xyXG4gICAgICAgICAgICAgICAgaW5CYWNrdGlja3MgPSAhaW5CYWNrdGlja3M7XHJcbiAgICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoYyA9PT0gJy4nICYmICFpbkJhY2t0aWNrcykge1xyXG4gICAgICAgICAgICAgICAgYWRkQ3VycmVudFNlZ21lbnQoKTtcclxuICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgKz0gYztcclxuICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBhZGRDdXJyZW50U2VnbWVudCgpO1xyXG4gICAgICAgIGlmIChpbkJhY2t0aWNrcykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnVW50ZXJtaW5hdGVkIGAgaW4gcGF0aDogJyArIHBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IEZpZWxkUGF0aChzZWdtZW50cyk7XHJcbiAgICB9O1xyXG4gICAgRmllbGRQYXRoLkVNUFRZX1BBVEggPSBuZXcgRmllbGRQYXRoKFtdKTtcclxuICAgIHJldHVybiBGaWVsZFBhdGg7XHJcbn0oUGF0aCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIERvY3VtZW50S2V5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnRLZXkocGF0aCkge1xyXG4gICAgICAgIHRoaXMucGF0aCA9IHBhdGg7XHJcbiAgICAgICAgYXNzZXJ0KERvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkocGF0aCksICdJbnZhbGlkIERvY3VtZW50S2V5IHdpdGggYW4gb2RkIG51bWJlciBvZiBzZWdtZW50czogJyArXHJcbiAgICAgICAgICAgIHBhdGgudG9BcnJheSgpLmpvaW4oJy8nKSk7XHJcbiAgICB9XHJcbiAgICBEb2N1bWVudEtleS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgIT09IG51bGwgJiYgUmVzb3VyY2VQYXRoLmNvbXBhcmF0b3IodGhpcy5wYXRoLCBvdGhlci5wYXRoKSA9PT0gMCk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRLZXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgudG9TdHJpbmcoKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEtleS5jb21wYXJhdG9yID0gZnVuY3Rpb24gKGsxLCBrMikge1xyXG4gICAgICAgIHJldHVybiBSZXNvdXJjZVBhdGguY29tcGFyYXRvcihrMS5wYXRoLCBrMi5wYXRoKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5ID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICByZXR1cm4gcGF0aC5sZW5ndGggJSAyID09PSAwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyBkb2N1bWVudCBrZXkgd2l0aCB0aGUgZ2l2ZW4gc2VnbWVudHMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBhdGggVGhlIHNlZ21lbnRzIG9mIHRoZSBwYXRoIHRvIHRoZSBkb2N1bWVudFxyXG4gICAgICogQHJldHVybiBBIG5ldyBpbnN0YW5jZSBvZiBEb2N1bWVudEtleVxyXG4gICAgICovXHJcbiAgICBEb2N1bWVudEtleS5mcm9tU2VnbWVudHMgPSBmdW5jdGlvbiAoc2VnbWVudHMpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50S2V5KG5ldyBSZXNvdXJjZVBhdGgoc2VnbWVudHMuc2xpY2UoKSkpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyBkb2N1bWVudCBrZXkgdXNpbmcgJy8nIHRvIHNwbGl0IHRoZSBzdHJpbmcgaW50b1xyXG4gICAgICogc2VnbWVudHMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBhdGggVGhlIHNsYXNoLXNlcGFyYXRlZCBwYXRoIHN0cmluZyB0byB0aGUgZG9jdW1lbnRcclxuICAgICAqIEByZXR1cm4gQSBuZXcgaW5zdGFuY2Ugb2YgRG9jdW1lbnRLZXlcclxuICAgICAqL1xyXG4gICAgRG9jdW1lbnRLZXkuZnJvbVBhdGhTdHJpbmcgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRLZXkoUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcocGF0aCkpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50S2V5LkVNUFRZID0gbmV3IERvY3VtZW50S2V5KG5ldyBSZXNvdXJjZVBhdGgoW10pKTtcclxuICAgIHJldHVybiBEb2N1bWVudEtleTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGUgcmVzdWx0IG9mIGEgbG9va3VwIGZvciBhIGdpdmVuIHBhdGggbWF5IGJlIGFuIGV4aXN0aW5nIGRvY3VtZW50IG9yIGFcclxuICogbWFya2VyIHRoYXQgdGhpcyBkb2N1bWVudCBkb2VzIG5vdCBleGlzdCBhdCBhIGdpdmVuIHZlcnNpb24uXHJcbiAqL1xyXG52YXIgTWF5YmVEb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1heWJlRG9jdW1lbnQoa2V5LCB2ZXJzaW9uKSB7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcclxuICAgIH1cclxuICAgIE1heWJlRG9jdW1lbnQuY29tcGFyZUJ5S2V5ID0gZnVuY3Rpb24gKGQxLCBkMikge1xyXG4gICAgICAgIHJldHVybiBEb2N1bWVudEtleS5jb21wYXJhdG9yKGQxLmtleSwgZDIua2V5KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWF5YmVEb2N1bWVudDtcclxufSgpKTtcclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBkb2N1bWVudCBpbiBGaXJlc3RvcmUgd2l0aCBhIGtleSwgdmVyc2lvbiwgZGF0YSBhbmQgd2hldGhlciB0aGVcclxuICogZGF0YSBoYXMgbG9jYWwgbXV0YXRpb25zIGFwcGxpZWQgdG8gaXQuXHJcbiAqL1xyXG52YXIgRG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhEb2N1bWVudCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIERvY3VtZW50KGtleSwgdmVyc2lvbiwgZGF0YSwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGtleSwgdmVyc2lvbikgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICBfdGhpcy5oYXNMb2NhbE11dGF0aW9ucyA9ICEhb3B0aW9ucy5oYXNMb2NhbE11dGF0aW9ucztcclxuICAgICAgICBfdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnMgPSAhIW9wdGlvbnMuaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIERvY3VtZW50LnByb3RvdHlwZS5maWVsZCA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5maWVsZChwYXRoKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudC5wcm90b3R5cGUuZmllbGRWYWx1ZSA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZChwYXRoKTtcclxuICAgICAgICByZXR1cm4gZmllbGQgPyBmaWVsZC52YWx1ZSgpIDogdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50LnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLnZhbHVlKCk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnQucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgRG9jdW1lbnQgJiZcclxuICAgICAgICAgICAgdGhpcy5rZXkuaXNFcXVhbChvdGhlci5rZXkpICYmXHJcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbi5pc0VxdWFsKG90aGVyLnZlcnNpb24pICYmXHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5pc0VxdWFsKG90aGVyLmRhdGEpICYmXHJcbiAgICAgICAgICAgIHRoaXMuaGFzTG9jYWxNdXRhdGlvbnMgPT09IG90aGVyLmhhc0xvY2FsTXV0YXRpb25zICYmXHJcbiAgICAgICAgICAgIHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zID09PSBvdGhlci5oYXNDb21taXR0ZWRNdXRhdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKFwiRG9jdW1lbnQoXCIgKyB0aGlzLmtleSArIFwiLCBcIiArIHRoaXMudmVyc2lvbiArIFwiLCBcIiArIHRoaXMuZGF0YS50b1N0cmluZygpICsgXCIsIFwiICtcclxuICAgICAgICAgICAgKFwie2hhc0xvY2FsTXV0YXRpb25zOiBcIiArIHRoaXMuaGFzTG9jYWxNdXRhdGlvbnMgKyBcIn0pLCBcIikgK1xyXG4gICAgICAgICAgICAoXCJ7aGFzQ29tbWl0dGVkTXV0YXRpb25zOiBcIiArIHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zICsgXCJ9KVwiKSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvY3VtZW50LnByb3RvdHlwZSwgXCJoYXNQZW5kaW5nV3JpdGVzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFzTG9jYWxNdXRhdGlvbnMgfHwgdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBEb2N1bWVudC5jb21wYXJlQnlGaWVsZCA9IGZ1bmN0aW9uIChmaWVsZCwgZDEsIGQyKSB7XHJcbiAgICAgICAgdmFyIHYxID0gZDEuZmllbGQoZmllbGQpO1xyXG4gICAgICAgIHZhciB2MiA9IGQyLmZpZWxkKGZpZWxkKTtcclxuICAgICAgICBpZiAodjEgIT09IHVuZGVmaW5lZCAmJiB2MiAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2MS5jb21wYXJlVG8odjIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoXCJUcnlpbmcgdG8gY29tcGFyZSBkb2N1bWVudHMgb24gZmllbGRzIHRoYXQgZG9uJ3QgZXhpc3RcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBEb2N1bWVudDtcclxufShNYXliZURvY3VtZW50KSk7XHJcbi8qKlxyXG4gKiBBIGNsYXNzIHJlcHJlc2VudGluZyBhIGRlbGV0ZWQgZG9jdW1lbnQuXHJcbiAqIFZlcnNpb24gaXMgc2V0IHRvIDAgaWYgd2UgZG9uJ3QgcG9pbnQgdG8gYW55IHNwZWNpZmljIHRpbWUsIG90aGVyd2lzZSBpdFxyXG4gKiBkZW5vdGVzIHRpbWUgd2Uga25vdyBpdCBkaWRuJ3QgZXhpc3QgYXQuXHJcbiAqL1xyXG52YXIgTm9Eb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKE5vRG9jdW1lbnQsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBOb0RvY3VtZW50KGtleSwgdmVyc2lvbiwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGtleSwgdmVyc2lvbikgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnMgPSAhIShvcHRpb25zICYmIG9wdGlvbnMuaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBOb0RvY3VtZW50LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gXCJOb0RvY3VtZW50KFwiICsgdGhpcy5rZXkgKyBcIiwgXCIgKyB0aGlzLnZlcnNpb24gKyBcIilcIjtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTm9Eb2N1bWVudC5wcm90b3R5cGUsIFwiaGFzUGVuZGluZ1dyaXRlc1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE5vRG9jdW1lbnQucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgTm9Eb2N1bWVudCAmJlxyXG4gICAgICAgICAgICBvdGhlci5oYXNDb21taXR0ZWRNdXRhdGlvbnMgPT09IHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zICYmXHJcbiAgICAgICAgICAgIG90aGVyLnZlcnNpb24uaXNFcXVhbCh0aGlzLnZlcnNpb24pICYmXHJcbiAgICAgICAgICAgIG90aGVyLmtleS5pc0VxdWFsKHRoaXMua2V5KSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE5vRG9jdW1lbnQ7XHJcbn0oTWF5YmVEb2N1bWVudCkpO1xyXG4vKipcclxuICogQSBjbGFzcyByZXByZXNlbnRpbmcgYW4gZXhpc3RpbmcgZG9jdW1lbnQgd2hvc2UgZGF0YSBpcyB1bmtub3duIChlLmcuIGFcclxuICogZG9jdW1lbnQgdGhhdCB3YXMgdXBkYXRlZCB3aXRob3V0IGEga25vd24gYmFzZSBkb2N1bWVudCkuXHJcbiAqL1xyXG52YXIgVW5rbm93bkRvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoVW5rbm93bkRvY3VtZW50LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gVW5rbm93bkRvY3VtZW50KGtleSwgdmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBrZXksIHZlcnNpb24pIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBVbmtub3duRG9jdW1lbnQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBcIlVua25vd25Eb2N1bWVudChcIiArIHRoaXMua2V5ICsgXCIsIFwiICsgdGhpcy52ZXJzaW9uICsgXCIpXCI7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFVua25vd25Eb2N1bWVudC5wcm90b3R5cGUsIFwiaGFzUGVuZGluZ1dyaXRlc1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgVW5rbm93bkRvY3VtZW50LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIFVua25vd25Eb2N1bWVudCAmJlxyXG4gICAgICAgICAgICBvdGhlci52ZXJzaW9uLmlzRXF1YWwodGhpcy52ZXJzaW9uKSAmJlxyXG4gICAgICAgICAgICBvdGhlci5rZXkuaXNFcXVhbCh0aGlzLmtleSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBVbmtub3duRG9jdW1lbnQ7XHJcbn0oTWF5YmVEb2N1bWVudCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gQW4gaW1tdXRhYmxlIHNvcnRlZCBtYXAgaW1wbGVtZW50YXRpb24sIGJhc2VkIG9uIGEgTGVmdC1sZWFuaW5nIFJlZC1CbGFja1xyXG4vLyB0cmVlLlxyXG52YXIgU29ydGVkTWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU29ydGVkTWFwKGNvbXBhcmF0b3IsIHJvb3QpIHtcclxuICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSBjb21wYXJhdG9yO1xyXG4gICAgICAgIHRoaXMucm9vdCA9IHJvb3QgPyByb290IDogTExSQk5vZGUuRU1QVFk7XHJcbiAgICB9XHJcbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgbWFwLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5L3ZhbHVlIGFkZGVkIG9yIHJlcGxhY2VkLlxyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgU29ydGVkTWFwKHRoaXMuY29tcGFyYXRvciwgdGhpcy5yb290XHJcbiAgICAgICAgICAgIC5pbnNlcnQoa2V5LCB2YWx1ZSwgdGhpcy5jb21wYXJhdG9yKVxyXG4gICAgICAgICAgICAuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5CTEFDSywgbnVsbCwgbnVsbCkpO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBtYXAsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkgcmVtb3ZlZC5cclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgU29ydGVkTWFwKHRoaXMuY29tcGFyYXRvciwgdGhpcy5yb290XHJcbiAgICAgICAgICAgIC5yZW1vdmUoa2V5LCB0aGlzLmNvbXBhcmF0b3IpXHJcbiAgICAgICAgICAgIC5jb3B5KG51bGwsIG51bGwsIExMUkJOb2RlLkJMQUNLLCBudWxsLCBudWxsKSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIG5vZGUgd2l0aCB0aGUgZ2l2ZW4ga2V5LCBvciBudWxsLlxyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLnJvb3Q7XHJcbiAgICAgICAgd2hpbGUgKCFub2RlLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICB2YXIgY21wID0gdGhpcy5jb21wYXJhdG9yKGtleSwgbm9kZS5rZXkpO1xyXG4gICAgICAgICAgICBpZiAoY21wID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS52YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjbXAgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA+IDApIHtcclxuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBlbGVtZW50IGluIHRoaXMgc29ydGVkIG1hcCwgb3IgLTEgaWYgaXQgZG9lc24ndFxyXG4gICAgLy8gZXhpc3QuXHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgLy8gTnVtYmVyIG9mIG5vZGVzIHRoYXQgd2VyZSBwcnVuZWQgd2hlbiBkZXNjZW5kaW5nIHJpZ2h0XHJcbiAgICAgICAgdmFyIHBydW5lZE5vZGVzID0gMDtcclxuICAgICAgICB2YXIgbm9kZSA9IHRoaXMucm9vdDtcclxuICAgICAgICB3aGlsZSAoIW5vZGUuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHZhciBjbXAgPSB0aGlzLmNvbXBhcmF0b3Ioa2V5LCBub2RlLmtleSk7XHJcbiAgICAgICAgICAgIGlmIChjbXAgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcnVuZWROb2RlcyArIG5vZGUubGVmdC5zaXplO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHtcclxuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDb3VudCBhbGwgbm9kZXMgbGVmdCBvZiB0aGUgbm9kZSBwbHVzIHRoZSBub2RlIGl0c2VsZlxyXG4gICAgICAgICAgICAgICAgcHJ1bmVkTm9kZXMgKz0gbm9kZS5sZWZ0LnNpemUgKyAxO1xyXG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gTm9kZSBub3QgZm91bmRcclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QuaXNFbXB0eSgpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTb3J0ZWRNYXAucHJvdG90eXBlLCBcInNpemVcIiwge1xyXG4gICAgICAgIC8vIFJldHVybnMgdGhlIHRvdGFsIG51bWJlciBvZiBub2RlcyBpbiB0aGUgbWFwLlxyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yb290LnNpemU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvLyBSZXR1cm5zIHRoZSBtaW5pbXVtIGtleSBpbiB0aGUgbWFwLlxyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5taW5LZXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5taW5LZXkoKTtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgbWFwLlxyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5tYXhLZXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5tYXhLZXkoKTtcclxuICAgIH07XHJcbiAgICAvLyBUcmF2ZXJzZXMgdGhlIG1hcCBpbiBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIGZ1bmN0aW9uXHJcbiAgICAvLyBmb3IgZWFjaCBrZXkvdmFsdWUgcGFpci4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXHJcbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcclxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuaW5vcmRlclRyYXZlcnNhbCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yb290Lmlub3JkZXJUcmF2ZXJzYWwoYWN0aW9uKTtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICB0aGlzLmlub3JkZXJUcmF2ZXJzYWwoZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICAgICAgZm4oaywgdik7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBUcmF2ZXJzZXMgdGhlIG1hcCBpbiByZXZlcnNlIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb25cclxuICAgIC8vIGZ1bmN0aW9uIGZvciBlYWNoIGtleS92YWx1ZSBwYWlyLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXNcclxuICAgIC8vIGFib3J0ZWQuXHJcbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcclxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUucmV2ZXJzZVRyYXZlcnNhbCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yb290LnJldmVyc2VUcmF2ZXJzYWwoYWN0aW9uKTtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIGFuIGl0ZXJhdG9yIG92ZXIgdGhlIFNvcnRlZE1hcC5cclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuZ2V0SXRlcmF0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXBJdGVyYXRvcih0aGlzLnJvb3QsIG51bGwsIHRoaXMuY29tcGFyYXRvciwgZmFsc2UpO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuZ2V0SXRlcmF0b3JGcm9tID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgU29ydGVkTWFwSXRlcmF0b3IodGhpcy5yb290LCBrZXksIHRoaXMuY29tcGFyYXRvciwgZmFsc2UpO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuZ2V0UmV2ZXJzZUl0ZXJhdG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgU29ydGVkTWFwSXRlcmF0b3IodGhpcy5yb290LCBudWxsLCB0aGlzLmNvbXBhcmF0b3IsIHRydWUpO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuZ2V0UmV2ZXJzZUl0ZXJhdG9yRnJvbSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcEl0ZXJhdG9yKHRoaXMucm9vdCwga2V5LCB0aGlzLmNvbXBhcmF0b3IsIHRydWUpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTb3J0ZWRNYXA7XHJcbn0oKSk7IC8vIGVuZCBTb3J0ZWRNYXBcclxuLy8gQW4gaXRlcmF0b3Igb3ZlciBhbiBMTFJCTm9kZS5cclxudmFyIFNvcnRlZE1hcEl0ZXJhdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU29ydGVkTWFwSXRlcmF0b3Iobm9kZSwgc3RhcnRLZXksIGNvbXBhcmF0b3IsIGlzUmV2ZXJzZSkge1xyXG4gICAgICAgIHRoaXMuaXNSZXZlcnNlID0gaXNSZXZlcnNlO1xyXG4gICAgICAgIHRoaXMubm9kZVN0YWNrID0gW107XHJcbiAgICAgICAgdmFyIGNtcCA9IDE7XHJcbiAgICAgICAgd2hpbGUgKCFub2RlLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICBjbXAgPSBzdGFydEtleSA/IGNvbXBhcmF0b3Iobm9kZS5rZXksIHN0YXJ0S2V5KSA6IDE7XHJcbiAgICAgICAgICAgIC8vIGZsaXAgdGhlIGNvbXBhcmlzb24gaWYgd2UncmUgZ29pbmcgaW4gcmV2ZXJzZVxyXG4gICAgICAgICAgICBpZiAoaXNSZXZlcnNlKVxyXG4gICAgICAgICAgICAgICAgY21wICo9IC0xO1xyXG4gICAgICAgICAgICBpZiAoY21wIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBub2RlIGlzIGxlc3MgdGhhbiBvdXIgc3RhcnQga2V5LiBpZ25vcmUgaXRcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUmV2ZXJzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5yaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjbXAgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoaXMgbm9kZSBpcyBleGFjdGx5IGVxdWFsIHRvIG91ciBzdGFydCBrZXkuIFB1c2ggaXQgb24gdGhlIHN0YWNrLFxyXG4gICAgICAgICAgICAgICAgLy8gYnV0IHN0b3AgaXRlcmF0aW5nO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlU3RhY2sucHVzaChub2RlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBub2RlIGlzIGdyZWF0ZXIgdGhhbiBvdXIgc3RhcnQga2V5LCBhZGQgaXQgdG8gdGhlIHN0YWNrIGFuZCBtb3ZlXHJcbiAgICAgICAgICAgICAgICAvLyB0byB0aGUgbmV4dCBvbmVcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrLnB1c2gobm9kZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JldmVyc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5yaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBTb3J0ZWRNYXBJdGVyYXRvci5wcm90b3R5cGUuZ2V0TmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5ub2RlU3RhY2subGVuZ3RoID4gMCwgJ2dldE5leHQoKSBjYWxsZWQgb24gaXRlcmF0b3Igd2hlbiBoYXNOZXh0KCkgaXMgZmFsc2UuJyk7XHJcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm5vZGVTdGFjay5wb3AoKTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0geyBrZXk6IG5vZGUua2V5LCB2YWx1ZTogbm9kZS52YWx1ZSB9O1xyXG4gICAgICAgIGlmICh0aGlzLmlzUmV2ZXJzZSkge1xyXG4gICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xyXG4gICAgICAgICAgICB3aGlsZSAoIW5vZGUuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVTdGFjay5wdXNoKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0O1xyXG4gICAgICAgICAgICB3aGlsZSAoIW5vZGUuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVTdGFjay5wdXNoKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUubGVmdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIFNvcnRlZE1hcEl0ZXJhdG9yLnByb3RvdHlwZS5oYXNOZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVTdGFjay5sZW5ndGggPiAwO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZE1hcEl0ZXJhdG9yLnByb3RvdHlwZS5wZWVrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLm5vZGVTdGFjay5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIHZhciBub2RlID0gdGhpcy5ub2RlU3RhY2tbdGhpcy5ub2RlU3RhY2subGVuZ3RoIC0gMV07XHJcbiAgICAgICAgcmV0dXJuIHsga2V5OiBub2RlLmtleSwgdmFsdWU6IG5vZGUudmFsdWUgfTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU29ydGVkTWFwSXRlcmF0b3I7XHJcbn0oKSk7IC8vIGVuZCBTb3J0ZWRNYXBJdGVyYXRvclxyXG4vLyBSZXByZXNlbnRzIGEgbm9kZSBpbiBhIExlZnQtbGVhbmluZyBSZWQtQmxhY2sgdHJlZS5cclxudmFyIExMUkJOb2RlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTExSQk5vZGUoa2V5LCB2YWx1ZSwgY29sb3IsIGxlZnQsIHJpZ2h0KSB7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMuY29sb3IgPSBjb2xvciAhPSBudWxsID8gY29sb3IgOiBMTFJCTm9kZS5SRUQ7XHJcbiAgICAgICAgdGhpcy5sZWZ0ID0gbGVmdCAhPSBudWxsID8gbGVmdCA6IExMUkJOb2RlLkVNUFRZO1xyXG4gICAgICAgIHRoaXMucmlnaHQgPSByaWdodCAhPSBudWxsID8gcmlnaHQgOiBMTFJCTm9kZS5FTVBUWTtcclxuICAgICAgICB0aGlzLnNpemUgPSB0aGlzLmxlZnQuc2l6ZSArIDEgKyB0aGlzLnJpZ2h0LnNpemU7XHJcbiAgICB9XHJcbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgY3VycmVudCBub2RlLCBvcHRpb25hbGx5IHJlcGxhY2luZyBwaWVjZXMgb2YgaXQuXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb2xvciwgbGVmdCwgcmlnaHQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IExMUkJOb2RlKGtleSAhPSBudWxsID8ga2V5IDogdGhpcy5rZXksIHZhbHVlICE9IG51bGwgPyB2YWx1ZSA6IHRoaXMudmFsdWUsIGNvbG9yICE9IG51bGwgPyBjb2xvciA6IHRoaXMuY29sb3IsIGxlZnQgIT0gbnVsbCA/IGxlZnQgOiB0aGlzLmxlZnQsIHJpZ2h0ICE9IG51bGwgPyByaWdodCA6IHRoaXMucmlnaHQpO1xyXG4gICAgfTtcclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvLyBUcmF2ZXJzZXMgdGhlIHRyZWUgaW4ga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxyXG4gICAgLy8gZm9yIGVhY2ggbm9kZS4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXHJcbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcclxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5pbm9yZGVyVHJhdmVyc2FsID0gZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5sZWZ0Lmlub3JkZXJUcmF2ZXJzYWwoYWN0aW9uKSB8fFxyXG4gICAgICAgICAgICBhY3Rpb24odGhpcy5rZXksIHRoaXMudmFsdWUpIHx8XHJcbiAgICAgICAgICAgIHRoaXMucmlnaHQuaW5vcmRlclRyYXZlcnNhbChhY3Rpb24pKTtcclxuICAgIH07XHJcbiAgICAvLyBUcmF2ZXJzZXMgdGhlIHRyZWUgaW4gcmV2ZXJzZSBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uXHJcbiAgICAvLyBmdW5jdGlvbiBmb3IgZWFjaCBub2RlLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cclxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxyXG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLnJldmVyc2VUcmF2ZXJzYWwgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLnJpZ2h0LnJldmVyc2VUcmF2ZXJzYWwoYWN0aW9uKSB8fFxyXG4gICAgICAgICAgICBhY3Rpb24odGhpcy5rZXksIHRoaXMudmFsdWUpIHx8XHJcbiAgICAgICAgICAgIHRoaXMubGVmdC5yZXZlcnNlVHJhdmVyc2FsKGFjdGlvbikpO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgdGhlIG1pbmltdW0gbm9kZSBpbiB0aGUgdHJlZS5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5taW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubGVmdC5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sZWZ0Lm1pbigpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgdHJlZS5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5taW5LZXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWluKCkua2V5O1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgdGhlIG1heGltdW0ga2V5IGluIHRoZSB0cmVlLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLm1heEtleSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5yaWdodC5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMua2V5O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmlnaHQubWF4S2V5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgbmV3IHRyZWUsIHdpdGggdGhlIGtleS92YWx1ZSBhZGRlZC5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29tcGFyYXRvcikge1xyXG4gICAgICAgIHZhciBuID0gdGhpcztcclxuICAgICAgICB2YXIgY21wID0gY29tcGFyYXRvcihrZXksIG4ua2V5KTtcclxuICAgICAgICBpZiAoY21wIDwgMCkge1xyXG4gICAgICAgICAgICBuID0gbi5jb3B5KG51bGwsIG51bGwsIG51bGwsIG4ubGVmdC5pbnNlcnQoa2V5LCB2YWx1ZSwgY29tcGFyYXRvciksIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjbXAgPT09IDApIHtcclxuICAgICAgICAgICAgbiA9IG4uY29weShudWxsLCB2YWx1ZSwgbnVsbCwgbnVsbCwgbnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBuID0gbi5jb3B5KG51bGwsIG51bGwsIG51bGwsIG51bGwsIG4ucmlnaHQuaW5zZXJ0KGtleSwgdmFsdWUsIGNvbXBhcmF0b3IpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG4uZml4VXAoKTtcclxuICAgIH07XHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUucmVtb3ZlTWluID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmxlZnQuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBMTFJCTm9kZS5FTVBUWTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG4gPSB0aGlzO1xyXG4gICAgICAgIGlmICghbi5sZWZ0LmlzUmVkKCkgJiYgIW4ubGVmdC5sZWZ0LmlzUmVkKCkpXHJcbiAgICAgICAgICAgIG4gPSBuLm1vdmVSZWRMZWZ0KCk7XHJcbiAgICAgICAgbiA9IG4uY29weShudWxsLCBudWxsLCBudWxsLCBuLmxlZnQucmVtb3ZlTWluKCksIG51bGwpO1xyXG4gICAgICAgIHJldHVybiBuLmZpeFVwKCk7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGl0ZW0gcmVtb3ZlZC5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5LCBjb21wYXJhdG9yKSB7XHJcbiAgICAgICAgdmFyIHNtYWxsZXN0O1xyXG4gICAgICAgIHZhciBuID0gdGhpcztcclxuICAgICAgICBpZiAoY29tcGFyYXRvcihrZXksIG4ua2V5KSA8IDApIHtcclxuICAgICAgICAgICAgaWYgKCFuLmxlZnQuaXNFbXB0eSgpICYmICFuLmxlZnQuaXNSZWQoKSAmJiAhbi5sZWZ0LmxlZnQuaXNSZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgbiA9IG4ubW92ZVJlZExlZnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBuID0gbi5jb3B5KG51bGwsIG51bGwsIG51bGwsIG4ubGVmdC5yZW1vdmUoa2V5LCBjb21wYXJhdG9yKSwgbnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAobi5sZWZ0LmlzUmVkKCkpXHJcbiAgICAgICAgICAgICAgICBuID0gbi5yb3RhdGVSaWdodCgpO1xyXG4gICAgICAgICAgICBpZiAoIW4ucmlnaHQuaXNFbXB0eSgpICYmICFuLnJpZ2h0LmlzUmVkKCkgJiYgIW4ucmlnaHQubGVmdC5pc1JlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBuID0gbi5tb3ZlUmVkUmlnaHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29tcGFyYXRvcihrZXksIG4ua2V5KSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG4ucmlnaHQuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExMUkJOb2RlLkVNUFRZO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc21hbGxlc3QgPSBuLnJpZ2h0Lm1pbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSBuLmNvcHkoc21hbGxlc3Qua2V5LCBzbWFsbGVzdC52YWx1ZSwgbnVsbCwgbnVsbCwgbi5yaWdodC5yZW1vdmVNaW4oKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbiA9IG4uY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBuLnJpZ2h0LnJlbW92ZShrZXksIGNvbXBhcmF0b3IpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG4uZml4VXAoKTtcclxuICAgIH07XHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuaXNSZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sb3I7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSBhZnRlciBwZXJmb3JtaW5nIGFueSBuZWVkZWQgcm90YXRpb25zLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmZpeFVwID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBuID0gdGhpcztcclxuICAgICAgICBpZiAobi5yaWdodC5pc1JlZCgpICYmICFuLmxlZnQuaXNSZWQoKSlcclxuICAgICAgICAgICAgbiA9IG4ucm90YXRlTGVmdCgpO1xyXG4gICAgICAgIGlmIChuLmxlZnQuaXNSZWQoKSAmJiBuLmxlZnQubGVmdC5pc1JlZCgpKVxyXG4gICAgICAgICAgICBuID0gbi5yb3RhdGVSaWdodCgpO1xyXG4gICAgICAgIGlmIChuLmxlZnQuaXNSZWQoKSAmJiBuLnJpZ2h0LmlzUmVkKCkpXHJcbiAgICAgICAgICAgIG4gPSBuLmNvbG9yRmxpcCgpO1xyXG4gICAgICAgIHJldHVybiBuO1xyXG4gICAgfTtcclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5tb3ZlUmVkTGVmdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbiA9IHRoaXMuY29sb3JGbGlwKCk7XHJcbiAgICAgICAgaWYgKG4ucmlnaHQubGVmdC5pc1JlZCgpKSB7XHJcbiAgICAgICAgICAgIG4gPSBuLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbi5yaWdodC5yb3RhdGVSaWdodCgpKTtcclxuICAgICAgICAgICAgbiA9IG4ucm90YXRlTGVmdCgpO1xyXG4gICAgICAgICAgICBuID0gbi5jb2xvckZsaXAoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG47XHJcbiAgICB9O1xyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLm1vdmVSZWRSaWdodCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbiA9IHRoaXMuY29sb3JGbGlwKCk7XHJcbiAgICAgICAgaWYgKG4ubGVmdC5sZWZ0LmlzUmVkKCkpIHtcclxuICAgICAgICAgICAgbiA9IG4ucm90YXRlUmlnaHQoKTtcclxuICAgICAgICAgICAgbiA9IG4uY29sb3JGbGlwKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuO1xyXG4gICAgfTtcclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5yb3RhdGVMZWZ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBubCA9IHRoaXMuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5SRUQsIG51bGwsIHRoaXMucmlnaHQubGVmdCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmlnaHQuY29weShudWxsLCBudWxsLCB0aGlzLmNvbG9yLCBubCwgbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLnJvdGF0ZVJpZ2h0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBuciA9IHRoaXMuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5SRUQsIHRoaXMubGVmdC5yaWdodCwgbnVsbCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGVmdC5jb3B5KG51bGwsIG51bGwsIHRoaXMuY29sb3IsIG51bGwsIG5yKTtcclxuICAgIH07XHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuY29sb3JGbGlwID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBsZWZ0ID0gdGhpcy5sZWZ0LmNvcHkobnVsbCwgbnVsbCwgIXRoaXMubGVmdC5jb2xvciwgbnVsbCwgbnVsbCk7XHJcbiAgICAgICAgdmFyIHJpZ2h0ID0gdGhpcy5yaWdodC5jb3B5KG51bGwsIG51bGwsICF0aGlzLnJpZ2h0LmNvbG9yLCBudWxsLCBudWxsKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb3B5KG51bGwsIG51bGwsICF0aGlzLmNvbG9yLCBsZWZ0LCByaWdodCk7XHJcbiAgICB9O1xyXG4gICAgLy8gRm9yIHRlc3RpbmcuXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuY2hlY2tNYXhEZXB0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYmxhY2tEZXB0aCA9IHRoaXMuY2hlY2soKTtcclxuICAgICAgICBpZiAoTWF0aC5wb3coMi4wLCBibGFja0RlcHRoKSA8PSB0aGlzLnNpemUgKyAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyBJbiBhIGJhbGFuY2VkIFJCIHRyZWUsIHRoZSBibGFjay1kZXB0aCAobnVtYmVyIG9mIGJsYWNrIG5vZGVzKSBmcm9tIHJvb3QgdG9cclxuICAgIC8vIGxlYXZlcyBpcyBlcXVhbCBvbiBib3RoIHNpZGVzLiAgVGhpcyBmdW5jdGlvbiB2ZXJpZmllcyB0aGF0IG9yIGFzc2VydHMuXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNSZWQoKSAmJiB0aGlzLmxlZnQuaXNSZWQoKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBmYWlsKCdSZWQgbm9kZSBoYXMgcmVkIGNoaWxkKCcgKyB0aGlzLmtleSArICcsJyArIHRoaXMudmFsdWUgKyAnKScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5yaWdodC5pc1JlZCgpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGZhaWwoJ1JpZ2h0IGNoaWxkIG9mICgnICsgdGhpcy5rZXkgKyAnLCcgKyB0aGlzLnZhbHVlICsgJykgaXMgcmVkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBibGFja0RlcHRoID0gdGhpcy5sZWZ0LmNoZWNrKCk7XHJcbiAgICAgICAgaWYgKGJsYWNrRGVwdGggIT09IHRoaXMucmlnaHQuY2hlY2soKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBmYWlsKCdCbGFjayBkZXB0aHMgZGlmZmVyJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gYmxhY2tEZXB0aCArICh0aGlzLmlzUmVkKCkgPyAwIDogMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgRW1wdHkgbm9kZSBpcyBzaGFyZWQgYmV0d2VlbiBhbGwgTExSQiB0cmVlcy5cclxuICAgIExMUkJOb2RlLkVNUFRZID0gbnVsbDtcclxuICAgIExMUkJOb2RlLlJFRCA9IHRydWU7XHJcbiAgICBMTFJCTm9kZS5CTEFDSyA9IGZhbHNlO1xyXG4gICAgcmV0dXJuIExMUkJOb2RlO1xyXG59KCkpOyAvLyBlbmQgTExSQk5vZGVcclxuLy8gUmVwcmVzZW50cyBhbiBlbXB0eSBub2RlIChhIGxlYWYgbm9kZSBpbiB0aGUgUmVkLUJsYWNrIFRyZWUpLlxyXG52YXIgTExSQkVtcHR5Tm9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExMUkJFbXB0eU5vZGUoKSB7XHJcbiAgICAgICAgdGhpcy5zaXplID0gMDtcclxuICAgIH1cclxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50IG5vZGUuXHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbG9yLCBsZWZ0LCByaWdodCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSB0cmVlLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5L3ZhbHVlIGFkZGVkLlxyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUuaW5zZXJ0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbXBhcmF0b3IpIHtcclxuICAgICAgICByZXR1cm4gbmV3IExMUkJOb2RlKGtleSwgdmFsdWUpO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSB0cmVlLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IHJlbW92ZWQuXHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5LCBjb21wYXJhdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5pbm9yZGVyVHJhdmVyc2FsID0gZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5yZXZlcnNlVHJhdmVyc2FsID0gZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5taW5LZXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUubWF4S2V5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmlzUmVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvLyBGb3IgdGVzdGluZy5cclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmNoZWNrTWF4RGVwdGggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExMUkJFbXB0eU5vZGU7XHJcbn0oKSk7IC8vIGVuZCBMTFJCRW1wdHlOb2RlXHJcbkxMUkJOb2RlLkVNUFRZID0gbmV3IExMUkJFbXB0eU5vZGUoKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBUeXBlT3JkZXI7XHJcbihmdW5jdGlvbiAoVHlwZU9yZGVyKSB7XHJcbiAgICAvLyBUaGlzIG9yZGVyIGlzIGRlZmluZWQgYnkgdGhlIGJhY2tlbmQuXHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiTnVsbFZhbHVlXCJdID0gMF0gPSBcIk51bGxWYWx1ZVwiO1xyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIkJvb2xlYW5WYWx1ZVwiXSA9IDFdID0gXCJCb29sZWFuVmFsdWVcIjtcclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJOdW1iZXJWYWx1ZVwiXSA9IDJdID0gXCJOdW1iZXJWYWx1ZVwiO1xyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIlRpbWVzdGFtcFZhbHVlXCJdID0gM10gPSBcIlRpbWVzdGFtcFZhbHVlXCI7XHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiU3RyaW5nVmFsdWVcIl0gPSA0XSA9IFwiU3RyaW5nVmFsdWVcIjtcclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJCbG9iVmFsdWVcIl0gPSA1XSA9IFwiQmxvYlZhbHVlXCI7XHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiUmVmVmFsdWVcIl0gPSA2XSA9IFwiUmVmVmFsdWVcIjtcclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJHZW9Qb2ludFZhbHVlXCJdID0gN10gPSBcIkdlb1BvaW50VmFsdWVcIjtcclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJBcnJheVZhbHVlXCJdID0gOF0gPSBcIkFycmF5VmFsdWVcIjtcclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJPYmplY3RWYWx1ZVwiXSA9IDldID0gXCJPYmplY3RWYWx1ZVwiO1xyXG59KShUeXBlT3JkZXIgfHwgKFR5cGVPcmRlciA9IHt9KSk7XHJcbi8qKiBEZWZpbmVzIHRoZSByZXR1cm4gdmFsdWUgZm9yIHBlbmRpbmcgc2VydmVyIHRpbWVzdGFtcHMuICovXHJcbnZhciBTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvcjtcclxuKGZ1bmN0aW9uIChTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvcikge1xyXG4gICAgU2VydmVyVGltZXN0YW1wQmVoYXZpb3JbU2VydmVyVGltZXN0YW1wQmVoYXZpb3JbXCJEZWZhdWx0XCJdID0gMF0gPSBcIkRlZmF1bHRcIjtcclxuICAgIFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yW1NlcnZlclRpbWVzdGFtcEJlaGF2aW9yW1wiRXN0aW1hdGVcIl0gPSAxXSA9IFwiRXN0aW1hdGVcIjtcclxuICAgIFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yW1NlcnZlclRpbWVzdGFtcEJlaGF2aW9yW1wiUHJldmlvdXNcIl0gPSAyXSA9IFwiUHJldmlvdXNcIjtcclxufSkoU2VydmVyVGltZXN0YW1wQmVoYXZpb3IgfHwgKFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yID0ge30pKTtcclxuLyoqIEhvbGRzIHByb3BlcnRpZXMgdGhhdCBkZWZpbmUgZmllbGQgdmFsdWUgZGVzZXJpYWxpemF0aW9uIG9wdGlvbnMuICovXHJcbnZhciBGaWVsZFZhbHVlT3B0aW9ucyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpZWxkVmFsdWVPcHRpb25zKHNlcnZlclRpbWVzdGFtcEJlaGF2aW9yLCB0aW1lc3RhbXBzSW5TbmFwc2hvdHMpIHtcclxuICAgICAgICB0aGlzLnNlcnZlclRpbWVzdGFtcEJlaGF2aW9yID0gc2VydmVyVGltZXN0YW1wQmVoYXZpb3I7XHJcbiAgICAgICAgdGhpcy50aW1lc3RhbXBzSW5TbmFwc2hvdHMgPSB0aW1lc3RhbXBzSW5TbmFwc2hvdHM7XHJcbiAgICB9XHJcbiAgICBGaWVsZFZhbHVlT3B0aW9ucy5mcm9tU25hcHNob3RPcHRpb25zID0gZnVuY3Rpb24gKG9wdGlvbnMsIHRpbWVzdGFtcHNJblNuYXBzaG90cykge1xyXG4gICAgICAgIHN3aXRjaCAob3B0aW9ucy5zZXJ2ZXJUaW1lc3RhbXBzKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2VzdGltYXRlJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmllbGRWYWx1ZU9wdGlvbnMoU2VydmVyVGltZXN0YW1wQmVoYXZpb3IuRXN0aW1hdGUsIHRpbWVzdGFtcHNJblNuYXBzaG90cyk7XHJcbiAgICAgICAgICAgIGNhc2UgJ3ByZXZpb3VzJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmllbGRWYWx1ZU9wdGlvbnMoU2VydmVyVGltZXN0YW1wQmVoYXZpb3IuUHJldmlvdXMsIHRpbWVzdGFtcHNJblNuYXBzaG90cyk7XHJcbiAgICAgICAgICAgIGNhc2UgJ25vbmUnOiAvLyBGYWxsLXRocm91Z2ggaW50ZW5kZWQuXHJcbiAgICAgICAgICAgIGNhc2UgdW5kZWZpbmVkOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFZhbHVlT3B0aW9ucyhTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvci5EZWZhdWx0LCB0aW1lc3RhbXBzSW5TbmFwc2hvdHMpO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ2Zyb21TbmFwc2hvdE9wdGlvbnMoKSBjYWxsZWQgd2l0aCBpbnZhbGlkIG9wdGlvbnMuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBGaWVsZFZhbHVlT3B0aW9ucztcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgZmllbGQgdmFsdWUgcmVwcmVzZW50cyBhIGRhdGF0eXBlIGFzIHN0b3JlZCBieSBGaXJlc3RvcmUuXHJcbiAqL1xyXG52YXIgRmllbGRWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpZWxkVmFsdWUoKSB7XHJcbiAgICB9XHJcbiAgICBGaWVsZFZhbHVlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdmFsID0gdGhpcy52YWx1ZSgpO1xyXG4gICAgICAgIHJldHVybiB2YWwgPT09IG51bGwgPyAnbnVsbCcgOiB2YWwudG9TdHJpbmcoKTtcclxuICAgIH07XHJcbiAgICBGaWVsZFZhbHVlLnByb3RvdHlwZS5kZWZhdWx0Q29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMudHlwZU9yZGVyICE9PSBvdGhlci50eXBlT3JkZXIsICdEZWZhdWx0IGNvbXBhcmVUbyBzaG91bGQgbm90IGJlIHVzZWQgZm9yIHZhbHVlcyBvZiBzYW1lIHR5cGUuJyk7XHJcbiAgICAgICAgdmFyIGNtcCA9IHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy50eXBlT3JkZXIsIG90aGVyLnR5cGVPcmRlcik7XHJcbiAgICAgICAgcmV0dXJuIGNtcDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRmllbGRWYWx1ZTtcclxufSgpKTtcclxudmFyIE51bGxWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKE51bGxWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIE51bGxWYWx1ZSgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5OdWxsVmFsdWU7XHJcbiAgICAgICAgLy8gaW50ZXJuYWxWYWx1ZSBpcyB1bnVzZWQgYnV0IHdlIGFkZCBpdCB0byB3b3JrIGFyb3VuZFxyXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMTU1ODVcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBOdWxsVmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICBOdWxsVmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gb3RoZXIgaW5zdGFuY2VvZiBOdWxsVmFsdWU7XHJcbiAgICB9O1xyXG4gICAgTnVsbFZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBOdWxsVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgfTtcclxuICAgIE51bGxWYWx1ZS5JTlNUQU5DRSA9IG5ldyBOdWxsVmFsdWUoKTtcclxuICAgIHJldHVybiBOdWxsVmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG52YXIgQm9vbGVhblZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQm9vbGVhblZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQm9vbGVhblZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBpbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5Cb29sZWFuVmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgQm9vbGVhblZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZTtcclxuICAgIH07XHJcbiAgICBCb29sZWFuVmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgQm9vbGVhblZhbHVlICYmXHJcbiAgICAgICAgICAgIHRoaXMuaW50ZXJuYWxWYWx1ZSA9PT0gb3RoZXIuaW50ZXJuYWxWYWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgQm9vbGVhblZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBCb29sZWFuVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcywgb3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgIH07XHJcbiAgICBCb29sZWFuVmFsdWUub2YgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUgPyBCb29sZWFuVmFsdWUuVFJVRSA6IEJvb2xlYW5WYWx1ZS5GQUxTRTtcclxuICAgIH07XHJcbiAgICBCb29sZWFuVmFsdWUuVFJVRSA9IG5ldyBCb29sZWFuVmFsdWUodHJ1ZSk7XHJcbiAgICBCb29sZWFuVmFsdWUuRkFMU0UgPSBuZXcgQm9vbGVhblZhbHVlKGZhbHNlKTtcclxuICAgIHJldHVybiBCb29sZWFuVmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG4vKiogQmFzZSBjbGFzcyBmb3IgSW50ZWdlclZhbHVlIGFuZCBEb3VibGVWYWx1ZS4gKi9cclxudmFyIE51bWJlclZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoTnVtYmVyVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBOdW1iZXJWYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuTnVtYmVyVmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgTnVtYmVyVmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlO1xyXG4gICAgfTtcclxuICAgIE51bWJlclZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBOdW1iZXJWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVtZXJpY0NvbXBhcmF0b3IodGhpcy5pbnRlcm5hbFZhbHVlLCBvdGhlci5pbnRlcm5hbFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE51bWJlclZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxuLyoqIFV0aWxpdHkgZnVuY3Rpb24gdG8gY29tcGFyZSBkb3VibGVzICh1c2luZyBGaXJlc3RvcmUgc2VtYW50aWNzIGZvciBOYU4pLiAqL1xyXG5mdW5jdGlvbiBudW1lcmljQ29tcGFyYXRvcihsZWZ0LCByaWdodCkge1xyXG4gICAgaWYgKGxlZnQgPCByaWdodCkge1xyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGxlZnQgPiByaWdodCkge1xyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobGVmdCA9PT0gcmlnaHQpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIG9uZSBvciBib3RoIGFyZSBOYU4uXHJcbiAgICAgICAgaWYgKGlzTmFOKGxlZnQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpc05hTihyaWdodCkgPyAwIDogLTE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFV0aWxpdHkgZnVuY3Rpb24gdG8gY2hlY2sgbnVtYmVycyBmb3IgZXF1YWxpdHkgdXNpbmcgRmlyZXN0b3JlIHNlbWFudGljc1xyXG4gKiAoTmFOID09PSBOYU4sIC0wLjAgIT09IDAuMCkuXHJcbiAqL1xyXG5mdW5jdGlvbiBudW1lcmljRXF1YWxzKGxlZnQsIHJpZ2h0KSB7XHJcbiAgICAvLyBJbXBsZW1lbnRlZCBiYXNlZCBvbiBPYmplY3QuaXMoKSBwb2x5ZmlsbCBmcm9tXHJcbiAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvaXNcclxuICAgIGlmIChsZWZ0ID09PSByaWdodCkge1xyXG4gICAgICAgIC8vICswICE9IC0wXHJcbiAgICAgICAgcmV0dXJuIGxlZnQgIT09IDAgfHwgMSAvIGxlZnQgPT09IDEgLyByaWdodDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIE5hTiA9PSBOYU5cclxuICAgICAgICByZXR1cm4gbGVmdCAhPT0gbGVmdCAmJiByaWdodCAhPT0gcmlnaHQ7XHJcbiAgICB9XHJcbn1cclxudmFyIEludGVnZXJWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEludGVnZXJWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEludGVnZXJWYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGludGVybmFsVmFsdWUpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBJbnRlZ2VyVmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICAvLyBOT1RFOiBEb3VibGVWYWx1ZSBhbmQgSW50ZWdlclZhbHVlIGluc3RhbmNlcyBtYXkgY29tcGFyZVRvKCkgdGhlIHNhbWUsXHJcbiAgICAgICAgLy8gYnV0IHRoYXQgZG9lc24ndCBtYWtlIHRoZW0gZXF1YWwgdmlhIGlzRXF1YWwoKS5cclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBJbnRlZ2VyVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bWVyaWNFcXVhbHModGhpcy5pbnRlcm5hbFZhbHVlLCBvdGhlci5pbnRlcm5hbFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEludGVnZXJWYWx1ZTtcclxufShOdW1iZXJWYWx1ZSkpO1xyXG52YXIgRG91YmxlVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhEb3VibGVWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIERvdWJsZVZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBpbnRlcm5hbFZhbHVlKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBpbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIERvdWJsZVZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgLy8gTk9URTogRG91YmxlVmFsdWUgYW5kIEludGVnZXJWYWx1ZSBpbnN0YW5jZXMgbWF5IGNvbXBhcmVUbygpIHRoZSBzYW1lLFxyXG4gICAgICAgIC8vIGJ1dCB0aGF0IGRvZXNuJ3QgbWFrZSB0aGVtIGVxdWFsIHZpYSBpc0VxdWFsKCkuXHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgRG91YmxlVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bWVyaWNFcXVhbHModGhpcy5pbnRlcm5hbFZhbHVlLCBvdGhlci5pbnRlcm5hbFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRG91YmxlVmFsdWUuTkFOID0gbmV3IERvdWJsZVZhbHVlKE5hTik7XHJcbiAgICBEb3VibGVWYWx1ZS5QT1NJVElWRV9JTkZJTklUWSA9IG5ldyBEb3VibGVWYWx1ZShJbmZpbml0eSk7XHJcbiAgICBEb3VibGVWYWx1ZS5ORUdBVElWRV9JTkZJTklUWSA9IG5ldyBEb3VibGVWYWx1ZSgtSW5maW5pdHkpO1xyXG4gICAgcmV0dXJuIERvdWJsZVZhbHVlO1xyXG59KE51bWJlclZhbHVlKSk7XHJcbi8vIFRPRE8oYi8zNzI2Nzg4NSk6IEFkZCB0cnVuY2F0aW9uIHN1cHBvcnRcclxudmFyIFN0cmluZ1ZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU3RyaW5nVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBTdHJpbmdWYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuU3RyaW5nVmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgU3RyaW5nVmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlO1xyXG4gICAgfTtcclxuICAgIFN0cmluZ1ZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIFN0cmluZ1ZhbHVlICYmIHRoaXMuaW50ZXJuYWxWYWx1ZSA9PT0gb3RoZXIuaW50ZXJuYWxWYWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgU3RyaW5nVmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIFN0cmluZ1ZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMuaW50ZXJuYWxWYWx1ZSwgb3RoZXIuaW50ZXJuYWxWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTdHJpbmdWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbnZhciBUaW1lc3RhbXBWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFRpbWVzdGFtcFZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gVGltZXN0YW1wVmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IGludGVybmFsVmFsdWU7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLlRpbWVzdGFtcFZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFRpbWVzdGFtcFZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy50aW1lc3RhbXBzSW5TbmFwc2hvdHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWUudG9EYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFRpbWVzdGFtcFZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIFRpbWVzdGFtcFZhbHVlICYmXHJcbiAgICAgICAgICAgIHRoaXMuaW50ZXJuYWxWYWx1ZS5pc0VxdWFsKG90aGVyLmludGVybmFsVmFsdWUpKTtcclxuICAgIH07XHJcbiAgICBUaW1lc3RhbXBWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgVGltZXN0YW1wVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZS5fY29tcGFyZVRvKG90aGVyLmludGVybmFsVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChvdGhlciBpbnN0YW5jZW9mIFNlcnZlclRpbWVzdGFtcFZhbHVlKSB7XHJcbiAgICAgICAgICAgIC8vIENvbmNyZXRlIHRpbWVzdGFtcHMgY29tZSBiZWZvcmUgc2VydmVyIHRpbWVzdGFtcHMuXHJcbiAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gVGltZXN0YW1wVmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGxvY2FsbHktYXBwbGllZCBTZXJ2ZXJUaW1lc3RhbXAuXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIFNlcnZlclRpbWVzdGFtcFZhbHVlIGluc3RhbmNlcyBhcmUgY3JlYXRlZCBhcyB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIGFcclxuICogICBUcmFuc2Zvcm1NdXRhdGlvbiAoc2VlIFRyYW5zZm9ybU11dGF0aW9uLmFwcGx5VG8oKSkuIFRoZXkgY2FuIG9ubHkgZXhpc3QgaW5cclxuICogICB0aGUgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50LiBUaGVyZWZvcmUgdGhleSBkbyBub3QgbmVlZCB0byBiZSBwYXJzZWQgb3JcclxuICogICBzZXJpYWxpemVkLlxyXG4gKiAtIFdoZW4gZXZhbHVhdGVkIGxvY2FsbHkgKGUuZy4gZm9yIHNuYXBzaG90LmRhdGEoKSksIHRoZXkgYnkgZGVmYXVsdFxyXG4gKiAgIGV2YWx1YXRlIHRvIGBudWxsYC4gVGhpcyBiZWhhdmlvciBjYW4gYmUgY29uZmlndXJlZCBieSBwYXNzaW5nIGN1c3RvbVxyXG4gKiAgIEZpZWxkVmFsdWVPcHRpb25zIHRvIHZhbHVlKCkuXHJcbiAqIC0gV2l0aCByZXNwZWN0IHRvIG90aGVyIFNlcnZlclRpbWVzdGFtcFZhbHVlcywgdGhleSBzb3J0IGJ5IHRoZWlyXHJcbiAqICAgbG9jYWxXcml0ZVRpbWUuXHJcbiAqL1xyXG52YXIgU2VydmVyVGltZXN0YW1wVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFNlcnZlclRpbWVzdGFtcFZhbHVlKGxvY2FsV3JpdGVUaW1lLCBwcmV2aW91c1ZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5sb2NhbFdyaXRlVGltZSA9IGxvY2FsV3JpdGVUaW1lO1xyXG4gICAgICAgIF90aGlzLnByZXZpb3VzVmFsdWUgPSBwcmV2aW91c1ZhbHVlO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5UaW1lc3RhbXBWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIGlmIChvcHRpb25zICYmXHJcbiAgICAgICAgICAgIG9wdGlvbnMuc2VydmVyVGltZXN0YW1wQmVoYXZpb3IgPT09IFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yLkVzdGltYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVGltZXN0YW1wVmFsdWUodGhpcy5sb2NhbFdyaXRlVGltZSkudmFsdWUob3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG9wdGlvbnMgJiZcclxuICAgICAgICAgICAgb3B0aW9ucy5zZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvciA9PT0gU2VydmVyVGltZXN0YW1wQmVoYXZpb3IuUHJldmlvdXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJldmlvdXNWYWx1ZSA/IHRoaXMucHJldmlvdXNWYWx1ZS52YWx1ZShvcHRpb25zKSA6IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2VydmVyVGltZXN0YW1wVmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgU2VydmVyVGltZXN0YW1wVmFsdWUgJiZcclxuICAgICAgICAgICAgdGhpcy5sb2NhbFdyaXRlVGltZS5pc0VxdWFsKG90aGVyLmxvY2FsV3JpdGVUaW1lKSk7XHJcbiAgICB9O1xyXG4gICAgU2VydmVyVGltZXN0YW1wVmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIFNlcnZlclRpbWVzdGFtcFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2FsV3JpdGVUaW1lLl9jb21wYXJlVG8ob3RoZXIubG9jYWxXcml0ZVRpbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChvdGhlciBpbnN0YW5jZW9mIFRpbWVzdGFtcFZhbHVlKSB7XHJcbiAgICAgICAgICAgIC8vIFNlcnZlciB0aW1lc3RhbXBzIGNvbWUgYWZ0ZXIgYWxsIGNvbmNyZXRlIHRpbWVzdGFtcHMuXHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFNlcnZlclRpbWVzdGFtcFZhbHVlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gJzxTZXJ2ZXJUaW1lc3RhbXAgbG9jYWxUaW1lPScgKyB0aGlzLmxvY2FsV3JpdGVUaW1lLnRvU3RyaW5nKCkgKyAnPic7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNlcnZlclRpbWVzdGFtcFZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxudmFyIEJsb2JWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEJsb2JWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEJsb2JWYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuQmxvYlZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIEJsb2JWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWU7XHJcbiAgICB9O1xyXG4gICAgQmxvYlZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIEJsb2JWYWx1ZSAmJlxyXG4gICAgICAgICAgICB0aGlzLmludGVybmFsVmFsdWUuaXNFcXVhbChvdGhlci5pbnRlcm5hbFZhbHVlKSk7XHJcbiAgICB9O1xyXG4gICAgQmxvYlZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBCbG9iVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZS5fY29tcGFyZVRvKG90aGVyLmludGVybmFsVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQmxvYlZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxudmFyIFJlZlZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUmVmVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBSZWZWYWx1ZShkYXRhYmFzZUlkLCBrZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmRhdGFiYXNlSWQgPSBkYXRhYmFzZUlkO1xyXG4gICAgICAgIF90aGlzLmtleSA9IGtleTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuUmVmVmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgUmVmVmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5rZXk7XHJcbiAgICB9O1xyXG4gICAgUmVmVmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBSZWZWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMua2V5LmlzRXF1YWwob3RoZXIua2V5KSAmJiB0aGlzLmRhdGFiYXNlSWQuaXNFcXVhbChvdGhlci5kYXRhYmFzZUlkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlZlZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBSZWZWYWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgY21wID0gdGhpcy5kYXRhYmFzZUlkLmNvbXBhcmVUbyhvdGhlci5kYXRhYmFzZUlkKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNtcCAhPT0gMCA/IGNtcCA6IERvY3VtZW50S2V5LmNvbXBhcmF0b3IodGhpcy5rZXksIG90aGVyLmtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBSZWZWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbnZhciBHZW9Qb2ludFZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoR2VvUG9pbnRWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEdlb1BvaW50VmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IGludGVybmFsVmFsdWU7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLkdlb1BvaW50VmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgR2VvUG9pbnRWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWU7XHJcbiAgICB9O1xyXG4gICAgR2VvUG9pbnRWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBHZW9Qb2ludFZhbHVlICYmXHJcbiAgICAgICAgICAgIHRoaXMuaW50ZXJuYWxWYWx1ZS5pc0VxdWFsKG90aGVyLmludGVybmFsVmFsdWUpKTtcclxuICAgIH07XHJcbiAgICBHZW9Qb2ludFZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBHZW9Qb2ludFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWUuX2NvbXBhcmVUbyhvdGhlci5pbnRlcm5hbFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEdlb1BvaW50VmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG52YXIgT2JqZWN0VmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhPYmplY3RWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIE9iamVjdFZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBpbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5PYmplY3RWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICB0aGlzLmludGVybmFsVmFsdWUuaW5vcmRlclRyYXZlcnNhbChmdW5jdGlvbiAoa2V5LCB2YWwpIHtcclxuICAgICAgICAgICAgcmVzdWx0W2tleV0gPSB2YWwudmFsdWUob3B0aW9ucyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLmludGVybmFsVmFsdWUuaW5vcmRlclRyYXZlcnNhbChhY3Rpb24pO1xyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgT2JqZWN0VmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGl0MSA9IHRoaXMuaW50ZXJuYWxWYWx1ZS5nZXRJdGVyYXRvcigpO1xyXG4gICAgICAgICAgICB2YXIgaXQyID0gb3RoZXIuaW50ZXJuYWxWYWx1ZS5nZXRJdGVyYXRvcigpO1xyXG4gICAgICAgICAgICB3aGlsZSAoaXQxLmhhc05leHQoKSAmJiBpdDIuaGFzTmV4dCgpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dDEgPSBpdDEuZ2V0TmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5leHQyID0gaXQyLmdldE5leHQoKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0MS5rZXkgIT09IG5leHQyLmtleSB8fCAhbmV4dDEudmFsdWUuaXNFcXVhbChuZXh0Mi52YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICFpdDEuaGFzTmV4dCgpICYmICFpdDIuaGFzTmV4dCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIE9iamVjdFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBpdDEgPSB0aGlzLmludGVybmFsVmFsdWUuZ2V0SXRlcmF0b3IoKTtcclxuICAgICAgICAgICAgdmFyIGl0MiA9IG90aGVyLmludGVybmFsVmFsdWUuZ2V0SXRlcmF0b3IoKTtcclxuICAgICAgICAgICAgd2hpbGUgKGl0MS5oYXNOZXh0KCkgJiYgaXQyLmhhc05leHQoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5leHQxID0gaXQxLmdldE5leHQoKTtcclxuICAgICAgICAgICAgICAgIHZhciBuZXh0MiA9IGl0Mi5nZXROZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgY21wID0gcHJpbWl0aXZlQ29tcGFyYXRvcihuZXh0MS5rZXksIG5leHQyLmtleSkgfHxcclxuICAgICAgICAgICAgICAgICAgICBuZXh0MS52YWx1ZS5jb21wYXJlVG8obmV4dDIudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNtcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjbXA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gT25seSBlcXVhbCBpZiBib3RoIGl0ZXJhdG9ycyBhcmUgZXhoYXVzdGVkXHJcbiAgICAgICAgICAgIHJldHVybiBwcmltaXRpdmVDb21wYXJhdG9yKGl0MS5oYXNOZXh0KCksIGl0Mi5oYXNOZXh0KCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAocGF0aCwgdG8pIHtcclxuICAgICAgICBhc3NlcnQoIXBhdGguaXNFbXB0eSgpLCAnQ2Fubm90IHNldCBmaWVsZCBmb3IgZW1wdHkgcGF0aCBvbiBPYmplY3RWYWx1ZScpO1xyXG4gICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRDaGlsZChwYXRoLmZpcnN0U2VnbWVudCgpLCB0byk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLmNoaWxkKHBhdGguZmlyc3RTZWdtZW50KCkpO1xyXG4gICAgICAgICAgICBpZiAoIShjaGlsZCBpbnN0YW5jZW9mIE9iamVjdFZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgY2hpbGQgPSBPYmplY3RWYWx1ZS5FTVBUWTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbmV3Q2hpbGQgPSBjaGlsZC5zZXQocGF0aC5wb3BGaXJzdCgpLCB0byk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldENoaWxkKHBhdGguZmlyc3RTZWdtZW50KCksIG5ld0NoaWxkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgYXNzZXJ0KCFwYXRoLmlzRW1wdHkoKSwgJ0Nhbm5vdCBkZWxldGUgZmllbGQgZm9yIGVtcHR5IHBhdGggb24gT2JqZWN0VmFsdWUnKTtcclxuICAgICAgICBpZiAocGF0aC5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBPYmplY3RWYWx1ZSh0aGlzLmludGVybmFsVmFsdWUucmVtb3ZlKHBhdGguZmlyc3RTZWdtZW50KCkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIG5lc3RlZCBmaWVsZFxyXG4gICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLmNoaWxkKHBhdGguZmlyc3RTZWdtZW50KCkpO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQgaW5zdGFuY2VvZiBPYmplY3RWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5ld0NoaWxkID0gY2hpbGQuZGVsZXRlKHBhdGgucG9wRmlyc3QoKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE9iamVjdFZhbHVlKHRoaXMuaW50ZXJuYWxWYWx1ZS5pbnNlcnQocGF0aC5maXJzdFNlZ21lbnQoKSwgbmV3Q2hpbGQpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIERvbid0IGFjdHVhbGx5IGNoYW5nZSBhIHByaW1pdGl2ZSB2YWx1ZSB0byBhbiBvYmplY3QgZm9yIGEgZGVsZXRlXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUuY29udGFpbnMgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkKHBhdGgpICE9PSB1bmRlZmluZWQ7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLmZpZWxkID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICBhc3NlcnQoIXBhdGguaXNFbXB0eSgpLCBcIkNhbid0IGdldCBmaWVsZCBvZiBlbXB0eSBwYXRoXCIpO1xyXG4gICAgICAgIHZhciBmaWVsZCA9IHRoaXM7XHJcbiAgICAgICAgcGF0aC5mb3JFYWNoKGZ1bmN0aW9uIChwYXRoU2VnbWVudCkge1xyXG4gICAgICAgICAgICBpZiAoZmllbGQgaW5zdGFuY2VvZiBPYmplY3RWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgZmllbGQgPSBmaWVsZC5pbnRlcm5hbFZhbHVlLmdldChwYXRoU2VnbWVudCkgfHwgdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZmllbGQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZmllbGQ7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnZhbHVlKCkpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS5jaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlLmdldChjaGlsZE5hbWUpIHx8IHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUuc2V0Q2hpbGQgPSBmdW5jdGlvbiAoY2hpbGROYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgT2JqZWN0VmFsdWUodGhpcy5pbnRlcm5hbFZhbHVlLmluc2VydChjaGlsZE5hbWUsIHZhbHVlKSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUuRU1QVFkgPSBuZXcgT2JqZWN0VmFsdWUobmV3IFNvcnRlZE1hcChwcmltaXRpdmVDb21wYXJhdG9yKSk7XHJcbiAgICByZXR1cm4gT2JqZWN0VmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG52YXIgQXJyYXlWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEFycmF5VmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBBcnJheVZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBpbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5BcnJheVZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIEFycmF5VmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlLm1hcChmdW5jdGlvbiAodikgeyByZXR1cm4gdi52YWx1ZShvcHRpb25zKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlWYWx1ZS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLmludGVybmFsVmFsdWUuZm9yRWFjaChhY3Rpb24pO1xyXG4gICAgfTtcclxuICAgIEFycmF5VmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBBcnJheVZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmludGVybmFsVmFsdWUubGVuZ3RoICE9PSBvdGhlci5pbnRlcm5hbFZhbHVlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pbnRlcm5hbFZhbHVlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaW50ZXJuYWxWYWx1ZVtpXS5pc0VxdWFsKG90aGVyLmludGVybmFsVmFsdWVbaV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgQXJyYXlWYWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgbWluTGVuZ3RoID0gTWF0aC5taW4odGhpcy5pbnRlcm5hbFZhbHVlLmxlbmd0aCwgb3RoZXIuaW50ZXJuYWxWYWx1ZS5sZW5ndGgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1pbkxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY21wID0gdGhpcy5pbnRlcm5hbFZhbHVlW2ldLmNvbXBhcmVUbyhvdGhlci5pbnRlcm5hbFZhbHVlW2ldKTtcclxuICAgICAgICAgICAgICAgIGlmIChjbXApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY21wO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMuaW50ZXJuYWxWYWx1ZS5sZW5ndGgsIG90aGVyLmludGVybmFsVmFsdWUubGVuZ3RoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBcnJheVZhbHVlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy52YWx1ZSgpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQXJyYXlWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBVbnR5cGVkIE51bWJlciBhbGlhcyB3ZSBjYW4gdXNlIHRvIGNoZWNrIGZvciBFUzYgbWV0aG9kcyAvIHByb3BlcnRpZXMuXHJcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgdmFyaWFibGUtbmFtZVxyXG52YXIgTnVtYmVyQXNBbnkgPSBOdW1iZXI7XHJcbi8qKlxyXG4gKiBNaW5pbXVtIHNhZmUgaW50ZWdlciBpbiBKYXZhc2NyaXB0IGJlY2F1c2Ugb2YgZmxvYXRpbmcgcG9pbnQgcHJlY2lzaW9uLlxyXG4gKiBBZGRlZCB0byBub3QgcmVseSBvbiBFUzYgZmVhdHVyZXMuXHJcbiAqL1xyXG52YXIgTUlOX1NBRkVfSU5URUdFUiA9IE51bWJlckFzQW55Lk1JTl9TQUZFX0lOVEVHRVIgfHwgLShNYXRoLnBvdygyLCA1MykgLSAxKTtcclxuLyoqXHJcbiAqIE1heGltdW0gc2FmZSBpbnRlZ2VyIGluIEphdmFzY3JpcHQgYmVjYXVzZSBvZiBmbG9hdGluZyBwb2ludCBwcmVjaXNpb24uXHJcbiAqIEFkZGVkIHRvIG5vdCByZWx5IG9uIEVTNiBmZWF0dXJlcy5cclxuICovXHJcbnZhciBNQVhfU0FGRV9JTlRFR0VSID0gTnVtYmVyQXNBbnkuTUFYX1NBRkVfSU5URUdFUiB8fCBNYXRoLnBvdygyLCA1MykgLSAxO1xyXG4vKipcclxuICogUmV0dXJucyB3aGV0aGVyIGFuIG51bWJlciBpcyBhbiBpbnRlZ2VyLCB1c2VzIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbiBpZlxyXG4gKiBhdmFpbGFibGUuXHJcbiAqIEFkZGVkIHRvIG5vdCByZWx5IG9uIEVTNiBmZWF0dXJlcy5cclxuICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0byB0ZXN0IGZvciBiZWluZyBhbiBpbnRlZ2VyXHJcbiAqL1xyXG52YXIgaXNJbnRlZ2VyID0gTnVtYmVyQXNBbnkuaXNJbnRlZ2VyIHx8XHJcbiAgICAoZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiZcclxuICAgICAgICAgICAgaXNGaW5pdGUodmFsdWUpICYmXHJcbiAgICAgICAgICAgIE1hdGguZmxvb3IodmFsdWUpID09PSB2YWx1ZTtcclxuICAgIH0pO1xyXG4vKipcclxuICogUmV0dXJucyB3aGV0aGVyIGEgdmFyaWFibGUgaXMgZWl0aGVyIHVuZGVmaW5lZCBvciBudWxsLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpIHtcclxuICAgIHJldHVybiB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHdoZXRoZXIgYSB2YWx1ZSBpcyBhbiBpbnRlZ2VyIGFuZCBpbiB0aGUgc2FmZSBpbnRlZ2VyIHJhbmdlXHJcbiAqIEBwYXJhbSB2YWx1ZSBUaGUgdmFsdWUgdG8gdGVzdCBmb3IgYmVpbmcgYW4gaW50ZWdlciBhbmQgaW4gdGhlIHNhZmUgcmFuZ2VcclxuICovXHJcbmZ1bmN0aW9uIGlzU2FmZUludGVnZXIodmFsdWUpIHtcclxuICAgIHJldHVybiAoaXNJbnRlZ2VyKHZhbHVlKSAmJlxyXG4gICAgICAgIHZhbHVlIDw9IE1BWF9TQUZFX0lOVEVHRVIgJiZcclxuICAgICAgICB2YWx1ZSA+PSBNSU5fU0FGRV9JTlRFR0VSKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIFF1ZXJ5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnkocGF0aCwgZXhwbGljaXRPcmRlckJ5LCBmaWx0ZXJzLCBsaW1pdCwgc3RhcnRBdCwgZW5kQXQpIHtcclxuICAgICAgICBpZiAoZXhwbGljaXRPcmRlckJ5ID09PSB2b2lkIDApIHsgZXhwbGljaXRPcmRlckJ5ID0gW107IH1cclxuICAgICAgICBpZiAoZmlsdGVycyA9PT0gdm9pZCAwKSB7IGZpbHRlcnMgPSBbXTsgfVxyXG4gICAgICAgIGlmIChsaW1pdCA9PT0gdm9pZCAwKSB7IGxpbWl0ID0gbnVsbDsgfVxyXG4gICAgICAgIGlmIChzdGFydEF0ID09PSB2b2lkIDApIHsgc3RhcnRBdCA9IG51bGw7IH1cclxuICAgICAgICBpZiAoZW5kQXQgPT09IHZvaWQgMCkgeyBlbmRBdCA9IG51bGw7IH1cclxuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xyXG4gICAgICAgIHRoaXMuZXhwbGljaXRPcmRlckJ5ID0gZXhwbGljaXRPcmRlckJ5O1xyXG4gICAgICAgIHRoaXMuZmlsdGVycyA9IGZpbHRlcnM7XHJcbiAgICAgICAgdGhpcy5saW1pdCA9IGxpbWl0O1xyXG4gICAgICAgIHRoaXMuc3RhcnRBdCA9IHN0YXJ0QXQ7XHJcbiAgICAgICAgdGhpcy5lbmRBdCA9IGVuZEF0O1xyXG4gICAgICAgIHRoaXMubWVtb2l6ZWRDYW5vbmljYWxJZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5tZW1vaXplZE9yZGVyQnkgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXJ0QXQpIHtcclxuICAgICAgICAgICAgdGhpcy5hc3NlcnRWYWxpZEJvdW5kKHRoaXMuc3RhcnRBdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmVuZEF0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXNzZXJ0VmFsaWRCb3VuZCh0aGlzLmVuZEF0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBRdWVyeS5hdFBhdGggPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkocGF0aCk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFF1ZXJ5LnByb3RvdHlwZSwgXCJvcmRlckJ5XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubWVtb2l6ZWRPcmRlckJ5ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5lcXVhbGl0eUZpZWxkID0gdGhpcy5nZXRJbmVxdWFsaXR5RmlsdGVyRmllbGQoKTtcclxuICAgICAgICAgICAgICAgIHZhciBmaXJzdE9yZGVyQnlGaWVsZCA9IHRoaXMuZ2V0Rmlyc3RPcmRlckJ5RmllbGQoKTtcclxuICAgICAgICAgICAgICAgIGlmIChpbmVxdWFsaXR5RmllbGQgIT09IG51bGwgJiYgZmlyc3RPcmRlckJ5RmllbGQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJbiBvcmRlciB0byBpbXBsaWNpdGx5IGFkZCBrZXkgb3JkZXJpbmcsIHdlIG11c3QgYWxzbyBhZGQgdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaW5lcXVhbGl0eSBmaWx0ZXIgZmllbGQgZm9yIGl0IHRvIGJlIGEgdmFsaWQgcXVlcnkuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTm90ZSB0aGF0IHRoZSBkZWZhdWx0IGluZXF1YWxpdHkgZmllbGQgYW5kIGtleSBvcmRlcmluZyBpcyBhc2NlbmRpbmcuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZXF1YWxpdHlGaWVsZC5pc0tleUZpZWxkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW1vaXplZE9yZGVyQnkgPSBbS0VZX09SREVSSU5HX0FTQ107XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbW9pemVkT3JkZXJCeSA9IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBPcmRlckJ5KGluZXF1YWxpdHlGaWVsZCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBLRVlfT1JERVJJTkdfQVNDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KGluZXF1YWxpdHlGaWVsZCA9PT0gbnVsbCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoZmlyc3RPcmRlckJ5RmllbGQgIT09IG51bGwgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZXF1YWxpdHlGaWVsZC5pc0VxdWFsKGZpcnN0T3JkZXJCeUZpZWxkKSksICdGaXJzdCBvcmRlckJ5IHNob3VsZCBtYXRjaCBpbmVxdWFsaXR5IGZpZWxkLicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVtb2l6ZWRPcmRlckJ5ID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kS2V5T3JkZXJpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5leHBsaWNpdE9yZGVyQnk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcmRlckJ5ID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbW9pemVkT3JkZXJCeS5wdXNoKG9yZGVyQnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3JkZXJCeS5maWVsZC5pc0tleUZpZWxkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kS2V5T3JkZXJpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZm91bmRLZXlPcmRlcmluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgb3JkZXIgb2YgdGhlIGltcGxpY2l0IGtleSBvcmRlcmluZyBhbHdheXMgbWF0Y2hlcyB0aGUgbGFzdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBleHBsaWNpdCBvcmRlciBieVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdERpcmVjdGlvbiA9IHRoaXMuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5leHBsaWNpdE9yZGVyQnlbdGhpcy5leHBsaWNpdE9yZGVyQnkubGVuZ3RoIC0gMV0uZGlyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IERpcmVjdGlvbi5BU0NFTkRJTkc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVtb2l6ZWRPcmRlckJ5LnB1c2gobGFzdERpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkFTQ0VORElOR1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBLRVlfT1JERVJJTkdfQVNDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IEtFWV9PUkRFUklOR19ERVNDKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVtb2l6ZWRPcmRlckJ5O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmFkZEZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5nZXRJbmVxdWFsaXR5RmlsdGVyRmllbGQoKSA9PSBudWxsIHx8XHJcbiAgICAgICAgICAgICEoZmlsdGVyIGluc3RhbmNlb2YgUmVsYXRpb25GaWx0ZXIpIHx8XHJcbiAgICAgICAgICAgICFmaWx0ZXIuaXNJbmVxdWFsaXR5KCkgfHxcclxuICAgICAgICAgICAgZmlsdGVyLmZpZWxkLmlzRXF1YWwodGhpcy5nZXRJbmVxdWFsaXR5RmlsdGVyRmllbGQoKSksICdRdWVyeSBtdXN0IG9ubHkgaGF2ZSBvbmUgaW5lcXVhbGl0eSBmaWVsZC4nKTtcclxuICAgICAgICBhc3NlcnQoIURvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkodGhpcy5wYXRoKSwgJ05vIGZpbHRlcmluZyBhbGxvd2VkIGZvciBkb2N1bWVudCBxdWVyeScpO1xyXG4gICAgICAgIHZhciBuZXdGaWx0ZXJzID0gdGhpcy5maWx0ZXJzLmNvbmNhdChbZmlsdGVyXSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSh0aGlzLnBhdGgsIHRoaXMuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIG5ld0ZpbHRlcnMsIHRoaXMubGltaXQsIHRoaXMuc3RhcnRBdCwgdGhpcy5lbmRBdCk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmFkZE9yZGVyQnkgPSBmdW5jdGlvbiAob3JkZXJCeSkge1xyXG4gICAgICAgIGFzc2VydCghRG9jdW1lbnRLZXkuaXNEb2N1bWVudEtleSh0aGlzLnBhdGgpLCAnTm8gb3JkZXJpbmcgYWxsb3dlZCBmb3IgZG9jdW1lbnQgcXVlcnknKTtcclxuICAgICAgICBhc3NlcnQoIXRoaXMuc3RhcnRBdCAmJiAhdGhpcy5lbmRBdCwgJ0JvdW5kcyBtdXN0IGJlIHNldCBhZnRlciBvcmRlckJ5Jyk7XHJcbiAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiB2YWxpZGF0ZSB0aGF0IG9yZGVyQnkgZG9lcyBub3QgbGlzdCB0aGUgc2FtZSBrZXkgdHdpY2UuXHJcbiAgICAgICAgdmFyIG5ld09yZGVyQnkgPSB0aGlzLmV4cGxpY2l0T3JkZXJCeS5jb25jYXQoW29yZGVyQnldKTtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucGF0aCwgbmV3T3JkZXJCeSwgdGhpcy5maWx0ZXJzLnNsaWNlKCksIHRoaXMubGltaXQsIHRoaXMuc3RhcnRBdCwgdGhpcy5lbmRBdCk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLndpdGhMaW1pdCA9IGZ1bmN0aW9uIChsaW1pdCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkodGhpcy5wYXRoLCB0aGlzLmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCB0aGlzLmZpbHRlcnMuc2xpY2UoKSwgbGltaXQsIHRoaXMuc3RhcnRBdCwgdGhpcy5lbmRBdCk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLndpdGhTdGFydEF0ID0gZnVuY3Rpb24gKGJvdW5kKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSh0aGlzLnBhdGgsIHRoaXMuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIHRoaXMuZmlsdGVycy5zbGljZSgpLCB0aGlzLmxpbWl0LCBib3VuZCwgdGhpcy5lbmRBdCk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLndpdGhFbmRBdCA9IGZ1bmN0aW9uIChib3VuZCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkodGhpcy5wYXRoLCB0aGlzLmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCB0aGlzLmZpbHRlcnMuc2xpY2UoKSwgdGhpcy5saW1pdCwgdGhpcy5zdGFydEF0LCBib3VuZCk7XHJcbiAgICB9O1xyXG4gICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogVGhpcyBpcyB1c2VkIHRvIGdldCBhIHVuaXF1ZSBzdHJpbmcgZnJvbSBhIHF1ZXJ5IHRvLCBmb3JcclxuICAgIC8vIGV4YW1wbGUsIHVzZSBhcyBhIGRpY3Rpb25hcnkga2V5LCBidXQgdGhlIGltcGxlbWVudGF0aW9uIGlzIHN1YmplY3QgdG9cclxuICAgIC8vIGNvbGxpc2lvbnMuIE1ha2UgaXQgY29sbGlzaW9uLWZyZWUuXHJcbiAgICBRdWVyeS5wcm90b3R5cGUuY2Fub25pY2FsSWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubWVtb2l6ZWRDYW5vbmljYWxJZCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgY2Fub25pY2FsSWQgPSB0aGlzLnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIGNhbm9uaWNhbElkICs9ICd8ZjonO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5maWx0ZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZpbHRlciA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9IGZpbHRlci5jYW5vbmljYWxJZCgpO1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gJywnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhbm9uaWNhbElkICs9ICd8b2I6JztcclxuICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBtYWtlIHRoaXMgY29sbGlzaW9uIHJlc2lzdGFudFxyXG4gICAgICAgICAgICBmb3IgKHZhciBfYiA9IDAsIF9jID0gdGhpcy5vcmRlckJ5OyBfYiA8IF9jLmxlbmd0aDsgX2IrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9yZGVyQnkgPSBfY1tfYl07XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSBvcmRlckJ5LmNhbm9uaWNhbElkKCk7XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSAnLCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLmxpbWl0KSkge1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gJ3xsOic7XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSB0aGlzLmxpbWl0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXJ0QXQpIHtcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9ICd8bGI6JztcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9IHRoaXMuc3RhcnRBdC5jYW5vbmljYWxJZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuZEF0KSB7XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSAnfHViOic7XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSB0aGlzLmVuZEF0LmNhbm9uaWNhbElkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tZW1vaXplZENhbm9uaWNhbElkID0gY2Fub25pY2FsSWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLm1lbW9pemVkQ2Fub25pY2FsSWQ7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzdHIgPSAnUXVlcnkoJyArIHRoaXMucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcclxuICAgICAgICBpZiAodGhpcy5maWx0ZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgc3RyICs9IFwiLCBmaWx0ZXJzOiBbXCIgKyB0aGlzLmZpbHRlcnMuam9pbignLCAnKSArIFwiXVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubGltaXQpKSB7XHJcbiAgICAgICAgICAgIHN0ciArPSAnLCBsaW1pdDogJyArIHRoaXMubGltaXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHN0ciArPSBcIiwgb3JkZXJCeTogW1wiICsgdGhpcy5leHBsaWNpdE9yZGVyQnkuam9pbignLCAnKSArIFwiXVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5zdGFydEF0KSB7XHJcbiAgICAgICAgICAgIHN0ciArPSAnLCBzdGFydEF0OiAnICsgdGhpcy5zdGFydEF0LmNhbm9uaWNhbElkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmVuZEF0KSB7XHJcbiAgICAgICAgICAgIHN0ciArPSAnLCBlbmRBdDogJyArIHRoaXMuZW5kQXQuY2Fub25pY2FsSWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0ciArICcpJztcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICh0aGlzLmxpbWl0ICE9PSBvdGhlci5saW1pdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm9yZGVyQnkubGVuZ3RoICE9PSBvdGhlci5vcmRlckJ5Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vcmRlckJ5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5vcmRlckJ5W2ldLmlzRXF1YWwob3RoZXIub3JkZXJCeVtpXSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5maWx0ZXJzLmxlbmd0aCAhPT0gb3RoZXIuZmlsdGVycy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZmlsdGVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZmlsdGVyc1tpXS5pc0VxdWFsKG90aGVyLmZpbHRlcnNbaV0pKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLnBhdGguaXNFcXVhbChvdGhlci5wYXRoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnN0YXJ0QXQgIT09IG51bGxcclxuICAgICAgICAgICAgPyAhdGhpcy5zdGFydEF0LmlzRXF1YWwob3RoZXIuc3RhcnRBdClcclxuICAgICAgICAgICAgOiBvdGhlci5zdGFydEF0ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5kQXQgIT09IG51bGxcclxuICAgICAgICAgICAgPyB0aGlzLmVuZEF0LmlzRXF1YWwob3RoZXIuZW5kQXQpXHJcbiAgICAgICAgICAgIDogb3RoZXIuZW5kQXQgPT09IG51bGw7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmRvY0NvbXBhcmF0b3IgPSBmdW5jdGlvbiAoZDEsIGQyKSB7XHJcbiAgICAgICAgdmFyIGNvbXBhcmVkT25LZXlGaWVsZCA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLm9yZGVyQnk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvcmRlckJ5ID0gX2FbX2ldO1xyXG4gICAgICAgICAgICB2YXIgY29tcCA9IG9yZGVyQnkuY29tcGFyZShkMSwgZDIpO1xyXG4gICAgICAgICAgICBpZiAoY29tcCAhPT0gMClcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wO1xyXG4gICAgICAgICAgICBjb21wYXJlZE9uS2V5RmllbGQgPSBjb21wYXJlZE9uS2V5RmllbGQgfHwgb3JkZXJCeS5maWVsZC5pc0tleUZpZWxkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEFzc2VydCB0aGF0IHdlIGFjdHVhbGx5IGNvbXBhcmVkIGJ5IGtleVxyXG4gICAgICAgIGFzc2VydChjb21wYXJlZE9uS2V5RmllbGQsIFwib3JkZXJCeSB1c2VkIHRoYXQgZG9lc24ndCBjb21wYXJlIG9uIGtleSBmaWVsZFwiKTtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUubWF0Y2hlcyA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMubWF0Y2hlc0FuY2VzdG9yKGRvYykgJiZcclxuICAgICAgICAgICAgdGhpcy5tYXRjaGVzT3JkZXJCeShkb2MpICYmXHJcbiAgICAgICAgICAgIHRoaXMubWF0Y2hlc0ZpbHRlcnMoZG9jKSAmJlxyXG4gICAgICAgICAgICB0aGlzLm1hdGNoZXNCb3VuZHMoZG9jKSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmhhc0xpbWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5saW1pdCk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmdldEZpcnN0T3JkZXJCeUZpZWxkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggPiAwXHJcbiAgICAgICAgICAgID8gdGhpcy5leHBsaWNpdE9yZGVyQnlbMF0uZmllbGRcclxuICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5nZXRJbmVxdWFsaXR5RmlsdGVyRmllbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZmlsdGVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGZpbHRlciA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKGZpbHRlciBpbnN0YW5jZW9mIFJlbGF0aW9uRmlsdGVyICYmIGZpbHRlci5pc0luZXF1YWxpdHkoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlci5maWVsZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuaGFzQXJyYXlDb250YWluc0ZpbHRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuZmlsdGVycy5maW5kKGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbHRlciBpbnN0YW5jZW9mIFJlbGF0aW9uRmlsdGVyICYmXHJcbiAgICAgICAgICAgICAgICBmaWx0ZXIub3AgPT09IFJlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlM7XHJcbiAgICAgICAgfSkgIT09IHVuZGVmaW5lZCk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmlzRG9jdW1lbnRRdWVyeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gRG9jdW1lbnRLZXkuaXNEb2N1bWVudEtleSh0aGlzLnBhdGgpICYmIHRoaXMuZmlsdGVycy5sZW5ndGggPT09IDA7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLm1hdGNoZXNBbmNlc3RvciA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICB2YXIgZG9jUGF0aCA9IGRvYy5rZXkucGF0aDtcclxuICAgICAgICBpZiAoRG9jdW1lbnRLZXkuaXNEb2N1bWVudEtleSh0aGlzLnBhdGgpKSB7XHJcbiAgICAgICAgICAgIC8vIGV4YWN0IG1hdGNoIGZvciBkb2N1bWVudCBxdWVyaWVzXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhdGguaXNFcXVhbChkb2NQYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHNoYWxsb3cgYW5jZXN0b3IgcXVlcmllcyBieSBkZWZhdWx0XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5wYXRoLmlzUHJlZml4T2YoZG9jUGF0aCkgJiYgdGhpcy5wYXRoLmxlbmd0aCA9PT0gZG9jUGF0aC5sZW5ndGggLSAxKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBIGRvY3VtZW50IG11c3QgaGF2ZSBhIHZhbHVlIGZvciBldmVyeSBvcmRlcmluZyBjbGF1c2UgaW4gb3JkZXIgdG8gc2hvdyB1cFxyXG4gICAgICogaW4gdGhlIHJlc3VsdHMuXHJcbiAgICAgKi9cclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5tYXRjaGVzT3JkZXJCeSA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5leHBsaWNpdE9yZGVyQnk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvcmRlckJ5ID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAvLyBvcmRlciBieSBrZXkgYWx3YXlzIG1hdGNoZXNcclxuICAgICAgICAgICAgaWYgKCFvcmRlckJ5LmZpZWxkLmlzS2V5RmllbGQoKSAmJlxyXG4gICAgICAgICAgICAgICAgZG9jLmZpZWxkKG9yZGVyQnkuZmllbGQpID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUubWF0Y2hlc0ZpbHRlcnMgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZmlsdGVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGZpbHRlciA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKCFmaWx0ZXIubWF0Y2hlcyhkb2MpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBNYWtlcyBzdXJlIGEgZG9jdW1lbnQgaXMgd2l0aGluIHRoZSBib3VuZHMsIGlmIHByb3ZpZGVkLlxyXG4gICAgICovXHJcbiAgICBRdWVyeS5wcm90b3R5cGUubWF0Y2hlc0JvdW5kcyA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICBpZiAodGhpcy5zdGFydEF0ICYmICF0aGlzLnN0YXJ0QXQuc29ydHNCZWZvcmVEb2N1bWVudCh0aGlzLm9yZGVyQnksIGRvYykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5lbmRBdCAmJiB0aGlzLmVuZEF0LnNvcnRzQmVmb3JlRG9jdW1lbnQodGhpcy5vcmRlckJ5LCBkb2MpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmFzc2VydFZhbGlkQm91bmQgPSBmdW5jdGlvbiAoYm91bmQpIHtcclxuICAgICAgICBhc3NlcnQoYm91bmQucG9zaXRpb24ubGVuZ3RoIDw9IHRoaXMub3JkZXJCeS5sZW5ndGgsICdCb3VuZCBpcyBsb25nZXIgdGhhbiBvcmRlckJ5Jyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5O1xyXG59KCkpO1xyXG52YXIgRmlsdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlsdGVyKCkge1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgZmlsdGVyIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBhcmd1bWVudHMuXHJcbiAgICAgKi9cclxuICAgIEZpbHRlci5jcmVhdGUgPSBmdW5jdGlvbiAoZmllbGQsIG9wLCB2YWx1ZSkge1xyXG4gICAgICAgIGlmICh2YWx1ZS5pc0VxdWFsKE51bGxWYWx1ZS5JTlNUQU5DRSkpIHtcclxuICAgICAgICAgICAgaWYgKG9wICE9PSBSZWxhdGlvbk9wLkVRVUFMKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnSW52YWxpZCBxdWVyeS4gWW91IGNhbiBvbmx5IHBlcmZvcm0gZXF1YWxzIGNvbXBhcmlzb25zIG9uIG51bGwuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBOdWxsRmlsdGVyKGZpZWxkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUuaXNFcXVhbChEb3VibGVWYWx1ZS5OQU4pKSB7XHJcbiAgICAgICAgICAgIGlmIChvcCAhPT0gUmVsYXRpb25PcC5FUVVBTCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBjYW4gb25seSBwZXJmb3JtIGVxdWFscyBjb21wYXJpc29ucyBvbiBOYU4uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBOYW5GaWx0ZXIoZmllbGQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWxhdGlvbkZpbHRlcihmaWVsZCwgb3AsIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpbHRlcjtcclxufSgpKTtcclxudmFyIFJlbGF0aW9uT3AgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZWxhdGlvbk9wKG5hbWUpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgfVxyXG4gICAgUmVsYXRpb25PcC5mcm9tU3RyaW5nID0gZnVuY3Rpb24gKG9wKSB7XHJcbiAgICAgICAgc3dpdGNoIChvcCkge1xyXG4gICAgICAgICAgICBjYXNlICc8JzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkxFU1NfVEhBTjtcclxuICAgICAgICAgICAgY2FzZSAnPD0nOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuTEVTU19USEFOX09SX0VRVUFMO1xyXG4gICAgICAgICAgICBjYXNlICc9PSc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5FUVVBTDtcclxuICAgICAgICAgICAgY2FzZSAnPj0nOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuR1JFQVRFUl9USEFOX09SX0VRVUFMO1xyXG4gICAgICAgICAgICBjYXNlICc+JzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkdSRUFURVJfVEhBTjtcclxuICAgICAgICAgICAgY2FzZSAnYXJyYXktY29udGFpbnMnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlM7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biByZWxhdGlvbjogJyArIG9wKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVsYXRpb25PcC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTtcclxuICAgIH07XHJcbiAgICBSZWxhdGlvbk9wLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZSA9PT0gb3RoZXIubmFtZTtcclxuICAgIH07XHJcbiAgICBSZWxhdGlvbk9wLkxFU1NfVEhBTiA9IG5ldyBSZWxhdGlvbk9wKCc8Jyk7XHJcbiAgICBSZWxhdGlvbk9wLkxFU1NfVEhBTl9PUl9FUVVBTCA9IG5ldyBSZWxhdGlvbk9wKCc8PScpO1xyXG4gICAgUmVsYXRpb25PcC5FUVVBTCA9IG5ldyBSZWxhdGlvbk9wKCc9PScpO1xyXG4gICAgUmVsYXRpb25PcC5HUkVBVEVSX1RIQU4gPSBuZXcgUmVsYXRpb25PcCgnPicpO1xyXG4gICAgUmVsYXRpb25PcC5HUkVBVEVSX1RIQU5fT1JfRVFVQUwgPSBuZXcgUmVsYXRpb25PcCgnPj0nKTtcclxuICAgIFJlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlMgPSBuZXcgUmVsYXRpb25PcCgnYXJyYXktY29udGFpbnMnKTtcclxuICAgIHJldHVybiBSZWxhdGlvbk9wO1xyXG59KCkpO1xyXG52YXIgUmVsYXRpb25GaWx0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhSZWxhdGlvbkZpbHRlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFJlbGF0aW9uRmlsdGVyKGZpZWxkLCBvcCwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmZpZWxkID0gZmllbGQ7XHJcbiAgICAgICAgX3RoaXMub3AgPSBvcDtcclxuICAgICAgICBfdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFJlbGF0aW9uRmlsdGVyLnByb3RvdHlwZS5tYXRjaGVzID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIGlmICh0aGlzLmZpZWxkLmlzS2V5RmllbGQoKSkge1xyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy52YWx1ZSBpbnN0YW5jZW9mIFJlZlZhbHVlLCAnQ29tcGFyaW5nIG9uIGtleSwgYnV0IGZpbHRlciB2YWx1ZSBub3QgYSBSZWZWYWx1ZScpO1xyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy5vcCAhPT0gUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUywgXCJhcnJheS1jb250YWlucyBxdWVyaWVzIGRvbid0IG1ha2Ugc2Vuc2Ugb24gZG9jdW1lbnQga2V5cy5cIik7XHJcbiAgICAgICAgICAgIHZhciByZWZWYWx1ZSA9IHRoaXMudmFsdWU7XHJcbiAgICAgICAgICAgIHZhciBjb21wYXJpc29uID0gRG9jdW1lbnRLZXkuY29tcGFyYXRvcihkb2Mua2V5LCByZWZWYWx1ZS5rZXkpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tYXRjaGVzQ29tcGFyaXNvbihjb21wYXJpc29uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB2YWwgPSBkb2MuZmllbGQodGhpcy5maWVsZCk7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWwgIT09IHVuZGVmaW5lZCAmJiB0aGlzLm1hdGNoZXNWYWx1ZSh2YWwpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZWxhdGlvbkZpbHRlci5wcm90b3R5cGUubWF0Y2hlc1ZhbHVlID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5vcCA9PT0gUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUykge1xyXG4gICAgICAgICAgICByZXR1cm4gKHZhbHVlIGluc3RhbmNlb2YgQXJyYXlWYWx1ZSAmJlxyXG4gICAgICAgICAgICAgICAgdmFsdWUuaW50ZXJuYWxWYWx1ZS5maW5kKGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBlbGVtZW50LmlzRXF1YWwoX3RoaXMudmFsdWUpOyB9KSAhPT1cclxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gT25seSBjb21wYXJlIHR5cGVzIHdpdGggbWF0Y2hpbmcgYmFja2VuZCBvcmRlciAoc3VjaCBhcyBkb3VibGUgYW5kIGludCkuXHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy52YWx1ZS50eXBlT3JkZXIgPT09IHZhbHVlLnR5cGVPcmRlciAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXRjaGVzQ29tcGFyaXNvbih2YWx1ZS5jb21wYXJlVG8odGhpcy52YWx1ZSkpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVsYXRpb25GaWx0ZXIucHJvdG90eXBlLm1hdGNoZXNDb21wYXJpc29uID0gZnVuY3Rpb24gKGNvbXBhcmlzb24pIHtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMub3ApIHtcclxuICAgICAgICAgICAgY2FzZSBSZWxhdGlvbk9wLkxFU1NfVEhBTjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uIDwgMDtcclxuICAgICAgICAgICAgY2FzZSBSZWxhdGlvbk9wLkxFU1NfVEhBTl9PUl9FUVVBTDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uIDw9IDA7XHJcbiAgICAgICAgICAgIGNhc2UgUmVsYXRpb25PcC5FUVVBTDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uID09PSAwO1xyXG4gICAgICAgICAgICBjYXNlIFJlbGF0aW9uT3AuR1JFQVRFUl9USEFOOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmlzb24gPiAwO1xyXG4gICAgICAgICAgICBjYXNlIFJlbGF0aW9uT3AuR1JFQVRFUl9USEFOX09SX0VRVUFMOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmlzb24gPj0gMDtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIHJlbGF0aW9uIG9wJyArIHRoaXMub3ApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZWxhdGlvbkZpbHRlci5wcm90b3R5cGUuaXNJbmVxdWFsaXR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5vcCAhPT0gUmVsYXRpb25PcC5FUVVBTCAmJiB0aGlzLm9wICE9PSBSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TKTtcclxuICAgIH07XHJcbiAgICBSZWxhdGlvbkZpbHRlci5wcm90b3R5cGUuY2Fub25pY2FsSWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogVGVjaG5pY2FsbHksIHRoaXMgd29uJ3QgYmUgdW5pcXVlIGlmIHR3byB2YWx1ZXMgaGF2ZVxyXG4gICAgICAgIC8vIHRoZSBzYW1lIGRlc2NyaXB0aW9uLCBzdWNoIGFzIHRoZSBpbnQgMyBhbmQgdGhlIHN0cmluZyBcIjNcIi4gU28gd2Ugc2hvdWxkXHJcbiAgICAgICAgLy8gYWRkIHRoZSB0eXBlcyBpbiBoZXJlIHNvbWVob3csIHRvby5cclxuICAgICAgICByZXR1cm4gKHRoaXMuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyB0aGlzLm9wLnRvU3RyaW5nKCkgKyB0aGlzLnZhbHVlLnRvU3RyaW5nKCkpO1xyXG4gICAgfTtcclxuICAgIFJlbGF0aW9uRmlsdGVyLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVsYXRpb25GaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLm9wLmlzRXF1YWwob3RoZXIub3ApICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLmlzRXF1YWwob3RoZXIuZmllbGQpICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlLmlzRXF1YWwob3RoZXIudmFsdWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVsYXRpb25GaWx0ZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgXCIgXCIgKyB0aGlzLm9wICsgXCIgXCIgKyB0aGlzLnZhbHVlLnZhbHVlKCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlbGF0aW9uRmlsdGVyO1xyXG59KEZpbHRlcikpO1xyXG4vKipcclxuICogRmlsdGVyIHRoYXQgbWF0Y2hlcyAnbnVsbCcgdmFsdWVzLlxyXG4gKi9cclxudmFyIE51bGxGaWx0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhOdWxsRmlsdGVyLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gTnVsbEZpbHRlcihmaWVsZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuZmllbGQgPSBmaWVsZDtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBOdWxsRmlsdGVyLnByb3RvdHlwZS5tYXRjaGVzID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIHZhciB2YWwgPSBkb2MuZmllbGQodGhpcy5maWVsZCk7XHJcbiAgICAgICAgcmV0dXJuIHZhbCAhPT0gdW5kZWZpbmVkICYmIHZhbC52YWx1ZSgpID09PSBudWxsO1xyXG4gICAgfTtcclxuICAgIE51bGxGaWx0ZXIucHJvdG90eXBlLmNhbm9uaWNhbElkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgJyBJUyBudWxsJztcclxuICAgIH07XHJcbiAgICBOdWxsRmlsdGVyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIFwiIElTIG51bGxcIjtcclxuICAgIH07XHJcbiAgICBOdWxsRmlsdGVyLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgTnVsbEZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5pc0VxdWFsKG90aGVyLmZpZWxkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE51bGxGaWx0ZXI7XHJcbn0oRmlsdGVyKSk7XHJcbi8qKlxyXG4gKiBGaWx0ZXIgdGhhdCBtYXRjaGVzICdOYU4nIHZhbHVlcy5cclxuICovXHJcbnZhciBOYW5GaWx0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhOYW5GaWx0ZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBOYW5GaWx0ZXIoZmllbGQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmZpZWxkID0gZmllbGQ7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgTmFuRmlsdGVyLnByb3RvdHlwZS5tYXRjaGVzID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIHZhciBmaWVsZCA9IGRvYy5maWVsZCh0aGlzLmZpZWxkKTtcclxuICAgICAgICB2YXIgdmFsID0gZmllbGQgJiYgZmllbGQudmFsdWUoKTtcclxuICAgICAgICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ251bWJlcicgJiYgaXNOYU4odmFsKTtcclxuICAgIH07XHJcbiAgICBOYW5GaWx0ZXIucHJvdG90eXBlLmNhbm9uaWNhbElkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgJyBJUyBOYU4nO1xyXG4gICAgfTtcclxuICAgIE5hbkZpbHRlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyBcIiBJUyBOYU5cIjtcclxuICAgIH07XHJcbiAgICBOYW5GaWx0ZXIucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBOYW5GaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuaXNFcXVhbChvdGhlci5maWVsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBOYW5GaWx0ZXI7XHJcbn0oRmlsdGVyKSk7XHJcbi8qKlxyXG4gKiBUaGUgZGlyZWN0aW9uIG9mIHNvcnRpbmcgaW4gYW4gb3JkZXIgYnkuXHJcbiAqL1xyXG52YXIgRGlyZWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGlyZWN0aW9uKG5hbWUpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgfVxyXG4gICAgRGlyZWN0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5uYW1lO1xyXG4gICAgfTtcclxuICAgIERpcmVjdGlvbi5BU0NFTkRJTkcgPSBuZXcgRGlyZWN0aW9uKCdhc2MnKTtcclxuICAgIERpcmVjdGlvbi5ERVNDRU5ESU5HID0gbmV3IERpcmVjdGlvbignZGVzYycpO1xyXG4gICAgcmV0dXJuIERpcmVjdGlvbjtcclxufSgpKTtcclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBib3VuZCBvZiBhIHF1ZXJ5LlxyXG4gKlxyXG4gKiBUaGUgYm91bmQgaXMgc3BlY2lmaWVkIHdpdGggdGhlIGdpdmVuIGNvbXBvbmVudHMgcmVwcmVzZW50aW5nIGEgcG9zaXRpb24gYW5kXHJcbiAqIHdoZXRoZXIgaXQncyBqdXN0IGJlZm9yZSBvciBqdXN0IGFmdGVyIHRoZSBwb3NpdGlvbiAocmVsYXRpdmUgdG8gd2hhdGV2ZXIgdGhlXHJcbiAqIHF1ZXJ5IG9yZGVyIGlzKS5cclxuICpcclxuICogVGhlIHBvc2l0aW9uIHJlcHJlc2VudHMgYSBsb2dpY2FsIGluZGV4IHBvc2l0aW9uIGZvciBhIHF1ZXJ5LiBJdCdzIGEgcHJlZml4XHJcbiAqIG9mIHZhbHVlcyBmb3IgdGhlIChwb3RlbnRpYWxseSBpbXBsaWNpdCkgb3JkZXIgYnkgY2xhdXNlcyBvZiBhIHF1ZXJ5LlxyXG4gKlxyXG4gKiBCb3VuZCBwcm92aWRlcyBhIGZ1bmN0aW9uIHRvIGRldGVybWluZSB3aGV0aGVyIGEgZG9jdW1lbnQgY29tZXMgYmVmb3JlIG9yXHJcbiAqIGFmdGVyIGEgYm91bmQuIFRoaXMgaXMgaW5mbHVlbmNlZCBieSB3aGV0aGVyIHRoZSBwb3NpdGlvbiBpcyBqdXN0IGJlZm9yZSBvclxyXG4gKiBqdXN0IGFmdGVyIHRoZSBwcm92aWRlZCB2YWx1ZXMuXHJcbiAqL1xyXG52YXIgQm91bmQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCb3VuZChwb3NpdGlvbiwgYmVmb3JlKSB7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uO1xyXG4gICAgICAgIHRoaXMuYmVmb3JlID0gYmVmb3JlO1xyXG4gICAgfVxyXG4gICAgQm91bmQucHJvdG90eXBlLmNhbm9uaWNhbElkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIFRPRE8oYi8yOTE4MzE2NSk6IE1ha2UgdGhpcyBjb2xsaXNpb24gcm9idXN0LlxyXG4gICAgICAgIHZhciBjYW5vbmljYWxJZCA9IHRoaXMuYmVmb3JlID8gJ2I6JyA6ICdhOic7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMucG9zaXRpb247IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjb21wb25lbnQgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGNhbm9uaWNhbElkICs9IGNvbXBvbmVudC50b1N0cmluZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2Fub25pY2FsSWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgYSBkb2N1bWVudCBzb3J0cyBiZWZvcmUgYSBib3VuZCB1c2luZyB0aGUgcHJvdmlkZWQgc29ydFxyXG4gICAgICogb3JkZXIuXHJcbiAgICAgKi9cclxuICAgIEJvdW5kLnByb3RvdHlwZS5zb3J0c0JlZm9yZURvY3VtZW50ID0gZnVuY3Rpb24gKG9yZGVyQnksIGRvYykge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnBvc2l0aW9uLmxlbmd0aCA8PSBvcmRlckJ5Lmxlbmd0aCwgXCJCb3VuZCBoYXMgbW9yZSBjb21wb25lbnRzIHRoYW4gcXVlcnkncyBvcmRlckJ5XCIpO1xyXG4gICAgICAgIHZhciBjb21wYXJpc29uID0gMDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucG9zaXRpb24ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIG9yZGVyQnlDb21wb25lbnQgPSBvcmRlckJ5W2ldO1xyXG4gICAgICAgICAgICB2YXIgY29tcG9uZW50ID0gdGhpcy5wb3NpdGlvbltpXTtcclxuICAgICAgICAgICAgaWYgKG9yZGVyQnlDb21wb25lbnQuZmllbGQuaXNLZXlGaWVsZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoY29tcG9uZW50IGluc3RhbmNlb2YgUmVmVmFsdWUsICdCb3VuZCBoYXMgYSBub24ta2V5IHZhbHVlIHdoZXJlIHRoZSBrZXkgcGF0aCBpcyBiZWluZyB1c2VkLicpO1xyXG4gICAgICAgICAgICAgICAgY29tcGFyaXNvbiA9IERvY3VtZW50S2V5LmNvbXBhcmF0b3IoY29tcG9uZW50LmtleSwgZG9jLmtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jVmFsdWUgPSBkb2MuZmllbGQob3JkZXJCeUNvbXBvbmVudC5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoZG9jVmFsdWUgIT09IHVuZGVmaW5lZCwgJ0ZpZWxkIHNob3VsZCBleGlzdCBzaW5jZSBkb2N1bWVudCBtYXRjaGVkIHRoZSBvcmRlckJ5IGFscmVhZHkuJyk7XHJcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uID0gY29tcG9uZW50LmNvbXBhcmVUbyhkb2NWYWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9yZGVyQnlDb21wb25lbnQuZGlyID09PSBEaXJlY3Rpb24uREVTQ0VORElORykge1xyXG4gICAgICAgICAgICAgICAgY29tcGFyaXNvbiA9IGNvbXBhcmlzb24gKiAtMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29tcGFyaXNvbiAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYmVmb3JlID8gY29tcGFyaXNvbiA8PSAwIDogY29tcGFyaXNvbiA8IDA7XHJcbiAgICB9O1xyXG4gICAgQm91bmQucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5iZWZvcmUgIT09IG90aGVyLmJlZm9yZSB8fFxyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uLmxlbmd0aCAhPT0gb3RoZXIucG9zaXRpb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBvc2l0aW9uLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0aGlzUG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uW2ldO1xyXG4gICAgICAgICAgICB2YXIgb3RoZXJQb3NpdGlvbiA9IG90aGVyLnBvc2l0aW9uW2ldO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpc1Bvc2l0aW9uLmlzRXF1YWwob3RoZXJQb3NpdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBCb3VuZDtcclxufSgpKTtcclxuLyoqXHJcbiAqIEFuIG9yZGVyaW5nIG9uIGEgZmllbGQsIGluIHNvbWUgRGlyZWN0aW9uLiBEaXJlY3Rpb24gZGVmYXVsdHMgdG8gQVNDRU5ESU5HLlxyXG4gKi9cclxudmFyIE9yZGVyQnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBPcmRlckJ5KGZpZWxkLCBkaXIpIHtcclxuICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7XHJcbiAgICAgICAgaWYgKGRpciA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGRpciA9IERpcmVjdGlvbi5BU0NFTkRJTkc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGlyID0gZGlyO1xyXG4gICAgICAgIHRoaXMuaXNLZXlPcmRlckJ5ID0gZmllbGQuaXNLZXlGaWVsZCgpO1xyXG4gICAgfVxyXG4gICAgT3JkZXJCeS5wcm90b3R5cGUuY29tcGFyZSA9IGZ1bmN0aW9uIChkMSwgZDIpIHtcclxuICAgICAgICB2YXIgY29tcGFyaXNvbiA9IHRoaXMuaXNLZXlPcmRlckJ5XHJcbiAgICAgICAgICAgID8gRG9jdW1lbnQuY29tcGFyZUJ5S2V5KGQxLCBkMilcclxuICAgICAgICAgICAgOiBEb2N1bWVudC5jb21wYXJlQnlGaWVsZCh0aGlzLmZpZWxkLCBkMSwgZDIpO1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5kaXIpIHtcclxuICAgICAgICAgICAgY2FzZSBEaXJlY3Rpb24uQVNDRU5ESU5HOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmlzb247XHJcbiAgICAgICAgICAgIGNhc2UgRGlyZWN0aW9uLkRFU0NFTkRJTkc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gLTEgKiBjb21wYXJpc29uO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gZGlyZWN0aW9uOiAnICsgdGhpcy5kaXIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPcmRlckJ5LnByb3RvdHlwZS5jYW5vbmljYWxJZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBUT0RPKGIvMjkxODMxNjUpOiBNYWtlIHRoaXMgY29sbGlzaW9uIHJvYnVzdC5cclxuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIHRoaXMuZGlyLnRvU3RyaW5nKCk7XHJcbiAgICB9O1xyXG4gICAgT3JkZXJCeS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyBcIiAoXCIgKyB0aGlzLmRpciArIFwiKVwiO1xyXG4gICAgfTtcclxuICAgIE9yZGVyQnkucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kaXIgPT09IG90aGVyLmRpciAmJiB0aGlzLmZpZWxkLmlzRXF1YWwob3RoZXIuZmllbGQpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBPcmRlckJ5O1xyXG59KCkpO1xyXG52YXIgS0VZX09SREVSSU5HX0FTQyA9IG5ldyBPcmRlckJ5KEZpZWxkUGF0aC5rZXlGaWVsZCgpLCBEaXJlY3Rpb24uQVNDRU5ESU5HKTtcclxudmFyIEtFWV9PUkRFUklOR19ERVNDID0gbmV3IE9yZGVyQnkoRmllbGRQYXRoLmtleUZpZWxkKCksIERpcmVjdGlvbi5ERVNDRU5ESU5HKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBIHZlcnNpb24gb2YgYSBkb2N1bWVudCBpbiBGaXJlc3RvcmUuIFRoaXMgY29ycmVzcG9uZHMgdG8gdGhlIHZlcnNpb25cclxuICogdGltZXN0YW1wLCBzdWNoIGFzIHVwZGF0ZV90aW1lIG9yIHJlYWRfdGltZS5cclxuICovXHJcbnZhciBTbmFwc2hvdFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTbmFwc2hvdFZlcnNpb24odGltZXN0YW1wKSB7XHJcbiAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7XHJcbiAgICB9XHJcbiAgICAvLyBUT0RPKGIvMzQxNzYzNDQpOiBPbmNlIHdlIG5vIGxvbmdlciBuZWVkIHRvIHVzZSB0aGUgb2xkIGFscGhhIHByb3RvcyxcclxuICAgIC8vIGRlbGV0ZSB0aGlzIGNvbnN0cnVjdG9yIGFuZCB1c2UgYSB0aW1lc3RhbXAtYmFja2VkIHZlcnNpb24gZXZlcnl3aGVyZS5cclxuICAgIFNuYXBzaG90VmVyc2lvbi5mcm9tTWljcm9zZWNvbmRzID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKHZhbHVlIC8gMWU2KTtcclxuICAgICAgICB2YXIgbmFub3MgPSAodmFsdWUgJSAxZTYpICogMWUzO1xyXG4gICAgICAgIHJldHVybiBuZXcgU25hcHNob3RWZXJzaW9uKG5ldyBUaW1lc3RhbXAoc2Vjb25kcywgbmFub3MpKTtcclxuICAgIH07XHJcbiAgICBTbmFwc2hvdFZlcnNpb24uZnJvbVRpbWVzdGFtcCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgU25hcHNob3RWZXJzaW9uKHZhbHVlKTtcclxuICAgIH07XHJcbiAgICBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uLk1JTjtcclxuICAgIH07XHJcbiAgICBTbmFwc2hvdFZlcnNpb24ucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVzdGFtcC5fY29tcGFyZVRvKG90aGVyLnRpbWVzdGFtcCk7XHJcbiAgICB9O1xyXG4gICAgU25hcHNob3RWZXJzaW9uLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wLmlzRXF1YWwob3RoZXIudGltZXN0YW1wKTtcclxuICAgIH07XHJcbiAgICAvKiogUmV0dXJucyBhIG51bWJlciByZXByZXNlbnRhdGlvbiBvZiB0aGUgdmVyc2lvbiBmb3IgdXNlIGluIHNwZWMgdGVzdHMuICovXHJcbiAgICBTbmFwc2hvdFZlcnNpb24ucHJvdG90eXBlLnRvTWljcm9zZWNvbmRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIENvbnZlcnQgdG8gbWljcm9zZWNvbmRzLlxyXG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVzdGFtcC5zZWNvbmRzICogMWU2ICsgdGhpcy50aW1lc3RhbXAubmFub3NlY29uZHMgLyAxMDAwO1xyXG4gICAgfTtcclxuICAgIFNuYXBzaG90VmVyc2lvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICdTbmFwc2hvdFZlcnNpb24oJyArIHRoaXMudGltZXN0YW1wLnRvU3RyaW5nKCkgKyAnKSc7XHJcbiAgICB9O1xyXG4gICAgU25hcHNob3RWZXJzaW9uLnByb3RvdHlwZS50b1RpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXA7XHJcbiAgICB9O1xyXG4gICAgU25hcHNob3RWZXJzaW9uLk1JTiA9IG5ldyBTbmFwc2hvdFZlcnNpb24obmV3IFRpbWVzdGFtcCgwLCAwKSk7XHJcbiAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqIEFuIGVudW1lcmF0aW9uIG9mIHRoZSBkaWZmZXJlbnQgcHVycG9zZXMgd2UgaGF2ZSBmb3IgcXVlcmllcy4gKi9cclxudmFyIFF1ZXJ5UHVycG9zZTtcclxuKGZ1bmN0aW9uIChRdWVyeVB1cnBvc2UpIHtcclxuICAgIC8qKiBBIHJlZ3VsYXIsIG5vcm1hbCBxdWVyeS4gKi9cclxuICAgIFF1ZXJ5UHVycG9zZVtRdWVyeVB1cnBvc2VbXCJMaXN0ZW5cIl0gPSAwXSA9IFwiTGlzdGVuXCI7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBxdWVyeSB3YXMgdXNlZCB0byByZWZpbGwgYSBxdWVyeSBhZnRlciBhbiBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoLlxyXG4gICAgICovXHJcbiAgICBRdWVyeVB1cnBvc2VbUXVlcnlQdXJwb3NlW1wiRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hcIl0gPSAxXSA9IFwiRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hcIjtcclxuICAgIC8qKiBUaGUgcXVlcnkgd2FzIHVzZWQgdG8gcmVzb2x2ZSBhIGxpbWJvIGRvY3VtZW50LiAqL1xyXG4gICAgUXVlcnlQdXJwb3NlW1F1ZXJ5UHVycG9zZVtcIkxpbWJvUmVzb2x1dGlvblwiXSA9IDJdID0gXCJMaW1ib1Jlc29sdXRpb25cIjtcclxufSkoUXVlcnlQdXJwb3NlIHx8IChRdWVyeVB1cnBvc2UgPSB7fSkpO1xyXG4vKipcclxuICogQW4gaW1tdXRhYmxlIHNldCBvZiBtZXRhZGF0YSB0aGF0IHRoZSBsb2NhbCBzdG9yZSB0cmFja3MgZm9yIGVhY2ggcXVlcnkuXHJcbiAqL1xyXG52YXIgUXVlcnlEYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnlEYXRhKFxyXG4gICAgLyoqIFRoZSBxdWVyeSBiZWluZyBsaXN0ZW5lZCB0by4gKi9cclxuICAgIHF1ZXJ5LCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHRhcmdldCBJRCB0byB3aGljaCB0aGUgcXVlcnkgY29ycmVzcG9uZHM7IEFzc2lnbmVkIGJ5IHRoZVxyXG4gICAgICogTG9jYWxTdG9yZSBmb3IgdXNlciBsaXN0ZW5zIGFuZCBieSB0aGUgU3luY0VuZ2luZSBmb3IgbGltYm8gd2F0Y2hlcy5cclxuICAgICAqL1xyXG4gICAgdGFyZ2V0SWQsIFxyXG4gICAgLyoqIFRoZSBwdXJwb3NlIG9mIHRoZSBxdWVyeS4gKi9cclxuICAgIHB1cnBvc2UsIFxyXG4gICAgLyoqIFRoZSBzZXF1ZW5jZSBudW1iZXIgb2YgdGhlIGxhc3QgdHJhbnNhY3Rpb24gZHVyaW5nIHdoaWNoIHRoaXMgcXVlcnkgZGF0YSB3YXMgbW9kaWZpZWQgKi9cclxuICAgIHNlcXVlbmNlTnVtYmVyLCBcclxuICAgIC8qKiBUaGUgbGF0ZXN0IHNuYXBzaG90IHZlcnNpb24gc2VlbiBmb3IgdGhpcyB0YXJnZXQuICovXHJcbiAgICBzbmFwc2hvdFZlcnNpb24sIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHF1ZXJ5IHRvIGJlXHJcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdFxyXG4gICAgICogbWF0Y2hlcyB0aGUgcXVlcnkuIFRoZSByZXN1bWUgdG9rZW4gZXNzZW50aWFsbHkgaWRlbnRpZmllcyBhIHBvaW50IGluXHJcbiAgICAgKiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cclxuICAgICAqL1xyXG4gICAgcmVzdW1lVG9rZW4pIHtcclxuICAgICAgICBpZiAoc25hcHNob3RWZXJzaW9uID09PSB2b2lkIDApIHsgc25hcHNob3RWZXJzaW9uID0gU25hcHNob3RWZXJzaW9uLk1JTjsgfVxyXG4gICAgICAgIGlmIChyZXN1bWVUb2tlbiA9PT0gdm9pZCAwKSB7IHJlc3VtZVRva2VuID0gZW1wdHlCeXRlU3RyaW5nKCk7IH1cclxuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XHJcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHRhcmdldElkO1xyXG4gICAgICAgIHRoaXMucHVycG9zZSA9IHB1cnBvc2U7XHJcbiAgICAgICAgdGhpcy5zZXF1ZW5jZU51bWJlciA9IHNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgIHRoaXMuc25hcHNob3RWZXJzaW9uID0gc25hcHNob3RWZXJzaW9uO1xyXG4gICAgICAgIHRoaXMucmVzdW1lVG9rZW4gPSByZXN1bWVUb2tlbjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIG5ldyBxdWVyeSBkYXRhIGluc3RhbmNlIHdpdGggYW4gdXBkYXRlZCBzbmFwc2hvdCB2ZXJzaW9uIGFuZFxyXG4gICAgICogcmVzdW1lIHRva2VuLlxyXG4gICAgICovXHJcbiAgICBRdWVyeURhdGEucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAob3ZlcndyaXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeURhdGEodGhpcy5xdWVyeSwgdGhpcy50YXJnZXRJZCwgdGhpcy5wdXJwb3NlLCBvdmVyd3JpdGUuc2VxdWVuY2VOdW1iZXIgPT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICA/IHRoaXMuc2VxdWVuY2VOdW1iZXJcclxuICAgICAgICAgICAgOiBvdmVyd3JpdGUuc2VxdWVuY2VOdW1iZXIsIG92ZXJ3cml0ZS5zbmFwc2hvdFZlcnNpb24gPT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICA/IHRoaXMuc25hcHNob3RWZXJzaW9uXHJcbiAgICAgICAgICAgIDogb3ZlcndyaXRlLnNuYXBzaG90VmVyc2lvbiwgb3ZlcndyaXRlLnJlc3VtZVRva2VuID09PSB1bmRlZmluZWRcclxuICAgICAgICAgICAgPyB0aGlzLnJlc3VtZVRva2VuXHJcbiAgICAgICAgICAgIDogb3ZlcndyaXRlLnJlc3VtZVRva2VuKTtcclxuICAgIH07XHJcbiAgICBRdWVyeURhdGEucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMudGFyZ2V0SWQgPT09IG90aGVyLnRhcmdldElkICYmXHJcbiAgICAgICAgICAgIHRoaXMucHVycG9zZSA9PT0gb3RoZXIucHVycG9zZSAmJlxyXG4gICAgICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVyID09PSBvdGhlci5zZXF1ZW5jZU51bWJlciAmJlxyXG4gICAgICAgICAgICB0aGlzLnNuYXBzaG90VmVyc2lvbi5pc0VxdWFsKG90aGVyLnNuYXBzaG90VmVyc2lvbikgJiZcclxuICAgICAgICAgICAgdGhpcy5yZXN1bWVUb2tlbiA9PT0gb3RoZXIucmVzdW1lVG9rZW4gJiZcclxuICAgICAgICAgICAgdGhpcy5xdWVyeS5pc0VxdWFsKG90aGVyLnF1ZXJ5KSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5RGF0YTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQcm92aWRlcyBhIHNldCBvZiBmaWVsZHMgdGhhdCBjYW4gYmUgdXNlZCB0byBwYXJ0aWFsbHkgcGF0Y2ggYSBkb2N1bWVudC5cclxuICogRmllbGRNYXNrIGlzIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBPYmplY3RWYWx1ZS5cclxuICogRXhhbXBsZXM6XHJcbiAqICAgZm9vIC0gT3ZlcndyaXRlcyBmb28gZW50aXJlbHkgd2l0aCB0aGUgcHJvdmlkZWQgdmFsdWUuIElmIGZvbyBpcyBub3RcclxuICogICAgICAgICBwcmVzZW50IGluIHRoZSBjb21wYW5pb24gT2JqZWN0VmFsdWUsIHRoZSBmaWVsZCBpcyBkZWxldGVkLlxyXG4gKiAgIGZvby5iYXIgLSBPdmVyd3JpdGVzIG9ubHkgdGhlIGZpZWxkIGJhciBvZiB0aGUgb2JqZWN0IGZvby5cclxuICogICAgICAgICAgICAgSWYgZm9vIGlzIG5vdCBhbiBvYmplY3QsIGZvbyBpcyByZXBsYWNlZCB3aXRoIGFuIG9iamVjdFxyXG4gKiAgICAgICAgICAgICBjb250YWluaW5nIGZvb1xyXG4gKi9cclxudmFyIEZpZWxkTWFzayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpZWxkTWFzayhmaWVsZHMpIHtcclxuICAgICAgICB0aGlzLmZpZWxkcyA9IGZpZWxkcztcclxuICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IHZhbGlkYXRpb24gb2YgRmllbGRNYXNrXHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFZlcmlmaWVzIHRoYXQgYGZpZWxkUGF0aGAgaXMgaW5jbHVkZWQgYnkgYXQgbGVhc3Qgb25lIGZpZWxkIGluIHRoaXMgZmllbGRcclxuICAgICAqIG1hc2suXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBpcyBhbiBPKG4pIG9wZXJhdGlvbiwgd2hlcmUgYG5gIGlzIHRoZSBzaXplIG9mIHRoZSBmaWVsZCBtYXNrLlxyXG4gICAgICovXHJcbiAgICBGaWVsZE1hc2sucHJvdG90eXBlLmNvdmVycyA9IGZ1bmN0aW9uIChmaWVsZFBhdGgpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5maWVsZHM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZE1hc2tQYXRoID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBpZiAoZmllbGRNYXNrUGF0aC5pc1ByZWZpeE9mKGZpZWxkUGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBGaWVsZE1hc2sucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gYXJyYXlFcXVhbHModGhpcy5maWVsZHMsIG90aGVyLmZpZWxkcyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpZWxkTWFzaztcclxufSgpKTtcclxuLyoqIEEgZmllbGQgcGF0aCBhbmQgdGhlIFRyYW5zZm9ybU9wZXJhdGlvbiB0byBwZXJmb3JtIHVwb24gaXQuICovXHJcbnZhciBGaWVsZFRyYW5zZm9ybSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpZWxkVHJhbnNmb3JtKGZpZWxkLCB0cmFuc2Zvcm0pIHtcclxuICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7XHJcbiAgICAgICAgdGhpcy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07XHJcbiAgICB9XHJcbiAgICBGaWVsZFRyYW5zZm9ybS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5maWVsZC5pc0VxdWFsKG90aGVyLmZpZWxkKSAmJiB0aGlzLnRyYW5zZm9ybS5pc0VxdWFsKG90aGVyLnRyYW5zZm9ybSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBGaWVsZFRyYW5zZm9ybTtcclxufSgpKTtcclxuLyoqIFRoZSByZXN1bHQgb2Ygc3VjY2Vzc2Z1bGx5IGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gdGhlIGJhY2tlbmQuICovXHJcbnZhciBNdXRhdGlvblJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE11dGF0aW9uUmVzdWx0KFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgdmVyc2lvbiBhdCB3aGljaCB0aGUgbXV0YXRpb24gd2FzIGNvbW1pdHRlZDpcclxuICAgICAqXHJcbiAgICAgKiAtIEZvciBtb3N0IG9wZXJhdGlvbnMsIHRoaXMgaXMgdGhlIHVwZGF0ZVRpbWUgaW4gdGhlIFdyaXRlUmVzdWx0LlxyXG4gICAgICogLSBGb3IgZGVsZXRlcywgdGhlIGNvbW1pdFRpbWUgb2YgdGhlIFdyaXRlUmVzcG9uc2UgKGJlY2F1c2UgZGVsZXRlcyBhcmVcclxuICAgICAqICAgbm90IHN0b3JlZCBhbmQgaGF2ZSBubyB1cGRhdGVUaW1lKS5cclxuICAgICAqXHJcbiAgICAgKiBOb3RlIHRoYXQgdGhlc2UgdmVyc2lvbnMgY2FuIGJlIGRpZmZlcmVudDogTm8tb3Agd3JpdGVzIHdpbGwgbm90IGNoYW5nZVxyXG4gICAgICogdGhlIHVwZGF0ZVRpbWUgZXZlbiB0aG91Z2ggdGhlIGNvbW1pdFRpbWUgYWR2YW5jZXMuXHJcbiAgICAgKi9cclxuICAgIHZlcnNpb24sIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcmVzdWx0aW5nIGZpZWxkcyByZXR1cm5lZCBmcm9tIHRoZSBiYWNrZW5kIGFmdGVyIGFcclxuICAgICAqIFRyYW5zZm9ybU11dGF0aW9uIGhhcyBiZWVuIGNvbW1pdHRlZC4gQ29udGFpbnMgb25lIEZpZWxkVmFsdWUgZm9yIGVhY2hcclxuICAgICAqIEZpZWxkVHJhbnNmb3JtIHRoYXQgd2FzIGluIHRoZSBtdXRhdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBXaWxsIGJlIG51bGwgaWYgdGhlIG11dGF0aW9uIHdhcyBub3QgYSBUcmFuc2Zvcm1NdXRhdGlvbi5cclxuICAgICAqL1xyXG4gICAgdHJhbnNmb3JtUmVzdWx0cykge1xyXG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHZlcnNpb247XHJcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1SZXN1bHRzID0gdHJhbnNmb3JtUmVzdWx0cztcclxuICAgIH1cclxuICAgIHJldHVybiBNdXRhdGlvblJlc3VsdDtcclxufSgpKTtcclxudmFyIE11dGF0aW9uVHlwZTtcclxuKGZ1bmN0aW9uIChNdXRhdGlvblR5cGUpIHtcclxuICAgIE11dGF0aW9uVHlwZVtNdXRhdGlvblR5cGVbXCJTZXRcIl0gPSAwXSA9IFwiU2V0XCI7XHJcbiAgICBNdXRhdGlvblR5cGVbTXV0YXRpb25UeXBlW1wiUGF0Y2hcIl0gPSAxXSA9IFwiUGF0Y2hcIjtcclxuICAgIE11dGF0aW9uVHlwZVtNdXRhdGlvblR5cGVbXCJUcmFuc2Zvcm1cIl0gPSAyXSA9IFwiVHJhbnNmb3JtXCI7XHJcbiAgICBNdXRhdGlvblR5cGVbTXV0YXRpb25UeXBlW1wiRGVsZXRlXCJdID0gM10gPSBcIkRlbGV0ZVwiO1xyXG59KShNdXRhdGlvblR5cGUgfHwgKE11dGF0aW9uVHlwZSA9IHt9KSk7XHJcbi8qKlxyXG4gKiBFbmNvZGVzIGEgcHJlY29uZGl0aW9uIGZvciBhIG11dGF0aW9uLiBUaGlzIGZvbGxvd3MgdGhlIG1vZGVsIHRoYXQgdGhlXHJcbiAqIGJhY2tlbmQgYWNjZXB0cyB3aXRoIHRoZSBzcGVjaWFsIGNhc2Ugb2YgYW4gZXhwbGljaXQgXCJlbXB0eVwiIHByZWNvbmRpdGlvblxyXG4gKiAobWVhbmluZyBubyBwcmVjb25kaXRpb24pLlxyXG4gKi9cclxudmFyIFByZWNvbmRpdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFByZWNvbmRpdGlvbih1cGRhdGVUaW1lLCBleGlzdHMpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZVRpbWUgPSB1cGRhdGVUaW1lO1xyXG4gICAgICAgIHRoaXMuZXhpc3RzID0gZXhpc3RzO1xyXG4gICAgICAgIGFzc2VydCh1cGRhdGVUaW1lID09PSB1bmRlZmluZWQgfHwgZXhpc3RzID09PSB1bmRlZmluZWQsICdQcmVjb25kaXRpb24gY2FuIHNwZWNpZnkgXCJleGlzdHNcIiBvciBcInVwZGF0ZVRpbWVcIiBidXQgbm90IGJvdGgnKTtcclxuICAgIH1cclxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IFByZWNvbmRpdGlvbiB3aXRoIGFuIGV4aXN0cyBmbGFnLiAqL1xyXG4gICAgUHJlY29uZGl0aW9uLmV4aXN0cyA9IGZ1bmN0aW9uIChleGlzdHMpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByZWNvbmRpdGlvbih1bmRlZmluZWQsIGV4aXN0cyk7XHJcbiAgICB9O1xyXG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgUHJlY29uZGl0aW9uIGJhc2VkIG9uIGEgdmVyc2lvbiBhIGRvY3VtZW50IGV4aXN0cyBhdC4gKi9cclxuICAgIFByZWNvbmRpdGlvbi51cGRhdGVUaW1lID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByZWNvbmRpdGlvbih2ZXJzaW9uKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJlY29uZGl0aW9uLnByb3RvdHlwZSwgXCJpc05vbmVcIiwge1xyXG4gICAgICAgIC8qKiBSZXR1cm5zIHdoZXRoZXIgdGhpcyBQcmVjb25kaXRpb24gaXMgZW1wdHkuICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZVRpbWUgPT09IHVuZGVmaW5lZCAmJiB0aGlzLmV4aXN0cyA9PT0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByZWNvbmRpdGlvbnMgaXMgdmFsaWQgZm9yIHRoZSBnaXZlbiBkb2N1bWVudFxyXG4gICAgICogKG9yIG51bGwgaWYgbm8gZG9jdW1lbnQgaXMgYXZhaWxhYmxlKS5cclxuICAgICAqL1xyXG4gICAgUHJlY29uZGl0aW9uLnByb3RvdHlwZS5pc1ZhbGlkRm9yID0gZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudXBkYXRlVGltZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAobWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCAmJlxyXG4gICAgICAgICAgICAgICAgbWF5YmVEb2MudmVyc2lvbi5pc0VxdWFsKHRoaXMudXBkYXRlVGltZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLmV4aXN0cyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmV4aXN0cyA9PT0gbWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLmlzTm9uZSwgJ1ByZWNvbmRpdGlvbiBzaG91bGQgYmUgZW1wdHknKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFByZWNvbmRpdGlvbi5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAoZXF1YWxzKHRoaXMudXBkYXRlVGltZSwgb3RoZXIudXBkYXRlVGltZSkgJiZcclxuICAgICAgICAgICAgdGhpcy5leGlzdHMgPT09IG90aGVyLmV4aXN0cyk7XHJcbiAgICB9O1xyXG4gICAgUHJlY29uZGl0aW9uLk5PTkUgPSBuZXcgUHJlY29uZGl0aW9uKCk7XHJcbiAgICByZXR1cm4gUHJlY29uZGl0aW9uO1xyXG59KCkpO1xyXG4vKipcclxuICogQSBtdXRhdGlvbiBkZXNjcmliZXMgYSBzZWxmLWNvbnRhaW5lZCBjaGFuZ2UgdG8gYSBkb2N1bWVudC4gTXV0YXRpb25zIGNhblxyXG4gKiBjcmVhdGUsIHJlcGxhY2UsIGRlbGV0ZSwgYW5kIHVwZGF0ZSBzdWJzZXRzIG9mIGRvY3VtZW50cy5cclxuICpcclxuICogTXV0YXRpb25zIG5vdCBvbmx5IGFjdCBvbiB0aGUgdmFsdWUgb2YgdGhlIGRvY3VtZW50IGJ1dCBhbHNvIGl0IHZlcnNpb24uXHJcbiAqXHJcbiAqIEZvciBsb2NhbCBtdXRhdGlvbnMgKG11dGF0aW9ucyB0aGF0IGhhdmVuJ3QgYmVlbiBjb21taXR0ZWQgeWV0KSwgd2UgcHJlc2VydmVcclxuICogdGhlIGV4aXN0aW5nIHZlcnNpb24gZm9yIFNldCwgUGF0Y2gsIGFuZCBUcmFuc2Zvcm0gbXV0YXRpb25zLiBGb3IgRGVsZXRlXHJcbiAqIG11dGF0aW9ucywgd2UgcmVzZXQgdGhlIHZlcnNpb24gdG8gMC5cclxuICpcclxuICogSGVyZSdzIHRoZSBleHBlY3RlZCB0cmFuc2l0aW9uIHRhYmxlLlxyXG4gKlxyXG4gKiBNVVRBVElPTiAgICAgICAgICAgQVBQTElFRCBUTyAgICAgICAgICAgIFJFU1VMVFMgSU5cclxuICpcclxuICogU2V0TXV0YXRpb24gICAgICAgIERvY3VtZW50KHYzKSAgICAgICAgICBEb2N1bWVudCh2MylcclxuICogU2V0TXV0YXRpb24gICAgICAgIE5vRG9jdW1lbnQodjMpICAgICAgICBEb2N1bWVudCh2MClcclxuICogU2V0TXV0YXRpb24gICAgICAgIG51bGwgICAgICAgICAgICAgICAgICBEb2N1bWVudCh2MClcclxuICogUGF0Y2hNdXRhdGlvbiAgICAgIERvY3VtZW50KHYzKSAgICAgICAgICBEb2N1bWVudCh2MylcclxuICogUGF0Y2hNdXRhdGlvbiAgICAgIE5vRG9jdW1lbnQodjMpICAgICAgICBOb0RvY3VtZW50KHYzKVxyXG4gKiBQYXRjaE11dGF0aW9uICAgICAgbnVsbCAgICAgICAgICAgICAgICAgIG51bGxcclxuICogVHJhbnNmb3JtTXV0YXRpb24gIERvY3VtZW50KHYzKSAgICAgICAgICBEb2N1bWVudCh2MylcclxuICogVHJhbnNmb3JtTXV0YXRpb24gIE5vRG9jdW1lbnQodjMpICAgICAgICBOb0RvY3VtZW50KHYzKVxyXG4gKiBUcmFuc2Zvcm1NdXRhdGlvbiAgbnVsbCAgICAgICAgICAgICAgICAgIG51bGxcclxuICogRGVsZXRlTXV0YXRpb24gICAgIERvY3VtZW50KHYzKSAgICAgICAgICBOb0RvY3VtZW50KHYwKVxyXG4gKiBEZWxldGVNdXRhdGlvbiAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIE5vRG9jdW1lbnQodjApXHJcbiAqIERlbGV0ZU11dGF0aW9uICAgICBudWxsICAgICAgICAgICAgICAgICAgTm9Eb2N1bWVudCh2MClcclxuICpcclxuICogRm9yIGFja25vd2xlZGdlZCBtdXRhdGlvbnMsIHdlIHVzZSB0aGUgdXBkYXRlVGltZSBvZiB0aGUgV3JpdGVSZXNwb25zZSBhc1xyXG4gKiB0aGUgcmVzdWx0aW5nIHZlcnNpb24gZm9yIFNldCwgUGF0Y2gsIGFuZCBUcmFuc2Zvcm0gbXV0YXRpb25zLiBBcyBkZWxldGVzXHJcbiAqIGhhdmUgbm8gZXhwbGljaXQgdXBkYXRlIHRpbWUsIHdlIHVzZSB0aGUgY29tbWl0VGltZSBvZiB0aGUgV3JpdGVSZXNwb25zZSBmb3JcclxuICogRGVsZXRlIG11dGF0aW9ucy5cclxuICpcclxuICogSWYgYSBtdXRhdGlvbiBpcyBhY2tub3dsZWRnZWQgYnkgdGhlIGJhY2tlbmQgYnV0IGZhaWxzIHRoZSBwcmVjb25kaXRpb24gY2hlY2tcclxuICogbG9jYWxseSwgd2UgcmV0dXJuIGFuIGBVbmtub3duRG9jdW1lbnRgIGFuZCByZWx5IG9uIFdhdGNoIHRvIHNlbmQgdXMgdGhlXHJcbiAqIHVwZGF0ZWQgdmVyc2lvbi5cclxuICpcclxuICogTm90ZSB0aGF0IFRyYW5zZm9ybU11dGF0aW9ucyBkb24ndCBjcmVhdGUgRG9jdW1lbnRzIChpbiB0aGUgY2FzZSBvZiBiZWluZ1xyXG4gKiBhcHBsaWVkIHRvIGEgTm9Eb2N1bWVudCksIGV2ZW4gdGhvdWdoIHRoZXkgd291bGQgb24gdGhlIGJhY2tlbmQuIFRoaXMgaXNcclxuICogYmVjYXVzZSB0aGUgY2xpZW50IGFsd2F5cyBjb21iaW5lcyB0aGUgVHJhbnNmb3JtTXV0YXRpb24gd2l0aCBhIFNldE11dGF0aW9uXHJcbiAqIG9yIFBhdGNoTXV0YXRpb24gYW5kIHdlIG9ubHkgd2FudCB0byBhcHBseSB0aGUgdHJhbnNmb3JtIGlmIHRoZSBwcmlvclxyXG4gKiBtdXRhdGlvbiByZXN1bHRlZCBpbiBhIERvY3VtZW50IChhbHdheXMgdHJ1ZSBmb3IgYSBTZXRNdXRhdGlvbiwgYnV0IG5vdFxyXG4gKiBuZWNlc3NhcmlseSBmb3IgYSBQYXRjaE11dGF0aW9uKS5cclxuICpcclxuICogIyMgU3ViY2xhc3NpbmcgTm90ZXNcclxuICpcclxuICogU3ViY2xhc3NlcyBvZiBNdXRhdGlvbiBuZWVkIHRvIGltcGxlbWVudCBhcHBseVRvUmVtb3RlRG9jdW1lbnQoKSBhbmRcclxuICogYXBwbHlUb0xvY2FsVmlldygpIHRvIGltcGxlbWVudCB0aGUgYWN0dWFsIGJlaGF2aW9yIG9mIGFwcGx5aW5nIHRoZSBtdXRhdGlvblxyXG4gKiB0byBzb21lIHNvdXJjZSBkb2N1bWVudC5cclxuICovXHJcbnZhciBNdXRhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE11dGF0aW9uKCkge1xyXG4gICAgfVxyXG4gICAgTXV0YXRpb24ucHJvdG90eXBlLnZlcmlmeUtleU1hdGNoZXMgPSBmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICBpZiAobWF5YmVEb2MgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBhc3NlcnQobWF5YmVEb2Mua2V5LmlzRXF1YWwodGhpcy5rZXkpLCAnQ2FuIG9ubHkgYXBwbHkgYSBtdXRhdGlvbiB0byBhIGRvY3VtZW50IHdpdGggdGhlIHNhbWUga2V5Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgdmVyc2lvbiBmcm9tIHRoZSBnaXZlbiBkb2N1bWVudCBmb3IgdXNlIGFzIHRoZSByZXN1bHQgb2YgYVxyXG4gICAgICogbXV0YXRpb24uIE11dGF0aW9ucyBhcmUgZGVmaW5lZCB0byByZXR1cm4gdGhlIHZlcnNpb24gb2YgdGhlIGJhc2UgZG9jdW1lbnRcclxuICAgICAqIG9ubHkgaWYgaXQgaXMgYW4gZXhpc3RpbmcgZG9jdW1lbnQuIERlbGV0ZWQgYW5kIHVua25vd24gZG9jdW1lbnRzIGhhdmUgYVxyXG4gICAgICogcG9zdC1tdXRhdGlvbiB2ZXJzaW9uIG9mIFNuYXBzaG90VmVyc2lvbi5NSU4uXHJcbiAgICAgKi9cclxuICAgIE11dGF0aW9uLmdldFBvc3RNdXRhdGlvblZlcnNpb24gPSBmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICBpZiAobWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbWF5YmVEb2MudmVyc2lvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTbmFwc2hvdFZlcnNpb24uTUlOO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gTXV0YXRpb247XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIG11dGF0aW9uIHRoYXQgY3JlYXRlcyBvciByZXBsYWNlcyB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleSB3aXRoIHRoZVxyXG4gKiBvYmplY3QgdmFsdWUgY29udGVudHMuXHJcbiAqL1xyXG52YXIgU2V0TXV0YXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTZXRNdXRhdGlvbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFNldE11dGF0aW9uKGtleSwgdmFsdWUsIHByZWNvbmRpdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIF90aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgX3RoaXMucHJlY29uZGl0aW9uID0gcHJlY29uZGl0aW9uO1xyXG4gICAgICAgIF90aGlzLnR5cGUgPSBNdXRhdGlvblR5cGUuU2V0O1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFNldE11dGF0aW9uLnByb3RvdHlwZS5hcHBseVRvUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAobWF5YmVEb2MsIG11dGF0aW9uUmVzdWx0KSB7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlLZXlNYXRjaGVzKG1heWJlRG9jKTtcclxuICAgICAgICBhc3NlcnQobXV0YXRpb25SZXN1bHQudHJhbnNmb3JtUmVzdWx0cyA9PSBudWxsLCAnVHJhbnNmb3JtIHJlc3VsdHMgcmVjZWl2ZWQgYnkgU2V0TXV0YXRpb24uJyk7XHJcbiAgICAgICAgLy8gVW5saWtlIGFwcGx5VG9Mb2NhbFZpZXcsIGlmIHdlJ3JlIGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gYSByZW1vdGVcclxuICAgICAgICAvLyBkb2N1bWVudCB0aGUgc2VydmVyIGhhcyBhY2NlcHRlZCB0aGUgbXV0YXRpb24gc28gdGhlIHByZWNvbmRpdGlvbiBtdXN0XHJcbiAgICAgICAgLy8gaGF2ZSBoZWxkLlxyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gbXV0YXRpb25SZXN1bHQudmVyc2lvbjtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50KHRoaXMua2V5LCB2ZXJzaW9uLCB0aGlzLnZhbHVlLCB7XHJcbiAgICAgICAgICAgIGhhc0NvbW1pdHRlZE11dGF0aW9uczogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNldE11dGF0aW9uLnByb3RvdHlwZS5hcHBseVRvTG9jYWxWaWV3ID0gZnVuY3Rpb24gKG1heWJlRG9jLCBiYXNlRG9jLCBsb2NhbFdyaXRlVGltZSkge1xyXG4gICAgICAgIHRoaXMudmVyaWZ5S2V5TWF0Y2hlcyhtYXliZURvYyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnByZWNvbmRpdGlvbi5pc1ZhbGlkRm9yKG1heWJlRG9jKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbWF5YmVEb2M7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gTXV0YXRpb24uZ2V0UG9zdE11dGF0aW9uVmVyc2lvbihtYXliZURvYyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudCh0aGlzLmtleSwgdmVyc2lvbiwgdGhpcy52YWx1ZSwge1xyXG4gICAgICAgICAgICBoYXNMb2NhbE11dGF0aW9uczogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNldE11dGF0aW9uLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIFNldE11dGF0aW9uICYmXHJcbiAgICAgICAgICAgIHRoaXMua2V5LmlzRXF1YWwob3RoZXIua2V5KSAmJlxyXG4gICAgICAgICAgICB0aGlzLnZhbHVlLmlzRXF1YWwob3RoZXIudmFsdWUpICYmXHJcbiAgICAgICAgICAgIHRoaXMucHJlY29uZGl0aW9uLmlzRXF1YWwob3RoZXIucHJlY29uZGl0aW9uKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNldE11dGF0aW9uO1xyXG59KE11dGF0aW9uKSk7XHJcbi8qKlxyXG4gKiBBIG11dGF0aW9uIHRoYXQgbW9kaWZpZXMgZmllbGRzIG9mIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5IHdpdGggdGhlXHJcbiAqIGdpdmVuIHZhbHVlcy4gVGhlIHZhbHVlcyBhcmUgYXBwbGllZCB0aHJvdWdoIGEgZmllbGQgbWFzazpcclxuICpcclxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIGJvdGggdGhlIG1hc2sgYW5kIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nIGZpZWxkXHJcbiAqICAgIGlzIHVwZGF0ZWQuXHJcbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBpbiBuZWl0aGVyIHRoZSBtYXNrIG5vciB0aGUgdmFsdWVzLCB0aGUgY29ycmVzcG9uZGluZ1xyXG4gKiAgICBmaWVsZCBpcyB1bm1vZGlmaWVkLlxyXG4gKiAgKiBXaGVuIGEgZmllbGQgaXMgaW4gdGhlIG1hc2sgYnV0IG5vdCBpbiB0aGUgdmFsdWVzLCB0aGUgY29ycmVzcG9uZGluZyBmaWVsZFxyXG4gKiAgICBpcyBkZWxldGVkLlxyXG4gKiAgKiBXaGVuIGEgZmllbGQgaXMgbm90IGluIHRoZSBtYXNrIGJ1dCBpcyBpbiB0aGUgdmFsdWVzLCB0aGUgdmFsdWVzIG1hcCBpc1xyXG4gKiAgICBpZ25vcmVkLlxyXG4gKi9cclxudmFyIFBhdGNoTXV0YXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhQYXRjaE11dGF0aW9uLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gUGF0Y2hNdXRhdGlvbihrZXksIGRhdGEsIGZpZWxkTWFzaywgcHJlY29uZGl0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgX3RoaXMuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgX3RoaXMuZmllbGRNYXNrID0gZmllbGRNYXNrO1xyXG4gICAgICAgIF90aGlzLnByZWNvbmRpdGlvbiA9IHByZWNvbmRpdGlvbjtcclxuICAgICAgICBfdGhpcy50eXBlID0gTXV0YXRpb25UeXBlLlBhdGNoO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFBhdGNoTXV0YXRpb24ucHJvdG90eXBlLmFwcGx5VG9SZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChtYXliZURvYywgbXV0YXRpb25SZXN1bHQpIHtcclxuICAgICAgICB0aGlzLnZlcmlmeUtleU1hdGNoZXMobWF5YmVEb2MpO1xyXG4gICAgICAgIGFzc2VydChtdXRhdGlvblJlc3VsdC50cmFuc2Zvcm1SZXN1bHRzID09IG51bGwsICdUcmFuc2Zvcm0gcmVzdWx0cyByZWNlaXZlZCBieSBQYXRjaE11dGF0aW9uLicpO1xyXG4gICAgICAgIGlmICghdGhpcy5wcmVjb25kaXRpb24uaXNWYWxpZEZvcihtYXliZURvYykpIHtcclxuICAgICAgICAgICAgLy8gU2luY2UgdGhlIG11dGF0aW9uIHdhcyBub3QgcmVqZWN0ZWQsIHdlIGtub3cgdGhhdCB0aGUgIHByZWNvbmRpdGlvblxyXG4gICAgICAgICAgICAvLyBtYXRjaGVkIG9uIHRoZSBiYWNrZW5kLiBXZSB0aGVyZWZvcmUgbXVzdCBub3QgaGF2ZSB0aGUgZXhwZWN0ZWQgdmVyc2lvblxyXG4gICAgICAgICAgICAvLyBvZiB0aGUgZG9jdW1lbnQgaW4gb3VyIGNhY2hlIGFuZCByZXR1cm4gYW4gVW5rbm93bkRvY3VtZW50IHdpdGggdGhlXHJcbiAgICAgICAgICAgIC8vIGtub3duIHVwZGF0ZVRpbWUuXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVW5rbm93bkRvY3VtZW50KHRoaXMua2V5LCBtdXRhdGlvblJlc3VsdC52ZXJzaW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG5ld0RhdGEgPSB0aGlzLnBhdGNoRG9jdW1lbnQobWF5YmVEb2MpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnQodGhpcy5rZXksIG11dGF0aW9uUmVzdWx0LnZlcnNpb24sIG5ld0RhdGEsIHtcclxuICAgICAgICAgICAgaGFzQ29tbWl0dGVkTXV0YXRpb25zOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUGF0Y2hNdXRhdGlvbi5wcm90b3R5cGUuYXBwbHlUb0xvY2FsVmlldyA9IGZ1bmN0aW9uIChtYXliZURvYywgYmFzZURvYywgbG9jYWxXcml0ZVRpbWUpIHtcclxuICAgICAgICB0aGlzLnZlcmlmeUtleU1hdGNoZXMobWF5YmVEb2MpO1xyXG4gICAgICAgIGlmICghdGhpcy5wcmVjb25kaXRpb24uaXNWYWxpZEZvcihtYXliZURvYykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1heWJlRG9jO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdmVyc2lvbiA9IE11dGF0aW9uLmdldFBvc3RNdXRhdGlvblZlcnNpb24obWF5YmVEb2MpO1xyXG4gICAgICAgIHZhciBuZXdEYXRhID0gdGhpcy5wYXRjaERvY3VtZW50KG1heWJlRG9jKTtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50KHRoaXMua2V5LCB2ZXJzaW9uLCBuZXdEYXRhLCB7XHJcbiAgICAgICAgICAgIGhhc0xvY2FsTXV0YXRpb25zOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUGF0Y2hNdXRhdGlvbi5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBQYXRjaE11dGF0aW9uICYmXHJcbiAgICAgICAgICAgIHRoaXMua2V5LmlzRXF1YWwob3RoZXIua2V5KSAmJlxyXG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFzay5pc0VxdWFsKG90aGVyLmZpZWxkTWFzaykgJiZcclxuICAgICAgICAgICAgdGhpcy5wcmVjb25kaXRpb24uaXNFcXVhbChvdGhlci5wcmVjb25kaXRpb24pKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhdGNoZXMgdGhlIGRhdGEgb2YgZG9jdW1lbnQgaWYgYXZhaWxhYmxlIG9yIGNyZWF0ZXMgYSBuZXcgZG9jdW1lbnQuIE5vdGVcclxuICAgICAqIHRoYXQgdGhpcyBkb2VzIG5vdCBjaGVjayB3aGV0aGVyIG9yIG5vdCB0aGUgcHJlY29uZGl0aW9uIG9mIHRoaXMgcGF0Y2hcclxuICAgICAqIGhvbGRzLlxyXG4gICAgICovXHJcbiAgICBQYXRjaE11dGF0aW9uLnByb3RvdHlwZS5wYXRjaERvY3VtZW50ID0gZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgaWYgKG1heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgZGF0YSA9IG1heWJlRG9jLmRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkYXRhID0gT2JqZWN0VmFsdWUuRU1QVFk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnBhdGNoT2JqZWN0KGRhdGEpO1xyXG4gICAgfTtcclxuICAgIFBhdGNoTXV0YXRpb24ucHJvdG90eXBlLnBhdGNoT2JqZWN0ID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5maWVsZE1hc2suZmllbGRzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZmllbGRQYXRoID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBpZiAoIWZpZWxkUGF0aC5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHRoaXMuZGF0YS5maWVsZChmaWVsZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhID0gZGF0YS5zZXQoZmllbGRQYXRoLCBuZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhID0gZGF0YS5kZWxldGUoZmllbGRQYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGF0Y2hNdXRhdGlvbjtcclxufShNdXRhdGlvbikpO1xyXG4vKipcclxuICogQSBtdXRhdGlvbiB0aGF0IG1vZGlmaWVzIHNwZWNpZmljIGZpZWxkcyBvZiB0aGUgZG9jdW1lbnQgd2l0aCB0cmFuc2Zvcm1cclxuICogb3BlcmF0aW9ucy4gQ3VycmVudGx5IHRoZSBvbmx5IHN1cHBvcnRlZCB0cmFuc2Zvcm0gaXMgYSBzZXJ2ZXIgdGltZXN0YW1wLCBidXRcclxuICogSVAgQWRkcmVzcywgaW5jcmVtZW50KG4pLCBldGMuIGNvdWxkIGJlIHN1cHBvcnRlZCBpbiB0aGUgZnV0dXJlLlxyXG4gKlxyXG4gKiBJdCBpcyBzb21ld2hhdCBzaW1pbGFyIHRvIGEgUGF0Y2hNdXRhdGlvbiBpbiB0aGF0IGl0IHBhdGNoZXMgc3BlY2lmaWMgZmllbGRzXHJcbiAqIGFuZCBoYXMgbm8gZWZmZWN0IHdoZW4gYXBwbGllZCB0byBhIG51bGwgb3IgTm9Eb2N1bWVudCAoc2VlIGNvbW1lbnQgb25cclxuICogTXV0YXRpb24gZm9yIHJhdGlvbmFsZSkuXHJcbiAqL1xyXG52YXIgVHJhbnNmb3JtTXV0YXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhUcmFuc2Zvcm1NdXRhdGlvbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFRyYW5zZm9ybU11dGF0aW9uKGtleSwgZmllbGRUcmFuc2Zvcm1zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgX3RoaXMuZmllbGRUcmFuc2Zvcm1zID0gZmllbGRUcmFuc2Zvcm1zO1xyXG4gICAgICAgIF90aGlzLnR5cGUgPSBNdXRhdGlvblR5cGUuVHJhbnNmb3JtO1xyXG4gICAgICAgIC8vIE5PVEU6IFdlIHNldCBhIHByZWNvbmRpdGlvbiBvZiBleGlzdHM6IHRydWUgYXMgYSBzYWZldHktY2hlY2ssIHNpbmNlIHdlXHJcbiAgICAgICAgLy8gYWx3YXlzIGNvbWJpbmUgVHJhbnNmb3JtTXV0YXRpb25zIHdpdGggYSBTZXRNdXRhdGlvbiBvciBQYXRjaE11dGF0aW9uIHdoaWNoXHJcbiAgICAgICAgLy8gKGlmIHN1Y2Nlc3NmdWwpIHNob3VsZCBlbmQgdXAgd2l0aCBhbiBleGlzdGluZyBkb2N1bWVudC5cclxuICAgICAgICBfdGhpcy5wcmVjb25kaXRpb24gPSBQcmVjb25kaXRpb24uZXhpc3RzKHRydWUpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFRyYW5zZm9ybU11dGF0aW9uLnByb3RvdHlwZS5hcHBseVRvUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAobWF5YmVEb2MsIG11dGF0aW9uUmVzdWx0KSB7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlLZXlNYXRjaGVzKG1heWJlRG9jKTtcclxuICAgICAgICBhc3NlcnQobXV0YXRpb25SZXN1bHQudHJhbnNmb3JtUmVzdWx0cyAhPSBudWxsLCAnVHJhbnNmb3JtIHJlc3VsdHMgbWlzc2luZyBmb3IgVHJhbnNmb3JtTXV0YXRpb24uJyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnByZWNvbmRpdGlvbi5pc1ZhbGlkRm9yKG1heWJlRG9jKSkge1xyXG4gICAgICAgICAgICAvLyBTaW5jZSB0aGUgbXV0YXRpb24gd2FzIG5vdCByZWplY3RlZCwgd2Uga25vdyB0aGF0IHRoZSAgcHJlY29uZGl0aW9uXHJcbiAgICAgICAgICAgIC8vIG1hdGNoZWQgb24gdGhlIGJhY2tlbmQuIFdlIHRoZXJlZm9yZSBtdXN0IG5vdCBoYXZlIHRoZSBleHBlY3RlZCB2ZXJzaW9uXHJcbiAgICAgICAgICAgIC8vIG9mIHRoZSBkb2N1bWVudCBpbiBvdXIgY2FjaGUgYW5kIHJldHVybiBhbiBVbmtub3duRG9jdW1lbnQgd2l0aCB0aGVcclxuICAgICAgICAgICAgLy8ga25vd24gdXBkYXRlVGltZS5cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBVbmtub3duRG9jdW1lbnQodGhpcy5rZXksIG11dGF0aW9uUmVzdWx0LnZlcnNpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZG9jID0gdGhpcy5yZXF1aXJlRG9jdW1lbnQobWF5YmVEb2MpO1xyXG4gICAgICAgIHZhciB0cmFuc2Zvcm1SZXN1bHRzID0gdGhpcy5zZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzKG1heWJlRG9jLCBtdXRhdGlvblJlc3VsdC50cmFuc2Zvcm1SZXN1bHRzKTtcclxuICAgICAgICB2YXIgdmVyc2lvbiA9IG11dGF0aW9uUmVzdWx0LnZlcnNpb247XHJcbiAgICAgICAgdmFyIG5ld0RhdGEgPSB0aGlzLnRyYW5zZm9ybU9iamVjdChkb2MuZGF0YSwgdHJhbnNmb3JtUmVzdWx0cyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudCh0aGlzLmtleSwgdmVyc2lvbiwgbmV3RGF0YSwge1xyXG4gICAgICAgICAgICBoYXNDb21taXR0ZWRNdXRhdGlvbnM6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBUcmFuc2Zvcm1NdXRhdGlvbi5wcm90b3R5cGUuYXBwbHlUb0xvY2FsVmlldyA9IGZ1bmN0aW9uIChtYXliZURvYywgYmFzZURvYywgbG9jYWxXcml0ZVRpbWUpIHtcclxuICAgICAgICB0aGlzLnZlcmlmeUtleU1hdGNoZXMobWF5YmVEb2MpO1xyXG4gICAgICAgIGlmICghdGhpcy5wcmVjb25kaXRpb24uaXNWYWxpZEZvcihtYXliZURvYykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1heWJlRG9jO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZG9jID0gdGhpcy5yZXF1aXJlRG9jdW1lbnQobWF5YmVEb2MpO1xyXG4gICAgICAgIHZhciB0cmFuc2Zvcm1SZXN1bHRzID0gdGhpcy5sb2NhbFRyYW5zZm9ybVJlc3VsdHMobG9jYWxXcml0ZVRpbWUsIGJhc2VEb2MpO1xyXG4gICAgICAgIHZhciBuZXdEYXRhID0gdGhpcy50cmFuc2Zvcm1PYmplY3QoZG9jLmRhdGEsIHRyYW5zZm9ybVJlc3VsdHMpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnQodGhpcy5rZXksIGRvYy52ZXJzaW9uLCBuZXdEYXRhLCB7XHJcbiAgICAgICAgICAgIGhhc0xvY2FsTXV0YXRpb25zOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNmb3JtTXV0YXRpb24ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgVHJhbnNmb3JtTXV0YXRpb24gJiZcclxuICAgICAgICAgICAgdGhpcy5rZXkuaXNFcXVhbChvdGhlci5rZXkpICYmXHJcbiAgICAgICAgICAgIGFycmF5RXF1YWxzKHRoaXMuZmllbGRUcmFuc2Zvcm1zLCBvdGhlci5maWVsZFRyYW5zZm9ybXMpICYmXHJcbiAgICAgICAgICAgIHRoaXMucHJlY29uZGl0aW9uLmlzRXF1YWwob3RoZXIucHJlY29uZGl0aW9uKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBc3NlcnRzIHRoYXQgdGhlIGdpdmVuIE1heWJlRG9jdW1lbnQgaXMgYWN0dWFsbHkgYSBEb2N1bWVudCBhbmQgdmVyaWZpZXNcclxuICAgICAqIHRoYXQgaXQgbWF0Y2hlcyB0aGUga2V5IGZvciB0aGlzIG11dGF0aW9uLiBTaW5jZSB3ZSBvbmx5IHN1cHBvcnRcclxuICAgICAqIHRyYW5zZm9ybWF0aW9ucyB3aXRoIHByZWNvbmRpdGlvbiBleGlzdHMgdGhpcyBtZXRob2QgaXMgZ3VhcmFudGVlZCB0byBiZVxyXG4gICAgICogc2FmZS5cclxuICAgICAqL1xyXG4gICAgVHJhbnNmb3JtTXV0YXRpb24ucHJvdG90eXBlLnJlcXVpcmVEb2N1bWVudCA9IGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgIGFzc2VydChtYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50LCAnVW5rbm93biBNYXliZURvY3VtZW50IHR5cGUgJyArIG1heWJlRG9jKTtcclxuICAgICAgICB2YXIgZG9jID0gbWF5YmVEb2M7XHJcbiAgICAgICAgYXNzZXJ0KGRvYy5rZXkuaXNFcXVhbCh0aGlzLmtleSksICdDYW4gb25seSB0cmFuc2Zvcm0gYSBkb2N1bWVudCB3aXRoIHRoZSBzYW1lIGtleScpO1xyXG4gICAgICAgIHJldHVybiBkb2M7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgbGlzdCBvZiBcInRyYW5zZm9ybSByZXN1bHRzXCIgKGEgdHJhbnNmb3JtIHJlc3VsdCBpcyBhIGZpZWxkIHZhbHVlXHJcbiAgICAgKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIHRyYW5zZm9ybSkgZm9yIHVzZSBhZnRlciBhXHJcbiAgICAgKiBUcmFuc2Zvcm1NdXRhdGlvbiBoYXMgYmVlbiBhY2tub3dsZWRnZWQgYnkgdGhlIHNlcnZlci5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYmFzZURvYyBUaGUgZG9jdW1lbnQgcHJpb3IgdG8gYXBwbHlpbmcgdGhpcyBtdXRhdGlvbiBiYXRjaC5cclxuICAgICAqIEBwYXJhbSBzZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyByZWNlaXZlZCBieSB0aGUgc2VydmVyLlxyXG4gICAgICogQHJldHVybiBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgbGlzdC5cclxuICAgICAqL1xyXG4gICAgVHJhbnNmb3JtTXV0YXRpb24ucHJvdG90eXBlLnNlcnZlclRyYW5zZm9ybVJlc3VsdHMgPSBmdW5jdGlvbiAoYmFzZURvYywgc2VydmVyVHJhbnNmb3JtUmVzdWx0cykge1xyXG4gICAgICAgIHZhciB0cmFuc2Zvcm1SZXN1bHRzID0gW107XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuZmllbGRUcmFuc2Zvcm1zLmxlbmd0aCA9PT0gc2VydmVyVHJhbnNmb3JtUmVzdWx0cy5sZW5ndGgsIFwic2VydmVyIHRyYW5zZm9ybSByZXN1bHQgY291bnQgKFwiICsgc2VydmVyVHJhbnNmb3JtUmVzdWx0cy5sZW5ndGggKyBcIikgXCIgK1xyXG4gICAgICAgICAgICAoXCJzaG91bGQgbWF0Y2ggZmllbGQgdHJhbnNmb3JtIGNvdW50IChcIiArIHRoaXMuZmllbGRUcmFuc2Zvcm1zLmxlbmd0aCArIFwiKVwiKSk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZFRyYW5zZm9ybSA9IHRoaXMuZmllbGRUcmFuc2Zvcm1zW2ldO1xyXG4gICAgICAgICAgICB2YXIgdHJhbnNmb3JtID0gZmllbGRUcmFuc2Zvcm0udHJhbnNmb3JtO1xyXG4gICAgICAgICAgICB2YXIgcHJldmlvdXNWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChiYXNlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHByZXZpb3VzVmFsdWUgPSBiYXNlRG9jLmZpZWxkKGZpZWxkVHJhbnNmb3JtLmZpZWxkKSB8fCBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybVJlc3VsdHMucHVzaCh0cmFuc2Zvcm0uYXBwbHlUb1JlbW90ZURvY3VtZW50KHByZXZpb3VzVmFsdWUsIHNlcnZlclRyYW5zZm9ybVJlc3VsdHNbaV0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRyYW5zZm9ybVJlc3VsdHM7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgbGlzdCBvZiBcInRyYW5zZm9ybSByZXN1bHRzXCIgKGEgdHJhbnNmb3JtIHJlc3VsdCBpcyBhIGZpZWxkIHZhbHVlXHJcbiAgICAgKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIHRyYW5zZm9ybSkgZm9yIHVzZSB3aGVuIGFwcGx5aW5nIGFcclxuICAgICAqIFRyYW5zZm9ybU11dGF0aW9uIGxvY2FsbHkuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGxvY2FsV3JpdGVUaW1lIFRoZSBsb2NhbCB0aW1lIG9mIHRoZSB0cmFuc2Zvcm0gbXV0YXRpb24gKHVzZWQgdG9cclxuICAgICAqICAgICBnZW5lcmF0ZSBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZXMpLlxyXG4gICAgICogQHBhcmFtIGJhc2VEb2MgVGhlIGRvY3VtZW50IHByaW9yIHRvIGFwcGx5aW5nIHRoaXMgbXV0YXRpb24gYmF0Y2guXHJcbiAgICAgKiBAcmV0dXJuIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxyXG4gICAgICovXHJcbiAgICBUcmFuc2Zvcm1NdXRhdGlvbi5wcm90b3R5cGUubG9jYWxUcmFuc2Zvcm1SZXN1bHRzID0gZnVuY3Rpb24gKGxvY2FsV3JpdGVUaW1lLCBiYXNlRG9jKSB7XHJcbiAgICAgICAgdmFyIHRyYW5zZm9ybVJlc3VsdHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5maWVsZFRyYW5zZm9ybXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZFRyYW5zZm9ybSA9IF9hW19pXTtcclxuICAgICAgICAgICAgdmFyIHRyYW5zZm9ybSA9IGZpZWxkVHJhbnNmb3JtLnRyYW5zZm9ybTtcclxuICAgICAgICAgICAgdmFyIHByZXZpb3VzVmFsdWUgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoYmFzZURvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBwcmV2aW91c1ZhbHVlID0gYmFzZURvYy5maWVsZChmaWVsZFRyYW5zZm9ybS5maWVsZCkgfHwgbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0cmFuc2Zvcm1SZXN1bHRzLnB1c2godHJhbnNmb3JtLmFwcGx5VG9Mb2NhbFZpZXcocHJldmlvdXNWYWx1ZSwgbG9jYWxXcml0ZVRpbWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRyYW5zZm9ybVJlc3VsdHM7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNmb3JtTXV0YXRpb24ucHJvdG90eXBlLnRyYW5zZm9ybU9iamVjdCA9IGZ1bmN0aW9uIChkYXRhLCB0cmFuc2Zvcm1SZXN1bHRzKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRyYW5zZm9ybVJlc3VsdHMubGVuZ3RoID09PSB0aGlzLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGgsICdUcmFuc2Zvcm1SZXN1bHRzIGxlbmd0aCBtaXNtYXRjaC4nKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZmllbGRUcmFuc2Zvcm1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZFRyYW5zZm9ybSA9IHRoaXMuZmllbGRUcmFuc2Zvcm1zW2ldO1xyXG4gICAgICAgICAgICB2YXIgZmllbGRQYXRoID0gZmllbGRUcmFuc2Zvcm0uZmllbGQ7XHJcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLnNldChmaWVsZFBhdGgsIHRyYW5zZm9ybVJlc3VsdHNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVHJhbnNmb3JtTXV0YXRpb247XHJcbn0oTXV0YXRpb24pKTtcclxuLyoqIEEgbXV0YXRpb24gdGhhdCBkZWxldGVzIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5LiAqL1xyXG52YXIgRGVsZXRlTXV0YXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhEZWxldGVNdXRhdGlvbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIERlbGV0ZU11dGF0aW9uKGtleSwgcHJlY29uZGl0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgX3RoaXMucHJlY29uZGl0aW9uID0gcHJlY29uZGl0aW9uO1xyXG4gICAgICAgIF90aGlzLnR5cGUgPSBNdXRhdGlvblR5cGUuRGVsZXRlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIERlbGV0ZU11dGF0aW9uLnByb3RvdHlwZS5hcHBseVRvUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAobWF5YmVEb2MsIG11dGF0aW9uUmVzdWx0KSB7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlLZXlNYXRjaGVzKG1heWJlRG9jKTtcclxuICAgICAgICBhc3NlcnQobXV0YXRpb25SZXN1bHQudHJhbnNmb3JtUmVzdWx0cyA9PSBudWxsLCAnVHJhbnNmb3JtIHJlc3VsdHMgcmVjZWl2ZWQgYnkgRGVsZXRlTXV0YXRpb24uJyk7XHJcbiAgICAgICAgLy8gVW5saWtlIGFwcGx5VG9Mb2NhbFZpZXcsIGlmIHdlJ3JlIGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gYSByZW1vdGVcclxuICAgICAgICAvLyBkb2N1bWVudCB0aGUgc2VydmVyIGhhcyBhY2NlcHRlZCB0aGUgbXV0YXRpb24gc28gdGhlIHByZWNvbmRpdGlvbiBtdXN0XHJcbiAgICAgICAgLy8gaGF2ZSBoZWxkLlxyXG4gICAgICAgIHJldHVybiBuZXcgTm9Eb2N1bWVudCh0aGlzLmtleSwgbXV0YXRpb25SZXN1bHQudmVyc2lvbiwge1xyXG4gICAgICAgICAgICBoYXNDb21taXR0ZWRNdXRhdGlvbnM6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBEZWxldGVNdXRhdGlvbi5wcm90b3R5cGUuYXBwbHlUb0xvY2FsVmlldyA9IGZ1bmN0aW9uIChtYXliZURvYywgYmFzZURvYywgbG9jYWxXcml0ZVRpbWUpIHtcclxuICAgICAgICB0aGlzLnZlcmlmeUtleU1hdGNoZXMobWF5YmVEb2MpO1xyXG4gICAgICAgIGlmICghdGhpcy5wcmVjb25kaXRpb24uaXNWYWxpZEZvcihtYXliZURvYykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1heWJlRG9jO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobWF5YmVEb2MpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KG1heWJlRG9jLmtleS5pc0VxdWFsKHRoaXMua2V5KSwgJ0NhbiBvbmx5IGFwcGx5IG11dGF0aW9uIHRvIGRvY3VtZW50IHdpdGggc2FtZSBrZXknKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBOb0RvY3VtZW50KHRoaXMua2V5LCBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpKTtcclxuICAgIH07XHJcbiAgICBEZWxldGVNdXRhdGlvbi5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBEZWxldGVNdXRhdGlvbiAmJlxyXG4gICAgICAgICAgICB0aGlzLmtleS5pc0VxdWFsKG90aGVyLmtleSkgJiZcclxuICAgICAgICAgICAgdGhpcy5wcmVjb25kaXRpb24uaXNFcXVhbChvdGhlci5wcmVjb25kaXRpb24pKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRGVsZXRlTXV0YXRpb247XHJcbn0oTXV0YXRpb24pKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKiBUcmFuc2Zvcm1zIGEgdmFsdWUgaW50byBhIHNlcnZlci1nZW5lcmF0ZWQgdGltZXN0YW1wLiAqL1xyXG52YXIgU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtKCkge1xyXG4gICAgfVxyXG4gICAgU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtLnByb3RvdHlwZS5hcHBseVRvTG9jYWxWaWV3ID0gZnVuY3Rpb24gKHByZXZpb3VzVmFsdWUsIGxvY2FsV3JpdGVUaW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZShsb2NhbFdyaXRlVGltZSwgcHJldmlvdXNWYWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtLnByb3RvdHlwZS5hcHBseVRvUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAocHJldmlvdXNWYWx1ZSwgdHJhbnNmb3JtUmVzdWx0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRyYW5zZm9ybVJlc3VsdDtcclxuICAgIH07XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gb3RoZXIgaW5zdGFuY2VvZiBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm07XHJcbiAgICB9O1xyXG4gICAgU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtLmluc3RhbmNlID0gbmV3IFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybSgpO1xyXG4gICAgcmV0dXJuIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybTtcclxufSgpKTtcclxuLyoqIFRyYW5zZm9ybXMgYW4gYXJyYXkgdmFsdWUgdmlhIGEgdW5pb24gb3BlcmF0aW9uLiAqL1xyXG52YXIgQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24oZWxlbWVudHMpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnRzID0gZWxlbWVudHM7XHJcbiAgICB9XHJcbiAgICBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uLnByb3RvdHlwZS5hcHBseVRvTG9jYWxWaWV3ID0gZnVuY3Rpb24gKHByZXZpb3VzVmFsdWUsIGxvY2FsV3JpdGVUaW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHkocHJldmlvdXNWYWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbi5wcm90b3R5cGUuYXBwbHlUb1JlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKHByZXZpb3VzVmFsdWUsIHRyYW5zZm9ybVJlc3VsdCkge1xyXG4gICAgICAgIC8vIFRoZSBzZXJ2ZXIganVzdCBzZW5kcyBudWxsIGFzIHRoZSB0cmFuc2Zvcm0gcmVzdWx0IGZvciBhcnJheSBvcGVyYXRpb25zLFxyXG4gICAgICAgIC8vIHNvIHdlIGhhdmUgdG8gY2FsY3VsYXRlIGEgcmVzdWx0IHRoZSBzYW1lIGFzIHdlIGRvIGZvciBsb2NhbFxyXG4gICAgICAgIC8vIGFwcGxpY2F0aW9ucy5cclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseShwcmV2aW91c1ZhbHVlKTtcclxuICAgIH07XHJcbiAgICBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uLnByb3RvdHlwZS5hcHBseSA9IGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IGNvZXJjZWRGaWVsZFZhbHVlc0FycmF5KHByZXZpb3VzVmFsdWUpO1xyXG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHRvVW5pb24pIHtcclxuICAgICAgICAgICAgaWYgKCFyZXN1bHQuZmluZChmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gZWxlbWVudC5pc0VxdWFsKHRvVW5pb24pOyB9KSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godG9Vbmlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmVsZW1lbnRzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgdG9VbmlvbiA9IF9hW19pXTtcclxuICAgICAgICAgICAgX2xvb3BfMSh0b1VuaW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBcnJheVZhbHVlKHJlc3VsdCk7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbi5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uICYmXHJcbiAgICAgICAgICAgIGFycmF5RXF1YWxzKG90aGVyLmVsZW1lbnRzLCB0aGlzLmVsZW1lbnRzKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb247XHJcbn0oKSk7XHJcbi8qKiBUcmFuc2Zvcm1zIGFuIGFycmF5IHZhbHVlIHZpYSBhIHJlbW92ZSBvcGVyYXRpb24uICovXHJcbnZhciBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uKGVsZW1lbnRzKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50cyA9IGVsZW1lbnRzO1xyXG4gICAgfVxyXG4gICAgQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24ucHJvdG90eXBlLmFwcGx5VG9Mb2NhbFZpZXcgPSBmdW5jdGlvbiAocHJldmlvdXNWYWx1ZSwgbG9jYWxXcml0ZVRpbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseShwcmV2aW91c1ZhbHVlKTtcclxuICAgIH07XHJcbiAgICBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbi5wcm90b3R5cGUuYXBwbHlUb1JlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKHByZXZpb3VzVmFsdWUsIHRyYW5zZm9ybVJlc3VsdCkge1xyXG4gICAgICAgIC8vIFRoZSBzZXJ2ZXIganVzdCBzZW5kcyBudWxsIGFzIHRoZSB0cmFuc2Zvcm0gcmVzdWx0IGZvciBhcnJheSBvcGVyYXRpb25zLFxyXG4gICAgICAgIC8vIHNvIHdlIGhhdmUgdG8gY2FsY3VsYXRlIGEgcmVzdWx0IHRoZSBzYW1lIGFzIHdlIGRvIGZvciBsb2NhbFxyXG4gICAgICAgIC8vIGFwcGxpY2F0aW9ucy5cclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseShwcmV2aW91c1ZhbHVlKTtcclxuICAgIH07XHJcbiAgICBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbi5wcm90b3R5cGUuYXBwbHkgPSBmdW5jdGlvbiAocHJldmlvdXNWYWx1ZSkge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBjb2VyY2VkRmllbGRWYWx1ZXNBcnJheShwcmV2aW91c1ZhbHVlKTtcclxuICAgICAgICB2YXIgX2xvb3BfMiA9IGZ1bmN0aW9uICh0b1JlbW92ZSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuZmlsdGVyKGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiAhZWxlbWVudC5pc0VxdWFsKHRvUmVtb3ZlKTsgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5lbGVtZW50czsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHRvUmVtb3ZlID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBfbG9vcF8yKHRvUmVtb3ZlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBcnJheVZhbHVlKHJlc3VsdCk7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24gJiZcclxuICAgICAgICAgICAgYXJyYXlFcXVhbHMob3RoZXIuZWxlbWVudHMsIHRoaXMuZWxlbWVudHMpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb247XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGNvZXJjZWRGaWVsZFZhbHVlc0FycmF5KHZhbHVlKSB7XHJcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheVZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlLmludGVybmFsVmFsdWUuc2xpY2UoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIGNvZXJjZSB0byBlbXB0eSBhcnJheS5cclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBFeGlzdGVuY2VGaWx0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyBUT0RPKGIvMzMwNzgxNjMpOiBqdXN0IHVzZSBzaW1wbGVzdCBmb3JtIG9mIGV4aXN0ZW5jZSBmaWx0ZXIgZm9yIG5vd1xyXG4gICAgZnVuY3Rpb24gRXhpc3RlbmNlRmlsdGVyKGNvdW50KSB7XHJcbiAgICAgICAgdGhpcy5jb3VudCA9IGNvdW50O1xyXG4gICAgfVxyXG4gICAgRXhpc3RlbmNlRmlsdGVyLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIG90aGVyICYmIG90aGVyLmNvdW50ID09PSB0aGlzLmNvdW50O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBFeGlzdGVuY2VGaWx0ZXI7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRXJyb3IgQ29kZXMgZGVzY3JpYmluZyB0aGUgZGlmZmVyZW50IHdheXMgR1JQQyBjYW4gZmFpbC4gVGhlc2UgYXJlIGNvcGllZFxyXG4gKiBkaXJlY3RseSBmcm9tIEdSUEMncyBzb3VyY2VzIGhlcmU6XHJcbiAqXHJcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ncnBjL2dycGMvYmxvYi9iY2VlYzk0ZWE0ZmM1ZjAwODVkODEyMzVkOGUxYzA2Nzk4ZGMzNDFhL2luY2x1ZGUvZ3JwYyUyQiUyQi9pbXBsL2NvZGVnZW4vc3RhdHVzX2NvZGVfZW51bS5oXHJcbiAqXHJcbiAqIEltcG9ydGFudCEgVGhlIG5hbWVzIG9mIHRoZXNlIGlkZW50aWZpZXJzIG1hdHRlciBiZWNhdXNlIHRoZSBzdHJpbmcgZm9ybXNcclxuICogYXJlIHVzZWQgZm9yIHJldmVyc2UgbG9va3VwcyBmcm9tIHRoZSB3ZWJjaGFubmVsIHN0cmVhbS4gRG8gTk9UIGNoYW5nZSB0aGVcclxuICogbmFtZXMgb2YgdGhlc2UgaWRlbnRpZmllcnMuXHJcbiAqL1xyXG52YXIgUnBjQ29kZTtcclxuKGZ1bmN0aW9uIChScGNDb2RlKSB7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJPS1wiXSA9IDBdID0gXCJPS1wiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiQ0FOQ0VMTEVEXCJdID0gMV0gPSBcIkNBTkNFTExFRFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiVU5LTk9XTlwiXSA9IDJdID0gXCJVTktOT1dOXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJJTlZBTElEX0FSR1VNRU5UXCJdID0gM10gPSBcIklOVkFMSURfQVJHVU1FTlRcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIkRFQURMSU5FX0VYQ0VFREVEXCJdID0gNF0gPSBcIkRFQURMSU5FX0VYQ0VFREVEXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJOT1RfRk9VTkRcIl0gPSA1XSA9IFwiTk9UX0ZPVU5EXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJBTFJFQURZX0VYSVNUU1wiXSA9IDZdID0gXCJBTFJFQURZX0VYSVNUU1wiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiUEVSTUlTU0lPTl9ERU5JRURcIl0gPSA3XSA9IFwiUEVSTUlTU0lPTl9ERU5JRURcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIlVOQVVUSEVOVElDQVRFRFwiXSA9IDE2XSA9IFwiVU5BVVRIRU5USUNBVEVEXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJSRVNPVVJDRV9FWEhBVVNURURcIl0gPSA4XSA9IFwiUkVTT1VSQ0VfRVhIQVVTVEVEXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJGQUlMRURfUFJFQ09ORElUSU9OXCJdID0gOV0gPSBcIkZBSUxFRF9QUkVDT05ESVRJT05cIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIkFCT1JURURcIl0gPSAxMF0gPSBcIkFCT1JURURcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIk9VVF9PRl9SQU5HRVwiXSA9IDExXSA9IFwiT1VUX09GX1JBTkdFXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJVTklNUExFTUVOVEVEXCJdID0gMTJdID0gXCJVTklNUExFTUVOVEVEXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJJTlRFUk5BTFwiXSA9IDEzXSA9IFwiSU5URVJOQUxcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIlVOQVZBSUxBQkxFXCJdID0gMTRdID0gXCJVTkFWQUlMQUJMRVwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiREFUQV9MT1NTXCJdID0gMTVdID0gXCJEQVRBX0xPU1NcIjtcclxufSkoUnBjQ29kZSB8fCAoUnBjQ29kZSA9IHt9KSk7XHJcbmZ1bmN0aW9uIGlzUGVybWFuZW50RXJyb3IoY29kZSkge1xyXG4gICAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICAgICAgY2FzZSBDb2RlLk9LOlxyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVHJlYXRlZCBzdGF0dXMgT0sgYXMgZXJyb3InKTtcclxuICAgICAgICBjYXNlIENvZGUuQ0FOQ0VMTEVEOlxyXG4gICAgICAgIGNhc2UgQ29kZS5VTktOT1dOOlxyXG4gICAgICAgIGNhc2UgQ29kZS5ERUFETElORV9FWENFRURFRDpcclxuICAgICAgICBjYXNlIENvZGUuUkVTT1VSQ0VfRVhIQVVTVEVEOlxyXG4gICAgICAgIGNhc2UgQ29kZS5JTlRFUk5BTDpcclxuICAgICAgICBjYXNlIENvZGUuVU5BVkFJTEFCTEU6XHJcbiAgICAgICAgLy8gVW5hdXRoZW50aWNhdGVkIG1lYW5zIHNvbWV0aGluZyB3ZW50IHdyb25nIHdpdGggb3VyIHRva2VuIGFuZCB3ZSBuZWVkXHJcbiAgICAgICAgLy8gdG8gcmV0cnkgd2l0aCBuZXcgY3JlZGVudGlhbHMgd2hpY2ggd2lsbCBoYXBwZW4gYXV0b21hdGljYWxseS5cclxuICAgICAgICBjYXNlIENvZGUuVU5BVVRIRU5USUNBVEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgY2FzZSBDb2RlLklOVkFMSURfQVJHVU1FTlQ6XHJcbiAgICAgICAgY2FzZSBDb2RlLk5PVF9GT1VORDpcclxuICAgICAgICBjYXNlIENvZGUuQUxSRUFEWV9FWElTVFM6XHJcbiAgICAgICAgY2FzZSBDb2RlLlBFUk1JU1NJT05fREVOSUVEOlxyXG4gICAgICAgIGNhc2UgQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OOlxyXG4gICAgICAgIC8vIEFib3J0ZWQgbWlnaHQgYmUgcmV0cmllZCBpbiBzb21lIHNjZW5hcmlvcywgYnV0IHRoYXQgaXMgZGVwZW5kYW50IG9uXHJcbiAgICAgICAgLy8gdGhlIGNvbnRleHQgYW5kIHNob3VsZCBoYW5kbGVkIGluZGl2aWR1YWxseSBieSB0aGUgY2FsbGluZyBjb2RlLlxyXG4gICAgICAgIC8vIFNlZSBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vYXBpcy9kZXNpZ24vZXJyb3JzLlxyXG4gICAgICAgIGNhc2UgQ29kZS5BQk9SVEVEOlxyXG4gICAgICAgIGNhc2UgQ29kZS5PVVRfT0ZfUkFOR0U6XHJcbiAgICAgICAgY2FzZSBDb2RlLlVOSU1QTEVNRU5URUQ6XHJcbiAgICAgICAgY2FzZSBDb2RlLkRBVEFfTE9TUzpcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gc3RhdHVzIGNvZGU6ICcgKyBjb2RlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogTWFwcyBhbiBlcnJvciBDb2RlIGZyb20gYSBHUlBDIHN0YXR1cyBpZGVudGlmaWVyIGxpa2UgJ05PVF9GT1VORCcuXHJcbiAqXHJcbiAqIEByZXR1cm5zIFRoZSBDb2RlIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIHN0YXR1cyBzdHJpbmcgb3IgdW5kZWZpbmVkIGlmXHJcbiAqICAgICB0aGVyZSBpcyBubyBtYXRjaC5cclxuICovXHJcbmZ1bmN0aW9uIG1hcENvZGVGcm9tUnBjU3RhdHVzKHN0YXR1cykge1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBsb29rdXAgYnkgc3RyaW5nXHJcbiAgICB2YXIgY29kZSA9IFJwY0NvZGVbc3RhdHVzXTtcclxuICAgIGlmIChjb2RlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG1hcENvZGVGcm9tUnBjQ29kZShjb2RlKTtcclxufVxyXG4vKipcclxuICogTWFwcyBhbiBlcnJvciBDb2RlIGZyb20gR1JQQyBzdGF0dXMgY29kZSBudW1iZXIsIGxpa2UgMCwgMSwgb3IgMTQuIFRoZXNlXHJcbiAqIGFyZSBub3QgdGhlIHNhbWUgYXMgSFRUUCBzdGF0dXMgY29kZXMuXHJcbiAqXHJcbiAqIEByZXR1cm5zIFRoZSBDb2RlIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIEdSUEMgc3RhdHVzIGNvZGUuIEZhaWxzIGlmIHRoZXJlXHJcbiAqICAgICBpcyBubyBtYXRjaC5cclxuICovXHJcbmZ1bmN0aW9uIG1hcENvZGVGcm9tUnBjQ29kZShjb2RlKSB7XHJcbiAgICBpZiAoY29kZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgLy8gVGhpcyBzaG91bGRuJ3Qgbm9ybWFsbHkgaGFwcGVuLCBidXQgaW4gY2VydGFpbiBlcnJvciBjYXNlcyAobGlrZSB0cnlpbmdcclxuICAgICAgICAvLyB0byBzZW5kIGludmFsaWQgcHJvdG8gbWVzc2FnZXMpIHdlIG1heSBnZXQgYW4gZXJyb3Igd2l0aCBubyBHUlBDIGNvZGUuXHJcbiAgICAgICAgZXJyb3IoJ0dSUEMgZXJyb3IgaGFzIG5vIC5jb2RlJyk7XHJcbiAgICAgICAgcmV0dXJuIENvZGUuVU5LTk9XTjtcclxuICAgIH1cclxuICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5PSzpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuT0s7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLkNBTkNFTExFRDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuQ0FOQ0VMTEVEO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5VTktOT1dOOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5VTktOT1dOO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5ERUFETElORV9FWENFRURFRDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuREVBRExJTkVfRVhDRUVERUQ7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLlJFU09VUkNFX0VYSEFVU1RFRDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuUkVTT1VSQ0VfRVhIQVVTVEVEO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5JTlRFUk5BTDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuSU5URVJOQUw7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLlVOQVZBSUxBQkxFOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5VTkFWQUlMQUJMRTtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuVU5BVVRIRU5USUNBVEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5VTkFVVEhFTlRJQ0FURUQ7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLklOVkFMSURfQVJHVU1FTlQ6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLklOVkFMSURfQVJHVU1FTlQ7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLk5PVF9GT1VORDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuTk9UX0ZPVU5EO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5BTFJFQURZX0VYSVNUUzpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuQUxSRUFEWV9FWElTVFM7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLlBFUk1JU1NJT05fREVOSUVEOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5QRVJNSVNTSU9OX0RFTklFRDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuRkFJTEVEX1BSRUNPTkRJVElPTjpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTjtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuQUJPUlRFRDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuQUJPUlRFRDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuT1VUX09GX1JBTkdFOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5PVVRfT0ZfUkFOR0U7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLlVOSU1QTEVNRU5URUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlVOSU1QTEVNRU5URUQ7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLkRBVEFfTE9TUzpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuREFUQV9MT1NTO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIHN0YXR1cyBjb2RlOiAnICsgY29kZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIE1hcHMgYW4gUlBDIGNvZGUgZnJvbSBhIENvZGUuIFRoaXMgaXMgdGhlIHJldmVyc2Ugb3BlcmF0aW9uIGZyb21cclxuICogbWFwQ29kZUZyb21ScGNDb2RlIGFuZCBzaG91bGQgcmVhbGx5IG9ubHkgYmUgdXNlZCBpbiB0ZXN0cy5cclxuICovXHJcbmZ1bmN0aW9uIG1hcFJwY0NvZGVGcm9tQ29kZShjb2RlKSB7XHJcbiAgICBpZiAoY29kZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIFJwY0NvZGUuT0s7XHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKGNvZGUpIHtcclxuICAgICAgICBjYXNlIENvZGUuT0s6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLk9LO1xyXG4gICAgICAgIGNhc2UgQ29kZS5DQU5DRUxMRUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLkNBTkNFTExFRDtcclxuICAgICAgICBjYXNlIENvZGUuVU5LTk9XTjpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuVU5LTk9XTjtcclxuICAgICAgICBjYXNlIENvZGUuREVBRExJTkVfRVhDRUVERUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLkRFQURMSU5FX0VYQ0VFREVEO1xyXG4gICAgICAgIGNhc2UgQ29kZS5SRVNPVVJDRV9FWEhBVVNURUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLlJFU09VUkNFX0VYSEFVU1RFRDtcclxuICAgICAgICBjYXNlIENvZGUuSU5URVJOQUw6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLklOVEVSTkFMO1xyXG4gICAgICAgIGNhc2UgQ29kZS5VTkFWQUlMQUJMRTpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuVU5BVkFJTEFCTEU7XHJcbiAgICAgICAgY2FzZSBDb2RlLlVOQVVUSEVOVElDQVRFRDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuVU5BVVRIRU5USUNBVEVEO1xyXG4gICAgICAgIGNhc2UgQ29kZS5JTlZBTElEX0FSR1VNRU5UOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5JTlZBTElEX0FSR1VNRU5UO1xyXG4gICAgICAgIGNhc2UgQ29kZS5OT1RfRk9VTkQ6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLk5PVF9GT1VORDtcclxuICAgICAgICBjYXNlIENvZGUuQUxSRUFEWV9FWElTVFM6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLkFMUkVBRFlfRVhJU1RTO1xyXG4gICAgICAgIGNhc2UgQ29kZS5QRVJNSVNTSU9OX0RFTklFRDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuUEVSTUlTU0lPTl9ERU5JRUQ7XHJcbiAgICAgICAgY2FzZSBDb2RlLkZBSUxFRF9QUkVDT05ESVRJT046XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLkZBSUxFRF9QUkVDT05ESVRJT047XHJcbiAgICAgICAgY2FzZSBDb2RlLkFCT1JURUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLkFCT1JURUQ7XHJcbiAgICAgICAgY2FzZSBDb2RlLk9VVF9PRl9SQU5HRTpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuT1VUX09GX1JBTkdFO1xyXG4gICAgICAgIGNhc2UgQ29kZS5VTklNUExFTUVOVEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5VTklNUExFTUVOVEVEO1xyXG4gICAgICAgIGNhc2UgQ29kZS5EQVRBX0xPU1M6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLkRBVEFfTE9TUztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBzdGF0dXMgY29kZTogJyArIGNvZGUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBDb252ZXJ0cyBhbiBIVFRQIFN0YXR1cyBDb2RlIHRvIHRoZSBlcXVpdmFsZW50IGVycm9yIGNvZGUuXHJcbiAqXHJcbiAqIEBwYXJhbSBzdGF0dXMgQW4gSFRUUCBTdGF0dXMgQ29kZSwgbGlrZSAyMDAsIDQwNCwgNTAzLCBldGMuXHJcbiAqIEByZXR1cm5zIFRoZSBlcXVpdmFsZW50IENvZGUuIFVua25vd24gc3RhdHVzIGNvZGVzIGFyZSBtYXBwZWQgdG9cclxuICogICAgIENvZGUuVU5LTk9XTi5cclxuICovXHJcbmZ1bmN0aW9uIG1hcENvZGVGcm9tSHR0cFN0YXR1cyhzdGF0dXMpIHtcclxuICAgIC8vIFRoZSBjYW5vbmljYWwgZXJyb3IgY29kZXMgZm9yIEdvb2dsZSBBUElzIFsxXSBzcGVjaWZ5IG1hcHBpbmcgb250byBIVFRQXHJcbiAgICAvLyBzdGF0dXMgY29kZXMgYnV0IHRoZSBtYXBwaW5nIGlzIG5vdCBiaWplY3RpdmUuIEluIGVhY2ggY2FzZSBvZiBhbWJpZ3VpdHlcclxuICAgIC8vIHRoaXMgZnVuY3Rpb24gY2hvb3NlcyBhIHByaW1hcnkgZXJyb3IuXHJcbiAgICAvL1xyXG4gICAgLy8gWzFdXHJcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlYXBpcy9nb29nbGVhcGlzL2Jsb2IvbWFzdGVyL2dvb2dsZS9ycGMvY29kZS5wcm90b1xyXG4gICAgc3dpdGNoIChzdGF0dXMpIHtcclxuICAgICAgICBjYXNlIDIwMDogLy8gT0tcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuT0s7XHJcbiAgICAgICAgY2FzZSA0MDA6IC8vIEJhZCBSZXF1ZXN0XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLklOVkFMSURfQVJHVU1FTlQ7XHJcbiAgICAgICAgLy8gT3RoZXIgcG9zc2liaWxpdGllcyBiYXNlZCBvbiB0aGUgZm9yd2FyZCBtYXBwaW5nXHJcbiAgICAgICAgLy8gcmV0dXJuIENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTjtcclxuICAgICAgICAvLyByZXR1cm4gQ29kZS5PVVRfT0ZfUkFOR0U7XHJcbiAgICAgICAgY2FzZSA0MDE6IC8vIFVuYXV0aG9yaXplZFxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5VTkFVVEhFTlRJQ0FURUQ7XHJcbiAgICAgICAgY2FzZSA0MDM6IC8vIEZvcmJpZGRlblxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5QRVJNSVNTSU9OX0RFTklFRDtcclxuICAgICAgICBjYXNlIDQwNDogLy8gTm90IEZvdW5kXHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLk5PVF9GT1VORDtcclxuICAgICAgICBjYXNlIDQwOTogLy8gQ29uZmxpY3RcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuQUJPUlRFRDtcclxuICAgICAgICAvLyBPdGhlciBwb3NzaWJpbGl0aWVzOlxyXG4gICAgICAgIC8vIHJldHVybiBDb2RlLkFMUkVBRFlfRVhJU1RTO1xyXG4gICAgICAgIGNhc2UgNDE2OiAvLyBSYW5nZSBOb3QgU2F0aXNmaWFibGVcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuT1VUX09GX1JBTkdFO1xyXG4gICAgICAgIGNhc2UgNDI5OiAvLyBUb28gTWFueSBSZXF1ZXN0c1xyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5SRVNPVVJDRV9FWEhBVVNURUQ7XHJcbiAgICAgICAgY2FzZSA0OTk6IC8vIENsaWVudCBDbG9zZWQgUmVxdWVzdFxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5DQU5DRUxMRUQ7XHJcbiAgICAgICAgY2FzZSA1MDA6IC8vIEludGVybmFsIFNlcnZlciBFcnJvclxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5VTktOT1dOO1xyXG4gICAgICAgIC8vIE90aGVyIHBvc3NpYmlsaXRpZXM6XHJcbiAgICAgICAgLy8gcmV0dXJuIENvZGUuSU5URVJOQUw7XHJcbiAgICAgICAgLy8gcmV0dXJuIENvZGUuREFUQV9MT1NTO1xyXG4gICAgICAgIGNhc2UgNTAxOiAvLyBVbmltcGxlbWVudGVkXHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlVOSU1QTEVNRU5URUQ7XHJcbiAgICAgICAgY2FzZSA1MDM6IC8vIFNlcnZpY2UgVW5hdmFpbGFibGVcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuVU5BVkFJTEFCTEU7XHJcbiAgICAgICAgY2FzZSA1MDQ6IC8vIEdhdGV3YXkgVGltZW91dFxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5ERUFETElORV9FWENFRURFRDtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBpZiAoc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29kZS5PSztcclxuICAgICAgICAgICAgaWYgKHN0YXR1cyA+PSA0MDAgJiYgc3RhdHVzIDwgNTAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTjtcclxuICAgICAgICAgICAgaWYgKHN0YXR1cyA+PSA1MDAgJiYgc3RhdHVzIDwgNjAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENvZGUuSU5URVJOQUw7XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlVOS05PV047XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBTb3J0ZWRTZXQgaXMgYW4gaW1tdXRhYmxlIChjb3B5LW9uLXdyaXRlKSBjb2xsZWN0aW9uIHRoYXQgaG9sZHMgZWxlbWVudHNcclxuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLlxyXG4gKlxyXG4gKiBOT1RFOiBpZiBwcm92aWRlZCBjb21wYXJhdG9yIHJldHVybnMgMCBmb3IgdHdvIGVsZW1lbnRzLCB3ZSBjb25zaWRlciB0aGVtIHRvXHJcbiAqIGJlIGVxdWFsIVxyXG4gKi9cclxudmFyIFNvcnRlZFNldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNvcnRlZFNldChjb21wYXJhdG9yKSB7XHJcbiAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gY29tcGFyYXRvcjtcclxuICAgICAgICB0aGlzLmRhdGEgPSBuZXcgU29ydGVkTWFwKHRoaXMuY29tcGFyYXRvcik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBTb3J0ZWRTZXQgZnJvbSB0aGUga2V5cyBvZiB0aGUgbWFwLlxyXG4gICAgICogVGhpcyBpcyBjdXJyZW50bHkgaW1wbGVtZW50ZWQgYXMgYW4gTyhuKSBjb3B5LlxyXG4gICAgICovXHJcbiAgICBTb3J0ZWRTZXQuZnJvbU1hcEtleXMgPSBmdW5jdGlvbiAobWFwKSB7XHJcbiAgICAgICAgdmFyIGtleXMgPSBuZXcgU29ydGVkU2V0KG1hcC5jb21wYXJhdG9yKTtcclxuICAgICAgICBtYXAuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIGtleXMgPSBrZXlzLmFkZChrZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKGVsZW0pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmdldChlbGVtKSAhPT0gbnVsbDtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEubWluS2V5KCk7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5sYXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEubWF4S2V5KCk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNvcnRlZFNldC5wcm90b3R5cGUsIFwic2l6ZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEuc2l6ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIChlbGVtKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5pbmRleE9mKGVsZW0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBJdGVyYXRlcyBlbGVtZW50cyBpbiBvcmRlciBkZWZpbmVkIGJ5IFwiY29tcGFyYXRvclwiICovXHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2IpIHtcclxuICAgICAgICB0aGlzLmRhdGEuaW5vcmRlclRyYXZlcnNhbChmdW5jdGlvbiAoaywgdikge1xyXG4gICAgICAgICAgICBjYihrKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBJdGVyYXRlcyBvdmVyIGBlbGVtYHMgc3VjaCB0aGF0OiByYW5nZVswXSA8PSBlbGVtIDwgcmFuZ2VbMV0uICovXHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmZvckVhY2hJblJhbmdlID0gZnVuY3Rpb24gKHJhbmdlLCBjYikge1xyXG4gICAgICAgIHZhciBpdGVyID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yRnJvbShyYW5nZVswXSk7XHJcbiAgICAgICAgd2hpbGUgKGl0ZXIuaGFzTmV4dCgpKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGVtID0gaXRlci5nZXROZXh0KCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbXBhcmF0b3IoZWxlbS5rZXksIHJhbmdlWzFdKSA+PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBjYihlbGVtLmtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSXRlcmF0ZXMgb3ZlciBgZWxlbWBzIHN1Y2ggdGhhdDogc3RhcnQgPD0gZWxlbSB1bnRpbCBmYWxzZSBpcyByZXR1cm5lZC5cclxuICAgICAqL1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5mb3JFYWNoV2hpbGUgPSBmdW5jdGlvbiAoY2IsIHN0YXJ0KSB7XHJcbiAgICAgICAgdmFyIGl0ZXI7XHJcbiAgICAgICAgaWYgKHN0YXJ0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgaXRlciA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20oc3RhcnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaXRlciA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB3aGlsZSAoaXRlci5oYXNOZXh0KCkpIHtcclxuICAgICAgICAgICAgdmFyIGVsZW0gPSBpdGVyLmdldE5leHQoKTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGNiKGVsZW0ua2V5KTtcclxuICAgICAgICAgICAgaWYgKCFyZXN1bHQpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiBGaW5kcyB0aGUgbGVhc3QgZWxlbWVudCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gYGVsZW1gLiAqL1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5maXJzdEFmdGVyT3JFcXVhbCA9IGZ1bmN0aW9uIChlbGVtKSB7XHJcbiAgICAgICAgdmFyIGl0ZXIgPSB0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKGVsZW0pO1xyXG4gICAgICAgIHJldHVybiBpdGVyLmhhc05leHQoKSA/IGl0ZXIuZ2V0TmV4dCgpLmtleSA6IG51bGw7XHJcbiAgICB9O1xyXG4gICAgLyoqIEluc2VydHMgb3IgdXBkYXRlcyBhbiBlbGVtZW50ICovXHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChlbGVtKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29weSh0aGlzLmRhdGEucmVtb3ZlKGVsZW0pLmluc2VydChlbGVtLCB0cnVlKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIERlbGV0ZXMgYW4gZWxlbWVudCAqL1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoZWxlbSkge1xyXG4gICAgICAgIGlmICghdGhpcy5oYXMoZWxlbSkpXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkodGhpcy5kYXRhLnJlbW92ZShlbGVtKSk7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuaXNFbXB0eSgpO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUudW5pb25XaXRoID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXM7XHJcbiAgICAgICAgb3RoZXIuZm9yRWFjaChmdW5jdGlvbiAoZWxlbSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuYWRkKGVsZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBTb3J0ZWRTZXQpKVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSlcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHZhciB0aGlzSXQgPSB0aGlzLmRhdGEuZ2V0SXRlcmF0b3IoKTtcclxuICAgICAgICB2YXIgb3RoZXJJdCA9IG90aGVyLmRhdGEuZ2V0SXRlcmF0b3IoKTtcclxuICAgICAgICB3aGlsZSAodGhpc0l0Lmhhc05leHQoKSkge1xyXG4gICAgICAgICAgICB2YXIgdGhpc0VsZW0gPSB0aGlzSXQuZ2V0TmV4dCgpLmtleTtcclxuICAgICAgICAgICAgdmFyIG90aGVyRWxlbSA9IG90aGVySXQuZ2V0TmV4dCgpLmtleTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY29tcGFyYXRvcih0aGlzRWxlbSwgb3RoZXJFbGVtKSAhPT0gMClcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS50b0FycmF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByZXMgPSBbXTtcclxuICAgICAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgIHJlcy5wdXNoKHRhcmdldElkKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbSkgeyByZXR1cm4gcmVzdWx0LnB1c2goZWxlbSk7IH0pO1xyXG4gICAgICAgIHJldHVybiAnU29ydGVkU2V0KCcgKyByZXN1bHQudG9TdHJpbmcoKSArICcpJztcclxuICAgIH07XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBuZXcgU29ydGVkU2V0KHRoaXMuY29tcGFyYXRvcik7XHJcbiAgICAgICAgcmVzdWx0LmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNvcnRlZFNldDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBFTVBUWV9NQVlCRV9ET0NVTUVOVF9NQVAgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG5mdW5jdGlvbiBtYXliZURvY3VtZW50TWFwKCkge1xyXG4gICAgcmV0dXJuIEVNUFRZX01BWUJFX0RPQ1VNRU5UX01BUDtcclxufVxyXG52YXIgRU1QVFlfRE9DVU1FTlRfTUFQID0gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxuZnVuY3Rpb24gZG9jdW1lbnRNYXAoKSB7XHJcbiAgICByZXR1cm4gRU1QVFlfRE9DVU1FTlRfTUFQO1xyXG59XHJcbnZhciBFTVBUWV9ET0NVTUVOVF9WRVJTSU9OX01BUCA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbmZ1bmN0aW9uIGRvY3VtZW50VmVyc2lvbk1hcCgpIHtcclxuICAgIHJldHVybiBFTVBUWV9ET0NVTUVOVF9WRVJTSU9OX01BUDtcclxufVxyXG52YXIgRU1QVFlfRE9DVU1FTlRfS0VZX1NFVCA9IG5ldyBTb3J0ZWRTZXQoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbmZ1bmN0aW9uIGRvY3VtZW50S2V5U2V0KCkge1xyXG4gICAgcmV0dXJuIEVNUFRZX0RPQ1VNRU5UX0tFWV9TRVQ7XHJcbn1cclxudmFyIEVNUFRZX1RBUkdFVF9JRF9TRVQgPSBuZXcgU29ydGVkU2V0KHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG5mdW5jdGlvbiB0YXJnZXRJZFNldCgpIHtcclxuICAgIHJldHVybiBFTVBUWV9UQVJHRVRfSURfU0VUO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRG9jdW1lbnRTZXQgaXMgYW4gaW1tdXRhYmxlIChjb3B5LW9uLXdyaXRlKSBjb2xsZWN0aW9uIHRoYXQgaG9sZHMgZG9jdW1lbnRzXHJcbiAqIGluIG9yZGVyIHNwZWNpZmllZCBieSB0aGUgcHJvdmlkZWQgY29tcGFyYXRvci4gV2UgYWx3YXlzIGFkZCBhIGRvY3VtZW50IGtleVxyXG4gKiBjb21wYXJhdG9yIG9uIHRvcCBvZiB3aGF0IGlzIHByb3ZpZGVkIHRvIGd1YXJhbnRlZSBkb2N1bWVudCBlcXVhbGl0eSBiYXNlZCBvblxyXG4gKiB0aGUga2V5LlxyXG4gKi9cclxudmFyIERvY3VtZW50U2V0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqIFRoZSBkZWZhdWx0IG9yZGVyaW5nIGlzIGJ5IGtleSBpZiB0aGUgY29tcGFyYXRvciBpcyBvbWl0dGVkICovXHJcbiAgICBmdW5jdGlvbiBEb2N1bWVudFNldChjb21wKSB7XHJcbiAgICAgICAgLy8gV2UgYXJlIGFkZGluZyBkb2N1bWVudCBrZXkgY29tcGFyYXRvciB0byB0aGUgZW5kIGFzIGl0J3MgdGhlIG9ubHlcclxuICAgICAgICAvLyBndWFyYW50ZWVkIHVuaXF1ZSBwcm9wZXJ0eSBvZiBhIGRvY3VtZW50LlxyXG4gICAgICAgIGlmIChjb21wKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcGFyYXRvciA9IGZ1bmN0aW9uIChkMSwgZDIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wKGQxLCBkMikgfHwgRG9jdW1lbnRLZXkuY29tcGFyYXRvcihkMS5rZXksIGQyLmtleSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoZDEsIGQyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gRG9jdW1lbnRLZXkuY29tcGFyYXRvcihkMS5rZXksIGQyLmtleSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMua2V5ZWRNYXAgPSBkb2N1bWVudE1hcCgpO1xyXG4gICAgICAgIHRoaXMuc29ydGVkU2V0ID0gbmV3IFNvcnRlZE1hcCh0aGlzLmNvbXBhcmF0b3IpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGFuIGVtcHR5IGNvcHkgb2YgdGhlIGV4aXN0aW5nIERvY3VtZW50U2V0LCB1c2luZyB0aGUgc2FtZVxyXG4gICAgICogY29tcGFyYXRvci5cclxuICAgICAqL1xyXG4gICAgRG9jdW1lbnRTZXQuZW1wdHlTZXQgPSBmdW5jdGlvbiAob2xkU2V0KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudFNldChvbGRTZXQuY29tcGFyYXRvcik7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5rZXllZE1hcC5nZXQoa2V5KSAhPSBudWxsO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5ZWRNYXAuZ2V0KGtleSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5taW5LZXkoKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUubGFzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQubWF4S2V5KCk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0LmlzRW1wdHkoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBwcm92aWRlZCBrZXkgaW4gdGhlIGRvY3VtZW50IHNldCwgb3IgLTEgaWYgdGhlXHJcbiAgICAgKiBkb2N1bWVudCBrZXkgaXMgbm90IHByZXNlbnQgaW4gdGhlIHNldDtcclxuICAgICAqL1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGRvYyA9IHRoaXMua2V5ZWRNYXAuZ2V0KGtleSk7XHJcbiAgICAgICAgcmV0dXJuIGRvYyA/IHRoaXMuc29ydGVkU2V0LmluZGV4T2YoZG9jKSA6IC0xO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb2N1bWVudFNldC5wcm90b3R5cGUsIFwic2l6ZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5zaXplO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqIEl0ZXJhdGVzIGRvY3VtZW50cyBpbiBvcmRlciBkZWZpbmVkIGJ5IFwiY29tcGFyYXRvclwiICovXHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYikge1xyXG4gICAgICAgIHRoaXMuc29ydGVkU2V0Lmlub3JkZXJUcmF2ZXJzYWwoZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICAgICAgY2Ioayk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogSW5zZXJ0cyBvciB1cGRhdGVzIGEgZG9jdW1lbnQgd2l0aCB0aGUgc2FtZSBrZXkgKi9cclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgLy8gRmlyc3QgcmVtb3ZlIHRoZSBlbGVtZW50IGlmIHdlIGhhdmUgaXQuXHJcbiAgICAgICAgdmFyIHNldCA9IHRoaXMuZGVsZXRlKGRvYy5rZXkpO1xyXG4gICAgICAgIHJldHVybiBzZXQuY29weShzZXQua2V5ZWRNYXAuaW5zZXJ0KGRvYy5rZXksIGRvYyksIHNldC5zb3J0ZWRTZXQuaW5zZXJ0KGRvYywgbnVsbCkpO1xyXG4gICAgfTtcclxuICAgIC8qKiBEZWxldGVzIGEgZG9jdW1lbnQgd2l0aCBhIGdpdmVuIGtleSAqL1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgZG9jID0gdGhpcy5nZXQoa2V5KTtcclxuICAgICAgICBpZiAoIWRvYykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29weSh0aGlzLmtleWVkTWFwLnJlbW92ZShrZXkpLCB0aGlzLnNvcnRlZFNldC5yZW1vdmUoZG9jKSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIERvY3VtZW50U2V0KSlcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLnNpemUgIT09IG90aGVyLnNpemUpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB2YXIgdGhpc0l0ID0gdGhpcy5zb3J0ZWRTZXQuZ2V0SXRlcmF0b3IoKTtcclxuICAgICAgICB2YXIgb3RoZXJJdCA9IG90aGVyLnNvcnRlZFNldC5nZXRJdGVyYXRvcigpO1xyXG4gICAgICAgIHdoaWxlICh0aGlzSXQuaGFzTmV4dCgpKSB7XHJcbiAgICAgICAgICAgIHZhciB0aGlzRG9jID0gdGhpc0l0LmdldE5leHQoKS5rZXk7XHJcbiAgICAgICAgICAgIHZhciBvdGhlckRvYyA9IG90aGVySXQuZ2V0TmV4dCgpLmtleTtcclxuICAgICAgICAgICAgaWYgKCF0aGlzRG9jLmlzRXF1YWwob3RoZXJEb2MpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGRvY1N0cmluZ3MgPSBbXTtcclxuICAgICAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICBkb2NTdHJpbmdzLnB1c2goZG9jLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChkb2NTdHJpbmdzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ0RvY3VtZW50U2V0ICgpJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnRG9jdW1lbnRTZXQgKFxcbiAgJyArIGRvY1N0cmluZ3Muam9pbignICBcXG4nKSArICdcXG4pJztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAoa2V5ZWRNYXAsIHNvcnRlZFNldCkge1xyXG4gICAgICAgIHZhciBuZXdTZXQgPSBuZXcgRG9jdW1lbnRTZXQoKTtcclxuICAgICAgICBuZXdTZXQuY29tcGFyYXRvciA9IHRoaXMuY29tcGFyYXRvcjtcclxuICAgICAgICBuZXdTZXQua2V5ZWRNYXAgPSBrZXllZE1hcDtcclxuICAgICAgICBuZXdTZXQuc29ydGVkU2V0ID0gc29ydGVkU2V0O1xyXG4gICAgICAgIHJldHVybiBuZXdTZXQ7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERvY3VtZW50U2V0O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIENoYW5nZVR5cGU7XHJcbihmdW5jdGlvbiAoQ2hhbmdlVHlwZSkge1xyXG4gICAgQ2hhbmdlVHlwZVtDaGFuZ2VUeXBlW1wiQWRkZWRcIl0gPSAwXSA9IFwiQWRkZWRcIjtcclxuICAgIENoYW5nZVR5cGVbQ2hhbmdlVHlwZVtcIlJlbW92ZWRcIl0gPSAxXSA9IFwiUmVtb3ZlZFwiO1xyXG4gICAgQ2hhbmdlVHlwZVtDaGFuZ2VUeXBlW1wiTW9kaWZpZWRcIl0gPSAyXSA9IFwiTW9kaWZpZWRcIjtcclxuICAgIENoYW5nZVR5cGVbQ2hhbmdlVHlwZVtcIk1ldGFkYXRhXCJdID0gM10gPSBcIk1ldGFkYXRhXCI7XHJcbn0pKENoYW5nZVR5cGUgfHwgKENoYW5nZVR5cGUgPSB7fSkpO1xyXG52YXIgU3luY1N0YXRlO1xyXG4oZnVuY3Rpb24gKFN5bmNTdGF0ZSkge1xyXG4gICAgU3luY1N0YXRlW1N5bmNTdGF0ZVtcIkxvY2FsXCJdID0gMF0gPSBcIkxvY2FsXCI7XHJcbiAgICBTeW5jU3RhdGVbU3luY1N0YXRlW1wiU3luY2VkXCJdID0gMV0gPSBcIlN5bmNlZFwiO1xyXG59KShTeW5jU3RhdGUgfHwgKFN5bmNTdGF0ZSA9IHt9KSk7XHJcbi8qKlxyXG4gKiBEb2N1bWVudENoYW5nZVNldCBrZWVwcyB0cmFjayBvZiBhIHNldCBvZiBjaGFuZ2VzIHRvIGRvY3MgaW4gYSBxdWVyeSwgbWVyZ2luZ1xyXG4gKiBkdXBsaWNhdGUgZXZlbnRzIGZvciB0aGUgc2FtZSBkb2MuXHJcbiAqL1xyXG52YXIgRG9jdW1lbnRDaGFuZ2VTZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEb2N1bWVudENoYW5nZVNldCgpIHtcclxuICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbiAgICB9XHJcbiAgICBEb2N1bWVudENoYW5nZVNldC5wcm90b3R5cGUudHJhY2sgPSBmdW5jdGlvbiAoY2hhbmdlKSB7XHJcbiAgICAgICAgdmFyIGtleSA9IGNoYW5nZS5kb2Mua2V5O1xyXG4gICAgICAgIHZhciBvbGRDaGFuZ2UgPSB0aGlzLmNoYW5nZU1hcC5nZXQoa2V5KTtcclxuICAgICAgICBpZiAoIW9sZENoYW5nZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IHRoaXMuY2hhbmdlTWFwLmluc2VydChrZXksIGNoYW5nZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gTWVyZ2UgdGhlIG5ldyBjaGFuZ2Ugd2l0aCB0aGUgZXhpc3RpbmcgY2hhbmdlLlxyXG4gICAgICAgIGlmIChjaGFuZ2UudHlwZSAhPT0gQ2hhbmdlVHlwZS5BZGRlZCAmJlxyXG4gICAgICAgICAgICBvbGRDaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5NZXRhZGF0YSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IHRoaXMuY2hhbmdlTWFwLmluc2VydChrZXksIGNoYW5nZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLk1ldGFkYXRhICYmXHJcbiAgICAgICAgICAgIG9sZENoYW5nZS50eXBlICE9PSBDaGFuZ2VUeXBlLlJlbW92ZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSB0aGlzLmNoYW5nZU1hcC5pbnNlcnQoa2V5LCB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBvbGRDaGFuZ2UudHlwZSxcclxuICAgICAgICAgICAgICAgIGRvYzogY2hhbmdlLmRvY1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuTW9kaWZpZWQgJiZcclxuICAgICAgICAgICAgb2xkQ2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuTW9kaWZpZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSB0aGlzLmNoYW5nZU1hcC5pbnNlcnQoa2V5LCB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBDaGFuZ2VUeXBlLk1vZGlmaWVkLFxyXG4gICAgICAgICAgICAgICAgZG9jOiBjaGFuZ2UuZG9jXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5Nb2RpZmllZCAmJlxyXG4gICAgICAgICAgICBvbGRDaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5BZGRlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IHRoaXMuY2hhbmdlTWFwLmluc2VydChrZXksIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IENoYW5nZVR5cGUuQWRkZWQsXHJcbiAgICAgICAgICAgICAgICBkb2M6IGNoYW5nZS5kb2NcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLlJlbW92ZWQgJiZcclxuICAgICAgICAgICAgb2xkQ2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuQWRkZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSB0aGlzLmNoYW5nZU1hcC5yZW1vdmUoa2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuUmVtb3ZlZCAmJlxyXG4gICAgICAgICAgICBvbGRDaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5Nb2RpZmllZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IHRoaXMuY2hhbmdlTWFwLmluc2VydChrZXksIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IENoYW5nZVR5cGUuUmVtb3ZlZCxcclxuICAgICAgICAgICAgICAgIGRvYzogb2xkQ2hhbmdlLmRvY1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuQWRkZWQgJiZcclxuICAgICAgICAgICAgb2xkQ2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuUmVtb3ZlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IHRoaXMuY2hhbmdlTWFwLmluc2VydChrZXksIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IENoYW5nZVR5cGUuTW9kaWZpZWQsXHJcbiAgICAgICAgICAgICAgICBkb2M6IGNoYW5nZS5kb2NcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBUaGlzIGluY2x1ZGVzIHRoZXNlIGNhc2VzLCB3aGljaCBkb24ndCBtYWtlIHNlbnNlOlxyXG4gICAgICAgICAgICAvLyBBZGRlZC0+QWRkZWRcclxuICAgICAgICAgICAgLy8gUmVtb3ZlZC0+UmVtb3ZlZFxyXG4gICAgICAgICAgICAvLyBNb2RpZmllZC0+QWRkZWRcclxuICAgICAgICAgICAgLy8gUmVtb3ZlZC0+TW9kaWZpZWRcclxuICAgICAgICAgICAgLy8gTWV0YWRhdGEtPkFkZGVkXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZWQtPk1ldGFkYXRhXHJcbiAgICAgICAgICAgIGZhaWwoJ3Vuc3VwcG9ydGVkIGNvbWJpbmF0aW9uIG9mIGNoYW5nZXM6ICcgK1xyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoY2hhbmdlKSArXHJcbiAgICAgICAgICAgICAgICAnIGFmdGVyICcgK1xyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkob2xkQ2hhbmdlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIERvY3VtZW50Q2hhbmdlU2V0LnByb3RvdHlwZS5nZXRDaGFuZ2VzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gW107XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VNYXAuaW5vcmRlclRyYXZlcnNhbChmdW5jdGlvbiAoa2V5LCBjaGFuZ2UpIHtcclxuICAgICAgICAgICAgY2hhbmdlcy5wdXNoKGNoYW5nZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGNoYW5nZXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERvY3VtZW50Q2hhbmdlU2V0O1xyXG59KCkpO1xyXG52YXIgVmlld1NuYXBzaG90ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVmlld1NuYXBzaG90KHF1ZXJ5LCBkb2NzLCBvbGREb2NzLCBkb2NDaGFuZ2VzLCBtdXRhdGVkS2V5cywgZnJvbUNhY2hlLCBzeW5jU3RhdGVDaGFuZ2VkLCBleGNsdWRlc01ldGFkYXRhQ2hhbmdlcykge1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICB0aGlzLmRvY3MgPSBkb2NzO1xyXG4gICAgICAgIHRoaXMub2xkRG9jcyA9IG9sZERvY3M7XHJcbiAgICAgICAgdGhpcy5kb2NDaGFuZ2VzID0gZG9jQ2hhbmdlcztcclxuICAgICAgICB0aGlzLm11dGF0ZWRLZXlzID0gbXV0YXRlZEtleXM7XHJcbiAgICAgICAgdGhpcy5mcm9tQ2FjaGUgPSBmcm9tQ2FjaGU7XHJcbiAgICAgICAgdGhpcy5zeW5jU3RhdGVDaGFuZ2VkID0gc3luY1N0YXRlQ2hhbmdlZDtcclxuICAgICAgICB0aGlzLmV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzID0gZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM7XHJcbiAgICB9XHJcbiAgICAvKiogUmV0dXJucyBhIHZpZXcgc25hcHNob3QgYXMgaWYgYWxsIGRvY3VtZW50cyBpbiB0aGUgc25hcHNob3Qgd2VyZSBhZGRlZC4gKi9cclxuICAgIFZpZXdTbmFwc2hvdC5mcm9tSW5pdGlhbERvY3VtZW50cyA9IGZ1bmN0aW9uIChxdWVyeSwgZG9jdW1lbnRzLCBtdXRhdGVkS2V5cywgZnJvbUNhY2hlKSB7XHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSBbXTtcclxuICAgICAgICBkb2N1bWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgICAgIGNoYW5nZXMucHVzaCh7IHR5cGU6IENoYW5nZVR5cGUuQWRkZWQsIGRvYzogZG9jIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgVmlld1NuYXBzaG90KHF1ZXJ5LCBkb2N1bWVudHMsIERvY3VtZW50U2V0LmVtcHR5U2V0KGRvY3VtZW50cyksIGNoYW5nZXMsIG11dGF0ZWRLZXlzLCBmcm9tQ2FjaGUsIHRydWUsIGZhbHNlKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld1NuYXBzaG90LnByb3RvdHlwZSwgXCJoYXNQZW5kaW5nV3JpdGVzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICF0aGlzLm11dGF0ZWRLZXlzLmlzRW1wdHkoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFZpZXdTbmFwc2hvdC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICh0aGlzLmZyb21DYWNoZSAhPT0gb3RoZXIuZnJvbUNhY2hlIHx8XHJcbiAgICAgICAgICAgIHRoaXMuc3luY1N0YXRlQ2hhbmdlZCAhPT0gb3RoZXIuc3luY1N0YXRlQ2hhbmdlZCB8fFxyXG4gICAgICAgICAgICAhdGhpcy5tdXRhdGVkS2V5cy5pc0VxdWFsKG90aGVyLm11dGF0ZWRLZXlzKSB8fFxyXG4gICAgICAgICAgICAhdGhpcy5xdWVyeS5pc0VxdWFsKG90aGVyLnF1ZXJ5KSB8fFxyXG4gICAgICAgICAgICAhdGhpcy5kb2NzLmlzRXF1YWwob3RoZXIuZG9jcykgfHxcclxuICAgICAgICAgICAgIXRoaXMub2xkRG9jcy5pc0VxdWFsKG90aGVyLm9sZERvY3MpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSB0aGlzLmRvY0NoYW5nZXM7XHJcbiAgICAgICAgdmFyIG90aGVyQ2hhbmdlcyA9IG90aGVyLmRvY0NoYW5nZXM7XHJcbiAgICAgICAgaWYgKGNoYW5nZXMubGVuZ3RoICE9PSBvdGhlckNoYW5nZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFuZ2VzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2VzW2ldLnR5cGUgIT09IG90aGVyQ2hhbmdlc1tpXS50eXBlIHx8XHJcbiAgICAgICAgICAgICAgICAhY2hhbmdlc1tpXS5kb2MuaXNFcXVhbChvdGhlckNoYW5nZXNbaV0uZG9jKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBWaWV3U25hcHNob3Q7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQW4gZXZlbnQgZnJvbSB0aGUgUmVtb3RlU3RvcmUuIEl0IGlzIHNwbGl0IGludG8gdGFyZ2V0Q2hhbmdlcyAoY2hhbmdlcyB0byB0aGVcclxuICogc3RhdGUgb3IgdGhlIHNldCBvZiBkb2N1bWVudHMgaW4gb3VyIHdhdGNoZWQgdGFyZ2V0cykgYW5kIGRvY3VtZW50VXBkYXRlc1xyXG4gKiAoY2hhbmdlcyB0byB0aGUgYWN0dWFsIGRvY3VtZW50cykuXHJcbiAqL1xyXG52YXIgUmVtb3RlRXZlbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZW1vdGVFdmVudChcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHNuYXBzaG90IHZlcnNpb24gdGhpcyBldmVudCBicmluZ3MgdXMgdXAgdG8sIG9yIE1JTiBpZiBub3Qgc2V0LlxyXG4gICAgICovXHJcbiAgICBzbmFwc2hvdFZlcnNpb24sIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBIG1hcCBmcm9tIHRhcmdldCB0byBjaGFuZ2VzIHRvIHRoZSB0YXJnZXQuIFNlZSBUYXJnZXRDaGFuZ2UuXHJcbiAgICAgKi9cclxuICAgIHRhcmdldENoYW5nZXMsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBIHNldCBvZiB0YXJnZXRzIHRoYXQgaXMga25vd24gdG8gYmUgaW5jb25zaXN0ZW50LiBMaXN0ZW5zIGZvciB0aGVzZVxyXG4gICAgICogdGFyZ2V0cyBzaG91bGQgYmUgcmUtZXN0YWJsaXNoZWQgd2l0aG91dCByZXN1bWUgdG9rZW5zLlxyXG4gICAgICovXHJcbiAgICB0YXJnZXRNaXNtYXRjaGVzLCBcclxuICAgIC8qKlxyXG4gICAgICogQSBzZXQgb2Ygd2hpY2ggZG9jdW1lbnRzIGhhdmUgY2hhbmdlZCBvciBiZWVuIGRlbGV0ZWQsIGFsb25nIHdpdGggdGhlXHJcbiAgICAgKiBkb2MncyBuZXcgdmFsdWVzIChpZiBub3QgZGVsZXRlZCkuXHJcbiAgICAgKi9cclxuICAgIGRvY3VtZW50VXBkYXRlcywgXHJcbiAgICAvKipcclxuICAgICAqIEEgc2V0IG9mIHdoaWNoIGRvY3VtZW50IHVwZGF0ZXMgYXJlIGR1ZSBvbmx5IHRvIGxpbWJvIHJlc29sdXRpb24gdGFyZ2V0cy5cclxuICAgICAqL1xyXG4gICAgcmVzb2x2ZWRMaW1ib0RvY3VtZW50cykge1xyXG4gICAgICAgIHRoaXMuc25hcHNob3RWZXJzaW9uID0gc25hcHNob3RWZXJzaW9uO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0Q2hhbmdlcyA9IHRhcmdldENoYW5nZXM7XHJcbiAgICAgICAgdGhpcy50YXJnZXRNaXNtYXRjaGVzID0gdGFyZ2V0TWlzbWF0Y2hlcztcclxuICAgICAgICB0aGlzLmRvY3VtZW50VXBkYXRlcyA9IGRvY3VtZW50VXBkYXRlcztcclxuICAgICAgICB0aGlzLnJlc29sdmVkTGltYm9Eb2N1bWVudHMgPSByZXNvbHZlZExpbWJvRG9jdW1lbnRzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBIQUNLOiBWaWV3cyByZXF1aXJlIFJlbW90ZUV2ZW50cyBpbiBvcmRlciB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgdmlldyBpc1xyXG4gICAgICogQ1VSUkVOVCwgYnV0IHNlY29uZGFyeSB0YWJzIGRvbid0IHJlY2VpdmUgcmVtb3RlIGV2ZW50cy4gU28gdGhpcyBtZXRob2QgaXNcclxuICAgICAqIHVzZWQgdG8gY3JlYXRlIGEgc3ludGhlc2l6ZWQgUmVtb3RlRXZlbnQgdGhhdCBjYW4gYmUgdXNlZCB0byBhcHBseSBhXHJcbiAgICAgKiBDVVJSRU5UIHN0YXR1cyBjaGFuZ2UgdG8gYSBWaWV3LCBmb3IgcXVlcmllcyBleGVjdXRlZCBpbiBhIGRpZmZlcmVudCB0YWIuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcclxuICAgIFJlbW90ZUV2ZW50LmNyZWF0ZVN5bnRoZXNpemVkUmVtb3RlRXZlbnRGb3JDdXJyZW50Q2hhbmdlID0gZnVuY3Rpb24gKHRhcmdldElkLCBjdXJyZW50KSB7XHJcbiAgICAgICAgdmFyIHRhcmdldENoYW5nZXMgPSAoX2EgPSB7fSwgX2FbdGFyZ2V0SWRdID0gVGFyZ2V0Q2hhbmdlLmNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZSh0YXJnZXRJZCwgY3VycmVudCksIF9hKTtcclxuICAgICAgICByZXR1cm4gbmV3IFJlbW90ZUV2ZW50KFNuYXBzaG90VmVyc2lvbi5NSU4sIHRhcmdldENoYW5nZXMsIHRhcmdldElkU2V0KCksIG1heWJlRG9jdW1lbnRNYXAoKSwgZG9jdW1lbnRLZXlTZXQoKSk7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBSZW1vdGVFdmVudDtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgVGFyZ2V0Q2hhbmdlIHNwZWNpZmllcyB0aGUgc2V0IG9mIGNoYW5nZXMgZm9yIGEgc3BlY2lmaWMgdGFyZ2V0IGFzIHBhcnQgb2ZcclxuICogYSBSZW1vdGVFdmVudC4gVGhlc2UgY2hhbmdlcyB0cmFjayB3aGljaCBkb2N1bWVudHMgYXJlIGFkZGVkLCBtb2RpZmllZCBvclxyXG4gKiByZW1vdmVkLCBhcyB3ZWxsIGFzIHRoZSB0YXJnZXQncyByZXN1bWUgdG9rZW4gYW5kIHdoZXRoZXIgdGhlIHRhcmdldCBpc1xyXG4gKiBtYXJrZWQgQ1VSUkVOVC5cclxuICogVGhlIGFjdHVhbCBjaGFuZ2VzICp0byogZG9jdW1lbnRzIGFyZSBub3QgcGFydCBvZiB0aGUgVGFyZ2V0Q2hhbmdlIHNpbmNlXHJcbiAqIGRvY3VtZW50cyBtYXkgYmUgcGFydCBvZiBtdWx0aXBsZSB0YXJnZXRzLlxyXG4gKi9cclxudmFyIFRhcmdldENoYW5nZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRhcmdldENoYW5nZShcclxuICAgIC8qKlxyXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSBxdWVyeSB0byBiZSByZXN1bWVkXHJcbiAgICAgKiBhZnRlciBkaXNjb25uZWN0aW5nIHdpdGhvdXQgcmV0cmFuc21pdHRpbmcgYWxsIHRoZSBkYXRhIHRoYXQgbWF0Y2hlcyB0aGVcclxuICAgICAqIHF1ZXJ5LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpbiB0aW1lIGZyb20gd2hpY2hcclxuICAgICAqIHRoZSBzZXJ2ZXIgc2hvdWxkIHJlc3VtZSBzZW5kaW5nIHJlc3VsdHMuXHJcbiAgICAgKi9cclxuICAgIHJlc3VtZVRva2VuLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIFwiY3VycmVudFwiIChzeW5jZWQpIHN0YXR1cyBvZiB0aGlzIHRhcmdldC4gTm90ZSB0aGF0IFwiY3VycmVudFwiXHJcbiAgICAgKiBoYXMgc3BlY2lhbCBtZWFuaW5nIGluIHRoZSBSUEMgcHJvdG9jb2wgdGhhdCBpbXBsaWVzIHRoYXQgYSB0YXJnZXQgaXNcclxuICAgICAqIGJvdGggdXAtdG8tZGF0ZSBhbmQgY29uc2lzdGVudCB3aXRoIHRoZSByZXN0IG9mIHRoZSB3YXRjaCBzdHJlYW0uXHJcbiAgICAgKi9cclxuICAgIGN1cnJlbnQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IHdlcmUgbmV3bHkgYXNzaWduZWQgdG8gdGhpcyB0YXJnZXQgYXMgcGFydCBvZlxyXG4gICAgICogdGhpcyByZW1vdGUgZXZlbnQuXHJcbiAgICAgKi9cclxuICAgIGFkZGVkRG9jdW1lbnRzLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCB3ZXJlIGFscmVhZHkgYXNzaWduZWQgdG8gdGhpcyB0YXJnZXQgYnV0IHJlY2VpdmVkXHJcbiAgICAgKiBhbiB1cGRhdGUgZHVyaW5nIHRoaXMgcmVtb3RlIGV2ZW50LlxyXG4gICAgICovXHJcbiAgICBtb2RpZmllZERvY3VtZW50cywgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgd2VyZSByZW1vdmVkIGZyb20gdGhpcyB0YXJnZXQgYXMgcGFydCBvZiB0aGlzXHJcbiAgICAgKiByZW1vdGUgZXZlbnQuXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZWREb2N1bWVudHMpIHtcclxuICAgICAgICB0aGlzLnJlc3VtZVRva2VuID0gcmVzdW1lVG9rZW47XHJcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gY3VycmVudDtcclxuICAgICAgICB0aGlzLmFkZGVkRG9jdW1lbnRzID0gYWRkZWREb2N1bWVudHM7XHJcbiAgICAgICAgdGhpcy5tb2RpZmllZERvY3VtZW50cyA9IG1vZGlmaWVkRG9jdW1lbnRzO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlZERvY3VtZW50cyA9IHJlbW92ZWREb2N1bWVudHM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEhBQ0s6IFZpZXdzIHJlcXVpcmUgVGFyZ2V0Q2hhbmdlcyBpbiBvcmRlciB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgdmlldyBpc1xyXG4gICAgICogQ1VSUkVOVCwgYnV0IHNlY29uZGFyeSB0YWJzIGRvbid0IHJlY2VpdmUgcmVtb3RlIGV2ZW50cy4gU28gdGhpcyBtZXRob2QgaXNcclxuICAgICAqIHVzZWQgdG8gY3JlYXRlIGEgc3ludGhlc2l6ZWQgVGFyZ2V0Q2hhbmdlcyB0aGF0IGNhbiBiZSB1c2VkIHRvIGFwcGx5IGFcclxuICAgICAqIENVUlJFTlQgc3RhdHVzIGNoYW5nZSB0byBhIFZpZXcsIGZvciBxdWVyaWVzIGV4ZWN1dGVkIGluIGEgZGlmZmVyZW50IHRhYi5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxyXG4gICAgVGFyZ2V0Q2hhbmdlLmNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZSA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgY3VycmVudCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgVGFyZ2V0Q2hhbmdlKGVtcHR5Qnl0ZVN0cmluZygpLCBjdXJyZW50LCBkb2N1bWVudEtleVNldCgpLCBkb2N1bWVudEtleVNldCgpLCBkb2N1bWVudEtleVNldCgpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVGFyZ2V0Q2hhbmdlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBjaGFuZ2VkIGRvY3VtZW50IGFuZCBhIGxpc3Qgb2YgdGFyZ2V0IGlkcyB0byB3aGljaCB0aGlzIGNoYW5nZVxyXG4gKiBhcHBsaWVzLlxyXG4gKlxyXG4gKiBJZiBkb2N1bWVudCBoYXMgYmVlbiBkZWxldGVkIE5vRG9jdW1lbnQgd2lsbCBiZSBwcm92aWRlZC5cclxuICovXHJcbnZhciBEb2N1bWVudFdhdGNoQ2hhbmdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnRXYXRjaENoYW5nZShcclxuICAgIC8qKiBUaGUgbmV3IGRvY3VtZW50IGFwcGxpZXMgdG8gYWxsIG9mIHRoZXNlIHRhcmdldHMuICovXHJcbiAgICB1cGRhdGVkVGFyZ2V0SWRzLCBcclxuICAgIC8qKiBUaGUgbmV3IGRvY3VtZW50IGlzIHJlbW92ZWQgZnJvbSBhbGwgb2YgdGhlc2UgdGFyZ2V0cy4gKi9cclxuICAgIHJlbW92ZWRUYXJnZXRJZHMsIFxyXG4gICAgLyoqIFRoZSBrZXkgb2YgdGhlIGRvY3VtZW50IGZvciB0aGlzIGNoYW5nZS4gKi9cclxuICAgIGtleSwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBuZXcgZG9jdW1lbnQgb3IgTm9Eb2N1bWVudCBpZiBpdCB3YXMgZGVsZXRlZC4gSXMgbnVsbCBpZiB0aGVcclxuICAgICAqIGRvY3VtZW50IHdlbnQgb3V0IG9mIHZpZXcgd2l0aG91dCB0aGUgc2VydmVyIHNlbmRpbmcgYSBuZXcgZG9jdW1lbnQuXHJcbiAgICAgKi9cclxuICAgIG5ld0RvYykge1xyXG4gICAgICAgIHRoaXMudXBkYXRlZFRhcmdldElkcyA9IHVwZGF0ZWRUYXJnZXRJZHM7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVkVGFyZ2V0SWRzID0gcmVtb3ZlZFRhcmdldElkcztcclxuICAgICAgICB0aGlzLmtleSA9IGtleTtcclxuICAgICAgICB0aGlzLm5ld0RvYyA9IG5ld0RvYztcclxuICAgIH1cclxuICAgIHJldHVybiBEb2N1bWVudFdhdGNoQ2hhbmdlO1xyXG59KCkpO1xyXG52YXIgRXhpc3RlbmNlRmlsdGVyQ2hhbmdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRXhpc3RlbmNlRmlsdGVyQ2hhbmdlKHRhcmdldElkLCBleGlzdGVuY2VGaWx0ZXIpIHtcclxuICAgICAgICB0aGlzLnRhcmdldElkID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgdGhpcy5leGlzdGVuY2VGaWx0ZXIgPSBleGlzdGVuY2VGaWx0ZXI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRXhpc3RlbmNlRmlsdGVyQ2hhbmdlO1xyXG59KCkpO1xyXG52YXIgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZTtcclxuKGZ1bmN0aW9uIChXYXRjaFRhcmdldENoYW5nZVN0YXRlKSB7XHJcbiAgICBXYXRjaFRhcmdldENoYW5nZVN0YXRlW1dhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbXCJOb0NoYW5nZVwiXSA9IDBdID0gXCJOb0NoYW5nZVwiO1xyXG4gICAgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtXYXRjaFRhcmdldENoYW5nZVN0YXRlW1wiQWRkZWRcIl0gPSAxXSA9IFwiQWRkZWRcIjtcclxuICAgIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtcIlJlbW92ZWRcIl0gPSAyXSA9IFwiUmVtb3ZlZFwiO1xyXG4gICAgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtXYXRjaFRhcmdldENoYW5nZVN0YXRlW1wiQ3VycmVudFwiXSA9IDNdID0gXCJDdXJyZW50XCI7XHJcbiAgICBXYXRjaFRhcmdldENoYW5nZVN0YXRlW1dhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbXCJSZXNldFwiXSA9IDRdID0gXCJSZXNldFwiO1xyXG59KShXYXRjaFRhcmdldENoYW5nZVN0YXRlIHx8IChXYXRjaFRhcmdldENoYW5nZVN0YXRlID0ge30pKTtcclxudmFyIFdhdGNoVGFyZ2V0Q2hhbmdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gV2F0Y2hUYXJnZXRDaGFuZ2UoXHJcbiAgICAvKiogV2hhdCBraW5kIG9mIGNoYW5nZSBvY2N1cnJlZCB0byB0aGUgd2F0Y2ggdGFyZ2V0LiAqL1xyXG4gICAgc3RhdGUsIFxyXG4gICAgLyoqIFRoZSB0YXJnZXQgSURzIHRoYXQgd2VyZSBhZGRlZC9yZW1vdmVkL3NldC4gKi9cclxuICAgIHRhcmdldElkcywgXHJcbiAgICAvKipcclxuICAgICAqIEFuIG9wYXF1ZSwgc2VydmVyLWFzc2lnbmVkIHRva2VuIHRoYXQgYWxsb3dzIHdhdGNoaW5nIGEgcXVlcnkgdG8gYmVcclxuICAgICAqIHJlc3VtZWQgYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YSB0aGF0XHJcbiAgICAgKiBtYXRjaGVzIHRoZSBxdWVyeS4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW5cclxuICAgICAqIHRpbWUgZnJvbSB3aGljaCB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxyXG4gICAgICovXHJcbiAgICByZXN1bWVUb2tlbiwgXHJcbiAgICAvKiogQW4gUlBDIGVycm9yIGluZGljYXRpbmcgd2h5IHRoZSB3YXRjaCBmYWlsZWQuICovXHJcbiAgICBjYXVzZSkge1xyXG4gICAgICAgIGlmIChyZXN1bWVUb2tlbiA9PT0gdm9pZCAwKSB7IHJlc3VtZVRva2VuID0gZW1wdHlCeXRlU3RyaW5nKCk7IH1cclxuICAgICAgICBpZiAoY2F1c2UgPT09IHZvaWQgMCkgeyBjYXVzZSA9IG51bGw7IH1cclxuICAgICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XHJcbiAgICAgICAgdGhpcy50YXJnZXRJZHMgPSB0YXJnZXRJZHM7XHJcbiAgICAgICAgdGhpcy5yZXN1bWVUb2tlbiA9IHJlc3VtZVRva2VuO1xyXG4gICAgICAgIHRoaXMuY2F1c2UgPSBjYXVzZTtcclxuICAgIH1cclxuICAgIHJldHVybiBXYXRjaFRhcmdldENoYW5nZTtcclxufSgpKTtcclxuLyoqIFRyYWNrcyB0aGUgaW50ZXJuYWwgc3RhdGUgb2YgYSBXYXRjaCB0YXJnZXQuICovXHJcbnZhciBUYXJnZXRTdGF0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRhcmdldFN0YXRlKCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgKGFkZHMgb3IgcmVtb3ZlcykgdGhhdCB3ZSBhcmUgd2FpdGluZyBvbi5cclxuICAgICAgICAgKiBXZSBvbmx5IGNvbnNpZGVyIHRhcmdldHMgYWN0aXZlIHRoYXQgaGF2ZSBubyBwZW5kaW5nIHJlc3BvbnNlcy5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnBlbmRpbmdSZXNwb25zZXMgPSAwO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEtlZXBzIHRyYWNrIG9mIHRoZSBkb2N1bWVudCBjaGFuZ2VzIHNpbmNlIHRoZSBsYXN0IHJhaXNlZCBzbmFwc2hvdC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIFRoZXNlIGNoYW5nZXMgYXJlIGNvbnRpbnVvdXNseSB1cGRhdGVkIGFzIHdlIHJlY2VpdmUgZG9jdW1lbnQgdXBkYXRlcyBhbmRcclxuICAgICAgICAgKiBhbHdheXMgcmVmbGVjdCB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcyBhZ2FpbnN0IHRoZSBsYXN0IGlzc3VlZCBzbmFwc2hvdC5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmRvY3VtZW50Q2hhbmdlcyA9IHNuYXBzaG90Q2hhbmdlc01hcCgpO1xyXG4gICAgICAgIC8qKiBTZWUgcHVibGljIGdldHRlcnMgZm9yIGV4cGxhbmF0aW9ucyBvZiB0aGVzZSBmaWVsZHMuICovXHJcbiAgICAgICAgdGhpcy5fcmVzdW1lVG9rZW4gPSBlbXB0eUJ5dGVTdHJpbmcoKTtcclxuICAgICAgICB0aGlzLl9jdXJyZW50ID0gZmFsc2U7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogV2hldGhlciB0aGlzIHRhcmdldCBzdGF0ZSBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhlIG5leHQgc25hcHNob3QuIFdlXHJcbiAgICAgICAgICogaW5pdGlhbGl6ZSB0byB0cnVlIHNvIHRoYXQgbmV3bHktYWRkZWQgdGFyZ2V0cyBhcmUgaW5jbHVkZWQgaW4gdGhlIG5leHRcclxuICAgICAgICAgKiBSZW1vdGVFdmVudC5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9oYXNQZW5kaW5nQ2hhbmdlcyA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFyZ2V0U3RhdGUucHJvdG90eXBlLCBcImN1cnJlbnRcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFdoZXRoZXIgdGhpcyB0YXJnZXQgaGFzIGJlZW4gbWFya2VkICdjdXJyZW50Jy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICdDdXJyZW50JyBoYXMgc3BlY2lhbCBtZWFuaW5nIGluIHRoZSBSUEMgcHJvdG9jb2w6IEl0IGltcGxpZXMgdGhhdCB0aGVcclxuICAgICAgICAgKiBXYXRjaCBiYWNrZW5kIGhhcyBzZW50IHVzIGFsbCBjaGFuZ2VzIHVwIHRvIHRoZSBwb2ludCBhdCB3aGljaCB0aGUgdGFyZ2V0XHJcbiAgICAgICAgICogd2FzIGFkZGVkIGFuZCB0aGF0IHRoZSB0YXJnZXQgaXMgY29uc2lzdGVudCB3aXRoIHRoZSByZXN0IG9mIHRoZSB3YXRjaFxyXG4gICAgICAgICAqIHN0cmVhbS5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFyZ2V0U3RhdGUucHJvdG90eXBlLCBcInJlc3VtZVRva2VuXCIsIHtcclxuICAgICAgICAvKiogVGhlIGxhc3QgcmVzdW1lIHRva2VuIHNlbnQgdG8gdXMgZm9yIHRoaXMgdGFyZ2V0LiAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVzdW1lVG9rZW47XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFyZ2V0U3RhdGUucHJvdG90eXBlLCBcImlzUGVuZGluZ1wiLCB7XHJcbiAgICAgICAgLyoqIFdoZXRoZXIgdGhpcyB0YXJnZXQgaGFzIHBlbmRpbmcgdGFyZ2V0IGFkZHMgb3IgdGFyZ2V0IHJlbW92ZXMuICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBlbmRpbmdSZXNwb25zZXMgIT09IDA7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFyZ2V0U3RhdGUucHJvdG90eXBlLCBcImhhc1BlbmRpbmdDaGFuZ2VzXCIsIHtcclxuICAgICAgICAvKiogV2hldGhlciB3ZSBoYXZlIG1vZGlmaWVkIGFueSBzdGF0ZSB0aGF0IHNob3VsZCB0cmlnZ2VyIGEgc25hcHNob3QuICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9oYXNQZW5kaW5nQ2hhbmdlcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQXBwbGllcyB0aGUgcmVzdW1lIHRva2VuIHRvIHRoZSBUYXJnZXRDaGFuZ2UsIGJ1dCBvbmx5IHdoZW4gaXQgaGFzIGEgbmV3XHJcbiAgICAgKiB2YWx1ZS4gRW1wdHkgcmVzdW1lVG9rZW5zIGFyZSBkaXNjYXJkZWQuXHJcbiAgICAgKi9cclxuICAgIFRhcmdldFN0YXRlLnByb3RvdHlwZS51cGRhdGVSZXN1bWVUb2tlbiA9IGZ1bmN0aW9uIChyZXN1bWVUb2tlbikge1xyXG4gICAgICAgIGlmIChyZXN1bWVUb2tlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhc1BlbmRpbmdDaGFuZ2VzID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fcmVzdW1lVG9rZW4gPSByZXN1bWVUb2tlbjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgdGFyZ2V0IGNoYW5nZSBmcm9tIHRoZSBjdXJyZW50IHNldCBvZiBjaGFuZ2VzLlxyXG4gICAgICpcclxuICAgICAqIFRvIHJlc2V0IHRoZSBkb2N1bWVudCBjaGFuZ2VzIGFmdGVyIHJhaXNpbmcgdGhpcyBzbmFwc2hvdCwgY2FsbFxyXG4gICAgICogYGNsZWFyUGVuZGluZ0NoYW5nZXMoKWAuXHJcbiAgICAgKi9cclxuICAgIFRhcmdldFN0YXRlLnByb3RvdHlwZS50b1RhcmdldENoYW5nZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYWRkZWREb2N1bWVudHMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHZhciBtb2RpZmllZERvY3VtZW50cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdmFyIHJlbW92ZWREb2N1bWVudHMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRDaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGtleSwgY2hhbmdlVHlwZSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGNoYW5nZVR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5BZGRlZDpcclxuICAgICAgICAgICAgICAgICAgICBhZGRlZERvY3VtZW50cyA9IGFkZGVkRG9jdW1lbnRzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLk1vZGlmaWVkOlxyXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkRG9jdW1lbnRzID0gbW9kaWZpZWREb2N1bWVudHMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuUmVtb3ZlZDpcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVkRG9jdW1lbnRzID0gcmVtb3ZlZERvY3VtZW50cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgZmFpbCgnRW5jb3VudGVyZWQgaW52YWxpZCBjaGFuZ2UgdHlwZTogJyArIGNoYW5nZVR5cGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBUYXJnZXRDaGFuZ2UodGhpcy5fcmVzdW1lVG9rZW4sIHRoaXMuX2N1cnJlbnQsIGFkZGVkRG9jdW1lbnRzLCBtb2RpZmllZERvY3VtZW50cywgcmVtb3ZlZERvY3VtZW50cyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIGRvY3VtZW50IGNoYW5nZXMgYW5kIHNldHMgYGhhc1BlbmRpbmdDaGFuZ2VzYCB0byBmYWxzZS5cclxuICAgICAqL1xyXG4gICAgVGFyZ2V0U3RhdGUucHJvdG90eXBlLmNsZWFyUGVuZGluZ0NoYW5nZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5faGFzUGVuZGluZ0NoYW5nZXMgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmRvY3VtZW50Q2hhbmdlcyA9IHNuYXBzaG90Q2hhbmdlc01hcCgpO1xyXG4gICAgfTtcclxuICAgIFRhcmdldFN0YXRlLnByb3RvdHlwZS5hZGREb2N1bWVudENoYW5nZSA9IGZ1bmN0aW9uIChrZXksIGNoYW5nZVR5cGUpIHtcclxuICAgICAgICB0aGlzLl9oYXNQZW5kaW5nQ2hhbmdlcyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudENoYW5nZXMgPSB0aGlzLmRvY3VtZW50Q2hhbmdlcy5pbnNlcnQoa2V5LCBjaGFuZ2VUeXBlKTtcclxuICAgIH07XHJcbiAgICBUYXJnZXRTdGF0ZS5wcm90b3R5cGUucmVtb3ZlRG9jdW1lbnRDaGFuZ2UgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdGhpcy5faGFzUGVuZGluZ0NoYW5nZXMgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRDaGFuZ2VzID0gdGhpcy5kb2N1bWVudENoYW5nZXMucmVtb3ZlKGtleSk7XHJcbiAgICB9O1xyXG4gICAgVGFyZ2V0U3RhdGUucHJvdG90eXBlLnJlY29yZFBlbmRpbmdUYXJnZXRSZXF1ZXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMucGVuZGluZ1Jlc3BvbnNlcyArPSAxO1xyXG4gICAgfTtcclxuICAgIFRhcmdldFN0YXRlLnByb3RvdHlwZS5yZWNvcmRUYXJnZXRSZXNwb25zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnBlbmRpbmdSZXNwb25zZXMgLT0gMTtcclxuICAgIH07XHJcbiAgICBUYXJnZXRTdGF0ZS5wcm90b3R5cGUubWFya0N1cnJlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5faGFzUGVuZGluZ0NoYW5nZXMgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2N1cnJlbnQgPSB0cnVlO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUYXJnZXRTdGF0ZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgaGVscGVyIGNsYXNzIHRvIGFjY3VtdWxhdGUgd2F0Y2ggY2hhbmdlcyBpbnRvIGEgUmVtb3RlRXZlbnQuXHJcbiAqL1xyXG52YXIgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yKG1ldGFkYXRhUHJvdmlkZXIpIHtcclxuICAgICAgICB0aGlzLm1ldGFkYXRhUHJvdmlkZXIgPSBtZXRhZGF0YVByb3ZpZGVyO1xyXG4gICAgICAgIC8qKiBUaGUgaW50ZXJuYWwgc3RhdGUgb2YgYWxsIHRyYWNrZWQgdGFyZ2V0cy4gKi9cclxuICAgICAgICB0aGlzLnRhcmdldFN0YXRlcyA9IHt9O1xyXG4gICAgICAgIC8qKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnRzIHRvIHVwZGF0ZSBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuICovXHJcbiAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRVcGRhdGVzID0gbWF5YmVEb2N1bWVudE1hcCgpO1xyXG4gICAgICAgIC8qKiBBIG1hcHBpbmcgb2YgZG9jdW1lbnQga2V5cyB0byB0aGVpciBzZXQgb2YgdGFyZ2V0IElEcy4gKi9cclxuICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcgPSBkb2N1bWVudFRhcmdldE1hcCgpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgbGlzdCBvZiB0YXJnZXRzIHdpdGggZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLiBUaGVzZSB0YXJnZXRzIGFyZVxyXG4gICAgICAgICAqIGtub3duIHRvIGJlIGluY29uc2lzdGVudCBhbmQgdGhlaXIgbGlzdGVucyBuZWVkcyB0byBiZSByZS1lc3RhYmxpc2hlZCBieVxyXG4gICAgICAgICAqIFJlbW90ZVN0b3JlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucGVuZGluZ1RhcmdldFJlc2V0cyA9IG5ldyBTb3J0ZWRTZXQocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgRG9jdW1lbnRXYXRjaENoYW5nZSB0byB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5oYW5kbGVEb2N1bWVudENoYW5nZSA9IGZ1bmN0aW9uIChkb2NDaGFuZ2UpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gZG9jQ2hhbmdlLnVwZGF0ZWRUYXJnZXRJZHM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKGRvY0NoYW5nZS5uZXdEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGREb2N1bWVudFRvVGFyZ2V0KHRhcmdldElkLCBkb2NDaGFuZ2UubmV3RG9jKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChkb2NDaGFuZ2UubmV3RG9jIGluc3RhbmNlb2YgTm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVEb2N1bWVudEZyb21UYXJnZXQodGFyZ2V0SWQsIGRvY0NoYW5nZS5rZXksIGRvY0NoYW5nZS5uZXdEb2MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIF9iID0gMCwgX2MgPSBkb2NDaGFuZ2UucmVtb3ZlZFRhcmdldElkczsgX2IgPCBfYy5sZW5ndGg7IF9iKyspIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldElkID0gX2NbX2JdO1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZURvY3VtZW50RnJvbVRhcmdldCh0YXJnZXRJZCwgZG9jQ2hhbmdlLmtleSwgZG9jQ2hhbmdlLm5ld0RvYyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiBQcm9jZXNzZXMgYW5kIGFkZHMgdGhlIFdhdGNoVGFyZ2V0Q2hhbmdlIHRvIHRoZSBjdXJyZW50IHNldCBvZiBjaGFuZ2VzLiAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5oYW5kbGVUYXJnZXRDaGFuZ2UgPSBmdW5jdGlvbiAodGFyZ2V0Q2hhbmdlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmZvckVhY2hUYXJnZXQodGFyZ2V0Q2hhbmdlLCBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldFN0YXRlID0gX3RoaXMuZW5zdXJlVGFyZ2V0U3RhdGUodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHRhcmdldENoYW5nZS5zdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLk5vQ2hhbmdlOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc0FjdGl2ZVRhcmdldCh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGUudXBkYXRlUmVzdW1lVG9rZW4odGFyZ2V0Q2hhbmdlLnJlc3VtZVRva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQWRkZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBkZWNyZW1lbnQgdGhlIG51bWJlciBvZiBwZW5kaW5nIGFja3MgbmVlZGVkIGZyb20gd2F0Y2hcclxuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgdGhpcyB0YXJnZXRJZC5cclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZS5yZWNvcmRUYXJnZXRSZXNwb25zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0U3RhdGUuaXNQZW5kaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgYSBmcmVzaGx5IGFkZGVkIHRhcmdldCwgc28gd2UgbmVlZCB0byByZXNldCBhbnkgc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhhdCB3ZSBoYWQgcHJldmlvdXNseS4gVGhpcyBjYW4gaGFwcGVuIGUuZy4gd2hlbiByZW1vdmUgYW5kIGFkZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBiYWNrIGEgdGFyZ2V0IGZvciBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoZXMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlLmNsZWFyUGVuZGluZ0NoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGUudXBkYXRlUmVzdW1lVG9rZW4odGFyZ2V0Q2hhbmdlLnJlc3VtZVRva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5SZW1vdmVkOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8ga2VlcCB0cmFjayBvZiByZW1vdmVkIHRhcmdldHMgdG8gd2UgY2FuIHBvc3QtZmlsdGVyIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbnkgdGFyZ2V0IGNoYW5nZXMuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBkZWNyZW1lbnQgdGhlIG51bWJlciBvZiBwZW5kaW5nIGFja3MgbmVlZGVkIGZyb20gd2F0Y2hcclxuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgdGhpcyB0YXJnZXRJZC5cclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZS5yZWNvcmRUYXJnZXRSZXNwb25zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0U3RhdGUuaXNQZW5kaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbW92ZVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydCghdGFyZ2V0Q2hhbmdlLmNhdXNlLCAnV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yIGRvZXMgbm90IGhhbmRsZSBlcnJvcmVkIHRhcmdldHMnKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5DdXJyZW50OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc0FjdGl2ZVRhcmdldCh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGUubWFya0N1cnJlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGUudXBkYXRlUmVzdW1lVG9rZW4odGFyZ2V0Q2hhbmdlLnJlc3VtZVRva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVzZXQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzQWN0aXZlVGFyZ2V0KHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB0aGUgdGFyZ2V0IGFuZCBzeW50aGVzaXplcyByZW1vdmVzIGZvciBhbGwgZXhpc3RpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG9jdW1lbnRzLiBUaGUgYmFja2VuZCB3aWxsIHJlLWFkZCBhbnkgZG9jdW1lbnRzIHRoYXQgc3RpbGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWF0Y2ggdGhlIHRhcmdldCBiZWZvcmUgaXQgc2VuZHMgdGhlIG5leHQgZ2xvYmFsIHNuYXBzaG90LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZXNldFRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlLnVwZGF0ZVJlc3VtZVRva2VuKHRhcmdldENoYW5nZS5yZXN1bWVUb2tlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBmYWlsKCdVbmtub3duIHRhcmdldCB3YXRjaCBjaGFuZ2Ugc3RhdGU6ICcgKyB0YXJnZXRDaGFuZ2Uuc3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGFsbCB0YXJnZXRJZHMgdGhhdCB0aGUgd2F0Y2ggY2hhbmdlIGFwcGxpZXMgdG86IGVpdGhlciB0aGVcclxuICAgICAqIHRhcmdldElkcyBleHBsaWNpdGx5IGxpc3RlZCBpbiB0aGUgY2hhbmdlIG9yIHRoZSB0YXJnZXRJZHMgb2YgYWxsIGN1cnJlbnRseVxyXG4gICAgICogYWN0aXZlIHRhcmdldHMuXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuZm9yRWFjaFRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRDaGFuZ2UsIGZuKSB7XHJcbiAgICAgICAgaWYgKHRhcmdldENoYW5nZS50YXJnZXRJZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0YXJnZXRDaGFuZ2UudGFyZ2V0SWRzLmZvckVhY2goZm4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yRWFjaE51bWJlcih0aGlzLnRhcmdldFN0YXRlcywgZm4pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEhhbmRsZXMgZXhpc3RlbmNlIGZpbHRlcnMgYW5kIHN5bnRoZXNpemVzIGRlbGV0ZXMgZm9yIGZpbHRlciBtaXNtYXRjaGVzLlxyXG4gICAgICogVGFyZ2V0cyB0aGF0IGFyZSBpbnZhbGlkYXRlZCBieSBmaWx0ZXIgbWlzbWF0Y2hlcyBhcmUgYWRkZWQgdG9cclxuICAgICAqIGBwZW5kaW5nVGFyZ2V0UmVzZXRzYC5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5oYW5kbGVFeGlzdGVuY2VGaWx0ZXIgPSBmdW5jdGlvbiAod2F0Y2hDaGFuZ2UpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0SWQgPSB3YXRjaENoYW5nZS50YXJnZXRJZDtcclxuICAgICAgICB2YXIgZXhwZWN0ZWRDb3VudCA9IHdhdGNoQ2hhbmdlLmV4aXN0ZW5jZUZpbHRlci5jb3VudDtcclxuICAgICAgICB2YXIgcXVlcnlEYXRhID0gdGhpcy5xdWVyeURhdGFGb3JBY3RpdmVUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgIGlmIChxdWVyeURhdGEpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gcXVlcnlEYXRhLnF1ZXJ5O1xyXG4gICAgICAgICAgICBpZiAocXVlcnkuaXNEb2N1bWVudFF1ZXJ5KCkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChleHBlY3RlZENvdW50ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGV4aXN0ZW5jZSBmaWx0ZXIgdG9sZCB1cyB0aGUgZG9jdW1lbnQgZG9lcyBub3QgZXhpc3QuIFdlIGRlZHVjZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoYXQgdGhpcyBkb2N1bWVudCBkb2VzIG5vdCBleGlzdCBhbmQgYXBwbHkgYSBkZWxldGVkIGRvY3VtZW50IHRvXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb3VyIHVwZGF0ZXMuIFdpdGhvdXQgYXBwbHlpbmcgdGhpcyBkZWxldGVkIGRvY3VtZW50IHRoZXJlIG1pZ2h0IGJlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYW5vdGhlciBxdWVyeSB0aGF0IHdpbGwgcmFpc2UgdGhpcyBkb2N1bWVudCBhcyBwYXJ0IG9mIGEgc25hcHNob3RcclxuICAgICAgICAgICAgICAgICAgICAvLyB1bnRpbCBpdCBpcyByZXNvbHZlZCwgZXNzZW50aWFsbHkgZXhwb3NpbmcgaW5jb25zaXN0ZW5jeSBiZXR3ZWVuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcXVlcmllcy5cclxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gbmV3IERvY3VtZW50S2V5KHF1ZXJ5LnBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRG9jdW1lbnRGcm9tVGFyZ2V0KHRhcmdldElkLCBrZXksIG5ldyBOb0RvY3VtZW50KGtleSwgU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KGV4cGVjdGVkQ291bnQgPT09IDEsICdTaW5nbGUgZG9jdW1lbnQgZXhpc3RlbmNlIGZpbHRlciB3aXRoIGNvdW50OiAnICsgZXhwZWN0ZWRDb3VudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFNpemUgPSB0aGlzLmdldEN1cnJlbnREb2N1bWVudENvdW50Rm9yVGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U2l6ZSAhPT0gZXhwZWN0ZWRDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2g6IFdlIHJlc2V0IHRoZSBtYXBwaW5nIGFuZCByYWlzZSBhIG5ld1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNuYXBzaG90IHdpdGggYGlzRnJvbUNhY2hlOnRydWVgLlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGVuZGluZ1RhcmdldFJlc2V0cyA9IHRoaXMucGVuZGluZ1RhcmdldFJlc2V0cy5hZGQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgdGhlIGN1cnJlbnRseSBhY2N1bXVsYXRlZCBzdGF0ZSBpbnRvIGEgcmVtb3RlIGV2ZW50IGF0IHRoZVxyXG4gICAgICogcHJvdmlkZWQgc25hcHNob3QgdmVyc2lvbi4gUmVzZXRzIHRoZSBhY2N1bXVsYXRlZCBjaGFuZ2VzIGJlZm9yZSByZXR1cm5pbmcuXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuY3JlYXRlUmVtb3RlRXZlbnQgPSBmdW5jdGlvbiAoc25hcHNob3RWZXJzaW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgdGFyZ2V0Q2hhbmdlcyA9IHt9O1xyXG4gICAgICAgIGZvckVhY2hOdW1iZXIodGhpcy50YXJnZXRTdGF0ZXMsIGZ1bmN0aW9uICh0YXJnZXRJZCwgdGFyZ2V0U3RhdGUpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5RGF0YSA9IF90aGlzLnF1ZXJ5RGF0YUZvckFjdGl2ZVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgIGlmIChxdWVyeURhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXRTdGF0ZS5jdXJyZW50ICYmIHF1ZXJ5RGF0YS5xdWVyeS5pc0RvY3VtZW50UXVlcnkoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIERvY3VtZW50IHF1ZXJpZXMgZm9yIGRvY3VtZW50IHRoYXQgZG9uJ3QgZXhpc3QgY2FuIHByb2R1Y2UgYW4gZW1wdHlcclxuICAgICAgICAgICAgICAgICAgICAvLyByZXN1bHQgc2V0LiBUbyB1cGRhdGUgb3VyIGxvY2FsIGNhY2hlLCB3ZSBzeW50aGVzaXplIGEgZG9jdW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAvLyBkZWxldGUgaWYgd2UgaGF2ZSBub3QgcHJldmlvdXNseSByZWNlaXZlZCB0aGUgZG9jdW1lbnQuIFRoaXNcclxuICAgICAgICAgICAgICAgICAgICAvLyByZXNvbHZlcyB0aGUgbGltYm8gc3RhdGUgb2YgdGhlIGRvY3VtZW50LCByZW1vdmluZyBpdCBmcm9tXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbGltYm9Eb2N1bWVudFJlZnMuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IElkZWFsbHkgd2Ugd291bGQgaGF2ZSBhbiBleHBsaWNpdCBsb29rdXAgcXVlcnlcclxuICAgICAgICAgICAgICAgICAgICAvLyBpbnN0ZWFkIHJlc3VsdGluZyBpbiBhbiBleHBsaWNpdCBkZWxldGUgbWVzc2FnZSBhbmQgd2UgY291bGRcclxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhpcyBzcGVjaWFsIGxvZ2ljLlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBuZXcgRG9jdW1lbnRLZXkocXVlcnlEYXRhLnF1ZXJ5LnBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5wZW5kaW5nRG9jdW1lbnRVcGRhdGVzLmdldChrZXkpID09PSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICFfdGhpcy50YXJnZXRDb250YWluc0RvY3VtZW50KHRhcmdldElkLCBrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbW92ZURvY3VtZW50RnJvbVRhcmdldCh0YXJnZXRJZCwga2V5LCBuZXcgTm9Eb2N1bWVudChrZXksIHNuYXBzaG90VmVyc2lvbikpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXRTdGF0ZS5oYXNQZW5kaW5nQ2hhbmdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldENoYW5nZXNbdGFyZ2V0SWRdID0gdGFyZ2V0U3RhdGUudG9UYXJnZXRDaGFuZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZS5jbGVhclBlbmRpbmdDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgcmVzb2x2ZWRMaW1ib0RvY3VtZW50cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgLy8gV2UgZXh0cmFjdCB0aGUgc2V0IG9mIGxpbWJvLW9ubHkgZG9jdW1lbnQgdXBkYXRlcyBhcyB0aGUgR0MgbG9naWNcclxuICAgICAgICAvLyBzcGVjaWFsLWNhc2VzIGRvY3VtZW50cyB0aGF0IGRvIG5vdCBhcHBlYXIgaW4gdGhlIHF1ZXJ5IGNhY2hlLlxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gVE9ETyhnc29sdGlzKTogRXhwYW5kIG9uIHRoaXMgY29tbWVudCBvbmNlIEdDIGlzIGF2YWlsYWJsZSBpbiB0aGUgSlNcclxuICAgICAgICAvLyBjbGllbnQuXHJcbiAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nLmZvckVhY2goZnVuY3Rpb24gKGtleSwgdGFyZ2V0cykge1xyXG4gICAgICAgICAgICB2YXIgaXNPbmx5TGltYm9UYXJnZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0YXJnZXRzLmZvckVhY2hXaGlsZShmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBxdWVyeURhdGEgPSBfdGhpcy5xdWVyeURhdGFGb3JBY3RpdmVUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXJ5RGF0YSAmJiBxdWVyeURhdGEucHVycG9zZSAhPT0gUXVlcnlQdXJwb3NlLkxpbWJvUmVzb2x1dGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzT25seUxpbWJvVGFyZ2V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoaXNPbmx5TGltYm9UYXJnZXQpIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmVkTGltYm9Eb2N1bWVudHMgPSByZXNvbHZlZExpbWJvRG9jdW1lbnRzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHJlbW90ZUV2ZW50ID0gbmV3IFJlbW90ZUV2ZW50KHNuYXBzaG90VmVyc2lvbiwgdGFyZ2V0Q2hhbmdlcywgdGhpcy5wZW5kaW5nVGFyZ2V0UmVzZXRzLCB0aGlzLnBlbmRpbmdEb2N1bWVudFVwZGF0ZXMsIHJlc29sdmVkTGltYm9Eb2N1bWVudHMpO1xyXG4gICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VXBkYXRlcyA9IG1heWJlRG9jdW1lbnRNYXAoKTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcgPSBkb2N1bWVudFRhcmdldE1hcCgpO1xyXG4gICAgICAgIHRoaXMucGVuZGluZ1RhcmdldFJlc2V0cyA9IG5ldyBTb3J0ZWRTZXQocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbiAgICAgICAgcmV0dXJuIHJlbW90ZUV2ZW50O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWRkcyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgdG8gdGhlIGludGVybmFsIGxpc3Qgb2YgZG9jdW1lbnQgdXBkYXRlcyBhbmRcclxuICAgICAqIGl0cyBkb2N1bWVudCBrZXkgdG8gdGhlIGdpdmVuIHRhcmdldCdzIG1hcHBpbmcuXHJcbiAgICAgKi9cclxuICAgIC8vIFZpc2libGUgZm9yIHRlc3RpbmcuXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmFkZERvY3VtZW50VG9UYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIGRvY3VtZW50KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlVGFyZ2V0KHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjaGFuZ2VUeXBlID0gdGhpcy50YXJnZXRDb250YWluc0RvY3VtZW50KHRhcmdldElkLCBkb2N1bWVudC5rZXkpXHJcbiAgICAgICAgICAgID8gQ2hhbmdlVHlwZS5Nb2RpZmllZFxyXG4gICAgICAgICAgICA6IENoYW5nZVR5cGUuQWRkZWQ7XHJcbiAgICAgICAgdmFyIHRhcmdldFN0YXRlID0gdGhpcy5lbnN1cmVUYXJnZXRTdGF0ZSh0YXJnZXRJZCk7XHJcbiAgICAgICAgdGFyZ2V0U3RhdGUuYWRkRG9jdW1lbnRDaGFuZ2UoZG9jdW1lbnQua2V5LCBjaGFuZ2VUeXBlKTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFVwZGF0ZXMgPSB0aGlzLnBlbmRpbmdEb2N1bWVudFVwZGF0ZXMuaW5zZXJ0KGRvY3VtZW50LmtleSwgZG9jdW1lbnQpO1xyXG4gICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZyA9IHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZy5pbnNlcnQoZG9jdW1lbnQua2V5LCB0aGlzLmVuc3VyZURvY3VtZW50VGFyZ2V0TWFwcGluZyhkb2N1bWVudC5rZXkpLmFkZCh0YXJnZXRJZCkpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgZnJvbSB0aGUgdGFyZ2V0IG1hcHBpbmcuIElmIHRoZVxyXG4gICAgICogZG9jdW1lbnQgbm8gbG9uZ2VyIG1hdGNoZXMgdGhlIHRhcmdldCwgYnV0IHRoZSBkb2N1bWVudCdzIHN0YXRlIGlzIHN0aWxsXHJcbiAgICAgKiBrbm93biAoZS5nLiB3ZSBrbm93IHRoYXQgdGhlIGRvY3VtZW50IHdhcyBkZWxldGVkIG9yIHdlIHJlY2VpdmVkIHRoZSBjaGFuZ2VcclxuICAgICAqIHRoYXQgY2F1c2VkIHRoZSBmaWx0ZXIgbWlzbWF0Y2gpLCB0aGUgbmV3IGRvY3VtZW50IGNhbiBiZSBwcm92aWRlZFxyXG4gICAgICogdG8gdXBkYXRlIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUuXHJcbiAgICAgKi9cclxuICAgIC8vIFZpc2libGUgZm9yIHRlc3RpbmcuXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLnJlbW92ZURvY3VtZW50RnJvbVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCwga2V5LCB1cGRhdGVkRG9jdW1lbnQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNBY3RpdmVUYXJnZXQodGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHRhcmdldFN0YXRlID0gdGhpcy5lbnN1cmVUYXJnZXRTdGF0ZSh0YXJnZXRJZCk7XHJcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0Q29udGFpbnNEb2N1bWVudCh0YXJnZXRJZCwga2V5KSkge1xyXG4gICAgICAgICAgICB0YXJnZXRTdGF0ZS5hZGREb2N1bWVudENoYW5nZShrZXksIENoYW5nZVR5cGUuUmVtb3ZlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBUaGUgZG9jdW1lbnQgbWF5IGhhdmUgZW50ZXJlZCBhbmQgbGVmdCB0aGUgdGFyZ2V0IGJlZm9yZSB3ZSByYWlzZWQgYVxyXG4gICAgICAgICAgICAvLyBzbmFwc2hvdCwgc28gd2UgY2FuIGp1c3QgaWdub3JlIHRoZSBjaGFuZ2UuXHJcbiAgICAgICAgICAgIHRhcmdldFN0YXRlLnJlbW92ZURvY3VtZW50Q2hhbmdlKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZyA9IHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZy5pbnNlcnQoa2V5LCB0aGlzLmVuc3VyZURvY3VtZW50VGFyZ2V0TWFwcGluZyhrZXkpLmRlbGV0ZSh0YXJnZXRJZCkpO1xyXG4gICAgICAgIGlmICh1cGRhdGVkRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRVcGRhdGVzID0gdGhpcy5wZW5kaW5nRG9jdW1lbnRVcGRhdGVzLmluc2VydChrZXksIHVwZGF0ZWREb2N1bWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUucmVtb3ZlVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMudGFyZ2V0U3RhdGVzW3RhcmdldElkXTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgY291bnQgb2YgZG9jdW1lbnRzIGluIHRoZSB0YXJnZXQuIFRoaXMgaW5jbHVkZXMgYm90aFxyXG4gICAgICogdGhlIG51bWJlciBvZiBkb2N1bWVudHMgdGhhdCB0aGUgTG9jYWxTdG9yZSBjb25zaWRlcnMgdG8gYmUgcGFydCBvZiB0aGVcclxuICAgICAqIHRhcmdldCBhcyB3ZWxsIGFzIGFueSBhY2N1bXVsYXRlZCBjaGFuZ2VzLlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmdldEN1cnJlbnREb2N1bWVudENvdW50Rm9yVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldFN0YXRlID0gdGhpcy5lbnN1cmVUYXJnZXRTdGF0ZSh0YXJnZXRJZCk7XHJcbiAgICAgICAgdmFyIHRhcmdldENoYW5nZSA9IHRhcmdldFN0YXRlLnRvVGFyZ2V0Q2hhbmdlKCk7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLm1ldGFkYXRhUHJvdmlkZXIuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0YXJnZXRJZCkuc2l6ZSArXHJcbiAgICAgICAgICAgIHRhcmdldENoYW5nZS5hZGRlZERvY3VtZW50cy5zaXplIC1cclxuICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlLnJlbW92ZWREb2N1bWVudHMuc2l6ZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbmNyZW1lbnQgdGhlIG51bWJlciBvZiBhY2tzIG5lZWRlZCBmcm9tIHdhdGNoIGJlZm9yZSB3ZSBjYW4gY29uc2lkZXIgdGhlXHJcbiAgICAgKiBzZXJ2ZXIgdG8gYmUgJ2luLXN5bmMnIHdpdGggdGhlIGNsaWVudCdzIGFjdGl2ZSB0YXJnZXRzLlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLnJlY29yZFBlbmRpbmdUYXJnZXRSZXF1ZXN0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgLy8gRm9yIGVhY2ggcmVxdWVzdCB3ZSBnZXQgd2UgbmVlZCB0byByZWNvcmQgd2UgbmVlZCBhIHJlc3BvbnNlIGZvciBpdC5cclxuICAgICAgICB2YXIgdGFyZ2V0U3RhdGUgPSB0aGlzLmVuc3VyZVRhcmdldFN0YXRlKHRhcmdldElkKTtcclxuICAgICAgICB0YXJnZXRTdGF0ZS5yZWNvcmRQZW5kaW5nVGFyZ2V0UmVxdWVzdCgpO1xyXG4gICAgfTtcclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuZW5zdXJlVGFyZ2V0U3RhdGUgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICBpZiAoIXRoaXMudGFyZ2V0U3RhdGVzW3RhcmdldElkXSkge1xyXG4gICAgICAgICAgICB0aGlzLnRhcmdldFN0YXRlc1t0YXJnZXRJZF0gPSBuZXcgVGFyZ2V0U3RhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0U3RhdGVzW3RhcmdldElkXTtcclxuICAgIH07XHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmVuc3VyZURvY3VtZW50VGFyZ2V0TWFwcGluZyA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0TWFwcGluZyA9IHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZy5nZXQoa2V5KTtcclxuICAgICAgICBpZiAoIXRhcmdldE1hcHBpbmcpIHtcclxuICAgICAgICAgICAgdGFyZ2V0TWFwcGluZyA9IG5ldyBTb3J0ZWRTZXQocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZyA9IHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZy5pbnNlcnQoa2V5LCB0YXJnZXRNYXBwaW5nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldE1hcHBpbmc7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBWZXJpZmllcyB0aGF0IHRoZSB1c2VyIGlzIHN0aWxsIGludGVyZXN0ZWQgaW4gdGhpcyB0YXJnZXQgKGJ5IGNhbGxpbmdcclxuICAgICAqIGBnZXRRdWVyeURhdGFGb3JUYXJnZXQoKWApIGFuZCB0aGF0IHdlIGFyZSBub3Qgd2FpdGluZyBmb3IgcGVuZGluZyBBRERzXHJcbiAgICAgKiBmcm9tIHdhdGNoLlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmlzQWN0aXZlVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcnlEYXRhRm9yQWN0aXZlVGFyZ2V0KHRhcmdldElkKSAhPT0gbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIFF1ZXJ5RGF0YSBmb3IgYW4gYWN0aXZlIHRhcmdldCAoaS5lLiBhIHRhcmdldCB0aGF0IHRoZSB1c2VyXHJcbiAgICAgKiBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoYXQgaGFzIG5vIG91dHN0YW5kaW5nIHRhcmdldCBjaGFuZ2UgcmVxdWVzdHMpLlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLnF1ZXJ5RGF0YUZvckFjdGl2ZVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciB0YXJnZXRTdGF0ZSA9IHRoaXMudGFyZ2V0U3RhdGVzW3RhcmdldElkXTtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0U3RhdGUgJiYgdGFyZ2V0U3RhdGUuaXNQZW5kaW5nXHJcbiAgICAgICAgICAgID8gbnVsbFxyXG4gICAgICAgICAgICA6IHRoaXMubWV0YWRhdGFQcm92aWRlci5nZXRRdWVyeURhdGFGb3JUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVzZXRzIHRoZSBzdGF0ZSBvZiBhIFdhdGNoIHRhcmdldCB0byBpdHMgaW5pdGlhbCBzdGF0ZSAoZS5nLiBzZXRzXHJcbiAgICAgKiAnY3VycmVudCcgdG8gZmFsc2UsIGNsZWFycyB0aGUgcmVzdW1lIHRva2VuIGFuZCByZW1vdmVzIGl0cyB0YXJnZXQgbWFwcGluZ1xyXG4gICAgICogZnJvbSBhbGwgZG9jdW1lbnRzKS5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5yZXNldFRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLnRhcmdldFN0YXRlc1t0YXJnZXRJZF0uaXNQZW5kaW5nLCAnU2hvdWxkIG9ubHkgcmVzZXQgYWN0aXZlIHRhcmdldHMnKTtcclxuICAgICAgICB0aGlzLnRhcmdldFN0YXRlc1t0YXJnZXRJZF0gPSBuZXcgVGFyZ2V0U3RhdGUoKTtcclxuICAgICAgICAvLyBUcmlnZ2VyIHJlbW92YWwgZm9yIGFueSBkb2N1bWVudHMgY3VycmVudGx5IG1hcHBlZCB0byB0aGlzIHRhcmdldC5cclxuICAgICAgICAvLyBUaGVzZSByZW1vdmFscyB3aWxsIGJlIHBhcnQgb2YgdGhlIGluaXRpYWwgc25hcHNob3QgaWYgV2F0Y2ggZG9lcyBub3RcclxuICAgICAgICAvLyByZXNlbmQgdGhlc2UgZG9jdW1lbnRzLlxyXG4gICAgICAgIHZhciBleGlzdGluZ0tleXMgPSB0aGlzLm1ldGFkYXRhUHJvdmlkZXIuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgZXhpc3RpbmdLZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICBfdGhpcy5yZW1vdmVEb2N1bWVudEZyb21UYXJnZXQodGFyZ2V0SWQsIGtleSwgLyp1cGRhdGVkRG9jdW1lbnQ9Ki8gbnVsbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIExvY2FsU3RvcmUgY29uc2lkZXJzIHRoZSBkb2N1bWVudCB0byBiZSBwYXJ0IG9mIHRoZVxyXG4gICAgICogc3BlY2lmaWVkIHRhcmdldC5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS50YXJnZXRDb250YWluc0RvY3VtZW50ID0gZnVuY3Rpb24gKHRhcmdldElkLCBrZXkpIHtcclxuICAgICAgICB2YXIgZXhpc3RpbmdLZXlzID0gdGhpcy5tZXRhZGF0YVByb3ZpZGVyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgIHJldHVybiBleGlzdGluZ0tleXMuaGFzKGtleSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFdhdGNoQ2hhbmdlQWdncmVnYXRvcjtcclxufSgpKTtcclxuZnVuY3Rpb24gZG9jdW1lbnRUYXJnZXRNYXAoKSB7XHJcbiAgICByZXR1cm4gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxufVxyXG5mdW5jdGlvbiBzbmFwc2hvdENoYW5nZXNNYXAoKSB7XHJcbiAgICByZXR1cm4gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIERJUkVDVElPTlMgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGRpcnMgPSB7fTtcclxuICAgIGRpcnNbRGlyZWN0aW9uLkFTQ0VORElORy5uYW1lXSA9ICdBU0NFTkRJTkcnO1xyXG4gICAgZGlyc1tEaXJlY3Rpb24uREVTQ0VORElORy5uYW1lXSA9ICdERVNDRU5ESU5HJztcclxuICAgIHJldHVybiBkaXJzO1xyXG59KSgpO1xyXG52YXIgT1BFUkFUT1JTID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBvcHMgPSB7fTtcclxuICAgIG9wc1tSZWxhdGlvbk9wLkxFU1NfVEhBTi5uYW1lXSA9ICdMRVNTX1RIQU4nO1xyXG4gICAgb3BzW1JlbGF0aW9uT3AuTEVTU19USEFOX09SX0VRVUFMLm5hbWVdID0gJ0xFU1NfVEhBTl9PUl9FUVVBTCc7XHJcbiAgICBvcHNbUmVsYXRpb25PcC5HUkVBVEVSX1RIQU4ubmFtZV0gPSAnR1JFQVRFUl9USEFOJztcclxuICAgIG9wc1tSZWxhdGlvbk9wLkdSRUFURVJfVEhBTl9PUl9FUVVBTC5uYW1lXSA9ICdHUkVBVEVSX1RIQU5fT1JfRVFVQUwnO1xyXG4gICAgb3BzW1JlbGF0aW9uT3AuRVFVQUwubmFtZV0gPSAnRVFVQUwnO1xyXG4gICAgb3BzW1JlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlMubmFtZV0gPSAnQVJSQVlfQ09OVEFJTlMnO1xyXG4gICAgcmV0dXJuIG9wcztcclxufSkoKTtcclxuLy8gQSBSZWdFeHAgbWF0Y2hpbmcgSVNPIDg2MDEgVVRDIHRpbWVzdGFtcHMgd2l0aCBvcHRpb25hbCBmcmFjdGlvbi5cclxudmFyIElTT19SRUdfRVhQID0gbmV3IFJlZ0V4cCgvXlxcZHs0fS1cXGRcXGQtXFxkXFxkVFxcZFxcZDpcXGRcXGQ6XFxkXFxkKD86XFwuKFxcZCspKT9aJC8pO1xyXG5mdW5jdGlvbiBhc3NlcnRQcmVzZW50KHZhbHVlLCBkZXNjcmlwdGlvbikge1xyXG4gICAgYXNzZXJ0KCFpc051bGxPclVuZGVmaW5lZCh2YWx1ZSksIGRlc2NyaXB0aW9uICsgJyBpcyBtaXNzaW5nJyk7XHJcbn1cclxuZnVuY3Rpb24gcGFyc2VJbnQ2NCh2YWx1ZSkge1xyXG4gICAgLy8gVE9ETyhiam9ybmljayk6IEhhbmRsZSBpbnQ2NCBncmVhdGVyIHRoYW4gNTMgYml0cy5cclxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiBOdW1iZXIodmFsdWUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhaWwoXCJjYW4ndCBwYXJzZSBcIiArIHZhbHVlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogR2VuZXJhdGVzIEpzb25PYmplY3QgdmFsdWVzIGZvciB0aGUgRGF0YXN0b3JlIEFQSSBzdWl0YWJsZSBmb3Igc2VuZGluZyB0b1xyXG4gKiBlaXRoZXIgR1JQQyBzdHViIG1ldGhvZHMgb3IgdmlhIHRoZSBKU09OL0hUVFAgUkVTVCBBUEkuXHJcbiAqIFRPRE8oa2xpbXQpOiBXZSBjYW4gcmVtb3ZlIHRoZSBkYXRhYmFzZUlkIGFyZ3VtZW50IGlmIHdlIGtlZXAgdGhlIGZ1bGxcclxuICogcmVzb3VyY2UgbmFtZSBpbiBkb2N1bWVudHMuXHJcbiAqL1xyXG52YXIgSnNvblByb3RvU2VyaWFsaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEpzb25Qcm90b1NlcmlhbGl6ZXIoZGF0YWJhc2VJZCwgb3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IGRhdGFiYXNlSWQ7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcclxuICAgIH1cclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmVtcHR5Qnl0ZVN0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnVzZVByb3RvM0pzb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS51bnNhZmVDYXN0UHJvdG9CeXRlU3RyaW5nID0gZnVuY3Rpb24gKGJ5dGVTdHJpbmcpIHtcclxuICAgICAgICAvLyBieXRlU3RyaW5ncyBjYW4gYmUgZWl0aGVyIHN0cmluZyBvciBVSW50OEFycmF5LCBidXQgdGhlIHR5cGluZ3Mgc2F5XHJcbiAgICAgICAgLy8gaXQncyBhbHdheXMgYSBzdHJpbmcuIENhc3QgYXMgc3RyaW5nIHRvIGF2b2lkIHR5cGUgY2hlY2sgZmFpbGluZ1xyXG4gICAgICAgIHJldHVybiBieXRlU3RyaW5nO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21ScGNTdGF0dXMgPSBmdW5jdGlvbiAoc3RhdHVzKSB7XHJcbiAgICAgICAgdmFyIGNvZGUgPSBzdGF0dXMuY29kZSA9PT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgID8gQ29kZS5VTktOT1dOXHJcbiAgICAgICAgICAgIDogbWFwQ29kZUZyb21ScGNDb2RlKHN0YXR1cy5jb2RlKTtcclxuICAgICAgICByZXR1cm4gbmV3IEZpcmVzdG9yZUVycm9yKGNvZGUsIHN0YXR1cy5tZXNzYWdlIHx8ICcnKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBudW1iZXIgKG9yIHVuZGVmaW5lZCkgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbnRvXHJcbiAgICAgKiBhIGdvb2dsZS5wcm90b2J1Zi5JbnQzMlZhbHVlIHByb3RvLlxyXG4gICAgICogRE8gTk9UIFVTRSBUSElTIEZPUiBBTllUSElORyBFTFNFLlxyXG4gICAgICogVGhpcyBtZXRob2QgY2hlYXRzLiBJdCdzIHR5cGVkIGFzIHJldHVybmluZyBcIm51bWJlclwiIGJlY2F1c2UgdGhhdCdzIHdoYXRcclxuICAgICAqIG91ciBnZW5lcmF0ZWQgcHJvdG8gaW50ZXJmYWNlcyBzYXkgSW50MzJWYWx1ZSBtdXN0IGJlLiBCdXQgR1JQQyBhY3R1YWxseVxyXG4gICAgICogZXhwZWN0cyBhIHsgdmFsdWU6IDxudW1iZXI+IH0gc3RydWN0LlxyXG4gICAgICovXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0ludDMyVmFsdWUgPSBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh2YWwpKSB7XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgV2UgbmVlZCB0byBtYXRjaCBnZW5lcmF0ZWQgUHJvdG8gdHlwZXMuXHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiB2YWwgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIG51bWJlciAob3IgbnVsbCkgZnJvbSBhIGdvb2dsZS5wcm90b2J1Zi5JbnQzMlZhbHVlIHByb3RvLlxyXG4gICAgICogRE8gTk9UIFVTRSBUSElTIEZPUiBBTllUSElORyBFTFNFLlxyXG4gICAgICogVGhpcyBtZXRob2QgY2hlYXRzLiBJdCdzIHR5cGVkIGFzIGFjY2VwdGluZyBcIm51bWJlclwiIGJlY2F1c2UgdGhhdCdzIHdoYXRcclxuICAgICAqIG91ciBnZW5lcmF0ZWQgcHJvdG8gaW50ZXJmYWNlcyBzYXkgSW50MzJWYWx1ZSBtdXN0IGJlLCBidXQgaXQgYWN0dWFsbHlcclxuICAgICAqIGFjY2VwdHMgeyB2YWx1ZTogbnVtYmVyIH0gdG8gbWF0Y2ggb3VyIHNlcmlhbGl6YXRpb24gaW4gdG9JbnQzMlZhbHVlKCkuXHJcbiAgICAgKi9cclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21JbnQzMlZhbHVlID0gZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgIHZhciByZXN1bHQ7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgV2UgbmVlZCB0byBtYXRjaCBnZW5lcmF0ZWQgUHJvdG8gdHlwZXMuXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbC52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFdlIGFjY2VwdCByYXcgbnVtYmVycyAod2l0aG91dCB0aGUge3ZhbHVlOiAuLi4gfSB3cmFwcGVyKSBmb3JcclxuICAgICAgICAgICAgLy8gY29tcGF0aWJpbGl0eSB3aXRoIGxlZ2FjeSBwZXJzaXN0ZWQgZGF0YS5cclxuICAgICAgICAgICAgcmVzdWx0ID0gdmFsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaXNOdWxsT3JVbmRlZmluZWQocmVzdWx0KSA/IG51bGwgOiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgdmFsdWUgZm9yIGEgRGF0ZSB0aGF0J3MgYXBwcm9wcmlhdGUgdG8gcHV0IGludG8gYSBwcm90by5cclxuICAgICAqIERPIE5PVCBVU0UgVEhJUyBGT1IgQU5ZVEhJTkcgRUxTRS5cclxuICAgICAqIFRoaXMgbWV0aG9kIGNoZWF0cy4gSXQncyB0eXBlZCBhcyByZXR1cm5pbmcgXCJzdHJpbmdcIiBiZWNhdXNlIHRoYXQncyB3aGF0XHJcbiAgICAgKiBvdXIgZ2VuZXJhdGVkIHByb3RvIGludGVyZmFjZXMgc2F5IGRhdGVzIG11c3QgYmUuIEJ1dCBpdCdzIGVhc2llciBhbmQgc2FmZXJcclxuICAgICAqIHRvIGFjdHVhbGx5IHJldHVybiBhIFRpbWVzdGFtcCBwcm90by5cclxuICAgICAqL1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9UaW1lc3RhbXAgPSBmdW5jdGlvbiAodGltZXN0YW1wKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2Vjb25kczogdGltZXN0YW1wLnNlY29uZHMsXHJcbiAgICAgICAgICAgIG5hbm9zOiB0aW1lc3RhbXAubmFub3NlY29uZHNcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVRpbWVzdGFtcCA9IGZ1bmN0aW9uIChkYXRlKSB7XHJcbiAgICAgICAgLy8gVGhlIGpzb24gaW50ZXJmYWNlIChmb3IgdGhlIGJyb3dzZXIpIHdpbGwgcmV0dXJuIGFuIGlzbyB0aW1lc3RhbXAgc3RyaW5nLFxyXG4gICAgICAgIC8vIHdoaWxlIHRoZSBwcm90byBqcyBsaWJyYXJ5IChmb3Igbm9kZSkgd2lsbCByZXR1cm4gYVxyXG4gICAgICAgIC8vIGdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXAgaW5zdGFuY2UuXHJcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAvLyBUT0RPKGIvMzcyODIyMzcpOiBVc2Ugc3RyaW5ncyBmb3IgUHJvdG8zIHRpbWVzdGFtcHNcclxuICAgICAgICAgICAgLy8gYXNzZXJ0KHRoaXMub3B0aW9ucy51c2VQcm90bzNKc29uLFxyXG4gICAgICAgICAgICAvLyAgICdUaGUgdGltZXN0YW1wIHN0cmluZyBmb3JtYXQgcmVxdWlyZXMgUHJvdG8zLicpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mcm9tSXNvODYwMVN0cmluZyhkYXRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGFzc2VydCghIWRhdGUsICdDYW5ub3QgZGVzZXJpYWxpemUgbnVsbCBvciB1bmRlZmluZWQgdGltZXN0YW1wLicpO1xyXG4gICAgICAgICAgICAvLyBUT0RPKGIvMzcyODIyMzcpOiBVc2Ugc3RyaW5ncyBmb3IgUHJvdG8zIHRpbWVzdGFtcHNcclxuICAgICAgICAgICAgLy8gYXNzZXJ0KCF0aGlzLm9wdGlvbnMudXNlUHJvdG8zSnNvbixcclxuICAgICAgICAgICAgLy8gICAnVGhlIHRpbWVzdGFtcCBpbnN0YW5jZSBmb3JtYXQgcmVxdWlyZXMgUHJvdG8gSlMuJyk7XHJcbiAgICAgICAgICAgIHZhciBzZWNvbmRzID0gcGFyc2VJbnQ2NChkYXRlLnNlY29uZHMgfHwgJzAnKTtcclxuICAgICAgICAgICAgdmFyIG5hbm9zID0gZGF0ZS5uYW5vcyB8fCAwO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFRpbWVzdGFtcChzZWNvbmRzLCBuYW5vcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21Jc284NjAxU3RyaW5nID0gZnVuY3Rpb24gKHV0Yykge1xyXG4gICAgICAgIC8vIFRoZSBkYXRlIHN0cmluZyBjYW4gaGF2ZSBoaWdoZXIgcHJlY2lzaW9uIChuYW5vcykgdGhhbiB0aGUgRGF0ZSBjbGFzc1xyXG4gICAgICAgIC8vIChtaWxsaXMpLCBzbyB3ZSBkbyBzb21lIGN1c3RvbSBwYXJzaW5nIGhlcmUuXHJcbiAgICAgICAgLy8gUGFyc2UgdGhlIG5hbm9zIHJpZ2h0IG91dCBvZiB0aGUgc3RyaW5nLlxyXG4gICAgICAgIHZhciBuYW5vcyA9IDA7XHJcbiAgICAgICAgdmFyIGZyYWN0aW9uID0gSVNPX1JFR19FWFAuZXhlYyh1dGMpO1xyXG4gICAgICAgIGFzc2VydCghIWZyYWN0aW9uLCAnaW52YWxpZCB0aW1lc3RhbXA6ICcgKyB1dGMpO1xyXG4gICAgICAgIGlmIChmcmFjdGlvblsxXSkge1xyXG4gICAgICAgICAgICAvLyBQYWQgdGhlIGZyYWN0aW9uIG91dCB0byA5IGRpZ2l0cyAobmFub3MpLlxyXG4gICAgICAgICAgICB2YXIgbmFub1N0ciA9IGZyYWN0aW9uWzFdO1xyXG4gICAgICAgICAgICBuYW5vU3RyID0gKG5hbm9TdHIgKyAnMDAwMDAwMDAwJykuc3Vic3RyKDAsIDkpO1xyXG4gICAgICAgICAgICBuYW5vcyA9IE51bWJlcihuYW5vU3RyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gUGFyc2UgdGhlIGRhdGUgdG8gZ2V0IHRoZSBzZWNvbmRzLlxyXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUodXRjKTtcclxuICAgICAgICB2YXIgc2Vjb25kcyA9IE1hdGguZmxvb3IoZGF0ZS5nZXRUaW1lKCkgLyAxMDAwKTtcclxuICAgICAgICByZXR1cm4gbmV3IFRpbWVzdGFtcChzZWNvbmRzLCBuYW5vcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgdmFsdWUgZm9yIGJ5dGVzIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW4gYSBwcm90by5cclxuICAgICAqIERPIE5PVCBVU0UgVEhJUyBGT1IgQU5ZVEhJTkcgRUxTRS5cclxuICAgICAqIFRoaXMgbWV0aG9kIGNoZWF0cy4gSXQncyB0eXBlZCBhcyByZXR1cm5pbmcgXCJzdHJpbmdcIiBiZWNhdXNlIHRoYXQncyB3aGF0XHJcbiAgICAgKiBvdXIgZ2VuZXJhdGVkIHByb3RvIGludGVyZmFjZXMgc2F5IGJ5dGVzIG11c3QgYmUuIEJ1dCBpdCBzaG91bGQgcmV0dXJuXHJcbiAgICAgKiBhbiBVaW50OEFycmF5IGluIE5vZGUuXHJcbiAgICAgKi9cclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvQnl0ZXMgPSBmdW5jdGlvbiAoYnl0ZXMpIHtcclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnVzZVByb3RvM0pzb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGJ5dGVzLnRvQmFzZTY0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBUaGUgdHlwaW5ncyBzYXkgaXQncyBhIHN0cmluZywgYnV0IGl0IG5lZWRzIHRvIGJlIGEgVWludDhBcnJheSBpbiBOb2RlLlxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy51bnNhZmVDYXN0UHJvdG9CeXRlU3RyaW5nKGJ5dGVzLnRvVWludDhBcnJheSgpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZSB0aGUgYmxvYiBmcm9tIHRoZSBwcm90b3MgaW50byB0aGUgaW50ZXJuYWwgQmxvYiBjbGFzcy4gTm90ZSB0aGF0IHRoZVxyXG4gICAgICogdHlwaW5ncyBhc3N1bWUgYWxsIGJsb2JzIGFyZSBzdHJpbmdzLCBidXQgdGhleSBhcmUgYWN0dWFsbHkgVWludDhBcnJheXNcclxuICAgICAqIG9uIE5vZGUuXHJcbiAgICAgKi9cclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21CbG9iID0gZnVuY3Rpb24gKGJsb2IpIHtcclxuICAgICAgICBpZiAodHlwZW9mIGJsb2IgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLm9wdGlvbnMudXNlUHJvdG8zSnNvbiwgJ0V4cGVjdGVkIGJ5dGVzIHRvIGJlIHBhc3NlZCBpbiBhcyBVaW50OEFycmF5LCBidXQgZ290IGEgc3RyaW5nIGluc3RlYWQuJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBCbG9iLmZyb21CYXNlNjRTdHJpbmcoYmxvYik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhc3NlcnQoIXRoaXMub3B0aW9ucy51c2VQcm90bzNKc29uLCAnRXhwZWN0ZWQgYnl0ZXMgdG8gYmUgcGFzc2VkIGluIGFzIHN0cmluZywgYnV0IGdvdCBzb21ldGhpbmcgZWxzZSBpbnN0ZWFkLicpO1xyXG4gICAgICAgICAgICByZXR1cm4gQmxvYi5mcm9tVWludDhBcnJheShibG9iKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9WZXJzaW9uID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50b1RpbWVzdGFtcCh2ZXJzaW9uLnRvVGltZXN0YW1wKCkpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21WZXJzaW9uID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcclxuICAgICAgICBhc3NlcnQoISF2ZXJzaW9uLCBcIlRyeWluZyB0byBkZXNlcmlhbGl6ZSB2ZXJzaW9uIHRoYXQgaXNuJ3Qgc2V0XCIpO1xyXG4gICAgICAgIHJldHVybiBTbmFwc2hvdFZlcnNpb24uZnJvbVRpbWVzdGFtcCh0aGlzLmZyb21UaW1lc3RhbXAodmVyc2lvbikpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvUmVzb3VyY2VOYW1lID0gZnVuY3Rpb24gKGRhdGFiYXNlSWQsIHBhdGgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mdWxseVF1YWxpZmllZFByZWZpeFBhdGgoZGF0YWJhc2VJZClcclxuICAgICAgICAgICAgLmNoaWxkKCdkb2N1bWVudHMnKVxyXG4gICAgICAgICAgICAuY2hpbGQocGF0aClcclxuICAgICAgICAgICAgLmNhbm9uaWNhbFN0cmluZygpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21SZXNvdXJjZU5hbWUgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHZhciByZXNvdXJjZSA9IFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKG5hbWUpO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmlzVmFsaWRSZXNvdXJjZU5hbWUocmVzb3VyY2UpLCAnVHJpZWQgdG8gZGVzZXJpYWxpemUgaW52YWxpZCBrZXkgJyArIHJlc291cmNlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIHJldHVybiByZXNvdXJjZTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b05hbWUgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9SZXNvdXJjZU5hbWUodGhpcy5kYXRhYmFzZUlkLCBrZXkucGF0aCk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbU5hbWUgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHZhciByZXNvdXJjZSA9IHRoaXMuZnJvbVJlc291cmNlTmFtZShuYW1lKTtcclxuICAgICAgICBhc3NlcnQocmVzb3VyY2UuZ2V0KDEpID09PSB0aGlzLmRhdGFiYXNlSWQucHJvamVjdElkLCAnVHJpZWQgdG8gZGVzZXJpYWxpemUga2V5IGZyb20gZGlmZmVyZW50IHByb2plY3Q6ICcgK1xyXG4gICAgICAgICAgICByZXNvdXJjZS5nZXQoMSkgK1xyXG4gICAgICAgICAgICAnIHZzICcgK1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFiYXNlSWQucHJvamVjdElkKTtcclxuICAgICAgICBhc3NlcnQoKCFyZXNvdXJjZS5nZXQoMykgJiYgIXRoaXMuZGF0YWJhc2VJZC5kYXRhYmFzZSkgfHxcclxuICAgICAgICAgICAgcmVzb3VyY2UuZ2V0KDMpID09PSB0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2UsICdUcmllZCB0byBkZXNlcmlhbGl6ZSBrZXkgZnJvbSBkaWZmZXJlbnQgZGF0YWJhc2U6ICcgK1xyXG4gICAgICAgICAgICByZXNvdXJjZS5nZXQoMykgK1xyXG4gICAgICAgICAgICAnIHZzICcgK1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2UpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRLZXkodGhpcy5leHRyYWN0TG9jYWxQYXRoRnJvbVJlc291cmNlTmFtZShyZXNvdXJjZSkpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvUXVlcnlQYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICBpZiAocGF0aC5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgLy8gSWYgdGhlIHBhdGggaXMgZW1wdHksIHRoZSBiYWNrZW5kIHJlcXVpcmVzIHdlIGxlYXZlIG9mZiB0aGUgL2RvY3VtZW50c1xyXG4gICAgICAgICAgICAvLyBhdCB0aGUgZW5kLlxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVkRGF0YWJhc2VJZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9SZXNvdXJjZU5hbWUodGhpcy5kYXRhYmFzZUlkLCBwYXRoKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tUXVlcnlQYXRoID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICB2YXIgcmVzb3VyY2VOYW1lID0gdGhpcy5mcm9tUmVzb3VyY2VOYW1lKG5hbWUpO1xyXG4gICAgICAgIGlmIChyZXNvdXJjZU5hbWUubGVuZ3RoID09PSA0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBSZXNvdXJjZVBhdGguRU1QVFlfUEFUSDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZXh0cmFjdExvY2FsUGF0aEZyb21SZXNvdXJjZU5hbWUocmVzb3VyY2VOYW1lKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUsIFwiZW5jb2RlZERhdGFiYXNlSWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IG5ldyBSZXNvdXJjZVBhdGgoW1xyXG4gICAgICAgICAgICAgICAgJ3Byb2plY3RzJyxcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWQsXHJcbiAgICAgICAgICAgICAgICAnZGF0YWJhc2VzJyxcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YWJhc2VJZC5kYXRhYmFzZVxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgcmV0dXJuIHBhdGguY2Fub25pY2FsU3RyaW5nKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mdWxseVF1YWxpZmllZFByZWZpeFBhdGggPSBmdW5jdGlvbiAoZGF0YWJhc2VJZCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUmVzb3VyY2VQYXRoKFtcclxuICAgICAgICAgICAgJ3Byb2plY3RzJyxcclxuICAgICAgICAgICAgZGF0YWJhc2VJZC5wcm9qZWN0SWQsXHJcbiAgICAgICAgICAgICdkYXRhYmFzZXMnLFxyXG4gICAgICAgICAgICBkYXRhYmFzZUlkLmRhdGFiYXNlXHJcbiAgICAgICAgXSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZXh0cmFjdExvY2FsUGF0aEZyb21SZXNvdXJjZU5hbWUgPSBmdW5jdGlvbiAocmVzb3VyY2VOYW1lKSB7XHJcbiAgICAgICAgYXNzZXJ0KHJlc291cmNlTmFtZS5sZW5ndGggPiA0ICYmIHJlc291cmNlTmFtZS5nZXQoNCkgPT09ICdkb2N1bWVudHMnLCAndHJpZWQgdG8gZGVzZXJpYWxpemUgaW52YWxpZCBrZXkgJyArIHJlc291cmNlTmFtZS50b1N0cmluZygpKTtcclxuICAgICAgICByZXR1cm4gcmVzb3VyY2VOYW1lLnBvcEZpcnN0KDUpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmlzVmFsaWRSZXNvdXJjZU5hbWUgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIC8vIFJlc291cmNlIG5hbWVzIGhhdmUgYXQgbGVhc3QgNCBjb21wb25lbnRzIChwcm9qZWN0IElELCBkYXRhYmFzZSBJRClcclxuICAgICAgICByZXR1cm4gKHBhdGgubGVuZ3RoID49IDQgJiZcclxuICAgICAgICAgICAgcGF0aC5nZXQoMCkgPT09ICdwcm9qZWN0cycgJiZcclxuICAgICAgICAgICAgcGF0aC5nZXQoMikgPT09ICdkYXRhYmFzZXMnKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1ZhbHVlID0gZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBOdWxsVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgbnVsbFZhbHVlOiAnTlVMTF9WQUxVRScgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgQm9vbGVhblZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGJvb2xlYW5WYWx1ZTogdmFsLnZhbHVlKCkgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgSW50ZWdlclZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGludGVnZXJWYWx1ZTogJycgKyB2YWwudmFsdWUoKSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBEb3VibGVWYWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgZG91YmxlVmFsdWUgPSB2YWwudmFsdWUoKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy51c2VQcm90bzNKc29uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBQcm90byAzIGxldCdzIHVzIGVuY29kZSBOYU4gYW5kIEluZmluaXR5IGFzIHN0cmluZyB2YWx1ZXMgYXNcclxuICAgICAgICAgICAgICAgIC8vIGV4cGVjdGVkIGJ5IHRoZSBiYWNrZW5kLiBUaGlzIGlzIGN1cnJlbnRseSBub3QgY2hlY2tlZCBieSBvdXIgdW5pdFxyXG4gICAgICAgICAgICAgICAgLy8gdGVzdHMgYmVjYXVzZSB0aGV5IHJlbHkgb24gcHJvdG9idWYuanMuXHJcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZG91YmxlVmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgZG91YmxlVmFsdWU6ICdOYU4nIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChkb3VibGVWYWx1ZSA9PT0gSW5maW5pdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBkb3VibGVWYWx1ZTogJ0luZmluaXR5JyB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZG91YmxlVmFsdWUgPT09IC1JbmZpbml0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGRvdWJsZVZhbHVlOiAnLUluZmluaXR5JyB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB7IGRvdWJsZVZhbHVlOiB2YWwudmFsdWUoKSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBTdHJpbmdWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBzdHJpbmdWYWx1ZTogdmFsLnZhbHVlKCkgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgT2JqZWN0VmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgbWFwVmFsdWU6IHRoaXMudG9NYXBWYWx1ZSh2YWwpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIEFycmF5VmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgYXJyYXlWYWx1ZTogdGhpcy50b0FycmF5VmFsdWUodmFsKSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBUaW1lc3RhbXBWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IHRoaXMudG9UaW1lc3RhbXAodmFsLmludGVybmFsVmFsdWUpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIEdlb1BvaW50VmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGdlb1BvaW50VmFsdWU6IHtcclxuICAgICAgICAgICAgICAgICAgICBsYXRpdHVkZTogdmFsLnZhbHVlKCkubGF0aXR1ZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9uZ2l0dWRlOiB2YWwudmFsdWUoKS5sb25naXR1ZGVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgQmxvYlZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBieXRlc1ZhbHVlOiB0aGlzLnRvQnl0ZXModmFsLnZhbHVlKCkpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIFJlZlZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VWYWx1ZTogdGhpcy50b1Jlc291cmNlTmFtZSh2YWwuZGF0YWJhc2VJZCwgdmFsLmtleS5wYXRoKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gRmllbGRWYWx1ZSAnICsgSlNPTi5zdHJpbmdpZnkodmFsKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21WYWx1ZSA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnlcclxuICAgICAgICB2YXIgdHlwZSA9IG9ialsndmFsdWVfdHlwZSddO1xyXG4gICAgICAgIGlmIChoYXNUYWcob2JqLCB0eXBlLCAnbnVsbFZhbHVlJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE51bGxWYWx1ZS5JTlNUQU5DRTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ2Jvb2xlYW5WYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBCb29sZWFuVmFsdWUub2Yob2JqLmJvb2xlYW5WYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdpbnRlZ2VyVmFsdWUnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEludGVnZXJWYWx1ZShwYXJzZUludDY0KG9iai5pbnRlZ2VyVmFsdWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ2RvdWJsZVZhbHVlJykpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy51c2VQcm90bzNKc29uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBQcm90byAzIHVzZXMgdGhlIHN0cmluZyB2YWx1ZXMgJ05hTicgYW5kICdJbmZpbml0eScuXHJcbiAgICAgICAgICAgICAgICBpZiAob2JqLmRvdWJsZVZhbHVlID09PSAnTmFOJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBEb3VibGVWYWx1ZS5OQU47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChvYmouZG91YmxlVmFsdWUgPT09ICdJbmZpbml0eScpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRG91YmxlVmFsdWUuUE9TSVRJVkVfSU5GSU5JVFk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChvYmouZG91YmxlVmFsdWUgPT09ICctSW5maW5pdHknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERvdWJsZVZhbHVlLk5FR0FUSVZFX0lORklOSVRZO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRG91YmxlVmFsdWUob2JqLmRvdWJsZVZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ3N0cmluZ1ZhbHVlJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdWYWx1ZShvYmouc3RyaW5nVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAnbWFwVmFsdWUnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mcm9tRmllbGRzKG9iai5tYXBWYWx1ZS5maWVsZHMgfHwge30pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAnYXJyYXlWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIC8vIFwidmFsdWVzXCIgaXMgbm90IHByZXNlbnQgaWYgdGhlIGFycmF5IGlzIGVtcHR5XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQob2JqLmFycmF5VmFsdWUsICdhcnJheVZhbHVlJyk7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZXMkJDEgPSBvYmouYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW107XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXJyYXlWYWx1ZSh2YWx1ZXMkJDEubWFwKGZ1bmN0aW9uICh2KSB7IHJldHVybiBfdGhpcy5mcm9tVmFsdWUodik7IH0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ3RpbWVzdGFtcFZhbHVlJykpIHtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChvYmoudGltZXN0YW1wVmFsdWUsICd0aW1lc3RhbXBWYWx1ZScpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFRpbWVzdGFtcFZhbHVlKHRoaXMuZnJvbVRpbWVzdGFtcChvYmoudGltZXN0YW1wVmFsdWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ2dlb1BvaW50VmFsdWUnKSkge1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KG9iai5nZW9Qb2ludFZhbHVlLCAnZ2VvUG9pbnRWYWx1ZScpO1xyXG4gICAgICAgICAgICB2YXIgbGF0aXR1ZGUgPSBvYmouZ2VvUG9pbnRWYWx1ZS5sYXRpdHVkZSB8fCAwO1xyXG4gICAgICAgICAgICB2YXIgbG9uZ2l0dWRlID0gb2JqLmdlb1BvaW50VmFsdWUubG9uZ2l0dWRlIHx8IDA7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgR2VvUG9pbnRWYWx1ZShuZXcgR2VvUG9pbnQobGF0aXR1ZGUsIGxvbmdpdHVkZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAnYnl0ZXNWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQob2JqLmJ5dGVzVmFsdWUsICdieXRlc1ZhbHVlJyk7XHJcbiAgICAgICAgICAgIHZhciBibG9iID0gdGhpcy5mcm9tQmxvYihvYmouYnl0ZXNWYWx1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmxvYlZhbHVlKGJsb2IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAncmVmZXJlbmNlVmFsdWUnKSkge1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KG9iai5yZWZlcmVuY2VWYWx1ZSwgJ3JlZmVyZW5jZVZhbHVlJyk7XHJcbiAgICAgICAgICAgIHZhciByZXNvdXJjZU5hbWUgPSB0aGlzLmZyb21SZXNvdXJjZU5hbWUob2JqLnJlZmVyZW5jZVZhbHVlKTtcclxuICAgICAgICAgICAgdmFyIGRiSWQgPSBuZXcgRGF0YWJhc2VJZChyZXNvdXJjZU5hbWUuZ2V0KDEpLCByZXNvdXJjZU5hbWUuZ2V0KDMpKTtcclxuICAgICAgICAgICAgdmFyIGtleSA9IG5ldyBEb2N1bWVudEtleSh0aGlzLmV4dHJhY3RMb2NhbFBhdGhGcm9tUmVzb3VyY2VOYW1lKHJlc291cmNlTmFtZSkpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlZlZhbHVlKGRiSWQsIGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBWYWx1ZSBwcm90byAnICsgSlNPTi5zdHJpbmdpZnkob2JqKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiBDcmVhdGVzIGFuIGFwaS5Eb2N1bWVudCBmcm9tIGtleSBhbmQgZmllbGRzIChidXQgbm8gY3JlYXRlL3VwZGF0ZSB0aW1lKSAqL1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9NdXRhdGlvbkRvY3VtZW50ID0gZnVuY3Rpb24gKGtleSwgZmllbGRzKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmFtZTogdGhpcy50b05hbWUoa2V5KSxcclxuICAgICAgICAgICAgZmllbGRzOiB0aGlzLnRvRmllbGRzKGZpZWxkcylcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvRG9jdW1lbnQgPSBmdW5jdGlvbiAoZG9jdW1lbnQpIHtcclxuICAgICAgICBhc3NlcnQoIWRvY3VtZW50Lmhhc0xvY2FsTXV0YXRpb25zLCBcIkNhbid0IHNlcmlhbGl6ZSBkb2N1bWVudHMgd2l0aCBtdXRhdGlvbnMuXCIpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMudG9OYW1lKGRvY3VtZW50LmtleSksXHJcbiAgICAgICAgICAgIGZpZWxkczogdGhpcy50b0ZpZWxkcyhkb2N1bWVudC5kYXRhKSxcclxuICAgICAgICAgICAgdXBkYXRlVGltZTogdGhpcy50b1RpbWVzdGFtcChkb2N1bWVudC52ZXJzaW9uLnRvVGltZXN0YW1wKCkpXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRG9jdW1lbnQgPSBmdW5jdGlvbiAoZG9jdW1lbnQsIGhhc0NvbW1pdHRlZE11dGF0aW9ucykge1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnQodGhpcy5mcm9tTmFtZShkb2N1bWVudC5uYW1lKSwgdGhpcy5mcm9tVmVyc2lvbihkb2N1bWVudC51cGRhdGVUaW1lKSwgdGhpcy5mcm9tRmllbGRzKGRvY3VtZW50LmZpZWxkcyB8fCB7fSksIHsgaGFzQ29tbWl0dGVkTXV0YXRpb25zOiAhIWhhc0NvbW1pdHRlZE11dGF0aW9ucyB9KTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0ZpZWxkcyA9IGZ1bmN0aW9uIChmaWVsZHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICBmaWVsZHMuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IF90aGlzLnRvVmFsdWUodmFsdWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbUZpZWxkcyA9IGZ1bmN0aW9uIChvYmplY3QpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFByb3RvIG1hcDxzdHJpbmcsIFZhbHVlPiBnZXRzIG1hcHBlZCB0byBPYmplY3QsIHNvIGNhc3QgaXQuXHJcbiAgICAgICAgdmFyIG1hcCA9IG9iamVjdDtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gT2JqZWN0VmFsdWUuRU1QVFk7XHJcbiAgICAgICAgZm9yRWFjaChtYXAsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5zZXQobmV3IEZpZWxkUGF0aChba2V5XSksIF90aGlzLmZyb21WYWx1ZSh2YWx1ZSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9NYXBWYWx1ZSA9IGZ1bmN0aW9uIChtYXApIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBmaWVsZHM6IHRoaXMudG9GaWVsZHMobWFwKVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9BcnJheVZhbHVlID0gZnVuY3Rpb24gKGFycmF5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgcmVzdWx0LnB1c2goX3RoaXMudG9WYWx1ZSh2YWx1ZSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHZhbHVlczogcmVzdWx0IH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbUZvdW5kID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIGFzc2VydCghIWRvYy5mb3VuZCwgJ1RyaWVkIHRvIGRlc2VyaWFsaXplIGEgZm91bmQgZG9jdW1lbnQgZnJvbSBhIG1pc3NpbmcgZG9jdW1lbnQuJyk7XHJcbiAgICAgICAgYXNzZXJ0UHJlc2VudChkb2MuZm91bmQubmFtZSwgJ2RvYy5mb3VuZC5uYW1lJyk7XHJcbiAgICAgICAgYXNzZXJ0UHJlc2VudChkb2MuZm91bmQudXBkYXRlVGltZSwgJ2RvYy5mb3VuZC51cGRhdGVUaW1lJyk7XHJcbiAgICAgICAgdmFyIGtleSA9IHRoaXMuZnJvbU5hbWUoZG9jLmZvdW5kLm5hbWUpO1xyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gdGhpcy5mcm9tVmVyc2lvbihkb2MuZm91bmQudXBkYXRlVGltZSk7XHJcbiAgICAgICAgdmFyIGZpZWxkcyA9IHRoaXMuZnJvbUZpZWxkcyhkb2MuZm91bmQuZmllbGRzIHx8IHt9KTtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50KGtleSwgdmVyc2lvbiwgZmllbGRzLCB7fSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbU1pc3NpbmcgPSBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgYXNzZXJ0KCEhcmVzdWx0Lm1pc3NpbmcsICdUcmllZCB0byBkZXNlcmlhbGl6ZSBhIG1pc3NpbmcgZG9jdW1lbnQgZnJvbSBhIGZvdW5kIGRvY3VtZW50LicpO1xyXG4gICAgICAgIGFzc2VydCghIXJlc3VsdC5yZWFkVGltZSwgJ1RyaWVkIHRvIGRlc2VyaWFsaXplIGEgbWlzc2luZyBkb2N1bWVudCB3aXRob3V0IGEgcmVhZCB0aW1lLicpO1xyXG4gICAgICAgIHZhciBrZXkgPSB0aGlzLmZyb21OYW1lKHJlc3VsdC5taXNzaW5nKTtcclxuICAgICAgICB2YXIgdmVyc2lvbiA9IHRoaXMuZnJvbVZlcnNpb24ocmVzdWx0LnJlYWRUaW1lKTtcclxuICAgICAgICByZXR1cm4gbmV3IE5vRG9jdW1lbnQoa2V5LCB2ZXJzaW9uKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tTWF5YmVEb2N1bWVudCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55XHJcbiAgICAgICAgdmFyIHR5cGUgPSByZXN1bHRbJ3Jlc3VsdCddO1xyXG4gICAgICAgIGlmIChoYXNUYWcocmVzdWx0LCB0eXBlLCAnZm91bmQnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mcm9tRm91bmQocmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKHJlc3VsdCwgdHlwZSwgJ21pc3NpbmcnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mcm9tTWlzc2luZyhyZXN1bHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFpbCgnaW52YWxpZCBiYXRjaCBnZXQgcmVzcG9uc2U6ICcgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQpKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1dhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUgPSBmdW5jdGlvbiAoc3RhdGUpIHtcclxuICAgICAgICBzd2l0Y2ggKHN0YXRlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5BZGRlZDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnQUREJztcclxuICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLkN1cnJlbnQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0NVUlJFTlQnO1xyXG4gICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuTm9DaGFuZ2U6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ05PX0NIQU5HRSc7XHJcbiAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5SZW1vdmVkOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdSRU1PVkUnO1xyXG4gICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVzZXQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1JFU0VUJztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGU6ICcgKyBzdGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvVGVzdFdhdGNoQ2hhbmdlID0gZnVuY3Rpb24gKHdhdGNoQ2hhbmdlKSB7XHJcbiAgICAgICAgaWYgKHdhdGNoQ2hhbmdlIGluc3RhbmNlb2YgRXhpc3RlbmNlRmlsdGVyQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBmaWx0ZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBjb3VudDogd2F0Y2hDaGFuZ2UuZXhpc3RlbmNlRmlsdGVyLmNvdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldElkOiB3YXRjaENoYW5nZS50YXJnZXRJZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAod2F0Y2hDaGFuZ2UgaW5zdGFuY2VvZiBEb2N1bWVudFdhdGNoQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGlmICh3YXRjaENoYW5nZS5uZXdEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRvYyA9IHdhdGNoQ2hhbmdlLm5ld0RvYztcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRDaGFuZ2U6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMudG9OYW1lKGRvYy5rZXkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzOiB0aGlzLnRvRmllbGRzKGRvYy5kYXRhKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRpbWU6IHRoaXMudG9WZXJzaW9uKGRvYy52ZXJzaW9uKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZHM6IHdhdGNoQ2hhbmdlLnVwZGF0ZWRUYXJnZXRJZHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWRUYXJnZXRJZHM6IHdhdGNoQ2hhbmdlLnJlbW92ZWRUYXJnZXRJZHNcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHdhdGNoQ2hhbmdlLm5ld0RvYyBpbnN0YW5jZW9mIE5vRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkb2MgPSB3YXRjaENoYW5nZS5uZXdEb2M7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50RGVsZXRlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50OiB0aGlzLnRvTmFtZShkb2Mua2V5KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZFRpbWU6IHRoaXMudG9WZXJzaW9uKGRvYy52ZXJzaW9uKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZFRhcmdldElkczogd2F0Y2hDaGFuZ2UucmVtb3ZlZFRhcmdldElkc1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAod2F0Y2hDaGFuZ2UubmV3RG9jID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50UmVtb3ZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50OiB0aGlzLnRvTmFtZSh3YXRjaENoYW5nZS5rZXkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkVGFyZ2V0SWRzOiB3YXRjaENoYW5nZS5yZW1vdmVkVGFyZ2V0SWRzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAod2F0Y2hDaGFuZ2UgaW5zdGFuY2VvZiBXYXRjaFRhcmdldENoYW5nZSkge1xyXG4gICAgICAgICAgICB2YXIgY2F1c2UgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGlmICh3YXRjaENoYW5nZS5jYXVzZSkge1xyXG4gICAgICAgICAgICAgICAgY2F1c2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29kZTogbWFwUnBjQ29kZUZyb21Db2RlKHdhdGNoQ2hhbmdlLmNhdXNlLmNvZGUpLFxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHdhdGNoQ2hhbmdlLmNhdXNlLm1lc3NhZ2VcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldENoYW5nZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldENoYW5nZVR5cGU6IHRoaXMudG9XYXRjaFRhcmdldENoYW5nZVN0YXRlKHdhdGNoQ2hhbmdlLnN0YXRlKSxcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZHM6IHdhdGNoQ2hhbmdlLnRhcmdldElkcyxcclxuICAgICAgICAgICAgICAgICAgICByZXN1bWVUb2tlbjogdGhpcy51bnNhZmVDYXN0UHJvdG9CeXRlU3RyaW5nKHdhdGNoQ2hhbmdlLnJlc3VtZVRva2VuKSxcclxuICAgICAgICAgICAgICAgICAgICBjYXVzZTogY2F1c2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhaWwoJ1VucmVjb2duaXplZCB3YXRjaCBjaGFuZ2U6ICcgKyBKU09OLnN0cmluZ2lmeSh3YXRjaENoYW5nZSkpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21XYXRjaENoYW5nZSA9IGZ1bmN0aW9uIChjaGFuZ2UpIHtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55XHJcbiAgICAgICAgdmFyIHR5cGUgPSBjaGFuZ2VbJ3Jlc3BvbnNlX3R5cGUnXTtcclxuICAgICAgICB2YXIgd2F0Y2hDaGFuZ2U7XHJcbiAgICAgICAgaWYgKGhhc1RhZyhjaGFuZ2UsIHR5cGUsICd0YXJnZXRDaGFuZ2UnKSkge1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS50YXJnZXRDaGFuZ2UsICd0YXJnZXRDaGFuZ2UnKTtcclxuICAgICAgICAgICAgLy8gcHJvdG8zIGRlZmF1bHQgdmFsdWUgaXMgdW5zZXQgaW4gSlNPTiAodW5kZWZpbmVkKSwgc28gdXNlICdOT19DSEFOR0UnXHJcbiAgICAgICAgICAgIC8vIGlmIHVuc2V0XHJcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IHRoaXMuZnJvbVdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUoY2hhbmdlLnRhcmdldENoYW5nZS50YXJnZXRDaGFuZ2VUeXBlIHx8ICdOT19DSEFOR0UnKTtcclxuICAgICAgICAgICAgdmFyIHRhcmdldElkcyA9IGNoYW5nZS50YXJnZXRDaGFuZ2UudGFyZ2V0SWRzIHx8IFtdO1xyXG4gICAgICAgICAgICB2YXIgcmVzdW1lVG9rZW4gPSBjaGFuZ2UudGFyZ2V0Q2hhbmdlLnJlc3VtZVRva2VuIHx8IHRoaXMuZW1wdHlCeXRlU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIHZhciBjYXVzZVByb3RvID0gY2hhbmdlLnRhcmdldENoYW5nZS5jYXVzZTtcclxuICAgICAgICAgICAgdmFyIGNhdXNlID0gY2F1c2VQcm90byAmJiB0aGlzLmZyb21ScGNTdGF0dXMoY2F1c2VQcm90byk7XHJcbiAgICAgICAgICAgIHdhdGNoQ2hhbmdlID0gbmV3IFdhdGNoVGFyZ2V0Q2hhbmdlKHN0YXRlLCB0YXJnZXRJZHMsIHJlc3VtZVRva2VuLCBjYXVzZSB8fCBudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKGNoYW5nZSwgdHlwZSwgJ2RvY3VtZW50Q2hhbmdlJykpIHtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZG9jdW1lbnRDaGFuZ2UsICdkb2N1bWVudENoYW5nZScpO1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5kb2N1bWVudENoYW5nZS5kb2N1bWVudCwgJ2RvY3VtZW50Q2hhbmdlLm5hbWUnKTtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZG9jdW1lbnRDaGFuZ2UuZG9jdW1lbnQubmFtZSwgJ2RvY3VtZW50Q2hhbmdlLmRvY3VtZW50Lm5hbWUnKTtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZG9jdW1lbnRDaGFuZ2UuZG9jdW1lbnQudXBkYXRlVGltZSwgJ2RvY3VtZW50Q2hhbmdlLmRvY3VtZW50LnVwZGF0ZVRpbWUnKTtcclxuICAgICAgICAgICAgdmFyIGVudGl0eUNoYW5nZSA9IGNoYW5nZS5kb2N1bWVudENoYW5nZTtcclxuICAgICAgICAgICAgdmFyIGtleSA9IHRoaXMuZnJvbU5hbWUoZW50aXR5Q2hhbmdlLmRvY3VtZW50Lm5hbWUpO1xyXG4gICAgICAgICAgICB2YXIgdmVyc2lvbiA9IHRoaXMuZnJvbVZlcnNpb24oZW50aXR5Q2hhbmdlLmRvY3VtZW50LnVwZGF0ZVRpbWUpO1xyXG4gICAgICAgICAgICB2YXIgZmllbGRzID0gdGhpcy5mcm9tRmllbGRzKGVudGl0eUNoYW5nZS5kb2N1bWVudC5maWVsZHMgfHwge30pO1xyXG4gICAgICAgICAgICB2YXIgZG9jID0gbmV3IERvY3VtZW50KGtleSwgdmVyc2lvbiwgZmllbGRzLCB7fSk7XHJcbiAgICAgICAgICAgIHZhciB1cGRhdGVkVGFyZ2V0SWRzID0gZW50aXR5Q2hhbmdlLnRhcmdldElkcyB8fCBbXTtcclxuICAgICAgICAgICAgdmFyIHJlbW92ZWRUYXJnZXRJZHMgPSBlbnRpdHlDaGFuZ2UucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcclxuICAgICAgICAgICAgd2F0Y2hDaGFuZ2UgPSBuZXcgRG9jdW1lbnRXYXRjaENoYW5nZSh1cGRhdGVkVGFyZ2V0SWRzLCByZW1vdmVkVGFyZ2V0SWRzLCBkb2Mua2V5LCBkb2MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcoY2hhbmdlLCB0eXBlLCAnZG9jdW1lbnREZWxldGUnKSkge1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5kb2N1bWVudERlbGV0ZSwgJ2RvY3VtZW50RGVsZXRlJyk7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmRvY3VtZW50RGVsZXRlLmRvY3VtZW50LCAnZG9jdW1lbnREZWxldGUuZG9jdW1lbnQnKTtcclxuICAgICAgICAgICAgdmFyIGRvY0RlbGV0ZSA9IGNoYW5nZS5kb2N1bWVudERlbGV0ZTtcclxuICAgICAgICAgICAgdmFyIGtleSA9IHRoaXMuZnJvbU5hbWUoZG9jRGVsZXRlLmRvY3VtZW50KTtcclxuICAgICAgICAgICAgdmFyIHZlcnNpb24gPSBkb2NEZWxldGUucmVhZFRpbWVcclxuICAgICAgICAgICAgICAgID8gdGhpcy5mcm9tVmVyc2lvbihkb2NEZWxldGUucmVhZFRpbWUpXHJcbiAgICAgICAgICAgICAgICA6IFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCk7XHJcbiAgICAgICAgICAgIHZhciBkb2MgPSBuZXcgTm9Eb2N1bWVudChrZXksIHZlcnNpb24pO1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZFRhcmdldElkcyA9IGRvY0RlbGV0ZS5yZW1vdmVkVGFyZ2V0SWRzIHx8IFtdO1xyXG4gICAgICAgICAgICB3YXRjaENoYW5nZSA9IG5ldyBEb2N1bWVudFdhdGNoQ2hhbmdlKFtdLCByZW1vdmVkVGFyZ2V0SWRzLCBkb2Mua2V5LCBkb2MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcoY2hhbmdlLCB0eXBlLCAnZG9jdW1lbnRSZW1vdmUnKSkge1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5kb2N1bWVudFJlbW92ZSwgJ2RvY3VtZW50UmVtb3ZlJyk7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmRvY3VtZW50UmVtb3ZlLmRvY3VtZW50LCAnZG9jdW1lbnRSZW1vdmUnKTtcclxuICAgICAgICAgICAgdmFyIGRvY1JlbW92ZSA9IGNoYW5nZS5kb2N1bWVudFJlbW92ZTtcclxuICAgICAgICAgICAgdmFyIGtleSA9IHRoaXMuZnJvbU5hbWUoZG9jUmVtb3ZlLmRvY3VtZW50KTtcclxuICAgICAgICAgICAgdmFyIHJlbW92ZWRUYXJnZXRJZHMgPSBkb2NSZW1vdmUucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcclxuICAgICAgICAgICAgd2F0Y2hDaGFuZ2UgPSBuZXcgRG9jdW1lbnRXYXRjaENoYW5nZShbXSwgcmVtb3ZlZFRhcmdldElkcywga2V5LCBudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKGNoYW5nZSwgdHlwZSwgJ2ZpbHRlcicpKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogaW1wbGVtZW50IGV4aXN0ZW5jZSBmaWx0ZXIgcGFyc2luZyB3aXRoIHN0cmF0ZWd5LlxyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5maWx0ZXIsICdmaWx0ZXInKTtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZmlsdGVyLnRhcmdldElkLCAnZmlsdGVyLnRhcmdldElkJyk7XHJcbiAgICAgICAgICAgIHZhciBmaWx0ZXIgPSBjaGFuZ2UuZmlsdGVyO1xyXG4gICAgICAgICAgICB2YXIgY291bnQgPSBmaWx0ZXIuY291bnQgfHwgMDtcclxuICAgICAgICAgICAgdmFyIGV4aXN0ZW5jZUZpbHRlciA9IG5ldyBFeGlzdGVuY2VGaWx0ZXIoY291bnQpO1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBmaWx0ZXIudGFyZ2V0SWQ7XHJcbiAgICAgICAgICAgIHdhdGNoQ2hhbmdlID0gbmV3IEV4aXN0ZW5jZUZpbHRlckNoYW5nZSh0YXJnZXRJZCwgZXhpc3RlbmNlRmlsdGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIGNoYW5nZSB0eXBlICcgKyBKU09OLnN0cmluZ2lmeShjaGFuZ2UpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHdhdGNoQ2hhbmdlO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21XYXRjaFRhcmdldENoYW5nZVN0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XHJcbiAgICAgICAgaWYgKHN0YXRlID09PSAnTk9fQ0hBTkdFJykge1xyXG4gICAgICAgICAgICByZXR1cm4gV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5Ob0NoYW5nZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc3RhdGUgPT09ICdBREQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLkFkZGVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChzdGF0ZSA9PT0gJ1JFTU9WRScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVtb3ZlZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc3RhdGUgPT09ICdDVVJSRU5UJykge1xyXG4gICAgICAgICAgICByZXR1cm4gV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5DdXJyZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChzdGF0ZSA9PT0gJ1JFU0VUJykge1xyXG4gICAgICAgICAgICByZXR1cm4gV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5SZXNldDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdHb3QgdW5leHBlY3RlZCBUYXJnZXRDaGFuZ2Uuc3RhdGU6ICcgKyBzdGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnZlcnNpb25Gcm9tTGlzdGVuUmVzcG9uc2UgPSBmdW5jdGlvbiAoY2hhbmdlKSB7XHJcbiAgICAgICAgLy8gV2UgaGF2ZSBvbmx5IHJlYWNoZWQgYSBjb25zaXN0ZW50IHNuYXBzaG90IGZvciB0aGUgZW50aXJlIHN0cmVhbSBpZiB0aGVyZVxyXG4gICAgICAgIC8vIGlzIGEgcmVhZF90aW1lIHNldCBhbmQgaXQgYXBwbGllcyB0byBhbGwgdGFyZ2V0cyAoaS5lLiB0aGUgbGlzdCBvZlxyXG4gICAgICAgIC8vIHRhcmdldHMgaXMgZW1wdHkpLiBUaGUgYmFja2VuZCBpcyBndWFyYW50ZWVkIHRvIHNlbmQgc3VjaCByZXNwb25zZXMuXHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxyXG4gICAgICAgIHZhciB0eXBlID0gY2hhbmdlWydyZXNwb25zZV90eXBlJ107XHJcbiAgICAgICAgaWYgKCFoYXNUYWcoY2hhbmdlLCB0eXBlLCAndGFyZ2V0Q2hhbmdlJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5NSU47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0YXJnZXRDaGFuZ2UgPSBjaGFuZ2UudGFyZ2V0Q2hhbmdlO1xyXG4gICAgICAgIGlmICh0YXJnZXRDaGFuZ2UudGFyZ2V0SWRzICYmIHRhcmdldENoYW5nZS50YXJnZXRJZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTbmFwc2hvdFZlcnNpb24uTUlOO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRhcmdldENoYW5nZS5yZWFkVGltZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uLk1JTjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZnJvbVZlcnNpb24odGFyZ2V0Q2hhbmdlLnJlYWRUaW1lKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b011dGF0aW9uID0gZnVuY3Rpb24gKG11dGF0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVzdWx0O1xyXG4gICAgICAgIGlmIChtdXRhdGlvbiBpbnN0YW5jZW9mIFNldE11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZTogdGhpcy50b011dGF0aW9uRG9jdW1lbnQobXV0YXRpb24ua2V5LCBtdXRhdGlvbi52YWx1ZSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobXV0YXRpb24gaW5zdGFuY2VvZiBEZWxldGVNdXRhdGlvbikge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7IGRlbGV0ZTogdGhpcy50b05hbWUobXV0YXRpb24ua2V5KSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtdXRhdGlvbiBpbnN0YW5jZW9mIFBhdGNoTXV0YXRpb24pIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlOiB0aGlzLnRvTXV0YXRpb25Eb2N1bWVudChtdXRhdGlvbi5rZXksIG11dGF0aW9uLmRhdGEpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlTWFzazogdGhpcy50b0RvY3VtZW50TWFzayhtdXRhdGlvbi5maWVsZE1hc2spXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG11dGF0aW9uIGluc3RhbmNlb2YgVHJhbnNmb3JtTXV0YXRpb24pIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQ6IHRoaXMudG9OYW1lKG11dGF0aW9uLmtleSksXHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRUcmFuc2Zvcm1zOiBtdXRhdGlvbi5maWVsZFRyYW5zZm9ybXMubWFwKGZ1bmN0aW9uICh0cmFuc2Zvcm0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnRvRmllbGRUcmFuc2Zvcm0odHJhbnNmb3JtKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gbXV0YXRpb24gdHlwZSAnICsgbXV0YXRpb24udHlwZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbXV0YXRpb24ucHJlY29uZGl0aW9uLmlzTm9uZSkge1xyXG4gICAgICAgICAgICByZXN1bHQuY3VycmVudERvY3VtZW50ID0gdGhpcy50b1ByZWNvbmRpdGlvbihtdXRhdGlvbi5wcmVjb25kaXRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21NdXRhdGlvbiA9IGZ1bmN0aW9uIChwcm90bykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHByZWNvbmRpdGlvbiA9IHByb3RvLmN1cnJlbnREb2N1bWVudFxyXG4gICAgICAgICAgICA/IHRoaXMuZnJvbVByZWNvbmRpdGlvbihwcm90by5jdXJyZW50RG9jdW1lbnQpXHJcbiAgICAgICAgICAgIDogUHJlY29uZGl0aW9uLk5PTkU7XHJcbiAgICAgICAgaWYgKHByb3RvLnVwZGF0ZSkge1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KHByb3RvLnVwZGF0ZS5uYW1lLCAnbmFtZScpO1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5mcm9tTmFtZShwcm90by51cGRhdGUubmFtZSk7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZnJvbUZpZWxkcyhwcm90by51cGRhdGUuZmllbGRzIHx8IHt9KTtcclxuICAgICAgICAgICAgaWYgKHByb3RvLnVwZGF0ZU1hc2spIHtcclxuICAgICAgICAgICAgICAgIHZhciBmaWVsZE1hc2sgPSB0aGlzLmZyb21Eb2N1bWVudE1hc2socHJvdG8udXBkYXRlTWFzayk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFBhdGNoTXV0YXRpb24oa2V5LCB2YWx1ZSwgZmllbGRNYXNrLCBwcmVjb25kaXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTZXRNdXRhdGlvbihrZXksIHZhbHVlLCBwcmVjb25kaXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHByb3RvLmRlbGV0ZSkge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5mcm9tTmFtZShwcm90by5kZWxldGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERlbGV0ZU11dGF0aW9uKGtleSwgcHJlY29uZGl0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocHJvdG8udHJhbnNmb3JtKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzLmZyb21OYW1lKHByb3RvLnRyYW5zZm9ybS5kb2N1bWVudCk7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZFRyYW5zZm9ybXMgPSBwcm90by50cmFuc2Zvcm0uZmllbGRUcmFuc2Zvcm1zLm1hcChmdW5jdGlvbiAodHJhbnNmb3JtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZnJvbUZpZWxkVHJhbnNmb3JtKHRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBhc3NlcnQocHJlY29uZGl0aW9uLmV4aXN0cyA9PT0gdHJ1ZSwgJ1RyYW5zZm9ybXMgb25seSBzdXBwb3J0IHByZWNvbmRpdGlvbiBcImV4aXN0cyA9PSB0cnVlXCInKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2Zvcm1NdXRhdGlvbihrZXksIGZpZWxkVHJhbnNmb3Jtcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgndW5rbm93biBtdXRhdGlvbiBwcm90bzogJyArIEpTT04uc3RyaW5naWZ5KHByb3RvKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvUHJlY29uZGl0aW9uID0gZnVuY3Rpb24gKHByZWNvbmRpdGlvbikge1xyXG4gICAgICAgIGFzc2VydCghcHJlY29uZGl0aW9uLmlzTm9uZSwgXCJDYW4ndCBzZXJpYWxpemUgYW4gZW1wdHkgcHJlY29uZGl0aW9uXCIpO1xyXG4gICAgICAgIGlmIChwcmVjb25kaXRpb24udXBkYXRlVGltZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVUaW1lOiB0aGlzLnRvVmVyc2lvbihwcmVjb25kaXRpb24udXBkYXRlVGltZSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocHJlY29uZGl0aW9uLmV4aXN0cyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGV4aXN0czogcHJlY29uZGl0aW9uLmV4aXN0cyB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gcHJlY29uZGl0aW9uJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21QcmVjb25kaXRpb24gPSBmdW5jdGlvbiAocHJlY29uZGl0aW9uKSB7XHJcbiAgICAgICAgaWYgKHByZWNvbmRpdGlvbi51cGRhdGVUaW1lICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByZWNvbmRpdGlvbi51cGRhdGVUaW1lKHRoaXMuZnJvbVZlcnNpb24ocHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocHJlY29uZGl0aW9uLmV4aXN0cyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcmVjb25kaXRpb24uZXhpc3RzKHByZWNvbmRpdGlvbi5leGlzdHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByZWNvbmRpdGlvbi5OT05FO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tV3JpdGVSZXN1bHQgPSBmdW5jdGlvbiAocHJvdG8sIGNvbW1pdFRpbWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIE5PVEU6IERlbGV0ZXMgZG9uJ3QgaGF2ZSBhbiB1cGRhdGVUaW1lLlxyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gcHJvdG8udXBkYXRlVGltZVxyXG4gICAgICAgICAgICA/IHRoaXMuZnJvbVZlcnNpb24ocHJvdG8udXBkYXRlVGltZSlcclxuICAgICAgICAgICAgOiB0aGlzLmZyb21WZXJzaW9uKGNvbW1pdFRpbWUpO1xyXG4gICAgICAgIHZhciB0cmFuc2Zvcm1SZXN1bHRzID0gbnVsbDtcclxuICAgICAgICBpZiAocHJvdG8udHJhbnNmb3JtUmVzdWx0cyAmJiBwcm90by50cmFuc2Zvcm1SZXN1bHRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtUmVzdWx0cyA9IHByb3RvLnRyYW5zZm9ybVJlc3VsdHMubWFwKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5mcm9tVmFsdWUocmVzdWx0KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgTXV0YXRpb25SZXN1bHQodmVyc2lvbiwgdHJhbnNmb3JtUmVzdWx0cyk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVdyaXRlUmVzdWx0cyA9IGZ1bmN0aW9uIChwcm90b3MsIGNvbW1pdFRpbWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChwcm90b3MgJiYgcHJvdG9zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgYXNzZXJ0KGNvbW1pdFRpbWUgIT09IHVuZGVmaW5lZCwgJ1JlY2VpdmVkIGEgd3JpdGUgcmVzdWx0IHdpdGhvdXQgYSBjb21taXQgdGltZScpO1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvdG9zLm1hcChmdW5jdGlvbiAocHJvdG8pIHsgcmV0dXJuIF90aGlzLmZyb21Xcml0ZVJlc3VsdChwcm90bywgY29tbWl0VGltZSk7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0ZpZWxkVHJhbnNmb3JtID0gZnVuY3Rpb24gKGZpZWxkVHJhbnNmb3JtKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgdHJhbnNmb3JtID0gZmllbGRUcmFuc2Zvcm0udHJhbnNmb3JtO1xyXG4gICAgICAgIGlmICh0cmFuc2Zvcm0gaW5zdGFuY2VvZiBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGZpZWxkUGF0aDogZmllbGRUcmFuc2Zvcm0uZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBzZXRUb1NlcnZlclZhbHVlOiAnUkVRVUVTVF9USU1FJ1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0cmFuc2Zvcm0gaW5zdGFuY2VvZiBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZFBhdGg6IGZpZWxkVHJhbnNmb3JtLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgYXBwZW5kTWlzc2luZ0VsZW1lbnRzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiB0cmFuc2Zvcm0uZWxlbWVudHMubWFwKGZ1bmN0aW9uICh2KSB7IHJldHVybiBfdGhpcy50b1ZhbHVlKHYpOyB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0cmFuc2Zvcm0gaW5zdGFuY2VvZiBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZmllbGRQYXRoOiBmaWVsZFRyYW5zZm9ybS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHJlbW92ZUFsbEZyb21BcnJheToge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlczogdHJhbnNmb3JtLmVsZW1lbnRzLm1hcChmdW5jdGlvbiAodikgeyByZXR1cm4gX3RoaXMudG9WYWx1ZSh2KTsgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGZhaWwoJ1Vua25vd24gdHJhbnNmb3JtOiAnICsgZmllbGRUcmFuc2Zvcm0udHJhbnNmb3JtKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbUZpZWxkVHJhbnNmb3JtID0gZnVuY3Rpb24gKHByb3RvKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IFdlIG5lZWQgdG8gbWF0Y2ggZ2VuZXJhdGVkIFByb3RvIHR5cGVzLlxyXG4gICAgICAgIHZhciB0eXBlID0gcHJvdG9bJ3RyYW5zZm9ybV90eXBlJ107XHJcbiAgICAgICAgdmFyIHRyYW5zZm9ybSA9IG51bGw7XHJcbiAgICAgICAgaWYgKGhhc1RhZyhwcm90bywgdHlwZSwgJ3NldFRvU2VydmVyVmFsdWUnKSkge1xyXG4gICAgICAgICAgICBhc3NlcnQocHJvdG8uc2V0VG9TZXJ2ZXJWYWx1ZSA9PT0gJ1JFUVVFU1RfVElNRScsICdVbmtub3duIHNlcnZlciB2YWx1ZSB0cmFuc2Zvcm0gcHJvdG86ICcgKyBKU09OLnN0cmluZ2lmeShwcm90bykpO1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm0gPSBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0uaW5zdGFuY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhwcm90bywgdHlwZSwgJ2FwcGVuZE1pc3NpbmdFbGVtZW50cycpKSB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZXMkJDEgPSBwcm90by5hcHBlbmRNaXNzaW5nRWxlbWVudHMudmFsdWVzIHx8IFtdO1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm0gPSBuZXcgQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbih2YWx1ZXMkJDEubWFwKGZ1bmN0aW9uICh2KSB7IHJldHVybiBfdGhpcy5mcm9tVmFsdWUodik7IH0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKHByb3RvLCB0eXBlLCAncmVtb3ZlQWxsRnJvbUFycmF5JykpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlcyQkMSA9IHByb3RvLnJlbW92ZUFsbEZyb21BcnJheS52YWx1ZXMgfHwgW107XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybSA9IG5ldyBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbih2YWx1ZXMkJDEubWFwKGZ1bmN0aW9uICh2KSB7IHJldHVybiBfdGhpcy5mcm9tVmFsdWUodik7IH0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ1Vua25vd24gdHJhbnNmb3JtIHByb3RvOiAnICsgSlNPTi5zdHJpbmdpZnkocHJvdG8pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGZpZWxkUGF0aCA9IEZpZWxkUGF0aC5mcm9tU2VydmVyRm9ybWF0KHByb3RvLmZpZWxkUGF0aCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFRyYW5zZm9ybShmaWVsZFBhdGgsIHRyYW5zZm9ybSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9Eb2N1bWVudHNUYXJnZXQgPSBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICByZXR1cm4geyBkb2N1bWVudHM6IFt0aGlzLnRvUXVlcnlQYXRoKHF1ZXJ5LnBhdGgpXSB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21Eb2N1bWVudHNUYXJnZXQgPSBmdW5jdGlvbiAoZG9jdW1lbnRzVGFyZ2V0KSB7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gZG9jdW1lbnRzVGFyZ2V0LmRvY3VtZW50cy5sZW5ndGg7XHJcbiAgICAgICAgYXNzZXJ0KGNvdW50ID09PSAxLCAnRG9jdW1lbnRzVGFyZ2V0IGNvbnRhaW5lZCBvdGhlciB0aGFuIDEgZG9jdW1lbnQ6ICcgKyBjb3VudCk7XHJcbiAgICAgICAgdmFyIG5hbWUgPSBkb2N1bWVudHNUYXJnZXQuZG9jdW1lbnRzWzBdO1xyXG4gICAgICAgIHJldHVybiBRdWVyeS5hdFBhdGgodGhpcy5mcm9tUXVlcnlQYXRoKG5hbWUpKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1F1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XHJcbiAgICAgICAgLy8gRGlzc2VjdCB0aGUgcGF0aCBpbnRvIHBhcmVudCwgY29sbGVjdGlvbklkLCBhbmQgb3B0aW9uYWwga2V5IGZpbHRlci5cclxuICAgICAgICB2YXIgcmVzdWx0ID0geyBzdHJ1Y3R1cmVkUXVlcnk6IHt9IH07XHJcbiAgICAgICAgaWYgKHF1ZXJ5LnBhdGguaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5wYXJlbnQgPSB0aGlzLnRvUXVlcnlQYXRoKFJlc291cmNlUGF0aC5FTVBUWV9QQVRIKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gcXVlcnkucGF0aDtcclxuICAgICAgICAgICAgYXNzZXJ0KHBhdGgubGVuZ3RoICUgMiAhPT0gMCwgJ0RvY3VtZW50IHF1ZXJpZXMgd2l0aCBmaWx0ZXJzIGFyZSBub3Qgc3VwcG9ydGVkLicpO1xyXG4gICAgICAgICAgICByZXN1bHQucGFyZW50ID0gdGhpcy50b1F1ZXJ5UGF0aChwYXRoLnBvcExhc3QoKSk7XHJcbiAgICAgICAgICAgIHJlc3VsdC5zdHJ1Y3R1cmVkUXVlcnkuZnJvbSA9IFt7IGNvbGxlY3Rpb25JZDogcGF0aC5sYXN0U2VnbWVudCgpIH1dO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgd2hlcmUgPSB0aGlzLnRvRmlsdGVyKHF1ZXJ5LmZpbHRlcnMpO1xyXG4gICAgICAgIGlmICh3aGVyZSkge1xyXG4gICAgICAgICAgICByZXN1bHQuc3RydWN0dXJlZFF1ZXJ5LndoZXJlID0gd2hlcmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBvcmRlckJ5ID0gdGhpcy50b09yZGVyKHF1ZXJ5Lm9yZGVyQnkpO1xyXG4gICAgICAgIGlmIChvcmRlckJ5KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5zdHJ1Y3R1cmVkUXVlcnkub3JkZXJCeSA9IG9yZGVyQnk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsaW1pdCA9IHRoaXMudG9JbnQzMlZhbHVlKHF1ZXJ5LmxpbWl0KTtcclxuICAgICAgICBpZiAobGltaXQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXN1bHQuc3RydWN0dXJlZFF1ZXJ5LmxpbWl0ID0gbGltaXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChxdWVyeS5zdGFydEF0KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5zdHJ1Y3R1cmVkUXVlcnkuc3RhcnRBdCA9IHRoaXMudG9DdXJzb3IocXVlcnkuc3RhcnRBdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChxdWVyeS5lbmRBdCkge1xyXG4gICAgICAgICAgICByZXN1bHQuc3RydWN0dXJlZFF1ZXJ5LmVuZEF0ID0gdGhpcy50b0N1cnNvcihxdWVyeS5lbmRBdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldCkge1xyXG4gICAgICAgIHZhciBwYXRoID0gdGhpcy5mcm9tUXVlcnlQYXRoKHRhcmdldC5wYXJlbnQpO1xyXG4gICAgICAgIHZhciBxdWVyeSA9IHRhcmdldC5zdHJ1Y3R1cmVkUXVlcnk7XHJcbiAgICAgICAgdmFyIGZyb21Db3VudCA9IHF1ZXJ5LmZyb20gPyBxdWVyeS5mcm9tLmxlbmd0aCA6IDA7XHJcbiAgICAgICAgaWYgKGZyb21Db3VudCA+IDApIHtcclxuICAgICAgICAgICAgYXNzZXJ0KGZyb21Db3VudCA9PT0gMSwgJ1N0cnVjdHVyZWRRdWVyeS5mcm9tIHdpdGggbW9yZSB0aGFuIG9uZSBjb2xsZWN0aW9uIGlzIG5vdCBzdXBwb3J0ZWQuJyk7XHJcbiAgICAgICAgICAgIHZhciBmcm9tID0gcXVlcnkuZnJvbVswXTtcclxuICAgICAgICAgICAgcGF0aCA9IHBhdGguY2hpbGQoZnJvbS5jb2xsZWN0aW9uSWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZmlsdGVyQnkgPSBbXTtcclxuICAgICAgICBpZiAocXVlcnkud2hlcmUpIHtcclxuICAgICAgICAgICAgZmlsdGVyQnkgPSB0aGlzLmZyb21GaWx0ZXIocXVlcnkud2hlcmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgb3JkZXJCeSA9IFtdO1xyXG4gICAgICAgIGlmIChxdWVyeS5vcmRlckJ5KSB7XHJcbiAgICAgICAgICAgIG9yZGVyQnkgPSB0aGlzLmZyb21PcmRlcihxdWVyeS5vcmRlckJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGxpbWl0ID0gbnVsbDtcclxuICAgICAgICBpZiAocXVlcnkubGltaXQpIHtcclxuICAgICAgICAgICAgbGltaXQgPSB0aGlzLmZyb21JbnQzMlZhbHVlKHF1ZXJ5LmxpbWl0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHN0YXJ0QXQgPSBudWxsO1xyXG4gICAgICAgIGlmIChxdWVyeS5zdGFydEF0KSB7XHJcbiAgICAgICAgICAgIHN0YXJ0QXQgPSB0aGlzLmZyb21DdXJzb3IocXVlcnkuc3RhcnRBdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBlbmRBdCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHF1ZXJ5LmVuZEF0KSB7XHJcbiAgICAgICAgICAgIGVuZEF0ID0gdGhpcy5mcm9tQ3Vyc29yKHF1ZXJ5LmVuZEF0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeShwYXRoLCBvcmRlckJ5LCBmaWx0ZXJCeSwgbGltaXQsIHN0YXJ0QXQsIGVuZEF0KTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0xpc3RlblJlcXVlc3RMYWJlbHMgPSBmdW5jdGlvbiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdGhpcy50b0xhYmVsKHF1ZXJ5RGF0YS5wdXJwb3NlKTtcclxuICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAnZ29vZy1saXN0ZW4tdGFncyc6IHZhbHVlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvTGFiZWwgPSBmdW5jdGlvbiAocHVycG9zZSkge1xyXG4gICAgICAgIHN3aXRjaCAocHVycG9zZSkge1xyXG4gICAgICAgICAgICBjYXNlIFF1ZXJ5UHVycG9zZS5MaXN0ZW46XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgY2FzZSBRdWVyeVB1cnBvc2UuRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2g6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2V4aXN0ZW5jZS1maWx0ZXItbWlzbWF0Y2gnO1xyXG4gICAgICAgICAgICBjYXNlIFF1ZXJ5UHVycG9zZS5MaW1ib1Jlc29sdXRpb246XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2xpbWJvLWRvY3VtZW50JztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbnJlY29nbml6ZWQgcXVlcnkgcHVycG9zZTogJyArIHB1cnBvc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1RhcmdldCA9IGZ1bmN0aW9uIChxdWVyeURhdGEpIHtcclxuICAgICAgICB2YXIgcmVzdWx0O1xyXG4gICAgICAgIHZhciBxdWVyeSA9IHF1ZXJ5RGF0YS5xdWVyeTtcclxuICAgICAgICBpZiAocXVlcnkuaXNEb2N1bWVudFF1ZXJ5KCkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0geyBkb2N1bWVudHM6IHRoaXMudG9Eb2N1bWVudHNUYXJnZXQocXVlcnkpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7IHF1ZXJ5OiB0aGlzLnRvUXVlcnlUYXJnZXQocXVlcnkpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlc3VsdC50YXJnZXRJZCA9IHF1ZXJ5RGF0YS50YXJnZXRJZDtcclxuICAgICAgICBpZiAocXVlcnlEYXRhLnJlc3VtZVRva2VuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcmVzdWx0LnJlc3VtZVRva2VuID0gdGhpcy51bnNhZmVDYXN0UHJvdG9CeXRlU3RyaW5nKHF1ZXJ5RGF0YS5yZXN1bWVUb2tlbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9GaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVycykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGZpbHRlcnMubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdmFyIHByb3RvcyA9IGZpbHRlcnMubWFwKGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbHRlciBpbnN0YW5jZW9mIFJlbGF0aW9uRmlsdGVyXHJcbiAgICAgICAgICAgICAgICA/IF90aGlzLnRvUmVsYXRpb25GaWx0ZXIoZmlsdGVyKVxyXG4gICAgICAgICAgICAgICAgOiBfdGhpcy50b1VuYXJ5RmlsdGVyKGZpbHRlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHByb3Rvcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByb3Rvc1swXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHsgY29tcG9zaXRlRmlsdGVyOiB7IG9wOiAnQU5EJywgZmlsdGVyczogcHJvdG9zIH0gfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFmaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChmaWx0ZXIudW5hcnlGaWx0ZXIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW3RoaXMuZnJvbVVuYXJ5RmlsdGVyKGZpbHRlcildO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChmaWx0ZXIuZmllbGRGaWx0ZXIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW3RoaXMuZnJvbVJlbGF0aW9uRmlsdGVyKGZpbHRlcildO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChmaWx0ZXIuY29tcG9zaXRlRmlsdGVyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbHRlci5jb21wb3NpdGVGaWx0ZXJcclxuICAgICAgICAgICAgICAgIC5maWx0ZXJzLm1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gX3RoaXMuZnJvbUZpbHRlcihmKTsgfSlcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtLCBjdXJyZW50KSB7IHJldHVybiBhY2N1bS5jb25jYXQoY3VycmVudCk7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gZmlsdGVyOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvT3JkZXIgPSBmdW5jdGlvbiAob3JkZXJCeXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChvcmRlckJ5cy5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICByZXR1cm4gb3JkZXJCeXMubWFwKGZ1bmN0aW9uIChvcmRlcikgeyByZXR1cm4gX3RoaXMudG9Qcm9wZXJ0eU9yZGVyKG9yZGVyKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbU9yZGVyID0gZnVuY3Rpb24gKG9yZGVyQnlzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gb3JkZXJCeXMubWFwKGZ1bmN0aW9uIChvcmRlcikgeyByZXR1cm4gX3RoaXMuZnJvbVByb3BlcnR5T3JkZXIob3JkZXIpOyB9KTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0N1cnNvciA9IGZ1bmN0aW9uIChjdXJzb3IpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGJlZm9yZTogY3Vyc29yLmJlZm9yZSxcclxuICAgICAgICAgICAgdmFsdWVzOiBjdXJzb3IucG9zaXRpb24ubWFwKGZ1bmN0aW9uIChjb21wb25lbnQpIHsgcmV0dXJuIF90aGlzLnRvVmFsdWUoY29tcG9uZW50KTsgfSlcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21DdXJzb3IgPSBmdW5jdGlvbiAoY3Vyc29yKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgYmVmb3JlID0gISFjdXJzb3IuYmVmb3JlO1xyXG4gICAgICAgIHZhciBwb3NpdGlvbiA9IGN1cnNvci52YWx1ZXMubWFwKGZ1bmN0aW9uIChjb21wb25lbnQpIHsgcmV0dXJuIF90aGlzLmZyb21WYWx1ZShjb21wb25lbnQpOyB9KTtcclxuICAgICAgICByZXR1cm4gbmV3IEJvdW5kKHBvc2l0aW9uLCBiZWZvcmUpO1xyXG4gICAgfTtcclxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvRGlyZWN0aW9uID0gZnVuY3Rpb24gKGRpcikge1xyXG4gICAgICAgIHJldHVybiBESVJFQ1RJT05TW2Rpci5uYW1lXTtcclxuICAgIH07XHJcbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRGlyZWN0aW9uID0gZnVuY3Rpb24gKGRpcikge1xyXG4gICAgICAgIHN3aXRjaCAoZGlyKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ0FTQ0VORElORyc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gRGlyZWN0aW9uLkFTQ0VORElORztcclxuICAgICAgICAgICAgY2FzZSAnREVTQ0VORElORyc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gRGlyZWN0aW9uLkRFU0NFTkRJTkc7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b09wZXJhdG9yTmFtZSA9IGZ1bmN0aW9uIChvcCkge1xyXG4gICAgICAgIHJldHVybiBPUEVSQVRPUlNbb3AubmFtZV07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbU9wZXJhdG9yTmFtZSA9IGZ1bmN0aW9uIChvcCkge1xyXG4gICAgICAgIHN3aXRjaCAob3ApIHtcclxuICAgICAgICAgICAgY2FzZSAnRVFVQUwnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuRVFVQUw7XHJcbiAgICAgICAgICAgIGNhc2UgJ0dSRUFURVJfVEhBTic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5HUkVBVEVSX1RIQU47XHJcbiAgICAgICAgICAgIGNhc2UgJ0dSRUFURVJfVEhBTl9PUl9FUVVBTCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5HUkVBVEVSX1RIQU5fT1JfRVFVQUw7XHJcbiAgICAgICAgICAgIGNhc2UgJ0xFU1NfVEhBTic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5MRVNTX1RIQU47XHJcbiAgICAgICAgICAgIGNhc2UgJ0xFU1NfVEhBTl9PUl9FUVVBTCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5MRVNTX1RIQU5fT1JfRVFVQUw7XHJcbiAgICAgICAgICAgIGNhc2UgJ0FSUkFZX0NPTlRBSU5TJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TO1xyXG4gICAgICAgICAgICBjYXNlICdPUEVSQVRPUl9VTlNQRUNJRklFRCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5zcGVjaWZpZWQgcmVsYXRpb24nKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIHJlbGF0aW9uJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvRmllbGRQYXRoUmVmZXJlbmNlID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICByZXR1cm4geyBmaWVsZFBhdGg6IHBhdGguY2Fub25pY2FsU3RyaW5nKCkgfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRmllbGRQYXRoUmVmZXJlbmNlID0gZnVuY3Rpb24gKGZpZWxkUmVmZXJlbmNlKSB7XHJcbiAgICAgICAgcmV0dXJuIEZpZWxkUGF0aC5mcm9tU2VydmVyRm9ybWF0KGZpZWxkUmVmZXJlbmNlLmZpZWxkUGF0aCk7XHJcbiAgICB9O1xyXG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9Qcm9wZXJ0eU9yZGVyID0gZnVuY3Rpb24gKG9yZGVyQnkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBmaWVsZDogdGhpcy50b0ZpZWxkUGF0aFJlZmVyZW5jZShvcmRlckJ5LmZpZWxkKSxcclxuICAgICAgICAgICAgZGlyZWN0aW9uOiB0aGlzLnRvRGlyZWN0aW9uKG9yZGVyQnkuZGlyKVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVByb3BlcnR5T3JkZXIgPSBmdW5jdGlvbiAob3JkZXJCeSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgT3JkZXJCeSh0aGlzLmZyb21GaWVsZFBhdGhSZWZlcmVuY2Uob3JkZXJCeS5maWVsZCksIHRoaXMuZnJvbURpcmVjdGlvbihvcmRlckJ5LmRpcmVjdGlvbikpO1xyXG4gICAgfTtcclxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvUmVsYXRpb25GaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgaWYgKGZpbHRlciBpbnN0YW5jZW9mIFJlbGF0aW9uRmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZEZpbHRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiB0aGlzLnRvRmllbGRQYXRoUmVmZXJlbmNlKGZpbHRlci5maWVsZCksXHJcbiAgICAgICAgICAgICAgICAgICAgb3A6IHRoaXMudG9PcGVyYXRvck5hbWUoZmlsdGVyLm9wKSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy50b1ZhbHVlKGZpbHRlci52YWx1ZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbnJlY29nbml6ZWQgZmlsdGVyOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21SZWxhdGlvbkZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFJlbGF0aW9uRmlsdGVyKHRoaXMuZnJvbUZpZWxkUGF0aFJlZmVyZW5jZShmaWx0ZXIuZmllbGRGaWx0ZXIuZmllbGQpLCB0aGlzLmZyb21PcGVyYXRvck5hbWUoZmlsdGVyLmZpZWxkRmlsdGVyLm9wKSwgdGhpcy5mcm9tVmFsdWUoZmlsdGVyLmZpZWxkRmlsdGVyLnZhbHVlKSk7XHJcbiAgICB9O1xyXG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9VbmFyeUZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICBpZiAoZmlsdGVyIGluc3RhbmNlb2YgTmFuRmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB1bmFyeUZpbHRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiB0aGlzLnRvRmllbGRQYXRoUmVmZXJlbmNlKGZpbHRlci5maWVsZCksXHJcbiAgICAgICAgICAgICAgICAgICAgb3A6ICdJU19OQU4nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGZpbHRlciBpbnN0YW5jZW9mIE51bGxGaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IHRoaXMudG9GaWVsZFBhdGhSZWZlcmVuY2UoZmlsdGVyLmZpZWxkKSxcclxuICAgICAgICAgICAgICAgICAgICBvcDogJ0lTX05VTEwnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5yZWNvZ25pemVkIGZpbHRlcjogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tVW5hcnlGaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgc3dpdGNoIChmaWx0ZXIudW5hcnlGaWx0ZXIub3ApIHtcclxuICAgICAgICAgICAgY2FzZSAnSVNfTkFOJzpcclxuICAgICAgICAgICAgICAgIHZhciBuYW5GaWVsZCA9IHRoaXMuZnJvbUZpZWxkUGF0aFJlZmVyZW5jZShmaWx0ZXIudW5hcnlGaWx0ZXIuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBOYW5GaWx0ZXIobmFuRmllbGQpO1xyXG4gICAgICAgICAgICBjYXNlICdJU19OVUxMJzpcclxuICAgICAgICAgICAgICAgIHZhciBudWxsRmllbGQgPSB0aGlzLmZyb21GaWVsZFBhdGhSZWZlcmVuY2UoZmlsdGVyLnVuYXJ5RmlsdGVyLmZpZWxkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTnVsbEZpbHRlcihudWxsRmllbGQpO1xyXG4gICAgICAgICAgICBjYXNlICdPUEVSQVRPUl9VTlNQRUNJRklFRCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5zcGVjaWZpZWQgZmlsdGVyJyk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBmaWx0ZXInKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9Eb2N1bWVudE1hc2sgPSBmdW5jdGlvbiAoZmllbGRNYXNrKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZmllbGRQYXRoczogZmllbGRNYXNrLmZpZWxkcy5tYXAoZnVuY3Rpb24gKGZpZWxkKSB7IHJldHVybiBmaWVsZC5jYW5vbmljYWxTdHJpbmcoKTsgfSlcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21Eb2N1bWVudE1hc2sgPSBmdW5jdGlvbiAocHJvdG8pIHtcclxuICAgICAgICB2YXIgcGF0aHMgPSBwcm90by5maWVsZFBhdGhzIHx8IFtdO1xyXG4gICAgICAgIHZhciBmaWVsZHMgPSBwYXRocy5tYXAoZnVuY3Rpb24gKHBhdGgpIHsgcmV0dXJuIEZpZWxkUGF0aC5mcm9tU2VydmVyRm9ybWF0KHBhdGgpOyB9KTtcclxuICAgICAgICByZXR1cm4gbmV3IEZpZWxkTWFzayhmaWVsZHMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBKc29uUHJvdG9TZXJpYWxpemVyO1xyXG59KCkpO1xyXG4vKipcclxuICogQ2hlY2tzIGZvciBhIHNwZWNpZmljIG9uZW9mIHRhZyBpbiBhIHByb3RvY29sIGJ1ZmZlciBtZXNzYWdlLlxyXG4gKlxyXG4gKiBUaGlzIGludGVudGlvbmFsbHkgYWNjb21tb2RhdGVzIHR3byBkaXN0aW5jdCBjYXNlczpcclxuICpcclxuICogMSkgTWVzc2FnZXMgY29udGFpbmluZyBhIHR5cGUgdGFnOiB0aGVzZSBhcmUgdGhlIGZvcm1hdCBwcm9kdWNlZCBieSBHUlBDIGluXHJcbiAqIHJldHVybiB2YWx1ZXMuIFRoZXNlIG1heSBjb250YWluIGRlZmF1bHQtdmFsdWUgbWFwcGluZ3MgZm9yIGFsbCB0YWdzIGluIHRoZVxyXG4gKiBvbmVvZiBidXQgdGhlIHR5cGUgdGFnIHNwZWNpZmllcyB3aGljaCBvbmUgd2FzIGFjdHVhbGx5IHNldC5cclxuICpcclxuICogMikgTWVzc2FnZXMgdGhhdCBkb24ndCBjb250YWluIGEgdHlwZSB0YWc6IHRoZXNlIGFyZSB0aGUgZm9ybWF0IHJlcXVpcmVkIGJ5XHJcbiAqIEdSUEMgYXMgaW5wdXRzLiBJZiB3ZSBlbWl0dGVkIG9iamVjdHMgd2l0aCB0eXBlIHRhZ3MsIFByb3RvQnVmLmpzIHdvdWxkXHJcbiAqIGNob2tlIGNsYWltaW5nIHRoYXQgdGhlIHRhZ3MgYXJlbid0IGZpZWxkcyBpbiB0aGUgTWVzc2FnZS5cclxuICpcclxuICogQWxsb3dpbmcgYm90aCBmb3JtYXRzIGhlcmUgbWFrZXMgdGhlIHNlcmlhbGl6ZXIgYWJsZSB0byBjb25zdW1lIHRoZSBvdXRwdXRzXHJcbiAqIGl0IHByb2R1Y2VzOiBmb3IgYWxsIG1lc3NhZ2VzIGl0IHN1cHBvcnRzLCBmcm9tWCh0b1godmFsdWUpKSA9PSB2YWx1ZS5cclxuICpcclxuICogTm90ZSB0aGF0IGNhc2UgMiBzdWZmZXJzIGZyb20gYW1iaWd1aXR5OiBpZiBtdWx0aXBsZSB0YWdzIGFyZSBwcmVzZW50XHJcbiAqIHdpdGhvdXQgYSB0eXBlIHRhZyB0aGVuIHRoZSBjYWxsZXJzIGFyZSBzdHJ1Y3R1cmVkIGluIHN1Y2ggYSB3YXkgdGhhdCB0aGVcclxuICogZmlyc3QgaW52b2NhdGlvbiB3aWxsIHdpbi4gU2luY2Ugd2Ugb25seSBwYXJzZSBpbiB0aGlzIG1vZGUgd2hlbiBwYXJzaW5nXHJcbiAqIHRoZSBvdXRwdXQgb2YgYSBzZXJpYWxpemUgbWV0aG9kIHRoaXMgd29ya3MsIGJ1dCBpdCdzIG5vdCBhIGdlbmVyYWxcclxuICogc29sdXRpb24uXHJcbiAqXHJcbiAqIFVuZm9ydHVuYXRlbHkgdGhlcmUgaXMgbm8gZ2VuZXJhbCBzb2x1dGlvbiBoZXJlIGJlY2F1c2UgcHJvdG8zIG1ha2VzIGl0XHJcbiAqIGltcG9zc2libGUgdG8gZGlzdGluZ3Vpc2ggdW5zZXQgZnJvbSBleHBsaWNpdGx5IHNldCBmaWVsZHM6IGJvdGggaGF2ZSB0aGVcclxuICogZGVmYXVsdCB2YWx1ZSBmb3IgdGhlIHR5cGUuIFdpdGhvdXQgdGhlIHR5cGUgdGFnIGJ1dCBtdWx0aXBsZSB2YWx1ZSB0YWdzXHJcbiAqIGl0J3MgcG9zc2libGUgdG8gaGF2ZSBkZWZhdWx0IHZhbHVlcyBmb3IgZWFjaCB0YWcgaW4gdGhlIG9uZW9mIGFuZCBub3QgYmVcclxuICogYWJsZSB0byBrbm93IHdoaWNoIHdhcyBhY3R1YWxseSBpbiBlZmZlY3QuXHJcbiAqL1xyXG5mdW5jdGlvbiBoYXNUYWcob2JqLCB0eXBlLCB0YWcpIHtcclxuICAgIHJldHVybiB0eXBlID09PSB0YWcgfHwgKCF0eXBlICYmIHRhZyBpbiBvYmopO1xyXG59XG5cbi8qKlxyXG4gKiBEZXRlY3QgUmVhY3QgTmF0aXZlLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIFJlYWN0TmF0aXZlIGVudmlyb25tZW50IGlzIGRldGVjdGVkLlxyXG4gKi9cclxudmFyIGlzUmVhY3ROYXRpdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICdvYmplY3QnICYmIG5hdmlnYXRvclsncHJvZHVjdCddID09PSAnUmVhY3ROYXRpdmUnKTtcclxufTtcclxuXG52YXIgRVJST1JfTkFNRSA9ICdGaXJlYmFzZUVycm9yJztcclxudmFyIGNhcHR1cmVTdGFja1RyYWNlID0gRXJyb3JcclxuICAgIC5jYXB0dXJlU3RhY2tUcmFjZTtcclxudmFyIEZpcmViYXNlRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJlYmFzZUVycm9yKGNvZGUsIG1lc3NhZ2UpIHtcclxuICAgICAgICB0aGlzLmNvZGUgPSBjb2RlO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XHJcbiAgICAgICAgLy8gV2Ugd2FudCB0aGUgc3RhY2sgdmFsdWUsIGlmIGltcGxlbWVudGVkIGJ5IEVycm9yXHJcbiAgICAgICAgaWYgKGNhcHR1cmVTdGFja1RyYWNlKSB7XHJcbiAgICAgICAgICAgIC8vIFBhdGNoZXMgdGhpcy5zdGFjaywgb21pdHRlZCBjYWxscyBhYm92ZSBFcnJvckZhY3RvcnkjY3JlYXRlXHJcbiAgICAgICAgICAgIGNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIEVycm9yRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJbiBjYXNlIG9mIElFMTEsIHN0YWNrIHdpbGwgYmUgc2V0IG9ubHkgYWZ0ZXIgZXJyb3IgaXMgcmFpc2VkLlxyXG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvc2NyaXB0aW5nL2phdmFzY3JpcHQvcmVmZXJlbmNlL3N0YWNrLXByb3BlcnR5LWVycm9yLWphdmFzY3JpcHRcclxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gRVJST1JfTkFNRTtcclxuICAgICAgICAgICAgICAgIC8vIE1ha2Ugbm9uLWVudW1lcmFibGUgZ2V0dGVyIGZvciB0aGUgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ3N0YWNrJywge1xyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXJyLnN0YWNrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIEZpcmViYXNlRXJyb3I7XHJcbn0oKSk7XHJcbi8vIEJhY2stZG9vciBpbmhlcml0YW5jZVxyXG5GaXJlYmFzZUVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcclxuRmlyZWJhc2VFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBGaXJlYmFzZUVycm9yO1xyXG5GaXJlYmFzZUVycm9yLnByb3RvdHlwZS5uYW1lID0gRVJST1JfTkFNRTtcclxudmFyIEVycm9yRmFjdG9yeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEVycm9yRmFjdG9yeShzZXJ2aWNlLCBzZXJ2aWNlTmFtZSwgZXJyb3JzKSB7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcclxuICAgICAgICB0aGlzLnNlcnZpY2VOYW1lID0gc2VydmljZU5hbWU7XHJcbiAgICAgICAgdGhpcy5lcnJvcnMgPSBlcnJvcnM7XHJcbiAgICAgICAgLy8gTWF0Y2hlcyB7JG5hbWV9LCBieSBkZWZhdWx0LlxyXG4gICAgICAgIHRoaXMucGF0dGVybiA9IC9cXHtcXCQoW159XSspfS9nO1xyXG4gICAgICAgIC8vIGVtcHR5XHJcbiAgICB9XHJcbiAgICBFcnJvckZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uIChjb2RlLCBkYXRhKSB7XHJcbiAgICAgICAgaWYgKGRhdGEgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBkYXRhID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMuZXJyb3JzW2NvZGVdO1xyXG4gICAgICAgIHZhciBmdWxsQ29kZSA9IHRoaXMuc2VydmljZSArICcvJyArIGNvZGU7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2U7XHJcbiAgICAgICAgaWYgKHRlbXBsYXRlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgbWVzc2FnZSA9ICdFcnJvcic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBtZXNzYWdlID0gdGVtcGxhdGUucmVwbGFjZSh0aGlzLnBhdHRlcm4sIGZ1bmN0aW9uIChtYXRjaCwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBkYXRhW2tleV07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlLnRvU3RyaW5nKCkgOiAnPCcgKyBrZXkgKyAnPz4nO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU2VydmljZTogRXJyb3IgbWVzc2FnZSAoc2VydmljZS9jb2RlKS5cclxuICAgICAgICBtZXNzYWdlID0gdGhpcy5zZXJ2aWNlTmFtZSArICc6ICcgKyBtZXNzYWdlICsgJyAoJyArIGZ1bGxDb2RlICsgJykuJztcclxuICAgICAgICB2YXIgZXJyID0gbmV3IEZpcmViYXNlRXJyb3IoZnVsbENvZGUsIG1lc3NhZ2UpO1xyXG4gICAgICAgIC8vIFBvcHVsYXRlIHRoZSBFcnJvciBvYmplY3Qgd2l0aCBtZXNzYWdlIHBhcnRzIGZvciBwcm9ncmFtbWF0aWNcclxuICAgICAgICAvLyBhY2Nlc3NlcyAoZS5nLiwgZS5maWxlKS5cclxuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKCFkYXRhLmhhc093blByb3BlcnR5KHByb3ApIHx8IHByb3Auc2xpY2UoLTEpID09PSAnXycpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVycltwcm9wXSA9IGRhdGFbcHJvcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBlcnI7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEVycm9yRmFjdG9yeTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIENvcHlyaWdodCAyMDExIFRoZSBDbG9zdXJlIExpYnJhcnkgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuLy9cclxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuLy9cclxuLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuLy9cclxuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXHJcbi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbi8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBBYnN0cmFjdCBjcnlwdG9ncmFwaGljIGhhc2ggaW50ZXJmYWNlLlxyXG4gKlxyXG4gKiBTZWUgU2hhMSBhbmQgTWQ1IGZvciBzYW1wbGUgaW1wbGVtZW50YXRpb25zLlxyXG4gKlxyXG4gKi9cclxuLyoqXHJcbiAqIENyZWF0ZSBhIGNyeXB0b2dyYXBoaWMgaGFzaCBpbnN0YW5jZS5cclxuICpcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBzdHJ1Y3RcclxuICovXHJcbnZhciBIYXNoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSGFzaCgpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgYmxvY2sgc2l6ZSBmb3IgdGhlIGhhc2hlci5cclxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuYmxvY2tTaXplID0gLTE7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gSGFzaDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBAZmlsZW92ZXJ2aWV3IFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaC5cclxuICogVmFyaWFibGUgbmFtZXMgZm9sbG93IHRoZSBub3RhdGlvbiBpbiBGSVBTIFBVQiAxODAtMzpcclxuICogaHR0cDovL2NzcmMubmlzdC5nb3YvcHVibGljYXRpb25zL2ZpcHMvZmlwczE4MC0zL2ZpcHMxODAtM19maW5hbC5wZGYuXHJcbiAqXHJcbiAqIFVzYWdlOlxyXG4gKiAgIHZhciBzaGExID0gbmV3IHNoYTEoKTtcclxuICogICBzaGExLnVwZGF0ZShieXRlcyk7XHJcbiAqICAgdmFyIGhhc2ggPSBzaGExLmRpZ2VzdCgpO1xyXG4gKlxyXG4gKiBQZXJmb3JtYW5jZTpcclxuICogICBDaHJvbWUgMjM6ICAgfjQwMCBNYml0L3NcclxuICogICBGaXJlZm94IDE2OiAgfjI1MCBNYml0L3NcclxuICpcclxuICovXHJcbi8qKlxyXG4gKiBTSEEtMSBjcnlwdG9ncmFwaGljIGhhc2ggY29uc3RydWN0b3IuXHJcbiAqXHJcbiAqIFRoZSBwcm9wZXJ0aWVzIGRlY2xhcmVkIGhlcmUgYXJlIGRpc2N1c3NlZCBpbiB0aGUgYWJvdmUgYWxnb3JpdGhtIGRvY3VtZW50LlxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMge0hhc2h9XHJcbiAqIEBmaW5hbFxyXG4gKiBAc3RydWN0XHJcbiAqL1xyXG52YXIgU2hhMSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFNoYTEsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBTaGExKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogSG9sZHMgdGhlIHByZXZpb3VzIHZhbHVlcyBvZiBhY2N1bXVsYXRlZCB2YXJpYWJsZXMgYS1lIGluIHRoZSBjb21wcmVzc19cclxuICAgICAgICAgKiBmdW5jdGlvbi5cclxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5jaGFpbl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGJ1ZmZlciBob2xkaW5nIHRoZSBwYXJ0aWFsbHkgY29tcHV0ZWQgaGFzaCByZXN1bHQuXHJcbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMuYnVmXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFuIGFycmF5IG9mIDgwIGJ5dGVzLCBlYWNoIGEgcGFydCBvZiB0aGUgbWVzc2FnZSB0byBiZSBoYXNoZWQuICBSZWZlcnJlZCB0b1xyXG4gICAgICAgICAqIGFzIHRoZSBtZXNzYWdlIHNjaGVkdWxlIGluIHRoZSBkb2NzLlxyXG4gICAgICAgICAqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLldfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ29udGFpbnMgZGF0YSBuZWVkZWQgdG8gcGFkIG1lc3NhZ2VzIGxlc3MgdGhhbiA2NCBieXRlcy5cclxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5wYWRfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5pbmJ1Zl8gPSAwO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlIHtudW1iZXJ9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMudG90YWxfID0gMDtcclxuICAgICAgICBfdGhpcy5ibG9ja1NpemUgPSA1MTIgLyA4O1xyXG4gICAgICAgIF90aGlzLnBhZF9bMF0gPSAxMjg7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBfdGhpcy5ibG9ja1NpemU7ICsraSkge1xyXG4gICAgICAgICAgICBfdGhpcy5wYWRfW2ldID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgX3RoaXMucmVzZXQoKTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBTaGExLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNoYWluX1swXSA9IDB4Njc0NTIzMDE7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMV0gPSAweGVmY2RhYjg5O1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzJdID0gMHg5OGJhZGNmZTtcclxuICAgICAgICB0aGlzLmNoYWluX1szXSA9IDB4MTAzMjU0NzY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bNF0gPSAweGMzZDJlMWYwO1xyXG4gICAgICAgIHRoaXMuaW5idWZfID0gMDtcclxuICAgICAgICB0aGlzLnRvdGFsXyA9IDA7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbnRlcm5hbCBjb21wcmVzcyBoZWxwZXIgZnVuY3Rpb24uXHJcbiAgICAgKiBAcGFyYW0geyFBcnJheTxudW1iZXI+fCFVaW50OEFycmF5fHN0cmluZ30gYnVmIEJsb2NrIHRvIGNvbXByZXNzLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXI9fSBvcHRfb2Zmc2V0IE9mZnNldCBvZiB0aGUgYmxvY2sgaW4gdGhlIGJ1ZmZlci5cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIFNoYTEucHJvdG90eXBlLmNvbXByZXNzXyA9IGZ1bmN0aW9uIChidWYsIG9wdF9vZmZzZXQpIHtcclxuICAgICAgICBpZiAoIW9wdF9vZmZzZXQpIHtcclxuICAgICAgICAgICAgb3B0X29mZnNldCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBXID0gdGhpcy5XXztcclxuICAgICAgICAvLyBnZXQgMTYgYmlnIGVuZGlhbiB3b3Jkc1xyXG4gICAgICAgIGlmICh0eXBlb2YgYnVmID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8odXNlcik6IFtidWcgODE0MDEyMl0gUmVjZW50IHZlcnNpb25zIG9mIFNhZmFyaSBmb3IgTWFjIE9TIGFuZCBpT1NcclxuICAgICAgICAgICAgICAgIC8vIGhhdmUgYSBidWcgdGhhdCB0dXJucyB0aGUgcG9zdC1pbmNyZW1lbnQgKysgb3BlcmF0b3IgaW50byBwcmUtaW5jcmVtZW50XHJcbiAgICAgICAgICAgICAgICAvLyBkdXJpbmcgSklUIGNvbXBpbGF0aW9uLiAgV2UgaGF2ZSBjb2RlIHRoYXQgZGVwZW5kcyBoZWF2aWx5IG9uIFNIQS0xIGZvclxyXG4gICAgICAgICAgICAgICAgLy8gY29ycmVjdG5lc3MgYW5kIHdoaWNoIGlzIGFmZmVjdGVkIGJ5IHRoaXMgYnVnLCBzbyBJJ3ZlIHJlbW92ZWQgYWxsIHVzZXNcclxuICAgICAgICAgICAgICAgIC8vIG9mIHBvc3QtaW5jcmVtZW50ICsrIGluIHdoaWNoIHRoZSByZXN1bHQgdmFsdWUgaXMgdXNlZC4gIFdlIGNhbiByZXZlcnRcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgY2hhbmdlIG9uY2UgdGhlIFNhZmFyaSBidWdcclxuICAgICAgICAgICAgICAgIC8vIChodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTA5MDM2KSBoYXMgYmVlbiBmaXhlZCBhbmRcclxuICAgICAgICAgICAgICAgIC8vIG1vc3QgY2xpZW50cyBoYXZlIGJlZW4gdXBkYXRlZC5cclxuICAgICAgICAgICAgICAgIFdbaV0gPVxyXG4gICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvcHRfb2Zmc2V0KSA8PCAyNCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCArIDEpIDw8IDE2KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvcHRfb2Zmc2V0ICsgMikgPDwgOCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWYuY2hhckNvZGVBdChvcHRfb2Zmc2V0ICsgMyk7XHJcbiAgICAgICAgICAgICAgICBvcHRfb2Zmc2V0ICs9IDQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1ZltvcHRfb2Zmc2V0XSA8PCAyNCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmW29wdF9vZmZzZXQgKyAxXSA8PCAxNikgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmW29wdF9vZmZzZXQgKyAyXSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZltvcHRfb2Zmc2V0ICsgM107XHJcbiAgICAgICAgICAgICAgICBvcHRfb2Zmc2V0ICs9IDQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gZXhwYW5kIHRvIDgwIHdvcmRzXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDE2OyBpIDwgODA7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgdCA9IFdbaSAtIDNdIF4gV1tpIC0gOF0gXiBXW2kgLSAxNF0gXiBXW2kgLSAxNl07XHJcbiAgICAgICAgICAgIFdbaV0gPSAoKHQgPDwgMSkgfCAodCA+Pj4gMzEpKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBhID0gdGhpcy5jaGFpbl9bMF07XHJcbiAgICAgICAgdmFyIGIgPSB0aGlzLmNoYWluX1sxXTtcclxuICAgICAgICB2YXIgYyA9IHRoaXMuY2hhaW5fWzJdO1xyXG4gICAgICAgIHZhciBkID0gdGhpcy5jaGFpbl9bM107XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzLmNoYWluX1s0XTtcclxuICAgICAgICB2YXIgZiwgaztcclxuICAgICAgICAvLyBUT0RPKHVzZXIpOiBUcnkgdG8gdW5yb2xsIHRoaXMgbG9vcCB0byBzcGVlZCB1cCB0aGUgY29tcHV0YXRpb24uXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA4MDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChpIDwgNDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgMjApIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gZCBeIChiICYgKGMgXiBkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4NWE4Mjc5OTk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDZlZDllYmExO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPCA2MCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSAoYiAmIGMpIHwgKGQgJiAoYiB8IGMpKTtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg4ZjFiYmNkYztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSBiIF4gYyBeIGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4Y2E2MmMxZDY7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHQgPSAoKChhIDw8IDUpIHwgKGEgPj4+IDI3KSkgKyBmICsgZSArIGsgKyBXW2ldKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgICAgIGUgPSBkO1xyXG4gICAgICAgICAgICBkID0gYztcclxuICAgICAgICAgICAgYyA9ICgoYiA8PCAzMCkgfCAoYiA+Pj4gMikpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICAgICAgYiA9IGE7XHJcbiAgICAgICAgICAgIGEgPSB0O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoYWluX1swXSA9ICh0aGlzLmNoYWluX1swXSArIGEpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1sxXSA9ICh0aGlzLmNoYWluX1sxXSArIGIpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9ICh0aGlzLmNoYWluX1syXSArIGMpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1szXSA9ICh0aGlzLmNoYWluX1szXSArIGQpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1s0XSA9ICh0aGlzLmNoYWluX1s0XSArIGUpICYgMHhmZmZmZmZmZjtcclxuICAgIH07XHJcbiAgICBTaGExLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoYnl0ZXMsIG9wdF9sZW5ndGgpIHtcclxuICAgICAgICAvLyBUT0RPKGpvaG5sZW56KTogdGlnaHRlbiB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIGFuZCByZW1vdmUgdGhpcyBjaGVja1xyXG4gICAgICAgIGlmIChieXRlcyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9wdF9sZW5ndGggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvcHRfbGVuZ3RoID0gYnl0ZXMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbGVuZ3RoTWludXNCbG9jayA9IG9wdF9sZW5ndGggLSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgLy8gVXNpbmcgbG9jYWwgaW5zdGVhZCBvZiBtZW1iZXIgdmFyaWFibGVzIGdpdmVzIH41JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYuXHJcbiAgICAgICAgdmFyIGJ1ZiA9IHRoaXMuYnVmXztcclxuICAgICAgICB2YXIgaW5idWYgPSB0aGlzLmluYnVmXztcclxuICAgICAgICAvLyBUaGUgb3V0ZXIgd2hpbGUgbG9vcCBzaG91bGQgZXhlY3V0ZSBhdCBtb3N0IHR3aWNlLlxyXG4gICAgICAgIHdoaWxlIChuIDwgb3B0X2xlbmd0aCkge1xyXG4gICAgICAgICAgICAvLyBXaGVuIHdlIGhhdmUgbm8gZGF0YSBpbiB0aGUgYmxvY2sgdG8gdG9wIHVwLCB3ZSBjYW4gZGlyZWN0bHkgcHJvY2VzcyB0aGVcclxuICAgICAgICAgICAgLy8gaW5wdXQgYnVmZmVyIChhc3N1bWluZyBpdCBjb250YWlucyBzdWZmaWNpZW50IGRhdGEpLiBUaGlzIGdpdmVzIH4yNSVcclxuICAgICAgICAgICAgLy8gc3BlZWR1cCBvbiBDaHJvbWUgMjMgYW5kIH4xNSUgc3BlZWR1cCBvbiBGaXJlZm94IDE2LCBidXQgcmVxdWlyZXMgdGhhdFxyXG4gICAgICAgICAgICAvLyB0aGUgZGF0YSBpcyBwcm92aWRlZCBpbiBsYXJnZSBjaHVua3MgKG9yIGluIG11bHRpcGxlcyBvZiA2NCBieXRlcykuXHJcbiAgICAgICAgICAgIGlmIChpbmJ1ZiA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8PSBsZW5ndGhNaW51c0Jsb2NrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnl0ZXMsIG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gKz0gdGhpcy5ibG9ja1NpemU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBieXRlcyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDwgb3B0X2xlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1ZltpbmJ1Zl0gPSBieXRlcy5jaGFyQ29kZUF0KG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICsraW5idWY7XHJcbiAgICAgICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmJ1ZiA9PSB0aGlzLmJsb2NrU2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmJ1ZiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPCBvcHRfbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzW25dO1xyXG4gICAgICAgICAgICAgICAgICAgICsraW5idWY7XHJcbiAgICAgICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmJ1ZiA9PSB0aGlzLmJsb2NrU2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmJ1ZiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5idWZfID0gaW5idWY7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gKz0gb3B0X2xlbmd0aDtcclxuICAgIH07XHJcbiAgICAvKiogQG92ZXJyaWRlICovXHJcbiAgICBTaGExLnByb3RvdHlwZS5kaWdlc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGRpZ2VzdCA9IFtdO1xyXG4gICAgICAgIHZhciB0b3RhbEJpdHMgPSB0aGlzLnRvdGFsXyAqIDg7XHJcbiAgICAgICAgLy8gQWRkIHBhZCAweDgwIDB4MDAqLlxyXG4gICAgICAgIGlmICh0aGlzLmluYnVmXyA8IDU2KSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgNTYgLSB0aGlzLmluYnVmXyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSh0aGlzLnBhZF8sIHRoaXMuYmxvY2tTaXplIC0gKHRoaXMuaW5idWZfIC0gNTYpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQWRkICMgYml0cy5cclxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5ibG9ja1NpemUgLSAxOyBpID49IDU2OyBpLS0pIHtcclxuICAgICAgICAgICAgdGhpcy5idWZfW2ldID0gdG90YWxCaXRzICYgMjU1O1xyXG4gICAgICAgICAgICB0b3RhbEJpdHMgLz0gMjU2OyAvLyBEb24ndCB1c2UgYml0LXNoaWZ0aW5nIGhlcmUhXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29tcHJlc3NfKHRoaXMuYnVmXyk7XHJcbiAgICAgICAgdmFyIG4gPSAwO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAyNDsgaiA+PSAwOyBqIC09IDgpIHtcclxuICAgICAgICAgICAgICAgIGRpZ2VzdFtuXSA9ICh0aGlzLmNoYWluX1tpXSA+PiBqKSAmIDI1NTtcclxuICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGlnZXN0O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTaGExO1xyXG59KEhhc2gpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQcm92aWRlcyBhIHNpbXBsZSBoZWxwZXIgY2xhc3MgdGhhdCBpbXBsZW1lbnRzIHRoZSBTdHJlYW0gaW50ZXJmYWNlIHRvXHJcbiAqIGJyaWRnZSB0byBvdGhlciBpbXBsZW1lbnRhdGlvbnMgdGhhdCBhcmUgc3RyZWFtcyBidXQgZG8gbm90IGltcGxlbWVudCB0aGVcclxuICogaW50ZXJmYWNlLiBUaGUgc3RyZWFtIGNhbGxiYWNrcyBhcmUgaW52b2tlZCB3aXRoIHRoZSBjYWxsT24uLi4gbWV0aG9kcy5cclxuICovXHJcbnZhciBTdHJlYW1CcmlkZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTdHJlYW1CcmlkZ2UoYXJncykge1xyXG4gICAgICAgIHRoaXMuc2VuZEZuID0gYXJncy5zZW5kRm47XHJcbiAgICAgICAgdGhpcy5jbG9zZUZuID0gYXJncy5jbG9zZUZuO1xyXG4gICAgfVxyXG4gICAgU3RyZWFtQnJpZGdlLnByb3RvdHlwZS5vbk9wZW4gPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMud3JhcHBlZE9uT3BlbiwgJ0NhbGxlZCBvbk9wZW4gb24gc3RyZWFtIHR3aWNlIScpO1xyXG4gICAgICAgIHRoaXMud3JhcHBlZE9uT3BlbiA9IGNhbGxiYWNrO1xyXG4gICAgfTtcclxuICAgIFN0cmVhbUJyaWRnZS5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy53cmFwcGVkT25DbG9zZSwgJ0NhbGxlZCBvbkNsb3NlIG9uIHN0cmVhbSB0d2ljZSEnKTtcclxuICAgICAgICB0aGlzLndyYXBwZWRPbkNsb3NlID0gY2FsbGJhY2s7XHJcbiAgICB9O1xyXG4gICAgU3RyZWFtQnJpZGdlLnByb3RvdHlwZS5vbk1lc3NhZ2UgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMud3JhcHBlZE9uTWVzc2FnZSwgJ0NhbGxlZCBvbk1lc3NhZ2Ugb24gc3RyZWFtIHR3aWNlIScpO1xyXG4gICAgICAgIHRoaXMud3JhcHBlZE9uTWVzc2FnZSA9IGNhbGxiYWNrO1xyXG4gICAgfTtcclxuICAgIFN0cmVhbUJyaWRnZS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZUZuKCk7XHJcbiAgICB9O1xyXG4gICAgU3RyZWFtQnJpZGdlLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgIHRoaXMuc2VuZEZuKG1zZyk7XHJcbiAgICB9O1xyXG4gICAgU3RyZWFtQnJpZGdlLnByb3RvdHlwZS5jYWxsT25PcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLndyYXBwZWRPbk9wZW4gIT09IHVuZGVmaW5lZCwgJ0Nhbm5vdCBjYWxsIG9uT3BlbiBiZWNhdXNlIG5vIGNhbGxiYWNrIHdhcyBzZXQnKTtcclxuICAgICAgICB0aGlzLndyYXBwZWRPbk9wZW4oKTtcclxuICAgIH07XHJcbiAgICBTdHJlYW1CcmlkZ2UucHJvdG90eXBlLmNhbGxPbkNsb3NlID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLndyYXBwZWRPbkNsb3NlICE9PSB1bmRlZmluZWQsICdDYW5ub3QgY2FsbCBvbkNsb3NlIGJlY2F1c2Ugbm8gY2FsbGJhY2sgd2FzIHNldCcpO1xyXG4gICAgICAgIHRoaXMud3JhcHBlZE9uQ2xvc2UoZXJyKTtcclxuICAgIH07XHJcbiAgICBTdHJlYW1CcmlkZ2UucHJvdG90eXBlLmNhbGxPbk1lc3NhZ2UgPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMud3JhcHBlZE9uTWVzc2FnZSAhPT0gdW5kZWZpbmVkLCAnQ2Fubm90IGNhbGwgb25NZXNzYWdlIGJlY2F1c2Ugbm8gY2FsbGJhY2sgd2FzIHNldCcpO1xyXG4gICAgICAgIHRoaXMud3JhcHBlZE9uTWVzc2FnZShtc2cpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTdHJlYW1CcmlkZ2U7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyA9ICdDb25uZWN0aW9uJztcclxudmFyIFJQQ19TVFJFQU1fU0VSVklDRSA9ICdnb29nbGUuZmlyZXN0b3JlLnYxYmV0YTEuRmlyZXN0b3JlJztcclxudmFyIFJQQ19VUkxfVkVSU0lPTiA9ICd2MWJldGExJztcclxuLyoqIE1hcHMgUlBDIG5hbWVzIHRvIHRoZSBjb3JyZXNwb25kaW5nIFJFU1QgZW5kcG9pbnQgbmFtZS4gKi9cclxudmFyIFJQQ19OQU1FX1JFU1RfTUFQUElORyA9IHtcclxuICAgIEJhdGNoR2V0RG9jdW1lbnRzOiAnYmF0Y2hHZXQnLFxyXG4gICAgQ29tbWl0OiAnY29tbWl0J1xyXG59O1xyXG4vLyBUT0RPKGIvMzgyMDMzNDQpOiBUaGUgU0RLX1ZFUlNJT04gaXMgc2V0IGluZGVwZW5kZW50bHkgZnJvbSBGaXJlYmFzZSBiZWNhdXNlXHJcbi8vIHdlIGFyZSBkb2luZyBvdXQtb2YtYmFuZCByZWxlYXNlcy4gT25jZSB3ZSByZWxlYXNlIGFzIHBhcnQgb2YgRmlyZWJhc2UsIHdlXHJcbi8vIHNob3VsZCB1c2UgdGhlIEZpcmViYXNlIHZlcnNpb24gaW5zdGVhZC5cclxudmFyIFhfR09PR19BUElfQ0xJRU5UX1ZBTFVFID0gJ2dsLWpzLyBmaXJlLycgKyBTREtfVkVSU0lPTjtcclxudmFyIFhIUl9USU1FT1VUX1NFQ1MgPSAxNTtcclxudmFyIFdlYkNoYW5uZWxDb25uZWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gV2ViQ2hhbm5lbENvbm5lY3Rpb24oaW5mbykge1xyXG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IGluZm8uZGF0YWJhc2VJZDtcclxuICAgICAgICB0aGlzLnBvb2wgPSBuZXcgd2ViY2hhbm5lbFdyYXBwZXIuWGhySW9Qb29sKCk7XHJcbiAgICAgICAgdmFyIHByb3RvID0gaW5mby5zc2wgPyAnaHR0cHMnIDogJ2h0dHAnO1xyXG4gICAgICAgIHRoaXMuYmFzZVVybCA9IHByb3RvICsgJzovLycgKyBpbmZvLmhvc3Q7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE1vZGlmaWVzIHRoZSBoZWFkZXJzIGZvciBhIHJlcXVlc3QsIGFkZGluZyBhbnkgYXV0aG9yaXphdGlvbiB0b2tlbiBpZlxyXG4gICAgICogcHJlc2VudCBhbmQgYW55IGFkZGl0aW9uYWwgaGVhZGVycyBmb3IgdGhlIHJlcXVlc3QuXHJcbiAgICAgKi9cclxuICAgIFdlYkNoYW5uZWxDb25uZWN0aW9uLnByb3RvdHlwZS5tb2RpZnlIZWFkZXJzRm9yUmVxdWVzdCA9IGZ1bmN0aW9uIChoZWFkZXJzLCB0b2tlbikge1xyXG4gICAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBoZWFkZXIgaW4gdG9rZW4uYXV0aEhlYWRlcnMpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0b2tlbi5hdXRoSGVhZGVycy5oYXNPd25Qcm9wZXJ0eShoZWFkZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1toZWFkZXJdID0gdG9rZW4uYXV0aEhlYWRlcnNbaGVhZGVyXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBoZWFkZXJzWydYLUdvb2ctQXBpLUNsaWVudCddID0gWF9HT09HX0FQSV9DTElFTlRfVkFMVUU7XHJcbiAgICB9O1xyXG4gICAgV2ViQ2hhbm5lbENvbm5lY3Rpb24ucHJvdG90eXBlLmludm9rZVJQQyA9IGZ1bmN0aW9uIChycGNOYW1lLCByZXF1ZXN0LCB0b2tlbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHVybCA9IHRoaXMubWFrZVVybChycGNOYW1lKTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IFhocklvUG9vbCBkb2Vzbid0IGhhdmUgVFMgdHlwaW5ncy5cclxuICAgICAgICAgICAgX3RoaXMucG9vbC5nZXRPYmplY3QoZnVuY3Rpb24gKHhocikge1xyXG4gICAgICAgICAgICAgICAgeGhyLmxpc3Rlbk9uY2Uod2ViY2hhbm5lbFdyYXBwZXIuRXZlbnRUeXBlLkNPTVBMRVRFLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh4aHIuZ2V0TGFzdEVycm9yQ29kZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIHdlYmNoYW5uZWxXcmFwcGVyLkVycm9yQ29kZS5OT19FUlJPUjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIganNvbiA9IHhoci5nZXRSZXNwb25zZUpzb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnWEhSIHJlY2VpdmVkOicsIEpTT04uc3RyaW5naWZ5KGpzb24pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGpzb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSB3ZWJjaGFubmVsV3JhcHBlci5FcnJvckNvZGUuVElNRU9VVDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnUlBDIFwiJyArIHJwY05hbWUgKyAnXCIgdGltZWQgb3V0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkRFQURMSU5FX0VYQ0VFREVELCAnUmVxdWVzdCB0aW1lIG91dCcpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Ugd2ViY2hhbm5lbFdyYXBwZXIuRXJyb3JDb2RlLkhUVFBfRVJST1I6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1c18xID0geGhyLmdldFN0YXR1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdSUEMgXCInICsgcnBjTmFtZSArICdcIiBmYWlsZWQgd2l0aCBzdGF0dXM6Jywgc3RhdHVzXzEsICdyZXNwb25zZSB0ZXh0OicsIHhoci5nZXRSZXNwb25zZVRleHQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXR1c18xID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKG1hcENvZGVGcm9tSHR0cFN0YXR1cyhzdGF0dXNfMSksICdTZXJ2ZXIgcmVzcG9uZGVkIHdpdGggc3RhdHVzICcgKyB4aHIuZ2V0U3RhdHVzVGV4dCgpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSByZWNlaXZlZCBhbiBIVFRQX0VSUk9SIGJ1dCB0aGVyZSdzIG5vIHN0YXR1cyBjb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCdzIG1vc3QgcHJvYmFibHkgYSBjb25uZWN0aW9uIGlzc3VlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdSUEMgXCInICsgcnBjTmFtZSArICdcIiBmYWlsZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOQVZBSUxBQkxFLCAnQ29ubmVjdGlvbiBmYWlsZWQuJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbCgnUlBDIFwiJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJwY05hbWUgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXCIgZmFpbGVkIHdpdGggdW5hbnRpY2lwYXRlZCAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dlYmNoYW5uZWwgZXJyb3IgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhoci5nZXRMYXN0RXJyb3JDb2RlKCkgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGhyLmdldExhc3RFcnJvcigpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJywgZ2l2aW5nIHVwLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnUlBDIFwiJyArIHJwY05hbWUgKyAnXCIgY29tcGxldGVkLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wb29sLnJlbGVhc2VPYmplY3QoeGhyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0U3RyaW5nID0gSlNPTi5zdHJpbmdpZnkocmVxdWVzdCk7XHJcbiAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnWEhSIHNlbmRpbmc6ICcsIHVybCArICcgJyArIHJlcXVlc3RTdHJpbmcpO1xyXG4gICAgICAgICAgICAgICAgLy8gQ29udGVudC1UeXBlOiB0ZXh0L3BsYWluIHdpbGwgYXZvaWQgcHJlZmxpZ2h0IHJlcXVlc3RzIHdoaWNoIG1pZ2h0XHJcbiAgICAgICAgICAgICAgICAvLyBtZXNzIHdpdGggQ09SUyBhbmQgcmVkaXJlY3RzIGJ5IHByb3hpZXMuIElmIHdlIGFkZCBjdXN0b20gaGVhZGVyc1xyXG4gICAgICAgICAgICAgICAgLy8gd2Ugd2lsbCBuZWVkIHRvIGNoYW5nZSB0aGlzIGNvZGUgdG8gcG90ZW50aWFsbHkgdXNlIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gJGh0dHBPdmVyd3JpdGUgcGFyYW1ldGVyIHN1cHBvcnRlZCBieSBFU0YgdG8gYXZvaWRcclxuICAgICAgICAgICAgICAgIC8vIHRyaWdnZXJpbmcgcHJlZmxpZ2h0IHJlcXVlc3RzLlxyXG4gICAgICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSB7ICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicgfTtcclxuICAgICAgICAgICAgICAgIF90aGlzLm1vZGlmeUhlYWRlcnNGb3JSZXF1ZXN0KGhlYWRlcnMsIHRva2VuKTtcclxuICAgICAgICAgICAgICAgIHhoci5zZW5kKHVybCwgJ1BPU1QnLCByZXF1ZXN0U3RyaW5nLCBoZWFkZXJzLCBYSFJfVElNRU9VVF9TRUNTKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgV2ViQ2hhbm5lbENvbm5lY3Rpb24ucHJvdG90eXBlLmludm9rZVN0cmVhbWluZ1JQQyA9IGZ1bmN0aW9uIChycGNOYW1lLCByZXF1ZXN0LCB0b2tlbikge1xyXG4gICAgICAgIC8vIFRoZSBSRVNUIEFQSSBhdXRvbWF0aWNhbGx5IGFnZ3JlZ2F0ZXMgYWxsIG9mIHRoZSBzdHJlYW1lZCByZXN1bHRzLCBzbyB3ZVxyXG4gICAgICAgIC8vIGNhbiBqdXN0IHVzZSB0aGUgbm9ybWFsIGludm9rZSgpIG1ldGhvZC5cclxuICAgICAgICByZXR1cm4gdGhpcy5pbnZva2VSUEMocnBjTmFtZSwgcmVxdWVzdCwgdG9rZW4pO1xyXG4gICAgfTtcclxuICAgIFdlYkNoYW5uZWxDb25uZWN0aW9uLnByb3RvdHlwZS5vcGVuU3RyZWFtID0gZnVuY3Rpb24gKHJwY05hbWUsIHRva2VuKSB7XHJcbiAgICAgICAgdmFyIHVybFBhcnRzID0gW1xyXG4gICAgICAgICAgICB0aGlzLmJhc2VVcmwsXHJcbiAgICAgICAgICAgICcvJyxcclxuICAgICAgICAgICAgUlBDX1NUUkVBTV9TRVJWSUNFLFxyXG4gICAgICAgICAgICAnLycsXHJcbiAgICAgICAgICAgIHJwY05hbWUsXHJcbiAgICAgICAgICAgICcvY2hhbm5lbCdcclxuICAgICAgICBdO1xyXG4gICAgICAgIHZhciB3ZWJjaGFubmVsVHJhbnNwb3J0ID0gd2ViY2hhbm5lbFdyYXBwZXIuY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCgpO1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0ge1xyXG4gICAgICAgICAgICAvLyBCYWNrZ3JvdW5kIGNoYW5uZWwgdGVzdCBhdm9pZHMgdGhlIGluaXRpYWwgdHdvIHRlc3QgY2FsbHMgYW5kIGRlY3JlYXNlc1xyXG4gICAgICAgICAgICAvLyBpbml0aWFsIGNvbGQgc3RhcnQgdGltZS5cclxuICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiB3ZW5ib3pAIG1lbnRpb25lZCB0aGlzIG1pZ2h0IGFmZmVjdCB1c2Ugd2l0aCBwcm94aWVzIGFuZFxyXG4gICAgICAgICAgICAvLyB3ZSBzaG91bGQgbW9uaXRvciBjbG9zZWx5IGZvciBhbnkgcmVwb3J0cy5cclxuICAgICAgICAgICAgYmFja2dyb3VuZENoYW5uZWxUZXN0OiB0cnVlLFxyXG4gICAgICAgICAgICAvLyBSZXF1aXJlZCBmb3IgYmFja2VuZCBzdGlja2luZXNzLCByb3V0aW5nIGJlaGF2aW9yIGlzIGJhc2VkIG9uIHRoaXNcclxuICAgICAgICAgICAgLy8gcGFyYW1ldGVyLlxyXG4gICAgICAgICAgICBodHRwU2Vzc2lvbklkUGFyYW06ICdnc2Vzc2lvbmlkJyxcclxuICAgICAgICAgICAgaW5pdE1lc3NhZ2VIZWFkZXJzOiB7fSxcclxuICAgICAgICAgICAgbWVzc2FnZVVybFBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBwYXJhbSBpcyB1c2VkIHRvIGltcHJvdmUgcm91dGluZyBhbmQgcHJvamVjdCBpc29sYXRpb24gYnkgdGhlXHJcbiAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIGFuZCBtdXN0IGJlIGluY2x1ZGVkIGluIGV2ZXJ5IHJlcXVlc3QuXHJcbiAgICAgICAgICAgICAgICBkYXRhYmFzZTogXCJwcm9qZWN0cy9cIiArIHRoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWQgKyBcIi9kYXRhYmFzZXMvXCIgKyB0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2VuZFJhd0pzb246IHRydWUsXHJcbiAgICAgICAgICAgIHN1cHBvcnRzQ3Jvc3NEb21haW5YaHI6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubW9kaWZ5SGVhZGVyc0ZvclJlcXVlc3QocmVxdWVzdC5pbml0TWVzc2FnZUhlYWRlcnMsIHRva2VuKTtcclxuICAgICAgICAvLyBTZW5kaW5nIHRoZSBjdXN0b20gaGVhZGVycyB3ZSBqdXN0IGFkZGVkIHRvIHJlcXVlc3QuaW5pdE1lc3NhZ2VIZWFkZXJzXHJcbiAgICAgICAgLy8gKEF1dGhvcml6YXRpb24sIGV0Yy4pIHdpbGwgdHJpZ2dlciB0aGUgYnJvd3NlciB0byBtYWtlIGEgQ09SUyBwcmVmbGlnaHRcclxuICAgICAgICAvLyByZXF1ZXN0IGJlY2F1c2UgdGhlIFhIUiB3aWxsIG5vIGxvbmdlciBtZWV0IHRoZSBjcml0ZXJpYSBmb3IgYSBcInNpbXBsZVwiXHJcbiAgICAgICAgLy8gQ09SUyByZXF1ZXN0OlxyXG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUVFAvQ09SUyNTaW1wbGVfcmVxdWVzdHNcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIFRoZXJlZm9yZSB0byBhdm9pZCB0aGUgQ09SUyBwcmVmbGlnaHQgcmVxdWVzdCAoYW4gZXh0cmEgbmV0d29ya1xyXG4gICAgICAgIC8vIHJvdW5kdHJpcCksIHdlIHVzZSB0aGUgaHR0cEhlYWRlcnNPdmVyd3JpdGVQYXJhbSBvcHRpb24gdG8gc3BlY2lmeSB0aGF0XHJcbiAgICAgICAgLy8gdGhlIGhlYWRlcnMgc2hvdWxkIGluc3RlYWQgYmUgZW5jb2RlZCBpbnRvIGEgc3BlY2lhbCBcIiRodHRwSGVhZGVyc1wiIHF1ZXJ5XHJcbiAgICAgICAgLy8gcGFyYW1ldGVyLCB3aGljaCBpcyByZWNvZ25pemVkIGJ5IHRoZSB3ZWJjaGFubmVsIGJhY2tlbmQuIFRoaXMgaXNcclxuICAgICAgICAvLyBmb3JtYWxseSBkZWZpbmVkIGhlcmU6XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWxpYnJhcnkvYmxvYi9iMGUxODE1YjEzZmI5MmE0NmQ3YzliM2MzMGRlNWQ2YTM5NmEzMjQ1L2Nsb3N1cmUvZ29vZy9uZXQvcnBjL2h0dHBjb3JzLmpzI0wzMlxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gQnV0IGZvciBzb21lIHVuY2xlYXIgcmVhc29uIChzZWVcclxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtanMtc2RrL2lzc3Vlcy83MDMpLCB0aGlzIGJyZWFrc1xyXG4gICAgICAgIC8vIFJlYWN0TmF0aXZlIGFuZCBzbyB3ZSBleGNsdWRlIGl0LCB3aGljaCBqdXN0IG1lYW5zIFJlYWN0TmF0aXZlIG1heSBiZVxyXG4gICAgICAgIC8vIHN1YmplY3QgdG8gdGhlIGV4dHJhIG5ldHdvcmsgcm91bmR0cmlwIGZvciBDT1JTIHByZWZsaWdodC5cclxuICAgICAgICBpZiAoIWlzUmVhY3ROYXRpdmUoKSkge1xyXG4gICAgICAgICAgICByZXF1ZXN0WydodHRwSGVhZGVyc092ZXJ3cml0ZVBhcmFtJ10gPSAnJGh0dHBIZWFkZXJzJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHVybCA9IHVybFBhcnRzLmpvaW4oJycpO1xyXG4gICAgICAgIGRlYnVnKExPR19UQUcsICdDcmVhdGluZyBXZWJDaGFubmVsOiAnICsgdXJsICsgJyAnICsgcmVxdWVzdCk7XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBCZWNhdXNlIGxpc3RlbiBpc24ndCBkZWZpbmVkIG9uIGl0LlxyXG4gICAgICAgIHZhciBjaGFubmVsID0gd2ViY2hhbm5lbFRyYW5zcG9ydC5jcmVhdGVXZWJDaGFubmVsKHVybCwgcmVxdWVzdCk7XHJcbiAgICAgICAgLy8gV2ViQ2hhbm5lbCBzdXBwb3J0cyBzZW5kaW5nIHRoZSBmaXJzdCBtZXNzYWdlIHdpdGggdGhlIGhhbmRzaGFrZSAtIHNhdmluZ1xyXG4gICAgICAgIC8vIGEgbmV0d29yayByb3VuZCB0cmlwLiBIb3dldmVyLCBpdCB3aWxsIGhhdmUgdG8gY2FsbCBzZW5kIGluIHRoZSBzYW1lXHJcbiAgICAgICAgLy8gSlMgZXZlbnQgbG9vcCBhcyBvcGVuLiBJbiBvcmRlciB0byBlbmZvcmNlIHRoaXMsIHdlIGRlbGF5IGFjdHVhbGx5XHJcbiAgICAgICAgLy8gb3BlbmluZyB0aGUgV2ViQ2hhbm5lbCB1bnRpbCBzZW5kIGlzIGNhbGxlZC4gV2hldGhlciB3ZSBoYXZlIGNhbGxlZFxyXG4gICAgICAgIC8vIG9wZW4gaXMgdHJhY2tlZCB3aXRoIHRoaXMgdmFyaWFibGUuXHJcbiAgICAgICAgdmFyIG9wZW5lZCA9IGZhbHNlO1xyXG4gICAgICAgIC8vIEEgZmxhZyB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgc3RyZWFtIHdhcyBjbG9zZWQgKGJ5IHVzIG9yIHRocm91Z2ggYW5cclxuICAgICAgICAvLyBlcnJvci9jbG9zZSBldmVudCkgdG8gYXZvaWQgZGVsaXZlcmluZyBtdWx0aXBsZSBjbG9zZSBldmVudHMgb3Igc2VuZGluZ1xyXG4gICAgICAgIC8vIG9uIGEgY2xvc2VkIHN0cmVhbVxyXG4gICAgICAgIHZhciBjbG9zZWQgPSBmYWxzZTtcclxuICAgICAgICB2YXIgc3RyZWFtQnJpZGdlID0gbmV3IFN0cmVhbUJyaWRnZSh7XHJcbiAgICAgICAgICAgIHNlbmRGbjogZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjbG9zZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wZW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnT3BlbmluZyBXZWJDaGFubmVsIHRyYW5zcG9ydC4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbC5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5lZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdXZWJDaGFubmVsIHNlbmRpbmc6JywgbXNnKTtcclxuICAgICAgICAgICAgICAgICAgICBjaGFubmVsLnNlbmQobXNnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdOb3Qgc2VuZGluZyBiZWNhdXNlIFdlYkNoYW5uZWwgaXMgY2xvc2VkOicsIG1zZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNsb3NlRm46IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNoYW5uZWwuY2xvc2UoKTsgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIENsb3N1cmUgZXZlbnRzIGFyZSBndWFyZGVkIGFuZCBleGNlcHRpb25zIGFyZSBzd2FsbG93ZWQsIHNvIGNhdGNoIGFueVxyXG4gICAgICAgIC8vIGV4Y2VwdGlvbiBhbmQgcmV0aHJvdyB1c2luZyBhIHNldFRpbWVvdXQgc28gdGhleSBiZWNvbWUgdmlzaWJsZSBhZ2Fpbi5cclxuICAgICAgICAvLyBOb3RlIHRoYXQgZXZlbnR1YWxseSB0aGlzIGZ1bmN0aW9uIGNvdWxkIGdvIGF3YXkgaWYgd2UgYXJlIGNvbmZpZGVudFxyXG4gICAgICAgIC8vIGVub3VnaCB0aGUgY29kZSBpcyBleGNlcHRpb24gZnJlZS5cclxuICAgICAgICB2YXIgdW5ndWFyZGVkRXZlbnRMaXN0ZW4gPSBmdW5jdGlvbiAodHlwZSwgZm4pIHtcclxuICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBjbG9zdXJlIHR5cGluZyBzZWVtcyBicm9rZW4gYmVjYXVzZSBXZWJDaGFubmVsIGRvZXNcclxuICAgICAgICAgICAgLy8gbm90IGltcGxlbWVudCBnb29nLmV2ZW50cy5MaXN0ZW5hYmxlXHJcbiAgICAgICAgICAgIGNoYW5uZWwubGlzdGVuKHR5cGUsIGZ1bmN0aW9uIChwYXJhbSkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBmbihwYXJhbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHVuZ3VhcmRlZEV2ZW50TGlzdGVuKHdlYmNoYW5uZWxXcmFwcGVyLldlYkNoYW5uZWwuRXZlbnRUeXBlLk9QRU4sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFjbG9zZWQpIHtcclxuICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdXZWJDaGFubmVsIHRyYW5zcG9ydCBvcGVuZWQuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB1bmd1YXJkZWRFdmVudExpc3Rlbih3ZWJjaGFubmVsV3JhcHBlci5XZWJDaGFubmVsLkV2ZW50VHlwZS5DTE9TRSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWNsb3NlZCkge1xyXG4gICAgICAgICAgICAgICAgY2xvc2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdXZWJDaGFubmVsIHRyYW5zcG9ydCBjbG9zZWQnKTtcclxuICAgICAgICAgICAgICAgIHN0cmVhbUJyaWRnZS5jYWxsT25DbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdW5ndWFyZGVkRXZlbnRMaXN0ZW4od2ViY2hhbm5lbFdyYXBwZXIuV2ViQ2hhbm5lbC5FdmVudFR5cGUuRVJST1IsIGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgaWYgKCFjbG9zZWQpIHtcclxuICAgICAgICAgICAgICAgIGNsb3NlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnV2ViQ2hhbm5lbCB0cmFuc3BvcnQgZXJyb3JlZDonLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgc3RyZWFtQnJpZGdlLmNhbGxPbkNsb3NlKG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOQVZBSUxBQkxFLCAnVGhlIG9wZXJhdGlvbiBjb3VsZCBub3QgYmUgY29tcGxldGVkJykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdW5ndWFyZGVkRXZlbnRMaXN0ZW4od2ViY2hhbm5lbFdyYXBwZXIuV2ViQ2hhbm5lbC5FdmVudFR5cGUuTUVTU0FHRSwgZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgICAgICBpZiAoIWNsb3NlZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1zZ0RhdGEgPSBtc2cuZGF0YVswXTtcclxuICAgICAgICAgICAgICAgIGFzc2VydCghIW1zZ0RhdGEsICdHb3QgYSB3ZWJjaGFubmVsIG1lc3NhZ2Ugd2l0aG91dCBkYXRhLicpO1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhiLzM1MTQzODkxKTogVGhlcmUgaXMgYSBidWcgaW4gT25lIFBsYXRmb3JtIHRoYXQgY2F1c2VkIGVycm9yc1xyXG4gICAgICAgICAgICAgICAgLy8gKGFuZCBvbmx5IGVycm9ycykgdG8gYmUgd3JhcHBlZCBpbiBhbiBleHRyYSBhcnJheS4gVG8gYmUgZm9yd2FyZFxyXG4gICAgICAgICAgICAgICAgLy8gY29tcGF0aWJsZSB3aXRoIHRoZSBidWcgd2UgbmVlZCB0byBjaGVjayBlaXRoZXIgY29uZGl0aW9uLiBUaGUgbGF0dGVyXHJcbiAgICAgICAgICAgICAgICAvLyBjYW4gYmUgcmVtb3ZlZCBvbmNlIHRoZSBmaXggaGFzIGJlZW4gcm9sbGVkIG91dC5cclxuICAgICAgICAgICAgICAgIHZhciBlcnJvciQkMSA9IFxyXG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBtc2dEYXRhLmVycm9yIGlzIG5vdCB0eXBlZC5cclxuICAgICAgICAgICAgICAgIG1zZ0RhdGEuZXJyb3IgfHwgKG1zZ0RhdGFbMF0gJiYgbXNnRGF0YVswXS5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IkJDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnV2ViQ2hhbm5lbCByZWNlaXZlZCBlcnJvcjonLCBlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3Iuc3RhdHVzIHdpbGwgYmUgYSBzdHJpbmcgbGlrZSAnT0snIG9yICdOT1RfRk9VTkQnLlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXNfMiA9IGVycm9yJCQxLnN0YXR1cztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29kZSA9IG1hcENvZGVGcm9tUnBjU3RhdHVzKHN0YXR1c18yKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGVycm9yJCQxLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlID0gQ29kZS5JTlRFUk5BTDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVW5rbm93biBlcnJvciBzdGF0dXM6ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c18yICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIHdpdGggbWVzc2FnZSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciQkMS5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIGNsb3NlZCBzbyBubyBmdXJ0aGVyIGV2ZW50cyBhcmUgcHJvcGFnYXRlZFxyXG4gICAgICAgICAgICAgICAgICAgIGNsb3NlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtQnJpZGdlLmNhbGxPbkNsb3NlKG5ldyBGaXJlc3RvcmVFcnJvcihjb2RlLCBtZXNzYWdlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbm5lbC5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1dlYkNoYW5uZWwgcmVjZWl2ZWQ6JywgbXNnRGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtQnJpZGdlLmNhbGxPbk1lc3NhZ2UobXNnRGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gVGVjaG5pY2FsbHkgd2UgY291bGQvc2hvdWxkIHdhaXQgZm9yIHRoZSBXZWJDaGFubmVsIG9wZW5lZCBldmVudCxcclxuICAgICAgICAgICAgLy8gYnV0IGJlY2F1c2Ugd2Ugd2FudCB0byBzZW5kIHRoZSBmaXJzdCBtZXNzYWdlIHdpdGggdGhlIFdlYkNoYW5uZWxcclxuICAgICAgICAgICAgLy8gaGFuZHNoYWtlIHdlIHByZXRlbmQgdGhlIGNoYW5uZWwgb3BlbmVkIGhlcmUgKGFzeW5jaHJvbm91c2x5KSwgYW5kXHJcbiAgICAgICAgICAgIC8vIHRoZW4gZGVsYXkgdGhlIGFjdHVhbCBvcGVuIHVudGlsIHRoZSBmaXJzdCBtZXNzYWdlIGlzIHNlbnQuXHJcbiAgICAgICAgICAgIHN0cmVhbUJyaWRnZS5jYWxsT25PcGVuKCk7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgcmV0dXJuIHN0cmVhbUJyaWRnZTtcclxuICAgIH07XHJcbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAgICBXZWJDaGFubmVsQ29ubmVjdGlvbi5wcm90b3R5cGUubWFrZVVybCA9IGZ1bmN0aW9uIChycGNOYW1lKSB7XHJcbiAgICAgICAgdmFyIHVybFJwY05hbWUgPSBSUENfTkFNRV9SRVNUX01BUFBJTkdbcnBjTmFtZV07XHJcbiAgICAgICAgYXNzZXJ0KHVybFJwY05hbWUgIT09IHVuZGVmaW5lZCwgJ1Vua25vd24gUkVTVCBtYXBwaW5nIGZvcjogJyArIHJwY05hbWUpO1xyXG4gICAgICAgIHZhciB1cmwgPSBbdGhpcy5iYXNlVXJsLCAnLycsIFJQQ19VUkxfVkVSU0lPTl07XHJcbiAgICAgICAgdXJsLnB1c2goJy9wcm9qZWN0cy8nKTtcclxuICAgICAgICB1cmwucHVzaCh0aGlzLmRhdGFiYXNlSWQucHJvamVjdElkKTtcclxuICAgICAgICB1cmwucHVzaCgnL2RhdGFiYXNlcy8nKTtcclxuICAgICAgICB1cmwucHVzaCh0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2UpO1xyXG4gICAgICAgIHVybC5wdXNoKCcvZG9jdW1lbnRzJyk7XHJcbiAgICAgICAgdXJsLnB1c2goJzonKTtcclxuICAgICAgICB1cmwucHVzaCh1cmxScGNOYW1lKTtcclxuICAgICAgICByZXR1cm4gdXJsLmpvaW4oJycpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBXZWJDaGFubmVsQ29ubmVjdGlvbjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBCcm93c2VyUGxhdGZvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCcm93c2VyUGxhdGZvcm0oKSB7XHJcbiAgICAgICAgdGhpcy5lbXB0eUJ5dGVTdHJpbmcgPSAnJztcclxuICAgICAgICB0aGlzLmJhc2U2NEF2YWlsYWJsZSA9IHR5cGVvZiBhdG9iICE9PSAndW5kZWZpbmVkJztcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCcm93c2VyUGxhdGZvcm0ucHJvdG90eXBlLCBcImRvY3VtZW50XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgPyBkb2N1bWVudCA6IG51bGw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnJvd3NlclBsYXRmb3JtLnByb3RvdHlwZSwgXCJ3aW5kb3dcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiBudWxsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQnJvd3NlclBsYXRmb3JtLnByb3RvdHlwZS5sb2FkQ29ubmVjdGlvbiA9IGZ1bmN0aW9uIChkYXRhYmFzZUluZm8pIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBXZWJDaGFubmVsQ29ubmVjdGlvbihkYXRhYmFzZUluZm8pKTtcclxuICAgIH07XHJcbiAgICBCcm93c2VyUGxhdGZvcm0ucHJvdG90eXBlLm5ld1NlcmlhbGl6ZXIgPSBmdW5jdGlvbiAoZGF0YWJhc2VJZCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgSnNvblByb3RvU2VyaWFsaXplcihkYXRhYmFzZUlkLCB7IHVzZVByb3RvM0pzb246IHRydWUgfSk7XHJcbiAgICB9O1xyXG4gICAgQnJvd3NlclBsYXRmb3JtLnByb3RvdHlwZS5mb3JtYXRKU09OID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcclxuICAgIH07XHJcbiAgICBCcm93c2VyUGxhdGZvcm0ucHJvdG90eXBlLmF0b2IgPSBmdW5jdGlvbiAoZW5jb2RlZCkge1xyXG4gICAgICAgIHJldHVybiBhdG9iKGVuY29kZWQpO1xyXG4gICAgfTtcclxuICAgIEJyb3dzZXJQbGF0Zm9ybS5wcm90b3R5cGUuYnRvYSA9IGZ1bmN0aW9uIChyYXcpIHtcclxuICAgICAgICByZXR1cm4gYnRvYShyYXcpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBCcm93c2VyUGxhdGZvcm07XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVGhpcyBjb2RlIG5lZWRzIHRvIHJ1biBiZWZvcmUgRmlyZXN0b3JlIGlzIHVzZWQuIFRoaXMgY2FuIGJlIGFjaGlldmVkIGluXHJcbiAqIHNldmVyYWwgd2F5czpcclxuICogICAxKSBUaHJvdWdoIHRoZSBKU0NvbXBpbGVyIGNvbXBpbGluZyB0aGlzIGNvZGUgYW5kIHRoZW4gKGF1dG9tYXRpY2FsbHkpXHJcbiAqICAgICAgZXhlY3V0aW5nIGl0IGJlZm9yZSBleHBvcnRpbmcgdGhlIEZpcmVzdG9yZSBzeW1ib2xzLlxyXG4gKiAgIDIpIFRocm91Z2ggaW1wb3J0aW5nIHRoaXMgbW9kdWxlIGZpcnN0IGluIGEgRmlyZXN0b3JlIG1haW4gbW9kdWxlXHJcbiAqL1xyXG5QbGF0Zm9ybVN1cHBvcnQuc2V0UGxhdGZvcm0obmV3IEJyb3dzZXJQbGF0Zm9ybSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBgTGlzdGVuU2VxdWVuY2VgIGlzIGEgbW9ub3RvbmljIHNlcXVlbmNlLiBJdCBpcyBpbml0aWFsaXplZCB3aXRoIGEgbWluaW11bSB2YWx1ZSB0b1xyXG4gKiBleGNlZWQuIEFsbCBzdWJzZXF1ZW50IGNhbGxzIHRvIG5leHQgd2lsbCByZXR1cm4gaW5jcmVhc2luZyB2YWx1ZXMuIElmIHByb3ZpZGVkIHdpdGggYVxyXG4gKiBgU2VxdWVuY2VOdW1iZXJTeW5jZXJgLCBpdCB3aWxsIGFkZGl0aW9uYWxseSBidW1wIGl0cyBuZXh0IHZhbHVlIHdoZW4gdG9sZCBvZiBhIG5ldyB2YWx1ZSwgYXNcclxuICogd2VsbCBhcyB3cml0ZSBvdXQgc2VxdWVuY2UgbnVtYmVycyB0aGF0IGl0IHByb2R1Y2VzIHZpYSBgbmV4dCgpYC5cclxuICovXHJcbnZhciBMaXN0ZW5TZXF1ZW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExpc3RlblNlcXVlbmNlKHByZXZpb3VzVmFsdWUsIHNlcXVlbmNlTnVtYmVyU3luY2VyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnByZXZpb3VzVmFsdWUgPSBwcmV2aW91c1ZhbHVlO1xyXG4gICAgICAgIGlmIChzZXF1ZW5jZU51bWJlclN5bmNlcikge1xyXG4gICAgICAgICAgICBzZXF1ZW5jZU51bWJlclN5bmNlci5zZXF1ZW5jZU51bWJlckhhbmRsZXIgPSBmdW5jdGlvbiAoc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zZXRQcmV2aW91c1ZhbHVlKHNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy53cml0ZU5ld1NlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKHNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VxdWVuY2VOdW1iZXJTeW5jZXIud3JpdGVTZXF1ZW5jZU51bWJlcihzZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgTGlzdGVuU2VxdWVuY2UucHJvdG90eXBlLnNldFByZXZpb3VzVmFsdWUgPSBmdW5jdGlvbiAoZXh0ZXJuYWxQcmV2aW91c1ZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5wcmV2aW91c1ZhbHVlID0gTWF0aC5tYXgoZXh0ZXJuYWxQcmV2aW91c1ZhbHVlLCB0aGlzLnByZXZpb3VzVmFsdWUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByZXZpb3VzVmFsdWU7XHJcbiAgICB9O1xyXG4gICAgTGlzdGVuU2VxdWVuY2UucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG5leHRWYWx1ZSA9ICsrdGhpcy5wcmV2aW91c1ZhbHVlO1xyXG4gICAgICAgIGlmICh0aGlzLndyaXRlTmV3U2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgdGhpcy53cml0ZU5ld1NlcXVlbmNlTnVtYmVyKG5leHRWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXh0VmFsdWU7XHJcbiAgICB9O1xyXG4gICAgTGlzdGVuU2VxdWVuY2UuSU5WQUxJRCA9IC0xO1xyXG4gICAgcmV0dXJuIExpc3RlblNlcXVlbmNlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIERlZmVycmVkJDEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEZWZlcnJlZCgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgX3RoaXMucmVzb2x2ZSA9IHJlc29sdmU7XHJcbiAgICAgICAgICAgIF90aGlzLnJlamVjdCA9IHJlamVjdDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBEZWZlcnJlZDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBXZWxsa25vd24gXCJ0aW1lclwiIElEcyB1c2VkIHdoZW4gc2NoZWR1bGluZyBkZWxheWVkIG9wZXJhdGlvbnMgb24gdGhlXHJcbiAqIEFzeW5jUXVldWUuIFRoZXNlIElEcyBjYW4gdGhlbiBiZSB1c2VkIGZyb20gdGVzdHMgdG8gY2hlY2sgZm9yIHRoZSBwcmVzZW5jZVxyXG4gKiBvZiBvcGVyYXRpb25zIG9yIHRvIHJ1biB0aGVtIGVhcmx5LlxyXG4gKlxyXG4gKiBUaGUgc3RyaW5nIHZhbHVlcyBhcmUgdXNlZCB3aGVuIGVuY29kaW5nIHRoZXNlIHRpbWVyIElEcyBpbiBKU09OIHNwZWMgdGVzdHMuXHJcbiAqL1xyXG52YXIgVGltZXJJZDtcclxuKGZ1bmN0aW9uIChUaW1lcklkKSB7XHJcbiAgICAvKiogQWxsIGNhbiBiZSB1c2VkIHdpdGggcnVuRGVsYXllZE9wZXJhdGlvbnNFYXJseSgpIHRvIHJ1biBhbGwgdGltZXJzLiAqL1xyXG4gICAgVGltZXJJZFtcIkFsbFwiXSA9IFwiYWxsXCI7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBmb2xsb3dpbmcgNCB0aW1lcnMgYXJlIHVzZWQgaW4gcGVyc2lzdGVudF9zdHJlYW0udHMgZm9yIHRoZSBsaXN0ZW4gYW5kXHJcbiAgICAgKiB3cml0ZSBzdHJlYW1zLiBUaGUgXCJJZGxlXCIgdGltZXIgaXMgdXNlZCB0byBjbG9zZSB0aGUgc3RyZWFtIGR1ZSB0b1xyXG4gICAgICogaW5hY3Rpdml0eS4gVGhlIFwiQ29ubmVjdGlvbkJhY2tvZmZcIiB0aW1lciBpcyB1c2VkIHRvIHJlc3RhcnQgYSBzdHJlYW0gb25jZVxyXG4gICAgICogdGhlIGFwcHJvcHJpYXRlIGJhY2tvZmYgZGVsYXkgaGFzIGVsYXBzZWQuXHJcbiAgICAgKi9cclxuICAgIFRpbWVySWRbXCJMaXN0ZW5TdHJlYW1JZGxlXCJdID0gXCJsaXN0ZW5fc3RyZWFtX2lkbGVcIjtcclxuICAgIFRpbWVySWRbXCJMaXN0ZW5TdHJlYW1Db25uZWN0aW9uQmFja29mZlwiXSA9IFwibGlzdGVuX3N0cmVhbV9jb25uZWN0aW9uX2JhY2tvZmZcIjtcclxuICAgIFRpbWVySWRbXCJXcml0ZVN0cmVhbUlkbGVcIl0gPSBcIndyaXRlX3N0cmVhbV9pZGxlXCI7XHJcbiAgICBUaW1lcklkW1wiV3JpdGVTdHJlYW1Db25uZWN0aW9uQmFja29mZlwiXSA9IFwid3JpdGVfc3RyZWFtX2Nvbm5lY3Rpb25fYmFja29mZlwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBBIHRpbWVyIHVzZWQgaW4gb25saW5lX3N0YXRlX3RyYWNrZXIudHMgdG8gdHJhbnNpdGlvbiBmcm9tXHJcbiAgICAgKiBPbmxpbmVTdGF0ZS5Vbmtub3duIHRvIE9mZmxpbmUgYWZ0ZXIgYSBzZXQgdGltZW91dCwgcmF0aGVyIHRoYW4gd2FpdGluZ1xyXG4gICAgICogaW5kZWZpbml0ZWx5IGZvciBzdWNjZXNzIG9yIGZhaWx1cmUuXHJcbiAgICAgKi9cclxuICAgIFRpbWVySWRbXCJPbmxpbmVTdGF0ZVRpbWVvdXRcIl0gPSBcIm9ubGluZV9zdGF0ZV90aW1lb3V0XCI7XHJcbiAgICAvKipcclxuICAgICAqIEEgdGltZXIgdXNlZCB0byB1cGRhdGUgdGhlIGNsaWVudCBtZXRhZGF0YSBpbiBJbmRleGVkRGIsIHdoaWNoIGlzIHVzZWRcclxuICAgICAqIHRvIGRldGVybWluZSB0aGUgcHJpbWFyeSBsZWFzZWhvbGRlci5cclxuICAgICAqL1xyXG4gICAgVGltZXJJZFtcIkNsaWVudE1ldGFkYXRhUmVmcmVzaFwiXSA9IFwiY2xpZW50X21ldGFkYXRhX3JlZnJlc2hcIjtcclxufSkoVGltZXJJZCB8fCAoVGltZXJJZCA9IHt9KSk7XHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGFuIG9wZXJhdGlvbiBzY2hlZHVsZWQgdG8gYmUgcnVuIGluIHRoZSBmdXR1cmUgb24gYW4gQXN5bmNRdWV1ZS5cclxuICpcclxuICogSXQgaXMgY3JlYXRlZCB2aWEgRGVsYXllZE9wZXJhdGlvbi5jcmVhdGVBbmRTY2hlZHVsZSgpLlxyXG4gKlxyXG4gKiBTdXBwb3J0cyBjYW5jZWxsYXRpb24gKHZpYSBjYW5jZWwoKSkgYW5kIGVhcmx5IGV4ZWN1dGlvbiAodmlhIHNraXBEZWxheSgpKS5cclxuICovXHJcbnZhciBEZWxheWVkT3BlcmF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVsYXllZE9wZXJhdGlvbihhc3luY1F1ZXVlLCB0aW1lcklkLCB0YXJnZXRUaW1lTXMsIG9wLCByZW1vdmFsQ2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSBhc3luY1F1ZXVlO1xyXG4gICAgICAgIHRoaXMudGltZXJJZCA9IHRpbWVySWQ7XHJcbiAgICAgICAgdGhpcy50YXJnZXRUaW1lTXMgPSB0YXJnZXRUaW1lTXM7XHJcbiAgICAgICAgdGhpcy5vcCA9IG9wO1xyXG4gICAgICAgIHRoaXMucmVtb3ZhbENhbGxiYWNrID0gcmVtb3ZhbENhbGxiYWNrO1xyXG4gICAgICAgIHRoaXMuZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQkMSgpO1xyXG4gICAgICAgIHRoaXMudGhlbiA9IHRoaXMuZGVmZXJyZWQucHJvbWlzZS50aGVuLmJpbmQodGhpcy5kZWZlcnJlZC5wcm9taXNlKTtcclxuICAgICAgICB0aGlzLmNhdGNoID0gdGhpcy5kZWZlcnJlZC5wcm9taXNlLmNhdGNoLmJpbmQodGhpcy5kZWZlcnJlZC5wcm9taXNlKTtcclxuICAgICAgICAvLyBJdCdzIG5vcm1hbCBmb3IgdGhlIGRlZmVycmVkIHByb21pc2UgdG8gYmUgY2FuY2VsZWQgKGR1ZSB0byBjYW5jZWxsYXRpb24pXHJcbiAgICAgICAgLy8gYW5kIHNvIHdlIGF0dGFjaCBhIGR1bW15IGNhdGNoIGNhbGxiYWNrIHRvIGF2b2lkXHJcbiAgICAgICAgLy8gJ1VuaGFuZGxlZFByb21pc2VSZWplY3Rpb25XYXJuaW5nJyBsb2cgc3BhbS5cclxuICAgICAgICB0aGlzLmRlZmVycmVkLnByb21pc2UuY2F0Y2goZnVuY3Rpb24gKGVycikgeyB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIERlbGF5ZWRPcGVyYXRpb24gdGhhdCBoYXMgYmVlbiBzY2hlZHVsZWQgdG8gYmVcclxuICAgICAqIGV4ZWN1dGVkIG9uIHRoZSBwcm92aWRlZCBhc3luY1F1ZXVlIGFmdGVyIHRoZSBwcm92aWRlZCBkZWxheU1zLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBhc3luY1F1ZXVlIFRoZSBxdWV1ZSB0byBzY2hlZHVsZSB0aGUgb3BlcmF0aW9uIG9uLlxyXG4gICAgICogQHBhcmFtIGlkIEEgVGltZXIgSUQgaWRlbnRpZnlpbmcgdGhlIHR5cGUgb2Ygb3BlcmF0aW9uIHRoaXMgaXMuXHJcbiAgICAgKiBAcGFyYW0gZGVsYXlNcyBUaGUgZGVsYXkgKG1zKSBiZWZvcmUgdGhlIG9wZXJhdGlvbiBzaG91bGQgYmUgc2NoZWR1bGVkLlxyXG4gICAgICogQHBhcmFtIG9wIFRoZSBvcGVyYXRpb24gdG8gcnVuLlxyXG4gICAgICogQHBhcmFtIHJlbW92YWxDYWxsYmFjayBBIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCBzeW5jaHJvbm91c2x5IG9uY2UgdGhlXHJcbiAgICAgKiAgIG9wZXJhdGlvbiBpcyBleGVjdXRlZCBvciBjYW5jZWxlZCwgbm90aWZ5aW5nIHRoZSBBc3luY1F1ZXVlIHRvIHJlbW92ZSBpdFxyXG4gICAgICogICBmcm9tIGl0cyBkZWxheWVkT3BlcmF0aW9ucyBsaXN0LlxyXG4gICAgICogICBQT1JUSU5HIE5PVEU6IFRoaXMgZXhpc3RzIHRvIHByZXZlbnQgbWFraW5nIHJlbW92ZURlbGF5ZWRPcGVyYXRpb24oKSBhbmRcclxuICAgICAqICAgdGhlIERlbGF5ZWRPcGVyYXRpb24gY2xhc3MgcHVibGljLlxyXG4gICAgICovXHJcbiAgICBEZWxheWVkT3BlcmF0aW9uLmNyZWF0ZUFuZFNjaGVkdWxlID0gZnVuY3Rpb24gKGFzeW5jUXVldWUsIHRpbWVySWQsIGRlbGF5TXMsIG9wLCByZW1vdmFsQ2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgdGFyZ2V0VGltZSA9IERhdGUubm93KCkgKyBkZWxheU1zO1xyXG4gICAgICAgIHZhciBkZWxheWVkT3AgPSBuZXcgRGVsYXllZE9wZXJhdGlvbihhc3luY1F1ZXVlLCB0aW1lcklkLCB0YXJnZXRUaW1lLCBvcCwgcmVtb3ZhbENhbGxiYWNrKTtcclxuICAgICAgICBkZWxheWVkT3Auc3RhcnQoZGVsYXlNcyk7XHJcbiAgICAgICAgcmV0dXJuIGRlbGF5ZWRPcDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFN0YXJ0cyB0aGUgdGltZXIuIFRoaXMgaXMgY2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIGNvbnN0cnVjdGlvbiBieVxyXG4gICAgICogY3JlYXRlQW5kU2NoZWR1bGUoKS5cclxuICAgICAqL1xyXG4gICAgRGVsYXllZE9wZXJhdGlvbi5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoZGVsYXlNcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy50aW1lckhhbmRsZSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlRGVsYXlFbGFwc2VkKCk7IH0sIGRlbGF5TXMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUXVldWVzIHRoZSBvcGVyYXRpb24gdG8gcnVuIGltbWVkaWF0ZWx5IChpZiBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIHJ1biBvclxyXG4gICAgICogY2FuY2VsZWQpLlxyXG4gICAgICovXHJcbiAgICBEZWxheWVkT3BlcmF0aW9uLnByb3RvdHlwZS5za2lwRGVsYXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlRGVsYXlFbGFwc2VkKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDYW5jZWxzIHRoZSBvcGVyYXRpb24gaWYgaXQgaGFzbid0IGFscmVhZHkgYmVlbiBleGVjdXRlZCBvciBjYW5jZWxlZC4gVGhlXHJcbiAgICAgKiBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQuXHJcbiAgICAgKlxyXG4gICAgICogQXMgbG9uZyBhcyB0aGUgb3BlcmF0aW9uIGhhcyBub3QgeWV0IGJlZW4gcnVuLCBjYWxsaW5nIGNhbmNlbCgpIHByb3ZpZGVzIGFcclxuICAgICAqIGd1YXJhbnRlZSB0aGF0IHRoZSBvcGVyYXRpb24gd2lsbCBub3QgYmUgcnVuLlxyXG4gICAgICovXHJcbiAgICBEZWxheWVkT3BlcmF0aW9uLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudGltZXJIYW5kbGUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jbGVhclRpbWVvdXQoKTtcclxuICAgICAgICAgICAgdGhpcy5kZWZlcnJlZC5yZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKENvZGUuQ0FOQ0VMTEVELCAnT3BlcmF0aW9uIGNhbmNlbGxlZCcgKyAocmVhc29uID8gJzogJyArIHJlYXNvbiA6ICcnKSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEZWxheWVkT3BlcmF0aW9uLnByb3RvdHlwZS5oYW5kbGVEZWxheUVsYXBzZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy50aW1lckhhbmRsZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY2xlYXJUaW1lb3V0KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMub3AoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBEZWxheWVkT3BlcmF0aW9uLnByb3RvdHlwZS5jbGVhclRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudGltZXJIYW5kbGUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmFsQ2FsbGJhY2sodGhpcyk7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVySGFuZGxlKTtcclxuICAgICAgICAgICAgdGhpcy50aW1lckhhbmRsZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBEZWxheWVkT3BlcmF0aW9uO1xyXG59KCkpO1xyXG52YXIgQXN5bmNRdWV1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFzeW5jUXVldWUoKSB7XHJcbiAgICAgICAgLy8gVGhlIGxhc3QgcHJvbWlzZSBpbiB0aGUgcXVldWUuXHJcbiAgICAgICAgdGhpcy50YWlsID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgLy8gT3BlcmF0aW9ucyBzY2hlZHVsZWQgdG8gYmUgcXVldWVkIGluIHRoZSBmdXR1cmUuIE9wZXJhdGlvbnMgYXJlXHJcbiAgICAgICAgLy8gYXV0b21hdGljYWxseSByZW1vdmVkIGFmdGVyIHRoZXkgYXJlIHJ1biBvciBjYW5jZWxlZC5cclxuICAgICAgICB0aGlzLmRlbGF5ZWRPcGVyYXRpb25zID0gW107XHJcbiAgICAgICAgLy8gRmxhZyBzZXQgd2hpbGUgdGhlcmUncyBhbiBvdXRzdGFuZGluZyBBc3luY1F1ZXVlIG9wZXJhdGlvbiwgdXNlZCBmb3JcclxuICAgICAgICAvLyBhc3NlcnRpb24gc2FuaXR5LWNoZWNrcy5cclxuICAgICAgICB0aGlzLm9wZXJhdGlvbkluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhIG5ldyBvcGVyYXRpb24gdG8gdGhlIHF1ZXVlIHdpdGhvdXQgd2FpdGluZyBmb3IgaXQgdG8gY29tcGxldGUgKGkuZS5cclxuICAgICAqIHdlIGlnbm9yZSB0aGUgUHJvbWlzZSByZXN1bHQpLlxyXG4gICAgICovXHJcbiAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS5lbnF1ZXVlQW5kRm9yZ2V0ID0gZnVuY3Rpb24gKG9wKSB7XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICAgICAgdGhpcy5lbnF1ZXVlKG9wKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgYSBuZXcgb3BlcmF0aW9uIHRvIHRoZSBxdWV1ZS4gUmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIGJlIHJlc29sdmVkXHJcbiAgICAgKiB3aGVuIHRoZSBwcm9taXNlIHJldHVybmVkIGJ5IHRoZSBuZXcgb3BlcmF0aW9uIGlzICh3aXRoIGl0cyB2YWx1ZSkuXHJcbiAgICAgKi9cclxuICAgIEFzeW5jUXVldWUucHJvdG90eXBlLmVucXVldWUgPSBmdW5jdGlvbiAob3ApIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMudmVyaWZ5Tm90RmFpbGVkKCk7XHJcbiAgICAgICAgdmFyIG5ld1RhaWwgPSB0aGlzLnRhaWwudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLm9wZXJhdGlvbkluUHJvZ3Jlc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gb3AoKVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZmFpbHVyZSA9IGVycm9yJCQxO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub3BlcmF0aW9uSW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBlcnJvciQkMS5zdGFjayB8fCBlcnJvciQkMS5tZXNzYWdlIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgZXJyb3IoJ0lOVEVSTkFMIFVOSEFORExFRCBFUlJPUjogJywgbWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAvLyBFc2NhcGUgdGhlIHByb21pc2UgY2hhaW4gYW5kIHRocm93IHRoZSBlcnJvciBnbG9iYWxseSBzbyB0aGF0XHJcbiAgICAgICAgICAgICAgICAvLyBlLmcuIGFueSBnbG9iYWwgY3Jhc2ggcmVwb3J0aW5nIGxpYnJhcnkgZGV0ZWN0cyBhbmQgcmVwb3J0cyBpdC5cclxuICAgICAgICAgICAgICAgIC8vIChidXQgbm90IGZvciBzaW11bGF0ZWQgZXJyb3JzIGluIG91ciB0ZXN0cyBzaW5jZSB0aGlzIGJyZWFrcyBtb2NoYSlcclxuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLmluZGV4T2YoJ0ZpcmVzdG9yZSBUZXN0IFNpbXVsYXRlZCBFcnJvcicpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvciQkMTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFJlLXRocm93IHRoZSBlcnJvciBzbyB0aGF0IHRoaXMudGFpbCBiZWNvbWVzIGEgcmVqZWN0ZWQgUHJvbWlzZSBhbmRcclxuICAgICAgICAgICAgICAgIC8vIGFsbCBmdXJ0aGVyIGF0dGVtcHRzIHRvIGNoYWluICh2aWEgLnRoZW4pIHdpbGwganVzdCBzaG9ydC1jaXJjdWl0XHJcbiAgICAgICAgICAgICAgICAvLyBhbmQgcmV0dXJuIHRoZSByZWplY3RlZCBQcm9taXNlLlxyXG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3IkJDE7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vcGVyYXRpb25JblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnRhaWwgPSBuZXdUYWlsO1xyXG4gICAgICAgIHJldHVybiBuZXdUYWlsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU2NoZWR1bGVzIGFuIG9wZXJhdGlvbiB0byBiZSBxdWV1ZWQgb24gdGhlIEFzeW5jUXVldWUgb25jZSB0aGUgc3BlY2lmaWVkXHJcbiAgICAgKiBgZGVsYXlNc2AgaGFzIGVsYXBzZWQuIFRoZSByZXR1cm5lZCBDYW5jZWxhYmxlUHJvbWlzZSBjYW4gYmUgdXNlZCB0byBjYW5jZWxcclxuICAgICAqIHRoZSBvcGVyYXRpb24gcHJpb3IgdG8gaXRzIHJ1bm5pbmcuXHJcbiAgICAgKi9cclxuICAgIEFzeW5jUXVldWUucHJvdG90eXBlLmVucXVldWVBZnRlckRlbGF5ID0gZnVuY3Rpb24gKHRpbWVySWQsIGRlbGF5TXMsIG9wKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnZlcmlmeU5vdEZhaWxlZCgpO1xyXG4gICAgICAgIGFzc2VydChkZWxheU1zID49IDAsIFwiQXR0ZW1wdGVkIHRvIHNjaGVkdWxlIGFuIG9wZXJhdGlvbiB3aXRoIGEgbmVnYXRpdmUgZGVsYXkgb2YgXCIgKyBkZWxheU1zKTtcclxuICAgICAgICAvLyBXaGlsZSBub3QgbmVjZXNzYXJpbHkgaGFybWZ1bCwgd2UgY3VycmVudGx5IGRvbid0IGV4cGVjdCB0byBoYXZlIG11bHRpcGxlXHJcbiAgICAgICAgLy8gb3BzIHdpdGggdGhlIHNhbWUgdGltZXIgaWQgaW4gdGhlIHF1ZXVlLCBzbyBkZWZlbnNpdmVseSByZWplY3QgdGhlbS5cclxuICAgICAgICBhc3NlcnQoIXRoaXMuY29udGFpbnNEZWxheWVkT3BlcmF0aW9uKHRpbWVySWQpLCBcIkF0dGVtcHRlZCB0byBzY2hlZHVsZSBtdWx0aXBsZSBvcGVyYXRpb25zIHdpdGggdGltZXIgaWQgXCIgKyB0aW1lcklkICsgXCIuXCIpO1xyXG4gICAgICAgIHZhciBkZWxheWVkT3AgPSBEZWxheWVkT3BlcmF0aW9uLmNyZWF0ZUFuZFNjaGVkdWxlKHRoaXMsIHRpbWVySWQsIGRlbGF5TXMsIG9wLCBmdW5jdGlvbiAob3ApIHsgcmV0dXJuIF90aGlzLnJlbW92ZURlbGF5ZWRPcGVyYXRpb24ob3ApOyB9KTtcclxuICAgICAgICB0aGlzLmRlbGF5ZWRPcGVyYXRpb25zLnB1c2goZGVsYXllZE9wKTtcclxuICAgICAgICByZXR1cm4gZGVsYXllZE9wO1xyXG4gICAgfTtcclxuICAgIEFzeW5jUXVldWUucHJvdG90eXBlLnZlcmlmeU5vdEZhaWxlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5mYWlsdXJlKSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ0FzeW5jUXVldWUgaXMgYWxyZWFkeSBmYWlsZWQ6ICcgK1xyXG4gICAgICAgICAgICAgICAgKHRoaXMuZmFpbHVyZS5zdGFjayB8fCB0aGlzLmZhaWx1cmUubWVzc2FnZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFZlcmlmaWVzIHRoZXJlJ3MgYW4gb3BlcmF0aW9uIGN1cnJlbnRseSBpbi1wcm9ncmVzcyBvbiB0aGUgQXN5bmNRdWV1ZS5cclxuICAgICAqIFVuZm9ydHVuYXRlbHkgd2UgY2FuJ3QgdmVyaWZ5IHRoYXQgdGhlIHJ1bm5pbmcgY29kZSBpcyBpbiB0aGUgcHJvbWlzZSBjaGFpblxyXG4gICAgICogb2YgdGhhdCBvcGVyYXRpb24sIHNvIHRoaXMgaXNuJ3QgYSBmb29scHJvb2YgY2hlY2ssIGJ1dCBpdCBzaG91bGQgYmUgZW5vdWdoXHJcbiAgICAgKiB0byBjYXRjaCBzb21lIGJ1Z3MuXHJcbiAgICAgKi9cclxuICAgIEFzeW5jUXVldWUucHJvdG90eXBlLnZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMub3BlcmF0aW9uSW5Qcm9ncmVzcywgJ3ZlcmlmeU9wSW5Qcm9ncmVzcygpIGNhbGxlZCB3aGVuIG5vIG9wIGluIHByb2dyZXNzIG9uIHRoaXMgcXVldWUuJyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBXYWl0cyB1bnRpbCBhbGwgY3VycmVudGx5IHF1ZXVlZCB0YXNrcyBhcmUgZmluaXNoZWQgZXhlY3V0aW5nLiBEZWxheWVkXHJcbiAgICAgKiBvcGVyYXRpb25zIGFyZSBub3QgcnVuLlxyXG4gICAgICovXHJcbiAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS5kcmFpbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5lbnF1ZXVlKGZ1bmN0aW9uICgpIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEZvciBUZXN0czogRGV0ZXJtaW5lIGlmIGEgZGVsYXllZCBvcGVyYXRpb24gd2l0aCBhIHBhcnRpY3VsYXIgVGltZXJJZFxyXG4gICAgICogZXhpc3RzLlxyXG4gICAgICovXHJcbiAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS5jb250YWluc0RlbGF5ZWRPcGVyYXRpb24gPSBmdW5jdGlvbiAodGltZXJJZCkge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmRlbGF5ZWRPcGVyYXRpb25zOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgb3AgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGlmIChvcC50aW1lcklkID09PSB0aW1lcklkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBGb3IgVGVzdHM6IFJ1bnMgc29tZSBvciBhbGwgZGVsYXllZCBvcGVyYXRpb25zIGVhcmx5LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBsYXN0VGltZXJJZCBEZWxheWVkIG9wZXJhdGlvbnMgdXAgdG8gYW5kIGluY2x1ZGluZyB0aGlzIFRpbWVySWQgd2lsbFxyXG4gICAgICogIGJlIGRyYWluZWQuIFRocm93cyBpZiBubyBzdWNoIG9wZXJhdGlvbiBleGlzdHMuIFBhc3MgVGltZXJJZC5BbGwgdG8gcnVuXHJcbiAgICAgKiAgYWxsIGRlbGF5ZWQgb3BlcmF0aW9ucy5cclxuICAgICAqIEByZXR1cm5zIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIG9uY2UgYWxsIG9wZXJhdGlvbnMgaGF2ZSBiZWVuIHJ1bi5cclxuICAgICAqL1xyXG4gICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUucnVuRGVsYXllZE9wZXJhdGlvbnNFYXJseSA9IGZ1bmN0aW9uIChsYXN0VGltZXJJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gTm90ZSB0aGF0IGRyYWluaW5nIG1heSBnZW5lcmF0ZSBtb3JlIGRlbGF5ZWQgb3BzLCBzbyB3ZSBkbyB0aGF0IGZpcnN0LlxyXG4gICAgICAgIHJldHVybiB0aGlzLmRyYWluKCkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChsYXN0VGltZXJJZCA9PT0gVGltZXJJZC5BbGwgfHxcclxuICAgICAgICAgICAgICAgIF90aGlzLmNvbnRhaW5zRGVsYXllZE9wZXJhdGlvbihsYXN0VGltZXJJZCksIFwiQXR0ZW1wdGVkIHRvIGRyYWluIHRvIG1pc3Npbmcgb3BlcmF0aW9uIFwiICsgbGFzdFRpbWVySWQpO1xyXG4gICAgICAgICAgICAvLyBSdW4gb3BzIGluIHRoZSBzYW1lIG9yZGVyIHRoZXknZCBydW4gaWYgdGhleSByYW4gbmF0dXJhbGx5LlxyXG4gICAgICAgICAgICBfdGhpcy5kZWxheWVkT3BlcmF0aW9ucy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLnRhcmdldFRpbWVNcyAtIGIudGFyZ2V0VGltZU1zOyB9KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IF90aGlzLmRlbGF5ZWRPcGVyYXRpb25zOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9wID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgb3Auc2tpcERlbGF5KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobGFzdFRpbWVySWQgIT09IFRpbWVySWQuQWxsICYmIG9wLnRpbWVySWQgPT09IGxhc3RUaW1lcklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmRyYWluKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIENhbGxlZCBvbmNlIGEgRGVsYXllZE9wZXJhdGlvbiBpcyBydW4gb3IgY2FuY2VsZWQuICovXHJcbiAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS5yZW1vdmVEZWxheWVkT3BlcmF0aW9uID0gZnVuY3Rpb24gKG9wKSB7XHJcbiAgICAgICAgLy8gTk9URTogaW5kZXhPZiAvIHNsaWNlIGFyZSBPKG4pLCBidXQgZGVsYXllZE9wZXJhdGlvbnMgaXMgZXhwZWN0ZWQgdG8gYmUgc21hbGwuXHJcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5kZWxheWVkT3BlcmF0aW9ucy5pbmRleE9mKG9wKTtcclxuICAgICAgICBhc3NlcnQoaW5kZXggPj0gMCwgJ0RlbGF5ZWQgb3BlcmF0aW9uIG5vdCBmb3VuZC4nKTtcclxuICAgICAgICB0aGlzLmRlbGF5ZWRPcGVyYXRpb25zLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFzeW5jUXVldWU7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgZXNjYXBlQ2hhciA9ICdcXHUwMDAxJztcclxudmFyIGVuY29kZWRTZXBhcmF0b3JDaGFyID0gJ1xcdTAwMDEnO1xyXG52YXIgZW5jb2RlZE51bCA9ICdcXHUwMDEwJztcclxudmFyIGVuY29kZWRFc2NhcGUgPSAnXFx1MDAxMSc7XHJcbi8qKlxyXG4gKiBFbmNvZGVzIGEgcmVzb3VyY2UgcGF0aCBpbnRvIGEgSW5kZXhlZERiLWNvbXBhdGlibGUgc3RyaW5nIGZvcm0uXHJcbiAqL1xyXG5mdW5jdGlvbiBlbmNvZGUocGF0aCkge1xyXG4gICAgdmFyIHJlc3VsdCA9ICcnO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXRoLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IGVuY29kZVNlcGFyYXRvcihyZXN1bHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXN1bHQgPSBlbmNvZGVTZWdtZW50KHBhdGguZ2V0KGkpLCByZXN1bHQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGVuY29kZVNlcGFyYXRvcihyZXN1bHQpO1xyXG59XHJcbi8qKiBFbmNvZGVzIGEgc2luZ2xlIHNlZ21lbnQgb2YgYSByZXNvdXJjZSBwYXRoIGludG8gdGhlIGdpdmVuIHJlc3VsdCAqL1xyXG5mdW5jdGlvbiBlbmNvZGVTZWdtZW50KHNlZ21lbnQsIHJlc3VsdEJ1Zikge1xyXG4gICAgdmFyIHJlc3VsdCA9IHJlc3VsdEJ1ZjtcclxuICAgIHZhciBsZW5ndGggPSBzZWdtZW50Lmxlbmd0aDtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgYyA9IHNlZ21lbnQuY2hhckF0KGkpO1xyXG4gICAgICAgIHN3aXRjaCAoYykge1xyXG4gICAgICAgICAgICBjYXNlICdcXDAnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IGVzY2FwZUNoYXIgKyBlbmNvZGVkTnVsO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgZXNjYXBlQ2hhcjpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBlc2NhcGVDaGFyICsgZW5jb2RlZEVzY2FwZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG4vKiogRW5jb2RlcyBhIHBhdGggc2VwYXJhdG9yIGludG8gdGhlIGdpdmVuIHJlc3VsdCAqL1xyXG5mdW5jdGlvbiBlbmNvZGVTZXBhcmF0b3IocmVzdWx0KSB7XHJcbiAgICByZXR1cm4gcmVzdWx0ICsgZXNjYXBlQ2hhciArIGVuY29kZWRTZXBhcmF0b3JDaGFyO1xyXG59XHJcbi8qKlxyXG4gKiBEZWNvZGVzIHRoZSBnaXZlbiBJbmRleGVkRGItY29tcGF0aWJsZSBzdHJpbmcgZm9ybSBvZiBhIHJlc291cmNlIHBhdGggaW50b1xyXG4gKiBhIFJlc291cmNlUGF0aCBpbnN0YW5jZS4gTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGlzIG5vdCBzdWl0YWJsZSBmb3IgdXNlIHdpdGhcclxuICogZGVjb2RpbmcgcmVzb3VyY2UgbmFtZXMgZnJvbSB0aGUgc2VydmVyOyB0aG9zZSBhcmUgT25lIFBsYXRmb3JtIGZvcm1hdFxyXG4gKiBzdHJpbmdzLlxyXG4gKi9cclxuZnVuY3Rpb24gZGVjb2RlJDEocGF0aCkge1xyXG4gICAgLy8gRXZlbnQgdGhlIGVtcHR5IHBhdGggbXVzdCBlbmNvZGUgYXMgYSBwYXRoIG9mIGF0IGxlYXN0IGxlbmd0aCAyLiBBIHBhdGhcclxuICAgIC8vIHdpdGggZXhhY3RseSAyIG11c3QgYmUgdGhlIGVtcHR5IHBhdGguXHJcbiAgICB2YXIgbGVuZ3RoID0gcGF0aC5sZW5ndGg7XHJcbiAgICBhc3NlcnQobGVuZ3RoID49IDIsICdJbnZhbGlkIHBhdGggJyArIHBhdGgpO1xyXG4gICAgaWYgKGxlbmd0aCA9PT0gMikge1xyXG4gICAgICAgIGFzc2VydChwYXRoLmNoYXJBdCgwKSA9PT0gZXNjYXBlQ2hhciAmJiBwYXRoLmNoYXJBdCgxKSA9PT0gZW5jb2RlZFNlcGFyYXRvckNoYXIsICdOb24tZW1wdHkgcGF0aCAnICsgcGF0aCArICcgaGFkIGxlbmd0aCAyJyk7XHJcbiAgICAgICAgcmV0dXJuIFJlc291cmNlUGF0aC5FTVBUWV9QQVRIO1xyXG4gICAgfVxyXG4gICAgLy8gRXNjYXBlIGNoYXJhY3RlcnMgY2Fubm90IGV4aXN0IHBhc3QgdGhlIHNlY29uZC10by1sYXN0IHBvc2l0aW9uIGluIHRoZVxyXG4gICAgLy8gc291cmNlIHZhbHVlLlxyXG4gICAgdmFyIGxhc3RSZWFzb25hYmxlRXNjYXBlSW5kZXggPSBsZW5ndGggLSAyO1xyXG4gICAgdmFyIHNlZ21lbnRzID0gW107XHJcbiAgICB2YXIgc2VnbWVudEJ1aWxkZXIgPSAnJztcclxuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgc3RhcnQgPCBsZW5ndGg7KSB7XHJcbiAgICAgICAgLy8gVGhlIGxhc3QgdHdvIGNoYXJhY3RlcnMgb2YgYSB2YWxpZCBlbmNvZGVkIHBhdGggbXVzdCBiZSBhIHNlcGFyYXRvciwgc29cclxuICAgICAgICAvLyB0aGVyZSBtdXN0IGJlIGFuIGVuZCB0byB0aGlzIHNlZ21lbnQuXHJcbiAgICAgICAgdmFyIGVuZCA9IHBhdGguaW5kZXhPZihlc2NhcGVDaGFyLCBzdGFydCk7XHJcbiAgICAgICAgaWYgKGVuZCA8IDAgfHwgZW5kID4gbGFzdFJlYXNvbmFibGVFc2NhcGVJbmRleCkge1xyXG4gICAgICAgICAgICBmYWlsKCdJbnZhbGlkIGVuY29kZWQgcmVzb3VyY2UgcGF0aDogXCInICsgcGF0aCArICdcIicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbmV4dCA9IHBhdGguY2hhckF0KGVuZCArIDEpO1xyXG4gICAgICAgIHN3aXRjaCAobmV4dCkge1xyXG4gICAgICAgICAgICBjYXNlIGVuY29kZWRTZXBhcmF0b3JDaGFyOlxyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRQaWVjZSA9IHBhdGguc3Vic3RyaW5nKHN0YXJ0LCBlbmQpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlZ21lbnQgPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VnbWVudEJ1aWxkZXIubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQXZvaWQgY29weWluZyBmb3IgdGhlIGNvbW1vbiBjYXNlIG9mIGEgc2VnbWVudCB0aGF0IGV4Y2x1ZGVzIFxcMFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFuZCBcXDAwMVxyXG4gICAgICAgICAgICAgICAgICAgIHNlZ21lbnQgPSBjdXJyZW50UGllY2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWdtZW50QnVpbGRlciArPSBjdXJyZW50UGllY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudCA9IHNlZ21lbnRCdWlsZGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlZ21lbnRCdWlsZGVyID0gJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWdtZW50cy5wdXNoKHNlZ21lbnQpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgZW5jb2RlZE51bDpcclxuICAgICAgICAgICAgICAgIHNlZ21lbnRCdWlsZGVyICs9IHBhdGguc3Vic3RyaW5nKHN0YXJ0LCBlbmQpO1xyXG4gICAgICAgICAgICAgICAgc2VnbWVudEJ1aWxkZXIgKz0gJ1xcMCc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBlbmNvZGVkRXNjYXBlOlxyXG4gICAgICAgICAgICAgICAgLy8gVGhlIGVzY2FwZSBjaGFyYWN0ZXIgY2FuIGJlIHVzZWQgaW4gdGhlIG91dHB1dCB0byBlbmNvZGUgaXRzZWxmLlxyXG4gICAgICAgICAgICAgICAgc2VnbWVudEJ1aWxkZXIgKz0gcGF0aC5zdWJzdHJpbmcoc3RhcnQsIGVuZCArIDEpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBmYWlsKCdJbnZhbGlkIGVuY29kZWQgcmVzb3VyY2UgcGF0aDogXCInICsgcGF0aCArICdcIicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdGFydCA9IGVuZCArIDI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3IFJlc291cmNlUGF0aChzZWdtZW50cyk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBCQVRDSElEX1VOS05PV04gPSAtMTtcclxuLyoqXHJcbiAqIEEgYmF0Y2ggb2YgbXV0YXRpb25zIHRoYXQgd2lsbCBiZSBzZW50IGFzIG9uZSB1bml0IHRvIHRoZSBiYWNrZW5kLlxyXG4gKi9cclxudmFyIE11dGF0aW9uQmF0Y2ggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNdXRhdGlvbkJhdGNoKGJhdGNoSWQsIGxvY2FsV3JpdGVUaW1lLCBtdXRhdGlvbnMpIHtcclxuICAgICAgICB0aGlzLmJhdGNoSWQgPSBiYXRjaElkO1xyXG4gICAgICAgIHRoaXMubG9jYWxXcml0ZVRpbWUgPSBsb2NhbFdyaXRlVGltZTtcclxuICAgICAgICB0aGlzLm11dGF0aW9ucyA9IG11dGF0aW9ucztcclxuICAgICAgICBhc3NlcnQobXV0YXRpb25zLmxlbmd0aCA+IDAsICdDYW5ub3QgY3JlYXRlIGFuIGVtcHR5IG11dGF0aW9uIGJhdGNoJyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFwcGxpZXMgYWxsIHRoZSBtdXRhdGlvbnMgaW4gdGhpcyBNdXRhdGlvbkJhdGNoIHRvIHRoZSBzcGVjaWZpZWQgZG9jdW1lbnRcclxuICAgICAqIHRvIGNyZWF0ZSBhIG5ldyByZW1vdGUgZG9jdW1lbnRcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZG9jS2V5IFRoZSBrZXkgb2YgdGhlIGRvY3VtZW50IHRvIGFwcGx5IG11dGF0aW9ucyB0by5cclxuICAgICAqIEBwYXJhbSBtYXliZURvYyBUaGUgZG9jdW1lbnQgdG8gYXBwbHkgbXV0YXRpb25zIHRvLlxyXG4gICAgICogQHBhcmFtIGJhdGNoUmVzdWx0IFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgdGhlIE11dGF0aW9uQmF0Y2ggdG8gdGhlXHJcbiAgICAgKiBiYWNrZW5kLlxyXG4gICAgICovXHJcbiAgICBNdXRhdGlvbkJhdGNoLnByb3RvdHlwZS5hcHBseVRvUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAoZG9jS2V5LCBtYXliZURvYywgYmF0Y2hSZXN1bHQpIHtcclxuICAgICAgICBpZiAobWF5YmVEb2MpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KG1heWJlRG9jLmtleS5pc0VxdWFsKGRvY0tleSksIFwiYXBwbHlUb1JlbW90ZURvY3VtZW50OiBrZXkgXCIgKyBkb2NLZXkgKyBcIiBzaG91bGQgbWF0Y2ggbWF5YmVEb2Mga2V5XFxuICAgICAgICBcIiArIG1heWJlRG9jLmtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtdXRhdGlvblJlc3VsdHMgPSBiYXRjaFJlc3VsdC5tdXRhdGlvblJlc3VsdHM7XHJcbiAgICAgICAgYXNzZXJ0KG11dGF0aW9uUmVzdWx0cy5sZW5ndGggPT09IHRoaXMubXV0YXRpb25zLmxlbmd0aCwgXCJNaXNtYXRjaCBiZXR3ZWVuIG11dGF0aW9ucyBsZW5ndGhcXG4gICAgICAoXCIgKyB0aGlzLm11dGF0aW9ucy5sZW5ndGggKyBcIikgYW5kIG11dGF0aW9uIHJlc3VsdHMgbGVuZ3RoXFxuICAgICAgKFwiICsgbXV0YXRpb25SZXN1bHRzLmxlbmd0aCArIFwiKS5cIik7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm11dGF0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgbXV0YXRpb24gPSB0aGlzLm11dGF0aW9uc1tpXTtcclxuICAgICAgICAgICAgaWYgKG11dGF0aW9uLmtleS5pc0VxdWFsKGRvY0tleSkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtdXRhdGlvblJlc3VsdCA9IG11dGF0aW9uUmVzdWx0c1tpXTtcclxuICAgICAgICAgICAgICAgIG1heWJlRG9jID0gbXV0YXRpb24uYXBwbHlUb1JlbW90ZURvY3VtZW50KG1heWJlRG9jLCBtdXRhdGlvblJlc3VsdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1heWJlRG9jO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ29tcHV0ZXMgdGhlIGxvY2FsIHZpZXcgb2YgYSBkb2N1bWVudCBnaXZlbiBhbGwgdGhlIG11dGF0aW9ucyBpbiB0aGlzXHJcbiAgICAgKiBiYXRjaC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZG9jS2V5IFRoZSBrZXkgb2YgdGhlIGRvY3VtZW50IHRvIGFwcGx5IG11dGF0aW9ucyB0by5cclxuICAgICAqIEBwYXJhbSBtYXliZURvYyBUaGUgZG9jdW1lbnQgdG8gYXBwbHkgbXV0YXRpb25zIHRvLlxyXG4gICAgICovXHJcbiAgICBNdXRhdGlvbkJhdGNoLnByb3RvdHlwZS5hcHBseVRvTG9jYWxWaWV3ID0gZnVuY3Rpb24gKGRvY0tleSwgbWF5YmVEb2MpIHtcclxuICAgICAgICBpZiAobWF5YmVEb2MpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KG1heWJlRG9jLmtleS5pc0VxdWFsKGRvY0tleSksIFwiYXBwbHlUb0xvY2FsRG9jdW1lbnQ6IGtleSBcIiArIGRvY0tleSArIFwiIHNob3VsZCBtYXRjaCBtYXliZURvYyBrZXlcXG4gICAgICAgIFwiICsgbWF5YmVEb2Mua2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGJhc2VEb2MgPSBtYXliZURvYztcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubXV0YXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBtdXRhdGlvbiA9IHRoaXMubXV0YXRpb25zW2ldO1xyXG4gICAgICAgICAgICBpZiAobXV0YXRpb24ua2V5LmlzRXF1YWwoZG9jS2V5KSkge1xyXG4gICAgICAgICAgICAgICAgbWF5YmVEb2MgPSBtdXRhdGlvbi5hcHBseVRvTG9jYWxWaWV3KG1heWJlRG9jLCBiYXNlRG9jLCB0aGlzLmxvY2FsV3JpdGVUaW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWF5YmVEb2M7XHJcbiAgICB9O1xyXG4gICAgTXV0YXRpb25CYXRjaC5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIga2V5U2V0ID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5tdXRhdGlvbnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBtdXRhdGlvbiA9IF9hW19pXTtcclxuICAgICAgICAgICAga2V5U2V0ID0ga2V5U2V0LmFkZChtdXRhdGlvbi5rZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ga2V5U2V0O1xyXG4gICAgfTtcclxuICAgIE11dGF0aW9uQmF0Y2gucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuYmF0Y2hJZCA9PT0gb3RoZXIuYmF0Y2hJZCAmJlxyXG4gICAgICAgICAgICBhcnJheUVxdWFscyh0aGlzLm11dGF0aW9ucywgb3RoZXIubXV0YXRpb25zKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE11dGF0aW9uQmF0Y2g7XHJcbn0oKSk7XHJcbi8qKiBUaGUgcmVzdWx0IG9mIGFwcGx5aW5nIGEgbXV0YXRpb24gYmF0Y2ggdG8gdGhlIGJhY2tlbmQuICovXHJcbnZhciBNdXRhdGlvbkJhdGNoUmVzdWx0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTXV0YXRpb25CYXRjaFJlc3VsdChiYXRjaCwgY29tbWl0VmVyc2lvbiwgbXV0YXRpb25SZXN1bHRzLCBzdHJlYW1Ub2tlbiwgXHJcbiAgICAvKipcclxuICAgICAqIEEgcHJlLWNvbXB1dGVkIG1hcHBpbmcgZnJvbSBlYWNoIG11dGF0ZWQgZG9jdW1lbnQgdG8gdGhlIHJlc3VsdGluZ1xyXG4gICAgICogdmVyc2lvbi5cclxuICAgICAqL1xyXG4gICAgZG9jVmVyc2lvbnMpIHtcclxuICAgICAgICB0aGlzLmJhdGNoID0gYmF0Y2g7XHJcbiAgICAgICAgdGhpcy5jb21taXRWZXJzaW9uID0gY29tbWl0VmVyc2lvbjtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVzdWx0cyA9IG11dGF0aW9uUmVzdWx0cztcclxuICAgICAgICB0aGlzLnN0cmVhbVRva2VuID0gc3RyZWFtVG9rZW47XHJcbiAgICAgICAgdGhpcy5kb2NWZXJzaW9ucyA9IGRvY1ZlcnNpb25zO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgbmV3IE11dGF0aW9uQmF0Y2hSZXN1bHQgZm9yIHRoZSBnaXZlbiBiYXRjaCBhbmQgcmVzdWx0cy4gVGhlcmVcclxuICAgICAqIG11c3QgYmUgb25lIHJlc3VsdCBmb3IgZWFjaCBtdXRhdGlvbiBpbiB0aGUgYmF0Y2guIFRoaXMgc3RhdGljIGZhY3RvcnlcclxuICAgICAqIGNhY2hlcyBhIGRvY3VtZW50PT52ZXJzaW9uIG1hcHBpbmcgKGRvY1ZlcnNpb25zKS5cclxuICAgICAqL1xyXG4gICAgTXV0YXRpb25CYXRjaFJlc3VsdC5mcm9tID0gZnVuY3Rpb24gKGJhdGNoLCBjb21taXRWZXJzaW9uLCByZXN1bHRzLCBzdHJlYW1Ub2tlbikge1xyXG4gICAgICAgIGFzc2VydChiYXRjaC5tdXRhdGlvbnMubGVuZ3RoID09PSByZXN1bHRzLmxlbmd0aCwgJ011dGF0aW9ucyBzZW50ICcgK1xyXG4gICAgICAgICAgICBiYXRjaC5tdXRhdGlvbnMubGVuZ3RoICtcclxuICAgICAgICAgICAgJyBtdXN0IGVxdWFsIHJlc3VsdHMgcmVjZWl2ZWQgJyArXHJcbiAgICAgICAgICAgIHJlc3VsdHMubGVuZ3RoKTtcclxuICAgICAgICB2YXIgdmVyc2lvbk1hcCA9IGRvY3VtZW50VmVyc2lvbk1hcCgpO1xyXG4gICAgICAgIHZhciBtdXRhdGlvbnMgPSBiYXRjaC5tdXRhdGlvbnM7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtdXRhdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmVyc2lvbk1hcCA9IHZlcnNpb25NYXAuaW5zZXJ0KG11dGF0aW9uc1tpXS5rZXksIHJlc3VsdHNbaV0udmVyc2lvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgTXV0YXRpb25CYXRjaFJlc3VsdChiYXRjaCwgY29tbWl0VmVyc2lvbiwgcmVzdWx0cywgc3RyZWFtVG9rZW4sIHZlcnNpb25NYXApO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNdXRhdGlvbkJhdGNoUmVzdWx0O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFBlcnNpc3RlbmNlUHJvbWlzZTw+IGlzIGVzc2VudGlhbGx5IGEgcmUtaW1wbGVtZW50YXRpb24gb2YgUHJvbWlzZTw+IGV4Y2VwdFxyXG4gKiBpdCBoYXMgYSAubmV4dCgpIG1ldGhvZCBpbnN0ZWFkIG9mIC50aGVuKCkgYW5kIC5uZXh0KCkgYW5kIC5jYXRjaCgpIGNhbGxiYWNrc1xyXG4gKiBhcmUgZXhlY3V0ZWQgc3luY2hyb25vdXNseSB3aGVuIGEgUGVyc2lzdGVuY2VQcm9taXNlIHJlc29sdmVzIHJhdGhlciB0aGFuXHJcbiAqIGFzeW5jaHJvbm91c2x5IChQcm9taXNlPD4gaW1wbGVtZW50YXRpb25zIHVzZSBzZXRJbW1lZGlhdGUoKSBvciBzaW1pbGFyKS5cclxuICpcclxuICogVGhpcyBpcyBuZWNlc3NhcnkgdG8gaW50ZXJvcGVyYXRlIHdpdGggSW5kZXhlZERCIHdoaWNoIHdpbGwgYXV0b21hdGljYWxseVxyXG4gKiBjb21taXQgdHJhbnNhY3Rpb25zIGlmIGNvbnRyb2wgaXMgcmV0dXJuZWQgdG8gdGhlIGV2ZW50IGxvb3Agd2l0aG91dFxyXG4gKiBzeW5jaHJvbm91c2x5IGluaXRpYXRpbmcgYW5vdGhlciBvcGVyYXRpb24gb24gdGhlIHRyYW5zYWN0aW9uLlxyXG4gKlxyXG4gKiBOT1RFOiAudGhlbigpIGFuZCAuY2F0Y2goKSBvbmx5IGFsbG93IGEgc2luZ2xlIGNvbnN1bWVyLCB1bmxpa2Ugbm9ybWFsXHJcbiAqIFByb21pc2VzLlxyXG4gKi9cclxudmFyIFBlcnNpc3RlbmNlUHJvbWlzZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFBlcnNpc3RlbmNlUHJvbWlzZShjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gTk9URTogbmV4dC9jYXRjaENhbGxiYWNrIHdpbGwgYWx3YXlzIHBvaW50IHRvIG91ciBvd24gd3JhcHBlciBmdW5jdGlvbnMsXHJcbiAgICAgICAgLy8gbm90IHRoZSB1c2VyJ3MgcmF3IG5leHQoKSBvciBjYXRjaCgpIGNhbGxiYWNrcy5cclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IEFjY2VwdCBhbnkgcmVzdWx0IHR5cGUgZm9yIHRoZSBuZXh0IGNhbGwgaW4gdGhlIFByb21pc2UgY2hhaW4uXHJcbiAgICAgICAgdGhpcy5uZXh0Q2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgQWNjZXB0IGFueSByZXN1bHQgdHlwZSBmb3IgdGhlIGVycm9yIGhhbmRsZXIuXHJcbiAgICAgICAgdGhpcy5jYXRjaENhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICAvLyBXaGVuIHRoZSBvcGVyYXRpb24gcmVzb2x2ZXMsIHdlJ2xsIHNldCByZXN1bHQgb3IgZXJyb3IgYW5kIG1hcmsgaXNEb25lLlxyXG4gICAgICAgIHRoaXMucmVzdWx0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMuZXJyb3IgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5pc0RvbmUgPSBmYWxzZTtcclxuICAgICAgICAvLyBTZXQgdG8gdHJ1ZSB3aGVuIC50aGVuKCkgb3IgLmNhdGNoKCkgYXJlIGNhbGxlZCBhbmQgcHJldmVudHMgYWRkaXRpb25hbFxyXG4gICAgICAgIC8vIGNoYWluaW5nLlxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tBdHRhY2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIGNhbGxiYWNrKGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICBfdGhpcy5pc0RvbmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBfdGhpcy5yZXN1bHQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgaWYgKF90aGlzLm5leHRDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgLy8gdmFsdWUgc2hvdWxkIGJlIGRlZmluZWQgdW5sZXNzIFQgaXMgVm9pZCwgYnV0IHdlIGNhbid0IGV4cHJlc3NcclxuICAgICAgICAgICAgICAgIC8vIHRoYXQgaW4gdGhlIHR5cGUgc3lzdGVtLlxyXG4gICAgICAgICAgICAgICAgX3RoaXMubmV4dENhbGxiYWNrKHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICBfdGhpcy5pc0RvbmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBfdGhpcy5lcnJvciA9IGVycm9yO1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuY2F0Y2hDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY2F0Y2hDYWxsYmFjayhlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2ggPSBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5uZXh0KHVuZGVmaW5lZCwgZm4pO1xyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChuZXh0Rm4sIGNhdGNoRm4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrQXR0YWNoZWQpIHtcclxuICAgICAgICAgICAgZmFpbCgnQ2FsbGVkIG5leHQoKSBvciBjYXRjaCgpIHR3aWNlIGZvciBQZXJzaXN0ZW5jZVByb21pc2UnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja0F0dGFjaGVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5pc0RvbmUpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy53cmFwU3VjY2VzcyhuZXh0Rm4sIHRoaXMucmVzdWx0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLndyYXBGYWlsdXJlKGNhdGNoRm4sIHRoaXMuZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5uZXh0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy53cmFwU3VjY2VzcyhuZXh0Rm4sIHZhbHVlKS5uZXh0KHJlc29sdmUsIHJlamVjdCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY2F0Y2hDYWxsYmFjayA9IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLndyYXBGYWlsdXJlKGNhdGNoRm4sIGVycm9yKS5uZXh0KHJlc29sdmUsIHJlamVjdCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLnByb3RvdHlwZS50b1Byb21pc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5uZXh0KHJlc29sdmUsIHJlamVjdCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLnByb3RvdHlwZS53cmFwVXNlckZ1bmN0aW9uID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGZuKCk7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBQZXJzaXN0ZW5jZVByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlamVjdChlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLnByb3RvdHlwZS53cmFwU3VjY2VzcyA9IGZ1bmN0aW9uIChuZXh0Rm4sIHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKG5leHRGbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy53cmFwVXNlckZ1bmN0aW9uKGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5leHRGbih2YWx1ZSk7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gSWYgdGhlcmUncyBubyBuZXh0Rm4sIHRoZW4gUiBtdXN0IGJlIHRoZSBzYW1lIGFzIFQgYnV0IHdlXHJcbiAgICAgICAgICAgIC8vIGNhbid0IGV4cHJlc3MgdGhhdCBpbiB0aGUgdHlwZSBzeXN0ZW0uXHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnlcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLnByb3RvdHlwZS53cmFwRmFpbHVyZSA9IGZ1bmN0aW9uIChjYXRjaEZuLCBlcnJvcikge1xyXG4gICAgICAgIGlmIChjYXRjaEZuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndyYXBVc2VyRnVuY3Rpb24oZnVuY3Rpb24gKCkgeyByZXR1cm4gY2F0Y2hGbihlcnJvcik7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2UucmVqZWN0ID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yID0gZnVuY3Rpb24gKFxyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBBY2NlcHQgYWxsIFByb21pc2UgdHlwZXMgaW4gd2FpdEZvcigpLlxyXG4gICAgYWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICB2YXIgZXhwZWN0ZWRDb3VudCA9IDA7XHJcbiAgICAgICAgICAgIHZhciByZXNvbHZlZENvdW50ID0gMDtcclxuICAgICAgICAgICAgdmFyIGRvbmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgYWxsLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICsrZXhwZWN0ZWRDb3VudDtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgKytyZXNvbHZlZENvdW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkb25lICYmIHJlc29sdmVkQ291bnQgPT09IGV4cGVjdGVkQ291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIHJlamVjdChlcnIpOyB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRvbmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAocmVzb2x2ZWRDb3VudCA9PT0gZXhwZWN0ZWRDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBHaXZlbiBhbiBhcnJheSBvZiBwcmVkaWNhdGUgZnVuY3Rpb25zIHRoYXQgYXN5bmNocm9ub3VzbHkgZXZhbHVhdGUgdG8gYVxyXG4gICAgICogYm9vbGVhbiwgaW1wbGVtZW50cyBhIHNob3J0LWNpcmN1aXRpbmcgYG9yYCBiZXR3ZWVuIHRoZSByZXN1bHRzLiBQcmVkaWNhdGVzXHJcbiAgICAgKiB3aWxsIGJlIGV2YWx1YXRlZCB1bnRpbCBvbmUgb2YgdGhlbSByZXR1cm5zIGB0cnVlYCwgdGhlbiBzdG9wLiBUaGUgZmluYWxcclxuICAgICAqIHJlc3VsdCB3aWxsIGJlIHdoZXRoZXIgYW55IG9mIHRoZW0gcmV0dXJuZWQgYHRydWVgLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2Uub3IgPSBmdW5jdGlvbiAocHJlZGljYXRlcykge1xyXG4gICAgICAgIHZhciBwID0gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xyXG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xyXG4gICAgICAgICAgICBwID0gcC5uZXh0KGZ1bmN0aW9uIChpc1RydWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc1RydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoaXNUcnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVkaWNhdGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHByZWRpY2F0ZXNfMSA9IHByZWRpY2F0ZXM7IF9pIDwgcHJlZGljYXRlc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgcHJlZGljYXRlID0gcHJlZGljYXRlc18xW19pXTtcclxuICAgICAgICAgICAgX2xvb3BfMShwcmVkaWNhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEdpdmVuIGFuIGl0ZXJhYmxlLCBjYWxsIHRoZSBnaXZlbiBmdW5jdGlvbiBvbiBlYWNoIGVsZW1lbnQgaW4gdGhlXHJcbiAgICAgKiBjb2xsZWN0aW9uIGFuZCB3YWl0IGZvciBhbGwgb2YgdGhlIHJlc3VsdGluZyBjb25jdXJyZW50IFBlcnNpc3RlbmNlUHJvbWlzZXNcclxuICAgICAqIHRvIHJlc29sdmUuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNvbGxlY3Rpb24sIGYpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIGNvbGxlY3Rpb24uZm9yRWFjaChmdW5jdGlvbiAociwgcykge1xyXG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKGYuY2FsbChfdGhpcywgciwgcykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLndhaXRGb3IocHJvbWlzZXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2U7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQSBtYXAgaW1wbGVtZW50YXRpb24gdGhhdCB1c2VzIG9iamVjdHMgYXMga2V5cy4gT2JqZWN0cyBtdXN0IGltcGxlbWVudCB0aGVcclxuICogRXF1YXRhYmxlIGludGVyZmFjZSBhbmQgbXVzdCBiZSBpbW11dGFibGUuIEVudHJpZXMgaW4gdGhlIG1hcCBhcmUgc3RvcmVkXHJcbiAqIHRvZ2V0aGVyIHdpdGggdGhlIGtleSBiZWluZyBwcm9kdWNlZCBmcm9tIHRoZSBtYXBLZXlGbi4gVGhpcyBtYXBcclxuICogYXV0b21hdGljYWxseSBoYW5kbGVzIGNvbGxpc2lvbnMgb2Yga2V5cy5cclxuICovXHJcbnZhciBPYmplY3RNYXAgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBPYmplY3RNYXAobWFwS2V5Rm4pIHtcclxuICAgICAgICB0aGlzLm1hcEtleUZuID0gbWFwS2V5Rm47XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGlubmVyIG1hcCBmb3IgYSBrZXkgLT4gdmFsdWUgcGFpci4gRHVlIHRvIHRoZSBwb3NzaWJpbGl0eSBvZlxyXG4gICAgICAgICAqIGNvbGxpc2lvbnMgd2Uga2VlcCBhIGxpc3Qgb2YgZW50cmllcyB0aGF0IHdlIGRvIGEgbGluZWFyIHNlYXJjaCB0aHJvdWdoXHJcbiAgICAgICAgICogdG8gZmluZCBhbiBhY3R1YWwgbWF0Y2guIE5vdGUgdGhhdCBjb2xsaXNpb25zIHNob3VsZCBiZSByYXJlLCBzbyB3ZSBzdGlsbFxyXG4gICAgICAgICAqIGV4cGVjdCBuZWFyIGNvbnN0YW50IHRpbWUgbG9va3VwcyBpbiBwcmFjdGljZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmlubmVyID0ge307XHJcbiAgICB9XHJcbiAgICAvKiogR2V0IGEgdmFsdWUgZm9yIHRoaXMga2V5LCBvciB1bmRlZmluZWQgaWYgaXQgZG9lcyBub3QgZXhpc3QuICovXHJcbiAgICBPYmplY3RNYXAucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgaWQgPSB0aGlzLm1hcEtleUZuKGtleSk7XHJcbiAgICAgICAgdmFyIG1hdGNoZXMgPSB0aGlzLmlubmVyW2lkXTtcclxuICAgICAgICBpZiAobWF0Y2hlcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgbWF0Y2hlc18xID0gbWF0Y2hlczsgX2kgPCBtYXRjaGVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBfYSA9IG1hdGNoZXNfMVtfaV0sIG90aGVyS2V5ID0gX2FbMF0sIHZhbHVlID0gX2FbMV07XHJcbiAgICAgICAgICAgIGlmIChvdGhlcktleS5pc0VxdWFsKGtleSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIE9iamVjdE1hcC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldChrZXkpICE9PSB1bmRlZmluZWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqIFB1dCB0aGlzIGtleSBhbmQgdmFsdWUgaW4gdGhlIG1hcC4gKi9cclxuICAgIE9iamVjdE1hcC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgaWQgPSB0aGlzLm1hcEtleUZuKGtleSk7XHJcbiAgICAgICAgdmFyIG1hdGNoZXMgPSB0aGlzLmlubmVyW2lkXTtcclxuICAgICAgICBpZiAobWF0Y2hlcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5uZXJbaWRdID0gW1trZXksIHZhbHVlXV07XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXRjaGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXRjaGVzW2ldWzBdLmlzRXF1YWwoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgbWF0Y2hlc1tpXSA9IFtrZXksIHZhbHVlXTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBtYXRjaGVzLnB1c2goW2tleSwgdmFsdWVdKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZSB0aGlzIGtleSBmcm9tIHRoZSBtYXAuIFJldHVybnMgYSBib29sZWFuIGlmIGFueXRoaW5nIHdhcyBkZWxldGVkLlxyXG4gICAgICovXHJcbiAgICBPYmplY3RNYXAucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgaWQgPSB0aGlzLm1hcEtleUZuKGtleSk7XHJcbiAgICAgICAgdmFyIG1hdGNoZXMgPSB0aGlzLmlubmVyW2lkXTtcclxuICAgICAgICBpZiAobWF0Y2hlcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXRjaGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXRjaGVzW2ldWzBdLmlzRXF1YWwoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuaW5uZXJbaWRdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0TWFwLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgZm9yRWFjaCh0aGlzLmlubmVyLCBmdW5jdGlvbiAoXywgZW50cmllcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGVudHJpZXNfMSA9IGVudHJpZXM7IF9pIDwgZW50cmllc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hID0gZW50cmllc18xW19pXSwgayA9IF9hWzBdLCB2ID0gX2FbMV07XHJcbiAgICAgICAgICAgICAgICBmbihrLCB2KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE9iamVjdE1hcC5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gaXNFbXB0eSh0aGlzLmlubmVyKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gT2JqZWN0TWFwO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEFuIGluLW1lbW9yeSBidWZmZXIgb2YgZW50cmllcyB0byBiZSB3cml0dGVuIHRvIGEgUmVtb3RlRG9jdW1lbnRDYWNoZS5cclxuICogSXQgY2FuIGJlIHVzZWQgdG8gYmF0Y2ggdXAgYSBzZXQgb2YgY2hhbmdlcyB0byBiZSB3cml0dGVuIHRvIHRoZSBjYWNoZSwgYnV0XHJcbiAqIGFkZGl0aW9uYWxseSBzdXBwb3J0cyByZWFkaW5nIGVudHJpZXMgYmFjayB3aXRoIHRoZSBgZ2V0RW50cnkoKWAgbWV0aG9kLFxyXG4gKiBmYWxsaW5nIGJhY2sgdG8gdGhlIHVuZGVybHlpbmcgUmVtb3RlRG9jdW1lbnRDYWNoZSBpZiBubyBlbnRyeSBpc1xyXG4gKiBidWZmZXJlZC5cclxuICpcclxuICogRW50cmllcyBhZGRlZCB0byB0aGUgY2FjaGUgKm11c3QqIGJlIHJlYWQgZmlyc3QuIFRoaXMgaXMgdG8gZmFjaWxpdGF0ZVxyXG4gKiBjYWxjdWxhdGluZyB0aGUgc2l6ZSBkZWx0YSBvZiB0aGUgcGVuZGluZyBjaGFuZ2VzLlxyXG4gKlxyXG4gKiBQT1JUSU5HIE5PVEU6IFRoaXMgY2xhc3Mgd2FzIGltcGxlbWVudGVkIHRoZW4gcmVtb3ZlZCBmcm9tIG90aGVyIHBsYXRmb3Jtcy5cclxuICogSWYgYnl0ZS1jb3VudGluZyBlbmRzIHVwIGJlaW5nIG5lZWRlZCBvbiB0aGUgb3RoZXIgcGxhdGZvcm1zLCBjb25zaWRlclxyXG4gKiBwb3J0aW5nIHRoaXMgY2xhc3MgYXMgcGFydCBvZiB0aGF0IGltcGxlbWVudGF0aW9uIHdvcmsuXHJcbiAqL1xyXG52YXIgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcigpIHtcclxuICAgICAgICB0aGlzLmNoYW5nZXMgPSBtYXliZURvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudFNpemVzID0gbmV3IE9iamVjdE1hcChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBrZXkudG9TdHJpbmcoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKiBCdWZmZXJzIGEgYFJlbW90ZURvY3VtZW50Q2FjaGUuYWRkRW50cnkoKWAgY2FsbC4gKi9cclxuICAgIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLnByb3RvdHlwZS5hZGRFbnRyeSA9IGZ1bmN0aW9uIChtYXliZURvY3VtZW50KSB7XHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSB0aGlzLmFzc2VydENoYW5nZXMoKTtcclxuICAgICAgICB0aGlzLmNoYW5nZXMgPSBjaGFuZ2VzLmluc2VydChtYXliZURvY3VtZW50LmtleSwgbWF5YmVEb2N1bWVudCk7XHJcbiAgICB9O1xyXG4gICAgLy8gTk9URTogcmVtb3ZlRW50cnkoKSBpcyBpbnRlbnRpb25hbGx5IG9taXR0ZWQuIElmIGl0IG5lZWRzIHRvIGJlIGFkZGVkIGluXHJcbiAgICAvLyB0aGUgZnV0dXJlIGl0IG11c3QgdGFrZSBieXRlIGNvdW50aW5nIGludG8gYWNjb3VudC5cclxuICAgIC8qKlxyXG4gICAgICogTG9va3MgdXAgYW4gZW50cnkgaW4gdGhlIGNhY2hlLiBUaGUgYnVmZmVyZWQgY2hhbmdlcyB3aWxsIGZpcnN0IGJlIGNoZWNrZWQsXHJcbiAgICAgKiBhbmQgaWYgbm8gYnVmZmVyZWQgY2hhbmdlIGFwcGxpZXMsIHRoaXMgd2lsbCBmb3J3YXJkIHRvXHJcbiAgICAgKiBgUmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSgpYC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdHJhbnNhY3Rpb24gVGhlIHRyYW5zYWN0aW9uIGluIHdoaWNoIHRvIHBlcmZvcm0gYW55IHBlcnNpc3RlbmNlXHJcbiAgICAgKiAgICAgb3BlcmF0aW9ucy5cclxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBsb29rIHVwLlxyXG4gICAgICogQHJldHVybiBUaGUgY2FjaGVkIERvY3VtZW50IG9yIE5vRG9jdW1lbnQgZW50cnksIG9yIG51bGwgaWYgd2UgaGF2ZSBub3RoaW5nXHJcbiAgICAgKiBjYWNoZWQuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLnByb3RvdHlwZS5nZXRFbnRyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gdGhpcy5hc3NlcnRDaGFuZ2VzKCk7XHJcbiAgICAgICAgdmFyIGJ1ZmZlcmVkRW50cnkgPSBjaGFuZ2VzLmdldChkb2N1bWVudEtleSk7XHJcbiAgICAgICAgaWYgKGJ1ZmZlcmVkRW50cnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGJ1ZmZlcmVkRW50cnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gUmVjb3JkIHRoZSBzaXplIG9mIGV2ZXJ5dGhpbmcgd2UgbG9hZCBmcm9tIHRoZSBjYWNoZSBzbyB3ZSBjYW4gY29tcHV0ZSBhIGRlbHRhIGxhdGVyLlxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGcm9tQ2FjaGUodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KS5uZXh0KGZ1bmN0aW9uIChnZXRSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChnZXRSZXN1bHQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5kb2N1bWVudFNpemVzLnNldChkb2N1bWVudEtleSwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5kb2N1bWVudFNpemVzLnNldChkb2N1bWVudEtleSwgZ2V0UmVzdWx0LnNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRSZXN1bHQubWF5YmVEb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQXBwbGllcyBidWZmZXJlZCBjaGFuZ2VzIHRvIHRoZSB1bmRlcmx5aW5nIFJlbW90ZURvY3VtZW50Q2FjaGUsIHVzaW5nXHJcbiAgICAgKiB0aGUgcHJvdmlkZWQgdHJhbnNhY3Rpb24uXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLnByb3RvdHlwZS5hcHBseSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmFwcGx5Q2hhbmdlcyh0cmFuc2FjdGlvbik7XHJcbiAgICAgICAgLy8gV2Ugc2hvdWxkIG5vdCBidWZmZXIgYW55IG1vcmUgY2hhbmdlcy5cclxuICAgICAgICB0aGlzLmNoYW5nZXMgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgLyoqIEhlbHBlciB0byBhc3NlcnQgdGhpcy5jaGFuZ2VzIGlzIG5vdCBudWxsIGFuZCByZXR1cm4gaXQuICovXHJcbiAgICBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlci5wcm90b3R5cGUuYXNzZXJ0Q2hhbmdlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5jaGFuZ2VzICE9PSBudWxsLCAnQ2hhbmdlcyBoYXZlIGFscmVhZHkgYmVlbiBhcHBsaWVkLicpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNoYW5nZXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckMSA9ICdTaW1wbGVEYic7XHJcbi8qKlxyXG4gKiBQcm92aWRlcyBhIHdyYXBwZXIgYXJvdW5kIEluZGV4ZWREYiB3aXRoIGEgc2ltcGxpZmllZCBpbnRlcmZhY2UgdGhhdCB1c2VzXHJcbiAqIFByb21pc2UtbGlrZSByZXR1cm4gdmFsdWVzIHRvIGNoYWluIG9wZXJhdGlvbnMuIFJlYWwgcHJvbWlzZXMgY2Fubm90IGJlIHVzZWRcclxuICogc2luY2UgLnRoZW4oKSBjb250aW51YXRpb25zIGFyZSBleGVjdXRlZCBhc3luY2hyb25vdXNseSAoZS5nLiB2aWFcclxuICogLnNldEltbWVkaWF0ZSksIHdoaWNoIHdvdWxkIGNhdXNlIEluZGV4ZWREQiB0byBlbmQgdGhlIHRyYW5zYWN0aW9uLlxyXG4gKiBTZWUgUGVyc2lzdGVuY2VQcm9taXNlIGZvciBtb3JlIGRldGFpbHMuXHJcbiAqL1xyXG52YXIgU2ltcGxlRGIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTaW1wbGVEYihkYikge1xyXG4gICAgICAgIHRoaXMuZGIgPSBkYjtcclxuICAgIH1cclxuICAgIC8qKiBPcGVucyB0aGUgc3BlY2lmaWVkIGRhdGFiYXNlLCBjcmVhdGluZyBvciB1cGdyYWRpbmcgaXQgaWYgbmVjZXNzYXJ5LiAqL1xyXG4gICAgU2ltcGxlRGIub3Blbk9yQ3JlYXRlID0gZnVuY3Rpb24gKG5hbWUsIHZlcnNpb24sIHNjaGVtYUNvbnZlcnRlcikge1xyXG4gICAgICAgIGFzc2VydChTaW1wbGVEYi5pc0F2YWlsYWJsZSgpLCAnSW5kZXhlZERCIG5vdCBzdXBwb3J0ZWQgaW4gY3VycmVudCBlbnZpcm9ubWVudC4nKTtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdPcGVuaW5nIGRhdGFiYXNlOicsIG5hbWUpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBJbnZlc3RpZ2F0ZSBicm93c2VyIGNvbXBhdGliaWxpdHkuXHJcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9JbmRleGVkREJfQVBJL1VzaW5nX0luZGV4ZWREQlxyXG4gICAgICAgICAgICAvLyBzdWdnZXN0cyBJRTkgYW5kIG9sZGVyIFdlYktpdCBicm93c2VycyBoYW5kbGUgdXBncmFkZVxyXG4gICAgICAgICAgICAvLyBkaWZmZXJlbnRseS4gVGhleSBleHBlY3Qgc2V0VmVyc2lvbiwgYXMgZGVzY3JpYmVkIGhlcmU6XHJcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9JREJWZXJzaW9uQ2hhbmdlUmVxdWVzdC9zZXRWZXJzaW9uXHJcbiAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gd2luZG93LmluZGV4ZWREQi5vcGVuKG5hbWUsIHZlcnNpb24pO1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUobmV3IFNpbXBsZURiKGRiKSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub25ibG9ja2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sICdDYW5ub3QgdXBncmFkZSBJbmRleGVkREIgc2NoZW1hIHdoaWxlIGFub3RoZXIgdGFiIGlzIG9wZW4uICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICdDbG9zZSBhbGwgdGFicyB0aGF0IGFjY2VzcyBGaXJlc3RvcmUgYW5kIHJlbG9hZCB0aGlzIHBhZ2UgdG8gcHJvY2VlZC4nKSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdEYXRhYmFzZSBcIicgKyBuYW1lICsgJ1wiIHJlcXVpcmVzIHVwZ3JhZGUgZnJvbSB2ZXJzaW9uOicsIGV2ZW50Lm9sZFZlcnNpb24pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgIC8vIFdlIGFyZSBwcm92aWRlZCBhIHZlcnNpb24gdXBncmFkZSB0cmFuc2FjdGlvbiBmcm9tIHRoZSByZXF1ZXN0LCBzb1xyXG4gICAgICAgICAgICAgICAgLy8gd2Ugd3JhcCB0aGF0IGluIGEgU2ltcGxlRGJUcmFuc2FjdGlvbiB0byBhbGxvdyB1c2Ugb2Ygb3VyIGZyaWVuZGxpZXJcclxuICAgICAgICAgICAgICAgIC8vIEFQSSBmb3Igc2NoZW1hIG1pZ3JhdGlvbiBvcGVyYXRpb25zLlxyXG4gICAgICAgICAgICAgICAgdmFyIHR4biA9IG5ldyBTaW1wbGVEYlRyYW5zYWN0aW9uKHJlcXVlc3QudHJhbnNhY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgc2NoZW1hQ29udmVydGVyXHJcbiAgICAgICAgICAgICAgICAgICAgLmNyZWF0ZU9yVXBncmFkZShkYiwgdHhuLCBldmVudC5vbGRWZXJzaW9uLCBTQ0hFTUFfVkVSU0lPTilcclxuICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnRGF0YWJhc2UgdXBncmFkZSB0byB2ZXJzaW9uICcgKyBTQ0hFTUFfVkVSU0lPTiArICcgY29tcGxldGUnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pLnRvUHJvbWlzZSgpO1xyXG4gICAgfTtcclxuICAgIC8qKiBEZWxldGVzIHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UuICovXHJcbiAgICBTaW1wbGVEYi5kZWxldGUgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMSwgJ1JlbW92aW5nIGRhdGFiYXNlOicsIG5hbWUpO1xyXG4gICAgICAgIHJldHVybiB3cmFwUmVxdWVzdCh3aW5kb3cuaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKG5hbWUpKS50b1Byb21pc2UoKTtcclxuICAgIH07XHJcbiAgICAvKiogUmV0dXJucyB0cnVlIGlmIEluZGV4ZWREQiBpcyBhdmFpbGFibGUgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuICovXHJcbiAgICBTaW1wbGVEYi5pc0F2YWlsYWJsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgd2luZG93LmluZGV4ZWREQiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gV2UgZXh0ZW5zaXZlbHkgdXNlIGluZGV4ZWQgYXJyYXkgdmFsdWVzIGFuZCBjb21wb3VuZCBrZXlzLFxyXG4gICAgICAgIC8vIHdoaWNoIElFIGFuZCBFZGdlIGRvIG5vdCBzdXBwb3J0LiBIb3dldmVyLCB0aGV5IHN0aWxsIGhhdmUgaW5kZXhlZERCXHJcbiAgICAgICAgLy8gZGVmaW5lZCBvbiB0aGUgd2luZG93LCBzbyB3ZSBuZWVkIHRvIGNoZWNrIGZvciB0aGVtIGhlcmUgYW5kIG1ha2Ugc3VyZVxyXG4gICAgICAgIC8vIHRvIHJldHVybiB0aGF0IHBlcnNpc3RlbmNlIGlzIG5vdCBlbmFibGVkIGZvciB0aG9zZSBicm93c2Vycy5cclxuICAgICAgICAvLyBGb3IgdHJhY2tpbmcgc3VwcG9ydCBvZiB0aGlzIGZlYXR1cmUsIHNlZSBoZXJlOlxyXG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vZW4tdXMvbWljcm9zb2Z0LWVkZ2UvcGxhdGZvcm0vc3RhdHVzL2luZGV4ZWRkYmFycmF5c2FuZG11bHRpZW50cnlzdXBwb3J0L1xyXG4gICAgICAgIC8vIElmIHdlIGFyZSBydW5uaW5nIGluIE5vZGUgdXNpbmcgdGhlIEluZGV4ZWREQlNoaW0sIGB3aW5kb3dgIGlzIGRlZmluZWQsXHJcbiAgICAgICAgLy8gYnV0IGB3aW5kb3cubmF2aWdhdG9yYCBpcyBub3QuIEluIHRoaXMgY2FzZSwgd2Ugc3VwcG9ydCBJbmRleGVkREIgYW5kXHJcbiAgICAgICAgLy8gcmV0dXJuIGB0cnVlYC5cclxuICAgICAgICBpZiAod2luZG93Lm5hdmlnYXRvciA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcm9jZXNzLmVudi5VU0VfTU9DS19QRVJTSVNURU5DRSA9PT0gJ1lFUyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIENoZWNrIHRoZSBVQSBzdHJpbmcgdG8gZmluZCBvdXQgdGhlIGJyb3dzZXIuXHJcbiAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBNb3ZlIHRoaXMgbG9naWMgaW50byBwYWNrYWdlcy91dGlsL2Vudmlyb25tZW50LnRzXHJcbiAgICAgICAgdmFyIHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ7XHJcbiAgICAgICAgLy8gSUUgMTBcclxuICAgICAgICAvLyB1YSA9ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSAxMC4wOyBXaW5kb3dzIE5UIDYuMjsgVHJpZGVudC82LjApJztcclxuICAgICAgICAvLyBJRSAxMVxyXG4gICAgICAgIC8vIHVhID0gJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMzsgVHJpZGVudC83LjA7IHJ2OjExLjApIGxpa2UgR2Vja28nO1xyXG4gICAgICAgIC8vIEVkZ2VcclxuICAgICAgICAvLyB1YSA9ICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXT1c2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCxcclxuICAgICAgICAvLyBsaWtlIEdlY2tvKSBDaHJvbWUvMzkuMC4yMTcxLjcxIFNhZmFyaS81MzcuMzYgRWRnZS8xMi4wJztcclxuICAgICAgICBpZiAodWEuaW5kZXhPZignTVNJRSAnKSA+IDAgfHxcclxuICAgICAgICAgICAgdWEuaW5kZXhPZignVHJpZGVudC8nKSA+IDAgfHxcclxuICAgICAgICAgICAgdWEuaW5kZXhPZignRWRnZS8nKSA+IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmcm9tIGEgdHJhbnNhY3Rpb24uICovXHJcbiAgICBTaW1wbGVEYi5nZXRTdG9yZSA9IGZ1bmN0aW9uICh0eG4sIHN0b3JlKSB7XHJcbiAgICAgICAgcmV0dXJuIHR4bi5zdG9yZShzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgU2ltcGxlRGIucHJvdG90eXBlLnJ1blRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKG1vZGUsIG9iamVjdFN0b3JlcywgdHJhbnNhY3Rpb25Gbikge1xyXG4gICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IFNpbXBsZURiVHJhbnNhY3Rpb24ub3Blbih0aGlzLmRiLCBtb2RlLCBvYmplY3RTdG9yZXMpO1xyXG4gICAgICAgIHZhciB0cmFuc2FjdGlvbkZuUmVzdWx0ID0gdHJhbnNhY3Rpb25Gbih0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgICAgICAvLyBBYm9ydCB0aGUgdHJhbnNhY3Rpb24gaWYgdGhlcmUgd2FzIGFuIGVycm9yLlxyXG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5hYm9ydChlcnJvciQkMSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRvUHJvbWlzZSgpO1xyXG4gICAgICAgIC8vIFdhaXQgZm9yIHRoZSB0cmFuc2FjdGlvbiB0byBjb21wbGV0ZSAoaS5lLiBJbmRleGVkRGIncyBvbnN1Y2Nlc3MgZXZlbnQgdG9cclxuICAgICAgICAvLyBmaXJlKSwgYnV0IHN0aWxsIHJldHVybiB0aGUgb3JpZ2luYWwgdHJhbnNhY3Rpb25GblJlc3VsdCBiYWNrIHRvIHRoZVxyXG4gICAgICAgIC8vIGNhbGxlci5cclxuICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb24uY29tcGxldGlvblByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiB0cmFuc2FjdGlvbkZuUmVzdWx0OyB9KTtcclxuICAgIH07XHJcbiAgICBTaW1wbGVEYi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5kYi5jbG9zZSgpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTaW1wbGVEYjtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgY29udHJvbGxlciBmb3IgaXRlcmF0aW5nIG92ZXIgYSBrZXkgcmFuZ2Ugb3IgaW5kZXguIEl0IGFsbG93cyBhbiBpdGVyYXRlXHJcbiAqIGNhbGxiYWNrIHRvIGRlbGV0ZSB0aGUgY3VycmVudGx5LXJlZmVyZW5jZWQgb2JqZWN0LCBvciBqdW1wIHRvIGEgbmV3IGtleVxyXG4gKiB3aXRoaW4gdGhlIGtleSByYW5nZSBvciBpbmRleC5cclxuICovXHJcbnZhciBJdGVyYXRpb25Db250cm9sbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSXRlcmF0aW9uQ29udHJvbGxlcihkYkN1cnNvcikge1xyXG4gICAgICAgIHRoaXMuZGJDdXJzb3IgPSBkYkN1cnNvcjtcclxuICAgICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5leHRLZXkgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEl0ZXJhdGlvbkNvbnRyb2xsZXIucHJvdG90eXBlLCBcImlzRG9uZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNob3VsZFN0b3A7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlcmF0aW9uQ29udHJvbGxlci5wcm90b3R5cGUsIFwic2tpcFRvS2V5XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmV4dEtleTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVyYXRpb25Db250cm9sbGVyLnByb3RvdHlwZSwgXCJjdXJzb3JcIiwge1xyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGJDdXJzb3IgPSB2YWx1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiBjYW4gYmUgY2FsbGVkIHRvIHN0b3AgaXRlcmF0aW9uIGF0IGFueSBwb2ludC5cclxuICAgICAqL1xyXG4gICAgSXRlcmF0aW9uQ29udHJvbGxlci5wcm90b3R5cGUuZG9uZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNob3VsZFN0b3AgPSB0cnVlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiBjYW4gYmUgY2FsbGVkIHRvIHNraXAgdG8gdGhhdCBuZXh0IGtleSwgd2hpY2ggY291bGQgYmVcclxuICAgICAqIGFuIGluZGV4IG9yIGEgcHJpbWFyeSBrZXkuXHJcbiAgICAgKi9cclxuICAgIEl0ZXJhdGlvbkNvbnRyb2xsZXIucHJvdG90eXBlLnNraXAgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdGhpcy5uZXh0S2V5ID0ga2V5O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogRGVsZXRlIHRoZSBjdXJyZW50IGN1cnNvciB2YWx1ZSBmcm9tIHRoZSBvYmplY3Qgc3RvcmUuXHJcbiAgICAgKlxyXG4gICAgICogTk9URTogWW91IENBTk5PVCBkbyB0aGlzIHdpdGggYSBrZXlzT25seSBxdWVyeS5cclxuICAgICAqL1xyXG4gICAgSXRlcmF0aW9uQ29udHJvbGxlci5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB3cmFwUmVxdWVzdCh0aGlzLmRiQ3Vyc29yLmRlbGV0ZSgpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gSXRlcmF0aW9uQ29udHJvbGxlcjtcclxufSgpKTtcclxuLyoqXHJcbiAqIFdyYXBzIGFuIElEQlRyYW5zYWN0aW9uIGFuZCBleHBvc2VzIGEgc3RvcmUoKSBtZXRob2QgdG8gZ2V0IGEgaGFuZGxlIHRvIGFcclxuICogc3BlY2lmaWMgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxudmFyIFNpbXBsZURiVHJhbnNhY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTaW1wbGVEYlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnRyYW5zYWN0aW9uID0gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgdGhpcy5hYm9ydGVkID0gZmFsc2U7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgcmVzdWx0IG9mIHRoZSBJbmRleGVkRGIgdHJhbnNhY3Rpb24uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jb21wbGV0aW9uRGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQkMSgpO1xyXG4gICAgICAgIHRoaXMudHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMuY29tcGxldGlvbkRlZmVycmVkLnJlc29sdmUoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMudHJhbnNhY3Rpb24ub25hYm9ydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHRyYW5zYWN0aW9uLmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jb21wbGV0aW9uRGVmZXJyZWQucmVqZWN0KHRyYW5zYWN0aW9uLmVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNvbXBsZXRpb25EZWZlcnJlZC5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMudHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBfdGhpcy5jb21wbGV0aW9uRGVmZXJyZWQucmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIFNpbXBsZURiVHJhbnNhY3Rpb24ub3BlbiA9IGZ1bmN0aW9uIChkYiwgbW9kZSwgb2JqZWN0U3RvcmVOYW1lcykge1xyXG4gICAgICAgIHJldHVybiBuZXcgU2ltcGxlRGJUcmFuc2FjdGlvbihkYi50cmFuc2FjdGlvbihvYmplY3RTdG9yZU5hbWVzLCBtb2RlKSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNpbXBsZURiVHJhbnNhY3Rpb24ucHJvdG90eXBlLCBcImNvbXBsZXRpb25Qcm9taXNlXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcGxldGlvbkRlZmVycmVkLnByb21pc2U7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBTaW1wbGVEYlRyYW5zYWN0aW9uLnByb3RvdHlwZS5hYm9ydCA9IGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgIGlmIChlcnJvciQkMSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRpb25EZWZlcnJlZC5yZWplY3QoZXJyb3IkJDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuYWJvcnRlZCkge1xyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdBYm9ydGluZyB0cmFuc2FjdGlvbjonLCBlcnJvciQkMSA/IGVycm9yJCQxLm1lc3NhZ2UgOiAnQ2xpZW50LWluaXRpYXRlZCBhYm9ydCcpO1xyXG4gICAgICAgICAgICB0aGlzLmFib3J0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLmFib3J0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIFNpbXBsZURiU3RvcmU8S2V5VHlwZSwgVmFsdWVUeXBlPiBmb3IgdGhlIHNwZWNpZmllZCBzdG9yZS4gQWxsXHJcbiAgICAgKiBvcGVyYXRpb25zIHBlcmZvcm1lZCBvbiB0aGUgU2ltcGxlRGJTdG9yZSBoYXBwZW4gd2l0aGluIHRoZSBjb250ZXh0IG9mIHRoaXNcclxuICAgICAqIHRyYW5zYWN0aW9uIGFuZCBpdCBjYW5ub3QgYmUgdXNlZCBhbnltb3JlIG9uY2UgdGhlIHRyYW5zYWN0aW9uIGlzXHJcbiAgICAgKiBjb21wbGV0ZWQuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IHdlIGNhbid0IGFjdHVhbGx5IGVuZm9yY2UgdGhhdCB0aGUgS2V5VHlwZSBhbmQgVmFsdWVUeXBlIGFyZVxyXG4gICAgICogY29ycmVjdCwgYnV0IHRoZXkgYWxsb3cgdHlwZSBzYWZldHkgdGhyb3VnaCB0aGUgcmVzdCBvZiB0aGUgY29uc3VtaW5nIGNvZGUuXHJcbiAgICAgKi9cclxuICAgIFNpbXBsZURiVHJhbnNhY3Rpb24ucHJvdG90eXBlLnN0b3JlID0gZnVuY3Rpb24gKHN0b3JlTmFtZSkge1xyXG4gICAgICAgIHZhciBzdG9yZSA9IHRoaXMudHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTtcclxuICAgICAgICBhc3NlcnQoISFzdG9yZSwgJ09iamVjdCBzdG9yZSBub3QgcGFydCBvZiB0cmFuc2FjdGlvbjogJyArIHN0b3JlTmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTaW1wbGVEYlN0b3JlKHN0b3JlKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU2ltcGxlRGJUcmFuc2FjdGlvbjtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgd3JhcHBlciBhcm91bmQgYW4gSURCT2JqZWN0U3RvcmUgcHJvdmlkaW5nIGFuIEFQSSB0aGF0OlxyXG4gKlxyXG4gKiAxKSBIYXMgZ2VuZXJpYyBLZXlUeXBlIC8gVmFsdWVUeXBlIHBhcmFtZXRlcnMgdG8gcHJvdmlkZSBzdHJvbmdseS10eXBlZFxyXG4gKiBtZXRob2RzIGZvciBhY3RpbmcgYWdhaW5zdCB0aGUgb2JqZWN0IHN0b3JlLlxyXG4gKiAyKSBEZWFscyB3aXRoIEluZGV4ZWREQidzIG9uc3VjY2VzcyAvIG9uZXJyb3IgZXZlbnQgY2FsbGJhY2tzLCBtYWtpbmcgZXZlcnlcclxuICogbWV0aG9kIHJldHVybiBhIFBlcnNpc3RlbmNlUHJvbWlzZSBpbnN0ZWFkLlxyXG4gKiAzKSBQcm92aWRlcyBhIGhpZ2hlci1sZXZlbCBBUEkgdG8gYXZvaWQgbmVlZGluZyB0byBkbyBleGNlc3NpdmUgd3JhcHBpbmcgb2ZcclxuICogaW50ZXJtZWRpYXRlIEluZGV4ZWREQiB0eXBlcyAoSURCQ3Vyc29yV2l0aFZhbHVlLCBldGMuKVxyXG4gKi9cclxudmFyIFNpbXBsZURiU3RvcmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTaW1wbGVEYlN0b3JlKHN0b3JlKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yZSA9IHN0b3JlO1xyXG4gICAgfVxyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUucHV0ID0gZnVuY3Rpb24gKGtleU9yVmFsdWUsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIHJlcXVlc3Q7XHJcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnUFVUJywgdGhpcy5zdG9yZS5uYW1lLCBrZXlPclZhbHVlLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIHJlcXVlc3QgPSB0aGlzLnN0b3JlLnB1dCh2YWx1ZSwga2V5T3JWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdQVVQnLCB0aGlzLnN0b3JlLm5hbWUsICc8YXV0by1rZXk+Jywga2V5T3JWYWx1ZSk7XHJcbiAgICAgICAgICAgIHJlcXVlc3QgPSB0aGlzLnN0b3JlLnB1dChrZXlPclZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHdyYXBSZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhIG5ldyB2YWx1ZSBpbnRvIGFuIE9iamVjdCBTdG9yZSBhbmQgcmV0dXJucyB0aGUgbmV3IGtleS4gU2ltaWxhciB0b1xyXG4gICAgICogSW5kZXhlZERiJ3MgYGFkZCgpYCwgdGhpcyBtZXRob2Qgd2lsbCBmYWlsIG9uIHByaW1hcnkga2V5IGNvbGxpc2lvbnMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlIFRoZSBvYmplY3QgdG8gd3JpdGUuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIGFkZC5cclxuICAgICAqL1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnQUREJywgdGhpcy5zdG9yZS5uYW1lLCB2YWx1ZSwgdmFsdWUpO1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0gdGhpcy5zdG9yZS5hZGQodmFsdWUpO1xyXG4gICAgICAgIHJldHVybiB3cmFwUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEdldHMgdGhlIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IGZyb20gdGhlIHNwZWNpZmllZCBzdG9yZSwgb3IgbnVsbFxyXG4gICAgICogaWYgbm8gb2JqZWN0IGV4aXN0cyB3aXRoIHRoZSBzcGVjaWZpZWQga2V5LlxyXG4gICAgICpcclxuICAgICAqIEBrZXkgVGhlIGtleSBvZiB0aGUgb2JqZWN0IHRvIGdldC5cclxuICAgICAqIEByZXR1cm4gVGhlIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IG9yIG51bGwgaWYgbm8gb2JqZWN0IGV4aXN0cy5cclxuICAgICAqL1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB0aGlzLnN0b3JlLmdldChrZXkpO1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgV2UncmUgZG9pbmcgYW4gdW5zYWZlIGNhc3QgdG8gVmFsdWVUeXBlLlxyXG4gICAgICAgIHJldHVybiB3cmFwUmVxdWVzdChyZXF1ZXN0KS5uZXh0KGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgLy8gTm9ybWFsaXplIG5vbmV4aXN0ZW5jZSB0byBudWxsLlxyXG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnR0VUJywgX3RoaXMuc3RvcmUubmFtZSwga2V5LCByZXN1bHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdERUxFVEUnLCB0aGlzLnN0b3JlLm5hbWUsIGtleSk7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB0aGlzLnN0b3JlLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgIHJldHVybiB3cmFwUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIElmIHdlIGV2ZXIgbmVlZCBtb3JlIG9mIHRoZSBjb3VudCB2YXJpYW50cywgd2UgY2FuIGFkZCBvdmVybG9hZHMuIEZvciBub3csXHJcbiAgICAgKiBhbGwgd2UgbmVlZCBpcyB0byBjb3VudCBldmVyeXRoaW5nIGluIGEgc3RvcmUuXHJcbiAgICAgKlxyXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHJvd3MgaW4gdGhlIHN0b3JlLlxyXG4gICAgICovXHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5jb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdDT1VOVCcsIHRoaXMuc3RvcmUubmFtZSk7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB0aGlzLnN0b3JlLmNvdW50KCk7XHJcbiAgICAgICAgcmV0dXJuIHdyYXBSZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgfTtcclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLmxvYWRBbGwgPSBmdW5jdGlvbiAoaW5kZXhPclJhbmdlLCByYW5nZSkge1xyXG4gICAgICAgIHZhciBjdXJzb3IgPSB0aGlzLmN1cnNvcih0aGlzLm9wdGlvbnMoaW5kZXhPclJhbmdlLCByYW5nZSkpO1xyXG4gICAgICAgIHZhciByZXN1bHRzID0gW107XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlcmF0ZUN1cnNvcihjdXJzb3IsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgfSkubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLmRlbGV0ZUFsbCA9IGZ1bmN0aW9uIChpbmRleE9yUmFuZ2UsIHJhbmdlKSB7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnREVMRVRFIEFMTCcsIHRoaXMuc3RvcmUubmFtZSk7XHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMoaW5kZXhPclJhbmdlLCByYW5nZSk7XHJcbiAgICAgICAgb3B0aW9ucy5rZXlzT25seSA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBjdXJzb3IgPSB0aGlzLmN1cnNvcihvcHRpb25zKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRlQ3Vyc29yKGN1cnNvciwgZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgLy8gTk9URTogQ2FsbGluZyBkZWxldGUoKSBvbiBhIGN1cnNvciBpcyBkb2N1bWVudGVkIGFzIG1vcmUgZWZmaWNpZW50IHRoYW5cclxuICAgICAgICAgICAgLy8gY2FsbGluZyBkZWxldGUoKSBvbiBhbiBvYmplY3Qgc3RvcmUgd2l0aCBhIHNpbmdsZSBrZXlcclxuICAgICAgICAgICAgLy8gKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9JREJPYmplY3RTdG9yZS9kZWxldGUpLFxyXG4gICAgICAgICAgICAvLyBob3dldmVyLCB0aGlzIHJlcXVpcmVzIHVzICpub3QqIHRvIHVzZSBhIGtleXNPbmx5IGN1cnNvclxyXG4gICAgICAgICAgICAvLyAoaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0lEQkN1cnNvci9kZWxldGUpLiBXZVxyXG4gICAgICAgICAgICAvLyBtYXkgd2FudCB0byBjb21wYXJlIHRoZSBwZXJmb3JtYW5jZSBvZiBlYWNoIG1ldGhvZC5cclxuICAgICAgICAgICAgcmV0dXJuIGNvbnRyb2wuZGVsZXRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUuaXRlcmF0ZSA9IGZ1bmN0aW9uIChvcHRpb25zT3JDYWxsYmFjaywgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgb3B0aW9ucztcclxuICAgICAgICBpZiAoIWNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMgPSB7fTtcclxuICAgICAgICAgICAgY2FsbGJhY2sgPSBvcHRpb25zT3JDYWxsYmFjaztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zT3JDYWxsYmFjaztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGN1cnNvciA9IHRoaXMuY3Vyc29yKG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLml0ZXJhdGVDdXJzb3IoY3Vyc29yLCBjYWxsYmFjayk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGEgc3RvcmUsIGJ1dCB3YWl0cyBmb3IgdGhlIGdpdmVuIGNhbGxiYWNrIHRvIGNvbXBsZXRlIGZvclxyXG4gICAgICogZWFjaCBlbnRyeSBiZWZvcmUgaXRlcmF0aW5nIHRoZSBuZXh0IGVudHJ5LiBUaGlzIGFsbG93cyB0aGUgY2FsbGJhY2sgdG8gZG9cclxuICAgICAqIGFzeW5jaHJvbm91cyB3b3JrIHRvIGRldGVybWluZSBpZiB0aGlzIGl0ZXJhdGlvbiBzaG91bGQgY29udGludWUuXHJcbiAgICAgKlxyXG4gICAgICogVGhlIHByb3ZpZGVkIGNhbGxiYWNrIHNob3VsZCByZXR1cm4gYHRydWVgIHRvIGNvbnRpbnVlIGl0ZXJhdGlvbiwgYW5kXHJcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cclxuICAgICAqL1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUuaXRlcmF0ZVNlcmlhbCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBjdXJzb3JSZXF1ZXN0ID0gdGhpcy5jdXJzb3Ioe30pO1xyXG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgY3Vyc29yUmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoZXZlbnQudGFyZ2V0LmVycm9yKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY3Vyc29yUmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjdXJzb3IgPSBldmVudC50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJzb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soY3Vyc29yLnByaW1hcnlLZXksIGN1cnNvci52YWx1ZSkubmV4dChmdW5jdGlvbiAoc2hvdWxkQ29udGludWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdWxkQ29udGludWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUuaXRlcmF0ZUN1cnNvciA9IGZ1bmN0aW9uIChjdXJzb3JSZXF1ZXN0LCBmbikge1xyXG4gICAgICAgIHZhciByZXN1bHRzID0gW107XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBjdXJzb3JSZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjdXJzb3JSZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnNvciA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnNvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgY29udHJvbGxlciA9IG5ldyBJdGVyYXRpb25Db250cm9sbGVyKGN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlclJlc3VsdCA9IGZuKGN1cnNvci5wcmltYXJ5S2V5LCBjdXJzb3IudmFsdWUsIGNvbnRyb2xsZXIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJSZXN1bHQgaW5zdGFuY2VvZiBQZXJzaXN0ZW5jZVByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlclByb21pc2UgPSB1c2VyUmVzdWx0LmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5kb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHVzZXJQcm9taXNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjb250cm9sbGVyLmlzRG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNvbnRyb2xsZXIuc2tpcFRvS2V5ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoY29udHJvbGxlci5za2lwVG9LZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocmVzdWx0cyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUub3B0aW9ucyA9IGZ1bmN0aW9uIChpbmRleE9yUmFuZ2UsIHJhbmdlKSB7XHJcbiAgICAgICAgdmFyIGluZGV4TmFtZSA9IHVuZGVmaW5lZDtcclxuICAgICAgICBpZiAoaW5kZXhPclJhbmdlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbmRleE9yUmFuZ2UgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICBpbmRleE5hbWUgPSBpbmRleE9yUmFuZ2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQocmFuZ2UgPT09IHVuZGVmaW5lZCwgJzNyZCBhcmd1bWVudCBtdXN0IG5vdCBiZSBkZWZpbmVkIGlmIDJuZCBpcyBhIHJhbmdlLicpO1xyXG4gICAgICAgICAgICAgICAgcmFuZ2UgPSBpbmRleE9yUmFuZ2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHsgaW5kZXg6IGluZGV4TmFtZSwgcmFuZ2U6IHJhbmdlIH07XHJcbiAgICB9O1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUuY3Vyc29yID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgZGlyZWN0aW9uID0gJ25leHQnO1xyXG4gICAgICAgIGlmIChvcHRpb25zLnJldmVyc2UpIHtcclxuICAgICAgICAgICAgZGlyZWN0aW9uID0gJ3ByZXYnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0aW9ucy5pbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLnN0b3JlLmluZGV4KG9wdGlvbnMuaW5kZXgpO1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5rZXlzT25seSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4Lm9wZW5LZXlDdXJzb3Iob3B0aW9ucy5yYW5nZSwgZGlyZWN0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpbmRleC5vcGVuQ3Vyc29yKG9wdGlvbnMucmFuZ2UsIGRpcmVjdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0b3JlLm9wZW5DdXJzb3Iob3B0aW9ucy5yYW5nZSwgZGlyZWN0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNpbXBsZURiU3RvcmU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBXcmFwcyBhbiBJREJSZXF1ZXN0IGluIGEgUGVyc2lzdGVuY2VQcm9taXNlLCB1c2luZyB0aGUgb25zdWNjZXNzIC8gb25lcnJvclxyXG4gKiBoYW5kbGVycyB0byByZXNvbHZlIC8gcmVqZWN0IHRoZSBQZXJzaXN0ZW5jZVByb21pc2UgYXMgYXBwcm9wcmlhdGUuXHJcbiAqL1xyXG5mdW5jdGlvbiB3cmFwUmVxdWVzdChyZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICByZWplY3QoZXZlbnQudGFyZ2V0LmVycm9yKTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBSRU1PVEVfRE9DVU1FTlRfQ0hBTkdFX01JU1NJTkdfRVJSX01TRyA9ICdUaGUgcmVtb3RlIGRvY3VtZW50IGNoYW5nZWxvZyBubyBsb25nZXIgY29udGFpbnMgYWxsIGNoYW5nZXMgZm9yIGFsbCAnICtcclxuICAgICdsb2NhbCBxdWVyeSB2aWV3cy4gSXQgbWF5IGJlIG5lY2Vzc2FyeSB0byByZWJ1aWxkIHRoZXNlIHZpZXdzLic7XHJcbnZhciBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0ge0xvY2FsU2VyaWFsaXplcn0gc2VyaWFsaXplciBUaGUgZG9jdW1lbnQgc2VyaWFsaXplci5cclxuICAgICAqIEBwYXJhbSBrZWVwRG9jdW1lbnRDaGFuZ2VMb2cgV2hldGhlciB0byBrZWVwIGEgZG9jdW1lbnQgY2hhbmdlIGxvZyBpblxyXG4gICAgICogSW5kZXhlZERiLiBUaGlzIGNoYW5nZSBsb2cgaXMgcmVxdWlyZWQgZm9yIE11bHRpLVRhYiBzeW5jaHJvbml6YXRpb24sIGJ1dFxyXG4gICAgICogbm90IG5lZWRlZCBpbiBjbGllbnRzIHRoYXQgZG9uJ3Qgc2hhcmUgYWNjZXNzIHRvIHRoZWlyIHJlbW90ZSBkb2N1bWVudFxyXG4gICAgICogY2FjaGUuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUoc2VyaWFsaXplciwga2VlcERvY3VtZW50Q2hhbmdlTG9nKSB7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcclxuICAgICAgICB0aGlzLmtlZXBEb2N1bWVudENoYW5nZUxvZyA9IGtlZXBEb2N1bWVudENoYW5nZUxvZztcclxuICAgICAgICAvKiogVGhlIGxhc3QgaWQgcmVhZCBieSBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLiAqL1xyXG4gICAgICAgIHRoaXMuX2xhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkID0gMDtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZSwgXCJsYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIHVwIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUuXHJcbiAgICAgKlxyXG4gICAgICogUmVhZHMgdGhlIElEIG9mIHRoZSBsYXN0ICBkb2N1bWVudCBjaGFuZ2UgZnJvbSB0aGUgZG9jdW1lbnRDaGFuZ2VzIHN0b3JlLlxyXG4gICAgICogRXhpc3RpbmcgY2hhbmdlcyB3aWxsIG5vdCBiZSByZXR1cm5lZCBhcyBwYXJ0IG9mXHJcbiAgICAgKiBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLlxyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgc3RvcmUgPSBTaW1wbGVEYi5nZXRTdG9yZSh0cmFuc2FjdGlvbiwgRGJSZW1vdGVEb2N1bWVudENoYW5nZXMuc3RvcmUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnN5bmNocm9uaXplTGFzdERvY3VtZW50Q2hhbmdlSWQoc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWRkcyB0aGUgc3VwcGxpZWQgZW50cmllcyB0byB0aGUgY2FjaGUuIEFkZHMgdGhlIGdpdmVuIHNpemUgZGVsdGEgdG8gdGhlIGNhY2hlZCBzaXplLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5hZGRFbnRyaWVzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBlbnRyaWVzLCBzaXplRGVsdGEpIHtcclxuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICBpZiAoZW50cmllcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBkb2N1bWVudFN0b3JlID0gcmVtb3RlRG9jdW1lbnRzU3RvcmUodHJhbnNhY3Rpb24pO1xyXG4gICAgICAgICAgICB2YXIgY2hhbmdlZEtleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGVudHJpZXNfMSA9IGVudHJpZXM7IF9pIDwgZW50cmllc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hID0gZW50cmllc18xW19pXSwga2V5ID0gX2Eua2V5LCBkb2MgPSBfYS5kb2M7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGRvY3VtZW50U3RvcmUucHV0KGRiS2V5KGtleSksIGRvYykpO1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlZEtleXMgPSBjaGFuZ2VkS2V5cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5rZWVwRG9jdW1lbnRDaGFuZ2VMb2cpIHtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goZG9jdW1lbnRDaGFuZ2VzU3RvcmUodHJhbnNhY3Rpb24pLnB1dCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlczogdGhpcy5zZXJpYWxpemVyLnRvRGJSZXNvdXJjZVBhdGhzKGNoYW5nZWRLZXlzKVxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2godGhpcy51cGRhdGVTaXplKHRyYW5zYWN0aW9uLCBzaXplRGVsdGEpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgYSBkb2N1bWVudCBmcm9tIHRoZSBjYWNoZS4gTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGRvZXMgKm5vdCogZG8gYW55XHJcbiAgICAgKiBzaXplIGFjY291bnRpbmcuIEl0IGlzIHRoZSByZXNwb25zaWJpbGl0eSBvZiB0aGUgY2FsbGVyIHRvIGNvdW50IHRoZSBieXRlcyByZW1vdmVkXHJcbiAgICAgKiBhbmQgaXNzdWUgYSBmaW5hbCB1cGRhdGVTaXplKCkgY2FsbCBhZnRlciByZW1vdmluZyBkb2N1bWVudHMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGRvY3VtZW50S2V5IFRoZSBrZXkgb2YgdGhlIGRvY3VtZW50IHRvIHJlbW92ZVxyXG4gICAgICogQHJldHVybiBUaGUgc2l6ZSBvZiB0aGUgZG9jdW1lbnQgdGhhdCB3YXMgcmVtb3ZlZC5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUucmVtb3ZlRW50cnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgLy8gV2UgZG9uJ3QgbmVlZCB0byBrZWVwIGNoYW5nZWxvZyBmb3IgdGhlc2UgcmVtb3ZhbHMgc2luY2UgYHJlbW92ZUVudHJ5YCBpc1xyXG4gICAgICAgIC8vIG9ubHkgdXNlZCBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uLlxyXG4gICAgICAgIHZhciBzdG9yZSA9IHJlbW90ZURvY3VtZW50c1N0b3JlKHRyYW5zYWN0aW9uKTtcclxuICAgICAgICB2YXIga2V5ID0gZGJLZXkoZG9jdW1lbnRLZXkpO1xyXG4gICAgICAgIHJldHVybiBzdG9yZS5nZXQoa2V5KS5uZXh0KGZ1bmN0aW9uIChkb2N1bWVudCkge1xyXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdG9yZS5kZWxldGUoa2V5KS5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGRiRG9jdW1lbnRTaXplKGRvY3VtZW50KTsgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXRFbnRyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiByZW1vdGVEb2N1bWVudHNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLmdldChkYktleShkb2N1bWVudEtleSkpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChkYlJlbW90ZURvYykge1xyXG4gICAgICAgICAgICByZXR1cm4gZGJSZW1vdGVEb2NcclxuICAgICAgICAgICAgICAgID8gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJSZW1vdGVEb2N1bWVudChkYlJlbW90ZURvYylcclxuICAgICAgICAgICAgICAgIDogbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIExvb2tzIHVwIGFuIGVudHJ5IGluIHRoZSBjYWNoZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXkgVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gbG9vayB1cC5cclxuICAgICAqIEByZXR1cm4gVGhlIGNhY2hlZCBNYXliZURvY3VtZW50IGVudHJ5IGFuZCBpdHMgc2l6ZSwgb3IgbnVsbCBpZiB3ZSBoYXZlIG5vdGhpbmcgY2FjaGVkLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXRTaXplZEVudHJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHJlbW90ZURvY3VtZW50c1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuZ2V0KGRiS2V5KGRvY3VtZW50S2V5KSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGRiUmVtb3RlRG9jKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYlJlbW90ZURvY1xyXG4gICAgICAgICAgICAgICAgPyB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF5YmVEb2N1bWVudDogX3RoaXMuc2VyaWFsaXplci5mcm9tRGJSZW1vdGVEb2N1bWVudChkYlJlbW90ZURvYyksXHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogZGJEb2N1bWVudFNpemUoZGJSZW1vdGVEb2MpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICA6IG51bGw7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXN1bHRzID0gZG9jdW1lbnRNYXAoKTtcclxuICAgICAgICAvLyBEb2N1bWVudHMgYXJlIG9yZGVyZWQgYnkga2V5LCBzbyB3ZSBjYW4gdXNlIGEgcHJlZml4IHNjYW4gdG8gbmFycm93IGRvd25cclxuICAgICAgICAvLyB0aGUgZG9jdW1lbnRzIHdlIG5lZWQgdG8gbWF0Y2ggdGhlIHF1ZXJ5IGFnYWluc3QuXHJcbiAgICAgICAgdmFyIHN0YXJ0S2V5ID0gcXVlcnkucGF0aC50b0FycmF5KCk7XHJcbiAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChzdGFydEtleSk7XHJcbiAgICAgICAgcmV0dXJuIHJlbW90ZURvY3VtZW50c1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuaXRlcmF0ZSh7IHJhbmdlOiByYW5nZSB9LCBmdW5jdGlvbiAoa2V5LCBkYlJlbW90ZURvYywgY29udHJvbCkge1xyXG4gICAgICAgICAgICB2YXIgbWF5YmVEb2MgPSBfdGhpcy5zZXJpYWxpemVyLmZyb21EYlJlbW90ZURvY3VtZW50KGRiUmVtb3RlRG9jKTtcclxuICAgICAgICAgICAgaWYgKCFxdWVyeS5wYXRoLmlzUHJlZml4T2YobWF5YmVEb2Mua2V5LnBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChtYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50ICYmIHF1ZXJ5Lm1hdGNoZXMobWF5YmVEb2MpKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5pbnNlcnQobWF5YmVEb2Mua2V5LCBtYXliZURvYyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiByZXN1bHRzOyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXROZXdEb2N1bWVudENoYW5nZXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmtlZXBEb2N1bWVudENoYW5nZUxvZywgJ0NhbiBvbmx5IGNhbGwgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKCkgd2hlbiBkb2N1bWVudCBjaGFuZ2UgbG9nIGlzIGVuYWJsZWQnKTtcclxuICAgICAgICB2YXIgY2hhbmdlZEtleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHZhciBjaGFuZ2VkRG9jcyA9IG1heWJlRG9jdW1lbnRNYXAoKTtcclxuICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKHRoaXMuX2xhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkICsgMSk7XHJcbiAgICAgICAgdmFyIGZpcnN0SXRlcmF0aW9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgY2hhbmdlc1N0b3JlID0gZG9jdW1lbnRDaGFuZ2VzU3RvcmUodHJhbnNhY3Rpb24pO1xyXG4gICAgICAgIHJldHVybiBjaGFuZ2VzU3RvcmVcclxuICAgICAgICAgICAgLml0ZXJhdGUoeyByYW5nZTogcmFuZ2UgfSwgZnVuY3Rpb24gKF8sIGRvY3VtZW50Q2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGlmIChmaXJzdEl0ZXJhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgZmlyc3RJdGVyYXRpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vIElmIG91ciBjbGllbnQgd2FzIHRocm90dGxlZCBmb3IgbW9yZSB0aGFuIDMwIG1pbnV0ZXMsIGFub3RoZXJcclxuICAgICAgICAgICAgICAgIC8vIGNsaWVudCBtYXkgaGF2ZSBnYXJiYWdlIGNvbGxlY3RlZCB0aGUgcmVtb3RlIGRvY3VtZW50IGNoYW5nZWxvZy5cclxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQgKyAxICE9PSBkb2N1bWVudENoYW5nZS5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlc2V0IHRoZSBgbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWRgIHRvIGFsbG93IGZ1cnRoZXJcclxuICAgICAgICAgICAgICAgICAgICAvLyBpbnZvY2F0aW9ucyB0byBzdWNjZXNzZnVsbHkgcmV0dXJuIHRoZSBjaGFuZ2VzIGFmdGVyIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICAvLyByZWplY3Rpb24uXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN5bmNocm9uaXplTGFzdERvY3VtZW50Q2hhbmdlSWQoY2hhbmdlc1N0b3JlKS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKENvZGUuREFUQV9MT1NTLCBSRU1PVEVfRE9DVU1FTlRfQ0hBTkdFX01JU1NJTkdfRVJSX01TRykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNoYW5nZWRLZXlzID0gY2hhbmdlZEtleXMudW5pb25XaXRoKF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiUmVzb3VyY2VQYXRocyhkb2N1bWVudENoYW5nZS5jaGFuZ2VzKSk7XHJcbiAgICAgICAgICAgIF90aGlzLl9sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCA9IGRvY3VtZW50Q2hhbmdlLmlkO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRvY3VtZW50UHJvbWlzZXMgPSBbXTtcclxuICAgICAgICAgICAgY2hhbmdlZEtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudFByb21pc2VzLnB1c2goX3RoaXMuZ2V0RW50cnkodHJhbnNhY3Rpb24sIGtleSkubmV4dChmdW5jdGlvbiAobWF5YmVEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkb2MgPSBtYXliZURvY3VtZW50IHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb0RvY3VtZW50KGtleSwgU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZERvY3MgPSBjaGFuZ2VkRG9jcy5pbnNlcnQoa2V5LCBkb2MpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKGRvY3VtZW50UHJvbWlzZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNoYW5nZWREb2NzOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgYWxsIGNoYW5nZXMgaW4gdGhlIHJlbW90ZSBkb2N1bWVudCBjaGFuZ2Vsb2cgdGhyb3VnaCBgY2hhbmdlSWRgXHJcbiAgICAgKiAoaW5jbHVzaXZlKS5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUucmVtb3ZlRG9jdW1lbnRDaGFuZ2VzVGhyb3VnaENoYW5nZUlkID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBjaGFuZ2VJZCkge1xyXG4gICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLnVwcGVyQm91bmQoY2hhbmdlSWQpO1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudENoYW5nZXNTdG9yZSh0cmFuc2FjdGlvbikuZGVsZXRlKHJhbmdlKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5zeW5jaHJvbml6ZUxhc3REb2N1bWVudENoYW5nZUlkID0gZnVuY3Rpb24gKGRvY3VtZW50Q2hhbmdlc1N0b3JlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBJZiB0aGVyZSBhcmUgbm8gZXhpc3RpbmcgY2hhbmdlcywgd2Ugc2V0IGBsYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZGBcclxuICAgICAgICAvLyB0byAwIHNpbmNlIEluZGV4ZWREYidzIGF1dG8tZ2VuZXJhdGVkIGtleXMgc3RhcnQgYXQgMS5cclxuICAgICAgICB0aGlzLl9sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCA9IDA7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50Q2hhbmdlc1N0b3JlLml0ZXJhdGUoeyBrZXlzT25seTogdHJ1ZSwgcmV2ZXJzZTogdHJ1ZSB9LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29udHJvbCkge1xyXG4gICAgICAgICAgICBfdGhpcy5fbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQgPSBrZXk7XHJcbiAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLm5ld0NoYW5nZUJ1ZmZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWV0YWRhdGEodHhuKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkgeyByZXR1cm4gbWV0YWRhdGEuYnl0ZVNpemU7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldE1ldGFkYXRhID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudEdsb2JhbFN0b3JlKHR4bilcclxuICAgICAgICAgICAgLmdldChEYlJlbW90ZURvY3VtZW50R2xvYmFsLmtleSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIGFzc2VydCghIW1ldGFkYXRhLCAnTWlzc2luZyBkb2N1bWVudCBjYWNoZSBtZXRhZGF0YScpO1xyXG4gICAgICAgICAgICByZXR1cm4gbWV0YWRhdGE7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuc2V0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHhuLCBtZXRhZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudEdsb2JhbFN0b3JlKHR4bikucHV0KERiUmVtb3RlRG9jdW1lbnRHbG9iYWwua2V5LCBtZXRhZGF0YSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIHRoZSBnaXZlbiBkZWx0YSB0byB0aGUgY2FjaGVkIGN1cnJlbnQgc2l6ZS4gQ2FsbGVycyB0byByZW1vdmVFbnRyeSAqbXVzdCogY2FsbCB0aGlzXHJcbiAgICAgKiBhZnRlcndhcmRzIHRvIHVwZGF0ZSB0aGUgc2l6ZSBvZiB0aGUgY2FjaGUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHNpemVEZWx0YVxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS51cGRhdGVTaXplID0gZnVuY3Rpb24gKHR4biwgc2l6ZURlbHRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXRhZGF0YSh0eG4pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLmJ5dGVTaXplICs9IHNpemVEZWx0YTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNldE1ldGFkYXRhKHR4biwgbWV0YWRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBkb2N1bWVudEdsb2JhbFN0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJSZW1vdGVEb2N1bWVudEdsb2JhbC5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIEhhbmRsZXMgdGhlIGRldGFpbHMgb2YgYWRkaW5nIGFuZCB1cGRhdGluZyBkb2N1bWVudHMgaW4gdGhlIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGVcclxuICovXHJcbnZhciBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIoZG9jdW1lbnRDYWNoZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuZG9jdW1lbnRDYWNoZSA9IGRvY3VtZW50Q2FjaGU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIucHJvdG90eXBlLmFwcGx5Q2hhbmdlcyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSB0aGlzLmFzc2VydENoYW5nZXMoKTtcclxuICAgICAgICB2YXIgZGVsdGEgPSAwO1xyXG4gICAgICAgIHZhciB0b0FwcGx5ID0gW107XHJcbiAgICAgICAgY2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIG1heWJlRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIGRvYyA9IF90aGlzLmRvY3VtZW50Q2FjaGUuc2VyaWFsaXplci50b0RiUmVtb3RlRG9jdW1lbnQobWF5YmVEb2N1bWVudCk7XHJcbiAgICAgICAgICAgIHZhciBwcmV2aW91c1NpemUgPSBfdGhpcy5kb2N1bWVudFNpemVzLmdldChrZXkpO1xyXG4gICAgICAgICAgICAvLyBOT1RFOiBpZiB3ZSBldmVyIGRlY2lkZSB3ZSBuZWVkIHRvIHN1cHBvcnQgZG9pbmcgd3JpdGVzIHdpdGhvdXRcclxuICAgICAgICAgICAgLy8gcmVhZGluZyBmaXJzdCwgdGhpcyBhc3NlcnQgd2lsbCBuZWVkIHRvIGNoYW5nZSB0byBkbyB0aGUgcmVhZCBhdXRvbWF0aWNhbGx5LlxyXG4gICAgICAgICAgICBhc3NlcnQocHJldmlvdXNTaXplICE9PSB1bmRlZmluZWQsIFwiQXR0ZW1wdGluZyB0byBjaGFuZ2UgZG9jdW1lbnQgXCIgKyBrZXkudG9TdHJpbmcoKSArIFwiIHdpdGhvdXQgaGF2aW5nIHJlYWQgaXQgZmlyc3RcIik7XHJcbiAgICAgICAgICAgIHZhciBzaXplID0gZGJEb2N1bWVudFNpemUoZG9jKTtcclxuICAgICAgICAgICAgZGVsdGEgKz0gc2l6ZSAtIHByZXZpb3VzU2l6ZTtcclxuICAgICAgICAgICAgdG9BcHBseS5wdXNoKHsga2V5OiBrZXksIGRvYzogZG9jIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50Q2FjaGUuYWRkRW50cmllcyh0cmFuc2FjdGlvbiwgdG9BcHBseSwgZGVsdGEpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLnByb3RvdHlwZS5nZXRGcm9tQ2FjaGUgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRDYWNoZS5nZXRTaXplZEVudHJ5KHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyO1xyXG59KFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyKSk7XHJcbmZ1bmN0aW9uIGlzRG9jdW1lbnRDaGFuZ2VNaXNzaW5nRXJyb3IoZXJyKSB7XHJcbiAgICByZXR1cm4gKGVyci5jb2RlID09PSBDb2RlLkRBVEFfTE9TUyAmJlxyXG4gICAgICAgIGVyci5tZXNzYWdlID09PSBSRU1PVEVfRE9DVU1FTlRfQ0hBTkdFX01JU1NJTkdfRVJSX01TRyk7XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgcmVtb3RlRG9jdW1lbnRzIG9iamVjdCBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIHJlbW90ZURvY3VtZW50c1N0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJSZW1vdGVEb2N1bWVudC5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgcmVtb3RlRG9jdW1lbnRDaGFuZ2VzIG9iamVjdFxyXG4gKiBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIGRvY3VtZW50Q2hhbmdlc1N0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJSZW1vdGVEb2N1bWVudENoYW5nZXMuc3RvcmUpO1xyXG59XHJcbmZ1bmN0aW9uIGRiS2V5KGRvY0tleSkge1xyXG4gICAgcmV0dXJuIGRvY0tleS5wYXRoLnRvQXJyYXkoKTtcclxufVxyXG4vKipcclxuICogUmV0cnVzbiBhbiBhcHByb3hpbWF0ZSBzaXplIGZvciB0aGUgZ2l2ZW4gZG9jdW1lbnQuXHJcbiAqL1xyXG5mdW5jdGlvbiBkYkRvY3VtZW50U2l6ZShkb2MpIHtcclxuICAgIHZhciB2YWx1ZTtcclxuICAgIGlmIChkb2MuZG9jdW1lbnQpIHtcclxuICAgICAgICB2YWx1ZSA9IGRvYy5kb2N1bWVudDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGRvYy51bmtub3duRG9jdW1lbnQpIHtcclxuICAgICAgICB2YWx1ZSA9IGRvYy51bmtub3duRG9jdW1lbnQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChkb2Mubm9Eb2N1bWVudCkge1xyXG4gICAgICAgIHZhbHVlID0gZG9jLm5vRG9jdW1lbnQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB0aHJvdyBmYWlsKCdVbmtub3duIHJlbW90ZSBkb2N1bWVudCB0eXBlJyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodmFsdWUpLmxlbmd0aDtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFNjaGVtYSBWZXJzaW9uIGZvciB0aGUgV2ViIGNsaWVudDpcclxuICogMS4gSW5pdGlhbCB2ZXJzaW9uIGluY2x1ZGluZyBNdXRhdGlvbiBRdWV1ZSwgUXVlcnkgQ2FjaGUsIGFuZCBSZW1vdGUgRG9jdW1lbnRcclxuICogICAgQ2FjaGVcclxuICogMi4gVXNlZCB0byBlbnN1cmUgYSB0YXJnZXRHbG9iYWwgb2JqZWN0IGV4aXN0cyBhbmQgYWRkIHRhcmdldENvdW50IHRvIGl0LiBOb1xyXG4gKiAgICBsb25nZXIgcmVxdWlyZWQgYmVjYXVzZSBtaWdyYXRpb24gMyB1bmNvbmRpdGlvbmFsbHkgY2xlYXJzIGl0LlxyXG4gKiAzLiBEcm9wcGVkIGFuZCByZS1jcmVhdGVkIFF1ZXJ5IENhY2hlIHRvIGRlYWwgd2l0aCBjYWNoZSBjb3JydXB0aW9uIHJlbGF0ZWRcclxuICogICAgdG8gbGltYm8gcmVzb2x1dGlvbi4gQWRkcmVzc2VzXHJcbiAqICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1pb3Mtc2RrL2lzc3Vlcy8xNTQ4XHJcbiAqIDQuIE11bHRpLVRhYiBTdXBwb3J0LlxyXG4gKiA1LiBSZW1vdmFsIG9mIGhlbGQgd3JpdGUgYWNrcy5cclxuICovXHJcbnZhciBTQ0hFTUFfVkVSU0lPTiA9IDY7XHJcbi8qKiBQZXJmb3JtcyBkYXRhYmFzZSBjcmVhdGlvbiBhbmQgc2NoZW1hIHVwZ3JhZGVzLiAqL1xyXG52YXIgU2NoZW1hQ29udmVydGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2NoZW1hQ29udmVydGVyKHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQZXJmb3JtcyBkYXRhYmFzZSBjcmVhdGlvbiBhbmQgc2NoZW1hIHVwZ3JhZGVzLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCBpbiBwcm9kdWN0aW9uLCB0aGlzIG1ldGhvZCBpcyBvbmx5IGV2ZXIgdXNlZCB0byB1cGdyYWRlIHRoZSBzY2hlbWFcclxuICAgICAqIHRvIFNDSEVNQV9WRVJTSU9OLiBEaWZmZXJlbnQgdmFsdWVzIG9mIHRvVmVyc2lvbiBhcmUgb25seSB1c2VkIGZvciB0ZXN0aW5nXHJcbiAgICAgKiBhbmQgbG9jYWwgZmVhdHVyZSBkZXZlbG9wbWVudC5cclxuICAgICAqL1xyXG4gICAgU2NoZW1hQ29udmVydGVyLnByb3RvdHlwZS5jcmVhdGVPclVwZ3JhZGUgPSBmdW5jdGlvbiAoZGIsIHR4biwgZnJvbVZlcnNpb24sIHRvVmVyc2lvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KGZyb21WZXJzaW9uIDwgdG9WZXJzaW9uICYmXHJcbiAgICAgICAgICAgIGZyb21WZXJzaW9uID49IDAgJiZcclxuICAgICAgICAgICAgdG9WZXJzaW9uIDw9IFNDSEVNQV9WRVJTSU9OLCBcIlVuZXhwZWN0ZWQgc2NoZW1hIHVwZ3JhZGUgZnJvbSB2XCIgKyBmcm9tVmVyc2lvbiArIFwiIHRvIHZ7dG9WZXJzaW9ufS5cIik7XHJcbiAgICAgICAgaWYgKGZyb21WZXJzaW9uIDwgMSAmJiB0b1ZlcnNpb24gPj0gMSkge1xyXG4gICAgICAgICAgICBjcmVhdGVQcmltYXJ5Q2xpZW50U3RvcmUoZGIpO1xyXG4gICAgICAgICAgICBjcmVhdGVNdXRhdGlvblF1ZXVlKGRiKTtcclxuICAgICAgICAgICAgY3JlYXRlUXVlcnlDYWNoZShkYik7XHJcbiAgICAgICAgICAgIGNyZWF0ZVJlbW90ZURvY3VtZW50Q2FjaGUoZGIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBNaWdyYXRpb24gMiB0byBwb3B1bGF0ZSB0aGUgdGFyZ2V0R2xvYmFsIG9iamVjdCBubyBsb25nZXIgbmVlZGVkIHNpbmNlXHJcbiAgICAgICAgLy8gbWlncmF0aW9uIDMgdW5jb25kaXRpb25hbGx5IGNsZWFycyBpdC5cclxuICAgICAgICB2YXIgcCA9IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgaWYgKGZyb21WZXJzaW9uIDwgMyAmJiB0b1ZlcnNpb24gPj0gMykge1xyXG4gICAgICAgICAgICAvLyBCcmFuZCBuZXcgY2xpZW50cyBkb24ndCBuZWVkIHRvIGRyb3AgYW5kIHJlY3JlYXRlLS1vbmx5IGNsaWVudHMgdGhhdFxyXG4gICAgICAgICAgICAvLyBwb3RlbnRpYWxseSBoYXZlIGNvcnJ1cHQgZGF0YS5cclxuICAgICAgICAgICAgaWYgKGZyb21WZXJzaW9uICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBkcm9wUXVlcnlDYWNoZShkYik7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVRdWVyeUNhY2hlKGRiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwID0gcC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHdyaXRlRW1wdHlUYXJnZXRHbG9iYWxFbnRyeSh0eG4pOyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZyb21WZXJzaW9uIDwgNCAmJiB0b1ZlcnNpb24gPj0gNCkge1xyXG4gICAgICAgICAgICBpZiAoZnJvbVZlcnNpb24gIT09IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIFNjaGVtYSB2ZXJzaW9uIDMgdXNlcyBhdXRvLWdlbmVyYXRlZCBrZXlzIHRvIGdlbmVyYXRlIGdsb2JhbGx5IHVuaXF1ZVxyXG4gICAgICAgICAgICAgICAgLy8gbXV0YXRpb24gYmF0Y2ggSURzICh0aGlzIHdhcyBwcmV2aW91c2x5IGVuc3VyZWQgaW50ZXJuYWxseSBieSB0aGVcclxuICAgICAgICAgICAgICAgIC8vIGNsaWVudCkuIFRvIG1pZ3JhdGUgdG8gdGhlIG5ldyBzY2hlbWEsIHdlIGhhdmUgdG8gcmVhZCBhbGwgbXV0YXRpb25zXHJcbiAgICAgICAgICAgICAgICAvLyBhbmQgd3JpdGUgdGhlbSBiYWNrIG91dC4gV2UgcHJlc2VydmUgdGhlIGV4aXN0aW5nIGJhdGNoIElEcyB0byBndWFyYW50ZWVcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNpc3RlbmN5IHdpdGggb3RoZXIgb2JqZWN0IHN0b3Jlcy4gQW55IGZ1cnRoZXIgbXV0YXRpb24gYmF0Y2ggSURzIHdpbGxcclxuICAgICAgICAgICAgICAgIC8vIGJlIGF1dG8tZ2VuZXJhdGVkLlxyXG4gICAgICAgICAgICAgICAgcCA9IHAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiB1cGdyYWRlTXV0YXRpb25CYXRjaFNjaGVtYUFuZE1pZ3JhdGVEYXRhKGRiLCB0eG4pOyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwID0gcC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGNyZWF0ZUNsaWVudE1ldGFkYXRhU3RvcmUoZGIpO1xyXG4gICAgICAgICAgICAgICAgY3JlYXRlUmVtb3RlRG9jdW1lbnRDaGFuZ2VzU3RvcmUoZGIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZyb21WZXJzaW9uIDwgNSAmJiB0b1ZlcnNpb24gPj0gNSkge1xyXG4gICAgICAgICAgICBwID0gcC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnJlbW92ZUFja25vd2xlZGdlZE11dGF0aW9ucyh0eG4pOyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZyb21WZXJzaW9uIDwgNiAmJiB0b1ZlcnNpb24gPj0gNikge1xyXG4gICAgICAgICAgICBwID0gcC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGNyZWF0ZURvY3VtZW50R2xvYmFsU3RvcmUoZGIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmFkZERvY3VtZW50R2xvYmFsKHR4bik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcDtcclxuICAgIH07XHJcbiAgICBTY2hlbWFDb252ZXJ0ZXIucHJvdG90eXBlLmFkZERvY3VtZW50R2xvYmFsID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBieXRlQ291bnQgPSAwO1xyXG4gICAgICAgIHJldHVybiB0eG5cclxuICAgICAgICAgICAgLnN0b3JlKERiUmVtb3RlRG9jdW1lbnQuc3RvcmUpXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKGZ1bmN0aW9uIChfLCBkb2MpIHtcclxuICAgICAgICAgICAgYnl0ZUNvdW50ICs9IGRiRG9jdW1lbnRTaXplKGRvYyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbWV0YWRhdGEgPSBuZXcgRGJSZW1vdGVEb2N1bWVudEdsb2JhbChieXRlQ291bnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHhuXHJcbiAgICAgICAgICAgICAgICAuc3RvcmUoRGJSZW1vdGVEb2N1bWVudEdsb2JhbC5zdG9yZSlcclxuICAgICAgICAgICAgICAgIC5wdXQoRGJSZW1vdGVEb2N1bWVudEdsb2JhbC5rZXksIG1ldGFkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTY2hlbWFDb252ZXJ0ZXIucHJvdG90eXBlLnJlbW92ZUFja25vd2xlZGdlZE11dGF0aW9ucyA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBxdWV1ZXNTdG9yZSA9IHR4bi5zdG9yZShEYk11dGF0aW9uUXVldWUuc3RvcmUpO1xyXG4gICAgICAgIHZhciBtdXRhdGlvbnNTdG9yZSA9IHR4bi5zdG9yZShEYk11dGF0aW9uQmF0Y2guc3RvcmUpO1xyXG4gICAgICAgIHJldHVybiBxdWV1ZXNTdG9yZS5sb2FkQWxsKCkubmV4dChmdW5jdGlvbiAocXVldWVzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaChxdWV1ZXMsIGZ1bmN0aW9uIChxdWV1ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UuYm91bmQoW3F1ZXVlLnVzZXJJZCwgQkFUQ0hJRF9VTktOT1dOXSwgW3F1ZXVlLnVzZXJJZCwgcXVldWUubGFzdEFja25vd2xlZGdlZEJhdGNoSWRdKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBtdXRhdGlvbnNTdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgIC5sb2FkQWxsKERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zSW5kZXgsIHJhbmdlKVxyXG4gICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChkYkJhdGNoZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2goZGJCYXRjaGVzLCBmdW5jdGlvbiAoZGJCYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoZGJCYXRjaC51c2VySWQgPT09IHF1ZXVlLnVzZXJJZCwgXCJDYW5ub3QgcHJvY2VzcyBiYXRjaCBcIiArIGRiQmF0Y2guYmF0Y2hJZCArIFwiIGZyb20gdW5leHBlY3RlZCB1c2VyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmF0Y2ggPSBfdGhpcy5zZXJpYWxpemVyLmZyb21EYk11dGF0aW9uQmF0Y2goZGJCYXRjaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZW1vdmVNdXRhdGlvbkJhdGNoKHR4biwgcXVldWUudXNlcklkLCBiYXRjaCkubmV4dChmdW5jdGlvbiAoKSB7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTY2hlbWFDb252ZXJ0ZXI7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBXcmFwcGVyIGNsYXNzIHRvIHN0b3JlIHRpbWVzdGFtcHMgKHNlY29uZHMgYW5kIG5hbm9zKSBpbiBJbmRleGVkRGIgb2JqZWN0cy5cclxuICovXHJcbnZhciBEYlRpbWVzdGFtcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiVGltZXN0YW1wKHNlY29uZHMsIG5hbm9zZWNvbmRzKSB7XHJcbiAgICAgICAgdGhpcy5zZWNvbmRzID0gc2Vjb25kcztcclxuICAgICAgICB0aGlzLm5hbm9zZWNvbmRzID0gbmFub3NlY29uZHM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRGJUaW1lc3RhbXA7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIHNpbmdsZXRvbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAnb3duZXInIHN0b3JlIGluIEluZGV4ZWREYi5cclxuICpcclxuICogQSBnaXZlbiBkYXRhYmFzZSBjYW4gaGF2ZSBhIHNpbmdsZSBwcmltYXJ5IHRhYiBhc3NpZ25lZCBhdCBhIGdpdmVuIHRpbWUuIFRoYXRcclxuICogdGFiIG11c3QgdmFsaWRhdGUgdGhhdCBpdCBpcyBzdGlsbCBob2xkaW5nIHRoZSBwcmltYXJ5IGxlYXNlIGJlZm9yZSBldmVyeVxyXG4gKiBvcGVyYXRpb24gdGhhdCByZXF1aXJlcyBsb2NrZWQgYWNjZXNzLiBUaGUgcHJpbWFyeSB0YWIgc2hvdWxkIHJlZ3VsYXJseVxyXG4gKiB3cml0ZSBhbiB1cGRhdGVkIHRpbWVzdGFtcCB0byB0aGlzIGxlYXNlIHRvIHByZXZlbnQgb3RoZXIgdGFicyBmcm9tXHJcbiAqIFwic3RlYWxpbmdcIiB0aGUgcHJpbWFyeSBsZWFzZVxyXG4gKi9cclxudmFyIERiUHJpbWFyeUNsaWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiUHJpbWFyeUNsaWVudChvd25lcklkLCBcclxuICAgIC8qKiBXaGV0aGVyIHRvIGFsbG93IHNoYXJlZCBhY2Nlc3MgZnJvbSBtdWx0aXBsZSB0YWJzLiAqL1xyXG4gICAgYWxsb3dUYWJTeW5jaHJvbml6YXRpb24sIGxlYXNlVGltZXN0YW1wTXMpIHtcclxuICAgICAgICB0aGlzLm93bmVySWQgPSBvd25lcklkO1xyXG4gICAgICAgIHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24gPSBhbGxvd1RhYlN5bmNocm9uaXphdGlvbjtcclxuICAgICAgICB0aGlzLmxlYXNlVGltZXN0YW1wTXMgPSBsZWFzZVRpbWVzdGFtcE1zO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCB0aGUgbmFtZSAnb3duZXInIGlzIGNob3NlbiB0byBlbnN1cmUgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aFxyXG4gICAgICogb2xkZXIgY2xpZW50cyB0aGF0IG9ubHkgc3VwcG9ydGVkIHNpbmdsZSBsb2NrZWQgYWNjZXNzIHRvIHRoZSBwZXJzaXN0ZW5jZVxyXG4gICAgICogbGF5ZXIuXHJcbiAgICAgKi9cclxuICAgIERiUHJpbWFyeUNsaWVudC5zdG9yZSA9ICdvd25lcic7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBrZXkgc3RyaW5nIHVzZWQgZm9yIHRoZSBzaW5nbGUgb2JqZWN0IHRoYXQgZXhpc3RzIGluIHRoZVxyXG4gICAgICogRGJQcmltYXJ5Q2xpZW50IHN0b3JlLlxyXG4gICAgICovXHJcbiAgICBEYlByaW1hcnlDbGllbnQua2V5ID0gJ293bmVyJztcclxuICAgIHJldHVybiBEYlByaW1hcnlDbGllbnQ7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGNyZWF0ZVByaW1hcnlDbGllbnRTdG9yZShkYikge1xyXG4gICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJQcmltYXJ5Q2xpZW50LnN0b3JlKTtcclxufVxyXG4vKipcclxuICogQW4gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ211dGF0aW9uUXVldWVzJyBzdG9yZSBpbiBJbmRleGVkRGIuXHJcbiAqXHJcbiAqIEVhY2ggdXNlciBnZXRzIGEgc2luZ2xlIHF1ZXVlIG9mIE11dGF0aW9uQmF0Y2hlcyB0byBhcHBseSB0byB0aGUgc2VydmVyLlxyXG4gKiBEYk11dGF0aW9uUXVldWUgdHJhY2tzIHRoZSBtZXRhZGF0YSBhYm91dCB0aGUgcXVldWUuXHJcbiAqL1xyXG52YXIgRGJNdXRhdGlvblF1ZXVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJNdXRhdGlvblF1ZXVlKFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbm9ybWFsaXplZCB1c2VyIElEIHRvIHdoaWNoIHRoaXMgcXVldWUgYmVsb25ncy5cclxuICAgICAqL1xyXG4gICAgdXNlcklkLCBcclxuICAgIC8qKlxyXG4gICAgICogQW4gaWRlbnRpZmllciBmb3IgdGhlIGhpZ2hlc3QgbnVtYmVyZWQgYmF0Y2ggdGhhdCBoYXMgYmVlbiBhY2tub3dsZWRnZWRcclxuICAgICAqIGJ5IHRoZSBzZXJ2ZXIuIEFsbCBNdXRhdGlvbkJhdGNoZXMgaW4gdGhpcyBxdWV1ZSB3aXRoIGJhdGNoSWRzIGxlc3NcclxuICAgICAqIHRoYW4gb3IgZXF1YWwgdG8gdGhpcyB2YWx1ZSBhcmUgY29uc2lkZXJlZCB0byBoYXZlIGJlZW4gYWNrbm93bGVkZ2VkIGJ5XHJcbiAgICAgKiB0aGUgc2VydmVyLlxyXG4gICAgICovXHJcbiAgICBsYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCwgXHJcbiAgICAvKipcclxuICAgICAqIEEgc3RyZWFtIHRva2VuIHRoYXQgd2FzIHByZXZpb3VzbHkgc2VudCBieSB0aGUgc2VydmVyLlxyXG4gICAgICpcclxuICAgICAqIFNlZSBTdHJlYW1pbmdXcml0ZVJlcXVlc3QgaW4gZGF0YXN0b3JlLnByb3RvIGZvciBtb3JlIGRldGFpbHMgYWJvdXRcclxuICAgICAqIHVzYWdlLlxyXG4gICAgICpcclxuICAgICAqIEFmdGVyIHNlbmRpbmcgdGhpcyB0b2tlbiwgZWFybGllciB0b2tlbnMgbWF5IG5vdCBiZSB1c2VkIGFueW1vcmUgc29cclxuICAgICAqIG9ubHkgYSBzaW5nbGUgc3RyZWFtIHRva2VuIGlzIHJldGFpbmVkLlxyXG4gICAgICovXHJcbiAgICBsYXN0U3RyZWFtVG9rZW4pIHtcclxuICAgICAgICB0aGlzLnVzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICB0aGlzLmxhc3RBY2tub3dsZWRnZWRCYXRjaElkID0gbGFzdEFja25vd2xlZGdlZEJhdGNoSWQ7XHJcbiAgICAgICAgdGhpcy5sYXN0U3RyZWFtVG9rZW4gPSBsYXN0U3RyZWFtVG9rZW47XHJcbiAgICB9XHJcbiAgICAvKiogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS4gICovXHJcbiAgICBEYk11dGF0aW9uUXVldWUuc3RvcmUgPSAnbXV0YXRpb25RdWV1ZXMnO1xyXG4gICAgLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB1c2VySWQgcHJvcGVydHkuICovXHJcbiAgICBEYk11dGF0aW9uUXVldWUua2V5UGF0aCA9ICd1c2VySWQnO1xyXG4gICAgcmV0dXJuIERiTXV0YXRpb25RdWV1ZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIEFuIG9iamVjdCB0byBiZSBzdG9yZWQgaW4gdGhlICdtdXRhdGlvbnMnIHN0b3JlIGluIEluZGV4ZWREYi5cclxuICpcclxuICogUmVwcmVzZW50cyBhIGJhdGNoIG9mIHVzZXItbGV2ZWwgbXV0YXRpb25zIGludGVuZGVkIHRvIGJlIHNlbnQgdG8gdGhlIHNlcnZlclxyXG4gKiBpbiBhIHNpbmdsZSB3cml0ZS4gRWFjaCB1c2VyLWxldmVsIGJhdGNoIGdldHMgYSBzZXBhcmF0ZSBEYk11dGF0aW9uQmF0Y2hcclxuICogd2l0aCBhIG5ldyBiYXRjaElkLlxyXG4gKi9cclxudmFyIERiTXV0YXRpb25CYXRjaCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiTXV0YXRpb25CYXRjaChcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG5vcm1hbGl6ZWQgdXNlciBJRCB0byB3aGljaCB0aGlzIGJhdGNoIGJlbG9uZ3MuXHJcbiAgICAgKi9cclxuICAgIHVzZXJJZCwgXHJcbiAgICAvKipcclxuICAgICAqIEFuIGlkZW50aWZpZXIgZm9yIHRoaXMgYmF0Y2gsIGFsbG9jYXRlZCB1c2luZyBhbiBhdXRvLWdlbmVyYXRlZCBrZXkuXHJcbiAgICAgKi9cclxuICAgIGJhdGNoSWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbG9jYWwgd3JpdGUgdGltZSBvZiB0aGUgYmF0Y2gsIHN0b3JlZCBhcyBtaWxsaXNlY29uZHMgc2luY2UgdGhlXHJcbiAgICAgKiBlcG9jaC5cclxuICAgICAqL1xyXG4gICAgbG9jYWxXcml0ZVRpbWVNcywgXHJcbiAgICAvKipcclxuICAgICAqIEEgbGlzdCBvZiBtdXRhdGlvbnMgdG8gYXBwbHkuIEFsbCBtdXRhdGlvbnMgd2lsbCBiZSBhcHBsaWVkIGF0b21pY2FsbHkuXHJcbiAgICAgKlxyXG4gICAgICogTXV0YXRpb25zIGFyZSBzZXJpYWxpemVkIHZpYSBKc29uUHJvdG9TZXJpYWxpemVyLnRvTXV0YXRpb24oKS5cclxuICAgICAqL1xyXG4gICAgbXV0YXRpb25zKSB7XHJcbiAgICAgICAgdGhpcy51c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgdGhpcy5iYXRjaElkID0gYmF0Y2hJZDtcclxuICAgICAgICB0aGlzLmxvY2FsV3JpdGVUaW1lTXMgPSBsb2NhbFdyaXRlVGltZU1zO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25zID0gbXV0YXRpb25zO1xyXG4gICAgfVxyXG4gICAgLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICAqL1xyXG4gICAgRGJNdXRhdGlvbkJhdGNoLnN0b3JlID0gJ211dGF0aW9ucyc7XHJcbiAgICAvKiogS2V5cyBhcmUgYXV0b21hdGljYWxseSBhc3NpZ25lZCB2aWEgdGhlIHVzZXJJZCwgYmF0Y2hJZCBwcm9wZXJ0aWVzLiAqL1xyXG4gICAgRGJNdXRhdGlvbkJhdGNoLmtleVBhdGggPSAnYmF0Y2hJZCc7XHJcbiAgICAvKiogVGhlIGluZGV4IG5hbWUgZm9yIGxvb2t1cCBvZiBtdXRhdGlvbnMgYnkgdXNlci4gKi9cclxuICAgIERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zSW5kZXggPSAndXNlck11dGF0aW9uc0luZGV4JztcclxuICAgIC8qKiBUaGUgdXNlciBtdXRhdGlvbnMgaW5kZXggaXMga2V5ZWQgYnkgW3VzZXJJZCwgYmF0Y2hJZF0gcGFpcnMuICovXHJcbiAgICBEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0tleVBhdGggPSBbJ3VzZXJJZCcsICdiYXRjaElkJ107XHJcbiAgICByZXR1cm4gRGJNdXRhdGlvbkJhdGNoO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBjcmVhdGVNdXRhdGlvblF1ZXVlKGRiKSB7XHJcbiAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShEYk11dGF0aW9uUXVldWUuc3RvcmUsIHtcclxuICAgICAgICBrZXlQYXRoOiBEYk11dGF0aW9uUXVldWUua2V5UGF0aFxyXG4gICAgfSk7XHJcbiAgICB2YXIgbXV0YXRpb25CYXRjaGVzU3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZShEYk11dGF0aW9uQmF0Y2guc3RvcmUsIHtcclxuICAgICAgICBrZXlQYXRoOiBEYk11dGF0aW9uQmF0Y2gua2V5UGF0aCxcclxuICAgICAgICBhdXRvSW5jcmVtZW50OiB0cnVlXHJcbiAgICB9KTtcclxuICAgIG11dGF0aW9uQmF0Y2hlc1N0b3JlLmNyZWF0ZUluZGV4KERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zSW5kZXgsIERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zS2V5UGF0aCwgeyB1bmlxdWU6IHRydWUgfSk7XHJcbiAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShEYkRvY3VtZW50TXV0YXRpb24uc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBVcGdyYWRlIGZ1bmN0aW9uIHRvIG1pZ3JhdGUgdGhlICdtdXRhdGlvbnMnIHN0b3JlIGZyb20gVjEgdG8gVjMuIExvYWRzXHJcbiAqIGFuZCByZXdyaXRlcyBhbGwgZGF0YS5cclxuICovXHJcbmZ1bmN0aW9uIHVwZ3JhZGVNdXRhdGlvbkJhdGNoU2NoZW1hQW5kTWlncmF0ZURhdGEoZGIsIHR4bikge1xyXG4gICAgdmFyIHYxTXV0YXRpb25zU3RvcmUgPSB0eG4uc3RvcmUoRGJNdXRhdGlvbkJhdGNoLnN0b3JlKTtcclxuICAgIHJldHVybiB2MU11dGF0aW9uc1N0b3JlLmxvYWRBbGwoKS5uZXh0KGZ1bmN0aW9uIChleGlzdGluZ011dGF0aW9ucykge1xyXG4gICAgICAgIGRiLmRlbGV0ZU9iamVjdFN0b3JlKERiTXV0YXRpb25CYXRjaC5zdG9yZSk7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uc1N0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJNdXRhdGlvbkJhdGNoLnN0b3JlLCB7XHJcbiAgICAgICAgICAgIGtleVBhdGg6IERiTXV0YXRpb25CYXRjaC5rZXlQYXRoLFxyXG4gICAgICAgICAgICBhdXRvSW5jcmVtZW50OiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbXV0YXRpb25zU3RvcmUuY3JlYXRlSW5kZXgoRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNJbmRleCwgRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNLZXlQYXRoLCB7IHVuaXF1ZTogdHJ1ZSB9KTtcclxuICAgICAgICB2YXIgdjNNdXRhdGlvbnNTdG9yZSA9IHR4bi5zdG9yZShEYk11dGF0aW9uQmF0Y2guc3RvcmUpO1xyXG4gICAgICAgIHZhciB3cml0ZUFsbCA9IGV4aXN0aW5nTXV0YXRpb25zLm1hcChmdW5jdGlvbiAobXV0YXRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHYzTXV0YXRpb25zU3RvcmUucHV0KG11dGF0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3Iod3JpdGVBbGwpO1xyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIEFuIG9iamVjdCB0byBiZSBzdG9yZWQgaW4gdGhlICdkb2N1bWVudE11dGF0aW9ucycgc3RvcmUgaW4gSW5kZXhlZERiLlxyXG4gKlxyXG4gKiBBIG1hbnVhbGx5IG1haW50YWluZWQgaW5kZXggb2YgYWxsIHRoZSBtdXRhdGlvbiBiYXRjaGVzIHRoYXQgYWZmZWN0IGEgZ2l2ZW5cclxuICogZG9jdW1lbnQga2V5LiBUaGUgcm93cyBpbiB0aGlzIHRhYmxlIGFyZSByZWZlcmVuY2VzIGJhc2VkIG9uIHRoZSBjb250ZW50cyBvZlxyXG4gKiBEYk11dGF0aW9uQmF0Y2gubXV0YXRpb25zLlxyXG4gKi9cclxudmFyIERiRG9jdW1lbnRNdXRhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiRG9jdW1lbnRNdXRhdGlvbigpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIFt1c2VySWRdIGtleSBmb3IgdXNlIGluIHRoZSBEYkRvY3VtZW50TXV0YXRpb25zIGluZGV4IHRvIGl0ZXJhdGVcclxuICAgICAqIG92ZXIgYWxsIG9mIGEgdXNlcidzIGRvY3VtZW50IG11dGF0aW9ucy5cclxuICAgICAqL1xyXG4gICAgRGJEb2N1bWVudE11dGF0aW9uLnByZWZpeEZvclVzZXIgPSBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgcmV0dXJuIFt1c2VySWRdO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIFt1c2VySWQsIGVuY29kZWRQYXRoXSBrZXkgZm9yIHVzZSBpbiB0aGUgRGJEb2N1bWVudE11dGF0aW9uc1xyXG4gICAgICogaW5kZXggdG8gaXRlcmF0ZSBvdmVyIGFsbCBhdCBkb2N1bWVudCBtdXRhdGlvbnMgZm9yIGEgZ2l2ZW4gcGF0aCBvciBsb3dlci5cclxuICAgICAqL1xyXG4gICAgRGJEb2N1bWVudE11dGF0aW9uLnByZWZpeEZvclBhdGggPSBmdW5jdGlvbiAodXNlcklkLCBwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIFt1c2VySWQsIGVuY29kZShwYXRoKV07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgZnVsbCBpbmRleCBrZXkgb2YgW3VzZXJJZCwgZW5jb2RlZFBhdGgsIGJhdGNoSWRdIGZvciBpbnNlcnRpbmdcclxuICAgICAqIGFuZCBkZWxldGluZyBpbnRvIHRoZSBEYkRvY3VtZW50TXV0YXRpb25zIGluZGV4LlxyXG4gICAgICovXHJcbiAgICBEYkRvY3VtZW50TXV0YXRpb24ua2V5ID0gZnVuY3Rpb24gKHVzZXJJZCwgcGF0aCwgYmF0Y2hJZCkge1xyXG4gICAgICAgIHJldHVybiBbdXNlcklkLCBlbmNvZGUocGF0aCksIGJhdGNoSWRdO1xyXG4gICAgfTtcclxuICAgIERiRG9jdW1lbnRNdXRhdGlvbi5zdG9yZSA9ICdkb2N1bWVudE11dGF0aW9ucyc7XHJcbiAgICAvKipcclxuICAgICAqIEJlY2F1c2Ugd2Ugc3RvcmUgYWxsIHRoZSB1c2VmdWwgaW5mb3JtYXRpb24gZm9yIHRoaXMgc3RvcmUgaW4gdGhlIGtleSxcclxuICAgICAqIHRoZXJlIGlzIG5vIHVzZWZ1bCBpbmZvcm1hdGlvbiB0byBzdG9yZSBhcyB0aGUgdmFsdWUuIFRoZSByYXcgKHVuZW5jb2RlZClcclxuICAgICAqIHBhdGggY2Fubm90IGJlIHN0b3JlZCBiZWNhdXNlIEluZGV4ZWREYiBkb2Vzbid0IHN0b3JlIHByb3RvdHlwZVxyXG4gICAgICogaW5mb3JtYXRpb24uXHJcbiAgICAgKi9cclxuICAgIERiRG9jdW1lbnRNdXRhdGlvbi5QTEFDRUhPTERFUiA9IG5ldyBEYkRvY3VtZW50TXV0YXRpb24oKTtcclxuICAgIHJldHVybiBEYkRvY3VtZW50TXV0YXRpb247XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGNyZWF0ZVJlbW90ZURvY3VtZW50Q2FjaGUoZGIpIHtcclxuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiUmVtb3RlRG9jdW1lbnQuc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIHRoZSBrbm93biBhYnNlbmNlIG9mIGEgZG9jdW1lbnQgYXQgYSBwYXJ0aWN1bGFyIHZlcnNpb24uXHJcbiAqIFN0b3JlZCBpbiBJbmRleGVkRGIgYXMgcGFydCBvZiBhIERiUmVtb3RlRG9jdW1lbnQgb2JqZWN0LlxyXG4gKi9cclxudmFyIERiTm9Eb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiTm9Eb2N1bWVudChwYXRoLCByZWFkVGltZSkge1xyXG4gICAgICAgIHRoaXMucGF0aCA9IHBhdGg7XHJcbiAgICAgICAgdGhpcy5yZWFkVGltZSA9IHJlYWRUaW1lO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIERiTm9Eb2N1bWVudDtcclxufSgpKTtcclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBkb2N1bWVudCB0aGF0IGlzIGtub3duIHRvIGV4aXN0IGJ1dCB3aG9zZSBkYXRhIGlzIHVua25vd24uXHJcbiAqIFN0b3JlZCBpbiBJbmRleGVkRGIgYXMgcGFydCBvZiBhIERiUmVtb3RlRG9jdW1lbnQgb2JqZWN0LlxyXG4gKi9cclxudmFyIERiVW5rbm93bkRvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJVbmtub3duRG9jdW1lbnQocGF0aCwgdmVyc2lvbikge1xyXG4gICAgICAgIHRoaXMucGF0aCA9IHBhdGg7XHJcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcclxuICAgIH1cclxuICAgIHJldHVybiBEYlVua25vd25Eb2N1bWVudDtcclxufSgpKTtcclxuLyoqXHJcbiAqIEFuIG9iamVjdCB0byBiZSBzdG9yZWQgaW4gdGhlICdyZW1vdGVEb2N1bWVudHMnIHN0b3JlIGluIEluZGV4ZWREYi5cclxuICogSXQgcmVwcmVzZW50cyBlaXRoZXI6XHJcbiAqXHJcbiAqIC0gQSBjb21wbGV0ZSBkb2N1bWVudC5cclxuICogLSBBIFwibm8gZG9jdW1lbnRcIiByZXByZXNlbnRpbmcgYSBkb2N1bWVudCB0aGF0IGlzIGtub3duIG5vdCB0byBleGlzdCAoYXRcclxuICogc29tZSB2ZXJzaW9uKS5cclxuICogLSBBbiBcInVua25vd24gZG9jdW1lbnRcIiByZXByZXNlbnRpbmcgYSBkb2N1bWVudCB0aGF0IGlzIGtub3duIHRvIGV4aXN0IChhdFxyXG4gKiBzb21lIHZlcnNpb24pIGJ1dCB3aG9zZSBjb250ZW50cyBhcmUgdW5rbm93bi5cclxuICpcclxuICogTm90ZTogVGhpcyBpcyB0aGUgcGVyc2lzdGVkIGVxdWl2YWxlbnQgb2YgYSBNYXliZURvY3VtZW50IGFuZCBjb3VsZCBwZXJoYXBzXHJcbiAqIGJlIG1hZGUgbW9yZSBnZW5lcmFsIGlmIG5lY2Vzc2FyeS5cclxuICovXHJcbnZhciBEYlJlbW90ZURvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJSZW1vdGVEb2N1bWVudChcclxuICAgIC8qKlxyXG4gICAgICogU2V0IHRvIGFuIGluc3RhbmNlIG9mIERiVW5rbm93bkRvY3VtZW50IGlmIHRoZSBkYXRhIGZvciBhIGRvY3VtZW50IGlzXHJcbiAgICAgKiBub3Qga25vd24sIGJ1dCBpdCBpcyBrbm93biB0aGF0IGEgZG9jdW1lbnQgZXhpc3RzIGF0IHRoZSBzcGVjaWZpZWRcclxuICAgICAqIHZlcnNpb24gKGUuZy4gaXQgaGFkIGEgc3VjY2Vzc2Z1bCB1cGRhdGUgYXBwbGllZCB0byBpdClcclxuICAgICAqL1xyXG4gICAgdW5rbm93bkRvY3VtZW50LCBcclxuICAgIC8qKlxyXG4gICAgICogU2V0IHRvIGFuIGluc3RhbmNlIG9mIGEgRGJOb0RvY3VtZW50IGlmIGl0IGlzIGtub3duIHRoYXQgbm8gZG9jdW1lbnRcclxuICAgICAqIGV4aXN0cy5cclxuICAgICAqL1xyXG4gICAgbm9Eb2N1bWVudCwgXHJcbiAgICAvKipcclxuICAgICAqIFNldCB0byBhbiBpbnN0YW5jZSBvZiBhIERvY3VtZW50IGlmIHRoZXJlJ3MgYSBjYWNoZWQgdmVyc2lvbiBvZiB0aGVcclxuICAgICAqIGRvY3VtZW50LlxyXG4gICAgICovXHJcbiAgICBkb2N1bWVudCwgXHJcbiAgICAvKipcclxuICAgICAqIERvY3VtZW50cyB0aGF0IHdlcmUgd3JpdHRlbiB0byB0aGUgcmVtb3RlIGRvY3VtZW50IHN0b3JlIGJhc2VkIG9uXHJcbiAgICAgKiBhIHdyaXRlIGFja25vd2xlZGdtZW50IGFyZSBtYXJrZWQgd2l0aCBgaGFzQ29tbWl0dGVkTXV0YXRpb25zYC4gVGhlc2VcclxuICAgICAqIGRvY3VtZW50cyBhcmUgcG90ZW50aWFsbHkgaW5jb25zaXN0ZW50IHdpdGggdGhlIGJhY2tlbmQncyBjb3B5IGFuZCB1c2VcclxuICAgICAqIHRoZSB3cml0ZSdzIGNvbW1pdCB2ZXJzaW9uIGFzIHRoZWlyIGRvY3VtZW50IHZlcnNpb24uXHJcbiAgICAgKi9cclxuICAgIGhhc0NvbW1pdHRlZE11dGF0aW9ucykge1xyXG4gICAgICAgIHRoaXMudW5rbm93bkRvY3VtZW50ID0gdW5rbm93bkRvY3VtZW50O1xyXG4gICAgICAgIHRoaXMubm9Eb2N1bWVudCA9IG5vRG9jdW1lbnQ7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudCA9IGRvY3VtZW50O1xyXG4gICAgICAgIHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zID0gaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xyXG4gICAgfVxyXG4gICAgRGJSZW1vdGVEb2N1bWVudC5zdG9yZSA9ICdyZW1vdGVEb2N1bWVudHMnO1xyXG4gICAgcmV0dXJuIERiUmVtb3RlRG9jdW1lbnQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBDb250YWlucyBhIHNpbmdsZSBlbnRyeSB0aGF0IGhhcyBtZXRhZGF0YSBhYm91dCB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlLlxyXG4gKi9cclxudmFyIERiUmVtb3RlRG9jdW1lbnRHbG9iYWwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBieXRlU2l6ZSBBcHByb3hpbWF0ZWx5IHRoZSB0b3RhbCBzaXplIGluIGJ5dGVzIG9mIGFsbCB0aGUgZG9jdW1lbnRzIGluIHRoZSBkb2N1bWVudFxyXG4gICAgICogY2FjaGUuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIERiUmVtb3RlRG9jdW1lbnRHbG9iYWwoYnl0ZVNpemUpIHtcclxuICAgICAgICB0aGlzLmJ5dGVTaXplID0gYnl0ZVNpemU7XHJcbiAgICB9XHJcbiAgICBEYlJlbW90ZURvY3VtZW50R2xvYmFsLnN0b3JlID0gJ3JlbW90ZURvY3VtZW50R2xvYmFsJztcclxuICAgIERiUmVtb3RlRG9jdW1lbnRHbG9iYWwua2V5ID0gJ3JlbW90ZURvY3VtZW50R2xvYmFsS2V5JztcclxuICAgIHJldHVybiBEYlJlbW90ZURvY3VtZW50R2xvYmFsO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBjcmVhdGVEb2N1bWVudEdsb2JhbFN0b3JlKGRiKSB7XHJcbiAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShEYlJlbW90ZURvY3VtZW50R2xvYmFsLnN0b3JlKTtcclxufVxyXG4vKipcclxuICogQW4gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ3RhcmdldHMnIHN0b3JlIGluIEluZGV4ZWREYi5cclxuICpcclxuICogVGhpcyBpcyBiYXNlZCBvbiBhbmQgc2hvdWxkIGJlIGtlcHQgaW4gc3luYyB3aXRoIHRoZSBwcm90byB1c2VkIGluIHRoZSBpT1NcclxuICogY2xpZW50LlxyXG4gKlxyXG4gKiBFYWNoIHF1ZXJ5IHRoZSBjbGllbnQgbGlzdGVucyB0byBhZ2FpbnN0IHRoZSBzZXJ2ZXIgaXMgdHJhY2tlZCBvbiBkaXNrIHNvXHJcbiAqIHRoYXQgdGhlIHF1ZXJ5IGNhbiBiZSBlZmZpY2llbnRseSByZXN1bWVkIG9uIHJlc3RhcnQuXHJcbiAqL1xyXG52YXIgRGJUYXJnZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYlRhcmdldChcclxuICAgIC8qKlxyXG4gICAgICogQW4gYXV0by1nZW5lcmF0ZWQgc2VxdWVudGlhbCBudW1lcmljIGlkZW50aWZpZXIgZm9yIHRoZSBxdWVyeS5cclxuICAgICAqXHJcbiAgICAgKiBRdWVyaWVzIGFyZSBzdG9yZWQgdXNpbmcgdGhlaXIgY2Fub25pY2FsSWQgYXMgdGhlIGtleSwgYnV0IHRoZXNlXHJcbiAgICAgKiBjYW5vbmljYWxJZHMgY2FuIGJlIHF1aXRlIGxvbmcgc28gd2UgYWRkaXRpb25hbGx5IGFzc2lnbiBhIHVuaXF1ZVxyXG4gICAgICogcXVlcnlJZCB3aGljaCBjYW4gYmUgdXNlZCBieSByZWZlcmVuY2VkIGRhdGEgc3RydWN0dXJlcyAoZS5nLlxyXG4gICAgICogaW5kZXhlcykgdG8gbWluaW1pemUgdGhlIG9uLWRpc2sgY29zdC5cclxuICAgICAqL1xyXG4gICAgdGFyZ2V0SWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgY2Fub25pY2FsIHN0cmluZyByZXByZXNlbnRpbmcgdGhpcyBxdWVyeS4gVGhpcyBpcyBub3QgdW5pcXVlLlxyXG4gICAgICovXHJcbiAgICBjYW5vbmljYWxJZCwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBsYXN0IHJlYWRUaW1lIHJlY2VpdmVkIGZyb20gdGhlIFdhdGNoIFNlcnZpY2UgZm9yIHRoaXMgcXVlcnkuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBpcyB0aGUgc2FtZSB2YWx1ZSBhcyBUYXJnZXRDaGFuZ2UucmVhZF90aW1lIGluIHRoZSBwcm90b3MuXHJcbiAgICAgKi9cclxuICAgIHJlYWRUaW1lLCBcclxuICAgIC8qKlxyXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSBxdWVyeSB0byBiZVxyXG4gICAgICogcmVzdW1lZCBhZnRlciBkaXNjb25uZWN0aW5nIHdpdGhvdXQgcmV0cmFuc21pdHRpbmcgYWxsIHRoZSBkYXRhXHJcbiAgICAgKiB0aGF0IG1hdGNoZXMgdGhlIHF1ZXJ5LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYVxyXG4gICAgICogcG9pbnQgaW4gdGltZSBmcm9tIHdoaWNoIHRoZSBzZXJ2ZXIgc2hvdWxkIHJlc3VtZSBzZW5kaW5nIHJlc3VsdHMuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBpcyByZWxhdGVkIHRvIHRoZSBzbmFwc2hvdFZlcnNpb24gaW4gdGhhdCB0aGUgcmVzdW1lVG9rZW5cclxuICAgICAqIGVmZmVjdGl2ZWx5IGFsc28gZW5jb2RlcyB0aGF0IHZhbHVlLCBidXQgdGhlIHJlc3VtZVRva2VuIGlzIG9wYXF1ZVxyXG4gICAgICogYW5kIHNvbWV0aW1lcyBlbmNvZGVzIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQSBjb25zZXF1ZW5jZSBvZiB0aGlzIGlzIHRoYXQgdGhlIHJlc3VtZVRva2VuIHNob3VsZCBiZSB1c2VkIHdoZW5cclxuICAgICAqIGFza2luZyB0aGUgc2VydmVyIHRvIHJlYXNvbiBhYm91dCB3aGVyZSB0aGlzIGNsaWVudCBpcyBpbiB0aGUgd2F0Y2hcclxuICAgICAqIHN0cmVhbSwgYnV0IHRoZSBjbGllbnQgc2hvdWxkIHVzZSB0aGUgc25hcHNob3RWZXJzaW9uIGZvciBpdHMgb3duXHJcbiAgICAgKiBwdXJwb3Nlcy5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIGlzIHRoZSBzYW1lIHZhbHVlIGFzIFRhcmdldENoYW5nZS5yZXN1bWVfdG9rZW4gaW4gdGhlIHByb3Rvcy5cclxuICAgICAqL1xyXG4gICAgcmVzdW1lVG9rZW4sIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBIHNlcXVlbmNlIG51bWJlciByZXByZXNlbnRpbmcgdGhlIGxhc3QgdGltZSB0aGlzIHF1ZXJ5IHdhc1xyXG4gICAgICogbGlzdGVuZWQgdG8sIHVzZWQgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbiBwdXJwb3Nlcy5cclxuICAgICAqXHJcbiAgICAgKiBDb252ZW50aW9uYWxseSB0aGlzIHdvdWxkIGJlIGEgdGltZXN0YW1wIHZhbHVlLCBidXQgZGV2aWNlLWxvY2FsXHJcbiAgICAgKiBjbG9ja3MgYXJlIHVucmVsaWFibGUgYW5kIHRoZXkgbXVzdCBiZSBhYmxlIHRvIGNyZWF0ZSBuZXcgbGlzdGVuc1xyXG4gICAgICogZXZlbiB3aGlsZSBkaXNjb25uZWN0ZWQuIEluc3RlYWQgdGhpcyBzaG91bGQgYmUgYSBtb25vdG9uaWNhbGx5XHJcbiAgICAgKiBpbmNyZWFzaW5nIG51bWJlciB0aGF0J3MgaW5jcmVtZW50ZWQgb24gZWFjaCBsaXN0ZW4gY2FsbC5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBxdWVyeUlkIHNpbmNlIHRoZSBxdWVyeUlkIGlzIGFuXHJcbiAgICAgKiBpbW11dGFibGUgaWRlbnRpZmllciBhc3NpZ25lZCB0byB0aGUgUXVlcnkgb24gZmlyc3QgdXNlIHdoaWxlXHJcbiAgICAgKiBsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgaXMgdXBkYXRlZCBldmVyeSB0aW1lIHRoZSBxdWVyeSBpc1xyXG4gICAgICogbGlzdGVuZWQgdG8uXHJcbiAgICAgKi9cclxuICAgIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBxdWVyeSBmb3IgdGhpcyB0YXJnZXQuXHJcbiAgICAgKlxyXG4gICAgICogQmVjYXVzZSBjYW5vbmljYWwgaWRzIGFyZSBub3QgdW5pcXVlIHdlIG11c3Qgc3RvcmUgdGhlIGFjdHVhbCBxdWVyeS4gV2VcclxuICAgICAqIHVzZSB0aGUgcHJvdG8gdG8gaGF2ZSBhbiBvYmplY3Qgd2UgY2FuIHBlcnNpc3Qgd2l0aG91dCBoYXZpbmcgdG9cclxuICAgICAqIGR1cGxpY2F0ZSB0cmFuc2xhdGlvbiBsb2dpYyB0byBhbmQgZnJvbSBhIGBRdWVyeWAgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICBxdWVyeSkge1xyXG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0YXJnZXRJZDtcclxuICAgICAgICB0aGlzLmNhbm9uaWNhbElkID0gY2Fub25pY2FsSWQ7XHJcbiAgICAgICAgdGhpcy5yZWFkVGltZSA9IHJlYWRUaW1lO1xyXG4gICAgICAgIHRoaXMucmVzdW1lVG9rZW4gPSByZXN1bWVUb2tlbjtcclxuICAgICAgICB0aGlzLmxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XHJcbiAgICB9XHJcbiAgICBEYlRhcmdldC5zdG9yZSA9ICd0YXJnZXRzJztcclxuICAgIC8qKiBLZXlzIGFyZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHZpYSB0aGUgdGFyZ2V0SWQgcHJvcGVydHkuICovXHJcbiAgICBEYlRhcmdldC5rZXlQYXRoID0gJ3RhcmdldElkJztcclxuICAgIC8qKiBUaGUgbmFtZSBvZiB0aGUgcXVlcnlUYXJnZXRzIGluZGV4LiAqL1xyXG4gICAgRGJUYXJnZXQucXVlcnlUYXJnZXRzSW5kZXhOYW1lID0gJ3F1ZXJ5VGFyZ2V0c0luZGV4JztcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGluZGV4IG9mIGFsbCBjYW5vbmljYWxJZHMgdG8gdGhlIHRhcmdldHMgdGhhdCB0aGV5IG1hdGNoLiBUaGlzIGlzIG5vdFxyXG4gICAgICogYSB1bmlxdWUgbWFwcGluZyBiZWNhdXNlIGNhbm9uaWNhbElkIGRvZXMgbm90IHByb21pc2UgYSB1bmlxdWUgbmFtZSBmb3IgYWxsXHJcbiAgICAgKiBwb3NzaWJsZSBxdWVyaWVzLCBzbyB3ZSBhcHBlbmQgdGhlIHRhcmdldElkIHRvIG1ha2UgdGhlIG1hcHBpbmcgdW5pcXVlLlxyXG4gICAgICovXHJcbiAgICBEYlRhcmdldC5xdWVyeVRhcmdldHNLZXlQYXRoID0gWydjYW5vbmljYWxJZCcsICd0YXJnZXRJZCddO1xyXG4gICAgcmV0dXJuIERiVGFyZ2V0O1xyXG59KCkpO1xyXG4vKipcclxuICogQW4gb2JqZWN0IHJlcHJlc2VudGluZyBhbiBhc3NvY2lhdGlvbiBiZXR3ZWVuIGEgdGFyZ2V0IGFuZCBhIGRvY3VtZW50LCBvciBhXHJcbiAqIHNlbnRpbmVsIHJvdyBtYXJraW5nIHRoZSBsYXN0IHNlcXVlbmNlIG51bWJlciBhdCB3aGljaCBhIGRvY3VtZW50IHdhcyB1c2VkLlxyXG4gKiBFYWNoIGRvY3VtZW50IGNhY2hlZCBtdXN0IGhhdmUgYSBjb3JyZXNwb25kaW5nIHNlbnRpbmVsIHJvdyBiZWZvcmUgbHJ1XHJcbiAqIGdhcmJhZ2UgY29sbGVjdGlvbiBpcyBlbmFibGVkLlxyXG4gKlxyXG4gKiBUaGUgdGFyZ2V0IGFzc29jaWF0aW9ucyBhbmQgc2VudGluZWwgcm93cyBhcmUgY28tbG9jYXRlZCBzbyB0aGF0IG9ycGhhbmVkXHJcbiAqIGRvY3VtZW50cyBhbmQgdGhlaXIgc2VxdWVuY2UgbnVtYmVycyBjYW4gYmUgaWRlbnRpZmllZCBlZmZpY2llbnRseSB2aWEgYSBzY2FuXHJcbiAqIG9mIHRoaXMgc3RvcmUuXHJcbiAqL1xyXG52YXIgRGJUYXJnZXREb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiVGFyZ2V0RG9jdW1lbnQoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSB0YXJnZXRJZCBpZGVudGlmeWluZyBhIHRhcmdldCBvciAwIGZvciBhIHNlbnRpbmVsIHJvdy5cclxuICAgICAqL1xyXG4gICAgdGFyZ2V0SWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcGF0aCB0byB0aGUgZG9jdW1lbnQsIGFzIGVuY29kZWQgaW4gdGhlIGtleS5cclxuICAgICAqL1xyXG4gICAgcGF0aCwgXHJcbiAgICAvKipcclxuICAgICAqIElmIHRoaXMgaXMgYSBzZW50aW5lbCByb3csIHRoaXMgc2hvdWxkIGJlIHRoZSBzZXF1ZW5jZSBudW1iZXIgb2YgdGhlIGxhc3RcclxuICAgICAqIHRpbWUgdGhlIGRvY3VtZW50IHNwZWNpZmllZCBieSBgcGF0aGAgd2FzIHVzZWQuIE90aGVyd2lzZSwgaXQgc2hvdWxkIGJlXHJcbiAgICAgKiBgdW5kZWZpbmVkYC5cclxuICAgICAqL1xyXG4gICAgc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICB0aGlzLnRhcmdldElkID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgdGhpcy5wYXRoID0gcGF0aDtcclxuICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVyID0gc2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgYXNzZXJ0KCh0YXJnZXRJZCA9PT0gMCkgPT09IChzZXF1ZW5jZU51bWJlciAhPT0gdW5kZWZpbmVkKSwgXHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxyXG4gICAgICAgICdBIHRhcmdldC1kb2N1bWVudCByb3cgbXVzdCBlaXRoZXIgaGF2ZSB0YXJnZXRJZCA9PSAwIGFuZCBhIGRlZmluZWQgc2VxdWVuY2UgbnVtYmVyLCBvciBhIG5vbi16ZXJvIHRhcmdldElkIGFuZCBubyBzZXF1ZW5jZSBudW1iZXInKTtcclxuICAgIH1cclxuICAgIC8qKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLiAgKi9cclxuICAgIERiVGFyZ2V0RG9jdW1lbnQuc3RvcmUgPSAndGFyZ2V0RG9jdW1lbnRzJztcclxuICAgIC8qKiBLZXlzIGFyZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHZpYSB0aGUgdGFyZ2V0SWQsIHBhdGggcHJvcGVydGllcy4gKi9cclxuICAgIERiVGFyZ2V0RG9jdW1lbnQua2V5UGF0aCA9IFsndGFyZ2V0SWQnLCAncGF0aCddO1xyXG4gICAgLyoqIFRoZSBpbmRleCBuYW1lIGZvciB0aGUgcmV2ZXJzZSBpbmRleC4gKi9cclxuICAgIERiVGFyZ2V0RG9jdW1lbnQuZG9jdW1lbnRUYXJnZXRzSW5kZXggPSAnZG9jdW1lbnRUYXJnZXRzSW5kZXgnO1xyXG4gICAgLyoqIFdlIGFsc28gbmVlZCB0byBjcmVhdGUgdGhlIHJldmVyc2UgaW5kZXggZm9yIHRoZXNlIHByb3BlcnRpZXMuICovXHJcbiAgICBEYlRhcmdldERvY3VtZW50LmRvY3VtZW50VGFyZ2V0c0tleVBhdGggPSBbJ3BhdGgnLCAndGFyZ2V0SWQnXTtcclxuICAgIHJldHVybiBEYlRhcmdldERvY3VtZW50O1xyXG59KCkpO1xyXG4vKipcclxuICogQSByZWNvcmQgb2YgZ2xvYmFsIHN0YXRlIHRyYWNrZWQgYWNyb3NzIGFsbCBUYXJnZXRzLCB0cmFja2VkIHNlcGFyYXRlbHlcclxuICogdG8gYXZvaWQgdGhlIG5lZWQgZm9yIGV4dHJhIGluZGV4ZXMuXHJcbiAqXHJcbiAqIFRoaXMgc2hvdWxkIGJlIGtlcHQgaW4tc3luYyB3aXRoIHRoZSBwcm90byB1c2VkIGluIHRoZSBpT1MgY2xpZW50LlxyXG4gKi9cclxudmFyIERiVGFyZ2V0R2xvYmFsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJUYXJnZXRHbG9iYWwoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBoaWdoZXN0IG51bWJlcmVkIHRhcmdldCBpZCBhY3Jvc3MgYWxsIHRhcmdldHMuXHJcbiAgICAgKlxyXG4gICAgICogU2VlIERiVGFyZ2V0LnRhcmdldElkLlxyXG4gICAgICovXHJcbiAgICBoaWdoZXN0VGFyZ2V0SWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgaGlnaGVzdCBudW1iZXJlZCBsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgYWNyb3NzIGFsbCB0YXJnZXRzLlxyXG4gICAgICpcclxuICAgICAqIFNlZSBEYlRhcmdldC5sYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIuXHJcbiAgICAgKi9cclxuICAgIGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciwgXHJcbiAgICAvKipcclxuICAgICAqIEEgZ2xvYmFsIHNuYXBzaG90IHZlcnNpb24gcmVwcmVzZW50aW5nIHRoZSBsYXN0IGNvbnNpc3RlbnQgc25hcHNob3Qgd2VcclxuICAgICAqIHJlY2VpdmVkIGZyb20gdGhlIGJhY2tlbmQuIFRoaXMgaXMgbW9ub3RvbmljYWxseSBpbmNyZWFzaW5nIGFuZCBhbnlcclxuICAgICAqIHNuYXBzaG90cyByZWNlaXZlZCBmcm9tIHRoZSBiYWNrZW5kIHByaW9yIHRvIHRoaXMgdmVyc2lvbiAoZS5nLiBmb3JcclxuICAgICAqIHRhcmdldHMgcmVzdW1lZCB3aXRoIGEgcmVzdW1lVG9rZW4pIHNob3VsZCBiZSBzdXBwcmVzc2VkIChidWZmZXJlZClcclxuICAgICAqIHVudGlsIHRoZSBiYWNrZW5kIGhhcyBjYXVnaHQgdXAgdG8gdGhpcyBzbmFwc2hvdCB2ZXJzaW9uIGFnYWluLiBUaGlzXHJcbiAgICAgKiBwcmV2ZW50cyBvdXIgY2FjaGUgZnJvbSBldmVyIGdvaW5nIGJhY2t3YXJkcyBpbiB0aW1lLlxyXG4gICAgICovXHJcbiAgICBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG51bWJlciBvZiB0YXJnZXRzIHBlcnNpc3RlZC5cclxuICAgICAqL1xyXG4gICAgdGFyZ2V0Q291bnQpIHtcclxuICAgICAgICB0aGlzLmhpZ2hlc3RUYXJnZXRJZCA9IGhpZ2hlc3RUYXJnZXRJZDtcclxuICAgICAgICB0aGlzLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICB0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0Q291bnQgPSB0YXJnZXRDb3VudDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIGtleSBzdHJpbmcgdXNlZCBmb3IgdGhlIHNpbmdsZSBvYmplY3QgdGhhdCBleGlzdHMgaW4gdGhlXHJcbiAgICAgKiBEYlRhcmdldEdsb2JhbCBzdG9yZS5cclxuICAgICAqL1xyXG4gICAgRGJUYXJnZXRHbG9iYWwua2V5ID0gJ3RhcmdldEdsb2JhbEtleSc7XHJcbiAgICBEYlRhcmdldEdsb2JhbC5zdG9yZSA9ICd0YXJnZXRHbG9iYWwnO1xyXG4gICAgcmV0dXJuIERiVGFyZ2V0R2xvYmFsO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBjcmVhdGVRdWVyeUNhY2hlKGRiKSB7XHJcbiAgICB2YXIgdGFyZ2V0RG9jdW1lbnRzU3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZShEYlRhcmdldERvY3VtZW50LnN0b3JlLCB7XHJcbiAgICAgICAga2V5UGF0aDogRGJUYXJnZXREb2N1bWVudC5rZXlQYXRoXHJcbiAgICB9KTtcclxuICAgIHRhcmdldERvY3VtZW50c1N0b3JlLmNyZWF0ZUluZGV4KERiVGFyZ2V0RG9jdW1lbnQuZG9jdW1lbnRUYXJnZXRzSW5kZXgsIERiVGFyZ2V0RG9jdW1lbnQuZG9jdW1lbnRUYXJnZXRzS2V5UGF0aCwgeyB1bmlxdWU6IHRydWUgfSk7XHJcbiAgICB2YXIgdGFyZ2V0U3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZShEYlRhcmdldC5zdG9yZSwge1xyXG4gICAgICAgIGtleVBhdGg6IERiVGFyZ2V0LmtleVBhdGhcclxuICAgIH0pO1xyXG4gICAgLy8gTk9URTogVGhpcyBpcyB1bmlxdWUgb25seSBiZWNhdXNlIHRoZSBUYXJnZXRJZCBpcyB0aGUgc3VmZml4LlxyXG4gICAgdGFyZ2V0U3RvcmUuY3JlYXRlSW5kZXgoRGJUYXJnZXQucXVlcnlUYXJnZXRzSW5kZXhOYW1lLCBEYlRhcmdldC5xdWVyeVRhcmdldHNLZXlQYXRoLCB7IHVuaXF1ZTogdHJ1ZSB9KTtcclxuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiVGFyZ2V0R2xvYmFsLnN0b3JlKTtcclxufVxyXG5mdW5jdGlvbiBkcm9wUXVlcnlDYWNoZShkYikge1xyXG4gICAgZGIuZGVsZXRlT2JqZWN0U3RvcmUoRGJUYXJnZXREb2N1bWVudC5zdG9yZSk7XHJcbiAgICBkYi5kZWxldGVPYmplY3RTdG9yZShEYlRhcmdldC5zdG9yZSk7XHJcbiAgICBkYi5kZWxldGVPYmplY3RTdG9yZShEYlRhcmdldEdsb2JhbC5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIENyZWF0ZXMgdGhlIHRhcmdldCBnbG9iYWwgc2luZ2xldG9uIHJvdy5cclxuICpcclxuICogQHBhcmFtIHtJREJUcmFuc2FjdGlvbn0gdHhuIFRoZSB2ZXJzaW9uIHVwZ3JhZGUgdHJhbnNhY3Rpb24gZm9yIGluZGV4ZWRkYlxyXG4gKi9cclxuZnVuY3Rpb24gd3JpdGVFbXB0eVRhcmdldEdsb2JhbEVudHJ5KHR4bikge1xyXG4gICAgdmFyIGdsb2JhbFN0b3JlID0gdHhuLnN0b3JlKERiVGFyZ2V0R2xvYmFsLnN0b3JlKTtcclxuICAgIHZhciBtZXRhZGF0YSA9IG5ldyBEYlRhcmdldEdsb2JhbChcclxuICAgIC8qaGlnaGVzdFRhcmdldElkPSovIDAsIFxyXG4gICAgLypsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI9Ki8gMCwgU25hcHNob3RWZXJzaW9uLk1JTi50b1RpbWVzdGFtcCgpLCBcclxuICAgIC8qdGFyZ2V0Q291bnQ9Ki8gMCk7XHJcbiAgICByZXR1cm4gZ2xvYmFsU3RvcmUucHV0KERiVGFyZ2V0R2xvYmFsLmtleSwgbWV0YWRhdGEpO1xyXG59XHJcbi8qKlxyXG4gKiBBbiBvYmplY3Qgc3RvcmUgdG8gc3RvcmUgdGhlIGtleXMgb2YgY2hhbmdlZCBkb2N1bWVudHMuIFRoaXMgaXMgdXNlZCB0b1xyXG4gKiBmYWNpbGl0YXRlIHN0b3JpbmcgZG9jdW1lbnQgY2hhbmdlbG9ncyBpbiB0aGUgUmVtb3RlIERvY3VtZW50IENhY2hlLlxyXG4gKlxyXG4gKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgdXNlZCBmb3IgY2hhbmdlIHByb3BhZ2F0aW9uIGR1cmluZyBtdWx0aS10YWIgc3luY2luZ1xyXG4gKiBhbmQgbm90IG5lZWRlZCBvbiBpT1MgYW5kIEFuZHJvaWQuXHJcbiAqL1xyXG52YXIgRGJSZW1vdGVEb2N1bWVudENoYW5nZXMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYlJlbW90ZURvY3VtZW50Q2hhbmdlcyhcclxuICAgIC8qKiBUaGUga2V5cyBvZiB0aGUgY2hhbmdlZCBkb2N1bWVudHMuICovXHJcbiAgICBjaGFuZ2VzKSB7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gY2hhbmdlcztcclxuICAgIH1cclxuICAgIC8qKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLiAgKi9cclxuICAgIERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzLnN0b3JlID0gJ3JlbW90ZURvY3VtZW50Q2hhbmdlcyc7XHJcbiAgICAvKiogS2V5cyBhcmUgYXV0by1nZW5lcmF0ZWQgdmlhIHRoZSBgaWRgIHByb3BlcnR5LiAqL1xyXG4gICAgRGJSZW1vdGVEb2N1bWVudENoYW5nZXMua2V5UGF0aCA9ICdpZCc7XHJcbiAgICByZXR1cm4gRGJSZW1vdGVEb2N1bWVudENoYW5nZXM7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGNyZWF0ZVJlbW90ZURvY3VtZW50Q2hhbmdlc1N0b3JlKGRiKSB7XHJcbiAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShEYlJlbW90ZURvY3VtZW50Q2hhbmdlcy5zdG9yZSwge1xyXG4gICAgICAgIGtleVBhdGg6ICdpZCcsXHJcbiAgICAgICAgYXV0b0luY3JlbWVudDogdHJ1ZVxyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIEEgcmVjb3JkIG9mIHRoZSBtZXRhZGF0YSBzdGF0ZSBvZiBlYWNoIGNsaWVudC5cclxuICpcclxuICogUE9SVElORyBOT1RFOiBUaGlzIGlzIHVzZWQgdG8gc3luY2hyb25pemUgbXVsdGktdGFiIHN0YXRlIGFuZCBkb2VzIG5vdCBuZWVkXHJcbiAqIHRvIGJlIHBvcnRlZCB0byBpT1Mgb3IgQW5kcm9pZC5cclxuICovXHJcbnZhciBEYkNsaWVudE1ldGFkYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJDbGllbnRNZXRhZGF0YShcclxuICAgIC8qKiBUaGUgYXV0by1nZW5lcmF0ZWQgY2xpZW50IGlkIGFzc2lnbmVkIGF0IGNsaWVudCBzdGFydHVwLiAqL1xyXG4gICAgY2xpZW50SWQsIFxyXG4gICAgLyoqIFRoZSBsYXN0IHRpbWUgdGhpcyBzdGF0ZSB3YXMgdXBkYXRlZC4gKi9cclxuICAgIHVwZGF0ZVRpbWVNcywgXHJcbiAgICAvKiogV2hldGhlciB0aGUgY2xpZW50J3MgbmV0d29yayBjb25uZWN0aW9uIGlzIGVuYWJsZWQuICovXHJcbiAgICBuZXR3b3JrRW5hYmxlZCwgXHJcbiAgICAvKiogV2hldGhlciB0aGlzIGNsaWVudCBpcyBydW5uaW5nIGluIGEgZm9yZWdyb3VuZCB0YWIuICovXHJcbiAgICBpbkZvcmVncm91bmQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbGFzdCBjaGFuZ2UgcmVhZCBmcm9tIHRoZSBEYlJlbW90ZURvY3VtZW50Q2hhbmdlcyBzdG9yZS5cclxuICAgICAqIENhbiBiZSB1bmRlZmluZWQgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LlxyXG4gICAgICovXHJcbiAgICBsYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCkge1xyXG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDtcclxuICAgICAgICB0aGlzLnVwZGF0ZVRpbWVNcyA9IHVwZGF0ZVRpbWVNcztcclxuICAgICAgICB0aGlzLm5ldHdvcmtFbmFibGVkID0gbmV0d29ya0VuYWJsZWQ7XHJcbiAgICAgICAgdGhpcy5pbkZvcmVncm91bmQgPSBpbkZvcmVncm91bmQ7XHJcbiAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCA9IGxhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkO1xyXG4gICAgfVxyXG4gICAgLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICovXHJcbiAgICBEYkNsaWVudE1ldGFkYXRhLnN0b3JlID0gJ2NsaWVudE1ldGFkYXRhJztcclxuICAgIC8qKiBLZXlzIGFyZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHZpYSB0aGUgY2xpZW50SWQgcHJvcGVydGllcy4gKi9cclxuICAgIERiQ2xpZW50TWV0YWRhdGEua2V5UGF0aCA9ICdjbGllbnRJZCc7XHJcbiAgICByZXR1cm4gRGJDbGllbnRNZXRhZGF0YTtcclxufSgpKTtcclxuZnVuY3Rpb24gY3JlYXRlQ2xpZW50TWV0YWRhdGFTdG9yZShkYikge1xyXG4gICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJDbGllbnRNZXRhZGF0YS5zdG9yZSwge1xyXG4gICAgICAgIGtleVBhdGg6IERiQ2xpZW50TWV0YWRhdGEua2V5UGF0aFxyXG4gICAgfSk7XHJcbn1cclxuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xyXG52YXIgVjFfU1RPUkVTID0gW1xyXG4gICAgRGJNdXRhdGlvblF1ZXVlLnN0b3JlLFxyXG4gICAgRGJNdXRhdGlvbkJhdGNoLnN0b3JlLFxyXG4gICAgRGJEb2N1bWVudE11dGF0aW9uLnN0b3JlLFxyXG4gICAgRGJSZW1vdGVEb2N1bWVudC5zdG9yZSxcclxuICAgIERiVGFyZ2V0LnN0b3JlLFxyXG4gICAgRGJQcmltYXJ5Q2xpZW50LnN0b3JlLFxyXG4gICAgRGJUYXJnZXRHbG9iYWwuc3RvcmUsXHJcbiAgICBEYlRhcmdldERvY3VtZW50LnN0b3JlXHJcbl07XHJcbi8vIFYyIGlzIG5vIGxvbmdlciB1c2FibGUgKHNlZSBjb21tZW50IGF0IHRvcCBvZiBmaWxlKVxyXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXHJcbnZhciBWM19TVE9SRVMgPSBWMV9TVE9SRVM7XHJcbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcclxudmFyIFY0X1NUT1JFUyA9IFYzX1NUT1JFUy5jb25jYXQoW1xyXG4gICAgRGJDbGllbnRNZXRhZGF0YS5zdG9yZSxcclxuICAgIERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzLnN0b3JlXHJcbl0pO1xyXG4vLyBWNSBkb2VzIG5vdCBjaGFuZ2UgdGhlIHNldCBvZiBzdG9yZXMuXHJcbnZhciBWNl9TVE9SRVMgPSBWNF9TVE9SRVMuY29uY2F0KFtEYlJlbW90ZURvY3VtZW50R2xvYmFsLnN0b3JlXSk7XHJcbi8qKlxyXG4gKiBUaGUgbGlzdCBvZiBhbGwgZGVmYXVsdCBJbmRleGVkREIgc3RvcmVzIHVzZWQgdGhyb3VnaG91dCB0aGUgU0RLLiBUaGlzIGlzXHJcbiAqIHVzZWQgd2hlbiBjcmVhdGluZyB0cmFuc2FjdGlvbnMgc28gdGhhdCBhY2Nlc3MgYWNyb3NzIGFsbCBzdG9yZXMgaXMgZG9uZVxyXG4gKiBhdG9taWNhbGx5LlxyXG4gKi9cclxudmFyIEFMTF9TVE9SRVMgPSBWNl9TVE9SRVM7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKiogQSBtdXRhdGlvbiBxdWV1ZSBmb3IgYSBzcGVjaWZpYyB1c2VyLCBiYWNrZWQgYnkgSW5kZXhlZERCLiAqL1xyXG52YXIgSW5kZXhlZERiTXV0YXRpb25RdWV1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEluZGV4ZWREYk11dGF0aW9uUXVldWUoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBub3JtYWxpemVkIHVzZXJJZCAoZS5nLiBudWxsIFVJRCA9PiBcIlwiIHVzZXJJZCkgdXNlZCB0byBzdG9yZSAvXHJcbiAgICAgKiByZXRyaWV2ZSBtdXRhdGlvbnMuXHJcbiAgICAgKi9cclxuICAgIHVzZXJJZCwgc2VyaWFsaXplciwgcmVmZXJlbmNlRGVsZWdhdGUpIHtcclxuICAgICAgICB0aGlzLnVzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSByZWZlcmVuY2VEZWxlZ2F0ZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDYWNoZXMgdGhlIGRvY3VtZW50IGtleXMgZm9yIHBlbmRpbmcgbXV0YXRpb24gYmF0Y2hlcy4gSWYgdGhlIG11dGF0aW9uXHJcbiAgICAgICAgICogaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIEluZGV4ZWREYiwgdGhlIGNhY2hlZCB2YWx1ZSBtYXkgY29udGludWUgdG9cclxuICAgICAgICAgKiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBiYXRjaCdzIGRvY3VtZW50IGtleXMuIFRvIHJlbW92ZSBhIGNhY2hlZCB2YWx1ZVxyXG4gICAgICAgICAqIGxvY2FsbHksIGByZW1vdmVDYWNoZWRNdXRhdGlvbktleXMoKWAgc2hvdWxkIGJlIGludm9rZWQgZWl0aGVyIGRpcmVjdGx5XHJcbiAgICAgICAgICogb3IgdGhyb3VnaCBgcmVtb3ZlTXV0YXRpb25CYXRjaGVzKClgLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogV2l0aCBtdWx0aS10YWIsIHdoZW4gdGhlIHByaW1hcnkgY2xpZW50IGFja25vd2xlZGdlcyBvciByZWplY3RzIGEgbXV0YXRpb24sXHJcbiAgICAgICAgICogdGhpcyBjYWNoZSBpcyB1c2VkIGJ5IHNlY29uZGFyeSBjbGllbnRzIHRvIGludmFsaWRhdGUgdGhlIGxvY2FsXHJcbiAgICAgICAgICogdmlldyBvZiB0aGUgZG9jdW1lbnRzIHRoYXQgd2VyZSBwcmV2aW91c2x5IGFmZmVjdGVkIGJ5IHRoZSBtdXRhdGlvbi5cclxuICAgICAgICAgKi9cclxuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRLZXlzQnlCYXRjaElkID0ge307XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBuZXcgbXV0YXRpb24gcXVldWUgZm9yIHRoZSBnaXZlbiB1c2VyLlxyXG4gICAgICogQHBhcmFtIHVzZXIgVGhlIHVzZXIgZm9yIHdoaWNoIHRvIGNyZWF0ZSBhIG11dGF0aW9uIHF1ZXVlLlxyXG4gICAgICogQHBhcmFtIHNlcmlhbGl6ZXIgVGhlIHNlcmlhbGl6ZXIgdG8gdXNlIHdoZW4gcGVyc2lzdGluZyB0byBJbmRleGVkRGIuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUuZm9yVXNlciA9IGZ1bmN0aW9uICh1c2VyLCBzZXJpYWxpemVyLCByZWZlcmVuY2VEZWxlZ2F0ZSkge1xyXG4gICAgICAgIC8vIFRPRE8obWNnKTogRmlndXJlIG91dCB3aGF0IGNvbnN0cmFpbnRzIHRoZXJlIGFyZSBvbiB1c2VySURzXHJcbiAgICAgICAgLy8gSW4gcGFydGljdWxhciwgYXJlIHRoZXJlIGFueSByZXNlcnZlZCBjaGFyYWN0ZXJzPyBhcmUgZW1wdHkgaWRzIGFsbG93ZWQ/XHJcbiAgICAgICAgLy8gRm9yIHRoZSBtb21lbnQgc3RvcmUgdGhlc2UgdG9nZXRoZXIgaW4gdGhlIHNhbWUgbXV0YXRpb25zIHRhYmxlIGFzc3VtaW5nXHJcbiAgICAgICAgLy8gdGhhdCBlbXB0eSB1c2VySURzIGFyZW4ndCBhbGxvd2VkLlxyXG4gICAgICAgIGFzc2VydCh1c2VyLnVpZCAhPT0gJycsICdVc2VySUQgbXVzdCBub3QgYmUgYW4gZW1wdHkgc3RyaW5nLicpO1xyXG4gICAgICAgIHZhciB1c2VySWQgPSB1c2VyLmlzQXV0aGVudGljYXRlZCgpID8gdXNlci51aWQgOiAnJztcclxuICAgICAgICByZXR1cm4gbmV3IEluZGV4ZWREYk11dGF0aW9uUXVldWUodXNlcklkLCBzZXJpYWxpemVyLCByZWZlcmVuY2VEZWxlZ2F0ZSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuY2hlY2tFbXB0eSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBlbXB0eSA9IHRydWU7XHJcbiAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UuYm91bmQoW3RoaXMudXNlcklkLCBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFldLCBbdGhpcy51c2VySWQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWV0pO1xyXG4gICAgICAgIHJldHVybiBtdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLml0ZXJhdGUoeyBpbmRleDogRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNJbmRleCwgcmFuZ2U6IHJhbmdlIH0sIGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgIGVtcHR5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVtcHR5OyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hY2tub3dsZWRnZUJhdGNoID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaCwgc3RyZWFtVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRNdXRhdGlvblF1ZXVlTWV0YWRhdGEodHJhbnNhY3Rpb24pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBiYXRjaElkID0gYmF0Y2guYmF0Y2hJZDtcclxuICAgICAgICAgICAgYXNzZXJ0KGJhdGNoSWQgPiBtZXRhZGF0YS5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCwgJ011dGF0aW9uIGJhdGNoSURzIG11c3QgYmUgYWNrbm93bGVkZ2VkIGluIG9yZGVyJyk7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLmxhc3RBY2tub3dsZWRnZWRCYXRjaElkID0gYmF0Y2hJZDtcclxuICAgICAgICAgICAgbWV0YWRhdGEubGFzdFN0cmVhbVRva2VuID0gY29udmVydFN0cmVhbVRva2VuKHN0cmVhbVRva2VuKTtcclxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9uUXVldWVzU3RvcmUodHJhbnNhY3Rpb24pLnB1dChtZXRhZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0TGFzdFN0cmVhbVRva2VuID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TXV0YXRpb25RdWV1ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkgeyByZXR1cm4gbWV0YWRhdGEubGFzdFN0cmVhbVRva2VuOyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5zZXRMYXN0U3RyZWFtVG9rZW4gPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHN0cmVhbVRva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TXV0YXRpb25RdWV1ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5sYXN0U3RyZWFtVG9rZW4gPSBjb252ZXJ0U3RyZWFtVG9rZW4oc3RyZWFtVG9rZW4pO1xyXG4gICAgICAgICAgICByZXR1cm4gbXV0YXRpb25RdWV1ZXNTdG9yZSh0cmFuc2FjdGlvbikucHV0KG1ldGFkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hZGRNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBsb2NhbFdyaXRlVGltZSwgbXV0YXRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZG9jdW1lbnRTdG9yZSA9IGRvY3VtZW50TXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pO1xyXG4gICAgICAgIHZhciBtdXRhdGlvblN0b3JlID0gbXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pO1xyXG4gICAgICAgIC8vIFRoZSBJbmRleGVkRGIgaW1wbGVtZW50YXRpb24gaW4gQ2hyb21lIChhbmQgRmlyZWZveCkgZG9lcyBub3QgaGFuZGxlXHJcbiAgICAgICAgLy8gY29tcG91bmQgaW5kaWNlcyB0aGF0IGluY2x1ZGUgYXV0by1nZW5lcmF0ZWQga2V5cyBjb3JyZWN0bHkuIFRvIGVuc3VyZVxyXG4gICAgICAgIC8vIHRoYXQgdGhlIGluZGV4IGVudHJ5IGlzIGFkZGVkIGNvcnJlY3RseSBpbiBhbGwgYnJvd3NlcnMsIHdlIHBlcmZvcm0gdHdvXHJcbiAgICAgICAgLy8gd3JpdGVzOiBUaGUgZmlyc3Qgd3JpdGUgaXMgdXNlZCB0byByZXRyaWV2ZSB0aGUgbmV4dCBhdXRvLWdlbmVyYXRlZCBCYXRjaFxyXG4gICAgICAgIC8vIElELCBhbmQgdGhlIHNlY29uZCB3cml0ZSBwb3B1bGF0ZXMgdGhlIGluZGV4IGFuZCBzdG9yZXMgdGhlIGFjdHVhbFxyXG4gICAgICAgIC8vIG11dGF0aW9uIGJhdGNoLlxyXG4gICAgICAgIC8vIFNlZTogaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NzAxOTcyXHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBXZSB3cml0ZSBhbiBlbXB0eSBvYmplY3QgdG8gb2J0YWluIGtleVxyXG4gICAgICAgIHJldHVybiBtdXRhdGlvblN0b3JlLmFkZCh7fSkubmV4dChmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgICAgICBhc3NlcnQodHlwZW9mIGJhdGNoSWQgPT09ICdudW1iZXInLCAnQXV0by1nZW5lcmF0ZWQga2V5IGlzIG5vdCBhIG51bWJlcicpO1xyXG4gICAgICAgICAgICB2YXIgYmF0Y2ggPSBuZXcgTXV0YXRpb25CYXRjaChiYXRjaElkLCBsb2NhbFdyaXRlVGltZSwgbXV0YXRpb25zKTtcclxuICAgICAgICAgICAgdmFyIGRiQmF0Y2ggPSBfdGhpcy5zZXJpYWxpemVyLnRvRGJNdXRhdGlvbkJhdGNoKF90aGlzLnVzZXJJZCwgYmF0Y2gpO1xyXG4gICAgICAgICAgICBfdGhpcy5kb2N1bWVudEtleXNCeUJhdGNoSWRbYmF0Y2hJZF0gPSBiYXRjaC5rZXlzKCk7XHJcbiAgICAgICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIG11dGF0aW9uc18xID0gbXV0YXRpb25zOyBfaSA8IG11dGF0aW9uc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG11dGF0aW9uID0gbXV0YXRpb25zXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4S2V5ID0gRGJEb2N1bWVudE11dGF0aW9uLmtleShfdGhpcy51c2VySWQsIG11dGF0aW9uLmtleS5wYXRoLCBiYXRjaElkKTtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2gobXV0YXRpb25TdG9yZS5wdXQoZGJCYXRjaCkpO1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChkb2N1bWVudFN0b3JlLnB1dChpbmRleEtleSwgRGJEb2N1bWVudE11dGF0aW9uLlBMQUNFSE9MREVSKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKS5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGJhdGNoOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5sb29rdXBNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5nZXQoYmF0Y2hJZClcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGRiQmF0Y2gpIHtcclxuICAgICAgICAgICAgaWYgKGRiQmF0Y2gpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChkYkJhdGNoLnVzZXJJZCA9PT0gX3RoaXMudXNlcklkLCBcIlVuZXhwZWN0ZWQgdXNlciAnXCIgKyBkYkJhdGNoLnVzZXJJZCArIFwiJyBmb3IgbXV0YXRpb24gYmF0Y2ggXCIgKyBiYXRjaElkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zZXJpYWxpemVyLmZyb21EYk11dGF0aW9uQmF0Y2goZGJCYXRjaCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUubG9va3VwTXV0YXRpb25LZXlzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5kb2N1bWVudEtleXNCeUJhdGNoSWRbYmF0Y2hJZF0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuZG9jdW1lbnRLZXlzQnlCYXRjaElkW2JhdGNoSWRdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvb2t1cE11dGF0aW9uQmF0Y2godHJhbnNhY3Rpb24sIGJhdGNoSWQpLm5leHQoZnVuY3Rpb24gKGJhdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYmF0Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5cyA9IGJhdGNoLmtleXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5kb2N1bWVudEtleXNCeUJhdGNoSWRbYmF0Y2hJZF0gPSBrZXlzO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TXV0YXRpb25RdWV1ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICAvLyBBbGwgYmF0Y2hlcyB3aXRoIGJhdGNoSWQgPD0gdGhpcy5tZXRhZGF0YS5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCBoYXZlXHJcbiAgICAgICAgICAgIC8vIGJlZW4gYWNrbm93bGVkZ2VkIHNvIHRoZSBmaXJzdCB1bmFja25vd2xlZGdlZCBiYXRjaCBhZnRlciBiYXRjaElEIHdpbGxcclxuICAgICAgICAgICAgLy8gaGF2ZSBhIGJhdGNoSUQgbGFyZ2VyIHRoYW4gYm90aCBvZiB0aGVzZSB2YWx1ZXMuXHJcbiAgICAgICAgICAgIHZhciBuZXh0QmF0Y2hJZCA9IE1hdGgubWF4KGJhdGNoSWQsIG1ldGFkYXRhLmxhc3RBY2tub3dsZWRnZWRCYXRjaElkKSArIDE7XHJcbiAgICAgICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoW190aGlzLnVzZXJJZCwgbmV4dEJhdGNoSWRdKTtcclxuICAgICAgICAgICAgdmFyIGZvdW5kQmF0Y2ggPSBudWxsO1xyXG4gICAgICAgICAgICByZXR1cm4gbXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgICAgICAuaXRlcmF0ZSh7IGluZGV4OiBEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0luZGV4LCByYW5nZTogcmFuZ2UgfSwgZnVuY3Rpb24gKGtleSwgZGJCYXRjaCwgY29udHJvbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRiQmF0Y2gudXNlcklkID09PSBfdGhpcy51c2VySWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoZGJCYXRjaC5iYXRjaElkID49IG5leHRCYXRjaElkLCAnU2hvdWxkIGhhdmUgZm91bmQgbXV0YXRpb24gYWZ0ZXIgJyArIG5leHRCYXRjaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3VuZEJhdGNoID0gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJNdXRhdGlvbkJhdGNoKGRiQmF0Y2gpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBmb3VuZEJhdGNoOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmJvdW5kKFt0aGlzLnVzZXJJZCwgQkFUQ0hJRF9VTktOT1dOXSwgW3RoaXMudXNlcklkLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFldKTtcclxuICAgICAgICByZXR1cm4gbXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5sb2FkQWxsKERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zSW5kZXgsIHJhbmdlKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoZGJCYXRjaGVzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYkJhdGNoZXMubWFwKGZ1bmN0aW9uIChkYkJhdGNoKSB7IHJldHVybiBfdGhpcy5zZXJpYWxpemVyLmZyb21EYk11dGF0aW9uQmF0Y2goZGJCYXRjaCk7IH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gU2NhbiB0aGUgZG9jdW1lbnQtbXV0YXRpb24gaW5kZXggc3RhcnRpbmcgd2l0aCBhIHByZWZpeCBzdGFydGluZyB3aXRoXHJcbiAgICAgICAgLy8gdGhlIGdpdmVuIGRvY3VtZW50S2V5LlxyXG4gICAgICAgIHZhciBpbmRleFByZWZpeCA9IERiRG9jdW1lbnRNdXRhdGlvbi5wcmVmaXhGb3JQYXRoKHRoaXMudXNlcklkLCBkb2N1bWVudEtleS5wYXRoKTtcclxuICAgICAgICB2YXIgaW5kZXhTdGFydCA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoaW5kZXhQcmVmaXgpO1xyXG4gICAgICAgIHZhciByZXN1bHRzID0gW107XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50TXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKHsgcmFuZ2U6IGluZGV4U3RhcnQgfSwgZnVuY3Rpb24gKGluZGV4S2V5LCBfLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VySUQgPSBpbmRleEtleVswXSwgZW5jb2RlZFBhdGggPSBpbmRleEtleVsxXSwgYmF0Y2hJZCA9IGluZGV4S2V5WzJdO1xyXG4gICAgICAgICAgICAvLyBPbmx5IGNvbnNpZGVyIHJvd3MgbWF0Y2hpbmcgZXhhY3RseSB0aGUgc3BlY2lmaWMga2V5IG9mXHJcbiAgICAgICAgICAgIC8vIGludGVyZXN0LiBOb3RlIHRoYXQgYmVjYXVzZSB3ZSBvcmRlciBieSBwYXRoIGZpcnN0LCBhbmQgd2VcclxuICAgICAgICAgICAgLy8gb3JkZXIgdGVybWluYXRvcnMgYmVmb3JlIHBhdGggc2VwYXJhdG9ycywgd2UnbGwgZW5jb3VudGVyIGFsbFxyXG4gICAgICAgICAgICAvLyB0aGUgaW5kZXggcm93cyBmb3IgZG9jdW1lbnRLZXkgY29udGlndW91c2x5LiBJbiBwYXJ0aWN1bGFyLCBhbGxcclxuICAgICAgICAgICAgLy8gdGhlIHJvd3MgZm9yIGRvY3VtZW50S2V5IHdpbGwgb2NjdXIgYmVmb3JlIGFueSByb3dzIGZvclxyXG4gICAgICAgICAgICAvLyBkb2N1bWVudHMgbmVzdGVkIGluIGEgc3ViY29sbGVjdGlvbiBiZW5lYXRoIGRvY3VtZW50S2V5IHNvIHdlXHJcbiAgICAgICAgICAgIC8vIGNhbiBzdG9wIGFzIHNvb24gYXMgd2UgaGl0IGFueSBzdWNoIHJvdy5cclxuICAgICAgICAgICAgdmFyIHBhdGggPSBkZWNvZGUkMShlbmNvZGVkUGF0aCk7XHJcbiAgICAgICAgICAgIGlmICh1c2VySUQgIT09IF90aGlzLnVzZXJJZCB8fCAhZG9jdW1lbnRLZXkucGF0aC5pc0VxdWFsKHBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBMb29rIHVwIHRoZSBtdXRhdGlvbiBiYXRjaCBpbiB0aGUgc3RvcmUuXHJcbiAgICAgICAgICAgIHJldHVybiBtdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgICAgIC5nZXQoYmF0Y2hJZClcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChtdXRhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFtdXRhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGZhaWwoJ0RhbmdsaW5nIGRvY3VtZW50LW11dGF0aW9uIHJlZmVyZW5jZSBmb3VuZDogJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4S2V5ICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJyB3aGljaCBwb2ludHMgdG8gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KG11dGF0aW9uLnVzZXJJZCA9PT0gX3RoaXMudXNlcklkLCBcIlVuZXhwZWN0ZWQgdXNlciAnXCIgKyBtdXRhdGlvbi51c2VySWQgKyBcIicgZm9yIG11dGF0aW9uIGJhdGNoIFwiICsgYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goX3RoaXMuc2VyaWFsaXplci5mcm9tRGJNdXRhdGlvbkJhdGNoKG11dGF0aW9uKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlc3VsdHM7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5cyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXlzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgdW5pcXVlQmF0Y2hJRHMgPSBuZXcgU29ydGVkU2V0KHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG4gICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIGRvY3VtZW50S2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChkb2N1bWVudEtleSkge1xyXG4gICAgICAgICAgICB2YXIgaW5kZXhTdGFydCA9IERiRG9jdW1lbnRNdXRhdGlvbi5wcmVmaXhGb3JQYXRoKF90aGlzLnVzZXJJZCwgZG9jdW1lbnRLZXkucGF0aCk7XHJcbiAgICAgICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoaW5kZXhTdGFydCk7XHJcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gZG9jdW1lbnRNdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbikuaXRlcmF0ZSh7IHJhbmdlOiByYW5nZSB9LCBmdW5jdGlvbiAoaW5kZXhLZXksIF8sIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgICAgIHZhciB1c2VySUQgPSBpbmRleEtleVswXSwgZW5jb2RlZFBhdGggPSBpbmRleEtleVsxXSwgYmF0Y2hJRCA9IGluZGV4S2V5WzJdO1xyXG4gICAgICAgICAgICAgICAgLy8gT25seSBjb25zaWRlciByb3dzIG1hdGNoaW5nIGV4YWN0bHkgdGhlIHNwZWNpZmljIGtleSBvZlxyXG4gICAgICAgICAgICAgICAgLy8gaW50ZXJlc3QuIE5vdGUgdGhhdCBiZWNhdXNlIHdlIG9yZGVyIGJ5IHBhdGggZmlyc3QsIGFuZCB3ZVxyXG4gICAgICAgICAgICAgICAgLy8gb3JkZXIgdGVybWluYXRvcnMgYmVmb3JlIHBhdGggc2VwYXJhdG9ycywgd2UnbGwgZW5jb3VudGVyIGFsbFxyXG4gICAgICAgICAgICAgICAgLy8gdGhlIGluZGV4IHJvd3MgZm9yIGRvY3VtZW50S2V5IGNvbnRpZ3VvdXNseS4gSW4gcGFydGljdWxhciwgYWxsXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgcm93cyBmb3IgZG9jdW1lbnRLZXkgd2lsbCBvY2N1ciBiZWZvcmUgYW55IHJvd3MgZm9yXHJcbiAgICAgICAgICAgICAgICAvLyBkb2N1bWVudHMgbmVzdGVkIGluIGEgc3ViY29sbGVjdGlvbiBiZW5lYXRoIGRvY3VtZW50S2V5IHNvIHdlXHJcbiAgICAgICAgICAgICAgICAvLyBjYW4gc3RvcCBhcyBzb29uIGFzIHdlIGhpdCBhbnkgc3VjaCByb3cuXHJcbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IGRlY29kZSQxKGVuY29kZWRQYXRoKTtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VySUQgIT09IF90aGlzLnVzZXJJZCB8fCAhZG9jdW1lbnRLZXkucGF0aC5pc0VxdWFsKHBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdW5pcXVlQmF0Y2hJRHMgPSB1bmlxdWVCYXRjaElEcy5hZGQoYmF0Y2hJRCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKHByb21pc2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcykubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb29rdXBNdXRhdGlvbkJhdGNoZXModHJhbnNhY3Rpb24sIHVuaXF1ZUJhdGNoSURzKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCghcXVlcnkuaXNEb2N1bWVudFF1ZXJ5KCksIFwiRG9jdW1lbnQgcXVlcmllcyBzaG91bGRuJ3QgZ28gZG93biB0aGlzIHBhdGhcIik7XHJcbiAgICAgICAgdmFyIHF1ZXJ5UGF0aCA9IHF1ZXJ5LnBhdGg7XHJcbiAgICAgICAgdmFyIGltbWVkaWF0ZUNoaWxkcmVuTGVuZ3RoID0gcXVlcnlQYXRoLmxlbmd0aCArIDE7XHJcbiAgICAgICAgLy8gVE9ETyhtY2cpOiBBY3R1YWxseSBpbXBsZW1lbnQgYSBzaW5nbGUtY29sbGVjdGlvbiBxdWVyeVxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gVGhpcyBpcyBhY3R1YWxseSBleGVjdXRpbmcgYW4gYW5jZXN0b3IgcXVlcnksIHRyYXZlcnNpbmcgdGhlIHdob2xlXHJcbiAgICAgICAgLy8gc3VidHJlZSBiZWxvdyB0aGUgY29sbGVjdGlvbiB3aGljaCBjYW4gYmUgaG9ycmlmaWNhbGx5IGluZWZmaWNpZW50IGZvclxyXG4gICAgICAgIC8vIHNvbWUgc3RydWN0dXJlcy4gVGhlIHJpZ2h0IHdheSB0byBzb2x2ZSB0aGlzIGlzIHRvIGltcGxlbWVudCB0aGUgZnVsbFxyXG4gICAgICAgIC8vIHZhbHVlIGluZGV4LCBidXQgdGhhdCdzIG5vdCBpbiB0aGUgY2FyZHMgaW4gdGhlIG5lYXIgZnV0dXJlIHNvIHRoaXMgaXNcclxuICAgICAgICAvLyB0aGUgYmVzdCB3ZSBjYW4gZG8gZm9yIHRoZSBtb21lbnQuXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBTaW5jZSB3ZSBkb24ndCB5ZXQgaW5kZXggdGhlIGFjdHVhbCBwcm9wZXJ0aWVzIGluIHRoZSBtdXRhdGlvbnMsIG91clxyXG4gICAgICAgIC8vIGN1cnJlbnQgYXBwcm9hY2ggaXMgdG8ganVzdCByZXR1cm4gYWxsIG11dGF0aW9uIGJhdGNoZXMgdGhhdCBhZmZlY3RcclxuICAgICAgICAvLyBkb2N1bWVudHMgaW4gdGhlIGNvbGxlY3Rpb24gYmVpbmcgcXVlcmllZC5cclxuICAgICAgICB2YXIgaW5kZXhQcmVmaXggPSBEYkRvY3VtZW50TXV0YXRpb24ucHJlZml4Rm9yUGF0aCh0aGlzLnVzZXJJZCwgcXVlcnlQYXRoKTtcclxuICAgICAgICB2YXIgaW5kZXhTdGFydCA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoaW5kZXhQcmVmaXgpO1xyXG4gICAgICAgIC8vIENvbGxlY3QgdXAgdW5pcXVlIGJhdGNoSURzIGVuY291bnRlcmVkIGR1cmluZyBhIHNjYW4gb2YgdGhlIGluZGV4LiBVc2UgYVxyXG4gICAgICAgIC8vIFNvcnRlZFNldCB0byBhY2N1bXVsYXRlIGJhdGNoIElEcyBzbyB0aGV5IGNhbiBiZSB0cmF2ZXJzZWQgaW4gb3JkZXIgaW4gYVxyXG4gICAgICAgIC8vIHNjYW4gb2YgdGhlIG1haW4gdGFibGUuXHJcbiAgICAgICAgdmFyIHVuaXF1ZUJhdGNoSURzID0gbmV3IFNvcnRlZFNldChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnRNdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLml0ZXJhdGUoeyByYW5nZTogaW5kZXhTdGFydCB9LCBmdW5jdGlvbiAoaW5kZXhLZXksIF8sIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgdmFyIHVzZXJJRCA9IGluZGV4S2V5WzBdLCBlbmNvZGVkUGF0aCA9IGluZGV4S2V5WzFdLCBiYXRjaElEID0gaW5kZXhLZXlbMl07XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gZGVjb2RlJDEoZW5jb2RlZFBhdGgpO1xyXG4gICAgICAgICAgICBpZiAodXNlcklEICE9PSBfdGhpcy51c2VySWQgfHwgIXF1ZXJ5UGF0aC5pc1ByZWZpeE9mKHBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBSb3dzIHdpdGggZG9jdW1lbnQga2V5cyBtb3JlIHRoYW4gb25lIHNlZ21lbnQgbG9uZ2VyIHRoYW4gdGhlXHJcbiAgICAgICAgICAgIC8vIHF1ZXJ5IHBhdGggY2FuJ3QgYmUgbWF0Y2hlcy4gRm9yIGV4YW1wbGUsIGEgcXVlcnkgb24gJ3Jvb21zJ1xyXG4gICAgICAgICAgICAvLyBjYW4ndCBtYXRjaCB0aGUgZG9jdW1lbnQgL3Jvb21zL2FiYy9tZXNzYWdlcy94eXguXHJcbiAgICAgICAgICAgIC8vIFRPRE8obWNnKTogd2UnbGwgbmVlZCBhIGRpZmZlcmVudCBzY2FubmVyIHdoZW4gd2UgaW1wbGVtZW50XHJcbiAgICAgICAgICAgIC8vIGFuY2VzdG9yIHF1ZXJpZXMuXHJcbiAgICAgICAgICAgIGlmIChwYXRoLmxlbmd0aCAhPT0gaW1tZWRpYXRlQ2hpbGRyZW5MZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB1bmlxdWVCYXRjaElEcyA9IHVuaXF1ZUJhdGNoSURzLmFkZChiYXRjaElEKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5sb29rdXBNdXRhdGlvbkJhdGNoZXModHJhbnNhY3Rpb24sIHVuaXF1ZUJhdGNoSURzKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUubG9va3VwTXV0YXRpb25CYXRjaGVzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaElEcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcclxuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICAvLyBUT0RPKHJvY2t3b29kKTogSW1wbGVtZW50IHRoaXMgdXNpbmcgaXRlcmF0ZS5cclxuICAgICAgICBiYXRjaElEcy5mb3JFYWNoKGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2gobXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgICAgICAuZ2V0KGJhdGNoSWQpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAobXV0YXRpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChtdXRhdGlvbiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGZhaWwoJ0RhbmdsaW5nIGRvY3VtZW50LW11dGF0aW9uIHJlZmVyZW5jZSBmb3VuZCwgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd3aGljaCBwb2ludHMgdG8gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KG11dGF0aW9uLnVzZXJJZCA9PT0gX3RoaXMudXNlcklkLCBcIlVuZXhwZWN0ZWQgdXNlciAnXCIgKyBtdXRhdGlvbi51c2VySWQgKyBcIicgZm9yIG11dGF0aW9uIGJhdGNoIFwiICsgYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goX3RoaXMuc2VyaWFsaXplci5mcm9tRGJNdXRhdGlvbkJhdGNoKG11dGF0aW9uKSk7XHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0czsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUucmVtb3ZlTXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2gpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiByZW1vdmVNdXRhdGlvbkJhdGNoKHRyYW5zYWN0aW9uLnNpbXBsZURiVHJhbnNhY3Rpb24sIHRoaXMudXNlcklkLCBiYXRjaCkubmV4dChmdW5jdGlvbiAocmVtb3ZlZERvY3VtZW50cykge1xyXG4gICAgICAgICAgICBfdGhpcy5yZW1vdmVDYWNoZWRNdXRhdGlvbktleXMoYmF0Y2guYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaChyZW1vdmVkRG9jdW1lbnRzLCBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlTXV0YXRpb25SZWZlcmVuY2UodHJhbnNhY3Rpb24sIGtleSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLnJlbW92ZUNhY2hlZE11dGF0aW9uS2V5cyA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMuZG9jdW1lbnRLZXlzQnlCYXRjaElkW2JhdGNoSWRdO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLnBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tFbXB0eSh0eG4pLm5leHQoZnVuY3Rpb24gKGVtcHR5KSB7XHJcbiAgICAgICAgICAgIGlmICghZW1wdHkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZXJlIGFyZSBubyBlbnRyaWVzIGluIHRoZSBkb2N1bWVudE11dGF0aW9ucyBpbmRleCBpZlxyXG4gICAgICAgICAgICAvLyB0aGUgcXVldWUgaXMgZW1wdHkuXHJcbiAgICAgICAgICAgIHZhciBzdGFydFJhbmdlID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChEYkRvY3VtZW50TXV0YXRpb24ucHJlZml4Rm9yVXNlcihfdGhpcy51c2VySWQpKTtcclxuICAgICAgICAgICAgdmFyIGRhbmdsaW5nTXV0YXRpb25SZWZlcmVuY2VzID0gW107XHJcbiAgICAgICAgICAgIHJldHVybiBkb2N1bWVudE11dGF0aW9uc1N0b3JlKHR4bilcclxuICAgICAgICAgICAgICAgIC5pdGVyYXRlKHsgcmFuZ2U6IHN0YXJ0UmFuZ2UgfSwgZnVuY3Rpb24gKGtleSwgXywgY29udHJvbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJRCA9IGtleVswXTtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VySUQgIT09IF90aGlzLnVzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gZGVjb2RlJDEoa2V5WzFdKTtcclxuICAgICAgICAgICAgICAgICAgICBkYW5nbGluZ011dGF0aW9uUmVmZXJlbmNlcy5wdXNoKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGRhbmdsaW5nTXV0YXRpb25SZWZlcmVuY2VzLmxlbmd0aCA9PT0gMCwgJ0RvY3VtZW50IGxlYWsgLS0gZGV0ZWN0ZWQgZGFuZ2xpbmcgbXV0YXRpb24gcmVmZXJlbmNlcyB3aGVuIHF1ZXVlIGlzIGVtcHR5LiAnICtcclxuICAgICAgICAgICAgICAgICAgICAnRGFuZ2xpbmcga2V5czogJyArXHJcbiAgICAgICAgICAgICAgICAgICAgZGFuZ2xpbmdNdXRhdGlvblJlZmVyZW5jZXMubWFwKGZ1bmN0aW9uIChwKSB7IHJldHVybiBwLmNhbm9uaWNhbFN0cmluZygpOyB9KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmNvbnRhaW5zS2V5ID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9uUXVldWVDb250YWluc0tleSh0eG4sIHRoaXMudXNlcklkLCBrZXkpO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkgKHN0YXRlIGlzIGhlbGQgaW4gbWVtb3J5IGluIG90aGVyIGNsaWVudHMpLlxyXG4gICAgLyoqIFJldHVybnMgdGhlIG11dGF0aW9uIHF1ZXVlJ3MgbWV0YWRhdGEgZnJvbSBJbmRleGVkRGIuICovXHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRNdXRhdGlvblF1ZXVlTWV0YWRhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBtdXRhdGlvblF1ZXVlc1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuZ2V0KHRoaXMudXNlcklkKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChtZXRhZGF0YSB8fFxyXG4gICAgICAgICAgICAgICAgbmV3IERiTXV0YXRpb25RdWV1ZShfdGhpcy51c2VySWQsIEJBVENISURfVU5LTk9XTiwgXHJcbiAgICAgICAgICAgICAgICAvKmxhc3RTdHJlYW1Ub2tlbj0qLyAnJykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBJbmRleGVkRGJNdXRhdGlvblF1ZXVlO1xyXG59KCkpO1xyXG4vKipcclxuICogQHJldHVybiB0cnVlIGlmIHRoZSBtdXRhdGlvbiBxdWV1ZSBmb3IgdGhlIGdpdmVuIHVzZXIgY29udGFpbnMgYSBwZW5kaW5nXHJcbiAqICAgICAgICAgbXV0YXRpb24gZm9yIHRoZSBnaXZlbiBrZXkuXHJcbiAqL1xyXG5mdW5jdGlvbiBtdXRhdGlvblF1ZXVlQ29udGFpbnNLZXkodHhuLCB1c2VySWQsIGtleSkge1xyXG4gICAgdmFyIGluZGV4S2V5ID0gRGJEb2N1bWVudE11dGF0aW9uLnByZWZpeEZvclBhdGgodXNlcklkLCBrZXkucGF0aCk7XHJcbiAgICB2YXIgZW5jb2RlZFBhdGggPSBpbmRleEtleVsxXTtcclxuICAgIHZhciBzdGFydFJhbmdlID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChpbmRleEtleSk7XHJcbiAgICB2YXIgY29udGFpbnNLZXkgPSBmYWxzZTtcclxuICAgIHJldHVybiBkb2N1bWVudE11dGF0aW9uc1N0b3JlKHR4bilcclxuICAgICAgICAuaXRlcmF0ZSh7IHJhbmdlOiBzdGFydFJhbmdlLCBrZXlzT25seTogdHJ1ZSB9LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29udHJvbCkge1xyXG4gICAgICAgIHZhciB1c2VySUQgPSBrZXlbMF0sIGtleVBhdGggPSBrZXlbMV0sIC8qYmF0Y2hJRCovIF8gPSBrZXlbMl07XHJcbiAgICAgICAgaWYgKHVzZXJJRCA9PT0gdXNlcklkICYmIGtleVBhdGggPT09IGVuY29kZWRQYXRoKSB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5zS2V5ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICB9KVxyXG4gICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNvbnRhaW5zS2V5OyB9KTtcclxufVxyXG4vKiogUmV0dXJucyB0cnVlIGlmIGFueSBtdXRhdGlvbiBxdWV1ZSBjb250YWlucyB0aGUgZ2l2ZW4gZG9jdW1lbnQuICovXHJcbmZ1bmN0aW9uIG11dGF0aW9uUXVldWVzQ29udGFpbktleSh0eG4sIGRvY0tleSkge1xyXG4gICAgdmFyIGZvdW5kID0gZmFsc2U7XHJcbiAgICByZXR1cm4gbXV0YXRpb25RdWV1ZXNTdG9yZSh0eG4pXHJcbiAgICAgICAgLml0ZXJhdGVTZXJpYWwoZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIHJldHVybiBtdXRhdGlvblF1ZXVlQ29udGFpbnNLZXkodHhuLCB1c2VySWQsIGRvY0tleSkubmV4dChmdW5jdGlvbiAoY29udGFpbnNLZXkpIHtcclxuICAgICAgICAgICAgaWYgKGNvbnRhaW5zS2V5KSB7XHJcbiAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCFjb250YWluc0tleSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KVxyXG4gICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZvdW5kOyB9KTtcclxufVxyXG4vKipcclxuICogRGVsZXRlIGEgbXV0YXRpb24gYmF0Y2ggYW5kIHRoZSBhc3NvY2lhdGVkIGRvY3VtZW50IG11dGF0aW9ucy5cclxuICogQHJldHVybiBBIFBlcnNpc3RlbmNlUHJvbWlzZSBvZiB0aGUgZG9jdW1lbnQgbXV0YXRpb25zIHRoYXQgd2VyZSByZW1vdmVkLlxyXG4gKi9cclxuZnVuY3Rpb24gcmVtb3ZlTXV0YXRpb25CYXRjaCh0eG4sIHVzZXJJZCwgYmF0Y2gpIHtcclxuICAgIHZhciBtdXRhdGlvblN0b3JlID0gdHhuLnN0b3JlKERiTXV0YXRpb25CYXRjaC5zdG9yZSk7XHJcbiAgICB2YXIgaW5kZXhUeG4gPSB0eG4uc3RvcmUoRGJEb2N1bWVudE11dGF0aW9uLnN0b3JlKTtcclxuICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2Uub25seShiYXRjaC5iYXRjaElkKTtcclxuICAgIHZhciBudW1EZWxldGVkID0gMDtcclxuICAgIHZhciByZW1vdmVQcm9taXNlID0gbXV0YXRpb25TdG9yZS5pdGVyYXRlKHsgcmFuZ2U6IHJhbmdlIH0sIGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb250cm9sKSB7XHJcbiAgICAgICAgbnVtRGVsZXRlZCsrO1xyXG4gICAgICAgIHJldHVybiBjb250cm9sLmRlbGV0ZSgpO1xyXG4gICAgfSk7XHJcbiAgICBwcm9taXNlcy5wdXNoKHJlbW92ZVByb21pc2UubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KG51bURlbGV0ZWQgPT09IDEsICdEYW5nbGluZyBkb2N1bWVudC1tdXRhdGlvbiByZWZlcmVuY2UgZm91bmQ6IE1pc3NpbmcgYmF0Y2ggJyArXHJcbiAgICAgICAgICAgIGJhdGNoLmJhdGNoSWQpO1xyXG4gICAgfSkpO1xyXG4gICAgdmFyIHJlbW92ZWREb2N1bWVudHMgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBiYXRjaC5tdXRhdGlvbnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uID0gX2FbX2ldO1xyXG4gICAgICAgIHZhciBpbmRleEtleSA9IERiRG9jdW1lbnRNdXRhdGlvbi5rZXkodXNlcklkLCBtdXRhdGlvbi5rZXkucGF0aCwgYmF0Y2guYmF0Y2hJZCk7XHJcbiAgICAgICAgcHJvbWlzZXMucHVzaChpbmRleFR4bi5kZWxldGUoaW5kZXhLZXkpKTtcclxuICAgICAgICByZW1vdmVkRG9jdW1lbnRzLnB1c2gobXV0YXRpb24ua2V5KTtcclxuICAgIH1cclxuICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcykubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiByZW1vdmVkRG9jdW1lbnRzOyB9KTtcclxufVxyXG5mdW5jdGlvbiBjb252ZXJ0U3RyZWFtVG9rZW4odG9rZW4pIHtcclxuICAgIGlmICh0b2tlbiBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcclxuICAgICAgICAvLyBUT0RPKGIvNzg3NzE0MDMpOiBDb252ZXJ0IHRva2VucyB0byBzdHJpbmdzIGR1cmluZyBkZXNlcmlhbGl6YXRpb25cclxuICAgICAgICBhc3NlcnQocHJvY2Vzcy5lbnYuVVNFX01PQ0tfUEVSU0lTVEVOQ0UgPT09ICdZRVMnLCAnUGVyc2lzdGluZyBub24tc3RyaW5nIHN0cmVhbSB0b2tlbnMgaXMgb25seSBzdXBwb3J0ZWQgd2l0aCBtb2NrIHBlcnNpc3RlbmNlLicpO1xyXG4gICAgICAgIHJldHVybiB0b2tlbi50b1N0cmluZygpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRva2VuO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG11dGF0aW9ucyBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiBtdXRhdGlvbnNTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiTXV0YXRpb25CYXRjaC5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25RdWV1ZXMgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gZG9jdW1lbnRNdXRhdGlvbnNTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiRG9jdW1lbnRNdXRhdGlvbi5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25RdWV1ZXMgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gbXV0YXRpb25RdWV1ZXNTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiTXV0YXRpb25RdWV1ZS5zdG9yZSk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBSRVNFUlZFRF9CSVRTID0gMTtcclxudmFyIEdlbmVyYXRvcklkcztcclxuKGZ1bmN0aW9uIChHZW5lcmF0b3JJZHMpIHtcclxuICAgIEdlbmVyYXRvcklkc1tHZW5lcmF0b3JJZHNbXCJRdWVyeUNhY2hlXCJdID0gMF0gPSBcIlF1ZXJ5Q2FjaGVcIjtcclxuICAgIEdlbmVyYXRvcklkc1tHZW5lcmF0b3JJZHNbXCJTeW5jRW5naW5lXCJdID0gMV0gPSBcIlN5bmNFbmdpbmVcIjsgLy8gVGhlIHRhcmdldCBJRHMgZm9yIGxpbWJvIGRldGVjdGlvbiBhcmUgb2RkIChlbmQgaW4gMSkuXHJcbn0pKEdlbmVyYXRvcklkcyB8fCAoR2VuZXJhdG9ySWRzID0ge30pKTtcclxuLyoqXHJcbiAqIEdlbmVyYXRlcyBtb25vdG9uaWNhbGx5IGluY3JlYXNpbmcgdGFyZ2V0IElEcyBmb3Igc2VuZGluZyB0YXJnZXRzIHRvIHRoZVxyXG4gKiB3YXRjaCBzdHJlYW0uXHJcbiAqXHJcbiAqIFRoZSBjbGllbnQgY29uc3RydWN0cyB0d28gZ2VuZXJhdG9ycywgb25lIGZvciB0aGUgcXVlcnkgY2FjaGUgKHZpYVxyXG4gKiBmb3JRdWVyeUNhY2hlKCkpLCBhbmQgb25lIGZvciBsaW1ibyBkb2N1bWVudHMgKHZpYSBmb3JTeW5jRW5naW5lKCkpLiBUaGVzZVxyXG4gKiB0d28gZ2VuZXJhdG9ycyBwcm9kdWNlIG5vbi1vdmVybGFwcGluZyBJRHMgKGJ5IHVzaW5nIGV2ZW4gYW5kIG9kZCBJRHNcclxuICogcmVzcGVjdGl2ZWx5KS5cclxuICpcclxuICogQnkgc2VwYXJhdGluZyB0aGUgdGFyZ2V0IElEIHNwYWNlLCB0aGUgcXVlcnkgY2FjaGUgY2FuIGdlbmVyYXRlIHRhcmdldCBJRHNcclxuICogdGhhdCBwZXJzaXN0IGFjcm9zcyBjbGllbnQgcmVzdGFydHMsIHdoaWxlIHN5bmMgZW5naW5lIGNhbiBpbmRlcGVuZGVudGx5XHJcbiAqIGdlbmVyYXRlIGluLW1lbW9yeSB0YXJnZXQgSURzIHRoYXQgYXJlIHRyYW5zaWVudCBhbmQgY2FuIGJlIHJldXNlZCBhZnRlciBhXHJcbiAqIHJlc3RhcnQuXHJcbiAqL1xyXG4vLyBUT0RPKG1yc2NobWlkdCk6IEV4cGxvcmUgcmVtb3ZpbmcgdGhpcyBjbGFzcyBpbiBmYXZvciBvZiBnZW5lcmF0aW5nIHRoZXNlIElEc1xyXG4vLyBkaXJlY3RseSBpbiBTeW5jRW5naW5lIGFuZCBMb2NhbFN0b3JlLlxyXG52YXIgVGFyZ2V0SWRHZW5lcmF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIEluc3RhbnRpYXRlcyBhIG5ldyBUYXJnZXRJZEdlbmVyYXRvci4gSWYgYSBzZWVkIGlzIHByb3ZpZGVkLCB0aGUgZ2VuZXJhdG9yXHJcbiAgICAgKiB3aWxsIHVzZSB0aGUgc2VlZCB2YWx1ZSBhcyB0aGUgbmV4dCB0YXJnZXQgSUQuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIFRhcmdldElkR2VuZXJhdG9yKGdlbmVyYXRvcklkLCBzZWVkKSB7XHJcbiAgICAgICAgdGhpcy5nZW5lcmF0b3JJZCA9IGdlbmVyYXRvcklkO1xyXG4gICAgICAgIGFzc2VydCgoZ2VuZXJhdG9ySWQgJiBSRVNFUlZFRF9CSVRTKSA9PT0gZ2VuZXJhdG9ySWQsIFwiR2VuZXJhdG9yIElEIFwiICsgZ2VuZXJhdG9ySWQgKyBcIiBjb250YWlucyBtb3JlIHRoYW4gXCIgKyBSRVNFUlZFRF9CSVRTICsgXCIgcmVzZXJ2ZWQgYml0c1wiKTtcclxuICAgICAgICB0aGlzLnNlZWsoc2VlZCAhPT0gdW5kZWZpbmVkID8gc2VlZCA6IHRoaXMuZ2VuZXJhdG9ySWQpO1xyXG4gICAgfVxyXG4gICAgVGFyZ2V0SWRHZW5lcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG5leHRJZCA9IHRoaXMubmV4dElkO1xyXG4gICAgICAgIHRoaXMubmV4dElkICs9IDEgPDwgUkVTRVJWRURfQklUUztcclxuICAgICAgICByZXR1cm4gbmV4dElkO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgSUQgdGhhdCBmb2xsb3dzIHRoZSBnaXZlbiBJRC4gU3Vic2VxdWVudCBjYWxscyB0byBgbmV4dCgpYFxyXG4gICAgICogdXNlIHRoZSBuZXdseSByZXR1cm5lZCB0YXJnZXQgSUQgYXMgdGhlaXIgYmFzZS5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIFRhcmdldElkR2VuZXJhdG9yLnByb3RvdHlwZS5hZnRlciA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMuc2Vlayh0YXJnZXRJZCArICgxIDw8IFJFU0VSVkVEX0JJVFMpKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5uZXh0KCk7XHJcbiAgICB9O1xyXG4gICAgVGFyZ2V0SWRHZW5lcmF0b3IucHJvdG90eXBlLnNlZWsgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICBhc3NlcnQoKHRhcmdldElkICYgUkVTRVJWRURfQklUUykgPT09IHRoaXMuZ2VuZXJhdG9ySWQsICdDYW5ub3Qgc3VwcGx5IHRhcmdldCBJRCBmcm9tIGRpZmZlcmVudCBnZW5lcmF0b3IgSUQnKTtcclxuICAgICAgICB0aGlzLm5leHRJZCA9IHRhcmdldElkO1xyXG4gICAgfTtcclxuICAgIFRhcmdldElkR2VuZXJhdG9yLmZvclF1ZXJ5Q2FjaGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gV2Ugc2VlZCB0aGUgcXVlcnkgY2FjaGUgZ2VuZXJhdG9yIHRvIHJldHVybiAnMicgYXMgaXRzIGZpcnN0IElELCBhcyB0aGVyZVxyXG4gICAgICAgIC8vIGlzIG5vIGRpZmZlcmVudGlhdGlvbiBpbiB0aGUgcHJvdG9jb2wgbGF5ZXIgYmV0d2VlbiBhbiB1bnNldCBudW1iZXIgYW5kXHJcbiAgICAgICAgLy8gdGhlIG51bWJlciAnMCcuIElmIHdlIHdlcmUgdG8gc2VudCBhIHRhcmdldCB3aXRoIHRhcmdldCBJRCAnMCcsIHRoZVxyXG4gICAgICAgIC8vIGJhY2tlbmQgd291bGQgY29uc2lkZXIgaXQgdW5zZXQgYW5kIHJlcGxhY2UgaXQgd2l0aCBpdHMgb3duIElELlxyXG4gICAgICAgIHZhciB0YXJnZXRJZEdlbmVyYXRvciA9IG5ldyBUYXJnZXRJZEdlbmVyYXRvcihHZW5lcmF0b3JJZHMuUXVlcnlDYWNoZSwgMik7XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldElkR2VuZXJhdG9yO1xyXG4gICAgfTtcclxuICAgIFRhcmdldElkR2VuZXJhdG9yLmZvclN5bmNFbmdpbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gU3luYyBlbmdpbmUgYXNzaWducyB0YXJnZXQgSURzIGZvciBsaW1ibyBkb2N1bWVudCBkZXRlY3Rpb24uXHJcbiAgICAgICAgcmV0dXJuIG5ldyBUYXJnZXRJZEdlbmVyYXRvcihHZW5lcmF0b3JJZHMuU3luY0VuZ2luZSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRhcmdldElkR2VuZXJhdG9yO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIEluZGV4ZWREYlF1ZXJ5Q2FjaGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBJbmRleGVkRGJRdWVyeUNhY2hlKHJlZmVyZW5jZURlbGVnYXRlLCBzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHJlZmVyZW5jZURlbGVnYXRlO1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBXZSBkb24ndCBjYWNoZSBnbG9iYWwgbWV0YWRhdGEgZm9yIHRoZSBxdWVyeSBjYWNoZSwgc2luY2VcclxuICAgICAgICAvLyBzb21lIG9mIGl0IChpbiBwYXJ0aWN1bGFyIGBoaWdoZXN0VGFyZ2V0SWRgKSBjYW4gYmUgbW9kaWZpZWQgYnkgc2Vjb25kYXJ5XHJcbiAgICAgICAgLy8gdGFicy4gV2UgY291bGQgcGVyaGFwcyBiZSBtb3JlIGdyYW51bGFyIChhbmQgZS5nLiBzdGlsbCBjYWNoZVxyXG4gICAgICAgIC8vIGBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uYCBpbiBtZW1vcnkpIGJ1dCBmb3Igc2ltcGxpY2l0eSB3ZSBjdXJyZW50bHkgZ29cclxuICAgICAgICAvLyB0byBJbmRleGVkRGIgd2hlbmV2ZXIgd2UgbmVlZCB0byByZWFkIG1ldGFkYXRhLiBXZSBjYW4gcmV2aXNpdCBpZiBpdCB0dXJuc1xyXG4gICAgICAgIC8vIG91dCB0byBoYXZlIGEgbWVhbmluZ2Z1bCBwZXJmb3JtYW5jZSBpbXBhY3QuXHJcbiAgICAgICAgdGhpcy50YXJnZXRJZEdlbmVyYXRvciA9IFRhcmdldElkR2VuZXJhdG9yLmZvclF1ZXJ5Q2FjaGUoKTtcclxuICAgIH1cclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmFsbG9jYXRlVGFyZ2V0SWQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJldHJpZXZlTWV0YWRhdGEodHJhbnNhY3Rpb24pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLmhpZ2hlc3RUYXJnZXRJZCA9IF90aGlzLnRhcmdldElkR2VuZXJhdG9yLmFmdGVyKG1ldGFkYXRhLmhpZ2hlc3RUYXJnZXRJZCk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zYXZlTWV0YWRhdGEodHJhbnNhY3Rpb24sIG1ldGFkYXRhKS5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG1ldGFkYXRhLmhpZ2hlc3RUYXJnZXRJZDsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJldHJpZXZlTWV0YWRhdGEodHJhbnNhY3Rpb24pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTbmFwc2hvdFZlcnNpb24uZnJvbVRpbWVzdGFtcChuZXcgVGltZXN0YW1wKG1ldGFkYXRhLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24uc2Vjb25kcywgbWV0YWRhdGEubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbi5uYW5vc2Vjb25kcykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldEhpZ2hlc3RTZXF1ZW5jZU51bWJlciA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBnZXRIaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIodHJhbnNhY3Rpb24uc2ltcGxlRGJUcmFuc2FjdGlvbik7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuc2V0VGFyZ2V0c01ldGFkYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIsIGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJldHJpZXZlTWV0YWRhdGEodHJhbnNhY3Rpb24pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICAgICAgaWYgKGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uLnRvVGltZXN0YW1wKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA+IG1ldGFkYXRhLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgbWV0YWRhdGEuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID0gaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zYXZlTWV0YWRhdGEodHJhbnNhY3Rpb24sIG1ldGFkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5hZGRRdWVyeURhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZVF1ZXJ5RGF0YSh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhKS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJldHJpZXZlTWV0YWRhdGEodHJhbnNhY3Rpb24pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBtZXRhZGF0YS50YXJnZXRDb3VudCArPSAxO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlTWV0YWRhdGFGcm9tUXVlcnlEYXRhKHF1ZXJ5RGF0YSwgbWV0YWRhdGEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNhdmVNZXRhZGF0YSh0cmFuc2FjdGlvbiwgbWV0YWRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS51cGRhdGVRdWVyeURhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNhdmVRdWVyeURhdGEodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUucmVtb3ZlUXVlcnlEYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEudGFyZ2V0SWQpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRhcmdldHNTdG9yZSh0cmFuc2FjdGlvbikuZGVsZXRlKHF1ZXJ5RGF0YS50YXJnZXRJZCk7IH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnJldHJpZXZlTWV0YWRhdGEodHJhbnNhY3Rpb24pOyB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KG1ldGFkYXRhLnRhcmdldENvdW50ID4gMCwgJ1JlbW92aW5nIGZyb20gYW4gZW1wdHkgcXVlcnkgY2FjaGUnKTtcclxuICAgICAgICAgICAgbWV0YWRhdGEudGFyZ2V0Q291bnQgLT0gMTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNhdmVNZXRhZGF0YSh0cmFuc2FjdGlvbiwgbWV0YWRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogRHJvcHMgYW55IHRhcmdldHMgd2l0aCBzZXF1ZW5jZSBudW1iZXIgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSB1cHBlciBib3VuZCwgZXhjZXB0aW5nIHRob3NlXHJcbiAgICAgKiBwcmVzZW50IGluIGBhY3RpdmVUYXJnZXRJZHNgLiBEb2N1bWVudCBhc3NvY2lhdGlvbnMgZm9yIHRoZSByZW1vdmVkIHRhcmdldHMgYXJlIGFsc28gcmVtb3ZlZC5cclxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiB0YXJnZXRzIHJlbW92ZWQuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnJlbW92ZVRhcmdldHMgPSBmdW5jdGlvbiAodHhuLCB1cHBlckJvdW5kLCBhY3RpdmVUYXJnZXRJZHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldHNTdG9yZSh0eG4pXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeURhdGEgPSBfdGhpcy5zZXJpYWxpemVyLmZyb21EYlRhcmdldCh2YWx1ZSk7XHJcbiAgICAgICAgICAgIGlmIChxdWVyeURhdGEuc2VxdWVuY2VOdW1iZXIgPD0gdXBwZXJCb3VuZCAmJlxyXG4gICAgICAgICAgICAgICAgYWN0aXZlVGFyZ2V0SWRzW3F1ZXJ5RGF0YS50YXJnZXRJZF0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goX3RoaXMucmVtb3ZlUXVlcnlEYXRhKHR4biwgcXVlcnlEYXRhKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcyk7IH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNvdW50OyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENhbGwgcHJvdmlkZWQgZnVuY3Rpb24gd2l0aCBlYWNoIGBRdWVyeURhdGFgIHRoYXQgd2UgaGF2ZSBjYWNoZWQuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmZvckVhY2hUYXJnZXQgPSBmdW5jdGlvbiAodHhuLCBmKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGFyZ2V0c1N0b3JlKHR4bikuaXRlcmF0ZShmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnlEYXRhID0gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJUYXJnZXQodmFsdWUpO1xyXG4gICAgICAgICAgICBmKHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUucmV0cmlldmVNZXRhZGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiByZXRyaWV2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uLnNpbXBsZURiVHJhbnNhY3Rpb24pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnNhdmVNZXRhZGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgbWV0YWRhdGEpIHtcclxuICAgICAgICByZXR1cm4gZ2xvYmFsVGFyZ2V0U3RvcmUodHJhbnNhY3Rpb24pLnB1dChEYlRhcmdldEdsb2JhbC5rZXksIG1ldGFkYXRhKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5zYXZlUXVlcnlEYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEpIHtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0c1N0b3JlKHRyYW5zYWN0aW9uKS5wdXQodGhpcy5zZXJpYWxpemVyLnRvRGJUYXJnZXQocXVlcnlEYXRhKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbi1wbGFjZSB1cGRhdGVzIHRoZSBwcm92aWRlZCBtZXRhZGF0YSB0byBhY2NvdW50IGZvciB2YWx1ZXMgaW4gdGhlIGdpdmVuXHJcbiAgICAgKiBRdWVyeURhdGEuIFNhdmluZyBpcyBkb25lIHNlcGFyYXRlbHkuIFJldHVybnMgdHJ1ZSBpZiB0aGVyZSB3ZXJlIGFueVxyXG4gICAgICogY2hhbmdlcyB0byB0aGUgbWV0YWRhdGEuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnVwZGF0ZU1ldGFkYXRhRnJvbVF1ZXJ5RGF0YSA9IGZ1bmN0aW9uIChxdWVyeURhdGEsIG1ldGFkYXRhKSB7XHJcbiAgICAgICAgdmFyIHVwZGF0ZWQgPSBmYWxzZTtcclxuICAgICAgICBpZiAocXVlcnlEYXRhLnRhcmdldElkID4gbWV0YWRhdGEuaGlnaGVzdFRhcmdldElkKSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLmhpZ2hlc3RUYXJnZXRJZCA9IHF1ZXJ5RGF0YS50YXJnZXRJZDtcclxuICAgICAgICAgICAgdXBkYXRlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChxdWVyeURhdGEuc2VxdWVuY2VOdW1iZXIgPiBtZXRhZGF0YS5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgbWV0YWRhdGEuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID0gcXVlcnlEYXRhLnNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgICAgICB1cGRhdGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0UXVlcnlDb3VudCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJldHJpZXZlTWV0YWRhdGEodHJhbnNhY3Rpb24pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7IHJldHVybiBtZXRhZGF0YS50YXJnZXRDb3VudDsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0UXVlcnlEYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gSXRlcmF0aW5nIGJ5IHRoZSBjYW5vbmljYWxJZCBtYXkgeWllbGQgbW9yZSB0aGFuIG9uZSByZXN1bHQgYmVjYXVzZVxyXG4gICAgICAgIC8vIGNhbm9uaWNhbElkIHZhbHVlcyBhcmUgbm90IHJlcXVpcmVkIHRvIGJlIHVuaXF1ZSBwZXIgdGFyZ2V0LiBUaGlzIHF1ZXJ5XHJcbiAgICAgICAgLy8gZGVwZW5kcyBvbiB0aGUgcXVlcnlUYXJnZXRzIGluZGV4IHRvIGJlIGVmZmljaWVudC5cclxuICAgICAgICB2YXIgY2Fub25pY2FsSWQgPSBxdWVyeS5jYW5vbmljYWxJZCgpO1xyXG4gICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmJvdW5kKFtjYW5vbmljYWxJZCwgTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZXSwgW2Nhbm9uaWNhbElkLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFldKTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0c1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuaXRlcmF0ZSh7IHJhbmdlOiByYW5nZSwgaW5kZXg6IERiVGFyZ2V0LnF1ZXJ5VGFyZ2V0c0luZGV4TmFtZSB9LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29udHJvbCkge1xyXG4gICAgICAgICAgICB2YXIgZm91bmQgPSBfdGhpcy5zZXJpYWxpemVyLmZyb21EYlRhcmdldCh2YWx1ZSk7XHJcbiAgICAgICAgICAgIC8vIEFmdGVyIGZpbmRpbmcgYSBwb3RlbnRpYWwgbWF0Y2gsIGNoZWNrIHRoYXQgdGhlIHF1ZXJ5IGlzXHJcbiAgICAgICAgICAgIC8vIGFjdHVhbGx5IGVxdWFsIHRvIHRoZSByZXF1ZXN0ZWQgcXVlcnkuXHJcbiAgICAgICAgICAgIGlmIChxdWVyeS5pc0VxdWFsKGZvdW5kLnF1ZXJ5KSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gZm91bmQ7XHJcbiAgICAgICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlc3VsdDsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuYWRkTWF0Y2hpbmdLZXlzID0gZnVuY3Rpb24gKHR4biwga2V5cywgdGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcclxuICAgICAgICAvLyBJbmRleGVkRGIuXHJcbiAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgdmFyIHN0b3JlID0gZG9jdW1lbnRUYXJnZXRTdG9yZSh0eG4pO1xyXG4gICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gZW5jb2RlKGtleS5wYXRoKTtcclxuICAgICAgICAgICAgcHJvbWlzZXMucHVzaChzdG9yZS5wdXQobmV3IERiVGFyZ2V0RG9jdW1lbnQodGFyZ2V0SWQsIHBhdGgpKSk7XHJcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2goX3RoaXMucmVmZXJlbmNlRGVsZWdhdGUuYWRkUmVmZXJlbmNlKHR4biwga2V5KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5yZW1vdmVNYXRjaGluZ0tleXMgPSBmdW5jdGlvbiAodHhuLCBrZXlzLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBUaGUgcmV2ZXJzZSBpbmRleCAoZG9jdW1lbnRzVGFyZ2V0cykgaXMgbWFpbnRhaW5lZCBieVxyXG4gICAgICAgIC8vIEluZGV4ZWREYi5cclxuICAgICAgICB2YXIgc3RvcmUgPSBkb2N1bWVudFRhcmdldFN0b3JlKHR4bik7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKGtleXMsIGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBlbmNvZGUoa2V5LnBhdGgpO1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IoW1xyXG4gICAgICAgICAgICAgICAgc3RvcmUuZGVsZXRlKFt0YXJnZXRJZCwgcGF0aF0pLFxyXG4gICAgICAgICAgICAgICAgX3RoaXMucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlUmVmZXJlbmNlKHR4biwga2V5KVxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCA9IGZ1bmN0aW9uICh0eG4sIHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gZG9jdW1lbnRUYXJnZXRTdG9yZSh0eG4pO1xyXG4gICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmJvdW5kKFt0YXJnZXRJZF0sIFt0YXJnZXRJZCArIDFdLCBcclxuICAgICAgICAvKmxvd2VyT3Blbj0qLyBmYWxzZSwgXHJcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gdHJ1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlLmRlbGV0ZShyYW5nZSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQgPSBmdW5jdGlvbiAodHhuLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmJvdW5kKFt0YXJnZXRJZF0sIFt0YXJnZXRJZCArIDFdLCBcclxuICAgICAgICAvKmxvd2VyT3Blbj0qLyBmYWxzZSwgXHJcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gdHJ1ZSk7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gZG9jdW1lbnRUYXJnZXRTdG9yZSh0eG4pO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHJldHVybiBzdG9yZVxyXG4gICAgICAgICAgICAuaXRlcmF0ZSh7IHJhbmdlOiByYW5nZSwga2V5c09ubHk6IHRydWUgfSwgZnVuY3Rpb24gKGtleSwgXywgY29udHJvbCkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IGRlY29kZSQxKGtleVsxXSk7XHJcbiAgICAgICAgICAgIHZhciBkb2NLZXkgPSBuZXcgRG9jdW1lbnRLZXkocGF0aCk7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5hZGQoZG9jS2V5KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiByZXN1bHQ7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmNvbnRhaW5zS2V5ID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSBlbmNvZGUoa2V5LnBhdGgpO1xyXG4gICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmJvdW5kKFtwYXRoXSwgW2ltbWVkaWF0ZVN1Y2Nlc3NvcihwYXRoKV0sIFxyXG4gICAgICAgIC8qbG93ZXJPcGVuPSovIGZhbHNlLCBcclxuICAgICAgICAvKnVwcGVyT3Blbj0qLyB0cnVlKTtcclxuICAgICAgICB2YXIgY291bnQgPSAwO1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudFRhcmdldFN0b3JlKHR4bilcclxuICAgICAgICAgICAgLml0ZXJhdGUoe1xyXG4gICAgICAgICAgICBpbmRleDogRGJUYXJnZXREb2N1bWVudC5kb2N1bWVudFRhcmdldHNJbmRleCxcclxuICAgICAgICAgICAga2V5c09ubHk6IHRydWUsXHJcbiAgICAgICAgICAgIHJhbmdlOiByYW5nZVxyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChfYSwgXywgY29udHJvbCkge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBfYVswXSwgcGF0aCA9IF9hWzFdO1xyXG4gICAgICAgICAgICAvLyBIYXZpbmcgYSBzZW50aW5lbCByb3cgZm9yIGEgZG9jdW1lbnQgZG9lcyBub3QgY291bnQgYXMgY29udGFpbmluZyB0aGF0IGRvY3VtZW50O1xyXG4gICAgICAgICAgICAvLyBGb3IgdGhlIHF1ZXJ5IGNhY2hlLCBjb250YWluaW5nIHRoZSBkb2N1bWVudCBtZWFucyB0aGUgZG9jdW1lbnQgaXMgcGFydCBvZiBzb21lXHJcbiAgICAgICAgICAgIC8vIHRhcmdldC5cclxuICAgICAgICAgICAgaWYgKHRhcmdldElkICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBjb3VudCA+IDA7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldFF1ZXJ5RGF0YUZvclRhcmdldCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgdGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRzU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5nZXQodGFyZ2V0SWQpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChmb3VuZCkge1xyXG4gICAgICAgICAgICBpZiAoZm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zZXJpYWxpemVyLmZyb21EYlRhcmdldChmb3VuZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBJbmRleGVkRGJRdWVyeUNhY2hlO1xyXG59KCkpO1xyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBxdWVyaWVzIG9iamVjdCBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIHRhcmdldHNTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiVGFyZ2V0LnN0b3JlKTtcclxufVxyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSB0YXJnZXQgZ2xvYmFscyBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiBnbG9iYWxUYXJnZXRTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiVGFyZ2V0R2xvYmFsLnN0b3JlKTtcclxufVxyXG5mdW5jdGlvbiByZXRyaWV2ZU1ldGFkYXRhKHR4bikge1xyXG4gICAgdmFyIGdsb2JhbFN0b3JlID0gU2ltcGxlRGIuZ2V0U3RvcmUodHhuLCBEYlRhcmdldEdsb2JhbC5zdG9yZSk7XHJcbiAgICByZXR1cm4gZ2xvYmFsU3RvcmUuZ2V0KERiVGFyZ2V0R2xvYmFsLmtleSkubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICBhc3NlcnQobWV0YWRhdGEgIT09IG51bGwsICdNaXNzaW5nIG1ldGFkYXRhIHJvdy4nKTtcclxuICAgICAgICByZXR1cm4gbWV0YWRhdGE7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBnZXRIaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIodHhuKSB7XHJcbiAgICByZXR1cm4gcmV0cmlldmVNZXRhZGF0YSh0eG4pLm5leHQoZnVuY3Rpb24gKHRhcmdldEdsb2JhbCkgeyByZXR1cm4gdGFyZ2V0R2xvYmFsLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcjsgfSk7XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgZG9jdW1lbnQgdGFyZ2V0IG9iamVjdCBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIGRvY3VtZW50VGFyZ2V0U3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYlRhcmdldERvY3VtZW50LnN0b3JlKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqIFNlcmlhbGl6ZXIgZm9yIHZhbHVlcyBzdG9yZWQgaW4gdGhlIExvY2FsU3RvcmUuICovXHJcbnZhciBMb2NhbFNlcmlhbGl6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMb2NhbFNlcmlhbGl6ZXIocmVtb3RlU2VyaWFsaXplcikge1xyXG4gICAgICAgIHRoaXMucmVtb3RlU2VyaWFsaXplciA9IHJlbW90ZVNlcmlhbGl6ZXI7XHJcbiAgICB9XHJcbiAgICAvKiogRGVjb2RlcyBhIHJlbW90ZSBkb2N1bWVudCBmcm9tIHN0b3JhZ2UgbG9jYWxseSB0byBhIERvY3VtZW50LiAqL1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRGJSZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChyZW1vdGVEb2MpIHtcclxuICAgICAgICBpZiAocmVtb3RlRG9jLmRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW90ZVNlcmlhbGl6ZXIuZnJvbURvY3VtZW50KHJlbW90ZURvYy5kb2N1bWVudCwgISFyZW1vdGVEb2MuaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocmVtb3RlRG9jLm5vRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIGtleSA9IERvY3VtZW50S2V5LmZyb21TZWdtZW50cyhyZW1vdGVEb2Mubm9Eb2N1bWVudC5wYXRoKTtcclxuICAgICAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLmZyb21EYlRpbWVzdGFtcChyZW1vdGVEb2Mubm9Eb2N1bWVudC5yZWFkVGltZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgTm9Eb2N1bWVudChrZXksIHZlcnNpb24sIHtcclxuICAgICAgICAgICAgICAgIGhhc0NvbW1pdHRlZE11dGF0aW9uczogISFyZW1vdGVEb2MuaGFzQ29tbWl0dGVkTXV0YXRpb25zXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChyZW1vdGVEb2MudW5rbm93bkRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBEb2N1bWVudEtleS5mcm9tU2VnbWVudHMocmVtb3RlRG9jLnVua25vd25Eb2N1bWVudC5wYXRoKTtcclxuICAgICAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLmZyb21EYlRpbWVzdGFtcChyZW1vdGVEb2MudW5rbm93bkRvY3VtZW50LnZlcnNpb24pO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFVua25vd25Eb2N1bWVudChrZXksIHZlcnNpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1VuZXhwZWN0ZWQgRGJSZW1vdGVEb2N1bWVudCcpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiogRW5jb2RlcyBhIGRvY3VtZW50IGZvciBzdG9yYWdlIGxvY2FsbHkuICovXHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLnRvRGJSZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgIGlmIChtYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBkb2MgPSB0aGlzLnJlbW90ZVNlcmlhbGl6ZXIudG9Eb2N1bWVudChtYXliZURvYyk7XHJcbiAgICAgICAgICAgIHZhciBoYXNDb21taXR0ZWRNdXRhdGlvbnMgPSBtYXliZURvYy5oYXNDb21taXR0ZWRNdXRhdGlvbnM7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGJSZW1vdGVEb2N1bWVudChcclxuICAgICAgICAgICAgLyogdW5rbm93bkRvY3VtZW50PSAqLyBudWxsLCBcclxuICAgICAgICAgICAgLyogbm9Eb2N1bWVudD0gKi8gbnVsbCwgZG9jLCBoYXNDb21taXR0ZWRNdXRhdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtYXliZURvYyBpbnN0YW5jZW9mIE5vRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBtYXliZURvYy5rZXkucGF0aC50b0FycmF5KCk7XHJcbiAgICAgICAgICAgIHZhciByZWFkVGltZSA9IHRoaXMudG9EYlRpbWVzdGFtcChtYXliZURvYy52ZXJzaW9uKTtcclxuICAgICAgICAgICAgdmFyIGhhc0NvbW1pdHRlZE11dGF0aW9ucyA9IG1heWJlRG9jLmhhc0NvbW1pdHRlZE11dGF0aW9ucztcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYlJlbW90ZURvY3VtZW50KFxyXG4gICAgICAgICAgICAvKiB1bmtub3duRG9jdW1lbnQ9ICovIG51bGwsIG5ldyBEYk5vRG9jdW1lbnQocGF0aCwgcmVhZFRpbWUpLCBcclxuICAgICAgICAgICAgLyogZG9jdW1lbnQ9ICovIG51bGwsIGhhc0NvbW1pdHRlZE11dGF0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG1heWJlRG9jIGluc3RhbmNlb2YgVW5rbm93bkRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gbWF5YmVEb2Mua2V5LnBhdGgudG9BcnJheSgpO1xyXG4gICAgICAgICAgICB2YXIgcmVhZFRpbWUgPSB0aGlzLnRvRGJUaW1lc3RhbXAobWF5YmVEb2MudmVyc2lvbik7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGJSZW1vdGVEb2N1bWVudChuZXcgRGJVbmtub3duRG9jdW1lbnQocGF0aCwgcmVhZFRpbWUpLCBcclxuICAgICAgICAgICAgLyogbm9Eb2N1bWVudD0gKi8gbnVsbCwgXHJcbiAgICAgICAgICAgIC8qIGRvY3VtZW50PSAqLyBudWxsLCBcclxuICAgICAgICAgICAgLyogaGFzQ29tbWl0dGVkTXV0YXRpb25zPSAqLyB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmV4cGVjdGVkIE1heWJlRG9jdW1tZW50Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUudG9EYlRpbWVzdGFtcCA9IGZ1bmN0aW9uIChzbmFwc2hvdFZlcnNpb24pIHtcclxuICAgICAgICB2YXIgdGltZXN0YW1wID0gc25hcHNob3RWZXJzaW9uLnRvVGltZXN0YW1wKCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYlRpbWVzdGFtcCh0aW1lc3RhbXAuc2Vjb25kcywgdGltZXN0YW1wLm5hbm9zZWNvbmRzKTtcclxuICAgIH07XHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21EYlRpbWVzdGFtcCA9IGZ1bmN0aW9uIChkYlRpbWVzdGFtcCkge1xyXG4gICAgICAgIHZhciB0aW1lc3RhbXAgPSBuZXcgVGltZXN0YW1wKGRiVGltZXN0YW1wLnNlY29uZHMsIGRiVGltZXN0YW1wLm5hbm9zZWNvbmRzKTtcclxuICAgICAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uLmZyb21UaW1lc3RhbXAodGltZXN0YW1wKTtcclxuICAgIH07XHJcbiAgICAvKiogRW5jb2RlcyBhIGJhdGNoIG9mIG11dGF0aW9ucyBpbnRvIGEgRGJNdXRhdGlvbkJhdGNoIGZvciBsb2NhbCBzdG9yYWdlLiAqL1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS50b0RiTXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uICh1c2VySWQsIGJhdGNoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgc2VyaWFsaXplZE11dGF0aW9ucyA9IGJhdGNoLm11dGF0aW9ucy5tYXAoZnVuY3Rpb24gKG0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW90ZVNlcmlhbGl6ZXIudG9NdXRhdGlvbihtKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbmV3IERiTXV0YXRpb25CYXRjaCh1c2VySWQsIGJhdGNoLmJhdGNoSWQsIGJhdGNoLmxvY2FsV3JpdGVUaW1lLnRvTWlsbGlzKCksIHNlcmlhbGl6ZWRNdXRhdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIC8qKiBEZWNvZGVzIGEgRGJNdXRhdGlvbkJhdGNoIGludG8gYSBNdXRhdGlvbkJhdGNoICovXHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21EYk11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAoZGJCYXRjaCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG11dGF0aW9ucyA9IGRiQmF0Y2gubXV0YXRpb25zLm1hcChmdW5jdGlvbiAobSkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucmVtb3RlU2VyaWFsaXplci5mcm9tTXV0YXRpb24obSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IFRpbWVzdGFtcC5mcm9tTWlsbGlzKGRiQmF0Y2gubG9jYWxXcml0ZVRpbWVNcyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNdXRhdGlvbkJhdGNoKGRiQmF0Y2guYmF0Y2hJZCwgdGltZXN0YW1wLCBtdXRhdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIC8qXHJcbiAgICAgKiBFbmNvZGVzIGEgc2V0IG9mIGRvY3VtZW50IGtleXMgaW50byBhbiBhcnJheSBvZiBFbmNvZGVkUmVzb3VyY2VQYXRocy5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS50b0RiUmVzb3VyY2VQYXRocyA9IGZ1bmN0aW9uIChrZXlzKSB7XHJcbiAgICAgICAgdmFyIGVuY29kZWRLZXlzID0gW107XHJcbiAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgZW5jb2RlZEtleXMucHVzaChlbmNvZGUoa2V5LnBhdGgpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZW5jb2RlZEtleXM7XHJcbiAgICB9O1xyXG4gICAgLyoqIERlY29kZXMgYW4gYXJyYXkgb2YgRW5jb2RlZFJlc291cmNlUGF0aHMgaW50byBhIHNldCBvZiBkb2N1bWVudCBrZXlzLiAqL1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRGJSZXNvdXJjZVBhdGhzID0gZnVuY3Rpb24gKGVuY29kZWRQYXRocykge1xyXG4gICAgICAgIHZhciBrZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGVuY29kZWRQYXRoc18xID0gZW5jb2RlZFBhdGhzOyBfaSA8IGVuY29kZWRQYXRoc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZG9jdW1lbnRLZXkgPSBlbmNvZGVkUGF0aHNfMVtfaV07XHJcbiAgICAgICAgICAgIGtleXMgPSBrZXlzLmFkZChuZXcgRG9jdW1lbnRLZXkoZGVjb2RlJDEoZG9jdW1lbnRLZXkpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgfTtcclxuICAgIC8qKiBEZWNvZGVzIGEgRGJUYXJnZXQgaW50byBRdWVyeURhdGEgKi9cclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbURiVGFyZ2V0ID0gZnVuY3Rpb24gKGRiVGFyZ2V0KSB7XHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLmZyb21EYlRpbWVzdGFtcChkYlRhcmdldC5yZWFkVGltZSk7XHJcbiAgICAgICAgdmFyIHF1ZXJ5O1xyXG4gICAgICAgIGlmIChpc0RvY3VtZW50UXVlcnkoZGJUYXJnZXQucXVlcnkpKSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5ID0gdGhpcy5yZW1vdGVTZXJpYWxpemVyLmZyb21Eb2N1bWVudHNUYXJnZXQoZGJUYXJnZXQucXVlcnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcXVlcnkgPSB0aGlzLnJlbW90ZVNlcmlhbGl6ZXIuZnJvbVF1ZXJ5VGFyZ2V0KGRiVGFyZ2V0LnF1ZXJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeURhdGEocXVlcnksIGRiVGFyZ2V0LnRhcmdldElkLCBRdWVyeVB1cnBvc2UuTGlzdGVuLCBkYlRhcmdldC5sYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIsIHZlcnNpb24sIGRiVGFyZ2V0LnJlc3VtZVRva2VuKTtcclxuICAgIH07XHJcbiAgICAvKiogRW5jb2RlcyBRdWVyeURhdGEgaW50byBhIERiVGFyZ2V0IGZvciBzdG9yYWdlIGxvY2FsbHkuICovXHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLnRvRGJUYXJnZXQgPSBmdW5jdGlvbiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgYXNzZXJ0KFF1ZXJ5UHVycG9zZS5MaXN0ZW4gPT09IHF1ZXJ5RGF0YS5wdXJwb3NlLCAnT25seSBxdWVyaWVzIHdpdGggcHVycG9zZSAnICtcclxuICAgICAgICAgICAgUXVlcnlQdXJwb3NlLkxpc3RlbiArXHJcbiAgICAgICAgICAgICcgbWF5IGJlIHN0b3JlZCwgZ290ICcgK1xyXG4gICAgICAgICAgICBxdWVyeURhdGEucHVycG9zZSk7XHJcbiAgICAgICAgdmFyIGRiVGltZXN0YW1wID0gdGhpcy50b0RiVGltZXN0YW1wKHF1ZXJ5RGF0YS5zbmFwc2hvdFZlcnNpb24pO1xyXG4gICAgICAgIHZhciBxdWVyeVByb3RvO1xyXG4gICAgICAgIGlmIChxdWVyeURhdGEucXVlcnkuaXNEb2N1bWVudFF1ZXJ5KCkpIHtcclxuICAgICAgICAgICAgcXVlcnlQcm90byA9IHRoaXMucmVtb3RlU2VyaWFsaXplci50b0RvY3VtZW50c1RhcmdldChxdWVyeURhdGEucXVlcnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcXVlcnlQcm90byA9IHRoaXMucmVtb3RlU2VyaWFsaXplci50b1F1ZXJ5VGFyZ2V0KHF1ZXJ5RGF0YS5xdWVyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXN1bWVUb2tlbjtcclxuICAgICAgICBpZiAocXVlcnlEYXRhLnJlc3VtZVRva2VuIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xyXG4gICAgICAgICAgICAvLyBUT0RPKGIvNzg3NzE0MDMpOiBDb252ZXJ0IHRva2VucyB0byBzdHJpbmdzIGR1cmluZyBkZXNlcmlhbGl6YXRpb25cclxuICAgICAgICAgICAgYXNzZXJ0KHByb2Nlc3MuZW52LlVTRV9NT0NLX1BFUlNJU1RFTkNFID09PSAnWUVTJywgJ1BlcnNpc3Rpbmcgbm9uLXN0cmluZyBzdHJlYW0gdG9rZW5zIGlzIG9ubHkgc3VwcG9ydGVkIHdpdGggbW9jayBwZXJzaXN0ZW5jZSAuJyk7XHJcbiAgICAgICAgICAgIHJlc3VtZVRva2VuID0gcXVlcnlEYXRhLnJlc3VtZVRva2VuLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXN1bWVUb2tlbiA9IHF1ZXJ5RGF0YS5yZXN1bWVUb2tlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyIGlzIGFsd2F5cyAwIHVudGlsIHdlIGRvIHJlYWwgR0MuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYlRhcmdldChxdWVyeURhdGEudGFyZ2V0SWQsIHF1ZXJ5RGF0YS5xdWVyeS5jYW5vbmljYWxJZCgpLCBkYlRpbWVzdGFtcCwgcmVzdW1lVG9rZW4sIHF1ZXJ5RGF0YS5zZXF1ZW5jZU51bWJlciwgcXVlcnlQcm90byk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExvY2FsU2VyaWFsaXplcjtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgaGVscGVyIGZ1bmN0aW9uIGZvciBmaWd1cmluZyBvdXQgd2hhdCBraW5kIG9mIHF1ZXJ5IGhhcyBiZWVuIHN0b3JlZC5cclxuICovXHJcbmZ1bmN0aW9uIGlzRG9jdW1lbnRRdWVyeShkYlF1ZXJ5KSB7XHJcbiAgICByZXR1cm4gZGJRdWVyeS5kb2N1bWVudHMgIT09IHVuZGVmaW5lZDtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gYnVmZmVyRW50cnlDb21wYXJhdG9yKF9hLCBfYikge1xyXG4gICAgdmFyIGFTZXF1ZW5jZSA9IF9hWzBdLCBhSW5kZXggPSBfYVsxXTtcclxuICAgIHZhciBiU2VxdWVuY2UgPSBfYlswXSwgYkluZGV4ID0gX2JbMV07XHJcbiAgICB2YXIgc2VxQ21wID0gcHJpbWl0aXZlQ29tcGFyYXRvcihhU2VxdWVuY2UsIGJTZXF1ZW5jZSk7XHJcbiAgICBpZiAoc2VxQ21wID09PSAwKSB7XHJcbiAgICAgICAgLy8gVGhpcyBvcmRlciBkb2Vzbid0IG1hdHRlciwgYnV0IHdlIGNhbiBiaWFzIGFnYWluc3QgY2h1cm4gYnkgc29ydGluZ1xyXG4gICAgICAgIC8vIGVudHJpZXMgY3JlYXRlZCBlYXJsaWVyIGFzIGxlc3MgdGhhbiBuZXdlciBlbnRyaWVzLlxyXG4gICAgICAgIHJldHVybiBwcmltaXRpdmVDb21wYXJhdG9yKGFJbmRleCwgYkluZGV4KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBzZXFDbXA7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFVzZWQgdG8gY2FsY3VsYXRlIHRoZSBudGggc2VxdWVuY2UgbnVtYmVyLiBLZWVwcyBhIHJvbGxpbmcgYnVmZmVyIG9mIHRoZVxyXG4gKiBsb3dlc3QgbiB2YWx1ZXMgcGFzc2VkIHRvIGBhZGRFbGVtZW50YCwgYW5kIGZpbmFsbHkgcmVwb3J0cyB0aGUgbGFyZ2VzdCBvZlxyXG4gKiB0aGVtIGluIGBtYXhWYWx1ZWAuXHJcbiAqL1xyXG52YXIgUm9sbGluZ1NlcXVlbmNlTnVtYmVyQnVmZmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUm9sbGluZ1NlcXVlbmNlTnVtYmVyQnVmZmVyKG1heEVsZW1lbnRzKSB7XHJcbiAgICAgICAgdGhpcy5tYXhFbGVtZW50cyA9IG1heEVsZW1lbnRzO1xyXG4gICAgICAgIHRoaXMuYnVmZmVyID0gbmV3IFNvcnRlZFNldChidWZmZXJFbnRyeUNvbXBhcmF0b3IpO1xyXG4gICAgICAgIHRoaXMucHJldmlvdXNJbmRleCA9IDA7XHJcbiAgICB9XHJcbiAgICBSb2xsaW5nU2VxdWVuY2VOdW1iZXJCdWZmZXIucHJvdG90eXBlLm5leHRJbmRleCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKyt0aGlzLnByZXZpb3VzSW5kZXg7XHJcbiAgICB9O1xyXG4gICAgUm9sbGluZ1NlcXVlbmNlTnVtYmVyQnVmZmVyLnByb3RvdHlwZS5hZGRFbGVtZW50ID0gZnVuY3Rpb24gKHNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgdmFyIGVudHJ5ID0gW3NlcXVlbmNlTnVtYmVyLCB0aGlzLm5leHRJbmRleCgpXTtcclxuICAgICAgICBpZiAodGhpcy5idWZmZXIuc2l6ZSA8IHRoaXMubWF4RWxlbWVudHMpIHtcclxuICAgICAgICAgICAgdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5hZGQoZW50cnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGhpZ2hlc3RWYWx1ZSA9IHRoaXMuYnVmZmVyLmxhc3QoKTtcclxuICAgICAgICAgICAgaWYgKGJ1ZmZlckVudHJ5Q29tcGFyYXRvcihlbnRyeSwgaGlnaGVzdFZhbHVlKSA8IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuZGVsZXRlKGhpZ2hlc3RWYWx1ZSkuYWRkKGVudHJ5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUm9sbGluZ1NlcXVlbmNlTnVtYmVyQnVmZmVyLnByb3RvdHlwZSwgXCJtYXhWYWx1ZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIEd1YXJhbnRlZWQgdG8gYmUgbm9uLWVtcHR5LiBJZiB3ZSBkZWNpZGUgd2UgYXJlIG5vdCBjb2xsZWN0aW5nIGFueVxyXG4gICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXJzLCBudGhTZXF1ZW5jZU51bWJlciBiZWxvdyBzaG9ydC1jaXJjdWl0cy4gSWYgd2UgaGF2ZVxyXG4gICAgICAgICAgICAvLyBkZWNpZGVkIHRoYXQgd2UgYXJlIGNvbGxlY3RpbmcgbiBzZXF1ZW5jZSBudW1iZXJzLCBpdCdzIGJlY2F1c2UgbiBpcyBzb21lXHJcbiAgICAgICAgICAgIC8vIHBlcmNlbnRhZ2Ugb2YgdGhlIGV4aXN0aW5nIHNlcXVlbmNlIG51bWJlcnMuIFRoYXQgbWVhbnMgd2Ugc2hvdWxkIG5ldmVyXHJcbiAgICAgICAgICAgIC8vIGJlIGluIGEgc2l0dWF0aW9uIHdoZXJlIHdlIGFyZSBjb2xsZWN0aW5nIHNlcXVlbmNlIG51bWJlcnMgYnV0IGRvbid0XHJcbiAgICAgICAgICAgIC8vIGFjdHVhbGx5IGhhdmUgYW55LlxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIubGFzdCgpWzBdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIFJvbGxpbmdTZXF1ZW5jZU51bWJlckJ1ZmZlcjtcclxufSgpKTtcclxuLyoqIEltcGxlbWVudHMgdGhlIHN0ZXBzIGZvciBMUlUgZ2FyYmFnZSBjb2xsZWN0aW9uLiAqL1xyXG52YXIgTHJ1R2FyYmFnZUNvbGxlY3RvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExydUdhcmJhZ2VDb2xsZWN0b3IoZGVsZWdhdGUpIHtcclxuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XHJcbiAgICB9XHJcbiAgICAvKiogR2l2ZW4gYSBwZXJjZW50aWxlIG9mIHRhcmdldCB0byBjb2xsZWN0LCByZXR1cm5zIHRoZSBudW1iZXIgb2YgdGFyZ2V0cyB0byBjb2xsZWN0LiAqL1xyXG4gICAgTHJ1R2FyYmFnZUNvbGxlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlVGFyZ2V0Q291bnQgPSBmdW5jdGlvbiAodHhuLCBwZXJjZW50aWxlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUuZ2V0VGFyZ2V0Q291bnQodHhuKS5uZXh0KGZ1bmN0aW9uICh0YXJnZXRDb3VudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihwZXJjZW50aWxlIC8gMTAwLjAgKiB0YXJnZXRDb3VudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFJldHVybnMgdGhlIG50aCBzZXF1ZW5jZSBudW1iZXIsIGNvdW50aW5nIGluIG9yZGVyIGZyb20gdGhlIHNtYWxsZXN0LiAqL1xyXG4gICAgTHJ1R2FyYmFnZUNvbGxlY3Rvci5wcm90b3R5cGUubnRoU2VxdWVuY2VOdW1iZXIgPSBmdW5jdGlvbiAodHhuLCBuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAobiA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoTGlzdGVuU2VxdWVuY2UuSU5WQUxJRCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBidWZmZXIgPSBuZXcgUm9sbGluZ1NlcXVlbmNlTnVtYmVyQnVmZmVyKG4pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlXHJcbiAgICAgICAgICAgIC5mb3JFYWNoVGFyZ2V0KHR4biwgZnVuY3Rpb24gKHRhcmdldCkgeyByZXR1cm4gYnVmZmVyLmFkZEVsZW1lbnQodGFyZ2V0LnNlcXVlbmNlTnVtYmVyKTsgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZGVsZWdhdGUuZm9yRWFjaE9ycGhhbmVkRG9jdW1lbnRTZXF1ZW5jZU51bWJlcih0eG4sIGZ1bmN0aW9uIChzZXF1ZW5jZU51bWJlcikgeyByZXR1cm4gYnVmZmVyLmFkZEVsZW1lbnQoc2VxdWVuY2VOdW1iZXIpOyB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBidWZmZXIubWF4VmFsdWU7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyB0YXJnZXRzIHdpdGggYSBzZXF1ZW5jZSBudW1iZXIgZXF1YWwgdG8gb3IgbGVzcyB0aGFuIHRoZSBnaXZlbiB1cHBlciBib3VuZCwgYW5kIHJlbW92ZXNcclxuICAgICAqIGRvY3VtZW50IGFzc29jaWF0aW9ucyB3aXRoIHRob3NlIHRhcmdldHMuXHJcbiAgICAgKi9cclxuICAgIExydUdhcmJhZ2VDb2xsZWN0b3IucHJvdG90eXBlLnJlbW92ZVRhcmdldHMgPSBmdW5jdGlvbiAodHhuLCB1cHBlckJvdW5kLCBhY3RpdmVUYXJnZXRJZHMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5yZW1vdmVUYXJnZXRzKHR4biwgdXBwZXJCb3VuZCwgYWN0aXZlVGFyZ2V0SWRzKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgZG9jdW1lbnRzIHRoYXQgaGF2ZSBhIHNlcXVlbmNlIG51bWJlciBlcXVhbCB0byBvciBsZXNzIHRoYW4gdGhlIHVwcGVyIGJvdW5kIGFuZCBhcmUgbm90XHJcbiAgICAgKiBvdGhlcndpc2UgcGlubmVkLlxyXG4gICAgICovXHJcbiAgICBMcnVHYXJiYWdlQ29sbGVjdG9yLnByb3RvdHlwZS5yZW1vdmVPcnBoYW5lZERvY3VtZW50cyA9IGZ1bmN0aW9uICh0eG4sIHVwcGVyQm91bmQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5yZW1vdmVPcnBoYW5lZERvY3VtZW50cyh0eG4sIHVwcGVyQm91bmQpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBMcnVHYXJiYWdlQ29sbGVjdG9yO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIE9wYXF1ZSBpbnRlcmZhY2UgcmVwcmVzZW50aW5nIGEgcGVyc2lzdGVuY2UgdHJhbnNhY3Rpb24uXHJcbiAqXHJcbiAqIFdoZW4geW91IGNhbGwgUGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oKSwgaXQgd2lsbCBjcmVhdGUgYSB0cmFuc2FjdGlvbiBhbmRcclxuICogcGFzcyBpdCB0byB5b3VyIGNhbGxiYWNrLiBZb3UgdGhlbiBwYXNzIGl0IHRvIGFueSBtZXRob2QgdGhhdCBvcGVyYXRlc1xyXG4gKiBvbiBwZXJzaXN0ZW5jZS5cclxuICovXHJcbnZhciBQZXJzaXN0ZW5jZVRyYW5zYWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGVyc2lzdGVuY2VUcmFuc2FjdGlvbigpIHtcclxuICAgIH1cclxuICAgIHJldHVybiBQZXJzaXN0ZW5jZVRyYW5zYWN0aW9uO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckMiA9ICdJbmRleGVkRGJQZXJzaXN0ZW5jZSc7XHJcbi8qKlxyXG4gKiBPbGRlc3QgYWNjZXB0YWJsZSBhZ2UgaW4gbWlsbGlzZWNvbmRzIGZvciBjbGllbnQgbWV0YWRhdGEgYmVmb3JlIHRoZSBjbGllbnRcclxuICogaXMgY29uc2lkZXJlZCBpbmFjdGl2ZSBhbmQgaXRzIGFzc29jaWF0ZWQgZGF0YSAoc3VjaCBhcyB0aGUgcmVtb3RlIGRvY3VtZW50XHJcbiAqIGNhY2hlIGNoYW5nZWxvZykgaXMgZ2FyYmFnZSBjb2xsZWN0ZWQuXHJcbiAqL1xyXG52YXIgTUFYX0NMSUVOVF9BR0VfTVMgPSAzMCAqIDYwICogMTAwMDsgLy8gMzAgbWludXRlc1xyXG4vKipcclxuICogT2xkZXN0IGFjY2VwdGFibGUgbWV0YWRhdGEgYWdlIGZvciBjbGllbnRzIHRoYXQgbWF5IHBhcnRpY2lwYXRlIGluIHRoZVxyXG4gKiBwcmltYXJ5IGxlYXNlIGVsZWN0aW9uLiBDbGllbnRzIHRoYXQgaGF2ZSBub3QgdXBkYXRlZCB0aGVpciBjbGllbnQgbWV0YWRhdGFcclxuICogd2l0aGluIDUgc2Vjb25kcyBhcmUgbm90IGVsaWdpYmxlIHRvIHJlY2VpdmUgYSBwcmltYXJ5IGxlYXNlLlxyXG4gKi9cclxudmFyIE1BWF9QUklNQVJZX0VMSUdJQkxFX0FHRV9NUyA9IDUwMDA7XHJcbi8qKlxyXG4gKiBUaGUgaW50ZXJ2YWwgYXQgd2hpY2ggY2xpZW50cyB3aWxsIHVwZGF0ZSB0aGVpciBtZXRhZGF0YSwgaW5jbHVkaW5nXHJcbiAqIHJlZnJlc2hpbmcgdGhlaXIgcHJpbWFyeSBsZWFzZSBpZiBoZWxkIG9yIHBvdGVudGlhbGx5IHRyeWluZyB0byBhY3F1aXJlIGl0IGlmXHJcbiAqIG5vdCBoZWxkLlxyXG4gKlxyXG4gKiBQcmltYXJ5IGNsaWVudHMgbWF5IG9wcG9ydHVuaXN0aWNhbGx5IHJlZnJlc2ggdGhlaXIgbWV0YWRhdGEgZWFybGllclxyXG4gKiBpZiB0aGV5J3JlIGFscmVhZHkgcGVyZm9ybWluZyBhbiBJbmRleGVkREIgb3BlcmF0aW9uLlxyXG4gKi9cclxudmFyIENMSUVOVF9NRVRBREFUQV9SRUZSRVNIX0lOVEVSVkFMX01TID0gNDAwMDtcclxuLyoqIFVzZXItZmFjaW5nIGVycm9yIHdoZW4gdGhlIHByaW1hcnkgbGVhc2UgaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGUuICovXHJcbnZhciBQUklNQVJZX0xFQVNFX0xPU1RfRVJST1JfTVNHID0gJ1RoZSBjdXJyZW50IHRhYiBpcyBub3QgaW4gdGhlIHJlcXVpcmVkIHN0YXRlIHRvIHBlcmZvcm0gdGhpcyBvcGVyYXRpb24uICcgK1xyXG4gICAgJ0l0IG1pZ2h0IGJlIG5lY2Vzc2FyeSB0byByZWZyZXNoIHRoZSBicm93c2VyIHRhYi4nO1xyXG52YXIgUFJJTUFSWV9MRUFTRV9FWENMVVNJVkVfRVJST1JfTVNHID0gJ0Fub3RoZXIgdGFiIGhhcyBleGNsdXNpdmUgYWNjZXNzIHRvIHRoZSBwZXJzaXN0ZW5jZSBsYXllci4gJyArXHJcbiAgICAnVG8gYWxsb3cgc2hhcmVkIGFjY2VzcywgbWFrZSBzdXJlIHRvIGludm9rZSAnICtcclxuICAgICdgZW5hYmxlUGVyc2lzdGVuY2UoKWAgd2l0aCBgZXhwZXJpbWVudGFsVGFiU3luY2hyb25pemF0aW9uOnRydWVgIGluIGFsbCB0YWJzLic7XHJcbnZhciBVTlNVUFBPUlRFRF9QTEFURk9STV9FUlJPUl9NU0cgPSAnVGhpcyBwbGF0Zm9ybSBpcyBlaXRoZXIgbWlzc2luZycgK1xyXG4gICAgJyBJbmRleGVkREIgb3IgaXMga25vd24gdG8gaGF2ZSBhbiBpbmNvbXBsZXRlIGltcGxlbWVudGF0aW9uLiBPZmZsaW5lJyArXHJcbiAgICAnIHBlcnNpc3RlbmNlIGhhcyBiZWVuIGRpc2FibGVkLic7XHJcbi8vIFRoZSBmb3JtYXQgb2YgdGhlIExvY2FsU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgem9tYmllZCBjbGllbnQgaXM6XHJcbi8vICAgICBmaXJlc3RvcmVfem9tYmllXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XzxpbnN0YW5jZV9rZXk+XHJcbnZhciBaT01CSUVEX0NMSUVOVFNfS0VZX1BSRUZJWCA9ICdmaXJlc3RvcmVfem9tYmllJztcclxudmFyIEluZGV4ZWREYlRyYW5zYWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoSW5kZXhlZERiVHJhbnNhY3Rpb24sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBJbmRleGVkRGJUcmFuc2FjdGlvbihzaW1wbGVEYlRyYW5zYWN0aW9uLCBjdXJyZW50U2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnNpbXBsZURiVHJhbnNhY3Rpb24gPSBzaW1wbGVEYlRyYW5zYWN0aW9uO1xyXG4gICAgICAgIF90aGlzLmN1cnJlbnRTZXF1ZW5jZU51bWJlciA9IGN1cnJlbnRTZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gSW5kZXhlZERiVHJhbnNhY3Rpb247XHJcbn0oUGVyc2lzdGVuY2VUcmFuc2FjdGlvbikpO1xyXG52YXIgSW5kZXhlZERiUGVyc2lzdGVuY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyBOb3RlIHRoYXQgYG11bHRpQ2xpZW50UGFyYW1zYCBtdXN0IGJlIHByZXNlbnQgdG8gZW5hYmxlIG11bHRpLWNsaWVudCBzdXBwb3J0IHdoaWxlIG11bHRpLXRhYlxyXG4gICAgLy8gaXMgc3RpbGwgZXhwZXJpbWVudGFsLiBXaGVuIG11bHRpLWNsaWVudCBpcyBzd2l0Y2hlZCB0byBhbHdheXMgb24sIGBtdWx0aUNsaWVudFBhcmFtc2Agd2lsbFxyXG4gICAgLy8gbm8gbG9uZ2VyIGJlIG9wdGlvbmFsLlxyXG4gICAgZnVuY3Rpb24gSW5kZXhlZERiUGVyc2lzdGVuY2UocGVyc2lzdGVuY2VLZXksIGNsaWVudElkLCBwbGF0Zm9ybSwgcXVldWUsIHNlcmlhbGl6ZXIsIG11bHRpQ2xpZW50UGFyYW1zKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IHBlcnNpc3RlbmNlS2V5O1xyXG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDtcclxuICAgICAgICB0aGlzLnF1ZXVlID0gcXVldWU7XHJcbiAgICAgICAgdGhpcy5tdWx0aUNsaWVudFBhcmFtcyA9IG11bHRpQ2xpZW50UGFyYW1zO1xyXG4gICAgICAgIHRoaXMuX3N0YXJ0ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzUHJpbWFyeSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuaW5Gb3JlZ3JvdW5kID0gZmFsc2U7XHJcbiAgICAgICAgLyoqIFRoZSBsYXN0IHRpbWUgd2UgZ2FyYmFnZSBjb2xsZWN0ZWQgdGhlIFJlbW90ZSBEb2N1bWVudCBDaGFuZ2Vsb2cuICovXHJcbiAgICAgICAgdGhpcy5sYXN0R2FyYmFnZUNvbGxlY3Rpb25UaW1lID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZO1xyXG4gICAgICAgIC8qKiBBIGxpc3RlbmVyIHRvIG5vdGlmeSBvbiBwcmltYXJ5IHN0YXRlIGNoYW5nZXMuICovXHJcbiAgICAgICAgdGhpcy5wcmltYXJ5U3RhdGVMaXN0ZW5lciA9IGZ1bmN0aW9uIChfKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsgfTtcclxuICAgICAgICBpZiAoIUluZGV4ZWREYlBlcnNpc3RlbmNlLmlzQXZhaWxhYmxlKCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5JTVBMRU1FTlRFRCwgVU5TVVBQT1JURURfUExBVEZPUk1fRVJST1JfTVNHKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IG5ldyBJbmRleGVkRGJMcnVEZWxlZ2F0ZSh0aGlzKTtcclxuICAgICAgICB0aGlzLmRiTmFtZSA9IHBlcnNpc3RlbmNlS2V5ICsgSW5kZXhlZERiUGVyc2lzdGVuY2UuTUFJTl9EQVRBQkFTRTtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBuZXcgTG9jYWxTZXJpYWxpemVyKHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnQgPSBwbGF0Zm9ybS5kb2N1bWVudDtcclxuICAgICAgICB0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uID0gbXVsdGlDbGllbnRQYXJhbXMgIT09IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLnF1ZXJ5Q2FjaGUgPSBuZXcgSW5kZXhlZERiUXVlcnlDYWNoZSh0aGlzLnJlZmVyZW5jZURlbGVnYXRlLCB0aGlzLnNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZSA9IG5ldyBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlKHRoaXMuc2VyaWFsaXplciwgXHJcbiAgICAgICAgLyprZWVwRG9jdW1lbnRDaGFuZ2VMb2c9Ki8gdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbik7XHJcbiAgICAgICAgaWYgKHBsYXRmb3JtLndpbmRvdyAmJiBwbGF0Zm9ybS53aW5kb3cubG9jYWxTdG9yYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2luZG93ID0gcGxhdGZvcm0ud2luZG93O1xyXG4gICAgICAgICAgICB0aGlzLndlYlN0b3JhZ2UgPSB0aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTklNUExFTUVOVEVELCAnSW5kZXhlZERCIHBlcnNpc3RlbmNlIGlzIG9ubHkgYXZhaWxhYmxlIG9uIHBsYXRmb3JtcyB0aGF0IHN1cHBvcnQgTG9jYWxTdG9yYWdlLicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlID0gZnVuY3Rpb24gKHR4biwgc3RvcmUpIHtcclxuICAgICAgICBpZiAodHhuIGluc3RhbmNlb2YgSW5kZXhlZERiVHJhbnNhY3Rpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIFNpbXBsZURiLmdldFN0b3JlKHR4bi5zaW1wbGVEYlRyYW5zYWN0aW9uLCBzdG9yZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBmYWlsKCdJbmRleGVkRGJQZXJzaXN0ZW5jZSBtdXN0IHVzZSBpbnN0YW5jZXMgb2YgSW5kZXhlZERiVHJhbnNhY3Rpb24nKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UuY3JlYXRlSW5kZXhlZERiUGVyc2lzdGVuY2UgPSBmdW5jdGlvbiAocGVyc2lzdGVuY2VLZXksIGNsaWVudElkLCBwbGF0Zm9ybSwgcXVldWUsIHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBlcnNpc3RlbmNlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3RlbmNlID0gbmV3IEluZGV4ZWREYlBlcnNpc3RlbmNlKHBlcnNpc3RlbmNlS2V5LCBjbGllbnRJZCwgcGxhdGZvcm0sIHF1ZXVlLCBzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGVyc2lzdGVuY2Uuc3RhcnQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBwZXJzaXN0ZW5jZV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLmNyZWF0ZU11bHRpQ2xpZW50SW5kZXhlZERiUGVyc2lzdGVuY2UgPSBmdW5jdGlvbiAocGVyc2lzdGVuY2VLZXksIGNsaWVudElkLCBwbGF0Zm9ybSwgcXVldWUsIHNlcmlhbGl6ZXIsIG11bHRpQ2xpZW50UGFyYW1zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwZXJzaXN0ZW5jZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZW5jZSA9IG5ldyBJbmRleGVkRGJQZXJzaXN0ZW5jZShwZXJzaXN0ZW5jZUtleSwgY2xpZW50SWQsIHBsYXRmb3JtLCBxdWV1ZSwgc2VyaWFsaXplciwgbXVsdGlDbGllbnRQYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBwZXJzaXN0ZW5jZS5zdGFydCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHBlcnNpc3RlbmNlXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBdHRlbXB0IHRvIHN0YXJ0IEluZGV4ZWREYiBwZXJzaXN0ZW5jZS5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPHZvaWQ+fSBXaGV0aGVyIHBlcnNpc3RlbmNlIHdhcyBlbmFibGVkLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQoIXRoaXMuc3RhcnRlZCwgJ0luZGV4ZWREYlBlcnNpc3RlbmNlIGRvdWJsZS1zdGFydGVkIScpO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLndpbmRvdyAhPT0gbnVsbCwgXCJFeHBlY3RlZCAnd2luZG93JyB0byBiZSBkZWZpbmVkXCIpO1xyXG4gICAgICAgIHJldHVybiBTaW1wbGVEYi5vcGVuT3JDcmVhdGUodGhpcy5kYk5hbWUsIFNDSEVNQV9WRVJTSU9OLCBuZXcgU2NoZW1hQ29udmVydGVyKHRoaXMuc2VyaWFsaXplcikpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYikge1xyXG4gICAgICAgICAgICBfdGhpcy5zaW1wbGVEYiA9IGRiO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnN0YXJ0UmVtb3RlRG9jdW1lbnRDYWNoZSgpOyB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmF0dGFjaFZpc2liaWxpdHlIYW5kbGVyKCk7XHJcbiAgICAgICAgICAgIF90aGlzLmF0dGFjaFdpbmRvd1VubG9hZEhvb2soKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZUNsaWVudE1ldGFkYXRhQW5kVHJ5QmVjb21lUHJpbWFyeSgpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNjaGVkdWxlQ2xpZW50TWV0YWRhdGFBbmRQcmltYXJ5TGVhc2VSZWZyZXNoZXMoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc2ltcGxlRGIucnVuVHJhbnNhY3Rpb24oJ3JlYWRvbmx5JywgW0RiVGFyZ2V0R2xvYmFsLnN0b3JlXSwgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcih0eG4pLm5leHQoZnVuY3Rpb24gKGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXF1ZW5jZU51bWJlclN5bmNlciA9IF90aGlzLm11bHRpQ2xpZW50UGFyYW1zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gX3RoaXMubXVsdGlDbGllbnRQYXJhbXMuc2VxdWVuY2VOdW1iZXJTeW5jZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubGlzdGVuU2VxdWVuY2UgPSBuZXcgTGlzdGVuU2VxdWVuY2UoaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyLCBzZXF1ZW5jZU51bWJlclN5bmNlcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5fc3RhcnRlZCA9IHRydWU7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgX3RoaXMuc2ltcGxlRGIgJiYgX3RoaXMuc2ltcGxlRGIuY2xvc2UoKTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlYXNvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnN0YXJ0UmVtb3RlRG9jdW1lbnRDYWNoZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNpbXBsZURiLnJ1blRyYW5zYWN0aW9uKCdyZWFkb25seScsIEFMTF9TVE9SRVMsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUuc3RhcnQodHhuKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuc2V0UHJpbWFyeVN0YXRlTGlzdGVuZXIgPSBmdW5jdGlvbiAocHJpbWFyeVN0YXRlTGlzdGVuZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMucHJpbWFyeVN0YXRlTGlzdGVuZXIgPSBmdW5jdGlvbiAocHJpbWFyeVN0YXRlKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHByaW1hcnlTdGF0ZUxpc3RlbmVyKHByaW1hcnlTdGF0ZSldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgfTtcclxuICAgICAgICByZXR1cm4gcHJpbWFyeVN0YXRlTGlzdGVuZXIodGhpcy5pc1ByaW1hcnkpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5zZXROZXR3b3JrRW5hYmxlZCA9IGZ1bmN0aW9uIChuZXR3b3JrRW5hYmxlZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya0VuYWJsZWQgIT09IG5ldHdvcmtFbmFibGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgPSBuZXR3b3JrRW5hYmxlZDtcclxuICAgICAgICAgICAgLy8gU2NoZWR1bGUgYSBwcmltYXJ5IGxlYXNlIHJlZnJlc2ggZm9yIGltbWVkaWF0ZSBleGVjdXRpb24uIFRoZSBldmVudHVhbFxyXG4gICAgICAgICAgICAvLyBsZWFzZSB1cGRhdGUgd2lsbCBiZSBwcm9wYWdhdGVkIHZpYSBgcHJpbWFyeVN0YXRlTGlzdGVuZXJgLlxyXG4gICAgICAgICAgICB0aGlzLnF1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdGFydGVkKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMudXBkYXRlQ2xpZW50TWV0YWRhdGFBbmRUcnlCZWNvbWVQcmltYXJ5KCldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlcyB0aGUgY2xpZW50IG1ldGFkYXRhIGluIEluZGV4ZWREYiBhbmQgYXR0ZW1wdHMgdG8gZWl0aGVyIG9idGFpbiBvclxyXG4gICAgICogZXh0ZW5kIHRoZSBwcmltYXJ5IGxlYXNlIGZvciB0aGUgbG9jYWwgY2xpZW50LiBBc3luY2hyb25vdXNseSBub3RpZmllcyB0aGVcclxuICAgICAqIHByaW1hcnkgc3RhdGUgbGlzdGVuZXIgaWYgdGhlIGNsaWVudCBlaXRoZXIgbmV3bHkgb2J0YWluZWQgb3IgcmVsZWFzZWQgaXRzXHJcbiAgICAgKiBwcmltYXJ5IGxlYXNlLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUudXBkYXRlQ2xpZW50TWV0YWRhdGFBbmRUcnlCZWNvbWVQcmltYXJ5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2ltcGxlRGIucnVuVHJhbnNhY3Rpb24oJ3JlYWR3cml0ZScsIEFMTF9TVE9SRVMsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgdmFyIG1ldGFkYXRhU3RvcmUgPSBjbGllbnRNZXRhZGF0YVN0b3JlKHR4bik7XHJcbiAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YVN0b3JlXHJcbiAgICAgICAgICAgICAgICAucHV0KG5ldyBEYkNsaWVudE1ldGFkYXRhKF90aGlzLmNsaWVudElkLCBEYXRlLm5vdygpLCBfdGhpcy5uZXR3b3JrRW5hYmxlZCwgX3RoaXMuaW5Gb3JlZ3JvdW5kLCBfdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlLmxhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkKSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudmVyaWZ5UHJpbWFyeUxlYXNlKHR4bikubmV4dChmdW5jdGlvbiAoc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzUHJpbWFyeSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnByaW1hcnlTdGF0ZUxpc3RlbmVyKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5jYW5BY3RBc1ByaW1hcnkodHhuKTsgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChjYW5BY3RBc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgIHZhciB3YXNQcmltYXJ5ID0gX3RoaXMuaXNQcmltYXJ5O1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuaXNQcmltYXJ5ID0gY2FuQWN0QXNQcmltYXJ5O1xyXG4gICAgICAgICAgICAgICAgaWYgKHdhc1ByaW1hcnkgIT09IF90aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnF1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucHJpbWFyeVN0YXRlTGlzdGVuZXIoX3RoaXMuaXNQcmltYXJ5KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh3YXNQcmltYXJ5ICYmICFfdGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVsZWFzZVByaW1hcnlMZWFzZUlmSGVsZCh0eG4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoX3RoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmFjcXVpcmVPckV4dGVuZFByaW1hcnlMZWFzZSh0eG4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUudmVyaWZ5UHJpbWFyeUxlYXNlID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gcHJpbWFyeUNsaWVudFN0b3JlKHR4bik7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlLmdldChEYlByaW1hcnlDbGllbnQua2V5KS5uZXh0KGZ1bmN0aW9uIChwcmltYXJ5Q2xpZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShfdGhpcy5pc0xvY2FsQ2xpZW50KHByaW1hcnlDbGllbnQpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUucmVtb3ZlQ2xpZW50TWV0YWRhdGEgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIG1ldGFkYXRhU3RvcmUgPSBjbGllbnRNZXRhZGF0YVN0b3JlKHR4bik7XHJcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhU3RvcmUuZGVsZXRlKHRoaXMuY2xpZW50SWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSWYgdGhlIGdhcmJhZ2UgY29sbGVjdGlvbiB0aHJlc2hvbGQgaGFzIHBhc3NlZCwgcHJ1bmVzIHRoZVxyXG4gICAgICogUmVtb3RlRG9jdW1lbnRDaGFuZ2VzIGFuZCB0aGUgQ2xpZW50TWV0YWRhdGEgc3RvcmUgYmFzZWQgb24gdGhlIGxhc3QgdXBkYXRlXHJcbiAgICAgKiB0aW1lIG9mIGFsbCBjbGllbnRzLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUubWF5YmVHYXJiYWdlQ29sbGVjdE11bHRpQ2xpZW50U3RhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBhY3RpdmVDbGllbnRzXzEsIGluYWN0aXZlQ2xpZW50c18xO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMuaXNQcmltYXJ5ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5pc1dpdGhpbkFnZSh0aGlzLmxhc3RHYXJiYWdlQ29sbGVjdGlvblRpbWUsIE1BWF9DTElFTlRfQUdFX01TKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RHYXJiYWdlQ29sbGVjdGlvblRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmFjdGl2ZUNsaWVudHNfMSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJ1blRyYW5zYWN0aW9uKCdtYXliZUdhcmJhZ2VDb2xsZWN0TXVsdGlDbGllbnRTdGF0ZScsICdyZWFkd3JpdGUtcHJpbWFyeScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0YWRhdGFTdG9yZSA9IEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJDbGllbnRNZXRhZGF0YS5zdG9yZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhU3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmxvYWRBbGwoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoZXhpc3RpbmdDbGllbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUNsaWVudHNfMSA9IF90aGlzLmZpbHRlckFjdGl2ZUNsaWVudHMoZXhpc3RpbmdDbGllbnRzLCBNQVhfQ0xJRU5UX0FHRV9NUyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluYWN0aXZlQ2xpZW50c18xID0gZXhpc3RpbmdDbGllbnRzLmZpbHRlcihmdW5jdGlvbiAoY2xpZW50KSB7IHJldHVybiBhY3RpdmVDbGllbnRzXzEuaW5kZXhPZihjbGllbnQpID09PSAtMTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgbWV0YWRhdGEgZm9yIGNsaWVudHMgdGhhdCBhcmUgbm8gbG9uZ2VyIGNvbnNpZGVyZWQgYWN0aXZlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2goaW5hY3RpdmVDbGllbnRzXzEsIGZ1bmN0aW9uIChpbmFjdGl2ZUNsaWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhU3RvcmUuZGVsZXRlKGluYWN0aXZlQ2xpZW50LmNsaWVudElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXRyaWV2ZSB0aGUgbWluaW11bSBjaGFuZ2UgSUQgZnJvbSB0aGUgc2V0IG9mIGFjdGl2ZSBjbGllbnRzLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcHJpbWFyeSBjbGllbnQgZG9lc24ndCByZWFkIGZyb20gdGhlIGRvY3VtZW50IGNoYW5nZSBsb2csXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBoZW5jZSB3ZSBleGNsdWRlIGl0IHdoZW4gd2UgZGV0ZXJtaW5lIHRoZSBtaW5pbXVtXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGBsYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZGAuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUNsaWVudHNfMSA9IGFjdGl2ZUNsaWVudHNfMS5maWx0ZXIoZnVuY3Rpb24gKGNsaWVudCkgeyByZXR1cm4gY2xpZW50LmNsaWVudElkICE9PSBfdGhpcy5jbGllbnRJZDsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVDbGllbnRzXzEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NlZENoYW5nZUlkcyA9IGFjdGl2ZUNsaWVudHNfMS5tYXAoZnVuY3Rpb24gKGNsaWVudCkgeyByZXR1cm4gY2xpZW50Lmxhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkIHx8IDA7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9sZGVzdENoYW5nZUlkID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgcHJvY2Vzc2VkQ2hhbmdlSWRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlLnJlbW92ZURvY3VtZW50Q2hhbmdlc1Rocm91Z2hDaGFuZ2VJZCh0eG4sIG9sZGVzdENoYW5nZUlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgcG90ZW50aWFsIGxlZnRvdmVyIGVudHJpZXMgdGhhdCBtYXkgY29udGludWUgdG8gbWFyayB0aGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5hY3RpdmUgY2xpZW50cyBhcyB6b21iaWVkIGluIExvY2FsU3RvcmFnZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWRlYWxseSB3ZSdkIGRlbGV0ZSB0aGUgSW5kZXhlZERiIGFuZCBMb2NhbFN0b3JhZ2Ugem9tYmllIGVudHJpZXMgZm9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBjbGllbnQgYXRvbWljYWxseSwgYnV0IHdlIGNhbid0LiBTbyB3ZSBvcHQgdG8gZGVsZXRlIHRoZSBJbmRleGVkRGJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW50cmllcyBmaXJzdCB0byBhdm9pZCBwb3RlbnRpYWxseSByZXZpdmluZyBhIHpvbWJpZWQgY2xpZW50LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmFjdGl2ZUNsaWVudHNfMS5mb3JFYWNoKGZ1bmN0aW9uIChpbmFjdGl2ZUNsaWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMud2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKF90aGlzLnpvbWJpZWRDbGllbnRMb2NhbFN0b3JhZ2VLZXkoaW5hY3RpdmVDbGllbnQuY2xpZW50SWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTY2hlZHVsZXMgYSByZWN1cnJpbmcgdGltZXIgdG8gdXBkYXRlIHRoZSBjbGllbnQgbWV0YWRhdGEgYW5kIHRvIGVpdGhlclxyXG4gICAgICogZXh0ZW5kIG9yIGFjcXVpcmUgdGhlIHByaW1hcnkgbGVhc2UgaWYgdGhlIGNsaWVudCBpcyBlbGlnaWJsZS5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnNjaGVkdWxlQ2xpZW50TWV0YWRhdGFBbmRQcmltYXJ5TGVhc2VSZWZyZXNoZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmNsaWVudE1ldGFkYXRhUmVmcmVzaGVyID0gdGhpcy5xdWV1ZS5lbnF1ZXVlQWZ0ZXJEZWxheShUaW1lcklkLkNsaWVudE1ldGFkYXRhUmVmcmVzaCwgQ0xJRU5UX01FVEFEQVRBX1JFRlJFU0hfSU5URVJWQUxfTVMsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZUNsaWVudE1ldGFkYXRhQW5kVHJ5QmVjb21lUHJpbWFyeSgpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5tYXliZUdhcmJhZ2VDb2xsZWN0TXVsdGlDbGllbnRTdGF0ZSgpOyB9KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc2NoZWR1bGVDbGllbnRNZXRhZGF0YUFuZFByaW1hcnlMZWFzZVJlZnJlc2hlcygpOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogQ2hlY2tzIHdoZXRoZXIgYGNsaWVudGAgaXMgdGhlIGxvY2FsIGNsaWVudC4gKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5pc0xvY2FsQ2xpZW50ID0gZnVuY3Rpb24gKGNsaWVudCkge1xyXG4gICAgICAgIHJldHVybiBjbGllbnQgPyBjbGllbnQub3duZXJJZCA9PT0gdGhpcy5jbGllbnRJZCA6IGZhbHNlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogRXZhbHVhdGUgdGhlIHN0YXRlIG9mIGFsbCBhY3RpdmUgY2xpZW50cyBhbmQgZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGxvY2FsXHJcbiAgICAgKiBjbGllbnQgaXMgb3IgY2FuIGFjdCBhcyB0aGUgaG9sZGVyIG9mIHRoZSBwcmltYXJ5IGxlYXNlLiBSZXR1cm5zIHdoZXRoZXJcclxuICAgICAqIHRoZSBjbGllbnQgaXMgZWxpZ2libGUgZm9yIHRoZSBsZWFzZSwgYnV0IGRvZXMgbm90IGFjdHVhbGx5IGFjcXVpcmUgaXQuXHJcbiAgICAgKiBNYXkgcmV0dXJuICdmYWxzZScgZXZlbiBpZiB0aGVyZSBpcyBubyBhY3RpdmUgbGVhc2Vob2xkZXIgYW5kIGFub3RoZXJcclxuICAgICAqIChmb3JlZ3JvdW5kKSBjbGllbnQgc2hvdWxkIGJlY29tZSBsZWFzZWhvbGRlciBpbnN0ZWFkLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuY2FuQWN0QXNQcmltYXJ5ID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gcHJpbWFyeUNsaWVudFN0b3JlKHR4bik7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlXHJcbiAgICAgICAgICAgIC5nZXQoRGJQcmltYXJ5Q2xpZW50LmtleSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGN1cnJlbnRQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50TGVhc2VJc1ZhbGlkID0gY3VycmVudFByaW1hcnkgIT09IG51bGwgJiZcclxuICAgICAgICAgICAgICAgIF90aGlzLmlzV2l0aGluQWdlKGN1cnJlbnRQcmltYXJ5LmxlYXNlVGltZXN0YW1wTXMsIE1BWF9QUklNQVJZX0VMSUdJQkxFX0FHRV9NUykgJiZcclxuICAgICAgICAgICAgICAgICFfdGhpcy5pc0NsaWVudFpvbWJpZWQoY3VycmVudFByaW1hcnkub3duZXJJZCk7XHJcbiAgICAgICAgICAgIC8vIEEgY2xpZW50IGlzIGVsaWdpYmxlIGZvciB0aGUgcHJpbWFyeSBsZWFzZSBpZjpcclxuICAgICAgICAgICAgLy8gLSBpdHMgbmV0d29yayBpcyBlbmFibGVkIGFuZCB0aGUgY2xpZW50J3MgdGFiIGlzIGluIHRoZSBmb3JlZ3JvdW5kLlxyXG4gICAgICAgICAgICAvLyAtIGl0cyBuZXR3b3JrIGlzIGVuYWJsZWQgYW5kIG5vIG90aGVyIGNsaWVudCdzIHRhYiBpcyBpbiB0aGVcclxuICAgICAgICAgICAgLy8gICBmb3JlZ3JvdW5kLlxyXG4gICAgICAgICAgICAvLyAtIGV2ZXJ5IGNsaWVudHMgbmV0d29yayBpcyBkaXNhYmxlZCBhbmQgdGhlIGNsaWVudCdzIHRhYiBpcyBpbiB0aGVcclxuICAgICAgICAgICAgLy8gICBmb3JlZ3JvdW5kLlxyXG4gICAgICAgICAgICAvLyAtIGV2ZXJ5IGNsaWVudHMgbmV0d29yayBpcyBkaXNhYmxlZCBhbmQgbm8gb3RoZXIgY2xpZW50J3MgdGFiIGlzIGluXHJcbiAgICAgICAgICAgIC8vICAgdGhlIGZvcmVncm91bmQuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50TGVhc2VJc1ZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNMb2NhbENsaWVudChjdXJyZW50UHJpbWFyeSkgJiYgX3RoaXMubmV0d29ya0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuaXNMb2NhbENsaWVudChjdXJyZW50UHJpbWFyeSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRQcmltYXJ5LmFsbG93VGFiU3luY2hyb25pemF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZhaWwgdGhlIGBjYW5BY3RBc1ByaW1hcnlgIGNoZWNrIGlmIHRoZSBjdXJyZW50IGxlYXNlaG9sZGVyIGhhc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub3Qgb3B0ZWQgaW50byBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLiBJZiB0aGlzIGhhcHBlbnMgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xpZW50IHN0YXJ0dXAsIHdlIHJlamVjdCB0aGUgUHJvbWlzZSByZXR1cm5lZCBieVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBgZW5hYmxlUGVyc2lzdGVuY2UoKWAgYW5kIHRoZSB1c2VyIGNhbiBjb250aW51ZSB0byB1c2UgRmlyZXN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdpdGggaW4tbWVtb3J5IHBlcnNpc3RlbmNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGZhaWxzIGR1cmluZyBhIGxlYXNlIHJlZnJlc2gsIHdlIHdpbGwgaW5zdGVhZCBibG9jayB0aGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXN5bmNRdWV1ZSBmcm9tIGV4ZWN1dGluZyBmdXJ0aGVyIG9wZXJhdGlvbnMuIE5vdGUgdGhhdCB0aGlzIGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFjY2VwdGFibGUgc2luY2UgbWl4aW5nICYgbWF0Y2hpbmcgZGlmZmVyZW50IGBzeW5jaHJvbml6ZVRhYnNgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldHRpbmdzIGlzIG5vdCBzdXBwb3J0ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE8oYi8xMTQyMjYyMzQpOiBSZW1vdmUgdGhpcyBjaGVjayB3aGVuIGBzeW5jaHJvbml6ZVRhYnNgIGNhblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBubyBsb25nZXIgYmUgdHVybmVkIG9mZi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgUFJJTUFSWV9MRUFTRV9FWENMVVNJVkVfRVJST1JfTVNHKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5uZXR3b3JrRW5hYmxlZCAmJiBfdGhpcy5pbkZvcmVncm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjbGllbnRNZXRhZGF0YVN0b3JlKHR4bilcclxuICAgICAgICAgICAgICAgIC5sb2FkQWxsKClcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChleGlzdGluZ0NsaWVudHMpIHtcclxuICAgICAgICAgICAgICAgIC8vIFByb2Nlc3MgYWxsIGV4aXN0aW5nIGNsaWVudHMgYW5kIGRldGVybWluZSB3aGV0aGVyIGF0IGxlYXN0IG9uZSBvZlxyXG4gICAgICAgICAgICAgICAgLy8gdGhlbSBpcyBiZXR0ZXIgc3VpdGVkIHRvIG9idGFpbiB0aGUgcHJpbWFyeSBsZWFzZS5cclxuICAgICAgICAgICAgICAgIHZhciBwcmVmZXJyZWRDYW5kaWRhdGUgPSBfdGhpcy5maWx0ZXJBY3RpdmVDbGllbnRzKGV4aXN0aW5nQ2xpZW50cywgTUFYX1BSSU1BUllfRUxJR0lCTEVfQUdFX01TKS5maW5kKGZ1bmN0aW9uIChvdGhlckNsaWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5jbGllbnRJZCAhPT0gb3RoZXJDbGllbnQuY2xpZW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG90aGVyQ2xpZW50SGFzQmV0dGVyTmV0d29ya1N0YXRlID0gIV90aGlzLm5ldHdvcmtFbmFibGVkICYmIG90aGVyQ2xpZW50Lm5ldHdvcmtFbmFibGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXJDbGllbnRIYXNCZXR0ZXJWaXNpYmlsaXR5ID0gIV90aGlzLmluRm9yZWdyb3VuZCAmJiBvdGhlckNsaWVudC5pbkZvcmVncm91bmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdGhlckNsaWVudEhhc1NhbWVOZXR3b3JrU3RhdGUgPSBfdGhpcy5uZXR3b3JrRW5hYmxlZCA9PT0gb3RoZXJDbGllbnQubmV0d29ya0VuYWJsZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvdGhlckNsaWVudEhhc0JldHRlck5ldHdvcmtTdGF0ZSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKG90aGVyQ2xpZW50SGFzQmV0dGVyVmlzaWJpbGl0eSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG90aGVyQ2xpZW50SGFzU2FtZU5ldHdvcmtTdGF0ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByZWZlcnJlZENhbmRpZGF0ZSA9PT0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoY2FuQWN0QXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5pc1ByaW1hcnkgIT09IGNhbkFjdEFzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQyLCBcIkNsaWVudCBcIiArIChjYW5BY3RBc1ByaW1hcnkgPyAnaXMnIDogJ2lzIG5vdCcpICsgXCIgZWxpZ2libGUgZm9yIGEgcHJpbWFyeSBsZWFzZS5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNhbkFjdEFzUHJpbWFyeTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuc2h1dGRvd24gPSBmdW5jdGlvbiAoZGVsZXRlRGF0YSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBzaHV0ZG93bigpIG9wZXJhdGlvbnMgYXJlIGlkZW1wb3RlbnQgYW5kIGNhbiBiZSBjYWxsZWQgZXZlbiB3aGVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0KCkgYWJvcnRlZCAoZS5nLiBiZWNhdXNlIGl0IGNvdWxkbid0IGFjcXVpcmUgdGhlIHBlcnNpc3RlbmNlIGxlYXNlKS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtDbGllbnRab21iaWVkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNsaWVudE1ldGFkYXRhUmVmcmVzaGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsaWVudE1ldGFkYXRhUmVmcmVzaGVyLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoVmlzaWJpbGl0eUhhbmRsZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhY2hXaW5kb3dVbmxvYWRIb29rKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc2ltcGxlRGIucnVuVHJhbnNhY3Rpb24oJ3JlYWR3cml0ZScsIFtEYlByaW1hcnlDbGllbnQuc3RvcmUsIERiQ2xpZW50TWV0YWRhdGEuc3RvcmVdLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbGVhc2VQcmltYXJ5TGVhc2VJZkhlbGQodHhuKS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW92ZUNsaWVudE1ldGFkYXRhKHR4bik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2ltcGxlRGIuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBlbnRyeSBtYXJraW5nIHRoZSBjbGllbnQgYXMgem9tYmllZCBmcm9tIExvY2FsU3RvcmFnZSBzaW5jZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBzdWNjZXNzZnVsbHkgZGVsZXRlZCBpdHMgbWV0YWRhdGEgZnJvbSBJbmRleGVkRGIuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2xpZW50Wm9tYmllZEVudHJ5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGVsZXRlRGF0YSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIFNpbXBsZURiLmRlbGV0ZSh0aGlzLmRiTmFtZSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBjbGllbnRzIHRoYXQgYXJlIG5vdCB6b21iaWVkIGFuZCBoYXZlIGFuIHVwZGF0ZVRpbWUgd2l0aGluIHRoZVxyXG4gICAgICogcHJvdmlkZWQgdGhyZXNob2xkLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZmlsdGVyQWN0aXZlQ2xpZW50cyA9IGZ1bmN0aW9uIChjbGllbnRzLCBhY3Rpdml0eVRocmVzaG9sZE1zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gY2xpZW50cy5maWx0ZXIoZnVuY3Rpb24gKGNsaWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuaXNXaXRoaW5BZ2UoY2xpZW50LnVwZGF0ZVRpbWVNcywgYWN0aXZpdHlUaHJlc2hvbGRNcykgJiZcclxuICAgICAgICAgICAgICAgICFfdGhpcy5pc0NsaWVudFpvbWJpZWQoY2xpZW50LmNsaWVudElkKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZ2V0QWN0aXZlQ2xpZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNpbXBsZURiLnJ1blRyYW5zYWN0aW9uKCdyZWFkb25seScsIFtEYkNsaWVudE1ldGFkYXRhLnN0b3JlXSwgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gY2xpZW50TWV0YWRhdGFTdG9yZSh0eG4pXHJcbiAgICAgICAgICAgICAgICAubG9hZEFsbCgpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoY2xpZW50cykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmZpbHRlckFjdGl2ZUNsaWVudHMoY2xpZW50cywgTUFYX0NMSUVOVF9BR0VfTVMpLm1hcChmdW5jdGlvbiAoY2xpZW50TWV0YWRhdGEpIHsgcmV0dXJuIGNsaWVudE1ldGFkYXRhLmNsaWVudElkOyB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZSwgXCJzdGFydGVkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXJ0ZWQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZ2V0TXV0YXRpb25RdWV1ZSA9IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc3RhcnRlZCwgJ0Nhbm5vdCBpbml0aWFsaXplIE11dGF0aW9uUXVldWUgYmVmb3JlIHBlcnNpc3RlbmNlIGlzIHN0YXJ0ZWQuJyk7XHJcbiAgICAgICAgcmV0dXJuIEluZGV4ZWREYk11dGF0aW9uUXVldWUuZm9yVXNlcih1c2VyLCB0aGlzLnNlcmlhbGl6ZXIsIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRRdWVyeUNhY2hlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnN0YXJ0ZWQsICdDYW5ub3QgaW5pdGlhbGl6ZSBRdWVyeUNhY2hlIGJlZm9yZSBwZXJzaXN0ZW5jZSBpcyBzdGFydGVkLicpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5Q2FjaGU7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmdldFJlbW90ZURvY3VtZW50Q2FjaGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc3RhcnRlZCwgJ0Nhbm5vdCBpbml0aWFsaXplIFJlbW90ZURvY3VtZW50Q2FjaGUgYmVmb3JlIHBlcnNpc3RlbmNlIGlzIHN0YXJ0ZWQuJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUucnVuVHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAoYWN0aW9uLCBtb2RlLCB0cmFuc2FjdGlvbk9wZXJhdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQyLCAnU3RhcnRpbmcgdHJhbnNhY3Rpb246JywgYWN0aW9uKTtcclxuICAgICAgICAvLyBEbyBhbGwgdHJhbnNhY3Rpb25zIGFzIHJlYWR3cml0ZSBhZ2FpbnN0IGFsbCBvYmplY3Qgc3RvcmVzLCBzaW5jZSB3ZVxyXG4gICAgICAgIC8vIGFyZSB0aGUgb25seSByZWFkZXIvd3JpdGVyLlxyXG4gICAgICAgIHJldHVybiB0aGlzLnNpbXBsZURiLnJ1blRyYW5zYWN0aW9uKG1vZGUgPT09ICdyZWFkb25seScgPyAncmVhZG9ubHknIDogJ3JlYWR3cml0ZScsIEFMTF9TVE9SRVMsIGZ1bmN0aW9uIChzaW1wbGVEYlR4bikge1xyXG4gICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JlYWR3cml0ZS1wcmltYXJ5Jykge1xyXG4gICAgICAgICAgICAgICAgLy8gV2hpbGUgd2UgbWVyZWx5IHZlcmlmeSB0aGF0IHdlIGhhdmUgKG9yIGNhbiBhY3F1aXJlKSB0aGUgbGVhc2VcclxuICAgICAgICAgICAgICAgIC8vIGltbWVkaWF0ZWx5LCB3ZSB3YWl0IHRvIGV4dGVuZCB0aGUgcHJpbWFyeSBsZWFzZSB1bnRpbCBhZnRlclxyXG4gICAgICAgICAgICAgICAgLy8gZXhlY3V0aW5nIHRyYW5zYWN0aW9uT3BlcmF0aW9uKCkuIFRoaXMgZW5zdXJlcyB0aGF0IGV2ZW4gaWYgdGhlXHJcbiAgICAgICAgICAgICAgICAvLyB0cmFuc2FjdGlvbk9wZXJhdGlvbiB0YWtlcyBhIGxvbmcgdGltZSwgd2UnbGwgdXNlIGEgcmVjZW50XHJcbiAgICAgICAgICAgICAgICAvLyBsZWFzZVRpbWVzdGFtcE1zIGluIHRoZSBleHRlbmRlZCAob3IgbmV3bHkgYWNxdWlyZWQpIGxlYXNlLlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnZlcmlmeVByaW1hcnlMZWFzZShzaW1wbGVEYlR4bilcclxuICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcihcIkZhaWxlZCB0byBvYnRhaW4gcHJpbWFyeSBsZWFzZSBmb3IgYWN0aW9uICdcIiArIGFjdGlvbiArIFwiJy5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzUHJpbWFyeSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5xdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wcmltYXJ5U3RhdGVMaXN0ZW5lcihmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCBQUklNQVJZX0xFQVNFX0xPU1RfRVJST1JfTVNHKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uT3BlcmF0aW9uKG5ldyBJbmRleGVkRGJUcmFuc2FjdGlvbihzaW1wbGVEYlR4biwgX3RoaXMubGlzdGVuU2VxdWVuY2UubmV4dCgpKSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuYWNxdWlyZU9yRXh0ZW5kUHJpbWFyeUxlYXNlKHNpbXBsZURiVHhuKS5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlc3VsdDsgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy52ZXJpZnlBbGxvd1RhYlN5bmNocm9uaXphdGlvbihzaW1wbGVEYlR4bikubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uT3BlcmF0aW9uKG5ldyBJbmRleGVkRGJUcmFuc2FjdGlvbihzaW1wbGVEYlR4biwgX3RoaXMubGlzdGVuU2VxdWVuY2UubmV4dCgpKSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVmVyaWZpZXMgdGhhdCB0aGUgY3VycmVudCB0YWIgaXMgdGhlIHByaW1hcnkgbGVhc2Vob2xkZXIgb3IgYWx0ZXJuYXRpdmVseVxyXG4gICAgICogdGhhdCB0aGUgbGVhc2Vob2xkZXIgaGFzIG9wdGVkIGludG8gbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi5cclxuICAgICAqL1xyXG4gICAgLy8gVE9ETyhiLzExNDIyNjIzNCk6IFJlbW92ZSB0aGlzIGNoZWNrIHdoZW4gYHN5bmNocm9uaXplVGFic2AgY2FuIG5vIGxvbmdlclxyXG4gICAgLy8gYmUgdHVybmVkIG9mZi5cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS52ZXJpZnlBbGxvd1RhYlN5bmNocm9uaXphdGlvbiA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzdG9yZSA9IHByaW1hcnlDbGllbnRTdG9yZSh0eG4pO1xyXG4gICAgICAgIHJldHVybiBzdG9yZS5nZXQoRGJQcmltYXJ5Q2xpZW50LmtleSkubmV4dChmdW5jdGlvbiAoY3VycmVudFByaW1hcnkpIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnRMZWFzZUlzVmFsaWQgPSBjdXJyZW50UHJpbWFyeSAhPT0gbnVsbCAmJlxyXG4gICAgICAgICAgICAgICAgX3RoaXMuaXNXaXRoaW5BZ2UoY3VycmVudFByaW1hcnkubGVhc2VUaW1lc3RhbXBNcywgTUFYX1BSSU1BUllfRUxJR0lCTEVfQUdFX01TKSAmJlxyXG4gICAgICAgICAgICAgICAgIV90aGlzLmlzQ2xpZW50Wm9tYmllZChjdXJyZW50UHJpbWFyeS5vd25lcklkKTtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRMZWFzZUlzVmFsaWQgJiYgIV90aGlzLmlzTG9jYWxDbGllbnQoY3VycmVudFByaW1hcnkpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRQcmltYXJ5LmFsbG93VGFiU3luY2hyb25pemF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgUFJJTUFSWV9MRUFTRV9FWENMVVNJVkVfRVJST1JfTVNHKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogT2J0YWlucyBvciBleHRlbmRzIHRoZSBuZXcgcHJpbWFyeSBsZWFzZSBmb3IgdGhlIGxvY2FsIGNsaWVudC4gVGhpc1xyXG4gICAgICogbWV0aG9kIGRvZXMgbm90IHZlcmlmeSB0aGF0IHRoZSBjbGllbnQgaXMgZWxpZ2libGUgZm9yIHRoaXMgbGVhc2UuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5hY3F1aXJlT3JFeHRlbmRQcmltYXJ5TGVhc2UgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIG5ld1ByaW1hcnkgPSBuZXcgRGJQcmltYXJ5Q2xpZW50KHRoaXMuY2xpZW50SWQsIHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24sIERhdGUubm93KCkpO1xyXG4gICAgICAgIHJldHVybiBwcmltYXJ5Q2xpZW50U3RvcmUodHhuKS5wdXQoRGJQcmltYXJ5Q2xpZW50LmtleSwgbmV3UHJpbWFyeSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UuaXNBdmFpbGFibGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFNpbXBsZURiLmlzQXZhaWxhYmxlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBHZW5lcmF0ZXMgYSBzdHJpbmcgdXNlZCBhcyBhIHByZWZpeCB3aGVuIHN0b3JpbmcgZGF0YSBpbiBJbmRleGVkREIgYW5kXHJcbiAgICAgKiBMb2NhbFN0b3JhZ2UuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLmJ1aWxkU3RvcmFnZVByZWZpeCA9IGZ1bmN0aW9uIChkYXRhYmFzZUluZm8pIHtcclxuICAgICAgICAvLyBVc2UgdHdvIGRpZmZlcmVudCBwcmVmaXggZm9ybWF0czpcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgKiBmaXJlc3RvcmUgLyBwZXJzaXN0ZW5jZUtleSAvIHByb2plY3RJRCAuIGRhdGFiYXNlSUQgLyAuLi5cclxuICAgICAgICAvLyAgICogZmlyZXN0b3JlIC8gcGVyc2lzdGVuY2VLZXkgLyBwcm9qZWN0SUQgLyAuLi5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIHByb2plY3RJRHMgYXJlIEROUy1jb21wYXRpYmxlIG5hbWVzIGFuZCBjYW5ub3QgY29udGFpbiBkb3RzXHJcbiAgICAgICAgLy8gc28gdGhlcmUncyBubyBkYW5nZXIgb2YgY29sbGlzaW9ucy5cclxuICAgICAgICB2YXIgZGF0YWJhc2UgPSBkYXRhYmFzZUluZm8uZGF0YWJhc2VJZC5wcm9qZWN0SWQ7XHJcbiAgICAgICAgaWYgKCFkYXRhYmFzZUluZm8uZGF0YWJhc2VJZC5pc0RlZmF1bHREYXRhYmFzZSkge1xyXG4gICAgICAgICAgICBkYXRhYmFzZSArPSAnLicgKyBkYXRhYmFzZUluZm8uZGF0YWJhc2VJZC5kYXRhYmFzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICdmaXJlc3RvcmUvJyArIGRhdGFiYXNlSW5mby5wZXJzaXN0ZW5jZUtleSArICcvJyArIGRhdGFiYXNlICsgJy8nO1xyXG4gICAgfTtcclxuICAgIC8qKiBDaGVja3MgdGhlIHByaW1hcnkgbGVhc2UgYW5kIHJlbW92ZXMgaXQgaWYgd2UgYXJlIHRoZSBjdXJyZW50IHByaW1hcnkuICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUucmVsZWFzZVByaW1hcnlMZWFzZUlmSGVsZCA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzdG9yZSA9IHByaW1hcnlDbGllbnRTdG9yZSh0eG4pO1xyXG4gICAgICAgIHJldHVybiBzdG9yZS5nZXQoRGJQcmltYXJ5Q2xpZW50LmtleSkubmV4dChmdW5jdGlvbiAocHJpbWFyeUNsaWVudCkge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuaXNMb2NhbENsaWVudChwcmltYXJ5Q2xpZW50KSkge1xyXG4gICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQyLCAnUmVsZWFzaW5nIHByaW1hcnkgbGVhc2UuJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RvcmUuZGVsZXRlKERiUHJpbWFyeUNsaWVudC5rZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogVmVyaWZpZXMgdGhhdCBgdXBkYXRlVGltZU1zYCBpcyB3aXRoaW4gYG1heEFnZU1zYC4gKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5pc1dpdGhpbkFnZSA9IGZ1bmN0aW9uICh1cGRhdGVUaW1lTXMsIG1heEFnZU1zKSB7XHJcbiAgICAgICAgdmFyIG5vdyA9IERhdGUubm93KCk7XHJcbiAgICAgICAgdmFyIG1pbkFjY2VwdGFibGUgPSBub3cgLSBtYXhBZ2VNcztcclxuICAgICAgICB2YXIgbWF4QWNjZXB0YWJsZSA9IG5vdztcclxuICAgICAgICBpZiAodXBkYXRlVGltZU1zIDwgbWluQWNjZXB0YWJsZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHVwZGF0ZVRpbWVNcyA+IG1heEFjY2VwdGFibGUpIHtcclxuICAgICAgICAgICAgZXJyb3IoXCJEZXRlY3RlZCBhbiB1cGRhdGUgdGltZSB0aGF0IGlzIGluIHRoZSBmdXR1cmU6IFwiICsgdXBkYXRlVGltZU1zICsgXCIgPiBcIiArIG1heEFjY2VwdGFibGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5hdHRhY2hWaXNpYmlsaXR5SGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLmRvY3VtZW50ICE9PSBudWxsICYmXHJcbiAgICAgICAgICAgIHR5cGVvZiB0aGlzLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgdGhpcy5kb2N1bWVudFZpc2liaWxpdHlIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5Gb3JlZ3JvdW5kID0gX3RoaXMuZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09PSAndmlzaWJsZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZUNsaWVudE1ldGFkYXRhQW5kVHJ5QmVjb21lUHJpbWFyeSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndmlzaWJpbGl0eWNoYW5nZScsIHRoaXMuZG9jdW1lbnRWaXNpYmlsaXR5SGFuZGxlcik7XHJcbiAgICAgICAgICAgIHRoaXMuaW5Gb3JlZ3JvdW5kID0gdGhpcy5kb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT09ICd2aXNpYmxlJztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmRldGFjaFZpc2liaWxpdHlIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRvY3VtZW50VmlzaWJpbGl0eUhhbmRsZXIpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KHRoaXMuZG9jdW1lbnQgIT09IG51bGwgJiZcclxuICAgICAgICAgICAgICAgIHR5cGVvZiB0aGlzLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicsIFwiRXhwZWN0ZWQgJ2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXInIHRvIGJlIGEgZnVuY3Rpb25cIik7XHJcbiAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndmlzaWJpbGl0eWNoYW5nZScsIHRoaXMuZG9jdW1lbnRWaXNpYmlsaXR5SGFuZGxlcik7XHJcbiAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRWaXNpYmlsaXR5SGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQXR0YWNoZXMgYSB3aW5kb3cudW5sb2FkIGhhbmRsZXIgdGhhdCB3aWxsIHN5bmNocm9ub3VzbHkgd3JpdGUgb3VyXHJcbiAgICAgKiBjbGllbnRJZCB0byBhIFwiem9tYmllIGNsaWVudCBpZFwiIGxvY2F0aW9uIGluIExvY2FsU3RvcmFnZS4gVGhpcyBjYW4gYmUgdXNlZFxyXG4gICAgICogYnkgdGFicyB0cnlpbmcgdG8gYWNxdWlyZSB0aGUgcHJpbWFyeSBsZWFzZSB0byBkZXRlcm1pbmUgdGhhdCB0aGUgbGVhc2VcclxuICAgICAqIGlzIG5vIGxvbmdlciB2YWxpZCBldmVuIGlmIHRoZSB0aW1lc3RhbXAgaXMgcmVjZW50LiBUaGlzIGlzIHBhcnRpY3VsYXJseVxyXG4gICAgICogaW1wb3J0YW50IGZvciB0aGUgcmVmcmVzaCBjYXNlIChzbyB0aGUgdGFiIGNvcnJlY3RseSByZS1hY3F1aXJlcyB0aGVcclxuICAgICAqIHByaW1hcnkgbGVhc2UpLiBMb2NhbFN0b3JhZ2UgaXMgdXNlZCBmb3IgdGhpcyByYXRoZXIgdGhhbiBJbmRleGVkRGIgYmVjYXVzZVxyXG4gICAgICogaXQgaXMgYSBzeW5jaHJvbm91cyBBUEkgYW5kIHNvIGNhbiBiZSB1c2VkIHJlbGlhYmx5IGZyb20gIGFuIHVubG9hZFxyXG4gICAgICogaGFuZGxlci5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmF0dGFjaFdpbmRvd1VubG9hZEhvb2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodHlwZW9mIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3dVbmxvYWRIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gTm90ZTogSW4gdGhlb3J5LCB0aGlzIHNob3VsZCBiZSBzY2hlZHVsZWQgb24gdGhlIEFzeW5jUXVldWUgc2luY2UgaXRcclxuICAgICAgICAgICAgICAgIC8vIGFjY2Vzc2VzIGludGVybmFsIHN0YXRlLiBXZSBleGVjdXRlIHRoaXMgY29kZSBkaXJlY3RseSBkdXJpbmcgc2h1dGRvd25cclxuICAgICAgICAgICAgICAgIC8vIHRvIG1ha2Ugc3VyZSBpdCBnZXRzIGEgY2hhbmNlIHRvIHJ1bi5cclxuICAgICAgICAgICAgICAgIF90aGlzLm1hcmtDbGllbnRab21iaWVkKCk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5xdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IGdyYWNlZnVsIHNodXRkb3duIChpbmNsdWRpbmcgcmVsZWFzaW5nIG91ciBwcmltYXJ5IGxlYXNlKSxcclxuICAgICAgICAgICAgICAgICAgICAvLyBidXQgdGhlcmUncyBubyBndWFyYW50ZWUgaXQgd2lsbCBjb21wbGV0ZS5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc2h1dGRvd24oKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCB0aGlzLndpbmRvd1VubG9hZEhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZGV0YWNoV2luZG93VW5sb2FkSG9vayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy53aW5kb3dVbmxvYWRIYW5kbGVyKSB7XHJcbiAgICAgICAgICAgIGFzc2VydCh0eXBlb2YgdGhpcy53aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJywgXCJFeHBlY3RlZCAnd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXInIHRvIGJlIGEgZnVuY3Rpb25cIik7XHJcbiAgICAgICAgICAgIHRoaXMud2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3VubG9hZCcsIHRoaXMud2luZG93VW5sb2FkSGFuZGxlcik7XHJcbiAgICAgICAgICAgIHRoaXMud2luZG93VW5sb2FkSGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB3aGV0aGVyIGEgY2xpZW50IGlzIFwiem9tYmllZFwiIGJhc2VkIG9uIGl0cyBMb2NhbFN0b3JhZ2UgZW50cnkuXHJcbiAgICAgKiBDbGllbnRzIGJlY29tZSB6b21iaWVkIHdoZW4gdGhlaXIgdGFiIGNsb3NlcyB3aXRob3V0IHJ1bm5pbmcgYWxsIG9mIHRoZVxyXG4gICAgICogY2xlYW51cCBsb2dpYyBpbiBgc2h1dGRvd24oKWAuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5pc0NsaWVudFpvbWJpZWQgPSBmdW5jdGlvbiAoY2xpZW50SWQpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2YXIgaXNab21iaWVkID0gdGhpcy53ZWJTdG9yYWdlLmdldEl0ZW0odGhpcy56b21iaWVkQ2xpZW50TG9jYWxTdG9yYWdlS2V5KGNsaWVudElkKSkgIT09XHJcbiAgICAgICAgICAgICAgICBudWxsO1xyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDIsIFwiQ2xpZW50ICdcIiArIGNsaWVudElkICsgXCInIFwiICsgKGlzWm9tYmllZCA/ICdpcycgOiAnaXMgbm90JykgKyBcIiB6b21iaWVkIGluIExvY2FsU3RvcmFnZVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGlzWm9tYmllZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgLy8gR3JhY2VmdWxseSBoYW5kbGUgaWYgTG9jYWxTdG9yYWdlIGlzbid0IHdvcmtpbmcuXHJcbiAgICAgICAgICAgIGVycm9yKExPR19UQUckMiwgJ0ZhaWxlZCB0byBnZXQgem9tYmllZCBjbGllbnQgaWQuJywgZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZWNvcmQgY2xpZW50IGFzIHpvbWJpZWQgKGEgY2xpZW50IHRoYXQgaGFkIGl0cyB0YWIgY2xvc2VkKS4gWm9tYmllZFxyXG4gICAgICogY2xpZW50cyBhcmUgaWdub3JlZCBkdXJpbmcgcHJpbWFyeSB0YWIgc2VsZWN0aW9uLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUubWFya0NsaWVudFpvbWJpZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdGhpcy53ZWJTdG9yYWdlLnNldEl0ZW0odGhpcy56b21iaWVkQ2xpZW50TG9jYWxTdG9yYWdlS2V5KHRoaXMuY2xpZW50SWQpLCBTdHJpbmcoRGF0ZS5ub3coKSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3QgYXZhaWxhYmxlIC8gd29ya2luZy5cclxuICAgICAgICAgICAgZXJyb3IoJ0ZhaWxlZCB0byBzZXQgem9tYmllIGNsaWVudCBpZC4nLCBlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIFJlbW92ZXMgdGhlIHpvbWJpZWQgY2xpZW50IGVudHJ5IGlmIGl0IGV4aXN0cy4gKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5yZW1vdmVDbGllbnRab21iaWVkRW50cnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdGhpcy53ZWJTdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy56b21iaWVkQ2xpZW50TG9jYWxTdG9yYWdlS2V5KHRoaXMuY2xpZW50SWQpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgLy8gSWdub3JlXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS56b21iaWVkQ2xpZW50TG9jYWxTdG9yYWdlS2V5ID0gZnVuY3Rpb24gKGNsaWVudElkKSB7XHJcbiAgICAgICAgcmV0dXJuIFpPTUJJRURfQ0xJRU5UU19LRVlfUFJFRklYICsgXCJfXCIgKyB0aGlzLnBlcnNpc3RlbmNlS2V5ICsgXCJfXCIgKyBjbGllbnRJZDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBuYW1lIG9mIHRoZSBtYWluIChhbmQgY3VycmVudGx5IG9ubHkpIEluZGV4ZWREQiBkYXRhYmFzZS4gdGhpcyBuYW1lIGlzXHJcbiAgICAgKiBhcHBlbmRlZCB0byB0aGUgcHJlZml4IHByb3ZpZGVkIHRvIHRoZSBJbmRleGVkRGJQZXJzaXN0ZW5jZSBjb25zdHJ1Y3Rvci5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UuTUFJTl9EQVRBQkFTRSA9ICdtYWluJztcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZTtcclxufSgpKTtcclxuZnVuY3Rpb24gaXNQcmltYXJ5TGVhc2VMb3N0RXJyb3IoZXJyKSB7XHJcbiAgICByZXR1cm4gKGVyci5jb2RlID09PSBDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04gJiZcclxuICAgICAgICBlcnIubWVzc2FnZSA9PT0gUFJJTUFSWV9MRUFTRV9MT1NUX0VSUk9SX01TRyk7XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgcHJpbWFyeSBjbGllbnQgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gcHJpbWFyeUNsaWVudFN0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIHR4bi5zdG9yZShEYlByaW1hcnlDbGllbnQuc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGNsaWVudCBtZXRhZGF0YSBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiBjbGllbnRNZXRhZGF0YVN0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIHR4bi5zdG9yZShEYkNsaWVudE1ldGFkYXRhLnN0b3JlKTtcclxufVxyXG4vKiogUHJvdmlkZXMgTFJVIGZ1bmN0aW9uYWxpdHkgZm9yIEluZGV4ZWREQiBwZXJzaXN0ZW5jZS4gKi9cclxudmFyIEluZGV4ZWREYkxydURlbGVnYXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSW5kZXhlZERiTHJ1RGVsZWdhdGUoZGIpIHtcclxuICAgICAgICB0aGlzLmRiID0gZGI7XHJcbiAgICAgICAgdGhpcy5nYXJiYWdlQ29sbGVjdG9yID0gbmV3IExydUdhcmJhZ2VDb2xsZWN0b3IodGhpcyk7XHJcbiAgICB9XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuZ2V0VGFyZ2V0Q291bnQgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0UXVlcnlDYWNoZSgpLmdldFF1ZXJ5Q291bnQodHhuKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuZm9yRWFjaFRhcmdldCA9IGZ1bmN0aW9uICh0eG4sIGYpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRRdWVyeUNhY2hlKCkuZm9yRWFjaFRhcmdldCh0eG4sIGYpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5mb3JFYWNoT3JwaGFuZWREb2N1bWVudFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKHR4biwgZikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZvckVhY2hPcnBoYW5lZERvY3VtZW50KHR4biwgZnVuY3Rpb24gKGRvY0tleSwgc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGYoc2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5zZXRJbk1lbW9yeVBpbnMgPSBmdW5jdGlvbiAoaW5NZW1vcnlQaW5zKSB7XHJcbiAgICAgICAgdGhpcy5pbk1lbW9yeVBpbnMgPSBpbk1lbW9yeVBpbnM7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLmFkZFJlZmVyZW5jZSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHJldHVybiB3cml0ZVNlbnRpbmVsS2V5KHR4biwga2V5KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlUmVmZXJlbmNlID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHdyaXRlU2VudGluZWxLZXkodHhuLCBrZXkpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVUYXJnZXRzID0gZnVuY3Rpb24gKHR4biwgdXBwZXJCb3VuZCwgYWN0aXZlVGFyZ2V0SWRzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGJcclxuICAgICAgICAgICAgLmdldFF1ZXJ5Q2FjaGUoKVxyXG4gICAgICAgICAgICAucmVtb3ZlVGFyZ2V0cyh0eG4sIHVwcGVyQm91bmQsIGFjdGl2ZVRhcmdldElkcyk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZU11dGF0aW9uUmVmZXJlbmNlID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHdyaXRlU2VudGluZWxLZXkodHhuLCBrZXkpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIGFueXRoaW5nIHdvdWxkIHByZXZlbnQgdGhpcyBkb2N1bWVudCBmcm9tIGJlaW5nIGdhcmJhZ2VcclxuICAgICAqIGNvbGxlY3RlZCwgZ2l2ZW4gdGhhdCB0aGUgZG9jdW1lbnQgaW4gcXVlc3Rpb24gaXMgbm90IHByZXNlbnQgaW4gYW55XHJcbiAgICAgKiB0YXJnZXRzIGFuZCBoYXMgYSBzZXF1ZW5jZSBudW1iZXIgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSB1cHBlciBib3VuZCBmb3JcclxuICAgICAqIHRoZSBjb2xsZWN0aW9uIHJ1bi5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLmlzUGlubmVkID0gZnVuY3Rpb24gKHR4biwgZG9jS2V5KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaW5NZW1vcnlQaW5zLmNvbnRhaW5zS2V5KGRvY0tleSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9uUXVldWVzQ29udGFpbktleSh0eG4sIGRvY0tleSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVPcnBoYW5lZERvY3VtZW50cyA9IGZ1bmN0aW9uICh0eG4sIHVwcGVyQm91bmQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgICAgdmFyIGJ5dGVzUmVtb3ZlZCA9IDA7XHJcbiAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgdmFyIGl0ZXJhdGlvbiA9IHRoaXMuZm9yRWFjaE9ycGhhbmVkRG9jdW1lbnQodHhuLCBmdW5jdGlvbiAoZG9jS2V5LCBzZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICBpZiAoc2VxdWVuY2VOdW1iZXIgPD0gdXBwZXJCb3VuZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHAgPSBfdGhpcy5pc1Bpbm5lZCh0eG4sIGRvY0tleSkubmV4dChmdW5jdGlvbiAoaXNQaW5uZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzUGlubmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW1vdmVPcnBoYW5lZERvY3VtZW50KHR4biwgZG9jS2V5KS5uZXh0KGZ1bmN0aW9uIChkb2N1bWVudEJ5dGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlc1JlbW92ZWQgKz0gZG9jdW1lbnRCeXRlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gV2FpdCBmb3IgaXRlcmF0aW9uIGZpcnN0IHRvIG1ha2Ugc3VyZSB3ZSBoYXZlIGEgY2hhbmNlIHRvIGFkZCBhbGwgb2YgdGhlXHJcbiAgICAgICAgLy8gcmVtb3ZhbCBwcm9taXNlcyB0byB0aGUgYXJyYXkuXHJcbiAgICAgICAgcmV0dXJuIGl0ZXJhdGlvblxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcyk7IH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmRiLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKS51cGRhdGVTaXplKHR4biwgLWJ5dGVzUmVtb3ZlZCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gY291bnQ7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2xlYXJzIGEgZG9jdW1lbnQgZnJvbSB0aGUgY2FjaGUuIFRoZSBkb2N1bWVudCBpcyBhc3N1bWVkIHRvIGJlIG9ycGhhbmVkLCBzbyB0YXJnZXQtZG9jdW1lbnRcclxuICAgICAqIGFzc29jaWF0aW9ucyBhcmUgbm90IHF1ZXJpZWQuIFdlIHJlbW92ZSBpdCBmcm9tIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUsIGFzIHdlbGwgYXMgcmVtb3ZlXHJcbiAgICAgKiBpdHMgc2VudGluZWwgcm93LlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlT3JwaGFuZWREb2N1bWVudCA9IGZ1bmN0aW9uICh0eG4sIGRvY0tleSkge1xyXG4gICAgICAgIHZhciB0b3RhbEJ5dGVzUmVtb3ZlZCA9IDA7XHJcbiAgICAgICAgdmFyIGRvY3VtZW50Q2FjaGUgPSB0aGlzLmRiLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IoW1xyXG4gICAgICAgICAgICBkb2N1bWVudFRhcmdldFN0b3JlKHR4bikuZGVsZXRlKHNlbnRpbmVsS2V5KGRvY0tleSkpLFxyXG4gICAgICAgICAgICBkb2N1bWVudENhY2hlLnJlbW92ZUVudHJ5KHR4biwgZG9jS2V5KS5uZXh0KGZ1bmN0aW9uIChieXRlc1JlbW92ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXNSZW1vdmVkICs9IGJ5dGVzUmVtb3ZlZDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICBdKS5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRvdGFsQnl0ZXNSZW1vdmVkOyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlVGFyZ2V0ID0gZnVuY3Rpb24gKHR4biwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdmFyIHVwZGF0ZWQgPSBxdWVyeURhdGEuY29weSh7XHJcbiAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyOiB0eG4uY3VycmVudFNlcXVlbmNlTnVtYmVyXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0UXVlcnlDYWNoZSgpLnVwZGF0ZVF1ZXJ5RGF0YSh0eG4sIHVwZGF0ZWQpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS51cGRhdGVMaW1ib0RvY3VtZW50ID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHdyaXRlU2VudGluZWxLZXkodHhuLCBrZXkpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2FsbCBwcm92aWRlZCBmdW5jdGlvbiBmb3IgZWFjaCBkb2N1bWVudCBpbiB0aGUgY2FjaGUgdGhhdCBpcyAnb3JwaGFuZWQnLiBPcnBoYW5lZFxyXG4gICAgICogbWVhbnMgbm90IGEgcGFydCBvZiBhbnkgdGFyZ2V0LCBzbyB0aGUgb25seSBlbnRyeSBpbiB0aGUgdGFyZ2V0LWRvY3VtZW50IGluZGV4IGZvclxyXG4gICAgICogdGhhdCBkb2N1bWVudCB3aWxsIGJlIHRoZSBzZW50aW5lbCByb3cgKHRhcmdldElkIDApLCB3aGljaCB3aWxsIGFsc28gaGF2ZSB0aGUgc2VxdWVuY2VcclxuICAgICAqIG51bWJlciBmb3IgdGhlIGxhc3QgdGltZSB0aGUgZG9jdW1lbnQgd2FzIGFjY2Vzc2VkLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuZm9yRWFjaE9ycGhhbmVkRG9jdW1lbnQgPSBmdW5jdGlvbiAodHhuLCBmKSB7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gZG9jdW1lbnRUYXJnZXRTdG9yZSh0eG4pO1xyXG4gICAgICAgIHZhciBuZXh0VG9SZXBvcnQgPSBMaXN0ZW5TZXF1ZW5jZS5JTlZBTElEO1xyXG4gICAgICAgIHZhciBuZXh0UGF0aDtcclxuICAgICAgICByZXR1cm4gc3RvcmVcclxuICAgICAgICAgICAgLml0ZXJhdGUoe1xyXG4gICAgICAgICAgICBpbmRleDogRGJUYXJnZXREb2N1bWVudC5kb2N1bWVudFRhcmdldHNJbmRleFxyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChfYSwgX2IpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldElkID0gX2FbMF0sIGRvY0tleSA9IF9hWzFdO1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IF9iLnBhdGgsIHNlcXVlbmNlTnVtYmVyID0gX2Iuc2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXRJZCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgbmV4dFRvUmVwb3J0IGlzIHZhbGlkLCByZXBvcnQgaXQsIHRoaXMgaXMgYSBuZXcga2V5IHNvIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gbGFzdCBvbmUgbXVzdCBub3QgYmUgYSBtZW1iZXIgb2YgYW55IHRhcmdldHMuXHJcbiAgICAgICAgICAgICAgICBpZiAobmV4dFRvUmVwb3J0ICE9PSBMaXN0ZW5TZXF1ZW5jZS5JTlZBTElEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZihuZXcgRG9jdW1lbnRLZXkoZGVjb2RlJDEobmV4dFBhdGgpKSwgbmV4dFRvUmVwb3J0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHNldCBuZXh0VG9SZXBvcnQgdG8gYmUgdGhpcyBzZXF1ZW5jZSBudW1iZXIuIEl0J3MgdGhlIG5leHQgb25lIHdlXHJcbiAgICAgICAgICAgICAgICAvLyBtaWdodCByZXBvcnQsIGlmIHdlIGRvbid0IGZpbmQgYW55IHRhcmdldHMgZm9yIHRoaXMgZG9jdW1lbnQuXHJcbiAgICAgICAgICAgICAgICAvLyBOb3RlIHRoYXQgdGhlIHNlcXVlbmNlIG51bWJlciBtdXN0IGJlIGRlZmluZWQgd2hlbiB0aGUgdGFyZ2V0SWRcclxuICAgICAgICAgICAgICAgIC8vIGlzIDAuXHJcbiAgICAgICAgICAgICAgICBuZXh0VG9SZXBvcnQgPSBzZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICAgICAgICAgIG5leHRQYXRoID0gcGF0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIHNldCBuZXh0VG9SZXBvcnQgdG8gYmUgaW52YWxpZCwgd2Uga25vdyB3ZSBkb24ndCBuZWVkIHRvIHJlcG9ydFxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBvbmUgc2luY2Ugd2UgZm91bmQgYSB0YXJnZXQgZm9yIGl0LlxyXG4gICAgICAgICAgICAgICAgbmV4dFRvUmVwb3J0ID0gTGlzdGVuU2VxdWVuY2UuSU5WQUxJRDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gU2luY2Ugd2UgcmVwb3J0IHNlcXVlbmNlIG51bWJlcnMgYWZ0ZXIgZ2V0dGluZyB0byB0aGUgbmV4dCBrZXksIHdlXHJcbiAgICAgICAgICAgIC8vIG5lZWQgdG8gY2hlY2sgaWYgdGhlIGxhc3Qga2V5IHdlIGl0ZXJhdGVkIG92ZXIgd2FzIGFuIG9ycGhhbmVkXHJcbiAgICAgICAgICAgIC8vIGRvY3VtZW50IGFuZCByZXBvcnQgaXQuXHJcbiAgICAgICAgICAgIGlmIChuZXh0VG9SZXBvcnQgIT09IExpc3RlblNlcXVlbmNlLklOVkFMSUQpIHtcclxuICAgICAgICAgICAgICAgIGYobmV3IERvY3VtZW50S2V5KGRlY29kZSQxKG5leHRQYXRoKSksIG5leHRUb1JlcG9ydCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gSW5kZXhlZERiTHJ1RGVsZWdhdGU7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIHNlbnRpbmVsS2V5KGtleSkge1xyXG4gICAgcmV0dXJuIFswLCBlbmNvZGUoa2V5LnBhdGgpXTtcclxufVxyXG4vKipcclxuICogQHJldHVybiBBIHZhbHVlIHN1aXRhYmxlIGZvciB3cml0aW5nIGEgc2VudGluZWwgcm93IGluIHRoZSB0YXJnZXQtZG9jdW1lbnRcclxuICogc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiBzZW50aW5lbFJvdyhrZXksIHNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICByZXR1cm4gbmV3IERiVGFyZ2V0RG9jdW1lbnQoMCwgZW5jb2RlKGtleS5wYXRoKSwgc2VxdWVuY2VOdW1iZXIpO1xyXG59XHJcbmZ1bmN0aW9uIHdyaXRlU2VudGluZWxLZXkodHhuLCBrZXkpIHtcclxuICAgIHJldHVybiBkb2N1bWVudFRhcmdldFN0b3JlKHR4bikucHV0KHNlbnRpbmVsUm93KGtleSwgdHhuLmN1cnJlbnRTZXF1ZW5jZU51bWJlcikpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQSByZWFkb25seSB2aWV3IG9mIHRoZSBsb2NhbCBzdGF0ZSBvZiBhbGwgZG9jdW1lbnRzIHdlJ3JlIHRyYWNraW5nIChpLmUuIHdlXHJcbiAqIGhhdmUgYSBjYWNoZWQgdmVyc2lvbiBpbiByZW1vdGVEb2N1bWVudENhY2hlIG9yIGxvY2FsIG11dGF0aW9ucyBmb3IgdGhlXHJcbiAqIGRvY3VtZW50KS4gVGhlIHZpZXcgaXMgY29tcHV0ZWQgYnkgYXBwbHlpbmcgdGhlIG11dGF0aW9ucyBpbiB0aGVcclxuICogTXV0YXRpb25RdWV1ZSB0byB0aGUgUmVtb3RlRG9jdW1lbnRDYWNoZS5cclxuICovXHJcbnZhciBMb2NhbERvY3VtZW50c1ZpZXcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMb2NhbERvY3VtZW50c1ZpZXcocmVtb3RlRG9jdW1lbnRDYWNoZSwgbXV0YXRpb25RdWV1ZSkge1xyXG4gICAgICAgIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZSA9IHJlbW90ZURvY3VtZW50Q2FjaGU7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudCBpZGVudGlmaWVkIGJ5IGBrZXlgLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm4gTG9jYWwgdmlldyBvZiB0aGUgZG9jdW1lbnQgb3IgbnVsbCBpZiB3ZSBkb24ndCBoYXZlIGFueSBjYWNoZWRcclxuICAgICAqIHN0YXRlIGZvciBpdC5cclxuICAgICAqL1xyXG4gICAgTG9jYWxEb2N1bWVudHNWaWV3LnByb3RvdHlwZS5nZXREb2N1bWVudCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwga2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvblF1ZXVlXHJcbiAgICAgICAgICAgIC5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSh0cmFuc2FjdGlvbiwga2V5KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoYmF0Y2hlcykgeyByZXR1cm4gX3RoaXMuZ2V0RG9jdW1lbnRJbnRlcm5hbCh0cmFuc2FjdGlvbiwga2V5LCBiYXRjaGVzKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEludGVybmFsIHZlcnNpb24gb2YgYGdldERvY3VtZW50YCB0aGF0IGFsbG93cyByZXVzaW5nIGJhdGNoZXMuICovXHJcbiAgICBMb2NhbERvY3VtZW50c1ZpZXcucHJvdG90eXBlLmdldERvY3VtZW50SW50ZXJuYWwgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGtleSwgaW5CYXRjaGVzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSh0cmFuc2FjdGlvbiwga2V5KS5uZXh0KGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBpbkJhdGNoZXNfMSA9IGluQmF0Y2hlczsgX2kgPCBpbkJhdGNoZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBiYXRjaCA9IGluQmF0Y2hlc18xW19pXTtcclxuICAgICAgICAgICAgICAgIGRvYyA9IGJhdGNoLmFwcGx5VG9Mb2NhbFZpZXcoa2V5LCBkb2MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBkb2M7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudHMgaWRlbnRpZmllZCBieSBga2V5c2AuXHJcbiAgICAgKlxyXG4gICAgICogSWYgd2UgZG9uJ3QgaGF2ZSBjYWNoZWQgc3RhdGUgZm9yIGEgZG9jdW1lbnQgaW4gYGtleXNgLCBhIE5vRG9jdW1lbnQgd2lsbFxyXG4gICAgICogYmUgc3RvcmVkIGZvciB0aGF0IGtleSBpbiB0aGUgcmVzdWx0aW5nIHNldC5cclxuICAgICAqL1xyXG4gICAgTG9jYWxEb2N1bWVudHNWaWV3LnByb3RvdHlwZS5nZXREb2N1bWVudHMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGtleXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm11dGF0aW9uUXVldWVcclxuICAgICAgICAgICAgLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5cyh0cmFuc2FjdGlvbiwga2V5cylcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGJhdGNoZXMpIHtcclxuICAgICAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgICAgIHZhciByZXN1bHRzID0gbWF5YmVEb2N1bWVudE1hcCgpO1xyXG4gICAgICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChfdGhpcy5nZXREb2N1bWVudEludGVybmFsKHRyYW5zYWN0aW9uLCBrZXksIGJhdGNoZXMpLm5leHQoZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhodHRwOi8vYi8zMjI3NTM3OCk6IERvbid0IGNvbmZsYXRlIG1pc3NpbmcgLyBkZWxldGVkLlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbWF5YmVEb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF5YmVEb2MgPSBuZXcgTm9Eb2N1bWVudChrZXksIFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5pbnNlcnQoa2V5LCBtYXliZURvYyk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0czsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFBlcmZvcm1zIGEgcXVlcnkgYWdhaW5zdCB0aGUgbG9jYWwgdmlldyBvZiBhbGwgZG9jdW1lbnRzLiAqL1xyXG4gICAgTG9jYWxEb2N1bWVudHNWaWV3LnByb3RvdHlwZS5nZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeSkge1xyXG4gICAgICAgIGlmIChEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5KHF1ZXJ5LnBhdGgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldERvY3VtZW50c01hdGNoaW5nRG9jdW1lbnRRdWVyeSh0cmFuc2FjdGlvbiwgcXVlcnkucGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXREb2N1bWVudHNNYXRjaGluZ0NvbGxlY3Rpb25RdWVyeSh0cmFuc2FjdGlvbiwgcXVlcnkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBMb2NhbERvY3VtZW50c1ZpZXcucHJvdG90eXBlLmdldERvY3VtZW50c01hdGNoaW5nRG9jdW1lbnRRdWVyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jUGF0aCkge1xyXG4gICAgICAgIC8vIEp1c3QgZG8gYSBzaW1wbGUgZG9jdW1lbnQgbG9va3VwLlxyXG4gICAgICAgIHJldHVybiB0aGlzLmdldERvY3VtZW50KHRyYW5zYWN0aW9uLCBuZXcgRG9jdW1lbnRLZXkoZG9jUGF0aCkpLm5leHQoZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBkb2N1bWVudE1hcCgpO1xyXG4gICAgICAgICAgICBpZiAobWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0Lmluc2VydChtYXliZURvYy5rZXksIG1heWJlRG9jKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIExvY2FsRG9jdW1lbnRzVmlldy5wcm90b3R5cGUuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdDb2xsZWN0aW9uUXVlcnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBRdWVyeSB0aGUgcmVtb3RlIGRvY3VtZW50cyBhbmQgb3ZlcmxheSBtdXRhdGlvbnMuXHJcbiAgICAgICAgdmFyIHJlc3VsdHM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZVxyXG4gICAgICAgICAgICAuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0cmFuc2FjdGlvbiwgcXVlcnkpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChxdWVyeVJlc3VsdHMpIHtcclxuICAgICAgICAgICAgcmVzdWx0cyA9IHF1ZXJ5UmVzdWx0cztcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkodHJhbnNhY3Rpb24sIHF1ZXJ5KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAobWF0Y2hpbmdNdXRhdGlvbkJhdGNoZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBtYXRjaGluZ011dGF0aW9uQmF0Y2hlc18xID0gbWF0Y2hpbmdNdXRhdGlvbkJhdGNoZXM7IF9pIDwgbWF0Y2hpbmdNdXRhdGlvbkJhdGNoZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBiYXRjaCA9IG1hdGNoaW5nTXV0YXRpb25CYXRjaGVzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBfYiA9IGJhdGNoLm11dGF0aW9uczsgX2EgPCBfYi5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbXV0YXRpb24gPSBfYltfYV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IG11dGF0aW9uLmtleTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHByb2Nlc3MgZG9jdW1lbnRzIGJlbG9uZ2luZyB0byB0aGUgY29sbGVjdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5LnBhdGguaXNJbW1lZGlhdGVQYXJlbnRPZihrZXkucGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiYXNlRG9jID0gcmVzdWx0cy5nZXQoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbXV0YXRlZERvYyA9IG11dGF0aW9uLmFwcGx5VG9Mb2NhbFZpZXcoYmFzZURvYywgYmFzZURvYywgYmF0Y2gubG9jYWxXcml0ZVRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtdXRhdGVkRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuaW5zZXJ0KGtleSwgbXV0YXRlZERvYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5yZW1vdmUoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIEZpbmFsbHksIGZpbHRlciBvdXQgYW55IGRvY3VtZW50cyB0aGF0IGRvbid0IGFjdHVhbGx5IG1hdGNoXHJcbiAgICAgICAgICAgIC8vIHRoZSBxdWVyeS5cclxuICAgICAgICAgICAgcmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIGRvYykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFxdWVyeS5tYXRjaGVzKGRvYykpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5yZW1vdmUoa2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBMb2NhbERvY3VtZW50c1ZpZXc7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQSBjb2xsZWN0aW9uIG9mIHJlZmVyZW5jZXMgdG8gYSBkb2N1bWVudCBmcm9tIHNvbWUga2luZCBvZiBudW1iZXJlZCBlbnRpdHlcclxuICogKGVpdGhlciBhIHRhcmdldCBJRCBvciBiYXRjaCBJRCkuIEFzIHJlZmVyZW5jZXMgYXJlIGFkZGVkIHRvIG9yIHJlbW92ZWQgZnJvbVxyXG4gKiB0aGUgc2V0IGNvcnJlc3BvbmRpbmcgZXZlbnRzIGFyZSBlbWl0dGVkIHRvIGEgcmVnaXN0ZXJlZCBnYXJiYWdlIGNvbGxlY3Rvci5cclxuICpcclxuICogRWFjaCByZWZlcmVuY2UgaXMgcmVwcmVzZW50ZWQgYnkgYSBEb2N1bWVudFJlZmVyZW5jZSBvYmplY3QuIEVhY2ggb2YgdGhlbVxyXG4gKiBjb250YWlucyBlbm91Z2ggaW5mb3JtYXRpb24gdG8gdW5pcXVlbHkgaWRlbnRpZnkgdGhlIHJlZmVyZW5jZS4gVGhleSBhcmUgYWxsXHJcbiAqIHN0b3JlZCBwcmltYXJpbHkgaW4gYSBzZXQgc29ydGVkIGJ5IGtleS4gQSBkb2N1bWVudCBpcyBjb25zaWRlcmVkIGdhcmJhZ2UgaWZcclxuICogdGhlcmUncyBubyByZWZlcmVuY2VzIGluIHRoYXQgc2V0ICh0aGlzIGNhbiBiZSBlZmZpY2llbnRseSBjaGVja2VkIHRoYW5rcyB0b1xyXG4gKiBzb3J0aW5nIGJ5IGtleSkuXHJcbiAqXHJcbiAqIFJlZmVyZW5jZVNldCBhbHNvIGtlZXBzIGEgc2Vjb25kYXJ5IHNldCB0aGF0IGNvbnRhaW5zIHJlZmVyZW5jZXMgc29ydGVkIGJ5XHJcbiAqIElEcy4gVGhpcyBvbmUgaXMgdXNlZCB0byBlZmZpY2llbnRseSBpbXBsZW1lbnQgcmVtb3ZhbCBvZiBhbGwgcmVmZXJlbmNlcyBieVxyXG4gKiBzb21lIHRhcmdldCBJRC5cclxuICovXHJcbnZhciBSZWZlcmVuY2VTZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZWZlcmVuY2VTZXQoKSB7XHJcbiAgICAgICAgLy8gQSBzZXQgb2Ygb3V0c3RhbmRpbmcgcmVmZXJlbmNlcyB0byBhIGRvY3VtZW50IHNvcnRlZCBieSBrZXkuXHJcbiAgICAgICAgdGhpcy5yZWZzQnlLZXkgPSBuZXcgU29ydGVkU2V0KERvY1JlZmVyZW5jZS5jb21wYXJlQnlLZXkpO1xyXG4gICAgICAgIC8vIEEgc2V0IG9mIG91dHN0YW5kaW5nIHJlZmVyZW5jZXMgdG8gYSBkb2N1bWVudCBzb3J0ZWQgYnkgdGFyZ2V0IGlkLlxyXG4gICAgICAgIHRoaXMucmVmc0J5VGFyZ2V0ID0gbmV3IFNvcnRlZFNldChEb2NSZWZlcmVuY2UuY29tcGFyZUJ5VGFyZ2V0SWQpO1xyXG4gICAgfVxyXG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcmVmZXJlbmNlIHNldCBjb250YWlucyBubyByZWZlcmVuY2VzLiAqL1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlZnNCeUtleS5pc0VtcHR5KCk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEFkZHMgYSByZWZlcmVuY2UgdG8gdGhlIGdpdmVuIGRvY3VtZW50IGtleSBmb3IgdGhlIGdpdmVuIElELiAqL1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5hZGRSZWZlcmVuY2UgPSBmdW5jdGlvbiAoa2V5LCBpZCkge1xyXG4gICAgICAgIHZhciByZWYgPSBuZXcgRG9jUmVmZXJlbmNlKGtleSwgaWQpO1xyXG4gICAgICAgIHRoaXMucmVmc0J5S2V5ID0gdGhpcy5yZWZzQnlLZXkuYWRkKHJlZik7XHJcbiAgICAgICAgdGhpcy5yZWZzQnlUYXJnZXQgPSB0aGlzLnJlZnNCeVRhcmdldC5hZGQocmVmKTtcclxuICAgIH07XHJcbiAgICAvKiogQWRkIHJlZmVyZW5jZXMgdG8gdGhlIGdpdmVuIGRvY3VtZW50IGtleXMgZm9yIHRoZSBnaXZlbiBJRC4gKi9cclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUuYWRkUmVmZXJlbmNlcyA9IGZ1bmN0aW9uIChrZXlzLCBpZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIF90aGlzLmFkZFJlZmVyZW5jZShrZXksIGlkKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIGEgcmVmZXJlbmNlIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBrZXkgZm9yIHRoZSBnaXZlblxyXG4gICAgICogSUQuXHJcbiAgICAgKi9cclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUucmVtb3ZlUmVmZXJlbmNlID0gZnVuY3Rpb24gKGtleSwgaWQpIHtcclxuICAgICAgICB0aGlzLnJlbW92ZVJlZihuZXcgRG9jUmVmZXJlbmNlKGtleSwgaWQpKTtcclxuICAgIH07XHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLnJlbW92ZVJlZmVyZW5jZXMgPSBmdW5jdGlvbiAoa2V5cywgaWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBfdGhpcy5yZW1vdmVSZWZlcmVuY2Uoa2V5LCBpZCk7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2xlYXJzIGFsbCByZWZlcmVuY2VzIHdpdGggYSBnaXZlbiBJRC4gQ2FsbHMgcmVtb3ZlUmVmKCkgZm9yIGVhY2gga2V5XHJcbiAgICAgKiByZW1vdmVkLlxyXG4gICAgICovXHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLnJlbW92ZVJlZmVyZW5jZXNGb3JJZCA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGVtcHR5S2V5ID0gRG9jdW1lbnRLZXkuRU1QVFk7XHJcbiAgICAgICAgdmFyIHN0YXJ0UmVmID0gbmV3IERvY1JlZmVyZW5jZShlbXB0eUtleSwgaWQpO1xyXG4gICAgICAgIHZhciBlbmRSZWYgPSBuZXcgRG9jUmVmZXJlbmNlKGVtcHR5S2V5LCBpZCArIDEpO1xyXG4gICAgICAgIHZhciBrZXlzID0gW107XHJcbiAgICAgICAgdGhpcy5yZWZzQnlUYXJnZXQuZm9yRWFjaEluUmFuZ2UoW3N0YXJ0UmVmLCBlbmRSZWZdLCBmdW5jdGlvbiAocmVmKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnJlbW92ZVJlZihyZWYpO1xyXG4gICAgICAgICAgICBrZXlzLnB1c2gocmVmLmtleSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGtleXM7XHJcbiAgICB9O1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5yZW1vdmVBbGxSZWZlcmVuY2VzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5yZWZzQnlLZXkuZm9yRWFjaChmdW5jdGlvbiAocmVmKSB7IHJldHVybiBfdGhpcy5yZW1vdmVSZWYocmVmKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5yZW1vdmVSZWYgPSBmdW5jdGlvbiAocmVmKSB7XHJcbiAgICAgICAgdGhpcy5yZWZzQnlLZXkgPSB0aGlzLnJlZnNCeUtleS5kZWxldGUocmVmKTtcclxuICAgICAgICB0aGlzLnJlZnNCeVRhcmdldCA9IHRoaXMucmVmc0J5VGFyZ2V0LmRlbGV0ZShyZWYpO1xyXG4gICAgfTtcclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUucmVmZXJlbmNlc0ZvcklkID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgdmFyIGVtcHR5S2V5ID0gRG9jdW1lbnRLZXkuRU1QVFk7XHJcbiAgICAgICAgdmFyIHN0YXJ0UmVmID0gbmV3IERvY1JlZmVyZW5jZShlbXB0eUtleSwgaWQpO1xyXG4gICAgICAgIHZhciBlbmRSZWYgPSBuZXcgRG9jUmVmZXJlbmNlKGVtcHR5S2V5LCBpZCArIDEpO1xyXG4gICAgICAgIHZhciBrZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB0aGlzLnJlZnNCeVRhcmdldC5mb3JFYWNoSW5SYW5nZShbc3RhcnRSZWYsIGVuZFJlZl0sIGZ1bmN0aW9uIChyZWYpIHtcclxuICAgICAgICAgICAga2V5cyA9IGtleXMuYWRkKHJlZi5rZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgfTtcclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUuY29udGFpbnNLZXkgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBEb2NSZWZlcmVuY2Uoa2V5LCAwKTtcclxuICAgICAgICB2YXIgZmlyc3RSZWYgPSB0aGlzLnJlZnNCeUtleS5maXJzdEFmdGVyT3JFcXVhbChyZWYpO1xyXG4gICAgICAgIHJldHVybiBmaXJzdFJlZiAhPT0gbnVsbCAmJiBrZXkuaXNFcXVhbChmaXJzdFJlZi5rZXkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBSZWZlcmVuY2VTZXQ7XHJcbn0oKSk7XHJcbnZhciBEb2NSZWZlcmVuY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEb2NSZWZlcmVuY2Uoa2V5LCB0YXJnZXRPckJhdGNoSWQpIHtcclxuICAgICAgICB0aGlzLmtleSA9IGtleTtcclxuICAgICAgICB0aGlzLnRhcmdldE9yQmF0Y2hJZCA9IHRhcmdldE9yQmF0Y2hJZDtcclxuICAgIH1cclxuICAgIC8qKiBDb21wYXJlIGJ5IGtleSB0aGVuIGJ5IElEICovXHJcbiAgICBEb2NSZWZlcmVuY2UuY29tcGFyZUJ5S2V5ID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIChEb2N1bWVudEtleS5jb21wYXJhdG9yKGxlZnQua2V5LCByaWdodC5rZXkpIHx8XHJcbiAgICAgICAgICAgIHByaW1pdGl2ZUNvbXBhcmF0b3IobGVmdC50YXJnZXRPckJhdGNoSWQsIHJpZ2h0LnRhcmdldE9yQmF0Y2hJZCkpO1xyXG4gICAgfTtcclxuICAgIC8qKiBDb21wYXJlIGJ5IElEIHRoZW4gYnkga2V5ICovXHJcbiAgICBEb2NSZWZlcmVuY2UuY29tcGFyZUJ5VGFyZ2V0SWQgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcclxuICAgICAgICByZXR1cm4gKHByaW1pdGl2ZUNvbXBhcmF0b3IobGVmdC50YXJnZXRPckJhdGNoSWQsIHJpZ2h0LnRhcmdldE9yQmF0Y2hJZCkgfHxcclxuICAgICAgICAgICAgRG9jdW1lbnRLZXkuY29tcGFyYXRvcihsZWZ0LmtleSwgcmlnaHQua2V5KSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERvY1JlZmVyZW5jZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDMgPSAnTG9jYWxTdG9yZSc7XHJcbi8qKlxyXG4gKiBMb2NhbCBzdG9yYWdlIGluIHRoZSBGaXJlc3RvcmUgY2xpZW50LiBDb29yZGluYXRlcyBwZXJzaXN0ZW5jZSBjb21wb25lbnRzXHJcbiAqIGxpa2UgdGhlIG11dGF0aW9uIHF1ZXVlIGFuZCByZW1vdGUgZG9jdW1lbnQgY2FjaGUgdG8gcHJlc2VudCBhXHJcbiAqIGxhdGVuY3ktY29tcGVuc2F0ZWQgdmlldyBvZiBzdG9yZWQgZGF0YS5cclxuICpcclxuICogVGhlIExvY2FsU3RvcmUgaXMgcmVzcG9uc2libGUgZm9yIGFjY2VwdGluZyBtdXRhdGlvbnMgZnJvbSB0aGUgU3luYyBFbmdpbmUuXHJcbiAqIFdyaXRlcyBmcm9tIHRoZSBjbGllbnQgYXJlIHB1dCBpbnRvIGEgcXVldWUgYXMgcHJvdmlzaW9uYWwgTXV0YXRpb25zIHVudGlsXHJcbiAqIHRoZXkgYXJlIHByb2Nlc3NlZCBieSB0aGUgUmVtb3RlU3RvcmUgYW5kIGNvbmZpcm1lZCBhcyBoYXZpbmcgYmVlbiB3cml0dGVuXHJcbiAqIHRvIHRoZSBzZXJ2ZXIuXHJcbiAqXHJcbiAqIFRoZSBsb2NhbCBzdG9yZSBwcm92aWRlcyB0aGUgbG9jYWwgdmVyc2lvbiBvZiBkb2N1bWVudHMgdGhhdCBoYXZlIGJlZW5cclxuICogbW9kaWZpZWQgbG9jYWxseS4gSXQgbWFpbnRhaW5zIHRoZSBjb25zdHJhaW50OlxyXG4gKlxyXG4gKiAgIExvY2FsRG9jdW1lbnQgPSBSZW1vdGVEb2N1bWVudCArIEFjdGl2ZShMb2NhbE11dGF0aW9ucylcclxuICpcclxuICogKEFjdGl2ZSBtdXRhdGlvbnMgYXJlIHRob3NlIHRoYXQgYXJlIGVucXVldWVkIGFuZCBoYXZlIG5vdCBiZWVuIHByZXZpb3VzbHlcclxuICogYWNrbm93bGVkZ2VkIG9yIHJlamVjdGVkKS5cclxuICpcclxuICogVGhlIFJlbW90ZURvY3VtZW50IChcImdyb3VuZCB0cnV0aFwiKSBzdGF0ZSBpcyBwcm92aWRlZCB2aWEgdGhlXHJcbiAqIGFwcGx5Q2hhbmdlQmF0Y2ggbWV0aG9kLiBJdCB3aWxsIGJlIHNvbWUgdmVyc2lvbiBvZiBhIHNlcnZlci1wcm92aWRlZFxyXG4gKiBkb2N1bWVudCBPUiB3aWxsIGJlIGEgc2VydmVyLXByb3ZpZGVkIGRvY3VtZW50IFBMVVMgYWNrbm93bGVkZ2VkIG11dGF0aW9uczpcclxuICpcclxuICogICBSZW1vdGVEb2N1bWVudCcgPSBSZW1vdGVEb2N1bWVudCArIEFja25vd2xlZGdlZChMb2NhbE11dGF0aW9ucylcclxuICpcclxuICogTm90ZSB0aGF0IHRoaXMgXCJkaXJ0eVwiIHZlcnNpb24gb2YgYSBSZW1vdGVEb2N1bWVudCB3aWxsIG5vdCBiZSBpZGVudGljYWwgdG8gYVxyXG4gKiBzZXJ2ZXIgYmFzZSB2ZXJzaW9uLCBzaW5jZSBpdCBoYXMgTG9jYWxNdXRhdGlvbnMgYWRkZWQgdG8gaXQgcGVuZGluZyBnZXR0aW5nXHJcbiAqIGFuIGF1dGhvcml0YXRpdmUgY29weSBmcm9tIHRoZSBzZXJ2ZXIuXHJcbiAqXHJcbiAqIFNpbmNlIExvY2FsTXV0YXRpb25zIGNhbiBiZSByZWplY3RlZCBieSB0aGUgc2VydmVyLCB3ZSBoYXZlIHRvIGJlIGFibGUgdG9cclxuICogcmV2ZXJ0IGEgTG9jYWxNdXRhdGlvbiB0aGF0IGhhcyBhbHJlYWR5IGJlZW4gYXBwbGllZCB0byB0aGUgTG9jYWxEb2N1bWVudFxyXG4gKiAodHlwaWNhbGx5IGRvbmUgYnkgcmVwbGF5aW5nIGFsbCByZW1haW5pbmcgTG9jYWxNdXRhdGlvbnMgdG8gdGhlXHJcbiAqIFJlbW90ZURvY3VtZW50IHRvIHJlLWFwcGx5KS5cclxuICpcclxuICogVGhlIExvY2FsU3RvcmUgaXMgcmVzcG9uc2libGUgZm9yIHRoZSBnYXJiYWdlIGNvbGxlY3Rpb24gb2YgdGhlIGRvY3VtZW50cyBpdFxyXG4gKiBjb250YWlucy4gRm9yIG5vdywgaXQgZXZlcnkgZG9jIHJlZmVyZW5jZWQgYnkgYSB2aWV3LCB0aGUgbXV0YXRpb24gcXVldWUsIG9yXHJcbiAqIHRoZSBSZW1vdGVTdG9yZS5cclxuICpcclxuICogSXQgYWxzbyBtYWludGFpbnMgdGhlIHBlcnNpc3RlbmNlIG9mIG1hcHBpbmcgcXVlcmllcyB0byByZXN1bWUgdG9rZW5zIGFuZFxyXG4gKiB0YXJnZXQgaWRzLiBJdCBuZWVkcyB0byBrbm93IHRoaXMgZGF0YSBhYm91dCBxdWVyaWVzIHRvIHByb3Blcmx5IGtub3cgd2hhdFxyXG4gKiBkb2NzIGl0IHdvdWxkIGJlIGFsbG93ZWQgdG8gZ2FyYmFnZSBjb2xsZWN0LlxyXG4gKlxyXG4gKiBUaGUgTG9jYWxTdG9yZSBtdXN0IGJlIGFibGUgdG8gZWZmaWNpZW50bHkgZXhlY3V0ZSBxdWVyaWVzIGFnYWluc3QgaXRzIGxvY2FsXHJcbiAqIGNhY2hlIG9mIHRoZSBkb2N1bWVudHMsIHRvIHByb3ZpZGUgdGhlIGluaXRpYWwgc2V0IG9mIHJlc3VsdHMgYmVmb3JlIGFueVxyXG4gKiByZW1vdGUgY2hhbmdlcyBoYXZlIGJlZW4gcmVjZWl2ZWQuXHJcbiAqXHJcbiAqIE5vdGU6IEluIFR5cGVTY3JpcHQsIG1vc3QgbWV0aG9kcyByZXR1cm4gUHJvbWlzZXMgc2luY2UgdGhlIGltcGxlbWVudGF0aW9uXHJcbiAqIG1heSByZWx5IG9uIGZldGNoaW5nIGRhdGEgZnJvbSBJbmRleGVkREIgd2hpY2ggaXMgYXN5bmMuXHJcbiAqIFRoZXNlIFByb21pc2VzIHdpbGwgb25seSBiZSByZWplY3RlZCBvbiBhbiBJL08gZXJyb3Igb3Igb3RoZXIgaW50ZXJuYWxcclxuICogKHVuZXhwZWN0ZWQpIGZhaWx1cmUgKGUuZy4gZmFpbGVkIGFzc2VydCkgYW5kIGFsd2F5cyByZXByZXNlbnQgYW5cclxuICogdW5yZWNvdmVyYWJsZSBlcnJvciAoc2hvdWxkIGJlIGNhdWdodCAvIHJlcG9ydGVkIGJ5IHRoZSBhc3luY19xdWV1ZSkuXHJcbiAqL1xyXG52YXIgTG9jYWxTdG9yZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExvY2FsU3RvcmUoXHJcbiAgICAvKiogTWFuYWdlcyBvdXIgaW4tbWVtb3J5IG9yIGR1cmFibGUgcGVyc2lzdGVuY2UuICovXHJcbiAgICBwZXJzaXN0ZW5jZSwgaW5pdGlhbFVzZXIpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gcGVyc2lzdGVuY2U7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNldCBvZiBkb2N1bWVudCByZWZlcmVuY2VzIG1haW50YWluZWQgYnkgYW55IGxvY2FsIHZpZXdzLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubG9jYWxWaWV3UmVmZXJlbmNlcyA9IG5ldyBSZWZlcmVuY2VTZXQoKTtcclxuICAgICAgICAvKiogTWFwcyBhIHRhcmdldElEIHRvIGRhdGEgYWJvdXQgaXRzIHF1ZXJ5LiAqL1xyXG4gICAgICAgIHRoaXMucXVlcnlEYXRhQnlUYXJnZXQgPSB7fTtcclxuICAgICAgICBhc3NlcnQocGVyc2lzdGVuY2Uuc3RhcnRlZCwgJ0xvY2FsU3RvcmUgd2FzIHBhc3NlZCBhbiB1bnN0YXJ0ZWQgcGVyc2lzdGVuY2UgaW1wbGVtZW50YXRpb24nKTtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnNldEluTWVtb3J5UGlucyh0aGlzLmxvY2FsVmlld1JlZmVyZW5jZXMpO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZSA9IHBlcnNpc3RlbmNlLmdldE11dGF0aW9uUXVldWUoaW5pdGlhbFVzZXIpO1xyXG4gICAgICAgIHRoaXMucmVtb3RlRG9jdW1lbnRzID0gcGVyc2lzdGVuY2UuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpO1xyXG4gICAgICAgIHRoaXMucXVlcnlDYWNoZSA9IHBlcnNpc3RlbmNlLmdldFF1ZXJ5Q2FjaGUoKTtcclxuICAgICAgICB0aGlzLmxvY2FsRG9jdW1lbnRzID0gbmV3IExvY2FsRG9jdW1lbnRzVmlldyh0aGlzLnJlbW90ZURvY3VtZW50cywgdGhpcy5tdXRhdGlvblF1ZXVlKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGVsbHMgdGhlIExvY2FsU3RvcmUgdGhhdCB0aGUgY3VycmVudGx5IGF1dGhlbnRpY2F0ZWQgdXNlciBoYXMgY2hhbmdlZC5cclxuICAgICAqXHJcbiAgICAgKiBJbiByZXNwb25zZSB0aGUgbG9jYWwgc3RvcmUgc3dpdGNoZXMgdGhlIG11dGF0aW9uIHF1ZXVlIHRvIHRoZSBuZXcgdXNlciBhbmRcclxuICAgICAqIHJldHVybnMgYW55IHJlc3VsdGluZyBkb2N1bWVudCBjaGFuZ2VzLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IEFuZHJvaWQgYW5kIGlPUyBvbmx5IHJldHVybiB0aGUgZG9jdW1lbnRzIGFmZmVjdGVkIGJ5IHRoZVxyXG4gICAgLy8gY2hhbmdlLlxyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuaGFuZGxlVXNlckNoYW5nZSA9IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignSGFuZGxlIHVzZXIgY2hhbmdlJywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICAvLyBTd2FwIG91dCB0aGUgbXV0YXRpb24gcXVldWUsIGdyYWJiaW5nIHRoZSBwZW5kaW5nIG11dGF0aW9uIGJhdGNoZXNcclxuICAgICAgICAgICAgLy8gYmVmb3JlIGFuZCBhZnRlci5cclxuICAgICAgICAgICAgdmFyIG9sZEJhdGNoZXM7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlXHJcbiAgICAgICAgICAgICAgICAuZ2V0QWxsTXV0YXRpb25CYXRjaGVzKHR4bilcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChwcm9taXNlZE9sZEJhdGNoZXMpIHtcclxuICAgICAgICAgICAgICAgIG9sZEJhdGNoZXMgPSBwcm9taXNlZE9sZEJhdGNoZXM7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5tdXRhdGlvblF1ZXVlID0gX3RoaXMucGVyc2lzdGVuY2UuZ2V0TXV0YXRpb25RdWV1ZSh1c2VyKTtcclxuICAgICAgICAgICAgICAgIC8vIFJlY3JlYXRlIG91ciBMb2NhbERvY3VtZW50c1ZpZXcgdXNpbmcgdGhlIG5ld1xyXG4gICAgICAgICAgICAgICAgLy8gTXV0YXRpb25RdWV1ZS5cclxuICAgICAgICAgICAgICAgIF90aGlzLmxvY2FsRG9jdW1lbnRzID0gbmV3IExvY2FsRG9jdW1lbnRzVmlldyhfdGhpcy5yZW1vdGVEb2N1bWVudHMsIF90aGlzLm11dGF0aW9uUXVldWUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzKHR4bik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAobmV3QmF0Y2hlcykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlbW92ZWRCYXRjaElkcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFkZGVkQmF0Y2hJZHMgPSBbXTtcclxuICAgICAgICAgICAgICAgIC8vIFVuaW9uIHRoZSBvbGQvbmV3IGNoYW5nZWQga2V5cy5cclxuICAgICAgICAgICAgICAgIHZhciBjaGFuZ2VkS2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIG9sZEJhdGNoZXNfMSA9IG9sZEJhdGNoZXM7IF9pIDwgb2xkQmF0Y2hlc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiYXRjaCA9IG9sZEJhdGNoZXNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZEJhdGNoSWRzLnB1c2goYmF0Y2guYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBfYiA9IGJhdGNoLm11dGF0aW9uczsgX2EgPCBfYi5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG11dGF0aW9uID0gX2JbX2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkS2V5cyA9IGNoYW5nZWRLZXlzLmFkZChtdXRhdGlvbi5rZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9jID0gMCwgbmV3QmF0Y2hlc18xID0gbmV3QmF0Y2hlczsgX2MgPCBuZXdCYXRjaGVzXzEubGVuZ3RoOyBfYysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhdGNoID0gbmV3QmF0Y2hlc18xW19jXTtcclxuICAgICAgICAgICAgICAgICAgICBhZGRlZEJhdGNoSWRzLnB1c2goYmF0Y2guYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2QgPSAwLCBfZSA9IGJhdGNoLm11dGF0aW9uczsgX2QgPCBfZS5sZW5ndGg7IF9kKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG11dGF0aW9uID0gX2VbX2RdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkS2V5cyA9IGNoYW5nZWRLZXlzLmFkZChtdXRhdGlvbi5rZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFJldHVybiB0aGUgc2V0IG9mIGFsbCAocG90ZW50aWFsbHkpIGNoYW5nZWQgZG9jdW1lbnRzIGFuZCB0aGUgbGlzdFxyXG4gICAgICAgICAgICAgICAgLy8gb2YgbXV0YXRpb24gYmF0Y2ggSURzIHRoYXQgd2VyZSBhZmZlY3RlZCBieSBjaGFuZ2UuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxEb2N1bWVudHNcclxuICAgICAgICAgICAgICAgICAgICAuZ2V0RG9jdW1lbnRzKHR4biwgY2hhbmdlZEtleXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGFmZmVjdGVkRG9jdW1lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWREb2N1bWVudHM6IGFmZmVjdGVkRG9jdW1lbnRzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkQmF0Y2hJZHM6IHJlbW92ZWRCYXRjaElkcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkZWRCYXRjaElkczogYWRkZWRCYXRjaElkc1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyogQWNjZXB0IGxvY2FsbHkgZ2VuZXJhdGVkIE11dGF0aW9ucyBhbmQgY29tbWl0IHRoZW0gdG8gc3RvcmFnZS4gKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmxvY2FsV3JpdGUgPSBmdW5jdGlvbiAobXV0YXRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignTG9jYWxseSB3cml0ZSBtdXRhdGlvbnMnLCAncmVhZHdyaXRlJywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICB2YXIgYmF0Y2g7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbFdyaXRlVGltZSA9IFRpbWVzdGFtcC5ub3coKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWVcclxuICAgICAgICAgICAgICAgIC5hZGRNdXRhdGlvbkJhdGNoKHR4biwgbG9jYWxXcml0ZVRpbWUsIG11dGF0aW9ucylcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChwcm9taXNlZEJhdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBiYXRjaCA9IHByb21pc2VkQmF0Y2g7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGtvc3MpOiBUaGlzIGlzIGRvaW5nIGFuIE5eMiB1cGRhdGUgYnkgcmVwbGF5aW5nIEFMTCB0aGVcclxuICAgICAgICAgICAgICAgIC8vIG11dGF0aW9ucyBvbiBlYWNoIGRvY3VtZW50IChpbnN0ZWFkIG9mIGp1c3QgdGhlIG9uZXMgYWRkZWQpIGluXHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzIGJhdGNoLlxyXG4gICAgICAgICAgICAgICAgdmFyIGtleXMgPSBiYXRjaC5rZXlzKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzKHR4biwga2V5cyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoY2hhbmdlZERvY3VtZW50cykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgYmF0Y2hJZDogYmF0Y2guYmF0Y2hJZCwgY2hhbmdlczogY2hhbmdlZERvY3VtZW50cyB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogUmV0dXJucyB0aGUgbG9jYWwgdmlldyBvZiB0aGUgZG9jdW1lbnRzIGFmZmVjdGVkIGJ5IGEgbXV0YXRpb24gYmF0Y2guICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUubG9va3VwTXV0YXRpb25Eb2N1bWVudHMgPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0xvb2t1cCBtdXRhdGlvbiBkb2N1bWVudHMnLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlXHJcbiAgICAgICAgICAgICAgICAubG9va3VwTXV0YXRpb25LZXlzKHR4biwgYmF0Y2hJZClcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChrZXlzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoa2V5cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudHModHhuLCBrZXlzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShudWxsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBY2tub3dsZWRnZSB0aGUgZ2l2ZW4gYmF0Y2guXHJcbiAgICAgKlxyXG4gICAgICogT24gdGhlIGhhcHB5IHBhdGggd2hlbiBhIGJhdGNoIGlzIGFja25vd2xlZGdlZCwgdGhlIGxvY2FsIHN0b3JlIHdpbGxcclxuICAgICAqXHJcbiAgICAgKiAgKyByZW1vdmUgdGhlIGJhdGNoIGZyb20gdGhlIG11dGF0aW9uIHF1ZXVlO1xyXG4gICAgICogICsgYXBwbHkgdGhlIGNoYW5nZXMgdG8gdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZTtcclxuICAgICAqICArIHJlY2FsY3VsYXRlIHRoZSBsYXRlbmN5IGNvbXBlbnNhdGVkIHZpZXcgaW1wbGllZCBieSB0aG9zZSBjaGFuZ2VzICh0aGVyZVxyXG4gICAgICogICAgbWF5IGJlIG11dGF0aW9ucyBpbiB0aGUgcXVldWUgdGhhdCBhZmZlY3QgdGhlIGRvY3VtZW50cyBidXQgaGF2ZW4ndCBiZWVuXHJcbiAgICAgKiAgICBhY2tub3dsZWRnZWQgeWV0KTsgYW5kXHJcbiAgICAgKiAgKyBnaXZlIHRoZSBjaGFuZ2VkIGRvY3VtZW50cyBiYWNrIHRoZSBzeW5jIGVuZ2luZVxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIFRoZSByZXN1bHRpbmcgKG1vZGlmaWVkKSBkb2N1bWVudHMuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmFja25vd2xlZGdlQmF0Y2ggPSBmdW5jdGlvbiAoYmF0Y2hSZXN1bHQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdBY2tub3dsZWRnZSBiYXRjaCcsICdyZWFkd3JpdGUtcHJpbWFyeScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgdmFyIGFmZmVjdGVkID0gYmF0Y2hSZXN1bHQuYmF0Y2gua2V5cygpO1xyXG4gICAgICAgICAgICB2YXIgZG9jdW1lbnRCdWZmZXIgPSBfdGhpcy5yZW1vdGVEb2N1bWVudHMubmV3Q2hhbmdlQnVmZmVyKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlXHJcbiAgICAgICAgICAgICAgICAuYWNrbm93bGVkZ2VCYXRjaCh0eG4sIGJhdGNoUmVzdWx0LmJhdGNoLCBiYXRjaFJlc3VsdC5zdHJlYW1Ub2tlbilcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5hcHBseVdyaXRlVG9SZW1vdGVEb2N1bWVudHModHhuLCBiYXRjaFJlc3VsdCwgZG9jdW1lbnRCdWZmZXIpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gZG9jdW1lbnRCdWZmZXIuYXBwbHkodHhuKTsgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWUucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodHhuKTsgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyh0eG4sIGFmZmVjdGVkKTsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgbXV0YXRpb25zIGZyb20gdGhlIE11dGF0aW9uUXVldWUgZm9yIHRoZSBzcGVjaWZpZWQgYmF0Y2g7XHJcbiAgICAgKiBMb2NhbERvY3VtZW50cyB3aWxsIGJlIHJlY2FsY3VsYXRlZC5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgcmVzdWx0aW5nIG1vZGlmaWVkIGRvY3VtZW50cy5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUucmVqZWN0QmF0Y2ggPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ1JlamVjdCBiYXRjaCcsICdyZWFkd3JpdGUtcHJpbWFyeScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgdmFyIGFmZmVjdGVkS2V5cztcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWVcclxuICAgICAgICAgICAgICAgIC5sb29rdXBNdXRhdGlvbkJhdGNoKHR4biwgYmF0Y2hJZClcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChiYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGJhdGNoICE9PSBudWxsLCAnQXR0ZW1wdCB0byByZWplY3Qgbm9uZXhpc3RlbnQgYmF0Y2ghJyk7XHJcbiAgICAgICAgICAgICAgICBhZmZlY3RlZEtleXMgPSBiYXRjaC5rZXlzKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZS5yZW1vdmVNdXRhdGlvbkJhdGNoKHR4biwgYmF0Y2gpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWUucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodHhuKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudHModHhuLCBhZmZlY3RlZEtleXMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogUmV0dXJucyB0aGUgbGFzdCByZWNvcmRlZCBzdHJlYW0gdG9rZW4gZm9yIHRoZSBjdXJyZW50IHVzZXIuICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5nZXRMYXN0U3RyZWFtVG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignR2V0IGxhc3Qgc3RyZWFtIHRva2VuJywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZS5nZXRMYXN0U3RyZWFtVG9rZW4odHhuKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFNldHMgdGhlIHN0cmVhbSB0b2tlbiBmb3IgdGhlIGN1cnJlbnQgdXNlciB3aXRob3V0IGFja25vd2xlZGdpbmcgYW55XHJcbiAgICAgKiBtdXRhdGlvbiBiYXRjaC4gVGhpcyBpcyB1c3VhbGx5IG9ubHkgdXNlZnVsIGFmdGVyIGEgc3RyZWFtIGhhbmRzaGFrZSBvciBpblxyXG4gICAgICogcmVzcG9uc2UgdG8gYW4gZXJyb3IgdGhhdCByZXF1aXJlcyBjbGVhcmluZyB0aGUgc3RyZWFtIHRva2VuLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5zZXRMYXN0U3RyZWFtVG9rZW4gPSBmdW5jdGlvbiAoc3RyZWFtVG9rZW4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdTZXQgbGFzdCBzdHJlYW0gdG9rZW4nLCAncmVhZHdyaXRlLXByaW1hcnknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlLnNldExhc3RTdHJlYW1Ub2tlbih0eG4sIHN0cmVhbVRva2VuKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGxhc3QgY29uc2lzdGVudCBzbmFwc2hvdCBwcm9jZXNzZWQgKHVzZWQgYnkgdGhlIFJlbW90ZVN0b3JlIHRvXHJcbiAgICAgKiBkZXRlcm1pbmUgd2hldGhlciB0byBidWZmZXIgaW5jb21pbmcgc25hcHNob3RzIGZyb20gdGhlIGJhY2tlbmQpLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5nZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0dldCBsYXN0IHJlbW90ZSBzbmFwc2hvdCB2ZXJzaW9uJywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikgeyByZXR1cm4gX3RoaXMucXVlcnlDYWNoZS5nZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKHR4bik7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlIHRoZSBcImdyb3VuZC1zdGF0ZVwiIChyZW1vdGUpIGRvY3VtZW50cy4gV2UgYXNzdW1lIHRoYXQgdGhlIHJlbW90ZVxyXG4gICAgICogZXZlbnQgcmVmbGVjdHMgYW55IHdyaXRlIGJhdGNoZXMgdGhhdCBoYXZlIGJlZW4gYWNrbm93bGVkZ2VkIG9yIHJlamVjdGVkXHJcbiAgICAgKiAoaS5lLiB3ZSBkbyBub3QgcmUtYXBwbHkgbG9jYWwgbXV0YXRpb25zIHRvIHVwZGF0ZXMgZnJvbSB0aGlzIGV2ZW50KS5cclxuICAgICAqXHJcbiAgICAgKiBMb2NhbERvY3VtZW50cyBhcmUgcmUtY2FsY3VsYXRlZCBpZiB0aGVyZSBhcmUgcmVtYWluaW5nIG11dGF0aW9ucyBpbiB0aGVcclxuICAgICAqIHF1ZXVlLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5hcHBseVJlbW90ZUV2ZW50ID0gZnVuY3Rpb24gKHJlbW90ZUV2ZW50KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZG9jdW1lbnRCdWZmZXIgPSB0aGlzLnJlbW90ZURvY3VtZW50cy5uZXdDaGFuZ2VCdWZmZXIoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignQXBwbHkgcmVtb3RlIGV2ZW50JywgJ3JlYWR3cml0ZS1wcmltYXJ5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICAgICAgdmFyIGF1dGhvcml0YXRpdmVVcGRhdGVzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICAgICAgZm9yRWFjaE51bWJlcihyZW1vdGVFdmVudC50YXJnZXRDaGFuZ2VzLCBmdW5jdGlvbiAodGFyZ2V0SWQsIGNoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gRG8gbm90IHJlZi91bnJlZiB1bmFzc2lnbmVkIHRhcmdldElkcyAtIGl0IG1heSBsZWFkIHRvIGxlYWtzLlxyXG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5RGF0YSA9IF90aGlzLnF1ZXJ5RGF0YUJ5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgIGlmICghcXVlcnlEYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIC8vIFdoZW4gYSBnbG9iYWwgc25hcHNob3QgY29udGFpbnMgdXBkYXRlcyAoZWl0aGVyIGFkZCBvciBtb2RpZnkpIHdlXHJcbiAgICAgICAgICAgICAgICAvLyBjYW4gY29tcGxldGVseSB0cnVzdCB0aGVzZSB1cGRhdGVzIGFzIGF1dGhvcml0YXRpdmUgYW5kIGJsaW5kbHlcclxuICAgICAgICAgICAgICAgIC8vIGFwcGx5IHRoZW0gdG8gb3VyIGNhY2hlIChhcyBhIGRlZmVuc2l2ZSBtZWFzdXJlIHRvIHByb21vdGVcclxuICAgICAgICAgICAgICAgIC8vIHNlbGYtaGVhbGluZyBpbiB0aGUgdW5mb3J0dW5hdGUgY2FzZSB0aGF0IG91ciBjYWNoZSBpcyBldmVyIHNvbWVob3dcclxuICAgICAgICAgICAgICAgIC8vIGNvcnJ1cHRlZCAvIG91dC1vZi1zeW5jKS5cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgZG9jdW1lbnQgaXMgb25seSB1cGRhdGVkIHdoaWxlIHJlbW92aW5nIGl0IGZyb20gYSB0YXJnZXRcclxuICAgICAgICAgICAgICAgIC8vIHRoZW4gd2F0Y2ggaXNuJ3Qgb2JsaWdhdGVkIHRvIHNlbmQgdGhlIGFic29sdXRlIGxhdGVzdCB2ZXJzaW9uOiBpdFxyXG4gICAgICAgICAgICAgICAgLy8gY2FuIHNlbmQgdGhlIGZpcnN0IHZlcnNpb24gdGhhdCBjYXVzZWQgdGhlIGRvY3VtZW50IG5vdCB0byBtYXRjaC5cclxuICAgICAgICAgICAgICAgIGNoYW5nZS5hZGRlZERvY3VtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRob3JpdGF0aXZlVXBkYXRlcyA9IGF1dGhvcml0YXRpdmVVcGRhdGVzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2UubW9kaWZpZWREb2N1bWVudHMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXRhdGl2ZVVwZGF0ZXMgPSBhdXRob3JpdGF0aXZlVXBkYXRlcy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChfdGhpcy5xdWVyeUNhY2hlXHJcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZU1hdGNoaW5nS2V5cyh0eG4sIGNoYW5nZS5yZW1vdmVkRG9jdW1lbnRzLCB0YXJnZXRJZClcclxuICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5Q2FjaGUuYWRkTWF0Y2hpbmdLZXlzKHR4biwgY2hhbmdlLmFkZGVkRG9jdW1lbnRzLCB0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHJlc3VtZSB0b2tlbiBpZiB0aGUgY2hhbmdlIGluY2x1ZGVzIG9uZS4gRG9uJ3QgY2xlYXJcclxuICAgICAgICAgICAgICAgIC8vIGFueSBwcmVleGlzdGluZyB2YWx1ZS5cclxuICAgICAgICAgICAgICAgIHZhciByZXN1bWVUb2tlbiA9IGNoYW5nZS5yZXN1bWVUb2tlbjtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bWVUb2tlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZFF1ZXJ5RGF0YSA9IHF1ZXJ5RGF0YTtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeURhdGEgPSBxdWVyeURhdGEuY29weSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VtZVRva2VuOiByZXN1bWVUb2tlbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgc25hcHNob3RWZXJzaW9uOiByZW1vdGVFdmVudC5zbmFwc2hvdFZlcnNpb25cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5xdWVyeURhdGFCeVRhcmdldFt0YXJnZXRJZF0gPSBxdWVyeURhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKExvY2FsU3RvcmUuc2hvdWxkUGVyc2lzdFF1ZXJ5RGF0YShvbGRRdWVyeURhdGEsIHF1ZXJ5RGF0YSwgY2hhbmdlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKF90aGlzLnF1ZXJ5Q2FjaGUudXBkYXRlUXVlcnlEYXRhKHR4biwgcXVlcnlEYXRhKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdmFyIGNoYW5nZWREb2NLZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICAgICAgcmVtb3RlRXZlbnQuZG9jdW1lbnRVcGRhdGVzLmZvckVhY2goZnVuY3Rpb24gKGtleSwgZG9jKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VkRG9jS2V5cyA9IGNoYW5nZWREb2NLZXlzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChkb2N1bWVudEJ1ZmZlci5nZXRFbnRyeSh0eG4sIGtleSkubmV4dChmdW5jdGlvbiAoZXhpc3RpbmdEb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBhIGRvY3VtZW50IHVwZGF0ZSBpc24ndCBhdXRob3JpdGF0aXZlLCBtYWtlIHN1cmUgd2UgZG9uJ3RcclxuICAgICAgICAgICAgICAgICAgICAvLyBhcHBseSBhbiBvbGQgZG9jdW1lbnQgdmVyc2lvbiB0byB0aGUgcmVtb3RlIGNhY2hlLiBXZSBtYWtlIGFuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZXhjZXB0aW9uIGZvciBTbmFwc2hvdFZlcnNpb24uTUlOIHdoaWNoIGNhbiBoYXBwZW4gZm9yXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbWFudWZhY3R1cmVkIGV2ZW50cyAoZS5nLiBpbiB0aGUgY2FzZSBvZiBhIGxpbWJvIGRvY3VtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzb2x1dGlvbiBmYWlsaW5nKS5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdEb2MgPT0gbnVsbCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2MudmVyc2lvbi5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5NSU4pIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChhdXRob3JpdGF0aXZlVXBkYXRlcy5oYXMoZG9jLmtleSkgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICFleGlzdGluZ0RvYy5oYXNQZW5kaW5nV3JpdGVzKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2MudmVyc2lvbi5jb21wYXJlVG8oZXhpc3RpbmdEb2MudmVyc2lvbikgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudEJ1ZmZlci5hZGRFbnRyeShkb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQzLCAnSWdub3Jpbmcgb3V0ZGF0ZWQgd2F0Y2ggdXBkYXRlIGZvciAnLCBrZXksICcuIEN1cnJlbnQgdmVyc2lvbjonLCBleGlzdGluZ0RvYy52ZXJzaW9uLCAnIFdhdGNoIHZlcnNpb246JywgZG9jLnZlcnNpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIGlmIChyZW1vdGVFdmVudC5yZXNvbHZlZExpbWJvRG9jdW1lbnRzLmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChfdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS51cGRhdGVMaW1ib0RvY3VtZW50KHR4biwga2V5KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyBIQUNLOiBUaGUgb25seSByZWFzb24gd2UgYWxsb3cgYSBudWxsIHNuYXBzaG90IHZlcnNpb24gaXMgc28gdGhhdCB3ZVxyXG4gICAgICAgICAgICAvLyBjYW4gc3ludGhlc2l6ZSByZW1vdGUgZXZlbnRzIHdoZW4gd2UgZ2V0IHBlcm1pc3Npb24gZGVuaWVkIGVycm9ycyB3aGlsZVxyXG4gICAgICAgICAgICAvLyB0cnlpbmcgdG8gcmVzb2x2ZSB0aGUgc3RhdGUgb2YgYSBsb2NhbGx5IGNhY2hlZCBkb2N1bWVudCB0aGF0IGlzIGluXHJcbiAgICAgICAgICAgIC8vIGxpbWJvLlxyXG4gICAgICAgICAgICB2YXIgcmVtb3RlVmVyc2lvbiA9IHJlbW90ZUV2ZW50LnNuYXBzaG90VmVyc2lvbjtcclxuICAgICAgICAgICAgaWYgKCFyZW1vdGVWZXJzaW9uLmlzRXF1YWwoU25hcHNob3RWZXJzaW9uLk1JTikpIHtcclxuICAgICAgICAgICAgICAgIHZhciB1cGRhdGVSZW1vdGVWZXJzaW9uID0gX3RoaXMucXVlcnlDYWNoZVxyXG4gICAgICAgICAgICAgICAgICAgIC5nZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKHR4bilcclxuICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAobGFzdFJlbW90ZVZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQocmVtb3RlVmVyc2lvbi5jb21wYXJlVG8obGFzdFJlbW90ZVZlcnNpb24pID49IDAsICdXYXRjaCBzdHJlYW0gcmV2ZXJ0ZWQgdG8gcHJldmlvdXMgc25hcHNob3Q/PyAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlVmVyc2lvbiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICcgPCAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFJlbW90ZVZlcnNpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5xdWVyeUNhY2hlLnNldFRhcmdldHNNZXRhZGF0YSh0eG4sIHR4bi5jdXJyZW50U2VxdWVuY2VOdW1iZXIsIHJlbW90ZVZlcnNpb24pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHVwZGF0ZVJlbW90ZVZlcnNpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcylcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGRvY3VtZW50QnVmZmVyLmFwcGx5KHR4bik7IH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzKHR4biwgY2hhbmdlZERvY0tleXMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgbmV3UXVlcnlEYXRhIHNob3VsZCBiZSBwZXJzaXN0ZWQgZHVyaW5nIGFuIHVwZGF0ZSBvZlxyXG4gICAgICogYW4gYWN0aXZlIHRhcmdldC4gUXVlcnlEYXRhIHNob3VsZCBhbHdheXMgYmUgcGVyc2lzdGVkIHdoZW4gYSB0YXJnZXQgaXNcclxuICAgICAqIGJlaW5nIHJlbGVhc2VkIGFuZCBzaG91bGQgbm90IGNhbGwgdGhpcyBmdW5jdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBXaGlsZSB0aGUgdGFyZ2V0IGlzIGFjdGl2ZSwgUXVlcnlEYXRhIHVwZGF0ZXMgY2FuIGJlIG9taXR0ZWQgd2hlbiBub3RoaW5nXHJcbiAgICAgKiBhYm91dCB0aGUgdGFyZ2V0IGhhcyBjaGFuZ2VkIGV4Y2VwdCBtZXRhZGF0YSBsaWtlIHRoZSByZXN1bWUgdG9rZW4gb3JcclxuICAgICAqIHNuYXBzaG90IHZlcnNpb24uIE9jY2FzaW9uYWxseSBpdCdzIHdvcnRoIHRoZSBleHRyYSB3cml0ZSB0byBwcmV2ZW50IHRoZXNlXHJcbiAgICAgKiB2YWx1ZXMgZnJvbSBnZXR0aW5nIHRvbyBzdGFsZSBhZnRlciBhIGNyYXNoLCBidXQgdGhpcyBkb2Vzbid0IGhhdmUgdG8gYmVcclxuICAgICAqIHRvbyBmcmVxdWVudC5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5zaG91bGRQZXJzaXN0UXVlcnlEYXRhID0gZnVuY3Rpb24gKG9sZFF1ZXJ5RGF0YSwgbmV3UXVlcnlEYXRhLCBjaGFuZ2UpIHtcclxuICAgICAgICAvLyBBdm9pZCBjbGVhcmluZyBhbnkgZXhpc3RpbmcgdmFsdWVcclxuICAgICAgICBpZiAobmV3UXVlcnlEYXRhLnJlc3VtZVRva2VuLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIC8vIEFueSByZXN1bWUgdG9rZW4gaXMgaW50ZXJlc3RpbmcgaWYgdGhlcmUgaXNuJ3Qgb25lIGFscmVhZHkuXHJcbiAgICAgICAgaWYgKG9sZFF1ZXJ5RGF0YS5yZXN1bWVUb2tlbi5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIC8vIERvbid0IGFsbG93IHJlc3VtZSB0b2tlbiBjaGFuZ2VzIHRvIGJlIGJ1ZmZlcmVkIGluZGVmaW5pdGVseS4gVGhpc1xyXG4gICAgICAgIC8vIGFsbG93cyB1cyB0byBiZSByZWFzb25hYmx5IHVwLXRvLWRhdGUgYWZ0ZXIgYSBjcmFzaCBhbmQgYXZvaWRzIG5lZWRpbmdcclxuICAgICAgICAvLyB0byBsb29wIG92ZXIgYWxsIGFjdGl2ZSBxdWVyaWVzIG9uIHNodXRkb3duLiBFc3BlY2lhbGx5IGluIHRoZSBicm93c2VyXHJcbiAgICAgICAgLy8gd2UgbWF5IG5vdCBnZXQgdGltZSB0byBkbyBhbnl0aGluZyBpbnRlcmVzdGluZyB3aGlsZSB0aGUgY3VycmVudCB0YWIgaXNcclxuICAgICAgICAvLyBjbG9zaW5nLlxyXG4gICAgICAgIHZhciB0aW1lRGVsdGEgPSBuZXdRdWVyeURhdGEuc25hcHNob3RWZXJzaW9uLnRvTWljcm9zZWNvbmRzKCkgLVxyXG4gICAgICAgICAgICBvbGRRdWVyeURhdGEuc25hcHNob3RWZXJzaW9uLnRvTWljcm9zZWNvbmRzKCk7XHJcbiAgICAgICAgaWYgKHRpbWVEZWx0YSA+PSB0aGlzLlJFU1VNRV9UT0tFTl9NQVhfQUdFX01JQ1JPUylcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgLy8gT3RoZXJ3aXNlIGlmIHRoZSBvbmx5IHRoaW5nIHRoYXQgaGFzIGNoYW5nZWQgYWJvdXQgYSB0YXJnZXQgaXMgaXRzIHJlc3VtZVxyXG4gICAgICAgIC8vIHRva2VuIGl0J3Mgbm90IHdvcnRoIHBlcnNpc3RpbmcuIE5vdGUgdGhhdCB0aGUgUmVtb3RlU3RvcmUga2VlcHMgYW5cclxuICAgICAgICAvLyBpbi1tZW1vcnkgdmlldyBvZiB0aGUgY3VycmVudGx5IGFjdGl2ZSB0YXJnZXRzIHdoaWNoIGluY2x1ZGVzIHRoZSBjdXJyZW50XHJcbiAgICAgICAgLy8gcmVzdW1lIHRva2VuLCBzbyBzdHJlYW0gZmFpbHVyZSBvciB1c2VyIGNoYW5nZXMgd2lsbCBzdGlsbCB1c2UgYW5cclxuICAgICAgICAvLyB1cC10by1kYXRlIHJlc3VtZSB0b2tlbiByZWdhcmRsZXNzIG9mIHdoYXQgd2UgZG8gaGVyZS5cclxuICAgICAgICB2YXIgY2hhbmdlcyA9IGNoYW5nZS5hZGRlZERvY3VtZW50cy5zaXplICtcclxuICAgICAgICAgICAgY2hhbmdlLm1vZGlmaWVkRG9jdW1lbnRzLnNpemUgK1xyXG4gICAgICAgICAgICBjaGFuZ2UucmVtb3ZlZERvY3VtZW50cy5zaXplO1xyXG4gICAgICAgIHJldHVybiBjaGFuZ2VzID4gMDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIE5vdGlmeSBsb2NhbCBzdG9yZSBvZiB0aGUgY2hhbmdlZCB2aWV3cyB0byBsb2NhbGx5IHBpbiBkb2N1bWVudHMuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLm5vdGlmeUxvY2FsVmlld0NoYW5nZXMgPSBmdW5jdGlvbiAodmlld0NoYW5nZXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdub3RpZnlMb2NhbFZpZXdDaGFuZ2VzJywgJ3JlYWR3cml0ZScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHZpZXdDaGFuZ2VzLCBmdW5jdGlvbiAodmlld0NoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubG9jYWxWaWV3UmVmZXJlbmNlcy5hZGRSZWZlcmVuY2VzKHZpZXdDaGFuZ2UuYWRkZWRLZXlzLCB2aWV3Q2hhbmdlLnRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmxvY2FsVmlld1JlZmVyZW5jZXMucmVtb3ZlUmVmZXJlbmNlcyh2aWV3Q2hhbmdlLnJlbW92ZWRLZXlzLCB2aWV3Q2hhbmdlLnRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh2aWV3Q2hhbmdlLnJlbW92ZWRLZXlzLCBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVJlZmVyZW5jZSh0eG4sIGtleSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBtdXRhdGlvbiBiYXRjaCBhZnRlciB0aGUgcGFzc2VkIGluIGJhdGNoSWQgaW4gdGhlIG11dGF0aW9uIHF1ZXVlXHJcbiAgICAgKiBvciBudWxsIGlmIGVtcHR5LlxyXG4gICAgICogQHBhcmFtIGFmdGVyQmF0Y2hJZCBJZiBwcm92aWRlZCwgdGhlIGJhdGNoIHRvIHNlYXJjaCBhZnRlci5cclxuICAgICAqIEByZXR1cm5zIFRoZSBuZXh0IG11dGF0aW9uIG9yIG51bGwgaWYgdGhlcmUgd2Fzbid0IG9uZS5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUubmV4dE11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAoYWZ0ZXJCYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignR2V0IG5leHQgbXV0YXRpb24gYmF0Y2gnLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIGlmIChhZnRlckJhdGNoSWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgYWZ0ZXJCYXRjaElkID0gQkFUQ0hJRF9VTktOT1dOO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlLmdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkKHR4biwgYWZ0ZXJCYXRjaElkKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlYWQgdGhlIGN1cnJlbnQgdmFsdWUgb2YgYSBEb2N1bWVudCB3aXRoIGEgZ2l2ZW4ga2V5IG9yIG51bGwgaWYgbm90XHJcbiAgICAgKiBmb3VuZCAtIHVzZWQgZm9yIHRlc3RpbmcuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLnJlYWREb2N1bWVudCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdyZWFkIGRvY3VtZW50JywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnQodHhuLCBrZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQXNzaWducyB0aGUgZ2l2ZW4gcXVlcnkgYW4gaW50ZXJuYWwgSUQgc28gdGhhdCBpdHMgcmVzdWx0cyBjYW4gYmUgcGlubmVkIHNvXHJcbiAgICAgKiB0aGV5IGRvbid0IGdldCBHQydkLiBBIHF1ZXJ5IG11c3QgYmUgYWxsb2NhdGVkIGluIHRoZSBsb2NhbCBzdG9yZSBiZWZvcmVcclxuICAgICAqIHRoZSBzdG9yZSBjYW4gYmUgdXNlZCB0byBtYW5hZ2UgaXRzIHZpZXcuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmFsbG9jYXRlUXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdBbGxvY2F0ZSBxdWVyeScsICdyZWFkd3JpdGUnLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeURhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5xdWVyeUNhY2hlXHJcbiAgICAgICAgICAgICAgICAuZ2V0UXVlcnlEYXRhKHR4biwgcXVlcnkpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoY2FjaGVkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBxdWVyeSBoYXMgYmVlbiBsaXN0ZW5lZCB0byBwcmV2aW91c2x5LCBzbyByZXVzZSB0aGVcclxuICAgICAgICAgICAgICAgICAgICAvLyBwcmV2aW91cyB0YXJnZXRJRC5cclxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKG1jZyk6IGZyZXNoZW4gbGFzdCBhY2Nlc3NlZCBkYXRlP1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5RGF0YSA9IGNhY2hlZDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5xdWVyeUNhY2hlLmFsbG9jYXRlVGFyZ2V0SWQodHhuKS5uZXh0KGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeURhdGEgPSBuZXcgUXVlcnlEYXRhKHF1ZXJ5LCB0YXJnZXRJZCwgUXVlcnlQdXJwb3NlLkxpc3RlbiwgdHhuLmN1cnJlbnRTZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5xdWVyeUNhY2hlLmFkZFF1ZXJ5RGF0YSh0eG4sIHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoIV90aGlzLnF1ZXJ5RGF0YUJ5VGFyZ2V0W3F1ZXJ5RGF0YS50YXJnZXRJZF0sICdUcmllZCB0byBhbGxvY2F0ZSBhbiBhbHJlYWR5IGFsbG9jYXRlZCBxdWVyeTogJyArIHF1ZXJ5KTtcclxuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXJ5RGF0YUJ5VGFyZ2V0W3F1ZXJ5RGF0YS50YXJnZXRJZF0gPSBxdWVyeURhdGE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcXVlcnlEYXRhO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVucGluIGFsbCB0aGUgZG9jdW1lbnRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4gcXVlcnkuIElmXHJcbiAgICAgKiBga2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YWAgaXMgc2V0IHRvIGZhbHNlIGFuZCBFYWdlciBHQyBlbmFibGVkLCB0aGUgbWV0aG9kXHJcbiAgICAgKiBkaXJlY3RseSByZW1vdmVzIHRoZSBhc3NvY2lhdGVkIHF1ZXJ5IGRhdGEgZnJvbSB0aGUgcXVlcnkgY2FjaGUuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogYGtlZXBQZXJzaXN0ZWRRdWVyeURhdGFgIGlzIG11bHRpLXRhYiBvbmx5LlxyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUucmVsZWFzZVF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5LCBrZWVwUGVyc2lzdGVkUXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgbW9kZSA9IGtlZXBQZXJzaXN0ZWRRdWVyeURhdGEgPyAncmVhZHdyaXRlJyA6ICdyZWFkd3JpdGUtcHJpbWFyeSc7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ1JlbGVhc2UgcXVlcnknLCBtb2RlLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5xdWVyeUNhY2hlXHJcbiAgICAgICAgICAgICAgICAuZ2V0UXVlcnlEYXRhKHR4biwgcXVlcnkpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQocXVlcnlEYXRhICE9IG51bGwsICdUcmllZCB0byByZWxlYXNlIG5vbmV4aXN0ZW50IHF1ZXJ5OiAnICsgcXVlcnkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldElkID0gcXVlcnlEYXRhLnRhcmdldElkO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNhY2hlZFF1ZXJ5RGF0YSA9IF90aGlzLnF1ZXJ5RGF0YUJ5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgIC8vIFJlZmVyZW5jZXMgZm9yIGRvY3VtZW50cyBzZW50IHZpYSBXYXRjaCBhcmUgYXV0b21hdGljYWxseSByZW1vdmVkIHdoZW4gd2UgZGVsZXRlIGFcclxuICAgICAgICAgICAgICAgIC8vIHF1ZXJ5J3MgdGFyZ2V0IGRhdGEgZnJvbSB0aGUgcmVmZXJlbmNlIGRlbGVnYXRlLiBTaW5jZSB0aGlzIGRvZXMgbm90IHJlbW92ZSByZWZlcmVuY2VzXHJcbiAgICAgICAgICAgICAgICAvLyBmb3IgbG9jYWxseSBtdXRhdGVkIGRvY3VtZW50cywgd2UgaGF2ZSB0byByZW1vdmUgdGhlIHRhcmdldCBhc3NvY2lhdGlvbnMgZm9yIHRoZXNlXHJcbiAgICAgICAgICAgICAgICAvLyBkb2N1bWVudHMgbWFudWFsbHkuXHJcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3ZlZCA9IF90aGlzLmxvY2FsVmlld1JlZmVyZW5jZXMucmVtb3ZlUmVmZXJlbmNlc0ZvcklkKHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5xdWVyeURhdGFCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICBpZiAoIWtlZXBQZXJzaXN0ZWRRdWVyeURhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2gocmVtb3ZlZCwgZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlUmVmZXJlbmNlKHR4biwga2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB9KS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVRhcmdldCh0eG4sIGNhY2hlZFF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSdW5zIHRoZSBzcGVjaWZpZWQgcXVlcnkgYWdhaW5zdCBhbGwgdGhlIGRvY3VtZW50cyBpbiB0aGUgbG9jYWwgc3RvcmUgYW5kXHJcbiAgICAgKiByZXR1cm5zIHRoZSByZXN1bHRzLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5leGVjdXRlUXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdFeGVjdXRlIHF1ZXJ5JywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0eG4sIHF1ZXJ5KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGtleXMgb2YgdGhlIGRvY3VtZW50cyB0aGF0IGFyZSBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuXHJcbiAgICAgKiB0YXJnZXQgaWQgaW4gdGhlIHJlbW90ZSB0YWJsZS5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUucmVtb3RlRG9jdW1lbnRLZXlzID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignUmVtb3RlIGRvY3VtZW50IGtleXMnLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5xdWVyeUNhY2hlLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHR4biwgdGFyZ2V0SWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5nZXRBY3RpdmVDbGllbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLmdldEFjdGl2ZUNsaWVudHMoKTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUucmVtb3ZlQ2FjaGVkTXV0YXRpb25CYXRjaE1ldGFkYXRhID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUucmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKGJhdGNoSWQpO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5zZXROZXR3b3JrRW5hYmxlZCA9IGZ1bmN0aW9uIChuZXR3b3JrRW5hYmxlZCkge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2Uuc2V0TmV0d29ya0VuYWJsZWQobmV0d29ya0VuYWJsZWQpO1xyXG4gICAgfTtcclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmFwcGx5V3JpdGVUb1JlbW90ZURvY3VtZW50cyA9IGZ1bmN0aW9uICh0eG4sIGJhdGNoUmVzdWx0LCBkb2N1bWVudEJ1ZmZlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGJhdGNoID0gYmF0Y2hSZXN1bHQuYmF0Y2g7XHJcbiAgICAgICAgdmFyIGRvY0tleXMgPSBiYXRjaC5rZXlzKCk7XHJcbiAgICAgICAgdmFyIHByb21pc2VDaGFpbiA9IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgZG9jS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChkb2NLZXkpIHtcclxuICAgICAgICAgICAgcHJvbWlzZUNoYWluID0gcHJvbWlzZUNoYWluXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnRCdWZmZXIuZ2V0RW50cnkodHhuLCBkb2NLZXkpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKHJlbW90ZURvYykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRvYyA9IHJlbW90ZURvYztcclxuICAgICAgICAgICAgICAgIHZhciBhY2tWZXJzaW9uID0gYmF0Y2hSZXN1bHQuZG9jVmVyc2lvbnMuZ2V0KGRvY0tleSk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoYWNrVmVyc2lvbiAhPT0gbnVsbCwgJ2Fja1ZlcnNpb25zIHNob3VsZCBjb250YWluIGV2ZXJ5IGRvYyBpbiB0aGUgd3JpdGUuJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWRvYyB8fCBkb2MudmVyc2lvbi5jb21wYXJlVG8oYWNrVmVyc2lvbikgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jID0gYmF0Y2guYXBwbHlUb1JlbW90ZURvY3VtZW50KGRvY0tleSwgZG9jLCBiYXRjaFJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCFyZW1vdGVEb2MsICdNdXRhdGlvbiBiYXRjaCAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgYXBwbGllZCB0byBkb2N1bWVudCAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZURvYyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIHJlc3VsdGVkIGluIG51bGwnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50QnVmZmVyLmFkZEVudHJ5KGRvYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcHJvbWlzZUNoYWluLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZS5yZW1vdmVNdXRhdGlvbkJhdGNoKHR4biwgYmF0Y2gpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5nZXRRdWVyeUZvclRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMucXVlcnlEYXRhQnlUYXJnZXRbdGFyZ2V0SWRdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5xdWVyeURhdGFCeVRhcmdldFt0YXJnZXRJZF0ucXVlcnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0dldCBxdWVyeSBkYXRhJywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5Q2FjaGVcclxuICAgICAgICAgICAgICAgICAgICAuZ2V0UXVlcnlEYXRhRm9yVGFyZ2V0KHR4biwgdGFyZ2V0SWQpXHJcbiAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKHF1ZXJ5RGF0YSkgeyByZXR1cm4gKHF1ZXJ5RGF0YSA/IHF1ZXJ5RGF0YS5xdWVyeSA6IG51bGwpOyB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5nZXROZXdEb2N1bWVudENoYW5nZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignR2V0IG5ldyBkb2N1bWVudCBjaGFuZ2VzJywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucmVtb3RlRG9jdW1lbnRzLmdldE5ld0RvY3VtZW50Q2hhbmdlcyh0eG4pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG1heGltdW0gdGltZSB0byBsZWF2ZSBhIHJlc3VtZSB0b2tlbiBidWZmZXJlZCB3aXRob3V0IHdyaXRpbmcgaXQgb3V0LlxyXG4gICAgICogVGhpcyB2YWx1ZSBpcyBhcmJpdHJhcnk6IGl0J3MgbG9uZyBlbm91Z2ggdG8gYXZvaWQgc2V2ZXJhbCB3cml0ZXNcclxuICAgICAqIChwb3NzaWJseSBpbmRlZmluaXRlbHkgaWYgdXBkYXRlcyBjb21lIG1vcmUgZnJlcXVlbnRseSB0aGFuIHRoaXMpIGJ1dFxyXG4gICAgICogc2hvcnQgZW5vdWdoIHRoYXQgcmVzdGFydGluZyBhZnRlciBjcmFzaGluZyB3aWxsIHN0aWxsIGhhdmUgYSBwcmV0dHlcclxuICAgICAqIHJlY2VudCByZXN1bWUgdG9rZW4uXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUuUkVTVU1FX1RPS0VOX01BWF9BR0VfTUlDUk9TID0gNSAqIDYwICogMWU2O1xyXG4gICAgcmV0dXJuIExvY2FsU3RvcmU7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTWVtb3J5TXV0YXRpb25RdWV1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lbW9yeU11dGF0aW9uUXVldWUocmVmZXJlbmNlRGVsZWdhdGUpIHtcclxuICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gcmVmZXJlbmNlRGVsZWdhdGU7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNldCBvZiBhbGwgbXV0YXRpb25zIHRoYXQgaGF2ZSBiZWVuIHNlbnQgYnV0IG5vdCB5ZXQgYmVlbiBhcHBsaWVkIHRvXHJcbiAgICAgICAgICogdGhlIGJhY2tlbmQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gW107XHJcbiAgICAgICAgLyoqIE5leHQgdmFsdWUgdG8gdXNlIHdoZW4gYXNzaWduaW5nIHNlcXVlbnRpYWwgSURzIHRvIGVhY2ggbXV0YXRpb24gYmF0Y2guICovXHJcbiAgICAgICAgdGhpcy5uZXh0QmF0Y2hJZCA9IDE7XHJcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IGFja25vd2xlZGdlZCBtdXRhdGlvbiBpbiB0aGUgcXVldWUuICovXHJcbiAgICAgICAgdGhpcy5oaWdoZXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCA9IEJBVENISURfVU5LTk9XTjtcclxuICAgICAgICAvKiogVGhlIGxhc3QgcmVjZWl2ZWQgc3RyZWFtIHRva2VuIGZyb20gdGhlIHNlcnZlciwgdXNlZCB0byBhY2tub3dsZWRnZSB3aGljaFxyXG4gICAgICAgICAqIHJlc3BvbnNlcyB0aGUgY2xpZW50IGhhcyBwcm9jZXNzZWQuIFN0cmVhbSB0b2tlbnMgYXJlIG9wYXF1ZSBjaGVja3BvaW50XHJcbiAgICAgICAgICogbWFya2VycyB3aG9zZSBvbmx5IHJlYWwgdmFsdWUgaXMgdGhlaXIgaW5jbHVzaW9uIGluIHRoZSBuZXh0IHJlcXVlc3QuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5sYXN0U3RyZWFtVG9rZW4gPSBlbXB0eUJ5dGVTdHJpbmcoKTtcclxuICAgICAgICAvKiogQW4gb3JkZXJlZCBtYXBwaW5nIGJldHdlZW4gZG9jdW1lbnRzIGFuZCB0aGUgbXV0YXRpb25zIGJhdGNoIElEcy4gKi9cclxuICAgICAgICB0aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5ID0gbmV3IFNvcnRlZFNldChEb2NSZWZlcmVuY2UuY29tcGFyZUJ5S2V5KTtcclxuICAgIH1cclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmNoZWNrRW1wdHkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCA9PT0gMCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuYWNrbm93bGVkZ2VCYXRjaCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2gsIHN0cmVhbVRva2VuKSB7XHJcbiAgICAgICAgdmFyIGJhdGNoSWQgPSBiYXRjaC5iYXRjaElkO1xyXG4gICAgICAgIGFzc2VydChiYXRjaElkID4gdGhpcy5oaWdoZXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCwgJ011dGF0aW9uIGJhdGNoSURzIG11c3QgYmUgYWNrbm93bGVkZ2VkIGluIG9yZGVyJyk7XHJcbiAgICAgICAgdmFyIGJhdGNoSW5kZXggPSB0aGlzLmluZGV4T2ZFeGlzdGluZ0JhdGNoSWQoYmF0Y2hJZCwgJ2Fja25vd2xlZGdlZCcpO1xyXG4gICAgICAgIGFzc2VydChiYXRjaEluZGV4ID09PSAwLCAnQ2FuIG9ubHkgYWNrbm93bGVkZ2UgdGhlIGZpcnN0IGJhdGNoIGluIHRoZSBtdXRhdGlvbiBxdWV1ZScpO1xyXG4gICAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZSBiYXRjaCBpbiB0aGUgcXVldWUgaXMgdGhlIG9uZSB0byBiZSBhY2tub3dsZWRnZWQuXHJcbiAgICAgICAgdmFyIGNoZWNrID0gdGhpcy5tdXRhdGlvblF1ZXVlW2JhdGNoSW5kZXhdO1xyXG4gICAgICAgIGFzc2VydChiYXRjaElkID09PSBjaGVjay5iYXRjaElkLCAnUXVldWUgb3JkZXJpbmcgZmFpbHVyZTogZXhwZWN0ZWQgYmF0Y2ggJyArXHJcbiAgICAgICAgICAgIGJhdGNoSWQgK1xyXG4gICAgICAgICAgICAnLCBnb3QgYmF0Y2ggJyArXHJcbiAgICAgICAgICAgIGNoZWNrLmJhdGNoSWQpO1xyXG4gICAgICAgIHRoaXMuaGlnaGVzdEFja25vd2xlZGdlZEJhdGNoSWQgPSBiYXRjaElkO1xyXG4gICAgICAgIHRoaXMubGFzdFN0cmVhbVRva2VuID0gc3RyZWFtVG9rZW47XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0TGFzdFN0cmVhbVRva2VuID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMubGFzdFN0cmVhbVRva2VuKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5zZXRMYXN0U3RyZWFtVG9rZW4gPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHN0cmVhbVRva2VuKSB7XHJcbiAgICAgICAgdGhpcy5sYXN0U3RyZWFtVG9rZW4gPSBzdHJlYW1Ub2tlbjtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hZGRNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBsb2NhbFdyaXRlVGltZSwgbXV0YXRpb25zKSB7XHJcbiAgICAgICAgYXNzZXJ0KG11dGF0aW9ucy5sZW5ndGggIT09IDAsICdNdXRhdGlvbiBiYXRjaGVzIHNob3VsZCBub3QgYmUgZW1wdHknKTtcclxuICAgICAgICB2YXIgYmF0Y2hJZCA9IHRoaXMubmV4dEJhdGNoSWQ7XHJcbiAgICAgICAgdGhpcy5uZXh0QmF0Y2hJZCsrO1xyXG4gICAgICAgIGlmICh0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgcHJpb3IgPSB0aGlzLm11dGF0aW9uUXVldWVbdGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICBhc3NlcnQocHJpb3IuYmF0Y2hJZCA8IGJhdGNoSWQsICdNdXRhdGlvbiBiYXRjaElEcyBtdXN0IGJlIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZyBvcmRlcicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYmF0Y2ggPSBuZXcgTXV0YXRpb25CYXRjaChiYXRjaElkLCBsb2NhbFdyaXRlVGltZSwgbXV0YXRpb25zKTtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUucHVzaChiYXRjaCk7XHJcbiAgICAgICAgLy8gVHJhY2sgcmVmZXJlbmNlcyBieSBkb2N1bWVudCBrZXkuXHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBtdXRhdGlvbnNfMSA9IG11dGF0aW9uczsgX2kgPCBtdXRhdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG11dGF0aW9uID0gbXV0YXRpb25zXzFbX2ldO1xyXG4gICAgICAgICAgICB0aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5ID0gdGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleS5hZGQobmV3IERvY1JlZmVyZW5jZShtdXRhdGlvbi5rZXksIGJhdGNoSWQpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGJhdGNoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5sb29rdXBNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuZmluZE11dGF0aW9uQmF0Y2goYmF0Y2hJZCkpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmxvb2t1cE11dGF0aW9uS2V5cyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBtdXRhdGlvbkJhdGNoID0gdGhpcy5maW5kTXV0YXRpb25CYXRjaChiYXRjaElkKTtcclxuICAgICAgICBhc3NlcnQobXV0YXRpb25CYXRjaCAhPSBudWxsLCAnRmFpbGVkIHRvIGZpbmQgbG9jYWwgbXV0YXRpb24gYmF0Y2guJyk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG11dGF0aW9uQmF0Y2gua2V5cygpKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2hJZCkge1xyXG4gICAgICAgIC8vIEFsbCBiYXRjaGVzIHdpdGggYmF0Y2hJZCA8PSB0aGlzLmhpZ2hlc3RBY2tub3dsZWRnZWRCYXRjaElkIGhhdmUgYmVlblxyXG4gICAgICAgIC8vIGFja25vd2xlZGdlZCBzbyB0aGUgZmlyc3QgdW5hY2tub3dsZWRnZWQgYmF0Y2ggYWZ0ZXIgYmF0Y2hJRCB3aWxsIGhhdmUgYVxyXG4gICAgICAgIC8vIGJhdGNoSUQgbGFyZ2VyIHRoYW4gYm90aCBvZiB0aGVzZSB2YWx1ZXMuXHJcbiAgICAgICAgdmFyIG5leHRCYXRjaElkID0gTWF0aC5tYXgoYmF0Y2hJZCwgdGhpcy5oaWdoZXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCkgKyAxO1xyXG4gICAgICAgIC8vIFRoZSByZXF1ZXN0ZWQgYmF0Y2hJZCBtYXkgc3RpbGwgYmUgb3V0IG9mIHJhbmdlIHNvIG5vcm1hbGl6ZSBpdCB0byB0aGVcclxuICAgICAgICAvLyBzdGFydCBvZiB0aGUgcXVldWUuXHJcbiAgICAgICAgdmFyIHJhd0luZGV4ID0gdGhpcy5pbmRleE9mQmF0Y2hJZChuZXh0QmF0Y2hJZCk7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gcmF3SW5kZXggPCAwID8gMCA6IHJhd0luZGV4O1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoID4gaW5kZXggPyB0aGlzLm11dGF0aW9uUXVldWVbaW5kZXhdIDogbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMubXV0YXRpb25RdWV1ZS5zbGljZSgpKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzdGFydCA9IG5ldyBEb2NSZWZlcmVuY2UoZG9jdW1lbnRLZXksIDApO1xyXG4gICAgICAgIHZhciBlbmQgPSBuZXcgRG9jUmVmZXJlbmNlKGRvY3VtZW50S2V5LCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICB0aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5LmZvckVhY2hJblJhbmdlKFtzdGFydCwgZW5kXSwgZnVuY3Rpb24gKHJlZikge1xyXG4gICAgICAgICAgICBhc3NlcnQoZG9jdW1lbnRLZXkuaXNFcXVhbChyZWYua2V5KSwgXCJTaG91bGQgb25seSBpdGVyYXRlIG92ZXIgYSBzaW5nbGUga2V5J3MgYmF0Y2hlc1wiKTtcclxuICAgICAgICAgICAgdmFyIGJhdGNoID0gX3RoaXMuZmluZE11dGF0aW9uQmF0Y2gocmVmLnRhcmdldE9yQmF0Y2hJZCk7XHJcbiAgICAgICAgICAgIGFzc2VydChiYXRjaCAhPT0gbnVsbCwgJ0JhdGNoZXMgaW4gdGhlIGluZGV4IG11c3QgZXhpc3QgaW4gdGhlIG1haW4gdGFibGUnKTtcclxuICAgICAgICAgICAgcmVzdWx0LnB1c2goYmF0Y2gpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5cyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXlzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgdW5pcXVlQmF0Y2hJRHMgPSBuZXcgU29ydGVkU2V0KHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG4gICAgICAgIGRvY3VtZW50S2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChkb2N1bWVudEtleSkge1xyXG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBuZXcgRG9jUmVmZXJlbmNlKGRvY3VtZW50S2V5LCAwKTtcclxuICAgICAgICAgICAgdmFyIGVuZCA9IG5ldyBEb2NSZWZlcmVuY2UoZG9jdW1lbnRLZXksIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSk7XHJcbiAgICAgICAgICAgIF90aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5LmZvckVhY2hJblJhbmdlKFtzdGFydCwgZW5kXSwgZnVuY3Rpb24gKHJlZikge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGRvY3VtZW50S2V5LmlzRXF1YWwocmVmLmtleSksIFwiRm9yIGVhY2gga2V5LCBzaG91bGQgb25seSBpdGVyYXRlIG92ZXIgYSBzaW5nbGUga2V5J3MgYmF0Y2hlc1wiKTtcclxuICAgICAgICAgICAgICAgIHVuaXF1ZUJhdGNoSURzID0gdW5pcXVlQmF0Y2hJRHMuYWRkKHJlZi50YXJnZXRPckJhdGNoSWQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5maW5kTXV0YXRpb25CYXRjaGVzKHVuaXF1ZUJhdGNoSURzKSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5KSB7XHJcbiAgICAgICAgLy8gVXNlIHRoZSBxdWVyeSBwYXRoIGFzIGEgcHJlZml4IGZvciB0ZXN0aW5nIGlmIGEgZG9jdW1lbnQgbWF0Y2hlcyB0aGVcclxuICAgICAgICAvLyBxdWVyeS5cclxuICAgICAgICB2YXIgcHJlZml4ID0gcXVlcnkucGF0aDtcclxuICAgICAgICB2YXIgaW1tZWRpYXRlQ2hpbGRyZW5QYXRoTGVuZ3RoID0gcHJlZml4Lmxlbmd0aCArIDE7XHJcbiAgICAgICAgLy8gQ29uc3RydWN0IGEgZG9jdW1lbnQgcmVmZXJlbmNlIGZvciBhY3R1YWxseSBzY2FubmluZyB0aGUgaW5kZXguIFVubGlrZVxyXG4gICAgICAgIC8vIHRoZSBwcmVmaXggdGhlIGRvY3VtZW50IGtleSBpbiB0aGlzIHJlZmVyZW5jZSBtdXN0IGhhdmUgYW4gZXZlbiBudW1iZXIgb2ZcclxuICAgICAgICAvLyBzZWdtZW50cy4gVGhlIGVtcHR5IHNlZ21lbnQgY2FuIGJlIHVzZWQgYSBzdWZmaXggb2YgdGhlIHF1ZXJ5IHBhdGhcclxuICAgICAgICAvLyBiZWNhdXNlIGl0IHByZWNlZGVzIGFsbCBvdGhlciBzZWdtZW50cyBpbiBhbiBvcmRlcmVkIHRyYXZlcnNhbC5cclxuICAgICAgICB2YXIgc3RhcnRQYXRoID0gcHJlZml4O1xyXG4gICAgICAgIGlmICghRG9jdW1lbnRLZXkuaXNEb2N1bWVudEtleShzdGFydFBhdGgpKSB7XHJcbiAgICAgICAgICAgIHN0YXJ0UGF0aCA9IHN0YXJ0UGF0aC5jaGlsZCgnJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzdGFydCA9IG5ldyBEb2NSZWZlcmVuY2UobmV3IERvY3VtZW50S2V5KHN0YXJ0UGF0aCksIDApO1xyXG4gICAgICAgIC8vIEZpbmQgdW5pcXVlIGJhdGNoSURzIHJlZmVyZW5jZWQgYnkgYWxsIGRvY3VtZW50cyBwb3RlbnRpYWxseSBtYXRjaGluZyB0aGVcclxuICAgICAgICAvLyBxdWVyeS5cclxuICAgICAgICB2YXIgdW5pcXVlQmF0Y2hJRHMgPSBuZXcgU29ydGVkU2V0KHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG4gICAgICAgIHRoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXkuZm9yRWFjaFdoaWxlKGZ1bmN0aW9uIChyZWYpIHtcclxuICAgICAgICAgICAgdmFyIHJvd0tleVBhdGggPSByZWYua2V5LnBhdGg7XHJcbiAgICAgICAgICAgIGlmICghcHJlZml4LmlzUHJlZml4T2Yocm93S2V5UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIFJvd3Mgd2l0aCBkb2N1bWVudCBrZXlzIG1vcmUgdGhhbiBvbmUgc2VnbWVudCBsb25nZXIgdGhhbiB0aGUgcXVlcnlcclxuICAgICAgICAgICAgICAgIC8vIHBhdGggY2FuJ3QgYmUgbWF0Y2hlcy4gRm9yIGV4YW1wbGUsIGEgcXVlcnkgb24gJ3Jvb21zJyBjYW4ndCBtYXRjaFxyXG4gICAgICAgICAgICAgICAgLy8gdGhlIGRvY3VtZW50IC9yb29tcy9hYmMvbWVzc2FnZXMveHl4LlxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhtY2cpOiB3ZSdsbCBuZWVkIGEgZGlmZmVyZW50IHNjYW5uZXIgd2hlbiB3ZSBpbXBsZW1lbnRcclxuICAgICAgICAgICAgICAgIC8vIGFuY2VzdG9yIHF1ZXJpZXMuXHJcbiAgICAgICAgICAgICAgICBpZiAocm93S2V5UGF0aC5sZW5ndGggPT09IGltbWVkaWF0ZUNoaWxkcmVuUGF0aExlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZUJhdGNoSURzID0gdW5pcXVlQmF0Y2hJRHMuYWRkKHJlZi50YXJnZXRPckJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBzdGFydCk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuZmluZE11dGF0aW9uQmF0Y2hlcyh1bmlxdWVCYXRjaElEcykpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmZpbmRNdXRhdGlvbkJhdGNoZXMgPSBmdW5jdGlvbiAoYmF0Y2hJRHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIENvbnN0cnVjdCBhbiBhcnJheSBvZiBtYXRjaGluZyBiYXRjaGVzLCBzb3J0ZWQgYnkgYmF0Y2hJRCB0byBlbnN1cmUgdGhhdFxyXG4gICAgICAgIC8vIG11bHRpcGxlIG11dGF0aW9ucyBhZmZlY3RpbmcgdGhlIHNhbWUgZG9jdW1lbnQga2V5IGFyZSBhcHBsaWVkIGluIG9yZGVyLlxyXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICBiYXRjaElEcy5mb3JFYWNoKGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgICAgIHZhciBiYXRjaCA9IF90aGlzLmZpbmRNdXRhdGlvbkJhdGNoKGJhdGNoSWQpO1xyXG4gICAgICAgICAgICBpZiAoYmF0Y2ggIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGJhdGNoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUucmVtb3ZlTXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2gpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIEZpbmQgdGhlIHBvc2l0aW9uIG9mIHRoZSBmaXJzdCBiYXRjaCBmb3IgcmVtb3ZhbC4gVGhpcyBuZWVkIG5vdCBiZSB0aGVcclxuICAgICAgICAvLyBmaXJzdCBlbnRyeSBpbiB0aGUgcXVldWUuXHJcbiAgICAgICAgdmFyIGJhdGNoSW5kZXggPSB0aGlzLmluZGV4T2ZFeGlzdGluZ0JhdGNoSWQoYmF0Y2guYmF0Y2hJZCwgJ3JlbW92ZWQnKTtcclxuICAgICAgICBhc3NlcnQoYmF0Y2hJbmRleCA9PT0gMCwgJ0NhbiBvbmx5IHJlbW92ZSB0aGUgZmlyc3QgZW50cnkgb2YgdGhlIG11dGF0aW9uIHF1ZXVlJyk7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLnNoaWZ0KCk7XHJcbiAgICAgICAgdmFyIHJlZmVyZW5jZXMgPSB0aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5O1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaChiYXRjaC5tdXRhdGlvbnMsIGZ1bmN0aW9uIChtdXRhdGlvbikge1xyXG4gICAgICAgICAgICB2YXIgcmVmID0gbmV3IERvY1JlZmVyZW5jZShtdXRhdGlvbi5rZXksIGJhdGNoLmJhdGNoSWQpO1xyXG4gICAgICAgICAgICByZWZlcmVuY2VzID0gcmVmZXJlbmNlcy5kZWxldGUocmVmKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZU11dGF0aW9uUmVmZXJlbmNlKHRyYW5zYWN0aW9uLCBtdXRhdGlvbi5rZXkpO1xyXG4gICAgICAgIH0pLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleSA9IHJlZmVyZW5jZXM7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUucmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICAvLyBOby1vcCBzaW5jZSB0aGUgbWVtb3J5IG11dGF0aW9uIHF1ZXVlIGRvZXMgbm90IG1haW50YWluIGEgc2VwYXJhdGUgY2FjaGUuXHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuY29udGFpbnNLZXkgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB2YXIgcmVmID0gbmV3IERvY1JlZmVyZW5jZShrZXksIDApO1xyXG4gICAgICAgIHZhciBmaXJzdFJlZiA9IHRoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXkuZmlyc3RBZnRlck9yRXF1YWwocmVmKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoa2V5LmlzRXF1YWwoZmlyc3RSZWYgJiYgZmlyc3RSZWYua2V5KSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgYXNzZXJ0KHRoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXkuaXNFbXB0eSgpLCAnRG9jdW1lbnQgbGVhayAtLSBkZXRlY3RlZCBkYW5nbGluZyBtdXRhdGlvbiByZWZlcmVuY2VzIHdoZW4gcXVldWUgaXMgZW1wdHkuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogRmluZHMgdGhlIGluZGV4IG9mIHRoZSBnaXZlbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZSBhbmQgYXNzZXJ0cyB0aGF0XHJcbiAgICAgKiB0aGUgcmVzdWx0aW5nIGluZGV4IGlzIHdpdGhpbiB0aGUgYm91bmRzIG9mIHRoZSBxdWV1ZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYmF0Y2hJZCBUaGUgYmF0Y2hJZCB0byBzZWFyY2ggZm9yXHJcbiAgICAgKiBAcGFyYW0gYWN0aW9uIEEgZGVzY3JpcHRpb24gb2Ygd2hhdCB0aGUgY2FsbGVyIGlzIGRvaW5nLCBwaHJhc2VkIGluIHBhc3NpdmVcclxuICAgICAqIGZvcm0gKGUuZy4gXCJhY2tub3dsZWRnZWRcIiBpbiBhIHJvdXRpbmUgdGhhdCBhY2tub3dsZWRnZXMgYmF0Y2hlcykuXHJcbiAgICAgKi9cclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmluZGV4T2ZFeGlzdGluZ0JhdGNoSWQgPSBmdW5jdGlvbiAoYmF0Y2hJZCwgYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleE9mQmF0Y2hJZChiYXRjaElkKTtcclxuICAgICAgICBhc3NlcnQoaW5kZXggPj0gMCAmJiBpbmRleCA8IHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGgsICdCYXRjaGVzIG11c3QgZXhpc3QgdG8gYmUgJyArIGFjdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIGluZGV4O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogRmluZHMgdGhlIGluZGV4IG9mIHRoZSBnaXZlbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZS4gVGhpcyBvcGVyYXRpb25cclxuICAgICAqIGlzIE8oMSkuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybiBUaGUgY29tcHV0ZWQgaW5kZXggb2YgdGhlIGJhdGNoIHdpdGggdGhlIGdpdmVuIGJhdGNoSWQsIGJhc2VkIG9uXHJcbiAgICAgKiB0aGUgc3RhdGUgb2YgdGhlIHF1ZXVlLiBOb3RlIHRoaXMgaW5kZXggY2FuIGJlIG5lZ2F0aXZlIGlmIHRoZSByZXF1ZXN0ZWRcclxuICAgICAqIGJhdGNoSWQgaGFzIGFscmVhZHkgYmVlbiByZW12b2VkIGZyb20gdGhlIHF1ZXVlIG9yIHBhc3QgdGhlIGVuZCBvZiB0aGVcclxuICAgICAqIHF1ZXVlIGlmIHRoZSBiYXRjaElkIGlzIGxhcmdlciB0aGFuIHRoZSBsYXN0IGFkZGVkIGJhdGNoLlxyXG4gICAgICovXHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5pbmRleE9mQmF0Y2hJZCA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgLy8gQXMgYW4gaW5kZXggdGhpcyBpcyBwYXN0IHRoZSBlbmQgb2YgdGhlIHF1ZXVlXHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBFeGFtaW5lIHRoZSBmcm9udCBvZiB0aGUgcXVldWUgdG8gZmlndXJlIG91dCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZVxyXG4gICAgICAgIC8vIGJhdGNoSWQgYW5kIGluZGV4ZXMgaW4gdGhlIGFycmF5LiBOb3RlIHRoYXQgc2luY2UgdGhlIHF1ZXVlIGlzIG9yZGVyZWRcclxuICAgICAgICAvLyBieSBiYXRjaElkLCBpZiB0aGUgZmlyc3QgYmF0Y2ggaGFzIGEgbGFyZ2VyIGJhdGNoSWQgdGhlbiB0aGUgcmVxdWVzdGVkXHJcbiAgICAgICAgLy8gYmF0Y2hJZCBkb2Vzbid0IGV4aXN0IGluIHRoZSBxdWV1ZS5cclxuICAgICAgICB2YXIgZmlyc3RCYXRjaElkID0gdGhpcy5tdXRhdGlvblF1ZXVlWzBdLmJhdGNoSWQ7XHJcbiAgICAgICAgcmV0dXJuIGJhdGNoSWQgLSBmaXJzdEJhdGNoSWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBIHZlcnNpb24gb2YgbG9va3VwTXV0YXRpb25CYXRjaCB0aGF0IGRvZXNuJ3QgcmV0dXJuIGEgcHJvbWlzZSwgdGhpcyBtYWtlc1xyXG4gICAgICogb3RoZXIgZnVuY3Rpb25zIHRoYXQgdXNlcyB0aGlzIGNvZGUgZWFzaWVyIHRvIHJlYWQgYW5kIG1vcmUgZWZmaWNlbnQuXHJcbiAgICAgKi9cclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmZpbmRNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmluZGV4T2ZCYXRjaElkKGJhdGNoSWQpO1xyXG4gICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGJhdGNoID0gdGhpcy5tdXRhdGlvblF1ZXVlW2luZGV4XTtcclxuICAgICAgICBhc3NlcnQoYmF0Y2guYmF0Y2hJZCA9PT0gYmF0Y2hJZCwgJ0lmIGZvdW5kIGJhdGNoIG11c3QgbWF0Y2gnKTtcclxuICAgICAgICByZXR1cm4gYmF0Y2g7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1lbW9yeU11dGF0aW9uUXVldWU7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTWVtb3J5UXVlcnlDYWNoZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lbW9yeVF1ZXJ5Q2FjaGUocGVyc2lzdGVuY2UpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gcGVyc2lzdGVuY2U7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogTWFwcyBhIHF1ZXJ5IHRvIHRoZSBkYXRhIGFib3V0IHRoYXQgcXVlcnlcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnF1ZXJpZXMgPSBuZXcgT2JqZWN0TWFwKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxLmNhbm9uaWNhbElkKCk7IH0pO1xyXG4gICAgICAgIC8qKiBUaGUgbGFzdCByZWNlaXZlZCBzbmFwc2hvdCB2ZXJzaW9uLiAqL1xyXG4gICAgICAgIHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IFNuYXBzaG90VmVyc2lvbi5NSU47XHJcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IG51bWJlcmVkIHRhcmdldCBJRCBlbmNvdW50ZXJlZC4gKi9cclxuICAgICAgICB0aGlzLmhpZ2hlc3RUYXJnZXRJZCA9IDA7XHJcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IHNlcXVlbmNlIG51bWJlciBlbmNvdW50ZXJlZC4gKi9cclxuICAgICAgICB0aGlzLmhpZ2hlc3RTZXF1ZW5jZU51bWJlciA9IDA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBvcmRlcmVkIGJpZGlyZWN0aW9uYWwgbWFwcGluZyBiZXR3ZWVuIGRvY3VtZW50cyBhbmQgdGhlIHJlbW90ZSB0YXJnZXRcclxuICAgICAgICAgKiBJRHMuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VzID0gbmV3IFJlZmVyZW5jZVNldCgpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0Q291bnQgPSAwO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0SWRHZW5lcmF0b3IgPSBUYXJnZXRJZEdlbmVyYXRvci5mb3JRdWVyeUNhY2hlKCk7XHJcbiAgICB9XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRUYXJnZXRDb3VudCA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy50YXJnZXRDb3VudCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuZm9yRWFjaFRhcmdldCA9IGZ1bmN0aW9uICh0eG4sIGYpIHtcclxuICAgICAgICB0aGlzLnF1ZXJpZXMuZm9yRWFjaChmdW5jdGlvbiAoXywgcXVlcnlEYXRhKSB7IHJldHVybiBmKHF1ZXJ5RGF0YSk7IH0pO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5oaWdoZXN0U2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmFsbG9jYXRlVGFyZ2V0SWQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgbmV4dFRhcmdldElkID0gdGhpcy50YXJnZXRJZEdlbmVyYXRvci5hZnRlcih0aGlzLmhpZ2hlc3RUYXJnZXRJZCk7XHJcbiAgICAgICAgdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSBuZXh0VGFyZ2V0SWQ7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG5leHRUYXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuc2V0VGFyZ2V0c01ldGFkYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIsIGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24pIHtcclxuICAgICAgICBpZiAobGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbikge1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID4gdGhpcy5oaWdoZXN0U2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5oaWdoZXN0U2VxdWVuY2VOdW1iZXIgPSBoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLnNhdmVRdWVyeURhdGEgPSBmdW5jdGlvbiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzLnNldChxdWVyeURhdGEucXVlcnksIHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgdmFyIHRhcmdldElkID0gcXVlcnlEYXRhLnRhcmdldElkO1xyXG4gICAgICAgIGlmICh0YXJnZXRJZCA+IHRoaXMuaGlnaGVzdFRhcmdldElkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlnaGVzdFRhcmdldElkID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChxdWVyeURhdGEuc2VxdWVuY2VOdW1iZXIgPiB0aGlzLmhpZ2hlc3RTZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICB0aGlzLmhpZ2hlc3RTZXF1ZW5jZU51bWJlciA9IHF1ZXJ5RGF0YS5zZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuYWRkUXVlcnlEYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEpIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMucXVlcmllcy5oYXMocXVlcnlEYXRhLnF1ZXJ5KSwgJ0FkZGluZyBhIHF1ZXJ5IHRoYXQgYWxyZWFkeSBleGlzdHMnKTtcclxuICAgICAgICB0aGlzLnNhdmVRdWVyeURhdGEocXVlcnlEYXRhKTtcclxuICAgICAgICB0aGlzLnRhcmdldENvdW50ICs9IDE7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUudXBkYXRlUXVlcnlEYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5xdWVyaWVzLmhhcyhxdWVyeURhdGEucXVlcnkpLCAnVXBkYXRpbmcgYSBub24tZXhpc3RlbnQgcXVlcnknKTtcclxuICAgICAgICB0aGlzLnNhdmVRdWVyeURhdGEocXVlcnlEYXRhKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5yZW1vdmVRdWVyeURhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnRhcmdldENvdW50ID4gMCwgJ1JlbW92aW5nIGEgdGFyZ2V0IGZyb20gYW4gZW1wdHkgY2FjaGUnKTtcclxuICAgICAgICBhc3NlcnQodGhpcy5xdWVyaWVzLmhhcyhxdWVyeURhdGEucXVlcnkpLCAnUmVtb3ZpbmcgYSBub24tZXhpc3RlbnQgdGFyZ2V0IGZyb20gdGhlIGNhY2hlJyk7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzLmRlbGV0ZShxdWVyeURhdGEucXVlcnkpO1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlcy5yZW1vdmVSZWZlcmVuY2VzRm9ySWQocXVlcnlEYXRhLnRhcmdldElkKTtcclxuICAgICAgICB0aGlzLnRhcmdldENvdW50IC09IDE7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUucmVtb3ZlVGFyZ2V0cyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgdXBwZXJCb3VuZCwgYWN0aXZlVGFyZ2V0SWRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY291bnQgPSAwO1xyXG4gICAgICAgIHZhciByZW1vdmFscyA9IFtdO1xyXG4gICAgICAgIHRoaXMucXVlcmllcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgICAgICBpZiAocXVlcnlEYXRhLnNlcXVlbmNlTnVtYmVyIDw9IHVwcGVyQm91bmQgJiZcclxuICAgICAgICAgICAgICAgICFhY3RpdmVUYXJnZXRJZHNbcXVlcnlEYXRhLnRhcmdldElkXSkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucXVlcmllcy5kZWxldGUoa2V5KTtcclxuICAgICAgICAgICAgICAgIHJlbW92YWxzLnB1c2goX3RoaXMucmVtb3ZlTWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YS50YXJnZXRJZCkpO1xyXG4gICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihyZW1vdmFscykubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBjb3VudDsgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0UXVlcnlDb3VudCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLnRhcmdldENvdW50KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRRdWVyeURhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIHF1ZXJ5RGF0YSA9IHRoaXMucXVlcmllcy5nZXQocXVlcnkpIHx8IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHF1ZXJ5RGF0YSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0UXVlcnlEYXRhRm9yVGFyZ2V0ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIC8vIFRoaXMgbWV0aG9kIGlzIG9ubHkgbmVlZGVkIGZvciBtdWx0aS10YWIgYW5kIHdlIGNhbid0IGltcGxlbWVudCBpdFxyXG4gICAgICAgIC8vIGVmZmljaWVudGx5IHdpdGhvdXQgYWRkaXRpb25hbCBkYXRhIHN0cnVjdHVyZXMuXHJcbiAgICAgICAgcmV0dXJuIGZhaWwoJ05vdCB5ZXQgaW1wbGVtZW50ZWQuJyk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuYWRkTWF0Y2hpbmdLZXlzID0gZnVuY3Rpb24gKHR4biwga2V5cywgdGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLnJlZmVyZW5jZXMuYWRkUmVmZXJlbmNlcyhrZXlzLCB0YXJnZXRJZCk7XHJcbiAgICAgICAgdmFyIHJlZmVyZW5jZURlbGVnYXRlID0gdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZTtcclxuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICBpZiAocmVmZXJlbmNlRGVsZWdhdGUpIHtcclxuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2gocmVmZXJlbmNlRGVsZWdhdGUuYWRkUmVmZXJlbmNlKHR4biwga2V5KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLnJlbW92ZU1hdGNoaW5nS2V5cyA9IGZ1bmN0aW9uICh0eG4sIGtleXMsIHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VzLnJlbW92ZVJlZmVyZW5jZXMoa2V5cywgdGFyZ2V0SWQpO1xyXG4gICAgICAgIHZhciByZWZlcmVuY2VEZWxlZ2F0ZSA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGU7XHJcbiAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgaWYgKHJlZmVyZW5jZURlbGVnYXRlKSB7XHJcbiAgICAgICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVJlZmVyZW5jZSh0eG4sIGtleSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCA9IGZ1bmN0aW9uICh0eG4sIHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VzLnJlbW92ZVJlZmVyZW5jZXNGb3JJZCh0YXJnZXRJZCk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQgPSBmdW5jdGlvbiAodHhuLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBtYXRjaGluZ0tleXMgPSB0aGlzLnJlZmVyZW5jZXMucmVmZXJlbmNlc0ZvcklkKHRhcmdldElkKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUobWF0Y2hpbmdLZXlzKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5jb250YWluc0tleSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLnJlZmVyZW5jZXMuY29udGFpbnNLZXkoa2V5KSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1lbW9yeVF1ZXJ5Q2FjaGU7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBkb2N1bWVudFNpemVNYXAoKSB7XHJcbiAgICByZXR1cm4gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxufVxyXG52YXIgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIHNpemVyIFVzZWQgdG8gYXNzZXNzIHRoZSBzaXplIG9mIGEgZG9jdW1lbnQuIEZvciBlYWdlciBHQywgdGhpcyBpcyBleHBlY3RlZCB0byBqdXN0XHJcbiAgICAgKiByZXR1cm4gMCB0byBhdm9pZCB1bm5lY2Vzc2FyaWx5IGRvaW5nIHRoZSB3b3JrIG9mIGNhbGN1bGF0aW5nIHRoZSBzaXplLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlKHNpemVyKSB7XHJcbiAgICAgICAgdGhpcy5zaXplciA9IHNpemVyO1xyXG4gICAgICAgIHRoaXMuZG9jcyA9IGRvY3VtZW50U2l6ZU1hcCgpO1xyXG4gICAgICAgIHRoaXMubmV3RG9jdW1lbnRDaGFuZ2VzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB0aGlzLnNpemUgPSAwO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIHRoZSBzdXBwbGllZCBlbnRyaWVzIHRvIHRoZSBjYWNoZS4gQWRkcyB0aGUgZ2l2ZW4gc2l6ZSBkZWx0YSB0byB0aGUgY2FjaGVkIHNpemUuXHJcbiAgICAgKi9cclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmFkZEVudHJpZXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGVudHJpZXMsIHNpemVEZWx0YSkge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgZW50cmllc18xID0gZW50cmllczsgX2kgPCBlbnRyaWVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBlbnRyeSA9IGVudHJpZXNfMVtfaV07XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBlbnRyeS5tYXliZURvY3VtZW50LmtleTtcclxuICAgICAgICAgICAgdGhpcy5kb2NzID0gdGhpcy5kb2NzLmluc2VydChrZXksIGVudHJ5KTtcclxuICAgICAgICAgICAgdGhpcy5uZXdEb2N1bWVudENoYW5nZXMgPSB0aGlzLm5ld0RvY3VtZW50Q2hhbmdlcy5hZGQoa2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zaXplICs9IHNpemVEZWx0YTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgdGhlIHNwZWNpZmllZCBlbnRyeSBmcm9tIHRoZSBjYWNoZSBhbmQgdXBkYXRlcyB0aGUgc2l6ZSBhcyBhcHByb3ByaWF0ZS5cclxuICAgICAqL1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUucmVtb3ZlRW50cnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy5kb2NzLmdldChkb2N1bWVudEtleSk7XHJcbiAgICAgICAgaWYgKGVudHJ5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZG9jcyA9IHRoaXMuZG9jcy5yZW1vdmUoZG9jdW1lbnRLZXkpO1xyXG4gICAgICAgICAgICB0aGlzLnNpemUgLT0gZW50cnkuc2l6ZTtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGVudHJ5LnNpemUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKDApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXRFbnRyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLmRvY3MuZ2V0KGRvY3VtZW50S2V5KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoZW50cnkgPyBlbnRyeS5tYXliZURvY3VtZW50IDogbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBMb29rcyB1cCBhbiBlbnRyeSBpbiB0aGUgY2FjaGUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGRvY3VtZW50S2V5IFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGxvb2sgdXAuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBjYWNoZWQgTWF5YmVEb2N1bWVudCBlbnRyeSBhbmQgaXRzIHNpemUsIG9yIG51bGwgaWYgd2UgaGF2ZSBub3RoaW5nIGNhY2hlZC5cclxuICAgICAqL1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0U2l6ZWRFbnRyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5kb2NzLmdldChkb2N1bWVudEtleSkpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBkb2N1bWVudE1hcCgpO1xyXG4gICAgICAgIC8vIERvY3VtZW50cyBhcmUgb3JkZXJlZCBieSBrZXksIHNvIHdlIGNhbiB1c2UgYSBwcmVmaXggc2NhbiB0byBuYXJyb3cgZG93blxyXG4gICAgICAgIC8vIHRoZSBkb2N1bWVudHMgd2UgbmVlZCB0byBtYXRjaCB0aGUgcXVlcnkgYWdhaW5zdC5cclxuICAgICAgICB2YXIgcHJlZml4ID0gbmV3IERvY3VtZW50S2V5KHF1ZXJ5LnBhdGguY2hpbGQoJycpKTtcclxuICAgICAgICB2YXIgaXRlcmF0b3IgPSB0aGlzLmRvY3MuZ2V0SXRlcmF0b3JGcm9tKHByZWZpeCk7XHJcbiAgICAgICAgd2hpbGUgKGl0ZXJhdG9yLmhhc05leHQoKSkge1xyXG4gICAgICAgICAgICB2YXIgX2EgPSBpdGVyYXRvci5nZXROZXh0KCksIGtleSA9IF9hLmtleSwgbWF5YmVEb2N1bWVudCA9IF9hLnZhbHVlLm1heWJlRG9jdW1lbnQ7XHJcbiAgICAgICAgICAgIGlmICghcXVlcnkucGF0aC5pc1ByZWZpeE9mKGtleS5wYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG1heWJlRG9jdW1lbnQgaW5zdGFuY2VvZiBEb2N1bWVudCAmJiBxdWVyeS5tYXRjaGVzKG1heWJlRG9jdW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5pbnNlcnQobWF5YmVEb2N1bWVudC5rZXksIG1heWJlRG9jdW1lbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShyZXN1bHRzKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5mb3JFYWNoRG9jdW1lbnRLZXkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGYpIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2godGhpcy5kb2NzLCBmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBmKGtleSk7IH0pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldE5ld0RvY3VtZW50Q2hhbmdlcyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNoYW5nZWREb2NzID0gbWF5YmVEb2N1bWVudE1hcCgpO1xyXG4gICAgICAgIHRoaXMubmV3RG9jdW1lbnRDaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICB2YXIgZW50cnkgPSBfdGhpcy5kb2NzLmdldChrZXkpO1xyXG4gICAgICAgICAgICB2YXIgY2hhbmdlZERvYyA9IGVudHJ5XHJcbiAgICAgICAgICAgICAgICA/IGVudHJ5Lm1heWJlRG9jdW1lbnRcclxuICAgICAgICAgICAgICAgIDogbmV3IE5vRG9jdW1lbnQoa2V5LCBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpKTtcclxuICAgICAgICAgICAgY2hhbmdlZERvY3MgPSBjaGFuZ2VkRG9jcy5pbnNlcnQoa2V5LCBjaGFuZ2VkRG9jKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5ld0RvY3VtZW50Q2hhbmdlcyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGNoYW5nZWREb2NzKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5uZXdDaGFuZ2VCdWZmZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNZW1vcnlSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcih0aGlzLnNpemVyLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXRTaXplID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLnNpemUpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlO1xyXG59KCkpO1xyXG4vKipcclxuICogSGFuZGxlcyB0aGUgZGV0YWlscyBvZiBhZGRpbmcgYW5kIHVwZGF0aW5nIGRvY3VtZW50cyBpbiB0aGUgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5cclxuICovXHJcbnZhciBNZW1vcnlSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIoc2l6ZXIsIGRvY3VtZW50Q2FjaGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnNpemVyID0gc2l6ZXI7XHJcbiAgICAgICAgX3RoaXMuZG9jdW1lbnRDYWNoZSA9IGRvY3VtZW50Q2FjaGU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIucHJvdG90eXBlLmFwcGx5Q2hhbmdlcyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSB0aGlzLmFzc2VydENoYW5nZXMoKTtcclxuICAgICAgICB2YXIgZGVsdGEgPSAwO1xyXG4gICAgICAgIHZhciBkb2NzID0gW107XHJcbiAgICAgICAgY2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIG1heWJlRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIHByZXZpb3VzU2l6ZSA9IF90aGlzLmRvY3VtZW50U2l6ZXMuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgIGFzc2VydChwcmV2aW91c1NpemUgIT09IHVuZGVmaW5lZCwgXCJBdHRlbXB0aW5nIHRvIGNoYW5nZSBkb2N1bWVudCBcIiArIGtleS50b1N0cmluZygpICsgXCIgd2l0aG91dCBoYXZpbmcgcmVhZCBpdCBmaXJzdFwiKTtcclxuICAgICAgICAgICAgdmFyIHNpemUgPSBfdGhpcy5zaXplcihtYXliZURvY3VtZW50KTtcclxuICAgICAgICAgICAgZGVsdGEgKz0gc2l6ZSAtIHByZXZpb3VzU2l6ZTtcclxuICAgICAgICAgICAgZG9jcy5wdXNoKHsgbWF5YmVEb2N1bWVudDogbWF5YmVEb2N1bWVudCwgc2l6ZTogc2l6ZSB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudENhY2hlLmFkZEVudHJpZXModHJhbnNhY3Rpb24sIGRvY3MsIGRlbHRhKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlci5wcm90b3R5cGUuZ2V0RnJvbUNhY2hlID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50Q2FjaGUuZ2V0U2l6ZWRFbnRyeSh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNZW1vcnlSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcjtcclxufShSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcikpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckNCA9ICdNZW1vcnlQZXJzaXN0ZW5jZSc7XHJcbi8qKlxyXG4gKiBBIG1lbW9yeS1iYWNrZWQgaW5zdGFuY2Ugb2YgUGVyc2lzdGVuY2UuIERhdGEgaXMgc3RvcmVkIG9ubHkgaW4gUkFNIGFuZFxyXG4gKiBub3QgcGVyc2lzdGVkIGFjcm9zcyBzZXNzaW9ucy5cclxuICovXHJcbnZhciBNZW1vcnlQZXJzaXN0ZW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lbW9yeVBlcnNpc3RlbmNlKGNsaWVudElkLCBpc0VhZ2VyLCBzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogTm90ZSB0aGF0IHRoZXNlIGFyZSByZXRhaW5lZCBoZXJlIHRvIG1ha2UgaXQgZWFzaWVyIHRvIHdyaXRlIHRlc3RzXHJcbiAgICAgICAgICogYWZmZWN0aW5nIGJvdGggdGhlIGluLW1lbW9yeSBhbmQgSW5kZXhlZERCLWJhY2tlZCBwZXJzaXN0ZW5jZSBsYXllcnMuIFRlc3RzXHJcbiAgICAgICAgICogY2FuIGNyZWF0ZSBhIG5ldyBMb2NhbFN0b3JlIHdyYXBwaW5nIHRoaXMgUGVyc2lzdGVuY2UgaW5zdGFuY2UgYW5kIHRoaXNcclxuICAgICAgICAgKiB3aWxsIG1ha2UgdGhlIGluLW1lbW9yeSBwZXJzaXN0ZW5jZSBsYXllciBiZWhhdmUgYXMgaWYgaXQgd2VyZSBhY3R1YWxseVxyXG4gICAgICAgICAqIHBlcnNpc3RpbmcgdmFsdWVzLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZXMgPSB7fTtcclxuICAgICAgICB0aGlzLmxpc3RlblNlcXVlbmNlID0gbmV3IExpc3RlblNlcXVlbmNlKDApO1xyXG4gICAgICAgIHRoaXMuX3N0YXJ0ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAoaXNFYWdlcikge1xyXG4gICAgICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gbmV3IE1lbW9yeUVhZ2VyRGVsZWdhdGUodGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gbmV3IE1lbW9yeUxydURlbGVnYXRlKHRoaXMsIG5ldyBMb2NhbFNlcmlhbGl6ZXIoc2VyaWFsaXplcikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnF1ZXJ5Q2FjaGUgPSBuZXcgTWVtb3J5UXVlcnlDYWNoZSh0aGlzKTtcclxuICAgICAgICB2YXIgc2l6ZXIgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5kb2N1bWVudFNpemUoZG9jKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZSA9IG5ldyBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlKHNpemVyKTtcclxuICAgIH1cclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLmNyZWF0ZUxydVBlcnNpc3RlbmNlID0gZnVuY3Rpb24gKGNsaWVudElkLCBzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNZW1vcnlQZXJzaXN0ZW5jZShjbGllbnRJZCwgLyogaXNFYWdlcj0gKi8gZmFsc2UsIHNlcmlhbGl6ZXIpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLmNyZWF0ZUVhZ2VyUGVyc2lzdGVuY2UgPSBmdW5jdGlvbiAoY2xpZW50SWQsIHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IE1lbW9yeVBlcnNpc3RlbmNlKGNsaWVudElkLCAvKiBpc0VhZ2VyPSAqLyB0cnVlLCBzZXJpYWxpemVyKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUuc2h1dGRvd24gPSBmdW5jdGlvbiAoZGVsZXRlRGF0YSkge1xyXG4gICAgICAgIC8vIE5vIGR1cmFibGUgc3RhdGUgdG8gZW5zdXJlIGlzIGNsb3NlZCBvbiBzaHV0ZG93bi5cclxuICAgICAgICB0aGlzLl9zdGFydGVkID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUsIFwic3RhcnRlZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGFydGVkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLmdldEFjdGl2ZUNsaWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIFt0aGlzLmNsaWVudElkXV07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZS5zZXRQcmltYXJ5U3RhdGVMaXN0ZW5lciA9IGZ1bmN0aW9uIChwcmltYXJ5U3RhdGVMaXN0ZW5lcikge1xyXG4gICAgICAgIC8vIEFsbCBjbGllbnRzIHVzaW5nIG1lbW9yeSBwZXJzaXN0ZW5jZSBhY3QgYXMgcHJpbWFyeS5cclxuICAgICAgICByZXR1cm4gcHJpbWFyeVN0YXRlTGlzdGVuZXIodHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLnNldE5ldHdvcmtFbmFibGVkID0gZnVuY3Rpb24gKG5ldHdvcmtFbmFibGVkKSB7XHJcbiAgICAgICAgLy8gTm8gb3AuXHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLmdldE11dGF0aW9uUXVldWUgPSBmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgIHZhciBxdWV1ZSA9IHRoaXMubXV0YXRpb25RdWV1ZXNbdXNlci50b0tleSgpXTtcclxuICAgICAgICBpZiAoIXF1ZXVlKSB7XHJcbiAgICAgICAgICAgIHF1ZXVlID0gbmV3IE1lbW9yeU11dGF0aW9uUXVldWUodGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSk7XHJcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZXNbdXNlci50b0tleSgpXSA9IHF1ZXVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcXVldWU7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLmdldFF1ZXJ5Q2FjaGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcnlDYWNoZTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZS5ydW5UcmFuc2FjdGlvbiA9IGZ1bmN0aW9uIChhY3Rpb24sIG1vZGUsIHRyYW5zYWN0aW9uT3BlcmF0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDQsICdTdGFydGluZyB0cmFuc2FjdGlvbjonLCBhY3Rpb24pO1xyXG4gICAgICAgIHZhciB0eG4gPSBuZXcgTWVtb3J5VHJhbnNhY3Rpb24odGhpcy5saXN0ZW5TZXF1ZW5jZS5uZXh0KCkpO1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUub25UcmFuc2FjdGlvblN0YXJ0ZWQoKTtcclxuICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25PcGVyYXRpb24odHhuKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZVxyXG4gICAgICAgICAgICAgICAgLm9uVHJhbnNhY3Rpb25Db21taXR0ZWQodHhuKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0OyB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudG9Qcm9taXNlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLm11dGF0aW9uUXVldWVzQ29udGFpbktleSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwga2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5vcih2YWx1ZXModGhpcy5tdXRhdGlvblF1ZXVlcylcclxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAocXVldWUpIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHF1ZXVlLmNvbnRhaW5zS2V5KHRyYW5zYWN0aW9uLCBrZXkpOyB9OyB9KSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1lbW9yeVBlcnNpc3RlbmNlO1xyXG59KCkpO1xyXG4vKipcclxuICogTWVtb3J5IHBlcnNpc3RlbmNlIGlzIG5vdCBhY3R1YWxseSB0cmFuc2FjdGlvbmFsLCBidXQgZnV0dXJlIGltcGxlbWVudGF0aW9uc1xyXG4gKiBtYXkgaGF2ZSB0cmFuc2FjdGlvbi1zY29wZWQgc3RhdGUuXHJcbiAqL1xyXG52YXIgTWVtb3J5VHJhbnNhY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNZW1vcnlUcmFuc2FjdGlvbihjdXJyZW50U2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZXF1ZW5jZU51bWJlciA9IGN1cnJlbnRTZXF1ZW5jZU51bWJlcjtcclxuICAgIH1cclxuICAgIHJldHVybiBNZW1vcnlUcmFuc2FjdGlvbjtcclxufSgpKTtcclxudmFyIE1lbW9yeUVhZ2VyRGVsZWdhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNZW1vcnlFYWdlckRlbGVnYXRlKHBlcnNpc3RlbmNlKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IHBlcnNpc3RlbmNlO1xyXG4gICAgfVxyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUuc2V0SW5NZW1vcnlQaW5zID0gZnVuY3Rpb24gKGluTWVtb3J5UGlucykge1xyXG4gICAgICAgIHRoaXMuaW5NZW1vcnlQaW5zID0gaW5NZW1vcnlQaW5zO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLmFkZFJlZmVyZW5jZSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHRoaXMub3JwaGFuZWREb2N1bWVudHMuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlUmVmZXJlbmNlID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdGhpcy5vcnBoYW5lZERvY3VtZW50cy5hZGQoa2V5KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVNdXRhdGlvblJlZmVyZW5jZSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHRoaXMub3JwaGFuZWREb2N1bWVudHMuYWRkKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlVGFyZ2V0ID0gZnVuY3Rpb24gKHR4biwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY2FjaGUgPSB0aGlzLnBlcnNpc3RlbmNlLmdldFF1ZXJ5Q2FjaGUoKTtcclxuICAgICAgICByZXR1cm4gY2FjaGVcclxuICAgICAgICAgICAgLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHR4biwgcXVlcnlEYXRhLnRhcmdldElkKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoa2V5cykge1xyXG4gICAgICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gX3RoaXMub3JwaGFuZWREb2N1bWVudHMuYWRkKGtleSk7IH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNhY2hlLnJlbW92ZVF1ZXJ5RGF0YSh0eG4sIHF1ZXJ5RGF0YSk7IH0pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLm9uVHJhbnNhY3Rpb25TdGFydGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMub3JwaGFuZWREb2N1bWVudHMgPSBuZXcgU2V0KCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUub25UcmFuc2FjdGlvbkNvbW1pdHRlZCA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjYWNoZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0aGlzLm9ycGhhbmVkRG9jdW1lbnRzLCBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5pc1JlZmVyZW5jZWQodHhuLCBrZXkpLm5leHQoZnVuY3Rpb24gKGlzUmVmZXJlbmNlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpc1JlZmVyZW5jZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTaW5jZSB0aGlzIGlzIHRoZSBlYWdlciBkZWxlZ2F0ZSBhbmQgbWVtb3J5IHBlcnNpc3RlbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIGRvbid0IGNhcmUgYWJvdXQgdGhlIHNpemUgb2YgZG9jdW1lbnRzLiBXZSBkb24ndCB0cmFja1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzaXplIG9mIHRoZSBjYWNoZSBmb3IgZWFnZXIgR0MuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLnJlbW92ZUVudHJ5KHR4biwga2V5KS5uZXh0KGZ1bmN0aW9uICgpIHsgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUudXBkYXRlTGltYm9Eb2N1bWVudCA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNSZWZlcmVuY2VkKHR4biwga2V5KS5uZXh0KGZ1bmN0aW9uIChpc1JlZmVyZW5jZWQpIHtcclxuICAgICAgICAgICAgaWYgKGlzUmVmZXJlbmNlZCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub3JwaGFuZWREb2N1bWVudHMuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vcnBoYW5lZERvY3VtZW50cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLmRvY3VtZW50U2l6ZSA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAvLyBGb3IgZWFnZXIgR0MsIHdlIGRvbid0IGNhcmUgYWJvdXQgdGhlIGRvY3VtZW50IHNpemUsIHRoZXJlIGFyZSBubyBzaXplIHRocmVzaG9sZHMuXHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUuaXNSZWZlcmVuY2VkID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLm9yKFtcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucGVyc2lzdGVuY2UuZ2V0UXVlcnlDYWNoZSgpLmNvbnRhaW5zS2V5KHR4biwga2V5KTsgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucGVyc2lzdGVuY2UubXV0YXRpb25RdWV1ZXNDb250YWluS2V5KHR4biwga2V5KTsgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoX3RoaXMuaW5NZW1vcnlQaW5zLmNvbnRhaW5zS2V5KGtleSkpOyB9XHJcbiAgICAgICAgXSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1lbW9yeUVhZ2VyRGVsZWdhdGU7XHJcbn0oKSk7XHJcbnZhciBNZW1vcnlMcnVEZWxlZ2F0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lbW9yeUxydURlbGVnYXRlKHBlcnNpc3RlbmNlLCBzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IHBlcnNpc3RlbmNlO1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICAgICAgdGhpcy5vcnBoYW5lZFNlcXVlbmNlTnVtYmVycyA9IG5ldyBPYmplY3RNYXAoZnVuY3Rpb24gKGspIHsgcmV0dXJuIGVuY29kZShrLnBhdGgpOyB9KTtcclxuICAgICAgICB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IgPSBuZXcgTHJ1R2FyYmFnZUNvbGxlY3Rvcih0aGlzKTtcclxuICAgIH1cclxuICAgIC8vIE5vLW9wcywgcHJlc2VudCBzbyBtZW1vcnkgcGVyc2lzdGVuY2UgZG9lc24ndCBoYXZlIHRvIGNhcmUgd2hpY2ggZGVsZWdhdGVcclxuICAgIC8vIGl0IGhhcy5cclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5vblRyYW5zYWN0aW9uU3RhcnRlZCA9IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5vblRyYW5zYWN0aW9uQ29tbWl0dGVkID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5mb3JFYWNoVGFyZ2V0ID0gZnVuY3Rpb24gKHR4biwgZikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLmdldFF1ZXJ5Q2FjaGUoKS5mb3JFYWNoVGFyZ2V0KHR4biwgZik7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLmdldFRhcmdldENvdW50ID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLmdldFF1ZXJ5Q2FjaGUoKS5nZXRUYXJnZXRDb3VudCh0eG4pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5mb3JFYWNoT3JwaGFuZWREb2N1bWVudFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKHR4biwgZikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHRoaXMub3JwaGFuZWRTZXF1ZW5jZU51bWJlcnMsIGZ1bmN0aW9uIChrZXksIHNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIC8vIFBhc3MgaW4gdGhlIGV4YWN0IHNlcXVlbmNlIG51bWJlciBhcyB0aGUgdXBwZXIgYm91bmQgc28gd2Uga25vdyBpdCB3b24ndCBiZSBwaW5uZWQgYnlcclxuICAgICAgICAgICAgLy8gYmVpbmcgdG9vIHJlY2VudC5cclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmlzUGlubmVkKHR4biwga2V5LCBzZXF1ZW5jZU51bWJlcikubmV4dChmdW5jdGlvbiAoaXNQaW5uZWQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghaXNQaW5uZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZihzZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLnNldEluTWVtb3J5UGlucyA9IGZ1bmN0aW9uIChpbk1lbW9yeVBpbnMpIHtcclxuICAgICAgICB0aGlzLmluTWVtb3J5UGlucyA9IGluTWVtb3J5UGlucztcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlVGFyZ2V0cyA9IGZ1bmN0aW9uICh0eG4sIHVwcGVyQm91bmQsIGFjdGl2ZVRhcmdldElkcykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlXHJcbiAgICAgICAgICAgIC5nZXRRdWVyeUNhY2hlKClcclxuICAgICAgICAgICAgLnJlbW92ZVRhcmdldHModHhuLCB1cHBlckJvdW5kLCBhY3RpdmVUYXJnZXRJZHMpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVPcnBoYW5lZERvY3VtZW50cyA9IGZ1bmN0aW9uICh0eG4sIHVwcGVyQm91bmQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgICAgdmFyIGNhY2hlID0gdGhpcy5wZXJzaXN0ZW5jZS5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCk7XHJcbiAgICAgICAgdmFyIHAgPSBjYWNoZS5mb3JFYWNoRG9jdW1lbnRLZXkodHhuLCBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5pc1Bpbm5lZCh0eG4sIGtleSwgdXBwZXJCb3VuZCkubmV4dChmdW5jdGlvbiAoaXNQaW5uZWQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc1Bpbm5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgbWVtb3J5IHJlbW90ZSBkb2N1bWVudCBjYWNoZSBkb2VzIGl0cyBvd24gYnl0ZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFjY291bnRpbmcgb24gcmVtb3ZhbC4gVGhpcyBpcyBvayBiZWNhdXNlIHVwZGF0aW5nIHRoZSBzaXplXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9yIG1lbW9yeSBwZXJzaXN0ZW5jZSBkb2VzIG5vdCBpbmN1ciBJTy5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUucmVtb3ZlRW50cnkodHhuLCBrZXkpLm5leHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBjb3VudDsgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZU11dGF0aW9uUmVmZXJlbmNlID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdGhpcy5vcnBoYW5lZFNlcXVlbmNlTnVtYmVycy5zZXQoa2V5LCB0eG4uY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlVGFyZ2V0ID0gZnVuY3Rpb24gKHR4biwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdmFyIHVwZGF0ZWQgPSBxdWVyeURhdGEuY29weSh7XHJcbiAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyOiB0eG4uY3VycmVudFNlcXVlbmNlTnVtYmVyXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuZ2V0UXVlcnlDYWNoZSgpLnVwZGF0ZVF1ZXJ5RGF0YSh0eG4sIHVwZGF0ZWQpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5hZGRSZWZlcmVuY2UgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB0aGlzLm9ycGhhbmVkU2VxdWVuY2VOdW1iZXJzLnNldChrZXksIHR4bi5jdXJyZW50U2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVSZWZlcmVuY2UgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB0aGlzLm9ycGhhbmVkU2VxdWVuY2VOdW1iZXJzLnNldChrZXksIHR4bi5jdXJyZW50U2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS51cGRhdGVMaW1ib0RvY3VtZW50ID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdGhpcy5vcnBoYW5lZFNlcXVlbmNlTnVtYmVycy5zZXQoa2V5LCB0eG4uY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuZG9jdW1lbnRTaXplID0gZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgdmFyIHJlbW90ZURvY3VtZW50ID0gdGhpcy5zZXJpYWxpemVyLnRvRGJSZW1vdGVEb2N1bWVudChtYXliZURvYyk7XHJcbiAgICAgICAgdmFyIHZhbHVlO1xyXG4gICAgICAgIGlmIChyZW1vdGVEb2N1bWVudC5kb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHJlbW90ZURvY3VtZW50LmRvY3VtZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChyZW1vdGVEb2N1bWVudC51bmtub3duRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFsdWUgPSByZW1vdGVEb2N1bWVudC51bmtub3duRG9jdW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHJlbW90ZURvY3VtZW50Lm5vRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFsdWUgPSByZW1vdGVEb2N1bWVudC5ub0RvY3VtZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgZmFpbCgnVW5rbm93biByZW1vdGUgZG9jdW1lbnQgdHlwZScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodmFsdWUpLmxlbmd0aDtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuaXNQaW5uZWQgPSBmdW5jdGlvbiAodHhuLCBrZXksIHVwcGVyQm91bmQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uub3IoW1xyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5wZXJzaXN0ZW5jZS5tdXRhdGlvblF1ZXVlc0NvbnRhaW5LZXkodHhuLCBrZXkpOyB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7IHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShfdGhpcy5pbk1lbW9yeVBpbnMuY29udGFpbnNLZXkoa2V5KSk7IH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnBlcnNpc3RlbmNlLmdldFF1ZXJ5Q2FjaGUoKS5jb250YWluc0tleSh0eG4sIGtleSk7IH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvcnBoYW5lZEF0ID0gX3RoaXMub3JwaGFuZWRTZXF1ZW5jZU51bWJlcnMuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUob3JwaGFuZWRBdCAhPT0gdW5kZWZpbmVkICYmIG9ycGhhbmVkQXQgPiB1cHBlckJvdW5kKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNZW1vcnlMcnVEZWxlZ2F0ZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDUgPSAnRXhwb25lbnRpYWxCYWNrb2ZmJztcclxuLyoqXHJcbiAqIEEgaGVscGVyIGZvciBydW5uaW5nIGRlbGF5ZWQgdGFza3MgZm9sbG93aW5nIGFuIGV4cG9uZW50aWFsIGJhY2tvZmYgY3VydmVcclxuICogYmV0d2VlbiBhdHRlbXB0cy5cclxuICpcclxuICogRWFjaCBkZWxheSBpcyBtYWRlIHVwIG9mIGEgXCJiYXNlXCIgZGVsYXkgd2hpY2ggZm9sbG93cyB0aGUgZXhwb25lbnRpYWxcclxuICogYmFja29mZiBjdXJ2ZSwgYW5kIGEgKy8tIDUwJSBcImppdHRlclwiIHRoYXQgaXMgY2FsY3VsYXRlZCBhbmQgYWRkZWQgdG8gdGhlXHJcbiAqIGJhc2UgZGVsYXkuIFRoaXMgcHJldmVudHMgY2xpZW50cyBmcm9tIGFjY2lkZW50YWxseSBzeW5jaHJvbml6aW5nIHRoZWlyXHJcbiAqIGRlbGF5cyBjYXVzaW5nIHNwaWtlcyBvZiBsb2FkIHRvIHRoZSBiYWNrZW5kLlxyXG4gKi9cclxudmFyIEV4cG9uZW50aWFsQmFja29mZiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEV4cG9uZW50aWFsQmFja29mZihcclxuICAgIC8qKlxyXG4gICAgICogVGhlIEFzeW5jUXVldWUgdG8gcnVuIGJhY2tvZmYgb3BlcmF0aW9ucyBvbi5cclxuICAgICAqL1xyXG4gICAgcXVldWUsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgSUQgdG8gdXNlIHdoZW4gc2NoZWR1bGluZyBiYWNrb2ZmIG9wZXJhdGlvbnMgb24gdGhlIEFzeW5jUXVldWUuXHJcbiAgICAgKi9cclxuICAgIHRpbWVySWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgaW5pdGlhbCBkZWxheSAodXNlZCBhcyB0aGUgYmFzZSBkZWxheSBvbiB0aGUgZmlyc3QgcmV0cnkgYXR0ZW1wdCkuXHJcbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xyXG4gICAgICogbGl0dGxlIGFzIDAuNSppbml0aWFsRGVsYXlNcy5cclxuICAgICAqL1xyXG4gICAgaW5pdGlhbERlbGF5TXMsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbXVsdGlwbGllciB0byB1c2UgdG8gZGV0ZXJtaW5lIHRoZSBleHRlbmRlZCBiYXNlIGRlbGF5IGFmdGVyIGVhY2hcclxuICAgICAqIGF0dGVtcHQuXHJcbiAgICAgKi9cclxuICAgIGJhY2tvZmZGYWN0b3IsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbWF4aW11bSBiYXNlIGRlbGF5IGFmdGVyIHdoaWNoIG5vIGZ1cnRoZXIgYmFja29mZiBpcyBwZXJmb3JtZWQuXHJcbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xyXG4gICAgICogbXVjaCBhcyAxLjUqbWF4RGVsYXlNcy5cclxuICAgICAqL1xyXG4gICAgbWF4RGVsYXlNcykge1xyXG4gICAgICAgIHRoaXMucXVldWUgPSBxdWV1ZTtcclxuICAgICAgICB0aGlzLnRpbWVySWQgPSB0aW1lcklkO1xyXG4gICAgICAgIHRoaXMuaW5pdGlhbERlbGF5TXMgPSBpbml0aWFsRGVsYXlNcztcclxuICAgICAgICB0aGlzLmJhY2tvZmZGYWN0b3IgPSBiYWNrb2ZmRmFjdG9yO1xyXG4gICAgICAgIHRoaXMubWF4RGVsYXlNcyA9IG1heERlbGF5TXM7XHJcbiAgICAgICAgdGhpcy50aW1lclByb21pc2UgPSBudWxsO1xyXG4gICAgICAgIC8qKiBUaGUgbGFzdCBiYWNrb2ZmIGF0dGVtcHQsIGFzIGVwb2NoIG1pbGxpc2Vjb25kcy4gKi9cclxuICAgICAgICB0aGlzLmxhc3RBdHRlbXB0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIGJhY2tvZmYgZGVsYXkuXHJcbiAgICAgKlxyXG4gICAgICogVGhlIHZlcnkgbmV4dCBiYWNrb2ZmQW5kV2FpdCgpIHdpbGwgaGF2ZSBubyBkZWxheS4gSWYgaXQgaXMgY2FsbGVkIGFnYWluXHJcbiAgICAgKiAoaS5lLiBkdWUgdG8gYW4gZXJyb3IpLCBpbml0aWFsRGVsYXlNcyAocGx1cyBqaXR0ZXIpIHdpbGwgYmUgdXNlZCwgYW5kXHJcbiAgICAgKiBzdWJzZXF1ZW50IG9uZXMgd2lsbCBpbmNyZWFzZSBhY2NvcmRpbmcgdG8gdGhlIGJhY2tvZmZGYWN0b3IuXHJcbiAgICAgKi9cclxuICAgIEV4cG9uZW50aWFsQmFja29mZi5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50QmFzZU1zID0gMDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgYmFja29mZiBkZWxheSB0byB0aGUgbWF4aW11bSBkZWxheSAoZS5nLiBmb3IgdXNlIGFmdGVyIGFcclxuICAgICAqIFJFU09VUkNFX0VYSEFVU1RFRCBlcnJvcikuXHJcbiAgICAgKi9cclxuICAgIEV4cG9uZW50aWFsQmFja29mZi5wcm90b3R5cGUucmVzZXRUb01heCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRCYXNlTXMgPSB0aGlzLm1heERlbGF5TXM7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIGN1cnJlbnREZWxheU1zLCBhbmQgaW5jcmVhc2VzIHRoZVxyXG4gICAgICogZGVsYXkgZm9yIGFueSBzdWJzZXF1ZW50IGF0dGVtcHRzLiBJZiB0aGVyZSB3YXMgYSBwZW5kaW5nIGJhY2tvZmYgb3BlcmF0aW9uXHJcbiAgICAgKiBhbHJlYWR5LCBpdCB3aWxsIGJlIGNhbmNlbGVkLlxyXG4gICAgICovXHJcbiAgICBFeHBvbmVudGlhbEJhY2tvZmYucHJvdG90eXBlLmJhY2tvZmZBbmRSdW4gPSBmdW5jdGlvbiAob3ApIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIENhbmNlbCBhbnkgcGVuZGluZyBiYWNrb2ZmIG9wZXJhdGlvbi5cclxuICAgICAgICB0aGlzLmNhbmNlbCgpO1xyXG4gICAgICAgIC8vIEZpcnN0IHNjaGVkdWxlIHVzaW5nIHRoZSBjdXJyZW50IGJhc2UgKHdoaWNoIG1heSBiZSAwIGFuZCBzaG91bGQgYmVcclxuICAgICAgICAvLyBob25vcmVkIGFzIHN1Y2gpLlxyXG4gICAgICAgIHZhciBkZXNpcmVkRGVsYXlXaXRoSml0dGVyTXMgPSBNYXRoLmZsb29yKHRoaXMuY3VycmVudEJhc2VNcyArIHRoaXMuaml0dGVyRGVsYXlNcygpKTtcclxuICAgICAgICAvLyBHdWFyZCBhZ2FpbnN0IGxhc3RBdHRlbXB0VGltZSBiZWluZyBpbiB0aGUgZnV0dXJlIGR1ZSB0byBhIGNsb2NrIGNoYW5nZS5cclxuICAgICAgICB2YXIgZGVsYXlTb0Zhck1zID0gTWF0aC5tYXgoMCwgRGF0ZS5ub3coKSAtIHRoaXMubGFzdEF0dGVtcHRUaW1lKTtcclxuICAgICAgICAvLyBHdWFyZCBhZ2FpbnN0IHRoZSBiYWNrb2ZmIGRlbGF5IGFscmVhZHkgYmVpbmcgcGFzdC5cclxuICAgICAgICB2YXIgcmVtYWluaW5nRGVsYXlNcyA9IE1hdGgubWF4KDAsIGRlc2lyZWREZWxheVdpdGhKaXR0ZXJNcyAtIGRlbGF5U29GYXJNcyk7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEJhc2VNcyA+IDApIHtcclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ1LCBcIkJhY2tpbmcgb2ZmIGZvciBcIiArIHJlbWFpbmluZ0RlbGF5TXMgKyBcIiBtcyBcIiArXHJcbiAgICAgICAgICAgICAgICAoXCIoYmFzZSBkZWxheTogXCIgKyB0aGlzLmN1cnJlbnRCYXNlTXMgKyBcIiBtcywgXCIpICtcclxuICAgICAgICAgICAgICAgIChcImRlbGF5IHdpdGggaml0dGVyOiBcIiArIGRlc2lyZWREZWxheVdpdGhKaXR0ZXJNcyArIFwiIG1zLCBcIikgK1xyXG4gICAgICAgICAgICAgICAgKFwibGFzdCBhdHRlbXB0OiBcIiArIGRlbGF5U29GYXJNcyArIFwiIG1zIGFnbylcIikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRpbWVyUHJvbWlzZSA9IHRoaXMucXVldWUuZW5xdWV1ZUFmdGVyRGVsYXkodGhpcy50aW1lcklkLCByZW1haW5pbmdEZWxheU1zLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmxhc3RBdHRlbXB0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIHJldHVybiBvcCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIEFwcGx5IGJhY2tvZmYgZmFjdG9yIHRvIGRldGVybWluZSBuZXh0IGRlbGF5IGFuZCBlbnN1cmUgaXQgaXMgd2l0aGluXHJcbiAgICAgICAgLy8gYm91bmRzLlxyXG4gICAgICAgIHRoaXMuY3VycmVudEJhc2VNcyAqPSB0aGlzLmJhY2tvZmZGYWN0b3I7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEJhc2VNcyA8IHRoaXMuaW5pdGlhbERlbGF5TXMpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50QmFzZU1zID0gdGhpcy5pbml0aWFsRGVsYXlNcztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEJhc2VNcyA+IHRoaXMubWF4RGVsYXlNcykge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRCYXNlTXMgPSB0aGlzLm1heERlbGF5TXM7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEV4cG9uZW50aWFsQmFja29mZi5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnRpbWVyUHJvbWlzZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVyUHJvbWlzZS5jYW5jZWwoKTtcclxuICAgICAgICAgICAgdGhpcy50aW1lclByb21pc2UgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiogUmV0dXJucyBhIHJhbmRvbSB2YWx1ZSBpbiB0aGUgcmFuZ2UgWy1jdXJyZW50QmFzZU1zLzIsIGN1cnJlbnRCYXNlTXMvMl0gKi9cclxuICAgIEV4cG9uZW50aWFsQmFja29mZi5wcm90b3R5cGUuaml0dGVyRGVsYXlNcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogdGhpcy5jdXJyZW50QmFzZU1zO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBFeHBvbmVudGlhbEJhY2tvZmY7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQ2ID0gJ1BlcnNpc3RlbnRTdHJlYW0nO1xyXG4vKipcclxuICogUGVyc2lzdGVudFN0cmVhbSBjYW4gYmUgaW4gb25lIG9mIDUgc3RhdGVzIChlYWNoIGRlc2NyaWJlZCBpbiBkZXRhaWwgYmVsb3cpXHJcbiAqIGJhc2VkIG9uIHRoZSBmb2xsb3dpbmcgc3RhdGUgdHJhbnNpdGlvbiBkaWFncmFtOlxyXG4gKlxyXG4gKiAgICAgICAgICBzdGFydCgpIGNhbGxlZCAgICAgICAgICAgICBhdXRoICYgY29ubmVjdGlvbiBzdWNjZWVkZWRcclxuICogSU5JVElBTCAtLS0tLS0tLS0tLS0tLS0tPiBTVEFSVElORyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT4gT1BFTlxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXiAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgfCAgICAgICAgICAgICAgICAgICAgZXJyb3Igb2NjdXJyZWQgfFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgXFwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXYtLS0tLS9cclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogICAgICAgICAgICAgICAgICAgIGJhY2tvZmYgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogICAgICAgICAgICAgICAgICAgIGVsYXBzZWQgIHwgICAgICAgICAgICAgIHN0YXJ0KCkgY2FsbGVkICAgIHxcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcLS0tIEJBQ0tPRkYgPC0tLS0tLS0tLS0tLS0tLS0gRVJST1JcclxuICpcclxuICogW2FueSBzdGF0ZV0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0+IElOSVRJQUxcclxuICogICAgICAgICAgICAgICBzdG9wKCkgY2FsbGVkIG9yXHJcbiAqICAgICAgICAgICAgICAgaWRsZSB0aW1lciBleHBpcmVkXHJcbiAqL1xyXG52YXIgUGVyc2lzdGVudFN0cmVhbVN0YXRlO1xyXG4oZnVuY3Rpb24gKFBlcnNpc3RlbnRTdHJlYW1TdGF0ZSkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc3RyZWFtaW5nIFJQQyBpcyBub3QgeWV0IHJ1bm5pbmcgYW5kIHRoZXJlJ3Mgbm8gZXJyb3IgY29uZGl0aW9uLlxyXG4gICAgICogQ2FsbGluZyBzdGFydCgpIHdpbGwgc3RhcnQgdGhlIHN0cmVhbSBpbW1lZGlhdGVseSB3aXRob3V0IGJhY2tvZmYuXHJcbiAgICAgKiBXaGlsZSBpbiB0aGlzIHN0YXRlIGlzU3RhcnRlZCgpIHdpbGwgcmV0dXJuIGZhbHNlLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtU3RhdGVbUGVyc2lzdGVudFN0cmVhbVN0YXRlW1wiSW5pdGlhbFwiXSA9IDBdID0gXCJJbml0aWFsXCI7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzdHJlYW0gaXMgc3RhcnRpbmcsIGVpdGhlciB3YWl0aW5nIGZvciBhbiBhdXRoIHRva2VuIG9yIGZvciB0aGUgc3RyZWFtXHJcbiAgICAgKiB0byBzdWNjZXNzZnVsbHkgb3Blbi4gV2hpbGUgaW4gdGhpcyBzdGF0ZSwgaXNTdGFydGVkKCkgd2lsbCByZXR1cm4gdHJ1ZSBidXRcclxuICAgICAqIGlzT3BlbigpIHdpbGwgcmV0dXJuIGZhbHNlLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtU3RhdGVbUGVyc2lzdGVudFN0cmVhbVN0YXRlW1wiU3RhcnRpbmdcIl0gPSAxXSA9IFwiU3RhcnRpbmdcIjtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHN0cmVhbWluZyBSUEMgaXMgdXAgYW5kIHJ1bm5pbmcuIFJlcXVlc3RzIGFuZCByZXNwb25zZXMgY2FuIGZsb3dcclxuICAgICAqIGZyZWVseS4gQm90aCBpc1N0YXJ0ZWQoKSBhbmQgaXNPcGVuKCkgd2lsbCByZXR1cm4gdHJ1ZS5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbVN0YXRlW1BlcnNpc3RlbnRTdHJlYW1TdGF0ZVtcIk9wZW5cIl0gPSAyXSA9IFwiT3BlblwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc3RyZWFtIGVuY291bnRlcmVkIGFuIGVycm9yLiBUaGUgbmV4dCBzdGFydCBhdHRlbXB0IHdpbGwgYmFjayBvZmYuXHJcbiAgICAgKiBXaGlsZSBpbiB0aGlzIHN0YXRlIGlzU3RhcnRlZCgpIHdpbGwgcmV0dXJuIGZhbHNlLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtU3RhdGVbUGVyc2lzdGVudFN0cmVhbVN0YXRlW1wiRXJyb3JcIl0gPSAzXSA9IFwiRXJyb3JcIjtcclxuICAgIC8qKlxyXG4gICAgICogQW4gaW4tYmV0d2VlbiBzdGF0ZSBhZnRlciBhbiBlcnJvciB3aGVyZSB0aGUgc3RyZWFtIGlzIHdhaXRpbmcgYmVmb3JlXHJcbiAgICAgKiByZS1zdGFydGluZy4gQWZ0ZXIgd2FpdGluZyBpcyBjb21wbGV0ZSwgdGhlIHN0cmVhbSB3aWxsIHRyeSB0byBvcGVuLlxyXG4gICAgICogV2hpbGUgaW4gdGhpcyBzdGF0ZSBpc1N0YXJ0ZWQoKSB3aWxsIHJldHVybiB0cnVlIGJ1dCBpc09wZW4oKSB3aWxsIHJldHVyblxyXG4gICAgICogZmFsc2UuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZVtQZXJzaXN0ZW50U3RyZWFtU3RhdGVbXCJCYWNrb2ZmXCJdID0gNF0gPSBcIkJhY2tvZmZcIjtcclxufSkoUGVyc2lzdGVudFN0cmVhbVN0YXRlIHx8IChQZXJzaXN0ZW50U3RyZWFtU3RhdGUgPSB7fSkpO1xyXG4vKipcclxuICogSW5pdGlhbCBiYWNrb2ZmIHRpbWUgaW4gbWlsbGlzZWNvbmRzIGFmdGVyIGFuIGVycm9yLlxyXG4gKiBTZXQgdG8gMXMgYWNjb3JkaW5nIHRvIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9hcGlzL2Rlc2lnbi9lcnJvcnMuXHJcbiAqL1xyXG52YXIgQkFDS09GRl9JTklUSUFMX0RFTEFZX01TID0gMTAwMDtcclxuLyoqIE1heGltdW0gYmFja29mZiB0aW1lIGluIG1pbGxpc2Vjb25kcyAqL1xyXG52YXIgQkFDS09GRl9NQVhfREVMQVlfTVMgPSA2MCAqIDEwMDA7XHJcbnZhciBCQUNLT0ZGX0ZBQ1RPUiA9IDEuNTtcclxuLyoqIFRoZSB0aW1lIGEgc3RyZWFtIHN0YXlzIG9wZW4gYWZ0ZXIgaXQgaXMgbWFya2VkIGlkbGUuICovXHJcbnZhciBJRExFX1RJTUVPVVRfTVMgPSA2MCAqIDEwMDA7XHJcbi8qKlxyXG4gKiBBIFBlcnNpc3RlbnRTdHJlYW0gaXMgYW4gYWJzdHJhY3QgYmFzZSBjbGFzcyB0aGF0IHJlcHJlc2VudHMgYSBzdHJlYW1pbmcgUlBDXHJcbiAqIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZC4gSXQncyBidWlsdCBvbiB0b3Agb2YgdGhlIGNvbm5lY3Rpb25zIG93biBzdXBwb3J0XHJcbiAqIGZvciBzdHJlYW1pbmcgUlBDcywgYW5kIGFkZHMgc2V2ZXJhbCBjcml0aWNhbCBmZWF0dXJlcyBmb3Igb3VyIGNsaWVudHM6XHJcbiAqXHJcbiAqICAgLSBFeHBvbmVudGlhbCBiYWNrb2ZmIG9uIGZhaWx1cmVcclxuICogICAtIEF1dGhlbnRpY2F0aW9uIHZpYSBDcmVkZW50aWFsc1Byb3ZpZGVyXHJcbiAqICAgLSBEaXNwYXRjaGluZyBhbGwgY2FsbGJhY2tzIGludG8gdGhlIHNoYXJlZCB3b3JrZXIgcXVldWVcclxuICogICAtIENsb3NpbmcgaWRsZSBzdHJlYW1zIGFmdGVyIDYwIHNlY29uZHMgb2YgaW5hY3Rpdml0eVxyXG4gKlxyXG4gKiBTdWJjbGFzc2VzIG9mIFBlcnNpc3RlbnRTdHJlYW0gaW1wbGVtZW50IHNlcmlhbGl6YXRpb24gb2YgbW9kZWxzIHRvIGFuZFxyXG4gKiBmcm9tIHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBwcm90b2NvbCBidWZmZXJzIGZvciBhIHNwZWNpZmljXHJcbiAqIHN0cmVhbWluZyBSUEMuXHJcbiAqXHJcbiAqICMjIFN0YXJ0aW5nIGFuZCBTdG9wcGluZ1xyXG4gKlxyXG4gKiBTdHJlYW1pbmcgUlBDcyBhcmUgc3RhdGVmdWwgYW5kIG5lZWQgdG8gYmUgc3RhcnQoKWVkIGJlZm9yZSBtZXNzYWdlcyBjYW5cclxuICogYmUgc2VudCBhbmQgcmVjZWl2ZWQuIFRoZSBQZXJzaXN0ZW50U3RyZWFtIHdpbGwgY2FsbCB0aGUgb25PcGVuKCkgZnVuY3Rpb25cclxuICogb2YgdGhlIGxpc3RlbmVyIG9uY2UgdGhlIHN0cmVhbSBpcyByZWFkeSB0byBhY2NlcHQgcmVxdWVzdHMuXHJcbiAqXHJcbiAqIFNob3VsZCBhIHN0YXJ0KCkgZmFpbCwgUGVyc2lzdGVudFN0cmVhbSB3aWxsIGNhbGwgdGhlIHJlZ2lzdGVyZWQgb25DbG9zZSgpXHJcbiAqIGxpc3RlbmVyIHdpdGggYSBGaXJlc3RvcmVFcnJvciBpbmRpY2F0aW5nIHdoYXQgd2VudCB3cm9uZy5cclxuICpcclxuICogQSBQZXJzaXN0ZW50U3RyZWFtIGNhbiBiZSBzdGFydGVkIGFuZCBzdG9wcGVkIHJlcGVhdGVkbHkuXHJcbiAqXHJcbiAqIEdlbmVyaWMgdHlwZXM6XHJcbiAqICBTZW5kVHlwZTogVGhlIHR5cGUgb2YgdGhlIG91dGdvaW5nIG1lc3NhZ2Ugb2YgdGhlIHVuZGVybHlpbmdcclxuICogICAgY29ubmVjdGlvbiBzdHJlYW1cclxuICogIFJlY2VpdmVUeXBlOiBUaGUgdHlwZSBvZiB0aGUgaW5jb21pbmcgbWVzc2FnZSBvZiB0aGUgdW5kZXJseWluZ1xyXG4gKiAgICBjb25uZWN0aW9uIHN0cmVhbVxyXG4gKiAgTGlzdGVuZXJUeXBlOiBUaGUgdHlwZSBvZiB0aGUgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIHVzZWQgZm9yIGNhbGxiYWNrc1xyXG4gKi9cclxudmFyIFBlcnNpc3RlbnRTdHJlYW0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQZXJzaXN0ZW50U3RyZWFtKHF1ZXVlLCBjb25uZWN0aW9uVGltZXJJZCwgaWRsZVRpbWVySWQsIGNvbm5lY3Rpb24sIGNyZWRlbnRpYWxzUHJvdmlkZXIsIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgdGhpcy5xdWV1ZSA9IHF1ZXVlO1xyXG4gICAgICAgIHRoaXMuaWRsZVRpbWVySWQgPSBpZGxlVGltZXJJZDtcclxuICAgICAgICB0aGlzLmNvbm5lY3Rpb24gPSBjb25uZWN0aW9uO1xyXG4gICAgICAgIHRoaXMuY3JlZGVudGlhbHNQcm92aWRlciA9IGNyZWRlbnRpYWxzUHJvdmlkZXI7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lciA9IGxpc3RlbmVyO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGNsb3NlIGNvdW50IHRoYXQncyBpbmNyZW1lbnRlZCBldmVyeSB0aW1lIHRoZSBzdHJlYW0gaXMgY2xvc2VkOyB1c2VkIGJ5XHJcbiAgICAgICAgICogZ2V0Q2xvc2VHdWFyZGVkRGlzcGF0Y2hlcigpIHRvIGludmFsaWRhdGUgY2FsbGJhY2tzIHRoYXQgaGFwcGVuIGFmdGVyXHJcbiAgICAgICAgICogY2xvc2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jbG9zZUNvdW50ID0gMDtcclxuICAgICAgICB0aGlzLmlkbGVUaW1lciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zdHJlYW0gPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYmFja29mZiA9IG5ldyBFeHBvbmVudGlhbEJhY2tvZmYocXVldWUsIGNvbm5lY3Rpb25UaW1lcklkLCBCQUNLT0ZGX0lOSVRJQUxfREVMQVlfTVMsIEJBQ0tPRkZfRkFDVE9SLCBCQUNLT0ZGX01BWF9ERUxBWV9NUyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiBzdGFydCgpIGhhcyBiZWVuIGNhbGxlZCBhbmQgbm8gZXJyb3IgaGFzIG9jY3VycmVkLiBUcnVlXHJcbiAgICAgKiBpbmRpY2F0ZXMgdGhlIHN0cmVhbSBpcyBvcGVuIG9yIGluIHRoZSBwcm9jZXNzIG9mIG9wZW5pbmcgKHdoaWNoXHJcbiAgICAgKiBlbmNvbXBhc3NlcyByZXNwZWN0aW5nIGJhY2tvZmYsIGdldHRpbmcgYXV0aCB0b2tlbnMsIGFuZCBzdGFydGluZyB0aGVcclxuICAgICAqIGFjdHVhbCBSUEMpLiBVc2UgaXNPcGVuKCkgdG8gZGV0ZXJtaW5lIGlmIHRoZSBzdHJlYW0gaXMgb3BlbiBhbmQgcmVhZHkgZm9yXHJcbiAgICAgKiBvdXRib3VuZCByZXF1ZXN0cy5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuaXNTdGFydGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLlN0YXJ0aW5nIHx8XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5PcGVuIHx8XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5CYWNrb2ZmKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdW5kZXJseWluZyBSUEMgaXMgb3BlbiAodGhlIG9uT3BlbigpIGxpc3RlbmVyIGhhcyBiZWVuXHJcbiAgICAgKiBjYWxsZWQpIGFuZCB0aGUgc3RyZWFtIGlzIHJlYWR5IGZvciBvdXRib3VuZCByZXF1ZXN0cy5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuaXNPcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuT3BlbjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFN0YXJ0cyB0aGUgUlBDLiBPbmx5IGFsbG93ZWQgaWYgaXNTdGFydGVkKCkgcmV0dXJucyBmYWxzZS4gVGhlIHN0cmVhbSBpc1xyXG4gICAgICogbm90IGltbWVkaWF0ZWx5IHJlYWR5IGZvciB1c2U6IG9uT3BlbigpIHdpbGwgYmUgaW52b2tlZCB3aGVuIHRoZSBSUEMgaXNcclxuICAgICAqIHJlYWR5IGZvciBvdXRib3VuZCByZXF1ZXN0cywgYXQgd2hpY2ggcG9pbnQgaXNPcGVuKCkgd2lsbCByZXR1cm4gdHJ1ZS5cclxuICAgICAqXHJcbiAgICAgKiBXaGVuIHN0YXJ0IHJldHVybnMsIGlzU3RhcnRlZCgpIHdpbGwgcmV0dXJuIHRydWUuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuRXJyb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5wZXJmb3JtQmFja29mZigpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFzc2VydCh0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbCwgJ0FscmVhZHkgc3RhcnRlZCcpO1xyXG4gICAgICAgIHRoaXMuYXV0aCgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU3RvcHMgdGhlIFJQQy4gVGhpcyBjYWxsIGlzIGlkZW1wb3RlbnQgYW5kIGFsbG93ZWQgcmVnYXJkbGVzcyBvZiB0aGVcclxuICAgICAqIGN1cnJlbnQgaXNTdGFydGVkKCkgc3RhdGUuXHJcbiAgICAgKlxyXG4gICAgICogV2hlbiBzdG9wIHJldHVybnMsIGlzU3RhcnRlZCgpIGFuZCBpc09wZW4oKSB3aWxsIGJvdGggcmV0dXJuIGZhbHNlLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc1N0YXJ0ZWQoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY2xvc2UoUGVyc2lzdGVudFN0cmVhbVN0YXRlLkluaXRpYWwpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFmdGVyIGFuIGVycm9yIHRoZSBzdHJlYW0gd2lsbCB1c3VhbGx5IGJhY2sgb2ZmIG9uIHRoZSBuZXh0IGF0dGVtcHQgdG9cclxuICAgICAqIHN0YXJ0IGl0LiBJZiB0aGUgZXJyb3Igd2FycmFudHMgYW4gaW1tZWRpYXRlIHJlc3RhcnQgb2YgdGhlIHN0cmVhbSwgdGhlXHJcbiAgICAgKiBzZW5kZXIgY2FuIHVzZSB0aGlzIHRvIGluZGljYXRlIHRoYXQgdGhlIHJlY2VpdmVyIHNob3VsZCBub3QgYmFjayBvZmYuXHJcbiAgICAgKlxyXG4gICAgICogRWFjaCBlcnJvciB3aWxsIGNhbGwgdGhlIG9uQ2xvc2UoKSBsaXN0ZW5lci4gVGhhdCBmdW5jdGlvbiBjYW4gZGVjaWRlIHRvXHJcbiAgICAgKiBpbmhpYml0IGJhY2tvZmYgaWYgcmVxdWlyZWQuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLmluaGliaXRCYWNrb2ZmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5pc1N0YXJ0ZWQoKSwgJ0NhbiBvbmx5IGluaGliaXQgYmFja29mZiBpbiBhIHN0b3BwZWQgc3RhdGUnKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkluaXRpYWw7XHJcbiAgICAgICAgdGhpcy5iYWNrb2ZmLnJlc2V0KCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBNYXJrcyB0aGlzIHN0cmVhbSBhcyBpZGxlLiBJZiBubyBmdXJ0aGVyIGFjdGlvbnMgYXJlIHBlcmZvcm1lZCBvbiB0aGVcclxuICAgICAqIHN0cmVhbSBmb3Igb25lIG1pbnV0ZSwgdGhlIHN0cmVhbSB3aWxsIGF1dG9tYXRpY2FsbHkgY2xvc2UgaXRzZWxmIGFuZFxyXG4gICAgICogbm90aWZ5IHRoZSBzdHJlYW0ncyBvbkNsb3NlKCkgaGFuZGxlciB3aXRoIFN0YXR1cy5PSy4gVGhlIHN0cmVhbSB3aWxsIHRoZW5cclxuICAgICAqIGJlIGluIGEgIWlzU3RhcnRlZCgpIHN0YXRlLCByZXF1aXJpbmcgdGhlIGNhbGxlciB0byBzdGFydCB0aGUgc3RyZWFtIGFnYWluXHJcbiAgICAgKiBiZWZvcmUgZnVydGhlciB1c2UuXHJcbiAgICAgKlxyXG4gICAgICogT25seSBzdHJlYW1zIHRoYXQgYXJlIGluIHN0YXRlICdPcGVuJyBjYW4gYmUgbWFya2VkIGlkbGUsIGFzIGFsbCBvdGhlclxyXG4gICAgICogc3RhdGVzIGltcGx5IHBlbmRpbmcgbmV0d29yayBvcGVyYXRpb25zLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5tYXJrSWRsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFN0YXJ0cyB0aGUgaWRsZSB0aW1lIGlmIHdlIGFyZSBpbiBzdGF0ZSAnT3BlbicgYW5kIGFyZSBub3QgeWV0IGFscmVhZHlcclxuICAgICAgICAvLyBydW5uaW5nIGEgdGltZXIgKGluIHdoaWNoIGNhc2UgdGhlIHByZXZpb3VzIGlkbGUgdGltZW91dCBzdGlsbCBhcHBsaWVzKS5cclxuICAgICAgICBpZiAodGhpcy5pc09wZW4oKSAmJiB0aGlzLmlkbGVUaW1lciA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmlkbGVUaW1lciA9IHRoaXMucXVldWUuZW5xdWV1ZUFmdGVyRGVsYXkodGhpcy5pZGxlVGltZXJJZCwgSURMRV9USU1FT1VUX01TLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVJZGxlQ2xvc2VUaW1lcigpOyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIFNlbmRzIGEgbWVzc2FnZSB0byB0aGUgdW5kZXJseWluZyBzdHJlYW0uICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5zZW5kUmVxdWVzdCA9IGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICB0aGlzLmNhbmNlbElkbGVDaGVjaygpO1xyXG4gICAgICAgIHRoaXMuc3RyZWFtLnNlbmQobXNnKTtcclxuICAgIH07XHJcbiAgICAvKiogQ2FsbGVkIGJ5IHRoZSBpZGxlIHRpbWVyIHdoZW4gdGhlIHN0cmVhbSBzaG91bGQgY2xvc2UgZHVlIHRvIGluYWN0aXZpdHkuICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5oYW5kbGVJZGxlQ2xvc2VUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc09wZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdoZW4gdGltaW5nIG91dCBhbiBpZGxlIHN0cmVhbSB0aGVyZSdzIG5vIHJlYXNvbiB0byBmb3JjZSB0aGUgc3RyZWFtIGludG8gYmFja29mZiB3aGVuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaXQgcmVzdGFydHMgc28gc2V0IHRoZSBzdHJlYW0gc3RhdGUgdG8gSW5pdGlhbCBpbnN0ZWFkIG9mIEVycm9yLlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmNsb3NlKFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBNYXJrcyB0aGUgc3RyZWFtIGFzIGFjdGl2ZSBhZ2Fpbi4gKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLmNhbmNlbElkbGVDaGVjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pZGxlVGltZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5pZGxlVGltZXIuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaWRsZVRpbWVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDbG9zZXMgdGhlIHN0cmVhbSBhbmQgY2xlYW5zIHVwIGFzIG5lY2Vzc2FyeTpcclxuICAgICAqXHJcbiAgICAgKiAqIGNsb3NlcyB0aGUgdW5kZXJseWluZyBHUlBDIHN0cmVhbTtcclxuICAgICAqICogY2FsbHMgdGhlIG9uQ2xvc2UgaGFuZGxlciB3aXRoIHRoZSBnaXZlbiAnZXJyb3InO1xyXG4gICAgICogKiBzZXRzIGludGVybmFsIHN0cmVhbSBzdGF0ZSB0byAnZmluYWxTdGF0ZSc7XHJcbiAgICAgKiAqIGFkanVzdHMgdGhlIGJhY2tvZmYgdGltZXIgYmFzZWQgb24gdGhlIGVycm9yXHJcbiAgICAgKlxyXG4gICAgICogQSBuZXcgc3RyZWFtIGNhbiBiZSBvcGVuZWQgYnkgY2FsbGluZyBzdGFydCgpLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBmaW5hbFN0YXRlIHRoZSBpbnRlbmRlZCBzdGF0ZSBvZiB0aGUgc3RyZWFtIGFmdGVyIGNsb3NpbmcuXHJcbiAgICAgKiBAcGFyYW0gZXJyb3IgdGhlIGVycm9yIHRoZSBjb25uZWN0aW9uIHdhcyBjbG9zZWQgd2l0aC5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoZmluYWxTdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQodGhpcy5pc1N0YXJ0ZWQoKSwgJ09ubHkgc3RhcnRlZCBzdHJlYW1zIHNob3VsZCBiZSBjbG9zZWQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydChmaW5hbFN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuRXJyb3IgfHwgaXNOdWxsT3JVbmRlZmluZWQoZXJyb3IkJDEpLCBcIkNhbid0IHByb3ZpZGUgYW4gZXJyb3Igd2hlbiBub3QgaW4gYW4gZXJyb3Igc3RhdGUuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDYW5jZWwgYW55IG91dHN0YW5kaW5nIHRpbWVycyAodGhleSdyZSBndWFyYW50ZWVkIG5vdCB0byBleGVjdXRlKS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW5jZWxJZGxlQ2hlY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iYWNrb2ZmLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJbnZhbGlkYXRlcyBhbnkgc3RyZWFtLXJlbGF0ZWQgY2FsbGJhY2tzIChlLmcuIGZyb20gYXV0aCBvciB0aGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW5kZXJseWluZyBzdHJlYW0pLCBndWFyYW50ZWVpbmcgdGhleSB3b24ndCBleGVjdXRlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlQ291bnQrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbmFsU3RhdGUgIT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5FcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBpcyBhbiBpbnRlbnRpb25hbCBjbG9zZSBlbnN1cmUgd2UgZG9uJ3QgZGVsYXkgb3VyIG5leHQgY29ubmVjdGlvbiBhdHRlbXB0LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iYWNrb2ZmLnJlc2V0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3IkJDEgJiYgZXJyb3IkJDEuY29kZSA9PT0gQ29kZS5SRVNPVVJDRV9FWEhBVVNURUQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIExvZyB0aGUgZXJyb3IuIChQcm9iYWJseSBlaXRoZXIgJ3F1b3RhIGV4Y2VlZGVkJyBvciAnbWF4IHF1ZXVlIGxlbmd0aCByZWFjaGVkJy4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcihlcnJvciQkMS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKCdVc2luZyBtYXhpbXVtIGJhY2tvZmYgZGVsYXkgdG8gcHJldmVudCBvdmVybG9hZGluZyB0aGUgYmFja2VuZC4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmFja29mZi5yZXNldFRvTWF4KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3IkJDEgJiYgZXJyb3IkJDEuY29kZSA9PT0gQ29kZS5VTkFVVEhFTlRJQ0FURUQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFwidW5hdXRoZW50aWNhdGVkXCIgZXJyb3IgbWVhbnMgdGhlIHRva2VuIHdhcyByZWplY3RlZC4gVHJ5IGZvcmNlIHJlZnJlc2hpbmcgaXQgaW4gY2FzZSBpdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8ganVzdCBleHBpcmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVkZW50aWFsc1Byb3ZpZGVyLmludmFsaWRhdGVUb2tlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENsZWFuIHVwIHRoZSB1bmRlcmx5aW5nIHN0cmVhbSBiZWNhdXNlIHdlIGFyZSBubyBsb25nZXIgaW50ZXJlc3RlZCBpbiBldmVudHMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0cmVhbSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZWFyRG93bigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHJlYW0uY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RyZWFtID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHN0YXRlIG11c3QgYmUgYXNzaWduZWQgYmVmb3JlIGNhbGxpbmcgb25DbG9zZSgpIHRvIGFsbG93IHRoZSBjYWxsYmFjayB0b1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpbmhpYml0IGJhY2tvZmYgb3Igb3RoZXJ3aXNlIG1hbmlwdWxhdGUgdGhlIHN0YXRlIGluIGl0cyBub24tc3RhcnRlZCBzdGF0ZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IGZpbmFsU3RhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmeSB0aGUgbGlzdGVuZXIgdGhhdCB0aGUgc3RyZWFtIGNsb3NlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5saXN0ZW5lci5vbkNsb3NlKGVycm9yJCQxKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZnkgdGhlIGxpc3RlbmVyIHRoYXQgdGhlIHN0cmVhbSBjbG9zZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENhbiBiZSBvdmVycmlkZGVuIHRvIHBlcmZvcm0gYWRkaXRpb25hbCBjbGVhbnVwIGJlZm9yZSB0aGUgc3RyZWFtIGlzIGNsb3NlZC5cclxuICAgICAqIENhbGxpbmcgc3VwZXIudGVhckRvd24oKSBpcyBub3QgcmVxdWlyZWQuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLnRlYXJEb3duID0gZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuYXV0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbCwgJ011c3QgYmUgaW4gaW5pdGlhbCBzdGF0ZSB0byBhdXRoJyk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5TdGFydGluZztcclxuICAgICAgICB2YXIgZGlzcGF0Y2hJZk5vdENsb3NlZCA9IHRoaXMuZ2V0Q2xvc2VHdWFyZGVkRGlzcGF0Y2hlcih0aGlzLmNsb3NlQ291bnQpO1xyXG4gICAgICAgIC8vIFRPRE8obWlrZWxlaGVuKTogSnVzdCB1c2UgZGlzcGF0Y2hJZk5vdENsb3NlZCwgYnV0IHNlZSBUT0RPIGJlbG93LlxyXG4gICAgICAgIHZhciBjbG9zZUNvdW50ID0gdGhpcy5jbG9zZUNvdW50O1xyXG4gICAgICAgIHRoaXMuY3JlZGVudGlhbHNQcm92aWRlci5nZXRUb2tlbigpLnRoZW4oZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgICAgIC8vIFN0cmVhbSBjYW4gYmUgc3RvcHBlZCB3aGlsZSB3YWl0aW5nIGZvciBhdXRoZW50aWNhdGlvbi5cclxuICAgICAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBXZSByZWFsbHkgc2hvdWxkIGp1c3QgdXNlIGRpc3BhdGNoSWZOb3RDbG9zZWRcclxuICAgICAgICAgICAgLy8gYW5kIGxldCB0aGlzIGRpc3BhdGNoIG9udG8gdGhlIHF1ZXVlLCBidXQgdGhhdCBvcGVuZWQgYSBzcGVjIHRlc3QgY2FuXHJcbiAgICAgICAgICAgIC8vIG9mIHdvcm1zIHRoYXQgSSBkb24ndCB3YW50IHRvIGRlYWwgd2l0aCBpbiB0aGlzIFBSLlxyXG4gICAgICAgICAgICBpZiAoX3RoaXMuY2xvc2VDb3VudCA9PT0gY2xvc2VDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgLy8gTm9ybWFsbHkgd2UnZCBoYXZlIHRvIHNjaGVkdWxlIHRoZSBjYWxsYmFjayBvbiB0aGUgQXN5bmNRdWV1ZS5cclxuICAgICAgICAgICAgICAgIC8vIEhvd2V2ZXIsIHRoZSBmb2xsb3dpbmcgY2FsbHMgYXJlIHNhZmUgdG8gYmUgY2FsbGVkIG91dHNpZGUgdGhlXHJcbiAgICAgICAgICAgICAgICAvLyBBc3luY1F1ZXVlIHNpbmNlIHRoZXkgZG9uJ3QgY2hhaW4gYXN5bmNocm9ub3VzIGNhbGxzXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zdGFydFN0cmVhbSh0b2tlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICAgICAgZGlzcGF0Y2hJZk5vdENsb3NlZChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcnBjRXJyb3IgPSBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTktOT1dOLCAnRmV0Y2hpbmcgYXV0aCB0b2tlbiBmYWlsZWQ6ICcgKyBlcnJvciQkMS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5oYW5kbGVTdHJlYW1DbG9zZShycGNFcnJvcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLnN0YXJ0U3RyZWFtID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQodGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLlN0YXJ0aW5nLCAnVHJ5aW5nIHRvIHN0YXJ0IHN0cmVhbSBpbiBhIG5vbi1zdGFydGluZyBzdGF0ZScpO1xyXG4gICAgICAgIHZhciBkaXNwYXRjaElmTm90Q2xvc2VkID0gdGhpcy5nZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyKHRoaXMuY2xvc2VDb3VudCk7XHJcbiAgICAgICAgdGhpcy5zdHJlYW0gPSB0aGlzLnN0YXJ0UnBjKHRva2VuKTtcclxuICAgICAgICB0aGlzLnN0cmVhbS5vbk9wZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkaXNwYXRjaElmTm90Q2xvc2VkKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChfdGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLlN0YXJ0aW5nLCAnRXhwZWN0ZWQgc3RyZWFtIHRvIGJlIGluIHN0YXRlIFN0YXJ0aW5nLCBidXQgd2FzICcgKyBfdGhpcy5zdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zdGF0ZSA9IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5PcGVuO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxpc3RlbmVyLm9uT3BlbigpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN0cmVhbS5vbkNsb3NlKGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgICAgICBkaXNwYXRjaElmTm90Q2xvc2VkKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5oYW5kbGVTdHJlYW1DbG9zZShlcnJvciQkMSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3RyZWFtLm9uTWVzc2FnZShmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgICAgIGRpc3BhdGNoSWZOb3RDbG9zZWQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLm9uTWVzc2FnZShtc2cpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5wZXJmb3JtQmFja29mZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuRXJyb3IsICdTaG91bGQgb25seSBwZXJmb3JtIGJhY2tvZmYgd2hlbiBpbiBFcnJvciBzdGF0ZScpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuQmFja29mZjtcclxuICAgICAgICB0aGlzLmJhY2tvZmYuYmFja29mZkFuZFJ1bihmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQodGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkJhY2tvZmYsICdCYWNrb2ZmIGVsYXBzZWQgYnV0IHN0YXRlIGlzIG5vdzogJyArIHRoaXMuc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KHRoaXMuaXNTdGFydGVkKCksICdQZXJzaXN0ZW50U3RyZWFtIHNob3VsZCBoYXZlIHN0YXJ0ZWQnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFZpc2libGUgZm9yIHRlc3RzXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5oYW5kbGVTdHJlYW1DbG9zZSA9IGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmlzU3RhcnRlZCgpLCBcIkNhbid0IGhhbmRsZSBzZXJ2ZXIgY2xvc2Ugb24gbm9uLXN0YXJ0ZWQgc3RyZWFtXCIpO1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckNiwgXCJjbG9zZSB3aXRoIGVycm9yOiBcIiArIGVycm9yJCQxKTtcclxuICAgICAgICB0aGlzLnN0cmVhbSA9IG51bGw7XHJcbiAgICAgICAgLy8gSW4gdGhlb3J5IHRoZSBzdHJlYW0gY291bGQgY2xvc2UgY2xlYW5seSwgaG93ZXZlciwgaW4gb3VyIGN1cnJlbnQgbW9kZWxcclxuICAgICAgICAvLyB3ZSBuZXZlciBleHBlY3QgdGhpcyB0byBoYXBwZW4gYmVjYXVzZSBpZiB3ZSBzdG9wIGEgc3RyZWFtIG91cnNlbHZlcyxcclxuICAgICAgICAvLyB0aGlzIGNhbGxiYWNrIHdpbGwgbmV2ZXIgYmUgY2FsbGVkLiBUbyBwcmV2ZW50IGNhc2VzIHdoZXJlIHdlIHJldHJ5XHJcbiAgICAgICAgLy8gd2l0aG91dCBhIGJhY2tvZmYgYWNjaWRlbnRhbGx5LCB3ZSBzZXQgdGhlIHN0cmVhbSB0byBlcnJvciBpbiBhbGwgY2FzZXMuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xvc2UoUGVyc2lzdGVudFN0cmVhbVN0YXRlLkVycm9yLCBlcnJvciQkMSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgXCJkaXNwYXRjaGVyXCIgZnVuY3Rpb24gdGhhdCBkaXNwYXRjaGVzIG9wZXJhdGlvbnMgb250byB0aGVcclxuICAgICAqIEFzeW5jUXVldWUgYnV0IG9ubHkgcnVucyB0aGVtIGlmIGNsb3NlQ291bnQgcmVtYWlucyB1bmNoYW5nZWQuIFRoaXMgYWxsb3dzXHJcbiAgICAgKiB1cyB0byB0dXJuIGF1dGggLyBzdHJlYW0gY2FsbGJhY2tzIGludG8gbm8tb3BzIGlmIHRoZSBzdHJlYW0gaXMgY2xvc2VkIC9cclxuICAgICAqIHJlLW9wZW5lZCwgZXRjLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5nZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyID0gZnVuY3Rpb24gKHN0YXJ0Q2xvc2VDb3VudCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgICAgICBfdGhpcy5xdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5jbG9zZUNvdW50ID09PSBzdGFydENsb3NlQ291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckNiwgJ3N0cmVhbSBjYWxsYmFjayBza2lwcGVkIGJ5IGdldENsb3NlR3VhcmRlZERpc3BhdGNoZXIuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQZXJzaXN0ZW50U3RyZWFtO1xyXG59KCkpO1xyXG4vKipcclxuICogQSBQZXJzaXN0ZW50U3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgTGlzdGVuIFJQQy5cclxuICpcclxuICogT25jZSB0aGUgTGlzdGVuIHN0cmVhbSBoYXMgY2FsbGVkIHRoZSBvbk9wZW4oKSBsaXN0ZW5lciwgYW55IG51bWJlciBvZlxyXG4gKiBsaXN0ZW4oKSBhbmQgdW5saXN0ZW4oKSBjYWxscyBjYW4gYmUgbWFkZSB0byBjb250cm9sIHdoYXQgY2hhbmdlcyB3aWxsIGJlXHJcbiAqIHNlbnQgZnJvbSB0aGUgc2VydmVyIGZvciBMaXN0ZW5SZXNwb25zZXMuXHJcbiAqL1xyXG52YXIgUGVyc2lzdGVudExpc3RlblN0cmVhbSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFBlcnNpc3RlbnRMaXN0ZW5TdHJlYW0sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBQZXJzaXN0ZW50TGlzdGVuU3RyZWFtKHF1ZXVlLCBjb25uZWN0aW9uLCBjcmVkZW50aWFscywgc2VyaWFsaXplciwgbGlzdGVuZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBxdWV1ZSwgVGltZXJJZC5MaXN0ZW5TdHJlYW1Db25uZWN0aW9uQmFja29mZiwgVGltZXJJZC5MaXN0ZW5TdHJlYW1JZGxlLCBjb25uZWN0aW9uLCBjcmVkZW50aWFscywgbGlzdGVuZXIpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgUGVyc2lzdGVudExpc3RlblN0cmVhbS5wcm90b3R5cGUuc3RhcnRScGMgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uLm9wZW5TdHJlYW0oJ0xpc3RlbicsIHRva2VuKTtcclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW50TGlzdGVuU3RyZWFtLnByb3RvdHlwZS5vbk1lc3NhZ2UgPSBmdW5jdGlvbiAod2F0Y2hDaGFuZ2VQcm90bykge1xyXG4gICAgICAgIC8vIEEgc3VjY2Vzc2Z1bCByZXNwb25zZSBtZWFucyB0aGUgc3RyZWFtIGlzIGhlYWx0aHlcclxuICAgICAgICB0aGlzLmJhY2tvZmYucmVzZXQoKTtcclxuICAgICAgICB2YXIgd2F0Y2hDaGFuZ2UgPSB0aGlzLnNlcmlhbGl6ZXIuZnJvbVdhdGNoQ2hhbmdlKHdhdGNoQ2hhbmdlUHJvdG8pO1xyXG4gICAgICAgIHZhciBzbmFwc2hvdCA9IHRoaXMuc2VyaWFsaXplci52ZXJzaW9uRnJvbUxpc3RlblJlc3BvbnNlKHdhdGNoQ2hhbmdlUHJvdG8pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVyLm9uV2F0Y2hDaGFuZ2Uod2F0Y2hDaGFuZ2UsIHNuYXBzaG90KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgZ2l2ZW4gcXVlcnkuIElmIHRoZSBxdWVyeVxyXG4gICAgICogaW5jbHVkZXMgYSByZXN1bWVUb2tlbiBpdCB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSByZXF1ZXN0LiBSZXN1bHRzIHRoYXRcclxuICAgICAqIGFmZmVjdCB0aGUgcXVlcnkgd2lsbCBiZSBzdHJlYW1lZCBiYWNrIGFzIFdhdGNoQ2hhbmdlIG1lc3NhZ2VzIHRoYXRcclxuICAgICAqIHJlZmVyZW5jZSB0aGUgdGFyZ2V0SWQuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRMaXN0ZW5TdHJlYW0ucHJvdG90eXBlLndhdGNoID0gZnVuY3Rpb24gKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0ge307XHJcbiAgICAgICAgcmVxdWVzdC5kYXRhYmFzZSA9IHRoaXMuc2VyaWFsaXplci5lbmNvZGVkRGF0YWJhc2VJZDtcclxuICAgICAgICByZXF1ZXN0LmFkZFRhcmdldCA9IHRoaXMuc2VyaWFsaXplci50b1RhcmdldChxdWVyeURhdGEpO1xyXG4gICAgICAgIHZhciBsYWJlbHMgPSB0aGlzLnNlcmlhbGl6ZXIudG9MaXN0ZW5SZXF1ZXN0TGFiZWxzKHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgaWYgKGxhYmVscykge1xyXG4gICAgICAgICAgICByZXF1ZXN0LmxhYmVscyA9IGxhYmVscztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVucmVnaXN0ZXJzIGludGVyZXN0IGluIHRoZSByZXN1bHRzIG9mIHRoZSBxdWVyeSBhc3NvY2lhdGVkIHdpdGggdGhlXHJcbiAgICAgKiBnaXZlbiB0YXJnZXRJZC5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudExpc3RlblN0cmVhbS5wcm90b3R5cGUudW53YXRjaCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0ge307XHJcbiAgICAgICAgcmVxdWVzdC5kYXRhYmFzZSA9IHRoaXMuc2VyaWFsaXplci5lbmNvZGVkRGF0YWJhc2VJZDtcclxuICAgICAgICByZXF1ZXN0LnJlbW92ZVRhcmdldCA9IHRhcmdldElkO1xyXG4gICAgICAgIHRoaXMuc2VuZFJlcXVlc3QocmVxdWVzdCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBlcnNpc3RlbnRMaXN0ZW5TdHJlYW07XHJcbn0oUGVyc2lzdGVudFN0cmVhbSkpO1xyXG4vKipcclxuICogQSBTdHJlYW0gdGhhdCBpbXBsZW1lbnRzIHRoZSBXcml0ZSBSUEMuXHJcbiAqXHJcbiAqIFRoZSBXcml0ZSBSUEMgcmVxdWlyZXMgdGhlIGNhbGxlciB0byBtYWludGFpbiBzcGVjaWFsIHN0cmVhbVRva2VuXHJcbiAqIHN0YXRlIGluIGJldHdlZW4gY2FsbHMsIHRvIGhlbHAgdGhlIHNlcnZlciB1bmRlcnN0YW5kIHdoaWNoIHJlc3BvbnNlcyB0aGVcclxuICogY2xpZW50IGhhcyBwcm9jZXNzZWQgYnkgdGhlIHRpbWUgdGhlIG5leHQgcmVxdWVzdCBpcyBtYWRlLiBFdmVyeSByZXNwb25zZVxyXG4gKiB3aWxsIGNvbnRhaW4gYSBzdHJlYW1Ub2tlbjsgdGhpcyB2YWx1ZSBtdXN0IGJlIHBhc3NlZCB0byB0aGUgbmV4dFxyXG4gKiByZXF1ZXN0LlxyXG4gKlxyXG4gKiBBZnRlciBjYWxsaW5nIHN0YXJ0KCkgb24gdGhpcyBzdHJlYW0sIHRoZSBuZXh0IHJlcXVlc3QgbXVzdCBiZSBhIGhhbmRzaGFrZSxcclxuICogY29udGFpbmluZyB3aGF0ZXZlciBzdHJlYW1Ub2tlbiBpcyBvbiBoYW5kLiBPbmNlIGEgcmVzcG9uc2UgdG8gdGhpc1xyXG4gKiByZXF1ZXN0IGlzIHJlY2VpdmVkLCBhbGwgcGVuZGluZyBtdXRhdGlvbnMgbWF5IGJlIHN1Ym1pdHRlZC4gV2hlblxyXG4gKiBzdWJtaXR0aW5nIG11bHRpcGxlIGJhdGNoZXMgb2YgbXV0YXRpb25zIGF0IHRoZSBzYW1lIHRpbWUsIGl0J3NcclxuICogb2theSB0byB1c2UgdGhlIHNhbWUgc3RyZWFtVG9rZW4gZm9yIHRoZSBjYWxscyB0byB3cml0ZU11dGF0aW9ucy5cclxuICpcclxuICogVE9ETyhiLzMzMjcxMjM1KTogVXNlIHByb3RvIHR5cGVzXHJcbiAqL1xyXG52YXIgUGVyc2lzdGVudFdyaXRlU3RyZWFtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUGVyc2lzdGVudFdyaXRlU3RyZWFtLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gUGVyc2lzdGVudFdyaXRlU3RyZWFtKHF1ZXVlLCBjb25uZWN0aW9uLCBjcmVkZW50aWFscywgc2VyaWFsaXplciwgbGlzdGVuZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBxdWV1ZSwgVGltZXJJZC5Xcml0ZVN0cmVhbUNvbm5lY3Rpb25CYWNrb2ZmLCBUaW1lcklkLldyaXRlU3RyZWFtSWRsZSwgY29ubmVjdGlvbiwgY3JlZGVudGlhbHMsIGxpc3RlbmVyKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgICAgIF90aGlzLmhhbmRzaGFrZUNvbXBsZXRlXyA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQZXJzaXN0ZW50V3JpdGVTdHJlYW0ucHJvdG90eXBlLCBcImhhbmRzaGFrZUNvbXBsZXRlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUcmFja3Mgd2hldGhlciBvciBub3QgYSBoYW5kc2hha2UgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGV4Y2hhbmdlZCBhbmRcclxuICAgICAgICAgKiB0aGUgc3RyZWFtIGlzIHJlYWR5IHRvIGFjY2VwdCBtdXRhdGlvbnMuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRzaGFrZUNvbXBsZXRlXztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8vIE92ZXJyaWRlIG9mIFBlcnNpc3RlbnRTdHJlYW0uc3RhcnRcclxuICAgIFBlcnNpc3RlbnRXcml0ZVN0cmVhbS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5oYW5kc2hha2VDb21wbGV0ZV8gPSBmYWxzZTtcclxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnN0YXJ0LmNhbGwodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVudFdyaXRlU3RyZWFtLnByb3RvdHlwZS50ZWFyRG93biA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5oYW5kc2hha2VDb21wbGV0ZV8pIHtcclxuICAgICAgICAgICAgdGhpcy53cml0ZU11dGF0aW9ucyhbXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbnRXcml0ZVN0cmVhbS5wcm90b3R5cGUuc3RhcnRScGMgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uLm9wZW5TdHJlYW0oJ1dyaXRlJywgdG9rZW4pO1xyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbnRXcml0ZVN0cmVhbS5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24gKHJlc3BvbnNlUHJvdG8pIHtcclxuICAgICAgICAvLyBBbHdheXMgY2FwdHVyZSB0aGUgbGFzdCBzdHJlYW0gdG9rZW4uXHJcbiAgICAgICAgYXNzZXJ0KCEhcmVzcG9uc2VQcm90by5zdHJlYW1Ub2tlbiwgJ0dvdCBhIHdyaXRlIHJlc3BvbnNlIHdpdGhvdXQgYSBzdHJlYW0gdG9rZW4nKTtcclxuICAgICAgICB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHJlc3BvbnNlUHJvdG8uc3RyZWFtVG9rZW47XHJcbiAgICAgICAgaWYgKCF0aGlzLmhhbmRzaGFrZUNvbXBsZXRlXykge1xyXG4gICAgICAgICAgICAvLyBUaGUgZmlyc3QgcmVzcG9uc2UgaXMgYWx3YXlzIHRoZSBoYW5kc2hha2UgcmVzcG9uc2VcclxuICAgICAgICAgICAgYXNzZXJ0KCFyZXNwb25zZVByb3RvLndyaXRlUmVzdWx0cyB8fCByZXNwb25zZVByb3RvLndyaXRlUmVzdWx0cy5sZW5ndGggPT09IDAsICdHb3QgbXV0YXRpb24gcmVzdWx0cyBmb3IgaGFuZHNoYWtlJyk7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZHNoYWtlQ29tcGxldGVfID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIub25IYW5kc2hha2VDb21wbGV0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gQSBzdWNjZXNzZnVsIGZpcnN0IHdyaXRlIHJlc3BvbnNlIG1lYW5zIHRoZSBzdHJlYW0gaXMgaGVhbHRoeSxcclxuICAgICAgICAgICAgLy8gTm90ZSwgdGhhdCB3ZSBjb3VsZCBjb25zaWRlciBhIHN1Y2Nlc3NmdWwgaGFuZHNoYWtlIGhlYWx0aHksIGhvd2V2ZXIsXHJcbiAgICAgICAgICAgIC8vIHRoZSB3cml0ZSBpdHNlbGYgbWlnaHQgYmUgY2F1c2luZyBhbiBlcnJvciB3ZSB3YW50IHRvIGJhY2sgb2ZmIGZyb20uXHJcbiAgICAgICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHRoaXMuc2VyaWFsaXplci5mcm9tV3JpdGVSZXN1bHRzKHJlc3BvbnNlUHJvdG8ud3JpdGVSZXN1bHRzLCByZXNwb25zZVByb3RvLmNvbW1pdFRpbWUpO1xyXG4gICAgICAgICAgICB2YXIgY29tbWl0VmVyc2lvbiA9IHRoaXMuc2VyaWFsaXplci5mcm9tVmVyc2lvbihyZXNwb25zZVByb3RvLmNvbW1pdFRpbWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5lci5vbk11dGF0aW9uUmVzdWx0KGNvbW1pdFZlcnNpb24sIHJlc3VsdHMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFNlbmRzIGFuIGluaXRpYWwgc3RyZWFtVG9rZW4gdG8gdGhlIHNlcnZlciwgcGVyZm9ybWluZyB0aGUgaGFuZHNoYWtlXHJcbiAgICAgKiByZXF1aXJlZCB0byBtYWtlIHRoZSBTdHJlYW1pbmdXcml0ZSBSUEMgd29yay4gU3Vic2VxdWVudFxyXG4gICAgICogY2FsbHMgc2hvdWxkIHdhaXQgdW50aWwgb25IYW5kc2hha2VDb21wbGV0ZSB3YXMgY2FsbGVkLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50V3JpdGVTdHJlYW0ucHJvdG90eXBlLndyaXRlSGFuZHNoYWtlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmlzT3BlbigpLCAnV3JpdGluZyBoYW5kc2hha2UgcmVxdWlyZXMgYW4gb3BlbmVkIHN0cmVhbScpO1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5oYW5kc2hha2VDb21wbGV0ZV8sICdIYW5kc2hha2UgYWxyZWFkeSBjb21wbGV0ZWQnKTtcclxuICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IFN1cHBvcnQgc3RyZWFtIHJlc3VtcHRpb24uIFdlIGludGVudGlvbmFsbHkgZG8gbm90IHNldCB0aGVcclxuICAgICAgICAvLyBzdHJlYW0gdG9rZW4gb24gdGhlIGhhbmRzaGFrZSwgaWdub3JpbmcgYW55IHN0cmVhbSB0b2tlbiB3ZSBtaWdodCBoYXZlLlxyXG4gICAgICAgIHZhciByZXF1ZXN0ID0ge307XHJcbiAgICAgICAgcmVxdWVzdC5kYXRhYmFzZSA9IHRoaXMuc2VyaWFsaXplci5lbmNvZGVkRGF0YWJhc2VJZDtcclxuICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgfTtcclxuICAgIC8qKiBTZW5kcyBhIGdyb3VwIG9mIG11dGF0aW9ucyB0byB0aGUgRmlyZXN0b3JlIGJhY2tlbmQgdG8gYXBwbHkuICovXHJcbiAgICBQZXJzaXN0ZW50V3JpdGVTdHJlYW0ucHJvdG90eXBlLndyaXRlTXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuaXNPcGVuKCksICdXcml0aW5nIG11dGF0aW9ucyByZXF1aXJlcyBhbiBvcGVuZWQgc3RyZWFtJyk7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuaGFuZHNoYWtlQ29tcGxldGVfLCAnSGFuZHNoYWtlIG11c3QgYmUgY29tcGxldGUgYmVmb3JlIHdyaXRpbmcgbXV0YXRpb25zJyk7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMubGFzdFN0cmVhbVRva2VuLmxlbmd0aCA+IDAsICdUcnlpbmcgdG8gd3JpdGUgbXV0YXRpb24gd2l0aG91dCBhIHRva2VuJyk7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB7XHJcbiAgICAgICAgICAgIC8vIFByb3RvcyBhcmUgdHlwZWQgd2l0aCBzdHJpbmcsIGJ1dCB3ZSBzdXBwb3J0IFVJbnQ4QXJyYXkgb24gTm9kZVxyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55XHJcbiAgICAgICAgICAgIHN0cmVhbVRva2VuOiB0aGlzLmxhc3RTdHJlYW1Ub2tlbixcclxuICAgICAgICAgICAgd3JpdGVzOiBtdXRhdGlvbnMubWFwKGZ1bmN0aW9uIChtdXRhdGlvbikgeyByZXR1cm4gX3RoaXMuc2VyaWFsaXplci50b011dGF0aW9uKG11dGF0aW9uKTsgfSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc2VuZFJlcXVlc3QocmVxdWVzdCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBlcnNpc3RlbnRXcml0ZVN0cmVhbTtcclxufShQZXJzaXN0ZW50U3RyZWFtKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRGF0YXN0b3JlIGlzIGEgd3JhcHBlciBhcm91bmQgdGhlIGV4dGVybmFsIEdvb2dsZSBDbG91ZCBEYXRhc3RvcmUgZ3JwYyBBUEksXHJcbiAqIHdoaWNoIHByb3ZpZGVzIGFuIGludGVyZmFjZSB0aGF0IGlzIG1vcmUgY29udmVuaWVudCBmb3IgdGhlIHJlc3Qgb2YgdGhlXHJcbiAqIGNsaWVudCBTREsgYXJjaGl0ZWN0dXJlIHRvIGNvbnN1bWUuXHJcbiAqL1xyXG52YXIgRGF0YXN0b3JlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGF0YXN0b3JlKHF1ZXVlLCBjb25uZWN0aW9uLCBjcmVkZW50aWFscywgc2VyaWFsaXplcikge1xyXG4gICAgICAgIHRoaXMucXVldWUgPSBxdWV1ZTtcclxuICAgICAgICB0aGlzLmNvbm5lY3Rpb24gPSBjb25uZWN0aW9uO1xyXG4gICAgICAgIHRoaXMuY3JlZGVudGlhbHMgPSBjcmVkZW50aWFscztcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgfVxyXG4gICAgRGF0YXN0b3JlLnByb3RvdHlwZS5uZXdQZXJzaXN0ZW50V3JpdGVTdHJlYW0gPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbnRXcml0ZVN0cmVhbSh0aGlzLnF1ZXVlLCB0aGlzLmNvbm5lY3Rpb24sIHRoaXMuY3JlZGVudGlhbHMsIHRoaXMuc2VyaWFsaXplciwgbGlzdGVuZXIpO1xyXG4gICAgfTtcclxuICAgIERhdGFzdG9yZS5wcm90b3R5cGUubmV3UGVyc2lzdGVudFdhdGNoU3RyZWFtID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW50TGlzdGVuU3RyZWFtKHRoaXMucXVldWUsIHRoaXMuY29ubmVjdGlvbiwgdGhpcy5jcmVkZW50aWFscywgdGhpcy5zZXJpYWxpemVyLCBsaXN0ZW5lcik7XHJcbiAgICB9O1xyXG4gICAgRGF0YXN0b3JlLnByb3RvdHlwZS5jb21taXQgPSBmdW5jdGlvbiAobXV0YXRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICBkYXRhYmFzZTogdGhpcy5zZXJpYWxpemVyLmVuY29kZWREYXRhYmFzZUlkLFxyXG4gICAgICAgICAgICB3cml0ZXM6IG11dGF0aW9ucy5tYXAoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIF90aGlzLnNlcmlhbGl6ZXIudG9NdXRhdGlvbihtKTsgfSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludm9rZVJQQygnQ29tbWl0JywgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc2VyaWFsaXplci5mcm9tV3JpdGVSZXN1bHRzKHJlc3BvbnNlLndyaXRlUmVzdWx0cywgcmVzcG9uc2UuY29tbWl0VGltZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRGF0YXN0b3JlLnByb3RvdHlwZS5sb29rdXAgPSBmdW5jdGlvbiAoa2V5cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IHtcclxuICAgICAgICAgICAgZGF0YWJhc2U6IHRoaXMuc2VyaWFsaXplci5lbmNvZGVkRGF0YWJhc2VJZCxcclxuICAgICAgICAgICAgZG9jdW1lbnRzOiBrZXlzLm1hcChmdW5jdGlvbiAoaykgeyByZXR1cm4gX3RoaXMuc2VyaWFsaXplci50b05hbWUoayk7IH0pXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnZva2VTdHJlYW1pbmdSUEMoJ0JhdGNoR2V0RG9jdW1lbnRzJywgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICB2YXIgZG9jcyA9IG1heWJlRG9jdW1lbnRNYXAoKTtcclxuICAgICAgICAgICAgcmVzcG9uc2UuZm9yRWFjaChmdW5jdGlvbiAocHJvdG8pIHtcclxuICAgICAgICAgICAgICAgIHZhciBkb2MgPSBfdGhpcy5zZXJpYWxpemVyLmZyb21NYXliZURvY3VtZW50KHByb3RvKTtcclxuICAgICAgICAgICAgICAgIGRvY3MgPSBkb2NzLmluc2VydChkb2Mua2V5LCBkb2MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRvYyA9IGRvY3MuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoISFkb2MsICdNaXNzaW5nIGVudGl0eSBpbiB3cml0ZSByZXNwb25zZSBmb3IgJyArIGtleSk7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChkb2MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogR2V0cyBhbiBhdXRoIHRva2VuIGFuZCBpbnZva2VzIHRoZSBwcm92aWRlZCBSUEMuICovXHJcbiAgICBEYXRhc3RvcmUucHJvdG90eXBlLmludm9rZVJQQyA9IGZ1bmN0aW9uIChycGNOYW1lLCByZXF1ZXN0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5jcmVkZW50aWFsc1xyXG4gICAgICAgICAgICAuZ2V0VG9rZW4oKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNvbm5lY3Rpb24uaW52b2tlUlBDKHJwY05hbWUsIHJlcXVlc3QsIHRva2VuKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvci5jb2RlID09PSBDb2RlLlVOQVVUSEVOVElDQVRFRCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEdldHMgYW4gYXV0aCB0b2tlbiBhbmQgaW52b2tlcyB0aGUgcHJvdmlkZWQgUlBDIHdpdGggc3RyZWFtZWQgcmVzdWx0cy4gKi9cclxuICAgIERhdGFzdG9yZS5wcm90b3R5cGUuaW52b2tlU3RyZWFtaW5nUlBDID0gZnVuY3Rpb24gKHJwY05hbWUsIHJlcXVlc3QpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWRlbnRpYWxzXHJcbiAgICAgICAgICAgIC5nZXRUb2tlbigpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY29ubmVjdGlvbi5pbnZva2VTdHJlYW1pbmdSUEMocnBjTmFtZSwgcmVxdWVzdCwgdG9rZW4pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IENvZGUuVU5BVVRIRU5USUNBVEVEKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRGF0YXN0b3JlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEludGVybmFsIHRyYW5zYWN0aW9uIG9iamVjdCByZXNwb25zaWJsZSBmb3IgYWNjdW11bGF0aW5nIHRoZSBtdXRhdGlvbnMgdG9cclxuICogcGVyZm9ybSBhbmQgdGhlIGJhc2UgdmVyc2lvbnMgZm9yIGFueSBkb2N1bWVudHMgcmVhZC5cclxuICovXHJcbnZhciBUcmFuc2FjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRyYW5zYWN0aW9uKGRhdGFzdG9yZSkge1xyXG4gICAgICAgIHRoaXMuZGF0YXN0b3JlID0gZGF0YXN0b3JlO1xyXG4gICAgICAgIC8vIFRoZSB2ZXJzaW9uIG9mIGVhY2ggZG9jdW1lbnQgdGhhdCB3YXMgcmVhZCBkdXJpbmcgdGhpcyB0cmFuc2FjdGlvbi5cclxuICAgICAgICB0aGlzLnJlYWRWZXJzaW9ucyA9IGRvY3VtZW50VmVyc2lvbk1hcCgpO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25zID0gW107XHJcbiAgICAgICAgdGhpcy5jb21taXR0ZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5yZWNvcmRWZXJzaW9uID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIHZhciBkb2NWZXJzaW9uO1xyXG4gICAgICAgIGlmIChkb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICBkb2NWZXJzaW9uID0gZG9jLnZlcnNpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGRvYyBpbnN0YW5jZW9mIE5vRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgLy8gRm9yIGRlbGV0ZWQgZG9jcywgd2UgbXVzdCB1c2UgYmFzZVZlcnNpb24gMCB3aGVuIHdlIG92ZXJ3cml0ZSB0aGVtLlxyXG4gICAgICAgICAgICBkb2NWZXJzaW9uID0gU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGZhaWwoJ0RvY3VtZW50IGluIGEgdHJhbnNhY3Rpb24gd2FzIGEgJyArIGRvYy5jb25zdHJ1Y3Rvci5uYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGV4aXN0aW5nVmVyc2lvbiA9IHRoaXMucmVhZFZlcnNpb25zLmdldChkb2Mua2V5KTtcclxuICAgICAgICBpZiAoZXhpc3RpbmdWZXJzaW9uICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jVmVyc2lvbi5pc0VxdWFsKGV4aXN0aW5nVmVyc2lvbikpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoaXMgdHJhbnNhY3Rpb24gd2lsbCBmYWlsIG5vIG1hdHRlciB3aGF0LlxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuQUJPUlRFRCwgJ0RvY3VtZW50IHZlcnNpb24gY2hhbmdlZCBiZXR3ZWVuIHR3byByZWFkcy4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5yZWFkVmVyc2lvbnMgPSB0aGlzLnJlYWRWZXJzaW9ucy5pbnNlcnQoZG9jLmtleSwgZG9jVmVyc2lvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5sb29rdXAgPSBmdW5jdGlvbiAoa2V5cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMuY29tbWl0dGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnVHJhbnNhY3Rpb24gaGFzIGFscmVhZHkgY29tcGxldGVkLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5tdXRhdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ1RyYW5zYWN0aW9ucyBsb29rdXBzIGFyZSBpbnZhbGlkIGFmdGVyIHdyaXRlcy4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YXN0b3JlLmxvb2t1cChrZXlzKS50aGVuKGZ1bmN0aW9uIChkb2NzKSB7XHJcbiAgICAgICAgICAgIGRvY3MuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZG9jIGluc3RhbmNlb2YgTm9Eb2N1bWVudCB8fCBkb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnJlY29yZFZlcnNpb24oZG9jKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGZhaWwoJ0RvY3VtZW50IGluIGEgdHJhbnNhY3Rpb24gd2FzIGEgJyArIGRvYy5jb25zdHJ1Y3Rvci5uYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkb2NzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcclxuICAgICAgICBpZiAodGhpcy5jb21taXR0ZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgJ1RyYW5zYWN0aW9uIGhhcyBhbHJlYWR5IGNvbXBsZXRlZC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvbnMgPSB0aGlzLm11dGF0aW9ucy5jb25jYXQobXV0YXRpb25zKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHZlcnNpb24gb2YgdGhpcyBkb2N1bWVudCB3aGVuIGl0IHdhcyByZWFkIGluIHRoaXMgdHJhbnNhY3Rpb24sXHJcbiAgICAgKiBhcyBhIHByZWNvbmRpdGlvbiwgb3Igbm8gcHJlY29uZGl0aW9uIGlmIGl0IHdhcyBub3QgcmVhZC5cclxuICAgICAqL1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLnByZWNvbmRpdGlvbiA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgdmVyc2lvbiA9IHRoaXMucmVhZFZlcnNpb25zLmdldChrZXkpO1xyXG4gICAgICAgIGlmICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcmVjb25kaXRpb24udXBkYXRlVGltZSh2ZXJzaW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcmVjb25kaXRpb24uTk9ORTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBwcmVjb25kaXRpb24gZm9yIGEgZG9jdW1lbnQgaWYgdGhlIG9wZXJhdGlvbiBpcyBhbiB1cGRhdGUuXHJcbiAgICAgKi9cclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5wcmVjb25kaXRpb25Gb3JVcGRhdGUgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQoa2V5KTtcclxuICAgICAgICBpZiAodmVyc2lvbiAmJiB2ZXJzaW9uLmlzRXF1YWwoU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKSkpIHtcclxuICAgICAgICAgICAgLy8gVGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QsIHNvIGZhaWwgdGhlIHRyYW5zYWN0aW9uLlxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkNhbid0IHVwZGF0ZSBhIGRvY3VtZW50IHRoYXQgZG9lc24ndCBleGlzdC5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZlcnNpb24pIHtcclxuICAgICAgICAgICAgLy8gRG9jdW1lbnQgZXhpc3RzLCBiYXNlIHByZWNvbmRpdGlvbiBvbiBkb2N1bWVudCB1cGRhdGUgdGltZS5cclxuICAgICAgICAgICAgcmV0dXJuIFByZWNvbmRpdGlvbi51cGRhdGVUaW1lKHZlcnNpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gRG9jdW1lbnQgd2FzIG5vdCByZWFkLCBzbyB3ZSBqdXN0IHVzZSB0aGUgcHJlY29uZGl0aW9ucyBmb3IgYSBibGluZFxyXG4gICAgICAgICAgICAvLyB1cGRhdGUuXHJcbiAgICAgICAgICAgIHJldHVybiBQcmVjb25kaXRpb24uZXhpc3RzKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGtleSwgZGF0YSkge1xyXG4gICAgICAgIHRoaXMud3JpdGUoZGF0YS50b011dGF0aW9ucyhrZXksIHRoaXMucHJlY29uZGl0aW9uKGtleSkpKTtcclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGtleSwgZGF0YSkge1xyXG4gICAgICAgIHRoaXMud3JpdGUoZGF0YS50b011dGF0aW9ucyhrZXksIHRoaXMucHJlY29uZGl0aW9uRm9yVXBkYXRlKGtleSkpKTtcclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHRoaXMud3JpdGUoW25ldyBEZWxldGVNdXRhdGlvbihrZXksIHRoaXMucHJlY29uZGl0aW9uKGtleSkpXSk7XHJcbiAgICAgICAgLy8gU2luY2UgdGhlIGRlbGV0ZSB3aWxsIGJlIGFwcGxpZWQgYmVmb3JlIGFsbCBmb2xsb3dpbmcgd3JpdGVzLCB3ZSBuZWVkIHRvXHJcbiAgICAgICAgLy8gZW5zdXJlIHRoYXQgdGhlIHByZWNvbmRpdGlvbiBmb3IgdGhlIG5leHQgd3JpdGUgd2lsbCBiZSBleGlzdHM6IGZhbHNlLlxyXG4gICAgICAgIHRoaXMucmVhZFZlcnNpb25zID0gdGhpcy5yZWFkVmVyc2lvbnMuaW5zZXJ0KGtleSwgU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKSk7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLmNvbW1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciB1bndyaXR0ZW4gPSB0aGlzLnJlYWRWZXJzaW9ucztcclxuICAgICAgICAvLyBGb3IgZWFjaCBtdXRhdGlvbiwgbm90ZSB0aGF0IHRoZSBkb2Mgd2FzIHdyaXR0ZW4uXHJcbiAgICAgICAgdGhpcy5tdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobXV0YXRpb24pIHtcclxuICAgICAgICAgICAgdW53cml0dGVuID0gdW53cml0dGVuLnJlbW92ZShtdXRhdGlvbi5rZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICghdW53cml0dGVuLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoRXJyb3IoJ0V2ZXJ5IGRvY3VtZW50IHJlYWQgaW4gYSB0cmFuc2FjdGlvbiBtdXN0IGFsc28gYmUgd3JpdHRlbi4nKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFzdG9yZS5jb21taXQodGhpcy5tdXRhdGlvbnMpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5jb21taXR0ZWQgPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUcmFuc2FjdGlvbjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBEZXNjcmliZXMgdGhlIG9ubGluZSBzdGF0ZSBvZiB0aGUgRmlyZXN0b3JlIGNsaWVudC4gTm90ZSB0aGF0IHRoaXMgZG9lcyBub3RcclxuICogaW5kaWNhdGUgd2hldGhlciBvciBub3QgdGhlIHJlbW90ZSBzdG9yZSBpcyB0cnlpbmcgdG8gY29ubmVjdCBvciBub3QuIFRoaXMgaXNcclxuICogcHJpbWFyaWx5IHVzZWQgYnkgdGhlIFZpZXcgLyBFdmVudE1hbmFnZXIgY29kZSB0byBjaGFuZ2UgdGhlaXIgYmVoYXZpb3Igd2hpbGVcclxuICogb2ZmbGluZSAoZS5nLiBnZXQoKSBjYWxscyBzaG91bGRuJ3Qgd2FpdCBmb3IgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIgYW5kXHJcbiAqIHNuYXBzaG90IGV2ZW50cyBzaG91bGQgc2V0IG1ldGFkYXRhLmlzRnJvbUNhY2hlPXRydWUpLlxyXG4gKi9cclxudmFyIE9ubGluZVN0YXRlO1xyXG4oZnVuY3Rpb24gKE9ubGluZVN0YXRlKSB7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBGaXJlc3RvcmUgY2xpZW50IGlzIGluIGFuIHVua25vd24gb25saW5lIHN0YXRlLiBUaGlzIG1lYW5zIHRoZSBjbGllbnRcclxuICAgICAqIGlzIGVpdGhlciBub3QgYWN0aXZlbHkgdHJ5aW5nIHRvIGVzdGFibGlzaCBhIGNvbm5lY3Rpb24gb3IgaXQgaXMgY3VycmVudGx5XHJcbiAgICAgKiB0cnlpbmcgdG8gZXN0YWJsaXNoIGEgY29ubmVjdGlvbiwgYnV0IGl0IGhhcyBub3Qgc3VjY2VlZGVkIG9yIGZhaWxlZCB5ZXQuXHJcbiAgICAgKiBIaWdoZXItbGV2ZWwgY29tcG9uZW50cyBzaG91bGQgbm90IG9wZXJhdGUgaW4gb2ZmbGluZSBtb2RlLlxyXG4gICAgICovXHJcbiAgICBPbmxpbmVTdGF0ZVtPbmxpbmVTdGF0ZVtcIlVua25vd25cIl0gPSAwXSA9IFwiVW5rbm93blwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgY2xpZW50IGlzIGNvbm5lY3RlZCBhbmQgdGhlIGNvbm5lY3Rpb25zIGFyZSBoZWFsdGh5LiBUaGlzIHN0YXRlIGlzXHJcbiAgICAgKiByZWFjaGVkIGFmdGVyIGEgc3VjY2Vzc2Z1bCBjb25uZWN0aW9uIGFuZCB0aGVyZSBoYXMgYmVlbiBhdCBsZWFzdCBvbmVcclxuICAgICAqIHN1Y2Nlc3NmdWwgbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoZSBiYWNrZW5kcy5cclxuICAgICAqL1xyXG4gICAgT25saW5lU3RhdGVbT25saW5lU3RhdGVbXCJPbmxpbmVcIl0gPSAxXSA9IFwiT25saW5lXCI7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBjbGllbnQgaXMgZWl0aGVyIHRyeWluZyB0byBlc3RhYmxpc2ggYSBjb25uZWN0aW9uIGJ1dCBmYWlsaW5nLCBvciBpdFxyXG4gICAgICogaGFzIGJlZW4gZXhwbGljaXRseSBtYXJrZWQgb2ZmbGluZSB2aWEgYSBjYWxsIHRvIGRpc2FibGVOZXR3b3JrKCkuXHJcbiAgICAgKiBIaWdoZXItbGV2ZWwgY29tcG9uZW50cyBzaG91bGQgb3BlcmF0ZSBpbiBvZmZsaW5lIG1vZGUuXHJcbiAgICAgKi9cclxuICAgIE9ubGluZVN0YXRlW09ubGluZVN0YXRlW1wiT2ZmbGluZVwiXSA9IDJdID0gXCJPZmZsaW5lXCI7XHJcbn0pKE9ubGluZVN0YXRlIHx8IChPbmxpbmVTdGF0ZSA9IHt9KSk7XHJcbi8qKiBUaGUgc291cmNlIG9mIGFuIG9ubGluZSBzdGF0ZSBldmVudC4gKi9cclxudmFyIE9ubGluZVN0YXRlU291cmNlO1xyXG4oZnVuY3Rpb24gKE9ubGluZVN0YXRlU291cmNlKSB7XHJcbiAgICBPbmxpbmVTdGF0ZVNvdXJjZVtPbmxpbmVTdGF0ZVNvdXJjZVtcIlJlbW90ZVN0b3JlXCJdID0gMF0gPSBcIlJlbW90ZVN0b3JlXCI7XHJcbiAgICBPbmxpbmVTdGF0ZVNvdXJjZVtPbmxpbmVTdGF0ZVNvdXJjZVtcIlNoYXJlZENsaWVudFN0YXRlXCJdID0gMV0gPSBcIlNoYXJlZENsaWVudFN0YXRlXCI7XHJcbn0pKE9ubGluZVN0YXRlU291cmNlIHx8IChPbmxpbmVTdGF0ZVNvdXJjZSA9IHt9KSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQ3ID0gJ09ubGluZVN0YXRlVHJhY2tlcic7XHJcbi8vIFRvIGRlYWwgd2l0aCB0cmFuc2llbnQgZmFpbHVyZXMsIHdlIGFsbG93IG11bHRpcGxlIHN0cmVhbSBhdHRlbXB0cyBiZWZvcmVcclxuLy8gZ2l2aW5nIHVwIGFuZCB0cmFuc2l0aW9uaW5nIGZyb20gT25saW5lU3RhdGUuVW5rbm93biB0byBPZmZsaW5lLlxyXG4vLyBUT0RPKG1pa2VsZWhlbik6IFRoaXMgdXNlZCB0byBiZSBzZXQgdG8gMiBhcyBhIG1pdGlnYXRpb24gZm9yIGIvNjYyMjgzOTQuXHJcbi8vIEBqZGltb25kIHRoaW5rcyB0aGF0IGJ1ZyBpcyBzdWZmaWNpZW50bHkgZml4ZWQgc28gdGhhdCB3ZSBjYW4gc2V0IHRoaXMgYmFja1xyXG4vLyB0byAxLiBJZiB0aGF0IHdvcmtzIG9rYXksIHdlIGNvdWxkIHBvdGVudGlhbGx5IHJlbW92ZSB0aGlzIGxvZ2ljIGVudGlyZWx5LlxyXG52YXIgTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUyA9IDE7XHJcbi8vIFRvIGRlYWwgd2l0aCBzdHJlYW0gYXR0ZW1wdHMgdGhhdCBkb24ndCBzdWNjZWVkIG9yIGZhaWwgaW4gYSB0aW1lbHkgbWFubmVyLFxyXG4vLyB3ZSBoYXZlIGEgdGltZW91dCBmb3IgT25saW5lU3RhdGUgdG8gcmVhY2ggT25saW5lIG9yIE9mZmxpbmUuXHJcbi8vIElmIHRoZSB0aW1lb3V0IGlzIHJlYWNoZWQsIHdlIHRyYW5zaXRpb24gdG8gT2ZmbGluZSByYXRoZXIgdGhhbiB3YWl0aW5nXHJcbi8vIGluZGVmaW5pdGVseS5cclxudmFyIE9OTElORV9TVEFURV9USU1FT1VUX01TID0gMTAgKiAxMDAwO1xyXG4vKipcclxuICogQSBjb21wb25lbnQgdXNlZCBieSB0aGUgUmVtb3RlU3RvcmUgdG8gdHJhY2sgdGhlIE9ubGluZVN0YXRlICh0aGF0IGlzLFxyXG4gKiB3aGV0aGVyIG9yIG5vdCB0aGUgY2xpZW50IGFzIGEgd2hvbGUgc2hvdWxkIGJlIGNvbnNpZGVyZWQgdG8gYmUgb25saW5lIG9yXHJcbiAqIG9mZmxpbmUpLCBpbXBsZW1lbnRpbmcgdGhlIGFwcHJvcHJpYXRlIGhldXJpc3RpY3MuXHJcbiAqXHJcbiAqIEluIHBhcnRpY3VsYXIsIHdoZW4gdGhlIGNsaWVudCBpcyB0cnlpbmcgdG8gY29ubmVjdCB0byB0aGUgYmFja2VuZCwgd2VcclxuICogYWxsb3cgdXAgdG8gTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUyB3aXRoaW4gT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMgZm9yXHJcbiAqIGEgY29ubmVjdGlvbiB0byBzdWNjZWVkLiBJZiB3ZSBoYXZlIHRvbyBtYW55IGZhaWx1cmVzIG9yIHRoZSB0aW1lb3V0IGVsYXBzZXMsXHJcbiAqIHRoZW4gd2Ugc2V0IHRoZSBPbmxpbmVTdGF0ZSB0byBPZmZsaW5lLCBhbmQgdGhlIGNsaWVudCB3aWxsIGJlaGF2ZSBhcyBpZlxyXG4gKiBpdCBpcyBvZmZsaW5lIChnZXQoKXMgd2lsbCByZXR1cm4gY2FjaGVkIGRhdGEsIGV0Yy4pLlxyXG4gKi9cclxudmFyIE9ubGluZVN0YXRlVHJhY2tlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE9ubGluZVN0YXRlVHJhY2tlcihhc3luY1F1ZXVlLCBvbmxpbmVTdGF0ZUhhbmRsZXIpIHtcclxuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSBhc3luY1F1ZXVlO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGVIYW5kbGVyID0gb25saW5lU3RhdGVIYW5kbGVyO1xyXG4gICAgICAgIC8qKiBUaGUgY3VycmVudCBPbmxpbmVTdGF0ZS4gKi9cclxuICAgICAgICB0aGlzLnN0YXRlID0gT25saW5lU3RhdGUuVW5rbm93bjtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGNvdW50IG9mIGNvbnNlY3V0aXZlIGZhaWx1cmVzIHRvIG9wZW4gdGhlIHN0cmVhbS4gSWYgaXQgcmVhY2hlcyB0aGVcclxuICAgICAgICAgKiBtYXhpbXVtIGRlZmluZWQgYnkgTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUywgd2UnbGwgc2V0IHRoZSBPbmxpbmVTdGF0ZSB0b1xyXG4gICAgICAgICAqIE9mZmxpbmUuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy53YXRjaFN0cmVhbUZhaWx1cmVzID0gMDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIHRpbWVyIHRoYXQgZWxhcHNlcyBhZnRlciBPTkxJTkVfU1RBVEVfVElNRU9VVF9NUywgYXQgd2hpY2ggcG9pbnQgd2VcclxuICAgICAgICAgKiB0cmFuc2l0aW9uIGZyb20gT25saW5lU3RhdGUuVW5rbm93biB0byBPbmxpbmVTdGF0ZS5PZmZsaW5lIHdpdGhvdXQgd2FpdGluZ1xyXG4gICAgICAgICAqIGZvciB0aGUgc3RyZWFtIHRvIGFjdHVhbGx5IGZhaWwgKE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMgdGltZXMpLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGVUaW1lciA9IG51bGw7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogV2hldGhlciB0aGUgY2xpZW50IHNob3VsZCBsb2cgYSB3YXJuaW5nIG1lc3NhZ2UgaWYgaXQgZmFpbHMgdG8gY29ubmVjdCB0b1xyXG4gICAgICAgICAqIHRoZSBiYWNrZW5kIChpbml0aWFsbHkgdHJ1ZSwgY2xlYXJlZCBhZnRlciBhIHN1Y2Nlc3NmdWwgc3RyZWFtLCBvciBpZiB3ZSd2ZVxyXG4gICAgICAgICAqIGxvZ2dlZCB0aGUgbWVzc2FnZSBhbHJlYWR5KS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnNob3VsZFdhcm5DbGllbnRJc09mZmxpbmUgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgYnkgUmVtb3RlU3RvcmUgd2hlbiBhIHdhdGNoIHN0cmVhbSBpcyBzdGFydGVkIChpbmNsdWRpbmcgb24gZWFjaFxyXG4gICAgICogYmFja29mZiBhdHRlbXB0KS5cclxuICAgICAqXHJcbiAgICAgKiBJZiB0aGlzIGlzIHRoZSBmaXJzdCBhdHRlbXB0LCBpdCBzZXRzIHRoZSBPbmxpbmVTdGF0ZSB0byBVbmtub3duIGFuZCBzdGFydHNcclxuICAgICAqIHRoZSBvbmxpbmVTdGF0ZVRpbWVyLlxyXG4gICAgICovXHJcbiAgICBPbmxpbmVTdGF0ZVRyYWNrZXIucHJvdG90eXBlLmhhbmRsZVdhdGNoU3RyZWFtU3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy53YXRjaFN0cmVhbUZhaWx1cmVzID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QW5kQnJvYWRjYXN0KE9ubGluZVN0YXRlLlVua25vd24pO1xyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy5vbmxpbmVTdGF0ZVRpbWVyID09PSBudWxsLCBcIm9ubGluZVN0YXRlVGltZXIgc2hvdWxkbid0IGJlIHN0YXJ0ZWQgeWV0XCIpO1xyXG4gICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVGltZXIgPSB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFmdGVyRGVsYXkoVGltZXJJZC5PbmxpbmVTdGF0ZVRpbWVvdXQsIE9OTElORV9TVEFURV9USU1FT1VUX01TLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vbmxpbmVTdGF0ZVRpbWVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGFzc2VydChfdGhpcy5zdGF0ZSA9PT0gT25saW5lU3RhdGUuVW5rbm93biwgJ1RpbWVyIHNob3VsZCBiZSBjYW5jZWxlZCBpZiB3ZSB0cmFuc2l0aW9uZWQgdG8gYSBkaWZmZXJlbnQgc3RhdGUuJyk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5sb2dDbGllbnRPZmZsaW5lV2FybmluZ0lmTmVjZXNzYXJ5KFwiQmFja2VuZCBkaWRuJ3QgcmVzcG9uZCB3aXRoaW4gXCIgKyBPTkxJTkVfU1RBVEVfVElNRU9VVF9NUyAvIDEwMDAgKyBcIiBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgXCJzZWNvbmRzLlwiKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLnNldEFuZEJyb2FkY2FzdChPbmxpbmVTdGF0ZS5PZmZsaW5lKTtcclxuICAgICAgICAgICAgICAgIC8vIE5PVEU6IGhhbmRsZVdhdGNoU3RyZWFtRmFpbHVyZSgpIHdpbGwgY29udGludWUgdG8gaW5jcmVtZW50XHJcbiAgICAgICAgICAgICAgICAvLyB3YXRjaFN0cmVhbUZhaWx1cmVzIGV2ZW4gdGhvdWdoIHdlIGFyZSBhbHJlYWR5IG1hcmtlZCBPZmZsaW5lLFxyXG4gICAgICAgICAgICAgICAgLy8gYnV0IHRoaXMgaXMgbm9uLWhhcm1mdWwuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgb3VyIE9ubGluZVN0YXRlIGFzIGFwcHJvcHJpYXRlIGFmdGVyIHRoZSB3YXRjaCBzdHJlYW0gcmVwb3J0cyBhXHJcbiAgICAgKiBmYWlsdXJlLiBUaGUgZmlyc3QgZmFpbHVyZSBtb3ZlcyB1cyB0byB0aGUgJ1Vua25vd24nIHN0YXRlLiBXZSB0aGVuIG1heVxyXG4gICAgICogYWxsb3cgbXVsdGlwbGUgZmFpbHVyZXMgKGJhc2VkIG9uIE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMpIGJlZm9yZSB3ZVxyXG4gICAgICogYWN0dWFsbHkgdHJhbnNpdGlvbiB0byB0aGUgJ09mZmxpbmUnIHN0YXRlLlxyXG4gICAgICovXHJcbiAgICBPbmxpbmVTdGF0ZVRyYWNrZXIucHJvdG90eXBlLmhhbmRsZVdhdGNoU3RyZWFtRmFpbHVyZSA9IGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBPbmxpbmVTdGF0ZS5PbmxpbmUpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRBbmRCcm9hZGNhc3QoT25saW5lU3RhdGUuVW5rbm93bik7XHJcbiAgICAgICAgICAgIC8vIFRvIGdldCB0byBPbmxpbmVTdGF0ZS5PbmxpbmUsIHNldCgpIG11c3QgaGF2ZSBiZWVuIGNhbGxlZCB3aGljaCB3b3VsZFxyXG4gICAgICAgICAgICAvLyBoYXZlIHJlc2V0IG91ciBoZXVyaXN0aWNzLlxyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy53YXRjaFN0cmVhbUZhaWx1cmVzID09PSAwLCAnd2F0Y2hTdHJlYW1GYWlsdXJlcyBtdXN0IGJlIDAnKTtcclxuICAgICAgICAgICAgYXNzZXJ0KHRoaXMub25saW5lU3RhdGVUaW1lciA9PT0gbnVsbCwgJ29ubGluZVN0YXRlVGltZXIgbXVzdCBiZSBudWxsJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLndhdGNoU3RyZWFtRmFpbHVyZXMrKztcclxuICAgICAgICAgICAgaWYgKHRoaXMud2F0Y2hTdHJlYW1GYWlsdXJlcyA+PSBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyT25saW5lU3RhdGVUaW1lcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dDbGllbnRPZmZsaW5lV2FybmluZ0lmTmVjZXNzYXJ5KFwiQ29ubmVjdGlvbiBmYWlsZWQgXCIgKyBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTICsgXCIgXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIChcInRpbWVzLiBNb3N0IHJlY2VudCBlcnJvcjogXCIgKyBlcnJvciQkMS50b1N0cmluZygpKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEFuZEJyb2FkY2FzdChPbmxpbmVTdGF0ZS5PZmZsaW5lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEV4cGxpY2l0bHkgc2V0cyB0aGUgT25saW5lU3RhdGUgdG8gdGhlIHNwZWNpZmllZCBzdGF0ZS5cclxuICAgICAqXHJcbiAgICAgKiBOb3RlIHRoYXQgdGhpcyByZXNldHMgb3VyIHRpbWVycyAvIGZhaWx1cmUgY291bnRlcnMsIGV0Yy4gdXNlZCBieSBvdXJcclxuICAgICAqIE9mZmxpbmUgaGV1cmlzdGljcywgc28gbXVzdCBub3QgYmUgdXNlZCBpbiBwbGFjZSBvZlxyXG4gICAgICogaGFuZGxlV2F0Y2hTdHJlYW1TdGFydCgpIGFuZCBoYW5kbGVXYXRjaFN0cmVhbUZhaWx1cmUoKS5cclxuICAgICAqL1xyXG4gICAgT25saW5lU3RhdGVUcmFja2VyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobmV3U3RhdGUpIHtcclxuICAgICAgICB0aGlzLmNsZWFyT25saW5lU3RhdGVUaW1lcigpO1xyXG4gICAgICAgIHRoaXMud2F0Y2hTdHJlYW1GYWlsdXJlcyA9IDA7XHJcbiAgICAgICAgaWYgKG5ld1N0YXRlID09PSBPbmxpbmVTdGF0ZS5PbmxpbmUpIHtcclxuICAgICAgICAgICAgLy8gV2UndmUgY29ubmVjdGVkIHRvIHdhdGNoIGF0IGxlYXN0IG9uY2UuIERvbid0IHdhcm4gdGhlIGRldmVsb3BlclxyXG4gICAgICAgICAgICAvLyBhYm91dCBiZWluZyBvZmZsaW5lIGdvaW5nIGZvcndhcmQuXHJcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkV2FybkNsaWVudElzT2ZmbGluZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldEFuZEJyb2FkY2FzdChuZXdTdGF0ZSk7XHJcbiAgICB9O1xyXG4gICAgT25saW5lU3RhdGVUcmFja2VyLnByb3RvdHlwZS5zZXRBbmRCcm9hZGNhc3QgPSBmdW5jdGlvbiAobmV3U3RhdGUpIHtcclxuICAgICAgICBpZiAobmV3U3RhdGUgIT09IHRoaXMuc3RhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IG5ld1N0YXRlO1xyXG4gICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlSGFuZGxlcihuZXdTdGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9ubGluZVN0YXRlVHJhY2tlci5wcm90b3R5cGUubG9nQ2xpZW50T2ZmbGluZVdhcm5pbmdJZk5lY2Vzc2FyeSA9IGZ1bmN0aW9uIChkZXRhaWxzKSB7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSBcIkNvdWxkIG5vdCByZWFjaCBDbG91ZCBGaXJlc3RvcmUgYmFja2VuZC4gXCIgKyBkZXRhaWxzICsgXCJcXG5cIiArXHJcbiAgICAgICAgICAgIFwiVGhpcyB0eXBpY2FsbHkgaW5kaWNhdGVzIHRoYXQgeW91ciBkZXZpY2UgZG9lcyBub3QgaGF2ZSBhIGhlYWx0aHkgXCIgK1xyXG4gICAgICAgICAgICBcIkludGVybmV0IGNvbm5lY3Rpb24gYXQgdGhlIG1vbWVudC4gVGhlIGNsaWVudCB3aWxsIG9wZXJhdGUgaW4gb2ZmbGluZSBcIiArXHJcbiAgICAgICAgICAgIFwibW9kZSB1bnRpbCBpdCBpcyBhYmxlIHRvIHN1Y2Nlc3NmdWxseSBjb25uZWN0IHRvIHRoZSBiYWNrZW5kLlwiO1xyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZFdhcm5DbGllbnRJc09mZmxpbmUpIHtcclxuICAgICAgICAgICAgZXJyb3IobWVzc2FnZSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkV2FybkNsaWVudElzT2ZmbGluZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ3LCBtZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT25saW5lU3RhdGVUcmFja2VyLnByb3RvdHlwZS5jbGVhck9ubGluZVN0YXRlVGltZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMub25saW5lU3RhdGVUaW1lciAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVGltZXIuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUaW1lciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBPbmxpbmVTdGF0ZVRyYWNrZXI7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQ4ID0gJ1JlbW90ZVN0b3JlJztcclxuLy8gVE9ETyhiLzM1ODUzNDAyKTogTmVnb3RpYXRlIHRoaXMgd2l0aCB0aGUgc3RyZWFtLlxyXG52YXIgTUFYX1BFTkRJTkdfV1JJVEVTID0gMTA7XHJcbi8qKlxyXG4gKiBSZW1vdGVTdG9yZSAtIEFuIGludGVyZmFjZSB0byByZW1vdGVseSBzdG9yZWQgZGF0YSwgYmFzaWNhbGx5IHByb3ZpZGluZyBhXHJcbiAqIHdyYXBwZXIgYXJvdW5kIHRoZSBEYXRhc3RvcmUgdGhhdCBpcyBtb3JlIHJlbGlhYmxlIGZvciB0aGUgcmVzdCBvZiB0aGVcclxuICogc3lzdGVtLlxyXG4gKlxyXG4gKiBSZW1vdGVTdG9yZSBpcyByZXNwb25zaWJsZSBmb3IgbWFpbnRhaW5pbmcgdGhlIGNvbm5lY3Rpb24gdG8gdGhlIHNlcnZlci5cclxuICogLSBtYWludGFpbmluZyBhIGxpc3Qgb2YgYWN0aXZlIGxpc3RlbnMuXHJcbiAqIC0gcmVjb25uZWN0aW5nIHdoZW4gdGhlIGNvbm5lY3Rpb24gaXMgZHJvcHBlZC5cclxuICogLSByZXN1bWluZyBhbGwgdGhlIGFjdGl2ZSBsaXN0ZW5zIG9uIHJlY29ubmVjdC5cclxuICpcclxuICogUmVtb3RlU3RvcmUgaGFuZGxlcyBhbGwgaW5jb21pbmcgZXZlbnRzIGZyb20gdGhlIERhdGFzdG9yZS5cclxuICogLSBsaXN0ZW5pbmcgdG8gdGhlIHdhdGNoIHN0cmVhbSBhbmQgcmVwYWNrYWdpbmcgdGhlIGV2ZW50cyBhcyBSZW1vdGVFdmVudHNcclxuICogLSBub3RpZnlpbmcgU3luY0VuZ2luZSBvZiBhbnkgY2hhbmdlcyB0byB0aGUgYWN0aXZlIGxpc3RlbnMuXHJcbiAqXHJcbiAqIFJlbW90ZVN0b3JlIHRha2VzIHdyaXRlcyBmcm9tIG90aGVyIGNvbXBvbmVudHMgYW5kIGhhbmRsZXMgdGhlbSByZWxpYWJseS5cclxuICogLSBwdWxsaW5nIHBlbmRpbmcgbXV0YXRpb25zIGZyb20gTG9jYWxTdG9yZSBhbmQgc2VuZGluZyB0aGVtIHRvIERhdGFzdG9yZS5cclxuICogLSByZXRyeWluZyBtdXRhdGlvbnMgdGhhdCBmYWlsZWQgYmVjYXVzZSBvZiBuZXR3b3JrIHByb2JsZW1zLlxyXG4gKiAtIGFja2luZyBtdXRhdGlvbnMgdG8gdGhlIFN5bmNFbmdpbmUgb25jZSB0aGV5IGFyZSBhY2NlcHRlZCBvciByZWplY3RlZC5cclxuICovXHJcbnZhciBSZW1vdGVTdG9yZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlbW90ZVN0b3JlKFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbG9jYWwgc3RvcmUsIHVzZWQgdG8gZmlsbCB0aGUgd3JpdGUgcGlwZWxpbmUgd2l0aCBvdXRib3VuZCBtdXRhdGlvbnMuXHJcbiAgICAgKi9cclxuICAgIGxvY2FsU3RvcmUsIFxyXG4gICAgLyoqIFRoZSBjbGllbnQtc2lkZSBwcm94eSBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgYmFja2VuZC4gKi9cclxuICAgIGRhdGFzdG9yZSwgYXN5bmNRdWV1ZSwgb25saW5lU3RhdGVIYW5kbGVyKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlID0gbG9jYWxTdG9yZTtcclxuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IGRhdGFzdG9yZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGxpc3Qgb2YgdXAgdG8gTUFYX1BFTkRJTkdfV1JJVEVTIHdyaXRlcyB0aGF0IHdlIGhhdmUgZmV0Y2hlZCBmcm9tIHRoZVxyXG4gICAgICAgICAqIExvY2FsU3RvcmUgdmlhIGZpbGxXcml0ZVBpcGVsaW5lKCkgYW5kIGhhdmUgb3Igd2lsbCBzZW5kIHRvIHRoZSB3cml0ZVxyXG4gICAgICAgICAqIHN0cmVhbS5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIFdoZW5ldmVyIHdyaXRlUGlwZWxpbmUubGVuZ3RoID4gMCB0aGUgUmVtb3RlU3RvcmUgd2lsbCBhdHRlbXB0IHRvIHN0YXJ0IG9yXHJcbiAgICAgICAgICogcmVzdGFydCB0aGUgd3JpdGUgc3RyZWFtLiBXaGVuIHRoZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQgdGhlIHdyaXRlcyBpbiB0aGVcclxuICAgICAgICAgKiBwaXBlbGluZSB3aWxsIGJlIHNlbnQgaW4gb3JkZXIuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBXcml0ZXMgcmVtYWluIGluIHdyaXRlUGlwZWxpbmUgdW50aWwgdGhleSBhcmUgYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kXHJcbiAgICAgICAgICogYW5kIHRodXMgd2lsbCBhdXRvbWF0aWNhbGx5IGJlIHJlLXNlbnQgaWYgdGhlIHN0cmVhbSBpcyBpbnRlcnJ1cHRlZCAvXHJcbiAgICAgICAgICogcmVzdGFydGVkIGJlZm9yZSB0aGV5J3JlIGFja25vd2xlZGdlZC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIFdyaXRlIHJlc3BvbnNlcyBmcm9tIHRoZSBiYWNrZW5kIGFyZSBsaW5rZWQgdG8gdGhlaXIgb3JpZ2luYXRpbmcgcmVxdWVzdFxyXG4gICAgICAgICAqIHB1cmVseSBiYXNlZCBvbiBvcmRlciwgYW5kIHNvIHdlIGNhbiBqdXN0IHNoaWZ0KCkgd3JpdGVzIGZyb20gdGhlIGZyb250IG9mXHJcbiAgICAgICAgICogdGhlIHdyaXRlUGlwZWxpbmUgYXMgd2UgcmVjZWl2ZSByZXNwb25zZXMuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy53cml0ZVBpcGVsaW5lID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBtYXBwaW5nIG9mIHdhdGNoZWQgdGFyZ2V0cyB0aGF0IHRoZSBjbGllbnQgY2FyZXMgYWJvdXQgdHJhY2tpbmcgYW5kIHRoZVxyXG4gICAgICAgICAqIHVzZXIgaGFzIGV4cGxpY2l0bHkgY2FsbGVkIGEgJ2xpc3RlbicgZm9yIHRoaXMgdGFyZ2V0LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogVGhlc2UgdGFyZ2V0cyBtYXkgb3IgbWF5IG5vdCBoYXZlIGJlZW4gc2VudCB0byBvciBhY2tub3dsZWRnZWQgYnkgdGhlXHJcbiAgICAgICAgICogc2VydmVyLiBPbiByZS1lc3RhYmxpc2hpbmcgdGhlIGxpc3RlbiBzdHJlYW0sIHRoZXNlIHRhcmdldHMgc2hvdWxkIGJlIHNlbnRcclxuICAgICAgICAgKiB0byB0aGUgc2VydmVyLiBUaGUgdGFyZ2V0cyByZW1vdmVkIHdpdGggdW5saXN0ZW5zIGFyZSByZW1vdmVkIGVhZ2VybHlcclxuICAgICAgICAgKiB3aXRob3V0IHdhaXRpbmcgZm9yIGNvbmZpcm1hdGlvbiBmcm9tIHRoZSBsaXN0ZW4gc3RyZWFtLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubGlzdGVuVGFyZ2V0cyA9IHt9O1xyXG4gICAgICAgIHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yID0gbnVsbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBTZXQgdG8gdHJ1ZSBieSBlbmFibGVOZXR3b3JrKCkgYW5kIGZhbHNlIGJ5IGRpc2FibGVOZXR3b3JrKCkgYW5kIGluZGljYXRlc1xyXG4gICAgICAgICAqIHRoZSB1c2VyLXByZWZlcnJlZCBuZXR3b3JrIHN0YXRlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzUHJpbWFyeSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyID0gbmV3IE9ubGluZVN0YXRlVHJhY2tlcihhc3luY1F1ZXVlLCBvbmxpbmVTdGF0ZUhhbmRsZXIpO1xyXG4gICAgICAgIC8vIENyZWF0ZSBzdHJlYW1zIChidXQgbm90ZSB0aGV5J3JlIG5vdCBzdGFydGVkIHlldCkuXHJcbiAgICAgICAgdGhpcy53YXRjaFN0cmVhbSA9IHRoaXMuZGF0YXN0b3JlLm5ld1BlcnNpc3RlbnRXYXRjaFN0cmVhbSh7XHJcbiAgICAgICAgICAgIG9uT3BlbjogdGhpcy5vbldhdGNoU3RyZWFtT3Blbi5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICBvbkNsb3NlOiB0aGlzLm9uV2F0Y2hTdHJlYW1DbG9zZS5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICBvbldhdGNoQ2hhbmdlOiB0aGlzLm9uV2F0Y2hTdHJlYW1DaGFuZ2UuYmluZCh0aGlzKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMud3JpdGVTdHJlYW0gPSB0aGlzLmRhdGFzdG9yZS5uZXdQZXJzaXN0ZW50V3JpdGVTdHJlYW0oe1xyXG4gICAgICAgICAgICBvbk9wZW46IHRoaXMub25Xcml0ZVN0cmVhbU9wZW4uYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgb25DbG9zZTogdGhpcy5vbldyaXRlU3RyZWFtQ2xvc2UuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgb25IYW5kc2hha2VDb21wbGV0ZTogdGhpcy5vbldyaXRlSGFuZHNoYWtlQ29tcGxldGUuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgb25NdXRhdGlvblJlc3VsdDogdGhpcy5vbk11dGF0aW9uUmVzdWx0LmJpbmQodGhpcylcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIHVwIHRoZSByZW1vdGUgc3RvcmUsIGNyZWF0aW5nIHN0cmVhbXMsIHJlc3RvcmluZyBzdGF0ZSBmcm9tXHJcbiAgICAgKiBMb2NhbFN0b3JlLCBldGMuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5lbmFibGVOZXR3b3JrKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFJlLWVuYWJsZXMgdGhlIG5ldHdvcmsuIElkZW1wb3RlbnQuICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuZW5hYmxlTmV0d29yayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FuVXNlTmV0d29yaygpKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzLndyaXRlU3RyZWFtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUuZ2V0TGFzdFN0cmVhbVRva2VuKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFzdFN0cmVhbVRva2VuID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zaG91bGRTdGFydFdhdGNoU3RyZWFtKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRXYXRjaFN0cmVhbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuc2V0KE9ubGluZVN0YXRlLlVua25vd24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2lsbCBzdGFydCB0aGUgd3JpdGUgc3RyZWFtIGlmIG5lY2Vzc2FyeS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5maWxsV3JpdGVQaXBlbGluZSgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2lsbCBzdGFydCB0aGUgd3JpdGUgc3RyZWFtIGlmIG5lY2Vzc2FyeS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVGVtcG9yYXJpbHkgZGlzYWJsZXMgdGhlIG5ldHdvcmsuIFRoZSBuZXR3b3JrIGNhbiBiZSByZS1lbmFibGVkIHVzaW5nXHJcbiAgICAgKiBlbmFibGVOZXR3b3JrKCkuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5kaXNhYmxlTmV0d29yayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ldHdvcmtFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZGlzYWJsZU5ldHdvcmtJbnRlcm5hbCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBPbmxpbmVTdGF0ZSB0byBPZmZsaW5lIHNvIGdldCgpcyByZXR1cm4gZnJvbSBjYWNoZSwgZXRjLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5zZXQoT25saW5lU3RhdGUuT2ZmbGluZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmRpc2FibGVOZXR3b3JrSW50ZXJuYWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy53cml0ZVN0cmVhbS5zdG9wKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLndhdGNoU3RyZWFtLnN0b3AoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ4LCBcIlN0b3BwaW5nIHdyaXRlIHN0cmVhbSB3aXRoIFwiICsgdGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aCArIFwiIHBlbmRpbmcgd3JpdGVzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53cml0ZVBpcGVsaW5lID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhblVwV2F0Y2hTdHJlYW1TdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5zaHV0ZG93biA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDgsICdSZW1vdGVTdG9yZSBzaHV0dGluZyBkb3duLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ldHdvcmtFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZGlzYWJsZU5ldHdvcmtJbnRlcm5hbCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBPbmxpbmVTdGF0ZSB0byBVbmtub3duIChyYXRoZXIgdGhhbiBPZmZsaW5lKSB0byBhdm9pZCBwb3RlbnRpYWxseVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlnZ2VyaW5nIHNwdXJpb3VzIGxpc3RlbmVyIGV2ZW50cyB3aXRoIGNhY2hlZCBkYXRhLCBldGMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLnNldChPbmxpbmVTdGF0ZS5Vbmtub3duKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogU3RhcnRzIG5ldyBsaXN0ZW4gZm9yIHRoZSBnaXZlbiBxdWVyeS4gVXNlcyByZXN1bWUgdG9rZW4gaWYgcHJvdmlkZWQgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgYXNzZXJ0KCFjb250YWlucyh0aGlzLmxpc3RlblRhcmdldHMsIHF1ZXJ5RGF0YS50YXJnZXRJZCksICdsaXN0ZW4gY2FsbGVkIHdpdGggZHVwbGljYXRlIHRhcmdldElkIScpO1xyXG4gICAgICAgIC8vIE1hcmsgdGhpcyBhcyBzb21ldGhpbmcgdGhlIGNsaWVudCBpcyBjdXJyZW50bHkgbGlzdGVuaW5nIGZvci5cclxuICAgICAgICB0aGlzLmxpc3RlblRhcmdldHNbcXVlcnlEYXRhLnRhcmdldElkXSA9IHF1ZXJ5RGF0YTtcclxuICAgICAgICBpZiAodGhpcy5zaG91bGRTdGFydFdhdGNoU3RyZWFtKCkpIHtcclxuICAgICAgICAgICAgLy8gVGhlIGxpc3RlbiB3aWxsIGJlIHNlbnQgaW4gb25XYXRjaFN0cmVhbU9wZW5cclxuICAgICAgICAgICAgdGhpcy5zdGFydFdhdGNoU3RyZWFtKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMud2F0Y2hTdHJlYW0uaXNPcGVuKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5zZW5kV2F0Y2hSZXF1ZXN0KHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiBSZW1vdmVzIHRoZSBsaXN0ZW4gZnJvbSBzZXJ2ZXIgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS51bmxpc3RlbiA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIGFzc2VydChjb250YWlucyh0aGlzLmxpc3RlblRhcmdldHMsIHRhcmdldElkKSwgJ3VubGlzdGVuIGNhbGxlZCB3aXRob3V0IGFzc2lnbmVkIHRhcmdldCBJRCEnKTtcclxuICAgICAgICBkZWxldGUgdGhpcy5saXN0ZW5UYXJnZXRzW3RhcmdldElkXTtcclxuICAgICAgICBpZiAodGhpcy53YXRjaFN0cmVhbS5pc09wZW4oKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbmRVbndhdGNoUmVxdWVzdCh0YXJnZXRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc0VtcHR5KHRoaXMubGlzdGVuVGFyZ2V0cykpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMud2F0Y2hTdHJlYW0uaXNPcGVuKCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMud2F0Y2hTdHJlYW0ubWFya0lkbGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmNhblVzZU5ldHdvcmsoKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gUmV2ZXJ0IHRvIE9ubGluZVN0YXRlLlVua25vd24gaWYgdGhlIHdhdGNoIHN0cmVhbSBpcyBub3Qgb3BlbiBhbmQgd2VcclxuICAgICAgICAgICAgICAgIC8vIGhhdmUgbm8gbGlzdGVuZXJzLCBzaW5jZSB3aXRob3V0IGFueSBsaXN0ZW5zIHRvIHNlbmQgd2UgY2Fubm90XHJcbiAgICAgICAgICAgICAgICAvLyBjb25maXJtIGlmIHRoZSBzdHJlYW0gaXMgaGVhbHRoeSBhbmQgdXBncmFkZSB0byBPbmxpbmVTdGF0ZS5PbmxpbmUuXHJcbiAgICAgICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5zZXQoT25saW5lU3RhdGUuVW5rbm93bik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIHtAbGluayBUYXJnZXRNZXRhZGF0YVByb3ZpZGVyLmdldFF1ZXJ5RGF0YUZvclRhcmdldH0gKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5nZXRRdWVyeURhdGFGb3JUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5UYXJnZXRzW3RhcmdldElkXSB8fCBudWxsO1xyXG4gICAgfTtcclxuICAgIC8qKiB7QGxpbmsgVGFyZ2V0TWV0YWRhdGFQcm92aWRlci5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0fSAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmdldFJlbW90ZUtleXNGb3JUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zeW5jRW5naW5lLmdldFJlbW90ZUtleXNGb3JUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogV2UgbmVlZCB0byBpbmNyZW1lbnQgdGhlIHRoZSBleHBlY3RlZCBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgd2UncmUgZHVlXHJcbiAgICAgKiBmcm9tIHdhdGNoIHNvIHdlIHdhaXQgZm9yIHRoZSBhY2sgdG8gcHJvY2VzcyBhbnkgbWVzc2FnZXMgZnJvbSB0aGlzIHRhcmdldC5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnNlbmRXYXRjaFJlcXVlc3QgPSBmdW5jdGlvbiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IucmVjb3JkUGVuZGluZ1RhcmdldFJlcXVlc3QocXVlcnlEYXRhLnRhcmdldElkKTtcclxuICAgICAgICB0aGlzLndhdGNoU3RyZWFtLndhdGNoKHF1ZXJ5RGF0YSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBXZSBuZWVkIHRvIGluY3JlbWVudCB0aGUgZXhwZWN0ZWQgbnVtYmVyIG9mIHBlbmRpbmcgcmVzcG9uc2VzIHdlJ3JlIGR1ZVxyXG4gICAgICogZnJvbSB3YXRjaCBzbyB3ZSB3YWl0IGZvciB0aGUgcmVtb3ZhbCBvbiB0aGUgc2VydmVyIGJlZm9yZSB3ZSBwcm9jZXNzIGFueVxyXG4gICAgICogbWVzc2FnZXMgZnJvbSB0aGlzIHRhcmdldC5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnNlbmRVbndhdGNoUmVxdWVzdCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnJlY29yZFBlbmRpbmdUYXJnZXRSZXF1ZXN0KHRhcmdldElkKTtcclxuICAgICAgICB0aGlzLndhdGNoU3RyZWFtLnVud2F0Y2godGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5zdGFydFdhdGNoU3RyZWFtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnNob3VsZFN0YXJ0V2F0Y2hTdHJlYW0oKSwgJ3N0YXJ0V2F0Y2hTdHJlYW0oKSBjYWxsZWQgd2hlbiBzaG91bGRTdGFydFdhdGNoU3RyZWFtKCkgaXMgZmFsc2UuJyk7XHJcbiAgICAgICAgdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IgPSBuZXcgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yKHRoaXMpO1xyXG4gICAgICAgIHRoaXMud2F0Y2hTdHJlYW0uc3RhcnQoKTtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5oYW5kbGVXYXRjaFN0cmVhbVN0YXJ0KCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHdhdGNoIHN0cmVhbSBzaG91bGQgYmUgc3RhcnRlZCBiZWNhdXNlIGl0J3MgbmVjZXNzYXJ5XHJcbiAgICAgKiBhbmQgaGFzIG5vdCB5ZXQgYmVlbiBzdGFydGVkLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuc2hvdWxkU3RhcnRXYXRjaFN0cmVhbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuY2FuVXNlTmV0d29yaygpICYmXHJcbiAgICAgICAgICAgICF0aGlzLndhdGNoU3RyZWFtLmlzU3RhcnRlZCgpICYmXHJcbiAgICAgICAgICAgICFpc0VtcHR5KHRoaXMubGlzdGVuVGFyZ2V0cykpO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5jYW5Vc2VOZXR3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlzUHJpbWFyeSAmJiB0aGlzLm5ldHdvcmtFbmFibGVkO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5jbGVhblVwV2F0Y2hTdHJlYW1TdGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvciA9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLm9uV2F0Y2hTdHJlYW1PcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGZvckVhY2hOdW1iZXIodGhpcy5saXN0ZW5UYXJnZXRzLCBmdW5jdGlvbiAodGFyZ2V0SWQsIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnNlbmRXYXRjaFJlcXVlc3QocXVlcnlEYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUub25XYXRjaFN0cmVhbUNsb3NlID0gZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yJCQxID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBHcmFjZWZ1bCBzdG9wIChkdWUgdG8gc3RvcCgpIG9yIGlkbGUgdGltZW91dCkuIE1ha2Ugc3VyZSB0aGF0J3NcclxuICAgICAgICAgICAgICAgICAgICAvLyBkZXNpcmFibGUuXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLnNob3VsZFN0YXJ0V2F0Y2hTdHJlYW0oKSwgJ1dhdGNoIHN0cmVhbSB3YXMgc3RvcHBlZCBncmFjZWZ1bGx5IHdoaWxlIHN0aWxsIG5lZWRlZC4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYW5VcFdhdGNoU3RyZWFtU3RhdGUoKTtcclxuICAgICAgICAgICAgICAgIC8vIElmIHdlIHN0aWxsIG5lZWQgdGhlIHdhdGNoIHN0cmVhbSwgcmV0cnkgdGhlIGNvbm5lY3Rpb24uXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaG91bGRTdGFydFdhdGNoU3RyZWFtKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5oYW5kbGVXYXRjaFN0cmVhbUZhaWx1cmUoZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRXYXRjaFN0cmVhbSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTm8gbmVlZCB0byByZXN0YXJ0IHdhdGNoIHN0cmVhbSBiZWNhdXNlIHRoZXJlIGFyZSBubyBhY3RpdmUgdGFyZ2V0cy5cclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgb25saW5lIHN0YXRlIGlzIHNldCB0byB1bmtub3duIGJlY2F1c2UgdGhlcmUgaXMgbm8gYWN0aXZlIGF0dGVtcHRcclxuICAgICAgICAgICAgICAgICAgICAvLyBhdCBlc3RhYmxpc2hpbmcgYSBjb25uZWN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuc2V0KE9ubGluZVN0YXRlLlVua25vd24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUub25XYXRjaFN0cmVhbUNoYW5nZSA9IGZ1bmN0aW9uICh3YXRjaENoYW5nZSwgc25hcHNob3RWZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgdGhlIGNsaWVudCBhcyBvbmxpbmUgc2luY2Ugd2UgZ290IGEgbWVzc2FnZSBmcm9tIHRoZSBzZXJ2ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuc2V0KE9ubGluZVN0YXRlLk9ubGluZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3YXRjaENoYW5nZSBpbnN0YW5jZW9mIFdhdGNoVGFyZ2V0Q2hhbmdlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXRjaENoYW5nZS5zdGF0ZSA9PT0gV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5SZW1vdmVkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXRjaENoYW5nZS5jYXVzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgd2FzIGFuIGVycm9yIG9uIGEgdGFyZ2V0LCBkb24ndCB3YWl0IGZvciBhIGNvbnNpc3RlbnQgc25hcHNob3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvIHJhaXNlIGV2ZW50c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuaGFuZGxlVGFyZ2V0RXJyb3Iod2F0Y2hDaGFuZ2UpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod2F0Y2hDaGFuZ2UgaW5zdGFuY2VvZiBEb2N1bWVudFdhdGNoQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvci5oYW5kbGVEb2N1bWVudENoYW5nZSh3YXRjaENoYW5nZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAod2F0Y2hDaGFuZ2UgaW5zdGFuY2VvZiBFeGlzdGVuY2VGaWx0ZXJDaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLmhhbmRsZUV4aXN0ZW5jZUZpbHRlcih3YXRjaENoYW5nZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQod2F0Y2hDaGFuZ2UgaW5zdGFuY2VvZiBXYXRjaFRhcmdldENoYW5nZSwgJ0V4cGVjdGVkIHdhdGNoQ2hhbmdlIHRvIGJlIGFuIGluc3RhbmNlIG9mIFdhdGNoVGFyZ2V0Q2hhbmdlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvci5oYW5kbGVUYXJnZXRDaGFuZ2Uod2F0Y2hDaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXNuYXBzaG90VmVyc2lvbi5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5NSU4pKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShzbmFwc2hvdFZlcnNpb24uY29tcGFyZVRvKGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24pID49IDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSByZWNlaXZlZCBhIHRhcmdldCBjaGFuZ2Ugd2l0aCBhIGdsb2JhbCBzbmFwc2hvdCBpZiB0aGUgc25hcHNob3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmVyc2lvbiBpcyBub3QgZXF1YWwgdG8gU25hcHNob3RWZXJzaW9uLk1JTi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yYWlzZVdhdGNoU25hcHNob3Qoc25hcHNob3RWZXJzaW9uKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHJlY2VpdmVkIGEgdGFyZ2V0IGNoYW5nZSB3aXRoIGEgZ2xvYmFsIHNuYXBzaG90IGlmIHRoZSBzbmFwc2hvdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB2ZXJzaW9uIGlzIG5vdCBlcXVhbCB0byBTbmFwc2hvdFZlcnNpb24uTUlOLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBUYWtlcyBhIGJhdGNoIG9mIGNoYW5nZXMgZnJvbSB0aGUgRGF0YXN0b3JlLCByZXBhY2thZ2VzIHRoZW0gYXMgYVxyXG4gICAgICogUmVtb3RlRXZlbnQsIGFuZCBwYXNzZXMgdGhhdCBvbiB0byB0aGUgbGlzdGVuZXIsIHdoaWNoIGlzIHR5cGljYWxseSB0aGVcclxuICAgICAqIFN5bmNFbmdpbmUuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5yYWlzZVdhdGNoU25hcHNob3QgPSBmdW5jdGlvbiAoc25hcHNob3RWZXJzaW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQoIXNuYXBzaG90VmVyc2lvbi5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5NSU4pLCBcIkNhbid0IHJhaXNlIGV2ZW50IGZvciB1bmtub3duIFNuYXBzaG90VmVyc2lvblwiKTtcclxuICAgICAgICB2YXIgcmVtb3RlRXZlbnQgPSB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvci5jcmVhdGVSZW1vdGVFdmVudChzbmFwc2hvdFZlcnNpb24pO1xyXG4gICAgICAgIC8vIFVwZGF0ZSBpbi1tZW1vcnkgcmVzdW1lIHRva2Vucy4gTG9jYWxTdG9yZSB3aWxsIHVwZGF0ZSB0aGVcclxuICAgICAgICAvLyBwZXJzaXN0ZW50IHZpZXcgb2YgdGhlc2Ugd2hlbiBhcHBseWluZyB0aGUgY29tcGxldGVkIFJlbW90ZUV2ZW50LlxyXG4gICAgICAgIGZvckVhY2hOdW1iZXIocmVtb3RlRXZlbnQudGFyZ2V0Q2hhbmdlcywgZnVuY3Rpb24gKHRhcmdldElkLCBjaGFuZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGNoYW5nZS5yZXN1bWVUb2tlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnlEYXRhID0gX3RoaXMubGlzdGVuVGFyZ2V0c1t0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXHJcbiAgICAgICAgICAgICAgICBpZiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubGlzdGVuVGFyZ2V0c1t0YXJnZXRJZF0gPSBxdWVyeURhdGEuY29weSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VtZVRva2VuOiBjaGFuZ2UucmVzdW1lVG9rZW4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNuYXBzaG90VmVyc2lvbjogc25hcHNob3RWZXJzaW9uXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBSZS1lc3RhYmxpc2ggbGlzdGVucyBmb3IgdGhlIHRhcmdldHMgdGhhdCBoYXZlIGJlZW4gaW52YWxpZGF0ZWQgYnlcclxuICAgICAgICAvLyBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoZXMuXHJcbiAgICAgICAgcmVtb3RlRXZlbnQudGFyZ2V0TWlzbWF0Y2hlcy5mb3JFYWNoKGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnlEYXRhID0gX3RoaXMubGlzdGVuVGFyZ2V0c1t0YXJnZXRJZF07XHJcbiAgICAgICAgICAgIGlmICghcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIHJlc3VtZSB0b2tlbiBmb3IgdGhlIHF1ZXJ5LCBzaW5jZSB3ZSdyZSBpbiBhIGtub3duIG1pc21hdGNoXHJcbiAgICAgICAgICAgIC8vIHN0YXRlLlxyXG4gICAgICAgICAgICBfdGhpcy5saXN0ZW5UYXJnZXRzW3RhcmdldElkXSA9IHF1ZXJ5RGF0YS5jb3B5KHtcclxuICAgICAgICAgICAgICAgIHJlc3VtZVRva2VuOiBlbXB0eUJ5dGVTdHJpbmcoKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8gQ2F1c2UgYSBoYXJkIHJlc2V0IGJ5IHVud2F0Y2hpbmcgYW5kIHJld2F0Y2hpbmcgaW1tZWRpYXRlbHksIGJ1dFxyXG4gICAgICAgICAgICAvLyBkZWxpYmVyYXRlbHkgZG9uJ3Qgc2VuZCBhIHJlc3VtZSB0b2tlbiBzbyB0aGF0IHdlIGdldCBhIGZ1bGwgdXBkYXRlLlxyXG4gICAgICAgICAgICBfdGhpcy5zZW5kVW53YXRjaFJlcXVlc3QodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAvLyBNYXJrIHRoZSBxdWVyeSB3ZSBzZW5kIGFzIGJlaW5nIG9uIGJlaGFsZiBvZiBhbiBleGlzdGVuY2UgZmlsdGVyXHJcbiAgICAgICAgICAgIC8vIG1pc21hdGNoLCBidXQgZG9uJ3QgYWN0dWFsbHkgcmV0YWluIHRoYXQgaW4gbGlzdGVuVGFyZ2V0cy4gVGhpcyBlbnN1cmVzXHJcbiAgICAgICAgICAgIC8vIHRoYXQgd2UgZmxhZyB0aGUgZmlyc3QgcmUtbGlzdGVuIHRoaXMgd2F5IHdpdGhvdXQgaW1wYWN0aW5nIGZ1dHVyZVxyXG4gICAgICAgICAgICAvLyBsaXN0ZW5zIG9mIHRoaXMgdGFyZ2V0ICh0aGF0IG1pZ2h0IGhhcHBlbiBlLmcuIG9uIHJlY29ubmVjdCkuXHJcbiAgICAgICAgICAgIHZhciByZXF1ZXN0UXVlcnlEYXRhID0gbmV3IFF1ZXJ5RGF0YShxdWVyeURhdGEucXVlcnksIHRhcmdldElkLCBRdWVyeVB1cnBvc2UuRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2gsIHF1ZXJ5RGF0YS5zZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgICAgIF90aGlzLnNlbmRXYXRjaFJlcXVlc3QocmVxdWVzdFF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gRmluYWxseSByYWlzZSByZW1vdGUgZXZlbnRcclxuICAgICAgICByZXR1cm4gdGhpcy5zeW5jRW5naW5lLmFwcGx5UmVtb3RlRXZlbnQocmVtb3RlRXZlbnQpO1xyXG4gICAgfTtcclxuICAgIC8qKiBIYW5kbGVzIGFuIGVycm9yIG9uIGEgdGFyZ2V0ICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuaGFuZGxlVGFyZ2V0RXJyb3IgPSBmdW5jdGlvbiAod2F0Y2hDaGFuZ2UpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCghIXdhdGNoQ2hhbmdlLmNhdXNlLCAnSGFuZGxpbmcgdGFyZ2V0IGVycm9yIHdpdGhvdXQgYSBjYXVzZScpO1xyXG4gICAgICAgIHZhciBlcnJvciQkMSA9IHdhdGNoQ2hhbmdlLmNhdXNlO1xyXG4gICAgICAgIHZhciBwcm9taXNlQ2hhaW4gPSBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICB3YXRjaENoYW5nZS50YXJnZXRJZHMuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgcHJvbWlzZUNoYWluID0gcHJvbWlzZUNoYWluLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5zKHRoaXMubGlzdGVuVGFyZ2V0cywgdGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlblRhcmdldHNbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvci5yZW1vdmVUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5zeW5jRW5naW5lLnJlamVjdExpc3Rlbih0YXJnZXRJZCwgZXJyb3IkJDEpXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcHJvbWlzZUNoYWluO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQXR0ZW1wdHMgdG8gZmlsbCBvdXIgd3JpdGUgcGlwZWxpbmUgd2l0aCB3cml0ZXMgZnJvbSB0aGUgTG9jYWxTdG9yZS5cclxuICAgICAqXHJcbiAgICAgKiBDYWxsZWQgaW50ZXJuYWxseSB0byBib290c3RyYXAgb3IgcmVmaWxsIHRoZSB3cml0ZSBwaXBlbGluZSBhbmQgYnlcclxuICAgICAqIFN5bmNFbmdpbmUgd2hlbmV2ZXIgdGhlcmUgYXJlIG5ldyBtdXRhdGlvbnMgdG8gcHJvY2Vzcy5cclxuICAgICAqXHJcbiAgICAgKiBTdGFydHMgdGhlIHdyaXRlIHN0cmVhbSBpZiBuZWNlc3NhcnkuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5maWxsV3JpdGVQaXBlbGluZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGxhc3RCYXRjaElkUmV0cmlldmVkLCBiYXRjaDtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FuQWRkVG9Xcml0ZVBpcGVsaW5lKCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0QmF0Y2hJZFJldHJpZXZlZCA9IHRoaXMud3JpdGVQaXBlbGluZS5sZW5ndGggPiAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMud3JpdGVQaXBlbGluZVt0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoIC0gMV0uYmF0Y2hJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBCQVRDSElEX1VOS05PV047XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5uZXh0TXV0YXRpb25CYXRjaChsYXN0QmF0Y2hJZFJldHJpZXZlZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2ggPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGJhdGNoID09PSBudWxsKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndyaXRlU3RyZWFtLm1hcmtJZGxlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFRvV3JpdGVQaXBlbGluZShiYXRjaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZmlsbFdyaXRlUGlwZWxpbmUoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNDtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNob3VsZFN0YXJ0V3JpdGVTdHJlYW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydFdyaXRlU3RyZWFtKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB3ZSBjYW4gYWRkIHRvIHRoZSB3cml0ZSBwaXBlbGluZSAoaS5lLiB0aGUgbmV0d29yayBpc1xyXG4gICAgICogZW5hYmxlZCBhbmQgdGhlIHdyaXRlIHBpcGVsaW5lIGlzIG5vdCBmdWxsKS5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmNhbkFkZFRvV3JpdGVQaXBlbGluZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuY2FuVXNlTmV0d29yaygpICYmIHRoaXMud3JpdGVQaXBlbGluZS5sZW5ndGggPCBNQVhfUEVORElOR19XUklURVMpO1xyXG4gICAgfTtcclxuICAgIC8vIEZvciB0ZXN0aW5nXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUub3V0c3RhbmRpbmdXcml0ZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVQaXBlbGluZS5sZW5ndGg7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBRdWV1ZXMgYWRkaXRpb25hbCB3cml0ZXMgdG8gYmUgc2VudCB0byB0aGUgd3JpdGUgc3RyZWFtLCBzZW5kaW5nIHRoZW1cclxuICAgICAqIGltbWVkaWF0ZWx5IGlmIHRoZSB3cml0ZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5hZGRUb1dyaXRlUGlwZWxpbmUgPSBmdW5jdGlvbiAoYmF0Y2gpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5jYW5BZGRUb1dyaXRlUGlwZWxpbmUoKSwgJ2FkZFRvV3JpdGVQaXBlbGluZSBjYWxsZWQgd2hlbiBwaXBlbGluZSBpcyBmdWxsJyk7XHJcbiAgICAgICAgdGhpcy53cml0ZVBpcGVsaW5lLnB1c2goYmF0Y2gpO1xyXG4gICAgICAgIGlmICh0aGlzLndyaXRlU3RyZWFtLmlzT3BlbigpICYmIHRoaXMud3JpdGVTdHJlYW0uaGFuZHNoYWtlQ29tcGxldGUpIHtcclxuICAgICAgICAgICAgdGhpcy53cml0ZVN0cmVhbS53cml0ZU11dGF0aW9ucyhiYXRjaC5tdXRhdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuc2hvdWxkU3RhcnRXcml0ZVN0cmVhbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuY2FuVXNlTmV0d29yaygpICYmXHJcbiAgICAgICAgICAgICF0aGlzLndyaXRlU3RyZWFtLmlzU3RhcnRlZCgpICYmXHJcbiAgICAgICAgICAgIHRoaXMud3JpdGVQaXBlbGluZS5sZW5ndGggPiAwKTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuc3RhcnRXcml0ZVN0cmVhbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5zaG91bGRTdGFydFdyaXRlU3RyZWFtKCksICdzdGFydFdyaXRlU3RyZWFtKCkgY2FsbGVkIHdoZW4gc2hvdWxkU3RhcnRXcml0ZVN0cmVhbSgpIGlzIGZhbHNlLicpO1xyXG4gICAgICAgIHRoaXMud3JpdGVTdHJlYW0uc3RhcnQoKTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUub25Xcml0ZVN0cmVhbU9wZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy53cml0ZVN0cmVhbS53cml0ZUhhbmRzaGFrZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUub25Xcml0ZUhhbmRzaGFrZUNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gUmVjb3JkIHRoZSBzdHJlYW0gdG9rZW4uXHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAuc2V0TGFzdFN0cmVhbVRva2VuKHRoaXMud3JpdGVTdHJlYW0ubGFzdFN0cmVhbVRva2VuKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIFNlbmQgdGhlIHdyaXRlIHBpcGVsaW5lIG5vdyB0aGF0IHRoZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQuXHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBfdGhpcy53cml0ZVBpcGVsaW5lOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJhdGNoID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMud3JpdGVTdHJlYW0ud3JpdGVNdXRhdGlvbnMoYmF0Y2gubXV0YXRpb25zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBfdGhpcy5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZXJyKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBWZXJpZmllcyB0aGUgZXJyb3IgdGhyb3duIGJ5IGFuIExvY2FsU3RvcmUgb3BlcmF0aW9uLiBJZiBhIExvY2FsU3RvcmVcclxuICAgICAqIG9wZXJhdGlvbiBmYWlscyBiZWNhdXNlIHRoZSBwcmltYXJ5IGxlYXNlIGhhcyBiZWVuIHRha2VuIGJ5IGFub3RoZXIgY2xpZW50LFxyXG4gICAgICogd2UgaWdub3JlIHRoZSBlcnJvci4gQWxsIG90aGVyIGVycm9ycyBhcmUgcmUtdGhyb3duLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBlcnIgQW4gZXJyb3IgcmV0dXJuZWQgYnkgYSBMb2NhbFN0b3JlIG9wZXJhdGlvbi5cclxuICAgICAqIEByZXR1cm4gQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgYWZ0ZXIgd2UgcmVjb3ZlcmVkLCBvciB0aGUgb3JpZ2luYWwgZXJyb3IuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgaWYgKGlzUHJpbWFyeUxlYXNlTG9zdEVycm9yKGVycikpIHtcclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ4LCAnVW5leHBlY3RlZGx5IGxvc3QgcHJpbWFyeSBsZWFzZScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUub25NdXRhdGlvblJlc3VsdCA9IGZ1bmN0aW9uIChjb21taXRWZXJzaW9uLCByZXN1bHRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBUaGlzIGlzIGEgcmVzcG9uc2UgdG8gYSB3cml0ZSBjb250YWluaW5nIG11dGF0aW9ucyBhbmQgc2hvdWxkIGJlXHJcbiAgICAgICAgLy8gY29ycmVsYXRlZCB0byB0aGUgZmlyc3Qgd3JpdGUgaW4gb3VyIHdyaXRlIHBpcGVsaW5lLlxyXG4gICAgICAgIGFzc2VydCh0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoID4gMCwgJ0dvdCByZXN1bHQgZm9yIGVtcHR5IHdyaXRlIHBpcGVsaW5lJyk7XHJcbiAgICAgICAgdmFyIGJhdGNoID0gdGhpcy53cml0ZVBpcGVsaW5lLnNoaWZ0KCk7XHJcbiAgICAgICAgdmFyIHN1Y2Nlc3MgPSBNdXRhdGlvbkJhdGNoUmVzdWx0LmZyb20oYmF0Y2gsIGNvbW1pdFZlcnNpb24sIHJlc3VsdHMsIHRoaXMud3JpdGVTdHJlYW0ubGFzdFN0cmVhbVRva2VuKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zeW5jRW5naW5lLmFwcGx5U3VjY2Vzc2Z1bFdyaXRlKHN1Y2Nlc3MpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgd2l0aCB0aGUgY29tcGxldGlvbiBvZiB0aGlzIG11dGF0aW9uIGFub3RoZXJcclxuICAgICAgICAgICAgLy8gc2xvdCBoYXMgZnJlZWQgdXAuXHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5maWxsV3JpdGVQaXBlbGluZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5vbldyaXRlU3RyZWFtQ2xvc2UgPSBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGVycm9ySGFuZGxpbmc7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yJCQxID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBHcmFjZWZ1bCBzdG9wIChkdWUgdG8gc3RvcCgpIG9yIGlkbGUgdGltZW91dCkuIE1ha2Ugc3VyZSB0aGF0J3NcclxuICAgICAgICAgICAgICAgICAgICAvLyBkZXNpcmFibGUuXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLnNob3VsZFN0YXJ0V3JpdGVTdHJlYW0oKSwgJ1dyaXRlIHN0cmVhbSB3YXMgc3RvcHBlZCBncmFjZWZ1bGx5IHdoaWxlIHN0aWxsIG5lZWRlZC4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSB3cml0ZSBzdHJlYW0gY2xvc2VkIGR1ZSB0byBhbiBlcnJvciwgaW52b2tlIHRoZSBlcnJvciBjYWxsYmFja3MgaWZcclxuICAgICAgICAgICAgICAgIC8vIHRoZXJlIGFyZSBwZW5kaW5nIHdyaXRlcy5cclxuICAgICAgICAgICAgICAgIGlmIChlcnJvciQkMSAmJiB0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9ySGFuZGxpbmcgPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud3JpdGVTdHJlYW0uaGFuZHNoYWtlQ29tcGxldGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBlcnJvciBhZmZlY3RzIHRoZSBhY3R1YWwgd3JpdGUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ySGFuZGxpbmcgPSB0aGlzLmhhbmRsZVdyaXRlRXJyb3IoZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgd2FzIGFuIGVycm9yIGJlZm9yZSB0aGUgaGFuZHNoYWtlIGhhcyBmaW5pc2hlZCwgaXQnc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3NzaWJsZSB0aGF0IHRoZSBzZXJ2ZXIgaXMgdW5hYmxlIHRvIHByb2Nlc3MgdGhlIHN0cmVhbSB0b2tlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSdyZSBzZW5kaW5nLiAoUGVyaGFwcyBpdCdzIHRvbyBvbGQ/KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvckhhbmRsaW5nID0gdGhpcy5oYW5kbGVIYW5kc2hha2VFcnJvcihlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBlcnJvckhhbmRsaW5nLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHdyaXRlIHN0cmVhbSBtaWdodCBoYXZlIGJlZW4gc3RhcnRlZCBieSByZWZpbGxpbmcgdGhlIHdyaXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwaXBlbGluZSBmb3IgZmFpbGVkIHdyaXRlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnNob3VsZFN0YXJ0V3JpdGVTdHJlYW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnN0YXJ0V3JpdGVTdHJlYW0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuaGFuZGxlSGFuZHNoYWtlRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZXNldCB0aGUgdG9rZW4gaWYgaXQncyBhIHBlcm1hbmVudCBlcnJvciBvciB0aGUgZXJyb3IgY29kZSBpc1xyXG4gICAgICAgICAgICAgICAgLy8gQUJPUlRFRCwgc2lnbmFsaW5nIHRoZSB3cml0ZSBzdHJlYW0gaXMgbm8gbG9uZ2VyIHZhbGlkLlxyXG4gICAgICAgICAgICAgICAgaWYgKGlzUGVybWFuZW50RXJyb3IoZXJyb3IkJDEuY29kZSkgfHwgZXJyb3IkJDEuY29kZSA9PT0gQ29kZS5BQk9SVEVEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ4LCAnUmVtb3RlU3RvcmUgZXJyb3IgYmVmb3JlIGNvbXBsZXRlZCBoYW5kc2hha2U7IHJlc2V0dGluZyBzdHJlYW0gdG9rZW46ICcsIHRoaXMud3JpdGVTdHJlYW0ubGFzdFN0cmVhbVRva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndyaXRlU3RyZWFtLmxhc3RTdHJlYW1Ub2tlbiA9IGVtcHR5Qnl0ZVN0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRMYXN0U3RyZWFtVG9rZW4oZW1wdHlCeXRlU3RyaW5nKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX3RoaXMuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGVycik7IH0pXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFNvbWUgb3RoZXIgZXJyb3IsIGRvbid0IHJlc2V0IHN0cmVhbSB0b2tlbi4gT3VyIHN0cmVhbSBsb2dpYyB3aWxsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8ganVzdCByZXRyeSB3aXRoIGV4cG9uZW50aWFsIGJhY2tvZmYuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5oYW5kbGVXcml0ZUVycm9yID0gZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBiYXRjaDtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNQZXJtYW5lbnRFcnJvcihlcnJvciQkMS5jb2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJhdGNoID0gdGhpcy53cml0ZVBpcGVsaW5lLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSW4gdGhpcyBjYXNlIGl0J3MgYWxzbyB1bmxpa2VseSB0aGF0IHRoZSBzZXJ2ZXIgaXRzZWxmIGlzIG1lbHRpbmdcclxuICAgICAgICAgICAgICAgICAgICAvLyBkb3duIC0tIHRoaXMgd2FzIGp1c3QgYSBiYWQgcmVxdWVzdCBzbyBpbmhpYml0IGJhY2tvZmYgb24gdGhlIG5leHRcclxuICAgICAgICAgICAgICAgICAgICAvLyByZXN0YXJ0LlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGVTdHJlYW0uaW5oaWJpdEJhY2tvZmYoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5zeW5jRW5naW5lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVqZWN0RmFpbGVkV3JpdGUoYmF0Y2guYmF0Y2hJZCwgZXJyb3IkJDEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgd2l0aCB0aGUgY29tcGxldGlvbiBvZiB0aGlzIG11dGF0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbm90aGVyIHNsb3QgaGFzIGZyZWVkIHVwLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmZpbGxXcml0ZVBpcGVsaW5lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyYW5zaWVudCBlcnJvciwganVzdCBsZXQgdGhlIHJldHJ5IGxvZ2ljIGtpY2sgaW4uXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5jcmVhdGVUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uKHRoaXMuZGF0YXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuaGFuZGxlQ3JlZGVudGlhbENoYW5nZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FuVXNlTmV0d29yaygpKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGVhciBkb3duIGFuZCByZS1jcmVhdGUgb3VyIG5ldHdvcmsgc3RyZWFtcy4gVGhpcyB3aWxsIGVuc3VyZSB3ZSBnZXQgYSBmcmVzaCBhdXRoIHRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciB0aGUgbmV3IHVzZXIgYW5kIHJlLWZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIHdpdGggbmV3IG11dGF0aW9ucyBmcm9tIHRoZSBMb2NhbFN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIChzaW5jZSBtdXRhdGlvbnMgYXJlIHBlci11c2VyKS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ4LCAnUmVtb3RlU3RvcmUgcmVzdGFydGluZyBzdHJlYW1zIGZvciBuZXcgY3JlZGVudGlhbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ldHdvcmtFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZGlzYWJsZU5ldHdvcmtJbnRlcm5hbCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuc2V0KE9ubGluZVN0YXRlLlVua25vd24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVuYWJsZU5ldHdvcmsoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBUb2dnbGVzIHRoZSBuZXR3b3JrIHN0YXRlIHdoZW4gdGhlIGNsaWVudCBnYWlucyBvciBsb3NlcyBpdHMgcHJpbWFyeSBsZWFzZS5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmFwcGx5UHJpbWFyeVN0YXRlID0gZnVuY3Rpb24gKGlzUHJpbWFyeSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNQcmltYXJ5ID0gaXNQcmltYXJ5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpc1ByaW1hcnkgJiYgdGhpcy5uZXR3b3JrRW5hYmxlZCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVuYWJsZU5ldHdvcmsoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhaXNQcmltYXJ5KSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5kaXNhYmxlTmV0d29ya0ludGVybmFsKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5zZXQoT25saW5lU3RhdGUuVW5rbm93bik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNDtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlbW90ZVN0b3JlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEhvbGRzIHRoZSBsaXN0ZW5lcnMgYW5kIHRoZSBsYXN0IHJlY2VpdmVkIFZpZXdTbmFwc2hvdCBmb3IgYSBxdWVyeSBiZWluZ1xyXG4gKiB0cmFja2VkIGJ5IEV2ZW50TWFuYWdlci5cclxuICovXHJcbnZhciBRdWVyeUxpc3RlbmVyc0luZm8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBRdWVyeUxpc3RlbmVyc0luZm8oKSB7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSBbXTtcclxuICAgIH1cclxuICAgIHJldHVybiBRdWVyeUxpc3RlbmVyc0luZm87XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBFdmVudE1hbmFnZXIgaXMgcmVzcG9uc2libGUgZm9yIG1hcHBpbmcgcXVlcmllcyB0byBxdWVyeSBldmVudCBlbWl0dGVycy5cclxuICogSXQgaGFuZGxlcyBcImZhbi1vdXRcIi4gLS0gSWRlbnRpY2FsIHF1ZXJpZXMgd2lsbCByZS11c2UgdGhlIHNhbWUgd2F0Y2ggb24gdGhlXHJcbiAqIGJhY2tlbmQuXHJcbiAqL1xyXG52YXIgRXZlbnRNYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRXZlbnRNYW5hZ2VyKHN5bmNFbmdpbmUpIHtcclxuICAgICAgICB0aGlzLnN5bmNFbmdpbmUgPSBzeW5jRW5naW5lO1xyXG4gICAgICAgIHRoaXMucXVlcmllcyA9IG5ldyBPYmplY3RNYXAoZnVuY3Rpb24gKHEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHEuY2Fub25pY2FsSWQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gT25saW5lU3RhdGUuVW5rbm93bjtcclxuICAgICAgICB0aGlzLnN5bmNFbmdpbmUuc3Vic2NyaWJlKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgRXZlbnRNYW5hZ2VyLnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcclxuICAgICAgICB2YXIgcXVlcnkgPSBsaXN0ZW5lci5xdWVyeTtcclxuICAgICAgICB2YXIgZmlyc3RMaXN0ZW4gPSBmYWxzZTtcclxuICAgICAgICB2YXIgcXVlcnlJbmZvID0gdGhpcy5xdWVyaWVzLmdldChxdWVyeSk7XHJcbiAgICAgICAgaWYgKCFxdWVyeUluZm8pIHtcclxuICAgICAgICAgICAgZmlyc3RMaXN0ZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICBxdWVyeUluZm8gPSBuZXcgUXVlcnlMaXN0ZW5lcnNJbmZvKCk7XHJcbiAgICAgICAgICAgIHRoaXMucXVlcmllcy5zZXQocXVlcnksIHF1ZXJ5SW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHF1ZXJ5SW5mby5saXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XHJcbiAgICAgICAgbGlzdGVuZXIuYXBwbHlPbmxpbmVTdGF0ZUNoYW5nZSh0aGlzLm9ubGluZVN0YXRlKTtcclxuICAgICAgICBpZiAocXVlcnlJbmZvLnZpZXdTbmFwKVxyXG4gICAgICAgICAgICBsaXN0ZW5lci5vblZpZXdTbmFwc2hvdChxdWVyeUluZm8udmlld1NuYXApO1xyXG4gICAgICAgIGlmIChmaXJzdExpc3Rlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zeW5jRW5naW5lLmxpc3RlbihxdWVyeSkudGhlbihmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgICAgIHF1ZXJ5SW5mby50YXJnZXRJZCA9IHRhcmdldElkO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldElkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocXVlcnlJbmZvLnRhcmdldElkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRXZlbnRNYW5hZ2VyLnByb3RvdHlwZS51bmxpc3RlbiA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnksIGxhc3RMaXN0ZW4sIHF1ZXJ5SW5mbywgaTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeSA9IGxpc3RlbmVyLnF1ZXJ5O1xyXG4gICAgICAgICAgICAgICAgbGFzdExpc3RlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgcXVlcnlJbmZvID0gdGhpcy5xdWVyaWVzLmdldChxdWVyeSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocXVlcnlJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IHF1ZXJ5SW5mby5saXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeUluZm8ubGlzdGVuZXJzLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdExpc3RlbiA9IHF1ZXJ5SW5mby5saXN0ZW5lcnMubGVuZ3RoID09PSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChsYXN0TGlzdGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyaWVzLmRlbGV0ZShxdWVyeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuc3luY0VuZ2luZS51bmxpc3RlbihxdWVyeSldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBFdmVudE1hbmFnZXIucHJvdG90eXBlLm9uV2F0Y2hDaGFuZ2UgPSBmdW5jdGlvbiAodmlld1NuYXBzKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCB2aWV3U25hcHNfMSA9IHZpZXdTbmFwczsgX2kgPCB2aWV3U25hcHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHZpZXdTbmFwID0gdmlld1NuYXBzXzFbX2ldO1xyXG4gICAgICAgICAgICB2YXIgcXVlcnkgPSB2aWV3U25hcC5xdWVyeTtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5SW5mbyA9IHRoaXMucXVlcmllcy5nZXQocXVlcnkpO1xyXG4gICAgICAgICAgICBpZiAocXVlcnlJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIF9iID0gcXVlcnlJbmZvLmxpc3RlbmVyczsgX2EgPCBfYi5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfYltfYV07XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXIub25WaWV3U25hcHNob3Qodmlld1NuYXApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcXVlcnlJbmZvLnZpZXdTbmFwID0gdmlld1NuYXA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRXZlbnRNYW5hZ2VyLnByb3RvdHlwZS5vbldhdGNoRXJyb3IgPSBmdW5jdGlvbiAocXVlcnksIGVycm9yKSB7XHJcbiAgICAgICAgdmFyIHF1ZXJ5SW5mbyA9IHRoaXMucXVlcmllcy5nZXQocXVlcnkpO1xyXG4gICAgICAgIGlmIChxdWVyeUluZm8pIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHF1ZXJ5SW5mby5saXN0ZW5lcnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lci5vbkVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBSZW1vdmUgYWxsIGxpc3RlbmVycy4gTk9URTogV2UgZG9uJ3QgbmVlZCB0byBjYWxsIHN5bmNFbmdpbmUudW5saXN0ZW4oKVxyXG4gICAgICAgIC8vIGFmdGVyIGFuIGVycm9yLlxyXG4gICAgICAgIHRoaXMucXVlcmllcy5kZWxldGUocXVlcnkpO1xyXG4gICAgfTtcclxuICAgIEV2ZW50TWFuYWdlci5wcm90b3R5cGUub25PbmxpbmVTdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGUgPSBvbmxpbmVTdGF0ZTtcclxuICAgICAgICB0aGlzLnF1ZXJpZXMuZm9yRWFjaChmdW5jdGlvbiAoXywgcXVlcnlJbmZvKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBxdWVyeUluZm8ubGlzdGVuZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgbGlzdGVuZXIuYXBwbHlPbmxpbmVTdGF0ZUNoYW5nZShvbmxpbmVTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRXZlbnRNYW5hZ2VyO1xyXG59KCkpO1xyXG4vKipcclxuICogUXVlcnlMaXN0ZW5lciB0YWtlcyBhIHNlcmllcyBvZiBpbnRlcm5hbCB2aWV3IHNuYXBzaG90cyBhbmQgZGV0ZXJtaW5lc1xyXG4gKiB3aGVuIHRvIHJhaXNlIHRoZSBldmVudC5cclxuICpcclxuICogSXQgdXNlcyBhbiBPYnNlcnZlciB0byBkaXNwYXRjaCBldmVudHMuXHJcbiAqL1xyXG52YXIgUXVlcnlMaXN0ZW5lciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5TGlzdGVuZXIocXVlcnksIHF1ZXJ5T2JzZXJ2ZXIsIG9wdGlvbnMpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XHJcbiAgICAgICAgdGhpcy5xdWVyeU9ic2VydmVyID0gcXVlcnlPYnNlcnZlcjtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBJbml0aWFsIHNuYXBzaG90cyAoZS5nLiBmcm9tIGNhY2hlKSBtYXkgbm90IGJlIHByb3BhZ2F0ZWQgdG8gdGhlIHdyYXBwZWRcclxuICAgICAgICAgKiBvYnNlcnZlci4gVGhpcyBmbGFnIGlzIHNldCB0byB0cnVlIG9uY2Ugd2UndmUgYWN0dWFsbHkgcmFpc2VkIGFuIGV2ZW50LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucmFpc2VkSW5pdGlhbEV2ZW50ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZSA9IE9ubGluZVN0YXRlLlVua25vd247XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgIH1cclxuICAgIFF1ZXJ5TGlzdGVuZXIucHJvdG90eXBlLm9uVmlld1NuYXBzaG90ID0gZnVuY3Rpb24gKHNuYXApIHtcclxuICAgICAgICBhc3NlcnQoc25hcC5kb2NDaGFuZ2VzLmxlbmd0aCA+IDAgfHwgc25hcC5zeW5jU3RhdGVDaGFuZ2VkLCAnV2UgZ290IGEgbmV3IHNuYXBzaG90IHdpdGggbm8gY2hhbmdlcz8nKTtcclxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgbWV0YWRhdGEgb25seSBjaGFuZ2VzLlxyXG4gICAgICAgICAgICB2YXIgZG9jQ2hhbmdlcyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gc25hcC5kb2NDaGFuZ2VzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRvY0NoYW5nZSA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIGlmIChkb2NDaGFuZ2UudHlwZSAhPT0gQ2hhbmdlVHlwZS5NZXRhZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY0NoYW5nZXMucHVzaChkb2NDaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNuYXAgPSBuZXcgVmlld1NuYXBzaG90KHNuYXAucXVlcnksIHNuYXAuZG9jcywgc25hcC5vbGREb2NzLCBkb2NDaGFuZ2VzLCBzbmFwLm11dGF0ZWRLZXlzLCBzbmFwLmZyb21DYWNoZSwgc25hcC5zeW5jU3RhdGVDaGFuZ2VkLCBcclxuICAgICAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMucmFpc2VkSW5pdGlhbEV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNob3VsZFJhaXNlSW5pdGlhbEV2ZW50KHNuYXAsIHRoaXMub25saW5lU3RhdGUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJhaXNlSW5pdGlhbEV2ZW50KHNuYXApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMuc2hvdWxkUmFpc2VFdmVudChzbmFwKSkge1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5T2JzZXJ2ZXIubmV4dChzbmFwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zbmFwID0gc25hcDtcclxuICAgIH07XHJcbiAgICBRdWVyeUxpc3RlbmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeU9ic2VydmVyLmVycm9yKGVycm9yKTtcclxuICAgIH07XHJcbiAgICBRdWVyeUxpc3RlbmVyLnByb3RvdHlwZS5hcHBseU9ubGluZVN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZSA9IG9ubGluZVN0YXRlO1xyXG4gICAgICAgIGlmICh0aGlzLnNuYXAgJiZcclxuICAgICAgICAgICAgIXRoaXMucmFpc2VkSW5pdGlhbEV2ZW50ICYmXHJcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkUmFpc2VJbml0aWFsRXZlbnQodGhpcy5zbmFwLCBvbmxpbmVTdGF0ZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5yYWlzZUluaXRpYWxFdmVudCh0aGlzLnNuYXApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBRdWVyeUxpc3RlbmVyLnByb3RvdHlwZS5zaG91bGRSYWlzZUluaXRpYWxFdmVudCA9IGZ1bmN0aW9uIChzbmFwLCBvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5yYWlzZWRJbml0aWFsRXZlbnQsICdEZXRlcm1pbmluZyB3aGV0aGVyIHRvIHJhaXNlIGZpcnN0IGV2ZW50IGJ1dCBhbHJlYWR5IGhhZCBmaXJzdCBldmVudCcpO1xyXG4gICAgICAgIC8vIEFsd2F5cyByYWlzZSB0aGUgZmlyc3QgZXZlbnQgd2hlbiB3ZSdyZSBzeW5jZWRcclxuICAgICAgICBpZiAoIXNuYXAuZnJvbUNhY2hlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBOT1RFOiBXZSBjb25zaWRlciBPbmxpbmVTdGF0ZS5Vbmtub3duIGFzIG9ubGluZSAoaXQgc2hvdWxkIGJlY29tZSBPZmZsaW5lXHJcbiAgICAgICAgLy8gb3IgT25saW5lIGlmIHdlIHdhaXQgbG9uZyBlbm91Z2gpLlxyXG4gICAgICAgIHZhciBtYXliZU9ubGluZSA9IG9ubGluZVN0YXRlICE9PSBPbmxpbmVTdGF0ZS5PZmZsaW5lO1xyXG4gICAgICAgIC8vIERvbid0IHJhaXNlIHRoZSBldmVudCBpZiB3ZSdyZSBvbmxpbmUsIGFyZW4ndCBzeW5jZWQgeWV0IChjaGVja2VkXHJcbiAgICAgICAgLy8gYWJvdmUpIGFuZCBhcmUgd2FpdGluZyBmb3IgYSBzeW5jLlxyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMud2FpdEZvclN5bmNXaGVuT25saW5lICYmIG1heWJlT25saW5lKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChzbmFwLmZyb21DYWNoZSwgJ1dhaXRpbmcgZm9yIHN5bmMsIGJ1dCBzbmFwc2hvdCBpcyBub3QgZnJvbSBjYWNoZScpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFJhaXNlIGRhdGEgZnJvbSBjYWNoZSBpZiB3ZSBoYXZlIGFueSBkb2N1bWVudHMgb3Igd2UgYXJlIG9mZmxpbmVcclxuICAgICAgICByZXR1cm4gIXNuYXAuZG9jcy5pc0VtcHR5KCkgfHwgb25saW5lU3RhdGUgPT09IE9ubGluZVN0YXRlLk9mZmxpbmU7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlMaXN0ZW5lci5wcm90b3R5cGUuc2hvdWxkUmFpc2VFdmVudCA9IGZ1bmN0aW9uIChzbmFwKSB7XHJcbiAgICAgICAgLy8gV2UgZG9uJ3QgbmVlZCB0byBoYW5kbGUgaW5jbHVkZURvY3VtZW50TWV0YWRhdGFDaGFuZ2VzIGhlcmUgYmVjYXVzZVxyXG4gICAgICAgIC8vIHRoZSBNZXRhZGF0YSBvbmx5IGNoYW5nZXMgaGF2ZSBhbHJlYWR5IGJlZW4gc3RyaXBwZWQgb3V0IGlmIG5lZWRlZC5cclxuICAgICAgICAvLyBBdCB0aGlzIHBvaW50IHRoZSBvbmx5IGNoYW5nZXMgd2Ugd2lsbCBzZWUgYXJlIHRoZSBvbmVzIHdlIHNob3VsZFxyXG4gICAgICAgIC8vIHByb3BhZ2F0ZS5cclxuICAgICAgICBpZiAoc25hcC5kb2NDaGFuZ2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBoYXNQZW5kaW5nV3JpdGVzQ2hhbmdlZCA9IHRoaXMuc25hcCAmJiB0aGlzLnNuYXAuaGFzUGVuZGluZ1dyaXRlcyAhPT0gc25hcC5oYXNQZW5kaW5nV3JpdGVzO1xyXG4gICAgICAgIGlmIChzbmFwLnN5bmNTdGF0ZUNoYW5nZWQgfHwgaGFzUGVuZGluZ1dyaXRlc0NoYW5nZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzID09PSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBHZW5lcmFsbHkgd2Ugc2hvdWxkIGhhdmUgaGl0IG9uZSBvZiB0aGUgY2FzZXMgYWJvdmUsIGJ1dCBpdCdzIHBvc3NpYmxlXHJcbiAgICAgICAgLy8gdG8gZ2V0IGhlcmUgaWYgdGhlcmUgd2VyZSBvbmx5IG1ldGFkYXRhIGRvY0NoYW5nZXMgYW5kIHRoZXkgZ290XHJcbiAgICAgICAgLy8gc3RyaXBwZWQgb3V0LlxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBRdWVyeUxpc3RlbmVyLnByb3RvdHlwZS5yYWlzZUluaXRpYWxFdmVudCA9IGZ1bmN0aW9uIChzbmFwKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLnJhaXNlZEluaXRpYWxFdmVudCwgJ1RyeWluZyB0byByYWlzZSBpbml0aWFsIGV2ZW50cyBmb3Igc2Vjb25kIHRpbWUnKTtcclxuICAgICAgICBzbmFwID0gVmlld1NuYXBzaG90LmZyb21Jbml0aWFsRG9jdW1lbnRzKHNuYXAucXVlcnksIHNuYXAuZG9jcywgc25hcC5tdXRhdGVkS2V5cywgc25hcC5mcm9tQ2FjaGUpO1xyXG4gICAgICAgIHRoaXMucmFpc2VkSW5pdGlhbEV2ZW50ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnF1ZXJ5T2JzZXJ2ZXIubmV4dChzbmFwKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUXVlcnlMaXN0ZW5lcjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBIHNldCBvZiBjaGFuZ2VzIHRvIHdoYXQgZG9jdW1lbnRzIGFyZSBjdXJyZW50bHkgaW4gdmlldyBhbmQgb3V0IG9mIHZpZXcgZm9yXHJcbiAqIGEgZ2l2ZW4gcXVlcnkuIFRoZXNlIGNoYW5nZXMgYXJlIHNlbnQgdG8gdGhlIExvY2FsU3RvcmUgYnkgdGhlIFZpZXcgKHZpYVxyXG4gKiB0aGUgU3luY0VuZ2luZSkgYW5kIGFyZSB1c2VkIHRvIHBpbiAvIHVucGluIGRvY3VtZW50cyBhcyBhcHByb3ByaWF0ZS5cclxuICovXHJcbnZhciBMb2NhbFZpZXdDaGFuZ2VzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTG9jYWxWaWV3Q2hhbmdlcyh0YXJnZXRJZCwgYWRkZWRLZXlzLCByZW1vdmVkS2V5cykge1xyXG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0YXJnZXRJZDtcclxuICAgICAgICB0aGlzLmFkZGVkS2V5cyA9IGFkZGVkS2V5cztcclxuICAgICAgICB0aGlzLnJlbW92ZWRLZXlzID0gcmVtb3ZlZEtleXM7XHJcbiAgICB9XHJcbiAgICBMb2NhbFZpZXdDaGFuZ2VzLmZyb21TbmFwc2hvdCA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgdmlld1NuYXBzaG90KSB7XHJcbiAgICAgICAgdmFyIGFkZGVkS2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdmFyIHJlbW92ZWRLZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdmlld1NuYXBzaG90LmRvY0NoYW5nZXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBkb2NDaGFuZ2UgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZG9jQ2hhbmdlLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5BZGRlZDpcclxuICAgICAgICAgICAgICAgICAgICBhZGRlZEtleXMgPSBhZGRlZEtleXMuYWRkKGRvY0NoYW5nZS5kb2Mua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5SZW1vdmVkOlxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZWRLZXlzID0gcmVtb3ZlZEtleXMuYWRkKGRvY0NoYW5nZS5kb2Mua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAvLyBkbyBub3RoaW5nXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBMb2NhbFZpZXdDaGFuZ2VzKHRhcmdldElkLCBhZGRlZEtleXMsIHJlbW92ZWRLZXlzKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTG9jYWxWaWV3Q2hhbmdlcztcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBBZGRlZExpbWJvRG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBZGRlZExpbWJvRG9jdW1lbnQoa2V5KSB7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gQWRkZWRMaW1ib0RvY3VtZW50O1xyXG59KCkpO1xyXG52YXIgUmVtb3ZlZExpbWJvRG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZW1vdmVkTGltYm9Eb2N1bWVudChrZXkpIHtcclxuICAgICAgICB0aGlzLmtleSA9IGtleTtcclxuICAgIH1cclxuICAgIHJldHVybiBSZW1vdmVkTGltYm9Eb2N1bWVudDtcclxufSgpKTtcclxuLyoqXHJcbiAqIFZpZXcgaXMgcmVzcG9uc2libGUgZm9yIGNvbXB1dGluZyB0aGUgZmluYWwgbWVyZ2VkIHRydXRoIG9mIHdoYXQgZG9jcyBhcmUgaW5cclxuICogYSBxdWVyeS4gSXQgZ2V0cyBub3RpZmllZCBvZiBsb2NhbCBhbmQgcmVtb3RlIGNoYW5nZXMgdG8gZG9jcywgYW5kIGFwcGxpZXNcclxuICogdGhlIHF1ZXJ5IGZpbHRlcnMgYW5kIGxpbWl0cyB0byBkZXRlcm1pbmUgdGhlIG1vc3QgY29ycmVjdCBwb3NzaWJsZSByZXN1bHRzLlxyXG4gKi9cclxudmFyIFZpZXcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBWaWV3KHF1ZXJ5LCBcclxuICAgIC8qKiBEb2N1bWVudHMgaW5jbHVkZWQgaW4gdGhlIHJlbW90ZSB0YXJnZXQgKi9cclxuICAgIF9zeW5jZWREb2N1bWVudHMpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XHJcbiAgICAgICAgdGhpcy5fc3luY2VkRG9jdW1lbnRzID0gX3N5bmNlZERvY3VtZW50cztcclxuICAgICAgICB0aGlzLnN5bmNTdGF0ZSA9IG51bGw7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBmbGFnIHdoZXRoZXIgdGhlIHZpZXcgaXMgY3VycmVudCB3aXRoIHRoZSBiYWNrZW5kLiBBIHZpZXcgaXMgY29uc2lkZXJlZFxyXG4gICAgICAgICAqIGN1cnJlbnQgYWZ0ZXIgaXQgaGFzIHNlZW4gdGhlIGN1cnJlbnQgZmxhZyBmcm9tIHRoZSBiYWNrZW5kIGFuZCBkaWQgbm90XHJcbiAgICAgICAgICogbG9zZSBjb25zaXN0ZW5jeSB3aXRoaW4gdGhlIHdhdGNoIHN0cmVhbSAoZS5nLiBiZWNhdXNlIG9mIGFuIGV4aXN0ZW5jZVxyXG4gICAgICAgICAqIGZpbHRlciBtaXNtYXRjaCkuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gZmFsc2U7XHJcbiAgICAgICAgLyoqIERvY3VtZW50cyBpbiB0aGUgdmlldyBidXQgbm90IGluIHRoZSByZW1vdGUgdGFyZ2V0ICovXHJcbiAgICAgICAgdGhpcy5saW1ib0RvY3VtZW50cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgLyoqIERvY3VtZW50IEtleXMgdGhhdCBoYXZlIGxvY2FsIGNoYW5nZXMgKi9cclxuICAgICAgICB0aGlzLm11dGF0ZWRLZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB0aGlzLmRvY3VtZW50U2V0ID0gbmV3IERvY3VtZW50U2V0KHF1ZXJ5LmRvY0NvbXBhcmF0b3IuYmluZChxdWVyeSkpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXcucHJvdG90eXBlLCBcInN5bmNlZERvY3VtZW50c1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNldCBvZiByZW1vdGUgZG9jdW1lbnRzIHRoYXQgdGhlIHNlcnZlciBoYXMgdG9sZCB1cyBiZWxvbmdzIHRvIHRoZSB0YXJnZXQgYXNzb2NpYXRlZCB3aXRoXHJcbiAgICAgICAgICogdGhpcyB2aWV3LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3luY2VkRG9jdW1lbnRzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGEgc2V0IG9mIGRvYyBjaGFuZ2VzLCBhcHBsaWVzIHRoZSBxdWVyeSBsaW1pdCwgYW5kIGNvbXB1dGVzXHJcbiAgICAgKiB3aGF0IHRoZSBuZXcgcmVzdWx0cyBzaG91bGQgYmUsIHdoYXQgdGhlIGNoYW5nZXMgd2VyZSwgYW5kIHdoZXRoZXIgd2UgbWF5XHJcbiAgICAgKiBuZWVkIHRvIGdvIGJhY2sgdG8gdGhlIGxvY2FsIGNhY2hlIGZvciBtb3JlIHJlc3VsdHMuIERvZXMgbm90IG1ha2UgYW55XHJcbiAgICAgKiBjaGFuZ2VzIHRvIHRoZSB2aWV3LlxyXG4gICAgICogQHBhcmFtIGRvY0NoYW5nZXMgVGhlIGRvYyBjaGFuZ2VzIHRvIGFwcGx5IHRvIHRoaXMgdmlldy5cclxuICAgICAqIEBwYXJhbSBwcmV2aW91c0NoYW5nZXMgSWYgdGhpcyBpcyBiZWluZyBjYWxsZWQgd2l0aCBhIHJlZmlsbCwgdGhlbiBzdGFydFxyXG4gICAgICogICAgICAgIHdpdGggdGhpcyBzZXQgb2YgZG9jcyBhbmQgY2hhbmdlcyBpbnN0ZWFkIG9mIHRoZSBjdXJyZW50IHZpZXcuXHJcbiAgICAgKiBAcmV0dXJuIGEgbmV3IHNldCBvZiBkb2NzLCBjaGFuZ2VzLCBhbmQgcmVmaWxsIGZsYWcuXHJcbiAgICAgKi9cclxuICAgIFZpZXcucHJvdG90eXBlLmNvbXB1dGVEb2NDaGFuZ2VzID0gZnVuY3Rpb24gKGRvY0NoYW5nZXMsIHByZXZpb3VzQ2hhbmdlcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNoYW5nZVNldCA9IHByZXZpb3VzQ2hhbmdlc1xyXG4gICAgICAgICAgICA/IHByZXZpb3VzQ2hhbmdlcy5jaGFuZ2VTZXRcclxuICAgICAgICAgICAgOiBuZXcgRG9jdW1lbnRDaGFuZ2VTZXQoKTtcclxuICAgICAgICB2YXIgb2xkRG9jdW1lbnRTZXQgPSBwcmV2aW91c0NoYW5nZXNcclxuICAgICAgICAgICAgPyBwcmV2aW91c0NoYW5nZXMuZG9jdW1lbnRTZXRcclxuICAgICAgICAgICAgOiB0aGlzLmRvY3VtZW50U2V0O1xyXG4gICAgICAgIHZhciBuZXdNdXRhdGVkS2V5cyA9IHByZXZpb3VzQ2hhbmdlc1xyXG4gICAgICAgICAgICA/IHByZXZpb3VzQ2hhbmdlcy5tdXRhdGVkS2V5c1xyXG4gICAgICAgICAgICA6IHRoaXMubXV0YXRlZEtleXM7XHJcbiAgICAgICAgdmFyIG5ld0RvY3VtZW50U2V0ID0gb2xkRG9jdW1lbnRTZXQ7XHJcbiAgICAgICAgdmFyIG5lZWRzUmVmaWxsID0gZmFsc2U7XHJcbiAgICAgICAgLy8gVHJhY2sgdGhlIGxhc3QgZG9jIGluIGEgKGZ1bGwpIGxpbWl0LiBUaGlzIGlzIG5lY2Vzc2FyeSwgYmVjYXVzZSBzb21lXHJcbiAgICAgICAgLy8gdXBkYXRlIChhIGRlbGV0ZSwgb3IgYW4gdXBkYXRlIG1vdmluZyBhIGRvYyBwYXN0IHRoZSBvbGQgbGltaXQpIG1pZ2h0XHJcbiAgICAgICAgLy8gbWVhbiB0aGVyZSBpcyBzb21lIG90aGVyIGRvY3VtZW50IGluIHRoZSBsb2NhbCBjYWNoZSB0aGF0IGVpdGhlciBzaG91bGRcclxuICAgICAgICAvLyBjb21lICgxKSBiZXR3ZWVuIHRoZSBvbGQgbGFzdCBsaW1pdCBkb2MgYW5kIHRoZSBuZXcgbGFzdCBkb2N1bWVudCwgaW4gdGhlXHJcbiAgICAgICAgLy8gY2FzZSBvZiB1cGRhdGVzLCBvciAoMikgYWZ0ZXIgdGhlIG5ldyBsYXN0IGRvY3VtZW50LCBpbiB0aGUgY2FzZSBvZlxyXG4gICAgICAgIC8vIGRlbGV0ZXMuIFNvIHdlIGtlZXAgdGhpcyBkb2MgYXQgdGhlIG9sZCBsaW1pdCB0byBjb21wYXJlIHRoZSB1cGRhdGVzIHRvLlxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gTm90ZSB0aGF0IHRoaXMgc2hvdWxkIG5ldmVyIGdldCB1c2VkIGluIGEgcmVmaWxsICh3aGVuIHByZXZpb3VzQ2hhbmdlcyBpc1xyXG4gICAgICAgIC8vIHNldCksIGJlY2F1c2UgdGhlcmUgd2lsbCBvbmx5IGJlIGFkZHMgLS0gbm8gZGVsZXRlcyBvciB1cGRhdGVzLlxyXG4gICAgICAgIHZhciBsYXN0RG9jSW5MaW1pdCA9IHRoaXMucXVlcnkuaGFzTGltaXQoKSAmJiBvbGREb2N1bWVudFNldC5zaXplID09PSB0aGlzLnF1ZXJ5LmxpbWl0XHJcbiAgICAgICAgICAgID8gb2xkRG9jdW1lbnRTZXQubGFzdCgpXHJcbiAgICAgICAgICAgIDogbnVsbDtcclxuICAgICAgICBkb2NDaGFuZ2VzLmlub3JkZXJUcmF2ZXJzYWwoZnVuY3Rpb24gKGtleSwgbmV3TWF5YmVEb2MpIHtcclxuICAgICAgICAgICAgdmFyIG9sZERvYyA9IG9sZERvY3VtZW50U2V0LmdldChrZXkpO1xyXG4gICAgICAgICAgICB2YXIgbmV3RG9jID0gbmV3TWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCA/IG5ld01heWJlRG9jIDogbnVsbDtcclxuICAgICAgICAgICAgaWYgKG5ld0RvYykge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGtleS5pc0VxdWFsKG5ld0RvYy5rZXkpLCAnTWlzbWF0Y2hpbmcga2V5cyBmb3VuZCBpbiBkb2N1bWVudCBjaGFuZ2VzOiAnICtcclxuICAgICAgICAgICAgICAgICAgICBrZXkgK1xyXG4gICAgICAgICAgICAgICAgICAgICcgIT0gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3RG9jLmtleSk7XHJcbiAgICAgICAgICAgICAgICBuZXdEb2MgPSBfdGhpcy5xdWVyeS5tYXRjaGVzKG5ld0RvYykgPyBuZXdEb2MgOiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBvbGREb2NIYWRQZW5kaW5nTXV0YXRpb25zID0gb2xkRG9jXHJcbiAgICAgICAgICAgICAgICA/IF90aGlzLm11dGF0ZWRLZXlzLmhhcyhvbGREb2Mua2V5KVxyXG4gICAgICAgICAgICAgICAgOiBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIG5ld0RvY0hhc1BlbmRpbmdNdXRhdGlvbnMgPSBuZXdEb2NcclxuICAgICAgICAgICAgICAgID8gbmV3RG9jLmhhc0xvY2FsTXV0YXRpb25zIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2Ugb25seSBjb25zaWRlciBjb21taXR0ZWQgbXV0YXRpb25zIGZvciBkb2N1bWVudHMgdGhhdCB3ZXJlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbXV0YXRlZCBkdXJpbmcgdGhlIGxpZmV0aW1lIG9mIHRoZSB2aWV3LlxyXG4gICAgICAgICAgICAgICAgICAgIChfdGhpcy5tdXRhdGVkS2V5cy5oYXMobmV3RG9jLmtleSkgJiYgbmV3RG9jLmhhc0NvbW1pdHRlZE11dGF0aW9ucylcclxuICAgICAgICAgICAgICAgIDogZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciBjaGFuZ2VBcHBsaWVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2VcclxuICAgICAgICAgICAgaWYgKG9sZERvYyAmJiBuZXdEb2MpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkb2NzRXF1YWwgPSBvbGREb2MuZGF0YS5pc0VxdWFsKG5ld0RvYy5kYXRhKTtcclxuICAgICAgICAgICAgICAgIGlmICghZG9jc0VxdWFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5zaG91bGRXYWl0Rm9yU3luY2VkRG9jdW1lbnQob2xkRG9jLCBuZXdEb2MpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVNldC50cmFjayh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBDaGFuZ2VUeXBlLk1vZGlmaWVkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jOiBuZXdEb2NcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUFwcGxpZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFzdERvY0luTGltaXQgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnF1ZXJ5LmRvY0NvbXBhcmF0b3IobmV3RG9jLCBsYXN0RG9jSW5MaW1pdCkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGRvYyBtb3ZlZCBmcm9tIGluc2lkZSB0aGUgbGltaXQgdG8gYWZ0ZXIgdGhlIGxpbWl0LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhhdCBtZWFucyB0aGVyZSBtYXkgYmUgc29tZSBkb2MgaW4gdGhlIGxvY2FsIGNhY2hlIHRoYXQnc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWN0dWFsbHkgbGVzcyB0aGFuIHRoaXMgb25lLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZHNSZWZpbGwgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob2xkRG9jSGFkUGVuZGluZ011dGF0aW9ucyAhPT0gbmV3RG9jSGFzUGVuZGluZ011dGF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZVNldC50cmFjayh7IHR5cGU6IENoYW5nZVR5cGUuTWV0YWRhdGEsIGRvYzogbmV3RG9jIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUFwcGxpZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCFvbGREb2MgJiYgbmV3RG9jKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VTZXQudHJhY2soeyB0eXBlOiBDaGFuZ2VUeXBlLkFkZGVkLCBkb2M6IG5ld0RvYyB9KTtcclxuICAgICAgICAgICAgICAgIGNoYW5nZUFwcGxpZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG9sZERvYyAmJiAhbmV3RG9jKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VTZXQudHJhY2soeyB0eXBlOiBDaGFuZ2VUeXBlLlJlbW92ZWQsIGRvYzogb2xkRG9jIH0pO1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlQXBwbGllZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAobGFzdERvY0luTGltaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBBIGRvYyB3YXMgcmVtb3ZlZCBmcm9tIGEgZnVsbCBsaW1pdCBxdWVyeS4gV2UnbGwgbmVlZCB0b1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlcXVlcnkgZnJvbSB0aGUgbG9jYWwgY2FjaGUgdG8gc2VlIGlmIHdlIGtub3cgYWJvdXQgc29tZSBvdGhlclxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRvYyB0aGF0IHNob3VsZCBiZSBpbiB0aGUgcmVzdWx0cy5cclxuICAgICAgICAgICAgICAgICAgICBuZWVkc1JlZmlsbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNoYW5nZUFwcGxpZWQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChuZXdEb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdEb2N1bWVudFNldCA9IG5ld0RvY3VtZW50U2V0LmFkZChuZXdEb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdEb2NIYXNQZW5kaW5nTXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld011dGF0ZWRLZXlzID0gbmV3TXV0YXRlZEtleXMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdNdXRhdGVkS2V5cyA9IG5ld011dGF0ZWRLZXlzLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0RvY3VtZW50U2V0ID0gbmV3RG9jdW1lbnRTZXQuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3TXV0YXRlZEtleXMgPSBuZXdNdXRhdGVkS2V5cy5kZWxldGUoa2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5Lmhhc0xpbWl0KCkpIHtcclxuICAgICAgICAgICAgd2hpbGUgKG5ld0RvY3VtZW50U2V0LnNpemUgPiB0aGlzLnF1ZXJ5LmxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb2xkRG9jID0gbmV3RG9jdW1lbnRTZXQubGFzdCgpO1xyXG4gICAgICAgICAgICAgICAgbmV3RG9jdW1lbnRTZXQgPSBuZXdEb2N1bWVudFNldC5kZWxldGUob2xkRG9jLmtleSk7XHJcbiAgICAgICAgICAgICAgICBuZXdNdXRhdGVkS2V5cyA9IG5ld011dGF0ZWRLZXlzLmRlbGV0ZShvbGREb2Mua2V5KTtcclxuICAgICAgICAgICAgICAgIGNoYW5nZVNldC50cmFjayh7IHR5cGU6IENoYW5nZVR5cGUuUmVtb3ZlZCwgZG9jOiBvbGREb2MgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgYXNzZXJ0KCFuZWVkc1JlZmlsbCB8fCAhcHJldmlvdXNDaGFuZ2VzLCAnVmlldyB3YXMgcmVmaWxsZWQgdXNpbmcgZG9jcyB0aGF0IHRoZW1zZWx2ZXMgbmVlZGVkIHJlZmlsbGluZy4nKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBkb2N1bWVudFNldDogbmV3RG9jdW1lbnRTZXQsXHJcbiAgICAgICAgICAgIGNoYW5nZVNldDogY2hhbmdlU2V0LFxyXG4gICAgICAgICAgICBuZWVkc1JlZmlsbDogbmVlZHNSZWZpbGwsXHJcbiAgICAgICAgICAgIG11dGF0ZWRLZXlzOiBuZXdNdXRhdGVkS2V5c1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgVmlldy5wcm90b3R5cGUuc2hvdWxkV2FpdEZvclN5bmNlZERvY3VtZW50ID0gZnVuY3Rpb24gKG9sZERvYywgbmV3RG9jKSB7XHJcbiAgICAgICAgLy8gV2Ugc3VwcHJlc3MgdGhlIGluaXRpYWwgY2hhbmdlIGV2ZW50IGZvciBkb2N1bWVudHMgdGhhdCB3ZXJlIG1vZGlmaWVkIGFzXHJcbiAgICAgICAgLy8gcGFydCBvZiBhIHdyaXRlIGFja25vd2xlZGdtZW50IChlLmcuIHdoZW4gdGhlIHZhbHVlIG9mIGEgc2VydmVyIHRyYW5zZm9ybVxyXG4gICAgICAgIC8vIGlzIGFwcGxpZWQpIGFzIFdhdGNoIHdpbGwgc2VuZCB1cyB0aGUgc2FtZSBkb2N1bWVudCBhZ2Fpbi5cclxuICAgICAgICAvLyBCeSBzdXBwcmVzc2luZyB0aGUgZXZlbnQsIHdlIG9ubHkgcmFpc2UgdHdvIHVzZXIgdmlzaWJsZSBldmVudHMgKG9uZSB3aXRoXHJcbiAgICAgICAgLy8gYGhhc1BlbmRpbmdXcml0ZXNgIGFuZCB0aGUgZmluYWwgc3RhdGUgb2YgdGhlIGRvY3VtZW50KSBpbnN0ZWFkIG9mIHRocmVlXHJcbiAgICAgICAgLy8gKG9uZSB3aXRoIGBoYXNQZW5kaW5nV3JpdGVzYCwgdGhlIG1vZGlmaWVkIGRvY3VtZW50IHdpdGhcclxuICAgICAgICAvLyBgaGFzUGVuZGluZ1dyaXRlc2AgYW5kIHRoZSBmaW5hbCBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQpLlxyXG4gICAgICAgIHJldHVybiAob2xkRG9jLmhhc0xvY2FsTXV0YXRpb25zICYmXHJcbiAgICAgICAgICAgIG5ld0RvYy5oYXNDb21taXR0ZWRNdXRhdGlvbnMgJiZcclxuICAgICAgICAgICAgIW5ld0RvYy5oYXNMb2NhbE11dGF0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSB2aWV3IHdpdGggdGhlIGdpdmVuIFZpZXdEb2N1bWVudENoYW5nZXMgYW5kIG9wdGlvbmFsbHkgdXBkYXRlc1xyXG4gICAgICogbGltYm8gZG9jcyBhbmQgc3luYyBzdGF0ZSBmcm9tIHRoZSBwcm92aWRlZCB0YXJnZXQgY2hhbmdlLlxyXG4gICAgICogQHBhcmFtIGRvY0NoYW5nZXMgVGhlIHNldCBvZiBjaGFuZ2VzIHRvIG1ha2UgdG8gdGhlIHZpZXcncyBkb2NzLlxyXG4gICAgICogQHBhcmFtIHVwZGF0ZUxpbWJvRG9jdW1lbnRzIFdoZXRoZXIgdG8gdXBkYXRlIGxpbWJvIGRvY3VtZW50cyBiYXNlZCBvbiB0aGlzXHJcbiAgICAgKiAgICAgICAgY2hhbmdlLlxyXG4gICAgICogQHBhcmFtIHRhcmdldENoYW5nZSBBIHRhcmdldCBjaGFuZ2UgdG8gYXBwbHkgZm9yIGNvbXB1dGluZyBsaW1ibyBkb2NzIGFuZFxyXG4gICAgICogICAgICAgIHN5bmMgc3RhdGUuXHJcbiAgICAgKiBAcmV0dXJuIEEgbmV3IFZpZXdDaGFuZ2Ugd2l0aCB0aGUgZ2l2ZW4gZG9jcywgY2hhbmdlcywgYW5kIHN5bmMgc3RhdGUuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIGlPUy9BbmRyb2lkIGNsaWVudHMgYWx3YXlzIGNvbXB1dGUgbGltYm8gZG9jdW1lbnQgY2hhbmdlcy5cclxuICAgIFZpZXcucHJvdG90eXBlLmFwcGx5Q2hhbmdlcyA9IGZ1bmN0aW9uIChkb2NDaGFuZ2VzLCB1cGRhdGVMaW1ib0RvY3VtZW50cywgdGFyZ2V0Q2hhbmdlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQoIWRvY0NoYW5nZXMubmVlZHNSZWZpbGwsICdDYW5ub3QgYXBwbHkgY2hhbmdlcyB0aGF0IG5lZWQgYSByZWZpbGwnKTtcclxuICAgICAgICB2YXIgb2xkRG9jcyA9IHRoaXMuZG9jdW1lbnRTZXQ7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudFNldCA9IGRvY0NoYW5nZXMuZG9jdW1lbnRTZXQ7XHJcbiAgICAgICAgdGhpcy5tdXRhdGVkS2V5cyA9IGRvY0NoYW5nZXMubXV0YXRlZEtleXM7XHJcbiAgICAgICAgLy8gU29ydCBjaGFuZ2VzIGJhc2VkIG9uIHR5cGUgYW5kIHF1ZXJ5IGNvbXBhcmF0b3JcclxuICAgICAgICB2YXIgY2hhbmdlcyA9IGRvY0NoYW5nZXMuY2hhbmdlU2V0LmdldENoYW5nZXMoKTtcclxuICAgICAgICBjaGFuZ2VzLnNvcnQoZnVuY3Rpb24gKGMxLCBjMikge1xyXG4gICAgICAgICAgICByZXR1cm4gKGNvbXBhcmVDaGFuZ2VUeXBlKGMxLnR5cGUsIGMyLnR5cGUpIHx8XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5xdWVyeS5kb2NDb21wYXJhdG9yKGMxLmRvYywgYzIuZG9jKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5hcHBseVRhcmdldENoYW5nZSh0YXJnZXRDaGFuZ2UpO1xyXG4gICAgICAgIHZhciBsaW1ib0NoYW5nZXMgPSB1cGRhdGVMaW1ib0RvY3VtZW50c1xyXG4gICAgICAgICAgICA/IHRoaXMudXBkYXRlTGltYm9Eb2N1bWVudHMoKVxyXG4gICAgICAgICAgICA6IFtdO1xyXG4gICAgICAgIHZhciBzeW5jZWQgPSB0aGlzLmxpbWJvRG9jdW1lbnRzLnNpemUgPT09IDAgJiYgdGhpcy5jdXJyZW50O1xyXG4gICAgICAgIHZhciBuZXdTeW5jU3RhdGUgPSBzeW5jZWQgPyBTeW5jU3RhdGUuU3luY2VkIDogU3luY1N0YXRlLkxvY2FsO1xyXG4gICAgICAgIHZhciBzeW5jU3RhdGVDaGFuZ2VkID0gbmV3U3luY1N0YXRlICE9PSB0aGlzLnN5bmNTdGF0ZTtcclxuICAgICAgICB0aGlzLnN5bmNTdGF0ZSA9IG5ld1N5bmNTdGF0ZTtcclxuICAgICAgICBpZiAoY2hhbmdlcy5sZW5ndGggPT09IDAgJiYgIXN5bmNTdGF0ZUNoYW5nZWQpIHtcclxuICAgICAgICAgICAgLy8gbm8gY2hhbmdlc1xyXG4gICAgICAgICAgICByZXR1cm4geyBsaW1ib0NoYW5nZXM6IGxpbWJvQ2hhbmdlcyB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHNuYXAgPSBuZXcgVmlld1NuYXBzaG90KHRoaXMucXVlcnksIGRvY0NoYW5nZXMuZG9jdW1lbnRTZXQsIG9sZERvY3MsIGNoYW5nZXMsIGRvY0NoYW5nZXMubXV0YXRlZEtleXMsIG5ld1N5bmNTdGF0ZSA9PT0gU3luY1N0YXRlLkxvY2FsLCBzeW5jU3RhdGVDaGFuZ2VkLCBcclxuICAgICAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovIGZhbHNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHNuYXBzaG90OiBzbmFwLFxyXG4gICAgICAgICAgICAgICAgbGltYm9DaGFuZ2VzOiBsaW1ib0NoYW5nZXNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBsaWVzIGFuIE9ubGluZVN0YXRlIGNoYW5nZSB0byB0aGUgdmlldywgcG90ZW50aWFsbHkgZ2VuZXJhdGluZyBhXHJcbiAgICAgKiBWaWV3Q2hhbmdlIGlmIHRoZSB2aWV3J3Mgc3luY1N0YXRlIGNoYW5nZXMgYXMgYSByZXN1bHQuXHJcbiAgICAgKi9cclxuICAgIFZpZXcucHJvdG90eXBlLmFwcGx5T25saW5lU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50ICYmIG9ubGluZVN0YXRlID09PSBPbmxpbmVTdGF0ZS5PZmZsaW5lKSB7XHJcbiAgICAgICAgICAgIC8vIElmIHdlJ3JlIG9mZmxpbmUsIHNldCBgY3VycmVudGAgdG8gZmFsc2UgYW5kIHRoZW4gY2FsbCBhcHBseUNoYW5nZXMoKVxyXG4gICAgICAgICAgICAvLyB0byByZWZyZXNoIG91ciBzeW5jU3RhdGUgYW5kIGdlbmVyYXRlIGEgVmlld0NoYW5nZSBhcyBhcHByb3ByaWF0ZS4gV2VcclxuICAgICAgICAgICAgLy8gYXJlIGd1YXJhbnRlZWQgdG8gZ2V0IGEgbmV3IFRhcmdldENoYW5nZSB0aGF0IHNldHMgYGN1cnJlbnRgIGJhY2sgdG9cclxuICAgICAgICAgICAgLy8gdHJ1ZSBvbmNlIHRoZSBjbGllbnQgaXMgYmFjayBvbmxpbmUuXHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBseUNoYW5nZXMoe1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRTZXQ6IHRoaXMuZG9jdW1lbnRTZXQsXHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VTZXQ6IG5ldyBEb2N1bWVudENoYW5nZVNldCgpLFxyXG4gICAgICAgICAgICAgICAgbXV0YXRlZEtleXM6IHRoaXMubXV0YXRlZEtleXMsXHJcbiAgICAgICAgICAgICAgICBuZWVkc1JlZmlsbDogZmFsc2VcclxuICAgICAgICAgICAgfSwgXHJcbiAgICAgICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBObyBlZmZlY3QsIGp1c3QgcmV0dXJuIGEgbm8tb3AgVmlld0NoYW5nZS5cclxuICAgICAgICAgICAgcmV0dXJuIHsgbGltYm9DaGFuZ2VzOiBbXSB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgZG9jIGZvciB0aGUgZ2l2ZW4ga2V5IHNob3VsZCBiZSBpbiBsaW1iby5cclxuICAgICAqL1xyXG4gICAgVmlldy5wcm90b3R5cGUuc2hvdWxkQmVJbkxpbWJvID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIC8vIElmIHRoZSByZW1vdGUgZW5kIHNheXMgaXQncyBwYXJ0IG9mIHRoaXMgcXVlcnksIGl0J3Mgbm90IGluIGxpbWJvLlxyXG4gICAgICAgIGlmICh0aGlzLl9zeW5jZWREb2N1bWVudHMuaGFzKGtleSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgZG9lc24ndCB0aGluayBpdCdzIGEgcmVzdWx0LCBzbyBpdCBzaG91bGRuJ3QgYmUgaW4gbGltYm8uXHJcbiAgICAgICAgaWYgKCF0aGlzLmRvY3VtZW50U2V0LmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgdGhlcmUgYXJlIGxvY2FsIGNoYW5nZXMgdG8gdGhlIGRvYywgdGhleSBtaWdodCBleHBsYWluIHdoeSB0aGUgc2VydmVyXHJcbiAgICAgICAgLy8gZG9lc24ndCBrbm93IHRoYXQgaXQncyBwYXJ0IG9mIHRoZSBxdWVyeS4gU28gZG9uJ3QgcHV0IGl0IGluIGxpbWJvLlxyXG4gICAgICAgIC8vIFRPRE8oa2xpbXQpOiBJZGVhbGx5LCB3ZSB3b3VsZCBvbmx5IGNvbnNpZGVyIGNoYW5nZXMgdGhhdCBtaWdodCBhY3R1YWxseVxyXG4gICAgICAgIC8vIGFmZmVjdCB0aGlzIHNwZWNpZmljIHF1ZXJ5LlxyXG4gICAgICAgIGlmICh0aGlzLmRvY3VtZW50U2V0LmdldChrZXkpLmhhc0xvY2FsTXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gRXZlcnl0aGluZyBlbHNlIGlzIGluIGxpbWJvLlxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlcyBzeW5jZWREb2N1bWVudHMsIGN1cnJlbnQsIGFuZCBsaW1ibyBkb2NzIGJhc2VkIG9uIHRoZSBnaXZlbiBjaGFuZ2UuXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBsaXN0IG9mIGNoYW5nZXMgdG8gd2hpY2ggZG9jcyBhcmUgaW4gbGltYm8uXHJcbiAgICAgKi9cclxuICAgIFZpZXcucHJvdG90eXBlLmFwcGx5VGFyZ2V0Q2hhbmdlID0gZnVuY3Rpb24gKHRhcmdldENoYW5nZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRhcmdldENoYW5nZSkge1xyXG4gICAgICAgICAgICB0YXJnZXRDaGFuZ2UuYWRkZWREb2N1bWVudHMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IHJldHVybiAoX3RoaXMuX3N5bmNlZERvY3VtZW50cyA9IF90aGlzLl9zeW5jZWREb2N1bWVudHMuYWRkKGtleSkpOyB9KTtcclxuICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlLm1vZGlmaWVkRG9jdW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFzc2VydChfdGhpcy5fc3luY2VkRG9jdW1lbnRzLmhhcyhrZXkpLCBcIk1vZGlmaWVkIGRvY3VtZW50IFwiICsga2V5ICsgXCIgbm90IGZvdW5kIGluIHZpZXcuXCIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlLnJlbW92ZWREb2N1bWVudHMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IHJldHVybiAoX3RoaXMuX3N5bmNlZERvY3VtZW50cyA9IF90aGlzLl9zeW5jZWREb2N1bWVudHMuZGVsZXRlKGtleSkpOyB9KTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gdGFyZ2V0Q2hhbmdlLmN1cnJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFZpZXcucHJvdG90eXBlLnVwZGF0ZUxpbWJvRG9jdW1lbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gV2UgY2FuIG9ubHkgZGV0ZXJtaW5lIGxpbWJvIGRvY3VtZW50cyB3aGVuIHdlJ3JlIGluLXN5bmMgd2l0aCB0aGUgc2VydmVyLlxyXG4gICAgICAgIGlmICghdGhpcy5jdXJyZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVE9ETyhrbGltdCk6IERvIHRoaXMgaW5jcmVtZW50YWxseSBzbyB0aGF0IGl0J3Mgbm90IHF1YWRyYXRpYyB3aGVuXHJcbiAgICAgICAgLy8gdXBkYXRpbmcgbWFueSBkb2N1bWVudHMuXHJcbiAgICAgICAgdmFyIG9sZExpbWJvRG9jdW1lbnRzID0gdGhpcy5saW1ib0RvY3VtZW50cztcclxuICAgICAgICB0aGlzLmxpbWJvRG9jdW1lbnRzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB0aGlzLmRvY3VtZW50U2V0LmZvckVhY2goZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuc2hvdWxkQmVJbkxpbWJvKGRvYy5rZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5saW1ib0RvY3VtZW50cyA9IF90aGlzLmxpbWJvRG9jdW1lbnRzLmFkZChkb2Mua2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIERpZmYgdGhlIG5ldyBsaW1ibyBkb2NzIHdpdGggdGhlIG9sZCBsaW1ibyBkb2NzLlxyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gW107XHJcbiAgICAgICAgb2xkTGltYm9Eb2N1bWVudHMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIGlmICghX3RoaXMubGltYm9Eb2N1bWVudHMuaGFzKGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZXMucHVzaChuZXcgUmVtb3ZlZExpbWJvRG9jdW1lbnQoa2V5KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmxpbWJvRG9jdW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICBpZiAoIW9sZExpbWJvRG9jdW1lbnRzLmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VzLnB1c2gobmV3IEFkZGVkTGltYm9Eb2N1bWVudChrZXkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBjaGFuZ2VzO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlIHRoZSBpbi1tZW1vcnkgc3RhdGUgb2YgdGhlIGN1cnJlbnQgdmlldyB3aXRoIHRoZSBzdGF0ZSByZWFkIGZyb21cclxuICAgICAqIHBlcnNpc3RlbmNlLlxyXG4gICAgICpcclxuICAgICAqIFdlIHVwZGF0ZSB0aGUgcXVlcnkgdmlldyB3aGVuZXZlciBhIGNsaWVudCdzIHByaW1hcnkgc3RhdHVzIGNoYW5nZXM6XHJcbiAgICAgKiAtIFdoZW4gYSBjbGllbnQgdHJhbnNpdGlvbnMgZnJvbSBwcmltYXJ5IHRvIHNlY29uZGFyeSwgaXQgY2FuIG1pc3NcclxuICAgICAqICAgTG9jYWxTdG9yYWdlIHVwZGF0ZXMgYW5kIGl0cyBxdWVyeSB2aWV3cyBtYXkgdGVtcG9yYXJpbHkgbm90IGJlXHJcbiAgICAgKiAgIHN5bmNocm9uaXplZCB3aXRoIHRoZSBzdGF0ZSBvbiBkaXNrLlxyXG4gICAgICogLSBGb3Igc2Vjb25kYXJ5IHRvIHByaW1hcnkgdHJhbnNpdGlvbnMsIHRoZSBjbGllbnQgbmVlZHMgdG8gdXBkYXRlIHRoZSBsaXN0XHJcbiAgICAgKiAgIG9mIGBzeW5jZWREb2N1bWVudHNgIHNpbmNlIHNlY29uZGFyeSBjbGllbnRzIHVwZGF0ZSB0aGVpciBxdWVyeSB2aWV3c1xyXG4gICAgICogICBiYXNlZCBwdXJlbHkgb24gc3ludGhlc2l6ZWQgUmVtb3RlRXZlbnRzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBsb2NhbERvY3MgLSBUaGUgZG9jdW1lbnRzIHRoYXQgbWF0Y2ggdGhlIHF1ZXJ5IGFjY29yZGluZyB0byB0aGVcclxuICAgICAqIExvY2FsU3RvcmUuXHJcbiAgICAgKiBAcGFyYW0gcmVtb3RlS2V5cyAtIFRoZSBrZXlzIG9mIHRoZSBkb2N1bWVudHMgdGhhdCBtYXRjaCB0aGUgcXVlcnlcclxuICAgICAqIGFjY29yZGluZyB0byB0aGUgYmFja2VuZC5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBWaWV3Q2hhbmdlIHRoYXQgcmVzdWx0ZWQgZnJvbSB0aGlzIHN5bmNocm9uaXphdGlvbi5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIFZpZXcucHJvdG90eXBlLnN5bmNocm9uaXplV2l0aFBlcnNpc3RlZFN0YXRlID0gZnVuY3Rpb24gKGxvY2FsRG9jcywgcmVtb3RlS2V5cykge1xyXG4gICAgICAgIHRoaXMuX3N5bmNlZERvY3VtZW50cyA9IHJlbW90ZUtleXM7XHJcbiAgICAgICAgdGhpcy5saW1ib0RvY3VtZW50cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdmFyIGRvY0NoYW5nZXMgPSB0aGlzLmNvbXB1dGVEb2NDaGFuZ2VzKGxvY2FsRG9jcyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlDaGFuZ2VzKGRvY0NoYW5nZXMsIC8qdXBkYXRlTGltYm9Eb2N1bWVudHM9Ki8gdHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgdmlldyBzbmFwc2hvdCBhcyBpZiB0aGlzIHF1ZXJ5IHdhcyBqdXN0IGxpc3RlbmVkIHRvLiBDb250YWluc1xyXG4gICAgICogYSBkb2N1bWVudCBhZGQgZm9yIGV2ZXJ5IGV4aXN0aW5nIGRvY3VtZW50IGFuZCB0aGUgYGZyb21DYWNoZWAgYW5kXHJcbiAgICAgKiBgaGFzUGVuZGluZ1dyaXRlc2Agc3RhdHVzIG9mIHRoZSBhbHJlYWR5IGVzdGFibGlzaGVkIHZpZXcuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBWaWV3LnByb3RvdHlwZS5jb21wdXRlSW5pdGlhbFNuYXBzaG90ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBWaWV3U25hcHNob3QuZnJvbUluaXRpYWxEb2N1bWVudHModGhpcy5xdWVyeSwgdGhpcy5kb2N1bWVudFNldCwgdGhpcy5tdXRhdGVkS2V5cywgdGhpcy5zeW5jU3RhdGUgPT09IFN5bmNTdGF0ZS5Mb2NhbCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFZpZXc7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGNvbXBhcmVDaGFuZ2VUeXBlKGMxLCBjMikge1xyXG4gICAgdmFyIG9yZGVyID0gZnVuY3Rpb24gKGNoYW5nZSkge1xyXG4gICAgICAgIHN3aXRjaCAoY2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5BZGRlZDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuTW9kaWZpZWQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMjtcclxuICAgICAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLk1ldGFkYXRhOlxyXG4gICAgICAgICAgICAgICAgLy8gQSBtZXRhZGF0YSBjaGFuZ2UgaXMgY29udmVydGVkIHRvIGEgbW9kaWZpZWQgY2hhbmdlIGF0IHRoZSBwdWJsaWNcclxuICAgICAgICAgICAgICAgIC8vIGFwaSBsYXllci4gIFNpbmNlIHdlIHNvcnQgYnkgZG9jdW1lbnQga2V5IGFuZCB0aGVuIGNoYW5nZSB0eXBlLFxyXG4gICAgICAgICAgICAgICAgLy8gbWV0YWRhdGEgYW5kIG1vZGlmaWVkIGNoYW5nZXMgbXVzdCBiZSBzb3J0ZWQgZXF1aXZhbGVudGx5LlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XHJcbiAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5SZW1vdmVkOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBDaGFuZ2VUeXBlOiAnICsgY2hhbmdlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIG9yZGVyKGMxKSAtIG9yZGVyKGMyKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckOSA9ICdTeW5jRW5naW5lJztcclxuLyoqXHJcbiAqIFF1ZXJ5VmlldyBjb250YWlucyBhbGwgb2YgdGhlIGRhdGEgdGhhdCBTeW5jRW5naW5lIG5lZWRzIHRvIGtlZXAgdHJhY2sgb2YgZm9yXHJcbiAqIGEgcGFydGljdWxhciBxdWVyeS5cclxuICovXHJcbnZhciBRdWVyeVZpZXcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBRdWVyeVZpZXcoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBxdWVyeSBpdHNlbGYuXHJcbiAgICAgKi9cclxuICAgIHF1ZXJ5LCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHRhcmdldCBudW1iZXIgY3JlYXRlZCBieSB0aGUgY2xpZW50IHRoYXQgaXMgdXNlZCBpbiB0aGUgd2F0Y2hcclxuICAgICAqIHN0cmVhbSB0byBpZGVudGlmeSB0aGlzIHF1ZXJ5LlxyXG4gICAgICovXHJcbiAgICB0YXJnZXRJZCwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSB2aWV3IGlzIHJlc3BvbnNpYmxlIGZvciBjb21wdXRpbmcgdGhlIGZpbmFsIG1lcmdlZCB0cnV0aCBvZiB3aGF0XHJcbiAgICAgKiBkb2NzIGFyZSBpbiB0aGUgcXVlcnkuIEl0IGdldHMgbm90aWZpZWQgb2YgbG9jYWwgYW5kIHJlbW90ZSBjaGFuZ2VzLFxyXG4gICAgICogYW5kIGFwcGxpZXMgdGhlIHF1ZXJ5IGZpbHRlcnMgYW5kIGxpbWl0cyB0byBkZXRlcm1pbmUgdGhlIG1vc3QgY29ycmVjdFxyXG4gICAgICogcG9zc2libGUgcmVzdWx0cy5cclxuICAgICAqL1xyXG4gICAgdmlldykge1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICB0aGlzLnRhcmdldElkID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgdGhpcy52aWV3ID0gdmlldztcclxuICAgIH1cclxuICAgIHJldHVybiBRdWVyeVZpZXc7XHJcbn0oKSk7XHJcbi8qKiBUcmFja3MgYSBsaW1ibyByZXNvbHV0aW9uLiAqL1xyXG52YXIgTGltYm9SZXNvbHV0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTGltYm9SZXNvbHV0aW9uKGtleSkge1xyXG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIExpbWJvUmVzb2x1dGlvbjtcclxufSgpKTtcclxuLyoqXHJcbiAqIFN5bmNFbmdpbmUgaXMgdGhlIGNlbnRyYWwgY29udHJvbGxlciBpbiB0aGUgY2xpZW50IFNESyBhcmNoaXRlY3R1cmUuIEl0IGlzXHJcbiAqIHRoZSBnbHVlIGNvZGUgYmV0d2VlbiB0aGUgRXZlbnRNYW5hZ2VyLCBMb2NhbFN0b3JlLCBhbmQgUmVtb3RlU3RvcmUuIFNvbWUgb2ZcclxuICogU3luY0VuZ2luZSdzIHJlc3BvbnNpYmlsaXRpZXMgaW5jbHVkZTpcclxuICogMS4gQ29vcmRpbmF0aW5nIGNsaWVudCByZXF1ZXN0cyBhbmQgcmVtb3RlIGV2ZW50cyBiZXR3ZWVuIHRoZSBFdmVudE1hbmFnZXJcclxuICogICAgYW5kIHRoZSBsb2NhbCBhbmQgcmVtb3RlIGRhdGEgc3RvcmVzLlxyXG4gKiAyLiBNYW5hZ2luZyBhIFZpZXcgb2JqZWN0IGZvciBlYWNoIHF1ZXJ5LCBwcm92aWRpbmcgdGhlIHVuaWZpZWQgdmlldyBiZXR3ZWVuXHJcbiAqICAgIHRoZSBsb2NhbCBhbmQgcmVtb3RlIGRhdGEgc3RvcmVzLlxyXG4gKiAzLiBOb3RpZnlpbmcgdGhlIFJlbW90ZVN0b3JlIHdoZW4gdGhlIExvY2FsU3RvcmUgaGFzIG5ldyBtdXRhdGlvbnMgaW4gaXRzXHJcbiAqICAgIHF1ZXVlIHRoYXQgbmVlZCBzZW5kaW5nIHRvIHRoZSBiYWNrZW5kLlxyXG4gKlxyXG4gKiBUaGUgU3luY0VuZ2luZeKAmXMgbWV0aG9kcyBzaG91bGQgb25seSBldmVyIGJlIGNhbGxlZCBieSBtZXRob2RzIHJ1bm5pbmcgaW4gdGhlXHJcbiAqIGdsb2JhbCBhc3luYyBxdWV1ZS5cclxuICovXHJcbnZhciBTeW5jRW5naW5lID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU3luY0VuZ2luZShsb2NhbFN0b3JlLCByZW1vdGVTdG9yZSwgXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE1hbmFnZXMgc3RhdGUgc3luY2hyb25pemF0aW9uIGluIG11bHRpLXRhYiBlbnZpcm9ubWVudHMuXHJcbiAgICBzaGFyZWRDbGllbnRTdGF0ZSwgY3VycmVudFVzZXIpIHtcclxuICAgICAgICB0aGlzLmxvY2FsU3RvcmUgPSBsb2NhbFN0b3JlO1xyXG4gICAgICAgIHRoaXMucmVtb3RlU3RvcmUgPSByZW1vdGVTdG9yZTtcclxuICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlID0gc2hhcmVkQ2xpZW50U3RhdGU7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyO1xyXG4gICAgICAgIHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnF1ZXJ5Vmlld3NCeVF1ZXJ5ID0gbmV3IE9iamVjdE1hcChmdW5jdGlvbiAocSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcS5jYW5vbmljYWxJZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0ID0ge307XHJcbiAgICAgICAgdGhpcy5saW1ib1RhcmdldHNCeUtleSA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbiAgICAgICAgdGhpcy5saW1ib1Jlc29sdXRpb25zQnlUYXJnZXQgPSB7fTtcclxuICAgICAgICB0aGlzLmxpbWJvRG9jdW1lbnRSZWZzID0gbmV3IFJlZmVyZW5jZVNldCgpO1xyXG4gICAgICAgIC8qKiBTdG9yZXMgdXNlciBjb21wbGV0aW9uIGhhbmRsZXJzLCBpbmRleGVkIGJ5IFVzZXIgYW5kIEJhdGNoSWQuICovXHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblVzZXJDYWxsYmFja3MgPSB7fTtcclxuICAgICAgICB0aGlzLmxpbWJvVGFyZ2V0SWRHZW5lcmF0b3IgPSBUYXJnZXRJZEdlbmVyYXRvci5mb3JTeW5jRW5naW5lKCk7XHJcbiAgICAgICAgLy8gVGhlIHByaW1hcnkgc3RhdGUgaXMgc2V0IHRvIGB0cnVlYCBvciBgZmFsc2VgIGltbWVkaWF0ZWx5IGFmdGVyIEZpcmVzdG9yZVxyXG4gICAgICAgIC8vIHN0YXJ0dXAuIEluIHRoZSBpbnRlcmltLCBhIGNsaWVudCBzaG91bGQgb25seSBiZSBjb25zaWRlcmVkIHByaW1hcnkgaWZcclxuICAgICAgICAvLyBgaXNQcmltYXJ5YCBpcyB0cnVlLlxyXG4gICAgICAgIHRoaXMuaXNQcmltYXJ5ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGUgPSBPbmxpbmVTdGF0ZS5Vbmtub3duO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5bmNFbmdpbmUucHJvdG90eXBlLCBcImlzUHJpbWFyeUNsaWVudFwiLCB7XHJcbiAgICAgICAgLy8gT25seSB1c2VkIGZvciB0ZXN0aW5nLlxyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pc1ByaW1hcnkgPT09IHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKiogU3Vic2NyaWJlcyB0byBTeW5jRW5naW5lIG5vdGlmaWNhdGlvbnMuIEhhcyB0byBiZSBjYWxsZWQgZXhhY3RseSBvbmNlLiAqL1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN5bmNFbmdpbmVMaXN0ZW5lcikge1xyXG4gICAgICAgIGFzc2VydChzeW5jRW5naW5lTGlzdGVuZXIgIT09IG51bGwsICdTeW5jRW5naW5lIGxpc3RlbmVyIGNhbm5vdCBiZSBudWxsJyk7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyID09PSBudWxsLCAnU3luY0VuZ2luZSBhbHJlYWR5IGhhcyBhIHN1YnNjcmliZXIuJyk7XHJcbiAgICAgICAgdGhpcy5zeW5jRW5naW5lTGlzdGVuZXIgPSBzeW5jRW5naW5lTGlzdGVuZXI7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWF0ZXMgdGhlIG5ldyBsaXN0ZW4sIHJlc29sdmVzIHByb21pc2Ugd2hlbiBsaXN0ZW4gZW5xdWV1ZWQgdG8gdGhlXHJcbiAgICAgKiBzZXJ2ZXIuIEFsbCB0aGUgc3Vic2VxdWVudCB2aWV3IHNuYXBzaG90cyBvciBlcnJvcnMgYXJlIHNlbnQgdG8gdGhlXHJcbiAgICAgKiBzdWJzY3JpYmVkIGhhbmRsZXJzLiBSZXR1cm5zIHRoZSB0YXJnZXRJZCBvZiB0aGUgcXVlcnkuXHJcbiAgICAgKi9cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmxpc3RlbiA9IGZ1bmN0aW9uIChxdWVyeSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0SWQsIHZpZXdTbmFwc2hvdCwgcXVlcnlWaWV3LCBxdWVyeURhdGEsIHN0YXR1c18xO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0U3Vic2NyaWJlZCgnbGlzdGVuKCknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlWaWV3ID0gdGhpcy5xdWVyeVZpZXdzQnlRdWVyeS5nZXQocXVlcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5VmlldykgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBPUlRJTkcgTk9URTogV2l0aCBNdWx0LVRhYiBXZWIsIGl0IGlzIHBvc3NpYmxlIHRoYXQgYSBxdWVyeSB2aWV3XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFscmVhZHkgZXhpc3RzIHdoZW4gRXZlbnRNYW5hZ2VyIGNhbGxzIHVzIGZvciB0aGUgZmlyc3QgdGltZS4gVGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBoYXBwZW5zIHdoZW4gdGhlIHByaW1hcnkgdGFiIGlzIGFscmVhZHkgbGlzdGVuaW5nIHRvIHRoaXMgcXVlcnkgb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVoYWxmIG9mIGFub3RoZXIgdGFiIGFuZCB0aGUgdXNlciBvZiB0aGUgcHJpbWFyeSBhbHNvIHN0YXJ0cyBsaXN0ZW5pbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gdGhlIHF1ZXJ5LiBFdmVudE1hbmFnZXIgd2lsbCBub3QgaGF2ZSBhbiBhc3NpZ25lZCB0YXJnZXQgSUQgaW4gdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjYXNlIGFuZCBjYWxscyBgbGlzdGVuYCB0byBvYnRhaW4gdGhpcyBJRC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQgPSBxdWVyeVZpZXcudGFyZ2V0SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuYWRkTG9jYWxRdWVyeVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdTbmFwc2hvdCA9IHF1ZXJ5Vmlldy52aWV3LmNvbXB1dGVJbml0aWFsU25hcHNob3QoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUuYWxsb2NhdGVRdWVyeShxdWVyeSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlEYXRhID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNfMSA9IHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuYWRkTG9jYWxRdWVyeVRhcmdldChxdWVyeURhdGEudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZCA9IHF1ZXJ5RGF0YS50YXJnZXRJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5pbml0aWFsaXplVmlld0FuZENvbXB1dGVTbmFwc2hvdChxdWVyeURhdGEsIHN0YXR1c18xID09PSAnY3VycmVudCcpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdTbmFwc2hvdCA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLmxpc3RlbihxdWVyeURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNDtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyLm9uV2F0Y2hDaGFuZ2UoW3ZpZXdTbmFwc2hvdF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlZ2lzdGVycyBhIHZpZXcgZm9yIGEgcHJldmlvdXNseSB1bmtub3duIHF1ZXJ5IGFuZCBjb21wdXRlcyBpdHMgaW5pdGlhbFxyXG4gICAgICogc25hcHNob3QuXHJcbiAgICAgKi9cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmluaXRpYWxpemVWaWV3QW5kQ29tcHV0ZVNuYXBzaG90ID0gZnVuY3Rpb24gKHF1ZXJ5RGF0YSwgY3VycmVudCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHF1ZXJ5ID0gcXVlcnlEYXRhLnF1ZXJ5O1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmUuZXhlY3V0ZVF1ZXJ5KHF1ZXJ5KS50aGVuKGZ1bmN0aW9uIChkb2NzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgICAgICAucmVtb3RlRG9jdW1lbnRLZXlzKHF1ZXJ5RGF0YS50YXJnZXRJZClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZW1vdGVLZXlzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlldyA9IG5ldyBWaWV3KHF1ZXJ5LCByZW1vdGVLZXlzKTtcclxuICAgICAgICAgICAgICAgIHZhciB2aWV3RG9jQ2hhbmdlcyA9IHZpZXcuY29tcHV0ZURvY0NoYW5nZXMoZG9jcyk7XHJcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoIFByZXR0aWVyIGZvcm1hdHMgdGhpcyBleGNlZWQgMTAwIGNoYXJhY3RlcnMuXHJcbiAgICAgICAgICAgICAgICB2YXIgc3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2UgPSBUYXJnZXRDaGFuZ2UuY3JlYXRlU3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2VGb3JDdXJyZW50Q2hhbmdlKHF1ZXJ5RGF0YS50YXJnZXRJZCwgY3VycmVudCAmJiBfdGhpcy5vbmxpbmVTdGF0ZSAhPT0gT25saW5lU3RhdGUuT2ZmbGluZSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlld0NoYW5nZSA9IHZpZXcuYXBwbHlDaGFuZ2VzKHZpZXdEb2NDaGFuZ2VzLCBcclxuICAgICAgICAgICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyBfdGhpcy5pc1ByaW1hcnkgPT09IHRydWUsIHN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIGFzc2VydCh2aWV3Q2hhbmdlLmxpbWJvQ2hhbmdlcy5sZW5ndGggPT09IDAsICdWaWV3IHJldHVybmVkIGxpbWJvIGRvY3MgYmVmb3JlIHRhcmdldCBhY2sgZnJvbSB0aGUgc2VydmVyLicpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KCEhdmlld0NoYW5nZS5zbmFwc2hvdCwgJ2FwcGx5Q2hhbmdlcyBmb3IgbmV3IHZpZXcgc2hvdWxkIGFsd2F5cyByZXR1cm4gYSBzbmFwc2hvdCcpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgUXVlcnlWaWV3KHF1ZXJ5LCBxdWVyeURhdGEudGFyZ2V0SWQsIHZpZXcpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucXVlcnlWaWV3c0J5UXVlcnkuc2V0KHF1ZXJ5LCBkYXRhKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldFtxdWVyeURhdGEudGFyZ2V0SWRdID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2aWV3Q2hhbmdlLnNuYXBzaG90O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlY29uY2lsZSB0aGUgbGlzdCBvZiBzeW5jZWQgZG9jdW1lbnRzIGluIGFuIGV4aXN0aW5nIHZpZXcgd2l0aCB0aG9zZVxyXG4gICAgICogZnJvbSBwZXJzaXN0ZW5jZS5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnN5bmNocm9uaXplVmlld0FuZENvbXB1dGVTbmFwc2hvdCA9IGZ1bmN0aW9uIChxdWVyeVZpZXcpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmUuZXhlY3V0ZVF1ZXJ5KHF1ZXJ5Vmlldy5xdWVyeSkudGhlbihmdW5jdGlvbiAoZG9jcykge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAgICAgLnJlbW90ZURvY3VtZW50S2V5cyhxdWVyeVZpZXcudGFyZ2V0SWQpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVtb3RlS2V5cykgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlld1NuYXBzaG90O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld1NuYXBzaG90ID0gcXVlcnlWaWV3LnZpZXcuc3luY2hyb25pemVXaXRoUGVyc2lzdGVkU3RhdGUoZG9jcywgcmVtb3RlS2V5cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVHJhY2tlZExpbWJvcyhxdWVyeVZpZXcudGFyZ2V0SWQsIHZpZXdTbmFwc2hvdC5saW1ib0NoYW5nZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdmlld1NuYXBzaG90XTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFN0b3BzIGxpc3RlbmluZyB0byB0aGUgcXVlcnkuICovXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS51bmxpc3RlbiA9IGZ1bmN0aW9uIChxdWVyeSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgcXVlcnlWaWV3LCB0YXJnZXRSZW1haW5zQWN0aXZlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0U3Vic2NyaWJlZCgndW5saXN0ZW4oKScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVZpZXcgPSB0aGlzLnF1ZXJ5Vmlld3NCeVF1ZXJ5LmdldChxdWVyeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCghIXF1ZXJ5VmlldywgJ1RyeWluZyB0byB1bmxpc3RlbiBvbiBxdWVyeSBub3QgZm91bmQ6JyArIHF1ZXJ5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzUHJpbWFyeSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gcmVtb3ZlIHRoZSBsb2NhbCBxdWVyeSB0YXJnZXQgZmlyc3QgdG8gYWxsb3cgdXMgdG8gdmVyaWZ5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdoZXRoZXIgYW55IG90aGVyIGNsaWVudCBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoaXMgdGFyZ2V0LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlLnJlbW92ZUxvY2FsUXVlcnlUYXJnZXQocXVlcnlWaWV3LnRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtYWluc0FjdGl2ZSA9IHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuaXNBY3RpdmVRdWVyeVRhcmdldChxdWVyeVZpZXcudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0YXJnZXRSZW1haW5zQWN0aXZlKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbGVhc2VRdWVyeShxdWVyeSwgLyprZWVwUGVyc2lzdGVkUXVlcnlEYXRhPSovIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5jbGVhclF1ZXJ5U3RhdGUocXVlcnlWaWV3LnRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdGVTdG9yZS51bmxpc3RlbihxdWVyeVZpZXcudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbW92ZUFuZENsZWFudXBRdWVyeShxdWVyeVZpZXcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX3RoaXMuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGVycik7IH0pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFuZENsZWFudXBRdWVyeShxdWVyeVZpZXcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUucmVsZWFzZVF1ZXJ5KHF1ZXJ5LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qa2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YT0qLyB0cnVlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWF0ZXMgdGhlIHdyaXRlIG9mIGxvY2FsIG11dGF0aW9uIGJhdGNoIHdoaWNoIGludm9sdmVzIGFkZGluZyB0aGVcclxuICAgICAqIHdyaXRlcyB0byB0aGUgbXV0YXRpb24gcXVldWUsIG5vdGlmeWluZyB0aGUgcmVtb3RlIHN0b3JlIGFib3V0IG5ld1xyXG4gICAgICogbXV0YXRpb25zIGFuZCByYWlzaW5nIGV2ZW50cyBmb3IgYW55IGNoYW5nZXMgdGhpcyB3cml0ZSBjYXVzZWQuXHJcbiAgICAgKlxyXG4gICAgICogVGhlIHByb21pc2UgcmV0dXJuZWQgYnkgdGhpcyBjYWxsIGlzIHJlc29sdmVkIHdoZW4gdGhlIGFib3ZlIHN0ZXBzXHJcbiAgICAgKiBoYXZlIGNvbXBsZXRlZCwgKm5vdCogd2hlbiB0aGUgd3JpdGUgd2FzIGFja2VkIGJ5IHRoZSBiYWNrZW5kLiBUaGVcclxuICAgICAqIHVzZXJDYWxsYmFjayBpcyByZXNvbHZlZCBvbmNlIHRoZSB3cml0ZSB3YXMgYWNrZWQvcmVqZWN0ZWQgYnkgdGhlXHJcbiAgICAgKiBiYWNrZW5kIChvciBmYWlsZWQgbG9jYWxseSBmb3IgYW55IG90aGVyIHJlYXNvbikuXHJcbiAgICAgKi9cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKGJhdGNoLCB1c2VyQ2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuYXNzZXJ0U3Vic2NyaWJlZCgnd3JpdGUoKScpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgLmxvY2FsV3JpdGUoYmF0Y2gpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgX3RoaXMuc2hhcmVkQ2xpZW50U3RhdGUuYWRkUGVuZGluZ011dGF0aW9uKHJlc3VsdC5iYXRjaElkKTtcclxuICAgICAgICAgICAgX3RoaXMuYWRkTXV0YXRpb25DYWxsYmFjayhyZXN1bHQuYmF0Y2hJZCwgdXNlckNhbGxiYWNrKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUocmVzdWx0LmNoYW5nZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW90ZVN0b3JlLmZpbGxXcml0ZVBpcGVsaW5lKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gVE9ETyhrbGltdCk6IFdyYXAgdGhlIGdpdmVuIGVycm9yIGluIGEgc3RhbmRhcmQgRmlyZXN0b3JlIGVycm9yIG9iamVjdC5cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLndyYXBVcGRhdGVGdW5jdGlvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgcmV0dXJuIGVycm9yJCQxO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVGFrZXMgYW4gdXBkYXRlRnVuY3Rpb24gaW4gd2hpY2ggYSBzZXQgb2YgcmVhZHMgYW5kIHdyaXRlcyBjYW4gYmUgcGVyZm9ybWVkXHJcbiAgICAgKiBhdG9taWNhbGx5LiBJbiB0aGUgdXBkYXRlRnVuY3Rpb24sIHRoZSBjbGllbnQgY2FuIHJlYWQgYW5kIHdyaXRlIHZhbHVlc1xyXG4gICAgICogdXNpbmcgdGhlIHN1cHBsaWVkIHRyYW5zYWN0aW9uIG9iamVjdC4gQWZ0ZXIgdGhlIHVwZGF0ZUZ1bmN0aW9uLCBhbGxcclxuICAgICAqIGNoYW5nZXMgd2lsbCBiZSBjb21taXR0ZWQuIElmIHNvbWUgb3RoZXIgY2xpZW50IGhhcyBjaGFuZ2VkIGFueSBvZiB0aGUgZGF0YVxyXG4gICAgICogcmVmZXJlbmNlZCwgdGhlbiB0aGUgdXBkYXRlRnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgYWdhaW4uIElmIHRoZVxyXG4gICAgICogdXBkYXRlRnVuY3Rpb24gc3RpbGwgZmFpbHMgYWZ0ZXIgdGhlIGdpdmVuIG51bWJlciBvZiByZXRyaWVzLCB0aGVuIHRoZVxyXG4gICAgICogdHJhbnNhY3Rpb24gd2lsbCBiZSByZWplY3Rpb24uXHJcbiAgICAgKlxyXG4gICAgICogVGhlIHRyYW5zYWN0aW9uIG9iamVjdCBwYXNzZWQgdG8gdGhlIHVwZGF0ZUZ1bmN0aW9uIGNvbnRhaW5zIG1ldGhvZHMgZm9yXHJcbiAgICAgKiBhY2Nlc3NpbmcgZG9jdW1lbnRzIGFuZCBjb2xsZWN0aW9ucy4gVW5saWtlIG90aGVyIGRhdGFzdG9yZSBhY2Nlc3MsIGRhdGFcclxuICAgICAqIGFjY2Vzc2VkIHdpdGggdGhlIHRyYW5zYWN0aW9uIHdpbGwgbm90IHJlZmxlY3QgbG9jYWwgY2hhbmdlcyB0aGF0IGhhdmUgbm90XHJcbiAgICAgKiBiZWVuIGNvbW1pdHRlZC4gRm9yIHRoaXMgcmVhc29uLCBpdCBpcyByZXF1aXJlZCB0aGF0IGFsbCByZWFkcyBhcmVcclxuICAgICAqIHBlcmZvcm1lZCBiZWZvcmUgYW55IHdyaXRlcy4gVHJhbnNhY3Rpb25zIG11c3QgYmUgcGVyZm9ybWVkIHdoaWxlIG9ubGluZS5cclxuICAgICAqXHJcbiAgICAgKiBUaGUgcHJvbWlzZSByZXR1cm5lZCBpcyByZXNvbHZlZCB3aGVuIHRoZSB0cmFuc2FjdGlvbiBpcyBmdWxseSBjb21taXR0ZWQuXHJcbiAgICAgKi9cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnJ1blRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKHVwZGF0ZUZ1bmN0aW9uLCByZXRyaWVzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAocmV0cmllcyA9PT0gdm9pZCAwKSB7IHJldHJpZXMgPSA1OyB9XHJcbiAgICAgICAgYXNzZXJ0KHJldHJpZXMgPj0gMCwgJ0dvdCBuZWdhdGl2ZSBudW1iZXIgb2YgcmV0cmllcyBmb3IgdHJhbnNhY3Rpb24uJyk7XHJcbiAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gdGhpcy5yZW1vdGVTdG9yZS5jcmVhdGVUcmFuc2FjdGlvbigpO1xyXG4gICAgICAgIHZhciB3cmFwcGVkVXBkYXRlRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlclByb21pc2UgPSB1cGRhdGVGdW5jdGlvbih0cmFuc2FjdGlvbik7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQodXNlclByb21pc2UpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgIXVzZXJQcm9taXNlLmNhdGNoIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgIXVzZXJQcm9taXNlLnRoZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoRXJyb3IoJ1RyYW5zYWN0aW9uIGNhbGxiYWNrIG11c3QgcmV0dXJuIGEgUHJvbWlzZScpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyUHJvbWlzZS5jYXRjaChmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfdGhpcy53cmFwVXBkYXRlRnVuY3Rpb25FcnJvcihlKSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF90aGlzLndyYXBVcGRhdGVGdW5jdGlvbkVycm9yKGUpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHdyYXBwZWRVcGRhdGVGdW5jdGlvbigpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIC5jb21taXQoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXRyaWVzID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oa2xpbXQpOiBQdXQgaW4gYSByZXRyeSBkZWxheT9cclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5ydW5UcmFuc2FjdGlvbih1cGRhdGVGdW5jdGlvbiwgcmV0cmllcyAtIDEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5hcHBseVJlbW90ZUV2ZW50ID0gZnVuY3Rpb24gKHJlbW90ZUV2ZW50KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmFzc2VydFN1YnNjcmliZWQoJ2FwcGx5UmVtb3RlRXZlbnQoKScpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgLmFwcGx5UmVtb3RlRXZlbnQocmVtb3RlRXZlbnQpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChjaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBgcmVjZWl2ZWREb2N1bWVudGAgYXMgYXBwcm9wcmlhdGUgZm9yIGFueSBsaW1ibyB0YXJnZXRzLlxyXG4gICAgICAgICAgICBmb3JFYWNoKHJlbW90ZUV2ZW50LnRhcmdldENoYW5nZXMsIGZ1bmN0aW9uICh0YXJnZXRJZCwgdGFyZ2V0Q2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGltYm9SZXNvbHV0aW9uID0gX3RoaXMubGltYm9SZXNvbHV0aW9uc0J5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgIGlmIChsaW1ib1Jlc29sdXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTaW5jZSB0aGlzIGlzIGEgbGltYm8gcmVzb2x1dGlvbiBsb29rdXAsIGl0J3MgZm9yIGEgc2luZ2xlIGRvY3VtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYW5kIGl0IGNvdWxkIGJlIGFkZGVkLCBtb2RpZmllZCwgb3IgcmVtb3ZlZCwgYnV0IG5vdCBhIGNvbWJpbmF0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydCh0YXJnZXRDaGFuZ2UuYWRkZWREb2N1bWVudHMuc2l6ZSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldENoYW5nZS5tb2RpZmllZERvY3VtZW50cy5zaXplICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlLnJlbW92ZWREb2N1bWVudHMuc2l6ZSA8PVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAxLCAnTGltYm8gcmVzb2x1dGlvbiBmb3Igc2luZ2xlIGRvY3VtZW50IGNvbnRhaW5zIG11bHRpcGxlIGNoYW5nZXMuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldENoYW5nZS5hZGRlZERvY3VtZW50cy5zaXplID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW1ib1Jlc29sdXRpb24ucmVjZWl2ZWREb2N1bWVudCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRhcmdldENoYW5nZS5tb2RpZmllZERvY3VtZW50cy5zaXplID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQobGltYm9SZXNvbHV0aW9uLnJlY2VpdmVkRG9jdW1lbnQsICdSZWNlaXZlZCBjaGFuZ2UgZm9yIGxpbWJvIHRhcmdldCBkb2N1bWVudCB3aXRob3V0IGFkZC4nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGFyZ2V0Q2hhbmdlLnJlbW92ZWREb2N1bWVudHMuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KGxpbWJvUmVzb2x1dGlvbi5yZWNlaXZlZERvY3VtZW50LCAnUmVjZWl2ZWQgcmVtb3ZlIGZvciBsaW1ibyB0YXJnZXQgZG9jdW1lbnQgd2l0aG91dCBhZGQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWJvUmVzb2x1dGlvbi5yZWNlaXZlZERvY3VtZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHdhcyBwcm9iYWJseSBqdXN0IGEgQ1VSUkVOVCB0YXJnZXRDaGFuZ2Ugb3Igc2ltaWxhci5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShjaGFuZ2VzLCByZW1vdGVFdmVudCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIF90aGlzLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhlcnIpOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFwcGxpZXMgYW4gT25saW5lU3RhdGUgY2hhbmdlIHRvIHRoZSBzeW5jIGVuZ2luZSBhbmQgbm90aWZpZXMgYW55IHZpZXdzIG9mXHJcbiAgICAgKiB0aGUgY2hhbmdlLlxyXG4gICAgICovXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5hcHBseU9ubGluZVN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlLCBzb3VyY2UpIHtcclxuICAgICAgICAvLyBJZiB3ZSBhcmUgdGhlIHNlY29uZGFyeSBjbGllbnQsIHdlIGV4cGxpY2l0bHkgaWdub3JlIHRoZSByZW1vdGUgc3RvcmUnc1xyXG4gICAgICAgIC8vIG9ubGluZSBzdGF0ZSAodGhlIGxvY2FsIGNsaWVudCBtYXkgZ28gb2ZmbGluZSwgZXZlbiB0aG91Z2ggdGhlIHByaW1hcnlcclxuICAgICAgICAvLyB0YWIgcmVtYWlucyBvbmxpbmUpIGFuZCBvbmx5IGFwcGx5IHRoZSBwcmltYXJ5IHRhYidzIG9ubGluZSBzdGF0ZSBmcm9tXHJcbiAgICAgICAgLy8gU2hhcmVkQ2xpZW50U3RhdGUuXHJcbiAgICAgICAgaWYgKCh0aGlzLmlzUHJpbWFyeSAmJiBzb3VyY2UgPT09IE9ubGluZVN0YXRlU291cmNlLlJlbW90ZVN0b3JlKSB8fFxyXG4gICAgICAgICAgICAoIXRoaXMuaXNQcmltYXJ5ICYmIHNvdXJjZSA9PT0gT25saW5lU3RhdGVTb3VyY2UuU2hhcmVkQ2xpZW50U3RhdGUpKSB7XHJcbiAgICAgICAgICAgIHZhciBuZXdWaWV3U25hcHNob3RzXzEgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5xdWVyeVZpZXdzQnlRdWVyeS5mb3JFYWNoKGZ1bmN0aW9uIChxdWVyeSwgcXVlcnlWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlld0NoYW5nZSA9IHF1ZXJ5Vmlldy52aWV3LmFwcGx5T25saW5lU3RhdGVDaGFuZ2Uob25saW5lU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KHZpZXdDaGFuZ2UubGltYm9DaGFuZ2VzLmxlbmd0aCA9PT0gMCwgJ09ubGluZVN0YXRlIHNob3VsZCBub3QgYWZmZWN0IGxpbWJvIGRvY3VtZW50cy4nKTtcclxuICAgICAgICAgICAgICAgIGlmICh2aWV3Q2hhbmdlLnNuYXBzaG90KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3Vmlld1NuYXBzaG90c18xLnB1c2godmlld0NoYW5nZS5zbmFwc2hvdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lci5vbk9ubGluZVN0YXRlQ2hhbmdlKG9ubGluZVN0YXRlKTtcclxuICAgICAgICAgICAgdGhpcy5zeW5jRW5naW5lTGlzdGVuZXIub25XYXRjaENoYW5nZShuZXdWaWV3U25hcHNob3RzXzEpO1xyXG4gICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gb25saW5lU3RhdGU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zZXRPbmxpbmVTdGF0ZShvbmxpbmVTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUucmVqZWN0TGlzdGVuID0gZnVuY3Rpb24gKHRhcmdldElkLCBlcnIpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGxpbWJvUmVzb2x1dGlvbiwgbGltYm9LZXksIGRvY3VtZW50VXBkYXRlcywgcmVzb2x2ZWRMaW1ib0RvY3VtZW50cywgZXZlbnRfMSwgcXVlcnlWaWV3XzE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRTdWJzY3JpYmVkKCdyZWplY3RMaXN0ZW5zKCknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKHRhcmdldElkLCAncmVqZWN0ZWQnLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW1ib1Jlc29sdXRpb24gPSB0aGlzLmxpbWJvUmVzb2x1dGlvbnNCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWJvS2V5ID0gbGltYm9SZXNvbHV0aW9uICYmIGxpbWJvUmVzb2x1dGlvbi5rZXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGltYm9LZXkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTaW5jZSB0aGlzIHF1ZXJ5IGZhaWxlZCwgd2Ugd29uJ3Qgd2FudCB0byBtYW51YWxseSB1bmxpc3RlbiB0byBpdC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU28gZ28gYWhlYWQgYW5kIHJlbW92ZSBpdCBmcm9tIGJvb2trZWVwaW5nLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5ID0gdGhpcy5saW1ib1RhcmdldHNCeUtleS5yZW1vdmUobGltYm9LZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5saW1ib1Jlc29sdXRpb25zQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudFVwZGF0ZXMgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudFVwZGF0ZXMgPSBkb2N1bWVudFVwZGF0ZXMuaW5zZXJ0KGxpbWJvS2V5LCBuZXcgTm9Eb2N1bWVudChsaW1ib0tleSwgU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlZExpbWJvRG9jdW1lbnRzID0gZG9jdW1lbnRLZXlTZXQoKS5hZGQobGltYm9LZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudF8xID0gbmV3IFJlbW90ZUV2ZW50KFNuYXBzaG90VmVyc2lvbi5NSU4sIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvKiB0YXJnZXRDaGFuZ2VzPSAqLyB7fSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHRhcmdldE1pc21hdGNoZXM9ICovIG5ldyBTb3J0ZWRTZXQocHJpbWl0aXZlQ29tcGFyYXRvciksIGRvY3VtZW50VXBkYXRlcywgcmVzb2x2ZWRMaW1ib0RvY3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmFwcGx5UmVtb3RlRXZlbnQoZXZlbnRfMSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlWaWV3XzEgPSB0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCghIXF1ZXJ5Vmlld18xLCAnVW5rbm93biB0YXJnZXRJZDogJyArIHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbGVhc2VRdWVyeShxdWVyeVZpZXdfMS5xdWVyeSwgLyoga2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YSAqLyBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5yZW1vdmVBbmRDbGVhbnVwUXVlcnkocXVlcnlWaWV3XzEpOyB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBfdGhpcy5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZXJyKTsgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lci5vbldhdGNoRXJyb3IocXVlcnlWaWV3XzEucXVlcnksIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuYXBwbHlCYXRjaFN0YXRlID0gZnVuY3Rpb24gKGJhdGNoSWQsIGJhdGNoU3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkb2N1bWVudHM7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRTdWJzY3JpYmVkKCdhcHBseUJhdGNoU3RhdGUoKScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUubG9va3VwTXV0YXRpb25Eb2N1bWVudHMoYmF0Y2hJZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRzID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRzID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBIHRocm90dGxlZCB0YWIgbWF5IG5vdCBoYXZlIHNlZW4gdGhlIG11dGF0aW9uIGJlZm9yZSBpdCB3YXMgY29tcGxldGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgcmVtb3ZlZCBmcm9tIHRoZSBtdXRhdGlvbiBxdWV1ZSwgaW4gd2hpY2ggY2FzZSB3ZSB3b24ndCBoYXZlIGNhY2hlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGFmZmVjdGVkIGRvY3VtZW50cy4gSW4gdGhpcyBjYXNlIHdlIGNhbiBzYWZlbHkgaWdub3JlIHRoZSB1cGRhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNpbmNlIHRoYXQgbWVhbnMgd2UgZGlkbid0IGFwcGx5IHRoZSBtdXRhdGlvbiBsb2NhbGx5IGF0IGFsbCAoaWYgd2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhZCwgd2Ugd291bGQgaGF2ZSBjYWNoZWQgdGhlIGFmZmVjdGVkIGRvY3VtZW50cyksIGFuZCBzbyB3ZSB3aWxsIGp1c3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlZSBhbnkgcmVzdWx0aW5nIGRvY3VtZW50IGNoYW5nZXMgdmlhIG5vcm1hbCByZW1vdGUgZG9jdW1lbnQgdXBkYXRlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXMgYXBwbGljYWJsZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckOSwgJ0Nhbm5vdCBhcHBseSBtdXRhdGlvbiBiYXRjaCB3aXRoIGlkOiAnICsgYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoYmF0Y2hTdGF0ZSA9PT0gJ3BlbmRpbmcnKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIGFyZSB0aGUgcHJpbWFyeSBjbGllbnQsIHdlIG5lZWQgdG8gc2VuZCB0aGlzIHdyaXRlIHRvIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBiYWNrZW5kLiBTZWNvbmRhcnkgY2xpZW50cyB3aWxsIGlnbm9yZSB0aGVzZSB3cml0ZXMgc2luY2UgdGhlaXIgcmVtb3RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbm5lY3Rpb24gaXMgZGlzYWJsZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVtb3RlU3RvcmUuZmlsbFdyaXRlUGlwZWxpbmUoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSBhcmUgdGhlIHByaW1hcnkgY2xpZW50LCB3ZSBuZWVkIHRvIHNlbmQgdGhpcyB3cml0ZSB0byB0aGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmFja2VuZC4gU2Vjb25kYXJ5IGNsaWVudHMgd2lsbCBpZ25vcmUgdGhlc2Ugd3JpdGVzIHNpbmNlIHRoZWlyIHJlbW90ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25uZWN0aW9uIGlzIGRpc2FibGVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJhdGNoU3RhdGUgPT09ICdhY2tub3dsZWRnZWQnIHx8IGJhdGNoU3RhdGUgPT09ICdyZWplY3RlZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IEJvdGggdGhlc2UgbWV0aG9kcyBhcmUgbm8tb3BzIGZvciBiYXRjaGVzIHRoYXQgb3JpZ2luYXRlZCBmcm9tXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvdGhlciBjbGllbnRzLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzVXNlckNhbGxiYWNrKGJhdGNoSWQsIGVycm9yJCQxID8gZXJyb3IkJDEgOiBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9jYWxTdG9yZS5yZW1vdmVDYWNoZWRNdXRhdGlvbkJhdGNoTWV0YWRhdGEoYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlsKFwiVW5rbm93biBiYXRjaFN0YXRlOiBcIiArIGJhdGNoU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNDtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShkb2N1bWVudHMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5hcHBseVN1Y2Nlc3NmdWxXcml0ZSA9IGZ1bmN0aW9uIChtdXRhdGlvbkJhdGNoUmVzdWx0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmFzc2VydFN1YnNjcmliZWQoJ2FwcGx5U3VjY2Vzc2Z1bFdyaXRlKCknKTtcclxuICAgICAgICB2YXIgYmF0Y2hJZCA9IG11dGF0aW9uQmF0Y2hSZXN1bHQuYmF0Y2guYmF0Y2hJZDtcclxuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgbWF5IG9yIG1heSBub3QgYmUgYWJsZSB0byBhcHBseSB0aGUgd3JpdGUgcmVzdWx0IGFuZFxyXG4gICAgICAgIC8vIHJhaXNlIGV2ZW50cyBpbW1lZGlhdGVseSAoZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlIHdhdGNoZXIgaXMgY2F1Z2h0XHJcbiAgICAgICAgLy8gdXApLCBzbyB3ZSByYWlzZSB1c2VyIGNhbGxiYWNrcyBmaXJzdCBzbyB0aGF0IHRoZXkgY29uc2lzdGVudGx5IGhhcHBlblxyXG4gICAgICAgIC8vIGJlZm9yZSBsaXN0ZW4gZXZlbnRzLlxyXG4gICAgICAgIHRoaXMucHJvY2Vzc1VzZXJDYWxsYmFjayhiYXRjaElkLCAvKmVycm9yPSovIG51bGwpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgLmFja25vd2xlZGdlQmF0Y2gobXV0YXRpb25CYXRjaFJlc3VsdClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGNoYW5nZXMpIHtcclxuICAgICAgICAgICAgX3RoaXMuc2hhcmVkQ2xpZW50U3RhdGUudXBkYXRlTXV0YXRpb25TdGF0ZShiYXRjaElkLCAnYWNrbm93bGVkZ2VkJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5lbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKGNoYW5nZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBfdGhpcy5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZXJyKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUucmVqZWN0RmFpbGVkV3JpdGUgPSBmdW5jdGlvbiAoYmF0Y2hJZCwgZXJyb3IkJDEpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuYXNzZXJ0U3Vic2NyaWJlZCgncmVqZWN0RmFpbGVkV3JpdGUoKScpO1xyXG4gICAgICAgIC8vIFRoZSBsb2NhbCBzdG9yZSBtYXkgb3IgbWF5IG5vdCBiZSBhYmxlIHRvIGFwcGx5IHRoZSB3cml0ZSByZXN1bHQgYW5kXHJcbiAgICAgICAgLy8gcmFpc2UgZXZlbnRzIGltbWVkaWF0ZWx5IChkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgd2F0Y2hlciBpcyBjYXVnaHQgdXApLFxyXG4gICAgICAgIC8vIHNvIHdlIHJhaXNlIHVzZXIgY2FsbGJhY2tzIGZpcnN0IHNvIHRoYXQgdGhleSBjb25zaXN0ZW50bHkgaGFwcGVuIGJlZm9yZVxyXG4gICAgICAgIC8vIGxpc3RlbiBldmVudHMuXHJcbiAgICAgICAgdGhpcy5wcm9jZXNzVXNlckNhbGxiYWNrKGJhdGNoSWQsIGVycm9yJCQxKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgIC5yZWplY3RCYXRjaChiYXRjaElkKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoY2hhbmdlcykge1xyXG4gICAgICAgICAgICBfdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKGJhdGNoSWQsICdyZWplY3RlZCcsIGVycm9yJCQxKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUoY2hhbmdlcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIF90aGlzLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhlcnIpOyB9KTtcclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5hZGRNdXRhdGlvbkNhbGxiYWNrID0gZnVuY3Rpb24gKGJhdGNoSWQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIG5ld0NhbGxiYWNrcyA9IHRoaXMubXV0YXRpb25Vc2VyQ2FsbGJhY2tzW3RoaXMuY3VycmVudFVzZXIudG9LZXkoKV07XHJcbiAgICAgICAgaWYgKCFuZXdDYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgbmV3Q2FsbGJhY2tzID0gbmV3IFNvcnRlZE1hcChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbmV3Q2FsbGJhY2tzID0gbmV3Q2FsbGJhY2tzLmluc2VydChiYXRjaElkLCBjYWxsYmFjayk7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblVzZXJDYWxsYmFja3NbdGhpcy5jdXJyZW50VXNlci50b0tleSgpXSA9IG5ld0NhbGxiYWNrcztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlc29sdmVzIG9yIHJlamVjdHMgdGhlIHVzZXIgY2FsbGJhY2sgZm9yIHRoZSBnaXZlbiBiYXRjaCBhbmQgdGhlbiBkaXNjYXJkc1xyXG4gICAgICogaXQuXHJcbiAgICAgKi9cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnByb2Nlc3NVc2VyQ2FsbGJhY2sgPSBmdW5jdGlvbiAoYmF0Y2hJZCwgZXJyb3IkJDEpIHtcclxuICAgICAgICB2YXIgbmV3Q2FsbGJhY2tzID0gdGhpcy5tdXRhdGlvblVzZXJDYWxsYmFja3NbdGhpcy5jdXJyZW50VXNlci50b0tleSgpXTtcclxuICAgICAgICAvLyBOT1RFOiBNdXRhdGlvbnMgcmVzdG9yZWQgZnJvbSBwZXJzaXN0ZW5jZSB3b24ndCBoYXZlIGNhbGxiYWNrcywgc28gaXQnc1xyXG4gICAgICAgIC8vIG9rYXkgZm9yIHRoZXJlIHRvIGJlIG5vIGNhbGxiYWNrIGZvciB0aGlzIElELlxyXG4gICAgICAgIGlmIChuZXdDYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gbmV3Q2FsbGJhY2tzLmdldChiYXRjaElkKTtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoYmF0Y2hJZCA9PT0gbmV3Q2FsbGJhY2tzLm1pbktleSgpLCAnTXV0YXRpb24gY2FsbGJhY2tzIHByb2Nlc3NlZCBvdXQtb2Ytb3JkZXI/Jyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IkJDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5yZWplY3QoZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbmV3Q2FsbGJhY2tzID0gbmV3Q2FsbGJhY2tzLnJlbW92ZShiYXRjaElkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uVXNlckNhbGxiYWNrc1t0aGlzLmN1cnJlbnRVc2VyLnRvS2V5KCldID0gbmV3Q2FsbGJhY2tzO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5yZW1vdmVBbmRDbGVhbnVwUXVlcnkgPSBmdW5jdGlvbiAocXVlcnlWaWV3KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlLnJlbW92ZUxvY2FsUXVlcnlUYXJnZXQocXVlcnlWaWV3LnRhcmdldElkKTtcclxuICAgICAgICB0aGlzLnF1ZXJ5Vmlld3NCeVF1ZXJ5LmRlbGV0ZShxdWVyeVZpZXcucXVlcnkpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldFtxdWVyeVZpZXcudGFyZ2V0SWRdO1xyXG4gICAgICAgIGlmICh0aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICB2YXIgbGltYm9LZXlzID0gdGhpcy5saW1ib0RvY3VtZW50UmVmcy5yZWZlcmVuY2VzRm9ySWQocXVlcnlWaWV3LnRhcmdldElkKTtcclxuICAgICAgICAgICAgdGhpcy5saW1ib0RvY3VtZW50UmVmcy5yZW1vdmVSZWZlcmVuY2VzRm9ySWQocXVlcnlWaWV3LnRhcmdldElkKTtcclxuICAgICAgICAgICAgbGltYm9LZXlzLmZvckVhY2goZnVuY3Rpb24gKGxpbWJvS2V5KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNSZWZlcmVuY2VkID0gX3RoaXMubGltYm9Eb2N1bWVudFJlZnMuY29udGFpbnNLZXkobGltYm9LZXkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpc1JlZmVyZW5jZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSByZW1vdmVkIHRoZSBsYXN0IHJlZmVyZW5jZSBmb3IgdGhpcyBrZXlcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdmVMaW1ib1RhcmdldChsaW1ib0tleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5yZW1vdmVMaW1ib1RhcmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgdGhlIHRhcmdldCBhbHJlYWR5IGdvdCByZW1vdmVkIGJlY2F1c2UgdGhlIHF1ZXJ5IGZhaWxlZC4gSW4gdGhhdCBjYXNlLFxyXG4gICAgICAgIC8vIHRoZSBrZXkgd29uJ3QgZXhpc3QgaW4gYGxpbWJvVGFyZ2V0c0J5S2V5YC4gT25seSBkbyB0aGUgY2xlYW51cCBpZiB3ZSBzdGlsbCBoYXZlIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgdmFyIGxpbWJvVGFyZ2V0SWQgPSB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5LmdldChrZXkpO1xyXG4gICAgICAgIGlmIChsaW1ib1RhcmdldElkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgdGFyZ2V0IGFscmVhZHkgZ290IHJlbW92ZWQsIGJlY2F1c2UgdGhlIHF1ZXJ5IGZhaWxlZC5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLnVubGlzdGVuKGxpbWJvVGFyZ2V0SWQpO1xyXG4gICAgICAgIHRoaXMubGltYm9UYXJnZXRzQnlLZXkgPSB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5LnJlbW92ZShrZXkpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmxpbWJvUmVzb2x1dGlvbnNCeVRhcmdldFtsaW1ib1RhcmdldElkXTtcclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS51cGRhdGVUcmFja2VkTGltYm9zID0gZnVuY3Rpb24gKHRhcmdldElkLCBsaW1ib0NoYW5nZXMpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGxpbWJvQ2hhbmdlc18xID0gbGltYm9DaGFuZ2VzOyBfaSA8IGxpbWJvQ2hhbmdlc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgbGltYm9DaGFuZ2UgPSBsaW1ib0NoYW5nZXNfMVtfaV07XHJcbiAgICAgICAgICAgIGlmIChsaW1ib0NoYW5nZSBpbnN0YW5jZW9mIEFkZGVkTGltYm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saW1ib0RvY3VtZW50UmVmcy5hZGRSZWZlcmVuY2UobGltYm9DaGFuZ2Uua2V5LCB0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWNrTGltYm9DaGFuZ2UobGltYm9DaGFuZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGxpbWJvQ2hhbmdlIGluc3RhbmNlb2YgUmVtb3ZlZExpbWJvRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckOSwgJ0RvY3VtZW50IG5vIGxvbmdlciBpbiBsaW1ibzogJyArIGxpbWJvQ2hhbmdlLmtleSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpbWJvRG9jdW1lbnRSZWZzLnJlbW92ZVJlZmVyZW5jZShsaW1ib0NoYW5nZS5rZXksIHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIHZhciBpc1JlZmVyZW5jZWQgPSB0aGlzLmxpbWJvRG9jdW1lbnRSZWZzLmNvbnRhaW5zS2V5KGxpbWJvQ2hhbmdlLmtleSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzUmVmZXJlbmNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIHJlbW92ZWQgdGhlIGxhc3QgcmVmZXJlbmNlIGZvciB0aGlzIGtleVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlTGltYm9UYXJnZXQobGltYm9DaGFuZ2Uua2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZhaWwoJ1Vua25vd24gbGltYm8gY2hhbmdlOiAnICsgSlNPTi5zdHJpbmdpZnkobGltYm9DaGFuZ2UpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS50cmFja0xpbWJvQ2hhbmdlID0gZnVuY3Rpb24gKGxpbWJvQ2hhbmdlKSB7XHJcbiAgICAgICAgdmFyIGtleSA9IGxpbWJvQ2hhbmdlLmtleTtcclxuICAgICAgICBpZiAoIXRoaXMubGltYm9UYXJnZXRzQnlLZXkuZ2V0KGtleSkpIHtcclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ5LCAnTmV3IGRvY3VtZW50IGluIGxpbWJvOiAnICsga2V5KTtcclxuICAgICAgICAgICAgdmFyIGxpbWJvVGFyZ2V0SWQgPSB0aGlzLmxpbWJvVGFyZ2V0SWRHZW5lcmF0b3IubmV4dCgpO1xyXG4gICAgICAgICAgICB2YXIgcXVlcnkgPSBRdWVyeS5hdFBhdGgoa2V5LnBhdGgpO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWJvUmVzb2x1dGlvbnNCeVRhcmdldFtsaW1ib1RhcmdldElkXSA9IG5ldyBMaW1ib1Jlc29sdXRpb24oa2V5KTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdGVTdG9yZS5saXN0ZW4obmV3IFF1ZXJ5RGF0YShxdWVyeSwgbGltYm9UYXJnZXRJZCwgUXVlcnlQdXJwb3NlLkxpbWJvUmVzb2x1dGlvbiwgTGlzdGVuU2VxdWVuY2UuSU5WQUxJRCkpO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5ID0gdGhpcy5saW1ib1RhcmdldHNCeUtleS5pbnNlcnQoa2V5LCBsaW1ib1RhcmdldElkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuY3VycmVudExpbWJvRG9jcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5saW1ib1RhcmdldHNCeUtleTtcclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5lbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlID0gZnVuY3Rpb24gKGNoYW5nZXMsIHJlbW90ZUV2ZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBuZXdTbmFwcywgZG9jQ2hhbmdlc0luQWxsVmlld3MsIHF1ZXJpZXNQcm9jZXNzZWQ7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3U25hcHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jQ2hhbmdlc0luQWxsVmlld3MgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcmllc1Byb2Nlc3NlZCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5Vmlld3NCeVF1ZXJ5LmZvckVhY2goZnVuY3Rpb24gKF8sIHF1ZXJ5Vmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcmllc1Byb2Nlc3NlZC5wdXNoKFByb21pc2UucmVzb2x2ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aWV3RG9jQ2hhbmdlcyA9IHF1ZXJ5Vmlldy52aWV3LmNvbXB1dGVEb2NDaGFuZ2VzKGNoYW5nZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdmlld0RvY0NoYW5nZXMubmVlZHNSZWZpbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdEb2NDaGFuZ2VzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcXVlcnkgaGFzIGEgbGltaXQgYW5kIHNvbWUgZG9jcyB3ZXJlIHJlbW92ZWQsIHNvIHdlIG5lZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0byByZS1ydW4gdGhlIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHN0b3JlIHRvIG1ha2Ugc3VyZSB3ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZG4ndCBsb3NlIGFueSBnb29kIGRvY3MgdGhhdCBoYWQgYmVlbiBwYXN0IHRoZSBsaW1pdC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxTdG9yZS5leGVjdXRlUXVlcnkocXVlcnlWaWV3LnF1ZXJ5KS50aGVuKGZ1bmN0aW9uIChkb2NzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeVZpZXcudmlldy5jb21wdXRlRG9jQ2hhbmdlcyhkb2NzLCB2aWV3RG9jQ2hhbmdlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh2aWV3RG9jQ2hhbmdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRDaGFuZ2UgPSByZW1vdGVFdmVudCAmJiByZW1vdGVFdmVudC50YXJnZXRDaGFuZ2VzW3F1ZXJ5Vmlldy50YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpZXdDaGFuZ2UgPSBxdWVyeVZpZXcudmlldy5hcHBseUNoYW5nZXModmlld0RvY0NoYW5nZXMsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyBfdGhpcy5pc1ByaW1hcnkgPT09IHRydWUsIHRhcmdldENoYW5nZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlVHJhY2tlZExpbWJvcyhxdWVyeVZpZXcudGFyZ2V0SWQsIHZpZXdDaGFuZ2UubGltYm9DaGFuZ2VzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlld0NoYW5nZS5zbmFwc2hvdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKHF1ZXJ5Vmlldy50YXJnZXRJZCwgdmlld0NoYW5nZS5zbmFwc2hvdC5mcm9tQ2FjaGUgPyAnbm90LWN1cnJlbnQnIDogJ2N1cnJlbnQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdTbmFwcy5wdXNoKHZpZXdDaGFuZ2Uuc25hcHNob3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG9jQ2hhbmdlcyA9IExvY2FsVmlld0NoYW5nZXMuZnJvbVNuYXBzaG90KHF1ZXJ5Vmlldy50YXJnZXRJZCwgdmlld0NoYW5nZS5zbmFwc2hvdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY0NoYW5nZXNJbkFsbFZpZXdzLnB1c2goZG9jQ2hhbmdlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwocXVlcmllc1Byb2Nlc3NlZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lci5vbldhdGNoQ2hhbmdlKG5ld1NuYXBzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLm5vdGlmeUxvY2FsVmlld0NoYW5nZXMoZG9jQ2hhbmdlc0luQWxsVmlld3MpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFZlcmlmaWVzIHRoZSBlcnJvciB0aHJvd24gYnkgYW4gTG9jYWxTdG9yZSBvcGVyYXRpb24uIElmIGEgTG9jYWxTdG9yZVxyXG4gICAgICogb3BlcmF0aW9uIGZhaWxzIGJlY2F1c2UgdGhlIHByaW1hcnkgbGVhc2UgaGFzIGJlZW4gdGFrZW4gYnkgYW5vdGhlciBjbGllbnQsXHJcbiAgICAgKiB3ZSBpZ25vcmUgdGhlIGVycm9yICh0aGUgcGVyc2lzdGVuY2UgbGF5ZXIgd2lsbCBpbW1lZGlhdGVseSBjYWxsXHJcbiAgICAgKiBgYXBwbHlQcmltYXJ5TGVhc2VgIHRvIHByb3BhZ2F0ZSB0aGUgcHJpbWFyeSBzdGF0ZSBjaGFuZ2UpLiBBbGwgb3RoZXJcclxuICAgICAqIGVycm9ycyBhcmUgcmUtdGhyb3duLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBlcnIgQW4gZXJyb3IgcmV0dXJuZWQgYnkgYSBMb2NhbFN0b3JlIG9wZXJhdGlvbi5cclxuICAgICAqIEByZXR1cm4gQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgYWZ0ZXIgd2UgcmVjb3ZlcmVkLCBvciB0aGUgb3JpZ2luYWwgZXJyb3IuXHJcbiAgICAgKi9cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNQcmltYXJ5TGVhc2VMb3N0RXJyb3IoZXJyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckOSwgJ1VuZXhwZWN0ZWRseSBsb3N0IHByaW1hcnkgbGVhc2UnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuYXNzZXJ0U3Vic2NyaWJlZCA9IGZ1bmN0aW9uIChmbk5hbWUpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5zeW5jRW5naW5lTGlzdGVuZXIgIT09IG51bGwsICdUcnlpbmcgdG8gY2FsbCAnICsgZm5OYW1lICsgJyBiZWZvcmUgY2FsbGluZyBzdWJzY3JpYmUoKS4nKTtcclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlID0gZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHVzZXJDaGFuZ2VkLCByZXN1bHQ7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlckNoYW5nZWQgPSAhdGhpcy5jdXJyZW50VXNlci5pc0VxdWFsKHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gdXNlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF1c2VyQ2hhbmdlZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5oYW5kbGVVc2VyQ2hhbmdlKHVzZXIpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhiLzExNDIyNjQxNyk6IENvbnNpZGVyIGNhbGxpbmcgdGhpcyBvbmx5IGluIHRoZSBwcmltYXJ5IHRhYi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5oYW5kbGVVc2VyQ2hhbmdlKHVzZXIsIHJlc3VsdC5yZW1vdmVkQmF0Y2hJZHMsIHJlc3VsdC5hZGRlZEJhdGNoSWRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKHJlc3VsdC5hZmZlY3RlZERvY3VtZW50cyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlbW90ZVN0b3JlLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuYXBwbHlQcmltYXJ5U3RhdGUgPSBmdW5jdGlvbiAoaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBhY3RpdmVUYXJnZXRzLCBhY3RpdmVRdWVyaWVzLCBfaSwgYWN0aXZlUXVlcmllc18xLCBxdWVyeURhdGEsIGFjdGl2ZVRhcmdldHNfMSwgcF8xO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGlzUHJpbWFyeSA9PT0gdHJ1ZSAmJiB0aGlzLmlzUHJpbWFyeSAhPT0gdHJ1ZSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzUHJpbWFyeSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVtb3RlU3RvcmUuYXBwbHlQcmltYXJ5U3RhdGUodHJ1ZSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVUYXJnZXRzID0gdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5nZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zeW5jaHJvbml6ZVF1ZXJ5Vmlld3NBbmRSYWlzZVNuYXBzaG90cyhhY3RpdmVUYXJnZXRzLnRvQXJyYXkoKSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlUXVlcmllcyA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChfaSA9IDAsIGFjdGl2ZVF1ZXJpZXNfMSA9IGFjdGl2ZVF1ZXJpZXM7IF9pIDwgYWN0aXZlUXVlcmllc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlEYXRhID0gYWN0aXZlUXVlcmllc18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3RlU3RvcmUubGlzdGVuKHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpc1ByaW1hcnkgPT09IGZhbHNlICYmIHRoaXMuaXNQcmltYXJ5ICE9PSBmYWxzZSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzUHJpbWFyeSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVUYXJnZXRzXzEgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcF8xID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvckVhY2hOdW1iZXIodGhpcy5xdWVyeVZpZXdzQnlUYXJnZXQsIGZ1bmN0aW9uICh0YXJnZXRJZCwgcXVlcnlWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc2hhcmVkQ2xpZW50U3RhdGUuaXNMb2NhbFF1ZXJ5VGFyZ2V0KHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhcmdldHNfMS5wdXNoKHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBfMSA9IHBfMS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnVubGlzdGVuKHF1ZXJ5Vmlldy5xdWVyeSk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVtb3RlU3RvcmUudW5saXN0ZW4ocXVlcnlWaWV3LnRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBfMV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc3luY2hyb25pemVRdWVyeVZpZXdzQW5kUmFpc2VTbmFwc2hvdHMoYWN0aXZlVGFyZ2V0c18xKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRMaW1ib0RvY3VtZW50cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlbW90ZVN0b3JlLmFwcGx5UHJpbWFyeVN0YXRlKGZhbHNlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnJlc2V0TGltYm9Eb2N1bWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBmb3JFYWNoTnVtYmVyKHRoaXMubGltYm9SZXNvbHV0aW9uc0J5VGFyZ2V0LCBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgX3RoaXMucmVtb3RlU3RvcmUudW5saXN0ZW4odGFyZ2V0SWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubGltYm9Eb2N1bWVudFJlZnMucmVtb3ZlQWxsUmVmZXJlbmNlcygpO1xyXG4gICAgICAgIHRoaXMubGltYm9SZXNvbHV0aW9uc0J5VGFyZ2V0ID0gW107XHJcbiAgICAgICAgdGhpcy5saW1ib1RhcmdldHNCeUtleSA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZWNvbmNpbGUgdGhlIHF1ZXJ5IHZpZXdzIG9mIHRoZSBwcm92aWRlZCBxdWVyeSB0YXJnZXRzIHdpdGggdGhlIHN0YXRlIGZyb21cclxuICAgICAqIHBlcnNpc3RlbmNlLiBSYWlzZXMgc25hcHNob3RzIGZvciBhbnkgY2hhbmdlcyB0aGF0IGFmZmVjdCB0aGUgbG9jYWxcclxuICAgICAqIGNsaWVudCBhbmQgcmV0dXJucyB0aGUgdXBkYXRlZCBzdGF0ZSBvZiBhbGwgdGFyZ2V0J3MgcXVlcnkgZGF0YS5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnN5bmNocm9uaXplUXVlcnlWaWV3c0FuZFJhaXNlU25hcHNob3RzID0gZnVuY3Rpb24gKHRhcmdldHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBwID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgdmFyIGFjdGl2ZVF1ZXJpZXMgPSBbXTtcclxuICAgICAgICB2YXIgbmV3Vmlld1NuYXBzaG90cyA9IFtdO1xyXG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgIHAgPSBwLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnlEYXRhLCBxdWVyeVZpZXcsIHZpZXdDaGFuZ2UsIHF1ZXJ5O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVZpZXcgPSB0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5VmlldykgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3IgcXVlcmllcyB0aGF0IGhhdmUgYSBsb2NhbCBWaWV3LCB3ZSBuZWVkIHRvIHVwZGF0ZSB0aGVpciBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW4gTG9jYWxTdG9yZSAoYXMgdGhlIHJlc3VtZSB0b2tlbiBhbmQgdGhlIHNuYXBzaG90IHZlcnNpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1pZ2h0IGhhdmUgY2hhbmdlZCkgYW5kIHJlY29uY2lsZSB0aGVpciB2aWV3cyB3aXRoIHRoZSBwZXJzaXN0ZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXRlICh0aGUgbGlzdCBvZiBzeW5jZWREb2N1bWVudHMgbWF5IGhhdmUgZ290dGVuIG91dCBvZiBzeW5jKS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5yZWxlYXNlUXVlcnkocXVlcnlWaWV3LnF1ZXJ5LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKmtlZXBQZXJzaXN0ZWRRdWVyeURhdGE9Ki8gdHJ1ZSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3IgcXVlcmllcyB0aGF0IGhhdmUgYSBsb2NhbCBWaWV3LCB3ZSBuZWVkIHRvIHVwZGF0ZSB0aGVpciBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW4gTG9jYWxTdG9yZSAoYXMgdGhlIHJlc3VtZSB0b2tlbiBhbmQgdGhlIHNuYXBzaG90IHZlcnNpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1pZ2h0IGhhdmUgY2hhbmdlZCkgYW5kIHJlY29uY2lsZSB0aGVpciB2aWV3cyB3aXRoIHRoZSBwZXJzaXN0ZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXRlICh0aGUgbGlzdCBvZiBzeW5jZWREb2N1bWVudHMgbWF5IGhhdmUgZ290dGVuIG91dCBvZiBzeW5jKS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5hbGxvY2F0ZVF1ZXJ5KHF1ZXJ5Vmlldy5xdWVyeSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeURhdGEgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnN5bmNocm9uaXplVmlld0FuZENvbXB1dGVTbmFwc2hvdChxdWVyeVZpZXcpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld0NoYW5nZSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Q2hhbmdlLnNuYXBzaG90KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Vmlld1NuYXBzaG90cy5wdXNoKHZpZXdDaGFuZ2Uuc25hcHNob3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCh0aGlzLmlzUHJpbWFyeSA9PT0gdHJ1ZSwgJ0Egc2Vjb25kYXJ5IHRhYiBzaG91bGQgbmV2ZXIgaGF2ZSBhbiBhY3RpdmUgcXVlcnkgd2l0aG91dCBhbiBhY3RpdmUgdmlldy4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5nZXRRdWVyeUZvclRhcmdldCh0YXJnZXRJZCldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCghIXF1ZXJ5LCBcIlF1ZXJ5IGRhdGEgZm9yIHRhcmdldCBcIiArIHRhcmdldElkICsgXCIgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmFsbG9jYXRlUXVlcnkocXVlcnkpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlEYXRhID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5pbml0aWFsaXplVmlld0FuZENvbXB1dGVTbmFwc2hvdChxdWVyeURhdGEsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qY3VycmVudD0qLyBmYWxzZSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVF1ZXJpZXMucHVzaChxdWVyeURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHRhcmdldHNfMSA9IHRhcmdldHM7IF9pIDwgdGFyZ2V0c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSB0YXJnZXRzXzFbX2ldO1xyXG4gICAgICAgICAgICBfbG9vcF8xKHRhcmdldElkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnN5bmNFbmdpbmVMaXN0ZW5lci5vbldhdGNoQ2hhbmdlKG5ld1ZpZXdTbmFwc2hvdHMpO1xyXG4gICAgICAgICAgICByZXR1cm4gYWN0aXZlUXVlcmllcztcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5nZXRBY3RpdmVDbGllbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmUuZ2V0QWN0aXZlQ2xpZW50cygpO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmFwcGx5VGFyZ2V0U3RhdGUgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIHN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgX2EsIHF1ZXJ5VmlldztcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIHJlY2VpdmUgYSB0YXJnZXQgc3RhdGUgbm90aWZpY2F0aW9uIHZpYSBXZWJTdG9yYWdlLCB3ZSBhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVpdGhlciBhbHJlYWR5IHNlY29uZGFyeSBvciBhbm90aGVyIHRhYiBoYXMgdGFrZW4gdGhlIHByaW1hcnkgbGVhc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDksICdJZ25vcmluZyB1bmV4cGVjdGVkIHF1ZXJ5IHN0YXRlIG5vdGlmaWNhdGlvbi4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0W3RhcmdldElkXSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gc3RhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2N1cnJlbnQnOiByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ25vdC1jdXJyZW50JzogcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyZWplY3RlZCc6IHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMubG9jYWxTdG9yZS5nZXROZXdEb2N1bWVudENoYW5nZXMoKS50aGVuKGZ1bmN0aW9uIChjaGFuZ2VzKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN5bnRoZXNpemVkUmVtb3RlRXZlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ludGhlc2l6ZWRSZW1vdGVFdmVudCA9IFJlbW90ZUV2ZW50LmNyZWF0ZVN5bnRoZXNpemVkUmVtb3RlRXZlbnRGb3JDdXJyZW50Q2hhbmdlKHRhcmdldElkLCBzdGF0ZSA9PT0gJ2N1cnJlbnQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKGNoYW5nZXMsIHN5bnRoZXNpemVkUmVtb3RlRXZlbnQpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSwgZnVuY3Rpb24gKGVycikgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3RpdmVUYXJnZXRzXzI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0RvY3VtZW50Q2hhbmdlTWlzc2luZ0Vycm9yKGVycikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVUYXJnZXRzXzIgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yRWFjaE51bWJlcih0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldCwgZnVuY3Rpb24gKHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZVRhcmdldHNfMi5wdXNoKHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnN5bmNocm9uaXplUXVlcnlWaWV3c0FuZFJhaXNlU25hcHNob3RzKGFjdGl2ZVRhcmdldHNfMildO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH0pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVZpZXcgPSB0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQW5kQ2xlYW51cFF1ZXJ5KHF1ZXJ5Vmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5yZWxlYXNlUXVlcnkocXVlcnlWaWV3LnF1ZXJ5LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qa2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YT0qLyB0cnVlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyLm9uV2F0Y2hFcnJvcihxdWVyeVZpZXcucXVlcnksIGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsKCdVbmV4cGVjdGVkIHRhcmdldCBzdGF0ZTogJyArIHN0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5hcHBseUFjdGl2ZVRhcmdldHNDaGFuZ2UgPSBmdW5jdGlvbiAoYWRkZWQsIHJlbW92ZWQpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIF9pLCBhZGRlZF8xLCB0YXJnZXRJZCwgcXVlcnksIHF1ZXJ5RGF0YSwgX2xvb3BfMiwgdGhpc18xLCBfYSwgcmVtb3ZlZF8xLCB0YXJnZXRJZDtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2kgPSAwLCBhZGRlZF8xID0gYWRkZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKF9pIDwgYWRkZWRfMS5sZW5ndGgpKSByZXR1cm4gWzMgLypicmVhayovLCA2XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQgPSBhZGRlZF8xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldFt0YXJnZXRJZF0sICdUcnlpbmcgdG8gYWRkIGFuIGFscmVhZHkgYWN0aXZlIHRhcmdldCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUuZ2V0UXVlcnlGb3JUYXJnZXQodGFyZ2V0SWQpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoISFxdWVyeSwgXCJRdWVyeSBkYXRhIGZvciBhY3RpdmUgdGFyZ2V0IFwiICsgdGFyZ2V0SWQgKyBcIiBub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5hbGxvY2F0ZVF1ZXJ5KHF1ZXJ5KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeURhdGEgPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaW5pdGlhbGl6ZVZpZXdBbmRDb21wdXRlU25hcHNob3QocXVlcnlEYXRhLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qY3VycmVudD0qLyBmYWxzZSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLmxpc3RlbihxdWVyeURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDU7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaSsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb29wXzIgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeVZpZXc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VmlldyA9IHRoaXNfMS5xdWVyeVZpZXdzQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFxdWVyeVZpZXcpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpc18xLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbGVhc2VRdWVyeShxdWVyeVZpZXcucXVlcnksIC8qa2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YT0qLyBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdGVTdG9yZS51bmxpc3Rlbih0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbW92ZUFuZENsZWFudXBRdWVyeShxdWVyeVZpZXcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBfdGhpcy5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZXJyKTsgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzXzEgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IDAsIHJlbW92ZWRfMSA9IHJlbW92ZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKF9hIDwgcmVtb3ZlZF8xLmxlbmd0aCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDEwXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQgPSByZW1vdmVkXzFbX2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzUgLyp5aWVsZCoqLywgX2xvb3BfMih0YXJnZXRJZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuIEluIG90aGVyIGNsaWVudHMsIExvY2FsU3RvcmUgaXMgdW5hd2FyZSBvZlxyXG4gICAgLy8gdGhlIG9ubGluZSBzdGF0ZS5cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmVuYWJsZU5ldHdvcmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlLnNldE5ldHdvcmtFbmFibGVkKHRydWUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlbW90ZVN0b3JlLmVuYWJsZU5ldHdvcmsoKTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LiBJbiBvdGhlciBjbGllbnRzLCBMb2NhbFN0b3JlIGlzIHVuYXdhcmUgb2ZcclxuICAgIC8vIHRoZSBvbmxpbmUgc3RhdGUuXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5kaXNhYmxlTmV0d29yayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmxvY2FsU3RvcmUuc2V0TmV0d29ya0VuYWJsZWQoZmFsc2UpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlbW90ZVN0b3JlLmRpc2FibGVOZXR3b3JrKCk7XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBsaW1ib1Jlc29sdXRpb24gPSB0aGlzLmxpbWJvUmVzb2x1dGlvbnNCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgaWYgKGxpbWJvUmVzb2x1dGlvbiAmJiBsaW1ib1Jlc29sdXRpb24ucmVjZWl2ZWREb2N1bWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZG9jdW1lbnRLZXlTZXQoKS5hZGQobGltYm9SZXNvbHV0aW9uLmtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXRbdGFyZ2V0SWRdXHJcbiAgICAgICAgICAgICAgICA/IHRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0W3RhcmdldElkXS52aWV3LnN5bmNlZERvY3VtZW50c1xyXG4gICAgICAgICAgICAgICAgOiBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gU3luY0VuZ2luZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBTaW1wbGUgd3JhcHBlciBhcm91bmQgYSBudWxsYWJsZSBVSUQuIE1vc3RseSBleGlzdHMgdG8gbWFrZSBjb2RlIG1vcmVcclxuICogcmVhZGFibGUuXHJcbiAqL1xyXG52YXIgVXNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFVzZXIodWlkKSB7XHJcbiAgICAgICAgdGhpcy51aWQgPSB1aWQ7XHJcbiAgICB9XHJcbiAgICBVc2VyLnByb3RvdHlwZS5pc0F1dGhlbnRpY2F0ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudWlkICE9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEga2V5IHJlcHJlc2VudGluZyB0aGlzIHVzZXIsIHN1aXRhYmxlIGZvciBpbmNsdXNpb24gaW4gYVxyXG4gICAgICogZGljdGlvbmFyeS5cclxuICAgICAqL1xyXG4gICAgVXNlci5wcm90b3R5cGUudG9LZXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBdXRoZW50aWNhdGVkKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICd1aWQ6JyArIHRoaXMudWlkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuICdhbm9ueW1vdXMtdXNlcic7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFVzZXIucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXJVc2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIG90aGVyVXNlci51aWQgPT09IHRoaXMudWlkO1xyXG4gICAgfTtcclxuICAgIC8qKiBBIHVzZXIgd2l0aCBhIG51bGwgVUlELiAqL1xyXG4gICAgVXNlci5VTkFVVEhFTlRJQ0FURUQgPSBuZXcgVXNlcihudWxsKTtcclxuICAgIC8vIFRPRE8obWlrZWxlaGVuKTogTG9vayBpbnRvIGdldHRpbmcgYSBwcm9wZXIgdWlkLWVxdWl2YWxlbnQgZm9yXHJcbiAgICAvLyBub24tRmlyZWJhc2VBdXRoIHByb3ZpZGVycy5cclxuICAgIFVzZXIuR09PR0xFX0NSRURFTlRJQUxTID0gbmV3IFVzZXIoJ2dvb2dsZS1jcmVkZW50aWFscy11aWQnKTtcclxuICAgIFVzZXIuRklSU1RfUEFSVFkgPSBuZXcgVXNlcignZmlyc3QtcGFydHktdWlkJyk7XHJcbiAgICByZXR1cm4gVXNlcjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDEwID0gJ1NoYXJlZENsaWVudFN0YXRlJztcclxuLy8gVGhlIGZvcm1hdCBvZiB0aGUgTG9jYWxTdG9yYWdlIGtleSB0aGF0IHN0b3JlcyB0aGUgY2xpZW50IHN0YXRlIGlzOlxyXG4vLyAgICAgZmlyZXN0b3JlX2NsaWVudHNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGluc3RhbmNlX2tleT5cclxudmFyIENMSUVOVF9TVEFURV9LRVlfUFJFRklYID0gJ2ZpcmVzdG9yZV9jbGllbnRzJztcclxuLy8gVGhlIGZvcm1hdCBvZiB0aGUgV2ViU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgdGhlIG11dGF0aW9uIHN0YXRlIGlzOlxyXG4vLyAgICAgZmlyZXN0b3JlX211dGF0aW9uc188cGVyc2lzdGVuY2VfcHJlZml4Pl88YmF0Y2hfaWQ+XHJcbi8vICAgICAoZm9yIHVuYXV0aGVudGljYXRlZCB1c2VycylcclxuLy8gb3I6IGZpcmVzdG9yZV9tdXRhdGlvbnNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGJhdGNoX2lkPl88dXNlcl91aWQ+XHJcbi8vXHJcbi8vICd1c2VyX3VpZCcgaXMgbGFzdCB0byBhdm9pZCBuZWVkaW5nIHRvIGVzY2FwZSAnXycgY2hhcmFjdGVycyB0aGF0IGl0IG1pZ2h0XHJcbi8vIGNvbnRhaW4uXHJcbnZhciBNVVRBVElPTl9CQVRDSF9LRVlfUFJFRklYID0gJ2ZpcmVzdG9yZV9tdXRhdGlvbnMnO1xyXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBXZWJTdG9yYWdlIGtleSB0aGF0IHN0b3JlcyBhIHF1ZXJ5IHRhcmdldCdzIG1ldGFkYXRhIGlzOlxyXG4vLyAgICAgZmlyZXN0b3JlX3RhcmdldHNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPHRhcmdldF9pZD5cclxudmFyIFFVRVJZX1RBUkdFVF9LRVlfUFJFRklYID0gJ2ZpcmVzdG9yZV90YXJnZXRzJztcclxuLy8gVGhlIFdlYlN0b3JhZ2UgcHJlZml4IHRoYXQgc3RvcmVzIHRoZSBwcmltYXJ5IHRhYidzIG9ubGluZSBzdGF0ZS4gVGhlXHJcbi8vIGZvcm1hdCBvZiB0aGUga2V5IGlzOlxyXG4vLyAgICAgZmlyZXN0b3JlX29ubGluZV9zdGF0ZV88cGVyc2lzdGVuY2VfcHJlZml4PlxyXG52YXIgT05MSU5FX1NUQVRFX0tFWV9QUkVGSVggPSAnZmlyZXN0b3JlX29ubGluZV9zdGF0ZSc7XHJcbi8vIFRoZSBXZWJTdG9yYWdlIGtleSBwcmVmaXggZm9yIHRoZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGxhc3Qgc2VxdWVuY2UgbnVtYmVyIGFsbG9jYXRlZC4gVGhlIGtleVxyXG4vLyBsb29rcyBsaWtlICdmaXJlc3RvcmVfc2VxdWVuY2VfbnVtYmVyXzxwZXJzaXN0ZW5jZV9wcmVmaXg+Jy5cclxudmFyIFNFUVVFTkNFX05VTUJFUl9LRVlfUFJFRklYID0gJ2ZpcmVzdG9yZV9zZXF1ZW5jZV9udW1iZXInO1xyXG4vKipcclxuICogSG9sZHMgdGhlIHN0YXRlIG9mIGEgbXV0YXRpb24gYmF0Y2gsIGluY2x1ZGluZyBpdHMgdXNlciBJRCwgYmF0Y2ggSUQgYW5kXHJcbiAqIHdoZXRoZXIgdGhlIGJhdGNoIGlzICdwZW5kaW5nJywgJ2Fja25vd2xlZGdlZCcgb3IgJ3JlamVjdGVkJy5cclxuICovXHJcbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcclxudmFyIE11dGF0aW9uTWV0YWRhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNdXRhdGlvbk1ldGFkYXRhKHVzZXIsIGJhdGNoSWQsIHN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHRoaXMudXNlciA9IHVzZXI7XHJcbiAgICAgICAgdGhpcy5iYXRjaElkID0gYmF0Y2hJZDtcclxuICAgICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XHJcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yJCQxO1xyXG4gICAgICAgIGFzc2VydCgoZXJyb3IkJDEgIT09IHVuZGVmaW5lZCkgPT09IChzdGF0ZSA9PT0gJ3JlamVjdGVkJyksIFwiTXV0YXRpb25NZXRhZGF0YSBtdXN0IGNvbnRhaW4gYW4gZXJyb3IgaWZmIHN0YXRlIGlzICdyZWplY3RlZCdcIik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIE11dGF0aW9uTWV0YWRhdGEgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxyXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cclxuICAgICAqL1xyXG4gICAgTXV0YXRpb25NZXRhZGF0YS5mcm9tV2ViU3RvcmFnZUVudHJ5ID0gZnVuY3Rpb24gKHVzZXIsIGJhdGNoSWQsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uQmF0Y2ggPSBKU09OLnBhcnNlKHZhbHVlKTtcclxuICAgICAgICB2YXIgdmFsaWREYXRhID0gdHlwZW9mIG11dGF0aW9uQmF0Y2ggPT09ICdvYmplY3QnICYmXHJcbiAgICAgICAgICAgIFsncGVuZGluZycsICdhY2tub3dsZWRnZWQnLCAncmVqZWN0ZWQnXS5pbmRleE9mKG11dGF0aW9uQmF0Y2guc3RhdGUpICE9PVxyXG4gICAgICAgICAgICAgICAgLTEgJiZcclxuICAgICAgICAgICAgKG11dGF0aW9uQmF0Y2guZXJyb3IgPT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICAgICAgICAgICAgdHlwZW9mIG11dGF0aW9uQmF0Y2guZXJyb3IgPT09ICdvYmplY3QnKTtcclxuICAgICAgICB2YXIgZmlyZXN0b3JlRXJyb3IgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgaWYgKHZhbGlkRGF0YSAmJiBtdXRhdGlvbkJhdGNoLmVycm9yKSB7XHJcbiAgICAgICAgICAgIHZhbGlkRGF0YSA9XHJcbiAgICAgICAgICAgICAgICB0eXBlb2YgbXV0YXRpb25CYXRjaC5lcnJvci5tZXNzYWdlID09PSAnc3RyaW5nJyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBtdXRhdGlvbkJhdGNoLmVycm9yLmNvZGUgPT09ICdzdHJpbmcnO1xyXG4gICAgICAgICAgICBpZiAodmFsaWREYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBmaXJlc3RvcmVFcnJvciA9IG5ldyBGaXJlc3RvcmVFcnJvcihtdXRhdGlvbkJhdGNoLmVycm9yLmNvZGUsIG11dGF0aW9uQmF0Y2guZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZhbGlkRGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IE11dGF0aW9uTWV0YWRhdGEodXNlciwgYmF0Y2hJZCwgbXV0YXRpb25CYXRjaC5zdGF0ZSwgZmlyZXN0b3JlRXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZXJyb3IoTE9HX1RBRyQxMCwgXCJGYWlsZWQgdG8gcGFyc2UgbXV0YXRpb24gc3RhdGUgZm9yIElEICdcIiArIGJhdGNoSWQgKyBcIic6IFwiICsgdmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTXV0YXRpb25NZXRhZGF0YS5wcm90b3R5cGUudG9XZWJTdG9yYWdlSlNPTiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYmF0Y2hNZXRhZGF0YSA9IHtcclxuICAgICAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGUsXHJcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKSAvLyBNb2RpZnkgdGhlIGV4aXN0aW5nIHZhbHVlIHRvIHRyaWdnZXIgdXBkYXRlLlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKHRoaXMuZXJyb3IpIHtcclxuICAgICAgICAgICAgYmF0Y2hNZXRhZGF0YS5lcnJvciA9IHtcclxuICAgICAgICAgICAgICAgIGNvZGU6IHRoaXMuZXJyb3IuY29kZSxcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuZXJyb3IubWVzc2FnZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYmF0Y2hNZXRhZGF0YSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE11dGF0aW9uTWV0YWRhdGE7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBIb2xkcyB0aGUgc3RhdGUgb2YgYSBxdWVyeSB0YXJnZXQsIGluY2x1ZGluZyBpdHMgdGFyZ2V0IElEIGFuZCB3aGV0aGVyIHRoZVxyXG4gKiB0YXJnZXQgaXMgJ25vdC1jdXJyZW50JywgJ2N1cnJlbnQnIG9yICdyZWplY3RlZCcuXHJcbiAqL1xyXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXHJcbnZhciBRdWVyeVRhcmdldE1ldGFkYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnlUYXJnZXRNZXRhZGF0YSh0YXJnZXRJZCwgc3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHRhcmdldElkO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICB0aGlzLmVycm9yID0gZXJyb3IkJDE7XHJcbiAgICAgICAgYXNzZXJ0KChlcnJvciQkMSAhPT0gdW5kZWZpbmVkKSA9PT0gKHN0YXRlID09PSAncmVqZWN0ZWQnKSwgXCJRdWVyeVRhcmdldE1ldGFkYXRhIG11c3QgY29udGFpbiBhbiBlcnJvciBpZmYgc3RhdGUgaXMgJ3JlamVjdGVkJ1wiKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGEgUXVlcnlUYXJnZXRNZXRhZGF0YSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXHJcbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxyXG4gICAgICovXHJcbiAgICBRdWVyeVRhcmdldE1ldGFkYXRhLmZyb21XZWJTdG9yYWdlRW50cnkgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldFN0YXRlID0gSlNPTi5wYXJzZSh2YWx1ZSk7XHJcbiAgICAgICAgdmFyIHZhbGlkRGF0YSA9IHR5cGVvZiB0YXJnZXRTdGF0ZSA9PT0gJ29iamVjdCcgJiZcclxuICAgICAgICAgICAgWydub3QtY3VycmVudCcsICdjdXJyZW50JywgJ3JlamVjdGVkJ10uaW5kZXhPZih0YXJnZXRTdGF0ZS5zdGF0ZSkgIT09XHJcbiAgICAgICAgICAgICAgICAtMSAmJlxyXG4gICAgICAgICAgICAodGFyZ2V0U3RhdGUuZXJyb3IgPT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICAgICAgICAgICAgdHlwZW9mIHRhcmdldFN0YXRlLmVycm9yID09PSAnb2JqZWN0Jyk7XHJcbiAgICAgICAgdmFyIGZpcmVzdG9yZUVycm9yID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGlmICh2YWxpZERhdGEgJiYgdGFyZ2V0U3RhdGUuZXJyb3IpIHtcclxuICAgICAgICAgICAgdmFsaWREYXRhID1cclxuICAgICAgICAgICAgICAgIHR5cGVvZiB0YXJnZXRTdGF0ZS5lcnJvci5tZXNzYWdlID09PSAnc3RyaW5nJyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiB0YXJnZXRTdGF0ZS5lcnJvci5jb2RlID09PSAnc3RyaW5nJztcclxuICAgICAgICAgICAgaWYgKHZhbGlkRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgZmlyZXN0b3JlRXJyb3IgPSBuZXcgRmlyZXN0b3JlRXJyb3IodGFyZ2V0U3RhdGUuZXJyb3IuY29kZSwgdGFyZ2V0U3RhdGUuZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZhbGlkRGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5VGFyZ2V0TWV0YWRhdGEodGFyZ2V0SWQsIHRhcmdldFN0YXRlLnN0YXRlLCBmaXJlc3RvcmVFcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlcnJvcihMT0dfVEFHJDEwLCBcIkZhaWxlZCB0byBwYXJzZSB0YXJnZXQgc3RhdGUgZm9yIElEICdcIiArIHRhcmdldElkICsgXCInOiBcIiArIHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFF1ZXJ5VGFyZ2V0TWV0YWRhdGEucHJvdG90eXBlLnRvV2ViU3RvcmFnZUpTT04gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldFN0YXRlID0ge1xyXG4gICAgICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcclxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpIC8vIE1vZGlmeSB0aGUgZXhpc3RpbmcgdmFsdWUgdG8gdHJpZ2dlciB1cGRhdGUuXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAodGhpcy5lcnJvcikge1xyXG4gICAgICAgICAgICB0YXJnZXRTdGF0ZS5lcnJvciA9IHtcclxuICAgICAgICAgICAgICAgIGNvZGU6IHRoaXMuZXJyb3IuY29kZSxcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuZXJyb3IubWVzc2FnZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGFyZ2V0U3RhdGUpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBRdWVyeVRhcmdldE1ldGFkYXRhO1xyXG59KCkpO1xyXG4vKipcclxuICogVGhpcyBjbGFzcyByZXByZXNlbnRzIHRoZSBpbW11dGFibGUgQ2xpZW50U3RhdGUgZm9yIGEgY2xpZW50IHJlYWQgZnJvbVxyXG4gKiBXZWJTdG9yYWdlLCBjb250YWluaW5nIHRoZSBsaXN0IG9mIGFjdGl2ZSBxdWVyeSB0YXJnZXRzLlxyXG4gKi9cclxudmFyIFJlbW90ZUNsaWVudFN0YXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUmVtb3RlQ2xpZW50U3RhdGUoY2xpZW50SWQsIGFjdGl2ZVRhcmdldElkcykge1xyXG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDtcclxuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IGFjdGl2ZVRhcmdldElkcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGEgUmVtb3RlQ2xpZW50U3RhdGUgZnJvbSB0aGUgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxyXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlQ2xpZW50U3RhdGUuZnJvbVdlYlN0b3JhZ2VFbnRyeSA9IGZ1bmN0aW9uIChjbGllbnRJZCwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgY2xpZW50U3RhdGUgPSBKU09OLnBhcnNlKHZhbHVlKTtcclxuICAgICAgICB2YXIgdmFsaWREYXRhID0gdHlwZW9mIGNsaWVudFN0YXRlID09PSAnb2JqZWN0JyAmJlxyXG4gICAgICAgICAgICBjbGllbnRTdGF0ZS5hY3RpdmVUYXJnZXRJZHMgaW5zdGFuY2VvZiBBcnJheTtcclxuICAgICAgICB2YXIgYWN0aXZlVGFyZ2V0SWRzU2V0ID0gdGFyZ2V0SWRTZXQoKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgdmFsaWREYXRhICYmIGkgPCBjbGllbnRTdGF0ZS5hY3RpdmVUYXJnZXRJZHMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdmFsaWREYXRhID0gaXNTYWZlSW50ZWdlcihjbGllbnRTdGF0ZS5hY3RpdmVUYXJnZXRJZHNbaV0pO1xyXG4gICAgICAgICAgICBhY3RpdmVUYXJnZXRJZHNTZXQgPSBhY3RpdmVUYXJnZXRJZHNTZXQuYWRkKGNsaWVudFN0YXRlLmFjdGl2ZVRhcmdldElkc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWxpZERhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVDbGllbnRTdGF0ZShjbGllbnRJZCwgYWN0aXZlVGFyZ2V0SWRzU2V0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGVycm9yKExPR19UQUckMTAsIFwiRmFpbGVkIHRvIHBhcnNlIGNsaWVudCBkYXRhIGZvciBpbnN0YW5jZSAnXCIgKyBjbGllbnRJZCArIFwiJzogXCIgKyB2YWx1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVtb3RlQ2xpZW50U3RhdGU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBUaGlzIGNsYXNzIHJlcHJlc2VudHMgdGhlIG9ubGluZSBzdGF0ZSBmb3IgYWxsIGNsaWVudHMgcGFydGljaXBhdGluZyBpblxyXG4gKiBtdWx0aS10YWIuIFRoZSBvbmxpbmUgc3RhdGUgaXMgb25seSB3cml0dGVuIHRvIGJ5IHRoZSBwcmltYXJ5IGNsaWVudCwgYW5kXHJcbiAqIHVzZWQgaW4gc2Vjb25kYXJ5IGNsaWVudHMgdG8gdXBkYXRlIHRoZWlyIHF1ZXJ5IHZpZXdzLlxyXG4gKi9cclxudmFyIFNoYXJlZE9ubGluZVN0YXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2hhcmVkT25saW5lU3RhdGUoY2xpZW50SWQsIG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGUgPSBvbmxpbmVTdGF0ZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGEgU2hhcmVkT25saW5lU3RhdGUgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxyXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cclxuICAgICAqL1xyXG4gICAgU2hhcmVkT25saW5lU3RhdGUuZnJvbVdlYlN0b3JhZ2VFbnRyeSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHZhciBvbmxpbmVTdGF0ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xyXG4gICAgICAgIHZhciB2YWxpZERhdGEgPSB0eXBlb2Ygb25saW5lU3RhdGUgPT09ICdvYmplY3QnICYmXHJcbiAgICAgICAgICAgIE9ubGluZVN0YXRlW29ubGluZVN0YXRlLm9ubGluZVN0YXRlXSAhPT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgIHR5cGVvZiBvbmxpbmVTdGF0ZS5jbGllbnRJZCA9PT0gJ3N0cmluZyc7XHJcbiAgICAgICAgaWYgKHZhbGlkRGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFNoYXJlZE9ubGluZVN0YXRlKG9ubGluZVN0YXRlLmNsaWVudElkLCBPbmxpbmVTdGF0ZVtvbmxpbmVTdGF0ZS5vbmxpbmVTdGF0ZV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZXJyb3IoTE9HX1RBRyQxMCwgXCJGYWlsZWQgdG8gcGFyc2Ugb25saW5lIHN0YXRlOiBcIiArIHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBTaGFyZWRPbmxpbmVTdGF0ZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIE1ldGFkYXRhIHN0YXRlIG9mIHRoZSBsb2NhbCBjbGllbnQuIFVubGlrZSBgUmVtb3RlQ2xpZW50U3RhdGVgLCB0aGlzIGNsYXNzIGlzXHJcbiAqIG11dGFibGUgYW5kIGtlZXBzIHRyYWNrIG9mIGFsbCBwZW5kaW5nIG11dGF0aW9ucywgd2hpY2ggYWxsb3dzIHVzIHRvXHJcbiAqIHVwZGF0ZSB0aGUgcmFuZ2Ugb2YgcGVuZGluZyBtdXRhdGlvbiBiYXRjaCBJRHMgYXMgbmV3IG11dGF0aW9ucyBhcmUgYWRkZWQgb3JcclxuICogcmVtb3ZlZC5cclxuICpcclxuICogVGhlIGRhdGEgaW4gYExvY2FsQ2xpZW50U3RhdGVgIGlzIG5vdCByZWFkIGZyb20gV2ViU3RvcmFnZSBhbmQgaW5zdGVhZFxyXG4gKiB1cGRhdGVkIHZpYSBpdHMgaW5zdGFuY2UgbWV0aG9kcy4gVGhlIHVwZGF0ZWQgc3RhdGUgY2FuIGJlIHNlcmlhbGl6ZWQgdmlhXHJcbiAqIGB0b1dlYlN0b3JhZ2VKU09OKClgLlxyXG4gKi9cclxuLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cclxudmFyIExvY2FsQ2xpZW50U3RhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMb2NhbENsaWVudFN0YXRlKCkge1xyXG4gICAgICAgIHRoaXMuYWN0aXZlVGFyZ2V0SWRzID0gdGFyZ2V0SWRTZXQoKTtcclxuICAgIH1cclxuICAgIExvY2FsQ2xpZW50U3RhdGUucHJvdG90eXBlLmFkZFF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLmFjdGl2ZVRhcmdldElkcy5oYXModGFyZ2V0SWQpLCBcIlRhcmdldCB3aXRoIElEICdcIiArIHRhcmdldElkICsgXCInIGFscmVhZHkgYWN0aXZlLlwiKTtcclxuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLmFkZCh0YXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgTG9jYWxDbGllbnRTdGF0ZS5wcm90b3R5cGUucmVtb3ZlUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLmRlbGV0ZSh0YXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0cyB0aGlzIGVudHJ5IGludG8gYSBKU09OLWVuY29kZWQgZm9ybWF0IHdlIGNhbiB1c2UgZm9yIFdlYlN0b3JhZ2UuXHJcbiAgICAgKiBEb2VzIG5vdCBlbmNvZGUgYGNsaWVudElkYCBhcyBpdCBpcyBwYXJ0IG9mIHRoZSBrZXkgaW4gV2ViU3RvcmFnZS5cclxuICAgICAqL1xyXG4gICAgTG9jYWxDbGllbnRTdGF0ZS5wcm90b3R5cGUudG9XZWJTdG9yYWdlSlNPTiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWN0aXZlVGFyZ2V0SWRzOiB0aGlzLmFjdGl2ZVRhcmdldElkcy50b0FycmF5KCksXHJcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKSAvLyBNb2RpZnkgdGhlIGV4aXN0aW5nIHZhbHVlIHRvIHRyaWdnZXIgdXBkYXRlLlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBMb2NhbENsaWVudFN0YXRlO1xyXG59KCkpO1xyXG4vKipcclxuICogYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWAgdXNlcyBXZWJTdG9yYWdlICh3aW5kb3cubG9jYWxTdG9yYWdlKSBhcyB0aGVcclxuICogYmFja2luZyBzdG9yZSBmb3IgdGhlIFNoYXJlZENsaWVudFN0YXRlLiBJdCBrZWVwcyB0cmFjayBvZiBhbGwgYWN0aXZlXHJcbiAqIGNsaWVudHMgYW5kIHN1cHBvcnRzIG1vZGlmaWNhdGlvbnMgb2YgdGhlIGxvY2FsIGNsaWVudCdzIGRhdGEuXHJcbiAqL1xyXG52YXIgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlKHF1ZXVlLCBwbGF0Zm9ybSwgcGVyc2lzdGVuY2VLZXksIGxvY2FsQ2xpZW50SWQsIGluaXRpYWxVc2VyKSB7XHJcbiAgICAgICAgdGhpcy5xdWV1ZSA9IHF1ZXVlO1xyXG4gICAgICAgIHRoaXMucGxhdGZvcm0gPSBwbGF0Zm9ybTtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlS2V5ID0gcGVyc2lzdGVuY2VLZXk7XHJcbiAgICAgICAgdGhpcy5sb2NhbENsaWVudElkID0gbG9jYWxDbGllbnRJZDtcclxuICAgICAgICB0aGlzLnN5bmNFbmdpbmUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGVIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVDbGllbnRzID0ge307XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlTGlzdGVuZXIgPSB0aGlzLmhhbmRsZVdlYlN0b3JhZ2VFdmVudC5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENhcHR1cmVzIFdlYlN0b3JhZ2UgZXZlbnRzIHRoYXQgb2NjdXIgYmVmb3JlIGBzdGFydCgpYCBpcyBjYWxsZWQuIFRoZXNlXHJcbiAgICAgICAgICogZXZlbnRzIGFyZSByZXBsYXllZCBvbmNlIGBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGVgIGlzIHN0YXJ0ZWQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5lYXJseUV2ZW50cyA9IFtdO1xyXG4gICAgICAgIGlmICghV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLmlzQXZhaWxhYmxlKHRoaXMucGxhdGZvcm0pKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOSU1QTEVNRU5URUQsICdMb2NhbFN0b3JhZ2UgaXMgbm90IGF2YWlsYWJsZSBvbiB0aGlzIHBsYXRmb3JtLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBFc2NhcGUgdGhlIHNwZWNpYWwgY2hhcmFjdGVycyBtZW50aW9uZWQgaGVyZTpcclxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L0d1aWRlL1JlZ3VsYXJfRXhwcmVzc2lvbnNcclxuICAgICAgICB2YXIgZXNjYXBlZFBlcnNpc3RlbmNlS2V5ID0gcGVyc2lzdGVuY2VLZXkucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTtcclxuICAgICAgICB0aGlzLnN0b3JhZ2UgPSB0aGlzLnBsYXRmb3JtLndpbmRvdy5sb2NhbFN0b3JhZ2U7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IGluaXRpYWxVc2VyO1xyXG4gICAgICAgIHRoaXMubG9jYWxDbGllbnRTdG9yYWdlS2V5ID0gdGhpcy50b1dlYlN0b3JhZ2VDbGllbnRTdGF0ZUtleSh0aGlzLmxvY2FsQ2xpZW50SWQpO1xyXG4gICAgICAgIHRoaXMuc2VxdWVuY2VOdW1iZXJLZXkgPSBTRVFVRU5DRV9OVU1CRVJfS0VZX1BSRUZJWCArIFwiX1wiICsgcGVyc2lzdGVuY2VLZXk7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVDbGllbnRzW3RoaXMubG9jYWxDbGllbnRJZF0gPSBuZXcgTG9jYWxDbGllbnRTdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuY2xpZW50U3RhdGVLZXlSZSA9IG5ldyBSZWdFeHAoXCJeXCIgKyBDTElFTlRfU1RBVEVfS0VZX1BSRUZJWCArIFwiX1wiICsgZXNjYXBlZFBlcnNpc3RlbmNlS2V5ICsgXCJfKFteX10qKSRcIik7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvbkJhdGNoS2V5UmUgPSBuZXcgUmVnRXhwKFwiXlwiICsgTVVUQVRJT05fQkFUQ0hfS0VZX1BSRUZJWCArIFwiX1wiICsgZXNjYXBlZFBlcnNpc3RlbmNlS2V5ICsgXCJfKFxcXFxkKykoPzpfKC4qKSk/JFwiKTtcclxuICAgICAgICB0aGlzLnF1ZXJ5VGFyZ2V0S2V5UmUgPSBuZXcgUmVnRXhwKFwiXlwiICsgUVVFUllfVEFSR0VUX0tFWV9QUkVGSVggKyBcIl9cIiArIGVzY2FwZWRQZXJzaXN0ZW5jZUtleSArIFwiXyhcXFxcZCspJFwiKTtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlS2V5ID0gT05MSU5FX1NUQVRFX0tFWV9QUkVGSVggKyBcIl9cIiArIHBlcnNpc3RlbmNlS2V5O1xyXG4gICAgICAgIC8vIFJhdGhlciB0aGFuIGFkZGluZyB0aGUgc3RvcmFnZSBvYnNlcnZlciBkdXJpbmcgc3RhcnQoKSwgd2UgYWRkIHRoZVxyXG4gICAgICAgIC8vIHN0b3JhZ2Ugb2JzZXJ2ZXIgZHVyaW5nIGluaXRpYWxpemF0aW9uLiBUaGlzIGVuc3VyZXMgdGhhdCB3ZSBjb2xsZWN0XHJcbiAgICAgICAgLy8gZXZlbnRzIGJlZm9yZSBvdGhlciBjb21wb25lbnRzIHBvcHVsYXRlIHRoZWlyIGluaXRpYWwgc3RhdGUgKGR1cmluZyB0aGVpclxyXG4gICAgICAgIC8vIHJlc3BlY3RpdmUgc3RhcnQoKSBjYWxscykuIE90aGVyd2lzZSwgd2UgbWlnaHQgZm9yIGV4YW1wbGUgbWlzcyBhXHJcbiAgICAgICAgLy8gbXV0YXRpb24gdGhhdCBpcyBhZGRlZCBhZnRlciBMb2NhbFN0b3JlJ3Mgc3RhcnQoKSBwcm9jZXNzZWQgdGhlIGV4aXN0aW5nXHJcbiAgICAgICAgLy8gbXV0YXRpb25zIGJ1dCBiZWZvcmUgd2Ugb2JzZXJ2ZSBXZWJTdG9yYWdlIGV2ZW50cy5cclxuICAgICAgICB0aGlzLnBsYXRmb3JtLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzdG9yYWdlJywgdGhpcy5zdG9yYWdlTGlzdGVuZXIpO1xyXG4gICAgfVxyXG4gICAgLyoqIFJldHVybnMgJ3RydWUnIGlmIFdlYlN0b3JhZ2UgaXMgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LiAqL1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLmlzQXZhaWxhYmxlID0gZnVuY3Rpb24gKHBsYXRmb3JtKSB7XHJcbiAgICAgICAgcmV0dXJuICEhKHBsYXRmb3JtLndpbmRvdyAmJiBwbGF0Zm9ybS53aW5kb3cubG9jYWxTdG9yYWdlICE9IG51bGwpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBleGlzdGluZ0NsaWVudHMsIF9pLCBleGlzdGluZ0NsaWVudHNfMSwgY2xpZW50SWQsIHN0b3JhZ2VJdGVtLCBjbGllbnRTdGF0ZSwgb25saW5lU3RhdGVKU09OLCBvbmxpbmVTdGF0ZSwgX2EsIF9iLCBldmVudF8xO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCghdGhpcy5zdGFydGVkLCAnV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlIGFscmVhZHkgc3RhcnRlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQodGhpcy5zeW5jRW5naW5lICE9PSBudWxsLCAnc3luY0VuZ2luZSBwcm9wZXJ0eSBtdXN0IGJlIHNldCBiZWZvcmUgY2FsbGluZyBzdGFydCgpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCh0aGlzLm9ubGluZVN0YXRlSGFuZGxlciAhPT0gbnVsbCwgJ29ubGluZVN0YXRlSGFuZGxlciBwcm9wZXJ0eSBtdXN0IGJlIHNldCBiZWZvcmUgY2FsbGluZyBzdGFydCgpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc3luY0VuZ2luZS5nZXRBY3RpdmVDbGllbnRzKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdDbGllbnRzID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pID0gMCwgZXhpc3RpbmdDbGllbnRzXzEgPSBleGlzdGluZ0NsaWVudHM7IF9pIDwgZXhpc3RpbmdDbGllbnRzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRJZCA9IGV4aXN0aW5nQ2xpZW50c18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbGllbnRJZCA9PT0gdGhpcy5sb2NhbENsaWVudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9yYWdlSXRlbSA9IHRoaXMuZ2V0SXRlbSh0aGlzLnRvV2ViU3RvcmFnZUNsaWVudFN0YXRlS2V5KGNsaWVudElkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RvcmFnZUl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRTdGF0ZSA9IFJlbW90ZUNsaWVudFN0YXRlLmZyb21XZWJTdG9yYWdlRW50cnkoY2xpZW50SWQsIHN0b3JhZ2VJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xpZW50U3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVDbGllbnRzW2NsaWVudFN0YXRlLmNsaWVudElkXSA9IGNsaWVudFN0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RDbGllbnRTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbmxpbmVTdGF0ZUpTT04gPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSh0aGlzLm9ubGluZVN0YXRlS2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ubGluZVN0YXRlSlNPTikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25saW5lU3RhdGUgPSB0aGlzLmZyb21XZWJTdG9yYWdlT25saW5lU3RhdGUob25saW5lU3RhdGVKU09OKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlT25saW5lU3RhdGVFdmVudChvbmxpbmVTdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChfYSA9IDAsIF9iID0gdGhpcy5lYXJseUV2ZW50czsgX2EgPCBfYi5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50XzEgPSBfYltfYV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVdlYlN0b3JhZ2VFdmVudChldmVudF8xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVhcmx5RXZlbnRzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGEgd2luZG93IHVubG9hZCBob29rIHRvIHJlbW92ZSB0aGUgY2xpZW50IG1ldGFkYXRhIGVudHJ5IGZyb21cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2ViU3RvcmFnZSBldmVuIGlmIGBzaHV0ZG93bigpYCB3YXMgbm90IGNhbGxlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF0Zm9ybS53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5sb2FkJywgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc2h1dGRvd24oKTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS53cml0ZVNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKHNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRoaXMuc2VxdWVuY2VOdW1iZXJLZXksIEpTT04uc3RyaW5naWZ5KHNlcXVlbmNlTnVtYmVyKSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5nZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFjdGl2ZVRhcmdldHMgPSB0YXJnZXRJZFNldCgpO1xyXG4gICAgICAgIGZvckVhY2godGhpcy5hY3RpdmVDbGllbnRzLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBhY3RpdmVUYXJnZXRzID0gYWN0aXZlVGFyZ2V0cy51bmlvbldpdGgodmFsdWUuYWN0aXZlVGFyZ2V0SWRzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gYWN0aXZlVGFyZ2V0cztcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmlzQWN0aXZlUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAvLyBUaGlzIGlzIG5vdCB1c2luZyBgb2JqLmZvckVhY2hgIHNpbmNlIGBmb3JFYWNoYCBkb2Vzbid0IHN1cHBvcnQgZWFybHlcclxuICAgICAgICAvLyByZXR1cm4uXHJcbiAgICAgICAgZm9yICh2YXIgY2xpZW50SWQgaW4gdGhpcy5hY3RpdmVDbGllbnRzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZUNsaWVudHMuaGFzT3duUHJvcGVydHkoY2xpZW50SWQpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVDbGllbnRzW2NsaWVudElkXS5hY3RpdmVUYXJnZXRJZHMuaGFzKHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmFkZFBlbmRpbmdNdXRhdGlvbiA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0TXV0YXRpb25TdGF0ZShiYXRjaElkLCAncGVuZGluZycpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUudXBkYXRlTXV0YXRpb25TdGF0ZSA9IGZ1bmN0aW9uIChiYXRjaElkLCBzdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RNdXRhdGlvblN0YXRlKGJhdGNoSWQsIHN0YXRlLCBlcnJvciQkMSk7XHJcbiAgICAgICAgLy8gT25jZSBhIGZpbmFsIG11dGF0aW9uIHJlc3VsdCBpcyBvYnNlcnZlZCBieSBvdGhlciBjbGllbnRzLCB0aGV5IG5vIGxvbmdlclxyXG4gICAgICAgIC8vIGFjY2VzcyB0aGUgbXV0YXRpb24ncyBtZXRhZGF0YSBlbnRyeS4gU2luY2UgV2ViU3RvcmFnZSByZXBsYXlzIGV2ZW50c1xyXG4gICAgICAgIC8vIGluIG9yZGVyLCBpdCBpcyBzYWZlIHRvIGRlbGV0ZSB0aGUgZW50cnkgcmlnaHQgYWZ0ZXIgdXBkYXRpbmcgaXQuXHJcbiAgICAgICAgdGhpcy5yZW1vdmVNdXRhdGlvblN0YXRlKGJhdGNoSWQpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuYWRkTG9jYWxRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBxdWVyeVN0YXRlID0gJ25vdC1jdXJyZW50JztcclxuICAgICAgICAvLyBMb29rdXAgYW4gZXhpc3RpbmcgcXVlcnkgc3RhdGUgaWYgdGhlIHRhcmdldCBJRCB3YXMgYWxyZWFkeSByZWdpc3RlcmVkXHJcbiAgICAgICAgLy8gYnkgYW5vdGhlciB0YWJcclxuICAgICAgICBpZiAodGhpcy5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICB2YXIgc3RvcmFnZUl0ZW0gPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSh0aGlzLnRvV2ViU3RvcmFnZVF1ZXJ5VGFyZ2V0TWV0YWRhdGFLZXkodGFyZ2V0SWQpKTtcclxuICAgICAgICAgICAgaWYgKHN0b3JhZ2VJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWV0YWRhdGEgPSBRdWVyeVRhcmdldE1ldGFkYXRhLmZyb21XZWJTdG9yYWdlRW50cnkodGFyZ2V0SWQsIHN0b3JhZ2VJdGVtKTtcclxuICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RhdGUgPSBtZXRhZGF0YS5zdGF0ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxvY2FsQ2xpZW50U3RhdGUuYWRkUXVlcnlUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgIHRoaXMucGVyc2lzdENsaWVudFN0YXRlKCk7XHJcbiAgICAgICAgcmV0dXJuIHF1ZXJ5U3RhdGU7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5yZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbENsaWVudFN0YXRlLnJlbW92ZVF1ZXJ5VGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICB0aGlzLnBlcnNpc3RDbGllbnRTdGF0ZSgpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaXNMb2NhbFF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxDbGllbnRTdGF0ZS5hY3RpdmVUYXJnZXRJZHMuaGFzKHRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmNsZWFyUXVlcnlTdGF0ZSA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbSh0aGlzLnRvV2ViU3RvcmFnZVF1ZXJ5VGFyZ2V0TWV0YWRhdGFLZXkodGFyZ2V0SWQpKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnVwZGF0ZVF1ZXJ5U3RhdGUgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIHN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdFF1ZXJ5VGFyZ2V0U3RhdGUodGFyZ2V0SWQsIHN0YXRlLCBlcnJvciQkMSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5oYW5kbGVVc2VyQ2hhbmdlID0gZnVuY3Rpb24gKHVzZXIsIHJlbW92ZWRCYXRjaElkcywgYWRkZWRCYXRjaElkcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmVtb3ZlZEJhdGNoSWRzLmZvckVhY2goZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICAgICAgX3RoaXMucmVtb3ZlTXV0YXRpb25TdGF0ZShiYXRjaElkKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gdXNlcjtcclxuICAgICAgICBhZGRlZEJhdGNoSWRzLmZvckVhY2goZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICAgICAgX3RoaXMuYWRkUGVuZGluZ011dGF0aW9uKGJhdGNoSWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuc2V0T25saW5lU3RhdGUgPSBmdW5jdGlvbiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RPbmxpbmVTdGF0ZShvbmxpbmVTdGF0ZSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5zaHV0ZG93biA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGxhdGZvcm0ud2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N0b3JhZ2UnLCB0aGlzLnN0b3JhZ2VMaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlSXRlbSh0aGlzLmxvY2FsQ2xpZW50U3RvcmFnZUtleSk7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmdldEl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEwLCAnUkVBRCcsIGtleSwgdmFsdWUpO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnNldEl0ZW0gPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMTAsICdTRVQnLCBrZXksIHZhbHVlKTtcclxuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxMCwgJ1JFTU9WRScsIGtleSk7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmhhbmRsZVdlYlN0b3JhZ2VFdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGV2ZW50LnN0b3JhZ2VBcmVhID09PSB0aGlzLnN0b3JhZ2UpIHtcclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQxMCwgJ0VWRU5UJywgZXZlbnQua2V5LCBldmVudC5uZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IHRoaXMubG9jYWxDbGllbnRTdG9yYWdlS2V5KSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvcignUmVjZWl2ZWQgV2ViU3RvcmFnZSBub3RpZmljYXRpb24gZm9yIGxvY2FsIGNoYW5nZS4gQW5vdGhlciBjbGllbnQgbWlnaHQgaGF2ZSAnICtcclxuICAgICAgICAgICAgICAgICAgICAnZ2FyYmFnZS1jb2xsZWN0ZWQgb3VyIHN0YXRlJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5xdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNsaWVudFN0YXRlLCBjbGllbnRJZCwgbXV0YXRpb25NZXRhZGF0YSwgcXVlcnlUYXJnZXRNZXRhZGF0YSwgb25saW5lU3RhdGUsIHNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lYXJseUV2ZW50cy5wdXNoKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2xpZW50U3RhdGVLZXlSZS50ZXN0KGV2ZW50LmtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50Lm5ld1ZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudFN0YXRlID0gdGhpcy5mcm9tV2ViU3RvcmFnZUNsaWVudFN0YXRlKGV2ZW50LmtleSwgZXZlbnQubmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsaWVudFN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuaGFuZGxlQ2xpZW50U3RhdGVFdmVudChjbGllbnRTdGF0ZS5jbGllbnRJZCwgY2xpZW50U3RhdGUpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudElkID0gdGhpcy5mcm9tV2ViU3RvcmFnZUNsaWVudFN0YXRlS2V5KGV2ZW50LmtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5oYW5kbGVDbGllbnRTdGF0ZUV2ZW50KGNsaWVudElkLCBudWxsKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5tdXRhdGlvbkJhdGNoS2V5UmUudGVzdChldmVudC5rZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5uZXdWYWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXV0YXRpb25NZXRhZGF0YSA9IHRoaXMuZnJvbVdlYlN0b3JhZ2VNdXRhdGlvbk1ldGFkYXRhKGV2ZW50LmtleSwgZXZlbnQubmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG11dGF0aW9uTWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5oYW5kbGVNdXRhdGlvbkJhdGNoRXZlbnQobXV0YXRpb25NZXRhZGF0YSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucXVlcnlUYXJnZXRLZXlSZS50ZXN0KGV2ZW50LmtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50Lm5ld1ZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVRhcmdldE1ldGFkYXRhID0gdGhpcy5mcm9tV2ViU3RvcmFnZVF1ZXJ5VGFyZ2V0TWV0YWRhdGEoZXZlbnQua2V5LCBldmVudC5uZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocXVlcnlUYXJnZXRNZXRhZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmhhbmRsZVF1ZXJ5VGFyZ2V0RXZlbnQocXVlcnlUYXJnZXRNZXRhZGF0YSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gdGhpcy5vbmxpbmVTdGF0ZUtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQubmV3VmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubGluZVN0YXRlID0gdGhpcy5mcm9tV2ViU3RvcmFnZU9ubGluZVN0YXRlKGV2ZW50Lm5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmhhbmRsZU9ubGluZVN0YXRlRXZlbnQob25saW5lU3RhdGUpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC5rZXkgPT09IHRoaXMuc2VxdWVuY2VOdW1iZXJLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCEhdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIsICdNaXNzaW5nIHNlcXVlbmNlTnVtYmVySGFuZGxlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXF1ZW5jZU51bWJlciA9IGZyb21XZWJTdG9yYWdlU2VxdWVuY2VOdW1iZXIoZXZlbnQubmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VxdWVuY2VOdW1iZXIgIT09IExpc3RlblNlcXVlbmNlLklOVkFMSUQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VxdWVuY2VOdW1iZXJIYW5kbGVyKHNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7IH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZSwgXCJsb2NhbENsaWVudFN0YXRlXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlQ2xpZW50c1t0aGlzLmxvY2FsQ2xpZW50SWRdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5wZXJzaXN0Q2xpZW50U3RhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRoaXMubG9jYWxDbGllbnRTdG9yYWdlS2V5LCB0aGlzLmxvY2FsQ2xpZW50U3RhdGUudG9XZWJTdG9yYWdlSlNPTigpKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnBlcnNpc3RNdXRhdGlvblN0YXRlID0gZnVuY3Rpb24gKGJhdGNoSWQsIHN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHZhciBtdXRhdGlvblN0YXRlID0gbmV3IE11dGF0aW9uTWV0YWRhdGEodGhpcy5jdXJyZW50VXNlciwgYmF0Y2hJZCwgc3RhdGUsIGVycm9yJCQxKTtcclxuICAgICAgICB2YXIgbXV0YXRpb25LZXkgPSB0aGlzLnRvV2ViU3RvcmFnZU11dGF0aW9uQmF0Y2hLZXkoYmF0Y2hJZCk7XHJcbiAgICAgICAgdGhpcy5zZXRJdGVtKG11dGF0aW9uS2V5LCBtdXRhdGlvblN0YXRlLnRvV2ViU3RvcmFnZUpTT04oKSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5yZW1vdmVNdXRhdGlvblN0YXRlID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25LZXkgPSB0aGlzLnRvV2ViU3RvcmFnZU11dGF0aW9uQmF0Y2hLZXkoYmF0Y2hJZCk7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVJdGVtKG11dGF0aW9uS2V5KTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnBlcnNpc3RPbmxpbmVTdGF0ZSA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgIHZhciBlbnRyeSA9IHtcclxuICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMubG9jYWxDbGllbnRJZCxcclxuICAgICAgICAgICAgb25saW5lU3RhdGU6IE9ubGluZVN0YXRlW29ubGluZVN0YXRlXVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0odGhpcy5vbmxpbmVTdGF0ZUtleSwgSlNPTi5zdHJpbmdpZnkoZW50cnkpKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnBlcnNpc3RRdWVyeVRhcmdldFN0YXRlID0gZnVuY3Rpb24gKHRhcmdldElkLCBzdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0S2V5ID0gdGhpcy50b1dlYlN0b3JhZ2VRdWVyeVRhcmdldE1ldGFkYXRhS2V5KHRhcmdldElkKTtcclxuICAgICAgICB2YXIgdGFyZ2V0TWV0YWRhdGEgPSBuZXcgUXVlcnlUYXJnZXRNZXRhZGF0YSh0YXJnZXRJZCwgc3RhdGUsIGVycm9yJCQxKTtcclxuICAgICAgICB0aGlzLnNldEl0ZW0odGFyZ2V0S2V5LCB0YXJnZXRNZXRhZGF0YS50b1dlYlN0b3JhZ2VKU09OKCkpO1xyXG4gICAgfTtcclxuICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgYSBjbGllbnQgc3RhdGUgaW4gV2ViU3RvcmFnZSAqL1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS50b1dlYlN0b3JhZ2VDbGllbnRTdGF0ZUtleSA9IGZ1bmN0aW9uIChjbGllbnRJZCkge1xyXG4gICAgICAgIGFzc2VydChjbGllbnRJZC5pbmRleE9mKCdfJykgPT09IC0xLCBcIkNsaWVudCBrZXkgY2Fubm90IGNvbnRhaW4gJ18nLCBidXQgd2FzICdcIiArIGNsaWVudElkICsgXCInXCIpO1xyXG4gICAgICAgIHJldHVybiBDTElFTlRfU1RBVEVfS0VZX1BSRUZJWCArIFwiX1wiICsgdGhpcy5wZXJzaXN0ZW5jZUtleSArIFwiX1wiICsgY2xpZW50SWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIHF1ZXJ5IHN0YXRlIGluIFdlYlN0b3JhZ2UgKi9cclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUudG9XZWJTdG9yYWdlUXVlcnlUYXJnZXRNZXRhZGF0YUtleSA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHJldHVybiBRVUVSWV9UQVJHRVRfS0VZX1BSRUZJWCArIFwiX1wiICsgdGhpcy5wZXJzaXN0ZW5jZUtleSArIFwiX1wiICsgdGFyZ2V0SWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIG11dGF0aW9uIGJhdGNoIGluIFdlYlN0b3JhZ2UgKi9cclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUudG9XZWJTdG9yYWdlTXV0YXRpb25CYXRjaEtleSA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uS2V5ID0gTVVUQVRJT05fQkFUQ0hfS0VZX1BSRUZJWCArIFwiX1wiICsgdGhpcy5wZXJzaXN0ZW5jZUtleSArIFwiX1wiICsgYmF0Y2hJZDtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50VXNlci5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICAgICAgICBtdXRhdGlvbktleSArPSBcIl9cIiArIHRoaXMuY3VycmVudFVzZXIudWlkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbXV0YXRpb25LZXk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBjbGllbnQgc3RhdGUga2V5IGluIFdlYlN0b3JhZ2UuIFJldHVybnMgbnVsbCBpZiB0aGUga2V5IGRvZXMgbm90XHJcbiAgICAgKiBtYXRjaCB0aGUgZXhwZWN0ZWQga2V5IGZvcm1hdC5cclxuICAgICAqL1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5mcm9tV2ViU3RvcmFnZUNsaWVudFN0YXRlS2V5ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBtYXRjaCA9IHRoaXMuY2xpZW50U3RhdGVLZXlSZS5leGVjKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIG1hdGNoID8gbWF0Y2hbMV0gOiBudWxsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGEgY2xpZW50IHN0YXRlIGluIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZSBjb3VsZCBub3RcclxuICAgICAqIGJlIHBhcnNlZC5cclxuICAgICAqL1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5mcm9tV2ViU3RvcmFnZUNsaWVudFN0YXRlID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgY2xpZW50SWQgPSB0aGlzLmZyb21XZWJTdG9yYWdlQ2xpZW50U3RhdGVLZXkoa2V5KTtcclxuICAgICAgICBhc3NlcnQoY2xpZW50SWQgIT09IG51bGwsIFwiQ2Fubm90IHBhcnNlIGNsaWVudCBzdGF0ZSBrZXkgJ1wiICsga2V5ICsgXCInXCIpO1xyXG4gICAgICAgIHJldHVybiBSZW1vdGVDbGllbnRTdGF0ZS5mcm9tV2ViU3RvcmFnZUVudHJ5KGNsaWVudElkLCB2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBtdXRhdGlvbiBiYXRjaCBzdGF0ZSBpbiBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWVcclxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXHJcbiAgICAgKi9cclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuZnJvbVdlYlN0b3JhZ2VNdXRhdGlvbk1ldGFkYXRhID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgbWF0Y2ggPSB0aGlzLm11dGF0aW9uQmF0Y2hLZXlSZS5leGVjKGtleSk7XHJcbiAgICAgICAgYXNzZXJ0KG1hdGNoICE9PSBudWxsLCBcIkNhbm5vdCBwYXJzZSBtdXRhdGlvbiBiYXRjaCBrZXkgJ1wiICsga2V5ICsgXCInXCIpO1xyXG4gICAgICAgIHZhciBiYXRjaElkID0gTnVtYmVyKG1hdGNoWzFdKTtcclxuICAgICAgICB2YXIgdXNlcklkID0gbWF0Y2hbMl0gIT09IHVuZGVmaW5lZCA/IG1hdGNoWzJdIDogbnVsbDtcclxuICAgICAgICByZXR1cm4gTXV0YXRpb25NZXRhZGF0YS5mcm9tV2ViU3RvcmFnZUVudHJ5KG5ldyBVc2VyKHVzZXJJZCksIGJhdGNoSWQsIHZhbHVlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIHF1ZXJ5IHRhcmdldCBzdGF0ZSBmcm9tIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxyXG4gICAgICogY291bGQgbm90IGJlIHBhcnNlZC5cclxuICAgICAqL1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5mcm9tV2ViU3RvcmFnZVF1ZXJ5VGFyZ2V0TWV0YWRhdGEgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBtYXRjaCA9IHRoaXMucXVlcnlUYXJnZXRLZXlSZS5leGVjKGtleSk7XHJcbiAgICAgICAgYXNzZXJ0KG1hdGNoICE9PSBudWxsLCBcIkNhbm5vdCBwYXJzZSBxdWVyeSB0YXJnZXQga2V5ICdcIiArIGtleSArIFwiJ1wiKTtcclxuICAgICAgICB2YXIgdGFyZ2V0SWQgPSBOdW1iZXIobWF0Y2hbMV0pO1xyXG4gICAgICAgIHJldHVybiBRdWVyeVRhcmdldE1ldGFkYXRhLmZyb21XZWJTdG9yYWdlRW50cnkodGFyZ2V0SWQsIHZhbHVlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhbiBvbmxpbmUgc3RhdGUgZnJvbSBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWVcclxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXHJcbiAgICAgKi9cclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuZnJvbVdlYlN0b3JhZ2VPbmxpbmVTdGF0ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBTaGFyZWRPbmxpbmVTdGF0ZS5mcm9tV2ViU3RvcmFnZUVudHJ5KHZhbHVlKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmhhbmRsZU11dGF0aW9uQmF0Y2hFdmVudCA9IGZ1bmN0aW9uIChtdXRhdGlvbkJhdGNoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG11dGF0aW9uQmF0Y2gudXNlci51aWQgIT09IHRoaXMuY3VycmVudFVzZXIudWlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQxMCwgXCJJZ25vcmluZyBtdXRhdGlvbiBmb3Igbm9uLWFjdGl2ZSB1c2VyIFwiICsgbXV0YXRpb25CYXRjaC51c2VyLnVpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuc3luY0VuZ2luZS5hcHBseUJhdGNoU3RhdGUobXV0YXRpb25CYXRjaC5iYXRjaElkLCBtdXRhdGlvbkJhdGNoLnN0YXRlLCBtdXRhdGlvbkJhdGNoLmVycm9yKV07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaGFuZGxlUXVlcnlUYXJnZXRFdmVudCA9IGZ1bmN0aW9uICh0YXJnZXRNZXRhZGF0YSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuYXBwbHlUYXJnZXRTdGF0ZSh0YXJnZXRNZXRhZGF0YS50YXJnZXRJZCwgdGFyZ2V0TWV0YWRhdGEuc3RhdGUsIHRhcmdldE1ldGFkYXRhLmVycm9yKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmhhbmRsZUNsaWVudFN0YXRlRXZlbnQgPSBmdW5jdGlvbiAoY2xpZW50SWQsIGNsaWVudFN0YXRlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZXhpc3RpbmdUYXJnZXRzID0gdGhpcy5nZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKTtcclxuICAgICAgICBpZiAoY2xpZW50U3RhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5hY3RpdmVDbGllbnRzW2NsaWVudElkXSA9IGNsaWVudFN0YXRlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuYWN0aXZlQ2xpZW50c1tjbGllbnRJZF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuZXdUYXJnZXRzID0gdGhpcy5nZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKTtcclxuICAgICAgICB2YXIgYWRkZWRUYXJnZXRzID0gW107XHJcbiAgICAgICAgdmFyIHJlbW92ZWRUYXJnZXRzID0gW107XHJcbiAgICAgICAgbmV3VGFyZ2V0cy5mb3JFYWNoKGZ1bmN0aW9uICh0YXJnZXRJZCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFleGlzdGluZ1RhcmdldHMuaGFzKHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkZGVkVGFyZ2V0cy5wdXNoKHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgICAgIGV4aXN0aW5nVGFyZ2V0cy5mb3JFYWNoKGZ1bmN0aW9uICh0YXJnZXRJZCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuZXdUYXJnZXRzLmhhcyh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVkVGFyZ2V0cy5wdXNoKHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuYXBwbHlBY3RpdmVUYXJnZXRzQ2hhbmdlKGFkZGVkVGFyZ2V0cywgcmVtb3ZlZFRhcmdldHMpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaGFuZGxlT25saW5lU3RhdGVFdmVudCA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgIC8vIFdlIGNoZWNrIHdoZXRoZXIgdGhlIGNsaWVudCB0aGF0IHdyb3RlIHRoaXMgb25saW5lIHN0YXRlIGlzIHN0aWxsIGFjdGl2ZVxyXG4gICAgICAgIC8vIGJ5IGNvbXBhcmluZyBpdHMgY2xpZW50IElEIHRvIHRoZSBsaXN0IG9mIGNsaWVudHMga2VwdCBhY3RpdmUgaW5cclxuICAgICAgICAvLyBJbmRleGVkRGIuIElmIGEgY2xpZW50IGRvZXMgbm90IHVwZGF0ZSB0aGVpciBJbmRleGVkRGIgY2xpZW50IHN0YXRlXHJcbiAgICAgICAgLy8gd2l0aGluIDUgc2Vjb25kcywgaXQgaXMgY29uc2lkZXJlZCBpbmFjdGl2ZSBhbmQgd2UgZG9uJ3QgZW1pdCBhbiBvbmxpbmVcclxuICAgICAgICAvLyBzdGF0ZSBldmVudC5cclxuICAgICAgICBpZiAodGhpcy5hY3RpdmVDbGllbnRzW29ubGluZVN0YXRlLmNsaWVudElkXSkge1xyXG4gICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlSGFuZGxlcihvbmxpbmVTdGF0ZS5vbmxpbmVTdGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGU7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGZyb21XZWJTdG9yYWdlU2VxdWVuY2VOdW1iZXIoc2VxU3RyaW5nKSB7XHJcbiAgICB2YXIgc2VxdWVuY2VOdW1iZXIgPSBMaXN0ZW5TZXF1ZW5jZS5JTlZBTElEO1xyXG4gICAgaWYgKHNlcVN0cmluZyAhPSBudWxsKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIHBhcnNlZCA9IEpTT04ucGFyc2Uoc2VxU3RyaW5nKTtcclxuICAgICAgICAgICAgYXNzZXJ0KHR5cGVvZiBwYXJzZWQgPT09ICdudW1iZXInLCAnRm91bmQgbm9uLW51bWVyaWMgc2VxdWVuY2UgbnVtYmVyJyk7XHJcbiAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyID0gcGFyc2VkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBlcnJvcihMT0dfVEFHJDEwLCAnRmFpbGVkIHRvIHJlYWQgc2VxdWVuY2UgbnVtYmVyIGZyb20gV2ViU3RvcmFnZScsIGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzZXF1ZW5jZU51bWJlcjtcclxufVxyXG4vKipcclxuICogYE1lbW9yeVNoYXJlZENsaWVudFN0YXRlYCBpcyBhIHNpbXBsZSBpbXBsZW1lbnRhdGlvbiBvZiBTaGFyZWRDbGllbnRTdGF0ZSBmb3JcclxuICogY2xpZW50cyB1c2luZyBtZW1vcnkgcGVyc2lzdGVuY2UuIFRoZSBzdGF0ZSBpbiB0aGlzIGNsYXNzIHJlbWFpbnMgZnVsbHlcclxuICogaXNvbGF0ZWQgYW5kIG5vIHN5bmNocm9uaXphdGlvbiBpcyBwZXJmb3JtZWQuXHJcbiAqL1xyXG52YXIgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZSgpIHtcclxuICAgICAgICB0aGlzLmxvY2FsU3RhdGUgPSBuZXcgTG9jYWxDbGllbnRTdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMucXVlcnlTdGF0ZSA9IHt9O1xyXG4gICAgICAgIHRoaXMuc3luY0VuZ2luZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuc2VxdWVuY2VOdW1iZXJIYW5kbGVyID0gbnVsbDtcclxuICAgIH1cclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5hZGRQZW5kaW5nTXV0YXRpb24gPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIC8vIE5vIG9wLlxyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS51cGRhdGVNdXRhdGlvblN0YXRlID0gZnVuY3Rpb24gKGJhdGNoSWQsIHN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIC8vIE5vIG9wLlxyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5hZGRMb2NhbFF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbFN0YXRlLmFkZFF1ZXJ5VGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5xdWVyeVN0YXRlW3RhcmdldElkXSB8fCAnbm90LWN1cnJlbnQnO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS51cGRhdGVRdWVyeVN0YXRlID0gZnVuY3Rpb24gKHRhcmdldElkLCBzdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5U3RhdGVbdGFyZ2V0SWRdID0gc3RhdGU7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnJlbW92ZUxvY2FsUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLmxvY2FsU3RhdGUucmVtb3ZlUXVlcnlUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5pc0xvY2FsUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0YXRlLmFjdGl2ZVRhcmdldElkcy5oYXModGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5jbGVhclF1ZXJ5U3RhdGUgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICBkZWxldGUgdGhpcy5xdWVyeVN0YXRlW3RhcmdldElkXTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RhdGUuYWN0aXZlVGFyZ2V0SWRzO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdGF0ZS5hY3RpdmVUYXJnZXRJZHMuaGFzKHRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbFN0YXRlID0gbmV3IExvY2FsQ2xpZW50U3RhdGUoKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmhhbmRsZVVzZXJDaGFuZ2UgPSBmdW5jdGlvbiAodXNlciwgcmVtb3ZlZEJhdGNoSWRzLCBhZGRlZEJhdGNoSWRzKSB7XHJcbiAgICAgICAgLy8gTm8gb3AuXHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnNldE9ubGluZVN0YXRlID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgLy8gTm8gb3AuXHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnNodXRkb3duID0gZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLndyaXRlU2VxdWVuY2VOdW1iZXIgPSBmdW5jdGlvbiAoc2VxdWVuY2VOdW1iZXIpIHsgfTtcclxuICAgIHJldHVybiBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDExID0gJ0ZpcmVzdG9yZUNsaWVudCc7XHJcbi8qKiBUaGUgRE9NRXhjZXB0aW9uIGNvZGUgZm9yIGFuIGFib3J0ZWQgb3BlcmF0aW9uLiAqL1xyXG52YXIgRE9NX0VYQ0VQVElPTl9BQk9SVEVEID0gMjA7XHJcbi8qKiBUaGUgRE9NRXhjZXB0aW9uIGNvZGUgZm9yIHF1b3RhIGV4Y2VlZGVkLiAqL1xyXG52YXIgRE9NX0VYQ0VQVElPTl9RVU9UQV9FWENFRURFRCA9IDIyO1xyXG4vKipcclxuICogRmlyZXN0b3JlQ2xpZW50IGlzIGEgdG9wLWxldmVsIGNsYXNzIHRoYXQgY29uc3RydWN0cyBhbmQgb3ducyBhbGwgb2YgdGhlXHJcbiAqIHBpZWNlcyBvZiB0aGUgY2xpZW50IFNESyBhcmNoaXRlY3R1cmUuIEl0IGlzIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGVcclxuICogYXN5bmMgcXVldWUgdGhhdCBpcyBzaGFyZWQgYnkgYWxsIG9mIHRoZSBvdGhlciBjb21wb25lbnRzIGluIHRoZSBzeXN0ZW0uXHJcbiAqL1xyXG52YXIgRmlyZXN0b3JlQ2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyZXN0b3JlQ2xpZW50KHBsYXRmb3JtLCBkYXRhYmFzZUluZm8sIGNyZWRlbnRpYWxzLCBcclxuICAgIC8qKlxyXG4gICAgICogQXN5bmNocm9ub3VzIHF1ZXVlIHJlc3BvbnNpYmxlIGZvciBhbGwgb2Ygb3VyIGludGVybmFsIHByb2Nlc3NpbmcuIFdoZW5cclxuICAgICAqIHdlIGdldCBpbmNvbWluZyB3b3JrIGZyb20gdGhlIHVzZXIgKHZpYSBwdWJsaWMgQVBJKSBvciB0aGUgbmV0d29ya1xyXG4gICAgICogKGluY29taW5nIEdSUEMgbWVzc2FnZXMpLCB3ZSBzaG91bGQgYWx3YXlzIHNjaGVkdWxlIG9udG8gdGhpcyBxdWV1ZS5cclxuICAgICAqIFRoaXMgZW5zdXJlcyBhbGwgb2Ygb3VyIHdvcmsgaXMgcHJvcGVybHkgc2VyaWFsaXplZCAoZS5nLiB3ZSBkb24ndFxyXG4gICAgICogc3RhcnQgcHJvY2Vzc2luZyBhIG5ldyBvcGVyYXRpb24gd2hpbGUgdGhlIHByZXZpb3VzIG9uZSBpcyB3YWl0aW5nIGZvclxyXG4gICAgICogYW4gYXN5bmMgSS9PIHRvIGNvbXBsZXRlKS5cclxuICAgICAqL1xyXG4gICAgYXN5bmNRdWV1ZSkge1xyXG4gICAgICAgIHRoaXMucGxhdGZvcm0gPSBwbGF0Zm9ybTtcclxuICAgICAgICB0aGlzLmRhdGFiYXNlSW5mbyA9IGRhdGFiYXNlSW5mbztcclxuICAgICAgICB0aGlzLmNyZWRlbnRpYWxzID0gY3JlZGVudGlhbHM7XHJcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gYXN5bmNRdWV1ZTtcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gQXV0b0lkLm5ld0lkKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFN0YXJ0cyB1cCB0aGUgRmlyZXN0b3JlQ2xpZW50LCByZXR1cm5pbmcgb25seSB3aGV0aGVyIG9yIG5vdCBlbmFibGluZ1xyXG4gICAgICogcGVyc2lzdGVuY2Ugc3VjY2VlZGVkLlxyXG4gICAgICpcclxuICAgICAqIFRoZSBpbnRlbnQgaGVyZSBpcyB0byBcImRvIHRoZSByaWdodCB0aGluZ1wiIGFzIGZhciBhcyB1c2VycyBhcmUgY29uY2VybmVkLlxyXG4gICAgICogTmFtZWx5LCBpbiBjYXNlcyB3aGVyZSBvZmZsaW5lIHBlcnNpc3RlbmNlIGlzIHJlcXVlc3RlZCBhbmQgcG9zc2libGUsXHJcbiAgICAgKiBlbmFibGUgaXQsIGJ1dCBvdGhlcndpc2UgZmFsbCBiYWNrIHRvIHBlcnNpc3RlbmNlIGRpc2FibGVkLiBGb3IgdGhlIG1vc3RcclxuICAgICAqIHBhcnQgd2UgZXhwZWN0IHRoaXMgdG8gc3VjY2VlZCBvbmUgd2F5IG9yIHRoZSBvdGhlciBzbyB3ZSBkb24ndCBleHBlY3Qgb3VyXHJcbiAgICAgKiB1c2VycyB0byBhY3R1YWxseSB3YWl0IG9uIHRoZSBmaXJlc3RvcmUuZW5hYmxlUGVyc2lzdGVuY2UgUHJvbWlzZSBzaW5jZVxyXG4gICAgICogdGhleSBnZW5lcmFsbHkgd29uJ3QgY2FyZS5cclxuICAgICAqXHJcbiAgICAgKiBPZiBjb3Vyc2Ugc29tZSB1c2VycyBhY3R1YWxseSBkbyBjYXJlIGFib3V0IHdoZXRoZXIgb3Igbm90IHBlcnNpc3RlbmNlXHJcbiAgICAgKiB3YXMgc3VjY2Vzc2Z1bGx5IGVuYWJsZWQsIHNvIHRoZSBQcm9taXNlIHJldHVybmVkIGZyb20gdGhpcyBtZXRob2RcclxuICAgICAqIGluZGljYXRlcyB0aGlzIG91dGNvbWUuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBwcmVzZW50cyBhIHByb2JsZW0gdGhvdWdoOiBldmVuIGJlZm9yZSBlbmFibGVQZXJzaXN0ZW5jZSByZXNvbHZlcyBvclxyXG4gICAgICogcmVqZWN0cywgdXNlcnMgbWF5IGhhdmUgbWFkZSBjYWxscyB0byBlLmcuIGZpcmVzdG9yZS5jb2xsZWN0aW9uKCkgd2hpY2hcclxuICAgICAqIG1lYW5zIHRoYXQgdGhlIEZpcmVzdG9yZUNsaWVudCBpbiB0aGVyZSB3aWxsIGJlIGF2YWlsYWJsZSBhbmQgd2lsbCBiZVxyXG4gICAgICogZW5xdWV1aW5nIGFjdGlvbnMgb24gdGhlIGFzeW5jIHF1ZXVlLlxyXG4gICAgICpcclxuICAgICAqIE1lYW53aGlsZSBhbnkgZmFpbHVyZSBvZiBhbiBvcGVyYXRpb24gb24gdGhlIGFzeW5jIHF1ZXVlIGNhdXNlcyBpdCB0b1xyXG4gICAgICogcGFuaWMgYW5kIHJlamVjdCBhbnkgZnVydGhlciB3b3JrLCBvbiB0aGUgcHJlbWlzZSB0aGF0IHVuaGFuZGxlZCBlcnJvcnNcclxuICAgICAqIGFyZSBmYXRhbC5cclxuICAgICAqXHJcbiAgICAgKiBDb25zZXF1ZW50bHkgdGhlIGZhbGxiYWNrIGlzIGhhbmRsZWQgaW50ZXJuYWxseSBoZXJlIGluIHN0YXJ0LCBhbmQgaWYgdGhlXHJcbiAgICAgKiBmYWxsYmFjayBzdWNjZWVkcyB3ZSBzaWduYWwgc3VjY2VzcyB0byB0aGUgYXN5bmMgcXVldWUgZXZlbiB0aG91Z2ggdGhlXHJcbiAgICAgKiBzdGFydCgpIGl0c2VsZiBzaWduYWxzIGZhaWx1cmUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBlcnNpc3RlbmNlU2V0dGluZ3MgU2V0dGluZ3Mgb2JqZWN0IHRvIGNvbmZpZ3VyZSBvZmZsaW5lXHJcbiAgICAgKiAgICAgcGVyc2lzdGVuY2UuXHJcbiAgICAgKiBAcmV0dXJucyBBIGRlZmVycmVkIHJlc3VsdCBpbmRpY2F0aW5nIHRoZSB1c2VyLXZpc2libGUgcmVzdWx0IG9mIGVuYWJsaW5nXHJcbiAgICAgKiAgICAgb2ZmbGluZSBwZXJzaXN0ZW5jZS4gVGhpcyBtZXRob2Qgd2lsbCByZWplY3QgdGhpcyBpZiBJbmRleGVkREIgZmFpbHMgdG9cclxuICAgICAqICAgICBzdGFydCBmb3IgYW55IHJlYXNvbi4gSWYgdXNlUGVyc2lzdGVuY2UgaXMgZmFsc2UgdGhpcyBpc1xyXG4gICAgICogICAgIHVuY29uZGl0aW9uYWxseSByZXNvbHZlZC5cclxuICAgICAqL1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uIChwZXJzaXN0ZW5jZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBXZSBkZWZlciBvdXIgaW5pdGlhbGl6YXRpb24gdW50aWwgd2UgZ2V0IHRoZSBjdXJyZW50IHVzZXIgZnJvbVxyXG4gICAgICAgIC8vIHNldENoYW5nZUxpc3RlbmVyKCkuIFdlIGJsb2NrIHRoZSBhc3luYyBxdWV1ZSB1bnRpbCB3ZSBnb3QgdGhlIGluaXRpYWxcclxuICAgICAgICAvLyB1c2VyIGFuZCB0aGUgaW5pdGlhbGl6YXRpb24gaXMgY29tcGxldGVkLiBUaGlzIHdpbGwgcHJldmVudCBhbnkgc2NoZWR1bGVkXHJcbiAgICAgICAgLy8gd29yayBmcm9tIGhhcHBlbmluZyBiZWZvcmUgaW5pdGlhbGl6YXRpb24gaXMgY29tcGxldGVkLlxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gSWYgaW5pdGlhbGl6YXRpb25Eb25lIHJlc29sdmVkIHRoZW4gdGhlIEZpcmVzdG9yZUNsaWVudCBpcyBpbiBhIHVzYWJsZVxyXG4gICAgICAgIC8vIHN0YXRlLlxyXG4gICAgICAgIHZhciBpbml0aWFsaXphdGlvbkRvbmUgPSBuZXcgRGVmZXJyZWQkMSgpO1xyXG4gICAgICAgIC8vIElmIHVzZVBlcnNpc3RlbmNlIGlzIHRydWUsIGNlcnRhaW4gY2xhc3NlcyBvZiBlcnJvcnMgd2hpbGUgc3RhcnRpbmcgYXJlXHJcbiAgICAgICAgLy8gcmVjb3ZlcmFibGUgYnV0IG9ubHkgYnkgZmFsbGluZyBiYWNrIHRvIHBlcnNpc3RlbmNlIGRpc2FibGVkLlxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gSWYgdGhlcmUncyBhbiBlcnJvciBpbiB0aGUgZmlyc3QgY2FzZSBidXQgbm90IGluIHJlY292ZXJ5IHdlIGNhbm5vdFxyXG4gICAgICAgIC8vIHJlamVjdCB0aGUgcHJvbWlzZSBibG9ja2luZyB0aGUgYXN5bmMgcXVldWUgYmVjYXVzZSB0aGlzIHdpbGwgY2F1c2UgdGhlXHJcbiAgICAgICAgLy8gYXN5bmMgcXVldWUgdG8gcGFuaWMuXHJcbiAgICAgICAgdmFyIHBlcnNpc3RlbmNlUmVzdWx0ID0gbmV3IERlZmVycmVkJDEoKTtcclxuICAgICAgICB2YXIgaW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNyZWRlbnRpYWxzLnNldENoYW5nZUxpc3RlbmVyKGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgICAgIGlmICghaW5pdGlhbGl6ZWQpIHtcclxuICAgICAgICAgICAgICAgIGluaXRpYWxpemVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmluaXRpYWxpemVQZXJzaXN0ZW5jZShwZXJzaXN0ZW5jZVNldHRpbmdzLCBwZXJzaXN0ZW5jZVJlc3VsdCwgdXNlcilcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5pbml0aWFsaXplUmVzdCh1c2VyKTsgfSlcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihpbml0aWFsaXphdGlvbkRvbmUucmVzb2x2ZSwgaW5pdGlhbGl6YXRpb25Eb25lLnJlamVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlKHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBCbG9jayB0aGUgYXN5bmMgcXVldWUgdW50aWwgaW5pdGlhbGl6YXRpb24gaXMgZG9uZVxyXG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGluaXRpYWxpemF0aW9uRG9uZS5wcm9taXNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIFJldHVybiBvbmx5IHRoZSByZXN1bHQgb2YgZW5hYmxpbmcgcGVyc2lzdGVuY2UuIE5vdGUgdGhhdCB0aGlzIGRvZXMgbm90XHJcbiAgICAgICAgLy8gbmVlZCB0byBhd2FpdCB0aGUgY29tcGxldGlvbiBvZiBpbml0aWFsaXphdGlvbkRvbmUgYmVjYXVzZSB0aGUgcmVzdWx0IG9mXHJcbiAgICAgICAgLy8gdGhpcyBtZXRob2Qgc2hvdWxkIG5vdCByZWZsZWN0IGFueSBvdGhlciBraW5kIG9mIGZhaWx1cmUgdG8gc3RhcnQuXHJcbiAgICAgICAgcmV0dXJuIHBlcnNpc3RlbmNlUmVzdWx0LnByb21pc2U7XHJcbiAgICB9O1xyXG4gICAgLyoqIEVuYWJsZXMgdGhlIG5ldHdvcmsgY29ubmVjdGlvbiBhbmQgcmVxdWV1ZXMgYWxsIHBlbmRpbmcgb3BlcmF0aW9ucy4gKi9cclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuZW5hYmxlTmV0d29yayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zeW5jRW5naW5lLmVuYWJsZU5ldHdvcmsoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYWxpemVzIHBlcnNpc3RlbnQgc3RvcmFnZSwgYXR0ZW1wdGluZyB0byB1c2UgSW5kZXhlZERCIGlmXHJcbiAgICAgKiB1c2VQZXJzaXN0ZW5jZSBpcyB0cnVlIG9yIG1lbW9yeS1vbmx5IGlmIGZhbHNlLlxyXG4gICAgICpcclxuICAgICAqIElmIEluZGV4ZWREQiBmYWlscyBiZWNhdXNlIGl0J3MgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgdGFiIG9yIGJlY2F1c2UgdGhlXHJcbiAgICAgKiBwbGF0Zm9ybSBjYW4ndCBwb3NzaWJseSBzdXBwb3J0IG91ciBpbXBsZW1lbnRhdGlvbiB0aGVuIHRoaXMgbWV0aG9kIHJlamVjdHNcclxuICAgICAqIHRoZSBwZXJzaXN0ZW5jZVJlc3VsdCBhbmQgZmFsbHMgYmFjayBvbiBtZW1vcnktb25seSBwZXJzaXN0ZW5jZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGVyc2lzdGVuY2VTZXR0aW5ncyBTZXR0aW5ncyBvYmplY3QgdG8gY29uZmlndXJlIG9mZmxpbmUgcGVyc2lzdGVuY2VcclxuICAgICAqIEBwYXJhbSBwZXJzaXN0ZW5jZVJlc3VsdCBBIGRlZmVycmVkIHJlc3VsdCBpbmRpY2F0aW5nIHRoZSB1c2VyLXZpc2libGVcclxuICAgICAqICAgICByZXN1bHQgb2YgZW5hYmxpbmcgb2ZmbGluZSBwZXJzaXN0ZW5jZS4gVGhpcyBtZXRob2Qgd2lsbCByZWplY3QgdGhpcyBpZlxyXG4gICAgICogICAgIEluZGV4ZWREQiBmYWlscyB0byBzdGFydCBmb3IgYW55IHJlYXNvbi4gSWYgdXNlUGVyc2lzdGVuY2UgaXMgZmFsc2VcclxuICAgICAqICAgICB0aGlzIGlzIHVuY29uZGl0aW9uYWxseSByZXNvbHZlZC5cclxuICAgICAqIEByZXR1cm5zIGEgUHJvbWlzZSBpbmRpY2F0aW5nIHdoZXRoZXIgb3Igbm90IGluaXRpYWxpemF0aW9uIHNob3VsZFxyXG4gICAgICogICAgIGNvbnRpbnVlLCBpLmUuIHRoYXQgb25lIG9mIHRoZSBwZXJzaXN0ZW5jZSBpbXBsZW1lbnRhdGlvbnMgYWN0dWFsbHlcclxuICAgICAqICAgICBzdWNjZWVkZWQuXHJcbiAgICAgKi9cclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuaW5pdGlhbGl6ZVBlcnNpc3RlbmNlID0gZnVuY3Rpb24gKHBlcnNpc3RlbmNlU2V0dGluZ3MsIHBlcnNpc3RlbmNlUmVzdWx0LCB1c2VyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAocGVyc2lzdGVuY2VTZXR0aW5ncy5lbmFibGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0SW5kZXhlZERiUGVyc2lzdGVuY2UodXNlciwgcGVyc2lzdGVuY2VTZXR0aW5ncylcclxuICAgICAgICAgICAgICAgIC50aGVuKHBlcnNpc3RlbmNlUmVzdWx0LnJlc29sdmUpXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZWdhcmRsZXNzIG9mIHdoZXRoZXIgb3Igbm90IHRoZSByZXRyeSBzdWNjZWVkcywgZnJvbSBhbiB1c2VyXHJcbiAgICAgICAgICAgICAgICAvLyBwZXJzcGVjdGl2ZSwgb2ZmbGluZSBwZXJzaXN0ZW5jZSBoYXMgZmFpbGVkLlxyXG4gICAgICAgICAgICAgICAgcGVyc2lzdGVuY2VSZXN1bHQucmVqZWN0KGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgIC8vIEFuIHVua25vd24gZmFpbHVyZSBvbiB0aGUgZmlyc3Qgc3RhZ2Ugc2h1dHMgZXZlcnl0aGluZyBkb3duLlxyXG4gICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5jYW5GYWxsYmFjayhlcnJvciQkMSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdFcnJvciBlbmFibGluZyBvZmZsaW5lIHN0b3JhZ2UuIEZhbGxpbmcgYmFjayB0bycgK1xyXG4gICAgICAgICAgICAgICAgICAgICcgc3RvcmFnZSBkaXNhYmxlZDogJyArXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN0YXJ0TWVtb3J5UGVyc2lzdGVuY2UoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBXaGVuIHVzZVBlcnNpc3RlbmNlID09IGZhbHNlLCBlbmFibGluZyBvZmZsaW5lIHBlcnNpc3RlbmNlIGlzIGRlZmluZWRcclxuICAgICAgICAgICAgLy8gdG8gdW5jb25kaXRpb25hbGx5IHN1Y2NlZWQuIFRoaXMgYWxsb3dzIHN0YXJ0KCkgdG8gaGF2ZSB0aGUgc2FtZVxyXG4gICAgICAgICAgICAvLyBzaWduYXR1cmUgZm9yIGJvdGggY2FzZXMsIGRlc3BpdGUgdGhlIGZhY3QgdGhhdCB0aGUgcmV0dXJuZWQgcHJvbWlzZVxyXG4gICAgICAgICAgICAvLyBpcyBvbmx5IHVzZWQgaW4gdGhlIGVuYWJsZVBlcnNpc3RlbmNlIGNhbGwuXHJcbiAgICAgICAgICAgIHBlcnNpc3RlbmNlUmVzdWx0LnJlc29sdmUoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnRNZW1vcnlQZXJzaXN0ZW5jZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIERlY2lkZXMgd2hldGhlciB0aGUgcHJvdmlkZWQgZXJyb3IgYWxsb3dzIHVzIHRvIGdyYWNlZnVsbHkgZGlzYWJsZVxyXG4gICAgICogcGVyc2lzdGVuY2UgKGFzIG9wcG9zZWQgdG8gY3Jhc2hpbmcgdGhlIGNsaWVudCkuXHJcbiAgICAgKi9cclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuY2FuRmFsbGJhY2sgPSBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICBpZiAoZXJyb3IkJDEgaW5zdGFuY2VvZiBGaXJlc3RvcmVFcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gKGVycm9yJCQxLmNvZGUgPT09IENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiB8fFxyXG4gICAgICAgICAgICAgICAgZXJyb3IkJDEuY29kZSA9PT0gQ29kZS5VTklNUExFTUVOVEVEKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIERPTUV4Y2VwdGlvbiAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICAgICAgZXJyb3IkJDEgaW5zdGFuY2VvZiBET01FeGNlcHRpb24pIHtcclxuICAgICAgICAgICAgLy8gV2UgZmFsbCBiYWNrIHRvIG1lbW9yeSBwZXJzaXN0ZW5jZSBpZiB3ZSBjYW5ub3Qgd3JpdGUgdGhlIHByaW1hcnlcclxuICAgICAgICAgICAgLy8gbGVhc2UuIFRoaXMgY2FuIGhhcHBlbiBjYW4gZHVyaW5nIGEgc2NoZW1hIG1pZ3JhdGlvbiwgb3IgaWYgd2UgcnVuIG91dFxyXG4gICAgICAgICAgICAvLyBvZiBxdW90YSB3aGVuIHdlIHRyeSB0byB3cml0ZSB0aGUgcHJpbWFyeSBsZWFzZS5cclxuICAgICAgICAgICAgLy8gRm9yIGJvdGggdGhlIGBRdW90YUV4Y2VlZGVkRXJyb3JgIGFuZCB0aGUgIGBBYm9ydEVycm9yYCwgaXQgaXMgc2FmZSB0b1xyXG4gICAgICAgICAgICAvLyBmYWxsIGJhY2sgdG8gbWVtb3J5IHBlcnNpc3RlbmNlIHNpbmNlIGFsbCBtb2RpZmljYXRpb25zIHRvIEluZGV4ZWREYlxyXG4gICAgICAgICAgICAvLyBmYWlsZWQgdG8gY29tbWl0LlxyXG4gICAgICAgICAgICByZXR1cm4gKGVycm9yJCQxLmNvZGUgPT09IERPTV9FWENFUFRJT05fUVVPVEFfRVhDRUVERUQgfHxcclxuICAgICAgICAgICAgICAgIGVycm9yJCQxLmNvZGUgPT09IERPTV9FWENFUFRJT05fQUJPUlRFRCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIEluZGV4ZWREQi1iYXNlZCBwZXJzaXN0ZW5jZS5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBBIHByb21pc2UgaW5kaWNhdGluZyBzdWNjZXNzIG9yIGZhaWx1cmUuXHJcbiAgICAgKi9cclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuc3RhcnRJbmRleGVkRGJQZXJzaXN0ZW5jZSA9IGZ1bmN0aW9uICh1c2VyLCBzZXR0aW5ncykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KHNldHRpbmdzLmVuYWJsZWQsICdTaG91bGQgb25seSBzdGFydCBJbmRleGVkRGIgcGVyc2l0ZW5jZSB3aXRoIG9mZmxpbmUgcGVyc2lzdGVuY2UgZW5hYmxlZC4nKTtcclxuICAgICAgICAvLyBUT0RPKGh0dHA6Ly9iLzMzMzg0NTIzKTogRm9yIG5vdyB3ZSBqdXN0IGRpc2FibGUgZ2FyYmFnZSBjb2xsZWN0aW9uXHJcbiAgICAgICAgLy8gd2hlbiBwZXJzaXN0ZW5jZSBpcyBlbmFibGVkLlxyXG4gICAgICAgIHZhciBzdG9yYWdlUHJlZml4ID0gSW5kZXhlZERiUGVyc2lzdGVuY2UuYnVpbGRTdG9yYWdlUHJlZml4KHRoaXMuZGF0YWJhc2VJbmZvKTtcclxuICAgICAgICAvLyBPcHQgdG8gdXNlIHByb3RvMyBKU09OIGluIGNhc2UgdGhlIHBsYXRmb3JtIGRvZXNuJ3Qgc3VwcG9ydCBVaW50OEFycmF5LlxyXG4gICAgICAgIHZhciBzZXJpYWxpemVyID0gbmV3IEpzb25Qcm90b1NlcmlhbGl6ZXIodGhpcy5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCwge1xyXG4gICAgICAgICAgICB1c2VQcm90bzNKc29uOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfYSwgX2I7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmV4cGVyaW1lbnRhbFRhYlN5bmNocm9uaXphdGlvbiAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIVdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5pc0F2YWlsYWJsZSh0aGlzLnBsYXRmb3JtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5JTVBMRU1FTlRFRCwgJ0luZGV4ZWREQiBwZXJzaXN0ZW5jZSBpcyBvbmx5IGF2YWlsYWJsZSBvbiBwbGF0Zm9ybXMgdGhhdCBzdXBwb3J0IExvY2FsU3RvcmFnZS4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNldHRpbmdzLmV4cGVyaW1lbnRhbFRhYlN5bmNocm9uaXphdGlvbikgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSBuZXcgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlKHRoaXMuYXN5bmNRdWV1ZSwgdGhpcy5wbGF0Zm9ybSwgc3RvcmFnZVByZWZpeCwgdGhpcy5jbGllbnRJZCwgdXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgSW5kZXhlZERiUGVyc2lzdGVuY2UuY3JlYXRlTXVsdGlDbGllbnRJbmRleGVkRGJQZXJzaXN0ZW5jZShzdG9yYWdlUHJlZml4LCB0aGlzLmNsaWVudElkLCB0aGlzLnBsYXRmb3JtLCB0aGlzLmFzeW5jUXVldWUsIHNlcmlhbGl6ZXIsIHsgc2VxdWVuY2VOdW1iZXJTeW5jZXI6IHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EucGVyc2lzdGVuY2UgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IG5ldyBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEluZGV4ZWREYlBlcnNpc3RlbmNlLmNyZWF0ZUluZGV4ZWREYlBlcnNpc3RlbmNlKHN0b3JhZ2VQcmVmaXgsIHRoaXMuY2xpZW50SWQsIHRoaXMucGxhdGZvcm0sIHRoaXMuYXN5bmNRdWV1ZSwgc2VyaWFsaXplcildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IucGVyc2lzdGVuY2UgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gNDtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIE1lbW9yeS1iYWNrZWQgcGVyc2lzdGVuY2UuIEluIHByYWN0aWNlIHRoaXMgY2Fubm90IGZhaWwuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgd2lsbCBzdWNjZXNzZnVsbHkgcmVzb2x2ZS5cclxuICAgICAqL1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5zdGFydE1lbW9yeVBlcnNpc3RlbmNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIE9wdCB0byB1c2UgcHJvdG8zIEpTT04gaW4gY2FzZSB0aGUgcGxhdGZvcm0gZG9lc24ndCBzdXBwb3J0IFVpbnQ4QXJyYXkuXHJcbiAgICAgICAgdmFyIHNlcmlhbGl6ZXIgPSBuZXcgSnNvblByb3RvU2VyaWFsaXplcih0aGlzLmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkLCB7XHJcbiAgICAgICAgICAgIHVzZVByb3RvM0pzb246IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gTWVtb3J5UGVyc2lzdGVuY2UuY3JlYXRlRWFnZXJQZXJzaXN0ZW5jZSh0aGlzLmNsaWVudElkLCBzZXJpYWxpemVyKTtcclxuICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlID0gbmV3IE1lbW9yeVNoYXJlZENsaWVudFN0YXRlKCk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZXMgdGhlIHJlc3Qgb2YgdGhlIEZpcmVzdG9yZUNsaWVudCwgYXNzdW1pbmcgdGhlIGluaXRpYWwgdXNlclxyXG4gICAgICogaGFzIGJlZW4gb2J0YWluZWQgZnJvbSB0aGUgY3JlZGVudGlhbCBwcm92aWRlciBhbmQgc29tZSBwZXJzaXN0ZW5jZVxyXG4gICAgICogaW1wbGVtZW50YXRpb24gaXMgYXZhaWxhYmxlIGluIHRoaXMucGVyc2lzdGVuY2UuXHJcbiAgICAgKi9cclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuaW5pdGlhbGl6ZVJlc3QgPSBmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxMSwgJ0luaXRpYWxpemluZy4gdXNlcj0nLCB1c2VyLnVpZCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGxhdGZvcm1cclxuICAgICAgICAgICAgLmxvYWRDb25uZWN0aW9uKHRoaXMuZGF0YWJhc2VJbmZvKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoY29ubmVjdGlvbikgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBzZXJpYWxpemVyLCBkYXRhc3RvcmUsIHJlbW90ZVN0b3JlT25saW5lU3RhdGVDaGFuZ2VkSGFuZGxlciwgc2hhcmVkQ2xpZW50U3RhdGVPbmxpbmVTdGF0ZUNoYW5nZWRIYW5kbGVyO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IG5ldyBMb2NhbFN0b3JlKHRoaXMucGVyc2lzdGVuY2UsIHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJpYWxpemVyID0gdGhpcy5wbGF0Zm9ybS5uZXdTZXJpYWxpemVyKHRoaXMuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhc3RvcmUgPSBuZXcgRGF0YXN0b3JlKHRoaXMuYXN5bmNRdWV1ZSwgY29ubmVjdGlvbiwgdGhpcy5jcmVkZW50aWFscywgc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVN0b3JlT25saW5lU3RhdGVDaGFuZ2VkSGFuZGxlciA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN5bmNFbmdpbmUuYXBwbHlPbmxpbmVTdGF0ZUNoYW5nZShvbmxpbmVTdGF0ZSwgT25saW5lU3RhdGVTb3VyY2UuUmVtb3RlU3RvcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWRDbGllbnRTdGF0ZU9ubGluZVN0YXRlQ2hhbmdlZEhhbmRsZXIgPSBmdW5jdGlvbiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zeW5jRW5naW5lLmFwcGx5T25saW5lU3RhdGVDaGFuZ2Uob25saW5lU3RhdGUsIE9ubGluZVN0YXRlU291cmNlLlNoYXJlZENsaWVudFN0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVTdG9yZSA9IG5ldyBSZW1vdGVTdG9yZSh0aGlzLmxvY2FsU3RvcmUsIGRhdGFzdG9yZSwgdGhpcy5hc3luY1F1ZXVlLCByZW1vdGVTdG9yZU9ubGluZVN0YXRlQ2hhbmdlZEhhbmRsZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN5bmNFbmdpbmUgPSBuZXcgU3luY0VuZ2luZSh0aGlzLmxvY2FsU3RvcmUsIHRoaXMucmVtb3RlU3RvcmUsIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUsIHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlLm9ubGluZVN0YXRlSGFuZGxlciA9IHNoYXJlZENsaWVudFN0YXRlT25saW5lU3RhdGVDaGFuZ2VkSGFuZGxlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHVwIHdpcmluZyBiZXR3ZWVuIHN5bmMgZW5naW5lIGFuZCBvdGhlciBjb21wb25lbnRzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3RlU3RvcmUuc3luY0VuZ2luZSA9IHRoaXMuc3luY0VuZ2luZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zeW5jRW5naW5lID0gdGhpcy5zeW5jRW5naW5lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50TWdyID0gbmV3IEV2ZW50TWFuYWdlcih0aGlzLnN5bmNFbmdpbmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IExvY2FsU3RvcmUgZG9lc24ndCBuZWVkIGFuIGV4cGxpY2l0IHN0YXJ0KCkgb24gdGhlIFdlYi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zdGFydCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBPUlRJTkcgTk9URTogTG9jYWxTdG9yZSBkb2Vzbid0IG5lZWQgYW4gZXhwbGljaXQgc3RhcnQoKSBvbiB0aGUgV2ViLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVtb3RlU3RvcmUuc3RhcnQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGVyc2lzdGVuY2Uuc2V0UHJpbWFyeVN0YXRlTGlzdGVuZXIoZnVuY3Rpb24gKGlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zeW5jRW5naW5lLmFwcGx5UHJpbWFyeVN0YXRlKGlzUHJpbWFyeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBUaGlzIHdpbGwgaW1tZWRpYXRlbHkgY2FsbCB0aGUgbGlzdGVuZXIsIHNvIHdlIG1ha2Ugc3VyZSB0b1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgaXQgYWZ0ZXIgbG9jYWxTdG9yZSAvIHJlbW90ZVN0b3JlIGFyZSBzdGFydGVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuaGFuZGxlQ3JlZGVudGlhbENoYW5nZSA9IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlLnZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MoKTtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDExLCAnQ3JlZGVudGlhbCBDaGFuZ2VkLiBDdXJyZW50IHVzZXI6ICcgKyB1c2VyLnVpZCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlKHVzZXIpO1xyXG4gICAgfTtcclxuICAgIC8qKiBEaXNhYmxlcyB0aGUgbmV0d29yayBjb25uZWN0aW9uLiBQZW5kaW5nIG9wZXJhdGlvbnMgd2lsbCBub3QgY29tcGxldGUuICovXHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmRpc2FibGVOZXR3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN5bmNFbmdpbmUuZGlzYWJsZU5ldHdvcmsoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLnNodXRkb3duID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZShmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiBcclxuICAgICAgICAgICAgICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IExvY2FsU3RvcmUgZG9lcyBub3QgbmVlZCBhbiBleHBsaWNpdCBzaHV0ZG93biBvbiB3ZWIuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZW1vdGVTdG9yZS5zaHV0ZG93bigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBPUlRJTkcgTk9URTogTG9jYWxTdG9yZSBkb2VzIG5vdCBuZWVkIGFuIGV4cGxpY2l0IHNodXRkb3duIG9uIHdlYi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlLnNodXRkb3duKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnBlcnNpc3RlbmNlLnNodXRkb3duKG9wdGlvbnMgJiYgb3B0aW9ucy5wdXJnZVBlcnNpc3RlbmNlV2l0aERhdGFMb3NzKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGByZW1vdmVDaGFuZ2VMaXN0ZW5lcmAgbXVzdCBiZSBjYWxsZWQgYWZ0ZXIgc2h1dHRpbmcgZG93biB0aGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3RlU3RvcmUgYXMgaXQgd2lsbCBwcmV2ZW50IHRoZSBSZW1vdGVTdG9yZSBmcm9tIHJldHJpZXZpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXV0aCB0b2tlbnMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlZGVudGlhbHMucmVtb3ZlQ2hhbmdlTGlzdGVuZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAocXVlcnksIG9ic2VydmVyLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgbGlzdGVuZXIgPSBuZXcgUXVlcnlMaXN0ZW5lcihxdWVyeSwgb2JzZXJ2ZXIsIG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmV2ZW50TWdyLmxpc3RlbihsaXN0ZW5lcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGxpc3RlbmVyO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUudW5saXN0ZW4gPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmV2ZW50TWdyLnVubGlzdGVuKGxpc3RlbmVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmdldERvY3VtZW50RnJvbUxvY2FsQ2FjaGUgPSBmdW5jdGlvbiAoZG9jS2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5hc3luY1F1ZXVlXHJcbiAgICAgICAgICAgIC5lbnF1ZXVlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsU3RvcmUucmVhZERvY3VtZW50KGRvY0tleSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF5YmVEb2M7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAobWF5YmVEb2MgaW5zdGFuY2VvZiBOb0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOQVZBSUxBQkxFLCAnRmFpbGVkIHRvIGdldCBkb2N1bWVudCBmcm9tIGNhY2hlLiAoSG93ZXZlciwgdGhpcyBkb2N1bWVudCBtYXkgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgXCJleGlzdCBvbiB0aGUgc2VydmVyLiBSdW4gYWdhaW4gd2l0aG91dCBzZXR0aW5nICdzb3VyY2UnIGluIFwiICtcclxuICAgICAgICAgICAgICAgICAgICAndGhlIEdldE9wdGlvbnMgdG8gYXR0ZW1wdCB0byByZXRyaWV2ZSB0aGUgZG9jdW1lbnQgZnJvbSB0aGUgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgJ3NlcnZlci4pJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmdldERvY3VtZW50c0Zyb21Mb2NhbENhY2hlID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5hc3luY1F1ZXVlXHJcbiAgICAgICAgICAgIC5lbnF1ZXVlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsU3RvcmUuZXhlY3V0ZVF1ZXJ5KHF1ZXJ5KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZG9jcykge1xyXG4gICAgICAgICAgICB2YXIgcmVtb3RlS2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgICAgIHZhciB2aWV3ID0gbmV3IFZpZXcocXVlcnksIHJlbW90ZUtleXMpO1xyXG4gICAgICAgICAgICB2YXIgdmlld0RvY0NoYW5nZXMgPSB2aWV3LmNvbXB1dGVEb2NDaGFuZ2VzKGRvY3MpO1xyXG4gICAgICAgICAgICByZXR1cm4gdmlldy5hcHBseUNoYW5nZXModmlld0RvY0NoYW5nZXMsIFxyXG4gICAgICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gZmFsc2UpLnNuYXBzaG90O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAobXV0YXRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQkMSgpO1xyXG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN5bmNFbmdpbmUud3JpdGUobXV0YXRpb25zLCBkZWZlcnJlZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5kYXRhYmFzZUlkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUudHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAodXBkYXRlRnVuY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFdlIGhhdmUgdG8gd2FpdCBmb3IgdGhlIGFzeW5jIHF1ZXVlIHRvIGJlIHN1cmUgc3luY0VuZ2luZSBpcyBpbml0aWFsaXplZC5cclxuICAgICAgICByZXR1cm4gdGhpcy5hc3luY1F1ZXVlXHJcbiAgICAgICAgICAgIC5lbnF1ZXVlKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgIH0pOyB9KTsgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc3luY0VuZ2luZS5ydW5UcmFuc2FjdGlvbih1cGRhdGVGdW5jdGlvbik7IH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBGaXJlc3RvcmVDbGllbnQ7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKlxyXG4gKiBBIHdyYXBwZXIgaW1wbGVtZW50YXRpb24gb2YgT2JzZXJ2ZXI8VD4gdGhhdCB3aWxsIGRpc3BhdGNoIGV2ZW50c1xyXG4gKiBhc3luY2hyb25vdXNseS4gVG8gYWxsb3cgaW1tZWRpYXRlIHNpbGVuY2luZywgYSBtdXRlIGNhbGwgaXMgYWRkZWQgd2hpY2hcclxuICogY2F1c2VzIGV2ZW50cyBzY2hlZHVsZWQgdG8gbm8gbG9uZ2VyIGJlIHJhaXNlZC5cclxuICovXHJcbnZhciBBc3luY09ic2VydmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXN5bmNPYnNlcnZlcihvYnNlcnZlcikge1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBXaGVuIHNldCB0byB0cnVlLCB3aWxsIG5vdCByYWlzZSBmdXR1cmUgZXZlbnRzLiBOZWNlc3NhcnkgdG8gZGVhbCB3aXRoXHJcbiAgICAgICAgICogYXN5bmMgZGV0YWNobWVudCBvZiBsaXN0ZW5lci5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLm11dGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBBc3luY09ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZUV2ZW50KHRoaXMub2JzZXJ2ZXIubmV4dCwgdmFsdWUpO1xyXG4gICAgfTtcclxuICAgIEFzeW5jT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZUV2ZW50KHRoaXMub2JzZXJ2ZXIuZXJyb3IsIGVycm9yKTtcclxuICAgIH07XHJcbiAgICBBc3luY09ic2VydmVyLnByb3RvdHlwZS5tdXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubXV0ZWQgPSB0cnVlO1xyXG4gICAgfTtcclxuICAgIEFzeW5jT2JzZXJ2ZXIucHJvdG90eXBlLnNjaGVkdWxlRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnRIYW5kbGVyLCBldmVudCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCF0aGlzLm11dGVkKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5tdXRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50SGFuZGxlcihldmVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gQXN5bmNPYnNlcnZlcjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIFRoZSBvYmplY3RzIHRoYXQgYXJlIGEgcGFydCBvZiB0aGlzIEFQSSBhcmUgZXhwb3NlZCB0byB0aGlyZC1wYXJ0aWVzIGFzXHJcbi8vIGNvbXBpbGVkIGphdmFzY3JpcHQgc28gd2Ugd2FudCB0byBmbGFnIG91ciBwcml2YXRlIG1lbWJlcnMgd2l0aCBhIGxlYWRpbmdcclxuLy8gdW5kZXJzY29yZSB0byBkaXNjb3VyYWdlIHRoZWlyIHVzZS5cclxuLy8gdHNsaW50OmRpc2FibGU6c3RyaXAtcHJpdmF0ZS1wcm9wZXJ0eS11bmRlcnNjb3JlXHJcbi8qKlxyXG4gKiBBIEZpZWxkUGF0aCByZWZlcnMgdG8gYSBmaWVsZCBpbiBhIGRvY3VtZW50LiBUaGUgcGF0aCBtYXkgY29uc2lzdCBvZiBhIHNpbmdsZVxyXG4gKiBmaWVsZCBuYW1lIChyZWZlcnJpbmcgdG8gYSB0b3AtbGV2ZWwgZmllbGQgaW4gdGhlIGRvY3VtZW50KSwgb3IgYSBsaXN0IG9mXHJcbiAqIGZpZWxkIG5hbWVzIChyZWZlcnJpbmcgdG8gYSBuZXN0ZWQgZmllbGQgaW4gdGhlIGRvY3VtZW50KS5cclxuICovXHJcbnZhciBGaWVsZFBhdGgkMSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIEZpZWxkUGF0aCBmcm9tIHRoZSBwcm92aWRlZCBmaWVsZCBuYW1lcy4gSWYgbW9yZSB0aGFuIG9uZSBmaWVsZFxyXG4gICAgICogbmFtZSBpcyBwcm92aWRlZCwgdGhlIHBhdGggd2lsbCBwb2ludCB0byBhIG5lc3RlZCBmaWVsZCBpbiBhIGRvY3VtZW50LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBmaWVsZE5hbWVzIEEgbGlzdCBvZiBmaWVsZCBuYW1lcy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gRmllbGRQYXRoJCQxKCkge1xyXG4gICAgICAgIHZhciBmaWVsZE5hbWVzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgZmllbGROYW1lc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZU5hbWVkQXJyYXlBdExlYXN0TnVtYmVyT2ZFbGVtZW50cygnRmllbGRQYXRoJywgZmllbGROYW1lcywgJ2ZpZWxkTmFtZXMnLCAxKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpZWxkTmFtZXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdGaWVsZFBhdGgnLCAnc3RyaW5nJywgaSwgZmllbGROYW1lc1tpXSk7XHJcbiAgICAgICAgICAgIGlmIChmaWVsZE5hbWVzW2ldLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIGZpZWxkIG5hbWUgYXQgYXJndW1lbnQgJChpICsgMSkuIFwiICtcclxuICAgICAgICAgICAgICAgICAgICAnRmllbGQgbmFtZXMgbXVzdCBub3QgYmUgZW1wdHkuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5faW50ZXJuYWxQYXRoID0gbmV3IEZpZWxkUGF0aChmaWVsZE5hbWVzKTtcclxuICAgIH1cclxuICAgIEZpZWxkUGF0aCQkMS5kb2N1bWVudElkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBGaWVsZFBhdGgkJDEuX0RPQ1VNRU5UX0lEO1xyXG4gICAgfTtcclxuICAgIEZpZWxkUGF0aCQkMS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgRmllbGRQYXRoJCQxKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkQ2xhc3NFcnJvcignaXNFcXVhbCcsICdGaWVsZFBhdGgnLCAxLCBvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnRlcm5hbFBhdGguaXNFcXVhbChvdGhlci5faW50ZXJuYWxQYXRoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEludGVybmFsIE5vdGU6IFRoZSBiYWNrZW5kIGRvZXNuJ3QgdGVjaG5pY2FsbHkgc3VwcG9ydCBxdWVyeWluZyBieVxyXG4gICAgICogZG9jdW1lbnQgSUQuIEluc3RlYWQgaXQgcXVlcmllcyBieSB0aGUgZW50aXJlIGRvY3VtZW50IG5hbWUgKGZ1bGwgcGF0aFxyXG4gICAgICogaW5jbHVkZWQpLCBidXQgaW4gdGhlIGNhc2VzIHdlIGN1cnJlbnRseSBzdXBwb3J0IGRvY3VtZW50SWQoKSwgdGhlIG5ldFxyXG4gICAgICogZWZmZWN0IGlzIHRoZSBzYW1lLlxyXG4gICAgICovXHJcbiAgICBGaWVsZFBhdGgkJDEuX0RPQ1VNRU5UX0lEID0gbmV3IEZpZWxkUGF0aCQkMShGaWVsZFBhdGgua2V5RmllbGQoKS5jYW5vbmljYWxTdHJpbmcoKSk7XHJcbiAgICByZXR1cm4gRmllbGRQYXRoJCQxO1xyXG59KCkpO1xyXG4vKipcclxuICogTWF0Y2hlcyBhbnkgY2hhcmFjdGVycyBpbiBhIGZpZWxkIHBhdGggc3RyaW5nIHRoYXQgYXJlIHJlc2VydmVkLlxyXG4gKi9cclxudmFyIFJFU0VSVkVEID0gbmV3IFJlZ0V4cCgnW35cXFxcKi9cXFxcW1xcXFxdXScpO1xyXG4vKipcclxuICogUGFyc2VzIGEgZmllbGQgcGF0aCBzdHJpbmcgaW50byBhIEZpZWxkUGF0aCwgdHJlYXRpbmcgZG90cyBhcyBzZXBhcmF0b3JzLlxyXG4gKi9cclxuZnVuY3Rpb24gZnJvbURvdFNlcGFyYXRlZFN0cmluZyhwYXRoKSB7XHJcbiAgICB2YXIgZm91bmQgPSBwYXRoLnNlYXJjaChSRVNFUlZFRCk7XHJcbiAgICBpZiAoZm91bmQgPj0gMCkge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBmaWVsZCBwYXRoIChcIiArIHBhdGggKyBcIikuIFBhdGhzIG11c3Qgbm90IGNvbnRhaW4gXCIgK1xyXG4gICAgICAgICAgICBcIid+JywgJyonLCAnLycsICdbJywgb3IgJ10nXCIpO1xyXG4gICAgfVxyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gbmV3IChGaWVsZFBhdGgkMS5iaW5kLmFwcGx5KEZpZWxkUGF0aCQxLCBbdm9pZCAwXS5jb25jYXQocGF0aC5zcGxpdCgnLicpKSkpKCk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBmaWVsZCBwYXRoIChcIiArIHBhdGggKyBcIikuIFBhdGhzIG11c3Qgbm90IGJlIGVtcHR5LCBcIiArXHJcbiAgICAgICAgICAgIFwiYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nXCIpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgT0F1dGhUb2tlbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE9BdXRoVG9rZW4odmFsdWUsIHVzZXIpIHtcclxuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgIHRoaXMudHlwZSA9ICdPQXV0aCc7XHJcbiAgICAgICAgdGhpcy5hdXRoSGVhZGVycyA9IHsgQXV0aG9yaXphdGlvbjogXCJCZWFyZXIgXCIgKyB2YWx1ZSB9O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE9BdXRoVG9rZW47XHJcbn0oKSk7XHJcbi8qKiBBIENyZWRlbnRpYWxzUHJvdmlkZXIgdGhhdCBhbHdheXMgeWllbGRzIGFuIGVtcHR5IHRva2VuLiAqL1xyXG52YXIgRW1wdHlDcmVkZW50aWFsc1Byb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRW1wdHlDcmVkZW50aWFsc1Byb3ZpZGVyKCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFN0b3JlcyB0aGUgbGlzdGVuZXIgcmVnaXN0ZXJlZCB3aXRoIHNldENoYW5nZUxpc3RlbmVyKClcclxuICAgICAgICAgKiBUaGlzIGlzbid0IGFjdHVhbGx5IG5lY2Vzc2FyeSBzaW5jZSB0aGUgVUlEIG5ldmVyIGNoYW5nZXMsIGJ1dCB3ZSB1c2UgdGhpc1xyXG4gICAgICAgICAqIHRvIHZlcmlmeSB0aGUgbGlzdGVuIGNvbnRyYWN0IGlzIGFkaGVyZWQgdG8gaW4gdGVzdHMuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jaGFuZ2VMaXN0ZW5lciA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBFbXB0eUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XHJcbiAgICB9O1xyXG4gICAgRW1wdHlDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5pbnZhbGlkYXRlVG9rZW4gPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICBFbXB0eUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLnNldENoYW5nZUxpc3RlbmVyID0gZnVuY3Rpb24gKGNoYW5nZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLmNoYW5nZUxpc3RlbmVyLCAnQ2FuIG9ubHkgY2FsbCBzZXRDaGFuZ2VMaXN0ZW5lcigpIG9uY2UuJyk7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VMaXN0ZW5lciA9IGNoYW5nZUxpc3RlbmVyO1xyXG4gICAgICAgIC8vIEZpcmUgd2l0aCBpbml0aWFsIHVzZXIuXHJcbiAgICAgICAgY2hhbmdlTGlzdGVuZXIoVXNlci5VTkFVVEhFTlRJQ0FURUQpO1xyXG4gICAgfTtcclxuICAgIEVtcHR5Q3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUucmVtb3ZlQ2hhbmdlTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuY2hhbmdlTGlzdGVuZXIgIT09IG51bGwsICdyZW1vdmVDaGFuZ2VMaXN0ZW5lcigpIHdoZW4gbm8gbGlzdGVuZXIgcmVnaXN0ZXJlZCcpO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBFbXB0eUNyZWRlbnRpYWxzUHJvdmlkZXI7XHJcbn0oKSk7XHJcbnZhciBGaXJlYmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJlYmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIoYXBwKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgYXV0aCB0b2tlbiBsaXN0ZW5lciByZWdpc3RlcmVkIHdpdGggRmlyZWJhc2VBcHAsIHJldGFpbmVkIGhlcmUgc28gd2VcclxuICAgICAgICAgKiBjYW4gdW5yZWdpc3RlciBpdC5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRva2VuTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvdW50ZXIgdXNlZCB0byBkZXRlY3QgaWYgdGhlIHRva2VuIGNoYW5nZWQgd2hpbGUgYSBnZXRUb2tlbiByZXF1ZXN0IHdhc1xyXG4gICAgICAgICAqIG91dHN0YW5kaW5nLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMudG9rZW5Db3VudGVyID0gMDtcclxuICAgICAgICAvKiogVGhlIGxpc3RlbmVyIHJlZ2lzdGVyZWQgd2l0aCBzZXRDaGFuZ2VMaXN0ZW5lcigpLiAqL1xyXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZm9yY2VSZWZyZXNoID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy50b2tlbkxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy50b2tlbkNvdW50ZXIrKztcclxuICAgICAgICAgICAgX3RoaXMuY3VycmVudFVzZXIgPSBfdGhpcy5nZXRVc2VyKCk7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5jaGFuZ2VMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY2hhbmdlTGlzdGVuZXIoX3RoaXMuY3VycmVudFVzZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnRva2VuQ291bnRlciA9IDA7XHJcbiAgICAgICAgLy8gV2lsbCBmaXJlIGF0IGxlYXN0IG9uY2Ugd2hlcmUgd2Ugc2V0IHRoaXMuY3VycmVudFVzZXJcclxuICAgICAgICB0aGlzLmFwcC5JTlRFUk5BTC5hZGRBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLnRva2VuTGlzdGVuZXIpO1xyXG4gICAgfVxyXG4gICAgRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnRva2VuTGlzdGVuZXIgIT0gbnVsbCwgJ2dldFRva2VuIGNhbm5vdCBiZSBjYWxsZWQgYWZ0ZXIgbGlzdGVuZXIgcmVtb3ZlZC4nKTtcclxuICAgICAgICAvLyBUYWtlIG5vdGUgb2YgdGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIHRva2VuQ291bnRlciBzbyB0aGF0IHRoaXMgbWV0aG9kXHJcbiAgICAgICAgLy8gY2FuIGZhaWwgKHdpdGggYW4gQUJPUlRFRCBlcnJvcikgaWYgdGhlcmUgaXMgYSB0b2tlbiBjaGFuZ2Ugd2hpbGUgdGhlXHJcbiAgICAgICAgLy8gcmVxdWVzdCBpcyBvdXRzdGFuZGluZy5cclxuICAgICAgICB2YXIgaW5pdGlhbFRva2VuQ291bnRlciA9IHRoaXMudG9rZW5Db3VudGVyO1xyXG4gICAgICAgIHZhciBmb3JjZVJlZnJlc2ggPSB0aGlzLmZvcmNlUmVmcmVzaDtcclxuICAgICAgICB0aGlzLmZvcmNlUmVmcmVzaCA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcC5JTlRFUk5BTC5nZXRUb2tlbihmb3JjZVJlZnJlc2gpLnRoZW4oZnVuY3Rpb24gKHRva2VuRGF0YSkge1xyXG4gICAgICAgICAgICAvLyBDYW5jZWwgdGhlIHJlcXVlc3Qgc2luY2UgdGhlIHRva2VuIGNoYW5nZWQgd2hpbGUgdGhlIHJlcXVlc3Qgd2FzXHJcbiAgICAgICAgICAgIC8vIG91dHN0YW5kaW5nIHNvIHRoZSByZXNwb25zZSBpcyBwb3RlbnRpYWxseSBmb3IgYSBwcmV2aW91cyB1c2VyICh3aGljaFxyXG4gICAgICAgICAgICAvLyB1c2VyLCB3ZSBjYW4ndCBiZSBzdXJlKS5cclxuICAgICAgICAgICAgaWYgKF90aGlzLnRva2VuQ291bnRlciAhPT0gaW5pdGlhbFRva2VuQ291bnRlcikge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuQUJPUlRFRCwgJ2dldFRva2VuIGFib3J0ZWQgZHVlIHRvIHRva2VuIGNoYW5nZS4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0b2tlbkRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQodHlwZW9mIHRva2VuRGF0YS5hY2Nlc3NUb2tlbiA9PT0gJ3N0cmluZycsICdJbnZhbGlkIHRva2VuRGF0YSByZXR1cm5lZCBmcm9tIGdldFRva2VuKCk6JyArIHRva2VuRGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPQXV0aFRva2VuKHRva2VuRGF0YS5hY2Nlc3NUb2tlbiwgX3RoaXMuY3VycmVudFVzZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBGaXJlYmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLmludmFsaWRhdGVUb2tlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmZvcmNlUmVmcmVzaCA9IHRydWU7XHJcbiAgICB9O1xyXG4gICAgRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5zZXRDaGFuZ2VMaXN0ZW5lciA9IGZ1bmN0aW9uIChjaGFuZ2VMaXN0ZW5lcikge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5jaGFuZ2VMaXN0ZW5lciwgJ0NhbiBvbmx5IGNhbGwgc2V0Q2hhbmdlTGlzdGVuZXIoKSBvbmNlLicpO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBjaGFuZ2VMaXN0ZW5lcjtcclxuICAgICAgICAvLyBGaXJlIHRoZSBpbml0aWFsIGV2ZW50LCBidXQgb25seSBpZiB3ZSByZWNlaXZlZCB0aGUgaW5pdGlhbCB1c2VyXHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIpIHtcclxuICAgICAgICAgICAgY2hhbmdlTGlzdGVuZXIodGhpcy5jdXJyZW50VXNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUucmVtb3ZlQ2hhbmdlTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMudG9rZW5MaXN0ZW5lciAhPSBudWxsLCAncmVtb3ZlQ2hhbmdlTGlzdGVuZXIoKSBjYWxsZWQgdHdpY2UnKTtcclxuICAgICAgICBhc3NlcnQodGhpcy5jaGFuZ2VMaXN0ZW5lciAhPT0gbnVsbCwgJ3JlbW92ZUNoYW5nZUxpc3RlbmVyKCkgY2FsbGVkIHdoZW4gbm8gbGlzdGVuZXIgcmVnaXN0ZXJlZCcpO1xyXG4gICAgICAgIHRoaXMuYXBwLklOVEVSTkFMLnJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyKHRoaXMudG9rZW5MaXN0ZW5lcik7XHJcbiAgICAgICAgdGhpcy50b2tlbkxpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gbnVsbDtcclxuICAgIH07XHJcbiAgICBGaXJlYmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRVaWQgPSB0aGlzLmFwcC5JTlRFUk5BTC5nZXRVaWQoKTtcclxuICAgICAgICBhc3NlcnQoY3VycmVudFVpZCA9PT0gbnVsbCB8fCB0eXBlb2YgY3VycmVudFVpZCA9PT0gJ3N0cmluZycsICdSZWNlaXZlZCBpbnZhbGlkIFVJRDogJyArIGN1cnJlbnRVaWQpO1xyXG4gICAgICAgIHJldHVybiBuZXcgVXNlcihjdXJyZW50VWlkKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyO1xyXG59KCkpO1xyXG4vKlxyXG4gKiBGaXJzdFBhcnR5VG9rZW4gcHJvdmlkZXMgYSBmcmVzaCB0b2tlbiBlYWNoIHRpbWUgaXRzIHZhbHVlXHJcbiAqIGlzIHJlcXVlc3RlZCwgYmVjYXVzZSBpZiB0aGUgdG9rZW4gaXMgdG9vIG9sZCwgcmVxdWVzdHMgd2lsbCBiZSByZWplY3RlZC5cclxuICogVE9ETyhiLzMzMTQ3ODE4KSB0aGlzIGltcGxlbWVudGF0aW9uIHZpb2xhdGVzIHRoZSBjdXJyZW50IGFzc3VtcHRpb24gdGhhdFxyXG4gKiB0b2tlbnMgYXJlIGltbXV0YWJsZS4gIFdlIG5lZWQgdG8gZWl0aGVyIHJldmlzaXQgdGhpcyBhc3N1bXB0aW9uIG9yIGNvbWVcclxuICogdXAgd2l0aCBzb21lIHdheSBmb3IgRlBBIHRvIHVzZSB0aGUgbGlzdGVuL3VubGlzdGVuIGludGVyZmFjZS5cclxuICovXHJcbnZhciBGaXJzdFBhcnR5VG9rZW4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJzdFBhcnR5VG9rZW4oZ2FwaSwgc2Vzc2lvbkluZGV4KSB7XHJcbiAgICAgICAgdGhpcy5nYXBpID0gZ2FwaTtcclxuICAgICAgICB0aGlzLnNlc3Npb25JbmRleCA9IHNlc3Npb25JbmRleDtcclxuICAgICAgICB0aGlzLnR5cGUgPSAnRmlyc3RQYXJ0eSc7XHJcbiAgICAgICAgdGhpcy51c2VyID0gVXNlci5GSVJTVF9QQVJUWTtcclxuICAgICAgICBhc3NlcnQodGhpcy5nYXBpICYmXHJcbiAgICAgICAgICAgIHRoaXMuZ2FwaVsnYXV0aCddICYmXHJcbiAgICAgICAgICAgIHRoaXMuZ2FwaVsnYXV0aCddWydnZXRBdXRoSGVhZGVyVmFsdWVGb3JGaXJzdFBhcnR5J10sICd1bmV4cGVjdGVkIGdhcGkgaW50ZXJmYWNlJyk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyc3RQYXJ0eVRva2VuLnByb3RvdHlwZSwgXCJhdXRoSGVhZGVyc1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiB0aGlzLmdhcGlbJ2F1dGgnXVsnZ2V0QXV0aEhlYWRlclZhbHVlRm9yRmlyc3RQYXJ0eSddKFtdKSxcclxuICAgICAgICAgICAgICAgICdYLUdvb2ctQXV0aFVzZXInOiB0aGlzLnNlc3Npb25JbmRleFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIEZpcnN0UGFydHlUb2tlbjtcclxufSgpKTtcclxuLypcclxuICogUHJvdmlkZXMgdXNlciBjcmVkZW50aWFscyByZXF1aXJlZCBmb3IgdGhlIEZpcmVzdG9yZSBKYXZhU2NyaXB0IFNES1xyXG4gKiB0byBhdXRoZW50aWNhdGUgdGhlIHVzZXIsIHVzaW5nIHRlY2huaXF1ZSB0aGF0IGlzIG9ubHkgYXZhaWxhYmxlXHJcbiAqIHRvIGFwcGxpY2F0aW9ucyBob3N0ZWQgYnkgR29vZ2xlLlxyXG4gKi9cclxudmFyIEZpcnN0UGFydHlDcmVkZW50aWFsc1Byb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyc3RQYXJ0eUNyZWRlbnRpYWxzUHJvdmlkZXIoZ2FwaSwgc2Vzc2lvbkluZGV4KSB7XHJcbiAgICAgICAgdGhpcy5nYXBpID0gZ2FwaTtcclxuICAgICAgICB0aGlzLnNlc3Npb25JbmRleCA9IHNlc3Npb25JbmRleDtcclxuICAgICAgICBhc3NlcnQodGhpcy5nYXBpICYmXHJcbiAgICAgICAgICAgIHRoaXMuZ2FwaVsnYXV0aCddICYmXHJcbiAgICAgICAgICAgIHRoaXMuZ2FwaVsnYXV0aCddWydnZXRBdXRoSGVhZGVyVmFsdWVGb3JGaXJzdFBhcnR5J10sICd1bmV4cGVjdGVkIGdhcGkgaW50ZXJmYWNlJyk7XHJcbiAgICB9XHJcbiAgICBGaXJzdFBhcnR5Q3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgRmlyc3RQYXJ0eVRva2VuKHRoaXMuZ2FwaSwgdGhpcy5zZXNzaW9uSW5kZXgpKTtcclxuICAgIH07XHJcbiAgICAvLyBUT0RPKDMzMTA4OTI1KTogY2FuIHNvbWVvbmUgc3dpdGNoIHVzZXJzIHcvbyBhIHBhZ2UgcmVmcmVzaD9cclxuICAgIC8vIFRPRE8oMzMxMTA2MjEpOiBuZWVkIHRvIHVuZGVyc3RhbmQgdG9rZW4vc2Vzc2lvbiBsaWZlY3ljbGVcclxuICAgIEZpcnN0UGFydHlDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5zZXRDaGFuZ2VMaXN0ZW5lciA9IGZ1bmN0aW9uIChjaGFuZ2VMaXN0ZW5lcikge1xyXG4gICAgICAgIC8vIEZpcmUgd2l0aCBpbml0aWFsIHVpZC5cclxuICAgICAgICBjaGFuZ2VMaXN0ZW5lcihVc2VyLkZJUlNUX1BBUlRZKTtcclxuICAgIH07XHJcbiAgICBGaXJzdFBhcnR5Q3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUucmVtb3ZlQ2hhbmdlTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICBGaXJzdFBhcnR5Q3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuaW52YWxpZGF0ZVRva2VuID0gZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgcmV0dXJuIEZpcnN0UGFydHlDcmVkZW50aWFsc1Byb3ZpZGVyO1xyXG59KCkpO1xyXG4vKipcclxuICogQnVpbGRzIGEgQ3JlZGVudGlhbHNQcm92aWRlciBkZXBlbmRpbmcgb24gdGhlIHR5cGUgb2ZcclxuICogdGhlIGNyZWRlbnRpYWxzIHBhc3NlZCBpbi5cclxuICovXHJcbmZ1bmN0aW9uIG1ha2VDcmVkZW50aWFsc1Byb3ZpZGVyKGNyZWRlbnRpYWxzKSB7XHJcbiAgICBpZiAoIWNyZWRlbnRpYWxzKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBFbXB0eUNyZWRlbnRpYWxzUHJvdmlkZXIoKTtcclxuICAgIH1cclxuICAgIHN3aXRjaCAoY3JlZGVudGlhbHMudHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ2dhcGknOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEZpcnN0UGFydHlDcmVkZW50aWFsc1Byb3ZpZGVyKGNyZWRlbnRpYWxzLmNsaWVudCwgY3JlZGVudGlhbHMuc2Vzc2lvbkluZGV4IHx8ICcwJyk7XHJcbiAgICAgICAgY2FzZSAncHJvdmlkZXInOlxyXG4gICAgICAgICAgICByZXR1cm4gY3JlZGVudGlhbHMuY2xpZW50O1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdtYWtlQ3JlZGVudGlhbHNQcm92aWRlciBmYWlsZWQgZHVlIHRvIGludmFsaWQgY3JlZGVudGlhbCB0eXBlJyk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGlzUGFydGlhbE9ic2VydmVyKG9iaikge1xyXG4gICAgcmV0dXJuIGltcGxlbWVudHNBbnlNZXRob2RzJDEob2JqLCBbJ25leHQnLCAnZXJyb3InLCAnY29tcGxldGUnXSk7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgdHJ1ZSBpZiBvYmogaXMgYW4gb2JqZWN0IGFuZCBjb250YWlucyBhdCBsZWFzdCBvbmUgb2YgdGhlIHNwZWNpZmllZFxyXG4gKiBtZXRob2RzLlxyXG4gKi9cclxuZnVuY3Rpb24gaW1wbGVtZW50c0FueU1ldGhvZHMkMShvYmosIG1ldGhvZHMpIHtcclxuICAgIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyB8fCBvYmogPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB2YXIgb2JqZWN0ID0gb2JqO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBtZXRob2RzXzEgPSBtZXRob2RzOyBfaSA8IG1ldGhvZHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgbWV0aG9kID0gbWV0aG9kc18xW19pXTtcclxuICAgICAgICBpZiAobWV0aG9kIGluIG9iamVjdCAmJiB0eXBlb2Ygb2JqZWN0W21ldGhvZF0gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQW4gb3BhcXVlIGJhc2UgY2xhc3MgZm9yIEZpZWxkVmFsdWUgc2VudGluZWwgb2JqZWN0cyBpbiBvdXIgcHVibGljIEFQSSxcclxuICogd2l0aCBwdWJsaWMgc3RhdGljIG1ldGhvZHMgZm9yIGNyZWF0aW5nIHNhaWQgc2VudGluZWwgb2JqZWN0cy5cclxuICovXHJcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjbGFzcy1hcy1uYW1lc3BhY2UgIFdlIHVzZSB0aGlzIGFzIGEgYmFzZSBjbGFzcy5cclxudmFyIEZpZWxkVmFsdWVJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmllbGRWYWx1ZUltcGwoX21ldGhvZE5hbWUpIHtcclxuICAgICAgICB0aGlzLl9tZXRob2ROYW1lID0gX21ldGhvZE5hbWU7XHJcbiAgICB9XHJcbiAgICBGaWVsZFZhbHVlSW1wbC5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIERlbGV0ZUZpZWxkVmFsdWVJbXBsLmluc3RhbmNlO1xyXG4gICAgfTtcclxuICAgIEZpZWxkVmFsdWVJbXBsLnNlcnZlclRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gU2VydmVyVGltZXN0YW1wRmllbGRWYWx1ZUltcGwuaW5zdGFuY2U7XHJcbiAgICB9O1xyXG4gICAgRmllbGRWYWx1ZUltcGwuYXJyYXlVbmlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZWxlbWVudHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBlbGVtZW50c1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ0ZpZWxkVmFsdWUuYXJyYXlVbmlvbicsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgLy8gTk9URTogV2UgZG9uJ3QgYWN0dWFsbHkgcGFyc2UgdGhlIGRhdGEgdW50aWwgaXQncyB1c2VkIGluIHNldCgpIG9yXHJcbiAgICAgICAgLy8gdXBkYXRlKCkgc2luY2Ugd2UgbmVlZCBhY2Nlc3MgdG8gdGhlIEZpcmVzdG9yZSBpbnN0YW5jZS5cclxuICAgICAgICByZXR1cm4gbmV3IEFycmF5VW5pb25GaWVsZFZhbHVlSW1wbChlbGVtZW50cyk7XHJcbiAgICB9O1xyXG4gICAgRmllbGRWYWx1ZUltcGwuYXJyYXlSZW1vdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGVsZW1lbnRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgZWxlbWVudHNbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdGaWVsZFZhbHVlLmFycmF5UmVtb3ZlJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICAvLyBOT1RFOiBXZSBkb24ndCBhY3R1YWxseSBwYXJzZSB0aGUgZGF0YSB1bnRpbCBpdCdzIHVzZWQgaW4gc2V0KCkgb3JcclxuICAgICAgICAvLyB1cGRhdGUoKSBzaW5jZSB3ZSBuZWVkIGFjY2VzcyB0byB0aGUgRmlyZXN0b3JlIGluc3RhbmNlLlxyXG4gICAgICAgIHJldHVybiBuZXcgQXJyYXlSZW1vdmVGaWVsZFZhbHVlSW1wbChlbGVtZW50cyk7XHJcbiAgICB9O1xyXG4gICAgRmllbGRWYWx1ZUltcGwucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcyA9PT0gb3RoZXI7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpZWxkVmFsdWVJbXBsO1xyXG59KCkpO1xyXG52YXIgRGVsZXRlRmllbGRWYWx1ZUltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhEZWxldGVGaWVsZFZhbHVlSW1wbCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIERlbGV0ZUZpZWxkVmFsdWVJbXBsKCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCAnRmllbGRWYWx1ZS5kZWxldGUnKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqIFNpbmdsZXRvbiBpbnN0YW5jZS4gKi9cclxuICAgIERlbGV0ZUZpZWxkVmFsdWVJbXBsLmluc3RhbmNlID0gbmV3IERlbGV0ZUZpZWxkVmFsdWVJbXBsKCk7XHJcbiAgICByZXR1cm4gRGVsZXRlRmllbGRWYWx1ZUltcGw7XHJcbn0oRmllbGRWYWx1ZUltcGwpKTtcclxudmFyIFNlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU2VydmVyVGltZXN0YW1wRmllbGRWYWx1ZUltcGwsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBTZXJ2ZXJUaW1lc3RhbXBGaWVsZFZhbHVlSW1wbCgpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgJ0ZpZWxkVmFsdWUuc2VydmVyVGltZXN0YW1wJykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIC8qKiBTaW5nbGV0b24gaW5zdGFuY2UuICovXHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBGaWVsZFZhbHVlSW1wbC5pbnN0YW5jZSA9IG5ldyBTZXJ2ZXJUaW1lc3RhbXBGaWVsZFZhbHVlSW1wbCgpO1xyXG4gICAgcmV0dXJuIFNlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsO1xyXG59KEZpZWxkVmFsdWVJbXBsKSk7XHJcbnZhciBBcnJheVVuaW9uRmllbGRWYWx1ZUltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhBcnJheVVuaW9uRmllbGRWYWx1ZUltcGwsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBBcnJheVVuaW9uRmllbGRWYWx1ZUltcGwoX2VsZW1lbnRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgJ0ZpZWxkVmFsdWUuYXJyYXlVbmlvbicpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuX2VsZW1lbnRzID0gX2VsZW1lbnRzO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIHJldHVybiBBcnJheVVuaW9uRmllbGRWYWx1ZUltcGw7XHJcbn0oRmllbGRWYWx1ZUltcGwpKTtcclxudmFyIEFycmF5UmVtb3ZlRmllbGRWYWx1ZUltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhBcnJheVJlbW92ZUZpZWxkVmFsdWVJbXBsLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQXJyYXlSZW1vdmVGaWVsZFZhbHVlSW1wbChfZWxlbWVudHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCAnRmllbGRWYWx1ZS5hcnJheVJlbW92ZScpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuX2VsZW1lbnRzID0gX2VsZW1lbnRzO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIHJldHVybiBBcnJheVJlbW92ZUZpZWxkVmFsdWVJbXBsO1xyXG59KEZpZWxkVmFsdWVJbXBsKSk7XHJcbi8vIFB1YmxpYyBpbnN0YW5jZSB0aGF0IGRpc2FsbG93cyBjb25zdHJ1Y3Rpb24gYXQgcnVudGltZS4gVGhpcyBjb25zdHJ1Y3RvciBpc1xyXG4vLyB1c2VkIHdoZW4gZXhwb3J0aW5nIEZpZWxkVmFsdWVJbXBsIG9uIGZpcmViYXNlLmZpcmVzdG9yZS5GaWVsZFZhbHVlIGFuZCB3aWxsXHJcbi8vIGJlIGNhbGxlZCBGaWVsZFZhbHVlIHB1YmxpY2x5LiBJbnRlcm5hbGx5IHdlIHN0aWxsIHVzZSBGaWVsZFZhbHVlSW1wbCB3aGljaFxyXG4vLyBoYXMgYSB0eXBlLWNoZWNrZWQgcHJpdmF0ZSBjb25zdHJ1Y3Rvci4gTm90ZSB0aGF0IEZpZWxkVmFsdWVJbXBsIGFuZFxyXG4vLyBQdWJsaWNGaWVsZFZhbHVlIGNhbiBiZSB1c2VkIGludGVyY2hhbmdlYWJseSBpbiBpbnN0YW5jZW9mIGNoZWNrcy5cclxuLy8gRm9yIG91ciBpbnRlcm5hbCBUeXBlU2NyaXB0IGNvZGUgUHVibGljRmllbGRWYWx1ZSBkb2Vzbid0IGV4aXN0IGFzIGEgdHlwZSxcclxuLy8gYW5kIHNvIHdlIG5lZWQgdG8gdXNlIEZpZWxkVmFsdWVJbXBsIGFzIHR5cGUgYW5kIGV4cG9ydCBpdCB0b28uXHJcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTp2YXJpYWJsZS1uYW1lICBXZSB0cmVhdCB0aGlzIGFzIGEgY2xhc3MgbmFtZS5cclxudmFyIFB1YmxpY0ZpZWxkVmFsdWUgPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKEZpZWxkVmFsdWVJbXBsLCAnVXNlIEZpZWxkVmFsdWUuPGZpZWxkPigpIGluc3RlYWQuJyk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgUkVTRVJWRURfRklFTERfUkVHRVggPSAvXl9fLipfXyQvO1xyXG4vKiogVGhlIHJlc3VsdCBvZiBwYXJzaW5nIGRvY3VtZW50IGRhdGEgKGUuZy4gZm9yIGEgc2V0RGF0YSBjYWxsKS4gKi9cclxudmFyIFBhcnNlZFNldERhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQYXJzZWRTZXREYXRhKGRhdGEsIGZpZWxkTWFzaywgZmllbGRUcmFuc2Zvcm1zKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICB0aGlzLmZpZWxkTWFzayA9IGZpZWxkTWFzaztcclxuICAgICAgICB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IGZpZWxkVHJhbnNmb3JtcztcclxuICAgIH1cclxuICAgIFBhcnNlZFNldERhdGEucHJvdG90eXBlLnRvTXV0YXRpb25zID0gZnVuY3Rpb24gKGtleSwgcHJlY29uZGl0aW9uKSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9ucyA9IFtdO1xyXG4gICAgICAgIGlmICh0aGlzLmZpZWxkTWFzayAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBtdXRhdGlvbnMucHVzaChuZXcgUGF0Y2hNdXRhdGlvbihrZXksIHRoaXMuZGF0YSwgdGhpcy5maWVsZE1hc2ssIHByZWNvbmRpdGlvbikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbXV0YXRpb25zLnB1c2gobmV3IFNldE11dGF0aW9uKGtleSwgdGhpcy5kYXRhLCBwcmVjb25kaXRpb24pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZmllbGRUcmFuc2Zvcm1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbXV0YXRpb25zLnB1c2gobmV3IFRyYW5zZm9ybU11dGF0aW9uKGtleSwgdGhpcy5maWVsZFRyYW5zZm9ybXMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9ucztcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGFyc2VkU2V0RGF0YTtcclxufSgpKTtcclxuLyoqIFRoZSByZXN1bHQgb2YgcGFyc2luZyBcInVwZGF0ZVwiIGRhdGEgKGkuZS4gZm9yIGFuIHVwZGF0ZURhdGEgY2FsbCkuICovXHJcbnZhciBQYXJzZWRVcGRhdGVEYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGFyc2VkVXBkYXRlRGF0YShkYXRhLCBmaWVsZE1hc2ssIGZpZWxkVHJhbnNmb3Jtcykge1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5maWVsZE1hc2sgPSBmaWVsZE1hc2s7XHJcbiAgICAgICAgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBmaWVsZFRyYW5zZm9ybXM7XHJcbiAgICB9XHJcbiAgICBQYXJzZWRVcGRhdGVEYXRhLnByb3RvdHlwZS50b011dGF0aW9ucyA9IGZ1bmN0aW9uIChrZXksIHByZWNvbmRpdGlvbikge1xyXG4gICAgICAgIHZhciBtdXRhdGlvbnMgPSBbXHJcbiAgICAgICAgICAgIG5ldyBQYXRjaE11dGF0aW9uKGtleSwgdGhpcy5kYXRhLCB0aGlzLmZpZWxkTWFzaywgcHJlY29uZGl0aW9uKVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgaWYgKHRoaXMuZmllbGRUcmFuc2Zvcm1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbXV0YXRpb25zLnB1c2gobmV3IFRyYW5zZm9ybU11dGF0aW9uKGtleSwgdGhpcy5maWVsZFRyYW5zZm9ybXMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9ucztcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGFyc2VkVXBkYXRlRGF0YTtcclxufSgpKTtcclxuLypcclxuICogUmVwcmVzZW50cyB3aGF0IHR5cGUgb2YgQVBJIG1ldGhvZCBwcm92aWRlZCB0aGUgZGF0YSBiZWluZyBwYXJzZWQ7IHVzZWZ1bFxyXG4gKiBmb3IgZGV0ZXJtaW5pbmcgd2hpY2ggZXJyb3IgY29uZGl0aW9ucyBhcHBseSBkdXJpbmcgcGFyc2luZyBhbmQgcHJvdmlkaW5nXHJcbiAqIGJldHRlciBlcnJvciBtZXNzYWdlcy5cclxuICovXHJcbnZhciBVc2VyRGF0YVNvdXJjZTtcclxuKGZ1bmN0aW9uIChVc2VyRGF0YVNvdXJjZSkge1xyXG4gICAgVXNlckRhdGFTb3VyY2VbVXNlckRhdGFTb3VyY2VbXCJTZXRcIl0gPSAwXSA9IFwiU2V0XCI7XHJcbiAgICBVc2VyRGF0YVNvdXJjZVtVc2VyRGF0YVNvdXJjZVtcIlVwZGF0ZVwiXSA9IDFdID0gXCJVcGRhdGVcIjtcclxuICAgIFVzZXJEYXRhU291cmNlW1VzZXJEYXRhU291cmNlW1wiTWVyZ2VTZXRcIl0gPSAyXSA9IFwiTWVyZ2VTZXRcIjtcclxuICAgIC8qKlxyXG4gICAgICogSW5kaWNhdGVzIHRoZSBzb3VyY2UgaXMgYSB3aGVyZSBjbGF1c2UsIGN1cnNvciBib3VuZCwgYXJyYXlVbmlvbigpXHJcbiAgICAgKiBlbGVtZW50LCBldGMuIE9mIG5vdGUsIGlzV3JpdGUoc291cmNlKSB3aWxsIHJldHVybiBmYWxzZS5cclxuICAgICAqL1xyXG4gICAgVXNlckRhdGFTb3VyY2VbVXNlckRhdGFTb3VyY2VbXCJBcmd1bWVudFwiXSA9IDNdID0gXCJBcmd1bWVudFwiO1xyXG59KShVc2VyRGF0YVNvdXJjZSB8fCAoVXNlckRhdGFTb3VyY2UgPSB7fSkpO1xyXG5mdW5jdGlvbiBpc1dyaXRlKGRhdGFTb3VyY2UpIHtcclxuICAgIHN3aXRjaCAoZGF0YVNvdXJjZSkge1xyXG4gICAgICAgIGNhc2UgVXNlckRhdGFTb3VyY2UuU2V0OiAvLyBmYWxsIHRocm91Z2hcclxuICAgICAgICBjYXNlIFVzZXJEYXRhU291cmNlLk1lcmdlU2V0OiAvLyBmYWxsIHRocm91Z2hcclxuICAgICAgICBjYXNlIFVzZXJEYXRhU291cmNlLlVwZGF0ZTpcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgY2FzZSBVc2VyRGF0YVNvdXJjZS5Bcmd1bWVudDpcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHRocm93IGZhaWwoXCJVbmV4cGVjdGVkIGNhc2UgZm9yIFVzZXJEYXRhU291cmNlOiBcIiArIGRhdGFTb3VyY2UpO1xyXG4gICAgfVxyXG59XHJcbi8qKiBBIFwiY29udGV4dFwiIG9iamVjdCBwYXNzZWQgYXJvdW5kIHdoaWxlIHBhcnNpbmcgdXNlciBkYXRhLiAqL1xyXG52YXIgUGFyc2VDb250ZXh0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWFsaXplcyBhIFBhcnNlQ29udGV4dCB3aXRoIHRoZSBnaXZlbiBzb3VyY2UgYW5kIHBhdGguXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGRhdGFTb3VyY2UgSW5kaWNhdGVzIHdoYXQga2luZCBvZiBBUEkgbWV0aG9kIHRoaXMgZGF0YSBjYW1lIGZyb20uXHJcbiAgICAgKiBAcGFyYW0gbWV0aG9kTmFtZSBUaGUgbmFtZSBvZiB0aGUgbWV0aG9kIHRoZSB1c2VyIGNhbGxlZCB0byBjcmVhdGUgdGhpc1xyXG4gICAgICogICAgIFBhcnNlQ29udGV4dC5cclxuICAgICAqIEBwYXJhbSBwYXRoIEEgcGF0aCB3aXRoaW4gdGhlIG9iamVjdCBiZWluZyBwYXJzZWQuIFRoaXMgY291bGQgYmUgYW4gZW1wdHlcclxuICAgICAqICAgICBwYXRoIChpbiB3aGljaCBjYXNlIHRoZSBjb250ZXh0IHJlcHJlc2VudHMgdGhlIHJvb3Qgb2YgdGhlIGRhdGEgYmVpbmdcclxuICAgICAqICAgICBwYXJzZWQpLCBvciBhIG5vbmVtcHR5IHBhdGggKGluZGljYXRpbmcgdGhlIGNvbnRleHQgcmVwcmVzZW50cyBhIG5lc3RlZFxyXG4gICAgICogICAgIGxvY2F0aW9uIHdpdGhpbiB0aGUgZGF0YSkuXHJcbiAgICAgKiBAcGFyYW0gYXJyYXlFbGVtZW50IFdoZXRoZXIgb3Igbm90IHRoaXMgY29udGV4dCBjb3JyZXNwb25kcyB0byBhbiBlbGVtZW50XHJcbiAgICAgKiAgICAgb2YgYW4gYXJyYXkuXHJcbiAgICAgKiBAcGFyYW0gZmllbGRUcmFuc2Zvcm1zIEEgbXV0YWJsZSBsaXN0IG9mIGZpZWxkIHRyYW5zZm9ybXMgZW5jb3VudGVyZWQgd2hpbGVcclxuICAgICAqICAgICBwYXJzaW5nIHRoZSBkYXRhLlxyXG4gICAgICogQHBhcmFtIGZpZWxkTWFzayBBIG11dGFibGUgbGlzdCBvZiBmaWVsZCBwYXRocyBlbmNvdW50ZXJlZCB3aGlsZSBwYXJzaW5nXHJcbiAgICAgKiAgICAgdGhlIGRhdGEuXHJcbiAgICAgKlxyXG4gICAgICogVE9ETyhiLzM0ODcxMTMxKTogV2UgZG9uJ3Qgc3VwcG9ydCBhcnJheSBwYXRocyByaWdodCBub3csIHNvIHBhdGggY2FuIGJlXHJcbiAgICAgKiBudWxsIHRvIGluZGljYXRlIHRoZSBjb250ZXh0IHJlcHJlc2VudHMgYW55IGxvY2F0aW9uIHdpdGhpbiBhbiBhcnJheSAoaW5cclxuICAgICAqIHdoaWNoIGNhc2UgY2VydGFpbiBmZWF0dXJlcyB3aWxsIG5vdCB3b3JrIGFuZCBlcnJvcnMgd2lsbCBiZSBzb21ld2hhdFxyXG4gICAgICogY29tcHJvbWlzZWQpLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBQYXJzZUNvbnRleHQoZGF0YVNvdXJjZSwgbWV0aG9kTmFtZSwgcGF0aCwgYXJyYXlFbGVtZW50LCBmaWVsZFRyYW5zZm9ybXMsIGZpZWxkTWFzaykge1xyXG4gICAgICAgIHRoaXMuZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XHJcbiAgICAgICAgdGhpcy5tZXRob2ROYW1lID0gbWV0aG9kTmFtZTtcclxuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xyXG4gICAgICAgIHRoaXMuYXJyYXlFbGVtZW50ID0gYXJyYXlFbGVtZW50O1xyXG4gICAgICAgIC8vIE1pbm9yIGhhY2s6IElmIGZpZWxkVHJhbnNmb3JtcyBpcyB1bmRlZmluZWQsIHdlIGFzc3VtZSB0aGlzIGlzIGFuXHJcbiAgICAgICAgLy8gZXh0ZXJuYWwgY2FsbCBhbmQgd2UgbmVlZCB0byB2YWxpZGF0ZSB0aGUgZW50aXJlIHBhdGguXHJcbiAgICAgICAgaWYgKGZpZWxkVHJhbnNmb3JtcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsaWRhdGVQYXRoKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXJyYXlFbGVtZW50ID0gYXJyYXlFbGVtZW50ICE9PSB1bmRlZmluZWQgPyBhcnJheUVsZW1lbnQgOiBmYWxzZTtcclxuICAgICAgICB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IGZpZWxkVHJhbnNmb3JtcyB8fCBbXTtcclxuICAgICAgICB0aGlzLmZpZWxkTWFzayA9IGZpZWxkTWFzayB8fCBbXTtcclxuICAgIH1cclxuICAgIFBhcnNlQ29udGV4dC5wcm90b3R5cGUuY2hpbGRDb250ZXh0Rm9yRmllbGQgPSBmdW5jdGlvbiAoZmllbGQpIHtcclxuICAgICAgICB2YXIgY2hpbGRQYXRoID0gdGhpcy5wYXRoID09IG51bGwgPyBudWxsIDogdGhpcy5wYXRoLmNoaWxkKGZpZWxkKTtcclxuICAgICAgICB2YXIgY29udGV4dCA9IG5ldyBQYXJzZUNvbnRleHQodGhpcy5kYXRhU291cmNlLCB0aGlzLm1ldGhvZE5hbWUsIGNoaWxkUGF0aCwgXHJcbiAgICAgICAgLyphcnJheUVsZW1lbnQ9Ki8gZmFsc2UsIHRoaXMuZmllbGRUcmFuc2Zvcm1zLCB0aGlzLmZpZWxkTWFzayk7XHJcbiAgICAgICAgY29udGV4dC52YWxpZGF0ZVBhdGhTZWdtZW50KGZpZWxkKTtcclxuICAgICAgICByZXR1cm4gY29udGV4dDtcclxuICAgIH07XHJcbiAgICBQYXJzZUNvbnRleHQucHJvdG90eXBlLmNoaWxkQ29udGV4dEZvckZpZWxkUGF0aCA9IGZ1bmN0aW9uIChmaWVsZCkge1xyXG4gICAgICAgIHZhciBjaGlsZFBhdGggPSB0aGlzLnBhdGggPT0gbnVsbCA/IG51bGwgOiB0aGlzLnBhdGguY2hpbGQoZmllbGQpO1xyXG4gICAgICAgIHZhciBjb250ZXh0ID0gbmV3IFBhcnNlQ29udGV4dCh0aGlzLmRhdGFTb3VyY2UsIHRoaXMubWV0aG9kTmFtZSwgY2hpbGRQYXRoLCBcclxuICAgICAgICAvKmFycmF5RWxlbWVudD0qLyBmYWxzZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMsIHRoaXMuZmllbGRNYXNrKTtcclxuICAgICAgICBjb250ZXh0LnZhbGlkYXRlUGF0aCgpO1xyXG4gICAgICAgIHJldHVybiBjb250ZXh0O1xyXG4gICAgfTtcclxuICAgIFBhcnNlQ29udGV4dC5wcm90b3R5cGUuY2hpbGRDb250ZXh0Rm9yQXJyYXkgPSBmdW5jdGlvbiAoaW5kZXgpIHtcclxuICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBXZSBkb24ndCBzdXBwb3J0IGFycmF5IHBhdGhzIHJpZ2h0IG5vdzsgc28gbWFrZSBwYXRoXHJcbiAgICAgICAgLy8gbnVsbC5cclxuICAgICAgICByZXR1cm4gbmV3IFBhcnNlQ29udGV4dCh0aGlzLmRhdGFTb3VyY2UsIHRoaXMubWV0aG9kTmFtZSwgXHJcbiAgICAgICAgLypwYXRoPSovIG51bGwsIFxyXG4gICAgICAgIC8qYXJyYXlFbGVtZW50PSovIHRydWUsIHRoaXMuZmllbGRUcmFuc2Zvcm1zLCB0aGlzLmZpZWxkTWFzayk7XHJcbiAgICB9O1xyXG4gICAgUGFyc2VDb250ZXh0LnByb3RvdHlwZS5jcmVhdGVFcnJvciA9IGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICB2YXIgZmllbGREZXNjcmlwdGlvbiA9IHRoaXMucGF0aCA9PT0gbnVsbCB8fCB0aGlzLnBhdGguaXNFbXB0eSgpXHJcbiAgICAgICAgICAgID8gJydcclxuICAgICAgICAgICAgOiBcIiAoZm91bmQgaW4gZmllbGQgXCIgKyB0aGlzLnBhdGgudG9TdHJpbmcoKSArIFwiKVwiO1xyXG4gICAgICAgIHJldHVybiBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgdGhpcy5tZXRob2ROYW1lICsgXCIoKSBjYWxsZWQgd2l0aCBpbnZhbGlkIGRhdGEuIFwiICtcclxuICAgICAgICAgICAgcmVhc29uICtcclxuICAgICAgICAgICAgZmllbGREZXNjcmlwdGlvbik7XHJcbiAgICB9O1xyXG4gICAgLyoqIFJldHVybnMgJ3RydWUnIGlmICdmaWVsZFBhdGgnIHdhcyB0cmF2ZXJzZWQgd2hlbiBjcmVhdGluZyB0aGlzIGNvbnRleHQuICovXHJcbiAgICBQYXJzZUNvbnRleHQucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24gKGZpZWxkUGF0aCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5maWVsZE1hc2suZmluZChmdW5jdGlvbiAoZmllbGQpIHsgcmV0dXJuIGZpZWxkUGF0aC5pc1ByZWZpeE9mKGZpZWxkKTsgfSkgIT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICAgICAgICB0aGlzLmZpZWxkVHJhbnNmb3Jtcy5maW5kKGZ1bmN0aW9uICh0cmFuc2Zvcm0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWVsZFBhdGguaXNQcmVmaXhPZih0cmFuc2Zvcm0uZmllbGQpO1xyXG4gICAgICAgICAgICB9KSAhPT0gdW5kZWZpbmVkKTtcclxuICAgIH07XHJcbiAgICBQYXJzZUNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlUGF0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBSZW1vdmUgbnVsbCBjaGVjayBvbmNlIHdlIGhhdmUgcHJvcGVyIHBhdGhzIGZvciBmaWVsZHNcclxuICAgICAgICAvLyB3aXRoaW4gYXJyYXlzLlxyXG4gICAgICAgIGlmICh0aGlzLnBhdGggPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGF0aC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlUGF0aFNlZ21lbnQodGhpcy5wYXRoLmdldChpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFBhcnNlQ29udGV4dC5wcm90b3R5cGUudmFsaWRhdGVQYXRoU2VnbWVudCA9IGZ1bmN0aW9uIChzZWdtZW50KSB7XHJcbiAgICAgICAgaWYgKGlzV3JpdGUodGhpcy5kYXRhU291cmNlKSAmJiBSRVNFUlZFRF9GSUVMRF9SRUdFWC50ZXN0KHNlZ21lbnQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IHRoaXMuY3JlYXRlRXJyb3IoJ0RvY3VtZW50IGZpZWxkcyBjYW5ub3QgYmVnaW4gYW5kIGVuZCB3aXRoIF9fJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBQYXJzZUNvbnRleHQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIHBsYWNlaG9sZGVyIG9iamVjdCBmb3IgRG9jdW1lbnRSZWZlcmVuY2VzIGluIHRoaXMgZmlsZSwgaW4gb3JkZXIgdG9cclxuICogYXZvaWQgYSBjaXJjdWxhciBkZXBlbmRlbmN5LiBTZWUgdGhlIGNvbW1lbnRzIGZvciBgRGF0YVByZUNvbnZlcnRlcmAgZm9yXHJcbiAqIHRoZSBmdWxsIGNvbnRleHQuXHJcbiAqL1xyXG52YXIgRG9jdW1lbnRLZXlSZWZlcmVuY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEb2N1bWVudEtleVJlZmVyZW5jZShkYXRhYmFzZUlkLCBrZXkpIHtcclxuICAgICAgICB0aGlzLmRhdGFiYXNlSWQgPSBkYXRhYmFzZUlkO1xyXG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIERvY3VtZW50S2V5UmVmZXJlbmNlO1xyXG59KCkpO1xyXG4vKipcclxuICogSGVscGVyIGZvciBwYXJzaW5nIHJhdyB1c2VyIGlucHV0IChwcm92aWRlZCB2aWEgdGhlIEFQSSkgaW50byBpbnRlcm5hbCBtb2RlbFxyXG4gKiBjbGFzc2VzLlxyXG4gKi9cclxudmFyIFVzZXJEYXRhQ29udmVydGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVXNlckRhdGFDb252ZXJ0ZXIocHJlQ29udmVydGVyKSB7XHJcbiAgICAgICAgdGhpcy5wcmVDb252ZXJ0ZXIgPSBwcmVDb252ZXJ0ZXI7XHJcbiAgICB9XHJcbiAgICAvKiogUGFyc2UgZG9jdW1lbnQgZGF0YSBmcm9tIGEgbm9uLW1lcmdlIHNldCgpIGNhbGwuICovXHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VTZXREYXRhID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIGlucHV0KSB7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgUGFyc2VDb250ZXh0KFVzZXJEYXRhU291cmNlLlNldCwgbWV0aG9kTmFtZSwgRmllbGRQYXRoLkVNUFRZX1BBVEgpO1xyXG4gICAgICAgIHZhbGlkYXRlUGxhaW5PYmplY3QoJ0RhdGEgbXVzdCBiZSBhbiBvYmplY3QsIGJ1dCBpdCB3YXM6JywgY29udGV4dCwgaW5wdXQpO1xyXG4gICAgICAgIHZhciB1cGRhdGVEYXRhID0gdGhpcy5wYXJzZURhdGEoaW5wdXQsIGNvbnRleHQpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUGFyc2VkU2V0RGF0YSh1cGRhdGVEYXRhLCBcclxuICAgICAgICAvKiBmaWVsZE1hc2s9ICovIG51bGwsIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zKTtcclxuICAgIH07XHJcbiAgICAvKiogUGFyc2UgZG9jdW1lbnQgZGF0YSBmcm9tIGEgc2V0KCkgY2FsbCB3aXRoICd7bWVyZ2U6dHJ1ZX0nLiAqL1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlTWVyZ2VEYXRhID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIGlucHV0LCBmaWVsZFBhdGhzKSB7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgUGFyc2VDb250ZXh0KFVzZXJEYXRhU291cmNlLk1lcmdlU2V0LCBtZXRob2ROYW1lLCBGaWVsZFBhdGguRU1QVFlfUEFUSCk7XHJcbiAgICAgICAgdmFsaWRhdGVQbGFpbk9iamVjdCgnRGF0YSBtdXN0IGJlIGFuIG9iamVjdCwgYnV0IGl0IHdhczonLCBjb250ZXh0LCBpbnB1dCk7XHJcbiAgICAgICAgdmFyIHVwZGF0ZURhdGEgPSB0aGlzLnBhcnNlRGF0YShpbnB1dCwgY29udGV4dCk7XHJcbiAgICAgICAgdmFyIGZpZWxkTWFzaztcclxuICAgICAgICB2YXIgZmllbGRUcmFuc2Zvcm1zO1xyXG4gICAgICAgIGlmICghZmllbGRQYXRocykge1xyXG4gICAgICAgICAgICBmaWVsZE1hc2sgPSBuZXcgRmllbGRNYXNrKGNvbnRleHQuZmllbGRNYXNrKTtcclxuICAgICAgICAgICAgZmllbGRUcmFuc2Zvcm1zID0gY29udGV4dC5maWVsZFRyYW5zZm9ybXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgdmFsaWRhdGVkRmllbGRQYXRocyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGZpZWxkUGF0aHNfMSA9IGZpZWxkUGF0aHM7IF9pIDwgZmllbGRQYXRoc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0cmluZ09yRmllbGRQYXRoID0gZmllbGRQYXRoc18xW19pXTtcclxuICAgICAgICAgICAgICAgIHZhciBmaWVsZFBhdGggPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RyaW5nT3JGaWVsZFBhdGggaW5zdGFuY2VvZiBGaWVsZFBhdGgkMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkUGF0aCA9IHN0cmluZ09yRmllbGRQYXRoLl9pbnRlcm5hbFBhdGg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2Ygc3RyaW5nT3JGaWVsZFBhdGggPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRQYXRoID0gZmllbGRQYXRoRnJvbURvdFNlcGFyYXRlZFN0cmluZyhtZXRob2ROYW1lLCBzdHJpbmdPckZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBmYWlsKCdFeHBlY3RlZCBzdHJpbmdPckZpZWxkUGF0aCB0byBiZSBhIHN0cmluZyBvciBhIEZpZWxkUGF0aCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFjb250ZXh0LmNvbnRhaW5zKGZpZWxkUGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZpZWxkICdcIiArIGZpZWxkUGF0aCArIFwiJyBpcyBzcGVjaWZpZWQgaW4geW91ciBmaWVsZCBtYXNrIGJ1dCBtaXNzaW5nIGZyb20geW91ciBpbnB1dCBkYXRhLlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhbGlkYXRlZEZpZWxkUGF0aHMucHVzaChmaWVsZFBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpZWxkTWFzayA9IG5ldyBGaWVsZE1hc2sodmFsaWRhdGVkRmllbGRQYXRocyk7XHJcbiAgICAgICAgICAgIGZpZWxkVHJhbnNmb3JtcyA9IGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zLmZpbHRlcihmdW5jdGlvbiAodHJhbnNmb3JtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGRNYXNrLmNvdmVycyh0cmFuc2Zvcm0uZmllbGQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQYXJzZWRTZXREYXRhKHVwZGF0ZURhdGEsIGZpZWxkTWFzaywgZmllbGRUcmFuc2Zvcm1zKTtcclxuICAgIH07XHJcbiAgICAvKiogUGFyc2UgdXBkYXRlIGRhdGEgZnJvbSBhbiB1cGRhdGUoKSBjYWxsLiAqL1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlVXBkYXRlRGF0YSA9IGZ1bmN0aW9uIChtZXRob2ROYW1lLCBpbnB1dCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgUGFyc2VDb250ZXh0KFVzZXJEYXRhU291cmNlLlVwZGF0ZSwgbWV0aG9kTmFtZSwgRmllbGRQYXRoLkVNUFRZX1BBVEgpO1xyXG4gICAgICAgIHZhbGlkYXRlUGxhaW5PYmplY3QoJ0RhdGEgbXVzdCBiZSBhbiBvYmplY3QsIGJ1dCBpdCB3YXM6JywgY29udGV4dCwgaW5wdXQpO1xyXG4gICAgICAgIHZhciBmaWVsZE1hc2tQYXRocyA9IFtdO1xyXG4gICAgICAgIHZhciB1cGRhdGVEYXRhID0gT2JqZWN0VmFsdWUuRU1QVFk7XHJcbiAgICAgICAgZm9yRWFjaChpbnB1dCwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBmaWVsZFBhdGhGcm9tRG90U2VwYXJhdGVkU3RyaW5nKG1ldGhvZE5hbWUsIGtleSk7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZENvbnRleHQgPSBjb250ZXh0LmNoaWxkQ29udGV4dEZvckZpZWxkUGF0aChwYXRoKTtcclxuICAgICAgICAgICAgdmFsdWUgPSBfdGhpcy5ydW5QcmVDb252ZXJ0ZXIodmFsdWUsIGNoaWxkQ29udGV4dCk7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERlbGV0ZUZpZWxkVmFsdWVJbXBsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIGZpZWxkIG1hc2ssIGJ1dCBkb24ndCBhZGQgYW55dGhpbmcgdG8gdXBkYXRlRGF0YS5cclxuICAgICAgICAgICAgICAgIGZpZWxkTWFza1BhdGhzLnB1c2gocGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyc2VkVmFsdWUgPSBfdGhpcy5wYXJzZURhdGEodmFsdWUsIGNoaWxkQ29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VkVmFsdWUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTWFza1BhdGhzLnB1c2gocGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0YSA9IHVwZGF0ZURhdGEuc2V0KHBhdGgsIHBhcnNlZFZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBtYXNrID0gbmV3IEZpZWxkTWFzayhmaWVsZE1hc2tQYXRocyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQYXJzZWRVcGRhdGVEYXRhKHVwZGF0ZURhdGEsIG1hc2ssIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zKTtcclxuICAgIH07XHJcbiAgICAvKiogUGFyc2UgdXBkYXRlIGRhdGEgZnJvbSBhIGxpc3Qgb2YgZmllbGQvdmFsdWUgYXJndW1lbnRzLiAqL1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlVXBkYXRlVmFyYXJncyA9IGZ1bmN0aW9uIChtZXRob2ROYW1lLCBmaWVsZCwgdmFsdWUsIG1vcmVGaWVsZHNBbmRWYWx1ZXMpIHtcclxuICAgICAgICB2YXIgY29udGV4dCA9IG5ldyBQYXJzZUNvbnRleHQoVXNlckRhdGFTb3VyY2UuVXBkYXRlLCBtZXRob2ROYW1lLCBGaWVsZFBhdGguRU1QVFlfUEFUSCk7XHJcbiAgICAgICAgdmFyIGtleXMgPSBbZmllbGRQYXRoRnJvbUFyZ3VtZW50KG1ldGhvZE5hbWUsIGZpZWxkKV07XHJcbiAgICAgICAgdmFyIHZhbHVlcyQkMSA9IFt2YWx1ZV07XHJcbiAgICAgICAgaWYgKG1vcmVGaWVsZHNBbmRWYWx1ZXMubGVuZ3RoICUgMiAhPT0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgbWV0aG9kTmFtZSArIFwiKCkgbmVlZHMgdG8gYmUgY2FsbGVkIHdpdGggYW4gZXZlbiBudW1iZXIgXCIgK1xyXG4gICAgICAgICAgICAgICAgJ29mIGFyZ3VtZW50cyB0aGF0IGFsdGVybmF0ZSBiZXR3ZWVuIGZpZWxkIG5hbWVzIGFuZCB2YWx1ZXMuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbW9yZUZpZWxkc0FuZFZhbHVlcy5sZW5ndGg7IGkgKz0gMikge1xyXG4gICAgICAgICAgICBrZXlzLnB1c2goZmllbGRQYXRoRnJvbUFyZ3VtZW50KG1ldGhvZE5hbWUsIG1vcmVGaWVsZHNBbmRWYWx1ZXNbaV0pKTtcclxuICAgICAgICAgICAgdmFsdWVzJCQxLnB1c2gobW9yZUZpZWxkc0FuZFZhbHVlc1tpICsgMV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZmllbGRNYXNrUGF0aHMgPSBbXTtcclxuICAgICAgICB2YXIgdXBkYXRlRGF0YSA9IE9iamVjdFZhbHVlLkVNUFRZO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IGtleXNbaV07XHJcbiAgICAgICAgICAgIHZhciBjaGlsZENvbnRleHQgPSBjb250ZXh0LmNoaWxkQ29udGV4dEZvckZpZWxkUGF0aChwYXRoKTtcclxuICAgICAgICAgICAgdmFyIHZhbHVlXzEgPSB0aGlzLnJ1blByZUNvbnZlcnRlcih2YWx1ZXMkJDFbaV0sIGNoaWxkQ29udGV4dCk7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZV8xIGluc3RhbmNlb2YgRGVsZXRlRmllbGRWYWx1ZUltcGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIEFkZCBpdCB0byB0aGUgZmllbGQgbWFzaywgYnV0IGRvbid0IGFkZCBhbnl0aGluZyB0byB1cGRhdGVEYXRhLlxyXG4gICAgICAgICAgICAgICAgZmllbGRNYXNrUGF0aHMucHVzaChwYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJzZWRWYWx1ZSA9IHRoaXMucGFyc2VEYXRhKHZhbHVlXzEsIGNoaWxkQ29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VkVmFsdWUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTWFza1BhdGhzLnB1c2gocGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0YSA9IHVwZGF0ZURhdGEuc2V0KHBhdGgsIHBhcnNlZFZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWFzayA9IG5ldyBGaWVsZE1hc2soZmllbGRNYXNrUGF0aHMpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUGFyc2VkVXBkYXRlRGF0YSh1cGRhdGVEYXRhLCBtYXNrLCBjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZSBhIFwicXVlcnkgdmFsdWVcIiAoZS5nLiB2YWx1ZSBpbiBhIHdoZXJlIGZpbHRlciBvciBhIHZhbHVlIGluIGEgY3Vyc29yXHJcbiAgICAgKiBib3VuZCkuXHJcbiAgICAgKi9cclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZVF1ZXJ5VmFsdWUgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgaW5wdXQpIHtcclxuICAgICAgICB2YXIgY29udGV4dCA9IG5ldyBQYXJzZUNvbnRleHQoVXNlckRhdGFTb3VyY2UuQXJndW1lbnQsIG1ldGhvZE5hbWUsIEZpZWxkUGF0aC5FTVBUWV9QQVRIKTtcclxuICAgICAgICB2YXIgcGFyc2VkID0gdGhpcy5wYXJzZURhdGEoaW5wdXQsIGNvbnRleHQpO1xyXG4gICAgICAgIGFzc2VydChwYXJzZWQgIT0gbnVsbCwgJ1BhcnNlZCBkYXRhIHNob3VsZCBub3QgYmUgbnVsbC4nKTtcclxuICAgICAgICBhc3NlcnQoY29udGV4dC5maWVsZFRyYW5zZm9ybXMubGVuZ3RoID09PSAwLCAnRmllbGQgdHJhbnNmb3JtcyBzaG91bGQgaGF2ZSBiZWVuIGRpc2FsbG93ZWQuJyk7XHJcbiAgICAgICAgcmV0dXJuIHBhcnNlZDtcclxuICAgIH07XHJcbiAgICAvKiogU2VuZHMgZGF0YSB0aHJvdWdoIHRoaXMucHJlQ29udmVydGVyLCBoYW5kbGluZyBhbnkgdGhyb3duIGVycm9ycy4gKi9cclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5ydW5QcmVDb252ZXJ0ZXIgPSBmdW5jdGlvbiAoaW5wdXQsIGNvbnRleHQpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcmVDb252ZXJ0ZXIoaW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGVycm9yTWVzc2FnZShlKTtcclxuICAgICAgICAgICAgdGhyb3cgY29udGV4dC5jcmVhdGVFcnJvcihtZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbnRlcm5hbCBoZWxwZXIgZm9yIHBhcnNpbmcgdXNlciBkYXRhLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpbnB1dCBEYXRhIHRvIGJlIHBhcnNlZC5cclxuICAgICAqIEBwYXJhbSBjb250ZXh0IEEgY29udGV4dCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBjdXJyZW50IHBhdGggYmVpbmcgcGFyc2VkLFxyXG4gICAgICogdGhlIHNvdXJjZSBvZiB0aGUgZGF0YSBiZWluZyBwYXJzZWQsIGV0Yy5cclxuICAgICAqIEByZXR1cm4gVGhlIHBhcnNlZCB2YWx1ZSwgb3IgbnVsbCBpZiB0aGUgdmFsdWUgd2FzIGEgRmllbGRWYWx1ZSBzZW50aW5lbFxyXG4gICAgICogdGhhdCBzaG91bGQgbm90IGJlIGluY2x1ZGVkIGluIHRoZSByZXN1bHRpbmcgcGFyc2VkIGRhdGEuXHJcbiAgICAgKi9cclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZURhdGEgPSBmdW5jdGlvbiAoaW5wdXQsIGNvbnRleHQpIHtcclxuICAgICAgICBpbnB1dCA9IHRoaXMucnVuUHJlQ29udmVydGVyKGlucHV0LCBjb250ZXh0KTtcclxuICAgICAgICBpZiAobG9va3NMaWtlSnNvbk9iamVjdChpbnB1dCkpIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVQbGFpbk9iamVjdCgnVW5zdXBwb3J0ZWQgZmllbGQgdmFsdWU6JywgY29udGV4dCwgaW5wdXQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZU9iamVjdChpbnB1dCwgY29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgRmllbGRWYWx1ZUltcGwpIHtcclxuICAgICAgICAgICAgLy8gRmllbGRWYWx1ZXMgdXN1YWxseSBwYXJzZSBpbnRvIHRyYW5zZm9ybXMgKGV4Y2VwdCBGaWVsZFZhbHVlLmRlbGV0ZSgpKVxyXG4gICAgICAgICAgICAvLyBpbiB3aGljaCBjYXNlIHdlIGRvIG5vdCB3YW50IHRvIGluY2x1ZGUgdGhpcyBmaWVsZCBpbiBvdXIgcGFyc2VkIGRhdGFcclxuICAgICAgICAgICAgLy8gKGFzIGRvaW5nIHNvIHdpbGwgb3ZlcndyaXRlIHRoZSBmaWVsZCBkaXJlY3RseSBwcmlvciB0byB0aGUgdHJhbnNmb3JtXHJcbiAgICAgICAgICAgIC8vIHRyeWluZyB0byB0cmFuc2Zvcm0gaXQpLiBTbyB3ZSBkb24ndCBhZGQgdGhpcyBsb2NhdGlvbiB0b1xyXG4gICAgICAgICAgICAvLyBjb250ZXh0LmZpZWxkTWFzayBhbmQgd2UgcmV0dXJuIG51bGwgYXMgb3VyIHBhcnNpbmcgcmVzdWx0LlxyXG4gICAgICAgICAgICB0aGlzLnBhcnNlU2VudGluZWxGaWVsZFZhbHVlKGlucHV0LCBjb250ZXh0KTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBJZiBjb250ZXh0LnBhdGggaXMgbnVsbCB3ZSBhcmUgaW5zaWRlIGFuIGFycmF5IGFuZCB3ZSBkb24ndCBzdXBwb3J0XHJcbiAgICAgICAgICAgIC8vIGZpZWxkIG1hc2sgcGF0aHMgbW9yZSBncmFudWxhciB0aGFuIHRoZSB0b3AtbGV2ZWwgYXJyYXkuXHJcbiAgICAgICAgICAgIGlmIChjb250ZXh0LnBhdGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmllbGRNYXNrLnB1c2goY29udGV4dC5wYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhiLzM0ODcxMTMxKTogSW5jbHVkZSB0aGUgcGF0aCBjb250YWluaW5nIHRoZSBhcnJheSBpbiB0aGUgZXJyb3JcclxuICAgICAgICAgICAgICAgIC8vIG1lc3NhZ2UuXHJcbiAgICAgICAgICAgICAgICBpZiAoY29udGV4dC5hcnJheUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBjb250ZXh0LmNyZWF0ZUVycm9yKCdOZXN0ZWQgYXJyYXlzIGFyZSBub3Qgc3VwcG9ydGVkJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUFycmF5KGlucHV0LCBjb250ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlU2NhbGFyVmFsdWUoaW5wdXQsIGNvbnRleHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZU9iamVjdCA9IGZ1bmN0aW9uIChvYmosIGNvbnRleHQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBuZXcgU29ydGVkTWFwKHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG4gICAgICAgIGlmIChpc0VtcHR5KG9iaikpIHtcclxuICAgICAgICAgICAgLy8gSWYgd2UgZW5jb3VudGVyIGFuIGVtcHR5IG9iamVjdCwgd2UgZXhwbGljaXRseSBhZGQgaXQgdG8gdGhlIHVwZGF0ZVxyXG4gICAgICAgICAgICAvLyBtYXNrIHRvIGVuc3VyZSB0aGF0IHRoZSBzZXJ2ZXIgY3JlYXRlcyBhIG1hcCBlbnRyeS5cclxuICAgICAgICAgICAgaWYgKGNvbnRleHQucGF0aCAmJiBjb250ZXh0LnBhdGgubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWVsZE1hc2sucHVzaChjb250ZXh0LnBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3JFYWNoKG9iaiwgZnVuY3Rpb24gKGtleSwgdmFsKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyc2VkVmFsdWUgPSBfdGhpcy5wYXJzZURhdGEodmFsLCBjb250ZXh0LmNoaWxkQ29udGV4dEZvckZpZWxkKGtleSkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlZFZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuaW5zZXJ0KGtleSwgcGFyc2VkVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBPYmplY3RWYWx1ZShyZXN1bHQpO1xyXG4gICAgfTtcclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZUFycmF5ID0gZnVuY3Rpb24gKGFycmF5LCBjb250ZXh0KSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIHZhciBlbnRyeUluZGV4ID0gMDtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFycmF5XzEgPSBhcnJheTsgX2kgPCBhcnJheV8xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZW50cnkgPSBhcnJheV8xW19pXTtcclxuICAgICAgICAgICAgdmFyIHBhcnNlZEVudHJ5ID0gdGhpcy5wYXJzZURhdGEoZW50cnksIGNvbnRleHQuY2hpbGRDb250ZXh0Rm9yQXJyYXkoZW50cnlJbmRleCkpO1xyXG4gICAgICAgICAgICBpZiAocGFyc2VkRW50cnkgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gSnVzdCBpbmNsdWRlIG51bGxzIGluIHRoZSBhcnJheSBmb3IgZmllbGRzIGJlaW5nIHJlcGxhY2VkIHdpdGggYVxyXG4gICAgICAgICAgICAgICAgLy8gc2VudGluZWwuXHJcbiAgICAgICAgICAgICAgICBwYXJzZWRFbnRyeSA9IE51bGxWYWx1ZS5JTlNUQU5DRTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXN1bHQucHVzaChwYXJzZWRFbnRyeSk7XHJcbiAgICAgICAgICAgIGVudHJ5SW5kZXgrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBcnJheVZhbHVlKHJlc3VsdCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBcIlBhcnNlc1wiIHRoZSBwcm92aWRlZCBGaWVsZFZhbHVlSW1wbCwgYWRkaW5nIGFueSBuZWNlc3NhcnkgdHJhbnNmb3JtcyB0b1xyXG4gICAgICogY29udGV4dC5maWVsZFRyYW5zZm9ybXMuXHJcbiAgICAgKi9cclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZVNlbnRpbmVsRmllbGRWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xyXG4gICAgICAgIC8vIFNlbnRpbmVscyBhcmUgb25seSBzdXBwb3J0ZWQgd2l0aCB3cml0ZXMsIGFuZCBub3Qgd2l0aGluIGFycmF5cy5cclxuICAgICAgICBpZiAoIWlzV3JpdGUoY29udGV4dC5kYXRhU291cmNlKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmNyZWF0ZUVycm9yKHZhbHVlLl9tZXRob2ROYW1lICsgXCIoKSBjYW4gb25seSBiZSB1c2VkIHdpdGggdXBkYXRlKCkgYW5kIHNldCgpXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29udGV4dC5wYXRoID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRocm93IGNvbnRleHQuY3JlYXRlRXJyb3IodmFsdWUuX21ldGhvZE5hbWUgKyBcIigpIGlzIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkIGluc2lkZSBhcnJheXNcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERlbGV0ZUZpZWxkVmFsdWVJbXBsKSB7XHJcbiAgICAgICAgICAgIGlmIChjb250ZXh0LmRhdGFTb3VyY2UgPT09IFVzZXJEYXRhU291cmNlLk1lcmdlU2V0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBObyB0cmFuc2Zvcm0gdG8gYWRkIGZvciBhIGRlbGV0ZSwgYnV0IHdlIG5lZWQgdG8gYWRkIGl0IHRvIG91clxyXG4gICAgICAgICAgICAgICAgLy8gZmllbGRNYXNrIHNvIGl0IGdldHMgZGVsZXRlZC5cclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmllbGRNYXNrLnB1c2goY29udGV4dC5wYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjb250ZXh0LmRhdGFTb3VyY2UgPT09IFVzZXJEYXRhU291cmNlLlVwZGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGNvbnRleHQucGF0aC5sZW5ndGggPiAwLCAnRmllbGRWYWx1ZS5kZWxldGUoKSBhdCB0aGUgdG9wIGxldmVsIHNob3VsZCBoYXZlIGFscmVhZHknICtcclxuICAgICAgICAgICAgICAgICAgICAnIGJlZW4gaGFuZGxlZC4nKTtcclxuICAgICAgICAgICAgICAgIHRocm93IGNvbnRleHQuY3JlYXRlRXJyb3IoJ0ZpZWxkVmFsdWUuZGVsZXRlKCkgY2FuIG9ubHkgYXBwZWFyIGF0IHRoZSB0b3AgbGV2ZWwgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgJ29mIHlvdXIgdXBkYXRlIGRhdGEnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIFdlIHNob3VsZG4ndCBlbmNvdW50ZXIgZGVsZXRlIHNlbnRpbmVscyBmb3IgcXVlcmllcyBvciBub24tbWVyZ2Ugc2V0KCkgY2FsbHMuXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBjb250ZXh0LmNyZWF0ZUVycm9yKCdGaWVsZFZhbHVlLmRlbGV0ZSgpIGNhbm5vdCBiZSB1c2VkIHdpdGggc2V0KCkgdW5sZXNzIHlvdSBwYXNzICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICd7bWVyZ2U6dHJ1ZX0nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFNlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsKSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zLnB1c2gobmV3IEZpZWxkVHJhbnNmb3JtKGNvbnRleHQucGF0aCwgU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtLmluc3RhbmNlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXlVbmlvbkZpZWxkVmFsdWVJbXBsKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJzZWRFbGVtZW50cyA9IHRoaXMucGFyc2VBcnJheVRyYW5zZm9ybUVsZW1lbnRzKHZhbHVlLl9tZXRob2ROYW1lLCB2YWx1ZS5fZWxlbWVudHMpO1xyXG4gICAgICAgICAgICB2YXIgYXJyYXlVbmlvbiA9IG5ldyBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uKHBhcnNlZEVsZW1lbnRzKTtcclxuICAgICAgICAgICAgY29udGV4dC5maWVsZFRyYW5zZm9ybXMucHVzaChuZXcgRmllbGRUcmFuc2Zvcm0oY29udGV4dC5wYXRoLCBhcnJheVVuaW9uKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXlSZW1vdmVGaWVsZFZhbHVlSW1wbCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyc2VkRWxlbWVudHMgPSB0aGlzLnBhcnNlQXJyYXlUcmFuc2Zvcm1FbGVtZW50cyh2YWx1ZS5fbWV0aG9kTmFtZSwgdmFsdWUuX2VsZW1lbnRzKTtcclxuICAgICAgICAgICAgdmFyIGFycmF5UmVtb3ZlID0gbmV3IEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uKHBhcnNlZEVsZW1lbnRzKTtcclxuICAgICAgICAgICAgY29udGV4dC5maWVsZFRyYW5zZm9ybXMucHVzaChuZXcgRmllbGRUcmFuc2Zvcm0oY29udGV4dC5wYXRoLCBhcnJheVJlbW92ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZmFpbCgnVW5rbm93biBGaWVsZFZhbHVlIHR5cGU6ICcgKyB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIHRvIHBhcnNlIGEgc2NhbGFyIHZhbHVlIChpLmUuIG5vdCBhbiBPYmplY3QsIEFycmF5LCBvciBGaWVsZFZhbHVlKVxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm4gVGhlIHBhcnNlZCB2YWx1ZVxyXG4gICAgICovXHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VTY2FsYXJWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTnVsbFZhbHVlLklOU1RBTkNFO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgIGlmIChpc1NhZmVJbnRlZ2VyKHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnRlZ2VyVmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb3VibGVWYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW5WYWx1ZS5vZih2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdWYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFRpbWVzdGFtcFZhbHVlKFRpbWVzdGFtcC5mcm9tRGF0ZSh2YWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFRpbWVzdGFtcCkge1xyXG4gICAgICAgICAgICAvLyBGaXJlc3RvcmUgYmFja2VuZCB0cnVuY2F0ZXMgcHJlY2lzaW9uIGRvd24gdG8gbWljcm9zZWNvbmRzLiBUbyBlbnN1cmVcclxuICAgICAgICAgICAgLy8gb2ZmbGluZSBtb2RlIHdvcmtzIHRoZSBzYW1lIHdpdGggcmVnYXJkcyB0byB0cnVuY2F0aW9uLCBwZXJmb3JtIHRoZVxyXG4gICAgICAgICAgICAvLyB0cnVuY2F0aW9uIGltbWVkaWF0ZWx5IHdpdGhvdXQgd2FpdGluZyBmb3IgdGhlIGJhY2tlbmQgdG8gZG8gdGhhdC5cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaW1lc3RhbXBWYWx1ZShuZXcgVGltZXN0YW1wKHZhbHVlLnNlY29uZHMsIE1hdGguZmxvb3IodmFsdWUubmFub3NlY29uZHMgLyAxMDAwKSAqIDEwMDApKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBHZW9Qb2ludCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEdlb1BvaW50VmFsdWUodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEJsb2IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBCbG9iVmFsdWUodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERvY3VtZW50S2V5UmVmZXJlbmNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVmVmFsdWUodmFsdWUuZGF0YWJhc2VJZCwgdmFsdWUua2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGNvbnRleHQuY3JlYXRlRXJyb3IoXCJVbnN1cHBvcnRlZCBmaWVsZCB2YWx1ZTogXCIgKyB2YWx1ZURlc2NyaXB0aW9uKHZhbHVlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZUFycmF5VHJhbnNmb3JtRWxlbWVudHMgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgZWxlbWVudHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoZnVuY3Rpb24gKGVsZW1lbnQsIGkpIHtcclxuICAgICAgICAgICAgLy8gQWx0aG91Z2ggYXJyYXkgdHJhbnNmb3JtcyBhcmUgdXNlZCB3aXRoIHdyaXRlcywgdGhlIGFjdHVhbCBlbGVtZW50c1xyXG4gICAgICAgICAgICAvLyBiZWluZyB1bmlvbmVkIG9yIHJlbW92ZWQgYXJlIG5vdCBjb25zaWRlcmVkIHdyaXRlcyBzaW5jZSB0aGV5IGNhbm5vdFxyXG4gICAgICAgICAgICAvLyBjb250YWluIGFueSBGaWVsZFZhbHVlIHNlbnRpbmVscywgZXRjLlxyXG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IG5ldyBQYXJzZUNvbnRleHQoVXNlckRhdGFTb3VyY2UuQXJndW1lbnQsIG1ldGhvZE5hbWUsIEZpZWxkUGF0aC5FTVBUWV9QQVRIKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnBhcnNlRGF0YShlbGVtZW50LCBjb250ZXh0LmNoaWxkQ29udGV4dEZvckFycmF5KGkpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVXNlckRhdGFDb252ZXJ0ZXI7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBDaGVja3Mgd2hldGhlciBhbiBvYmplY3QgbG9va3MgbGlrZSBhIEpTT04gb2JqZWN0IHRoYXQgc2hvdWxkIGJlIGNvbnZlcnRlZFxyXG4gKiBpbnRvIGEgc3RydWN0LiBOb3JtYWwgY2xhc3MvcHJvdG90eXBlIGluc3RhbmNlcyBhcmUgY29uc2lkZXJlZCB0byBsb29rIGxpa2VcclxuICogSlNPTiBvYmplY3RzIHNpbmNlIHRoZXkgc2hvdWxkIGJlIGNvbnZlcnRlZCB0byBhIHN0cnVjdCB2YWx1ZS4gQXJyYXlzLCBEYXRlcyxcclxuICogR2VvUG9pbnRzLCBldGMuIGFyZSBub3QgY29uc2lkZXJlZCB0byBsb29rIGxpa2UgSlNPTiBvYmplY3RzIHNpbmNlIHRoZXkgbWFwXHJcbiAqIHRvIHNwZWNpZmljIEZpZWxkVmFsdWUgdHlwZXMgb3RoZXIgdGhhbiBPYmplY3RWYWx1ZS5cclxuICovXHJcbmZ1bmN0aW9uIGxvb2tzTGlrZUpzb25PYmplY3QoaW5wdXQpIHtcclxuICAgIHJldHVybiAodHlwZW9mIGlucHV0ID09PSAnb2JqZWN0JyAmJlxyXG4gICAgICAgIGlucHV0ICE9PSBudWxsICYmXHJcbiAgICAgICAgIShpbnB1dCBpbnN0YW5jZW9mIEFycmF5KSAmJlxyXG4gICAgICAgICEoaW5wdXQgaW5zdGFuY2VvZiBEYXRlKSAmJlxyXG4gICAgICAgICEoaW5wdXQgaW5zdGFuY2VvZiBUaW1lc3RhbXApICYmXHJcbiAgICAgICAgIShpbnB1dCBpbnN0YW5jZW9mIEdlb1BvaW50KSAmJlxyXG4gICAgICAgICEoaW5wdXQgaW5zdGFuY2VvZiBCbG9iKSAmJlxyXG4gICAgICAgICEoaW5wdXQgaW5zdGFuY2VvZiBEb2N1bWVudEtleVJlZmVyZW5jZSkgJiZcclxuICAgICAgICAhKGlucHV0IGluc3RhbmNlb2YgRmllbGRWYWx1ZUltcGwpKTtcclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZVBsYWluT2JqZWN0KG1lc3NhZ2UsIGNvbnRleHQsIGlucHV0KSB7XHJcbiAgICBpZiAoIWxvb2tzTGlrZUpzb25PYmplY3QoaW5wdXQpIHx8ICFpc1BsYWluT2JqZWN0KGlucHV0KSkge1xyXG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IHZhbHVlRGVzY3JpcHRpb24oaW5wdXQpO1xyXG4gICAgICAgIGlmIChkZXNjcmlwdGlvbiA9PT0gJ2FuIG9iamVjdCcpIHtcclxuICAgICAgICAgICAgLy8gTWFzc2FnZSB0aGUgZXJyb3IgaWYgaXQgd2FzIGFuIG9iamVjdC5cclxuICAgICAgICAgICAgdGhyb3cgY29udGV4dC5jcmVhdGVFcnJvcihtZXNzYWdlICsgJyBhIGN1c3RvbSBvYmplY3QnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGNvbnRleHQuY3JlYXRlRXJyb3IobWVzc2FnZSArICcgJyArIGRlc2NyaXB0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0aGF0IGNhbGxzIGZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcoKSBidXQgd3JhcHMgYW55IGVycm9yIHRocm93bi5cclxuICovXHJcbmZ1bmN0aW9uIGZpZWxkUGF0aEZyb21Bcmd1bWVudChtZXRob2ROYW1lLCBwYXRoKSB7XHJcbiAgICBpZiAocGF0aCBpbnN0YW5jZW9mIEZpZWxkUGF0aCQxKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhdGguX2ludGVybmFsUGF0aDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBwYXRoID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiBmaWVsZFBhdGhGcm9tRG90U2VwYXJhdGVkU3RyaW5nKG1ldGhvZE5hbWUsIHBhdGgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSAnRmllbGQgcGF0aCBhcmd1bWVudHMgbXVzdCBiZSBvZiB0eXBlIHN0cmluZyBvciBGaWVsZFBhdGguJztcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgbWV0aG9kTmFtZSArIFwiKCkgY2FsbGVkIHdpdGggaW52YWxpZCBkYXRhLiBcIiArIG1lc3NhZ2UpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBXcmFwcyBmcm9tRG90U2VwYXJhdGVkU3RyaW5nIHdpdGggYW4gZXJyb3IgbWVzc2FnZSBhYm91dCB0aGUgbWV0aG9kIHRoYXRcclxuICogd2FzIHRocm93bi5cclxuICogQHBhcmFtIG1ldGhvZE5hbWUgVGhlIHB1YmxpY2x5IHZpc2libGUgbWV0aG9kIG5hbWVcclxuICogQHBhcmFtIHBhdGggVGhlIGRvdC1zZXBhcmF0ZWQgc3RyaW5nIGZvcm0gb2YgYSBmaWVsZCBwYXRoIHdoaWNoIHdpbGwgYmUgc3BsaXRcclxuICogb24gZG90cy5cclxuICovXHJcbmZ1bmN0aW9uIGZpZWxkUGF0aEZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcobWV0aG9kTmFtZSwgcGF0aCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gZnJvbURvdFNlcGFyYXRlZFN0cmluZyhwYXRoKS5faW50ZXJuYWxQYXRoO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICB2YXIgbWVzc2FnZSA9IGVycm9yTWVzc2FnZShlKTtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgbWV0aG9kTmFtZSArIFwiKCkgY2FsbGVkIHdpdGggaW52YWxpZCBkYXRhLiBcIiArIG1lc3NhZ2UpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBFeHRyYWN0cyB0aGUgbWVzc2FnZSBmcm9tIGEgY2F1Z2h0IGV4Y2VwdGlvbiwgd2hpY2ggc2hvdWxkIGJlIGFuIEVycm9yIG9iamVjdFxyXG4gKiB0aG91Z2ggSlMgZG9lc24ndCBndWFyYW50ZWUgdGhhdC5cclxuICovXHJcbmZ1bmN0aW9uIGVycm9yTWVzc2FnZShlcnJvcikge1xyXG4gICAgcmV0dXJuIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogZXJyb3IudG9TdHJpbmcoKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gVGhlIG9iamVjdHMgdGhhdCBhcmUgYSBwYXJ0IG9mIHRoaXMgQVBJIGFyZSBleHBvc2VkIHRvIHRoaXJkLXBhcnRpZXMgYXNcclxuLy8gY29tcGlsZWQgamF2YXNjcmlwdCBzbyB3ZSB3YW50IHRvIGZsYWcgb3VyIHByaXZhdGUgbWVtYmVycyB3aXRoIGEgbGVhZGluZ1xyXG4vLyB1bmRlcnNjb3JlIHRvIGRpc2NvdXJhZ2UgdGhlaXIgdXNlLlxyXG4vLyB0c2xpbnQ6ZGlzYWJsZTpzdHJpcC1wcml2YXRlLXByb3BlcnR5LXVuZGVyc2NvcmVcclxuLy8gc2V0dGluZ3MoKSBkZWZhdWx0czpcclxudmFyIERFRkFVTFRfSE9TVCA9ICdmaXJlc3RvcmUuZ29vZ2xlYXBpcy5jb20nO1xyXG52YXIgREVGQVVMVF9TU0wgPSB0cnVlO1xyXG52YXIgREVGQVVMVF9USU1FU1RBTVBTX0lOX1NOQVBTSE9UUyA9IGZhbHNlO1xyXG4vLyBlbmFibGVQZXJzaXN0ZW5jZSgpIGRlZmF1bHRzOlxyXG52YXIgREVGQVVMVF9TWU5DSFJPTklaRV9UQUJTID0gZmFsc2U7XHJcbi8qKlxyXG4gKiBBIGNvbmNyZXRlIHR5cGUgZGVzY3JpYmluZyBhbGwgdGhlIHZhbHVlcyB0aGF0IGNhbiBiZSBhcHBsaWVkIHZpYSBhXHJcbiAqIHVzZXItc3VwcGxpZWQgZmlyZXN0b3JlLlNldHRpbmdzIG9iamVjdC4gVGhpcyBpcyBhIHNlcGFyYXRlIHR5cGUgc28gdGhhdFxyXG4gKiBkZWZhdWx0cyBjYW4gYmUgc3VwcGxpZWQgYW5kIHRoZSB2YWx1ZSBjYW4gYmUgY2hlY2tlZCBmb3IgZXF1YWxpdHkuXHJcbiAqL1xyXG52YXIgRmlyZXN0b3JlU2V0dGluZ3MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJlc3RvcmVTZXR0aW5ncyhzZXR0aW5ncykge1xyXG4gICAgICAgIGlmIChzZXR0aW5ncy5ob3N0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgaWYgKHNldHRpbmdzLnNzbCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkNhbid0IHByb3ZpZGUgc3NsIG9wdGlvbiBpZiBob3N0IG9wdGlvbiBpcyBub3Qgc2V0XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuaG9zdCA9IERFRkFVTFRfSE9TVDtcclxuICAgICAgICAgICAgdGhpcy5zc2wgPSBERUZBVUxUX1NTTDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlTmFtZWRUeXBlKCdzZXR0aW5ncycsICdub24tZW1wdHkgc3RyaW5nJywgJ2hvc3QnLCBzZXR0aW5ncy5ob3N0KTtcclxuICAgICAgICAgICAgdGhpcy5ob3N0ID0gc2V0dGluZ3MuaG9zdDtcclxuICAgICAgICAgICAgdmFsaWRhdGVOYW1lZE9wdGlvbmFsVHlwZSgnc2V0dGluZ3MnLCAnYm9vbGVhbicsICdzc2wnLCBzZXR0aW5ncy5zc2wpO1xyXG4gICAgICAgICAgICB0aGlzLnNzbCA9IGRlZmF1bHRlZChzZXR0aW5ncy5zc2wsIERFRkFVTFRfU1NMKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVPcHRpb25OYW1lcygnc2V0dGluZ3MnLCBzZXR0aW5ncywgW1xyXG4gICAgICAgICAgICAnaG9zdCcsXHJcbiAgICAgICAgICAgICdzc2wnLFxyXG4gICAgICAgICAgICAnY3JlZGVudGlhbHMnLFxyXG4gICAgICAgICAgICAndGltZXN0YW1wc0luU25hcHNob3RzJ1xyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIHZhbGlkYXRlTmFtZWRPcHRpb25hbFR5cGUoJ3NldHRpbmdzJywgJ29iamVjdCcsICdjcmVkZW50aWFscycsIHNldHRpbmdzLmNyZWRlbnRpYWxzKTtcclxuICAgICAgICB0aGlzLmNyZWRlbnRpYWxzID0gc2V0dGluZ3MuY3JlZGVudGlhbHM7XHJcbiAgICAgICAgdmFsaWRhdGVOYW1lZE9wdGlvbmFsVHlwZSgnc2V0dGluZ3MnLCAnYm9vbGVhbicsICd0aW1lc3RhbXBzSW5TbmFwc2hvdHMnLCBzZXR0aW5ncy50aW1lc3RhbXBzSW5TbmFwc2hvdHMpO1xyXG4gICAgICAgIHRoaXMudGltZXN0YW1wc0luU25hcHNob3RzID0gZGVmYXVsdGVkKHNldHRpbmdzLnRpbWVzdGFtcHNJblNuYXBzaG90cywgREVGQVVMVF9USU1FU1RBTVBTX0lOX1NOQVBTSE9UUyk7XHJcbiAgICB9XHJcbiAgICBGaXJlc3RvcmVTZXR0aW5ncy5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5ob3N0ID09PSBvdGhlci5ob3N0ICYmXHJcbiAgICAgICAgICAgIHRoaXMuc3NsID09PSBvdGhlci5zc2wgJiZcclxuICAgICAgICAgICAgdGhpcy50aW1lc3RhbXBzSW5TbmFwc2hvdHMgPT09IG90aGVyLnRpbWVzdGFtcHNJblNuYXBzaG90cyAmJlxyXG4gICAgICAgICAgICB0aGlzLmNyZWRlbnRpYWxzID09PSBvdGhlci5jcmVkZW50aWFscyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpcmVzdG9yZVNldHRpbmdzO1xyXG59KCkpO1xyXG52YXIgRmlyZXN0b3JlQ29uZmlnID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyZXN0b3JlQ29uZmlnKCkge1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEZpcmVzdG9yZUNvbmZpZztcclxufSgpKTtcclxuLyoqXHJcbiAqIEVuY2Fwc3VsYXRlcyB0aGUgc2V0dGluZ3MgdGhhdCBjYW4gYmUgdXNlZCB0byBjb25maWd1cmUgRmlyZXN0b3JlXHJcbiAqIHBlcnNpc3RlbmNlLlxyXG4gKi9cclxudmFyIFBlcnNpc3RlbmNlU2V0dGluZ3MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQZXJzaXN0ZW5jZVNldHRpbmdzKGVuYWJsZWQsIHNldHRpbmdzKSB7XHJcbiAgICAgICAgdGhpcy5lbmFibGVkID0gZW5hYmxlZDtcclxuICAgICAgICBhc3NlcnQoZW5hYmxlZCB8fCAhc2V0dGluZ3MsICdDYW4gb25seSBwcm92aWRlIFBlcnNpc3RlbmNlU2V0dGluZ3Mgd2l0aCBwZXJzaXN0ZW5jZSBlbmFibGVkJyk7XHJcbiAgICAgICAgc2V0dGluZ3MgPSBzZXR0aW5ncyB8fCB7fTtcclxuICAgICAgICB0aGlzLmV4cGVyaW1lbnRhbFRhYlN5bmNocm9uaXphdGlvbiA9IGRlZmF1bHRlZChzZXR0aW5ncy5leHBlcmltZW50YWxUYWJTeW5jaHJvbml6YXRpb24sIERFRkFVTFRfU1lOQ0hST05JWkVfVEFCUyk7XHJcbiAgICB9XHJcbiAgICBQZXJzaXN0ZW5jZVNldHRpbmdzLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmVuYWJsZWQgPT09IG90aGVyLmVuYWJsZWQgJiZcclxuICAgICAgICAgICAgdGhpcy5leHBlcmltZW50YWxUYWJTeW5jaHJvbml6YXRpb24gPT09XHJcbiAgICAgICAgICAgICAgICBvdGhlci5leHBlcmltZW50YWxUYWJTeW5jaHJvbml6YXRpb24pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQZXJzaXN0ZW5jZVNldHRpbmdzO1xyXG59KCkpO1xyXG4vKipcclxuICogVGhlIHJvb3QgcmVmZXJlbmNlIHRvIHRoZSBkYXRhYmFzZS5cclxuICovXHJcbnZhciBGaXJlc3RvcmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJlc3RvcmUoZGF0YWJhc2VJZE9yQXBwKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBQdWJsaWMgZm9yIHVzZSBpbiB0ZXN0cy5cclxuICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IFVzZSBtb2R1bGFyaXplZCBpbml0aWFsaXphdGlvbiBpbnN0ZWFkLlxyXG4gICAgICAgIHRoaXMuX3F1ZXVlID0gbmV3IEFzeW5jUXVldWUoKTtcclxuICAgICAgICB0aGlzLklOVEVSTkFMID0ge1xyXG4gICAgICAgICAgICBkZWxldGU6IGZ1bmN0aW9uIChvcHRpb25zKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9maXJlc3RvcmVDbGllbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuX2ZpcmVzdG9yZUNsaWVudC5zaHV0ZG93bihvcHRpb25zKV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTsgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGNvbmZpZyA9IG5ldyBGaXJlc3RvcmVDb25maWcoKTtcclxuICAgICAgICBpZiAodHlwZW9mIGRhdGFiYXNlSWRPckFwcC5vcHRpb25zID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAvLyBUaGlzIGlzIHZlcnkgbGlrZWx5IGEgRmlyZWJhc2UgYXBwIG9iamVjdFxyXG4gICAgICAgICAgICAvLyBUT0RPKGIvMzQxNzc2MDUpOiBDYW4gd2Ugc29tZWhvdyB1c2UgaW5zdGFuY2VvZj9cclxuICAgICAgICAgICAgdmFyIGFwcCA9IGRhdGFiYXNlSWRPckFwcDtcclxuICAgICAgICAgICAgY29uZmlnLmZpcmViYXNlQXBwID0gYXBwO1xyXG4gICAgICAgICAgICBjb25maWcuZGF0YWJhc2VJZCA9IEZpcmVzdG9yZS5kYXRhYmFzZUlkRnJvbUFwcChhcHApO1xyXG4gICAgICAgICAgICBjb25maWcucGVyc2lzdGVuY2VLZXkgPSBjb25maWcuZmlyZWJhc2VBcHAubmFtZTtcclxuICAgICAgICAgICAgY29uZmlnLmNyZWRlbnRpYWxzID0gbmV3IEZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlcihhcHApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGV4dGVybmFsXzEgPSBkYXRhYmFzZUlkT3JBcHA7XHJcbiAgICAgICAgICAgIGlmICghZXh0ZXJuYWxfMS5wcm9qZWN0SWQpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdNdXN0IHByb3ZpZGUgcHJvamVjdElkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uZmlnLmRhdGFiYXNlSWQgPSBuZXcgRGF0YWJhc2VJZChleHRlcm5hbF8xLnByb2plY3RJZCwgZXh0ZXJuYWxfMS5kYXRhYmFzZSk7XHJcbiAgICAgICAgICAgIC8vIFVzZSBhIGRlZmF1bHQgcGVyc2lzdGVuY2VLZXkgdGhhdCBsaW5lcyB1cCB3aXRoIEZpcmViYXNlQXBwLlxyXG4gICAgICAgICAgICBjb25maWcucGVyc2lzdGVuY2VLZXkgPSAnW0RFRkFVTFRdJztcclxuICAgICAgICAgICAgY29uZmlnLmNyZWRlbnRpYWxzID0gbmV3IEVtcHR5Q3JlZGVudGlhbHNQcm92aWRlcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25maWcuc2V0dGluZ3MgPSBuZXcgRmlyZXN0b3JlU2V0dGluZ3Moe30pO1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLl9kYXRhYmFzZUlkID0gY29uZmlnLmRhdGFiYXNlSWQ7XHJcbiAgICB9XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLnNldHRpbmdzID0gZnVuY3Rpb24gKHNldHRpbmdzTGl0ZXJhbCkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0ZpcmVzdG9yZS5zZXR0aW5ncycsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdGaXJlc3RvcmUuc2V0dGluZ3MnLCAnb2JqZWN0JywgMSwgc2V0dGluZ3NMaXRlcmFsKTtcclxuICAgICAgICBpZiAoY29udGFpbnMoc2V0dGluZ3NMaXRlcmFsLCAncGVyc2lzdGVuY2UnKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnXCJwZXJzaXN0ZW5jZVwiIGlzIG5vdyBzcGVjaWZpZWQgd2l0aCBhIHNlcGFyYXRlIGNhbGwgdG8gJyArXHJcbiAgICAgICAgICAgICAgICAnZmlyZXN0b3JlLmVuYWJsZVBlcnNpc3RlbmNlKCkuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuZXdTZXR0aW5ncyA9IG5ldyBGaXJlc3RvcmVTZXR0aW5ncyhzZXR0aW5nc0xpdGVyYWwpO1xyXG4gICAgICAgIGlmICh0aGlzLl9maXJlc3RvcmVDbGllbnQgJiYgIXRoaXMuX2NvbmZpZy5zZXR0aW5ncy5pc0VxdWFsKG5ld1NldHRpbmdzKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCAnRmlyZXN0b3JlIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBhbmQgaXRzIHNldHRpbmdzIGNhbiBubyBsb25nZXIgJyArXHJcbiAgICAgICAgICAgICAgICAnYmUgY2hhbmdlZC4gWW91IGNhbiBvbmx5IGNhbGwgc2V0dGluZ3MoKSBiZWZvcmUgY2FsbGluZyBhbnkgb3RoZXIgJyArXHJcbiAgICAgICAgICAgICAgICAnbWV0aG9kcyBvbiBhIEZpcmVzdG9yZSBvYmplY3QuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2NvbmZpZy5zZXR0aW5ncyA9IG5ld1NldHRpbmdzO1xyXG4gICAgICAgIGlmIChuZXdTZXR0aW5ncy5jcmVkZW50aWFscyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbmZpZy5jcmVkZW50aWFscyA9IG1ha2VDcmVkZW50aWFsc1Byb3ZpZGVyKG5ld1NldHRpbmdzLmNyZWRlbnRpYWxzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5lbmFibGVOZXR3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9maXJlc3RvcmVDbGllbnQuZW5hYmxlTmV0d29yaygpO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuZGlzYWJsZU5ldHdvcmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5lbnN1cmVDbGllbnRDb25maWd1cmVkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpcmVzdG9yZUNsaWVudC5kaXNhYmxlTmV0d29yaygpO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuZW5hYmxlUGVyc2lzdGVuY2UgPSBmdW5jdGlvbiAoc2V0dGluZ3MpIHtcclxuICAgICAgICBpZiAodGhpcy5fZmlyZXN0b3JlQ2xpZW50KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sICdGaXJlc3RvcmUgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIGFuZCBwZXJzaXN0ZW5jZSBjYW4gbm8gbG9uZ2VyICcgK1xyXG4gICAgICAgICAgICAgICAgJ2JlIGVuYWJsZWQuIFlvdSBjYW4gb25seSBjYWxsIGVuYWJsZVBlcnNpc3RlbmNlKCkgYmVmb3JlIGNhbGxpbmcgJyArXHJcbiAgICAgICAgICAgICAgICAnYW55IG90aGVyIG1ldGhvZHMgb24gYSBGaXJlc3RvcmUgb2JqZWN0LicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5jb25maWd1cmVDbGllbnQobmV3IFBlcnNpc3RlbmNlU2V0dGluZ3MoLyogZW5hYmxlZD0gKi8gdHJ1ZSwgc2V0dGluZ3MpKTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9maXJlc3RvcmVDbGllbnQpIHtcclxuICAgICAgICAgICAgLy8gS2ljayBvZmYgc3RhcnRpbmcgdGhlIGNsaWVudCBidXQgZG9uJ3QgYWN0dWFsbHkgd2FpdCBmb3IgaXQuXHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyZUNsaWVudChuZXcgUGVyc2lzdGVuY2VTZXR0aW5ncygvKiBlbmFibGVkPSAqLyBmYWxzZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50O1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuY29uZmlndXJlQ2xpZW50ID0gZnVuY3Rpb24gKHBlcnNpc3RlbmNlU2V0dGluZ3MpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCghIXRoaXMuX2NvbmZpZy5zZXR0aW5ncy5ob3N0LCAnRmlyZXN0b3JlU2V0dGluZ3MuaG9zdCBjYW5ub3QgYmUgZmFsc2V5Jyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9jb25maWcuc2V0dGluZ3MudGltZXN0YW1wc0luU25hcHNob3RzKSB7XHJcbiAgICAgICAgICAgIGVycm9yKFwiXFxuVGhlIGJlaGF2aW9yIGZvciBEYXRlIG9iamVjdHMgc3RvcmVkIGluIEZpcmVzdG9yZSBpcyBnb2luZyB0byBjaGFuZ2VcXG5BTkQgWU9VUiBBUFAgTUFZIEJSRUFLLlxcblRvIGhpZGUgdGhpcyB3YXJuaW5nIGFuZCBlbnN1cmUgeW91ciBhcHAgZG9lcyBub3QgYnJlYWssIHlvdSBuZWVkIHRvIGFkZCB0aGVcXG5mb2xsb3dpbmcgY29kZSB0byB5b3VyIGFwcCBiZWZvcmUgY2FsbGluZyBhbnkgb3RoZXIgQ2xvdWQgRmlyZXN0b3JlIG1ldGhvZHM6XFxuXFxuICBjb25zdCBmaXJlc3RvcmUgPSBmaXJlYmFzZS5maXJlc3RvcmUoKTtcXG4gIGNvbnN0IHNldHRpbmdzID0gey8qIHlvdXIgc2V0dGluZ3MuLi4gKi8gdGltZXN0YW1wc0luU25hcHNob3RzOiB0cnVlfTtcXG4gIGZpcmVzdG9yZS5zZXR0aW5ncyhzZXR0aW5ncyk7XFxuXFxuV2l0aCB0aGlzIGNoYW5nZSwgdGltZXN0YW1wcyBzdG9yZWQgaW4gQ2xvdWQgRmlyZXN0b3JlIHdpbGwgYmUgcmVhZCBiYWNrIGFzXFxuRmlyZWJhc2UgVGltZXN0YW1wIG9iamVjdHMgaW5zdGVhZCBvZiBhcyBzeXN0ZW0gRGF0ZSBvYmplY3RzLiBTbyB5b3Ugd2lsbCBhbHNvXFxubmVlZCB0byB1cGRhdGUgY29kZSBleHBlY3RpbmcgYSBEYXRlIHRvIGluc3RlYWQgZXhwZWN0IGEgVGltZXN0YW1wLiBGb3IgZXhhbXBsZTpcXG5cXG4gIC8vIE9sZDpcXG4gIGNvbnN0IGRhdGUgPSBzbmFwc2hvdC5nZXQoJ2NyZWF0ZWRfYXQnKTtcXG4gIC8vIE5ldzpcXG4gIGNvbnN0IHRpbWVzdGFtcCA9IHNuYXBzaG90LmdldCgnY3JlYXRlZF9hdCcpO1xcbiAgY29uc3QgZGF0ZSA9IHRpbWVzdGFtcC50b0RhdGUoKTtcXG5cXG5QbGVhc2UgYXVkaXQgYWxsIGV4aXN0aW5nIHVzYWdlcyBvZiBEYXRlIHdoZW4geW91IGVuYWJsZSB0aGUgbmV3IGJlaGF2aW9yLiBJbiBhXFxuZnV0dXJlIHJlbGVhc2UsIHRoZSBiZWhhdmlvciB3aWxsIGNoYW5nZSB0byB0aGUgbmV3IGJlaGF2aW9yLCBzbyBpZiB5b3UgZG8gbm90XFxuZm9sbG93IHRoZXNlIHN0ZXBzLCBZT1VSIEFQUCBNQVkgQlJFQUsuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhc3NlcnQoIXRoaXMuX2ZpcmVzdG9yZUNsaWVudCwgJ2NvbmZpZ3VyZUNsaWVudCgpIGNhbGxlZCBtdWx0aXBsZSB0aW1lcycpO1xyXG4gICAgICAgIHZhciBkYXRhYmFzZUluZm8gPSBuZXcgRGF0YWJhc2VJbmZvKHRoaXMuX2NvbmZpZy5kYXRhYmFzZUlkLCB0aGlzLl9jb25maWcucGVyc2lzdGVuY2VLZXksIHRoaXMuX2NvbmZpZy5zZXR0aW5ncy5ob3N0LCB0aGlzLl9jb25maWcuc2V0dGluZ3Muc3NsKTtcclxuICAgICAgICB2YXIgcHJlQ29udmVydGVyID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERvY3VtZW50UmVmZXJlbmNlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0RiID0gX3RoaXMuX2NvbmZpZy5kYXRhYmFzZUlkO1xyXG4gICAgICAgICAgICAgICAgdmFyIG90aGVyRGIgPSB2YWx1ZS5maXJlc3RvcmUuX2NvbmZpZy5kYXRhYmFzZUlkO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvdGhlckRiLmlzRXF1YWwodGhpc0RiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdEb2N1bWVudCByZWZlcmVuY2UgaXMgZm9yIGRhdGFiYXNlICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAob3RoZXJEYi5wcm9qZWN0SWQgKyBcIi9cIiArIG90aGVyRGIuZGF0YWJhc2UgKyBcIiBidXQgc2hvdWxkIGJlIFwiKSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChcImZvciBkYXRhYmFzZSBcIiArIHRoaXNEYi5wcm9qZWN0SWQgKyBcIi9cIiArIHRoaXNEYi5kYXRhYmFzZSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEtleVJlZmVyZW5jZShfdGhpcy5fY29uZmlnLmRhdGFiYXNlSWQsIHZhbHVlLl9rZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9kYXRhQ29udmVydGVyID0gbmV3IFVzZXJEYXRhQ29udmVydGVyKHByZUNvbnZlcnRlcik7XHJcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlQ2xpZW50ID0gbmV3IEZpcmVzdG9yZUNsaWVudChQbGF0Zm9ybVN1cHBvcnQuZ2V0UGxhdGZvcm0oKSwgZGF0YWJhc2VJbmZvLCB0aGlzLl9jb25maWcuY3JlZGVudGlhbHMsIHRoaXMuX3F1ZXVlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50LnN0YXJ0KHBlcnNpc3RlbmNlU2V0dGluZ3MpO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZS5kYXRhYmFzZUlkRnJvbUFwcCA9IGZ1bmN0aW9uIChhcHApIHtcclxuICAgICAgICB2YXIgb3B0aW9ucyA9IGFwcC5vcHRpb25zO1xyXG4gICAgICAgIGlmICghY29udGFpbnMob3B0aW9ucywgJ3Byb2plY3RJZCcpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdcInByb2plY3RJZFwiIG5vdCBwcm92aWRlZCBpbiBmaXJlYmFzZS5pbml0aWFsaXplQXBwLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcHJvamVjdElkID0gb3B0aW9uc1sncHJvamVjdElkJ107XHJcbiAgICAgICAgaWYgKCFwcm9qZWN0SWQgfHwgdHlwZW9mIHByb2plY3RJZCAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ3Byb2plY3RJZCBtdXN0IGJlIGEgc3RyaW5nIGluIEZpcmViYXNlQXBwLm9wdGlvbnMnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRhYmFzZUlkKHByb2plY3RJZCk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpcmVzdG9yZS5wcm90b3R5cGUsIFwiYXBwXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9jb25maWcuZmlyZWJhc2VBcHApIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiRmlyZXN0b3JlIHdhcyBub3QgaW5pdGlhbGl6ZWQgdXNpbmcgdGhlIEZpcmViYXNlIFNESy4gJ2FwcCcgaXMgXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICdub3QgYXZhaWxhYmxlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZy5maXJlYmFzZUFwcDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuY29sbGVjdGlvbiA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnRmlyZXN0b3JlLmNvbGxlY3Rpb24nLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnRmlyZXN0b3JlLmNvbGxlY3Rpb24nLCAnbm9uLWVtcHR5IHN0cmluZycsIDEsIHBhdGhTdHJpbmcpO1xyXG4gICAgICAgIGlmICghcGF0aFN0cmluZykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnTXVzdCBwcm92aWRlIGEgbm9uLWVtcHR5IGNvbGxlY3Rpb24gcGF0aCB0byBjb2xsZWN0aW9uKCknKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbnN1cmVDbGllbnRDb25maWd1cmVkKCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uUmVmZXJlbmNlKFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHBhdGhTdHJpbmcpLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLmRvYyA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnRmlyZXN0b3JlLmRvYycsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdGaXJlc3RvcmUuZG9jJywgJ25vbi1lbXB0eSBzdHJpbmcnLCAxLCBwYXRoU3RyaW5nKTtcclxuICAgICAgICBpZiAoIXBhdGhTdHJpbmcpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ011c3QgcHJvdmlkZSBhIG5vbi1lbXB0eSBkb2N1bWVudCBwYXRoIHRvIGRvYygpJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpO1xyXG4gICAgICAgIHJldHVybiBEb2N1bWVudFJlZmVyZW5jZS5mb3JQYXRoKFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHBhdGhTdHJpbmcpLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLnJ1blRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKHVwZGF0ZUZ1bmN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdGaXJlc3RvcmUucnVuVHJhbnNhY3Rpb24nLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnRmlyZXN0b3JlLnJ1blRyYW5zYWN0aW9uJywgJ2Z1bmN0aW9uJywgMSwgdXBkYXRlRnVuY3Rpb24pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKS50cmFuc2FjdGlvbihmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUZ1bmN0aW9uKG5ldyBUcmFuc2FjdGlvbiQxKF90aGlzLCB0cmFuc2FjdGlvbikpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuYmF0Y2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5lbnN1cmVDbGllbnRDb25maWd1cmVkKCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBXcml0ZUJhdGNoKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaXJlc3RvcmUsIFwibG9nTGV2ZWxcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGdldExvZ0xldmVsKCkpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgTG9nTGV2ZWwuREVCVUc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdkZWJ1Zyc7XHJcbiAgICAgICAgICAgICAgICBjYXNlIExvZ0xldmVsLkVSUk9SOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnZXJyb3InO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBMb2dMZXZlbC5TSUxFTlQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdzaWxlbnQnO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBsb2cgbGV2ZWw6ICcgKyBnZXRMb2dMZXZlbCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgRmlyZXN0b3JlLnNldExvZ0xldmVsID0gZnVuY3Rpb24gKGxldmVsKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnRmlyZXN0b3JlLnNldExvZ0xldmVsJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0ZpcmVzdG9yZS5zZXRMb2dMZXZlbCcsICdub24tZW1wdHkgc3RyaW5nJywgMSwgbGV2ZWwpO1xyXG4gICAgICAgIHN3aXRjaCAobGV2ZWwpIHtcclxuICAgICAgICAgICAgY2FzZSAnZGVidWcnOlxyXG4gICAgICAgICAgICAgICAgc2V0TG9nTGV2ZWwoTG9nTGV2ZWwuREVCVUcpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Vycm9yJzpcclxuICAgICAgICAgICAgICAgIHNldExvZ0xldmVsKExvZ0xldmVsLkVSUk9SKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdzaWxlbnQnOlxyXG4gICAgICAgICAgICAgICAgc2V0TG9nTGV2ZWwoTG9nTGV2ZWwuU0lMRU5UKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgbG9nIGxldmVsOiAnICsgbGV2ZWwpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyBOb3RlOiB0aGlzIGlzIG5vdCBhIHByb3BlcnR5IGJlY2F1c2UgdGhlIG1pbmlmaWVyIGNhbid0IHdvcmsgY29ycmVjdGx5IHdpdGhcclxuICAgIC8vIHRoZSB3YXkgVHlwZVNjcmlwdCBjb21waWxlciBvdXRwdXRzIHByb3BlcnRpZXMuXHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLl9hcmVUaW1lc3RhbXBzSW5TbmFwc2hvdHNFbmFibGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb25maWcuc2V0dGluZ3MudGltZXN0YW1wc0luU25hcHNob3RzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBGaXJlc3RvcmU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIHJlZmVyZW5jZSB0byBhIHRyYW5zYWN0aW9uLlxyXG4gKi9cclxudmFyIFRyYW5zYWN0aW9uJDEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUcmFuc2FjdGlvbihfZmlyZXN0b3JlLCBfdHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSBfZmlyZXN0b3JlO1xyXG4gICAgICAgIHRoaXMuX3RyYW5zYWN0aW9uID0gX3RyYW5zYWN0aW9uO1xyXG4gICAgfVxyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChkb2N1bWVudFJlZikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnVHJhbnNhY3Rpb24uZ2V0JywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YXIgcmVmID0gdmFsaWRhdGVSZWZlcmVuY2UoJ1RyYW5zYWN0aW9uLmdldCcsIGRvY3VtZW50UmVmLCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAubG9va3VwKFtyZWYuX2tleV0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkb2NzKSB7XHJcbiAgICAgICAgICAgIGlmICghZG9jcyB8fCBkb2NzLmxlbmd0aCAhPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ01pc21hdGNoIGluIGRvY3MgcmV0dXJuZWQgZnJvbSBkb2N1bWVudCBsb29rdXAuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGRvYyA9IGRvY3NbMF07XHJcbiAgICAgICAgICAgIGlmIChkb2MgaW5zdGFuY2VvZiBOb0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50U25hcHNob3QoX3RoaXMuX2ZpcmVzdG9yZSwgcmVmLl9rZXksIG51bGwsIFxyXG4gICAgICAgICAgICAgICAgLyogZnJvbUNhY2hlPSAqLyBmYWxzZSwgXHJcbiAgICAgICAgICAgICAgICAvKiBoYXNQZW5kaW5nV3JpdGVzPSAqLyBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRTbmFwc2hvdChfdGhpcy5fZmlyZXN0b3JlLCByZWYuX2tleSwgZG9jLCBcclxuICAgICAgICAgICAgICAgIC8qIGZyb21DYWNoZT0gKi8gZmFsc2UsIFxyXG4gICAgICAgICAgICAgICAgLyogaGFzUGVuZGluZ1dyaXRlcz0gKi8gZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgZmFpbChcIkJhdGNoR2V0RG9jdW1lbnRzUmVxdWVzdCByZXR1cm5lZCB1bmV4cGVjdGVkIGRvY3VtZW50IHR5cGU6IFwiICsgZG9jLmNvbnN0cnVjdG9yLm5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChkb2N1bWVudFJlZiwgdmFsdWUsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ1RyYW5zYWN0aW9uLnNldCcsIGFyZ3VtZW50cywgMiwgMyk7XHJcbiAgICAgICAgdmFyIHJlZiA9IHZhbGlkYXRlUmVmZXJlbmNlKCdUcmFuc2FjdGlvbi5zZXQnLCBkb2N1bWVudFJlZiwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICBvcHRpb25zID0gdmFsaWRhdGVTZXRPcHRpb25zKCdUcmFuc2FjdGlvbi5zZXQnLCBvcHRpb25zKTtcclxuICAgICAgICB2YXIgcGFyc2VkID0gb3B0aW9ucy5tZXJnZSB8fCBvcHRpb25zLm1lcmdlRmllbGRzXHJcbiAgICAgICAgICAgID8gdGhpcy5fZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlTWVyZ2VEYXRhKCdUcmFuc2FjdGlvbi5zZXQnLCB2YWx1ZSwgb3B0aW9ucy5tZXJnZUZpZWxkcylcclxuICAgICAgICAgICAgOiB0aGlzLl9maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VTZXREYXRhKCdUcmFuc2FjdGlvbi5zZXQnLCB2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5fdHJhbnNhY3Rpb24uc2V0KHJlZi5fa2V5LCBwYXJzZWQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZG9jdW1lbnRSZWYsIGZpZWxkT3JVcGRhdGVEYXRhLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBtb3JlRmllbGRzQW5kVmFsdWVzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAzOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgbW9yZUZpZWxkc0FuZFZhbHVlc1tfaSAtIDNdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHJlZjtcclxuICAgICAgICB2YXIgcGFyc2VkO1xyXG4gICAgICAgIGlmICh0eXBlb2YgZmllbGRPclVwZGF0ZURhdGEgPT09ICdzdHJpbmcnIHx8XHJcbiAgICAgICAgICAgIGZpZWxkT3JVcGRhdGVEYXRhIGluc3RhbmNlb2YgRmllbGRQYXRoJDEpIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdUcmFuc2FjdGlvbi51cGRhdGUnLCBhcmd1bWVudHMsIDMpO1xyXG4gICAgICAgICAgICByZWYgPSB2YWxpZGF0ZVJlZmVyZW5jZSgnVHJhbnNhY3Rpb24udXBkYXRlJywgZG9jdW1lbnRSZWYsIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgICAgIHBhcnNlZCA9IHRoaXMuX2ZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVVwZGF0ZVZhcmFyZ3MoJ1RyYW5zYWN0aW9uLnVwZGF0ZScsIGZpZWxkT3JVcGRhdGVEYXRhLCB2YWx1ZSwgbW9yZUZpZWxkc0FuZFZhbHVlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdUcmFuc2FjdGlvbi51cGRhdGUnLCBhcmd1bWVudHMsIDIpO1xyXG4gICAgICAgICAgICByZWYgPSB2YWxpZGF0ZVJlZmVyZW5jZSgnVHJhbnNhY3Rpb24udXBkYXRlJywgZG9jdW1lbnRSZWYsIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgICAgIHBhcnNlZCA9IHRoaXMuX2ZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVVwZGF0ZURhdGEoJ1RyYW5zYWN0aW9uLnVwZGF0ZScsIGZpZWxkT3JVcGRhdGVEYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdHJhbnNhY3Rpb24udXBkYXRlKHJlZi5fa2V5LCBwYXJzZWQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoZG9jdW1lbnRSZWYpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdUcmFuc2FjdGlvbi5kZWxldGUnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhciByZWYgPSB2YWxpZGF0ZVJlZmVyZW5jZSgnVHJhbnNhY3Rpb24uZGVsZXRlJywgZG9jdW1lbnRSZWYsIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgdGhpcy5fdHJhbnNhY3Rpb24uZGVsZXRlKHJlZi5fa2V5KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICByZXR1cm4gVHJhbnNhY3Rpb247XHJcbn0oKSk7XHJcbnZhciBXcml0ZUJhdGNoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gV3JpdGVCYXRjaChfZmlyZXN0b3JlKSB7XHJcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gX2ZpcmVzdG9yZTtcclxuICAgICAgICB0aGlzLl9tdXRhdGlvbnMgPSBbXTtcclxuICAgICAgICB0aGlzLl9jb21taXR0ZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIFdyaXRlQmF0Y2gucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChkb2N1bWVudFJlZiwgdmFsdWUsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ1dyaXRlQmF0Y2guc2V0JywgYXJndW1lbnRzLCAyLCAzKTtcclxuICAgICAgICB0aGlzLnZlcmlmeU5vdENvbW1pdHRlZCgpO1xyXG4gICAgICAgIHZhciByZWYgPSB2YWxpZGF0ZVJlZmVyZW5jZSgnV3JpdGVCYXRjaC5zZXQnLCBkb2N1bWVudFJlZiwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICBvcHRpb25zID0gdmFsaWRhdGVTZXRPcHRpb25zKCdXcml0ZUJhdGNoLnNldCcsIG9wdGlvbnMpO1xyXG4gICAgICAgIHZhciBwYXJzZWQgPSBvcHRpb25zLm1lcmdlIHx8IG9wdGlvbnMubWVyZ2VGaWVsZHNcclxuICAgICAgICAgICAgPyB0aGlzLl9maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VNZXJnZURhdGEoJ1dyaXRlQmF0Y2guc2V0JywgdmFsdWUsIG9wdGlvbnMubWVyZ2VGaWVsZHMpXHJcbiAgICAgICAgICAgIDogdGhpcy5fZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlU2V0RGF0YSgnV3JpdGVCYXRjaC5zZXQnLCB2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5fbXV0YXRpb25zID0gdGhpcy5fbXV0YXRpb25zLmNvbmNhdChwYXJzZWQudG9NdXRhdGlvbnMocmVmLl9rZXksIFByZWNvbmRpdGlvbi5OT05FKSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgV3JpdGVCYXRjaC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRvY3VtZW50UmVmLCBmaWVsZE9yVXBkYXRlRGF0YSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgbW9yZUZpZWxkc0FuZFZhbHVlcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMzsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIG1vcmVGaWVsZHNBbmRWYWx1ZXNbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmVyaWZ5Tm90Q29tbWl0dGVkKCk7XHJcbiAgICAgICAgdmFyIHJlZjtcclxuICAgICAgICB2YXIgcGFyc2VkO1xyXG4gICAgICAgIGlmICh0eXBlb2YgZmllbGRPclVwZGF0ZURhdGEgPT09ICdzdHJpbmcnIHx8XHJcbiAgICAgICAgICAgIGZpZWxkT3JVcGRhdGVEYXRhIGluc3RhbmNlb2YgRmllbGRQYXRoJDEpIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdXcml0ZUJhdGNoLnVwZGF0ZScsIGFyZ3VtZW50cywgMyk7XHJcbiAgICAgICAgICAgIHJlZiA9IHZhbGlkYXRlUmVmZXJlbmNlKCdXcml0ZUJhdGNoLnVwZGF0ZScsIGRvY3VtZW50UmVmLCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgICAgICBwYXJzZWQgPSB0aGlzLl9maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VVcGRhdGVWYXJhcmdzKCdXcml0ZUJhdGNoLnVwZGF0ZScsIGZpZWxkT3JVcGRhdGVEYXRhLCB2YWx1ZSwgbW9yZUZpZWxkc0FuZFZhbHVlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdXcml0ZUJhdGNoLnVwZGF0ZScsIGFyZ3VtZW50cywgMik7XHJcbiAgICAgICAgICAgIHJlZiA9IHZhbGlkYXRlUmVmZXJlbmNlKCdXcml0ZUJhdGNoLnVwZGF0ZScsIGRvY3VtZW50UmVmLCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgICAgICBwYXJzZWQgPSB0aGlzLl9maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VVcGRhdGVEYXRhKCdXcml0ZUJhdGNoLnVwZGF0ZScsIGZpZWxkT3JVcGRhdGVEYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbXV0YXRpb25zID0gdGhpcy5fbXV0YXRpb25zLmNvbmNhdChwYXJzZWQudG9NdXRhdGlvbnMocmVmLl9rZXksIFByZWNvbmRpdGlvbi5leGlzdHModHJ1ZSkpKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBXcml0ZUJhdGNoLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoZG9jdW1lbnRSZWYpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdXcml0ZUJhdGNoLmRlbGV0ZScsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlOb3RDb21taXR0ZWQoKTtcclxuICAgICAgICB2YXIgcmVmID0gdmFsaWRhdGVSZWZlcmVuY2UoJ1dyaXRlQmF0Y2guZGVsZXRlJywgZG9jdW1lbnRSZWYsIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgdGhpcy5fbXV0YXRpb25zID0gdGhpcy5fbXV0YXRpb25zLmNvbmNhdChuZXcgRGVsZXRlTXV0YXRpb24ocmVmLl9rZXksIFByZWNvbmRpdGlvbi5OT05FKSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgV3JpdGVCYXRjaC5wcm90b3R5cGUuY29tbWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmVyaWZ5Tm90Q29tbWl0dGVkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jb21taXR0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX211dGF0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuX2ZpcmVzdG9yZS5lbnN1cmVDbGllbnRDb25maWd1cmVkKCkud3JpdGUodGhpcy5fbXV0YXRpb25zKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFdyaXRlQmF0Y2gucHJvdG90eXBlLnZlcmlmeU5vdENvbW1pdHRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fY29tbWl0dGVkKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sICdBIHdyaXRlIGJhdGNoIGNhbiBubyBsb25nZXIgYmUgdXNlZCBhZnRlciBjb21taXQoKSAnICtcclxuICAgICAgICAgICAgICAgICdoYXMgYmVlbiBjYWxsZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBXcml0ZUJhdGNoO1xyXG59KCkpO1xyXG4vKipcclxuICogQSByZWZlcmVuY2UgdG8gYSBwYXJ0aWN1bGFyIGRvY3VtZW50IGluIGEgY29sbGVjdGlvbiBpbiB0aGUgZGF0YWJhc2UuXHJcbiAqL1xyXG52YXIgRG9jdW1lbnRSZWZlcmVuY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEb2N1bWVudFJlZmVyZW5jZShfa2V5LCBmaXJlc3RvcmUpIHtcclxuICAgICAgICB0aGlzLl9rZXkgPSBfa2V5O1xyXG4gICAgICAgIHRoaXMuZmlyZXN0b3JlID0gZmlyZXN0b3JlO1xyXG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZUNsaWVudCA9IHRoaXMuZmlyZXN0b3JlLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKTtcclxuICAgIH1cclxuICAgIERvY3VtZW50UmVmZXJlbmNlLmZvclBhdGggPSBmdW5jdGlvbiAocGF0aCwgZmlyZXN0b3JlKSB7XHJcbiAgICAgICAgaWYgKHBhdGgubGVuZ3RoICUgMiAhPT0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnSW52YWxpZCBkb2N1bWVudCByZWZlcmVuY2UuIERvY3VtZW50ICcgK1xyXG4gICAgICAgICAgICAgICAgJ3JlZmVyZW5jZXMgbXVzdCBoYXZlIGFuIGV2ZW4gbnVtYmVyIG9mIHNlZ21lbnRzLCBidXQgJyArXHJcbiAgICAgICAgICAgICAgICAocGF0aC5jYW5vbmljYWxTdHJpbmcoKSArIFwiIGhhcyBcIiArIHBhdGgubGVuZ3RoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRSZWZlcmVuY2UobmV3IERvY3VtZW50S2V5KHBhdGgpLCBmaXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUsIFwiaWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGgubGFzdFNlZ21lbnQoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUsIFwicGFyZW50XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uUmVmZXJlbmNlKHRoaXMuX2tleS5wYXRoLnBvcExhc3QoKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZSwgXCJwYXRoXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2tleS5wYXRoLmNhbm9uaWNhbFN0cmluZygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLmNvbGxlY3Rpb24gPSBmdW5jdGlvbiAocGF0aFN0cmluZykge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0RvY3VtZW50UmVmZXJlbmNlLmNvbGxlY3Rpb24nLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnRG9jdW1lbnRSZWZlcmVuY2UuY29sbGVjdGlvbicsICdub24tZW1wdHkgc3RyaW5nJywgMSwgcGF0aFN0cmluZyk7XHJcbiAgICAgICAgaWYgKCFwYXRoU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdNdXN0IHByb3ZpZGUgYSBub24tZW1wdHkgY29sbGVjdGlvbiBuYW1lIHRvIGNvbGxlY3Rpb24oKScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcGF0aCA9IFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHBhdGhTdHJpbmcpO1xyXG4gICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvblJlZmVyZW5jZSh0aGlzLl9rZXkucGF0aC5jaGlsZChwYXRoKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBEb2N1bWVudFJlZmVyZW5jZSkpIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZENsYXNzRXJyb3IoJ2lzRXF1YWwnLCAnRG9jdW1lbnRSZWZlcmVuY2UnLCAxLCBvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmZpcmVzdG9yZSA9PT0gb3RoZXIuZmlyZXN0b3JlICYmIHRoaXMuX2tleS5pc0VxdWFsKG90aGVyLl9rZXkpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAodmFsdWUsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ0RvY3VtZW50UmVmZXJlbmNlLnNldCcsIGFyZ3VtZW50cywgMSwgMik7XHJcbiAgICAgICAgb3B0aW9ucyA9IHZhbGlkYXRlU2V0T3B0aW9ucygnRG9jdW1lbnRSZWZlcmVuY2Uuc2V0Jywgb3B0aW9ucyk7XHJcbiAgICAgICAgdmFyIHBhcnNlZCA9IG9wdGlvbnMubWVyZ2UgfHwgb3B0aW9ucy5tZXJnZUZpZWxkc1xyXG4gICAgICAgICAgICA/IHRoaXMuZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlTWVyZ2VEYXRhKCdEb2N1bWVudFJlZmVyZW5jZS5zZXQnLCB2YWx1ZSwgb3B0aW9ucy5tZXJnZUZpZWxkcylcclxuICAgICAgICAgICAgOiB0aGlzLmZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVNldERhdGEoJ0RvY3VtZW50UmVmZXJlbmNlLnNldCcsIHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50LndyaXRlKHBhcnNlZC50b011dGF0aW9ucyh0aGlzLl9rZXksIFByZWNvbmRpdGlvbi5OT05FKSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChmaWVsZE9yVXBkYXRlRGF0YSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgbW9yZUZpZWxkc0FuZFZhbHVlcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIG1vcmVGaWVsZHNBbmRWYWx1ZXNbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwYXJzZWQ7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBmaWVsZE9yVXBkYXRlRGF0YSA9PT0gJ3N0cmluZycgfHxcclxuICAgICAgICAgICAgZmllbGRPclVwZGF0ZURhdGEgaW5zdGFuY2VvZiBGaWVsZFBhdGgkMSkge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ0RvY3VtZW50UmVmZXJlbmNlLnVwZGF0ZScsIGFyZ3VtZW50cywgMik7XHJcbiAgICAgICAgICAgIHBhcnNlZCA9IHRoaXMuZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlVXBkYXRlVmFyYXJncygnRG9jdW1lbnRSZWZlcmVuY2UudXBkYXRlJywgZmllbGRPclVwZGF0ZURhdGEsIHZhbHVlLCBtb3JlRmllbGRzQW5kVmFsdWVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0RvY3VtZW50UmVmZXJlbmNlLnVwZGF0ZScsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgICAgIHBhcnNlZCA9IHRoaXMuZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlVXBkYXRlRGF0YSgnRG9jdW1lbnRSZWZlcmVuY2UudXBkYXRlJywgZmllbGRPclVwZGF0ZURhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50LndyaXRlKHBhcnNlZC50b011dGF0aW9ucyh0aGlzLl9rZXksIFByZWNvbmRpdGlvbi5leGlzdHModHJ1ZSkpKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0RvY3VtZW50UmVmZXJlbmNlLmRlbGV0ZScsIGFyZ3VtZW50cywgMCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpcmVzdG9yZUNsaWVudC53cml0ZShbXHJcbiAgICAgICAgICAgIG5ldyBEZWxldGVNdXRhdGlvbih0aGlzLl9rZXksIFByZWNvbmRpdGlvbi5OT05FKVxyXG4gICAgICAgIF0pO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZS5vblNuYXBzaG90ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ0RvY3VtZW50UmVmZXJlbmNlLm9uU25hcHNob3QnLCBhcmd1bWVudHMsIDEsIDQpO1xyXG4gICAgICAgIHZhciBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIG9ic2VydmVyO1xyXG4gICAgICAgIHZhciBjdXJyQXJnID0gMDtcclxuICAgICAgICBpZiAodHlwZW9mIGFyZ3NbY3VyckFyZ10gPT09ICdvYmplY3QnICYmXHJcbiAgICAgICAgICAgICFpc1BhcnRpYWxPYnNlcnZlcihhcmdzW2N1cnJBcmddKSkge1xyXG4gICAgICAgICAgICBvcHRpb25zID0gYXJnc1tjdXJyQXJnXTtcclxuICAgICAgICAgICAgdmFsaWRhdGVPcHRpb25OYW1lcygnRG9jdW1lbnRSZWZlcmVuY2Uub25TbmFwc2hvdCcsIG9wdGlvbnMsIFtcclxuICAgICAgICAgICAgICAgICdpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzJ1xyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgdmFsaWRhdGVOYW1lZE9wdGlvbmFsVHlwZSgnRG9jdW1lbnRSZWZlcmVuY2Uub25TbmFwc2hvdCcsICdib29sZWFuJywgJ2luY2x1ZGVNZXRhZGF0YUNoYW5nZXMnLCBvcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXMpO1xyXG4gICAgICAgICAgICBjdXJyQXJnKys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpbnRlcm5hbE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6IG9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlc1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKGlzUGFydGlhbE9ic2VydmVyKGFyZ3NbY3VyckFyZ10pKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyID0gYXJnc1tjdXJyQXJnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnRG9jdW1lbnRSZWZlcmVuY2Uub25TbmFwc2hvdCcsICdmdW5jdGlvbicsIGN1cnJBcmcsIGFyZ3NbY3VyckFyZ10pO1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU9wdGlvbmFsQXJnVHlwZSgnRG9jdW1lbnRSZWZlcmVuY2Uub25TbmFwc2hvdCcsICdmdW5jdGlvbicsIGN1cnJBcmcgKyAxLCBhcmdzW2N1cnJBcmcgKyAxXSk7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlT3B0aW9uYWxBcmdUeXBlKCdEb2N1bWVudFJlZmVyZW5jZS5vblNuYXBzaG90JywgJ2Z1bmN0aW9uJywgY3VyckFyZyArIDIsIGFyZ3NbY3VyckFyZyArIDJdKTtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0OiBhcmdzW2N1cnJBcmddLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IGFyZ3NbY3VyckFyZyArIDFdLFxyXG4gICAgICAgICAgICAgICAgY29tcGxldGU6IGFyZ3NbY3VyckFyZyArIDJdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLm9uU25hcHNob3RJbnRlcm5hbChpbnRlcm5hbE9wdGlvbnMsIG9ic2VydmVyKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUub25TbmFwc2hvdEludGVybmFsID0gZnVuY3Rpb24gKG9wdGlvbnMsIG9ic2VydmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZXJySGFuZGxlciA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVW5jYXVnaHQgRXJyb3IgaW4gb25TbmFwc2hvdDonLCBlcnIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKG9ic2VydmVyLmVycm9yKSB7XHJcbiAgICAgICAgICAgIGVyckhhbmRsZXIgPSBvYnNlcnZlci5lcnJvci5iaW5kKG9ic2VydmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGFzeW5jT2JzZXJ2ZXIgPSBuZXcgQXN5bmNPYnNlcnZlcih7XHJcbiAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIChzbmFwc2hvdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyLm5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoc25hcHNob3QuZG9jcy5zaXplIDw9IDEsICdUb28gbWFueSBkb2N1bWVudHMgcmV0dXJuZWQgb24gYSBkb2N1bWVudCBxdWVyeScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkb2MgPSBzbmFwc2hvdC5kb2NzLmdldChfdGhpcy5fa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KG5ldyBEb2N1bWVudFNuYXBzaG90KF90aGlzLmZpcmVzdG9yZSwgX3RoaXMuX2tleSwgZG9jLCBzbmFwc2hvdC5mcm9tQ2FjaGUsIHNuYXBzaG90Lmhhc1BlbmRpbmdXcml0ZXMpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGVyckhhbmRsZXJcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgaW50ZXJuYWxMaXN0ZW5lciA9IHRoaXMuX2ZpcmVzdG9yZUNsaWVudC5saXN0ZW4oUXVlcnkuYXRQYXRoKHRoaXMuX2tleS5wYXRoKSwgYXN5bmNPYnNlcnZlciwgb3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYXN5bmNPYnNlcnZlci5tdXRlKCk7XHJcbiAgICAgICAgICAgIF90aGlzLl9maXJlc3RvcmVDbGllbnQudW5saXN0ZW4oaW50ZXJuYWxMaXN0ZW5lcik7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnRG9jdW1lbnRSZWZlcmVuY2UuZ2V0JywgYXJndW1lbnRzLCAwLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUdldE9wdGlvbnMoJ0RvY3VtZW50UmVmZXJlbmNlLmdldCcsIG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuc291cmNlID09PSAnY2FjaGUnKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5maXJlc3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgLmdldERvY3VtZW50RnJvbUxvY2FsQ2FjaGUoX3RoaXMuX2tleSlcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShuZXcgRG9jdW1lbnRTbmFwc2hvdChfdGhpcy5maXJlc3RvcmUsIF90aGlzLl9rZXksIGRvYywgXHJcbiAgICAgICAgICAgICAgICAgICAgLypmcm9tQ2FjaGU9Ki8gdHJ1ZSwgZG9jIGluc3RhbmNlb2YgRG9jdW1lbnQgPyBkb2MuaGFzTG9jYWxNdXRhdGlvbnMgOiBmYWxzZSkpO1xyXG4gICAgICAgICAgICAgICAgfSwgcmVqZWN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmdldFZpYVNuYXBzaG90TGlzdGVuZXIocmVzb2x2ZSwgcmVqZWN0LCBvcHRpb25zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZS5nZXRWaWFTbmFwc2hvdExpc3RlbmVyID0gZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciB1bmxpc3RlbiA9IHRoaXMub25TbmFwc2hvdEludGVybmFsKHtcclxuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogdHJ1ZSxcclxuICAgICAgICAgICAgd2FpdEZvclN5bmNXaGVuT25saW5lOiB0cnVlXHJcbiAgICAgICAgfSwge1xyXG4gICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAoc25hcCkge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHF1ZXJ5IGZpcnN0IGJlZm9yZSBwYXNzaW5nIGV2ZW50IHRvIHVzZXIgdG8gYXZvaWRcclxuICAgICAgICAgICAgICAgIC8vIHVzZXIgYWN0aW9ucyBhZmZlY3RpbmcgdGhlIG5vdyBzdGFsZSBxdWVyeS5cclxuICAgICAgICAgICAgICAgIHVubGlzdGVuKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXNuYXAuZXhpc3RzICYmIHNuYXAubWV0YWRhdGEuZnJvbUNhY2hlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBJZiB3ZSdyZSBvbmxpbmUgYW5kIHRoZSBkb2N1bWVudCBkb2Vzbid0XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZXhpc3QgdGhlbiB3ZSByZXNvbHZlIHdpdGggYSBkb2MuZXhpc3RzIHNldCB0byBmYWxzZS4gSWZcclxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSdyZSBvZmZsaW5lIGhvd2V2ZXIsIHdlIHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2FzZS4gVHdvIG9wdGlvbnM6IDEpIENhY2hlIHRoZSBuZWdhdGl2ZSByZXNwb25zZSBmcm9tXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlciBzbyB3ZSBjYW4gZGVsaXZlciB0aGF0IGV2ZW4gd2hlbiB5b3UncmVcclxuICAgICAgICAgICAgICAgICAgICAvLyBvZmZsaW5lIDIpIEFjdHVhbGx5IHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGUgb25saW5lIGNhc2VcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cclxuICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5BVkFJTEFCTEUsICdGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGJlY2F1c2UgdGhlIGNsaWVudCBpcyAnICsgJ29mZmxpbmUuJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc25hcC5leGlzdHMgJiZcclxuICAgICAgICAgICAgICAgICAgICBzbmFwLm1ldGFkYXRhLmZyb21DYWNoZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgJiZcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnNvdXJjZSA9PT0gJ3NlcnZlcicpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5BVkFJTEFCTEUsICdGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhpcyAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RvY3VtZW50IGRvZXMgZXhpc3QgaW4gdGhlIGxvY2FsIGNhY2hlLiBSdW4gYWdhaW4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd3aXRob3V0IHNldHRpbmcgc291cmNlIHRvIFwic2VydmVyXCIgdG8gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdyZXRyaWV2ZSB0aGUgY2FjaGVkIGRvY3VtZW50LiknKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHNuYXApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjogcmVqZWN0XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERvY3VtZW50UmVmZXJlbmNlO1xyXG59KCkpO1xyXG52YXIgU25hcHNob3RNZXRhZGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNuYXBzaG90TWV0YWRhdGEoaGFzUGVuZGluZ1dyaXRlcywgZnJvbUNhY2hlKSB7XHJcbiAgICAgICAgdGhpcy5oYXNQZW5kaW5nV3JpdGVzID0gaGFzUGVuZGluZ1dyaXRlcztcclxuICAgICAgICB0aGlzLmZyb21DYWNoZSA9IGZyb21DYWNoZTtcclxuICAgIH1cclxuICAgIFNuYXBzaG90TWV0YWRhdGEucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuaGFzUGVuZGluZ1dyaXRlcyA9PT0gb3RoZXIuaGFzUGVuZGluZ1dyaXRlcyAmJlxyXG4gICAgICAgICAgICB0aGlzLmZyb21DYWNoZSA9PT0gb3RoZXIuZnJvbUNhY2hlKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU25hcHNob3RNZXRhZGF0YTtcclxufSgpKTtcclxudmFyIERvY3VtZW50U25hcHNob3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEb2N1bWVudFNuYXBzaG90KF9maXJlc3RvcmUsIF9rZXksIF9kb2N1bWVudCwgX2Zyb21DYWNoZSwgX2hhc1BlbmRpbmdXcml0ZXMpIHtcclxuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSBfZmlyZXN0b3JlO1xyXG4gICAgICAgIHRoaXMuX2tleSA9IF9rZXk7XHJcbiAgICAgICAgdGhpcy5fZG9jdW1lbnQgPSBfZG9jdW1lbnQ7XHJcbiAgICAgICAgdGhpcy5fZnJvbUNhY2hlID0gX2Zyb21DYWNoZTtcclxuICAgICAgICB0aGlzLl9oYXNQZW5kaW5nV3JpdGVzID0gX2hhc1BlbmRpbmdXcml0ZXM7XHJcbiAgICB9XHJcbiAgICBEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZS5kYXRhID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ0RvY3VtZW50U25hcHNob3QuZGF0YScsIGFyZ3VtZW50cywgMCwgMSk7XHJcbiAgICAgICAgb3B0aW9ucyA9IHZhbGlkYXRlU25hcHNob3RPcHRpb25zKCdEb2N1bWVudFNuYXBzaG90LmRhdGEnLCBvcHRpb25zKTtcclxuICAgICAgICByZXR1cm4gIXRoaXMuX2RvY3VtZW50XHJcbiAgICAgICAgICAgID8gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgIDogdGhpcy5jb252ZXJ0T2JqZWN0KHRoaXMuX2RvY3VtZW50LmRhdGEsIEZpZWxkVmFsdWVPcHRpb25zLmZyb21TbmFwc2hvdE9wdGlvbnMob3B0aW9ucywgdGhpcy5fZmlyZXN0b3JlLl9hcmVUaW1lc3RhbXBzSW5TbmFwc2hvdHNFbmFibGVkKCkpKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoZmllbGRQYXRoLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdEb2N1bWVudFNuYXBzaG90LmdldCcsIGFyZ3VtZW50cywgMSwgMik7XHJcbiAgICAgICAgb3B0aW9ucyA9IHZhbGlkYXRlU25hcHNob3RPcHRpb25zKCdEb2N1bWVudFNuYXBzaG90LmdldCcsIG9wdGlvbnMpO1xyXG4gICAgICAgIGlmICh0aGlzLl9kb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLl9kb2N1bWVudC5kYXRhLmZpZWxkKGZpZWxkUGF0aEZyb21Bcmd1bWVudCgnRG9jdW1lbnRTbmFwc2hvdC5nZXQnLCBmaWVsZFBhdGgpKTtcclxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRWYWx1ZSh2YWx1ZSwgRmllbGRWYWx1ZU9wdGlvbnMuZnJvbVNuYXBzaG90T3B0aW9ucyhvcHRpb25zLCB0aGlzLl9maXJlc3RvcmUuX2FyZVRpbWVzdGFtcHNJblNuYXBzaG90c0VuYWJsZWQoKSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLCBcImlkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2tleS5wYXRoLmxhc3RTZWdtZW50KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUsIFwicmVmXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudFJlZmVyZW5jZSh0aGlzLl9rZXksIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUsIFwiZXhpc3RzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RvY3VtZW50ICE9PSBudWxsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLCBcIm1ldGFkYXRhXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTbmFwc2hvdE1ldGFkYXRhKHRoaXMuX2hhc1BlbmRpbmdXcml0ZXMsIHRoaXMuX2Zyb21DYWNoZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBEb2N1bWVudFNuYXBzaG90KSkge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkQ2xhc3NFcnJvcignaXNFcXVhbCcsICdEb2N1bWVudFNuYXBzaG90JywgMSwgb3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKHRoaXMuX2ZpcmVzdG9yZSA9PT0gb3RoZXIuX2ZpcmVzdG9yZSAmJlxyXG4gICAgICAgICAgICB0aGlzLl9mcm9tQ2FjaGUgPT09IG90aGVyLl9mcm9tQ2FjaGUgJiZcclxuICAgICAgICAgICAgdGhpcy5fa2V5LmlzRXF1YWwob3RoZXIuX2tleSkgJiZcclxuICAgICAgICAgICAgKHRoaXMuX2RvY3VtZW50ID09PSBudWxsXHJcbiAgICAgICAgICAgICAgICA/IG90aGVyLl9kb2N1bWVudCA9PT0gbnVsbFxyXG4gICAgICAgICAgICAgICAgOiB0aGlzLl9kb2N1bWVudC5pc0VxdWFsKG90aGVyLl9kb2N1bWVudCkpKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZS5jb252ZXJ0T2JqZWN0ID0gZnVuY3Rpb24gKGRhdGEsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBfdGhpcy5jb252ZXJ0VmFsdWUodmFsdWUsIG9wdGlvbnMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUuY29udmVydFZhbHVlID0gZnVuY3Rpb24gKHZhbHVlLCBvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgT2JqZWN0VmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydE9iamVjdCh2YWx1ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXlWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0QXJyYXkodmFsdWUsIG9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFJlZlZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSB2YWx1ZS52YWx1ZShvcHRpb25zKTtcclxuICAgICAgICAgICAgdmFyIGRhdGFiYXNlID0gdGhpcy5fZmlyZXN0b3JlLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKS5kYXRhYmFzZUlkKCk7XHJcbiAgICAgICAgICAgIGlmICghdmFsdWUuZGF0YWJhc2VJZC5pc0VxdWFsKGRhdGFiYXNlKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhiLzY0MTMwMjAyKTogU29tZWhvdyBzdXBwb3J0IGZvcmVpZ24gcmVmZXJlbmNlcy5cclxuICAgICAgICAgICAgICAgIGVycm9yKFwiRG9jdW1lbnQgXCIgKyB0aGlzLl9rZXkucGF0aCArIFwiIGNvbnRhaW5zIGEgZG9jdW1lbnQgXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwicmVmZXJlbmNlIHdpdGhpbiBhIGRpZmZlcmVudCBkYXRhYmFzZSAoXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICh2YWx1ZS5kYXRhYmFzZUlkLnByb2plY3RJZCArIFwiL1wiICsgdmFsdWUuZGF0YWJhc2VJZC5kYXRhYmFzZSArIFwiKSB3aGljaCBpcyBub3QgXCIpICtcclxuICAgICAgICAgICAgICAgICAgICBcInN1cHBvcnRlZC4gSXQgd2lsbCBiZSB0cmVhdGVkIGFzIGEgcmVmZXJlbmNlIGluIHRoZSBjdXJyZW50IFwiICtcclxuICAgICAgICAgICAgICAgICAgICAoXCJkYXRhYmFzZSAoXCIgKyBkYXRhYmFzZS5wcm9qZWN0SWQgKyBcIi9cIiArIGRhdGFiYXNlLmRhdGFiYXNlICsgXCIpIFwiKSArXHJcbiAgICAgICAgICAgICAgICAgICAgXCJpbnN0ZWFkLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50UmVmZXJlbmNlKGtleSwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS52YWx1ZShvcHRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUuY29udmVydEFycmF5ID0gZnVuY3Rpb24gKGRhdGEsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBkYXRhLmludGVybmFsVmFsdWUubWFwKGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY29udmVydFZhbHVlKHZhbHVlLCBvcHRpb25zKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRG9jdW1lbnRTbmFwc2hvdDtcclxufSgpKTtcclxudmFyIFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdChmaXJlc3RvcmUsIGtleSwgZG9jdW1lbnQsIGZyb21DYWNoZSwgaGFzUGVuZGluZ1dyaXRlcykge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBmaXJlc3RvcmUsIGtleSwgZG9jdW1lbnQsIGZyb21DYWNoZSwgaGFzUGVuZGluZ1dyaXRlcykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUuZGF0YSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBfc3VwZXIucHJvdG90eXBlLmRhdGEuY2FsbCh0aGlzLCBvcHRpb25zKTtcclxuICAgICAgICBhc3NlcnQodHlwZW9mIGRhdGEgPT09ICdvYmplY3QnLCAnRG9jdW1lbnQgaW4gYSBRdWVyeURvY3VtZW50U25hcHNob3Qgc2hvdWxkIGV4aXN0Jyk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdDtcclxufShEb2N1bWVudFNuYXBzaG90KSk7XHJcbnZhciBRdWVyeSQxID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnkkJDEoX3F1ZXJ5LCBmaXJlc3RvcmUpIHtcclxuICAgICAgICB0aGlzLl9xdWVyeSA9IF9xdWVyeTtcclxuICAgICAgICB0aGlzLmZpcmVzdG9yZSA9IGZpcmVzdG9yZTtcclxuICAgIH1cclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS53aGVyZSA9IGZ1bmN0aW9uIChmaWVsZCwgb3BTdHIsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnUXVlcnkud2hlcmUnLCBhcmd1bWVudHMsIDMpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnUXVlcnkud2hlcmUnLCAnbm9uLWVtcHR5IHN0cmluZycsIDIsIG9wU3RyKTtcclxuICAgICAgICB2YWxpZGF0ZURlZmluZWQoJ1F1ZXJ5LndoZXJlJywgMywgdmFsdWUpO1xyXG4gICAgICAgIHZhciBmaWVsZFZhbHVlO1xyXG4gICAgICAgIHZhciBmaWVsZFBhdGggPSBmaWVsZFBhdGhGcm9tQXJndW1lbnQoJ1F1ZXJ5LndoZXJlJywgZmllbGQpO1xyXG4gICAgICAgIHZhciByZWxhdGlvbk9wID0gUmVsYXRpb25PcC5mcm9tU3RyaW5nKG9wU3RyKTtcclxuICAgICAgICBpZiAoZmllbGRQYXRoLmlzS2V5RmllbGQoKSkge1xyXG4gICAgICAgICAgICBpZiAocmVsYXRpb25PcCA9PT0gUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIFF1ZXJ5LiBZb3UgY2FuJ3QgcGVyZm9ybSBhcnJheS1jb250YWlucyBxdWVyaWVzIG9uIFwiICtcclxuICAgICAgICAgICAgICAgICAgICAnRmllbGRQYXRoLmRvY3VtZW50SWQoKSBzaW5jZSBkb2N1bWVudCBJRHMgYXJlIG5vdCBhcnJheXMuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCcvJykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBBbGxvdyBzbGFzaGVzIG9uY2UgYW5jZXN0b3IgcXVlcmllcyBhcmUgc3VwcG9ydGVkXHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0Z1bmN0aW9uIFF1ZXJ5LndoZXJlKCkgcmVxdWlyZXMgaXRzIHRoaXJkIHBhcmFtZXRlciB0byBiZSBhICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAndmFsaWQgZG9jdW1lbnQgSUQgaWYgdGhlIGZpcnN0IHBhcmFtZXRlciBpcyAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ0ZpZWxkUGF0aC5kb2N1bWVudElkKCksIGJ1dCBpdCBjb250YWlucyBhIHNsYXNoLicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdGdW5jdGlvbiBRdWVyeS53aGVyZSgpIHJlcXVpcmVzIGl0cyB0aGlyZCBwYXJhbWV0ZXIgdG8gYmUgYSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3ZhbGlkIGRvY3VtZW50IElEIGlmIHRoZSBmaXJzdCBwYXJhbWV0ZXIgaXMgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdGaWVsZFBhdGguZG9jdW1lbnRJZCgpLCBidXQgaXQgd2FzIGFuIGVtcHR5IHN0cmluZy4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5fcXVlcnkucGF0aC5jaGlsZChuZXcgUmVzb3VyY2VQYXRoKFt2YWx1ZV0pKTtcclxuICAgICAgICAgICAgICAgIGFzc2VydChwYXRoLmxlbmd0aCAlIDIgPT09IDAsICdQYXRoIHNob3VsZCBiZSBhIGRvY3VtZW50IGtleScpO1xyXG4gICAgICAgICAgICAgICAgZmllbGRWYWx1ZSA9IG5ldyBSZWZWYWx1ZSh0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgbmV3IERvY3VtZW50S2V5KHBhdGgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERvY3VtZW50UmVmZXJlbmNlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVmID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBmaWVsZFZhbHVlID0gbmV3IFJlZlZhbHVlKHRoaXMuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCByZWYuX2tleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFF1ZXJ5LndoZXJlKCkgcmVxdWlyZXMgaXRzIHRoaXJkIHBhcmFtZXRlciB0byBiZSBhIFwiICtcclxuICAgICAgICAgICAgICAgICAgICBcInN0cmluZyBvciBhIERvY3VtZW50UmVmZXJlbmNlIGlmIHRoZSBmaXJzdCBwYXJhbWV0ZXIgaXMgXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwiRmllbGRQYXRoLmRvY3VtZW50SWQoKSwgYnV0IGl0IHdhczogXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICh2YWx1ZURlc2NyaXB0aW9uKHZhbHVlKSArIFwiLlwiKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZpZWxkVmFsdWUgPSB0aGlzLmZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVF1ZXJ5VmFsdWUoJ1F1ZXJ5LndoZXJlJywgdmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZmlsdGVyID0gRmlsdGVyLmNyZWF0ZShmaWVsZFBhdGgsIHJlbGF0aW9uT3AsIGZpZWxkVmFsdWUpO1xyXG4gICAgICAgIHRoaXMudmFsaWRhdGVOZXdGaWx0ZXIoZmlsdGVyKTtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5JCQxKHRoaXMuX3F1ZXJ5LmFkZEZpbHRlcihmaWx0ZXIpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLm9yZGVyQnkgPSBmdW5jdGlvbiAoZmllbGQsIGRpcmVjdGlvblN0cikge1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnUXVlcnkub3JkZXJCeScsIGFyZ3VtZW50cywgMSwgMik7XHJcbiAgICAgICAgdmFsaWRhdGVPcHRpb25hbEFyZ1R5cGUoJ1F1ZXJ5Lm9yZGVyQnknLCAnbm9uLWVtcHR5IHN0cmluZycsIDIsIGRpcmVjdGlvblN0cik7XHJcbiAgICAgICAgdmFyIGRpcmVjdGlvbjtcclxuICAgICAgICBpZiAoZGlyZWN0aW9uU3RyID09PSB1bmRlZmluZWQgfHwgZGlyZWN0aW9uU3RyID09PSAnYXNjJykge1xyXG4gICAgICAgICAgICBkaXJlY3Rpb24gPSBEaXJlY3Rpb24uQVNDRU5ESU5HO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkaXJlY3Rpb25TdHIgPT09ICdkZXNjJykge1xyXG4gICAgICAgICAgICBkaXJlY3Rpb24gPSBEaXJlY3Rpb24uREVTQ0VORElORztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gUXVlcnkub3JkZXJCeSgpIGhhcyB1bmtub3duIGRpcmVjdGlvbiAnXCIgKyBkaXJlY3Rpb25TdHIgKyBcIicsIFwiICtcclxuICAgICAgICAgICAgICAgIFwiZXhwZWN0ZWQgJ2FzYycgb3IgJ2Rlc2MnLlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3F1ZXJ5LnN0YXJ0QXQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBtdXN0IG5vdCBjYWxsIFF1ZXJ5LnN0YXJ0QXQoKSBvciAnICtcclxuICAgICAgICAgICAgICAgICdRdWVyeS5zdGFydEFmdGVyKCkgYmVmb3JlIGNhbGxpbmcgUXVlcnkub3JkZXJCeSgpLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fcXVlcnkuZW5kQXQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBtdXN0IG5vdCBjYWxsIFF1ZXJ5LmVuZEF0KCkgb3IgJyArXHJcbiAgICAgICAgICAgICAgICAnUXVlcnkuZW5kQmVmb3JlKCkgYmVmb3JlIGNhbGxpbmcgUXVlcnkub3JkZXJCeSgpLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZmllbGRQYXRoID0gZmllbGRQYXRoRnJvbUFyZ3VtZW50KCdRdWVyeS5vcmRlckJ5JywgZmllbGQpO1xyXG4gICAgICAgIHZhciBvcmRlckJ5ID0gbmV3IE9yZGVyQnkoZmllbGRQYXRoLCBkaXJlY3Rpb24pO1xyXG4gICAgICAgIHRoaXMudmFsaWRhdGVOZXdPcmRlckJ5KG9yZGVyQnkpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkkJDEodGhpcy5fcXVlcnkuYWRkT3JkZXJCeShvcmRlckJ5KSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5saW1pdCA9IGZ1bmN0aW9uIChuKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnUXVlcnkubGltaXQnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnUXVlcnkubGltaXQnLCAnbnVtYmVyJywgMSwgbik7XHJcbiAgICAgICAgaWYgKG4gPD0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgUXVlcnkuIFF1ZXJ5IGxpbWl0IChcIiArIG4gKyBcIikgaXMgaW52YWxpZC4gTGltaXQgbXVzdCBiZSBcIiArXHJcbiAgICAgICAgICAgICAgICAncG9zaXRpdmUuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkkJDEodGhpcy5fcXVlcnkud2l0aExpbWl0KG4pLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLnN0YXJ0QXQgPSBmdW5jdGlvbiAoZG9jT3JGaWVsZCkge1xyXG4gICAgICAgIHZhciBmaWVsZHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBmaWVsZHNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnUXVlcnkuc3RhcnRBdCcsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFyIGJvdW5kID0gdGhpcy5ib3VuZEZyb21Eb2NPckZpZWxkcygnUXVlcnkuc3RhcnRBdCcsIGRvY09yRmllbGQsIGZpZWxkcywgXHJcbiAgICAgICAgLypiZWZvcmU9Ki8gdHJ1ZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSQkMSh0aGlzLl9xdWVyeS53aXRoU3RhcnRBdChib3VuZCksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuc3RhcnRBZnRlciA9IGZ1bmN0aW9uIChkb2NPckZpZWxkKSB7XHJcbiAgICAgICAgdmFyIGZpZWxkcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGZpZWxkc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdRdWVyeS5zdGFydEFmdGVyJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YXIgYm91bmQgPSB0aGlzLmJvdW5kRnJvbURvY09yRmllbGRzKCdRdWVyeS5zdGFydEFmdGVyJywgZG9jT3JGaWVsZCwgZmllbGRzLCBcclxuICAgICAgICAvKmJlZm9yZT0qLyBmYWxzZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSQkMSh0aGlzLl9xdWVyeS53aXRoU3RhcnRBdChib3VuZCksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuZW5kQmVmb3JlID0gZnVuY3Rpb24gKGRvY09yRmllbGQpIHtcclxuICAgICAgICB2YXIgZmllbGRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgZmllbGRzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ1F1ZXJ5LmVuZEJlZm9yZScsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFyIGJvdW5kID0gdGhpcy5ib3VuZEZyb21Eb2NPckZpZWxkcygnUXVlcnkuZW5kQmVmb3JlJywgZG9jT3JGaWVsZCwgZmllbGRzLCBcclxuICAgICAgICAvKmJlZm9yZT0qLyB0cnVlKTtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5JCQxKHRoaXMuX3F1ZXJ5LndpdGhFbmRBdChib3VuZCksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuZW5kQXQgPSBmdW5jdGlvbiAoZG9jT3JGaWVsZCkge1xyXG4gICAgICAgIHZhciBmaWVsZHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBmaWVsZHNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnUXVlcnkuZW5kQXQnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhciBib3VuZCA9IHRoaXMuYm91bmRGcm9tRG9jT3JGaWVsZHMoJ1F1ZXJ5LmVuZEF0JywgZG9jT3JGaWVsZCwgZmllbGRzLCBcclxuICAgICAgICAvKmJlZm9yZT0qLyBmYWxzZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSQkMSh0aGlzLl9xdWVyeS53aXRoRW5kQXQoYm91bmQpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIFF1ZXJ5JCQxKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkQ2xhc3NFcnJvcignaXNFcXVhbCcsICdRdWVyeScsIDEsIG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmZpcmVzdG9yZSA9PT0gb3RoZXIuZmlyZXN0b3JlICYmIHRoaXMuX3F1ZXJ5LmlzRXF1YWwob3RoZXIuX3F1ZXJ5KSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEhlbHBlciBmdW5jdGlvbiB0byBjcmVhdGUgYSBib3VuZCBmcm9tIGEgZG9jdW1lbnQgb3IgZmllbGRzICovXHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuYm91bmRGcm9tRG9jT3JGaWVsZHMgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgZG9jT3JGaWVsZCwgZmllbGRzLCBiZWZvcmUpIHtcclxuICAgICAgICB2YWxpZGF0ZURlZmluZWQobWV0aG9kTmFtZSwgMSwgZG9jT3JGaWVsZCk7XHJcbiAgICAgICAgaWYgKGRvY09yRmllbGQgaW5zdGFuY2VvZiBEb2N1bWVudFNuYXBzaG90KSB7XHJcbiAgICAgICAgICAgIGlmIChmaWVsZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJUb28gbWFueSBhcmd1bWVudHMgcHJvdmlkZWQgdG8gXCIgKyBtZXRob2ROYW1lICsgXCIoKS5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHNuYXAgPSBkb2NPckZpZWxkO1xyXG4gICAgICAgICAgICBpZiAoIXNuYXAuZXhpc3RzKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5OT1RfRk9VTkQsIFwiQ2FuJ3QgdXNlIGEgRG9jdW1lbnRTbmFwc2hvdCB0aGF0IGRvZXNuJ3QgZXhpc3QgZm9yIFwiICtcclxuICAgICAgICAgICAgICAgICAgICAobWV0aG9kTmFtZSArIFwiKCkuXCIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3VuZEZyb21Eb2N1bWVudChtZXRob2ROYW1lLCBzbmFwLl9kb2N1bWVudCwgYmVmb3JlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBhbGxGaWVsZHMgPSBbZG9jT3JGaWVsZF0uY29uY2F0KGZpZWxkcyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvdW5kRnJvbUZpZWxkcyhtZXRob2ROYW1lLCBhbGxGaWVsZHMsIGJlZm9yZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIGEgQm91bmQgZnJvbSBhIHF1ZXJ5IGFuZCBhIGRvY3VtZW50LlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCB0aGUgQm91bmQgd2lsbCBhbHdheXMgaW5jbHVkZSB0aGUga2V5IG9mIHRoZSBkb2N1bWVudFxyXG4gICAgICogYW5kIHNvIG9ubHkgdGhlIHByb3ZpZGVkIGRvY3VtZW50IHdpbGwgY29tcGFyZSBlcXVhbCB0byB0aGUgcmV0dXJuZWRcclxuICAgICAqIHBvc2l0aW9uLlxyXG4gICAgICpcclxuICAgICAqIFdpbGwgdGhyb3cgaWYgdGhlIGRvY3VtZW50IGRvZXMgbm90IGNvbnRhaW4gYWxsIGZpZWxkcyBvZiB0aGUgb3JkZXIgYnlcclxuICAgICAqIG9mIHRoZSBxdWVyeS5cclxuICAgICAqL1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLmJvdW5kRnJvbURvY3VtZW50ID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIGRvYywgYmVmb3JlKSB7XHJcbiAgICAgICAgdmFyIGNvbXBvbmVudHMgPSBbXTtcclxuICAgICAgICAvLyBCZWNhdXNlIHBlb3BsZSBleHBlY3QgdG8gY29udGludWUvZW5kIGEgcXVlcnkgYXQgdGhlIGV4YWN0IGRvY3VtZW50XHJcbiAgICAgICAgLy8gcHJvdmlkZWQsIHdlIG5lZWQgdG8gdXNlIHRoZSBpbXBsaWNpdCBzb3J0IG9yZGVyIHJhdGhlciB0aGFuIHRoZSBleHBsaWNpdFxyXG4gICAgICAgIC8vIHNvcnQgb3JkZXIsIGJlY2F1c2UgaXQncyBndWFyYW50ZWVkIHRvIGNvbnRhaW4gdGhlIGRvY3VtZW50IGtleS4gVGhhdCB3YXlcclxuICAgICAgICAvLyB0aGUgcG9zaXRpb24gYmVjb21lcyB1bmFtYmlndW91cyBhbmQgdGhlIHF1ZXJ5IGNvbnRpbnVlcy9lbmRzIGV4YWN0bHkgYXRcclxuICAgICAgICAvLyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQuIFdpdGhvdXQgdGhlIGtleSAoYnkgdXNpbmcgdGhlIGV4cGxpY2l0IHNvcnRcclxuICAgICAgICAvLyBvcmRlcnMpLCBtdWx0aXBsZSBkb2N1bWVudHMgY291bGQgbWF0Y2ggdGhlIHBvc2l0aW9uLCB5aWVsZGluZyBkdXBsaWNhdGVcclxuICAgICAgICAvLyByZXN1bHRzLlxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9xdWVyeS5vcmRlckJ5OyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgb3JkZXJCeSA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKG9yZGVyQnkuZmllbGQuaXNLZXlGaWVsZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnRzLnB1c2gobmV3IFJlZlZhbHVlKHRoaXMuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCBkb2Mua2V5KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBkb2MuZmllbGQob3JkZXJCeS5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudHMucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGQgPSBvcmRlckJ5LmZpZWxkLmNhbm9uaWNhbFN0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gWW91IGFyZSB0cnlpbmcgdG8gc3RhcnQgb3IgZW5kIGEgcXVlcnkgdXNpbmcgYSBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChcImRvY3VtZW50IGZvciB3aGljaCB0aGUgZmllbGQgJ1wiICsgZmllbGQgKyBcIicgKHVzZWQgYXMgdGhlIFwiKSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwib3JkZXJCeSkgZG9lcyBub3QgZXhpc3QuXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgQm91bmQoY29tcG9uZW50cywgYmVmb3JlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnRzIGEgbGlzdCBvZiBmaWVsZCB2YWx1ZXMgdG8gYSBCb3VuZCBmb3IgdGhlIGdpdmVuIHF1ZXJ5LlxyXG4gICAgICovXHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuYm91bmRGcm9tRmllbGRzID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIHZhbHVlcyQkMSwgYmVmb3JlKSB7XHJcbiAgICAgICAgLy8gVXNlIGV4cGxpY2l0IG9yZGVyIGJ5J3MgYmVjYXVzZSBpdCBoYXMgdG8gbWF0Y2ggdGhlIHF1ZXJ5IHRoZSB1c2VyIG1hZGVcclxuICAgICAgICB2YXIgb3JkZXJCeSA9IHRoaXMuX3F1ZXJ5LmV4cGxpY2l0T3JkZXJCeTtcclxuICAgICAgICBpZiAodmFsdWVzJCQxLmxlbmd0aCA+IG9yZGVyQnkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiVG9vIG1hbnkgYXJndW1lbnRzIHByb3ZpZGVkIHRvIFwiICsgbWV0aG9kTmFtZSArIFwiKCkuIFwiICtcclxuICAgICAgICAgICAgICAgIFwiVGhlIG51bWJlciBvZiBhcmd1bWVudHMgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIFwiICtcclxuICAgICAgICAgICAgICAgIFwibnVtYmVyIG9mIFF1ZXJ5Lm9yZGVyQnkoKSBjbGF1c2VzXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY29tcG9uZW50cyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsdWVzJCQxLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciByYXdWYWx1ZSA9IHZhbHVlcyQkMVtpXTtcclxuICAgICAgICAgICAgdmFyIG9yZGVyQnlDb21wb25lbnQgPSBvcmRlckJ5W2ldO1xyXG4gICAgICAgICAgICBpZiAob3JkZXJCeUNvbXBvbmVudC5maWVsZC5pc0tleUZpZWxkKCkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmF3VmFsdWUgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHF1ZXJ5LiBFeHBlY3RlZCBhIHN0cmluZyBmb3IgZG9jdW1lbnQgSUQgaW4gXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAobWV0aG9kTmFtZSArIFwiKCksIGJ1dCBnb3QgYSBcIiArIHR5cGVvZiByYXdWYWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHJhd1ZhbHVlLmluZGV4T2YoJy8nKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIERvY3VtZW50IElEICdcIiArIHJhd1ZhbHVlICsgXCInIGNvbnRhaW5zIGEgc2xhc2ggaW4gXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAobWV0aG9kTmFtZSArIFwiKClcIikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IG5ldyBEb2N1bWVudEtleSh0aGlzLl9xdWVyeS5wYXRoLmNoaWxkKHJhd1ZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnRzLnB1c2gobmV3IFJlZlZhbHVlKHRoaXMuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCBrZXkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciB3cmFwcGVkID0gdGhpcy5maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VRdWVyeVZhbHVlKG1ldGhvZE5hbWUsIHJhd1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudHMucHVzaCh3cmFwcGVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IEJvdW5kKGNvbXBvbmVudHMsIGJlZm9yZSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLm9uU25hcHNob3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnUXVlcnkub25TbmFwc2hvdCcsIGFyZ3VtZW50cywgMSwgNCk7XHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7fTtcclxuICAgICAgICB2YXIgb2JzZXJ2ZXI7XHJcbiAgICAgICAgdmFyIGN1cnJBcmcgPSAwO1xyXG4gICAgICAgIGlmICh0eXBlb2YgYXJnc1tjdXJyQXJnXSA9PT0gJ29iamVjdCcgJiZcclxuICAgICAgICAgICAgIWlzUGFydGlhbE9ic2VydmVyKGFyZ3NbY3VyckFyZ10pKSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMgPSBhcmdzW2N1cnJBcmddO1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU9wdGlvbk5hbWVzKCdRdWVyeS5vblNuYXBzaG90Jywgb3B0aW9ucywgW1xyXG4gICAgICAgICAgICAgICAgJ2luY2x1ZGVNZXRhZGF0YUNoYW5nZXMnXHJcbiAgICAgICAgICAgIF0pO1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxUeXBlKCdRdWVyeS5vblNuYXBzaG90JywgJ2Jvb2xlYW4nLCAnaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcycsIG9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyk7XHJcbiAgICAgICAgICAgIGN1cnJBcmcrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzUGFydGlhbE9ic2VydmVyKGFyZ3NbY3VyckFyZ10pKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyID0gYXJnc1tjdXJyQXJnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnUXVlcnkub25TbmFwc2hvdCcsICdmdW5jdGlvbicsIGN1cnJBcmcsIGFyZ3NbY3VyckFyZ10pO1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU9wdGlvbmFsQXJnVHlwZSgnUXVlcnkub25TbmFwc2hvdCcsICdmdW5jdGlvbicsIGN1cnJBcmcgKyAxLCBhcmdzW2N1cnJBcmcgKyAxXSk7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlT3B0aW9uYWxBcmdUeXBlKCdRdWVyeS5vblNuYXBzaG90JywgJ2Z1bmN0aW9uJywgY3VyckFyZyArIDIsIGFyZ3NbY3VyckFyZyArIDJdKTtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0OiBhcmdzW2N1cnJBcmddLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IGFyZ3NbY3VyckFyZyArIDFdLFxyXG4gICAgICAgICAgICAgICAgY29tcGxldGU6IGFyZ3NbY3VyckFyZyArIDJdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLm9uU25hcHNob3RJbnRlcm5hbChvcHRpb25zLCBvYnNlcnZlcik7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLm9uU25hcHNob3RJbnRlcm5hbCA9IGZ1bmN0aW9uIChvcHRpb25zLCBvYnNlcnZlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGVyckhhbmRsZXIgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuY2F1Z2h0IEVycm9yIGluIG9uU25hcHNob3Q6JywgZXJyKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChvYnNlcnZlci5lcnJvcikge1xyXG4gICAgICAgICAgICBlcnJIYW5kbGVyID0gb2JzZXJ2ZXIuZXJyb3IuYmluZChvYnNlcnZlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBhc3luY09ic2VydmVyID0gbmV3IEFzeW5jT2JzZXJ2ZXIoe1xyXG4gICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIubmV4dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQobmV3IFF1ZXJ5U25hcHNob3QoX3RoaXMuZmlyZXN0b3JlLCBfdGhpcy5fcXVlcnksIHJlc3VsdCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjogZXJySGFuZGxlclxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBmaXJlc3RvcmVDbGllbnQgPSB0aGlzLmZpcmVzdG9yZS5lbnN1cmVDbGllbnRDb25maWd1cmVkKCk7XHJcbiAgICAgICAgdmFyIGludGVybmFsTGlzdGVuZXIgPSBmaXJlc3RvcmVDbGllbnQubGlzdGVuKHRoaXMuX3F1ZXJ5LCBhc3luY09ic2VydmVyLCBvcHRpb25zKTtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBhc3luY09ic2VydmVyLm11dGUoKTtcclxuICAgICAgICAgICAgZmlyZXN0b3JlQ2xpZW50LnVubGlzdGVuKGludGVybmFsTGlzdGVuZXIpO1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ1F1ZXJ5LmdldCcsIGFyZ3VtZW50cywgMCwgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVHZXRPcHRpb25zKCdRdWVyeS5nZXQnLCBvcHRpb25zKTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnNvdXJjZSA9PT0gJ2NhY2hlJykge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZmlyZXN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5nZXREb2N1bWVudHNGcm9tTG9jYWxDYWNoZShfdGhpcy5fcXVlcnkpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHZpZXdTbmFwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShuZXcgUXVlcnlTbmFwc2hvdChfdGhpcy5maXJlc3RvcmUsIF90aGlzLl9xdWVyeSwgdmlld1NuYXApKTtcclxuICAgICAgICAgICAgICAgIH0sIHJlamVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5nZXRWaWFTbmFwc2hvdExpc3RlbmVyKHJlc29sdmUsIHJlamVjdCwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuZ2V0VmlhU25hcHNob3RMaXN0ZW5lciA9IGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgdW5saXN0ZW4gPSB0aGlzLm9uU25hcHNob3RJbnRlcm5hbCh7XHJcbiAgICAgICAgICAgIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6IHRydWUsXHJcbiAgICAgICAgICAgIHdhaXRGb3JTeW5jV2hlbk9ubGluZTogdHJ1ZVxyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHF1ZXJ5IGZpcnN0IGJlZm9yZSBwYXNzaW5nIGV2ZW50IHRvIHVzZXIgdG8gYXZvaWRcclxuICAgICAgICAgICAgICAgIC8vIHVzZXIgYWN0aW9ucyBhZmZlY3RpbmcgdGhlIG5vdyBzdGFsZSBxdWVyeS5cclxuICAgICAgICAgICAgICAgIHVubGlzdGVuKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Lm1ldGFkYXRhLmZyb21DYWNoZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgJiZcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnNvdXJjZSA9PT0gJ3NlcnZlcicpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5BVkFJTEFCTEUsICdGYWlsZWQgdG8gZ2V0IGRvY3VtZW50cyBmcm9tIHNlcnZlci4gKEhvd2V2ZXIsIHRoZXNlICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZG9jdW1lbnRzIG1heSBleGlzdCBpbiB0aGUgbG9jYWwgY2FjaGUuIFJ1biBhZ2FpbiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3dpdGhvdXQgc2V0dGluZyBzb3VyY2UgdG8gXCJzZXJ2ZXJcIiB0byAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3JldHJpZXZlIHRoZSBjYWNoZWQgZG9jdW1lbnRzLiknKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiByZWplY3RcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUudmFsaWRhdGVOZXdGaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgaWYgKGZpbHRlciBpbnN0YW5jZW9mIFJlbGF0aW9uRmlsdGVyKSB7XHJcbiAgICAgICAgICAgIGlmIChmaWx0ZXIuaXNJbmVxdWFsaXR5KCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZpZWxkID0gdGhpcy5fcXVlcnkuZ2V0SW5lcXVhbGl0eUZpbHRlckZpZWxkKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGaWVsZCAhPT0gbnVsbCAmJiAhZXhpc3RpbmdGaWVsZC5pc0VxdWFsKGZpbHRlci5maWVsZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnSW52YWxpZCBxdWVyeS4gQWxsIHdoZXJlIGZpbHRlcnMgd2l0aCBhbiBpbmVxdWFsaXR5JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICcgKDwsIDw9LCA+LCBvciA+PSkgbXVzdCBiZSBvbiB0aGUgc2FtZSBmaWVsZC4gQnV0IHlvdSBoYXZlJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChcIiBpbmVxdWFsaXR5IGZpbHRlcnMgb24gJ1wiICsgZXhpc3RpbmdGaWVsZC50b1N0cmluZygpICsgXCInXCIpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKFwiIGFuZCAnXCIgKyBmaWx0ZXIuZmllbGQudG9TdHJpbmcoKSArIFwiJ1wiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3RPcmRlckJ5RmllbGQgPSB0aGlzLl9xdWVyeS5nZXRGaXJzdE9yZGVyQnlGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpcnN0T3JkZXJCeUZpZWxkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZU9yZGVyQnlBbmRJbmVxdWFsaXR5TWF0Y2goZmlsdGVyLmZpZWxkLCBmaXJzdE9yZGVyQnlGaWVsZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZmlsdGVyLm9wID09PSBSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcXVlcnkuaGFzQXJyYXlDb250YWluc0ZpbHRlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFF1ZXJpZXMgb25seSBzdXBwb3J0IGEgc2luZ2xlIGFycmF5LWNvbnRhaW5zICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZmlsdGVyLicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS52YWxpZGF0ZU5ld09yZGVyQnkgPSBmdW5jdGlvbiAob3JkZXJCeSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9xdWVyeS5nZXRGaXJzdE9yZGVyQnlGaWVsZCgpID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IG9yZGVyIGJ5LiBJdCBtdXN0IG1hdGNoIGFueSBpbmVxdWFsaXR5LlxyXG4gICAgICAgICAgICB2YXIgaW5lcXVhbGl0eUZpZWxkID0gdGhpcy5fcXVlcnkuZ2V0SW5lcXVhbGl0eUZpbHRlckZpZWxkKCk7XHJcbiAgICAgICAgICAgIGlmIChpbmVxdWFsaXR5RmllbGQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVPcmRlckJ5QW5kSW5lcXVhbGl0eU1hdGNoKGluZXF1YWxpdHlGaWVsZCwgb3JkZXJCeS5maWVsZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLnZhbGlkYXRlT3JkZXJCeUFuZEluZXF1YWxpdHlNYXRjaCA9IGZ1bmN0aW9uIChpbmVxdWFsaXR5LCBvcmRlckJ5KSB7XHJcbiAgICAgICAgaWYgKCFvcmRlckJ5LmlzRXF1YWwoaW5lcXVhbGl0eSkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHF1ZXJ5LiBZb3UgaGF2ZSBhIHdoZXJlIGZpbHRlciB3aXRoIGFuIGluZXF1YWxpdHkgXCIgK1xyXG4gICAgICAgICAgICAgICAgKFwiKDwsIDw9LCA+LCBvciA+PSkgb24gZmllbGQgJ1wiICsgaW5lcXVhbGl0eS50b1N0cmluZygpICsgXCInIFwiKSArXHJcbiAgICAgICAgICAgICAgICAoXCJhbmQgc28geW91IG11c3QgYWxzbyB1c2UgJ1wiICsgaW5lcXVhbGl0eS50b1N0cmluZygpICsgXCInIFwiKSArXHJcbiAgICAgICAgICAgICAgICBcImFzIHlvdXIgZmlyc3QgUXVlcnkub3JkZXJCeSgpLCBidXQgeW91ciBmaXJzdCBRdWVyeS5vcmRlckJ5KCkgXCIgK1xyXG4gICAgICAgICAgICAgICAgKFwiaXMgb24gZmllbGQgJ1wiICsgb3JkZXJCeS50b1N0cmluZygpICsgXCInIGluc3RlYWQuXCIpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5JCQxO1xyXG59KCkpO1xyXG52YXIgUXVlcnlTbmFwc2hvdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5U25hcHNob3QoX2ZpcmVzdG9yZSwgX29yaWdpbmFsUXVlcnksIF9zbmFwc2hvdCkge1xyXG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IF9maXJlc3RvcmU7XHJcbiAgICAgICAgdGhpcy5fb3JpZ2luYWxRdWVyeSA9IF9vcmlnaW5hbFF1ZXJ5O1xyXG4gICAgICAgIHRoaXMuX3NuYXBzaG90ID0gX3NuYXBzaG90O1xyXG4gICAgICAgIHRoaXMuX2NhY2hlZENoYW5nZXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2NhY2hlZENoYW5nZXNJbmNsdWRlTWV0YWRhdGFDaGFuZ2VzID0gbnVsbDtcclxuICAgICAgICB0aGlzLm1ldGFkYXRhID0gbmV3IFNuYXBzaG90TWV0YWRhdGEoX3NuYXBzaG90Lmhhc1BlbmRpbmdXcml0ZXMsIF9zbmFwc2hvdC5mcm9tQ2FjaGUpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLCBcImRvY3NcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7IHJldHVybiByZXN1bHQucHVzaChkb2MpOyB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShRdWVyeVNuYXBzaG90LnByb3RvdHlwZSwgXCJlbXB0eVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zbmFwc2hvdC5kb2NzLmlzRW1wdHkoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShRdWVyeVNuYXBzaG90LnByb3RvdHlwZSwgXCJzaXplXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NuYXBzaG90LmRvY3Muc2l6ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnUXVlcnlTbmFwc2hvdC5mb3JFYWNoJywgYXJndW1lbnRzLCAxLCAyKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ1F1ZXJ5U25hcHNob3QuZm9yRWFjaCcsICdmdW5jdGlvbicsIDEsIGNhbGxiYWNrKTtcclxuICAgICAgICB0aGlzLl9zbmFwc2hvdC5kb2NzLmZvckVhY2goZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIF90aGlzLmNvbnZlcnRUb0RvY3VtZW50SW1wbChkb2MpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUsIFwicXVlcnlcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5JDEodGhpcy5fb3JpZ2luYWxRdWVyeSwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLmRvY0NoYW5nZXMgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIGlmIChvcHRpb25zKSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlT3B0aW9uTmFtZXMoJ1F1ZXJ5U25hcHNob3QuZG9jQ2hhbmdlcycsIG9wdGlvbnMsIFtcclxuICAgICAgICAgICAgICAgICdpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzJ1xyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgdmFsaWRhdGVOYW1lZE9wdGlvbmFsVHlwZSgnUXVlcnlTbmFwc2hvdC5kb2NDaGFuZ2VzJywgJ2Jvb2xlYW4nLCAnaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcycsIG9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzID0gISEob3B0aW9ucyAmJiBvcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXMpO1xyXG4gICAgICAgIGlmIChpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzICYmIHRoaXMuX3NuYXBzaG90LmV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdUbyBpbmNsdWRlIG1ldGFkYXRhIGNoYW5nZXMgd2l0aCB5b3VyIGRvY3VtZW50IGNoYW5nZXMsIHlvdSBtdXN0ICcgK1xyXG4gICAgICAgICAgICAgICAgJ2Fsc28gcGFzcyB7IGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6dHJ1ZSB9IHRvIG9uU25hcHNob3QoKS4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLl9jYWNoZWRDaGFuZ2VzIHx8XHJcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlZENoYW5nZXNJbmNsdWRlTWV0YWRhdGFDaGFuZ2VzICE9PSBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlZENoYW5nZXMgPSBjaGFuZ2VzRnJvbVNuYXBzaG90KHRoaXMuX2ZpcmVzdG9yZSwgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcywgdGhpcy5fc25hcHNob3QpO1xyXG4gICAgICAgICAgICB0aGlzLl9jYWNoZWRDaGFuZ2VzSW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyA9IGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRDaGFuZ2VzO1xyXG4gICAgfTtcclxuICAgIC8qKiBDaGVjayB0aGUgZXF1YWxpdHkuIFRoZSBjYWxsIGNhbiBiZSB2ZXJ5IGV4cGVuc2l2ZS4gKi9cclxuICAgIFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIFF1ZXJ5U25hcHNob3QpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludmFsaWRDbGFzc0Vycm9yKCdpc0VxdWFsJywgJ1F1ZXJ5U25hcHNob3QnLCAxLCBvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAodGhpcy5fZmlyZXN0b3JlID09PSBvdGhlci5fZmlyZXN0b3JlICYmXHJcbiAgICAgICAgICAgIHRoaXMuX29yaWdpbmFsUXVlcnkuaXNFcXVhbChvdGhlci5fb3JpZ2luYWxRdWVyeSkgJiZcclxuICAgICAgICAgICAgdGhpcy5fc25hcHNob3QuaXNFcXVhbChvdGhlci5fc25hcHNob3QpKTtcclxuICAgIH07XHJcbiAgICBRdWVyeVNuYXBzaG90LnByb3RvdHlwZS5jb252ZXJ0VG9Eb2N1bWVudEltcGwgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeURvY3VtZW50U25hcHNob3QodGhpcy5fZmlyZXN0b3JlLCBkb2Mua2V5LCBkb2MsIHRoaXMubWV0YWRhdGEuZnJvbUNhY2hlLCB0aGlzLl9zbmFwc2hvdC5tdXRhdGVkS2V5cy5oYXMoZG9jLmtleSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBRdWVyeVNuYXBzaG90O1xyXG59KCkpO1xyXG4vLyBUT0RPKDIwMTgvMTEvMDEpOiBBcyBvZiAyMDE4LzA0LzE3IHdlJ3JlIGNoYW5naW5nIGRvY0NoYW5nZXMgZnJvbSBhbiBhcnJheVxyXG4vLyBpbnRvIGEgbWV0aG9kLiBCZWNhdXNlIHRoaXMgaXMgYSBydW50aW1lIGJyZWFraW5nIGNoYW5nZSBhbmQgc29tZXdoYXQgc3VidGxlXHJcbi8vIChib3RoIEFycmF5IGFuZCBGdW5jdGlvbiBoYXZlIGEgLmxlbmd0aCwgZXRjLiksIHdlJ2xsIHJlcGxhY2UgY29tbW9ubHktdXNlZFxyXG4vLyBwcm9wZXJ0aWVzIChpbmNsdWRpbmcgU3ltYm9sLml0ZXJhdG9yKSB0byB0aHJvdyBhIGN1c3RvbSBlcnJvciBtZXNzYWdlLiBJblxyXG4vLyB+NiBtb250aHMgd2UgY2FuIGRlbGV0ZSB0aGUgY3VzdG9tIGVycm9yIGFzIG1vc3QgZm9sa3Mgd2lsbCBoYXZlIGhvcGVmdWxseVxyXG4vLyBtaWdyYXRlZC5cclxuZnVuY3Rpb24gdGhyb3dEb2NDaGFuZ2VzTWV0aG9kRXJyb3IoKSB7XHJcbiAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnUXVlcnlTbmFwc2hvdC5kb2NDaGFuZ2VzIGhhcyBiZWVuIGNoYW5nZWQgZnJvbSBhIHByb3BlcnR5IGludG8gYSAnICtcclxuICAgICAgICAnbWV0aG9kLCBzbyB1c2FnZXMgbGlrZSBcInF1ZXJ5U25hcHNob3QuZG9jQ2hhbmdlc1wiIHNob3VsZCBiZWNvbWUgJyArXHJcbiAgICAgICAgJ1wicXVlcnlTbmFwc2hvdC5kb2NDaGFuZ2VzKClcIicpO1xyXG59XHJcbnZhciBkb2NDaGFuZ2VzUHJvcGVydGllc1RvT3ZlcnJpZGUgPSBbXHJcbiAgICAnbGVuZ3RoJyxcclxuICAgICdmb3JFYWNoJyxcclxuICAgICdtYXAnXHJcbl0uY29uY2F0KCh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyA/IFtTeW1ib2wuaXRlcmF0b3JdIDogW10pKTtcclxuZG9jQ2hhbmdlc1Byb3BlcnRpZXNUb092ZXJyaWRlLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5KSB7XHJcbiAgICAvKipcclxuICAgICAqIFdlIGFyZSAocmUtKWRlZmluaW5nIHByb3BlcnRpZXMgb24gUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUuZG9jQ2hhbmdlcyB3aGljaFxyXG4gICAgICogaXMgYSBGdW5jdGlvbi4gVGhpcyBjb3VsZCBmYWlsLCBpbiBwYXJ0aWN1bGFyIGluIHRoZSBjYXNlIG9mICdsZW5ndGgnIHdoaWNoXHJcbiAgICAgKiBhbHJlYWR5IGV4aXN0cyBvbiBGdW5jdGlvbi5wcm90b3R5cGUgYW5kIG9uIElFMTEgaXMgaW1wcm9wZXJseSBkZWZpbmVkIHdpdGhcclxuICAgICAqIGB7IGNvbmZpZ3VyYWJsZTogZmFsc2UgfWAuIFNvIHdlIHdyYXAgdGhpcyBpbiBhIHRyeS9jYXRjaCB0byBlbnN1cmUgdGhhdCB3ZVxyXG4gICAgICogc3RpbGwgaGF2ZSBhIGZ1bmN0aW9uYWwgU0RLLlxyXG4gICAgICovXHJcbiAgICB0cnkge1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShRdWVyeVNuYXBzaG90LnByb3RvdHlwZS5kb2NDaGFuZ2VzLCBwcm9wZXJ0eSwge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRocm93RG9jQ2hhbmdlc01ldGhvZEVycm9yKCk7IH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnIpIHsgfSAvLyBJZ25vcmUgdGhpcyBmYWlsdXJlIGludGVudGlvbmFsbHlcclxufSk7XHJcbnZhciBDb2xsZWN0aW9uUmVmZXJlbmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQ29sbGVjdGlvblJlZmVyZW5jZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIENvbGxlY3Rpb25SZWZlcmVuY2UocGF0aCwgZmlyZXN0b3JlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgUXVlcnkuYXRQYXRoKHBhdGgpLCBmaXJlc3RvcmUpIHx8IHRoaXM7XHJcbiAgICAgICAgaWYgKHBhdGgubGVuZ3RoICUgMiAhPT0gMSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnSW52YWxpZCBjb2xsZWN0aW9uIHJlZmVyZW5jZS4gQ29sbGVjdGlvbiAnICtcclxuICAgICAgICAgICAgICAgICdyZWZlcmVuY2VzIG11c3QgaGF2ZSBhbiBvZGQgbnVtYmVyIG9mIHNlZ21lbnRzLCBidXQgJyArXHJcbiAgICAgICAgICAgICAgICAocGF0aC5jYW5vbmljYWxTdHJpbmcoKSArIFwiIGhhcyBcIiArIHBhdGgubGVuZ3RoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xsZWN0aW9uUmVmZXJlbmNlLnByb3RvdHlwZSwgXCJpZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9xdWVyeS5wYXRoLmxhc3RTZWdtZW50KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sbGVjdGlvblJlZmVyZW5jZS5wcm90b3R5cGUsIFwicGFyZW50XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmVudFBhdGggPSB0aGlzLl9xdWVyeS5wYXRoLnBvcExhc3QoKTtcclxuICAgICAgICAgICAgaWYgKHBhcmVudFBhdGguaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRSZWZlcmVuY2UobmV3IERvY3VtZW50S2V5KHBhcmVudFBhdGgpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xsZWN0aW9uUmVmZXJlbmNlLnByb3RvdHlwZSwgXCJwYXRoXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBDb2xsZWN0aW9uUmVmZXJlbmNlLnByb3RvdHlwZS5kb2MgPSBmdW5jdGlvbiAocGF0aFN0cmluZykge1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnQ29sbGVjdGlvblJlZmVyZW5jZS5kb2MnLCBhcmd1bWVudHMsIDAsIDEpO1xyXG4gICAgICAgIC8vIFdlIGFsbG93IG9taXNzaW9uIG9mICdwYXRoU3RyaW5nJyBidXQgZXhwbGljaXRseSBwcm9oaWJpdCBwYXNzaW5nIGluIGJvdGhcclxuICAgICAgICAvLyAndW5kZWZpbmVkJyBhbmQgJ251bGwnLlxyXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHBhdGhTdHJpbmcgPSBBdXRvSWQubmV3SWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdDb2xsZWN0aW9uUmVmZXJlbmNlLmRvYycsICdub24tZW1wdHkgc3RyaW5nJywgMSwgcGF0aFN0cmluZyk7XHJcbiAgICAgICAgaWYgKHBhdGhTdHJpbmcgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdEb2N1bWVudCBwYXRoIG11c3QgYmUgYSBub24tZW1wdHkgc3RyaW5nJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwYXRoID0gUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcocGF0aFN0cmluZyk7XHJcbiAgICAgICAgcmV0dXJuIERvY3VtZW50UmVmZXJlbmNlLmZvclBhdGgodGhpcy5fcXVlcnkucGF0aC5jaGlsZChwYXRoKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb25SZWZlcmVuY2UucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0NvbGxlY3Rpb25SZWZlcmVuY2UuYWRkJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0NvbGxlY3Rpb25SZWZlcmVuY2UuYWRkJywgJ29iamVjdCcsIDEsIHZhbHVlKTtcclxuICAgICAgICB2YXIgZG9jUmVmID0gdGhpcy5kb2MoKTtcclxuICAgICAgICByZXR1cm4gZG9jUmVmLnNldCh2YWx1ZSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBkb2NSZWY7IH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDb2xsZWN0aW9uUmVmZXJlbmNlO1xyXG59KFF1ZXJ5JDEpKTtcclxuZnVuY3Rpb24gdmFsaWRhdGVTZXRPcHRpb25zKG1ldGhvZE5hbWUsIG9wdGlvbnMpIHtcclxuICAgIGlmIChvcHRpb25zID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtZXJnZTogZmFsc2VcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgdmFsaWRhdGVPcHRpb25OYW1lcyhtZXRob2ROYW1lLCBvcHRpb25zLCBbJ21lcmdlJywgJ21lcmdlRmllbGRzJ10pO1xyXG4gICAgdmFsaWRhdGVOYW1lZE9wdGlvbmFsVHlwZShtZXRob2ROYW1lLCAnYm9vbGVhbicsICdtZXJnZScsIG9wdGlvbnMubWVyZ2UpO1xyXG4gICAgdmFsaWRhdGVPcHRpb25hbEFycmF5RWxlbWVudHMobWV0aG9kTmFtZSwgJ21lcmdlRmllbGRzJywgJ2Egc3RyaW5nIG9yIGEgRmllbGRQYXRoJywgb3B0aW9ucy5tZXJnZUZpZWxkcywgZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gdHlwZW9mIGVsZW1lbnQgPT09ICdzdHJpbmcnIHx8IGVsZW1lbnQgaW5zdGFuY2VvZiBGaWVsZFBhdGgkMTtcclxuICAgIH0pO1xyXG4gICAgaWYgKG9wdGlvbnMubWVyZ2VGaWVsZHMgIT09IHVuZGVmaW5lZCAmJiBvcHRpb25zLm1lcmdlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgb3B0aW9ucyBwYXNzZWQgdG8gZnVuY3Rpb24gXCIgKyBtZXRob2ROYW1lICsgXCIoKTogWW91IGNhbm5vdCBzcGVjaWZ5IGJvdGggXFxcIm1lcmdlXFxcIiBcIiArXHJcbiAgICAgICAgICAgIFwiYW5kIFxcXCJtZXJnZUZpZWxkc1xcXCIuXCIpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9wdGlvbnM7XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVTbmFwc2hvdE9wdGlvbnMobWV0aG9kTmFtZSwgb3B0aW9ucykge1xyXG4gICAgaWYgKG9wdGlvbnMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiB7fTtcclxuICAgIH1cclxuICAgIHZhbGlkYXRlT3B0aW9uTmFtZXMobWV0aG9kTmFtZSwgb3B0aW9ucywgWydzZXJ2ZXJUaW1lc3RhbXBzJ10pO1xyXG4gICAgdmFsaWRhdGVOYW1lZE9wdGlvbmFsUHJvcGVydHlFcXVhbHMobWV0aG9kTmFtZSwgJ29wdGlvbnMnLCAnc2VydmVyVGltZXN0YW1wcycsIG9wdGlvbnMuc2VydmVyVGltZXN0YW1wcywgWydlc3RpbWF0ZScsICdwcmV2aW91cycsICdub25lJ10pO1xyXG4gICAgcmV0dXJuIG9wdGlvbnM7XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVHZXRPcHRpb25zKG1ldGhvZE5hbWUsIG9wdGlvbnMpIHtcclxuICAgIHZhbGlkYXRlT3B0aW9uYWxBcmdUeXBlKG1ldGhvZE5hbWUsICdvYmplY3QnLCAxLCBvcHRpb25zKTtcclxuICAgIGlmIChvcHRpb25zKSB7XHJcbiAgICAgICAgdmFsaWRhdGVPcHRpb25OYW1lcyhtZXRob2ROYW1lLCBvcHRpb25zLCBbJ3NvdXJjZSddKTtcclxuICAgICAgICB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxQcm9wZXJ0eUVxdWFscyhtZXRob2ROYW1lLCAnb3B0aW9ucycsICdzb3VyY2UnLCBvcHRpb25zLnNvdXJjZSwgWydkZWZhdWx0JywgJ3NlcnZlcicsICdjYWNoZSddKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZVJlZmVyZW5jZShtZXRob2ROYW1lLCBkb2N1bWVudFJlZiwgZmlyZXN0b3JlKSB7XHJcbiAgICBpZiAoIShkb2N1bWVudFJlZiBpbnN0YW5jZW9mIERvY3VtZW50UmVmZXJlbmNlKSkge1xyXG4gICAgICAgIHRocm93IGludmFsaWRDbGFzc0Vycm9yKG1ldGhvZE5hbWUsICdEb2N1bWVudFJlZmVyZW5jZScsIDEsIGRvY3VtZW50UmVmKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGRvY3VtZW50UmVmLmZpcmVzdG9yZSAhPT0gZmlyZXN0b3JlKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1Byb3ZpZGVkIGRvY3VtZW50IHJlZmVyZW5jZSBpcyBmcm9tIGEgZGlmZmVyZW50IEZpcmVzdG9yZSBpbnN0YW5jZS4nKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudFJlZjtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogQ2FsY3VsYXRlcyB0aGUgYXJyYXkgb2YgZmlyZXN0b3JlLkRvY3VtZW50Q2hhbmdlJ3MgZm9yIGEgZ2l2ZW4gVmlld1NuYXBzaG90LlxyXG4gKlxyXG4gKiBFeHBvcnRlZCBmb3IgdGVzdGluZy5cclxuICovXHJcbmZ1bmN0aW9uIGNoYW5nZXNGcm9tU25hcHNob3QoZmlyZXN0b3JlLCBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzLCBzbmFwc2hvdCkge1xyXG4gICAgaWYgKHNuYXBzaG90Lm9sZERvY3MuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgLy8gU3BlY2lhbCBjYXNlIHRoZSBmaXJzdCBzbmFwc2hvdCBiZWNhdXNlIGluZGV4IGNhbGN1bGF0aW9uIGlzIGVhc3kgYW5kXHJcbiAgICAgICAgLy8gZmFzdFxyXG4gICAgICAgIHZhciBsYXN0RG9jXzE7XHJcbiAgICAgICAgdmFyIGluZGV4XzEgPSAwO1xyXG4gICAgICAgIHJldHVybiBzbmFwc2hvdC5kb2NDaGFuZ2VzLm1hcChmdW5jdGlvbiAoY2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHZhciBkb2MgPSBuZXcgUXVlcnlEb2N1bWVudFNuYXBzaG90KGZpcmVzdG9yZSwgY2hhbmdlLmRvYy5rZXksIGNoYW5nZS5kb2MsIHNuYXBzaG90LmZyb21DYWNoZSwgc25hcHNob3QubXV0YXRlZEtleXMuaGFzKGNoYW5nZS5kb2Mua2V5KSk7XHJcbiAgICAgICAgICAgIGFzc2VydChjaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5BZGRlZCwgJ0ludmFsaWQgZXZlbnQgdHlwZSBmb3IgZmlyc3Qgc25hcHNob3QnKTtcclxuICAgICAgICAgICAgYXNzZXJ0KCFsYXN0RG9jXzEgfHwgc25hcHNob3QucXVlcnkuZG9jQ29tcGFyYXRvcihsYXN0RG9jXzEsIGNoYW5nZS5kb2MpIDwgMCwgJ0dvdCBhZGRlZCBldmVudHMgaW4gd3Jvbmcgb3JkZXInKTtcclxuICAgICAgICAgICAgbGFzdERvY18xID0gY2hhbmdlLmRvYztcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdhZGRlZCcsXHJcbiAgICAgICAgICAgICAgICBkb2M6IGRvYyxcclxuICAgICAgICAgICAgICAgIG9sZEluZGV4OiAtMSxcclxuICAgICAgICAgICAgICAgIG5ld0luZGV4OiBpbmRleF8xKytcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIEEgRG9jdW1lbnRTZXQgdGhhdCBpcyB1cGRhdGVkIGluY3JlbWVudGFsbHkgYXMgY2hhbmdlcyBhcmUgYXBwbGllZCB0byB1c2VcclxuICAgICAgICAvLyB0byBsb29rdXAgdGhlIGluZGV4IG9mIGEgZG9jdW1lbnQuXHJcbiAgICAgICAgdmFyIGluZGV4VHJhY2tlcl8xID0gc25hcHNob3Qub2xkRG9jcztcclxuICAgICAgICByZXR1cm4gc25hcHNob3QuZG9jQ2hhbmdlc1xyXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChjaGFuZ2UpIHsgcmV0dXJuIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXMgfHwgY2hhbmdlLnR5cGUgIT09IENoYW5nZVR5cGUuTWV0YWRhdGE7IH0pXHJcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGNoYW5nZSkge1xyXG4gICAgICAgICAgICB2YXIgZG9jID0gbmV3IFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdChmaXJlc3RvcmUsIGNoYW5nZS5kb2Mua2V5LCBjaGFuZ2UuZG9jLCBzbmFwc2hvdC5mcm9tQ2FjaGUsIHNuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyhjaGFuZ2UuZG9jLmtleSkpO1xyXG4gICAgICAgICAgICB2YXIgb2xkSW5kZXggPSAtMTtcclxuICAgICAgICAgICAgdmFyIG5ld0luZGV4ID0gLTE7XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2UudHlwZSAhPT0gQ2hhbmdlVHlwZS5BZGRlZCkge1xyXG4gICAgICAgICAgICAgICAgb2xkSW5kZXggPSBpbmRleFRyYWNrZXJfMS5pbmRleE9mKGNoYW5nZS5kb2Mua2V5KTtcclxuICAgICAgICAgICAgICAgIGFzc2VydChvbGRJbmRleCA+PSAwLCAnSW5kZXggZm9yIGRvY3VtZW50IG5vdCBmb3VuZCcpO1xyXG4gICAgICAgICAgICAgICAgaW5kZXhUcmFja2VyXzEgPSBpbmRleFRyYWNrZXJfMS5kZWxldGUoY2hhbmdlLmRvYy5rZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2UudHlwZSAhPT0gQ2hhbmdlVHlwZS5SZW1vdmVkKSB7XHJcbiAgICAgICAgICAgICAgICBpbmRleFRyYWNrZXJfMSA9IGluZGV4VHJhY2tlcl8xLmFkZChjaGFuZ2UuZG9jKTtcclxuICAgICAgICAgICAgICAgIG5ld0luZGV4ID0gaW5kZXhUcmFja2VyXzEuaW5kZXhPZihjaGFuZ2UuZG9jLmtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogcmVzdWx0Q2hhbmdlVHlwZShjaGFuZ2UudHlwZSksIGRvYzogZG9jLCBvbGRJbmRleDogb2xkSW5kZXgsIG5ld0luZGV4OiBuZXdJbmRleCB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlc3VsdENoYW5nZVR5cGUodHlwZSkge1xyXG4gICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLkFkZGVkOlxyXG4gICAgICAgICAgICByZXR1cm4gJ2FkZGVkJztcclxuICAgICAgICBjYXNlIENoYW5nZVR5cGUuTW9kaWZpZWQ6XHJcbiAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLk1ldGFkYXRhOlxyXG4gICAgICAgICAgICByZXR1cm4gJ21vZGlmaWVkJztcclxuICAgICAgICBjYXNlIENoYW5nZVR5cGUuUmVtb3ZlZDpcclxuICAgICAgICAgICAgcmV0dXJuICdyZW1vdmVkJztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBjaGFuZ2UgdHlwZTogJyArIHR5cGUpO1xyXG4gICAgfVxyXG59XHJcbi8vIEV4cG9ydCB0aGUgY2xhc3NlcyB3aXRoIGEgcHJpdmF0ZSBjb25zdHJ1Y3RvciAoaXQgd2lsbCBmYWlsIGlmIGludm9rZWRcclxuLy8gYXQgcnVudGltZSkuIE5vdGUgdGhhdCB0aGlzIHN0aWxsIGFsbG93cyBpbnN0YW5jZW9mIGNoZWNrcy5cclxuLy8gV2UncmUgdHJlYXRpbmcgdGhlIHZhcmlhYmxlcyBhcyBjbGFzcyBuYW1lcywgc28gZGlzYWJsZSBjaGVja2luZyBmb3IgbG93ZXJcclxuLy8gY2FzZSB2YXJpYWJsZSBuYW1lcy5cclxuLy8gdHNsaW50OmRpc2FibGU6dmFyaWFibGUtbmFtZVxyXG52YXIgUHVibGljRmlyZXN0b3JlID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShGaXJlc3RvcmUsICdVc2UgZmlyZWJhc2UuZmlyZXN0b3JlKCkgaW5zdGVhZC4nKTtcclxudmFyIFB1YmxpY1RyYW5zYWN0aW9uID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShUcmFuc2FjdGlvbiQxLCAnVXNlIGZpcmViYXNlLmZpcmVzdG9yZSgpLnJ1blRyYW5zYWN0aW9uKCkgaW5zdGVhZC4nKTtcclxudmFyIFB1YmxpY1dyaXRlQmF0Y2ggPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKFdyaXRlQmF0Y2gsICdVc2UgZmlyZWJhc2UuZmlyZXN0b3JlKCkuYmF0Y2goKSBpbnN0ZWFkLicpO1xyXG52YXIgUHVibGljRG9jdW1lbnRSZWZlcmVuY2UgPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKERvY3VtZW50UmVmZXJlbmNlLCAnVXNlIGZpcmViYXNlLmZpcmVzdG9yZSgpLmRvYygpIGluc3RlYWQuJyk7XHJcbnZhciBQdWJsaWNEb2N1bWVudFNuYXBzaG90ID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShEb2N1bWVudFNuYXBzaG90KTtcclxudmFyIFB1YmxpY1F1ZXJ5RG9jdW1lbnRTbmFwc2hvdCA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoUXVlcnlEb2N1bWVudFNuYXBzaG90KTtcclxudmFyIFB1YmxpY1F1ZXJ5ID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShRdWVyeSQxKTtcclxudmFyIFB1YmxpY1F1ZXJ5U25hcHNob3QgPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKFF1ZXJ5U25hcHNob3QpO1xyXG52YXIgUHVibGljQ29sbGVjdGlvblJlZmVyZW5jZSA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoQ29sbGVjdGlvblJlZmVyZW5jZSwgJ1VzZSBmaXJlYmFzZS5maXJlc3RvcmUoKS5jb2xsZWN0aW9uKCkgaW5zdGVhZC4nKTtcclxuLy8gdHNsaW50OmVuYWJsZTp2YXJpYWJsZS1uYW1lXG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgZmlyZXN0b3JlTmFtZXNwYWNlID0ge1xyXG4gICAgRmlyZXN0b3JlOiBQdWJsaWNGaXJlc3RvcmUsXHJcbiAgICBHZW9Qb2ludDogR2VvUG9pbnQsXHJcbiAgICBUaW1lc3RhbXA6IFRpbWVzdGFtcCxcclxuICAgIEJsb2I6IFB1YmxpY0Jsb2IsXHJcbiAgICBUcmFuc2FjdGlvbjogUHVibGljVHJhbnNhY3Rpb24sXHJcbiAgICBXcml0ZUJhdGNoOiBQdWJsaWNXcml0ZUJhdGNoLFxyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2U6IFB1YmxpY0RvY3VtZW50UmVmZXJlbmNlLFxyXG4gICAgRG9jdW1lbnRTbmFwc2hvdDogUHVibGljRG9jdW1lbnRTbmFwc2hvdCxcclxuICAgIFF1ZXJ5OiBQdWJsaWNRdWVyeSxcclxuICAgIFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdDogUHVibGljUXVlcnlEb2N1bWVudFNuYXBzaG90LFxyXG4gICAgUXVlcnlTbmFwc2hvdDogUHVibGljUXVlcnlTbmFwc2hvdCxcclxuICAgIENvbGxlY3Rpb25SZWZlcmVuY2U6IFB1YmxpY0NvbGxlY3Rpb25SZWZlcmVuY2UsXHJcbiAgICBGaWVsZFBhdGg6IEZpZWxkUGF0aCQxLFxyXG4gICAgRmllbGRWYWx1ZTogUHVibGljRmllbGRWYWx1ZSxcclxuICAgIHNldExvZ0xldmVsOiBGaXJlc3RvcmUuc2V0TG9nTGV2ZWxcclxufTtcclxuLyoqXHJcbiAqIENvbmZpZ3VyZXMgRmlyZXN0b3JlIGFzIHBhcnQgb2YgdGhlIEZpcmViYXNlIFNESyBieSBjYWxsaW5nIHJlZ2lzdGVyU2VydmljZS5cclxuICovXHJcbmZ1bmN0aW9uIGNvbmZpZ3VyZUZvckZpcmViYXNlKGZpcmViYXNlJCQxKSB7XHJcbiAgICBmaXJlYmFzZSQkMS5JTlRFUk5BTC5yZWdpc3RlclNlcnZpY2UoJ2ZpcmVzdG9yZScsIGZ1bmN0aW9uIChhcHApIHsgcmV0dXJuIG5ldyBGaXJlc3RvcmUoYXBwKTsgfSwgc2hhbGxvd0NvcHkoZmlyZXN0b3JlTmFtZXNwYWNlKSk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIHJlZ2lzdGVyRmlyZXN0b3JlKGluc3RhbmNlKSB7XHJcbiAgICBjb25maWd1cmVGb3JGaXJlYmFzZShpbnN0YW5jZSk7XHJcbn1cclxucmVnaXN0ZXJGaXJlc3RvcmUoZmlyZWJhc2UpO1xuXG5leHBvcnRzLnJlZ2lzdGVyRmlyZXN0b3JlID0gcmVnaXN0ZXJGaXJlc3RvcmU7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vQGZpcmViYXNlL2ZpcmVzdG9yZS9kaXN0L2luZGV4LmNqcy5qc1xuLy8gbW9kdWxlIGlkID0gMzVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBIGNvbnRhaW5lciBmb3IgYWxsIG9mIHRoZSBMb2dnZXIgaW5zdGFuY2VzXHJcbiAqL1xyXG52YXIgaW5zdGFuY2VzID0gW107XHJcbi8qKlxyXG4gKiBUaGUgSlMgU0RLIHN1cHBvcnRzIDUgbG9nIGxldmVscyBhbmQgYWxzbyBhbGxvd3MgYSB1c2VyIHRoZSBhYmlsaXR5IHRvXHJcbiAqIHNpbGVuY2UgdGhlIGxvZ3MgYWx0b2dldGhlci5cclxuICpcclxuICogVGhlIG9yZGVyIGlzIGEgZm9sbG93czpcclxuICogREVCVUcgPCBWRVJCT1NFIDwgSU5GTyA8IFdBUk4gPCBFUlJPUlxyXG4gKlxyXG4gKiBBbGwgb2YgdGhlIGxvZyB0eXBlcyBhYm92ZSB0aGUgY3VycmVudCBsb2cgbGV2ZWwgd2lsbCBiZSBjYXB0dXJlZCAoaS5lLiBpZlxyXG4gKiB5b3Ugc2V0IHRoZSBsb2cgbGV2ZWwgdG8gYElORk9gLCBlcnJvcnMgd2lsbCBzdGlsbCBiZSBsb2dnZWQsIGJ1dCBgREVCVUdgIGFuZFxyXG4gKiBgVkVSQk9TRWAgbG9ncyB3aWxsIG5vdClcclxuICovXHJcbnZhciBMb2dMZXZlbDtcclxuKGZ1bmN0aW9uIChMb2dMZXZlbCkge1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJERUJVR1wiXSA9IDBdID0gXCJERUJVR1wiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJWRVJCT1NFXCJdID0gMV0gPSBcIlZFUkJPU0VcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiSU5GT1wiXSA9IDJdID0gXCJJTkZPXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIldBUk5cIl0gPSAzXSA9IFwiV0FSTlwiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJFUlJPUlwiXSA9IDRdID0gXCJFUlJPUlwiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJTSUxFTlRcIl0gPSA1XSA9IFwiU0lMRU5UXCI7XHJcbn0pKExvZ0xldmVsIHx8IChMb2dMZXZlbCA9IHt9KSk7XHJcbi8qKlxyXG4gKiBUaGUgZGVmYXVsdCBsb2cgbGV2ZWxcclxuICovXHJcbnZhciBkZWZhdWx0TG9nTGV2ZWwgPSBMb2dMZXZlbC5JTkZPO1xyXG4vKipcclxuICogVGhlIGRlZmF1bHQgbG9nIGhhbmRsZXIgd2lsbCBmb3J3YXJkIERFQlVHLCBWRVJCT1NFLCBJTkZPLCBXQVJOLCBhbmQgRVJST1JcclxuICogbWVzc2FnZXMgb24gdG8gdGhlaXIgY29ycmVzcG9uZGluZyBjb25zb2xlIGNvdW50ZXJwYXJ0cyAoaWYgdGhlIGxvZyBtZXRob2RcclxuICogaXMgc3VwcG9ydGVkIGJ5IHRoZSBjdXJyZW50IGxvZyBsZXZlbClcclxuICovXHJcbnZhciBkZWZhdWx0TG9nSGFuZGxlciA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgbG9nVHlwZSkge1xyXG4gICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIGlmIChsb2dUeXBlIDwgaW5zdGFuY2UubG9nTGV2ZWwpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgdmFyIG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxuICAgIHN3aXRjaCAobG9nVHlwZSkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEJ5IGRlZmF1bHQsIGBjb25zb2xlLmRlYnVnYCBpcyBub3QgZGlzcGxheWVkIGluIHRoZSBkZXZlbG9wZXIgY29uc29sZSAoaW5cclxuICAgICAgICAgKiBjaHJvbWUpLiBUbyBhdm9pZCBmb3JjaW5nIHVzZXJzIHRvIGhhdmUgdG8gb3B0LWluIHRvIHRoZXNlIGxvZ3MgdHdpY2VcclxuICAgICAgICAgKiAoaS5lLiBvbmNlIGZvciBmaXJlYmFzZSwgYW5kIG9uY2UgaW4gdGhlIGNvbnNvbGUpLCB3ZSBhcmUgc2VuZGluZyBgREVCVUdgXHJcbiAgICAgICAgICogbG9ncyB0byB0aGUgYGNvbnNvbGUubG9nYCBmdW5jdGlvbi5cclxuICAgICAgICAgKi9cclxuICAgICAgICBjYXNlIExvZ0xldmVsLkRFQlVHOlxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBbXCJbXCIgKyBub3cgKyBcIl0gIFwiICsgaW5zdGFuY2UubmFtZSArIFwiOlwiXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIExvZ0xldmVsLlZFUkJPU0U6XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIFtcIltcIiArIG5vdyArIFwiXSAgXCIgKyBpbnN0YW5jZS5uYW1lICsgXCI6XCJdLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgTG9nTGV2ZWwuSU5GTzpcclxuICAgICAgICAgICAgY29uc29sZS5pbmZvLmFwcGx5KGNvbnNvbGUsIFtcIltcIiArIG5vdyArIFwiXSAgXCIgKyBpbnN0YW5jZS5uYW1lICsgXCI6XCJdLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgTG9nTGV2ZWwuV0FSTjpcclxuICAgICAgICAgICAgY29uc29sZS53YXJuLmFwcGx5KGNvbnNvbGUsIFtcIltcIiArIG5vdyArIFwiXSAgXCIgKyBpbnN0YW5jZS5uYW1lICsgXCI6XCJdLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgTG9nTGV2ZWwuRVJST1I6XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IuYXBwbHkoY29uc29sZSwgW1wiW1wiICsgbm93ICsgXCJdICBcIiArIGluc3RhbmNlLm5hbWUgKyBcIjpcIl0uY29uY2F0KGFyZ3MpKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGxvZyBhIG1lc3NhZ2Ugd2l0aCBhbiBpbnZhbGlkIGxvZ1R5cGUgKHZhbHVlOiBcIiArIGxvZ1R5cGUgKyBcIilcIik7XHJcbiAgICB9XHJcbn07XHJcbnZhciBMb2dnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIEdpdmVzIHlvdSBhbiBpbnN0YW5jZSBvZiBhIExvZ2dlciB0byBjYXB0dXJlIG1lc3NhZ2VzIGFjY29yZGluZyB0b1xyXG4gICAgICogRmlyZWJhc2UncyBsb2dnaW5nIHNjaGVtZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBUaGUgbmFtZSB0aGF0IHRoZSBsb2dzIHdpbGwgYmUgYXNzb2NpYXRlZCB3aXRoXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIExvZ2dlcihuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgbG9nIGxldmVsIG9mIHRoZSBnaXZlbiBMb2dnZXIgaW5zdGFuY2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSBkZWZhdWx0TG9nTGV2ZWw7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGxvZyBoYW5kbGVyIGZvciB0aGUgTG9nZ2VyIGluc3RhbmNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIgPSBkZWZhdWx0TG9nSGFuZGxlcjtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDYXB0dXJlIHRoZSBjdXJyZW50IGluc3RhbmNlIGZvciBsYXRlciB1c2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbnN0YW5jZXMucHVzaCh0aGlzKTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMb2dnZXIucHJvdG90eXBlLCBcImxvZ0xldmVsXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvZ0xldmVsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgIGlmICghKHZhbCBpbiBMb2dMZXZlbCkpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgdmFsdWUgYXNzaWduZWQgdG8gYGxvZ0xldmVsYCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2xvZ0xldmVsID0gdmFsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExvZ2dlci5wcm90b3R5cGUsIFwibG9nSGFuZGxlclwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2dIYW5kbGVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdWYWx1ZSBhc3NpZ25lZCB0byBgbG9nSGFuZGxlcmAgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbG9nSGFuZGxlciA9IHZhbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGZ1bmN0aW9ucyBiZWxvdyBhcmUgYWxsIGJhc2VkIG9uIHRoZSBgY29uc29sZWAgaW50ZXJmYWNlXHJcbiAgICAgKi9cclxuICAgIExvZ2dlci5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIuYXBwbHkodGhpcywgW3RoaXMsIExvZ0xldmVsLkRFQlVHXS5jb25jYXQoYXJncykpO1xyXG4gICAgfTtcclxuICAgIExvZ2dlci5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyLmFwcGx5KHRoaXMsIFt0aGlzLCBMb2dMZXZlbC5WRVJCT1NFXS5jb25jYXQoYXJncykpO1xyXG4gICAgfTtcclxuICAgIExvZ2dlci5wcm90b3R5cGUuaW5mbyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBbdGhpcywgTG9nTGV2ZWwuSU5GT10uY29uY2F0KGFyZ3MpKTtcclxuICAgIH07XHJcbiAgICBMb2dnZXIucHJvdG90eXBlLndhcm4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIuYXBwbHkodGhpcywgW3RoaXMsIExvZ0xldmVsLldBUk5dLmNvbmNhdChhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgTG9nZ2VyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBbdGhpcywgTG9nTGV2ZWwuRVJST1JdLmNvbmNhdChhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExvZ2dlcjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIHNldExvZ0xldmVsKGxldmVsKSB7XHJcbiAgICBpbnN0YW5jZXMuZm9yRWFjaChmdW5jdGlvbiAoaW5zdCkge1xyXG4gICAgICAgIGluc3QubG9nTGV2ZWwgPSBsZXZlbDtcclxuICAgIH0pO1xyXG59XG5cbmV4cG9ydCB7IHNldExvZ0xldmVsLCBMb2dnZXIsIExvZ0xldmVsIH07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vQGZpcmViYXNlL2xvZ2dlci9kaXN0L2luZGV4LmVzbS5qc1xuLy8gbW9kdWxlIGlkID0gMzZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICd3aGF0d2ctZmV0Y2gnO1xuXG4vLyBTdG9yZSBzZXRUaW1lb3V0IHJlZmVyZW5jZSBzbyBwcm9taXNlLXBvbHlmaWxsIHdpbGwgYmUgdW5hZmZlY3RlZCBieVxuLy8gb3RoZXIgY29kZSBtb2RpZnlpbmcgc2V0VGltZW91dCAobGlrZSBzaW5vbi51c2VGYWtlVGltZXJzKCkpXG52YXIgc2V0VGltZW91dEZ1bmMgPSBzZXRUaW1lb3V0O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxuLy8gUG9seWZpbGwgZm9yIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kXG5mdW5jdGlvbiBiaW5kKGZuLCB0aGlzQXJnKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICBmbi5hcHBseSh0aGlzQXJnLCBhcmd1bWVudHMpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBQcm9taXNlKGZuKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQcm9taXNlcyBtdXN0IGJlIGNvbnN0cnVjdGVkIHZpYSBuZXcnKTtcbiAgaWYgKHR5cGVvZiBmbiAhPT0gJ2Z1bmN0aW9uJykgdGhyb3cgbmV3IFR5cGVFcnJvcignbm90IGEgZnVuY3Rpb24nKTtcbiAgdGhpcy5fc3RhdGUgPSAwO1xuICB0aGlzLl9oYW5kbGVkID0gZmFsc2U7XG4gIHRoaXMuX3ZhbHVlID0gdW5kZWZpbmVkO1xuICB0aGlzLl9kZWZlcnJlZHMgPSBbXTtcblxuICBkb1Jlc29sdmUoZm4sIHRoaXMpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGUoc2VsZiwgZGVmZXJyZWQpIHtcbiAgd2hpbGUgKHNlbGYuX3N0YXRlID09PSAzKSB7XG4gICAgc2VsZiA9IHNlbGYuX3ZhbHVlO1xuICB9XG4gIGlmIChzZWxmLl9zdGF0ZSA9PT0gMCkge1xuICAgIHNlbGYuX2RlZmVycmVkcy5wdXNoKGRlZmVycmVkKTtcbiAgICByZXR1cm47XG4gIH1cbiAgc2VsZi5faGFuZGxlZCA9IHRydWU7XG4gIFByb21pc2UuX2ltbWVkaWF0ZUZuKGZ1bmN0aW9uKCkge1xuICAgIHZhciBjYiA9IHNlbGYuX3N0YXRlID09PSAxID8gZGVmZXJyZWQub25GdWxmaWxsZWQgOiBkZWZlcnJlZC5vblJlamVjdGVkO1xuICAgIGlmIChjYiA9PT0gbnVsbCkge1xuICAgICAgKHNlbGYuX3N0YXRlID09PSAxID8gcmVzb2x2ZSA6IHJlamVjdCkoZGVmZXJyZWQucHJvbWlzZSwgc2VsZi5fdmFsdWUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgcmV0O1xuICAgIHRyeSB7XG4gICAgICByZXQgPSBjYihzZWxmLl92YWx1ZSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmVqZWN0KGRlZmVycmVkLnByb21pc2UsIGUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXNvbHZlKGRlZmVycmVkLnByb21pc2UsIHJldCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiByZXNvbHZlKHNlbGYsIG5ld1ZhbHVlKSB7XG4gIHRyeSB7XG4gICAgLy8gUHJvbWlzZSBSZXNvbHV0aW9uIFByb2NlZHVyZTogaHR0cHM6Ly9naXRodWIuY29tL3Byb21pc2VzLWFwbHVzL3Byb21pc2VzLXNwZWMjdGhlLXByb21pc2UtcmVzb2x1dGlvbi1wcm9jZWR1cmVcbiAgICBpZiAobmV3VmFsdWUgPT09IHNlbGYpXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBIHByb21pc2UgY2Fubm90IGJlIHJlc29sdmVkIHdpdGggaXRzZWxmLicpO1xuICAgIGlmIChcbiAgICAgIG5ld1ZhbHVlICYmXG4gICAgICAodHlwZW9mIG5ld1ZhbHVlID09PSAnb2JqZWN0JyB8fCB0eXBlb2YgbmV3VmFsdWUgPT09ICdmdW5jdGlvbicpXG4gICAgKSB7XG4gICAgICB2YXIgdGhlbiA9IG5ld1ZhbHVlLnRoZW47XG4gICAgICBpZiAobmV3VmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHNlbGYuX3N0YXRlID0gMztcbiAgICAgICAgc2VsZi5fdmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgZmluYWxlKHNlbGYpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGRvUmVzb2x2ZShiaW5kKHRoZW4sIG5ld1ZhbHVlKSwgc2VsZik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgc2VsZi5fc3RhdGUgPSAxO1xuICAgIHNlbGYuX3ZhbHVlID0gbmV3VmFsdWU7XG4gICAgZmluYWxlKHNlbGYpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmVqZWN0KHNlbGYsIGUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlamVjdChzZWxmLCBuZXdWYWx1ZSkge1xuICBzZWxmLl9zdGF0ZSA9IDI7XG4gIHNlbGYuX3ZhbHVlID0gbmV3VmFsdWU7XG4gIGZpbmFsZShzZWxmKTtcbn1cblxuZnVuY3Rpb24gZmluYWxlKHNlbGYpIHtcbiAgaWYgKHNlbGYuX3N0YXRlID09PSAyICYmIHNlbGYuX2RlZmVycmVkcy5sZW5ndGggPT09IDApIHtcbiAgICBQcm9taXNlLl9pbW1lZGlhdGVGbihmdW5jdGlvbigpIHtcbiAgICAgIGlmICghc2VsZi5faGFuZGxlZCkge1xuICAgICAgICBQcm9taXNlLl91bmhhbmRsZWRSZWplY3Rpb25GbihzZWxmLl92YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmb3IgKHZhciBpID0gMCwgbGVuID0gc2VsZi5fZGVmZXJyZWRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgaGFuZGxlKHNlbGYsIHNlbGYuX2RlZmVycmVkc1tpXSk7XG4gIH1cbiAgc2VsZi5fZGVmZXJyZWRzID0gbnVsbDtcbn1cblxuZnVuY3Rpb24gSGFuZGxlcihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgcHJvbWlzZSkge1xuICB0aGlzLm9uRnVsZmlsbGVkID0gdHlwZW9mIG9uRnVsZmlsbGVkID09PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiBudWxsO1xuICB0aGlzLm9uUmVqZWN0ZWQgPSB0eXBlb2Ygb25SZWplY3RlZCA9PT0gJ2Z1bmN0aW9uJyA/IG9uUmVqZWN0ZWQgOiBudWxsO1xuICB0aGlzLnByb21pc2UgPSBwcm9taXNlO1xufVxuXG4vKipcbiAqIFRha2UgYSBwb3RlbnRpYWxseSBtaXNiZWhhdmluZyByZXNvbHZlciBmdW5jdGlvbiBhbmQgbWFrZSBzdXJlXG4gKiBvbkZ1bGZpbGxlZCBhbmQgb25SZWplY3RlZCBhcmUgb25seSBjYWxsZWQgb25jZS5cbiAqXG4gKiBNYWtlcyBubyBndWFyYW50ZWVzIGFib3V0IGFzeW5jaHJvbnkuXG4gKi9cbmZ1bmN0aW9uIGRvUmVzb2x2ZShmbiwgc2VsZikge1xuICB2YXIgZG9uZSA9IGZhbHNlO1xuICB0cnkge1xuICAgIGZuKFxuICAgICAgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKGRvbmUpIHJldHVybjtcbiAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgIHJlc29sdmUoc2VsZiwgdmFsdWUpO1xuICAgICAgfSxcbiAgICAgIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICBpZiAoZG9uZSkgcmV0dXJuO1xuICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgcmVqZWN0KHNlbGYsIHJlYXNvbik7XG4gICAgICB9XG4gICAgKTtcbiAgfSBjYXRjaCAoZXgpIHtcbiAgICBpZiAoZG9uZSkgcmV0dXJuO1xuICAgIGRvbmUgPSB0cnVlO1xuICAgIHJlamVjdChzZWxmLCBleCk7XG4gIH1cbn1cblxuUHJvbWlzZS5wcm90b3R5cGVbJ2NhdGNoJ10gPSBmdW5jdGlvbihvblJlamVjdGVkKSB7XG4gIHJldHVybiB0aGlzLnRoZW4obnVsbCwgb25SZWplY3RlZCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcbiAgdmFyIHByb20gPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvcihub29wKTtcblxuICBoYW5kbGUodGhpcywgbmV3IEhhbmRsZXIob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQsIHByb20pKTtcbiAgcmV0dXJuIHByb207XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZVsnZmluYWxseSddID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgdmFyIGNvbnN0cnVjdG9yID0gdGhpcy5jb25zdHJ1Y3RvcjtcbiAgcmV0dXJuIHRoaXMudGhlbihcbiAgICBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci5yZXNvbHZlKGNhbGxiYWNrKCkpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci5yZWplY3QocmVhc29uKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgKTtcbn07XG5cblByb21pc2UuYWxsID0gZnVuY3Rpb24oYXJyKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICBpZiAoIWFyciB8fCB0eXBlb2YgYXJyLmxlbmd0aCA9PT0gJ3VuZGVmaW5lZCcpXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQcm9taXNlLmFsbCBhY2NlcHRzIGFuIGFycmF5Jyk7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xuICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHJlc29sdmUoW10pO1xuICAgIHZhciByZW1haW5pbmcgPSBhcmdzLmxlbmd0aDtcblxuICAgIGZ1bmN0aW9uIHJlcyhpLCB2YWwpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICh2YWwgJiYgKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnIHx8IHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbicpKSB7XG4gICAgICAgICAgdmFyIHRoZW4gPSB2YWwudGhlbjtcbiAgICAgICAgICBpZiAodHlwZW9mIHRoZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoZW4uY2FsbChcbiAgICAgICAgICAgICAgdmFsLFxuICAgICAgICAgICAgICBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICAgICAgICByZXMoaSwgdmFsKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcmVqZWN0XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhcmdzW2ldID0gdmFsO1xuICAgICAgICBpZiAoLS1yZW1haW5pbmcgPT09IDApIHtcbiAgICAgICAgICByZXNvbHZlKGFyZ3MpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChleCkge1xuICAgICAgICByZWplY3QoZXgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgcmVzKGksIGFyZ3NbaV0pO1xuICAgIH1cbiAgfSk7XG59O1xuXG5Qcm9taXNlLnJlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZS5jb25zdHJ1Y3RvciA9PT0gUHJvbWlzZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgcmVzb2x2ZSh2YWx1ZSk7XG4gIH0pO1xufTtcblxuUHJvbWlzZS5yZWplY3QgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgcmVqZWN0KHZhbHVlKTtcbiAgfSk7XG59O1xuXG5Qcm9taXNlLnJhY2UgPSBmdW5jdGlvbih2YWx1ZXMpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB2YWx1ZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHZhbHVlc1tpXS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgfVxuICB9KTtcbn07XG5cbi8vIFVzZSBwb2x5ZmlsbCBmb3Igc2V0SW1tZWRpYXRlIGZvciBwZXJmb3JtYW5jZSBnYWluc1xuUHJvbWlzZS5faW1tZWRpYXRlRm4gPVxuICAodHlwZW9mIHNldEltbWVkaWF0ZSA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgIGZ1bmN0aW9uKGZuKSB7XG4gICAgICBzZXRJbW1lZGlhdGUoZm4pO1xuICAgIH0pIHx8XG4gIGZ1bmN0aW9uKGZuKSB7XG4gICAgc2V0VGltZW91dEZ1bmMoZm4sIDApO1xuICB9O1xuXG5Qcm9taXNlLl91bmhhbmRsZWRSZWplY3Rpb25GbiA9IGZ1bmN0aW9uIF91bmhhbmRsZWRSZWplY3Rpb25GbihlcnIpIHtcbiAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlKSB7XG4gICAgY29uc29sZS53YXJuKCdQb3NzaWJsZSBVbmhhbmRsZWQgUHJvbWlzZSBSZWplY3Rpb246JywgZXJyKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gIH1cbn07XG5cbnZhciBnbG9iYWxOUyA9IChmdW5jdGlvbigpIHtcbiAgLy8gdGhlIG9ubHkgcmVsaWFibGUgbWVhbnMgdG8gZ2V0IHRoZSBnbG9iYWwgb2JqZWN0IGlzXG4gIC8vIGBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpYFxuICAvLyBIb3dldmVyLCB0aGlzIGNhdXNlcyBDU1AgdmlvbGF0aW9ucyBpbiBDaHJvbWUgYXBwcy5cbiAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBzZWxmO1xuICB9XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiB3aW5kb3c7XG4gIH1cbiAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIGdsb2JhbDtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoJ3VuYWJsZSB0byBsb2NhdGUgZ2xvYmFsIG9iamVjdCcpO1xufSkoKTtcblxuaWYgKCFnbG9iYWxOUy5Qcm9taXNlKSB7XG4gIGdsb2JhbE5TLlByb21pc2UgPSBQcm9taXNlO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDb21tb25qc01vZHVsZShmbiwgbW9kdWxlKSB7XG5cdHJldHVybiBtb2R1bGUgPSB7IGV4cG9ydHM6IHt9IH0sIGZuKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMpLCBtb2R1bGUuZXhwb3J0cztcbn1cblxudmFyIF9nbG9iYWwgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7XG4vLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOFxudmFyIGdsb2JhbCA9IG1vZHVsZS5leHBvcnRzID0gdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoXG4gID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1uZXctZnVuY1xuICA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5pZiAodHlwZW9mIF9fZyA9PSAnbnVtYmVyJykgX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG59KTtcblxudmFyIF9jb3JlID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkge1xudmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHsgdmVyc2lvbjogJzIuNS41JyB9O1xuaWYgKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpIF9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbn0pO1xudmFyIF9jb3JlXzEgPSBfY29yZS52ZXJzaW9uO1xuXG52YXIgX2lzT2JqZWN0ID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiB0eXBlb2YgaXQgPT09ICdvYmplY3QnID8gaXQgIT09IG51bGwgOiB0eXBlb2YgaXQgPT09ICdmdW5jdGlvbic7XG59O1xuXG52YXIgX2FuT2JqZWN0ID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmICghX2lzT2JqZWN0KGl0KSkgdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYW4gb2JqZWN0IScpO1xuICByZXR1cm4gaXQ7XG59O1xuXG52YXIgX2ZhaWxzID0gZnVuY3Rpb24gKGV4ZWMpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gISFleGVjKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufTtcblxuLy8gVGhhbmsncyBJRTggZm9yIGhpcyBmdW5ueSBkZWZpbmVQcm9wZXJ0eVxudmFyIF9kZXNjcmlwdG9ycyA9ICFfZmFpbHMoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiA3OyB9IH0pLmEgIT0gNztcbn0pO1xuXG52YXIgZG9jdW1lbnQgPSBfZ2xvYmFsLmRvY3VtZW50O1xuLy8gdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgaXMgJ29iamVjdCcgaW4gb2xkIElFXG52YXIgaXMgPSBfaXNPYmplY3QoZG9jdW1lbnQpICYmIF9pc09iamVjdChkb2N1bWVudC5jcmVhdGVFbGVtZW50KTtcbnZhciBfZG9tQ3JlYXRlID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307XG59O1xuXG52YXIgX2llOERvbURlZmluZSA9ICFfZGVzY3JpcHRvcnMgJiYgIV9mYWlscyhmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoX2RvbUNyZWF0ZSgnZGl2JyksICdhJywgeyBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDc7IH0gfSkuYSAhPSA3O1xufSk7XG5cbi8vIDcuMS4xIFRvUHJpbWl0aXZlKGlucHV0IFssIFByZWZlcnJlZFR5cGVdKVxuXG4vLyBpbnN0ZWFkIG9mIHRoZSBFUzYgc3BlYyB2ZXJzaW9uLCB3ZSBkaWRuJ3QgaW1wbGVtZW50IEBAdG9QcmltaXRpdmUgY2FzZVxuLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmdcbnZhciBfdG9QcmltaXRpdmUgPSBmdW5jdGlvbiAoaXQsIFMpIHtcbiAgaWYgKCFfaXNPYmplY3QoaXQpKSByZXR1cm4gaXQ7XG4gIHZhciBmbiwgdmFsO1xuICBpZiAoUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIV9pc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIGlmICh0eXBlb2YgKGZuID0gaXQudmFsdWVPZikgPT0gJ2Z1bmN0aW9uJyAmJiAhX2lzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSkgcmV0dXJuIHZhbDtcbiAgaWYgKCFTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhX2lzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSkgcmV0dXJuIHZhbDtcbiAgdGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlXCIpO1xufTtcblxudmFyIGRQID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXG52YXIgZiA9IF9kZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpIHtcbiAgX2FuT2JqZWN0KE8pO1xuICBQID0gX3RvUHJpbWl0aXZlKFAsIHRydWUpO1xuICBfYW5PYmplY3QoQXR0cmlidXRlcyk7XG4gIGlmIChfaWU4RG9tRGVmaW5lKSB0cnkge1xuICAgIHJldHVybiBkUChPLCBQLCBBdHRyaWJ1dGVzKTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG4gIGlmICgnZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpIHRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7XG4gIGlmICgndmFsdWUnIGluIEF0dHJpYnV0ZXMpIE9bUF0gPSBBdHRyaWJ1dGVzLnZhbHVlO1xuICByZXR1cm4gTztcbn07XG5cbnZhciBfb2JqZWN0RHAgPSB7XG5cdGY6IGZcbn07XG5cbnZhciBfcHJvcGVydHlEZXNjID0gZnVuY3Rpb24gKGJpdG1hcCwgdmFsdWUpIHtcbiAgcmV0dXJuIHtcbiAgICBlbnVtZXJhYmxlOiAhKGJpdG1hcCAmIDEpLFxuICAgIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSxcbiAgICB3cml0YWJsZTogIShiaXRtYXAgJiA0KSxcbiAgICB2YWx1ZTogdmFsdWVcbiAgfTtcbn07XG5cbnZhciBfaGlkZSA9IF9kZXNjcmlwdG9ycyA/IGZ1bmN0aW9uIChvYmplY3QsIGtleSwgdmFsdWUpIHtcbiAgcmV0dXJuIF9vYmplY3REcC5mKG9iamVjdCwga2V5LCBfcHJvcGVydHlEZXNjKDEsIHZhbHVlKSk7XG59IDogZnVuY3Rpb24gKG9iamVjdCwga2V5LCB2YWx1ZSkge1xuICBvYmplY3Rba2V5XSA9IHZhbHVlO1xuICByZXR1cm4gb2JqZWN0O1xufTtcblxudmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7XG52YXIgX2hhcyA9IGZ1bmN0aW9uIChpdCwga2V5KSB7XG4gIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpO1xufTtcblxudmFyIGlkID0gMDtcbnZhciBweCA9IE1hdGgucmFuZG9tKCk7XG52YXIgX3VpZCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTtcbn07XG5cbnZhciBfcmVkZWZpbmUgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7XG52YXIgU1JDID0gX3VpZCgnc3JjJyk7XG52YXIgVE9fU1RSSU5HID0gJ3RvU3RyaW5nJztcbnZhciAkdG9TdHJpbmcgPSBGdW5jdGlvbltUT19TVFJJTkddO1xudmFyIFRQTCA9ICgnJyArICR0b1N0cmluZykuc3BsaXQoVE9fU1RSSU5HKTtcblxuX2NvcmUuaW5zcGVjdFNvdXJjZSA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gJHRvU3RyaW5nLmNhbGwoaXQpO1xufTtcblxuKG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKE8sIGtleSwgdmFsLCBzYWZlKSB7XG4gIHZhciBpc0Z1bmN0aW9uID0gdHlwZW9mIHZhbCA9PSAnZnVuY3Rpb24nO1xuICBpZiAoaXNGdW5jdGlvbikgX2hhcyh2YWwsICduYW1lJykgfHwgX2hpZGUodmFsLCAnbmFtZScsIGtleSk7XG4gIGlmIChPW2tleV0gPT09IHZhbCkgcmV0dXJuO1xuICBpZiAoaXNGdW5jdGlvbikgX2hhcyh2YWwsIFNSQykgfHwgX2hpZGUodmFsLCBTUkMsIE9ba2V5XSA/ICcnICsgT1trZXldIDogVFBMLmpvaW4oU3RyaW5nKGtleSkpKTtcbiAgaWYgKE8gPT09IF9nbG9iYWwpIHtcbiAgICBPW2tleV0gPSB2YWw7XG4gIH0gZWxzZSBpZiAoIXNhZmUpIHtcbiAgICBkZWxldGUgT1trZXldO1xuICAgIF9oaWRlKE8sIGtleSwgdmFsKTtcbiAgfSBlbHNlIGlmIChPW2tleV0pIHtcbiAgICBPW2tleV0gPSB2YWw7XG4gIH0gZWxzZSB7XG4gICAgX2hpZGUoTywga2V5LCB2YWwpO1xuICB9XG4vLyBhZGQgZmFrZSBGdW5jdGlvbiN0b1N0cmluZyBmb3IgY29ycmVjdCB3b3JrIHdyYXBwZWQgbWV0aG9kcyAvIGNvbnN0cnVjdG9ycyB3aXRoIG1ldGhvZHMgbGlrZSBMb0Rhc2ggaXNOYXRpdmVcbn0pKEZ1bmN0aW9uLnByb3RvdHlwZSwgVE9fU1RSSU5HLCBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgcmV0dXJuIHR5cGVvZiB0aGlzID09ICdmdW5jdGlvbicgJiYgdGhpc1tTUkNdIHx8ICR0b1N0cmluZy5jYWxsKHRoaXMpO1xufSk7XG59KTtcblxudmFyIF9hRnVuY3Rpb24gPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKHR5cGVvZiBpdCAhPSAnZnVuY3Rpb24nKSB0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhIGZ1bmN0aW9uIScpO1xuICByZXR1cm4gaXQ7XG59O1xuXG4vLyBvcHRpb25hbCAvIHNpbXBsZSBjb250ZXh0IGJpbmRpbmdcblxudmFyIF9jdHggPSBmdW5jdGlvbiAoZm4sIHRoYXQsIGxlbmd0aCkge1xuICBfYUZ1bmN0aW9uKGZuKTtcbiAgaWYgKHRoYXQgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZuO1xuICBzd2l0Y2ggKGxlbmd0aCkge1xuICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTtcbiAgICB9O1xuICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTtcbiAgICB9O1xuICAgIGNhc2UgMzogcmV0dXJuIGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTtcbiAgICB9O1xuICB9XG4gIHJldHVybiBmdW5jdGlvbiAoLyogLi4uYXJncyAqLykge1xuICAgIHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmd1bWVudHMpO1xuICB9O1xufTtcblxudmFyIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnO1xuXG52YXIgJGV4cG9ydCA9IGZ1bmN0aW9uICh0eXBlLCBuYW1lLCBzb3VyY2UpIHtcbiAgdmFyIElTX0ZPUkNFRCA9IHR5cGUgJiAkZXhwb3J0LkY7XG4gIHZhciBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HO1xuICB2YXIgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUztcbiAgdmFyIElTX1BST1RPID0gdHlwZSAmICRleHBvcnQuUDtcbiAgdmFyIElTX0JJTkQgPSB0eXBlICYgJGV4cG9ydC5CO1xuICB2YXIgdGFyZ2V0ID0gSVNfR0xPQkFMID8gX2dsb2JhbCA6IElTX1NUQVRJQyA/IF9nbG9iYWxbbmFtZV0gfHwgKF9nbG9iYWxbbmFtZV0gPSB7fSkgOiAoX2dsb2JhbFtuYW1lXSB8fCB7fSlbUFJPVE9UWVBFXTtcbiAgdmFyIGV4cG9ydHMgPSBJU19HTE9CQUwgPyBfY29yZSA6IF9jb3JlW25hbWVdIHx8IChfY29yZVtuYW1lXSA9IHt9KTtcbiAgdmFyIGV4cFByb3RvID0gZXhwb3J0c1tQUk9UT1RZUEVdIHx8IChleHBvcnRzW1BST1RPVFlQRV0gPSB7fSk7XG4gIHZhciBrZXksIG93biwgb3V0LCBleHA7XG4gIGlmIChJU19HTE9CQUwpIHNvdXJjZSA9IG5hbWU7XG4gIGZvciAoa2V5IGluIHNvdXJjZSkge1xuICAgIC8vIGNvbnRhaW5zIGluIG5hdGl2ZVxuICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7XG4gICAgLy8gZXhwb3J0IG5hdGl2ZSBvciBwYXNzZWRcbiAgICBvdXQgPSAob3duID8gdGFyZ2V0IDogc291cmNlKVtrZXldO1xuICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0XG4gICAgZXhwID0gSVNfQklORCAmJiBvd24gPyBfY3R4KG91dCwgX2dsb2JhbCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBfY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7XG4gICAgLy8gZXh0ZW5kIGdsb2JhbFxuICAgIGlmICh0YXJnZXQpIF9yZWRlZmluZSh0YXJnZXQsIGtleSwgb3V0LCB0eXBlICYgJGV4cG9ydC5VKTtcbiAgICAvLyBleHBvcnRcbiAgICBpZiAoZXhwb3J0c1trZXldICE9IG91dCkgX2hpZGUoZXhwb3J0cywga2V5LCBleHApO1xuICAgIGlmIChJU19QUk9UTyAmJiBleHBQcm90b1trZXldICE9IG91dCkgZXhwUHJvdG9ba2V5XSA9IG91dDtcbiAgfVxufTtcbl9nbG9iYWwuY29yZSA9IF9jb3JlO1xuLy8gdHlwZSBiaXRtYXBcbiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkXG4kZXhwb3J0LkcgPSAyOyAgIC8vIGdsb2JhbFxuJGV4cG9ydC5TID0gNDsgICAvLyBzdGF0aWNcbiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG9cbiRleHBvcnQuQiA9IDE2OyAgLy8gYmluZFxuJGV4cG9ydC5XID0gMzI7ICAvLyB3cmFwXG4kZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmVcbiRleHBvcnQuUiA9IDEyODsgLy8gcmVhbCBwcm90byBtZXRob2QgZm9yIGBsaWJyYXJ5YFxudmFyIF9leHBvcnQgPSAkZXhwb3J0O1xuXG52YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxudmFyIF9jb2YgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoaXQpLnNsaWNlKDgsIC0xKTtcbn07XG5cbi8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzXG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbnZhciBfaW9iamVjdCA9IE9iamVjdCgneicpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApID8gT2JqZWN0IDogZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBfY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7XG59O1xuXG4vLyA3LjIuMSBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KVxudmFyIF9kZWZpbmVkID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmIChpdCA9PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcihcIkNhbid0IGNhbGwgbWV0aG9kIG9uICBcIiArIGl0KTtcbiAgcmV0dXJuIGl0O1xufTtcblxuLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KVxuXG52YXIgX3RvT2JqZWN0ID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBPYmplY3QoX2RlZmluZWQoaXQpKTtcbn07XG5cbi8vIDcuMS40IFRvSW50ZWdlclxudmFyIGNlaWwgPSBNYXRoLmNlaWw7XG52YXIgZmxvb3IgPSBNYXRoLmZsb29yO1xudmFyIF90b0ludGVnZXIgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7XG59O1xuXG4vLyA3LjEuMTUgVG9MZW5ndGhcblxudmFyIG1pbiA9IE1hdGgubWluO1xudmFyIF90b0xlbmd0aCA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gaXQgPiAwID8gbWluKF90b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTFcbn07XG5cbi8vIDcuMi4yIElzQXJyYXkoYXJndW1lbnQpXG5cbnZhciBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheShhcmcpIHtcbiAgcmV0dXJuIF9jb2YoYXJnKSA9PSAnQXJyYXknO1xufTtcblxudmFyIFNIQVJFRCA9ICdfX2NvcmUtanNfc2hhcmVkX18nO1xudmFyIHN0b3JlID0gX2dsb2JhbFtTSEFSRURdIHx8IChfZ2xvYmFsW1NIQVJFRF0gPSB7fSk7XG52YXIgX3NoYXJlZCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB7fSk7XG59O1xuXG52YXIgX3drcyA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHtcbnZhciBzdG9yZSA9IF9zaGFyZWQoJ3drcycpO1xuXG52YXIgU3ltYm9sID0gX2dsb2JhbC5TeW1ib2w7XG52YXIgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJztcblxudmFyICRleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobmFtZSkge1xuICByZXR1cm4gc3RvcmVbbmFtZV0gfHwgKHN0b3JlW25hbWVdID1cbiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IF91aWQpKCdTeW1ib2wuJyArIG5hbWUpKTtcbn07XG5cbiRleHBvcnRzLnN0b3JlID0gc3RvcmU7XG59KTtcblxudmFyIFNQRUNJRVMgPSBfd2tzKCdzcGVjaWVzJyk7XG5cbnZhciBfYXJyYXlTcGVjaWVzQ29uc3RydWN0b3IgPSBmdW5jdGlvbiAob3JpZ2luYWwpIHtcbiAgdmFyIEM7XG4gIGlmIChfaXNBcnJheShvcmlnaW5hbCkpIHtcbiAgICBDID0gb3JpZ2luYWwuY29uc3RydWN0b3I7XG4gICAgLy8gY3Jvc3MtcmVhbG0gZmFsbGJhY2tcbiAgICBpZiAodHlwZW9mIEMgPT0gJ2Z1bmN0aW9uJyAmJiAoQyA9PT0gQXJyYXkgfHwgX2lzQXJyYXkoQy5wcm90b3R5cGUpKSkgQyA9IHVuZGVmaW5lZDtcbiAgICBpZiAoX2lzT2JqZWN0KEMpKSB7XG4gICAgICBDID0gQ1tTUEVDSUVTXTtcbiAgICAgIGlmIChDID09PSBudWxsKSBDID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfSByZXR1cm4gQyA9PT0gdW5kZWZpbmVkID8gQXJyYXkgOiBDO1xufTtcblxuLy8gOS40LjIuMyBBcnJheVNwZWNpZXNDcmVhdGUob3JpZ2luYWxBcnJheSwgbGVuZ3RoKVxuXG5cbnZhciBfYXJyYXlTcGVjaWVzQ3JlYXRlID0gZnVuY3Rpb24gKG9yaWdpbmFsLCBsZW5ndGgpIHtcbiAgcmV0dXJuIG5ldyAoX2FycmF5U3BlY2llc0NvbnN0cnVjdG9yKG9yaWdpbmFsKSkobGVuZ3RoKTtcbn07XG5cbi8vIDAgLT4gQXJyYXkjZm9yRWFjaFxuLy8gMSAtPiBBcnJheSNtYXBcbi8vIDIgLT4gQXJyYXkjZmlsdGVyXG4vLyAzIC0+IEFycmF5I3NvbWVcbi8vIDQgLT4gQXJyYXkjZXZlcnlcbi8vIDUgLT4gQXJyYXkjZmluZFxuLy8gNiAtPiBBcnJheSNmaW5kSW5kZXhcblxuXG5cblxuXG52YXIgX2FycmF5TWV0aG9kcyA9IGZ1bmN0aW9uIChUWVBFLCAkY3JlYXRlKSB7XG4gIHZhciBJU19NQVAgPSBUWVBFID09IDE7XG4gIHZhciBJU19GSUxURVIgPSBUWVBFID09IDI7XG4gIHZhciBJU19TT01FID0gVFlQRSA9PSAzO1xuICB2YXIgSVNfRVZFUlkgPSBUWVBFID09IDQ7XG4gIHZhciBJU19GSU5EX0lOREVYID0gVFlQRSA9PSA2O1xuICB2YXIgTk9fSE9MRVMgPSBUWVBFID09IDUgfHwgSVNfRklORF9JTkRFWDtcbiAgdmFyIGNyZWF0ZSA9ICRjcmVhdGUgfHwgX2FycmF5U3BlY2llc0NyZWF0ZTtcbiAgcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgY2FsbGJhY2tmbiwgdGhhdCkge1xuICAgIHZhciBPID0gX3RvT2JqZWN0KCR0aGlzKTtcbiAgICB2YXIgc2VsZiA9IF9pb2JqZWN0KE8pO1xuICAgIHZhciBmID0gX2N0eChjYWxsYmFja2ZuLCB0aGF0LCAzKTtcbiAgICB2YXIgbGVuZ3RoID0gX3RvTGVuZ3RoKHNlbGYubGVuZ3RoKTtcbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciByZXN1bHQgPSBJU19NQVAgPyBjcmVhdGUoJHRoaXMsIGxlbmd0aCkgOiBJU19GSUxURVIgPyBjcmVhdGUoJHRoaXMsIDApIDogdW5kZWZpbmVkO1xuICAgIHZhciB2YWwsIHJlcztcbiAgICBmb3IgKDtsZW5ndGggPiBpbmRleDsgaW5kZXgrKykgaWYgKE5PX0hPTEVTIHx8IGluZGV4IGluIHNlbGYpIHtcbiAgICAgIHZhbCA9IHNlbGZbaW5kZXhdO1xuICAgICAgcmVzID0gZih2YWwsIGluZGV4LCBPKTtcbiAgICAgIGlmIChUWVBFKSB7XG4gICAgICAgIGlmIChJU19NQVApIHJlc3VsdFtpbmRleF0gPSByZXM7ICAgLy8gbWFwXG4gICAgICAgIGVsc2UgaWYgKHJlcykgc3dpdGNoIChUWVBFKSB7XG4gICAgICAgICAgY2FzZSAzOiByZXR1cm4gdHJ1ZTsgICAgICAgICAgICAgLy8gc29tZVxuICAgICAgICAgIGNhc2UgNTogcmV0dXJuIHZhbDsgICAgICAgICAgICAgIC8vIGZpbmRcbiAgICAgICAgICBjYXNlIDY6IHJldHVybiBpbmRleDsgICAgICAgICAgICAvLyBmaW5kSW5kZXhcbiAgICAgICAgICBjYXNlIDI6IHJlc3VsdC5wdXNoKHZhbCk7ICAgICAgICAvLyBmaWx0ZXJcbiAgICAgICAgfSBlbHNlIGlmIChJU19FVkVSWSkgcmV0dXJuIGZhbHNlOyAvLyBldmVyeVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gSVNfRklORF9JTkRFWCA/IC0xIDogSVNfU09NRSB8fCBJU19FVkVSWSA/IElTX0VWRVJZIDogcmVzdWx0O1xuICB9O1xufTtcblxuLy8gMjIuMS4zLjMxIEFycmF5LnByb3RvdHlwZVtAQHVuc2NvcGFibGVzXVxudmFyIFVOU0NPUEFCTEVTID0gX3drcygndW5zY29wYWJsZXMnKTtcbnZhciBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlO1xuaWYgKEFycmF5UHJvdG9bVU5TQ09QQUJMRVNdID09IHVuZGVmaW5lZCkgX2hpZGUoQXJyYXlQcm90bywgVU5TQ09QQUJMRVMsIHt9KTtcbnZhciBfYWRkVG9VbnNjb3BhYmxlcyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgQXJyYXlQcm90b1tVTlNDT1BBQkxFU11ba2V5XSA9IHRydWU7XG59O1xuXG4vLyAyMi4xLjMuOCBBcnJheS5wcm90b3R5cGUuZmluZChwcmVkaWNhdGUsIHRoaXNBcmcgPSB1bmRlZmluZWQpXG5cbnZhciAkZmluZCA9IF9hcnJheU1ldGhvZHMoNSk7XG52YXIgS0VZID0gJ2ZpbmQnO1xudmFyIGZvcmNlZCA9IHRydWU7XG4vLyBTaG91bGRuJ3Qgc2tpcCBob2xlc1xuaWYgKEtFWSBpbiBbXSkgQXJyYXkoMSlbS0VZXShmdW5jdGlvbiAoKSB7IGZvcmNlZCA9IGZhbHNlOyB9KTtcbl9leHBvcnQoX2V4cG9ydC5QICsgX2V4cG9ydC5GICogZm9yY2VkLCAnQXJyYXknLCB7XG4gIGZpbmQ6IGZ1bmN0aW9uIGZpbmQoY2FsbGJhY2tmbiAvKiAsIHRoYXQgPSB1bmRlZmluZWQgKi8pIHtcbiAgICByZXR1cm4gJGZpbmQodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpO1xuICB9XG59KTtcbl9hZGRUb1Vuc2NvcGFibGVzKEtFWSk7XG5cbnZhciBmaW5kID0gX2NvcmUuQXJyYXkuZmluZDtcblxuLy8gMjIuMS4zLjkgQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleChwcmVkaWNhdGUsIHRoaXNBcmcgPSB1bmRlZmluZWQpXG5cbnZhciAkZmluZCQxID0gX2FycmF5TWV0aG9kcyg2KTtcbnZhciBLRVkkMSA9ICdmaW5kSW5kZXgnO1xudmFyIGZvcmNlZCQxID0gdHJ1ZTtcbi8vIFNob3VsZG4ndCBza2lwIGhvbGVzXG5pZiAoS0VZJDEgaW4gW10pIEFycmF5KDEpW0tFWSQxXShmdW5jdGlvbiAoKSB7IGZvcmNlZCQxID0gZmFsc2U7IH0pO1xuX2V4cG9ydChfZXhwb3J0LlAgKyBfZXhwb3J0LkYgKiBmb3JjZWQkMSwgJ0FycmF5Jywge1xuICBmaW5kSW5kZXg6IGZ1bmN0aW9uIGZpbmRJbmRleChjYWxsYmFja2ZuIC8qICwgdGhhdCA9IHVuZGVmaW5lZCAqLykge1xuICAgIHJldHVybiAkZmluZCQxKHRoaXMsIGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTtcbiAgfVxufSk7XG5fYWRkVG9VbnNjb3BhYmxlcyhLRVkkMSk7XG5cbnZhciBmaW5kSW5kZXggPSBfY29yZS5BcnJheS5maW5kSW5kZXg7XG5cbi8vIHRvIGluZGV4ZWQgb2JqZWN0LCB0b09iamVjdCB3aXRoIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgc3RyaW5nc1xuXG5cbnZhciBfdG9Jb2JqZWN0ID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBfaW9iamVjdChfZGVmaW5lZChpdCkpO1xufTtcblxudmFyIG1heCA9IE1hdGgubWF4O1xudmFyIG1pbiQxID0gTWF0aC5taW47XG52YXIgX3RvQWJzb2x1dGVJbmRleCA9IGZ1bmN0aW9uIChpbmRleCwgbGVuZ3RoKSB7XG4gIGluZGV4ID0gX3RvSW50ZWdlcihpbmRleCk7XG4gIHJldHVybiBpbmRleCA8IDAgPyBtYXgoaW5kZXggKyBsZW5ndGgsIDApIDogbWluJDEoaW5kZXgsIGxlbmd0aCk7XG59O1xuXG4vLyBmYWxzZSAtPiBBcnJheSNpbmRleE9mXG4vLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlc1xuXG5cblxudmFyIF9hcnJheUluY2x1ZGVzID0gZnVuY3Rpb24gKElTX0lOQ0xVREVTKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoJHRoaXMsIGVsLCBmcm9tSW5kZXgpIHtcbiAgICB2YXIgTyA9IF90b0lvYmplY3QoJHRoaXMpO1xuICAgIHZhciBsZW5ndGggPSBfdG9MZW5ndGgoTy5sZW5ndGgpO1xuICAgIHZhciBpbmRleCA9IF90b0Fic29sdXRlSW5kZXgoZnJvbUluZGV4LCBsZW5ndGgpO1xuICAgIHZhciB2YWx1ZTtcbiAgICAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNlbGYtY29tcGFyZVxuICAgIGlmIChJU19JTkNMVURFUyAmJiBlbCAhPSBlbCkgd2hpbGUgKGxlbmd0aCA+IGluZGV4KSB7XG4gICAgICB2YWx1ZSA9IE9baW5kZXgrK107XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gICAgICBpZiAodmFsdWUgIT0gdmFsdWUpIHJldHVybiB0cnVlO1xuICAgIC8vIEFycmF5I2luZGV4T2YgaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3RcbiAgICB9IGVsc2UgZm9yICg7bGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIGlmIChJU19JTkNMVURFUyB8fCBpbmRleCBpbiBPKSB7XG4gICAgICBpZiAoT1tpbmRleF0gPT09IGVsKSByZXR1cm4gSVNfSU5DTFVERVMgfHwgaW5kZXggfHwgMDtcbiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7XG4gIH07XG59O1xuXG52YXIgc2hhcmVkID0gX3NoYXJlZCgna2V5cycpO1xuXG52YXIgX3NoYXJlZEtleSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIHNoYXJlZFtrZXldIHx8IChzaGFyZWRba2V5XSA9IF91aWQoa2V5KSk7XG59O1xuXG52YXIgYXJyYXlJbmRleE9mID0gX2FycmF5SW5jbHVkZXMoZmFsc2UpO1xudmFyIElFX1BST1RPID0gX3NoYXJlZEtleSgnSUVfUFJPVE8nKTtcblxudmFyIF9vYmplY3RLZXlzSW50ZXJuYWwgPSBmdW5jdGlvbiAob2JqZWN0LCBuYW1lcykge1xuICB2YXIgTyA9IF90b0lvYmplY3Qob2JqZWN0KTtcbiAgdmFyIGkgPSAwO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIHZhciBrZXk7XG4gIGZvciAoa2V5IGluIE8pIGlmIChrZXkgIT0gSUVfUFJPVE8pIF9oYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpO1xuICAvLyBEb24ndCBlbnVtIGJ1ZyAmIGhpZGRlbiBrZXlzXG4gIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKSBpZiAoX2hhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSkge1xuICAgIH5hcnJheUluZGV4T2YocmVzdWx0LCBrZXkpIHx8IHJlc3VsdC5wdXNoKGtleSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8vIElFIDgtIGRvbid0IGVudW0gYnVnIGtleXNcbnZhciBfZW51bUJ1Z0tleXMgPSAoXG4gICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnXG4pLnNwbGl0KCcsJyk7XG5cbi8vIDE5LjEuMi4xNCAvIDE1LjIuMy4xNCBPYmplY3Qua2V5cyhPKVxuXG5cblxudmFyIF9vYmplY3RLZXlzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24ga2V5cyhPKSB7XG4gIHJldHVybiBfb2JqZWN0S2V5c0ludGVybmFsKE8sIF9lbnVtQnVnS2V5cyk7XG59O1xuXG52YXIgZiQxID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scztcblxudmFyIF9vYmplY3RHb3BzID0ge1xuXHRmOiBmJDFcbn07XG5cbnZhciBmJDIgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcblxudmFyIF9vYmplY3RQaWUgPSB7XG5cdGY6IGYkMlxufTtcblxuLy8gMTkuMS4yLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSwgLi4uKVxuXG5cblxuXG5cbnZhciAkYXNzaWduID0gT2JqZWN0LmFzc2lnbjtcblxuLy8gc2hvdWxkIHdvcmsgd2l0aCBzeW1ib2xzIGFuZCBzaG91bGQgaGF2ZSBkZXRlcm1pbmlzdGljIHByb3BlcnR5IG9yZGVyIChWOCBidWcpXG52YXIgX29iamVjdEFzc2lnbiA9ICEkYXNzaWduIHx8IF9mYWlscyhmdW5jdGlvbiAoKSB7XG4gIHZhciBBID0ge307XG4gIHZhciBCID0ge307XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZlxuICB2YXIgUyA9IFN5bWJvbCgpO1xuICB2YXIgSyA9ICdhYmNkZWZnaGlqa2xtbm9wcXJzdCc7XG4gIEFbU10gPSA3O1xuICBLLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uIChrKSB7IEJba10gPSBrOyB9KTtcbiAgcmV0dXJuICRhc3NpZ24oe30sIEEpW1NdICE9IDcgfHwgT2JqZWN0LmtleXMoJGFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IEs7XG59KSA/IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIHNvdXJjZSkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gIHZhciBUID0gX3RvT2JqZWN0KHRhcmdldCk7XG4gIHZhciBhTGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgdmFyIGluZGV4ID0gMTtcbiAgdmFyIGdldFN5bWJvbHMgPSBfb2JqZWN0R29wcy5mO1xuICB2YXIgaXNFbnVtID0gX29iamVjdFBpZS5mO1xuICB3aGlsZSAoYUxlbiA+IGluZGV4KSB7XG4gICAgdmFyIFMgPSBfaW9iamVjdChhcmd1bWVudHNbaW5kZXgrK10pO1xuICAgIHZhciBrZXlzID0gZ2V0U3ltYm9scyA/IF9vYmplY3RLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IF9vYmplY3RLZXlzKFMpO1xuICAgIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgaiA9IDA7XG4gICAgdmFyIGtleTtcbiAgICB3aGlsZSAobGVuZ3RoID4gaikgaWYgKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpIFRba2V5XSA9IFNba2V5XTtcbiAgfSByZXR1cm4gVDtcbn0gOiAkYXNzaWduO1xuXG4vLyAxOS4xLjMuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlKVxuXG5cbl9leHBvcnQoX2V4cG9ydC5TICsgX2V4cG9ydC5GLCAnT2JqZWN0JywgeyBhc3NpZ246IF9vYmplY3RBc3NpZ24gfSk7XG5cbnZhciBhc3NpZ24gPSBfY29yZS5PYmplY3QuYXNzaWduO1xuXG4vLyA3LjIuOCBJc1JlZ0V4cChhcmd1bWVudClcblxuXG52YXIgTUFUQ0ggPSBfd2tzKCdtYXRjaCcpO1xudmFyIF9pc1JlZ2V4cCA9IGZ1bmN0aW9uIChpdCkge1xuICB2YXIgaXNSZWdFeHA7XG4gIHJldHVybiBfaXNPYmplY3QoaXQpICYmICgoaXNSZWdFeHAgPSBpdFtNQVRDSF0pICE9PSB1bmRlZmluZWQgPyAhIWlzUmVnRXhwIDogX2NvZihpdCkgPT0gJ1JlZ0V4cCcpO1xufTtcblxuLy8gaGVscGVyIGZvciBTdHJpbmcje3N0YXJ0c1dpdGgsIGVuZHNXaXRoLCBpbmNsdWRlc31cblxuXG5cbnZhciBfc3RyaW5nQ29udGV4dCA9IGZ1bmN0aW9uICh0aGF0LCBzZWFyY2hTdHJpbmcsIE5BTUUpIHtcbiAgaWYgKF9pc1JlZ2V4cChzZWFyY2hTdHJpbmcpKSB0aHJvdyBUeXBlRXJyb3IoJ1N0cmluZyMnICsgTkFNRSArIFwiIGRvZXNuJ3QgYWNjZXB0IHJlZ2V4IVwiKTtcbiAgcmV0dXJuIFN0cmluZyhfZGVmaW5lZCh0aGF0KSk7XG59O1xuXG52YXIgTUFUQ0gkMSA9IF93a3MoJ21hdGNoJyk7XG52YXIgX2ZhaWxzSXNSZWdleHAgPSBmdW5jdGlvbiAoS0VZKSB7XG4gIHZhciByZSA9IC8uLztcbiAgdHJ5IHtcbiAgICAnLy4vJ1tLRVldKHJlKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRyeSB7XG4gICAgICByZVtNQVRDSCQxXSA9IGZhbHNlO1xuICAgICAgcmV0dXJuICEnLy4vJ1tLRVldKHJlKTtcbiAgICB9IGNhdGNoIChmKSB7IC8qIGVtcHR5ICovIH1cbiAgfSByZXR1cm4gdHJ1ZTtcbn07XG5cbnZhciBTVEFSVFNfV0lUSCA9ICdzdGFydHNXaXRoJztcbnZhciAkc3RhcnRzV2l0aCA9ICcnW1NUQVJUU19XSVRIXTtcblxuX2V4cG9ydChfZXhwb3J0LlAgKyBfZXhwb3J0LkYgKiBfZmFpbHNJc1JlZ2V4cChTVEFSVFNfV0lUSCksICdTdHJpbmcnLCB7XG4gIHN0YXJ0c1dpdGg6IGZ1bmN0aW9uIHN0YXJ0c1dpdGgoc2VhcmNoU3RyaW5nIC8qICwgcG9zaXRpb24gPSAwICovKSB7XG4gICAgdmFyIHRoYXQgPSBfc3RyaW5nQ29udGV4dCh0aGlzLCBzZWFyY2hTdHJpbmcsIFNUQVJUU19XSVRIKTtcbiAgICB2YXIgaW5kZXggPSBfdG9MZW5ndGgoTWF0aC5taW4oYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQsIHRoYXQubGVuZ3RoKSk7XG4gICAgdmFyIHNlYXJjaCA9IFN0cmluZyhzZWFyY2hTdHJpbmcpO1xuICAgIHJldHVybiAkc3RhcnRzV2l0aFxuICAgICAgPyAkc3RhcnRzV2l0aC5jYWxsKHRoYXQsIHNlYXJjaCwgaW5kZXgpXG4gICAgICA6IHRoYXQuc2xpY2UoaW5kZXgsIGluZGV4ICsgc2VhcmNoLmxlbmd0aCkgPT09IHNlYXJjaDtcbiAgfVxufSk7XG5cbnZhciBzdGFydHNXaXRoID0gX2NvcmUuU3RyaW5nLnN0YXJ0c1dpdGg7XG5cbnZhciBfc3RyaW5nUmVwZWF0ID0gZnVuY3Rpb24gcmVwZWF0KGNvdW50KSB7XG4gIHZhciBzdHIgPSBTdHJpbmcoX2RlZmluZWQodGhpcykpO1xuICB2YXIgcmVzID0gJyc7XG4gIHZhciBuID0gX3RvSW50ZWdlcihjb3VudCk7XG4gIGlmIChuIDwgMCB8fCBuID09IEluZmluaXR5KSB0aHJvdyBSYW5nZUVycm9yKFwiQ291bnQgY2FuJ3QgYmUgbmVnYXRpdmVcIik7XG4gIGZvciAoO24gPiAwOyAobiA+Pj49IDEpICYmIChzdHIgKz0gc3RyKSkgaWYgKG4gJiAxKSByZXMgKz0gc3RyO1xuICByZXR1cm4gcmVzO1xufTtcblxuX2V4cG9ydChfZXhwb3J0LlAsICdTdHJpbmcnLCB7XG4gIC8vIDIxLjEuMy4xMyBTdHJpbmcucHJvdG90eXBlLnJlcGVhdChjb3VudClcbiAgcmVwZWF0OiBfc3RyaW5nUmVwZWF0XG59KTtcblxudmFyIHJlcGVhdCA9IF9jb3JlLlN0cmluZy5yZXBlYXQ7XG5cbnZhciBfbWV0YSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHtcbnZhciBNRVRBID0gX3VpZCgnbWV0YScpO1xuXG5cbnZhciBzZXREZXNjID0gX29iamVjdERwLmY7XG52YXIgaWQgPSAwO1xudmFyIGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGUgfHwgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdHJ1ZTtcbn07XG52YXIgRlJFRVpFID0gIV9mYWlscyhmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBpc0V4dGVuc2libGUoT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHt9KSk7XG59KTtcbnZhciBzZXRNZXRhID0gZnVuY3Rpb24gKGl0KSB7XG4gIHNldERlc2MoaXQsIE1FVEEsIHsgdmFsdWU6IHtcbiAgICBpOiAnTycgKyArK2lkLCAvLyBvYmplY3QgSURcbiAgICB3OiB7fSAgICAgICAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIElEc1xuICB9IH0pO1xufTtcbnZhciBmYXN0S2V5ID0gZnVuY3Rpb24gKGl0LCBjcmVhdGUpIHtcbiAgLy8gcmV0dXJuIHByaW1pdGl2ZSB3aXRoIHByZWZpeFxuICBpZiAoIV9pc09iamVjdChpdCkpIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCcgPyBpdCA6ICh0eXBlb2YgaXQgPT0gJ3N0cmluZycgPyAnUycgOiAnUCcpICsgaXQ7XG4gIGlmICghX2hhcyhpdCwgTUVUQSkpIHtcbiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdFxuICAgIGlmICghaXNFeHRlbnNpYmxlKGl0KSkgcmV0dXJuICdGJztcbiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YVxuICAgIGlmICghY3JlYXRlKSByZXR1cm4gJ0UnO1xuICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhXG4gICAgc2V0TWV0YShpdCk7XG4gIC8vIHJldHVybiBvYmplY3QgSURcbiAgfSByZXR1cm4gaXRbTUVUQV0uaTtcbn07XG52YXIgZ2V0V2VhayA9IGZ1bmN0aW9uIChpdCwgY3JlYXRlKSB7XG4gIGlmICghX2hhcyhpdCwgTUVUQSkpIHtcbiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdFxuICAgIGlmICghaXNFeHRlbnNpYmxlKGl0KSkgcmV0dXJuIHRydWU7XG4gICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGFcbiAgICBpZiAoIWNyZWF0ZSkgcmV0dXJuIGZhbHNlO1xuICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhXG4gICAgc2V0TWV0YShpdCk7XG4gIC8vIHJldHVybiBoYXNoIHdlYWsgY29sbGVjdGlvbnMgSURzXG4gIH0gcmV0dXJuIGl0W01FVEFdLnc7XG59O1xuLy8gYWRkIG1ldGFkYXRhIG9uIGZyZWV6ZS1mYW1pbHkgbWV0aG9kcyBjYWxsaW5nXG52YXIgb25GcmVlemUgPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKEZSRUVaRSAmJiBtZXRhLk5FRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhX2hhcyhpdCwgTUVUQSkpIHNldE1ldGEoaXQpO1xuICByZXR1cm4gaXQ7XG59O1xudmFyIG1ldGEgPSBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgS0VZOiBNRVRBLFxuICBORUVEOiBmYWxzZSxcbiAgZmFzdEtleTogZmFzdEtleSxcbiAgZ2V0V2VhazogZ2V0V2VhayxcbiAgb25GcmVlemU6IG9uRnJlZXplXG59O1xufSk7XG52YXIgX21ldGFfMSA9IF9tZXRhLktFWTtcbnZhciBfbWV0YV8yID0gX21ldGEuTkVFRDtcbnZhciBfbWV0YV8zID0gX21ldGEuZmFzdEtleTtcbnZhciBfbWV0YV80ID0gX21ldGEuZ2V0V2VhaztcbnZhciBfbWV0YV81ID0gX21ldGEub25GcmVlemU7XG5cbnZhciBkZWYgPSBfb2JqZWN0RHAuZjtcblxudmFyIFRBRyA9IF93a3MoJ3RvU3RyaW5nVGFnJyk7XG5cbnZhciBfc2V0VG9TdHJpbmdUYWcgPSBmdW5jdGlvbiAoaXQsIHRhZywgc3RhdCkge1xuICBpZiAoaXQgJiYgIV9oYXMoaXQgPSBzdGF0ID8gaXQgOiBpdC5wcm90b3R5cGUsIFRBRykpIGRlZihpdCwgVEFHLCB7IGNvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHRhZyB9KTtcbn07XG5cbnZhciBmJDMgPSBfd2tzO1xuXG52YXIgX3drc0V4dCA9IHtcblx0ZjogZiQzXG59O1xuXG52YXIgX2xpYnJhcnkgPSBmYWxzZTtcblxudmFyIGRlZmluZVByb3BlcnR5ID0gX29iamVjdERwLmY7XG52YXIgX3drc0RlZmluZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gIHZhciAkU3ltYm9sID0gX2NvcmUuU3ltYm9sIHx8IChfY29yZS5TeW1ib2wgPSBfbGlicmFyeSA/IHt9IDogX2dsb2JhbC5TeW1ib2wgfHwge30pO1xuICBpZiAobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSkgZGVmaW5lUHJvcGVydHkoJFN5bWJvbCwgbmFtZSwgeyB2YWx1ZTogX3drc0V4dC5mKG5hbWUpIH0pO1xufTtcblxuLy8gYWxsIGVudW1lcmFibGUgb2JqZWN0IGtleXMsIGluY2x1ZGVzIHN5bWJvbHNcblxuXG5cbnZhciBfZW51bUtleXMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgdmFyIHJlc3VsdCA9IF9vYmplY3RLZXlzKGl0KTtcbiAgdmFyIGdldFN5bWJvbHMgPSBfb2JqZWN0R29wcy5mO1xuICBpZiAoZ2V0U3ltYm9scykge1xuICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCk7XG4gICAgdmFyIGlzRW51bSA9IF9vYmplY3RQaWUuZjtcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIGtleTtcbiAgICB3aGlsZSAoc3ltYm9scy5sZW5ndGggPiBpKSBpZiAoaXNFbnVtLmNhbGwoaXQsIGtleSA9IHN5bWJvbHNbaSsrXSkpIHJlc3VsdC5wdXNoKGtleSk7XG4gIH0gcmV0dXJuIHJlc3VsdDtcbn07XG5cbnZhciBfb2JqZWN0RHBzID0gX2Rlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpIHtcbiAgX2FuT2JqZWN0KE8pO1xuICB2YXIga2V5cyA9IF9vYmplY3RLZXlzKFByb3BlcnRpZXMpO1xuICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG4gIHZhciBpID0gMDtcbiAgdmFyIFA7XG4gIHdoaWxlIChsZW5ndGggPiBpKSBfb2JqZWN0RHAuZihPLCBQID0ga2V5c1tpKytdLCBQcm9wZXJ0aWVzW1BdKTtcbiAgcmV0dXJuIE87XG59O1xuXG52YXIgZG9jdW1lbnQkMSA9IF9nbG9iYWwuZG9jdW1lbnQ7XG52YXIgX2h0bWwgPSBkb2N1bWVudCQxICYmIGRvY3VtZW50JDEuZG9jdW1lbnRFbGVtZW50O1xuXG4vLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSlcblxuXG5cbnZhciBJRV9QUk9UTyQxID0gX3NoYXJlZEtleSgnSUVfUFJPVE8nKTtcbnZhciBFbXB0eSA9IGZ1bmN0aW9uICgpIHsgLyogZW1wdHkgKi8gfTtcbnZhciBQUk9UT1RZUEUkMSA9ICdwcm90b3R5cGUnO1xuXG4vLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlXG52YXIgY3JlYXRlRGljdCA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gVGhyYXNoLCB3YXN0ZSBhbmQgc29kb215OiBJRSBHQyBidWdcbiAgdmFyIGlmcmFtZSA9IF9kb21DcmVhdGUoJ2lmcmFtZScpO1xuICB2YXIgaSA9IF9lbnVtQnVnS2V5cy5sZW5ndGg7XG4gIHZhciBsdCA9ICc8JztcbiAgdmFyIGd0ID0gJz4nO1xuICB2YXIgaWZyYW1lRG9jdW1lbnQ7XG4gIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICBfaHRtbC5hcHBlbmRDaGlsZChpZnJhbWUpO1xuICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsXG4gIC8vIGNyZWF0ZURpY3QgPSBpZnJhbWUuY29udGVudFdpbmRvdy5PYmplY3Q7XG4gIC8vIGh0bWwucmVtb3ZlQ2hpbGQoaWZyYW1lKTtcbiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDtcbiAgaWZyYW1lRG9jdW1lbnQub3BlbigpO1xuICBpZnJhbWVEb2N1bWVudC53cml0ZShsdCArICdzY3JpcHQnICsgZ3QgKyAnZG9jdW1lbnQuRj1PYmplY3QnICsgbHQgKyAnL3NjcmlwdCcgKyBndCk7XG4gIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7XG4gIGNyZWF0ZURpY3QgPSBpZnJhbWVEb2N1bWVudC5GO1xuICB3aGlsZSAoaS0tKSBkZWxldGUgY3JlYXRlRGljdFtQUk9UT1RZUEUkMV1bX2VudW1CdWdLZXlzW2ldXTtcbiAgcmV0dXJuIGNyZWF0ZURpY3QoKTtcbn07XG5cbnZhciBfb2JqZWN0Q3JlYXRlID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcykge1xuICB2YXIgcmVzdWx0O1xuICBpZiAoTyAhPT0gbnVsbCkge1xuICAgIEVtcHR5W1BST1RPVFlQRSQxXSA9IF9hbk9iamVjdChPKTtcbiAgICByZXN1bHQgPSBuZXcgRW1wdHkoKTtcbiAgICBFbXB0eVtQUk9UT1RZUEUkMV0gPSBudWxsO1xuICAgIC8vIGFkZCBcIl9fcHJvdG9fX1wiIGZvciBPYmplY3QuZ2V0UHJvdG90eXBlT2YgcG9seWZpbGxcbiAgICByZXN1bHRbSUVfUFJPVE8kMV0gPSBPO1xuICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpO1xuICByZXR1cm4gUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkID8gcmVzdWx0IDogX29iamVjdERwcyhyZXN1bHQsIFByb3BlcnRpZXMpO1xufTtcblxuLy8gMTkuMS4yLjcgLyAxNS4yLjMuNCBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKVxuXG52YXIgaGlkZGVuS2V5cyA9IF9lbnVtQnVnS2V5cy5jb25jYXQoJ2xlbmd0aCcsICdwcm90b3R5cGUnKTtcblxudmFyIGYkNCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHx8IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoTykge1xuICByZXR1cm4gX29iamVjdEtleXNJbnRlcm5hbChPLCBoaWRkZW5LZXlzKTtcbn07XG5cbnZhciBfb2JqZWN0R29wbiA9IHtcblx0ZjogZiQ0XG59O1xuXG4vLyBmYWxsYmFjayBmb3IgSUUxMSBidWdneSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB3aXRoIGlmcmFtZSBhbmQgd2luZG93XG5cbnZhciBnT1BOID0gX29iamVjdEdvcG4uZjtcbnZhciB0b1N0cmluZyQxID0ge30udG9TdHJpbmc7XG5cbnZhciB3aW5kb3dOYW1lcyA9IHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgd2luZG93ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzXG4gID8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMod2luZG93KSA6IFtdO1xuXG52YXIgZ2V0V2luZG93TmFtZXMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZ09QTihpdCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gd2luZG93TmFtZXMuc2xpY2UoKTtcbiAgfVxufTtcblxudmFyIGYkNSA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpIHtcbiAgcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nJDEuY2FsbChpdCkgPT0gJ1tvYmplY3QgV2luZG93XScgPyBnZXRXaW5kb3dOYW1lcyhpdCkgOiBnT1BOKF90b0lvYmplY3QoaXQpKTtcbn07XG5cbnZhciBfb2JqZWN0R29wbkV4dCA9IHtcblx0ZjogZiQ1XG59O1xuXG52YXIgZ09QRCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7XG5cbnZhciBmJDYgPSBfZGVzY3JpcHRvcnMgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApIHtcbiAgTyA9IF90b0lvYmplY3QoTyk7XG4gIFAgPSBfdG9QcmltaXRpdmUoUCwgdHJ1ZSk7XG4gIGlmIChfaWU4RG9tRGVmaW5lKSB0cnkge1xuICAgIHJldHVybiBnT1BEKE8sIFApO1xuICB9IGNhdGNoIChlKSB7IC8qIGVtcHR5ICovIH1cbiAgaWYgKF9oYXMoTywgUCkpIHJldHVybiBfcHJvcGVydHlEZXNjKCFfb2JqZWN0UGllLmYuY2FsbChPLCBQKSwgT1tQXSk7XG59O1xuXG52YXIgX29iamVjdEdvcGQgPSB7XG5cdGY6IGYkNlxufTtcblxuLy8gRUNNQVNjcmlwdCA2IHN5bWJvbHMgc2hpbVxuXG5cblxuXG5cbnZhciBNRVRBID0gX21ldGEuS0VZO1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG52YXIgZ09QRCQxID0gX29iamVjdEdvcGQuZjtcbnZhciBkUCQxID0gX29iamVjdERwLmY7XG52YXIgZ09QTiQxID0gX29iamVjdEdvcG5FeHQuZjtcbnZhciAkU3ltYm9sID0gX2dsb2JhbC5TeW1ib2w7XG52YXIgJEpTT04gPSBfZ2xvYmFsLkpTT047XG52YXIgX3N0cmluZ2lmeSA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeTtcbnZhciBQUk9UT1RZUEUkMiA9ICdwcm90b3R5cGUnO1xudmFyIEhJRERFTiA9IF93a3MoJ19oaWRkZW4nKTtcbnZhciBUT19QUklNSVRJVkUgPSBfd2tzKCd0b1ByaW1pdGl2ZScpO1xudmFyIGlzRW51bSA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIFN5bWJvbFJlZ2lzdHJ5ID0gX3NoYXJlZCgnc3ltYm9sLXJlZ2lzdHJ5Jyk7XG52YXIgQWxsU3ltYm9scyA9IF9zaGFyZWQoJ3N5bWJvbHMnKTtcbnZhciBPUFN5bWJvbHMgPSBfc2hhcmVkKCdvcC1zeW1ib2xzJyk7XG52YXIgT2JqZWN0UHJvdG8gPSBPYmplY3RbUFJPVE9UWVBFJDJdO1xudmFyIFVTRV9OQVRJVkUgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nO1xudmFyIFFPYmplY3QgPSBfZ2xvYmFsLlFPYmplY3Q7XG4vLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzNcbnZhciBzZXR0ZXIgPSAhUU9iamVjdCB8fCAhUU9iamVjdFtQUk9UT1RZUEUkMl0gfHwgIVFPYmplY3RbUFJPVE9UWVBFJDJdLmZpbmRDaGlsZDtcblxuLy8gZmFsbGJhY2sgZm9yIG9sZCBBbmRyb2lkLCBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9Njg3XG52YXIgc2V0U3ltYm9sRGVzYyA9IF9kZXNjcmlwdG9ycyAmJiBfZmFpbHMoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gX29iamVjdENyZWF0ZShkUCQxKHt9LCAnYScsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGRQJDEodGhpcywgJ2EnLCB7IHZhbHVlOiA3IH0pLmE7IH1cbiAgfSkpLmEgIT0gNztcbn0pID8gZnVuY3Rpb24gKGl0LCBrZXksIEQpIHtcbiAgdmFyIHByb3RvRGVzYyA9IGdPUEQkMShPYmplY3RQcm90bywga2V5KTtcbiAgaWYgKHByb3RvRGVzYykgZGVsZXRlIE9iamVjdFByb3RvW2tleV07XG4gIGRQJDEoaXQsIGtleSwgRCk7XG4gIGlmIChwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKSBkUCQxKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7XG59IDogZFAkMTtcblxudmFyIHdyYXAgPSBmdW5jdGlvbiAodGFnKSB7XG4gIHZhciBzeW0gPSBBbGxTeW1ib2xzW3RhZ10gPSBfb2JqZWN0Q3JlYXRlKCRTeW1ib2xbUFJPVE9UWVBFJDJdKTtcbiAgc3ltLl9rID0gdGFnO1xuICByZXR1cm4gc3ltO1xufTtcblxudmFyIGlzU3ltYm9sID0gVVNFX05BVElWRSAmJiB0eXBlb2YgJFN5bWJvbC5pdGVyYXRvciA9PSAnc3ltYm9sJyA/IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnO1xufSA6IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gaXQgaW5zdGFuY2VvZiAkU3ltYm9sO1xufTtcblxudmFyICRkZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGl0LCBrZXksIEQpIHtcbiAgaWYgKGl0ID09PSBPYmplY3RQcm90bykgJGRlZmluZVByb3BlcnR5KE9QU3ltYm9scywga2V5LCBEKTtcbiAgX2FuT2JqZWN0KGl0KTtcbiAga2V5ID0gX3RvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7XG4gIF9hbk9iamVjdChEKTtcbiAgaWYgKF9oYXMoQWxsU3ltYm9scywga2V5KSkge1xuICAgIGlmICghRC5lbnVtZXJhYmxlKSB7XG4gICAgICBpZiAoIV9oYXMoaXQsIEhJRERFTikpIGRQJDEoaXQsIEhJRERFTiwgX3Byb3BlcnR5RGVzYygxLCB7fSkpO1xuICAgICAgaXRbSElEREVOXVtrZXldID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKF9oYXMoaXQsIEhJRERFTikgJiYgaXRbSElEREVOXVtrZXldKSBpdFtISURERU5dW2tleV0gPSBmYWxzZTtcbiAgICAgIEQgPSBfb2JqZWN0Q3JlYXRlKEQsIHsgZW51bWVyYWJsZTogX3Byb3BlcnR5RGVzYygwLCBmYWxzZSkgfSk7XG4gICAgfSByZXR1cm4gc2V0U3ltYm9sRGVzYyhpdCwga2V5LCBEKTtcbiAgfSByZXR1cm4gZFAkMShpdCwga2V5LCBEKTtcbn07XG52YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKSB7XG4gIF9hbk9iamVjdChpdCk7XG4gIHZhciBrZXlzID0gX2VudW1LZXlzKFAgPSBfdG9Jb2JqZWN0KFApKTtcbiAgdmFyIGkgPSAwO1xuICB2YXIgbCA9IGtleXMubGVuZ3RoO1xuICB2YXIga2V5O1xuICB3aGlsZSAobCA+IGkpICRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pO1xuICByZXR1cm4gaXQ7XG59O1xudmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApIHtcbiAgcmV0dXJuIFAgPT09IHVuZGVmaW5lZCA/IF9vYmplY3RDcmVhdGUoaXQpIDogJGRlZmluZVByb3BlcnRpZXMoX29iamVjdENyZWF0ZShpdCksIFApO1xufTtcbnZhciAkcHJvcGVydHlJc0VudW1lcmFibGUgPSBmdW5jdGlvbiBwcm9wZXJ0eUlzRW51bWVyYWJsZShrZXkpIHtcbiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSBfdG9QcmltaXRpdmUoa2V5LCB0cnVlKSk7XG4gIGlmICh0aGlzID09PSBPYmplY3RQcm90byAmJiBfaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIV9oYXMoT1BTeW1ib2xzLCBrZXkpKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiBFIHx8ICFfaGFzKHRoaXMsIGtleSkgfHwgIV9oYXMoQWxsU3ltYm9scywga2V5KSB8fCBfaGFzKHRoaXMsIEhJRERFTikgJiYgdGhpc1tISURERU5dW2tleV0gPyBFIDogdHJ1ZTtcbn07XG52YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KSB7XG4gIGl0ID0gX3RvSW9iamVjdChpdCk7XG4gIGtleSA9IF90b1ByaW1pdGl2ZShrZXksIHRydWUpO1xuICBpZiAoaXQgPT09IE9iamVjdFByb3RvICYmIF9oYXMoQWxsU3ltYm9scywga2V5KSAmJiAhX2hhcyhPUFN5bWJvbHMsIGtleSkpIHJldHVybjtcbiAgdmFyIEQgPSBnT1BEJDEoaXQsIGtleSk7XG4gIGlmIChEICYmIF9oYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKF9oYXMoaXQsIEhJRERFTikgJiYgaXRbSElEREVOXVtrZXldKSkgRC5lbnVtZXJhYmxlID0gdHJ1ZTtcbiAgcmV0dXJuIEQ7XG59O1xudmFyICRnZXRPd25Qcm9wZXJ0eU5hbWVzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCkge1xuICB2YXIgbmFtZXMgPSBnT1BOJDEoX3RvSW9iamVjdChpdCkpO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIHZhciBpID0gMDtcbiAgdmFyIGtleTtcbiAgd2hpbGUgKG5hbWVzLmxlbmd0aCA+IGkpIHtcbiAgICBpZiAoIV9oYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYga2V5ICE9IEhJRERFTiAmJiBrZXkgIT0gTUVUQSkgcmVzdWx0LnB1c2goa2V5KTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcbnZhciAkZ2V0T3duUHJvcGVydHlTeW1ib2xzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlTeW1ib2xzKGl0KSB7XG4gIHZhciBJU19PUCA9IGl0ID09PSBPYmplY3RQcm90bztcbiAgdmFyIG5hbWVzID0gZ09QTiQxKElTX09QID8gT1BTeW1ib2xzIDogX3RvSW9iamVjdChpdCkpO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIHZhciBpID0gMDtcbiAgdmFyIGtleTtcbiAgd2hpbGUgKG5hbWVzLmxlbmd0aCA+IGkpIHtcbiAgICBpZiAoX2hhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiAoSVNfT1AgPyBfaGFzKE9iamVjdFByb3RvLCBrZXkpIDogdHJ1ZSkpIHJlc3VsdC5wdXNoKEFsbFN5bWJvbHNba2V5XSk7XG4gIH0gcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8vIDE5LjQuMS4xIFN5bWJvbChbZGVzY3JpcHRpb25dKVxuaWYgKCFVU0VfTkFUSVZFKSB7XG4gICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKSB7XG4gICAgaWYgKHRoaXMgaW5zdGFuY2VvZiAkU3ltYm9sKSB0aHJvdyBUeXBlRXJyb3IoJ1N5bWJvbCBpcyBub3QgYSBjb25zdHJ1Y3RvciEnKTtcbiAgICB2YXIgdGFnID0gX3VpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7XG4gICAgdmFyICRzZXQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIGlmICh0aGlzID09PSBPYmplY3RQcm90bykgJHNldC5jYWxsKE9QU3ltYm9scywgdmFsdWUpO1xuICAgICAgaWYgKF9oYXModGhpcywgSElEREVOKSAmJiBfaGFzKHRoaXNbSElEREVOXSwgdGFnKSkgdGhpc1tISURERU5dW3RhZ10gPSBmYWxzZTtcbiAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBfcHJvcGVydHlEZXNjKDEsIHZhbHVlKSk7XG4gICAgfTtcbiAgICBpZiAoX2Rlc2NyaXB0b3JzICYmIHNldHRlcikgc2V0U3ltYm9sRGVzYyhPYmplY3RQcm90bywgdGFnLCB7IGNvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0IH0pO1xuICAgIHJldHVybiB3cmFwKHRhZyk7XG4gIH07XG4gIF9yZWRlZmluZSgkU3ltYm9sW1BST1RPVFlQRSQyXSwgJ3RvU3RyaW5nJywgZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2s7XG4gIH0pO1xuXG4gIF9vYmplY3RHb3BkLmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xuICBfb2JqZWN0RHAuZiA9ICRkZWZpbmVQcm9wZXJ0eTtcbiAgX29iamVjdEdvcG4uZiA9IF9vYmplY3RHb3BuRXh0LmYgPSAkZ2V0T3duUHJvcGVydHlOYW1lcztcbiAgX29iamVjdFBpZS5mID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlO1xuICBfb2JqZWN0R29wcy5mID0gJGdldE93blByb3BlcnR5U3ltYm9scztcblxuICBpZiAoX2Rlc2NyaXB0b3JzICYmICFfbGlicmFyeSkge1xuICAgIF9yZWRlZmluZShPYmplY3RQcm90bywgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJywgJHByb3BlcnR5SXNFbnVtZXJhYmxlLCB0cnVlKTtcbiAgfVxuXG4gIF93a3NFeHQuZiA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgcmV0dXJuIHdyYXAoX3drcyhuYW1lKSk7XG4gIH07XG59XG5cbl9leHBvcnQoX2V4cG9ydC5HICsgX2V4cG9ydC5XICsgX2V4cG9ydC5GICogIVVTRV9OQVRJVkUsIHsgU3ltYm9sOiAkU3ltYm9sIH0pO1xuXG5mb3IgKHZhciBlczZTeW1ib2xzID0gKFxuICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNFxuICAnaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMnXG4pLnNwbGl0KCcsJyksIGogPSAwOyBlczZTeW1ib2xzLmxlbmd0aCA+IGo7KV93a3MoZXM2U3ltYm9sc1tqKytdKTtcblxuZm9yICh2YXIgd2VsbEtub3duU3ltYm9scyA9IF9vYmplY3RLZXlzKF93a3Muc3RvcmUpLCBrID0gMDsgd2VsbEtub3duU3ltYm9scy5sZW5ndGggPiBrOykgX3drc0RlZmluZSh3ZWxsS25vd25TeW1ib2xzW2srK10pO1xuXG5fZXhwb3J0KF9leHBvcnQuUyArIF9leHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywge1xuICAvLyAxOS40LjIuMSBTeW1ib2wuZm9yKGtleSlcbiAgJ2Zvcic6IGZ1bmN0aW9uIChrZXkpIHtcbiAgICByZXR1cm4gX2hhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKVxuICAgICAgPyBTeW1ib2xSZWdpc3RyeVtrZXldXG4gICAgICA6IFN5bWJvbFJlZ2lzdHJ5W2tleV0gPSAkU3ltYm9sKGtleSk7XG4gIH0sXG4gIC8vIDE5LjQuMi41IFN5bWJvbC5rZXlGb3Ioc3ltKVxuICBrZXlGb3I6IGZ1bmN0aW9uIGtleUZvcihzeW0pIHtcbiAgICBpZiAoIWlzU3ltYm9sKHN5bSkpIHRocm93IFR5cGVFcnJvcihzeW0gKyAnIGlzIG5vdCBhIHN5bWJvbCEnKTtcbiAgICBmb3IgKHZhciBrZXkgaW4gU3ltYm9sUmVnaXN0cnkpIGlmIChTeW1ib2xSZWdpc3RyeVtrZXldID09PSBzeW0pIHJldHVybiBrZXk7XG4gIH0sXG4gIHVzZVNldHRlcjogZnVuY3Rpb24gKCkgeyBzZXR0ZXIgPSB0cnVlOyB9LFxuICB1c2VTaW1wbGU6IGZ1bmN0aW9uICgpIHsgc2V0dGVyID0gZmFsc2U7IH1cbn0pO1xuXG5fZXhwb3J0KF9leHBvcnQuUyArIF9leHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0Jywge1xuICAvLyAxOS4xLjIuMiBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pXG4gIGNyZWF0ZTogJGNyZWF0ZSxcbiAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpXG4gIGRlZmluZVByb3BlcnR5OiAkZGVmaW5lUHJvcGVydHksXG4gIC8vIDE5LjEuMi4zIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpXG4gIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLFxuICAvLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApXG4gIGdldE93blByb3BlcnR5RGVzY3JpcHRvcjogJGdldE93blByb3BlcnR5RGVzY3JpcHRvcixcbiAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTylcbiAgZ2V0T3duUHJvcGVydHlOYW1lczogJGdldE93blByb3BlcnR5TmFtZXMsXG4gIC8vIDE5LjEuMi44IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoTylcbiAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzXG59KTtcblxuLy8gMjQuMy4yIEpTT04uc3RyaW5naWZ5KHZhbHVlIFssIHJlcGxhY2VyIFssIHNwYWNlXV0pXG4kSlNPTiAmJiBfZXhwb3J0KF9leHBvcnQuUyArIF9leHBvcnQuRiAqICghVVNFX05BVElWRSB8fCBfZmFpbHMoZnVuY3Rpb24gKCkge1xuICB2YXIgUyA9ICRTeW1ib2woKTtcbiAgLy8gTVMgRWRnZSBjb252ZXJ0cyBzeW1ib2wgdmFsdWVzIHRvIEpTT04gYXMge31cbiAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsXG4gIC8vIFY4IHRocm93cyBvbiBib3hlZCBzeW1ib2xzXG4gIHJldHVybiBfc3RyaW5naWZ5KFtTXSkgIT0gJ1tudWxsXScgfHwgX3N0cmluZ2lmeSh7IGE6IFMgfSkgIT0gJ3t9JyB8fCBfc3RyaW5naWZ5KE9iamVjdChTKSkgIT0gJ3t9Jztcbn0pKSwgJ0pTT04nLCB7XG4gIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KSB7XG4gICAgdmFyIGFyZ3MgPSBbaXRdO1xuICAgIHZhciBpID0gMTtcbiAgICB2YXIgcmVwbGFjZXIsICRyZXBsYWNlcjtcbiAgICB3aGlsZSAoYXJndW1lbnRzLmxlbmd0aCA+IGkpIGFyZ3MucHVzaChhcmd1bWVudHNbaSsrXSk7XG4gICAgJHJlcGxhY2VyID0gcmVwbGFjZXIgPSBhcmdzWzFdO1xuICAgIGlmICghX2lzT2JqZWN0KHJlcGxhY2VyKSAmJiBpdCA9PT0gdW5kZWZpbmVkIHx8IGlzU3ltYm9sKGl0KSkgcmV0dXJuOyAvLyBJRTggcmV0dXJucyBzdHJpbmcgb24gdW5kZWZpbmVkXG4gICAgaWYgKCFfaXNBcnJheShyZXBsYWNlcikpIHJlcGxhY2VyID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgIGlmICh0eXBlb2YgJHJlcGxhY2VyID09ICdmdW5jdGlvbicpIHZhbHVlID0gJHJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSk7XG4gICAgICBpZiAoIWlzU3ltYm9sKHZhbHVlKSkgcmV0dXJuIHZhbHVlO1xuICAgIH07XG4gICAgYXJnc1sxXSA9IHJlcGxhY2VyO1xuICAgIHJldHVybiBfc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmdzKTtcbiAgfVxufSk7XG5cbi8vIDE5LjQuMy40IFN5bWJvbC5wcm90b3R5cGVbQEB0b1ByaW1pdGl2ZV0oaGludClcbiRTeW1ib2xbUFJPVE9UWVBFJDJdW1RPX1BSSU1JVElWRV0gfHwgX2hpZGUoJFN5bWJvbFtQUk9UT1RZUEUkMl0sIFRPX1BSSU1JVElWRSwgJFN5bWJvbFtQUk9UT1RZUEUkMl0udmFsdWVPZik7XG4vLyAxOS40LjMuNSBTeW1ib2wucHJvdG90eXBlW0BAdG9TdHJpbmdUYWddXG5fc2V0VG9TdHJpbmdUYWcoJFN5bWJvbCwgJ1N5bWJvbCcpO1xuLy8gMjAuMi4xLjkgTWF0aFtAQHRvU3RyaW5nVGFnXVxuX3NldFRvU3RyaW5nVGFnKE1hdGgsICdNYXRoJywgdHJ1ZSk7XG4vLyAyNC4zLjMgSlNPTltAQHRvU3RyaW5nVGFnXVxuX3NldFRvU3RyaW5nVGFnKF9nbG9iYWwuSlNPTiwgJ0pTT04nLCB0cnVlKTtcblxuLy8gZ2V0dGluZyB0YWcgZnJvbSAxOS4xLjMuNiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKClcblxudmFyIFRBRyQxID0gX3drcygndG9TdHJpbmdUYWcnKTtcbi8vIEVTMyB3cm9uZyBoZXJlXG52YXIgQVJHID0gX2NvZihmdW5jdGlvbiAoKSB7IHJldHVybiBhcmd1bWVudHM7IH0oKSkgPT0gJ0FyZ3VtZW50cyc7XG5cbi8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yXG52YXIgdHJ5R2V0ID0gZnVuY3Rpb24gKGl0LCBrZXkpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gaXRba2V5XTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG59O1xuXG52YXIgX2NsYXNzb2YgPSBmdW5jdGlvbiAoaXQpIHtcbiAgdmFyIE8sIFQsIEI7XG4gIHJldHVybiBpdCA9PT0gdW5kZWZpbmVkID8gJ1VuZGVmaW5lZCcgOiBpdCA9PT0gbnVsbCA/ICdOdWxsJ1xuICAgIC8vIEBAdG9TdHJpbmdUYWcgY2FzZVxuICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUckMSkpID09ICdzdHJpbmcnID8gVFxuICAgIC8vIGJ1aWx0aW5UYWcgY2FzZVxuICAgIDogQVJHID8gX2NvZihPKVxuICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2tcbiAgICA6IChCID0gX2NvZihPKSkgPT0gJ09iamVjdCcgJiYgdHlwZW9mIE8uY2FsbGVlID09ICdmdW5jdGlvbicgPyAnQXJndW1lbnRzJyA6IEI7XG59O1xuXG4vLyAxOS4xLjMuNiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKClcblxudmFyIHRlc3QgPSB7fTtcbnRlc3RbX3drcygndG9TdHJpbmdUYWcnKV0gPSAneic7XG5pZiAodGVzdCArICcnICE9ICdbb2JqZWN0IHpdJykge1xuICBfcmVkZWZpbmUoT2JqZWN0LnByb3RvdHlwZSwgJ3RvU3RyaW5nJywgZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuICdbb2JqZWN0ICcgKyBfY2xhc3NvZih0aGlzKSArICddJztcbiAgfSwgdHJ1ZSk7XG59XG5cbl93a3NEZWZpbmUoJ2FzeW5jSXRlcmF0b3InKTtcblxuX3drc0RlZmluZSgnb2JzZXJ2YWJsZScpO1xuXG52YXIgc3ltYm9sID0gX2NvcmUuU3ltYm9sO1xuXG4vLyB0cnVlICAtPiBTdHJpbmcjYXRcbi8vIGZhbHNlIC0+IFN0cmluZyNjb2RlUG9pbnRBdFxudmFyIF9zdHJpbmdBdCA9IGZ1bmN0aW9uIChUT19TVFJJTkcpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0aGF0LCBwb3MpIHtcbiAgICB2YXIgcyA9IFN0cmluZyhfZGVmaW5lZCh0aGF0KSk7XG4gICAgdmFyIGkgPSBfdG9JbnRlZ2VyKHBvcyk7XG4gICAgdmFyIGwgPSBzLmxlbmd0aDtcbiAgICB2YXIgYSwgYjtcbiAgICBpZiAoaSA8IDAgfHwgaSA+PSBsKSByZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7XG4gICAgYSA9IHMuY2hhckNvZGVBdChpKTtcbiAgICByZXR1cm4gYSA8IDB4ZDgwMCB8fCBhID4gMHhkYmZmIHx8IGkgKyAxID09PSBsIHx8IChiID0gcy5jaGFyQ29kZUF0KGkgKyAxKSkgPCAweGRjMDAgfHwgYiA+IDB4ZGZmZlxuICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGFcbiAgICAgIDogVE9fU1RSSU5HID8gcy5zbGljZShpLCBpICsgMikgOiAoYSAtIDB4ZDgwMCA8PCAxMCkgKyAoYiAtIDB4ZGMwMCkgKyAweDEwMDAwO1xuICB9O1xufTtcblxudmFyIF9pdGVyYXRvcnMgPSB7fTtcblxudmFyIEl0ZXJhdG9yUHJvdG90eXBlID0ge307XG5cbi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpXG5faGlkZShJdGVyYXRvclByb3RvdHlwZSwgX3drcygnaXRlcmF0b3InKSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSk7XG5cbnZhciBfaXRlckNyZWF0ZSA9IGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCkge1xuICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBfb2JqZWN0Q3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlLCB7IG5leHQ6IF9wcm9wZXJ0eURlc2MoMSwgbmV4dCkgfSk7XG4gIF9zZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTtcbn07XG5cbi8vIDE5LjEuMi45IC8gMTUuMi4zLjIgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pXG5cblxudmFyIElFX1BST1RPJDIgPSBfc2hhcmVkS2V5KCdJRV9QUk9UTycpO1xudmFyIE9iamVjdFByb3RvJDEgPSBPYmplY3QucHJvdG90eXBlO1xuXG52YXIgX29iamVjdEdwbyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiAoTykge1xuICBPID0gX3RvT2JqZWN0KE8pO1xuICBpZiAoX2hhcyhPLCBJRV9QUk9UTyQyKSkgcmV0dXJuIE9bSUVfUFJPVE8kMl07XG4gIGlmICh0eXBlb2YgTy5jb25zdHJ1Y3RvciA9PSAnZnVuY3Rpb24nICYmIE8gaW5zdGFuY2VvZiBPLmNvbnN0cnVjdG9yKSB7XG4gICAgcmV0dXJuIE8uY29uc3RydWN0b3IucHJvdG90eXBlO1xuICB9IHJldHVybiBPIGluc3RhbmNlb2YgT2JqZWN0ID8gT2JqZWN0UHJvdG8kMSA6IG51bGw7XG59O1xuXG52YXIgSVRFUkFUT1IgPSBfd2tzKCdpdGVyYXRvcicpO1xudmFyIEJVR0dZID0gIShbXS5rZXlzICYmICduZXh0JyBpbiBbXS5rZXlzKCkpOyAvLyBTYWZhcmkgaGFzIGJ1Z2d5IGl0ZXJhdG9ycyB3L28gYG5leHRgXG52YXIgRkZfSVRFUkFUT1IgPSAnQEBpdGVyYXRvcic7XG52YXIgS0VZUyA9ICdrZXlzJztcbnZhciBWQUxVRVMgPSAndmFsdWVzJztcblxudmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9O1xuXG52YXIgX2l0ZXJEZWZpbmUgPSBmdW5jdGlvbiAoQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKSB7XG4gIF9pdGVyQ3JlYXRlKENvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KTtcbiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uIChraW5kKSB7XG4gICAgaWYgKCFCVUdHWSAmJiBraW5kIGluIHByb3RvKSByZXR1cm4gcHJvdG9ba2luZF07XG4gICAgc3dpdGNoIChraW5kKSB7XG4gICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCkgeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9O1xuICAgICAgY2FzZSBWQUxVRVM6IHJldHVybiBmdW5jdGlvbiB2YWx1ZXMoKSB7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07XG4gICAgfSByZXR1cm4gZnVuY3Rpb24gZW50cmllcygpIHsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTtcbiAgfTtcbiAgdmFyIFRBRyA9IE5BTUUgKyAnIEl0ZXJhdG9yJztcbiAgdmFyIERFRl9WQUxVRVMgPSBERUZBVUxUID09IFZBTFVFUztcbiAgdmFyIFZBTFVFU19CVUcgPSBmYWxzZTtcbiAgdmFyIHByb3RvID0gQmFzZS5wcm90b3R5cGU7XG4gIHZhciAkbmF0aXZlID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdO1xuICB2YXIgJGRlZmF1bHQgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKTtcbiAgdmFyICRlbnRyaWVzID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZDtcbiAgdmFyICRhbnlOYXRpdmUgPSBOQU1FID09ICdBcnJheScgPyBwcm90by5lbnRyaWVzIHx8ICRuYXRpdmUgOiAkbmF0aXZlO1xuICB2YXIgbWV0aG9kcywga2V5LCBJdGVyYXRvclByb3RvdHlwZTtcbiAgLy8gRml4IG5hdGl2ZVxuICBpZiAoJGFueU5hdGl2ZSkge1xuICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gX29iamVjdEdwbygkYW55TmF0aXZlLmNhbGwobmV3IEJhc2UoKSkpO1xuICAgIGlmIChJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSAmJiBJdGVyYXRvclByb3RvdHlwZS5uZXh0KSB7XG4gICAgICAvLyBTZXQgQEB0b1N0cmluZ1RhZyB0byBuYXRpdmUgaXRlcmF0b3JzXG4gICAgICBfc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7XG4gICAgICAvLyBmaXggZm9yIHNvbWUgb2xkIGVuZ2luZXNcbiAgICAgIGlmICghX2xpYnJhcnkgJiYgdHlwZW9mIEl0ZXJhdG9yUHJvdG90eXBlW0lURVJBVE9SXSAhPSAnZnVuY3Rpb24nKSBfaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpO1xuICAgIH1cbiAgfVxuICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGXG4gIGlmIChERUZfVkFMVUVTICYmICRuYXRpdmUgJiYgJG5hdGl2ZS5uYW1lICE9PSBWQUxVRVMpIHtcbiAgICBWQUxVRVNfQlVHID0gdHJ1ZTtcbiAgICAkZGVmYXVsdCA9IGZ1bmN0aW9uIHZhbHVlcygpIHsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTtcbiAgfVxuICAvLyBEZWZpbmUgaXRlcmF0b3JcbiAgaWYgKCghX2xpYnJhcnkgfHwgRk9SQ0VEKSAmJiAoQlVHR1kgfHwgVkFMVUVTX0JVRyB8fCAhcHJvdG9bSVRFUkFUT1JdKSkge1xuICAgIF9oaWRlKHByb3RvLCBJVEVSQVRPUiwgJGRlZmF1bHQpO1xuICB9XG4gIC8vIFBsdWcgZm9yIGxpYnJhcnlcbiAgX2l0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0O1xuICBfaXRlcmF0b3JzW1RBR10gPSByZXR1cm5UaGlzO1xuICBpZiAoREVGQVVMVCkge1xuICAgIG1ldGhvZHMgPSB7XG4gICAgICB2YWx1ZXM6IERFRl9WQUxVRVMgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChWQUxVRVMpLFxuICAgICAga2V5czogSVNfU0VUID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoS0VZUyksXG4gICAgICBlbnRyaWVzOiAkZW50cmllc1xuICAgIH07XG4gICAgaWYgKEZPUkNFRCkgZm9yIChrZXkgaW4gbWV0aG9kcykge1xuICAgICAgaWYgKCEoa2V5IGluIHByb3RvKSkgX3JlZGVmaW5lKHByb3RvLCBrZXksIG1ldGhvZHNba2V5XSk7XG4gICAgfSBlbHNlIF9leHBvcnQoX2V4cG9ydC5QICsgX2V4cG9ydC5GICogKEJVR0dZIHx8IFZBTFVFU19CVUcpLCBOQU1FLCBtZXRob2RzKTtcbiAgfVxuICByZXR1cm4gbWV0aG9kcztcbn07XG5cbnZhciAkYXQgPSBfc3RyaW5nQXQodHJ1ZSk7XG5cbi8vIDIxLjEuMy4yNyBTdHJpbmcucHJvdG90eXBlW0BAaXRlcmF0b3JdKClcbl9pdGVyRGVmaW5lKFN0cmluZywgJ1N0cmluZycsIGZ1bmN0aW9uIChpdGVyYXRlZCkge1xuICB0aGlzLl90ID0gU3RyaW5nKGl0ZXJhdGVkKTsgLy8gdGFyZ2V0XG4gIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4XG4vLyAyMS4xLjUuMi4xICVTdHJpbmdJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG59LCBmdW5jdGlvbiAoKSB7XG4gIHZhciBPID0gdGhpcy5fdDtcbiAgdmFyIGluZGV4ID0gdGhpcy5faTtcbiAgdmFyIHBvaW50O1xuICBpZiAoaW5kZXggPj0gTy5sZW5ndGgpIHJldHVybiB7IHZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWUgfTtcbiAgcG9pbnQgPSAkYXQoTywgaW5kZXgpO1xuICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDtcbiAgcmV0dXJuIHsgdmFsdWU6IHBvaW50LCBkb25lOiBmYWxzZSB9O1xufSk7XG5cbnZhciBfaXRlclN0ZXAgPSBmdW5jdGlvbiAoZG9uZSwgdmFsdWUpIHtcbiAgcmV0dXJuIHsgdmFsdWU6IHZhbHVlLCBkb25lOiAhIWRvbmUgfTtcbn07XG5cbi8vIDIyLjEuMy40IEFycmF5LnByb3RvdHlwZS5lbnRyaWVzKClcbi8vIDIyLjEuMy4xMyBBcnJheS5wcm90b3R5cGUua2V5cygpXG4vLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpXG4vLyAyMi4xLjMuMzAgQXJyYXkucHJvdG90eXBlW0BAaXRlcmF0b3JdKClcbnZhciBlczZfYXJyYXlfaXRlcmF0b3IgPSBfaXRlckRlZmluZShBcnJheSwgJ0FycmF5JywgZnVuY3Rpb24gKGl0ZXJhdGVkLCBraW5kKSB7XG4gIHRoaXMuX3QgPSBfdG9Jb2JqZWN0KGl0ZXJhdGVkKTsgLy8gdGFyZ2V0XG4gIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4XG4gIHRoaXMuX2sgPSBraW5kOyAgICAgICAgICAgICAgICAvLyBraW5kXG4vLyAyMi4xLjUuMi4xICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KClcbn0sIGZ1bmN0aW9uICgpIHtcbiAgdmFyIE8gPSB0aGlzLl90O1xuICB2YXIga2luZCA9IHRoaXMuX2s7XG4gIHZhciBpbmRleCA9IHRoaXMuX2krKztcbiAgaWYgKCFPIHx8IGluZGV4ID49IE8ubGVuZ3RoKSB7XG4gICAgdGhpcy5fdCA9IHVuZGVmaW5lZDtcbiAgICByZXR1cm4gX2l0ZXJTdGVwKDEpO1xuICB9XG4gIGlmIChraW5kID09ICdrZXlzJykgcmV0dXJuIF9pdGVyU3RlcCgwLCBpbmRleCk7XG4gIGlmIChraW5kID09ICd2YWx1ZXMnKSByZXR1cm4gX2l0ZXJTdGVwKDAsIE9baW5kZXhdKTtcbiAgcmV0dXJuIF9pdGVyU3RlcCgwLCBbaW5kZXgsIE9baW5kZXhdXSk7XG59LCAndmFsdWVzJyk7XG5cbi8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNylcbl9pdGVyYXRvcnMuQXJndW1lbnRzID0gX2l0ZXJhdG9ycy5BcnJheTtcblxuX2FkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTtcbl9hZGRUb1Vuc2NvcGFibGVzKCd2YWx1ZXMnKTtcbl9hZGRUb1Vuc2NvcGFibGVzKCdlbnRyaWVzJyk7XG5cbnZhciBJVEVSQVRPUiQxID0gX3drcygnaXRlcmF0b3InKTtcbnZhciBUT19TVFJJTkdfVEFHID0gX3drcygndG9TdHJpbmdUYWcnKTtcbnZhciBBcnJheVZhbHVlcyA9IF9pdGVyYXRvcnMuQXJyYXk7XG5cbnZhciBET01JdGVyYWJsZXMgPSB7XG4gIENTU1J1bGVMaXN0OiB0cnVlLCAvLyBUT0RPOiBOb3Qgc3BlYyBjb21wbGlhbnQsIHNob3VsZCBiZSBmYWxzZS5cbiAgQ1NTU3R5bGVEZWNsYXJhdGlvbjogZmFsc2UsXG4gIENTU1ZhbHVlTGlzdDogZmFsc2UsXG4gIENsaWVudFJlY3RMaXN0OiBmYWxzZSxcbiAgRE9NUmVjdExpc3Q6IGZhbHNlLFxuICBET01TdHJpbmdMaXN0OiBmYWxzZSxcbiAgRE9NVG9rZW5MaXN0OiB0cnVlLFxuICBEYXRhVHJhbnNmZXJJdGVtTGlzdDogZmFsc2UsXG4gIEZpbGVMaXN0OiBmYWxzZSxcbiAgSFRNTEFsbENvbGxlY3Rpb246IGZhbHNlLFxuICBIVE1MQ29sbGVjdGlvbjogZmFsc2UsXG4gIEhUTUxGb3JtRWxlbWVudDogZmFsc2UsXG4gIEhUTUxTZWxlY3RFbGVtZW50OiBmYWxzZSxcbiAgTWVkaWFMaXN0OiB0cnVlLCAvLyBUT0RPOiBOb3Qgc3BlYyBjb21wbGlhbnQsIHNob3VsZCBiZSBmYWxzZS5cbiAgTWltZVR5cGVBcnJheTogZmFsc2UsXG4gIE5hbWVkTm9kZU1hcDogZmFsc2UsXG4gIE5vZGVMaXN0OiB0cnVlLFxuICBQYWludFJlcXVlc3RMaXN0OiBmYWxzZSxcbiAgUGx1Z2luOiBmYWxzZSxcbiAgUGx1Z2luQXJyYXk6IGZhbHNlLFxuICBTVkdMZW5ndGhMaXN0OiBmYWxzZSxcbiAgU1ZHTnVtYmVyTGlzdDogZmFsc2UsXG4gIFNWR1BhdGhTZWdMaXN0OiBmYWxzZSxcbiAgU1ZHUG9pbnRMaXN0OiBmYWxzZSxcbiAgU1ZHU3RyaW5nTGlzdDogZmFsc2UsXG4gIFNWR1RyYW5zZm9ybUxpc3Q6IGZhbHNlLFxuICBTb3VyY2VCdWZmZXJMaXN0OiBmYWxzZSxcbiAgU3R5bGVTaGVldExpc3Q6IHRydWUsIC8vIFRPRE86IE5vdCBzcGVjIGNvbXBsaWFudCwgc2hvdWxkIGJlIGZhbHNlLlxuICBUZXh0VHJhY2tDdWVMaXN0OiBmYWxzZSxcbiAgVGV4dFRyYWNrTGlzdDogZmFsc2UsXG4gIFRvdWNoTGlzdDogZmFsc2Vcbn07XG5cbmZvciAodmFyIGNvbGxlY3Rpb25zID0gX29iamVjdEtleXMoRE9NSXRlcmFibGVzKSwgaSA9IDA7IGkgPCBjb2xsZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICB2YXIgTkFNRSA9IGNvbGxlY3Rpb25zW2ldO1xuICB2YXIgZXhwbGljaXQgPSBET01JdGVyYWJsZXNbTkFNRV07XG4gIHZhciBDb2xsZWN0aW9uID0gX2dsb2JhbFtOQU1FXTtcbiAgdmFyIHByb3RvID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTtcbiAgdmFyIGtleTtcbiAgaWYgKHByb3RvKSB7XG4gICAgaWYgKCFwcm90b1tJVEVSQVRPUiQxXSkgX2hpZGUocHJvdG8sIElURVJBVE9SJDEsIEFycmF5VmFsdWVzKTtcbiAgICBpZiAoIXByb3RvW1RPX1NUUklOR19UQUddKSBfaGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7XG4gICAgX2l0ZXJhdG9yc1tOQU1FXSA9IEFycmF5VmFsdWVzO1xuICAgIGlmIChleHBsaWNpdCkgZm9yIChrZXkgaW4gZXM2X2FycmF5X2l0ZXJhdG9yKSBpZiAoIXByb3RvW2tleV0pIF9yZWRlZmluZShwcm90bywga2V5LCBlczZfYXJyYXlfaXRlcmF0b3Jba2V5XSwgdHJ1ZSk7XG4gIH1cbn1cblxudmFyIGl0ZXJhdG9yID0gX3drc0V4dC5mKCdpdGVyYXRvcicpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9AZmlyZWJhc2UvcG9seWZpbGwvZGlzdC9pbmRleC5lc20uanNcbi8vIG1vZHVsZSBpZCA9IDM3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcblxudmFyIHRzbGliXzEgPSByZXF1aXJlKCd0c2xpYicpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgRmlyZWJhc2UgY29uc3RhbnRzLiAgU29tZSBvZiB0aGVzZSAoQGRlZmluZXMpIGNhbiBiZSBvdmVycmlkZGVuIGF0IGNvbXBpbGUtdGltZS5cclxuICovXHJcbnZhciBDT05TVEFOVFMgPSB7XHJcbiAgICAvKipcclxuICAgICAqIEBkZWZpbmUge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBpcyB0aGUgY2xpZW50IE5vZGUuanMgU0RLLlxyXG4gICAgICovXHJcbiAgICBOT0RFX0NMSUVOVDogZmFsc2UsXHJcbiAgICAvKipcclxuICAgICAqIEBkZWZpbmUge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBpcyB0aGUgQWRtaW4gTm9kZS5qcyBTREsuXHJcbiAgICAgKi9cclxuICAgIE5PREVfQURNSU46IGZhbHNlLFxyXG4gICAgLyoqXHJcbiAgICAgKiBGaXJlYmFzZSBTREsgVmVyc2lvblxyXG4gICAgICovXHJcbiAgICBTREtfVkVSU0lPTjogJyR7SlNDT1JFX1ZFUlNJT059J1xyXG59O1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgcHJvdmlkZWQgYXNzZXJ0aW9uIGlzIGZhbHN5XHJcbiAqIEBwYXJhbSB7Kn0gYXNzZXJ0aW9uIFRoZSBhc3NlcnRpb24gdG8gYmUgdGVzdGVkIGZvciBmYWxzaW5lc3NcclxuICogQHBhcmFtIHshc3RyaW5nfSBtZXNzYWdlIFRoZSBtZXNzYWdlIHRvIGRpc3BsYXkgaWYgdGhlIGNoZWNrIGZhaWxzXHJcbiAqL1xyXG52YXIgYXNzZXJ0ID0gZnVuY3Rpb24gKGFzc2VydGlvbiwgbWVzc2FnZSkge1xyXG4gICAgaWYgKCFhc3NlcnRpb24pIHtcclxuICAgICAgICB0aHJvdyBhc3NlcnRpb25FcnJvcihtZXNzYWdlKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIFJldHVybnMgYW4gRXJyb3Igb2JqZWN0IHN1aXRhYmxlIGZvciB0aHJvd2luZy5cclxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcclxuICogQHJldHVybiB7IUVycm9yfVxyXG4gKi9cclxudmFyIGFzc2VydGlvbkVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcclxuICAgIHJldHVybiBuZXcgRXJyb3IoJ0ZpcmViYXNlIERhdGFiYXNlICgnICtcclxuICAgICAgICBDT05TVEFOVFMuU0RLX1ZFUlNJT04gK1xyXG4gICAgICAgICcpIElOVEVSTkFMIEFTU0VSVCBGQUlMRUQ6ICcgK1xyXG4gICAgICAgIG1lc3NhZ2UpO1xyXG59O1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIHN0cmluZ1RvQnl0ZUFycmF5ID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgLy8gVE9ETyh1c2VyKTogVXNlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnMgaWYvd2hlbiBhdmFpbGFibGVcclxuICAgIHZhciBvdXQgPSBbXSwgcCA9IDA7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgaWYgKGMgPCAxMjgpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSBjO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgMjA0OCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDYpIHwgMTkyO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgoYyAmIDB4ZmMwMCkgPT0gMHhkODAwICYmXHJcbiAgICAgICAgICAgIGkgKyAxIDwgc3RyLmxlbmd0aCAmJlxyXG4gICAgICAgICAgICAoc3RyLmNoYXJDb2RlQXQoaSArIDEpICYgMHhmYzAwKSA9PSAweGRjMDApIHtcclxuICAgICAgICAgICAgLy8gU3Vycm9nYXRlIFBhaXJcclxuICAgICAgICAgICAgYyA9IDB4MTAwMDAgKyAoKGMgJiAweDAzZmYpIDw8IDEwKSArIChzdHIuY2hhckNvZGVBdCgrK2kpICYgMHgwM2ZmKTtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxOCkgfCAyNDA7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDEyKSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDEyKSB8IDIyNDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dDtcclxufTtcclxuLyoqXHJcbiAqIFR1cm5zIGFuIGFycmF5IG9mIG51bWJlcnMgaW50byB0aGUgc3RyaW5nIGdpdmVuIGJ5IHRoZSBjb25jYXRlbmF0aW9uIG9mIHRoZVxyXG4gKiBjaGFyYWN0ZXJzIHRvIHdoaWNoIHRoZSBudW1iZXJzIGNvcnJlc3BvbmQuXHJcbiAqIEBwYXJhbSB7QXJyYXk8bnVtYmVyPn0gYnl0ZXMgQXJyYXkgb2YgbnVtYmVycyByZXByZXNlbnRpbmcgY2hhcmFjdGVycy5cclxuICogQHJldHVybiB7c3RyaW5nfSBTdHJpbmdpZmljYXRpb24gb2YgdGhlIGFycmF5LlxyXG4gKi9cclxudmFyIGJ5dGVBcnJheVRvU3RyaW5nID0gZnVuY3Rpb24gKGJ5dGVzKSB7XHJcbiAgICAvLyBUT0RPKHVzZXIpOiBVc2UgbmF0aXZlIGltcGxlbWVudGF0aW9ucyBpZi93aGVuIGF2YWlsYWJsZVxyXG4gICAgdmFyIG91dCA9IFtdLCBwb3MgPSAwLCBjID0gMDtcclxuICAgIHdoaWxlIChwb3MgPCBieXRlcy5sZW5ndGgpIHtcclxuICAgICAgICB2YXIgYzEgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgaWYgKGMxIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZShjMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMxID4gMTkxICYmIGMxIDwgMjI0KSB7XHJcbiAgICAgICAgICAgIHZhciBjMiA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzEgJiAzMSkgPDwgNikgfCAoYzIgJiA2MykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjMSA+IDIzOSAmJiBjMSA8IDM2NSkge1xyXG4gICAgICAgICAgICAvLyBTdXJyb2dhdGUgUGFpclxyXG4gICAgICAgICAgICB2YXIgYzIgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIHZhciBjMyA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgdmFyIGM0ID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICB2YXIgdSA9ICgoKGMxICYgNykgPDwgMTgpIHwgKChjMiAmIDYzKSA8PCAxMikgfCAoKGMzICYgNjMpIDw8IDYpIHwgKGM0ICYgNjMpKSAtXHJcbiAgICAgICAgICAgICAgICAweDEwMDAwO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhkODAwICsgKHUgPj4gMTApKTtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ZGMwMCArICh1ICYgMTAyMykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGMyID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICB2YXIgYzMgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgoKGMxICYgMTUpIDw8IDEyKSB8ICgoYzIgJiA2MykgPDwgNikgfCAoYzMgJiA2MykpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvdXQuam9pbignJyk7XHJcbn07XHJcbi8vIFN0YXRpYyBsb29rdXAgbWFwcywgbGF6aWx5IHBvcHVsYXRlZCBieSBpbml0XygpXHJcbnZhciBiYXNlNjQgPSB7XHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgYnl0ZXMgdG8gY2hhcmFjdGVycy5cclxuICAgICAqIEB0eXBlIHtPYmplY3R9XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBieXRlVG9DaGFyTWFwXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBjaGFyYWN0ZXJzIHRvIGJ5dGVzLlxyXG4gICAgICogQHR5cGUge09iamVjdH1cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGNoYXJUb0J5dGVNYXBfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIGJ5dGVzIHRvIHdlYnNhZmUgY2hhcmFjdGVycy5cclxuICAgICAqIEB0eXBlIHtPYmplY3R9XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBieXRlVG9DaGFyTWFwV2ViU2FmZV86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgd2Vic2FmZSBjaGFyYWN0ZXJzIHRvIGJ5dGVzLlxyXG4gICAgICogQHR5cGUge09iamVjdH1cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGNoYXJUb0J5dGVNYXBXZWJTYWZlXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogT3VyIGRlZmF1bHQgYWxwaGFiZXQsIHNoYXJlZCBiZXR3ZWVuXHJcbiAgICAgKiBFTkNPREVEX1ZBTFMgYW5kIEVOQ09ERURfVkFMU19XRUJTQUZFXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICovXHJcbiAgICBFTkNPREVEX1ZBTFNfQkFTRTogJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJyArICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicgKyAnMDEyMzQ1Njc4OScsXHJcbiAgICAvKipcclxuICAgICAqIE91ciBkZWZhdWx0IGFscGhhYmV0LiBWYWx1ZSA2NCAoPSkgaXMgc3BlY2lhbDsgaXQgbWVhbnMgXCJub3RoaW5nLlwiXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICovXHJcbiAgICBnZXQgRU5DT0RFRF9WQUxTKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJysvPSc7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgd2Vic2FmZSBhbHBoYWJldC5cclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIGdldCBFTkNPREVEX1ZBTFNfV0VCU0FGRSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5FTkNPREVEX1ZBTFNfQkFTRSArICctXy4nO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogV2hldGhlciB0aGlzIGJyb3dzZXIgc3VwcG9ydHMgdGhlIGF0b2IgYW5kIGJ0b2EgZnVuY3Rpb25zLiBUaGlzIGV4dGVuc2lvblxyXG4gICAgICogc3RhcnRlZCBhdCBNb3ppbGxhIGJ1dCBpcyBub3cgaW1wbGVtZW50ZWQgYnkgbWFueSBicm93c2Vycy4gV2UgdXNlIHRoZVxyXG4gICAgICogQVNTVU1FXyogdmFyaWFibGVzIHRvIGF2b2lkIHB1bGxpbmcgaW4gdGhlIGZ1bGwgdXNlcmFnZW50IGRldGVjdGlvbiBsaWJyYXJ5XHJcbiAgICAgKiBidXQgc3RpbGwgYWxsb3dpbmcgdGhlIHN0YW5kYXJkIHBlci1icm93c2VyIGNvbXBpbGF0aW9ucy5cclxuICAgICAqXHJcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgSEFTX05BVElWRV9TVVBQT1JUOiB0eXBlb2YgYXRvYiA9PT0gJ2Z1bmN0aW9uJyxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWVuY29kZSBhbiBhcnJheSBvZiBieXRlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0FycmF5PG51bWJlcj58VWludDhBcnJheX0gaW5wdXQgQW4gYXJyYXkgb2YgYnl0ZXMgKG51bWJlcnMgd2l0aFxyXG4gICAgICogICAgIHZhbHVlIGluIFswLCAyNTVdKSB0byBlbmNvZGUuXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfd2ViU2FmZSBCb29sZWFuIGluZGljYXRpbmcgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIGJhc2U2NCBlbmNvZGVkIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgZW5jb2RlQnl0ZUFycmF5OiBmdW5jdGlvbiAoaW5wdXQsIG9wdF93ZWJTYWZlKSB7XHJcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGlucHV0KSkge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcignZW5jb2RlQnl0ZUFycmF5IHRha2VzIGFuIGFycmF5IGFzIGEgcGFyYW1ldGVyJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5pdF8oKTtcclxuICAgICAgICB2YXIgYnl0ZVRvQ2hhck1hcCA9IG9wdF93ZWJTYWZlXHJcbiAgICAgICAgICAgID8gdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV9cclxuICAgICAgICAgICAgOiB0aGlzLmJ5dGVUb0NoYXJNYXBfO1xyXG4gICAgICAgIHZhciBvdXRwdXQgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSArPSAzKSB7XHJcbiAgICAgICAgICAgIHZhciBieXRlMSA9IGlucHV0W2ldO1xyXG4gICAgICAgICAgICB2YXIgaGF2ZUJ5dGUyID0gaSArIDEgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMiA9IGhhdmVCeXRlMiA/IGlucHV0W2kgKyAxXSA6IDA7XHJcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTMgPSBpICsgMiA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgdmFyIGJ5dGUzID0gaGF2ZUJ5dGUzID8gaW5wdXRbaSArIDJdIDogMDtcclxuICAgICAgICAgICAgdmFyIG91dEJ5dGUxID0gYnl0ZTEgPj4gMjtcclxuICAgICAgICAgICAgdmFyIG91dEJ5dGUyID0gKChieXRlMSAmIDB4MDMpIDw8IDQpIHwgKGJ5dGUyID4+IDQpO1xyXG4gICAgICAgICAgICB2YXIgb3V0Qnl0ZTMgPSAoKGJ5dGUyICYgMHgwZikgPDwgMikgfCAoYnl0ZTMgPj4gNik7XHJcbiAgICAgICAgICAgIHZhciBvdXRCeXRlNCA9IGJ5dGUzICYgMHgzZjtcclxuICAgICAgICAgICAgaWYgKCFoYXZlQnl0ZTMpIHtcclxuICAgICAgICAgICAgICAgIG91dEJ5dGU0ID0gNjQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhhdmVCeXRlMikge1xyXG4gICAgICAgICAgICAgICAgICAgIG91dEJ5dGUzID0gNjQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3V0cHV0LnB1c2goYnl0ZVRvQ2hhck1hcFtvdXRCeXRlMV0sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTJdLCBieXRlVG9DaGFyTWFwW291dEJ5dGUzXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlNF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb3V0cHV0LmpvaW4oJycpO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWVuY29kZSBhIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaW5wdXQgQSBzdHJpbmcgdG8gZW5jb2RlLlxyXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3dlYlNhZmUgSWYgdHJ1ZSwgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIGJhc2U2NCBlbmNvZGVkIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgZW5jb2RlU3RyaW5nOiBmdW5jdGlvbiAoaW5wdXQsIG9wdF93ZWJTYWZlKSB7XHJcbiAgICAgICAgLy8gU2hvcnRjdXQgZm9yIE1vemlsbGEgYnJvd3NlcnMgdGhhdCBpbXBsZW1lbnRcclxuICAgICAgICAvLyBhIG5hdGl2ZSBiYXNlNjQgZW5jb2RlciBpbiB0aGUgZm9ybSBvZiBcImJ0b2EvYXRvYlwiXHJcbiAgICAgICAgaWYgKHRoaXMuSEFTX05BVElWRV9TVVBQT1JUICYmICFvcHRfd2ViU2FmZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYnRvYShpbnB1dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmVuY29kZUJ5dGVBcnJheShzdHJpbmdUb0J5dGVBcnJheShpbnB1dCksIG9wdF93ZWJTYWZlKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1kZWNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlucHV0IHRvIGRlY29kZS5cclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF93ZWJTYWZlIFRydWUgaWYgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4ge3N0cmluZ30gc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgZGVjb2RlU3RyaW5nOiBmdW5jdGlvbiAoaW5wdXQsIG9wdF93ZWJTYWZlKSB7XHJcbiAgICAgICAgLy8gU2hvcnRjdXQgZm9yIE1vemlsbGEgYnJvd3NlcnMgdGhhdCBpbXBsZW1lbnRcclxuICAgICAgICAvLyBhIG5hdGl2ZSBiYXNlNjQgZW5jb2RlciBpbiB0aGUgZm9ybSBvZiBcImJ0b2EvYXRvYlwiXHJcbiAgICAgICAgaWYgKHRoaXMuSEFTX05BVElWRV9TVVBQT1JUICYmICFvcHRfd2ViU2FmZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXRvYihpbnB1dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBieXRlQXJyYXlUb1N0cmluZyh0aGlzLmRlY29kZVN0cmluZ1RvQnl0ZUFycmF5KGlucHV0LCBvcHRfd2ViU2FmZSkpO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWRlY29kZSBhIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBJbiBiYXNlLTY0IGRlY29kaW5nLCBncm91cHMgb2YgZm91ciBjaGFyYWN0ZXJzIGFyZSBjb252ZXJ0ZWQgaW50byB0aHJlZVxyXG4gICAgICogYnl0ZXMuICBJZiB0aGUgZW5jb2RlciBkaWQgbm90IGFwcGx5IHBhZGRpbmcsIHRoZSBpbnB1dCBsZW5ndGggbWF5IG5vdFxyXG4gICAgICogYmUgYSBtdWx0aXBsZSBvZiA0LlxyXG4gICAgICpcclxuICAgICAqIEluIHRoaXMgY2FzZSwgdGhlIGxhc3QgZ3JvdXAgd2lsbCBoYXZlIGZld2VyIHRoYW4gNCBjaGFyYWN0ZXJzLCBhbmRcclxuICAgICAqIHBhZGRpbmcgd2lsbCBiZSBpbmZlcnJlZC4gIElmIHRoZSBncm91cCBoYXMgb25lIG9yIHR3byBjaGFyYWN0ZXJzLCBpdCBkZWNvZGVzXHJcbiAgICAgKiB0byBvbmUgYnl0ZS4gIElmIHRoZSBncm91cCBoYXMgdGhyZWUgY2hhcmFjdGVycywgaXQgZGVjb2RlcyB0byB0d28gYnl0ZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlucHV0IElucHV0IHRvIGRlY29kZS5cclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF93ZWJTYWZlIFRydWUgaWYgd2Ugc2hvdWxkIHVzZSB0aGUgd2ViLXNhZmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIHshQXJyYXk8bnVtYmVyPn0gYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSBkZWNvZGVkIHZhbHVlLlxyXG4gICAgICovXHJcbiAgICBkZWNvZGVTdHJpbmdUb0J5dGVBcnJheTogZnVuY3Rpb24gKGlucHV0LCBvcHRfd2ViU2FmZSkge1xyXG4gICAgICAgIHRoaXMuaW5pdF8oKTtcclxuICAgICAgICB2YXIgY2hhclRvQnl0ZU1hcCA9IG9wdF93ZWJTYWZlXHJcbiAgICAgICAgICAgID8gdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV9cclxuICAgICAgICAgICAgOiB0aGlzLmNoYXJUb0J5dGVNYXBfO1xyXG4gICAgICAgIHZhciBvdXRwdXQgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDspIHtcclxuICAgICAgICAgICAgdmFyIGJ5dGUxID0gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSsrKV07XHJcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTIgPSBpIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTIgPSBoYXZlQnl0ZTIgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiAwO1xyXG4gICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTMgPSBpIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTMgPSBoYXZlQnl0ZTMgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiA2NDtcclxuICAgICAgICAgICAgKytpO1xyXG4gICAgICAgICAgICB2YXIgaGF2ZUJ5dGU0ID0gaSA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgdmFyIGJ5dGU0ID0gaGF2ZUJ5dGU0ID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogNjQ7XHJcbiAgICAgICAgICAgICsraTtcclxuICAgICAgICAgICAgaWYgKGJ5dGUxID09IG51bGwgfHwgYnl0ZTIgPT0gbnVsbCB8fCBieXRlMyA9PSBudWxsIHx8IGJ5dGU0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG91dEJ5dGUxID0gKGJ5dGUxIDw8IDIpIHwgKGJ5dGUyID4+IDQpO1xyXG4gICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMSk7XHJcbiAgICAgICAgICAgIGlmIChieXRlMyAhPSA2NCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG91dEJ5dGUyID0gKChieXRlMiA8PCA0KSAmIDB4ZjApIHwgKGJ5dGUzID4+IDIpO1xyXG4gICAgICAgICAgICAgICAgb3V0cHV0LnB1c2gob3V0Qnl0ZTIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGJ5dGU0ICE9IDY0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG91dEJ5dGUzID0gKChieXRlMyA8PCA2KSAmIDB4YzApIHwgYnl0ZTQ7XHJcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2gob3V0Qnl0ZTMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvdXRwdXQ7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBMYXp5IHN0YXRpYyBpbml0aWFsaXphdGlvbiBmdW5jdGlvbi4gQ2FsbGVkIGJlZm9yZVxyXG4gICAgICogYWNjZXNzaW5nIGFueSBvZiB0aGUgc3RhdGljIG1hcCB2YXJpYWJsZXMuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBpbml0XzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5ieXRlVG9DaGFyTWFwXykge1xyXG4gICAgICAgICAgICB0aGlzLmJ5dGVUb0NoYXJNYXBfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF8gPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV8gPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV8gPSB7fTtcclxuICAgICAgICAgICAgLy8gV2Ugd2FudCBxdWljayBtYXBwaW5ncyBiYWNrIGFuZCBmb3J0aCwgc28gd2UgcHJlY29tcHV0ZSB0d28gbWFwcy5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLkVOQ09ERURfVkFMUy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwX1tpXSA9IHRoaXMuRU5DT0RFRF9WQUxTLmNoYXJBdChpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5ieXRlVG9DaGFyTWFwX1tpXV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV9baV0gPSB0aGlzLkVOQ09ERURfVkFMU19XRUJTQUZFLmNoYXJBdChpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfW3RoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfW2ldXSA9IGk7XHJcbiAgICAgICAgICAgICAgICAvLyBCZSBmb3JnaXZpbmcgd2hlbiBkZWNvZGluZyBhbmQgY29ycmVjdGx5IGRlY29kZSBib3RoIGVuY29kaW5ncy5cclxuICAgICAgICAgICAgICAgIGlmIChpID49IHRoaXMuRU5DT0RFRF9WQUxTX0JBU0UubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwX1t0aGlzLkVOQ09ERURfVkFMU19XRUJTQUZFLmNoYXJBdChpKV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfW3RoaXMuRU5DT0RFRF9WQUxTLmNoYXJBdChpKV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogVVJMLXNhZmUgYmFzZTY0IGVuY29kaW5nXHJcbiAqIEBwYXJhbSB7IXN0cmluZ30gc3RyXHJcbiAqIEByZXR1cm4geyFzdHJpbmd9XHJcbiAqL1xyXG52YXIgYmFzZTY0RW5jb2RlID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgdmFyIHV0ZjhCeXRlcyA9IHN0cmluZ1RvQnl0ZUFycmF5KHN0cik7XHJcbiAgICByZXR1cm4gYmFzZTY0LmVuY29kZUJ5dGVBcnJheSh1dGY4Qnl0ZXMsIHRydWUpO1xyXG59O1xyXG4vKipcclxuICogVVJMLXNhZmUgYmFzZTY0IGRlY29kaW5nXHJcbiAqXHJcbiAqIE5PVEU6IERPIE5PVCB1c2UgdGhlIGdsb2JhbCBhdG9iKCkgZnVuY3Rpb24gLSBpdCBkb2VzIE5PVCBzdXBwb3J0IHRoZVxyXG4gKiBiYXNlNjRVcmwgdmFyaWFudCBlbmNvZGluZy5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciBUbyBiZSBkZWNvZGVkXHJcbiAqIEByZXR1cm4gez9zdHJpbmd9IERlY29kZWQgcmVzdWx0LCBpZiBwb3NzaWJsZVxyXG4gKi9cclxudmFyIGJhc2U2NERlY29kZSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIGJhc2U2NC5kZWNvZGVTdHJpbmcoc3RyLCB0cnVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignYmFzZTY0RGVjb2RlIGZhaWxlZDogJywgZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBEbyBhIGRlZXAtY29weSBvZiBiYXNpYyBKYXZhU2NyaXB0IE9iamVjdHMgb3IgQXJyYXlzLlxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcENvcHkodmFsdWUpIHtcclxuICAgIHJldHVybiBkZWVwRXh0ZW5kKHVuZGVmaW5lZCwgdmFsdWUpO1xyXG59XHJcbi8qKlxyXG4gKiBDb3B5IHByb3BlcnRpZXMgZnJvbSBzb3VyY2UgdG8gdGFyZ2V0IChyZWN1cnNpdmVseSBhbGxvd3MgZXh0ZW5zaW9uXHJcbiAqIG9mIE9iamVjdHMgYW5kIEFycmF5cykuICBTY2FsYXIgdmFsdWVzIGluIHRoZSB0YXJnZXQgYXJlIG92ZXItd3JpdHRlbi5cclxuICogSWYgdGFyZ2V0IGlzIHVuZGVmaW5lZCwgYW4gb2JqZWN0IG9mIHRoZSBhcHByb3ByaWF0ZSB0eXBlIHdpbGwgYmUgY3JlYXRlZFxyXG4gKiAoYW5kIHJldHVybmVkKS5cclxuICpcclxuICogV2UgcmVjdXJzaXZlbHkgY29weSBhbGwgY2hpbGQgcHJvcGVydGllcyBvZiBwbGFpbiBPYmplY3RzIGluIHRoZSBzb3VyY2UtIHNvXHJcbiAqIHRoYXQgbmFtZXNwYWNlLSBsaWtlIGRpY3Rpb25hcmllcyBhcmUgbWVyZ2VkLlxyXG4gKlxyXG4gKiBOb3RlIHRoYXQgdGhlIHRhcmdldCBjYW4gYmUgYSBmdW5jdGlvbiwgaW4gd2hpY2ggY2FzZSB0aGUgcHJvcGVydGllcyBpblxyXG4gKiB0aGUgc291cmNlIE9iamVjdCBhcmUgY29waWVkIG9udG8gaXQgYXMgc3RhdGljIHByb3BlcnRpZXMgb2YgdGhlIEZ1bmN0aW9uLlxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcEV4dGVuZCh0YXJnZXQsIHNvdXJjZSkge1xyXG4gICAgaWYgKCEoc291cmNlIGluc3RhbmNlb2YgT2JqZWN0KSkge1xyXG4gICAgICAgIHJldHVybiBzb3VyY2U7XHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKHNvdXJjZS5jb25zdHJ1Y3Rvcikge1xyXG4gICAgICAgIGNhc2UgRGF0ZTpcclxuICAgICAgICAgICAgLy8gVHJlYXQgRGF0ZXMgbGlrZSBzY2FsYXJzOyBpZiB0aGUgdGFyZ2V0IGRhdGUgb2JqZWN0IGhhZCBhbnkgY2hpbGRcclxuICAgICAgICAgICAgLy8gcHJvcGVydGllcyAtIHRoZXkgd2lsbCBiZSBsb3N0IVxyXG4gICAgICAgICAgICB2YXIgZGF0ZVZhbHVlID0gc291cmNlO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZVZhbHVlLmdldFRpbWUoKSk7XHJcbiAgICAgICAgY2FzZSBPYmplY3Q6XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBBcnJheTpcclxuICAgICAgICAgICAgLy8gQWx3YXlzIGNvcHkgdGhlIGFycmF5IHNvdXJjZSBhbmQgb3ZlcndyaXRlIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICAgIHRhcmdldCA9IFtdO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAvLyBOb3QgYSBwbGFpbiBPYmplY3QgLSB0cmVhdCBpdCBhcyBhIHNjYWxhci5cclxuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XHJcbiAgICAgICAgaWYgKCFzb3VyY2UuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhcmdldFtwcm9wXSA9IGRlZXBFeHRlbmQodGFyZ2V0W3Byb3BdLCBzb3VyY2VbcHJvcF0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRhcmdldDtcclxufVxyXG4vLyBUT0RPOiBSZWFsbHkgbmVlZGVkIChmb3IgSlNDb21waWxlciB0eXBlIGNoZWNraW5nKT9cclxuZnVuY3Rpb24gcGF0Y2hQcm9wZXJ0eShvYmosIHByb3AsIHZhbHVlKSB7XHJcbiAgICBvYmpbcHJvcF0gPSB2YWx1ZTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIERlZmVycmVkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVmZXJyZWQoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIF90aGlzLnJlc29sdmUgPSByZXNvbHZlO1xyXG4gICAgICAgICAgICBfdGhpcy5yZWplY3QgPSByZWplY3Q7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE91ciBBUEkgaW50ZXJuYWxzIGFyZSBub3QgcHJvbWlzZWlmaWVkIGFuZCBjYW5ub3QgYmVjYXVzZSBvdXIgY2FsbGJhY2sgQVBJcyBoYXZlIHN1YnRsZSBleHBlY3RhdGlvbnMgYXJvdW5kXHJcbiAgICAgKiBpbnZva2luZyBwcm9taXNlcyBpbmxpbmUsIHdoaWNoIFByb21pc2VzIGFyZSBmb3JiaWRkZW4gdG8gZG8uIFRoaXMgbWV0aG9kIGFjY2VwdHMgYW4gb3B0aW9uYWwgbm9kZS1zdHlsZSBjYWxsYmFja1xyXG4gICAgICogYW5kIHJldHVybnMgYSBub2RlLXN0eWxlIGNhbGxiYWNrIHdoaWNoIHdpbGwgcmVzb2x2ZSBvciByZWplY3QgdGhlIERlZmVycmVkJ3MgcHJvbWlzZS5cclxuICAgICAqIEBwYXJhbSB7KCg/ZnVuY3Rpb24oPyhFcnJvcikpOiAoP3x1bmRlZmluZWQpKXwgKD9mdW5jdGlvbig/KEVycm9yKSw/PSk6ICg/fHVuZGVmaW5lZCkpKT19IGNhbGxiYWNrXHJcbiAgICAgKiBAcmV0dXJuIHshZnVuY3Rpb24oPyhFcnJvciksID89KX1cclxuICAgICAqL1xyXG4gICAgRGVmZXJyZWQucHJvdG90eXBlLndyYXBDYWxsYmFjayA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlcnJvciwgdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgLy8gQXR0YWNoaW5nIG5vb3AgaGFuZGxlciBqdXN0IGluIGNhc2UgZGV2ZWxvcGVyIHdhc24ndCBleHBlY3RpbmdcclxuICAgICAgICAgICAgICAgIC8vIHByb21pc2VzXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5wcm9taXNlLmNhdGNoKGZ1bmN0aW9uICgpIHsgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyBTb21lIG9mIG91ciBjYWxsYmFja3MgZG9uJ3QgZXhwZWN0IGEgdmFsdWUgYW5kIG91ciBvd24gdGVzdHNcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCB0aGF0IHRoZSBwYXJhbWV0ZXIgbGVuZ3RoIGlzIDFcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjay5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvciwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRGVmZXJyZWQ7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyBuYXZpZ2F0b3IudXNlckFnZW50IHN0cmluZyBvciAnJyBpZiBpdCdzIG5vdCBkZWZpbmVkLlxyXG4gKiBAcmV0dXJuIHtzdHJpbmd9IHVzZXIgYWdlbnQgc3RyaW5nXHJcbiAqL1xyXG52YXIgZ2V0VUEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICB0eXBlb2YgbmF2aWdhdG9yWyd1c2VyQWdlbnQnXSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICByZXR1cm4gbmF2aWdhdG9yWyd1c2VyQWdlbnQnXTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIERldGVjdCBDb3Jkb3ZhIC8gUGhvbmVHYXAgLyBJb25pYyBmcmFtZXdvcmtzIG9uIGEgbW9iaWxlIGRldmljZS5cclxuICpcclxuICogRGVsaWJlcmF0ZWx5IGRvZXMgbm90IHJlbHkgb24gY2hlY2tpbmcgYGZpbGU6Ly9gIFVSTHMgKGFzIHRoaXMgZmFpbHMgUGhvbmVHYXAgaW4gdGhlIFJpcHBsZSBlbXVsYXRvcikgbm9yXHJcbiAqIENvcmRvdmEgYG9uRGV2aWNlUmVhZHlgLCB3aGljaCB3b3VsZCBub3JtYWxseSB3YWl0IGZvciBhIGNhbGxiYWNrLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHtib29sZWFufSBpc01vYmlsZUNvcmRvdmFcclxuICovXHJcbnZhciBpc01vYmlsZUNvcmRvdmEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAgICAgISEod2luZG93Wydjb3Jkb3ZhJ10gfHwgd2luZG93WydwaG9uZWdhcCddIHx8IHdpbmRvd1snUGhvbmVHYXAnXSkgJiZcclxuICAgICAgICAvaW9zfGlwaG9uZXxpcG9kfGlwYWR8YW5kcm9pZHxibGFja2JlcnJ5fGllbW9iaWxlL2kudGVzdChnZXRVQSgpKSk7XHJcbn07XHJcbi8qKlxyXG4gKiBEZXRlY3QgUmVhY3QgTmF0aXZlLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIFJlYWN0TmF0aXZlIGVudmlyb25tZW50IGlzIGRldGVjdGVkLlxyXG4gKi9cclxudmFyIGlzUmVhY3ROYXRpdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICdvYmplY3QnICYmIG5hdmlnYXRvclsncHJvZHVjdCddID09PSAnUmVhY3ROYXRpdmUnKTtcclxufTtcclxuLyoqXHJcbiAqIERldGVjdCBOb2RlLmpzLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIE5vZGUuanMgZW52aXJvbm1lbnQgaXMgZGV0ZWN0ZWQuXHJcbiAqL1xyXG52YXIgaXNOb2RlU2RrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIENPTlNUQU5UUy5OT0RFX0NMSUVOVCA9PT0gdHJ1ZSB8fCBDT05TVEFOVFMuTk9ERV9BRE1JTiA9PT0gdHJ1ZTtcclxufTtcblxudmFyIEVSUk9SX05BTUUgPSAnRmlyZWJhc2VFcnJvcic7XHJcbnZhciBjYXB0dXJlU3RhY2tUcmFjZSA9IEVycm9yXHJcbiAgICAuY2FwdHVyZVN0YWNrVHJhY2U7XHJcbi8vIEV4cG9ydCBmb3IgZmFraW5nIGluIHRlc3RzXHJcbmZ1bmN0aW9uIHBhdGNoQ2FwdHVyZShjYXB0dXJlRmFrZSkge1xyXG4gICAgdmFyIHJlc3VsdCA9IGNhcHR1cmVTdGFja1RyYWNlO1xyXG4gICAgY2FwdHVyZVN0YWNrVHJhY2UgPSBjYXB0dXJlRmFrZTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxudmFyIEZpcmViYXNlRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJlYmFzZUVycm9yKGNvZGUsIG1lc3NhZ2UpIHtcclxuICAgICAgICB0aGlzLmNvZGUgPSBjb2RlO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XHJcbiAgICAgICAgLy8gV2Ugd2FudCB0aGUgc3RhY2sgdmFsdWUsIGlmIGltcGxlbWVudGVkIGJ5IEVycm9yXHJcbiAgICAgICAgaWYgKGNhcHR1cmVTdGFja1RyYWNlKSB7XHJcbiAgICAgICAgICAgIC8vIFBhdGNoZXMgdGhpcy5zdGFjaywgb21pdHRlZCBjYWxscyBhYm92ZSBFcnJvckZhY3RvcnkjY3JlYXRlXHJcbiAgICAgICAgICAgIGNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIEVycm9yRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJbiBjYXNlIG9mIElFMTEsIHN0YWNrIHdpbGwgYmUgc2V0IG9ubHkgYWZ0ZXIgZXJyb3IgaXMgcmFpc2VkLlxyXG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvc2NyaXB0aW5nL2phdmFzY3JpcHQvcmVmZXJlbmNlL3N0YWNrLXByb3BlcnR5LWVycm9yLWphdmFzY3JpcHRcclxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gRVJST1JfTkFNRTtcclxuICAgICAgICAgICAgICAgIC8vIE1ha2Ugbm9uLWVudW1lcmFibGUgZ2V0dGVyIGZvciB0aGUgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ3N0YWNrJywge1xyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXJyLnN0YWNrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIEZpcmViYXNlRXJyb3I7XHJcbn0oKSk7XHJcbi8vIEJhY2stZG9vciBpbmhlcml0YW5jZVxyXG5GaXJlYmFzZUVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcclxuRmlyZWJhc2VFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBGaXJlYmFzZUVycm9yO1xyXG5GaXJlYmFzZUVycm9yLnByb3RvdHlwZS5uYW1lID0gRVJST1JfTkFNRTtcclxudmFyIEVycm9yRmFjdG9yeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEVycm9yRmFjdG9yeShzZXJ2aWNlLCBzZXJ2aWNlTmFtZSwgZXJyb3JzKSB7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcclxuICAgICAgICB0aGlzLnNlcnZpY2VOYW1lID0gc2VydmljZU5hbWU7XHJcbiAgICAgICAgdGhpcy5lcnJvcnMgPSBlcnJvcnM7XHJcbiAgICAgICAgLy8gTWF0Y2hlcyB7JG5hbWV9LCBieSBkZWZhdWx0LlxyXG4gICAgICAgIHRoaXMucGF0dGVybiA9IC9cXHtcXCQoW159XSspfS9nO1xyXG4gICAgICAgIC8vIGVtcHR5XHJcbiAgICB9XHJcbiAgICBFcnJvckZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uIChjb2RlLCBkYXRhKSB7XHJcbiAgICAgICAgaWYgKGRhdGEgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBkYXRhID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMuZXJyb3JzW2NvZGVdO1xyXG4gICAgICAgIHZhciBmdWxsQ29kZSA9IHRoaXMuc2VydmljZSArICcvJyArIGNvZGU7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2U7XHJcbiAgICAgICAgaWYgKHRlbXBsYXRlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgbWVzc2FnZSA9ICdFcnJvcic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBtZXNzYWdlID0gdGVtcGxhdGUucmVwbGFjZSh0aGlzLnBhdHRlcm4sIGZ1bmN0aW9uIChtYXRjaCwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBkYXRhW2tleV07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlLnRvU3RyaW5nKCkgOiAnPCcgKyBrZXkgKyAnPz4nO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU2VydmljZTogRXJyb3IgbWVzc2FnZSAoc2VydmljZS9jb2RlKS5cclxuICAgICAgICBtZXNzYWdlID0gdGhpcy5zZXJ2aWNlTmFtZSArICc6ICcgKyBtZXNzYWdlICsgJyAoJyArIGZ1bGxDb2RlICsgJykuJztcclxuICAgICAgICB2YXIgZXJyID0gbmV3IEZpcmViYXNlRXJyb3IoZnVsbENvZGUsIG1lc3NhZ2UpO1xyXG4gICAgICAgIC8vIFBvcHVsYXRlIHRoZSBFcnJvciBvYmplY3Qgd2l0aCBtZXNzYWdlIHBhcnRzIGZvciBwcm9ncmFtbWF0aWNcclxuICAgICAgICAvLyBhY2Nlc3NlcyAoZS5nLiwgZS5maWxlKS5cclxuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKCFkYXRhLmhhc093blByb3BlcnR5KHByb3ApIHx8IHByb3Auc2xpY2UoLTEpID09PSAnXycpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVycltwcm9wXSA9IGRhdGFbcHJvcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBlcnI7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEVycm9yRmFjdG9yeTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBFdmFsdWF0ZXMgYSBKU09OIHN0cmluZyBpbnRvIGEgamF2YXNjcmlwdCBvYmplY3QuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgQSBzdHJpbmcgY29udGFpbmluZyBKU09OLlxyXG4gKiBAcmV0dXJuIHsqfSBUaGUgamF2YXNjcmlwdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzcGVjaWZpZWQgSlNPTi5cclxuICovXHJcbmZ1bmN0aW9uIGpzb25FdmFsKHN0cikge1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBKU09OIHJlcHJlc2VudGluZyBhIGphdmFzY3JpcHQgb2JqZWN0LlxyXG4gKiBAcGFyYW0geyp9IGRhdGEgSmF2YXNjcmlwdCBvYmplY3QgdG8gYmUgc3RyaW5naWZpZWQuXHJcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIEpTT04gY29udGVudHMgb2YgdGhlIG9iamVjdC5cclxuICovXHJcbmZ1bmN0aW9uIHN0cmluZ2lmeShkYXRhKSB7XHJcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gaW50byBjb25zdGl0dWVudCBwYXJ0cy5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiB3aXRoIGludmFsaWQgLyBpbmNvbXBsZXRlIGNsYWltcyBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICpcclxuICogQHBhcmFtIHs/c3RyaW5nfSB0b2tlblxyXG4gKiBAcmV0dXJuIHt7aGVhZGVyOiAqLCBjbGFpbXM6ICosIGRhdGE6ICosIHNpZ25hdHVyZTogc3RyaW5nfX1cclxuICovXHJcbnZhciBkZWNvZGUgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIHZhciBoZWFkZXIgPSB7fSwgY2xhaW1zID0ge30sIGRhdGEgPSB7fSwgc2lnbmF0dXJlID0gJyc7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHZhciBwYXJ0cyA9IHRva2VuLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgaGVhZGVyID0ganNvbkV2YWwoYmFzZTY0RGVjb2RlKHBhcnRzWzBdKSB8fCAnJyk7XHJcbiAgICAgICAgY2xhaW1zID0ganNvbkV2YWwoYmFzZTY0RGVjb2RlKHBhcnRzWzFdKSB8fCAnJyk7XHJcbiAgICAgICAgc2lnbmF0dXJlID0gcGFydHNbMl07XHJcbiAgICAgICAgZGF0YSA9IGNsYWltc1snZCddIHx8IHt9O1xyXG4gICAgICAgIGRlbGV0ZSBjbGFpbXNbJ2QnXTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7IH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaGVhZGVyOiBoZWFkZXIsXHJcbiAgICAgICAgY2xhaW1zOiBjbGFpbXMsXHJcbiAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICBzaWduYXR1cmU6IHNpZ25hdHVyZVxyXG4gICAgfTtcclxufTtcclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBhbmQgY2hlY2tzIHRoZSB2YWxpZGl0eSBvZiBpdHMgdGltZS1iYXNlZCBjbGFpbXMuIFdpbGwgcmV0dXJuIHRydWUgaWYgdGhlXHJcbiAqIHRva2VuIGlzIHdpdGhpbiB0aGUgdGltZSB3aW5kb3cgYXV0aG9yaXplZCBieSB0aGUgJ25iZicgKG5vdC1iZWZvcmUpIGFuZCAnaWF0JyAoaXNzdWVkLWF0KSBjbGFpbXMuXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIE1heSByZXR1cm4gYSBmYWxzZSBuZWdhdGl2ZSBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICpcclxuICogQHBhcmFtIHs/c3RyaW5nfSB0b2tlblxyXG4gKiBAcmV0dXJuIHtib29sZWFufVxyXG4gKi9cclxudmFyIGlzVmFsaWRUaW1lc3RhbXAgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIHZhciBjbGFpbXMgPSBkZWNvZGUodG9rZW4pLmNsYWltcywgbm93ID0gTWF0aC5mbG9vcihuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApLCB2YWxpZFNpbmNlLCB2YWxpZFVudGlsO1xyXG4gICAgaWYgKHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnbmJmJykpIHtcclxuICAgICAgICAgICAgdmFsaWRTaW5jZSA9IGNsYWltc1snbmJmJ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0JykpIHtcclxuICAgICAgICAgICAgdmFsaWRTaW5jZSA9IGNsYWltc1snaWF0J107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2V4cCcpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkVW50aWwgPSBjbGFpbXNbJ2V4cCddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdG9rZW4gd2lsbCBleHBpcmUgYWZ0ZXIgMjRoIGJ5IGRlZmF1bHRcclxuICAgICAgICAgICAgdmFsaWRVbnRpbCA9IHZhbGlkU2luY2UgKyA4NjQwMDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKG5vdyAmJiB2YWxpZFNpbmNlICYmIHZhbGlkVW50aWwgJiYgbm93ID49IHZhbGlkU2luY2UgJiYgbm93IDw9IHZhbGlkVW50aWwpO1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCByZXR1cm5zIGl0cyBpc3N1ZWQgYXQgdGltZSBpZiB2YWxpZCwgbnVsbCBvdGhlcndpc2UuXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIE1heSByZXR1cm4gbnVsbCBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICpcclxuICogQHBhcmFtIHs/c3RyaW5nfSB0b2tlblxyXG4gKiBAcmV0dXJuIHs/bnVtYmVyfVxyXG4gKi9cclxudmFyIGlzc3VlZEF0VGltZSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xyXG4gICAgaWYgKHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0JykpIHtcclxuICAgICAgICByZXR1cm4gY2xhaW1zWydpYXQnXTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCBjaGVja3MgdGhlIHZhbGlkaXR5IG9mIGl0cyBmb3JtYXQuIEV4cGVjdHMgYSB2YWxpZCBpc3N1ZWQtYXQgdGltZS5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKlxyXG4gKiBAcGFyYW0gez9zdHJpbmd9IHRva2VuXHJcbiAqIEByZXR1cm4ge2Jvb2xlYW59XHJcbiAqL1xyXG52YXIgaXNWYWxpZEZvcm1hdCA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGRlY29kZWQgPSBkZWNvZGUodG9rZW4pLCBjbGFpbXMgPSBkZWNvZGVkLmNsYWltcztcclxuICAgIHJldHVybiAhIWNsYWltcyAmJiB0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpO1xyXG59O1xyXG4vKipcclxuICogQXR0ZW1wdHMgdG8gcGVlciBpbnRvIGFuIGF1dGggdG9rZW4gYW5kIGRldGVybWluZSBpZiBpdCdzIGFuIGFkbWluIGF1dGggdG9rZW4gYnkgbG9va2luZyBhdCB0aGUgY2xhaW1zIHBvcnRpb24uXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIE1heSByZXR1cm4gYSBmYWxzZSBuZWdhdGl2ZSBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICpcclxuICogQHBhcmFtIHs/c3RyaW5nfSB0b2tlblxyXG4gKiBAcmV0dXJuIHtib29sZWFufVxyXG4gKi9cclxudmFyIGlzQWRtaW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIHZhciBjbGFpbXMgPSBkZWNvZGUodG9rZW4pLmNsYWltcztcclxuICAgIHJldHVybiB0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXNbJ2FkbWluJ10gPT09IHRydWU7XHJcbn07XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBTZWUgaHR0cDovL3d3dy5kZXZ0aG91Z2h0LmNvbS8yMDEyLzAxLzE4L2FuLW9iamVjdC1pcy1ub3QtYS1oYXNoL1xyXG52YXIgY29udGFpbnMgPSBmdW5jdGlvbiAob2JqLCBrZXkpIHtcclxuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpO1xyXG59O1xyXG52YXIgc2FmZUdldCA9IGZ1bmN0aW9uIChvYmosIGtleSkge1xyXG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpXHJcbiAgICAgICAgcmV0dXJuIG9ialtrZXldO1xyXG4gICAgLy8gZWxzZSByZXR1cm4gdW5kZWZpbmVkLlxyXG59O1xyXG4vKipcclxuICogRW51bWVyYXRlcyB0aGUga2V5cy92YWx1ZXMgaW4gYW4gb2JqZWN0LCBleGNsdWRpbmcga2V5cyBkZWZpbmVkIG9uIHRoZSBwcm90b3R5cGUuXHJcbiAqXHJcbiAqIEBwYXJhbSB7P09iamVjdC48SyxWPn0gb2JqIE9iamVjdCB0byBlbnVtZXJhdGUuXHJcbiAqIEBwYXJhbSB7IWZ1bmN0aW9uKEssIFYpfSBmbiBGdW5jdGlvbiB0byBjYWxsIGZvciBlYWNoIGtleSBhbmQgdmFsdWUuXHJcbiAqIEB0ZW1wbGF0ZSBLLFZcclxuICovXHJcbnZhciBmb3JFYWNoID0gZnVuY3Rpb24gKG9iaiwgZm4pIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICBmbihrZXksIG9ialtrZXldKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBDb3BpZXMgYWxsIHRoZSAob3duKSBwcm9wZXJ0aWVzIGZyb20gb25lIG9iamVjdCB0byBhbm90aGVyLlxyXG4gKiBAcGFyYW0geyFPYmplY3R9IG9ialRvXHJcbiAqIEBwYXJhbSB7IU9iamVjdH0gb2JqRnJvbVxyXG4gKiBAcmV0dXJuIHshT2JqZWN0fSBvYmpUb1xyXG4gKi9cclxudmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChvYmpUbywgb2JqRnJvbSkge1xyXG4gICAgZm9yRWFjaChvYmpGcm9tLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIG9ialRvW2tleV0gPSB2YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIG9ialRvO1xyXG59O1xyXG4vKipcclxuICogUmV0dXJucyBhIGNsb25lIG9mIHRoZSBzcGVjaWZpZWQgb2JqZWN0LlxyXG4gKiBAcGFyYW0geyFPYmplY3R9IG9ialxyXG4gKiBAcmV0dXJuIHshT2JqZWN0fSBjbG9uZWQgb2JqLlxyXG4gKi9cclxudmFyIGNsb25lID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgcmV0dXJuIGV4dGVuZCh7fSwgb2JqKTtcclxufTtcclxuLyoqXHJcbiAqIFJldHVybnMgdHJ1ZSBpZiBvYmogaGFzIHR5cGVvZiBcIm9iamVjdFwiIGFuZCBpcyBub3QgbnVsbC4gIFVubGlrZSBnb29nLmlzT2JqZWN0KCksIGRvZXMgbm90IHJldHVybiB0cnVlXHJcbiAqIGZvciBmdW5jdGlvbnMuXHJcbiAqXHJcbiAqIEBwYXJhbSBvYmogeyp9IEEgcG90ZW50aWFsIG9iamVjdC5cclxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgaXQncyBhbiBvYmplY3QuXHJcbiAqL1xyXG52YXIgaXNOb25OdWxsT2JqZWN0ID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIG9iaiAhPT0gbnVsbDtcclxufTtcclxudmFyIGlzRW1wdHkgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn07XHJcbnZhciBnZXRDb3VudCA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgIHZhciBydiA9IDA7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgcnYrKztcclxuICAgIH1cclxuICAgIHJldHVybiBydjtcclxufTtcclxudmFyIG1hcCA9IGZ1bmN0aW9uIChvYmosIGYsIG9wdF9vYmopIHtcclxuICAgIHZhciByZXMgPSB7fTtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICByZXNba2V5XSA9IGYuY2FsbChvcHRfb2JqLCBvYmpba2V5XSwga2V5LCBvYmopO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcztcclxufTtcclxudmFyIGZpbmRLZXkgPSBmdW5jdGlvbiAob2JqLCBmbiwgb3B0X3RoaXMpIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoZm4uY2FsbChvcHRfdGhpcywgb2JqW2tleV0sIGtleSwgb2JqKSkge1xyXG4gICAgICAgICAgICByZXR1cm4ga2V5O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbn07XHJcbnZhciBmaW5kVmFsdWUgPSBmdW5jdGlvbiAob2JqLCBmbiwgb3B0X3RoaXMpIHtcclxuICAgIHZhciBrZXkgPSBmaW5kS2V5KG9iaiwgZm4sIG9wdF90aGlzKTtcclxuICAgIHJldHVybiBrZXkgJiYgb2JqW2tleV07XHJcbn07XHJcbnZhciBnZXRBbnlLZXkgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIGtleTtcclxuICAgIH1cclxufTtcclxudmFyIGdldFZhbHVlcyA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgIHZhciByZXMgPSBbXTtcclxuICAgIHZhciBpID0gMDtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICByZXNbaSsrXSA9IG9ialtrZXldO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcztcclxufTtcclxuLyoqXHJcbiAqIFRlc3RzIHdoZXRoZXIgZXZlcnkga2V5L3ZhbHVlIHBhaXIgaW4gYW4gb2JqZWN0IHBhc3MgdGhlIHRlc3QgaW1wbGVtZW50ZWRcclxuICogYnkgdGhlIHByb3ZpZGVkIGZ1bmN0aW9uXHJcbiAqXHJcbiAqIEBwYXJhbSB7P09iamVjdC48SyxWPn0gb2JqIE9iamVjdCB0byB0ZXN0LlxyXG4gKiBAcGFyYW0geyFmdW5jdGlvbihLLCBWKX0gZm4gRnVuY3Rpb24gdG8gY2FsbCBmb3IgZWFjaCBrZXkgYW5kIHZhbHVlLlxyXG4gKiBAdGVtcGxhdGUgSyxWXHJcbiAqL1xyXG52YXIgZXZlcnkgPSBmdW5jdGlvbiAob2JqLCBmbikge1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIGlmICghZm4oa2V5LCBvYmpba2V5XSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59O1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFJldHVybnMgYSBxdWVyeXN0cmluZy1mb3JtYXR0ZWQgc3RyaW5nIChlLmcuICZhcmc9dmFsJmFyZzI9dmFsMikgZnJvbSBhIHBhcmFtc1xyXG4gKiBvYmplY3QgKGUuZy4ge2FyZzogJ3ZhbCcsIGFyZzI6ICd2YWwyJ30pXHJcbiAqIE5vdGU6IFlvdSBtdXN0IHByZXBlbmQgaXQgd2l0aCA/IHdoZW4gYWRkaW5nIGl0IHRvIGEgVVJMLlxyXG4gKlxyXG4gKiBAcGFyYW0geyFPYmplY3R9IHF1ZXJ5c3RyaW5nUGFyYW1zXHJcbiAqIEByZXR1cm4ge3N0cmluZ31cclxuICovXHJcbnZhciBxdWVyeXN0cmluZyA9IGZ1bmN0aW9uIChxdWVyeXN0cmluZ1BhcmFtcykge1xyXG4gICAgdmFyIHBhcmFtcyA9IFtdO1xyXG4gICAgZm9yRWFjaChxdWVyeXN0cmluZ1BhcmFtcywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgdmFsdWUuZm9yRWFjaChmdW5jdGlvbiAoYXJyYXlWYWwpIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtcy5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGFycmF5VmFsKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcGFyYW1zLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwYXJhbXMubGVuZ3RoID8gJyYnICsgcGFyYW1zLmpvaW4oJyYnKSA6ICcnO1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIHF1ZXJ5c3RyaW5nIChlLmcuID9hcmc9dmFsJmFyZzI9dmFsMikgaW50byBhIHBhcmFtcyBvYmplY3QgKGUuZy4ge2FyZzogJ3ZhbCcsIGFyZzI6ICd2YWwyJ30pXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBxdWVyeXN0cmluZ1xyXG4gKiBAcmV0dXJuIHshT2JqZWN0fVxyXG4gKi9cclxudmFyIHF1ZXJ5c3RyaW5nRGVjb2RlID0gZnVuY3Rpb24gKHF1ZXJ5c3RyaW5nKSB7XHJcbiAgICB2YXIgb2JqID0ge307XHJcbiAgICB2YXIgdG9rZW5zID0gcXVlcnlzdHJpbmcucmVwbGFjZSgvXlxcPy8sICcnKS5zcGxpdCgnJicpO1xyXG4gICAgdG9rZW5zLmZvckVhY2goZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSB0b2tlbi5zcGxpdCgnPScpO1xyXG4gICAgICAgICAgICBvYmpba2V5WzBdXSA9IGtleVsxXTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBvYmo7XHJcbn07XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBDb3B5cmlnaHQgMjAxMSBUaGUgQ2xvc3VyZSBMaWJyYXJ5IEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbi8vXHJcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbi8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbi8vXHJcbi8vICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbi8vXHJcbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxyXG4vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgQWJzdHJhY3QgY3J5cHRvZ3JhcGhpYyBoYXNoIGludGVyZmFjZS5cclxuICpcclxuICogU2VlIFNoYTEgYW5kIE1kNSBmb3Igc2FtcGxlIGltcGxlbWVudGF0aW9ucy5cclxuICpcclxuICovXHJcbi8qKlxyXG4gKiBDcmVhdGUgYSBjcnlwdG9ncmFwaGljIGhhc2ggaW5zdGFuY2UuXHJcbiAqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAc3RydWN0XHJcbiAqL1xyXG52YXIgSGFzaCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEhhc2goKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGJsb2NrIHNpemUgZm9yIHRoZSBoYXNoZXIuXHJcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmJsb2NrU2l6ZSA9IC0xO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEhhc2g7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBTSEEtMSBjcnlwdG9ncmFwaGljIGhhc2guXHJcbiAqIFZhcmlhYmxlIG5hbWVzIGZvbGxvdyB0aGUgbm90YXRpb24gaW4gRklQUyBQVUIgMTgwLTM6XHJcbiAqIGh0dHA6Ly9jc3JjLm5pc3QuZ292L3B1YmxpY2F0aW9ucy9maXBzL2ZpcHMxODAtMy9maXBzMTgwLTNfZmluYWwucGRmLlxyXG4gKlxyXG4gKiBVc2FnZTpcclxuICogICB2YXIgc2hhMSA9IG5ldyBzaGExKCk7XHJcbiAqICAgc2hhMS51cGRhdGUoYnl0ZXMpO1xyXG4gKiAgIHZhciBoYXNoID0gc2hhMS5kaWdlc3QoKTtcclxuICpcclxuICogUGVyZm9ybWFuY2U6XHJcbiAqICAgQ2hyb21lIDIzOiAgIH40MDAgTWJpdC9zXHJcbiAqICAgRmlyZWZveCAxNjogIH4yNTAgTWJpdC9zXHJcbiAqXHJcbiAqL1xyXG4vKipcclxuICogU0hBLTEgY3J5cHRvZ3JhcGhpYyBoYXNoIGNvbnN0cnVjdG9yLlxyXG4gKlxyXG4gKiBUaGUgcHJvcGVydGllcyBkZWNsYXJlZCBoZXJlIGFyZSBkaXNjdXNzZWQgaW4gdGhlIGFib3ZlIGFsZ29yaXRobSBkb2N1bWVudC5cclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIHtIYXNofVxyXG4gKiBAZmluYWxcclxuICogQHN0cnVjdFxyXG4gKi9cclxudmFyIFNoYTEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTaGExLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU2hhMSgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEhvbGRzIHRoZSBwcmV2aW91cyB2YWx1ZXMgb2YgYWNjdW11bGF0ZWQgdmFyaWFibGVzIGEtZSBpbiB0aGUgY29tcHJlc3NfXHJcbiAgICAgICAgICogZnVuY3Rpb24uXHJcbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMuY2hhaW5fID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBidWZmZXIgaG9sZGluZyB0aGUgcGFydGlhbGx5IGNvbXB1dGVkIGhhc2ggcmVzdWx0LlxyXG4gICAgICAgICAqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLmJ1Zl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbiBhcnJheSBvZiA4MCBieXRlcywgZWFjaCBhIHBhcnQgb2YgdGhlIG1lc3NhZ2UgdG8gYmUgaGFzaGVkLiAgUmVmZXJyZWQgdG9cclxuICAgICAgICAgKiBhcyB0aGUgbWVzc2FnZSBzY2hlZHVsZSBpbiB0aGUgZG9jcy5cclxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5XXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvbnRhaW5zIGRhdGEgbmVlZGVkIHRvIHBhZCBtZXNzYWdlcyBsZXNzIHRoYW4gNjQgYnl0ZXMuXHJcbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMucGFkXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlIHtudW1iZXJ9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMuaW5idWZfID0gMDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLnRvdGFsXyA9IDA7XHJcbiAgICAgICAgX3RoaXMuYmxvY2tTaXplID0gNTEyIC8gODtcclxuICAgICAgICBfdGhpcy5wYWRfWzBdID0gMTI4O1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgX3RoaXMuYmxvY2tTaXplOyArK2kpIHtcclxuICAgICAgICAgICAgX3RoaXMucGFkX1tpXSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF90aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgU2hhMS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAweDY3NDUyMzAxO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzFdID0gMHhlZmNkYWI4OTtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9IDB4OThiYWRjZmU7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAweDEwMzI1NDc2O1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzRdID0gMHhjM2QyZTFmMDtcclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gPSAwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW50ZXJuYWwgY29tcHJlc3MgaGVscGVyIGZ1bmN0aW9uLlxyXG4gICAgICogQHBhcmFtIHshQXJyYXk8bnVtYmVyPnwhVWludDhBcnJheXxzdHJpbmd9IGJ1ZiBCbG9jayB0byBjb21wcmVzcy5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X29mZnNldCBPZmZzZXQgb2YgdGhlIGJsb2NrIGluIHRoZSBidWZmZXIuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBTaGExLnByb3RvdHlwZS5jb21wcmVzc18gPSBmdW5jdGlvbiAoYnVmLCBvcHRfb2Zmc2V0KSB7XHJcbiAgICAgICAgaWYgKCFvcHRfb2Zmc2V0KSB7XHJcbiAgICAgICAgICAgIG9wdF9vZmZzZXQgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgVyA9IHRoaXMuV187XHJcbiAgICAgICAgLy8gZ2V0IDE2IGJpZyBlbmRpYW4gd29yZHNcclxuICAgICAgICBpZiAodHlwZW9mIGJ1ZiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKHVzZXIpOiBbYnVnIDgxNDAxMjJdIFJlY2VudCB2ZXJzaW9ucyBvZiBTYWZhcmkgZm9yIE1hYyBPUyBhbmQgaU9TXHJcbiAgICAgICAgICAgICAgICAvLyBoYXZlIGEgYnVnIHRoYXQgdHVybnMgdGhlIHBvc3QtaW5jcmVtZW50ICsrIG9wZXJhdG9yIGludG8gcHJlLWluY3JlbWVudFxyXG4gICAgICAgICAgICAgICAgLy8gZHVyaW5nIEpJVCBjb21waWxhdGlvbi4gIFdlIGhhdmUgY29kZSB0aGF0IGRlcGVuZHMgaGVhdmlseSBvbiBTSEEtMSBmb3JcclxuICAgICAgICAgICAgICAgIC8vIGNvcnJlY3RuZXNzIGFuZCB3aGljaCBpcyBhZmZlY3RlZCBieSB0aGlzIGJ1Zywgc28gSSd2ZSByZW1vdmVkIGFsbCB1c2VzXHJcbiAgICAgICAgICAgICAgICAvLyBvZiBwb3N0LWluY3JlbWVudCArKyBpbiB3aGljaCB0aGUgcmVzdWx0IHZhbHVlIGlzIHVzZWQuICBXZSBjYW4gcmV2ZXJ0XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzIGNoYW5nZSBvbmNlIHRoZSBTYWZhcmkgYnVnXHJcbiAgICAgICAgICAgICAgICAvLyAoaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTEwOTAzNikgaGFzIGJlZW4gZml4ZWQgYW5kXHJcbiAgICAgICAgICAgICAgICAvLyBtb3N0IGNsaWVudHMgaGF2ZSBiZWVuIHVwZGF0ZWQuXHJcbiAgICAgICAgICAgICAgICBXW2ldID1cclxuICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCkgPDwgMjQpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQgKyAxKSA8PCAxNikgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCArIDIpIDw8IDgpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCArIDMpO1xyXG4gICAgICAgICAgICAgICAgb3B0X29mZnNldCArPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIFdbaV0gPVxyXG4gICAgICAgICAgICAgICAgICAgIChidWZbb3B0X29mZnNldF0gPDwgMjQpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvcHRfb2Zmc2V0ICsgMV0gPDwgMTYpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvcHRfb2Zmc2V0ICsgMl0gPDwgOCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWZbb3B0X29mZnNldCArIDNdO1xyXG4gICAgICAgICAgICAgICAgb3B0X29mZnNldCArPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGV4cGFuZCB0byA4MCB3b3Jkc1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAxNjsgaSA8IDgwOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHQgPSBXW2kgLSAzXSBeIFdbaSAtIDhdIF4gV1tpIC0gMTRdIF4gV1tpIC0gMTZdO1xyXG4gICAgICAgICAgICBXW2ldID0gKCh0IDw8IDEpIHwgKHQgPj4+IDMxKSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYSA9IHRoaXMuY2hhaW5fWzBdO1xyXG4gICAgICAgIHZhciBiID0gdGhpcy5jaGFpbl9bMV07XHJcbiAgICAgICAgdmFyIGMgPSB0aGlzLmNoYWluX1syXTtcclxuICAgICAgICB2YXIgZCA9IHRoaXMuY2hhaW5fWzNdO1xyXG4gICAgICAgIHZhciBlID0gdGhpcy5jaGFpbl9bNF07XHJcbiAgICAgICAgdmFyIGYsIGs7XHJcbiAgICAgICAgLy8gVE9ETyh1c2VyKTogVHJ5IHRvIHVucm9sbCB0aGlzIGxvb3AgdG8gc3BlZWQgdXAgdGhlIGNvbXB1dGF0aW9uLlxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgODA7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaSA8IDQwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGQgXiAoYiAmIChjIF4gZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDVhODI3OTk5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGIgXiBjIF4gZDtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg2ZWQ5ZWJhMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgNjApIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gKGIgJiBjKSB8IChkICYgKGIgfCBjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4OGYxYmJjZGM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweGNhNjJjMWQ2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0ID0gKCgoYSA8PCA1KSB8IChhID4+PiAyNykpICsgZiArIGUgKyBrICsgV1tpXSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgICAgICBlID0gZDtcclxuICAgICAgICAgICAgZCA9IGM7XHJcbiAgICAgICAgICAgIGMgPSAoKGIgPDwgMzApIHwgKGIgPj4+IDIpKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgICAgIGIgPSBhO1xyXG4gICAgICAgICAgICBhID0gdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAodGhpcy5jaGFpbl9bMF0gKyBhKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMV0gPSAodGhpcy5jaGFpbl9bMV0gKyBiKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMl0gPSAodGhpcy5jaGFpbl9bMl0gKyBjKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAodGhpcy5jaGFpbl9bM10gKyBkKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bNF0gPSAodGhpcy5jaGFpbl9bNF0gKyBlKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICB9O1xyXG4gICAgU2hhMS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGJ5dGVzLCBvcHRfbGVuZ3RoKSB7XHJcbiAgICAgICAgLy8gVE9ETyhqb2hubGVueik6IHRpZ2h0ZW4gdGhlIGZ1bmN0aW9uIHNpZ25hdHVyZSBhbmQgcmVtb3ZlIHRoaXMgY2hlY2tcclxuICAgICAgICBpZiAoYnl0ZXMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvcHRfbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgb3B0X2xlbmd0aCA9IGJ5dGVzLmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGxlbmd0aE1pbnVzQmxvY2sgPSBvcHRfbGVuZ3RoIC0gdGhpcy5ibG9ja1NpemU7XHJcbiAgICAgICAgdmFyIG4gPSAwO1xyXG4gICAgICAgIC8vIFVzaW5nIGxvY2FsIGluc3RlYWQgb2YgbWVtYmVyIHZhcmlhYmxlcyBnaXZlcyB+NSUgc3BlZWR1cCBvbiBGaXJlZm94IDE2LlxyXG4gICAgICAgIHZhciBidWYgPSB0aGlzLmJ1Zl87XHJcbiAgICAgICAgdmFyIGluYnVmID0gdGhpcy5pbmJ1Zl87XHJcbiAgICAgICAgLy8gVGhlIG91dGVyIHdoaWxlIGxvb3Agc2hvdWxkIGV4ZWN1dGUgYXQgbW9zdCB0d2ljZS5cclxuICAgICAgICB3aGlsZSAobiA8IG9wdF9sZW5ndGgpIHtcclxuICAgICAgICAgICAgLy8gV2hlbiB3ZSBoYXZlIG5vIGRhdGEgaW4gdGhlIGJsb2NrIHRvIHRvcCB1cCwgd2UgY2FuIGRpcmVjdGx5IHByb2Nlc3MgdGhlXHJcbiAgICAgICAgICAgIC8vIGlucHV0IGJ1ZmZlciAoYXNzdW1pbmcgaXQgY29udGFpbnMgc3VmZmljaWVudCBkYXRhKS4gVGhpcyBnaXZlcyB+MjUlXHJcbiAgICAgICAgICAgIC8vIHNwZWVkdXAgb24gQ2hyb21lIDIzIGFuZCB+MTUlIHNwZWVkdXAgb24gRmlyZWZveCAxNiwgYnV0IHJlcXVpcmVzIHRoYXRcclxuICAgICAgICAgICAgLy8gdGhlIGRhdGEgaXMgcHJvdmlkZWQgaW4gbGFyZ2UgY2h1bmtzIChvciBpbiBtdWx0aXBsZXMgb2YgNjQgYnl0ZXMpLlxyXG4gICAgICAgICAgICBpZiAoaW5idWYgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPD0gbGVuZ3RoTWludXNCbG9jaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ5dGVzLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBuICs9IHRoaXMuYmxvY2tTaXplO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYnl0ZXMgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IG9wdF9sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBidWZbaW5idWZdID0gYnl0ZXMuY2hhckNvZGVBdChuKTtcclxuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xyXG4gICAgICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5idWYgPT0gdGhpcy5ibG9ja1NpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnVmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5idWYgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBKdW1wIHRvIHRoZSBvdXRlciBsb29wIHNvIHdlIHVzZSB0aGUgZnVsbC1ibG9jayBvcHRpbWl6YXRpb24uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDwgb3B0X2xlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1ZltpbmJ1Zl0gPSBieXRlc1tuXTtcclxuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xyXG4gICAgICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5idWYgPT0gdGhpcy5ibG9ja1NpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnVmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5idWYgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBKdW1wIHRvIHRoZSBvdXRlciBsb29wIHNvIHdlIHVzZSB0aGUgZnVsbC1ibG9jayBvcHRpbWl6YXRpb24uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmluYnVmXyA9IGluYnVmO1xyXG4gICAgICAgIHRoaXMudG90YWxfICs9IG9wdF9sZW5ndGg7XHJcbiAgICB9O1xyXG4gICAgLyoqIEBvdmVycmlkZSAqL1xyXG4gICAgU2hhMS5wcm90b3R5cGUuZGlnZXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBkaWdlc3QgPSBbXTtcclxuICAgICAgICB2YXIgdG90YWxCaXRzID0gdGhpcy50b3RhbF8gKiA4O1xyXG4gICAgICAgIC8vIEFkZCBwYWQgMHg4MCAweDAwKi5cclxuICAgICAgICBpZiAodGhpcy5pbmJ1Zl8gPCA1Nikge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSh0aGlzLnBhZF8sIDU2IC0gdGhpcy5pbmJ1Zl8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCB0aGlzLmJsb2NrU2l6ZSAtICh0aGlzLmluYnVmXyAtIDU2KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEFkZCAjIGJpdHMuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuYmxvY2tTaXplIC0gMTsgaSA+PSA1NjsgaS0tKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnVmX1tpXSA9IHRvdGFsQml0cyAmIDI1NTtcclxuICAgICAgICAgICAgdG90YWxCaXRzIC89IDI1NjsgLy8gRG9uJ3QgdXNlIGJpdC1zaGlmdGluZyBoZXJlIVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbXByZXNzXyh0aGlzLmJ1Zl8pO1xyXG4gICAgICAgIHZhciBuID0gMDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMjQ7IGogPj0gMDsgaiAtPSA4KSB7XHJcbiAgICAgICAgICAgICAgICBkaWdlc3Rbbl0gPSAodGhpcy5jaGFpbl9baV0gPj4gaikgJiAyNTU7XHJcbiAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRpZ2VzdDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU2hhMTtcclxufShIYXNoKSk7XG5cbi8qKlxyXG4gKiBIZWxwZXIgdG8gbWFrZSBhIFN1YnNjcmliZSBmdW5jdGlvbiAoanVzdCBsaWtlIFByb21pc2UgaGVscHMgbWFrZSBhXHJcbiAqIFRoZW5hYmxlKS5cclxuICpcclxuICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXHJcbiAqICAgICBhcyBhIHByb3h5LlxyXG4gKiBAcGFyYW0gb25Ob09ic2VydmVycyBDYWxsYmFjayB3aGVuIGNvdW50IG9mIE9ic2VydmVycyBnb2VzIHRvIHplcm8uXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVTdWJzY3JpYmUoZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpIHtcclxuICAgIHZhciBwcm94eSA9IG5ldyBPYnNlcnZlclByb3h5KGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKTtcclxuICAgIHJldHVybiBwcm94eS5zdWJzY3JpYmUuYmluZChwcm94eSk7XHJcbn1cclxuLyoqXHJcbiAqIEltcGxlbWVudCBmYW4tb3V0IGZvciBhbnkgbnVtYmVyIG9mIE9ic2VydmVycyBhdHRhY2hlZCB2aWEgYSBzdWJzY3JpYmVcclxuICogZnVuY3Rpb24uXHJcbiAqL1xyXG52YXIgT2JzZXJ2ZXJQcm94eSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXHJcbiAgICAgKiAgICAgYXMgYSBwcm94eS5cclxuICAgICAqIEBwYXJhbSBvbk5vT2JzZXJ2ZXJzIENhbGxiYWNrIHdoZW4gY291bnQgb2YgT2JzZXJ2ZXJzIGdvZXMgdG8gemVyby5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gT2JzZXJ2ZXJQcm94eShleGVjdXRvciwgb25Ob09ic2VydmVycykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCA9IDA7XHJcbiAgICAgICAgLy8gTWljcm8tdGFzayBzY2hlZHVsaW5nIGJ5IGNhbGxpbmcgdGFzay50aGVuKCkuXHJcbiAgICAgICAgdGhpcy50YXNrID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgdGhpcy5maW5hbGl6ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnMgPSBvbk5vT2JzZXJ2ZXJzO1xyXG4gICAgICAgIC8vIENhbGwgdGhlIGV4ZWN1dG9yIGFzeW5jaHJvbm91c2x5IHNvIHN1YnNjcmliZXJzIHRoYXQgYXJlIGNhbGxlZFxyXG4gICAgICAgIC8vIHN5bmNocm9ub3VzbHkgYWZ0ZXIgdGhlIGNyZWF0aW9uIG9mIHRoZSBzdWJzY3JpYmUgZnVuY3Rpb25cclxuICAgICAgICAvLyBjYW4gc3RpbGwgcmVjZWl2ZSB0aGUgdmVyeSBmaXJzdCB2YWx1ZSBnZW5lcmF0ZWQgaW4gdGhlIGV4ZWN1dG9yLlxyXG4gICAgICAgIHRoaXMudGFza1xyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGV4ZWN1dG9yKF90aGlzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgX3RoaXMuZXJyb3IoZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQodmFsdWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNsb3NlKGVycm9yKTtcclxuICAgIH07XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTdWJzY3JpYmUgZnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgYW4gT2JzZXJ2ZXIgdG8gdGhlIGZhbi1vdXQgbGlzdC5cclxuICAgICAqXHJcbiAgICAgKiAtIFdlIHJlcXVpcmUgdGhhdCBubyBldmVudCBpcyBzZW50IHRvIGEgc3Vic2NyaWJlciBzeWNocm9ub3VzbHkgdG8gdGhlaXJcclxuICAgICAqICAgY2FsbCB0byBzdWJzY3JpYmUoKS5cclxuICAgICAqL1xyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvYnNlcnZlcjtcclxuICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXIgPT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICBlcnJvciA9PT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgIGNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIE9ic2VydmVyLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBc3NlbWJsZSBhbiBPYnNlcnZlciBvYmplY3Qgd2hlbiBwYXNzZWQgYXMgY2FsbGJhY2sgZnVuY3Rpb25zLlxyXG4gICAgICAgIGlmIChpbXBsZW1lbnRzQW55TWV0aG9kcyhuZXh0T3JPYnNlcnZlciwgWyduZXh0JywgJ2Vycm9yJywgJ2NvbXBsZXRlJ10pKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyID0gbmV4dE9yT2JzZXJ2ZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IHtcclxuICAgICAgICAgICAgICAgIG5leHQ6IG5leHRPck9ic2VydmVyLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLFxyXG4gICAgICAgICAgICAgICAgY29tcGxldGU6IGNvbXBsZXRlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvYnNlcnZlci5uZXh0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCA9IG5vb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvYnNlcnZlci5lcnJvciA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmVycm9yID0gbm9vcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9ic2VydmVyLmNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUgPSBub29wO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdW5zdWIgPSB0aGlzLnVuc3Vic2NyaWJlT25lLmJpbmQodGhpcywgdGhpcy5vYnNlcnZlcnMubGVuZ3RoKTtcclxuICAgICAgICAvLyBBdHRlbXB0IHRvIHN1YnNjcmliZSB0byBhIHRlcm1pbmF0ZWQgT2JzZXJ2YWJsZSAtIHdlXHJcbiAgICAgICAgLy8ganVzdCByZXNwb25kIHRvIHRoZSBPYnNlcnZlciB3aXRoIHRoZSBmaW5hbCBlcnJvciBvciBjb21wbGV0ZVxyXG4gICAgICAgIC8vIGV2ZW50LlxyXG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICB0aGlzLnRhc2sudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5maW5hbEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKF90aGlzLmZpbmFsRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdGhpbmdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpO1xyXG4gICAgICAgIHJldHVybiB1bnN1YjtcclxuICAgIH07XHJcbiAgICAvLyBVbnN1YnNjcmliZSBpcyBzeW5jaHJvbm91cyAtIHdlIGd1YXJhbnRlZSB0aGF0IG5vIGV2ZW50cyBhcmUgc2VudCB0b1xyXG4gICAgLy8gYW55IHVuc3Vic2NyaWJlZCBPYnNlcnZlci5cclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLnVuc3Vic2NyaWJlT25lID0gZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICBpZiAodGhpcy5vYnNlcnZlcnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLm9ic2VydmVyc1tpXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVsZXRlIHRoaXMub2JzZXJ2ZXJzW2ldO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCAtPSAxO1xyXG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVyQ291bnQgPT09IDAgJiYgdGhpcy5vbk5vT2JzZXJ2ZXJzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5mb3JFYWNoT2JzZXJ2ZXIgPSBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgLy8gQWxyZWFkeSBjbG9zZWQgYnkgcHJldmlvdXMgZXZlbnQuLi4uanVzdCBlYXQgdGhlIGFkZGl0aW9uYWwgdmFsdWVzLlxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFNpbmNlIHNlbmRPbmUgY2FsbHMgYXN5bmNocm9ub3VzbHkgLSB0aGVyZSBpcyBubyBjaGFuY2UgdGhhdFxyXG4gICAgICAgIC8vIHRoaXMub2JzZXJ2ZXJzIHdpbGwgYmVjb21lIHVuZGVmaW5lZC5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub2JzZXJ2ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZE9uZShpLCBmbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIENhbGwgdGhlIE9ic2VydmVyIHZpYSBvbmUgb2YgaXQncyBjYWxsYmFjayBmdW5jdGlvbi4gV2UgYXJlIGNhcmVmdWwgdG9cclxuICAgIC8vIGNvbmZpcm0gdGhhdCB0aGUgb2JzZXJ2ZSBoYXMgbm90IGJlZW4gdW5zdWJzY3JpYmVkIHNpbmNlIHRoaXMgYXN5bmNocm9ub3VzXHJcbiAgICAvLyBmdW5jdGlvbiBoYWQgYmVlbiBxdWV1ZWQuXHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5zZW5kT25lID0gZnVuY3Rpb24gKGksIGZuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBFeGVjdXRlIHRoZSBjYWxsYmFjayBhc3luY2hyb25vdXNseVxyXG4gICAgICAgIHRoaXMudGFzay50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKF90aGlzLm9ic2VydmVycyAhPT0gdW5kZWZpbmVkICYmIF90aGlzLm9ic2VydmVyc1tpXSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZuKF90aGlzLm9ic2VydmVyc1tpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSBleGNlcHRpb25zIHJhaXNlZCBpbiBPYnNlcnZlcnMgb3IgbWlzc2luZyBtZXRob2RzIG9mIGFuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gT2JzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHRvIGNvbnNvbGUuIGIvMzE0MDQ4MDZcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZmluYWxpemVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAoZXJyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5maW5hbEVycm9yID0gZXJyO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBQcm94eSBpcyBubyBsb25nZXIgbmVlZGVkIC0gZ2FyYmFnZSBjb2xsZWN0IHJlZmVyZW5jZXNcclxuICAgICAgICB0aGlzLnRhc2sudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLm9ic2VydmVycyA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgX3RoaXMub25Ob09ic2VydmVycyA9IHVuZGVmaW5lZDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gT2JzZXJ2ZXJQcm94eTtcclxufSgpKTtcclxuLyoqIFR1cm4gc3luY2hyb25vdXMgZnVuY3Rpb24gaW50byBvbmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5LiAqL1xyXG5mdW5jdGlvbiBhc3luYyhmbiwgb25FcnJvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKHRydWUpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZm4uYXBwbHkodm9pZCAwLCBhcmdzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG4vKipcclxuICogUmV0dXJuIHRydWUgaWYgdGhlIG9iamVjdCBwYXNzZWQgaW4gaW1wbGVtZW50cyBhbnkgb2YgdGhlIG5hbWVkIG1ldGhvZHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBpbXBsZW1lbnRzQW55TWV0aG9kcyhvYmosIG1ldGhvZHMpIHtcclxuICAgIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyB8fCBvYmogPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIG1ldGhvZHNfMSA9IG1ldGhvZHM7IF9pIDwgbWV0aG9kc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBtZXRob2QgPSBtZXRob2RzXzFbX2ldO1xyXG4gICAgICAgIGlmIChtZXRob2QgaW4gb2JqICYmIHR5cGVvZiBvYmpbbWV0aG9kXSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuZnVuY3Rpb24gbm9vcCgpIHtcclxuICAgIC8vIGRvIG5vdGhpbmdcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIENoZWNrIHRvIG1ha2Ugc3VyZSB0aGUgYXBwcm9wcmlhdGUgbnVtYmVyIG9mIGFyZ3VtZW50cyBhcmUgcHJvdmlkZWQgZm9yIGEgcHVibGljIGZ1bmN0aW9uLlxyXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgaXQgZmFpbHMuXHJcbiAqXHJcbiAqIEBwYXJhbSB7IXN0cmluZ30gZm5OYW1lIFRoZSBmdW5jdGlvbiBuYW1lXHJcbiAqIEBwYXJhbSB7IW51bWJlcn0gbWluQ291bnQgVGhlIG1pbmltdW0gbnVtYmVyIG9mIGFyZ3VtZW50cyB0byBhbGxvdyBmb3IgdGhlIGZ1bmN0aW9uIGNhbGxcclxuICogQHBhcmFtIHshbnVtYmVyfSBtYXhDb3VudCBUaGUgbWF4aW11bSBudW1iZXIgb2YgYXJndW1lbnQgdG8gYWxsb3cgZm9yIHRoZSBmdW5jdGlvbiBjYWxsXHJcbiAqIEBwYXJhbSB7IW51bWJlcn0gYXJnQ291bnQgVGhlIGFjdHVhbCBudW1iZXIgb2YgYXJndW1lbnRzIHByb3ZpZGVkLlxyXG4gKi9cclxudmFyIHZhbGlkYXRlQXJnQ291bnQgPSBmdW5jdGlvbiAoZm5OYW1lLCBtaW5Db3VudCwgbWF4Q291bnQsIGFyZ0NvdW50KSB7XHJcbiAgICB2YXIgYXJnRXJyb3I7XHJcbiAgICBpZiAoYXJnQ291bnQgPCBtaW5Db3VudCkge1xyXG4gICAgICAgIGFyZ0Vycm9yID0gJ2F0IGxlYXN0ICcgKyBtaW5Db3VudDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGFyZ0NvdW50ID4gbWF4Q291bnQpIHtcclxuICAgICAgICBhcmdFcnJvciA9IG1heENvdW50ID09PSAwID8gJ25vbmUnIDogJ25vIG1vcmUgdGhhbiAnICsgbWF4Q291bnQ7XHJcbiAgICB9XHJcbiAgICBpZiAoYXJnRXJyb3IpIHtcclxuICAgICAgICB2YXIgZXJyb3IgPSBmbk5hbWUgK1xyXG4gICAgICAgICAgICAnIGZhaWxlZDogV2FzIGNhbGxlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICBhcmdDb3VudCArXHJcbiAgICAgICAgICAgIChhcmdDb3VudCA9PT0gMSA/ICcgYXJndW1lbnQuJyA6ICcgYXJndW1lbnRzLicpICtcclxuICAgICAgICAgICAgJyBFeHBlY3RzICcgK1xyXG4gICAgICAgICAgICBhcmdFcnJvciArXHJcbiAgICAgICAgICAgICcuJztcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogR2VuZXJhdGVzIGEgc3RyaW5nIHRvIHByZWZpeCBhbiBlcnJvciBtZXNzYWdlIGFib3V0IGZhaWxlZCBhcmd1bWVudCB2YWxpZGF0aW9uXHJcbiAqXHJcbiAqIEBwYXJhbSB7IXN0cmluZ30gZm5OYW1lIFRoZSBmdW5jdGlvbiBuYW1lXHJcbiAqIEBwYXJhbSB7IW51bWJlcn0gYXJndW1lbnROdW1iZXIgVGhlIGluZGV4IG9mIHRoZSBhcmd1bWVudFxyXG4gKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbmFsIFdoZXRoZXIgb3Igbm90IHRoZSBhcmd1bWVudCBpcyBvcHRpb25hbFxyXG4gKiBAcmV0dXJuIHshc3RyaW5nfSBUaGUgcHJlZml4IHRvIGFkZCB0byB0aGUgZXJyb3IgdGhyb3duIGZvciB2YWxpZGF0aW9uLlxyXG4gKi9cclxuZnVuY3Rpb24gZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpIHtcclxuICAgIHZhciBhcmdOYW1lID0gJyc7XHJcbiAgICBzd2l0Y2ggKGFyZ3VtZW50TnVtYmVyKSB7XHJcbiAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICBhcmdOYW1lID0gb3B0aW9uYWwgPyAnZmlyc3QnIDogJ0ZpcnN0JztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICBhcmdOYW1lID0gb3B0aW9uYWwgPyAnc2Vjb25kJyA6ICdTZWNvbmQnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgIGFyZ05hbWUgPSBvcHRpb25hbCA/ICd0aGlyZCcgOiAnVGhpcmQnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgIGFyZ05hbWUgPSBvcHRpb25hbCA/ICdmb3VydGgnIDogJ0ZvdXJ0aCc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZXJyb3JQcmVmaXggY2FsbGVkIHdpdGggYXJndW1lbnROdW1iZXIgPiA0LiAgTmVlZCB0byB1cGRhdGUgaXQ/Jyk7XHJcbiAgICB9XHJcbiAgICB2YXIgZXJyb3IgPSBmbk5hbWUgKyAnIGZhaWxlZDogJztcclxuICAgIGVycm9yICs9IGFyZ05hbWUgKyAnIGFyZ3VtZW50ICc7XHJcbiAgICByZXR1cm4gZXJyb3I7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7IXN0cmluZ30gZm5OYW1lXHJcbiAqIEBwYXJhbSB7IW51bWJlcn0gYXJndW1lbnROdW1iZXJcclxuICogQHBhcmFtIHshc3RyaW5nfSBuYW1lc3BhY2VcclxuICogQHBhcmFtIHtib29sZWFufSBvcHRpb25hbFxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lc3BhY2UoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgbmFtZXNwYWNlLCBvcHRpb25hbCkge1xyXG4gICAgaWYgKG9wdGlvbmFsICYmICFuYW1lc3BhY2UpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgLy9UT0RPOiBJIHNob3VsZCBkbyBtb3JlIHZhbGlkYXRpb24gaGVyZS4gV2Ugb25seSBhbGxvdyBjZXJ0YWluIGNoYXJzIGluIG5hbWVzcGFjZXMuXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9wdGlvbmFsKSArXHJcbiAgICAgICAgICAgICdtdXN0IGJlIGEgdmFsaWQgZmlyZWJhc2UgbmFtZXNwYWNlLicpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlQ2FsbGJhY2soZm5OYW1lLCBhcmd1bWVudE51bWJlciwgY2FsbGJhY2ssIG9wdGlvbmFsKSB7XHJcbiAgICBpZiAob3B0aW9uYWwgJiYgIWNhbGxiYWNrKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9wdGlvbmFsKSArXHJcbiAgICAgICAgICAgICdtdXN0IGJlIGEgdmFsaWQgZnVuY3Rpb24uJyk7XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVDb250ZXh0T2JqZWN0KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIGNvbnRleHQsIG9wdGlvbmFsKSB7XHJcbiAgICBpZiAob3B0aW9uYWwgJiYgIWNvbnRleHQpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgaWYgKHR5cGVvZiBjb250ZXh0ICE9PSAnb2JqZWN0JyB8fCBjb250ZXh0ID09PSBudWxsKVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkgK1xyXG4gICAgICAgICAgICAnbXVzdCBiZSBhIHZhbGlkIGNvbnRleHQgb2JqZWN0LicpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBDb2RlIG9yaWdpbmFsbHkgY2FtZSBmcm9tIGdvb2cuY3J5cHQuc3RyaW5nVG9VdGY4Qnl0ZUFycmF5LCBidXQgZm9yIHNvbWUgcmVhc29uIHRoZXlcclxuLy8gYXV0b21hdGljYWxseSByZXBsYWNlZCAnXFxyXFxuJyB3aXRoICdcXG4nLCBhbmQgdGhleSBkaWRuJ3QgaGFuZGxlIHN1cnJvZ2F0ZSBwYWlycyxcclxuLy8gc28gaXQncyBiZWVuIG1vZGlmaWVkLlxyXG4vLyBOb3RlIHRoYXQgbm90IGFsbCBVbmljb2RlIGNoYXJhY3RlcnMgYXBwZWFyIGFzIHNpbmdsZSBjaGFyYWN0ZXJzIGluIEphdmFTY3JpcHQgc3RyaW5ncy5cclxuLy8gZnJvbUNoYXJDb2RlIHJldHVybnMgdGhlIFVURi0xNiBlbmNvZGluZyBvZiBhIGNoYXJhY3RlciAtIHNvIHNvbWUgVW5pY29kZSBjaGFyYWN0ZXJzXHJcbi8vIHVzZSAyIGNoYXJhY3RlcnMgaW4gSmF2YXNjcmlwdC4gIEFsbCA0LWJ5dGUgVVRGLTggY2hhcmFjdGVycyBiZWdpbiB3aXRoIGEgZmlyc3RcclxuLy8gY2hhcmFjdGVyIGluIHRoZSByYW5nZSAweEQ4MDAgLSAweERCRkYgKHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgYSBzby1jYWxsZWQgc3Vycm9nYXRlXHJcbi8vIHBhaXIpLlxyXG4vLyBTZWUgaHR0cDovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTE1LjEuM1xyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxyXG4gKiBAcmV0dXJuIHtBcnJheX1cclxuICovXHJcbnZhciBzdHJpbmdUb0J5dGVBcnJheSQxID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgdmFyIG91dCA9IFtdLCBwID0gMDtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGMgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICAvLyBJcyB0aGlzIHRoZSBsZWFkIHN1cnJvZ2F0ZSBpbiBhIHN1cnJvZ2F0ZSBwYWlyP1xyXG4gICAgICAgIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xyXG4gICAgICAgICAgICB2YXIgaGlnaCA9IGMgLSAweGQ4MDA7IC8vIHRoZSBoaWdoIDEwIGJpdHMuXHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgYXNzZXJ0KGkgPCBzdHIubGVuZ3RoLCAnU3Vycm9nYXRlIHBhaXIgbWlzc2luZyB0cmFpbCBzdXJyb2dhdGUuJyk7XHJcbiAgICAgICAgICAgIHZhciBsb3cgPSBzdHIuY2hhckNvZGVBdChpKSAtIDB4ZGMwMDsgLy8gdGhlIGxvdyAxMCBiaXRzLlxyXG4gICAgICAgICAgICBjID0gMHgxMDAwMCArIChoaWdoIDw8IDEwKSArIGxvdztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGMgPCAxMjgpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSBjO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgMjA0OCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDYpIHwgMTkyO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgNjU1MzYpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxMikgfCAyMjQ7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxOCkgfCAyNDA7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDEyKSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dDtcclxufTtcclxuLyoqXHJcbiAqIENhbGN1bGF0ZSBsZW5ndGggd2l0aG91dCBhY3R1YWxseSBjb252ZXJ0aW5nOyB1c2VmdWwgZm9yIGRvaW5nIGNoZWFwZXIgdmFsaWRhdGlvbi5cclxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG52YXIgc3RyaW5nTGVuZ3RoID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgdmFyIHAgPSAwO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIHArKztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcclxuICAgICAgICAgICAgcCArPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xyXG4gICAgICAgICAgICAvLyBMZWFkIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyLiAgVGhlIHBhaXIgdG9nZXRoZXIgd2lsbCB0YWtlIDQgYnl0ZXMgdG8gcmVwcmVzZW50LlxyXG4gICAgICAgICAgICBwICs9IDQ7XHJcbiAgICAgICAgICAgIGkrKzsgLy8gc2tpcCB0cmFpbCBzdXJyb2dhdGUuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwICs9IDM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHA7XHJcbn07XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG5leHBvcnRzLmFzc2VydCA9IGFzc2VydDtcbmV4cG9ydHMuYXNzZXJ0aW9uRXJyb3IgPSBhc3NlcnRpb25FcnJvcjtcbmV4cG9ydHMuYmFzZTY0ID0gYmFzZTY0O1xuZXhwb3J0cy5iYXNlNjREZWNvZGUgPSBiYXNlNjREZWNvZGU7XG5leHBvcnRzLmJhc2U2NEVuY29kZSA9IGJhc2U2NEVuY29kZTtcbmV4cG9ydHMuQ09OU1RBTlRTID0gQ09OU1RBTlRTO1xuZXhwb3J0cy5kZWVwQ29weSA9IGRlZXBDb3B5O1xuZXhwb3J0cy5kZWVwRXh0ZW5kID0gZGVlcEV4dGVuZDtcbmV4cG9ydHMucGF0Y2hQcm9wZXJ0eSA9IHBhdGNoUHJvcGVydHk7XG5leHBvcnRzLkRlZmVycmVkID0gRGVmZXJyZWQ7XG5leHBvcnRzLmdldFVBID0gZ2V0VUE7XG5leHBvcnRzLmlzTW9iaWxlQ29yZG92YSA9IGlzTW9iaWxlQ29yZG92YTtcbmV4cG9ydHMuaXNOb2RlU2RrID0gaXNOb2RlU2RrO1xuZXhwb3J0cy5pc1JlYWN0TmF0aXZlID0gaXNSZWFjdE5hdGl2ZTtcbmV4cG9ydHMuRXJyb3JGYWN0b3J5ID0gRXJyb3JGYWN0b3J5O1xuZXhwb3J0cy5GaXJlYmFzZUVycm9yID0gRmlyZWJhc2VFcnJvcjtcbmV4cG9ydHMucGF0Y2hDYXB0dXJlID0gcGF0Y2hDYXB0dXJlO1xuZXhwb3J0cy5qc29uRXZhbCA9IGpzb25FdmFsO1xuZXhwb3J0cy5zdHJpbmdpZnkgPSBzdHJpbmdpZnk7XG5leHBvcnRzLmRlY29kZSA9IGRlY29kZTtcbmV4cG9ydHMuaXNBZG1pbiA9IGlzQWRtaW47XG5leHBvcnRzLmlzc3VlZEF0VGltZSA9IGlzc3VlZEF0VGltZTtcbmV4cG9ydHMuaXNWYWxpZEZvcm1hdCA9IGlzVmFsaWRGb3JtYXQ7XG5leHBvcnRzLmlzVmFsaWRUaW1lc3RhbXAgPSBpc1ZhbGlkVGltZXN0YW1wO1xuZXhwb3J0cy5jbG9uZSA9IGNsb25lO1xuZXhwb3J0cy5jb250YWlucyA9IGNvbnRhaW5zO1xuZXhwb3J0cy5ldmVyeSA9IGV2ZXJ5O1xuZXhwb3J0cy5leHRlbmQgPSBleHRlbmQ7XG5leHBvcnRzLmZpbmRLZXkgPSBmaW5kS2V5O1xuZXhwb3J0cy5maW5kVmFsdWUgPSBmaW5kVmFsdWU7XG5leHBvcnRzLmZvckVhY2ggPSBmb3JFYWNoO1xuZXhwb3J0cy5nZXRBbnlLZXkgPSBnZXRBbnlLZXk7XG5leHBvcnRzLmdldENvdW50ID0gZ2V0Q291bnQ7XG5leHBvcnRzLmdldFZhbHVlcyA9IGdldFZhbHVlcztcbmV4cG9ydHMuaXNFbXB0eSA9IGlzRW1wdHk7XG5leHBvcnRzLmlzTm9uTnVsbE9iamVjdCA9IGlzTm9uTnVsbE9iamVjdDtcbmV4cG9ydHMubWFwID0gbWFwO1xuZXhwb3J0cy5zYWZlR2V0ID0gc2FmZUdldDtcbmV4cG9ydHMucXVlcnlzdHJpbmcgPSBxdWVyeXN0cmluZztcbmV4cG9ydHMucXVlcnlzdHJpbmdEZWNvZGUgPSBxdWVyeXN0cmluZ0RlY29kZTtcbmV4cG9ydHMuU2hhMSA9IFNoYTE7XG5leHBvcnRzLmFzeW5jID0gYXN5bmM7XG5leHBvcnRzLmNyZWF0ZVN1YnNjcmliZSA9IGNyZWF0ZVN1YnNjcmliZTtcbmV4cG9ydHMuZXJyb3JQcmVmaXggPSBlcnJvclByZWZpeDtcbmV4cG9ydHMudmFsaWRhdGVBcmdDb3VudCA9IHZhbGlkYXRlQXJnQ291bnQ7XG5leHBvcnRzLnZhbGlkYXRlQ2FsbGJhY2sgPSB2YWxpZGF0ZUNhbGxiYWNrO1xuZXhwb3J0cy52YWxpZGF0ZUNvbnRleHRPYmplY3QgPSB2YWxpZGF0ZUNvbnRleHRPYmplY3Q7XG5leHBvcnRzLnZhbGlkYXRlTmFtZXNwYWNlID0gdmFsaWRhdGVOYW1lc3BhY2U7XG5leHBvcnRzLnN0cmluZ0xlbmd0aCA9IHN0cmluZ0xlbmd0aDtcbmV4cG9ydHMuc3RyaW5nVG9CeXRlQXJyYXkgPSBzdHJpbmdUb0J5dGVBcnJheSQxO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L0BmaXJlYmFzZS91dGlsL2Rpc3QvaW5kZXguY2pzLmpzXG4vLyBtb2R1bGUgaWQgPSAzOFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgY29tbW9uanNHbG9iYWwgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9O1xuXG52YXIgZSxnb29nPWdvb2d8fHt9LGg9Y29tbW9uanNHbG9iYWw7ZnVuY3Rpb24gbChhKXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgYX1mdW5jdGlvbiBtKGEsYil7YT1hLnNwbGl0KFwiLlwiKTtiPWJ8fGg7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspaWYoYj1iW2FbY11dLCBudWxsPT1iKXJldHVybiBudWxsO3JldHVybiBifWZ1bmN0aW9uIGFhKCl7fVxuZnVuY3Rpb24gYmEoYSl7dmFyIGI9dHlwZW9mIGE7aWYoXCJvYmplY3RcIj09YilpZihhKXtpZihhIGluc3RhbmNlb2YgQXJyYXkpcmV0dXJuXCJhcnJheVwiO2lmKGEgaW5zdGFuY2VvZiBPYmplY3QpcmV0dXJuIGI7dmFyIGM9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpO2lmKFwiW29iamVjdCBXaW5kb3ddXCI9PWMpcmV0dXJuXCJvYmplY3RcIjtpZihcIltvYmplY3QgQXJyYXldXCI9PWN8fFwibnVtYmVyXCI9PXR5cGVvZiBhLmxlbmd0aCYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEuc3BsaWNlJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5wcm9wZXJ0eUlzRW51bWVyYWJsZSYmIWEucHJvcGVydHlJc0VudW1lcmFibGUoXCJzcGxpY2VcIikpcmV0dXJuXCJhcnJheVwiO2lmKFwiW29iamVjdCBGdW5jdGlvbl1cIj09Y3x8XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEuY2FsbCYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEucHJvcGVydHlJc0VudW1lcmFibGUmJiFhLnByb3BlcnR5SXNFbnVtZXJhYmxlKFwiY2FsbFwiKSlyZXR1cm5cImZ1bmN0aW9uXCJ9ZWxzZSByZXR1cm5cIm51bGxcIjtcbmVsc2UgaWYoXCJmdW5jdGlvblwiPT1iJiZcInVuZGVmaW5lZFwiPT10eXBlb2YgYS5jYWxsKXJldHVyblwib2JqZWN0XCI7cmV0dXJuIGJ9ZnVuY3Rpb24gbihhKXtyZXR1cm5cImFycmF5XCI9PWJhKGEpfWZ1bmN0aW9uIGNhKGEpe3ZhciBiPWJhKGEpO3JldHVyblwiYXJyYXlcIj09Ynx8XCJvYmplY3RcIj09YiYmXCJudW1iZXJcIj09dHlwZW9mIGEubGVuZ3RofWZ1bmN0aW9uIHEoYSl7cmV0dXJuXCJmdW5jdGlvblwiPT1iYShhKX1mdW5jdGlvbiByKGEpe3ZhciBiPXR5cGVvZiBhO3JldHVyblwib2JqZWN0XCI9PWImJm51bGwhPWF8fFwiZnVuY3Rpb25cIj09Yn12YXIgdD1cImNsb3N1cmVfdWlkX1wiKygxRTkqTWF0aC5yYW5kb20oKT4+PjApLGRhPTA7ZnVuY3Rpb24gZWEoYSxiLGMpe3JldHVybiBhLmNhbGwuYXBwbHkoYS5iaW5kLGFyZ3VtZW50cyl9XG5mdW5jdGlvbiBmYShhLGIsYyl7aWYoIWEpdGhyb3cgRXJyb3IoKTtpZigyPGFyZ3VtZW50cy5sZW5ndGgpe3ZhciBkPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO0FycmF5LnByb3RvdHlwZS51bnNoaWZ0LmFwcGx5KGMsZCk7cmV0dXJuIGEuYXBwbHkoYixjKX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYixhcmd1bWVudHMpfX1mdW5jdGlvbiB1KGEsYixjKXt1PUZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kJiYtMSE9RnVuY3Rpb24ucHJvdG90eXBlLmJpbmQudG9TdHJpbmcoKS5pbmRleE9mKFwibmF0aXZlIGNvZGVcIik/ZWE6ZmE7cmV0dXJuIHUuYXBwbHkobnVsbCxhcmd1bWVudHMpfVxuZnVuY3Rpb24gdihhLGIpe3ZhciBjPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYj1jLnNsaWNlKCk7Yi5wdXNoLmFwcGx5KGIsYXJndW1lbnRzKTtyZXR1cm4gYS5hcHBseSh0aGlzLGIpfX12YXIgdz1EYXRlLm5vd3x8ZnVuY3Rpb24oKXtyZXR1cm4rbmV3IERhdGV9O2Z1bmN0aW9uIHgoYSxiKXtmdW5jdGlvbiBjKCl7fWMucHJvdG90eXBlPWIucHJvdG90eXBlO2EuTD1iLnByb3RvdHlwZTthLnByb3RvdHlwZT1uZXcgYzthLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1hO2EubWg9ZnVuY3Rpb24oYSxjLGcpe2Zvcih2YXIgZD1BcnJheShhcmd1bWVudHMubGVuZ3RoLTIpLGY9MjtmPGFyZ3VtZW50cy5sZW5ndGg7ZisrKWRbZi0yXT1hcmd1bWVudHNbZl07cmV0dXJuIGIucHJvdG90eXBlW2NdLmFwcGx5KGEsZCl9O31mdW5jdGlvbiB5KGEpe2lmKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKUVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMseSk7ZWxzZXt2YXIgYj1FcnJvcigpLnN0YWNrO2ImJih0aGlzLnN0YWNrPWIpO31hJiYodGhpcy5tZXNzYWdlPVN0cmluZyhhKSk7fXgoeSxFcnJvcik7eS5wcm90b3R5cGUubmFtZT1cIkN1c3RvbUVycm9yXCI7ZnVuY3Rpb24gaGEoYSxiKXthPWEuc3BsaXQoXCIlc1wiKTtmb3IodmFyIGM9XCJcIixkPWEubGVuZ3RoLTEsZj0wO2Y8ZDtmKyspYys9YVtmXSsoZjxiLmxlbmd0aD9iW2ZdOlwiJXNcIik7eS5jYWxsKHRoaXMsYythW2RdKTt9eChoYSx5KTtoYS5wcm90b3R5cGUubmFtZT1cIkFzc2VydGlvbkVycm9yXCI7ZnVuY3Rpb24gaWEoYSxiKXt0aHJvdyBuZXcgaGEoXCJGYWlsdXJlXCIrKGE/XCI6IFwiK2E6XCJcIiksQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTt9ZnVuY3Rpb24geigpezAhPWphJiYoa2FbdGhpc1t0XXx8KHRoaXNbdF09KytkYSldPXRoaXMpO3RoaXMuS2E9dGhpcy5LYTt0aGlzLlFhPXRoaXMuUWE7fXZhciBqYT0wLGthPXt9O3oucHJvdG90eXBlLkthPSExO3oucHJvdG90eXBlLmJiPWZ1bmN0aW9uKCl7aWYoIXRoaXMuS2EmJih0aGlzLkthPSEwLCB0aGlzLkYoKSwgMCE9amEpKXt2YXIgYT10aGlzW3RdfHwodGhpc1t0XT0rK2RhKTtpZigwIT1qYSYmdGhpcy5RYSYmMDx0aGlzLlFhLmxlbmd0aCl0aHJvdyBFcnJvcih0aGlzK1wiIGRpZCBub3QgZW1wdHkgaXRzIG9uRGlzcG9zZUNhbGxiYWNrcyBxdWV1ZS4gVGhpcyBwcm9iYWJseSBtZWFucyBpdCBvdmVycm9kZSBkaXNwb3NlKCkgb3IgZGlzcG9zZUludGVybmFsKCkgd2l0aG91dCBjYWxsaW5nIHRoZSBzdXBlcmNsYXNzJyBtZXRob2QuXCIpO2RlbGV0ZSBrYVthXTt9fTt6LnByb3RvdHlwZS5GPWZ1bmN0aW9uKCl7aWYodGhpcy5RYSlmb3IoO3RoaXMuUWEubGVuZ3RoOyl0aGlzLlFhLnNoaWZ0KCkoKTt9O3ZhciBsYT1BcnJheS5wcm90b3R5cGUuaW5kZXhPZj9mdW5jdGlvbihhLGIpe3JldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGEsYix2b2lkIDApfTpmdW5jdGlvbihhLGIpe2lmKGwoYSkpcmV0dXJuIGwoYikmJjE9PWIubGVuZ3RoP2EuaW5kZXhPZihiLDApOi0xO2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKWlmKGMgaW4gYSYmYVtjXT09PWIpcmV0dXJuIGM7cmV0dXJuLTF9LG1hPUFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZj9mdW5jdGlvbihhLGIpe3JldHVybiBBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2YuY2FsbChhLGIsYS5sZW5ndGgtMSl9OmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5sZW5ndGgtMTswPmMmJihjPU1hdGgubWF4KDAsYS5sZW5ndGgrYykpO2lmKGwoYSkpcmV0dXJuIGwoYikmJjE9PWIubGVuZ3RoP2EubGFzdEluZGV4T2YoYixjKTotMTtmb3IoOzA8PWM7Yy0tKWlmKGMgaW4gYSYmYVtjXT09PWIpcmV0dXJuIGM7cmV0dXJuLTF9LG5hPVxuQXJyYXkucHJvdG90eXBlLmZvckVhY2g/ZnVuY3Rpb24oYSxiLGMpe0FycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYSxiLGMpO306ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD1hLmxlbmd0aCxmPWwoYSk/YS5zcGxpdChcIlwiKTphLGc9MDtnPGQ7ZysrKWcgaW4gZiYmYi5jYWxsKGMsZltnXSxnLGEpO30sb2E9QXJyYXkucHJvdG90eXBlLnNvbWU/ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNvbWUuY2FsbChhLGIsdm9pZCAwKX06ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9YS5sZW5ndGgsZD1sKGEpP2Euc3BsaXQoXCJcIik6YSxmPTA7ZjxjO2YrKylpZihmIGluIGQmJmIuY2FsbCh2b2lkIDAsZFtmXSxmLGEpKXJldHVybiEwO3JldHVybiExfTtcbmZ1bmN0aW9uIHBhKGEpe2E6e3ZhciBiPXFhO2Zvcih2YXIgYz1hLmxlbmd0aCxkPWwoYSk/YS5zcGxpdChcIlwiKTphLGY9MDtmPGM7ZisrKWlmKGYgaW4gZCYmYi5jYWxsKHZvaWQgMCxkW2ZdLGYsYSkpe2I9ZjticmVhayBhfWI9LTE7fXJldHVybiAwPmI/bnVsbDpsKGEpP2EuY2hhckF0KGIpOmFbYl19ZnVuY3Rpb24gcmEoYSl7aWYoIW4oYSkpZm9yKHZhciBiPWEubGVuZ3RoLTE7MDw9YjtiLS0pZGVsZXRlIGFbYl07YS5sZW5ndGg9MDt9ZnVuY3Rpb24gc2EoYSxiKXtiPWxhKGEsYik7dmFyIGM7KGM9MDw9YikmJkFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChhLGIsMSk7cmV0dXJuIGN9ZnVuY3Rpb24gdGEoYSl7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sYXJndW1lbnRzKX1mdW5jdGlvbiB1YShhKXt2YXIgYj1hLmxlbmd0aDtpZigwPGIpe2Zvcih2YXIgYz1BcnJheShiKSxkPTA7ZDxiO2QrKyljW2RdPWFbZF07cmV0dXJuIGN9cmV0dXJuW119ZnVuY3Rpb24gdmEoYSl7cmV0dXJuL15bXFxzXFx4YTBdKiQvLnRlc3QoYSl9dmFyIHdhPVN0cmluZy5wcm90b3R5cGUudHJpbT9mdW5jdGlvbihhKXtyZXR1cm4gYS50cmltKCl9OmZ1bmN0aW9uKGEpe3JldHVybi9eW1xcc1xceGEwXSooW1xcc1xcU10qPylbXFxzXFx4YTBdKiQvLmV4ZWMoYSlbMV19O2Z1bmN0aW9uIHhhKGEsYil7cmV0dXJuIGE8Yj8tMTphPmI/MTowfXZhciBBO2E6e3ZhciB5YT1oLm5hdmlnYXRvcjtpZih5YSl7dmFyIHphPXlhLnVzZXJBZ2VudDtpZih6YSl7QT16YTticmVhayBhfX1BPVwiXCI7fWZ1bmN0aW9uIEIoYSl7cmV0dXJuLTEhPUEuaW5kZXhPZihhKX1mdW5jdGlvbiBBYShhLGIsYyl7Zm9yKHZhciBkIGluIGEpYi5jYWxsKGMsYVtkXSxkLGEpO31mdW5jdGlvbiBCYShhKXt2YXIgYj1bXSxjPTAsZDtmb3IoZCBpbiBhKWJbYysrXT1hW2RdO3JldHVybiBifWZ1bmN0aW9uIENhKGEpe3ZhciBiPVtdLGM9MCxkO2ZvcihkIGluIGEpYltjKytdPWQ7cmV0dXJuIGJ9ZnVuY3Rpb24gRGEoYSl7dmFyIGI9e30sYztmb3IoYyBpbiBhKWJbY109YVtjXTtyZXR1cm4gYn12YXIgRWE9XCJjb25zdHJ1Y3RvciBoYXNPd25Qcm9wZXJ0eSBpc1Byb3RvdHlwZU9mIHByb3BlcnR5SXNFbnVtZXJhYmxlIHRvTG9jYWxlU3RyaW5nIHRvU3RyaW5nIHZhbHVlT2ZcIi5zcGxpdChcIiBcIik7XG5mdW5jdGlvbiBGYShhLGIpe2Zvcih2YXIgYyxkLGY9MTtmPGFyZ3VtZW50cy5sZW5ndGg7ZisrKXtkPWFyZ3VtZW50c1tmXTtmb3IoYyBpbiBkKWFbY109ZFtjXTtmb3IodmFyIGc9MDtnPEVhLmxlbmd0aDtnKyspYz1FYVtnXSwgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGQsYykmJihhW2NdPWRbY10pO319ZnVuY3Rpb24gR2EoYSl7R2FbXCIgXCJdKGEpO3JldHVybiBhfUdhW1wiIFwiXT1hYTtmdW5jdGlvbiBIYShhLGIpe3ZhciBjPUlhO3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYyxhKT9jW2FdOmNbYV09YihhKX12YXIgSmE9QihcIk9wZXJhXCIpLEM9QihcIlRyaWRlbnRcIil8fEIoXCJNU0lFXCIpLEthPUIoXCJFZGdlXCIpLExhPUthfHxDLE1hPUIoXCJHZWNrb1wiKSYmISgtMSE9QS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJ3ZWJraXRcIikmJiFCKFwiRWRnZVwiKSkmJiEoQihcIlRyaWRlbnRcIil8fEIoXCJNU0lFXCIpKSYmIUIoXCJFZGdlXCIpLE5hPS0xIT1BLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcIndlYmtpdFwiKSYmIUIoXCJFZGdlXCIpO2Z1bmN0aW9uIE9hKCl7dmFyIGE9aC5kb2N1bWVudDtyZXR1cm4gYT9hLmRvY3VtZW50TW9kZTp2b2lkIDB9dmFyIFBhO1xuYTp7dmFyIFFhPVwiXCIsUmE9ZnVuY3Rpb24oKXt2YXIgYT1BO2lmKE1hKXJldHVybi9ydjooW15cXCk7XSspKFxcKXw7KS8uZXhlYyhhKTtpZihLYSlyZXR1cm4vRWRnZVxcLyhbXFxkXFwuXSspLy5leGVjKGEpO2lmKEMpcmV0dXJuL1xcYig/Ok1TSUV8cnYpWzogXShbXlxcKTtdKykoXFwpfDspLy5leGVjKGEpO2lmKE5hKXJldHVybi9XZWJLaXRcXC8oXFxTKykvLmV4ZWMoYSk7aWYoSmEpcmV0dXJuLyg/OlZlcnNpb24pWyBcXC9dPyhcXFMrKS8uZXhlYyhhKX0oKTtSYSYmKFFhPVJhP1JhWzFdOlwiXCIpO2lmKEMpe3ZhciBTYT1PYSgpO2lmKG51bGwhPVNhJiZTYT5wYXJzZUZsb2F0KFFhKSl7UGE9U3RyaW5nKFNhKTticmVhayBhfX1QYT1RYTt9dmFyIElhPXt9O1xuZnVuY3Rpb24gVGEoYSl7cmV0dXJuIEhhKGEsZnVuY3Rpb24oKXtmb3IodmFyIGI9MCxjPXdhKFN0cmluZyhQYSkpLnNwbGl0KFwiLlwiKSxkPXdhKFN0cmluZyhhKSkuc3BsaXQoXCIuXCIpLGY9TWF0aC5tYXgoYy5sZW5ndGgsZC5sZW5ndGgpLGc9MDswPT1iJiZnPGY7ZysrKXt2YXIgaz1jW2ddfHxcIlwiLHA9ZFtnXXx8XCJcIjtkb3trPS8oXFxkKikoXFxEKikoLiopLy5leGVjKGspfHxbXCJcIixcIlwiLFwiXCIsXCJcIl07cD0vKFxcZCopKFxcRCopKC4qKS8uZXhlYyhwKXx8W1wiXCIsXCJcIixcIlwiLFwiXCJdO2lmKDA9PWtbMF0ubGVuZ3RoJiYwPT1wWzBdLmxlbmd0aClicmVhaztiPXhhKDA9PWtbMV0ubGVuZ3RoPzA6cGFyc2VJbnQoa1sxXSwxMCksMD09cFsxXS5sZW5ndGg/MDpwYXJzZUludChwWzFdLDEwKSl8fHhhKDA9PWtbMl0ubGVuZ3RoLDA9PXBbMl0ubGVuZ3RoKXx8eGEoa1syXSxwWzJdKTtrPWtbM107cD1wWzNdO313aGlsZSgwPT1iKX1yZXR1cm4gMDw9Yn0pfXZhciBVYTt2YXIgVmE9aC5kb2N1bWVudDtcblVhPVZhJiZDP09hKCl8fChcIkNTUzFDb21wYXRcIj09VmEuY29tcGF0TW9kZT9wYXJzZUludChQYSwxMCk6NSk6dm9pZCAwO3ZhciBXYT1PYmplY3QuZnJlZXplfHxmdW5jdGlvbihhKXtyZXR1cm4gYX07dmFyIFhhPSFDfHw5PD1OdW1iZXIoVWEpLFlhPUMmJiFUYShcIjlcIiksWmE9ZnVuY3Rpb24oKXtpZighaC5hZGRFdmVudExpc3RlbmVyfHwhT2JqZWN0LmRlZmluZVByb3BlcnR5KXJldHVybiExO3ZhciBhPSExLGI9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LFwicGFzc2l2ZVwiLHtnZXQ6ZnVuY3Rpb24oKXthPSEwO319KTt0cnl7aC5hZGRFdmVudExpc3RlbmVyKFwidGVzdFwiLGFhLGIpLCBoLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0ZXN0XCIsYWEsYik7fWNhdGNoKGMpe31yZXR1cm4gYX0oKTtmdW5jdGlvbiBEKGEsYil7dGhpcy50eXBlPWE7dGhpcy5jdXJyZW50VGFyZ2V0PXRoaXMudGFyZ2V0PWI7dGhpcy5kZWZhdWx0UHJldmVudGVkPXRoaXMuRWE9ITE7dGhpcy5CZT0hMDt9RC5wcm90b3R5cGUuc3RvcFByb3BhZ2F0aW9uPWZ1bmN0aW9uKCl7dGhpcy5FYT0hMDt9O0QucHJvdG90eXBlLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7dGhpcy5kZWZhdWx0UHJldmVudGVkPSEwO3RoaXMuQmU9ITE7fTtmdW5jdGlvbiBFKGEsYil7RC5jYWxsKHRoaXMsYT9hLnR5cGU6XCJcIik7dGhpcy5yZWxhdGVkVGFyZ2V0PXRoaXMuY3VycmVudFRhcmdldD10aGlzLnRhcmdldD1udWxsO3RoaXMuYnV0dG9uPXRoaXMuc2NyZWVuWT10aGlzLnNjcmVlblg9dGhpcy5jbGllbnRZPXRoaXMuY2xpZW50WD10aGlzLm9mZnNldFk9dGhpcy5vZmZzZXRYPTA7dGhpcy5rZXk9XCJcIjt0aGlzLmNoYXJDb2RlPXRoaXMua2V5Q29kZT0wO3RoaXMubWV0YUtleT10aGlzLnNoaWZ0S2V5PXRoaXMuYWx0S2V5PXRoaXMuY3RybEtleT0hMTt0aGlzLnN0YXRlPW51bGw7dGhpcy5wb2ludGVySWQ9MDt0aGlzLnBvaW50ZXJUeXBlPVwiXCI7dGhpcy5mYj1udWxsO2EmJnRoaXMuS2YoYSxiKTt9eChFLEQpO3ZhciAkYT1XYSh7MjpcInRvdWNoXCIsMzpcInBlblwiLDQ6XCJtb3VzZVwifSk7XG5FLnByb3RvdHlwZS5LZj1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMudHlwZT1hLnR5cGUsZD1hLmNoYW5nZWRUb3VjaGVzP2EuY2hhbmdlZFRvdWNoZXNbMF06bnVsbDt0aGlzLnRhcmdldD1hLnRhcmdldHx8YS5zcmNFbGVtZW50O3RoaXMuY3VycmVudFRhcmdldD1iO2lmKGI9YS5yZWxhdGVkVGFyZ2V0KXtpZihNYSl7YTp7dHJ5e0dhKGIubm9kZU5hbWUpO3ZhciBmPSEwO2JyZWFrIGF9Y2F0Y2goZyl7fWY9ITE7fWZ8fChiPW51bGwpO319ZWxzZVwibW91c2VvdmVyXCI9PWM/Yj1hLmZyb21FbGVtZW50OlwibW91c2VvdXRcIj09YyYmKGI9YS50b0VsZW1lbnQpO3RoaXMucmVsYXRlZFRhcmdldD1iO251bGw9PT1kPyh0aGlzLm9mZnNldFg9TmF8fHZvaWQgMCE9PWEub2Zmc2V0WD9hLm9mZnNldFg6YS5sYXllclgsIHRoaXMub2Zmc2V0WT1OYXx8dm9pZCAwIT09YS5vZmZzZXRZP2Eub2Zmc2V0WTphLmxheWVyWSwgdGhpcy5jbGllbnRYPXZvaWQgMCE9PWEuY2xpZW50WD9hLmNsaWVudFg6YS5wYWdlWCwgdGhpcy5jbGllbnRZPXZvaWQgMCE9PWEuY2xpZW50WT9hLmNsaWVudFk6YS5wYWdlWSwgdGhpcy5zY3JlZW5YPWEuc2NyZWVuWHx8MCwgdGhpcy5zY3JlZW5ZPWEuc2NyZWVuWXx8MCk6KHRoaXMuY2xpZW50WD12b2lkIDAhPT1kLmNsaWVudFg/ZC5jbGllbnRYOmQucGFnZVgsIHRoaXMuY2xpZW50WT12b2lkIDAhPT1kLmNsaWVudFk/ZC5jbGllbnRZOmQucGFnZVksIHRoaXMuc2NyZWVuWD1kLnNjcmVlblh8fDAsIHRoaXMuc2NyZWVuWT1kLnNjcmVlbll8fDApO3RoaXMuYnV0dG9uPWEuYnV0dG9uO3RoaXMua2V5Q29kZT1hLmtleUNvZGV8fDA7dGhpcy5rZXk9YS5rZXl8fFwiXCI7dGhpcy5jaGFyQ29kZT1hLmNoYXJDb2RlfHwoXCJrZXlwcmVzc1wiPT1jP2Eua2V5Q29kZTowKTt0aGlzLmN0cmxLZXk9YS5jdHJsS2V5O3RoaXMuYWx0S2V5PWEuYWx0S2V5O3RoaXMuc2hpZnRLZXk9YS5zaGlmdEtleTt0aGlzLm1ldGFLZXk9YS5tZXRhS2V5O3RoaXMucG9pbnRlcklkPWEucG9pbnRlcklkfHwwO3RoaXMucG9pbnRlclR5cGU9XG5sKGEucG9pbnRlclR5cGUpP2EucG9pbnRlclR5cGU6JGFbYS5wb2ludGVyVHlwZV18fFwiXCI7dGhpcy5zdGF0ZT1hLnN0YXRlO3RoaXMuZmI9YTthLmRlZmF1bHRQcmV2ZW50ZWQmJnRoaXMucHJldmVudERlZmF1bHQoKTt9O0UucHJvdG90eXBlLnN0b3BQcm9wYWdhdGlvbj1mdW5jdGlvbigpe0UuTC5zdG9wUHJvcGFnYXRpb24uY2FsbCh0aGlzKTt0aGlzLmZiLnN0b3BQcm9wYWdhdGlvbj90aGlzLmZiLnN0b3BQcm9wYWdhdGlvbigpOnRoaXMuZmIuY2FuY2VsQnViYmxlPSEwO307RS5wcm90b3R5cGUucHJldmVudERlZmF1bHQ9ZnVuY3Rpb24oKXtFLkwucHJldmVudERlZmF1bHQuY2FsbCh0aGlzKTt2YXIgYT10aGlzLmZiO2lmKGEucHJldmVudERlZmF1bHQpYS5wcmV2ZW50RGVmYXVsdCgpO2Vsc2UgaWYoYS5yZXR1cm5WYWx1ZT0hMSwgWWEpdHJ5e2lmKGEuY3RybEtleXx8MTEyPD1hLmtleUNvZGUmJjEyMz49YS5rZXlDb2RlKWEua2V5Q29kZT0tMTt9Y2F0Y2goYil7fX07dmFyIGFiPVwiY2xvc3VyZV9saXN0ZW5hYmxlX1wiKygxRTYqTWF0aC5yYW5kb20oKXwwKTtmdW5jdGlvbiBGKGEpe3JldHVybiEoIWF8fCFhW2FiXSl9dmFyIGJiPTA7ZnVuY3Rpb24gY2IoYSxiLGMsZCxmKXt0aGlzLmxpc3RlbmVyPWE7dGhpcy5wcm94eT1udWxsO3RoaXMuc3JjPWI7dGhpcy50eXBlPWM7dGhpcy5jYXB0dXJlPSEhZDt0aGlzLk9iPWY7dGhpcy5rZXk9KytiYjt0aGlzLlNhPXRoaXMuRWI9ITE7fWNiLnByb3RvdHlwZS5WYj1mdW5jdGlvbigpe3RoaXMuU2E9ITA7dGhpcy5PYj10aGlzLnNyYz10aGlzLnByb3h5PXRoaXMubGlzdGVuZXI9bnVsbDt9O2Z1bmN0aW9uIGRiKGEpe3RoaXMuc3JjPWE7dGhpcy5KPXt9O3RoaXMueGI9MDt9ZT1kYi5wcm90b3R5cGU7ZS5hZGQ9ZnVuY3Rpb24oYSxiLGMsZCxmKXt2YXIgZz1hLnRvU3RyaW5nKCk7YT10aGlzLkpbZ107YXx8KGE9dGhpcy5KW2ddPVtdLCB0aGlzLnhiKyspO3ZhciBrPWViKGEsYixkLGYpOy0xPGs/KGI9YVtrXSwgY3x8KGIuRWI9ITEpKTooYj1uZXcgY2IoYix0aGlzLnNyYyxnLCEhZCxmKSwgYi5FYj1jLCBhLnB1c2goYikpO3JldHVybiBifTtlLnJlbW92ZT1mdW5jdGlvbihhLGIsYyxkKXthPWEudG9TdHJpbmcoKTtpZighKGEgaW4gdGhpcy5KKSlyZXR1cm4hMTt2YXIgZj10aGlzLkpbYV07Yj1lYihmLGIsYyxkKTtyZXR1cm4tMTxiPyhmW2JdLlZiKCksIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChmLGIsMSksIDA9PWYubGVuZ3RoJiYoZGVsZXRlIHRoaXMuSlthXSwgdGhpcy54Yi0tKSwgITApOiExfTtcbmUueWU9ZnVuY3Rpb24oYSl7dmFyIGI9YS50eXBlO2IgaW4gdGhpcy5KJiZzYSh0aGlzLkpbYl0sYSkmJihhLlZiKCksIDA9PXRoaXMuSltiXS5sZW5ndGgmJihkZWxldGUgdGhpcy5KW2JdLCB0aGlzLnhiLS0pKTt9O2UucGI9ZnVuY3Rpb24oYSl7YT1hJiZhLnRvU3RyaW5nKCk7dmFyIGM7Zm9yKGMgaW4gdGhpcy5KKWlmKCFhfHxjPT1hKXtmb3IodmFyIGQ9dGhpcy5KW2NdLGY9MDtmPGQubGVuZ3RoO2YrKylkW2ZdLlZiKCk7ZGVsZXRlIHRoaXMuSltjXTt0aGlzLnhiLS07fX07ZS5qYj1mdW5jdGlvbihhLGIsYyxkKXthPXRoaXMuSlthLnRvU3RyaW5nKCldO3ZhciBmPS0xO2EmJihmPWViKGEsYixjLGQpKTtyZXR1cm4tMTxmP2FbZl06bnVsbH07ZnVuY3Rpb24gZWIoYSxiLGMsZCl7Zm9yKHZhciBmPTA7ZjxhLmxlbmd0aDsrK2Ype3ZhciBnPWFbZl07aWYoIWcuU2EmJmcubGlzdGVuZXI9PWImJmcuY2FwdHVyZT09ISFjJiZnLk9iPT1kKXJldHVybiBmfXJldHVybi0xfXZhciBmYj1cImNsb3N1cmVfbG1fXCIrKDFFNipNYXRoLnJhbmRvbSgpfDApLGdiPXt9O2Z1bmN0aW9uIGliKGEsYixjLGQsZil7aWYoZCYmZC5vbmNlKXJldHVybiBqYihhLGIsYyxkLGYpO2lmKG4oYikpe2Zvcih2YXIgZz0wO2c8Yi5sZW5ndGg7ZysrKWliKGEsYltnXSxjLGQsZik7cmV0dXJuIG51bGx9Yz1rYihjKTtyZXR1cm4gRihhKT9hLm5iKGIsYyxyKGQpPyEhZC5jYXB0dXJlOiEhZCxmKTpsYihhLGIsYywhMSxkLGYpfVxuZnVuY3Rpb24gbGIoYSxiLGMsZCxmLGcpe2lmKCFiKXRocm93IEVycm9yKFwiSW52YWxpZCBldmVudCB0eXBlXCIpO3ZhciBrPXIoZik/ISFmLmNhcHR1cmU6ISFmLHA9RyhhKTtwfHwoYVtmYl09cD1uZXcgZGIoYSkpO2M9cC5hZGQoYixjLGQsayxnKTtpZihjLnByb3h5KXJldHVybiBjO2Q9bWIoKTtjLnByb3h5PWQ7ZC5zcmM9YTtkLmxpc3RlbmVyPWM7aWYoYS5hZGRFdmVudExpc3RlbmVyKVphfHwoZj1rKSwgdm9pZCAwPT09ZiYmKGY9ITEpLCBhLmFkZEV2ZW50TGlzdGVuZXIoYi50b1N0cmluZygpLGQsZik7ZWxzZSBpZihhLmF0dGFjaEV2ZW50KWEuYXR0YWNoRXZlbnQobmIoYi50b1N0cmluZygpKSxkKTtlbHNlIGlmKGEuYWRkTGlzdGVuZXImJmEucmVtb3ZlTGlzdGVuZXIpYS5hZGRMaXN0ZW5lcihkKTtlbHNlIHRocm93IEVycm9yKFwiYWRkRXZlbnRMaXN0ZW5lciBhbmQgYXR0YWNoRXZlbnQgYXJlIHVuYXZhaWxhYmxlLlwiKTtyZXR1cm4gY31cbmZ1bmN0aW9uIG1iKCl7dmFyIGE9b2IsYj1YYT9mdW5jdGlvbihjKXtyZXR1cm4gYS5jYWxsKGIuc3JjLGIubGlzdGVuZXIsYyl9OmZ1bmN0aW9uKGMpe2M9YS5jYWxsKGIuc3JjLGIubGlzdGVuZXIsYyk7aWYoIWMpcmV0dXJuIGN9O3JldHVybiBifWZ1bmN0aW9uIGpiKGEsYixjLGQsZil7aWYobihiKSl7Zm9yKHZhciBnPTA7ZzxiLmxlbmd0aDtnKyspamIoYSxiW2ddLGMsZCxmKTtyZXR1cm4gbnVsbH1jPWtiKGMpO3JldHVybiBGKGEpP2EuT2MoYixjLHIoZCk/ISFkLmNhcHR1cmU6ISFkLGYpOmxiKGEsYixjLCEwLGQsZil9ZnVuY3Rpb24gcGIoYSxiLGMsZCxmKXtpZihuKGIpKWZvcih2YXIgZz0wO2c8Yi5sZW5ndGg7ZysrKXBiKGEsYltnXSxjLGQsZik7ZWxzZSBkPXIoZCk/ISFkLmNhcHR1cmU6ISFkLCBjPWtiKGMpLCBGKGEpP2EuZWQoYixjLGQsZik6YSYmKGE9RyhhKSkmJihiPWEuamIoYixjLGQsZikpJiZxYihiKTt9XG5mdW5jdGlvbiBxYihhKXtpZihcIm51bWJlclwiIT10eXBlb2YgYSYmYSYmIWEuU2Epe3ZhciBiPWEuc3JjO2lmKEYoYikpYi5MZShhKTtlbHNle3ZhciBjPWEudHlwZSxkPWEucHJveHk7Yi5yZW1vdmVFdmVudExpc3RlbmVyP2IucmVtb3ZlRXZlbnRMaXN0ZW5lcihjLGQsYS5jYXB0dXJlKTpiLmRldGFjaEV2ZW50P2IuZGV0YWNoRXZlbnQobmIoYyksZCk6Yi5hZGRMaXN0ZW5lciYmYi5yZW1vdmVMaXN0ZW5lciYmYi5yZW1vdmVMaXN0ZW5lcihkKTsoYz1HKGIpKT8oYy55ZShhKSwgMD09Yy54YiYmKGMuc3JjPW51bGwsIGJbZmJdPW51bGwpKTphLlZiKCk7fX19ZnVuY3Rpb24gbmIoYSl7cmV0dXJuIGEgaW4gZ2I/Z2JbYV06Z2JbYV09XCJvblwiK2F9XG5mdW5jdGlvbiByYihhLGIsYyxkKXt2YXIgZj0hMDtpZihhPUcoYSkpaWYoYj1hLkpbYi50b1N0cmluZygpXSlmb3IoYj1iLmNvbmNhdCgpLCBhPTA7YTxiLmxlbmd0aDthKyspe3ZhciBnPWJbYV07ZyYmZy5jYXB0dXJlPT1jJiYhZy5TYSYmKGc9c2IoZyxkKSwgZj1mJiYhMSE9PWcpO31yZXR1cm4gZn1mdW5jdGlvbiBzYihhLGIpe3ZhciBjPWEubGlzdGVuZXIsZD1hLk9ifHxhLnNyYzthLkViJiZxYihhKTtyZXR1cm4gYy5jYWxsKGQsYil9XG5mdW5jdGlvbiBvYihhLGIpe2lmKGEuU2EpcmV0dXJuITA7aWYoIVhhKXt2YXIgYz1ifHxtKFwid2luZG93LmV2ZW50XCIpO2I9bmV3IEUoYyx0aGlzKTt2YXIgZD0hMDtpZighKDA+Yy5rZXlDb2RlfHx2b2lkIDAhPWMucmV0dXJuVmFsdWUpKXthOnt2YXIgZj0hMTtpZigwPT1jLmtleUNvZGUpdHJ5e2Mua2V5Q29kZT0tMTticmVhayBhfWNhdGNoKGspe2Y9ITA7fWlmKGZ8fHZvaWQgMD09Yy5yZXR1cm5WYWx1ZSljLnJldHVyblZhbHVlPSEwO31jPVtdO2ZvcihmPWIuY3VycmVudFRhcmdldDtmO2Y9Zi5wYXJlbnROb2RlKWMucHVzaChmKTthPWEudHlwZTtmb3IoZj1jLmxlbmd0aC0xOyFiLkVhJiYwPD1mO2YtLSl7Yi5jdXJyZW50VGFyZ2V0PWNbZl07dmFyIGc9cmIoY1tmXSxhLCEwLGIpO2Q9ZCYmZzt9Zm9yKGY9MDshYi5FYSYmZjxjLmxlbmd0aDtmKyspYi5jdXJyZW50VGFyZ2V0PWNbZl0sIGc9cmIoY1tmXSxhLCExLGIpLCBkPWQmJmc7fXJldHVybiBkfXJldHVybiBzYihhLG5ldyBFKGIsdGhpcykpfVxuZnVuY3Rpb24gRyhhKXthPWFbZmJdO3JldHVybiBhIGluc3RhbmNlb2YgZGI/YTpudWxsfXZhciB0Yj1cIl9fY2xvc3VyZV9ldmVudHNfZm5fXCIrKDFFOSpNYXRoLnJhbmRvbSgpPj4+MCk7ZnVuY3Rpb24ga2IoYSl7aWYocShhKSlyZXR1cm4gYTthW3RiXXx8KGFbdGJdPWZ1bmN0aW9uKGIpe3JldHVybiBhLmhhbmRsZUV2ZW50KGIpfSk7cmV0dXJuIGFbdGJdfWZ1bmN0aW9uIEgoKXt6LmNhbGwodGhpcyk7dGhpcy5rYT1uZXcgZGIodGhpcyk7dGhpcy5QZT10aGlzO3RoaXMuVWM9bnVsbDt9eChILHopO0gucHJvdG90eXBlW2FiXT0hMDtlPUgucHJvdG90eXBlO2UuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyxkKXtpYih0aGlzLGEsYixjLGQpO307ZS5yZW1vdmVFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGEsYixjLGQpe3BiKHRoaXMsYSxiLGMsZCk7fTtcbmUuZGlzcGF0Y2hFdmVudD1mdW5jdGlvbihhKXt2YXIgYixjPXRoaXMuVWM7aWYoYylmb3IoYj1bXTtjO2M9Yy5VYyliLnB1c2goYyk7Yz10aGlzLlBlO3ZhciBkPWEudHlwZXx8YTtpZihsKGEpKWE9bmV3IEQoYSxjKTtlbHNlIGlmKGEgaW5zdGFuY2VvZiBEKWEudGFyZ2V0PWEudGFyZ2V0fHxjO2Vsc2V7dmFyIGY9YTthPW5ldyBEKGQsYyk7RmEoYSxmKTt9Zj0hMDtpZihiKWZvcih2YXIgZz1iLmxlbmd0aC0xOyFhLkVhJiYwPD1nO2ctLSl7dmFyIGs9YS5jdXJyZW50VGFyZ2V0PWJbZ107Zj1rLkxiKGQsITAsYSkmJmY7fWEuRWF8fChrPWEuY3VycmVudFRhcmdldD1jLCBmPWsuTGIoZCwhMCxhKSYmZiwgYS5FYXx8KGY9ay5MYihkLCExLGEpJiZmKSk7aWYoYilmb3IoZz0wOyFhLkVhJiZnPGIubGVuZ3RoO2crKylrPWEuY3VycmVudFRhcmdldD1iW2ddLCBmPWsuTGIoZCwhMSxhKSYmZjtyZXR1cm4gZn07XG5lLkY9ZnVuY3Rpb24oKXtILkwuRi5jYWxsKHRoaXMpO3RoaXMucGcoKTt0aGlzLlVjPW51bGw7fTtlLm5iPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmthLmFkZChTdHJpbmcoYSksYiwhMSxjLGQpfTtlLk9jPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmthLmFkZChTdHJpbmcoYSksYiwhMCxjLGQpfTtlLmVkPWZ1bmN0aW9uKGEsYixjLGQpe3RoaXMua2EucmVtb3ZlKFN0cmluZyhhKSxiLGMsZCk7fTtlLkxlPWZ1bmN0aW9uKGEpe3RoaXMua2EueWUoYSk7fTtlLnBnPWZ1bmN0aW9uKCl7dGhpcy5rYSYmdGhpcy5rYS5wYih2b2lkIDApO307XG5lLkxiPWZ1bmN0aW9uKGEsYixjKXthPXRoaXMua2EuSltTdHJpbmcoYSldO2lmKCFhKXJldHVybiEwO2E9YS5jb25jYXQoKTtmb3IodmFyIGQ9ITAsZj0wO2Y8YS5sZW5ndGg7KytmKXt2YXIgZz1hW2ZdO2lmKGcmJiFnLlNhJiZnLmNhcHR1cmU9PWIpe3ZhciBrPWcubGlzdGVuZXIscD1nLk9ifHxnLnNyYztnLkViJiZ0aGlzLkxlKGcpO2Q9ITEhPT1rLmNhbGwocCxjKSYmZDt9fXJldHVybiBkJiYwIT1jLkJlfTtlLmpiPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmthLmpiKFN0cmluZyhhKSxiLGMsZCl9O3ZhciB1Yj1oLkpTT04uc3RyaW5naWZ5O2Z1bmN0aW9uIHZiKGEsYil7dGhpcy5TZj0xMDA7dGhpcy5lZj1hO3RoaXMudWc9Yjt0aGlzLlpiPTA7dGhpcy5QYj1udWxsO312Yi5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKCl7aWYoMDx0aGlzLlpiKXt0aGlzLlpiLS07dmFyIGE9dGhpcy5QYjt0aGlzLlBiPWEubmV4dDthLm5leHQ9bnVsbDt9ZWxzZSBhPXRoaXMuZWYoKTtyZXR1cm4gYX07dmIucHJvdG90eXBlLnB1dD1mdW5jdGlvbihhKXt0aGlzLnVnKGEpO3RoaXMuWmI8dGhpcy5TZiYmKHRoaXMuWmIrKywgYS5uZXh0PXRoaXMuUGIsIHRoaXMuUGI9YSk7fTtmdW5jdGlvbiBJKCl7dGhpcy5sYz10aGlzLlZhPW51bGw7fXZhciB4Yj1uZXcgdmIoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHdifSxmdW5jdGlvbihhKXthLnJlc2V0KCk7fSk7SS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5BZigpO2Muc2V0KGEsYik7dGhpcy5sYz90aGlzLmxjLm5leHQ9Yzp0aGlzLlZhPWM7dGhpcy5sYz1jO307SS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDt0aGlzLlZhJiYoYT10aGlzLlZhLCB0aGlzLlZhPXRoaXMuVmEubmV4dCwgdGhpcy5WYXx8KHRoaXMubGM9bnVsbCksIGEubmV4dD1udWxsKTtyZXR1cm4gYX07SS5wcm90b3R5cGUud2c9ZnVuY3Rpb24oYSl7eGIucHV0KGEpO307SS5wcm90b3R5cGUuQWY9ZnVuY3Rpb24oKXtyZXR1cm4geGIuZ2V0KCl9O2Z1bmN0aW9uIHdiKCl7dGhpcy5uZXh0PXRoaXMuc2NvcGU9dGhpcy5HYz1udWxsO31cbndiLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oYSxiKXt0aGlzLkdjPWE7dGhpcy5zY29wZT1iO3RoaXMubmV4dD1udWxsO307d2IucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7dGhpcy5uZXh0PXRoaXMuc2NvcGU9dGhpcy5HYz1udWxsO307ZnVuY3Rpb24geWIoYSl7aC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dGhyb3cgYTt9LDApO312YXIgemI7XG5mdW5jdGlvbiBBYigpe3ZhciBhPWguTWVzc2FnZUNoYW5uZWw7XCJ1bmRlZmluZWRcIj09PXR5cGVvZiBhJiZcInVuZGVmaW5lZFwiIT09dHlwZW9mIHdpbmRvdyYmd2luZG93LnBvc3RNZXNzYWdlJiZ3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciYmIUIoXCJQcmVzdG9cIikmJihhPWZ1bmN0aW9uKCl7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIklGUkFNRVwiKTthLnN0eWxlLmRpc3BsYXk9XCJub25lXCI7YS5zcmM9XCJcIjtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoYSk7dmFyIGI9YS5jb250ZW50V2luZG93O2E9Yi5kb2N1bWVudDthLm9wZW4oKTthLndyaXRlKFwiXCIpO2EuY2xvc2UoKTt2YXIgYz1cImNhbGxJbW1lZGlhdGVcIitNYXRoLnJhbmRvbSgpLGQ9XCJmaWxlOlwiPT1iLmxvY2F0aW9uLnByb3RvY29sP1wiKlwiOmIubG9jYXRpb24ucHJvdG9jb2wrXCIvL1wiK2IubG9jYXRpb24uaG9zdDthPXUoZnVuY3Rpb24oYSl7aWYoKFwiKlwiPT1kfHxhLm9yaWdpbj09ZCkmJmEuZGF0YT09XG5jKXRoaXMucG9ydDEub25tZXNzYWdlKCk7fSx0aGlzKTtiLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsYSwhMSk7dGhpcy5wb3J0MT17fTt0aGlzLnBvcnQyPXtwb3N0TWVzc2FnZTpmdW5jdGlvbigpe2IucG9zdE1lc3NhZ2UoYyxkKTt9fTt9KTtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIGEmJiFCKFwiVHJpZGVudFwiKSYmIUIoXCJNU0lFXCIpKXt2YXIgYj1uZXcgYSxjPXt9LGQ9YztiLnBvcnQxLm9ubWVzc2FnZT1mdW5jdGlvbigpe2lmKHZvaWQgMCE9PWMubmV4dCl7Yz1jLm5leHQ7dmFyIGE9Yy5yZDtjLnJkPW51bGw7YSgpO319O3JldHVybiBmdW5jdGlvbihhKXtkLm5leHQ9e3JkOmF9O2Q9ZC5uZXh0O2IucG9ydDIucG9zdE1lc3NhZ2UoMCk7fX1yZXR1cm5cInVuZGVmaW5lZFwiIT09dHlwZW9mIGRvY3VtZW50JiZcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIlNDUklQVFwiKT9mdW5jdGlvbihhKXt2YXIgYj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiU0NSSVBUXCIpO1xuYi5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtiLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsO2IucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKTtiPW51bGw7YSgpO2E9bnVsbDt9O2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChiKTt9OmZ1bmN0aW9uKGEpe2guc2V0VGltZW91dChhLDApO319dmFyIEJiO2Z1bmN0aW9uIENiKCl7aWYoaC5Qcm9taXNlJiZoLlByb21pc2UucmVzb2x2ZSl7dmFyIGE9aC5Qcm9taXNlLnJlc29sdmUodm9pZCAwKTtCYj1mdW5jdGlvbigpe2EudGhlbihEYik7fTt9ZWxzZSBCYj1mdW5jdGlvbigpe3ZhciBhPURiOyFxKGguc2V0SW1tZWRpYXRlKXx8aC5XaW5kb3cmJmguV2luZG93LnByb3RvdHlwZSYmIUIoXCJFZGdlXCIpJiZoLldpbmRvdy5wcm90b3R5cGUuc2V0SW1tZWRpYXRlPT1oLnNldEltbWVkaWF0ZT8oemJ8fCh6Yj1BYigpKSwgemIoYSkpOmguc2V0SW1tZWRpYXRlKGEpO307fXZhciBFYj0hMSxGYj1uZXcgSTtmdW5jdGlvbiBEYigpe2Zvcih2YXIgYTthPUZiLnJlbW92ZSgpOyl7dHJ5e2EuR2MuY2FsbChhLnNjb3BlKTt9Y2F0Y2goYil7eWIoYik7fUZiLndnKGEpO31FYj0hMTt9ZnVuY3Rpb24gR2IoYSxiKXtILmNhbGwodGhpcyk7dGhpcy5OYT1hfHwxO3RoaXMud2I9Ynx8aDt0aGlzLm5kPXUodGhpcy5SZyx0aGlzKTt0aGlzLmllPXcoKTt9eChHYixIKTtlPUdiLnByb3RvdHlwZTtlLmVuYWJsZWQ9ITE7ZS5CPW51bGw7ZS5zZXRJbnRlcnZhbD1mdW5jdGlvbihhKXt0aGlzLk5hPWE7dGhpcy5CJiZ0aGlzLmVuYWJsZWQ/KHRoaXMuc3RvcCgpLCB0aGlzLnN0YXJ0KCkpOnRoaXMuQiYmdGhpcy5zdG9wKCk7fTtlLlJnPWZ1bmN0aW9uKCl7aWYodGhpcy5lbmFibGVkKXt2YXIgYT13KCktdGhpcy5pZTswPGEmJmE8LjgqdGhpcy5OYT90aGlzLkI9dGhpcy53Yi5zZXRUaW1lb3V0KHRoaXMubmQsdGhpcy5OYS1hKToodGhpcy5CJiYodGhpcy53Yi5jbGVhclRpbWVvdXQodGhpcy5CKSwgdGhpcy5CPW51bGwpLCB0aGlzLmZmKCksIHRoaXMuZW5hYmxlZCYmKHRoaXMuc3RvcCgpLCB0aGlzLnN0YXJ0KCkpKTt9fTtlLmZmPWZ1bmN0aW9uKCl7dGhpcy5kaXNwYXRjaEV2ZW50KFwidGlja1wiKTt9O1xuZS5zdGFydD1mdW5jdGlvbigpe3RoaXMuZW5hYmxlZD0hMDt0aGlzLkJ8fCh0aGlzLkI9dGhpcy53Yi5zZXRUaW1lb3V0KHRoaXMubmQsdGhpcy5OYSksIHRoaXMuaWU9dygpKTt9O2Uuc3RvcD1mdW5jdGlvbigpe3RoaXMuZW5hYmxlZD0hMTt0aGlzLkImJih0aGlzLndiLmNsZWFyVGltZW91dCh0aGlzLkIpLCB0aGlzLkI9bnVsbCk7fTtlLkY9ZnVuY3Rpb24oKXtHYi5MLkYuY2FsbCh0aGlzKTt0aGlzLnN0b3AoKTtkZWxldGUgdGhpcy53Yjt9O2Z1bmN0aW9uIEhiKGEsYixjKXtpZihxKGEpKWMmJihhPXUoYSxjKSk7ZWxzZSBpZihhJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLmhhbmRsZUV2ZW50KWE9dShhLmhhbmRsZUV2ZW50LGEpO2Vsc2UgdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGxpc3RlbmVyIGFyZ3VtZW50XCIpO3JldHVybiAyMTQ3NDgzNjQ3PE51bWJlcihiKT8tMTpoLnNldFRpbWVvdXQoYSxifHwwKX1mdW5jdGlvbiBJYihhLGIsYyl7ei5jYWxsKHRoaXMpO3RoaXMuVWY9bnVsbCE9Yz91KGEsYyk6YTt0aGlzLk5hPWI7dGhpcy5YZT11KHRoaXMuZmcsdGhpcyk7dGhpcy5xYz1bXTt9eChJYix6KTtlPUliLnByb3RvdHlwZTtlLlRhPSExO2Uub2I9MDtlLkI9bnVsbDtlLm1mPWZ1bmN0aW9uKGEpe3RoaXMucWM9YXJndW1lbnRzO3RoaXMuQnx8dGhpcy5vYj90aGlzLlRhPSEwOnRoaXMuQ2MoKTt9O2Uuc3RvcD1mdW5jdGlvbigpe3RoaXMuQiYmKGguY2xlYXJUaW1lb3V0KHRoaXMuQiksIHRoaXMuQj1udWxsLCB0aGlzLlRhPSExLCB0aGlzLnFjPVtdKTt9O2UucGF1c2U9ZnVuY3Rpb24oKXt0aGlzLm9iKys7fTtlLnJlc3VtZT1mdW5jdGlvbigpe3RoaXMub2ItLTt0aGlzLm9ifHwhdGhpcy5UYXx8dGhpcy5CfHwodGhpcy5UYT0hMSwgdGhpcy5DYygpKTt9O2UuRj1mdW5jdGlvbigpe0liLkwuRi5jYWxsKHRoaXMpO3RoaXMuc3RvcCgpO307XG5lLmZnPWZ1bmN0aW9uKCl7dGhpcy5CPW51bGw7dGhpcy5UYSYmIXRoaXMub2ImJih0aGlzLlRhPSExLCB0aGlzLkNjKCkpO307ZS5DYz1mdW5jdGlvbigpe3RoaXMuQj1IYih0aGlzLlhlLHRoaXMuTmEpO3RoaXMuVWYuYXBwbHkobnVsbCx0aGlzLnFjKTt9O2Z1bmN0aW9uIEpiKGEpe3ouY2FsbCh0aGlzKTt0aGlzLmk9YTt0aGlzLm89e307fXgoSmIseik7dmFyIEtiPVtdO2U9SmIucHJvdG90eXBlO2UubmI9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuVGYoYSxiLGMsZCl9O2UuVGY9ZnVuY3Rpb24oYSxiLGMsZCl7bihiKXx8KGImJihLYlswXT1iLnRvU3RyaW5nKCkpLCBiPUtiKTtmb3IodmFyIGY9MDtmPGIubGVuZ3RoO2YrKyl7dmFyIGc9aWIoYSxiW2ZdLGN8fHRoaXMuaGFuZGxlRXZlbnQsZHx8ITEsdGhpcy5pfHx0aGlzKTtpZighZylicmVhazt0aGlzLm9bZy5rZXldPWc7fXJldHVybiB0aGlzfTtlLk9jPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmplKGEsYixjLGQpfTtcbmUuamU9ZnVuY3Rpb24oYSxiLGMsZCxmKXtpZihuKGIpKWZvcih2YXIgZz0wO2c8Yi5sZW5ndGg7ZysrKXRoaXMuamUoYSxiW2ddLGMsZCxmKTtlbHNle2E9amIoYSxiLGN8fHRoaXMuaGFuZGxlRXZlbnQsZCxmfHx0aGlzLml8fHRoaXMpO2lmKCFhKXJldHVybiB0aGlzO3RoaXMub1thLmtleV09YTt9cmV0dXJuIHRoaXN9O2UuZWQ9ZnVuY3Rpb24oYSxiLGMsZCxmKXtpZihuKGIpKWZvcih2YXIgZz0wO2c8Yi5sZW5ndGg7ZysrKXRoaXMuZWQoYSxiW2ddLGMsZCxmKTtlbHNlIGM9Y3x8dGhpcy5oYW5kbGVFdmVudCwgZD1yKGQpPyEhZC5jYXB0dXJlOiEhZCwgZj1mfHx0aGlzLml8fHRoaXMsIGM9a2IoYyksIGQ9ISFkLCBiPUYoYSk/YS5qYihiLGMsZCxmKTphPyhhPUcoYSkpP2EuamIoYixjLGQsZik6bnVsbDpudWxsLCBiJiYocWIoYiksIGRlbGV0ZSB0aGlzLm9bYi5rZXldKTt9O1xuZS5wYj1mdW5jdGlvbigpe0FhKHRoaXMubyxmdW5jdGlvbihhLGIpe3RoaXMuby5oYXNPd25Qcm9wZXJ0eShiKSYmcWIoYSk7fSx0aGlzKTt0aGlzLm89e307fTtlLkY9ZnVuY3Rpb24oKXtKYi5MLkYuY2FsbCh0aGlzKTt0aGlzLnBiKCk7fTtlLmhhbmRsZUV2ZW50PWZ1bmN0aW9uKCl7dGhyb3cgRXJyb3IoXCJFdmVudEhhbmRsZXIuaGFuZGxlRXZlbnQgbm90IGltcGxlbWVudGVkXCIpO307ZnVuY3Rpb24gSihhLGIsYyl7dGhpcy5yZXNldChhLGIsYyx2b2lkIDAsdm9pZCAwKTt9Si5wcm90b3R5cGUuTWQ9bnVsbDtKLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbihhLGIsYyxkLGYpe3RoaXMubWI9YTtkZWxldGUgdGhpcy5NZDt9O0oucHJvdG90eXBlLkJnPWZ1bmN0aW9uKGEpe3RoaXMuTWQ9YTt9O0oucHJvdG90eXBlLkdlPWZ1bmN0aW9uKGEpe3RoaXMubWI9YTt9O2Z1bmN0aW9uIE1iKGEpe3RoaXMucGU9YTt0aGlzLlpkPXRoaXMudWM9dGhpcy5tYj10aGlzLiRiPW51bGw7fWZ1bmN0aW9uIEsoYSxiKXt0aGlzLm5hbWU9YTt0aGlzLnZhbHVlPWI7fUsucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZX07dmFyIE5iPW5ldyBLKFwiU0VWRVJFXCIsMUUzKSxPYj1uZXcgSyhcIldBUk5JTkdcIiw5MDApLFBiPW5ldyBLKFwiSU5GT1wiLDgwMCksUWI9bmV3IEsoXCJDT05GSUdcIiw3MDApLFJiPW5ldyBLKFwiRklORVwiLDUwMCk7ZT1NYi5wcm90b3R5cGU7ZS5nZXROYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGV9O2UuZ2V0UGFyZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJGJ9O2UucGY9ZnVuY3Rpb24oKXt0aGlzLnVjfHwodGhpcy51Yz17fSk7cmV0dXJuIHRoaXMudWN9O2UuR2U9ZnVuY3Rpb24oYSl7dGhpcy5tYj1hO307XG5lLlFkPWZ1bmN0aW9uKCl7aWYodGhpcy5tYilyZXR1cm4gdGhpcy5tYjtpZih0aGlzLiRiKXJldHVybiB0aGlzLiRiLlFkKCk7aWEoXCJSb290IGxvZ2dlciBoYXMgbm8gbGV2ZWwgc2V0LlwiKTtyZXR1cm4gbnVsbH07ZS5QZj1mdW5jdGlvbihhKXtyZXR1cm4gYS52YWx1ZT49dGhpcy5RZCgpLnZhbHVlfTtlLmxvZz1mdW5jdGlvbihhLGIsYyl7dGhpcy5QZihhKSYmKHEoYikmJihiPWIoKSksIHRoaXMuZ2YodGhpcy51ZihhLGIsYykpKTt9O2UudWY9ZnVuY3Rpb24oYSxiLGMpe2E9bmV3IEooYSxTdHJpbmcoYiksdGhpcy5wZSk7YyYmYS5CZyhjKTtyZXR1cm4gYX07ZS5jYT1mdW5jdGlvbihhLGIpe3RoaXMubG9nKE5iLGEsYik7fTtlLlQ9ZnVuY3Rpb24oYSxiKXt0aGlzLmxvZyhPYixhLGIpO307ZS5pbmZvPWZ1bmN0aW9uKGEsYil7dGhpcy5sb2coUGIsYSxiKTt9O2UubGY9ZnVuY3Rpb24oYSl7dGhpcy5sb2coUmIsYSx2b2lkIDApO307XG5lLmdmPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzO2I7KWIuV2UoYSksIGI9Yi5nZXRQYXJlbnQoKTt9O2UuV2U9ZnVuY3Rpb24oYSl7aWYodGhpcy5aZClmb3IodmFyIGI9MCxjO2M9dGhpcy5aZFtiXTtiKyspYyhhKTt9O2UuRmc9ZnVuY3Rpb24oYSl7dGhpcy4kYj1hO307ZS5RZT1mdW5jdGlvbihhLGIpe3RoaXMucGYoKVthXT1iO307dmFyIFNiPXt9LFRiPW51bGw7ZnVuY3Rpb24gVmIoYSl7VGJ8fChUYj1uZXcgTWIoXCJcIiksIFNiW1wiXCJdPVRiLCBUYi5HZShRYikpO3ZhciBiO2lmKCEoYj1TYlthXSkpe2I9bmV3IE1iKGEpO3ZhciBjPWEubGFzdEluZGV4T2YoXCIuXCIpLGQ9YS5zdWJzdHIoYysxKTtjPVZiKGEuc3Vic3RyKDAsYykpO2MuUWUoZCxiKTtiLkZnKGMpO1NiW2FdPWI7fXJldHVybiBifWZ1bmN0aW9uIFdiKGEsYil7YSYmYS5pbmZvKGIsdm9pZCAwKTt9ZnVuY3Rpb24gTChhLGIpe2EmJmEubGYoYik7fWZ1bmN0aW9uIFhiKCl7dGhpcy5zPVZiKFwiZ29vZy5sYWJzLm5ldC53ZWJDaGFubmVsLldlYkNoYW5uZWxEZWJ1Z1wiKTt0aGlzLldjPSEwO31lPVhiLnByb3RvdHlwZTtlLklkPWZ1bmN0aW9uKCl7dGhpcy5XYz0hMTt9O2UuVGc9ZnVuY3Rpb24oYSxiLGMsZCxmKXt2YXIgZz10aGlzO3RoaXMuaW5mbyhmdW5jdGlvbigpe3JldHVyblwiWE1MSFRUUCBSRVEgKFwiK2MrXCIpIFthdHRlbXB0IFwiK2QrXCJdOiBcIithK1wiXFxuXCIrYitcIlxcblwiK2cuWGYoZil9KTt9O2UuVWc9ZnVuY3Rpb24oYSxiLGMsZCxmLGcpe3RoaXMuaW5mbyhmdW5jdGlvbigpe3JldHVyblwiWE1MSFRUUCBSRVNQIChcIitjK1wiKSBbIGF0dGVtcHQgXCIrZCtcIl06IFwiK2ErXCJcXG5cIitiK1wiXFxuXCIrZitcIiBcIitnfSk7fTtlLldhPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzO3RoaXMuaW5mbyhmdW5jdGlvbigpe3JldHVyblwiWE1MSFRUUCBURVhUIChcIithK1wiKTogXCIrZC5uZyhiKSsoYz9cIiBcIitjOlwiXCIpfSk7fTtcbmUuU2c9ZnVuY3Rpb24oYSl7dGhpcy5pbmZvKGZ1bmN0aW9uKCl7cmV0dXJuXCJUSU1FT1VUOiBcIithfSk7fTtlLmRlYnVnPWZ1bmN0aW9uKGEpe0wodGhpcy5zLGEpO307ZS5jYj1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMucztjJiZjLmNhKGJ8fFwiRXhjZXB0aW9uXCIsYSk7fTtlLmluZm89ZnVuY3Rpb24oYSl7V2IodGhpcy5zLGEpO307ZS5UPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucztiJiZiLlQoYSx2b2lkIDApO307ZS5jYT1mdW5jdGlvbihhKXt2YXIgYj10aGlzLnM7YiYmYi5jYShhLHZvaWQgMCk7fTtcbmUubmc9ZnVuY3Rpb24oYSl7aWYoIXRoaXMuV2MpcmV0dXJuIGE7aWYoIWEpcmV0dXJuIG51bGw7dHJ5e3ZhciBiPUpTT04ucGFyc2UoYSk7aWYoYilmb3IodmFyIGM9MDtjPGIubGVuZ3RoO2MrKyluKGJbY10pJiZ0aGlzLldmKGJbY10pO3JldHVybiB1YihiKX1jYXRjaChkKXtyZXR1cm4gdGhpcy5kZWJ1ZyhcIkV4Y2VwdGlvbiBwYXJzaW5nIGV4cGVjdGVkIEpTIGFycmF5IC0gcHJvYmFibHkgd2FzIG5vdCBKU1wiKSwgYX19O2UuV2Y9ZnVuY3Rpb24oYSl7aWYoISgyPmEubGVuZ3RofHwoYT1hWzFdLCAhbihhKXx8MT5hLmxlbmd0aCkpKXt2YXIgYj1hWzBdO2lmKFwibm9vcFwiIT1iJiZcInN0b3BcIiE9YiYmXCJjbG9zZVwiIT1iKWZvcihiPTE7YjxhLmxlbmd0aDtiKyspYVtiXT1cIlwiO319O1xuZS5YZj1mdW5jdGlvbihhKXtpZighdGhpcy5XYylyZXR1cm4gYTtpZighYSlyZXR1cm4gbnVsbDt2YXIgYj1cIlwiO2E9YS5zcGxpdChcIiZcIik7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBkPWFbY10uc3BsaXQoXCI9XCIpO2lmKDE8ZC5sZW5ndGgpe3ZhciBmPWRbMF07ZD1kWzFdO3ZhciBnPWYuc3BsaXQoXCJfXCIpO2I9Mjw9Zy5sZW5ndGgmJlwidHlwZVwiPT1nWzFdP2IrKGYrXCI9XCIrZCtcIiZcIik6YisoZitcIj1yZWRhY3RlZCZcIik7fX1yZXR1cm4gYn07dmFyIE09bmV3IEg7ZnVuY3Rpb24gWWIoYSl7RC5jYWxsKHRoaXMsXCJzZXJ2ZXJyZWFjaGFiaWxpdHlcIixhKTt9eChZYixEKTtmdW5jdGlvbiBOKGEpe00uZGlzcGF0Y2hFdmVudChuZXcgWWIoTSxhKSk7fWZ1bmN0aW9uIFpiKGEsYil7RC5jYWxsKHRoaXMsXCJzdGF0ZXZlbnRcIixhKTt0aGlzLnN0YXQ9Yjt9eChaYixEKTtmdW5jdGlvbiBPKGEpe00uZGlzcGF0Y2hFdmVudChuZXcgWmIoTSxhKSk7fWZ1bmN0aW9uICRiKGEsYixjKXtELmNhbGwodGhpcyxcInRpbWluZ2V2ZW50XCIsYSk7dGhpcy5zaXplPWI7dGhpcy5ydHQ9Yzt9eCgkYixEKTtmdW5jdGlvbiBhYyhhLGIsYyl7TS5kaXNwYXRjaEV2ZW50KG5ldyAkYihNLGEsYixjKSk7fWZ1bmN0aW9uIFAoYSxiKXtpZighcShhKSl0aHJvdyBFcnJvcihcIkZuIG11c3Qgbm90IGJlIG51bGwgYW5kIG11c3QgYmUgYSBmdW5jdGlvblwiKTtyZXR1cm4gaC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YSgpO30sYil9dmFyIGJjPXtOT19FUlJPUjowLFZnOjEsYmg6MixhaDozLFlnOjQsJGc6NSxkaDo2LE5lOjcsVElNRU9VVDo4LGdoOjl9O3ZhciBjYz17WGc6XCJjb21wbGV0ZVwiLGtoOlwic3VjY2Vzc1wiLE9lOlwiZXJyb3JcIixOZTpcImFib3J0XCIsaWg6XCJyZWFkeVwiLGpoOlwicmVhZHlzdGF0ZWNoYW5nZVwiLFRJTUVPVVQ6XCJ0aW1lb3V0XCIsZWg6XCJpbmNyZW1lbnRhbGRhdGFcIixoaDpcInByb2dyZXNzXCIsWmc6XCJkb3dubG9hZHByb2dyZXNzXCIsbGg6XCJ1cGxvYWRwcm9ncmVzc1wifTtmdW5jdGlvbiBkYygpe31kYy5wcm90b3R5cGUucGQ9bnVsbDtkYy5wcm90b3R5cGUuVmQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wZHx8KHRoaXMucGQ9dGhpcy5NZigpKX07ZnVuY3Rpb24gZWMoKXt9dmFyIFE9e09QRU46XCJhXCIsV2c6XCJiXCIsT2U6XCJjXCIsZmg6XCJkXCJ9O2Z1bmN0aW9uIGZjKCl7RC5jYWxsKHRoaXMsXCJkXCIpO314KGZjLEQpO2Z1bmN0aW9uIGdjKCl7RC5jYWxsKHRoaXMsXCJjXCIpO314KGdjLEQpO3ZhciBoYztmdW5jdGlvbiBpYygpe314KGljLGRjKTtpYy5wcm90b3R5cGUuRGQ9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLldkKCk7cmV0dXJuIGE/bmV3IEFjdGl2ZVhPYmplY3QoYSk6bmV3IFhNTEh0dHBSZXF1ZXN0fTtpYy5wcm90b3R5cGUuTWY9ZnVuY3Rpb24oKXt2YXIgYT17fTt0aGlzLldkKCkmJihhWzBdPSEwLCBhWzFdPSEwKTtyZXR1cm4gYX07XG5pYy5wcm90b3R5cGUuV2Q9ZnVuY3Rpb24oKXtpZighdGhpcy5iZSYmXCJ1bmRlZmluZWRcIj09dHlwZW9mIFhNTEh0dHBSZXF1ZXN0JiZcInVuZGVmaW5lZFwiIT10eXBlb2YgQWN0aXZlWE9iamVjdCl7Zm9yKHZhciBhPVtcIk1TWE1MMi5YTUxIVFRQLjYuMFwiLFwiTVNYTUwyLlhNTEhUVFAuMy4wXCIsXCJNU1hNTDIuWE1MSFRUUFwiLFwiTWljcm9zb2Z0LlhNTEhUVFBcIl0sYj0wO2I8YS5sZW5ndGg7YisrKXt2YXIgYz1hW2JdO3RyeXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoYyksIHRoaXMuYmU9Y31jYXRjaChkKXt9fXRocm93IEVycm9yKFwiQ291bGQgbm90IGNyZWF0ZSBBY3RpdmVYT2JqZWN0LiBBY3RpdmVYIG1pZ2h0IGJlIGRpc2FibGVkLCBvciBNU1hNTCBtaWdodCBub3QgYmUgaW5zdGFsbGVkXCIpO31yZXR1cm4gdGhpcy5iZX07aGM9bmV3IGljO2Z1bmN0aW9uIFIoYSxiLGMsZCxmKXt0aGlzLmI9YTt0aGlzLmE9Yjt0aGlzLnJhPWM7dGhpcy5SPWQ7dGhpcy5YYz1mfHwxO3RoaXMuRmM9bmV3IEpiKHRoaXMpO3RoaXMuVWE9amM7YT1MYT8xMjU6dm9pZCAwO3RoaXMuVmM9bmV3IEdiKGEpO3RoaXMuQT1udWxsO3RoaXMuUz0hMTt0aGlzLkRhPXRoaXMucGE9dGhpcy51YT10aGlzLmljPXRoaXMucWI9dGhpcy5oZD10aGlzLkdhPW51bGw7dGhpcy5iYT1bXTt0aGlzLmg9bnVsbDt0aGlzLkJiPTA7dGhpcy5JPXRoaXMuRmE9bnVsbDt0aGlzLnc9LTE7dGhpcy5aYT0hMTt0aGlzLlJhPTA7dGhpcy5hYz1udWxsO3RoaXMubGI9dGhpcy5FZD10aGlzLnljPSExO312YXIgamM9NDVFMztcbmZ1bmN0aW9uIGtjKGEsYil7c3dpdGNoKGEpe2Nhc2UgMDpyZXR1cm5cIk5vbi0yMDAgcmV0dXJuIGNvZGUgKFwiK2IrXCIpXCI7Y2FzZSAxOnJldHVyblwiWE1MSFRUUCBmYWlsdXJlIChubyBkYXRhKVwiO2Nhc2UgMjpyZXR1cm5cIkh0dHBDb25uZWN0aW9uIHRpbWVvdXRcIjtkZWZhdWx0OnJldHVyblwiVW5rbm93biBlcnJvclwifX12YXIgbGM9e30sbWM9e307ZT1SLnByb3RvdHlwZTtlLmdhPWZ1bmN0aW9uKGEpe3RoaXMuQT1hO307ZS5zZXRUaW1lb3V0PWZ1bmN0aW9uKGEpe3RoaXMuVWE9YTt9O2UuSGU9ZnVuY3Rpb24oYSl7dGhpcy5SYT1hO307ZS5HZz1mdW5jdGlvbihhKXt0aGlzLmJhPWE7fTtlLmxhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmF9O2Uua2Q9ZnVuY3Rpb24oYSxiKXt0aGlzLmljPTE7dGhpcy51YT1hLmNsb25lKCkuVWIoKTt0aGlzLkRhPWI7dGhpcy55Yz0hMDt0aGlzLkNlKG51bGwpO307XG5lLmpkPWZ1bmN0aW9uKGEsYixjKXt0aGlzLmljPTE7dGhpcy51YT1hLmNsb25lKCkuVWIoKTt0aGlzLkRhPW51bGw7dGhpcy55Yz1iO3RoaXMuQ2UoYyk7fTtcbmUuQ2U9ZnVuY3Rpb24oYSl7dGhpcy5xYj13KCk7dGhpcy5lYigpO3RoaXMucGE9dGhpcy51YS5jbG9uZSgpO3RoaXMucGEuZGMoXCJ0XCIsdGhpcy5YYyk7dGhpcy5CYj0wO3RoaXMuaD10aGlzLmIuSmIodGhpcy5iLmZjKCk/YTpudWxsKTswPHRoaXMuUmEmJih0aGlzLmFjPW5ldyBJYih1KHRoaXMuTWUsdGhpcyx0aGlzLmgpLHRoaXMuUmEpKTt0aGlzLkZjLm5iKHRoaXMuaCxcInJlYWR5c3RhdGVjaGFuZ2VcIix0aGlzLm1nKTthPXRoaXMuQT9EYSh0aGlzLkEpOnt9O3RoaXMuRGE/KHRoaXMuRmF8fCh0aGlzLkZhPVwiUE9TVFwiKSwgYVtcIkNvbnRlbnQtVHlwZVwiXT1cImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLCB0aGlzLmguc2VuZCh0aGlzLnBhLHRoaXMuRmEsdGhpcy5EYSxhKSk6KHRoaXMuRmE9XCJHRVRcIiwgdGhpcy5oLnNlbmQodGhpcy5wYSx0aGlzLkZhLG51bGwsYSkpO04oMSk7dGhpcy5hLlRnKHRoaXMuRmEsdGhpcy5wYSx0aGlzLlIsdGhpcy5YYyx0aGlzLkRhKTt9O1xuZS5tZz1mdW5jdGlvbihhKXthPWEudGFyZ2V0O3ZhciBiPXRoaXMuYWM7YiYmMz09YS5tYSgpPyh0aGlzLmEuZGVidWcoXCJUaHJvdHRsaW5nIHJlYWR5c3RhdGVjaGFuZ2UuXCIpLCBiLm1mKCkpOnRoaXMuTWUoYSk7fTtlLk1lPWZ1bmN0aW9uKGEpe3RyeXthPT10aGlzLmg/dGhpcy5oZygpOnRoaXMuYS5UKFwiQ2FsbGVkIGJhY2sgd2l0aCBhbiB1bmV4cGVjdGVkIHhtbGh0dHBcIik7fWNhdGNoKGMpe2lmKHRoaXMuYS5kZWJ1ZyhcIkZhaWxlZCBjYWxsIHRvIE9uWG1sSHR0cFJlYWR5U3RhdGVDaGFuZ2VkX1wiKSwgdGhpcy5oJiZ0aGlzLmgueWEoKSl7dmFyIGI9dGhpczt0aGlzLmEuY2IoYyxmdW5jdGlvbigpe3JldHVyblwiUmVzcG9uc2VUZXh0OiBcIitiLmgueWEoKX0pO31lbHNlIHRoaXMuYS5jYihjLFwiTm8gcmVzcG9uc2UgdGV4dFwiKTt9ZmluYWxseXt9fTtcbmUuaGc9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmgubWEoKSxiPXRoaXMuaC5VZCgpLGM9dGhpcy5oLnphKCk7aWYoISgzPmF8fDM9PWEmJiFMYSYmIXRoaXMuaC55YSgpKSl7dGhpcy5aYXx8NCE9YXx8Nz09Ynx8KDg9PWJ8fDA+PWM/TigzKTpOKDIpKTt0aGlzLkZiKCk7dmFyIGQ9dGhpcy5oLnphKCk7dGhpcy53PWQ7Yj10aGlzLmgueWEoKTtpZighYil7dmFyIGY9dGhpczt0aGlzLmEuZGVidWcoZnVuY3Rpb24oKXtyZXR1cm5cIk5vIHJlc3BvbnNlIHRleHQgZm9yIHVyaSBcIitmLnBhK1wiIHN0YXR1cyBcIitkfSk7fXRoaXMuUz0yMDA9PWQ7dGhpcy5hLlVnKHRoaXMuRmEsdGhpcy5wYSx0aGlzLlIsdGhpcy5YYyxhLGQpO2lmKHRoaXMuUyl7aWYodGhpcy5JZygpKWlmKGM9dGhpcy5zZigpKXRoaXMuYS5XYSh0aGlzLlIsYyxcIkluaXRpYWwgaGFuZHNoYWtlIHJlc3BvbnNlIHZpYSBYLUhUVFAtSW5pdGlhbC1SZXNwb25zZVwiKSwgdGhpcy5sYj0hMCwgdGhpcy5ZYyhjKTtlbHNle3RoaXMuUz0hMTtcbnRoaXMuST0zO08oMTIpO3RoaXMuYS5UKFwiWE1MSFRUUCBNaXNzaW5nIFhfSFRUUF9JTklUSUFMX1JFU1BPTlNFIChcIit0aGlzLlIrXCIpXCIpO3RoaXMuSWEoKTt0aGlzLktiKCk7cmV0dXJufXRoaXMueWM/KHRoaXMuRmQoYSxiKSwgTGEmJnRoaXMuUyYmMz09YSYmdGhpcy5OZygpKToodGhpcy5hLldhKHRoaXMuUixiLG51bGwpLCB0aGlzLlljKGIpKTs0PT1hJiZ0aGlzLklhKCk7dGhpcy5TJiYhdGhpcy5aYSYmKDQ9PWE/dGhpcy5iLlRjKHRoaXMpOih0aGlzLlM9ITEsIHRoaXMuZWIoKSkpO31lbHNlIDQwMD09ZCYmMDxiLmluZGV4T2YoXCJVbmtub3duIFNJRFwiKT8odGhpcy5JPTMsIE8oMTIpLCB0aGlzLmEuVChcIlhNTEhUVFAgVW5rbm93biBTSUQgKFwiK3RoaXMuUitcIilcIikpOih0aGlzLkk9MCwgTygxMyksIHRoaXMuYS5UKFwiWE1MSFRUUCBCYWQgc3RhdHVzIFwiK2QrXCIgKFwiK3RoaXMuUitcIilcIikpLCB0aGlzLklhKCksIHRoaXMuS2IoKTt9fTtlLklnPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuRWQmJiF0aGlzLmxifTtcbmUuc2Y9ZnVuY3Rpb24oKXtpZih0aGlzLmgpe3ZhciBhPXRoaXMuaC5rYihcIlgtSFRUUC1Jbml0aWFsLVJlc3BvbnNlXCIpO2lmKGEmJiF2YShhKSlyZXR1cm4gYX1yZXR1cm4gbnVsbH07ZS5BZz1mdW5jdGlvbigpe3RoaXMuRWQ9ITA7fTtcbmUuRmQ9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9ITA7IXRoaXMuWmEmJnRoaXMuQmI8Yi5sZW5ndGg7KXt2YXIgZD10aGlzLnZmKGIpO2lmKGQ9PW1jKXs0PT1hJiYodGhpcy5JPTQsIE8oMTQpLCBjPSExKTt0aGlzLmEuV2EodGhpcy5SLG51bGwsXCJbSW5jb21wbGV0ZSBSZXNwb25zZV1cIik7YnJlYWt9ZWxzZSBpZihkPT1sYyl7dGhpcy5JPTQ7TygxNSk7dGhpcy5hLldhKHRoaXMuUixiLFwiW0ludmFsaWQgQ2h1bmtdXCIpO2M9ITE7YnJlYWt9ZWxzZSB0aGlzLmEuV2EodGhpcy5SLGQsbnVsbCksIHRoaXMuWWMoZCk7fTQ9PWEmJjA9PWIubGVuZ3RoJiYodGhpcy5JPTEsIE8oMTYpLCBjPSExKTt0aGlzLlM9dGhpcy5TJiZjO2N8fCh0aGlzLmEuV2EodGhpcy5SLGIsXCJbSW52YWxpZCBDaHVua2VkIFJlc3BvbnNlXVwiKSwgdGhpcy5JYSgpLCB0aGlzLktiKCkpO307XG5lLmtnPWZ1bmN0aW9uKCl7aWYodGhpcy5oKXt2YXIgYT10aGlzLmgubWEoKSxiPXRoaXMuaC55YSgpO3RoaXMuQmI8Yi5sZW5ndGgmJih0aGlzLkZiKCksIHRoaXMuRmQoYSxiKSwgdGhpcy5TJiY0IT1hJiZ0aGlzLmViKCkpO319O2UuTmc9ZnVuY3Rpb24oKXt0aGlzLkZjLm5iKHRoaXMuVmMsXCJ0aWNrXCIsdGhpcy5rZyk7dGhpcy5WYy5zdGFydCgpO307ZS52Zj1mdW5jdGlvbihhKXt2YXIgYj10aGlzLkJiLGM9YS5pbmRleE9mKFwiXFxuXCIsYik7aWYoLTE9PWMpcmV0dXJuIG1jO2I9TnVtYmVyKGEuc3Vic3RyaW5nKGIsYykpO2lmKGlzTmFOKGIpKXJldHVybiBsYztjKz0xO2lmKGMrYj5hLmxlbmd0aClyZXR1cm4gbWM7YT1hLnN1YnN0cihjLGIpO3RoaXMuQmI9YytiO3JldHVybiBhfTtcbmUueWc9ZnVuY3Rpb24oYSl7dGhpcy5pYz0yO3RoaXMudWE9YS5jbG9uZSgpLlViKCk7YT0hMTtoLm5hdmlnYXRvciYmaC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbiYmKGE9aC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbih0aGlzLnVhLnRvU3RyaW5nKCksXCJcIikpOyFhJiZoLkltYWdlJiYoKG5ldyBJbWFnZSkuc3JjPXRoaXMudWEsIGE9ITApO2F8fCh0aGlzLmg9dGhpcy5iLkpiKG51bGwpLCB0aGlzLmguc2VuZCh0aGlzLnVhKSk7dGhpcy5xYj13KCk7dGhpcy5lYigpO307ZS5jYW5jZWw9ZnVuY3Rpb24oKXt0aGlzLlphPSEwO3RoaXMuSWEoKTt9O2UudGc9ZnVuY3Rpb24oYSl7YSYmdGhpcy5zZXRUaW1lb3V0KGEpO3RoaXMuR2EmJih0aGlzLkZiKCksIHRoaXMuZWIoKSk7fTtlLmViPWZ1bmN0aW9uKCl7dGhpcy5oZD13KCkrdGhpcy5VYTt0aGlzLktlKHRoaXMuVWEpO307XG5lLktlPWZ1bmN0aW9uKGEpe2lmKG51bGwhPXRoaXMuR2EpdGhyb3cgRXJyb3IoXCJXYXRjaERvZyB0aW1lciBub3QgbnVsbFwiKTt0aGlzLkdhPVAodSh0aGlzLmdnLHRoaXMpLGEpO307ZS5GYj1mdW5jdGlvbigpe3RoaXMuR2EmJihoLmNsZWFyVGltZW91dCh0aGlzLkdhKSwgdGhpcy5HYT1udWxsKTt9O2UuZ2c9ZnVuY3Rpb24oKXt0aGlzLkdhPW51bGw7dmFyIGE9dygpOzA8PWEtdGhpcy5oZD90aGlzLkRmKCk6KHRoaXMuYS5UKFwiV2F0Y2hEb2cgdGltZXIgY2FsbGVkIHRvbyBlYXJseVwiKSwgdGhpcy5LZSh0aGlzLmhkLWEpKTt9O2UuRGY9ZnVuY3Rpb24oKXt0aGlzLlMmJnRoaXMuYS5jYShcIlJlY2VpdmVkIHdhdGNoZG9nIHRpbWVvdXQgZXZlbiB0aG91Z2ggcmVxdWVzdCBsb2FkZWQgc3VjY2Vzc2Z1bGx5XCIpO3RoaXMuYS5TZyh0aGlzLnBhKTsyIT10aGlzLmljJiYoTigzKSwgTygxNykpO3RoaXMuSWEoKTt0aGlzLkk9Mjt0aGlzLktiKCk7fTtcbmUuS2I9ZnVuY3Rpb24oKXt0aGlzLmIuZGUoKXx8dGhpcy5aYXx8dGhpcy5iLlRjKHRoaXMpO307ZS5JYT1mdW5jdGlvbigpe3RoaXMuRmIoKTt2YXIgYT10aGlzLmFjO2EmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuYmImJmEuYmIoKTt0aGlzLmFjPW51bGw7dGhpcy5WYy5zdG9wKCk7dGhpcy5GYy5wYigpO3RoaXMuaCYmKGE9dGhpcy5oLCB0aGlzLmg9bnVsbCwgYS5hYm9ydCgpLCBhLmJiKCkpO307ZS5IYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLkl9O2UuWWM9ZnVuY3Rpb24oYSl7dHJ5e3RoaXMuYi51ZSh0aGlzLGEpLCBOKDQpO31jYXRjaChiKXt0aGlzLmEuY2IoYixcIkVycm9yIGluIGh0dHByZXF1ZXN0IGNhbGxiYWNrXCIpO319O2Z1bmN0aW9uIG5jKGEpe2lmKGEuSCYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5IKXJldHVybiBhLkgoKTtpZihsKGEpKXJldHVybiBhLnNwbGl0KFwiXCIpO2lmKGNhKGEpKXtmb3IodmFyIGI9W10sYz1hLmxlbmd0aCxkPTA7ZDxjO2QrKyliLnB1c2goYVtkXSk7cmV0dXJuIGJ9cmV0dXJuIEJhKGEpfVxuZnVuY3Rpb24gb2MoYSxiLGMpe2lmKGEuZm9yRWFjaCYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5mb3JFYWNoKWEuZm9yRWFjaChiLGMpO2Vsc2UgaWYoY2EoYSl8fGwoYSkpbmEoYSxiLGMpO2Vsc2V7aWYoYS5XJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLlcpdmFyIGQ9YS5XKCk7ZWxzZSBpZihhLkgmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuSClkPXZvaWQgMDtlbHNlIGlmKGNhKGEpfHxsKGEpKXtkPVtdO2Zvcih2YXIgZj1hLmxlbmd0aCxnPTA7ZzxmO2crKylkLnB1c2goZyk7fWVsc2UgZD1DYShhKTtmPW5jKGEpO2c9Zi5sZW5ndGg7Zm9yKHZhciBrPTA7azxnO2srKyliLmNhbGwoYyxmW2tdLGQmJmRba10sYSk7fX1mdW5jdGlvbiBTKGEsYil7dGhpcy5EPXt9O3RoaXMubz1bXTt0aGlzLmo9MDt2YXIgYz1hcmd1bWVudHMubGVuZ3RoO2lmKDE8Yyl7aWYoYyUyKXRocm93IEVycm9yKFwiVW5ldmVuIG51bWJlciBvZiBhcmd1bWVudHNcIik7Zm9yKHZhciBkPTA7ZDxjO2QrPTIpdGhpcy5zZXQoYXJndW1lbnRzW2RdLGFyZ3VtZW50c1tkKzFdKTt9ZWxzZSBhJiZ0aGlzLmFkZEFsbChhKTt9ZT1TLnByb3RvdHlwZTtlLkM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtlLkg9ZnVuY3Rpb24oKXt0aGlzLndjKCk7Zm9yKHZhciBhPVtdLGI9MDtiPHRoaXMuby5sZW5ndGg7YisrKWEucHVzaCh0aGlzLkRbdGhpcy5vW2JdXSk7cmV0dXJuIGF9O2UuVz1mdW5jdGlvbigpe3RoaXMud2MoKTtyZXR1cm4gdGhpcy5vLmNvbmNhdCgpfTtlLnZhPWZ1bmN0aW9uKGEpe3JldHVybiBUKHRoaXMuRCxhKX07ZS5YPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PXRoaXMuan07XG5lLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5EPXt9O3RoaXMuaj10aGlzLm8ubGVuZ3RoPTA7fTtlLnJlbW92ZT1mdW5jdGlvbihhKXtyZXR1cm4gVCh0aGlzLkQsYSk/KGRlbGV0ZSB0aGlzLkRbYV0sIHRoaXMuai0tLCB0aGlzLm8ubGVuZ3RoPjIqdGhpcy5qJiZ0aGlzLndjKCksICEwKTohMX07ZS53Yz1mdW5jdGlvbigpe2lmKHRoaXMuaiE9dGhpcy5vLmxlbmd0aCl7Zm9yKHZhciBhPTAsYj0wO2E8dGhpcy5vLmxlbmd0aDspe3ZhciBjPXRoaXMub1thXTtUKHRoaXMuRCxjKSYmKHRoaXMub1tiKytdPWMpO2ErKzt9dGhpcy5vLmxlbmd0aD1iO31pZih0aGlzLmohPXRoaXMuby5sZW5ndGgpe3ZhciBkPXt9O2ZvcihiPWE9MDthPHRoaXMuby5sZW5ndGg7KWM9dGhpcy5vW2FdLCBUKGQsYyl8fCh0aGlzLm9bYisrXT1jLCBkW2NdPTEpLCBhKys7dGhpcy5vLmxlbmd0aD1iO319O2UuZ2V0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIFQodGhpcy5ELGEpP3RoaXMuRFthXTpifTtcbmUuc2V0PWZ1bmN0aW9uKGEsYil7VCh0aGlzLkQsYSl8fCh0aGlzLmorKywgdGhpcy5vLnB1c2goYSkpO3RoaXMuRFthXT1iO307ZS5hZGRBbGw9ZnVuY3Rpb24oYSl7aWYoYSBpbnN0YW5jZW9mIFMpZm9yKHZhciBiPWEuVygpLGM9MDtjPGIubGVuZ3RoO2MrKyl0aGlzLnNldChiW2NdLGEuZ2V0KGJbY10pKTtlbHNlIGZvcihiIGluIGEpdGhpcy5zZXQoYixhW2JdKTt9O2UuZm9yRWFjaD1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz10aGlzLlcoKSxkPTA7ZDxjLmxlbmd0aDtkKyspe3ZhciBmPWNbZF0sZz10aGlzLmdldChmKTthLmNhbGwoYixnLGYsdGhpcyk7fX07ZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgUyh0aGlzKX07ZnVuY3Rpb24gVChhLGIpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSxiKX12YXIgcGM9L14oPzooW146Lz8jLl0rKTopPyg/OlxcL1xcLyg/OihbXi8/I10qKUApPyhbXi8jP10qPykoPzo6KFswLTldKykpPyg/PVsvIz9dfCQpKT8oW14/I10rKT8oPzpcXD8oW14jXSopKT8oPzojKFtcXHNcXFNdKikpPyQvO2Z1bmN0aW9uIHFjKGEsYil7aWYoYSl7YT1hLnNwbGl0KFwiJlwiKTtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKyl7dmFyIGQ9YVtjXS5pbmRleE9mKFwiPVwiKSxmPW51bGw7aWYoMDw9ZCl7dmFyIGc9YVtjXS5zdWJzdHJpbmcoMCxkKTtmPWFbY10uc3Vic3RyaW5nKGQrMSk7fWVsc2UgZz1hW2NdO2IoZyxmP2RlY29kZVVSSUNvbXBvbmVudChmLnJlcGxhY2UoL1xcKy9nLFwiIFwiKSk6XCJcIik7fX19ZnVuY3Rpb24gVShhLGIpe3RoaXMueGE9dGhpcy56Yj10aGlzLnFhPVwiXCI7dGhpcy5DYT1udWxsO3RoaXMuaWI9dGhpcy5LPVwiXCI7dGhpcy5PPXRoaXMuUWY9ITE7dmFyIGM7YSBpbnN0YW5jZW9mIFU/KHRoaXMuTz12b2lkIDAhPT1iP2I6YS5PLCB0aGlzLnRiKGEucWEpLCB0aGlzLmNkKGEuemIpLCB0aGlzLnJiKGEueGEpLCB0aGlzLnNiKGEuQ2EpLCB0aGlzLmVjKGEuSyksIHRoaXMuYmQoYS5QLmNsb25lKCkpLCB0aGlzLiRjKGEuaWIpKTphJiYoYz1TdHJpbmcoYSkubWF0Y2gocGMpKT8odGhpcy5PPSEhYiwgdGhpcy50YihjWzFdfHxcIlwiLCEwKSwgdGhpcy5jZChjWzJdfHxcIlwiLCEwKSwgdGhpcy5yYihjWzNdfHxcIlwiLCEwKSwgdGhpcy5zYihjWzRdKSwgdGhpcy5lYyhjWzVdfHxcIlwiLCEwKSwgdGhpcy5iZChjWzZdfHxcIlwiLCEwKSwgdGhpcy4kYyhjWzddfHxcIlwiLCEwKSk6KHRoaXMuTz0hIWIsIHRoaXMuUD1uZXcgcmMobnVsbCx0aGlzLk8pKTt9ZT1VLnByb3RvdHlwZTtcbmUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgYT1bXSxiPXRoaXMucWE7YiYmYS5wdXNoKHNjKGIsdGMsITApLFwiOlwiKTt2YXIgYz10aGlzLnhhO2lmKGN8fFwiZmlsZVwiPT1iKWEucHVzaChcIi8vXCIpLCAoYj10aGlzLnpiKSYmYS5wdXNoKHNjKGIsdGMsITApLFwiQFwiKSwgYS5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoYykpLnJlcGxhY2UoLyUyNShbMC05YS1mQS1GXXsyfSkvZyxcIiUkMVwiKSksIGM9dGhpcy5DYSwgbnVsbCE9YyYmYS5wdXNoKFwiOlwiLFN0cmluZyhjKSk7aWYoYz10aGlzLkspdGhpcy5JYygpJiZcIi9cIiE9Yy5jaGFyQXQoMCkmJmEucHVzaChcIi9cIiksIGEucHVzaChzYyhjLFwiL1wiPT1jLmNoYXJBdCgwKT91Yzp3YywhMCkpOyhjPXRoaXMuUmQoKSkmJmEucHVzaChcIj9cIixjKTsoYz10aGlzLmliKSYmYS5wdXNoKFwiI1wiLHNjKGMseGMpKTtyZXR1cm4gYS5qb2luKFwiXCIpfTtcbmUucmVzb2x2ZT1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmNsb25lKCksYz1hLkhmKCk7Yz9iLnRiKGEucWEpOmM9YS5JZigpO2M/Yi5jZChhLnpiKTpjPWEuSWMoKTtjP2IucmIoYS54YSk6Yz1hLkZmKCk7dmFyIGQ9YS5LO2lmKGMpYi5zYihhLkNhKTtlbHNlIGlmKGM9YS5hZSgpKXtpZihcIi9cIiE9ZC5jaGFyQXQoMCkpaWYodGhpcy5JYygpJiYhdGhpcy5hZSgpKWQ9XCIvXCIrZDtlbHNle3ZhciBmPWIuSy5sYXN0SW5kZXhPZihcIi9cIik7LTEhPWYmJihkPWIuSy5zdWJzdHIoMCxmKzEpK2QpO31mPWQ7aWYoXCIuLlwiPT1mfHxcIi5cIj09ZilkPVwiXCI7ZWxzZSBpZigtMSE9Zi5pbmRleE9mKFwiLi9cIil8fC0xIT1mLmluZGV4T2YoXCIvLlwiKSl7ZD0wPT1mLmxhc3RJbmRleE9mKFwiL1wiLDApO2Y9Zi5zcGxpdChcIi9cIik7Zm9yKHZhciBnPVtdLGs9MDtrPGYubGVuZ3RoOyl7dmFyIHA9ZltrKytdO1wiLlwiPT1wP2QmJms9PWYubGVuZ3RoJiZnLnB1c2goXCJcIik6XCIuLlwiPT1wPygoMTxnLmxlbmd0aHx8MT09Zy5sZW5ndGgmJlxuXCJcIiE9Z1swXSkmJmcucG9wKCksIGQmJms9PWYubGVuZ3RoJiZnLnB1c2goXCJcIikpOihnLnB1c2gocCksIGQ9ITApO31kPWcuam9pbihcIi9cIik7fWVsc2UgZD1mO31jP2IuZWMoZCk6Yz1hLkdmKCk7Yz9iLmJkKGEuUC5jbG9uZSgpKTpjPWEuRWYoKTtjJiZiLiRjKGEuaWIpO3JldHVybiBifTtlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBVKHRoaXMpfTtlLnRiPWZ1bmN0aW9uKGEsYil7dGhpcy5VKCk7aWYodGhpcy5xYT1iP3ljKGEsITApOmEpdGhpcy5xYT10aGlzLnFhLnJlcGxhY2UoLzokLyxcIlwiKTt9O2UuSGY9ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMucWF9O2UuY2Q9ZnVuY3Rpb24oYSxiKXt0aGlzLlUoKTt0aGlzLnpiPWI/eWMoYSk6YTt9O2UuSWY9ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuemJ9O2UucmI9ZnVuY3Rpb24oYSxiKXt0aGlzLlUoKTt0aGlzLnhhPWI/eWMoYSwhMCk6YTt9O2UuSWM9ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMueGF9O1xuZS5zYj1mdW5jdGlvbihhKXt0aGlzLlUoKTtpZihhKXthPU51bWJlcihhKTtpZihpc05hTihhKXx8MD5hKXRocm93IEVycm9yKFwiQmFkIHBvcnQgbnVtYmVyIFwiK2EpO3RoaXMuQ2E9YTt9ZWxzZSB0aGlzLkNhPW51bGw7fTtlLkZmPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPXRoaXMuQ2F9O2UuZWM9ZnVuY3Rpb24oYSxiKXt0aGlzLlUoKTt0aGlzLks9Yj95YyhhLCEwKTphO307ZS5hZT1mdW5jdGlvbigpe3JldHVybiEhdGhpcy5LfTtlLkdmPWZ1bmN0aW9uKCl7cmV0dXJuXCJcIiE9PXRoaXMuUC50b1N0cmluZygpfTtlLmJkPWZ1bmN0aW9uKGEsYil7dGhpcy5VKCk7YSBpbnN0YW5jZW9mIHJjPyh0aGlzLlA9YSwgdGhpcy5QLmFkKHRoaXMuTykpOihifHwoYT1zYyhhLHpjKSksIHRoaXMuUD1uZXcgcmMoYSx0aGlzLk8pKTt9O2UuUmQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5QLnRvU3RyaW5nKCl9O2UuZ2V0UXVlcnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5SZCgpfTtcbmUubD1mdW5jdGlvbihhLGIpe3RoaXMuVSgpO3RoaXMuUC5zZXQoYSxiKTt9O2UuZGM9ZnVuY3Rpb24oYSxiKXt0aGlzLlUoKTtuKGIpfHwoYj1bU3RyaW5nKGIpXSk7dGhpcy5QLkllKGEsYik7fTtlLiRjPWZ1bmN0aW9uKGEsYil7dGhpcy5VKCk7dGhpcy5pYj1iP3ljKGEpOmE7fTtlLkVmPWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLmlifTtlLlViPWZ1bmN0aW9uKCl7dGhpcy5VKCk7dGhpcy5sKFwienhcIixNYXRoLmZsb29yKDIxNDc0ODM2NDgqTWF0aC5yYW5kb20oKSkudG9TdHJpbmcoMzYpK01hdGguYWJzKE1hdGguZmxvb3IoMjE0NzQ4MzY0OCpNYXRoLnJhbmRvbSgpKV53KCkpLnRvU3RyaW5nKDM2KSk7cmV0dXJuIHRoaXN9O2UucmVtb3ZlUGFyYW1ldGVyPWZ1bmN0aW9uKGEpe3RoaXMuVSgpO3RoaXMuUC5yZW1vdmUoYSk7cmV0dXJuIHRoaXN9O2UuVT1mdW5jdGlvbigpe2lmKHRoaXMuUWYpdGhyb3cgRXJyb3IoXCJUcmllZCB0byBtb2RpZnkgYSByZWFkLW9ubHkgVXJpXCIpO307XG5lLmFkPWZ1bmN0aW9uKGEpe3RoaXMuTz1hO3RoaXMuUCYmdGhpcy5QLmFkKGEpO307ZnVuY3Rpb24gQWMoYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBVP2EuY2xvbmUoKTpuZXcgVShhLHZvaWQgMCl9ZnVuY3Rpb24gQmMoYSxiLGMsZCl7dmFyIGY9bmV3IFUobnVsbCx2b2lkIDApO2EmJmYudGIoYSk7YiYmZi5yYihiKTtjJiZmLnNiKGMpO2QmJmYuZWMoZCk7cmV0dXJuIGZ9ZnVuY3Rpb24geWMoYSxiKXtyZXR1cm4gYT9iP2RlY29kZVVSSShhLnJlcGxhY2UoLyUyNS9nLFwiJTI1MjVcIikpOmRlY29kZVVSSUNvbXBvbmVudChhKTpcIlwifWZ1bmN0aW9uIHNjKGEsYixjKXtyZXR1cm4gbChhKT8oYT1lbmNvZGVVUkkoYSkucmVwbGFjZShiLENjKSwgYyYmKGE9YS5yZXBsYWNlKC8lMjUoWzAtOWEtZkEtRl17Mn0pL2csXCIlJDFcIikpLCBhKTpudWxsfVxuZnVuY3Rpb24gQ2MoYSl7YT1hLmNoYXJDb2RlQXQoMCk7cmV0dXJuXCIlXCIrKGE+PjQmMTUpLnRvU3RyaW5nKDE2KSsoYSYxNSkudG9TdHJpbmcoMTYpfXZhciB0Yz0vWyNcXC9cXD9AXS9nLHdjPS9bI1xcPzpdL2csdWM9L1sjXFw/XS9nLHpjPS9bI1xcP0BdL2cseGM9LyMvZztmdW5jdGlvbiByYyhhLGIpe3RoaXMuaj10aGlzLm09bnVsbDt0aGlzLmphPWF8fG51bGw7dGhpcy5PPSEhYjt9ZT1yYy5wcm90b3R5cGU7ZS4kPWZ1bmN0aW9uKCl7aWYoIXRoaXMubSYmKHRoaXMubT1uZXcgUywgdGhpcy5qPTAsIHRoaXMuamEpKXt2YXIgYT10aGlzO3FjKHRoaXMuamEsZnVuY3Rpb24oYixjKXthLmFkZChkZWNvZGVVUklDb21wb25lbnQoYi5yZXBsYWNlKC9cXCsvZyxcIiBcIikpLGMpO30pO319O2UuQz1mdW5jdGlvbigpe3RoaXMuJCgpO3JldHVybiB0aGlzLmp9O1xuZS5hZGQ9ZnVuY3Rpb24oYSxiKXt0aGlzLiQoKTt0aGlzLk9hKCk7YT10aGlzLk1hKGEpO3ZhciBjPXRoaXMubS5nZXQoYSk7Y3x8dGhpcy5tLnNldChhLGM9W10pO2MucHVzaChiKTt0aGlzLmorPTE7cmV0dXJuIHRoaXN9O2UucmVtb3ZlPWZ1bmN0aW9uKGEpe3RoaXMuJCgpO2E9dGhpcy5NYShhKTtyZXR1cm4gdGhpcy5tLnZhKGEpPyh0aGlzLk9hKCksIHRoaXMuai09dGhpcy5tLmdldChhKS5sZW5ndGgsIHRoaXMubS5yZW1vdmUoYSkpOiExfTtlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5PYSgpO3RoaXMubT1udWxsO3RoaXMuaj0wO307ZS5YPWZ1bmN0aW9uKCl7dGhpcy4kKCk7cmV0dXJuIDA9PXRoaXMuan07ZS52YT1mdW5jdGlvbihhKXt0aGlzLiQoKTthPXRoaXMuTWEoYSk7cmV0dXJuIHRoaXMubS52YShhKX07XG5lLmZvckVhY2g9ZnVuY3Rpb24oYSxiKXt0aGlzLiQoKTt0aGlzLm0uZm9yRWFjaChmdW5jdGlvbihjLGQpe25hKGMsZnVuY3Rpb24oYyl7YS5jYWxsKGIsYyxkLHRoaXMpO30sdGhpcyk7fSx0aGlzKTt9O2UuVz1mdW5jdGlvbigpe3RoaXMuJCgpO2Zvcih2YXIgYT10aGlzLm0uSCgpLGI9dGhpcy5tLlcoKSxjPVtdLGQ9MDtkPGIubGVuZ3RoO2QrKylmb3IodmFyIGY9YVtkXSxnPTA7ZzxmLmxlbmd0aDtnKyspYy5wdXNoKGJbZF0pO3JldHVybiBjfTtlLkg9ZnVuY3Rpb24oYSl7dGhpcy4kKCk7dmFyIGI9W107aWYobChhKSl0aGlzLnZhKGEpJiYoYj10YShiLHRoaXMubS5nZXQodGhpcy5NYShhKSkpKTtlbHNle2E9dGhpcy5tLkgoKTtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKyliPXRhKGIsYVtjXSk7fXJldHVybiBifTtcbmUuc2V0PWZ1bmN0aW9uKGEsYil7dGhpcy4kKCk7dGhpcy5PYSgpO2E9dGhpcy5NYShhKTt0aGlzLnZhKGEpJiYodGhpcy5qLT10aGlzLm0uZ2V0KGEpLmxlbmd0aCk7dGhpcy5tLnNldChhLFtiXSk7dGhpcy5qKz0xO3JldHVybiB0aGlzfTtlLmdldD1mdW5jdGlvbihhLGIpe2lmKCFhKXJldHVybiBiO2E9dGhpcy5IKGEpO3JldHVybiAwPGEubGVuZ3RoP1N0cmluZyhhWzBdKTpifTtlLkllPWZ1bmN0aW9uKGEsYil7dGhpcy5yZW1vdmUoYSk7MDxiLmxlbmd0aCYmKHRoaXMuT2EoKSwgdGhpcy5tLnNldCh0aGlzLk1hKGEpLHVhKGIpKSwgdGhpcy5qKz1iLmxlbmd0aCk7fTtcbmUudG9TdHJpbmc9ZnVuY3Rpb24oKXtpZih0aGlzLmphKXJldHVybiB0aGlzLmphO2lmKCF0aGlzLm0pcmV0dXJuXCJcIjtmb3IodmFyIGE9W10sYj10aGlzLm0uVygpLGM9MDtjPGIubGVuZ3RoO2MrKyl7dmFyIGQ9YltjXSxmPWVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoZCkpO2Q9dGhpcy5IKGQpO2Zvcih2YXIgZz0wO2c8ZC5sZW5ndGg7ZysrKXt2YXIgaz1mO1wiXCIhPT1kW2ddJiYoays9XCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhkW2ddKSkpO2EucHVzaChrKTt9fXJldHVybiB0aGlzLmphPWEuam9pbihcIiZcIil9O2UuT2E9ZnVuY3Rpb24oKXt0aGlzLmphPW51bGw7fTtlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IHJjO2EuamE9dGhpcy5qYTt0aGlzLm0mJihhLm09dGhpcy5tLmNsb25lKCksIGEuaj10aGlzLmopO3JldHVybiBhfTtlLk1hPWZ1bmN0aW9uKGEpe2E9U3RyaW5nKGEpO3RoaXMuTyYmKGE9YS50b0xvd2VyQ2FzZSgpKTtyZXR1cm4gYX07XG5lLmFkPWZ1bmN0aW9uKGEpe2EmJiF0aGlzLk8mJih0aGlzLiQoKSwgdGhpcy5PYSgpLCB0aGlzLm0uZm9yRWFjaChmdW5jdGlvbihhLGMpe3ZhciBiPWMudG9Mb3dlckNhc2UoKTtjIT1iJiYodGhpcy5yZW1vdmUoYyksIHRoaXMuSWUoYixhKSk7fSx0aGlzKSk7dGhpcy5PPWE7fTtlLmV4dGVuZD1mdW5jdGlvbihhKXtmb3IodmFyIGI9MDtiPGFyZ3VtZW50cy5sZW5ndGg7YisrKW9jKGFyZ3VtZW50c1tiXSxmdW5jdGlvbihhLGIpe3RoaXMuYWRkKGIsYSk7fSx0aGlzKTt9O2Z1bmN0aW9uIEZjKCl7fWZ1bmN0aW9uIEdjKCl7fXgoR2MsRmMpO2Z1bmN0aW9uIEhjKGEsYil7dGhpcy5iPWE7dGhpcy5hPWI7dGhpcy5mPXRoaXMuQT1udWxsO3RoaXMuYmM9ITE7dGhpcy5LPW51bGw7dGhpcy53PS0xO3RoaXMuQWQ9dGhpcy5uYT1udWxsO31lPUhjLnByb3RvdHlwZTtlLmc9bnVsbDtlLmdhPWZ1bmN0aW9uKGEpe3RoaXMuQT1hO307ZS5jb25uZWN0PWZ1bmN0aW9uKGEpe3RoaXMuSz1hO2E9dGhpcy5iLlNkKHRoaXMuSyk7TygzKTt2YXIgYj10aGlzLmIuSWIuJGQ7bnVsbCE9Yj8odGhpcy5uYT10aGlzLmIuJGEoYlswXSksIHRoaXMuZz0xLCB0aGlzLnhkKCkpOihhLmRjKFwiTU9ERVwiLFwiaW5pdFwiKSwgIXRoaXMuYi50YSYmdGhpcy5iLmFhJiZhLmRjKFwiWC1IVFRQLVNlc3Npb24tSWRcIix0aGlzLmIuYWEpLCB0aGlzLmY9bmV3IFIodGhpcyx0aGlzLmEsdm9pZCAwLHZvaWQgMCx2b2lkIDApLCB0aGlzLmYuZ2EodGhpcy5BKSwgdGhpcy5mLmpkKGEsITEsbnVsbCksIHRoaXMuZz0wKTt9O1xuZS54ZD1mdW5jdGlvbigpe3RoaXMuYS5kZWJ1ZyhcIlRlc3RDb25uZWN0aW9uOiBzdGFydGluZyBzdGFnZSAyXCIpO3ZhciBhPXRoaXMuYi5JYi5vZDtpZihudWxsIT1hKXRoaXMuYS5kZWJ1ZyhmdW5jdGlvbigpe3JldHVyblwiVGVzdENvbm5lY3Rpb246IHNraXBwaW5nIHN0YWdlIDIsIHByZWNvbXB1dGVkIHJlc3VsdCBpcyBcIithP1wiQnVmZmVyZWRcIjpcIlVuYnVmZmVyZWRcIn0pLCBPKDQpLCBhPyhPKDEwKSwgdGhpcy5iLnViKHRoaXMsITEpKTooTygxMSksIHRoaXMuYi51Yih0aGlzLCEwKSk7ZWxzZXt0aGlzLmY9bmV3IFIodGhpcyx0aGlzLmEsdm9pZCAwLHZvaWQgMCx2b2lkIDApO3RoaXMuZi5nYSh0aGlzLkEpO3ZhciBiPXRoaXMuYi5QZCh0aGlzLm5hLHRoaXMuSyk7Tyg0KTtiLmRjKFwiVFlQRVwiLFwieG1saHR0cFwiKTt2YXIgYz10aGlzLmIuYWEsZD10aGlzLmIuS2M7YyYmZCYmYi5sKGMsZCk7dGhpcy5mLmpkKGIsITEsdGhpcy5uYSk7fX07ZS5KYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5iLkpiKGEpfTtcbmUuYWJvcnQ9ZnVuY3Rpb24oKXt0aGlzLmYmJih0aGlzLmYuY2FuY2VsKCksIHRoaXMuZj1udWxsKTt0aGlzLnc9LTE7fTtlLmRlPWZ1bmN0aW9uKCl7cmV0dXJuITF9O1xuZS51ZT1mdW5jdGlvbihhLGIpe3RoaXMudz1hLnc7aWYoMD09dGhpcy5nKWlmKHRoaXMuYS5kZWJ1ZyhcIlRlc3RDb25uZWN0aW9uOiBHb3QgZGF0YSBmb3Igc3RhZ2UgMVwiKSwgdGhpcy5wYyhhKSwgYil7dHJ5e3ZhciBjPXRoaXMuYi5rYy56YyhiKTt9Y2F0Y2goZCl7dGhpcy5hLmNiKGQpO3RoaXMuYi5kZCh0aGlzKTtyZXR1cm59dGhpcy5uYT10aGlzLmIuJGEoY1swXSk7fWVsc2UgdGhpcy5hLmRlYnVnKFwiVGVzdENvbm5lY3Rpb246IE51bGwgcmVzcG9uc2VUZXh0XCIpLCB0aGlzLmIuZGQodGhpcyk7ZWxzZSAxPT10aGlzLmcmJih0aGlzLmJjP08oNik6XCIxMTExMVwiPT1iPyhPKDUpLCB0aGlzLmJjPSEwLCB0aGlzLlplKCkmJih0aGlzLnc9MjAwLCB0aGlzLmYuY2FuY2VsKCksIHRoaXMuYS5kZWJ1ZyhcIlRlc3QgY29ubmVjdGlvbiBzdWNjZWVkZWQ7IHVzaW5nIHN0cmVhbWluZyBjb25uZWN0aW9uXCIpLCBPKDExKSwgdGhpcy5iLnViKHRoaXMsITApKSk6KE8oNyksIHRoaXMuYmM9ITEpKTt9O1xuZS5UYz1mdW5jdGlvbigpe3RoaXMudz10aGlzLmYudzt0aGlzLmYuUz8wPT10aGlzLmc/KHRoaXMuZz0xLCB0aGlzLmEuZGVidWcoXCJUZXN0Q29ubmVjdGlvbjogcmVxdWVzdCBjb21wbGV0ZSBmb3IgaW5pdGlhbCBjaGVja1wiKSwgdGhpcy54ZCgpKToxPT10aGlzLmcmJih0aGlzLmEuZGVidWcoXCJUZXN0Q29ubmVjdGlvbjogcmVxdWVzdCBjb21wbGV0ZSBmb3Igc3RhZ2UgMlwiKSwgdGhpcy5iYz8odGhpcy5hLmRlYnVnKFwiVGVzdCBjb25uZWN0aW9uIHN1Y2NlZWRlZDsgdXNpbmcgc3RyZWFtaW5nIGNvbm5lY3Rpb25cIiksIE8oMTEpLCB0aGlzLmIudWIodGhpcywhMCkpOih0aGlzLmEuZGVidWcoXCJUZXN0IGNvbm5lY3Rpb24gZmFpbGVkOyBub3QgdXNpbmcgc3RyZWFtaW5nXCIpLCBPKDEwKSwgdGhpcy5iLnViKHRoaXMsITEpKSk6KHRoaXMuYS5kZWJ1ZyhcIlRlc3RDb25uZWN0aW9uOiByZXF1ZXN0IGZhaWxlZCwgaW4gc3RhdGUgXCIrdGhpcy5nKSwgMD09dGhpcy5nP08oOCk6MT09dGhpcy5nJiZPKDkpLCB0aGlzLmIuZGQodGhpcykpO307ZS5wYz1mdW5jdGlvbihhKXtpZighdGhpcy5iLnRhJiYoYT1hLmgpKXt2YXIgYj1hLmtiKFwiWC1DbGllbnQtV2lyZS1Qcm90b2NvbFwiKTt0aGlzLkFkPWI/YjpudWxsO3RoaXMuYi5hYSYmKChhPWEua2IoXCJYLUhUVFAtU2Vzc2lvbi1JZFwiKSk/dGhpcy5iLkZlKGEpOnRoaXMuYS5UKFwiTWlzc2luZyBYX0hUVFBfU0VTU0lPTl9JRCBpbiB0aGUgaGFuZHNoYWtlIHJlc3BvbnNlXCIpKTt9fTtlLmZjPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYi5mYygpfTtlLkJhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYi5CYSgpfTtlLlplPWZ1bmN0aW9uKCl7cmV0dXJuIUN8fDEwPD1OdW1iZXIoVWEpfTtmdW5jdGlvbiBJYygpe3RoaXMub2Q9dGhpcy4kZD1udWxsO31mdW5jdGlvbiBKYyhhKXt0aGlzLkQ9bmV3IFM7YSYmdGhpcy5hZGRBbGwoYSk7fWZ1bmN0aW9uIEtjKGEpe3ZhciBiPXR5cGVvZiBhO3JldHVyblwib2JqZWN0XCI9PWImJmF8fFwiZnVuY3Rpb25cIj09Yj9cIm9cIisoYVt0XXx8KGFbdF09KytkYSkpOmIuc3Vic3RyKDAsMSkrYX1lPUpjLnByb3RvdHlwZTtlLkM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ELkMoKX07ZS5hZGQ9ZnVuY3Rpb24oYSl7dGhpcy5ELnNldChLYyhhKSxhKTt9O2UuYWRkQWxsPWZ1bmN0aW9uKGEpe2E9bmMoYSk7Zm9yKHZhciBiPWEubGVuZ3RoLGM9MDtjPGI7YysrKXRoaXMuYWRkKGFbY10pO307ZS5wYj1mdW5jdGlvbihhKXthPW5jKGEpO2Zvcih2YXIgYj1hLmxlbmd0aCxjPTA7YzxiO2MrKyl0aGlzLnJlbW92ZShhW2NdKTt9O2UucmVtb3ZlPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLkQucmVtb3ZlKEtjKGEpKX07ZS5jbGVhcj1mdW5jdGlvbigpe3RoaXMuRC5jbGVhcigpO307ZS5YPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuRC5YKCl9O1xuZS5jb250YWlucz1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5ELnZhKEtjKGEpKX07ZS5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuRC5IKCl9O2UuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEpjKHRoaXMpfTtmdW5jdGlvbiBMYyhhLGIpe3RoaXMuUGM9YTt0aGlzLm1hcD1iO3RoaXMuY29udGV4dD1udWxsO31mdW5jdGlvbiBNYyhhKXt0aGlzLm1lPWF8fE5jO2guUGVyZm9ybWFuY2VOYXZpZ2F0aW9uVGltaW5nPyhhPWgucGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZShcIm5hdmlnYXRpb25cIiksIGE9MDxhLmxlbmd0aCYmKFwiaHFcIj09YVswXS5uZXh0SG9wUHJvdG9jb2x8fFwiaDJcIj09YVswXS5uZXh0SG9wUHJvdG9jb2wpKTphPSEhKGgudmMmJmgudmMua2UmJmgudmMua2UoKSYmaC52Yy5rZSgpLm5oKTt0aGlzLlhiPWE/dGhpcy5tZToxO3RoaXMudj1udWxsOzE8dGhpcy5YYiYmKHRoaXMudj1uZXcgSmMpO3RoaXMuZj1udWxsO3RoaXMuYmE9W107fXZhciBOYz0xMDtlPU1jLnByb3RvdHlwZTtlLmxkPWZ1bmN0aW9uKGEpe3RoaXMudnx8LTE9PWEuaW5kZXhPZihcInNwZHlcIikmJi0xPT1hLmluZGV4T2YoXCJxdWljXCIpJiYtMT09YS5pbmRleE9mKFwiaDJcIil8fCh0aGlzLlhiPXRoaXMubWUsIHRoaXMudj1uZXcgSmMsIHRoaXMuZiYmKHRoaXMub2ModGhpcy5mKSwgdGhpcy5mPW51bGwpKTt9O1xuZS5lZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmY/ITA6dGhpcy52P3RoaXMudi5DKCk+PXRoaXMuWGI6ITF9O2UueGY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mPzE6dGhpcy52P3RoaXMudi5DKCk6MH07ZS5KYz1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5mP3RoaXMuZj09YTp0aGlzLnY/dGhpcy52LmNvbnRhaW5zKGEpOiExfTtlLm9jPWZ1bmN0aW9uKGEpe3RoaXMudj90aGlzLnYuYWRkKGEpOnRoaXMuZj1hO307ZS56ZT1mdW5jdGlvbihhKXt0aGlzLmYmJnRoaXMuZj09YT90aGlzLmY9bnVsbDp0aGlzLnYmJnRoaXMudi5jb250YWlucyhhKSYmdGhpcy52LnJlbW92ZShhKTt9O2UuY2FuY2VsPWZ1bmN0aW9uKCl7dGhpcy5iYT10aGlzLmxhKCk7dGhpcy5mPyh0aGlzLmYuY2FuY2VsKCksIHRoaXMuZj1udWxsKTp0aGlzLnYmJiF0aGlzLnYuWCgpJiYobmEodGhpcy52LkgoKSxmdW5jdGlvbihhKXthLmNhbmNlbCgpO30pLCB0aGlzLnYuY2xlYXIoKSk7fTtcbmUubGE9ZnVuY3Rpb24oKXtpZihudWxsIT10aGlzLmYpcmV0dXJuIHRoaXMuYmEuY29uY2F0KHRoaXMuZi5sYSgpKTtpZihudWxsIT10aGlzLnYmJiF0aGlzLnYuWCgpKXt2YXIgYT10aGlzLmJhO25hKHRoaXMudi5IKCksZnVuY3Rpb24oYil7YT1hLmNvbmNhdChiLmxhKCkpO30pO3JldHVybiBhfXJldHVybiB1YSh0aGlzLmJhKX07ZS5SZT1mdW5jdGlvbihhKXt0aGlzLmJhPXRoaXMuYmEuY29uY2F0KGEpO307ZS4kZT1mdW5jdGlvbigpe3RoaXMuYmEubGVuZ3RoPTA7fTtmdW5jdGlvbiBPYygpe3RoaXMueGc9dGhpcy5yZz12b2lkIDA7fU9jLnByb3RvdHlwZS5zdHJpbmdpZnk9ZnVuY3Rpb24oYSl7cmV0dXJuIGguSlNPTi5zdHJpbmdpZnkoYSx0aGlzLnJnKX07T2MucHJvdG90eXBlLnBhcnNlPWZ1bmN0aW9uKGEpe3JldHVybiBoLkpTT04ucGFyc2UoYSx0aGlzLnhnKX07ZnVuY3Rpb24gUGMoKXt0aGlzLmpnPW5ldyBPYzt9UGMucHJvdG90eXBlLmhmPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jfHxcIlwiO3RyeXtvYyhhLGZ1bmN0aW9uKGEsYyl7dmFyIGY9YTtyKGEpJiYoZj11YihhKSk7Yi5wdXNoKGQrYytcIj1cIitlbmNvZGVVUklDb21wb25lbnQoZikpO30pO31jYXRjaChmKXt0aHJvdyBiLnB1c2goZCtcInR5cGU9XCIrZW5jb2RlVVJJQ29tcG9uZW50KFwiX2JhZG1hcFwiKSksIGY7fX07UGMucHJvdG90eXBlLmpmPWZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9LTE7Oyl7dmFyIGY9W1wiY291bnQ9XCIrYl07LTE9PWQ/MDxiPyhkPWFbMF0uUGMsIGYucHVzaChcIm9mcz1cIitkKSk6ZD0wOmYucHVzaChcIm9mcz1cIitkKTtmb3IodmFyIGc9ITAsaz0wO2s8YjtrKyspe3ZhciBwPWFba10uUGMsVWI9YVtrXS5tYXA7cC09ZDtpZigwPnApZD1NYXRoLm1heCgwLGFba10uUGMtMTAwKSwgZz0hMTtlbHNlIHRyeXt0aGlzLmhmKFViLGYsXCJyZXFcIitwK1wiX1wiKTt9Y2F0Y2gobWQpe2MmJmMoVWIpO319aWYoZylyZXR1cm4gZi5qb2luKFwiJlwiKX19O1xuUGMucHJvdG90eXBlLnpjPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmpnLnBhcnNlKGEpfTtmdW5jdGlvbiBRYyhhLGIpe3ZhciBjPW5ldyBYYjtjLmRlYnVnKFwiVGVzdExvYWRJbWFnZTogbG9hZGluZyBcIithKTt2YXIgZD1uZXcgSW1hZ2U7ZC5vbmxvYWQ9dihSYyxjLGQsXCJUZXN0TG9hZEltYWdlOiBsb2FkZWRcIiwhMCxiKTtkLm9uZXJyb3I9dihSYyxjLGQsXCJUZXN0TG9hZEltYWdlOiBlcnJvclwiLCExLGIpO2Qub25hYm9ydD12KFJjLGMsZCxcIlRlc3RMb2FkSW1hZ2U6IGFib3J0XCIsITEsYik7ZC5vbnRpbWVvdXQ9dihSYyxjLGQsXCJUZXN0TG9hZEltYWdlOiB0aW1lb3V0XCIsITEsYik7aC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aWYoZC5vbnRpbWVvdXQpZC5vbnRpbWVvdXQoKTt9LDFFNCk7ZC5zcmM9YTt9ZnVuY3Rpb24gUmMoYSxiLGMsZCxmKXt0cnl7YS5kZWJ1ZyhjKSwgYi5vbmxvYWQ9bnVsbCwgYi5vbmVycm9yPW51bGwsIGIub25hYm9ydD1udWxsLCBiLm9udGltZW91dD1udWxsLCBmKGQpO31jYXRjaChnKXthLmNiKGcpO319dmFyIFNjPWguSlNPTi5wYXJzZTtmdW5jdGlvbiBWKGEpe0guY2FsbCh0aGlzKTt0aGlzLmhlYWRlcnM9bmV3IFM7dGhpcy5YYT1hfHxudWxsO3RoaXMuaGE9ITE7dGhpcy5tYz10aGlzLmM9bnVsbDt0aGlzLmdlPXRoaXMuVGI9XCJcIjt0aGlzLlBhPTA7dGhpcy5JPVwiXCI7dGhpcy5BYT10aGlzLkxjPXRoaXMuUWI9dGhpcy5FYz0hMTt0aGlzLnZiPTA7dGhpcy5oYz1udWxsO3RoaXMuQWU9VGM7dGhpcy5qYz10aGlzLmxnPXRoaXMuQWI9ITE7fXgoVixIKTt2YXIgVGM9XCJcIjtWLnByb3RvdHlwZS5zPVZiKFwiZ29vZy5uZXQuWGhySW9cIik7dmFyIFVjPS9eaHR0cHM/JC9pLFZjPVtcIlBPU1RcIixcIlBVVFwiXTtlPVYucHJvdG90eXBlO2UuSmU9ZnVuY3Rpb24oYSl7dGhpcy5BYj1hO307XG5lLnNlbmQ9ZnVuY3Rpb24oYSxiLGMsZCl7aWYodGhpcy5jKXRocm93IEVycm9yKFwiW2dvb2cubmV0LlhocklvXSBPYmplY3QgaXMgYWN0aXZlIHdpdGggYW5vdGhlciByZXF1ZXN0PVwiK3RoaXMuVGIrXCI7IG5ld1VyaT1cIithKTtiPWI/Yi50b1VwcGVyQ2FzZSgpOlwiR0VUXCI7dGhpcy5UYj1hO3RoaXMuST1cIlwiO3RoaXMuUGE9MDt0aGlzLmdlPWI7dGhpcy5FYz0hMTt0aGlzLmhhPSEwO3RoaXMuYz10aGlzLmRmKCk7dGhpcy5tYz10aGlzLlhhP3RoaXMuWGEuVmQoKTpoYy5WZCgpO3RoaXMuYy5vbnJlYWR5c3RhdGVjaGFuZ2U9dSh0aGlzLnRlLHRoaXMpO3RoaXMubGcmJlwib25wcm9ncmVzc1wiaW4gdGhpcy5jJiYodGhpcy5jLm9ucHJvZ3Jlc3M9dShmdW5jdGlvbihhKXt0aGlzLnJlKGEsITApO30sdGhpcyksIHRoaXMuYy51cGxvYWQmJih0aGlzLmMudXBsb2FkLm9ucHJvZ3Jlc3M9dSh0aGlzLnJlLHRoaXMpKSk7dHJ5e0wodGhpcy5zLHRoaXMuZGEoXCJPcGVuaW5nIFhoclwiKSksIHRoaXMuTGM9XG4hMCwgdGhpcy5jLm9wZW4oYixTdHJpbmcoYSksITApLCB0aGlzLkxjPSExO31jYXRjaChnKXtMKHRoaXMucyx0aGlzLmRhKFwiRXJyb3Igb3BlbmluZyBYaHI6IFwiK2cubWVzc2FnZSkpO3RoaXMuTGQoZyk7cmV0dXJufWE9Y3x8XCJcIjt2YXIgZj10aGlzLmhlYWRlcnMuY2xvbmUoKTtkJiZvYyhkLGZ1bmN0aW9uKGEsYil7Zi5zZXQoYixhKTt9KTtkPXBhKGYuVygpKTtjPWguRm9ybURhdGEmJmEgaW5zdGFuY2VvZiBoLkZvcm1EYXRhOyEoMDw9bGEoVmMsYikpfHxkfHxjfHxmLnNldChcIkNvbnRlbnQtVHlwZVwiLFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9dXRmLThcIik7Zi5mb3JFYWNoKGZ1bmN0aW9uKGEsYil7dGhpcy5jLnNldFJlcXVlc3RIZWFkZXIoYixhKTt9LHRoaXMpO3RoaXMuQWUmJih0aGlzLmMucmVzcG9uc2VUeXBlPXRoaXMuQWUpO1wid2l0aENyZWRlbnRpYWxzXCJpbiB0aGlzLmMmJnRoaXMuYy53aXRoQ3JlZGVudGlhbHMhPT10aGlzLkFiJiYodGhpcy5jLndpdGhDcmVkZW50aWFscz1cbnRoaXMuQWIpO3RyeXt0aGlzLnlkKCksIDA8dGhpcy52YiYmKHRoaXMuamM9V2ModGhpcy5jKSwgTCh0aGlzLnMsdGhpcy5kYShcIldpbGwgYWJvcnQgYWZ0ZXIgXCIrdGhpcy52YitcIm1zIGlmIGluY29tcGxldGUsIHhocjIgXCIrdGhpcy5qYykpLCB0aGlzLmpjPyh0aGlzLmMudGltZW91dD10aGlzLnZiLCB0aGlzLmMub250aW1lb3V0PXUodGhpcy5VYSx0aGlzKSk6dGhpcy5oYz1IYih0aGlzLlVhLHRoaXMudmIsdGhpcykpLCBMKHRoaXMucyx0aGlzLmRhKFwiU2VuZGluZyByZXF1ZXN0XCIpKSwgdGhpcy5RYj0hMCwgdGhpcy5jLnNlbmQoYSksIHRoaXMuUWI9ITE7fWNhdGNoKGcpe0wodGhpcy5zLHRoaXMuZGEoXCJTZW5kIGVycm9yOiBcIitnLm1lc3NhZ2UpKSwgdGhpcy5MZChnKTt9fTtmdW5jdGlvbiBXYyhhKXtyZXR1cm4gQyYmVGEoOSkmJlwibnVtYmVyXCI9PXR5cGVvZiBhLnRpbWVvdXQmJnZvaWQgMCE9PWEub250aW1lb3V0fVxuZnVuY3Rpb24gcWEoYSl7cmV0dXJuXCJjb250ZW50LXR5cGVcIj09YS50b0xvd2VyQ2FzZSgpfWUuZGY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5YYT90aGlzLlhhLkRkKCk6aGMuRGQoKX07ZS5VYT1mdW5jdGlvbigpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBnb29nJiZ0aGlzLmMmJih0aGlzLkk9XCJUaW1lZCBvdXQgYWZ0ZXIgXCIrdGhpcy52YitcIm1zLCBhYm9ydGluZ1wiLCB0aGlzLlBhPTgsIEwodGhpcy5zLHRoaXMuZGEodGhpcy5JKSksIHRoaXMuZGlzcGF0Y2hFdmVudChcInRpbWVvdXRcIiksIHRoaXMuYWJvcnQoOCkpO307ZS5MZD1mdW5jdGlvbihhKXt0aGlzLmhhPSExO3RoaXMuYyYmKHRoaXMuQWE9ITAsIHRoaXMuYy5hYm9ydCgpLCB0aGlzLkFhPSExKTt0aGlzLkk9YTt0aGlzLlBhPTU7dGhpcy5KZCgpO3RoaXMuR2IoKTt9O2UuSmQ9ZnVuY3Rpb24oKXt0aGlzLkVjfHwodGhpcy5FYz0hMCwgdGhpcy5kaXNwYXRjaEV2ZW50KFwiY29tcGxldGVcIiksIHRoaXMuZGlzcGF0Y2hFdmVudChcImVycm9yXCIpKTt9O1xuZS5hYm9ydD1mdW5jdGlvbihhKXt0aGlzLmMmJnRoaXMuaGEmJihMKHRoaXMucyx0aGlzLmRhKFwiQWJvcnRpbmdcIikpLCB0aGlzLmhhPSExLCB0aGlzLkFhPSEwLCB0aGlzLmMuYWJvcnQoKSwgdGhpcy5BYT0hMSwgdGhpcy5QYT1hfHw3LCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJjb21wbGV0ZVwiKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwiYWJvcnRcIiksIHRoaXMuR2IoKSk7fTtlLkY9ZnVuY3Rpb24oKXt0aGlzLmMmJih0aGlzLmhhJiYodGhpcy5oYT0hMSwgdGhpcy5BYT0hMCwgdGhpcy5jLmFib3J0KCksIHRoaXMuQWE9ITEpLCB0aGlzLkdiKCEwKSk7Vi5MLkYuY2FsbCh0aGlzKTt9O2UudGU9ZnVuY3Rpb24oKXt0aGlzLkthfHwodGhpcy5MY3x8dGhpcy5RYnx8dGhpcy5BYT90aGlzLnNlKCk6dGhpcy5lZygpKTt9O2UuZWc9ZnVuY3Rpb24oKXt0aGlzLnNlKCk7fTtcbmUuc2U9ZnVuY3Rpb24oKXtpZih0aGlzLmhhJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgZ29vZylpZih0aGlzLm1jWzFdJiY0PT10aGlzLm1hKCkmJjI9PXRoaXMuemEoKSlMKHRoaXMucyx0aGlzLmRhKFwiTG9jYWwgcmVxdWVzdCBlcnJvciBkZXRlY3RlZCBhbmQgaWdub3JlZFwiKSk7ZWxzZSBpZih0aGlzLlFiJiY0PT10aGlzLm1hKCkpSGIodGhpcy50ZSwwLHRoaXMpO2Vsc2UgaWYodGhpcy5kaXNwYXRjaEV2ZW50KFwicmVhZHlzdGF0ZWNoYW5nZVwiKSwgdGhpcy5NYygpKXtMKHRoaXMucyx0aGlzLmRhKFwiUmVxdWVzdCBjb21wbGV0ZVwiKSk7dGhpcy5oYT0hMTt0cnl7dGhpcy5SZigpPyh0aGlzLmRpc3BhdGNoRXZlbnQoXCJjb21wbGV0ZVwiKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwic3VjY2Vzc1wiKSk6KHRoaXMuUGE9NiwgdGhpcy5JPXRoaXMuWWQoKStcIiBbXCIrdGhpcy56YSgpK1wiXVwiLCB0aGlzLkpkKCkpO31maW5hbGx5e3RoaXMuR2IoKTt9fX07XG5lLnJlPWZ1bmN0aW9uKGEsYil7dGhpcy5kaXNwYXRjaEV2ZW50KFhjKGEsXCJwcm9ncmVzc1wiKSk7dGhpcy5kaXNwYXRjaEV2ZW50KFhjKGEsYj9cImRvd25sb2FkcHJvZ3Jlc3NcIjpcInVwbG9hZHByb2dyZXNzXCIpKTt9O2Z1bmN0aW9uIFhjKGEsYil7cmV0dXJue3R5cGU6YixsZW5ndGhDb21wdXRhYmxlOmEubGVuZ3RoQ29tcHV0YWJsZSxsb2FkZWQ6YS5sb2FkZWQsdG90YWw6YS50b3RhbH19ZS5HYj1mdW5jdGlvbihhKXtpZih0aGlzLmMpe3RoaXMueWQoKTt2YXIgYj10aGlzLmMsYz10aGlzLm1jWzBdP2FhOm51bGw7dGhpcy5tYz10aGlzLmM9bnVsbDthfHx0aGlzLmRpc3BhdGNoRXZlbnQoXCJyZWFkeVwiKTt0cnl7Yi5vbnJlYWR5c3RhdGVjaGFuZ2U9Yzt9Y2F0Y2goZCl7KGE9dGhpcy5zKSYmYS5jYShcIlByb2JsZW0gZW5jb3VudGVyZWQgcmVzZXR0aW5nIG9ucmVhZHlzdGF0ZWNoYW5nZTogXCIrZC5tZXNzYWdlLHZvaWQgMCk7fX19O1xuZS55ZD1mdW5jdGlvbigpe3RoaXMuYyYmdGhpcy5qYyYmKHRoaXMuYy5vbnRpbWVvdXQ9bnVsbCk7dGhpcy5oYyYmKGguY2xlYXJUaW1lb3V0KHRoaXMuaGMpLCB0aGlzLmhjPW51bGwpO307ZS5CYT1mdW5jdGlvbigpe3JldHVybiEhdGhpcy5jfTtlLk1jPWZ1bmN0aW9uKCl7cmV0dXJuIDQ9PXRoaXMubWEoKX07ZS5SZj1mdW5jdGlvbigpe3ZhciBhPXRoaXMuemEoKTthOnN3aXRjaChhKXtjYXNlIDIwMDpjYXNlIDIwMTpjYXNlIDIwMjpjYXNlIDIwNDpjYXNlIDIwNjpjYXNlIDMwNDpjYXNlIDEyMjM6dmFyIGI9ITA7YnJlYWsgYTtkZWZhdWx0OmI9ITE7fXJldHVybiBifHwwPT09YSYmIXRoaXMuT2YoKX07XG5lLk9mPWZ1bmN0aW9uKCl7dmFyIGE9U3RyaW5nKHRoaXMuVGIpLm1hdGNoKHBjKVsxXXx8bnVsbDshYSYmaC5zZWxmJiZoLnNlbGYubG9jYXRpb24mJihhPWguc2VsZi5sb2NhdGlvbi5wcm90b2NvbCwgYT1hLnN1YnN0cigwLGEubGVuZ3RoLTEpKTtyZXR1cm4gVWMudGVzdChhP2EudG9Mb3dlckNhc2UoKTpcIlwiKX07ZS5tYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmM/dGhpcy5jLnJlYWR5U3RhdGU6MH07ZS56YT1mdW5jdGlvbigpe3RyeXtyZXR1cm4gMjx0aGlzLm1hKCk/dGhpcy5jLnN0YXR1czotMX1jYXRjaChhKXtyZXR1cm4tMX19O2UuWWQ9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIDI8dGhpcy5tYSgpP3RoaXMuYy5zdGF0dXNUZXh0OlwiXCJ9Y2F0Y2goYSl7cmV0dXJuIEwodGhpcy5zLFwiQ2FuIG5vdCBnZXQgc3RhdHVzOiBcIithLm1lc3NhZ2UpLCBcIlwifX07XG5lLnlhPWZ1bmN0aW9uKCl7dHJ5e3JldHVybiB0aGlzLmM/dGhpcy5jLnJlc3BvbnNlVGV4dDpcIlwifWNhdGNoKGEpe3JldHVybiBMKHRoaXMucyxcIkNhbiBub3QgZ2V0IHJlc3BvbnNlVGV4dDogXCIrYS5tZXNzYWdlKSwgXCJcIn19O2UueWY9ZnVuY3Rpb24oYSl7aWYodGhpcy5jKXt2YXIgYj10aGlzLmMucmVzcG9uc2VUZXh0O2EmJjA9PWIuaW5kZXhPZihhKSYmKGI9Yi5zdWJzdHJpbmcoYS5sZW5ndGgpKTtyZXR1cm4gU2MoYil9fTtlLmdldFJlc3BvbnNlSGVhZGVyPWZ1bmN0aW9uKGEpe2lmKHRoaXMuYyYmdGhpcy5NYygpKXJldHVybiBhPXRoaXMuYy5nZXRSZXNwb25zZUhlYWRlcihhKSwgbnVsbD09PWE/dm9pZCAwOmF9O2UuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYyYmdGhpcy5NYygpP3RoaXMuYy5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKXx8XCJcIjpcIlwifTtcbmUua2I9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYz90aGlzLmMuZ2V0UmVzcG9uc2VIZWFkZXIoYSk6bnVsbH07ZS5VZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLlBhfTtlLkhjPWZ1bmN0aW9uKCl7cmV0dXJuIGwodGhpcy5JKT90aGlzLkk6U3RyaW5nKHRoaXMuSSl9O2UuZGE9ZnVuY3Rpb24oYSl7cmV0dXJuIGErXCIgW1wiK3RoaXMuZ2UrXCIgXCIrdGhpcy5UYitcIiBcIit0aGlzLnphKCkrXCJdXCJ9O2Z1bmN0aW9uIFljKGEpe3ZhciBiPVwiXCI7QWEoYSxmdW5jdGlvbihhLGQpe2IrPWQ7Yis9XCI6XCI7Yis9YTtiKz1cIlxcclxcblwiO30pO3JldHVybiBifWZ1bmN0aW9uIFpjKGEsYixjKXthOntmb3IoZCBpbiBjKXt2YXIgZD0hMTticmVhayBhfWQ9ITA7fWlmKGQpcmV0dXJuIGE7Yz1ZYyhjKTtpZihsKGEpKXtiPWVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoYikpO2M9bnVsbCE9Yz9cIj1cIitlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGMpKTpcIlwiO2lmKGIrPWMpe2M9YS5pbmRleE9mKFwiI1wiKTswPmMmJihjPWEubGVuZ3RoKTtkPWEuaW5kZXhPZihcIj9cIik7aWYoMD5kfHxkPmMpe2Q9Yzt2YXIgZj1cIlwiO31lbHNlIGY9YS5zdWJzdHJpbmcoZCsxLGMpO2E9W2Euc3Vic3RyKDAsZCksZixhLnN1YnN0cihjKV07Yz1hWzFdO2FbMV09Yj9jP2MrXCImXCIrYjpiOmM7YT1hWzBdKyhhWzFdP1wiP1wiK2FbMV06XCJcIikrYVsyXTt9cmV0dXJuIGF9YS5sKGIsYyk7cmV0dXJuIGF9ZnVuY3Rpb24gJGMoYSl7dGhpcy5CZD0yMjt0aGlzLkRlPTA7dGhpcy5NPVtdO3RoaXMuYT1uZXcgWGI7dGhpcy5JYj1uZXcgSWM7dGhpcy5uYT10aGlzLm1kPXRoaXMuaGI9dGhpcy5LPXRoaXMudT10aGlzLktjPXRoaXMuYWE9dGhpcy5nYj10aGlzLk49dGhpcy5SYj10aGlzLkE9bnVsbDt0aGlzLlRlPSEwO3RoaXMuYWc9dGhpcy5ZYj0wO3RoaXMua2Y9ISFtKFwiaW50ZXJuYWxDaGFubmVsUGFyYW1zLmZhaWxGYXN0XCIsYSk7dGhpcy5mZD10aGlzLkphPXRoaXMud2E9dGhpcy5pYT10aGlzLmVhPXRoaXMuaT1udWxsO3RoaXMuU2U9ITA7dGhpcy53PXRoaXMuaGU9dGhpcy5TYj0tMTt0aGlzLnJjPXRoaXMuSGE9dGhpcy5MYT0wO3RoaXMuVmU9bShcImludGVybmFsQ2hhbm5lbFBhcmFtcy5iYXNlUmV0cnlEZWxheU1zXCIsYSl8fDVFMzt0aGlzLnZnPW0oXCJpbnRlcm5hbENoYW5uZWxQYXJhbXMucmV0cnlEZWxheVNlZWRNc1wiLGEpfHwxRTQ7dGhpcy5uZj1tKFwiaW50ZXJuYWxDaGFubmVsUGFyYW1zLmZvcndhcmRDaGFubmVsTWF4UmV0cmllc1wiLFxuYSl8fDI7dGhpcy5PZD1tKFwiaW50ZXJuYWxDaGFubmVsUGFyYW1zLmZvcndhcmRDaGFubmVsUmVxdWVzdFRpbWVvdXRNc1wiLGEpfHwyRTQ7dGhpcy5YYT1hJiZhLm9ofHx2b2lkIDA7dGhpcy5EYj12b2lkIDA7dGhpcy5SYT0wO3RoaXMuZ2M9YSYmYS5zdXBwb3J0c0Nyb3NzRG9tYWluWGhyfHwhMTt0aGlzLnJhPVwiXCI7dGhpcy5HPW5ldyBNYyhhJiZhLmNvbmN1cnJlbnRSZXF1ZXN0TGltaXQpO3RoaXMua2M9bmV3IFBjO3RoaXMudGE9YSYmdm9pZCAwIT09YS5iYWNrZ3JvdW5kQ2hhbm5lbFRlc3Q/YS5iYWNrZ3JvdW5kQ2hhbm5lbFRlc3Q6ITA7KHRoaXMuTmQ9YSYmYS5mYXN0SGFuZHNoYWtlfHwhMSkmJiF0aGlzLnRhJiYodGhpcy5hLlQoXCJGb3JjZSBiYWNrZ3JvdW5kQ2hhbm5lbFRlc3Qgd2hlbiBmYXN0SGFuZHNoYWtlIGlzIGVuYWJsZWQuXCIpLCB0aGlzLnRhPSEwKTthJiZhLklkJiZ0aGlzLmEuSWQoKTt9ZT0kYy5wcm90b3R5cGU7ZS50Yz04O2UuZz0xO1xuZS5jb25uZWN0PWZ1bmN0aW9uKGEsYixjLGQsZil7dGhpcy5hLmRlYnVnKFwiY29ubmVjdCgpXCIpO08oMCk7dGhpcy5LPWI7dGhpcy5nYj1jfHx7fTtkJiZ2b2lkIDAhPT1mJiYodGhpcy5nYi5PU0lEPWQsIHRoaXMuZ2IuT0FJRD1mKTt0aGlzLnRhJiYodGhpcy5hLmRlYnVnKFwiY29ubmVjdCgpIGJ5cGFzc2VkIGNoYW5uZWwtdGVzdC5cIiksIHRoaXMuSWIuJGQ9W10sIHRoaXMuSWIub2Q9ITEpO3RoaXMuYmYoYSk7fTtlLmRpc2Nvbm5lY3Q9ZnVuY3Rpb24oKXt0aGlzLmEuZGVidWcoXCJkaXNjb25uZWN0KClcIik7dGhpcy5xZCgpO2lmKDM9PXRoaXMuZyl7dmFyIGE9dGhpcy5ZYisrLGI9dGhpcy5oYi5jbG9uZSgpO2IubChcIlNJRFwiLHRoaXMucmEpO2IubChcIlJJRFwiLGEpO2IubChcIlRZUEVcIixcInRlcm1pbmF0ZVwiKTt0aGlzLllhKGIpOyhuZXcgUih0aGlzLHRoaXMuYSx0aGlzLnJhLGEsdm9pZCAwKSkueWcoYik7fXRoaXMucWUoKTt9O1xuZS5iZj1mdW5jdGlvbihhKXt0aGlzLmEuZGVidWcoXCJjb25uZWN0VGVzdF8oKVwiKTt0aGlzLkphPW5ldyBIYyh0aGlzLHRoaXMuYSk7bnVsbD09PXRoaXMuTiYmdGhpcy5KYS5nYSh0aGlzLkEpO3ZhciBiPWE7dGhpcy5OJiZ0aGlzLkEmJihiPVpjKGEsdGhpcy5OLHRoaXMuQSkpO3RoaXMuSmEuY29ubmVjdChiKTt9O2UuYWY9ZnVuY3Rpb24oKXt0aGlzLmEuZGVidWcoXCJjb25uZWN0Q2hhbm5lbF8oKVwiKTt0aGlzLmhiPXRoaXMuU2QodGhpcy5LKTt0aGlzLkRjKCk7fTtlLnFkPWZ1bmN0aW9uKCl7dGhpcy5KYSYmKHRoaXMuSmEuYWJvcnQoKSwgdGhpcy5KYT1udWxsKTt0aGlzLnUmJih0aGlzLnUuY2FuY2VsKCksIHRoaXMudT1udWxsKTt0aGlzLmlhJiYoaC5jbGVhclRpbWVvdXQodGhpcy5pYSksIHRoaXMuaWE9bnVsbCk7dGhpcy5IYigpO3RoaXMuRy5jYW5jZWwoKTt0aGlzLmVhJiYoaC5jbGVhclRpbWVvdXQodGhpcy5lYSksIHRoaXMuZWE9bnVsbCk7fTtcbmUuZ2E9ZnVuY3Rpb24oYSl7dGhpcy5BPWE7fTtlLkVnPWZ1bmN0aW9uKGEpe3RoaXMuUmI9YTt9O2UuQ2c9ZnVuY3Rpb24oYSl7dGhpcy5OPWE7fTtlLkRnPWZ1bmN0aW9uKGEpe3RoaXMuYWE9YTt9O2UuRmU9ZnVuY3Rpb24oYSl7dGhpcy5LYz1hO307ZS5IZT1mdW5jdGlvbihhKXt0aGlzLlJhPWE7fTtlLkhnPWZ1bmN0aW9uKCl7dGhpcy5nYz0hMDt9O2UuRWU9ZnVuY3Rpb24oYSl7dGhpcy5pPWE7fTtlLk5mPWZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuZmR9O2UuWmM9ZnVuY3Rpb24oYSl7MUUzPT10aGlzLk0ubGVuZ3RoJiZ0aGlzLmEuY2EoZnVuY3Rpb24oKXtyZXR1cm5cIkFscmVhZHkgaGF2ZSAxMDAwIHF1ZXVlZCBtYXBzIHVwb24gcXVldWVpbmcgXCIrdWIoYSl9KTt0aGlzLk0ucHVzaChuZXcgTGModGhpcy5hZysrLGEpKTszPT10aGlzLmcmJnRoaXMuRGMoKTt9O2UucWY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5rZj8wOnRoaXMubmZ9O2UuZGU9ZnVuY3Rpb24oKXtyZXR1cm4gMD09dGhpcy5nfTtcbmUuZ2V0U3RhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nfTtlLkRjPWZ1bmN0aW9uKCl7dGhpcy5HLmVlKCl8fHRoaXMuZWF8fCh0aGlzLmVhPVAodSh0aGlzLndlLHRoaXMpLDApLCB0aGlzLkxhPTApO307ZS5ZZj1mdW5jdGlvbihhKXtpZih0aGlzLkcueGYoKT49dGhpcy5HLlhiLSh0aGlzLmVhPzE6MCkpcmV0dXJuIHRoaXMuYS5jYShcIlVuZXhwZWN0ZWQgcmV0cnkgcmVxdWVzdCBpcyBzY2hlZHVsZWQuXCIpLCAhMTtpZih0aGlzLmVhKXJldHVybiB0aGlzLmEuZGVidWcoXCJVc2UgdGhlIHJldHJ5IHJlcXVlc3QgdGhhdCBpcyBhbHJlYWR5IHNjaGVkdWxlZC5cIiksIHRoaXMuTT1hLmxhKCkuY29uY2F0KHRoaXMuTSksICEwO2lmKDE9PXRoaXMuZ3x8Mj09dGhpcy5nfHx0aGlzLkxhPj10aGlzLnFmKCkpcmV0dXJuITE7dGhpcy5hLmRlYnVnKFwiR29pbmcgdG8gcmV0cnkgUE9TVFwiKTt0aGlzLmVhPVAodSh0aGlzLndlLHRoaXMsYSksdGhpcy5YZCh0aGlzLkxhKSk7dGhpcy5MYSsrO3JldHVybiEwfTtcbmUud2U9ZnVuY3Rpb24oYSl7dGhpcy5lYT1udWxsO3RoaXMuTWcoYSk7fTtlLk1nPWZ1bmN0aW9uKGEpe3RoaXMuYS5kZWJ1ZyhcInN0YXJ0Rm9yd2FyZENoYW5uZWxfXCIpOzE9PXRoaXMuZz9hP3RoaXMuYS5jYShcIk5vdCBzdXBwb3NlZCB0byByZXRyeSB0aGUgb3BlblwiKToodGhpcy5pZygpLCB0aGlzLmc9Mik6Mz09dGhpcy5nJiYoYT90aGlzLmxlKGEpOjA9PXRoaXMuTS5sZW5ndGg/dGhpcy5hLmRlYnVnKFwic3RhcnRGb3J3YXJkQ2hhbm5lbF8gcmV0dXJuZWQ6IG5vdGhpbmcgdG8gc2VuZFwiKTp0aGlzLkcuZWUoKT90aGlzLmEuY2EoXCJzdGFydEZvcndhcmRDaGFubmVsXyByZXR1cm5lZDogY29ubmVjdGlvbiBhbHJlYWR5IGluIHByb2dyZXNzXCIpOih0aGlzLmxlKCksIHRoaXMuYS5kZWJ1ZyhcInN0YXJ0Rm9yd2FyZENoYW5uZWxfIGZpbmlzaGVkLCBzZW50IHJlcXVlc3RcIikpKTt9O1xuZS5pZz1mdW5jdGlvbigpe3RoaXMuYS5kZWJ1ZyhcIm9wZW5fKClcIik7dGhpcy5ZYj1NYXRoLmZsb29yKDFFNSpNYXRoLnJhbmRvbSgpKTt2YXIgYT10aGlzLlliKyssYj1uZXcgUih0aGlzLHRoaXMuYSxcIlwiLGEsdm9pZCAwKSxjPXRoaXMuQTt0aGlzLlJiJiYoYz8oYz1EYShjKSwgRmEoYyx0aGlzLlJiKSk6Yz10aGlzLlJiKTtudWxsPT09dGhpcy5OJiZiLmdhKGMpO3ZhciBkPXRoaXMuSGQoYiksZj10aGlzLmhiLmNsb25lKCk7Zi5sKFwiUklEXCIsYSk7MDx0aGlzLkJkJiZmLmwoXCJDVkVSXCIsdGhpcy5CZCk7dGhpcy50YSYmdGhpcy5hYSYmZi5sKFwiWC1IVFRQLVNlc3Npb24tSWRcIix0aGlzLmFhKTt0aGlzLllhKGYpO3RoaXMuTiYmYyYmWmMoZix0aGlzLk4sYyk7dGhpcy5HLm9jKGIpO3RoaXMuTmQ/KGYubChcIiRyZXFcIixkKSwgZi5sKFwiU0lEXCIsXCJudWxsXCIpLCBiLkFnKCksIGIua2QoZixudWxsKSk6Yi5rZChmLGQpO307XG5lLmxlPWZ1bmN0aW9uKGEpe3ZhciBiPWE/YS5SOnRoaXMuWWIrKzt2YXIgYz10aGlzLmhiLmNsb25lKCk7Yy5sKFwiU0lEXCIsdGhpcy5yYSk7Yy5sKFwiUklEXCIsYik7Yy5sKFwiQUlEXCIsdGhpcy5TYik7dGhpcy5ZYShjKTt0aGlzLk4mJnRoaXMuQSYmWmMoYyx0aGlzLk4sdGhpcy5BKTtiPW5ldyBSKHRoaXMsdGhpcy5hLHRoaXMucmEsYix0aGlzLkxhKzEpO251bGw9PT10aGlzLk4mJmIuZ2EodGhpcy5BKTthJiZ0aGlzLnNnKGEpO2E9dGhpcy5IZChiKTtiLnNldFRpbWVvdXQoTWF0aC5yb3VuZCguNSp0aGlzLk9kKStNYXRoLnJvdW5kKC41KnRoaXMuT2QqTWF0aC5yYW5kb20oKSkpO3RoaXMuRy5vYyhiKTtiLmtkKGMsYSk7fTtlLllhPWZ1bmN0aW9uKGEpe3RoaXMuaSYmb2Moe30sZnVuY3Rpb24oYixjKXthLmwoYyxiKTt9KTt9O1xuZS5IZD1mdW5jdGlvbihhKXt2YXIgYj1NYXRoLm1pbih0aGlzLk0ubGVuZ3RoLDFFMyksYz10aGlzLmk/dSh0aGlzLmkuVWUsdGhpcy5pLHRoaXMpOm51bGw7Yz10aGlzLmtjLmpmKHRoaXMuTSxiLGMpO2EuR2codGhpcy5NLnNwbGljZSgwLGIpKTtyZXR1cm4gY307ZS5zZz1mdW5jdGlvbihhKXt0aGlzLk09YS5sYSgpLmNvbmNhdCh0aGlzLk0pO307ZS5LZD1mdW5jdGlvbigpe2lmKCF0aGlzLnUmJiF0aGlzLmlhKXt0aGlzLnJjPTE7dmFyIGE9dGhpcy52ZTtCYnx8Q2IoKTtFYnx8KEJiKCksIEViPSEwKTtGYi5hZGQoYSx0aGlzKTt0aGlzLkhhPTA7fX07XG5lLlFjPWZ1bmN0aW9uKCl7aWYodGhpcy51fHx0aGlzLmlhKXJldHVybiB0aGlzLmEuY2EoXCJSZXF1ZXN0IGFscmVhZHkgaW4gcHJvZ3Jlc3NcIiksICExO2lmKDM8PXRoaXMuSGEpcmV0dXJuITE7dGhpcy5hLmRlYnVnKFwiR29pbmcgdG8gcmV0cnkgR0VUXCIpO3RoaXMucmMrKzt0aGlzLmlhPVAodSh0aGlzLnZlLHRoaXMpLHRoaXMuWGQodGhpcy5IYSkpO3RoaXMuSGErKztyZXR1cm4hMH07ZS52ZT1mdW5jdGlvbigpe3RoaXMuaWE9bnVsbDt0aGlzLktnKCk7fTtcbmUuS2c9ZnVuY3Rpb24oKXt0aGlzLmEuZGVidWcoXCJDcmVhdGluZyBuZXcgSHR0cFJlcXVlc3RcIik7dGhpcy51PW5ldyBSKHRoaXMsdGhpcy5hLHRoaXMucmEsXCJycGNcIix0aGlzLnJjKTtudWxsPT09dGhpcy5OJiZ0aGlzLnUuZ2EodGhpcy5BKTt0aGlzLnUuSGUodGhpcy5SYSk7dmFyIGE9dGhpcy5tZC5jbG9uZSgpO2EubChcIlJJRFwiLFwicnBjXCIpO2EubChcIlNJRFwiLHRoaXMucmEpO2EubChcIkNJXCIsdGhpcy5mZD9cIjBcIjpcIjFcIik7YS5sKFwiQUlEXCIsdGhpcy5TYik7dGhpcy5ZYShhKTthLmwoXCJUWVBFXCIsXCJ4bWxodHRwXCIpO3RoaXMuTiYmdGhpcy5BJiZaYyhhLHRoaXMuTix0aGlzLkEpO3RoaXMuRGImJnRoaXMudS5zZXRUaW1lb3V0KHRoaXMuRGIpO3RoaXMudS5qZChhLCEwLHRoaXMubmEpO3RoaXMuYS5kZWJ1ZyhcIk5ldyBSZXF1ZXN0IGNyZWF0ZWRcIik7fTtcbmUudWI9ZnVuY3Rpb24oYSxiKXt0aGlzLmEuZGVidWcoXCJUZXN0IENvbm5lY3Rpb24gRmluaXNoZWRcIik7dmFyIGM9YS5BZDtjJiZ0aGlzLkcubGQoYyk7dGhpcy5mZD10aGlzLlNlJiZiO3RoaXMudz1hLnc7dGhpcy5hZigpO307ZS5kZD1mdW5jdGlvbihhKXt0aGlzLmEuZGVidWcoXCJUZXN0IENvbm5lY3Rpb24gRmFpbGVkXCIpO3RoaXMudz1hLnc7dGhpcy5zYSgyKTt9O1xuZS51ZT1mdW5jdGlvbihhLGIpe2lmKDAhPXRoaXMuZyYmKHRoaXMudT09YXx8dGhpcy5HLkpjKGEpKSlpZih0aGlzLnc9YS53LCAhYS5sYiYmdGhpcy5HLkpjKGEpJiYzPT10aGlzLmcpe3RyeXt2YXIgYz10aGlzLmtjLnpjKGIpO31jYXRjaChkKXtjPW51bGw7fW4oYykmJjM9PWMubGVuZ3RoP3RoaXMuQ2YoYyxhKToodGhpcy5hLmRlYnVnKFwiQmFkIFBPU1QgcmVzcG9uc2UgZGF0YSByZXR1cm5lZFwiKSwgdGhpcy5zYSgxMSkpO31lbHNlKGEubGJ8fHRoaXMudT09YSkmJnRoaXMuSGIoKSwgdmEoYil8fChjPXRoaXMua2MuemMoYiksIHRoaXMuZGcoYyxhKSk7fTtcbmUuQ2Y9ZnVuY3Rpb24oYSxiKXswPT1hWzBdP3RoaXMuQmYoYik6KHRoaXMuaGU9YVsxXSwgYj10aGlzLmhlLXRoaXMuU2IsIDA8YiYmKGE9YVsyXSwgdGhpcy5hLmRlYnVnKGErXCIgYnl0ZXMgKGluIFwiK2IrXCIgYXJyYXlzKSBhcmUgb3V0c3RhbmRpbmcgb24gdGhlIEJhY2tDaGFubmVsXCIpLCB0aGlzLkpnKGEpJiYhdGhpcy53YSYmKHRoaXMud2E9UCh1KHRoaXMuYmcsdGhpcyksNkUzKSkpKTt9O1xuZS5CZj1mdW5jdGlvbihhKXt0aGlzLmEuZGVidWcoXCJTZXJ2ZXIgY2xhaW1zIG91ciBiYWNrY2hhbm5lbCBpcyBtaXNzaW5nLlwiKTtpZih0aGlzLmlhKXRoaXMuYS5kZWJ1ZyhcIkJ1dCB3ZSBhcmUgY3VycmVudGx5IHN0YXJ0aW5nIHRoZSByZXF1ZXN0LlwiKTtlbHNle2lmKHRoaXMudSlpZih0aGlzLnUucWIrM0UzPGEucWIpdGhpcy5IYigpLCB0aGlzLnUuY2FuY2VsKCksIHRoaXMudT1udWxsO2Vsc2UgcmV0dXJuO2Vsc2UgdGhpcy5hLlQoXCJXZSBkbyBub3QgaGF2ZSBhIEJhY2tDaGFubmVsIGVzdGFibGlzaGVkXCIpO3RoaXMuUWMoKTtPKDE4KTt9fTtlLkpnPWZ1bmN0aW9uKGEpe3JldHVybiAzNzUwMD5hJiYhdGhpcy5OZigpJiYwPT10aGlzLkhhfTtlLiRhPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLlRlP3RoaXMuaT90aGlzLmkuJGEoYSk6YTpudWxsfTtcbmUuYmc9ZnVuY3Rpb24oKXtudWxsIT10aGlzLndhJiYodGhpcy53YT1udWxsLCB0aGlzLnUuY2FuY2VsKCksIHRoaXMudT1udWxsLCB0aGlzLlFjKCksIE8oMTkpKTt9O2UuSGI9ZnVuY3Rpb24oKXtudWxsIT10aGlzLndhJiYoaC5jbGVhclRpbWVvdXQodGhpcy53YSksIHRoaXMud2E9bnVsbCk7fTtcbmUuVGM9ZnVuY3Rpb24oYSl7dGhpcy5hLmRlYnVnKFwiUmVxdWVzdCBjb21wbGV0ZVwiKTt2YXIgYj1udWxsO2lmKHRoaXMudT09YSl7dGhpcy5IYigpO3RoaXMudT1udWxsO3ZhciBjPTI7fWVsc2UgaWYodGhpcy5HLkpjKGEpKWI9YS5sYSgpLCB0aGlzLkcuemUoYSksIGM9MTtlbHNlIHJldHVybjt0aGlzLnc9YS53O2lmKDAhPXRoaXMuZylpZihhLlMpMT09Yz8oYWMoYS5EYT9hLkRhLmxlbmd0aDowLHcoKS1hLnFiLHRoaXMuTGEpLCB0aGlzLkRjKCkpOnRoaXMuS2QoKTtlbHNle3ZhciBkPWEuSGMoKTtpZigzPT1kfHwwPT1kJiYwPHRoaXMudyl0aGlzLmEuZGVidWcoXCJOb3QgcmV0cnlpbmcgZHVlIHRvIGVycm9yIHR5cGVcIik7ZWxzZXt2YXIgZj10aGlzO3RoaXMuYS5kZWJ1ZyhmdW5jdGlvbigpe3JldHVyblwiTWF5YmUgcmV0cnlpbmcsIGxhc3QgZXJyb3I6IFwiK2tjKGQsZi53KX0pO2lmKDE9PWMmJnRoaXMuWWYoYSl8fDI9PWMmJnRoaXMuUWMoKSlyZXR1cm47dGhpcy5hLmRlYnVnKFwiRXhjZWVkZWQgbWF4IG51bWJlciBvZiByZXRyaWVzXCIpO31iJiZcbjA8Yi5sZW5ndGgmJnRoaXMuRy5SZShiKTt0aGlzLmEuZGVidWcoXCJFcnJvcjogSFRUUCByZXF1ZXN0IGZhaWxlZFwiKTtzd2l0Y2goZCl7Y2FzZSAxOnRoaXMuc2EoNSk7YnJlYWs7Y2FzZSA0OnRoaXMuc2EoMTApO2JyZWFrO2Nhc2UgMzp0aGlzLnNhKDYpO2JyZWFrO2RlZmF1bHQ6dGhpcy5zYSgyKTt9fX07ZS5YZD1mdW5jdGlvbihhKXt2YXIgYj10aGlzLlZlK01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSp0aGlzLnZnKTt0aGlzLkJhKCl8fCh0aGlzLmEuZGVidWcoXCJJbmFjdGl2ZSBjaGFubmVsXCIpLCBiKj0yKTtyZXR1cm4gYiphfTtlLnBjPWZ1bmN0aW9uKGEpe2lmKHRoaXMudGEmJihhPWEuaCkpe3ZhciBiPWEua2IoXCJYLUNsaWVudC1XaXJlLVByb3RvY29sXCIpO2ImJnRoaXMuRy5sZChiKTt0aGlzLmFhJiYoKGE9YS5rYihcIlgtSFRUUC1TZXNzaW9uLUlkXCIpKT8odGhpcy5GZShhKSwgdGhpcy5oYi5sKHRoaXMuYWEsYSkpOnRoaXMuYS5UKFwiTWlzc2luZyBYX0hUVFBfU0VTU0lPTl9JRCBpbiB0aGUgaGFuZHNoYWtlIHJlc3BvbnNlXCIpKTt9fTtcbmUuZGc9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9dGhpcy5pJiZ0aGlzLmkuc2M/W106bnVsbCxkPTA7ZDxhLmxlbmd0aDtkKyspe3ZhciBmPWFbZF07dGhpcy5TYj1mWzBdO2Y9ZlsxXTtpZigyPT10aGlzLmcpaWYoXCJjXCI9PWZbMF0pe3RoaXMucmE9ZlsxXTt0aGlzLm5hPXRoaXMuJGEoZlsyXSk7dmFyIGc9ZlszXTtudWxsIT1nJiYodGhpcy50Yz1nLCB0aGlzLmEuaW5mbyhcIlZFUj1cIit0aGlzLnRjKSk7Zz1mWzRdO251bGwhPWcmJih0aGlzLkRlPWcsIHRoaXMuYS5pbmZvKFwiU1ZFUj1cIit0aGlzLkRlKSk7Zj1mWzVdO251bGwhPWYmJlwibnVtYmVyXCI9PXR5cGVvZiBmJiYwPGYmJih0aGlzLkRiPWYqPTEuNSwgdGhpcy5hLmluZm8oXCJiYWNrQ2hhbm5lbFJlcXVlc3RUaW1lb3V0TXNfPVwiK2YpKTt0aGlzLnBjKGIpO3RoaXMuZz0zO3RoaXMuaSYmdGhpcy5pLndkKCk7dGhpcy5MZyhiKTt9ZWxzZVwic3RvcFwiIT1mWzBdJiZcImNsb3NlXCIhPWZbMF18fHRoaXMuc2EoNyk7ZWxzZSAzPT10aGlzLmcmJlxuKFwic3RvcFwiPT1mWzBdfHxcImNsb3NlXCI9PWZbMF0/KGMmJjAhPWMubGVuZ3RoJiYodGhpcy5pLnNjKHRoaXMsYyksIGMubGVuZ3RoPTApLCBcInN0b3BcIj09ZlswXT90aGlzLnNhKDcpOnRoaXMuZGlzY29ubmVjdCgpKTpcIm5vb3BcIiE9ZlswXSYmKGM/Yy5wdXNoKGYpOnRoaXMuaSYmdGhpcy5pLnVkKGYpKSwgdGhpcy5IYT0wKTt9YyYmMCE9Yy5sZW5ndGgmJnRoaXMuaS5zYyh0aGlzLGMpO307ZS5MZz1mdW5jdGlvbihhKXt0aGlzLm1kPXRoaXMuUGQodGhpcy5uYSx0aGlzLkspO2EubGI/KHRoaXMuYS5kZWJ1ZyhcIlVwZ3JhZGUgdGhlIGhhbmRzaGFrZSByZXF1ZXN0IHRvIGEgYmFja2NoYW5uZWwuXCIpLCB0aGlzLkcuemUoYSksIGEudGcodGhpcy5EYiksIHRoaXMudT1hKTp0aGlzLktkKCk7fTtcbmUuc2E9ZnVuY3Rpb24oYSl7dGhpcy5hLmluZm8oXCJFcnJvciBjb2RlIFwiK2EpO2lmKDI9PWEpe3ZhciBiPW51bGw7dGhpcy5pJiYoYj1udWxsKTt2YXIgYz11KHRoaXMuUGcsdGhpcyk7Ynx8KGI9bmV3IFUoXCIvL3d3dy5nb29nbGUuY29tL2ltYWdlcy9jbGVhcmRvdC5naWZcIiksIGgubG9jYXRpb24mJlwiaHR0cFwiPT1oLmxvY2F0aW9uLnByb3RvY29sfHxiLnRiKFwiaHR0cHNcIiksIGIuVWIoKSk7UWMoYi50b1N0cmluZygpLGMpO31lbHNlIE8oMik7dGhpcy5jZyhhKTt9O2UuUGc9ZnVuY3Rpb24oYSl7YT8odGhpcy5hLmluZm8oXCJTdWNjZXNzZnVsbHkgcGluZ2VkIGdvb2dsZS5jb21cIiksIE8oMikpOih0aGlzLmEuaW5mbyhcIkZhaWxlZCB0byBwaW5nIGdvb2dsZS5jb21cIiksIE8oMSkpO307ZS5jZz1mdW5jdGlvbihhKXt0aGlzLmEuZGVidWcoXCJIdHRwQ2hhbm5lbDogZXJyb3IgLSBcIithKTt0aGlzLmc9MDt0aGlzLmkmJnRoaXMuaS50ZChhKTt0aGlzLnFlKCk7dGhpcy5xZCgpO307XG5lLnFlPWZ1bmN0aW9uKCl7dGhpcy5nPTA7dGhpcy53PS0xO2lmKHRoaXMuaSl7dmFyIGE9dGhpcy5HLmxhKCk7aWYoMCE9YS5sZW5ndGh8fDAhPXRoaXMuTS5sZW5ndGgpe3ZhciBiPXRoaXM7dGhpcy5hLmRlYnVnKGZ1bmN0aW9uKCl7cmV0dXJuXCJOdW1iZXIgb2YgdW5kZWxpdmVyZWQgbWFwcywgcGVuZGluZzogXCIrYS5sZW5ndGgrXCIsIG91dGdvaW5nOiBcIitiLk0ubGVuZ3RofSk7dGhpcy5HLiRlKCk7dWEodGhpcy5NKTt0aGlzLk0ubGVuZ3RoPTA7fXRoaXMuaS5zZCgpO319O2UuU2Q9ZnVuY3Rpb24oYSl7YT10aGlzLkNkKG51bGwsYSk7dGhpcy5hLmRlYnVnKFwiR2V0Rm9yd2FyZENoYW5uZWxVcmk6IFwiK2EpO3JldHVybiBhfTtlLlBkPWZ1bmN0aW9uKGEsYil7YT10aGlzLkNkKHRoaXMuZmMoKT9hOm51bGwsYik7dGhpcy5hLmRlYnVnKFwiR2V0QmFja0NoYW5uZWxVcmk6IFwiK2EpO3JldHVybiBhfTtcbmUuQ2Q9ZnVuY3Rpb24oYSxiKXt2YXIgYz1BYyhiKTtpZihcIlwiIT1jLnhhKWEmJmMucmIoYStcIi5cIitjLnhhKSwgYy5zYihjLkNhKTtlbHNle3ZhciBkPWgubG9jYXRpb247Yz1CYyhkLnByb3RvY29sLGE/YStcIi5cIitkLmhvc3RuYW1lOmQuaG9zdG5hbWUsK2QucG9ydCxiKTt9dGhpcy5nYiYmQWEodGhpcy5nYixmdW5jdGlvbihhLGIpe2MubChiLGEpO30pO2E9dGhpcy5hYTtiPXRoaXMuS2M7YSYmYiYmYy5sKGEsYik7Yy5sKFwiVkVSXCIsdGhpcy50Yyk7dGhpcy5ZYShjKTtyZXR1cm4gY307ZS5KYj1mdW5jdGlvbihhKXtpZihhJiYhdGhpcy5nYyl0aHJvdyBFcnJvcihcIkNhbid0IGNyZWF0ZSBzZWNvbmRhcnkgZG9tYWluIGNhcGFibGUgWGhySW8gb2JqZWN0LlwiKTthPW5ldyBWKHRoaXMuWGEpO2EuSmUodGhpcy5nYyk7cmV0dXJuIGF9O2UuQmE9ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuaSYmdGhpcy5pLkJhKCl9O2UuZmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nY307ZnVuY3Rpb24gYWQoKXt9ZT1hZC5wcm90b3R5cGU7ZS5zYz1udWxsO2Uud2Q9ZnVuY3Rpb24oKXt9O2UudWQ9ZnVuY3Rpb24oKXt9O2UudGQ9ZnVuY3Rpb24oKXt9O2Uuc2Q9ZnVuY3Rpb24oKXt9O2UuQmE9ZnVuY3Rpb24oKXtyZXR1cm4hMH07ZS5VZT1mdW5jdGlvbigpe307ZS4kYT1mdW5jdGlvbihhKXtyZXR1cm4gYX07ZnVuY3Rpb24gYmQoYSl7Zm9yKHZhciBiPWFyZ3VtZW50c1swXSxjPTE7Yzxhcmd1bWVudHMubGVuZ3RoO2MrKyl7dmFyIGQ9YXJndW1lbnRzW2NdO2lmKDA9PWQubGFzdEluZGV4T2YoXCIvXCIsMCkpYj1kO2Vsc2V7dmFyIGY7KGY9XCJcIj09Yil8fChmPWIubGVuZ3RoLTEsIGY9MDw9ZiYmYi5pbmRleE9mKFwiL1wiLGYpPT1mKTtiPWY/YitkOmIrKFwiL1wiK2QpO319cmV0dXJuIGJ9ZnVuY3Rpb24gY2QoKXtpZihDJiYhKDEwPD1OdW1iZXIoVWEpKSl0aHJvdyBFcnJvcihcIkVudmlyb25tZW50YWwgZXJyb3I6IG5vIGF2YWlsYWJsZSB0cmFuc3BvcnQuXCIpO31jZC5wcm90b3R5cGUuY2Y9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFcoYSxiKX07XG5mdW5jdGlvbiBXKGEsYil7SC5jYWxsKHRoaXMpO3RoaXMuYj1uZXcgJGMoYik7dGhpcy55Yj1hO3RoaXMuUWc9YiYmYi50ZXN0VXJsP2IudGVzdFVybDpiZCh0aGlzLnliLFwidGVzdFwiKTt0aGlzLnM9VmIoXCJnb29nLmxhYnMubmV0LndlYkNoYW5uZWwuV2ViQ2hhbm5lbEJhc2VUcmFuc3BvcnRcIik7dGhpcy5SYz1iJiZiLm1lc3NhZ2VVcmxQYXJhbXN8fG51bGw7YT1iJiZiLm1lc3NhZ2VIZWFkZXJzfHxudWxsO2ImJmIuY2xpZW50UHJvdG9jb2xIZWFkZXJSZXF1aXJlZCYmKGE/YVtcIlgtQ2xpZW50LVByb3RvY29sXCJdPVwid2ViY2hhbm5lbFwiOmE9e1wiWC1DbGllbnQtUHJvdG9jb2xcIjpcIndlYmNoYW5uZWxcIn0pO3RoaXMuYi5nYShhKTthPWImJmIuaW5pdE1lc3NhZ2VIZWFkZXJzfHxudWxsO2ImJmIubWVzc2FnZUNvbnRlbnRUeXBlJiYoYT9hW1wiWC1XZWJDaGFubmVsLUNvbnRlbnQtVHlwZVwiXT1iLm1lc3NhZ2VDb250ZW50VHlwZTphPXtcIlgtV2ViQ2hhbm5lbC1Db250ZW50LVR5cGVcIjpiLm1lc3NhZ2VDb250ZW50VHlwZX0pO1xuYiYmYi56ZCYmKGE/YVtcIlgtV2ViQ2hhbm5lbC1DbGllbnQtUHJvZmlsZVwiXT1iLnpkOmE9e1wiWC1XZWJDaGFubmVsLUNsaWVudC1Qcm9maWxlXCI6Yi56ZH0pO3RoaXMuYi5FZyhhKTsoYT1iJiZiLmh0dHBIZWFkZXJzT3ZlcndyaXRlUGFyYW0pJiYhdmEoYSkmJnRoaXMuYi5DZyhhKTt0aGlzLk9nPWImJmIuc3VwcG9ydHNDcm9zc0RvbWFpblhocnx8ITE7dGhpcy56Zz1iJiZiLnNlbmRSYXdKc29ufHwhMTsoYj1iJiZiLmh0dHBTZXNzaW9uSWRQYXJhbSkmJiF2YShiKSYmKHRoaXMuYi5EZyhiKSwgYT10aGlzLlJjLCBudWxsIT09YSYmYiBpbiBhJiYoYT10aGlzLlJjLCBiIGluIGEmJmRlbGV0ZSBhW2JdLCAoYT10aGlzLnMpJiZhLlQoXCJJZ25vcmUgaHR0cFNlc3Npb25JZFBhcmFtIGFsc28gc3BlY2lmaWVkIHdpdGggbWVzc2FnZVVybFBhcmFtczogXCIrYix2b2lkIDApKSk7dGhpcy52ZD1uZXcgWCh0aGlzKTt9eChXLEgpO2U9Vy5wcm90b3R5cGU7XG5lLmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oYSxiLGMsZCl7Vy5MLmFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLGEsYixjLGQpO307ZS5yZW1vdmVFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGEsYixjLGQpe1cuTC5yZW1vdmVFdmVudExpc3RlbmVyLmNhbGwodGhpcyxhLGIsYyxkKTt9O2Uub3Blbj1mdW5jdGlvbigpe3RoaXMuYi5FZSh0aGlzLnZkKTt0aGlzLk9nJiZ0aGlzLmIuSGcoKTt0aGlzLmIuY29ubmVjdCh0aGlzLlFnLHRoaXMueWIsdGhpcy5SY3x8dm9pZCAwKTt9O2UuY2xvc2U9ZnVuY3Rpb24oKXt0aGlzLmIuZGlzY29ubmVjdCgpO307ZS5zZW5kPWZ1bmN0aW9uKGEpe2lmKGwoYSkpe3ZhciBiPXt9O2IuX19kYXRhX189YTt0aGlzLmIuWmMoYik7fWVsc2UgdGhpcy56Zz8oYj17fSwgYi5fX2RhdGFfXz11YihhKSwgdGhpcy5iLlpjKGIpKTp0aGlzLmIuWmMoYSk7fTtcbmUuRj1mdW5jdGlvbigpe3RoaXMuYi5FZShudWxsKTtkZWxldGUgdGhpcy52ZDt0aGlzLmIuZGlzY29ubmVjdCgpO2RlbGV0ZSB0aGlzLmI7Vy5MLkYuY2FsbCh0aGlzKTt9O2Z1bmN0aW9uIGRkKGEpe2ZjLmNhbGwodGhpcyk7dmFyIGI9YS5fX3NtX187aWYoYil7YTp7Zm9yKHZhciBjIGluIGIpe2E9YzticmVhayBhfWE9dm9pZCAwO31pZih0aGlzLm5lPWEpYT10aGlzLm5lLCBiPW51bGwhPT1iJiZhIGluIGI/YlthXTp2b2lkIDA7dGhpcy5kYXRhPWI7fWVsc2UgdGhpcy5kYXRhPWE7fXgoZGQsZmMpO2Z1bmN0aW9uIGVkKGEpe2djLmNhbGwodGhpcyk7dGhpcy5zdGF0dXM9MTt0aGlzLmVycm9yQ29kZT1hO314KGVkLGdjKTtmdW5jdGlvbiBYKGEpe3RoaXMuYj1hO314KFgsYWQpO1gucHJvdG90eXBlLndkPWZ1bmN0aW9uKCl7V2IodGhpcy5iLnMsXCJXZWJDaGFubmVsIG9wZW5lZCBvbiBcIit0aGlzLmIueWIpO3RoaXMuYi5kaXNwYXRjaEV2ZW50KFwiYVwiKTt9O1gucHJvdG90eXBlLnVkPWZ1bmN0aW9uKGEpe3RoaXMuYi5kaXNwYXRjaEV2ZW50KG5ldyBkZChhKSk7fTtcblgucHJvdG90eXBlLnRkPWZ1bmN0aW9uKGEpe1diKHRoaXMuYi5zLFwiV2ViQ2hhbm5lbCBhYm9ydGVkIG9uIFwiK3RoaXMuYi55YitcIiBkdWUgdG8gY2hhbm5lbCBlcnJvcjogXCIrYSk7dGhpcy5iLmRpc3BhdGNoRXZlbnQobmV3IGVkKGEpKTt9O1gucHJvdG90eXBlLnNkPWZ1bmN0aW9uKCl7V2IodGhpcy5iLnMsXCJXZWJDaGFubmVsIGNsb3NlZCBvbiBcIit0aGlzLmIueWIpO3RoaXMuYi5kaXNwYXRjaEV2ZW50KFwiYlwiKTt9O3ZhciBmZD12KGZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1hLnByb3RvdHlwZTt2YXIgZD1uZXcgYzthLmFwcGx5KGQsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTtyZXR1cm4gZH0sY2QpO2Z1bmN0aW9uIGdkKCl7dGhpcy5WPVtdO3RoaXMuWj1bXTt9ZT1nZC5wcm90b3R5cGU7ZS5WZj1mdW5jdGlvbigpezA9PXRoaXMuVi5sZW5ndGgmJih0aGlzLlY9dGhpcy5aLCB0aGlzLlYucmV2ZXJzZSgpLCB0aGlzLlo9W10pO307ZS5lbnF1ZXVlPWZ1bmN0aW9uKGEpe3RoaXMuWi5wdXNoKGEpO307ZS5hYj1mdW5jdGlvbigpe3RoaXMuVmYoKTtyZXR1cm4gdGhpcy5WLnBvcCgpfTtlLkM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5WLmxlbmd0aCt0aGlzLloubGVuZ3RofTtlLlg9ZnVuY3Rpb24oKXtyZXR1cm4gMD09dGhpcy5WLmxlbmd0aCYmMD09dGhpcy5aLmxlbmd0aH07ZS5jbGVhcj1mdW5jdGlvbigpe3RoaXMuVj1bXTt0aGlzLlo9W107fTtlLmNvbnRhaW5zPWZ1bmN0aW9uKGEpe3JldHVybiAwPD1sYSh0aGlzLlYsYSl8fDA8PWxhKHRoaXMuWixhKX07XG5lLnJlbW92ZT1mdW5jdGlvbihhKXt2YXIgYj10aGlzLlY7dmFyIGM9bWEoYixhKTswPD1jPyhBcnJheS5wcm90b3R5cGUuc3BsaWNlLmNhbGwoYixjLDEpLCBiPSEwKTpiPSExO3JldHVybiBifHxzYSh0aGlzLlosYSl9O2UuSD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPXRoaXMuVi5sZW5ndGgtMTswPD1iOy0tYilhLnB1c2godGhpcy5WW2JdKTt2YXIgYz10aGlzLloubGVuZ3RoO2ZvcihiPTA7YjxjOysrYilhLnB1c2godGhpcy5aW2JdKTtyZXR1cm4gYX07ZnVuY3Rpb24gaGQoYSxiKXt6LmNhbGwodGhpcyk7dGhpcy5vZT1hfHwwO3RoaXMuV2I9Ynx8MTA7aWYodGhpcy5vZT50aGlzLldiKXRocm93IEVycm9yKGlkKTt0aGlzLmZhPW5ldyBnZDt0aGlzLm9hPW5ldyBKYzt0aGlzLkFjPTA7dGhpcy5OYz1udWxsO3RoaXMuQ2IoKTt9eChoZCx6KTt2YXIgaWQ9XCJbZ29vZy5zdHJ1Y3RzLlBvb2xdIE1pbiBjYW4gbm90IGJlIGdyZWF0ZXIgdGhhbiBtYXhcIjtlPWhkLnByb3RvdHlwZTtlLk1iPWZ1bmN0aW9uKCl7dmFyIGE9dygpO2lmKCEobnVsbCE9dGhpcy5OYyYmYS10aGlzLk5jPHRoaXMuQWMpKXt2YXIgYj10aGlzLnFnKCk7YiYmKHRoaXMuTmM9YSwgdGhpcy5vYS5hZGQoYikpO3JldHVybiBifX07ZS5vZz1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5vYS5yZW1vdmUoYSk/KHRoaXMubmMoYSksICEwKTohMX07XG5lLnFnPWZ1bmN0aW9uKCl7Zm9yKHZhciBhOzA8dGhpcy5UZCgpJiYoYT10aGlzLmZhLmFiKCksICF0aGlzLlNjKGEpKTspdGhpcy5DYigpOyFhJiZ0aGlzLkMoKTx0aGlzLldiJiYoYT10aGlzLnhjKCkpO3JldHVybiBhfTtlLm5jPWZ1bmN0aW9uKGEpe3RoaXMub2EucmVtb3ZlKGEpO3RoaXMuU2MoYSkmJnRoaXMuQygpPHRoaXMuV2I/dGhpcy5mYS5lbnF1ZXVlKGEpOnRoaXMuQmMoYSk7fTtlLkNiPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuZmE7dGhpcy5DKCk8dGhpcy5vZTspYS5lbnF1ZXVlKHRoaXMueGMoKSk7Zm9yKDt0aGlzLkMoKT50aGlzLldiJiYwPHRoaXMuVGQoKTspdGhpcy5CYyhhLmFiKCkpO307ZS54Yz1mdW5jdGlvbigpe3JldHVybnt9fTtlLkJjPWZ1bmN0aW9uKGEpe2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGEuYmIpYS5iYigpO2Vsc2UgZm9yKHZhciBiIGluIGEpYVtiXT1udWxsO307XG5lLlNjPWZ1bmN0aW9uKGEpe3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIGEuWWU/YS5ZZSgpOiEwfTtlLmNvbnRhaW5zPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmZhLmNvbnRhaW5zKGEpfHx0aGlzLm9hLmNvbnRhaW5zKGEpfTtlLkM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mYS5DKCkrdGhpcy5vYS5DKCl9O2UucmY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vYS5DKCl9O2UuVGQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mYS5DKCl9O2UuWD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZhLlgoKSYmdGhpcy5vYS5YKCl9O2UuRj1mdW5jdGlvbigpe2hkLkwuRi5jYWxsKHRoaXMpO2lmKDA8dGhpcy5yZigpKXRocm93IEVycm9yKFwiW2dvb2cuc3RydWN0cy5Qb29sXSBPYmplY3RzIG5vdCByZWxlYXNlZFwiKTtkZWxldGUgdGhpcy5vYTtmb3IodmFyIGE9dGhpcy5mYTshYS5YKCk7KXRoaXMuQmMoYS5hYigpKTtkZWxldGUgdGhpcy5mYTt9O2Z1bmN0aW9uIGpkKGEsYil7dGhpcy5mZT1hO3RoaXMuZ2Q9Yjt9amQucHJvdG90eXBlLmdldEtleT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZlfTtqZC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpkKHRoaXMuZmUsdGhpcy5nZCl9O2Z1bmN0aW9uIGtkKGEpe3RoaXMuWT1bXTthJiZ0aGlzLkxmKGEpO31lPWtkLnByb3RvdHlwZTtlLmNlPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5ZO2MucHVzaChuZXcgamQoYSxiKSk7dGhpcy4kZihjLmxlbmd0aC0xKTt9O2UuTGY9ZnVuY3Rpb24oYSl7aWYoYSBpbnN0YW5jZW9mIGtkKXt2YXIgYj1hLlcoKTthPWEuSCgpO2lmKDA+PXRoaXMuQygpKXtmb3IodmFyIGM9dGhpcy5ZLGQ9MDtkPGIubGVuZ3RoO2QrKyljLnB1c2gobmV3IGpkKGJbZF0sYVtkXSkpO3JldHVybn19ZWxzZSBiPUNhKGEpLCBhPUJhKGEpO2ZvcihkPTA7ZDxiLmxlbmd0aDtkKyspdGhpcy5jZShiW2RdLGFbZF0pO307ZS5yZW1vdmU9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLlksYj1hLmxlbmd0aCxjPWFbMF07aWYoISgwPj1iKSlyZXR1cm4gMT09Yj9yYShhKTooYVswXT1hLnBvcCgpLCB0aGlzLlpmKCkpLCBjLmdkfTtcbmUuWmY9ZnVuY3Rpb24oKXtmb3IodmFyIGE9MCxiPXRoaXMuWSxjPWIubGVuZ3RoLGQ9YlthXTthPGM+PjE7KXt2YXIgZj10aGlzLnRmKGEpLGc9dGhpcy56ZihhKTtmPWc8YyYmYltnXS5nZXRLZXkoKTxiW2ZdLmdldEtleSgpP2c6ZjtpZihiW2ZdLmdldEtleSgpPmQuZ2V0S2V5KCkpYnJlYWs7YlthXT1iW2ZdO2E9Zjt9YlthXT1kO307ZS4kZj1mdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5ZLGM9YlthXTswPGE7KXt2YXIgZD10aGlzLndmKGEpO2lmKGJbZF0uZ2V0S2V5KCk+Yy5nZXRLZXkoKSliW2FdPWJbZF0sIGE9ZDtlbHNlIGJyZWFrfWJbYV09Yzt9O2UudGY9ZnVuY3Rpb24oYSl7cmV0dXJuIDIqYSsxfTtlLnpmPWZ1bmN0aW9uKGEpe3JldHVybiAyKmErMn07ZS53Zj1mdW5jdGlvbihhKXtyZXR1cm4gYS0xPj4xfTtlLkg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5ZLGI9W10sYz1hLmxlbmd0aCxkPTA7ZDxjO2QrKyliLnB1c2goYVtkXS5nZCk7cmV0dXJuIGJ9O1xuZS5XPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuWSxiPVtdLGM9YS5sZW5ndGgsZD0wO2Q8YztkKyspYi5wdXNoKGFbZF0uZ2V0S2V5KCkpO3JldHVybiBifTtlLnZhPWZ1bmN0aW9uKGEpe3JldHVybiBvYSh0aGlzLlksZnVuY3Rpb24oYil7cmV0dXJuIGIuZ2V0S2V5KCk9PWF9KX07ZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcga2QodGhpcyl9O2UuQz1mdW5jdGlvbigpe3JldHVybiB0aGlzLlkubGVuZ3RofTtlLlg9ZnVuY3Rpb24oKXtyZXR1cm4gMD09dGhpcy5ZLmxlbmd0aH07ZS5jbGVhcj1mdW5jdGlvbigpe3JhKHRoaXMuWSk7fTtmdW5jdGlvbiBsZCgpe2tkLmNhbGwodGhpcyk7fXgobGQsa2QpO2xkLnByb3RvdHlwZS5lbnF1ZXVlPWZ1bmN0aW9uKGEsYil7dGhpcy5jZShhLGIpO307bGQucHJvdG90eXBlLmFiPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVtb3ZlKCl9O2Z1bmN0aW9uIFkoYSxiKXt0aGlzLkdkPXZvaWQgMDt0aGlzLmNjPW5ldyBsZDtoZC5jYWxsKHRoaXMsYSxiKTt9eChZLGhkKTtlPVkucHJvdG90eXBlO2UuTWI9ZnVuY3Rpb24oYSxiKXtpZighYSlyZXR1cm4oYT1ZLkwuTWIuY2FsbCh0aGlzKSkmJnRoaXMuQWMmJih0aGlzLkdkPWguc2V0VGltZW91dCh1KHRoaXMuTmIsdGhpcyksdGhpcy5BYykpLCBhO3RoaXMuY2MuZW5xdWV1ZSh2b2lkIDAhPT1iP2I6MTAwLGEpO3RoaXMuTmIoKTt9O2UuTmI9ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5jYzswPGEuQygpOyl7dmFyIGI9dGhpcy5NYigpO2lmKGIpYS5hYigpLmFwcGx5KHRoaXMsW2JdKTtlbHNlIGJyZWFrfX07ZS5uYz1mdW5jdGlvbihhKXtZLkwubmMuY2FsbCh0aGlzLGEpO3RoaXMuTmIoKTt9O2UuQ2I9ZnVuY3Rpb24oKXtZLkwuQ2IuY2FsbCh0aGlzKTt0aGlzLk5iKCk7fTtcbmUuRj1mdW5jdGlvbigpe1kuTC5GLmNhbGwodGhpcyk7aC5jbGVhclRpbWVvdXQodGhpcy5HZCk7dGhpcy5jYy5jbGVhcigpO3RoaXMuY2M9bnVsbDt9O2Z1bmN0aW9uIFooYSxiLGMsZCl7dGhpcy5KZj1hO3RoaXMuQWI9ISFkO1kuY2FsbCh0aGlzLGIsYyk7fXgoWixZKTtaLnByb3RvdHlwZS54Yz1mdW5jdGlvbigpe3ZhciBhPW5ldyBWLGI9dGhpcy5KZjtiJiZiLmZvckVhY2goZnVuY3Rpb24oYixkKXthLmhlYWRlcnMuc2V0KGQsYik7fSk7dGhpcy5BYiYmYS5KZSghMCk7cmV0dXJuIGF9O1oucHJvdG90eXBlLlNjPWZ1bmN0aW9uKGEpe3JldHVybiFhLkthJiYhYS5CYSgpfTtjZC5wcm90b3R5cGUuY3JlYXRlV2ViQ2hhbm5lbD1jZC5wcm90b3R5cGUuY2Y7Vy5wcm90b3R5cGUuc2VuZD1XLnByb3RvdHlwZS5zZW5kO1cucHJvdG90eXBlLm9wZW49Vy5wcm90b3R5cGUub3BlbjtXLnByb3RvdHlwZS5jbG9zZT1XLnByb3RvdHlwZS5jbG9zZTtiYy5OT19FUlJPUj0wO2JjLlRJTUVPVVQ9ODtiYy5IVFRQX0VSUk9SPTY7Y2MuQ09NUExFVEU9XCJjb21wbGV0ZVwiO2VjLkV2ZW50VHlwZT1RO1EuT1BFTj1cImFcIjtRLkNMT1NFPVwiYlwiO1EuRVJST1I9XCJjXCI7US5NRVNTQUdFPVwiZFwiO0gucHJvdG90eXBlLmxpc3Rlbj1ILnByb3RvdHlwZS5uYjtaLnByb3RvdHlwZS5nZXRPYmplY3Q9Wi5wcm90b3R5cGUuTWI7Wi5wcm90b3R5cGUucmVsZWFzZU9iamVjdD1aLnByb3RvdHlwZS5vZztWLnByb3RvdHlwZS5saXN0ZW5PbmNlPVYucHJvdG90eXBlLk9jO1YucHJvdG90eXBlLmdldExhc3RFcnJvcj1WLnByb3RvdHlwZS5IYztWLnByb3RvdHlwZS5nZXRMYXN0RXJyb3JDb2RlPVYucHJvdG90eXBlLlVkO1xuVi5wcm90b3R5cGUuZ2V0U3RhdHVzPVYucHJvdG90eXBlLnphO1YucHJvdG90eXBlLmdldFN0YXR1c1RleHQ9Vi5wcm90b3R5cGUuWWQ7Vi5wcm90b3R5cGUuZ2V0UmVzcG9uc2VKc29uPVYucHJvdG90eXBlLnlmO1YucHJvdG90eXBlLmdldFJlc3BvbnNlVGV4dD1WLnByb3RvdHlwZS55YTtWLnByb3RvdHlwZS5nZXRSZXNwb25zZVRleHQ9Vi5wcm90b3R5cGUueWE7Vi5wcm90b3R5cGUuc2VuZD1WLnByb3RvdHlwZS5zZW5kO3ZhciBzcmM9e2NyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQ6ZmQsRXJyb3JDb2RlOmJjLEV2ZW50VHlwZTpjYyxXZWJDaGFubmVsOmVjLFhocklvUG9vbDpafTtcbnZhciBzcmNfMSA9IHNyYy5jcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0O1xudmFyIHNyY18yID0gc3JjLkVycm9yQ29kZTtcbnZhciBzcmNfMyA9IHNyYy5FdmVudFR5cGU7XG52YXIgc3JjXzQgPSBzcmMuV2ViQ2hhbm5lbDtcbnZhciBzcmNfNSA9IHNyYy5YaHJJb1Bvb2w7XG5cbmV4cG9ydCBkZWZhdWx0IHNyYztcbmV4cG9ydCB7IHNyY18xIGFzIGNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQsIHNyY18yIGFzIEVycm9yQ29kZSwgc3JjXzMgYXMgRXZlbnRUeXBlLCBzcmNfNCBhcyBXZWJDaGFubmVsLCBzcmNfNSBhcyBYaHJJb1Bvb2wgfTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9AZmlyZWJhc2Uvd2ViY2hhbm5lbC13cmFwcGVyL2Rpc3QvaW5kZXguZXNtLmpzXG4vLyBtb2R1bGUgaWQgPSAzOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKlxyXG4gKiBQcm92aWRlcyBhIGRlY29yYXRvciBmdW5jdG9yIGZvciBhbm5vdGF0aW5nIGZ1bmN0aW9ucyBpbiBDb21wb25lbnQgZGVmaW5pdGlvbnMgc28gdGhhdCB0aGV5IGFyZSBhdXRvbWF0aWNhbGx5XHJcbiAqIGJvdW5kIGFuZCB1bmJvdW5kIGZyb20gZXZlbnRzIHdpdGhvdXQgbmVlZGluZyB0byBjYWxsIGVsLmFkZEV2ZW50TGlzdGVuZXIgb3IgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lciB5b3Vyc2VsZi5cclxuICpcclxuICogRGVjb3JhdGlvbnMgc2hvdWxkIGJlIG1hZGUgaW4gdGhlIENvbXBvbmVudHMgZGVmaW5pdGlvbiBvYmplY3QuIEhlcmUgaXMgdGhlIHNpbXBsZXN0IGV4YW1wbGU6XHJcbiAqXHJcbiAqIGNvbnN0IHtiaW5kRXZlbnR9ID0gcmVxdWlyZSgnZXZlbnQtYmluZGVyJyk7XHJcbiAqXHJcbiAqIEFGUkFNRS5yZWdpc3RlckNvbXBvbmVudChcImZvb1wiLCB7XHJcbiAqICAgY29tcG9uZW50Y2hhbmdlZDogYmluZEV2ZW50KCBmdW5jdGlvbihldnQpIHtcclxuICogICAgIGNvbnNvbGUubG9nKGV2dC5kZXRhaWwpO1xyXG4gKiAgIH0pXHJcbiAqIH0pXHJcbiAqXHJcbiAqIEJ5IGRlZmF1bHQgdGhlIGZ1bmN0aW9uIHdpbGwgYmUgYm91bmQgdG8gZXZlbnRzIGNvcnJlc3BvbmRpbmcgdG8gaXRzIHByb3BlcnR5IG5hbWUsIGluIHRoaXMgY2FzZTogJ2NvbXBvbmVudGNoYW5nZWQnLlxyXG4gKiBJdCB3aWxsIGxpc3RlbiBmb3IgZXZlbnRzIG9uIGl0cyBwYXJlbnQgZWxlbWVudCwgYW5kIHdpbGwgYmVnaW4gbGlzdGVuaW5nIG9yIGVuZCBsaXN0ZW5pbmcgd2hlbiBpbml0IG9yIHJlbW92ZSBpc1xyXG4gKiBjYWxsZWQuIEhvd2V2ZXIgdGhpcyBjYW4gYWxzbyBiZSBjb25maWd1cmVkIGJ5IHBhc3NpbmcgYSBjb25maWd1cmF0aW9uIG9iamVjdDpcclxuICpcclxuICogQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KFwiZm9vXCIsIHtcclxuICogICB3aGVuU2NlbmVMb2FkczogYmluZEV2ZW50KCB7XHJcbiAqICAgICBldmVudDogXCJsb2FkZWRcIiwgICAgLy8gRXZlbnQgdG8gbGlzdGVuIGZvci4gRGVmYXVsdHMgdG8gZnVuY3Rpb25zIHByb3BlcnkgbmFtZS5cclxuICogICAgIHRhcmdldDogXCJhLXNjZW5lXCIsICAvLyBTZWxlY3RvciBzdHJpbmcgZm9yIHdoaWNoIGVsZW1lbnQgdG8gbGlzdGVuIG9uLCBkZWZhdWx0cyB0byB0aGlzLmVsXHJcbiAqICAgICBsaXN0ZW5JbjogXCJpbml0XCIsICAgLy8gV2hpY2ggZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lciBpcyBjYWxsZWQgaW4sIGRlZmF1bHRzIHRvICdpbml0J1xyXG4gKiAgICAgcmVtb3ZlSW46IFwicmVtb3ZlXCIsIC8vIFdoaWNoIGZ1bmN0aW9uIHJlbW92ZUV2ZW50TGlzdGVuZXIgaXMgY2FsbGVkIGluLCBkZWZhdWx0cyB0byAncmVtb3ZlJ1xyXG4gKiAgIH0sIGZ1bmN0aW9uKGV2dCkge1xyXG4gKiAgICAgY29uc29sZS5sb2coZXZ0LmRldGFpbCk7XHJcbiAqICAgfSlcclxuICogfSlcclxuICpcclxuICogRnVuY3Rpb25zIHdpbGwgb25seSBiZSBib3VuZCB0byBldmVudHMgd2hlbiBhIG5ldyBjb21wb25lbnQgaXMgY3JlYXRlZC4gRGVjb3JhdGluZyBhIGZ1bmN0aW9uIHdpdGggYmluZEV2ZW50KClcclxuICogaW4gYSBjb21wb25lbnRzIGluaXQsIG9yIHRpY2sgZnVuY3Rpb25zIGZvciBleGFtcGxlIHdpbGwgaGF2ZSBubyBlZmZlY3QuXHJcbiAqXHJcbiAqIERvbid0IGJpbmQgdG8gYXJyb3cgZnVuY3Rpb25zIGJlY2F1c2UgdGhleSBkb24ndCBoYXZlIHRoZWlyIG93biB0aGlzLlxyXG4gKlxyXG4gKi9cclxuXHJcbmNvbnN0IGRlY29yYXRlID0gcmVxdWlyZSgnLi9jb21wb25lbnQtZGVjb3JhdG9ycycpLmRlY29yYXRlO1xyXG5cclxuLy8gSW1wbGVtZW50cyB0aGUgYXV0b21hdGljIGJpbmRpbmcgYW5kIHVuYmluZGluZyBvZiB0aGUgY2hvc2VuIGZ1bmN0aW9uLiBXcmFwcyBpdHMgbGlzdGVuSW4gYW5kIHJlbW92ZUluXHJcbi8vIGZ1bmN0aW9ucyB0byBhZGQgYW5kIHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXIgYXQgdGhlIGNvcnJlY3QgdGltZXMuXHJcbmZ1bmN0aW9uIEJpbmRUb0V2ZW50RGVjb3JhdG9yKF9ldmVudCwgX3RhcmdldCwgX2xpc3RlbkluLCBfcmVtb3ZlSW4pIHtcclxuICByZXR1cm4gZnVuY3Rpb24ocHJvcGVydHlOYW1lLCBmdW5jKSB7XHJcbiAgICBjb25zdCBzY29wZSA9IHRoaXM7XHJcbiAgICBjb25zdCBldmVudCA9IF9ldmVudCB8fCBwcm9wZXJ0eU5hbWU7XHJcbiAgICBjb25zdCB0YXJnZXQgPSAhX3RhcmdldCA/IHRoaXMuZWwgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKF90YXJnZXQpO1xyXG4gICAgaWYgKCF0YXJnZXQpIHtcclxuICAgICAgY29uc29sZS53YXJuKFwiQ291bGRuJ3Qgc3Vic2NyaWJlIFwiK3RoaXMubmFtZStcIi5cIitwcm9wZXJ0eU5hbWUrXCIgdG8gXCIrZXZlbnQrXCIgb24gXCIrX3RhcmdldFxyXG4gICAgICAgICtcIiBiZWNhdXNlIHF1ZXJ5U2VsZWN0b3IgcmV0dXJuZWQgdW5kZWZpbmVkLlwiKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbGlzdGVuSW4gPSBfbGlzdGVuSW4gfHwgXCJpbml0XCI7XHJcbiAgICBjb25zdCByZW1vdmVJbiA9IF9yZW1vdmVJbiB8fCBcInJlbW92ZVwiO1xyXG5cclxuICAgIGNvbnN0IGxpc3RlbkZ1bmMgPSB0aGlzW2xpc3RlbkluXTtcclxuICAgIGNvbnN0IHJlbW92ZUZ1bmMgPSB0aGlzW3JlbW92ZUluXTtcclxuICAgIGNvbnN0IGJvdW5kRnVuYyA9IGZ1bmMuYmluZCh0aGlzKTtcclxuICAgIFxyXG4gICAgdGhpc1tsaXN0ZW5Jbl0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKGxpc3RlbkZ1bmMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGxpc3RlbkZ1bmMuYXBwbHkoc2NvcGUsIGFyZ3VtZW50cyk7XHJcbiAgICAgIH1cclxuICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGJvdW5kRnVuYyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpc1tyZW1vdmVJbl0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHJlbW92ZUZ1bmMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJlbW92ZUZ1bmMuYXBwbHkoc2NvcGUsIGFyZ3VtZW50cyk7XHJcbiAgICAgIH1cclxuICAgICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGJvdW5kRnVuYyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZ1bmM7XHJcbiAgfVxyXG59XHJcblxyXG4vKlxyXG4gKiBEZWNvcmF0ZXMgYSBmdW5jdGlvbiB3aXRoIGNvbmZpZ3VyYXRpb25zIGZvciBhdXRvbWF0aWNhbGx5IGJpbmRpbmcgdG8gYW4gZXZlbnQuXHJcbiAqXHJcbiAqIEBwYXJhbSBwMSAtIElmIHRoaXMgaXMgYSBmdW5jdGlvbiBpdCB3aWxsIGJlIGRlY29yYXRlZCB3aXRoIGRlZmF1bHQgb3B0aW9ucyBhbmQgcDIgaXMgaWdub3JlZC4gT3RoZXJ3aXNlIHRoaXMgY2FuIGJlXHJcbiAqICAgYW4gb2JqZWN0IHdoaWNoIGZpbmUgdHVuZXMgdGhlIGJpbmRpbmcuXHJcbiAqIEBwYXJhbSBwMiAtIElmIHAxIGlzIGFuIG9iamVjdCB0aGVuIHRoaXMgd2lsbCBiZSB0aGUgZnVuY3Rpb24gdG8gYmluZCB0by5cclxuICpcclxuICogQHJldHVybnMge2Z1bmN0aW9ufSBEZWNvcmF0ZWQgZnVuY3Rpb24gd2hpY2ggd3JhcHMgdGhlIGlucHV0IGZ1bmN0aW9uLlxyXG4gKi9cclxuZnVuY3Rpb24gYmluZEV2ZW50KHAxLCBwMikge1xyXG4gIGlmICh0eXBlb2YgcDEgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgcmV0dXJuIGRlY29yYXRlKHAxLCBCaW5kVG9FdmVudERlY29yYXRvcigpKTtcclxuICB9IGVsc2UgaWYgKHR5cGVvZiBwMSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcDIgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgcmV0dXJuIGRlY29yYXRlKHAyLCBCaW5kVG9FdmVudERlY29yYXRvcihwMS5ldmVudCwgcDEudGFyZ2V0LCBwMS5saXN0ZW5JbiwgcDEucmVtb3ZlSW4pKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiYmluZEV2ZW50IG11c3QgdGFrZTogKGZ1bmN0aW9uKSwgb3IgYSAoW29iamVjdF0sIGZ1bmN0aW9uKVwiKVxyXG4gIH1cclxufVxyXG5cclxuLypcclxuICogQ29udmVuaWVuY2UgZnVuY3Rpb24sIHdpbGwgYWx3YXlzIGJpbmQvdW5iaW5kIGxpc3RlbmVyIGluIHBsYXkvcGF1c2UgZnVuY3Rpb24sIHJhdGhlciB0aGFuIHRoZSBkZWZhdWx0IGluaXQvcmVtb3ZlXHJcbiAqL1xyXG5mdW5jdGlvbiBiaW5kRXZlbnRQbGF5UGF1c2UgKHAxLCBwMikge1xyXG4gIGlmICh0eXBlb2YgcDEgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgcmV0dXJuIGRlY29yYXRlKHAxLCBCaW5kVG9FdmVudERlY29yYXRvcih1bmRlZmluZWQsIHVuZGVmaW5lZCwgXCJwbGF5XCIsIFwicGF1c2VcIikpO1xyXG4gIH0gZWxzZSBpZiAodHlwZW9mIHAxID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBwMiA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICByZXR1cm4gZGVjb3JhdGUocDIsIEJpbmRUb0V2ZW50RGVjb3JhdG9yKHAxLmV2ZW50LCBwMS50YXJnZXQsIFwicGxheVwiLCBcInBhdXNlXCIpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiYmluZEV2ZW50UGxheVBhdXNlIG11c3QgdGFrZTogKGZ1bmN0aW9uKSwgb3IgYSAoW29iamVjdF0sIGZ1bmN0aW9uKVwiKVxyXG4gIH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMuYmluZEV2ZW50ID0gYmluZEV2ZW50O1xyXG5tb2R1bGUuZXhwb3J0cy5iaW5kRXZlbnRQbGF5UGF1c2UgPSBiaW5kRXZlbnRQbGF5UGF1c2U7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzL2V2ZW50LWJpbmRlci5qc1xuLy8gbW9kdWxlIGlkID0gNDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tL1xuICovXG5cblRIUkVFLkJ1ZmZlckdlb21ldHJ5VXRpbHMgPSB7XG5cblx0Y29tcHV0ZVRhbmdlbnRzOiBmdW5jdGlvbiAoIGdlb21ldHJ5ICkge1xuXG5cdFx0dmFyIGluZGV4ID0gZ2VvbWV0cnkuaW5kZXg7XG5cdFx0dmFyIGF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzO1xuXG5cdFx0Ly8gYmFzZWQgb24gaHR0cDovL3d3dy50ZXJhdGhvbi5jb20vY29kZS90YW5nZW50Lmh0bWxcblx0XHQvLyAocGVyIHZlcnRleCB0YW5nZW50cylcblxuXHRcdGlmICggaW5kZXggPT09IG51bGwgfHxcblx0XHRcdCBhdHRyaWJ1dGVzLnBvc2l0aW9uID09PSB1bmRlZmluZWQgfHxcblx0XHRcdCBhdHRyaWJ1dGVzLm5vcm1hbCA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHQgYXR0cmlidXRlcy51diA9PT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5CdWZmZXJHZW9tZXRyeTogTWlzc2luZyByZXF1aXJlZCBhdHRyaWJ1dGVzIChpbmRleCwgcG9zaXRpb24sIG5vcm1hbCBvciB1dikgaW4gQnVmZmVyR2VvbWV0cnkuY29tcHV0ZVRhbmdlbnRzKCknICk7XG5cdFx0XHRyZXR1cm47XG5cblx0XHR9XG5cblx0XHR2YXIgaW5kaWNlcyA9IGluZGV4LmFycmF5O1xuXHRcdHZhciBwb3NpdGlvbnMgPSBhdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5O1xuXHRcdHZhciBub3JtYWxzID0gYXR0cmlidXRlcy5ub3JtYWwuYXJyYXk7XG5cdFx0dmFyIHV2cyA9IGF0dHJpYnV0ZXMudXYuYXJyYXk7XG5cblx0XHR2YXIgblZlcnRpY2VzID0gcG9zaXRpb25zLmxlbmd0aCAvIDM7XG5cblx0XHRpZiAoIGF0dHJpYnV0ZXMudGFuZ2VudCA9PT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICd0YW5nZW50JywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggbmV3IEZsb2F0MzJBcnJheSggNCAqIG5WZXJ0aWNlcyApLCA0ICkgKTtcblxuXHRcdH1cblxuXHRcdHZhciB0YW5nZW50cyA9IGF0dHJpYnV0ZXMudGFuZ2VudC5hcnJheTtcblxuXHRcdHZhciB0YW4xID0gW10sIHRhbjIgPSBbXTtcblxuXHRcdGZvciAoIHZhciBpID0gMDsgaSA8IG5WZXJ0aWNlczsgaSArKyApIHtcblxuXHRcdFx0dGFuMVsgaSBdID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblx0XHRcdHRhbjJbIGkgXSA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHR9XG5cblx0XHR2YXIgdkEgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRcdFx0dkIgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRcdFx0dkMgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXG5cdFx0XHR1dkEgPSBuZXcgVEhSRUUuVmVjdG9yMigpLFxuXHRcdFx0dXZCID0gbmV3IFRIUkVFLlZlY3RvcjIoKSxcblx0XHRcdHV2QyA9IG5ldyBUSFJFRS5WZWN0b3IyKCksXG5cblx0XHRcdHNkaXIgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRcdFx0dGRpciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHRmdW5jdGlvbiBoYW5kbGVUcmlhbmdsZSggYSwgYiwgYyApIHtcblxuXHRcdFx0dkEuZnJvbUFycmF5KCBwb3NpdGlvbnMsIGEgKiAzICk7XG5cdFx0XHR2Qi5mcm9tQXJyYXkoIHBvc2l0aW9ucywgYiAqIDMgKTtcblx0XHRcdHZDLmZyb21BcnJheSggcG9zaXRpb25zLCBjICogMyApO1xuXG5cdFx0XHR1dkEuZnJvbUFycmF5KCB1dnMsIGEgKiAyICk7XG5cdFx0XHR1dkIuZnJvbUFycmF5KCB1dnMsIGIgKiAyICk7XG5cdFx0XHR1dkMuZnJvbUFycmF5KCB1dnMsIGMgKiAyICk7XG5cblx0XHRcdHZhciB4MSA9IHZCLnggLSB2QS54O1xuXHRcdFx0dmFyIHgyID0gdkMueCAtIHZBLng7XG5cblx0XHRcdHZhciB5MSA9IHZCLnkgLSB2QS55O1xuXHRcdFx0dmFyIHkyID0gdkMueSAtIHZBLnk7XG5cblx0XHRcdHZhciB6MSA9IHZCLnogLSB2QS56O1xuXHRcdFx0dmFyIHoyID0gdkMueiAtIHZBLno7XG5cblx0XHRcdHZhciBzMSA9IHV2Qi54IC0gdXZBLng7XG5cdFx0XHR2YXIgczIgPSB1dkMueCAtIHV2QS54O1xuXG5cdFx0XHR2YXIgdDEgPSB1dkIueSAtIHV2QS55O1xuXHRcdFx0dmFyIHQyID0gdXZDLnkgLSB1dkEueTtcblxuXHRcdFx0dmFyIHIgPSAxLjAgLyAoIHMxICogdDIgLSBzMiAqIHQxICk7XG5cblx0XHRcdHNkaXIuc2V0KFxuXHRcdFx0XHQoIHQyICogeDEgLSB0MSAqIHgyICkgKiByLFxuXHRcdFx0XHQoIHQyICogeTEgLSB0MSAqIHkyICkgKiByLFxuXHRcdFx0XHQoIHQyICogejEgLSB0MSAqIHoyICkgKiByXG5cdFx0XHQpO1xuXG5cdFx0XHR0ZGlyLnNldChcblx0XHRcdFx0KCBzMSAqIHgyIC0gczIgKiB4MSApICogcixcblx0XHRcdFx0KCBzMSAqIHkyIC0gczIgKiB5MSApICogcixcblx0XHRcdFx0KCBzMSAqIHoyIC0gczIgKiB6MSApICogclxuXHRcdFx0KTtcblxuXHRcdFx0dGFuMVsgYSBdLmFkZCggc2RpciApO1xuXHRcdFx0dGFuMVsgYiBdLmFkZCggc2RpciApO1xuXHRcdFx0dGFuMVsgYyBdLmFkZCggc2RpciApO1xuXG5cdFx0XHR0YW4yWyBhIF0uYWRkKCB0ZGlyICk7XG5cdFx0XHR0YW4yWyBiIF0uYWRkKCB0ZGlyICk7XG5cdFx0XHR0YW4yWyBjIF0uYWRkKCB0ZGlyICk7XG5cblx0XHR9XG5cblx0XHR2YXIgZ3JvdXBzID0gZ2VvbWV0cnkuZ3JvdXBzO1xuXG5cdFx0aWYgKCBncm91cHMubGVuZ3RoID09PSAwICkge1xuXG5cdFx0XHRncm91cHMgPSBbIHtcblx0XHRcdFx0c3RhcnQ6IDAsXG5cdFx0XHRcdGNvdW50OiBpbmRpY2VzLmxlbmd0aFxuXHRcdFx0fSBdO1xuXG5cdFx0fVxuXG5cdFx0Zm9yICggdmFyIGkgPSAwLCBpbCA9IGdyb3Vwcy5sZW5ndGg7IGkgPCBpbDsgKysgaSApIHtcblxuXHRcdFx0dmFyIGdyb3VwID0gZ3JvdXBzWyBpIF07XG5cblx0XHRcdHZhciBzdGFydCA9IGdyb3VwLnN0YXJ0O1xuXHRcdFx0dmFyIGNvdW50ID0gZ3JvdXAuY291bnQ7XG5cblx0XHRcdGZvciAoIHZhciBqID0gc3RhcnQsIGpsID0gc3RhcnQgKyBjb3VudDsgaiA8IGpsOyBqICs9IDMgKSB7XG5cblx0XHRcdFx0aGFuZGxlVHJpYW5nbGUoXG5cdFx0XHRcdFx0aW5kaWNlc1sgaiArIDAgXSxcblx0XHRcdFx0XHRpbmRpY2VzWyBqICsgMSBdLFxuXHRcdFx0XHRcdGluZGljZXNbIGogKyAyIF1cblx0XHRcdFx0KTtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0dmFyIHRtcCA9IG5ldyBUSFJFRS5WZWN0b3IzKCksIHRtcDIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHRcdHZhciBuID0gbmV3IFRIUkVFLlZlY3RvcjMoKSwgbjIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHRcdHZhciB3LCB0LCB0ZXN0O1xuXG5cdFx0ZnVuY3Rpb24gaGFuZGxlVmVydGV4KCB2ICkge1xuXG5cdFx0XHRuLmZyb21BcnJheSggbm9ybWFscywgdiAqIDMgKTtcblx0XHRcdG4yLmNvcHkoIG4gKTtcblxuXHRcdFx0dCA9IHRhbjFbIHYgXTtcblxuXHRcdFx0Ly8gR3JhbS1TY2htaWR0IG9ydGhvZ29uYWxpemVcblxuXHRcdFx0dG1wLmNvcHkoIHQgKTtcblx0XHRcdHRtcC5zdWIoIG4ubXVsdGlwbHlTY2FsYXIoIG4uZG90KCB0ICkgKSApLm5vcm1hbGl6ZSgpO1xuXG5cdFx0XHQvLyBDYWxjdWxhdGUgaGFuZGVkbmVzc1xuXG5cdFx0XHR0bXAyLmNyb3NzVmVjdG9ycyggbjIsIHQgKTtcblx0XHRcdHRlc3QgPSB0bXAyLmRvdCggdGFuMlsgdiBdICk7XG5cdFx0XHR3ID0gKCB0ZXN0IDwgMC4wICkgPyAtIDEuMCA6IDEuMDtcblxuXHRcdFx0dGFuZ2VudHNbIHYgKiA0IF0gPSB0bXAueDtcblx0XHRcdHRhbmdlbnRzWyB2ICogNCArIDEgXSA9IHRtcC55O1xuXHRcdFx0dGFuZ2VudHNbIHYgKiA0ICsgMiBdID0gdG1wLno7XG5cdFx0XHR0YW5nZW50c1sgdiAqIDQgKyAzIF0gPSB3O1xuXG5cdFx0fVxuXG5cdFx0Zm9yICggdmFyIGkgPSAwLCBpbCA9IGdyb3Vwcy5sZW5ndGg7IGkgPCBpbDsgKysgaSApIHtcblxuXHRcdFx0dmFyIGdyb3VwID0gZ3JvdXBzWyBpIF07XG5cblx0XHRcdHZhciBzdGFydCA9IGdyb3VwLnN0YXJ0O1xuXHRcdFx0dmFyIGNvdW50ID0gZ3JvdXAuY291bnQ7XG5cblx0XHRcdGZvciAoIHZhciBqID0gc3RhcnQsIGpsID0gc3RhcnQgKyBjb3VudDsgaiA8IGpsOyBqICs9IDMgKSB7XG5cblx0XHRcdFx0aGFuZGxlVmVydGV4KCBpbmRpY2VzWyBqICsgMCBdICk7XG5cdFx0XHRcdGhhbmRsZVZlcnRleCggaW5kaWNlc1sgaiArIDEgXSApO1xuXHRcdFx0XHRoYW5kbGVWZXJ0ZXgoIGluZGljZXNbIGogKyAyIF0gKTtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdH0sXG5cblx0LyoqXG5cdCAqIEBwYXJhbSAge0FycmF5PFRIUkVFLkJ1ZmZlckdlb21ldHJ5Pn0gZ2VvbWV0cmllc1xuXHQgKiBAcmV0dXJuIHtUSFJFRS5CdWZmZXJHZW9tZXRyeX1cblx0ICovXG5cdG1lcmdlQnVmZmVyR2VvbWV0cmllczogZnVuY3Rpb24gKCBnZW9tZXRyaWVzLCB1c2VHcm91cHMgKSB7XG5cblx0XHR2YXIgaXNJbmRleGVkID0gZ2VvbWV0cmllc1sgMCBdLmluZGV4ICE9PSBudWxsO1xuXG5cdFx0dmFyIGF0dHJpYnV0ZXNVc2VkID0gbmV3IFNldCggT2JqZWN0LmtleXMoIGdlb21ldHJpZXNbIDAgXS5hdHRyaWJ1dGVzICkgKTtcblx0XHR2YXIgbW9ycGhBdHRyaWJ1dGVzVXNlZCA9IG5ldyBTZXQoIE9iamVjdC5rZXlzKCBnZW9tZXRyaWVzWyAwIF0ubW9ycGhBdHRyaWJ1dGVzICkgKTtcblxuXHRcdHZhciBhdHRyaWJ1dGVzID0ge307XG5cdFx0dmFyIG1vcnBoQXR0cmlidXRlcyA9IHt9O1xuXG5cdFx0dmFyIG1lcmdlZEdlb21ldHJ5ID0gbmV3IFRIUkVFLkJ1ZmZlckdlb21ldHJ5KCk7XG5cblx0XHR2YXIgb2Zmc2V0ID0gMDtcblxuXHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGdlb21ldHJpZXMubGVuZ3RoOyArKyBpICkge1xuXG5cdFx0XHR2YXIgZ2VvbWV0cnkgPSBnZW9tZXRyaWVzWyBpIF07XG5cblx0XHRcdC8vIGVuc3VyZSB0aGF0IGFsbCBnZW9tZXRyaWVzIGFyZSBpbmRleGVkLCBvciBub25lXG5cblx0XHRcdGlmICggaXNJbmRleGVkICE9PSAoIGdlb21ldHJ5LmluZGV4ICE9PSBudWxsICkgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0Ly8gZ2F0aGVyIGF0dHJpYnV0ZXMsIGV4aXQgZWFybHkgaWYgdGhleSdyZSBkaWZmZXJlbnRcblxuXHRcdFx0Zm9yICggdmFyIG5hbWUgaW4gZ2VvbWV0cnkuYXR0cmlidXRlcyApIHtcblxuXHRcdFx0XHRpZiAoICEgYXR0cmlidXRlc1VzZWQuaGFzKCBuYW1lICkgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0XHRpZiAoIGF0dHJpYnV0ZXNbIG5hbWUgXSA9PT0gdW5kZWZpbmVkICkgYXR0cmlidXRlc1sgbmFtZSBdID0gW107XG5cblx0XHRcdFx0YXR0cmlidXRlc1sgbmFtZSBdLnB1c2goIGdlb21ldHJ5LmF0dHJpYnV0ZXNbIG5hbWUgXSApO1xuXG5cdFx0XHR9XG5cblx0XHRcdC8vIGdhdGhlciBtb3JwaCBhdHRyaWJ1dGVzLCBleGl0IGVhcmx5IGlmIHRoZXkncmUgZGlmZmVyZW50XG5cblx0XHRcdGZvciAoIHZhciBuYW1lIGluIGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcyApIHtcblxuXHRcdFx0XHRpZiAoICEgbW9ycGhBdHRyaWJ1dGVzVXNlZC5oYXMoIG5hbWUgKSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRcdGlmICggbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0gPT09IHVuZGVmaW5lZCApIG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdID0gW107XG5cblx0XHRcdFx0bW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0ucHVzaCggZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBnYXRoZXIgLnVzZXJEYXRhXG5cbiAgICAgIGlmIChtZXJnZWRHZW9tZXRyeS51c2VyRGF0YSkge1xuXG4gICAgICAgIG1lcmdlZEdlb21ldHJ5LnVzZXJEYXRhLm1lcmdlZFVzZXJEYXRhID0gbWVyZ2VkR2VvbWV0cnkudXNlckRhdGEubWVyZ2VkVXNlckRhdGEgfHwgW107XG4gICAgICAgIG1lcmdlZEdlb21ldHJ5LnVzZXJEYXRhLm1lcmdlZFVzZXJEYXRhLnB1c2goIGdlb21ldHJ5LnVzZXJEYXRhICk7XG5cbiAgICAgIH1cblxuXHRcdFx0aWYgKCB1c2VHcm91cHMgKSB7XG5cblx0XHRcdFx0dmFyIGNvdW50O1xuXG5cdFx0XHRcdGlmICggaXNJbmRleGVkICkge1xuXG5cdFx0XHRcdFx0Y291bnQgPSBnZW9tZXRyeS5pbmRleC5jb3VudDtcblxuXHRcdFx0XHR9IGVsc2UgaWYgKCBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uICE9PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdFx0XHRjb3VudCA9IGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uY291bnQ7XG5cblx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRtZXJnZWRHZW9tZXRyeS5hZGRHcm91cCggb2Zmc2V0LCBjb3VudCwgaSApO1xuXG5cdFx0XHRcdG9mZnNldCArPSBjb3VudDtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0Ly8gbWVyZ2UgaW5kaWNlc1xuXG5cdFx0aWYgKCBpc0luZGV4ZWQgKSB7XG5cblx0XHRcdHZhciBpbmRleE9mZnNldCA9IDA7XG5cdFx0XHR2YXIgbWVyZ2VkSW5kZXggPSBbXTtcblxuXHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgZ2VvbWV0cmllcy5sZW5ndGg7ICsrIGkgKSB7XG5cblx0XHRcdFx0dmFyIGluZGV4ID0gZ2VvbWV0cmllc1sgaSBdLmluZGV4O1xuXG5cdFx0XHRcdGZvciAoIHZhciBqID0gMDsgaiA8IGluZGV4LmNvdW50OyArKyBqICkge1xuXG5cdFx0XHRcdFx0bWVyZ2VkSW5kZXgucHVzaCggaW5kZXguZ2V0WCggaiApICsgaW5kZXhPZmZzZXQgKTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aW5kZXhPZmZzZXQgKz0gZ2VvbWV0cmllc1sgaSBdLmF0dHJpYnV0ZXMucG9zaXRpb24uY291bnQ7XG5cblx0XHRcdH1cblxuXHRcdFx0bWVyZ2VkR2VvbWV0cnkuc2V0SW5kZXgoIG1lcmdlZEluZGV4ICk7XG5cblx0XHR9XG5cblx0XHQvLyBtZXJnZSBhdHRyaWJ1dGVzXG5cblx0XHRmb3IgKCB2YXIgbmFtZSBpbiBhdHRyaWJ1dGVzICkge1xuXG5cdFx0XHR2YXIgbWVyZ2VkQXR0cmlidXRlID0gdGhpcy5tZXJnZUJ1ZmZlckF0dHJpYnV0ZXMoIGF0dHJpYnV0ZXNbIG5hbWUgXSApO1xuXG5cdFx0XHRpZiAoICEgbWVyZ2VkQXR0cmlidXRlICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdG1lcmdlZEdlb21ldHJ5LmFkZEF0dHJpYnV0ZSggbmFtZSwgbWVyZ2VkQXR0cmlidXRlICk7XG5cblx0XHR9XG5cblx0XHQvLyBtZXJnZSBtb3JwaCBhdHRyaWJ1dGVzXG5cblx0XHRmb3IgKCB2YXIgbmFtZSBpbiBtb3JwaEF0dHJpYnV0ZXMgKSB7XG5cblx0XHRcdHZhciBudW1Nb3JwaFRhcmdldHMgPSBtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXVsgMCBdLmxlbmd0aDtcblxuXHRcdFx0aWYgKCBudW1Nb3JwaFRhcmdldHMgPT09IDAgKSBicmVhaztcblxuXHRcdFx0bWVyZ2VkR2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzID0gbWVyZ2VkR2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzIHx8IHt9O1xuXHRcdFx0bWVyZ2VkR2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0gPSBbXTtcblxuXHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgbnVtTW9ycGhUYXJnZXRzOyArKyBpICkge1xuXG5cdFx0XHRcdHZhciBtb3JwaEF0dHJpYnV0ZXNUb01lcmdlID0gW107XG5cblx0XHRcdFx0Zm9yICggdmFyIGogPSAwOyBqIDwgbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0ubGVuZ3RoOyArKyBqICkge1xuXG5cdFx0XHRcdFx0bW9ycGhBdHRyaWJ1dGVzVG9NZXJnZS5wdXNoKCBtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXVsgaiBdWyBpIF0gKTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIG1lcmdlZE1vcnBoQXR0cmlidXRlID0gdGhpcy5tZXJnZUJ1ZmZlckF0dHJpYnV0ZXMoIG1vcnBoQXR0cmlidXRlc1RvTWVyZ2UgKTtcblxuXHRcdFx0XHRpZiAoICEgbWVyZ2VkTW9ycGhBdHRyaWJ1dGUgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0XHRtZXJnZWRHZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXS5wdXNoKCBtZXJnZWRNb3JwaEF0dHJpYnV0ZSApO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gbWVyZ2VkR2VvbWV0cnk7XG5cblx0fSxcblxuXHQvKipcblx0ICogQHBhcmFtIHtBcnJheTxUSFJFRS5CdWZmZXJBdHRyaWJ1dGU+fSBhdHRyaWJ1dGVzXG5cdCAqIEByZXR1cm4ge1RIUkVFLkJ1ZmZlckF0dHJpYnV0ZX1cblx0ICovXG5cdG1lcmdlQnVmZmVyQXR0cmlidXRlczogZnVuY3Rpb24gKCBhdHRyaWJ1dGVzICkge1xuXG5cdFx0dmFyIFR5cGVkQXJyYXk7XG5cdFx0dmFyIGl0ZW1TaXplO1xuXHRcdHZhciBub3JtYWxpemVkO1xuXHRcdHZhciBhcnJheUxlbmd0aCA9IDA7XG5cblx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgKysgaSApIHtcblxuXHRcdFx0dmFyIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXNbIGkgXTtcblxuXHRcdFx0aWYgKCBhdHRyaWJ1dGUuaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRpZiAoIFR5cGVkQXJyYXkgPT09IHVuZGVmaW5lZCApIFR5cGVkQXJyYXkgPSBhdHRyaWJ1dGUuYXJyYXkuY29uc3RydWN0b3I7XG5cdFx0XHRpZiAoIFR5cGVkQXJyYXkgIT09IGF0dHJpYnV0ZS5hcnJheS5jb25zdHJ1Y3RvciApIHJldHVybiBudWxsO1xuXG5cdFx0XHRpZiAoIGl0ZW1TaXplID09PSB1bmRlZmluZWQgKSBpdGVtU2l6ZSA9IGF0dHJpYnV0ZS5pdGVtU2l6ZTtcblx0XHRcdGlmICggaXRlbVNpemUgIT09IGF0dHJpYnV0ZS5pdGVtU2l6ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRpZiAoIG5vcm1hbGl6ZWQgPT09IHVuZGVmaW5lZCApIG5vcm1hbGl6ZWQgPSBhdHRyaWJ1dGUubm9ybWFsaXplZDtcblx0XHRcdGlmICggbm9ybWFsaXplZCAhPT0gYXR0cmlidXRlLm5vcm1hbGl6ZWQgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0YXJyYXlMZW5ndGggKz0gYXR0cmlidXRlLmFycmF5Lmxlbmd0aDtcblxuXHRcdH1cblxuXHRcdHZhciBhcnJheSA9IG5ldyBUeXBlZEFycmF5KCBhcnJheUxlbmd0aCApO1xuXHRcdHZhciBvZmZzZXQgPSAwO1xuXG5cdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgYXR0cmlidXRlcy5sZW5ndGg7ICsrIGkgKSB7XG5cblx0XHRcdGFycmF5LnNldCggYXR0cmlidXRlc1sgaSBdLmFycmF5LCBvZmZzZXQgKTtcblxuXHRcdFx0b2Zmc2V0ICs9IGF0dHJpYnV0ZXNbIGkgXS5hcnJheS5sZW5ndGg7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggYXJyYXksIGl0ZW1TaXplLCBub3JtYWxpemVkICk7XG5cblx0fVxuXG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1nZW9tZXRyeS1tZXJnZXItY29tcG9uZW50L2xpYi9CdWZmZXJHZW9tZXRyeVV0aWxzLmpzXG4vLyBtb2R1bGUgaWQgPSA0MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIEBhdXRob3IgcWlhbyAvIGh0dHBzOi8vZ2l0aHViLmNvbS9xaWFvXG4gKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tXG4gKiBAYXV0aG9yIGFsdGVyZWRxIC8gaHR0cDovL2FsdGVyZWRxdWFsaWEuY29tL1xuICogQGF1dGhvciBXZXN0TGFuZ2xleSAvIGh0dHA6Ly9naXRodWIuY29tL1dlc3RMYW5nbGV5XG4gKiBAYXV0aG9yIGVyaWNoNjY2IC8gaHR0cDovL2VyaWNoYWluZXMuY29tXG4gKi9cblxuLy8gVGhpcyBzZXQgb2YgY29udHJvbHMgcGVyZm9ybXMgb3JiaXRpbmcsIGRvbGx5aW5nICh6b29taW5nKSwgYW5kIHBhbm5pbmcuXG4vLyBVbmxpa2UgVHJhY2tiYWxsQ29udHJvbHMsIGl0IG1haW50YWlucyB0aGUgXCJ1cFwiIGRpcmVjdGlvbiBvYmplY3QudXAgKCtZIGJ5IGRlZmF1bHQpLlxuLy9cbi8vICAgIE9yYml0IC0gbGVmdCBtb3VzZSAvIHRvdWNoOiBvbmUgZmluZ2VyIG1vdmVcbi8vICAgIFpvb20gLSBtaWRkbGUgbW91c2UsIG9yIG1vdXNld2hlZWwgLyB0b3VjaDogdHdvIGZpbmdlciBzcHJlYWQgb3Igc3F1aXNoXG4vLyAgICBQYW4gLSByaWdodCBtb3VzZSwgb3IgYXJyb3cga2V5cyAvIHRvdWNoOiB0aHJlZSBmaW5nZXIgc3dpcGVcblxuVEhSRUUuT3JiaXRDb250cm9scyA9IGZ1bmN0aW9uICggb2JqZWN0LCBkb21FbGVtZW50ICkge1xuXG5cdHRoaXMub2JqZWN0ID0gb2JqZWN0O1xuXG5cdHRoaXMuZG9tRWxlbWVudCA9ICggZG9tRWxlbWVudCAhPT0gdW5kZWZpbmVkICkgPyBkb21FbGVtZW50IDogZG9jdW1lbnQ7XG5cblx0Ly8gU2V0IHRvIGZhbHNlIHRvIGRpc2FibGUgdGhpcyBjb250cm9sXG5cdHRoaXMuZW5hYmxlZCA9IHRydWU7XG5cblx0Ly8gXCJ0YXJnZXRcIiBzZXRzIHRoZSBsb2NhdGlvbiBvZiBmb2N1cywgd2hlcmUgdGhlIG9iamVjdCBvcmJpdHMgYXJvdW5kXG5cdHRoaXMudGFyZ2V0ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuXHQvLyBIb3cgZmFyIHlvdSBjYW4gZG9sbHkgaW4gYW5kIG91dCAoIFBlcnNwZWN0aXZlQ2FtZXJhIG9ubHkgKVxuXHR0aGlzLm1pbkRpc3RhbmNlID0gMDtcblx0dGhpcy5tYXhEaXN0YW5jZSA9IEluZmluaXR5O1xuXG5cdC8vIEhvdyBmYXIgeW91IGNhbiB6b29tIGluIGFuZCBvdXQgKCBPcnRob2dyYXBoaWNDYW1lcmEgb25seSApXG5cdHRoaXMubWluWm9vbSA9IDA7XG5cdHRoaXMubWF4Wm9vbSA9IEluZmluaXR5O1xuXG5cdC8vIEhvdyBmYXIgeW91IGNhbiBvcmJpdCB2ZXJ0aWNhbGx5LCB1cHBlciBhbmQgbG93ZXIgbGltaXRzLlxuXHQvLyBSYW5nZSBpcyAwIHRvIE1hdGguUEkgcmFkaWFucy5cblx0dGhpcy5taW5Qb2xhckFuZ2xlID0gMDsgLy8gcmFkaWFuc1xuXHR0aGlzLm1heFBvbGFyQW5nbGUgPSBNYXRoLlBJOyAvLyByYWRpYW5zXG5cblx0Ly8gSG93IGZhciB5b3UgY2FuIG9yYml0IGhvcml6b250YWxseSwgdXBwZXIgYW5kIGxvd2VyIGxpbWl0cy5cblx0Ly8gSWYgc2V0LCBtdXN0IGJlIGEgc3ViLWludGVydmFsIG9mIHRoZSBpbnRlcnZhbCBbIC0gTWF0aC5QSSwgTWF0aC5QSSBdLlxuXHR0aGlzLm1pbkF6aW11dGhBbmdsZSA9IC0gSW5maW5pdHk7IC8vIHJhZGlhbnNcblx0dGhpcy5tYXhBemltdXRoQW5nbGUgPSBJbmZpbml0eTsgLy8gcmFkaWFuc1xuXG5cdC8vIFNldCB0byB0cnVlIHRvIGVuYWJsZSBkYW1waW5nIChpbmVydGlhKVxuXHQvLyBJZiBkYW1waW5nIGlzIGVuYWJsZWQsIHlvdSBtdXN0IGNhbGwgY29udHJvbHMudXBkYXRlKCkgaW4geW91ciBhbmltYXRpb24gbG9vcFxuXHR0aGlzLmVuYWJsZURhbXBpbmcgPSBmYWxzZTtcblx0dGhpcy5kYW1waW5nRmFjdG9yID0gMC4yNTtcblxuXHQvLyBUaGlzIG9wdGlvbiBhY3R1YWxseSBlbmFibGVzIGRvbGx5aW5nIGluIGFuZCBvdXQ7IGxlZnQgYXMgXCJ6b29tXCIgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LlxuXHQvLyBTZXQgdG8gZmFsc2UgdG8gZGlzYWJsZSB6b29taW5nXG5cdHRoaXMuZW5hYmxlWm9vbSA9IHRydWU7XG5cdHRoaXMuem9vbVNwZWVkID0gMS4wO1xuXG5cdC8vIFNldCB0byBmYWxzZSB0byBkaXNhYmxlIHJvdGF0aW5nXG5cdHRoaXMuZW5hYmxlUm90YXRlID0gdHJ1ZTtcblx0dGhpcy5yb3RhdGVTcGVlZCA9IDEuMDtcblxuXHQvLyBTZXQgdG8gZmFsc2UgdG8gZGlzYWJsZSBwYW5uaW5nXG5cdHRoaXMuZW5hYmxlUGFuID0gdHJ1ZTtcblx0dGhpcy5rZXlQYW5TcGVlZCA9IDcuMDtcdC8vIHBpeGVscyBtb3ZlZCBwZXIgYXJyb3cga2V5IHB1c2hcblxuXHQvLyBTZXQgdG8gdHJ1ZSB0byBhdXRvbWF0aWNhbGx5IHJvdGF0ZSBhcm91bmQgdGhlIHRhcmdldFxuXHQvLyBJZiBhdXRvLXJvdGF0ZSBpcyBlbmFibGVkLCB5b3UgbXVzdCBjYWxsIGNvbnRyb2xzLnVwZGF0ZSgpIGluIHlvdXIgYW5pbWF0aW9uIGxvb3Bcblx0dGhpcy5hdXRvUm90YXRlID0gZmFsc2U7XG5cdHRoaXMuYXV0b1JvdGF0ZVNwZWVkID0gMi4wOyAvLyAzMCBzZWNvbmRzIHBlciByb3VuZCB3aGVuIGZwcyBpcyA2MFxuXG5cdC8vIFNldCB0byBmYWxzZSB0byBkaXNhYmxlIHVzZSBvZiB0aGUga2V5c1xuXHR0aGlzLmVuYWJsZUtleXMgPSB0cnVlO1xuXG5cdC8vIFRoZSBmb3VyIGFycm93IGtleXNcblx0dGhpcy5rZXlzID0geyBMRUZUOiAzNywgVVA6IDM4LCBSSUdIVDogMzksIEJPVFRPTTogNDAgfTtcblxuXHQvLyBNb3VzZSBidXR0b25zXG5cdHRoaXMubW91c2VCdXR0b25zID0geyBPUkJJVDogVEhSRUUuTU9VU0UuTEVGVCwgWk9PTTogVEhSRUUuTU9VU0UuTUlERExFLCBQQU46IFRIUkVFLk1PVVNFLlJJR0hUIH07XG5cblx0Ly8gZm9yIHJlc2V0XG5cdHRoaXMudGFyZ2V0MCA9IHRoaXMudGFyZ2V0LmNsb25lKCk7XG5cdHRoaXMucG9zaXRpb24wID0gdGhpcy5vYmplY3QucG9zaXRpb24uY2xvbmUoKTtcblx0dGhpcy56b29tMCA9IHRoaXMub2JqZWN0Lnpvb207XG5cblx0Ly9cblx0Ly8gcHVibGljIG1ldGhvZHNcblx0Ly9cblxuXHR0aGlzLmdldFBvbGFyQW5nbGUgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRyZXR1cm4gc3BoZXJpY2FsLnBoaTtcblxuXHR9O1xuXG5cdHRoaXMuZ2V0QXppbXV0aGFsQW5nbGUgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRyZXR1cm4gc3BoZXJpY2FsLnRoZXRhO1xuXG5cdH07XG5cblx0dGhpcy5zYXZlU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRzY29wZS50YXJnZXQwLmNvcHkoIHNjb3BlLnRhcmdldCApO1xuXHRcdHNjb3BlLnBvc2l0aW9uMC5jb3B5KCBzY29wZS5vYmplY3QucG9zaXRpb24gKTtcblx0XHRzY29wZS56b29tMCA9IHNjb3BlLm9iamVjdC56b29tO1xuXG5cdH07XG5cblx0dGhpcy5yZXNldCA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHNjb3BlLnRhcmdldC5jb3B5KCBzY29wZS50YXJnZXQwICk7XG5cdFx0c2NvcGUub2JqZWN0LnBvc2l0aW9uLmNvcHkoIHNjb3BlLnBvc2l0aW9uMCApO1xuXHRcdHNjb3BlLm9iamVjdC56b29tID0gc2NvcGUuem9vbTA7XG5cblx0XHRzY29wZS5vYmplY3QudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xuXHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIGNoYW5nZUV2ZW50ICk7XG5cblx0XHRzY29wZS51cGRhdGUoKTtcblxuXHRcdHN0YXRlID0gU1RBVEUuTk9ORTtcblxuXHR9O1xuXG5cdC8vIHRoaXMgbWV0aG9kIGlzIGV4cG9zZWQsIGJ1dCBwZXJoYXBzIGl0IHdvdWxkIGJlIGJldHRlciBpZiB3ZSBjYW4gbWFrZSBpdCBwcml2YXRlLi4uXG5cdHRoaXMudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0dmFyIG9mZnNldCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHQvLyBzbyBjYW1lcmEudXAgaXMgdGhlIG9yYml0IGF4aXNcblx0XHR2YXIgcXVhdCA9IG5ldyBUSFJFRS5RdWF0ZXJuaW9uKCkuc2V0RnJvbVVuaXRWZWN0b3JzKCBvYmplY3QudXAsIG5ldyBUSFJFRS5WZWN0b3IzKCAwLCAxLCAwICkgKTtcblx0XHR2YXIgcXVhdEludmVyc2UgPSBxdWF0LmNsb25lKCkuaW52ZXJzZSgpO1xuXG5cdFx0dmFyIGxhc3RQb3NpdGlvbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cdFx0dmFyIGxhc3RRdWF0ZXJuaW9uID0gbmV3IFRIUkVFLlF1YXRlcm5pb24oKTtcblxuXHRcdHJldHVybiBmdW5jdGlvbiB1cGRhdGUoKSB7XG5cblx0XHRcdHZhciBwb3NpdGlvbiA9IHNjb3BlLm9iamVjdC5wb3NpdGlvbjtcblxuXHRcdFx0b2Zmc2V0LmNvcHkoIHBvc2l0aW9uICkuc3ViKCBzY29wZS50YXJnZXQgKTtcblxuXHRcdFx0Ly8gcm90YXRlIG9mZnNldCB0byBcInktYXhpcy1pcy11cFwiIHNwYWNlXG5cdFx0XHRvZmZzZXQuYXBwbHlRdWF0ZXJuaW9uKCBxdWF0ICk7XG5cblx0XHRcdC8vIGFuZ2xlIGZyb20gei1heGlzIGFyb3VuZCB5LWF4aXNcblx0XHRcdHNwaGVyaWNhbC5zZXRGcm9tVmVjdG9yMyggb2Zmc2V0ICk7XG5cblx0XHRcdGlmICggc2NvcGUuYXV0b1JvdGF0ZSAmJiBzdGF0ZSA9PT0gU1RBVEUuTk9ORSApIHtcblxuXHRcdFx0XHRyb3RhdGVMZWZ0KCBnZXRBdXRvUm90YXRpb25BbmdsZSgpICk7XG5cblx0XHRcdH1cblxuXHRcdFx0c3BoZXJpY2FsLnRoZXRhICs9IHNwaGVyaWNhbERlbHRhLnRoZXRhO1xuXHRcdFx0c3BoZXJpY2FsLnBoaSArPSBzcGhlcmljYWxEZWx0YS5waGk7XG5cblx0XHRcdC8vIHJlc3RyaWN0IHRoZXRhIHRvIGJlIGJldHdlZW4gZGVzaXJlZCBsaW1pdHNcblx0XHRcdHNwaGVyaWNhbC50aGV0YSA9IE1hdGgubWF4KCBzY29wZS5taW5BemltdXRoQW5nbGUsIE1hdGgubWluKCBzY29wZS5tYXhBemltdXRoQW5nbGUsIHNwaGVyaWNhbC50aGV0YSApICk7XG5cblx0XHRcdC8vIHJlc3RyaWN0IHBoaSB0byBiZSBiZXR3ZWVuIGRlc2lyZWQgbGltaXRzXG5cdFx0XHRzcGhlcmljYWwucGhpID0gTWF0aC5tYXgoIHNjb3BlLm1pblBvbGFyQW5nbGUsIE1hdGgubWluKCBzY29wZS5tYXhQb2xhckFuZ2xlLCBzcGhlcmljYWwucGhpICkgKTtcblxuXHRcdFx0c3BoZXJpY2FsLm1ha2VTYWZlKCk7XG5cblxuXHRcdFx0c3BoZXJpY2FsLnJhZGl1cyAqPSBzY2FsZTtcblxuXHRcdFx0Ly8gcmVzdHJpY3QgcmFkaXVzIHRvIGJlIGJldHdlZW4gZGVzaXJlZCBsaW1pdHNcblx0XHRcdHNwaGVyaWNhbC5yYWRpdXMgPSBNYXRoLm1heCggc2NvcGUubWluRGlzdGFuY2UsIE1hdGgubWluKCBzY29wZS5tYXhEaXN0YW5jZSwgc3BoZXJpY2FsLnJhZGl1cyApICk7XG5cblx0XHRcdC8vIG1vdmUgdGFyZ2V0IHRvIHBhbm5lZCBsb2NhdGlvblxuXHRcdFx0c2NvcGUudGFyZ2V0LmFkZCggcGFuT2Zmc2V0ICk7XG5cblx0XHRcdG9mZnNldC5zZXRGcm9tU3BoZXJpY2FsKCBzcGhlcmljYWwgKTtcblxuXHRcdFx0Ly8gcm90YXRlIG9mZnNldCBiYWNrIHRvIFwiY2FtZXJhLXVwLXZlY3Rvci1pcy11cFwiIHNwYWNlXG5cdFx0XHRvZmZzZXQuYXBwbHlRdWF0ZXJuaW9uKCBxdWF0SW52ZXJzZSApO1xuXG5cdFx0XHRwb3NpdGlvbi5jb3B5KCBzY29wZS50YXJnZXQgKS5hZGQoIG9mZnNldCApO1xuXG5cdFx0XHRzY29wZS5vYmplY3QubG9va0F0KCBzY29wZS50YXJnZXQgKTtcblxuXHRcdFx0aWYgKCBzY29wZS5lbmFibGVEYW1waW5nID09PSB0cnVlICkge1xuXG5cdFx0XHRcdHNwaGVyaWNhbERlbHRhLnRoZXRhICo9ICggMSAtIHNjb3BlLmRhbXBpbmdGYWN0b3IgKTtcblx0XHRcdFx0c3BoZXJpY2FsRGVsdGEucGhpICo9ICggMSAtIHNjb3BlLmRhbXBpbmdGYWN0b3IgKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRzcGhlcmljYWxEZWx0YS5zZXQoIDAsIDAsIDAgKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRzY2FsZSA9IDE7XG5cdFx0XHRwYW5PZmZzZXQuc2V0KCAwLCAwLCAwICk7XG5cblx0XHRcdC8vIHVwZGF0ZSBjb25kaXRpb24gaXM6XG5cdFx0XHQvLyBtaW4oY2FtZXJhIGRpc3BsYWNlbWVudCwgY2FtZXJhIHJvdGF0aW9uIGluIHJhZGlhbnMpXjIgPiBFUFNcblx0XHRcdC8vIHVzaW5nIHNtYWxsLWFuZ2xlIGFwcHJveGltYXRpb24gY29zKHgvMikgPSAxIC0geF4yIC8gOFxuXG5cdFx0XHRpZiAoIHpvb21DaGFuZ2VkIHx8XG5cdFx0XHRcdGxhc3RQb3NpdGlvbi5kaXN0YW5jZVRvU3F1YXJlZCggc2NvcGUub2JqZWN0LnBvc2l0aW9uICkgPiBFUFMgfHxcblx0XHRcdFx0OCAqICggMSAtIGxhc3RRdWF0ZXJuaW9uLmRvdCggc2NvcGUub2JqZWN0LnF1YXRlcm5pb24gKSApID4gRVBTICkge1xuXG5cdFx0XHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIGNoYW5nZUV2ZW50ICk7XG5cblx0XHRcdFx0bGFzdFBvc2l0aW9uLmNvcHkoIHNjb3BlLm9iamVjdC5wb3NpdGlvbiApO1xuXHRcdFx0XHRsYXN0UXVhdGVybmlvbi5jb3B5KCBzY29wZS5vYmplY3QucXVhdGVybmlvbiApO1xuXHRcdFx0XHR6b29tQ2hhbmdlZCA9IGZhbHNlO1xuXG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBmYWxzZTtcblxuXHRcdH07XG5cblx0fSgpO1xuXG5cdHRoaXMuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2NvbnRleHRtZW51Jywgb25Db250ZXh0TWVudSwgZmFsc2UgKTtcblx0XHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZWRvd24nLCBvbk1vdXNlRG93biwgZmFsc2UgKTtcblx0XHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd3aGVlbCcsIG9uTW91c2VXaGVlbCwgZmFsc2UgKTtcblxuXHRcdHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3RvdWNoc3RhcnQnLCBvblRvdWNoU3RhcnQsIGZhbHNlICk7XG5cdFx0c2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAndG91Y2hlbmQnLCBvblRvdWNoRW5kLCBmYWxzZSApO1xuXHRcdHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlLCBmYWxzZSApO1xuXG5cdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlLCBmYWxzZSApO1xuXHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZXVwJywgb25Nb3VzZVVwLCBmYWxzZSApO1xuXG5cdFx0d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdrZXlkb3duJywgb25LZXlEb3duLCBmYWxzZSApO1xuXG5cdFx0Ly9zY29wZS5kaXNwYXRjaEV2ZW50KCB7IHR5cGU6ICdkaXNwb3NlJyB9ICk7IC8vIHNob3VsZCB0aGlzIGJlIGFkZGVkIGhlcmU/XG5cblx0fTtcblxuXHQvL1xuXHQvLyBpbnRlcm5hbHNcblx0Ly9cblxuXHR2YXIgc2NvcGUgPSB0aGlzO1xuXG5cdHZhciBjaGFuZ2VFdmVudCA9IHsgdHlwZTogJ2NoYW5nZScgfTtcblx0dmFyIHN0YXJ0RXZlbnQgPSB7IHR5cGU6ICdzdGFydCcgfTtcblx0dmFyIGVuZEV2ZW50ID0geyB0eXBlOiAnZW5kJyB9O1xuXG5cdHZhciBTVEFURSA9IHsgTk9ORTogLSAxLCBST1RBVEU6IDAsIERPTExZOiAxLCBQQU46IDIsIFRPVUNIX1JPVEFURTogMywgVE9VQ0hfRE9MTFk6IDQsIFRPVUNIX1BBTjogNSB9O1xuXG5cdHZhciBzdGF0ZSA9IFNUQVRFLk5PTkU7XG5cblx0dmFyIEVQUyA9IDAuMDAwMDAxO1xuXG5cdC8vIGN1cnJlbnQgcG9zaXRpb24gaW4gc3BoZXJpY2FsIGNvb3JkaW5hdGVzXG5cdHZhciBzcGhlcmljYWwgPSBuZXcgVEhSRUUuU3BoZXJpY2FsKCk7XG5cdHZhciBzcGhlcmljYWxEZWx0YSA9IG5ldyBUSFJFRS5TcGhlcmljYWwoKTtcblxuXHR2YXIgc2NhbGUgPSAxO1xuXHR2YXIgcGFuT2Zmc2V0ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblx0dmFyIHpvb21DaGFuZ2VkID0gZmFsc2U7XG5cblx0dmFyIHJvdGF0ZVN0YXJ0ID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcblx0dmFyIHJvdGF0ZUVuZCA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cdHZhciByb3RhdGVEZWx0YSA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cblx0dmFyIHBhblN0YXJ0ID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcblx0dmFyIHBhbkVuZCA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cdHZhciBwYW5EZWx0YSA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cblx0dmFyIGRvbGx5U3RhcnQgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xuXHR2YXIgZG9sbHlFbmQgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xuXHR2YXIgZG9sbHlEZWx0YSA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cblx0ZnVuY3Rpb24gZ2V0QXV0b1JvdGF0aW9uQW5nbGUoKSB7XG5cblx0XHRyZXR1cm4gMiAqIE1hdGguUEkgLyA2MCAvIDYwICogc2NvcGUuYXV0b1JvdGF0ZVNwZWVkO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBnZXRab29tU2NhbGUoKSB7XG5cblx0XHRyZXR1cm4gTWF0aC5wb3coIDAuOTUsIHNjb3BlLnpvb21TcGVlZCApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiByb3RhdGVMZWZ0KCBhbmdsZSApIHtcblxuXHRcdHNwaGVyaWNhbERlbHRhLnRoZXRhIC09IGFuZ2xlO1xuXG5cdH1cblxuXHRmdW5jdGlvbiByb3RhdGVVcCggYW5nbGUgKSB7XG5cblx0XHRzcGhlcmljYWxEZWx0YS5waGkgLT0gYW5nbGU7XG5cblx0fVxuXG5cdHZhciBwYW5MZWZ0ID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0dmFyIHYgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIHBhbkxlZnQoIGRpc3RhbmNlLCBvYmplY3RNYXRyaXggKSB7XG5cblx0XHRcdHYuc2V0RnJvbU1hdHJpeENvbHVtbiggb2JqZWN0TWF0cml4LCAwICk7IC8vIGdldCBYIGNvbHVtbiBvZiBvYmplY3RNYXRyaXhcblx0XHRcdHYubXVsdGlwbHlTY2FsYXIoIC0gZGlzdGFuY2UgKTtcblxuXHRcdFx0cGFuT2Zmc2V0LmFkZCggdiApO1xuXG5cdFx0fTtcblxuXHR9KCk7XG5cblx0dmFyIHBhblVwID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0dmFyIHYgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIHBhblVwKCBkaXN0YW5jZSwgb2JqZWN0TWF0cml4ICkge1xuXG5cdFx0XHR2LnNldEZyb21NYXRyaXhDb2x1bW4oIG9iamVjdE1hdHJpeCwgMSApOyAvLyBnZXQgWSBjb2x1bW4gb2Ygb2JqZWN0TWF0cml4XG5cdFx0XHR2Lm11bHRpcGx5U2NhbGFyKCBkaXN0YW5jZSApO1xuXG5cdFx0XHRwYW5PZmZzZXQuYWRkKCB2ICk7XG5cblx0XHR9O1xuXG5cdH0oKTtcblxuXHQvLyBkZWx0YVggYW5kIGRlbHRhWSBhcmUgaW4gcGl4ZWxzOyByaWdodCBhbmQgZG93biBhcmUgcG9zaXRpdmVcblx0dmFyIHBhbiA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciBvZmZzZXQgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIHBhbiggZGVsdGFYLCBkZWx0YVkgKSB7XG5cblx0XHRcdHZhciBlbGVtZW50ID0gc2NvcGUuZG9tRWxlbWVudCA9PT0gZG9jdW1lbnQgPyBzY29wZS5kb21FbGVtZW50LmJvZHkgOiBzY29wZS5kb21FbGVtZW50O1xuXG5cdFx0XHRpZiAoIHNjb3BlLm9iamVjdC5pc1BlcnNwZWN0aXZlQ2FtZXJhICkge1xuXG5cdFx0XHRcdC8vIHBlcnNwZWN0aXZlXG5cdFx0XHRcdHZhciBwb3NpdGlvbiA9IHNjb3BlLm9iamVjdC5wb3NpdGlvbjtcblx0XHRcdFx0b2Zmc2V0LmNvcHkoIHBvc2l0aW9uICkuc3ViKCBzY29wZS50YXJnZXQgKTtcblx0XHRcdFx0dmFyIHRhcmdldERpc3RhbmNlID0gb2Zmc2V0Lmxlbmd0aCgpO1xuXG5cdFx0XHRcdC8vIGhhbGYgb2YgdGhlIGZvdiBpcyBjZW50ZXIgdG8gdG9wIG9mIHNjcmVlblxuXHRcdFx0XHR0YXJnZXREaXN0YW5jZSAqPSBNYXRoLnRhbiggKCBzY29wZS5vYmplY3QuZm92IC8gMiApICogTWF0aC5QSSAvIDE4MC4wICk7XG5cblx0XHRcdFx0Ly8gd2UgYWN0dWFsbHkgZG9uJ3QgdXNlIHNjcmVlbldpZHRoLCBzaW5jZSBwZXJzcGVjdGl2ZSBjYW1lcmEgaXMgZml4ZWQgdG8gc2NyZWVuIGhlaWdodFxuXHRcdFx0XHRwYW5MZWZ0KCAyICogZGVsdGFYICogdGFyZ2V0RGlzdGFuY2UgLyBlbGVtZW50LmNsaWVudEhlaWdodCwgc2NvcGUub2JqZWN0Lm1hdHJpeCApO1xuXHRcdFx0XHRwYW5VcCggMiAqIGRlbHRhWSAqIHRhcmdldERpc3RhbmNlIC8gZWxlbWVudC5jbGllbnRIZWlnaHQsIHNjb3BlLm9iamVjdC5tYXRyaXggKTtcblxuXHRcdFx0fSBlbHNlIGlmICggc2NvcGUub2JqZWN0LmlzT3J0aG9ncmFwaGljQ2FtZXJhICkge1xuXG5cdFx0XHRcdC8vIG9ydGhvZ3JhcGhpY1xuXHRcdFx0XHRwYW5MZWZ0KCBkZWx0YVggKiAoIHNjb3BlLm9iamVjdC5yaWdodCAtIHNjb3BlLm9iamVjdC5sZWZ0ICkgLyBzY29wZS5vYmplY3Quem9vbSAvIGVsZW1lbnQuY2xpZW50V2lkdGgsIHNjb3BlLm9iamVjdC5tYXRyaXggKTtcblx0XHRcdFx0cGFuVXAoIGRlbHRhWSAqICggc2NvcGUub2JqZWN0LnRvcCAtIHNjb3BlLm9iamVjdC5ib3R0b20gKSAvIHNjb3BlLm9iamVjdC56b29tIC8gZWxlbWVudC5jbGllbnRIZWlnaHQsIHNjb3BlLm9iamVjdC5tYXRyaXggKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHQvLyBjYW1lcmEgbmVpdGhlciBvcnRob2dyYXBoaWMgbm9yIHBlcnNwZWN0aXZlXG5cdFx0XHRcdGNvbnNvbGUud2FybiggJ1dBUk5JTkc6IE9yYml0Q29udHJvbHMuanMgZW5jb3VudGVyZWQgYW4gdW5rbm93biBjYW1lcmEgdHlwZSAtIHBhbiBkaXNhYmxlZC4nICk7XG5cdFx0XHRcdHNjb3BlLmVuYWJsZVBhbiA9IGZhbHNlO1xuXG5cdFx0XHR9XG5cblx0XHR9O1xuXG5cdH0oKTtcblxuXHRmdW5jdGlvbiBkb2xseUluKCBkb2xseVNjYWxlICkge1xuXG5cdFx0aWYgKCBzY29wZS5vYmplY3QuaXNQZXJzcGVjdGl2ZUNhbWVyYSApIHtcblxuXHRcdFx0c2NhbGUgLz0gZG9sbHlTY2FsZTtcblxuXHRcdH0gZWxzZSBpZiAoIHNjb3BlLm9iamVjdC5pc09ydGhvZ3JhcGhpY0NhbWVyYSApIHtcblxuXHRcdFx0c2NvcGUub2JqZWN0Lnpvb20gPSBNYXRoLm1heCggc2NvcGUubWluWm9vbSwgTWF0aC5taW4oIHNjb3BlLm1heFpvb20sIHNjb3BlLm9iamVjdC56b29tICogZG9sbHlTY2FsZSApICk7XG5cdFx0XHRzY29wZS5vYmplY3QudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xuXHRcdFx0em9vbUNoYW5nZWQgPSB0cnVlO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnV0FSTklORzogT3JiaXRDb250cm9scy5qcyBlbmNvdW50ZXJlZCBhbiB1bmtub3duIGNhbWVyYSB0eXBlIC0gZG9sbHkvem9vbSBkaXNhYmxlZC4nICk7XG5cdFx0XHRzY29wZS5lbmFibGVab29tID0gZmFsc2U7XG5cblx0XHR9XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGRvbGx5T3V0KCBkb2xseVNjYWxlICkge1xuXG5cdFx0aWYgKCBzY29wZS5vYmplY3QuaXNQZXJzcGVjdGl2ZUNhbWVyYSApIHtcblxuXHRcdFx0c2NhbGUgKj0gZG9sbHlTY2FsZTtcblxuXHRcdH0gZWxzZSBpZiAoIHNjb3BlLm9iamVjdC5pc09ydGhvZ3JhcGhpY0NhbWVyYSApIHtcblxuXHRcdFx0c2NvcGUub2JqZWN0Lnpvb20gPSBNYXRoLm1heCggc2NvcGUubWluWm9vbSwgTWF0aC5taW4oIHNjb3BlLm1heFpvb20sIHNjb3BlLm9iamVjdC56b29tIC8gZG9sbHlTY2FsZSApICk7XG5cdFx0XHRzY29wZS5vYmplY3QudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xuXHRcdFx0em9vbUNoYW5nZWQgPSB0cnVlO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnV0FSTklORzogT3JiaXRDb250cm9scy5qcyBlbmNvdW50ZXJlZCBhbiB1bmtub3duIGNhbWVyYSB0eXBlIC0gZG9sbHkvem9vbSBkaXNhYmxlZC4nICk7XG5cdFx0XHRzY29wZS5lbmFibGVab29tID0gZmFsc2U7XG5cblx0XHR9XG5cblx0fVxuXG5cdC8vXG5cdC8vIGV2ZW50IGNhbGxiYWNrcyAtIHVwZGF0ZSB0aGUgb2JqZWN0IHN0YXRlXG5cdC8vXG5cblx0ZnVuY3Rpb24gaGFuZGxlTW91c2VEb3duUm90YXRlKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVNb3VzZURvd25Sb3RhdGUnICk7XG5cblx0XHRyb3RhdGVTdGFydC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlTW91c2VEb3duRG9sbHkoIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZU1vdXNlRG93bkRvbGx5JyApO1xuXG5cdFx0ZG9sbHlTdGFydC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlTW91c2VEb3duUGFuKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVNb3VzZURvd25QYW4nICk7XG5cblx0XHRwYW5TdGFydC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlTW91c2VNb3ZlUm90YXRlKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVNb3VzZU1vdmVSb3RhdGUnICk7XG5cblx0XHRyb3RhdGVFbmQuc2V0KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZICk7XG5cdFx0cm90YXRlRGVsdGEuc3ViVmVjdG9ycyggcm90YXRlRW5kLCByb3RhdGVTdGFydCApO1xuXG5cdFx0dmFyIGVsZW1lbnQgPSBzY29wZS5kb21FbGVtZW50ID09PSBkb2N1bWVudCA/IHNjb3BlLmRvbUVsZW1lbnQuYm9keSA6IHNjb3BlLmRvbUVsZW1lbnQ7XG5cblx0XHQvLyByb3RhdGluZyBhY3Jvc3Mgd2hvbGUgc2NyZWVuIGdvZXMgMzYwIGRlZ3JlZXMgYXJvdW5kXG5cdFx0cm90YXRlTGVmdCggMiAqIE1hdGguUEkgKiByb3RhdGVEZWx0YS54IC8gZWxlbWVudC5jbGllbnRXaWR0aCAqIHNjb3BlLnJvdGF0ZVNwZWVkICk7XG5cblx0XHQvLyByb3RhdGluZyB1cCBhbmQgZG93biBhbG9uZyB3aG9sZSBzY3JlZW4gYXR0ZW1wdHMgdG8gZ28gMzYwLCBidXQgbGltaXRlZCB0byAxODBcblx0XHRyb3RhdGVVcCggMiAqIE1hdGguUEkgKiByb3RhdGVEZWx0YS55IC8gZWxlbWVudC5jbGllbnRIZWlnaHQgKiBzY29wZS5yb3RhdGVTcGVlZCApO1xuXG5cdFx0cm90YXRlU3RhcnQuY29weSggcm90YXRlRW5kICk7XG5cblx0XHRzY29wZS51cGRhdGUoKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlTW91c2VNb3ZlRG9sbHkoIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZU1vdXNlTW92ZURvbGx5JyApO1xuXG5cdFx0ZG9sbHlFbmQuc2V0KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZICk7XG5cblx0XHRkb2xseURlbHRhLnN1YlZlY3RvcnMoIGRvbGx5RW5kLCBkb2xseVN0YXJ0ICk7XG5cblx0XHRpZiAoIGRvbGx5RGVsdGEueSA+IDAgKSB7XG5cblx0XHRcdGRvbGx5SW4oIGdldFpvb21TY2FsZSgpICk7XG5cblx0XHR9IGVsc2UgaWYgKCBkb2xseURlbHRhLnkgPCAwICkge1xuXG5cdFx0XHRkb2xseU91dCggZ2V0Wm9vbVNjYWxlKCkgKTtcblxuXHRcdH1cblxuXHRcdGRvbGx5U3RhcnQuY29weSggZG9sbHlFbmQgKTtcblxuXHRcdHNjb3BlLnVwZGF0ZSgpO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVNb3VzZU1vdmVQYW4oIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZU1vdXNlTW92ZVBhbicgKTtcblxuXHRcdHBhbkVuZC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcblxuXHRcdHBhbkRlbHRhLnN1YlZlY3RvcnMoIHBhbkVuZCwgcGFuU3RhcnQgKTtcblxuXHRcdHBhbiggcGFuRGVsdGEueCwgcGFuRGVsdGEueSApO1xuXG5cdFx0cGFuU3RhcnQuY29weSggcGFuRW5kICk7XG5cblx0XHRzY29wZS51cGRhdGUoKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlTW91c2VVcCggZXZlbnQgKSB7XG5cblx0XHQvLyBjb25zb2xlLmxvZyggJ2hhbmRsZU1vdXNlVXAnICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZU1vdXNlV2hlZWwoIGV2ZW50ICkge1xuXG5cdFx0Ly8gY29uc29sZS5sb2coICdoYW5kbGVNb3VzZVdoZWVsJyApO1xuXG5cdFx0aWYgKCBldmVudC5kZWx0YVkgPCAwICkge1xuXG5cdFx0XHRkb2xseU91dCggZ2V0Wm9vbVNjYWxlKCkgKTtcblxuXHRcdH0gZWxzZSBpZiAoIGV2ZW50LmRlbHRhWSA+IDAgKSB7XG5cblx0XHRcdGRvbGx5SW4oIGdldFpvb21TY2FsZSgpICk7XG5cblx0XHR9XG5cblx0XHRzY29wZS51cGRhdGUoKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlS2V5RG93biggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlS2V5RG93bicgKTtcblxuXHRcdHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7XG5cblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5VUDpcblx0XHRcdFx0cGFuKCAwLCBzY29wZS5rZXlQYW5TcGVlZCApO1xuXHRcdFx0XHRzY29wZS51cGRhdGUoKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5CT1RUT006XG5cdFx0XHRcdHBhbiggMCwgLSBzY29wZS5rZXlQYW5TcGVlZCApO1xuXHRcdFx0XHRzY29wZS51cGRhdGUoKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5MRUZUOlxuXHRcdFx0XHRwYW4oIHNjb3BlLmtleVBhblNwZWVkLCAwICk7XG5cdFx0XHRcdHNjb3BlLnVwZGF0ZSgpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBzY29wZS5rZXlzLlJJR0hUOlxuXHRcdFx0XHRwYW4oIC0gc2NvcGUua2V5UGFuU3BlZWQsIDAgKTtcblx0XHRcdFx0c2NvcGUudXBkYXRlKCk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVUb3VjaFN0YXJ0Um90YXRlKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVUb3VjaFN0YXJ0Um90YXRlJyApO1xuXG5cdFx0cm90YXRlU3RhcnQuc2V0KCBldmVudC50b3VjaGVzWyAwIF0ucGFnZVgsIGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWSApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVUb3VjaFN0YXJ0RG9sbHkoIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZVRvdWNoU3RhcnREb2xseScgKTtcblxuXHRcdHZhciBkeCA9IGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWCAtIGV2ZW50LnRvdWNoZXNbIDEgXS5wYWdlWDtcblx0XHR2YXIgZHkgPSBldmVudC50b3VjaGVzWyAwIF0ucGFnZVkgLSBldmVudC50b3VjaGVzWyAxIF0ucGFnZVk7XG5cblx0XHR2YXIgZGlzdGFuY2UgPSBNYXRoLnNxcnQoIGR4ICogZHggKyBkeSAqIGR5ICk7XG5cblx0XHRkb2xseVN0YXJ0LnNldCggMCwgZGlzdGFuY2UgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlVG91Y2hTdGFydFBhbiggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlVG91Y2hTdGFydFBhbicgKTtcblxuXHRcdHBhblN0YXJ0LnNldCggZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VYLCBldmVudC50b3VjaGVzWyAwIF0ucGFnZVkgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlVG91Y2hNb3ZlUm90YXRlKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVUb3VjaE1vdmVSb3RhdGUnICk7XG5cblx0XHRyb3RhdGVFbmQuc2V0KCBldmVudC50b3VjaGVzWyAwIF0ucGFnZVgsIGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWSApO1xuXHRcdHJvdGF0ZURlbHRhLnN1YlZlY3RvcnMoIHJvdGF0ZUVuZCwgcm90YXRlU3RhcnQgKTtcblxuXHRcdHZhciBlbGVtZW50ID0gc2NvcGUuZG9tRWxlbWVudCA9PT0gZG9jdW1lbnQgPyBzY29wZS5kb21FbGVtZW50LmJvZHkgOiBzY29wZS5kb21FbGVtZW50O1xuXG5cdFx0Ly8gcm90YXRpbmcgYWNyb3NzIHdob2xlIHNjcmVlbiBnb2VzIDM2MCBkZWdyZWVzIGFyb3VuZFxuXHRcdHJvdGF0ZUxlZnQoIDIgKiBNYXRoLlBJICogcm90YXRlRGVsdGEueCAvIGVsZW1lbnQuY2xpZW50V2lkdGggKiBzY29wZS5yb3RhdGVTcGVlZCApO1xuXG5cdFx0Ly8gcm90YXRpbmcgdXAgYW5kIGRvd24gYWxvbmcgd2hvbGUgc2NyZWVuIGF0dGVtcHRzIHRvIGdvIDM2MCwgYnV0IGxpbWl0ZWQgdG8gMTgwXG5cdFx0cm90YXRlVXAoIDIgKiBNYXRoLlBJICogcm90YXRlRGVsdGEueSAvIGVsZW1lbnQuY2xpZW50SGVpZ2h0ICogc2NvcGUucm90YXRlU3BlZWQgKTtcblxuXHRcdHJvdGF0ZVN0YXJ0LmNvcHkoIHJvdGF0ZUVuZCApO1xuXG5cdFx0c2NvcGUudXBkYXRlKCk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZVRvdWNoTW92ZURvbGx5KCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVUb3VjaE1vdmVEb2xseScgKTtcblxuXHRcdHZhciBkeCA9IGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWCAtIGV2ZW50LnRvdWNoZXNbIDEgXS5wYWdlWDtcblx0XHR2YXIgZHkgPSBldmVudC50b3VjaGVzWyAwIF0ucGFnZVkgLSBldmVudC50b3VjaGVzWyAxIF0ucGFnZVk7XG5cblx0XHR2YXIgZGlzdGFuY2UgPSBNYXRoLnNxcnQoIGR4ICogZHggKyBkeSAqIGR5ICk7XG5cblx0XHRkb2xseUVuZC5zZXQoIDAsIGRpc3RhbmNlICk7XG5cblx0XHRkb2xseURlbHRhLnN1YlZlY3RvcnMoIGRvbGx5RW5kLCBkb2xseVN0YXJ0ICk7XG5cblx0XHRpZiAoIGRvbGx5RGVsdGEueSA+IDAgKSB7XG5cblx0XHRcdGRvbGx5T3V0KCBnZXRab29tU2NhbGUoKSApO1xuXG5cdFx0fSBlbHNlIGlmICggZG9sbHlEZWx0YS55IDwgMCApIHtcblxuXHRcdFx0ZG9sbHlJbiggZ2V0Wm9vbVNjYWxlKCkgKTtcblxuXHRcdH1cblxuXHRcdGRvbGx5U3RhcnQuY29weSggZG9sbHlFbmQgKTtcblxuXHRcdHNjb3BlLnVwZGF0ZSgpO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVUb3VjaE1vdmVQYW4oIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZVRvdWNoTW92ZVBhbicgKTtcblxuXHRcdHBhbkVuZC5zZXQoIGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWCwgZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VZICk7XG5cblx0XHRwYW5EZWx0YS5zdWJWZWN0b3JzKCBwYW5FbmQsIHBhblN0YXJ0ICk7XG5cblx0XHRwYW4oIHBhbkRlbHRhLngsIHBhbkRlbHRhLnkgKTtcblxuXHRcdHBhblN0YXJ0LmNvcHkoIHBhbkVuZCApO1xuXG5cdFx0c2NvcGUudXBkYXRlKCk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZVRvdWNoRW5kKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVUb3VjaEVuZCcgKTtcblxuXHR9XG5cblx0Ly9cblx0Ly8gZXZlbnQgaGFuZGxlcnMgLSBGU006IGxpc3RlbiBmb3IgZXZlbnRzIGFuZCByZXNldCBzdGF0ZVxuXHQvL1xuXG5cdGZ1bmN0aW9uIG9uTW91c2VEb3duKCBldmVudCApIHtcblxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0c3dpdGNoICggZXZlbnQuYnV0dG9uICkge1xuXG5cdFx0XHRjYXNlIHNjb3BlLm1vdXNlQnV0dG9ucy5PUkJJVDpcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVJvdGF0ZSA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdFx0aGFuZGxlTW91c2VEb3duUm90YXRlKCBldmVudCApO1xuXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuUk9UQVRFO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIHNjb3BlLm1vdXNlQnV0dG9ucy5aT09NOlxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlWm9vbSA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdFx0aGFuZGxlTW91c2VEb3duRG9sbHkoIGV2ZW50ICk7XG5cblx0XHRcdFx0c3RhdGUgPSBTVEFURS5ET0xMWTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBzY29wZS5tb3VzZUJ1dHRvbnMuUEFOOlxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlUGFuID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRoYW5kbGVNb3VzZURvd25QYW4oIGV2ZW50ICk7XG5cblx0XHRcdFx0c3RhdGUgPSBTVEFURS5QQU47XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHR9XG5cblx0XHRpZiAoIHN0YXRlICE9PSBTVEFURS5OT05FICkge1xuXG5cdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUsIGZhbHNlICk7XG5cdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uTW91c2VVcCwgZmFsc2UgKTtcblxuXHRcdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggc3RhcnRFdmVudCApO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRmdW5jdGlvbiBvbk1vdXNlTW92ZSggZXZlbnQgKSB7XG5cblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHN3aXRjaCAoIHN0YXRlICkge1xuXG5cdFx0XHRjYXNlIFNUQVRFLlJPVEFURTpcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVJvdGF0ZSA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdFx0aGFuZGxlTW91c2VNb3ZlUm90YXRlKCBldmVudCApO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFNUQVRFLkRPTExZOlxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlWm9vbSA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdFx0aGFuZGxlTW91c2VNb3ZlRG9sbHkoIGV2ZW50ICk7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgU1RBVEUuUEFOOlxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlUGFuID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRoYW5kbGVNb3VzZU1vdmVQYW4oIGV2ZW50ICk7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHR9XG5cblx0fVxuXG5cdGZ1bmN0aW9uIG9uTW91c2VVcCggZXZlbnQgKSB7XG5cblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0aGFuZGxlTW91c2VVcCggZXZlbnQgKTtcblxuXHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSwgZmFsc2UgKTtcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uTW91c2VVcCwgZmFsc2UgKTtcblxuXHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIGVuZEV2ZW50ICk7XG5cblx0XHRzdGF0ZSA9IFNUQVRFLk5PTkU7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIG9uTW91c2VXaGVlbCggZXZlbnQgKSB7XG5cblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlIHx8IHNjb3BlLmVuYWJsZVpvb20gPT09IGZhbHNlIHx8ICggc3RhdGUgIT09IFNUQVRFLk5PTkUgJiYgc3RhdGUgIT09IFNUQVRFLlJPVEFURSApICkgcmV0dXJuO1xuXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIHN0YXJ0RXZlbnQgKTtcblxuXHRcdGhhbmRsZU1vdXNlV2hlZWwoIGV2ZW50ICk7XG5cblx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCBlbmRFdmVudCApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBvbktleURvd24oIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSB8fCBzY29wZS5lbmFibGVLZXlzID09PSBmYWxzZSB8fCBzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0aGFuZGxlS2V5RG93biggZXZlbnQgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gb25Ub3VjaFN0YXJ0KCBldmVudCApIHtcblxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRzd2l0Y2ggKCBldmVudC50b3VjaGVzLmxlbmd0aCApIHtcblxuXHRcdFx0Y2FzZSAxOlx0Ly8gb25lLWZpbmdlcmVkIHRvdWNoOiByb3RhdGVcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVJvdGF0ZSA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdFx0aGFuZGxlVG91Y2hTdGFydFJvdGF0ZSggZXZlbnQgKTtcblxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLlRPVUNIX1JPVEFURTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAyOlx0Ly8gdHdvLWZpbmdlcmVkIHRvdWNoOiBkb2xseVxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlWm9vbSA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdFx0aGFuZGxlVG91Y2hTdGFydERvbGx5KCBldmVudCApO1xuXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuVE9VQ0hfRE9MTFk7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMzogLy8gdGhyZWUtZmluZ2VyZWQgdG91Y2g6IHBhblxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlUGFuID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRoYW5kbGVUb3VjaFN0YXJ0UGFuKCBldmVudCApO1xuXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuVE9VQ0hfUEFOO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRkZWZhdWx0OlxuXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuTk9ORTtcblxuXHRcdH1cblxuXHRcdGlmICggc3RhdGUgIT09IFNUQVRFLk5PTkUgKSB7XG5cblx0XHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIHN0YXJ0RXZlbnQgKTtcblxuXHRcdH1cblxuXHR9XG5cblx0ZnVuY3Rpb24gb25Ub3VjaE1vdmUoIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRzd2l0Y2ggKCBldmVudC50b3VjaGVzLmxlbmd0aCApIHtcblxuXHRcdFx0Y2FzZSAxOiAvLyBvbmUtZmluZ2VyZWQgdG91Y2g6IHJvdGF0ZVxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlUm90YXRlID09PSBmYWxzZSApIHJldHVybjtcblx0XHRcdFx0aWYgKCBzdGF0ZSAhPT0gU1RBVEUuVE9VQ0hfUk9UQVRFICkgcmV0dXJuOyAvLyBpcyB0aGlzIG5lZWRlZD8uLi5cblxuXHRcdFx0XHRoYW5kbGVUb3VjaE1vdmVSb3RhdGUoIGV2ZW50ICk7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMjogLy8gdHdvLWZpbmdlcmVkIHRvdWNoOiBkb2xseVxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlWm9vbSA9PT0gZmFsc2UgKSByZXR1cm47XG5cdFx0XHRcdGlmICggc3RhdGUgIT09IFNUQVRFLlRPVUNIX0RPTExZICkgcmV0dXJuOyAvLyBpcyB0aGlzIG5lZWRlZD8uLi5cblxuXHRcdFx0XHRoYW5kbGVUb3VjaE1vdmVEb2xseSggZXZlbnQgKTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAzOiAvLyB0aHJlZS1maW5nZXJlZCB0b3VjaDogcGFuXG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlICkgcmV0dXJuO1xuXHRcdFx0XHRpZiAoIHN0YXRlICE9PSBTVEFURS5UT1VDSF9QQU4gKSByZXR1cm47IC8vIGlzIHRoaXMgbmVlZGVkPy4uLlxuXG5cdFx0XHRcdGhhbmRsZVRvdWNoTW92ZVBhbiggZXZlbnQgKTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0ZGVmYXVsdDpcblxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLk5PTkU7XG5cblx0XHR9XG5cblx0fVxuXG5cdGZ1bmN0aW9uIG9uVG91Y2hFbmQoIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdGhhbmRsZVRvdWNoRW5kKCBldmVudCApO1xuXG5cdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggZW5kRXZlbnQgKTtcblxuXHRcdHN0YXRlID0gU1RBVEUuTk9ORTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gb25Db250ZXh0TWVudSggZXZlbnQgKSB7XG5cblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuXHR9XG5cblx0Ly9cblxuXHRzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdjb250ZXh0bWVudScsIG9uQ29udGV4dE1lbnUsIGZhbHNlICk7XG5cblx0c2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vkb3duJywgb25Nb3VzZURvd24sIGZhbHNlICk7XG5cdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3doZWVsJywgb25Nb3VzZVdoZWVsLCBmYWxzZSApO1xuXG5cdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoc3RhcnQnLCBvblRvdWNoU3RhcnQsIGZhbHNlICk7XG5cdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoZW5kJywgb25Ub3VjaEVuZCwgZmFsc2UgKTtcblx0c2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUsIGZhbHNlICk7XG5cblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdrZXlkb3duJywgb25LZXlEb3duLCBmYWxzZSApO1xuXG5cdC8vIGZvcmNlIGFuIHVwZGF0ZSBhdCBzdGFydFxuXG5cdHRoaXMudXBkYXRlKCk7XG5cbn07XG5cblRIUkVFLk9yYml0Q29udHJvbHMucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggVEhSRUUuRXZlbnREaXNwYXRjaGVyLnByb3RvdHlwZSApO1xuVEhSRUUuT3JiaXRDb250cm9scy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBUSFJFRS5PcmJpdENvbnRyb2xzO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyggVEhSRUUuT3JiaXRDb250cm9scy5wcm90b3R5cGUsIHtcblxuXHRjZW50ZXI6IHtcblxuXHRcdGdldDogZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAuY2VudGVyIGhhcyBiZWVuIHJlbmFtZWQgdG8gLnRhcmdldCcgKTtcblx0XHRcdHJldHVybiB0aGlzLnRhcmdldDtcblxuXHRcdH1cblxuXHR9LFxuXG5cdC8vIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcblxuXHRub1pvb206IHtcblxuXHRcdGdldDogZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAubm9ab29tIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlWm9vbSBpbnN0ZWFkLicgKTtcblx0XHRcdHJldHVybiAhIHRoaXMuZW5hYmxlWm9vbTtcblxuXHRcdH0sXG5cblx0XHRzZXQ6IGZ1bmN0aW9uICggdmFsdWUgKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5ub1pvb20gaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVab29tIGluc3RlYWQuJyApO1xuXHRcdFx0dGhpcy5lbmFibGVab29tID0gISB2YWx1ZTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdG5vUm90YXRlOiB7XG5cblx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLm5vUm90YXRlIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlUm90YXRlIGluc3RlYWQuJyApO1xuXHRcdFx0cmV0dXJuICEgdGhpcy5lbmFibGVSb3RhdGU7XG5cblx0XHR9LFxuXG5cdFx0c2V0OiBmdW5jdGlvbiAoIHZhbHVlICkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAubm9Sb3RhdGUgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVSb3RhdGUgaW5zdGVhZC4nICk7XG5cdFx0XHR0aGlzLmVuYWJsZVJvdGF0ZSA9ICEgdmFsdWU7XG5cblx0XHR9XG5cblx0fSxcblxuXHRub1Bhbjoge1xuXG5cdFx0Z2V0OiBmdW5jdGlvbiAoKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5ub1BhbiBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZVBhbiBpbnN0ZWFkLicgKTtcblx0XHRcdHJldHVybiAhIHRoaXMuZW5hYmxlUGFuO1xuXG5cdFx0fSxcblxuXHRcdHNldDogZnVuY3Rpb24gKCB2YWx1ZSApIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLm5vUGFuIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlUGFuIGluc3RlYWQuJyApO1xuXHRcdFx0dGhpcy5lbmFibGVQYW4gPSAhIHZhbHVlO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0bm9LZXlzOiB7XG5cblx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLm5vS2V5cyBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZUtleXMgaW5zdGVhZC4nICk7XG5cdFx0XHRyZXR1cm4gISB0aGlzLmVuYWJsZUtleXM7XG5cblx0XHR9LFxuXG5cdFx0c2V0OiBmdW5jdGlvbiAoIHZhbHVlICkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAubm9LZXlzIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlS2V5cyBpbnN0ZWFkLicgKTtcblx0XHRcdHRoaXMuZW5hYmxlS2V5cyA9ICEgdmFsdWU7XG5cblx0XHR9XG5cblx0fSxcblxuXHRzdGF0aWNNb3Zpbmc6IHtcblxuXHRcdGdldDogZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAuc3RhdGljTW92aW5nIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlRGFtcGluZyBpbnN0ZWFkLicgKTtcblx0XHRcdHJldHVybiAhIHRoaXMuZW5hYmxlRGFtcGluZztcblxuXHRcdH0sXG5cblx0XHRzZXQ6IGZ1bmN0aW9uICggdmFsdWUgKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5zdGF0aWNNb3ZpbmcgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVEYW1waW5nIGluc3RlYWQuJyApO1xuXHRcdFx0dGhpcy5lbmFibGVEYW1waW5nID0gISB2YWx1ZTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdGR5bmFtaWNEYW1waW5nRmFjdG9yOiB7XG5cblx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLmR5bmFtaWNEYW1waW5nRmFjdG9yIGhhcyBiZWVuIHJlbmFtZWQuIFVzZSAuZGFtcGluZ0ZhY3RvciBpbnN0ZWFkLicgKTtcblx0XHRcdHJldHVybiB0aGlzLmRhbXBpbmdGYWN0b3I7XG5cblx0XHR9LFxuXG5cdFx0c2V0OiBmdW5jdGlvbiAoIHZhbHVlICkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAuZHluYW1pY0RhbXBpbmdGYWN0b3IgaGFzIGJlZW4gcmVuYW1lZC4gVXNlIC5kYW1waW5nRmFjdG9yIGluc3RlYWQuJyApO1xuXHRcdFx0dGhpcy5kYW1waW5nRmFjdG9yID0gdmFsdWU7XG5cblx0XHR9XG5cblx0fVxuXG59ICk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLW9yYml0LWNvbnRyb2xzL2xpYi9PcmJpdENvbnRyb2xzLmpzXG4vLyBtb2R1bGUgaWQgPSA0MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IEFsZ29saWFTZWFyY2hDb3JlO1xuXG52YXIgZXJyb3JzID0gcmVxdWlyZSgnLi9lcnJvcnMnKTtcbnZhciBleGl0UHJvbWlzZSA9IHJlcXVpcmUoJy4vZXhpdFByb21pc2UuanMnKTtcbnZhciBJbmRleENvcmUgPSByZXF1aXJlKCcuL0luZGV4Q29yZS5qcycpO1xudmFyIHN0b3JlID0gcmVxdWlyZSgnLi9zdG9yZS5qcycpO1xuXG4vLyBXZSB3aWxsIGFsd2F5cyBwdXQgdGhlIEFQSSBLRVkgaW4gdGhlIEpTT04gYm9keSBpbiBjYXNlIG9mIHRvbyBsb25nIEFQSSBLRVksXG4vLyB0byBhdm9pZCBxdWVyeSBzdHJpbmcgYmVpbmcgdG9vIGxvbmcgYW5kIGZhaWxpbmcgaW4gdmFyaW91cyBjb25kaXRpb25zIChvdXIgc2VydmVyIGxpbWl0LCBicm93c2VyIGxpbWl0LFxuLy8gcHJveGllcyBsaW1pdClcbnZhciBNQVhfQVBJX0tFWV9MRU5HVEggPSA1MDA7XG52YXIgUkVTRVRfQVBQX0RBVEFfVElNRVIgPVxuICBwcm9jZXNzLmVudi5SRVNFVF9BUFBfREFUQV9USU1FUiAmJiBwYXJzZUludChwcm9jZXNzLmVudi5SRVNFVF9BUFBfREFUQV9USU1FUiwgMTApIHx8XG4gIDYwICogMiAqIDEwMDA7IC8vIGFmdGVyIDIgbWludXRlcyByZXNldCB0byBmaXJzdCBob3N0XG5cbi8qXG4gKiBBbGdvbGlhIFNlYXJjaCBsaWJyYXJ5IGluaXRpYWxpemF0aW9uXG4gKiBodHRwczovL3d3dy5hbGdvbGlhLmNvbS9cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwbGljYXRpb25JRCAtIFlvdXIgYXBwbGljYXRpb25JRCwgZm91bmQgaW4geW91ciBkYXNoYm9hcmRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcGlLZXkgLSBZb3VyIEFQSSBrZXksIGZvdW5kIGluIHlvdXIgZGFzaGJvYXJkXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdHNdXG4gKiBAcGFyYW0ge251bWJlcn0gW29wdHMudGltZW91dD0yMDAwXSAtIFRoZSByZXF1ZXN0IHRpbWVvdXQgc2V0IGluIG1pbGxpc2Vjb25kcyxcbiAqIGFub3RoZXIgcmVxdWVzdCB3aWxsIGJlIGlzc3VlZCBhZnRlciB0aGlzIHRpbWVvdXRcbiAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0cy5wcm90b2NvbD0naHR0cHM6J10gLSBUaGUgcHJvdG9jb2wgdXNlZCB0byBxdWVyeSBBbGdvbGlhIFNlYXJjaCBBUEkuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXQgdG8gJ2h0dHA6JyB0byBmb3JjZSB1c2luZyBodHRwLlxuICogQHBhcmFtIHtPYmplY3R8QXJyYXl9IFtvcHRzLmhvc3RzPXtcbiAqICAgICAgICAgICByZWFkOiBbdGhpcy5hcHBsaWNhdGlvbklEICsgJy1kc24uYWxnb2xpYS5uZXQnXS5jb25jYXQoW1xuICogICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbklEICsgJy0xLmFsZ29saWFuZXQuY29tJyxcbiAqICAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25JRCArICctMi5hbGdvbGlhbmV0LmNvbScsXG4gKiAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uSUQgKyAnLTMuYWxnb2xpYW5ldC5jb20nXVxuICogICAgICAgICAgIF0pLFxuICogICAgICAgICAgIHdyaXRlOiBbdGhpcy5hcHBsaWNhdGlvbklEICsgJy5hbGdvbGlhLm5ldCddLmNvbmNhdChbXG4gKiAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uSUQgKyAnLTEuYWxnb2xpYW5ldC5jb20nLFxuICogICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbklEICsgJy0yLmFsZ29saWFuZXQuY29tJyxcbiAqICAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25JRCArICctMy5hbGdvbGlhbmV0LmNvbSddXG4gKiAgICAgICAgICAgXSkgLSBUaGUgaG9zdHMgdG8gdXNlIGZvciBBbGdvbGlhIFNlYXJjaCBBUEkuXG4gKiAgICAgICAgICAgSWYgeW91IHByb3ZpZGUgdGhlbSwgeW91IHdpbGwgbGVzcyBiZW5lZml0IGZyb20gb3VyIEhBIGltcGxlbWVudGF0aW9uXG4gKi9cbmZ1bmN0aW9uIEFsZ29saWFTZWFyY2hDb3JlKGFwcGxpY2F0aW9uSUQsIGFwaUtleSwgb3B0cykge1xuICB2YXIgZGVidWcgPSByZXF1aXJlKCdkZWJ1ZycpKCdhbGdvbGlhc2VhcmNoJyk7XG5cbiAgdmFyIGNsb25lID0gcmVxdWlyZSgnLi9jbG9uZS5qcycpO1xuICB2YXIgaXNBcnJheSA9IHJlcXVpcmUoJ2lzYXJyYXknKTtcbiAgdmFyIG1hcCA9IHJlcXVpcmUoJy4vbWFwLmpzJyk7XG5cbiAgdmFyIHVzYWdlID0gJ1VzYWdlOiBhbGdvbGlhc2VhcmNoKGFwcGxpY2F0aW9uSUQsIGFwaUtleSwgb3B0cyknO1xuXG4gIGlmIChvcHRzLl9hbGxvd0VtcHR5Q3JlZGVudGlhbHMgIT09IHRydWUgJiYgIWFwcGxpY2F0aW9uSUQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkFsZ29saWFTZWFyY2hFcnJvcignUGxlYXNlIHByb3ZpZGUgYW4gYXBwbGljYXRpb24gSUQuICcgKyB1c2FnZSk7XG4gIH1cblxuICBpZiAob3B0cy5fYWxsb3dFbXB0eUNyZWRlbnRpYWxzICE9PSB0cnVlICYmICFhcGlLZXkpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkFsZ29saWFTZWFyY2hFcnJvcignUGxlYXNlIHByb3ZpZGUgYW4gQVBJIGtleS4gJyArIHVzYWdlKTtcbiAgfVxuXG4gIHRoaXMuYXBwbGljYXRpb25JRCA9IGFwcGxpY2F0aW9uSUQ7XG4gIHRoaXMuYXBpS2V5ID0gYXBpS2V5O1xuXG4gIHRoaXMuaG9zdHMgPSB7XG4gICAgcmVhZDogW10sXG4gICAgd3JpdGU6IFtdXG4gIH07XG5cbiAgb3B0cyA9IG9wdHMgfHwge307XG5cbiAgdGhpcy5fdGltZW91dHMgPSBvcHRzLnRpbWVvdXRzIHx8IHtcbiAgICBjb25uZWN0OiAxICogMTAwMCwgLy8gNTAwbXMgY29ubmVjdCBpcyBHUFJTIGxhdGVuY3lcbiAgICByZWFkOiAyICogMTAwMCxcbiAgICB3cml0ZTogMzAgKiAxMDAwXG4gIH07XG5cbiAgLy8gYmFja3dhcmQgY29tcGF0LCBpZiBvcHRzLnRpbWVvdXQgaXMgcGFzc2VkLCB3ZSB1c2UgaXQgdG8gY29uZmlndXJlIGFsbCB0aW1lb3V0cyBsaWtlIGJlZm9yZVxuICBpZiAob3B0cy50aW1lb3V0KSB7XG4gICAgdGhpcy5fdGltZW91dHMuY29ubmVjdCA9IHRoaXMuX3RpbWVvdXRzLnJlYWQgPSB0aGlzLl90aW1lb3V0cy53cml0ZSA9IG9wdHMudGltZW91dDtcbiAgfVxuXG4gIHZhciBwcm90b2NvbCA9IG9wdHMucHJvdG9jb2wgfHwgJ2h0dHBzOic7XG4gIC8vIHdoaWxlIHdlIGFkdm9jYXRlIGZvciBjb2xvbi1hdC10aGUtZW5kIHZhbHVlczogJ2h0dHA6JyBmb3IgYG9wdHMucHJvdG9jb2xgXG4gIC8vIHdlIGFsc28gYWNjZXB0IGBodHRwYCBhbmQgYGh0dHBzYC4gSXQncyBhIGNvbW1vbiBlcnJvci5cbiAgaWYgKCEvOiQvLnRlc3QocHJvdG9jb2wpKSB7XG4gICAgcHJvdG9jb2wgPSBwcm90b2NvbCArICc6JztcbiAgfVxuXG4gIGlmIChwcm90b2NvbCAhPT0gJ2h0dHA6JyAmJiBwcm90b2NvbCAhPT0gJ2h0dHBzOicpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkFsZ29saWFTZWFyY2hFcnJvcigncHJvdG9jb2wgbXVzdCBiZSBgaHR0cDpgIG9yIGBodHRwczpgICh3YXMgYCcgKyBvcHRzLnByb3RvY29sICsgJ2ApJyk7XG4gIH1cblxuICB0aGlzLl9jaGVja0FwcElkRGF0YSgpO1xuXG4gIGlmICghb3B0cy5ob3N0cykge1xuICAgIHZhciBkZWZhdWx0SG9zdHMgPSBtYXAodGhpcy5fc2h1ZmZsZVJlc3VsdCwgZnVuY3Rpb24oaG9zdE51bWJlcikge1xuICAgICAgcmV0dXJuIGFwcGxpY2F0aW9uSUQgKyAnLScgKyBob3N0TnVtYmVyICsgJy5hbGdvbGlhbmV0LmNvbSc7XG4gICAgfSk7XG5cbiAgICAvLyBubyBob3N0cyBnaXZlbiwgY29tcHV0ZSBkZWZhdWx0c1xuICAgIHZhciBtYWluU3VmZml4ID0gKG9wdHMuZHNuID09PSBmYWxzZSA/ICcnIDogJy1kc24nKSArICcuYWxnb2xpYS5uZXQnO1xuICAgIHRoaXMuaG9zdHMucmVhZCA9IFt0aGlzLmFwcGxpY2F0aW9uSUQgKyBtYWluU3VmZml4XS5jb25jYXQoZGVmYXVsdEhvc3RzKTtcbiAgICB0aGlzLmhvc3RzLndyaXRlID0gW3RoaXMuYXBwbGljYXRpb25JRCArICcuYWxnb2xpYS5uZXQnXS5jb25jYXQoZGVmYXVsdEhvc3RzKTtcbiAgfSBlbHNlIGlmIChpc0FycmF5KG9wdHMuaG9zdHMpKSB7XG4gICAgLy8gd2hlbiBwYXNzaW5nIGN1c3RvbSBob3N0cywgd2UgbmVlZCB0byBoYXZlIGEgZGlmZmVyZW50IGhvc3QgaW5kZXggaWYgdGhlIG51bWJlclxuICAgIC8vIG9mIHdyaXRlL3JlYWQgaG9zdHMgYXJlIGRpZmZlcmVudC5cbiAgICB0aGlzLmhvc3RzLnJlYWQgPSBjbG9uZShvcHRzLmhvc3RzKTtcbiAgICB0aGlzLmhvc3RzLndyaXRlID0gY2xvbmUob3B0cy5ob3N0cyk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5ob3N0cy5yZWFkID0gY2xvbmUob3B0cy5ob3N0cy5yZWFkKTtcbiAgICB0aGlzLmhvc3RzLndyaXRlID0gY2xvbmUob3B0cy5ob3N0cy53cml0ZSk7XG4gIH1cblxuICAvLyBhZGQgcHJvdG9jb2wgYW5kIGxvd2VyY2FzZSBob3N0c1xuICB0aGlzLmhvc3RzLnJlYWQgPSBtYXAodGhpcy5ob3N0cy5yZWFkLCBwcmVwYXJlSG9zdChwcm90b2NvbCkpO1xuICB0aGlzLmhvc3RzLndyaXRlID0gbWFwKHRoaXMuaG9zdHMud3JpdGUsIHByZXBhcmVIb3N0KHByb3RvY29sKSk7XG5cbiAgdGhpcy5leHRyYUhlYWRlcnMgPSB7fTtcblxuICAvLyBJbiBzb21lIHNpdHVhdGlvbnMgeW91IG1pZ2h0IHdhbnQgdG8gd2FybSB0aGUgY2FjaGVcbiAgdGhpcy5jYWNoZSA9IG9wdHMuX2NhY2hlIHx8IHt9O1xuXG4gIHRoaXMuX3VhID0gb3B0cy5fdWE7XG4gIHRoaXMuX3VzZUNhY2hlID0gb3B0cy5fdXNlQ2FjaGUgPT09IHVuZGVmaW5lZCB8fCBvcHRzLl9jYWNoZSA/IHRydWUgOiBvcHRzLl91c2VDYWNoZTtcbiAgdGhpcy5fdXNlUmVxdWVzdENhY2hlID0gdGhpcy5fdXNlQ2FjaGUgJiYgb3B0cy5fdXNlUmVxdWVzdENhY2hlO1xuICB0aGlzLl91c2VGYWxsYmFjayA9IG9wdHMudXNlRmFsbGJhY2sgPT09IHVuZGVmaW5lZCA/IHRydWUgOiBvcHRzLnVzZUZhbGxiYWNrO1xuXG4gIHRoaXMuX3NldFRpbWVvdXQgPSBvcHRzLl9zZXRUaW1lb3V0O1xuXG4gIGRlYnVnKCdpbml0IGRvbmUsICVqJywgdGhpcyk7XG59XG5cbi8qXG4gKiBHZXQgdGhlIGluZGV4IG9iamVjdCBpbml0aWFsaXplZFxuICpcbiAqIEBwYXJhbSBpbmRleE5hbWUgdGhlIG5hbWUgb2YgaW5kZXhcbiAqIEBwYXJhbSBjYWxsYmFjayB0aGUgcmVzdWx0IGNhbGxiYWNrIHdpdGggb25lIGFyZ3VtZW50ICh0aGUgSW5kZXggaW5zdGFuY2UpXG4gKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5pbml0SW5kZXggPSBmdW5jdGlvbihpbmRleE5hbWUpIHtcbiAgcmV0dXJuIG5ldyBJbmRleENvcmUodGhpcywgaW5kZXhOYW1lKTtcbn07XG5cbi8qKlxuKiBBZGQgYW4gZXh0cmEgZmllbGQgdG8gdGhlIEhUVFAgcmVxdWVzdFxuKlxuKiBAcGFyYW0gbmFtZSB0aGUgaGVhZGVyIGZpZWxkIG5hbWVcbiogQHBhcmFtIHZhbHVlIHRoZSBoZWFkZXIgZmllbGQgdmFsdWVcbiovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuc2V0RXh0cmFIZWFkZXIgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICB0aGlzLmV4dHJhSGVhZGVyc1tuYW1lLnRvTG93ZXJDYXNlKCldID0gdmFsdWU7XG59O1xuXG4vKipcbiogR2V0IHRoZSB2YWx1ZSBvZiBhbiBleHRyYSBIVFRQIGhlYWRlclxuKlxuKiBAcGFyYW0gbmFtZSB0aGUgaGVhZGVyIGZpZWxkIG5hbWVcbiovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuZ2V0RXh0cmFIZWFkZXIgPSBmdW5jdGlvbihuYW1lKSB7XG4gIHJldHVybiB0aGlzLmV4dHJhSGVhZGVyc1tuYW1lLnRvTG93ZXJDYXNlKCldO1xufTtcblxuLyoqXG4qIFJlbW92ZSBhbiBleHRyYSBmaWVsZCBmcm9tIHRoZSBIVFRQIHJlcXVlc3RcbipcbiogQHBhcmFtIG5hbWUgdGhlIGhlYWRlciBmaWVsZCBuYW1lXG4qL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLnVuc2V0RXh0cmFIZWFkZXIgPSBmdW5jdGlvbihuYW1lKSB7XG4gIGRlbGV0ZSB0aGlzLmV4dHJhSGVhZGVyc1tuYW1lLnRvTG93ZXJDYXNlKCldO1xufTtcblxuLyoqXG4qIEF1Z21lbnQgc2VudCB4LWFsZ29saWEtYWdlbnQgd2l0aCBtb3JlIGRhdGEsIGVhY2ggYWdlbnQgcGFydFxuKiBpcyBhdXRvbWF0aWNhbGx5IHNlcGFyYXRlZCBmcm9tIHRoZSBvdGhlcnMgYnkgYSBzZW1pY29sb247XG4qXG4qIEBwYXJhbSBhbGdvbGlhQWdlbnQgdGhlIGFnZW50IHRvIGFkZFxuKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5hZGRBbGdvbGlhQWdlbnQgPSBmdW5jdGlvbihhbGdvbGlhQWdlbnQpIHtcbiAgaWYgKHRoaXMuX3VhLmluZGV4T2YoJzsnICsgYWxnb2xpYUFnZW50KSA9PT0gLTEpIHtcbiAgICB0aGlzLl91YSArPSAnOycgKyBhbGdvbGlhQWdlbnQ7XG4gIH1cbn07XG5cbi8qXG4gKiBXcmFwcGVyIHRoYXQgdHJ5IGFsbCBob3N0cyB0byBtYXhpbWl6ZSB0aGUgcXVhbGl0eSBvZiBzZXJ2aWNlXG4gKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fanNvblJlcXVlc3QgPSBmdW5jdGlvbihpbml0aWFsT3B0cykge1xuICB0aGlzLl9jaGVja0FwcElkRGF0YSgpO1xuXG4gIHZhciByZXF1ZXN0RGVidWcgPSByZXF1aXJlKCdkZWJ1ZycpKCdhbGdvbGlhc2VhcmNoOicgKyBpbml0aWFsT3B0cy51cmwpO1xuXG5cbiAgdmFyIGJvZHk7XG4gIHZhciBjYWNoZUlEO1xuICB2YXIgYWRkaXRpb25hbFVBID0gaW5pdGlhbE9wdHMuYWRkaXRpb25hbFVBIHx8ICcnO1xuICB2YXIgY2FjaGUgPSBpbml0aWFsT3B0cy5jYWNoZTtcbiAgdmFyIGNsaWVudCA9IHRoaXM7XG4gIHZhciB0cmllcyA9IDA7XG4gIHZhciB1c2luZ0ZhbGxiYWNrID0gZmFsc2U7XG4gIHZhciBoYXNGYWxsYmFjayA9IGNsaWVudC5fdXNlRmFsbGJhY2sgJiYgY2xpZW50Ll9yZXF1ZXN0LmZhbGxiYWNrICYmIGluaXRpYWxPcHRzLmZhbGxiYWNrO1xuICB2YXIgaGVhZGVycztcblxuICBpZiAoXG4gICAgdGhpcy5hcGlLZXkubGVuZ3RoID4gTUFYX0FQSV9LRVlfTEVOR1RIICYmXG4gICAgaW5pdGlhbE9wdHMuYm9keSAhPT0gdW5kZWZpbmVkICYmXG4gICAgKGluaXRpYWxPcHRzLmJvZHkucGFyYW1zICE9PSB1bmRlZmluZWQgfHwgLy8gaW5kZXguc2VhcmNoKClcbiAgICBpbml0aWFsT3B0cy5ib2R5LnJlcXVlc3RzICE9PSB1bmRlZmluZWQpIC8vIGNsaWVudC5zZWFyY2goKVxuICApIHtcbiAgICBpbml0aWFsT3B0cy5ib2R5LmFwaUtleSA9IHRoaXMuYXBpS2V5O1xuICAgIGhlYWRlcnMgPSB0aGlzLl9jb21wdXRlUmVxdWVzdEhlYWRlcnMoe1xuICAgICAgYWRkaXRpb25hbFVBOiBhZGRpdGlvbmFsVUEsXG4gICAgICB3aXRoQXBpS2V5OiBmYWxzZSxcbiAgICAgIGhlYWRlcnM6IGluaXRpYWxPcHRzLmhlYWRlcnNcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0gdGhpcy5fY29tcHV0ZVJlcXVlc3RIZWFkZXJzKHtcbiAgICAgIGFkZGl0aW9uYWxVQTogYWRkaXRpb25hbFVBLFxuICAgICAgaGVhZGVyczogaW5pdGlhbE9wdHMuaGVhZGVyc1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKGluaXRpYWxPcHRzLmJvZHkgIT09IHVuZGVmaW5lZCkge1xuICAgIGJvZHkgPSBzYWZlSlNPTlN0cmluZ2lmeShpbml0aWFsT3B0cy5ib2R5KTtcbiAgfVxuXG4gIHJlcXVlc3REZWJ1ZygncmVxdWVzdCBzdGFydCcpO1xuICB2YXIgZGVidWdEYXRhID0gW107XG5cblxuICBmdW5jdGlvbiBkb1JlcXVlc3QocmVxdWVzdGVyLCByZXFPcHRzKSB7XG4gICAgY2xpZW50Ll9jaGVja0FwcElkRGF0YSgpO1xuXG4gICAgdmFyIHN0YXJ0VGltZSA9IG5ldyBEYXRlKCk7XG5cbiAgICBpZiAoY2xpZW50Ll91c2VDYWNoZSAmJiAhY2xpZW50Ll91c2VSZXF1ZXN0Q2FjaGUpIHtcbiAgICAgIGNhY2hlSUQgPSBpbml0aWFsT3B0cy51cmw7XG4gICAgfVxuXG4gICAgLy8gYXMgd2Ugc29tZXRpbWUgdXNlIFBPU1QgcmVxdWVzdHMgdG8gcGFzcyBwYXJhbWV0ZXJzIChsaWtlIHF1ZXJ5PSdhYScpLFxuICAgIC8vIHRoZSBjYWNoZUlEIG11c3QgYWxzbyBpbmNsdWRlIHRoZSBib2R5IHRvIGJlIGRpZmZlcmVudCBiZXR3ZWVuIGNhbGxzXG4gICAgaWYgKGNsaWVudC5fdXNlQ2FjaGUgJiYgIWNsaWVudC5fdXNlUmVxdWVzdENhY2hlICYmIGJvZHkpIHtcbiAgICAgIGNhY2hlSUQgKz0gJ19ib2R5XycgKyByZXFPcHRzLmJvZHk7XG4gICAgfVxuXG4gICAgLy8gaGFuZGxlIGNhY2hlIGV4aXN0ZW5jZVxuICAgIGlmIChpc0NhY2hlVmFsaWRXaXRoQ3VycmVudElEKCFjbGllbnQuX3VzZVJlcXVlc3RDYWNoZSwgY2FjaGUsIGNhY2hlSUQpKSB7XG4gICAgICByZXF1ZXN0RGVidWcoJ3NlcnZpbmcgcmVzcG9uc2UgZnJvbSBjYWNoZScpO1xuXG4gICAgICB2YXIgcmVzcG9uc2VUZXh0ID0gY2FjaGVbY2FjaGVJRF07XG5cbiAgICAgIC8vIENhY2hlIHJlc3BvbnNlIG11c3QgbWF0Y2ggdGhlIHR5cGUgb2YgdGhlIG9yaWdpbmFsIG9uZVxuICAgICAgcmV0dXJuIGNsaWVudC5fcHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgYm9keTogSlNPTi5wYXJzZShyZXNwb25zZVRleHQpLFxuICAgICAgICByZXNwb25zZVRleHQ6IHJlc3BvbnNlVGV4dFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gaWYgd2UgcmVhY2hlZCBtYXggdHJpZXNcbiAgICBpZiAodHJpZXMgPj0gY2xpZW50Lmhvc3RzW2luaXRpYWxPcHRzLmhvc3RUeXBlXS5sZW5ndGgpIHtcbiAgICAgIGlmICghaGFzRmFsbGJhY2sgfHwgdXNpbmdGYWxsYmFjaykge1xuICAgICAgICByZXF1ZXN0RGVidWcoJ2NvdWxkIG5vdCBnZXQgYW55IHJlc3BvbnNlJyk7XG4gICAgICAgIC8vIHRoZW4gc3RvcFxuICAgICAgICByZXR1cm4gY2xpZW50Ll9wcm9taXNlLnJlamVjdChuZXcgZXJyb3JzLkFsZ29saWFTZWFyY2hFcnJvcihcbiAgICAgICAgICAnQ2Fubm90IGNvbm5lY3QgdG8gdGhlIEFsZ29saWFTZWFyY2ggQVBJLicgK1xuICAgICAgICAgICcgU2VuZCBhbiBlbWFpbCB0byBzdXBwb3J0QGFsZ29saWEuY29tIHRvIHJlcG9ydCBhbmQgcmVzb2x2ZSB0aGUgaXNzdWUuJyArXG4gICAgICAgICAgJyBBcHBsaWNhdGlvbiBpZCB3YXM6ICcgKyBjbGllbnQuYXBwbGljYXRpb25JRCwge2RlYnVnRGF0YTogZGVidWdEYXRhfVxuICAgICAgICApKTtcbiAgICAgIH1cblxuICAgICAgcmVxdWVzdERlYnVnKCdzd2l0Y2hpbmcgdG8gZmFsbGJhY2snKTtcblxuICAgICAgLy8gbGV0J3MgdHJ5IHRoZSBmYWxsYmFjayBzdGFydGluZyBmcm9tIGhlcmVcbiAgICAgIHRyaWVzID0gMDtcblxuICAgICAgLy8gbWV0aG9kLCB1cmwgYW5kIGJvZHkgYXJlIGZhbGxiYWNrIGRlcGVuZGVudFxuICAgICAgcmVxT3B0cy5tZXRob2QgPSBpbml0aWFsT3B0cy5mYWxsYmFjay5tZXRob2Q7XG4gICAgICByZXFPcHRzLnVybCA9IGluaXRpYWxPcHRzLmZhbGxiYWNrLnVybDtcbiAgICAgIHJlcU9wdHMuanNvbkJvZHkgPSBpbml0aWFsT3B0cy5mYWxsYmFjay5ib2R5O1xuICAgICAgaWYgKHJlcU9wdHMuanNvbkJvZHkpIHtcbiAgICAgICAgcmVxT3B0cy5ib2R5ID0gc2FmZUpTT05TdHJpbmdpZnkocmVxT3B0cy5qc29uQm9keSk7XG4gICAgICB9XG4gICAgICAvLyByZS1jb21wdXRlIGhlYWRlcnMsIHRoZXkgY291bGQgYmUgb21pdHRpbmcgdGhlIEFQSSBLRVlcbiAgICAgIGhlYWRlcnMgPSBjbGllbnQuX2NvbXB1dGVSZXF1ZXN0SGVhZGVycyh7XG4gICAgICAgIGFkZGl0aW9uYWxVQTogYWRkaXRpb25hbFVBLFxuICAgICAgICBoZWFkZXJzOiBpbml0aWFsT3B0cy5oZWFkZXJzXG4gICAgICB9KTtcblxuICAgICAgcmVxT3B0cy50aW1lb3V0cyA9IGNsaWVudC5fZ2V0VGltZW91dHNGb3JSZXF1ZXN0KGluaXRpYWxPcHRzLmhvc3RUeXBlKTtcbiAgICAgIGNsaWVudC5fc2V0SG9zdEluZGV4QnlUeXBlKDAsIGluaXRpYWxPcHRzLmhvc3RUeXBlKTtcbiAgICAgIHVzaW5nRmFsbGJhY2sgPSB0cnVlOyAvLyB0aGUgY3VycmVudCByZXF1ZXN0IGlzIG5vdyB1c2luZyBmYWxsYmFja1xuICAgICAgcmV0dXJuIGRvUmVxdWVzdChjbGllbnQuX3JlcXVlc3QuZmFsbGJhY2ssIHJlcU9wdHMpO1xuICAgIH1cblxuICAgIHZhciBjdXJyZW50SG9zdCA9IGNsaWVudC5fZ2V0SG9zdEJ5VHlwZShpbml0aWFsT3B0cy5ob3N0VHlwZSk7XG5cbiAgICB2YXIgdXJsID0gY3VycmVudEhvc3QgKyByZXFPcHRzLnVybDtcbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgIGJvZHk6IHJlcU9wdHMuYm9keSxcbiAgICAgIGpzb25Cb2R5OiByZXFPcHRzLmpzb25Cb2R5LFxuICAgICAgbWV0aG9kOiByZXFPcHRzLm1ldGhvZCxcbiAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICB0aW1lb3V0czogcmVxT3B0cy50aW1lb3V0cyxcbiAgICAgIGRlYnVnOiByZXF1ZXN0RGVidWcsXG4gICAgICBmb3JjZUF1dGhIZWFkZXJzOiByZXFPcHRzLmZvcmNlQXV0aEhlYWRlcnNcbiAgICB9O1xuXG4gICAgcmVxdWVzdERlYnVnKCdtZXRob2Q6ICVzLCB1cmw6ICVzLCBoZWFkZXJzOiAlaiwgdGltZW91dHM6ICVkJyxcbiAgICAgIG9wdGlvbnMubWV0aG9kLCB1cmwsIG9wdGlvbnMuaGVhZGVycywgb3B0aW9ucy50aW1lb3V0cyk7XG5cbiAgICBpZiAocmVxdWVzdGVyID09PSBjbGllbnQuX3JlcXVlc3QuZmFsbGJhY2spIHtcbiAgICAgIHJlcXVlc3REZWJ1ZygndXNpbmcgZmFsbGJhY2snKTtcbiAgICB9XG5cbiAgICAvLyBgcmVxdWVzdGVyYCBpcyBhbnkgb2YgdGhpcy5fcmVxdWVzdCBvciB0aGlzLl9yZXF1ZXN0LmZhbGxiYWNrXG4gICAgLy8gdGh1cyBpdCBuZWVkcyB0byBiZSBjYWxsZWQgdXNpbmcgdGhlIGNsaWVudCBhcyBjb250ZXh0XG4gICAgcmV0dXJuIHJlcXVlc3Rlci5jYWxsKGNsaWVudCwgdXJsLCBvcHRpb25zKS50aGVuKHN1Y2Nlc3MsIHRyeUZhbGxiYWNrKTtcblxuICAgIGZ1bmN0aW9uIHN1Y2Nlc3MoaHR0cFJlc3BvbnNlKSB7XG4gICAgICAvLyBjb21wdXRlIHRoZSBzdGF0dXMgb2YgdGhlIHJlc3BvbnNlLFxuICAgICAgLy9cbiAgICAgIC8vIFdoZW4gaW4gYnJvd3NlciBtb2RlLCB1c2luZyBYRFIgb3IgSlNPTlAsIHdlIGhhdmUgbm8gc3RhdHVzQ29kZSBhdmFpbGFibGVcbiAgICAgIC8vIFNvIHdlIHJlbHkgb24gb3VyIEFQSSByZXNwb25zZSBgc3RhdHVzYCBwcm9wZXJ0eS5cbiAgICAgIC8vIEJ1dCBgd2FpdFRhc2tgIGNhbiBzZXQgYSBgc3RhdHVzYCBwcm9wZXJ0eSB3aGljaCBpcyBub3QgdGhlIHN0YXR1c0NvZGUgKGl0J3MgdGhlIHRhc2sgc3RhdHVzKVxuICAgICAgLy8gU28gd2UgY2hlY2sgaWYgdGhlcmUncyBhIGBtZXNzYWdlYCBhbG9uZyBgc3RhdHVzYCBhbmQgaXQgbWVhbnMgaXQncyBhbiBlcnJvclxuICAgICAgLy9cbiAgICAgIC8vIFRoYXQncyB0aGUgb25seSBjYXNlIHdoZXJlIHdlIGhhdmUgYSByZXNwb25zZS5zdGF0dXMgdGhhdCdzIG5vdCB0aGUgaHR0cCBzdGF0dXNDb2RlXG4gICAgICB2YXIgc3RhdHVzID0gaHR0cFJlc3BvbnNlICYmIGh0dHBSZXNwb25zZS5ib2R5ICYmIGh0dHBSZXNwb25zZS5ib2R5Lm1lc3NhZ2UgJiYgaHR0cFJlc3BvbnNlLmJvZHkuc3RhdHVzIHx8XG5cbiAgICAgICAgLy8gdGhpcyBpcyBpbXBvcnRhbnQgdG8gY2hlY2sgdGhlIHJlcXVlc3Qgc3RhdHVzQ29kZSBBRlRFUiB0aGUgYm9keSBldmVudHVhbFxuICAgICAgICAvLyBzdGF0dXNDb2RlIGJlY2F1c2Ugc29tZSBpbXBsZW1lbnRhdGlvbnMgKGpRdWVyeSBYRG9tYWluUmVxdWVzdCB0cmFuc3BvcnQpIG1heVxuICAgICAgICAvLyBzZW5kIHN0YXR1c0NvZGUgMjAwIHdoaWxlIHdlIGhhZCBhbiBlcnJvclxuICAgICAgICBodHRwUmVzcG9uc2Uuc3RhdHVzQ29kZSB8fFxuXG4gICAgICAgIC8vIFdoZW4gaW4gYnJvd3NlciBtb2RlLCB1c2luZyBYRFIgb3IgSlNPTlBcbiAgICAgICAgLy8gd2UgZGVmYXVsdCB0byBzdWNjZXNzIHdoZW4gbm8gZXJyb3IgKG5vIHJlc3BvbnNlLnN0YXR1cyAmJiByZXNwb25zZS5tZXNzYWdlKVxuICAgICAgICAvLyBJZiB0aGVyZSB3YXMgYSBKU09OLnBhcnNlKCkgZXJyb3IgdGhlbiBib2R5IGlzIG51bGwgYW5kIGl0IGZhaWxzXG4gICAgICAgIGh0dHBSZXNwb25zZSAmJiBodHRwUmVzcG9uc2UuYm9keSAmJiAyMDA7XG5cbiAgICAgIHJlcXVlc3REZWJ1ZygncmVjZWl2ZWQgcmVzcG9uc2U6IHN0YXR1c0NvZGU6ICVzLCBjb21wdXRlZCBzdGF0dXNDb2RlOiAlZCwgaGVhZGVyczogJWonLFxuICAgICAgICBodHRwUmVzcG9uc2Uuc3RhdHVzQ29kZSwgc3RhdHVzLCBodHRwUmVzcG9uc2UuaGVhZGVycyk7XG5cbiAgICAgIHZhciBodHRwUmVzcG9uc2VPayA9IE1hdGguZmxvb3Ioc3RhdHVzIC8gMTAwKSA9PT0gMjtcblxuICAgICAgdmFyIGVuZFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgICAgZGVidWdEYXRhLnB1c2goe1xuICAgICAgICBjdXJyZW50SG9zdDogY3VycmVudEhvc3QsXG4gICAgICAgIGhlYWRlcnM6IHJlbW92ZUNyZWRlbnRpYWxzKGhlYWRlcnMpLFxuICAgICAgICBjb250ZW50OiBib2R5IHx8IG51bGwsXG4gICAgICAgIGNvbnRlbnRMZW5ndGg6IGJvZHkgIT09IHVuZGVmaW5lZCA/IGJvZHkubGVuZ3RoIDogbnVsbCxcbiAgICAgICAgbWV0aG9kOiByZXFPcHRzLm1ldGhvZCxcbiAgICAgICAgdGltZW91dHM6IHJlcU9wdHMudGltZW91dHMsXG4gICAgICAgIHVybDogcmVxT3B0cy51cmwsXG4gICAgICAgIHN0YXJ0VGltZTogc3RhcnRUaW1lLFxuICAgICAgICBlbmRUaW1lOiBlbmRUaW1lLFxuICAgICAgICBkdXJhdGlvbjogZW5kVGltZSAtIHN0YXJ0VGltZSxcbiAgICAgICAgc3RhdHVzQ29kZTogc3RhdHVzXG4gICAgICB9KTtcblxuICAgICAgaWYgKGh0dHBSZXNwb25zZU9rKSB7XG4gICAgICAgIGlmIChjbGllbnQuX3VzZUNhY2hlICYmICFjbGllbnQuX3VzZVJlcXVlc3RDYWNoZSAmJiBjYWNoZSkge1xuICAgICAgICAgIGNhY2hlW2NhY2hlSURdID0gaHR0cFJlc3BvbnNlLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVzcG9uc2VUZXh0OiBodHRwUmVzcG9uc2UucmVzcG9uc2VUZXh0LFxuICAgICAgICAgIGJvZHk6IGh0dHBSZXNwb25zZS5ib2R5XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHZhciBzaG91bGRSZXRyeSA9IE1hdGguZmxvb3Ioc3RhdHVzIC8gMTAwKSAhPT0gNDtcblxuICAgICAgaWYgKHNob3VsZFJldHJ5KSB7XG4gICAgICAgIHRyaWVzICs9IDE7XG4gICAgICAgIHJldHVybiByZXRyeVJlcXVlc3QoKTtcbiAgICAgIH1cblxuICAgICAgcmVxdWVzdERlYnVnKCd1bnJlY292ZXJhYmxlIGVycm9yJyk7XG5cbiAgICAgIC8vIG5vIHN1Y2Nlc3MgYW5kIG5vIHJldHJ5ID0+IGZhaWxcbiAgICAgIHZhciB1bnJlY292ZXJhYmxlRXJyb3IgPSBuZXcgZXJyb3JzLkFsZ29saWFTZWFyY2hFcnJvcihcbiAgICAgICAgaHR0cFJlc3BvbnNlLmJvZHkgJiYgaHR0cFJlc3BvbnNlLmJvZHkubWVzc2FnZSwge2RlYnVnRGF0YTogZGVidWdEYXRhLCBzdGF0dXNDb2RlOiBzdGF0dXN9XG4gICAgICApO1xuXG4gICAgICByZXR1cm4gY2xpZW50Ll9wcm9taXNlLnJlamVjdCh1bnJlY292ZXJhYmxlRXJyb3IpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRyeUZhbGxiYWNrKGVycikge1xuICAgICAgLy8gZXJyb3IgY2FzZXM6XG4gICAgICAvLyAgV2hpbGUgbm90IGluIGZhbGxiYWNrIG1vZGU6XG4gICAgICAvLyAgICAtIENPUlMgbm90IHN1cHBvcnRlZFxuICAgICAgLy8gICAgLSBuZXR3b3JrIGVycm9yXG4gICAgICAvLyAgV2hpbGUgaW4gZmFsbGJhY2sgbW9kZTpcbiAgICAgIC8vICAgIC0gdGltZW91dFxuICAgICAgLy8gICAgLSBuZXR3b3JrIGVycm9yXG4gICAgICAvLyAgICAtIGJhZGx5IGZvcm1hdHRlZCBKU09OUCAoc2NyaXB0IGxvYWRlZCwgZGlkIG5vdCBjYWxsIG91ciBjYWxsYmFjaylcbiAgICAgIC8vICBJbiBib3RoIGNhc2VzOlxuICAgICAgLy8gICAgLSB1bmNhdWdodCBleGNlcHRpb24gb2NjdXJzIChUeXBlRXJyb3IpXG4gICAgICByZXF1ZXN0RGVidWcoJ2Vycm9yOiAlcywgc3RhY2s6ICVzJywgZXJyLm1lc3NhZ2UsIGVyci5zdGFjayk7XG5cbiAgICAgIHZhciBlbmRUaW1lID0gbmV3IERhdGUoKTtcbiAgICAgIGRlYnVnRGF0YS5wdXNoKHtcbiAgICAgICAgY3VycmVudEhvc3Q6IGN1cnJlbnRIb3N0LFxuICAgICAgICBoZWFkZXJzOiByZW1vdmVDcmVkZW50aWFscyhoZWFkZXJzKSxcbiAgICAgICAgY29udGVudDogYm9keSB8fCBudWxsLFxuICAgICAgICBjb250ZW50TGVuZ3RoOiBib2R5ICE9PSB1bmRlZmluZWQgPyBib2R5Lmxlbmd0aCA6IG51bGwsXG4gICAgICAgIG1ldGhvZDogcmVxT3B0cy5tZXRob2QsXG4gICAgICAgIHRpbWVvdXRzOiByZXFPcHRzLnRpbWVvdXRzLFxuICAgICAgICB1cmw6IHJlcU9wdHMudXJsLFxuICAgICAgICBzdGFydFRpbWU6IHN0YXJ0VGltZSxcbiAgICAgICAgZW5kVGltZTogZW5kVGltZSxcbiAgICAgICAgZHVyYXRpb246IGVuZFRpbWUgLSBzdGFydFRpbWVcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBlcnJvcnMuQWxnb2xpYVNlYXJjaEVycm9yKSkge1xuICAgICAgICBlcnIgPSBuZXcgZXJyb3JzLlVua25vd24oZXJyICYmIGVyci5tZXNzYWdlLCBlcnIpO1xuICAgICAgfVxuXG4gICAgICB0cmllcyArPSAxO1xuXG4gICAgICAvLyBzdG9wIHRoZSByZXF1ZXN0IGltcGxlbWVudGF0aW9uIHdoZW46XG4gICAgICBpZiAoXG4gICAgICAgIC8vIHdlIGRpZCBub3QgZ2VuZXJhdGUgdGhpcyBlcnJvcixcbiAgICAgICAgLy8gaXQgY29tZXMgZnJvbSBhIHRocm93IGluIHNvbWUgb3RoZXIgcGllY2Ugb2YgY29kZVxuICAgICAgICBlcnIgaW5zdGFuY2VvZiBlcnJvcnMuVW5rbm93biB8fFxuXG4gICAgICAgIC8vIHNlcnZlciBzZW50IHVucGFyc2FibGUgSlNPTlxuICAgICAgICBlcnIgaW5zdGFuY2VvZiBlcnJvcnMuVW5wYXJzYWJsZUpTT04gfHxcblxuICAgICAgICAvLyBtYXggdHJpZXMgYW5kIGFscmVhZHkgdXNpbmcgZmFsbGJhY2sgb3Igbm8gZmFsbGJhY2tcbiAgICAgICAgdHJpZXMgPj0gY2xpZW50Lmhvc3RzW2luaXRpYWxPcHRzLmhvc3RUeXBlXS5sZW5ndGggJiZcbiAgICAgICAgKHVzaW5nRmFsbGJhY2sgfHwgIWhhc0ZhbGxiYWNrKSkge1xuICAgICAgICAvLyBzdG9wIHJlcXVlc3QgaW1wbGVtZW50YXRpb24gZm9yIHRoaXMgY29tbWFuZFxuICAgICAgICBlcnIuZGVidWdEYXRhID0gZGVidWdEYXRhO1xuICAgICAgICByZXR1cm4gY2xpZW50Ll9wcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgfVxuXG4gICAgICAvLyBXaGVuIGEgdGltZW91dCBvY2N1cmVkLCByZXRyeSBieSByYWlzaW5nIHRpbWVvdXRcbiAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBlcnJvcnMuUmVxdWVzdFRpbWVvdXQpIHtcbiAgICAgICAgcmV0dXJuIHJldHJ5UmVxdWVzdFdpdGhIaWdoZXJUaW1lb3V0KCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXRyeVJlcXVlc3QoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXRyeVJlcXVlc3QoKSB7XG4gICAgICByZXF1ZXN0RGVidWcoJ3JldHJ5aW5nIHJlcXVlc3QnKTtcbiAgICAgIGNsaWVudC5faW5jcmVtZW50SG9zdEluZGV4KGluaXRpYWxPcHRzLmhvc3RUeXBlKTtcbiAgICAgIHJldHVybiBkb1JlcXVlc3QocmVxdWVzdGVyLCByZXFPcHRzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXRyeVJlcXVlc3RXaXRoSGlnaGVyVGltZW91dCgpIHtcbiAgICAgIHJlcXVlc3REZWJ1ZygncmV0cnlpbmcgcmVxdWVzdCB3aXRoIGhpZ2hlciB0aW1lb3V0Jyk7XG4gICAgICBjbGllbnQuX2luY3JlbWVudEhvc3RJbmRleChpbml0aWFsT3B0cy5ob3N0VHlwZSk7XG4gICAgICBjbGllbnQuX2luY3JlbWVudFRpbWVvdXRNdWx0aXBsZXIoKTtcbiAgICAgIHJlcU9wdHMudGltZW91dHMgPSBjbGllbnQuX2dldFRpbWVvdXRzRm9yUmVxdWVzdChpbml0aWFsT3B0cy5ob3N0VHlwZSk7XG4gICAgICByZXR1cm4gZG9SZXF1ZXN0KHJlcXVlc3RlciwgcmVxT3B0cyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaXNDYWNoZVZhbGlkV2l0aEN1cnJlbnRJRChcbiAgICB1c2VSZXF1ZXN0Q2FjaGUsXG4gICAgY3VycmVudENhY2hlLFxuICAgIGN1cnJlbnRDYWNoZUlEXG4gICkge1xuICAgIHJldHVybiAoXG4gICAgICBjbGllbnQuX3VzZUNhY2hlICYmXG4gICAgICB1c2VSZXF1ZXN0Q2FjaGUgJiZcbiAgICAgIGN1cnJlbnRDYWNoZSAmJlxuICAgICAgY3VycmVudENhY2hlW2N1cnJlbnRDYWNoZUlEXSAhPT0gdW5kZWZpbmVkXG4gICAgKTtcbiAgfVxuXG5cbiAgZnVuY3Rpb24gaW50ZXJvcENhbGxiYWNrUmV0dXJuKHJlcXVlc3QsIGNhbGxiYWNrKSB7XG4gICAgaWYgKGlzQ2FjaGVWYWxpZFdpdGhDdXJyZW50SUQoY2xpZW50Ll91c2VSZXF1ZXN0Q2FjaGUsIGNhY2hlLCBjYWNoZUlEKSkge1xuICAgICAgcmVxdWVzdC5jYXRjaChmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gUmVsZWFzZSB0aGUgY2FjaGUgb24gZXJyb3JcbiAgICAgICAgZGVsZXRlIGNhY2hlW2NhY2hlSURdO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBpbml0aWFsT3B0cy5jYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gZWl0aGVyIHdlIGhhdmUgYSBjYWxsYmFja1xuICAgICAgcmVxdWVzdC50aGVuKGZ1bmN0aW9uIG9rQ2IoY29udGVudCkge1xuICAgICAgICBleGl0UHJvbWlzZShmdW5jdGlvbigpIHtcbiAgICAgICAgICBpbml0aWFsT3B0cy5jYWxsYmFjayhudWxsLCBjYWxsYmFjayhjb250ZW50KSk7XG4gICAgICAgIH0sIGNsaWVudC5fc2V0VGltZW91dCB8fCBzZXRUaW1lb3V0KTtcbiAgICAgIH0sIGZ1bmN0aW9uIG5vb2tDYihlcnIpIHtcbiAgICAgICAgZXhpdFByb21pc2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaW5pdGlhbE9wdHMuY2FsbGJhY2soZXJyKTtcbiAgICAgICAgfSwgY2xpZW50Ll9zZXRUaW1lb3V0IHx8IHNldFRpbWVvdXQpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGVpdGhlciB3ZSBhcmUgdXNpbmcgcHJvbWlzZXNcbiAgICAgIHJldHVybiByZXF1ZXN0LnRoZW4oY2FsbGJhY2spO1xuICAgIH1cbiAgfVxuXG4gIGlmIChjbGllbnQuX3VzZUNhY2hlICYmIGNsaWVudC5fdXNlUmVxdWVzdENhY2hlKSB7XG4gICAgY2FjaGVJRCA9IGluaXRpYWxPcHRzLnVybDtcbiAgfVxuXG4gIC8vIGFzIHdlIHNvbWV0aW1lIHVzZSBQT1NUIHJlcXVlc3RzIHRvIHBhc3MgcGFyYW1ldGVycyAobGlrZSBxdWVyeT0nYWEnKSxcbiAgLy8gdGhlIGNhY2hlSUQgbXVzdCBhbHNvIGluY2x1ZGUgdGhlIGJvZHkgdG8gYmUgZGlmZmVyZW50IGJldHdlZW4gY2FsbHNcbiAgaWYgKGNsaWVudC5fdXNlQ2FjaGUgJiYgY2xpZW50Ll91c2VSZXF1ZXN0Q2FjaGUgJiYgYm9keSkge1xuICAgIGNhY2hlSUQgKz0gJ19ib2R5XycgKyBib2R5O1xuICB9XG5cbiAgaWYgKGlzQ2FjaGVWYWxpZFdpdGhDdXJyZW50SUQoY2xpZW50Ll91c2VSZXF1ZXN0Q2FjaGUsIGNhY2hlLCBjYWNoZUlEKSkge1xuICAgIHJlcXVlc3REZWJ1Zygnc2VydmluZyByZXF1ZXN0IGZyb20gY2FjaGUnKTtcblxuICAgIHZhciBtYXliZVByb21pc2VGb3JDYWNoZSA9IGNhY2hlW2NhY2hlSURdO1xuXG4gICAgLy8gSW4gY2FzZSB0aGUgY2FjaGUgaXMgd2FybXVwIHdpdGggdmFsdWUgdGhhdCBpcyBub3QgYSBwcm9taXNlXG4gICAgdmFyIHByb21pc2VGb3JDYWNoZSA9IHR5cGVvZiBtYXliZVByb21pc2VGb3JDYWNoZS50aGVuICE9PSAnZnVuY3Rpb24nXG4gICAgICA/IGNsaWVudC5fcHJvbWlzZS5yZXNvbHZlKHtyZXNwb25zZVRleHQ6IG1heWJlUHJvbWlzZUZvckNhY2hlfSlcbiAgICAgIDogbWF5YmVQcm9taXNlRm9yQ2FjaGU7XG5cbiAgICByZXR1cm4gaW50ZXJvcENhbGxiYWNrUmV0dXJuKHByb21pc2VGb3JDYWNoZSwgZnVuY3Rpb24oY29udGVudCkge1xuICAgICAgLy8gSW4gY2FzZSBvZiB0aGUgY2FjaGUgcmVxdWVzdCwgcmV0dXJuIHRoZSBvcmlnaW5hbCB2YWx1ZVxuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoY29udGVudC5yZXNwb25zZVRleHQpO1xuICAgIH0pO1xuICB9XG5cbiAgdmFyIHJlcXVlc3QgPSBkb1JlcXVlc3QoXG4gICAgY2xpZW50Ll9yZXF1ZXN0LCB7XG4gICAgICB1cmw6IGluaXRpYWxPcHRzLnVybCxcbiAgICAgIG1ldGhvZDogaW5pdGlhbE9wdHMubWV0aG9kLFxuICAgICAgYm9keTogYm9keSxcbiAgICAgIGpzb25Cb2R5OiBpbml0aWFsT3B0cy5ib2R5LFxuICAgICAgdGltZW91dHM6IGNsaWVudC5fZ2V0VGltZW91dHNGb3JSZXF1ZXN0KGluaXRpYWxPcHRzLmhvc3RUeXBlKSxcbiAgICAgIGZvcmNlQXV0aEhlYWRlcnM6IGluaXRpYWxPcHRzLmZvcmNlQXV0aEhlYWRlcnNcbiAgICB9XG4gICk7XG5cbiAgaWYgKGNsaWVudC5fdXNlQ2FjaGUgJiYgY2xpZW50Ll91c2VSZXF1ZXN0Q2FjaGUgJiYgY2FjaGUpIHtcbiAgICBjYWNoZVtjYWNoZUlEXSA9IHJlcXVlc3Q7XG4gIH1cblxuICByZXR1cm4gaW50ZXJvcENhbGxiYWNrUmV0dXJuKHJlcXVlc3QsIGZ1bmN0aW9uKGNvbnRlbnQpIHtcbiAgICAvLyBJbiBjYXNlIG9mIHRoZSBmaXJzdCByZXF1ZXN0LCByZXR1cm4gdGhlIEpTT04gdmFsdWVcbiAgICByZXR1cm4gY29udGVudC5ib2R5O1xuICB9KTtcbn07XG5cbi8qXG4qIFRyYW5zZm9ybSBzZWFyY2ggcGFyYW0gb2JqZWN0IGluIHF1ZXJ5IHN0cmluZ1xuKiBAcGFyYW0ge29iamVjdH0gYXJncyBhcmd1bWVudHMgdG8gYWRkIHRvIHRoZSBjdXJyZW50IHF1ZXJ5IHN0cmluZ1xuKiBAcGFyYW0ge3N0cmluZ30gcGFyYW1zIGN1cnJlbnQgcXVlcnkgc3RyaW5nXG4qIEByZXR1cm4ge3N0cmluZ30gdGhlIGZpbmFsIHF1ZXJ5IHN0cmluZ1xuKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fZ2V0U2VhcmNoUGFyYW1zID0gZnVuY3Rpb24oYXJncywgcGFyYW1zKSB7XG4gIGlmIChhcmdzID09PSB1bmRlZmluZWQgfHwgYXJncyA9PT0gbnVsbCkge1xuICAgIHJldHVybiBwYXJhbXM7XG4gIH1cbiAgZm9yICh2YXIga2V5IGluIGFyZ3MpIHtcbiAgICBpZiAoa2V5ICE9PSBudWxsICYmIGFyZ3Nba2V5XSAhPT0gdW5kZWZpbmVkICYmIGFyZ3MuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgcGFyYW1zICs9IHBhcmFtcyA9PT0gJycgPyAnJyA6ICcmJztcbiAgICAgIHBhcmFtcyArPSBrZXkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZ3Nba2V5XSkgPT09ICdbb2JqZWN0IEFycmF5XScgPyBzYWZlSlNPTlN0cmluZ2lmeShhcmdzW2tleV0pIDogYXJnc1trZXldKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcmFtcztcbn07XG5cbi8qKlxuICogQ29tcHV0ZSB0aGUgaGVhZGVycyBmb3IgYSByZXF1ZXN0XG4gKlxuICogQHBhcmFtIFtzdHJpbmddIG9wdGlvbnMuYWRkaXRpb25hbFVBIHNlbWktY29sb24gc2VwYXJhdGVkIHN0cmluZyB3aXRoIG90aGVyIHVzZXIgYWdlbnRzIHRvIGFkZFxuICogQHBhcmFtIFtib29sZWFuPXRydWVdIG9wdGlvbnMud2l0aEFwaUtleSBTZW5kIHRoZSBhcGkga2V5IGFzIGEgaGVhZGVyXG4gKiBAcGFyYW0gW09iamVjdF0gb3B0aW9ucy5oZWFkZXJzIEV4dHJhIGhlYWRlcnMgdG8gc2VuZFxuICovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2NvbXB1dGVSZXF1ZXN0SGVhZGVycyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgdmFyIGZvckVhY2ggPSByZXF1aXJlKCdmb3JlYWNoJyk7XG5cbiAgdmFyIHVhID0gb3B0aW9ucy5hZGRpdGlvbmFsVUEgP1xuICAgIHRoaXMuX3VhICsgJzsnICsgb3B0aW9ucy5hZGRpdGlvbmFsVUEgOlxuICAgIHRoaXMuX3VhO1xuXG4gIHZhciByZXF1ZXN0SGVhZGVycyA9IHtcbiAgICAneC1hbGdvbGlhLWFnZW50JzogdWEsXG4gICAgJ3gtYWxnb2xpYS1hcHBsaWNhdGlvbi1pZCc6IHRoaXMuYXBwbGljYXRpb25JRFxuICB9O1xuXG4gIC8vIGJyb3dzZXIgd2lsbCBpbmxpbmUgaGVhZGVycyBpbiB0aGUgdXJsLCBub2RlLmpzIHdpbGwgdXNlIGh0dHAgaGVhZGVyc1xuICAvLyBidXQgaW4gc29tZSBzaXR1YXRpb25zLCB0aGUgQVBJIEtFWSB3aWxsIGJlIHRvbyBsb25nIChiaWcgc2VjdXJlZCBBUEkga2V5cylcbiAgLy8gc28gaWYgdGhlIHJlcXVlc3QgaXMgYSBQT1NUIGFuZCB0aGUgS0VZIGlzIHZlcnkgbG9uZywgd2Ugd2lsbCBiZSBhc2tlZCB0byBub3QgcHV0XG4gIC8vIGl0IGludG8gaGVhZGVycyBidXQgaW4gdGhlIEpTT04gYm9keVxuICBpZiAob3B0aW9ucy53aXRoQXBpS2V5ICE9PSBmYWxzZSkge1xuICAgIHJlcXVlc3RIZWFkZXJzWyd4LWFsZ29saWEtYXBpLWtleSddID0gdGhpcy5hcGlLZXk7XG4gIH1cblxuICBpZiAodGhpcy51c2VyVG9rZW4pIHtcbiAgICByZXF1ZXN0SGVhZGVyc1sneC1hbGdvbGlhLXVzZXJ0b2tlbiddID0gdGhpcy51c2VyVG9rZW47XG4gIH1cblxuICBpZiAodGhpcy5zZWN1cml0eVRhZ3MpIHtcbiAgICByZXF1ZXN0SGVhZGVyc1sneC1hbGdvbGlhLXRhZ2ZpbHRlcnMnXSA9IHRoaXMuc2VjdXJpdHlUYWdzO1xuICB9XG5cbiAgZm9yRWFjaCh0aGlzLmV4dHJhSGVhZGVycywgZnVuY3Rpb24gYWRkVG9SZXF1ZXN0SGVhZGVycyh2YWx1ZSwga2V5KSB7XG4gICAgcmVxdWVzdEhlYWRlcnNba2V5XSA9IHZhbHVlO1xuICB9KTtcblxuICBpZiAob3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgZm9yRWFjaChvcHRpb25zLmhlYWRlcnMsIGZ1bmN0aW9uIGFkZFRvUmVxdWVzdEhlYWRlcnModmFsdWUsIGtleSkge1xuICAgICAgcmVxdWVzdEhlYWRlcnNba2V5XSA9IHZhbHVlO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHJlcXVlc3RIZWFkZXJzO1xufTtcblxuLyoqXG4gKiBTZWFyY2ggdGhyb3VnaCBtdWx0aXBsZSBpbmRpY2VzIGF0IHRoZSBzYW1lIHRpbWVcbiAqIEBwYXJhbSAge09iamVjdFtdfSAgIHF1ZXJpZXMgIEFuIGFycmF5IG9mIHF1ZXJpZXMgeW91IHdhbnQgdG8gcnVuLlxuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJpZXNbXS5pbmRleE5hbWUgVGhlIGluZGV4IG5hbWUgeW91IHdhbnQgdG8gdGFyZ2V0XG4gKiBAcGFyYW0ge3N0cmluZ30gW3F1ZXJpZXNbXS5xdWVyeV0gVGhlIHF1ZXJ5IHRvIGlzc3VlIG9uIHRoaXMgaW5kZXguIENhbiBhbHNvIGJlIHBhc3NlZCBpbnRvIGBwYXJhbXNgXG4gKiBAcGFyYW0ge09iamVjdH0gcXVlcmllc1tdLnBhcmFtcyBBbnkgc2VhcmNoIHBhcmFtIGxpa2UgaGl0c1BlclBhZ2UsIC4uXG4gKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sgQ2FsbGJhY2sgdG8gYmUgY2FsbGVkXG4gKiBAcmV0dXJuIHtQcm9taXNlfHVuZGVmaW5lZH0gUmV0dXJucyBhIHByb21pc2UgaWYgbm8gY2FsbGJhY2sgZ2l2ZW5cbiAqL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLnNlYXJjaCA9IGZ1bmN0aW9uKHF1ZXJpZXMsIG9wdHMsIGNhbGxiYWNrKSB7XG4gIHZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXNhcnJheScpO1xuICB2YXIgbWFwID0gcmVxdWlyZSgnLi9tYXAuanMnKTtcblxuICB2YXIgdXNhZ2UgPSAnVXNhZ2U6IGNsaWVudC5zZWFyY2goYXJyYXlPZlF1ZXJpZXNbLCBjYWxsYmFja10pJztcblxuICBpZiAoIWlzQXJyYXkocXVlcmllcykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IodXNhZ2UpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgIG9wdHMgPSB7fTtcbiAgfSBlbHNlIGlmIChvcHRzID09PSB1bmRlZmluZWQpIHtcbiAgICBvcHRzID0ge307XG4gIH1cblxuICB2YXIgY2xpZW50ID0gdGhpcztcblxuICB2YXIgcG9zdE9iaiA9IHtcbiAgICByZXF1ZXN0czogbWFwKHF1ZXJpZXMsIGZ1bmN0aW9uIHByZXBhcmVSZXF1ZXN0KHF1ZXJ5KSB7XG4gICAgICB2YXIgcGFyYW1zID0gJyc7XG5cbiAgICAgIC8vIGFsbG93IHF1ZXJ5LnF1ZXJ5XG4gICAgICAvLyBzbyB3ZSBhcmUgbWltaWNpbmcgdGhlIGluZGV4LnNlYXJjaChxdWVyeSwgcGFyYW1zKSBtZXRob2RcbiAgICAgIC8vIHtpbmRleE5hbWU6LCBxdWVyeTosIHBhcmFtczp9XG4gICAgICBpZiAocXVlcnkucXVlcnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBwYXJhbXMgKz0gJ3F1ZXJ5PScgKyBlbmNvZGVVUklDb21wb25lbnQocXVlcnkucXVlcnkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbmRleE5hbWU6IHF1ZXJ5LmluZGV4TmFtZSxcbiAgICAgICAgcGFyYW1zOiBjbGllbnQuX2dldFNlYXJjaFBhcmFtcyhxdWVyeS5wYXJhbXMsIHBhcmFtcylcbiAgICAgIH07XG4gICAgfSlcbiAgfTtcblxuICB2YXIgSlNPTlBQYXJhbXMgPSBtYXAocG9zdE9iai5yZXF1ZXN0cywgZnVuY3Rpb24gcHJlcGFyZUpTT05QUGFyYW1zKHJlcXVlc3QsIHJlcXVlc3RJZCkge1xuICAgIHJldHVybiByZXF1ZXN0SWQgKyAnPScgK1xuICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAnLzEvaW5kZXhlcy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KHJlcXVlc3QuaW5kZXhOYW1lKSArICc/JyArXG4gICAgICAgIHJlcXVlc3QucGFyYW1zXG4gICAgICApO1xuICB9KS5qb2luKCcmJyk7XG5cbiAgdmFyIHVybCA9ICcvMS9pbmRleGVzLyovcXVlcmllcyc7XG5cbiAgaWYgKG9wdHMuc3RyYXRlZ3kgIT09IHVuZGVmaW5lZCkge1xuICAgIHVybCArPSAnP3N0cmF0ZWd5PScgKyBvcHRzLnN0cmF0ZWd5O1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuX2pzb25SZXF1ZXN0KHtcbiAgICBjYWNoZTogdGhpcy5jYWNoZSxcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICB1cmw6IHVybCxcbiAgICBib2R5OiBwb3N0T2JqLFxuICAgIGhvc3RUeXBlOiAncmVhZCcsXG4gICAgZmFsbGJhY2s6IHtcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB1cmw6ICcvMS9pbmRleGVzLyonLFxuICAgICAgYm9keToge1xuICAgICAgICBwYXJhbXM6IEpTT05QUGFyYW1zXG4gICAgICB9XG4gICAgfSxcbiAgICBjYWxsYmFjazogY2FsbGJhY2tcbiAgfSk7XG59O1xuXG4vKipcbiogU2VhcmNoIGZvciBmYWNldCB2YWx1ZXNcbiogaHR0cHM6Ly93d3cuYWxnb2xpYS5jb20vZG9jL3Jlc3QtYXBpL3NlYXJjaCNzZWFyY2gtZm9yLWZhY2V0LXZhbHVlc1xuKiBUaGlzIGlzIHRoZSB0b3AtbGV2ZWwgQVBJIGZvciBTRkZWLlxuKlxuKiBAcGFyYW0ge29iamVjdFtdfSBxdWVyaWVzIEFuIGFycmF5IG9mIHF1ZXJpZXMgdG8gcnVuLlxuKiBAcGFyYW0ge3N0cmluZ30gcXVlcmllc1tdLmluZGV4TmFtZSBJbmRleCBuYW1lLCBuYW1lIG9mIHRoZSBpbmRleCB0byBzZWFyY2guXG4qIEBwYXJhbSB7b2JqZWN0fSBxdWVyaWVzW10ucGFyYW1zIFF1ZXJ5IHBhcmFtZXRlcnMuXG4qIEBwYXJhbSB7c3RyaW5nfSBxdWVyaWVzW10ucGFyYW1zLmZhY2V0TmFtZSBGYWNldCBuYW1lLCBuYW1lIG9mIHRoZSBhdHRyaWJ1dGUgdG8gc2VhcmNoIGZvciB2YWx1ZXMgaW4uXG4qIE11c3QgYmUgZGVjbGFyZWQgYXMgYSBmYWNldFxuKiBAcGFyYW0ge3N0cmluZ30gcXVlcmllc1tdLnBhcmFtcy5mYWNldFF1ZXJ5IFF1ZXJ5IGZvciB0aGUgZmFjZXQgc2VhcmNoXG4qIEBwYXJhbSB7c3RyaW5nfSBbcXVlcmllc1tdLnBhcmFtcy4qXSBBbnkgc2VhcmNoIHBhcmFtZXRlciBvZiBBbGdvbGlhLFxuKiBzZWUgaHR0cHM6Ly93d3cuYWxnb2xpYS5jb20vZG9jL2FwaS1jbGllbnQvamF2YXNjcmlwdC9zZWFyY2gjc2VhcmNoLXBhcmFtZXRlcnNcbiogUGFnaW5hdGlvbiBpcyBub3Qgc3VwcG9ydGVkLiBUaGUgcGFnZSBhbmQgaGl0c1BlclBhZ2UgcGFyYW1ldGVycyB3aWxsIGJlIGlnbm9yZWQuXG4qL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLnNlYXJjaEZvckZhY2V0VmFsdWVzID0gZnVuY3Rpb24ocXVlcmllcykge1xuICB2YXIgaXNBcnJheSA9IHJlcXVpcmUoJ2lzYXJyYXknKTtcbiAgdmFyIG1hcCA9IHJlcXVpcmUoJy4vbWFwLmpzJyk7XG5cbiAgdmFyIHVzYWdlID0gJ1VzYWdlOiBjbGllbnQuc2VhcmNoRm9yRmFjZXRWYWx1ZXMoW3tpbmRleE5hbWUsIHBhcmFtczoge2ZhY2V0TmFtZSwgZmFjZXRRdWVyeSwgLi4ucGFyYW1zfX0sIC4uLnF1ZXJpZXNdKSc7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbWF4LWxlblxuXG4gIGlmICghaXNBcnJheShxdWVyaWVzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcih1c2FnZSk7XG4gIH1cblxuICB2YXIgY2xpZW50ID0gdGhpcztcblxuICByZXR1cm4gY2xpZW50Ll9wcm9taXNlLmFsbChtYXAocXVlcmllcywgZnVuY3Rpb24gcGVyZm9ybVF1ZXJ5KHF1ZXJ5KSB7XG4gICAgaWYgKFxuICAgICAgIXF1ZXJ5IHx8XG4gICAgICBxdWVyeS5pbmRleE5hbWUgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgcXVlcnkucGFyYW1zLmZhY2V0TmFtZSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICBxdWVyeS5wYXJhbXMuZmFjZXRRdWVyeSA9PT0gdW5kZWZpbmVkXG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IodXNhZ2UpO1xuICAgIH1cblxuICAgIHZhciBjbG9uZSA9IHJlcXVpcmUoJy4vY2xvbmUuanMnKTtcbiAgICB2YXIgb21pdCA9IHJlcXVpcmUoJy4vb21pdC5qcycpO1xuXG4gICAgdmFyIGluZGV4TmFtZSA9IHF1ZXJ5LmluZGV4TmFtZTtcbiAgICB2YXIgcGFyYW1zID0gcXVlcnkucGFyYW1zO1xuXG4gICAgdmFyIGZhY2V0TmFtZSA9IHBhcmFtcy5mYWNldE5hbWU7XG4gICAgdmFyIGZpbHRlcmVkUGFyYW1zID0gb21pdChjbG9uZShwYXJhbXMpLCBmdW5jdGlvbihrZXlOYW1lKSB7XG4gICAgICByZXR1cm4ga2V5TmFtZSA9PT0gJ2ZhY2V0TmFtZSc7XG4gICAgfSk7XG4gICAgdmFyIHNlYXJjaFBhcmFtZXRlcnMgPSBjbGllbnQuX2dldFNlYXJjaFBhcmFtcyhmaWx0ZXJlZFBhcmFtcywgJycpO1xuXG4gICAgcmV0dXJuIGNsaWVudC5fanNvblJlcXVlc3Qoe1xuICAgICAgY2FjaGU6IGNsaWVudC5jYWNoZSxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgdXJsOlxuICAgICAgICAnLzEvaW5kZXhlcy8nICtcbiAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KGluZGV4TmFtZSkgK1xuICAgICAgICAnL2ZhY2V0cy8nICtcbiAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KGZhY2V0TmFtZSkgK1xuICAgICAgICAnL3F1ZXJ5JyxcbiAgICAgIGhvc3RUeXBlOiAncmVhZCcsXG4gICAgICBib2R5OiB7cGFyYW1zOiBzZWFyY2hQYXJhbWV0ZXJzfVxuICAgIH0pO1xuICB9KSk7XG59O1xuXG4vKipcbiAqIFNldCB0aGUgZXh0cmEgc2VjdXJpdHkgdGFnRmlsdGVycyBoZWFkZXJcbiAqIEBwYXJhbSB7c3RyaW5nfGFycmF5fSB0YWdzIFRoZSBsaXN0IG9mIHRhZ3MgZGVmaW5pbmcgdGhlIGN1cnJlbnQgc2VjdXJpdHkgZmlsdGVyc1xuICovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuc2V0U2VjdXJpdHlUYWdzID0gZnVuY3Rpb24odGFncykge1xuICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRhZ3MpID09PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgdmFyIHN0clRhZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhZ3MubGVuZ3RoOyArK2kpIHtcbiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGFnc1tpXSkgPT09ICdbb2JqZWN0IEFycmF5XScpIHtcbiAgICAgICAgdmFyIG9yZWRUYWdzID0gW107XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGFnc1tpXS5sZW5ndGg7ICsraikge1xuICAgICAgICAgIG9yZWRUYWdzLnB1c2godGFnc1tpXVtqXSk7XG4gICAgICAgIH1cbiAgICAgICAgc3RyVGFncy5wdXNoKCcoJyArIG9yZWRUYWdzLmpvaW4oJywnKSArICcpJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdHJUYWdzLnB1c2godGFnc1tpXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHRhZ3MgPSBzdHJUYWdzLmpvaW4oJywnKTtcbiAgfVxuXG4gIHRoaXMuc2VjdXJpdHlUYWdzID0gdGFncztcbn07XG5cbi8qKlxuICogU2V0IHRoZSBleHRyYSB1c2VyIHRva2VuIGhlYWRlclxuICogQHBhcmFtIHtzdHJpbmd9IHVzZXJUb2tlbiBUaGUgdG9rZW4gaWRlbnRpZnlpbmcgYSB1bmlxIHVzZXIgKHVzZWQgdG8gYXBwbHkgcmF0ZSBsaW1pdHMpXG4gKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5zZXRVc2VyVG9rZW4gPSBmdW5jdGlvbih1c2VyVG9rZW4pIHtcbiAgdGhpcy51c2VyVG9rZW4gPSB1c2VyVG9rZW47XG59O1xuXG4vKipcbiAqIENsZWFyIGFsbCBxdWVyaWVzIGluIGNsaWVudCdzIGNhY2hlXG4gKiBAcmV0dXJuIHVuZGVmaW5lZFxuICovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuY2xlYXJDYWNoZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmNhY2hlID0ge307XG59O1xuXG4vKipcbiogU2V0IHRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIGEgcmVxdWVzdCBjYW4gdGFrZSBiZWZvcmUgYXV0b21hdGljYWxseSBiZWluZyB0ZXJtaW5hdGVkLlxuKiBAZGVwcmVjYXRlZFxuKiBAcGFyYW0ge051bWJlcn0gbWlsbGlzZWNvbmRzXG4qL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLnNldFJlcXVlc3RUaW1lb3V0ID0gZnVuY3Rpb24obWlsbGlzZWNvbmRzKSB7XG4gIGlmIChtaWxsaXNlY29uZHMpIHtcbiAgICB0aGlzLl90aW1lb3V0cy5jb25uZWN0ID0gdGhpcy5fdGltZW91dHMucmVhZCA9IHRoaXMuX3RpbWVvdXRzLndyaXRlID0gbWlsbGlzZWNvbmRzO1xuICB9XG59O1xuXG4vKipcbiogU2V0IHRoZSB0aHJlZSBkaWZmZXJlbnQgKGNvbm5lY3QsIHJlYWQsIHdyaXRlKSB0aW1lb3V0cyB0byBiZSB1c2VkIHdoZW4gcmVxdWVzdGluZ1xuKiBAcGFyYW0ge09iamVjdH0gdGltZW91dHNcbiovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuc2V0VGltZW91dHMgPSBmdW5jdGlvbih0aW1lb3V0cykge1xuICB0aGlzLl90aW1lb3V0cyA9IHRpbWVvdXRzO1xufTtcblxuLyoqXG4qIEdldCB0aGUgdGhyZWUgZGlmZmVyZW50IChjb25uZWN0LCByZWFkLCB3cml0ZSkgdGltZW91dHMgdG8gYmUgdXNlZCB3aGVuIHJlcXVlc3RpbmdcbiogQHBhcmFtIHtPYmplY3R9IHRpbWVvdXRzXG4qL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLmdldFRpbWVvdXRzID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLl90aW1lb3V0cztcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fZ2V0QXBwSWREYXRhID0gZnVuY3Rpb24oKSB7XG4gIHZhciBkYXRhID0gc3RvcmUuZ2V0KHRoaXMuYXBwbGljYXRpb25JRCk7XG4gIGlmIChkYXRhICE9PSBudWxsKSB0aGlzLl9jYWNoZUFwcElkRGF0YShkYXRhKTtcbiAgcmV0dXJuIGRhdGE7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX3NldEFwcElkRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgZGF0YS5sYXN0Q2hhbmdlID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcbiAgdGhpcy5fY2FjaGVBcHBJZERhdGEoZGF0YSk7XG4gIHJldHVybiBzdG9yZS5zZXQodGhpcy5hcHBsaWNhdGlvbklELCBkYXRhKTtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fY2hlY2tBcHBJZERhdGEgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGRhdGEgPSB0aGlzLl9nZXRBcHBJZERhdGEoKTtcbiAgdmFyIG5vdyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XG4gIGlmIChkYXRhID09PSBudWxsIHx8IG5vdyAtIGRhdGEubGFzdENoYW5nZSA+IFJFU0VUX0FQUF9EQVRBX1RJTUVSKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Jlc2V0SW5pdGlhbEFwcElkRGF0YShkYXRhKTtcbiAgfVxuXG4gIHJldHVybiBkYXRhO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9yZXNldEluaXRpYWxBcHBJZERhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gIHZhciBuZXdEYXRhID0gZGF0YSB8fCB7fTtcbiAgbmV3RGF0YS5ob3N0SW5kZXhlcyA9IHtyZWFkOiAwLCB3cml0ZTogMH07XG4gIG5ld0RhdGEudGltZW91dE11bHRpcGxpZXIgPSAxO1xuICBuZXdEYXRhLnNodWZmbGVSZXN1bHQgPSBuZXdEYXRhLnNodWZmbGVSZXN1bHQgfHwgc2h1ZmZsZShbMSwgMiwgM10pO1xuICByZXR1cm4gdGhpcy5fc2V0QXBwSWREYXRhKG5ld0RhdGEpO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9jYWNoZUFwcElkRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgdGhpcy5faG9zdEluZGV4ZXMgPSBkYXRhLmhvc3RJbmRleGVzO1xuICB0aGlzLl90aW1lb3V0TXVsdGlwbGllciA9IGRhdGEudGltZW91dE11bHRpcGxpZXI7XG4gIHRoaXMuX3NodWZmbGVSZXN1bHQgPSBkYXRhLnNodWZmbGVSZXN1bHQ7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX3BhcnRpYWxBcHBJZERhdGFVcGRhdGUgPSBmdW5jdGlvbihuZXdEYXRhKSB7XG4gIHZhciBmb3JlYWNoID0gcmVxdWlyZSgnZm9yZWFjaCcpO1xuICB2YXIgY3VycmVudERhdGEgPSB0aGlzLl9nZXRBcHBJZERhdGEoKTtcbiAgZm9yZWFjaChuZXdEYXRhLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgY3VycmVudERhdGFba2V5XSA9IHZhbHVlO1xuICB9KTtcblxuICByZXR1cm4gdGhpcy5fc2V0QXBwSWREYXRhKGN1cnJlbnREYXRhKTtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fZ2V0SG9zdEJ5VHlwZSA9IGZ1bmN0aW9uKGhvc3RUeXBlKSB7XG4gIHJldHVybiB0aGlzLmhvc3RzW2hvc3RUeXBlXVt0aGlzLl9nZXRIb3N0SW5kZXhCeVR5cGUoaG9zdFR5cGUpXTtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fZ2V0VGltZW91dE11bHRpcGxpZXIgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMuX3RpbWVvdXRNdWx0aXBsaWVyO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9nZXRIb3N0SW5kZXhCeVR5cGUgPSBmdW5jdGlvbihob3N0VHlwZSkge1xuICByZXR1cm4gdGhpcy5faG9zdEluZGV4ZXNbaG9zdFR5cGVdO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9zZXRIb3N0SW5kZXhCeVR5cGUgPSBmdW5jdGlvbihob3N0SW5kZXgsIGhvc3RUeXBlKSB7XG4gIHZhciBjbG9uZSA9IHJlcXVpcmUoJy4vY2xvbmUnKTtcbiAgdmFyIG5ld0hvc3RJbmRleGVzID0gY2xvbmUodGhpcy5faG9zdEluZGV4ZXMpO1xuICBuZXdIb3N0SW5kZXhlc1tob3N0VHlwZV0gPSBob3N0SW5kZXg7XG4gIHRoaXMuX3BhcnRpYWxBcHBJZERhdGFVcGRhdGUoe2hvc3RJbmRleGVzOiBuZXdIb3N0SW5kZXhlc30pO1xuICByZXR1cm4gaG9zdEluZGV4O1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9pbmNyZW1lbnRIb3N0SW5kZXggPSBmdW5jdGlvbihob3N0VHlwZSkge1xuICByZXR1cm4gdGhpcy5fc2V0SG9zdEluZGV4QnlUeXBlKFxuICAgICh0aGlzLl9nZXRIb3N0SW5kZXhCeVR5cGUoaG9zdFR5cGUpICsgMSkgJSB0aGlzLmhvc3RzW2hvc3RUeXBlXS5sZW5ndGgsIGhvc3RUeXBlXG4gICk7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2luY3JlbWVudFRpbWVvdXRNdWx0aXBsZXIgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHRpbWVvdXRNdWx0aXBsaWVyID0gTWF0aC5tYXgodGhpcy5fdGltZW91dE11bHRpcGxpZXIgKyAxLCA0KTtcbiAgcmV0dXJuIHRoaXMuX3BhcnRpYWxBcHBJZERhdGFVcGRhdGUoe3RpbWVvdXRNdWx0aXBsaWVyOiB0aW1lb3V0TXVsdGlwbGllcn0pO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9nZXRUaW1lb3V0c0ZvclJlcXVlc3QgPSBmdW5jdGlvbihob3N0VHlwZSkge1xuICByZXR1cm4ge1xuICAgIGNvbm5lY3Q6IHRoaXMuX3RpbWVvdXRzLmNvbm5lY3QgKiB0aGlzLl90aW1lb3V0TXVsdGlwbGllcixcbiAgICBjb21wbGV0ZTogdGhpcy5fdGltZW91dHNbaG9zdFR5cGVdICogdGhpcy5fdGltZW91dE11bHRpcGxpZXJcbiAgfTtcbn07XG5cbmZ1bmN0aW9uIHByZXBhcmVIb3N0KHByb3RvY29sKSB7XG4gIHJldHVybiBmdW5jdGlvbiBwcmVwYXJlKGhvc3QpIHtcbiAgICByZXR1cm4gcHJvdG9jb2wgKyAnLy8nICsgaG9zdC50b0xvd2VyQ2FzZSgpO1xuICB9O1xufVxuXG4vLyBQcm90b3R5cGUuanMgPCAxLjcsIGEgd2lkZWx5IHVzZWQgbGlicmFyeSwgZGVmaW5lcyBhIHdlaXJkXG4vLyBBcnJheS5wcm90b3R5cGUudG9KU09OIGZ1bmN0aW9uIHRoYXQgd2lsbCBmYWlsIHRvIHN0cmluZ2lmeSBvdXIgY29udGVudFxuLy8gYXBwcm9wcmlhdGVseVxuLy8gcmVmczpcbi8vICAgLSBodHRwczovL2dyb3Vwcy5nb29nbGUuY29tL2ZvcnVtLyMhdG9waWMvcHJvdG90eXBlLWNvcmUvRS1TQVZ2Vl9WOVFcbi8vICAgLSBodHRwczovL2dpdGh1Yi5jb20vc3N0ZXBoZW5zb24vcHJvdG90eXBlL2NvbW1pdC8wMzhhMjk4NWE3MDU5M2MxYTg2YzIzMGZhZGJkZmUyZTQ4OThhNDhjXG4vLyAgIC0gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzE0ODQ0MS8xNDcwNzlcbmZ1bmN0aW9uIHNhZmVKU09OU3RyaW5naWZ5KG9iaikge1xuICAvKiBlc2xpbnQgbm8tZXh0ZW5kLW5hdGl2ZTowICovXG5cbiAgaWYgKEFycmF5LnByb3RvdHlwZS50b0pTT04gPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmopO1xuICB9XG5cbiAgdmFyIHRvSlNPTiA9IEFycmF5LnByb3RvdHlwZS50b0pTT047XG4gIGRlbGV0ZSBBcnJheS5wcm90b3R5cGUudG9KU09OO1xuICB2YXIgb3V0ID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgQXJyYXkucHJvdG90eXBlLnRvSlNPTiA9IHRvSlNPTjtcblxuICByZXR1cm4gb3V0O1xufVxuXG5mdW5jdGlvbiBzaHVmZmxlKGFycmF5KSB7XG4gIHZhciBjdXJyZW50SW5kZXggPSBhcnJheS5sZW5ndGg7XG4gIHZhciB0ZW1wb3JhcnlWYWx1ZTtcbiAgdmFyIHJhbmRvbUluZGV4O1xuXG4gIC8vIFdoaWxlIHRoZXJlIHJlbWFpbiBlbGVtZW50cyB0byBzaHVmZmxlLi4uXG4gIHdoaWxlIChjdXJyZW50SW5kZXggIT09IDApIHtcbiAgICAvLyBQaWNrIGEgcmVtYWluaW5nIGVsZW1lbnQuLi5cbiAgICByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGN1cnJlbnRJbmRleCk7XG4gICAgY3VycmVudEluZGV4IC09IDE7XG5cbiAgICAvLyBBbmQgc3dhcCBpdCB3aXRoIHRoZSBjdXJyZW50IGVsZW1lbnQuXG4gICAgdGVtcG9yYXJ5VmFsdWUgPSBhcnJheVtjdXJyZW50SW5kZXhdO1xuICAgIGFycmF5W2N1cnJlbnRJbmRleF0gPSBhcnJheVtyYW5kb21JbmRleF07XG4gICAgYXJyYXlbcmFuZG9tSW5kZXhdID0gdGVtcG9yYXJ5VmFsdWU7XG4gIH1cblxuICByZXR1cm4gYXJyYXk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUNyZWRlbnRpYWxzKGhlYWRlcnMpIHtcbiAgdmFyIG5ld0hlYWRlcnMgPSB7fTtcblxuICBmb3IgKHZhciBoZWFkZXJOYW1lIGluIGhlYWRlcnMpIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGhlYWRlcnMsIGhlYWRlck5hbWUpKSB7XG4gICAgICB2YXIgdmFsdWU7XG5cbiAgICAgIGlmIChoZWFkZXJOYW1lID09PSAneC1hbGdvbGlhLWFwaS1rZXknIHx8IGhlYWRlck5hbWUgPT09ICd4LWFsZ29saWEtYXBwbGljYXRpb24taWQnKSB7XG4gICAgICAgIHZhbHVlID0gJyoqaGlkZGVuIGZvciBzZWN1cml0eSBwdXJwb3NlcyoqJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhbHVlID0gaGVhZGVyc1toZWFkZXJOYW1lXTtcbiAgICAgIH1cblxuICAgICAgbmV3SGVhZGVyc1toZWFkZXJOYW1lXSA9IHZhbHVlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXdIZWFkZXJzO1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL0FsZ29saWFTZWFyY2hDb3JlLmpzXG4vLyBtb2R1bGUgaWQgPSA0M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgYnVpbGRTZWFyY2hNZXRob2QgPSByZXF1aXJlKCcuL2J1aWxkU2VhcmNoTWV0aG9kLmpzJyk7XG52YXIgZGVwcmVjYXRlID0gcmVxdWlyZSgnLi9kZXByZWNhdGUuanMnKTtcbnZhciBkZXByZWNhdGVkTWVzc2FnZSA9IHJlcXVpcmUoJy4vZGVwcmVjYXRlZE1lc3NhZ2UuanMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBJbmRleENvcmU7XG5cbi8qXG4qIEluZGV4IGNsYXNzIGNvbnN0cnVjdG9yLlxuKiBZb3Ugc2hvdWxkIG5vdCB1c2UgdGhpcyBtZXRob2QgZGlyZWN0bHkgYnV0IHVzZSBpbml0SW5kZXgoKSBmdW5jdGlvblxuKi9cbmZ1bmN0aW9uIEluZGV4Q29yZShhbGdvbGlhc2VhcmNoLCBpbmRleE5hbWUpIHtcbiAgdGhpcy5pbmRleE5hbWUgPSBpbmRleE5hbWU7XG4gIHRoaXMuYXMgPSBhbGdvbGlhc2VhcmNoO1xuICB0aGlzLnR5cGVBaGVhZEFyZ3MgPSBudWxsO1xuICB0aGlzLnR5cGVBaGVhZFZhbHVlT3B0aW9uID0gbnVsbDtcblxuICAvLyBtYWtlIHN1cmUgZXZlcnkgaW5kZXggaW5zdGFuY2UgaGFzIGl0J3Mgb3duIGNhY2hlXG4gIHRoaXMuY2FjaGUgPSB7fTtcbn1cblxuLypcbiogQ2xlYXIgYWxsIHF1ZXJpZXMgaW4gY2FjaGVcbiovXG5JbmRleENvcmUucHJvdG90eXBlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jYWNoZSA9IHt9O1xufTtcblxuLypcbiogU2VhcmNoIGluc2lkZSB0aGUgaW5kZXggdXNpbmcgWE1MSHR0cFJlcXVlc3QgcmVxdWVzdCAoVXNpbmcgYSBQT1NUIHF1ZXJ5IHRvXG4qIG1pbmltaXplIG51bWJlciBvZiBPUFRJT05TIHF1ZXJpZXM6IENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nKS5cbipcbiogQHBhcmFtIHtzdHJpbmd9IFtxdWVyeV0gdGhlIGZ1bGwgdGV4dCBxdWVyeVxuKiBAcGFyYW0ge29iamVjdH0gW2FyZ3NdIChvcHRpb25hbCkgaWYgc2V0LCBjb250YWlucyBhbiBvYmplY3Qgd2l0aCBxdWVyeSBwYXJhbWV0ZXJzOlxuKiAtIHBhZ2U6IChpbnRlZ2VyKSBQYWdpbmF0aW9uIHBhcmFtZXRlciB1c2VkIHRvIHNlbGVjdCB0aGUgcGFnZSB0byByZXRyaWV2ZS5cbiogICAgICAgICAgICAgICAgICAgUGFnZSBpcyB6ZXJvLWJhc2VkIGFuZCBkZWZhdWx0cyB0byAwLiBUaHVzLFxuKiAgICAgICAgICAgICAgICAgICB0byByZXRyaWV2ZSB0aGUgMTB0aCBwYWdlIHlvdSBuZWVkIHRvIHNldCBwYWdlPTlcbiogLSBoaXRzUGVyUGFnZTogKGludGVnZXIpIFBhZ2luYXRpb24gcGFyYW1ldGVyIHVzZWQgdG8gc2VsZWN0IHRoZSBudW1iZXIgb2YgaGl0cyBwZXIgcGFnZS4gRGVmYXVsdHMgdG8gMjAuXG4qIC0gYXR0cmlidXRlc1RvUmV0cmlldmU6IGEgc3RyaW5nIHRoYXQgY29udGFpbnMgdGhlIGxpc3Qgb2Ygb2JqZWN0IGF0dHJpYnV0ZXNcbiogeW91IHdhbnQgdG8gcmV0cmlldmUgKGxldCB5b3UgbWluaW1pemUgdGhlIGFuc3dlciBzaXplKS5cbiogICBBdHRyaWJ1dGVzIGFyZSBzZXBhcmF0ZWQgd2l0aCBhIGNvbW1hIChmb3IgZXhhbXBsZSBcIm5hbWUsYWRkcmVzc1wiKS5cbiogICBZb3UgY2FuIGFsc28gdXNlIGFuIGFycmF5IChmb3IgZXhhbXBsZSBbXCJuYW1lXCIsXCJhZGRyZXNzXCJdKS5cbiogICBCeSBkZWZhdWx0LCBhbGwgYXR0cmlidXRlcyBhcmUgcmV0cmlldmVkLiBZb3UgY2FuIGFsc28gdXNlICcqJyB0byByZXRyaWV2ZSBhbGxcbiogICB2YWx1ZXMgd2hlbiBhbiBhdHRyaWJ1dGVzVG9SZXRyaWV2ZSBzZXR0aW5nIGlzIHNwZWNpZmllZCBmb3IgeW91ciBpbmRleC5cbiogLSBhdHRyaWJ1dGVzVG9IaWdobGlnaHQ6IGEgc3RyaW5nIHRoYXQgY29udGFpbnMgdGhlIGxpc3Qgb2YgYXR0cmlidXRlcyB5b3VcbiogICB3YW50IHRvIGhpZ2hsaWdodCBhY2NvcmRpbmcgdG8gdGhlIHF1ZXJ5LlxuKiAgIEF0dHJpYnV0ZXMgYXJlIHNlcGFyYXRlZCBieSBhIGNvbW1hLiBZb3UgY2FuIGFsc28gdXNlIGFuIGFycmF5IChmb3IgZXhhbXBsZSBbXCJuYW1lXCIsXCJhZGRyZXNzXCJdKS5cbiogICBJZiBhbiBhdHRyaWJ1dGUgaGFzIG5vIG1hdGNoIGZvciB0aGUgcXVlcnksIHRoZSByYXcgdmFsdWUgaXMgcmV0dXJuZWQuXG4qICAgQnkgZGVmYXVsdCBhbGwgaW5kZXhlZCB0ZXh0IGF0dHJpYnV0ZXMgYXJlIGhpZ2hsaWdodGVkLlxuKiAgIFlvdSBjYW4gdXNlIGAqYCBpZiB5b3Ugd2FudCB0byBoaWdobGlnaHQgYWxsIHRleHR1YWwgYXR0cmlidXRlcy5cbiogICBOdW1lcmljYWwgYXR0cmlidXRlcyBhcmUgbm90IGhpZ2hsaWdodGVkLlxuKiAgIEEgbWF0Y2hMZXZlbCBpcyByZXR1cm5lZCBmb3IgZWFjaCBoaWdobGlnaHRlZCBhdHRyaWJ1dGUgYW5kIGNhbiBjb250YWluOlxuKiAgICAgIC0gZnVsbDogaWYgYWxsIHRoZSBxdWVyeSB0ZXJtcyB3ZXJlIGZvdW5kIGluIHRoZSBhdHRyaWJ1dGUsXG4qICAgICAgLSBwYXJ0aWFsOiBpZiBvbmx5IHNvbWUgb2YgdGhlIHF1ZXJ5IHRlcm1zIHdlcmUgZm91bmQsXG4qICAgICAgLSBub25lOiBpZiBub25lIG9mIHRoZSBxdWVyeSB0ZXJtcyB3ZXJlIGZvdW5kLlxuKiAtIGF0dHJpYnV0ZXNUb1NuaXBwZXQ6IGEgc3RyaW5nIHRoYXQgY29udGFpbnMgdGhlIGxpc3Qgb2YgYXR0cmlidXRlcyB0byBzbmlwcGV0IGFsb25nc2lkZVxuKiB0aGUgbnVtYmVyIG9mIHdvcmRzIHRvIHJldHVybiAoc3ludGF4IGlzIGBhdHRyaWJ1dGVOYW1lOm5iV29yZHNgKS5cbiogICAgQXR0cmlidXRlcyBhcmUgc2VwYXJhdGVkIGJ5IGEgY29tbWEgKEV4YW1wbGU6IGF0dHJpYnV0ZXNUb1NuaXBwZXQ9bmFtZToxMCxjb250ZW50OjEwKS5cbiogICAgWW91IGNhbiBhbHNvIHVzZSBhbiBhcnJheSAoRXhhbXBsZTogYXR0cmlidXRlc1RvU25pcHBldDogWyduYW1lOjEwJywnY29udGVudDoxMCddKS5cbiogICAgQnkgZGVmYXVsdCBubyBzbmlwcGV0IGlzIGNvbXB1dGVkLlxuKiAtIG1pbldvcmRTaXplZm9yMVR5cG86IHRoZSBtaW5pbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzIGluIGEgcXVlcnkgd29yZCB0byBhY2NlcHQgb25lIHR5cG8gaW4gdGhpcyB3b3JkLlxuKiBEZWZhdWx0cyB0byAzLlxuKiAtIG1pbldvcmRTaXplZm9yMlR5cG9zOiB0aGUgbWluaW11bSBudW1iZXIgb2YgY2hhcmFjdGVycyBpbiBhIHF1ZXJ5IHdvcmRcbiogdG8gYWNjZXB0IHR3byB0eXBvcyBpbiB0aGlzIHdvcmQuIERlZmF1bHRzIHRvIDcuXG4qIC0gZ2V0UmFua2luZ0luZm86IGlmIHNldCB0byAxLCB0aGUgcmVzdWx0IGhpdHMgd2lsbCBjb250YWluIHJhbmtpbmdcbiogaW5mb3JtYXRpb24gaW4gX3JhbmtpbmdJbmZvIGF0dHJpYnV0ZS5cbiogLSBhcm91bmRMYXRMbmc6IHNlYXJjaCBmb3IgZW50cmllcyBhcm91bmQgYSBnaXZlblxuKiBsYXRpdHVkZS9sb25naXR1ZGUgKHNwZWNpZmllZCBhcyB0d28gZmxvYXRzIHNlcGFyYXRlZCBieSBhIGNvbW1hKS5cbiogICBGb3IgZXhhbXBsZSBhcm91bmRMYXRMbmc9NDcuMzE2NjY5LDUuMDE2NjcwKS5cbiogICBZb3UgY2FuIHNwZWNpZnkgdGhlIG1heGltdW0gZGlzdGFuY2UgaW4gbWV0ZXJzIHdpdGggdGhlIGFyb3VuZFJhZGl1cyBwYXJhbWV0ZXIgKGluIG1ldGVycylcbiogICBhbmQgdGhlIHByZWNpc2lvbiBmb3IgcmFua2luZyB3aXRoIGFyb3VuZFByZWNpc2lvblxuKiAgIChmb3IgZXhhbXBsZSBpZiB5b3Ugc2V0IGFyb3VuZFByZWNpc2lvbj0xMDAsIHR3byBvYmplY3RzIHRoYXQgYXJlIGRpc3RhbnQgb2ZcbiogICBsZXNzIHRoYW4gMTAwbSB3aWxsIGJlIGNvbnNpZGVyZWQgYXMgaWRlbnRpY2FsIGZvciBcImdlb1wiIHJhbmtpbmcgcGFyYW1ldGVyKS5cbiogICBBdCBpbmRleGluZywgeW91IHNob3VsZCBzcGVjaWZ5IGdlb2xvYyBvZiBhbiBvYmplY3Qgd2l0aCB0aGUgX2dlb2xvYyBhdHRyaWJ1dGVcbiogICAoaW4gdGhlIGZvcm0ge1wiX2dlb2xvY1wiOntcImxhdFwiOjQ4Ljg1MzQwOSwgXCJsbmdcIjoyLjM0ODgwMH19KVxuKiAtIGluc2lkZUJvdW5kaW5nQm94OiBzZWFyY2ggZW50cmllcyBpbnNpZGUgYSBnaXZlbiBhcmVhIGRlZmluZWQgYnkgdGhlIHR3byBleHRyZW1lIHBvaW50c1xuKiBvZiBhIHJlY3RhbmdsZSAoZGVmaW5lZCBieSA0IGZsb2F0czogcDFMYXQscDFMbmcscDJMYXQscDJMbmcpLlxuKiAgIEZvciBleGFtcGxlIGluc2lkZUJvdW5kaW5nQm94PTQ3LjMxNjUsNC45NjY1LDQ3LjM0MjQsNS4wMjAxKS5cbiogICBBdCBpbmRleGluZywgeW91IHNob3VsZCBzcGVjaWZ5IGdlb2xvYyBvZiBhbiBvYmplY3Qgd2l0aCB0aGUgX2dlb2xvYyBhdHRyaWJ1dGVcbiogICAoaW4gdGhlIGZvcm0ge1wiX2dlb2xvY1wiOntcImxhdFwiOjQ4Ljg1MzQwOSwgXCJsbmdcIjoyLjM0ODgwMH19KVxuKiAtIG51bWVyaWNGaWx0ZXJzOiBhIHN0cmluZyB0aGF0IGNvbnRhaW5zIHRoZSBsaXN0IG9mIG51bWVyaWMgZmlsdGVycyB5b3Ugd2FudCB0b1xuKiBhcHBseSBzZXBhcmF0ZWQgYnkgYSBjb21tYS5cbiogICBUaGUgc3ludGF4IG9mIG9uZSBmaWx0ZXIgaXMgYGF0dHJpYnV0ZU5hbWVgIGZvbGxvd2VkIGJ5IGBvcGVyYW5kYCBmb2xsb3dlZCBieSBgdmFsdWVgLlxuKiAgIFN1cHBvcnRlZCBvcGVyYW5kcyBhcmUgYDxgLCBgPD1gLCBgPWAsIGA+YCBhbmQgYD49YC5cbiogICBZb3UgY2FuIGhhdmUgbXVsdGlwbGUgY29uZGl0aW9ucyBvbiBvbmUgYXR0cmlidXRlIGxpa2UgZm9yIGV4YW1wbGUgbnVtZXJpY0ZpbHRlcnM9cHJpY2U+MTAwLHByaWNlPDEwMDAuXG4qICAgWW91IGNhbiBhbHNvIHVzZSBhbiBhcnJheSAoZm9yIGV4YW1wbGUgbnVtZXJpY0ZpbHRlcnM6IFtcInByaWNlPjEwMFwiLFwicHJpY2U8MTAwMFwiXSkuXG4qIC0gdGFnRmlsdGVyczogZmlsdGVyIHRoZSBxdWVyeSBieSBhIHNldCBvZiB0YWdzLiBZb3UgY2FuIEFORCB0YWdzIGJ5IHNlcGFyYXRpbmcgdGhlbSBieSBjb21tYXMuXG4qICAgVG8gT1IgdGFncywgeW91IG11c3QgYWRkIHBhcmVudGhlc2VzLiBGb3IgZXhhbXBsZSwgdGFncz10YWcxLCh0YWcyLHRhZzMpIG1lYW5zIHRhZzEgQU5EICh0YWcyIE9SIHRhZzMpLlxuKiAgIFlvdSBjYW4gYWxzbyB1c2UgYW4gYXJyYXksIGZvciBleGFtcGxlIHRhZ0ZpbHRlcnM6IFtcInRhZzFcIixbXCJ0YWcyXCIsXCJ0YWczXCJdXVxuKiAgIG1lYW5zIHRhZzEgQU5EICh0YWcyIE9SIHRhZzMpLlxuKiAgIEF0IGluZGV4aW5nLCB0YWdzIHNob3VsZCBiZSBhZGRlZCBpbiB0aGUgX3RhZ3MqKiBhdHRyaWJ1dGVcbiogICBvZiBvYmplY3RzIChmb3IgZXhhbXBsZSB7XCJfdGFnc1wiOltcInRhZzFcIixcInRhZzJcIl19KS5cbiogLSBmYWNldEZpbHRlcnM6IGZpbHRlciB0aGUgcXVlcnkgYnkgYSBsaXN0IG9mIGZhY2V0cy5cbiogICBGYWNldHMgYXJlIHNlcGFyYXRlZCBieSBjb21tYXMgYW5kIGVhY2ggZmFjZXQgaXMgZW5jb2RlZCBhcyBgYXR0cmlidXRlTmFtZTp2YWx1ZWAuXG4qICAgRm9yIGV4YW1wbGU6IGBmYWNldEZpbHRlcnM9Y2F0ZWdvcnk6Qm9vayxhdXRob3I6Sm9obiUyMERvZWAuXG4qICAgWW91IGNhbiBhbHNvIHVzZSBhbiBhcnJheSAoZm9yIGV4YW1wbGUgYFtcImNhdGVnb3J5OkJvb2tcIixcImF1dGhvcjpKb2huJTIwRG9lXCJdYCkuXG4qIC0gZmFjZXRzOiBMaXN0IG9mIG9iamVjdCBhdHRyaWJ1dGVzIHRoYXQgeW91IHdhbnQgdG8gdXNlIGZvciBmYWNldGluZy5cbiogICBDb21tYSBzZXBhcmF0ZWQgbGlzdDogYFwiY2F0ZWdvcnksYXV0aG9yXCJgIG9yIGFycmF5IGBbJ2NhdGVnb3J5JywnYXV0aG9yJ11gXG4qICAgT25seSBhdHRyaWJ1dGVzIHRoYXQgaGF2ZSBiZWVuIGFkZGVkIGluICoqYXR0cmlidXRlc0ZvckZhY2V0aW5nKiogaW5kZXggc2V0dGluZ1xuKiAgIGNhbiBiZSB1c2VkIGluIHRoaXMgcGFyYW1ldGVyLlxuKiAgIFlvdSBjYW4gYWxzbyB1c2UgYCpgIHRvIHBlcmZvcm0gZmFjZXRpbmcgb24gYWxsIGF0dHJpYnV0ZXMgc3BlY2lmaWVkIGluICoqYXR0cmlidXRlc0ZvckZhY2V0aW5nKiouXG4qIC0gcXVlcnlUeXBlOiBzZWxlY3QgaG93IHRoZSBxdWVyeSB3b3JkcyBhcmUgaW50ZXJwcmV0ZWQsIGl0IGNhbiBiZSBvbmUgb2YgdGhlIGZvbGxvd2luZyB2YWx1ZTpcbiogICAgLSBwcmVmaXhBbGw6IGFsbCBxdWVyeSB3b3JkcyBhcmUgaW50ZXJwcmV0ZWQgYXMgcHJlZml4ZXMsXG4qICAgIC0gcHJlZml4TGFzdDogb25seSB0aGUgbGFzdCB3b3JkIGlzIGludGVycHJldGVkIGFzIGEgcHJlZml4IChkZWZhdWx0IGJlaGF2aW9yKSxcbiogICAgLSBwcmVmaXhOb25lOiBubyBxdWVyeSB3b3JkIGlzIGludGVycHJldGVkIGFzIGEgcHJlZml4LiBUaGlzIG9wdGlvbiBpcyBub3QgcmVjb21tZW5kZWQuXG4qIC0gb3B0aW9uYWxXb3JkczogYSBzdHJpbmcgdGhhdCBjb250YWlucyB0aGUgbGlzdCBvZiB3b3JkcyB0aGF0IHNob3VsZFxuKiBiZSBjb25zaWRlcmVkIGFzIG9wdGlvbmFsIHdoZW4gZm91bmQgaW4gdGhlIHF1ZXJ5LlxuKiAgIENvbW1hIHNlcGFyYXRlZCBhbmQgYXJyYXkgYXJlIGFjY2VwdGVkLlxuKiAtIGRpc3RpbmN0OiBJZiBzZXQgdG8gMSwgZW5hYmxlIHRoZSBkaXN0aW5jdCBmZWF0dXJlIChkaXNhYmxlZCBieSBkZWZhdWx0KVxuKiBpZiB0aGUgYXR0cmlidXRlRm9yRGlzdGluY3QgaW5kZXggc2V0dGluZyBpcyBzZXQuXG4qICAgVGhpcyBmZWF0dXJlIGlzIHNpbWlsYXIgdG8gdGhlIFNRTCBcImRpc3RpbmN0XCIga2V5d29yZDogd2hlbiBlbmFibGVkXG4qICAgaW4gYSBxdWVyeSB3aXRoIHRoZSBkaXN0aW5jdD0xIHBhcmFtZXRlcixcbiogICBhbGwgaGl0cyBjb250YWluaW5nIGEgZHVwbGljYXRlIHZhbHVlIGZvciB0aGUgYXR0cmlidXRlRm9yRGlzdGluY3QgYXR0cmlidXRlIGFyZSByZW1vdmVkIGZyb20gcmVzdWx0cy5cbiogICBGb3IgZXhhbXBsZSwgaWYgdGhlIGNob3NlbiBhdHRyaWJ1dGUgaXMgc2hvd19uYW1lIGFuZCBzZXZlcmFsIGhpdHMgaGF2ZVxuKiAgIHRoZSBzYW1lIHZhbHVlIGZvciBzaG93X25hbWUsIHRoZW4gb25seSB0aGUgYmVzdFxuKiAgIG9uZSBpcyBrZXB0IGFuZCBvdGhlcnMgYXJlIHJlbW92ZWQuXG4qIC0gcmVzdHJpY3RTZWFyY2hhYmxlQXR0cmlidXRlczogTGlzdCBvZiBhdHRyaWJ1dGVzIHlvdSB3YW50IHRvIHVzZSBmb3JcbiogdGV4dHVhbCBzZWFyY2ggKG11c3QgYmUgYSBzdWJzZXQgb2YgdGhlIGF0dHJpYnV0ZXNUb0luZGV4IGluZGV4IHNldHRpbmcpXG4qIGVpdGhlciBjb21tYSBzZXBhcmF0ZWQgb3IgYXMgYW4gYXJyYXlcbiogQHBhcmFtIHtmdW5jdGlvbn0gW2NhbGxiYWNrXSB0aGUgcmVzdWx0IGNhbGxiYWNrIGNhbGxlZCB3aXRoIHR3byBhcmd1bWVudHM6XG4qICBlcnJvcjogbnVsbCBvciBFcnJvcignbWVzc2FnZScpLiBJZiBmYWxzZSwgdGhlIGNvbnRlbnQgY29udGFpbnMgdGhlIGVycm9yLlxuKiAgY29udGVudDogdGhlIHNlcnZlciBhbnN3ZXIgdGhhdCBjb250YWlucyB0aGUgbGlzdCBvZiByZXN1bHRzLlxuKi9cbkluZGV4Q29yZS5wcm90b3R5cGUuc2VhcmNoID0gYnVpbGRTZWFyY2hNZXRob2QoJ3F1ZXJ5Jyk7XG5cbi8qXG4qIC0tIEJFVEEgLS1cbiogU2VhcmNoIGEgcmVjb3JkIHNpbWlsYXIgdG8gdGhlIHF1ZXJ5IGluc2lkZSB0aGUgaW5kZXggdXNpbmcgWE1MSHR0cFJlcXVlc3QgcmVxdWVzdCAoVXNpbmcgYSBQT1NUIHF1ZXJ5IHRvXG4qIG1pbmltaXplIG51bWJlciBvZiBPUFRJT05TIHF1ZXJpZXM6IENyb3NzLU9yaWdpbiBSZXNvdXJjZSBTaGFyaW5nKS5cbipcbiogQHBhcmFtIHtzdHJpbmd9IFtxdWVyeV0gdGhlIHNpbWlsYXIgcXVlcnlcbiogQHBhcmFtIHtvYmplY3R9IFthcmdzXSAob3B0aW9uYWwpIGlmIHNldCwgY29udGFpbnMgYW4gb2JqZWN0IHdpdGggcXVlcnkgcGFyYW1ldGVycy5cbiogICBBbGwgc2VhcmNoIHBhcmFtZXRlcnMgYXJlIHN1cHBvcnRlZCAoc2VlIHNlYXJjaCBmdW5jdGlvbiksIHJlc3RyaWN0U2VhcmNoYWJsZUF0dHJpYnV0ZXMgYW5kIGZhY2V0RmlsdGVyc1xuKiAgIGFyZSB0aGUgdHdvIG1vc3QgdXNlZnVsIHRvIHJlc3RyaWN0IHRoZSBzaW1pbGFyIHJlc3VsdHMgYW5kIGdldCBtb3JlIHJlbGV2YW50IGNvbnRlbnRcbiovXG5JbmRleENvcmUucHJvdG90eXBlLnNpbWlsYXJTZWFyY2ggPSBidWlsZFNlYXJjaE1ldGhvZCgnc2ltaWxhclF1ZXJ5Jyk7XG5cbi8qXG4qIEJyb3dzZSBpbmRleCBjb250ZW50LiBUaGUgcmVzcG9uc2UgY29udGVudCB3aWxsIGhhdmUgYSBgY3Vyc29yYCBwcm9wZXJ0eSB0aGF0IHlvdSBjYW4gdXNlXG4qIHRvIGJyb3dzZSBzdWJzZXF1ZW50IHBhZ2VzIGZvciB0aGlzIHF1ZXJ5LiBVc2UgYGluZGV4LmJyb3dzZUZyb20oY3Vyc29yKWAgd2hlbiB5b3Ugd2FudC5cbipcbiogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5IC0gVGhlIGZ1bGwgdGV4dCBxdWVyeVxuKiBAcGFyYW0ge09iamVjdH0gW3F1ZXJ5UGFyYW1ldGVyc10gLSBBbnkgc2VhcmNoIHF1ZXJ5IHBhcmFtZXRlclxuKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2tdIC0gVGhlIHJlc3VsdCBjYWxsYmFjayBjYWxsZWQgd2l0aCB0d28gYXJndW1lbnRzXG4qICAgZXJyb3I6IG51bGwgb3IgRXJyb3IoJ21lc3NhZ2UnKVxuKiAgIGNvbnRlbnQ6IHRoZSBzZXJ2ZXIgYW5zd2VyIHdpdGggdGhlIGJyb3dzZSByZXN1bHRcbiogQHJldHVybiB7UHJvbWlzZXx1bmRlZmluZWR9IFJldHVybnMgYSBwcm9taXNlIGlmIG5vIGNhbGxiYWNrIGdpdmVuXG4qIEBleGFtcGxlXG4qIGluZGV4LmJyb3dzZSgnY29vbCBzb25ncycsIHtcbiogICB0YWdGaWx0ZXJzOiAncHVibGljLGNvbW1lbnRzJyxcbiogICBoaXRzUGVyUGFnZTogNTAwXG4qIH0sIGNhbGxiYWNrKTtcbiogQHNlZSB7QGxpbmsgaHR0cHM6Ly93d3cuYWxnb2xpYS5jb20vZG9jL3Jlc3RfYXBpI0Jyb3dzZXxBbGdvbGlhIFJFU1QgQVBJIERvY3VtZW50YXRpb259XG4qL1xuSW5kZXhDb3JlLnByb3RvdHlwZS5icm93c2UgPSBmdW5jdGlvbihxdWVyeSwgcXVlcnlQYXJhbWV0ZXJzLCBjYWxsYmFjaykge1xuICB2YXIgbWVyZ2UgPSByZXF1aXJlKCcuL21lcmdlLmpzJyk7XG5cbiAgdmFyIGluZGV4T2JqID0gdGhpcztcblxuICB2YXIgcGFnZTtcbiAgdmFyIGhpdHNQZXJQYWdlO1xuXG4gIC8vIHdlIGNoZWNrIHZhcmlhZGljIGNhbGxzIHRoYXQgYXJlIG5vdCB0aGUgb25lIGRlZmluZWRcbiAgLy8gLmJyb3dzZSgpLy5icm93c2UoZm4pXG4gIC8vID0+IHBhZ2UgPSAwXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHBhZ2UgPSAwO1xuICAgIGNhbGxiYWNrID0gYXJndW1lbnRzWzBdO1xuICAgIHF1ZXJ5ID0gdW5kZWZpbmVkO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdudW1iZXInKSB7XG4gICAgLy8gLmJyb3dzZSgyKS8uYnJvd3NlKDIsIDEwKS8uYnJvd3NlKDIsIGZuKS8uYnJvd3NlKDIsIDEwLCBmbilcbiAgICBwYWdlID0gYXJndW1lbnRzWzBdO1xuICAgIGlmICh0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnbnVtYmVyJykge1xuICAgICAgaGl0c1BlclBhZ2UgPSBhcmd1bWVudHNbMV07XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFjayA9IGFyZ3VtZW50c1sxXTtcbiAgICAgIGhpdHNQZXJQYWdlID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBxdWVyeSA9IHVuZGVmaW5lZDtcbiAgICBxdWVyeVBhcmFtZXRlcnMgPSB1bmRlZmluZWQ7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ29iamVjdCcpIHtcbiAgICAvLyAuYnJvd3NlKHF1ZXJ5UGFyYW1ldGVycykvLmJyb3dzZShxdWVyeVBhcmFtZXRlcnMsIGNiKVxuICAgIGlmICh0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFjayA9IGFyZ3VtZW50c1sxXTtcbiAgICB9XG4gICAgcXVlcnlQYXJhbWV0ZXJzID0gYXJndW1lbnRzWzBdO1xuICAgIHF1ZXJ5ID0gdW5kZWZpbmVkO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdzdHJpbmcnICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAvLyAuYnJvd3NlKHF1ZXJ5LCBjYilcbiAgICBjYWxsYmFjayA9IGFyZ3VtZW50c1sxXTtcbiAgICBxdWVyeVBhcmFtZXRlcnMgPSB1bmRlZmluZWQ7XG4gIH1cblxuICAvLyBvdGhlcndpc2UgaXQncyBhIC5icm93c2UocXVlcnkpLy5icm93c2UocXVlcnksIHF1ZXJ5UGFyYW1ldGVycykvLmJyb3dzZShxdWVyeSwgcXVlcnlQYXJhbWV0ZXJzLCBjYilcblxuICAvLyBnZXQgc2VhcmNoIHF1ZXJ5IHBhcmFtZXRlcnMgY29tYmluaW5nIHZhcmlvdXMgcG9zc2libGUgY2FsbHNcbiAgLy8gdG8gLmJyb3dzZSgpO1xuICBxdWVyeVBhcmFtZXRlcnMgPSBtZXJnZSh7fSwgcXVlcnlQYXJhbWV0ZXJzIHx8IHt9LCB7XG4gICAgcGFnZTogcGFnZSxcbiAgICBoaXRzUGVyUGFnZTogaGl0c1BlclBhZ2UsXG4gICAgcXVlcnk6IHF1ZXJ5XG4gIH0pO1xuXG4gIHZhciBwYXJhbXMgPSB0aGlzLmFzLl9nZXRTZWFyY2hQYXJhbXMocXVlcnlQYXJhbWV0ZXJzLCAnJyk7XG5cbiAgcmV0dXJuIHRoaXMuYXMuX2pzb25SZXF1ZXN0KHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICB1cmw6ICcvMS9pbmRleGVzLycgKyBlbmNvZGVVUklDb21wb25lbnQoaW5kZXhPYmouaW5kZXhOYW1lKSArICcvYnJvd3NlJyxcbiAgICBib2R5OiB7cGFyYW1zOiBwYXJhbXN9LFxuICAgIGhvc3RUeXBlOiAncmVhZCcsXG4gICAgY2FsbGJhY2s6IGNhbGxiYWNrXG4gIH0pO1xufTtcblxuLypcbiogQ29udGludWUgYnJvd3NpbmcgZnJvbSBhIHByZXZpb3VzIHBvc2l0aW9uIChjdXJzb3IpLCBvYnRhaW5lZCB2aWEgYSBjYWxsIHRvIGAuYnJvd3NlKClgLlxuKlxuKiBAcGFyYW0ge3N0cmluZ30gcXVlcnkgLSBUaGUgZnVsbCB0ZXh0IHF1ZXJ5XG4qIEBwYXJhbSB7T2JqZWN0fSBbcXVlcnlQYXJhbWV0ZXJzXSAtIEFueSBzZWFyY2ggcXVlcnkgcGFyYW1ldGVyXG4qIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFja10gLSBUaGUgcmVzdWx0IGNhbGxiYWNrIGNhbGxlZCB3aXRoIHR3byBhcmd1bWVudHNcbiogICBlcnJvcjogbnVsbCBvciBFcnJvcignbWVzc2FnZScpXG4qICAgY29udGVudDogdGhlIHNlcnZlciBhbnN3ZXIgd2l0aCB0aGUgYnJvd3NlIHJlc3VsdFxuKiBAcmV0dXJuIHtQcm9taXNlfHVuZGVmaW5lZH0gUmV0dXJucyBhIHByb21pc2UgaWYgbm8gY2FsbGJhY2sgZ2l2ZW5cbiogQGV4YW1wbGVcbiogaW5kZXguYnJvd3NlRnJvbSgnMTRsa2ZzYWtsMzInLCBjYWxsYmFjayk7XG4qIEBzZWUge0BsaW5rIGh0dHBzOi8vd3d3LmFsZ29saWEuY29tL2RvYy9yZXN0X2FwaSNCcm93c2V8QWxnb2xpYSBSRVNUIEFQSSBEb2N1bWVudGF0aW9ufVxuKi9cbkluZGV4Q29yZS5wcm90b3R5cGUuYnJvd3NlRnJvbSA9IGZ1bmN0aW9uKGN1cnNvciwgY2FsbGJhY2spIHtcbiAgcmV0dXJuIHRoaXMuYXMuX2pzb25SZXF1ZXN0KHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICB1cmw6ICcvMS9pbmRleGVzLycgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5pbmRleE5hbWUpICsgJy9icm93c2UnLFxuICAgIGJvZHk6IHtjdXJzb3I6IGN1cnNvcn0sXG4gICAgaG9zdFR5cGU6ICdyZWFkJyxcbiAgICBjYWxsYmFjazogY2FsbGJhY2tcbiAgfSk7XG59O1xuXG4vKlxuKiBTZWFyY2ggZm9yIGZhY2V0IHZhbHVlc1xuKiBodHRwczovL3d3dy5hbGdvbGlhLmNvbS9kb2MvcmVzdC1hcGkvc2VhcmNoI3NlYXJjaC1mb3ItZmFjZXQtdmFsdWVzXG4qXG4qIEBwYXJhbSB7c3RyaW5nfSBwYXJhbXMuZmFjZXROYW1lIEZhY2V0IG5hbWUsIG5hbWUgb2YgdGhlIGF0dHJpYnV0ZSB0byBzZWFyY2ggZm9yIHZhbHVlcyBpbi5cbiogTXVzdCBiZSBkZWNsYXJlZCBhcyBhIGZhY2V0XG4qIEBwYXJhbSB7c3RyaW5nfSBwYXJhbXMuZmFjZXRRdWVyeSBRdWVyeSBmb3IgdGhlIGZhY2V0IHNlYXJjaFxuKiBAcGFyYW0ge3N0cmluZ30gW3BhcmFtcy4qXSBBbnkgc2VhcmNoIHBhcmFtZXRlciBvZiBBbGdvbGlhLFxuKiBzZWUgaHR0cHM6Ly93d3cuYWxnb2xpYS5jb20vZG9jL2FwaS1jbGllbnQvamF2YXNjcmlwdC9zZWFyY2gjc2VhcmNoLXBhcmFtZXRlcnNcbiogUGFnaW5hdGlvbiBpcyBub3Qgc3VwcG9ydGVkLiBUaGUgcGFnZSBhbmQgaGl0c1BlclBhZ2UgcGFyYW1ldGVycyB3aWxsIGJlIGlnbm9yZWQuXG4qIEBwYXJhbSBjYWxsYmFjayAob3B0aW9uYWwpXG4qL1xuSW5kZXhDb3JlLnByb3RvdHlwZS5zZWFyY2hGb3JGYWNldFZhbHVlcyA9IGZ1bmN0aW9uKHBhcmFtcywgY2FsbGJhY2spIHtcbiAgdmFyIGNsb25lID0gcmVxdWlyZSgnLi9jbG9uZS5qcycpO1xuICB2YXIgb21pdCA9IHJlcXVpcmUoJy4vb21pdC5qcycpO1xuICB2YXIgdXNhZ2UgPSAnVXNhZ2U6IGluZGV4LnNlYXJjaEZvckZhY2V0VmFsdWVzKHtmYWNldE5hbWUsIGZhY2V0UXVlcnksIC4uLnBhcmFtc31bLCBjYWxsYmFja10pJztcblxuICBpZiAocGFyYW1zLmZhY2V0TmFtZSA9PT0gdW5kZWZpbmVkIHx8IHBhcmFtcy5mYWNldFF1ZXJ5ID09PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IodXNhZ2UpO1xuICB9XG5cbiAgdmFyIGZhY2V0TmFtZSA9IHBhcmFtcy5mYWNldE5hbWU7XG4gIHZhciBmaWx0ZXJlZFBhcmFtcyA9IG9taXQoY2xvbmUocGFyYW1zKSwgZnVuY3Rpb24oa2V5TmFtZSkge1xuICAgIHJldHVybiBrZXlOYW1lID09PSAnZmFjZXROYW1lJztcbiAgfSk7XG4gIHZhciBzZWFyY2hQYXJhbWV0ZXJzID0gdGhpcy5hcy5fZ2V0U2VhcmNoUGFyYW1zKGZpbHRlcmVkUGFyYW1zLCAnJyk7XG5cbiAgcmV0dXJuIHRoaXMuYXMuX2pzb25SZXF1ZXN0KHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICB1cmw6ICcvMS9pbmRleGVzLycgK1xuICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuaW5kZXhOYW1lKSArICcvZmFjZXRzLycgKyBlbmNvZGVVUklDb21wb25lbnQoZmFjZXROYW1lKSArICcvcXVlcnknLFxuICAgIGhvc3RUeXBlOiAncmVhZCcsXG4gICAgYm9keToge3BhcmFtczogc2VhcmNoUGFyYW1ldGVyc30sXG4gICAgY2FsbGJhY2s6IGNhbGxiYWNrXG4gIH0pO1xufTtcblxuSW5kZXhDb3JlLnByb3RvdHlwZS5zZWFyY2hGYWNldCA9IGRlcHJlY2F0ZShmdW5jdGlvbihwYXJhbXMsIGNhbGxiYWNrKSB7XG4gIHJldHVybiB0aGlzLnNlYXJjaEZvckZhY2V0VmFsdWVzKHBhcmFtcywgY2FsbGJhY2spO1xufSwgZGVwcmVjYXRlZE1lc3NhZ2UoXG4gICdpbmRleC5zZWFyY2hGYWNldChwYXJhbXNbLCBjYWxsYmFja10pJyxcbiAgJ2luZGV4LnNlYXJjaEZvckZhY2V0VmFsdWVzKHBhcmFtc1ssIGNhbGxiYWNrXSknXG4pKTtcblxuSW5kZXhDb3JlLnByb3RvdHlwZS5fc2VhcmNoID0gZnVuY3Rpb24ocGFyYW1zLCB1cmwsIGNhbGxiYWNrLCBhZGRpdGlvbmFsVUEpIHtcbiAgcmV0dXJuIHRoaXMuYXMuX2pzb25SZXF1ZXN0KHtcbiAgICBjYWNoZTogdGhpcy5jYWNoZSxcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICB1cmw6IHVybCB8fCAnLzEvaW5kZXhlcy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuaW5kZXhOYW1lKSArICcvcXVlcnknLFxuICAgIGJvZHk6IHtwYXJhbXM6IHBhcmFtc30sXG4gICAgaG9zdFR5cGU6ICdyZWFkJyxcbiAgICBmYWxsYmFjazoge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHVybDogJy8xL2luZGV4ZXMvJyArIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmluZGV4TmFtZSksXG4gICAgICBib2R5OiB7cGFyYW1zOiBwYXJhbXN9XG4gICAgfSxcbiAgICBjYWxsYmFjazogY2FsbGJhY2ssXG4gICAgYWRkaXRpb25hbFVBOiBhZGRpdGlvbmFsVUFcbiAgfSk7XG59O1xuXG4vKlxuKiBHZXQgYW4gb2JqZWN0IGZyb20gdGhpcyBpbmRleFxuKlxuKiBAcGFyYW0gb2JqZWN0SUQgdGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSBvYmplY3QgdG8gcmV0cmlldmVcbiogQHBhcmFtIGF0dHJzIChvcHRpb25hbCkgaWYgc2V0LCBjb250YWlucyB0aGUgYXJyYXkgb2YgYXR0cmlidXRlIG5hbWVzIHRvIHJldHJpZXZlXG4qIEBwYXJhbSBjYWxsYmFjayAob3B0aW9uYWwpIHRoZSByZXN1bHQgY2FsbGJhY2sgY2FsbGVkIHdpdGggdHdvIGFyZ3VtZW50c1xuKiAgZXJyb3I6IG51bGwgb3IgRXJyb3IoJ21lc3NhZ2UnKVxuKiAgY29udGVudDogdGhlIG9iamVjdCB0byByZXRyaWV2ZSBvciB0aGUgZXJyb3IgbWVzc2FnZSBpZiBhIGZhaWx1cmUgb2NjdXJlZFxuKi9cbkluZGV4Q29yZS5wcm90b3R5cGUuZ2V0T2JqZWN0ID0gZnVuY3Rpb24ob2JqZWN0SUQsIGF0dHJzLCBjYWxsYmFjaykge1xuICB2YXIgaW5kZXhPYmogPSB0aGlzO1xuXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxIHx8IHR5cGVvZiBhdHRycyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNhbGxiYWNrID0gYXR0cnM7XG4gICAgYXR0cnMgPSB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgcGFyYW1zID0gJyc7XG4gIGlmIChhdHRycyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcGFyYW1zID0gJz9hdHRyaWJ1dGVzPSc7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhdHRycy5sZW5ndGg7ICsraSkge1xuICAgICAgaWYgKGkgIT09IDApIHtcbiAgICAgICAgcGFyYW1zICs9ICcsJztcbiAgICAgIH1cbiAgICAgIHBhcmFtcyArPSBhdHRyc1tpXTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcy5hcy5fanNvblJlcXVlc3Qoe1xuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgdXJsOiAnLzEvaW5kZXhlcy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KGluZGV4T2JqLmluZGV4TmFtZSkgKyAnLycgKyBlbmNvZGVVUklDb21wb25lbnQob2JqZWN0SUQpICsgcGFyYW1zLFxuICAgIGhvc3RUeXBlOiAncmVhZCcsXG4gICAgY2FsbGJhY2s6IGNhbGxiYWNrXG4gIH0pO1xufTtcblxuLypcbiogR2V0IHNldmVyYWwgb2JqZWN0cyBmcm9tIHRoaXMgaW5kZXhcbipcbiogQHBhcmFtIG9iamVjdElEcyB0aGUgYXJyYXkgb2YgdW5pcXVlIGlkZW50aWZpZXIgb2Ygb2JqZWN0cyB0byByZXRyaWV2ZVxuKi9cbkluZGV4Q29yZS5wcm90b3R5cGUuZ2V0T2JqZWN0cyA9IGZ1bmN0aW9uKG9iamVjdElEcywgYXR0cmlidXRlc1RvUmV0cmlldmUsIGNhbGxiYWNrKSB7XG4gIHZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXNhcnJheScpO1xuICB2YXIgbWFwID0gcmVxdWlyZSgnLi9tYXAuanMnKTtcblxuICB2YXIgdXNhZ2UgPSAnVXNhZ2U6IGluZGV4LmdldE9iamVjdHMoYXJyYXlPZk9iamVjdElEc1ssIGNhbGxiYWNrXSknO1xuXG4gIGlmICghaXNBcnJheShvYmplY3RJRHMpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKHVzYWdlKTtcbiAgfVxuXG4gIHZhciBpbmRleE9iaiA9IHRoaXM7XG5cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgfHwgdHlwZW9mIGF0dHJpYnV0ZXNUb1JldHJpZXZlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY2FsbGJhY2sgPSBhdHRyaWJ1dGVzVG9SZXRyaWV2ZTtcbiAgICBhdHRyaWJ1dGVzVG9SZXRyaWV2ZSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIHZhciBib2R5ID0ge1xuICAgIHJlcXVlc3RzOiBtYXAob2JqZWN0SURzLCBmdW5jdGlvbiBwcmVwYXJlUmVxdWVzdChvYmplY3RJRCkge1xuICAgICAgdmFyIHJlcXVlc3QgPSB7XG4gICAgICAgIGluZGV4TmFtZTogaW5kZXhPYmouaW5kZXhOYW1lLFxuICAgICAgICBvYmplY3RJRDogb2JqZWN0SURcbiAgICAgIH07XG5cbiAgICAgIGlmIChhdHRyaWJ1dGVzVG9SZXRyaWV2ZSkge1xuICAgICAgICByZXF1ZXN0LmF0dHJpYnV0ZXNUb1JldHJpZXZlID0gYXR0cmlidXRlc1RvUmV0cmlldmUuam9pbignLCcpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVxdWVzdDtcbiAgICB9KVxuICB9O1xuXG4gIHJldHVybiB0aGlzLmFzLl9qc29uUmVxdWVzdCh7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgdXJsOiAnLzEvaW5kZXhlcy8qL29iamVjdHMnLFxuICAgIGhvc3RUeXBlOiAncmVhZCcsXG4gICAgYm9keTogYm9keSxcbiAgICBjYWxsYmFjazogY2FsbGJhY2tcbiAgfSk7XG59O1xuXG5JbmRleENvcmUucHJvdG90eXBlLmFzID0gbnVsbDtcbkluZGV4Q29yZS5wcm90b3R5cGUuaW5kZXhOYW1lID0gbnVsbDtcbkluZGV4Q29yZS5wcm90b3R5cGUudHlwZUFoZWFkQXJncyA9IG51bGw7XG5JbmRleENvcmUucHJvdG90eXBlLnR5cGVBaGVhZFZhbHVlT3B0aW9uID0gbnVsbDtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9JbmRleENvcmUuanNcbi8vIG1vZHVsZSBpZCA9IDQ0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxudmFyIEFsZ29saWFTZWFyY2hDb3JlID0gcmVxdWlyZSgnLi4vLi4vQWxnb2xpYVNlYXJjaENvcmUuanMnKTtcbnZhciBjcmVhdGVBbGdvbGlhc2VhcmNoID0gcmVxdWlyZSgnLi4vY3JlYXRlQWxnb2xpYXNlYXJjaC5qcycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUFsZ29saWFzZWFyY2goQWxnb2xpYVNlYXJjaENvcmUsICcobGl0ZSkgJyk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvYnJvd3Nlci9idWlsZHMvYWxnb2xpYXNlYXJjaExpdGUuanNcbi8vIG1vZHVsZSBpZCA9IDQ1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxudmFyIGdsb2JhbCA9IHJlcXVpcmUoJ2dsb2JhbCcpO1xudmFyIFByb21pc2UgPSBnbG9iYWwuUHJvbWlzZSB8fCByZXF1aXJlKCdlczYtcHJvbWlzZScpLlByb21pc2U7XG5cbi8vIFRoaXMgaXMgdGhlIHN0YW5kYWxvbmUgYnJvd3NlciBidWlsZCBlbnRyeSBwb2ludFxuLy8gQnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgQWxnb2xpYSBTZWFyY2ggSmF2YVNjcmlwdCBjbGllbnQsXG4vLyB1c2luZyBYTUxIdHRwUmVxdWVzdCwgWERvbWFpblJlcXVlc3QgYW5kIEpTT05QIGFzIGZhbGxiYWNrXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNyZWF0ZUFsZ29saWFzZWFyY2goQWxnb2xpYVNlYXJjaCwgdWFTdWZmaXgpIHtcbiAgdmFyIGluaGVyaXRzID0gcmVxdWlyZSgnaW5oZXJpdHMnKTtcbiAgdmFyIGVycm9ycyA9IHJlcXVpcmUoJy4uL2Vycm9ycycpO1xuICB2YXIgaW5saW5lSGVhZGVycyA9IHJlcXVpcmUoJy4vaW5saW5lLWhlYWRlcnMnKTtcbiAgdmFyIGpzb25wUmVxdWVzdCA9IHJlcXVpcmUoJy4vanNvbnAtcmVxdWVzdCcpO1xuICB2YXIgcGxhY2VzID0gcmVxdWlyZSgnLi4vcGxhY2VzLmpzJyk7XG4gIHVhU3VmZml4ID0gdWFTdWZmaXggfHwgJyc7XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGVidWcnKSB7XG4gICAgcmVxdWlyZSgnZGVidWcnKS5lbmFibGUoJ2FsZ29saWFzZWFyY2gqJyk7XG4gIH1cblxuICBmdW5jdGlvbiBhbGdvbGlhc2VhcmNoKGFwcGxpY2F0aW9uSUQsIGFwaUtleSwgb3B0cykge1xuICAgIHZhciBjbG9uZURlZXAgPSByZXF1aXJlKCcuLi9jbG9uZS5qcycpO1xuXG4gICAgb3B0cyA9IGNsb25lRGVlcChvcHRzIHx8IHt9KTtcblxuICAgIG9wdHMuX3VhID0gb3B0cy5fdWEgfHwgYWxnb2xpYXNlYXJjaC51YTtcblxuICAgIHJldHVybiBuZXcgQWxnb2xpYVNlYXJjaEJyb3dzZXIoYXBwbGljYXRpb25JRCwgYXBpS2V5LCBvcHRzKTtcbiAgfVxuXG4gIGFsZ29saWFzZWFyY2gudmVyc2lvbiA9IHJlcXVpcmUoJy4uL3ZlcnNpb24uanMnKTtcbiAgYWxnb2xpYXNlYXJjaC51YSA9ICdBbGdvbGlhIGZvciB2YW5pbGxhIEphdmFTY3JpcHQgJyArIHVhU3VmZml4ICsgYWxnb2xpYXNlYXJjaC52ZXJzaW9uO1xuICBhbGdvbGlhc2VhcmNoLmluaXRQbGFjZXMgPSBwbGFjZXMoYWxnb2xpYXNlYXJjaCk7XG5cbiAgLy8gd2UgZXhwb3NlIGludG8gd2luZG93IG5vIG1hdHRlciBob3cgd2UgYXJlIHVzZWQsIHRoaXMgd2lsbCBhbGxvd1xuICAvLyB1cyB0byBlYXNpbHkgZGVidWcgYW55IHdlYnNpdGUgcnVubmluZyBhbGdvbGlhXG4gIGdsb2JhbC5fX2FsZ29saWEgPSB7XG4gICAgZGVidWc6IHJlcXVpcmUoJ2RlYnVnJyksXG4gICAgYWxnb2xpYXNlYXJjaDogYWxnb2xpYXNlYXJjaFxuICB9O1xuXG4gIHZhciBzdXBwb3J0ID0ge1xuICAgIGhhc1hNTEh0dHBSZXF1ZXN0OiAnWE1MSHR0cFJlcXVlc3QnIGluIGdsb2JhbCxcbiAgICBoYXNYRG9tYWluUmVxdWVzdDogJ1hEb21haW5SZXF1ZXN0JyBpbiBnbG9iYWxcbiAgfTtcblxuICBpZiAoc3VwcG9ydC5oYXNYTUxIdHRwUmVxdWVzdCkge1xuICAgIHN1cHBvcnQuY29ycyA9ICd3aXRoQ3JlZGVudGlhbHMnIGluIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gQWxnb2xpYVNlYXJjaEJyb3dzZXIoKSB7XG4gICAgLy8gY2FsbCBBbGdvbGlhU2VhcmNoIGNvbnN0cnVjdG9yXG4gICAgQWxnb2xpYVNlYXJjaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgaW5oZXJpdHMoQWxnb2xpYVNlYXJjaEJyb3dzZXIsIEFsZ29saWFTZWFyY2gpO1xuXG4gIEFsZ29saWFTZWFyY2hCcm93c2VyLnByb3RvdHlwZS5fcmVxdWVzdCA9IGZ1bmN0aW9uIHJlcXVlc3QodXJsLCBvcHRzKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIHdyYXBSZXF1ZXN0KHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgLy8gbm8gY29ycyBvciBYRG9tYWluUmVxdWVzdCwgbm8gcmVxdWVzdFxuICAgICAgaWYgKCFzdXBwb3J0LmNvcnMgJiYgIXN1cHBvcnQuaGFzWERvbWFpblJlcXVlc3QpIHtcbiAgICAgICAgLy8gdmVyeSBvbGQgYnJvd3Nlciwgbm90IHN1cHBvcnRlZFxuICAgICAgICByZWplY3QobmV3IGVycm9ycy5OZXR3b3JrKCdDT1JTIG5vdCBzdXBwb3J0ZWQnKSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdXJsID0gaW5saW5lSGVhZGVycyh1cmwsIG9wdHMuaGVhZGVycyk7XG5cbiAgICAgIHZhciBib2R5ID0gb3B0cy5ib2R5O1xuICAgICAgdmFyIHJlcSA9IHN1cHBvcnQuY29ycyA/IG5ldyBYTUxIdHRwUmVxdWVzdCgpIDogbmV3IFhEb21haW5SZXF1ZXN0KCk7XG4gICAgICB2YXIgcmVxVGltZW91dDtcbiAgICAgIHZhciB0aW1lZE91dDtcbiAgICAgIHZhciBjb25uZWN0ZWQgPSBmYWxzZTtcblxuICAgICAgcmVxVGltZW91dCA9IHNldFRpbWVvdXQob25UaW1lb3V0LCBvcHRzLnRpbWVvdXRzLmNvbm5lY3QpO1xuICAgICAgLy8gd2Ugc2V0IGFuIGVtcHR5IG9ucHJvZ3Jlc3MgbGlzdGVuZXJcbiAgICAgIC8vIHNvIHRoYXQgWERvbWFpblJlcXVlc3Qgb24gSUU5IGlzIG5vdCBhYm9ydGVkXG4gICAgICAvLyByZWZzOlxuICAgICAgLy8gIC0gaHR0cHM6Ly9naXRodWIuY29tL2FsZ29saWEvYWxnb2xpYXNlYXJjaC1jbGllbnQtanMvaXNzdWVzLzc2XG4gICAgICAvLyAgLSBodHRwczovL3NvY2lhbC5tc2RuLm1pY3Jvc29mdC5jb20vRm9ydW1zL2llL2VuLVVTLzMwZWYzYWRkLTc2N2MtNDQzNi1iOGE5LWYxY2ExOWI0ODEyZS9pZTktcnRtLXhkb21haW5yZXF1ZXN0LWlzc3VlZC1yZXF1ZXN0cy1tYXktYWJvcnQtaWYtYWxsLWV2ZW50LWhhbmRsZXJzLW5vdC1zcGVjaWZpZWQ/Zm9ydW09aWV3ZWJkZXZlbG9wbWVudFxuICAgICAgcmVxLm9ucHJvZ3Jlc3MgPSBvblByb2dyZXNzO1xuICAgICAgaWYgKCdvbnJlYWR5c3RhdGVjaGFuZ2UnIGluIHJlcSkgcmVxLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG9uUmVhZHlTdGF0ZUNoYW5nZTtcbiAgICAgIHJlcS5vbmxvYWQgPSBvbkxvYWQ7XG4gICAgICByZXEub25lcnJvciA9IG9uRXJyb3I7XG5cbiAgICAgIC8vIGRvIG5vdCByZWx5IG9uIGRlZmF1bHQgWEhSIGFzeW5jIGZsYWcsIGFzIHNvbWUgYW5hbHl0aWNzIGNvZGUgbGlrZSBob3RqYXJcbiAgICAgIC8vIGJyZWFrcyBpdCBhbmQgc2V0IGl0IHRvIGZhbHNlIGJ5IGRlZmF1bHRcbiAgICAgIGlmIChyZXEgaW5zdGFuY2VvZiBYTUxIdHRwUmVxdWVzdCkge1xuICAgICAgICByZXEub3BlbihvcHRzLm1ldGhvZCwgdXJsLCB0cnVlKTtcblxuICAgICAgICAvLyBUaGUgQW5hbHl0aWNzIEFQSSBuZXZlciBhY2NlcHRzIEF1dGggaGVhZGVycyBhcyBxdWVyeSBzdHJpbmdcbiAgICAgICAgLy8gdGhpcyBvcHRpb24gZXhpc3RzIHNwZWNpZmljYWxseSBmb3IgdGhlbS5cbiAgICAgICAgaWYgKG9wdHMuZm9yY2VBdXRoSGVhZGVycykge1xuICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKFxuICAgICAgICAgICAgJ3gtYWxnb2xpYS1hcHBsaWNhdGlvbi1pZCcsXG4gICAgICAgICAgICBvcHRzLmhlYWRlcnNbJ3gtYWxnb2xpYS1hcHBsaWNhdGlvbi1pZCddXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcihcbiAgICAgICAgICAgICd4LWFsZ29saWEtYXBpLWtleScsXG4gICAgICAgICAgICBvcHRzLmhlYWRlcnNbJ3gtYWxnb2xpYS1hcGkta2V5J11cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXEub3BlbihvcHRzLm1ldGhvZCwgdXJsKTtcbiAgICAgIH1cblxuICAgICAgLy8gaGVhZGVycyBhcmUgbWVhbnQgdG8gYmUgc2VudCBhZnRlciBvcGVuXG4gICAgICBpZiAoc3VwcG9ydC5jb3JzKSB7XG4gICAgICAgIGlmIChib2R5KSB7XG4gICAgICAgICAgaWYgKG9wdHMubWV0aG9kID09PSAnUE9TVCcpIHtcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUVFAvQWNjZXNzX2NvbnRyb2xfQ09SUyNTaW1wbGVfcmVxdWVzdHNcbiAgICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdjb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdjb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignYWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGJvZHkpIHtcbiAgICAgICAgcmVxLnNlbmQoYm9keSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXEuc2VuZCgpO1xuICAgICAgfVxuXG4gICAgICAvLyBldmVudCBvYmplY3Qgbm90IHJlY2VpdmVkIGluIElFOCwgYXQgbGVhc3RcbiAgICAgIC8vIGJ1dCB3ZSBkbyBub3QgdXNlIGl0LCBzdGlsbCBpbXBvcnRhbnQgdG8gbm90ZVxuICAgICAgZnVuY3Rpb24gb25Mb2FkKC8qIGV2ZW50ICovKSB7XG4gICAgICAgIC8vIFdoZW4gYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0cyByZXEudGltZW91dCwgd2UgY2FuXG4gICAgICAgIC8vIGhhdmUgYm90aCBhIGxvYWQgYW5kIHRpbWVvdXQgZXZlbnQsIHNpbmNlIGhhbmRsZWQgYnkgYSBkdW1iIHNldFRpbWVvdXRcbiAgICAgICAgaWYgKHRpbWVkT3V0KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHJlcVRpbWVvdXQpO1xuXG4gICAgICAgIHZhciBvdXQ7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBvdXQgPSB7XG4gICAgICAgICAgICBib2R5OiBKU09OLnBhcnNlKHJlcS5yZXNwb25zZVRleHQpLFxuICAgICAgICAgICAgcmVzcG9uc2VUZXh0OiByZXEucmVzcG9uc2VUZXh0LFxuICAgICAgICAgICAgc3RhdHVzQ29kZTogcmVxLnN0YXR1cyxcbiAgICAgICAgICAgIC8vIFhEb21haW5SZXF1ZXN0IGRvZXMgbm90IGhhdmUgYW55IHJlc3BvbnNlIGhlYWRlcnNcbiAgICAgICAgICAgIGhlYWRlcnM6IHJlcS5nZXRBbGxSZXNwb25zZUhlYWRlcnMgJiYgcmVxLmdldEFsbFJlc3BvbnNlSGVhZGVycygpIHx8IHt9XG4gICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIG91dCA9IG5ldyBlcnJvcnMuVW5wYXJzYWJsZUpTT04oe1xuICAgICAgICAgICAgbW9yZTogcmVxLnJlc3BvbnNlVGV4dFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG91dCBpbnN0YW5jZW9mIGVycm9ycy5VbnBhcnNhYmxlSlNPTikge1xuICAgICAgICAgIHJlamVjdChvdXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUob3V0KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvbkVycm9yKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aW1lZE91dCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsZWFyVGltZW91dChyZXFUaW1lb3V0KTtcblxuICAgICAgICAvLyBlcnJvciBldmVudCBpcyB0cmlnZXJyZWQgYm90aCB3aXRoIFhEUi9YSFIgb246XG4gICAgICAgIC8vICAgLSBETlMgZXJyb3JcbiAgICAgICAgLy8gICAtIHVuYWxsb3dlZCBjcm9zcyBkb21haW4gcmVxdWVzdFxuICAgICAgICByZWplY3QoXG4gICAgICAgICAgbmV3IGVycm9ycy5OZXR3b3JrKHtcbiAgICAgICAgICAgIG1vcmU6IGV2ZW50XG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25UaW1lb3V0KCkge1xuICAgICAgICB0aW1lZE91dCA9IHRydWU7XG4gICAgICAgIHJlcS5hYm9ydCgpO1xuXG4gICAgICAgIHJlamVjdChuZXcgZXJyb3JzLlJlcXVlc3RUaW1lb3V0KCkpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvbkNvbm5lY3QoKSB7XG4gICAgICAgIGNvbm5lY3RlZCA9IHRydWU7XG4gICAgICAgIGNsZWFyVGltZW91dChyZXFUaW1lb3V0KTtcbiAgICAgICAgcmVxVGltZW91dCA9IHNldFRpbWVvdXQob25UaW1lb3V0LCBvcHRzLnRpbWVvdXRzLmNvbXBsZXRlKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25Qcm9ncmVzcygpIHtcbiAgICAgICAgaWYgKCFjb25uZWN0ZWQpIG9uQ29ubmVjdCgpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvblJlYWR5U3RhdGVDaGFuZ2UoKSB7XG4gICAgICAgIGlmICghY29ubmVjdGVkICYmIHJlcS5yZWFkeVN0YXRlID4gMSkgb25Db25uZWN0KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgQWxnb2xpYVNlYXJjaEJyb3dzZXIucHJvdG90eXBlLl9yZXF1ZXN0LmZhbGxiYWNrID0gZnVuY3Rpb24gcmVxdWVzdEZhbGxiYWNrKHVybCwgb3B0cykge1xuICAgIHVybCA9IGlubGluZUhlYWRlcnModXJsLCBvcHRzLmhlYWRlcnMpO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIHdyYXBKc29ucFJlcXVlc3QocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBqc29ucFJlcXVlc3QodXJsLCBvcHRzLCBmdW5jdGlvbiBqc29ucFJlcXVlc3REb25lKGVyciwgY29udGVudCkge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzb2x2ZShjb250ZW50KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIEFsZ29saWFTZWFyY2hCcm93c2VyLnByb3RvdHlwZS5fcHJvbWlzZSA9IHtcbiAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdFByb21pc2UodmFsKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QodmFsKTtcbiAgICB9LFxuICAgIHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmVQcm9taXNlKHZhbCkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWwpO1xuICAgIH0sXG4gICAgZGVsYXk6IGZ1bmN0aW9uIGRlbGF5UHJvbWlzZShtcykge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIHJlc29sdmVPblRpbWVvdXQocmVzb2x2ZS8qICwgcmVqZWN0Ki8pIHtcbiAgICAgICAgc2V0VGltZW91dChyZXNvbHZlLCBtcyk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFsbDogZnVuY3Rpb24gYWxsKHByb21pc2VzKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gYWxnb2xpYXNlYXJjaDtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvYnJvd3Nlci9jcmVhdGVBbGdvbGlhc2VhcmNoLmpzXG4vLyBtb2R1bGUgaWQgPSA0NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0gaW5saW5lSGVhZGVycztcblxudmFyIGVuY29kZSA9IHJlcXVpcmUoJ3F1ZXJ5c3RyaW5nLWVzMy9lbmNvZGUnKTtcblxuZnVuY3Rpb24gaW5saW5lSGVhZGVycyh1cmwsIGhlYWRlcnMpIHtcbiAgaWYgKC9cXD8vLnRlc3QodXJsKSkge1xuICAgIHVybCArPSAnJic7XG4gIH0gZWxzZSB7XG4gICAgdXJsICs9ICc/JztcbiAgfVxuXG4gIHJldHVybiB1cmwgKyBlbmNvZGUoaGVhZGVycyk7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvYnJvd3Nlci9pbmxpbmUtaGVhZGVycy5qc1xuLy8gbW9kdWxlIGlkID0gNDdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGpzb25wUmVxdWVzdDtcblxudmFyIGVycm9ycyA9IHJlcXVpcmUoJy4uL2Vycm9ycycpO1xuXG52YXIgSlNPTlBDb3VudGVyID0gMDtcblxuZnVuY3Rpb24ganNvbnBSZXF1ZXN0KHVybCwgb3B0cywgY2IpIHtcbiAgaWYgKG9wdHMubWV0aG9kICE9PSAnR0VUJykge1xuICAgIGNiKG5ldyBFcnJvcignTWV0aG9kICcgKyBvcHRzLm1ldGhvZCArICcgJyArIHVybCArICcgaXMgbm90IHN1cHBvcnRlZCBieSBKU09OUC4nKSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgb3B0cy5kZWJ1ZygnSlNPTlA6IHN0YXJ0Jyk7XG5cbiAgdmFyIGNiQ2FsbGVkID0gZmFsc2U7XG4gIHZhciB0aW1lZE91dCA9IGZhbHNlO1xuXG4gIEpTT05QQ291bnRlciArPSAxO1xuICB2YXIgaGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07XG4gIHZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgdmFyIGNiTmFtZSA9ICdhbGdvbGlhSlNPTlBfJyArIEpTT05QQ291bnRlcjtcbiAgdmFyIGRvbmUgPSBmYWxzZTtcblxuICB3aW5kb3dbY2JOYW1lXSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICByZW1vdmVHbG9iYWxzKCk7XG5cbiAgICBpZiAodGltZWRPdXQpIHtcbiAgICAgIG9wdHMuZGVidWcoJ0pTT05QOiBMYXRlIGFuc3dlciwgaWdub3JpbmcnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYkNhbGxlZCA9IHRydWU7XG5cbiAgICBjbGVhbigpO1xuXG4gICAgY2IobnVsbCwge1xuICAgICAgYm9keTogZGF0YSxcbiAgICAgIHJlc3BvbnNlVGV4dDogSlNPTi5zdHJpbmdpZnkoZGF0YSkvKiAsXG4gICAgICAvLyBXZSBkbyBub3Qgc2VuZCB0aGUgc3RhdHVzQ29kZSwgdGhlcmUncyBubyBzdGF0dXNDb2RlIGluIEpTT05QLCBpdCB3aWxsIGJlXG4gICAgICAvLyBjb21wdXRlZCB1c2luZyBkYXRhLnN0YXR1cyAmJiBkYXRhLm1lc3NhZ2UgbGlrZSB3aXRoIFhEUlxuICAgICAgc3RhdHVzQ29kZSovXG4gICAgfSk7XG4gIH07XG5cbiAgLy8gYWRkIGNhbGxiYWNrIGJ5IGhhbmRcbiAgdXJsICs9ICcmY2FsbGJhY2s9JyArIGNiTmFtZTtcblxuICAvLyBhZGQgYm9keSBwYXJhbXMgbWFudWFsbHlcbiAgaWYgKG9wdHMuanNvbkJvZHkgJiYgb3B0cy5qc29uQm9keS5wYXJhbXMpIHtcbiAgICB1cmwgKz0gJyYnICsgb3B0cy5qc29uQm9keS5wYXJhbXM7XG4gIH1cblxuICB2YXIgb250aW1lb3V0ID0gc2V0VGltZW91dCh0aW1lb3V0LCBvcHRzLnRpbWVvdXRzLmNvbXBsZXRlKTtcblxuICAvLyBzY3JpcHQgb25yZWFkeXN0YXRlY2hhbmdlIG5lZWRlZCBvbmx5IGZvclxuICAvLyA8PSBJRThcbiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci5qcy9pc3N1ZXMvNDUyM1xuICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gcmVhZHlzdGF0ZWNoYW5nZTtcbiAgc2NyaXB0Lm9ubG9hZCA9IHN1Y2Nlc3M7XG4gIHNjcmlwdC5vbmVycm9yID0gZXJyb3I7XG5cbiAgc2NyaXB0LmFzeW5jID0gdHJ1ZTtcbiAgc2NyaXB0LmRlZmVyID0gdHJ1ZTtcbiAgc2NyaXB0LnNyYyA9IHVybDtcbiAgaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuXG4gIGZ1bmN0aW9uIHN1Y2Nlc3MoKSB7XG4gICAgb3B0cy5kZWJ1ZygnSlNPTlA6IHN1Y2Nlc3MnKTtcblxuICAgIGlmIChkb25lIHx8IHRpbWVkT3V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZG9uZSA9IHRydWU7XG5cbiAgICAvLyBzY3JpcHQgbG9hZGVkIGJ1dCBkaWQgbm90IGNhbGwgdGhlIGZuID0+IHNjcmlwdCBsb2FkaW5nIGVycm9yXG4gICAgaWYgKCFjYkNhbGxlZCkge1xuICAgICAgb3B0cy5kZWJ1ZygnSlNPTlA6IEZhaWwuIFNjcmlwdCBsb2FkZWQgYnV0IGRpZCBub3QgY2FsbCB0aGUgY2FsbGJhY2snKTtcbiAgICAgIGNsZWFuKCk7XG4gICAgICBjYihuZXcgZXJyb3JzLkpTT05QU2NyaXB0RmFpbCgpKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZWFkeXN0YXRlY2hhbmdlKCkge1xuICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09ICdsb2FkZWQnIHx8IHRoaXMucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJykge1xuICAgICAgc3VjY2VzcygpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNsZWFuKCkge1xuICAgIGNsZWFyVGltZW91dChvbnRpbWVvdXQpO1xuICAgIHNjcmlwdC5vbmxvYWQgPSBudWxsO1xuICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgIHNjcmlwdC5vbmVycm9yID0gbnVsbDtcbiAgICBoZWFkLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVHbG9iYWxzKCkge1xuICAgIHRyeSB7XG4gICAgICBkZWxldGUgd2luZG93W2NiTmFtZV07XG4gICAgICBkZWxldGUgd2luZG93W2NiTmFtZSArICdfbG9hZGVkJ107XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgd2luZG93W2NiTmFtZV0gPSB3aW5kb3dbY2JOYW1lICsgJ19sb2FkZWQnXSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiB0aW1lb3V0KCkge1xuICAgIG9wdHMuZGVidWcoJ0pTT05QOiBTY3JpcHQgdGltZW91dCcpO1xuICAgIHRpbWVkT3V0ID0gdHJ1ZTtcbiAgICBjbGVhbigpO1xuICAgIGNiKG5ldyBlcnJvcnMuUmVxdWVzdFRpbWVvdXQoKSk7XG4gIH1cblxuICBmdW5jdGlvbiBlcnJvcigpIHtcbiAgICBvcHRzLmRlYnVnKCdKU09OUDogU2NyaXB0IGVycm9yJyk7XG5cbiAgICBpZiAoZG9uZSB8fCB0aW1lZE91dCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNsZWFuKCk7XG4gICAgY2IobmV3IGVycm9ycy5KU09OUFNjcmlwdEVycm9yKCkpO1xuICB9XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvYnJvd3Nlci9qc29ucC1yZXF1ZXN0LmpzXG4vLyBtb2R1bGUgaWQgPSA0OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlcHJlY2F0ZShmbiwgbWVzc2FnZSkge1xuICB2YXIgd2FybmVkID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gZGVwcmVjYXRlZCgpIHtcbiAgICBpZiAoIXdhcm5lZCkge1xuICAgICAgLyogZXNsaW50IG5vLWNvbnNvbGU6MCAqL1xuICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UpO1xuICAgICAgd2FybmVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIHJldHVybiBkZXByZWNhdGVkO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9kZXByZWNhdGUuanNcbi8vIG1vZHVsZSBpZCA9IDQ5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVwcmVjYXRlZE1lc3NhZ2UocHJldmlvdXNVc2FnZSwgbmV3VXNhZ2UpIHtcbiAgdmFyIGdpdGh1YkFuY2hvckxpbmsgPSBwcmV2aW91c1VzYWdlLnRvTG93ZXJDYXNlKClcbiAgICAucmVwbGFjZSgvW1xcLlxcKFxcKV0vZywgJycpO1xuXG4gIHJldHVybiAnYWxnb2xpYXNlYXJjaDogYCcgKyBwcmV2aW91c1VzYWdlICsgJ2Agd2FzIHJlcGxhY2VkIGJ5IGAnICsgbmV3VXNhZ2UgK1xuICAgICdgLiBQbGVhc2Ugc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hbGdvbGlhL2FsZ29saWFzZWFyY2gtY2xpZW50LWphdmFzY3JpcHQvd2lraS9EZXByZWNhdGVkIycgKyBnaXRodWJBbmNob3JMaW5rO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9kZXByZWNhdGVkTWVzc2FnZS5qc1xuLy8gbW9kdWxlIGlkID0gNTBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLy8gUGFyc2UgY2xvdWQgZG9lcyBub3Qgc3VwcG9ydHMgc2V0VGltZW91dFxuLy8gV2UgZG8gbm90IHN0b3JlIGEgc2V0VGltZW91dCByZWZlcmVuY2UgaW4gdGhlIGNsaWVudCBldmVyeXRpbWVcbi8vIFdlIG9ubHkgZmFsbGJhY2sgdG8gYSBmYWtlIHNldFRpbWVvdXQgd2hlbiBub3QgYXZhaWxhYmxlXG4vLyBzZXRUaW1lb3V0IGNhbm5vdCBiZSBvdmVycmlkZSBnbG9iYWxseSBzYWRseVxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBleGl0UHJvbWlzZShmbiwgX3NldFRpbWVvdXQpIHtcbiAgX3NldFRpbWVvdXQoZm4sIDApO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9leGl0UHJvbWlzZS5qc1xuLy8gbW9kdWxlIGlkID0gNTFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIGZvcmVhY2ggPSByZXF1aXJlKCdmb3JlYWNoJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbWVyZ2UoZGVzdGluYXRpb24vKiAsIHNvdXJjZXMgKi8pIHtcbiAgdmFyIHNvdXJjZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuXG4gIGZvcmVhY2goc291cmNlcywgZnVuY3Rpb24oc291cmNlKSB7XG4gICAgZm9yICh2YXIga2V5TmFtZSBpbiBzb3VyY2UpIHtcbiAgICAgIGlmIChzb3VyY2UuaGFzT3duUHJvcGVydHkoa2V5TmFtZSkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBkZXN0aW5hdGlvbltrZXlOYW1lXSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHNvdXJjZVtrZXlOYW1lXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICBkZXN0aW5hdGlvbltrZXlOYW1lXSA9IG1lcmdlKHt9LCBkZXN0aW5hdGlvbltrZXlOYW1lXSwgc291cmNlW2tleU5hbWVdKTtcbiAgICAgICAgfSBlbHNlIGlmIChzb3VyY2Vba2V5TmFtZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGRlc3RpbmF0aW9uW2tleU5hbWVdID0gc291cmNlW2tleU5hbWVdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gZGVzdGluYXRpb247XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL21lcmdlLmpzXG4vLyBtb2R1bGUgaWQgPSA1MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZVBsYWNlc0NsaWVudDtcblxudmFyIGJ1aWxkU2VhcmNoTWV0aG9kID0gcmVxdWlyZSgnLi9idWlsZFNlYXJjaE1ldGhvZC5qcycpO1xuXG5mdW5jdGlvbiBjcmVhdGVQbGFjZXNDbGllbnQoYWxnb2xpYXNlYXJjaCkge1xuICByZXR1cm4gZnVuY3Rpb24gcGxhY2VzKGFwcElELCBhcGlLZXksIG9wdHMpIHtcbiAgICB2YXIgY2xvbmVEZWVwID0gcmVxdWlyZSgnLi9jbG9uZS5qcycpO1xuXG4gICAgb3B0cyA9IG9wdHMgJiYgY2xvbmVEZWVwKG9wdHMpIHx8IHt9O1xuICAgIG9wdHMuaG9zdHMgPSBvcHRzLmhvc3RzIHx8IFtcbiAgICAgICdwbGFjZXMtZHNuLmFsZ29saWEubmV0JyxcbiAgICAgICdwbGFjZXMtMS5hbGdvbGlhbmV0LmNvbScsXG4gICAgICAncGxhY2VzLTIuYWxnb2xpYW5ldC5jb20nLFxuICAgICAgJ3BsYWNlcy0zLmFsZ29saWFuZXQuY29tJ1xuICAgIF07XG5cbiAgICAvLyBhbGxvdyBpbml0UGxhY2VzKCkgbm8gYXJndW1lbnRzID0+IGNvbW11bml0eSByYXRlIGxpbWl0ZWRcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCB8fCB0eXBlb2YgYXBwSUQgPT09ICdvYmplY3QnIHx8IGFwcElEID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGFwcElEID0gJyc7XG4gICAgICBhcGlLZXkgPSAnJztcbiAgICAgIG9wdHMuX2FsbG93RW1wdHlDcmVkZW50aWFscyA9IHRydWU7XG4gICAgfVxuXG4gICAgdmFyIGNsaWVudCA9IGFsZ29saWFzZWFyY2goYXBwSUQsIGFwaUtleSwgb3B0cyk7XG4gICAgdmFyIGluZGV4ID0gY2xpZW50LmluaXRJbmRleCgncGxhY2VzJyk7XG4gICAgaW5kZXguc2VhcmNoID0gYnVpbGRTZWFyY2hNZXRob2QoJ3F1ZXJ5JywgJy8xL3BsYWNlcy9xdWVyeScpO1xuICAgIGluZGV4LmdldE9iamVjdCA9IGZ1bmN0aW9uKG9iamVjdElELCBjYWxsYmFjaykge1xuICAgICAgcmV0dXJuIHRoaXMuYXMuX2pzb25SZXF1ZXN0KHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgdXJsOiAnLzEvcGxhY2VzLycgKyBlbmNvZGVVUklDb21wb25lbnQob2JqZWN0SUQpLFxuICAgICAgICBob3N0VHlwZTogJ3JlYWQnLFxuICAgICAgICBjYWxsYmFjazogY2FsbGJhY2tcbiAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIGluZGV4O1xuICB9O1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL3BsYWNlcy5qc1xuLy8gbW9kdWxlIGlkID0gNTNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIGRlYnVnID0gcmVxdWlyZSgnZGVidWcnKSgnYWxnb2xpYXNlYXJjaDpzcmMvaG9zdEluZGV4U3RhdGUuanMnKTtcbnZhciBsb2NhbFN0b3JhZ2VOYW1lc3BhY2UgPSAnYWxnb2xpYXNlYXJjaC1jbGllbnQtanMnO1xuXG52YXIgc3RvcmU7XG52YXIgbW9kdWxlU3RvcmUgPSB7XG4gIHN0YXRlOiB7fSxcbiAgc2V0OiBmdW5jdGlvbihrZXksIGRhdGEpIHtcbiAgICB0aGlzLnN0YXRlW2tleV0gPSBkYXRhO1xuICAgIHJldHVybiB0aGlzLnN0YXRlW2tleV07XG4gIH0sXG4gIGdldDogZnVuY3Rpb24oa2V5KSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGVba2V5XSB8fCBudWxsO1xuICB9XG59O1xuXG52YXIgbG9jYWxTdG9yYWdlU3RvcmUgPSB7XG4gIHNldDogZnVuY3Rpb24oa2V5LCBkYXRhKSB7XG4gICAgbW9kdWxlU3RvcmUuc2V0KGtleSwgZGF0YSk7IC8vIGFsd2F5cyByZXBsaWNhdGUgbG9jYWxTdG9yYWdlU3RvcmUgdG8gbW9kdWxlU3RvcmUgaW4gY2FzZSBvZiBmYWlsdXJlXG5cbiAgICB0cnkge1xuICAgICAgdmFyIG5hbWVzcGFjZSA9IEpTT04ucGFyc2UoZ2xvYmFsLmxvY2FsU3RvcmFnZVtsb2NhbFN0b3JhZ2VOYW1lc3BhY2VdKTtcbiAgICAgIG5hbWVzcGFjZVtrZXldID0gZGF0YTtcbiAgICAgIGdsb2JhbC5sb2NhbFN0b3JhZ2VbbG9jYWxTdG9yYWdlTmFtZXNwYWNlXSA9IEpTT04uc3RyaW5naWZ5KG5hbWVzcGFjZSk7XG4gICAgICByZXR1cm4gbmFtZXNwYWNlW2tleV07XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZUZhaWx1cmUoa2V5LCBlKTtcbiAgICB9XG4gIH0sXG4gIGdldDogZnVuY3Rpb24oa2V5KSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKGdsb2JhbC5sb2NhbFN0b3JhZ2VbbG9jYWxTdG9yYWdlTmFtZXNwYWNlXSlba2V5XSB8fCBudWxsO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2VGYWlsdXJlKGtleSwgZSk7XG4gICAgfVxuICB9XG59O1xuXG5mdW5jdGlvbiBsb2NhbFN0b3JhZ2VGYWlsdXJlKGtleSwgZSkge1xuICBkZWJ1ZygnbG9jYWxTdG9yYWdlIGZhaWxlZCB3aXRoJywgZSk7XG4gIGNsZWFudXAoKTtcbiAgc3RvcmUgPSBtb2R1bGVTdG9yZTtcbiAgcmV0dXJuIHN0b3JlLmdldChrZXkpO1xufVxuXG5zdG9yZSA9IHN1cHBvcnRzTG9jYWxTdG9yYWdlKCkgPyBsb2NhbFN0b3JhZ2VTdG9yZSA6IG1vZHVsZVN0b3JlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZ2V0OiBnZXRPclNldCxcbiAgc2V0OiBnZXRPclNldCxcbiAgc3VwcG9ydHNMb2NhbFN0b3JhZ2U6IHN1cHBvcnRzTG9jYWxTdG9yYWdlXG59O1xuXG5mdW5jdGlvbiBnZXRPclNldChrZXksIGRhdGEpIHtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICByZXR1cm4gc3RvcmUuZ2V0KGtleSk7XG4gIH1cblxuICByZXR1cm4gc3RvcmUuc2V0KGtleSwgZGF0YSk7XG59XG5cbmZ1bmN0aW9uIHN1cHBvcnRzTG9jYWxTdG9yYWdlKCkge1xuICB0cnkge1xuICAgIGlmICgnbG9jYWxTdG9yYWdlJyBpbiBnbG9iYWwgJiZcbiAgICAgIGdsb2JhbC5sb2NhbFN0b3JhZ2UgIT09IG51bGwpIHtcbiAgICAgIGlmICghZ2xvYmFsLmxvY2FsU3RvcmFnZVtsb2NhbFN0b3JhZ2VOYW1lc3BhY2VdKSB7XG4gICAgICAgIC8vIGFjdHVhbCBjcmVhdGlvbiBvZiB0aGUgbmFtZXNwYWNlXG4gICAgICAgIGdsb2JhbC5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShsb2NhbFN0b3JhZ2VOYW1lc3BhY2UsIEpTT04uc3RyaW5naWZ5KHt9KSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gY2F0Y2ggKF8pIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLy8gSW4gY2FzZSBvZiBhbnkgZXJyb3Igb24gbG9jYWxTdG9yYWdlLCB3ZSBjbGVhbiBvdXIgb3duIG5hbWVzcGFjZSwgdGhpcyBzaG91bGQgaGFuZGxlXG4vLyBxdW90YSBlcnJvcnMgd2hlbiBhIGxvdCBvZiBrZXlzICsgZGF0YSBhcmUgdXNlZFxuZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgdHJ5IHtcbiAgICBnbG9iYWwubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0obG9jYWxTdG9yYWdlTmFtZXNwYWNlKTtcbiAgfSBjYXRjaCAoXykge1xuICAgIC8vIG5vdGhpbmcgdG8gZG9cbiAgfVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL3N0b3JlLmpzXG4vLyBtb2R1bGUgaWQgPSA1NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0gJzMuMjkuMCc7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvdmVyc2lvbi5qc1xuLy8gbW9kdWxlIGlkID0gNTVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIHZlcnRleFNoYWRlciA6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHV2cy54eSA9IHV2Lnh5O1xuICAgICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1xuICAgIH1cbiAgYCxcblxuICBmcmFnbWVudFNoYWRlcjogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdW5pZm9ybSBzYW1wbGVyMkQgc3JjO1xuXG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgZ2xfRnJhZ0NvbG9yID0gdGV4dHVyZTJEKHNyYywgdXZzKTtcbiAgICB9XG5gfTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2Fzc2V0cy9zaGFkZXJzL2ZsYXQuanMiLCJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmVydGV4U2hhZGVyIDogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHV2cy54eSA9IHV2Lnh5O1xuICAgICAgdmVjNCBwID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcbiAgICAgIHdvcmxkUG9zID0gKG1vZGVsTWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApKS54eXo7XG4gICAgICBnbF9Qb3NpdGlvbiA9IHA7XG4gICAgfVxuICBgLFxuXG4gIGZyYWdtZW50U2hhZGVyOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdW5pZm9ybSB2ZWMzIHR1bm5lbE5lb247XG4gICAgdW5pZm9ybSB2ZWMzIGxlZnRMYXNlcjtcbiAgICB1bmlmb3JtIHZlYzMgcmlnaHRMYXNlcjtcbiAgICB1bmlmb3JtIHZlYzMgZmxvb3JOZW9uO1xuICAgIHVuaWZvcm0gdmVjMyB0ZXh0R2xvdztcbiAgICB1bmlmb3JtIHNhbXBsZXIyRCBzcmM7XG5cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICBmbG9hdCBtYXNrO1xuICAgICAgdmVjNCBjb2wgPSB0ZXh0dXJlMkQoc3JjLCB1dnMpO1xuXG4gICAgICAvLyB0dW5uZWwgbmVvblxuICAgICAgbWFzayA9IHN0ZXAoMC44NywgdXZzLngpICogIHN0ZXAoMC41LCB1dnMueSkgKiAoMS4wIC0gc3RlcCgwLjkzNSwgdXZzLngpKSAqICggMS4wIC0gc3RlcCgwLjc1LCB1dnMueSkpO1xuICAgICAgY29sLnh5eiA9IG1peChjb2wueHl6LCBjb2wueHl6ICogdHVubmVsTmVvbiwgbWFzayk7XG5cbiAgICAgIC8vIGZsb29yICYgY29ycmlkb3IgbmVvbnNcbiAgICAgIG1hc2sgPSBzdGVwKDAuOTM1LCB1dnMueCkgKiBzdGVwKDAuNSwgdXZzLnkpICogKCAxLjAgLSBzdGVwKDAuNzUsIHV2cy55KSk7XG4gICAgICBjb2wueHl6ID0gbWl4KGNvbC54eXosIGNvbC54eXogKiBmbG9vck5lb24sIG1hc2spO1xuXG4gICAgICAvLyBsZWZ0IGxhc2VyXG4gICAgICBtYXNrID0gc3RlcCgwLjUsIHV2cy54KSAqICgxLjAgLSBzdGVwKDAuNjI1LCB1dnMueCkpICogKDEuMCAtIHN0ZXAoMC41LCB1dnMueSkpO1xuICAgICAgY29sLnh5eiA9IG1peChjb2wueHl6LCBjb2wueHl6ICogbGVmdExhc2VyLCBtYXNrKTtcblxuICAgICAgLy8gcmlnaHQgbGFzZXJcbiAgICAgIG1hc2sgPSBzdGVwKDAuNjI1LCB1dnMueCkgKiAoMS4wIC0gc3RlcCgwLjc1LCB1dnMueCkpICogKDEuMCAtIHN0ZXAoMC41LCB1dnMueSkpO1xuICAgICAgY29sLnh5eiA9IG1peChjb2wueHl6LCBjb2wueHl6ICogcmlnaHRMYXNlciwgbWFzayk7XG5cbiAgICAgIC8vIHRleHQgZ2xvd3NcbiAgICAgIG1hc2sgPSBzdGVwKDAuODcsIHV2cy54KSAqICBzdGVwKDAuMjUsIHV2cy55KSAqICgxLjAgLSBzdGVwKDAuOTM1LCB1dnMueCkpICogKCAxLjAgLSBzdGVwKDAuNSwgdXZzLnkpKTtcbiAgICAgIGNvbC54eXogPSBtaXgoY29sLnh5eiwgY29sLnh5eiAqIHRleHRHbG93LCBtYXNrKTtcblxuICAgICAgZ2xfRnJhZ0NvbG9yID0gY29sO1xuICAgIH1cbiAgYFxufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2Fzc2V0cy9zaGFkZXJzL3N0YWdlQWRkaXRpdmUuanMiLCJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmVydGV4U2hhZGVyIDogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHV2cy54eSA9IHV2Lnh5O1xuICAgICAgdmVjNCBwID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcbiAgICAgIHdvcmxkUG9zID0gKG1vZGVsTWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApKS54eXo7XG4gICAgICBnbF9Qb3NpdGlvbiA9IHA7XG4gICAgfVxuICBgLFxuXG4gIGZyYWdtZW50U2hhZGVyOiBgXG4gICAgI2RlZmluZSBGT0dfUkFESVVTICA1NS4wXG4gICAgI2RlZmluZSBGT0dfRkFMTE9GRiA0OC4wXG4gICAgI2RlZmluZSBGT0dfQ09MT1JfTVVMVCAwLjhcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB1bmlmb3JtIHZlYzMgc2t5Q29sb3I7XG4gICAgdW5pZm9ybSB2ZWMzIGJhY2tnbG93Q29sb3I7XG4gICAgdW5pZm9ybSBzYW1wbGVyMkQgc3JjO1xuXG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdmVjNCBjb2wgPSB0ZXh0dXJlMkQoc3JjLCB1dnMpO1xuICAgICAgZmxvYXQgbWFzaztcblxuICAgICAgLy8gYmdcbiAgICAgIG1hc2sgPSBzdGVwKDAuNSwgdXZzLngpO1xuICAgICAgY29sLnh5eiA9IG1peChjb2wueHl6ICogc2t5Q29sb3IsIGNvbC54eXosIG1hc2spO1xuXG4gICAgICAvLyBiYWNrZ2xvd1xuICAgICAgbWFzayA9IHN0ZXAoMC41LCB1dnMueCkgKiBzdGVwKDAuNSwgdXZzLnkpICogKDEuMCAtIHN0ZXAoMC43NSwgdXZzLngpKTtcbiAgICAgIGNvbC54eXogPSBtaXgoY29sLnh5eiwgY29sLnh5eiAqIGJhY2tnbG93Q29sb3IsIG1hc2spO1xuXG4gICAgICBmbG9hdCBmb2dEZW5zaXR5ID0gMS4wIC0gcG93KGNsYW1wKGRpc3RhbmNlKHdvcmxkUG9zLCB2ZWMzKDAuLCAwLiwgLUZPR19SQURJVVMpKSAvIEZPR19GQUxMT0ZGLCAwLjAsIDEuMCksIDEuNSk7XG4gICAgICBmb2dEZW5zaXR5ICs9IGNsYW1wKDAuMiAtIHBvdyhkaXN0YW5jZSh3b3JsZFBvcywgdmVjMygwLjAsIDAuMCwgd29ybGRQb3MueikpIC8gMTAuMCwgMi4wKSwgMC4wLCAxLjApO1xuICAgICAgY29sLnh5eiA9IG1peChjb2wueHl6LCBiYWNrZ2xvd0NvbG9yICogRk9HX0NPTE9SX01VTFQsIGZvZ0RlbnNpdHkpO1xuXG4gICAgICBnbF9GcmFnQ29sb3IgPSBjb2w7XG4gICAgfVxuICBgXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vYXNzZXRzL3NoYWRlcnMvc3RhZ2VOb3JtYWwuanMiLCIvKipcbiAqIEFjdGl2ZSBjb2xvci5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdhY3RpdmUtY29sb3InLCB7XG4gIGRlcGVuZGVuY2llczogWydtYXRlcmlhbCddLFxuXG4gIHNjaGVtYToge1xuICAgIGFjdGl2ZToge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBjb2xvcjoge2RlZmF1bHQ6ICcjZmZmZmZmJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5kZWZhdWx0Q29sb3IgPSB0aGlzLmVsLmdldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnKS5jb2xvcjtcbiAgICB0aGlzLm1hdGVyaWFsT2JqID0ge2NvbG9yOiB0aGlzLmRhdGEuY29sb3IsIG9wYWNpdHk6IDF9O1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG5cbiAgICBpZiAodGhpcy5kYXRhLmFjdGl2ZSkge1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHRoaXMubWF0ZXJpYWxPYmopO1xuICAgICAgZWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnY29sb3InLCB0aGlzLmRlZmF1bHRDb2xvcik7XG4gICAgICBpZiAoZWwuY29tcG9uZW50cy5hbmltYXRpb25fX21vdXNlbGVhdmUpIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7IGVsLmVtaXQoJ21vdXNlbGVhdmUnLCBudWxsLCBmYWxzZSk7IH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSk7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYWN0aXZlLXRleHQtY29sb3InLCB7XG4gIGRlcGVuZGVuY2llczogWyd0ZXh0J10sXG5cbiAgc2NoZW1hOiB7XG4gICAgYWN0aXZlOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGNvbG9yOiB7ZGVmYXVsdDogJyMzMzMnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmRlZmF1bHRDb2xvciA9IHRoaXMuZWwuZ2V0QXR0cmlidXRlKCd0ZXh0JykuY29sb3I7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICBpZiAodGhpcy5kYXRhLmFjdGl2ZSkge1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCd0ZXh0JywgJ2NvbG9yJywgdGhpcy5kYXRhLmNvbG9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCd0ZXh0JywgJ2NvbG9yJywgdGhpcy5kZWZhdWx0Q29sb3IpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9hY3RpdmUtY29sb3IuanMiLCJcbmNvbnN0IE5VTV9WQUxVRVNfUEVSX0JPWCA9IDkwO1xuXG4vKipcbiAqIENvbHVtbiBiYXJzIG1vdmluZyBpbiBzeW5jIHRvIHRoZSBhdWRpbyB2aWEgYXVkaW8gYW5hbHlzZXIuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYXVkaW8tY29sdW1ucycsIHtcbiAgc2NoZW1hOiB7XG4gICAgYW5hbHlzZXI6IHt0eXBlOiAnc2VsZWN0b3InLCBkZWZhdWx0OiAnI2F1ZGlvQW5hbHlzZXInfSxcbiAgICBoZWlnaHQ6IHtkZWZhdWx0OiAxLjB9LFxuICAgIG1pcnJvcjoge2RlZmF1bHQ6IDN9LFxuICAgIHNjYWxlOiB7ZGVmYXVsdDogNC4wfSxcbiAgICBzZXBhcmF0aW9uOiB7ZGVmYXVsdDogMC4zfSxcbiAgICB0aGlja25lc3M6IHtkZWZhdWx0OiAwLjF9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBvYmpEYXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F1ZGlvY29sdW1uT2JqJykuZGF0YTtcbiAgICB2YXIgbG9hZGVyID0gbmV3IFRIUkVFLk9CSkxvYWRlcigpO1xuICAgIHZhciBjb2x1bW5HZW9tZXRyeSA9IGxvYWRlci5wYXJzZShvYmpEYXRhKS5jaGlsZHJlblswXS5nZW9tZXRyeTtcblxuICAgIHRoaXMuYW5hbHlzZXIgPSB0aGlzLmRhdGEuYW5hbHlzZXIuY29tcG9uZW50cy5hdWRpb2FuYWx5c2VyO1xuXG4gICAgLy8gTnVtYmVyIG9mIGxldmVscyBpcyBoYWxmIHRoZSBGRlQgc2l6ZS5cbiAgICB0aGlzLmZyZXF1ZW5jeUJpbkNvdW50ID0gdGhpcy5hbmFseXNlci5kYXRhLmZmdFNpemUgLyAyO1xuXG4gICAgLy8gQ3JlYXRlIGJveGVzIChvbmUgcm93IG9uIGVhY2ggc2lkZSBwZXIgbGV2ZWwpLlxuICAgIGNvbnN0IGdlb21ldHJpZXMgPSBbXTtcbiAgICBsZXQgelBvc2l0aW9uID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZnJlcXVlbmN5QmluQ291bnQ7IGkrKykge1xuICAgICAgZm9yIChsZXQgc2lkZSA9IDA7IHNpZGUgPCAyOyBzaWRlKyspIHtcbiAgICAgICAgY29uc3QgYm94ID0gY29sdW1uR2VvbWV0cnkuY2xvbmUoKTtcbiAgICAgICAgdGhpcy5pbml0Qm94KGJveCwgc2lkZSA9PT0gMCA/IDEgOiAtMSwgelBvc2l0aW9uKTtcbiAgICAgICAgZ2VvbWV0cmllcy5wdXNoKGJveCk7XG4gICAgICAgIC8vIE1vdmUgWiBiYWNrLlxuICAgICAgICB6UG9zaXRpb24gLT0gdGhpcy5kYXRhLnNlcGFyYXRpb247XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5nZW9tZXRyeSA9IFRIUkVFLkJ1ZmZlckdlb21ldHJ5VXRpbHMubWVyZ2VCdWZmZXJHZW9tZXRyaWVzKGdlb21ldHJpZXMpO1xuICAgIGNvbnN0IG1lc2ggPSBuZXcgVEhSRUUuTWVzaCh0aGlzLmdlb21ldHJ5LCB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbHMuc3RhZ2VOb3JtYWwpO1xuICAgIHRoaXMuZWwuc2V0T2JqZWN0M0QoJ21lc2gnLCBtZXNoKTtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gU3RlcCBieSAyIHNpbmNlIHdlIGNyZWF0ZSBvbmUgYm94IG9mIGVhY2ggc2lkZSBwZXIgbGV2ZWwuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZyZXF1ZW5jeUJpbkNvdW50ICogMjsgaSArPSAyKSB7XG4gICAgICBsZXQgeVNjYWxlID0gKHRoaXMuZGF0YS5oZWlnaHQgLyAyKSArIHRoaXMuYW5hbHlzZXIubGV2ZWxzW01hdGguZmxvb3IoaSAvIDIpXSAvIDI1Ni4wICpcbiAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuc2NhbGU7XG4gICAgICBpZiAoaXNOYU4oeVNjYWxlKSkgeyByZXR1cm47IH1cbiAgICAgIHRoaXMuc2V0Qm94SGVpZ2h0KHRoaXMuZnJlcXVlbmN5QmluQ291bnQgKiAyIC0gaSAtIDEsIHlTY2FsZSk7XG4gICAgICB0aGlzLnNldEJveEhlaWdodCh0aGlzLmZyZXF1ZW5jeUJpbkNvdW50ICogMiAtIGkgLSAyLCB5U2NhbGUpO1xuICAgICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYm94IGJ5IGNoYW5naW5nIHZlcnRleCBidWZmZXIsIHRvIHNldCBwb3NpdGlvbiBhbmQgc2NhbGUuXG4gICAqL1xuICBpbml0Qm94OiBmdW5jdGlvbiAoYm94LCBmbGlwLCB6UG9zaXRpb24pIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgLy8gU2V0IHBvc2l0aW9uIGFuZCBzY2FsZSBvZiBib3ggdmlhIHZlcnRpY2VzLlxuICAgIGZvciAobGV0IHYgPSAwOyB2IDwgYm94LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXkubGVuZ3RoOyB2ICs9IDMpIHtcbiAgICAgIC8vIEFwcGx5IHRoaWNrbmVzcyB0byBYIGFuZCBaLlxuICAgICAgLy8gYm94LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXlbdl0gKj0gZGF0YS50aGlja25lc3M7XG4gICAgICAvLyBib3guYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheVt2ICsgMl0gKj0gZGF0YS50aGlja25lc3M7XG4vLyBBcHBseSB6UG9zaXRpb24uXG4gICAgICBib3guYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheVt2ICsgMl0gKz0gelBvc2l0aW9uO1xuXG4gICAgICAvLyBBcHBseSBoZWlnaHQgdG8gWS5cbiAgICAgIGJveC5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5W3YgKyAxXSAqPSBkYXRhLmhlaWdodCAvIDI7XG5cbiAgICAgIC8vIENoYW5nZSBYIHZlcnRleCBwb3NpdGlvbnMgZm9yIG1pcnJvcmluZy5cbiAgICAgIGJveC5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5W3ZdICs9IGZsaXAgKiBkYXRhLm1pcnJvcjtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFNldCBZIG9mIHZlcnRpY2VzLlxuICAgKi9cbiAgc2V0Qm94SGVpZ2h0OiBmdW5jdGlvbiAoYm94TnVtYmVyLCBoZWlnaHQpIHtcbiAgICBjb25zdCBib3hJbmRleCA9IGJveE51bWJlciAqIE5VTV9WQUxVRVNfUEVSX0JPWDtcbiAgICBmb3IgKGxldCBpID0gYm94SW5kZXg7IGkgPCBib3hJbmRleCArIE5VTV9WQUxVRVNfUEVSX0JPWDsgaSArPSAzKSB7XG4gICAgICAvLyBTZXQgWS5cbiAgICAgIGxldCB5VmFsdWUgPSB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXlbaSArIDFdO1xuICAgICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5W2kgKyAxXSA9IHlWYWx1ZSA+PSAwXG4gICAgICAgID8gaGVpZ2h0XG4gICAgICAgIDogLTEgKiBoZWlnaHQ7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2F1ZGlvLWNvbHVtbnMuanMiLCJjb25zdCBBTklNRSA9IEFGUkFNRS5BTklNRSB8fCBBRlJBTUUuYW5pbWU7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmVhbXMnLCB7XG4gIHNjaGVtYToge1xuICAgIGlzUGxheWluZzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBwb29sU2l6ZToge2RlZmF1bHQ6IDN9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmVhbXMgPSBbXTtcbiAgICB0aGlzLmN1cnJlbnRSZWQgPSAwO1xuICAgIHRoaXMuY3VycmVudEJsdWUgPSAwO1xuICAgIHRoaXMuY2xlYXJCZWFtcyA9IHRoaXMuY2xlYXJCZWFtcy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5hZGRFdmVudExpc3RlbmVyKCdjbGVhcmdhbWUnLCB0aGlzLmNsZWFyQmVhbXMpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5iZWFtcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMuYmVhbXNbaV0udGltZSkge1xuICAgICAgICB0aGlzLmJlYW1zW2ldLnZpc2libGUgPSB0aGlzLmRhdGEuaXNQbGF5aW5nO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gQmVhbSBwb29scy5cbiAgICAvL2NvbnN0IGdlb21ldHJ5ID0gbmV3IFRIUkVFLlBsYW5lQnVmZmVyR2VvbWV0cnkoMC40LCA1MCkudHJhbnNsYXRlKDAsIDI1LCAwKTtcblxuICAgIHZhciBvYmpEYXRhO1xuICAgIHZhciBsb2FkZXI7XG4gICAgdmFyIHJlZEdlb21ldHJ5LCBibHVlR2VvbWV0cnk7XG5cbiAgICB2YXIgbG9hZGVyID0gbmV3IFRIUkVFLk9CSkxvYWRlcigpO1xuICAgIG9iakRhdGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVkYmVhbU9iaicpLmRhdGE7XG4gICAgcmVkR2VvbWV0cnkgPSBsb2FkZXIucGFyc2Uob2JqRGF0YSkuY2hpbGRyZW5bMF0uZ2VvbWV0cnk7XG5cbiAgICBvYmpEYXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JsdWViZWFtT2JqJykuZGF0YTtcbiAgICBibHVlR2VvbWV0cnkgPSBsb2FkZXIucGFyc2Uob2JqRGF0YSkuY2hpbGRyZW5bMF0uZ2VvbWV0cnk7XG5cbiAgICB0aGlzLnJlZEJlYW1zID0gdGhpcy5jcmVhdGVCZWFtUG9vbChyZWRHZW9tZXRyeSwgdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMubWF0ZXJpYWxzLnN0YWdlQWRkaXRpdmUpO1xuICAgIHRoaXMuYmx1ZUJlYW1zID0gdGhpcy5jcmVhdGVCZWFtUG9vbChibHVlR2VvbWV0cnksIHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFscy5zdGFnZUFkZGl0aXZlKTtcbiAgfSxcblxuICAvKipcbiAgICogVXNlIHRpY2sgZm9yIG1hbnVhbCBBTklNRSBhbmltYXRpb25zLCBlbHNlIGl0IHdpbGwgY3JlYXRlIFJBRi5cbiAgICovXG4gIHRpY2s6IGZ1bmN0aW9uICh0LCBkdCkge1xuICAgIGlmICghdGhpcy5kYXRhLmlzUGxheWluZykgeyByZXR1cm47IH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmVhbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBiZWFtID0gdGhpcy5iZWFtc1tpXTtcbiAgICAgIC8vIFRpZSBhbmltYXRpb24gc3RhdGUgdG8gYmVhbSB2aXNpYmlsaXR5LlxuICAgICAgaWYgKCFiZWFtLnZpc2libGUpIHsgY29udGludWU7IH1cbiAgICAgIGJlYW0udGltZSArPSBkdDtcbiAgICAgIGJlYW0uYW5pbWF0aW9uLnRpY2soYmVhbS50aW1lKTtcbiAgICB9XG4gIH0sXG5cbiAgY3JlYXRlQmVhbVBvb2w6IGZ1bmN0aW9uIChnZW9tZXRyeSwgbWF0ZXJpYWwpIHtcbiAgICBjb25zdCBiZWFtcyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5kYXRhLnBvb2xTaXplOyBpKyspIHtcbiAgICAgIGxldCBiZWFtID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcbiAgICAgIGJlYW0udmlzaWJsZSA9IGZhbHNlO1xuICAgICAgYmVhbS5hbmltYXRpb24gPSBBTklNRSh7XG4gICAgICAgIGF1dG9wbGF5OiBmYWxzZSxcbiAgICAgICAgdGFyZ2V0czogYmVhbS5zY2FsZSxcbiAgICAgICAgeDogMC4wMDAwMSxcbiAgICAgICAgZHVyYXRpb246IDMwMCxcbiAgICAgICAgZWFzaW5nOiAnZWFzZUluQ3ViaWMnLFxuICAgICAgICBjb21wbGV0ZTogKCkgPT4geyBiZWFtLnZpc2libGUgPSBmYWxzZTsgfVxuICAgICAgfSk7XG4gICAgICB0aGlzLmVsLm9iamVjdDNELmFkZChiZWFtKTtcbiAgICAgIGJlYW1zLnB1c2goYmVhbSk7XG4gICAgICB0aGlzLmJlYW1zLnB1c2goYmVhbSk7XG4gICAgfVxuICAgIHJldHVybiBiZWFtcztcbiAgfSxcblxuICBuZXdCZWFtOiBmdW5jdGlvbiAoY29sb3IsIHBvc2l0aW9uKSB7XG4gICAgdmFyIGJlYW07XG4gICAgaWYgKGNvbG9yID09PSAncmVkJykge1xuICAgICAgYmVhbSA9IHRoaXMucmVkQmVhbXNbdGhpcy5jdXJyZW50UmVkXTtcbiAgICAgIHRoaXMuY3VycmVudFJlZCA9ICh0aGlzLmN1cnJlbnRSZWQgKyAxKSAlIHRoaXMucmVkQmVhbXMubGVuZ3RoO1xuICAgICAgLy8geiBvZmZzZXQgdG8gYXZvaWQgei1maWdodGluZy5cbiAgICAgIGJlYW0ucG9zaXRpb24uc2V0KHBvc2l0aW9uLngsIHBvc2l0aW9uLnksIHBvc2l0aW9uLnogKyB0aGlzLmN1cnJlbnRSZWQgLyA1MC4wKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYmVhbSA9IHRoaXMuYmx1ZUJlYW1zW3RoaXMuY3VycmVudEJsdWVdO1xuICAgICAgdGhpcy5jdXJyZW50Qmx1ZSA9ICh0aGlzLmN1cnJlbnRCbHVlICsgMSkgJSB0aGlzLmJsdWVCZWFtcy5sZW5ndGg7XG4gICAgICBiZWFtLnBvc2l0aW9uLnNldChwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBwb3NpdGlvbi56ICsgdGhpcy5jdXJyZW50Qmx1ZSAvIDUwLjApO1xuICAgIH1cblxuICAgIGJlYW0udmlzaWJsZSA9IHRydWU7XG4gICAgYmVhbS5zY2FsZS54ID0gMTtcbiAgICBiZWFtLnRpbWUgPSAwO1xuICB9LFxuXG4gIGNsZWFyQmVhbXM6IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmVhbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuYmVhbXNbaV0udmlzaWJsZSA9IGZhbHNlO1xuICAgICAgdGhpcy5iZWFtc1tpXS50aW1lID0gMDtcbiAgICAgIHRoaXMuYmVhbXNbaV0uc2NhbGUueCA9IDE7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2JlYW1zLmpzIiwidmFyIGF1ZGlvQ29udGV4dCA9IG5ldyB3aW5kb3cuQXVkaW9Db250ZXh0KCk7XG52YXIgc291cmNlQ3JlYXRlZENhbGxiYWNrO1xuXG5jb25zdCBMQVlFUl9CT1RUT00gPSAnYm90dG9tJztcbmNvbnN0IExBWUVSX01JRERMRSA9ICdtaWRkbGUnO1xuY29uc3QgTEFZRVJfVE9QID0gJ3RvcCc7XG5jb25zdCBWT0xVTUUgPSAwLjI1O1xuXG4vLyBBbGxvd3MgZm9yIG1vZGlmeWluZyBkZXR1bmUuIFBSIGhhcyBiZWVuIHNlbnQgdG8gdGhyZWUuanMuXG5USFJFRS5BdWRpby5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMuaXNQbGF5aW5nID09PSB0cnVlKSB7XG4gICAgY29uc29sZS53YXJuKCdUSFJFRS5BdWRpbzogQXVkaW8gaXMgYWxyZWFkeSBwbGF5aW5nLicpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0aGlzLmhhc1BsYXliYWNrQ29udHJvbCA9PT0gZmFsc2UpIHtcbiAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkF1ZGlvOiB0aGlzIEF1ZGlvIGhhcyBubyBwbGF5YmFjayBjb250cm9sLicpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBzb3VyY2UgPSB0aGlzLmNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gIHNvdXJjZS5idWZmZXIgPSB0aGlzLmJ1ZmZlcjtcbiAgc291cmNlLmRldHVuZS52YWx1ZSA9IHRoaXMuZGV0dW5lO1xuICBzb3VyY2UubG9vcCA9IHRoaXMubG9vcDtcbiAgc291cmNlLm9uZW5kZWQgPSB0aGlzLm9uRW5kZWQuYmluZCh0aGlzKTtcbiAgc291cmNlLnBsYXliYWNrUmF0ZS5zZXRWYWx1ZUF0VGltZSh0aGlzLnBsYXliYWNrUmF0ZSwgdGhpcy5zdGFydFRpbWUpO1xuICB0aGlzLnN0YXJ0VGltZSA9IHRoaXMuY29udGV4dC5jdXJyZW50VGltZTtcbiAgaWYgKHNvdXJjZUNyZWF0ZWRDYWxsYmFjaykgeyBzb3VyY2VDcmVhdGVkQ2FsbGJhY2soc291cmNlKTsgfVxuICBzb3VyY2Uuc3RhcnQodGhpcy5zdGFydFRpbWUsIHRoaXMub2Zmc2V0KTtcblxuICB0aGlzLmlzUGxheWluZyA9IHRydWU7XG5cbiAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gIHJldHVybiB0aGlzLmNvbm5lY3QoKTtcbn07XG5cbi8qKlxuICogQmVhdCBoaXQgc291bmQgdXNpbmcgcG9zaXRpb25hbCBhdWRpbyBhbmQgYXVkaW8gYnVmZmVyIHNvdXJjZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdiZWF0LWhpdC1zb3VuZCcsIHtcbiAgZGlyZWN0aW9uc1RvU291bmRzOiB7XG4gICAgdXA6ICcnLFxuICAgIGRvd246ICcnLFxuICAgIHVwbGVmdDogJ2xlZnQnLFxuICAgIHVwcmlnaHQ6ICdyaWdodCcsXG4gICAgZG93bmxlZnQ6ICdsZWZ0JyxcbiAgICBkb3ducmlnaHQ6ICdyaWdodCcsXG4gICAgbGVmdDogJ2xlZnQnLFxuICAgIHJpZ2h0OiAncmlnaHQnXG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY3VycmVudEJlYXRFbCA9IG51bGw7XG4gICAgdGhpcy5jdXJyZW50Q3V0RGlyZWN0aW9uID0gJyc7XG4gICAgdGhpcy5wcm9jZXNzU291bmQgPSB0aGlzLnByb2Nlc3NTb3VuZC5iaW5kKHRoaXMpO1xuICAgIHNvdXJjZUNyZWF0ZWRDYWxsYmFjayA9IHRoaXMuc291cmNlQ3JlYXRlZENhbGxiYWNrLmJpbmQodGhpcyk7XG5cbiAgICAvLyBTb3VuZCBwb29scy5cbiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSAxMDsgaSsrKSB7XG4gICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZShgc291bmRfX2JlYXRoaXQke2l9YCwge1xuICAgICAgICBwb29sU2l6ZTogNCxcbiAgICAgICAgc3JjOiBgI2hpdFNvdW5kJHtpfWAsXG4gICAgICAgIHZvbHVtZTogVk9MVU1FXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKGBzb3VuZF9fYmVhdGhpdCR7aX1sZWZ0YCwge1xuICAgICAgICBwb29sU2l6ZTogNCxcbiAgICAgICAgc3JjOiBgI2hpdFNvdW5kJHtpfWxlZnRgLFxuICAgICAgICB2b2x1bWU6IFZPTFVNRVxuICAgICAgfSk7XG4gICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZShgc291bmRfX2JlYXRoaXQke2l9cmlnaHRgLCB7XG4gICAgICAgIHBvb2xTaXplOiA0LFxuICAgICAgICBzcmM6IGAjaGl0U291bmQke2l9cmlnaHRgLFxuICAgICAgICB2b2x1bWU6IFZPTFVNRVxuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBLaWNrIHRocmVlLmpzIGxvYWRlci4uLkRvbid0IGtub3cgd2h5IHNvbWV0aW1lcyBkb2Vzbid0IGxvYWQuXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gMTA7IGkrKykge1xuICAgICAgaWYgKCF0aGlzLmVsLmNvbXBvbmVudHNbYHNvdW5kX19iZWF0aGl0JHtpfWBdLmxvYWRlZCkge1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZShgc291bmRfX2JlYXRoaXQke2l9YCwgJ3NyYycsICcnKTtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoYHNvdW5kX19iZWF0aGl0JHtpfWAsICdzcmMnLCBgI2hpdFNvdW5kJHtpfWApO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmVsLmNvbXBvbmVudHNbYHNvdW5kX19iZWF0aGl0JHtpfWxlZnRgXS5sb2FkZWQpIHtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoYHNvdW5kX19iZWF0aGl0JHtpfWxlZnRgLCAnc3JjJywgJycpO1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZShgc291bmRfX2JlYXRoaXQke2l9bGVmdGAsICdzcmMnLCBgI2hpdFNvdW5kJHtpfWxlZnRgKTtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5lbC5jb21wb25lbnRzW2Bzb3VuZF9fYmVhdGhpdCR7aX1yaWdodGBdLmxvYWRlZCkge1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZShgc291bmRfX2JlYXRoaXQke2l9cmlnaHRgLCAnc3JjJywgJycpO1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZShgc291bmRfX2JlYXRoaXQke2l9cmlnaHRgLCAnc3JjJywgYCNoaXRTb3VuZCR7aX1yaWdodGApO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBwbGF5U291bmQ6IGZ1bmN0aW9uIChiZWF0RWwsIGN1dERpcmVjdGlvbikge1xuICAgIGNvbnN0IHJhbmQgPSAxICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIGNvbnN0IGRpciA9IHRoaXMuZGlyZWN0aW9uc1RvU291bmRzW2N1dERpcmVjdGlvbiB8fCAndXAnXTtcbiAgICBjb25zdCBzb3VuZFBvb2wgPSB0aGlzLmVsLmNvbXBvbmVudHNbYHNvdW5kX19iZWF0aGl0JHtyYW5kfSR7ZGlyfWBdO1xuICAgIHRoaXMuY3VycmVudEJlYXRFbCA9IGJlYXRFbDtcbiAgICBzb3VuZFBvb2wucGxheVNvdW5kKHRoaXMucHJvY2Vzc1NvdW5kKTtcbiAgfSxcblxuICAvKipcbiAgICogU2V0IGF1ZGlvIHN0dWZmIGJlZm9yZSBwbGF5aW5nLlxuICAgKi9cbiAgcHJvY2Vzc1NvdW5kOiBmdW5jdGlvbiAoYXVkaW8pIHtcbiAgICBhdWRpby5kZXR1bmUgPSAwO1xuICAgIHRoaXMuY3VycmVudEJlYXRFbC5vYmplY3QzRC5nZXRXb3JsZFBvc2l0aW9uKGF1ZGlvLnBvc2l0aW9uKTtcbiAgfSxcblxuICAvKipcbiAgICogRnVuY3Rpb24gY2FsbGJhY2sgdG8gcHJvY2VzcyBzb3VyY2UgYnVmZmVyIG9uY2UgY3JlYXRlZC5cbiAgICogU2V0IGRldHVuZSBmb3IgcGl0Y2ggYW5kIGluZmxlY3Rpb25zLlxuICAgKi9cbiAgc291cmNlQ3JlYXRlZENhbGxiYWNrOiBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgLy8gUGl0Y2ggYmFzZWQgb24gbGF5ZXIuXG4gICAgY29uc3QgbGF5ZXIgPSB0aGlzLmdldExheWVyKHRoaXMuY3VycmVudEJlYXRFbC5vYmplY3QzRC5wb3NpdGlvbi55KTtcbiAgICBpZiAobGF5ZXIgPT09IExBWUVSX0JPVFRPTSkge1xuICAgICAgc291cmNlLmRldHVuZS5zZXRWYWx1ZUF0VGltZSgtNDAwLCAwKTtcbiAgICB9IGVsc2UgaWYgKGxheWVyID09PSBMQVlFUl9UT1ApIHtcbiAgICAgIHNvdXJjZS5kZXR1bmUuc2V0VmFsdWVBdFRpbWUoMjAwLCAwKTtcbiAgICB9XG5cbiAgICAvLyBJbmZsZWN0aW9uIG9uIHN0cmlrZSBkb3duIG9yIHVwLlxuICAgIGlmICh0aGlzLmN1cnJlbnRDdXREaXJlY3Rpb24gPT09ICdkb3duJykge1xuICAgICAgc291cmNlLmRldHVuZS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSgtNDAwLCAxKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuY3VycmVudEN1dERpcmVjdGlvbiA9PT0gJ3VwJykge1xuICAgICAgc291cmNlLmRldHVuZS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSg0MDAsIDEpO1xuICAgIH1cblx0fSxcblxuICAvKipcbiAgICogR2V0IHdoZXRoZXIgYmVhdCBpcyBvbiBib3R0b20sIG1pZGRsZSwgb3IgdG9wIGxheWVyLlxuICAgKi9cbiAgZ2V0TGF5ZXI6IGZ1bmN0aW9uICh5KSB7XG4gICAgaWYgKHkgPT09IDEpIHsgcmV0dXJuIExBWUVSX0JPVFRPTTsgfVxuICAgIGlmICh5ID09PSAxLjcwKSB7IHJldHVybiBMQVlFUl9UT1A7IH1cbiAgICByZXR1cm4gTEFZRVJfTUlERExFO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2JlYXQtaGl0LXNvdW5kLmpzIiwiaW1wb3J0IHtCRUFUX1dBUk1VUF9PRkZTRVQsIEJFQVRfV0FSTVVQX1NQRUVELCBCRUFUX1dBUk1VUF9USU1FfSBmcm9tICcuLi9jb25zdGFudHMvYmVhdCc7XG5pbXBvcnQgdXRpbHMgZnJvbSAnLi4vdXRpbHMnO1xuXG5sZXQgc2tpcERlYnVnID0gQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignc2tpcCcpIHx8IDA7XG5za2lwRGVidWcgPSBwYXJzZUludChza2lwRGVidWcsIDEwKTtcblxuLyoqXG4gKiBMb2FkIGJlYXQgZGF0YSAoYWxsIHRoZSBiZWF0cyBhbmQgc3VjaCkuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmVhdC1sb2FkZXInLCB7XG4gIGRlcGVuZGVuY2llczogWydzdGFnZS1jb2xvcnMnXSxcblxuICBzY2hlbWE6IHtcbiAgICBiZWF0QW50aWNpcGF0aW9uVGltZToge2RlZmF1bHQ6IDEuMX0sXG4gICAgYmVhdFNwZWVkOiB7ZGVmYXVsdDogOC4wfSxcbiAgICBiZWF0V2FybXVwVGltZToge2RlZmF1bHQ6IEJFQVRfV0FSTVVQX1RJTUUgLyAxMDAwfSxcbiAgICBiZWF0V2FybXVwU3BlZWQ6IHtkZWZhdWx0OiBCRUFUX1dBUk1VUF9TUEVFRH0sXG4gICAgY2hhbGxlbmdlSWQ6IHt0eXBlOiAnc3RyaW5nJ30sICAvLyBJZiBjbGlja2VkIHBsYXkuXG4gICAgZGlmZmljdWx0eToge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBpc1BsYXlpbmc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgbWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQ6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICBvcmllbnRhdGlvbnNIdW1hbml6ZWQ6IFtcbiAgICAndXAnLFxuICAgICdkb3duJyxcbiAgICAnbGVmdCcsXG4gICAgJ3JpZ2h0JyxcbiAgICAndXBsZWZ0JyxcbiAgICAndXByaWdodCcsXG4gICAgJ2Rvd25sZWZ0JyxcbiAgICAnZG93bnJpZ2h0J1xuICBdLFxuXG4gIGhvcml6b250YWxQb3NpdGlvbnM6IFstMC43NSwgLTAuMjUsIDAuMjUsIDAuNzVdLFxuXG4gIGhvcml6b250YWxQb3NpdGlvbnNIdW1hbml6ZWQ6IHtcbiAgICAwOiAnbGVmdCcsXG4gICAgMTogJ21pZGRsZWxlZnQnLFxuICAgIDI6ICdtaWRkbGVyaWdodCcsXG4gICAgMzogJ3JpZ2h0J1xuICB9LFxuXG4gIHBvc2l0aW9uSHVtYW5pemVkOiB7XG4gICAgdG9wTGVmdDoge2xheWVyOiAyLCBpbmRleDogMH0sXG4gICAgdG9wQ2VudGVyTGVmdDoge2xheWVyOiAyLCBpbmRleDogMX0sXG4gICAgdG9wQ2VudGVyUmlnaHQ6IHtsYXllcjogMiwgaW5kZXg6IDJ9LFxuICAgIHRvcFJpZ2h0OiB7bGF5ZXI6IDIsIGluZGV4OiAzfSxcblxuICAgIG1pZGRsZUxlZnQ6IHtsYXllcjogMSwgaW5kZXg6IDB9LFxuICAgIG1pZGRsZUNlbnRlckxlZnQ6IHtsYXllcjogMSwgaW5kZXg6IDF9LFxuICAgIG1pZGRsZUNlbnRlclJpZ2h0OiB7bGF5ZXI6IDEsIGluZGV4OiAyfSxcbiAgICBtaWRkbGVSaWdodDoge2xheWVyOiAxLCBpbmRleDogM30sXG5cbiAgICBib3R0b21MZWZ0OiB7bGF5ZXI6IDAsIGluZGV4OiAwfSxcbiAgICBib3R0b21DZW50ZXJMZWZ0OiB7bGF5ZXI6IDAsIGluZGV4OiAxfSxcbiAgICBib3R0b21DZW50ZXJSaWdodDoge2xheWVyOiAwLCBpbmRleDogMn0sXG4gICAgYm90dG9tUmlnaHQ6IHtsYXllcjogMCwgaW5kZXg6IDN9LFxuICB9LFxuXG4gIHZlcnRpY2FsUG9zaXRpb25zSHVtYW5pemVkOiB7XG4gICAgMDogJ2JvdHRvbScsXG4gICAgMTogJ21pZGRsZScsXG4gICAgMjogJ3RvcCdcbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5hdWRpb0FuYWx5c2VyRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXVkaW9hbmFseXNlcicpO1xuICAgIHRoaXMuYmVhdERhdGEgPSBudWxsO1xuICAgIHRoaXMuYmVhdERhdGFQcm9jZXNzZWQgPSBmYWxzZTtcbiAgICB0aGlzLmJlYXRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmVhdENvbnRhaW5lcicpO1xuICAgIHRoaXMuYmVhdHNUaW1lID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuYmVhdHNQcmVsb2FkVGltZSA9IDA7XG4gICAgdGhpcy5iZWF0c1ByZWxvYWRUaW1lVG90YWwgPVxuICAgICAgKHRoaXMuZGF0YS5iZWF0QW50aWNpcGF0aW9uVGltZSArIHRoaXMuZGF0YS5iZWF0V2FybXVwVGltZSkgKiAxMDAwO1xuICAgIHRoaXMuYnBtID0gdW5kZWZpbmVkO1xuICAgIHRoaXMueGhyID0gbnVsbDtcbiAgICB0aGlzLnN0YWdlQ29sb3JzID0gdGhpcy5lbC5jb21wb25lbnRzWydzdGFnZS1jb2xvcnMnXTtcbiAgICAvLyBCZWF0cyBhcnJpdmUgYXQgc3dvcmQgc3Ryb2tlIGRpc3RhbmNlIHN5bmNlZCB3aXRoIHRoZSBtdXNpYy5cbiAgICB0aGlzLnN3b3JkT2Zmc2V0ID0gMS41O1xuICAgIHRoaXMudHdpc3RlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0d2lzdGVyJyk7XG4gICAgdGhpcy5sZWZ0U3RhZ2VMYXNlcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVmdFN0YWdlTGFzZXJzJyk7XG4gICAgdGhpcy5yaWdodFN0YWdlTGFzZXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JpZ2h0U3RhZ2VMYXNlcnMnKTtcblxuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xlYXJnYW1lJywgdGhpcy5jbGVhckJlYXRzLmJpbmQodGhpcykpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgLy8gU3RhcnQgcGxheWluZy5cbiAgICBpZiAoIW9sZERhdGEuY2hhbGxlbmdlSWQgJiYgZGF0YS5jaGFsbGVuZ2VJZCAmJiB0aGlzLmJlYXREYXRhKSB7XG4gICAgICB0aGlzLnByb2Nlc3NCZWF0cygpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghZGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCB8fCAhZGF0YS5kaWZmaWN1bHR5KSB7IHJldHVybjsgfVxuXG4gICAgLy8gUHJlZmV0Y2ggYmVhdHMuXG4gICAgaWYgKGRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgIT09IG9sZERhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgfHxcbiAgICAgICAgZGF0YS5kaWZmaWN1bHR5ICE9PSBvbGREYXRhLmRpZmZpY3VsdHkpIHtcbiAgICAgIHRoaXMuZmV0Y2hCZWF0cygpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogWEhSLiBCZWF0IGRhdGEgaXMgcHJlZmV0Y2hlZCB3aGVuIHVzZXIgc2VsZWN0cyBhIG1lbnUgY2hhbGxlbmdlLCBhbmQgc3RvcmVkIGF3YXlcbiAgICogdG8gYmUgcHJvY2Vzc2VkIGxhdGVyLlxuICAgKi9cbiAgZmV0Y2hCZWF0czogZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG5cbiAgICBpZiAodGhpcy54aHIpIHsgdGhpcy54aHIuYWJvcnQoKTsgfVxuXG4gICAgLy8gTG9hZCBiZWF0cy5cbiAgICBsZXQgdXJsID0gdXRpbHMuZ2V0UzNGaWxlVXJsKHRoaXMuZGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAke3RoaXMuZGF0YS5kaWZmaWN1bHR5fS5qc29uYCk7XG4gICAgY29uc3QgeGhyID0gdGhpcy54aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICBlbC5lbWl0KCdiZWF0bG9hZGVyc3RhcnQnKTtcbiAgICBjb25zb2xlLmxvZyhgW2JlYXQtbG9hZGVyXSBGZXRjaGluZyAke3VybH0uLi5gKTtcbiAgICB4aHIub3BlbignR0VUJywgdXJsKTtcbiAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgIHRoaXMuYmVhdERhdGEgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgdGhpcy5iZWF0RGF0YVByb2Nlc3NlZCA9IGZhbHNlO1xuICAgICAgdGhpcy54aHIgPSBudWxsO1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ2JlYXRsb2FkZXJmaW5pc2gnLCBudWxsLCBmYWxzZSk7XG4gICAgfSk7XG4gICAgeGhyLnNlbmQoKTtcbiAgfSxcblxuICAvKipcbiAgICogTG9hZCB0aGUgYmVhdCBkYXRhIGludG8gdGhlIGdhbWUuXG4gICAqL1xuICBwcm9jZXNzQmVhdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBSZXNldCB2YXJpYWJsZXMgdXNlZCBkdXJpbmcgcGxheWJhY2suXG4gICAgLy8gQmVhdHMgc3Bhd24gYWhlYWQgb2YgdGhlIHNvbmcgYW5kIGdldCB0byB0aGUgdXNlciBpbiBzeW5jIHdpdGggdGhlIG11c2ljLlxuICAgIHRoaXMuYmVhdHNUaW1lID0gMDtcbiAgICB0aGlzLmJlYXRzUHJlbG9hZFRpbWUgPSAwO1xuICAgIHRoaXMuYmVhdERhdGEuX2V2ZW50cy5zb3J0KGxlc3NUaGFuKTtcbiAgICB0aGlzLmJlYXREYXRhLl9vYnN0YWNsZXMuc29ydChsZXNzVGhhbik7XG4gICAgdGhpcy5iZWF0RGF0YS5fbm90ZXMuc29ydChsZXNzVGhhbik7XG4gICAgdGhpcy5icG0gPSB0aGlzLmJlYXREYXRhLl9iZWF0c1Blck1pbnV0ZTtcblxuICAgIC8vIFNvbWUgZXZlbnRzIGhhdmUgbmVnYXRpdmUgdGltZSBzdGFtcCB0byBpbml0aWFsaXplIHRoZSBzdGFnZS5cbiAgICBjb25zdCBldmVudHMgPSB0aGlzLmJlYXREYXRhLl9ldmVudHM7XG4gICAgaWYgKGV2ZW50cy5sZW5ndGggJiYgZXZlbnRzWzBdLl90aW1lIDwgMCkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGV2ZW50c1tpXS5fdGltZSA8IDA7IGkrKykge1xuICAgICAgICB0aGlzLmdlbmVyYXRlRXZlbnQoZXZlbnRzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmJlYXREYXRhUHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICBjb25zb2xlLmxvZygnW2JlYXQtbG9hZGVyXSBGaW5pc2hlZCBwcm9jZXNzaW5nIGJlYXQgZGF0YS4nKTtcbiAgfSxcblxuICAvKipcbiAgICogR2VuZXJhdGUgYmVhdHMgYW5kIHN0dWZmIGFjY29yZGluZyB0byB0aW1lc3RhbXAuXG4gICAqL1xuICB0aWNrOiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5pc1BsYXlpbmcgfHwgIXRoaXMuZGF0YS5jaGFsbGVuZ2VJZCB8fCAhdGhpcy5iZWF0RGF0YSkgeyByZXR1cm47IH1cblxuICAgIGNvbnN0IHByZXZCZWF0c1RpbWUgPSB0aGlzLmJlYXRzVGltZSArIHNraXBEZWJ1ZztcbiAgICBpZiAodGhpcy5iZWF0c1ByZWxvYWRUaW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIEdldCBjdXJyZW50IHNvbmcgdGltZS5cbiAgICAgIGNvbnN0IHNvbmcgPSB0aGlzLmVsLmNvbXBvbmVudHMuc29uZztcbiAgICAgIGlmICghc29uZy5pc1BsYXlpbmcpIHsgcmV0dXJuOyB9XG4gICAgICB0aGlzLmJlYXRzVGltZSA9IChzb25nLmdldEN1cnJlbnRUaW1lKCkgKyB0aGlzLmRhdGEuYmVhdEFudGljaXBhdGlvblRpbWUgK1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLmJlYXRXYXJtdXBUaW1lKSAqIDEwMDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFNvbmcgaXMgbm90IHBsYXlpbmcgYW5kIGlzIHByZWxvYWRpbmcgYmVhdHMsIHVzZSBtYWludGFpbmVkIGJlYXQgdGltZS5cbiAgICAgIHRoaXMuYmVhdHNUaW1lID0gdGhpcy5iZWF0c1ByZWxvYWRUaW1lO1xuICAgIH1cblxuICAgIC8vIExvYWQgaW4gc3R1ZmYgc2NoZWR1bGVkIGJldHdlZW4gdGhlIGxhc3QgdGltZXN0YW1wIGFuZCBjdXJyZW50IHRpbWVzdGFtcC5cbiAgICAvLyBCZWF0cy5cbiAgICBjb25zdCBiZWF0c1RpbWUgPSB0aGlzLmJlYXRzVGltZSArIHNraXBEZWJ1ZztcbiAgICBjb25zdCBicG0gPSB0aGlzLmJlYXREYXRhLl9iZWF0c1Blck1pbnV0ZTtcbiAgICBjb25zdCBtc1BlckJlYXQgPSAxMDAwICogNjAgLyB0aGlzLmJlYXREYXRhLl9iZWF0c1Blck1pbnV0ZTtcbiAgICBjb25zdCBub3RlcyA9IHRoaXMuYmVhdERhdGEuX25vdGVzO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm90ZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGxldCBub3RlVGltZSA9IG5vdGVzW2ldLl90aW1lICogbXNQZXJCZWF0O1xuICAgICAgaWYgKG5vdGVUaW1lID4gcHJldkJlYXRzVGltZSAmJiBub3RlVGltZSA8PSBiZWF0c1RpbWUpIHtcbiAgICAgICAgbm90ZXNbaV0udGltZSA9IG5vdGVUaW1lO1xuICAgICAgICB0aGlzLmdlbmVyYXRlQmVhdChub3Rlc1tpXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gV2FsbHMuXG4gICAgY29uc3Qgb2JzdGFjbGVzID0gdGhpcy5iZWF0RGF0YS5fb2JzdGFjbGVzO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb2JzdGFjbGVzLmxlbmd0aDsgKytpKSB7XG4gICAgICBsZXQgbm90ZVRpbWUgPSBvYnN0YWNsZXNbaV0uX3RpbWUgKiBtc1BlckJlYXQ7XG4gICAgICBpZiAobm90ZVRpbWUgPiBwcmV2QmVhdHNUaW1lICYmIG5vdGVUaW1lIDw9IGJlYXRzVGltZSkge1xuICAgICAgICB0aGlzLmdlbmVyYXRlV2FsbChvYnN0YWNsZXNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFN0YWdlIGV2ZW50cy5cbiAgICBjb25zdCBldmVudHMgPSB0aGlzLmJlYXREYXRhLl9ldmVudHM7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGxldCBub3RlVGltZSA9IGV2ZW50c1tpXS5fdGltZSAqIG1zUGVyQmVhdDtcbiAgICAgIGlmIChub3RlVGltZSA+IHByZXZCZWF0c1RpbWUgJiYgbm90ZVRpbWUgPD0gYmVhdHNUaW1lKSB7XG4gICAgICAgIHRoaXMuZ2VuZXJhdGVFdmVudChldmVudHNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmJlYXRzUHJlbG9hZFRpbWUgPT09IHVuZGVmaW5lZCkgeyByZXR1cm47IH1cblxuICAgIGlmICh0aGlzLmJlYXRzUHJlbG9hZFRpbWUgPj0gdGhpcy5iZWF0c1ByZWxvYWRUaW1lVG90YWwpIHtcbiAgICAgIC8vIEZpbmlzaGVkIHByZWxvYWQuXG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnYmVhdGxvYWRlcnByZWxvYWRmaW5pc2gnLCBudWxsLCBmYWxzZSk7XG4gICAgICB0aGlzLmJlYXRzUHJlbG9hZFRpbWUgPSB1bmRlZmluZWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENvbnRpbnVlIHByZWxvYWQuXG4gICAgICB0aGlzLmJlYXRzUHJlbG9hZFRpbWUgKz0gZGVsdGE7XG4gICAgfVxuICB9LFxuXG4gIGdlbmVyYXRlQmVhdDogKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBiZWF0T2JqID0ge307XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKG5vdGVJbmZvKSB7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgICAvLyBpZiAoTWF0aC5yYW5kb20oKSA8IDAuOCkgeyBub3RlSW5mby5fdHlwZSA9IDM7IH0gLy8gVG8gZGVidWcgbWluZXMuXG4gICAgICBsZXQgY29sb3I7XG4gICAgICBsZXQgdHlwZSA9IG5vdGVJbmZvLl9jdXREaXJlY3Rpb24gPT09IDggPyAnZG90JyA6ICdhcnJvdyc7XG4gICAgICBpZiAobm90ZUluZm8uX3R5cGUgPT09IDApIHtcbiAgICAgICAgY29sb3IgPSAncmVkJztcbiAgICAgIH0gZWxzZSBpZiAobm90ZUluZm8uX3R5cGUgPT09IDEpIHtcbiAgICAgICAgY29sb3IgPSAnYmx1ZSc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0eXBlID0gJ21pbmUnO1xuICAgICAgICBjb2xvciA9IHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYmVhdEVsID0gdGhpcy5yZXF1ZXN0QmVhdCh0eXBlLCBjb2xvcik7XG4gICAgICBpZiAoIWJlYXRFbCkgeyByZXR1cm47IH1cblxuICAgICAgLy8gQXBwbHkgc3dvcmQgb2Zmc2V0LiBCbG9ja3MgYXJyaXZlIG9uIGJlYXQgaW4gZnJvbnQgb2YgdGhlIHVzZXIuXG4gICAgICBiZWF0T2JqLmFudGljaXBhdGlvblBvc2l0aW9uID0gLWRhdGEuYmVhdEFudGljaXBhdGlvblRpbWUgKiBkYXRhLmJlYXRTcGVlZCAtIHRoaXMuc3dvcmRPZmZzZXQ7XG4gICAgICBiZWF0T2JqLmNvbG9yID0gY29sb3I7XG4gICAgICBiZWF0T2JqLmN1dERpcmVjdGlvbiA9IHRoaXMub3JpZW50YXRpb25zSHVtYW5pemVkW25vdGVJbmZvLl9jdXREaXJlY3Rpb25dO1xuICAgICAgYmVhdE9iai5ob3Jpem9udGFsUG9zaXRpb24gPSB0aGlzLmhvcml6b250YWxQb3NpdGlvbnNIdW1hbml6ZWRbbm90ZUluZm8uX2xpbmVJbmRleF07XG4gICAgICBiZWF0T2JqLnNwZWVkID0gdGhpcy5kYXRhLmJlYXRTcGVlZDtcbiAgICAgIGJlYXRPYmoudHlwZSA9IHR5cGU7XG4gICAgICBiZWF0T2JqLnZlcnRpY2FsUG9zaXRpb24gPSB0aGlzLnZlcnRpY2FsUG9zaXRpb25zSHVtYW5pemVkW25vdGVJbmZvLl9saW5lTGF5ZXJdLFxuICAgICAgYmVhdE9iai53YXJtdXBQb3NpdGlvbiA9IC1kYXRhLmJlYXRXYXJtdXBUaW1lICogZGF0YS5iZWF0V2FybXVwU3BlZWQ7XG4gICAgICBiZWF0RWwuc2V0QXR0cmlidXRlKCdiZWF0JywgYmVhdE9iaik7XG4gICAgICBiZWF0RWwuY29tcG9uZW50cy5iZWF0LnVwZGF0ZVBvc2l0aW9uKCk7XG5cbiAgICAgIGJlYXRFbC5wbGF5KCk7XG4gICAgICBiZWF0RWwuY29tcG9uZW50cy5iZWF0Lm9uR2VuZXJhdGUoKTtcbiAgICB9O1xuICB9KSgpLFxuXG4gIGdlbmVyYXRlV2FsbDogKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB3YWxsT2JqID0ge307XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHdhbGxJbmZvKSB7XG4gICAgICBjb25zdCBlbCA9IHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzLnBvb2xfX3dhbGwucmVxdWVzdEVudGl0eSgpO1xuXG4gICAgICBpZiAoIWVsKSB7IHJldHVybjsgfVxuXG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgY29uc3Qgc3BlZWQgPSB0aGlzLmRhdGEuYmVhdFNwZWVkO1xuXG4gICAgICBjb25zdCBkdXJhdGlvblNlY29uZHMgPSA2MCAqICh3YWxsSW5mby5fZHVyYXRpb24gLyB0aGlzLmJwbSk7XG4gICAgICB3YWxsT2JqLmFudGljaXBhdGlvblBvc2l0aW9uID1cbiAgICAgICAgLWRhdGEuYmVhdEFudGljaXBhdGlvblRpbWUgKiBkYXRhLmJlYXRTcGVlZCAtIHRoaXMuc3dvcmRPZmZzZXQ7XG4gICAgICB3YWxsT2JqLmR1cmF0aW9uU2Vjb25kcyA9IGR1cmF0aW9uU2Vjb25kcztcbiAgICAgIHdhbGxPYmouaG9yaXpvbnRhbFBvc2l0aW9uID0gdGhpcy5ob3Jpem9udGFsUG9zaXRpb25zSHVtYW5pemVkW3dhbGxJbmZvLl9saW5lSW5kZXhdO1xuICAgICAgd2FsbE9iai5pc0NlaWxpbmcgPSB3YWxsSW5mby5fdHlwZSA9PT0gMTtcbiAgICAgIHdhbGxPYmouc3BlZWQgPSBzcGVlZDtcbiAgICAgIHdhbGxPYmoud2FybXVwUG9zaXRpb24gPSAtZGF0YS5iZWF0V2FybXVwVGltZSAqIGRhdGEuYmVhdFdhcm11cFNwZWVkO1xuICAgICAgd2FsbE9iai53aWR0aCA9IHdhbGxJbmZvLl93aWR0aDtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnd2FsbCcsIHdhbGxPYmopO1xuICAgICAgZWwucGxheSgpO1xuICAgIH07XG4gIH0pKCksXG5cbiAgZ2VuZXJhdGVFdmVudDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgc3dpdGNoKGV2ZW50Ll90eXBlKSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgIHRoaXMuc3RhZ2VDb2xvcnMuc2V0Q29sb3IoJ2JnJywgZXZlbnQuX3ZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIHRoaXMuc3RhZ2VDb2xvcnMuc2V0Q29sb3IoJ3R1bm5lbCcsIGV2ZW50Ll92YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICB0aGlzLnN0YWdlQ29sb3JzLnNldENvbG9yKCdsZWZ0bGFzZXInLCBldmVudC5fdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgdGhpcy5zdGFnZUNvbG9ycy5zZXRDb2xvcigncmlnaHRsYXNlcicsIGV2ZW50Ll92YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSA0OlxuICAgICAgICB0aGlzLnN0YWdlQ29sb3JzLnNldENvbG9yKCdmbG9vcicsIGV2ZW50Ll92YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSA4OlxuICAgICAgICB0aGlzLnR3aXN0ZXIuY29tcG9uZW50cy50d2lzdGVyLnB1bHNlKGV2ZW50Ll92YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSA5OlxuICAgICAgICAvLyB6b29tIHdhcyBhIGJpdCBkaXN0dXJiaW5nXG4gICAgICAgIHRoaXMudHdpc3Rlci5jb21wb25lbnRzLnR3aXN0ZXIucHVsc2UoZXZlbnQuX3ZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDEyOlxuICAgICAgICB0aGlzLmxlZnRTdGFnZUxhc2Vycy5jb21wb25lbnRzWydzdGFnZS1sYXNlcnMnXS5wdWxzZShldmVudC5fdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMTM6XG4gICAgICAgIHRoaXMucmlnaHRTdGFnZUxhc2Vycy5jb21wb25lbnRzWydzdGFnZS1sYXNlcnMnXS5wdWxzZShldmVudC5fdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH0sXG5cbiAgcmVxdWVzdEJlYXQ6IGZ1bmN0aW9uICh0eXBlLCBjb2xvcikge1xuICAgIHZhciBiZWF0UG9vbE5hbWUgPSAncG9vbF9fYmVhdC0nICsgdHlwZTtcbiAgICB2YXIgcG9vbDtcbiAgICBpZiAoY29sb3IpIHsgYmVhdFBvb2xOYW1lICs9ICctJyArIGNvbG9yOyB9XG4gICAgcG9vbCA9IHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzW2JlYXRQb29sTmFtZV07XG4gICAgaWYgKCFwb29sKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1Bvb2wgJyArIGJlYXRQb29sTmFtZSArICcgdW5hdmFpbGFibGUnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIHBvb2wucmVxdWVzdEVudGl0eSgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZXN0YXJ0IGJ5IHJldHVybmluZyBhbGwgYmVhdHMgdG8gcG9vbC5cbiAgICovXG4gIGNsZWFyQmVhdHM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJlYXRzUHJlbG9hZFRpbWUgPSAwO1xuICAgIHRoaXMuYmVhdHNUaW1lID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmVhdENvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGNoaWxkID0gdGhpcy5iZWF0Q29udGFpbmVyLmNoaWxkcmVuW2ldO1xuICAgICAgaWYgKGNoaWxkLmNvbXBvbmVudHMuYmVhdCkge1xuICAgICAgICBjaGlsZC5jb21wb25lbnRzLmJlYXQucmV0dXJuVG9Qb29sKHRydWUpO1xuICAgICAgfVxuICAgICAgaWYgKGNoaWxkLmNvbXBvbmVudHMud2FsbCkge1xuICAgICAgICBjaGlsZC5jb21wb25lbnRzLndhbGwucmV0dXJuVG9Qb29sKHRydWUpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbn0pO1xuXG5mdW5jdGlvbiBsZXNzVGhhbiAoYSwgYikgeyByZXR1cm4gYS5fdGltZSAtIGIuX3RpbWU7IH1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2JlYXQtbG9hZGVyLmpzIiwiaW1wb3J0IHtCRUFUX1dBUk1VUF9PRkZTRVQsIEJFQVRfV0FSTVVQX1NQRUVELCBCRUFUX1dBUk1VUF9USU1FfSBmcm9tICcuLi9jb25zdGFudHMvYmVhdCc7XG5jb25zdCBDT0xPUlMgPSByZXF1aXJlKCcuLi9jb25zdGFudHMvY29sb3JzLmpzJyk7XG5cbmNvbnN0IGF1eE9iajNEID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XG5jb25zdCBjb2xsaXNpb25aVGhyZXNob2xkID0gLTEuNjU7XG5jb25zdCBCRUFUX1dBUk1VUF9ST1RBVElPTl9DSEFOR0UgPSBNYXRoLlBJIC8gNTtcbmNvbnN0IEJFQVRfV0FSTVVQX1JPVEFUSU9OX09GRlNFVCA9IDAuNDtcbmNvbnN0IEJFQVRfV0FSTVVQX1JPVEFUSU9OX1RJTUUgPSA3NTA7XG5jb25zdCBERVNUUk9ZRURfU1BFRUQgPSAxLjA7XG5jb25zdCBPTkNFID0ge29uY2U6IHRydWV9O1xuXG5jb25zdCBTQ09SRV9QT09MID0ge1xuICBPSyA6ICdwb29sX19iZWF0c2NvcmVvaycsXG4gIEdPT0QgOiAncG9vbF9fYmVhdHNjb3JlZ29vZCcsXG4gIEdSRUFUIDogJ3Bvb2xfX2JlYXRzY29yZWdyZWF0JyxcbiAgU1VQRVIgOiAncG9vbF9fYmVhdHNjb3Jlc3VwZXInXG59O1xuXG4vKipcbiAqIEJlYXJzLCBiZWF0cywgQmF0dGxlc3RhciBHYWxhY3RpY2EuXG4gKiBDcmVhdGUgYmVhdCBmcm9tIHBvb2wsIGNvbGxpc2lvbiBkZXRlY3Rpb24sIGNsaXBwaW5nIHBsYW5lcywgbW92ZW1lbnQsIHNjb3JpbmcuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmVhdCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgYW50aWNpcGF0aW9uUG9zaXRpb246IHtkZWZhdWx0OiAwfSxcbiAgICBjb2xvcjoge2RlZmF1bHQ6ICdyZWQnLCBvbmVPZjogWydyZWQnLCAnYmx1ZSddfSxcbiAgICBjdXREaXJlY3Rpb246IHtkZWZhdWx0OiAnZG93bid9LFxuICAgIGRlYnVnOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGhvcml6b250YWxQb3NpdGlvbjoge2RlZmF1bHQ6ICdtaWRkbGVsZWZ0Jywgb25lT2Y6IFsnbGVmdCcsICdtaWRkbGVsZWZ0JywgJ21pZGRsZXJpZ2h0JywgJ3JpZ2h0J119LFxuICAgIHNpemU6IHtkZWZhdWx0OiAwLjQwfSxcbiAgICBzcGVlZDoge2RlZmF1bHQ6IDguMH0sXG4gICAgdHlwZToge2RlZmF1bHQ6ICdhcnJvdycsIG9uZU9mOiBbJ2Fycm93JywgJ2RvdCcsICdtaW5lJ119LFxuICAgIHZlcnRpY2FsUG9zaXRpb246IHtkZWZhdWx0OiAnbWlkZGxlJywgb25lT2Y6IFsnYm90dG9tJywgJ21pZGRsZScsICd0b3AnXX0sXG4gICAgd2FybXVwUG9zaXRpb246IHtkZWZhdWx0OiAwfSxcbiAgfSxcblxuICBtYXRlcmlhbENvbG9yOiB7XG4gICAgYmx1ZTogQ09MT1JTLkJFQVRfQkxVRSxcbiAgICByZWQ6IENPTE9SUy5CRUFUX1JFRFxuICB9LFxuXG4gIGN1dENvbG9yOiB7XG4gICAgYmx1ZTogJyNmZmYnLFxuICAgIHJlZDogJyNmZmYnXG4gIH0sXG5cbiAgbW9kZWxzOiB7XG4gICAgYXJyb3c6ICdiZWF0T2JqVGVtcGxhdGUnLFxuICAgIGRvdDogJ2JlYXRPYmpUZW1wbGF0ZScsXG4gICAgbWluZTogJ21pbmVPYmpUZW1wbGF0ZSdcbiAgfSxcblxuICBzaWduTW9kZWxzOiB7XG4gICAgYXJyb3dyZWQ6ICdhcnJvd1JlZE9ialRlbXBsYXRlJyxcbiAgICBhcnJvd2JsdWU6ICdhcnJvd0JsdWVPYmpUZW1wbGF0ZScsXG4gICAgZG90cmVkOiAnZG90UmVkT2JqVGVtcGxhdGUnLFxuICAgIGRvdGJsdWU6ICdkb3RCbHVlT2JqVGVtcGxhdGUnXG4gIH0sXG5cbiAgb3JpZW50YXRpb25zOiBbMTgwLCAwLCAyNzAsIDkwLCAyMjUsIDEzNSwgMzE1LCA0NSwgMF0sXG5cbiAgcm90YXRpb25zOiB7XG4gICAgdXA6IDE4MCxcbiAgICBkb3duOiAwLFxuICAgIGxlZnQ6IDI3MCxcbiAgICByaWdodDogOTAsXG4gICAgdXBsZWZ0OiAyMjUsXG4gICAgdXByaWdodDogMTM1LFxuICAgIGRvd25sZWZ0OiAzMTUsXG4gICAgZG93bnJpZ2h0OiA0NVxuICB9LFxuXG4gIGhvcml6b250YWxQb3NpdGlvbnM6IHtcbiAgICBsZWZ0OiAtMC43NSxcbiAgICBtaWRkbGVsZWZ0OiAtMC4yNSxcbiAgICBtaWRkbGVyaWdodDogMC4yNSxcbiAgICByaWdodDogMC43NVxuICB9LFxuXG4gIHZlcnRpY2FsUG9zaXRpb25zOiB7XG4gICAgYm90dG9tOiAwLjcwLFxuICAgIG1pZGRsZTogMS4yMCxcbiAgICB0b3A6IDEuNzBcbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5iYWNrVG9Qb29sID0gZmFsc2U7XG4gICAgdGhpcy5iZWFtcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZWFtcycpLmNvbXBvbmVudHMuYmVhbXM7XG4gICAgdGhpcy5iZWF0Qm91bmRpbmdCb3ggPSBuZXcgVEhSRUUuQm94MygpO1xuICAgIHRoaXMuY3VycmVudFJvdGF0aW9uV2FybXVwVGltZSA9IDA7XG4gICAgdGhpcy5jdXREaXJlY3Rpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7XG4gICAgdGhpcy5ncmF2aXR5VmVsb2NpdHkgPSAwO1xuICAgIHRoaXMuaGl0RXZlbnREZXRhaWwgPSB7fTtcbiAgICB0aGlzLmhpdEJvdW5kaW5nQm94ID0gbmV3IFRIUkVFLkJveDMoKTtcbiAgICB0aGlzLnBvb2xOYW1lID0gdW5kZWZpbmVkO1xuICAgIHRoaXMucmV0dXJuVG9Qb29sVGltZXIgPSA4MDA7XG4gICAgdGhpcy5yb3RhdGlvbkF4aXMgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuc2FiZXJFbHMgPSB0aGlzLmVsLnNjZW5lRWwucXVlcnlTZWxlY3RvckFsbCgnW3NhYmVyLWNvbnRyb2xzXScpO1xuICAgIHRoaXMuc2NvcmVFbCA9IG51bGw7XG4gICAgdGhpcy5zY29yZUVsVGltZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnN0YXJ0UG9zaXRpb25aID0gdW5kZWZpbmVkO1xuICAgIHRoaXMucmlnaHRDdXRQbGFuZVBvaW50cyA9IFtcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKCksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKVxuICAgIF07XG4gICAgdGhpcy5sZWZ0Q3V0UGxhbmVQb2ludHMgPSBbXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKClcbiAgICBdO1xuXG4gICAgdGhpcy5taW5lUGFydGljbGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pbmVQYXJ0aWNsZXMnKTtcbiAgICB0aGlzLndyb25nRWxMZWZ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dyb25nTGVmdCcpO1xuICAgIHRoaXMud3JvbmdFbFJpZ2h0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dyb25nUmlnaHQnKTtcbiAgICB0aGlzLm1pc3NFbExlZnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc0xlZnQnKTtcbiAgICB0aGlzLm1pc3NFbFJpZ2h0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pc3NSaWdodCcpO1xuICAgIHRoaXMucGFydGljbGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhYmVyUGFydGljbGVzJyk7XG4gICAgdGhpcy5taW5lUGFydGljbGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pbmVQYXJ0aWNsZXMnKTtcblxuICAgIHRoaXMuc3VwZXJDdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN1cGVyQ3V0RngnKTtcbiAgICB0aGlzLnN1cGVyQ3V0SWR4ID0gMDtcblxuICAgIHRoaXMuZXhwbG9kZUV2ZW50RGV0YWlsID0ge3Bvc2l0aW9uOiBudWxsLCByb3RhdGlvbjogbnVsbH07XG4gICAgdGhpcy5zYWJlckNvbG9ycyA9IHtyaWdodDogJ2JsdWUnLCBsZWZ0OiAncmVkJ307XG5cbiAgICB0aGlzLm9uRW5kU3Ryb2tlID0gdGhpcy5vbkVuZFN0cm9rZS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5pbml0QmxvY2soKTtcbiAgICBpZiAodGhpcy5kYXRhLnR5cGUgPT09ICdtaW5lJykge1xuICAgICAgdGhpcy5pbml0TWluZUZyYWdtZW50cygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmluaXRGcmFnbWVudHMoKTtcbiAgICB9O1xuICB9LFxuXG4gIHVwZGF0ZVBvc2l0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICBlbC5vYmplY3QzRC5wb3NpdGlvbi5zZXQoXG4gICAgICB0aGlzLmhvcml6b250YWxQb3NpdGlvbnNbZGF0YS5ob3Jpem9udGFsUG9zaXRpb25dLFxuICAgICAgdGhpcy52ZXJ0aWNhbFBvc2l0aW9uc1tkYXRhLnZlcnRpY2FsUG9zaXRpb25dLFxuICAgICAgZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbiArIGRhdGEud2FybXVwUG9zaXRpb25cbiAgICApO1xuXG4gICAgZWwub2JqZWN0M0Qucm90YXRpb24ueiA9IFRIUkVFLk1hdGguZGVnVG9SYWQodGhpcy5yb3RhdGlvbnNbZGF0YS5jdXREaXJlY3Rpb25dKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnVwZGF0ZVBvc2l0aW9uKCk7XG4gICAgdGhpcy51cGRhdGVCbG9jaygpO1xuICAgIHRoaXMudXBkYXRlRnJhZ21lbnRzKCk7XG5cbiAgICBpZiAodGhpcy5kYXRhLnR5cGUgPT09ICdtaW5lJykge1xuICAgICAgdGhpcy5wb29sTmFtZSA9IGBwb29sX19iZWF0LW1pbmVgO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnBvb2xOYW1lID0gYHBvb2xfX2JlYXQtJHt0aGlzLmRhdGEudHlwZX0tJHt0aGlzLmRhdGEuY29sb3J9YDtcbiAgICB9XG4gIH0sXG5cbiAgcGF1c2U6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5kYXRhLnR5cGUgIT09ICdtaW5lJykge1xuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5ibG9ja0VsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgfSxcblxuICB0b2NrOiBmdW5jdGlvbiAodGltZSwgdGltZURlbHRhKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgY29uc3QgcG9zaXRpb24gPSBlbC5vYmplY3QzRC5wb3NpdGlvbjtcbiAgICBjb25zdCByb3RhdGlvbiA9IGVsLm9iamVjdDNELnJvdGF0aW9uO1xuXG4gICAgaWYgKHRoaXMuZGVzdHJveWVkKSB7XG4gICAgICB0aGlzLnRvY2tEZXN0cm95ZWQodGltZURlbHRhKTtcbiAgICAgIC8vIENoZWNrIHRvIHJlbW92ZSBzY29yZSBlbnRpdHkgZnJvbSBwb29sLlxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBPbmx5IGNoZWNrIGNvbGxpc2lvbnMgd2hlbiBjbG9zZS5cbiAgICAgIGlmIChwb3NpdGlvbi56ID4gY29sbGlzaW9uWlRocmVzaG9sZCkgeyB0aGlzLmNoZWNrQ29sbGlzaW9ucygpOyB9XG5cbiAgICAgIC8vIE1vdmUuXG4gICAgICBpZiAocG9zaXRpb24ueiA8IGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb24pIHtcbiAgICAgICAgbGV0IG5ld1Bvc2l0aW9uWiA9IHBvc2l0aW9uLnogKyBCRUFUX1dBUk1VUF9TUEVFRCAqICh0aW1lRGVsdGEgLyAxMDAwKTtcbiAgICAgICAgLy8gV2FybSB1cCAvIHdhcnAgaW4uXG4gICAgICAgIGlmIChuZXdQb3NpdGlvblogPCBkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uKSB7XG4gICAgICAgICAgcG9zaXRpb24ueiA9IG5ld1Bvc2l0aW9uWjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwb3NpdGlvbi56ID0gZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbjtcbiAgICAgICAgICB0aGlzLmJlYW1zLm5ld0JlYW0odGhpcy5kYXRhLmNvbG9yLCBwb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFN0YW5kYXJkIG1vdmluZy5cbiAgICAgICAgcG9zaXRpb24ueiArPSB0aGlzLmRhdGEuc3BlZWQgKiAodGltZURlbHRhIC8gMTAwMCk7XG4gICAgICAgIHJvdGF0aW9uLnogPSB0aGlzLnN0YXJ0Um90YXRpb25aO1xuICAgICAgfVxuXG4gICAgICBpZiAocG9zaXRpb24ueiA+IChkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uIC0gQkVBVF9XQVJNVVBfUk9UQVRJT05fT0ZGU0VUKSAmJlxuICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uV2FybXVwVGltZSA8IEJFQVRfV0FSTVVQX1JPVEFUSU9OX1RJTUUpIHtcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3MgPSBBRlJBTUUuQU5JTUUuZWFzaW5ncy5lYXNlT3V0QmFjayhcbiAgICAgICAgICB0aGlzLmN1cnJlbnRSb3RhdGlvbldhcm11cFRpbWUgLyBCRUFUX1dBUk1VUF9ST1RBVElPTl9USU1FKTtcbiAgICAgICAgZWwub2JqZWN0M0Qucm90YXRpb24ueiA9IHRoaXMucm90YXRpb25aU3RhcnQgKyAocHJvZ3Jlc3MgKiB0aGlzLnJvdGF0aW9uWkNoYW5nZSk7XG4gICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uV2FybXVwVGltZSArPSB0aW1lRGVsdGE7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrLlxuICAgICAgdGhpcy5iYWNrVG9Qb29sID0gcG9zaXRpb24ueiA+PSAyO1xuICAgICAgaWYgKHRoaXMuYmFja1RvUG9vbCkgeyB0aGlzLm1pc3NIaXQoKTsgfVxuICAgIH1cbiAgICB0aGlzLnJldHVyblRvUG9vbCgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBzdW1tb25lZCBieSBiZWF0LWxvYWRlci5cbiAgICovXG4gIG9uR2VuZXJhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnN0YXJ0Um90YXRpb25aID0gdGhpcy5lbC5vYmplY3QzRC5yb3RhdGlvbi56O1xuXG4gICAgLy8gU2V0IHVwIHJvdGF0aW9uIHdhcm11cC5cbiAgICB0aGlzLmN1cnJlbnRSb3RhdGlvbldhcm11cFRpbWUgPSAwO1xuICAgIHRoaXMucm90YXRpb25aQ2hhbmdlID0gQkVBVF9XQVJNVVBfUk9UQVRJT05fQ0hBTkdFO1xuICAgIGlmIChNYXRoLnJhbmRvbSA+IDAuNSkgeyB0aGlzLnJvdGF0aW9uWkNoYW5nZSAqPSAtMTsgfVxuICAgIHRoaXMuZWwub2JqZWN0M0Qucm90YXRpb24ueiAtPSB0aGlzLnJvdGF0aW9uWkNoYW5nZTtcbiAgICB0aGlzLnJvdGF0aW9uWlN0YXJ0ID0gdGhpcy5lbC5vYmplY3QzRC5yb3RhdGlvbi56O1xuICAgIC8vIFJlc2V0IG1pbmUuXG4gICAgaWYgKHRoaXMuZGF0YS50eXBlID09ICdtaW5lJykgeyB0aGlzLnJlc2V0TWluZUZyYWdtZW50cygpOyB9XG4gIH0sXG5cbiAgaW5pdEJsb2NrOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgYmxvY2tFbCA9IHRoaXMuYmxvY2tFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG4gICAgdmFyIHNpZ25FbCA9IHRoaXMuc2lnbkVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcblxuICAgIGJsb2NrRWwuc2V0QXR0cmlidXRlKCdtaXhpbicsICdiZWF0QmxvY2snKTtcbiAgICBibG9ja0VsLnNldEF0dHJpYnV0ZSgnbWl4aW4nLCAnYmVhdFNpZ24nKTtcblxuICAgIC8vIFNtYWxsIG9mZnNldCB0byBwcmV2ZW50IHotZmlnaHRpbmcgd2hlbiB0aGUgYmxvY2tzIGFyZSBmYXIgYXdheVxuICAgIHNpZ25FbC5vYmplY3QzRC5wb3NpdGlvbi56ICs9IDAuMDI7XG4gICAgYmxvY2tFbC5hcHBlbmRDaGlsZChzaWduRWwpO1xuICAgIGVsLmFwcGVuZENoaWxkKGJsb2NrRWwpO1xuICB9LFxuXG4gIHVwZGF0ZUJsb2NrOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgYmxvY2tFbCA9IHRoaXMuYmxvY2tFbDtcbiAgICBjb25zdCBzaWduRWwgPSB0aGlzLnNpZ25FbDtcbiAgICBpZiAoIWJsb2NrRWwpIHsgcmV0dXJuOyB9XG5cbiAgICBibG9ja0VsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB7XG4gICAgICBtZXRhbG5lc3M6IDAuNyxcbiAgICAgIHJvdWdobmVzczogMC4xLFxuICAgICAgc3BoZXJpY2FsRW52TWFwOiAnI2Vudm1hcFRleHR1cmUnLFxuICAgICAgZW1pc3NpdmU6IHRoaXMubWF0ZXJpYWxDb2xvclt0aGlzLmRhdGEuY29sb3JdLFxuICAgICAgZW1pc3NpdmVJbnRlbnNpdHk6IDAuMDUsXG4gICAgICBjb2xvcjogdGhpcy5tYXRlcmlhbENvbG9yW3RoaXMuZGF0YS5jb2xvcl1cbiAgICB9KTtcbiAgICB0aGlzLnNldE9iak1vZGVsRnJvbVRlbXBsYXRlKGJsb2NrRWwsIHRoaXMubW9kZWxzW3RoaXMuZGF0YS50eXBlXSk7XG5cbiAgICAvLyBNb2RlbCBpcyAwLjI5IHNpemUuIFdlIG1ha2UgaXQgMS4wIHNvIHdlIGNhbiBlYXNpbHkgc2NhbGUgYmFzZWQgb24gMW0gc2l6ZS5cbiAgICBibG9ja0VsLm9iamVjdDNELnNjYWxlLnNldCgxLCAxLCAxKTtcbiAgICBibG9ja0VsLm9iamVjdDNELnNjYWxlLm11bHRpcGx5U2NhbGFyKDMuNDUpLm11bHRpcGx5U2NhbGFyKHRoaXMuZGF0YS5zaXplKTtcblxuICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PT0gJ21pbmUnKSB7XG4gICAgICBjb25zdCBtb2RlbCA9IGJsb2NrRWwuZ2V0T2JqZWN0M0QoJ21lc2gnKTtcbiAgICAgIGlmIChtb2RlbCkge1xuICAgICAgICBtb2RlbC5tYXRlcmlhbCA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFsc1snbWluZU1hdGVyaWFsJyArIHRoaXMuZGF0YS5jb2xvcl07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBibG9ja0VsLmFkZEV2ZW50TGlzdGVuZXIoJ21vZGVsLWxvYWRlZCcsICgpID0+IHtcbiAgICAgICAgICBtb2RlbC5tYXRlcmlhbCA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFsc1snbWluZU1hdGVyaWFsJyArIHRoaXMuZGF0YS5jb2xvcl07XG4gICAgICAgIH0sIE9OQ0UpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzaWduRWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbHMnLCB7bmFtZTogJ3N0YWdlQWRkaXRpdmUnfSk7XG4gICAgICB0aGlzLnNldE9iak1vZGVsRnJvbVRlbXBsYXRlKHNpZ25FbCwgdGhpcy5zaWduTW9kZWxzW3RoaXMuZGF0YS50eXBlICsgdGhpcy5kYXRhLmNvbG9yXSk7XG4gICAgfVxuICB9LFxuXG4gIGluaXRGcmFnbWVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY3V0RWw7XG4gICAgdmFyIHBhcnRFbDtcblxuICAgIHBhcnRFbCA9IHRoaXMucGFydExlZnRFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG4gICAgY3V0RWwgPSB0aGlzLmN1dExlZnRFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG5cbiAgICBwYXJ0RWwuYXBwZW5kQ2hpbGQoY3V0RWwpO1xuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQocGFydEVsKTtcblxuICAgIHBhcnRFbCA9IHRoaXMucGFydFJpZ2h0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgIGN1dEVsID0gdGhpcy5jdXRSaWdodEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcblxuICAgIHBhcnRFbC5hcHBlbmRDaGlsZChjdXRFbCk7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZChwYXJ0RWwpO1xuXG4gICAgdGhpcy5pbml0Q3V0dGluZ0NsaXBwaW5nUGxhbmVzKCk7XG4gIH0sXG5cbiAgaW5pdE1pbmVGcmFnbWVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZnJhZ21lbnQ7XG4gICAgdmFyIGZyYWdtZW50cyA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zWydtaW5lLWZyYWdtZW50cy1sb2FkZXInXS5mcmFnbWVudHMuY2hpbGRyZW47XG4gICAgdmFyIG1hdGVyaWFsID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMubWF0ZXJpYWxzWydtaW5lTWF0ZXJpYWwnICsgdGhpcy5kYXRhLmNvbG9yXTtcblxuICAgIHRoaXMucmFuZFZlYyA9IG5ldyBUSFJFRS5WZWN0b3IzKFxuICAgICAgTWF0aC5yYW5kb20oKSAqIE1hdGguUEksXG4gICAgICBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSxcbiAgICAgIE1hdGgucmFuZG9tKCkgKiBNYXRoLlBJKTtcblxuICAgIHRoaXMubWluZUZyYWdtZW50cyA9IFtdO1xuICAgIHRoaXMubWluZUJyb2tlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLm1pbmVCcm9rZW4pO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmcmFnbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZyYWdtZW50ID0gbmV3IFRIUkVFLk1lc2goZnJhZ21lbnRzW2ldLmdlb21ldHJ5LCBtYXRlcmlhbCk7XG4gICAgICBmcmFnbWVudC5zcGVlZCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgICBmcmFnbWVudC5zcGVlZC5zZXQoTWF0aC5yYW5kb20oKSAtIDAuNSwgTWF0aC5yYW5kb20oKSAtIDAuNSwgTWF0aC5yYW5kb20oKSAtIDAuNSk7XG4gICAgICB0aGlzLm1pbmVGcmFnbWVudHMucHVzaChmcmFnbWVudCk7XG4gICAgICB0aGlzLm1pbmVCcm9rZW4ub2JqZWN0M0QuYWRkKGZyYWdtZW50KTtcbiAgICB9XG4gIH0sXG5cbiAgdXBkYXRlRnJhZ21lbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGN1dExlZnRFbCA9IHRoaXMuY3V0TGVmdEVsO1xuICAgIHZhciBjdXRSaWdodEVsID0gdGhpcy5jdXRSaWdodEVsO1xuICAgIHZhciBwYXJ0TGVmdEVsID0gdGhpcy5wYXJ0TGVmdEVsO1xuICAgIHZhciBwYXJ0UmlnaHRFbCA9IHRoaXMucGFydFJpZ2h0RWw7XG4gICAgdmFyIGZyYWdtZW50O1xuICAgIGlmICghcGFydExlZnRFbCkgeyByZXR1cm47IH1cbiAgICBpZiAodGhpcy5kYXRhLnR5cGUgPT09ICdtaW5lJykge1xuICAgICAgdGhpcy5yZXNldE1pbmVGcmFnbWVudHMoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBwYXJ0TGVmdEVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB7XG4gICAgICBtZXRhbG5lc3M6IDAuNyxcbiAgICAgIHJvdWdobmVzczogMC4xLFxuICAgICAgc3BoZXJpY2FsRW52TWFwOiAnI2Vudm1hcFRleHR1cmUnLFxuICAgICAgZW1pc3NpdmU6IHRoaXMubWF0ZXJpYWxDb2xvclt0aGlzLmRhdGEuY29sb3JdLFxuICAgICAgZW1pc3NpdmVJbnRlbnNpdHk6IDAuMDUsXG4gICAgICBjb2xvcjogdGhpcy5tYXRlcmlhbENvbG9yW3RoaXMuZGF0YS5jb2xvcl0sXG4gICAgICBzaWRlOiAnZG91YmxlJ1xuICAgIH0pO1xuICAgIHRoaXMuc2V0T2JqTW9kZWxGcm9tVGVtcGxhdGUocGFydExlZnRFbCwgdGhpcy5tb2RlbHMuZG90KTtcbiAgICBwYXJ0TGVmdEVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcblxuICAgIGN1dExlZnRFbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywge1xuICAgICAgc2hhZGVyOiAnZmxhdCcsXG4gICAgICBjb2xvcjogdGhpcy5kYXRhLmN1dENvbG9yLFxuICAgICAgc2lkZTogJ2RvdWJsZSdcbiAgICB9KTtcbiAgICB0aGlzLnNldE9iak1vZGVsRnJvbVRlbXBsYXRlKGN1dExlZnRFbCwgdGhpcy5tb2RlbHMuZG90KTtcblxuICAgIHBhcnRSaWdodEVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB7XG4gICAgICBtZXRhbG5lc3M6IDAuNyxcbiAgICAgIHJvdWdobmVzczogMC4xLFxuICAgICAgc3BoZXJpY2FsRW52TWFwOiAnI2Vudm1hcFRleHR1cmUnLFxuICAgICAgZW1pc3NpdmU6IHRoaXMubWF0ZXJpYWxDb2xvclt0aGlzLmRhdGEuY29sb3JdLFxuICAgICAgZW1pc3NpdmVJbnRlbnNpdHk6IDAuMDUsXG4gICAgICBjb2xvcjogdGhpcy5tYXRlcmlhbENvbG9yW3RoaXMuZGF0YS5jb2xvcl0sXG4gICAgICBzaWRlOiAnZG91YmxlJ1xuICAgIH0pO1xuICAgIHRoaXMuc2V0T2JqTW9kZWxGcm9tVGVtcGxhdGUocGFydFJpZ2h0RWwsIHRoaXMubW9kZWxzLmRvdCk7XG4gICAgcGFydFJpZ2h0RWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgY3V0UmlnaHRFbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywge1xuICAgICAgc2hhZGVyOiAnZmxhdCcsXG4gICAgICBjb2xvcjogdGhpcy5kYXRhLmN1dENvbG9yLFxuICAgICAgc2lkZTogJ2RvdWJsZSdcbiAgICB9KTtcbiAgICB0aGlzLnNldE9iak1vZGVsRnJvbVRlbXBsYXRlKGN1dFJpZ2h0RWwsIHRoaXMubW9kZWxzLmRvdCk7XG4gIH0sXG5cbiAgcmVzZXRNaW5lRnJhZ21lbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuZGF0YS50eXBlICE9PSAnbWluZScpIHsgcmV0dXJuOyB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1pbmVGcmFnbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBmcmFnbWVudCA9IHRoaXMubWluZUZyYWdtZW50c1tpXTtcbiAgICAgIGZyYWdtZW50LnZpc2libGUgPSBmYWxzZTtcbiAgICAgIGZyYWdtZW50LnBvc2l0aW9uLnNldCgwLCAwLCAwKTtcbiAgICAgIGZyYWdtZW50LnNjYWxlLnNldCgxLCAxLCAxKTtcbiAgICAgIGZyYWdtZW50LnNwZWVkLnNldChcbiAgICAgICAgTWF0aC5yYW5kb20oKSAqIDUgLSAyLjUsXG4gICAgICAgIE1hdGgucmFuZG9tKCkgKiA1IC0gMi41LFxuICAgICAgICBNYXRoLnJhbmRvbSgpICogNSAtIDIuNSk7XG4gICAgfVxuICB9LFxuXG4gIHdyb25nSGl0OiBmdW5jdGlvbiAoaGFuZCkge1xuICAgIHZhciB3cm9uZ0VsID0gaGFuZCA9PT0gJ2xlZnQnID8gdGhpcy53cm9uZ0VsTGVmdCA6IHRoaXMud3JvbmdFbFJpZ2h0O1xuICAgIGlmICghd3JvbmdFbCkgeyByZXR1cm47IH1cbiAgICB3cm9uZ0VsLm9iamVjdDNELnBvc2l0aW9uLmNvcHkodGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbik7XG4gICAgd3JvbmdFbC5vYmplY3QzRC5wb3NpdGlvbi55ICs9IDAuMjtcbiAgICB3cm9uZ0VsLm9iamVjdDNELnBvc2l0aW9uLnogLT0gMC41O1xuICAgIHdyb25nRWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgd3JvbmdFbC5lbWl0KCdiZWF0d3JvbmcnLCBudWxsLCB0cnVlKTtcbiAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7XG4gIH0sXG5cbiAgbWlzc0hpdDogZnVuY3Rpb24gKGhhbmQpIHtcbiAgICB2YXIgbWlzc0VsID0gaGFuZCA9PT0gJ2xlZnQnID8gdGhpcy5taXNzRWxMZWZ0IDogdGhpcy5taXNzRWxSaWdodDtcbiAgICBpZiAoIW1pc3NFbCB8fCB0aGlzLmRhdGEudHlwZSA9PT0gJ21pbmUnKSB7IHJldHVybjsgfVxuICAgIG1pc3NFbC5vYmplY3QzRC5wb3NpdGlvbi5jb3B5KHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24pO1xuICAgIG1pc3NFbC5vYmplY3QzRC5wb3NpdGlvbi55ICs9IDAuMjtcbiAgICBtaXNzRWwub2JqZWN0M0QucG9zaXRpb24ueiAtPSAwLjU7XG4gICAgbWlzc0VsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgIG1pc3NFbC5lbWl0KCdiZWF0bWlzcycsIG51bGwsIHRydWUpO1xuICAgIGlmIChBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdzeW5jdGVzdCcpKSB7XG4gICAgICBjb25zb2xlLmxvZyh0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50cy5zb25nLmdldEN1cnJlbnRUaW1lKCkpO1xuICAgIH1cbiAgfSxcblxuICBkZXN0cm95QmVhdDogKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcGFyYWxsZWxQbGFuZU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcbiAgICAgIGNvbG9yOiAnIzAwMDA4YicsXG4gICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXG4gICAgfSk7XG4gICAgdmFyIHBsYW5lTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe2NvbG9yOiAnZ3JleScsIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGV9KTtcbiAgICB2YXIgcG9pbnQxID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB2YXIgcG9pbnQyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB2YXIgcG9pbnQzID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoc2FiZXJFbCkge1xuICAgICAgdmFyIGNvcGxhbmFyUG9pbnQ7XG4gICAgICB2YXIgY3V0VGhpY2tuZXNzID0gdGhpcy5jdXRUaGlja25lc3MgPSAwLjAyO1xuICAgICAgdmFyIGRpcmVjdGlvbiA9IHRoaXMuY3V0RGlyZWN0aW9uO1xuICAgICAgdmFyIGxlZnRCb3JkZXJJbm5lclBsYW5lID0gdGhpcy5sZWZ0Qm9yZGVySW5uZXJQbGFuZTtcbiAgICAgIHZhciBsZWZ0Qm9yZGVyT3V0ZXJQbGFuZSA9IHRoaXMubGVmdEJvcmRlck91dGVyUGxhbmU7XG4gICAgICB2YXIgbGVmdEN1dFBsYW5lID0gdGhpcy5sZWZ0Q3V0UGxhbmU7XG4gICAgICB2YXIgcGxhbmVHZW9tZXRyeTtcbiAgICAgIHZhciBwbGFuZU1lc2g7XG4gICAgICB2YXIgcmlnaHRCb3JkZXJJbm5lclBsYW5lID0gdGhpcy5yaWdodEJvcmRlcklubmVyUGxhbmU7XG4gICAgICB2YXIgcmlnaHRCb3JkZXJPdXRlclBsYW5lID0gdGhpcy5yaWdodEJvcmRlck91dGVyUGxhbmU7XG4gICAgICB2YXIgcmlnaHRDdXRQbGFuZSA9IHRoaXMucmlnaHRDdXRQbGFuZTtcbiAgICAgIHZhciB0cmFpbFBvaW50cyA9IHNhYmVyRWwuY29tcG9uZW50cy50cmFpbC5zYWJlclRyYWplY3Rvcnk7XG5cbiAgICAgIHBvaW50MS5jb3B5KHRyYWlsUG9pbnRzWzBdLnRvcCk7XG4gICAgICBwb2ludDIuY29weSh0cmFpbFBvaW50c1swXS5jZW50ZXIpO1xuICAgICAgcG9pbnQzLmNvcHkodHJhaWxQb2ludHNbdHJhaWxQb2ludHMubGVuZ3RoIC0gMV0udG9wKTtcbiAgICAgIGRpcmVjdGlvbi5jb3B5KHBvaW50MSkuc3ViKHBvaW50Myk7XG5cbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0QucG9zaXRpb24uc2V0KDAsIDAsIDApO1xuICAgICAgdGhpcy5wYXJ0UmlnaHRFbC5vYmplY3QzRC5yb3RhdGlvbi5zZXQoMCwgMCwgMCk7XG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG5cbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0Qud29ybGRUb0xvY2FsKHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1swXS5jb3B5KHBvaW50MSkpO1xuICAgICAgdGhpcy5wYXJ0UmlnaHRFbC5vYmplY3QzRC53b3JsZFRvTG9jYWwodGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzWzFdLmNvcHkocG9pbnQyKSk7XG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELndvcmxkVG9Mb2NhbCh0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNbMl0uY29weShwb2ludDMpKTtcblxuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELnBvc2l0aW9uLnNldCgwLCAwLCAwKTtcbiAgICAgIHRoaXMucGFydExlZnRFbC5vYmplY3QzRC5yb3RhdGlvbi5zZXQoMCwgMCwgMCk7XG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0QudXBkYXRlTWF0cml4V29ybGQoKTtcblxuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELndvcmxkVG9Mb2NhbCh0aGlzLmxlZnRDdXRQbGFuZVBvaW50c1swXS5jb3B5KHBvaW50MykpO1xuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELndvcmxkVG9Mb2NhbCh0aGlzLmxlZnRDdXRQbGFuZVBvaW50c1sxXS5jb3B5KHBvaW50MikpO1xuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELndvcmxkVG9Mb2NhbCh0aGlzLmxlZnRDdXRQbGFuZVBvaW50c1syXS5jb3B5KHBvaW50MSkpO1xuXG4gICAgICB0aGlzLmdlbmVyYXRlQ3V0Q2xpcHBpbmdQbGFuZXMoKTtcblxuICAgICAgaWYgKHRoaXMuZGF0YS5kZWJ1Zykge1xuICAgICAgICBjb3BsYW5hclBvaW50ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICAgICAgcGxhbmVHZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KDQuMCwgNC4wLCAxLjAsIDEuMCk7XG5cbiAgICAgICAgcmlnaHRDdXRQbGFuZS5jb3BsYW5hclBvaW50KGNvcGxhbmFyUG9pbnQpO1xuICAgICAgICBwbGFuZUdlb21ldHJ5Lmxvb2tBdChyaWdodEN1dFBsYW5lLm5vcm1hbCk7XG4gICAgICAgIHBsYW5lR2VvbWV0cnkudHJhbnNsYXRlKGNvcGxhbmFyUG9pbnQueCwgY29wbGFuYXJQb2ludC55LCBjb3BsYW5hclBvaW50LnopO1xuXG4gICAgICAgIHBsYW5lTWVzaCA9IG5ldyBUSFJFRS5NZXNoKHBsYW5lR2VvbWV0cnksIHBsYW5lTWF0ZXJpYWwpO1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuc2V0T2JqZWN0M0QoJ3JpZ2h0Q3V0UGxhbmUnLCBwbGFuZU1lc2gpO1xuXG4gICAgICAgIHBsYW5lR2VvbWV0cnkgPSBuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeSg0LjAsIDQuMCwgMS4wLCAxLjApO1xuXG4gICAgICAgIHJpZ2h0Qm9yZGVyT3V0ZXJQbGFuZS5jb3BsYW5hclBvaW50KGNvcGxhbmFyUG9pbnQpO1xuICAgICAgICBwbGFuZUdlb21ldHJ5Lmxvb2tBdChyaWdodEJvcmRlck91dGVyUGxhbmUubm9ybWFsKTtcbiAgICAgICAgcGxhbmVHZW9tZXRyeS50cmFuc2xhdGUoY29wbGFuYXJQb2ludC54LCBjb3BsYW5hclBvaW50LnksIGNvcGxhbmFyUG9pbnQueik7XG5cbiAgICAgICAgY29uc3QgcGFyYWxsZWxQbGFuZU1lc2ggPSBuZXcgVEhSRUUuTWVzaChwbGFuZUdlb21ldHJ5LCBwYXJhbGxlbFBsYW5lTWF0ZXJpYWwpO1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuc2V0T2JqZWN0M0QoJ3BsYW5lUGFyYWxsZWwnLCBwYXJhbGxlbFBsYW5lTWVzaCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYmxvY2tFbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG5cbiAgICAgIGNvbnN0IHBhcnRSaWdodE1hdGVyaWFsID0gdGhpcy5wYXJ0UmlnaHRFbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsO1xuICAgICAgcGFydFJpZ2h0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMgPSBwYXJ0UmlnaHRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcyB8fCBbXTtcbiAgICAgIHBhcnRSaWdodE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLmxlbmd0aCA9IDA7XG4gICAgICBwYXJ0UmlnaHRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5wdXNoKHJpZ2h0Q3V0UGxhbmUpO1xuXG4gICAgICBjb25zdCBjdXRSaWdodE1hdGVyaWFsID0gdGhpcy5jdXRSaWdodEVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWw7XG4gICAgICBjdXRSaWdodE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzID0gY3V0UmlnaHRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcyB8fCBbXTtcbiAgICAgIGN1dFJpZ2h0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMubGVuZ3RoID0gMDtcbiAgICAgIGN1dFJpZ2h0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMucHVzaChyaWdodEJvcmRlck91dGVyUGxhbmUpO1xuICAgICAgY3V0UmlnaHRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5wdXNoKHJpZ2h0Qm9yZGVySW5uZXJQbGFuZSk7XG5cbiAgICAgIGNvbnN0IHBhcnRMZWZ0TWF0ZXJpYWwgPSB0aGlzLnBhcnRMZWZ0RWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbDtcbiAgICAgIHBhcnRMZWZ0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMgPSBwYXJ0TGVmdE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzIHx8IFtdO1xuICAgICAgcGFydExlZnRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5sZW5ndGggPSAwO1xuICAgICAgcGFydExlZnRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5wdXNoKGxlZnRDdXRQbGFuZSk7XG5cbiAgICAgIGNvbnN0IGN1dExlZnRNYXRlcmlhbCA9IHRoaXMuY3V0TGVmdEVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWw7XG4gICAgICBjdXRMZWZ0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMgPSBjdXRMZWZ0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMgfHwgW107XG4gICAgICBjdXRMZWZ0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMubGVuZ3RoID0gMDtcbiAgICAgIGN1dExlZnRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5wdXNoKGxlZnRCb3JkZXJJbm5lclBsYW5lKTtcbiAgICAgIGN1dExlZnRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5wdXNoKGxlZnRCb3JkZXJPdXRlclBsYW5lKTtcblxuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgICAgdGhpcy5wYXJ0UmlnaHRFbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcblxuICAgICAgdGhpcy5lbC5zY2VuZUVsLnJlbmRlcmVyLmxvY2FsQ2xpcHBpbmdFbmFibGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuZ3Jhdml0eVZlbG9jaXR5ID0gMC4xO1xuXG4gICAgICB0aGlzLnJvdGF0aW9uQXhpcy5jb3B5KHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1swXSkuc3ViKHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1sxXSk7XG5cbiAgICAgIHRoaXMucmV0dXJuVG9Qb29sVGltZXIgPSA4MDA7XG5cbiAgICAgIGF1eE9iajNELnVwLmNvcHkocmlnaHRDdXRQbGFuZS5ub3JtYWwpO1xuICAgICAgYXV4T2JqM0QubG9va0F0KGRpcmVjdGlvbik7XG4gICAgICB0aGlzLmV4cGxvZGVFdmVudERldGFpbC5wb3NpdGlvbiA9IHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb247XG4gICAgICB0aGlzLmV4cGxvZGVFdmVudERldGFpbC5yb3RhdGlvbiA9IGF1eE9iajNELnJvdGF0aW9uO1xuICAgICAgdGhpcy5wYXJ0aWNsZXMuZW1pdCgnZXhwbG9kZScsIHRoaXMuZXhwbG9kZUV2ZW50RGV0YWlsLCBmYWxzZSk7XG4gICAgfTtcbiAgfSkoKSxcblxuICBkZXN0cm95TWluZTogZnVuY3Rpb24gKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5taW5lRnJhZ21lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLm1pbmVGcmFnbWVudHNbaV0udmlzaWJsZSA9IHRydWU7XG4gICAgfVxuXG4gICAgdGhpcy5ibG9ja0VsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7XG4gICAgdGhpcy5ncmF2aXR5VmVsb2NpdHkgPSAwLjE7XG4gICAgdGhpcy5yZXR1cm5Ub1Bvb2xUaW1lciA9IDgwMDtcblxuICAgIHRoaXMuZXhwbG9kZUV2ZW50RGV0YWlsLnBvc2l0aW9uID0gdGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbjtcbiAgICB0aGlzLmV4cGxvZGVFdmVudERldGFpbC5yb3RhdGlvbiA9IHRoaXMucmFuZFZlYztcbiAgICB0aGlzLm1pbmVQYXJ0aWNsZXMuZW1pdCgnZXhwbG9kZScsIHRoaXMuZXhwbG9kZUV2ZW50RGV0YWlsLCBmYWxzZSk7XG4gIH0sXG5cbiAgaW5pdEN1dHRpbmdDbGlwcGluZ1BsYW5lczogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubGVmdEN1dFBsYW5lUG9pbnRzV29ybGQgPSBbXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKClcbiAgICBdO1xuICAgIHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkID0gW1xuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKCksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpXG4gICAgXTtcblxuICAgIHRoaXMucmlnaHRDdXRQbGFuZSA9IG5ldyBUSFJFRS5QbGFuZSgpO1xuICAgIHRoaXMucmlnaHRCb3JkZXJPdXRlclBsYW5lID0gbmV3IFRIUkVFLlBsYW5lKCk7XG4gICAgdGhpcy5yaWdodEJvcmRlcklubmVyUGxhbmUgPSBuZXcgVEhSRUUuUGxhbmUoKTtcblxuICAgIHRoaXMubGVmdEN1dFBsYW5lID0gbmV3IFRIUkVFLlBsYW5lKCk7XG4gICAgdGhpcy5sZWZ0Qm9yZGVyT3V0ZXJQbGFuZSA9IG5ldyBUSFJFRS5QbGFuZSgpO1xuICAgIHRoaXMubGVmdEJvcmRlcklubmVyUGxhbmUgPSBuZXcgVEhSRUUuUGxhbmUoKTtcbiAgfSxcblxuICBnZW5lcmF0ZUN1dENsaXBwaW5nUGxhbmVzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlZnRCb3JkZXJJbm5lclBsYW5lID0gdGhpcy5sZWZ0Qm9yZGVySW5uZXJQbGFuZTtcbiAgICB2YXIgbGVmdEJvcmRlck91dGVyUGxhbmUgPSB0aGlzLmxlZnRCb3JkZXJPdXRlclBsYW5lO1xuICAgIHZhciBsZWZ0Q3V0UGxhbmUgPSB0aGlzLmxlZnRDdXRQbGFuZTtcbiAgICB2YXIgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGQgPSB0aGlzLmxlZnRDdXRQbGFuZVBvaW50c1dvcmxkO1xuICAgIHZhciBwYXJ0TGVmdEVsID0gdGhpcy5wYXJ0TGVmdEVsO1xuICAgIHZhciBwYXJ0UmlnaHRFbCA9IHRoaXMucGFydFJpZ2h0RWw7XG4gICAgdmFyIHJpZ2h0Qm9yZGVySW5uZXJQbGFuZSA9IHRoaXMucmlnaHRCb3JkZXJJbm5lclBsYW5lO1xuICAgIHZhciByaWdodEJvcmRlck91dGVyUGxhbmUgPSB0aGlzLnJpZ2h0Qm9yZGVyT3V0ZXJQbGFuZTtcbiAgICB2YXIgcmlnaHRDdXRQbGFuZSA9IHRoaXMucmlnaHRDdXRQbGFuZTtcbiAgICB2YXIgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkID0gdGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzV29ybGQ7XG5cbiAgICBwYXJ0UmlnaHRFbC5vYmplY3QzRC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgIHBhcnRSaWdodEVsLm9iamVjdDNELmxvY2FsVG9Xb3JsZChcbiAgICAgIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZFswXS5jb3B5KHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1swXSkpO1xuICAgIHBhcnRSaWdodEVsLm9iamVjdDNELmxvY2FsVG9Xb3JsZChcbiAgICAgIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZFsxXS5jb3B5KHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1sxXSkpO1xuICAgIHBhcnRSaWdodEVsLm9iamVjdDNELmxvY2FsVG9Xb3JsZChcbiAgICAgIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZFsyXS5jb3B5KHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1syXSkpO1xuXG4gICAgcGFydExlZnRFbC5vYmplY3QzRC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgIHBhcnRMZWZ0RWwub2JqZWN0M0QubG9jYWxUb1dvcmxkKFxuICAgICAgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGRbMF0uY29weSh0aGlzLmxlZnRDdXRQbGFuZVBvaW50c1swXSkpO1xuICAgIHBhcnRMZWZ0RWwub2JqZWN0M0QubG9jYWxUb1dvcmxkKFxuICAgICAgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGRbMV0uY29weSh0aGlzLmxlZnRDdXRQbGFuZVBvaW50c1sxXSkpO1xuICAgIHBhcnRMZWZ0RWwub2JqZWN0M0QubG9jYWxUb1dvcmxkKFxuICAgICAgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGRbMl0uY29weSh0aGlzLmxlZnRDdXRQbGFuZVBvaW50c1syXSkpO1xuXG4gICAgcmlnaHRDdXRQbGFuZS5zZXRGcm9tQ29wbGFuYXJQb2ludHMoXG4gICAgICByaWdodEN1dFBsYW5lUG9pbnRzV29ybGRbMF0sIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZFsxXSwgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkWzJdKTtcbiAgICByaWdodEJvcmRlck91dGVyUGxhbmUuc2V0KHJpZ2h0Q3V0UGxhbmUubm9ybWFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHRDdXRQbGFuZS5jb25zdGFudCArIHRoaXMuY3V0VGhpY2tuZXNzKTtcblxuICAgIGxlZnRDdXRQbGFuZS5zZXRGcm9tQ29wbGFuYXJQb2ludHMoXG4gICAgICBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZFswXSwgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGRbMV0sIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkWzJdKTtcbiAgICBsZWZ0Qm9yZGVyT3V0ZXJQbGFuZS5zZXQobGVmdEN1dFBsYW5lLm5vcm1hbCwgbGVmdEN1dFBsYW5lLmNvbnN0YW50ICsgdGhpcy5jdXRUaGlja25lc3MpO1xuXG4gICAgcmlnaHRCb3JkZXJJbm5lclBsYW5lLnNldEZyb21Db3BsYW5hclBvaW50cyhcbiAgICAgIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZFsyXSwgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkWzFdLCByaWdodEN1dFBsYW5lUG9pbnRzV29ybGRbMF0pO1xuICAgIGxlZnRCb3JkZXJJbm5lclBsYW5lLnNldEZyb21Db3BsYW5hclBvaW50cyhcbiAgICAgIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkWzJdLCBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZFsxXSwgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGRbMF0pO1xuICB9LFxuXG4gIHJldHVyblRvUG9vbDogZnVuY3Rpb24gKGZvcmNlKSB7XG4gICAgaWYgKCF0aGlzLmJhY2tUb1Bvb2wgJiYgIWZvcmNlKSB7IHJldHVybjsgfVxuICAgIHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzW3RoaXMucG9vbE5hbWVdLnJldHVybkVudGl0eSh0aGlzLmVsKTtcbiAgfSxcblxuICBjaGVja0NvbGxpc2lvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBjdXREaXJlY3Rpb24gPSB0aGlzLmRhdGEuY3V0RGlyZWN0aW9uO1xuICAgIGNvbnN0IHNhYmVyQ29sb3JzID0gdGhpcy5zYWJlckNvbG9ycztcbiAgICBjb25zdCBzYWJlckVscyA9IHRoaXMuc2FiZXJFbHM7XG4gICAgY29uc3QgaGl0Qm91bmRpbmdCb3ggPSB0aGlzLmhpdENvbGxpZGVyRWwgJiYgdGhpcy5oaXRCb3VuZGluZ0JveC5zZXRGcm9tT2JqZWN0KFxuICAgICAgdGhpcy5oaXRDb2xsaWRlckVsLmdldE9iamVjdDNEKCdtZXNoJykpO1xuICAgIGNvbnN0IGJlYXRCb3VuZGluZ0JveCA9IHRoaXMuYmVhdEJvdW5kaW5nQm94LnNldEZyb21PYmplY3QoXG4gICAgICB0aGlzLmJsb2NrRWwuZ2V0T2JqZWN0M0QoJ21lc2gnKSk7XG4gICAgdmFyIHdyb25nSGFuZEhpdDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2FiZXJFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBzYWJlckJvdW5kaW5nQm94ID0gc2FiZXJFbHNbaV0uY29tcG9uZW50c1snc2FiZXItY29udHJvbHMnXS5ib3VuZGluZ0JveDtcbiAgICAgIGxldCBzYWJlckNvbnRyb2xzO1xuICAgICAgbGV0IG1heEFuZ2xlO1xuXG4gICAgICBpZiAoIXNhYmVyQm91bmRpbmdCb3gpIHsgYnJlYWs7IH1cblxuICAgICAgY29uc3QgaGFuZCA9IHNhYmVyRWxzW2ldLmdldEF0dHJpYnV0ZSgnc2FiZXItY29udHJvbHMnKS5oYW5kO1xuXG4gICAgICBpZiAoc2FiZXJCb3VuZGluZ0JveC5pbnRlcnNlY3RzQm94KGJlYXRCb3VuZGluZ0JveCkpIHtcbiAgICAgICAgLy8gTm90aWZ5IGZvciBoYXB0aWNzLlxuICAgICAgICB0aGlzLmVsLmVtaXQoYGJlYXRjb2xsaWRlJHtoYW5kfWAsIG51bGwsIHRydWUpO1xuXG4gICAgICAgIC8vIFNvdW5kLlxuICAgICAgICB0aGlzLmVsLnBhcmVudE5vZGUuY29tcG9uZW50c1snYmVhdC1oaXQtc291bmQnXS5wbGF5U291bmQodGhpcy5lbCk7XG5cbiAgICAgICAgaWYgKHRoaXMuZGF0YS50eXBlID09PSAnbWluZScpIHtcbiAgICAgICAgICB0aGlzLmVsLmVtaXQoJ21pbmVoaXQnLCBudWxsLCB0cnVlKTtcbiAgICAgICAgICB0aGlzLmRlc3Ryb3lNaW5lKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmRlc3Ryb3lCZWF0KHNhYmVyRWxzW2ldKTtcblxuICAgICAgICBpZiAoc2FiZXJFbHNbaV0uY29tcG9uZW50c1snc2FiZXItY29udHJvbHMnXS5zd2luZ2luZyAmJlxuICAgICAgICAgICAgdGhpcy5kYXRhLmNvbG9yID09PSBzYWJlckNvbG9yc1toYW5kXSkge1xuICAgICAgICAgIHRoaXMuaGl0U2FiZXJFbCA9IHNhYmVyRWxzW2ldO1xuICAgICAgICAgIHRoaXMuaGl0U2FiZXJFbC5hZGRFdmVudExpc3RlbmVyKCdzdHJva2VlbmQnLCB0aGlzLm9uRW5kU3Ryb2tlLCBPTkNFKTtcbiAgICAgICAgICBzYWJlckNvbnRyb2xzID0gc2FiZXJFbHNbaV0uY29tcG9uZW50c1snc2FiZXItY29udHJvbHMnXTtcbiAgICAgICAgICB0aGlzLmhpdEhhbmQgPSBoYW5kO1xuICAgICAgICAgIHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVggPSAwO1xuICAgICAgICAgIHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVkgPSAwO1xuICAgICAgICAgIHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVhZID0gMDtcblxuICAgICAgICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PT0gJ2Fycm93Jykge1xuICAgICAgICAgICAgc2FiZXJDb250cm9scy51cGRhdGVTdHJva2VEaXJlY3Rpb24oKTtcbiAgICAgICAgICAgIGlmICghc2FiZXJDb250cm9scy5zdHJva2VEaXJlY3Rpb25bdGhpcy5kYXRhLmN1dERpcmVjdGlvbl0pIHtcbiAgICAgICAgICAgICAgdGhpcy53cm9uZ0hpdChoYW5kKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjdXREaXJlY3Rpb24gPT09ICd1cCcgfHwgY3V0RGlyZWN0aW9uID09PSAnZG93bicpIHtcbiAgICAgICAgICAgICAgbWF4QW5nbGUgPSBzYWJlckNvbnRyb2xzLm1heEFuZ2xlUGxhbmVYO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjdXREaXJlY3Rpb24gPT09ICdsZWZ0JyB8fCBjdXREaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcbiAgICAgICAgICAgIG1heEFuZ2xlID0gc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG1heEFuZ2xlID0gc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWFk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1heEFuZ2xlID0gTWF0aC5tYXgoc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWCwgc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWFkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB3cm9uZ0hhbmRIaXQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgdGhpcy5hbmdsZUJlZm9yZUhpdCA9IG1heEFuZ2xlO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgd3JvbmdIYW5kSGl0ID0gaGFuZDtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmICh3cm9uZ0hhbmRIaXQpIHsgdGhpcy53cm9uZ0hpdCh3cm9uZ0hhbmRIaXQpOyB9XG4gICAgfVxuICB9LFxuXG4gIG9uRW5kU3Ryb2tlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGN1dERpcmVjdGlvbiA9IHRoaXMuZGF0YS5jdXREaXJlY3Rpb247XG4gICAgdmFyIGhpdEV2ZW50RGV0YWlsID0gdGhpcy5oaXRFdmVudERldGFpbDtcbiAgICB2YXIgbWF4QW5nbGU7XG4gICAgdmFyIHNhYmVyQ29udHJvbHMgPSB0aGlzLmhpdFNhYmVyRWwuY29tcG9uZW50c1snc2FiZXItY29udHJvbHMnXTtcbiAgICB2YXIgc2NvcmVUZXh0O1xuXG4gICAgLy8gSGFyY29kZWQgdGVtcG9yYXJpbHkuXG4gICAgY29uc3Qgc2FiZXJSb3RhdGlvbiA9IDMuMTQgLyAxMjtcblxuICAgIGlmIChjdXREaXJlY3Rpb24gPT09ICd1cCcgfHwgY3V0RGlyZWN0aW9uID09PSAnZG93bicpIHtcbiAgICAgIG1heEFuZ2xlID0gc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWDtcbiAgICB9IGVsc2UgaWYgKGN1dERpcmVjdGlvbiA9PT0gJ2xlZnQnIHx8IGN1dERpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuICAgICAgbWF4QW5nbGUgPSBzYWJlckNvbnRyb2xzLm1heEFuZ2xlUGxhbmVZO1xuICAgIH0gZWxzZSB7XG4gICAgICBtYXhBbmdsZSA9IHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVhZO1xuICAgIH1cblxuICAgIGNvbnN0IGFuZ2xlQmVmb3JlSGl0ID0gTWF0aC5tYXgoMCwgKHRoaXMuYW5nbGVCZWZvcmVIaXQgLSBzYWJlclJvdGF0aW9uKSAqIDE4MCAvIE1hdGguUEkpO1xuICAgIGNvbnN0IGFuZ2xlQWZ0ZXJIaXQgPSBNYXRoLm1heCgwLCAobWF4QW5nbGUgLSBzYWJlclJvdGF0aW9uKSAqIDE4MCAvIE1hdGguUEkpO1xuXG4gICAgbGV0IHNjb3JlID0gMDtcbiAgICBzY29yZSArPSBhbmdsZUJlZm9yZUhpdCA+PSA4NSA/IDcwIDogKGFuZ2xlQmVmb3JlSGl0IC8gODApICogNzA7XG4gICAgc2NvcmUgKz0gYW5nbGVBZnRlckhpdCA+PSA2MCA/IDMwIDogKGFuZ2xlQWZ0ZXJIaXQgLyA2MCkgKiAzMDtcblxuICAgIGhpdEV2ZW50RGV0YWlsLnNjb3JlID0gc2NvcmU7XG4gICAgdGhpcy5lbC5lbWl0KCdiZWF0aGl0JywgaGl0RXZlbnREZXRhaWwsIHRydWUpO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCd0ZXh0Z2xvd2JvbGQnLCBudWxsLCBmYWxzZSk7XG5cbiAgICBsZXQgYmVhdFNjb3JlUG9vbDtcbiAgICBpZiAoc2NvcmUgPCA2MCkgeyBiZWF0U2NvcmVQb29sID0gU0NPUkVfUE9PTC5PSzsgfVxuICAgIGVsc2UgaWYgKHNjb3JlIDwgODApIHsgYmVhdFNjb3JlUG9vbCA9IFNDT1JFX1BPT0wuR09PRDsgfVxuICAgIGVsc2UgaWYgKHNjb3JlIDwgMTAwKSB7IGJlYXRTY29yZVBvb2wgPSBTQ09SRV9QT09MLkdSRUFUOyB9XG4gICAgZWxzZSB7XG4gICAgICBiZWF0U2NvcmVQb29sID0gU0NPUkVfUE9PTC5TVVBFUjtcblxuICAgICAgdGhpcy5zdXBlckN1dHNbdGhpcy5zdXBlckN1dElkeF0uY29tcG9uZW50cy5zdXBlcmN1dGZ4LmNyZWF0ZVN1cGVyQ3V0KHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24pO1xuICAgICAgdGhpcy5zdXBlckN1dElkeCA9ICh0aGlzLnN1cGVyQ3V0SWR4ICsgMSkgJSB0aGlzLnN1cGVyQ3V0cy5sZW5ndGg7XG4gICAgfVxuXG4gICAgY29uc3Qgc2NvcmVFbCA9IHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzW2JlYXRTY29yZVBvb2xdLnJlcXVlc3RFbnRpdHkoKTtcbiAgICBpZiAoc2NvcmVFbCkge1xuICAgICAgc2NvcmVFbC5vYmplY3QzRC5wb3NpdGlvbi5jb3B5KHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24pO1xuICAgICAgc2NvcmVFbC5wbGF5KCk7XG4gICAgICBzY29yZUVsLmVtaXQoJ2JlYXRzY29yZXN0YXJ0JywgbnVsbCwgZmFsc2UpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogRGVzdHJveWVkIGFuaW1hdGlvbi5cbiAgICovXG4gIHRvY2tEZXN0cm95ZWQ6IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlZnRDdXROb3JtYWwgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHZhciBsZWZ0Um90YXRpb24gPSAwO1xuICAgIHZhciByaWdodEN1dE5vcm1hbCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdmFyIHJpZ2h0Um90YXRpb24gPSAwO1xuICAgIHZhciByb3RhdGlvblN0ZXAgPSAyICogTWF0aC5QSSAvIDE1MDtcbiAgICB2YXIgZnJhZ21lbnQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRpbWVEZWx0YSkge1xuICAgICAgLy8gVXBkYXRlIGdyYXZpdHkgdmVsb2NpdHkuXG4gICAgICB0aGlzLmdyYXZpdHlWZWxvY2l0eSA9IGdldEdyYXZpdHlWZWxvY2l0eSh0aGlzLmdyYXZpdHlWZWxvY2l0eSwgdGltZURlbHRhKTtcbiAgICAgIHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24ueSArPSB0aGlzLmdyYXZpdHlWZWxvY2l0eSAqICh0aW1lRGVsdGEgLyAxMDAwKTtcblxuICAgICAgaWYgKHRoaXMuZGF0YS50eXBlID09ICdtaW5lJykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubWluZUZyYWdtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGZyYWdtZW50ID0gdGhpcy5taW5lRnJhZ21lbnRzW2ldO1xuICAgICAgICAgIGlmICghZnJhZ21lbnQudmlzaWJsZSkgeyBjb250aW51ZTsgfVxuICAgICAgICAgIGZyYWdtZW50LnBvc2l0aW9uLmFkZFNjYWxlZFZlY3RvcihmcmFnbWVudC5zcGVlZCwgdGltZURlbHRhIC8gMTAwMCk7XG4gICAgICAgICAgZnJhZ21lbnQuc2NhbGUubXVsdGlwbHlTY2FsYXIoMC45NylcbiAgICAgICAgICBpZiAoZnJhZ21lbnQuc2NhbGUueSA8IDAuMSl7XG4gICAgICAgICAgICBmcmFnbWVudC52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgcmlnaHRDdXROb3JtYWwuY29weSh0aGlzLnJpZ2h0Q3V0UGxhbmUubm9ybWFsKVxuICAgICAgICAgICAgICAgICAgICAubXVsdGlwbHlTY2FsYXIoREVTVFJPWUVEX1NQRUVEICogKHRpbWVEZWx0YSAvIDUwMCkpO1xuICAgICAgcmlnaHRDdXROb3JtYWwueSA9IDA7ICAvLyBZIGhhbmRsZWQgYnkgZ3Jhdml0eS5cbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0QucG9zaXRpb24uYWRkKHJpZ2h0Q3V0Tm9ybWFsKTtcbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0Quc2V0Um90YXRpb25Gcm9tQXhpc0FuZ2xlKHRoaXMucm90YXRpb25BeGlzLCByaWdodFJvdGF0aW9uKTtcbiAgICAgIHJpZ2h0Um90YXRpb24gPSByaWdodFJvdGF0aW9uID49IDIgKiBNYXRoLlBJID8gMCA6IHJpZ2h0Um90YXRpb24gKyByb3RhdGlvblN0ZXA7XG5cbiAgICAgIGxlZnRDdXROb3JtYWwuY29weSh0aGlzLmxlZnRDdXRQbGFuZS5ub3JtYWwpXG4gICAgICAgICAgICAgICAgICAgLm11bHRpcGx5U2NhbGFyKERFU1RST1lFRF9TUEVFRCAqICh0aW1lRGVsdGEgLyA1MDApKTtcbiAgICAgIGxlZnRDdXROb3JtYWwueSA9IDA7ICAvLyBZIGhhbmRsZWQgYnkgZ3Jhdml0eS5cbiAgICAgIHRoaXMucGFydExlZnRFbC5vYmplY3QzRC5wb3NpdGlvbi5hZGQobGVmdEN1dE5vcm1hbCk7XG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0Quc2V0Um90YXRpb25Gcm9tQXhpc0FuZ2xlKHRoaXMucm90YXRpb25BeGlzLCBsZWZ0Um90YXRpb24pO1xuICAgICAgbGVmdFJvdGF0aW9uID0gbGVmdFJvdGF0aW9uID49IDIgKiBNYXRoLlBJID8gMCA6IGxlZnRSb3RhdGlvbiArIHJvdGF0aW9uU3RlcDtcblxuICAgICAgdGhpcy5nZW5lcmF0ZUN1dENsaXBwaW5nUGxhbmVzKCk7XG5cbiAgICAgIHRoaXMucmV0dXJuVG9Qb29sVGltZXIgLT0gdGltZURlbHRhO1xuICAgICAgdGhpcy5iYWNrVG9Qb29sID0gdGhpcy5yZXR1cm5Ub1Bvb2xUaW1lciA8PSAwO1xuICAgIH07XG4gIH0pKCksXG5cbiAgLyoqXG4gICAqIExvYWQgT0JKIGZyb20gYWxyZWFkeSBwYXJzZWQgYW5kIGxvYWRlZCBPQkogdGVtcGxhdGUuXG4gICAqL1xuICBzZXRPYmpNb2RlbEZyb21UZW1wbGF0ZTogKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBnZW9tZXRyaWVzID0ge307XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKGVsLCB0ZW1wbGF0ZUlkKSB7XG4gICAgICBpZiAoIWdlb21ldHJpZXNbdGVtcGxhdGVJZF0pIHtcbiAgICAgICAgY29uc3QgdGVtcGxhdGVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlbXBsYXRlSWQpO1xuICAgICAgICBpZiAodGVtcGxhdGVFbC5nZXRPYmplY3QzRCgnbWVzaCcpKSB7XG4gICAgICAgICAgZ2VvbWV0cmllc1t0ZW1wbGF0ZUlkXSA9IHRlbXBsYXRlRWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5jaGlsZHJlblswXS5nZW9tZXRyeTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0ZW1wbGF0ZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vZGVsLWxvYWRlZCcsICgpID0+IHtcbiAgICAgICAgICAgIGdlb21ldHJpZXNbdGVtcGxhdGVJZF0gPSB0ZW1wbGF0ZUVsLmdldE9iamVjdDNEKCdtZXNoJykuY2hpbGRyZW5bMF0uZ2VvbWV0cnk7XG4gICAgICAgICAgICB0aGlzLnNldE9iak1vZGVsRnJvbVRlbXBsYXRlKGVsLCB0ZW1wbGF0ZUlkKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCFlbC5nZXRPYmplY3QzRCgnbWVzaCcpKSB7IGVsLnNldE9iamVjdDNEKCdtZXNoJywgbmV3IFRIUkVFLk1lc2goKSk7IH1cbiAgICAgIGVsLmdldE9iamVjdDNEKCdtZXNoJykuZ2VvbWV0cnkgPSBnZW9tZXRyaWVzW3RlbXBsYXRlSWRdO1xuICAgIH07XG4gIH0pKClcbn0pO1xuXG4vKipcbiAqIEdldCB2ZWxvY2l0eSBnaXZlbiBjdXJyZW50IHZlbG9jaXR5IHVzaW5nIGdyYXZpdHkgYWNjZWxlcmF0aW9uLlxuICovXG5mdW5jdGlvbiBnZXRHcmF2aXR5VmVsb2NpdHkgKHZlbG9jaXR5LCB0aW1lRGVsdGEpIHtcbiAgY29uc3QgR1JBVklUWSA9IC05Ljg7XG4gIHJldHVybiB2ZWxvY2l0eSArIChHUkFWSVRZICogKHRpbWVEZWx0YSAvIDEwMDApKTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2JlYXQuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2NvbnNvbGUtc2hvcnRjdXRzJywge1xuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgd2luZG93LiQgPSB2YWwgPT4gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih2YWwpO1xuICAgIHdpbmRvdy4kJCA9IHZhbCA9PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbCk7XG4gICAgd2luZG93LiQkJCA9IHZhbCA9PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbJHt2YWx9XWApLmdldEF0dHJpYnV0ZSh2YWwpO1xuICAgIHdpbmRvdy4kJCQkID0gdmFsID0+IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFske3ZhbH1dYCkuY29tcG9uZW50c1t2YWxdO1xuICAgIHdpbmRvdy5zY2VuZSA9IHRoaXMuZWw7XG4gICAgd2luZG93LnN0YXRlID0gdGhpcy5lbC5zeXN0ZW1zLnN0YXRlLnN0YXRlO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2NvbnNvbGUtc2hvcnRjdXRzLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdjb3B5LXRleHR1cmUnLCB7XG4gIGRlcGVuZGVuY2llczogWydnZW9tZXRyeScsICdtYXRlcmlhbCddLFxuXG4gIHNjaGVtYToge1xuICAgIGZyb206IHt0eXBlOiAnc2VsZWN0b3InfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgZGF0YS5mcm9tLmFkZEV2ZW50TGlzdGVuZXIoJ21hdGVyaWFsdGV4dHVyZWxvYWRlZCcsICgpID0+IHsgdGhpcy5jb3B5VGV4dHVyZSgpOyB9KTtcbiAgICB0aGlzLmNvcHlUZXh0dXJlKCk7XG4gIH0sXG5cbiAgY29weVRleHR1cmU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG4gICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5kYXRhLmZyb207XG4gICAgY29uc3QgbWF0ZXJpYWwgPSBlbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsO1xuXG4gICAgaWYgKCF0YXJnZXQuZ2V0T2JqZWN0M0QoJ21lc2gnKSkgeyByZXR1cm47IH1cblxuICAgIG1hdGVyaWFsLm1hcCA9IHRhcmdldC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm1hcDtcblxuICAgIGlmICghbWF0ZXJpYWwubWFwKSB7IHJldHVybjsgfVxuXG4gICAgbWF0ZXJpYWwubWFwLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICBtYXRlcmlhbC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvY29weS10ZXh0dXJlLmpzIiwiLyoqXG4gKiBMYXNlciBiZWFtLlxuICogQXV0b21hdGljYWxseSBzZXQgbGVuZ3RoIG9uIGludGVyc2VjdGlvbi5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdjdXJzb3ItbGFzZXInLCB7XG4gIGRlcGVuZGVuY2llczogWydnZW9tZXRyeSddLFxuXG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG4gICAgdGhpcy5zYWJlckVsID0gdGhpcy5lbC5jbG9zZXN0KCcuc2FiZXInKTtcblxuICAgIC8vIENhbGN1bGF0ZSBzaXplIHRvIHBvc2l0aW9uIGJlYW0gYXQgdGlwIG9mIGNvbnRyb2xsZXIuXG4gICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLmVsLmdldEF0dHJpYnV0ZSgnZ2VvbWV0cnknKTtcbiAgICBlbC5vYmplY3QzRC5wb3NpdGlvbi56ID0gLTEgKiBnZW9tZXRyeS5oZWlnaHQgLyAyO1xuICAgIHRoaXMub3JpZ2luYWxTaXplID0gZ2VvbWV0cnkuaGVpZ2h0O1xuICAgIHRoaXMuY3VycmVudExlbmd0aCA9IGdlb21ldHJ5LmhlaWdodDtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0aGlzLmRhdGEuZW5hYmxlZDtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuXG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cblxuICAgIGNvbnN0IGN1cnNvciA9IHRoaXMuc2FiZXJFbC5jb21wb25lbnRzLmN1cnNvcjtcbiAgICBpZiAoIWN1cnNvcikgeyByZXR1cm47IH1cblxuICAgIC8vIFRvZ2dsZSBiZWFtLlxuICAgIGNvbnN0IGludGVyc2VjdGVkRWwgPSBjdXJzb3IuaW50ZXJzZWN0ZWRFbDtcblxuICAgIGlmICghaW50ZXJzZWN0ZWRFbCkge1xuICAgICAgLy8gUmV0cmFjdCB0aGUgYmVhbSBpZiBub3QgaW50ZXJzZWN0aW5nLlxuICAgICAgZWwub2JqZWN0M0QucG9zaXRpb24ueiA9IC0yNTtcbiAgICAgIGVsLm9iamVjdDNELnNjYWxlLnggPSAwLjc1O1xuICAgICAgZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5zY2FsZS55ID0gNTA7XG4gICAgICB0aGlzLmN1cnJlbnRMZW5ndGggPSAxO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFNldCBhcHByb3ByaWF0ZSBsZW5ndGggb2YgYmVhbSBvbiBpbnRlcnNlY3Rpb24uXG4gICAgY29uc3QgaW50ZXJzZWN0aW9uID0gdGhpcy5zYWJlckVsLmNvbXBvbmVudHMucmF5Y2FzdGVyLmludGVyc2VjdGlvbnNbMF07XG4gICAgaWYgKCFpbnRlcnNlY3Rpb24pIHsgcmV0dXJuOyB9XG4gICAgZWwub2JqZWN0M0Quc2NhbGUueCA9IDE7XG4gICAgZWwub2JqZWN0M0QucG9zaXRpb24ueiA9ICgtaW50ZXJzZWN0aW9uLmRpc3RhbmNlIC8gMik7XG4gICAgZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5zY2FsZS55ID0gdGhpcy5jdXJyZW50TGVuZ3RoID0gaW50ZXJzZWN0aW9uLmRpc3RhbmNlO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2N1cnNvci1sYXNlci5qcyIsIi8qKlxuICogQ3Vyc29yIG1lc2ggdG8gc2hvdyBhdCBpbnRlcnNlY3Rpb24gcG9pbnQgd2l0aCByZXNwZWN0aXZlIGhhbmQuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnY3Vyc29yLW1lc2gnLCB7XG4gIHNjaGVtYToge1xuICAgIGFjdGl2ZToge2RlZmF1bHQ6IHRydWV9LFxuICAgIGN1cnNvckVsOiB7dHlwZTogJ3NlbGVjdG9yJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zY2VuZVBpdm90RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmVQaXZvdCcpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IHRoaXMuZGF0YS5hY3RpdmU7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjdXJzb3I7XG4gICAgdmFyIGN1cnNvckVsID0gdGhpcy5kYXRhLmN1cnNvckVsO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGludGVyc2VjdGlvbjtcbiAgICB2YXIgaW50ZXJzZWN0ZWRFbDtcbiAgICB2YXIgc2NlbmVQaXZvdEVsID0gdGhpcy5zY2VuZVBpdm90RWw7XG5cbiAgICBpZiAoIXRoaXMuZGF0YS5hY3RpdmUpIHsgcmV0dXJuOyB9XG5cbiAgICBjdXJzb3IgPSBjdXJzb3JFbC5jb21wb25lbnRzLmN1cnNvcjtcbiAgICBpZiAoIWN1cnNvcikgeyByZXR1cm47IH1cblxuICAgIC8vIExvb2sgZm9yIHZhbGlkIGludGVyc2VjdGlvbiB0YXJnZXQuXG4gICAgaW50ZXJzZWN0ZWRFbCA9IGN1cnNvckVsLmNvbXBvbmVudHMuY3Vyc29yLmludGVyc2VjdGVkRWw7XG4gICAgaWYgKGludGVyc2VjdGVkRWwpIHtcbiAgICAgIGVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGN1cnNvciBtZXNoLlxuICAgIGludGVyc2VjdGlvbiA9IGN1cnNvckVsLmNvbXBvbmVudHMucmF5Y2FzdGVyLmdldEludGVyc2VjdGlvbihpbnRlcnNlY3RlZEVsKTtcbiAgICBpZiAoIWludGVyc2VjdGlvbikgeyByZXR1cm47IH1cblxuICAgIGVsLm9iamVjdDNELnBvc2l0aW9uLmNvcHkoaW50ZXJzZWN0aW9uLnBvaW50KTtcblxuICAgIGlmIChzY2VuZVBpdm90RWwpIHtcbiAgICAgIGVsLm9iamVjdDNELnJvdGF0aW9uLmNvcHkoc2NlbmVQaXZvdEVsLm9iamVjdDNELnJvdGF0aW9uKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvY3Vyc29yLW1lc2guanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2RlYnVnLWJlYXQtbG9hZGVyJywge1xuICBkZXBlbmRlbmNpZXM6IFsnYmVhdC1sb2FkZXInXSxcblxuICBzY2hlbWE6IHtcbiAgICBiZWF0RW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBzdGFnZUVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5iZWF0TG9hZGVyID0gdGhpcy5lbC5jb21wb25lbnRzWydiZWF0LWxvYWRlciddO1xuICAgIHRoaXMuc2VsZWN0ZWRCZWF0ID0ge1xuICAgICAgY29sb3I6ICdyZWQnLFxuICAgICAgcG9zaXRpb246ICdtaWRkbGVDZW50ZXJMZWZ0JyxcbiAgICAgIHR5cGU6ICdhcnJvdycsXG4gICAgICBvcmllbnRhdGlvbjogJ3VwJ1xuICAgIH07XG5cbiAgICB0aGlzLmJlYXRzID0ge307XG5cbiAgICB0aGlzLm9uS2V5RG93biA9IHRoaXMub25LZXlEb3duLmJpbmQodGhpcyk7XG5cbiAgICBpZiAodGhpcy5kYXRhLnN0YWdlRW5hYmxlZCB8fCBBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdkZWJ1Z3N0YWdlJykpIHtcbiAgICAgIHRoaXMuYWRkRGVidWdTdGFnZUNvbnRyb2xzKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS5iZWF0RW5hYmxlZCB8fFxuICAgICAgICBBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdkZWJ1Z3N0YXRlJykudHJpbSgpID09PSAnZ2FtZXBsYXknKSB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMub25LZXlEb3duKTtcbiAgICAgIHRoaXMuYWRkRGVidWdCZWF0Q29udHJvbHMoKTtcbiAgICB9XG4gIH0sXG5cbiAgc3Bhd246IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgT2JqZWN0LmtleXModGhpcy5iZWF0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICBzZWxmLmdlbmVyYXRlQmVhdChzZWxmLmJlYXRzW2tleV0pO1xuICAgIH0pO1xuICB9LFxuXG4gIGdlbmVyYXRlQmVhdDogZnVuY3Rpb24gKGJlYXRJbmZvKSB7XG4gICAgdmFyIHR5cGU7XG4gICAgaWYgKGJlYXRJbmZvLnR5cGUgPT09ICd3YWxsJykge1xuICAgICAgdGhpcy5nZW5lcmF0ZVdhbGwoYmVhdEluZm8pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoYmVhdEluZm8udHlwZSA9PT0gJ21pbmUnKSB7XG4gICAgICB0eXBlID0gMztcbiAgICB9IGVsc2Uge1xuICAgICAgdHlwZSA9IGJlYXRJbmZvLmNvbG9yID09PSAncmVkJyA/IDAgOiAxO1xuICAgIH1cbiAgICB0aGlzLmJlYXRMb2FkZXIuZ2VuZXJhdGVCZWF0KHtcbiAgICAgIF9saW5lSW5kZXg6IHRoaXMuYmVhdExvYWRlci5wb3NpdGlvbkh1bWFuaXplZFtiZWF0SW5mby5wb3NpdGlvbl0uaW5kZXgsXG4gICAgICBfbGluZUxheWVyOiB0aGlzLmJlYXRMb2FkZXIucG9zaXRpb25IdW1hbml6ZWRbYmVhdEluZm8ucG9zaXRpb25dLmxheWVyLFxuICAgICAgX2N1dERpcmVjdGlvbjogYmVhdEluZm8udHlwZSA9PT0gJ2RvdCdcbiAgICAgICAgPyA4XG4gICAgICAgIDogdGhpcy5iZWF0TG9hZGVyLm9yaWVudGF0aW9uc0h1bWFuaXplZC5pbmRleE9mKGJlYXRJbmZvLm9yaWVudGF0aW9uKSxcbiAgICAgIF90eXBlOiB0eXBlXG4gICAgfSk7XG4gIH0sXG5cblxuICBnZW5lcmF0ZVdhbGw6IGZ1bmN0aW9uICh3YWxsSW5mbykge1xuICAgIHRoaXMuYmVhdExvYWRlci5icG0gPSA5MDtcbiAgICB0aGlzLmJlYXRMb2FkZXIuZ2VuZXJhdGVXYWxsKHtcbiAgICAgIF9saW5lSW5kZXg6IHRoaXMuYmVhdExvYWRlci5wb3NpdGlvbkh1bWFuaXplZFt3YWxsSW5mby5wb3NpdGlvbl0uaW5kZXgsXG4gICAgICBfd2lkdGg6IDEsXG4gICAgICBfZHVyYXRpb246IDNcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogRGVidWcgZ2VuZXJhdGUgYmVhdHMuXG4gICAqL1xuICBvbktleURvd246IGZ1bmN0aW9uIChldmVudCkge1xuICAgIGNvbnN0IGtleUNvZGUgPSBldmVudC5rZXlDb2RlO1xuICAgIHN3aXRjaCAoa2V5Q29kZSkge1xuICAgICAgY2FzZSAzMjogeyAgLy8gU3BhY2UgYmFyLlxuICAgICAgICB0aGlzLnNwYXduKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBhZGREZWJ1Z0JlYXRDb250cm9sczogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHBhcmVudERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgcGFyZW50RGl2LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBwYXJlbnREaXYuc3R5bGUucmlnaHQgPSAnMCc7XG4gICAgcGFyZW50RGl2LnN0eWxlLnRvcCA9ICcwJztcbiAgICBwYXJlbnREaXYuc3R5bGUucGFkZGluZyA9ICcxMHB4JztcbiAgICBwYXJlbnREaXYuc3R5bGUud2lkdGggPSAnNTAwcHgnO1xuICAgIHBhcmVudERpdi5zdHlsZS5oZWlnaHQgPSAnNjAwcHgnO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocGFyZW50RGl2KTtcblxuICAgIGFkZFR5cGVCZWF0TWVudSgpO1xuICAgIGFkZENvbG9yQmVhdE1lbnUoKTtcbiAgICBhZGRPcmllbnRhdGlvbk1lbnUoKTtcblxuICAgIHNldEJlYXRCdXR0b24oKTtcbiAgICBhZGRCZWF0UG9zaXRpb25NZW51KCk7XG5cbiAgICBhZGRHZW5lcmF0ZUJ1dHRvbigpO1xuXG4gICAgZnVuY3Rpb24gYWRkT3JpZW50YXRpb25NZW51ICgpIHtcbiAgICAgIGNvbnN0IG1lbnVEaXYgPSBhZGRNZW51KCdvcmllbnRhdGlvbicpO1xuICAgICAgYWRkQnV0dG9uKCd0b3AnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignbGVmdCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCdyaWdodCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCdkb3duJywgbWVudURpdik7XG4gICAgICBwYXJlbnREaXYuYXBwZW5kQ2hpbGQobWVudURpdik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkQ29sb3JCZWF0TWVudSAoKSB7XG4gICAgICBjb25zdCBtZW51RGl2ID0gYWRkTWVudSgnY29sb3InKTtcbiAgICAgIGFkZEJ1dHRvbignYmx1ZScsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCdyZWQnLCBtZW51RGl2KTtcbiAgICAgIHBhcmVudERpdi5hcHBlbmRDaGlsZChtZW51RGl2KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRUeXBlQmVhdE1lbnUgKCkge1xuICAgICAgY29uc3QgbWVudURpdiA9IGFkZE1lbnUoJ3R5cGUnKTtcbiAgICAgIGFkZEJ1dHRvbignYXJyb3cnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignZG90JywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ21pbmUnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignd2FsbCcsIG1lbnVEaXYpO1xuICAgICAgcGFyZW50RGl2LmFwcGVuZENoaWxkKG1lbnVEaXYpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZEJlYXRQb3NpdGlvbk1lbnUgKCkge1xuICAgICAgY29uc3QgbWVudURpdiA9IGFkZE1lbnUoJ3Bvc2l0aW9uJyk7XG4gICAgICBhZGRCdXR0b24oJ3RvcExlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbigndG9wQ2VudGVyTGVmdCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCd0b3BDZW50ZXJSaWdodCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCd0b3BSaWdodCcsIG1lbnVEaXYpO1xuXG4gICAgICBhZGRCdXR0b24oJ21pZGRsZUxlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignbWlkZGxlQ2VudGVyTGVmdCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCdtaWRkbGVDZW50ZXJSaWdodCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCdtaWRkbGVSaWdodCcsIG1lbnVEaXYpO1xuXG4gICAgICBhZGRCdXR0b24oJ2JvdHRvbUxlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignYm90dG9tQ2VudGVyTGVmdCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCdib3R0b21DZW50ZXJSaWdodCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCdib3R0b21SaWdodCcsIG1lbnVEaXYpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZE1lbnUgKG5hbWUpIHtcbiAgICAgIGNvbnN0IG1lbnVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIG1lbnVEaXYuaWQgPSBuYW1lO1xuICAgICAgbWVudURpdi5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMjBweCc7XG4gICAgICBtZW51RGl2LnN0eWxlLndpZHRoID0gJzUwMHB4JztcbiAgICAgIG1lbnVEaXYuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snO1xuICAgICAgcGFyZW50RGl2LmFwcGVuZENoaWxkKG1lbnVEaXYpO1xuICAgICAgcmV0dXJuIG1lbnVEaXY7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkQnV0dG9uICh0ZXh0LCBjb250YWluZXJFbCwgY2xpY2tIYW5kbGVyKSB7XG4gICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGNvbnN0IGhhbmRsZXIgPSBjbGlja0hhbmRsZXIgfHwgZnVuY3Rpb24gb25DbGljayAoKSB7XG4gICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBkaXYucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnV0dG9uJyk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnV0dG9ucy5sZW5ndGg7IGkrKykgeyBidXR0b25zW2ldLnN0eWxlLmJhY2tncm91bmQgPSAnIzAwMCc7IH1cbiAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnIzY2Zic7XG4gICAgICAgIHNlbGYuc2VsZWN0ZWRCZWF0W2Rpdi5wYXJlbnRFbGVtZW50LmlkXSA9IHRoaXMuaWQ7XG4gICAgICAgIHNlbGZbJ3NlbGVjdGVkJyArIGRpdi5wYXJlbnRFbGVtZW50LmlkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZGl2LnBhcmVudEVsZW1lbnQuaWQuc2xpY2UoMSkgKyAnRWwnXSA9IHRoaXM7XG4gICAgICB9O1xuICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoJ2J1dHRvbicpO1xuICAgICAgZGl2LmlkID0gdGV4dDtcbiAgICAgIGRpdi5zdHlsZS53aWR0aCA9ICcxMDBweCc7XG4gICAgICBkaXYuc3R5bGUuaGVpZ2h0ID0gJzMwcHgnO1xuICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnIzAwMCc7XG4gICAgICBkaXYuc3R5bGUuY29sb3IgPSAnI2ZmZic7XG4gICAgICBkaXYuc3R5bGUuekluZGV4ID0gOTk5OTk5OTk5O1xuICAgICAgZGl2LnN0eWxlLnBhZGRpbmcgPSAnNXB4JztcbiAgICAgIGRpdi5zdHlsZS5tYXJnaW4gPSAnNXB4JztcbiAgICAgIGRpdi5zdHlsZS5mb250ID0gJzE0cHggc2Fucy1zZXJpZic7XG4gICAgICBkaXYuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gICAgICBkaXYuc3R5bGUubGluZUhlaWdodCA9ICczMHB4JztcbiAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICBkaXYuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snO1xuICAgICAgZGl2LmlubmVySFRNTCA9IHRleHQ7XG4gICAgICBjb250YWluZXJFbC5hcHBlbmRDaGlsZChkaXYpO1xuICAgICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlcik7XG4gICAgICByZXR1cm4gZGl2O1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBhZGRHZW5lcmF0ZUJ1dHRvbiAodGV4dCwgY29udGFpbmVyRWwpIHtcbiAgICAgIGNvbnN0IGJ1dHRvbkVsID0gYWRkQnV0dG9uKCdTcGF3biAoU3BhY2UgQmFyKScsIHBhcmVudERpdiwgKCkgPT4geyBzZWxmLnNwYXduKCk7IH0pO1xuICAgICAgYnV0dG9uRWwuc3R5bGUud2lkdGggPSAnNDYwcHgnO1xuICAgICAgYnV0dG9uRWwuc3R5bGUuYm90dG9tTWFyZ2luID0gJzEwcHgnXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0QmVhdEJ1dHRvbih0ZXh0LCBjb250YWluZXJFbCkge1xuICAgICAgdmFyIGJ1dHRvbkVsID0gYWRkQnV0dG9uKCdTZXQgQmVhdCcsIHBhcmVudERpdiwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29sb3IgPSBzZWxmLnNlbGVjdGVkQmVhdC50eXBlICE9PSAnbWluZScgPyAnICcgKyBzZWxmLnNlbGVjdGVkQmVhdC5jb2xvciA6ICcnO1xuICAgICAgICB2YXIgb3JpZW50YXRpb24gPSBzZWxmLnNlbGVjdGVkQmVhdC50eXBlICE9PSAnYXJyb3cnID8gJycgOiAnICcgKyBzZWxmLnNlbGVjdGVkQmVhdC5vcmllbnRhdGlvbjtcbiAgICAgICAgc2VsZi5zZWxlY3RlZEJlYXQgPSB7XG4gICAgICAgICAgcG9zaXRpb246IHNlbGYuc2VsZWN0ZWRCZWF0LnBvc2l0aW9uLFxuICAgICAgICAgIHR5cGU6IHNlbGYuc2VsZWN0ZWRCZWF0LnR5cGUsXG4gICAgICAgICAgb3JpZW50YXRpb246IHNlbGYuc2VsZWN0ZWRCZWF0Lm9yaWVudGF0aW9uLFxuICAgICAgICAgIGNvbG9yOiBzZWxmLnNlbGVjdGVkQmVhdC5jb2xvclxuICAgICAgICB9O1xuICAgICAgICBpZiAoIXNlbGYuc2VsZWN0ZWRQb3NpdGlvbkVsKSB7IHJldHVybjsgfVxuICAgICAgICBzZWxmLnNlbGVjdGVkUG9zaXRpb25FbC5pbm5lckhUTUwgPSBzZWxmLnNlbGVjdGVkQmVhdC50eXBlICsgY29sb3IgKyBvcmllbnRhdGlvbjtcbiAgICAgICAgc2VsZi5iZWF0c1tzZWxmLnNlbGVjdGVkUG9zaXRpb25FbC5pZF0gPSB7XG4gICAgICAgICAgcG9zaXRpb246IHNlbGYuc2VsZWN0ZWRCZWF0LnBvc2l0aW9uLFxuICAgICAgICAgIHR5cGU6IHNlbGYuc2VsZWN0ZWRCZWF0LnR5cGUsXG4gICAgICAgICAgb3JpZW50YXRpb246IHNlbGYuc2VsZWN0ZWRCZWF0Lm9yaWVudGF0aW9uLFxuICAgICAgICAgIGNvbG9yOiBzZWxmLnNlbGVjdGVkQmVhdC5jb2xvclxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICBidXR0b25FbC5zdHlsZS53aWR0aCA9ICc0NjBweCc7XG4gICAgICBidXR0b25FbC5zdHlsZS5ib3R0b21NYXJnaW4gPSAnMTBweCdcbiAgICB9O1xuICB9LFxuXG4gIGFkZERlYnVnU3RhZ2VDb250cm9sczogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjdXJyQ29udHJvbCA9IDA7XG5cbiAgICBjb25zdCBhZGRDb250cm9sID0gKGksIG5hbWUsIHR5cGUpID0+IHtcbiAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgZGl2LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgIGRpdi5pZCA9ICdzdGFnZWNvbnRyb2wnICsgaTtcbiAgICAgIGRpdi5zdHlsZS53aWR0aCA9ICcxMDBweCc7XG4gICAgICBkaXYuc3R5bGUuaGVpZ2h0ID0gJzMwcHgnO1xuICAgICAgZGl2LnN0eWxlLnRvcCA9IHR5cGUgPT09ICdlbGVtZW50JyA/ICcyMHB4JyA6ICc3MHB4JztcbiAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDAnO1xuICAgICAgZGl2LnN0eWxlLmNvbG9yID0gJyNmZmYnO1xuICAgICAgZGl2LnN0eWxlLnpJbmRleCA9IDk5OTk5OTk5OTtcbiAgICAgIGRpdi5zdHlsZS5wYWRkaW5nID0gJzVweCc7XG4gICAgICBkaXYuc3R5bGUuZm9udCA9ICcxNHB4IHNhbnMtc2VyaWYnO1xuICAgICAgZGl2LnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xuICAgICAgZGl2LnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICAgIGRpdi5zdHlsZS5sZWZ0ID0gKDIwICsgaSAqIDEyMCkrJ3B4JztcbiAgICAgIGRpdi5pbm5lckhUTUwgPSBuYW1lO1xuICAgICAgaWYgKHR5cGUgPT09ICdlbGVtZW50Jykge1xuICAgICAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YWdlY29udHJvbCcgKyBjdXJyQ29udHJvbCkuc3R5bGUuYmFja2dyb3VuZCA9ICcjMDAwJztcbiAgICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICcjNjZmJztcbiAgICAgICAgICBjdXJyQ29udHJvbCA9IGk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuYmVhdExvYWRlci5nZW5lcmF0ZUV2ZW50KHtfdHlwZTogY3VyckNvbnRyb2wsIF92YWx1ZTogaX0pXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdik7XG4gICAgfTtcblxuICAgIFtcbiAgICAgICdza3knLFxuICAgICAgJ3R1bm5lbE5lb24nLFxuICAgICAgJ2xlZnRTdGFnZUxhc2VycycsXG4gICAgICAncmlnaHRTdGFnZUxhc2VycycsXG4gICAgICAnZmxvb3InXG4gICAgXS5mb3JFYWNoKChpZCwgaSkgPT4geyBhZGRDb250cm9sKGksIGlkLCAnZWxlbWVudCcpOyB9KTtcblxuICAgIFtcbiAgICAgICdvZmYnLFxuICAgICAgJ2JsdWUnLFxuICAgICAgJ2JsdWUnLFxuICAgICAgJ2JsdWVmYWRlJyxcbiAgICAgICcnLFxuICAgICAgJ3JlZCcsXG4gICAgICAncmVkJyxcbiAgICAgICdyZWRmYWRlJ1xuICAgIF0uZm9yRWFjaCgoaWQsIGkpID0+IHsgYWRkQ29udHJvbChpLCBpZCwgJ3ZhbHVlJyk7IH0pO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2RlYnVnLWJlYXQtbG9hZGVyLmpzIiwiLyoqXG4gKiBLZXlib2FyZCBiaW5kaW5ncyB0byBjb250cm9sIGNvbnRyb2xsZXIuXG4gKiBQb3NpdGlvbiBjb250cm9sbGVyIGluIGZyb250IG9mIGNhbWVyYS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdkZWJ1Zy1jb250cm9sbGVyJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHByaW1hcnlIYW5kO1xuICAgIHZhciBzZWNvbmRhcnlIYW5kO1xuXG4gICAgaWYgKCFBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdkZWJ1ZycpKSB7IHJldHVybjsgfVxuXG4gICAgY29uc29sZS5sb2coJyVjIGRlYnVnLWNvbnRyb2xsZXIgZW5hYmxlZCAnLCAnYmFja2dyb3VuZDogIzExMTsgY29sb3I6IHJlZCcpO1xuXG4gICAgdGhpcy5pc0Nsb25pbmcgPSBmYWxzZTtcbiAgICB0aGlzLmlzRGVsZXRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmlzVHJpZ2dlckRvd24gPSBmYWxzZTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uTW91c2VNb3ZlLmJpbmQodGhpcykpO1xuXG4gICAgcHJpbWFyeUhhbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlnaHRIYW5kJyk7XG4gICAgc2Vjb25kYXJ5SGFuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsZWZ0SGFuZCcpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZ0ID0+IHtcbiAgICAgIGlmICghZXZ0LmlzVHJ1c3RlZCkgeyByZXR1cm47IH1cbiAgICAgIHByaW1hcnlIYW5kLmVtaXQoJ3RyaWdnZXJkb3duJyk7XG4gICAgICBwcmltYXJ5SGFuZC5lbWl0KCd0cmlnZ2VydXAnKTtcbiAgICB9KTtcblxuICAgIGlmIChBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdkZWJ1ZycpID09PSAnb2N1bHVzJykge1xuICAgICAgcHJpbWFyeUhhbmQuZW1pdCgnY29udHJvbGxlcmNvbm5lY3RlZCcsIHtuYW1lOiAnb2N1bHVzLXRvdWNoLWNvbnRyb2xzJ30pO1xuICAgICAgc2Vjb25kYXJ5SGFuZC5lbWl0KCdjb250cm9sbGVyY29ubmVjdGVkJywge25hbWU6ICdvY3VsdXMtdG91Y2gtY29udHJvbHMnfSk7XG4gICAgICBwcmltYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xsZXInLCAnY29udHJvbGxlclR5cGUnLCAnb2N1bHVzLXRvdWNoLWNvbnRyb2xzJyk7XG4gICAgICBzZWNvbmRhcnlIYW5kLnNldEF0dHJpYnV0ZSgnY29udHJvbGxlcicsICdjb250cm9sbGVyVHlwZScsICdvY3VsdXMtdG91Y2gtY29udHJvbHMnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcHJpbWFyeUhhbmQuZW1pdCgnY29udHJvbGxlcmNvbm5lY3RlZCcsIHtuYW1lOiAndml2ZS1jb250cm9scyd9KTtcbiAgICAgIHNlY29uZGFyeUhhbmQuZW1pdCgnY29udHJvbGxlcmNvbm5lY3RlZCcsIHtuYW1lOiAndml2ZS1jb250cm9scyd9KTtcbiAgICAgIHByaW1hcnlIYW5kLnNldEF0dHJpYnV0ZSgnY29udHJvbGxlcicsICdjb250cm9sbGVyVHlwZScsICd2aXZlLWNvbnRyb2xzJyk7XG4gICAgICBzZWNvbmRhcnlIYW5kLnNldEF0dHJpYnV0ZSgnY29udHJvbGxlcicsICdjb250cm9sbGVyVHlwZScsICd2aXZlLWNvbnRyb2xzJyk7XG4gICAgfVxuXG4gICAgLy8gRW5hYmxlIHJheWNhc3Rlci5cbiAgICB0aGlzLmVsLmVtaXQoJ2VudGVyLXZyJywgbnVsbCwgZmFsc2UpO1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGV2dCA9PiB7XG4gICAgICB2YXIgcHJpbWFyeVBvc2l0aW9uO1xuICAgICAgdmFyIHByaW1hcnlSb3RhdGlvbjtcbiAgICAgIHZhciBzZWNvbmRhcnlQb3NpdGlvbjtcbiAgICAgIHZhciBzZWNvbmRhcnlSb3RhdGlvbjtcblxuICAgICAgaWYgKCFldnQuc2hpZnRLZXkpIHsgcmV0dXJuOyB9XG5cbiAgICAgIC8vIDxzcGFjZT4gZm9yIHRyaWdnZXIuXG4gICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDMyKSB7XG4gICAgICAgIGlmICh0aGlzLmlzVHJpZ2dlckRvd24pIHtcbiAgICAgICAgICBwcmltYXJ5SGFuZC5lbWl0KCd0cmlnZ2VydXAnKTtcbiAgICAgICAgICB0aGlzLmlzVHJpZ2dlckRvd24gPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwcmltYXJ5SGFuZC5lbWl0KCd0cmlnZ2VyZG93bicpO1xuICAgICAgICAgIHRoaXMuaXNUcmlnZ2VyRG93biA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyA8cT4gZm9yIHNlY29uZGFyeSB0cmlnZ2VyLlxuICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA4MSkge1xuICAgICAgICBpZiAodGhpcy5pc1NlY29uZGFyeVRyaWdnZXJEb3duKSB7XG4gICAgICAgICAgc2Vjb25kYXJ5SGFuZC5lbWl0KCd0cmlnZ2VydXAnKTtcbiAgICAgICAgICB0aGlzLmlzU2Vjb25kYXJ5VHJpZ2dlckRvd24gPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZWNvbmRhcnlIYW5kLmVtaXQoJ3RyaWdnZXJkb3duJyk7XG4gICAgICAgICAgdGhpcy5pc1NlY29uZGFyeVRyaWdnZXJEb3duID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIDxuPiBzZWNvbmRhcnkgZ3JpcC5cbiAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kYXJ5R3JpcERvd24pIHtcbiAgICAgICAgICBzZWNvbmRhcnlIYW5kLmVtaXQoJ2dyaXB1cCcpO1xuICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5R3JpcERvd24gPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZWNvbmRhcnlIYW5kLmVtaXQoJ2dyaXBkb3duJyk7XG4gICAgICAgICAgdGhpcy5zZWNvbmRhcnlHcmlwRG93biA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gPG0+IHByaW1hcnkgZ3JpcC5cbiAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzcpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpbWFyeUdyaXBEb3duKSB7XG4gICAgICAgICAgcHJpbWFyeUhhbmQuZW1pdCgnZ3JpcHVwJyk7XG4gICAgICAgICAgdGhpcy5wcmltYXJ5R3JpcERvd24gPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwcmltYXJ5SGFuZC5lbWl0KCdncmlwZG93bicpO1xuICAgICAgICAgIHRoaXMucHJpbWFyeUdyaXBEb3duID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBNZW51IGJ1dHRvbiA8MT4uXG4gICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDQ5KSB7XG4gICAgICAgIHNlY29uZGFyeUhhbmQuZW1pdCgnbWVudWRvd24nKTtcbiAgICAgIH1cblxuICAgICAgLy8gUG9zaXRpb24gYmluZGluZ3MuXG4gICAgICBpZiAoZXZ0LmN0cmxLZXkpIHtcbiAgICAgICAgc2Vjb25kYXJ5UG9zaXRpb24gPSBzZWNvbmRhcnlIYW5kLmdldEF0dHJpYnV0ZSgncG9zaXRpb24nKTtcbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA3MikgeyBzZWNvbmRhcnlQb3NpdGlvbi54IC09IDAuMDE7IH0gIC8vIGguXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzQpIHsgc2Vjb25kYXJ5UG9zaXRpb24ueSAtPSAwLjAxOyB9ICAvLyBqLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc1KSB7IHNlY29uZGFyeVBvc2l0aW9uLnkgKz0gMC4wMTsgfSAgLy8gay5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA3NikgeyBzZWNvbmRhcnlQb3NpdGlvbi54ICs9IDAuMDE7IH0gIC8vIGwuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNTkgfHwgZXZ0LmtleUNvZGUgPT09IDE4NikgeyBzZWNvbmRhcnlQb3NpdGlvbi56IC09IDAuMDE7IH0gIC8vIDsuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gMjIyKSB7IHNlY29uZGFyeVBvc2l0aW9uLnogKz0gMC4wMTsgfSAgLy8gOy5cbiAgICAgICAgc2Vjb25kYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgQUZSQU1FLnV0aWxzLmNsb25lKHNlY29uZGFyeVBvc2l0aW9uKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcmltYXJ5UG9zaXRpb24gPSBwcmltYXJ5SGFuZC5nZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJyk7XG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzIpIHsgcHJpbWFyeVBvc2l0aW9uLnggLT0gMC4wMTsgfSAgLy8gaC5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA3NCkgeyBwcmltYXJ5UG9zaXRpb24ueSAtPSAwLjAxOyB9ICAvLyBqLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc1KSB7IHByaW1hcnlQb3NpdGlvbi55ICs9IDAuMDE7IH0gIC8vIGsuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzYpIHsgcHJpbWFyeVBvc2l0aW9uLnggKz0gMC4wMTsgfSAgLy8gbC5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA1OSB8fCBldnQua2V5Q29kZSA9PT0gMTg2KSB7IHByaW1hcnlQb3NpdGlvbi56IC09IDAuMDE7IH0gIC8vIDsuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gMjIyKSB7IHByaW1hcnlQb3NpdGlvbi56ICs9IDAuMDE7IH0gIC8vIDsuXG4gICAgICAgIHByaW1hcnlIYW5kLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBBRlJBTUUudXRpbHMuY2xvbmUocHJpbWFyeVBvc2l0aW9uKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJvdGF0aW9uIGJpbmRpbmdzLlxuICAgICAgaWYgKGV2dC5jdHJsS2V5KSB7XG4gICAgICAgIHNlY29uZGFyeVJvdGF0aW9uID0gc2Vjb25kYXJ5SGFuZC5nZXRBdHRyaWJ1dGUoJ3JvdGF0aW9uJyk7XG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gODkpIHsgc2Vjb25kYXJ5Um90YXRpb24ueCAtPSAxMDsgfSAgLy8geS5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA3OSkgeyBzZWNvbmRhcnlSb3RhdGlvbi54ICs9IDEwOyB9ICAvLyBvLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDg1KSB7IHNlY29uZGFyeVJvdGF0aW9uLnkgLT0gMTA7IH0gIC8vIHUuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzMpIHsgc2Vjb25kYXJ5Um90YXRpb24ueSArPSAxMDsgfSAgLy8gaS5cbiAgICAgICAgc2Vjb25kYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ3JvdGF0aW9uJywgQUZSQU1FLnV0aWxzLmNsb25lKHNlY29uZGFyeVJvdGF0aW9uKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcmltYXJ5Um90YXRpb24gPSBwcmltYXJ5SGFuZC5nZXRBdHRyaWJ1dGUoJ3JvdGF0aW9uJyk7XG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gODkpIHsgcHJpbWFyeVJvdGF0aW9uLnggLT0gMTA7IH0gIC8vIHkuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzkpIHsgcHJpbWFyeVJvdGF0aW9uLnggKz0gMTA7IH0gIC8vIG8uXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gODUpIHsgcHJpbWFyeVJvdGF0aW9uLnkgLT0gMTA7IH0gIC8vIHUuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzMpIHsgcHJpbWFyeVJvdGF0aW9uLnkgKz0gMTA7IH0gIC8vIGkuXG4gICAgICAgIHByaW1hcnlIYW5kLnNldEF0dHJpYnV0ZSgncm90YXRpb24nLCBBRlJBTUUudXRpbHMuY2xvbmUocHJpbWFyeVJvdGF0aW9uKSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBwcmltYXJ5SGFuZDtcbiAgICB2YXIgc2Vjb25kYXJ5SGFuZDtcblxuICAgIHRoaXMuYm91bmRzID0gZG9jdW1lbnQuYm9keS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIGlmICghQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWcnKSkgeyByZXR1cm47IH1cblxuICAgIHByaW1hcnlIYW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JpZ2h0SGFuZCcpO1xuICAgIHNlY29uZGFyeUhhbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVmdEhhbmQnKTtcblxuICAgIHNlY29uZGFyeUhhbmQub2JqZWN0M0QucG9zaXRpb24uc2V0KC0wLjIsIDEuNSwgLTAuNSk7XG4gICAgcHJpbWFyeUhhbmQub2JqZWN0M0QucG9zaXRpb24uc2V0KDAuMiwgMS41LCAtMC41KTtcbiAgICBzZWNvbmRhcnlIYW5kLnNldEF0dHJpYnV0ZSgncm90YXRpb24nLCB7eDogMzUsIHk6IDAsIHo6IDB9KTtcbiAgfSxcblxuICBvbk1vdXNlTW92ZTogKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkaXJlY3Rpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIGNvbnN0IG1vdXNlID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcbiAgICBjb25zdCBjYW1lcmFQb3MgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgIGNvbnN0IGJvdW5kcyA9IHRoaXMuYm91bmRzO1xuICAgICAgY29uc3QgY2FtZXJhID0gdGhpcy5lbC5zY2VuZUVsLmNhbWVyYTtcbiAgICAgIGNvbnN0IGxlZnQgPSBldnQuY2xpZW50WCAtIGJvdW5kcy5sZWZ0O1xuICAgICAgY29uc3QgdG9wID0gZXZ0LmNsaWVudFkgLSBib3VuZHMudG9wO1xuICAgICAgbW91c2UueCA9IChsZWZ0IC8gYm91bmRzLndpZHRoKSAqIDIgLSAxO1xuICAgICAgbW91c2UueSA9ICgtdG9wIC8gYm91bmRzLmhlaWdodCkgKiAyIC0gMTtcblxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbWVyYScpLm9iamVjdDNELmdldFdvcmxkUG9zaXRpb24oY2FtZXJhUG9zKTtcbiAgICAgIGRpcmVjdGlvbi5zZXQobW91c2UueCwgbW91c2UueSwgMC41KS51bnByb2plY3QoY2FtZXJhKS5zdWIoY2FtZXJhUG9zKS5ub3JtYWxpemUoKTtcblxuICAgICAgY29uc3QgaGFuZFBvcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaWdodEhhbmQnKS5vYmplY3QzRC5wb3NpdGlvbjtcbiAgICAgIGNvbnN0IGRpc3RhbmNlID0gLWNhbWVyYVBvcy56IC8gZGlyZWN0aW9uLno7XG4gICAgICBjYW1lcmEuZ2V0V29ybGRQb3NpdGlvbihoYW5kUG9zKS5hZGQoZGlyZWN0aW9uLm11bHRpcGx5U2NhbGFyKGRpc3RhbmNlKSk7XG4gICAgICBoYW5kUG9zLnkgKz0gMC44O1xuICAgIH07XG4gIH0pKClcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvZGVidWctY29udHJvbGxlci5qcyIsIi8qKlxuICogTG9nIGN1cnNvciBldmVudHMuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZGVidWctY3Vyc29yJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBldnQgPT4ge1xuICAgICAgdGhpcy5sb2coJ21vdXNlZW50ZXInLCBldnQuZGV0YWlsLmludGVyc2VjdGVkRWwsICdncmVlbicpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgZXZ0ID0+IHtcbiAgICAgIHRoaXMubG9nKCdtb3VzZWxlYXZlJywgZXZ0LmRldGFpbC5pbnRlcnNlY3RlZEVsLCAncmVkJyk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZ0ID0+IHtcbiAgICAgIHRoaXMubG9nKCdjbGljaycsIGV2dC5kZXRhaWwuaW50ZXJzZWN0ZWRFbCwgJ2JsdWUnKTtcbiAgICB9KTtcbiAgfSxcblxuICBsb2c6IGZ1bmN0aW9uIChldmVudCwgaW50ZXJzZWN0ZWRFbCwgY29sb3IpIHtcbiAgICBpZiAoaW50ZXJzZWN0ZWRFbC5pZCkge1xuICAgICAgY29uc29sZS5sb2coYCVjWyR7ZXZlbnR9XSAke2ludGVyc2VjdGVkRWwuaWR9YCwgYGNvbG9yOiAke2NvbG9yfWApO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhgJWNbJHtldmVudH1dYCwgYGNvbG9yOiAke2NvbG9yfWApO1xuICAgICAgY29uc29sZS5sb2coaW50ZXJzZWN0ZWRFbCk7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2RlYnVnLWN1cnNvci5qcyIsIi8qKlxuICogRW1pdCBldmVudHMgZnJvbSBxdWVyeSBwYXJhbWV0ZXIgdG8gc3RhdGUgdG8gYXV0b21hdGljYWxseSBzZXQgdXAgc3RhdGUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZGVidWctc29uZy10aW1lJywge1xuICBkZXBlbmRlbmNpZXM6IFsnc29uZyddLFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIUFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2RlYnVnLXNvbmctdGltZScpKSB7IHJldHVybjsgfVxuICAgIHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZWwuY29tcG9uZW50cy5zb25nLmdldEN1cnJlbnRUaW1lKCkpO1xuICAgIH0sIDI1MCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvZGVidWctc29uZy10aW1lLmpzIiwiLyoqXG4gKiBFbWl0IGV2ZW50cyBmcm9tIHF1ZXJ5IHBhcmFtZXRlciB0byBzdGF0ZSB0byBhdXRvbWF0aWNhbGx5IHNldCB1cCBzdGF0ZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdkZWJ1Zy1zdGF0ZScsIHtcbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGZsYWdzID0gQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWdzdGF0ZScpLnRyaW0oKTtcbiAgICBpZiAoIWZsYWdzKSB7IHJldHVybjsgfVxuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBmbGFncy5zcGxpdCgnLCcpLmZvckVhY2goZmxhZyA9PiB7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KGBkZWJ1ZyR7ZmxhZy50cmltKCl9YCwgbnVsbCwgZmFsc2UpO1xuICAgICAgfSk7XG4gICAgfSwgNTAwKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1zdGF0ZS5qcyIsImltcG9ydCB7Z2V0R3JpZFV2c30gZnJvbSAnYWZyYW1lLWF0bGFzLXV2cy1jb21wb25lbnQnO1xucmVxdWlyZSgnLi4vLi4vdmVuZG9yL0J1ZmZlckdlb21ldHJ5VXRpbHMnKTtcblxuY29uc3QgY29sb3JIZWxwZXIgPSBuZXcgVEhSRUUuQ29sb3IoKTtcblxuY29uc3QgZ2VvbWV0cnkgPSBjcmVhdGVHZW9tZXRyeSgpO1xuY29uc3QgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xuICBhbHBoYU1hcDogY3JlYXRlQWxwaGFNYXAoKSxcbiAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gIHZlcnRleENvbG9yczogVEhSRUUuVmVydGV4Q29sb3JzXG59KTtcblxuLyoqXG4gKiBGYWtlIGdsb3cgdXNpbmcgbWVyZ2VkIG92ZXJsYXllZCBjeWxpbmRlcnMgd2l0aCBhbHBoYSBtYXAuXG4gKiBSZXF1aXJlcyBUSFJFRS5CdWZmZXJHZW9tZXRyeVV0aWxzLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2Zha2UtZ2xvdycsIHtcbiAgc2NoZW1hOiB7XG4gICAgY29sb3I6IHtkZWZhdWx0OiAnI0ZGRid9XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuc2V0T2JqZWN0M0QoJ21lc2gnLCBuZXcgVEhSRUUuTWVzaChjcmVhdGVHZW9tZXRyeSh0aGlzLmRhdGEuY29sb3IpLCBtYXRlcmlhbCkpO1xuICB9XG59KTtcblxuZnVuY3Rpb24gY3JlYXRlQWxwaGFNYXAgKCkge1xuICBjb25zdCBhbHBoYUNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICBhbHBoYUNhbnZhcy5oZWlnaHQgPSAxO1xuICBhbHBoYUNhbnZhcy53aWR0aCA9IDQ7XG5cbiAgY29uc3QgY3R4ID0gYWxwaGFDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAvLyBGb3IgZmlyc3QgY29sb3IuXG4gIGN0eC5maWxsU3R5bGUgPSAncmdiKDEwLCAxMCwgMTApJztcbiAgY3R4LmZpbGxSZWN0KDAsIDAsIDEsIDEpO1xuICBjdHguZmlsbFN0eWxlID0gJ3JnYigxNSwgMTUsIDE1KSc7XG4gIGN0eC5maWxsUmVjdCgxLCAwLCAxLCAxKTtcbiAgY3R4LmZpbGxTdHlsZSA9ICdyZ2IoMjMsIDIzICwyMyknO1xuICBjdHguZmlsbFJlY3QoMiwgMCwgMSwgMSk7XG4gIGN0eC5maWxsU3R5bGUgPSAncmdiKDI4LCAyOCwgMjgpJztcbiAgY3R4LmZpbGxSZWN0KDMsIDAsIDEsIDEpO1xuXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIGFscGhhQ2FudmFzLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICBhbHBoYUNhbnZhcy5zdHlsZS56SW5kZXggPSA5OTk5OTk5OTk5OTk7XG4gICAgYWxwaGFDYW52YXMuc3R5bGUubGVmdCA9IDA7XG4gICAgYWxwaGFDYW52YXMuc3R5bGUudG9wID0gMDtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFscGhhQ2FudmFzKTtcbiAgfSwgMTAwMCk7XG4gIHJldHVybiBuZXcgVEhSRUUuQ2FudmFzVGV4dHVyZShhbHBoYUNhbnZhcyk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUdlb21ldHJ5IChjb2xvcikge1xuICBjb2xvckhlbHBlci5zZXQoY29sb3IpO1xuXG4gIGNvbnN0IGN5bGluZGVycyA9IFtcbiAgICB7aGVpZ2h0OiAwLjE4MzEsIHJhZGl1czogMC4wMDU1fSxcbiAgICB7aGVpZ2h0OiAwLjE4MzIsIHJhZGl1czogMC4wMDY1fSxcbiAgICB7aGVpZ2h0OiAwLjE4MzMsIHJhZGl1czogMC4wMDc1fSxcbiAgICB7aGVpZ2h0OiAwLjE4MzQsIHJhZGl1czogMC4wMDg1fVxuICBdO1xuXG4gIGNvbnN0IGdlb21ldHJpZXMgPSBjeWxpbmRlcnMubWFwKChjeWxpbmRlckRhdGEsIGkpID0+IHtcbiAgICBjb25zdCBjeWxpbmRlciA9IG5ldyBUSFJFRS5DeWxpbmRlckJ1ZmZlckdlb21ldHJ5KFxuICAgICAgY3lsaW5kZXJEYXRhLnJhZGl1cyxcbiAgICAgIGN5bGluZGVyRGF0YS5yYWRpdXMsXG4gICAgICBjeWxpbmRlckRhdGEuaGVpZ2h0XG4gICAgKTtcblxuICAgIGNvbnN0IGNvbG9yQXJyYXkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN5bGluZGVyLmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXkubGVuZ3RoOyBpICs9IDMpIHtcbiAgICAgIGNvbG9yQXJyYXlbaV0gPSBjb2xvckhlbHBlci5yO1xuICAgICAgY29sb3JBcnJheVtpICsgMV0gPSBjb2xvckhlbHBlci5nO1xuICAgICAgY29sb3JBcnJheVtpICsgMl0gPSBjb2xvckhlbHBlci5iO1xuICAgIH1cbiAgICBjeWxpbmRlci5hZGRBdHRyaWJ1dGUoJ2NvbG9yJywgbmV3IFRIUkVFLkZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUoY29sb3JBcnJheSwgMykpO1xuXG4gICAgY29uc3QgYWxwaGFVdnMgPSBnZXRHcmlkVXZzKDAsIGksIDEsIDQpO1xuICAgIGNvbnN0IHV2cyA9IGN5bGluZGVyLmF0dHJpYnV0ZXMudXYuYXJyYXk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1dnMubGVuZ3RoOyBpICs9IDYpIHtcbiAgICAgIHV2c1tpXSA9IGFscGhhVXZzWzBdLng7XG4gICAgICB1dnNbaSArIDFdID0gYWxwaGFVdnNbMF0ueTtcblxuICAgICAgdXZzW2kgKyAyXSA9IGFscGhhVXZzWzFdLng7XG4gICAgICB1dnNbaSArIDNdID0gYWxwaGFVdnNbMV0ueTtcblxuICAgICAgdXZzW2kgKyA0XSA9IGFscGhhVXZzWzJdLng7XG4gICAgICB1dnNbaSArIDVdID0gYWxwaGFVdnNbMl0ueTtcbiAgICB9XG4gICAgY3lsaW5kZXIuYXR0cmlidXRlcy51di5uZWVkc1VwZGF0ZSA9IHRydWU7XG5cbiAgICByZXR1cm4gY3lsaW5kZXI7XG4gIH0pO1xuXG4gIGNvbnN0IGdlb21ldHJ5ID0gVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscy5tZXJnZUJ1ZmZlckdlb21ldHJpZXMoZ2VvbWV0cmllcyk7XG4gIHJldHVybiBnZW9tZXRyeVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvZmFrZS1nbG93LmpzIiwiXG5jb25zdCBDT0xPUlMgPSByZXF1aXJlKCcuLi9jb25zdGFudHMvY29sb3JzLmpzJyk7XG5jb25zdCBISVRfQ09MT1IgPSBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk5FT05fUkVEKTtcbmNvbnN0IEJPUkRFUl9DT0xPUiA9IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuTkVPTl9CTFVFKTtcblxuQUZSQU1FLnJlZ2lzdGVyU2hhZGVyKCdmbG9vclNoYWRlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgbm9ybWFsTWFwOiB7dHlwZTogJ21hcCcsIGlzOiAndW5pZm9ybSd9LFxuICAgIGVudk1hcDoge3R5cGU6ICdtYXAnLCBpczogJ3VuaWZvcm0nfSxcbiAgICBoaXRSaWdodDoge3R5cGU6ICd2ZWMzJywgaXM6ICd1bmlmb3JtJywgZGVmYXVsdDoge3g6IDAsIHk6IDEsIHo6IDB9fSxcbiAgICBoaXRMZWZ0OiB7dHlwZTogJ3ZlYzMnLCBpczogJ3VuaWZvcm0nLCBkZWZhdWx0OiB7eDogMCwgeTogMCwgejogMH19XG4gIH0sXG5cbiAgdmVydGV4U2hhZGVyOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdXZzLnh5ID0gdXYueHk7XG4gICAgICB2ZWM0IHAgPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1xuICAgICAgd29ybGRQb3MgPSAobW9kZWxNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICkpLnh5ejtcbiAgICAgIGdsX1Bvc2l0aW9uID0gcDtcbiAgICB9XG4gIGAsXG5cbiAgZnJhZ21lbnRTaGFkZXI6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB1bmlmb3JtIHZlYzMgY29sb3I7XG4gICAgdW5pZm9ybSBzYW1wbGVyMkQgbm9ybWFsTWFwO1xuICAgIHVuaWZvcm0gc2FtcGxlcjJEIGVudk1hcDtcbiAgICB1bmlmb3JtIHZlYzMgaGl0UmlnaHQ7XG4gICAgdW5pZm9ybSB2ZWMzIGhpdExlZnQ7XG5cbiAgICAjZGVmaW5lIEhJVF9DT0xPUiB2ZWMzKCR7SElUX0NPTE9SLnJ9LCAke0hJVF9DT0xPUi5nfSwgJHtISVRfQ09MT1IuYn0pXG4gICAgI2RlZmluZSBCT1JERVJfQ09MT1IgdmVjMygke0JPUkRFUl9DT0xPUi5yfSwgJHtCT1JERVJfQ09MT1IuZ30sICR7Qk9SREVSX0NPTE9SLmJ9KVxuXG4gICAgdmVjMyBkcmF3Q2lyY2xlKHZlYzMgcCwgdmVjMyBjZW50ZXIsIGZsb2F0IHJhZGl1cywgZmxvYXQgZWRnZVdpZHRoLCB2ZWMzIGNvbG9yKSB7XG4gICAgICByZXR1cm4gY29sb3IqKDEuMC1zbW9vdGhzdGVwKHJhZGl1cywgcmFkaXVzK2VkZ2VXaWR0aCwgbGVuZ3RoKHAtY2VudGVyKSkpO1xuICAgIH1cblxuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHZlYzIgcCA9IHV2cy54eSAtIDAuNTtcbiAgICAgIHZlYzMgYm9yZGVyID0gdmVjMyhzbW9vdGhzdGVwKDAuNDksIDAuNDk1LCBhYnMocC54KSkgKyBzbW9vdGhzdGVwKDAuNDksIDAuNDk1LCBhYnMocC55KSkpO1xuICAgICAgYm9yZGVyICs9IEJPUkRFUl9DT0xPUiAqIChzbW9vdGhzdGVwKDAuNDc1LCAwLjQ5NSwgYWJzKHAueCkpICsgc21vb3Roc3RlcCgwLjQ3NSwgMC40OTUsIGFicyhwLnkpKSkgKiAuNztcbiAgICAgIHAqPSA0LjA7XG5cbiAgICAgIHZlYzMgaGl0Q29sb3IgPSBISVRfQ09MT1I7XG4gICAgICB2ZWMzIGhpdCA9IHZlYzMoMC4wKTtcblxuICAgICAgaGl0ICs9IGRyYXdDaXJjbGUod29ybGRQb3MsIGhpdFJpZ2h0LCAwLjA0LCAwLjA1LCBoaXRDb2xvcik7XG4gICAgICBoaXQgKz0gZHJhd0NpcmNsZSh3b3JsZFBvcywgaGl0UmlnaHQsIDAuMDIsIDAuMDMsIHZlYzMoMC43LCAwLjcsIDAuNykpO1xuICAgICAgaGl0ICs9IGRyYXdDaXJjbGUod29ybGRQb3MsIGhpdExlZnQsIDAuMDQsIDAuMDUsIGhpdENvbG9yKTtcbiAgICAgIGhpdCArPSBkcmF3Q2lyY2xlKHdvcmxkUG9zLCBoaXRMZWZ0LCAwLjAyLCAwLjAzLCB2ZWMzKDAuNywgMC43LCAwLjcpKTtcblxuICAgICAgdmVjMyBub3JtYWwgPSBub3JtYWxpemUodGV4dHVyZTJEKG5vcm1hbE1hcCwgdXZzKS54eXopO1xuXG4gICAgICAvLyBlbnZpcm9ubWVudCByZWZsZWN0aW9uXG4gICAgICB2ZWMzIHJlZmxlY3RWZWMgPSBub3JtYWxpemUocmVmbGVjdChub3JtYWxpemUod29ybGRQb3MgLSBjYW1lcmFQb3NpdGlvbiksIG5vcm1hbCkpO1xuICAgICAgLy92ZWMzIHJlZmxlY3RWaWV3ID0gbm9ybWFsaXplKCh2aWV3TWF0cml4ICogdmVjNChyZWZsZWN0VmVjLCAwLjApKS54eXogKyB2ZWMzKDAuMCwgMC4wLCAxLjApKTtcblxuICAgICAgdmVjMyByZWYgPSB0ZXh0dXJlMkQoZW52TWFwLCByZWZsZWN0VmVjLnh5ICogdmVjMigwLjMsIDEuMCkgKyB2ZWMyKDAuNzUsIC1jYW1lcmFQb3NpdGlvbi56ICogMC4wNSkpLnh5eiAqIDAuMTQ7XG5cbiAgICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQocmVmICsgYm9yZGVyICsgaGl0LCAxLjApO1xuICAgIH1cbiAgYFxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9mbG9vci1zaGFkZXIuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2dhbWVvdmVyJywge1xuICBzY2hlbWE6IHtcbiAgICBpc0dhbWVPdmVyOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmVhdENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZWF0Q29udGFpbmVyJyk7XG4gICAgdGhpcy5nYW1lT3ZlckVscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1thbmltYXRpb25fX2dhbWVvdmVyXScpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBpZiAoIW9sZERhdGEuaXNHYW1lT3ZlciAmJiB0aGlzLmRhdGEuaXNHYW1lT3Zlcikge1xuICAgICAgdGhpcy50cmlnZ2VyQW5pbWF0aW9ucygpO1xuICAgICAgdGhpcy5jb3VudERvd24gPSAxO1xuICAgIH1cbiAgICBpZiAob2xkRGF0YS5pc0dhbWVPdmVyICYmICF0aGlzLmRhdGEuaXNHYW1lT3Zlcikge1xuICAgICAgdGhpcy5yZXNldCgpO1xuICAgIH1cbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5pc0dhbWVPdmVyKSB7IHJldHVybjsgfVxuICAgIGlmICh0aGlzLmNvdW50RG93biA+PSAwKSB7XG4gICAgICB0aGlzLmJlYXRDb250YWluZXIub2JqZWN0M0QucG9zaXRpb24ueiA9IC1NYXRoLnBvdygxIC0gdGhpcy5jb3VudERvd24sIDIpICogMS41O1xuICAgICAgdGhpcy5jb3VudERvd24gLT0gZGVsdGEgLyAxMDAwO1xuICAgIH1cbiAgfSxcblxuICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmVhdENvbnRhaW5lci5vYmplY3QzRC5wb3NpdGlvbi56ID0gMDtcbiAgICB0aGlzLmVsLnNjZW5lRWwuc2V0QXR0cmlidXRlKCdzdGFnZS1jb2xvcnMnLCAnY29sb3InLCAnYmx1ZScpO1xuICB9LFxuXG4gIHRyaWdnZXJBbmltYXRpb25zOiBmdW5jdGlvbiAoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmdhbWVPdmVyRWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmdhbWVPdmVyRWxzW2ldLmVtaXQoJ2dhbWVvdmVyJywgbnVsbCwgZmFsc2UpO1xuICAgIH1cbiAgICB0aGlzLmVsLmVtaXQoJ3RleHRnbG93b2ZmJywgbnVsbCwgZmFsc2UpO1xuICAgIHRoaXMuZWwuZW1pdCgnYmdjb2xvcmdhbWVvdmVyJywgbnVsbCwgZmFsc2UpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2dhbWVvdmVyLmpzIiwibGV0IGkgPSAwO1xuXG4vKipcbiAqIFByZWxvYWQgdGV4dHVyZXMgdG8gR1BVIHRoYXQgYXJlIG5vdCB2aXNpYmxlIGZyb20gdGhlIHN0YXJ0Li5cbiAqIHRocmVlLmpzIHJlbmRlcmVyIGJ5IGRlZmF1bHQgd2lsbCBub3QgdXBsb2FkIHRleHR1cmVzIGZyb20gbm9uLXZpc2libGUgZW50aXRpZXMuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZ3B1LXByZWxvYWRlcicsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ21hdGVyaWFscyddLFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnByZWxvYWRNaW5lRW52TWFwcygpO1xuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLnByZWxvYWRBdGxhcygpO1xuICAgICAgdGhpcy5wcmVsb2FkTG9nbygpO1xuICAgICAgLy90aGlzLnByZWxvZEJlYW1NYXAoKTtcbiAgICAgIC8vdGhpcy5wcmVsb2FkQmVhdEVudk1hcCgpO1xuICAgICAgdGhpcy5wcmVsb2FkQ3V0UGFydGljbGVzKCk7XG4gICAgICB0aGlzLnByZWxvYWRLZXlib2FyZCgpO1xuICAgICAgLy90aGlzLnByZWxvYWRNaXNzTWFwKCk7XG4gICAgICB0aGlzLnByZWxvYWRQbGF5QnV0dG9uKCk7XG4gICAgICB0aGlzLnByZWxvYWRTZWFyY2hQcmV2UGFnZSgpO1xuICAgICAgLy90aGlzLnByZWxvYWRXYWxsTWFwKCk7XG4gICAgICAvL3RoaXMucHJlbG9hZFdyb25nTWFwKCk7XG4gICAgICB0aGlzLnByZWxvYWRHZW5yZXMoKTtcbiAgICB9LCAxMDAwKTtcbiAgfSxcblxuICBwcmVsb2FkQXRsYXM6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBzdGFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzdGFnZU9iaicpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUoc3RhZ2UuZ2V0T2JqZWN0M0QoJ21lc2gnKS5jaGlsZHJlblswXS5tYXRlcmlhbC51bmlmb3Jtcy5zcmMudmFsdWUpO1xuICB9LFxuXG4gIHByZWxvYWRMb2dvOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgbG9nbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsb2dvQm9keScpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUobG9nby5nZXRPYmplY3QzRCgnbWVzaCcpLmNoaWxkcmVuWzBdLm1hdGVyaWFsLnVuaWZvcm1zLnNyYy52YWx1ZSk7XG4gIH0sXG5cbiAgcHJlbG9hZEJlYW1NYXA6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBiZWFtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tiZWFtc10nKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKGJlYW1zLmNvbXBvbmVudHMuYmVhbXMudGV4dHVyZSk7XG4gIH0sXG5cbiAgcHJlbG9hZEJlYXRFbnZNYXA6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBiZWF0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2JlYXRDb250YWluZXIgW21peGlufj1cImJlYXRcIl0nKTtcbiAgICBiZWF0Lm9iamVjdDNELnRyYXZlcnNlKG5vZGUgPT4ge1xuICAgICAgaWYgKCFub2RlLm1hdGVyaWFsKSB7IHJldHVybjsgfVxuICAgICAgaWYgKG5vZGUubWF0ZXJpYWwuZW52TWFwKSB7XG4gICAgICAgIHRoaXMucHJlbG9hZFRleHR1cmUobm9kZS5tYXRlcmlhbC5lbnZNYXApO1xuICAgICAgfVxuICAgICAgaWYgKG5vZGUubWF0ZXJpYWwubWFwKSB7XG4gICAgICAgIHRoaXMucHJlbG9hZFRleHR1cmUobm9kZS5tYXRlcmlhbC5tYXApO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIHByZWxvYWRDdXRQYXJ0aWNsZXM6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBwYXJ0aWNsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2FiZXJQYXJ0aWNsZXMnKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKHBhcnRpY2xlcy5jb21wb25lbnRzLnBhcnRpY2xlcGxheWVyLm1hdGVyaWFsLm1hcCk7XG4gIH0sXG5cbiAgcHJlbG9hZEtleWJvYXJkOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3Qga2V5Ym9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2V5Ym9hcmQnKS5jb21wb25lbnRzWydzdXBlci1rZXlib2FyZCddO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUoa2V5Ym9hcmQua2JJbWcuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5tYXApO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUoa2V5Ym9hcmQua2V5Q29sb3JQbGFuZS5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm1hcCk7XG4gIH0sXG5cbiAgcHJlbG9hZE1pbmVFbnZNYXBzOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3Qgc3RhZ2VDb2xvcnMgPSB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50c1snc3RhZ2UtY29sb3JzJ107XG4gICAgdGhpcy5lbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21pbmVyZWRlbnZtYXBsb2FkZWQnLCAoKSA9PiB7XG4gICAgICB0aGlzLnByZWxvYWRUZXh0dXJlKHN0YWdlQ29sb3JzLm1pbmVFbnZNYXAucmVkKTtcbiAgICB9KTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignbWluZWJsdWVlbnZtYXBsb2FkZWQnLCAoKSA9PiB7XG4gICAgICB0aGlzLnByZWxvYWRUZXh0dXJlKHN0YWdlQ29sb3JzLm1pbmVFbnZNYXAuYmx1ZSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgcHJlbG9hZE1pc3NNYXA6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBtaXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21pc3NMZWZ0Jyk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShtaXNzLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkUGxheUJ1dHRvbjogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHBsYXlCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcGxheUJ1dHRvbicpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUocGxheUJ1dHRvbi5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm1hcCk7XG4gIH0sXG5cbiAgcHJlbG9hZFNlYXJjaFByZXZQYWdlIDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHByZXZQYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlYXJjaFByZXZQYWdlJyk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShwcmV2UGFnZS5jaGlsZHJlblswXS5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm1hcCk7XG4gIH0sXG5cbiAgcHJlbG9hZFdhbGxNYXA6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB3YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYS1lbnRpdHlbd2FsbF0nKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKHdhbGwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC51bmlmb3Jtcy50ZXgudmFsdWUpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUod2FsbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLnVuaWZvcm1zLmVudi52YWx1ZSk7XG4gIH0sXG5cbiAgcHJlbG9hZFdyb25nTWFwOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3Qgd3JvbmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjd3JvbmdMZWZ0Jyk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZSh3cm9uZy5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm1hcCk7XG4gIH0sXG5cbiAgcHJlbG9hZEdlbnJlczogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGdlbnJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nZW5yZUljb24nKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKGdlbnJlcy5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm1hcCk7XG4gIH0sXG5cbiAgcHJlbG9hZFRleHR1cmU6IGZ1bmN0aW9uICh0ZXh0dXJlKSB7XG4gICAgaWYgKCF0ZXh0dXJlIHx8ICF0ZXh0dXJlLmltYWdlKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1tncHUtcHJlbG9hZGVyXSBFcnJvciBwcmVsb2FkaW5nIHRleHR1cmUnLCB0ZXh0dXJlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCF0ZXh0dXJlLmltYWdlLmNvbXBsZXRlKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1tncHUtcHJlbG9hZGVyXSBFcnJvciBwcmVsb2FkaW5nLCBpbWFnZSBub3QgbG9hZGVkJywgdGV4dHVyZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuZWwucmVuZGVyZXIuc2V0VGV4dHVyZTJEKHRleHR1cmUsIGkrKyAlIDgpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2dwdS1wcmVsb2FkZXIuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2hhY2snLCB7XG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmICghdGhpcy5lbC5zY2VuZUVsLmlzKCd2ci1tb2RlJykpIHtcbiAgICAgICAgdGhpcy5lbC5zY2VuZUVsLmVudGVyVlIoKTtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICB9XG4gICAgfSwgMTAwMCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvaGFjay5qcyIsImNvbnN0IGV2ZW50cyA9IFtcbiAgJ3RyaWdnZXJkb3duJyxcbiAgJ2dyaXBkb3duJyxcbiAgJ2FidXR0b25kb3duJyxcbiAgJ2JidXR0b25kb3duJyxcbiAgJ3hidXR0b25kb3duJyxcbiAgJ3lidXR0b25kb3duJyxcbiAgJ3RyYWNrcGFkZG93bidcbl07XG5cbi8qKlxuICogU3dhcCBsZWZ0IG9yIHJpZ2h0LWhhbmRlZCBtb2RlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2hhbmQtc3dhcHBlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnN3YXBIYW5kID0gdGhpcy5zd2FwSGFuZC5iaW5kKHRoaXMpO1xuICAgIGV2ZW50cy5mb3JFYWNoKGV2ZW50ID0+IHtcbiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5zd2FwSGFuZCk7XG4gICAgfSk7XG4gIH0sXG5cbiAgc3dhcEhhbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuXG4gICAgLy8gSGFuZGxlZCB2aWEgc3RhdGUuXG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ2FjdGl2ZWhhbmRzd2FwJywgbnVsbCwgZmFsc2UpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2hhbmQtc3dhcHBlci5qcyIsIi8qKlxuICogSGFwdGljcyB3aGVuIHNhYmVycyBjb2xsaWRlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2hhcHRpY3Mtc2FiZXInLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG5cbiAgICB0aGlzLmlzQ29sbGlkaW5nID0gZmFsc2U7XG4gICAgdGhpcy50aWNrID0gQUZSQU1FLnV0aWxzLnRocm90dGxlVGljayh0aGlzLnRpY2suYmluZCh0aGlzKSwgMTAwKTtcblxuICAgIGVsLnNldEF0dHJpYnV0ZSgnaGFwdGljc19fc2FiZXInLCB7ZHVyOiAxMDAsIGZvcmNlOiAwLjA3NX0pO1xuXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGV2dCA9PiB7XG4gICAgICBpZiAoIWV2dC5kZXRhaWwgfHwgIWV2dC5kZXRhaWwuaW50ZXJzZWN0ZWRFbCkgeyByZXR1cm47IH1cblxuICAgICAgY29uc3QgaW50ZXJzZWN0ZWRFbCA9IGV2dC5kZXRhaWwuaW50ZXJzZWN0ZWRFbDtcbiAgICAgIGlmICghaW50ZXJzZWN0ZWRFbC5jbGFzc0xpc3QuY29udGFpbnMoJ2JsYWRlJykgfHwgaW50ZXJzZWN0ZWRFbCA9PT0gZWwpIHtcbiAgICAgICAgdGhpcy5pc0NvbGxpZGluZyA9IGZhbHNlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaXNDb2xsaWRpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5lbC5jb21wb25lbnRzLmhhcHRpY3NfX3NhYmVyLnB1bHNlKCk7XG4gICAgfSk7XG5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgZXZ0ID0+IHtcbiAgICAgIHRoaXMuaXNDb2xsaWRpbmcgPSBmYWxzZTtcbiAgICB9KTtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzQ29sbGlkaW5nKSB7IHJldHVybjsgfVxuICAgIHRoaXMuZWwuY29tcG9uZW50cy5oYXB0aWNzX19zYWJlci5wdWxzZSgpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2hhcHRpY3Mtc2FiZXIuanMiLCIvKipcbiAqIExpc3RlbiB0byBhYWJiLWNvbGxpZGVyIGV2ZW50IGZvciB3YWxsIGhhcHRpY3MuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnaGFwdGljcy13YWxsJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIHRoaXMuaXNIaXR0aW5nV2FsbCA9IGZhbHNlO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnaGFwdGljc19fd2FsbCcsIHtkdXI6IDUwLCBmb3JjZTogMC4wNzV9KTtcblxuICAgIHRoaXMuY2hlY2tJZkhpdHRpbmdXYWxsID0gdGhpcy5jaGVja0lmSGl0dGluZ1dhbGwuYmluZCh0aGlzKTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgdGhpcy5jaGVja0lmSGl0dGluZ1dhbGwpO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLmNoZWNrSWZIaXR0aW5nV2FsbCk7XG5cbiAgICB0aGlzLnRpY2sgPSBBRlJBTUUudXRpbHMudGhyb3R0bGVUaWNrKHRoaXMudGljay5iaW5kKHRoaXMpLCA1MCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIE9uIHJheWNhc3RlciBldmVudCwgY2hlY2sgaWYgd2UgYXJlIHN0aWxsIGhpdHRpbmcgYSB3YWxsLlxuICAgKi9cbiAgY2hlY2tJZkhpdHRpbmdXYWxsOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgaW50ZXJzZWN0ZWRFbHMgPSB0aGlzLmVsLmNvbXBvbmVudHMucmF5Y2FzdGVyX19nYW1lLmludGVyc2VjdGVkRWxzO1xuICAgIHRoaXMuaXNIaXR0aW5nV2FsbCA9IGZhbHNlO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW50ZXJzZWN0ZWRFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChpbnRlcnNlY3RlZEVsc1tpXS5jb21wb25lbnRzLndhbGwpIHtcbiAgICAgICAgdGhpcy5pc0hpdHRpbmdXYWxsID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzSGl0dGluZ1dhbGwpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5jb21wb25lbnRzLmhhcHRpY3NfX3dhbGwucHVsc2UoKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9oYXB0aWNzLXdhbGwuanMiLCIvKipcbiAqIFVwZGF0ZSB3aW5kb3cgdGl0bGUgYW5kIGhpc3RvcnkuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnaGlzdG9yeScsIHtcbiAgc2NoZW1hOiB7XG4gICAgY2hhbGxlbmdlSWQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgc29uZ05hbWU6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgc29uZ1N1Yk5hbWU6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGhpc3RvcnkucHVzaFN0YXRlKFxuICAgICAgJycsXG4gICAgICBkYXRhLnNvbmdOYW1lLFxuICAgICAgdXBkYXRlUXVlcnlQYXJhbSh3aW5kb3cubG9jYXRpb24uaHJlZiwgJ2NoYWxsZW5nZScsIGRhdGEuY2hhbGxlbmdlSWQpXG4gICAgKTtcbiAgICBkb2N1bWVudC50aXRsZSA9IGBTdXBlciBTYWJlciAtICR7ZGF0YS5zb25nTmFtZX1gO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2hpc3RvcnkuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2ludHJvLXNvbmcnLCB7XG4gIHNjaGVtYToge1xuICAgIGlzUGxheWluZzoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGlzU2VhcmNoaW5nOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYW5hbHlzZXJFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdWRpb0FuYWx5c2VyJyk7XG4gICAgdGhpcy5hdWRpbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRyb1NvbmcnKTtcbiAgICB0aGlzLnRpbWVvdXQgPSBudWxsO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICBjb25zdCBhdWRpbyA9IHRoaXMuYXVkaW87XG5cbiAgICBpZiAoIXRoaXMuZWwuc2NlbmVFbC5pc1BsYXlpbmcpIHsgcmV0dXJuOyB9XG5cbiAgICBpZiAoIW9sZERhdGEuaXNTZWFyY2hpbmcgJiYgdGhpcy5kYXRhLmlzU2VhcmNoaW5nKSB7IHJldHVybjsgfVxuXG4gICAgLy8gUGxheS5cbiAgICBpZiAoIW9sZERhdGEuaXNQbGF5aW5nICYmIHRoaXMuZGF0YS5pc1BsYXlpbmcpIHtcbiAgICAgIHRoaXMuYW5hbHlzZXJFbC5jb21wb25lbnRzLmF1ZGlvYW5hbHlzZXIucmVzdW1lQ29udGV4dCgpO1xuICAgICAgdGhpcy5hbmFseXNlckVsLnNldEF0dHJpYnV0ZSgnYXVkaW9hbmFseXNlcicsICdzcmMnLCBhdWRpbyk7XG4gICAgICB0aGlzLmZhZGVJbkF1ZGlvKCk7XG4gICAgfVxuXG4gICAgLy8gUGF1c2UuXG4gICAgaWYgKG9sZERhdGEuaXNQbGF5aW5nICYmICF0aGlzLmRhdGEuaXNQbGF5aW5nKSB7IGF1ZGlvLnBhdXNlKCk7IH1cbiAgfSxcblxuICBwYXVzZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYXVkaW8ucGF1c2UoKTtcbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mYWRlSW5BdWRpbygpO1xuICB9LFxuXG4gIGZhZGVJbkF1ZGlvOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ211dGUnKSkgeyByZXR1cm47IH1cbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5hbmFseXNlckVsLmNvbXBvbmVudHMuYXVkaW9hbmFseXNlci5jb250ZXh0O1xuICAgIGNvbnN0IGdhaW5Ob2RlID0gdGhpcy5hbmFseXNlckVsLmNvbXBvbmVudHMuYXVkaW9hbmFseXNlci5nYWluTm9kZTtcbiAgICBnYWluTm9kZS5nYWluLnNldFZhbHVlQXRUaW1lKDAsIGNvbnRleHQuY3VycmVudFRpbWUpO1xuICAgIHRoaXMuYXVkaW8ucGxheSgpO1xuICAgIGdhaW5Ob2RlLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoMC41LCBjb250ZXh0LmN1cnJlbnRUaW1lICsgMC41KTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9pbnRyby1zb25nLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdrZXlib2FyZC1yYXljYXN0YWJsZScsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ3N1cGVyLWtleWJvYXJkJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgY29uZGl0aW9uOiB7ZGVmYXVsdDogJyd9XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuY29tcG9uZW50c1snc3VwZXIta2V5Ym9hcmQnXS5rYkltZy5zZXRBdHRyaWJ1dGUoJ2JpbmQtdG9nZ2xlX19yYXljYXN0YWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuY29uZGl0aW9uKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9rZXlib2FyZC1yYXljYXN0YWJsZS5qcyIsImNvbnN0IGZpcmViYXNlID0gcmVxdWlyZSgnZmlyZWJhc2UvYXBwJyk7XG5yZXF1aXJlKCdmaXJlYmFzZS9maXJlc3RvcmUnKTtcblxuY29uc3QgTlVNX1NDT1JFU19ESVNQTEFZRUQgPSAxMDtcblxuLyoqXG4gKiBIaWdoIHNjb3JlIHdpdGggRmlyZWJhc2UgY2xvdWQgc3RvcmUuXG4gKiBJbmRleDogY2hhbGxlbmdlSWQgQVNDIGRpZmZpY3VsdHkgQVNDIHNjb3JlIERFU0MgdGltZSBBU0NcbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdsZWFkZXJib2FyZCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgYXBpS2V5OiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIGF1dGhEb21haW46IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgZGF0YWJhc2VVUkw6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgcHJvamVjdElkOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIHN0b3JhZ2VCdWNrZXQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgbWVzc2FnaW5nU2VuZGVySWQ6IHt0eXBlOiAnc3RyaW5nJ30sXG5cbiAgICBjaGFsbGVuZ2VJZDoge2RlZmF1bHQ6ICcnfSxcbiAgICBtZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZDoge2RlZmF1bHQ6ICcnfSxcbiAgICBpc1ZpY3Rvcnk6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5xdWFsaWZ5aW5nSW5kZXggPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zY29yZXMgPSBbXTtcbiAgICB0aGlzLmV2ZW50RGV0YWlsID0ge3Njb3JlczogdGhpcy5zY29yZXN9O1xuICAgIHRoaXMuYWRkRXZlbnREZXRhaWwgPSB7c2NvcmVEYXRhOiB1bmRlZmluZWQsIGluZGV4OiB1bmRlZmluZWR9O1xuXG4gICAgdGhpcy51c2VybmFtZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzdXBlcnNhYmVydXNlcm5hbWUnKSB8fCAnU3VwZXIgWmVhbG90JztcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2xlYWRlcmJvYXJkdXNlcm5hbWUnLCBldnQgPT4ge1xuICAgICAgdGhpcy51c2VybmFtZSA9IGV2dC5kZXRhaWwudmFsdWU7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc3VwZXJzYWJlcnVzZXJuYW1lJywgdGhpcy51c2VybmFtZSk7XG4gICAgfSk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdsZWFkZXJib2FyZHN1Ym1pdCcsIHRoaXMuYWRkU2NvcmUuYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIC8vIEluaXRpYWxpemUgQ2xvdWQgRmlyZXN0b3JlIHRocm91Z2ggRmlyZWJhc2UuXG4gICAgaWYgKCFmaXJlYmFzZS5hcHBzLmxlbmd0aCAmJiB0aGlzLmRhdGEuYXBpS2V5KSB7XG4gICAgICBmaXJlYmFzZS5pbml0aWFsaXplQXBwKHtcbiAgICAgICAgYXBpS2V5OiB0aGlzLmRhdGEuYXBpS2V5LFxuICAgICAgICBhdXRoRG9tYWluOiB0aGlzLmRhdGEuYXV0aERvbWFpbixcbiAgICAgICAgZGF0YWJhc2VVUkw6IHRoaXMuZGF0YS5kYXRhYmFzZVVSTCxcbiAgICAgICAgcHJvamVjdElkOiB0aGlzLmRhdGEucHJvamVjdElkLFxuICAgICAgICBzdG9yYWdlQnVja2V0OiB0aGlzLmRhdGEuc3RvcmFnZUJ1Y2tldCxcbiAgICAgICAgbWVzc2FnaW5nU2VuZGVySWQ6IHRoaXMuZGF0YS5tZXNzYWdpbmdTZW5kZXJJZFxuICAgICAgfSk7XG4gICAgICB0aGlzLmZpcmVzdG9yZSA9IGZpcmViYXNlLmZpcmVzdG9yZSgpO1xuICAgICAgdGhpcy5maXJlc3RvcmUuc2V0dGluZ3Moe3RpbWVzdGFtcHNJblNuYXBzaG90czogdHJ1ZX0pO1xuICAgICAgdGhpcy5kYiA9IHRoaXMuZmlyZXN0b3JlLmNvbGxlY3Rpb24oJ3Njb3JlcycpO1xuICAgIH1cblxuICAgIGlmICghb2xkRGF0YS5pc1ZpY3RvcnkgJiYgdGhpcy5kYXRhLmlzVmljdG9yeSkge1xuICAgICAgdGhpcy5jaGVja0xlYWRlcmJvYXJkUXVhbGlmeSgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgJiZcbiAgICAgICAgb2xkRGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCAhPT0gdGhpcy5kYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkKSB7XG4gICAgICB0aGlzLmZldGNoU2NvcmVzKHRoaXMuZGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS5jaGFsbGVuZ2VJZCAmJiBvbGREYXRhLmNoYWxsZW5nZUlkICE9PSB0aGlzLmRhdGEuY2hhbGxlbmdlSWQpIHtcbiAgICAgIHRoaXMuZmV0Y2hTY29yZXModGhpcy5kYXRhLmNoYWxsZW5nZUlkKTtcbiAgICB9XG4gIH0sXG5cbiAgYWRkU2NvcmU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBzdGF0ZSA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlLnN0YXRlO1xuICAgIGlmICghc3RhdGUuaXNWaWN0b3J5KSB7IHJldHVybjsgfVxuICAgIGNvbnN0IHNjb3JlRGF0YSA9IHtcbiAgICAgIGFjY3VyYWN5OiBzdGF0ZS5zY29yZS5hY2N1cmFjeSxcbiAgICAgIGNoYWxsZW5nZUlkOiBzdGF0ZS5jaGFsbGVuZ2UuaWQsXG4gICAgICBzY29yZTogc3RhdGUuc2NvcmUuc2NvcmUsXG4gICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSxcbiAgICAgIGRpZmZpY3VsdHk6IHN0YXRlLmNoYWxsZW5nZS5kaWZmaWN1bHR5LFxuICAgICAgdGltZTogbmV3IERhdGUoKVxuICAgIH07XG4gICAgdGhpcy5kYi5hZGQoc2NvcmVEYXRhKTtcbiAgICB0aGlzLmFkZEV2ZW50RGV0YWlsLnNjb3JlRGF0YSA9IHNjb3JlRGF0YTtcbiAgICB0aGlzLmVsLmVtaXQoJ2xlYWRlcmJvYXJkc2NvcmVhZGRlZCcsIHRoaXMuYWRkRXZlbnREZXRhaWwsIGZhbHNlKTtcbiAgfSxcblxuICBmZXRjaFNjb3JlczogZnVuY3Rpb24gKGNoYWxsZW5nZUlkKSB7XG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZS5zdGF0ZTtcbiAgICBjb25zdCBxdWVyeSA9IHRoaXMuZGJcbiAgICAgIC53aGVyZSgnY2hhbGxlbmdlSWQnLCAnPT0nLCBjaGFsbGVuZ2VJZClcbiAgICAgIC53aGVyZShcbiAgICAgICAgJ2RpZmZpY3VsdHknLCAnPT0nLFxuICAgICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaWRcbiAgICAgICAgICA/IHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5kaWZmaWN1bHR5XG4gICAgICAgICAgOiBzdGF0ZS5jaGFsbGVuZ2UuZGlmZmljdWx0eSlcbiAgICAgIC5vcmRlckJ5KCdzY29yZScsICdkZXNjJylcbiAgICAgIC5vcmRlckJ5KCd0aW1lJywgJ2FzYycpXG4gICAgICAubGltaXQoMTApO1xuICAgIHF1ZXJ5LmdldCgpLnRoZW4oc25hcHNob3QgPT4ge1xuICAgICAgdGhpcy5ldmVudERldGFpbC5jaGFsbGVuZ2VJZCA9IGNoYWxsZW5nZUlkO1xuICAgICAgdGhpcy5zY29yZXMubGVuZ3RoID0gMDtcbiAgICAgIGlmICghc25hcHNob3QuZW1wdHkpIHtcbiAgICAgICAgc25hcHNob3QuZm9yRWFjaChzY29yZSA9PiB0aGlzLnNjb3Jlcy5wdXNoKHNjb3JlLmRhdGEoKSkpO1xuICAgICAgfVxuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ2xlYWRlcmJvYXJkJywgdGhpcy5ldmVudERldGFpbCwgZmFsc2UpO1xuICAgIH0pLmNhdGNoKGUgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcignW2ZpcmVzdG9yZV0nLCBlKTtcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogSXMgaGlnaCBzY29yZT9cbiAgICovXG4gIGNoZWNrTGVhZGVyYm9hcmRRdWFsaWZ5OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZS5zdGF0ZTtcbiAgICBjb25zdCBzY29yZSA9IHN0YXRlLnNjb3JlLnNjb3JlO1xuXG4gICAgLy8gSWYgbGVzcyB0aGFuIDEwLCB0aGVuIGF1dG9tYXRpYyBoaWdoIHNjb3JlLlxuICAgIGlmICh0aGlzLnNjb3Jlcy5sZW5ndGggPCBOVU1fU0NPUkVTX0RJU1BMQVlFRCkge1xuICAgICAgdGhpcy5xdWFsaWZ5aW5nSW5kZXggPSB0aGlzLnNjb3Jlcy5sZW5ndGg7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbGVhZGVyYm9hcmRxdWFsaWZ5JywgdGhpcy5zY29yZXMubGVuZ3RoLCBmYWxzZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgb3ZlcnRvb2sgYW55IGV4aXN0aW5nIGhpZ2ggc2NvcmUuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNjb3Jlcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHNjb3JlID4gdGhpcy5zY29yZXNbaV0uc2NvcmUpIHtcbiAgICAgICAgdGhpcy5xdWFsaWZ5aW5nSW5kZXggPSBpO1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbGVhZGVyYm9hcmRxdWFsaWZ5JywgaSwgZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2xlYWRlcmJvYXJkLmpzIiwidmFyIE9OQ0UgPSB7b25jZTogdHJ1ZX07XG5cbi8qKlxuICogRGVsYXkgbG9nbyBsaWdodCBzbyBpdCBvbmx5IGFwcGxpZXMgdG8gdGhlIGxvZ28uXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbG9nby1saWdodCcsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubG9nb0JhY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nb0JhY2snKTtcbiAgICB0aGlzLmxvZ29Gcm9udCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvRnJvbnQnKTtcbiAgICB0aGlzLmxvZ29Gcm9udFUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nb0Zyb250VScpO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdsaWdodCcsIHtcbiAgICAgICAgdHlwZTogJ3Nwb3QnLFxuICAgICAgICBwZW51bWJyYTogMSxcbiAgICAgICAgaW50ZW5zaXR5OiA1LFxuICAgICAgICBhbmdsZTogMjBcbiAgICAgIH0pO1xuICAgICAgdGhpcy53YWl0QW5kVXBkYXRlKHRoaXMubG9nb0JhY2spO1xuICAgICAgdGhpcy53YWl0QW5kVXBkYXRlKHRoaXMubG9nb0Zyb250KTtcbiAgICAgIHRoaXMud2FpdEFuZFVwZGF0ZSh0aGlzLmxvZ29Gcm9udFUpO1xuICAgIH0sIDEwMDApO1xuICB9LFxuXG4gIHdhaXRBbmRVcGRhdGU6IGZ1bmN0aW9uIChlbCkge1xuICAgIGlmIChlbC5nZXRPYmplY3QzRCgnbWVzaCcpKSB7XG4gICAgICBlbC5vYmplY3QzRC50cmF2ZXJzZSh0aGlzLnVwZGF0ZU1hdGVyaWFscyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vZGVsLWxvYWRlZCcsICgpID0+IHtcbiAgICAgICAgZWwub2JqZWN0M0QudHJhdmVyc2UodGhpcy51cGRhdGVNYXRlcmlhbHMpO1xuICAgICAgfSwgT05DRSk7XG4gICAgfVxuICB9LFxuXG4gIHVwZGF0ZU1hdGVyaWFsczogZnVuY3Rpb24gKG5vZGUpIHtcbiAgICBpZiAobm9kZS5tYXRlcmlhbCkge1xuICAgICAgbm9kZS5tYXRlcmlhbC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2xvZ28tbGlnaHQuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2xvZ29mbGlja2VyJywge1xuICBzY2hlbWE6IHtcbiAgICBkZWxheToge2RlZmF1bHQ6IDEwMDAuMH0sXG4gICAgYWN0aXZlOiB7ZGVmYXVsdDogdHJ1ZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zZXRPZmYgPSB0aGlzLnNldE9mZi5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc2V0T24gPSB0aGlzLnNldE9uLmJpbmQodGhpcyk7XG4gICAgdGhpcy50aW1lb3V0ID0gMDtcblxuICAgIHRoaXMuc3BhcmtzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ29zcGFya3MnKTtcbiAgICB0aGlzLnNwYXJrUG9zaXRpb25zID0gW1xuICAgICAge3Bvc2l0aW9uOiBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLjEwLCAwKX0sXG4gICAgICB7cG9zaXRpb246IG5ldyBUSFJFRS5WZWN0b3IzKDAuMywgMC44LCAwKX0sXG4gICAgICB7cG9zaXRpb246IG5ldyBUSFJFRS5WZWN0b3IzKC0wLjMsIDAuOCwgMCl9XG4gICAgXTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgaWYgKHRoaXMuZGF0YS5hY3RpdmUgIT09IG9sZERhdGEuYWN0aXZlKSB7XG4gICAgICBpZiAodGhpcy5kYXRhLmFjdGl2ZSkge1xuICAgICAgICB0aGlzLnNldE9uKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgc2V0T2ZmOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5zcGFya3MuZW1pdCgnbG9nb2ZsaWNrZXInLFxuICAgICAgdGhpcy5zcGFya1Bvc2l0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLnNwYXJrUG9zaXRpb25zLmxlbmd0aCldLFxuICAgICAgZmFsc2UpO1xuXG4gICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCh0aGlzLnNldE9uLCA1MCk7XG4gIH0sXG5cbiAgc2V0T246IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQodGhpcy5zZXRPZmYsXG4gICAgICAgICAgICAgICBNYXRoLmZsb29yKCh0aGlzLmRhdGEuZGVsYXkgKiAzIC8gMTApICsgTWF0aC5yYW5kb20oKSAqIHRoaXMuZGF0YS5kZWxheSkpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2xvZ29mbGlja2VyLmpzIiwiY29uc3QgQ09MT1JTID0gcmVxdWlyZSgnLi4vY29uc3RhbnRzL2NvbG9ycy5qcycpO1xuY29uc3QgZmxhdFNoYWRlcnMgPSByZXF1aXJlKCcuLi8uLi9hc3NldHMvc2hhZGVycy9mbGF0LmpzJyk7XG5jb25zdCBzdGFnZUFkZGl0aXZlU2hhZGVycyA9IHJlcXVpcmUoJy4uLy4uL2Fzc2V0cy9zaGFkZXJzL3N0YWdlQWRkaXRpdmUuanMnKTtcbmNvbnN0IHN0YWdlTm9ybWFsU2hhZGVycyA9IHJlcXVpcmUoJy4uLy4uL2Fzc2V0cy9zaGFkZXJzL3N0YWdlTm9ybWFsLmpzJyk7XG5cbkFGUkFNRS5yZWdpc3RlclN5c3RlbSgnbWF0ZXJpYWxzJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdsb2FkaW5nJykge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIHRoaXMuY3JlYXRlTWF0ZXJpYWxzLmJpbmQodGhpcykpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNyZWF0ZU1hdGVyaWFscygpO1xuICAgIH1cbiAgfSxcblxuICBjcmVhdGVNYXRlcmlhbHM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnN0YWdlTm9ybWFsID0gbmV3IFRIUkVFLlNoYWRlck1hdGVyaWFsKHtcbiAgICAgIHVuaWZvcm1zOiB7XG4gICAgICAgIHNreUNvbG9yOiB7dmFsdWU6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuU0tZX0JMVUUpfSxcbiAgICAgICAgYmFja2dsb3dDb2xvcjoge3ZhbHVlOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLkJHX0JMVUUpfSxcbiAgICAgICAgc3JjOiB7XG4gICAgICAgICAgdmFsdWU6IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXRsYXNJbWcnKS5zcmMpXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgdmVydGV4U2hhZGVyOiBzdGFnZU5vcm1hbFNoYWRlcnMudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IHN0YWdlTm9ybWFsU2hhZGVycy5mcmFnbWVudFNoYWRlcixcbiAgICAgIGZvZzogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5zdGFnZUFkZGl0aXZlID0gbmV3IFRIUkVFLlNoYWRlck1hdGVyaWFsKHtcbiAgICAgIHVuaWZvcm1zOiB7XG4gICAgICAgIHR1bm5lbE5lb246IHt2YWx1ZTogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5ORU9OX1JFRCl9LFxuICAgICAgICBmbG9vck5lb246IHt2YWx1ZTogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5ORU9OX1JFRCl9LFxuICAgICAgICBsZWZ0TGFzZXI6IHt2YWx1ZTogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5ORU9OX0JMVUUpfSxcbiAgICAgICAgcmlnaHRMYXNlcjoge3ZhbHVlOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk5FT05fQkxVRSl9LFxuICAgICAgICB0ZXh0R2xvdzoge3ZhbHVlOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLlRFWFRfT0ZGKX0sXG4gICAgICAgIHNyYzoge1xuICAgICAgICAgIHZhbHVlOiBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F0bGFzSW1nJykuc3JjKVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHZlcnRleFNoYWRlcjogc3RhZ2VBZGRpdGl2ZVNoYWRlcnMudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IHN0YWdlQWRkaXRpdmVTaGFkZXJzLmZyYWdtZW50U2hhZGVyLFxuICAgICAgYmxlbmRpbmc6IFRIUkVFLkFkZGl0aXZlQmxlbmRpbmcsXG4gICAgICBmb2c6IGZhbHNlLFxuICAgICAgdHJhbnNwYXJlbnQ6IHRydWVcbiAgICB9KTtcblxuICAgIHRoaXMubG9nbyA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCh7XG4gICAgICB1bmlmb3Jtczoge1xuICAgICAgICBzcmM6IHtcbiAgICAgICAgICB2YWx1ZTogbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvdGV4SW1nJykuc3JjKVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHZlcnRleFNoYWRlcjogZmxhdFNoYWRlcnMudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IGZsYXRTaGFkZXJzLmZyYWdtZW50U2hhZGVyLFxuICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgIGZvZzogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5sb2dvYWRkaXRpdmUgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoe1xuICAgICAgdW5pZm9ybXM6IHtcbiAgICAgICAgc3JjOiB7XG4gICAgICAgICAgdmFsdWU6IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nb3RleEltZycpLnNyYylcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB2ZXJ0ZXhTaGFkZXI6IGZsYXRTaGFkZXJzLnZlcnRleFNoYWRlcixcbiAgICAgIGZyYWdtZW50U2hhZGVyOiBmbGF0U2hhZGVycy5mcmFnbWVudFNoYWRlcixcbiAgICAgIGRlcHRoVGVzdDogZmFsc2UsXG4gICAgICBibGVuZGluZzogVEhSRUUuQWRkaXRpdmVCbGVuZGluZyxcbiAgICAgIGZvZzogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5taW5lTWF0ZXJpYWxyZWQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoe1xuICAgICAgcm91Z2huZXNzOiAwLjM4LFxuICAgICAgbWV0YWxuZXNzOiAwLjQ4LFxuICAgICAgY29sb3I6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuTUlORV9SRUQpLFxuICAgICAgZW1pc3NpdmU6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuTUlORV9SRURfRU1JU1NJT04pLFxuICAgICAgZW52TWFwOiBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoJ2Fzc2V0cy9pbWcvbWluZWVudmlyby1yZWQuanBnJylcbiAgICB9KTtcblxuICAgIHRoaXMubWluZU1hdGVyaWFsYmx1ZSA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7XG4gICAgICByb3VnaG5lc3M6IDAuMzgsXG4gICAgICBtZXRhbG5lc3M6IDAuNDgsXG4gICAgICBjb2xvcjogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5NSU5FX0JMVUUpLFxuICAgICAgZW1pc3NpdmU6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuTUlORV9CTFVFX0VNSVNTSU9OKSxcbiAgICAgIGVudk1hcDogbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKCdhc3NldHMvaW1nL21pbmVlbnZpcm8tYmx1ZS5qcGcnKVxuICAgIH0pO1xuXG4gIH1cbn0pO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ21hdGVyaWFscycsIHtcbiAgc2NoZW1hOiB7XG4gICAgbmFtZTogeyBkZWZhdWx0OiAnJ30sXG4gICAgcmVjdXJzaXZlOiB7IGRlZmF1bHQ6IHRydWV9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuZGF0YS5uYW1lID09PSAnJykgeyByZXR1cm47IH1cblxuICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5zeXN0ZW1bdGhpcy5kYXRhLm5hbWVdO1xuICAgIGlmICghbWF0ZXJpYWwpIHtcbiAgICAgIGNvbnNvbGUud2FybihgdW5kZWZpbmVkIG1hdGVyaWFsIFwiJHt0aGlzLnN5c3RlbVt0aGlzLmRhdGEubmFtZV19XCJgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBtZXNoID0gdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpO1xuICAgIGlmICghbWVzaCkge1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb2RlbC1sb2FkZWQnLCB0aGlzLmFwcGx5TWF0ZXJpYWwuYmluZCh0aGlzKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYXBwbHlNYXRlcmlhbChtZXNoKTtcbiAgICB9XG4gIH0sXG5cbiAgYXBwbHlNYXRlcmlhbDogZnVuY3Rpb24gKG9iaikge1xuICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5zeXN0ZW1bdGhpcy5kYXRhLm5hbWVdO1xuICAgIGlmIChvYmpbJ2RldGFpbCddKSB7IG9iaiA9IG9iai5kZXRhaWwubW9kZWw7IH1cbiAgICBpZiAodGhpcy5kYXRhLnJlY3Vyc2l2ZSkge1xuICAgICAgb2JqLnRyYXZlcnNlKG8gPT4ge1xuICAgICAgICBpZiAoby50eXBlID09PSAnTWVzaCcpIHtcbiAgICAgICAgICBvLm1hdGVyaWFsID0gbWF0ZXJpYWw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBvYmoubWF0ZXJpYWwgPSBtYXRlcmlhbDtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbWF0ZXJpYWxzLmpzIiwidmFyIGhvdmVyZWRJbmRleDtcbnZhciBrZXlFdmVudHNSZWdpc3RlcmVkID0gZmFsc2U7XG52YXIgcmVzdWx0cyA9IG51bGw7XG5cbmNvbnN0IFBFUl9QQUdFID0gNjtcblxuLyoqXG4gKiBVc2UgbWVudSB3aXRoIHRodW1iLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ21lbnUtY29udHJvbHMnLCB7XG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBwYWdlOiB7ZGVmYXVsdDogMH0sXG4gICAgc2VsZWN0ZWRDaGFsbGVuZ2VJZDoge2RlZmF1bHQ6ICcnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG5cbiAgICByZXN1bHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaFJlc3VsdExpc3QnKS5jaGlsZHJlbjtcblxuICAgIHRoaXMuZ29QcmV2UmVzdWx0ID0gdGhpcy5nb1ByZXZSZXN1bHQuYmluZCh0aGlzKTtcbiAgICB0aGlzLmdvTmV4dFJlc3VsdCA9IHRoaXMuZ29OZXh0UmVzdWx0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZWxlY3QgPSB0aGlzLnNlbGVjdC5iaW5kKHRoaXMpO1xuICAgIHRoaXMudW5zZWxlY3QgPSB0aGlzLnVuc2VsZWN0LmJpbmQodGhpcyk7XG5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0aHVtYnVwc3RhcnQnLCB0aGlzLmdvUHJldlJlc3VsdCk7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigndGh1bWJkb3duc3RhcnQnLCB0aGlzLmdvTmV4dFJlc3VsdCk7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigndGh1bWJsZWZ0c3RhcnQnLCB0aGlzLnVuc2VsZWN0KTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0aHVtYnJpZ2h0c3RhcnQnLCB0aGlzLnNlbGVjdCk7XG5cbiAgICAvLyBXaGVuIHJheWNhc3RlciBiZWNvbWVzIGFjdGl2ZSBhZ2FpbiwgY2FuY2VsLlxuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBldnQgPT4ge1xuICAgICAgaWYgKCFlbC5jb21wb25lbnRzLmN1cnNvci5pbnRlcnNlY3RlZEVsKSB7IHJldHVybjsgfVxuICAgICAgaWYgKGVsLmNvbXBvbmVudHMuY3Vyc29yLmludGVyc2VjdGVkRWwuY2xvc2VzdCgnI3NlYXJjaFJlc3VsdExpc3QnKSkge1xuICAgICAgICB0aGlzLmNhbmNlbE1lbnVDb250cm9scygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2RlYnVnJykgJiYgIWtleUV2ZW50c1JlZ2lzdGVyZWQpIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXZ0ID0+IHtcbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSAzNykgeyB0aGlzLnVuc2VsZWN0KCk7IH1cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSAzOCkgeyB0aGlzLmdvUHJldlJlc3VsdCgpOyB9XG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gMzkpIHsgdGhpcy5zZWxlY3QoKTsgfVxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDQwKSB7IHRoaXMuZ29OZXh0UmVzdWx0KCk7IH1cbiAgICAgIH0pO1xuICAgICAga2V5RXZlbnRzUmVnaXN0ZXJlZCA9IHRydWU7XG4gICAgfVxuICB9LFxuXG4gIGdvUHJldlJlc3VsdDogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG5cbiAgICBpZiAoaG92ZXJlZEluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuaG92ZXJSZXN1bHQoMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChob3ZlcmVkSW5kZXggPiAwKSB7XG4gICAgICBpZiAocmVzdWx0c1tob3ZlcmVkSW5kZXggLSAxXS5kYXRhc2V0LmlkID09PSB0aGlzLmRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCkge1xuICAgICAgICBpZiAoaG92ZXJlZEluZGV4IC0gMiA8IDApIHtcbiAgICAgICAgICB0aGlzLmdvUHJldlBhZ2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmhvdmVyUmVzdWx0KGhvdmVyZWRJbmRleCAtIDIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhvdmVyUmVzdWx0KGhvdmVyZWRJbmRleCAtIDEpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmdvUHJldlBhZ2UoKTtcbiAgICB9XG4gIH0sXG5cbiAgZ29QcmV2UGFnZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaG92ZXJSZXN1bHQoUEVSX1BBR0UgLSAxKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc2VhcmNocHJldnBhZ2UnLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgZ29OZXh0UmVzdWx0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cblxuICAgIGlmIChob3ZlcmVkSW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ob3ZlclJlc3VsdCgwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGhvdmVyZWRJbmRleCA8IFBFUl9QQUdFIC0gMSkge1xuICAgICAgaWYgKHJlc3VsdHNbaG92ZXJlZEluZGV4ICsgMV0uZGF0YXNldC5pZCA9PT0gdGhpcy5kYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQpIHtcbiAgICAgICAgaWYgKGhvdmVyZWRJbmRleCArIDIgPiBQRVJfUEFHRSAtIDEpIHtcbiAgICAgICAgICB0aGlzLmdvTmV4dFBhZ2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmhvdmVyUmVzdWx0KGhvdmVyZWRJbmRleCArIDIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhvdmVyUmVzdWx0KGhvdmVyZWRJbmRleCArIDEpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmdvTmV4dFBhZ2UoKTtcbiAgICB9XG4gIH0sXG5cbiAgZ29OZXh0UGFnZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaG92ZXJSZXN1bHQoMCk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3NlYXJjaG5leHRwYWdlJywgbnVsbCwgZmFsc2UpO1xuICB9LFxuXG4gIHNlbGVjdDogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgaWYgKGhvdmVyZWRJbmRleCA9PT0gdW5kZWZpbmVkKSB7IHJldHVybjsgfVxuICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdtZW51Y2hhbGxlbmdlc2VsZWN0JywgcmVzdWx0c1tob3ZlcmVkSW5kZXhdLmRhdGFzZXQuaWQsIGZhbHNlKTtcbiAgfSxcblxuICB1bnNlbGVjdDogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgaWYgKHRoaXMuZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkKSB7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbWVudWNoYWxsZW5nZXVuc2VsZWN0JywgbnVsbCwgZmFsc2UpO1xuICAgIH1cbiAgfSxcblxuICBob3ZlclJlc3VsdDogZnVuY3Rpb24gKGkpIHtcbiAgICBpZiAoaG92ZXJlZEluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJlc3VsdHNbaG92ZXJlZEluZGV4XS5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoUmVzdWx0QmFja2dyb3VuZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAuZW1pdCgnbW91c2VsZWF2ZScsIG51bGwsIGZhbHNlKTtcbiAgICB9XG4gICAgaG92ZXJlZEluZGV4ID0gaTtcbiAgICByZXN1bHRzW2ldLnF1ZXJ5U2VsZWN0b3IoJy5zZWFyY2hSZXN1bHRCYWNrZ3JvdW5kJylcbiAgICAgICAgICAgICAgLmVtaXQoJ21vdXNlZW50ZXInLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgY2FuY2VsTWVudUNvbnRyb2xzOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGhvdmVyZWRJbmRleCA9PT0gdW5kZWZpbmVkKSB7IHJldHVybjsgfVxuICAgIHJlc3VsdHNbaG92ZXJlZEluZGV4XS5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoUmVzdWx0QmFja2dyb3VuZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgLmVtaXQoJ21vdXNlbGVhdmUnLCBudWxsLCBmYWxzZSk7XG4gICAgaG92ZXJlZEluZGV4ID0gdW5kZWZpbmVkO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL21lbnUtY29udHJvbHMuanMiLCJ2YXIgYmluZEV2ZW50ID0gcmVxdWlyZSgnYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMnKS5iaW5kRXZlbnQ7XG5cbi8qKlxuICogU2VsZWN0IGRpZmZpY3VsdHkuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbWVudS1kaWZmaWN1bHR5LXNlbGVjdCcsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuc2NlbmVFbC5hZGRFdmVudExpc3RlbmVyKCdtZW51Y2hhbGxlbmdlc2VsZWN0JywgKCkgPT4ge1xuICAgICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5lbC5jb21wb25lbnRzLmxheW91dC51cGRhdGUoKTtcbiAgICAgICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICAgIH0sIDE1MCk7XG4gICAgfSk7XG4gIH0sXG5cbiAgY2xpY2s6IGJpbmRFdmVudChmdW5jdGlvbiAoZXZ0KSB7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoXG4gICAgICAnbWVudWRpZmZpY3VsdHlzZWxlY3QnLFxuICAgICAgZXZ0LnRhcmdldC5jbG9zZXN0KCcuZGlmZmljdWx0eU9wdGlvbicpLmRhdGFzZXQuZGlmZmljdWx0eSxcbiAgICAgIGZhbHNlKTtcbiAgfSlcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbWVudS1kaWZmaWN1bHR5LXNlbGVjdC5qcyIsImltcG9ydCB1dGlscyBmcm9tICcuLi91dGlscyc7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbWVudS1zZWxlY3RlZC1jaGFsbGVuZ2UtaW1hZ2UnLCB7XG4gIHNjaGVtYToge1xuICAgIHNlbGVjdGVkQ2hhbGxlbmdlSWQ6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG4gICAgaWYgKCF0aGlzLmRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCkgeyByZXR1cm47IH1cbiAgICBlbC5zZXRBdHRyaWJ1dGUoXG4gICAgICAnbWF0ZXJpYWwnLCAnc3JjJyxcbiAgICAgIHV0aWxzLmdldFMzRmlsZVVybCh0aGlzLmRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCwgJ2ltYWdlLmpwZycpKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9tZW51LXNlbGVjdGVkLWNoYWxsZW5nZS1pbWFnZS5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbWVudS1zbGlkZS1hbmltYXRpb24nLCB7XG4gIHNjaGVtYToge1xuICAgIGlzU2VhcmNoaW5nOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIG1lbnVTZWxlY3RlZENoYWxsZW5nZUlkOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNMZWZ0ID0gZmFsc2U7ICAvLyBNZWFucyB0b2xlZnQuXG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICBpZiAodGhpcy5pc0xlZnQpIHtcbiAgICAgIC8vIFVuc2VsZWN0LlxuICAgICAgaWYgKG9sZERhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgJiYgIWRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgJiZcbiAgICAgICAgICAhZGF0YS5pc1NlYXJjaGluZykgeyB0aGlzLnJpZ2h0TWVudSgpOyB9XG4gICAgICAvLyBLZXlib2FyZCBjbG9zZS5cbiAgICAgIGlmIChvbGREYXRhLmlzU2VhcmNoaW5nICYmICFkYXRhLmlzU2VhcmNoaW5nICYmICFkYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkKSB7XG4gICAgICAgIHRoaXMucmlnaHRNZW51KCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmlzTGVmdCkge1xuICAgICAgLy8gU2VsZWN0LlxuICAgICAgaWYgKCFvbGREYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkICYmIGRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQpIHsgdGhpcy5sZWZ0TWVudSgpOyB9XG4gICAgICAvLyBLZXlib2FyZCBvcGVuLlxuICAgICAgaWYgKCFvbGREYXRhLmlzU2VhcmNoaW5nICYmIGRhdGEuaXNTZWFyY2hpbmcpIHsgdGhpcy5sZWZ0TWVudSgpOyB9XG4gICAgfVxuICB9LFxuXG4gIHJpZ2h0TWVudTogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5pc0xlZnQpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5jb21wb25lbnRzLmFuaW1hdGlvbl9fbWVudXJpZ2h0LmJlZ2luQW5pbWF0aW9uKCk7XG4gICAgdGhpcy5pc0xlZnQgPSBmYWxzZTtcbiAgfSxcblxuICBsZWZ0TWVudTogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmlzTGVmdCkgeyByZXR1cm47IH1cbiAgICB0aGlzLmVsLmNvbXBvbmVudHMuYW5pbWF0aW9uX19tZW51bGVmdC5iZWdpbkFuaW1hdGlvbigpO1xuICAgIHRoaXMuaXNMZWZ0ID0gdHJ1ZTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9tZW51LXNsaWRlLWFuaW1hdGlvbi5qcyIsImNvbnN0IG9iakxvYWRlciA9IG5ldyBUSFJFRS5PQkpMb2FkZXIoKTtcblxuQUZSQU1FLnJlZ2lzdGVyU3lzdGVtKCdtaW5lLWZyYWdtZW50cy1sb2FkZXInLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZyYWdtZW50cyA9IG51bGw7XG4gICAgY29uc3Qgb2JqRGF0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaW5lQnJva2VuT2JqJyk7XG4gICAgb2JqRGF0YS5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWQnLCBldnQgPT4ge1xuICAgICAgdGhpcy5mcmFnbWVudHMgPSBvYmpMb2FkZXIucGFyc2UoZXZ0LnRhcmdldC5kYXRhKTtcbiAgICB9KVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL21pbmUtZnJhZ21lbnRzLWxvYWRlci5qcyIsImNvbnN0IENPTUJPX1BST0dSRVNTX01BUCA9IHtcbiAgMDogMCxcbiAgMTogMC41LFxuICAyOiAwLFxuICAzOiAwLjI1LFxuICA0OiAwLjUsXG4gIDU6IDAuNzUsXG4gIDY6IDAsXG4gIDc6IDAuMTI1LFxuICA4OiAwLjI1LFxuICA5OiAwLjM3NSxcbiAgMTA6IDAuNSxcbiAgMTE6IDAuNjI1LFxuICAxMjogMC43NSxcbiAgMTM6IDAuODc1XG59O1xuXG4vKlxuICogQ29tYm8gbmVlZGVkIHRvdGFsIGZvciBtdWx0aXBsaWVyIGxldmVsOlxuICpcbiAqIDAgLSAxeFxuICogMiAtIDJ4XG4gKiA2IC0gNHhcbiAqIDE0IC0gOHhcbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdtdWx0aXBsaWVyLXJpbmcnLCB7XG4gIGRlcGVuZGVuY2llczogWydnZW9tZXRyeScsICdtYXRlcmlhbCddLFxuXG4gIHNjaGVtYToge1xuICAgIGNvbWJvOiB7ZGVmYXVsdDogMH0sXG4gICAgbXVsdGlwbGllcjoge2RlZmF1bHQ6IDF9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYW5pbWF0aW9uU2V0ID0ge2Zyb206IHVuZGVmaW5lZCwgdG86IHVuZGVmaW5lZH07XG4gICAgdGhpcy5wcm9ncmVzcyA9IHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC51bmlmb3Jtcy5wcm9ncmVzcztcblxuICAgIC8vIFNldCB1cCBhbmltYXRpb24uXG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ2FuaW1hdGlvbicsIHtcbiAgICAgIHByb3BlcnR5OiAnY29tcG9uZW50cy5tYXRlcmlhbC5tYXRlcmlhbC51bmlmb3Jtcy5wcm9ncmVzcy52YWx1ZScsXG4gICAgICBkdXI6IDEwMCxcbiAgICAgIGF1dG9wbGF5OiBmYWxzZVxuICAgIH0pO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMudXBkYXRlUmluZygpO1xuICB9LFxuXG4gIHVwZGF0ZVJpbmc6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcbiAgICBjb25zdCBwcm9ncmVzcyA9IHRoaXMucHJvZ3Jlc3M7XG5cbiAgICBpZiAoZGF0YS5tdWx0aXBsaWVyID09PSA4KSB7XG4gICAgICBwcm9ncmVzcy52YWx1ZSA9IDE7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgYW5pbWF0aW9uU2V0ID0gdGhpcy5hbmltYXRpb25TZXQ7XG4gICAgYW5pbWF0aW9uU2V0LmZyb20gPSBwcm9ncmVzcy52YWx1ZTtcbiAgICBhbmltYXRpb25TZXQudG8gPSBDT01CT19QUk9HUkVTU19NQVBbZGF0YS5jb21ib107XG4gICAgZWwuc2V0QXR0cmlidXRlKCdhbmltYXRpb24nLCBhbmltYXRpb25TZXQpO1xuICAgIGVsLmNvbXBvbmVudHMuYW5pbWF0aW9uLmJlZ2luQW5pbWF0aW9uKCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbXVsdGlwbGllci1yaW5nLmpzIiwiY29uc3QgTlVNX1BMQU5FX1BPU0lUSU9OUyA9IDEyO1xuXG5jb25zdCBCTEVORElOR1MgPSB7XG4gIG5vcm1hbDogVEhSRUUuTm9ybWFsQmxlbmRpbmcsXG4gIGFkZGl0aXZlOiBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nLFxuICBzdWJzdHJhY3RpdmU6IFRIUkVFLlN1YnN0cmFjdGl2ZUJsZW5kaW5nLFxuICBtdWx0aXBseTogVEhSRUUuTXVsdGlwbHlCbGVuZGluZ1xufTtcblxuY29uc3QgU0hBREVSUyA9IHtcbiAgZmxhdDogVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwsXG4gIGxhbWJlcnQ6IFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwsXG4gIHBob25nOiBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCxcbiAgc3RhbmRhcmQ6IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsXG59O1xuXG5jb25zdCBPRkZTQ1JFRU5fVkVDMyA9IG5ldyBUSFJFRS5WZWN0b3IzKC05OTk5OSwgLTk5OTk5LCAtOTk5OTkpO1xuXG4vKipcbiAqIFBhcnRpY2xlIFBsYXllciBjb21wb25lbnQgZm9yIEEtRnJhbWUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgncGFydGljbGVwbGF5ZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGJsZW5kaW5nOiB7XG4gICAgICBkZWZhdWx0OiAnYWRkaXRpdmUnLFxuICAgICAgb25lT2Y6IFsnbm9ybWFsJywgJ2FkZGl0aXZlJywgJ211bHRpcGx5JywgJ3N1YnN0cmFjdGl2ZSddXG4gICAgfSxcbiAgICBjb2xvcjoge2RlZmF1bHQ6ICcjZmZmJywgdHlwZTogJ2NvbG9yJ30sXG4gICAgY291bnQ6IHtkZWZhdWx0OiAnMTAwJSd9LFxuICAgIGRlbGF5OiB7ZGVmYXVsdDogMCwgdHlwZTogJ2ludCd9LFxuICAgIGR1cjoge2RlZmF1bHQ6IDEwMDAsIHR5cGU6ICdpbnQnfSxcbiAgICBpbWc6IHt0eXBlOiAnc2VsZWN0b3InfSxcbiAgICBpbnRlcnBvbGF0ZToge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBsb29wOiB7ZGVmYXVsdDogJ2ZhbHNlJ30sXG4gICAgb246IHtkZWZhdWx0OiAnaW5pdCd9LFxuICAgIHBvb2xTaXplOiB7ZGVmYXVsdDogNSwgdHlwZTogJ2ludCd9LCAvLyBudW1iZXIgb2Ygc2ltdWx0YW5lb3VzIHBhcnRpY2xlIHN5c3RlbXNcbiAgICBwcm90YXRpb246IHt0eXBlOiAndmVjMyd9LFxuICAgIHBzY2FsZToge2RlZmF1bHQ6IDEuMCwgdHlwZTogJ2Zsb2F0J30sXG4gICAgc2NhbGU6IHtkZWZhdWx0OiAxLjAsIHR5cGU6ICdmbG9hdCd9LFxuICAgIGluaXRpYWxTY2FsZToge3R5cGU6ICd2ZWMzJ30sXG4gICAgZmluYWxTY2FsZToge3R5cGU6ICd2ZWMzJ30sXG4gICAgYW5pbWF0ZVNjYWxlOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHNoYWRlcjoge1xuICAgICAgZGVmYXVsdDogJ2ZsYXQnLFxuICAgICAgb25lT2Y6IFsnZmxhdCcsICdsYW1iZXJ0JywgJ3Bob25nJywgJ3N0YW5kYXJkJ11cbiAgICB9LFxuICAgIHNyYzoge3R5cGU6ICdzZWxlY3Rvcid9XG4gIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnJhbWUgPSAwO1xuICAgIHRoaXMuZnJhbWVkYXRhID0gbnVsbDtcbiAgICB0aGlzLmluZGV4UG9vbCA9IG51bGw7XG4gICAgdGhpcy5sYXN0RnJhbWUgPSAwO1xuICAgIHRoaXMubWF0ZXJpYWwgPSBudWxsO1xuICAgIHRoaXMubXNQZXJGcmFtZSA9IDA7XG4gICAgdGhpcy5udW1GcmFtZXMgPSAwO1xuICAgIHRoaXMubnVtUGFydGljbGVzID0gMDsgLy8gdG90YWwgbnVtYmVyIG9mIHBhcnRpY2xlcyBwZXIgc3lzdGVtXG4gICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyA9IFtdO1xuICAgIHRoaXMucGFydGljbGVDb3VudCA9IDA7IC8vIGFjdHVhbCBudW1iZXIgb2YgcGFydGljbGVzIHRvIHNwYXduIHBlciBldmVudCAoZGF0YS5jb3VudClcbiAgICB0aGlzLnBhcnRpY2xlU3lzdGVtcyA9IFtdO1xuICAgIHRoaXMucHJvdGF0aW9uID0gZmFsc2U7XG4gICAgdGhpcy5yZXN0UG9zaXRpb25zID0gW107IC8vIHBvc2l0aW9uIGF0IGZpcnN0IGZyYW1lIGVhY2ggcGFydGljbGUgaXMgYWxpdmVcbiAgICB0aGlzLnJlc3RSb3RhdGlvbnMgPSBbXTtcbiAgICB0aGlzLnNwcml0ZV9yb3RhdGlvbiA9IGZhbHNlO1xuICAgIHRoaXMuc3lzdGVtcyA9IG51bGw7XG4gICAgdGhpcy51c2VSb3RhdGlvbiA9IGZhbHNlO1xuICAgIHRoaXMudXNlQWdlID0gZmFsc2U7XG4gICAgdGhpcy5zY2FsZUFuaW0gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMucGFydFNjYWxlID0gbmV3IFRIUkVFLlZlY3RvcjMoMS4wLCAxLjAsIDEuMCk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICBpZiAoIWRhdGEuc3JjKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG9sZERhdGEub24gIT09IGRhdGEub24pIHtcbiAgICAgIGlmIChvbGREYXRhLm9uKSB7XG4gICAgICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihvbGREYXRhLm9uLCB0aGlzLnN0YXJ0KTtcbiAgICAgIH1cbiAgICAgIGlmIChkYXRhLm9uICE9PSAncGxheScpIHtcbiAgICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKGRhdGEub24sIHRoaXMuc3RhcnQuYmluZCh0aGlzKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5wYXJ0U2NhbGUuc2V0KDEuMCwgMS4wLCAxLjApO1xuXG4gICAgdGhpcy5sb2FkUGFydGljbGVzSlNPTihkYXRhLnNyYywgZGF0YS5zY2FsZSk7XG5cbiAgICB0aGlzLm51bUZyYW1lcyA9IHRoaXMuZnJhbWVkYXRhLmxlbmd0aDtcbiAgICB0aGlzLm51bVBhcnRpY2xlcyA9IHRoaXMubnVtRnJhbWVzID4gMCA/IHRoaXMuZnJhbWVkYXRhWzBdLmxlbmd0aCA6IDA7XG5cbiAgICBpZiAoZGF0YS5jb3VudFtkYXRhLmNvdW50Lmxlbmd0aCAtIDFdID09PSAnJScpIHtcbiAgICAgIHRoaXMucGFydGljbGVDb3VudCA9IE1hdGguZmxvb3IoXG4gICAgICAgIChwYXJzZUludChkYXRhLmNvdW50KSAqIHRoaXMubnVtUGFydGljbGVzKSAvIDEwMC4wXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnBhcnRpY2xlQ291bnQgPSBwYXJzZUludChkYXRhLmNvdW50KTtcbiAgICB9XG4gICAgdGhpcy5wYXJ0aWNsZUNvdW50ID0gTWF0aC5taW4oXG4gICAgICB0aGlzLm51bVBhcnRpY2xlcyxcbiAgICAgIE1hdGgubWF4KDAsIHRoaXMucGFydGljbGVDb3VudClcbiAgICApO1xuXG4gICAgdGhpcy5tc1BlckZyYW1lID0gZGF0YS5kdXIgLyB0aGlzLm51bUZyYW1lcztcblxuICAgIHRoaXMuaW5kZXhQb29sID0gbmV3IEFycmF5KHRoaXMubnVtUGFydGljbGVzKTtcblxuICAgIGNvbnN0IG1hdGVyaWFsUGFyYW1zID0ge1xuICAgICAgY29sb3I6IG5ldyBUSFJFRS5Db2xvcihkYXRhLmNvbG9yKSxcbiAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsXG4gICAgICBibGVuZGluZzogQkxFTkRJTkdTW2RhdGEuYmxlbmRpbmddLFxuICAgICAgbWFwOiBkYXRhLmltZyA/IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZChkYXRhLmltZy5zcmMpIDogbnVsbCxcbiAgICAgIGRlcHRoV3JpdGU6IGZhbHNlLFxuICAgICAgb3BhY2l0eTogZGF0YS5vcGFjaXR5LFxuICAgICAgdHJhbnNwYXJlbnQ6ICEhZGF0YS5pbWcgfHwgZGF0YS5ibGVuZGluZyAhPT0gJ25vcm1hbCcgfHwgZGF0YS5vcGFjaXR5IDwgMVxuICAgIH07XG4gICAgaWYgKFNIQURFUlNbZGF0YS5zaGFkZXJdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMubWF0ZXJpYWwgPSBuZXcgU0hBREVSU1tkYXRhLnNoYWRlcl0obWF0ZXJpYWxQYXJhbXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1hdGVyaWFsID0gbmV3IFNIQURFUlNbJ2ZsYXQnXShtYXRlcmlhbFBhcmFtcyk7XG4gICAgfVxuXG4gICAgdGhpcy5jcmVhdGVQYXJ0aWNsZXMoZGF0YS5wb29sU2l6ZSk7XG5cbiAgICBpZiAoZGF0YS5vbiA9PT0gJ2luaXQnKSB7XG4gICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgfVxuICB9LFxuXG4gIGxvYWRQYXJ0aWNsZXNKU09OOiBmdW5jdGlvbiAoanNvbiwgc2NhbGUpIHtcbiAgICB2YXIgYWxpdmU7XG5cbiAgICB0aGlzLnJlc3RQb3NpdGlvbnMubGVuZ3RoID0gMDtcbiAgICB0aGlzLnJlc3RSb3RhdGlvbnMubGVuZ3RoID0gMDtcblxuICAgIGNvbnN0IGpzb25EYXRhID0gSlNPTi5wYXJzZShqc29uLmRhdGEpO1xuICAgIGNvbnN0IGZyYW1lcyA9IGpzb25EYXRhLmZyYW1lcztcbiAgICBjb25zdCBwcmVjaXNpb24gPSBqc29uRGF0YS5wcmVjaXNpb247XG5cbiAgICB0aGlzLnVzZVJvdGF0aW9uID0ganNvbkRhdGEucm90YXRpb247XG4gICAgdGhpcy51c2VBZ2UgPSBqc29uRGF0YVsnYWdlJ10gIT09IHVuZGVmaW5lZCA/IGpzb25EYXRhLmFnZSA6IGZhbHNlO1xuXG4gICAgaWYgKGpzb25EYXRhLnNwcml0ZV9yb3RhdGlvbiAhPT0gZmFsc2UpIHtcbiAgICAgIHRoaXMuc3ByaXRlX3JvdGF0aW9uID0ge1xuICAgICAgICB4OiBqc29uRGF0YS5zcHJpdGVfcm90YXRpb25bMF0gLyBwcmVjaXNpb24sXG4gICAgICAgIHk6IGpzb25EYXRhLnNwcml0ZV9yb3RhdGlvblsxXSAvIHByZWNpc2lvbixcbiAgICAgICAgejoganNvbkRhdGEuc3ByaXRlX3JvdGF0aW9uWzJdIC8gcHJlY2lzaW9uXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNwcml0ZV9yb3RhdGlvbiA9IGZhbHNlO1xuICAgIH1cblxuICAgIHRoaXMuZnJhbWVkYXRhID0gbmV3IEFycmF5KGZyYW1lcy5sZW5ndGgpO1xuICAgIGZvciAobGV0IGZyYW1lSW5kZXggPSAwOyBmcmFtZUluZGV4IDwgZnJhbWVzLmxlbmd0aDsgZnJhbWVJbmRleCsrKSB7XG4gICAgICB0aGlzLmZyYW1lZGF0YVtmcmFtZUluZGV4XSA9IG5ldyBBcnJheShmcmFtZXNbZnJhbWVJbmRleF0ubGVuZ3RoKTtcbiAgICAgIGZvciAoXG4gICAgICAgIGxldCBwYXJ0aWNsZUluZGV4ID0gMDtcbiAgICAgICAgcGFydGljbGVJbmRleCA8IGZyYW1lc1tmcmFtZUluZGV4XS5sZW5ndGg7XG4gICAgICAgIHBhcnRpY2xlSW5kZXgrK1xuICAgICAgKSB7XG4gICAgICAgIGxldCByYXdQID0gZnJhbWVzW2ZyYW1lSW5kZXhdW3BhcnRpY2xlSW5kZXhdOyAvLyBkYXRhIG9mIHBhcnRpY2xlIGkgaW4gZnJhbWUgZlxuICAgICAgICBhbGl2ZSA9IHJhd1AgIT09IDA7IC8vIDAgbWVhbnMgbm90IGFsaXZlIHlldCB0aGlzIGZyYW1lLlxuXG4gICAgICAgIGxldCBwID0gKHRoaXMuZnJhbWVkYXRhW2ZyYW1lSW5kZXhdW3BhcnRpY2xlSW5kZXhdID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBhbGl2ZVxuICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIHg6IChyYXdQWzBdIC8gcHJlY2lzaW9uKSAqIHNjYWxlLFxuICAgICAgICAgICAgICB5OiAocmF3UFsxXSAvIHByZWNpc2lvbikgKiBzY2FsZSxcbiAgICAgICAgICAgICAgejogKHJhd1BbMl0gLyBwcmVjaXNpb24pICogc2NhbGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgICBhbGl2ZTogYWxpdmVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMudXNlUm90YXRpb24pIHtcbiAgICAgICAgICBwLnJvdGF0aW9uID0gYWxpdmVcbiAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICB4OiByYXdQWzNdIC8gcHJlY2lzaW9uLFxuICAgICAgICAgICAgICB5OiByYXdQWzRdIC8gcHJlY2lzaW9uLFxuICAgICAgICAgICAgICB6OiByYXdQWzVdIC8gcHJlY2lzaW9uXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy51c2VBZ2UpIHtcbiAgICAgICAgICBwLmFnZSA9IGFsaXZlID8gcmF3UFs2XSAvIHByZWNpc2lvbiA6IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWxpdmUgJiYgZnJhbWVJbmRleCA9PT0gMCkge1xuICAgICAgICAgIHRoaXMucmVzdFBvc2l0aW9uc1twYXJ0aWNsZUluZGV4XSA9IHAucG9zaXRpb25cbiAgICAgICAgICAgID8ge3g6IHAucG9zaXRpb24ueSwgeTogcC5wb3NpdGlvbi55LCB6OiBwLnBvc2l0aW9uLnp9XG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgdGhpcy5yZXN0Um90YXRpb25zW3BhcnRpY2xlSW5kZXhdID0gcC5yb3RhdGlvblxuICAgICAgICAgICAgPyB7eDogcC5yb3RhdGlvbi55LCB5OiBwLnJvdGF0aW9uLnksIHo6IHAucm90YXRpb24uen1cbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBjcmVhdGVQYXJ0aWNsZXM6IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgdGVtcEdlb21ldHJpZXMgPSBbXTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAobnVtUGFydGljbGVTeXN0ZW1zKSB7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgdmFyIGxvb3AgPSBwYXJzZUludCh0aGlzLmRhdGEubG9vcCk7XG5cbiAgICAgIHRoaXMucGFydGljbGVTeXN0ZW1zLmxlbmd0aCA9IDA7XG5cbiAgICAgIGlmIChpc05hTihsb29wKSkge1xuICAgICAgICBsb29wID0gdGhpcy5kYXRhLmxvb3AgPT09ICd0cnVlJyA/IE51bWJlci5NQVhfVkFMVUUgOiAwO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVBhcnRpY2xlU3lzdGVtczsgaSsrKSB7XG4gICAgICAgIGxldCBwYXJ0aWNsZVN5c3RlbSA9IHtcbiAgICAgICAgICBhY3RpdmU6IGZhbHNlLFxuICAgICAgICAgIGFjdGl2ZVBhcnRpY2xlSW5kaWNlczogbmV3IEFycmF5KHRoaXMucGFydGljbGVDb3VudCksXG4gICAgICAgICAgbG9vcENvdW50OiAwLFxuICAgICAgICAgIGxvb3BUb3RhbDogbG9vcCxcbiAgICAgICAgICBtZXNoOiBudWxsLFxuICAgICAgICAgIHRpbWU6IDBcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBGaWxsIGFycmF5IG9mIGdlb21ldHJpZXMgdG8gbWVyZ2UuXG4gICAgICAgIGNvbnN0IHJhdGlvID0gZGF0YS5pbWcgPyBkYXRhLmltZy53aWR0aCAvIGRhdGEuaW1nLmhlaWdodCA6IDE7XG4gICAgICAgIHRlbXBHZW9tZXRyaWVzLmxlbmd0aCA9IDA7XG4gICAgICAgIGZvciAobGV0IHAgPSAwOyBwIDwgdGhpcy5udW1QYXJ0aWNsZXM7IHArKykge1xuICAgICAgICAgIGxldCBnZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUJ1ZmZlckdlb21ldHJ5KFxuICAgICAgICAgICAgMC4xICogcmF0aW8gKiBkYXRhLnBzY2FsZSxcbiAgICAgICAgICAgIDAuMSAqIGRhdGEucHNjYWxlXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAodGhpcy5zcHJpdGVfcm90YXRpb24gIT09IGZhbHNlKSB7XG4gICAgICAgICAgICBnZW9tZXRyeS5yb3RhdGVYKHRoaXMuc3ByaXRlX3JvdGF0aW9uLngpO1xuICAgICAgICAgICAgZ2VvbWV0cnkucm90YXRlWSh0aGlzLnNwcml0ZV9yb3RhdGlvbi55KTtcbiAgICAgICAgICAgIGdlb21ldHJ5LnJvdGF0ZVoodGhpcy5zcHJpdGVfcm90YXRpb24ueik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdlb21ldHJ5LnJvdGF0ZVgoKHRoaXMuZGF0YS5wcm90YXRpb24ueCAqIE1hdGguUEkpIC8gMTgwKTtcbiAgICAgICAgICAgIGdlb21ldHJ5LnJvdGF0ZVkoKHRoaXMuZGF0YS5wcm90YXRpb24ueSAqIE1hdGguUEkpIC8gMTgwKTtcbiAgICAgICAgICAgIGdlb21ldHJ5LnJvdGF0ZVooKHRoaXMuZGF0YS5wcm90YXRpb24ueiAqIE1hdGguUEkpIC8gMTgwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGVtcEdlb21ldHJpZXMucHVzaChnZW9tZXRyeSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDcmVhdGUgbWVyZ2VkIGdlb21ldHJ5IGZvciB3aG9sZSBwYXJ0aWNsZSBzeXN0ZW0uXG4gICAgICAgIGxldCBtZXJnZWRCdWZmZXJHZW9tZXRyeSA9IFRIUkVFLkJ1ZmZlckdlb21ldHJ5VXRpbHMubWVyZ2VCdWZmZXJHZW9tZXRyaWVzKFxuICAgICAgICAgIHRlbXBHZW9tZXRyaWVzXG4gICAgICAgICk7XG5cbiAgICAgICAgcGFydGljbGVTeXN0ZW0ubWVzaCA9IG5ldyBUSFJFRS5NZXNoKFxuICAgICAgICAgIG1lcmdlZEJ1ZmZlckdlb21ldHJ5LFxuICAgICAgICAgIHRoaXMubWF0ZXJpYWxcbiAgICAgICAgKTtcbiAgICAgICAgcGFydGljbGVTeXN0ZW0ubWVzaC52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZWwuc2V0T2JqZWN0M0QoYHBhcnRpY2xlcGxheWVyJHtpfWAsIHBhcnRpY2xlU3lzdGVtLm1lc2gpO1xuICAgICAgICBjb3B5QXJyYXkoXG4gICAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgICBtZXJnZWRCdWZmZXJHZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5XG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gSGlkZSBhbGwgcGFydGljbGVzIGJ5IGRlZmF1bHQuXG4gICAgICAgIGZvciAoXG4gICAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICAgIGkgPCBtZXJnZWRCdWZmZXJHZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5Lmxlbmd0aDtcbiAgICAgICAgICBpKytcbiAgICAgICAgKSB7XG4gICAgICAgICAgbWVyZ2VkQnVmZmVyR2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheVtpXSA9IC05OTk5OTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2ldID0gaTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucGFydGljbGVTeXN0ZW1zLnB1c2gocGFydGljbGVTeXN0ZW0pO1xuICAgICAgfVxuICAgIH07XG4gIH0pKCksXG5cbiAgc3RhcnQ6IGZ1bmN0aW9uIChldnQpIHtcbiAgICBpZiAodGhpcy5kYXRhLmRlbGF5ID4gMCkge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnN0YXJ0QWZ0ZXJEZWxheShldnQpLCB0aGlzLmRhdGEuZGVsYXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YXJ0QWZ0ZXJEZWxheShldnQpO1xuICAgIH1cbiAgfSxcblxuICBzdGFydEFmdGVyRGVsYXk6IGZ1bmN0aW9uIChldnQpIHtcbiAgICAvLyBwb3NpdGlvbiwgcm90YXRpb25cbiAgICB2YXIgZm91bmQgPSAtMTtcbiAgICB2YXIgcGFydGljbGVTeXN0ZW07XG4gICAgdmFyIG9sZGVzdFRpbWUgPSAwO1xuICAgIHZhciBwb3NpdGlvbiA9IGV2dCA/IGV2dC5kZXRhaWwucG9zaXRpb24gOiBudWxsO1xuICAgIHZhciByb3RhdGlvbiA9IGV2dCA/IGV2dC5kZXRhaWwucm90YXRpb24gOiBudWxsO1xuXG4gICAgaWYgKCEocG9zaXRpb24gaW5zdGFuY2VvZiBUSFJFRS5WZWN0b3IzKSkge1xuICAgICAgcG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIH1cbiAgICBpZiAoIShyb3RhdGlvbiBpbnN0YW5jZW9mIFRIUkVFLkV1bGVyKSkge1xuICAgICAgcm90YXRpb24gPSBuZXcgVEhSRUUuRXVsZXIoKTtcbiAgICB9XG5cbiAgICAvLyBmaW5kIGF2YWlsYWJsZSAob3Igb2xkZXN0KSBwYXJ0aWNsZSBzeXN0ZW1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGFydGljbGVTeXN0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5wYXJ0aWNsZVN5c3RlbXNbaV0uYWN0aXZlID09PSBmYWxzZSkge1xuICAgICAgICBmb3VuZCA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMucGFydGljbGVTeXN0ZW1zW2ldLnRpbWUgPiBvbGRlc3RUaW1lKSB7XG4gICAgICAgIGZvdW5kID0gaTtcbiAgICAgICAgb2xkZXN0VGltZSA9IHRoaXMucGFydGljbGVTeXN0ZW1zW2ldLnRpbWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZvdW5kID09PSAtMSkgeyByZXR1cm47IH1cblxuICAgIHBhcnRpY2xlU3lzdGVtID0gdGhpcy5wYXJ0aWNsZVN5c3RlbXNbZm91bmRdO1xuICAgIHBhcnRpY2xlU3lzdGVtLmFjdGl2ZSA9IHRydWU7XG4gICAgcGFydGljbGVTeXN0ZW0ubG9vcENvdW50ID0gMTtcbiAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoLnZpc2libGUgPSB0cnVlO1xuICAgIHBhcnRpY2xlU3lzdGVtLm1lc2gucG9zaXRpb24uY29weShwb3NpdGlvbik7XG4gICAgcGFydGljbGVTeXN0ZW0ubWVzaC5yb3RhdGlvbi5jb3B5KHJvdGF0aW9uKTtcbiAgICBwYXJ0aWNsZVN5c3RlbS50aW1lID0gMDtcbiAgICB0aGlzLnJlc2V0UGFydGljbGVzKHBhcnRpY2xlU3lzdGVtKTtcbiAgICByZXR1cm4gcGFydGljbGVTeXN0ZW07XG4gIH0sXG5cbiAgZG9Mb29wOiBmdW5jdGlvbiAocGFydGljbGVTeXN0ZW0pIHtcbiAgICBwYXJ0aWNsZVN5c3RlbS5sb29wQ291bnQrKztcbiAgICBwYXJ0aWNsZVN5c3RlbS5mcmFtZSA9IC0xO1xuICAgIHBhcnRpY2xlU3lzdGVtLnRpbWUgPSAwO1xuICAgIHRoaXMucmVzZXRQYXJ0aWNsZXMocGFydGljbGVTeXN0ZW0pO1xuICB9LFxuXG4gIHJlc2V0UGFydGljbGU6IGZ1bmN0aW9uIChwYXJ0aWNsZVN5c3RlbSwgcGFydGljbGVJbmRleCkge1xuICAgIGNvbnN0IGdlb21ldHJ5ID0gcGFydGljbGVTeXN0ZW0ubWVzaC5nZW9tZXRyeTtcblxuICAgIGlmICh0aGlzLnJlc3RQb3NpdGlvbnNbcGFydGljbGVJbmRleF0pIHtcbiAgICAgIHRyYW5zZm9ybVBsYW5lKFxuICAgICAgICBwYXJ0aWNsZUluZGV4LFxuICAgICAgICBnZW9tZXRyeSxcbiAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgdGhpcy5yZXN0UG9zaXRpb25zW3BhcnRpY2xlSW5kZXhdLFxuICAgICAgICB0aGlzLnVzZVJvdGF0aW9uICYmIHRoaXMucmVzdFJvdGF0aW9uc1twYXJ0aWNsZUluZGV4XSxcbiAgICAgICAgbnVsbFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSGlkZS5cbiAgICAgIHRyYW5zZm9ybVBsYW5lKFxuICAgICAgICBwYXJ0aWNsZUluZGV4LFxuICAgICAgICBnZW9tZXRyeSxcbiAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgT0ZGU0NSRUVOX1ZFQzMsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgbnVsbFxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBUT0RPOiBDYW4gdXBkYXRlIHRyYW5zZm9ybVBsYW5lIGZvciBsb29rQXQuXG4gICAgLy8gbG9va0F0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRlZCBvciB0cmFuc2xhdGVkIHBhcmVudHMhIDpfKFxuICAgIC8vIHBhcnQubG9va0F0KHRoaXMuY2FtZXJhLnBvc2l0aW9uKTtcbiAgfSxcblxuICAvKipcbiAgICogV2hlbiBzdGFydGluZyBvciBmaW5pc2hpbmcgKGxvb3BpbmcpIGFuaW1hdGlvbiwgdGhpcyByZXNldHMgcGFydGljbGVzXG4gICAqIHRvIHRoZWlyIGluaXRpYWwgcG9zaXRpb24gYW5kLCBpZiB1c2VyIGFza2VkIGZvciByZXBsYXlpbmcgbGVzcyB0aGFuIDEwMCVcbiAgICogb2YgcGFydGljbGVzLCByYW5kb21seSBjaG9vc2UgdGhlbS5cbiAgICovXG4gIHJlc2V0UGFydGljbGVzOiBmdW5jdGlvbiAocGFydGljbGVTeXN0ZW0pIHtcbiAgICB2YXIgaTtcbiAgICB2YXIgcmFuZDtcblxuICAgIC8vIG5vIHBpY2tpbmcsIGp1c3QgaGlkZSBhbmQgcmVzZXRcbiAgICBpZiAodGhpcy5wYXJ0aWNsZUNvdW50ID09PSB0aGlzLm51bVBhcnRpY2xlcykge1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMubnVtUGFydGljbGVzOyBpKyspIHtcbiAgICAgICAgdGhpcy5yZXNldFBhcnRpY2xlKHBhcnRpY2xlU3lzdGVtLCBpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBoaWRlIHBhcnRpY2xlcyBmcm9tIGxhc3QgYW5pbWF0aW9uIGFuZCBpbml0aWFsaXplIGluZGV4UG9vbFxuICAgIGNvbnN0IGdlb21ldHJ5ID0gcGFydGljbGVTeXN0ZW0ubWVzaC5nZW9tZXRyeTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5udW1QYXJ0aWNsZXM7IGkrKykge1xuICAgICAgaWYgKGkgPCB0aGlzLnBhcnRpY2xlQ291bnQpIHtcbiAgICAgICAgdHJhbnNmb3JtUGxhbmUoXG4gICAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2ldLFxuICAgICAgICAgIGdlb21ldHJ5LFxuICAgICAgICAgIHRoaXMub3JpZ2luYWxWZXJ0ZXhQb3NpdGlvbnMsXG4gICAgICAgICAgT0ZGU0NSRUVOX1ZFQzMsXG4gICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgIG51bGxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaW5kZXhQb29sW2ldID0gaTtcbiAgICB9XG5cbiAgICAvLyBzY3JhbWJsZSBpbmRleFBvb2xcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5wYXJ0aWNsZUNvdW50OyBpKyspIHtcbiAgICAgIHJhbmQgPSBpICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKHRoaXMubnVtUGFydGljbGVzIC0gaSkpO1xuICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2ldID0gdGhpcy5pbmRleFBvb2xbcmFuZF07XG4gICAgICB0aGlzLmluZGV4UG9vbFtyYW5kXSA9IHRoaXMuaW5kZXhQb29sW2ldO1xuICAgICAgdGhpcy5yZXNldFBhcnRpY2xlKFxuICAgICAgICBwYXJ0aWNsZVN5c3RlbSxcbiAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2ldXG4gICAgICApO1xuICAgIH1cbiAgfSxcblxuICB0aWNrOiAoZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGhlbHBlclBvc2l0aW9uVmVjMyA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgICB2YXIgZnJhbWU7IC8vIGN1cnJlbnQgcGFydGljbGUgc3lzdGVtIGZyYW1lXG4gICAgICB2YXIgZmRhdGE7IC8vIGFsbCBwYXJ0aWNsZXMgZGF0YSBpbiBjdXJyZW50IGZyYW1lXG4gICAgICB2YXIgZmRhdGFOZXh0OyAvLyBuZXh0IGZyYW1lIChmb3IgaW50ZXJwb2xhdGlvbilcbiAgICAgIHZhciB1c2VSb3RhdGlvbiA9IHRoaXMudXNlUm90YXRpb247XG4gICAgICB2YXIgZnJhbWVUaW1lOyAvLyB0aW1lIGluIGN1cnJlbnQgZnJhbWUgKGZvciBpbnRlcnBvbGF0aW9uKVxuICAgICAgdmFyIHJlbFRpbWU7IC8vIGN1cnJlbnQgcGFydGljbGUgc3lzdGVtIHJlbGF0aXZlIHRpbWUgKDAtMSlcbiAgICAgIHZhciBpbnRlcnBvbGF0ZTsgLy8gd2hldGhlciBpbnRlcnBvbGF0ZSBiZXR3ZWVuIGZyYW1lcyBvciBub3RcbiAgICAgIGNvbnN0IHNjYWxlU3lzdGVtID0gdGhpcy5kYXRhLmFuaW1hdGVTY2FsZSAmJiAhdGhpcy51c2VBZ2U7XG4gICAgICBjb25zdCBzY2FsZVBhcnRpY2xlID0gdGhpcy5kYXRhLmFuaW1hdGVTY2FsZSAmJiB0aGlzLnVzZUFnZTtcblxuICAgICAgZm9yIChcbiAgICAgICAgbGV0IHBhcnRpY2xlU3lzdGVtSW5kZXggPSAwO1xuICAgICAgICBwYXJ0aWNsZVN5c3RlbUluZGV4IDwgdGhpcy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO1xuICAgICAgICBwYXJ0aWNsZVN5c3RlbUluZGV4KytcbiAgICAgICkge1xuICAgICAgICBsZXQgcGFydGljbGVTeXN0ZW0gPSB0aGlzLnBhcnRpY2xlU3lzdGVtc1twYXJ0aWNsZVN5c3RlbUluZGV4XTtcbiAgICAgICAgaWYgKCFwYXJ0aWNsZVN5c3RlbS5hY3RpdmUpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIHRoZSBkdXJhdGlvbiBpcyBzbyBzaG9ydCB0aGF0IHRoZXJlJ3Mgbm8gbmVlZCB0byBpbnRlcnBvbGF0ZSwgZG9uJ3QgZG8gaXRcbiAgICAgICAgLy8gZXZlbiBpZiB1c2VyIGFza2VkIGZvciBpdC5cbiAgICAgICAgaW50ZXJwb2xhdGUgPVxuICAgICAgICAgIHRoaXMuZGF0YS5pbnRlcnBvbGF0ZSAmJiB0aGlzLmRhdGEuZHVyIC8gdGhpcy5udW1GcmFtZXMgPiBkZWx0YTtcbiAgICAgICAgcmVsVGltZSA9IHBhcnRpY2xlU3lzdGVtLnRpbWUgLyB0aGlzLmRhdGEuZHVyO1xuICAgICAgICBmcmFtZSA9IHJlbFRpbWUgKiB0aGlzLm51bUZyYW1lcztcbiAgICAgICAgZmRhdGEgPSB0aGlzLmZyYW1lZGF0YVtNYXRoLmZsb29yKGZyYW1lKV07XG4gICAgICAgIGlmIChpbnRlcnBvbGF0ZSkge1xuICAgICAgICAgIGZyYW1lVGltZSA9IGZyYW1lIC0gTWF0aC5mbG9vcihmcmFtZSk7XG4gICAgICAgICAgZmRhdGFOZXh0ID1cbiAgICAgICAgICAgIGZyYW1lIDwgdGhpcy5udW1GcmFtZXMgLSAxXG4gICAgICAgICAgICAgID8gdGhpcy5mcmFtZWRhdGFbTWF0aC5mbG9vcihmcmFtZSkgKyAxXVxuICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2NhbGVTeXN0ZW0pIHtcbiAgICAgICAgICB0aGlzLnBhcnRTY2FsZS5sZXJwVmVjdG9ycyh0aGlzLmRhdGEuaW5pdGlhbFNjYWxlLCB0aGlzLmRhdGEuZmluYWxTY2FsZSwgcmVsVGltZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKFxuICAgICAgICAgIGxldCBhY3RpdmVQYXJ0aWNsZUluZGV4ID0gMDtcbiAgICAgICAgICBhY3RpdmVQYXJ0aWNsZUluZGV4IDwgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzLmxlbmd0aDtcbiAgICAgICAgICBhY3RpdmVQYXJ0aWNsZUluZGV4KytcbiAgICAgICAgKSB7XG4gICAgICAgICAgbGV0IHBhcnRpY2xlSW5kZXggPVxuICAgICAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2FjdGl2ZVBhcnRpY2xlSW5kZXhdO1xuICAgICAgICAgIGxldCByb3RhdGlvbiA9IHVzZVJvdGF0aW9uICYmIGZkYXRhW3BhcnRpY2xlSW5kZXhdLnJvdGF0aW9uO1xuXG4gICAgICAgICAgaWYgKHNjYWxlUGFydGljbGUpIHtcbiAgICAgICAgICAgIHRoaXMucGFydFNjYWxlLmxlcnBWZWN0b3JzKHRoaXMuZGF0YS5pbml0aWFsU2NhbGUsIHRoaXMuZGF0YS5maW5hbFNjYWxlLCBmZGF0YVtwYXJ0aWNsZUluZGV4XS5hZ2UpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFRPRE86IEFkZCB2ZXJ0ZXggcG9zaXRpb24gdG8gb3JpZ2luYWwgcG9zaXRpb24gdG8gYWxsIHZlcnRpY2VzIG9mIHBsYW5lLi4uXG4gICAgICAgICAgaWYgKCFmZGF0YVtwYXJ0aWNsZUluZGV4XS5hbGl2ZSkge1xuICAgICAgICAgICAgLy8gSGlkZSBwbGFuZSBvZmYtc2NyZWVuIHdoZW4gbm90IGFsaXZlLlxuICAgICAgICAgICAgdHJhbnNmb3JtUGxhbmUoXG4gICAgICAgICAgICAgIHBhcnRpY2xlSW5kZXgsXG4gICAgICAgICAgICAgIHBhcnRpY2xlU3lzdGVtLm1lc2guZ2VvbWV0cnksXG4gICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxWZXJ0ZXhQb3NpdGlvbnMsXG4gICAgICAgICAgICAgIE9GRlNDUkVFTl9WRUMzLFxuICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgIG51bGxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaW50ZXJwb2xhdGUgJiYgZmRhdGFOZXh0ICYmIGZkYXRhTmV4dFtwYXJ0aWNsZUluZGV4XS5hbGl2ZSkge1xuICAgICAgICAgICAgaGVscGVyUG9zaXRpb25WZWMzLmxlcnBWZWN0b3JzKFxuICAgICAgICAgICAgICBmZGF0YVtwYXJ0aWNsZUluZGV4XS5wb3NpdGlvbixcbiAgICAgICAgICAgICAgZmRhdGFOZXh0W3BhcnRpY2xlSW5kZXhdLnBvc2l0aW9uLFxuICAgICAgICAgICAgICBmcmFtZVRpbWVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1QbGFuZShcbiAgICAgICAgICAgICAgcGFydGljbGVJbmRleCxcbiAgICAgICAgICAgICAgcGFydGljbGVTeXN0ZW0ubWVzaC5nZW9tZXRyeSxcbiAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgICAgICAgaGVscGVyUG9zaXRpb25WZWMzLFxuICAgICAgICAgICAgICByb3RhdGlvbixcbiAgICAgICAgICAgICAgdGhpcy5wYXJ0U2NhbGVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyYW5zZm9ybVBsYW5lKFxuICAgICAgICAgICAgICBwYXJ0aWNsZUluZGV4LFxuICAgICAgICAgICAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoLmdlb21ldHJ5LFxuICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVmVydGV4UG9zaXRpb25zLFxuICAgICAgICAgICAgICBmZGF0YVtwYXJ0aWNsZUluZGV4XS5wb3NpdGlvbixcbiAgICAgICAgICAgICAgcm90YXRpb24sXG4gICAgICAgICAgICAgIHRoaXMucGFydFNjYWxlXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHBhcnRpY2xlU3lzdGVtLnRpbWUgKz0gZGVsdGE7XG4gICAgICAgIGlmIChwYXJ0aWNsZVN5c3RlbS50aW1lID49IHRoaXMuZGF0YS5kdXIpIHtcbiAgICAgICAgICBpZiAocGFydGljbGVTeXN0ZW0ubG9vcENvdW50IDwgcGFydGljbGVTeXN0ZW0ubG9vcFRvdGFsKSB7XG4gICAgICAgICAgICB0aGlzLmVsLmVtaXQoJ3BhcnRpY2xlcGxheWVybG9vcCcsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuZG9Mb29wKHBhcnRpY2xlU3lzdGVtKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbC5lbWl0KCdwYXJ0aWNsZXBsYXllcmZpbmlzaGVkJywgbnVsbCwgZmFsc2UpO1xuICAgICAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9KSgpLFxuXG4gIF90cmFuc2Zvcm1QbGFuZTogdHJhbnNmb3JtUGxhbmVcbn0pO1xuXG4vLyBVc2UgdHJpYW5nbGUgZ2VvbWV0cnkgYXMgYSBoZWxwZXIgZm9yIHJvdGF0aW5nLlxuY29uc3QgdHJpID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgdHJpID0gbmV3IFRIUkVFLkdlb21ldHJ5KCk7XG4gIHRyaS52ZXJ0aWNlcy5wdXNoKG5ldyBUSFJFRS5WZWN0b3IzKCkpO1xuICB0cmkudmVydGljZXMucHVzaChuZXcgVEhSRUUuVmVjdG9yMygpKTtcbiAgdHJpLnZlcnRpY2VzLnB1c2gobmV3IFRIUkVFLlZlY3RvcjMoKSk7XG4gIHRyaS5mYWNlcy5wdXNoKG5ldyBUSFJFRS5GYWNlMygwLCAxLCAyKSk7XG4gIHJldHVybiB0cmk7XG59KSgpO1xuXG4vKipcbiAqIEZhY2VzIG9mIGEgcGxhbmUgYXJlIHYwLCB2MiwgdjEgYW5kIHYyLCB2MywgdjEuXG4gKiBQb3NpdGlvbnMgYXJlIDEyIG51bWJlcnM6IFt2MCwgdjEsIHYyLCB2M10uXG4gKi9cbmZ1bmN0aW9uIHRyYW5zZm9ybVBsYW5lIChcbiAgcGFydGljbGVJbmRleCxcbiAgZ2VvbWV0cnksXG4gIG9yaWdpbmFsQXJyYXksXG4gIHBvc2l0aW9uLFxuICByb3RhdGlvbixcbiAgc2NhbGVcbikge1xuICBjb25zdCBhcnJheSA9IGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXk7XG4gIGNvbnN0IGluZGV4ID0gcGFydGljbGVJbmRleCAqIE5VTV9QTEFORV9QT1NJVElPTlM7XG5cbiAgLy8gQ2FsY3VsYXRlIGZpcnN0IGZhY2UgKDAsIDIsIDEpLlxuICB0cmkudmVydGljZXNbMF0uc2V0KFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyAwXSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgMV0sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDJdXG4gICk7XG4gIHRyaS52ZXJ0aWNlc1sxXS5zZXQoXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDNdLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA0XSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgNV1cbiAgKTtcbiAgdHJpLnZlcnRpY2VzWzJdLnNldChcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgNl0sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDddLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA4XVxuICApO1xuICBpZiAoc2NhbGUgIT09IG51bGwpIHtcbiAgICB0cmkuc2NhbGUoc2NhbGUueCwgc2NhbGUueSwgc2NhbGUueik7XG4gIH1cbiAgaWYgKHJvdGF0aW9uKSB7XG4gICAgdHJpLnJvdGF0ZVgocm90YXRpb24ueCk7XG4gICAgdHJpLnJvdGF0ZVkocm90YXRpb24ueSk7XG4gICAgdHJpLnJvdGF0ZVoocm90YXRpb24ueik7XG4gIH1cbiAgdHJpLnZlcnRpY2VzWzBdLmFkZChwb3NpdGlvbik7XG4gIHRyaS52ZXJ0aWNlc1sxXS5hZGQocG9zaXRpb24pO1xuICB0cmkudmVydGljZXNbMl0uYWRkKHBvc2l0aW9uKTtcbiAgYXJyYXlbaW5kZXggKyAwXSA9IHRyaS52ZXJ0aWNlc1swXS54O1xuICBhcnJheVtpbmRleCArIDFdID0gdHJpLnZlcnRpY2VzWzBdLnk7XG4gIGFycmF5W2luZGV4ICsgMl0gPSB0cmkudmVydGljZXNbMF0uejtcbiAgYXJyYXlbaW5kZXggKyAzXSA9IHRyaS52ZXJ0aWNlc1sxXS54O1xuICBhcnJheVtpbmRleCArIDRdID0gdHJpLnZlcnRpY2VzWzFdLnk7XG4gIGFycmF5W2luZGV4ICsgNV0gPSB0cmkudmVydGljZXNbMV0uejtcbiAgYXJyYXlbaW5kZXggKyA2XSA9IHRyaS52ZXJ0aWNlc1syXS54O1xuICBhcnJheVtpbmRleCArIDddID0gdHJpLnZlcnRpY2VzWzJdLnk7XG4gIGFycmF5W2luZGV4ICsgOF0gPSB0cmkudmVydGljZXNbMl0uejtcblxuICAvLyBDYWxjdWxhdGUgc2Vjb25kIGZhY2UgKDIsIDMsIDEpIGp1c3QgZm9yIHRoZSBsYXN0IHZlcnRleC5cbiAgdHJpLnZlcnRpY2VzWzBdLnNldChcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgM10sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDRdLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA1XVxuICApO1xuICB0cmkudmVydGljZXNbMV0uc2V0KFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA2XSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgN10sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDhdXG4gICk7XG4gIHRyaS52ZXJ0aWNlc1syXS5zZXQoXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDldLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyAxMF0sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDExXVxuICApO1xuICBpZiAoc2NhbGUgIT09IG51bGwpIHtcbiAgICB0cmkuc2NhbGUoc2NhbGUueCwgc2NhbGUueSwgc2NhbGUueik7XG4gIH1cbiAgaWYgKHJvdGF0aW9uKSB7XG4gICAgdHJpLnJvdGF0ZVgocm90YXRpb24ueCk7XG4gICAgdHJpLnJvdGF0ZVkocm90YXRpb24ueSk7XG4gICAgdHJpLnJvdGF0ZVoocm90YXRpb24ueik7XG4gIH1cbiAgdHJpLnZlcnRpY2VzWzBdLmFkZChwb3NpdGlvbik7XG4gIHRyaS52ZXJ0aWNlc1sxXS5hZGQocG9zaXRpb24pO1xuICB0cmkudmVydGljZXNbMl0uYWRkKHBvc2l0aW9uKTtcbiAgYXJyYXlbaW5kZXggKyA5XSA9IHRyaS52ZXJ0aWNlc1syXS54O1xuICBhcnJheVtpbmRleCArIDEwXSA9IHRyaS52ZXJ0aWNlc1syXS55O1xuICBhcnJheVtpbmRleCArIDExXSA9IHRyaS52ZXJ0aWNlc1syXS56O1xuXG4gIGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xufVxubW9kdWxlLmV4cG9ydHMudHJhbnNmb3JtUGxhbmUgPSB0cmFuc2Zvcm1QbGFuZTtcblxuZnVuY3Rpb24gY29weUFycmF5IChkZXN0LCBzcmMpIHtcbiAgZGVzdC5sZW5ndGggPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHNyYy5sZW5ndGg7IGkrKykge1xuICAgIGRlc3RbaV0gPSBzcmNbaV07XG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3BhcnRpY2xlcGxheWVyLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdwYXVzZScsIHtcbiAgc2NoZW1hOiB7XG4gICAgaXNQYXVzZWQ6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kYXRhLmlzUGF1c2VkICYmIHRoaXMuZWwuaXNQbGF5aW5nKSB7XG4gICAgICB0aGlzLmVsLnBhdXNlKCk7XG4gICAgfSBlbHNlIGlmICghdGhpcy5kYXRhLmlzUGF1c2VkICYmICF0aGlzLmVsLmlzUGxheWluZyAmJiB0aGlzLmVsLnNjZW5lRWwuaXNQbGF5aW5nKSB7XG4gICAgICB0aGlzLmVsLnBsYXkoKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvcGF1c2UuanMiLCIvKipcbiAqIFRlbGwgYXBwIHRvIHBhdXNlIGdhbWUgaWYgcGxheWluZy5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdwYXVzZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnBhdXNlR2FtZSA9IHRoaXMucGF1c2VHYW1lLmJpbmQodGhpcyk7XG5cbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignY29udHJvbGxlcmNvbm5lY3RlZCcsIGV2dCA9PiB7XG4gICAgICBpZiAoZXZ0LmRldGFpbC5uYW1lID09PSAndml2ZS1jb250cm9scycpIHtcbiAgICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtZW51ZG93bicsIHRoaXMucGF1c2VHYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigndGh1bWJzdGlja2Rvd24nLCB0aGlzLnBhdXNlR2FtZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd2aXNpYmlsaXR5Y2hhbmdlJywgKCkgPT4ge1xuICAgICAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gJ2hpZGRlbicpIHsgdGhpcy5wYXVzZUdhbWUoKTsgfVxuICAgIH0pO1xuICB9LFxuXG4gIHBhdXNlR2FtZTogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3BhdXNlZ2FtZScsIG51bGwsIGZhbHNlKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9wYXVzZXIuanMiLCJ2YXIgU291bmRQb29sID0gcmVxdWlyZSgnLi4vbGliL3NvdW5kcG9vbCcpO1xuXG5BRlJBTUUucmVnaXN0ZXJTeXN0ZW0oJ3BsYXktc291bmQnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmxhc3RTb3VuZFBsYXllZCA9ICcnO1xuICAgIHRoaXMubGFzdFNvdW5kUGxheWVkVGltZSA9IDA7XG4gICAgdGhpcy5wb29scyA9IHt9O1xuICB9LFxuXG4gIGNyZWF0ZVBvb2w6IGZ1bmN0aW9uIChzb3VuZCwgdm9sdW1lKSB7XG4gICAgaWYgKHRoaXMucG9vbHNbc291bmRdKSB7IHJldHVybjsgfVxuICAgIHRoaXMucG9vbHNbc291bmRdID0gbmV3IFNvdW5kUG9vbChzb3VuZCwgdm9sdW1lKTtcbiAgfSxcblxuICBwbGF5U291bmQ6IGZ1bmN0aW9uIChzb3VuZCwgdm9sdW1lKSB7XG4gICAgaWYgKCF0aGlzLnBvb2xzW3NvdW5kXSkge1xuICAgICAgdGhpcy5jcmVhdGVQb29sKHNvdW5kLCB2b2x1bWUpO1xuICAgIH1cbiAgICB0aGlzLnBvb2xzW3NvdW5kXS5wbGF5KCk7XG5cbiAgICB0aGlzLmxhc3RTb3VuZFBsYXllZCA9IHNvdW5kO1xuICAgIHRoaXMubGFzdFNvdW5kVGltZSA9IHRoaXMuZWwudGltZTtcbiAgfVxufSk7XG5cbi8qKlxuICogUGxheSBzb3VuZCBvbiBldmVudC5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdwbGF5LXNvdW5kJywge1xuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZXZlbnQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgc291bmQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgdm9sdW1lOiB7dHlwZTogJ251bWJlcicsIGRlZmF1bHQ6IDF9XG4gIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmRhdGEuZXZlbnQsIGV2dCA9PiB7XG4gICAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgICAgdGhpcy5zeXN0ZW0ucGxheVNvdW5kKHRoaXMuc3JjLCB0aGlzLmRhdGEudm9sdW1lKTtcbiAgICB9KTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnNyYyA9IHRoaXMuZGF0YS5zb3VuZDtcbiAgICBpZiAodGhpcy5kYXRhLnNvdW5kLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgdGhpcy5zcmMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuZGF0YS5zb3VuZCkuZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvcGxheS1zb3VuZC5qcyIsIi8qKlxuICogU2V0IHJheWNhc3QgdGFyZ2V0IGFzIGEgY2hpbGQgaW5kZXBlbmRuZW50IGZyb20gZW50aXR5LlxuICogVXNlZnVsIGZvciBwYWRkaW5nIHRoZSByYXljYXN0IHRhcmdldCBvZiBhIG1lc2ggd2l0aG91dCBjaGFuZ2luZyB0aGUgbWVzaC5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdyYXljYXN0ZXItdGFyZ2V0Jywge1xuICBzY2hlbWE6IHtcbiAgICBiaW5kVG9nZ2xlOiB7ZGVmYXVsdDogJyd9LFxuICAgIGRlcHRoOiB7dHlwZTogJ251bWJlcid9LFxuICAgIGhlaWdodDoge3R5cGU6ICdudW1iZXInfSxcbiAgICBwb3NpdGlvbjoge3R5cGU6ICd2ZWMzJywgZGVmYXVsdDoge3g6IDAsIHk6IDAsIHo6IDB9fSxcbiAgICByb3RhdGlvbjoge3R5cGU6ICd2ZWMzJywgZGVmYXVsdDoge3g6IDAsIHk6IDAsIHo6IDB9fSxcbiAgICB1c2VCb3hUYXJnZXQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgd2lkdGg6IHt0eXBlOiAnbnVtYmVyJ31cbiAgfSxcblxuICBpbml0OiAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBib3hHZW9tZXRyeSA9IHtwcmltaXRpdmU6ICdib3gnfTtcbiAgICB2YXIgcGxhbmVHZW9tZXRyeSA9IHtwcmltaXRpdmU6ICdwbGFuZSd9O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICAgIHZhciBnZW9tZXRyeTtcbiAgICAgIHZhciByYXljYXN0VGFyZ2V0O1xuXG4gICAgICByYXljYXN0VGFyZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICAgIHJheWNhc3RUYXJnZXQuY2xhc3NMaXN0LmFkZCgncmF5Y2FzdGVyVGFyZ2V0Jyk7XG5cbiAgICAgIGlmIChkYXRhLmJpbmRUb2dnbGUpIHtcbiAgICAgICAgcmF5Y2FzdFRhcmdldC5zZXRBdHRyaWJ1dGUoJ2JpbmQtdG9nZ2xlX19yYXljYXN0YWJsZScsIGRhdGEuYmluZFRvZ2dsZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByYXljYXN0VGFyZ2V0LnNldEF0dHJpYnV0ZSgnZGF0YS1yYXljYXN0YWJsZScsICcnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGRhdGEudXNlQm94VGFyZ2V0KSB7XG4gICAgICAgIC8vIDNEIHRhcmdldC5cbiAgICAgICAgZ2VvbWV0cnkgPSBib3hHZW9tZXRyeTtcbiAgICAgICAgZ2VvbWV0cnkuZGVwdGggPSBkYXRhLmRlcHRoO1xuICAgICAgICBnZW9tZXRyeS5oZWlnaHQgPSBkYXRhLmhlaWdodDtcbiAgICAgICAgZ2VvbWV0cnkud2lkdGggPSBkYXRhLndpZHRoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gMkQgdGFyZ2V0LlxuICAgICAgICBnZW9tZXRyeSA9IHBsYW5lR2VvbWV0cnk7XG4gICAgICAgIGdlb21ldHJ5LmhlaWdodCA9IGRhdGEuaGVpZ2h0O1xuICAgICAgICBnZW9tZXRyeS53aWR0aCA9IGRhdGEud2lkdGg7XG4gICAgICB9XG4gICAgICByYXljYXN0VGFyZ2V0LnNldEF0dHJpYnV0ZSgnZ2VvbWV0cnknLCBnZW9tZXRyeSk7XG5cbiAgICAgIHJheWNhc3RUYXJnZXQub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgcmF5Y2FzdFRhcmdldC5vYmplY3QzRC5wb3NpdGlvbi5jb3B5KGRhdGEucG9zaXRpb24pO1xuICAgICAgcmF5Y2FzdFRhcmdldC5vYmplY3QzRC5yb3RhdGlvbi54ID0gVEhSRUUuTWF0aC5kZWdUb1JhZChkYXRhLnJvdGF0aW9uLngpO1xuICAgICAgcmF5Y2FzdFRhcmdldC5vYmplY3QzRC5yb3RhdGlvbi55ID0gVEhSRUUuTWF0aC5kZWdUb1JhZChkYXRhLnJvdGF0aW9uLnkpO1xuICAgICAgcmF5Y2FzdFRhcmdldC5vYmplY3QzRC5yb3RhdGlvbi56ID0gVEhSRUUuTWF0aC5kZWdUb1JhZChkYXRhLnJvdGF0aW9uLnopO1xuXG4gICAgICBlbC5hcHBlbmRDaGlsZChyYXljYXN0VGFyZ2V0KTtcbiAgICB9O1xuICB9KSgpXG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3JheWNhc3Rlci10YXJnZXQuanMiLCIvKipcbiAqIFJlY2VudGVyIGNhbWVyYSBiYWNrIHRvIGZhY2luZyBkb3duIG5lZ2F0aXZlIFogYXhpcyBhdCAwLCAwLCAwLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3JlY2VudGVyJywge1xuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNjZW5lRWwgPSB0aGlzLmVsLnNjZW5lRWw7XG4gICAgdGhpcy5yZWNlbnRlciA9IHRoaXMucmVjZW50ZXIuYmluZCh0aGlzKTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1t0cmFja2VkLWNvbnRyb2xzXScpLmZvckVhY2goY29udHJvbEVsID0+IHtcbiAgICAgIGNvbnRyb2xFbC5hZGRFdmVudExpc3RlbmVyKCdtZW51ZG93bicsIHRoaXMucmVjZW50ZXIpO1xuICAgICAgY29udHJvbEVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RodW1ic3RpY2tkb3duJywgdGhpcy5yZWNlbnRlcik7XG4gICAgfSk7XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3JlY2VudGVyJywgdGhpcy5yZWNlbnRlcik7XG4gIH0sXG5cbiAgcmVjZW50ZXI6IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV1bGVyID0gbmV3IFRIUkVFLkV1bGVyKCk7XG4gICAgdmFyIG1hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KCk7XG4gICAgdmFyIHJvdGF0aW9uTWF0cml4ID0gbmV3IFRIUkVFLk1hdHJpeDQoKTtcbiAgICB2YXIgdHJhbnNsYXRpb25NYXRyaXggPSBuZXcgVEhSRUUuTWF0cml4NCgpO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcblxuICAgICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cblxuICAgICAgY29uc3QgY2FtZXJhID0gZWwuc2NlbmVFbC5jYW1lcmEuZWwub2JqZWN0M0Q7XG5cbiAgICAgIC8vIFJlc2V0IG1hdHJpeC5cbiAgICAgIG1hdHJpeC5pZGVudGl0eSgpO1xuXG4gICAgICAvLyBDcmVhdGUgbWF0cml4IHRvIHJlc2V0IFkgcm90YXRpb24uXG4gICAgICBldWxlci5zZXQoMCwgLTEgKiBjYW1lcmEucm90YXRpb24ueSwgMCk7XG4gICAgICByb3RhdGlvbk1hdHJpeC5tYWtlUm90YXRpb25Gcm9tRXVsZXIoZXVsZXIpO1xuXG4gICAgICAvLyBDcmVhdGUgbWF0cml4IHRvIHplcm8gcG9zaXRpb24uXG4gICAgICB0cmFuc2xhdGlvbk1hdHJpeC5tYWtlVHJhbnNsYXRpb24oLTEgKiBjYW1lcmEucG9zaXRpb24ueCwgMCwgLTEgKiBjYW1lcmEucG9zaXRpb24ueik7XG5cbiAgICAgIC8vIE11bHRpcGx5IGFuZCBkZWNvbXBvc2UgYmFjayB0byBvYmplY3QzRC5cbiAgICAgIG1hdHJpeC5tdWx0aXBseShyb3RhdGlvbk1hdHJpeCkubXVsdGlwbHkodHJhbnNsYXRpb25NYXRyaXgpO1xuICAgICAgbWF0cml4LmRlY29tcG9zZShlbC5vYmplY3QzRC5wb3NpdGlvbiwgZWwub2JqZWN0M0QucXVhdGVybmlvbiwgZWwub2JqZWN0M0Quc2NhbGUpO1xuICAgICAgZWwub2JqZWN0M0QudXBkYXRlTWF0cml4V29ybGQodHJ1ZSk7XG4gICAgICBlbC5lbWl0KCdyZWNlbnRlcmVkJywgbnVsbCwgZmFsc2UpO1xuICAgIH07XG4gIH0pKClcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvcmVjZW50ZXIuanMiLCIvKipcbiAqIENvbnRyb2xsZXIsIGN1cnNvciwgcmF5Y2FzdGVyLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NhYmVyLWNvbnRyb2xzJywge1xuICBzY2hlbWE6IHtcbiAgICBibGFkZUVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaGFuZDoge2RlZmF1bHQ6ICdyaWdodCcsIG9uZU9mOiBbJ2xlZnQnLCAncmlnaHQnXX0sXG4gICAgaXNQYXVzZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgc3Ryb2tlTWluU3BlZWQ6IHtkZWZhdWx0OiAwLjAwMn0sXG4gICAgc3Ryb2tlTWluRHVyYXRpb246IHtkZWZhdWx0OiAzMH1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIHRoaXMuYm91bmRpbmdCb3ggPSBuZXcgVEhSRUUuQm94MygpO1xuICAgIHRoaXMuY29udHJvbGxlclR5cGUgPSAnJztcbiAgICB0aGlzLnhQbGFuZU5vcm1hbCA9IG5ldyBUSFJFRS5WZWN0b3IzKDAsIDEsIDApO1xuICAgIHRoaXMueVBsYW5lTm9ybWFsID0gbmV3IFRIUkVFLlZlY3RvcjMoMSwgMCwgMCk7XG4gICAgdGhpcy54eVBsYW5lTm9ybWFsID0gbmV3IFRIUkVFLlZlY3RvcjMoMSwgMSwgMCk7XG4gICAgdGhpcy5ibGFkZVRpcFBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLmJsYWRlUG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuYmxhZGVWZWN0b3IgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuYmxhZGVUaXBQcmV2aW91c1Bvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLnByb2plY3RlZEJsYWRlVmVjdG9yID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLnNhYmVyUG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuc3dpbmdpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnN0cm9rZUNvdW50ID0gMDtcbiAgICB0aGlzLmRpc3RhbmNlU2FtcGxlcyA9IFtdO1xuICAgIHRoaXMuZGVsdGFTYW1wbGVzID0gW107XG4gICAgdGhpcy5zdGFydFN0cm9rZVBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLnN0cm9rZURpcmVjdGlvblZlY3RvciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5zdHJva2VEaXJlY3Rpb24gPSB7XG4gICAgICBkb3duOiBmYWxzZSxcbiAgICAgIGxlZnQ6IGZhbHNlLFxuICAgICAgcmlnaHQ6IGZhbHNlLFxuICAgICAgdXA6IGZhbHNlXG4gICAgfTtcbiAgICB0aGlzLmFjY3VtdWxhdGVkRGlzdGFuY2UgPSAwO1xuICAgIHRoaXMuYWNjdW11bGF0ZWREZWx0YSA9IDA7XG5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjb250cm9sbGVyY29ubmVjdGVkJywgdGhpcy5pbml0U2FiZXIuYmluZCh0aGlzKSk7XG5cbiAgICBjb25zdCBoYW5kID0ge2hhbmQ6IGRhdGEuaGFuZCwgbW9kZWw6IGZhbHNlfTtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoJ29jdWx1cy10b3VjaC1jb250cm9scycsIGhhbmQpO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgndml2ZS1jb250cm9scycsIGhhbmQpO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnd2luZG93cy1tb3Rpb24tY29udHJvbHMnLCBoYW5kKTtcblxuICAgIHRoaXMuYmxhZGVFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLmJsYWRlJyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGlmICghb2xkRGF0YS5ibGFkZUVuYWJsZWQgJiYgdGhpcy5kYXRhLmJsYWRlRW5hYmxlZCkge1xuICAgICAgdGhpcy5ibGFkZUVsLmVtaXQoJ2RyYXdibGFkZScpO1xuICAgIH1cbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5ibGFkZUVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5ib3VuZGluZ0JveC5zZXRGcm9tT2JqZWN0KHRoaXMuYmxhZGVFbC5nZXRPYmplY3QzRCgnbWVzaCcpKTtcbiAgICB0aGlzLmRldGVjdFN0cm9rZShkZWx0YSk7XG4gIH0sXG5cbiAgZGV0ZWN0U3Ryb2tlOiBmdW5jdGlvbiAoZGVsdGEpIHtcbiAgICB2YXIgZGlzdGFuY2U7XG4gICAgdmFyIGRpc3RhbmNlU2FtcGxlcyA9IHRoaXMuZGlzdGFuY2VTYW1wbGVzO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBkaXJlY3Rpb25DaGFuZ2U7XG5cbiAgICAvLyBUaXAgb2YgdGhlIGJsYWRlIHBvc2l0aW9uIGluIHdvcmxkIGNvb3JkaW5hdGVzLlxuICAgIHRoaXMuYmxhZGVUaXBQb3NpdGlvbi5zZXQoMCwgMCwgLTAuOCk7XG4gICAgdGhpcy5ibGFkZVBvc2l0aW9uLnNldCgwLCAwLCAwKTtcblxuICAgIGNvbnN0IHNhYmVyT2JqID0gdGhpcy5lbC5vYmplY3QzRDtcbiAgICBzYWJlck9iai5wYXJlbnQudXBkYXRlTWF0cml4V29ybGQoKTtcbiAgICBzYWJlck9iai5sb2NhbFRvV29ybGQodGhpcy5ibGFkZVRpcFBvc2l0aW9uKTtcbiAgICBzYWJlck9iai5sb2NhbFRvV29ybGQodGhpcy5ibGFkZVBvc2l0aW9uKTtcblxuICAgIC8vIEFuZ2xlcyBiZXR3ZWVuIHNhYmVyIGFuZCBtYWpvciBwbGFuZXMuXG4gICAgdGhpcy5ibGFkZVZlY3Rvci5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbikuc3ViKHRoaXMuYmxhZGVQb3NpdGlvbikubm9ybWFsaXplKCk7XG4gICAgdmFyIGFuZ2xlUGxhbmVYID0gdGhpcy5wcm9qZWN0ZWRCbGFkZVZlY3Rvci5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbikucHJvamVjdE9uUGxhbmUodGhpcy54UGxhbmVOb3JtYWwpLmFuZ2xlVG8odGhpcy5ibGFkZVZlY3Rvcik7XG4gICAgdmFyIGFuZ2xlUGxhbmVZID0gdGhpcy5wcm9qZWN0ZWRCbGFkZVZlY3Rvci5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbikucHJvamVjdE9uUGxhbmUodGhpcy55UGxhbmVOb3JtYWwpLmFuZ2xlVG8odGhpcy5ibGFkZVZlY3Rvcik7XG4gICAgdmFyIGFuZ2xlUGxhbmVYWSA9IHRoaXMucHJvamVjdGVkQmxhZGVWZWN0b3IuY29weSh0aGlzLmJsYWRlVGlwUG9zaXRpb24pLnByb2plY3RPblBsYW5lKHRoaXMueHlQbGFuZU5vcm1hbCkuYW5nbGVUbyh0aGlzLmJsYWRlVmVjdG9yKTtcblxuICAgIC8vIERpc3RhbmNlIGNvdmVyZWQgYnV0IHRoZSBzYWJlciB0aXAgaW4gb25lIGZyYW1lLlxuICAgIGRpc3RhbmNlID0gdGhpcy5ibGFkZVRpcFByZXZpb3VzUG9zaXRpb24uc3ViKHRoaXMuYmxhZGVUaXBQb3NpdGlvbikubGVuZ3RoKCk7XG5cbiAgICAvLyBTYW1wbGUgZGlzdGFuY2Ugb2YgdGhlIGxhc3QgNSBmcmFtZXMuXG4gICAgaWYgKHRoaXMuZGlzdGFuY2VTYW1wbGVzLmxlbmd0aCA9PT0gNSkge1xuICAgICAgdGhpcy5hY2N1bXVsYXRlZERpc3RhbmNlIC09IHRoaXMuZGlzdGFuY2VTYW1wbGVzLnNoaWZ0KCk7XG4gICAgICB0aGlzLmFjY3VtdWxhdGVkRGVsdGEgLT0gdGhpcy5kZWx0YVNhbXBsZXMuc2hpZnQoKTtcbiAgICB9XG4gICAgdGhpcy5kaXN0YW5jZVNhbXBsZXMucHVzaChkaXN0YW5jZSk7XG4gICAgdGhpcy5hY2N1bXVsYXRlZERpc3RhbmNlICs9IGRpc3RhbmNlO1xuXG4gICAgdGhpcy5kZWx0YVNhbXBsZXMucHVzaChkZWx0YSk7XG4gICAgdGhpcy5hY2N1bXVsYXRlZERlbHRhICs9IGRlbHRhO1xuXG4gICAgLy8gRmlsdGVyIG91dCBzYWJlciBtb3ZlbWVudHMgdGhhdCBhcmUgdG9vIHNsb3cuIFRvbyBzbG93IGlzIGNvbnNpZGVyZWQgd3JvbmcgaGl0LlxuICAgIGlmICh0aGlzLmFjY3VtdWxhdGVkRGlzdGFuY2UgLyB0aGlzLmFjY3VtdWxhdGVkRGVsdGEgPiB0aGlzLmRhdGEuc3Ryb2tlTWluU3BlZWQpIHtcbiAgICAgIC8vIFRoaXMgZmlsdGVycyBvdXQgdW5pbnRlbnRpb25hbCBzd2luZ3MuXG4gICAgICBpZiAoIXRoaXMuc3dpbmdpbmcpIHtcbiAgICAgICAgdGhpcy5zdGFydFN0cm9rZVBvc2l0aW9uLmNvcHkodGhpcy5ibGFkZVRpcFBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5zd2luZ2luZyA9IHRydWU7XG4gICAgICAgIHRoaXMuc3Ryb2tlRHVyYXRpb24gPSAwO1xuICAgICAgICB0aGlzLm1heEFuZ2xlUGxhbmVYID0gMDtcbiAgICAgICAgdGhpcy5tYXhBbmdsZVBsYW5lWSA9IDA7XG4gICAgICAgIHRoaXMubWF4QW5nbGVQbGFuZVhZID0gMDtcbiAgICAgIH1cbiAgICAgIHRoaXMudXBkYXRlU3Ryb2tlRGlyZWN0aW9uKCk7XG4gICAgICB0aGlzLnN0cm9rZUR1cmF0aW9uICs9IGRlbHRhO1xuICAgICAgY29uc3QgYW5nbGVQbGFuZVhJbmNyZWFzZWQgPSBhbmdsZVBsYW5lWCA+IHRoaXMubWF4QW5nbGVQbGFuZVg7XG4gICAgICBjb25zdCBhbmdsZVBsYW5lWUluY3JlYXNlZCA9IGFuZ2xlUGxhbmVZID4gdGhpcy5tYXhBbmdsZVBsYW5lWTtcbiAgICAgIGNvbnN0IGFuZ2xlUGxhbmVYWUluY3JlYXNlZCA9IGFuZ2xlUGxhbmVYWSA+IHRoaXMubWF4QW5nbGVQbGFuZVhZO1xuICAgICAgdGhpcy5tYXhBbmdsZVBsYW5lWCA9IGFuZ2xlUGxhbmVYSW5jcmVhc2VkID8gYW5nbGVQbGFuZVggOiB0aGlzLm1heEFuZ2xlUGxhbmVYO1xuICAgICAgdGhpcy5tYXhBbmdsZVBsYW5lWSA9IGFuZ2xlUGxhbmVZSW5jcmVhc2VkID8gYW5nbGVQbGFuZVkgOiB0aGlzLm1heEFuZ2xlUGxhbmVZO1xuICAgICAgdGhpcy5tYXhBbmdsZVBsYW5lWFkgPSBhbmdsZVBsYW5lWFlJbmNyZWFzZWQgPyBhbmdsZVBsYW5lWFkgOiB0aGlzLm1heEFuZ2xlUGxhbmVYWTtcbiAgICAgIGlmICghYW5nbGVQbGFuZVhJbmNyZWFzZWQgJiYgIWFuZ2xlUGxhbmVZSW5jcmVhc2VkKSB7IHRoaXMuZW5kU3Ryb2tlKCk7IH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbmRTdHJva2UoKTtcbiAgICB9XG5cbiAgICB0aGlzLmJsYWRlVGlwUHJldmlvdXNQb3NpdGlvbi5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbik7XG4gIH0sXG5cbiAgZW5kU3Ryb2tlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnN3aW5naW5nIHx8IHRoaXMuc3Ryb2tlRHVyYXRpb24gPCB0aGlzLmRhdGEuc3Ryb2tlTWluRHVyYXRpb24pIHsgcmV0dXJuOyB9XG5cbiAgICB0aGlzLmVsLmVtaXQoJ3N0cm9rZWVuZCcpO1xuICAgIHRoaXMuc3dpbmdpbmcgPSBmYWxzZTtcbiAgICAvLyBTdHJva2UgZmluaXNoZXMuIFJlc2V0IHN3aW5naW5nIHN0YXRlLlxuICAgIHRoaXMuYWNjdW11bGF0ZWREaXN0YW5jZSA9IDA7XG4gICAgdGhpcy5hY2N1bXVsYXRlZERlbHRhID0gMDtcbiAgICB0aGlzLm1heEFuZ2xlUGxhbmVYID0gMDtcbiAgICB0aGlzLm1heEFuZ2xlUGxhbmVZID0gMDtcbiAgICB0aGlzLm1heEFuZ2xlUGxhbmVYWSA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRpc3RhbmNlU2FtcGxlcy5sZW5ndGg7IGkrKykgeyB0aGlzLmRpc3RhbmNlU2FtcGxlc1tpXSA9IDA7IH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGVsdGFTYW1wbGVzLmxlbmd0aDsgaSsrKSB7IHRoaXMuZGVsdGFTYW1wbGVzW2ldID0gMDsgfVxuXG4gICAgdmFyIGRpcmVjdGlvbiA9ICdESVJFQ1RJT04gJ1xuICAgIGlmICh0aGlzLnN0cm9rZURpcmVjdGlvbi5yaWdodCkge1xuICAgICAgZGlyZWN0aW9uICs9ICdSSUdIVCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpcmVjdGlvbiArPSAnTEVGVCc7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc3Ryb2tlRGlyZWN0aW9uLnVwKSB7XG4gICAgICBkaXJlY3Rpb24gKz0gJyBUT1AnO1xuICAgIH0gZWxzZSB7XG4gICAgICBkaXJlY3Rpb24gKz0gJyBCT1RUT00nO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhkaXJlY3Rpb24pO1xuICAgIHRoaXMuZWwuZW1pdCgnc3Ryb2tlZW5kJyk7XG4gIH0sXG5cbiAgdXBkYXRlU3Ryb2tlRGlyZWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zdHJva2VEaXJlY3Rpb25WZWN0b3IuY29weSh0aGlzLmJsYWRlVGlwUG9zaXRpb24pLnN1Yih0aGlzLnN0YXJ0U3Ryb2tlUG9zaXRpb24pO1xuICAgIGlmICh0aGlzLnN0cm9rZURpcmVjdGlvblZlY3Rvci54ID09PSAwICYmIHRoaXMuc3Ryb2tlRGlyZWN0aW9uVmVjdG9yLnkgPT09IDApIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5zdHJva2VEaXJlY3Rpb24ucmlnaHQgPSB0aGlzLnN0cm9rZURpcmVjdGlvblZlY3Rvci54ID4gMDtcbiAgICB0aGlzLnN0cm9rZURpcmVjdGlvbi5sZWZ0ID0gdGhpcy5zdHJva2VEaXJlY3Rpb25WZWN0b3IueCA8IDA7XG4gICAgdGhpcy5zdHJva2VEaXJlY3Rpb24udXAgPSB0aGlzLnN0cm9rZURpcmVjdGlvblZlY3Rvci55ID4gMDtcbiAgICB0aGlzLnN0cm9rZURpcmVjdGlvbi5kb3duID0gdGhpcy5zdHJva2VEaXJlY3Rpb25WZWN0b3IueSA8IDA7XG4gIH0sXG5cbiAgaW5pdFNhYmVyOiBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgdGhpcy5jb250cm9sbGVyVHlwZSA9IGV2dC5kZXRhaWwubmFtZTtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnY3Vyc29yJywgdGhpcy5jb25maWdbdGhpcy5jb250cm9sbGVyVHlwZV0uY3Vyc29yIHx8IHt9KTtcbiAgfSxcblxuICBjb25maWc6IHtcbiAgICAnb2N1bHVzLXRvdWNoLWNvbnRyb2xzJzoge1xuICAgICAgY3Vyc29yOiB7XG4gICAgICAgIGRvd25FdmVudHM6IFtcbiAgICAgICAgICAndHJpZ2dlcmRvd24nLFxuICAgICAgICAgICdncmlwZG93bicsXG4gICAgICAgICAgJ2FidXR0b25kb3duJyxcbiAgICAgICAgICAnYmJ1dHRvbmRvd24nLFxuICAgICAgICAgICd4YnV0dG9uZG93bicsXG4gICAgICAgICAgJ3lidXR0b25kb3duJ1xuICAgICAgICBdLFxuICAgICAgICB1cEV2ZW50czogW1xuICAgICAgICAgICd0cmlnZ2VydXAnLFxuICAgICAgICAgICdncmlwdXAnLFxuICAgICAgICAgICdhYnV0dG9udXAnLFxuICAgICAgICAgICdiYnV0dG9udXAnLFxuICAgICAgICAgICd4YnV0dG9udXAnLFxuICAgICAgICAgICd5YnV0dG9udXAnXG4gICAgICAgIF1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgJ3ZpdmUtY29udHJvbHMnOiB7XG4gICAgICBjdXJzb3I6IHtcbiAgICAgICAgZG93bkV2ZW50czogWyd0cmFja3BhZGRvd24nLCAndHJpZ2dlcmRvd24nLCAnZ3JpcGRvd24nXSxcbiAgICAgICAgdXBFdmVudHM6IFsndHJhY2twYWR1cCcsICd0cmlnZ2VydXAnLCAnZ3JpcHVwJ11cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgJ3dpbmRvd3MtbW90aW9uLWNvbnRyb2xzJzoge1xuICAgICAgY3Vyc29yOiB7XG4gICAgICAgIGRvd25FdmVudHM6IFsndHJhY2twYWRkb3duJywgJ3RyaWdnZXJkb3duJywgJ2dyaXBkb3duJ10sXG4gICAgICAgIHVwRXZlbnRzOiBbJ3RyYWNrcGFkdXAnLCAndHJpZ2dlcnVwJywgJ2dyaXB1cCddXG4gICAgICB9XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3NhYmVyLWNvbnRyb2xzLmpzIiwiY29uc3QgSElUX0xFRlQgPSAnaGl0TGVmdCc7XG5jb25zdCBISVRfUklHSFQgPSAnaGl0UmlnaHQnO1xuY29uc3QgTEVGVCA9ICdsZWZ0JztcbmNvbnN0IFJJR0hUID0gJ3JpZ2h0JztcblxuLyoqXG4gKiBTaG93IHBhcnRpY2xlcyB3aGVuIHRvdWNoZWQgYnkgc2FiZXIuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc2FiZXItcGFydGljbGVzJywge1xuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGhhbmQ6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5oaWRkZW5JbnRlcnNlY3Rpb24gPSB7eDogOTk5LCB5OiAwLCB6OiAwfTtcbiAgICB0aGlzLmludGVyc2VjdGVkRWwgPSBudWxsO1xuXG4gICAgdGhpcy5wYXJ0aWNsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3BhcmtQYXJ0aWNsZXMnKTtcbiAgICB0aGlzLnBhcnRpY2xlRXZlbnREZXRhaWwgPSB7cG9zaXRpb246IG5ldyBUSFJFRS5WZWN0b3IzKCksIHJvdGF0aW9uOiBuZXcgVEhSRUUuRXVsZXIoKX07XG4gICAgdGhpcy5wYXJ0aWNsZUV2ZW50ID0ge2RldGFpbDogdGhpcy5wYXJ0aWNsZUV2ZW50RGV0YWlsfTtcbiAgICB0aGlzLnBhcnRpY2xlU3lzdGVtID0gbnVsbDtcblxuICAgIHRoaXMuc2FiZXJFbnRlciA9IHRoaXMuc2FiZXJFbnRlci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc2FiZXJMZWF2ZSA9IHRoaXMuc2FiZXJMZWF2ZS5iaW5kKHRoaXMpO1xuXG4gIH0sXG5cbiAgcGF1c2U6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCB0aGlzLnNhYmVyRW50ZXIpO1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMuc2FiZXJMZWF2ZSk7XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIHRoaXMuc2FiZXJFbnRlcik7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgdGhpcy5zYWJlckxlYXZlKTtcbiAgICB0aGlzLnBhcnRpY2xlc0R1ciA9IHRoaXMucGFydGljbGVzLmdldEF0dHJpYnV0ZSgncGFydGljbGVwbGF5ZXInKS5kdXI7XG4gIH0sXG5cbiAgc2FiZXJFbnRlcjogZnVuY3Rpb24gKGV2dCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgaWYgKGV2dC50YXJnZXQgIT09IHRoaXMuZWwpIHsgcmV0dXJuOyB9XG4gICAgaWYgKCFldnQuZGV0YWlsLmludGVyc2VjdGVkRWwuaGFzQXR0cmlidXRlKCdkYXRhLXNhYmVyLXBhcnRpY2xlcycpKSB7IHJldHVybjsgfVxuICAgIHRoaXMuaW50ZXJzZWN0ZWRFbCA9IGV2dC5kZXRhaWwuaW50ZXJzZWN0ZWRFbDtcbiAgfSxcblxuICBzYWJlckxlYXZlOiBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgaWYgKGV2dC5kZXRhaWwudGFyZ2V0ICE9PSB0aGlzLmVsKSB7IHJldHVybjsgfVxuXG4gICAgLy8gSGlkZSBoaXQgaW50ZXJzZWN0aW9uIHRleHR1cmUuXG4gICAgaWYgKHRoaXMuaW50ZXJzZWN0ZWRFbC5jb21wb25lbnRzLndhbGwgfHwgdGhpcy5pbnRlcnNlY3RlZEVsLmlkID09PSAnZmxvb3InKSB7XG4gICAgICBjb25zdCB1bmlmb3JtID0gdGhpcy5kYXRhLmhhbmQgPT09IFJJR0hUID8gSElUX1JJR0hUIDogSElUX0xFRlQ7XG4gICAgICBjb25zdCBtYXRlcmlhbCA9IHRoaXMuaW50ZXJzZWN0ZWRFbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsO1xuICAgICAgbWF0ZXJpYWwudW5pZm9ybXNbdW5pZm9ybV0udmFsdWUgPSB0aGlzLmhpZGRlbkludGVyc2VjdGlvbjtcbiAgICB9XG4gICAgdGhpcy5pbnRlcnNlY3RlZEVsID0gbnVsbDtcbiAgICB0aGlzLnBhcnRpY2xlU3lzdGVtID0gbnVsbDtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkIHx8ICF0aGlzLmludGVyc2VjdGVkRWwpIHsgcmV0dXJuOyB9XG5cbiAgICBjb25zdCByYXljYXN0ZXIgPSB0aGlzLmVsLmNvbXBvbmVudHMucmF5Y2FzdGVyX19nYW1lO1xuICAgIGNvbnN0IGludGVyc2VjdGlvbiA9IHJheWNhc3Rlci5nZXRJbnRlcnNlY3Rpb24odGhpcy5pbnRlcnNlY3RlZEVsKTtcblxuICAgIGlmICghaW50ZXJzZWN0aW9uKSB7IHJldHVybjsgfVxuXG4gICAgLy8gVXBkYXRlIGludGVyc2VjdGlvbiBtYXRlcmlhbCBpZiBuZWNlc3NhcnkuXG4gICAgLypcbiAgICBpZiAodGhpcy5pbnRlcnNlY3RlZEVsLmNvbXBvbmVudHMud2FsbCB8fCB0aGlzLmludGVyc2VjdGVkRWwuaWQgPT09ICdmbG9vcicpIHtcbiAgICAgIGNvbnN0IHVuaWZvcm0gPSB0aGlzLmRhdGEuaGFuZCA9PT0gUklHSFQgPyBISVRfUklHSFQgOiBISVRfTEVGVDtcbiAgICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5pbnRlcnNlY3RlZEVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWw7XG4gICAgICBtYXRlcmlhbC51bmlmb3Jtc1t1bmlmb3JtXS52YWx1ZSA9IGludGVyc2VjdGlvbi5wb2ludDtcbiAgICB9XG4gICAgKi9cblxuICAgIGlmICh0aGlzLnBhcnRpY2xlU3lzdGVtICYmIHRoaXMucGFydGljbGVTeXN0ZW0uYWN0aXZlKSB7XG4gICAgICAvLyBVcGRhdGUgcGFydGljbGUgcG9zaXRpb24uXG4gICAgICB0aGlzLnBhcnRpY2xlU3lzdGVtLm1lc2gucG9zaXRpb24uY29weShpbnRlcnNlY3Rpb24ucG9pbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTdGFydCBwYXJ0aWNsZSBzeXN0ZW0uXG4gICAgICB0aGlzLnBhcnRpY2xlRXZlbnREZXRhaWwucG9zaXRpb24uY29weShpbnRlcnNlY3Rpb24ucG9pbnQpO1xuICAgICAgdGhpcy5wYXJ0aWNsZVN5c3RlbSA9IHRoaXMucGFydGljbGVzLmNvbXBvbmVudHMucGFydGljbGVwbGF5ZXIuc3RhcnRBZnRlckRlbGF5KFxuICAgICAgICB0aGlzLnBhcnRpY2xlRXZlbnQpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zYWJlci1wYXJ0aWNsZXMuanMiLCIvKipcbiAqIFNjb3JlIGJlYXQsIGF1dG8tcmV0dXJuIHRvIHBvb2wgaW4gMS4ycy5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzY29yZS1iZWF0Jywge1xuICBzY2hlbWE6IHtcbiAgICB0eXBlOiB7IHR5cGU6ICdzdHJpbmcnIH1cbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5wb29sQ29tcG9uZW50ID0gYHBvb2xfX2JlYXRzY29yZSR7dGhpcy5kYXRhLnR5cGV9YDtcbiAgICB0aGlzLnN0YXJ0VGltZSA9IHRoaXMuZWwuc2NlbmVFbC50aW1lO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lKSB7XG4gICAgaWYgKHRpbWUgPiB0aGlzLnN0YXJ0VGltZSArIDEyMDApIHtcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzW3RoaXMucG9vbENvbXBvbmVudF0ucmV0dXJuRW50aXR5KHRoaXMuZWwpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zY29yZS1iZWF0LmpzIiwiLyoqXG4gKiBTY29yZSB0ZXh0IGZhZGUgaW4gYW5pbWF0aW9uLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3Njb3JlLXRleHRzJywge1xuICBzY2hlbWE6IHtcbiAgICBpc1NvbmdMb2FkaW5nOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMudGV4dEVscyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbCgnW3RleHRdJyk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudGV4dEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy50ZXh0RWxzW2ldLnNldEF0dHJpYnV0ZSgnYW5pbWF0aW9uX19mYWRlaW4nLCB7XG4gICAgICAgIGF1dG9wbGF5OiBmYWxzZSxcbiAgICAgICAgcHJvcGVydHk6J2NvbXBvbmVudHMudGV4dC5tYXRlcmlhbC51bmlmb3Jtcy5vcGFjaXR5LnZhbHVlJyxcbiAgICAgICAgZGVsYXk6IDI1MCxcbiAgICAgICAgZHVyOiA3NTAsXG4gICAgICAgIGVhc2luZzogJ2Vhc2VJbk91dEN1YmljJyxcbiAgICAgICAgZnJvbTogMCxcbiAgICAgICAgdG86IDFcbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgLy8gRmluaXNoZWQgbG9hZGluZy5cbiAgICBpZiAob2xkRGF0YS5pc1NvbmdMb2FkaW5nICYmICF0aGlzLmRhdGEuaXNTb25nTG9hZGluZykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRleHRFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy50ZXh0RWxzW2ldLmNvbXBvbmVudHNbJ2FuaW1hdGlvbl9fZmFkZWluJ10uYmVnaW5BbmltYXRpb24oKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCd0ZXh0Z2xvd25vcm1hbCcsIG51bGwsIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvLyBTdGFydGVkIGxvYWRpbmcuXG4gICAgaWYgKCFvbGREYXRhLmlzU29uZ0xvYWRpbmcgJiYgdGhpcy5kYXRhLmlzU29uZ0xvYWRpbmcpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50ZXh0RWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMudGV4dEVsc1tpXS5jb21wb25lbnRzLnRleHQubWF0ZXJpYWwudW5pZm9ybXMub3BhY2l0eS52YWx1ZSA9IDA7XG4gICAgICB9XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgndGV4dGdsb3dvZmYnLCBudWxsLCBmYWxzZSk7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3Njb3JlLXRleHRzLmpzIiwiaW1wb3J0IHV0aWxzIGZyb20gJy4uL3V0aWxzJztcblxudmFyIENBTlZBU19IRUlHSFQgPSA1MTI7ICAvLyBQb3dlci1vZi10d28uXG52YXIgSEVJR0hUID0gNjQ7XG52YXIgTlVNX1BFUl9QQUdFID0gNjtcbnZhciBXSURUSCA9IDY0O1xuXG4vLyBBcHBseSBoZWlnaHQgZmFjdG9yIHNpbmNlIHRoZSBpbWFnZXMgZG9uJ3QgcmVhY2ggdGhlIHBvd2VyLW9mLXR3byBoZWlnaHQsIG5lZWQgdG8gc3RyZXRjaC5cbnZhciBIRUlHSFRfRkFDVE9SID0gQ0FOVkFTX0hFSUdIVCAvIChIRUlHSFQgKiBOVU1fUEVSX1BBR0UpO1xudmFyIElNQUdFX0hFSUdIVF9DQU5WQVMgPSBIRUlHSFQgKiBIRUlHSFRfRkFDVE9SO1xuXG4vKipcbiAqIENyZWF0ZSB0aHVtYm5haWwgYXRsYXMgZm9yIGFsbCB0aGUgdGh1bWJuYWlsIGltYWdlcyB0b2dldGhlciBwZXIgcGFnZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzZWFyY2gtdGh1bWJuYWlsLWF0bGFzJywge1xuICBkZXBlbmRlbmNpZXM6IFsnZ2VvbWV0cnknLCAnbWF0ZXJpYWwnXSxcblxuICBzY2hlbWE6IHtcbiAgICBkdW1teVVwZGF0ZXI6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gQ3JlYXRlIGNhbnZhcyBmb3IgdGV4dHVyZSBhdGxhcy5cbiAgICBjb25zdCBjYW52YXMgPSB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIGNhbnZhcy5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3RodW1ibmFpbEF0bGFzTWFwJyk7XG4gICAgY2FudmFzLmhlaWdodCA9IENBTlZBU19IRUlHSFQ7ICAvLyBQb3dlci1vZi10d28uXG4gICAgY2FudmFzLndpZHRoID0gV0lEVEg7XG4gICAgdGhpcy5jdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICB0aGlzLmNsZWFyQ2FudmFzKCk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjYW52YXMpO1xuXG4gICAgLy8gQWxwaGEgbWFwIGZvciB3aGVuIHNlYXJjaCByZXN1bHRzIGRvbid0IGNvbnRhaW4gbWF4IG51bWJlciBvZiByZXN1bHRzLlxuICAgIGNvbnN0IGFscGhhQ2FudmFzID0gdGhpcy5hbHBoYUNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIGFscGhhQ2FudmFzLnNldEF0dHJpYnV0ZSgnaWQnLCAndGh1bWJuYWlsQWxwaGFNYXAnKTtcbiAgICBhbHBoYUNhbnZhcy5oZWlnaHQgPSBDQU5WQVNfSEVJR0hUO1xuICAgIGFscGhhQ2FudmFzLndpZHRoID0gV0lEVEg7XG4gICAgdGhpcy5hbHBoYUN0eCA9IGFscGhhQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhbHBoYUNhbnZhcyk7XG5cbiAgICB0aGlzLmVsLmNvbXBvbmVudHMubWF0ZXJpYWwubWF0ZXJpYWwuYWxwaGFNYXAgPSBuZXcgVEhSRUUuQ2FudmFzVGV4dHVyZShhbHBoYUNhbnZhcyk7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3NyYycsIGNhbnZhcyk7XG4gICAgdGhpcy5pbWFnZXMgPSBbXTtcblxuICAgIHRoaXMubGFzdE51bVJlc3VsdHMgPSBOVU1fUEVSX1BBR0U7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcblxuICAgIGNvbnN0IHJlc3VsdHMgPSBlbC5zY2VuZUVsLnN5c3RlbXMuc3RhdGUuc3RhdGUuc2VhcmNoUmVzdWx0c1BhZ2U7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgaW1nID0gdGhpcy5pbWFnZXNbaV0gPSB0aGlzLmltYWdlc1tpXSB8fCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAgIGltZy5jcm9zc09yaWdpbiA9ICdhbm9ueW1vdXMnO1xuICAgICAgaW1nLnNyYyA9IHV0aWxzLmdldFMzRmlsZVVybChyZXN1bHRzW2ldLmlkLCAnaW1hZ2UuanBnJyk7XG4gICAgICBpZiAoaW1nLmNvbXBsZXRlKSB7XG4gICAgICAgIHRoaXMuZHJhdyhpbWcsIGkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICB0aGlzLmRyYXcoaW1nLCBpKTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgYWxwaGEgbWFwLlxuICAgIGlmIChyZXN1bHRzLmxlbmd0aCAhPT0gdGhpcy5sYXN0TnVtUmVzdWx0cykgeyB0aGlzLnVwZGF0ZUFscGhhTWFwKHJlc3VsdHMubGVuZ3RoKTsgfVxuICAgIHRoaXMubGFzdE51bVJlc3VsdHMgPSByZXN1bHRzLmxlbmd0aDtcbiAgfSxcblxuICAvKipcbiAgICogRHJhdyB0aHVtYm5haWwgb24gY2FudmFzIGF0IHJvdyBpLlxuICAgKi9cbiAgZHJhdzogZnVuY3Rpb24gKGltZywgaSkge1xuICAgIHRoaXMuY3R4LmRyYXdJbWFnZShcbiAgICAgIGltZyxcbiAgICAgIDAsXG4gICAgICBpICogSU1BR0VfSEVJR0hUX0NBTlZBUyxcbiAgICAgIFdJRFRILFxuICAgICAgSU1BR0VfSEVJR0hUX0NBTlZBUyk7XG4gICAgdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm1hcC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gIH0sXG5cbiAgY2xlYXJDYW52YXM6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBjYW52YXMgPSB0aGlzLmNhbnZhcztcbiAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSAnIzExMSc7XG4gICAgdGhpcy5jdHguZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgfSxcblxuICB1cGRhdGVBbHBoYU1hcDogZnVuY3Rpb24gKG51bVJlc3VsdHMpIHtcbiAgICBjb25zdCBjYW52YXMgPSB0aGlzLmFscGhhQ2FudmFzO1xuICAgIGNvbnN0IGN0eCA9IHRoaXMuYWxwaGFDdHg7XG4gICAgY3R4LmZpbGxTdHlsZSA9ICcjRkZGJztcbiAgICBjdHguZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICBjdHguZmlsbFN0eWxlID0gJyMwMDAnO1xuICAgIGN0eC5maWxsUmVjdChcbiAgICAgIDAsXG4gICAgICBudW1SZXN1bHRzICogSU1BR0VfSEVJR0hUX0NBTlZBUyxcbiAgICAgIGNhbnZhcy53aWR0aCxcbiAgICAgIGNhbnZhcy5oZWlnaHQgLSBudW1SZXN1bHRzICogSU1BR0VfSEVJR0hUX0NBTlZBUyk7XG4gICAgdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLmFscGhhTWFwLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3NlYXJjaC10aHVtYm5haWwtYXRsYXMuanMiLCJ2YXIgYWxnb2xpYXNlYXJjaCA9IHJlcXVpcmUoJ2FsZ29saWFzZWFyY2gvbGl0ZScpO1xudmFyIGJpbmRFdmVudCA9IHJlcXVpcmUoJ2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzJykuYmluZEV2ZW50O1xuXG52YXIgY2xpZW50ID0gYWxnb2xpYXNlYXJjaCgnUVVMVE9ZM1pXVScsICdiZTA3MTY0MTkyNDcxZGY3ZTk3ZTZmYTcwYzFkMDQxZCcpO1xudmFyIGFsZ29saWEgPSBjbGllbnQuaW5pdEluZGV4KCdzdXBlcnNhYmVyJyk7XG5cbi8qKlxuICogU2VhcmNoIChpbmNsdWRpbmcgdGhlIGluaXRpYWwgbGlzdCBvZiBwb3B1bGFyIHNlYXJjaGVzKS5cbiAqIEF0dGFjaGVkIHRvIHN1cGVyLWtleWJvYXJkLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NlYXJjaCcsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZXZlbnREZXRhaWwgPSB7cXVlcnk6ICcnLCByZXN1bHRzOiBbXX07XG4gICAgdGhpcy5wb3B1bGFySGl0cyA9IG51bGw7XG4gICAgdGhpcy5xdWVyeU9iamVjdCA9IHtoaXRzUGVyUGFnZTogMTAwLCBxdWVyeTogJyd9O1xuXG4gICAgLy8gUG9wdWxhdGUgcG9wdWxhci5cbiAgICB0aGlzLnNlYXJjaCgnJyk7XG5cbiAgICAvLyBMZXNzIGhpdHMgb24gbm9ybWFsIHNlYXJjaGVzLlxuICAgIHRoaXMucXVlcnlPYmplY3QuaGl0c1BlclBhZ2UgPSAzMDtcblxuICAgIHRoaXMuZWwuc2NlbmVFbC5hZGRFdmVudExpc3RlbmVyKCdzZWFyY2hjbGVhcicsICgpID0+IHsgdGhpcy5zZWFyY2goJycpOyB9KTtcbiAgfSxcblxuICBzdXBlcmtleWJvYXJkY2hhbmdlOiBiaW5kRXZlbnQoZnVuY3Rpb24gKGV2dCkge1xuICAgIGlmIChldnQudGFyZ2V0ICE9PSB0aGlzLmVsKSB7IHJldHVybjsgfVxuICAgIHRoaXMuc2VhcmNoKGV2dC5kZXRhaWwudmFsdWUpO1xuICB9KSxcblxuICBzZWFyY2g6IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgIC8vIFVzZSBjYWNoZWQgZm9yIHBvcHVsYXIgaGl0cy5cbiAgICBpZiAoIXF1ZXJ5ICYmIHRoaXMucG9wdWxhckhpdHMpIHtcbiAgICAgIHRoaXMuZXZlbnREZXRhaWwucmVzdWx0cyA9IHRoaXMucG9wdWxhckhpdHM7XG4gICAgICB0aGlzLmV2ZW50RGV0YWlsLnF1ZXJ5ID0gJyc7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc2VhcmNocmVzdWx0cycsIHRoaXMuZXZlbnREZXRhaWwpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZXZlbnREZXRhaWwucXVlcnkgPSBxdWVyeTtcbiAgICB0aGlzLnF1ZXJ5T2JqZWN0LnF1ZXJ5ID0gcXVlcnk7XG4gICAgYWxnb2xpYS5zZWFyY2godGhpcy5xdWVyeU9iamVjdCwgKGVyciwgY29udGVudCkgPT4ge1xuICAgICAgLy8gQ2FjaGUgcG9wdWxhciBoaXRzLlxuICAgICAgaWYgKGVycikge1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc2VhcmNoZXJyb3InLCBudWxsLCBmYWxzZSk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXF1ZXJ5KSB7IHRoaXMucG9wdWxhckhpdHMgPSBjb250ZW50LmhpdHM7IH1cbiAgICAgIHRoaXMuZXZlbnREZXRhaWwucmVzdWx0cyA9IGNvbnRlbnQuaGl0cztcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzZWFyY2hyZXN1bHRzJywgdGhpcy5ldmVudERldGFpbCk7XG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIFNlbGVjdCBnZW5yZSBmaWx0ZXIuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc2VhcmNoLWdlbnJlJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5ldmVudERldGFpbCA9IHtpc0dlbnJlU2VhcmNoOiB0cnVlLCBnZW5yZTogJycsIHJlc3VsdHM6IFtdfTtcbiAgICB0aGlzLnF1ZXJ5T2JqZWN0ID0ge1xuICAgICAgZmlsdGVyczogJycsXG4gICAgICBoaXRzUGVyUGFnZTogMTAwXG4gICAgfTtcblxuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldnQgPT4ge1xuICAgICAgdGhpcy5zZWFyY2goZXZ0LnRhcmdldC5jbG9zZXN0KCcuZ2VucmUnKS5kYXRhc2V0LmJpbmRGb3JLZXkpO1xuICAgIH0pO1xuICB9LFxuXG4gIHNlYXJjaDogZnVuY3Rpb24gKGdlbnJlKSB7XG4gICAgaWYgKGdlbnJlID09PSAnVmlkZW8gR2FtZXMnKSB7XG4gICAgICB0aGlzLnF1ZXJ5T2JqZWN0LmZpbHRlcnMgPSBgZ2VucmU6XCJWaWRlbyBHYW1lXCIgT1IgZ2VucmU6XCJWaWRlbyBHYW1lc1wiYDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5xdWVyeU9iamVjdC5maWx0ZXJzID0gYGdlbnJlOlwiJHtnZW5yZX1cImA7XG4gICAgfVxuICAgIGFsZ29saWEuc2VhcmNoKHRoaXMucXVlcnlPYmplY3QsIChlcnIsIGNvbnRlbnQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3NlYXJjaGVycm9yJywgbnVsbCwgZmFsc2UpO1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5ldmVudERldGFpbC5nZW5yZSA9IGdlbnJlO1xuICAgICAgdGhpcy5ldmVudERldGFpbC5yZXN1bHRzID0gY29udGVudC5oaXRzO1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3NlYXJjaHJlc3VsdHMnLCB0aGlzLmV2ZW50RGV0YWlsKTtcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8qKlxuICogQ2xpY2sgbGlzdGVuZXIgZm9yIHNlYXJjaCByZXN1bHQuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc2VhcmNoLXJlc3VsdC1saXN0Jywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3Qgb2J2ID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIobXV0YXRpb25zID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbXV0YXRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChtdXRhdGlvbnNbaV0uYXR0cmlidXRlTmFtZSA9PT0gJ2RhdGEtaW5kZXgnKSB7XG4gICAgICAgICAgdGhpcy5yZWZyZXNoTGF5b3V0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBvYnYub2JzZXJ2ZSh0aGlzLmVsLCB7YXR0cmlidXRlczogdHJ1ZSwgY2hpbGRMaXN0OiBmYWxzZSwgc3VidHJlZTogdHJ1ZX0pO1xuICB9LFxuXG4gIHJlZnJlc2hMYXlvdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLmVtaXQoJ2xheW91dHJlZnJlc2gnLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgY2xpY2s6IGJpbmRFdmVudChmdW5jdGlvbiAoZXZ0KSB7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ21lbnVjaGFsbGVuZ2VzZWxlY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgIGV2dC50YXJnZXQuY2xvc2VzdCgnLnNlYXJjaFJlc3VsdCcpLmRhdGFzZXQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UpO1xuICB9KVxufSk7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc2VhcmNoLXNvbmctbmFtZS1zZWxlY3RlZCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgYW5jaG9yOiB7ZGVmYXVsdDogMH0sXG4gICAgaW5kZXg6IHtkZWZhdWx0OiAwfSxcbiAgICBvZmZzZXQ6IHtkZWZhdWx0OiAwfSxcbiAgICBzZWxlY3RlZENoYWxsZW5nZUlkOiB7ZGVmYXVsdDogJyd9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG4gICAgZWwub2JqZWN0M0QudmlzaWJsZSA9ICEhZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkICYmIGRhdGEuaW5kZXggIT09IC0xO1xuICAgIGVsLm9iamVjdDNELnBvc2l0aW9uLnkgPSBkYXRhLmluZGV4ICogZGF0YS5vZmZzZXQgKyBkYXRhLmFuY2hvcjtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zZWFyY2guanMiLCJ2YXIgdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xuXG5jb25zdCBQUkVWSUVXX1ZPTFVNRSA9IDAuNTtcblxuLyoqXG4gKiBTb25nIHByZXZpZXcgd2hlbiBzZWFyY2ggcmVzdWx0IHNlbGVjdGVkIHdpdGggc21hcnQgbG9naWMgZm9yIHByZWxvYWRpbmcuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc29uZy1wcmV2aWV3LXN5c3RlbScsIHtcbiAgc2NoZW1hOiB7XG4gICAgY2hhbGxlbmdlSWQ6IHtkZWZhdWx0OiAnJ30sXG4gICAgZGVidWc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaXNTZWFyY2hpbmc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaXNTb25nTG9hZGluZzoge2RlZmF1bHQ6IGZhbHNlfSwgIC8vIENvbnRpbnVlIHRvIHBsYXkgcHJldmlldyBzb25nIGR1cmluZyBsb2FkaW5nLlxuICAgIHNlbGVjdGVkQ2hhbGxlbmdlSWQ6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5hbmFseXNlckVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F1ZGlvQW5hbHlzZXInKTtcbiAgICB0aGlzLmF1ZGlvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXVkaW8nKTsgIC8vIER1bW15LlxuICAgIHRoaXMuYXVkaW9TdG9yZSA9IHt9O1xuICAgIHRoaXMucHJlbG9hZGVkQXVkaW9JZHMgPSBbXTtcbiAgICB0aGlzLnByZWxvYWRRdWV1ZSA9IFtdO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgLy8gUGxheSBjbGlja2VkLlxuICAgIC8vIEJ1dCBkb24ndCBzdGFydCBwbGF5aW5nIGl0IGlmIGl0IHdhc24ndCBwbGF5aW5nIGFscmVhZHkuXG4gICAgaWYgKCFvbGREYXRhLmNoYWxsZW5nZUlkICYmIGRhdGEuY2hhbGxlbmdlSWQpIHtcbiAgICAgIGlmICh0aGlzLmFuYWx5c2VyRWwuY29tcG9uZW50cy5hdWRpb2FuYWx5c2VyLnZvbHVtZSA9PT0gMCB8fFxuICAgICAgICAgIHRoaXMuYXVkaW8uY3VycmVudFRpbWUgPCAxKSB7XG4gICAgICAgIHRoaXMuc3RvcFNvbmcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHRoaXMuZmFkZURvd24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBVbnNlbGVjdC5cbiAgICBpZiAob2xkRGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkICYmICFkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQgJiYgIWRhdGEuaXNTZWFyY2hpbmcpIHtcbiAgICAgIHRoaXMuc3RvcFNvbmcoKTtcbiAgICB9XG5cbiAgICAvLyBTb25nIGZpbmlzaGVkIGxvYWRpbmcuXG4gICAgLy8gQ29udGludWUgdG8gcGxheSBwcmV2aWV3IHNvbmcgZHVyaW5nIGxvYWRpbmcgdG8ga2VlcCBlbnRlcnRhaW5lZC5cbiAgICBpZiAob2xkRGF0YS5pc1NvbmdMb2FkaW5nICYmICFkYXRhLmlzU29uZ0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuc3RvcFNvbmcoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZWxlY3RlZCBjaGFsbGVuZ2UgSUQgdXBkYXRlZC5cbiAgICBpZiAoZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkICYmIG9sZERhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCAhPT0gZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkKSB7XG4gICAgICBpZiAodGhpcy5hdWRpbykgeyB0aGlzLnN0b3BTb25nKCk7IH1cblxuICAgICAgLy8gSWYgbm90IHlldCBwcmVsb2FkZWQsIHBhdXNlIHRoZSBwcmVsb2FkIHF1ZXVlIHVudGlsIHRoaXMgc29uZyBpcyBsb2FkZWQuXG4gICAgICBpZiAoIXRoaXMucHJlbG9hZGVkQXVkaW9JZHMuaW5jbHVkZXMoZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkKSAmJlxuICAgICAgICAgIGRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCAhPT0gdGhpcy5jdXJyZW50TG9hZGluZ0lkKSB7XG4gICAgICAgIHRoaXMucHJpb3JpdGl6ZVByZWxvYWRTb25nKCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucGxheVNvbmcoZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkKTtcbiAgICB9XG4gIH0sXG5cbiAgbG9nOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZGVidWcpIHsgcmV0dXJuOyB9XG4gICAgY29uc29sZS5sb2coc3RyKTtcbiAgfSxcblxuICAvKipcbiAgICogU29uZyB3YXMgc2VsZWN0ZWQgc28gcGF1c2UgcHJlbG9hZCBxdWV1ZSwgcHJpb3JpdGl6ZSBpdHMgbG9hZGluZywgYW5kIHRyeSB0byBwbGF5IEFTQVAuXG4gICAqL1xuICBwcmlvcml0aXplUHJlbG9hZFNvbmc6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGNvbnN0IHByZWxvYWRRdWV1ZSA9IHRoaXMucHJlbG9hZFF1ZXVlO1xuXG4gICAgdGhpcy5sb2coYFtzb25nLXByZXZpZXddIFByaW9yaXRpemluZyBsb2FkaW5nIG9mICR7ZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkfWApO1xuICAgIHRoaXMucHJpb3JpdHlMb2FkaW5nQ2hhbGxlbmdlSWQgPSBkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQ7XG5cbiAgICB0aGlzLmF1ZGlvU3RvcmVbZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkXS5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRkYXRhJywgKCkgPT4ge1xuICAgICAgdGhpcy5sb2coYFtzb25nLXByZXZpZXddIEZpbmlzaGVkIGxvYWQgb2YgcHJpb3JpdHkgJHtkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWR9YCk7XG4gICAgICB0aGlzLnByZWxvYWRlZEF1ZGlvSWRzLnB1c2goZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkKTtcbiAgICAgIHRoaXMucHJpb3JpdHlMb2FkaW5nQ2hhbGxlbmdlSWQgPSAnJztcbiAgICAgIC8vIFJlc3VtZSBwcmVsb2FkaW5nIHF1ZXVlLlxuICAgICAgaWYgKHByZWxvYWRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5sb2coYFtzb25nLXByZXZpZXddIFJlc3VtaW5nIHF1ZXVlIHdpdGggJHtwcmVsb2FkUXVldWVbMF0uY2hhbGxlbmdlSWR9YCk7XG4gICAgICAgIHRoaXMucHJlbG9hZE1ldGFkYXRhKHByZWxvYWRRdWV1ZVswXSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBQcmVsb2FkLlxuICAgIHRoaXMuYXVkaW9TdG9yZVtkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWRdLnNyYyA9XG4gICAgICB1dGlscy5nZXRTM0ZpbGVVcmwoZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkLCAnc29uZy5vZ2cnKTtcblxuICAgIC8vIFJlbW92ZSBmcm9tIHByZWxvYWQgcXVldWUuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcmVsb2FkUXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChwcmVsb2FkUXVldWVbaV0uY2hhbGxlbmdlSWQgPT09IGRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCkge1xuICAgICAgICBwcmVsb2FkUXVldWUuc3BsaWNlKGksIDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhbiBhdWRpbyBlbGVtZW50IGFuZCBxdWV1ZSB0byBwcmVsb2FkLiBJZiB0aGUgcXVldWUgaXMgZW1wdHksIHByZWxvYWQgaXRcbiAgICogaW1tZWRpYXRlbHkuXG4gICAqL1xuICBxdWV1ZVByZWxvYWRTb25nOiBmdW5jdGlvbiAoY2hhbGxlbmdlSWQsIHByZXZpZXdTdGFydFRpbWUpIHtcbiAgICBpZiAodGhpcy5hdWRpb1N0b3JlW2NoYWxsZW5nZUlkXSkgeyByZXR1cm47IH1cblxuICAgIGNvbnN0IGF1ZGlvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXVkaW8nKTtcbiAgICBhdWRpby5jcm9zc09yaWdpbiA9ICdhbm9ueW1vdXMnO1xuICAgIGF1ZGlvLmRhdGFzZXQucHJldmlld1N0YXJ0VGltZSA9IHByZXZpZXdTdGFydFRpbWU7XG4gICAgdGhpcy5hdWRpb1N0b3JlW2NoYWxsZW5nZUlkXSA9IGF1ZGlvO1xuXG4gICAgbGV0IHNyYyA9IHV0aWxzLmdldFMzRmlsZVVybChjaGFsbGVuZ2VJZCwgJ3Nvbmcub2dnJyk7XG4gICAgaWYgKHRoaXMuY3VycmVudExvYWRpbmdJZCkge1xuICAgICAgLy8gQXVkaW8gY3VycmVudGx5IGxvYWRpbmcsIGFkZCB0byBxdWV1ZS5cbiAgICAgIHRoaXMucHJlbG9hZFF1ZXVlLnB1c2goe1xuICAgICAgICBhdWRpbzogYXVkaW8sXG4gICAgICAgIGNoYWxsZW5nZUlkOiBjaGFsbGVuZ2VJZCxcbiAgICAgICAgc3JjOiBzcmNcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBFbXB0eSBxdWV1ZSwgcHJlbG9hZCBub3cuXG4gICAgICB0aGlzLnByZWxvYWRNZXRhZGF0YSh7XG4gICAgICAgIGF1ZGlvOiBhdWRpbyxcbiAgICAgICAgY2hhbGxlbmdlSWQ6IGNoYWxsZW5nZUlkLFxuICAgICAgICBzcmM6IHNyY1xuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBQcmVsb2FkIG1ldGFkYXRhIG9mIGF1ZGlvIGZpbGUgZm9yIHF1aWNrIHBsYXkuXG4gICAqIFNldCBgc3JjYCBhbmQgYHByZWxvYWRgLlxuICAgKiBBIHByZWxvYWQgcXVldWUgaXMgc2V0IHVwIHNvIHdlIG9ubHkgcHJlbG9hZCBvbmUgYXQgYSB0aW1lIHRvIG5vdCBib2cgZG93blxuICAgKiB0aGUgbmV0d29yay4gSWYgYSBzb25nIGlzIHNlbGVjdGVkIHRvIHByZXZpZXcsIHdlIGNhbiBidW1wIGl0IHRvIHRoZSBmcm9udCBvZiB0aGVcbiAgICogcXVldWUuXG4gICAqL1xuICBwcmVsb2FkTWV0YWRhdGE6IGZ1bmN0aW9uIChwcmVsb2FkSXRlbSkge1xuICAgIGNvbnN0IGF1ZGlvID0gcHJlbG9hZEl0ZW0uYXVkaW87XG4gICAgdGhpcy5sb2coYFtzb25nLXByZXZpZXddIFByZWxvYWRpbmcgc29uZyBwcmV2aWV3ICR7cHJlbG9hZEl0ZW0uY2hhbGxlbmdlSWR9YCk7XG5cbiAgICBhdWRpby5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsICgpID0+IHtcbiAgICAgIC8vIFNvbmcgcHJlbG9hZGVkLlxuICAgICAgdGhpcy5sb2coYFtzb25nLXByZXZpZXddIEZpbmlzaGVkIHByZWxvYWRpbmcgc29uZyBwcmV2aWV3ICR7cHJlbG9hZEl0ZW0uY2hhbGxlbmdlSWR9YCk7XG4gICAgICB0aGlzLnByZWxvYWRlZEF1ZGlvSWRzLnB1c2gocHJlbG9hZEl0ZW0uY2hhbGxlbmdlSWQpO1xuICAgICAgdGhpcy5jdXJyZW50TG9hZGluZ0lkID0gJyc7XG5cbiAgICAgIC8vIE1vdmUgb24gdG8gbmV4dCBzb25nIGluIHF1ZXVlIGlmIGFueS5cbiAgICAgIHRoaXMubG9nKGBbc29uZy1wcmV2aWV3XSAke3RoaXMucHJlbG9hZFF1ZXVlLmxlbmd0aH0gaW4gcXVldWVgKTtcbiAgICAgIGlmICh0aGlzLnByZWxvYWRRdWV1ZS5sZW5ndGggJiYgIXRoaXMucHJpb3JpdHlMb2FkaW5nQ2hhbGxlbmdlSWQpIHtcbiAgICAgICAgdGhpcy5wcmVsb2FkTWV0YWRhdGEodGhpcy5wcmVsb2FkUXVldWUuc2hpZnQoKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBhdWRpby5wcmVsb2FkID0gJ21ldGFkYXRhJztcbiAgICBhdWRpby5zcmMgPSBwcmVsb2FkSXRlbS5zcmM7XG4gICAgdGhpcy5jdXJyZW50TG9hZGluZ0lkID0gcHJlbG9hZEl0ZW0uY2hhbGxlbmdlSWQ7XG4gIH0sXG5cbiAgc3RvcFNvbmc6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuYXVkaW8pIHsgcmV0dXJuOyB9XG4gICAgaWYgKCF0aGlzLmF1ZGlvLnBhdXNlZCkgeyB0aGlzLmF1ZGlvLnBhdXNlKCk7IH1cbiAgfSxcblxuICBwbGF5U29uZzogZnVuY3Rpb24gKGNoYWxsZW5nZUlkKSB7XG4gICAgaWYgKCFjaGFsbGVuZ2VJZCkgeyByZXR1cm47IH1cblxuICAgIHRoaXMuYXVkaW8gPSB0aGlzLmF1ZGlvU3RvcmVbY2hhbGxlbmdlSWRdO1xuICAgIHRoaXMuYXVkaW8ubG9hZCgpO1xuICAgIHRoaXMuYXVkaW8udm9sdW1lID0gUFJFVklFV19WT0xVTUU7XG4gICAgdGhpcy5hdWRpby5jdXJyZW50VGltZSA9IHRoaXMuYXVkaW8uZGF0YXNldC5wcmV2aWV3U3RhcnRUaW1lO1xuICAgIHRoaXMuYW5hbHlzZXJFbC5zZXRBdHRyaWJ1dGUoJ2F1ZGlvYW5hbHlzZXInLCAnc3JjJywgdGhpcy5hdWRpbyk7XG5cbiAgICBjb25zdCBhdWRpb2FuYWx5c2VyID0gdGhpcy5hbmFseXNlckVsLmNvbXBvbmVudHMuYXVkaW9hbmFseXNlcjtcbiAgICBhdWRpb2FuYWx5c2VyLnJlc3VtZUNvbnRleHQoKTtcblxuICAgIHRoaXMuYXVkaW8ucGxheSgpO1xuICAgIC8vIHRoaXMuZmFkZUluKCk7XG5cbiAgICAvLyBQcmVmZXRjaCBidWZmZXIgZm9yIHBsYXlpbmcuXG4gICAgaWYgKGF1ZGlvYW5hbHlzZXIueGhyKSB7IGF1ZGlvYW5hbHlzZXIueGhyLmFib3J0KCk7IH1cbiAgICBhdWRpb2FuYWx5c2VyLmZldGNoQXVkaW9CdWZmZXIodXRpbHMuZ2V0UzNGaWxlVXJsKGNoYWxsZW5nZUlkLCAnc29uZy5vZ2cnKSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFN0b3Agc29uZyBmcm9tIHByZWxvYWRpbmcuXG4gICAqL1xuICBjbGVhclNvbmc6IGZ1bmN0aW9uIChjaGFsbGVuZ2VJZCkge1xuICAgIGxldCBhdWRpbyA9IHRoaXMuYXVkaW9TdG9yZVtjaGFsbGVuZ2VJZF07XG4gICAgYXVkaW8ucHJlbG9hZCA9ICdub25lJztcblxuICAgIC8vIFJlbW92ZSBmcm9tIHF1ZXVlIGlmIGluIHRoZXJlLlxuICAgIGxldCBpbmRleDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucHJlbG9hZFF1ZXVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5wcmVsb2FkUXVldWVbaV0uaWQgPT09IGNoYWxsZW5nZUlkKSB7XG4gICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghaW5kZXgpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5wcmVsb2FkUXVldWUuc3BsaWNlKGluZGV4LCAxKTtcbiAgfVxufSk7XG5cbi8qKlxuICogRGF0YSBjb21wb25lbnQgYXR0YWNoZWQgdG8gc2VhcmNoIHJlc3VsdCBmb3Igc29uZyBwcmV2aWV3IHN5c3RlbS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzb25nLXByZXZpZXcnLCB7XG4gIHNjaGVtYToge1xuICAgIGNoYWxsZW5nZUlkOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIHByZXZpZXdTdGFydFRpbWU6IHt0eXBlOiAnbnVtYmVyJ31cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgaWYgKG9sZERhdGEuY2hhbGxlbmdlSWQgJiYgdGhpcy5kYXRhLmNoYWxsZW5nZUlkICE9PSBvbGREYXRhLmNoYWxsZW5nZUlkKSB7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50c1snc29uZy1wcmV2aWV3LXN5c3RlbSddLmNsZWFyU29uZyhvbGREYXRhLmNoYWxsZW5nZUlkKTtcbiAgICB9XG5cbiAgICB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50c1snc29uZy1wcmV2aWV3LXN5c3RlbSddLnF1ZXVlUHJlbG9hZFNvbmcoXG4gICAgICB0aGlzLmRhdGEuY2hhbGxlbmdlSWQsIHRoaXMuZGF0YS5wcmV2aWV3U3RhcnRUaW1lXG4gICAgKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zb25nLXByZXZpZXcuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NvbmctcHJvZ3Jlc3MtcmluZycsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ2dlb21ldHJ5JywgJ21hdGVyaWFsJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnRpY2sgPSBBRlJBTUUudXRpbHMudGhyb3R0bGVUaWNrKHRoaXMudGljay5iaW5kKHRoaXMpLCAxMDAwKTtcblxuICAgIHRoaXMucHJvZ3Jlc3MgPSB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwudW5pZm9ybXMucHJvZ3Jlc3M7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsZWFyZ2FtZScsICgpID0+IHtcbiAgICAgIHRoaXMucHJvZ3Jlc3MudmFsdWUgPSAwO1xuICAgIH0pO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB0aGlzLnByb2dyZXNzLnZhbHVlID0gMDtcbiAgfSxcblxuICB1cGRhdGVSaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3Qgc291cmNlID0gdGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHMuc29uZy5zb3VyY2U7XG4gICAgaWYgKCFzb3VyY2UpIHsgcmV0dXJuOyB9XG5cbiAgICBjb25zdCBwcm9ncmVzcyA9XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50cy5zb25nLmdldEN1cnJlbnRUaW1lKCkgL1xuICAgICAgc291cmNlLmJ1ZmZlci5kdXJhdGlvbjtcbiAgICB0aGlzLnByb2dyZXNzLnZhbHVlID0gcHJvZ3Jlc3M7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy51cGRhdGVSaW5nKCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc29uZy1wcm9ncmVzcy1yaW5nLmpzIiwiY29uc3QgdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xuXG5jb25zdCBHQU1FX09WRVJfTEVOR1RIID0gMy41O1xuY29uc3QgT05DRSA9IHtvbmNlOiB0cnVlfTtcbmNvbnN0IEJBU0VfVk9MVU1FID0gMC43NTtcblxubGV0IHNraXBEZWJ1ZyA9IEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ3NraXAnKTtcbmlmICghIXNraXBEZWJ1ZykgeyBza2lwRGVidWcgPSBwYXJzZUludChza2lwRGVidWcpIC8gMTAwMDsgfVxuXG4vKipcbiAqIEFjdGl2ZSBjaGFsbGVuZ2Ugc29uZyAvIGF1ZGlvLlxuICpcbiAqIE9yZGVyIG9mIHNvbmcgaW5pdCBpbiBjb25qdWN0aW9uIHdpdGggYmVhdC1sb2FkZXI6XG4gKlxuICogMS4gcHJldmlld1N0YXJ0VGltZSBpcyBwbGF5aW5nXG4gKiAyLiBzb25nbG9hZGZpbmlzaFxuICogMy4gYmVhdC1sb2FkZXIgcHJlbG9hZGluZ1xuICogNC4gcHJlbG9hZGVkIGJlYXRzIGdlbmVyYXRlZFxuICogNS4gYmVhdC1sb2FkZXIgcHJlbG9hZGluZyBmaW5pc2hcbiAqIDYuIHN0YXJ0QXVkaW8gLyBzb25nU3RhcnRUaW1lIGlzIHNldFxuICogNy4gYmVhdC1sb2FkZXIgY29udGludWVzIG9mZiBzb25nIGN1cnJlbnQgdGltZVxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NvbmcnLCB7XG4gIHNjaGVtYToge1xuICAgIGFuYWx5c2VyRWw6IHt0eXBlOiAnc2VsZWN0b3InLCBkZWZhdWx0OiAnI2F1ZGlvQW5hbHlzZXInfSxcbiAgICBjaGFsbGVuZ2VJZDoge2RlZmF1bHQ6ICcnfSxcbiAgICBpc0JlYXRzUHJlbG9hZGVkOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGlzR2FtZU92ZXI6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaXNQbGF5aW5nOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGlzVmljdG9yeToge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmFuYWx5c2VyU2V0dGVyID0ge2J1ZmZlcjogdHJ1ZX07XG4gICAgdGhpcy5hdWRpb0FuYWx5c2VyID0gdGhpcy5kYXRhLmFuYWx5c2VyRWwuY29tcG9uZW50cy5hdWRpb2FuYWx5c2VyO1xuICAgIHRoaXMuY29udGV4dCA9IHRoaXMuYXVkaW9BbmFseXNlci5jb250ZXh0O1xuICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XG4gICAgdGhpcy5zb25nTG9hZGluZ0luZGljYXRvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb25nTG9hZGluZ0luZGljYXRvcicpO1xuICAgIHRoaXMuc29uZ1N0YXJ0VGltZSA9IDA7XG5cbiAgICB0aGlzLnZpY3RvcnkgPSB0aGlzLnZpY3RvcnkuYmluZCh0aGlzKTtcblxuICAgIC8vIEJhc2Ugdm9sdW1lLlxuICAgIHRoaXMuYXVkaW9BbmFseXNlci5nYWluTm9kZS5nYWluLnZhbHVlID0gQkFTRV9WT0xVTUU7XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2dhbWVtZW51cmVzdGFydCcsIHRoaXMub25SZXN0YXJ0LmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignd2FsbGhpdHN0YXJ0JywgdGhpcy5vbldhbGxIaXRTdGFydC5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3dhbGxoaXRlbmQnLCB0aGlzLm9uV2FsbEhpdEVuZC5iaW5kKHRoaXMpKTtcblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3ZpY3RvcnlmYWtlJywgKCkgPT4ge1xuICAgICAgICB0aGlzLnNvdXJjZS5zdG9wKCk7XG4gICAgICAgIHRoaXMuc291cmNlLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgdGhpcy52aWN0b3J5KCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgLy8gR2FtZSBvdmVyLCBzbG93IGRvd24gYXVkaW8sIGFuZCB0aGVuIHN0b3AuXG4gICAgaWYgKCFvbGREYXRhLmlzR2FtZU92ZXIgJiYgZGF0YS5pc0dhbWVPdmVyKSB7XG4gICAgICB0aGlzLm9uR2FtZU92ZXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAob2xkRGF0YS5pc0dhbWVPdmVyICYmICFkYXRhLmlzR2FtZU92ZXIpIHtcbiAgICAgIHRoaXMuYXVkaW9BbmFseXNlci5nYWluTm9kZS52YWx1ZSA9IEJBU0VfVk9MVU1FO1xuICAgIH1cblxuICAgIC8vIE9uIHZpY3Rvcnkgc2NyZWVuLCBwbGF5IHNvbmcgaW4gYmFja2dyb3VuZC5cbiAgICBpZiAoIW9sZERhdGEuaXNWaWN0b3J5ICYmIGRhdGEuaXNWaWN0b3J5KSB7XG4gICAgICB0aGlzLmRhdGEuYW5hbHlzZXJFbC5hZGRFdmVudExpc3RlbmVyKCdhdWRpb2FuYWx5c2VyYnVmZmVyc291cmNlJywgZXZ0ID0+IHtcbiAgICAgICAgdGhpcy5hdWRpb0FuYWx5c2VyLnJlc3VtZUNvbnRleHQoKTtcbiAgICAgICAgY29uc3QgZ2FpbiA9IHRoaXMuYXVkaW9BbmFseXNlci5nYWluTm9kZS5nYWluO1xuICAgICAgICBnYWluLmNhbmNlbFNjaGVkdWxlZFZhbHVlcygwKTtcbiAgICAgICAgZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLjA1LCAwKTtcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBldnQuZGV0YWlsO1xuICAgICAgICB0aGlzLnNvdXJjZS5zdGFydCgpO1xuICAgICAgfSwgT05DRSk7XG4gICAgICB0aGlzLmF1ZGlvQW5hbHlzZXIucmVmcmVzaFNvdXJjZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIE5ldyBjaGFsbGVuZ2UsIHBsYXkgaWYgd2UgaGF2ZSBsb2FkZWQgYW5kIHdlcmUgd2FpdGluZyBmb3IgYmVhdHMgdG8gcHJlbG9hZC5cbiAgICBpZiAoIW9sZERhdGEuaXNCZWF0c1ByZWxvYWRlZCAmJiB0aGlzLmRhdGEuaXNCZWF0c1ByZWxvYWRlZCAmJiB0aGlzLnNvdXJjZSkge1xuICAgICAgdGhpcy5zdGFydEF1ZGlvKCk7XG4gICAgfVxuXG4gICAgaWYgKG9sZERhdGEuY2hhbGxlbmdlSWQgJiYgIWRhdGEuY2hhbGxlbmdlSWQpIHtcbiAgICAgIHRoaXMuc3RvcEF1ZGlvKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gTmV3IGNoYWxsZW5nZSwgbG9hZCBhdWRpbyBhbmQgcGxheSB3aGVuIHJlYWR5LlxuICAgIGlmIChvbGREYXRhLmNoYWxsZW5nZUlkICE9PSBkYXRhLmNoYWxsZW5nZUlkICYmIGRhdGEuY2hhbGxlbmdlSWQpIHtcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzb25nbG9hZHN0YXJ0JywgbnVsbCwgZmFsc2UpO1xuICAgICAgdGhpcy5nZXRBdWRpbygpLnRoZW4oc291cmNlID0+IHtcbiAgICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3Nvbmdsb2FkZmluaXNoJywgbnVsbCwgZmFsc2UpO1xuICAgICAgfSkuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gICAgfVxuXG4gICAgLy8gUGF1c2UgLyBzdG9wLlxuICAgIGlmIChvbGREYXRhLmlzUGxheWluZyAmJiAhZGF0YS5pc1BsYXlpbmcpIHtcbiAgICAgIHRoaXMuYXVkaW9BbmFseXNlci5zdXNwZW5kQ29udGV4dCgpO1xuICAgIH1cblxuICAgIC8vIFJlc3VtZS5cbiAgICBpZiAoIW9sZERhdGEuaXNQbGF5aW5nICYmIGRhdGEuaXNQbGF5aW5nICYmIHRoaXMuc291cmNlKSB7XG4gICAgICB0aGlzLmF1ZGlvQW5hbHlzZXIucmVzdW1lQ29udGV4dCgpO1xuICAgIH1cbiAgfSxcblxuICBnZXRBdWRpbzogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgIGRhdGEuYW5hbHlzZXJFbC5hZGRFdmVudExpc3RlbmVyKCdhdWRpb2FuYWx5c2VyYnVmZmVyc291cmNlJywgZXZ0ID0+IHtcbiAgICAgICAgLy8gRmluaXNoZWQgZGVjb2RpbmcuXG4gICAgICAgIHRoaXMuc291cmNlID0gZXZ0LmRldGFpbDtcbiAgICAgICAgcmVzb2x2ZSh0aGlzLnNvdXJjZSk7XG4gICAgICB9LCBPTkNFKTtcbiAgICAgIHRoaXMuYW5hbHlzZXJTZXR0ZXIuc3JjID0gdXRpbHMuZ2V0UzNGaWxlVXJsKGRhdGEuY2hhbGxlbmdlSWQsICdzb25nLm9nZycpO1xuICAgICAgZGF0YS5hbmFseXNlckVsLnNldEF0dHJpYnV0ZSgnYXVkaW9hbmFseXNlcicsIHRoaXMuYW5hbHlzZXJTZXR0ZXIpO1xuXG4gICAgICAvLyBBbHJlYWR5IGxvYWRlZC5cbiAgICAgIGlmICh0aGlzLmF1ZGlvQW5hbHlzZXIueGhyLnJlc3BvbnNlKSB7XG4gICAgICAgIHRoaXMuc29uZ0xvYWRpbmdJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsICdwcm9ncmVzcycsIDEpO1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc29uZ2ZldGNoZmluaXNoJywgbnVsbCwgZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYXVkaW9BbmFseXNlci54aHIuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBldnQgPT4ge1xuICAgICAgICB0aGlzLm9uRmV0Y2hQcm9ncmVzcyhldnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgc3RvcEF1ZGlvOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnNvdXJjZSkge1xuICAgICAgY29uc29sZS53YXJuKCdbc29uZ10gVHJpZWQgdG8gc3RvcEF1ZGlvLCBidXQgbm90IHBsYXlpbmcuJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc291cmNlLnN0b3AoKTtcbiAgICB0aGlzLnNvdXJjZS5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XG4gIH0sXG5cbiAgdmljdG9yeTogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmlzUGxheWluZykgeyByZXR1cm47IH1cbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgndmljdG9yeScsIG51bGwsIGZhbHNlKTtcbiAgfSxcblxuICBvbkZldGNoUHJvZ3Jlc3M6IGZ1bmN0aW9uIChldnQpIHtcbiAgICBjb25zdCBwcm9ncmVzcyA9IGV2dC5sb2FkZWQgLyBldnQudG90YWw7XG4gICAgdGhpcy5zb25nTG9hZGluZ0luZGljYXRvci5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3Byb2dyZXNzJywgcHJvZ3Jlc3MpO1xuICAgIGlmIChwcm9ncmVzcyA+PSAxKSB7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc29uZ2ZldGNoZmluaXNoJywgbnVsbCwgZmFsc2UpO1xuICAgIH1cbiAgfSxcblxuICBvbkdhbWVPdmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcblxuICAgIC8vIFBsYXliYWNrIHJhdGUuXG4gICAgY29uc3QgcGxheWJhY2tSYXRlID0gdGhpcy5zb3VyY2UucGxheWJhY2tSYXRlO1xuICAgIHBsYXliYWNrUmF0ZS5zZXRWYWx1ZUF0VGltZShwbGF5YmFja1JhdGUudmFsdWUsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSk7XG4gICAgcGxheWJhY2tSYXRlLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKDAsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSArIEdBTUVfT1ZFUl9MRU5HVEgpO1xuXG4gICAgLy8gR2Fpbi5cbiAgICBjb25zdCBnYWluID0gdGhpcy5hdWRpb0FuYWx5c2VyLmdhaW5Ob2RlLmdhaW47XG4gICAgZ2Fpbi5zZXRWYWx1ZUF0VGltZShnYWluLnZhbHVlLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpO1xuICAgIGdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoMCwgdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lICsgR0FNRV9PVkVSX0xFTkdUSCk7XG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmICghdGhpcy5kYXRhLmlzR2FtZU92ZXIpIHsgcmV0dXJuOyB9XG4gICAgICB0aGlzLnN0b3BBdWRpbygpO1xuICAgIH0sIDM1MDApO1xuICB9LFxuXG4gIG9uUmVzdGFydDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XG5cbiAgICAvLyBSZXN0YXJ0LCBnZXQgbmV3IGJ1ZmZlciBzb3VyY2Ugbm9kZSBhbmQgcGxheS5cbiAgICBpZiAodGhpcy5zb3VyY2UpIHsgdGhpcy5zb3VyY2UuZGlzY29ubmVjdCgpOyB9XG5cbiAgICAvLyBDbGVhciBnYWluIGludGVycG9sYXRpb24gdmFsdWVzIGZyb20gZ2FtZSBvdmVyLlxuICAgIGNvbnN0IGdhaW4gPSB0aGlzLmF1ZGlvQW5hbHlzZXIuZ2Fpbk5vZGUuZ2FpbjtcbiAgICBnYWluLmNhbmNlbFNjaGVkdWxlZFZhbHVlcygwKTtcblxuICAgIHRoaXMuZGF0YS5hbmFseXNlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2F1ZGlvYW5hbHlzZXJidWZmZXJzb3VyY2UnLCBldnQgPT4ge1xuICAgICAgdGhpcy5zb3VyY2UgPSBldnQuZGV0YWlsO1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3Nvbmdsb2FkZmluaXNoJywgbnVsbCwgZmFsc2UpO1xuICAgIH0sIE9OQ0UpO1xuICAgIHRoaXMuYXVkaW9BbmFseXNlci5yZWZyZXNoU291cmNlKCk7XG4gIH0sXG5cbiAgb25XYWxsSGl0U3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBnYWluID0gdGhpcy5hdWRpb0FuYWx5c2VyLmdhaW5Ob2RlLmdhaW47XG4gICAgZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSgwLjIsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSArIDAuMSk7XG4gIH0sXG5cbiAgb25XYWxsSGl0RW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZ2FpbiA9IHRoaXMuYXVkaW9BbmFseXNlci5nYWluTm9kZS5nYWluO1xuICAgIGdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoQkFTRV9WT0xVTUUsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSArIDAuMSk7XG4gIH0sXG5cbiAgc3RhcnRBdWRpbzogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGdhaW4gPSB0aGlzLmF1ZGlvQW5hbHlzZXIuZ2Fpbk5vZGUuZ2FpbjtcbiAgICBnYWluLnNldFZhbHVlQXRUaW1lKEJBU0VfVk9MVU1FLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpO1xuICAgIHRoaXMuc29uZ1N0YXJ0VGltZSA9IHRoaXMuY29udGV4dC5jdXJyZW50VGltZTtcbiAgICB0aGlzLnNvdXJjZS5vbmVuZGVkID0gdGhpcy52aWN0b3J5O1xuICAgIHRoaXMuc291cmNlLnN0YXJ0KDAsIHNraXBEZWJ1Zyk7XG4gICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xuICB9LFxuXG4gIGdldEN1cnJlbnRUaW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSAtIHRoaXMuc29uZ1N0YXJ0VGltZTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zb25nLmpzIiwiZnVuY3Rpb24gJCAoaWQpIHsgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsgfTtcblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzdGFnZS1jb2xvcnMnLCB7XG4gIGRlcGVuZGVuY2llczogWydiYWNrZ3JvdW5kJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgY29sb3I6IHtkZWZhdWx0OiAnYmx1ZScsIG9uZU9mOiBbJ2JsdWUnLCAncmVkJ119XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY29sb3JDb2RlcyA9IFsnb2ZmJywgJ2JsdWUnLCAnYmx1ZScsICdibHVlZmFkZScsICcnLCAncmVkJywgJ3JlZCcsICdyZWRmYWRlJ107XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGVhcmdhbWUnLCB0aGlzLnJlc2V0Q29sb3JzLmJpbmQodGhpcykpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB0aGlzLnVwZGF0ZUNvbG9ycyh0aGlzLmRhdGEuY29sb3IpO1xuICB9LFxuXG4gIHNldENvbG9yOiBmdW5jdGlvbiAodGFyZ2V0LCBjb2RlKSB7XG4gICAgdGhpcy5lbC5lbWl0KGAke3RhcmdldH1jb2xvciR7dGhpcy5jb2xvckNvZGVzW2NvZGVdfWAsIG51bGwsIGZhbHNlKTtcbiAgfSxcblxuICByZXNldENvbG9yczogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMudXBkYXRlQ29sb3JzKCdibHVlJyk7XG4gICAgdGhpcy5lbC5lbWl0KCdiZ2NvbG9yYmx1ZScsIG51bGwsIGZhbHNlKTtcbiAgICB0aGlzLmVsLmVtaXQoJ3R1bm5lbGNvbG9ycmVkJywgbnVsbCwgZmFsc2UpO1xuICAgIHRoaXMuZWwuZW1pdCgnZmxvb3Jjb2xvcnJlZCcsIG51bGwsIGZhbHNlKTtcbiAgICB0aGlzLmVsLmVtaXQoJ2xlZnRsYXNlcmNvbG9yYmx1ZScsIG51bGwsIGZhbHNlKTtcbiAgICB0aGlzLmVsLmVtaXQoJ3JpZ2h0bGFzZXJjb2xvcmJsdWUnLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgdXBkYXRlQ29sb3JzOiBmdW5jdGlvbiAoY29sb3IpIHtcbiAgfVxuXG4vKlxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5uZW9uUmVkID0gbmV3IFRIUkVFLkNvbG9yKDB4ZmY5OTk5KTtcbiAgICB0aGlzLm5lb25CbHVlID0gbmV3IFRIUkVFLkNvbG9yKDB4OTk5OWZmKTtcbiAgICB0aGlzLmRlZmF1bHRSZWQgPSBuZXcgVEhSRUUuQ29sb3IoMHhmZjAwMDApO1xuICAgIHRoaXMuZGVmYXVsdEJsdWUgPSBuZXcgVEhSRUUuQ29sb3IoMHgwMDAwZmYpO1xuICAgIHRoaXMubWluZUVudk1hcCA9IHtcbiAgICAgIHJlZDogbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKCdhc3NldHMvaW1nL21pbmVlbnZpcm8tcmVkLmpwZycsICgpID0+IHtcbiAgICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ21pbmVyZWRlbnZtYXBsb2FkZWQnLCBudWxsLCBmYWxzZSk7XG4gICAgICB9KSxcbiAgICAgIGJsdWU6IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZCgnYXNzZXRzL2ltZy9taW5lZW52aXJvLWJsdWUuanBnJywgKCkgPT4ge1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbWluZWJsdWVlbnZtYXBsb2FkZWQnLCBudWxsLCBmYWxzZSk7XG4gICAgICB9KVxuICAgIH07XG4gICAgdGhpcy5taW5lQ29sb3IgPSB7cmVkOiBuZXcgVEhSRUUuQ29sb3IoMHgwNzAzMDQpLCBibHVlOiBuZXcgVEhSRUUuQ29sb3IoMHgwMzA0MDcpfTtcbiAgICB0aGlzLm1pbmVFbWlzc2lvbiA9IHtyZWQ6IG5ldyBUSFJFRS5Db2xvcigweDA5MDcwNyksIGJsdWU6IG5ldyBUSFJFRS5Db2xvcigweDA3MDcwOSl9O1xuICAgIHRoaXMubWluZU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHtcbiAgICAgIHJvdWdobmVzczogMC4zOCxcbiAgICAgIG1ldGFsbmVzczogMC40OCxcbiAgICAgIGNvbG9yOiB0aGlzLm1pbmVDb2xvclt0aGlzLmRhdGEuY29sb3JdLFxuICAgICAgZW1pc3NpdmU6IHRoaXMubWluZUVtaXNzaW9uW3RoaXMuZGF0YS5jb2xvcl0sXG4gICAgICBlbnZNYXA6IHRoaXMubWluZUVudk1hcFt0aGlzLmRhdGEuY29sb3JdXG4gICAgfSk7XG4gICAgdGhpcy5za3kgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2t5Jyk7XG4gICAgdGhpcy5hdXhDb2xvciA9IG5ldyBUSFJFRS5Db2xvcigpO1xuXG4gICAgdGhpcy50YXJnZXRzID0ge307XG4gICAgWydzdGFnZU5vcm1hbCcsXG4gICAgICd0dW5uZWxOZW9uJyxcbiAgICAgJ2xlZnRTdGFnZUxhc2VyMCcsXG4gICAgICdsZWZ0U3RhZ2VMYXNlcjEnLFxuICAgICAnbGVmdFN0YWdlTGFzZXIyJyxcbiAgICAgJ3JpZ2h0U3RhZ2VMYXNlcjAnLFxuICAgICAncmlnaHRTdGFnZUxhc2VyMScsXG4gICAgICdyaWdodFN0YWdlTGFzZXIyJyxcbiAgICAgJ2Zsb29yJyxcbiAgICAgJ3N0YWdlTmVvbiddLmZvckVhY2goaWQgPT4ge1xuICAgICAgICB0aGlzLnRhcmdldHNbaWRdID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgICB9KTtcblxuICAgIHRoaXMuY29sb3JDb2RlcyA9IFsnb2ZmJywgJ2JsdWUnLCAnYmx1ZScsICdibHVlZmFkZScsICcnLCAncmVkJywgJ3JlZCcsICdyZWRmYWRlJ107XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsZWFyZ2FtZScsIHRoaXMucmVzZXRDb2xvcnMuYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHRoaXMudXBkYXRlQ29sb3JzKHRoaXMuZGF0YS5jb2xvcik7XG4gIH0sXG5cbiAgc2V0Q29sb3I6IGZ1bmN0aW9uICh0YXJnZXQsIGNvZGUpIHtcbiAgICBjb25zdCBtZXNoID0gdGhpcy50YXJnZXRzW3RhcmdldF0uZ2V0T2JqZWN0M0QoJ21lc2gnKTtcbiAgICBpZiAobWVzaCkgeyBtZXNoLm1hdGVyaWFsLm9wYWNpdHkgPSAxOyB9XG4gICAgdGhpcy50YXJnZXRzW3RhcmdldF0uZW1pdCgnY29sb3InICsgdGhpcy5jb2xvckNvZGVzW2NvZGVdLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgcmVzZXRDb2xvcnM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnVwZGF0ZUNvbG9ycygnYmx1ZScpO1xuICAgIGZvciAobGV0IHRhcmdldCBpbiB0aGlzLnRhcmdldHMpIHtcbiAgICAgIHRoaXMudGFyZ2V0c1t0YXJnZXRdLmVtaXQoJ2NvbG9yYmx1ZScsIG51bGwsIGZhbHNlKTtcbiAgICB9XG4gIH0sXG5cbiAgdXBkYXRlQ29sb3JzOiBmdW5jdGlvbiAoY29sb3IpIHtcbiAgICBjb25zdCByZWQgPSBjb2xvciA9PT0gJ3JlZCc7XG5cbiAgICB0aGlzLnNreS5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLmNvbG9yLnNldChyZWQgPyAnI2YxMCcgOiAnIzAwYWNmYycpO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5vYmplY3QzRC5iYWNrZ3JvdW5kLnNldChyZWQgPyAnIzc3MDEwMCcgOiAnIzE1MjUyZCcpO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5vYmplY3QzRC5mb2cuY29sb3Iuc2V0KHJlZCA/ICcjYTAwJyA6ICcjMDA3Y2I5Jyk7XG5cbiAgICB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbHMubmVvbi5jb2xvciA9IHJlZCA/IHRoaXMubmVvblJlZCA6IHRoaXMubmVvbkJsdWU7XG4gICAgdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMubWF0ZXJpYWxzLmRlZmF1bHQuY29sb3IgPSByZWQgPyB0aGlzLmRlZmF1bHRSZWQgOiB0aGlzLmRlZmF1bHRCbHVlO1xuXG4gICAgdGhpcy5taW5lTWF0ZXJpYWwuY29sb3IgPSB0aGlzLm1pbmVDb2xvcltyZWQgPyAncmVkJyA6ICdibHVlJ107XG4gICAgdGhpcy5taW5lTWF0ZXJpYWwuZW1pc3NpdmUgPSB0aGlzLm1pbmVFbWlzc2lvbltyZWQgPyAncmVkJyA6ICdibHVlJ107XG4gICAgdGhpcy5taW5lTWF0ZXJpYWwuZW52TWFwID0gdGhpcy5taW5lRW52TWFwW3JlZCA/ICdyZWQnIDogJ2JsdWUnXTtcbiAgICB0aGlzLm1pbmVNYXRlcmlhbC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gIH1cblxuICAqL1xufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zdGFnZS1jb2xvcnMuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3N0YWdlLWxhc2VycycsIHtcbiAgc2NoZW1hOiB7XG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IHRydWV9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc3BlZWQgPSAwO1xuICAgIHRoaXMubGFzZXJzID0gW1xuICAgICAgdGhpcy5lbC5jaGlsZHJlblswXS5vYmplY3QzRCxcbiAgICAgIHRoaXMuZWwuY2hpbGRyZW5bMV0ub2JqZWN0M0QsXG4gICAgICB0aGlzLmVsLmNoaWxkcmVuWzJdLm9iamVjdDNEXG4gICAgXTtcbiAgfSxcblxuICBwdWxzZTogZnVuY3Rpb24gKHNwZWVkKSB7XG4gICAgdGhpcy5zcGVlZCA9IHNwZWVkIC8gODtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICBpZiAodGhpcy5zcGVlZCA9PT0gMCkgeyByZXR1cm47IH1cbiAgICBkZWx0YSAvPSAxMDAwO1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuc3BlZWQgKj0gMC45NztcbiAgICAgIGlmIChNYXRoLmFicyh0aGlzLnNwZWVkKSA8IDAuMDEpIHtcbiAgICAgICAgdGhpcy5zcGVlZCA9IDA7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5sYXNlcnNbMF0ucm90YXRpb24ueiArPSB0aGlzLnNwZWVkICogZGVsdGE7XG4gICAgdGhpcy5sYXNlcnNbMV0ucm90YXRpb24ueiAtPSB0aGlzLnNwZWVkICogZGVsdGEgKiAxLjAxO1xuICAgIHRoaXMubGFzZXJzWzJdLnJvdGF0aW9uLnogKz0gdGhpcy5zcGVlZCAqIGRlbHRhICogMS4wMjtcbiAgfVxufSlcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3N0YWdlLWxhc2Vycy5qcyIsIkFGUkFNRS5yZWdpc3RlclNoYWRlcignc3RhZ2VTaGFkZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGNvbG9yOiB7dHlwZTogJ3ZlYzMnLCBpczogJ3VuaWZvcm0nLCBkZWZhdWx0OiB7eDogMCwgeTogMCwgejogMH19LFxuICAgIGZvZ0NvbG9yOiB7dHlwZTogJ3ZlYzMnLCBpczogJ3VuaWZvcm0nLCBkZWZhdWx0OiB7eDogMCwgeTogMC40OCwgejogMC43Mn19LFxuICAgIHNyYzoge3R5cGU6ICdtYXAnLCBpczogJ3VuaWZvcm0nfSxcblxuICB9LFxuXG4gIHZlcnRleFNoYWRlcjogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHV2cy54eSA9IHV2Lnh5O1xuICAgICAgdmVjNCBwID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcbiAgICAgIHdvcmxkUG9zID0gKG1vZGVsTWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApKS54eXo7XG4gICAgICBnbF9Qb3NpdGlvbiA9IHA7XG4gICAgfVxuICBgLFxuXG4gIGZyYWdtZW50U2hhZGVyOiBgXG4gICAgI2RlZmluZSBGT0dfUkFESVVTICA1MC4wXG4gICAgI2RlZmluZSBGT0dfRkFMTE9GRiA0NS4wXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdW5pZm9ybSB2ZWMzIGNvbG9yO1xuICAgIHVuaWZvcm0gdmVjMyBmb2dDb2xvcjtcbiAgICB1bmlmb3JtIHNhbXBsZXIyRCBzcmM7XG5cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB2ZWM0IGNvbCA9IHRleHR1cmUyRChzcmMsIHV2cyk7XG4gICAgICBjb2wueHl6ID0gbWl4KGZvZ0NvbG9yLCBjb2wueHl6LCBjbGFtcChkaXN0YW5jZSh3b3JsZFBvcywgdmVjMygwLiwgMC4sIC1GT0dfUkFESVVTKSkgLyBGT0dfRkFMTE9GRiwgMC4sIDEuKSk7XG4gICAgICBnbF9GcmFnQ29sb3IgPSBjb2w7XG4gICAgfVxuICBgXG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3N0YWdlLXNoYWRlci5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc3RhdHMtcGFyYW0nLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignc3RhdHMnKSA9PT0gJ3RydWUnKSB7XG4gICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnc3RhdHMnLCAnJyk7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3N0YXRzLXBhcmFtLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzdGVwYmFjaycsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGVwYmFjaycpO1xuICAgIHRoaXMuY2FtZXJhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbWVyYScpO1xuICAgIHRoaXMubGFzdFRpbWUgPSAwO1xuICAgIHRoaXMubGltaXQgPSAgLSAodGhpcy5lbC5nZXRBdHRyaWJ1dGUoJ2dlb21ldHJ5JykuaGVpZ2h0IC8gMiAtIDAuNik7XG4gICAgdGhpcy50aHJvdHRsaW5nID0gMzAwO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lLCBkZWx0YSkge1xuICAgIGlmICh0aW1lIC0gdGhpcy5sYXN0VGltZSA8IHRoaXMudGhyb3R0bGluZykgeyByZXR1cm47IH1cblxuICAgIHZhciBjYW1Qb3MgPSB0aGlzLmNhbWVyYS5vYmplY3QzRC5wb3NpdGlvbjtcbiAgICB2YXIgbXNnUG9zID0gdGhpcy5tZXNzYWdlLm9iamVjdDNELnBvc2l0aW9uO1xuXG4gICAgaWYgKGNhbVBvcy56IDwgdGhpcy5saW1pdCkge1xuICAgICAgdGhpcy50aHJvdHRsaW5nID0gMjA7XG4gICAgICB0aGlzLm1lc3NhZ2Uub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgICB0aGlzLm1lc3NhZ2UuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5vcGFjaXR5ID0gMSAtIE1hdGguYWJzKGNhbVBvcy56IC0gbXNnUG9zLnopO1xuICAgICAgbXNnUG9zLnggPSBjYW1Qb3MueDtcbiAgICAgIG1zZ1Bvcy55ID0gY2FtUG9zLnk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5tZXNzYWdlLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICAgIHRoaXMudGhyb3R0bGluZyA9IDMwMDtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3RUaW1lID0gdGltZTtcbiAgfVxuXG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3N0ZXBiYWNrLmpzIiwiLyoqXG4gKiBQdWxsIGEgc3VibWVzaCBvdXQgb2YgYSBtb2RlbCBmaWxlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3N1Yi1vYmplY3QnLCB7XG4gIHNjaGVtYToge1xuICAgIGZyb206IHt0eXBlOiAnc2VsZWN0b3InfSxcbiAgICBuYW1lOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICBkYXRhLmZyb20uYWRkRXZlbnRMaXN0ZW5lcignbW9kZWwtbG9hZGVkJywgZXZ0ID0+IHtcbiAgICAgIGNvbnN0IG1vZGVsID0gZXZ0LmRldGFpbC5tb2RlbDtcbiAgICAgIGNvbnN0IHN1YnNldCA9IG1vZGVsLmdldE9iamVjdEJ5TmFtZShkYXRhLm5hbWUpO1xuICAgICAgZWwuc2V0T2JqZWN0M0QoJ21lc2gnLCBzdWJzZXQuY2xvbmUoKSk7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3NoYWRlcicsICdmbGF0Jyk7XG4gICAgICBlbC5lbWl0KCdzdWJvYmplY3Rsb2FkZWQnLCBudWxsLCBmYWxzZSk7XG4gICAgfSk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc3ViLW9iamVjdC5qcyIsIi8qIGdsb2JhbCBBRlJBTUUgKi9cbnZhciBLRVlCT0FSRFMgPSB7XG4gIHN1cGVyc2FiZXI6IHt3cmFwQ291bnQ6IDIwLCBpbnB1dE9mZnNldFk6IDAuMDA4LCBpbnB1dE9mZnNldFg6IDAuMDgsIGltZzogJ2tleWJvYXJkLnBuZycsIGhvdmVySW1nOiAna2V5Ym9hcmQtaG92ZXIucG5nJywgbGF5b3V0OiBbe1wia2V5XCI6XCIxXCIsIFwieFwiOjAuMDE0LCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCIyXCIsIFwieFwiOjAuMTA4LCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCIzXCIsIFwieFwiOjAuMjAzLCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCI0XCIsIFwieFwiOjAuMjk5LCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCI1XCIsIFwieFwiOjAuMzk0LCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCI2XCIsIFwieFwiOjAuNDg3LCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCI3XCIsIFwieFwiOjAuNTgzLCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCI4XCIsIFwieFwiOjAuNjc3LCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCI5XCIsIFwieFwiOjAuNzcyLCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCIwXCIsIFwieFwiOjAuODY2LCBcInlcIjowLjAyNCwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJxXCIsIFwieFwiOjAuMDE0LCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJ3XCIsIFwieFwiOjAuMTA4LCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJlXCIsIFwieFwiOjAuMjAzLCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJyXCIsIFwieFwiOjAuMjk5LCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJ0XCIsIFwieFwiOjAuMzk0LCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJ5XCIsIFwieFwiOjAuNDg3LCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJpXCIsIFwieFwiOjAuNjc3LCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJ1XCIsIFwieFwiOjAuNTgzLCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJvXCIsIFwieFwiOjAuNzcyLCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJwXCIsIFwieFwiOjAuODY2LCBcInlcIjowLjIxNSwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJhXCIsIFwieFwiOjAuMDYzLCBcInlcIjowLjQwNSwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJzXCIsIFwieFwiOjAuMTU4LCBcInlcIjowLjQwNSwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJkXCIsIFwieFwiOjAuMjUzLCBcInlcIjowLjQwNSwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJmXCIsIFwieFwiOjAuMzQ5LCBcInlcIjowLjQwNSwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJnXCIsIFwieFwiOjAuNDQzLCBcInlcIjowLjQwNSwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJoXCIsIFwieFwiOjAuNTM3LCBcInlcIjowLjQwNSwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJqXCIsIFwieFwiOjAuNjMzLCBcInlcIjowLjQwNSwgXCJ3XCI6MC4wOTIsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJrXCIsIFwieFwiOjAuNzI2LCBcInlcIjowLjQwNSwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJsXCIsIFwieFwiOjAuODIxLCBcInlcIjowLjQwNSwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgzfSwge1wia2V5XCI6XCJ6XCIsIFwieFwiOjAuMTExLCBcInlcIjowLjU5OCwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgxfSwge1wia2V5XCI6XCJ4XCIsIFwieFwiOjAuMjA1LCBcInlcIjowLjU5OCwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgxfSwge1wia2V5XCI6XCJjXCIsIFwieFwiOjAuMzAxLCBcInlcIjowLjU5OCwgXCJ3XCI6MC4wOTUsIFwiaFwiOjAuMTgxfSwge1wia2V5XCI6XCJ2XCIsIFwieFwiOjAuMzk2LCBcInlcIjowLjU5OCwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgxfSwge1wia2V5XCI6XCJiXCIsIFwieFwiOjAuNDksIFwieVwiOjAuNTk4LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODF9LCB7XCJrZXlcIjpcIm5cIiwgXCJ4XCI6MC41ODUsIFwieVwiOjAuNTk4LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODF9LCB7XCJrZXlcIjpcIm1cIiwgXCJ4XCI6MC42OCwgXCJ5XCI6MC41OTgsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4MX0sIHtcImtleVwiOlwiRGVsZXRlXCIsIFwieFwiOjAuNzc3LCBcInlcIjowLjU5OCwgXCJ3XCI6MC4xMzcsIFwiaFwiOjAuMTgxfSwge1wia2V5XCI6XCIgXCIsIFwieFwiOjAuMjk3LCBcInlcIjowLjc4OCwgXCJ3XCI6MC4zODEsIFwiaFwiOjAuMjAxfSwge1wia2V5XCI6XCJFc2NhcGVcIiwgXCJ4XCI6MC4wMTMsIFwieVwiOjAuNzk3LCBcIndcIjowLjEzNywgXCJoXCI6MC4xODF9LCB7XCJrZXlcIjpcIkluc2VydFwiLCBcInhcIjowLjAxNCwgXCJ5XCI6LTAuMDAxLCBcIndcIjowLjAxLCBcImhcIjowLjAwNX1dfVxufTtcblxuaWYgKHR5cGVvZiBBRlJBTUUgPT09ICd1bmRlZmluZWQnKSB7XG4gIHRocm93IG5ldyBFcnJvcignQ29tcG9uZW50IGF0dGVtcHRlZCB0byByZWdpc3RlciBiZWZvcmUgQUZSQU1FIHdhcyBhdmFpbGFibGUuJyk7XG59XG5cbnZhciBGb250RmFjdG9ycyA9IHtcbiAgcm9ib3RvOiAxNyxcbiAgYWlsZXJvbnNlbWlib2xkOiAyMCxcbiAgZGVqYXZ1OiAyMC41LFxuICBleG8yYm9sZDogMjAsXG4gIGV4bzJzZW1pYm9sZDogMjAuMyxcbiAga2Vsc29uc2FuczogMjIuOCxcbiAgbW9ub2lkOiAxOS41LFxuICBtb3ppbGxhdnI6IDkuNSxcbiAgc291cmNlY29kZXBybzogMjAuM1xufTtcblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzdXBlci1rZXlib2FyZCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgYWxpZ246IHtkZWZhdWx0OiAnbGVmdCcsIG9uZU9mOiBbJ2xlZnQnLCAnY2VudGVyJywgJ3JpZ2h0J119LFxuICAgIGJsaW5raW5nU3BlZWQ6IHt0eXBlOiAnaW50JywgZGVmYXVsdDogNDAwfSxcbiAgICBmaWx0ZXJzOiB7dHlwZTogJ2FycmF5J30sXG4gICAgLy8gcm9ib3RvIGFpbGVyb25zZW1pYm9sZCBkZWphdnUgZXhvMmJvbGQgZXhvMnNlbWlib2xkIGtlbHNvbnNhbnMgbW9ub2lkIHNvdXJjZWNvZGVwcm9cbiAgICBmb250OiB7ZGVmYXVsdDogJ2FpbGVyb25zZW1pYm9sZCd9LFxuICAgIGhhbmQ6IHt0eXBlOiAnc2VsZWN0b3InfSxcbiAgICBpbWFnZVBhdGg6IHtkZWZhdWx0OiAnLid9LFxuICAgIGluamVjdFRvUmF5Y2FzdGVyT2JqZWN0czoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGlucHV0Q29sb3I6IHt0eXBlOiAnY29sb3InLCBkZWZhdWx0OiAnIzY2OTlmZid9LFxuICAgIGludGVydmFsOiB7dHlwZTogJ2ludCcsIGRlZmF1bHQ6IDUwfSxcbiAgICBrZXlCZ0NvbG9yOiB7dHlwZTogJ2NvbG9yJywgZGVmYXVsdDogJyMwMDAnfSxcbiAgICBrZXlDb2xvcjoge3R5cGU6ICdjb2xvcicsIGRlZmF1bHQ6ICcjNjY5OWZmJ30sXG4gICAga2V5SG92ZXJDb2xvcjoge3R5cGU6ICdjb2xvcicsIGRlZmF1bHQ6ICcjMUE0MDdGJ30sXG4gICAga2V5UHJlc3NDb2xvcjoge3R5cGU6ICdjb2xvcicsIGRlZmF1bHQ6ICcjNTI5MEY2J30sXG4gICAgbGFiZWw6IHt0eXBlOiAnc3RyaW5nJywgZGVmYXVsdDogJyd9LFxuICAgIGxhYmVsQ29sb3I6IHt0eXBlOiAnY29sb3InLCBkZWZhdWx0OiAnI2FhYSd9LFxuICAgIG1heExlbmd0aDoge3R5cGU6ICdpbnQnLCBkZWZhdWx0OiAwfSxcbiAgICBtb2RlbDoge2RlZmF1bHQ6ICdiYXNpYyd9LFxuICAgIHNob3c6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICB2YWx1ZToge3R5cGU6ICdzdHJpbmcnLCBkZWZhdWx0OiAnJ30sXG4gICAgd2lkdGg6IHtkZWZhdWx0OiAwLjh9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsaWNrLmJpbmQodGhpcykpO1xuICAgIHRoaXMuY2hhbmdlRXZlbnREZXRhaWwgPSB7fTtcbiAgICB0aGlzLnRleHRJbnB1dE9iamVjdCA9IHt9O1xuXG4gICAgdGhpcy5rZXlzID0gbnVsbDtcbiAgICB0aGlzLmZvY3VzZWQgPSBmYWxzZTtcbiAgICB0aGlzLmtleUhvdmVyID0gbnVsbDtcbiAgICB0aGlzLnByZXZDaGVja1RpbWUgPSBudWxsO1xuICAgIHRoaXMuc2hpZnQgPSBmYWxzZTtcblxuICAgIHRoaXMucmF3VmFsdWUgPSB0aGlzLmRhdGEudmFsdWU7XG4gICAgdGhpcy5kZWZhdWx0VmFsdWUgPSB0aGlzLmRhdGEudmFsdWU7XG5cbiAgICB0aGlzLnVzZXJGaWx0ZXJGdW5jID0gbnVsbDtcbiAgICB0aGlzLmludGVydmFsSWQgPSAwO1xuXG4gICAgLy8gQ3JlYXRlIGtleWJvYXJkIGltYWdlLlxuICAgIHRoaXMua2JJbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgIHRoaXMua2JJbWcuY2xhc3NMaXN0LmFkZCgna2V5Ym9hcmRSYXljYXN0YWJsZScpO1xuICAgIHRoaXMua2JJbWcuY2xhc3NMaXN0LmFkZCgnc3VwZXJLZXlib2FyZEltYWdlJyk7XG4gICAgdGhpcy5rYkltZy5hZGRFdmVudExpc3RlbmVyKCdyYXljYXN0ZXItaW50ZXJzZWN0ZWQnLCB0aGlzLmhvdmVyLmJpbmQodGhpcykpO1xuICAgIHRoaXMua2JJbWcuYWRkRXZlbnRMaXN0ZW5lcigncmF5Y2FzdGVyLWludGVyc2VjdGVkLWNsZWFyZWQnLCB0aGlzLmJsdXIuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmtiSW1nKTtcblxuICAgIC8vIENyZWF0ZSBsYWJlbC5cbiAgICB0aGlzLmxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICB0aGlzLmxhYmVsLnNldEF0dHJpYnV0ZSgndGV4dCcsIHtcbiAgICAgIGFsaWduOiAnY2VudGVyJyxcbiAgICAgIGZvbnQ6IHRoaXMuZGF0YS5mb250LFxuICAgICAgYmFzZWxpbmU6ICdib3R0b20nLFxuICAgICAgbGluZUhlaWdodDogNDAsXG4gICAgICBzaGFkZXI6ICdtc2RmJyxcbiAgICAgIG5lZ2F0ZTogdHJ1ZSxcbiAgICAgIHZhbHVlOiB0aGlzLmRhdGEubGFiZWwsXG4gICAgICBjb2xvcjogdGhpcy5kYXRhLmxhYmVsQ29sb3IsXG4gICAgICB3aWR0aDogdGhpcy5kYXRhLndpZHRoLFxuICAgICAgd3JhcENvdW50OiAzMH0pO1xuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy5sYWJlbCk7XG5cbiAgICAvLyBDcmVhdGUgaW5wdXQuXG4gICAgdGhpcy50ZXh0SW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgIHRoaXMudGV4dElucHV0LnNldEF0dHJpYnV0ZSgnbWl4aW4nLCAnc3VwZXJLZXlib2FyZFRleHRJbnB1dCcpO1xuICAgIHRoaXMudGV4dElucHV0LnNldEF0dHJpYnV0ZSgndGV4dCcsIHtcbiAgICAgIGFsaWduOiB0aGlzLmRhdGEuYWxpZ24sXG4gICAgICBmb250OiB0aGlzLmRhdGEuZm9udCxcbiAgICAgIGxpbmVIZWlnaHQ6IDM1LFxuICAgICAgdmFsdWU6IHRoaXMuZGF0YS52YWx1ZSxcbiAgICAgIGNvbG9yOiB0aGlzLmRhdGEuaW5wdXRDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLmRhdGEud2lkdGgsXG4gICAgICB3cmFwQ291bnQ6IDIwXG4gICAgfSk7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLnRleHRJbnB1dCk7XG5cbiAgICB0aGlzLmN1cnNvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG4gICAgdGhpcy5jdXJzb3Iub2JqZWN0M0QucG9zaXRpb24uc2V0KDAsIDAsIDAuMDAxKTtcbiAgICB0aGlzLmN1cnNvci5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywge3NoYWRlcjogJ2ZsYXQnLCBjb2xvcjogdGhpcy5kYXRhLmlucHV0Q29sb3J9KTtcbiAgICB0aGlzLnRleHRJbnB1dC5hcHBlbmRDaGlsZCh0aGlzLmN1cnNvcik7XG4gICAgdGhpcy5jdXJzb3JVcGRhdGVkID0gZmFsc2U7XG5cbiAgICB0aGlzLmtleUJnQ29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoKTtcbiAgICB0aGlzLmtleUhvdmVyQ29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoKTtcbiAgICB0aGlzLmtleVByZXNzQ29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoKTtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICBpZiAoZXYua2V5ID09PSAndCcpIHtcbiAgICAgICAgdmFyIHNzID0gJyc7XG4gICAgICAgIHZhciBzID0gJ2FiY2RlZmdoaWprbG1vcHFyc3R1dlFXSUVVVEdBU0RMSUdLQlhBQ1FXRVRMMTAyMzk0Njc2NDU3JztcbiAgICAgICAgdmFyIGwgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyMCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgaSsrKSBzcyArPSBzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHMubGVuZ3RoKV07XG4gICAgICAgIHNlbGYuZWwuc2V0QXR0cmlidXRlKCdzdXBlci1rZXlib2FyZCcsIHt2YWx1ZTogc3N9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Nob3cnLCB0aGlzLm9wZW4uYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLmhhbmQgPSBudWxsO1xuICAgIHRoaXMuaGFuZExpc3RlbmVyc1NldCA9IGZhbHNlO1xuICAgIHRoaXMucmF5Y2FzdGVyID0gbnVsbDtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGtiZGF0YSA9IEtFWUJPQVJEU1t0aGlzLmRhdGEubW9kZWxdO1xuICAgIHZhciB3ID0gdGhpcy5kYXRhLndpZHRoO1xuICAgIHZhciBoID0gdGhpcy5kYXRhLndpZHRoIC8gMjtcbiAgICB2YXIgdzIgPSB3IC8gMjtcbiAgICB2YXIgaDIgPSBoIC8gMjtcblxuICAgIGlmIChrYmRhdGEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc29sZS5lcnJvcignc3VwZXIta2V5Ym9hcmQgRVJST1I6IG1vZGVsIFwiJyArIHRoaXMuZGF0YS5tb2RlbCArICdcIiB1bmRlZmluZWQuJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFvbGREYXRhIHx8IHRoaXMuZGVmYXVsdFZhbHVlICE9PSBvbGREYXRhLmRlZmF1bHRWYWx1ZSkge1xuICAgICAgdGhpcy5yYXdWYWx1ZSA9IHRoaXMuZGF0YS52YWx1ZTtcbiAgICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gdGhpcy5kYXRhLnZhbHVlO1xuICAgICAgdGhpcy51cGRhdGVUZXh0SW5wdXQodGhpcy5maWx0ZXIodGhpcy5kYXRhLnZhbHVlKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudXBkYXRlVGV4dElucHV0KHRoaXMuZmlsdGVyKHRoaXMucmF3VmFsdWUpKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kYXRhLndpZHRoICE9PSBvbGREYXRhLndpZHRoIHx8XG4gICAgICAgIHRoaXMuZGF0YS5oZWlnaHQgIT09IG9sZERhdGEuaGVpZ2h0IHx8XG4gICAgICAgIHRoaXMuZGF0YS5rZXlDb2xvciAhPT0gb2xkRGF0YS5rZXlDb2xvcikge1xuICAgICAgdGhpcy5rYkltZy5zZXRBdHRyaWJ1dGUoJ2dlb21ldHJ5Jywge3ByaW1pdGl2ZTogJ3BsYW5lJywgd2lkdGg6IHcsIGhlaWdodDogaH0pO1xuICAgICAgdGhpcy5rYkltZy5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywge1xuICAgICAgICBzaGFkZXI6ICdmbGF0JyxcbiAgICAgICAgc3JjOiB0aGlzLmRhdGEuaW1hZ2VQYXRoICsgJy8nICsga2JkYXRhLmltZyxcbiAgICAgICAgY29sb3I6IHRoaXMuZGF0YS5rZXlDb2xvcixcbiAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEubGFiZWwgIT09IG9sZERhdGEubGFiZWwgfHxcbiAgICAgICAgdGhpcy5kYXRhLmxhYmVsQ29sb3IgIT09IG9sZERhdGEubGFiZWxDb2xvciB8fFxuICAgICAgICB0aGlzLmRhdGEud2lkdGggIT09IG9sZERhdGEud2lkdGgpIHtcbiAgICAgIHRoaXMubGFiZWwuc2V0QXR0cmlidXRlKCd0ZXh0Jywge1xuICAgICAgICB2YWx1ZTogdGhpcy5kYXRhLmxhYmVsLCBjb2xvcjogdGhpcy5kYXRhLmxhYmVsQ29sb3IsIHdpZHRoOiB0aGlzLmRhdGEud2lkdGh9KTtcbiAgICAgIHRoaXMubGFiZWwub2JqZWN0M0QucG9zaXRpb24uc2V0KDAsIDAuMzUgKiB3LCAtMC4wMik7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS53aWR0aCAhPT0gb2xkRGF0YS53aWR0aCB8fFxuICAgICAgICB0aGlzLmRhdGEua2V5QmdDb2xvciAhPT0gb2xkRGF0YS5rZXlCZ0NvbG9yKSB7XG4gICAgICB0aGlzLmluaXRLZXlDb2xvclBsYW5lKCk7XG4gICAgfVxuXG4gICAgdmFyIGlucHV0eCA9IHRoaXMuZGF0YS5hbGlnbiAhPT0gJ2NlbnRlcicgPyBrYmRhdGEuaW5wdXRPZmZzZXRYICogdyA6IDA7XG4gICAgaWYgKHRoaXMuZGF0YS5hbGlnbiA9PT0gJ3JpZ2h0JykgeyBpbnB1dHggKj0gLTE7IH1cblxuICAgIGlmICh0aGlzLmRhdGEuZm9udCAhPT0gb2xkRGF0YS5mb250IHx8XG4gICAgICAgIHRoaXMuZGF0YS5pbnB1dENvbG9yICE9PSBvbGREYXRhLmlucHV0Q29sb3IgfHxcbiAgICAgICAgdGhpcy5kYXRhLndpZHRoICE9PSBvbGREYXRhLndpZHRoIHx8XG4gICAgICAgIHRoaXMuZGF0YS5hbGlnbiAhPT0gb2xkRGF0YS5hbGlnbikge1xuICAgICAgdGhpcy50ZXh0SW5wdXQuc2V0QXR0cmlidXRlKCd0ZXh0Jywge1xuICAgICAgICBmb250OiB0aGlzLmRhdGEuZm9udCxcbiAgICAgICAgY29sb3I6IHRoaXMuZGF0YS5pbnB1dENvbG9yLFxuICAgICAgICB3aWR0aDogdyxcbiAgICAgICAgd3JhcENvdW50OiBrYmRhdGEud3JhcENvdW50LFxuICAgICAgICBhbGlnbjogdGhpcy5kYXRhLmFsaWduXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBTb21lIGhhY2sgd2hlcmUgdGhlIGlucHV0UmVjdCBpcyBzdG9yZWQgaW4gdGhlIEluc2VydCBrZXkuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrYmRhdGEubGF5b3V0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIga2RhdGEgPSBrYmRhdGEubGF5b3V0W2ldO1xuICAgICAgaWYgKGtkYXRhLmtleSA9PT0gJ0luc2VydCcpIHtcbiAgICAgICAgdGhpcy5pbnB1dFJlY3QgPSBrZGF0YTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnRleHRJbnB1dC5vYmplY3QzRC5wb3NpdGlvbi5zZXQoXG4gICAgICBpbnB1dHgsXG4gICAgICAodyAvIDQpIC0gKHRoaXMuaW5wdXRSZWN0LnkgKyB0aGlzLmlucHV0UmVjdC5oIC8gMikgKiB3IC8gMiArIGtiZGF0YS5pbnB1dE9mZnNldFkgKiB3LFxuICAgICAgMC4wMDJcbiAgICApO1xuXG4gICAgaWYgKHRoaXMuZGF0YS53aWR0aCAhPT0gb2xkRGF0YS53aWR0aCkge1xuICAgICAgdGhpcy5jdXJzb3Iuc2V0QXR0cmlidXRlKCdnZW9tZXRyeScsIHtcbiAgICAgICAgcHJpbWl0aXZlOiAncGxhbmUnLCB3aWR0aDogMC4wMyAqIHcsIGhlaWdodDogMC4wMSAqIHd9KTtcbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZUN1cnNvclBvc2l0aW9uKCk7XG4gICAgdGhpcy5zZXR1cEhhbmQoKTtcblxuICAgIHRoaXMua2V5QmdDb2xvci5zZXQodGhpcy5kYXRhLmtleUJnQ29sb3IpO1xuICAgIHRoaXMua2V5SG92ZXJDb2xvci5zZXQodGhpcy5kYXRhLmtleUhvdmVyQ29sb3IpO1xuICAgIHRoaXMua2V5UHJlc3NDb2xvci5zZXQodGhpcy5kYXRhLmtleVByZXNzQ29sb3IpO1xuXG4gICAgaWYgKHRoaXMuZGF0YS5zaG93KSB7XG4gICAgICB0aGlzLm9wZW4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSkge1xuICAgIHZhciBpbnRlcnNlY3Rpb247XG5cbiAgICBpZiAodGhpcy5wcmV2Q2hlY2tUaW1lICYmICh0aW1lIC0gdGhpcy5wcmV2Q2hlY2tUaW1lIDwgdGhpcy5kYXRhLmludGVydmFsKSkgeyByZXR1cm47IH1cbiAgICBpZiAoIXRoaXMucHJldkNoZWNrVGltZSkge1xuICAgICAgdGhpcy5wcmV2Q2hlY2tUaW1lID0gdGltZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMucmF5Y2FzdGVyKSB7IHJldHVybjsgfVxuICAgIGlmICghdGhpcy5mb2N1c2VkKSB7IHJldHVybjsgfVxuXG4gICAgaW50ZXJzZWN0aW9uID0gdGhpcy5yYXljYXN0ZXIuZ2V0SW50ZXJzZWN0aW9uKHRoaXMua2JJbWcpO1xuICAgIGlmICghaW50ZXJzZWN0aW9uKSB7IHJldHVybjsgfVxuXG4gICAgdmFyIHV2ID0gaW50ZXJzZWN0aW9uLnV2O1xuICAgIHZhciBrZXlzID0gS0VZQk9BUkRTW3RoaXMuZGF0YS5tb2RlbF0ubGF5b3V0O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGsgPSBrZXlzW2ldO1xuICAgICAgaWYgKHV2LnggPiBrLnggJiYgdXYueCA8IGsueCArIGsudyAmJiAoMS4wIC0gdXYueSkgPiBrLnkgJiYgKDEuMCAtIHV2LnkpIDwgay55ICsgay5oKSB7XG4gICAgICAgIGlmICh0aGlzLmtleUhvdmVyICE9PSBrKSB7XG4gICAgICAgICAgLy8gVXBkYXRlIGtleSBob3Zlci5cbiAgICAgICAgICB0aGlzLmtleUhvdmVyID0gaztcbiAgICAgICAgICB0aGlzLnVwZGF0ZUtleUNvbG9yUGxhbmUodGhpcy5rZXlIb3Zlci5rZXksIHRoaXMua2V5SG92ZXJDb2xvcik7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuY3Vyc29yVXBkYXRlZCkgeyByZXR1cm47IH1cbiAgICB0aGlzLnN0YXJ0QmxpbmtpbmcoKTtcbiAgfSxcblxuICBwYXVzZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc3RvcEJsaW5raW5nKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSBwbGFuZSBmb3IgdmlzdWFsIGZlZWRiYWNrIHdoZW4gYSBrZXkgaXMgaG92ZXJlZCBvciBjbGlja2VkXG4gICAqL1xuICBpbml0S2V5Q29sb3JQbGFuZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBrYmRhdGEgPSBLRVlCT0FSRFNbdGhpcy5kYXRhLm1vZGVsXTtcbiAgICB2YXIga2V5Q29sb3JQbGFuZSA9IHRoaXMua2V5Q29sb3JQbGFuZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG4gICAga2V5Q29sb3JQbGFuZS5jbGFzc0xpc3QuYWRkKCdzdXBlcktleWJvYXJkS2V5Q29sb3JQbGFuZScpO1xuICAgIGtleUNvbG9yUGxhbmUub2JqZWN0M0QucG9zaXRpb24ueiA9IDAuMDAxO1xuICAgIGtleUNvbG9yUGxhbmUub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgIGtleUNvbG9yUGxhbmUuc2V0QXR0cmlidXRlKCdnZW9tZXRyeScsIHtwcmltaXRpdmU6ICdwbGFuZScsIGJ1ZmZlcjogZmFsc2V9KTtcbiAgICBrZXlDb2xvclBsYW5lLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB7c2hhZGVyOiAnZmxhdCcsIGNvbG9yOiB0aGlzLmRhdGEua2V5QmdDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWV9KTtcbiAgICBpZiAoa2JkYXRhLmhvdmVySW1nKSB7XG4gICAgICBrZXlDb2xvclBsYW5lLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB7c3JjOiB0aGlzLmRhdGEuaW1hZ2VQYXRoICsgJy8nICsga2JkYXRhLmhvdmVySW1nfSk7XG4gICAgfVxuXG4gICAga2V5Q29sb3JQbGFuZS5hZGRFdmVudExpc3RlbmVyKCdjb21wb25lbnRpbml0aWFsaXplZCcsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgIGlmIChldnQuZGV0YWlsLm5hbWUgIT09ICdtYXRlcmlhbCcpIHsgcmV0dXJuOyB9XG4gICAgICBpZiAoIWtiZGF0YS5ob3ZlckltZykge1xuICAgICAgICB0aGlzLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwuYmxlbmRpbmcgPSBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQoa2V5Q29sb3JQbGFuZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIE1vdmUga2V5IGNvbG9yIHBsYW5lIHRvIGFwcHJvcHJpYXRlIHBvc2l0aW9uLCBzY2FsZSwgYW5kIGNoYW5nZSBjb2xvci5cbiAgICovXG4gIHVwZGF0ZUtleUNvbG9yUGxhbmU6IGZ1bmN0aW9uIChrZXksIGNvbG9yKSB7XG4gICAgdmFyIGtiZGF0YSA9IEtFWUJPQVJEU1t0aGlzLmRhdGEubW9kZWxdO1xuICAgIHZhciBrZXlDb2xvclBsYW5lID0gdGhpcy5rZXlDb2xvclBsYW5lO1xuXG4gICAgLy8gVW5zZXQuXG4gICAgaWYgKCFrZXkpIHtcbiAgICAgIGtleUNvbG9yUGxhbmUub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2JkYXRhLmxheW91dC5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGtkYXRhID0ga2JkYXRhLmxheW91dFtpXTtcbiAgICAgIGlmIChrZGF0YS5rZXkgIT09IGtleSkgeyBjb250aW51ZTsgfVxuICAgICAgdmFyIHcgPSB0aGlzLmRhdGEud2lkdGg7XG4gICAgICB2YXIgaCA9IHRoaXMuZGF0YS53aWR0aCAvIDI7XG4gICAgICB2YXIgdzIgPSB3IC8gMjtcbiAgICAgIHZhciBoMiA9IGggLyAyO1xuICAgICAgdmFyIGtleXcgPSBrZGF0YS53ICogdztcbiAgICAgIHZhciBrZXloID0ga2RhdGEuaCAqIGg7XG4gICAgICAvLyBTaXplLlxuICAgICAga2V5Q29sb3JQbGFuZS5vYmplY3QzRC5zY2FsZS54ID0ga2V5dztcbiAgICAgIGtleUNvbG9yUGxhbmUub2JqZWN0M0Quc2NhbGUueSA9IGtleWg7XG4gICAgICAvLyBQb3NpdGlvbi5cbiAgICAgIGtleUNvbG9yUGxhbmUub2JqZWN0M0QucG9zaXRpb24ueCA9IGtkYXRhLnggKiB3IC0gdzIgKyBrZXl3IC8gMjtcbiAgICAgIGtleUNvbG9yUGxhbmUub2JqZWN0M0QucG9zaXRpb24ueSA9ICgxIC0ga2RhdGEueSkgKiBoIC0gaDIgLSBrZXloIC8gMjtcbiAgICAgIC8vIENvbG9yLlxuICAgICAga2V5Q29sb3JQbGFuZS5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLmNvbG9yLmNvcHkoY29sb3IpO1xuICAgICAgLy8gVVZzLlxuXG4gICAgICB2YXIgZ2VvbWV0cnkgPSBrZXlDb2xvclBsYW5lLmdldE9iamVjdDNEKCdtZXNoJykuZ2VvbWV0cnlcbiAgICAgIHZhciB1dlNldCA9IGdlb21ldHJ5LmZhY2VWZXJ0ZXhVdnNbMF07XG4gICAgICB2YXIga2RhdGFZID0gMSAtIGtkYXRhLnk7XG4gICAgICB1dlNldFswXVswXS5zZXQoa2RhdGEueCwga2RhdGFZKTtcbiAgICAgIHV2U2V0WzBdWzFdLnNldChrZGF0YS54LCBrZGF0YVkgLSBrZGF0YS5oKTtcbiAgICAgIHV2U2V0WzBdWzJdLnNldChrZGF0YS54ICsga2RhdGEudywga2RhdGFZKTtcbiAgICAgIHV2U2V0WzFdWzBdLnNldChrZGF0YS54LCBrZGF0YVkgLSBrZGF0YS5oKTtcbiAgICAgIHV2U2V0WzFdWzFdLnNldChrZGF0YS54ICsga2RhdGEudywga2RhdGFZIC0ga2RhdGEuaCk7XG4gICAgICB1dlNldFsxXVsyXS5zZXQoa2RhdGEueCArIGtkYXRhLncsIGtkYXRhWSk7XG4gICAgICBnZW9tZXRyeS51dnNOZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBrZXlDb2xvclBsYW5lLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICB9LFxuXG4gIHNldHVwSGFuZDogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmhhbmQgJiYgdGhpcy5oYW5kLm93blJheWNhc3Rlcikge1xuICAgICAgdGhpcy5oYW5kLnJlbW92ZUF0dHJpYnV0ZSgncmF5Y2FzdGVyJyk7XG4gICAgfVxuICAgIGlmICh0aGlzLmRhdGEuaGFuZCkge1xuICAgICAgdGhpcy5oYW5kID0gdGhpcy5kYXRhLmhhbmQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaGFuZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoW1xuICAgICAgICAnW2N1cnNvcl0nLFxuICAgICAgICAnW3ZpdmUtY29udHJvbHNdJyxcbiAgICAgICAgJ1t0cmFja2VkLWNvbnRyb2xzXScsXG4gICAgICAgICdbb2N1bHVzLXRvdWNoLWNvbnRyb2xzXScsXG4gICAgICAgICdbd2luZG93cy1tb3Rpb24tY29udHJvbHNdJyxcbiAgICAgICAgJ1toYW5kLWNvbnRyb2xzXScsXG4gICAgICAgICdbZGF5ZHJlYW0tY29udHJvbHNdIFtjdXJzb3JdID4gW3JheWNhc3Rlcl0nXG4gICAgICBdLmpvaW4oJywnKSk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmhhbmQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ3N1cGVyLWtleWJvYXJkOiBubyBjb250cm9sbGVyIGZvdW5kLiBBZGQgPGEtZW50aXR5PiB3aXRoIGNvbnRyb2xsZXIgb3Igc3BlY2lmeSB3aXRoIHN1cGVyLWtleWJvYXJkPVwiaGFuZDogI3NlbGVjdG9yVG9Db250cm9sbGVyXCIuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghdGhpcy5oYW5kLmhhc0xvYWRlZCkge1xuICAgICAgICB0aGlzLmhhbmQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkJywgdGhpcy5zZXR1cEhhbmQuYmluZCh0aGlzKSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciByYXljYXN0ZXIgPSB0aGlzLmhhbmQuY29tcG9uZW50c1sncmF5Y2FzdGVyJ107XG4gICAgICB2YXIgcGFyYW1zID0ge307XG5cbiAgICAgIGlmICghcmF5Y2FzdGVyKSB7XG4gICAgICAgIHRoaXMuaGFuZC5vd25SYXljYXN0ZXIgPSB0cnVlO1xuICAgICAgICBwYXJhbXMuc2hvd0xpbmUgPSB0aGlzLmRhdGEuc2hvdztcbiAgICAgICAgcGFyYW1zLmVuYWJsZWQgPSB0aGlzLmRhdGEuc2hvdztcbiAgICAgICAgaWYgKHRoaXMuZGF0YS5pbmplY3RUb1JheWNhc3Rlck9iamVjdHMpIHtcbiAgICAgICAgICBwYXJhbXMub2JqZWN0cyA9ICcua2V5Ym9hcmRSYXljYXN0YWJsZSc7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oYW5kLnNldEF0dHJpYnV0ZSgncmF5Y2FzdGVyJywgcGFyYW1zKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaGFuZC5vd25SYXljYXN0ZXIgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMuZGF0YS5pbmplY3RUb1JheWNhc3Rlck9iamVjdHMpIHtcbiAgICAgICAgICB2YXIgb2JqcyA9IHJheWNhc3Rlci5kYXRhLm9iamVjdHMuc3BsaXQoJywnKTtcbiAgICAgICAgICBpZiAob2Jqcy5pbmRleE9mKCcua2V5Ym9hcmRSYXljYXN0YWJsZScpID09PSAtMSkge1xuICAgICAgICAgICAgb2Jqcy5wdXNoKCcua2V5Ym9hcmRSYXljYXN0YWJsZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwYXJhbXMub2JqZWN0cyA9IG9ianMuam9pbignLCcpLnJlcGxhY2UoL14sLywgJycpO1xuICAgICAgICAgIHRoaXMuaGFuZC5zZXRBdHRyaWJ1dGUoJ3JheWNhc3RlcicsIHBhcmFtcyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy5yYXljYXN0ZXIgPSB0aGlzLmhhbmQuY29tcG9uZW50cy5yYXljYXN0ZXI7XG4gICAgfVxuICB9LFxuXG4gIGZpbHRlcjogZnVuY3Rpb24gKHN0cikge1xuICAgIGlmIChzdHIgPT09ICcnKSB7IHJldHVybiAnJzsgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5kYXRhLmZpbHRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHN3aXRjaCAodGhpcy5kYXRhLmZpbHRlcnNbaV0pIHtcbiAgICAgICAgY2FzZSAnY3VzdG9tJzoge1xuICAgICAgICAgIGlmICh0aGlzLnVzZXJGaWx0ZXJGdW5jKSBzdHIgPSB0aGlzLnVzZXJGaWx0ZXJGdW5jKHN0cik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnYWxsdXBwZXInOiB7XG4gICAgICAgICAgc3RyID0gc3RyLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnYWxsbG93ZXInOiB7XG4gICAgICAgICAgc3RyID0gc3RyLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAndGl0bGUnOiB7XG4gICAgICAgICAgc3RyID0gc3RyLnNwbGl0KCcgJykubWFwKGZ1bmN0aW9uIChzKSB7IHJldHVybiBzWzBdLnRvVXBwZXJDYXNlKCkgKyBzLnN1YnN0cigxKTsgfSkuam9pbignICcpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ251bWJlcnMnOiB7XG4gICAgICAgICAgc3RyID0gc3RyLnNwbGl0KCcnKS5maWx0ZXIoZnVuY3Rpb24gKGMpIHsgcmV0dXJuICFpc05hTihwYXJzZUludChjKSkgfHwgYyA9PT0gJy4nOyB9KS5qb2luKCcnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdmaXJzdCc6IHtcbiAgICAgICAgICBzdHIgPSBzdHJbMF0udG9VcHBlckNhc2UoKSArIHN0ci5zdWJzdHIoMSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAndHJpbSc6IHtcbiAgICAgICAgICBzdHIgPSBzdHIudHJpbSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmRhdGEubWF4TGVuZ3RoID4gMCA/IHN0ci5zdWJzdHIoMCwgdGhpcy5kYXRhLm1heExlbmd0aCkgOiBzdHI7XG4gIH0sXG5cbiAgY2xpY2s6IGZ1bmN0aW9uIChldikge1xuICAgIGlmICghdGhpcy5rZXlIb3ZlcikgeyByZXR1cm47IH1cblxuICAgIHN3aXRjaCAodGhpcy5rZXlIb3Zlci5rZXkpIHtcbiAgICAgIGNhc2UgJ0VudGVyJzoge1xuICAgICAgICB0aGlzLmFjY2VwdCgpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ0luc2VydCc6IHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY2FzZSAnRGVsZXRlJzoge1xuICAgICAgICB0aGlzLnJhd1ZhbHVlID0gdGhpcy5yYXdWYWx1ZS5zdWJzdHIoMCwgdGhpcy5yYXdWYWx1ZS5sZW5ndGggLSAxKTtcbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gdGhpcy5maWx0ZXIodGhpcy5yYXdWYWx1ZSk7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdzdXBlci1rZXlib2FyZCcsICd2YWx1ZScsIG5ld1ZhbHVlKTtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0SW5wdXQobmV3VmFsdWUpO1xuICAgICAgICB0aGlzLmNoYW5nZUV2ZW50RGV0YWlsLnZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMuZWwuZW1pdCgnc3VwZXJrZXlib2FyZGNoYW5nZScsIHRoaXMuY2hhbmdlRXZlbnREZXRhaWwpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ1NoaWZ0Jzoge1xuICAgICAgICB0aGlzLnNoaWZ0ID0gIXRoaXMuc2hpZnQ7XG4gICAgICAgIHRoaXMua2V5SG92ZXIuZWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsICdjb2xvcicsXG4gICAgICAgICAgdGhpcy5zaGlmdCA/IHRoaXMuZGF0YS5rZXlIb3ZlckNvbG9yIDogdGhpcy5kYXRhLmtleUJnQ29sb3JcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdFc2NhcGUnOiB7XG4gICAgICAgIHRoaXMuZGlzbWlzcygpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgaWYgKHRoaXMuZGF0YS5tYXhMZW5ndGggPiAwICYmIHRoaXMucmF3VmFsdWUubGVuZ3RoID4gdGhpcy5kYXRhLm1heExlbmd0aCkgeyBicmVhazsgfVxuICAgICAgICB0aGlzLnJhd1ZhbHVlICs9IHRoaXMuc2hpZnQgPyB0aGlzLmtleUhvdmVyLmtleS50b1VwcGVyQ2FzZSgpIDogdGhpcy5rZXlIb3Zlci5rZXk7XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IHRoaXMuZmlsdGVyKHRoaXMucmF3VmFsdWUpO1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnc3VwZXIta2V5Ym9hcmQnLCAndmFsdWUnLCBuZXdWYWx1ZSk7XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dElucHV0KG5ld1ZhbHVlKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VFdmVudERldGFpbC52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICB0aGlzLmVsLmVtaXQoJ3N1cGVya2V5Ym9hcmRjaGFuZ2UnLCB0aGlzLmNoYW5nZUV2ZW50RGV0YWlsKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVLZXlDb2xvclBsYW5lKHRoaXMua2V5SG92ZXIua2V5LCB0aGlzLmtleVByZXNzQ29sb3IpO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIHNlbGYudXBkYXRlS2V5Q29sb3JQbGFuZShzZWxmLmtleUhvdmVyLmtleSwgc2VsZi5rZXlIb3ZlckNvbG9yKTtcbiAgICB9LCAxMDApO1xuICAgIHRoaXMudXBkYXRlQ3Vyc29yUG9zaXRpb24oKTtcbiAgfSxcblxuICBvcGVuOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICBpZiAodGhpcy5oYW5kICYmIHRoaXMuaGFuZC5vd25SYXljYXN0ZXIpIHtcbiAgICAgIHRoaXMuaGFuZC5zZXRBdHRyaWJ1dGUoJ3JheWNhc3RlcicsIHtzaG93TGluZTogdHJ1ZSwgZW5hYmxlZDogdHJ1ZX0pO1xuICAgIH1cbiAgfSxcblxuICBjbG9zZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgIGlmICh0aGlzLmhhbmQgJiYgdGhpcy5oYW5kLm93blJheWNhc3Rlcikge1xuICAgICAgdGhpcy5oYW5kLnNldEF0dHJpYnV0ZSgncmF5Y2FzdGVyJywge3Nob3dMaW5lOiBmYWxzZSwgZW5hYmxlZDogZmFsc2V9KTtcbiAgICB9XG4gIH0sXG5cbiAgYWNjZXB0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgaWYgKHRoaXMuaGFuZCAmJiB0aGlzLmhhbmQub3duUmF5Y2FzdGVyKSB7XG4gICAgICB0aGlzLmhhbmQuc2V0QXR0cmlidXRlKCdyYXljYXN0ZXInLCB7c2hvd0xpbmU6IGZhbHNlLCBlbmFibGVkOiBmYWxzZX0pO1xuICAgIH1cbiAgICB0aGlzLmVsLmVtaXQoJ3N1cGVya2V5Ym9hcmRpbnB1dCcsIHt2YWx1ZTogdGhpcy5kYXRhLnZhbHVlfSk7XG4gICAgdGhpcy5kYXRhLnNob3cgPSBmYWxzZTtcbiAgfSxcblxuICBkaXNtaXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5kYXRhLnZhbHVlID0gdGhpcy5kZWZhdWx0VmFsdWU7XG4gICAgdGhpcy51cGRhdGVUZXh0SW5wdXQoKTtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5oYW5kICYmIHRoaXMuaGFuZC5vd25SYXljYXN0ZXIpIHtcbiAgICAgIHRoaXMuaGFuZC5zZXRBdHRyaWJ1dGUoJ3JheWNhc3RlcicsIHtzaG93TGluZTogZmFsc2UsIGVuYWJsZWQ6IGZhbHNlfSk7XG4gICAgfVxuICAgIHRoaXMuZWwuZW1pdCgnc3VwZXJrZXlib2FyZGRpc21pc3MnKTtcbiAgICB0aGlzLmRhdGEuc2hvdyA9IGZhbHNlO1xuICB9LFxuXG4gIGJsdXI6IGZ1bmN0aW9uIChldikge1xuICAgIHRoaXMuZm9jdXNlZCA9IGZhbHNlO1xuICAgIGlmICh0aGlzLmtleUhvdmVyICYmIHRoaXMua2V5SG92ZXIua2V5ICE9PSAnU2hpZnQnKSB7XG4gICAgICB0aGlzLnVwZGF0ZUtleUNvbG9yUGxhbmUodGhpcy5rZXlIb3Zlci5rZXksIHRoaXMua2V5QmdDb2xvcik7XG4gICAgfVxuICAgIHRoaXMua2V5SG92ZXIgPSBudWxsO1xuICB9LFxuXG4gIGhvdmVyOiBmdW5jdGlvbiAoZXYpIHtcbiAgICB0aGlzLmZvY3VzZWQgPSB0cnVlO1xuICB9LFxuXG4gIHN0YXJ0Qmxpbmtpbmc6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnN0b3BCbGlua2luZygpO1xuICAgIHRoaXMuaW50ZXJ2YWxJZCA9IHdpbmRvdy5zZXRJbnRlcnZhbCh0aGlzLmJsaW5rLmJpbmQodGhpcyksIHRoaXMuZGF0YS5ibGlua2luZ1NwZWVkKTtcbiAgfSxcblxuICBzdG9wQmxpbmtpbmc6IGZ1bmN0aW9uICgpIHtcbiAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xuICAgIHRoaXMuaW50ZXJ2YWxJZCA9IDA7XG4gIH0sXG5cbiAgYmxpbms6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmN1cnNvci5vYmplY3QzRC52aXNpYmxlID0gIXRoaXMuY3Vyc29yLm9iamVjdDNELnZpc2libGU7XG4gIH0sXG5cbiAgc2V0Q3VzdG9tRmlsdGVyOiBmdW5jdGlvbiAoZikge1xuICAgIHRoaXMudXNlckZpbHRlckZ1bmMgPSBmO1xuICB9LFxuXG4gIGFkZEN1c3RvbU1vZGVsOiBmdW5jdGlvbiAobmFtZSwgbW9kZWwpIHtcbiAgICBpZiAoIW5hbWUpIHsgcmV0dXJuOyB9XG4gICAgS0VZQk9BUkRTW25hbWVdID0gbW9kZWw7XG4gIH0sXG5cbiAgdXBkYXRlQ3Vyc29yUG9zaXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZm9udCA9IHRoaXMudGV4dElucHV0LmNvbXBvbmVudHMudGV4dC5jdXJyZW50Rm9udDtcbiAgICBpZiAoIWZvbnQpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHRoaXMuY3Vyc29yLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi51cGRhdGVDdXJzb3JQb3NpdGlvbigpO1xuICAgICAgICBzZWxmLnN0YXJ0QmxpbmtpbmcoKTtcbiAgICAgIH0sIDcwMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHcgPSB0aGlzLmRhdGEud2lkdGg7XG4gICAgdmFyIGtiZGF0YSA9IEtFWUJPQVJEU1t0aGlzLmRhdGEubW9kZWxdO1xuICAgIHZhciBwb3N5ID0gLXRoaXMuaW5wdXRSZWN0LmggLyAyICogdyAvIDIuNCArIGtiZGF0YS5pbnB1dE9mZnNldFkgKiB3O1xuICAgIHZhciByYXRpbyA9IHRoaXMuZGF0YS53aWR0aCAvIHRoaXMudGV4dElucHV0LmNvbXBvbmVudHMudGV4dC5kYXRhLndyYXBDb3VudDtcbiAgICB2YXIgcG9zID0gMDtcbiAgICB2YXIgZm9udEZhY3RvciA9IEZvbnRGYWN0b3JzW3RoaXMudGV4dElucHV0LmNvbXBvbmVudHMudGV4dC5kYXRhLmZvbnRdO1xuICAgIGlmIChmb250RmFjdG9yID09PSB1bmRlZmluZWQpIHsgZm9udEZhY3RvciA9IDIwOyB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmRhdGEudmFsdWUubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBjaGFyID0gZmluZEZvbnRDaGFyKGZvbnQuY2hhcnMsIHRoaXMuZGF0YS52YWx1ZS5jaGFyQ29kZUF0KGkpKTtcbiAgICAgIHBvcyArPSBjaGFyLndpZHRoICsgY2hhci54YWR2YW5jZSAqIChjaGFyLmlkID09PSAzMiA/IDIgOiAxKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZGF0YS5hbGlnbiA9PT0gJ2NlbnRlcicpIHtcbiAgICAgIHBvcyA9IHBvcyAqIHJhdGlvICogZm9udEZhY3RvciAqIDAuMDAxMSAvIDIuMCArIDAuMDIgKiB3O1xuICAgIH0gZWxzZSBpZiAodGhpcy5kYXRhLmFsaWduID09PSAnbGVmdCcpIHtcbiAgICAgIHBvcyA9IHBvcyAqIHJhdGlvICogZm9udEZhY3RvciAqIDAuMDAxMSArIDAuMDIgKiB3O1xuICAgICAgcG9zIC09IHcgLyAyO1xuICAgIH0gZWxzZSBpZiAodGhpcy5kYXRhLmFsaWduID09PSAncmlnaHQnKSB7XG4gICAgICBwb3MgPSAtcG9zICogcmF0aW8gKiBmb250RmFjdG9yICogMC4wMDExIC0gMC4wMiAqIHc7XG4gICAgICBwb3MgKz0gdyAvIDI7XG4gICAgfVxuICAgIHRoaXMuY3Vyc29yLm9iamVjdDNELnBvc2l0aW9uLnNldChwb3MsIHBvc3ksIDAuMDAxKTtcbiAgICB0aGlzLmN1cnNvclVwZGF0ZWQgPSB0cnVlO1xuICB9LFxuXG4gIHVwZGF0ZVRleHRJbnB1dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgdGhpcy50ZXh0SW5wdXRPYmplY3QudmFsdWUgPSB2YWx1ZSB8fCB0aGlzLmRhdGEudmFsdWU7XG4gICAgdGhpcy50ZXh0SW5wdXQuc2V0QXR0cmlidXRlKCd0ZXh0JywgdGhpcy50ZXh0SW5wdXRPYmplY3QpO1xuICB9XG59KTtcblxuZnVuY3Rpb24gZmluZEZvbnRDaGFyIChjaGFycywgY29kZSkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGNoYXJzW2ldLmlkID09PSBjb2RlKSB7IHJldHVybiBjaGFyc1tpXTsgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc3VwZXIta2V5Ym9hcmQuanMiLCJBRlJBTUUucmVnaXN0ZXJTaGFkZXIoJ3N1cGVyQ3V0RnhTaGFkZXInLCB7XG4gIHNjaGVtYToge1xuICAgIHN0YXJ0VGltZToge3R5cGU6ICdmbG9hdCcsIGlzOiAndW5pZm9ybSd9LFxuICAgIHRpbWVtczoge3R5cGU6ICd0aW1lJywgaXM6ICd1bmlmb3JtJ31cbiAgfSxcblxuICB2ZXJ0ZXhTaGFkZXI6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB1dnMueHkgPSB1di54eTtcbiAgICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcbiAgICB9XG4gIGAsXG5cbiAgZnJhZ21lbnRTaGFkZXI6IGBcbiAgICB1bmlmb3JtIGZsb2F0IHN0YXJ0VGltZTtcbiAgICB1bmlmb3JtIGZsb2F0IHRpbWVtcztcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcblxuICAgICNkZWZpbmUgQ09MT1IgdmVjMygwLCAwLjY3LCAwLjk4KVxuXG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgZmxvYXQgdGltZSA9ICh0aW1lbXMgLSBzdGFydFRpbWUpIC8gMjAwMC4wO1xuICAgICAgdmVjMiBwID0gdXZzLnh5IC0gMC41O1xuICAgICAgZmxvYXQgciA9IHAueCAqIHAueCArIHAueSAqIHAueTtcbiAgICAgIGZsb2F0IGFscGhhID0gMS4wIC0gc21vb3Roc3RlcCh0aW1lIC0gMC4wMSwgdGltZSwgcik7XG4gICAgICBhbHBoYSAqPSBzbW9vdGhzdGVwKHRpbWUgLSAwLjEsIHRpbWUsIHIpO1xuICAgICAgYWxwaGEgKj0gMS4wIC0gdGltZSAqIDUuNTtcbiAgICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQoQ09MT1IsIGFscGhhKTtcbiAgICB9XG4gIGBcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc3VwZXJjdXRmeC1zaGFkZXIuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3N1cGVyY3V0ZngnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnN0YXJ0VGltZSA9IC0xMTAwOyAvLyBwYXVzZSBvbiBmaXJzdCB0aWNrXG4gIH0sXG5cbiAgY3JlYXRlU3VwZXJDdXQ6IGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgIGNvbnN0IG1lc2ggPSB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJyk7XG4gICAgdGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbi5jb3B5KHBvc2l0aW9uKTtcbiAgICB0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uLnogPSAtMTtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuXG4gICAgdGhpcy5zdGFydFRpbWUgPSB0aGlzLmVsLnNjZW5lRWwudGltZTtcbiAgICBtZXNoLm1hdGVyaWFsLnVuaWZvcm1zLnN0YXJ0VGltZS52YWx1ZSA9IHRoaXMuc3RhcnRUaW1lIC0gNTA7XG4gICAgdGhpcy5lbC5wbGF5KCk7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUpIHtcbiAgICBpZiAodGltZSA+IHRoaXMuc3RhcnRUaW1lICsgMTAwMCkge1xuICAgICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICB0aGlzLmVsLnBhdXNlKCk7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3N1cGVyY3V0ZnguanMiLCIvKipcbiAqIEFuaW1hdGUgdGV4dCBudW1iZXIgdmFsdWUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndGV4dC1jb3VudGVyJywge1xuICBkZXBlbmRlbmNpZXM6IFsndGV4dCddLFxuXG4gIHNjaGVtYToge1xuICAgIGRlY2ltYWxzOiB7ZGVmYXVsdDogMH0sXG4gICAgZHVyOiB7ZGVmYXVsdDogMjAwMCwgdHlwZTogJ2ludCd9LFxuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgZW1pdDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBwcmVmaXg6IHtkZWZhdWx0OiAnJ30sXG4gICAgc3VmZml4OiB7ZGVmYXVsdDogJyd9LFxuICAgIHZhbHVlOiB7ZGVmYXVsdDogMC4wLCB0eXBlOiAnZmxvYXQnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IDA7XG4gICAgdGhpcy5oYXNDb21wbGV0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLnRleHRWYWx1ZSA9IHt2YWx1ZSA6ICcnfTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdGhpcy5jdXJyZW50VmFsdWUgPSAwO1xuICAgIHRoaXMudGV4dFZhbHVlLnZhbHVlID0gYCR7dGhpcy5kYXRhLnByZWZpeH0ke3RoaXMuZGVjaW1hbHMoMCl9JHt0aGlzLmRhdGEuc3VmZml4fWA7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCB0aGlzLnRleHRWYWx1ZSk7XG4gICAgdGhpcy5oYXNDb21wbGV0ZWQgPSBmYWxzZTtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSwgdGltZURlbHRhKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCB8fCB0aGlzLmhhc0NvbXBsZXRlZCkgeyByZXR1cm47IH1cblxuICAgIHRoaXMuY3VycmVudFZhbHVlICs9IHRoaXMuZGF0YS52YWx1ZSAqICh0aW1lRGVsdGEgLyB0aGlzLmRhdGEuZHVyKTtcblxuICAgIGlmICh0aGlzLmN1cnJlbnRWYWx1ZSA+PSB0aGlzLmRhdGEudmFsdWUpIHtcbiAgICAgIHRoaXMuY3VycmVudFZhbHVlID0gdGhpcy5kYXRhLnZhbHVlO1xuICAgICAgaWYgKHRoaXMuZGF0YS5lbWl0KSB7IHRoaXMuZWwuZW1pdCgndGV4dGNvdW50ZXJkb25lJywgbnVsbCwgZmFsc2UpOyB9XG4gICAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgdGhpcy50ZXh0VmFsdWUudmFsdWUgPVxuICAgICAgYCR7dGhpcy5kYXRhLnByZWZpeH0ke3RoaXMuZGVjaW1hbHModGhpcy5jdXJyZW50VmFsdWUpfSR7dGhpcy5kYXRhLnN1ZmZpeH1gO1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCd0ZXh0JywgdGhpcy50ZXh0VmFsdWUpO1xuICB9LFxuXG4gIGRlY2ltYWxzOiBmdW5jdGlvbiAobikge1xuICAgIHZhciBkID0gTWF0aC5wb3coMTAsIHRoaXMuZGF0YS5kZWNpbWFscyk7XG4gICAgcmV0dXJuIChwYXJzZUludChuICogZCkgLyBkKS50b0ZpeGVkKHRoaXMuZGF0YS5kZWNpbWFscyk7XG4gIH1cbn0pXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy90ZXh0LWNvdW50ZXIuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3RleHQtdXBwZXJjYXNlJywge1xuICBzY2hlbWE6IHtcbiAgICB2YWx1ZToge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCd0ZXh0JywgJ3ZhbHVlJywgdGhpcy5kYXRhLnZhbHVlLnRvVXBwZXJDYXNlKCkpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3RleHQtdXBwZXJjYXNlLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd0b2dnbGUtcGF1c2UtcGxheScsIHtcbiAgc2NoZW1hOiB7XG4gICAgaXNQbGF5aW5nOiB7IGRlZmF1bHQ6IGZhbHNlIH1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBhY3Rpb24gPSB0aGlzLmRhdGEuaXNQbGF5aW5nID8gJ3BhdXNlJyA6ICdwbGF5JztcbiAgICBwYXJlbnQucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoeyB2ZXJpZnk6ICdnYW1lLWFjdGlvbicsIGFjdGlvbiB9KSwgJyonKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy90b2dnbGUtcGF1c2UtcGxheS5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndHJhaWwnLCB7XG4gIHNjaGVtYToge1xuICAgIGNvbG9yOiB7dHlwZTogJ2NvbG9yJ30sXG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBoYW5kOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBnZW9tZXRyeSA9IHRoaXMuZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQnVmZmVyR2VvbWV0cnkoKTtcbiAgICB2YXIgbWF4UG9pbnRzID0gdGhpcy5tYXhQb2ludHMgPSAxMjtcbiAgICB2YXIgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzID0gbmV3IEZsb2F0MzJBcnJheSgzNiAqIG1heFBvaW50cyk7XG4gICAgdmFyIGNvbG9ycyA9IHRoaXMuY29sb3JzID0gbmV3IEZsb2F0MzJBcnJheSg0OCAqIG1heFBvaW50cyk7XG4gICAgdmFyIGJsYWRlQ29sb3IgPSB0aGlzLmJsYWRlQ29sb3IgPSBuZXcgVEhSRUUuQ29sb3IodGhpcy5kYXRhLmNvbG9yKTtcblxuICAgIHRoaXMuYmxhZGVDb2xvciA9IHtcbiAgICAgIHJlZDogYmxhZGVDb2xvci5yLFxuICAgICAgZ3JlZW46IGJsYWRlQ29sb3IuZyxcbiAgICAgIGJsdWU6IGJsYWRlQ29sb3IuYixcbiAgICAgIGFscGhhOiAxLjBcbiAgICB9O1xuICAgIHRoaXMuc2FiZXJFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLmJsYWRlJyk7XG5cbiAgICB0aGlzLmxheWVycyA9IDA7XG4gICAgdGhpcy5zYWJlclRyYWplY3RvcnkgPSBbXG4gICAgICB7dG9wOiBuZXcgVEhSRUUuVmVjdG9yMygtMC41LCAwLCAwKSwgY2VudGVyOiBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAwKSwgYm90dG9tOiBuZXcgVEhSRUUuVmVjdG9yMygwLjUsIDAsIDApfSxcbiAgICAgIHt0b3A6IG5ldyBUSFJFRS5WZWN0b3IzKC0wLjUsIDAuNSwgMCksIGNlbnRlcjogbmV3IFRIUkVFLlZlY3RvcjMoMCwgMC41LCAwKSwgYm90dG9tOiBuZXcgVEhSRUUuVmVjdG9yMygwLjUsIDAuNSwgMCl9LFxuICAgICAge3RvcDogbmV3IFRIUkVFLlZlY3RvcjMoLTAuNSwgMS4wLCAwKSwgY2VudGVyOiBuZXcgVEhSRUUuVmVjdG9yMygwLCAxLjAsIDApLCBib3R0b206IG5ldyBUSFJFRS5WZWN0b3IzKDAuNSwgMS4wLCAwKX1cbiAgICBdO1xuXG4gICAgZ2VvbWV0cnkuYWRkQXR0cmlidXRlKCdwb3NpdGlvbicsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUodmVydGljZXMsIDMpLnNldER5bmFtaWModHJ1ZSkpO1xuICAgIGdlb21ldHJ5LmFkZEF0dHJpYnV0ZSgndmVydGV4Q29sb3InLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKGNvbG9ycywgNCkuc2V0RHluYW1pYyh0cnVlKSk7XG5cbiAgICBjb25zdCBtYXRlcmlhbCA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCh7XG4gICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlLFxuICAgICAgdmVydGV4Q29sb3JzOiBUSFJFRS5WZXJ0ZXhDb2xvcnMsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgIGJsZW5kaW5nOiBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nLFxuICAgICAgdmVydGV4U2hhZGVyOiBbXG4gICAgICAgICd2YXJ5aW5nIHZlYzQgdkNvbG9yOycsXG4gICAgICAgICdhdHRyaWJ1dGUgdmVjNCB2ZXJ0ZXhDb2xvcjsnLFxuICAgICAgICAndm9pZCBtYWluKCkgeycsXG4gICAgICAgICd2ZWM0IG1vZGVsVmlld1Bvc2l0aW9uID0gbW9kZWxWaWV3TWF0cml4ICogdmVjNChwb3NpdGlvbiwgMS4wKTsnLFxuICAgICAgICAndkNvbG9yID0gdmVydGV4Q29sb3I7JyxcbiAgICAgICAgJ2dsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld1Bvc2l0aW9uOycsXG4gICAgICAgICd9J1xuICAgICAgXS5qb2luKCcnKSxcbiAgICAgIGZyYWdtZW50U2hhZGVyOiBbXG4gICAgICAgICd2YXJ5aW5nIHZlYzQgdkNvbG9yOycsXG4gICAgICAgICd2b2lkIG1haW4oKSB7JyxcbiAgICAgICAgJ2dsX0ZyYWdDb2xvciA9IHZDb2xvcjsnLFxuICAgICAgICAnfSdcbiAgICAgIF0uam9pbignJylcbiAgICB9KTtcblxuICAgIGNvbnN0IG1lc2ggPSB0aGlzLm1lc2ggPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xuICAgIG1lc2guZnJ1c3R1bUN1bGxlZCA9IGZhbHNlO1xuICAgIG1lc2gudmVydGljZXMgPSB2ZXJ0aWNlcztcbiAgICB0aGlzLmVsLnNjZW5lRWwuc2V0T2JqZWN0M0QoYHRyYWlsX18ke3RoaXMuZGF0YS5oYW5kfWAsIG1lc2gpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICBpZiAoIW9sZERhdGEuZW5hYmxlZCAmJiB0aGlzLmRhdGEuZW5hYmxlZCkge1xuICAgICAgdGhpcy5lbmFibGVkVGltZSA9IHRoaXMuZWwuc2NlbmVFbC50aW1lO1xuICAgICAgdGhpcy5tZXNoLnZpc2libGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAob2xkRGF0YS5lbmFibGVkICYmICF0aGlzLmRhdGEuZW5hYmxlZCkge1xuICAgICAgdGhpcy5tZXNoLnZpc2libGUgPSBmYWxzZTtcbiAgICB9XG4gIH0sXG5cbiAgdG9jazogZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cbiAgICAvLyBEZWxheSBiZWZvcmUgc2hvd2luZyBhZnRlciBlbmFibGVkIHRvIHByZXZlbnQgZmxhc2ggZnJvbSBvbGQgc2FiZXIgcG9zaXRpb24uXG4gICAgaWYgKCF0aGlzLm1lc2gudmlzaWJsZSAmJiB0aW1lID4gdGhpcy5lbmFibGVkVGltZSArIDI1MCkgeyB0aGlzLm1lc2gudmlzaWJsZSA9IHRydWU7IH1cbiAgICB0aGlzLnNhbXBsZVNhYmVyUG9zaXRpb24oKTtcbiAgfSxcblxuICBhZGRMYXllcjogZnVuY3Rpb24gKGxlbmd0aCkge1xuICAgIHZhciBzdGFydFggPSAtMS4wO1xuICAgIHZhciBzZWdtZW50cyA9IHRoaXMuc2VnbWVudHM7XG4gICAgdmFyIGR4ID0gMiAvIHNlZ21lbnRzO1xuICAgIHZhciBjb2xvcnMgPSB0aGlzLmNvbG9ycztcbiAgICB2YXIgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzO1xuICAgIHZhciBjb2xvciA9IHRoaXMuYmxhZGVDb2xvcjtcblxuICAgIGlmICh0aGlzLmxheWVycyA+PSB0aGlzLm1heExheWVycykgeyB0aGlzLmxheWVycyA9IDA7IH1cblxuICAgIGNvbnN0IGJvdHRvbUxheWVyID0gdGhpcy5sYXllcnMgKiBsZW5ndGg7XG4gICAgbGVuZ3RoID0gYm90dG9tTGF5ZXIgKyBsZW5ndGg7XG4gICAgY29uc3QgaW5kZXhPZmZzZXQgPSB0aGlzLmxheWVycyAqIHNlZ21lbnRzICogMTg7XG4gICAgY29uc3QgY29sb3JPZmZzZXQgPSB0aGlzLmxheWVycyAqIHNlZ21lbnRzICogMjQ7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlZ21lbnRzOyArK2kpIHtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpXSA9IHN0YXJ0WCArIGkgKiBkeDtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMV0gPSBib3R0b21MYXllcjtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMl0gPSAwLjA7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGldID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDJdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDNdID0gY29sb3IuYWxwaGE7XG5cbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgM10gPSBzdGFydFggKyBpICogZHg7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDRdID0gbGVuZ3RoO1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyA1XSA9IDAuMDtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDRdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgNV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDZdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDddID0gY29sb3IuYWxwaGE7XG5cbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgNl0gPSBzdGFydFggKyBpICogZHggKyBkeDtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgN10gPSBsZW5ndGg7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDhdID0gMC4wO1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgOF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyA5XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMTBdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDExXSA9IGNvbG9yLmFscGhhO1xuXG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDldID0gc3RhcnRYICsgaSAqIGR4ICsgZHg7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDEwXSA9IGJvdHRvbUxheWVyO1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAxMV0gPSAwLjA7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxMl0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxM10gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDE0XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxNV0gPSBjb2xvci5hbHBoYTtcblxuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAxMl0gPSBzdGFydFggKyBpICogZHg7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDEzXSA9IGJvdHRvbUxheWVyO1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAxNF0gPSAwLjA7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxNl0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxN10gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDE4XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxOV0gPSBjb2xvci5hbHBoYTtcblxuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAxNV0gPSBzdGFydFggKyBpICogZHggKyBkeDtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMTZdID0gbGVuZ3RoO1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAxN10gPSAwLjA7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAyMF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAyMV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDIyXSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAyM10gPSBjb2xvci5hbHBoYTtcbiAgICB9XG5cbiAgICB0aGlzLmxheWVycysrO1xuICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnZlcnRleENvbG9yLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMudXYubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9LFxuXG4gIGluaXRHZW9tZXRyeTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBpO1xuICAgIHZhciBwcmV2aW91c1BvaW50O1xuICAgIHZhciBjdXJyZW50UG9pbnQ7XG4gICAgdmFyIHNhYmVyVHJhamVjdG9yeSA9IHRoaXMuc2FiZXJUcmFqZWN0b3J5O1xuICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheTtcbiAgICB2YXIgY29sb3JzID0gdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnZlcnRleENvbG9yLmFycmF5O1xuICAgIHZhciBjb2xvciA9IHRoaXMuYmxhZGVDb2xvcjtcbiAgICB2YXIgYWxwaGE7XG4gICAgdmFyIHByZXZpb3VzQWxwaGE7XG5cbiAgICBmb3IgKGkgPSAxOyBpIDwgc2FiZXJUcmFqZWN0b3J5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoaSA9PT0gMSkgeyBwcmV2aW91c0FscGhhID0gYWxwaGE7IH1cbiAgICAgIGFscGhhID0gMS4wIC0gKChzYWJlclRyYWplY3RvcnkubGVuZ3RoIC0gaSkgLyBzYWJlclRyYWplY3RvcnkubGVuZ3RoKTtcblxuICAgICAgY3VycmVudFBvaW50ID0gc2FiZXJUcmFqZWN0b3J5W2ldO1xuICAgICAgcHJldmlvdXNQb2ludCA9IHNhYmVyVHJhamVjdG9yeVtpIC0gMV07XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaV0gPSBwcmV2aW91c1BvaW50LmNlbnRlci54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMV0gPSBwcmV2aW91c1BvaW50LmNlbnRlci55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMl0gPSBwcmV2aW91c1BvaW50LmNlbnRlci56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaV0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyXSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgM10gPSBwcmV2aW91c0FscGhhICogMC4yO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAzXSA9IGN1cnJlbnRQb2ludC50b3AueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDRdID0gY3VycmVudFBvaW50LnRvcC55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgNV0gPSBjdXJyZW50UG9pbnQudG9wLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgNF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgNV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA2XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgN10gPSBhbHBoYTtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgNl0gPSBwcmV2aW91c1BvaW50LnRvcC54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgN10gPSBwcmV2aW91c1BvaW50LnRvcC55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgOF0gPSBwcmV2aW91c1BvaW50LnRvcC56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDhdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDldID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgMTBdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxMV0gPSBwcmV2aW91c0FscGhhO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyA5XSA9IHByZXZpb3VzUG9pbnQuY2VudGVyLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxMF0gPSBwcmV2aW91c1BvaW50LmNlbnRlci55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMTFdID0gcHJldmlvdXNQb2ludC5jZW50ZXIuejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxMl0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMTNdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgMTRdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxNV0gPSBwcmV2aW91c0FscGhhICogMC4yO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxMl0gPSBjdXJyZW50UG9pbnQuY2VudGVyLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxM10gPSBjdXJyZW50UG9pbnQuY2VudGVyLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxNF0gPSBjdXJyZW50UG9pbnQuY2VudGVyLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgMTZdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDE3XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDE4XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMTldID0gYWxwaGEgKiAwLjI7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDE1XSA9IGN1cnJlbnRQb2ludC50b3AueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDE2XSA9IGN1cnJlbnRQb2ludC50b3AueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDE3XSA9IGN1cnJlbnRQb2ludC50b3AuejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyMF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMjFdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgMjJdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyM10gPSBhbHBoYTtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgMThdID0gcHJldmlvdXNQb2ludC5ib3R0b20ueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDE5XSA9IHByZXZpb3VzUG9pbnQuYm90dG9tLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyMF0gPSBwcmV2aW91c1BvaW50LmJvdHRvbS56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDI0XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyNV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyNl0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDI3XSA9IDAuMDtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjFdID0gY3VycmVudFBvaW50LmNlbnRlci54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjJdID0gY3VycmVudFBvaW50LmNlbnRlci55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjNdID0gY3VycmVudFBvaW50LmNlbnRlci56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDI4XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyOV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzMF0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDMxXSA9IGFscGhhICogMC4yO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyNF0gPSBwcmV2aW91c1BvaW50LmNlbnRlci54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjVdID0gcHJldmlvdXNQb2ludC5jZW50ZXIueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDI2XSA9IHByZXZpb3VzUG9pbnQuY2VudGVyLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgMzJdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDMzXSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDM0XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMzVdID0gcHJldmlvdXNBbHBoYSAqIDAuMjtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjddID0gcHJldmlvdXNQb2ludC5ib3R0b20ueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDI4XSA9IHByZXZpb3VzUG9pbnQuYm90dG9tLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyOV0gPSBwcmV2aW91c1BvaW50LmJvdHRvbS56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDM2XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzN10gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzOF0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDM5XSA9IDAuMDtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgMzBdID0gY3VycmVudFBvaW50LmJvdHRvbS54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMzFdID0gY3VycmVudFBvaW50LmJvdHRvbS55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMzJdID0gY3VycmVudFBvaW50LmJvdHRvbS56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDQwXSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA0MV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA0Ml0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDQzXSA9IDAuMDtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgMzNdID0gY3VycmVudFBvaW50LmNlbnRlci54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMzRdID0gY3VycmVudFBvaW50LmNlbnRlci55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMzVdID0gY3VycmVudFBvaW50LmNlbnRlci56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDQ0XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA0NV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA0Nl0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDQ3XSA9IGFscGhhICogMC4yO1xuXG4gICAgICBwcmV2aW91c0FscGhhID0gYWxwaGE7XG4gICAgfVxuXG4gICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMudmVydGV4Q29sb3IubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9LFxuXG4gIHNhbXBsZVNhYmVyUG9zaXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2FiZXJFbCA9IHRoaXMuc2FiZXJFbDtcbiAgICB2YXIgc2FiZXJPYmplY3Q7XG4gICAgdmFyIHNhbXBsZTtcblxuICAgIGlmICh0aGlzLnNhYmVyVHJhamVjdG9yeS5sZW5ndGggPT09IHRoaXMubWF4UG9pbnRzKSB7XG4gICAgICAvLyBEdW1wIG9sZGVzdCBwb2ludC5cbiAgICAgIHNhbXBsZSA9IHRoaXMuc2FiZXJUcmFqZWN0b3J5LnNoaWZ0KCk7XG4gICAgICBzYW1wbGUudG9wLnNldCgwLCAtMC40LCAwKTtcbiAgICAgIHNhbXBsZS5jZW50ZXIuc2V0KDAsIDAsIDApO1xuICAgICAgc2FtcGxlLmJvdHRvbS5zZXQoMCwgMC40LCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2FtcGxlID0ge1xuICAgICAgICB0b3A6IG5ldyBUSFJFRS5WZWN0b3IzKDAsIC0wLjQsIDApLFxuICAgICAgICBjZW50ZXI6IG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAsIDApLFxuICAgICAgICBib3R0b206IG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAuNCwgMClcbiAgICAgIH07XG4gICAgfVxuXG4gICAgc2FiZXJPYmplY3QgPSBzYWJlckVsLm9iamVjdDNEO1xuXG4gICAgc2FiZXJPYmplY3QucGFyZW50LnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG4gICAgc2FiZXJPYmplY3QubG9jYWxUb1dvcmxkKHNhbXBsZS50b3ApO1xuICAgIHNhYmVyT2JqZWN0LmxvY2FsVG9Xb3JsZChzYW1wbGUuY2VudGVyKTtcbiAgICBzYWJlck9iamVjdC5sb2NhbFRvV29ybGQoc2FtcGxlLmJvdHRvbSk7XG5cbiAgICB0aGlzLnNhYmVyVHJhamVjdG9yeS5wdXNoKHNhbXBsZSk7XG5cbiAgICB0aGlzLmluaXRHZW9tZXRyeSgpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3RyYWlsLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd0dXRvcmlhbC0yZCcsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuc2NlbmVFbC5jYW52YXMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmNhbnZhcy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwyZCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdHV0b3JpYWwtMmQuanMiLCJjb25zdCBOVU1fVkFMVUVTX1BFUl9TRUdNRU5UID0gNzU7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndHdpc3RlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICB0d2lzdDoge2RlZmF1bHQ6IDB9LFxuICAgIHZlcnRpY2VzOiB7ZGVmYXVsdDogNCwgdHlwZTogJ2ludCd9LFxuICAgIGNvdW50OiB7ZGVmYXVsdDogMTIsIHR5cGU6ICdpbnQnfSxcbiAgICBwb3NpdGlvbkluY3JlbWVudDoge2RlZmF1bHQ6IDEuNH0sXG4gICAgcmFkaXVzSW5jcmVtZW50OiB7ZGVmYXVsdDogMC40MH0sXG4gICAgdGhpY2tuZXNzOiB7ZGVmYXVsdDogMC4zN31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5jdXJyZW50VHdpc3QgPSAwO1xuICAgIHRoaXMuYW5pbWF0ZSA9IGZhbHNlO1xuICAgIHRoaXMuZ2VvbWV0cnkgPSBudWxsO1xuICB9LFxuXG4gIHB1bHNlOiBmdW5jdGlvbiAodHdpc3QpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgIGlmICh0d2lzdCA9PSAwKSB7IHR3aXN0ID0gMC4wMyArIE1hdGgucmFuZG9tKCkgKiAwLjI1OyB9XG4gICAgZWxzZSB0d2lzdCA9IE1hdGgubWluKHR3aXN0ICogMC40LCAwLjQpO1xuICAgIHR3aXN0ICo9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7IC8vIHJhbmRvbSBkaXJlY3Rpb25cbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgndHdpc3RlcicsIHt0d2lzdDogdHdpc3R9KTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIHJhZGl1cyA9IDY7XG4gICAgdmFyIHNlZ21lbnRzID0gW107XG5cbiAgICBpZiAoTWF0aC5hYnModGhpcy5kYXRhLnR3aXN0IC0gdGhpcy5jdXJyZW50VHdpc3QpID4gMC4wMDEpIHtcbiAgICAgIHRoaXMuYW5pbWF0ZSA9IHRydWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhcigpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmRhdGEuY291bnQ7IGkrKykge1xuICAgICAgbGV0IHNlZ21lbnQgPSB0aGlzLmNyZWF0ZVNlZ21lbnQocmFkaXVzKTtcbiAgICAgIHNlZ21lbnQudHJhbnNsYXRlKDAsIHRoaXMuZGF0YS5wb3NpdGlvbkluY3JlbWVudCAqIGksIDApO1xuICAgICAgc2VnbWVudHMucHVzaChzZWdtZW50KTtcbiAgICAgIHJhZGl1cyArPSB0aGlzLmRhdGEucmFkaXVzSW5jcmVtZW50O1xuICAgIH1cbiAgICB0aGlzLmdlb21ldHJ5ID0gVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscy5tZXJnZUJ1ZmZlckdlb21ldHJpZXMoc2VnbWVudHMpO1xuICAgIHZhciBtYXRlcmlhbCA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFscy5zdGFnZU5vcm1hbDtcbiAgICB2YXIgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKHRoaXMuZ2VvbWV0cnksIG1hdGVyaWFsKTtcbiAgICB0aGlzLmVsLm9iamVjdDNELmFkZChtZXNoKTtcbiAgfSxcblxuICBjcmVhdGVTZWdtZW50OiBmdW5jdGlvbiAocmFkaXVzKSB7XG4gICAgY29uc3QgUiA9IHRoaXMuZGF0YS50aGlja25lc3M7XG4gICAgdmFyIGdlb21ldHJ5O1xuICAgIHZhciBwb2ludHMgPSBbXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMihyYWRpdXMgLSBSLCBSKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IyKHJhZGl1cyAtIFIsIC1SKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IyKHJhZGl1cyArIFIsIC1SKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IyKHJhZGl1cyArIFIsIFIpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjIocmFkaXVzIC0gUiwgUilcbiAgICBdO1xuICAgIGdlb21ldHJ5ID0gbmV3IFRIUkVFLkxhdGhlQnVmZmVyR2VvbWV0cnkocG9pbnRzLCB0aGlzLmRhdGEudmVydGljZXMpO1xuICAgIC8vIG1vdmUgdXZzIHRvIGEgc3BlY2lmaWMgcG9pbnQgaW4gYXRsYXMucG5nXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnZW9tZXRyeS5hdHRyaWJ1dGVzLnV2LmFycmF5Lmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICBnZW9tZXRyeS5hdHRyaWJ1dGVzLnV2LmFycmF5W2ldID0gMC43NztcbiAgICAgIGdlb21ldHJ5LmF0dHJpYnV0ZXMudXYuYXJyYXlbaSArIDFdID0gMC4wMDE7XG4gICAgfVxuICAgIHJldHVybiBnZW9tZXRyeTtcbiAgfSxcblxuICBjbGVhcjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QucmVtb3ZlKHRoaXMuZWwub2JqZWN0M0QuY2hpbGRyZW5bMF0pO1xuICAgIGlmICh0aGlzLmdlb21ldHJ5KSB0aGlzLmdlb21ldHJ5LmRpc3Bvc2UoKTtcbiAgICB0aGlzLmdlb21ldHJ5ID0gbmV3IFRIUkVFLkJ1ZmZlckdlb21ldHJ5KCk7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgaWYgKCF0aGlzLmFuaW1hdGUpIHsgcmV0dXJuOyB9XG5cbiAgICB2YXIgcG9zQXJyYXkgPSB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXk7XG4gICAgdmFyIHJvdGF0aW9uO1xuICAgIHZhciB4LCB5O1xuICAgIHZhciBzaW4sIGNvcztcbiAgICB2YXIgZGlmZjtcblxuICAgIGRlbHRhICo9IDAuMDAxO1xuXG4gICAgZGlmZiA9ICh0aGlzLmRhdGEudHdpc3QgLSB0aGlzLmN1cnJlbnRUd2lzdCkgKiBkZWx0YTtcblxuICAgIHRoaXMuY3VycmVudFR3aXN0ICs9IGRpZmY7XG4gICAgcm90YXRpb24gPSBkaWZmICogMy4wO1xuXG4gICAgZm9yICh2YXIgcyA9IDA7IHMgPCB0aGlzLmRhdGEuY291bnQ7IHMrKykge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBOVU1fVkFMVUVTX1BFUl9TRUdNRU5UOyBpICs9IDMpIHtcbiAgICAgICAgY29zID0gTWF0aC5jb3Mocm90YXRpb24pO1xuICAgICAgICBzaW4gPSBNYXRoLnNpbihyb3RhdGlvbik7XG4gICAgICAgIHggPSBwb3NBcnJheVtzICogTlVNX1ZBTFVFU19QRVJfU0VHTUVOVCArIGldO1xuICAgICAgICB5ID0gcG9zQXJyYXlbcyAqIE5VTV9WQUxVRVNfUEVSX1NFR01FTlQgKyBpICsgMl07XG4gICAgICAgIHBvc0FycmF5W3MgKiBOVU1fVkFMVUVTX1BFUl9TRUdNRU5UICsgaV0gPSB4ICogY29zIC0geSAqIHNpbjtcbiAgICAgICAgcG9zQXJyYXlbcyAqIE5VTV9WQUxVRVNfUEVSX1NFR01FTlQgKyBpICsgMl0gPSB5ICogY29zICsgeCAqIHNpbjtcbiAgICAgIH1cbiAgICAgIHJvdGF0aW9uICo9IDEuMDU7XG4gICAgfVxuICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5uZWVkc1VwZGF0ZSA9IHRydWU7XG5cbiAgICBpZiAoTWF0aC5hYnModGhpcy5kYXRhLnR3aXN0IC0gdGhpcy5jdXJyZW50VHdpc3QpIDwgMC4wMDEpe1xuICAgICAgdGhpcy5hbmltYXRlID0gZmFsc2U7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3R3aXN0ZXIuanMiLCJ2YXIgY29sb3JIZWxwZXIgPSBuZXcgVEhSRUUuQ29sb3IoKTtcblxuLyoqXG4gKiBTZXQgZ2VvbWV0cnkgdmVydGV4IGNvbG9ycywgYWxsb3dzIGZvciBnZW9tZXRyeSBtZXJnaW5nIHVzaW5nIG9uZSBtYXRlcmlhbFxuICogd2hpbGUgcmV0YWluaW5nIGNvbG9ycy5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd2ZXJ0ZXgtY29sb3JzLWJ1ZmZlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgYmFzZUNvbG9yOiB7dHlwZTogJ2NvbG9yJ30sXG4gICAgaXRlbVNpemU6IHtkZWZhdWx0OiAzfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB2YXIgY29sb3JzO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBpO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGdlb21ldHJ5O1xuICAgIHZhciBtZXNoO1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIG1lc2ggPSB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJyk7XG5cbiAgICBpZiAoIW1lc2ggfHwgIW1lc2guZ2VvbWV0cnkpIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ29iamVjdDNkc2V0JywgZnVuY3Rpb24gcmVVcGRhdGUgKGV2dCkge1xuICAgICAgICBpZiAoZXZ0LmRldGFpbC50eXBlICE9PSAnbWVzaCcpIHsgcmV0dXJuOyB9XG4gICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29iamVjdDNkc2V0JywgcmVVcGRhdGUpO1xuICAgICAgICBzZWxmLnVwZGF0ZShvbGREYXRhKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGdlb21ldHJ5ID0gbWVzaC5nZW9tZXRyeTtcblxuICAgIC8vIEVtcHR5IGdlb21ldHJ5LlxuICAgIGlmICghZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbikge1xuICAgICAgY29uc29sZS53YXJuKCdHZW9tZXRyeSBoYXMgbm8gdmVydGljZXMnLCBlbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFnZW9tZXRyeS5hdHRyaWJ1dGVzLmNvbG9yKSB7XG4gICAgICBnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoJ2NvbG9yJyxcbiAgICAgICAgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZShcbiAgICAgICAgICBuZXcgRmxvYXQzMkFycmF5KGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXkubGVuZ3RoKSwgM1xuICAgICAgICApXG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbG9ycyA9IGdlb21ldHJ5LmF0dHJpYnV0ZXMuY29sb3IuYXJyYXk7XG5cbiAgICAvLyBUT0RPOiBGb3Igc29tZSByZWFzb24sIGluY3JlbWVudGluZyBsb29wIGJ5IDMgZG9lc24ndCB3b3JrLiBOZWVkIHRvIGRvIGJ5IDQgZm9yIGdsVEYuXG4gICAgY29sb3JIZWxwZXIuc2V0KGRhdGEuYmFzZUNvbG9yKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgY29sb3JzLmxlbmd0aDsgaSArPSBkYXRhLml0ZW1TaXplKSB7XG4gICAgICBjb2xvcnNbaV0gPSBjb2xvckhlbHBlci5yO1xuICAgICAgY29sb3JzW2kgKyAxXSA9IGNvbG9ySGVscGVyLmc7XG4gICAgICBjb2xvcnNbaSArIDJdID0gY29sb3JIZWxwZXIuYjtcbiAgICB9XG5cbiAgICBnZW9tZXRyeS5hdHRyaWJ1dGVzLmNvbG9yLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy92ZXJ0ZXgtY29sb3JzLWJ1ZmZlci5qcyIsIi8qKlxuICogVHJpZ2dlciBhY2N1cmFjeSByaW5nIGFuaW1hdGlvbiBvbiB2aWN0b3J5IHNjcmVlbi5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd2aWN0b3J5LWFjY3VyYWN5LXJpbmcnLCB7XG4gIGRlcGVuZGVuY2llczogWydnZW9tZXRyeScsICdtYXRlcmlhbCddLFxuXG4gIHNjaGVtYToge1xuICAgIGFjY3VyYWN5OiB7ZGVmYXVsdDogMH1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwudW5pZm9ybXMucHJvZ3Jlc3MudmFsdWUgPSAwO1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdhbmltYXRpb24nLCAndG8nLCB0aGlzLmRhdGEuYWNjdXJhY3kgLyAxMDApO1xuICAgIHRoaXMuZWwuY29tcG9uZW50c1snYW5pbWF0aW9uJ10uYmVnaW5BbmltYXRpb24oKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy92aWN0b3J5LWFjY3VyYWN5LXJpbmcuanMiLCIvKipcbiAqIFJhbmsgY29sb3IuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndmljdG9yeS1yYW5rJywge1xuICBzY2hlbWE6IHtcbiAgICByYW5rOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgcmFuayA9IHRoaXMuZGF0YS5yYW5rO1xuICAgIGlmICghcmFuaykgeyByZXR1cm47IH1cblxuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCd0ZXh0JywgJ3ZhbHVlJywgcmFuayk7XG4gICAgc3dpdGNoIChyYW5rWzBdKSB7XG4gICAgICBjYXNlICdTJzoge1xuICAgICAgICB0aGlzLnNldENvbG9yKCcjRkZGJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnQSc6IHtcbiAgICAgICAgdGhpcy5zZXRDb2xvcignI2MyZDA3NicpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ0InOiB7XG4gICAgICAgIHRoaXMuc2V0Q29sb3IoJyMyM2YwYzcnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdDJzoge1xuICAgICAgICB0aGlzLnNldENvbG9yKCcjZmZlMzQ3Jyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnRCc6IHtcbiAgICAgICAgdGhpcy5zZXRDb2xvcignI2NlNmM0NycpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ0YnOiB7XG4gICAgICAgIHRoaXMuc2V0Q29sb3IoJyM5NjAyMDAnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHNldENvbG9yOiBmdW5jdGlvbiAoY29sb3IpIHtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgndGV4dCcsICdjb2xvcicsIGNvbG9yKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy92aWN0b3J5LXJhbmsuanMiLCIvKipcbiAqIENvdXBsZSB2aXNpYmlsaXR5IGFuZCByYXljYXN0YWJpbGl0eS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd2aXNpYmxlLXJheWNhc3RhYmxlJywge1xuICBzY2hlbWE6IHtcbiAgICBkZWZhdWx0OiB0cnVlXG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gdGhpcy5kYXRhO1xuICAgIGlmICh0aGlzLmRhdGEpIHtcbiAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdyYXljYXN0YWJsZScsICcnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbC5yZW1vdmVBdHRyaWJ1dGUoJ3JheWNhc3RhYmxlJywgJycpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy92aXNpYmxlLXJheWNhc3RhYmxlLmpzIiwiY29uc3QgQ09MT1JTID0gcmVxdWlyZSgnLi4vY29uc3RhbnRzL2NvbG9ycy5qcycpO1xuXG5jb25zdCBXQUxMX0NPTE9SID0gbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5ORU9OX1JFRCk7XG5jb25zdCBXQUxMX0JHID0gbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5TS1lfUkVEKTtcblxuXG5BRlJBTUUucmVnaXN0ZXJTaGFkZXIoJ3dhbGxTaGFkZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGlUaW1lOiB7dHlwZTogJ3RpbWUnLCBpczogJ3VuaWZvcm0nfSxcbiAgICBoaXRSaWdodDoge3R5cGU6ICd2ZWMzJywgaXM6ICd1bmlmb3JtJywgZGVmYXVsdDoge3g6IDAsIHk6IDEsIHo6IDB9fSxcbiAgICBoaXRMZWZ0OiB7dHlwZTogJ3ZlYzMnLCBpczogJ3VuaWZvcm0nLCBkZWZhdWx0OiB7eDogMCwgeTogMCwgejogMH19XG4gIH0sXG5cbiAgdmVydGV4U2hhZGVyOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgbnJtbDtcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdXZzLnh5ID0gdXYueHk7XG4gICAgICBucm1sLnh5eiA9IG5vcm1hbC54eXo7XG4gICAgICB2ZWM0IHAgPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1xuICAgICAgd29ybGRQb3MgPSAobW9kZWxNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICkpLnh5ejtcbiAgICAgIGdsX1Bvc2l0aW9uID0gcDtcbiAgICB9XG4gIGAsXG5cbiAgZnJhZ21lbnRTaGFkZXI6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyBucm1sO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB1bmlmb3JtIGZsb2F0IGlUaW1lO1xuICAgIC8vdW5pZm9ybSBzYW1wbGVyMkQgZW52O1xuICAgIHVuaWZvcm0gdmVjMyBoaXRSaWdodDtcbiAgICB1bmlmb3JtIHZlYzMgaGl0TGVmdDtcblxuICAgICNkZWZpbmUgU0VFRCAxOS4xMjU0XG4gICAgI2RlZmluZSB0aW1lICgzLjAgKyBpVGltZSkvMTAwMC4wICogMC4xNVxuXG4gICAgZmxvYXQgbm9pc2UodmVjMyB1dikge1xuICAgICAgcmV0dXJuIGZyYWN0KHNpbih1di54KjEyMzI0My4gKyB1di55KjQyNC4gKyB1di56KjY0Mi4gKyBTRUVEKSAqIDE1MjQuKTtcbiAgICB9XG5cbiAgICB2ZWMzIGRyYXdDaXJjbGUodmVjMyBwLCB2ZWMzIGNlbnRlciwgZmxvYXQgcmFkaXVzLCBmbG9hdCBlZGdlV2lkdGgsIHZlYzMgY29sb3IpIHtcbiAgICAgIHJldHVybiBjb2xvciAqICgxLjAgLSBzbW9vdGhzdGVwKHJhZGl1cywgcmFkaXVzICsgZWRnZVdpZHRoLCBsZW5ndGgocCAtIGNlbnRlcikpKTtcbiAgICB9XG5cbiAgICBmbG9hdCBzbW9vdGhOb2lzZSh2ZWMzIHV2dywgZmxvYXQgZnJlYyl7XG4gICAgICB2ZWMzIGx1dncgPSB2ZWMzKHNtb290aHN0ZXAoMC4wLCAxLjAsIGZyYWN0KHV2dy54eSAqIGZyZWMpKSwgZnJhY3QodXZ3LnogKiBmcmVjKSk7XG4gICAgICB2ZWMzIGlkID0gZmxvb3IodXZ3ICogZnJlYyk7XG4gICAgICBmbG9hdCBibHQgPSBub2lzZShpZCk7XG4gICAgICBmbG9hdCBicnQgPSBub2lzZShpZCArIHZlYzMoMS4wLCAwLjAsIDAuMCkpO1xuICAgICAgZmxvYXQgdGx0ID0gbm9pc2UoaWQgKyB2ZWMzKDAuMCwgMS4wLCAwLjApKTtcbiAgICAgIGZsb2F0IHRydCA9IG5vaXNlKGlkICsgdmVjMygxLjAsIDEuMCwgMC4wKSk7XG5cbiAgICAgIGZsb2F0IGJsYiA9IG5vaXNlKGlkICsgdmVjMygwLjAsIDAuMCwgMS4wKSk7XG4gICAgICBmbG9hdCBicmIgPSBub2lzZShpZCArIHZlYzMoMS4wLCAwLjAsIDEuMCkpO1xuICAgICAgZmxvYXQgdGxiID0gbm9pc2UoaWQgKyB2ZWMzKDAuMCwgMS4wLCAxLjApKTtcbiAgICAgIGZsb2F0IHRyYiA9IG5vaXNlKGlkICsgdmVjMygxLjAsIDEuMCwgMS4wKSk7XG5cbiAgICAgIGZsb2F0IGEgPSBtaXgoYmx0LCBicnQsIGx1dncueCk7XG4gICAgICBmbG9hdCBiID0gbWl4KHRsdCwgdHJ0LCBsdXZ3LngpO1xuICAgICAgZmxvYXQgYyA9IG1peChhLCBiLCBsdXZ3LnkpO1xuXG4gICAgICBmbG9hdCBkID0gbWl4KGJsYiwgYnJiLCBsdXZ3LngpO1xuICAgICAgZmxvYXQgZSA9IG1peCh0bGIsIHRyYiwgbHV2dy54KTtcbiAgICAgIGZsb2F0IGYgPSBtaXgoZCwgZSwgbHV2dy55KTtcblxuICAgICAgcmV0dXJuIG1peChjLCBmLCBsdXZ3LnopO1xuICAgIH1cblxuICAgICNkZWZpbmUgV0FMTF9DT0xPUiB2ZWMzKCR7V0FMTF9DT0xPUi5yfSwgJHtXQUxMX0NPTE9SLmd9LCAke1dBTExfQ09MT1IuYn0pXG4gICAgI2RlZmluZSBXQUxMX0JHIHZlYzMoJHtXQUxMX0JHLnJ9LCAke1dBTExfQkcuZ30sICR7V0FMTF9CRy5ifSlcblxuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHZlYzIgdXYxID0gdXZzLnh5LTAuNTtcbiAgICAgIGZsb2F0IGFuZ2xlID0gdGltZSAvIDEwLjA7XG4gICAgICB2ZWMyIHV2O1xuICAgICAgdXYueCA9IHV2MS54ICogY29zKGFuZ2xlKSAtIHV2MS55ICogc2luKGFuZ2xlKTtcbiAgICAgIHV2LnkgPSB1djEueSAqIGNvcyhhbmdsZSkgKyB1djEueCAqIHNpbihhbmdsZSk7XG4gICAgICB1di54ICs9IHNpbih1di55ICogMi43ICsgdGltZSAvIDEuNykgKiAwLjI7XG4gICAgICB1di55ICs9IHNpbih1di54ICogMy4xICsgdGltZSAvIDIuNCkgKiAwLjM7XG5cbiAgICAgIGZsb2F0IHcsIHIsIGJnO1xuICAgICAgciA9IHNtb290aE5vaXNlKHZlYzModXYgKyB3b3JsZFBvcy54LCB0aW1lIC8gMi4wKSwgMy4wKSAqIDAuNjU7XG4gICAgICByICs9IHNtb290aE5vaXNlKHZlYzModXYsIHRpbWUgLyA2LjApLCA4LjApICogMC4zO1xuICAgICAgciArPSBzbW9vdGhOb2lzZSh2ZWMzKHV2LCB0aW1lIC8gMTQuMCksIDUwLjApICogMC4wNDtcblxuICAgICAgYmcgPSBzbW9vdGhzdGVwKDAuNSwgMS4wLCByKSArIHNtb290aHN0ZXAoMC41LCAwLjAsIHIpO1xuICAgICAgciA9IHNtb290aHN0ZXAoMC40LCAwLjUwLCByKSAtIHNtb290aHN0ZXAoMC41MCwgMC42LCByKTtcbiAgICAgIHcgPSBzbW9vdGhzdGVwKDAuOTcsIDEuMCwgcik7XG5cblxuICAgICAgciArPSBzbW9vdGhzdGVwKDAuNDQsIDAuNTAsIGFicyh1djEueCkpO1xuICAgICAgciArPSBzbW9vdGhzdGVwKDAuNDQsIDAuNTAsIGFicyh1djEueSkpO1xuXG4gICAgICB3ICs9IHNtb290aHN0ZXAoMC40OSwgMC40OTgsIGFicyh1djEueCkpO1xuICAgICAgdyArPSBzbW9vdGhzdGVwKDAuNDksIDAuNDk4LCBhYnModXYxLnkpKTtcblxuICAgICAgdyAqPSAwLjk7XG4gICAgICBiZyAqPSAwLjU7XG5cbiAgICAgIHZlYzMgQ09MID0gV0FMTF9DT0xPUjtcbiAgICAgIHZlYzMgQkcgPSBXQUxMX0JHICogMC4xO1xuXG4gICAgICB2ZWMzIGNvbCA9IHZlYzMociAqIENPTC5yICsgdyArIEJHLnIsIHIgKiBDT0wuZyArIHcgKyBCRy5nLCByICogQ09MLmIgKyB3ICsgQkcuYik7XG5cbiAgICAgIHZlYzMgaGl0O1xuICAgICAgaGl0ID0gZHJhd0NpcmNsZSh3b3JsZFBvcywgaGl0UmlnaHQsIDAuMDQsIDAuMDUsIENPTCk7XG4gICAgICBoaXQgKz0gZHJhd0NpcmNsZSh3b3JsZFBvcywgaGl0UmlnaHQsIDAuMDIsIDAuMDMsIHZlYzMoMC43LCAwLjcsIDAuNykpO1xuICAgICAgaGl0ICs9IGRyYXdDaXJjbGUod29ybGRQb3MsIGhpdExlZnQsIDAuMDQsIDAuMDUsIENPTCk7XG4gICAgICBoaXQgKz0gZHJhd0NpcmNsZSh3b3JsZFBvcywgaGl0TGVmdCwgMC4wMiwgMC4wMywgdmVjMygwLjcsIDAuNywgMC43KSk7XG5cbiAgICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQoY29sICsgaGl0LCAwLjcgKyB3ICsgaGl0LngpO1xuICAgIH1cbmBcblxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy93YWxsLXNoYWRlci5qcyIsImltcG9ydCB7QkVBVF9XQVJNVVBfT0ZGU0VULCBCRUFUX1dBUk1VUF9TUEVFRCwgQkVBVF9XQVJNVVBfVElNRX0gZnJvbSAnLi4vY29uc3RhbnRzL2JlYXQnO1xuXG4vLyBTbyB3YWxsIGRvZXMgbm90IGNsaXAgdGhlIHN0YWdlIGdyb3VuZC5cbmNvbnN0IFJBSVNFX1lfT0ZGU0VUID0gMC4xO1xuXG5jb25zdCBXQUxMX1RISUNLTkVTUyA9IDAuNTA7XG5jb25zdCBDRUlMSU5HX1RISUNLTkVTUyA9IDEuNTtcbmNvbnN0IENFSUxJTkdfSEVJR0hUID0gMS40ICsgQ0VJTElOR19USElDS05FU1MgLyAyO1xuXG4vKipcbiAqIFdhbGwgdG8gZG9kZ2UuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnd2FsbCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgYW50aWNpcGF0aW9uUG9zaXRpb246IHtkZWZhdWx0OiAwfSxcbiAgICBkdXJhdGlvblNlY29uZHM6IHtkZWZhdWx0OiAwfSxcbiAgICBoZWlnaHQ6IHtkZWZhdWx0OiAxLjN9LFxuICAgIGhvcml6b250YWxQb3NpdGlvbjoge2RlZmF1bHQ6ICdtaWRkbGVsZWZ0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICBvbmVPZjogWydsZWZ0JywgJ21pZGRsZWxlZnQnLCAnbWlkZGxlcmlnaHQnLCAncmlnaHQnXX0sXG4gICAgaXNDZWlsaW5nOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHNwZWVkOiB7ZGVmYXVsdDogMS4wfSxcbiAgICB3YXJtdXBQb3NpdGlvbjoge2RlZmF1bHQ6IDB9LFxuICAgIHdpZHRoOiB7ZGVmYXVsdDogMX1cbiAgfSxcblxuICBob3Jpem9udGFsUG9zaXRpb25zOiB7XG4gICAgbGVmdDogLTAuNzUsXG4gICAgbWlkZGxlbGVmdDogLTAuMjUsXG4gICAgbWlkZGxlcmlnaHQ6IDAuMjUsXG4gICAgcmlnaHQ6IDAuNzVcbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tYXhaID0gMTA7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgY29uc3Qgd2lkdGggPSBkYXRhLndpZHRoICogV0FMTF9USElDS05FU1M7XG5cbiAgICBjb25zdCBoYWxmRGVwdGggPSBkYXRhLmR1cmF0aW9uU2Vjb25kcyAqIGRhdGEuc3BlZWQgLyAyO1xuXG4gICAgaWYgKGRhdGEuaXNDZWlsaW5nKSB7XG4gICAgICBlbC5vYmplY3QzRC5wb3NpdGlvbi5zZXQoXG4gICAgICAgIDAsXG4gICAgICAgIENFSUxJTkdfSEVJR0hULFxuICAgICAgICBkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uICsgZGF0YS53YXJtdXBQb3NpdGlvbiAtIGhhbGZEZXB0aFxuICAgICAgKTtcbiAgICAgIGVsLm9iamVjdDNELnNjYWxlLnNldChcbiAgICAgICAgd2lkdGgsXG4gICAgICAgIENFSUxJTkdfVEhJQ0tORVNTLFxuICAgICAgICBkYXRhLmR1cmF0aW9uU2Vjb25kcyAqIGRhdGEuc3BlZWRcbiAgICAgICk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQm94IGdlb21ldHJ5IGlzIGNvbnN0cnVjdGVkIGZyb20gdGhlIGxvY2FsIDAsMCwwIGdyb3dpbmcgaW4gdGhlIHBvc2l0aXZlIGFuZCBuZWdhdGl2ZVxuICAgIC8vIHggYW5kIHogYXhpcy4gV2UgaGF2ZSB0byBzaGlmdCBieSBoYWxmIHdpZHRoIGFuZCBkZXB0aCB0byBiZSBwb3NpdGlvbmVkIGNvcnJlY3RseS5cbiAgICBlbC5vYmplY3QzRC5wb3NpdGlvbi5zZXQoXG4gICAgICB0aGlzLmhvcml6b250YWxQb3NpdGlvbnNbZGF0YS5ob3Jpem9udGFsUG9zaXRpb25dICsgd2lkdGggLyAyICAtIDAuMjUsXG4gICAgICBkYXRhLmhlaWdodCArIFJBSVNFX1lfT0ZGU0VULFxuICAgICAgZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbiArIGRhdGEud2FybXVwUG9zaXRpb24gLSBoYWxmRGVwdGhcbiAgICApO1xuICAgIGVsLm9iamVjdDNELnNjYWxlLnNldChcbiAgICAgIHdpZHRoLFxuICAgICAgMi41LFxuICAgICAgZGF0YS5kdXJhdGlvblNlY29uZHMgKiBkYXRhLnNwZWVkXG4gICAgKTtcbiAgfSxcblxuICBwYXVzZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuZWwucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWNvbGxpZGFibGUtaGVhZCcpO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdkYXRhLWNvbGxpZGFibGUtaGVhZCcsICcnKTtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnZGF0YS1zYWJlci1wYXJ0aWNsZXMnLCAnJyk7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3JheWNhc3RhYmxlLWdhbWUnLCAnJyk7XG4gIH0sXG5cbiAgdG9jazogZnVuY3Rpb24gKHRpbWUsIHRpbWVEZWx0YSkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgY29uc3QgaGFsZkRlcHRoID0gZGF0YS5kdXJhdGlvblNlY29uZHMgKiBkYXRhLnNwZWVkIC8gMjtcbiAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb247XG5cbiAgICAvLyBNb3ZlLlxuICAgIGlmIChwb3NpdGlvbi56IDwgKGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb24gLSBoYWxmRGVwdGgpKSB7XG4gICAgICBsZXQgbmV3UG9zaXRpb25aID0gcG9zaXRpb24ueiArIEJFQVRfV0FSTVVQX1NQRUVEICogKHRpbWVEZWx0YSAvIDEwMDApO1xuICAgICAgLy8gV2FybSB1cCAvIHdhcnAgaW4uXG4gICAgICBpZiAobmV3UG9zaXRpb25aIDwgKGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb24gLSBoYWxmRGVwdGgpKSB7XG4gICAgICAgIHBvc2l0aW9uLnogPSBuZXdQb3NpdGlvblo7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwb3NpdGlvbi56ID0gZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbiAtIGhhbGZEZXB0aDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU3RhbmRhcmQgbW92aW5nLlxuICAgICAgcG9zaXRpb24ueiArPSB0aGlzLmRhdGEuc3BlZWQgKiAodGltZURlbHRhIC8gMTAwMCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24ueiA+ICh0aGlzLm1heFogKyBoYWxmRGVwdGgpKSB7XG4gICAgICB0aGlzLnJldHVyblRvUG9vbCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfSxcblxuICByZXR1cm5Ub1Bvb2w6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50cy5wb29sX193YWxsLnJldHVybkVudGl0eSh0aGlzLmVsKTtcbiAgICB0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uLnogPSA5OTk5O1xuICAgIHRoaXMuZWwucGF1c2UoKTtcbiAgICB0aGlzLmVsLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1jb2xsaWRhYmxlLWhlYWQnKTtcbiAgICB0aGlzLmVsLnJlbW92ZUF0dHJpYnV0ZSgncmF5Y2FzdGFibGUtZ2FtZScpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3dhbGwuanMiLCJtb2R1bGUuZXhwb3J0cyA9IFtcbiAge25hbWU6ICdQb3AnLCByb3c6IDEsIGNvbHVtbjogMX0sXG4gIHtuYW1lOiAnUiZCJywgcm93OiAxLCBjb2x1bW46IDJ9LFxuICB7bmFtZTogJ1JhcCcsIHJvdzogMSwgY29sdW1uOiAzfSxcbiAge25hbWU6ICdSb2NrJywgcm93OiAxLCBjb2x1bW46IDR9LFxuICB7bmFtZTogJ1NvdW5kdHJhY2snLCByb3c6IDEsIGNvbHVtbjogNX0sXG4gIHtuYW1lOiAnVmlkZW8gR2FtZXMnLCByb3c6IDEsIGNvbHVtbjogNn0sXG5cbiAge25hbWU6ICdFbGVjdHJvbmljJywgcm93OiAyLCBjb2x1bW46IDF9LFxuICB7bmFtZTogJ0hpcCBIb3AnLCByb3c6IDIsIGNvbHVtbjogMn0sXG4gIHtuYW1lOiAnSG91c2UnLCByb3c6IDIsIGNvbHVtbjogM30sXG4gIHtuYW1lOiAnSi1Qb3AnLCByb3c6IDIsIGNvbHVtbjogNH0sXG4gIHtuYW1lOiAnSy1Qb3AnLCByb3c6IDIsIGNvbHVtbjogNX0sXG4gIHtuYW1lOiAnTWVtZScsIHJvdzogMiwgY29sdW1uOiA2fSxcblxuICB7bmFtZTogJ0FsdGVybmF0aXZlJywgcm93OiAzLCBjb2x1bW46IDF9LFxuICB7bmFtZTogJ0FuaW1lJywgcm93OiAzLCBjb2x1bW46IDJ9LFxuICB7bmFtZTogJ0NvbWVkeScsIHJvdzogMywgY29sdW1uOiAzfSxcbiAge25hbWU6ICdEaXNuZXknLCByb3c6IDMsIGNvbHVtbjogNH0sXG4gIHtuYW1lOiAnRHVic3RlcCcsIHJvdzogMywgY29sdW1uOiA1fSxcbiAge25hbWU6ICdFRE0nLCByb3c6IDMsIGNvbHVtbjogNn1cbl07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29uc3RhbnRzL2dlbnJlcy5qcyIsImZ1bmN0aW9uIHJlcXVpcmVBbGwgKHJlcSkgeyByZXEua2V5cygpLmZvckVhY2gocmVxKTsgfVxuXG5yZXF1aXJlKCcuLi92ZW5kb3IvQnVmZmVyR2VvbWV0cnlVdGlscycpO1xuXG5yZXF1aXJlKCdhZnJhbWUtYWFiYi1jb2xsaWRlci1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS1hdGxhcy11dnMtY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtYXVkaW9hbmFseXNlci1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS1ldmVudC1zZXQtY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtZ2VvbWV0cnktbWVyZ2VyLWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLWhhcHRpY3MtY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtbGF5b3V0LWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLW9yYml0LWNvbnRyb2xzJyk7XG5yZXF1aXJlKCdhZnJhbWUtcHJveHktZXZlbnQtY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtcmluZy1zaGFkZXInKTtcbnJlcXVpcmUoJ2FmcmFtZS1zdGF0ZS1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS1zbGljZTktY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtdGh1bWItY29udHJvbHMtY29tcG9uZW50Jyk7XG5cbnJlcXVpcmVBbGwocmVxdWlyZS5jb250ZXh0KCcuL2NvbXBvbmVudHMvJywgdHJ1ZSwgL1xcLmpzJC8pKTtcbnJlcXVpcmVBbGwocmVxdWlyZS5jb250ZXh0KCcuL3N0YXRlLycsIHRydWUsIC9cXC5qcyQvKSk7XG5cbnJlcXVpcmUoJy4vaW5kZXguY3NzJyk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXguanMiLCIvKiBnbG9iYWwgQXVkaW8gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gU291bmRQb29sIChzcmMsIHZvbHVtZSkge1xuICB2YXIgY3VyclNvdW5kID0gMDtcbiAgdmFyIHBvb2wgPSBbXTtcbiAgdmFyIHNvdW5kO1xuXG4gIHNvdW5kID0gbmV3IEF1ZGlvKHNyYyk7XG4gIHNvdW5kLnZvbHVtZSA9IHZvbHVtZTtcbiAgcG9vbC5wdXNoKHNvdW5kKTtcblxuICByZXR1cm4ge1xuICAgIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIER5bmFtaWMgc2l6ZSBwb29sLlxuICAgICAgaWYgKHBvb2xbY3VyclNvdW5kXS5jdXJyZW50VGltZSAhPT0gMCB8fCAhcG9vbFtjdXJyU291bmRdLmVuZGVkKSB7XG4gICAgICAgIHNvdW5kID0gbmV3IEF1ZGlvKHNyYyk7XG4gICAgICAgIHNvdW5kLnZvbHVtZSA9IHZvbHVtZTtcbiAgICAgICAgcG9vbC5wdXNoKHNvdW5kKTtcbiAgICAgICAgY3VyclNvdW5kKys7XG4gICAgICB9XG5cbiAgICAgIGlmIChwb29sW2N1cnJTb3VuZF0uY3VycmVudFRpbWUgPT09IDAgfHwgcG9vbFtjdXJyU291bmRdLmVuZGVkKSB7XG4gICAgICAgIHBvb2xbY3VyclNvdW5kXS5wbGF5KCk7XG4gICAgICB9XG4gICAgICBjdXJyU291bmQgPSAoY3VyclNvdW5kICsgMSkgJSBwb29sLmxlbmd0aDtcbiAgICB9XG4gIH07XG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2xpYi9zb3VuZHBvb2wuanMiLCIvKiBnbG9iYWwgbG9jYWxTdG9yYWdlICovXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xuXG5jb25zdCBjaGFsbGVuZ2VEYXRhU3RvcmUgPSB7fTtcbmNvbnN0IE5VTV9MRUFERVJCT0FSRF9ESVNQTEFZID0gMTA7XG5jb25zdCBTRUFSQ0hfUEVSX1BBR0UgPSA2O1xuY29uc3QgU09OR19OQU1FX1RSVU5DQVRFID0gMjQ7XG5jb25zdCBTT05HX1NVQl9OQU1FX1RSVU5DQVRFID0gMzI7XG5cbmNvbnN0IERBTUFHRV9ERUNBWSA9IDAuMjU7XG5jb25zdCBEQU1BR0VfTUFYID0gMTA7XG5cbmNvbnN0IERFQlVHX0NIQUxMRU5HRSA9IHtcbiAgYXV0aG9yOiAnU3VwZXJtYW4nLFxuICBkaWZmaWN1bHR5OiAnRXhwZXJ0JyxcbiAgaWQ6ICczMScsXG4gIGltYWdlOiAnYXNzZXRzL2ltZy9tb2xlcmF0LmpwZycsXG4gIHNvbmdOYW1lOiAnRnJpZGF5JyxcbiAgc29uZ0xlbmd0aDogMTAwLFxuICBzb25nU3ViTmFtZTogJ1JlYmVjY2EgQmxhY2snXG59O1xuXG4vKipcbiAqIFN0YXRlIGhhbmRsZXIuXG4gKlxuICogMS4gYGhhbmRsZXJzYCBpcyBhbiBvYmplY3Qgb2YgZXZlbnRzIHRoYXQgd2hlbiBlbWl0dGVkIHRvIHRoZSBzY2VuZSB3aWxsIHJ1biB0aGUgaGFuZGxlci5cbiAqXG4gKiAyLiBUaGUgaGFuZGxlciBmdW5jdGlvbiBtb2RpZmllcyB0aGUgc3RhdGUuXG4gKlxuICogMy4gRW50aXRpZXMgYW5kIGNvbXBvbmVudHMgdGhhdCBhcmUgYGJpbmRgZWQgYXV0b21hdGljYWxseSB1cGRhdGU6XG4gKiAgICBgYmluZF9fPGNvbXBvbmVudE5hbWU+PVwiPHByb3BlcnR5TmFtZT46IHNvbWUuaXRlbS5pbi5zdGF0ZVwiYFxuICovXG5BRlJBTUUucmVnaXN0ZXJTdGF0ZSh7XG4gIG5vbkJpbmRlZFN0YXRlS2V5czogWydnZW5yZXMnXSxcblxuICBpbml0aWFsU3RhdGU6IHtcbiAgICBhY3RpdmVIYW5kOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnaGFuZCcpIHx8ICdyaWdodCcsXG4gICAgY2hhbGxlbmdlOiB7ICAvLyBBY3RpdmVseSBwbGF5aW5nIGNoYWxsZW5nZS5cbiAgICAgIGF1dGhvcjogJycsXG4gICAgICBkaWZmaWN1bHR5OiAnJyxcbiAgICAgIGlkOiBBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdjaGFsbGVuZ2UnKSwgIC8vIFdpbGwgYmUgZW1wdHkgc3RyaW5nIGlmIG5vdCBwbGF5aW5nLlxuICAgICAgaW1hZ2U6ICcnLFxuICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgIGlzQmVhdHNQcmVsb2FkZWQ6IGZhbHNlLCAgLy8gV2hldGhlciB3ZSBoYXZlIHBhc3NlZCB0aGUgbmVnYXRpdmUgdGltZS5cbiAgICAgIG51bUJlYXRzOiB1bmRlZmluZWQsXG4gICAgICBzb25nRHVyYXRpb246IDAsXG4gICAgICBzb25nTmFtZTogJycsXG4gICAgICBzb25nU3ViTmFtZTogJydcbiAgICB9LFxuICAgIGNvbnRyb2xsZXJUeXBlOiAnJyxcbiAgICBkYW1hZ2U6IDAsXG4gICAgZ2VucmU6ICcnLFxuICAgIGdlbnJlczogcmVxdWlyZSgnLi4vY29uc3RhbnRzL2dlbnJlcycpLFxuICAgIGdlbnJlTWVudU9wZW46IGZhbHNlLFxuICAgIGluVlI6IGZhbHNlLFxuICAgIGlzR2FtZU92ZXI6IGZhbHNlLCAgLy8gR2FtZSBvdmVyIHNjcmVlbi5cbiAgICBpc1BhdXNlZDogZmFsc2UsICAvLyBQbGF5aW5nLCBidXQgcGF1c2VkLiBOb3QgYWN0aXZlIGR1cmluZyBtZW51LlxuICAgIGlzUGxheWluZzogZmFsc2UsICAvLyBBY3RpdmVseSBwbGF5aW5nIChzbGljaW5nIGJlYXRzKS5cbiAgICBpc1NlYXJjaGluZzogZmFsc2UsICAvLyBXaGV0aGVyIHNlYXJjaCBpcyBvcGVuLlxuICAgIGlzU29uZ0ZldGNoaW5nOiBmYWxzZSwgIC8vIEZldGNoaW5nIHN0YWdlLlxuICAgIGlzU29uZ0xvYWRpbmc6IGZhbHNlLCAgLy8gRWl0aGVyIGZldGNoaW5nIG9yIGRlY29kaW5nLlxuICAgIGlzVmljdG9yeTogZmFsc2UsICAvLyBWaWN0b3J5IHNjcmVlbi5cbiAgICBsZWFkZXJib2FyZDogW10sXG4gICAgbGVhZGVyYm9hcmRGZXRjaGVkOiBmYWxzZSxcbiAgICBsZWFkZXJib2FyZFF1YWxpZmllZDogZmFsc2UsXG4gICAgbGVhZGVyYm9hcmROYW1lczogJycsXG4gICAgbGVhZGVyYm9hcmRTY29yZXM6ICcnLFxuICAgIG1lbnVBY3RpdmU6IHRydWUsICAvLyBNYWluIG1lbnUgYWN0aXZlLlxuICAgIG1lbnVEaWZmaWN1bHRpZXM6IFtdLCAgLy8gTGlzdCBvZiBzdHJpbmdzIG9mIGF2YWlsYWJsZSBkaWZmaWN1bHRpZXMgZm9yIHNlbGVjdGVkLlxuICAgIG1lbnVTZWxlY3RlZENoYWxsZW5nZTogeyAgLy8gQ3VycmVudGx5IHNlbGVjdGVkIGNoYWxsZW5nZSBpbiB0aGUgbWFpbiBtZW51LlxuICAgICAgYXV0aG9yOiAnJyxcbiAgICAgIGRpZmZpY3VsdHk6ICcnLFxuICAgICAgZG93bmxvYWRzOiAnJyxcbiAgICAgIGRvd25sb2Fkc1RleHQ6ICcnLFxuICAgICAgZ2VucmU6ICcnLFxuICAgICAgaWQ6ICcnLFxuICAgICAgaW5kZXg6IC0xLFxuICAgICAgaW1hZ2U6ICcnLFxuICAgICAgbnVtQmVhdHM6IHVuZGVmaW5lZCxcbiAgICAgIHNvbmdEdXJhdGlvbjogMCxcbiAgICAgIHNvbmdJbmZvVGV4dDogJycsXG4gICAgICBzb25nTGVuZ3RoOiB1bmRlZmluZWQsXG4gICAgICBzb25nTmFtZTogJycsXG4gICAgICBzb25nU3ViTmFtZTogJydcbiAgICB9LFxuICAgIHNjb3JlOiB7XG4gICAgICBhY2N1cmFjeTogMCwgIC8vIE91dCBvZiAxMDAuXG4gICAgICBiZWF0c0hpdDogMCxcbiAgICAgIGJlYXRzTWlzc2VkOiAwLFxuICAgICAgYmVhdHNUZXh0OiAnJyxcbiAgICAgIGNvbWJvOiAwLFxuICAgICAgbWF4Q29tYm86IDAsXG4gICAgICBtdWx0aXBsaWVyOiAxLFxuICAgICAgcmFuazogJycsICAvLyBHcmFkZSAoUyB0byBGKS5cbiAgICAgIHNjb3JlOiAwXG4gICAgfSxcbiAgICBzZWFyY2g6IHtcbiAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgIHBhZ2U6IDAsXG4gICAgICBoYXNFcnJvcjogZmFsc2UsXG4gICAgICBoYXNOZXh0OiBmYWxzZSxcbiAgICAgIGhhc1ByZXY6IGZhbHNlLFxuICAgICAgcXVlcnk6ICcnLFxuICAgICAgcmVzdWx0czogW10sXG4gICAgICBzb25nTmFtZVRleHRzOiAnJywgIC8vIEFsbCBuYW1lcyBpbiBzZWFyY2ggcmVzdWx0cyBtZXJnZWQgdG9nZXRoZXIuXG4gICAgICBzb25nU3ViTmFtZVRleHRzOiAnJyAgLy8gQWxsIHN1YiBuYW1lcyBpbiBzZWFyY2ggcmVzdWx0cyBtZXJnZWQgdG9nZXRoZXIuXG4gICAgfSxcbiAgICBzZWFyY2hSZXN1bHRzUGFnZTogW11cbiAgfSxcblxuICBoYW5kbGVyczoge1xuICAgIC8qKlxuICAgICAqIFN3YXAgbGVmdC1oYW5kZWQgb3IgcmlnaHQtaGFuZGVkIG1vZGUuXG4gICAgICovXG4gICAgYWN0aXZlaGFuZHN3YXA6IHN0YXRlID0+IHtcbiAgICAgIHN0YXRlLmFjdGl2ZUhhbmQgPSBzdGF0ZS5hY3RpdmVIYW5kID09PSAncmlnaHQnID8gJ2xlZnQnIDogJ3JpZ2h0JztcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVIYW5kJywgc3RhdGUuYWN0aXZlSGFuZCk7XG4gICAgfSxcblxuICAgIGJlYXRoaXQ6IChzdGF0ZSwgcGF5bG9hZCkgPT4ge1xuICAgICAgaWYgKHN0YXRlLmRhbWFnZSA+IERBTUFHRV9ERUNBWSkge1xuICAgICAgICBzdGF0ZS5kYW1hZ2UgLT0gREFNQUdFX0RFQ0FZO1xuICAgICAgfVxuICAgICAgc3RhdGUuc2NvcmUuYmVhdHNIaXQrKztcbiAgICAgIHN0YXRlLnNjb3JlLmNvbWJvKys7XG4gICAgICBpZiAoc3RhdGUuc2NvcmUuY29tYm8gPiBzdGF0ZS5zY29yZS5tYXhDb21ibykge1xuICAgICAgICBzdGF0ZS5zY29yZS5tYXhDb21ibyA9IHN0YXRlLnNjb3JlLmNvbWJvO1xuICAgICAgfVxuXG4gICAgICBzdGF0ZS5zY29yZS5zY29yZSArPSBNYXRoLmZsb29yKHBheWxvYWQuc2NvcmUgKiBzdGF0ZS5zY29yZS5tdWx0aXBsaWVyKTtcblxuICAgICAgLy8gTWlnaHQgYmUgYSBtYXRoIGZvcm11bGEgZm9yIHRoaXMsIGJ1dCB0aGUgbXVsdGlwbGllciBzeXN0ZW0gaXMgZWFzeSByZWR1Y2VkLlxuICAgICAgaWYgKHN0YXRlLnNjb3JlLmNvbWJvIDwgMikge1xuICAgICAgICBzdGF0ZS5zY29yZS5tdWx0aXBsaWVyID0gMTtcbiAgICAgIH0gZWxzZSBpZiAoc3RhdGUuc2NvcmUuY29tYm8gPCA2KSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLm11bHRpcGxpZXIgPSAyO1xuICAgICAgfSBlbHNlIGlmIChzdGF0ZS5zY29yZS5jb21ibyA8IDE0KSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLm11bHRpcGxpZXIgPSA0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RhdGUuc2NvcmUubXVsdGlwbGllciA9IDg7XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZVNjb3JlQWNjdXJhY3koc3RhdGUpO1xuICAgIH0sXG5cbiAgICBiZWF0bWlzczogc3RhdGUgPT4ge1xuICAgICAgc3RhdGUuc2NvcmUuYmVhdHNNaXNzZWQrKztcbiAgICAgIHRha2VEYW1hZ2Uoc3RhdGUpO1xuICAgICAgdXBkYXRlU2NvcmVBY2N1cmFjeShzdGF0ZSk7XG4gICAgfSxcblxuICAgIGJlYXR3cm9uZzogc3RhdGUgPT4ge1xuICAgICAgc3RhdGUuc2NvcmUuYmVhdHNNaXNzZWQrKztcbiAgICAgIHRha2VEYW1hZ2Uoc3RhdGUpO1xuICAgICAgdXBkYXRlU2NvcmVBY2N1cmFjeShzdGF0ZSk7XG4gICAgfSxcblxuICAgIGJlYXRsb2FkZXJmaW5pc2g6IChzdGF0ZSwgcGF5bG9hZCkgPT4ge1xuICAgICAgc3RhdGUuY2hhbGxlbmdlLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBiZWF0bG9hZGVycHJlbG9hZGZpbmlzaDogKHN0YXRlKSA9PiB7XG4gICAgICBpZiAoc3RhdGUubWVudUFjdGl2ZSkgeyByZXR1cm47IH0gIC8vIENhbmNlbGxlZC5cbiAgICAgIHN0YXRlLmNoYWxsZW5nZS5pc0JlYXRzUHJlbG9hZGVkID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgYmVhdGxvYWRlcnN0YXJ0OiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmNoYWxsZW5nZS5pc0JlYXRzUHJlbG9hZGVkID0gZmFsc2U7XG4gICAgICBzdGF0ZS5jaGFsbGVuZ2UuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgY29udHJvbGxlcmNvbm5lY3RlZDogKHN0YXRlLCBwYXlsb2FkKSA9PiB7XG4gICAgICBzdGF0ZS5jb250cm9sbGVyVHlwZSA9IHBheWxvYWQubmFtZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVG8gd29yayBvbiBnYW1lIG92ZXIgcGFnZS5cbiAgICAgKlxuICAgICAqID9kZWJ1Z3N0YXRlPWdhbWVwbGF5XG4gICAgICovXG4gICAgZGVidWdnYW1lcGxheTogc3RhdGUgPT4ge1xuICAgICAgcmVzZXRTY29yZShzdGF0ZSk7XG5cbiAgICAgIC8vIFNldCBjaGFsbGVuZ2UuIGBiZWF0LWxvYWRlcmAgaXMgbGlzdGVuaW5nLlxuICAgICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5jaGFsbGVuZ2UsIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZSk7XG5cbiAgICAgIC8vIFJlc2V0IG1lbnUuXG4gICAgICBzdGF0ZS5tZW51QWN0aXZlID0gZmFsc2U7XG4gICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaWQgPSAnJztcblxuICAgICAgc3RhdGUuaXNTZWFyY2hpbmcgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzU29uZ0xvYWRpbmcgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVG8gd29yayBvbiBnYW1lIG92ZXIgcGFnZS5cbiAgICAgKlxuICAgICAqID9kZWJ1Z3N0YXRlPWdhbWVvdmVyXG4gICAgICovXG4gICAgZGVidWdnYW1lb3Zlcjogc3RhdGUgPT4ge1xuICAgICAgc3RhdGUuaXNHYW1lT3ZlciA9IHRydWU7XG4gICAgICBzdGF0ZS5tZW51QWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFRvIHdvcmsgb24gdmljdG9yeSBwYWdlLlxuICAgICAqXG4gICAgICogP2RlYnVnc3RhdGU9bG9hZGluZ1xuICAgICAqL1xuICAgIGRlYnVnbG9hZGluZzogc3RhdGUgPT4ge1xuICAgICAgREVCVUdfQ0hBTExFTkdFLmlkID0gJy0xJztcbiAgICAgIE9iamVjdC5hc3NpZ24oc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLCBERUJVR19DSEFMTEVOR0UpO1xuICAgICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5jaGFsbGVuZ2UsIERFQlVHX0NIQUxMRU5HRSk7XG4gICAgICBzdGF0ZS5tZW51QWN0aXZlID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1NvbmdGZXRjaGluZyA9IHRydWU7XG4gICAgICBzdGF0ZS5pc1NvbmdMb2FkaW5nID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVG8gd29yayBvbiB2aWN0b3J5IHBhZ2UuXG4gICAgICpcbiAgICAgKiA/ZGVidWdzdGF0ZT12aWN0b3J5XG4gICAgICovXG4gICAgZGVidWd2aWN0b3J5OiBzdGF0ZSA9PiB7XG4gICAgICBPYmplY3QuYXNzaWduKHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZSwgREVCVUdfQ0hBTExFTkdFKTtcbiAgICAgIE9iamVjdC5hc3NpZ24oc3RhdGUuY2hhbGxlbmdlLCBERUJVR19DSEFMTEVOR0UpO1xuICAgICAgc3RhdGUuaXNWaWN0b3J5ID0gdHJ1ZTtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkUXVhbGlmaWVkID0gdHJ1ZTtcbiAgICAgIHN0YXRlLm1lbnVBY3RpdmUgPSBmYWxzZTtcbiAgICAgIHN0YXRlLnNjb3JlLmFjY3VyYWN5ID0gNzQuOTk7XG4gICAgICBzdGF0ZS5zY29yZS5iZWF0c0hpdCA9IDEyNTtcbiAgICAgIHN0YXRlLnNjb3JlLmJlYXRzTWlzc2VkID0gMTI1O1xuICAgICAgc3RhdGUuc2NvcmUubWF4Q29tYm8gPSAxMjM7XG4gICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0MnO1xuICAgICAgc3RhdGUuc2NvcmUuc2NvcmUgPSA5MDAxO1xuICAgICAgY29tcHV0ZUJlYXRzVGV4dChzdGF0ZSk7XG4gICAgfSxcblxuICAgIGdhbWVtZW51cmVzdW1lOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmlzUGF1c2VkID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGdhbWVtZW51cmVzdGFydDogKHN0YXRlKSA9PiB7XG4gICAgICByZXNldFNjb3JlKHN0YXRlKTtcbiAgICAgIHN0YXRlLmNoYWxsZW5nZS5pc0JlYXRzUHJlbG9hZGVkID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc0dhbWVPdmVyID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1BhdXNlZCA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNTb25nTG9hZGluZyA9IHRydWU7XG4gICAgICBzdGF0ZS5pc1ZpY3RvcnkgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkUXVhbGlmaWVkID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGdhbWVtZW51ZXhpdDogKHN0YXRlKSA9PiB7XG4gICAgICByZXNldFNjb3JlKHN0YXRlKTtcbiAgICAgIHN0YXRlLmNoYWxsZW5nZS5pc0JlYXRzUHJlbG9hZGVkID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc0dhbWVPdmVyID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1BhdXNlZCA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNWaWN0b3J5ID0gZmFsc2U7XG4gICAgICBzdGF0ZS5tZW51QWN0aXZlID0gdHJ1ZTtcbiAgICAgIHN0YXRlLmNoYWxsZW5nZS5pZCA9ICcnO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRRdWFsaWZpZWQgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgZ2VucmVjbGVhcjogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5nZW5yZSA9ICcnO1xuICAgIH0sXG5cbiAgICBnZW5yZW1lbnVjbG9zZTogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5nZW5yZU1lbnVPcGVuID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGdlbnJlbWVudW9wZW46IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuZ2VucmVNZW51T3BlbiA9IHRydWU7XG4gICAgfSxcblxuICAgIGtleWJvYXJkY2xvc2U6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuaXNTZWFyY2hpbmcgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAga2V5Ym9hcmRvcGVuOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmlzU2VhcmNoaW5nID0gdHJ1ZTtcbiAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pZCA9ICcnO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBIaWdoIHNjb3Jlcy5cbiAgICAgKi9cbiAgICBsZWFkZXJib2FyZDogKHN0YXRlLCBwYXlsb2FkKSA9PiB7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZC5sZW5ndGggPSAwO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRGZXRjaGVkID0gdHJ1ZTtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkTmFtZXMgPSAnJztcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkU2NvcmVzID0gJyc7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBheWxvYWQuc2NvcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBzY29yZSA9IHBheWxvYWQuc2NvcmVzW2ldO1xuICAgICAgICBzdGF0ZS5sZWFkZXJib2FyZC5wdXNoKHNjb3JlKTtcbiAgICAgICAgc3RhdGUubGVhZGVyYm9hcmROYW1lcyArPSBgJHtzY29yZS51c2VybmFtZX0gKCR7c2NvcmUuYWNjdXJhY3kgfHwgMH0lKVxcbmA7XG4gICAgICAgIHN0YXRlLmxlYWRlcmJvYXJkU2NvcmVzICs9IGAke3Njb3JlLnNjb3JlfVxcbmA7XG4gICAgICB9XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZExvYWRpbmcgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgbGVhZGVyYm9hcmRxdWFsaWZ5OiBzdGF0ZSA9PiB7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZFF1YWxpZmllZCA9IHRydWU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEluc2VydCBuZXcgc2NvcmUgaW50byBsZWFkZXJib2FyZCBsb2NhbGx5LlxuICAgICAqL1xuICAgIGxlYWRlcmJvYXJkc2NvcmVhZGRlZDogKHN0YXRlLCBwYXlsb2FkKSA9PiB7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZC5zcGxpY2UocGF5bG9hZC5pbmRleCwgMCwgcGF5bG9hZC5zY29yZURhdGEpO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmROYW1lcyA9ICcnO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRTY29yZXMgPSAnJztcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTlVNX0xFQURFUkJPQVJEX0RJU1BMQVk7IGkrKykge1xuICAgICAgICBsZXQgc2NvcmUgPSBzdGF0ZS5sZWFkZXJib2FyZFtpXTtcbiAgICAgICAgc3RhdGUubGVhZGVyYm9hcmROYW1lcyArPSBgJHtzY29yZS51c2VybmFtZX0gKCR7c2NvcmUuYWNjdXJhY3kgfHwgMH0lKVxcbmA7XG4gICAgICAgIHN0YXRlLmxlYWRlcmJvYXJkU2NvcmVzICs9IGAke3Njb3JlLnNjb3JlfVxcbmA7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGxlYWRlcmJvYXJkc3VibWl0OiBzdGF0ZSA9PiB7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZFF1YWxpZmllZCA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTb25nIGNsaWNrZWQgZnJvbSBtZW51LlxuICAgICAqL1xuICAgIG1lbnVjaGFsbGVuZ2VzZWxlY3Q6IChzdGF0ZSwgaWQpID0+IHtcbiAgICAgIC8vIENvcHkgZnJvbSBjaGFsbGVuZ2Ugc3RvcmUgcG9wdWxhdGVkIGZyb20gc2VhcmNoIHJlc3VsdHMuXG4gICAgICBsZXQgY2hhbGxlbmdlID0gY2hhbGxlbmdlRGF0YVN0b3JlW2lkXTtcbiAgICAgIE9iamVjdC5hc3NpZ24oc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLCBjaGFsbGVuZ2UpO1xuXG4gICAgICAvLyBQb3B1bGF0ZSBkaWZmaWN1bHR5IG9wdGlvbnMuXG4gICAgICBzdGF0ZS5tZW51RGlmZmljdWx0aWVzLmxlbmd0aCA9IDA7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoYWxsZW5nZS5kaWZmaWN1bHRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc3RhdGUubWVudURpZmZpY3VsdGllcy51bnNoaWZ0KGNoYWxsZW5nZS5kaWZmaWN1bHRpZXNbaV0pO1xuICAgICAgfVxuICAgICAgc3RhdGUubWVudURpZmZpY3VsdGllcy5zb3J0KGRpZmZpY3VsdHlDb21wYXJhdG9yKTtcblxuICAgICAgLy8gRGVmYXVsdCB0byBlYXNpZXN0IGRpZmZpY3VsdHkuXG4gICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuZGlmZmljdWx0eSA9IHN0YXRlLm1lbnVEaWZmaWN1bHRpZXNbMF07XG5cbiAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pbWFnZSA9IHV0aWxzLmdldFMzRmlsZVVybChpZCwgJ2ltYWdlLmpwZycpO1xuICAgICAgdXBkYXRlTWVudVNvbmdJbmZvKHN0YXRlLCBjaGFsbGVuZ2UpO1xuXG4gICAgICBjb21wdXRlTWVudVNlbGVjdGVkQ2hhbGxlbmdlSW5kZXgoc3RhdGUpO1xuICAgICAgc3RhdGUuaXNTZWFyY2hpbmcgPSBmYWxzZTtcblxuICAgICAgY2xlYXJMZWFkZXJib2FyZChzdGF0ZSk7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZExvYWRpbmcgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBtZW51Y2hhbGxlbmdldW5zZWxlY3Q6IHN0YXRlID0+IHtcbiAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pZCA9ICcnO1xuICAgICAgY2xlYXJMZWFkZXJib2FyZChzdGF0ZSk7XG4gICAgfSxcblxuICAgIG1lbnVkaWZmaWN1bHR5c2VsZWN0OiAoc3RhdGUsIGRpZmZpY3VsdHkpID0+IHtcbiAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5kaWZmaWN1bHR5ID0gZGlmZmljdWx0eTtcbiAgICAgIHVwZGF0ZU1lbnVTb25nSW5mbyhzdGF0ZSwgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlKTtcblxuICAgICAgY2xlYXJMZWFkZXJib2FyZChzdGF0ZSk7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZExvYWRpbmcgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBtaW5laGl0OiBzdGF0ZSA9PiB7XG4gICAgICB0YWtlRGFtYWdlKHN0YXRlKTtcbiAgICB9LFxuXG4gICAgcGF1c2VnYW1lOiAoc3RhdGUpID0+IHtcbiAgICAgIGlmICghc3RhdGUuaXNQbGF5aW5nKSB7IHJldHVybjsgfVxuICAgICAgc3RhdGUuaXNQYXVzZWQgPSB0cnVlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBjaGFsbGVuZ2UuXG4gICAgICogVHJhbnNmZXIgc3RhZ2VkIGNoYWxsZW5nZSB0byB0aGUgYWN0aXZlIGNoYWxsZW5nZS5cbiAgICAgKi9cbiAgICBwbGF5YnV0dG9uY2xpY2s6IChzdGF0ZSkgPT4ge1xuICAgICAgcmVzZXRTY29yZShzdGF0ZSk7XG5cbiAgICAgIC8vIFNldCBjaGFsbGVuZ2UuIGBiZWF0LWxvYWRlcmAgaXMgbGlzdGVuaW5nLlxuICAgICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5jaGFsbGVuZ2UsIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZSk7XG5cbiAgICAgIC8vIFJlc2V0IG1lbnUuXG4gICAgICBzdGF0ZS5tZW51QWN0aXZlID0gZmFsc2U7XG4gICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaWQgPSAnJztcblxuICAgICAgc3RhdGUuaXNTZWFyY2hpbmcgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzU29uZ0xvYWRpbmcgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBzZWFyY2hlcnJvcjogKHN0YXRlLCBwYXlsb2FkKSA9PiB7XG4gICAgICBzdGF0ZS5zZWFyY2guaGFzRXJyb3IgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBzZWFyY2hwcmV2cGFnZTogZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICBpZiAoc3RhdGUuc2VhcmNoLnBhZ2UgPT09IDApIHsgcmV0dXJuOyB9XG4gICAgICBzdGF0ZS5zZWFyY2gucGFnZS0tO1xuICAgICAgY29tcHV0ZVNlYXJjaFBhZ2luYXRpb24oc3RhdGUpO1xuICAgIH0sXG5cbiAgICBzZWFyY2huZXh0cGFnZTogZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICBpZiAoc3RhdGUuc2VhcmNoLnBhZ2UgPiBNYXRoLmZsb29yKHN0YXRlLnNlYXJjaC5yZXN1bHRzLmxlbmd0aCAvIFNFQVJDSF9QRVJfUEFHRSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc3RhdGUuc2VhcmNoLnBhZ2UrKztcbiAgICAgIGNvbXB1dGVTZWFyY2hQYWdpbmF0aW9uKHN0YXRlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHNlYXJjaCByZXN1bHRzLiBXaWxsIGF1dG9tYXRpY2FsbHkgcmVuZGVyIHVzaW5nIGBiaW5kLWZvcmAgKG1lbnUuaHRtbCkuXG4gICAgICovXG4gICAgc2VhcmNocmVzdWx0czogKHN0YXRlLCBwYXlsb2FkKSA9PiB7XG4gICAgICB2YXIgaTtcbiAgICAgIHN0YXRlLnNlYXJjaC5oYXNFcnJvciA9IGZhbHNlO1xuICAgICAgc3RhdGUuc2VhcmNoLnBhZ2UgPSAwO1xuICAgICAgc3RhdGUuc2VhcmNoLnF1ZXJ5ID0gcGF5bG9hZC5xdWVyeTtcbiAgICAgIHN0YXRlLnNlYXJjaC5yZXN1bHRzID0gcGF5bG9hZC5yZXN1bHRzO1xuICAgICAgZm9yIChpID0gMDsgaSA8IHBheWxvYWQucmVzdWx0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgcmVzdWx0ID0gcGF5bG9hZC5yZXN1bHRzW2ldO1xuICAgICAgICByZXN1bHQuc29uZ1N1Yk5hbWUgPSByZXN1bHQuc29uZ1N1Yk5hbWUgfHwgJ1Vua25vd24gQXJ0aXN0JztcbiAgICAgICAgcmVzdWx0LnNob3J0U29uZ05hbWUgPSB0cnVuY2F0ZShyZXN1bHQuc29uZ05hbWUsIFNPTkdfTkFNRV9UUlVOQ0FURSkudG9VcHBlckNhc2UoKTtcbiAgICAgICAgcmVzdWx0LnNob3J0U29uZ1N1Yk5hbWUgPSB0cnVuY2F0ZShyZXN1bHQuc29uZ1N1Yk5hbWUsIFNPTkdfU1VCX05BTUVfVFJVTkNBVEUpO1xuICAgICAgICBjaGFsbGVuZ2VEYXRhU3RvcmVbcmVzdWx0LmlkXSA9IHJlc3VsdDtcbiAgICAgIH1cbiAgICAgIGNvbXB1dGVTZWFyY2hQYWdpbmF0aW9uKHN0YXRlKTtcblxuICAgICAgaWYgKHBheWxvYWQuaXNHZW5yZVNlYXJjaCkge1xuICAgICAgICBzdGF0ZS5nZW5yZU1lbnVPcGVuID0gZmFsc2U7XG4gICAgICAgIHN0YXRlLmdlbnJlID0gcGF5bG9hZC5nZW5yZTtcbiAgICAgICAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmlkID0gJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGF0ZS5nZW5yZSA9ICcnO1xuICAgICAgICBjb21wdXRlTWVudVNlbGVjdGVkQ2hhbGxlbmdlSW5kZXgoc3RhdGUpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBzb25nZmV0Y2hmaW5pc2g6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuaXNTb25nRmV0Y2hpbmcgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgc29uZ2xvYWRjYW5jZWw6IHN0YXRlID0+IHtcbiAgICAgIHN0YXRlLmNoYWxsZW5nZS5pc0JlYXRzUHJlbG9hZGVkID0gZmFsc2U7XG4gICAgICBzdGF0ZS5jaGFsbGVuZ2UuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1NvbmdMb2FkaW5nID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1NvbmdGZXRjaGluZyA9IGZhbHNlO1xuICAgICAgc3RhdGUubWVudUFjdGl2ZSA9IHRydWU7XG4gICAgfSxcblxuICAgIHNvbmdsb2FkZmluaXNoOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmlzU29uZ0ZldGNoaW5nID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1NvbmdMb2FkaW5nID0gZmFsc2U7XG4gICAgfSxcblxuICAgIHNvbmdsb2Fkc3RhcnQ6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuaXNTb25nRmV0Y2hpbmcgPSB0cnVlO1xuICAgICAgc3RhdGUuaXNTb25nTG9hZGluZyA9IHRydWU7XG4gICAgfSxcblxuICAgICdlbnRlci12cic6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuaW5WUiA9IHRydWU7XG4gICAgfSxcblxuICAgICdleGl0LXZyJzogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5pblZSID0gZmFsc2U7XG4gICAgfSxcblxuICAgIHZpY3Rvcnk6IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgc3RhdGUuaXNWaWN0b3J5ID0gdHJ1ZTtcblxuICAgICAgLy8gUGVyY2VudGFnZSBpcyBzY29yZSBkaXZpZGVkIGJ5IHRvdGFsIHBvc3NpYmxlIHNjb3JlLlxuICAgICAgY29uc3QgYWNjdXJhY3kgPSAoc3RhdGUuc2NvcmUuc2NvcmUgLyAoc3RhdGUuY2hhbGxlbmdlLm51bUJlYXRzICogMTEwKSkgKiAxMDA7XG4gICAgICBzdGF0ZS5zY29yZS5hY2N1cmFjeSA9IGlzTmFOKGFjY3VyYWN5KSA/IDAgOiBhY2N1cmFjeTtcbiAgICAgIHN0YXRlLnNjb3JlLnNjb3JlID0gaXNOYU4oc3RhdGUuc2NvcmUuc2NvcmUpID8gMCA6IHN0YXRlLnNjb3JlLnNjb3JlO1xuXG4gICAgICBpZiAoYWNjdXJhY3kgPj0gOTUpIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdTJztcbiAgICAgIH0gZWxzZSBpZiAoYWNjdXJhY3kgPj0gOTMpIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdBJztcbiAgICAgIH0gZWxzZSBpZiAoYWNjdXJhY3kgPj0gOTApIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdBLSc7XG4gICAgICB9IGVsc2UgaWYgKGFjY3VyYWN5ID49IDg4KSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQisnO1xuICAgICAgfSBlbHNlIGlmIChhY2N1cmFjeSA+PSA4Mykge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0InO1xuICAgICAgfSBlbHNlIGlmIChhY2N1cmFjeSA+PSA4MCkge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0ItJztcbiAgICAgIH0gZWxzZSBpZiAoYWNjdXJhY3kgPj0gNzgpIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdDKyc7XG4gICAgICB9IGVsc2UgaWYgKGFjY3VyYWN5ID49IDczKSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQyc7XG4gICAgICB9IGVsc2UgaWYgKGFjY3VyYWN5ID49IDcwKSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQy0nO1xuICAgICAgfSBlbHNlIGlmIChhY2N1cmFjeSA+PSA2MCkge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0QnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdGJztcbiAgICAgIH1cblxuICAgICAgY29tcHV0ZUJlYXRzVGV4dChzdGF0ZSk7XG4gICAgfSxcblxuICAgIHZpY3RvcnlmYWtlOiBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgIHN0YXRlLnNjb3JlLmFjY3VyYWN5ID0gJzc0Ljk5JztcbiAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQyc7XG4gICAgfSxcblxuICAgIHdhbGxoaXRzdGFydDogZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICB0YWtlRGFtYWdlKHN0YXRlKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFBvc3QtcHJvY2VzcyB0aGUgc3RhdGUgYWZ0ZXIgZWFjaCBhY3Rpb24uXG4gICAqL1xuICBjb21wdXRlU3RhdGU6IChzdGF0ZSkgPT4ge1xuICAgIHN0YXRlLmlzUGxheWluZyA9XG4gICAgICAhc3RhdGUubWVudUFjdGl2ZSAmJiAhc3RhdGUuaXNQYXVzZWQgJiYgIXN0YXRlLmlzVmljdG9yeSAmJiAhc3RhdGUuaXNHYW1lT3ZlciAmJlxuICAgICAgIXN0YXRlLmNoYWxsZW5nZS5pc0xvYWRpbmcgJiYgIXN0YXRlLmlzU29uZ0xvYWRpbmcgJiYgISFzdGF0ZS5jaGFsbGVuZ2UuaWQ7XG5cbiAgICBjb25zdCBhbnlNZW51T3BlbiA9IHN0YXRlLm1lbnVBY3RpdmUgfHwgc3RhdGUuaXNQYXVzZWQgfHwgc3RhdGUuaXNWaWN0b3J5IHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5pc0dhbWVPdmVyIHx8IHN0YXRlLmlzU29uZ0xvYWRpbmcgfHwgc3RhdGUuaXNTb25nRmV0Y2hpbmc7XG4gICAgc3RhdGUubGVmdFJheWNhc3RlckFjdGl2ZSA9IGFueU1lbnVPcGVuICYmIHN0YXRlLmFjdGl2ZUhhbmQgPT09ICdsZWZ0JyAmJiBzdGF0ZS5pblZSO1xuICAgIHN0YXRlLnJpZ2h0UmF5Y2FzdGVyQWN0aXZlID0gYW55TWVudU9wZW4gJiYgc3RhdGUuYWN0aXZlSGFuZCA9PT0gJ3JpZ2h0JyAmJiBzdGF0ZS5pblZSO1xuXG4gICAgLy8gU29uZyBpcyBkZWNvZGluZyBpZiBpdCBpcyBsb2FkaW5nLCBidXQgbm90IGZldGNoaW5nLlxuICAgIGlmIChzdGF0ZS5pc1NvbmdMb2FkaW5nKSB7XG4gICAgICBzdGF0ZS5sb2FkaW5nVGV4dCA9IHN0YXRlLmlzU29uZ0ZldGNoaW5nID8gJ0Rvd25sb2FkaW5nIHNvbmcuLi4nIDogJ1Byb2Nlc3Npbmcgc29uZy4uLic7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXRlLmxvYWRpbmdUZXh0ID0gJyc7XG4gICAgfVxuICB9XG59KTtcblxuZnVuY3Rpb24gY29tcHV0ZVNlYXJjaFBhZ2luYXRpb24gKHN0YXRlKSB7XG4gIGxldCBudW1QYWdlcyA9IE1hdGguY2VpbChzdGF0ZS5zZWFyY2gucmVzdWx0cy5sZW5ndGggLyBTRUFSQ0hfUEVSX1BBR0UpO1xuICBzdGF0ZS5zZWFyY2guaGFzUHJldiA9IHN0YXRlLnNlYXJjaC5wYWdlID4gMDtcbiAgc3RhdGUuc2VhcmNoLmhhc05leHQgPSBzdGF0ZS5zZWFyY2gucGFnZSA8IG51bVBhZ2VzIC0gMTtcblxuICBzdGF0ZS5zZWFyY2guc29uZ05hbWVUZXh0cyA9ICcnO1xuICBzdGF0ZS5zZWFyY2guc29uZ1N1Yk5hbWVUZXh0cyA9ICcnO1xuXG4gIHN0YXRlLnNlYXJjaFJlc3VsdHNQYWdlLmxlbmd0aCA9IDA7XG4gIHN0YXRlLnNlYXJjaFJlc3VsdHNQYWdlLl9fZGlydHkgPSB0cnVlO1xuICBmb3IgKGxldCBpID0gc3RhdGUuc2VhcmNoLnBhZ2UgKiBTRUFSQ0hfUEVSX1BBR0U7XG4gICAgICAgaSA8IHN0YXRlLnNlYXJjaC5wYWdlICogU0VBUkNIX1BFUl9QQUdFICsgU0VBUkNIX1BFUl9QQUdFOyBpKyspIHtcbiAgICBpZiAoIXN0YXRlLnNlYXJjaC5yZXN1bHRzW2ldKSB7IGJyZWFrOyB9XG4gICAgc3RhdGUuc2VhcmNoUmVzdWx0c1BhZ2UucHVzaChzdGF0ZS5zZWFyY2gucmVzdWx0c1tpXSk7XG5cbiAgICBzdGF0ZS5zZWFyY2guc29uZ05hbWVUZXh0cyArPVxuICAgICAgdHJ1bmNhdGUoc3RhdGUuc2VhcmNoLnJlc3VsdHNbaV0uc29uZ05hbWUsIFNPTkdfTkFNRV9UUlVOQ0FURSkudG9VcHBlckNhc2UoKSArICdcXG4nO1xuICAgIHN0YXRlLnNlYXJjaC5zb25nU3ViTmFtZVRleHRzICs9XG4gICAgICB0cnVuY2F0ZShzdGF0ZS5zZWFyY2gucmVzdWx0c1tpXS5zb25nU3ViTmFtZSwgU09OR19TVUJfTkFNRV9UUlVOQ0FURSkgKyAnXFxuJztcbiAgfVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RhdGUuc2VhcmNoUmVzdWx0c1BhZ2UubGVuZ3RoOyBpKyspIHtcbiAgICBzdGF0ZS5zZWFyY2hSZXN1bHRzUGFnZVtpXS5pbmRleCA9IGk7XG4gIH1cblxuICBjb21wdXRlTWVudVNlbGVjdGVkQ2hhbGxlbmdlSW5kZXgoc3RhdGUpO1xufVxuXG5mdW5jdGlvbiB0cnVuY2F0ZSAoc3RyLCBsZW5ndGgpIHtcbiAgaWYgKCFzdHIpIHsgcmV0dXJuICcnOyB9XG4gIGlmIChzdHIubGVuZ3RoID49IGxlbmd0aCkge1xuICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIGxlbmd0aCAtIDMpICsgJy4uLic7XG4gIH1cbiAgcmV0dXJuIHN0cjtcbn1cblxuY29uc3QgRElGRklDVUxUSUVTID0gWydFYXN5JywgJ05vcm1hbCcsICdIYXJkJywgJ0V4cGVydCcsICdFeHBlcnRQbHVzJ107XG5mdW5jdGlvbiBkaWZmaWN1bHR5Q29tcGFyYXRvciAoYSwgYikge1xuICBjb25zdCBhSW5kZXggPSBESUZGSUNVTFRJRVMuaW5kZXhPZihhKTtcbiAgY29uc3QgYkluZGV4ID0gRElGRklDVUxUSUVTLmluZGV4T2YoYik7XG4gIGlmIChhSW5kZXggPCBiSW5kZXgpIHsgcmV0dXJuIC0xOyB9XG4gIGlmIChhSW5kZXggPiBiSW5kZXgpIHsgcmV0dXJuIDE7IH1cbiAgcmV0dXJuIDA7XG59XG5cbmZ1bmN0aW9uIHRha2VEYW1hZ2UgKHN0YXRlKSB7XG4gIGlmICghc3RhdGUuaXNQbGF5aW5nKSB7IHJldHVybjsgfVxuICBzdGF0ZS5zY29yZS5jb21ibyA9IDA7XG4gIHN0YXRlLnNjb3JlLm11bHRpcGxpZXIgPSBzdGF0ZS5zY29yZS5tdWx0aXBsaWVyID4gMVxuICAgID8gTWF0aC5jZWlsKHN0YXRlLnNjb3JlLm11bHRpcGxpZXIgLyAyKVxuICAgIDogMTtcbiAgaWYgKEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2dvZG1vZGUnKSkgeyByZXR1cm47IH1cbiAgc3RhdGUuZGFtYWdlKys7XG4gIGNoZWNrR2FtZU92ZXIoc3RhdGUpO1xufVxuXG5mdW5jdGlvbiBjaGVja0dhbWVPdmVyIChzdGF0ZSkge1xuICBpZiAoc3RhdGUuZGFtYWdlID49IERBTUFHRV9NQVgpIHtcbiAgICBzdGF0ZS5kYW1hZ2UgPSAwO1xuICAgIHN0YXRlLmlzR2FtZU92ZXIgPSB0cnVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlc2V0U2NvcmUgKHN0YXRlKSB7XG4gIHN0YXRlLmRhbWFnZSA9IDA7XG4gIHN0YXRlLnNjb3JlLmJlYXRzSGl0ID0gMDtcbiAgc3RhdGUuc2NvcmUuYmVhdHNNaXNzZWQgPSAwO1xuICBzdGF0ZS5zY29yZS5jb21ibyA9IDA7XG4gIHN0YXRlLnNjb3JlLm1heENvbWJvID0gMDtcbiAgc3RhdGUuc2NvcmUuc2NvcmUgPSAwO1xuICBzdGF0ZS5zY29yZS5tdWx0aXBsaWVyID0gMTtcbn1cblxuZnVuY3Rpb24gY29tcHV0ZU1lbnVTZWxlY3RlZENoYWxsZW5nZUluZGV4IChzdGF0ZSkge1xuICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaW5kZXggPSAtMTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZS5zZWFyY2hSZXN1bHRzUGFnZS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChzdGF0ZS5zZWFyY2hSZXN1bHRzUGFnZVtpXS5pZCA9PT0gc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmlkKSB7XG4gICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaW5kZXggPSBpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGZvcm1hdFNvbmdMZW5ndGggKHNvbmdMZW5ndGgpIHtcbiAgc29uZ0xlbmd0aCAvPSA2MDtcbiAgY29uc3QgbWludXRlcyA9IGAke01hdGguZmxvb3Ioc29uZ0xlbmd0aCl9YDtcbiAgcmV0dXJuIGAke21pbnV0ZXN9OiR7TWF0aC5yb3VuZCgoc29uZ0xlbmd0aCAtIG1pbnV0ZXMpICogNjApfWA7XG59XG5cbmZ1bmN0aW9uIGNvbXB1dGVCZWF0c1RleHQgKHN0YXRlKSB7XG4gIHN0YXRlLnNjb3JlLmJlYXRzVGV4dCA9XG4gICAgYCR7c3RhdGUuc2NvcmUuYmVhdHNIaXR9IC8gJHtzdGF0ZS5zY29yZS5iZWF0c01pc3NlZCArIHN0YXRlLnNjb3JlLmJlYXRzSGl0fSBCRUFUU2A7XG59XG5cbmZ1bmN0aW9uIGNsZWFyTGVhZGVyYm9hcmQgKHN0YXRlKSB7XG4gIHN0YXRlLmxlYWRlcmJvYXJkLmxlbmd0aCA9IDA7XG4gIHN0YXRlLmxlYWRlcmJvYXJkLl9fZGlydHkgPSB0cnVlO1xuICBzdGF0ZS5sZWFkZXJib2FyZE5hbWVzID0gJyc7XG4gIHN0YXRlLmxlYWRlcmJvYXJkU2NvcmVzID0gJyc7XG4gIHN0YXRlLmxlYWRlcmJvYXJkRmV0Y2hlZCA9IGZhbHNlO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVNZW51U29uZ0luZm8gKHN0YXRlLCBjaGFsbGVuZ2UpIHtcbiAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLnNvbmdJbmZvVGV4dCA9IGBCeSAke3RydW5jYXRlKGNoYWxsZW5nZS5hdXRob3IsIDEyKX0gJHtjaGFsbGVuZ2UuZ2VucmUgJiYgY2hhbGxlbmdlLmdlbnJlICE9PSAnVW5jYXRlZ29yaXplZCcgPyAnLyAnICsgY2hhbGxlbmdlLmdlbnJlIDogJyd9XFxuJHtjaGFsbGVuZ2UuZG93bmxvYWRzfSBEb3dubG9hZHNcXG5VcHZvdGVzOiAke2NoYWxsZW5nZS51cHZvdGVzfSAvIERvd252b3RlczogJHtjaGFsbGVuZ2UuZG93bnZvdGVzfVxcbiR7Zm9ybWF0U29uZ0xlbmd0aChjaGFsbGVuZ2Uuc29uZ0R1cmF0aW9uKX0gLyAke2NoYWxsZW5nZS5udW1CZWF0c1tzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuZGlmZmljdWx0eV19IGJlYXRzYDtcbn1cblxuZnVuY3Rpb24gdXBkYXRlU2NvcmVBY2N1cmFjeSAoc3RhdGUpIHtcbiAgLy8gVXBkYXRlIGxpdmUgYWNjdXJhY3kuXG4gIGNvbnN0IGN1cnJlbnROdW1CZWF0cyA9IHN0YXRlLnNjb3JlLmJlYXRzSGl0ICsgc3RhdGUuc2NvcmUuYmVhdHNNaXNzZWQ7XG4gIHN0YXRlLnNjb3JlLmFjY3VyYWN5ID0gKHN0YXRlLnNjb3JlLnNjb3JlIC8gKGN1cnJlbnROdW1CZWF0cyAqIDExMCkpICogMTAwO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3N0YXRlL2luZGV4LmpzIiwidmFyIGVzY2FwZSA9IHJlcXVpcmUoXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9saWIvdXJsL2VzY2FwZS5qc1wiKTtcbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcIikoZmFsc2UpO1xuLy8gaW1wb3J0c1xuXG5cbi8vIG1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiaHRtbCB7XFxuICBiYWNrZ3JvdW5kOiAjMDAwO1xcbn1cXG5cXG4jdnJCdXR0b24ge1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgYmFja2dyb3VuZDogdXJsKFwiICsgZXNjYXBlKHJlcXVpcmUoXCIuLi9hc3NldHMvaW1nL2VudGVyLXZyLWJ1dHRvbi1iYWNrZ3JvdW5kLnBuZ1wiKSkgKyBcIikgbm8tcmVwZWF0O1xcbiAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjtcXG4gIGJvcmRlcjogMDtcXG4gIGN1cnNvcjogcG9pbnRlcjtcXG4gIHJpZ2h0OiAyMHB4O1xcbiAgYm90dG9tOiAyMHB4O1xcbiAgei1pbmRleDogOTk5OTk5OTtcXG4gIHdpZHRoOiA4NHB4O1xcbiAgaGVpZ2h0OiA0N3B4O1xcbn1cXG5cXG4jdnJCdXR0b24uYS1oaWRkZW4ge1xcbiAgdmlzaWJpbGl0eTogaGlkZGVuO1xcbn1cXG5cXG4jdnJCdXR0b246YWN0aXZlIHtcXG4gIGJvcmRlcjogMDtcXG59XFxuXFxuI3ZyQnV0dG9uOmhvdmVyIHtcXG4gIGJhY2tncm91bmQtcG9zaXRpb246IDAgLTUwLjVweDtcXG59XFxuXFxuLmEtbG9hZGVyLXRpdGxlIHtcXG4gIGFuaW1hdGlvbjogbG9hZGVyVGl0bGUgMXMgaW5maW5pdGUgYWx0ZXJuYXRlO1xcbiAgY29sb3I6IHJnYmEoMCwwLDAsMCk7XFxuICBiYWNrZ3JvdW5kOiBub25lO1xcbiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiICsgZXNjYXBlKHJlcXVpcmUoXCIuLi9hc3NldHMvaW1nL2xvYWRpbmdMb2dvLmpwZ1wiKSkgKyBcIik7XFxuICBoZWlnaHQ6IDM2LjJ2aDtcXG4gIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XFxuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7XFxuICBtYXJnaW4tdG9wOiAwO1xcbiAgYmFja2dyb3VuZC1zaXplOiBjb250YWluO1xcbiAgbWFyZ2luLWxlZnQ6IC0xdmg7XFxufVxcblxcbkBrZXlmcmFtZXMgbG9hZGVyVGl0bGUge1xcbiAgMCUgeyBvcGFjaXR5OiAxOyB9XFxuICA1MCUgeyBvcGFjaXR5OiAwLjg7IH1cXG4gIDEwMCUgeyBvcGFjaXR5OiAxOyB9XFxufVxcblxcbiN0dXRvcmlhbDJkIHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHdpZHRoOiA2MCU7XFxuICBsZWZ0OiAyMCU7XFxuICB0b3A6IDM1JTtcXG59XFxuXFxuQG1lZGlhIChtYXgtd2lkdGg6IDEyODBweCkge1xcbiAgI3R1dG9yaWFsMmQge1xcbiAgICB3aWR0aDogODAlO1xcbiAgICBsZWZ0OiAxMCU7XFxuICB9XFxufVxcblwiLCBcIlwiXSk7XG5cbi8vIGV4cG9ydHNcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9jc3MtbG9hZGVyIS4vc3JjL2luZGV4LmNzc1xuLy8gbW9kdWxlIGlkID0gMTM1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG4vLyBjc3MgYmFzZSBjb2RlLCBpbmplY3RlZCBieSB0aGUgY3NzLWxvYWRlclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih1c2VTb3VyY2VNYXApIHtcblx0dmFyIGxpc3QgPSBbXTtcblxuXHQvLyByZXR1cm4gdGhlIGxpc3Qgb2YgbW9kdWxlcyBhcyBjc3Mgc3RyaW5nXG5cdGxpc3QudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcblx0XHRyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdHZhciBjb250ZW50ID0gY3NzV2l0aE1hcHBpbmdUb1N0cmluZyhpdGVtLCB1c2VTb3VyY2VNYXApO1xuXHRcdFx0aWYoaXRlbVsyXSkge1xuXHRcdFx0XHRyZXR1cm4gXCJAbWVkaWEgXCIgKyBpdGVtWzJdICsgXCJ7XCIgKyBjb250ZW50ICsgXCJ9XCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gY29udGVudDtcblx0XHRcdH1cblx0XHR9KS5qb2luKFwiXCIpO1xuXHR9O1xuXG5cdC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XG5cdGxpc3QuaSA9IGZ1bmN0aW9uKG1vZHVsZXMsIG1lZGlhUXVlcnkpIHtcblx0XHRpZih0eXBlb2YgbW9kdWxlcyA9PT0gXCJzdHJpbmdcIilcblx0XHRcdG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsIFwiXCJdXTtcblx0XHR2YXIgYWxyZWFkeUltcG9ydGVkTW9kdWxlcyA9IHt9O1xuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgaWQgPSB0aGlzW2ldWzBdO1xuXHRcdFx0aWYodHlwZW9mIGlkID09PSBcIm51bWJlclwiKVxuXHRcdFx0XHRhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2lkXSA9IHRydWU7XG5cdFx0fVxuXHRcdGZvcihpID0gMDsgaSA8IG1vZHVsZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBpdGVtID0gbW9kdWxlc1tpXTtcblx0XHRcdC8vIHNraXAgYWxyZWFkeSBpbXBvcnRlZCBtb2R1bGVcblx0XHRcdC8vIHRoaXMgaW1wbGVtZW50YXRpb24gaXMgbm90IDEwMCUgcGVyZmVjdCBmb3Igd2VpcmQgbWVkaWEgcXVlcnkgY29tYmluYXRpb25zXG5cdFx0XHQvLyAgd2hlbiBhIG1vZHVsZSBpcyBpbXBvcnRlZCBtdWx0aXBsZSB0aW1lcyB3aXRoIGRpZmZlcmVudCBtZWRpYSBxdWVyaWVzLlxuXHRcdFx0Ly8gIEkgaG9wZSB0aGlzIHdpbGwgbmV2ZXIgb2NjdXIgKEhleSB0aGlzIHdheSB3ZSBoYXZlIHNtYWxsZXIgYnVuZGxlcylcblx0XHRcdGlmKHR5cGVvZiBpdGVtWzBdICE9PSBcIm51bWJlclwiIHx8ICFhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2l0ZW1bMF1dKSB7XG5cdFx0XHRcdGlmKG1lZGlhUXVlcnkgJiYgIWl0ZW1bMl0pIHtcblx0XHRcdFx0XHRpdGVtWzJdID0gbWVkaWFRdWVyeTtcblx0XHRcdFx0fSBlbHNlIGlmKG1lZGlhUXVlcnkpIHtcblx0XHRcdFx0XHRpdGVtWzJdID0gXCIoXCIgKyBpdGVtWzJdICsgXCIpIGFuZCAoXCIgKyBtZWRpYVF1ZXJ5ICsgXCIpXCI7XG5cdFx0XHRcdH1cblx0XHRcdFx0bGlzdC5wdXNoKGl0ZW0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fTtcblx0cmV0dXJuIGxpc3Q7XG59O1xuXG5mdW5jdGlvbiBjc3NXaXRoTWFwcGluZ1RvU3RyaW5nKGl0ZW0sIHVzZVNvdXJjZU1hcCkge1xuXHR2YXIgY29udGVudCA9IGl0ZW1bMV0gfHwgJyc7XG5cdHZhciBjc3NNYXBwaW5nID0gaXRlbVszXTtcblx0aWYgKCFjc3NNYXBwaW5nKSB7XG5cdFx0cmV0dXJuIGNvbnRlbnQ7XG5cdH1cblxuXHRpZiAodXNlU291cmNlTWFwICYmIHR5cGVvZiBidG9hID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0dmFyIHNvdXJjZU1hcHBpbmcgPSB0b0NvbW1lbnQoY3NzTWFwcGluZyk7XG5cdFx0dmFyIHNvdXJjZVVSTHMgPSBjc3NNYXBwaW5nLnNvdXJjZXMubWFwKGZ1bmN0aW9uIChzb3VyY2UpIHtcblx0XHRcdHJldHVybiAnLyojIHNvdXJjZVVSTD0nICsgY3NzTWFwcGluZy5zb3VyY2VSb290ICsgc291cmNlICsgJyAqLydcblx0XHR9KTtcblxuXHRcdHJldHVybiBbY29udGVudF0uY29uY2F0KHNvdXJjZVVSTHMpLmNvbmNhdChbc291cmNlTWFwcGluZ10pLmpvaW4oJ1xcbicpO1xuXHR9XG5cblx0cmV0dXJuIFtjb250ZW50XS5qb2luKCdcXG4nKTtcbn1cblxuLy8gQWRhcHRlZCBmcm9tIGNvbnZlcnQtc291cmNlLW1hcCAoTUlUKVxuZnVuY3Rpb24gdG9Db21tZW50KHNvdXJjZU1hcCkge1xuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcblx0dmFyIGJhc2U2NCA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpKSk7XG5cdHZhciBkYXRhID0gJ3NvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTg7YmFzZTY0LCcgKyBiYXNlNjQ7XG5cblx0cmV0dXJuICcvKiMgJyArIGRhdGEgKyAnICovJztcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1xuLy8gbW9kdWxlIGlkID0gMTM2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZXNjYXBlKHVybCkge1xuICAgIGlmICh0eXBlb2YgdXJsICE9PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gdXJsXG4gICAgfVxuICAgIC8vIElmIHVybCBpcyBhbHJlYWR5IHdyYXBwZWQgaW4gcXVvdGVzLCByZW1vdmUgdGhlbVxuICAgIGlmICgvXlsnXCJdLipbJ1wiXSQvLnRlc3QodXJsKSkge1xuICAgICAgICB1cmwgPSB1cmwuc2xpY2UoMSwgLTEpO1xuICAgIH1cbiAgICAvLyBTaG91bGQgdXJsIGJlIHdyYXBwZWQ/XG4gICAgLy8gU2VlIGh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3MtdmFsdWVzLTMvI3VybHNcbiAgICBpZiAoL1tcIicoKSBcXHRcXG5dLy50ZXN0KHVybCkpIHtcbiAgICAgICAgcmV0dXJuICdcIicgKyB1cmwucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpLnJlcGxhY2UoL1xcbi9nLCAnXFxcXG4nKSArICdcIidcbiAgICB9XG5cbiAgICByZXR1cm4gdXJsXG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vY3NzLWxvYWRlci9saWIvdXJsL2VzY2FwZS5qc1xuLy8gbW9kdWxlIGlkID0gMTM3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIlxuLyoqXG4gKiBUaGlzIGlzIHRoZSBjb21tb24gbG9naWMgZm9yIGJvdGggdGhlIE5vZGUuanMgYW5kIHdlYiBicm93c2VyXG4gKiBpbXBsZW1lbnRhdGlvbnMgb2YgYGRlYnVnKClgLlxuICovXG5cbmZ1bmN0aW9uIHNldHVwKGVudikge1xuXHRjcmVhdGVEZWJ1Zy5kZWJ1ZyA9IGNyZWF0ZURlYnVnO1xuXHRjcmVhdGVEZWJ1Zy5kZWZhdWx0ID0gY3JlYXRlRGVidWc7XG5cdGNyZWF0ZURlYnVnLmNvZXJjZSA9IGNvZXJjZTtcblx0Y3JlYXRlRGVidWcuZGlzYWJsZSA9IGRpc2FibGU7XG5cdGNyZWF0ZURlYnVnLmVuYWJsZSA9IGVuYWJsZTtcblx0Y3JlYXRlRGVidWcuZW5hYmxlZCA9IGVuYWJsZWQ7XG5cdGNyZWF0ZURlYnVnLmh1bWFuaXplID0gcmVxdWlyZSgnbXMnKTtcblxuXHRPYmplY3Qua2V5cyhlbnYpLmZvckVhY2goa2V5ID0+IHtcblx0XHRjcmVhdGVEZWJ1Z1trZXldID0gZW52W2tleV07XG5cdH0pO1xuXG5cdC8qKlxuXHQqIEFjdGl2ZSBgZGVidWdgIGluc3RhbmNlcy5cblx0Ki9cblx0Y3JlYXRlRGVidWcuaW5zdGFuY2VzID0gW107XG5cblx0LyoqXG5cdCogVGhlIGN1cnJlbnRseSBhY3RpdmUgZGVidWcgbW9kZSBuYW1lcywgYW5kIG5hbWVzIHRvIHNraXAuXG5cdCovXG5cblx0Y3JlYXRlRGVidWcubmFtZXMgPSBbXTtcblx0Y3JlYXRlRGVidWcuc2tpcHMgPSBbXTtcblxuXHQvKipcblx0KiBNYXAgb2Ygc3BlY2lhbCBcIiVuXCIgaGFuZGxpbmcgZnVuY3Rpb25zLCBmb3IgdGhlIGRlYnVnIFwiZm9ybWF0XCIgYXJndW1lbnQuXG5cdCpcblx0KiBWYWxpZCBrZXkgbmFtZXMgYXJlIGEgc2luZ2xlLCBsb3dlciBvciB1cHBlci1jYXNlIGxldHRlciwgaS5lLiBcIm5cIiBhbmQgXCJOXCIuXG5cdCovXG5cdGNyZWF0ZURlYnVnLmZvcm1hdHRlcnMgPSB7fTtcblxuXHQvKipcblx0KiBTZWxlY3RzIGEgY29sb3IgZm9yIGEgZGVidWcgbmFtZXNwYWNlXG5cdCogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIHN0cmluZyBmb3IgdGhlIGZvciB0aGUgZGVidWcgaW5zdGFuY2UgdG8gYmUgY29sb3JlZFxuXHQqIEByZXR1cm4ge051bWJlcnxTdHJpbmd9IEFuIEFOU0kgY29sb3IgY29kZSBmb3IgdGhlIGdpdmVuIG5hbWVzcGFjZVxuXHQqIEBhcGkgcHJpdmF0ZVxuXHQqL1xuXHRmdW5jdGlvbiBzZWxlY3RDb2xvcihuYW1lc3BhY2UpIHtcblx0XHRsZXQgaGFzaCA9IDA7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVzcGFjZS5sZW5ndGg7IGkrKykge1xuXHRcdFx0aGFzaCA9ICgoaGFzaCA8PCA1KSAtIGhhc2gpICsgbmFtZXNwYWNlLmNoYXJDb2RlQXQoaSk7XG5cdFx0XHRoYXNoIHw9IDA7IC8vIENvbnZlcnQgdG8gMzJiaXQgaW50ZWdlclxuXHRcdH1cblxuXHRcdHJldHVybiBjcmVhdGVEZWJ1Zy5jb2xvcnNbTWF0aC5hYnMoaGFzaCkgJSBjcmVhdGVEZWJ1Zy5jb2xvcnMubGVuZ3RoXTtcblx0fVxuXHRjcmVhdGVEZWJ1Zy5zZWxlY3RDb2xvciA9IHNlbGVjdENvbG9yO1xuXG5cdC8qKlxuXHQqIENyZWF0ZSBhIGRlYnVnZ2VyIHdpdGggdGhlIGdpdmVuIGBuYW1lc3BhY2VgLlxuXHQqXG5cdCogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZVxuXHQqIEByZXR1cm4ge0Z1bmN0aW9ufVxuXHQqIEBhcGkgcHVibGljXG5cdCovXG5cdGZ1bmN0aW9uIGNyZWF0ZURlYnVnKG5hbWVzcGFjZSkge1xuXHRcdGxldCBwcmV2VGltZTtcblxuXHRcdGZ1bmN0aW9uIGRlYnVnKC4uLmFyZ3MpIHtcblx0XHRcdC8vIERpc2FibGVkP1xuXHRcdFx0aWYgKCFkZWJ1Zy5lbmFibGVkKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3Qgc2VsZiA9IGRlYnVnO1xuXG5cdFx0XHQvLyBTZXQgYGRpZmZgIHRpbWVzdGFtcFxuXHRcdFx0Y29uc3QgY3VyciA9IE51bWJlcihuZXcgRGF0ZSgpKTtcblx0XHRcdGNvbnN0IG1zID0gY3VyciAtIChwcmV2VGltZSB8fCBjdXJyKTtcblx0XHRcdHNlbGYuZGlmZiA9IG1zO1xuXHRcdFx0c2VsZi5wcmV2ID0gcHJldlRpbWU7XG5cdFx0XHRzZWxmLmN1cnIgPSBjdXJyO1xuXHRcdFx0cHJldlRpbWUgPSBjdXJyO1xuXG5cdFx0XHRhcmdzWzBdID0gY3JlYXRlRGVidWcuY29lcmNlKGFyZ3NbMF0pO1xuXG5cdFx0XHRpZiAodHlwZW9mIGFyZ3NbMF0gIT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdC8vIEFueXRoaW5nIGVsc2UgbGV0J3MgaW5zcGVjdCB3aXRoICVPXG5cdFx0XHRcdGFyZ3MudW5zaGlmdCgnJU8nKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQXBwbHkgYW55IGBmb3JtYXR0ZXJzYCB0cmFuc2Zvcm1hdGlvbnNcblx0XHRcdGxldCBpbmRleCA9IDA7XG5cdFx0XHRhcmdzWzBdID0gYXJnc1swXS5yZXBsYWNlKC8lKFthLXpBLVolXSkvZywgKG1hdGNoLCBmb3JtYXQpID0+IHtcblx0XHRcdFx0Ly8gSWYgd2UgZW5jb3VudGVyIGFuIGVzY2FwZWQgJSB0aGVuIGRvbid0IGluY3JlYXNlIHRoZSBhcnJheSBpbmRleFxuXHRcdFx0XHRpZiAobWF0Y2ggPT09ICclJScpIHtcblx0XHRcdFx0XHRyZXR1cm4gbWF0Y2g7XG5cdFx0XHRcdH1cblx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0Y29uc3QgZm9ybWF0dGVyID0gY3JlYXRlRGVidWcuZm9ybWF0dGVyc1tmb3JtYXRdO1xuXHRcdFx0XHRpZiAodHlwZW9mIGZvcm1hdHRlciA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdGNvbnN0IHZhbCA9IGFyZ3NbaW5kZXhdO1xuXHRcdFx0XHRcdG1hdGNoID0gZm9ybWF0dGVyLmNhbGwoc2VsZiwgdmFsKTtcblxuXHRcdFx0XHRcdC8vIE5vdyB3ZSBuZWVkIHRvIHJlbW92ZSBgYXJnc1tpbmRleF1gIHNpbmNlIGl0J3MgaW5saW5lZCBpbiB0aGUgYGZvcm1hdGBcblx0XHRcdFx0XHRhcmdzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0aW5kZXgtLTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gQXBwbHkgZW52LXNwZWNpZmljIGZvcm1hdHRpbmcgKGNvbG9ycywgZXRjLilcblx0XHRcdGNyZWF0ZURlYnVnLmZvcm1hdEFyZ3MuY2FsbChzZWxmLCBhcmdzKTtcblxuXHRcdFx0Y29uc3QgbG9nRm4gPSBzZWxmLmxvZyB8fCBjcmVhdGVEZWJ1Zy5sb2c7XG5cdFx0XHRsb2dGbi5hcHBseShzZWxmLCBhcmdzKTtcblx0XHR9XG5cblx0XHRkZWJ1Zy5uYW1lc3BhY2UgPSBuYW1lc3BhY2U7XG5cdFx0ZGVidWcuZW5hYmxlZCA9IGNyZWF0ZURlYnVnLmVuYWJsZWQobmFtZXNwYWNlKTtcblx0XHRkZWJ1Zy51c2VDb2xvcnMgPSBjcmVhdGVEZWJ1Zy51c2VDb2xvcnMoKTtcblx0XHRkZWJ1Zy5jb2xvciA9IHNlbGVjdENvbG9yKG5hbWVzcGFjZSk7XG5cdFx0ZGVidWcuZGVzdHJveSA9IGRlc3Ryb3k7XG5cdFx0ZGVidWcuZXh0ZW5kID0gZXh0ZW5kO1xuXHRcdC8vIERlYnVnLmZvcm1hdEFyZ3MgPSBmb3JtYXRBcmdzO1xuXHRcdC8vIGRlYnVnLnJhd0xvZyA9IHJhd0xvZztcblxuXHRcdC8vIGVudi1zcGVjaWZpYyBpbml0aWFsaXphdGlvbiBsb2dpYyBmb3IgZGVidWcgaW5zdGFuY2VzXG5cdFx0aWYgKHR5cGVvZiBjcmVhdGVEZWJ1Zy5pbml0ID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRjcmVhdGVEZWJ1Zy5pbml0KGRlYnVnKTtcblx0XHR9XG5cblx0XHRjcmVhdGVEZWJ1Zy5pbnN0YW5jZXMucHVzaChkZWJ1Zyk7XG5cblx0XHRyZXR1cm4gZGVidWc7XG5cdH1cblxuXHRmdW5jdGlvbiBkZXN0cm95KCkge1xuXHRcdGNvbnN0IGluZGV4ID0gY3JlYXRlRGVidWcuaW5zdGFuY2VzLmluZGV4T2YodGhpcyk7XG5cdFx0aWYgKGluZGV4ICE9PSAtMSkge1xuXHRcdFx0Y3JlYXRlRGVidWcuaW5zdGFuY2VzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0ZnVuY3Rpb24gZXh0ZW5kKG5hbWVzcGFjZSwgZGVsaW1pdGVyKSB7XG5cdFx0cmV0dXJuIGNyZWF0ZURlYnVnKHRoaXMubmFtZXNwYWNlICsgKHR5cGVvZiBkZWxpbWl0ZXIgPT09ICd1bmRlZmluZWQnID8gJzonIDogZGVsaW1pdGVyKSArIG5hbWVzcGFjZSk7XG5cdH1cblxuXHQvKipcblx0KiBFbmFibGVzIGEgZGVidWcgbW9kZSBieSBuYW1lc3BhY2VzLiBUaGlzIGNhbiBpbmNsdWRlIG1vZGVzXG5cdCogc2VwYXJhdGVkIGJ5IGEgY29sb24gYW5kIHdpbGRjYXJkcy5cblx0KlxuXHQqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2VzXG5cdCogQGFwaSBwdWJsaWNcblx0Ki9cblx0ZnVuY3Rpb24gZW5hYmxlKG5hbWVzcGFjZXMpIHtcblx0XHRjcmVhdGVEZWJ1Zy5zYXZlKG5hbWVzcGFjZXMpO1xuXG5cdFx0Y3JlYXRlRGVidWcubmFtZXMgPSBbXTtcblx0XHRjcmVhdGVEZWJ1Zy5za2lwcyA9IFtdO1xuXG5cdFx0bGV0IGk7XG5cdFx0Y29uc3Qgc3BsaXQgPSAodHlwZW9mIG5hbWVzcGFjZXMgPT09ICdzdHJpbmcnID8gbmFtZXNwYWNlcyA6ICcnKS5zcGxpdCgvW1xccyxdKy8pO1xuXHRcdGNvbnN0IGxlbiA9IHNwbGl0Lmxlbmd0aDtcblxuXHRcdGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0aWYgKCFzcGxpdFtpXSkge1xuXHRcdFx0XHQvLyBpZ25vcmUgZW1wdHkgc3RyaW5nc1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0bmFtZXNwYWNlcyA9IHNwbGl0W2ldLnJlcGxhY2UoL1xcKi9nLCAnLio/Jyk7XG5cblx0XHRcdGlmIChuYW1lc3BhY2VzWzBdID09PSAnLScpIHtcblx0XHRcdFx0Y3JlYXRlRGVidWcuc2tpcHMucHVzaChuZXcgUmVnRXhwKCdeJyArIG5hbWVzcGFjZXMuc3Vic3RyKDEpICsgJyQnKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjcmVhdGVEZWJ1Zy5uYW1lcy5wdXNoKG5ldyBSZWdFeHAoJ14nICsgbmFtZXNwYWNlcyArICckJykpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZvciAoaSA9IDA7IGkgPCBjcmVhdGVEZWJ1Zy5pbnN0YW5jZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGNvbnN0IGluc3RhbmNlID0gY3JlYXRlRGVidWcuaW5zdGFuY2VzW2ldO1xuXHRcdFx0aW5zdGFuY2UuZW5hYmxlZCA9IGNyZWF0ZURlYnVnLmVuYWJsZWQoaW5zdGFuY2UubmFtZXNwYWNlKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0KiBEaXNhYmxlIGRlYnVnIG91dHB1dC5cblx0KlxuXHQqIEByZXR1cm4ge1N0cmluZ30gbmFtZXNwYWNlc1xuXHQqIEBhcGkgcHVibGljXG5cdCovXG5cdGZ1bmN0aW9uIGRpc2FibGUoKSB7XG5cdFx0Y29uc3QgbmFtZXNwYWNlcyA9IFtcblx0XHRcdC4uLmNyZWF0ZURlYnVnLm5hbWVzLm1hcCh0b05hbWVzcGFjZSksXG5cdFx0XHQuLi5jcmVhdGVEZWJ1Zy5za2lwcy5tYXAodG9OYW1lc3BhY2UpLm1hcChuYW1lc3BhY2UgPT4gJy0nICsgbmFtZXNwYWNlKVxuXHRcdF0uam9pbignLCcpO1xuXHRcdGNyZWF0ZURlYnVnLmVuYWJsZSgnJyk7XG5cdFx0cmV0dXJuIG5hbWVzcGFjZXM7XG5cdH1cblxuXHQvKipcblx0KiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIG1vZGUgbmFtZSBpcyBlbmFibGVkLCBmYWxzZSBvdGhlcndpc2UuXG5cdCpcblx0KiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuXHQqIEByZXR1cm4ge0Jvb2xlYW59XG5cdCogQGFwaSBwdWJsaWNcblx0Ki9cblx0ZnVuY3Rpb24gZW5hYmxlZChuYW1lKSB7XG5cdFx0aWYgKG5hbWVbbmFtZS5sZW5ndGggLSAxXSA9PT0gJyonKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRsZXQgaTtcblx0XHRsZXQgbGVuO1xuXG5cdFx0Zm9yIChpID0gMCwgbGVuID0gY3JlYXRlRGVidWcuc2tpcHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdGlmIChjcmVhdGVEZWJ1Zy5za2lwc1tpXS50ZXN0KG5hbWUpKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBjcmVhdGVEZWJ1Zy5uYW1lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0aWYgKGNyZWF0ZURlYnVnLm5hbWVzW2ldLnRlc3QobmFtZSkpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0LyoqXG5cdCogQ29udmVydCByZWdleHAgdG8gbmFtZXNwYWNlXG5cdCpcblx0KiBAcGFyYW0ge1JlZ0V4cH0gcmVneGVwXG5cdCogQHJldHVybiB7U3RyaW5nfSBuYW1lc3BhY2Vcblx0KiBAYXBpIHByaXZhdGVcblx0Ki9cblx0ZnVuY3Rpb24gdG9OYW1lc3BhY2UocmVnZXhwKSB7XG5cdFx0cmV0dXJuIHJlZ2V4cC50b1N0cmluZygpXG5cdFx0XHQuc3Vic3RyaW5nKDIsIHJlZ2V4cC50b1N0cmluZygpLmxlbmd0aCAtIDIpXG5cdFx0XHQucmVwbGFjZSgvXFwuXFwqXFw/JC8sICcqJyk7XG5cdH1cblxuXHQvKipcblx0KiBDb2VyY2UgYHZhbGAuXG5cdCpcblx0KiBAcGFyYW0ge01peGVkfSB2YWxcblx0KiBAcmV0dXJuIHtNaXhlZH1cblx0KiBAYXBpIHByaXZhdGVcblx0Ki9cblx0ZnVuY3Rpb24gY29lcmNlKHZhbCkge1xuXHRcdGlmICh2YWwgaW5zdGFuY2VvZiBFcnJvcikge1xuXHRcdFx0cmV0dXJuIHZhbC5zdGFjayB8fCB2YWwubWVzc2FnZTtcblx0XHR9XG5cdFx0cmV0dXJuIHZhbDtcblx0fVxuXG5cdGNyZWF0ZURlYnVnLmVuYWJsZShjcmVhdGVEZWJ1Zy5sb2FkKCkpO1xuXG5cdHJldHVybiBjcmVhdGVEZWJ1Zztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzZXR1cDtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9kZWJ1Zy9zcmMvY29tbW9uLmpzXG4vLyBtb2R1bGUgaWQgPSAxMzhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyohXG4gKiBAb3ZlcnZpZXcgZXM2LXByb21pc2UgLSBhIHRpbnkgaW1wbGVtZW50YXRpb24gb2YgUHJvbWlzZXMvQSsuXG4gKiBAY29weXJpZ2h0IENvcHlyaWdodCAoYykgMjAxNCBZZWh1ZGEgS2F0eiwgVG9tIERhbGUsIFN0ZWZhbiBQZW5uZXIgYW5kIGNvbnRyaWJ1dG9ycyAoQ29udmVyc2lvbiB0byBFUzYgQVBJIGJ5IEpha2UgQXJjaGliYWxkKVxuICogQGxpY2Vuc2UgICBMaWNlbnNlZCB1bmRlciBNSVQgbGljZW5zZVxuICogICAgICAgICAgICBTZWUgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3N0ZWZhbnBlbm5lci9lczYtcHJvbWlzZS9tYXN0ZXIvTElDRU5TRVxuICogQHZlcnNpb24gICB2NC4yLjQrMzE0ZTQ4MzFcbiAqL1xuXG4oZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG5cdChnbG9iYWwuRVM2UHJvbWlzZSA9IGZhY3RvcnkoKSk7XG59KHRoaXMsIChmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gb2JqZWN0T3JGdW5jdGlvbih4KSB7XG4gIHZhciB0eXBlID0gdHlwZW9mIHg7XG4gIHJldHVybiB4ICE9PSBudWxsICYmICh0eXBlID09PSAnb2JqZWN0JyB8fCB0eXBlID09PSAnZnVuY3Rpb24nKTtcbn1cblxuZnVuY3Rpb24gaXNGdW5jdGlvbih4KSB7XG4gIHJldHVybiB0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJztcbn1cblxuXG5cbnZhciBfaXNBcnJheSA9IHZvaWQgMDtcbmlmIChBcnJheS5pc0FycmF5KSB7XG4gIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcbn0gZWxzZSB7XG4gIF9pc0FycmF5ID0gZnVuY3Rpb24gKHgpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHgpID09PSAnW29iamVjdCBBcnJheV0nO1xuICB9O1xufVxuXG52YXIgaXNBcnJheSA9IF9pc0FycmF5O1xuXG52YXIgbGVuID0gMDtcbnZhciB2ZXJ0eE5leHQgPSB2b2lkIDA7XG52YXIgY3VzdG9tU2NoZWR1bGVyRm4gPSB2b2lkIDA7XG5cbnZhciBhc2FwID0gZnVuY3Rpb24gYXNhcChjYWxsYmFjaywgYXJnKSB7XG4gIHF1ZXVlW2xlbl0gPSBjYWxsYmFjaztcbiAgcXVldWVbbGVuICsgMV0gPSBhcmc7XG4gIGxlbiArPSAyO1xuICBpZiAobGVuID09PSAyKSB7XG4gICAgLy8gSWYgbGVuIGlzIDIsIHRoYXQgbWVhbnMgdGhhdCB3ZSBuZWVkIHRvIHNjaGVkdWxlIGFuIGFzeW5jIGZsdXNoLlxuICAgIC8vIElmIGFkZGl0aW9uYWwgY2FsbGJhY2tzIGFyZSBxdWV1ZWQgYmVmb3JlIHRoZSBxdWV1ZSBpcyBmbHVzaGVkLCB0aGV5XG4gICAgLy8gd2lsbCBiZSBwcm9jZXNzZWQgYnkgdGhpcyBmbHVzaCB0aGF0IHdlIGFyZSBzY2hlZHVsaW5nLlxuICAgIGlmIChjdXN0b21TY2hlZHVsZXJGbikge1xuICAgICAgY3VzdG9tU2NoZWR1bGVyRm4oZmx1c2gpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzY2hlZHVsZUZsdXNoKCk7XG4gICAgfVxuICB9XG59O1xuXG5mdW5jdGlvbiBzZXRTY2hlZHVsZXIoc2NoZWR1bGVGbikge1xuICBjdXN0b21TY2hlZHVsZXJGbiA9IHNjaGVkdWxlRm47XG59XG5cbmZ1bmN0aW9uIHNldEFzYXAoYXNhcEZuKSB7XG4gIGFzYXAgPSBhc2FwRm47XG59XG5cbnZhciBicm93c2VyV2luZG93ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB1bmRlZmluZWQ7XG52YXIgYnJvd3Nlckdsb2JhbCA9IGJyb3dzZXJXaW5kb3cgfHwge307XG52YXIgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIgPSBicm93c2VyR2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgYnJvd3Nlckdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyO1xudmFyIGlzTm9kZSA9IHR5cGVvZiBzZWxmID09PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYge30udG9TdHJpbmcuY2FsbChwcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nO1xuXG4vLyB0ZXN0IGZvciB3ZWIgd29ya2VyIGJ1dCBub3QgaW4gSUUxMFxudmFyIGlzV29ya2VyID0gdHlwZW9mIFVpbnQ4Q2xhbXBlZEFycmF5ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgaW1wb3J0U2NyaXB0cyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIE1lc3NhZ2VDaGFubmVsICE9PSAndW5kZWZpbmVkJztcblxuLy8gbm9kZVxuZnVuY3Rpb24gdXNlTmV4dFRpY2soKSB7XG4gIC8vIG5vZGUgdmVyc2lvbiAwLjEwLnggZGlzcGxheXMgYSBkZXByZWNhdGlvbiB3YXJuaW5nIHdoZW4gbmV4dFRpY2sgaXMgdXNlZCByZWN1cnNpdmVseVxuICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2N1am9qcy93aGVuL2lzc3Vlcy80MTAgZm9yIGRldGFpbHNcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7XG4gIH07XG59XG5cbi8vIHZlcnR4XG5mdW5jdGlvbiB1c2VWZXJ0eFRpbWVyKCkge1xuICBpZiAodHlwZW9mIHZlcnR4TmV4dCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdmVydHhOZXh0KGZsdXNoKTtcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIHVzZVNldFRpbWVvdXQoKTtcbn1cblxuZnVuY3Rpb24gdXNlTXV0YXRpb25PYnNlcnZlcigpIHtcbiAgdmFyIGl0ZXJhdGlvbnMgPSAwO1xuICB2YXIgb2JzZXJ2ZXIgPSBuZXcgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIoZmx1c2gpO1xuICB2YXIgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTtcbiAgb2JzZXJ2ZXIub2JzZXJ2ZShub2RlLCB7IGNoYXJhY3RlckRhdGE6IHRydWUgfSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBub2RlLmRhdGEgPSBpdGVyYXRpb25zID0gKytpdGVyYXRpb25zICUgMjtcbiAgfTtcbn1cblxuLy8gd2ViIHdvcmtlclxuZnVuY3Rpb24gdXNlTWVzc2FnZUNoYW5uZWwoKSB7XG4gIHZhciBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG4gIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZmx1c2g7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoMCk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHVzZVNldFRpbWVvdXQoKSB7XG4gIC8vIFN0b3JlIHNldFRpbWVvdXQgcmVmZXJlbmNlIHNvIGVzNi1wcm9taXNlIHdpbGwgYmUgdW5hZmZlY3RlZCBieVxuICAvLyBvdGhlciBjb2RlIG1vZGlmeWluZyBzZXRUaW1lb3V0IChsaWtlIHNpbm9uLnVzZUZha2VUaW1lcnMoKSlcbiAgdmFyIGdsb2JhbFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBnbG9iYWxTZXRUaW1lb3V0KGZsdXNoLCAxKTtcbiAgfTtcbn1cblxudmFyIHF1ZXVlID0gbmV3IEFycmF5KDEwMDApO1xuZnVuY3Rpb24gZmx1c2goKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDIpIHtcbiAgICB2YXIgY2FsbGJhY2sgPSBxdWV1ZVtpXTtcbiAgICB2YXIgYXJnID0gcXVldWVbaSArIDFdO1xuXG4gICAgY2FsbGJhY2soYXJnKTtcblxuICAgIHF1ZXVlW2ldID0gdW5kZWZpbmVkO1xuICAgIHF1ZXVlW2kgKyAxXSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGxlbiA9IDA7XG59XG5cbmZ1bmN0aW9uIGF0dGVtcHRWZXJ0eCgpIHtcbiAgdHJ5IHtcbiAgICB2YXIgdmVydHggPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpLnJlcXVpcmUoJ3ZlcnR4Jyk7XG4gICAgdmVydHhOZXh0ID0gdmVydHgucnVuT25Mb29wIHx8IHZlcnR4LnJ1bk9uQ29udGV4dDtcbiAgICByZXR1cm4gdXNlVmVydHhUaW1lcigpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHVzZVNldFRpbWVvdXQoKTtcbiAgfVxufVxuXG52YXIgc2NoZWR1bGVGbHVzaCA9IHZvaWQgMDtcbi8vIERlY2lkZSB3aGF0IGFzeW5jIG1ldGhvZCB0byB1c2UgdG8gdHJpZ2dlcmluZyBwcm9jZXNzaW5nIG9mIHF1ZXVlZCBjYWxsYmFja3M6XG5pZiAoaXNOb2RlKSB7XG4gIHNjaGVkdWxlRmx1c2ggPSB1c2VOZXh0VGljaygpO1xufSBlbHNlIGlmIChCcm93c2VyTXV0YXRpb25PYnNlcnZlcikge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlTXV0YXRpb25PYnNlcnZlcigpO1xufSBlbHNlIGlmIChpc1dvcmtlcikge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlTWVzc2FnZUNoYW5uZWwoKTtcbn0gZWxzZSBpZiAoYnJvd3NlcldpbmRvdyA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiByZXF1aXJlID09PSAnZnVuY3Rpb24nKSB7XG4gIHNjaGVkdWxlRmx1c2ggPSBhdHRlbXB0VmVydHgoKTtcbn0gZWxzZSB7XG4gIHNjaGVkdWxlRmx1c2ggPSB1c2VTZXRUaW1lb3V0KCk7XG59XG5cbmZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcbiAgdmFyIHBhcmVudCA9IHRoaXM7XG5cbiAgdmFyIGNoaWxkID0gbmV3IHRoaXMuY29uc3RydWN0b3Iobm9vcCk7XG5cbiAgaWYgKGNoaWxkW1BST01JU0VfSURdID09PSB1bmRlZmluZWQpIHtcbiAgICBtYWtlUHJvbWlzZShjaGlsZCk7XG4gIH1cblxuICB2YXIgX3N0YXRlID0gcGFyZW50Ll9zdGF0ZTtcblxuXG4gIGlmIChfc3RhdGUpIHtcbiAgICB2YXIgY2FsbGJhY2sgPSBhcmd1bWVudHNbX3N0YXRlIC0gMV07XG4gICAgYXNhcChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gaW52b2tlQ2FsbGJhY2soX3N0YXRlLCBjaGlsZCwgY2FsbGJhY2ssIHBhcmVudC5fcmVzdWx0KTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pO1xuICB9XG5cbiAgcmV0dXJuIGNoaWxkO1xufVxuXG4vKipcbiAgYFByb21pc2UucmVzb2x2ZWAgcmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIGJlY29tZSByZXNvbHZlZCB3aXRoIHRoZVxuICBwYXNzZWQgYHZhbHVlYC4gSXQgaXMgc2hvcnRoYW5kIGZvciB0aGUgZm9sbG93aW5nOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHJlc29sdmUoMSk7XG4gIH0pO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gdmFsdWUgPT09IDFcbiAgfSk7XG4gIGBgYFxuXG4gIEluc3RlYWQgb2Ygd3JpdGluZyB0aGUgYWJvdmUsIHlvdXIgY29kZSBub3cgc2ltcGx5IGJlY29tZXMgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKDEpO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gdmFsdWUgPT09IDFcbiAgfSk7XG4gIGBgYFxuXG4gIEBtZXRob2QgcmVzb2x2ZVxuICBAc3RhdGljXG4gIEBwYXJhbSB7QW55fSB2YWx1ZSB2YWx1ZSB0aGF0IHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGwgYmUgcmVzb2x2ZWQgd2l0aFxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSB0aGF0IHdpbGwgYmVjb21lIGZ1bGZpbGxlZCB3aXRoIHRoZSBnaXZlblxuICBgdmFsdWVgXG4qL1xuZnVuY3Rpb24gcmVzb2x2ZSQxKG9iamVjdCkge1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXG4gIGlmIChvYmplY3QgJiYgdHlwZW9mIG9iamVjdCA9PT0gJ29iamVjdCcgJiYgb2JqZWN0LmNvbnN0cnVjdG9yID09PSBDb25zdHJ1Y3Rvcikge1xuICAgIHJldHVybiBvYmplY3Q7XG4gIH1cblxuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcbiAgcmVzb2x2ZShwcm9taXNlLCBvYmplY3QpO1xuICByZXR1cm4gcHJvbWlzZTtcbn1cblxudmFyIFBST01JU0VfSUQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMik7XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG52YXIgUEVORElORyA9IHZvaWQgMDtcbnZhciBGVUxGSUxMRUQgPSAxO1xudmFyIFJFSkVDVEVEID0gMjtcblxudmFyIFRSWV9DQVRDSF9FUlJPUiA9IHsgZXJyb3I6IG51bGwgfTtcblxuZnVuY3Rpb24gc2VsZkZ1bGZpbGxtZW50KCkge1xuICByZXR1cm4gbmV3IFR5cGVFcnJvcihcIllvdSBjYW5ub3QgcmVzb2x2ZSBhIHByb21pc2Ugd2l0aCBpdHNlbGZcIik7XG59XG5cbmZ1bmN0aW9uIGNhbm5vdFJldHVybk93bigpIHtcbiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoJ0EgcHJvbWlzZXMgY2FsbGJhY2sgY2Fubm90IHJldHVybiB0aGF0IHNhbWUgcHJvbWlzZS4nKTtcbn1cblxuZnVuY3Rpb24gZ2V0VGhlbihwcm9taXNlKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHByb21pc2UudGhlbjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBUUllfQ0FUQ0hfRVJST1IuZXJyb3IgPSBlcnJvcjtcbiAgICByZXR1cm4gVFJZX0NBVENIX0VSUk9SO1xuICB9XG59XG5cbmZ1bmN0aW9uIHRyeVRoZW4odGhlbiQkMSwgdmFsdWUsIGZ1bGZpbGxtZW50SGFuZGxlciwgcmVqZWN0aW9uSGFuZGxlcikge1xuICB0cnkge1xuICAgIHRoZW4kJDEuY2FsbCh2YWx1ZSwgZnVsZmlsbG1lbnRIYW5kbGVyLCByZWplY3Rpb25IYW5kbGVyKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUZvcmVpZ25UaGVuYWJsZShwcm9taXNlLCB0aGVuYWJsZSwgdGhlbiQkMSkge1xuICBhc2FwKGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gICAgdmFyIHNlYWxlZCA9IGZhbHNlO1xuICAgIHZhciBlcnJvciA9IHRyeVRoZW4odGhlbiQkMSwgdGhlbmFibGUsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgaWYgKHNlYWxlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzZWFsZWQgPSB0cnVlO1xuICAgICAgaWYgKHRoZW5hYmxlICE9PSB2YWx1ZSkge1xuICAgICAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGlmIChzZWFsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2VhbGVkID0gdHJ1ZTtcblxuICAgICAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gICAgfSwgJ1NldHRsZTogJyArIChwcm9taXNlLl9sYWJlbCB8fCAnIHVua25vd24gcHJvbWlzZScpKTtcblxuICAgIGlmICghc2VhbGVkICYmIGVycm9yKSB7XG4gICAgICBzZWFsZWQgPSB0cnVlO1xuICAgICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTtcbiAgICB9XG4gIH0sIHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCB0aGVuYWJsZSkge1xuICBpZiAodGhlbmFibGUuX3N0YXRlID09PSBGVUxGSUxMRUQpIHtcbiAgICBmdWxmaWxsKHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuICB9IGVsc2UgaWYgKHRoZW5hYmxlLl9zdGF0ZSA9PT0gUkVKRUNURUQpIHtcbiAgICByZWplY3QocHJvbWlzZSwgdGhlbmFibGUuX3Jlc3VsdCk7XG4gIH0gZWxzZSB7XG4gICAgc3Vic2NyaWJlKHRoZW5hYmxlLCB1bmRlZmluZWQsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIHJldHVybiByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUsIHRoZW4kJDEpIHtcbiAgaWYgKG1heWJlVGhlbmFibGUuY29uc3RydWN0b3IgPT09IHByb21pc2UuY29uc3RydWN0b3IgJiYgdGhlbiQkMSA9PT0gdGhlbiAmJiBtYXliZVRoZW5hYmxlLmNvbnN0cnVjdG9yLnJlc29sdmUgPT09IHJlc29sdmUkMSkge1xuICAgIGhhbmRsZU93blRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUpO1xuICB9IGVsc2Uge1xuICAgIGlmICh0aGVuJCQxID09PSBUUllfQ0FUQ0hfRVJST1IpIHtcbiAgICAgIHJlamVjdChwcm9taXNlLCBUUllfQ0FUQ0hfRVJST1IuZXJyb3IpO1xuICAgICAgVFJZX0NBVENIX0VSUk9SLmVycm9yID0gbnVsbDtcbiAgICB9IGVsc2UgaWYgKHRoZW4kJDEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgZnVsZmlsbChwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgICB9IGVsc2UgaWYgKGlzRnVuY3Rpb24odGhlbiQkMSkpIHtcbiAgICAgIGhhbmRsZUZvcmVpZ25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlLCB0aGVuJCQxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZnVsZmlsbChwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSkge1xuICBpZiAocHJvbWlzZSA9PT0gdmFsdWUpIHtcbiAgICByZWplY3QocHJvbWlzZSwgc2VsZkZ1bGZpbGxtZW50KCkpO1xuICB9IGVsc2UgaWYgKG9iamVjdE9yRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCB2YWx1ZSwgZ2V0VGhlbih2YWx1ZSkpO1xuICB9IGVsc2Uge1xuICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2hSZWplY3Rpb24ocHJvbWlzZSkge1xuICBpZiAocHJvbWlzZS5fb25lcnJvcikge1xuICAgIHByb21pc2UuX29uZXJyb3IocHJvbWlzZS5fcmVzdWx0KTtcbiAgfVxuXG4gIHB1Ymxpc2gocHJvbWlzZSk7XG59XG5cbmZ1bmN0aW9uIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpIHtcbiAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcHJvbWlzZS5fcmVzdWx0ID0gdmFsdWU7XG4gIHByb21pc2UuX3N0YXRlID0gRlVMRklMTEVEO1xuXG4gIGlmIChwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggIT09IDApIHtcbiAgICBhc2FwKHB1Ymxpc2gsIHByb21pc2UpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlamVjdChwcm9taXNlLCByZWFzb24pIHtcbiAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHByb21pc2UuX3N0YXRlID0gUkVKRUNURUQ7XG4gIHByb21pc2UuX3Jlc3VsdCA9IHJlYXNvbjtcblxuICBhc2FwKHB1Ymxpc2hSZWplY3Rpb24sIHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcbiAgdmFyIF9zdWJzY3JpYmVycyA9IHBhcmVudC5fc3Vic2NyaWJlcnM7XG4gIHZhciBsZW5ndGggPSBfc3Vic2NyaWJlcnMubGVuZ3RoO1xuXG5cbiAgcGFyZW50Ll9vbmVycm9yID0gbnVsbDtcblxuICBfc3Vic2NyaWJlcnNbbGVuZ3RoXSA9IGNoaWxkO1xuICBfc3Vic2NyaWJlcnNbbGVuZ3RoICsgRlVMRklMTEVEXSA9IG9uRnVsZmlsbG1lbnQ7XG4gIF9zdWJzY3JpYmVyc1tsZW5ndGggKyBSRUpFQ1RFRF0gPSBvblJlamVjdGlvbjtcblxuICBpZiAobGVuZ3RoID09PSAwICYmIHBhcmVudC5fc3RhdGUpIHtcbiAgICBhc2FwKHB1Ymxpc2gsIHBhcmVudCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcHVibGlzaChwcm9taXNlKSB7XG4gIHZhciBzdWJzY3JpYmVycyA9IHByb21pc2UuX3N1YnNjcmliZXJzO1xuICB2YXIgc2V0dGxlZCA9IHByb21pc2UuX3N0YXRlO1xuXG4gIGlmIChzdWJzY3JpYmVycy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY2hpbGQgPSB2b2lkIDAsXG4gICAgICBjYWxsYmFjayA9IHZvaWQgMCxcbiAgICAgIGRldGFpbCA9IHByb21pc2UuX3Jlc3VsdDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YnNjcmliZXJzLmxlbmd0aDsgaSArPSAzKSB7XG4gICAgY2hpbGQgPSBzdWJzY3JpYmVyc1tpXTtcbiAgICBjYWxsYmFjayA9IHN1YnNjcmliZXJzW2kgKyBzZXR0bGVkXTtcblxuICAgIGlmIChjaGlsZCkge1xuICAgICAgaW52b2tlQ2FsbGJhY2soc2V0dGxlZCwgY2hpbGQsIGNhbGxiYWNrLCBkZXRhaWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYWxsYmFjayhkZXRhaWwpO1xuICAgIH1cbiAgfVxuXG4gIHByb21pc2UuX3N1YnNjcmliZXJzLmxlbmd0aCA9IDA7XG59XG5cbmZ1bmN0aW9uIHRyeUNhdGNoKGNhbGxiYWNrLCBkZXRhaWwpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gY2FsbGJhY2soZGV0YWlsKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIFRSWV9DQVRDSF9FUlJPUi5lcnJvciA9IGU7XG4gICAgcmV0dXJuIFRSWV9DQVRDSF9FUlJPUjtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbnZva2VDYWxsYmFjayhzZXR0bGVkLCBwcm9taXNlLCBjYWxsYmFjaywgZGV0YWlsKSB7XG4gIHZhciBoYXNDYWxsYmFjayA9IGlzRnVuY3Rpb24oY2FsbGJhY2spLFxuICAgICAgdmFsdWUgPSB2b2lkIDAsXG4gICAgICBlcnJvciA9IHZvaWQgMCxcbiAgICAgIHN1Y2NlZWRlZCA9IHZvaWQgMCxcbiAgICAgIGZhaWxlZCA9IHZvaWQgMDtcblxuICBpZiAoaGFzQ2FsbGJhY2spIHtcbiAgICB2YWx1ZSA9IHRyeUNhdGNoKGNhbGxiYWNrLCBkZXRhaWwpO1xuXG4gICAgaWYgKHZhbHVlID09PSBUUllfQ0FUQ0hfRVJST1IpIHtcbiAgICAgIGZhaWxlZCA9IHRydWU7XG4gICAgICBlcnJvciA9IHZhbHVlLmVycm9yO1xuICAgICAgdmFsdWUuZXJyb3IgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdWNjZWVkZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChwcm9taXNlID09PSB2YWx1ZSkge1xuICAgICAgcmVqZWN0KHByb21pc2UsIGNhbm5vdFJldHVybk93bigpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdmFsdWUgPSBkZXRhaWw7XG4gICAgc3VjY2VlZGVkID0gdHJ1ZTtcbiAgfVxuXG4gIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuICAgIC8vIG5vb3BcbiAgfSBlbHNlIGlmIChoYXNDYWxsYmFjayAmJiBzdWNjZWVkZWQpIHtcbiAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgfSBlbHNlIGlmIChmYWlsZWQpIHtcbiAgICByZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuICB9IGVsc2UgaWYgKHNldHRsZWQgPT09IEZVTEZJTExFRCkge1xuICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICB9IGVsc2UgaWYgKHNldHRsZWQgPT09IFJFSkVDVEVEKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbml0aWFsaXplUHJvbWlzZShwcm9taXNlLCByZXNvbHZlcikge1xuICB0cnkge1xuICAgIHJlc29sdmVyKGZ1bmN0aW9uIHJlc29sdmVQcm9taXNlKHZhbHVlKSB7XG4gICAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICB9LCBmdW5jdGlvbiByZWplY3RQcm9taXNlKHJlYXNvbikge1xuICAgICAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZWplY3QocHJvbWlzZSwgZSk7XG4gIH1cbn1cblxudmFyIGlkID0gMDtcbmZ1bmN0aW9uIG5leHRJZCgpIHtcbiAgcmV0dXJuIGlkKys7XG59XG5cbmZ1bmN0aW9uIG1ha2VQcm9taXNlKHByb21pc2UpIHtcbiAgcHJvbWlzZVtQUk9NSVNFX0lEXSA9IGlkKys7XG4gIHByb21pc2UuX3N0YXRlID0gdW5kZWZpbmVkO1xuICBwcm9taXNlLl9yZXN1bHQgPSB1bmRlZmluZWQ7XG4gIHByb21pc2UuX3N1YnNjcmliZXJzID0gW107XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRpb25FcnJvcigpIHtcbiAgcmV0dXJuIG5ldyBFcnJvcignQXJyYXkgTWV0aG9kcyBtdXN0IGJlIHByb3ZpZGVkIGFuIEFycmF5Jyk7XG59XG5cbnZhciBFbnVtZXJhdG9yID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBFbnVtZXJhdG9yKENvbnN0cnVjdG9yLCBpbnB1dCkge1xuICAgIHRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3IgPSBDb25zdHJ1Y3RvcjtcbiAgICB0aGlzLnByb21pc2UgPSBuZXcgQ29uc3RydWN0b3Iobm9vcCk7XG5cbiAgICBpZiAoIXRoaXMucHJvbWlzZVtQUk9NSVNFX0lEXSkge1xuICAgICAgbWFrZVByb21pc2UodGhpcy5wcm9taXNlKTtcbiAgICB9XG5cbiAgICBpZiAoaXNBcnJheShpbnB1dCkpIHtcbiAgICAgIHRoaXMubGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xuICAgICAgdGhpcy5fcmVtYWluaW5nID0gaW5wdXQubGVuZ3RoO1xuXG4gICAgICB0aGlzLl9yZXN1bHQgPSBuZXcgQXJyYXkodGhpcy5sZW5ndGgpO1xuXG4gICAgICBpZiAodGhpcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZnVsZmlsbCh0aGlzLnByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxlbmd0aCA9IHRoaXMubGVuZ3RoIHx8IDA7XG4gICAgICAgIHRoaXMuX2VudW1lcmF0ZShpbnB1dCk7XG4gICAgICAgIGlmICh0aGlzLl9yZW1haW5pbmcgPT09IDApIHtcbiAgICAgICAgICBmdWxmaWxsKHRoaXMucHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZWplY3QodGhpcy5wcm9taXNlLCB2YWxpZGF0aW9uRXJyb3IoKSk7XG4gICAgfVxuICB9XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX2VudW1lcmF0ZSA9IGZ1bmN0aW9uIF9lbnVtZXJhdGUoaW5wdXQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgdGhpcy5fc3RhdGUgPT09IFBFTkRJTkcgJiYgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLl9lYWNoRW50cnkoaW5wdXRbaV0sIGkpO1xuICAgIH1cbiAgfTtcblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fZWFjaEVudHJ5ID0gZnVuY3Rpb24gX2VhY2hFbnRyeShlbnRyeSwgaSkge1xuICAgIHZhciBjID0gdGhpcy5faW5zdGFuY2VDb25zdHJ1Y3RvcjtcbiAgICB2YXIgcmVzb2x2ZSQkMSA9IGMucmVzb2x2ZTtcblxuXG4gICAgaWYgKHJlc29sdmUkJDEgPT09IHJlc29sdmUkMSkge1xuICAgICAgdmFyIF90aGVuID0gZ2V0VGhlbihlbnRyeSk7XG5cbiAgICAgIGlmIChfdGhlbiA9PT0gdGhlbiAmJiBlbnRyeS5fc3RhdGUgIT09IFBFTkRJTkcpIHtcbiAgICAgICAgdGhpcy5fc2V0dGxlZEF0KGVudHJ5Ll9zdGF0ZSwgaSwgZW50cnkuX3Jlc3VsdCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBfdGhlbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLl9yZW1haW5pbmctLTtcbiAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gZW50cnk7XG4gICAgICB9IGVsc2UgaWYgKGMgPT09IFByb21pc2UkMSkge1xuICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBjKG5vb3ApO1xuICAgICAgICBoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsIGVudHJ5LCBfdGhlbik7XG4gICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChwcm9taXNlLCBpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChuZXcgYyhmdW5jdGlvbiAocmVzb2x2ZSQkMSkge1xuICAgICAgICAgIHJldHVybiByZXNvbHZlJCQxKGVudHJ5KTtcbiAgICAgICAgfSksIGkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl93aWxsU2V0dGxlQXQocmVzb2x2ZSQkMShlbnRyeSksIGkpO1xuICAgIH1cbiAgfTtcblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fc2V0dGxlZEF0ID0gZnVuY3Rpb24gX3NldHRsZWRBdChzdGF0ZSwgaSwgdmFsdWUpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcblxuXG4gICAgaWYgKHByb21pc2UuX3N0YXRlID09PSBQRU5ESU5HKSB7XG4gICAgICB0aGlzLl9yZW1haW5pbmctLTtcblxuICAgICAgaWYgKHN0YXRlID09PSBSRUpFQ1RFRCkge1xuICAgICAgICByZWplY3QocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX3JlbWFpbmluZyA9PT0gMCkge1xuICAgICAgZnVsZmlsbChwcm9taXNlLCB0aGlzLl9yZXN1bHQpO1xuICAgIH1cbiAgfTtcblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fd2lsbFNldHRsZUF0ID0gZnVuY3Rpb24gX3dpbGxTZXR0bGVBdChwcm9taXNlLCBpKSB7XG4gICAgdmFyIGVudW1lcmF0b3IgPSB0aGlzO1xuXG4gICAgc3Vic2NyaWJlKHByb21pc2UsIHVuZGVmaW5lZCwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXR1cm4gZW51bWVyYXRvci5fc2V0dGxlZEF0KEZVTEZJTExFRCwgaSwgdmFsdWUpO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIHJldHVybiBlbnVtZXJhdG9yLl9zZXR0bGVkQXQoUkVKRUNURUQsIGksIHJlYXNvbik7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIEVudW1lcmF0b3I7XG59KCk7XG5cbi8qKlxuICBgUHJvbWlzZS5hbGxgIGFjY2VwdHMgYW4gYXJyYXkgb2YgcHJvbWlzZXMsIGFuZCByZXR1cm5zIGEgbmV3IHByb21pc2Ugd2hpY2hcbiAgaXMgZnVsZmlsbGVkIHdpdGggYW4gYXJyYXkgb2YgZnVsZmlsbG1lbnQgdmFsdWVzIGZvciB0aGUgcGFzc2VkIHByb21pc2VzLCBvclxuICByZWplY3RlZCB3aXRoIHRoZSByZWFzb24gb2YgdGhlIGZpcnN0IHBhc3NlZCBwcm9taXNlIHRvIGJlIHJlamVjdGVkLiBJdCBjYXN0cyBhbGxcbiAgZWxlbWVudHMgb2YgdGhlIHBhc3NlZCBpdGVyYWJsZSB0byBwcm9taXNlcyBhcyBpdCBydW5zIHRoaXMgYWxnb3JpdGhtLlxuXG4gIEV4YW1wbGU6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSByZXNvbHZlKDEpO1xuICBsZXQgcHJvbWlzZTIgPSByZXNvbHZlKDIpO1xuICBsZXQgcHJvbWlzZTMgPSByZXNvbHZlKDMpO1xuICBsZXQgcHJvbWlzZXMgPSBbIHByb21pc2UxLCBwcm9taXNlMiwgcHJvbWlzZTMgXTtcblxuICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbihhcnJheSl7XG4gICAgLy8gVGhlIGFycmF5IGhlcmUgd291bGQgYmUgWyAxLCAyLCAzIF07XG4gIH0pO1xuICBgYGBcblxuICBJZiBhbnkgb2YgdGhlIGBwcm9taXNlc2AgZ2l2ZW4gdG8gYGFsbGAgYXJlIHJlamVjdGVkLCB0aGUgZmlyc3QgcHJvbWlzZVxuICB0aGF0IGlzIHJlamVjdGVkIHdpbGwgYmUgZ2l2ZW4gYXMgYW4gYXJndW1lbnQgdG8gdGhlIHJldHVybmVkIHByb21pc2VzJ3NcbiAgcmVqZWN0aW9uIGhhbmRsZXIuIEZvciBleGFtcGxlOlxuXG4gIEV4YW1wbGU6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSByZXNvbHZlKDEpO1xuICBsZXQgcHJvbWlzZTIgPSByZWplY3QobmV3IEVycm9yKFwiMlwiKSk7XG4gIGxldCBwcm9taXNlMyA9IHJlamVjdChuZXcgRXJyb3IoXCIzXCIpKTtcbiAgbGV0IHByb21pc2VzID0gWyBwcm9taXNlMSwgcHJvbWlzZTIsIHByb21pc2UzIF07XG5cbiAgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oYXJyYXkpe1xuICAgIC8vIENvZGUgaGVyZSBuZXZlciBydW5zIGJlY2F1c2UgdGhlcmUgYXJlIHJlamVjdGVkIHByb21pc2VzIVxuICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgIC8vIGVycm9yLm1lc3NhZ2UgPT09IFwiMlwiXG4gIH0pO1xuICBgYGBcblxuICBAbWV0aG9kIGFsbFxuICBAc3RhdGljXG4gIEBwYXJhbSB7QXJyYXl9IGVudHJpZXMgYXJyYXkgb2YgcHJvbWlzZXNcbiAgQHBhcmFtIHtTdHJpbmd9IGxhYmVsIG9wdGlvbmFsIHN0cmluZyBmb3IgbGFiZWxpbmcgdGhlIHByb21pc2UuXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSB0aGF0IGlzIGZ1bGZpbGxlZCB3aGVuIGFsbCBgcHJvbWlzZXNgIGhhdmUgYmVlblxuICBmdWxmaWxsZWQsIG9yIHJlamVjdGVkIGlmIGFueSBvZiB0aGVtIGJlY29tZSByZWplY3RlZC5cbiAgQHN0YXRpY1xuKi9cbmZ1bmN0aW9uIGFsbChlbnRyaWVzKSB7XG4gIHJldHVybiBuZXcgRW51bWVyYXRvcih0aGlzLCBlbnRyaWVzKS5wcm9taXNlO1xufVxuXG4vKipcbiAgYFByb21pc2UucmFjZWAgcmV0dXJucyBhIG5ldyBwcm9taXNlIHdoaWNoIGlzIHNldHRsZWQgaW4gdGhlIHNhbWUgd2F5IGFzIHRoZVxuICBmaXJzdCBwYXNzZWQgcHJvbWlzZSB0byBzZXR0bGUuXG5cbiAgRXhhbXBsZTpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlMSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVzb2x2ZSgncHJvbWlzZSAxJyk7XG4gICAgfSwgMjAwKTtcbiAgfSk7XG5cbiAgbGV0IHByb21pc2UyID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXNvbHZlKCdwcm9taXNlIDInKTtcbiAgICB9LCAxMDApO1xuICB9KTtcblxuICBQcm9taXNlLnJhY2UoW3Byb21pc2UxLCBwcm9taXNlMl0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAvLyByZXN1bHQgPT09ICdwcm9taXNlIDInIGJlY2F1c2UgaXQgd2FzIHJlc29sdmVkIGJlZm9yZSBwcm9taXNlMVxuICAgIC8vIHdhcyByZXNvbHZlZC5cbiAgfSk7XG4gIGBgYFxuXG4gIGBQcm9taXNlLnJhY2VgIGlzIGRldGVybWluaXN0aWMgaW4gdGhhdCBvbmx5IHRoZSBzdGF0ZSBvZiB0aGUgZmlyc3RcbiAgc2V0dGxlZCBwcm9taXNlIG1hdHRlcnMuIEZvciBleGFtcGxlLCBldmVuIGlmIG90aGVyIHByb21pc2VzIGdpdmVuIHRvIHRoZVxuICBgcHJvbWlzZXNgIGFycmF5IGFyZ3VtZW50IGFyZSByZXNvbHZlZCwgYnV0IHRoZSBmaXJzdCBzZXR0bGVkIHByb21pc2UgaGFzXG4gIGJlY29tZSByZWplY3RlZCBiZWZvcmUgdGhlIG90aGVyIHByb21pc2VzIGJlY2FtZSBmdWxmaWxsZWQsIHRoZSByZXR1cm5lZFxuICBwcm9taXNlIHdpbGwgYmVjb21lIHJlamVjdGVkOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXNvbHZlKCdwcm9taXNlIDEnKTtcbiAgICB9LCAyMDApO1xuICB9KTtcblxuICBsZXQgcHJvbWlzZTIgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHJlamVjdChuZXcgRXJyb3IoJ3Byb21pc2UgMicpKTtcbiAgICB9LCAxMDApO1xuICB9KTtcblxuICBQcm9taXNlLnJhY2UoW3Byb21pc2UxLCBwcm9taXNlMl0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAvLyBDb2RlIGhlcmUgbmV2ZXIgcnVuc1xuICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIHJlYXNvbi5tZXNzYWdlID09PSAncHJvbWlzZSAyJyBiZWNhdXNlIHByb21pc2UgMiBiZWNhbWUgcmVqZWN0ZWQgYmVmb3JlXG4gICAgLy8gcHJvbWlzZSAxIGJlY2FtZSBmdWxmaWxsZWRcbiAgfSk7XG4gIGBgYFxuXG4gIEFuIGV4YW1wbGUgcmVhbC13b3JsZCB1c2UgY2FzZSBpcyBpbXBsZW1lbnRpbmcgdGltZW91dHM6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBQcm9taXNlLnJhY2UoW2FqYXgoJ2Zvby5qc29uJyksIHRpbWVvdXQoNTAwMCldKVxuICBgYGBcblxuICBAbWV0aG9kIHJhY2VcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FycmF5fSBwcm9taXNlcyBhcnJheSBvZiBwcm9taXNlcyB0byBvYnNlcnZlXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gYSBwcm9taXNlIHdoaWNoIHNldHRsZXMgaW4gdGhlIHNhbWUgd2F5IGFzIHRoZSBmaXJzdCBwYXNzZWRcbiAgcHJvbWlzZSB0byBzZXR0bGUuXG4qL1xuZnVuY3Rpb24gcmFjZShlbnRyaWVzKSB7XG4gIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG5cbiAgaWYgKCFpc0FycmF5KGVudHJpZXMpKSB7XG4gICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbiAoXywgcmVqZWN0KSB7XG4gICAgICByZXR1cm4gcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYW4gYXJyYXkgdG8gcmFjZS4nKSk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gZW50cmllcy5sZW5ndGg7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIENvbnN0cnVjdG9yLnJlc29sdmUoZW50cmllc1tpXSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICBgUHJvbWlzZS5yZWplY3RgIHJldHVybnMgYSBwcm9taXNlIHJlamVjdGVkIHdpdGggdGhlIHBhc3NlZCBgcmVhc29uYC5cbiAgSXQgaXMgc2hvcnRoYW5kIGZvciB0aGUgZm9sbG93aW5nOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHJlamVjdChuZXcgRXJyb3IoJ1dIT09QUycpKTtcbiAgfSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAvLyBDb2RlIGhlcmUgZG9lc24ndCBydW4gYmVjYXVzZSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCFcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ1dIT09QUydcbiAgfSk7XG4gIGBgYFxuXG4gIEluc3RlYWQgb2Ygd3JpdGluZyB0aGUgYWJvdmUsIHlvdXIgY29kZSBub3cgc2ltcGx5IGJlY29tZXMgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdXSE9PUFMnKSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAvLyBDb2RlIGhlcmUgZG9lc24ndCBydW4gYmVjYXVzZSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCFcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ1dIT09QUydcbiAgfSk7XG4gIGBgYFxuXG4gIEBtZXRob2QgcmVqZWN0XG4gIEBzdGF0aWNcbiAgQHBhcmFtIHtBbnl9IHJlYXNvbiB2YWx1ZSB0aGF0IHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aC5cbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2UgcmVqZWN0ZWQgd2l0aCB0aGUgZ2l2ZW4gYHJlYXNvbmAuXG4qL1xuZnVuY3Rpb24gcmVqZWN0JDEocmVhc29uKSB7XG4gIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKG5vb3ApO1xuICByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cbmZ1bmN0aW9uIG5lZWRzUmVzb2x2ZXIoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYSByZXNvbHZlciBmdW5jdGlvbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQgdG8gdGhlIHByb21pc2UgY29uc3RydWN0b3InKTtcbn1cblxuZnVuY3Rpb24gbmVlZHNOZXcoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJGYWlsZWQgdG8gY29uc3RydWN0ICdQcm9taXNlJzogUGxlYXNlIHVzZSB0aGUgJ25ldycgb3BlcmF0b3IsIHRoaXMgb2JqZWN0IGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBjYWxsZWQgYXMgYSBmdW5jdGlvbi5cIik7XG59XG5cbi8qKlxuICBQcm9taXNlIG9iamVjdHMgcmVwcmVzZW50IHRoZSBldmVudHVhbCByZXN1bHQgb2YgYW4gYXN5bmNocm9ub3VzIG9wZXJhdGlvbi4gVGhlXG4gIHByaW1hcnkgd2F5IG9mIGludGVyYWN0aW5nIHdpdGggYSBwcm9taXNlIGlzIHRocm91Z2ggaXRzIGB0aGVuYCBtZXRob2QsIHdoaWNoXG4gIHJlZ2lzdGVycyBjYWxsYmFja3MgdG8gcmVjZWl2ZSBlaXRoZXIgYSBwcm9taXNlJ3MgZXZlbnR1YWwgdmFsdWUgb3IgdGhlIHJlYXNvblxuICB3aHkgdGhlIHByb21pc2UgY2Fubm90IGJlIGZ1bGZpbGxlZC5cblxuICBUZXJtaW5vbG9neVxuICAtLS0tLS0tLS0tLVxuXG4gIC0gYHByb21pc2VgIGlzIGFuIG9iamVjdCBvciBmdW5jdGlvbiB3aXRoIGEgYHRoZW5gIG1ldGhvZCB3aG9zZSBiZWhhdmlvciBjb25mb3JtcyB0byB0aGlzIHNwZWNpZmljYXRpb24uXG4gIC0gYHRoZW5hYmxlYCBpcyBhbiBvYmplY3Qgb3IgZnVuY3Rpb24gdGhhdCBkZWZpbmVzIGEgYHRoZW5gIG1ldGhvZC5cbiAgLSBgdmFsdWVgIGlzIGFueSBsZWdhbCBKYXZhU2NyaXB0IHZhbHVlIChpbmNsdWRpbmcgdW5kZWZpbmVkLCBhIHRoZW5hYmxlLCBvciBhIHByb21pc2UpLlxuICAtIGBleGNlcHRpb25gIGlzIGEgdmFsdWUgdGhhdCBpcyB0aHJvd24gdXNpbmcgdGhlIHRocm93IHN0YXRlbWVudC5cbiAgLSBgcmVhc29uYCBpcyBhIHZhbHVlIHRoYXQgaW5kaWNhdGVzIHdoeSBhIHByb21pc2Ugd2FzIHJlamVjdGVkLlxuICAtIGBzZXR0bGVkYCB0aGUgZmluYWwgcmVzdGluZyBzdGF0ZSBvZiBhIHByb21pc2UsIGZ1bGZpbGxlZCBvciByZWplY3RlZC5cblxuICBBIHByb21pc2UgY2FuIGJlIGluIG9uZSBvZiB0aHJlZSBzdGF0ZXM6IHBlbmRpbmcsIGZ1bGZpbGxlZCwgb3IgcmVqZWN0ZWQuXG5cbiAgUHJvbWlzZXMgdGhhdCBhcmUgZnVsZmlsbGVkIGhhdmUgYSBmdWxmaWxsbWVudCB2YWx1ZSBhbmQgYXJlIGluIHRoZSBmdWxmaWxsZWRcbiAgc3RhdGUuICBQcm9taXNlcyB0aGF0IGFyZSByZWplY3RlZCBoYXZlIGEgcmVqZWN0aW9uIHJlYXNvbiBhbmQgYXJlIGluIHRoZVxuICByZWplY3RlZCBzdGF0ZS4gIEEgZnVsZmlsbG1lbnQgdmFsdWUgaXMgbmV2ZXIgYSB0aGVuYWJsZS5cblxuICBQcm9taXNlcyBjYW4gYWxzbyBiZSBzYWlkIHRvICpyZXNvbHZlKiBhIHZhbHVlLiAgSWYgdGhpcyB2YWx1ZSBpcyBhbHNvIGFcbiAgcHJvbWlzZSwgdGhlbiB0aGUgb3JpZ2luYWwgcHJvbWlzZSdzIHNldHRsZWQgc3RhdGUgd2lsbCBtYXRjaCB0aGUgdmFsdWUnc1xuICBzZXR0bGVkIHN0YXRlLiAgU28gYSBwcm9taXNlIHRoYXQgKnJlc29sdmVzKiBhIHByb21pc2UgdGhhdCByZWplY3RzIHdpbGxcbiAgaXRzZWxmIHJlamVjdCwgYW5kIGEgcHJvbWlzZSB0aGF0ICpyZXNvbHZlcyogYSBwcm9taXNlIHRoYXQgZnVsZmlsbHMgd2lsbFxuICBpdHNlbGYgZnVsZmlsbC5cblxuXG4gIEJhc2ljIFVzYWdlOlxuICAtLS0tLS0tLS0tLS1cblxuICBgYGBqc1xuICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIC8vIG9uIHN1Y2Nlc3NcbiAgICByZXNvbHZlKHZhbHVlKTtcblxuICAgIC8vIG9uIGZhaWx1cmVcbiAgICByZWplY3QocmVhc29uKTtcbiAgfSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgLy8gb24gZnVsZmlsbG1lbnRcbiAgfSwgZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgLy8gb24gcmVqZWN0aW9uXG4gIH0pO1xuICBgYGBcblxuICBBZHZhbmNlZCBVc2FnZTpcbiAgLS0tLS0tLS0tLS0tLS0tXG5cbiAgUHJvbWlzZXMgc2hpbmUgd2hlbiBhYnN0cmFjdGluZyBhd2F5IGFzeW5jaHJvbm91cyBpbnRlcmFjdGlvbnMgc3VjaCBhc1xuICBgWE1MSHR0cFJlcXVlc3Rgcy5cblxuICBgYGBqc1xuICBmdW5jdGlvbiBnZXRKU09OKHVybCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgICAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG4gICAgICB4aHIub3BlbignR0VUJywgdXJsKTtcbiAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBoYW5kbGVyO1xuICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJztcbiAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgeGhyLnNlbmQoKTtcblxuICAgICAgZnVuY3Rpb24gaGFuZGxlcigpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gdGhpcy5ET05FKSB7XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgIHJlc29sdmUodGhpcy5yZXNwb25zZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ2dldEpTT046IGAnICsgdXJsICsgJ2AgZmFpbGVkIHdpdGggc3RhdHVzOiBbJyArIHRoaXMuc3RhdHVzICsgJ10nKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0SlNPTignL3Bvc3RzLmpzb24nKS50aGVuKGZ1bmN0aW9uKGpzb24pIHtcbiAgICAvLyBvbiBmdWxmaWxsbWVudFxuICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAvLyBvbiByZWplY3Rpb25cbiAgfSk7XG4gIGBgYFxuXG4gIFVubGlrZSBjYWxsYmFja3MsIHByb21pc2VzIGFyZSBncmVhdCBjb21wb3NhYmxlIHByaW1pdGl2ZXMuXG5cbiAgYGBganNcbiAgUHJvbWlzZS5hbGwoW1xuICAgIGdldEpTT04oJy9wb3N0cycpLFxuICAgIGdldEpTT04oJy9jb21tZW50cycpXG4gIF0pLnRoZW4oZnVuY3Rpb24odmFsdWVzKXtcbiAgICB2YWx1ZXNbMF0gLy8gPT4gcG9zdHNKU09OXG4gICAgdmFsdWVzWzFdIC8vID0+IGNvbW1lbnRzSlNPTlxuXG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfSk7XG4gIGBgYFxuXG4gIEBjbGFzcyBQcm9taXNlXG4gIEBwYXJhbSB7RnVuY3Rpb259IHJlc29sdmVyXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQGNvbnN0cnVjdG9yXG4qL1xuXG52YXIgUHJvbWlzZSQxID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKSB7XG4gICAgdGhpc1tQUk9NSVNFX0lEXSA9IG5leHRJZCgpO1xuICAgIHRoaXMuX3Jlc3VsdCA9IHRoaXMuX3N0YXRlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3N1YnNjcmliZXJzID0gW107XG5cbiAgICBpZiAobm9vcCAhPT0gcmVzb2x2ZXIpIHtcbiAgICAgIHR5cGVvZiByZXNvbHZlciAhPT0gJ2Z1bmN0aW9uJyAmJiBuZWVkc1Jlc29sdmVyKCk7XG4gICAgICB0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSA/IGluaXRpYWxpemVQcm9taXNlKHRoaXMsIHJlc29sdmVyKSA6IG5lZWRzTmV3KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gIFRoZSBwcmltYXJ5IHdheSBvZiBpbnRlcmFjdGluZyB3aXRoIGEgcHJvbWlzZSBpcyB0aHJvdWdoIGl0cyBgdGhlbmAgbWV0aG9kLFxuICB3aGljaCByZWdpc3RlcnMgY2FsbGJhY2tzIHRvIHJlY2VpdmUgZWl0aGVyIGEgcHJvbWlzZSdzIGV2ZW50dWFsIHZhbHVlIG9yIHRoZVxuICByZWFzb24gd2h5IHRoZSBwcm9taXNlIGNhbm5vdCBiZSBmdWxmaWxsZWQuXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24odXNlcil7XG4gICAgLy8gdXNlciBpcyBhdmFpbGFibGVcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyB1c2VyIGlzIHVuYXZhaWxhYmxlLCBhbmQgeW91IGFyZSBnaXZlbiB0aGUgcmVhc29uIHdoeVxuICB9KTtcbiAgYGBgXG4gICBDaGFpbmluZ1xuICAtLS0tLS0tLVxuICAgVGhlIHJldHVybiB2YWx1ZSBvZiBgdGhlbmAgaXMgaXRzZWxmIGEgcHJvbWlzZS4gIFRoaXMgc2Vjb25kLCAnZG93bnN0cmVhbSdcbiAgcHJvbWlzZSBpcyByZXNvbHZlZCB3aXRoIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZpcnN0IHByb21pc2UncyBmdWxmaWxsbWVudFxuICBvciByZWplY3Rpb24gaGFuZGxlciwgb3IgcmVqZWN0ZWQgaWYgdGhlIGhhbmRsZXIgdGhyb3dzIGFuIGV4Y2VwdGlvbi5cbiAgIGBgYGpzXG4gIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHJldHVybiB1c2VyLm5hbWU7XG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICByZXR1cm4gJ2RlZmF1bHQgbmFtZSc7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKHVzZXJOYW1lKSB7XG4gICAgLy8gSWYgYGZpbmRVc2VyYCBmdWxmaWxsZWQsIGB1c2VyTmFtZWAgd2lsbCBiZSB0aGUgdXNlcidzIG5hbWUsIG90aGVyd2lzZSBpdFxuICAgIC8vIHdpbGwgYmUgYCdkZWZhdWx0IG5hbWUnYFxuICB9KTtcbiAgIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHRocm93IG5ldyBFcnJvcignRm91bmQgdXNlciwgYnV0IHN0aWxsIHVuaGFwcHknKTtcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIHRocm93IG5ldyBFcnJvcignYGZpbmRVc2VyYCByZWplY3RlZCBhbmQgd2UncmUgdW5oYXBweScpO1xuICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIC8vIGlmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgcmVhc29uYCB3aWxsIGJlICdGb3VuZCB1c2VyLCBidXQgc3RpbGwgdW5oYXBweScuXG4gICAgLy8gSWYgYGZpbmRVc2VyYCByZWplY3RlZCwgYHJlYXNvbmAgd2lsbCBiZSAnYGZpbmRVc2VyYCByZWplY3RlZCBhbmQgd2UncmUgdW5oYXBweScuXG4gIH0pO1xuICBgYGBcbiAgSWYgdGhlIGRvd25zdHJlYW0gcHJvbWlzZSBkb2VzIG5vdCBzcGVjaWZ5IGEgcmVqZWN0aW9uIGhhbmRsZXIsIHJlamVjdGlvbiByZWFzb25zIHdpbGwgYmUgcHJvcGFnYXRlZCBmdXJ0aGVyIGRvd25zdHJlYW0uXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICB0aHJvdyBuZXcgUGVkYWdvZ2ljYWxFeGNlcHRpb24oJ1Vwc3RyZWFtIGVycm9yJyk7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgLy8gbmV2ZXIgcmVhY2hlZFxuICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIC8vIFRoZSBgUGVkZ2Fnb2NpYWxFeGNlcHRpb25gIGlzIHByb3BhZ2F0ZWQgYWxsIHRoZSB3YXkgZG93biB0byBoZXJlXG4gIH0pO1xuICBgYGBcbiAgIEFzc2ltaWxhdGlvblxuICAtLS0tLS0tLS0tLS1cbiAgIFNvbWV0aW1lcyB0aGUgdmFsdWUgeW91IHdhbnQgdG8gcHJvcGFnYXRlIHRvIGEgZG93bnN0cmVhbSBwcm9taXNlIGNhbiBvbmx5IGJlXG4gIHJldHJpZXZlZCBhc3luY2hyb25vdXNseS4gVGhpcyBjYW4gYmUgYWNoaWV2ZWQgYnkgcmV0dXJuaW5nIGEgcHJvbWlzZSBpbiB0aGVcbiAgZnVsZmlsbG1lbnQgb3IgcmVqZWN0aW9uIGhhbmRsZXIuIFRoZSBkb3duc3RyZWFtIHByb21pc2Ugd2lsbCB0aGVuIGJlIHBlbmRpbmdcbiAgdW50aWwgdGhlIHJldHVybmVkIHByb21pc2UgaXMgc2V0dGxlZC4gVGhpcyBpcyBjYWxsZWQgKmFzc2ltaWxhdGlvbiouXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gZmluZENvbW1lbnRzQnlBdXRob3IodXNlcik7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKGNvbW1lbnRzKSB7XG4gICAgLy8gVGhlIHVzZXIncyBjb21tZW50cyBhcmUgbm93IGF2YWlsYWJsZVxuICB9KTtcbiAgYGBgXG4gICBJZiB0aGUgYXNzaW1saWF0ZWQgcHJvbWlzZSByZWplY3RzLCB0aGVuIHRoZSBkb3duc3RyZWFtIHByb21pc2Ugd2lsbCBhbHNvIHJlamVjdC5cbiAgIGBgYGpzXG4gIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHJldHVybiBmaW5kQ29tbWVudHNCeUF1dGhvcih1c2VyKTtcbiAgfSkudGhlbihmdW5jdGlvbiAoY29tbWVudHMpIHtcbiAgICAvLyBJZiBgZmluZENvbW1lbnRzQnlBdXRob3JgIGZ1bGZpbGxzLCB3ZSdsbCBoYXZlIHRoZSB2YWx1ZSBoZXJlXG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvLyBJZiBgZmluZENvbW1lbnRzQnlBdXRob3JgIHJlamVjdHMsIHdlJ2xsIGhhdmUgdGhlIHJlYXNvbiBoZXJlXG4gIH0pO1xuICBgYGBcbiAgIFNpbXBsZSBFeGFtcGxlXG4gIC0tLS0tLS0tLS0tLS0tXG4gICBTeW5jaHJvbm91cyBFeGFtcGxlXG4gICBgYGBqYXZhc2NyaXB0XG4gIGxldCByZXN1bHQ7XG4gICB0cnkge1xuICAgIHJlc3VsdCA9IGZpbmRSZXN1bHQoKTtcbiAgICAvLyBzdWNjZXNzXG4gIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgLy8gZmFpbHVyZVxuICB9XG4gIGBgYFxuICAgRXJyYmFjayBFeGFtcGxlXG4gICBgYGBqc1xuICBmaW5kUmVzdWx0KGZ1bmN0aW9uKHJlc3VsdCwgZXJyKXtcbiAgICBpZiAoZXJyKSB7XG4gICAgICAvLyBmYWlsdXJlXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIHN1Y2Nlc3NcbiAgICB9XG4gIH0pO1xuICBgYGBcbiAgIFByb21pc2UgRXhhbXBsZTtcbiAgIGBgYGphdmFzY3JpcHRcbiAgZmluZFJlc3VsdCgpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAvLyBzdWNjZXNzXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gZmFpbHVyZVxuICB9KTtcbiAgYGBgXG4gICBBZHZhbmNlZCBFeGFtcGxlXG4gIC0tLS0tLS0tLS0tLS0tXG4gICBTeW5jaHJvbm91cyBFeGFtcGxlXG4gICBgYGBqYXZhc2NyaXB0XG4gIGxldCBhdXRob3IsIGJvb2tzO1xuICAgdHJ5IHtcbiAgICBhdXRob3IgPSBmaW5kQXV0aG9yKCk7XG4gICAgYm9va3MgID0gZmluZEJvb2tzQnlBdXRob3IoYXV0aG9yKTtcbiAgICAvLyBzdWNjZXNzXG4gIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgLy8gZmFpbHVyZVxuICB9XG4gIGBgYFxuICAgRXJyYmFjayBFeGFtcGxlXG4gICBgYGBqc1xuICAgZnVuY3Rpb24gZm91bmRCb29rcyhib29rcykge1xuICAgfVxuICAgZnVuY3Rpb24gZmFpbHVyZShyZWFzb24pIHtcbiAgIH1cbiAgIGZpbmRBdXRob3IoZnVuY3Rpb24oYXV0aG9yLCBlcnIpe1xuICAgIGlmIChlcnIpIHtcbiAgICAgIGZhaWx1cmUoZXJyKTtcbiAgICAgIC8vIGZhaWx1cmVcbiAgICB9IGVsc2Uge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZmluZEJvb29rc0J5QXV0aG9yKGF1dGhvciwgZnVuY3Rpb24oYm9va3MsIGVycikge1xuICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgIGZhaWx1cmUoZXJyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgZm91bmRCb29rcyhib29rcyk7XG4gICAgICAgICAgICB9IGNhdGNoKHJlYXNvbikge1xuICAgICAgICAgICAgICBmYWlsdXJlKHJlYXNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2goZXJyb3IpIHtcbiAgICAgICAgZmFpbHVyZShlcnIpO1xuICAgICAgfVxuICAgICAgLy8gc3VjY2Vzc1xuICAgIH1cbiAgfSk7XG4gIGBgYFxuICAgUHJvbWlzZSBFeGFtcGxlO1xuICAgYGBgamF2YXNjcmlwdFxuICBmaW5kQXV0aG9yKCkuXG4gICAgdGhlbihmaW5kQm9va3NCeUF1dGhvcikuXG4gICAgdGhlbihmdW5jdGlvbihib29rcyl7XG4gICAgICAvLyBmb3VuZCBib29rc1xuICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gIH0pO1xuICBgYGBcbiAgIEBtZXRob2QgdGhlblxuICBAcGFyYW0ge0Z1bmN0aW9ufSBvbkZ1bGZpbGxlZFxuICBAcGFyYW0ge0Z1bmN0aW9ufSBvblJlamVjdGVkXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX1cbiAgKi9cblxuICAvKipcbiAgYGNhdGNoYCBpcyBzaW1wbHkgc3VnYXIgZm9yIGB0aGVuKHVuZGVmaW5lZCwgb25SZWplY3Rpb24pYCB3aGljaCBtYWtlcyBpdCB0aGUgc2FtZVxuICBhcyB0aGUgY2F0Y2ggYmxvY2sgb2YgYSB0cnkvY2F0Y2ggc3RhdGVtZW50LlxuICBgYGBqc1xuICBmdW5jdGlvbiBmaW5kQXV0aG9yKCl7XG4gIHRocm93IG5ldyBFcnJvcignY291bGRuJ3QgZmluZCB0aGF0IGF1dGhvcicpO1xuICB9XG4gIC8vIHN5bmNocm9ub3VzXG4gIHRyeSB7XG4gIGZpbmRBdXRob3IoKTtcbiAgfSBjYXRjaChyZWFzb24pIHtcbiAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmdcbiAgfVxuICAvLyBhc3luYyB3aXRoIHByb21pc2VzXG4gIGZpbmRBdXRob3IoKS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuICB9KTtcbiAgYGBgXG4gIEBtZXRob2QgY2F0Y2hcbiAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3Rpb25cbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfVxuICAqL1xuXG5cbiAgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2ggPSBmdW5jdGlvbiBfY2F0Y2gob25SZWplY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0aW9uKTtcbiAgfTtcblxuICAvKipcbiAgICBgZmluYWxseWAgd2lsbCBiZSBpbnZva2VkIHJlZ2FyZGxlc3Mgb2YgdGhlIHByb21pc2UncyBmYXRlIGp1c3QgYXMgbmF0aXZlXG4gICAgdHJ5L2NhdGNoL2ZpbmFsbHkgYmVoYXZlc1xuICBcbiAgICBTeW5jaHJvbm91cyBleGFtcGxlOlxuICBcbiAgICBgYGBqc1xuICAgIGZpbmRBdXRob3IoKSB7XG4gICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IDAuNSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXcgQXV0aG9yKCk7XG4gICAgfVxuICBcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGZpbmRBdXRob3IoKTsgLy8gc3VjY2VlZCBvciBmYWlsXG4gICAgfSBjYXRjaChlcnJvcikge1xuICAgICAgcmV0dXJuIGZpbmRPdGhlckF1dGhlcigpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBhbHdheXMgcnVuc1xuICAgICAgLy8gZG9lc24ndCBhZmZlY3QgdGhlIHJldHVybiB2YWx1ZVxuICAgIH1cbiAgICBgYGBcbiAgXG4gICAgQXN5bmNocm9ub3VzIGV4YW1wbGU6XG4gIFxuICAgIGBgYGpzXG4gICAgZmluZEF1dGhvcigpLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgICByZXR1cm4gZmluZE90aGVyQXV0aGVyKCk7XG4gICAgfSkuZmluYWxseShmdW5jdGlvbigpe1xuICAgICAgLy8gYXV0aG9yIHdhcyBlaXRoZXIgZm91bmQsIG9yIG5vdFxuICAgIH0pO1xuICAgIGBgYFxuICBcbiAgICBAbWV0aG9kIGZpbmFsbHlcbiAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICAgIEByZXR1cm4ge1Byb21pc2V9XG4gICovXG5cblxuICBQcm9taXNlLnByb3RvdHlwZS5maW5hbGx5ID0gZnVuY3Rpb24gX2ZpbmFsbHkoY2FsbGJhY2spIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XG4gICAgdmFyIGNvbnN0cnVjdG9yID0gcHJvbWlzZS5jb25zdHJ1Y3RvcjtcblxuICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfSk7XG4gICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRocm93IHJlYXNvbjtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBQcm9taXNlO1xufSgpO1xuXG5Qcm9taXNlJDEucHJvdG90eXBlLnRoZW4gPSB0aGVuO1xuUHJvbWlzZSQxLmFsbCA9IGFsbDtcblByb21pc2UkMS5yYWNlID0gcmFjZTtcblByb21pc2UkMS5yZXNvbHZlID0gcmVzb2x2ZSQxO1xuUHJvbWlzZSQxLnJlamVjdCA9IHJlamVjdCQxO1xuUHJvbWlzZSQxLl9zZXRTY2hlZHVsZXIgPSBzZXRTY2hlZHVsZXI7XG5Qcm9taXNlJDEuX3NldEFzYXAgPSBzZXRBc2FwO1xuUHJvbWlzZSQxLl9hc2FwID0gYXNhcDtcblxuLypnbG9iYWwgc2VsZiovXG5mdW5jdGlvbiBwb2x5ZmlsbCgpIHtcbiAgdmFyIGxvY2FsID0gdm9pZCAwO1xuXG4gIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxvY2FsID0gZ2xvYmFsO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxvY2FsID0gc2VsZjtcbiAgfSBlbHNlIHtcbiAgICB0cnkge1xuICAgICAgbG9jYWwgPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigncG9seWZpbGwgZmFpbGVkIGJlY2F1c2UgZ2xvYmFsIG9iamVjdCBpcyB1bmF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Jyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIFAgPSBsb2NhbC5Qcm9taXNlO1xuXG4gIGlmIChQKSB7XG4gICAgdmFyIHByb21pc2VUb1N0cmluZyA9IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIHByb21pc2VUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChQLnJlc29sdmUoKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gc2lsZW50bHkgaWdub3JlZFxuICAgIH1cblxuICAgIGlmIChwcm9taXNlVG9TdHJpbmcgPT09ICdbb2JqZWN0IFByb21pc2VdJyAmJiAhUC5jYXN0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgbG9jYWwuUHJvbWlzZSA9IFByb21pc2UkMTtcbn1cblxuLy8gU3RyYW5nZSBjb21wYXQuLlxuUHJvbWlzZSQxLnBvbHlmaWxsID0gcG9seWZpbGw7XG5Qcm9taXNlJDEuUHJvbWlzZSA9IFByb21pc2UkMTtcblxucmV0dXJuIFByb21pc2UkMTtcblxufSkpKTtcblxuXG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVzNi1wcm9taXNlLm1hcFxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2VzNi1wcm9taXNlL2Rpc3QvZXM2LXByb21pc2UuanNcbi8vIG1vZHVsZSBpZCA9IDEzOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wRGVmYXVsdCAoZXgpIHsgcmV0dXJuIChleCAmJiAodHlwZW9mIGV4ID09PSAnb2JqZWN0JykgJiYgJ2RlZmF1bHQnIGluIGV4KSA/IGV4WydkZWZhdWx0J10gOiBleDsgfVxuXG5yZXF1aXJlKCdAZmlyZWJhc2UvcG9seWZpbGwnKTtcbnZhciBmaXJlYmFzZSA9IF9pbnRlcm9wRGVmYXVsdChyZXF1aXJlKCdAZmlyZWJhc2UvYXBwJykpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmaXJlYmFzZTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9maXJlYmFzZS9hcHAvZGlzdC9pbmRleC5janMuanNcbi8vIG1vZHVsZSBpZCA9IDE0MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgJ0BmaXJlYmFzZS9maXJlc3RvcmUnO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9maXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5lc20uanNcbi8vIG1vZHVsZSBpZCA9IDE0MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgd2luO1xuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbiA9IHdpbmRvdztcbn0gZWxzZSBpZiAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbiA9IGdsb2JhbDtcbn0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIpe1xuICAgIHdpbiA9IHNlbGY7XG59IGVsc2Uge1xuICAgIHdpbiA9IHt9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHdpbjtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9nbG9iYWwvd2luZG93LmpzXG4vLyBtb2R1bGUgaWQgPSAxNDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBIZWxwZXJzLlxuICovXG5cbnZhciBzID0gMTAwMDtcbnZhciBtID0gcyAqIDYwO1xudmFyIGggPSBtICogNjA7XG52YXIgZCA9IGggKiAyNDtcbnZhciB5ID0gZCAqIDM2NS4yNTtcblxuLyoqXG4gKiBQYXJzZSBvciBmb3JtYXQgdGhlIGdpdmVuIGB2YWxgLlxuICpcbiAqIE9wdGlvbnM6XG4gKlxuICogIC0gYGxvbmdgIHZlcmJvc2UgZm9ybWF0dGluZyBbZmFsc2VdXG4gKlxuICogQHBhcmFtIHtTdHJpbmd8TnVtYmVyfSB2YWxcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cbiAqIEB0aHJvd3Mge0Vycm9yfSB0aHJvdyBhbiBlcnJvciBpZiB2YWwgaXMgbm90IGEgbm9uLWVtcHR5IHN0cmluZyBvciBhIG51bWJlclxuICogQHJldHVybiB7U3RyaW5nfE51bWJlcn1cbiAqIEBhcGkgcHVibGljXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih2YWwsIG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIHZhciB0eXBlID0gdHlwZW9mIHZhbDtcbiAgaWYgKHR5cGUgPT09ICdzdHJpbmcnICYmIHZhbC5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIHBhcnNlKHZhbCk7XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gJ251bWJlcicgJiYgaXNOYU4odmFsKSA9PT0gZmFsc2UpIHtcbiAgICByZXR1cm4gb3B0aW9ucy5sb25nID8gZm10TG9uZyh2YWwpIDogZm10U2hvcnQodmFsKTtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgJ3ZhbCBpcyBub3QgYSBub24tZW1wdHkgc3RyaW5nIG9yIGEgdmFsaWQgbnVtYmVyLiB2YWw9JyArXG4gICAgICBKU09OLnN0cmluZ2lmeSh2YWwpXG4gICk7XG59O1xuXG4vKipcbiAqIFBhcnNlIHRoZSBnaXZlbiBgc3RyYCBhbmQgcmV0dXJuIG1pbGxpc2Vjb25kcy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyXG4gKiBAcmV0dXJuIHtOdW1iZXJ9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBwYXJzZShzdHIpIHtcbiAgc3RyID0gU3RyaW5nKHN0cik7XG4gIGlmIChzdHIubGVuZ3RoID4gMTAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBtYXRjaCA9IC9eKCg/OlxcZCspP1xcLj9cXGQrKSAqKG1pbGxpc2Vjb25kcz98bXNlY3M/fG1zfHNlY29uZHM/fHNlY3M/fHN8bWludXRlcz98bWlucz98bXxob3Vycz98aHJzP3xofGRheXM/fGR8eWVhcnM/fHlycz98eSk/JC9pLmV4ZWMoXG4gICAgc3RyXG4gICk7XG4gIGlmICghbWF0Y2gpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIG4gPSBwYXJzZUZsb2F0KG1hdGNoWzFdKTtcbiAgdmFyIHR5cGUgPSAobWF0Y2hbMl0gfHwgJ21zJykudG9Mb3dlckNhc2UoKTtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAneWVhcnMnOlxuICAgIGNhc2UgJ3llYXInOlxuICAgIGNhc2UgJ3lycyc6XG4gICAgY2FzZSAneXInOlxuICAgIGNhc2UgJ3knOlxuICAgICAgcmV0dXJuIG4gKiB5O1xuICAgIGNhc2UgJ2RheXMnOlxuICAgIGNhc2UgJ2RheSc6XG4gICAgY2FzZSAnZCc6XG4gICAgICByZXR1cm4gbiAqIGQ7XG4gICAgY2FzZSAnaG91cnMnOlxuICAgIGNhc2UgJ2hvdXInOlxuICAgIGNhc2UgJ2hycyc6XG4gICAgY2FzZSAnaHInOlxuICAgIGNhc2UgJ2gnOlxuICAgICAgcmV0dXJuIG4gKiBoO1xuICAgIGNhc2UgJ21pbnV0ZXMnOlxuICAgIGNhc2UgJ21pbnV0ZSc6XG4gICAgY2FzZSAnbWlucyc6XG4gICAgY2FzZSAnbWluJzpcbiAgICBjYXNlICdtJzpcbiAgICAgIHJldHVybiBuICogbTtcbiAgICBjYXNlICdzZWNvbmRzJzpcbiAgICBjYXNlICdzZWNvbmQnOlxuICAgIGNhc2UgJ3NlY3MnOlxuICAgIGNhc2UgJ3NlYyc6XG4gICAgY2FzZSAncyc6XG4gICAgICByZXR1cm4gbiAqIHM7XG4gICAgY2FzZSAnbWlsbGlzZWNvbmRzJzpcbiAgICBjYXNlICdtaWxsaXNlY29uZCc6XG4gICAgY2FzZSAnbXNlY3MnOlxuICAgIGNhc2UgJ21zZWMnOlxuICAgIGNhc2UgJ21zJzpcbiAgICAgIHJldHVybiBuO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8qKlxuICogU2hvcnQgZm9ybWF0IGZvciBgbXNgLlxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBtc1xuICogQHJldHVybiB7U3RyaW5nfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gZm10U2hvcnQobXMpIHtcbiAgaWYgKG1zID49IGQpIHtcbiAgICByZXR1cm4gTWF0aC5yb3VuZChtcyAvIGQpICsgJ2QnO1xuICB9XG4gIGlmIChtcyA+PSBoKSB7XG4gICAgcmV0dXJuIE1hdGgucm91bmQobXMgLyBoKSArICdoJztcbiAgfVxuICBpZiAobXMgPj0gbSkge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gbSkgKyAnbSc7XG4gIH1cbiAgaWYgKG1zID49IHMpIHtcbiAgICByZXR1cm4gTWF0aC5yb3VuZChtcyAvIHMpICsgJ3MnO1xuICB9XG4gIHJldHVybiBtcyArICdtcyc7XG59XG5cbi8qKlxuICogTG9uZyBmb3JtYXQgZm9yIGBtc2AuXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IG1zXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBmbXRMb25nKG1zKSB7XG4gIHJldHVybiBwbHVyYWwobXMsIGQsICdkYXknKSB8fFxuICAgIHBsdXJhbChtcywgaCwgJ2hvdXInKSB8fFxuICAgIHBsdXJhbChtcywgbSwgJ21pbnV0ZScpIHx8XG4gICAgcGx1cmFsKG1zLCBzLCAnc2Vjb25kJykgfHxcbiAgICBtcyArICcgbXMnO1xufVxuXG4vKipcbiAqIFBsdXJhbGl6YXRpb24gaGVscGVyLlxuICovXG5cbmZ1bmN0aW9uIHBsdXJhbChtcywgbiwgbmFtZSkge1xuICBpZiAobXMgPCBuKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChtcyA8IG4gKiAxLjUpIHtcbiAgICByZXR1cm4gTWF0aC5mbG9vcihtcyAvIG4pICsgJyAnICsgbmFtZTtcbiAgfVxuICByZXR1cm4gTWF0aC5jZWlsKG1zIC8gbikgKyAnICcgKyBuYW1lICsgJ3MnO1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L21zL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAxNDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG4vLyBtb2RpZmllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9lcy1zaGltcy9lczUtc2hpbVxudmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xudmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xudmFyIGlzQXJncyA9IHJlcXVpcmUoJy4vaXNBcmd1bWVudHMnKTtcbnZhciBpc0VudW1lcmFibGUgPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIGhhc0RvbnRFbnVtQnVnID0gIWlzRW51bWVyYWJsZS5jYWxsKHsgdG9TdHJpbmc6IG51bGwgfSwgJ3RvU3RyaW5nJyk7XG52YXIgaGFzUHJvdG9FbnVtQnVnID0gaXNFbnVtZXJhYmxlLmNhbGwoZnVuY3Rpb24gKCkge30sICdwcm90b3R5cGUnKTtcbnZhciBkb250RW51bXMgPSBbXG5cdCd0b1N0cmluZycsXG5cdCd0b0xvY2FsZVN0cmluZycsXG5cdCd2YWx1ZU9mJyxcblx0J2hhc093blByb3BlcnR5Jyxcblx0J2lzUHJvdG90eXBlT2YnLFxuXHQncHJvcGVydHlJc0VudW1lcmFibGUnLFxuXHQnY29uc3RydWN0b3InXG5dO1xudmFyIGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlID0gZnVuY3Rpb24gKG8pIHtcblx0dmFyIGN0b3IgPSBvLmNvbnN0cnVjdG9yO1xuXHRyZXR1cm4gY3RvciAmJiBjdG9yLnByb3RvdHlwZSA9PT0gbztcbn07XG52YXIgZXhjbHVkZWRLZXlzID0ge1xuXHQkYXBwbGljYXRpb25DYWNoZTogdHJ1ZSxcblx0JGNvbnNvbGU6IHRydWUsXG5cdCRleHRlcm5hbDogdHJ1ZSxcblx0JGZyYW1lOiB0cnVlLFxuXHQkZnJhbWVFbGVtZW50OiB0cnVlLFxuXHQkZnJhbWVzOiB0cnVlLFxuXHQkaW5uZXJIZWlnaHQ6IHRydWUsXG5cdCRpbm5lcldpZHRoOiB0cnVlLFxuXHQkb3V0ZXJIZWlnaHQ6IHRydWUsXG5cdCRvdXRlcldpZHRoOiB0cnVlLFxuXHQkcGFnZVhPZmZzZXQ6IHRydWUsXG5cdCRwYWdlWU9mZnNldDogdHJ1ZSxcblx0JHBhcmVudDogdHJ1ZSxcblx0JHNjcm9sbExlZnQ6IHRydWUsXG5cdCRzY3JvbGxUb3A6IHRydWUsXG5cdCRzY3JvbGxYOiB0cnVlLFxuXHQkc2Nyb2xsWTogdHJ1ZSxcblx0JHNlbGY6IHRydWUsXG5cdCR3ZWJraXRJbmRleGVkREI6IHRydWUsXG5cdCR3ZWJraXRTdG9yYWdlSW5mbzogdHJ1ZSxcblx0JHdpbmRvdzogdHJ1ZVxufTtcbnZhciBoYXNBdXRvbWF0aW9uRXF1YWxpdHlCdWcgPSAoZnVuY3Rpb24gKCkge1xuXHQvKiBnbG9iYWwgd2luZG93ICovXG5cdGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykgeyByZXR1cm4gZmFsc2U7IH1cblx0Zm9yICh2YXIgayBpbiB3aW5kb3cpIHtcblx0XHR0cnkge1xuXHRcdFx0aWYgKCFleGNsdWRlZEtleXNbJyQnICsga10gJiYgaGFzLmNhbGwod2luZG93LCBrKSAmJiB3aW5kb3dba10gIT09IG51bGwgJiYgdHlwZW9mIHdpbmRvd1trXSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZSh3aW5kb3dba10pO1xuXHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIGZhbHNlO1xufSgpKTtcbnZhciBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZUlmTm90QnVnZ3kgPSBmdW5jdGlvbiAobykge1xuXHQvKiBnbG9iYWwgd2luZG93ICovXG5cdGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCAhaGFzQXV0b21hdGlvbkVxdWFsaXR5QnVnKSB7XG5cdFx0cmV0dXJuIGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlKG8pO1xuXHR9XG5cdHRyeSB7XG5cdFx0cmV0dXJuIGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlKG8pO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG52YXIga2V5c1NoaW0gPSBmdW5jdGlvbiBrZXlzKG9iamVjdCkge1xuXHR2YXIgaXNPYmplY3QgPSBvYmplY3QgIT09IG51bGwgJiYgdHlwZW9mIG9iamVjdCA9PT0gJ29iamVjdCc7XG5cdHZhciBpc0Z1bmN0aW9uID0gdG9TdHIuY2FsbChvYmplY3QpID09PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuXHR2YXIgaXNBcmd1bWVudHMgPSBpc0FyZ3Mob2JqZWN0KTtcblx0dmFyIGlzU3RyaW5nID0gaXNPYmplY3QgJiYgdG9TdHIuY2FsbChvYmplY3QpID09PSAnW29iamVjdCBTdHJpbmddJztcblx0dmFyIHRoZUtleXMgPSBbXTtcblxuXHRpZiAoIWlzT2JqZWN0ICYmICFpc0Z1bmN0aW9uICYmICFpc0FyZ3VtZW50cykge1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdC5rZXlzIGNhbGxlZCBvbiBhIG5vbi1vYmplY3QnKTtcblx0fVxuXG5cdHZhciBza2lwUHJvdG8gPSBoYXNQcm90b0VudW1CdWcgJiYgaXNGdW5jdGlvbjtcblx0aWYgKGlzU3RyaW5nICYmIG9iamVjdC5sZW5ndGggPiAwICYmICFoYXMuY2FsbChvYmplY3QsIDApKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBvYmplY3QubGVuZ3RoOyArK2kpIHtcblx0XHRcdHRoZUtleXMucHVzaChTdHJpbmcoaSkpO1xuXHRcdH1cblx0fVxuXG5cdGlmIChpc0FyZ3VtZW50cyAmJiBvYmplY3QubGVuZ3RoID4gMCkge1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgb2JqZWN0Lmxlbmd0aDsgKytqKSB7XG5cdFx0XHR0aGVLZXlzLnB1c2goU3RyaW5nKGopKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Zm9yICh2YXIgbmFtZSBpbiBvYmplY3QpIHtcblx0XHRcdGlmICghKHNraXBQcm90byAmJiBuYW1lID09PSAncHJvdG90eXBlJykgJiYgaGFzLmNhbGwob2JqZWN0LCBuYW1lKSkge1xuXHRcdFx0XHR0aGVLZXlzLnB1c2goU3RyaW5nKG5hbWUpKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpZiAoaGFzRG9udEVudW1CdWcpIHtcblx0XHR2YXIgc2tpcENvbnN0cnVjdG9yID0gZXF1YWxzQ29uc3RydWN0b3JQcm90b3R5cGVJZk5vdEJ1Z2d5KG9iamVjdCk7XG5cblx0XHRmb3IgKHZhciBrID0gMDsgayA8IGRvbnRFbnVtcy5sZW5ndGg7ICsraykge1xuXHRcdFx0aWYgKCEoc2tpcENvbnN0cnVjdG9yICYmIGRvbnRFbnVtc1trXSA9PT0gJ2NvbnN0cnVjdG9yJykgJiYgaGFzLmNhbGwob2JqZWN0LCBkb250RW51bXNba10pKSB7XG5cdFx0XHRcdHRoZUtleXMucHVzaChkb250RW51bXNba10pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRyZXR1cm4gdGhlS2V5cztcbn07XG5cbmtleXNTaGltLnNoaW0gPSBmdW5jdGlvbiBzaGltT2JqZWN0S2V5cygpIHtcblx0aWYgKE9iamVjdC5rZXlzKSB7XG5cdFx0dmFyIGtleXNXb3Jrc1dpdGhBcmd1bWVudHMgPSAoZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly8gU2FmYXJpIDUuMCBidWdcblx0XHRcdHJldHVybiAoT2JqZWN0LmtleXMoYXJndW1lbnRzKSB8fCAnJykubGVuZ3RoID09PSAyO1xuXHRcdH0oMSwgMikpO1xuXHRcdGlmICgha2V5c1dvcmtzV2l0aEFyZ3VtZW50cykge1xuXHRcdFx0dmFyIG9yaWdpbmFsS2V5cyA9IE9iamVjdC5rZXlzO1xuXHRcdFx0T2JqZWN0LmtleXMgPSBmdW5jdGlvbiBrZXlzKG9iamVjdCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGZ1bmMtbmFtZS1tYXRjaGluZ1xuXHRcdFx0XHRpZiAoaXNBcmdzKG9iamVjdCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gb3JpZ2luYWxLZXlzKHNsaWNlLmNhbGwob2JqZWN0KSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9yaWdpbmFsS2V5cyhvYmplY3QpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRPYmplY3Qua2V5cyA9IGtleXNTaGltO1xuXHR9XG5cdHJldHVybiBPYmplY3Qua2V5cyB8fCBrZXlzU2hpbTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ga2V5c1NoaW07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vb2JqZWN0LWtleXMvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDE0NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbnZhciB0b1N0ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaXNBcmd1bWVudHModmFsdWUpIHtcblx0dmFyIHN0ciA9IHRvU3RyLmNhbGwodmFsdWUpO1xuXHR2YXIgaXNBcmdzID0gc3RyID09PSAnW29iamVjdCBBcmd1bWVudHNdJztcblx0aWYgKCFpc0FyZ3MpIHtcblx0XHRpc0FyZ3MgPSBzdHIgIT09ICdbb2JqZWN0IEFycmF5XScgJiZcblx0XHRcdHZhbHVlICE9PSBudWxsICYmXG5cdFx0XHR0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmXG5cdFx0XHR0eXBlb2YgdmFsdWUubGVuZ3RoID09PSAnbnVtYmVyJyAmJlxuXHRcdFx0dmFsdWUubGVuZ3RoID49IDAgJiZcblx0XHRcdHRvU3RyLmNhbGwodmFsdWUuY2FsbGVlKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcblx0fVxuXHRyZXR1cm4gaXNBcmdzO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9vYmplY3Qta2V5cy9pc0FyZ3VtZW50cy5qc1xuLy8gbW9kdWxlIGlkID0gMTQ1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBzdHJpbmdpZnlQcmltaXRpdmUgPSBmdW5jdGlvbih2KSB7XG4gIHN3aXRjaCAodHlwZW9mIHYpIHtcbiAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgcmV0dXJuIHY7XG5cbiAgICBjYXNlICdib29sZWFuJzpcbiAgICAgIHJldHVybiB2ID8gJ3RydWUnIDogJ2ZhbHNlJztcblxuICAgIGNhc2UgJ251bWJlcic6XG4gICAgICByZXR1cm4gaXNGaW5pdGUodikgPyB2IDogJyc7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuICcnO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaiwgc2VwLCBlcSwgbmFtZSkge1xuICBzZXAgPSBzZXAgfHwgJyYnO1xuICBlcSA9IGVxIHx8ICc9JztcbiAgaWYgKG9iaiA9PT0gbnVsbCkge1xuICAgIG9iaiA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb2JqID09PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBtYXAob2JqZWN0S2V5cyhvYmopLCBmdW5jdGlvbihrKSB7XG4gICAgICB2YXIga3MgPSBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKGspKSArIGVxO1xuICAgICAgaWYgKGlzQXJyYXkob2JqW2tdKSkge1xuICAgICAgICByZXR1cm4gbWFwKG9ialtrXSwgZnVuY3Rpb24odikge1xuICAgICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUodikpO1xuICAgICAgICB9KS5qb2luKHNlcCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ga3MgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9ialtrXSkpO1xuICAgICAgfVxuICAgIH0pLmpvaW4oc2VwKTtcblxuICB9XG5cbiAgaWYgKCFuYW1lKSByZXR1cm4gJyc7XG4gIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG5hbWUpKSArIGVxICtcbiAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUob2JqKSk7XG59O1xuXG52YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKHhzKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeHMpID09PSAnW29iamVjdCBBcnJheV0nO1xufTtcblxuZnVuY3Rpb24gbWFwICh4cywgZikge1xuICBpZiAoeHMubWFwKSByZXR1cm4geHMubWFwKGYpO1xuICB2YXIgcmVzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgeHMubGVuZ3RoOyBpKyspIHtcbiAgICByZXMucHVzaChmKHhzW2ldLCBpKSk7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cblxudmFyIG9iamVjdEtleXMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiAob2JqKSB7XG4gIHZhciByZXMgPSBbXTtcbiAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSByZXMucHVzaChrZXkpO1xuICB9XG4gIHJldHVybiByZXM7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3F1ZXJ5c3RyaW5nLWVzMy9lbmNvZGUuanNcbi8vIG1vZHVsZSBpZCA9IDE0NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gKGdsb2JhbCwgdW5kZWZpbmVkKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpZiAoZ2xvYmFsLnNldEltbWVkaWF0ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG5leHRIYW5kbGUgPSAxOyAvLyBTcGVjIHNheXMgZ3JlYXRlciB0aGFuIHplcm9cbiAgICB2YXIgdGFza3NCeUhhbmRsZSA9IHt9O1xuICAgIHZhciBjdXJyZW50bHlSdW5uaW5nQVRhc2sgPSBmYWxzZTtcbiAgICB2YXIgZG9jID0gZ2xvYmFsLmRvY3VtZW50O1xuICAgIHZhciByZWdpc3RlckltbWVkaWF0ZTtcblxuICAgIGZ1bmN0aW9uIHNldEltbWVkaWF0ZShjYWxsYmFjaykge1xuICAgICAgLy8gQ2FsbGJhY2sgY2FuIGVpdGhlciBiZSBhIGZ1bmN0aW9uIG9yIGEgc3RyaW5nXG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgY2FsbGJhY2sgPSBuZXcgRnVuY3Rpb24oXCJcIiArIGNhbGxiYWNrKTtcbiAgICAgIH1cbiAgICAgIC8vIENvcHkgZnVuY3Rpb24gYXJndW1lbnRzXG4gICAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBhcmdzW2ldID0gYXJndW1lbnRzW2kgKyAxXTtcbiAgICAgIH1cbiAgICAgIC8vIFN0b3JlIGFuZCByZWdpc3RlciB0aGUgdGFza1xuICAgICAgdmFyIHRhc2sgPSB7IGNhbGxiYWNrOiBjYWxsYmFjaywgYXJnczogYXJncyB9O1xuICAgICAgdGFza3NCeUhhbmRsZVtuZXh0SGFuZGxlXSA9IHRhc2s7XG4gICAgICByZWdpc3RlckltbWVkaWF0ZShuZXh0SGFuZGxlKTtcbiAgICAgIHJldHVybiBuZXh0SGFuZGxlKys7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaGFuZGxlKSB7XG4gICAgICAgIGRlbGV0ZSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcnVuKHRhc2spIHtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGFzay5jYWxsYmFjaztcbiAgICAgICAgdmFyIGFyZ3MgPSB0YXNrLmFyZ3M7XG4gICAgICAgIHN3aXRjaCAoYXJncy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodW5kZWZpbmVkLCBhcmdzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcnVuSWZQcmVzZW50KGhhbmRsZSkge1xuICAgICAgICAvLyBGcm9tIHRoZSBzcGVjOiBcIldhaXQgdW50aWwgYW55IGludm9jYXRpb25zIG9mIHRoaXMgYWxnb3JpdGhtIHN0YXJ0ZWQgYmVmb3JlIHRoaXMgb25lIGhhdmUgY29tcGxldGVkLlwiXG4gICAgICAgIC8vIFNvIGlmIHdlJ3JlIGN1cnJlbnRseSBydW5uaW5nIGEgdGFzaywgd2UnbGwgbmVlZCB0byBkZWxheSB0aGlzIGludm9jYXRpb24uXG4gICAgICAgIGlmIChjdXJyZW50bHlSdW5uaW5nQVRhc2spIHtcbiAgICAgICAgICAgIC8vIERlbGF5IGJ5IGRvaW5nIGEgc2V0VGltZW91dC4gc2V0SW1tZWRpYXRlIHdhcyB0cmllZCBpbnN0ZWFkLCBidXQgaW4gRmlyZWZveCA3IGl0IGdlbmVyYXRlZCBhXG4gICAgICAgICAgICAvLyBcInRvbyBtdWNoIHJlY3Vyc2lvblwiIGVycm9yLlxuICAgICAgICAgICAgc2V0VGltZW91dChydW5JZlByZXNlbnQsIDAsIGhhbmRsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdGFzayA9IHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcbiAgICAgICAgICAgIGlmICh0YXNrKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudGx5UnVubmluZ0FUYXNrID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBydW4odGFzayk7XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbW1lZGlhdGUoaGFuZGxlKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zdGFsbE5leHRUaWNrSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsgcnVuSWZQcmVzZW50KGhhbmRsZSk7IH0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhblVzZVBvc3RNZXNzYWdlKCkge1xuICAgICAgICAvLyBUaGUgdGVzdCBhZ2FpbnN0IGBpbXBvcnRTY3JpcHRzYCBwcmV2ZW50cyB0aGlzIGltcGxlbWVudGF0aW9uIGZyb20gYmVpbmcgaW5zdGFsbGVkIGluc2lkZSBhIHdlYiB3b3JrZXIsXG4gICAgICAgIC8vIHdoZXJlIGBnbG9iYWwucG9zdE1lc3NhZ2VgIG1lYW5zIHNvbWV0aGluZyBjb21wbGV0ZWx5IGRpZmZlcmVudCBhbmQgY2FuJ3QgYmUgdXNlZCBmb3IgdGhpcyBwdXJwb3NlLlxuICAgICAgICBpZiAoZ2xvYmFsLnBvc3RNZXNzYWdlICYmICFnbG9iYWwuaW1wb3J0U2NyaXB0cykge1xuICAgICAgICAgICAgdmFyIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXMgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIG9sZE9uTWVzc2FnZSA9IGdsb2JhbC5vbm1lc3NhZ2U7XG4gICAgICAgICAgICBnbG9iYWwub25tZXNzYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcG9zdE1lc3NhZ2VJc0FzeW5jaHJvbm91cyA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShcIlwiLCBcIipcIik7XG4gICAgICAgICAgICBnbG9iYWwub25tZXNzYWdlID0gb2xkT25NZXNzYWdlO1xuICAgICAgICAgICAgcmV0dXJuIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpIHtcbiAgICAgICAgLy8gSW5zdGFsbHMgYW4gZXZlbnQgaGFuZGxlciBvbiBgZ2xvYmFsYCBmb3IgdGhlIGBtZXNzYWdlYCBldmVudDogc2VlXG4gICAgICAgIC8vICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vRE9NL3dpbmRvdy5wb3N0TWVzc2FnZVxuICAgICAgICAvLyAqIGh0dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdvcmsvbXVsdGlwYWdlL2NvbW1zLmh0bWwjY3Jvc3NEb2N1bWVudE1lc3NhZ2VzXG5cbiAgICAgICAgdmFyIG1lc3NhZ2VQcmVmaXggPSBcInNldEltbWVkaWF0ZSRcIiArIE1hdGgucmFuZG9tKCkgKyBcIiRcIjtcbiAgICAgICAgdmFyIG9uR2xvYmFsTWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlID09PSBnbG9iYWwgJiZcbiAgICAgICAgICAgICAgICB0eXBlb2YgZXZlbnQuZGF0YSA9PT0gXCJzdHJpbmdcIiAmJlxuICAgICAgICAgICAgICAgIGV2ZW50LmRhdGEuaW5kZXhPZihtZXNzYWdlUHJlZml4KSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJ1bklmUHJlc2VudCgrZXZlbnQuZGF0YS5zbGljZShtZXNzYWdlUHJlZml4Lmxlbmd0aCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG9uR2xvYmFsTWVzc2FnZSwgZmFsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2xvYmFsLmF0dGFjaEV2ZW50KFwib25tZXNzYWdlXCIsIG9uR2xvYmFsTWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKG1lc3NhZ2VQcmVmaXggKyBoYW5kbGUsIFwiKlwiKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsTWVzc2FnZUNoYW5uZWxJbXBsZW1lbnRhdGlvbigpIHtcbiAgICAgICAgdmFyIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTtcbiAgICAgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIGhhbmRsZSA9IGV2ZW50LmRhdGE7XG4gICAgICAgICAgICBydW5JZlByZXNlbnQoaGFuZGxlKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZShoYW5kbGUpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHZhciBodG1sID0gZG9jLmRvY3VtZW50RWxlbWVudDtcbiAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIDxzY3JpcHQ+IGVsZW1lbnQ7IGl0cyByZWFkeXN0YXRlY2hhbmdlIGV2ZW50IHdpbGwgYmUgZmlyZWQgYXN5bmNocm9ub3VzbHkgb25jZSBpdCBpcyBpbnNlcnRlZFxuICAgICAgICAgICAgLy8gaW50byB0aGUgZG9jdW1lbnQuIERvIHNvLCB0aHVzIHF1ZXVpbmcgdXAgdGhlIHRhc2suIFJlbWVtYmVyIHRvIGNsZWFuIHVwIG9uY2UgaXQncyBiZWVuIGNhbGxlZC5cbiAgICAgICAgICAgIHZhciBzY3JpcHQgPSBkb2MuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7XG4gICAgICAgICAgICAgICAgc2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaHRtbC5yZW1vdmVDaGlsZChzY3JpcHQpO1xuICAgICAgICAgICAgICAgIHNjcmlwdCA9IG51bGw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaHRtbC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbGxTZXRUaW1lb3V0SW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHJ1bklmUHJlc2VudCwgMCwgaGFuZGxlKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBJZiBzdXBwb3J0ZWQsIHdlIHNob3VsZCBhdHRhY2ggdG8gdGhlIHByb3RvdHlwZSBvZiBnbG9iYWwsIHNpbmNlIHRoYXQgaXMgd2hlcmUgc2V0VGltZW91dCBldCBhbC4gbGl2ZS5cbiAgICB2YXIgYXR0YWNoVG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgJiYgT2JqZWN0LmdldFByb3RvdHlwZU9mKGdsb2JhbCk7XG4gICAgYXR0YWNoVG8gPSBhdHRhY2hUbyAmJiBhdHRhY2hUby5zZXRUaW1lb3V0ID8gYXR0YWNoVG8gOiBnbG9iYWw7XG5cbiAgICAvLyBEb24ndCBnZXQgZm9vbGVkIGJ5IGUuZy4gYnJvd3NlcmlmeSBlbnZpcm9ubWVudHMuXG4gICAgaWYgKHt9LnRvU3RyaW5nLmNhbGwoZ2xvYmFsLnByb2Nlc3MpID09PSBcIltvYmplY3QgcHJvY2Vzc11cIikge1xuICAgICAgICAvLyBGb3IgTm9kZS5qcyBiZWZvcmUgMC45XG4gICAgICAgIGluc3RhbGxOZXh0VGlja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICB9IGVsc2UgaWYgKGNhblVzZVBvc3RNZXNzYWdlKCkpIHtcbiAgICAgICAgLy8gRm9yIG5vbi1JRTEwIG1vZGVybiBicm93c2Vyc1xuICAgICAgICBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgfSBlbHNlIGlmIChnbG9iYWwuTWVzc2FnZUNoYW5uZWwpIHtcbiAgICAgICAgLy8gRm9yIHdlYiB3b3JrZXJzLCB3aGVyZSBzdXBwb3J0ZWRcbiAgICAgICAgaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKTtcblxuICAgIH0gZWxzZSBpZiAoZG9jICYmIFwib25yZWFkeXN0YXRlY2hhbmdlXCIgaW4gZG9jLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIikpIHtcbiAgICAgICAgLy8gRm9yIElFIDbigJM4XG4gICAgICAgIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZvciBvbGRlciBicm93c2Vyc1xuICAgICAgICBpbnN0YWxsU2V0VGltZW91dEltcGxlbWVudGF0aW9uKCk7XG4gICAgfVxuXG4gICAgYXR0YWNoVG8uc2V0SW1tZWRpYXRlID0gc2V0SW1tZWRpYXRlO1xuICAgIGF0dGFjaFRvLmNsZWFySW1tZWRpYXRlID0gY2xlYXJJbW1lZGlhdGU7XG59KHR5cGVvZiBzZWxmID09PSBcInVuZGVmaW5lZFwiID8gdHlwZW9mIGdsb2JhbCA9PT0gXCJ1bmRlZmluZWRcIiA/IHRoaXMgOiBnbG9iYWwgOiBzZWxmKSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc2V0aW1tZWRpYXRlL3NldEltbWVkaWF0ZS5qc1xuLy8gbW9kdWxlIGlkID0gMTQ3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG5cbnZhciBzdHlsZXNJbkRvbSA9IHt9O1xuXG52YXJcdG1lbW9pemUgPSBmdW5jdGlvbiAoZm4pIHtcblx0dmFyIG1lbW87XG5cblx0cmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0XHRpZiAodHlwZW9mIG1lbW8gPT09IFwidW5kZWZpbmVkXCIpIG1lbW8gPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdHJldHVybiBtZW1vO1xuXHR9O1xufTtcblxudmFyIGlzT2xkSUUgPSBtZW1vaXplKGZ1bmN0aW9uICgpIHtcblx0Ly8gVGVzdCBmb3IgSUUgPD0gOSBhcyBwcm9wb3NlZCBieSBCcm93c2VyaGFja3Ncblx0Ly8gQHNlZSBodHRwOi8vYnJvd3NlcmhhY2tzLmNvbS8jaGFjay1lNzFkODY5MmY2NTMzNDE3M2ZlZTcxNWMyMjJjYjgwNVxuXHQvLyBUZXN0cyBmb3IgZXhpc3RlbmNlIG9mIHN0YW5kYXJkIGdsb2JhbHMgaXMgdG8gYWxsb3cgc3R5bGUtbG9hZGVyXG5cdC8vIHRvIG9wZXJhdGUgY29ycmVjdGx5IGludG8gbm9uLXN0YW5kYXJkIGVudmlyb25tZW50c1xuXHQvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJwYWNrLWNvbnRyaWIvc3R5bGUtbG9hZGVyL2lzc3Vlcy8xNzdcblx0cmV0dXJuIHdpbmRvdyAmJiBkb2N1bWVudCAmJiBkb2N1bWVudC5hbGwgJiYgIXdpbmRvdy5hdG9iO1xufSk7XG5cbnZhciBnZXRUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0LCBwYXJlbnQpIHtcbiAgaWYgKHBhcmVudCl7XG4gICAgcmV0dXJuIHBhcmVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7XG4gIH1cbiAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0KTtcbn07XG5cbnZhciBnZXRFbGVtZW50ID0gKGZ1bmN0aW9uIChmbikge1xuXHR2YXIgbWVtbyA9IHt9O1xuXG5cdHJldHVybiBmdW5jdGlvbih0YXJnZXQsIHBhcmVudCkge1xuICAgICAgICAgICAgICAgIC8vIElmIHBhc3NpbmcgZnVuY3Rpb24gaW4gb3B0aW9ucywgdGhlbiB1c2UgaXQgZm9yIHJlc29sdmUgXCJoZWFkXCIgZWxlbWVudC5cbiAgICAgICAgICAgICAgICAvLyBVc2VmdWwgZm9yIFNoYWRvdyBSb290IHN0eWxlIGkuZVxuICAgICAgICAgICAgICAgIC8vIHtcbiAgICAgICAgICAgICAgICAvLyAgIGluc2VydEludG86IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9vXCIpLnNoYWRvd1Jvb3QgfVxuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1lbW9bdGFyZ2V0XSA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0dmFyIHN0eWxlVGFyZ2V0ID0gZ2V0VGFyZ2V0LmNhbGwodGhpcywgdGFyZ2V0LCBwYXJlbnQpO1xuXHRcdFx0Ly8gU3BlY2lhbCBjYXNlIHRvIHJldHVybiBoZWFkIG9mIGlmcmFtZSBpbnN0ZWFkIG9mIGlmcmFtZSBpdHNlbGZcblx0XHRcdGlmICh3aW5kb3cuSFRNTElGcmFtZUVsZW1lbnQgJiYgc3R5bGVUYXJnZXQgaW5zdGFuY2VvZiB3aW5kb3cuSFRNTElGcmFtZUVsZW1lbnQpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHQvLyBUaGlzIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uIGlmIGFjY2VzcyB0byBpZnJhbWUgaXMgYmxvY2tlZFxuXHRcdFx0XHRcdC8vIGR1ZSB0byBjcm9zcy1vcmlnaW4gcmVzdHJpY3Rpb25zXG5cdFx0XHRcdFx0c3R5bGVUYXJnZXQgPSBzdHlsZVRhcmdldC5jb250ZW50RG9jdW1lbnQuaGVhZDtcblx0XHRcdFx0fSBjYXRjaChlKSB7XG5cdFx0XHRcdFx0c3R5bGVUYXJnZXQgPSBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRtZW1vW3RhcmdldF0gPSBzdHlsZVRhcmdldDtcblx0XHR9XG5cdFx0cmV0dXJuIG1lbW9bdGFyZ2V0XVxuXHR9O1xufSkoKTtcblxudmFyIHNpbmdsZXRvbiA9IG51bGw7XG52YXJcdHNpbmdsZXRvbkNvdW50ZXIgPSAwO1xudmFyXHRzdHlsZXNJbnNlcnRlZEF0VG9wID0gW107XG5cbnZhclx0Zml4VXJscyA9IHJlcXVpcmUoXCIuL3VybHNcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obGlzdCwgb3B0aW9ucykge1xuXHRpZiAodHlwZW9mIERFQlVHICE9PSBcInVuZGVmaW5lZFwiICYmIERFQlVHKSB7XG5cdFx0aWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50XCIpO1xuXHR9XG5cblx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cblx0b3B0aW9ucy5hdHRycyA9IHR5cGVvZiBvcHRpb25zLmF0dHJzID09PSBcIm9iamVjdFwiID8gb3B0aW9ucy5hdHRycyA6IHt9O1xuXG5cdC8vIEZvcmNlIHNpbmdsZS10YWcgc29sdXRpb24gb24gSUU2LTksIHdoaWNoIGhhcyBhIGhhcmQgbGltaXQgb24gdGhlICMgb2YgPHN0eWxlPlxuXHQvLyB0YWdzIGl0IHdpbGwgYWxsb3cgb24gYSBwYWdlXG5cdGlmICghb3B0aW9ucy5zaW5nbGV0b24gJiYgdHlwZW9mIG9wdGlvbnMuc2luZ2xldG9uICE9PSBcImJvb2xlYW5cIikgb3B0aW9ucy5zaW5nbGV0b24gPSBpc09sZElFKCk7XG5cblx0Ly8gQnkgZGVmYXVsdCwgYWRkIDxzdHlsZT4gdGFncyB0byB0aGUgPGhlYWQ+IGVsZW1lbnRcbiAgICAgICAgaWYgKCFvcHRpb25zLmluc2VydEludG8pIG9wdGlvbnMuaW5zZXJ0SW50byA9IFwiaGVhZFwiO1xuXG5cdC8vIEJ5IGRlZmF1bHQsIGFkZCA8c3R5bGU+IHRhZ3MgdG8gdGhlIGJvdHRvbSBvZiB0aGUgdGFyZ2V0XG5cdGlmICghb3B0aW9ucy5pbnNlcnRBdCkgb3B0aW9ucy5pbnNlcnRBdCA9IFwiYm90dG9tXCI7XG5cblx0dmFyIHN0eWxlcyA9IGxpc3RUb1N0eWxlcyhsaXN0LCBvcHRpb25zKTtcblxuXHRhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpO1xuXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGUgKG5ld0xpc3QpIHtcblx0XHR2YXIgbWF5UmVtb3ZlID0gW107XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcblxuXHRcdFx0ZG9tU3R5bGUucmVmcy0tO1xuXHRcdFx0bWF5UmVtb3ZlLnB1c2goZG9tU3R5bGUpO1xuXHRcdH1cblxuXHRcdGlmKG5ld0xpc3QpIHtcblx0XHRcdHZhciBuZXdTdHlsZXMgPSBsaXN0VG9TdHlsZXMobmV3TGlzdCwgb3B0aW9ucyk7XG5cdFx0XHRhZGRTdHlsZXNUb0RvbShuZXdTdHlsZXMsIG9wdGlvbnMpO1xuXHRcdH1cblxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbWF5UmVtb3ZlLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBtYXlSZW1vdmVbaV07XG5cblx0XHRcdGlmKGRvbVN0eWxlLnJlZnMgPT09IDApIHtcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKykgZG9tU3R5bGUucGFydHNbal0oKTtcblxuXHRcdFx0XHRkZWxldGUgc3R5bGVzSW5Eb21bZG9tU3R5bGUuaWRdO1xuXHRcdFx0fVxuXHRcdH1cblx0fTtcbn07XG5cbmZ1bmN0aW9uIGFkZFN0eWxlc1RvRG9tIChzdHlsZXMsIG9wdGlvbnMpIHtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgaXRlbSA9IHN0eWxlc1tpXTtcblx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcblxuXHRcdGlmKGRvbVN0eWxlKSB7XG5cdFx0XHRkb21TdHlsZS5yZWZzKys7XG5cblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRkb21TdHlsZS5wYXJ0c1tqXShpdGVtLnBhcnRzW2pdKTtcblx0XHRcdH1cblxuXHRcdFx0Zm9yKDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0ZG9tU3R5bGUucGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBwYXJ0cyA9IFtdO1xuXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRwYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcblx0XHRcdH1cblxuXHRcdFx0c3R5bGVzSW5Eb21baXRlbS5pZF0gPSB7aWQ6IGl0ZW0uaWQsIHJlZnM6IDEsIHBhcnRzOiBwYXJ0c307XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIGxpc3RUb1N0eWxlcyAobGlzdCwgb3B0aW9ucykge1xuXHR2YXIgc3R5bGVzID0gW107XG5cdHZhciBuZXdTdHlsZXMgPSB7fTtcblxuXHRmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgaXRlbSA9IGxpc3RbaV07XG5cdFx0dmFyIGlkID0gb3B0aW9ucy5iYXNlID8gaXRlbVswXSArIG9wdGlvbnMuYmFzZSA6IGl0ZW1bMF07XG5cdFx0dmFyIGNzcyA9IGl0ZW1bMV07XG5cdFx0dmFyIG1lZGlhID0gaXRlbVsyXTtcblx0XHR2YXIgc291cmNlTWFwID0gaXRlbVszXTtcblx0XHR2YXIgcGFydCA9IHtjc3M6IGNzcywgbWVkaWE6IG1lZGlhLCBzb3VyY2VNYXA6IHNvdXJjZU1hcH07XG5cblx0XHRpZighbmV3U3R5bGVzW2lkXSkgc3R5bGVzLnB1c2gobmV3U3R5bGVzW2lkXSA9IHtpZDogaWQsIHBhcnRzOiBbcGFydF19KTtcblx0XHRlbHNlIG5ld1N0eWxlc1tpZF0ucGFydHMucHVzaChwYXJ0KTtcblx0fVxuXG5cdHJldHVybiBzdHlsZXM7XG59XG5cbmZ1bmN0aW9uIGluc2VydFN0eWxlRWxlbWVudCAob3B0aW9ucywgc3R5bGUpIHtcblx0dmFyIHRhcmdldCA9IGdldEVsZW1lbnQob3B0aW9ucy5pbnNlcnRJbnRvKVxuXG5cdGlmICghdGFyZ2V0KSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiQ291bGRuJ3QgZmluZCBhIHN0eWxlIHRhcmdldC4gVGhpcyBwcm9iYWJseSBtZWFucyB0aGF0IHRoZSB2YWx1ZSBmb3IgdGhlICdpbnNlcnRJbnRvJyBwYXJhbWV0ZXIgaXMgaW52YWxpZC5cIik7XG5cdH1cblxuXHR2YXIgbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AgPSBzdHlsZXNJbnNlcnRlZEF0VG9wW3N0eWxlc0luc2VydGVkQXRUb3AubGVuZ3RoIC0gMV07XG5cblx0aWYgKG9wdGlvbnMuaW5zZXJ0QXQgPT09IFwidG9wXCIpIHtcblx0XHRpZiAoIWxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wKSB7XG5cdFx0XHR0YXJnZXQuaW5zZXJ0QmVmb3JlKHN0eWxlLCB0YXJnZXQuZmlyc3RDaGlsZCk7XG5cdFx0fSBlbHNlIGlmIChsYXN0U3R5bGVFbGVtZW50SW5zZXJ0ZWRBdFRvcC5uZXh0U2libGluZykge1xuXHRcdFx0dGFyZ2V0Lmluc2VydEJlZm9yZShzdHlsZSwgbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0YXJnZXQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuXHRcdH1cblx0XHRzdHlsZXNJbnNlcnRlZEF0VG9wLnB1c2goc3R5bGUpO1xuXHR9IGVsc2UgaWYgKG9wdGlvbnMuaW5zZXJ0QXQgPT09IFwiYm90dG9tXCIpIHtcblx0XHR0YXJnZXQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLmluc2VydEF0ID09PSBcIm9iamVjdFwiICYmIG9wdGlvbnMuaW5zZXJ0QXQuYmVmb3JlKSB7XG5cdFx0dmFyIG5leHRTaWJsaW5nID0gZ2V0RWxlbWVudChvcHRpb25zLmluc2VydEF0LmJlZm9yZSwgdGFyZ2V0KTtcblx0XHR0YXJnZXQuaW5zZXJ0QmVmb3JlKHN0eWxlLCBuZXh0U2libGluZyk7XG5cdH0gZWxzZSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiW1N0eWxlIExvYWRlcl1cXG5cXG4gSW52YWxpZCB2YWx1ZSBmb3IgcGFyYW1ldGVyICdpbnNlcnRBdCcgKCdvcHRpb25zLmluc2VydEF0JykgZm91bmQuXFxuIE11c3QgYmUgJ3RvcCcsICdib3R0b20nLCBvciBPYmplY3QuXFxuIChodHRwczovL2dpdGh1Yi5jb20vd2VicGFjay1jb250cmliL3N0eWxlLWxvYWRlciNpbnNlcnRhdClcXG5cIik7XG5cdH1cbn1cblxuZnVuY3Rpb24gcmVtb3ZlU3R5bGVFbGVtZW50IChzdHlsZSkge1xuXHRpZiAoc3R5bGUucGFyZW50Tm9kZSA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuXHRzdHlsZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlKTtcblxuXHR2YXIgaWR4ID0gc3R5bGVzSW5zZXJ0ZWRBdFRvcC5pbmRleE9mKHN0eWxlKTtcblx0aWYoaWR4ID49IDApIHtcblx0XHRzdHlsZXNJbnNlcnRlZEF0VG9wLnNwbGljZShpZHgsIDEpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVN0eWxlRWxlbWVudCAob3B0aW9ucykge1xuXHR2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG5cblx0aWYob3B0aW9ucy5hdHRycy50eXBlID09PSB1bmRlZmluZWQpIHtcblx0XHRvcHRpb25zLmF0dHJzLnR5cGUgPSBcInRleHQvY3NzXCI7XG5cdH1cblxuXHRpZihvcHRpb25zLmF0dHJzLm5vbmNlID09PSB1bmRlZmluZWQpIHtcblx0XHR2YXIgbm9uY2UgPSBnZXROb25jZSgpO1xuXHRcdGlmIChub25jZSkge1xuXHRcdFx0b3B0aW9ucy5hdHRycy5ub25jZSA9IG5vbmNlO1xuXHRcdH1cblx0fVxuXG5cdGFkZEF0dHJzKHN0eWxlLCBvcHRpb25zLmF0dHJzKTtcblx0aW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMsIHN0eWxlKTtcblxuXHRyZXR1cm4gc3R5bGU7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUxpbmtFbGVtZW50IChvcHRpb25zKSB7XG5cdHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XG5cblx0aWYob3B0aW9ucy5hdHRycy50eXBlID09PSB1bmRlZmluZWQpIHtcblx0XHRvcHRpb25zLmF0dHJzLnR5cGUgPSBcInRleHQvY3NzXCI7XG5cdH1cblx0b3B0aW9ucy5hdHRycy5yZWwgPSBcInN0eWxlc2hlZXRcIjtcblxuXHRhZGRBdHRycyhsaW5rLCBvcHRpb25zLmF0dHJzKTtcblx0aW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMsIGxpbmspO1xuXG5cdHJldHVybiBsaW5rO1xufVxuXG5mdW5jdGlvbiBhZGRBdHRycyAoZWwsIGF0dHJzKSB7XG5cdE9iamVjdC5rZXlzKGF0dHJzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcblx0XHRlbC5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyc1trZXldKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGdldE5vbmNlKCkge1xuXHRpZiAodHlwZW9mIF9fd2VicGFja19ub25jZV9fID09PSAndW5kZWZpbmVkJykge1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0cmV0dXJuIF9fd2VicGFja19ub25jZV9fO1xufVxuXG5mdW5jdGlvbiBhZGRTdHlsZSAob2JqLCBvcHRpb25zKSB7XG5cdHZhciBzdHlsZSwgdXBkYXRlLCByZW1vdmUsIHJlc3VsdDtcblxuXHQvLyBJZiBhIHRyYW5zZm9ybSBmdW5jdGlvbiB3YXMgZGVmaW5lZCwgcnVuIGl0IG9uIHRoZSBjc3Ncblx0aWYgKG9wdGlvbnMudHJhbnNmb3JtICYmIG9iai5jc3MpIHtcblx0ICAgIHJlc3VsdCA9IHR5cGVvZiBvcHRpb25zLnRyYW5zZm9ybSA9PT0gJ2Z1bmN0aW9uJ1xuXHRcdCA/IG9wdGlvbnMudHJhbnNmb3JtKG9iai5jc3MpIFxuXHRcdCA6IG9wdGlvbnMudHJhbnNmb3JtLmRlZmF1bHQob2JqLmNzcyk7XG5cblx0ICAgIGlmIChyZXN1bHQpIHtcblx0ICAgIFx0Ly8gSWYgdHJhbnNmb3JtIHJldHVybnMgYSB2YWx1ZSwgdXNlIHRoYXQgaW5zdGVhZCBvZiB0aGUgb3JpZ2luYWwgY3NzLlxuXHQgICAgXHQvLyBUaGlzIGFsbG93cyBydW5uaW5nIHJ1bnRpbWUgdHJhbnNmb3JtYXRpb25zIG9uIHRoZSBjc3MuXG5cdCAgICBcdG9iai5jc3MgPSByZXN1bHQ7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgXHQvLyBJZiB0aGUgdHJhbnNmb3JtIGZ1bmN0aW9uIHJldHVybnMgYSBmYWxzeSB2YWx1ZSwgZG9uJ3QgYWRkIHRoaXMgY3NzLlxuXHQgICAgXHQvLyBUaGlzIGFsbG93cyBjb25kaXRpb25hbCBsb2FkaW5nIG9mIGNzc1xuXHQgICAgXHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdCAgICBcdFx0Ly8gbm9vcFxuXHQgICAgXHR9O1xuXHQgICAgfVxuXHR9XG5cblx0aWYgKG9wdGlvbnMuc2luZ2xldG9uKSB7XG5cdFx0dmFyIHN0eWxlSW5kZXggPSBzaW5nbGV0b25Db3VudGVyKys7XG5cblx0XHRzdHlsZSA9IHNpbmdsZXRvbiB8fCAoc2luZ2xldG9uID0gY3JlYXRlU3R5bGVFbGVtZW50KG9wdGlvbnMpKTtcblxuXHRcdHVwZGF0ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZSwgc3R5bGVJbmRleCwgZmFsc2UpO1xuXHRcdHJlbW92ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZSwgc3R5bGVJbmRleCwgdHJ1ZSk7XG5cblx0fSBlbHNlIGlmIChcblx0XHRvYmouc291cmNlTWFwICYmXG5cdFx0dHlwZW9mIFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXG5cdFx0dHlwZW9mIFVSTC5jcmVhdGVPYmplY3RVUkwgPT09IFwiZnVuY3Rpb25cIiAmJlxuXHRcdHR5cGVvZiBVUkwucmV2b2tlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcblx0XHR0eXBlb2YgQmxvYiA9PT0gXCJmdW5jdGlvblwiICYmXG5cdFx0dHlwZW9mIGJ0b2EgPT09IFwiZnVuY3Rpb25cIlxuXHQpIHtcblx0XHRzdHlsZSA9IGNyZWF0ZUxpbmtFbGVtZW50KG9wdGlvbnMpO1xuXHRcdHVwZGF0ZSA9IHVwZGF0ZUxpbmsuYmluZChudWxsLCBzdHlsZSwgb3B0aW9ucyk7XG5cdFx0cmVtb3ZlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0cmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlKTtcblxuXHRcdFx0aWYoc3R5bGUuaHJlZikgVVJMLnJldm9rZU9iamVjdFVSTChzdHlsZS5ocmVmKTtcblx0XHR9O1xuXHR9IGVsc2Uge1xuXHRcdHN0eWxlID0gY3JlYXRlU3R5bGVFbGVtZW50KG9wdGlvbnMpO1xuXHRcdHVwZGF0ZSA9IGFwcGx5VG9UYWcuYmluZChudWxsLCBzdHlsZSk7XG5cdFx0cmVtb3ZlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0cmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlKTtcblx0XHR9O1xuXHR9XG5cblx0dXBkYXRlKG9iaik7XG5cblx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZVN0eWxlIChuZXdPYmopIHtcblx0XHRpZiAobmV3T2JqKSB7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdG5ld09iai5jc3MgPT09IG9iai5jc3MgJiZcblx0XHRcdFx0bmV3T2JqLm1lZGlhID09PSBvYmoubWVkaWEgJiZcblx0XHRcdFx0bmV3T2JqLnNvdXJjZU1hcCA9PT0gb2JqLnNvdXJjZU1hcFxuXHRcdFx0KSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0dXBkYXRlKG9iaiA9IG5ld09iaik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlbW92ZSgpO1xuXHRcdH1cblx0fTtcbn1cblxudmFyIHJlcGxhY2VUZXh0ID0gKGZ1bmN0aW9uICgpIHtcblx0dmFyIHRleHRTdG9yZSA9IFtdO1xuXG5cdHJldHVybiBmdW5jdGlvbiAoaW5kZXgsIHJlcGxhY2VtZW50KSB7XG5cdFx0dGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xuXG5cdFx0cmV0dXJuIHRleHRTdG9yZS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XG5cdH07XG59KSgpO1xuXG5mdW5jdGlvbiBhcHBseVRvU2luZ2xldG9uVGFnIChzdHlsZSwgaW5kZXgsIHJlbW92ZSwgb2JqKSB7XG5cdHZhciBjc3MgPSByZW1vdmUgPyBcIlwiIDogb2JqLmNzcztcblxuXHRpZiAoc3R5bGUuc3R5bGVTaGVldCkge1xuXHRcdHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xuXHR9IGVsc2Uge1xuXHRcdHZhciBjc3NOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKTtcblx0XHR2YXIgY2hpbGROb2RlcyA9IHN0eWxlLmNoaWxkTm9kZXM7XG5cblx0XHRpZiAoY2hpbGROb2Rlc1tpbmRleF0pIHN0eWxlLnJlbW92ZUNoaWxkKGNoaWxkTm9kZXNbaW5kZXhdKTtcblxuXHRcdGlmIChjaGlsZE5vZGVzLmxlbmd0aCkge1xuXHRcdFx0c3R5bGUuaW5zZXJ0QmVmb3JlKGNzc05vZGUsIGNoaWxkTm9kZXNbaW5kZXhdKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3R5bGUuYXBwZW5kQ2hpbGQoY3NzTm9kZSk7XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIGFwcGx5VG9UYWcgKHN0eWxlLCBvYmopIHtcblx0dmFyIGNzcyA9IG9iai5jc3M7XG5cdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcblxuXHRpZihtZWRpYSkge1xuXHRcdHN0eWxlLnNldEF0dHJpYnV0ZShcIm1lZGlhXCIsIG1lZGlhKVxuXHR9XG5cblx0aWYoc3R5bGUuc3R5bGVTaGVldCkge1xuXHRcdHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzcztcblx0fSBlbHNlIHtcblx0XHR3aGlsZShzdHlsZS5maXJzdENoaWxkKSB7XG5cdFx0XHRzdHlsZS5yZW1vdmVDaGlsZChzdHlsZS5maXJzdENoaWxkKTtcblx0XHR9XG5cblx0XHRzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcblx0fVxufVxuXG5mdW5jdGlvbiB1cGRhdGVMaW5rIChsaW5rLCBvcHRpb25zLCBvYmopIHtcblx0dmFyIGNzcyA9IG9iai5jc3M7XG5cdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xuXG5cdC8qXG5cdFx0SWYgY29udmVydFRvQWJzb2x1dGVVcmxzIGlzbid0IGRlZmluZWQsIGJ1dCBzb3VyY2VtYXBzIGFyZSBlbmFibGVkXG5cdFx0YW5kIHRoZXJlIGlzIG5vIHB1YmxpY1BhdGggZGVmaW5lZCB0aGVuIGxldHMgdHVybiBjb252ZXJ0VG9BYnNvbHV0ZVVybHNcblx0XHRvbiBieSBkZWZhdWx0LiAgT3RoZXJ3aXNlIGRlZmF1bHQgdG8gdGhlIGNvbnZlcnRUb0Fic29sdXRlVXJscyBvcHRpb25cblx0XHRkaXJlY3RseVxuXHQqL1xuXHR2YXIgYXV0b0ZpeFVybHMgPSBvcHRpb25zLmNvbnZlcnRUb0Fic29sdXRlVXJscyA9PT0gdW5kZWZpbmVkICYmIHNvdXJjZU1hcDtcblxuXHRpZiAob3B0aW9ucy5jb252ZXJ0VG9BYnNvbHV0ZVVybHMgfHwgYXV0b0ZpeFVybHMpIHtcblx0XHRjc3MgPSBmaXhVcmxzKGNzcyk7XG5cdH1cblxuXHRpZiAoc291cmNlTWFwKSB7XG5cdFx0Ly8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjY2MDM4NzVcblx0XHRjc3MgKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSArIFwiICovXCI7XG5cdH1cblxuXHR2YXIgYmxvYiA9IG5ldyBCbG9iKFtjc3NdLCB7IHR5cGU6IFwidGV4dC9jc3NcIiB9KTtcblxuXHR2YXIgb2xkU3JjID0gbGluay5ocmVmO1xuXG5cdGxpbmsuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG5cblx0aWYob2xkU3JjKSBVUkwucmV2b2tlT2JqZWN0VVJMKG9sZFNyYyk7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc3R5bGUtbG9hZGVyL2xpYi9hZGRTdHlsZXMuanNcbi8vIG1vZHVsZSBpZCA9IDE0OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJcbi8qKlxuICogV2hlbiBzb3VyY2UgbWFwcyBhcmUgZW5hYmxlZCwgYHN0eWxlLWxvYWRlcmAgdXNlcyBhIGxpbmsgZWxlbWVudCB3aXRoIGEgZGF0YS11cmkgdG9cbiAqIGVtYmVkIHRoZSBjc3Mgb24gdGhlIHBhZ2UuIFRoaXMgYnJlYWtzIGFsbCByZWxhdGl2ZSB1cmxzIGJlY2F1c2Ugbm93IHRoZXkgYXJlIHJlbGF0aXZlIHRvIGFcbiAqIGJ1bmRsZSBpbnN0ZWFkIG9mIHRoZSBjdXJyZW50IHBhZ2UuXG4gKlxuICogT25lIHNvbHV0aW9uIGlzIHRvIG9ubHkgdXNlIGZ1bGwgdXJscywgYnV0IHRoYXQgbWF5IGJlIGltcG9zc2libGUuXG4gKlxuICogSW5zdGVhZCwgdGhpcyBmdW5jdGlvbiBcImZpeGVzXCIgdGhlIHJlbGF0aXZlIHVybHMgdG8gYmUgYWJzb2x1dGUgYWNjb3JkaW5nIHRvIHRoZSBjdXJyZW50IHBhZ2UgbG9jYXRpb24uXG4gKlxuICogQSBydWRpbWVudGFyeSB0ZXN0IHN1aXRlIGlzIGxvY2F0ZWQgYXQgYHRlc3QvZml4VXJscy5qc2AgYW5kIGNhbiBiZSBydW4gdmlhIHRoZSBgbnBtIHRlc3RgIGNvbW1hbmQuXG4gKlxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGNzcykge1xuICAvLyBnZXQgY3VycmVudCBsb2NhdGlvblxuICB2YXIgbG9jYXRpb24gPSB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5sb2NhdGlvbjtcblxuICBpZiAoIWxvY2F0aW9uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiZml4VXJscyByZXF1aXJlcyB3aW5kb3cubG9jYXRpb25cIik7XG4gIH1cblxuXHQvLyBibGFuayBvciBudWxsP1xuXHRpZiAoIWNzcyB8fCB0eXBlb2YgY3NzICE9PSBcInN0cmluZ1wiKSB7XG5cdCAgcmV0dXJuIGNzcztcbiAgfVxuXG4gIHZhciBiYXNlVXJsID0gbG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyBsb2NhdGlvbi5ob3N0O1xuICB2YXIgY3VycmVudERpciA9IGJhc2VVcmwgKyBsb2NhdGlvbi5wYXRobmFtZS5yZXBsYWNlKC9cXC9bXlxcL10qJC8sIFwiL1wiKTtcblxuXHQvLyBjb252ZXJ0IGVhY2ggdXJsKC4uLilcblx0Lypcblx0VGhpcyByZWd1bGFyIGV4cHJlc3Npb24gaXMganVzdCBhIHdheSB0byByZWN1cnNpdmVseSBtYXRjaCBicmFja2V0cyB3aXRoaW5cblx0YSBzdHJpbmcuXG5cblx0IC91cmxcXHMqXFwoICA9IE1hdGNoIG9uIHRoZSB3b3JkIFwidXJsXCIgd2l0aCBhbnkgd2hpdGVzcGFjZSBhZnRlciBpdCBhbmQgdGhlbiBhIHBhcmVuc1xuXHQgICAoICA9IFN0YXJ0IGEgY2FwdHVyaW5nIGdyb3VwXG5cdCAgICAgKD86ICA9IFN0YXJ0IGEgbm9uLWNhcHR1cmluZyBncm91cFxuXHQgICAgICAgICBbXikoXSAgPSBNYXRjaCBhbnl0aGluZyB0aGF0IGlzbid0IGEgcGFyZW50aGVzZXNcblx0ICAgICAgICAgfCAgPSBPUlxuXHQgICAgICAgICBcXCggID0gTWF0Y2ggYSBzdGFydCBwYXJlbnRoZXNlc1xuXHQgICAgICAgICAgICAgKD86ICA9IFN0YXJ0IGFub3RoZXIgbm9uLWNhcHR1cmluZyBncm91cHNcblx0ICAgICAgICAgICAgICAgICBbXikoXSsgID0gTWF0Y2ggYW55dGhpbmcgdGhhdCBpc24ndCBhIHBhcmVudGhlc2VzXG5cdCAgICAgICAgICAgICAgICAgfCAgPSBPUlxuXHQgICAgICAgICAgICAgICAgIFxcKCAgPSBNYXRjaCBhIHN0YXJ0IHBhcmVudGhlc2VzXG5cdCAgICAgICAgICAgICAgICAgICAgIFteKShdKiAgPSBNYXRjaCBhbnl0aGluZyB0aGF0IGlzbid0IGEgcGFyZW50aGVzZXNcblx0ICAgICAgICAgICAgICAgICBcXCkgID0gTWF0Y2ggYSBlbmQgcGFyZW50aGVzZXNcblx0ICAgICAgICAgICAgICkgID0gRW5kIEdyb3VwXG4gICAgICAgICAgICAgICpcXCkgPSBNYXRjaCBhbnl0aGluZyBhbmQgdGhlbiBhIGNsb3NlIHBhcmVuc1xuICAgICAgICAgICkgID0gQ2xvc2Ugbm9uLWNhcHR1cmluZyBncm91cFxuICAgICAgICAgICogID0gTWF0Y2ggYW55dGhpbmdcbiAgICAgICApICA9IENsb3NlIGNhcHR1cmluZyBncm91cFxuXHQgXFwpICA9IE1hdGNoIGEgY2xvc2UgcGFyZW5zXG5cblx0IC9naSAgPSBHZXQgYWxsIG1hdGNoZXMsIG5vdCB0aGUgZmlyc3QuICBCZSBjYXNlIGluc2Vuc2l0aXZlLlxuXHQgKi9cblx0dmFyIGZpeGVkQ3NzID0gY3NzLnJlcGxhY2UoL3VybFxccypcXCgoKD86W14pKF18XFwoKD86W14pKF0rfFxcKFteKShdKlxcKSkqXFwpKSopXFwpL2dpLCBmdW5jdGlvbihmdWxsTWF0Y2gsIG9yaWdVcmwpIHtcblx0XHQvLyBzdHJpcCBxdW90ZXMgKGlmIHRoZXkgZXhpc3QpXG5cdFx0dmFyIHVucXVvdGVkT3JpZ1VybCA9IG9yaWdVcmxcblx0XHRcdC50cmltKClcblx0XHRcdC5yZXBsYWNlKC9eXCIoLiopXCIkLywgZnVuY3Rpb24obywgJDEpeyByZXR1cm4gJDE7IH0pXG5cdFx0XHQucmVwbGFjZSgvXicoLiopJyQvLCBmdW5jdGlvbihvLCAkMSl7IHJldHVybiAkMTsgfSk7XG5cblx0XHQvLyBhbHJlYWR5IGEgZnVsbCB1cmw/IG5vIGNoYW5nZVxuXHRcdGlmICgvXigjfGRhdGE6fGh0dHA6XFwvXFwvfGh0dHBzOlxcL1xcL3xmaWxlOlxcL1xcL1xcL3xcXHMqJCkvaS50ZXN0KHVucXVvdGVkT3JpZ1VybCkpIHtcblx0XHQgIHJldHVybiBmdWxsTWF0Y2g7XG5cdFx0fVxuXG5cdFx0Ly8gY29udmVydCB0aGUgdXJsIHRvIGEgZnVsbCB1cmxcblx0XHR2YXIgbmV3VXJsO1xuXG5cdFx0aWYgKHVucXVvdGVkT3JpZ1VybC5pbmRleE9mKFwiLy9cIikgPT09IDApIHtcblx0XHQgIFx0Ly9UT0RPOiBzaG91bGQgd2UgYWRkIHByb3RvY29sP1xuXHRcdFx0bmV3VXJsID0gdW5xdW90ZWRPcmlnVXJsO1xuXHRcdH0gZWxzZSBpZiAodW5xdW90ZWRPcmlnVXJsLmluZGV4T2YoXCIvXCIpID09PSAwKSB7XG5cdFx0XHQvLyBwYXRoIHNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYmFzZSB1cmxcblx0XHRcdG5ld1VybCA9IGJhc2VVcmwgKyB1bnF1b3RlZE9yaWdVcmw7IC8vIGFscmVhZHkgc3RhcnRzIHdpdGggJy8nXG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIHBhdGggc2hvdWxkIGJlIHJlbGF0aXZlIHRvIGN1cnJlbnQgZGlyZWN0b3J5XG5cdFx0XHRuZXdVcmwgPSBjdXJyZW50RGlyICsgdW5xdW90ZWRPcmlnVXJsLnJlcGxhY2UoL15cXC5cXC8vLCBcIlwiKTsgLy8gU3RyaXAgbGVhZGluZyAnLi8nXG5cdFx0fVxuXG5cdFx0Ly8gc2VuZCBiYWNrIHRoZSBmaXhlZCB1cmwoLi4uKVxuXHRcdHJldHVybiBcInVybChcIiArIEpTT04uc3RyaW5naWZ5KG5ld1VybCkgKyBcIilcIjtcblx0fSk7XG5cblx0Ly8gc2VuZCBiYWNrIHRoZSBmaXhlZCBjc3Ncblx0cmV0dXJuIGZpeGVkQ3NzO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9zdHlsZS1sb2FkZXIvbGliL3VybHMuanNcbi8vIG1vZHVsZSBpZCA9IDE0OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgc2NvcGUgPSAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBnbG9iYWwpIHx8XG4gICAgICAgICAgICAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgJiYgc2VsZikgfHxcbiAgICAgICAgICAgIHdpbmRvdztcbnZhciBhcHBseSA9IEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseTtcblxuLy8gRE9NIEFQSXMsIGZvciBjb21wbGV0ZW5lc3NcblxuZXhwb3J0cy5zZXRUaW1lb3V0ID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgVGltZW91dChhcHBseS5jYWxsKHNldFRpbWVvdXQsIHNjb3BlLCBhcmd1bWVudHMpLCBjbGVhclRpbWVvdXQpO1xufTtcbmV4cG9ydHMuc2V0SW50ZXJ2YWwgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBUaW1lb3V0KGFwcGx5LmNhbGwoc2V0SW50ZXJ2YWwsIHNjb3BlLCBhcmd1bWVudHMpLCBjbGVhckludGVydmFsKTtcbn07XG5leHBvcnRzLmNsZWFyVGltZW91dCA9XG5leHBvcnRzLmNsZWFySW50ZXJ2YWwgPSBmdW5jdGlvbih0aW1lb3V0KSB7XG4gIGlmICh0aW1lb3V0KSB7XG4gICAgdGltZW91dC5jbG9zZSgpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBUaW1lb3V0KGlkLCBjbGVhckZuKSB7XG4gIHRoaXMuX2lkID0gaWQ7XG4gIHRoaXMuX2NsZWFyRm4gPSBjbGVhckZuO1xufVxuVGltZW91dC5wcm90b3R5cGUudW5yZWYgPSBUaW1lb3V0LnByb3RvdHlwZS5yZWYgPSBmdW5jdGlvbigpIHt9O1xuVGltZW91dC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5fY2xlYXJGbi5jYWxsKHNjb3BlLCB0aGlzLl9pZCk7XG59O1xuXG4vLyBEb2VzIG5vdCBzdGFydCB0aGUgdGltZSwganVzdCBzZXRzIHVwIHRoZSBtZW1iZXJzIG5lZWRlZC5cbmV4cG9ydHMuZW5yb2xsID0gZnVuY3Rpb24oaXRlbSwgbXNlY3MpIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IG1zZWNzO1xufTtcblxuZXhwb3J0cy51bmVucm9sbCA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IC0xO1xufTtcblxuZXhwb3J0cy5fdW5yZWZBY3RpdmUgPSBleHBvcnRzLmFjdGl2ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuXG4gIHZhciBtc2VjcyA9IGl0ZW0uX2lkbGVUaW1lb3V0O1xuICBpZiAobXNlY3MgPj0gMCkge1xuICAgIGl0ZW0uX2lkbGVUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uIG9uVGltZW91dCgpIHtcbiAgICAgIGlmIChpdGVtLl9vblRpbWVvdXQpXG4gICAgICAgIGl0ZW0uX29uVGltZW91dCgpO1xuICAgIH0sIG1zZWNzKTtcbiAgfVxufTtcblxuLy8gc2V0aW1tZWRpYXRlIGF0dGFjaGVzIGl0c2VsZiB0byB0aGUgZ2xvYmFsIG9iamVjdFxucmVxdWlyZShcInNldGltbWVkaWF0ZVwiKTtcbi8vIE9uIHNvbWUgZXhvdGljIGVudmlyb25tZW50cywgaXQncyBub3QgY2xlYXIgd2hpY2ggb2JqZWN0IGBzZXRpbW1lZGlhdGVgIHdhc1xuLy8gYWJsZSB0byBpbnN0YWxsIG9udG8uICBTZWFyY2ggZWFjaCBwb3NzaWJpbGl0eSBpbiB0aGUgc2FtZSBvcmRlciBhcyB0aGVcbi8vIGBzZXRpbW1lZGlhdGVgIGxpYnJhcnkuXG5leHBvcnRzLnNldEltbWVkaWF0ZSA9ICh0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmLnNldEltbWVkaWF0ZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgKHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgJiYgZ2xvYmFsLnNldEltbWVkaWF0ZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMgJiYgdGhpcy5zZXRJbW1lZGlhdGUpO1xuZXhwb3J0cy5jbGVhckltbWVkaWF0ZSA9ICh0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmLmNsZWFySW1tZWRpYXRlKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICh0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiICYmIGdsb2JhbC5jbGVhckltbWVkaWF0ZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAodGhpcyAmJiB0aGlzLmNsZWFySW1tZWRpYXRlKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi90aW1lcnMtYnJvd3NlcmlmeS9tYWluLmpzXG4vLyBtb2R1bGUgaWQgPSAxNTBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBcImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBVTBBQUFHRENBTUFBQUNZekxJeUFBQUNXRkJNVkVVQUFBQUFrUDhBa1A4QWtQOEFrUDhBa1A4QWtQOEFrUDhBa1A4QWtQOEFrUDhCa1A4QWtQOEFrUDhBa1A4QWtQOEJrZjhBa1A4QWtQOERrZjhCa1A4QmtQOEJrZjhWai95NDRQOFJsLy8vZHJiL2RyWngvK24vZHJaeC8rbi9kcmIvZHJaeC8rbi9kcmYvZHJady8rcHUvdXB4LytuL2RyZHgvK2xXdHYvL2RyYi9kcmJMNmY5dy8rcitkcmR4LytuL2RyWncvK3B1L3V0eC8rbGw5ZXhNc3Y5eC8rbHgvK2x3LytyL2RyYi9kcmIvZHJiOGRyZitkcmR4LytuaDh2OXErdXpSN1A5dy8rcGh1Ly9lOGY4d3BmOXMrK3FKelA4RWsvOXcvdXJaN3Y5di91cmw5UDl4LytuOWRyZi9kcmI5ZHJkRHJ2OXgvK2wydy85dXdmOXUvZXBzKytweC8rbXQzUC8vZHJZN3F2Ly9kclo3eHYvMmQ3bWwyUDl4Lytrbm92OXgvK20rNC8vVzdmKzAzLzlJMS9IOGRyZi9kcllydS9pWjAvK0F5UC9CNVAvL2RyWngvK2tYcC90cHZ2L3Q5Lzg2eXZYL2RyYVUwUDhnbnYvK2RyYnA5di8vZHJaK2c5eHgvK21TZ2RaSzJmSEY1djl4LytuV2U4UHkrZjhYcC91UXovLy9kclliblAvMy9QK2YxZjl4LytrVnBmc3h3UFpPM3ZEL2RyYmZlY0FyalBNd2kvSWt0UG5jZXNCeC8rbFY1ZTlXaCtkeC8ra2hqZlk5aXU1K2c5dWNnTk1hanZoeC8rbUR5ZjhLbXY2K2ZjbU9ndGU0ZmNyL2RyYTVmY3BHaWV4T2lPa3BqUFN3ZnMxSjJQRVZwZnVJZ3RrcHVmY291UGovZHJiL2RyYnRlTHpTZThNUG9QeW9mODlLaWVzUG9QenJlTHhnaHVROHkvUngvK24vZHJaeC8ra2t0UG5HZk1jOXpmTkxpZXJsZWI2NGZjdGQ3TzNvZUwxeC8rbi9kclpiNnZqLy8vLy9kclp4Lytsdi9leHIrdkVrS1pxOUFBQUF3M1JTVGxNQWVVS0VXRzlubWxDTUtobzJZSk1WQ2tvbER5RXdPZ2Jmb1hxRVo1UjNabTZFTjB4UEk0eFVrN2lOUk9aRUgxcWNMamFjQ2JSZ2JUOHFZRm9WUDN6eEZlcEt2TytyRDh5Z1Z1MHA4M0VQZFRDeE9zUENIUm5nMnVDdUpjVUsxKzJwb2VIdDNROFpveDdSeCtMdm1FQys5eGF6ejZjRzljVkQ4ZzhpNUxrbStTdk42cVg4MDZsSU55K3NRR1JYTHpmQVNEVzBYRXdoRldmNHlGSXZMQnJtSVZSRFFqWXBZallsVWRqUGJGNVlUaGhzVTB4Sng3ck9XMVJCS1VsQ1BHVFordXhFek95NkFBQkRmRWxFUVZSNDJ1eWN6MDVpU1JUR1oyemFLOW9peVA5SHVBbGIxb1FBb1VQWUVGa1FRb3dCTjhwQ0V3MHJFMk5zWDZKZmh4ZWIrbnUvVy9kVVVWeXdwM3NtZkdhU25obTcrOVN2dm5PcTZsVGhYd2NkZE5CQkJ4MTAwRUVISFhUUS8xZFZLZllMOFhYUXJoenp4UXVpSWxOZWlqUCtqeEd1Q25Qa0RVVURxdjZ5a2VRNXliT3pVdWxTcXlSMUZnbUFkU3gvSU5pcUFLaXg2WWpQckpKRCtmUVFGTW5MMDlOeXVmeE5xcXgwR2lsaURMZ2crMXZRZ21BRTBNUlhVdTQ0TllRQjhiRjhMdEZxVVpQOFZxa2NXVlRoaWpPTzJDYkovbXRvNFVBQUJEL2c0K2JRcWlRa2hzTUhBcUtmZ1BLQ29XUWtCY2pDU1VLRms0SlVnbS9FOWpTRzFxd0luMTJjWUVBSFFNMFA4SXlnQzFwc1VCZ1JHd21JN3NzU0tEbklUT2FjNlpqcEhNcEVpZ0UybkF1eUZ0Y0NyYWE3SFYrc0hyUUF1Z0VhOUxRM01nNkowWURvbmp6empHV0VNc014ZmhYNisrK3ZobzZGQU5sZ3l3U3lFVm9tZ2haMEZXR0lBVk82NEY4R08xSUFDVUFuUHhrdWovdllLakVXRUFYUDNZekpXTEkvU2FKa0ZKbStHUG9iK3NxL1RMd2dDN1JHUFRBS0F1aGlNYU1xU1YxS1JiK3RESDRPZ09BSGRDcGNFVHVFRVltaFJFVEJjMGRqTXBZRkZnZEh5VUZtczlsY1hGbUlNSlpzQ1ZtZ0JWdkR0c1ppUmxWV3d1SUJmRnNBTlBDWjNzZ21wSWNTRWQyRFoxNFlrN0VFeWx3UUJMM213OVdzMzU5ZGpSODZZWE0wN1UwRENJUUIxN0N0VVJBSVdzNldxZ0lkV1NVV0R2QnpBeFF5NmVXRUFvZjRhTVFRUk9neG52blVNSVV4T1V2bHlpQm85cGV0TmRHUDE4ZGh0OTJZVDY3dit2ZFhuWEEwMVlBSldpU1FqYTFXY3NOd29yL0VMeU9CSGZoNUFGSitZZGdaei9wdmQ5ZVQyL2xMbzkwZWRGdXQxbkE0N0M0YUwvUHIvamo4SGtSRXdiTjBWa3dGczhoZ0NtTUtsaXlHWVByV1htK3I0WURCL1hpYlBZU2pVY3kySUd0aGF4Ui9MWTRwamt5dkcyQUhmRzZBaE45OS8yNXl1MndQaG8vK29keis3RWlpNE1udFdheW1nTWxMcGpJbXovQmV2N0hlVVkrdGRxUEdiSHZWYVk2UVFWd0dXN3FVUVFsaUlDZStnTS9sd0dZekhOKy9mVXptalVXTDh2TnIrUEhRK1I3bldVRzJid1h6OHJSeXBJekpXQUxsZm5wbHBsM2VDclJoczBuUWdpMElReFFiNEFGZkRPQ01PYkQyMHU2dVBpUDA0Umc4R1U2UzdYNll5cGhnK2JsYWRkc3Z0Y2xIZnpZR1d1QVZoRGxrVXptZ00xYVBVWk5uTUN1QXQwczQ4Rk0xZk5BOG8yemZFbVpadzJUMTh0ZkFwQVdCMS8xYnRwUzlzYlZzekx3THdvWkdURTJPYnZhekx4WVBScStMQXZnck5aVDUvbFZtKzNZNDh3Wk1zUHdOK3ZIangrdnI0K05xT0dRTDdXcjErTXIrdy9wM2FoaCt6M0djNXdwbmZwdXQwUjhDODAvVWtPTmtQQVhPMGtWMWkzMm1odm05dlQ0b2lmTTlrTmwrd21vbmN0MEhNeHM4ZDljSEVhMVl0aXVjNWMybHMzcHhCcGk5MWZvZ20xb0M1M25HVnpxTFowano2ZXY2b0EwNFVUcWQxaXlWandxcVpyYldOclVuL2F1SHNQTnd4VFlvVDN5SFVsczJ4Qkh0L3lEV2NsaTF1TmFyVncvT0xFcm5abXVldTFmeldnK2JhN1AxVXE4L1Q1djhCTXdQY04zL1JvMWdoOTRYZGpJVHg0ZHA3NzFlTndjMDdVeGFydDhhQnFKMEZsanBkSmt6cjZ6cGdGbWIxZ08yZXlYQ09ZVkx4OUpyZG1aOWRqSlpETmQva0lhTHh1MzEwODl4T09wSmVPZ2pVdVhZT0pwUGJldEVQTXZTQ1hQU1BOZld6RnBndGtPR01pdTZwMHJPSXpUWVJyWU54LzI3MzJUYTRZQjNYUmpBNmJNR0NId3doN1VsSUlpKzEyeTVIakNjTUtjcno0VTFlOVNZUVU2aWpQcGw3QmZpUytnclJXd1lOMjdhVVhqRit4R053V2U3Rmhrc0hIalBBTjVvZ09CSDZkRisxVmM1SUVrMEY5UnJOcHpaamVaVWVRNXJtakMvU0pRWjBxeEZ0NWIwdTBHV29JVnI3NSt1YjE4V3JkZmQ2UTE1LzRRWHdBZkp6d3N3am83YlFpblpTRDBXdHc0T25oMnJPWkhvbDNvSkN0ZW11cjFBSFU4ekp3VjZrOENWUUF5MklPdEdxOW0rMzB5Ym9obis5REZodTRYNWZQblNZQTN4eGFEYjdRNFc3WGFqc1p6WGJpZVQ2K3VQSjdaMmRGajFZL0EwUFNRd0FEcjRHZkJPSU55b0YrUlkyQmdVVDRLemF6Y25FcjF5WkYyQ0d1K3lkU0pSaWl1d2I1QytzcW5Zcjdrb1dUZGE5Q205UWxzVStOd0dwSGZUOUhKYWZrbkp3YWlMYjlYbGZVNG03QmptdENZNnI1bzB6eGVCUHVnTGxPSjY5aEkzc05ZN1dNQUZXUVB0T1dFTHVwNTdSQWpzd004TE1JYVBhY01WYVptTmhBTVZQR0ZQYWs0Y2lNaGU4MHMydVFSTm95YlV0ekovUW5JQm1kZmNBcktNUXMwc01naW1wV2hoVytEMUNlaG8vYVAzekxqYWhDRVpTQUV3K2R3UEF4SmpFVHlWUGVjbW1DdHB6b29sMWJIWDdDY1hvS3pLY3Q2K3Z5aksrNlVxRjE0OGNyRTNOcHBrUVFHTGwzZjlDc1h6OE1MY0xWQ3AvMmw3dWhPdmZqQ2dpQVpGSi9Fa0JnWXBTbUU4OGxrZzU2bnNtYXZiek1tYUg2V0xQRm1Ec05ja3E3bHEzcGN1SkVvcXdaS2hsQ1JGMkliZHpGY29SajJBY1NCamNjV1grSGZyMmdGOHlHQXpHaTRZMlFpbXpIZ1dpL2JIdjVLbnRHYzJtZXRoN290YWh4S1ZNODhUWFZoemF2Nk91dGowOHl6SFBaMmRwUXcrbzk4ckpSTVRyMUFLM0JSbHZCY0NXZ0VYS2pES2tHSUdnUjU5M2tTamNRZHpCSjdXb1RFeWFoK2V3UGtVU0tOOXd5WUpLM3BCckVFdk5NL0Z5c1grUGp2TXZHU3AzOWpJOTBySkpVU3RHR0lRYWdpbnFMVkt4cHVZQ3Y4aTR2OVZ5M3lOaXdKSW9oSGgySU1SUUFWUDEvaVlQeS9MZXU5WXA2bCtMTXlaSjJWVEpQcU5lWjRNY2hvL1NpMzUyMVQwSW5oOUlzdXA3WGxQdHhQNGJrWU9RZzVCanNCNFpxbnBBckJMdHJmaUYwSWtHclljNjNBQ3ZUbk5JUmcxdXpMM2lnNjM0RnhqbXJQSmNlcDFpTkpNN3R4RG1lZnV3MzFlWklMZVNPallnL3JvNm1QZWphN0VYaGUxcDNHdkxvbnFJVVNPcUVhVkg1c0ZuK0t2RXZIbzN4Vk5yOU9mdEZ1aXpmYTZhckd1WWdmQnNHZ1V6MU9uUGM4dXhabWJtUE5ITDFxSHlDTEV2ejE0TXF0bWxPZjJtcG1YVnREUmY1RWsrOHUxVmJVWkg0UWFBaHlSdHp4ejlhbktSRWR0aTZaM1g5c1FEQU9xZVNJWVY2dVNtblBHMXlGZE9Pa2lGTXdUVlhOam5oZk50MTg4K0NhSm5iUkl4UkRnQ0V6VWprS2FwSTJtMW1SQU5VKzliZG5jcTJ5YVcwN1F0QzVDZzNWTVBWRTFrZWNrZkx6OVFuUEFwOGFNRFFHT3dBajJFZElFMFR4dkUwM3RXZk5rd1NEYmFhNHJjOVpkTkwyTFVKdFpVMzF6M2hrK1RsNStsdkE4SE9FYXdZNVBKTk5IVXhQK2xNRTRzNzNJelVuUDNlT05OTTFqNVNSUTUvcFMwUm0rc2dLSjN1UFBFSTdBQ1BhR1dVZ2JEWGlxWUZ5bHB4aVZ3cHFkcHJHa1g2b2x2Yk9PcWM4VEhWWFRIajVhQXFrMEgwbEhZQVQ3dzZRTmlsVEpnbXhITUhSaHVkN29UWndyanhuTldhSWhLdFova0xlSG53dWFMK3ZVcXQwRU9US0NQV0FpVFVMYzVhUkpGcFh0Q01ha1diRmsrZ01JRVpwb2VlQWNpdDJVTTN4WUlTMVBNb0k5WWFZM0pyMWVJTUY0YUNMVDZYYnpiaDNUQ0RTOTRlOC9nclBpM2pCRnhWenVHTXhTdkNjRVRnZk50cnR1NHBXaHJTcGdwMDlyTXNKL04yWnJ4M3FGNnJ3bnpOcnV3WFNuUVk3aVRFOFROWGF5anVsWjB5eVMzZGQrNFVNdmZEbkZlZXUzd1VTdUlGWDJwbWxHVTVjMFQwSFRPQmw0dzE4czV4UCsvTGZSOVk3Z2ZMZlNpVHp4UnpNY3RCdkxScnM3OU9Na3FlS25XVFcvOTBoODc5SkRFMlk0M3hoKys3by9Hc1dmcGM4V0cwZUE5UElyZlo1MFdaOERENy9EaC82a3V4RW5UWlY4dExKOE9NNUN2aFhyVmZhYmptQjZJN1BjNGJmN1U5MzE0cEl0TVVaMDRScEJOczFLbERaUHVtOE1wUDVFVFhUcEhENjFVcVNLZGRmanB4a2Y4Q3JJNGhiSmtsbFplL2p0bjd5dllkNG9DcVFNNk5qcWlSdVNYaW1zNmNtVGJzaFFtdEdJQ2VaQVcwNmNtTnU5YUxiaWdVUTA4L2JNbXRwWWRrVHc4cnJnR0ZlOWZCRGNvUXZiNzlseEpVSTBnRWxZR3RGd3haN0VkRnIyVk1IY1Vwby92VFRSUWxvWmc3VFFqRC94SE5Eb3IyVDArdHBGNjF4LzlKWDVjK0ZNTC9naFZaNDc4NlE3Rmhzd0ZZME94M2dTYzJWWms2YVd1Y1ZwOFo3Mk55bE5GaFNQNlhVTk5VQ1R0S2FNNjJYd1Y5SHJ6M1FYOEdSQ2ZpeGJqR0Ewc09PRUgzYkk4enFsTWpDaWtUZnI3Qi9qU1l6dDFXLzNPNTFiUDAxZlEyNGU2TzVtUG1GTlpCYk4yUGg3cFlxNk1GUDNoMUhuRVRndHQzbkZuZktjbklCV1RSS04xSkcremRTbitrZHlLaUp6U3pzWm9IbThIYzFiMENUV1JHYVJvOFM1dnVQRmRhTCtjUmJSQ0FiMjlEcFBaODdpaGp3ZjFBUFZ0TXdrb3luTGFES3E0eFE4dHp4emkvY0dTWnIzb09scmIxNkRKdTNvdjF1TWliZGZGZjZFQWk5UjlJOWFLV1NpcHRQUTV1c3R6VW1yVGtoZ0ttTnlsdUxGejJVcEZneVBSdkNVazB1elBVek9MV2hlMFo0bHBTbS9kYlNPNlU3UVJPZWQzRFlSR2dLbWpGNytvQ3NsOVdPQTlBaEV2UnBRUDZRMFp4RlZwMDFoQ21PcWFFb3lHZ1J6eG5paVUwOXhOc2pjUmpUSFc5TTA1L2d0d0xjbTYxU1B3TVFIRUVYMHhUejV1VW9sTlFLVjdjbXRaejBhd0lXUEk2MDZGS1kwcGowYVJwVHpGTW1pY0hybUZ2MzBCeTlOdE40ZFJjRlhwOXBvL0ZaRTlGWFh6d09xUklhNGVkM1BuS2c2ZFF0TWZQTFpHazFWOEZTVEM1enV1UVVpWXJpTVNiTUtHenUzcHVicjQ2YnQwMTNrN1pkMUJOb1EyYURwSEVCeEwyc0NacVc4S1JveHVjRHBubHQzK3Q0Um1uUXpSUzh5VURWbG5YcWhDekxDQndzTFR4Z0N0ODFrQUlqTnJhTExtc082aU1iL0V5UHlmSEk1VHFTS2EyNzlOUE9wTGpJUXZ5M1BzenI4RXNKM3ZGclNockJzbEo3SjlUMFZZblpac3hrQUpveHBuMXpnekFhaGUyNUJNNUdXSDVybVdkNTdrWkVGVFNQK3VxVm9LcGc2Zko4aE12STQxU1VEMkhZZFFxSThKL004QzVpK1dZbmpUT2I2TytiV1NmTWFORk5lWkNEKzBMN3hybmo2azhqMjZLZy9UbVRYdHFudVRwUXVwaFl3dlRobHhWZzU1alpPTXp0eWJNblRYV1RRK0pIbnBFbmd0Wlc5ZE02a0hTcmVWSGNueWhpZmRnWk1EMDZWS3NITVBiYzQ0QmlOc3dsb3ByckljTWMvSmYxQUw0bVM4QU8xZWNPd2cxTUltV3d2QnRIVUFxWVhaOW1lNjZNY1VJRm1iM3VhY3pkTnhEOG0xdFI1WHQyMmtTYjlRTTE1azhXbXpPZnZpaTFSd2hSVFN6OFIrV0NtT3JybExwcTNkcG9WQWNyc3hDaE1LaTRhUHpaM2FSdTlxblJTYS8yRUhmeGxFNGxpV3ZNOFE2YldueXFaYzJyT2VxelVGWDJOSWM4bDJ3L1EzQkQvZmNvK0wveGdNK2VjdEZSOVpiTkhyQ256SEZPNzFjOHNVdWJzbUptQ3dwbU9KajVDWU5MTUtKbzRMNGt5RFBXd0JQbk1RSDlLQStvR3JTNWJsczJaeFpxWTJyUnorMzFvSGdiQnlrc3p6WlVsNGpkMytBdUpIUEduSEFCU25lNXhxU3dSMThpeE9kM1V3dW5ZY05QQ3VUL05SM3pnd1BpZU9kbHdvVTZsTStjSlV0M1JsSEdYelZOYjJXbm12cVMzSnJiU09EZVNUTm1KWnR0TzB4MS9UeTNDampybFg1VFJmcVczSjI1aGhhVTBUMUpZazdSOVFsdmhMTzlGazE2bjAwVUkyeU5IWnZwM1NVaDFldXZzcFducmp3Mk1TcDl1YnBsWHNLclRUc1ZPTkJkcmFBaWF6blBxSk1EaEphVklxdnVYSVhlYkJ2c3I5MVQ0NnpBKzRVTTd2THZRSE5ocCt1OUZVc2VQVkErV2p1WUFrZThvM0JGbE0yM1p3UitJNGRGaitFVjZta1pQcHhWUHVqemFUTzRXcUYvK2wrUWRKQmVSWjlsRTJVd2ZqYjF3Tm9BZ0JVM2Z3eG1uRzZhcHkyYjZsejJRWi9xSHFjdW03MlpzOEhrMEIzYWFOVWRlcGhXdEhhaDlvT2s3cGYvRDNwbnNwaEVFWVRpNzdTdzJNVW1BUnhocHJwd1JZaEFSOGdVTkI0U1FaWUV2aGdPV1FENVppaXlTbDhqcjVNWFNLMzgzUmRNend3eDJsa29VSjVIaUZGOVg5VkpkWFhYaEd2NGNsaUc0Wjk2ZTdqOHVaWGV1UHRtQUo2UEpWN0JiVDk2VVJ6eEx4eDAyaVY2YWFSSU8vVnZTN003VmN0eTBwTjI4aDduUWJHNjNsck04VDViK1pUK25xUXJMYUdxYU0vbFA5NlFaYmcramVlS2Izb2djdG43L3JHMGFCcFg4WGdoTHpMV0RacUh6NXZ4SnpadVJZOTcwM0FDbnVCZjZ2NmFYTVBhK0lBM3VMSDlzUi9WbjdEZnZpdHh2ZWpNT2ZYVW84RER3WHowTDNZT21kK3pUNUhyNDh4Zi85bk02ck1uekJoaW9IQStxLzVBWVVpZHpES25zaXlIUkJBNzNLMmx2anB3enZpa1h2Y2VMYndZNXhEY0J3QjNmSk41QTVwWTArWnZ1MlB2enZ5RDJMbGxoZE9pdUJqVEhQcHIrM0dMbnZWRC85Qys1RjFKRDIzTGNDNUYxajF5U1E1Q3k1RGcyT2U4c3c3enZMRS8zdWJOY3BMdXp4SGVEb3p2dUxOT2NCWEdrZDV6VUNyeFBuei82ZmJwTzlvQnYwdnQwMEl3OGNRcHl0cUFuZ1VQbGVzd2VJOWVESmlMUlhBOU1MZjQxazlneE1aUUQ1U0YxSGlVUENVbHlyanlrVkhFV2VncW5DWnh3cnJpNEhMbjJ2amx5cld3NWNpclh1ZS9La1hOc0lxcDBCMElyQTlEMS82RDVtOGVwOGpkN09lVnYwbmNaUXpnS0RSL1NnSnp6VVFiZGNQNHh1Y1Z4MXR4aStEbXRvbGNoZ09oK3pyM2hwRnVrUHlidnZmRTFXOTQ3L1ZnZFBIR2h6a3VMcEhpM1NCTk1ITW5mWkR3NzlKdU1WVUZ2TW1wNkRuOVhKZ3NMT1hrNkp2WElzYWg1M3d2aGlVdm05MEpYeXRHZnpIc2hPWWVma1lDcUp3VG9ZRCtFNTlsdjJVTGk2K1QxMktPOVpidGRtZHFBSjFYR2Vzdlcvazdlc21GbzNkdE5lckNrOFdKNkdOalo1YVZCWGpiNjMxbStQTkE3UzR3dW5YSTg3eXd4dEhoeVRrSTAyRzQ2bzBoMHgrVjdBNHhucTBuZkFDOXZEL0VHV0l4dWFYdVY0TS9rRGJDaitBQU5BTk4zZ2Y1bENCUG5HY3dCSFFzY1Q2by9TNTYrOStuZFE3eFBWMitxTlZBOFR4ZnZxZDN2MDF0VzhZUXlibDNjTlZMOE5IdFkxM3kxRTBpMWdrUFdUZ2dkdFJQVWUvOXpyVTVabDA1UWIvMWR0UlB1N2NJZVdIK2I3aVhkMzltaGc4ckZxT3VCdDZJRXA3T3V4NmZOdWg2TkE5VDEwS1A3NWIxV0IyVTl2cXhMbVcrcjRsTTNpczZRdmFHZkprNXFjeEsrVk1ic3F6blRYUjZkMEpvejU3ck1pNmZtVEMrM21qUFFSbzR1MUxGS3poenJna0pIN2UwMVp4QVl3MmFtNVZuU2FZakw5V1RjV3cvcDFxaEE5SEdqSGhKVHY5aDZTT050MnNqUk5Rb2l2VERLSWVtSzBjRjNvb3daRjNOdnRIODRsblJnUXFpZVBDc210YnBtTzJwMXZkcW8xWFZjY0sydWJRWHF1bXAwaldKZFpxa3VWVnVxNFNockI5T2tqbzdyWDNjbk1XZW5ERGlnWFVjdW9oL0FxdHhtTldoOFUyUWRPVlRCc1NUaTJpaWdUSlFxR2lYcW50blNOdXJJMllkWWU0a09jRU9lOU1sTUQ0dERzaHFIZ2Y0RVRORGVrcXZ2ckhFNDJiUEdvYnQ4WlRRL09qWFY0VCtOZ290OWY0MUQ0dWorYVpOZXFybzNMdjc2bXlPai91WnI4VU9Ydk96TjRlVEVHRExXMy9TVVZvMWFkUUdVaVZWK2svbjQzRjkvYzFlUGpBV216VjNSN05CMTNrdGNHL2JuVUhWbkVxSzdOeFZURzlaZjlqY0sxc1ZoVVJvMmlCS1ZVWVpwRWw5c1lkcjBWQ053R0dlS3VzVTNVNnR1Y1MrK25PUlZ0emhEU2Vyb0lhN3J3c1ZCRUMrQTBsdTN1R1FHcS96VEpnMXhOVjBudmxLNm10ck44VFhyTWp1b3pycTUxdFRPV2k2OUVUVy9xWkxhUHBpYk14dkNBZDVwazNhMGRHNWxjNi8zSHE2SU1hVEhXVlM5ZDN4VzEzMGVwczNFM1ZacjVsNlFmb0RsQVhvUm9HK1lyM3grZTVKWm1XYWI5Q0tBSDVJYmg4Q2FOcW5HcEJNd2pCUFdjN2crR1JYVisrN01FTm5TRG1UejB3WWpDNWoyK1dCTys2ZGoydHpWcFRvZ3hvbVpyZEFlTGdESklLSXY0MGEvUllZVlRJazIrZlZ3Z1ovVEdwOEJiUUtjcW5zdERJajJGd3JDRE9xM1NYOGh4WkdEWkFqUk0zU2pGeWduQzZhNWREdWExY25JT21wMnd6VGg2SjVvZHN0elBNamUrd3Jxazk1WEZlYlhrdU81YXJqTjVBV1JMNXdzbUpiTGxiMjBRWkY2akN4Z3VtcDJUKzNtNlo2MmpTSDFkVXlkMmZ1eVFYM1NsMDJTRkJ6Uk01eTMyVCtHOEQraFlmZDd3VlQwelM1bDFnWXpwam15M25OSzRNOFVyZXd3VGt5ZHNNNzhlZ1lxa25idmRidDl2UlkwN0ViTGJtNmlXYlZCanp2MERFU3pUc2NadXZGMXZRWlZucVUzVGt5ZDZKZEkrMW11cWtuczhpZnBad21TbXFQdTB2MmFDdnRiRFZXMzdKWW1TcnByZHBySmxFR1FHNStPZlRnRkUzN3VXb1A4eGhtNER0TmZ4T2c1ZTYwR0hxRFZJZW0xaWk3MmR1OTFkQW5Sb3YvR1lHcDFsYmUxWWVvTXF3bVV3UVVNT3BWS1U5Y3d0NXNta3VPU0d5ZWk4QkluL2s5WEgrRDZRK2hRZmlyN0FFTjk1bGdDSlVneWpxUko5NmtTTk93R1UzU1ZGMEF0YmNUd0x2dU9Qc0Q5SlpUaFRnNHZSOWQwQXlZMVRXdzJmY1pKbzYraGpwdkJIMmlQYWdXVUVSMWR6b3lBVnpTK2lZZGJlbFRMK3k3MGpUZEI2aWJkN1Y3UW40N2lWbEFmdHBlcWV6aVlXbDNsMlRlRU5tcDRPZEZWd05TWlJIZmZ2bis3aXlhenkxRjlaU2lqZXlyTFQ0V0c4QjhCazVvbTFxQnN4aGxpUjRabTQrNys2WUxFcWowY1hxMXF0ZTM5MDVWVkhwdGQ3RFhIV284QmFEYVF3WUR1NGRjUHJUYStvOVZWbm45VDlLSW4vZE8xbkJKbFZGSUZQcENZTVZ3d1lacVZwT245Rk9kWHRCc1E1bG5lMmR2L3hOUGJuNlBFUDNvT3U3NXFQVlFqYjRPLzZvM3F5QzYrTTRCeUEvMnNCbW5EMnFFTFZlWWNMTFY1NDJoRi9SeW1tY2c0NGV1UTVncDdYTzVVbW1kWjhZVEhZZzB4Vmc0NEpiK1F0VkZxbnd4dXdsVG5xVGt6VW1Wbkpoc3hnVUFicUtOMHNaVlJYZkVsUzB5OU1vdGkvR3VibjhNMEV4a25mTjJReVJMZVRubmFxd2tUc3F2UkN3WStxNXpkZE4vNGNaYVkza05QbXFqbHR3S290VXRRQ29tdkh5eGwzc3JQQVpZdmNQRS9KS0haaTYva21KM3dwaVYweEFhd0lzdU1JNjBKMlROYVcyNjltVkhRWVpVY1phdTZUMXl5djFKQWJRT0ZOc2ZxN2xSK09ZWXk4aVB3aEE3SkVrNk9FeXIxY3p6NzhCcW44blVuVG1PM3FKVXBWYmg5bnBIempCYWNYREJaQXVXcUUvN2FWKzduekVLcGdVS2JGK0l5bmYrQzQ3NDZtRllZU3JERWNhcUgzYjlobWdoWmxOTGV0RXdjQnpId1ZDYzdFWGZFV1Z2RUxKaks4b2M2Vlpzb3NUM3R6L1pHaWFBVU5WQ2hEVUlvL0lzTW0yaTlOY3EzWUltai9qNStUaVByN1oybmJKakF1WTQ3bGhFSFlvSXdtdlk2b01UUktUZTU3MjgxMEhPaERvUkhuN1FGbE5Zb3dkSnljZ3J6TlgybTYvZDFyRVMwODduSkUxNGpJN29JOHZJb3IwQ3FTV3FVam5OZklRWXFnZG9wZTJ6VWhZaEFxa0pwcyt6TlhERFQrRGtOUllXT3VBc3lqckM4S0R1RVZlcVVMcXowbUN4L09tSVNlYytnR082M3dpYlhWRCtKaURSUWd1VVN3MHhod3MvVDRNUkt0SnZuRyt3MnBDREdxeml1U1dJSmp6SDJCVWgxQ1FPRmNuSytoQ0NRaXZrSHNUdzNUTHlNeW5MbjM3N2J5Uk1wWEF3Yll5ZlhUdjQ3eE5ZMFNleUdDcFpxb0xWVHltRmpvUVViRDRWU3NyeUNjbTZZOFBPMEs5SEowZFdGWjQ2U1JGVklGMEZleE5iV0pGT3VPNDF1T0w2K1hIVGllTlI1dUxrY0RNWjNVV0tnbkNlR1d5RGxUTFZvcDdIbW41NUx1Kzh0RXliOFBOVktKRk9aVjY2UEVJNVVMRVlpVllKRGtCMFRxdFVUYkN3UmRVS3l5eW1YZFJaT01Qb3g3aWJiMUN1Z09OaGFhWkFTcERuL09OVzdhQitkWklWSnJ3SGRGR2JUdGlhS2VDNml2RHFDVXh2K0pPZEdUN2Z6VXpRTmgraUFVSzgrVFpLSE1JN0pjQ01ORWw2RHpaclR5MCtlWjROSkxpV0IweUhWVWErbUExMFFaVkMxZHFzemFDYTJ5VmdsdEcwRzIrMUJFa3g3d1UwQ292ZlRaUTBoVVFpY3hqZVZYeWd2endnVE9CRi83alYySzkydC9waTJoaXlXcVlLOFZ5eksyK292cXZCSlA4bE9IY21XUmo3dEIrYWkvQXYvcVMxS0VtVTJPa3Bpb3JORmExVWp3eTJkcGhaMHNNRndHS2IwOG13dzhmZ01UK2RZYkNyaG5QZnQ3dUlXaWZuSlVjN3J5aWJwTEhjczVKVVVMRzBxcmJVWEo4czlHai9NNjFlTXFaYmFWVDFlU0p2MEdDYkN1cGxnMGhhRjhQWWlwQnRyb3lRcjhBdGJQcTdqVTJhUCszcHlEN2k5YUhTYjRhUnhnYkMrMXpDMWwrUCtPNTNneWJHNUZyVUw0ZG50MUkzczlNM2Q0WHRMc0V0VVJQV0p2eDREYUg1eUVXakR4QVBuUGFTOGtaTFNDM05uYWFDVU5rbE9MdWRhY0lJQlVRRVVCcG92UzJXWThISUNNL3RhSkhqMnd6eFJzcTBRVUhLU2VIaDJ2ZzVVbkNuUngydU9GWGVkeG5WdmZaUUhVRXlZT3FGbUx5K25hOUY3TXdPaEZlYUVzaS9NRWlobGdFSjNPOGU3MTRvVThYdVJ6eWs3c3VQeXh6RFFJQ2VlRGNrU2hna3YzeGVuOFBaOGVYYW44SERjZCtsUUtaSUppU0M5a3hGVlFHMEQ3VVQ3c3d6V0xHR1llOEdFOG5MeXRIZ085K0k1NlZpVEpWQnFra20wNGtRbFVHS2c4MjV1TEtsaDV1VHROczkyUmdPZC9KajNqdXpKRWlpRlRhWVlad0VVQnBySEROcUlOMW5tYUpqdzlnMmVXWUJPTG1ORzByUkthWlpBbWNGeFhBWmFqNlAwS0I4WVNzVEJPY3RjRFJOSzJ6dzEwT0cwbVV6UGNERFNKRFZLZURoRm1kbEExZnRZQ1hRZXBVU0pQQyt3aEdiRjhVU0N4bkE0WDR6ZGFrZXp5Mm5BUUlJa1IybE5sdnNxWENJR0NxQkJaeEFsSURtSWdiSlFscFFuVk5aRWp4alRZTFFZWEkvdm14TjJjcHRWQjVjM2k4NG9yaXVPSnhaSkd5VXBVYk8vZ1FLb2VPSFo2bHhIVHBEakcwRVNLSXRsU1hrQ0tNTEJWaUlhb3J3SWZJSWtVQklQejh0QUFSUklwNHZCT094RzdJais3YTRSVFpxendXTFVDdUExMlBjV3pCSTh0UWxBWnlaMmRCZ3hYak8yQnBMNW82UUdDdVdlRzBpSmlLZ1ZuWDhFeXd3dWsza1J0VktyRWNtMkJDbGRBaVJJNW9xU0dxZ0dDdDAyQmh0RERxOHhVUjZDSlhocWxUZFN1SGhBVjR2OGcvV0lBaVNCc2hqdEFCVERUVWNiWG1PR0NEaktRN0NrS211aUw5UU5vQ21LSWg3NG1DUUwxYlZrQWpXUmF0R1hRNXdqQW9CQTZSL3BRb0JLb3NoREUxeTUwTWRuUlpPa1FLVnlRRXBHbTNqTndWSFNvN0lPa1hHb1RMNUllUzhGc1RXUVBKQW81WUFVZzMyTTFFTUJVcEY4RkpTVXFGUWJpV2hHa0pjODJqMms2Q2V3YXJneDJDcmpBNk10U1phZVBRR3BDS1lDcWhRRWVSK0pJdzNmY2FRWWJReTRCUGxVU0ZwTUt5VkxLa3llUFFXcGNDdkZhRU9ld0dqL3FmS2JQVHFtQVFBQWdSZ29nZ0gvVGlFaGVQamhidXJlL3R1MXJrSnVBd0FBQUFBQUFNQ3dkd2FyaVFSQkdMNkVpTEtRUU5qVlZ4Qzh6bGtHRlpmUUYxa1BRV1FQaVplTkJ6MHNuZ1NSMVpmSTYvaGlXMlBiODAxUE1laE14dFVGdjQ0UWtrdnlVZlo0cVBycnhvMnpVYmZJTjNKdXZSS2Y2b2RUUEFseDM5SC9KcmdlblhUNzFEL29xM21rVjlQQ0ZoQUhndDNmY28xbTBTZmFtTlVHZURoUDc5ekJKRDJ2d3RjRHFYNU5CUHRtTDFPekZLQVQ2T3R6KzJGcUNyYWJZTFNzSVF4NjNIM0lFa3M2anQybXphTDJmRzZwUUMwUWYyUUhFbktSNGd1Yk9Nb3lXdGNOK1JiMmdGaFNmbU8zdFlSYS8wWW8rM0xDWDdaQS9Pa0ZNWEVnbWh3dlFoYWpuM1dwaGtXRS9Td0QzTVU0dzRKWHVaaFZWWXZhdkMyMGRlU3BDekJib0dmUDFjWWQ2QkVEak9LeitCeTFVK215dmdVN1pnUDNNVW0vcU1Wc3JGYlFhckZyRFlNSWN6eEVCM2ZxQWxRQ00vMnhJTVltZ044cjl2OExSdkZackRCcmNRNTlQS1Rxa1p4amtwUFNpMW5VZXZlQmR5RmdsNGNab0cwUElUUk9ILzR5Qk9MUHlYTEZZVS9tYUpZemlzK0NoWmthVWJiaGNGQUY1ZGk2VldaUmkxdksxc0hERE5DR09vRW96V01DOFJmTDgvTCtmQmkyZFVieFdUQjhRbHlpTWhyNjdBVXppY0tVU2VuaHJOTU1CcVBlcUFJSnc5bG15ZW5VbHkzQU4xQy9JM2tjZjBwZ2xqKzJ3MVFBR0drOUJMRVZqVklnQm9uZE10V0toTG13bGdVMnE3bnBocTFYbVVmdnY4dW1sY0hJQ1VhdGJ6YmJMWHJaR3lZdmQxZ3JoanZ0VHd2TTl0ZVU0RUNia3lxRDlhMHdsSEhyZHRzWTAzMXJMVjkvOW9kdWJsM0ZmQlNMNkdMdjBUcmNuWXA1RnJuYjlYaldIQXdTWll0WjNLSVd2SzFoOGtLWmZNRTk4QWFXb3dRcWYrLzlYeStUYWZoOFFwU2NtWHgweEtpS29Na3oxR3FYQmhISzN5dStMR0RlRGxzTktkc2ZuVURNV3JoMGxWb3FGekFHUER5b3Y2d0tEQUpaVUxUZXlxVC9HeHQyY21DMk02S204Z2ZLUFJGdFdHb1czMHFLZGpyWnEyMEdnVktMV3d5RDFvWTg5Q1VFanFVQ0c4dXd1OWlWZ0JuaWt4aTBYREp0WWVLeVhCYmRjTmw0MmZiSFE5U2lWNmlLWTdEU1VDZFVZQkJFNzJDNUFDZFRLckJVekV4ODVnamlSR2FjWVVvbzE1bVp0Nk43ZnlLUHNyVTh5NFpTdXhqMkdBaEJwRzc4MGQ4L1BNUmVsd3Z3bkpoTy9wRFlSMDhtTGkvQVpyTlpyZWJ6aFRIeW9GMHM1aXY1d2U1U0VNY3BxUldFdmgvL2FIUWxNcThSUSt3dWkwZE9XMGIrUGR6ZFNHSCtWS3BxV2NaeG1kWEs3Kzd1eGwvMnpzSTNxaUFJNHdTSFFGSWd1QnhXaXBRQ3BSVG9YYUVVS0VFcVNKRWlwVmlSS3dSM0RlN3Vyc0hkM2Y4dFptWjMzOXk5MlhlUHU1SWc0U3VRZC9BZzRjYzNNN3V6RzBab0JVYTdHY3pHT0gxbTRlQjRqUDhpeVFtTU5FeU1VNmYvbkthU2paLy9Ld1pPVHAwKzh3SXBadzYwVHlHZU9HenNvaTZERjQyRkJjcFNYS0UwVzVCS1c3Ui9RZEJ5V0RFUTlYbkZSaCtjZGZ4VFp5TXgzMDRPYmFIRnRXeTlORysrcktRUDdvQnhBemZrNzhnUnNPbGRCenN6Mmo2VUROVlRGUGd2VkRKNG9uYVVWSmRhZXA2ODkwekxKUHVjVlI3b1RDTjdoT29ZTVdLYzN0dG44SlJoc0RPWk9lcnpINlJSTTFOaHdNN3BjVjFHRHlWNDNFY1Uwdk9NbHc2eS9rTXNFL05XUlp6TEdjQ3NRVjE0V2cvSmV3dk5iQjNiZGhrM2JONXZNdTJvRWRoMUFZQWx5d3pBQ0h4ZVRRR2U3V0lmQ2o4UUJ5Y0tjOXJIZ2c2Vnh1UkpVcVloUmwvdS9vNmJMZHUyRm8rY0hvdjlpTlFSdjlxMUhNSGt3UGtBY0xvQnlQd2tQZG12cXNIRFRjeG9NWWt6OXB4cTY4aGFobW1tbklsbUxja2dWbndac0NZcjBiSnI1eStkTm12ZHpJRWJFNmMzQ3Zzbm1BQVhLWDYrQUJtZG1neWo1V3FrNmtseUhqd0hXODNKZ2Q1UXhibWM2ejlrS01Ea0NYd3VxVU5vMWxIUVh2eU9Pcm4zSktpR1AxcWFEejY5cEE4MXc1ZHVtd2lyaFJrekZxeExoWWI0ekJGRGhnd1pNWFBRb05UVUJUT2F6Wm80Y2RxMGJVdWhkZ3lHN0Fmd2dKNElZQW53b2RGMVIvZVV6cUQ0T0FWVm04ZU1lWTYzSEdJM0p3ZDZrNnJXRXBUS282bHBPaVNmY1lINHlBYS9YN2x5NWRpVlk2UkxSdnRBQ0JhNW9oa01Wb2xXOWltbFpNZVo4VWtEUmhKOG9YWHp4VTJsSFZvTFdlWnYwOFRNTytUUnE4dmNBVHVPeldrTmRNeWFNczVuT29PVUNTVWR6L0lZRU5jWjdHR2xWWTRlYTJtdVpGem1TaEtWek9jYzBiT2g3R3JXWDJlSUNPL0p6U2RhcjVSMk90cVAyc1NxeTlOaEk4WUNOL013SjIrSXhGcXpXaDEzQ1NveFRTanozN0tqNU8wQS9QSDE2K1BuenAyN2NlUHFxcmVnKzQ1VzNYZklvbXNaSzUvdnVDYmorVW1XRHF5Skp2MVJCSlAvTk1GRGJyMTc5eTQ5ZmRjMTBGcWp1UkV5bzBNYlI4MmxkdzJXRzZ2TTJjUVM2cnpXSE9ZdVFIWE1BUHE2TkkrNnFYTWxsbTg4Z3RZOE9INGNTRjY5Q2h4Zm91Nnk4Q05DMWJvTXdueWdFeTRYTWk1bCtHV1grVVY1ZGFlMmxncGY0MENDMTdGanh4NnNqcWpjN3QySktPQWNud09hclpTUkFYK2YyYzVZV3g2bkRtU2EyOHdKelE4OUtsVFdJQXgwV2MxVmxNT21WS0dVV2tNc2tlU2VOMjhlUFhyMEhuUW5RdkFSb0Jxa04yN2NPQXlxZC9rS2lNL0VXWkcxMWZuUzN3dzZWdFN0TWtoKzllcGg5TzdhbGY0T1FSTEh6RmFvdmloNnlzek03REdjaVBaTFQrK1ZuRHcrTDg5NitaZEgvZE5hcDVrWXBhN3JrQ3R6Sm1HZ2t6VkxvbjlIYzFyMFk1VHpPWjFrZWVMNHhiTlgzKzdaQXlSVGdsbUJRTnUyYlF0YlJLaXdzSkNZS3ArK2ZYdjE2am5RNjlmQWxLOExPY21mMWNBbGVYY0J2eUt1TjBINjI3OGY0aGRSZHM4RmtwbVpTREcvRFdvQWlwN3lrU29TSmFETVU2aVJPcjdWNjNBWHpxVzE5UFJ2WGlSeFJXOUFOV2lkakhPcVhKNlRONXF1T1hIeDR0a0RDaVdRSkpBdFFWMGpCQitSS1NGOTlPak5uajF2cjU2N2VCejEralZQdFNLWnhRSitDZEZQOC9VYTl3MG1TSGxyUWNBU1VBNUhTd0pJb05pdVhidE9MUGlFVlBPQktBRTFQRFBzVnd2Z2FBZmpWc2I2RUlKRDVrd1NhWk1DZlhyMGZ0TEVlVDNQeHVpYUUrYzNBTXZzRG9RU1NTTEgxcUNlUGN2THkzZnZoaDk2NGtkZ1NrUURnZmNwQ1BUQTJRMFh6NThBUFFDNTcydlZqUzNMWFhHc2pvdEJjNEZsUDJCSktKRWtjdXpjdWFLaWQrL2VaV1ZsOEdORlJlZk95QlNKRWxETnN6akhhczhrc0NmVkZCbnJmUkNucVVPU3Budmwzc1hFdVhsZkd2UDh4UTBIc3JNN3BBQkxRdGtWVVBZc1g3THk5cVR3eHk5YUg4T1RicS9jRFZDSmFHSGJRQ0FycFVPMjRybW1LWWtxR1M4Vy9CUjVLNUV2L1dmTVhwdzhrbGdPenlTVVJMSjMyZmFEenorVXJqNTE2dXZYcjZkT3JTNzk4SHo5OXJMZVJKU0FaaXAvam1SN2lsTmMybk1MYzI0ZDZ0UWhVWVR3OVZwTG83T21FK2Yybk5rVWpGblUzbUhaVXBHOGZlR0xWWk9JS1BCRW9FSGdtWDJnYU1QNUUwMjlycmxLeGI0ek96dW5PTGxYZWovRHNwMGkrWFRDVjVzbVBGVkUyeG1leXA0Wk1WcVYwcHhUc0E2WnhDbUxrRjVUY2Ria09MZEdPUnF6V3dmTmtsQk9ZbnBXb3J1Qkp3QnRHOGdDbnQyeTIyOUlDMDJ0OGl1VU1YczhHZE93UkpSSG1LU1Y2QkVFYW5pU1BUbmE3YjNLUHE0bEo5TzBGYUdva1ZGREtXdHluRnVpSEkwWmRGaEtsRklYVm9KQk1kNkpaM2I3L21taGdsOEIweGl6aDJHNVhhQzBBZDF1ZVBZZ2UzSzBpMWduY3piM291bGJoQWFCTmZYTFNmWW9Qd0F3MFppQ3BZOUJ3WitLcDhJNXAyQnE1V0d5TVpVdm1hVVBUL0tudHFkWHREZENjOHA5OTdpWU5LTzNsUk54UFVWWnM1RUZwb2x5TXFaZzZlUFBaNFluNGl5YVRORmVlWmhrVEtnOWdxVS9UNmhIWUU4ZDdSbVNwcE1LbTlscFJwWDBocnFrRDQ1OGR4Z0dPbWROQ1JPalhCdFRzUFN6NXhMaWlUaTdVYlJQclR4TU5xWmc2Y2VUN0VuUmJzZkpoV1ZhVEcveXZySW0wSnppYW9oUy9XZnlBaVpFT1JwemlhemkvandwZlZKeFo1eVZnNGtaRTR5NXZ2UnJ2Q3BkRC9ac2s0L1JybkJLbWswc2tiNklDUW1hM1BMZ2ZTaXZwaVJNSGVYeEc1UFRKeFYzeHBrd3pGNElNekZqc2owcDJoRm5MOGJwUzVNalhTNDM1MFcrTzFyUUZEQTV5aFBGU2NtVGNCWlV4cG5kQ1dhc2pQbU41WkU5VmJSRExXSjNTcHFEdlBNbTN6SzBaUVd4MGpkYWM1NVdSaXJLeStPTWNsbmNGYzdKY3dvcUUrWTlGTXdKM2hpL0czbndMSVhGRWlWUER2YUVhSEtPblJqNTdqSkRzNUViNW1TR2ljWk1YQmNvZVJMT0lvNzFCSE9taEtrb1NublpVK0drM0ZtY1Z5bWFzdjQzVnpUcnVtZzJEYVVWL1JUTThJVkp0MjdkbWpUcFF0ZzNlV2FsZEVzd2RlWVZlOEIwZy94a0pHaGFjY0l5UGg2YVRhUGZyVXJ2THZDbk9UV1Uxcjk5dDVTc21EQzMzTHE5Qk5aQVNsRHpsNndNeDhKWkdBaDJTQXhuM3Zoa0FWT285TVBUZzBkNlZ5ajFYbzg5a0sreGNlYjJpNjVFU1U1bDJlYTdGN0pYckkycTMxU1Y5NVVNczBNd1VPZ0pjOHR0QkVrTkl4SThFTkd3Rjg2dUxiZ1N4Vi9PKytYR2hGbjZIRUIyaGlZY2lMcWM4QXhJbjYrT2dUTVRLcEhDS1ZjOWNkQ2NHWG52RTJqS1U2UUNnSm5kQVJmdFhlMHd0Nnlrdm9icUQ2T281VW50SlErSGxyZU91eEp4bkdNNXoyU1ljaUVKS0xFL2pNMDMwZ0Q4MEFtQnJ2YkVpYnNpU0oyekswbHpvS3UxckdnbVJjQ2N3eFZvdDQwbDdoa0pKSnhtQkxUZ0VZbWlROE8yM3hOL0plSTRwM0xPTUFWTFJJbU5kdXkway9ybTV5TlNYSmtlWEczRjJXbEFQdURFMURsYjBqenRTNU5iU0N0Y1RROUJreXVRalV4NHBXS0pJTE95Z3NGZ1NrcEtFSlNWRlZCQXdaL2gySldvSUtFNDcyU0RXWG9RV0FKS0FFbm5ha3J3aEVnQnFBZlA3WmJVeWJ2RitiSy9LV2xDaHdTYm9aRzNnVklsVGJLbWR3WGFRc3RIM041Z3N3M1VqUVFQd0pTQWdqK1pwNnhFRk9zSnhYbVpCYVptU2NkcGVPYWJtOXNkdnNQVGNEeDhVenpMSk03U01wTTZPZGI5YWZvMTVHYlVNdDNOSkxjMUM3MWdFa3RBU1NDejIydGxBMUVFQ3BZbW5tSHZTbFRFNXF4Y25KODZRbHZGZkgyUUJrZVRZNVQ2d1RNZXdSRlAzTldmOGtxZEhPdXlrOEUwYS80Y3pWbE1VMWpUVW9IQ1N3Q21ab2tnaTRyNk95b0NvZ0FVL2RuQ25pTjI2MWlQeDV4NU9zNEhRSnhMZzFXQU1ZbGxMb0JNN3dVYWljS0hkRUNhU3p6Qm5oWGJWOXRTcDQ3MUtKcjEzVFRuTTAyLzl1WTBRWE1xV1pNV1IrVzJLRWVZaW1WUi84bHBhV2x6dE5MU0ppTlFhSVlTVDVVOXBhOExoVG45ckduaWZMMkFxWTFKTE5ON2pVeE9UaTR1SG84cUxvYm5rYjNTaWFleXA0ejI5U2JXalRtWjVsalpzNVEwMWF1akkxK2RSelNwODg2ckk3YW1QY3FEaG1Vb0ZDcVlxbFVRQ2lGUTlLZHBpSmFIWmF5ek9lT3dKc1Y1cVlTcGpObFJzU3lHcXpGNUdVcDVPVG5qaXhYUGptaFBqVlBHZXBRNUhacmpmR25hejM4MzEzSmU1VGpYMXR3dFlWS1VBMHhnbVpZV2NwMU5MRWVnNEUvZ0dmU0k5bkxIbktINHJFbHhMbUVxWTQ0aGxxNnpIaUNLUE1lZ1BiMXdkbUp6UnZYVEYvblJsSzEzZTFJb1VDV0lyQ2xnbWlodlR5eVhWMkZ4bWtDZWdGTkZlL25IeXBreng3Rm1tUjJtTWlhekZEekpuaDQ0eXh4ejV0Z1JzZUdxUjlOc0tteHNYWm91RHptcm95V3VBcVJoMHFHRVpNbit4SERYMGQ0Vi94QnB6aUJuemdTdHlUREptSWFsNURrZTdTbHhTbk42aCs4OFFWTXNwdVJCaGdsMFFLRldSeGNzQlRsQVVjN251WGFlbEQzMXhqVHNaYzdROHAvTW1qMHMxbHhkeGpENUFOTGp6Smh4YmovbFpjNmZvcGtVNzBGR2dTcm9samhIRExvTDVMTTFMS0RzaVRoVjZwVG14QTJSQ0hVYkNpOXJIcWxnbU1LWXdwNEdaNmVLOVY3bXpNbGdtcTdyQ1QvWXU1WVZKNklnR3RTTmo0WGdJdUlMUkhDaCtNTHhBVDVRMFlpUEFSMVFVWW5pMjBVaTZxWkpRQkhSTEdZaEFSZVNqYm9jeHZXTVcvMHp1MjduOXVuT3VaZnFtODZNbVdoL1FFT2YxRGxWdDZyT3pVZUw1dnFONmlCakxkRE1FbjNQTTRkbzlzRmtsck42M2tWRHIwSEJtVkQ5WkFHaXg4Y2dvNXFkUVo3dnpvQ3B2Z1Z3RG5LOVk0SXpQaEFKMVQxbzNnT2FnWU1NRUgyUmVGNm8zUXUybXhnWE9LT0I0Q1NxcTBSSGFFSTBkeENZT3B5aUdEMEt6bTBIRXFvRHpiWFhQU1Y1d0NDRGlNNDhMOUlBUXRYcWxzN0k1Q0ZRWFNkNkhGTDVpT3JHb25uczZDV0FXUWpPUzBkajZXd3U5SnYyVmpsM24wNnBqZ1BPSGRyZklEVDFRWWFmNkxQZ3VTNTN5WnY2Y0c0WkRQTnZLZFZWTkZPaWYyYWVtNGdDbURxY3g4SDFESnFmVTZwbjBieFFITTJIZmpUcktkRWpDazNMYy9CVDBjNUVPaEdjb1ByV1lsU3YzVGcwNHlMNkc3UjZhMEdOS01QMUx0QUUxV2NPM1hoQ2FISXJnOFpDcS9Oam9XU25Td1labHA5OW9sT3BTVHhYSGl1ZFZMbEdhVmF2NjdMSlJKZlFUSGsrRmRBa0ZhNmI0RXpSQk5VVDRkeWtOWWFVSWRzSG9KbktKaE05Q3V2ejhvRy80Y2pxOGN2cUJXUlRBT2c0UWhOOTNtSndDdGNSbkVDekErRU1RWk10QkJiTk5RbWFrTTJ0ZTJienFva1VCSElXa1U0Ym5CRm45VjJuOE5Ob3NybmdDazNtdWM1MUJHYzZIdTVDT0FQUVZFZVdmdGxzaUdvaUJRVUg1eURWWDR0dzd0cXJWWnhUYnRuODJRd01UVVI2RXB6Tm40SW1DMmQ1TkYvbURBZDF0MnpPRzlWRUNnb0xUcWI2RHhGT1NrT3FiQ0lMVHlNMFE0TnoyN1EwU2dWTkZzNmgwRHpyUTFPQ3lTV2JzellKY3dyU2c5TkI5ZHZtMTFIVDBCbUxab2ZRaklVdUxEUWh3NEltQzZlZ1dhczhLWUVtajlPUmhMZzhvck5nc1NySlJmVUcwcENDWnYvclNUWVB4RjlQb2FrSHA0MzFWajZwMlYrbjh1UzVncWF5bkhBVmFDYmpOWHc4RXoxOFhaQ29UbWxJaXlWSlFySE80VmxJTXZxTVpBMTZGQjIrSWpvc3dqbnd3dWx0U1ZJZkJzM0xQalNyYVNoRlRwa0RNY09wZmpzdkhRaDJQYVUzZjFFb3hiSVpSblM4VUlLOW0zM2hyMmFhMUY4TmdlYjU3RDBnR0tkYk5DV2wvOGgrKytKMkk1dlg3Z1lTUFZja3pEdmVxS0tacFBUbWZiZHNWa0lmQ0dldThkRk1rbm9ZbXZyaVROWDk3YStIazAyYysxRnk0VFNBczZWZUlHWFJiR215R1M3RUZzMGJwZEc4VEdqS2ZJMTRXUXBOMW80SUpWS1JVM3FMdjkyVWg1V1JwS0dXTFRnRnpVOGpaUHJUZnJtNVBUdkUrRzFxZCtTTW9FZFJZaDFOMlVyb0VacWhTUWpSenRyUmsvNjdRYk9tb2hteWNBZzAzek9hUXprQVVDVXN1dEdzQnhidk9wckJTdHlEZGhDYVpVNlcxZjBXelFaVmh5TkZjeDVkcEZBMGI1bHo1Yjd5YU9JeDUzNmd5ZjFOdFNQSC9jMS9QRGJQV1RTVnVSQjFpeCs3MGZ5dm0wQlRtd0RyYzZFVmt0TVBMMlZPbjl1Z2JNN3d6UEtqZTJhNU11ck4zcExXbTNQS3hxRjJEd1dNZ2YvUFFvS200aUlJMlBXb3FpbzNCdWYwN2xLZTArZG9nWU04d0xRNDY5NURHdDhlMGtLdTlUNTBENm1tOVpDQTVqM1ZKVjFnUjY3dDcyK2VXUG45VFRQSzhQYzNCYzEzcmtSOUJHZ0c3VysyZmIzM0xaUFFlemRFeDYvRHZYZWcrVkJIVTk4dHJycm5RdEdreklVTTBRZlJmSkJGRThkRjU1QWNENjBzOGJHcDZwNVpmaHYxekhMNzM1aFozaHdnT3M4c0JVMWxkT1ozdUxEN3F2ckZ6dE5mVDlvODNTNTdnT2c4VDU5NmJ0RTg3eDMyc0RQd3FxOGxWMm1QNGE3SHNaSzdIcnlJeExKcHgwTHZYdER0VXVSRXBhR2xkNjJyL1hTQzk1Q3dKT2VXelFxaHlleFZWZzd6QzV6VnI4dXdJemRiZGtldUc3d2poNzBaaENidnlNa2dneHR5bTZraFJ6Y0RPUE8vQ09kazcyL3VJRjlHQjdJcGFGSU5TUTA1Tm1YNHovVHR0NU85VzJ4NWpoOEdzam4xaWdIaUZoSVhuUDdPY3Z2clN0aDdiejBZY3U4ZENSM0hTcnYzenVUbFMxTFVFdWtSQ2dCRDliZEZQQm1WNWZaa1BCaXhKd001YU9lMHRWOXRmUFdPRWdzZjA3bEVPczlKM2ZvSTJ0OFZ2eEFzTGlYOVF2dkh4QzhVdjBVRW1LYTZyc1NpSi9VN2dpYUU4K3RiMWNzbTV0LzY4bm5aWE1IWjYyUzliTUNUc1N6Z1pkc1hkNHJObnZhNlZjNXlrdytXM0M5R0Z3bkNDYXE3Zkphd0JoYjFXVzVkSHA4bHZJSHNDOVI4bGpZSHNlVWNsMHVnM0ZTN1NKc2huSmJxSGc4d2JLdmo1Z0dHYjVVOXEzNFA4UDJjUVowYndPd0wxTk9RQ0NlRVFhak8vblMyVkY5TDhCd1BmM3JpcWU0RENvN2ZOSDVxdnorOW03czhZUlB1TWxYdVNDRTB5V3BwYjRjVk9QbnVCTGI3bnhJOHRic1REbzd5N2dRZm5FZXQzOTllbmxDelZ5ZFlyei9kbmVDODJBTzNGcC8xcDNUOW54MHVabTh1RnVWMDN1c0JPTDMzZXV6L1MvZDZtTHNvWnRLTFBmNHdkOTR0VGtSUkZNZHV4TjZTQVVVRkVhSVJiRkZCc0JEamlnMWo3SXFSMkh2RnN2YmVDL2JlUlZFUVVjUS9GRkVDZmk3dmZXWE9KRGVUbHlaNmJCdEJXWDg1NTcyWnQrTTlpL3l4SGdzbzVIcnNUTGtwUGpjeGRBWkJ4eWJrb29uV2tSMmx0L1ZCTTdkV21qbXpZZUJ3T1hObWhaNDVNOTgxYzJaM3MyZk9uTjAyek14SkdZcWhNNk14Y21hb21wRVNQbk1HQTVFUWRONVYzRnU2eG8vYmVtaHZ5Y1IzREoyUk9IL3RyakFQYWNTL21JZWtaL2dFQmlKTkRJeEQwdk43d3VjaDRXQVBRWStKVFFoYnVteHJ3bEU5ZG5VYmRUR3I2Mm1GV1YyVFNtWjFFY3UvT3FzTFkyZWduSmt2TlFIRHVnS2p1aWFZMlZMS21ISS8xOWJrbk11ZzQ4dS9GWnJFd3BveXNBOFZ6NUhiRURKSGpuaGlqaHhKelpFamxuOXhqaHorMDcrY2ZXYUFrc3dZT1l0U3pqMlRjK1NLMEhSZkxaWk5PWEljVVpjSEgvekFoekNueGJtNzBvekR3Y1V6RG9sbDZJekRyUTNQT0p5THBWUE01VE5BMVpCRC9rNGZhWlJWelRpVVFYY3ZtM0plRjZJT2N6WXdmNU1VUG4vellvUHpON0YwbHVOSmVmY0hjRTcyeDI5U3hwbWxIc2I3TzN6K1puaEh4aDZ4YklwckpObkE2TUdjcnRtdzRFbjdFVWJEbXZhbVVaVm53MDZxZXphc0dHY3FobkQ2dzJFeEd0Wk0yR2VhR0xHTjJiQm1Tam1zS1V2V1VtTFpMSHVObEF3MVp3MXppOS92TDVsYi9HNXIwK2NXdTBmdFl0cnU5WnM4dUhqc3RyRUU4dnJYSENaRkU4eUtjNHQ3b3Y4dlZzV3lLVnNEcHdsem9yR0pjVHBtYWdQcHNtWHZTSTNNMUc1OEREUjBNSmU3bjh2cHBSSTB5OExFb2huWWc3eUNhOWwwTjFyQ25Qem56RTcwSDgxN0Z5UEtxeE5vVnByM2poWXhXQk5CRjh1bXEyMFY1alJaeDA3VS9DNkMxbEJpNkExemRSR2N6ZFVOVTNZUm9QVUtleENDam1XemJOVFJCQ3pOV1pKMTRHeGFUMFlwektocGNlMFJrSzYwaTRiMFpOUlhPZ0pqaXA0TVdJeHZ1V1YvT3BiTlNpM1ZjV0ZPazNXQnM1a2RMdEVnU0lLb0M0WlpKWDJMaEZVemxSMHVrMnRKKzIvNkZ0cmhVdG9XV0xLYnhHVUpjRzN0dFZnNmdiT1JmcUdMb2wvSWNHU1FoQkRsMXlWZG9Fd1dUSXZLbXVaeTJtKzZlY3ErTzlrdmhKekxEWDJLTEtnTzM0ZFNCWmwxTEozQVdYLzMxVlBaZlJXTlVxd1Z4OTZtY0p2VVZxZy9rd1hUUHV2R0JZckVhazg3eHNLait3b3dkYzVsby9KbVVaNWVxYll4SWJPT3BSTTQ2KzFsT3lsNzJWcGJxWEZWR1pLOXFDbXFtdjFnZnpKLzYyV1pkbFZNKys3YVJjM1NwdVN1emw0MlltbFNQbExDUkFPdzNJTVFWcWxvQlhOaTZReTRjOFg4Wm5VRzNuMUNqY0M5dTRDamJhcTJKZURCZm04RjF2ZnA4YmNiTis2YXFtZTkxdHNaU0N4RloyQWZDeE01UjlCbituc1FsbSszT2VYU3lUaWpHdWU4OVdUUG12c3NUOG8reXlmUDdqeitkb05JZ2lNakpIV1FvdC9WVUEzVHJsMnZIbi9MSmVpTGtYYk44MHZPbmZFdmZ2OGlwUnp0dGR6K2EyQ0tuSXM5eUczT2VDRms2ZXdmcVA2ZXgybHZxR3VWWVI0OSt2Z3hOWCsvVkNRdHgwREZmenRmNWplQ1RCWFEva1NVV3VWTHVsWlZRYWk3R3RUdkJnMTJyYTdidGJGM1B4OW1lV3ZLY21xM09YRUt6emo5V25xa3ZmWWVZRGFtL2ZyUjBhTkhINzE1UTEzL2JUVkp5NUVaUm95Nkc1bVhGcXRpeWtDSktIWFFuK2VhL3FJZTRDRzZVVG1rQi9qNldXVkw5TllpNWVzSUpqMHFBNWhsclltTFRiYzUwNFZpSmRKcUp5SXo2TFQzREtaOWhPV3BnS3FPNm5mQnUzUHVxTjVkMUZGdFdUNTY5ZWJBaXhlM3IzUTJKQUd5ZXllVzU2VXo4WVdiVjJaVDhlVHk5RjdQNDkvc0RxWUVWRnYwM1BidFZPaC82SkRmVVQxZ0xqcXFqM3o1dVNTWG81THErM1NudnVUbmw1dm9xSjQ3d0hZcTI1U1BJNVp2L1VaL3dKVFdSTkJyTm1kQzdVUmtCbFAwYis4eTJaNktwK2hQNS9yMDNkeWZUaHh0ZjdwWkw5VldUaWhmSFRoQUtLL2N1bXhJK2h5OXpNcFZXNlpOMlZrbzFiRTFhMCtrMHA1aHlrU05SUjh5VURJbzk2ZWJJb3lpL3ZSdFk3VzJGZmVuMno1NllxbFR6aXl2ZHQxT3h1d1dCaFBXeEI3a01LZkV5WCtMVFR2YnM0KzFwODl6VXFEYmY3am85aWVTYkV1VjhVdlhGTW9EbjU4VHluc2R0U2NWU0c5MTZrUnNlc0doNmJGTkM5TWVFMVVlTlVDTlFabm55S0c2a0g2QzZQYW5GNXFrcmFKSEZ6MjNodTg2OUxicjl1M2FtQnFtekxtd3BzT2N5RG8wN1ZUM2lFazcyOVBuMmRwcWVHcWdUSlNSS2pGRTVrZ2dtU1NocEZyL1M5ZUlaVEZLN1VrdnZpbFJxRUd4SFdSU3RxZ0JTankxUVMrTStXRU15a1M1b0lrMW1TQ3k1czVWSkkwdEZ4QkxEcmxoeWNZODkxQWJNOUo5WnI1UUx1ZXdabFhtRkZsbnJkbUx0SmZ3ZkhLVWF1a1ZVRXVVbVZvTllwQk04dE4zWXZtS0ZrdEdTU3p2M1dNREtGTjY2YzM1UXUxS25NaVFSUzFRR1BRMUc1U0FNbEZHeXBwQUVFbkVVWkUwdHB6TkxHY0VXRzZua0J0akxwOVZLTkVjazNOWTAyMU9aTDNNZGFlMnArWko2MmRVRjlNL2VVWkFyL2xFdVovSjF5UmVLUlhKYTY5ZXZYbkR0bFFvTzlwOGU2bFlvWDdGRnA1U1FJVkJ4eXpRUkprcGF6ei94QnlaSkx1U2JNa1puNkgySHMyU2phbFlScER5TWpudjM2VXZXOU5wVG1TOVBNNklzU2Q0OW9sR2lhY0dhb2t5VTRoQk1zbkhoSkwybmVkWHJsd0d5bE10aVVLak9yeURIV29OK3NFM3FDSktTQWtxYVNqOUlJd0VVcEZVdHFUbmt3Z2xzVlNiVHlEa25USTROb0kxVGM3MWVZZFRPRGhobkdza1RrL1pFenk3RU5DUEgxdGI2VVNYZ1JKUjBqWFdKVi8wNHRXang0U1NyNGJNWW1sZHVYQkxvVG1LcGNzWjlORHJDL1N3RERFbFRadzQ4UWVKT1NxU2l4WlBYYmZPb2p3T2xpcmtIb3pwenJrNzY5aUpwRDJEUEFtb0lrb2lxSnJvTTJMNkNGSWs5WVdsajdLZDJuVWFDYmcwNkVKcFVIMVJUOWVoc3k5b3ZhYlhKTHEzNTlNU29PU04zTEJFeUNWTURxYkl1VHZyMklrRXp0WGdhZS9zbUdqdjNuU1VTMVR2QlBTWVJDUnZNRW1nMUxaYzdrRFpzRUdKcHdINm12a1o3U0t0VTZJUDZMVkIyVGJJTXJNbERLYk11VHZySVRzUjRnNmVmR2RuanNqMGNlNDMxbzBiOUYzcEJjbVFES0k4OVdDYW0wM2pLNmdGZXY3cTFhdHYzL284MVM4TTh2anhmb1N5TGFNRXk3MnhnZ09teUxrYnA5eUpKRSsyZ0NGcTlKS3d2clM2L2ZJMmdiUWtmWlJlZGt2aEx5cTJGd1psb0oyWjZIYjZ2SzcyT3g2UWY1RGFxek9qMUN6bGdpbGhjczVoemRwMm92UytVSjY0czdQbmpvU1Z4QWU3V3UySlk3ZDdsaVN1aHY2eVluRVlWSDF5RC8walVTc2NwQnFVbXVYcVdNRU5Fem12ZFNlS2RGbzl4N0ZHYWFMbVNCZUh2RGhiODBuV3VPOU1tWlhJcjEyMXB5V2JYZGx5WXRPcXBVdnorNlpYRFpSNTR1M1dDU0ttUnZ4KzJ3TkFyRCtac00vdWRDb0lFem12ZFNkcUUrbCtLdXlma0ZqcDZjTUhqZFNJQUZxMUNaNEplY25xTHl5bjV6ZGxrOGxPV3QxWm5Zd3k4WlZuOHJPcXU2alhRSEY4eDB4OWRkTWdnK3RQNktjM0o5MHBVaDlNTEowNFJ3bW5zR1Z6MmhMRmVhNkZhRGl5SjVjL3lGY0xjbWxMS3FrWjhsOEw0YThqcHNuTmF3cHU1YlBpN2U1b3hCOGpOUWhOU01vamJlcUVDWnc0NDB0VU5NSEtqS2YrK1pHZ2pLRzhkS3BsNmJTcVBabE5LbzU0Y3d5RzRqZEpNYzNFTjFWQjlQRG12UjZPUkNHRXhyV1V6ekVwcnhNbWNPTDhPVE9sVUZHelltYzJwNWFmOGp4enlMdWFUbmxUQy9mRWtFazN5UmJLdGdHcEVKclZtQ09xUDRDak5GSHk2TXBxTExwbFQrcVVKOTV1SFJvdjNpSXVNSVF4VmNvQnN4NmN0SGIyNjA4NHpkbFVsV3Zlc1gxemRwNHUxS3pwTzVMR2szS1ZNNWNIV3RqYW1DaGJOTXRBM2NxZjJKRmNUVXl0dk5YSjdCN3RTWWN4Y2F3TG1QWGc3TjNGNEVUYS80Wm1aYTBweFE3Y3RsaTkvSzlwV3FJTU5GbDlBbmJPbVRKcldtTE5sRGs0MW5jYTA2WWNYLyt1UjFGNkRpZTRGNlgvQ3M5WkxRYWw5cVFDaWF2RHJrWENWYUltYW9BU3p5eUFOazl6NHNxWVNEa3UydXRSSCt4Rit2NDEwWFNXQVpUNG9pNGVrQ0gxdGxLdjFCME1pQ3FnTUdoeldScGpJdVVDWnYxN2tlSzVNTkZNbEhRcFpGSGlEclUvY2JUUEdiRjZHUEhIOWptbGZwcW9BV29OdXJJcFFMRmdSbUJNa2ZMNjl5S1Zkc3N6bFdnU3lvWEtsa0RKSkJrbGdjU0RoYVNvbHZwWVBjL0pUQTFSQmhvMGFMeEpQS2RvbGpBbVV0NG9UcFgyNXZLY3RSa0pOeWcxeVM1TUVnOFRDdUh4VGlKcWdCWWJ0R1Y2NHl6alBrc1lFekFiVVZRdm5rVThsLzlwMzQ1WkV3YWlPSUJMRjF1b0VDelVmZ1hCMVZuRWxJQmJ5UklrT0NRdTZwQWgwS2xRT3ZSNzkxN3VIdjg3SDRMR1Mwd2gvdzR0blI2Lzl5NllaM0tUWng0NUYwdFFzdVFsVlpHb0JoVURXcXk5V2NyQjlIVGFYYy8zbWdPYS94WWZRL2RpQ2NwcUpxL3BNNEZpUUgxY1FSZnhxYVhId2NScFAvR3NBNXB2WTVLMHBsS1BKU2hySEp4ekF6cVB3K3NwZnhRbDl1Qms2WFV3VWJUcnlhQ2J3L0t5T21kSnlwSk1pUk11S1dzUDZJZ0hsRUNMOEVwS09qVENFcFUxNW9rSE5EYWJvc3pPbHgwZXQ0ZXBnb1FrVVRvWHkxc0xEc1NBQW5RYUplRUZra2tNeWtZdHBTZEtadEdoTXAybVpiTEx2cGE1dW5NN3ZpWGJmUm1sOGR3NFBqbVNMaVU5NElENEdWQ0FxdUxtcTJnWG5vWE05cFVrS0J1MmxKNE1xa1d4ZCtSZ3k0dkZKeVJCS1U2NHJ3RUZLRWdQWlpMTjFxRzZSZi8rWElUNThwaVU2V3FLVTRQUHZRMWJ3cE5IQURXcnVOdGg3SGlkM1Jvay9WUEtBWDNFWmdTa0lucHJKYTQveGxJZW1VWTh4d3lLYjFZTUtvSmxOME5DMGl1bEhGQUdSVzBuelViTGNXcHN5allzNGNrbHU0LzlqMmlmeXhsVlA4NUxGSkFFWlRQVkFSVHRsdDNHcWJGWEJFVFpocVVzbVVWcDdhaFJFYU9JRjN4c3lVWnJEV3hRbTVSRGdoUnl4QUlRbERVNjdRTzBFc1hiVXRxVklsOCthMGNTb054dWtJcHVpMVBUT3FXOFZlWVZHYUdxdk9vODYyQzNCc21Xd3NXQmxHSytTa2ZMQ1pJbDcwRXBSWFhaaEdwblRCRXY3YllaZmdYV3RCdk5mdEMvMEcwdEdRdzZrSWsycGNMdDBEL3U1WWphaU5Sc1JNblV6ZGhBZGtYU01aMEVUaVlxZzI0azRDUGs1djdkL3E5QnQxOVU5RitkNlhhZlBuMzY5T2x6YS80QUhUTUs5Y2xobllBQUFBQUFTVVZPUks1Q1lJST1cIlxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vYXNzZXRzL2ltZy9lbnRlci12ci1idXR0b24tYmFja2dyb3VuZC5wbmdcbi8vIG1vZHVsZSBpZCA9IDE1MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IFwiZGF0YTppbWFnZS9qcGVnO2Jhc2U2NCwvOWovNFFBWVJYaHBaZ0FBU1VrcUFBZ0FBQUFBQUFBQUFBQUFBUC9zQUJGRWRXTnJlUUFCQUFRQUFBQlZBQUQvN2dBT1FXUnZZbVVBWk1BQUFBQUIvOXNBaEFBQ0FRRUJBUUVDQVFFQ0F3SUJBZ01EQWdJQ0FnTURBd01EQXdNREJRTUVCQVFFQXdVRkJRWUdCZ1VGQndjSUNBY0hDZ29LQ2dvTURBd01EQXdNREF3TUFRSUNBZ1FEQkFjRkJRY0tDQWNJQ2d3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBei93QUFSQ0FGWUJEc0RBUkVBQWhFQkF4RUIvOFFBNkFBQUF3RUFBZ01CQVFBQUFBQUFBQUFBQUFFQ0F3Z0pCQVlIQlFvQkFRRUJBQU1CQVFFQUFBQUFBQUFBQUFBQkFnTUVCUVlIQ0JBQUFRTUNBd2NDQWdVR0Jnb01DZ1lMQVFBQ0F3UUZFUklHSVRGQlVSTUhDR0VKY1JTQmthRWlGZEV5UWxJakNyRmlrOU1rRnZEQmNwTFNNNVRVRnhqaDhZSlRjNE9qUkNWRmhaV2lRelJVeERWVmRWWVp3blNFeGRVYXNtT3p3K09rWmVVbVJsY1JBUUFDQVFJREJBWUdDQU1HQlFNRkFRQUJFUUlTQXlFVEJERkJVUVZoY1pHaDBRYUJzY0VpVWhUdzRUSkNraFVXQjJJalUvRnlvdEl6azRMQ1F5UlZZMVFJc25QVE5FUWwvOW9BREFNQkFBSVJBeEVBUHdEK2Y5QUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQVlGQVlGQThwUkxHVW9XTXBRc1pTaFl5bEN4bEtGaktVTEdVb1dNaUZqSWhZeUlXTWlGakloWjVRaFl5aEN4bENGaktFTEdVSVdXUkN4a1FzWkVMR1JDeGtRc1pTaFl5bEN4bEtGaktVTEdVb1dNcFFzWlNoWXlsQ3l3S0tNQ2dFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQmdVRHlsRXNaU2hZeWxDeGtRczhxRmpLRUxBYUZVc1pQUkN6eWVpRmdNS0Zua0tKWjlOeUZqcE9RcytrVUxIUlFzZEZDeDBrU3gwa0xQcERpaFk2UVFzZElJV09rRUIwZ2dmVGJ4UUhUYWdPbTFBZE1jRUIwL2lnT244VUIwL2lnT20zaWdPbTFBZE5xQmRJSURwQkFkSUlEcEJDeDBnaFpkSkN4MGtMSFNSYkhSUXNkSW9XWFNLRmpwbEN5TEhENElXTXBRc3NwNUl0akw2SVdXVDBRc1pRaFl5aFJiR1ZDeXlJV01wUXNaU2hZeWxDeGdVVWtBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VCZ1VEeWxDeGxLSll5SVdlVUlXTW81S3BaNWZSQ3p5bEVzK201Q3o2UlFzZEZDejZRNG9sanBCQSttMUFDTUlIMHh5UVBwK2lxV01ub2haNVNoWXlvV01pRmpLRUxQS0VMR1VJbGpLRUxHQVFHWDBRc1pmUkN4bDlFTEdYMFFzOHZvaFl5bEVzWlNoWXlsQ3hsS0ZqS1VMR1VvV01wUXNaU2hZeWxDeGxLRmpLVUxHVW9XTXBSYkxMNklXTXZvaFl5K2lGakw2SVdNdm9oWXloQ3hsQ0ZqS0VMTEtFV3hsQ0ZqSWhZeWxDeXlZNzBMR1QwUXN1bU9TTFk2WTVLQmRNY1VDNlFRSFNDQmRKQ3dZaWkyUmlLRmtXRUlXTXBRc2kzbUVXeXloQ3hsQ2kyV1JDeGxLRmpLVVd5d0tBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUVBBb1dNcFJMUEtoWXloQ3p5K2lxV01wUXN3d2xFc3hHVUxNUklXWWlDSlppTUJBd3dja0R5ZWlwWjVTaVdNaUZqS0VMUEtFU3hnT1NCNWZSQ3hnVUxHVW9saktVTFBLVUxHUkN6Nlo5VUxBaktGbjBqeVZTd0lUeVFzK2k3MFFzK2lVU3o2UE1vV09paFk2STVvV09pT2FGam9qbWhaOUVJV09pRUxIUmJ5UXNkRnZKRXNkRnZKQ3o2STVKUlk2STVKUlk2UTVJV2ZTSEpDeTZRNUlXT2lPU1VXT2lPU1VXWFJieVFzZEZ2SkN4MFFpMk9pRUxIUkNGbDBSelFzZEVjMExIUkNGam9vV1hSUE5DeDBTaTJYUmR5UXNqQ2VTRmpwSGtoWmRQNHFMWmRNb1dNaUZqS1VMTEtVTEdVb1dNQ2lsbDlFTEdBUUdVSXRsbENGaktoWkZoUXNpejBVVUZnK0NCR01JRjBrTExwRkZzdW1VTExLVUxMS1VXeGw5RUxMS0ZGc1pRaFpaVUxHVW90a2dFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFRHdLQXlsRXM4b1FzQm9WU3p5bEN6RENVUzFDSW9XWWlSRHlCQXd3Y0FnWVo2S3BaNVNoWXlvV2VVSVdNQWlHQnlRR1VvV01wUkxQSWhaNUVMUHBIa3FsbUluSVdmUlBORXMraU9hRm4wUWhaaUZ2SkVzZElja0xNUmhDejZhcVdmVC9zd1NqVUJHU2lXZlJkeUtVV1loS1VhaDBEeVNpejZId1JMTVFvV2ZSSE5Vc2RCRXNkRkN6NkxmVkN4MFcrcUZqb0JDeDBBaFk2SVFzK2tPU0ZqcERraFk2TGVTRmpvdDVJbG4wZ2haZEZ2SkN4MFc4a1d4MGh5UXNkRWNrTExvaEN4MEFoWTZEVUxIUmI2b1dPaUVMTG9JV09naFk2STVxTFpkQkN5TUJRc3VnZVNMWkdFOGtvMURwTzVGS0xJeGxGc3VtbEdvZE5Gc2pHT1NoWmRJY2tMTG90NUl0Z3doQ3k2S0ZsMGloWmRJOGtXMDlQMFJiSXN3VUxHVkN5eWxDeGdVV3lJNW9EQUlXV1VJdGpLaFl5bEN5eWVpRmtXRGtvcGROcUJHSUlXa3hGRnNpd2hDeXdLTFpZQkFaUW90bGxLRmpBb3BJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFZRW9IbEtKWjVVTEdVS3BaaHBRc3d3bEVzeEdVTFVJa1F3d0lHR0RnRUZaU3FsaktoWjVRaFlSRHdLQXlsRXM4aUZtSXp5VkxNUkhraVdvUWxFc3hEektGbUltb1dZaUhKRXN4SDZJV1lZcWxtSXloWmlJOGtTMUNFb2xtSWZWQ3pFSStLcVdZaEhKQ3o2VGVTRm1JZ0VTeDB3aFpobkpDenlJbGdSNDhFTFBwSGtoWmlGM0pVc2RGM0pFcytpZWFGbUlEeFFzK2dpV1BsMG9zZEJDekZPbEZqNWYwS1VhaDh2NkZLTlErWENVbW8vbHdsR29DbjlFbzFIOHQ2SlJxSHkzb3JScUh5dzVKU2FoOHQ2S1V1b2ZMZWlVYWlOUGh3U2pVUGx3bEdvdmx3bEdvZkwraFNsMUQ1ZjBLVWFnYWRLTEw1ZEN4OHVsRmpvSVdYUWNpMlJoS0ZsMFhja0xCaVBKUmJMcEhraFpkTkN4a1JiSXNIRkN5NllRc2RJRkN5NlE1SXRrWVFoWkdFSXRrWVNvV2t3bmtpMlJpUEpDeTZaUmJMSWhaR1BIZ290cE1RUEJGc2pFT0NGa1lUd1FzakVVV3lNUjVJV1JqVVd5eW9XV1VvV01DaWxnRUJsQ0xaWlVMTEtVTEl0SEVLS1JqQlFTWXVTRmtZeUVXeXlsQ3lJUEZGTEtFTEdWUmJMS1VMTEFvb1FDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQmhwUkxQS0VMTUFEY3FnRFNVTFVHWW9sbUlrUzFDTUlHR0RnRUR5bFZMUEtoWjVRaFl3Q0llQlFHVW9sbmxRc3d6MFZTMUNKM3dRdFFoNWxFc3hFMUMxQm5JSWxtR0twWmhpRnFFSlBCRXN4Q1VTejZQTW9Xb1FoVkxNUkRraFo5TUlsbUdJV1lZaVdZaVBKQ3pFVGxVdFFoS0ZtSUVTekVBNUlXb1UrUEJLVFVZcHp5VnBOUmluUEpLVFVZcHlsR3RRcGlkeVVtcy9sVHlWbzFtS1VwU2F6RktsSnFNVXdDVWFqRk0zaWxHcVQrWEg5Z1ZTMWZMdDVGS1RVUGwyOGlsR29mTGprbEdvZkwraFNqVVlnOUVvMUgwUFJLVFVPaDZKUnFIeTQ1SlJxSHk0NUpScU1VNUcwQktOUTZEdVNVYWlOUHpDVWFoOHVPU1VhaDh1T1NVYWgwUFJLTlJkRDBTalVYeS9vVXBkUStYOUNsR29mTGprbEdvZkx0NUZLTlJHbmJ5U2pVUnAyOFZLV3lOTTNnbExxSTB3U2pVWHl2b2xMcUkwcENVYXkrVlBKU2wxcE5PVW8xa2FjL0ZLWFdYeTVTbDFFYWZIZ2xHb2pUNGJ3cFM2a21BSXRrWUVMU1lTRVd5TVR1U0ZrWXp4Q2kyV1JDeUxBVVd5NllRc2pDT1NMYVRDT0NGa1llUlVXeU1KNElXa3hFY0VXeUxFV3lMRVcwbU1jUW9Xa3hCRnNqRWVDRnBNWjRoRklzVVd5eW9XV1VvV01DaWxnRUJsQ0xaWlVMSXM5RUxJc0NpcE1hQkdKRnRKWVFoWllFSXBFQTcwQmxDaTJSYVVMSkZDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFHQktCaHBSTFBLRUxNRGtxaGhwUkxNUjRvV29SNElpZzBCQXcwcXBaaHZOQ3pBQVJBZ2VVb2xubFFzd3prRlMxQ0ozSkVzeER6S0phaEUwSVdvTUEzQkVzd3hWTE1NUXRRaUozQkV0UWhLSlppRWZGVkxVSWdPQ0ZxRE1FU3pERVN6RVpPNElXb1JGVkxNUW9Xb1FCRXN4QjZiVXBOU2hBZDJDdEpxVUlEOUNVbXRRcHlTbEpyVTJtOUZhVFdvVTNOS1RVWXAyaEtUVW9RTlZTMUNEMFJMVUlUdUFTalVZcDNjQjlpVW1wWHl6MWFOUmlsZWxKck1VampzU2sxcUZHZUtVYXpGRmlyU2ExQ2lQSktUV29VU1Vtc3hSamlsR28vazI4RXBOWi9KaEtOWi9LTjVLMG1vZktNNWZZbEdvL2xHcFJySHlZNUpSckh5WTVKUnJQNVhEZ2xKcU1Vb1BCS05SL0tlaVVhaDhuNkpTYWg4cDZKUzZpTktCd1NqVVJwY2VDVWFpK1RISktYV1BreHlTaldEUnQ0aEtOWkdqWnlTalVScEduZ2xMcUh5WVVvMWthTnVDVWEwL0pwUzZ5TkVsR3RKb2p5U2wxcE5HcFM2eU5HZUNVdXNqU09TbDFwTks0SlJxSTB6OEVwZFJHblBMN0ZLTlNURGp3U2wxRVlCeVJiU1lHb3RwTk9DcFJxU2FiYWxMcVNhYjBTbDFwTlB0VXBkWkdBL3dDMmxMcVNZUFJLWFVrd2VpbExxU1lFV3lNQkNMWkdJb1drc1BFSXRrV0JRc2pHQ2kya3dqa2kya3dvV2t3bjRxTGFUR1J3UmJJc1JiU1dLTFpHTWNRaGFURU9DTFpHSThFVzBtTThrTElzVVd5eW9XV0JDS1NBTFFVTEl0NUl0a1FlS2lrV3RLQ1hSOHRxQ1N6QkZ0SmFRaTJNT2FCRm9VV3l5bEN5UlFnRUFnRUFnRUFnRUFnRUFnRUFBVHVRTU41b2xubENxV1lCTzVBdzA4VVMxQ1Ard29Xb1JoRU1OSEFJS0RTcWxqS0VMTkVOQVpTaVdZYUVMVUdFN2dxaWhFZUtKYWhHMElXb041QkVzdzNtcWxxRFBSRXRRaVB3UkxVSVJ4VkxVSWh5UkxVR1lJbG1HSVdZajVCRXRRaVAwS3BaaUZFdGJZRGpzQ0ZyRk83Z0ZhVFVvVXorU1V6cVUybGR5MnEwbXRiYVIzSktaMUtGUGh2UkxVSVJ3VlMxQ0QwUkxVSUR2d1NrMUtGTzVXalVvVWprcE5haFJua2xNNjFpaitwV2sxckZHT0tVbXRRcEdxMG1wUXBnTnlVbXBiYVlZN0FsSnFVS1VuOUZXazFLRks3a2xKcVY4bTdpRXBOWnRvM0pSclA1SXEwbXRRb1VwT1lvVUI1SlNjeFFvUFJXazVpbTBIb2xKekZDaDlFcE9ZZjRlbEhNTVVHQ3RKekI4ajZKUnpERkJqdyt4S09ZUGtQUS9VbEhNTVc4SGdsSnpERnZQSktUbUg4Z2VTVWN3ZklIa2xITUh5QjVKUnpDTnZTbDVoRzM0Y0NsSE1MNUQwUDFKUzh3R2hTam1GOGo2SlJ6QWFERlNqbUpOdkEzcFM4d3ZrZlJLT1lUcUE4a3BlWWswUG9sTHpFbWdQRUtVdk1TNmkyYkFsTHpFL0pGS1hXVHFNN2xLWFdYeVpTaldrMGhQQktYVWswdUd6QktYVWgxS0J3MnFVdXBKcFFsTHFRYU1LVXVwSm85aVV1dERxUDBTbDFvTkllU2xOYTBtbElTbDFKTk80SlM2a21BamdwUzZrbUQwUXRKaGFpMmt3S0xhVFQraVV1cEJnU210U1RDcFM2a21IMFNsdEJoK3RScTBtRW9Xa3h1Q0xaRm5vb3RrV0l0cE1ZS0ZrWVJ5UmJTWVVXMHVpSVVMUVdJdGtXSXRwTEJ4VVcwbUlGRnRKaklSVWxuTUlGbDVLTFpGcENMWklEQUZBc29SYkl0S0ZwTEI4Q29wR1A2VUVsbUhvaTJXVW9XUkhORkxLRkZzaTA4RUxMY2loQUlCQUlCQUlCQUFFb0tEUnhSTE5WRERTVVN6YXpraGF3em1pS0RlU0Jodk5WTE1OQVJMQ0JnRTdrRHlsRXN3MEtsbUdPTzRJaXhEelJMVUdORzVDMUJwVlN6REVTekVaNEJFdFlpUEZFdFRZd0ZVVUdmUWlXb01RdFFZZUNyTnFFWE5DMUNJSWxxRVhvaVd0c0RpclRPcDVGUGJueW5BREVwU2EzNjF2MG5QVTdtSGFyVE9wK3ZTZHZLcVJvSVo5UVJMZVczdHJWSGFJeVZVdFE3YVZ2Q01vbHJiMnpyaitnZm9TazFHN3RwV05hU1l6ajZxMG1wNGRYb2FlbjJ1WnMrQ1V6T1Q4eXBzVHFjNE9CeDlWYVoxUEZkUnRZY01GYVRVb1U3ZDJDVXpxVzJueEd3SlNhbENsZHlWcE5TeFNPU2sxcUZHclNhMXRvY2VDVXp6RmloOVByVnBPWTBiUmNjRXBuV3R0Ri9ZRmFUV3R0RDZKVE90bzJnSjRLMHpyVUxlZVNVbk1XTGNlV3hXazVpaGJrcE9Zb1c1S1RtS2JiaHkycTBuTVVMY09TVW5NVzIzRDlWS1NkeFF0eC9WVnBPWXNXNDRmbXBTY3dDM0hrbEp6RC9BQTRwUnpERnRjT0FTam1IK0dua0ZhVG1IK0hIa2xITUF0cDVKU2N3L3dBTjlQc1NqbUQ4TVRTYzBmaHZwOWlVY3d2dzQ4a281Z051UEpLWG1FYmFlUVVvNWlUYlhEZ2xMekIrSEZLT1lYNGNlU1Vjd25XNC9xcFN4dUlOdS9pcFM4eExyY0QraXBTOHhKdDdlU1V2TVFiY01keWxMekNkYjBwZVlnMjRwUzh4THJlN2tsTHpFbWdJNEtVdXREcUVqZ2xOYTJicUlEZUZLWFdnMFNVMXJRYUk3OEZLWFdnMFhvbE5hMEdpOUZLWFdnMFpTbXRhWFVoVXBkU0RTbmtsTHFRNmxIRUtVdXBEcVlGS2ExSWRTQWxTbDFNM1VoU210VE4xS2VTbE5Sa2cwNVNsMUpkQzcvYlVwZFNIUTh3aTJrd2hGdEpnVVcwR0QwU210U1RBcFN4a2t3L1VsTHFRWWdvMWFEQ2kya3hGRnRKYVVXeUxRb3RwTE1VTFM2SWZCRnRCaUkzS0xhVEh6Q0xhY3ZKRnNpM21GRnRKakJSYlNZandSYlNXSGlFRWxvNEtMWkZwUXNJcElES0VXeUxTaGFTMEZSVWxoSHFFRWx2MW90cElJUlJ2UUl0NUtMYVNDTjZLRUFnRUREU1VMTU5BUkxOVkREU2lXcHJPWDFvaWd3RGVnb0FuY2dZYnpWU3pSQWdZYVNpV1lhQXFXb05KM0lpMnhmcklscURXamNFUzFCcFZTekRFTFUyTW5jak5xRVhOVXRiWXh3Q0phZ3hFc3d4RXRRakpWUzFDTG1pV3NSaEMxQ0k4RmFadGJZVXBKeVcyRDBWcG1jbWpJQ1Rnak52Tm9iYTZWNERSaXFsdmM5STZFcWJqSTBCbXcraUpiazM0MGVDR3RPOGRkRERRVWp4VHZjMW9kbE8wazdBQU4rS3NSYVJjelVkcm1OcDMySk84TlRiWWE2T3hWcm9aV2g3WEdtZTBrSGNRSDRIQThGMkk2VGNudWVoajVUMU9VWG9uNmFqM1R4ZnJSK3hQM2VBd05oclIvd0FRVnI4bnVlSHZnL2svVmZnOThmRnEzMktlN2cvNmhyUDVBcCtUM1BEM3duOG02cjhIdmo0cUhzV2Qyd1AvQUZGVy93QWdWZnllNTRlK0Uva3ZWZmc5OGZGblVleFQzZ2xhUXl4VmdQckFmN1NmbE56dzk4Si9KZXEvQjc0K0wwTHU3N0YvZi9UbWxhdlVOdnNGWkkybWpkTThOaE9PRFJpZGkzajBHN2xOUkZ6OURlMTh2OWJ1NVJqaHR6TXozUlV6UHFpM1hsM1g3UzM3UU9xYTNTbXBLU1dqdnRGSVlaNmFvamRISXc0WWpGcnNEdEJCSG91dG50empOVEZTODdydWozdWozY3RuZnd5d3p4N2Njb21KanY0eFBvNCtyaTlHbjB6T0g3R2tqNEtVNlU1b09uYWhtMXpjRmFabk12d2lScHdPOUtabk50RFpKSk5nQnhWcG1jM2t4YWFxaU5qRmFabk5aMDNVTjJrZlVyVFBNRGJCSnVJS1V6ekc4V21aMzdoaXJTVHVQSmowbFVrWTlQN0VwbWMycmRJMVg2bjJLMHpPYTI2UnErTFBzU2tuTWpwV3FidmJzK0N0TXp1Sk5na1ljQ0NyVE03aW1XUitQNXFVazdqZUhUVTh1eHJmc1Zwbm1QS1pwR3FjTVJIOWlVbk1XM1I5WCtwOWlVbk1XTkhWZjZuMkswenpBN1NGV3dZWmZzVFNuTVpuVFV6TmpnclNjd00wOUlUZ1FVcE9ZM1pwU29mdUIrMU5LYzFxM1I5V2RtWDdFMHB6VkRSbFh0KzdqOUN0SE1MK3A5VitwOWlhVG1wZHBPb1lNUzA0SnBUbXNuNmVrak8xcCtwTkp6VUd6bHU5djFKcE9hWDRXT1NhVTVwZmhXSi9OVFN2TlV5eHVlZGcreE5KelhrUTZWbGxQM1c0am1tbGVhOG1QUXRWSU1Rd242RTBuTmFmMUJxLzFDbEhNWlM2RnFXL29GVFN2TmVIVTZWbmgvT0c3MFNqbVBFbHNybWNFcGVZeS9DbkU3QXBUWE1XeXhTU0hBREZOSnpIa1I2UnFwUmlHZllsTmN4b2REMWhHSWoyZkJTbDVqQ2ZSdFRIaVN6REQwU2w1andxaXdQaTJ1YnNVcGVZOFY5cndPQUNVMXpBMnp1a09EZHFsTmN4dkhwV29tMnRiajlDVXZNYURSRlk3Ymt4SG9wVFdzbjZGcTk1alAxSlRXdGsvUTFRTnVSU210YkdYUk5VMFlsaEErQ2xMekhoMU9sNm1MWmg5aVUxekhoeVdXVnB3dzJLVXNacEZqbWZzRFNsTlJtdHVtS2gvd0NqOWlsTlJtVHRLVlc4RDdGS2FqTm0vU2RYeGI5aVUzR2JLVFMxU01mdW42QXBUVVp2Rm0wL1VNT0pHQ2xOUmt3ZmFaZ2NNTWZWS1hVUXNVejl6VDlTbExxUCtyZFNSZ0cvWWxOYWt1MHRWbmFHL1lwVFdwbkpwaXNidmI5aVVzWk1KTk9WVGYwZHZFYmxLYWpKNDgxb25pM2dnK3FVMXFlUEpUUGJ2R0tpMnlkRTM0RkZ0RG9Tb3RvZENsTlJrZ3hLVTFHU0hSYzBXMEdKUnEwbUxraTJrc0lRdEphRkZzaXpGRnREb2h4UmJTWWp3VVcwRmg0aEZzaXhGdEpielVXeUxBVVcwT2p3M0lxQzA4VUNMZVNpMldCUlNRQkFPOUFpM2tpMmt0QjNxS2tzSTNJSkxSOUtMYVMwaEZzSUVXOGxGc3NwUXN3MEJWTE5BdzA4VVMxTlllQ0lvTUFRVUFTZ1lhRlVzMFFJR0drb2xxRFFGVXN3MG5jZ3RzWDZ5SmF3QU55SVlhVlV0UWJ5UkxVMk1sRXRiV0FLb3NOS0paaG80SWxxRENWVXRiWSthSW9Sai9iUkxXMklsV2tuSmJZZjdBbE16a3RzUElLMHpPU3hDQnZWUzF0ajVCRXRiWVhIWi9BbE02bm5XKzFQcUhnQVk0ODFhU2NudjJoZTMwOXluWTBNSnhJR0dDdE1UazV1ZUVmZ05xWHV6ZjZCbnlFa2tNMGtjY01UR0V1a2M0N0FBdFk0VGxOUTF0NFpibVVZNHhjeTc3L0JEMjNORCtOdGdvTlM2d3BZYWpYTEdOa3A2TU5CaG9YWUE3VHVmSU9KM0RoelV6M28yK0dQYjQvRDQrejArNzArekhUOW5IUHg4UFJIeDlualBLcGROUWdFQWdFSDVldHRhYVo3ZGFTdUd1TlpWY2RCcGkxd3ZxNnlxbmNHdFl4ZzNETVJpNXh3YTBieVNBTnBYSnRiV1c1bEdPTVhNdTU1ZjBHNzF1OWhzN09NNVo1elVSSDZka2RzejNSeGZ6d2U0UDQ1MjN5Y3VXcXUrbmF1Mi9LeTJxcnFheWx0ekljSlpMUExVdmxFWDNYdmFEVFJIUHZkOTNFQW5qOWw1aDVmbGx0Um4yNVl4eDlQakwraFA3MWZKT2ZXZVU3SFd4OTdxZWwyNHgzSml2djR4RVhNencvWm04bzRYV1U4UERoekQ0bjY5cUc5VDhNbXdPMy9BQmJ2eUw1dW44ZHptL00xSDR2NjN0RksrcHFMYksyRm94TG5SdUErMUtabk44OXJORFMwMVNZblJrU05KQkdHNHEweE9iMlRSSFptK2FwcUd3V21rZlBKczJOYVNyVE01dm9kTDRqZHdERG1OcW14dy8zdDM1RmFabk4rVnFQeGwxcFk2YzFWZGJwWTZkdTl6bU9BMmZFSlRNN2oxYWw3WTFNOVFLZU9JbVFuQURCV21KM0h2Mm5QRmZXOXpoWlBEYkpURzRZZ2lOMkI5ZHl0TTh4N05UZUlHdVMwWnJYTGgvd2J2eUswenpHdzhRTmFnLzhBcXlYK1RQNUVwbm1ORytIK3R5TVJiSmY1TS9rVnBubVBDdXZpWHJPamlMNUxaS0Ivd2J2eUswek80OUYxTDJYdVZua2RIVlV6bzNqZzVwQ1V6ekg0MVAyNW5kTUdpTTc4QXJUTTdqNkZvenhqMW5xR21iVjBGdWxrcDNmcE5ZU1A0RmFabmNlNVVQaHhyeDBZYzYxeS9EcHUvSW1sbm1QSkhoMXJodXo4TG13LzROMzlzSzZVNXBPOFBkYjRIQzF6SC9peitSTktjMTRGeThSOWRSTk9XMVRFY3hHNzhpdWxubXZSdFhkaTlRYVlreTNlaWZCanV6dElUU2s3cndMSjJucmJwVk5wNlNBdm1jY0FHakVxNldlYStoV1B4UTF0VlJ0ZitGeTRIYUQwM1lmd0pwVG5QMjQvRVRXbUdKdGt2OG1meUpwVG5IL3FrYXgvOW5TZnlaL0lycE9hUDlVUFdiaGlMYktSL2NIOGlhVTVyOHk5K0tlcjZHSXl6VzJVTkczSElmeUpwVG12bmVxTzBsVmFIT2pxWVRHOGJ3NXBDYVRtdlM3bnBoMUs4Z2pjbWxPYS9QZmFBSEVZSnBPYXVuc25WT0FHOU5LODE3RHAvUWo2MTRBWmpqNkpwT2ErcDl2L0FCbzFOcTV6V1dtaGZNVGh0YTBsTks4MTlhczN0NTkwNnluRW90Y2dCQTNzUDVFMG5OZm9qMjZPNkovNnNrL3ZEK1JOSzgxK2RldmJyN3J3VTc1VzJ1UXRISmhVMG5PZkZ1NlhqaHFmUTA3b0w1UlBnZU1SOTloQ2FWNXI1TGZkSk9vM2x1WEFmQlRTMXpYNWNOaGRKTGxMZnFUU3NicjJmVFhiNmE0eU1ZeGhMaWRnQVRTdk5mZGUzbmcxM0oxZGJZN25iTFpJK2tlQVd1eUhEbXBwYTVyM0ZudDI5MUJGZ2JYSi9KbE5LeHV2d2RUZTN6M1lvNmQ4emJWSVd0Qkp3WVZLYTVqajkzRDdUM1RTZHdrdDF5Z01kVkdTMXpTTnV4U211WTlCcmJFWTVpM0w5U1UxRzQvUXNla2pWeUFCaEpQb3BUVWJqN2YydDhPZTRQY0MzdHVOaXQ4azFNZjBtc0pIMktVMUc0OS9wdmIxN3FobTIxeWYzaC9JbExHNEpmYjg3cVI3QmFwTVA3Zy9rVXBybU1qN2YvZFE3N1RKL0puOGlVMUc0OFM0ZTMvM1NaRVgvaE1oUC9CbFNtNDNIelR1TDRuNjIwaXg4bDF0c2tVYmQ3aXc0YlBvVXBxTng4b3VYYnlXbnFITWN3akE3c0ZLYWpjZnE2TjdMM3pWRlNLYTFVenBwaitpeHBKK3hTbTR6ZlE3YjRmOXdKV0RQYVp2NU4zNUVwcU0zbU84T3RkaHVKdFV1UDhBd2J2eUtVMUdiQ1R3KzEwUCtxNWY1TXFVMUdid2EveEYxNHhwSXRjcEhEOW03OGlsTlJtOVMxVjR5YTZ0TUQ2bXB0Y3pJRzdTNHh1d1Ntb3pmUDV0QVNOcWpDNWhEd2NDTU9LbE54bTlxMHQ0OWFxdjBJcUxmUVNTd25ibWF3a0tVMUdiMmVuOFV0YXVidHRrdjhtNzhpbE5SbWNuaXJyRnB3TnVsQi80TS9rU200eVp1OFZkWnVHQXRzcC80cy9rVXBxTW5oM0R4VjFuSEdTNjJTN3Y5N1A1RkZ0Nk5yRHNmZTdHSGZPVWo0djdwaEg4S1UxR1Q1emZ0S1BvM3VCWmhncFRXcDY1VlVSamNRUnQ5Vkthako0N29DRXBxTWtHSS9GUnEwT2pIRUl0cE1QSlJiUTZIbUVwWXlRNkpTbW95UTZMQkthakpEb2gvdEtMYUhSY2thdEJhUWhaRUFxS2t0K3BGdExvd2R5S3pMQ0ZGdEphUHBScXlJSVJVbG9LaTJoMFhFSXRwTFNOKzVCSmFvdGtRVVVrQnZRSXQ1SXRrVzgxRlFXY2tFbHYxb1dSYVFpMlNLWWJqOEVTMU5ianNDSXNOQStLQmdFb0tEUUZVc0lnUU1OUEZFdFFBQ3FHMXJuYmtGdGlBM29sckF3M0loaHA0cXBhZzNraVRLMnhFNzBTMXRZQnUzcW9vTlBGRXN3M2tpV29NSlZTMXRqdzNvaXd4RXRiWXlyVE01TGJHRmFabkpxMkxtcXphd3dEY2lLRVpPOUVtV2pJY2R3K2xWbVphc3A4VmFZbko1Rk5TQno4T0NVek9UM0xST25QbktoZ0RjY1NBcXpNdXdMMjZ2YjgxYjMyMUpRQ2p0MGxVSm50RVVNVEM0dTI3enlBM2tuWUZ2RENjcHFITDAreGx2WmFjWXVmcTlNejNSNlhmMzRVK0IraVBGclR0UGNLNktHcjdoR01NZE5FQTZHa0JHMWtPWUFsM04zMUxqM2QrSWpUaDlNK1BxOUh2bnY4SDBHenQ0OVBqcHc0elBibDQraVBDUGZQZlhZNUJMcUlFQWdFQWd4dU54dDlvdDg5MnUwOGRMYTZXTjlSVTFOUTlzY1VNVWJTOThrajNrTmExclFTU1RnQXJqak9VMUhhMWhobG5sR09NWE04SWlPMlpkVFhuZDU5WFh5ODErZTIzYm1XU203RjJtY1BwY3pERyt1bFlDdzFrN1hISEE0dUVURGdRMDRrQnhPSDZENVo1VmowVzNyejQ1ejd2UkgydjZ1L3RkOGlma1B2VEY3K1VmZXk3WXd4L0RIMitNOW5DSDcvQUlTOXViYnFMVjlEWkpvV3V0bFZQQlJ5TmVHdURtVHl0aWVYWndRZGpqamlEOEY3T083eTlqYzNKNDFqTSs1OWwvY25xOGVqNkhQR0k0UmpsTlQzOEo3ZkczTDcvd0NWaDRsdGNURlExekdiY0dOcW84QjZETkVUOXEvTHZ6VStFZS80djRRbnkzWW45MzN6OFhnNnU5cVB3NHZHbktxaXYxSlh4MmtSdmRQTEhWeHRjeU5yU1hIRVFuY0JqdVNPcW53ajMvRXg4cjJKbjluM3o4WDgvSGMzc0xRM1hRLyttL1MxRzJrMDNXWGV2cElhUmhrT1NpYk4wNmFSenFpVjduUEwydmFjb3cyY0Y2MlhUenk0emVyNXY4bVpmeURhODQyc1l4d25keXdtSXV0TVRXT1Y1WlRNek9VWlJPbkdJN0pxSE1qMlNmRXZSbmRudXZEYmRjVXhrc2o0cHBwY2hheDU2VUxwQUd1ZGp0SkhJN1BySEZFUkdHV1U5MGUrNGo3YmZIZVE5RmgxV1c1T2ZHTU1MK25WampIZkhqZjBUd2RyNTl0cnhnTHMzeUZYOE92SGgvOEFzbDUzNXVmQ1BmOEFGNi84cDZmOFB2bjR2bkhsMzdkL2lQcG54dTF0cjY4VytzNmVuYkpkTDNFMXRTR2lTV2pvNUtpTmpza1ljUTU3UTA0RUhidkc5Ync2bWNwaUtqMy9BQlA1WDAyTVRNNDhJNDhabU96NmZqUGhFdW52U0hpdk9OUmFOMVE2bForR2FscDRxOTBNSWtNY016bjUrbU9ybWRnWW5NY01TY1NYWWJBdlczZW5uSEhIS3Yyb2Mzem44bmJ2bGZUZEYxbU9OYmZWN1VaUkVYTVk1ZmhqVmM4Y1p4eWk1bTVuS0k0UTdzTzBYdHkrUHRMMjJzajd0UlZBdTh0SEJQVWROOExHNTVJdzg0TmRHOGpmeEpYVDZ6cVkydDNMREhHS3htdS91K2x5ZFo1RDB1enU1YmNZWHBtcnVlTXh3bWUzeC8yejJ2Wmg3ZTNqa04xSlZmeXNIODB1dCtlbjhNZS80dXIvQUNmcGZ3ZS9MNG4vQVBMMzhjLy9BRFNxL2xZUDVwUHowL2hqMy9FL2svUy9nOStYeFVQYjg4ZFIvd0EwcXY1V0QrYVQ4L1A0WTkveFQrVGRMK0QzNWZGbFdlM2w0NDFzTG9wS1NwMmdnSHFRSEQva2xmejgvaGozL0ZQNUowdjRQZmw4WEdiemo5bXZRdW9PM1Z4MWQya0psdmxGRytvTnZtaWIxSHNhTVRrZkVOcEcvREx1WGM2WGYyOTdMVFAzWm5zdWVIcTlIdlRhK1R0bnJjNDI5bmMwYms5bXVZMHpQZEZ4RWFiN0ltYmpqRjEydXBlbTdIU1VlczNXR3FoTGFtR29OUEl3amExekg1U0Q5SVhQbGhPTTFMODk2M1kzZWwzczluZHhuSFBES2Njb250aVltcGlmVk1VN3FQQVR3UTdOVmZqZlpiN3E2M09mZmFzUGtMNDN0YTB4akFOMllIYURpdURyOTNrVGpqakVYcGlaOWMzUDFVKzkydmwzcG82ZlpuS0puUExDTXN1TS92VE14L3d6ajlOdnRyZkJ6eDlhTUcyNlgrVlovZ0xvL25zdkNQZjhUK24rbC9EUHRrLzlSN3grTyszUy93QW96L0FUODlsNFI3L2luOVBkTCtHZmJKZjZqbmo3di9EcGY1Um4rQW41N0x3ajMvRlA2ZDZYOE0rMlNmNE0rUFR4ZzYyeUgvakdmNENmbjgvQ1AwK2svcDNwUHd6N1orTGhCN3UvaEoyQzB2WjdIUzZNcGFtSFc5MXA3eldSbDh3NlRmdzZrYkxFTUF3REI4anNEdjJjdVByK1d4UFU0NXpNZG5aNzM2RjhwZjJ2OHY4QU52TFBNZC9MSEtOelkycjI2eXI3OHhsTVhkM0gzWXZzNFQ3T0hmdHgrT0ZwN3ErUUZpMDdlWXNiWFUxTWNFcmlOZ0QzWmNkeDRsYyt4dHhNek9VWEVSTXo5RVRQMlB4UDVROHYydk1PdXgyOTJKbmJqSFBMS3BxYXd3eXk3ZlRNUkg2VzdtYVB3RThlS0dCbFBCUjFBWXdCb0pmVDQ0RC9BSWxlTC9NY3Z3NCsvd0NMNjMrbitqLzAvZmw4VzMrb3AyQy84MXFNUDd1RCthVCtZNWZoeDkveFA2ZjZQL1Q5K1h4SCtvcDJCLzhBTktqKy9nL21rL21XWDRjZmY4VS9wN28vd2UvTDRtUEJic0dOMUxVZjM4SDgwbjh5eS9EajcvaWYwOTBmK243OHZpOE84ZUFQWUs2MHpvUGxwbWx3SXhmMEhqRWpZY0JHMytGV1BNWjc4WStpL2pLWmZMZlJaZHVNeDZzcCszVjlYdGNEL2RIOXJLMGR2TkExSGRQUXNiYWl4dzV2bUhSeDVIeEhhUm5BeDJFRGYvc1krbjAyZUhVWXpPUERLTzJKOFBHSjcvMDdYbmRkOGtaWmJHNXZkSmxPWEt4bkxMREt0V21JdkxMR1lxTW94N1ppb21JNDhhbXVvM1hPanhSVk1qQTNBZ25ncnBmblhPZWxUMmZDVXRBOU55YVU1cno3RnB6NW1ZTkxkdVBKTks4NXlHOFh1d00vY2ZXZERZb1ljd2xlMXBBR084Z0xXTzNPVXhFY1psemRQam52N21PM3R4T1dXVXhFUkhiTXpOUkVlbVpkNUhpbjdhWGE3dFpveWhuMW5TQ2E5dmlZK1NqWTNwOUp4QU9Fai96aWVZR0dDODNxdXNqREtjY09OZC9kOUh4Zm8zVGZLV3pzOE4zTFhsMzFOWSttSXJqUCs5Y1gzUjJTKy9VUFkzdERib3VoUzZlb3VudS9hUkNRL1hKbUs4K2Vwem52ZWxqNU4wdVBadHg5ZjF0LzlEdmFyLzRldC84QWtzWDVGT2ZuNHkzL0FDbnB2OVBIMk02bnNyMmxxNFhVODJuYUhwdkdCeTA3R25EMGMwQWo2Q3JIVVorTXBsNVIwc3hYTHg5amh4N3J2dC85dEx6MkJ1L2RmUU5DMml1bG1ZS2l1cFc0dlk2QXV5T2tZWDVuQndjNXVJeHd3MjdNRjZQUmI4N2s2Y3UycG1Qbzd2WmJ5dXYrVnR2ZDI4OHRqN3VXR09XZFRjeE1ZeHF5anZxWXhpWmp1bXE3M1E3M0UwczJsckpvMkQ4MXpodTljT0M3dWwrYzgxNnpaZEttcHF3TU5oT3dZSnBhNXJrejRmOEFqbFc5enU0VnNzTlBGbWJOTEcxeERTY0FYREU0RGtGeTdHeE83bkdNZDh2VjhrOHZ6OHk2dmE2YkRoTzVsRVg0UjM1VDZNWXVaOUVQNkJ1eVBpVjJnN2E5czdUcFdxMC9SeTNPbnAyQ3BsbGlhNTVrSXhMU2VPWGRqeDNyeXZNT3RqTGR5NVhEQ09FZXFPRit1ZTErc2VaZEQwTTcweHNiV01iZU5SandpWm1JaXJtYTR6UGJNK012YlA4QVFUMmQvd0RoeWgva1dycC9tdHp4ZEQrWDlQOEE2ZVA4TWZCblAyQTdLMU1SaHFOTTBENG5EQnpYUU5JSVQ4MXVlSy95L1kvMDhmNFkrRG9hOTRqc0JadTNIbFZxZTNXQ2lqbzdFNmQwMUhUd053WXlGeHhZQjlHMHIzdDJJblRsSGZqRS9UWEgzMithK2VlazIrbDYzR2RyR01jTnphMjhvaUlxSW5UR09YdHp4eW5odzR1Qk44MDMwcTR0QXcycmgwdmtJM1gwRHNGMmp1bmNQWE5uMFpZNEhUM2k3VmRQYjZhS05vYzUwazhvaWJnQ1FONTRrQkl3dDJ1ajJzK3AzY2RyRGpsbE1SSHJtYWYwV2VBWGlsMk4wOTQ5VytWMm5hQ3JsbW5xT2xXVFFSR2FTR0o0Z1laTWdETVRrSk9VWWJWUE9zK1R1eGhod3JHTDRSMjlyOTkrZXZJZWk2RHJZNmJhMnNJamIyOE1aKzdFWGxwNDVUdzdaNzc3MzI3L0FGZk95WC93eGIvNUJxOGY4em40dmp2eVd6K0RIK0dQZ1I4ZXV5RHQrbDdlZi9zN1UvTTUrSitTMmZ3WS93QU1mQXY5WGpzZC93REMxdS95ZHFmbWMvRS9KYlA0TWY0WStDSi9HL3NUVXhtT1hTdHZ5bmZsaERUOWJjQ241blB4SjZMWm45ekgyUStZZDkvYlg4ZE84T2xxdTEyeTNDelh5V040Z25oYzZXSHFGdURlcEhObk9YKzRJUHhXc09weWp0NHVoMUhrdXpuSDNmdXo3dnAvVTZDdkxieG5tN1FkNTd4b1N0cCtoWDBGVE5TenduQTVKSTNscEdMZG13cjBzOE5NMCtXNjNwOCtsM2N0ck9yandtNDQ4WW1KOEpqaTU2K3l4N2MvYXpXa1Vtbys3MURKUGRKYUEzZUtKa3I0akUyV2RrY0RjQU1EakhpODQ4d09DN1hVN01iSFRSdVRGNVpaVjlGUy9aZDM1RDZmeTc1ZjZmcStvd21lbzZqTzR1WmlNZHVjYnhpb21PTThNdVBqWGM3RjJlM3I0d3NHRGJQS0FObi9BSlFmeUx4ZnprL2hqMy9GOGY4QXkzcHY5T1BibC96RzcyOS9HSi81MW9sUC93Qm9kK1JQemMvaGozL0ZmNWQwL3dEcHg3Y3YrWkI5dS94ZGR2czh2K1VPL0luNXVmd3g3L2lmeS9wLzlPUGJsL3pJZDdkSGl5OFlPczAzK1VPL0luNXVmd3g3L2l2NURwLzlPUGJsL3dBejVsNWQrQVhpSm9ueHYxanJxdXNrd0ZvdGxWWFJuNW1VRHFNWmd6RU1BSkdZalppUGl1ejBlOUc1dVJqbGpGZC9iM1JmaTlYeVh5am85L3FjY2R6YmljT001Y2N2MmNZbktmM3ZDSmRCL1lUeDJkMzY3MWpUa1g3TFQ4RG4zQzYxTFIvaTZTRndMdzA3c3p5UTF2cWNkd0s3WFJkSk8vbnA3dS8xT24vYjM1UjNQbVR6TERwbzRiY2Zlem53d2lZdjZadUlqMHpmYzcxUEQvMmwvRmEzOWg5UDNxNVVOZjhBak54cGhWek5kVVJaQTE3M0dQS0hST09CanluYVRqNmJsdytZYm1HenZaWVk0eE1SNDM0Y2UveGU1ODIrUjlCMFBtTzlzZFBoL2w3ZVZSZVdVendpTHVianZ2dWZVLzhBNVhuaW1CZ0tLdHcvK3NRZnpLNlg1djhBd3g3L0FJdm5QeWV4K0NQYmw4VXU5cmZ4UmR2b3E3L0tJZjVsUHpYK0dQZjhWL0tiUDRJOXVYeFQvd0RLejhUOS93QWxYWS8vQUZpSCtaVS9OZjRZOS94WDhycy9najI1ZkZuVisxWjRvMU1Eb20wbGN4NTNPNjhEc051M1lZVS9NeCtHUGY4QUUvSzdQNEk5cy9HWHdEeTM5anJ0M3FuUWxmY2UxTGpYWFdHS1NSdHNxNFkyMUVvYUNjSVpJZ0d1ZnlhV2pIZ2NjQW1PN2pQRHNkVGU4dml2dVg5UDZRL245OHNleDAzYXpYdHcwNCtNczZFajJaWERLVzRFZ2dnN2lGeVRqTVRVdkx5dkdaaWVFdzQ2M3kzOUdZdEl3R08xWkxmbE9wMi9CS2FqSm0rbTlGS2FqSmsrRGw5UlVhaVdUNGNPR0NVMUVvY3dqNEtOUktDd0ZGUTZJajRLTGJOMGYxbzFFb2RHVkc0bERvMUZ0RG8rU0tndElSYlNRRHZVVWkzNmtXME9qQlJVT2pJVVcwRnYxb3RrV2tJdHBJQlVXMHVpNUl0b0xDTjZLbktvdGtRaFpJb1FJdEhCRnRKSE5SVXVaaHRHNUFrRGEzSDRJS0FBMkJBdzNINEtwYWtRSUh2UU1ERDRxcFpvaTJSOFNpVzAzSWhnRXFpZ09TTXFiSGlpVzBEUU55cUtEZWFKYWcza2lXcHJNVlV0VFkrYUlzTVJMVzJJcTB6T1RSc2ZKV21KeWFOaTVxcGEydEEzYjBSYll5ZDZNekxSa0o0REJWbVphc2cvc0t0TXprMlpEaHZWWW1Xall3TnlJOHUyVXhsbkhGVm1aZlpleXVuRzFsMnBtUGJqaTV1ejZWYVpuSi9UZDdJdmFIU3VqdkU2ajFwVDBUVzZvdUVqNFpLdHpRWE5pakF5c1llQUlJSitLNWVzKzV0NFJINzBUTSsyWWo2T0Q3SERwbzZmcE5tWTdkM0djc3Y0c3NZajFWamNlbVpjMEY1anJCQUlCQUlCQjFUKzdsN2xWVDNDdTlkNHk5bEt6TDIzbzVUVGFodWtKSC9TbFZCTHRpamUwbkdtamMwSEVmNHh3eEdMUTBuN3p5RHlpTm1JM2R5UHZ6MlI0UjhmcWZ0dnlIOHAvbDlQVWJzZjV1WDdNZmhpZStmVDlVY08xdzg3VzNhUDV0bFBBY1M1d0wzbmU1M01yMnVvaWNuOVBmTCtXSFQ0eGpqOU0rTHN5OXN2UmhxOVYwdDBlMDlPanA1NjU1M1k3QkEwZjMwZ1AwTHovTzkvbGRCTWQrY3hIMi9ZL0d2NzNlWmFPbnl3L0ZsR1AyejdvYzZWK2N2NVpmRi9jVDdveDluZkIvdWZyblAwNnlPd1Y5dm8zZnBmTTNHRTIrRXRHQnhJZk1IYmp1eE94ZHJvOXZYdVI2TG4yUmYyT3gwMFRjNVJOVGhqbG4vQmpPVWVxNWluVFgyazAvYWF2dGhiZTJkNlpub0txaGJCVnhPeERnNnBZWkpBTXd4QkQzbkE3d1Y5OWgwa1JzWXhQaHgrbC9YUDl1L0tkamYrWDhQTGVvaThOelowNVIzL0FINHVhdnNtSm1hbnRpWWlYT24yUmV6TmRvRFVlcTNYQUF1dE5MQlFsN2NXNW4xTCtwSEpnR243cjQya2dPY1BnVHRiOG41bHQ1YkdFNFQzNWZWSDI2b2Z5REh5OXZlUjduVTlOdmZ0WTcyaSt5NHdpN3J3eWpjeHlqakhxbWV6c1RYaHNPTFB2SzYybDBsNENhcXM5RzRpNjZtcWJYcG1rRFFDWFBxcTVrMGpRTi8zb1luallDZjRSM09pMjV6em11NlByNGZhMU8zbm50Ym1qOXJUVWR2SFhsR0ZjSW44WDA5amlONDY5cjdScnU2V0hUY0xHazIyYWpob1hFQnhiMDNNaURjWGs3SE4yYlR5eFg2TGwwZUduNzNaaFUvUkhiN1lmMDk4NWVSZEwxM2t1eHQ1MVhUWllaWXpWOE1LdU9OeldXTVRIcnFadXFkcmRKVFEwVkxIUjA0RGFlRmpZbzJnQUFOYU1vR0EyYmd2ekRQT2NwbVo3WmZ6RnVaem5sT1U5c3pieE5WWDJEUyttTGxxYXEvOG10MUxVVjBtd243dFBFNlU3QmdUc2F0Yk8zcnpqSHhtSWN2U2JFNys3aHR4KzlsRWUyYWRjT3NQZnB1dWg3L0pwM1VGb3RGUGNHQnI4cnFlN3ZCWThZdGMxMGJpMXcrQjM0amVGOVIxSGxIUmJPV25QY3lpWTlINm42TDV6NVA4c2VWYjg3SFU5WHU0YmtSRTFveW5oTVhFeE1iY3hQMFRQRzQ3WWw5dThHZmRHcGZMZlhwMFBVVzZsRTBzWmtobHRUYXlOMGVYODUwakt6ZXphQmkwN1BWZFBxZkxPbW5ieXkyZHk1eGk1aWVIRDBjSWVIMXZRK1I5UnNaNStYZFhPNW50eGVXT1dNNHpNWEVYRjQ0OWt6SGo5RGwrdm4zeHp3ZFVYUzIyVFROeHZWNWExMW5vNldvcXF0c2pTNXBoaWlkSklDMEIySXlnN01EOEZ5Yk9NNVp4RWRzekZPeDBtM2x1YnVHT0UxbE9VUkhybWVEcEUvcVJSYW83d1UxOG80MnVaV1M0U2x1VWZ0NG41WERBYnZ1Rmg5Y2NlYSt3OHh3am41UkhvK3A0djk3T25pUG1QZXkyNDRidWlmOEF4YWNZbjJ6Ri9TN24reHVuSXRKZG9OT1dDRnVWa0ZCVHVMUmhzZEt6ck9Hd0FiM0ZmTithNTZ1b3o5RTE5R1BDUHFmUSthWTQ0YitXR1A3T0ZZUjZzSWpHUGRIK3g3VXZQZEIxNStRZnZuVy9zWjNDdXVpNTdGUVRRVVZSVVJVa3o1TGc0elU4Yzc0bzVDWVlpMzd3Yml2cHMvS09sMm9pTnpkbkhLWWlhcngraDkvMTNrL2tQbHVqYjYzck05dmR5d3h5bkhsNVRWeDQ0NHpIYmZmYjVUWC9BTHpIYXFON21qVEZzT0hPUzdmekt4L0wraC8xcC9objRPamZ5bi84aG4vMnMvOEFrZmsxbjcwTFFVeHdacFMxbjR5M2IrWlQrWDlEL3JUL0FBejhDL2xQL3dDUXovN1dmL0k5TW8vY3RnOXhyeUZwdFMxRlBUMjZLd1dVME1Wb28vbVh4SHFWeGZKT1RWc2FTWENRTUlHekJvWHE5REhUN1dHamF6MVRNM1BDWSt4KzAvMm84dzhsM052ZjZQb2QvblRONTVYaGxqTmNNYSs5akVURWZhK3RlME4ybS9EKy9SK1lqT2EyVkZWR1hQd2E0R2x6bkU0Y2N6QUYxdHovQUN0bmVud3hyMnpFZlZiK1Rma3J5dWVnNnJ6S01vNDdHTTdYSHRpY3R5TVo0ZU5ZNWVwMm9yNUI3RDBIeWI3eDFYWWJzMWRPNUZ0cG9xeThVcnFhQ2pwYXB4YkZKTFVWREljSEZwYWNBMXhPdzhQcFhvZVY5RkhWYjBZVE5SeHY2SWZRL0szazJIbW5XNGJHZVU0NHpFek14MjFFVFAxMURyOC8vTUt4R3ArWGJiN01kdUdQeXQ2L0t2Vy9JZVgvQU9ybDdKLzVYc2F2ay84QSsvM2Y0TS8vQU9KeTg4RGZPZWw4eXJEVzFueUVOTldVVGVwOHpRT242RW96Z0Z2VHFHNW8zTkQyNzNISEhIWmd1bDVqNWR0YldFYm0xbnF4bWE5TVRWL3B3ZER6dnlyeS9IcDhlcTZEcU9kdFpaYVp1S25HYXZqZFR4LzNZcjB1UXE4WjhxK0orNHBjcVcyK0crdFBtV2RWMVJEUjBrTVpKYm1sbXVNREc3ZDJ3N2R1dzRZTDEvSXNOWFZZL1Q5VXZzLzdmNHhQbTIxcS9ack8vVk9HVVRIMHhOZlMvblo3cDJodnpzeHc0bGVycGZ5VHpuektvcytOUWNCc3hUU2M1N0pvclRmVnFtRERpRTBuT2RrSHM1OW82Ty85KzdSUFhRaVNtaGYxM01lQ1d1RUxETVFRUDRyU3R4bE8xaG5uSENjY1pyMXp3ajYzNlgvYS9aakxxOS9xTy9ZMmNzb20vd0I3S2NkdVBkbk0rdUx1NmR6YStRZmNQaWZucDVTVkhpZjJSZHJ5MWlMOGZxcW1PZ28zVkxPb3lQRnJwSHY2WUlMamczS0J1eEl4WHFlVmRIaHY1enpKckhHTG42b2ZVZkt2bG5TOVh2WlpkVk14czdlTnpYYlBHSWlJNGQ4eituYkhDL3g3OTR2dTczQjd3MmZSVjhyQlBRMXRReUdTQ2UyMFViWHRjN0tXaDFLNFB6WUhaZ2Q2OTZQTHVpM2J4eHh5aWFtcHY5Y3Z1c2ZML2wzcll5MnRuYTNkdmNuR2RNelBDSmlKbjhXWGh4dU94MmVMNDErT3ZnZnVkYTRwTkJlRVd0N3BVdmF5V3BncHJkQm5JR1o5Uld4TklHSkczSm1JdzVjbDZ2azJHcnFJOUVUUHVsNzN5N3VSdGIrZTdsK3p0N1c3bFBxamF6ZnpxYTJweFgxOHJtN1M1eFAycjFkTCtaT2EyMEJvWjliWHNEWThTU01OaWFXdWE3ZGZabThUYWVHNG51bGZhWWZLMjlySklpOXV3ekgvQUJZMitvemZSNnFkVHZmbDlpY3Yzcy91eDZ2M3ArejZYN0I4aGVYL0FKVG85enJzdjI5Mjl2YjlHUDhBNm1YMDhNSW4wNU95eGZMUGJldGFSN202ZjFucmJVbWpySkwxYW5UVDZTbXJuTndMUlBVTWtlV2dqaTNMbFBJZ3J1Ny9BRWVXMXRZWnorL2RlcUtldjEzbEc1MHZUYk85bi82MnFZOVVWOWQzSG9leXJwUElkUmZ2MmR1b1IzcWoxUEZIaSt0b2FkNzhXNEQ3ak9sczU0bHBPUFBGZlM3SDN1bjI1OExqMlRmMnZudjdoNFgwL1JiMC9oM052dC9CbnI3TzcvcXVxWFUrbmNMa1JsMllwcGZtTWJybFY3V0hhcUM4ZDNxM3VIWHhNZmJOSFdxdnZyUk5HWHNOWUtkOFZLQWRqUThTSE8zTWRwYnNIRWRucE5yVnVZeDZZZnFYOW8vSzQ2N3pqRExLTHgydnZmVE0xSDA4YitoMzNlT0ZnL3F6MkkwcmFTMHNjTGRCVU9hUUdrT3FXL01rRUQxZjhlYThQempkNW5VN2srbXZadyt4K2hmT1BXZm12Tk9vM1BIT1k5bkQ3SHV5ODE4MDZZdlB6M0llNm5hL3laMWJvM1RWZGN2d3lqdU5TMkkwZDZxcVdKckhTRjdXc2ppWVdnTmFRTVFkcSt3eTYzYTZlTWR1ZHFNcGpIRzUraUo4SmZwblcvM0w2THlDY09pbnkvYjNzc052YnZPWmlKbWNzTWNwdUoyOHZIeGxYaGw1MCtUUGVDOVhHK1crOVhlM1dLeGlsbXFhaWU5VmxYRk5OUFVDR0tFd3lNREhZaHpqOTdFYk55N0hSNyt4MW1mTG5aaUw3K0h3aDZIeTEvY2J5MzVqNjNEb3R6eXpid2pPTXZ2Uk9NekZSZjRNSmpzN1ltN3AzSjJpb3FxeTAwdFhYTkRLMldHT1NaalB6V3Zjd09jQnRPd0gxWHhXN2pHT1V4SFpFdnlucU1NY056TEhIc2lacjFXOGhZY0xwQjg1TkhVbmZYM0N0UzBJYmpaUHhHYWF2bGoyWVVsTThOSkxtazdYdERXQWpIYVF2ck1lbDFaNFkrR09OL3d3OW5aK1VQNTk4ejdQUlJIM01kclp5M1o3S3h4MnNKeTQrbTR3aWU2Y292c2RpUHRlMldIOEQxWHFPSmhiQVpxSzNRRU1BWUJGRTU3MnRkdTN1YnNHN1p6VDVseTA0N2VIcm42cWZxbjk1UE1jZDNQcDlyR3F4MVRYc2lPSDBTNVdyNU4rSk9PUG50NThXL3dxWlozVmRIQldQdWtjc3VGVjh5QTNJN0szQTA3WGI4RHZIQmV2MEhRN083dHpudTV6akYxSEMrNjMwbmxYUitXUjA4Ny9BSmgxRTdPT3JUaldNNVhOWFBaRTFVVTRnWDc5NUF0Rm5rY3h1bTdjOERtKzZqK0NGZHYrWDlEL0FLMC93ejhIZHY1VC93RGtNLzhBdFovOGoxK3IvZWRiWlRZNGFXdGhQckpkdjVsUDVmMFArdFA4TS9BdjVULytRei83V2Y4QXlQa1htTCs4RjFQbEw0OGFsN0NXYXhVbHNyOVFReDBzZFZiWmJpWnZ1enNreWdUUkJoRGczRGFSNmJWeVlkTjB1emVXM3VUbGxVeEVWUGZGZURqMy9NL0lPaTJkM1BvdXN6M2QvTGJ6d3h4NWVjWE81ak9IQ1p4aXBpTXA3L1JIRitGNG1kcElleWZiWXdWN1d1MXRkekJVWG1WdU94OGpoSEZUNDhvaElSNnVMdUJYditXZE5HMUVZOTg5citrLzdlZklmOUkrUzN1eEg1amRyTGNud245M0Qvd1hQMHpsUFk3eCswOWxHbk8xK25MRmtkRzZrdHREQTVqemk0T1pUTURnZlhIRmZDZGR1YTk3UEx4eW42MzhxK2Y5VitaNjdmM0x2VnVaVDdjcGV3THF2SmNGZTdmdXg5d05CNjh1T2s3QllMWFYwdEpVUzA4VDV4V2g3bXh2TFFYRVNOR09BNUw2ekh5YnBPeWR6SysvaDMreCtuZEg4djhBeS91WmNyUHF0em00OE00akdhakx2aTlGVFUrRXo2M245bGZkVzF0ckx1SGE5TWE5MHZSeFdHNVR4MFRwclMrWVR4U1RPREdQQW1rZXh3Qk8xcHdPSEhaZ2VYZitXdHZsemx0NXpjUmZIL1k5ZnJQN2I5SHVkSm52OUx2WnpPUDRvNFRVWFhaRS9UeDlUbTJ2am40MEVIOHdQdk1RMmVzOHhOZVQyVEthQjExckpHRm03RjhwZTRiemljeE9KeFhzZFpqVzVQMGUydVB2ZWY4QU11M2p0ZGR1WXg2TC93QjZjWW5ML2l0MTg2cnA4dFEvWmlNVjFhZUpHVDExOEFPNVNtNHlaUGlMZCs1R29sbStJSGVvMUVzbndINkZLYWpKaytINkNqY1N5ZkZ6SDBxTlJMTXNJK0NqVVNnc0JSVU9pSTNibEZ0bTZOR29sRG95bzFFb0xGR3JRNk1GRlE1aENMYVNBZDZpa1c0YmtXME9ZMG9xSE13VVcwRm9QeFJxMGtZS0tDQVVHYjJjZUtOSUk0RkFpT2YxcUtSR0NLU0FJQlFTUmdvMFdBUU5BdzNpVlVzMFFJR0JpZ29EQlZrd0NkeURSa1lHMDcwUzFJaGh1Ty9jcWxxQXgyQkVhTVp6M0tzckE0QkJRYmg4VVN6QXgrQ3JOcmF6SDRJaXdPQTNJTGEzZ0ZXWmxveG1IeFZZbVdqSThWV2JhQm9HNUVXMlBIYWR5TXpMU09QSGR1VlptVzBjSVZwbWNtcklSdlZZbVdqV0RnaU5HUXVjclRNNU5vNmY2VmFZbkorcFlxUXZxR25EWmpoaDlLdE1UazVCZU9scVpQcUtoWVJpVEl6NGIxV0psL1VUN1hWbFpaUERYVE1FYmNyWmc2bytKZXhtSjNuaU1GT3ZtNXdqd3hqN1orMStnOWRFWTdQVFl4M2JPUHZtY3Z0Y2hWMEhtaEFJQkFJUFdlOWQ3cU5OZG10VzZqcEpSQlZXK3kzU3RqbmZsTFkzd1VNa29lYytMY0FSanQyTG02ZUwzTVlueGo2M2Q4czI0M09wMnNaaTRuUEdQYk1QNXgrNUY0Yys0UzFlYjcwa3J4dDlDdjFQb3QyTW9mMUIwbTlweWV5ZGlaSksrKzAwT09PWjdSOVpYUHU0Vys1OHI2MnFkei90dWFhRkJwZTYzZDBZeXRpb3FPS1hHTWtPSmxtbGJnUHZqWjB6dHdCOWNObngzelYxSC9UMm83b3VmcDdIOCsvM2s4MDUzVzQ3TWZ1M2xQSHg0Unc5RlQ3ZURrMnZrSDQyNExlLzMzQ2RaZkVLMGRxcVdYSlhhMHY5RFF5c3dlYzlKU0hyeTdzRzdKSFJIYTRidmlSNlhsMkVUT1V6NFY3Wmo3TGVqMGZTUnY3ZWVNL3Z6aGhIcnp6eC93RExHWGg2M1hOMnl1aHFOZDB0TXc0UkI3UUdqWUFNVitqZFBsRzVnL3FyeURyUHkrVVJIQ0hjUjdmV2pxZXlkcDY3VlhTRGF5OFZiR05tQmFTK21vcWFPRmdPWDlXWXpiOXUzbGd2aXZtZmVqTHFJeGo5M0dINGQvZFhxSTNmTlppSys3akVUN1puNnErUGRIM3BmT1B6VjE5ZSticmFscTYzdFQyZ1k4dWxtdVZacWVzZ3hHQWpvWUEybmNXOGNYZFFiL1RianM5bnlyR3VNL2lqM1hNL1kraThoNlNON2QyY1pqOXJleG42TnZITE9mZnB2MXZ6UGJFc0Q5UmR4S09xbFpuaGdsTlU0L3E5Q04wclhjZjAydFgyUG0zVmFPanptTzNLSzl2Nm43UDgzK1l6dGVVYmtYeG1vOXZDZmRic1lYNXEvblo4aTg4dFkvMUc4UTllWGxydzJhYTJ2dGNlTGlDNTF4a2JRNERMdEp3bEp3K3ZaaXZSOG94dnFjUFJOK3ppK2krVTlqbStZN01lR1Yvdzhmc2RHUG01MnlxbjJEVFBjU2dqY1o2ZU5sbXVMMmdPR0JaMW9YT0kyakIyY1k0RWJRTm16SDZEejdaMVZ1ZlJQMlB2L3dEOGlQbGJHT2w2UHpIYmpqakViV2N4NnRXTXozOXVxTDdPTVJ3NFh6RC9BSGZ2dDNMVWR5N2hxeXBqeEZ1dHNyODVhU00wMGpJZ04rQU8zSGp1K2tmUHh1YU52UDhBeFJFZSsvc2ZnUHlubnk4ZC9MOFdPT1B0eWpML0FNanRvWG5QZGZKdk9qV0xkRGVKZXVMMFhoc2t0dmRiR1l1SUxqY0pXVU9BeTdTY0pTY1ByMllyMGZLTWRYVTRlaWI5bkY5RjhwN0hOOHgyWThNci9oNC9ZNnYvQUFWdDU3cDl5M2FjYmpKVXRyb2E2a0RXc0pJbXFHMHNqUTQvZUdPZGp1STJidUs5M0RxWXkzSjNKN0xtZlp4ZUwxTVkrY2VZYlhWWGNiZlVUblArNUV6bjlXTWZiUGZIY3RCQkZUUU1wb0doc0ViUXhqUnVEV2pBQWZRdmtzc3B5bTVjT2VVNVRNejJ5OFBWTjdpMHpwaTQ2am1HTU52cGFpdWVBQzdGc0VUcFRzR0JPN2N0YmVHdktJOFpjblRiTTd1NWpoSDcweEh0bW44N3ZtTm92Vk9zTGwvV25vU1NWTHA1b3BpR2JDNlQ5cGpzd0EyZzhGOUY1em5HZTdNeDJSdzl6WDkwODhlbzZyTGN4N01NdEgvREgyeFA2UTRzYW03WGF4WTl4WlJTay8zSlhrUHlkODcxVHAyL1dhVXR1TUw0aHd6Z2orRkI5MzlzSFVqdFArVHR1bzVIQmpMdFMxVnN4Y0J0T1Z0V0JpZDJKaEdIMWNWMy9MYzYzZlhINjM3Ui9ZVHpLT2wrWWNNSm11ZHQ1NGU3WDllSDJkN3ZpOXRQdDAyeDY2MVZxTnNlRUpoamt6dHhEZXBjWHRxTWZVL2NkOU9LN3ZudVhMMjlQNHNyOWtmcmVyOHllVXg1ZDFubU14d25mNnZWNjRqYmpPLzR0MmI5UFpYZnpEWHlyNUp4cTl5eTZPcU5HYUcwSEEvQ2U4YWxwS2lTSU16T2ZUVUVUNUpzQ1JsQUdkdU9PMzRqRmZRL0x2RGN6eS93MTdYMy93RGI3SFQxRzd1L2h3cjZabVBnNkFkZTZMdUdtdTYxOTB3NkYwQnQxenJhQXd1QUJqK1hxbnhaU0dnRFpsdzJMemM4YXltSDRCNW5zY2pxZDNicXRPZVVWNnBtSGM5N0NXaEtpeWRnYjlxaXRoTFBtcTJPbXBaWERETTBRdGZMaGp3eHlyZlVia3hzWTRmNHBuM1JFZmErODhtenkyL0s4TnVZclZ1NTUrdU5PR01UNnJqS0hQVmVhNUhHSDNQTlNDSFIvYjdRY09QemQ0MVZRMTBnMkFPcExWRStwcUc0a2pEODVwMkhIWnN4M0wzL0FKZjRaNTVmNFpqMnZzdmsvd0R5dnpHOTNZN1V4OU9VeEVmVTZMZThVVFo5UVZwTzBtYVhkL2RsZW5wZng5MUc3L21aZXVmcmZOcExXRFVZakhmeVRTNGVhOXg3ZldwdnpMQzcwVFNjMTJ4ZXlabytKMnNLdTlodXlqdDgwMmJIRDcwa2pJRzdPT0ljNWRYekhQUjA4eCtLWWoyWFB3ZnRQOXRkdWNQTHVyM2Z4NTdlRWZSR1dlWEgrSDlmZDJUTDVkOVk2OGZmcHVlcHJwcC9RK2liRFNTMUZEbnJLeXRkREdYQm5WZkZGRVhPQVA4QXZieGdNRjczbGZEYXpueG1JOWx6OXI2anltSnc2UGNuOGVlTWZ3eE0vYkRyVnNGbTdrZHN0WFV1dXRPMHRRMjhVY2pKYUthbkpqa2luYThQWkkxd0J3TFMzRUwwZG5mamF5dWNianNyMXViRHpuSHl6Y3gzWjIrWmQ0MWRmdFJNVHhxZTYrN3ZmWVA5ZS96MmRUdW1xTmJhbHAyRDlJM0dwZCtSZHpheTZiT2E1T1A2ZlEvUS9LZW02UHJjSXkvS2JlTitxZjhBeXcrY2Q1dkovd0FtKzlXbFg2YTdxYTd2RjYwckJLeXRGcnVkVk5OQVo0d1kyT3l1ZGhpQTg0SEJlbHY5THRiRzNPV0dFUk14WENQRjBmN2grV2RQNWQ4dWRiMU8zdDRiYzh1TU96ak92TEhDb3F2Ry9vdWVGdmgzNFRKVzEyVXR4eEs4S244SFJ1UHUzaTcyWG0xZnF1am9tUWw3UzltSURTU2NUdUdIRXE0NFhOUFY4bTh1M2ZNK3EyK20ydjJ0ektJajBlTXo2SWpqUG9oM3ZlTmZhS2s3SjlvTFZvdU9NTXViWTIxRndMY050UkkwRnpmOXdNRy9Rdm5mTWVxNSs1Y2ZzeHdqMWZyN1g5RGRibHRZempzN1AvUzJzWXd3OVVkL3J5bThwOU12MSs4ZmN1MDluTzExODduWHJBME5tcEpLb1J1Y0c5V1g4eUdMRTdqSkk1ckI2bGRmcHRpZDdjeHdqdmxyeXZvY3V0NmpEWng3Y3ByMVIzejlFY1hGRDJ3ZGUzN1VQZUh1RlNhcG5jN1V0emppdmR4aWZsQitiK1pKcU1XamNXU1ZEbTRjTWNDdnBmUDhzY3RuQ01ZNFl6VWVxdjFQMEg1M25EYzZMWm5iajd1M2xPRWVxdUh0akdITlJmSnZ5OTE5ZStub3B0eTA5cHJVZ2pibmRUMWRMMVAwajh2S3lUS2ZRZGJFZkVyMy9MTTcyY3NmREsvYkg2bmovT1cxTzU1UEdVY2VWdlJmb2pQR1l2Nlp3aVBZNmN0VTZjZUxvN1orbC9iWGJwK05SdU9lWHQ5OXQ2dlIvakhXM0NqakoxUHJXdnBLS21ZMlZvNmtMcXR0SEd3NXNHdHhIVng1ZzdTT0hlNkdzY29tWDlRZjJXOHZqcCtsbmZ5N2R5Wm42TWV6MzI3bUxUYnFlejJxbXRGSUEybHBZbzZhTU5HQURJbUJnQUczZ0Y4VnVaem5sT1U5c3pid2QvZG5kenl6bnR5bVo5cXJoVnN0OUJQWHlZRmtFYjVuWW5LTUdOTGppZUc1WnhpNWlHZHZEWGxHUGpOUDV3L0tQVGVwOWZkNjlTWDZTbGYxcGE2ZkhLMTJHTFg1Tm1Qd1h0K1laNnQ3S2ZUWHM0UG5QblRxT2I1cjFFK0djNC93L2QreHptOEQvRmk3OXI5QWR2dEhhaHRqNDdqcWErVzI0WDhPakRpWUpxanFCcnM0SUdXRnJjUVFSdjJiMTZYbCtYNWZETGM3NHhtWTlqN1grMlBTenNiZlVkYkg3V08zbnAraVB0bjZuYTR2a1hsUHo5V2FtdE9qTk1YSFYxK21iQlpiWlRUVjlWTktjcldSUVJtUnhKQVBBY2x2YnduUEtNWTdaYzNUYkdXL3VZN2VNWE9VeEVmUzZYYUs0dXE5UzN2dWZkZHVvZFMxY2o0bkhITTJtRWhJL094UDMzZmUzN1JndjBYcHRtTmVXZjZWSENIOUYvSkhrVWVXN2ZWK1o3a1Z1OVZuT09IQ3BqYTI1MDQveDFxOU1SakxzcjlzaXdHMmVOREwyLzhBUHZGeXJhNXJzMk9NYkMybWJzR0dHMk1yNVg1aDMrWnZ4SGhqRWZhL0ovN2c5Vk83MTBZL2h3aVBiYy9hNURyd1h3enF2OS82cHVsKzduYVYwMVF4T2twcWExdWM3SU1jSHkxRHp3Mmc0WWJEL2JYcDRUV3hqSGpsbFB1eGg1M3pWbHA2SHA4ZkhQY24zYmNSOXJxbzF6Mm8xZkpLOTBWRktlV0RTdUo4QSthNmo3WWExcEdPZWFHVU1HODVYSVBxSGcxNC93QlJkOVd5ZHo5YTB2OEEwRlozajVLS2RweXkxMzV6Q0FSZ1JFUHZuSDlJdDM3VjdIbG5UWE91ZTc2MzlPLy9BSTIvMjJqempyc3ZNK3F3dnArbW43dDltVzcyeFhkTWJjZmVuL0ZPSGJ4cm5IMnBkUHJ6dVZZTkZVcnZ2M0s1MFZDQmlCaVpaZzNlY2NOdUcxZlQ0WmNuQ2M1OEg5T2YzQTg4akhheWpIc3h1ZlpGdTcxakdSTUVjWURZMmdOYTFvd0FBMkFBQmZtVXpiK0Y1bStNdkh2TnhpdEZvcXJ0TzRNaHBZWmFoN24vQUpvYkd3dkpPSEFBTFdHT3JLSThYSnNiVTdtZU9NZDh4SHRkTy9kalRWUTdWRlhmSnNYelN2YzhPT0pjNXpqanQ1cjdybytuMTV6bFBaYjlVK1ZmbHJMcU9vbkNJKzlubE01VDY1NHZZL0ZiUzlUVitRR2dMRy9FMWxSZTZPcXFTTjdZNmVac2pnTU1kelNUdTMraTlIcnQ3bDdHYy80WmlQWS9Wdm5IZjIraTh1M05qYjdNTU12cG1wajdYYmN2ekovS0R4cnhjSXJSYUtxNnp1RElhV0dXb2U1LzVvYkd3dkpPSERBTFdHT3JLSThYTHNiVTdtZU9NZDh4SHRmeXErNFhxV1RVdmZEVTkybGYxSHpWOVhKbUp6WTR6T0kyOGRuRmV4MW1XcmR5bjB6OWI1LzVoNmpuZVlkUm40N21mczFUWHVjTnRValBVdVBxVjFua3hMOEdTblVwdU1tTDRUOFZLYmpKaytBSGNwVGNaTW54RnFqVVN5ZkVEdlVhaVdiNE1OMjVLYWpKaStJZkFxTnhMSjhZeHdPOVJxSlp1WVcvQlJxSlFXZy9GRlp1WmdvdG9jekhjalVTemMzZ1ZHNGxEbThDbzB6ZkdVVzBxS2t0eDJoRnRKR093b3FIc3dSYlFSd0tpb0lJVWFCR085QkQyWW90b0l3MkZGU1I5U2lrUmg4RVVrQWdXVkZzQnVHL2VoWm9nUU1OeCtDSmF0eXFHMXBjY0FnMGF3TkhxaVdwRU1ONGxWTFdHa296YlJyQU42cUtBSlFVQmdqS2czSGFWVXRiV2NTaUxEY2ZnaVd0ck1kMjVWbVphTmJoc0NyRXkwWkh4TzVWbFlIQUlOR013MmxWbVphc2p4Mm5jak50bVJxc1RMWnJNTjZyQzJ0SlJKbHJIRGp0TzVWaVpic2orcFZpWmJ4eEFiWGJ1UzA0NWwreHA2RXZxV2pEbGdGV1pseVc4V2JYOHpxNjJzdzI5VmcrMVZpWmYxR2VCZHVGdDhUTkd3QUFBMForUDNKWFJmZTJEYjkxZGZySisvNm9qNm42UjV0Tlo3ZVBIN3UxdHh4OUczaSt2cnF2TENBUUNBUWZOL01XNFJXdnhNN21Wa3dKWU5MWDZNWmNNYzB0c21pYnZ3Mll1R0s1K20vNm1Qcmg2bmtjZis5MmY5L0gzVEQrY2ZWOXhGVTVyQitjWlhrL0hNVjl0MFhVYU1uOURiRzlxbVgxWHhMdFQ3dHJpMzBoR0o2ck1mNzVmVDQ1UmxGdnBlZzZxcGQ2L2hucHNhZTdDV3lkelN5b3VVdFJjSkd1WTVtd3lmTHhuQjRhU0hSUk1JT0dCeDJZakFuOHg4ODMrYjFXYytIRDJQNXQrZXV1L05lYTcrWGRHV21QL0R3bjMyK3FMeVh5VHFkL2VCdTZVTnk4ZyszdmEyR1JyNmZUdHJxNy9VTUJkOXlldmxNR1YyMGpFTmlpZHVHOFlrN0FQWDZDS3d2eG42djlyNnZ5T3R1Tm0vM3QyY3ZYR0dGUjc5ejFjSEVyeCtxbTNMV01kY1Q5MkxQSWZRTWpMdDRYMWZsM1VhWnArNDlIdjNFVER2YThXN0c3VDNqdm82aGZzbWx0ZE5YeWpFT3drcm1mT3ZHTFEwYkhTbmg5SjNyNHp6UGQ1blVaNWVuNnVEOEIrYU9zbnF2TU43Y244VXg3UHUvWTk5WFFlQzZpZmRzN2xSNnE4OTZ1eng1alRhVXMxSFptdUpPWHFWV0ZjNGdIa1pIdDViK2VLOXpvbzA0WS9UUHQ0ZlkrNytXOG8ydDdZaWU3RFBMNmM4b3hqM2JjKzF5bDlvdlNoWnB1NTZxY3o3cklJNllPSS9TcUpNK3o2SWpqOFYyUE9PcHZheHc5Ti9wN1h1LzNDNnlQeSsxdFJQN1dWK3lLKzF6Ulh6YjhuY2MvY3oweHEzWC9BR0p0L2IzU0xIdW51ZDJwbjFvano0R2xwNDVIa09EZGhIVUxEOTdaczNjUjYzazFjNjVmYy9JR09FZFpsbmxNUkdPUGY0ek1mWmJpRnFyd3QxYjNBMExYYUZ1RUpaSmNJVEJISTZNdURaZ1ErSjJVZzQ1WkEwN052TGF2dmVwMk5yZHd5eG5QR0xqeGo2UGUvYy9tdnpYcFBOdktON29jODQrL2hNWHdtSXlqampQMFpSRStQRGhVOFhKWDJudkV6VVhqYjJ3dWR6MXJSUG90UzNaME1FY2RRTXNncDRNenNjQ01RSE9jQ09lR1BKZm0zVVRFUkVkL2Uva255N3k2T2o2ZUl5NGJ1VXpPVVhjUkVjTVlxT0YvdFRQYndtT3pqRGxvdXE3VGhwNzJ2YzZEUmZqSmF0Snh5WkxuZkxzSkdOKy85NkNocFpKSC9takxza2tpM240RGlQUjh0blRsbGw0UStvK1d0NmVteDZucWV6bDdPVXg2NjRmVit0eE45bVRURlJxVHlNdDlZR2wxTlNObXJaU0NRQTJDTnoyay93REdaVnFOM1R0NWVwOEw4cWRYT0Vic2Y0Sjk4eGo5VXUzMWVZOUo0dDlzOUxxR3kxZGhyaTRVTmJESlNUR01nUDZjckN4d0JJT0J3Slc5dlBSbEV4M09mcHQrZGpjeDNJcVp4bUppK3k0NHZqbDA5dnJ4cnZWUExTWFMyenkwOHp1bzlwbWFOdU9Pd3RZRjJNdXR6eXU2bTVjZlU1UjFNN2s3c1Jsek1weW01bnRtYjRWTWNQQitMTDdXL2g1TWNaTERNU2VkU2Y4QUJXUHpIb2ozL0Y1MzhxNlQvU2oyNS84QU02OVBlLzhBYjU4WisyRlBvdlRuYVdncXFIWDJvMjMydW1tZk02YUdPbnROdkVyR2htVnY1ODBqY1R0T0RjQmdTRjNlajJ1ZkdYZFQ2THlYNUQyUE9OdmQ1Y1JobGhqTXhXcWJuVGxNUnh5bnZpTzdqMk9zanhIcVJwM3Z4cEM5Ym9vTHRRbVVodVk5SjFRMWttQTU1Q2NFNmJMVHVZejZYd2Z5VDVoK1I4NDZUZTdzZDdDL1ZPVVJQdW1YOUszZ2RhakQyOHU5N2Qveml2YlJNMi9vVVZKR3pZT0gzM3UrSzdIekJ1NnQ2dkNIN1ovY3JxK2Ixc1krRVRQMHpNL1pFUHVhOEorZHZobmszMk0xQjNtN3g2SHVjVWIyNmEwekJkS3lXY01MbUdldFl5QU1HVnBPWUNNTy9nOWZaOHE2ckRZaktjcDdYMnZ5MzVsdGRIMHU5T1dVYXM4c1lydnFMbS9WeHAxLzk2L2FBNzI2czhnTlQ2cTB4WlpwOU5YUzZWVjBocVNXUnRlMnFtTTdqKzFlSGZuUFA1RndiMldPV2N6RXhVejR3L0x2T3ZJK3A2cnE5M2V3akhUbm5PVWZmdzc1dnMxWDduWXI0UStPMVI0eDlocUx0dmNHeHR2SmxmVzFnaEljQkpJeGtlQmNDUVRnekhaczJycWRSbkdVeFhaRVBlNVdHemhodFlUY1lZeEZ4ZFRQYk0xUFpjL0Y5ZVhBeTRDKzVWM1V0TjU4eGRGZHRLQ3JZK3UwZllibnFDdWlqYzV6b1pycTVsQ3lPUVloclNZaTE0M25BakVZWUZmUmVTNHpHTXo0L1krdTZIS2VtOHAzYzVqL0FLdWVPUDBZOGZydUhVcDNiZDgzcTY1dnd4RHFxb1AxeXVYclUvamp6RGMvejl6L0FIcCt1WHBRdHVNdU9HeEtkUG1QYTlGMC9SbllRT1NsTHpIYVg3SGZkS3d4NjcxTjJxdVVzY1dvNnkwVWwwdGtVaHdmTkRTMVVzVTRqMmJTREkwa1k0NERIQWdFangvT0luVEhvbC9SWHlEc3hQeTdHZU1mL3dDalBWOU9HRVJmczRkM3Rka2k4QjdUMXJ1VDJlN2JkM2JleTJkeExWRmNxV0lneGw3cElwRzRITmdKSVhNZmhqd3h3WE50YitlMyt6TG4yK3AzTnVLeG5oZC9TOU1rOEcvRmFWb2EvU01KQUljUDZYY2Q0QkgrL3dEcXVTZXQzSjcvQUttZC9leTNxMXpkVGNldDRPby9BYnhoMUJhWmJWRnA4VUxaR2xvbHBwcFh1YWVmOUpNZyt4YzJ6NW51N2VWOEpmUmVXL052V2RIVVl6RTR4M1RId3FYVS93Q2ZYaTAzeC83cDNYUmxLeitpTmxhNkI0R0RaSUpHaWFOd09BRzFyaGpodU9JNEw3VFByc2VwMk1jc2UvdDlFdzcvQVBldjVvdzMvbERhNWMxTy92NDQ1UmZab3h5eXlpZlZsR1B1bjBUeDgwOW9lU291VFc1TVNUc0dHMWRDbjhXY3gyVGUwMzR6MDF4MWt6V0YzaGE2M1dKa1Z4bWE0YjZtUWtVakNENnRkSi91UnpYbmVZOVJ5OEtqdGwrMi93QnRmTFB5dlM3blg1Ujk3Y3ZiMi9WLzZtVWU3Q0o5T1Rzalh6YjdCeFY5eFB1Ujg5ZnROZGxhT1pwc0ZLMmJYZXRJdDRGc3RUZyttaGs0Wlo1bXVCQi9WQlh0ZVQ3ZkdjNTd2MGw5WjVCWFRiRzd2eiszbC9sNGY3MlhiTWVxUHRoeDU5cWJ1SkxXK1cxYkhYemdWMTlvTGlIaHhPTXN1Y1ZyZ01Edi9aRjIza3VUcnN0V3pNZUUyN25VOVZIVWVXYjJFZjhBcDdzVDZvbUloMllMd1h3N2l4N3Qrai82eGVOMUxkV01MMzBOd0VUOHJRY3NWVFN5Z3VKM2o5b3hnK2xlbjVYbldjeDR3NlhubTN6Zkt1cnc3NHh4empqMzQ1NDMvd0FNNU9sWFZ1bUFMdklBM2M0ajdWN2xQd0dOeDJQZUxHbXBLQys5bWUzZEtNSzZudTluckpHZzV5WTdWU3VtbU8wRFlEZ1NSaGh5NEoxazZObkwweFQreHZsK0k2VHltY0ovZDJOUDB6akVPek5mSVBoR054b0thNlcrZTJWcmMxSFV4dmdsYmpoaXlScFk0WWowSzFqbE9NeE1kemsyZDNMYXpqUEh0eG1KajF3K1FTZUFQaWhQY25YV28wckZKV1BmMW5HU2VvY0M4dXpFa0YrM0U4OWk1cDZuS1p1YTlqcmIyeHRidTVsdVo0WXpPVXpNOE8rZU15K20wMmdkSTB0enByekZSTU4wbzg0cFpuRnpqRUpCbE9VRTRmbTdNY01jRmMrcjNNc2RNendlaHQ5YnViZXpPemhPbmJtb3FJaUk0ZnBmcmZxMUVwZ2dmTTFqcEN4cGNJNDhDNTJBeHdiaVFNVHcycnJ4RHJZNDNNUjJPdmYzUi9KcnZ6cUd4MVBaNnkyS3Awdm9LVEsrdWtyYzN6VnlaMVdpSU9MRzVHTURoamtZNTJiREhOZ01GN1hSYk9HM2xjVEdXWG83SWU3MW5tUFNlUmJNVHRia2IzV2J2M2R1TWV6Q2N1R3FlKzQ3b21JbWV5dTl3NXVkN0Q3OUZSeEgraVVqV3h0R0d6TEUzQWJQb1gyUFVaOG5hcnZsL1Nubm5VWTRSanM0VDl6YnhqR1BWRVZEdCs4SnRPeGFYOFZORVc2TEtUTGJZNjk3bVk3WFZqM1ZaeEoya2pxWWY3Qy9QdXV6MTd1VXY1cithT3A1L1g3dVhwcjJSRWZZK3BycVBBZkwrOFBpQjJUNzY2a2JxdnVOUlRWZDJaRzJCaFpPV05heGd3QUFBSzU4ZW9tTVl4cU9DZFZ0N2ZVNDRZN3VFWlJoZGRzZHMzUFpNUFRhajJ5ZkU2b1AzclRVZ2JzQlVnLy9BS1RDazc4K0VlLzR2T3o4bjZXWjRZVjlPWDJ6TDhiVi90ZWVGMUZwcXZ1dDh0RlFMWFNVODFYVU9kVk5hQkhER1pIRXU2WndBQTVLNGIwek1SVU45UDVGMDJlY1k2THVhN2N1L3dCVXc2bnRSVDJQU09ucWEyV0pqWWFKelgxREdOYUc3S2lWMDJPemYrZHY0cjc3cE5tSmpHSTdJaC9mZnliaHNlUi9MbXhzN0VhY0pqTEtQVmxsT1VYNDhKN2UvdGZVZmJVdGY5Yy9NTFFsRks0Wlk3bCtKak5qdnQ3RFZqODNiaVN6QUxnODkzb3cycHhqdy9VL0l2bmJ6U2N1bDNzcDc4WmoyOFB0ZDFhK0FmemcvQzdvVWR5dVBiZS8yMnp4dWx1MVZiNnlscG1Sak00eVRRT2piZ01EaVFUamd1YnA1aU56R1o3TGg2UGxHV0dQVmJVNXpXTVo0ek0raUp0d3oxWjRYYXp2Ti9ucUtXM1Zab0FUMGMxTE5nVHp3eTRMOUIyZk1Pa3h3aU9aRDk1K1gvbTN5L3kzYTRaNDY4dTJiajR2YnZGL3dmMVZvUHZkYWU1Mm9BYWUyV1dPb2xZSlJsZkxOVXd1aERHdE8wWUFna2tlbS9kNFhuWG1tM3U0emhoTnZrUG0zNXQ2ZnFlbXoyOXZMVmxuTVI2SWlKaWIreVBiMk9YYStWZmtqNTc1WTl3N1YycThhZGNhOHZNN2Flam9iUFd0YkxJY0dpYW9pTk5BTnhIM3BaR2dZakRFcm42V0wzTWZYOVQwdko0LzkxdHpQWmpsR1Urckg3MCs2SmZ5aitSdXNHNmoxWmNMa0hZbWFWNzltN2E0bGQyZUw4MnozSnp5bktlK1h3QytnU3p1SjM0cVVSay9Ka2lMVGdWbHlSTEY4WU85UnFKWVNSYzkvTlNtNGxrNW5BNzFISkVzSklzTm8zY2xHNGxrNXYxS05XemtpQlJxSll2WndjbzNFc1h4a2I5eWpUTnpNTm8zS05SS0NBZDZOTTNzSVJiWnVaajhWR29sbTV1R3dxTnhLU01QZ28wemZIanRDQ0NNRkdpTGNmaWkya2pnVVZENCtJM0lNeU9CVWFTVzRmQkZzbEZTNWdLTGJNdEkrQ0tramtpa1J5VVVrQWdFQWdlOUJTcklRYXNHRFVTVklodEhGVkpVQmlVU1dyQU1NVldWQVluQkJXNUdWTkhGVkpXMW8zbmVpTGFNZHBSSmFNYmo4RldabG8xdkFibFdKbG94Z0F4S3JLd0NkZ1FhTVlCOFZXSmxySEh4TzlHWmx0SEd0TVRMVnJRMzRveXRyTWZpcWt5M2poNGxWaVpieHhxdU9aYnh4WmRwM3FzVExWa1pjY0J2VlltWHNHazZKNzZwbUE0aFdtSnljc1BEMnhQcU5jMjF1WFoxR0hIL0FIUVZjY3kvcUE4VUtGMXU4Y2RIMGo4UVJib25nRVliSkNaQnY5RHY0cnA5VC8xSmZwUG1tVjcrVmQxUjdJaUgwSmNEendnRUFnRUh4ajNFcjEvVi93QUh1NTl5ek1iL0FOQTFsUGpLY0IvU1dpbXdHMGJUbndIcmd1ZnBZdmN4OWIwZktNdFBVN2MrR1Z2NXdidmVTNjRRc2M3RnBjL0Q2WGxmUjRaVkw5YThzODNqTGV5eHY5S2NwL0F5eWZQNnpwN2t5TXlDRXRmbFkwdWNjTnVBSEVyNkxvK3NyR2I3b2ZhZm5JMmR2TGNuc3hpWjlrVzc1TzNHbHhvbnQ5WTlIN005cm9LU2dlNXJRM00rQ0JzYm5ZQnp0cGNDVDk0L0U3MStiYm1lcktaOFpmekp2YnVXN25PZVhibE16UHJuakw5cFljYitmcjNVdTdUdTZQbmQzSTFGREoxS0MzWEIrbktSd2VYc3kycHJiYS9JY0dqQnpxY08yRGp2TzgrM3NmY3h4ajBmVzdmVythUnNaOVB0eCs3aE0veFRjL1ZEMXJ3NXQxeDExcnkxZHVMVzV6TDlxYXRoMDdSeU5Ec1dTM0Y3YVJyOFJnQUdtVE1TZGdBeEs3czd2THhtZlEvVXVsOCswZEJ1WnhQR01acjE5a2UrbjlFMUhTUVVGSkZRMG95MHNMR3hSdEpjNGhyRzVRTVhFazdCdkpYeTh6YjhpbWJhSVA1LysrL2MxdmR6eVcxbDNCcDNab0w1ZnE2cHBUc0g5R2RWUGZDTUdPYzNZMStHd240bGUvdGZkKzc0UkQwcDgzNVhYNDR4UDdHR0dQc2kvcm1YYng3WStsdndIeGxwTHBJd05udU5SSTlyOEc0dWloWTJFQWtiZGp3L2Yvc256L01NN3ppUENIcC9NL21QNXJleHFlR09NUjlQYlAyT1JDNkQ1b0lCQUlQamZmNzNCZkRmeG50VTlmM2E3Z1dtbHVVTWJwVzJhZ3FXWEM2UzRQTVlheWlvakpOOTU0TGN6bWhvSU9KQUJJNXR2cDg4K3lIUHRkTm51VHdoMDJlYy9uVjNDODZPNk1mY3E0VUVsazdXMHNab2RJMldaK2Q4ZEtYWm56eU9hR2gwa3p4bWNRTU1BR2pFTkJQZnl4amF4MFIyejJ1djh5ZWViUFNkSmwwT3pPclBPWW5PZkNwdUkrcjZMdnRjMnZZazdmbUtmVVd1cEc3S2VoaG93Y1hENzFYTUpBY0FNTjBMdDUrdmgxZDNoaDY1K3A1SHkvdHhqMCtXVmNjc3EraUl1ZmZNZXgyT3JxUFlmQWZjUDgwS3Z3ajdSMjN1SmFyWEJlTHJjTGtMY0tPc2xmRXdRTnBaYWlTUUdMRjVJTEdEQUREYjhGMk9uMlkzSm01cUloMitrMnRyTFZPN2xweHhpNW50Y0I3OSs4MDZvczczTlpvRzFQdzNFMWxlUDRHTHMvbGR2OFNmblBLZjllZjRjdmc5YXIvM3FMV3RMc2k3YzJkeDRZMTF3L20xUHl1MytJL09lVS82OC93NWZCOFc3amU1anEvM0hQSU9nN3BhbnN0SHArZzB2WkhXT2l0OXZubG5hNmFxcitzK28vcE9EZzUwWnlISzNjQmlkdUM5dnlYWndqS1lpYjRXL1UvN1hlYWRIK2I1ZXh1YXBqNzAzRXhQZEhmRWZwTDUxMmM4RXZuZTVyZmxiLzhBTFVvcTNTeFJ4MjhucFI5UXZhR2tWQU94dUdDNHN2SzZtZnZlNzliK1RmbS9yOC9LUE9PcDZPTnFwMnQ3UEdLbXVFWlRwbU9IQ0ppcGowTy8zdzdzdFpaUEd6U291UVA0bFhVcnJ2TzRqRE82NFRQckE3REU0WXRrR3orSGV2RDYzY25QZHltZkYreitiOVpuMVhVWmJtYzNNMWZycmo3MzB4ZFY1cjBtUHlRN0ZTZDBuZGtocWloSGRkaitpNnhQa0xLb1NHTHJodVZ3QXhMTm8yN2VDNWVUbHAxVndjdkl6MDZxNFBkbHhPSjR0N3ZGdjA3WmF6VUYyYzVscm9ZSmF5cGZGSExNOXNVTVprZVd4d3RkSThob09EV3RKTzRBbFdJdWFYR0xtb2NFUExYMzRlekhhZXkxMW04ZjdSVTZuMTgxajIwZGZkcWVTa3RFY3JaZ3dHU056NDZxUnBZSE93QVoraU1jU2N2b2JmbDJVL3RjSHZkQjVIbHZaUnFuaDRSMi9CMXg5a2ZJWFczZUh5SDFQM1c3bVhFM0h1QnFLbm5yYnBXT3lzWU1KWXNqR01ZQXhyR05BYUFBQUFBTndDK2k2SGJqSGhENmY1dzJNZWw4cXhpT0VZNXg5VS9wYjVYcXFvTjN2TlZYc0dXT2FhU1VOR09BRDNsMkczYnhYWnAvQjNWZFJHNXU1WlIyVE16N1pmblU5dGUrUWJOcFNuQnpIdGVrckJQTE0wTmFTY1JodlNqbUgzTzFsM0s3Uzl3N0pxUHQ1VjFsdDFaUVUwYzlMWDIyYVdscUtkenBwUmpITFRscjJ1dzQ0NDdlUzh6cTVySi9RdjhBYm56dmM4dTh0eG1JakxEUExMVmpQWlBINitEN2pvbjNzZmNLMHBab3JYVzZtZlhVc0xHUlJTWE8xV3FwbUFZQ01YVHZnYks4bmk2UnppZWE4NmRqYW51ZmR6OHllVlo4Y3RqUEdmUlBELzhBVkgxUFk3Vjc0L201ZHBteXpYOWtiMnVBQWl0Rm9FYnRoeERtdWlPL0VjVk9SdGVEam56L0FNcW4vd0JMY2lQUlYrL0oyWCsybjVVOXkvSzdzalU2djdvMGtFZCtvS2xsR3l2bzR1Z3lyWTZuYkppK01PYzBTQTdYRm1EY0hEQm93T1BTNnJheHdtTlBldlV6c1o0NGJteGVuS0xyTHRqalg2ZHZyY2kxMVhVZFd2dXVUalZua1JjU3lSOGxKVE5nb29tUGRHNXJUVDA3R1NaTWd4QTZ1Y0VPSjJqaHVYMS9sMkducDhQVGMrLzlUNUwrOFBWeGg1WjVic1JseG1kL2NtUFhsaGhqUFpjZnNaZC9HYjRlUEhidGwyNXA1N3NLK3FaL1FhZjl0TGdOcERUc2FQVW5ZUFZkbkxoRnZ4RHl6bzl6cnVvdzJNUDJzNWlQVjZmVkVjWjlEdUQ4UU95Nyt5ZlpPM1dTNlFpTFdGeEF1dDZHR0JaVVR0R1dEYnRBaGpEWThNY01RU042K1I2dmY1dWN6M1A2Z3l4dzJzTU5uYTRiZTFqR09QcWp0bjE1VGN6NjMwcTRWOUZhcUNlNlhHUnNOdnBvMzFFODBod2F5T05wZTV6anlBR0pYV2lMWWlMZGJIZVQrdm11dEFkd2ZKdXFwWi9tKzRkd2RhTlB4U3RlSFFXU2lxSDB0UEdXdUp3YytHRjVkaHNPd2hmVWROaEczdFRGOGYwdDcyNTFuK1p0N01mczdPTTVUNmNwajR6RDVuN2VsSnEvUkhtZm82NlZkTStDam1xcHFDUjhqSEZ1RlhUeVVwSDBpVEFIaHZYbmJzNnNjNGVINUQ1anIyK3IyNS9lMHo3Sm45VHQ1WGpzUGozbnZZSWIvd0NKMnJXeTVXeVVNTk5kR1BreHdiOG5XUlR2d3k4WFJ0YzM2VjJ1aXkwN3NHZUhNMjl6Yi9IdDU0L3hZekgxemJwZzFCb1A4UjdnUjJRdDIxRlhIVGJqL3dDTWxEUDBkdkhndnFZeHQvT2ZRYlhQMzl2Yi9GbEVlMmFjL1BEcTN5YWk4MGRKVVFHTlBZTE5kNzlLd3VibC9wWU51WWNwR0pJY05uMmNWMVBPY3F3cC9XblZkYlhTNTQ5K1ZleUhZSXZsM3k3NFY3a1BlalVuWVh4SDFGci9BRWJjSFd6VnJIMFZQYjZ1SWdTaDc2cGozaVBNQ01URXgrOGJzVjJPbHdqTFBqMk8zMFc3dDdXYzU3bU9ySEhIS1pqeHFKZFFsUjd3SG1jMnNkVFJhNnVwT09VZmZwOStQL0JydjZkdjhMZjlZZVhmL2ErK0haSDdYUGtsNUo5enRSWG50dDVDM0tPNzFjTm9vTlMwVlE5a1lxNlZ0VjAyaW5sZEV5TUU1SGh4RGdTRHhPSzRlczJNY2NZeWlLY3ZWZFQwdlY3T085c1lUaGN6RXhQbzcrOXpOWG5QTWNiUGRRWmJCNHlSMU5jd3Vxbzd4US9LdWFCOTE1am16WThjTWdkOU9DOWJ5V0p5NmpHSHIrUStYWWRiMW16aGwrN25obkU5OFRobEdWeDlFVEhxbVhVOTg2WDNhUWIzeU95ZnlqOG45dGZRK1liL0FETTZmdEh6QjVuR3pqY3p4bVhlN29EVGJOSGFFc21rSXhoSGFxQ2p0clJnMGJLYW5aQ05qUHUvbzhOaStLenkxVE12d2JxTjJkM2N5em52bVo5c3YxMWx3dXVIeWc5OWkrZVB2ZDNVbmJlaDBsYnEraHNkeHJiWkRVelZOWXg4ckthb2RDMTdneGhBTGcwRWpndlF4NlhDb3ZMaTdtZTk1ZHRWanViMHhuVVhHbVpxNHZ0aUpmRjd0KzlCYXN0enl4bmI2MHVJNTF0d0gvMEUvSzdmNG1menZsWCt2UDhBRGw4SHFIY2o5NWU3cjkxdTMrb08yV251M3RycGErL1d5NFdkbGZCV1ZqNUtYNXVrZlQ5ZHJKV1pDWTgyWUIyd2tZRmIyK20yNHlpWXk3M0xzZVkrVjdXZU9lTzlNempNVEVhY3VOY2EvWjczR0xVT3VxcTV6d1VrOGhlNkdPS0J4SjJucHNET0d6Z3YwTEdJMk52ajIwL3JQekhyTXRycDlycDcvd0NuaGpqL0FBNHhIMk9hWHNnMk9iVW5tREJjNDhIUVdPeVhDNHZKYVhZR2ZDaDJIRDdwL2JEYjlIRmZHK2I3MnZHWjhaZmlIejE1bEdpZG1PK3ZydjdIY0F2bkg1WS9FN2dkeHREOXE5TlM2eDdpWE9HMGFYZ2N5T1d0ckhGc1RYUE9EUVNBZDVXc01Kem1vNHQ0WVRuTlFmYi9BTGphRDdxNllnMW4yM3U5TGU5SzFCYzJLdXRzekpvaTVod2N3bGgyT2FkN1RnUnhDWjRUak5Ud004SndtcDdYN1N5dytWZVNubVQyVjhWYUNPcDdveTF6cStlTXpVdERiS0NlZVdkb0R2OEFGeVBES2ZITTNMZ1pRUVNNY0J0WFkyZW15M09NZGpzN0hTNWJzWEZSRWQ4eTZmOEEzZjhBM1pPNHZrZFlZKzFtbGFPWFMvYWg0anEvd21WN0hWdFk1MElQV3JYTWRzWUM0OUpnR0JCekhFNWNPN3Q3TWJVZU15NmZtWG5XeDBlem5zN0V4bnVaeE9PV1hkamoyVEVlbWV5ZlE2bGRlWGVTcnFYa3V4SkoyODBmQ1JMMFd0L2FPT0tqY1M4T1dMWmc3Y28zRXZHbGhMZmh6VWNrU3hmSHdVYmlXTWtXejBVYmlXRDJZYkQ5YXk1SWxsSkZqdEc5UnFKWXViaDhVYmlXYjR3UW9yRjhlR3c3bEc0bGkrUERhTnlqYko3T0lVYWlVRWNDalNIc1FadWJqc0tqVVN6YzNEWW81SWxCR0JVYVE5Z0l4NG9NeU1EZ28wUkdJUVNqU0h0SDBJTS9SUnBKR0JScUNVRXZIMm9zTWtVanNPS2lrUmdjRVVrQWdFRk5IRkVrMVVVd1l1UWFveUVGQVlEQlZsYkI5cUpMVlZEYU9LSktrUlFHT3hWbG9nc0RncXkwWU1BcXhMUmd4MktzeTBSRnhqaWpNdFl4aTVWbHZHTVQ2S3NUTFpnNHFzS2FOcUpMYUZ2RlZpWGtSakVyVEV5M2lic3pjVlhITFZneCtKVlpsNTlCU09sSURRcTQ1bDc5Miswdk5WVlRBMXZFWXF1SnpyOEIreFdvZFU2MnR6N1pTUGxlNlNOa2JZMk9jWE9MZ0FBQU1TdFExdDQ2czRqMHY2TyswK202clIvYkRUMmxxNFphKzMyNmpwYWhwSU9XV09uYTE0eEhBT3hDODdleTFaelBwZmQ3dWV2S2N2RjdBdU5nSUJBSUJCeHY5M2E4d1dIMjV1NTl4cUFUSDhsUVU0eVlZNXFpODBsTzA3U05nYzhZK2k3UFIvOEFVaHliVzd5c295OEg4NE4xdkxIM2FGb2Q5NFluNnppdmF4M0xtWWNubHZuczRkWGx4NzNZMzdNdW1mNjM5MXRQMC9URW5VdUZOSTlqODJEb3FWcnF5VWZjQlA4QWk0bmVuTWdiVnZlNmlkdmJ5OGErdCtxZVovTVBLOHV5eXgvYXlyR08zdjdlendpNThIZG12bVg1Ry9EN242OXRYYXZ0cnFIdWZmV3VmWk5OMnl2djFZeUxFdmRCYjZWOVhJRzRBN1MxaHcyS3hGelRPV1dtSm53ZnlvNjc4aWEvVnJxeldXb0pIVFgrODFOVmM2eVo3WHZjK2FvbWM5N2k2UjduSEZ4SnhjU2VaWHFaNS9lOVQ0N3J1dG5kM3RYaFVPVVhzUDBzM2YzM0l0QzJpYUhyYWUwMDI1Nnh1QXdZektMZlFsbEkvd0RhUHhPV3RrZ09EV3VQb0JpNGI2bmQvd0FwOVowSG11VzUwL0s4WmkvVkhINjZmMFVMeDNPK2QrWEhjNkRzejR3Njk3bXl5OUdlMDJPNFRVa2h5SCtsdnAzUTBvL2FCemRzNzJEYUR2M0hjdVRhaThvaHg3MjVHM2pPVTl6b0I3YU9mZU5lV3VrRzEwa2paU0R5ZTdQdCt0ZWpHNTkrWmZINTlaT1cvT2ZwZjBDK0x1bFdhTThlTkhXQm95dWJiS2Fxa2JpMDRTVmJQbTVCaTBBZm5TSDhwM3J6OS9QVm5NdnNzTTV6aU1wNzN2cTRtblJ2N3Yza1JmOEFVZm1sM0JoMDVlcXltcyttbjBOaWlocGFtZU5yWFV0STJLb0dWMkdHRTRlZnVqQTd4anZQdDlOaE1iRTVSSFk1SXczOHVpNmpxTm1wNUU0M0hvbTc3NDdPSHc3NDRMMy9BTWg5ZU1uY0dha3VZK0ZiTCtWY1A1ckx3aDhmL1ZIVWVHUHNuNHZXYngzanZsN2xFOTR1MVhWemhvWUgxTlE2UndhQ1RsQmRpY01UdVYvTlplaEorWitwbnMweDlFL0Z2b3ZXVnNON2dyYWlNVHpzZUhmMGc5UUFnL3F1eEh3MkxHWFVaNWQ3cGRUNTcxZTlFeE9jeEhvNGZWeGNzN3JTZjZTdEpXclUwSDM1L3V3eW5lZlJjVXZBMjVxYWR1ZnRGZHZQNm1lTkUxM2xpTWRWZEs5eldsd2VNOE5MQXlOcEdiN3BIVWRJTVFQcDREZzM4dXlINkQ1RmY1ZVBYTGxTdUI3RHJJL2VEZGNDdnUrZysxVkc4T3FhV2h1ZC9xb0EwRTVLdVdPa2djU2VHTlBJQU1QcjRkM3A1ckRMMHZJODM2emw3YzRSKzlIMnVsN1dta2JzK3BsYmtmZ00yVTVUdElWdDhicWVnM2JTVjZZUzdwTzJlaFMwMXZwdmgrKzRXSHVYOG5PQ3lPc2hjdzVnUnRqY0pCL0F2VThtM2RQVVkrbTQvVDZYNkwvYTN6TDh0NXp0UmRSbkU0ejlNWEh2aUhZLzJXc2NqNWFpNzBZL3BVdEkxc09YRFpOT0JTczRqRDc3Z2NTdmI2My9BQzlVdkIvdmg1SkhUZk9tT2NSOTNxTWRyZHJoM1JweTl1VzNsTTNVM005MU81elRGa2gwMXBxM2FjcHYvSjdmVFFVVWUwdSs3QkUySWJUZ1RzQytEeW01dDlHODVRZEtkeDdxM3dlV0dwZkpiU2s1RitpMUJmdFQyMXhZWWdhZTJYS0NZTU9YRTVUVEdWcm11eEJBd0lPOWZRWTQzdFZQZzNIV1gwZVdmaGxYMGY3WGNwMjkxeFllNW1oYlIzQzB2S0p0UDNxanA3bFNTTk9QN09vakVnQjNFT2JqZ1FSaUNDRHRYZ1pZMU5PSERPTThZbU95WDZ0UlQwOVpUeVVsWEcyV2xsYTZPV0tSb2N4N0hESzVybXUyRUViQ0NvMjZHUGR0OGJhenh3NytYYlR0SkdXNllyQ2J2WnBNQUErZ3FwSEdNRERERXh1RG9uSEFETTA0Yk1GOUIwKzl6TVludmZvdnl6MWNibTNHTXo5NlBqWCszMXVNWGpWZUttMjYvdWtnY1E0MjJzRGNPTGcwWmQvcXZXNlR0Y1A5Mk4vay9MKzduMzR6SDJ3OWtucENYYldydFUvZ0xXOG0wMi9xVEFGdXhLTmI2OTJiMHhTVFhObFZVeGcwOU8xMVJJTXBQM1ltbVE3QnYyQlRMaEZ1YnA4ZWJ1WTRmaW1JOXN1MWZRM3RzZU0vY3p0aHBQVlBjdXh1ZnJhZXpXNlc0dm81WDA4ZlhscG16eUFNY0NSZzl4QXgyNEw1RGY2L1BMS2V4L1QzbDNrdXowM1Q0N09GNlk0eHg0OFp2dzlMOHZ2SDdXZmhUcGp0WHFQVjAxaHJITXM5c3JydDA0cTE3Qy81T2xmVVpjd2pjUmprdzJBcml4Nm5LWmlPRGszUEs5ckhHWjQ4SWRNanRCWHFEVVV0TFMwYjJ3T21jWTJCcnNHZ3UyRGJ0MkJkMlh6bWRYTmRqdkE5cDN0MU4yLzhOYkpMV1JtT3Z2RlJWWE9ScjI1WEFOY0tKZ09KSnd3Z3hHd2I5M0U5RHFzcnk5VVBydWh5dlp4OVRrb3VzN2JwMjd3NjJmM2IxeGVOY09xUlZVTjF1dDVycUFNRVFZeWttdTlRNkFNRVFHQU1lRHZ2RnppVHRQQWZaOUZFOHJHSDRIL2NIem5jNjNyb3h5bThkckNNY1k4SXVjcDkrVXZzdmdQMklpN2dkNnJQQlhRZFhUTmhhTlRYc0VmY0w0M1piZEE0N1FjODRNam1FYldzOVYwdk5lbzBZNlk3WmUxL2JYeStjdHpQcUpqc2lvKzM3STlyc2tYekw5aVkzQzMwTjJvSjdWYzRtVkZ0cVkzMDlSQkswT1pKRkkwc2V4elRzSUxTUVFyRTFOd1B3Nmp0SjJ6cTdkRFo2cXgwa2xvcHdCVDBza1RYUXhBREFaR0g3cmRtellGeVJ2Wnh4dHZtWmNlTThXRkQyUTdQV3k0d1hlM2FadHNGMHBaR1ZGTlVSVWtMWkk1WTNCN1h0Y0c0Z2dqRUZUbTVlTThYRnQ0UmhlbmhiMmxjYlQxN3UxcGVIVy9helVtanA0VFVSM1cxMTl2NkRNTXp6VVVyNGdHazduWW5ZZUJXOXZMVGxFcE16RWNIVGpwbXpSWGZ1aGFMbzhZOVZyTGc0a2pFT0ZQMXRwSEhOc0srMTZmNzB4TDhSK1hlbS84QSt4amhIWmpuTS93M01mVkRtbjdaZHJndlhrZjNLMVV6STUxaXRWazA4MThiUmpoWEY5d2VIT0p4eERvOFB1N09lMEw1L3dBMjN0V1ZlbCs0YjNVYTkyY083R0k5N200dkhSd1U5Ky9XdFRadkdiVDJqS2N2QXZGMmtxWGxoQWFXMFZLNW1WM0U0bW9CSERaOEYyK2s0WFBvZWQ1bjFFN2UzTVIrOXdkVVhpbDJMcSs2bmZpM1V0eGdjN1N0cmNiM2QzWkM1dnkxSCsyeU8vdTNBTitsZWgwKzF6TTRoOHZ0YldXN25qaGoyNVRFUjlMdDc5cUsxVnQ2MWYzWDduWEdOelJVVjl0c2RMaTNCalJRMHp1cXhoZGljQml6WU1CL2E0L045eUp6MHgyUSs2ejA0Wnp0WWZzN2RZeDlFY2ZlNW1yeUVjTC9BSG90YndXSHRUbzNURDNsczFiYzYyNTRabTRGbERiM1U3c1duZjhBZXEyN2NObjByMWZLTXRPNU9YaEQ2WDVQbWY1anQraU1wbjFSRmZYTU91bnhrb0lPNC9rZG96U0x3WklicnFDMDBEMnRMZ1JISldzenV4YUNRQTBFazRiQXU1MUc3VVRMWHpwNTV6TitOdkdlOTN6TDU1OHd5cmF1T2dvcHE2WUV3d3NmSzhOd3hJWTB1T0dPRzNZaVROUDVvUEtxcnVldSs0OTcxRUdQZEpWVmM4N3N4TDNZeVNGMjF4Mzc5NjlIUExpK0E2M3FPYnU1WmVNdU85NTBOZTZ1ckxXeFB5NDdjR2xZdDFvemUxYVY3VzNUVDFOQjg1VHZGZld2aWRKaTA0c2h6QnpXOHdYYkhINkY2SFFiT3JQRysrWWQzeWpEOHo1aDAvVDkyZTdoRStxY28vMnZlRFVUVTFVWmFqRVBKM0ZmUmVZOVZxbW9mMmw1bjEyaUp5bVhhRCs3dmFZWmN0Vzl4dGZ1SDdXZ29iWloydXdidXJwWDFEaGlmdkRiU2pZTm5QZ3Zrdk1NN3FIODcrYitaL25PczNKaWVFVkR0SlhtT2k0cmU3aGNvbStQTm4wNVV0RHFHNFh1RjFWaTdCM1NwcUtvbXdBMmJDL0lISGxqenhIb2VXNDN1WFBaRVBYOGg2VDh4MW0zaGxlaTVuTDFSRXpYMHpFUlBvdDhJOWt2eU5sc212TldlSDE4a2trdFRuUzZwMHM5K0x4RmhrWlZVNWQ5N1k5aFpJM2MwRnI4ZnZPd1d1dnh1ZFRvZWFmNUhXN216NFR3OVhiSHVka0M4MTEzeFB6czdSV2Z1SDJWdUdwNWFGbFpmZE8wODl3Z2E1b0JmR3lJbHpYT2F4ejhyVGc4akVEQUhFamVPZll5NDFQZThuem5wZWRzelU5bkYvT041ZVcyL3dBR3Vyck5xQ1IwdDFtbWtsbWxlQUM1eGR3RFFBQU53QUFBR3diRjZGUGpzZXluRlRWakh0cVg1a2x5UkwxcXBZTVR6RzVaY3NTOFo3UjlDamNNSHQ0RlJ1SmVOS3pBa2ZTRkhKRXNYZ2ZRc3R3d2tidkJSdUpZdUhEaXN1U0dNdzNPVWJoaTRiVkdvWnlOeHhITkZoZ1Jzd1Vja01YREE0S05NM2pBcU53bHd4R0NLeWNPS2l3emtIRlJ1R2Joc1J1RXFLeWtHQlJZU29xWERBb3NFNFloRlpPRzNGUllTNGJNVWFoS2lrNFloRmhtOFlIRkZTUmlNRUVuYU1WRkpGQ0FRV0JnRldRZzBpR3pGRWxhSWJSaVZVbFc5RWFSamlxeXRCUUdBd1JrMmpiaXFrdEdEaWlMYU1TaVN0Z3hLck10UU9DckRWZzRxc3FRYU5HQVZZbHJFTUJpak10NHhnUFZhY2N0UU1CZ2lMWUZXWmVSRzNBS3NTMmpidzRxdU9aZVEwWUFBS3NQSnBJVEk4QUJWaVh1T2o5TnZyWjJnTjJIK0ZhaHg1UzVXZUpIakRmdTZHb3FXZ29LVno0bnZhSEZyU2Q1dzRLc08vOEE5dUgyK2RMZU51aTZIV3VxNk5yKzRNMGJYMHRQS3dmMEZwR3h4Qi84YVJ0L2lqMTNkVGUzcjRRK2o4dDZIUkd2THRuM09XQzZ6MXdnRUFnRUFnNEcvdkMza2wyODdVZUJ0MzdRWFc2eHhkeWRjVkZ1Z3RObmpMSDFFdExRM0tHNFQxRDJrNW1STjZBYm40dUlhT09IWjZXUHZYNFBPOHk2aU52Q3I0eS9uanVlclFMeFR5NXRoYU1WMjR6cko4cGoxTXh1YW84WGFEN0l2a2RwTHR2M0wwek5mSklHVVZWV2kyVmsxVEtJVzA4ZGJUeVVnbkwzT2F4clkzU0J6aTdabHgzSEFqWFc1NnNJZlp4NXhPOXRiZUU5a1RNL1RWZmJMdk5Ya3V5L0oxNW9uVFhjdlExNjdjYXpwbTF1ajlRVUZYWkx0Unlocm1UMGRkVHVwWjRuQndJSWRHOGdnamlyRTB6bGpHVVRFOWt1dGZWZjdyUDRnMzJ1ay9DZGI2am9iR0hFMGxLOWxEVVNSUmZvc2RLV016NGJzY29YTHpwZUhsNUR0ek42cGNsZmJvOW9meGc5dHFxdXVxZTFMNis5ZDBiM1RtMlYrbzc1SkdaV1VQWGJVR2xwb1lHdFpGRzU4Y2JuNDVuT2MwSEVBQm96bnV6bHdlajBmUTRkUDJYTXVWSzQzZGRmUHY4QTNtSHBidHI0OFUzaWpwbTVReTkzdGZWVkc2dnRzVDhaNlN4VWsvemI2aVFzT01mVm5oalkzTVB2dEVtSDVwWFBzWThiOEhpK2M5VkdHM292alAxT3R6d24wM0ozUThqYkxwV2d3SnE2eWx0MFhJR29uYkEzODBPNThBZmd1YTY0dms5cUp6emlJNzVmMFRVOEVWTEF5bWdHV0NOb2pZM0VuQnJSZ0JpZHU1ZEoraXhGSnJheW10MUZOY0t4MlNqZ1krYVYrQk9WakdsempnM0VuQURnaE0wL2wxN3ZkNXF6dXozQjFsM1F1WnhxTlZYdTZYaWFQYmgvVEtsOHJtbk01N3Z6bk8zdVB4TzlmVitXWXhvcWV5WDZkL2JEb01kM3l2ZG5jaUp4Mzg4cmp4eHJUTVQ3M0czVnRYVTBWMm1wQzRsckhFTmNkbUxUdEIrcGVQMUcxeXM1eDhIOCtmTVBrK1hsZlc3dlRUYzZNcHFaNFhIZFAweFhvOEg1SDRqTGppU1Z3MjhWKzlvKzZ2Wld0T1k0WWhFbDJCZTMvVXhkd2d6UU5RYzhqeTEwUU8zYU5vd1ZoMXR6aE51OUh4RzB0RnBEeHUwaGE0d1AyMUJIY2ljcm1FL1B1TmFNUTg1c1FKQU51RzdjM2NPcHVUY3Ywenl6YTVleGhIb3YyOFgwZFlkNThEOGxmYjY3WStVSGNQOEEwaTY3dVZVeTV0b1liUEJERXlGOGNWUERJK1lCdWNZN1h5T2NmaXVUSGNxS2VYMXZsY2RUbHFuS1lmSjVmWTU4WUtodUZUY0sxNzl1SjZOS04vOEF1U3RjNlhSbjVkMjUvZWw0bFI3RHZpYlUvd0NNcmE3K1NwZjhGT2NmMDd0L2lsd2Q5MWZ3SjdJZUJPdSsyMWQyMnVWVFUzYlVrMXhmVlV0VkJFeGtVRkVhYU5ybXZqSXhMak83WmdkM0RqMk9tMzV4empMd21KY1dHM0hsUFZiTzlqTXpPT2NaZXlZbDlUOEE3TS9XUGNmUTlpaVlaSFZ0N29Iek1HWUg1ZTE1N3ZLY1J1d0ZOdC90Yng5TDU5dXhHRTEzMDdQOXd2TXA4MitjNTQ2c2RqYnd4eDlXblhOZU1Ybmx4NGZIdHVYeGozbnBma2QzRy8wUWVQOEFyYnVtRGxtMDlZcnJlSWNRNDR5MHRGSk5HUHVPYWRyd0JzY1BpTjZ1TVhMaDZqYzVlM2xsNFJMb2E3Szl4VzJldjBiTlVPRDRwYWlwanFZbmhwYTl0eW9aM1lPQnpZNE9jMGZ3NEJmUjdNWHR2TzhzM09aNWZ2NGVFWDdKaDJyZXp6M3ZydFdkb3I5MkMxTFZNbHZ1Z2E3cDJvRjd6TEpZcmdYVkZJNzlwbUxneDJkbUllN0xzWWNNQmo0ZlVZMWs0L0krcTVtM09NOXVQMU9ZYTY3MjNCVDM0ZkdhVHVqNDF3OThySEUrVys2SWM1dHlqanhPYTAxcjJzZkxsR0pQUm1ESEhBZm1GeE94b3c3blI3dWpLcDczZThzNi9Eb2VvdzNzdXk2bWZER2VFMzZJbXA3K3gwc2RrcmRjWGErcm53Tklwb0tlUmxTL2dNN2dHdCtKSSt4ZlU5STczOStQTjlucHZsNmRuS2Z2NzJlTVl4L3V6cXluMVJFVmZqTWVMNkhVVW4zejhWM3FmdzVxZVZaNmNNbUdPNUtUVytrV2JVUDlXOUZYbTV4Zm5SVU03bjRadGtRWisxUDNkdUFqekU4T2V4ZGJySnJheW4wUFk4Z2pWMXUxSCtLSjluRjN5OXZkVmFZMTFvU3phejBWTXlvMGpkS0ttcjdaTkZJeVZycWFlRnNrZUQ0M1BhZnVrYm5INHI0YVg5VzdlVVpZeE1ka3YxYWlucDZ1bmZTVmJHeTBzclhSeXhTTkRtUFk0WU9hNXAyRUViQ0NvM01XK1REd1E4U0JkemZQNmswZjRnWENUL0cxblN6QWc3SXV0MHdObTdMZ3VYbjUrTG96NVpzVE42ZmZQeGZVN1BaN1hwNjFVMWlzbE95bHM5Skd5bnBxYUJvYkhISEczSzFyUU53QUM0NW0zY3h4akdLanNoOFc5dzd5MzAxNGUrTXQ5MTVWMW5TN2pYU0NheGFJb0lBMlNxcTc1V1JHS202VWJpTVd3dWNKWkNkbVZ1QXhjV2c2d3h1WFU2L3FvMk51WnZqM2V0MWM2ZGxpMHhSVXRrMUJLMTM0RFJ4dzNHYUVEQno2S0FObmN3RERITTVwTGVKNDdWOXJ0VnQ3VVRQZEQrWnV2eXk2dnJjNHg3Y3M2ajIxRHROOERPeWRkMmc3RlVsejFUQUllNDJxWE4xQmZHSDg2RHJSZ1V0SGlkdUZQQmxaZ2R6c3krUDZyZm5kem5LWDlHZVFlV1k5RDB1RzNIaCtueDljdnRhNjcyblR6N2lQdWxlU1ZkNUc2anRYamRyT2ZUUGEzVDFRL1ROSWFYcDVhNnFvQ1JWMUJEbXVkdGxlV3RPNHRBNGdydFlZUkVjWWZIK1llY1p4dXpHRTFFY0hHeVgzUmZjYmJVNVIzZ3I4Z083Q0wrYlc5T1BnNlg4NDN2eFM5cTAvN292bmo4K3k1M3J1blhQdDVmRTAwMGZTR0ljNE1PQk1mMGxTTU1mQmNQTnQ2ZjNwZDhHbGIwM1VtbUxicUpveXRyNlduclEzRERBVHhObHd3eFBQbVYwNWZkWVphb2lmRjU2Tk9uaStXeWgwRjMxMUxwVnJXUnMwL2NiM1ptTWphNXJXZkszU1duaUxROFlnT2lBY1BRcjY3b3QzL0ppZlEvTlBJT2pqRHp2ZW1lekdKbVBwbVAxdVlmczJVa2Q3N1Q5d082cm5PZE5mdFhWOUhDUzVyd2FTMlF4eFFFWlRnUDhBR09Id0EzNzE4MzFlZXJOOXo1ZG56WjNOenh5OTBPWWk2cjBueVh5ZzhNdTBmbHcyMHg5MXBiZzJDeWlvRkZIYlpxZUp1TlVZekk1d25obDIvc203c1BWY20zdXpoMk9uMVhSWTlSV3FaNGVEMWZ0UDdhZmpkMll0dDF0K2ltM0JzbDRFTEt1cXFaYUtTYkpBUzVyR0g1WU5BekhFN05xN1d6NWhudFRjVXowZmwrSFRic2J1TXpxanN1dUYvUSt0ZHB1enVnK3ltbTVkTWFCcFBsNk9wcVpyaldUU0VPbXFhbW9kbWZMSzhBWW5jQmdBQUJnRjFOemNuT2JsMjhNSXhtWjc1bVpuMHpMMk90cmFPMjBjdHh1TXJJTGZBeDAwODh6bXNqampZMHVjOTduRUFOQUdKSjNMRFV6VHBUOTREejgwVjVFZDltV250UFdpdTdXYVNvNWJEUjNXSnJUVDNHNFQxSFZycWlta3dCZkUwUnhSTk8wRWd1YWNITDF1ZzI1eGlabDJ2bHJ6WERIZjM5Mko0WWJlbjZjcHUvOEFocjJ2Vi9acll6dVA1NjZGb1oyaVdpbzVMbmVaYzJCRERRMjJhV0YyMGpiMWN1R0c0N2VDNHVxM0x0OHJQVlQxWFdSbFBqTXU5bGVjK2hlRnFTeVE2bDA3WDZjcUpIdzA5d3BwNktTV0U0U01iUEVZaTVoTzRnSEVLeE5NNTQ2c1pqeGNVYTcyWVBGZTRUdnFhcXF1anBaRGk0bDlHZHY4aXVYblM4S2ZsN2FuOTZmY3lvZlpROFJLT29iVUUxOHJtbk5sa05JV2tqbU9qdVRuU1I4djdVZnZTODZyOW5UeFpySkROSyt0NjJKZG1BcE41NC80cGRuRHpIUENZbUlqZzdIbFBrKzM1ZjFPSFU3Y3pPZUUzRjhZdjA5bnJkTGZtZlp0TDl2ZklMVW1qTkt2ejZkdGwydU5CUXlPeWg3NmFuclpJSUhQNmVMUzUwYldrbHV6RTdOaTlTTjZjc1l5eTdYNkg1dDgxNzI3MFdPVzdNYThyN09FVmMxM3ozVTdVUDNkYlRoaThWOVc2OGtpZXlTNzZqZlJzbGNmdVNSVUZGRTV1UUhrNmR3SjNIZHdYaTlUbGVUODg4b3puY2pQT2UvSjJETHJQWGRldnZ4OXoyYVFzT2g3RUhOYTh4WGl2SnpmZnpFMHRPejd1T3dZRiszaXZROHZqakwxdklOM1IxbXFlekhES2ZwdUlqM1RMckM3WWVXV3BmSC9BTDRhUjhoZEhTWTMzVFZmSExVUWw1WTJxcEpDWXBxYVJ3QklaTEc5OFRpTnVEemh0WGI2dkdKaDRIelYxdXJleDNzZjJzZUgwZUgxKzEvUmpvTFcrbmU1V2lMUjNDMGpPMnEwdmU2T251dHZxSTN4eU5mQlZSQ1poelF1ZXc3SGJjcmlNZUs4V1lwellaeG5qRXgyUy9UbmdncW9IMDFTeHNsTkkweHlSeUFPYTVyaGdXdUIyRUVid28xTVc2Qy9lNThUSit4UGQyNHpXK0Z3MDVVZjA2Mnk0RTU2T2R4TWUwN1NXRU9qY2VMbWtyMU5yUFhqYjRUcnVtNUc3T1BkMng2djA0T3JQV2NBNjd2aVZ0MW5xTlEzQjJQRWJGSmN1THhKVzRFaFpja01aUnhVYmg0ODdmMGxHNGVPOEtPU0dNcmVLamNNSkJnN0htbzVJWlNOeEJDamNNSERZbzFETjR4Q2pUQ1FZTytLamNNcFJnY1ZHMlVnMllvMUROUnBEeHRLRE1qRUtOUXlJNEtPUkIyRlJwTWcyWW9NbEdnNGJFV0Vvck43ZUNFSVVhUW8wRUVQR3pCR21hQmNTT2FpcFJRZ2FDbFdRZzFqT0xVU1ZJaHRWU1ZOM29rdFdIWmdxeW9iMEZJeXB2SlZKYU1PekJFVzFFbGNaMnFzUzBidlZZbHF3N0ZVVU5oUWFqYUZYRzJZUVJpRlVsc3c3aXE0NWFJalJoMjRxc3k4aGgyS3VPVzhiZ0NEd1ZjY3QyNzFXWmZwMk9JUG5EZUtyRXVRZmkzMm5yKzUrc2FMVHRzak1rMHoydHdhQ1R0UEFMVGl5ZjBWKzJCN2F1blBIYlJkdDdoZHdLTmo5YVRSUnowRkRJMEg1WU9hSENXVWNaRHZBL1IrTzdxN3U3ZkNIdWVYZVgxV2VmMFI5cm1tdXM5d0lCQUlCQUlPTm51USs1ZjJYOXUvdGcrOGFxbWp1bmVPNXdTU2FXMGxFOGlhcWNEMHhVVkpiajBxWnI5N2pnWFlGck1TRGh2RERVNlBYZGZqMDJQSGpsUFpEK2JYeS84QUt2dTk1VjkxcnIzbjcwM1dTNDZ0dWp5Nzc1TFlvSVc0aUtDQ0w4Mk9HTWJHTkg4SkpQYmpoRlErSjZqcXN0M0tjcG5qTDRMVzMrWjFVSkhPL04ySTYyT1ZTK3MrUFhmVzQ2TTFEUXhzdUQ2Q2lkUEUyYXBZd3ltRmhlR3VlSXdXbDJVSEhMaU1lYTVzWjFSVDBOcmN1SzcrNzF1NGZ0TDc5dmtGMkswUFp0RWQzTzNWRnJlZ29hT21nb2RTMmU3eVVEN2hTTmhBZ2xrYlBCVU9MeXd0SmNXTngyN01UaXVybHN4Zmc3M1RmTWN4akVaWTNUM3VtL2VXTkdTVTdIMUhaeTdzcUMwR1JqTHhFOXJYWWJRSEdqYVNBZU9BK0N4eWZTN1g5U1kvZzk2ais4cmFIRzdzN2VmKzlvZjgwVjVIcGFqNWp3L0RQdGVKZFAzbVBTbFBUUGRhK3pGMXFLNEVCa2M5N2loakpKR09aNG9aQ05tMzgxT1I2VEw1aXg3c2ZmOEFxZktPNjM3d2g1cjkzSXBOTytQV2piRjIvanFUSkcyOFhtb040cktjT3lzamRIMVdzaHhaaTV4TDZWNGRzMmJDSGFqWmlPMlhTMy9tTFA4QWRpSTk4L0J3cDd6NmIxbFRYK3Y3czl4OVFUNnM3b1g2V1N0dTkrck0yWjhzMkRuTmFIT2RnQnV4MmJCZ0EwYkZ5OWtVK2Z5NnVkM0tabDQvaFA1ajEzaVg1SjJQdXczVFQ5VzA5cnFIVjBsamhxRFNQcU1zTDQyRVRpS2ZJV1NPYS9IcHUvTnc5VmpLTGluWTZYcUkyZHlNNWk2ZGtjSDd6VmNaV1p6NC93QndhZVg5Wm5IL0FPNkZ4Y24wdmY4QTZtL3dlLzhBVTlJOGh2M2tYWFBjRHN4cXp0cm8zc2ZYV2JVbW9iUmNiSFIzeDJvWDFCdDh0ZFNQcFcxVFlCYTQ4N29zK2NOenR4STNwR3k0OTc1aTE0VGpHRlhGWGY2blU3RmU2bW50c2R1cXdZNnlNRVRSdTN0a0xpNTRJNWh4SytrNlQ3dUVQNmMrUjlxTmp5enA4SS9CRS94ZmVuM3k5WTFuYTZtNlBqcjZDTjB0VC9pM3NqYVhPSTNnNERiczRyUG1mVDY4WXpqdDdKZm4zOTVmSXNPWHQ5ZmpVVEgzTSs2NG5qalAwVGNUMzhZN29maGYxYjFFZDFCVS93QWhMK1JlTHlzdkNYODkvbXR2OFVlMkg2TmlzV3BZcWxtUzMxT2JFWUFRUzRrOHR5MUcxbjRUN0VucXRyOFdQdGh5UThjdTUydXV5c0Zickdqb3AyMUVOSE95Rm4zbzVUSkpFWTJaUVB2Z2duSGRzVy95MmNSTXpGUkRxVDEreGxuR0VaUk16UGR4ZG9Pay93QjVZMEJiN0hSMk8zOWxMNUZRVVVFVkpBMTk0aGNSSERHSTJnbjVNWW5BTG84cDkxaDh4WVl4RVJod2owL3FmdVIvdkoyaTVHNXY5RGw2SC9hc1ArYUp5V3Y2a3gvQjcvMUIzN3libzBidXpsNVAvYTBQK2FKeVQrcE1md2UvOVNIL0FMeWpvNWd4L3dCRFY2UC9BR3REL21pY2svcVRIOEh2L1U4T3MvZWFOSFVnSi8wSzN0Mkgvd0RWNFIvNkluSlA2a3gvQjcvMU9CZnVPKzQzVitmdmtkWis3VE5MVk9rZEpXS3dzMC9SMjI0VE1xWHZxZm41cXVTZnJOamp4ek5rQUFEZG1YMTI5dnBjSWlhbHorVjlidDlaMXVNNTQvZHFxbmozdmRPd1B1VlUzaGozWTBaM09abytmV2xzcDdYY0pZcmZCWGkzdFpVM0NHT2xaS1p4VFZZTG80eE0wdERmMDk0dzI5L3pTZFdPR1BvZkRlV1piblJlYTlYbnZScXpqY3l4OE95WjQ5blpNVlUxeDdYS09MOTZIcDVHWnoySnF4NmYxb3gvKzZGNHZKOUw3RCtwZjhIdi9VK1JlYi83dzVlL0p6eGwxWjQ4Nlk3UlZPbTducXFtaHQzNDlKcUY5WTJsakZYRk5MalRzdDFPWDU0Mk9qL3hvQXpZbkVES2RZN1ZTNjNWK2ZjN2JuRFJWK245VGh2b25VbDB1ZFpiNkt4WVNWZHZxYUdyWkhtREFZcWFvaU1neGNjQit5RHNQeXI2RG84ZFdOUTRQTFBPTm5vdGpkbmV5ckNjWmkvVGxFeEh2cjY1NE9TWFpYejUxSjRJOTliWjVHV0N3LzFvczFYUjFtbGRSV09PcU5GSlZRVGcxVks1czdZNThqbzVvZzRreE94RGN1ekVFZVYxZTN4ZWY1WDVoUFQ1NnF2dXB5V2ovZWdxYVNQUC9vS3F4NmYxby84QTdRdWx5ZlMrZy9xWC9CNy9BTlQxWHU5Kzh1Nlo3aDl2YjMyMzFaNDkxVmZwZSswVlRhcStBNnFhQzZHcGlNVGkweVdXUm9jTWNXa3RPQkFLc2JWZDdHNTh4Um5qT003ZkNZcnQvVTRQK1BlckxaZisxVVZiRlFHZ3ZqSnBhYTZOa2FRNldvandjSk1YRGFERzVoNUE0Z2JsOWY1ZHVSbnRSNHh3bCtMZlB2bW5XZGQxa1QxTzVPY1k0eEdIZEVZOWxSRWNJNHhOOTg5c3ZZWjVXbDVJNG5GZDU4UlNxV29iRzhFYndxVTlwMDNmMk14Z21jRFRPYTRTdEp3RG84cHp0T0g2emNRdW4xOC81T1QydmwyUC9lN2YwL1ZMMXp4NDl6N3k2OEVybFBvanNocXY1N3RURE5KME5MNm5aOC9Rd0I4aGtJaERzSHg0dUpKTVRtWTQ0bkU3VjhqbGhFdjIvcFBNOTdZaXNaNGVIYzVFVWY3eTE1YlBwV3h5NlUweTZwMkIwZ2pyaGllT0FGUmdGamt3OUgrb2Qzd2hxZjNsenk2aGdES2JTT2tYeVk0bVNyZ3Vyemh5d2hyb2dFNU1IOVE3M2hqNy9pOVcxMys4ZWVmR3FJSFV1bUtmUzJtcFhSdmdiVVd5MlR6dWE1NElFd0Z6cUt0dWRtOEFqTHpCVjVVT1BQei9BSDh1eW85VWZHM3g3UWZlUHVENUNkd2ozcThpOVMxdXNOZlF2cEtHaXFiektaS2VpaE1qV1NmTHdnWldFUmc3VzRieWNBU1N1ZmF3dktJanZsNFBYZGJuTVRubk4xRSs1K04zNThtTmY2RXYxa3JORE5wcWk5L2lNRjlyWTdpQkxUek1vcWx0VEhCTkc0L2Zqa2xiOThFN1FNT0s5cnpUZDA0eGhIZStHK1V1bTFiMDlSbHgwenc5Yy9wNzMyaTMvdkRudVdUTUJxWGFhemNTTFpHUC93QjR2bnVWRDlVL24vVWVNZXdyMSs4RmU1YmM2S1cxVytmVDBGVlVzZFR4elEyNkpzakhTRElITWM1K0FjQ2NRVHVLdktnbno3ZjhZOWppNzNyMVJMcHU2MFdoR1BhWjdIYjZPMzFja0pKYkpXdWkrYXJINGtuSE5VeXlMbjNJcWFmUDdXZXVOWGpMNXMvVnRXWnMyWTRZODF4dVE2L1gxMGxBdE52a3dyT202UnVKd0diQTVOdkRhRWMyM3dpWmMxKzJQdjMrNHRvWFF0bTBIUXk2ZWx0VmtvYVMwVXNsUmJvblN1aG80RzA4WmtjMTRCZGxZTVRnTVNzY3FIcVllZWIrR01SRXhVZWgrM1YvdkRIdVJ4c3hoT204My91eVArY1U1VU5mei9xUEdQWTlBMFo1ZDl6Tzc4MnQrKzNlbDFMRnFxNlhCMXlxWFVPYUtsL1owTEEvSXdsNWJpNW1ZZ0U3VHNBR3hldjAyZWpabjF1THBONnM5N2ZuOXJPTVk5bC9HSDQvaVo3elhuTjRuOXBLVHN2MjRrc2p0SFVjOVRXUkc0VytHYW82bFhLWjVDNlZybUYzM2pzeEd3Yk53QzhuTENKVHAvTnQzWngwNDFYcWZZS1g5NGM5d3lWb0wzYWR4LzhBZGpQNXhUbFE1LzU5MUhqSHNhdS9lRlBjS3d4RHRPLzkycy9uRTVVSDgrNmp4ajJFL3dEZUYvY0tiR0JtMDdtTzNIOE1aajhQOFpnbktnL24yLzZQWXdxUDNoTDNGYW1GOVBUejZlZ2xlMHRiTTIxeEVzSkdBY0E1emhpT0dJSTlFNVVIOCs2anhqMlBubXJmTlh6SDh2NHBYZVRYZEM1UzlzNkdLUjFaYWJDWWJYU1ZMWHNNUlpMSGJvWVluWm1ITDk2SW5CemdDTVRqdkRidWFpSG05WDVydTV4OS9MaDd2WkRpMTMzN2wydWt1OVBZOU53c29ySEJHNDB0SkVYRVJ4dmVRQVM0a2x4eTR1Y1NTNGtrN1N2VDNxMjhJeGh5ZVE5Yk1kTnU1ZCs1bkVmUmpIRDY1ZmJmYTQ5d0NMd1E4Z0plODJvTkhWMnNiUFBZcXF6VXRKYjZobElZYXFxcTRaRFAxSklaZ1FJb25OSUFCSmNOdUFJUGw1NDZuWjZUcjQ2ZmQxVEY4SFl2US92Tk9qSzFvZC9vV3ZiQ2VCdThKLzhBUkZ4Y2w2MzlTWS9nOS82bm1qOTVRMFlSai9vYnZQOEEzdEQvQUpvbkpQNmt4L0I3L3dCUk8vZVVkSE4zZG1yMGYrMW9mODBUa245U1kvZzkvd0NwRC8zbGJSN0c1aDJZdlIvN1doL3pST1Q2VCtwTWZ3ZS85VHdLMzk1eTBoUm5EL1FuZTNjUC9YRUEvd0RRMDVQcFhINWt4bWYyUGY4QXFkTi9kTHZmZHU1V3ZaNzlYTkg0cFZ6T2xmREFIWWRSN2k0dFlOcHd4MkJlanU3bkNJZGZ6THpDZDJNY2U3R0lqMlE1N2UyMTc1ay9neDQxVVhqL0FGZlo2dDFKY0lLMnR1dFZleGZ6UXRua3EzaktHMDM0YlBrREkyTmIvakRpUVRzeHdYUnoyOVV1djBQblVkTnQ2ZEY4YjdmMU9RLy9BT1ovanlaLzlCRmJqeS9yT2Y4QThJV09UNlhjL3FYL0FPbi9BTVg2bkJiM1RQZGN1M25SM0N0V3F6cFNYUk5udGRxaXRFZHFucnhjWFN5Q3NucUpLbnJmTFVwQWNKR015bGh3eTQ0N1NCNkhSWTZJbVhwZVcrYnpuek55dFBDTWUyL0daOFBRNG0wUGMxdGNYVXRRL0dDUUZqeGp3UEwxVGR6dDRmV2RUTzdNMjdJZmJ1OS92dUw0a2VOdHI4ZU80WGJXcDF6RFlaNmxsbHZiTHc2MnZpdHN6eE5IU3ZqZFExZWZweU9rTFg1d0F3dFlHZ01CUFJ5MjdrNlB6eWVudzBUanFyMDE5a3Z2anYzbnVNTXpqc1JXbjAvck9mOEE4SldlVDZYYS9xWC9BT243L3dCVGloN3BIdklXcnp4N1oyelREZTAxVHBEVVZvbmxrRjlsdlF1TEgwVThlRWxPK0g4UHBUajFHeHVhOHlITGc0WlRteEhQc1JwbDUvWCtaeDFWZmNxWTc3djdJZFlXcUs5dFRNOXcza2tydE9tOVlxQ01TZWFrdVRGNGt4R2I0TExraGhJY0FvMndtSURWSEpEeG5sUnVHVWh3Q2pieDVUdUhGU1hKaXllVkc0WU9PMGxSdUdaT0FVYVl5a2JCeFVsckZqS1JoaHhVYmhrODRCR29aS05wa0tETW5pbzB5ZHZVYmhEdDZqY0plY0dvTWxHaU93SUpScEVoMm9NMUdrbmFVYUpRUzg4VVdHU0tSM3FLV1A1VUNSUWdwcDJJa21xaTRqZ2NFR2lNZ0hBNG9MVlpYR2R2MktzdEVGTk9JUkpNSEFxb3Rod0tNdEFjRGlnb0hBNHFzdFFjUmlxNDJzWjIvRlZsU0RTTTRqQlZpV3NUdUNNeTNqUEJhaGpKcTA0aEdWdFBCVkpid3V4R0NyRXQ0endWY2N2SWpkbWI5aXJqZnEyU1lSek5kelZabHltOENQSWkyZVAvQUhncyt2YmpUdHE2U2hxWUtxU0J6ZzBTTmprRHl6TVE3REVEREhBNEpQR0hEbk9tTDhIOUVlaWZmRzl0ZlZXbDdmZTdyM0FiWjcxVndSVDFkcHE3VmZKcHFPWjdBNThENUtXamtoZVdPeEdaamlEd1hSbmJsOUZoNTMwOHhFemxVK0ZUOEg3VFBlWDl0TjR4WjNQZ0kvOEFjK292OHhUbHkxL09lbS9IN3ArQVB2TGUybzNmM09nLzduMUYvbUtjdVQrYzlOK0wzVDhDL3dEbk0rMmwvd0Q5UGcvN24xRi9tS2N1VCtjOU4rUDNUOEhnemU5ZjdjRVVybzJhOGRJeHBJRWpMVGRzcmdEaGlNMU9EZ2ZVQXB5NVovbm5UZmluMlN4bDk3MzIzSVJqSnJxUUQvM1RkZjVoT1hLZnp6cHZ4VDdKZkVQTXY5NHc4WU8zL2JhcnRQaWE2cTFoM3J1RWJxZTFUMUZCTlRXeWdtZVF3U3ppcTZjMHJ4aml5T05oYTRqN3podU9zZHFlOTF1cTgvMjhjZjhBTDR6NnVFT21idlpxZnZGM1gxMWRPOFBrSlhWTng3aVhtVjFmVk91RGc2ZDBqeHNNclc0TllHdEFheU5vQVkwQnVBQXdIWXFueVc1dnp1WlRsTTNNdmcrdlh6VFR2ZHR3Mm96RDBTdUwydk9LQ0xaZEtpbXI0V3NkaGk5Z3grTHNGckdlTGVPZFE1ZjltdTdzK3BMVU8xdC9sZkpVbk0relRQY01JOHNaZTZBbCswQWh1TGNEdjJjUXUxdjdkOFllVnQ1MDhDKzZwdWxscjVLU2ZNSE5jUWZpdW03c1Rid3ozRXJEK2tVR0ZScnlzbFA1NXc0akU3d2NSdVFiV1B1SFgwZGUyUVBJd08vSGdoTVcrMFdtL3dBUGNiUnNscXFqbXFRdzVDVHR4d1duV243c3VQT3VCZDlEYWsrZHBnUlBUU1ppdzdHeU5Ec1N4M280YkNzdTFqTncrZ1dYWGRWVjJxbnFqSVhpUmpYaVE0RE9DTmo4RzdCbUczRGhpbHNTZFpxaWVjWUYzMnBaYjVwM0xwcEtTN3N2Y1F3cHFyN2t1RzRTdEgvMG1qNndWNmZSYnR4cDhIOUIvd0Jwdm1IbmJHWFNaejk3YjQ0K25HWi84cys2WWp1ZVQyNWNKYXlXcU81akEwZkZ4LzJGNnV2aFRvLy9BSkErWmFQTGVuNmVPM2MzSnkrakRHdnJ6anUrbng5MGpsNGNGbC9KTXc4cW1xVEdRUWRuQXF1T1lmcVV0Mi9aT2hrUDdKN1N4dzVod3dPOUppNHFVeG1jTW95anRoNnM3VTFYYXFxU2plLzlwRzRzSkhIQTcvcFh6ZTVob3ltUEIraDdHN0c3aEdVZDhQSVozQXFtZ0RNZGl3NWxmNlJLdjlZb0U3dUZWdUg1eHhRZUxVNjFxSmNRWEhhZzljMW5mNmlTMHVxR25iRTVzaDI3Y01jcC9oWEp0VFdUditWNzNLMzhaZnJ2MVROZXUxRm11eEpkTmJxaW90ejM3aVd2L2JNQk9HMEFiQmhzSHhYbzlaanEyOFo4SnBQbWJhalo4NTNKanMzdHZEYyttSTB6N1ppNXZqOUZQeVJyQ2Rvd0RqaDhWNWJwVThhcjFMUFB0THZodFFwNzk0OTNLYWE5MXRhL0VzaWlEUTdrNTViL0FHZ1Y3M2x2Wkw1RDVtNmljZG5seCs5bDlWL2JUMmJ2TGVwbWFRcXcxMnhrbFBPUHBsTE9KNXVYVTh4MjZ5ZHo1ZTZ2bTdVUlBiSEQyUGtyTlpUdGJobUs4eDlIVENyMVBOTzNBdXhRcDlTOGNid0hhYnVNSkp6aXFEeWVHRG9taiswdmU4cG43ayt0K2UvT09IK2RoUDhBaCsxOUFkV2duZnNYclcrUTBBVmpXN2NVczBOb3JsSzJHV1dKK1hwc0x5Y2NNUmlHNGZhdWw1aFArVGwrbmU5cjVldy85NWhQcitxWEZIdUxxV29icVNxa3piNW40YmZWZkx2MWZGK0RTNjJycVY0ZXgrMGM5bytuRlZwYzJ1cTJkeGU5L3dCNDh0Z1FPZzFSVlZGUzFwY1NjZWFnNUg5Z3J0VTIzU0VOWnREcEpKM2tnNEhENVo4SVAwUGtDN25RNGF0MkhoZWU3M0w2Zk9mR0s5c3ZRZSt1cHBxM1h6b014SXBZSVlRTVJnQzdHYmNQN3NMbDh5eXZkcndod2ZMR3pvNlcvd0FVelAyZlk5V2kxRFVNR0dZL1d2UGZSVTlvN05WVTE5N28yV0NWeEZMQlV0cjVpQ2RrZEdEVk94STI3UXpENlZ5Yk9ONVE2M1Y3bkwyOHA5RDhiVldxNmpVK29LNi8xUlBYclo1YXB3TzhHV1F2dytqRll5bTVtWEp0NGFjWWp3aCtYMXhqaXN0dnc3WmRaSzNVTlpXTko2Y1I2TE4rd05KWnN4NTRFcXVUdWZ2d1grZUliL3RSbWxuVVZSSVEwRWwzRGJpbEQzclhlcjZ6UkhaYWgwcFN5R080WFNROWNjZW1BWFQ0RWZ4aTF2d0s5RHFmOHZieHdkWG9lbzVtM014MlpaVFAxWXg3b2ZLb3IvVVJuRU9YbXUyOGlQVjFYSHVkOXFDLzY1MXU3TnMrS0Evcm5XZnJmYWc4MnkzdXZ1TlN5S01rdmVRQU1lWjJLcEw2enFhOWYxUzBWU2FRalA4QTBoVVphcXN3TzBBYldnL1R0WGY2TGEvZWw0WG1lLzhBdXgzdVBPdWEydTFSM1FmYTZja2lNUXdZNGZtaklIdUorR1lyaTZ6Tzg2OEhyK1dmYzZlUFRjdm8xcHVJdGRQSFNVK0xZWXdHdEJQTG11cTVabTM3Rk5yT29oR0FlUWc4a2EvcXdNQTQ0ZkZBZjZRS3o5WS9XZ1R0ZlZiaGdYSDYwSHBIZUR2SlUyUzBpMFVieitKVmpYQXVCd3lSN2lmaWR3K2xjbUVkN3M5TmpGNnA3bnF2YkNtcUIvOEE1UmNtbnF2QmJTTmRqaUduZS9iekd3TEV6Yk85dWFwZStVK3FLaVBhRDlxanJwdm5jMFdHMlNYR3NjZWt6WTFvTzF6anNBQzFoaHFtblk2WHA1Mzg0eGg4TjF0M0Z1Ri9yNWEycmtMcG5uRWJkZ0hBRDBDN1dlVVl4VVBiNnJkeHd4akREaEVQMmUwVnZyTHcvd0RITGcxMzRiQzdDTU9Cd2xlTisvZTBIZnozYzExSmw0Mjd1OXo2elI2bnFJTmdKK3RSMVhtSFhNekdGejNFTUF4SkoyQWNVSHpMdVYzVW0xRk4rRzBEeUxWR2RyZ1QrMWR6UG9PSDFybnd3cDJkckN1TDBPdHJIU2trN2x0encvT25maTRuZ0ZtWExqRHhYbkg0cU9TR01yc1NvMUR4cDNZdXc0S09TR0R5bzVJWXl1eE9DalVNSEhFNHJMa2hqSzc3dnFWRzRZdVBCRzRaeUhnb3JCeHhPS2praUdUemk1UnBsSWR1Q2pVSVJwbTg0L1Npd3plY0FvMURNbmlvMmhScEVydUNMRE5SU2NlQ0xDVHMyb3JONVVXRUU0QkZTbzBEc0NES1E4RWFTZ1dPekhpVkZTaWhBSUcwNEZFbFNxR0RnY1VHb09JUmswRk5PSVZTVk5QQkdaYXRPSXhWUlRUdFJKTkVXMDdGV1dnT0l4UVUwNGhWSmFSbkVZS3NTMGFlQ01TMUJ4R0txS1ljQ2lTMWFjRGp3VlliTWR4VlptR3pIRDZGWEcwQndPS0RTTjRCVlltSGtNZU40VlltRzhVb0h3SzA0NWg1bEpVZE1najgxR0poN0ZaTlRPcENNRGhodXdWWW1IMy9BTWZ1OXZicTd5d2FQN2lXK2wvRkNHdzIrNXZhSXhKZ01yWVppMGdadURYbmZ1UEFxVER6T3E2ZVkrOWkrN3cwSGJWb3dObnB4ekJ6akQ3Vmg1K3FXbjRiMnovOWowMy9BSVg1VU5VcE5zN1ovd0RzZW0rcDM1VU5jbkhiKzJzVHc5dG5waVJ1RG1sdzVibkVoRFZLS3FsN2R5QWo4Rm92NUNQOGlHcVhqMldvMGRwYTh4M3F6MmlqaHJXT0Rtek1wNHVvd3RPSUxIWlNXa0hrak9Vekx5ZTdGaXBlNGxrZGZyWUFhMXJjWkd0NDdONjB4aGxwbW5HSFcrbXBZSnBJcFdrT0JPT0lXWGFpWHplK1dwMEVoeEd4RzNoV0xUMDF4dXNjdUdGSkM5c2tqai9GT09VWThTdVhhdzFTNDl6T29mUXFhcmtqZTJXSnhiSzBoelhOSkJCQnhCQkM5QjUwdyt0MVYxbys2dWsyNmxoZEczVjlNQzI2MGtMY2dIM2lHeXNiaithNFlFNGJqczVMb2IyM3BuME94czU5ejB5VE5FOHh2eERndUYyRTlRYzBVeExsY0hBN1FnK2dkb2RidnRGeFpGSTc5bVNCOFJ1d1ZjV2VOdjIvSWpTMXF1RnJoMUpCSXhocUJsRFNRQzkySDZJM242RnZIYm5PZURoamVqYmppOUQwaVk2T2daWjJ1SkVUZnVFbkhFRTRuN1RzWFAxR3hvaUpodzlMMVU3bVV4UDBQMk52TmRTbmVwNE9vYlRIZWJQUGIzREY3bWt4blppSkc3V25iNnJrMnM5R1VTOXY1ZDgyeThzNjNiMzhaL1puajZjWjRUSHM5OVMvSTdjc2REYXBYeWpDWXlsaEg5d0FQaHZKWHZZNVhEMS83MytheDFmWDdHM2pONDRiVVRIcnptWjlmWkdQYjdQSDJhS3FjMzFDMWI4U25GNU1WWTA4Y0R5S3R1T2NYa1IxR0c0NEgwVnRpY1hydXRJSHNybVZ6RDkyVnVWMzkwelovQmd2SjYvYnJLTXZGOVI1SHZYdHpoNFQ5YjhYUEp6WFFwN2d6eWMwb0dlVG1sQXp5YzBvWVhLQjlkYnA2TW5IcXh2WU4yOHR3Ry8xVmpnMWhsT014UGc5aDAxWjhmSG1GandXMWIybTR1eEdCSjY1Y0NRUC93QlhnTnE5cmR3MWRQNzNnZWFlWlpiL0FKeHFtYmlJakNQNGYrYTNwTzNtdkVlOFBwUWZWT3dVUW83RlcxeDN6emhnUHBIR1B5cjN2TGYyTGZBL01zM3ZSajRSOWIyRHVhd1hEUmRld0FPeVJPa0kyN21mdEFkbklqRmE4dzI5V0YrRGorWGQvbDcrbWV6TDYzd3Zielh6NzlDRzNtZytxK090WVliZGRJVGhsNnNMaHp4TFhBL3dMMnZLWjRaUGlQbTNDODl1ZlJQMlBwSHp3NXIxcmZJYUI4OTZxMmFFeVY1TVQyTWRnWE5MU01TQWNlZUM2L1U3Zk13bkdIZjhzMy95Ky9qblBaSGE0cWR6b0txbDFKVTA5Wkc2S29FanlXdkJCd0pPQjI4Rjh0bmhPTTFQYS9WZGpkeDNNWXl4bTRsNnpqaHVSeWpFODBINkdtNmFhcnVMSWFkam55bkhCckFYRThkdzlFaUxsblBLTVl1ZURrL291aU5tMHZiNktvWmtyWUkzaDdUaHNkSzRFL1RnMGZhdmM2RHBaMi92WmRyNEx6M3pQSHFKMFljY1ltNW54bDhjMTVYL0FJbnJLNVZtT0lNNzJBNFliSXoweDlnWGxkVmxxM01wOUw2M3l2YTVmVDRSNkk5L0YrVDlLNEhmZSs5aEltVTkzdWQ0a3dKanBmbEk4UUNRK3BlTVNNZDM3Tmp4czVyditYYmVyTy9COC84QU1XL28yWXhqdHluNnYwaDc2OTFJTjBiUDcwTDI2aDhWRTVlTEdSOU4vdmJmNzBLVkRjVGw0eStEUlc1MXRyNitDWC9IZk9WVFhIWitqTzV2RDRMNXJlaXNwOWI5TTZYTFZ0WVQ2SStwcjlLNDNNL1UwYmJHM1RVRU1Vb3pVMGY3YVVIZGxadXgrSndDN0hTN2V2T0hROHozK1Zzek1UeG5oSDBzdTdXcGZ4dlUzeVViaTZqdDdCU01id0VnT2FVLzN4dytoT3MzTlc1UG9iOHQyOUd4akhvZXI1d3VxN3d6aEFad2djZjdSNGFFSDBMdFRSMnUxMVg5WWIzdHA2WUdTS0g5S2FRWVlOYjlKMitpNXRyWnl6bmc2ZlZkVGp0eHhuaTh5L1g2cXZseWx1bGNSMTVUamczWTFvM0FOQjRMMk1NWXhpb2ZON21VNTVUTTk3MFhTbHNmTGVMbnFtb0I2dFhQSkhUbDIvb3NmbEIrbkFmVXZIM1p2S1o5TDZyWmpUdDQ0K2g3Qm1lTnhYSFRRenljMG9HZVRtbEF6eWMwb1pWdGQ4alR1cUpIYkJzQTVuZ0ZyRERWTk01NWFZdDg2dU5scWRjZHdCODRTYlZTeHNmVXVHN0V1TGhIOUl3K2hjbS93bW9jblQ1ekdIcG1YdmNmVGlqYkZFQTJKb0RXdGFNQUFOZ0FBWEFHK1pqR2w3M1lNQXhKUEFCQjZScks0TzFISExUTmNXMHdCRUlKM09HNXgrbjdGM2R2RFRIcFhaM3NzTTR5aDZOb3ZSdHcxcmZEU3Z4anRrRGdheWJmbEdQNWcvak93dysxZGJQSjI5M2RmYTZPbG83ZlN4ME5DeHNWSkUwTWpqWU1BMERnRnh1bTE2ZzVvUFMrNE90V3loOWh0YnprQkxhbVZwSXhJL1FIcHpYTmhqM3ViYjIrOTZWSk1lSlhJN0VROGVXWERhZDZsdVNNWGpTeTV0bkJaY3NRd2trdzJjVWFpR0Vzd2JzNHJMY1E4Wjc4Y1NWSEpFTXBKQVBpbzNFTUpKQnU0cU54REZ6Z0FvNUloakk4T09QQlJ1SVp1STNuY28weGxlTm80bEZpR0wzQUQxVWNrTW5IRGFkNmlzaWNTbzVFdk9BdzRvTW5IRXFMRE9RNGxSdUVPUEJSdUVrNERGRll1T0pSWUpSVWs0bkZHa3ZPekJCa1RpVkdrdVBCRmdsRkp4NElzTW5IRTRvcVhic0VXQ2R2d1VJSkZDQVFDQ3djZmlxeUVGeHZBMkZFbG9pR0RnVlJRUEVJeXRqMVdWZzhRZ29PeDJGRXBRSkNxTGEvRGR1UmxiWGNRZ3RydUkzcXN6RFJyd2QrOVZpWWFNZmdWV2FhQWdoRVUxNWJzNElrdzFZL0RhTnlyRk5vNU9JVlptR3pKUHFWWW1HZ1BFSWpTT1FqYXF4TU40NWNkb1ZZbUc4VXhHN2R5VmNjdzhpT2R3MnRPeFZtWWJ3MTByZU94VmlZZmZ2SGp5RnFibTZIUU90YWtmUDRDSzJWOHgyeW5ZR3dTT1A2WDZwTy9kdnd4a3c4cnErbHI3Mkw3V3l1bDNGMnhZZWN2NXVYOVpBZk55L3JJQTFMeitrZ2t6T2R2S0Q5YlNtcG4yYXJFY3pzYUo1d2MwN2hpckVzNVkyL0k3ejl0S1c1VWgxTFpHQjFQSU1aR3Q0RkpYYno3bkhIV2xCU1VWWWFPYi95amVXamVCNnJlM3Q2dlU3RnZ6NmFTT0Znamh3YXh1d0FMdVJ3Y09XTHlvcXZEZXRXNHB3ZWRRWGVxb3BoVVVjcjRaeHVraWNXT0gwdElLdmE0NXhlYitQM0djNTVaUzkzTndhVDllQ3h5Y1o3am1aUjN0R1hhcE85MzJEOGljakR3U2Q3UHhiUjNHUjI5MzJCWGtZZURqbmV6OFhsMGQycTZWNGtwNUMxNDJndDJGYWpZdzhISGx2NXozdkprdTlWWFNDV3RtZk5OaGx6U3VMemh2d3hjVno0MUhZNnVVVFBhMnBhK1NDUVRRdXdrYnRCMytuRk1vaktLbGpHWnhtNDdYbk0xRGNEdmsvOEZuNUZ4L2xzUEJ5ejFlNzQrNkcwZDlxeitjLzZnMzhpdjViYjhHWjZ6ZDhmZEJ3MWJHa2x1d3VKZTcxTGppVno0eEdNVkRyZFZ2Ym0vbHF6bTVxSStpSXFQYzhxS3Z3NDdGdTNVbkJ2SFd0TzlXM0hPRGVPc1BCeXRzVGdxZDFQV3hkR3Nabml4QkF4STJqNExPZUdPY1ZMZXp1WjdPV3JDYWxETFJZanZoK3Q4bjVWeGZsTnJ3K3QySjh6Nmo4WHVqNE5XMkt3Ty84QUUvOEFoeWY0U3Y1UGE4UGZMTSthZFQrTDNSOEdqZFA2ZU8rbkIvNHlUL0NUOG50ZUgxcy96WHFmeGU2UGcwWnB6VFozMDMvS1MvNFN2NVBhOFBmTE0rYmRUK1AzUjhHamROYVhPK20vNVNYL0FBay9KN1hoNzVaL20vVmZqOTBmQitqVDA5dGd0UXNrVVliYWhGOHNJY1RoMDh1VERFbkhkeHh4WFoweHAwOTNZODdMY3puUG1YOTY3djB2elc5dnRESC9BSmtQNWFvL3cxMS95VzE0ZStYZS9uSFZmajkwZkJUZTNtaFQvd0F4eFA4QXcxUi9ocS9rdHJ3OThwL09lcS9IN28rRDlxeVVsczA5UmZoOW9pNk5KbUw4bVo3dnZPM25GNUpYWTI4TWR1S3g3SG5kVHU1NytXck9ibjZQc2VUVTFGUFhVc2xGVnRENmFacm9wR0hIN3pYREtSczlGcktJeWlwN0hGdDZ0dktNc1pxWWZoanR6Mis0Mi84QTVlcC9uRjF2eVcxK0gzejhYcC96bnEveCs2UGdvZHQrM2gvNWgveTlSL09KK1MydkQzejhVL25YVi9qOTBmQitscCt4NmMwdjF2d0tEb2RmTDFmMmtqODJUSEwvQUl4enNNTXgzTG0ydG5EYXZURlc2ZlY5WHZkVFhNbTY3T0VSMitwK2wrSVI4MXpXNmZMSDRoSHpTemxqOFFad0tXY3RoWHR0ZDBpRUZ6cDQ2bUViUXlkakpHNC9CNElXY29qTHRpM0p0emxoTjR6TWVwK1lkRzl2Ui8xSGIvOEFJNmIvQUFWeDhqYi9BQXg3SWRuODcxSCtwbC9GS1RvN1FIQ3gyLzhBeU9uL0FNQk9SdC9oajJRdjUzcVA5VEwrS2ZpOHlocDdOYVFHMnFrZ3BnQmtIeThVY2VEY2NjUHVBYkZ2SEhISHNpbkR1Wlo3bjdXVXo2NXR1KzR1NXEyeEcyL0xsc3VtWkhtUjl1cFhQY1NYRTA4SkpKM2svZFhGT3poK0dQWkR1WTlYdnhIRFBMMno4V2JySHBiaGJxWC9BQ2VML0JVNU8zK0dQWTErYjMveDVlMldsTEZhN1kxemJkQkhUdGZnWGlDTmtlWWpkamxBeFdzY2NjZXlJaHg3bWVlNSsxTXo2NXRUNjhjMXEyWXdaUHJ5cGJVWVB6cDdiWVpwSFRTMFZPNlY1TDN1TU1aY1hFNGtra2JTU3VLZHJDZTZQWTdlUFVidU1WR2VVUkhwbGcrMTZlSC9BREtuL2tZL3lMUEp3L0RIc2NrZFR2Zmp5OXNsREhiS0o1a29vSTRwQ01DWVkyTUpHT09CTFFGY2NNY2V5SWhNOXpjemlzc3BuMXpidzU3VllKWHVsZlEweGtjUzV6blF4a2tuYVNTUXN6dFlUM1I3SExqMUc3RVZyeTlzdkhmWjlPai9BSmpUL3dBakYrUlo1V0g0WTlqa2pxZDM4ZVh0bGpKYk5QamRSVS84akgrUlRsWWVFZXh1T28zZng1ZTJXRWx1c1hDaWcva1kvd0Fpbkt3OEk5amNiKzcrS2ZiTFA1YTFRSEdHQ0poL2lSc0g4QVRSakhkRFhNM0o3Y3A5cFNWbXpCdXdMVnBHRHg1S2tieWNTcGJjWXZIRlV5bWpiQkRnMkpnRFd0YUJnQUJnQUYxNTZmRHdkMk9xM2ZINm1VbDBuSDVydnNDeitYdzhISkhVN25qOVRGOTNxMjdjK0gwTi9JcCtYdzhHNDZqYzhXRW1vS3h2NWttUCs1YitSVGtZZURjYjJmaXdmcVM1amFKZi9CWitSVGtZZURjYnVmaThPdnZWWFdnQ3FmbURjY293QTMralFGckhDTWV4Wm1jdTE0c1Yxbm9NNXBYQmhrT2Q1eXRKY1FBM0U0amtNRm5MYnhtYmx5WXpNUlVKazFSZGgrYkxnUDdsbjVGamxZK0RraVplTFc2a3VWVkNhZW9telJPM2dOYU1mNzBBcEdHTWRqY1JNdnpKYW5IWndXcmJqRTdkZmE2eHd2Z3RUbXdSeVBkSy9MSEdTNTd0NUpMU1NWeHpoRXVTclhMcjNVdy9NcXYrVGkvd1ZubDR0UmhEeDU5ZmFva2pkRTZyKzQ0RnB3amlCd0l3M2h1SVUwUTNHMUQ4S1NYNjFwelJEeDVaZ0ZMY2tZdkhrbEorQ3k1SWhoSkx3Q2pjUThlV2JEWTNlbzNFTUh2eDNxT1NJWXlTOHQ2alVRd2tseDNmV3Bia2pGaytRTlViaUdFa2hPL2R3Q2pjUXpjN2lWR21Va3ZBYjBhaUdMNU1QVXFOeERKNytKM3FOUkRKemk0cU5SQ1hPdytLS3pjL0ZSWWhtOS9BS054RE56dnJSdUlTVGh0S2lzM3lFN0FpMGhSU0x1QVJZaEpJQVJXYjNrbjFVV2tFZ0lxZDZqUUpBM29NM3Y1YjBhUWdSTzNINmxGU2loQklPQ05LQnhSa0lCQlFkanNPOUVvMVVXeVFqWWR5RFFFRVloR1FDUnVRVURpcXl0ajhDaVUwQkJDcUtEdWFKU2djTm9SRk5keEc5VmxiWEEvRkJiWGZXcWt3MFkvZ1VZbUdqWFlLc1REUnJnNzRxb3ByaTAraUpNTldQNGhWbVlheHk0L0ZWaVlieHlmV3F4TU5HdUIyamVpTFpKZ3F6TU40NWh4M3FzVERlT2JEYXJiRTR0bVRBK2hWWW1HekppMVcySnhmWU5CK1dWNHNObGh0R3FxRTNTb2dCWXl0RS9UbWV3WVpCSm1hNE9jTnVMc2NUc3gyNGt5WWVkdTlCR1UzRTA5aGo4eUxVUi82aGsveXR2OEFOcHBjTTlCUGkwSG1IYWovQU5ReS93Q1ZOL20wMEorUm54VzN5K3RUditvcFA4cWIvTnBvWi9KVDRuSjVjVU9VR0N4UGM3SGM2c0RSaDhSRVZlV241U2ZFbStXa2J2OEEvWC8vQU9lLy9nSzh0bjhyNlhrM0h6TDFSTnBxbzA5WWJiSFJTVHNNWXFwcHZtWFJna2JXTmRHeHVJR0kyNDcvQUUyNmpiWi9LeGR2bFVseW5yWjNWVlhJNldwZWN6NUpIRnpuSG1TZHBYTkRrbkZwSFVrY1ZiWW5GNU1WWHpWdHh6ZzhpS3EvVksxYmpuQjVFVllSdlAxSzI0NXdlVEZXdE84clZ1S2NIa1IxYmVCVnRpY0hrUjFoSEZXM0hPTGVPdTVxMnhPMjhpS3U1RlcySndieDE1NHJWdU9jSGtSVjQ1N1ZiY2M0TjQ2ejFWdGljRzhkYmh4VnRpY0c4ZHd3VnRpZHR2SGNjT0t0c1R0dG83bDZxMjQ1MjI3TGw2cTJ4TzIyWmNHLzdTdHNUdHRXWEQrTXJiTTdiWnR5UFBGVzJPVzBiY2lsczh0bzI1RGlyYk03YlJ0eWJ4S3RwTzIwYmN4K3RzVFV6eTF0dWZJcTZtWjJsTnVaL1cySmFjdFl1WHFyYWNzL3hUMVRVbkxVTG42cHFPVVB4SXBxVGxqOFNLYWpsajhUOVUxTHlpTnp3NHBxT1VSdWVQRkxPV2szSTgwdGVXZzNMSGlwYTh0THJtT2FhbXVVaDF5YnhLbHJ5MmJya09hVzF5MmJybDlhbHRSdHMzM0k0WVlxVzFHMnlmY2ZWTGE1YjdUNDZlT1ZsN3U5dGJ0M0V2RHkrbHRkVWFhcGErNHkyMk9HRVMwVk0xNE5QYmJuSkk1ODlmRzNLSTJnQUVsM0JkUHF1cTVOY0x0N2ZrbmtlWG1PZVdNWlJqcGkreSsyZlhEMys2ZUNsaW9MOXFEVGtGcnJhaTVhZG1yS1c0RjJvSW9vb24wRU5YUFBMSzlsbmxES1hDZ3FXUlRiWFNQanltTm1PSTRjdXZxdUhiSEIzOWo1VjNOelgvbVkxaGxNWmVpb3VKN2UvaHc3bkhtL2R0cTY2OTdhN3RGMnd4dUVzTlRMREhOVlB5c2hoaGUyT1NTZVNGamlXc2U0TXhZd2w3aUExcGM0TlhjejNOTVBuZWoyK2RFVFU4ZXlvdVp2c2lJOFovMnpVT1F1cWZhZzdzYVVzUXYxOU4zb3JmSFNHNDFkVldhY3VNZE5CRzNBRno1QTV4YTBFN1E5clhZYmNxNnNkZGhNMXE5MHZvTno1YjZ6REdjcDJKcUl2OXZIczlYMmU5anBmMmwrOFdydE16YW90RTFaWFdxbGxyS0tyckxiWnErb3BQbUxmTytrcW14U3U2WmV4a3NibWgyVVk0WTRKbjFtR016RXp4ajBTeDBua1BWZFR0WTd1M3N6T09VUk1YbmpFMVBHT0hkNm41OVY3V2Zjai9SblNkMllhNnFoME5jV1VUN2ZkYmhaYmhUMGIveE9lT2xvekpMOTl6R1NTek1HYkljTWR5WWRaaGxOUlBHZlJMWFZlUmRWMDIxbHU3bXpNWTR4YzFuak0xSGJ3NzM2V2t2WjM3MDY3MHhRNncwdys0MTJuYmpDeXFvNnltc1ZjNkdhSjR4YStOem5OSmFkNEpBMkxNOWJoRTFxOTB1YlorWCt0M01ZeXgySnFZdVB2NHZSZGRlMk4zMjBKM0NoMHpxRWZJYWFNSnFxaXN1bEpYMFZhR0NSc0ErWG9wNHMxU1hTeU1ZT2c5MkJjTStVRVk3eDZpTW9tWW1LajlPeDFPcDZIZDZiUERiM05yS004NXJHT0V4TXovaWlhajZhOUZ2b2c5a1R5RGxZSkd4WFhLNFpnZjZ2MXU0N2YxMXhmbmR2OFh1bDZtUHkzMXZmcy84QUhpOVZ2UHRLOXliTjNEbysybHl1azhHcmEwUk5odFV0bnVBdUVyNmlLb25oNlVBeGE1aGpvNTNPY1hqREp1T0lWL000NmRWOFBwY2Y4bzNzZDZObWR1WXp5aVppTldOVkhieGV3MWZzY2VRa0ZPK2N4M2M1R2wyQTA5WGs3Qmp1YThuNmd1TDg3aDQrNlhwNC9MUFVkK0ZmK0xGeCswcjRMOTVyMzVEdTdBWHFuTkhjZmxwSytHc2hocVp6TzFsZkhiQkF5bWRISE9LajVpUU5kRkkxaGFBWEhabEx1U2VvNFdteDh2NVpaNlpuMGVtLzA3MzBydmw3UVBmZnN6MjZyOWUzaUt2REtWaCtYWlcybXJwWXA1OHBkSEIxbkY3V3ZsSXlSZ2pCenlHN01WeDQ5VkdVMUV2WGo1UzRUV1hGK040NWUwOTM0OGllMmxMM0NzZEpYQnRRMktTU0NpdGxWVnRoRlRUeDFrTEpKVzVHOVF3eXNjNW94eWs0RTRnZ1RQcVl4bmk3WFRmSjJFNHhPNXU2Y3Bqc3E2ZWZhL2FDN3RhZzdsM0R0UGFhbXJxZGRXMkYxVFdXcUMwMWpxdUJrZlFMM1RNT0RXdC9wTVdVaHh4eE93WUtUMU1WZHZVajVFNmFNWXp5NmlvbnMrNVBkMjk3OTZxOWlUeWRoamRLYmRkc2pBWE8vd0NocWpjQmlmMDFuODFqNC9XNU1ma25vZS9xNS83Yy9GNmIycTlvWHUvM3R0OWZkZTJqNnk5MEZ1cVJRVmMxdXRkVkl5R1owRWRVMktRdnlZU0NLVmhjQmlBVGhpVnJMZnh4N1pkN2UvdC8wV3hNUm4xbFRNUlBEYnluaE1YSGY0UHorK25zNStVL2FEU00rckpyUFgvSjB6ZXJQTmNyZlYwZEt4ZzNsOVVXdmhpL3VwWE1iemNGTWQvSEthaVhIUHlGMDI3RmRQMWVPV2ZkR1dNNFJQMHp3OXJEc0Y3UDNrTjM0MFlkUjJhaHJuWFNta2JUM1Nqb2FHV3JiUnp5UVIxYllaSldGclMvb3l4dWNHNGdZNFluQlhQZGpDYW1hbDJOMyszdXowbFlkVjFQTDNhaVp4akNjcXZzNHhMeXFUMmN1OE56N3QxZlpTaWxxNU80MURCODNWMlp0c3FqV3hSOU9LYnFPai9ONmVTZG4zcytPSnd3VTV1TlhmRDZYTC9RUFJSdFJ2Zm5QdVhYL1R5dSszc3QraWZZNDcvdjEyZTJ2eTkxT3RXMEF2anFIOEdxTXdvblZCcFJMam13d01nTGQrS3h6OFBIM1M0ZjZPOHUvd0R2Si83ZVh4ZmthVjlsL3ZIcmZYOTg3Y2FhbXJLelZtblN5TzcyNm50ZFU2cW81SGJjSjJIQnJRUVFXa09PTzNkZ3JPNWpFUk44SjlidGJueUgwZTN0NDdzOVg5M082L3k4cjRkdkMzejd5cDlyM3ZoNHozZXdXQzlVdFNMeGZLdW1vV3czT2xsb09teXJjOWpLbk5KbWFZV09qY0pYQS9jMllqYUZjWjEvc3piaG41Q2pmakdlazN1YjkrTVp2R2NkT3ErUEh1NGNmQjlUdGZzTCtSMTUwbFQ2emdwYnQrQXowcmJpMm9ObXFXczZEb3VybndrYzF3R1hidEFQb3NjM0Q4WHVscitrZkw0bXZ6bkgvd0RieStMaEQzaDdmVmZhalhkWm91c3FHMVJneXlRenhaZzJTR1FaNG40UEFJek13T0JHSXh3V3A0UGxmT2ZLcDh1Nm5QWW1kV252OFluakh1ZXBTVklISDZBcGJ6WXhZU1ZCT3diQXBia2pGaStVRGVvM0VNWkp3cGJVWXNIeTQ3T0NsdVNNV1Q1Z055amNReGM4azRuYVZHb2htNTRIeFVhWXZrSjNmV28xRU1ueWNHcU4weWUvRDRvMUVNeVNkNmphSHZBR3hCbTUzMUtOUkRON3lkaWpVUWh6dUFVYmlFT2NCOFVWbTU1Y1VXa3FLa3V4K0NMU1hPRGZpaXMzT3hVV2tsMkc3ZWpWSlVVaWNQaWd6Yy9IY2pTU2NFQ0o1cUtTS1NBUVExd1B4VWFNRWhCUUlLcklRQ0NnN2dVU2pWUlRYbHZ3UWFOY0hEWWpKb0tEc2ZpcWxLYTRoR2FhdGNEOFZVTU93K0NKU2dlU0lvTyt0VkthTmVEdlJGQjNORXBvMlREMUNyTXd0c25KVmlZYU5sNXFzMHRydjFTZ3RzcDRwYk00dFdUSDRoVm1ZYXNuVnRpY1d6SmdkaFZabUZ0ZnlSR2pKbk5WdG1jVzBkUjlhdHNUaTNqcUNPT3hXMkp4YXNuQjNxc1REWmt4RzBIWXJiRTR0NDZybXJiRTR0NDZnRlcySnhiUjFCSEZWaVlieDFRNHEyeE9MZU9wSEFxMjQ1d2JSMVdIRlcySnhieDF1Q3RzVGczanJRVmJZbkJ2SFdjY1ZiWW5CdkhXa2NWcTNIT0RlT3V4M3EyeE8yOGlLdTVGVzJKd2J4VjVIRlczSE9EeUk3Z0R2S3R1T2R0NUVkYzNtdFd4T0RhT3V3M0ZXMkp3Yk11QlZ0aWR0c3k0K3FXeE8yM2p1WHFyYkU3YmFPNUZhdGlkdHN5NURtbHNUdHRtWEVIaXJiRTdiWmx4NUZXMloyMnJMbWVhdHN6dHRHWE04MWRURTdUVmwwOVUxTXp0TkdYVDFWMU16dE5XM1gxVjFNenRMYmR0dTlOVFBLVzI2K3F1cE9VdHQwSE5OU2NwWXVnUEZYVXp5bEM2amdVMUp5akYxSEUvYW1vNVJpNmcvcEpxT1VCZFFOemsxSnlqL0ZmNHl1bzVSZmlnNXFhamxGK0tqbjlxYWw1US9GZlZOUnlrbTZqbnRUVXZLUzY2RG1tcGVVZzNRS2FsNVNYWFgxVFV2S1ptN1lqZXBxYTVTSFhYMVRVc2JUSjEwOVZOVGNiVE4xMDVGVFUxRzA1T2VEL2x2b1BzWjI0dSttZFEzR3F0MTRyNnlTYjVpMjFVOUJVc2hNOXNxMm1HZUdtcVI5NDBMNDN0TFI5MXk2blZkUE85RVZOVTlyeVR6ZVBMZHpQS2NKeWpLSWpoWENwbnhtSDBqVXZ1UGRzYnBEcXo4QnJuMEF2VmRVVnRReHJha0NXbnFMOVM2aGZUeGhzWDdadWFPb2cvYTVNUklYWURNV3EvbC8yT1A3THpvOHkzcjZ6N2t4K1ppbzR4OTN0aTUraVk3SHd6MjN1NUZkcFh6RGw3aFJVWXVzdHV0amJ1K2xmMUhQbmZEcWkxMVRJV3NoWkxJNTg3bWRPTU5ZN0I1Qkl3QlRxUHZSTVhYRDdZZHp5M0w4dm5zNVJqT1V4dXh3aU9NL2N6aWE5VjI3UDlkVmRaNUQ2WTdqK1ZmaWYzTHZvN2MzR21rcWU4WGFEVjFISUxuYjZPbEVncVpiWXk1aHpxVXNaREswTVpHV3lGcm10ZTB0d1hqYlZSbGpxamcvUy9NcHozdW4zdnkyVVR1VGpNVlBHSW11eXI0Uy9ZN0h2MVRaL0JmeVp0VmJYVFVsVWF1TjFLTFZYMVlpb3plOU9VRmRJNmhrRHcrRVNQcWpKK3p5L2VjVHZKWGM2dkNKNml2R3ZlK1QrVk91ei9BSkJsdVk1VE00WTV4RXoyeHB1STlsUGhIblJyVFZmWWIyMExQVjl2N2hWdGJwalZWK25zVkhYMWRYV1VyV1c2WDVlaWptaG5rYzJhS25rZTE4Y2NtWmpYTmFRUHVoWEhHTU43T283T3ozT0dPcDNlczhsNlNOM0tabmVxTTV1cG1LeW1ZdjAwKzVlSjlQcVRWZnRSYWdoMVJyS0hSVTh1cDdmVU91bW9ML1dXS2lvSUJUV21xbW9JcTdQMUtTS1IvVVl4a1pBYVg0QWNGMStvckhkN1BEZytrOGlqUGY4QUs0eGpjbkdmdlJHZmJNVk14RSttb2V2ZVgzZmZzSmYrMW5hcnNoVmF5aTF6ZTdTK1dsck5ZV3lwbW1qdU5WVlVFdEhEYjZHNE1rYytkN1pYdHFIUGpsYzVqYWNPZVE0aGRqb2RtODVuS0t4bjMzM1BBK2R2Tll4NlBIWjJOelh2WVRqbHFpdnV4ajI1VDRUUFpFZDl2Y1BNYUYrb3ZFWHN2ZDY3dVpxTFNtdHFmU2tseWpwckhiTlMzdVM3UEZycDNPbXJaTEZXVXo0K2svRDlyTzV6Y1hrbml1bHN4TXpOWTIreDgyM2RyRGF3NW05TzN4aXVNUnFudzQ5dCtEaHZyenlEOGk5ZjkxZExRYWpxMzMyR1MxeVIxT3U3VE15a3FhVituN1BQUGJXRDhQbGRVUVNTdnFwQzZTUjQ2clNXNEVabDM0MnNjY0ppT01jZVBxaDhYUFg3M1U5Vmh1N3NUdGJtTTQ0eGpVeGNaWlJFOXZidzhIWnAzQjBaYU5jZTRIb1d0aDdxM0t5Nm8wL3AyRy9UOXVxU0t2YlQzZW1wcWx6SFN1cUJWTW96bmZLMXNrYnFkOGhhQVE1bzJyeW9uaDJQMG5MQzl5SjFUd2pzOFhWeDVlZVVtbys1ZnVTYWFvZEsyUzQyRzA2eGRxRzlYaDBzVTFMVlUxTEZhNFdVMERLbUF0ZkZVUTFObGJKS1kzL2RjNHNKT0JYbzdXTll4SGpFL3A3bmg3bTdxM3NzbzRWTVI3UDlybnk3VUhjRHY1cmp1aDRYM3FyTDd0VjZPMDdxTHR0VjNGNzU0djZ4V2lnanE2Z3o5UTdtVk10RklSamk4T2R5SzgvRzhheWZSeGxVdjFmQ0xVT3F1MzNsRWZGS0tWamJSb2JSbFhkOVh1bzNrMDgrcnI3WDAxMXEyTXcyT2JUUnp0WXc4QTdEWmdydVRPWDNwNzNKbkV6OTZlOXdBOW0zdkYzYzdnZTQzb2JUMnRMamNKNlNrWlJ5VFhHb3FLdzFOeW11T2lLKzVWYmEycGtlWDFUWFRVMFVnYktYTmFXdHlnWUxzN3Y3RmVGUGU2di9BUHJUak9NVmpwcmg0eHg5cjdiNWxkMU5hOWpQTTY4OTErd2ZlTzlWK3IzM2kvUlZtazd4Wkw4YkRSQnRubHBwYU9LcXJxNFdxY1J5WmNvamlEbXVPYkg3cFdOcmIxUnhpbzhYSjVWME9QVVlSanZSRzN0OFoxOWx6RWNNYm5neTloZlYzY1M5K1hHdUk5VlFWTm50a05rdU03TFd5c2trb3F2cGl6Tml1RG80WC9LeVN5TmU0aVJqY1F3aHVKQVcrcXhxSTRmcHdlbDgxN1VZN2UzZUVZekU2WW52bkdNY2FtWjdKdnRlZDdPSGVudnIzRjhpYi8ybzdpVmQydlhiRzVXK3ZOeU9vNit1dVZQUFRPcEtPcUZReGx4ZktHWVRWTDQ4WThyU0Rsd3hhblViY1k0Uk5WUDZtZm1IeS9aMk9qMmM4Y05PZkNML0FCUnBpYitpWjdmZzl1OXNpMVM2SjgwTlNXN1MxZlZ0MERTVy91SGJvYVJsWlVtZ3JLV3g2bm9yVmFLdzArZm9PbEZERUdpVU56T2FkK0NkVHh3d21lMlhaK2JkdUo2RG9kN0tQOHpQRExWUGZNWTFHTi9RNG0rRVBkRHVacW4zZGJkbzJ2dTFlNmxaZkxCZDJWMGxaV210cklyaEhEVzFFVlJWUGtNazBEbVJsblJlVEdHc2FBMFlMbTNzWWpibUs3b24yMDdYbW1HT0hRNTdPaUl4d3cyOG9tdU9yS01ibS9UMk9aY0Y4dTAzdWlkek5hTXVsd0Z4dE1lcXJlMEM0Vm5RanQ5cjByUVZVY0RZT3AwbXNaVTFMcFFBM1k4azd5dXRPRWNtSjc3ZU52ZERzNCtTN2U5cC93QXpMZHlpKytvaU9EaHg3VTNlWHVYckh6enVGUGNidFhmaE5ucDdkV2ZOaXNyT3RjSktyVE5kV1ZvdUV6cENhc2lhSmoyaVl1NmVQM2NBVnk3L0FQMDY4Sy9XOWI1Z2pHT2l5dzBSRWJVN2NZekVjZnZZek9mSHZ1WWh6RHNlaUwvN2kvakgycDd4NjFxS2FtMUZvNjQzRFMzZGg5emxhQkhwa1pxNldac2ttM3FUUlFVajJrN1F5VjJKWFh4enkycG1QR0h6SFQ5WjFIbE9lN3RSMjdtR21mVmxVeE1lbXZyZm5kK3ZKVHVSM2Y4QWFGN2c5K0cxbGRiYTI3NnduWlo2YWhxYXFrcUlMVFFhZ2lwNGFQTlR2WkkwUHA2ZkxJd0VZNW5BNzFyWjIvOEFNcVY4cjZHY091eDI5ekc1aTVtUFZGMC9uRjdnZHdkVjl4OVUxV3I5WnlpWFVGWTdxVGxzYlltdHgyaGpXTUFEV3R4d0FBMkRZdXhxdmkvUFBOT3MzZXM2alBkM2Yyc3A0OTMwVjNVL0JmTUJ2UzNSaUdNbFFwYmNZc1h6RXFXM0dMSjA0RzVTMjRoaytVdVVhaUdicFFONmpVUXlmUHlTMm94WXZtK2txTlJETjh4NG42QW8xRU16SVR1VWJpRUY0RzlGWnVseDNJdElkSU9LalVRemM5UnFJUVhmVW8xU0hTRGdpc3k3RkZvaVFONmlwSnhScExuZ0RZZ3pMaVZGUVhjQWpWRW9wT2NBaTB6YzdIZHVSVWsvV2drbjYxRkpGQ0JGMkc3ZWkwV0pVVmtEajhVRnRmanNPOUJTQ2c3SGZ2VlNnaUJBdzdENElsS0JCM0tvYlhGcHhDRFJzZ093NzBTbEloaDNOVktVSGNrU2x0bDVxcFMydUIzSWlnN21pVW9PNUlsS2JKZ3FsTEVnUkZCNkpUUnNwK0lWdG1jVnRsNUsyeE9MUnN2TlZLV0hEaHZSRnRrSTNwYk00dEdUSGdjUXF6TU5XVHEyek9MWmszTlZpWWFOZU9DSTBaTTVxdHN6aTFaVWpqdjlGYlpuRnRIVThpcmJFNE5XVlE0cTJ4T0xWbFR5S1d4T0xabFU0SzJ6T0RabFlPS3RzVGcyWlZBN2lyYkU0dG82c2ppcmJNNHRvNnptcmJFNE5vNndIaXJiRTRObVZmcXJiRTRONDYwamlyYkU0Tm1WdzRxMnhPRFpsYzNtcmJFNE40Ni9rVmJZbkJzeTRIbXJiRTdiVmx4OVZiWm5iYlIzSDFWdGlkdHZIY2p6MksyNDUyMnpMbnpWdGlkdHRIY21uaXJiTTdiWmx3SEFxMnhPMjFaY3VUbGJabmJhdHVSNXBiRTdiUnR6OVZiU2R0b3k2ZXF1cG1kcHF5NmVxYW1KMm1yTHI2N0ZkVE03VFJ0MXdWMU04cGJicU9KVFVuS1VMcU9hdXBPVXNYVWMwMU04cGJibzNjQ21wT1VvWFVmcks2azVSaTZEOVpOUnlsZml2OFpOU2NvQzY0OFUxSnlqRjFQTk5SeWovRlhmcmZhcnFPVVg0cWVhbW81Ukc2L3hrMUx5aS9GZjR5YWpsRWJxUDFrMUx5aU4weC9TVFVjcEJ1cmVhbXBlVWgxMUE0cHFhNVNYWFVGVFV2S1E2N1liaW1wZVVoMTEyYjAxTmNwbTY2ZXFtcFkybVQ3cC9HMnFhbTQybVRycHd4VTFOY3A5bzl1SHZmcC9zTjVGM0x2SGYybDVvSTdUVDBJZkRVendPbnQ5MWh1N281eFJzbG1hMlJqY0E1c2J0dUdPemF1cnUxbE9VVE5YSDIyN2VQV2ZrOHRqT0l2VGxPVlhFWGVNNDhKbmh3YzdPNmZ2SWVQK2xlMFhjZTdhYjB4YnJCcXp1TlQxVkJxMnUweEZxRDhRcklhb3psOFZORGQ2U0NrZ2tsK1psL2FDWDg5NWZrYzc3cTYwZFBqRlhsY1IzY2Jlei9WT1c5cXgyTm1NZHpQdHluTEdZOExuVE16TlI2UHByaTlYOE8vZUIwM2J0QTZsMC8zY3NkRmNkSTYvZ2diZWFDcFpjbVcrb2lwb3ZsS1lzbnRNTlRVUlN4MGpZb0hneFpUMG11RGc3RUxsM29qZm1NcjB6N25pK1NlWi93QW53ejZhY05lM2M4Sm1JbUpudDdhaVltYm50dmpWVTlQOHdmZFQ3YWR5cmpvcng5N2JXS0doMExhcW1LcC9EN1pGVzFFVk5SeDNPRzdWbFU2YTlOaHFxbW9uZEFJeG5pYTNBdU9aNVAzVzFXMVBicW1lMmZlNWZOZXR5Ni9ZalRoRzF0YmQ2WXVPTXpFNHgrendpSXUrRXpMNi9hUGRkOGViUDR0LzZyOWRwRzJWdWtYdGlySyt1cVJxOFRWVjJqWXdtNVNmMEF1RXBsakVtQWZnQ01GeDVkUEU1WHI0K3FYbzdIelp0N2V6R3pHeEdtcXJWaFgxdURuWVR5bjAvcWZ6VjFUM2wxdFdWMTQ3UE9zOE5oczFMY1dWVHkzK2swTG5QYzJrNmxUQ3lwaG9aV3VNWUxoMWNDTUM1Yzg1M2xQR2VNVkR3OHRqYjZQYTJjWnd4bVkzTldVWFVURWF1Rnp3bXB5anQ0Y1BVN0FPNGZ2QytML2RPeTJMVCt1KzNkb3E3UnB1bU50czhEWmRad05wNlZ6R1J1aC9ZVzltWmhiRzBFT3hHeGRiSHB0UFpuN3BmU2Juelp0NzlhOWlKcWJpOHNKcWZhOU8xdjdvSGpyM0I3dk83bGFzc3NNOUE1MXZKMHpIU2FoaXN6b0xaUXVwSUk1SjRxWnRVNTRrZDFjcGdNWndBTHNkaTVZMjRqYjBSbDJ6NE9ybjV4enV0eDZqTGJpc2NhaU5XTjNkMzRlKzNuZDdmZHg3TmQyTy91aFBKS0NqaTAvM1AwTlVDV2txN1BUNmxuRmZDSTN3ZktWcmFpbGdhS2N4eXlnbHJaSGd1R0RUdzRJNmFPK1h2ejh4VG5sRTQ0UkhqOTZPendlcjkxZmNpOFllNWZkNDl6Nnl5UVVGUFdUeFZ0NHNOQkZxZjhNdWNyWkpKWnpVeUdtamxpTWhlMDRReE9hNHRPZkRIYnlZN2N4ak9OOXJ0UjErM3Via1o2WWl2VEQ5blZudSs5bWF2eXAwbjVYNk90dFBZTmU2ZmdyYUN2bzZHTFVzOUJlYWVxcG9LUmphenJVc1pqTU1VT0Vib29ua2svZXdHMWNjZE53cTN0YlhXYmVYZkVNdkdUM2lleXZqWHEzVi9jUzMyeUxVT3ZOWlZFbFZjcnpmNHRRMDlVMXRRR3pWVU1iS1NscVltd3lWZlVtWU13Y0d1RFNBUmdHZlQzMlM5VEhMWjNLL3pJaVBwZXRlUG51aCtMM2pqM2kvMHRhUzAxU1ZWVGJUVS8xVnROVXpVa2RIWVcxUW1oYzJoZTJsbGtrSHkweGhKbFkwZ1k1ZGhXODltY3NZaSt4N081bnM3KzFodHp2ZnMraVh0Ny9lcjhXN2RycTlkMTlPZHRyTFNkMDcxRmNJcWk4R2JWa3BFbHpiaFVTQ0dXZ01ZYzhnRWtOQldQeXN6RmF2cldPaTJzOEl3bnFQdXgzVmxYMVBWL0VMM2lleEhpTlUzWFVHbmROVXQ4MXRkWUk3WSsrM2NhZ3BxdGx2WlR3Um1rYkZUMHRSQ3lQcXdkUVpYWW5IYnR4WEp1OVBybnQrdDYvbXV4c2RkdWF2ekgzWWlJaUp4eTRWRVI0VEhjOGJVM3ZuOW0relhhNjlhUjhhTkMyM1FseTFERTZockx6WW0zS2F2ZEUvN3ZSanFiekZCMHNRNGhybXRrTE1jV3N4VS9MUkg3VXpMclpkRjB1TXhsdjcrVzVHUFpqRVQ3THk3STlVU3J3eDk1UHNWNHA2Y2ZWMnJSTkZXYTVyNmQxRlZWMXhsMUFKNmVqbEREK0hzRlBTMUVQU2pMQTBPWTdGNEFKMnJlOXNjeWJ1bzhIZTg0MnRqekhjalBuYU1ZaUlqQ1l5blR3aUtqaE1kMzB2aGxSN25QYkRRM210YWU3SFk2MEN6MDFvUDQxSFFVVU5WVTA5dWQxS2RzY0VJdWZSbm1qSWlsRXJUa3diT1N3NWdGclRFNDZKbStEbW56RHArVEhSNTdrNXhPTTNsRWNZNHhPTlJOVE1SWHNuZzVHOTd2Zkw4ZVo3VHJEdXRwVFJsc3NuZW5XdHFxYkhmOVMybVM5ejFvcHF5bVpTem1HRzZVbE5SeFNQampZMHlGNVAzVzRoK1VCY0VkTlhiUEI1Y2VYZFB0WXh6ZXAxYldNM3B4aksvVDJ4RVJkY1ordDhnOEFmZFE3SjloYWNkME5WYU1vN2xydXJncWFha3A3aCtMeFFXK0NwcXFvbDFNYmRCVU1rNjFITkRFOTBnYThkUEREREJjMjd0ODJJNDA5UHpUcWRyemJiMjVuZDVjUmQ0MU14MnpVOEw3cWpqeGZyV2IzUnUyK2l1MmZkZnN0MjdsbHNYYWZ1bFZVbFhXMnVpbzd0TysxTWl5UTFOUGI1S2xqUytHcHBZbzRIOVV4bGd6dVlDU0ZuOHRGeE16Mk9MSG9laHkzTnJQYzM1eTB4OTc3czhhdXE5SFpFM1had2U1M3YzaXZIaXE4S1ovRGFIUjF1bzlKQ2luTlBkNDVOVHVxS2U4eU5kS0xzR21pYVhUTnFuZGZBeUFGMjg0TE1kTk1UZXJqOUxwNGVYN1dPOXpmelgzcnU5T1YvVTZpdklQWDloN2pkNWRRYTMweENhZXczS3ArWXBvaTFyQ0dtTm94YzFtd0VrRWtEaXBsbGMyL05QUE9veDZuck4zZHc0WTVaVE1lMTZTK2ZtY0ZtM214aXlkVURncGJVWXNueWwyOUdvaG0rVURlbzFFTW56azd0eWx0Uml5Zk45SlJ1SVpQbHgzbjZGR29obVpDZmdvMUVJTHdFVkRwU2QyNVJhWnVrUzJvaERwQ28xRUljOVJxa09rUlVPZVNpMGtubW9wRjNKRnBEbmdJcUhTRTdsRnBCZHozb3RFWEVvdEVTQW9xSFNBYkFpMGd1SjM3a1ZKS0tSS2lrZ0VDTHVBUmFTU0J2VVZPY29NMGFNTzVvbExhLzZRaUtEZ1VERGlGVXBRY0NoUVJBZ1ljZUtKU2dRVlVNUGMzY2d0c29POUVwWVBKRU1PUEZWS1VIY2tTWVcyVWplaVV0cndkMjlWRkIzTkVvdzdraVVwcjhGVXBZa0JSRnRlaVV0c3BWdG1jVnRsQ3RzemkwYkx6Um1saVJwVlJZa1B4Q0pTMno0SzJ6cGFNcVQvdEpiTTR0V1ZJNXEyek9MUnRRRHZWdG1talplUlJtbWpKM0Rqc1Z0SnhhTXF1YXRzemkyanF1UlMySndhc3F1YXRzVGcxWlVqZ1ZiWm5GcXlxY054eFZ0bWNXekszbXJiRTROV1ZyZWF0c1RnMlpXY2lyYk00TldWeDVwYk00TldWeXRzVHR0R1Z3NXEyek8yMlpXK3F0c3pnMVpYdUhGVzJKd2JNdUI1cTJ4TzIxWmNBbHN6dHRXWEFjMWJZbmJiTXVQSXEyek8yMGJjanpWdG1kdG95NVlKYk03YlZ0ejRZcTZtWjJtamJwNnE2bVoybXJMb2VCVjFNVHROVzNVODAxTXp0TkczVUs2bWVVdHQxSE5OU2NwWXVyZWF1cE9VdHQxYitzbXBubExiZEIrc3JhVHRxRjAvakpxVGxyRjBQNnl1cG5sSCtLK3YycHFPVWY0cWVhYWs1Ui9paDVwcU9VZjRvbW81Umk2a2JNVTFKeWovRlhjMWRSeWlOMEo0cWFqbEovRlBWTlM4b2ZpaDVwcU9VUnVwNXBxT1VSdXY4QUcrMU5TOHBKdWgvV1RVdktTNjZmeGxOUzhwRHJvT0xrMUx5a091cmVKVTFOY3BCdXJlQlRVdktRNjdESGZ0VTFMeW1UN200NDRQOEFvd0NhbW8yMmI3bEordjhBWUZMYWpiWXhYR1drcUgxVkhPK0Nwa0RXeXZnZTZNdkRkMmJJUmpoanN4WEhsaEdYYTU4YnFxaVk5TVJQMXhKM1crMWw1a2lsdXM3cWg4SCtLNnYzZ3c3c1FEc3h3NDcxSXhpREhIVEZSRVJmaEVSOVNMVHFHNDZmWkpGWktoMU5GSzR2a1pEOTFwY2Q3c053SjRrS1RoRFdlTVoxcWlKcnhpSmVDSjJ4MXY0bEc0dHVRZVpoVXRKRTJkd0xTN3FENzJKQnczN2swUlZPV01wN09GZUZSWHM3RzFWcVM4VmNENldxcnFpU21rQmJKRytlVXRjMDdDQ0Nkb0t6eThTSWlKdU1jZjRjZmc4V2t1azlzbGRVVzJkOU5NNXJZM3VwM09qTG10eExRY2hHSUdKd1ZuR0phN2VFeEUrdUluNjdiUDFqcUxoY3FuK1hsL3dsbmx3MUdNZmh4L2h4K0R4VzZtdmNENUpJYTZvYStRNTVDSnBQdk93d3hPM2ZnRk5FT1cvUmovREh3WlNhbnZqcHhVbXVuTlFHbGpYbVdURU5KQkl4eDNFZ0pvaHlZN2t4M1I3SStETTZudmpaWFRpdW42cmdBNTNWZmlRTjNIMVRURGtqZnpqdzlrZkJoUHFHNnl1ZVpheVZ4a2JrZmpJODVtOGp0M2JWTk1PV09xM0k3L2RId1E3Vk43YU1qYTJiS0JoaDFIZmxVcUhMSFc3M2o3bytEQnVwTHpDM3B4VmNyV0RFNEI1M2s0bEtjdVBtTy9INzMxZkJuTnFTOFNzTWN0WEk2Tnd3Y0M0a0VKVGsvbWZVZmluM0lkcW05RFo4NUovZkZSdVBOZXAvSEw4KzRWcHVVZ21yM2RlVWJBNlVCeEErbFNZY2U1MXU5dVRFNVpUTk52NjE2Z2FNcmF5VUFiQjk1TDlMc3g1cDFQNDVlQ3k0MUZQY0Jkb240WElPTWdtd0dmTVJnVGo2cU9MSHE5Mk05Y1pUcVZlOVNYVy9GdjR2T1p3emF3T2EwQUhtQTBBWXBNMjN2ZGJ2YjBWbGxNd21EVmwvb3FkbEpSMWNrZE5HQXhrYkNBR3RHd0FCUzZjMkhtRy9FVkdVc3pxMi9zeVlWa243SWwwZTM4MGtFRWo2eXBjdFI1aHYvaWxuWGF4MURYMHo2T3JxNUpLV1FaWHh1SUlJUEFoSnlueFhMcjk3S0tuS1g1cjUzSGpnbzZsTW5UZ2J5bzFFTTMxT0c1TGFqRm0rcHg0L1VwYlVZc25WQ2x0Uml6ZE1UNnBiV2xEcENkNXdVV2tHUm9SVU9seFVXa09rUzJveFE2UlJxSVE1NmpWSWRKeVJVRnhLTFNTY042aWtYSXRJZElCOFVWRHBDVkZwQmQ5YUxSRnhLTFNTUUZGcExwZVNMU0M4bmVpcExnaTBST0tpaEFrQ0xod1JhSXU1cUtrdjVJSUx1ZTlBc3lMU0E0aFJxakRnVlVvMEREdWFKU212UkZCNEtDZ1NFRkJ3VlNnaUJBdzRoRXBRSUtxR0hGdTVCYlpRZDZKU3dRZHlJWWNlS3FVb081SWxLYklRaVVzU05LcUtEL3BSS1VIaENsQjVWWnBRbDVvVW9Tb2xMYkp5K3hFcFFtS3RzemkwYk1yYk9sYlp2cFJtbGlWcFZSVFpEd09LSlMyemtlaXRwcGFNcUR6UzJaeGFzcVZiWW5GcTJvQlZ0TksyekRtak5MYk9SdUt0cHBhTnFuRGVsczZXamF6NjFiWm5Cb3lzNFlxMnpPRFJ0WjlTV3pPRFJ0WUZiWm5CcXlzNU9WdG1jR3JLMXlXeE9EVmxkelZ0bWNHaksxdk5XMlp3YXNyY09LdHN6ZzFiWG5tbHN6ZzBiY1A3TVZiWm5iVzI0RG5zVnRtZHRveTREbWxzenR0R1hEa1ZiWm5iYU11RHVhV2s3YlJseWR6VnRpZHRvMjVLMm5MYU51WUc5TFpuYlcyNWptcnFUbExGMEhOTFo1YW0zVCtNcmFjdFl1aC9XUzA1YTIzUTgxZFRQS1UyNW5tbXBKMmxpNkhtbXBPVVl1cDUvYXJxVGxLRjJJNC9hbW81Ui9peDRsTlNjb3hkZlZOUnloK0xIbW1vNVJpN0htbXBPU2Y0c2YxdjRFMUhKSTNZODAxSEpMOFdQTk5TOG9qZGZWTlJ5Z2JzZWFhbDVTVGRqeisxTlJ5aU4xUFA3Vk5TOG9uWFE4MDFIS1FibWVhYW11VWgxMFBOVFV2S1FicC9HUzE1YUhYVCtNcGJVYmFYWFFjMDFMeWtHNWptbXBlVWgxelV0ZVd6ZGNqelMydVd6ZGNYYzFMYWpiWnV1QjVxVzFHMnpkY0J6UzJvMjJicmdPYWx0UnRzM1hCUzJ1V2gxd0tXc2JiSjljZWYxS1cxR0ROOWFPSlV0dU1HVHE0Yy9vUzJvd1pPcmlwYlVZTW4xcnVlQ2x0Umd6ZlY4eXBiVVlNblZnUzJvd1E2cktsdFJneWZWOHlwYlVZTTNWYVcxR0NIVlI0S1cxcFp1bngzbllqVk0zVkRWTFhTemZVNGVpbHRSaXlkVTQ4VXRxTVdicWoxK3BTMm94WnVtSi8yVkxhMHBkSnpLTFNES0J1UmFRNllxTFNIU3BiVVlvTXFsdGFVT2s1cU5VbDBxTFNES1R1UmFTWEhpaTBSY0ZGcEpmaDZJVWgwb0c3ZWkwaHp5VkZwSmNQcFJxaUxpVVdrbHdDaTBoMG5KRnBKY1R2M0lKTHVTaTBST0tLU0EzSUVYY2tXaUx1YWlvTCtTQ1M3bnZRb2k0bEZva1VzUWdsUm9JR0hFSWxHSEFvVWFxR0hGRXBUWDh2cVJGQjRPOUJRSkc1QXc3bXFsR2lCQXc0aEVvdzRJVW9PSTNGVkZDVThVU2xDUnBRcFFkeUtKUmgzTlZLVUpPUlJLVUpTTjZKU3hLMVZLVUg0N2tTakQwS1VIbmdxbEtFcDRvbEtFb1JGdGs1SWxMRXhWdEp4VTJaVzJaeGFObjlVdG5Tc1RBNzFVcFFsNUZFcFFtUEJMWjByRlFRcmFhVnRxanpTMG5GbzJyS3RzNldqYXNGTFowcmJVQlcwMHJiT09CUktXMm9jTnhWdG5TMGJWRWIwdE5DMjFnK2xXMlp3YU5yZlg2MWJaME5HMXZCTFowTGJXLzJCVzAwTGJYZXFXem9hTnJ6elZ0bWNGdHJ6elMyZVcwYlhuNkZiVGxyYmNCelMyZVcwYlhqZ1ZiVFEwYmNPVGxiWjBMRnhQUEZMVGxxYmNUekNXazdhaGNTcmJQTFdManMyL3dBS1duTE1YSWMwczVheGNSelZ0bmxxYmNoelRVazdTeGNmVlcwNVppNS94dnRUVW5LTVhMK01sbkxQOFRQNjMycGFjc3hjenpUVWNzL3hOM05OUnl6RnpkelYxSnlqL0UzYzAxSEtING03bW1vNVEvRXp6VFVjb3Z4TjNOVFVjcEp1UjRsTFhsbCtKbjliN1UxSExINGtmMXZ0UzE1WmZpZjhaTlJ5aU55NFk3UGltcGVVazNJYzFMT1dnM0ljQ21wcmxKTnhTMTVhVGNod1V0ZVdsMXhQMGZGTFhscE54UE5MWGxvTnhQUDZsTFhscGRjRCtzbHJHMnpkWGc4ZnRVdHJRemRYam50UzFqQkRyZ0Q4VkxhNWFIVjUzSmE4dG02dlBOUzJ0Q0hWeDNFcGJVWU0zVndPODRxV3VoRHExTGEwSWRXOEZMWFFoMVpqdktsdGFHYnF2MVMyb3dadXFqd1V0clNoMVNlYVd1bG02cEhFcVcxcFE2cUNXdWxtNnI5VkxhMG9kVmxMV01XYnFrODFMYTBvTTdpbHRhVW1VODFGcERwaHhPS0xTVE1PQ2kwaDAzTXBhNlVPbFV0cU1VbVZMYTBvTW9VV2tPbVJhU1pDVVdrbHg0cUxTUzRjRVdpTWdDRklNbzRJdEpNcmlvdElMMFdpTGlpMFJjRkZwSmxBM0l0SU1oS0trdjVsQWk3a290RmlTaWtnQ1FONkJGM0pGcEpjQnZVVkplZUNDUzc2U2kwa3VKUW9JcEZ3NEtMU1NTVVVJQkFJQkFJR0NRZ1ljT0tKUnFvWWNRaVVZa3dRcFFreFJGQjRRUE1WVW93NGNVS01FSGNpQkF3NG9sR0hjMEtNTzVGVkZpVnczb1VvU3RPOUVwUWNPQlJLTU9QRlZLTVBSS1cyVncrQ0pTaEtPS3BTaElPYUpTZzdtaVVZZWlVb1NsVktVSlVLVUprU2xDWDFSS1VKaXJhYVZOblMyWndXMm85VmJUU3RzNEtXenBVSm1xcFNtemNpaVV0c3gvMmt0TksyMUpDdHBwVTJySTRwYVRnMGJXZlVyYk9oWXJCeFMwMEtGVzBsVzAwcUZTMG5ZbHBwVzJwMjdDbHBwVTJxZHdLdHBwVzJyY09LV3pwVTJzUEZMVFF0dGFyYVRndHRkczNwYk00TGJYK29WdE9Xb1Y2V25MVUs1VzA1YW0xL3hTMDVhaFhubWxweTFDNGNpcmFUdHFGd1BOTFRsckZ3UE5MVGxxYmNUejJLMm5MUDhSL3N4UzA1Wmk0NHBaeXovRVVzNVppNUZMVGxuK0lwWnl4K0lqbWxweXgrSWptbG5MTVhGbzQvd3EyY3MveEp2UDhBaFN6bGtiaTNudFVzNVpmaUk1cFp5eCtJam1scnl4K0lwWnkwbTVKYThzRzRrN2tzNWFmeEgrekZMT1dQeEZMT1dsMXdkanZVdGVXazNBODB0ZVdrM0E4MHRlV2wxZjZxV3NiYVRYK3FXdkxRYTRZcGE4c2pYYkZMWGxwTmQ2cGE4dExxNzFTMWpCRHEwODFMWFFoMVpqdU8xTGEwSU5XVHVVdHJRazFaTzRwYTZVT3FpZDVTMTBvTlVPSjJxV3VsSnFnbHJwUWF3S1d1aEpyTmlXdWhEcXoxUzEwSWRWZXFsdFJpZzFEaWx0YVVHWXFXdWxKbUhFb3RJTXdSYVNaMUxYU2t6cGE2VUdaUzEwcE0zcWx0YVVtWlJhUVprV2ttWWxGb2pJVHZRcEpmNnFMUkY0UmFTNlVEaWkwZ3pjbEZwTHBDZDZGSkwwYW9pNG9Va3ZBM3FOVWt5amdoU1RJU2lwTHVaUW9zM0pSYUlrbEZKQUVnSUVYY2tXaUx1WlJhU1hqZ29KTWhRU1hvdEVTU2lqRUJBaTdrb3RKSkozb29RQ0FRQ0FRQ0FRQ0FRQ0I1aWlVWWNPS0ZHQ0R1VlFaaWlVb1B3UXBRa1JERHdVRkJ4NEZDanpjMVVvOFFpVUVEeElRTU81b2xHSERnVlVwUWtjRUZDVWNVU2xDUnZBb1VZZWlVb1BWU2pFbUhGRXBRbWQ4VVNsQ1ljVlNqRW81b2xLRWlKUmg2RktFaUpSaVVxcFNoTWhTaE1FU2xDYjFSS1dKaXJhYVZDbzJwYk9oVGFrcTJtaFFxZWFXbWt4VU5LV2xLRTRWU2xDZjFSS1VKanZ4U3pTb1ZEaDhFdE5LaFZPQ3RwcFUyckkyWXBhYUZ0ckZiWjBLYldmV2xwb1VLd2NVczBuODQxTFRRb1ZiVHhWdE5KaXFHNEpacFVLa2M5cVdtbFFxaWR4UzAwbUtzajlKV3pTb1ZidWFXbWxYemp1YVdtZ0NzZDhVczBLK2RjbHBvSHpwVnMwRDUwcFpvUDUwcFp5eDg4ZU9LV25MVjg4bHB5eDg5aHVLV2NzL256elN6bGo1ODgwczVZK2ZQTkxPV1h6M3FsbkxIenlXdkxTYTV5V2NzZk9sTFhRWHpwU3pRUG5TbG1nR3RLbG1oSnJEaWxyb0kxaEtXYUVtckk0cGE2U05XVHhTMTBwK2J3NHFXYVNOVU9hV3VsUHpZUzEwSk5ZM2dVdGRCR3NHQ2xtaFB6aVd1Z25WbklwYTZFR3MyNzB0ZENEVm5tcGE2RW1wY2xycFNaM2NWTFhTa3pZY1V0ZEpHY2MwV2ttY0l0Sk5RQXBacFNhbExYU2sxSHFscm9TWjFMWFFremVxVzFwU1psRnBKbkNMU1RNU2kwa3lPS0ZKTC9WUmFJdkNMUkdRQkNrbVlJdEpNM0lLTFNUTWVhRkpNaUxSRjZMUkYvcW90Sk1qVVdrbVhraFNTOG9wRndSYUl1UEJRb3NTVVVrQm1DTFJaaWhTUzdtb3BGL0pCSms5ZnFRcEpkeVJhTEVsRklrQkFGM0pSYUxNVUtKRkNBUUNBUUNBUUNBUUNBUUNBUUNBUUNCNWloUUR1YUpSZ2dxb2VKQ0JoNkpTaEovWVVTbEI0NG9LRHVSUU1PUEZWS0dZSVVlSVJEUUdZb2xIbVFvdzlDakVqdUJWU2xDWThVU2pFcmVLRktFZzRGRXBRZXFsR0hvVVlsSTRvbEtFeCtLSlNoTU9LcFNoS09hSlJpUUlsR0hvVVlrUktNU25taFJpVnlxVW9URkNqRTZKUmljYzBLVUorUlZ0TktoT2R5V21sUXFDbHBvVUtrODFiVFFvVktXenBQNWtKWnBNVkRmcFMwMHlmekEvc0twU2hPT0JLSlJpZkhpbGxIMS9WTFRTWW5PR3dwWnBNVkR1ZjJwYWFWZk12VnMwbUtwNldtZ3hWdUcxTFRRZnpya3MwRDUxM0ZMTkIvT2xMTkErY1BOTFRRWXJFczBENTdEY3JhYUQrZVBFcFpvSHozcWxtZy9uZlg3VXMwRDUzMSsxTE5BK2Q5ZnRTelFYejNxbG1nZlBGTE5CZk9wWm9JMWg1cVd1Z2ZPSG1sbWdmT2xMWFFYenJrczBENTF5V2FDK2JLV3VoSnFubExOSkdwZmdscnBJMUR1ZjJxV2FTTTU0bExYU1hYOVVzMHArWTlTbHJSR2NjMEtMNWdLTFJHcGJ3UzEwa2FrSlpwU2FuWnZTMTBwTlNjRkxYUVJuS1d1aEpuUE5MWFNrejh5cGE2VW1jSXRFWjBLU1ppVVdpTXJ1YUZFWkR4S2kwV2RDaUwrYUxSR1FJVWt6RG1pMGt6Y2tXaU14VUtTWkNkNVJhU1hvdEVYcUxTVElFV2lNbzRJVWt5dVJTTWg1b1VrdlVXaG1LRkZpVVVrQmlFS0xNRVdpTGloUkZ3NGxSU01nQ0NUS2Y5cEZwSmVTaFJZa29wRWdJRVhjbEZvRWtvcElCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQVlrSUhtS0pSNWdoUmc4bFVQTVVTakVoQ0ZHSlVLVUpBVVF3OElHSEZWS1BNaFI1Z2hReENJZUpRR1lvbEhtNW9VWWY2cWxLRWpodUtKUmlZOFVTbENWdkZDakVvNW9sR0pQVkNqRDFVb3hJVUtNVEhtaVVvVEZFb3hOekd4Q2pFdytDcVVZbUhOQ2xDVUhpaVVZZmloUjUwS01TWWJpaVVZbGR6VktIV2R6UktQckhraFJpYzhVS01Ub2xHSndoUmlvSE5MVFNZcVBWTE5KaW9QTlcwMG1LZzgwczBtS2dwYWFGQ3BJM0phYUI4MDdpVXMwSDgxNmxXelFQbXZVcFpvUDVzcGFhQjgyVXMwRDVzcFpvUDVyMVN6UVBtdlZMTkIvTkJMVFNQbWh5U3pTUG1oeVN6U1BtaHlTelNScWg4RXMwRDVyMVMxMEQ1cjFTelFYelpTelFQbXlsbWdqVkZMTkErYTlTbHJvSHpYcVVzMEY4MDdtcFpvSTFCU3pRUnFEOEV0ZEJmTUZMWFNScU1ONVN6U1JxTWVLbHJwU2FnYzB0ZElNNkZGMTBLSXpsRm91c1VLTHJPNW9VUmxQTlJhSXllcUZFWG90QXlCQ2ttVWMwS0l6RG1pMFJtQ0xSR1lxRkpNeDVvdEVaVHpRb3VvVVdpem9VUmt3NHFMU1RLM21pMFJsSEJDaU1wUmFTWkR6UUl2K2xSYUxNaFJaaWkwUGlnV0lRTE1FV2htS0ZFWDh5b3RKTHdnUmtRSXlJdEpMeWhRekZDaUpIRkZMTUZGb3N4UW9pU2Q2S0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VCaVVEekZFb1prS1BNRUtNTzVGVktQTVVTakVoUW94S2lVb1NBb0dIamdVRERpcWxIbVFvOHdRb1loRU1Ia2dNeFFvWmlpVWVkQ2p6b1VZbFBOVktNVE9Rb3hNZUlSS01UQkNqRXJlYUZLRWdPNG9sSG5WS1BPVVNqRXBHNUVveE1lYVdhUjF6elFvK3Y4QUJFb3hNaFI5WWNsU2o2dzRvbERyQkNqNnJlYUZHSlFkeUpRNmdRb3cvaUVLUE9oUXpvbERxSVVmVlBOQ2gxVHpRb2RVODBLSFZQTkNoMWp6UW8rczdtcVVPczdtaVVPczdtaFE2enVhRkRyRkNoMW5jMEtIV2R6UW9kWjNOQ2gxanpVV2k2cDVvVU9xZWFGRHFubWhRNnA1b1VPcWVhRkYxRUtHZENoblJhTE9CdlFvdW9FS0hWQVFvdXNPYUxSR1lJVVJtSEJDaDFoeVVXaU02RkYxMEtMcm5taTBETWVhV2FVbVFsQ2lNbk5Gb2pJb3RFWlJ6UW9qSzFGb3VzRUtMcWxDaTZwNW90SjZucWkwUmZpb1VNeUZGbUtGREVvdEVUelFHSVFvc3dSYUdaQ2lMaWkwUmNPSlVDTWdDQ1RMeVJhSXlFb1VXWW9VUlBORkxNRkZvczNKQ2htS0ZGaVVVSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBWWxBOHhSS1BNaFF6QlZLTU9QQW9VWWVVU2pFaFFveEtoUmlVSWhpUUZBODQ1b0huOVZTanpGRW9aMEtHWUlVZVlJbEFIa2dlSlFHWW9sSG1Rb0IrQ0ZHSkNoUjlVODFVb3hNZWFGRHJGQ2o2eDVJbEgxdVlRb2RZY2tLUHJCQ2pFemVhSlE2bzVvVVlrSE5DajZpcVVPb2xtaytvVUtIVmNOeVdtaytzN21Vc29kWjNNcFpRNnp1WlN5aDFuSlpwUHJ1Q1dhUjEzYzBzMGpybm1oUTY1NW9VT3VVczBuMTB0Tkk2NkZEcnBacExybm1sclE2NTVvVU91ZWFGRHJ1U3pTWFdLV2FSMW5jMHMwanJPNWxMS0hXZHpLV1VPczdtVXNvdXE1TE5JNmhSYUxxSlpwSFVSYUl5am1vVVhWSE5DaTZ6ZWFMUU13UW91c09TRkYxdVFRb2RZb3RGMW5jd2hSR1k4MEtIVlBOQ2k2aFVXaUwwS0dZb1VXWW9VTVNpbGlFQm1DTFJaZ2hReklVUmVVS0l2OVZGb0Y0K0tCR1FJRVpVS0xxbEZvdW9VS0l1SlFvaVR4UlN6QkNobVVXaXpGQ2l4SlJRZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VCaVVEekZDaG1LSlF6b1VlWUlVTXc1cXBSaDNxaFI1aWlVZlVjaFI5VW9VT3FoUjlVSWhoNFFNUEhOQTgvcXFsSG1LRkRNaFF6b1VNd1FvOHdRb1pnaVVNUnpRR2IxUW84U2hRekZFb1ppaFI1aWhRem9VZlVQcWhRNm54UW9kVDRvVU9vVUtIVktGQVNubXFVZlZQTkVvZFU4MEtIV1BOQ2gxaWhSOVk4MEtIV2Q2SVVPczcwUW9kWjNvaFE2enZSQ2gxbmN3aFJkWTgwS0hXS0ZEcW5taFE2cDVvVU9xZWFGRjFTb3REcWxDaDFQaWhRNm54UW9kVDRvVVJlVUtHZENobUtGRm1LRkRNVUtHSlJhTE42b1VNUWdNd1Fvc3dSYUdZSVVNNkZETWhSWjhONkZEUDZvVVdjYzFGTHFOUUxxaEF1cWkwUmxLRkVYa29VTXhRb2k3bVVXaUxoeFFvWmdvdEZuUW9aaWhRekZDaXhLS0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VCaVVEekZFb1prS1BNaFF6QkNobjlWVW84L3FoUURpaFI1eU55SlI5UnlGRHF1UW8rcVVLSFdRbytxT0tKUTZvUVBxTlFIVUNCOVFjMERFbnFxVU0vcWlVT3A4RUtHZENqekZDaG1LRkRNVUtHZENoblFvWjBLR2RDaG5Rb1pnaFF6QkNobUNGRE1FS0dZSVVNd1FvWmdoUXpvVU02RkRPaFF6b1VNeUZETVVLR1lvVVdmRGVoUTZud1FvZFQ0SVVNL3FoUmRRYzFGb2RRYzBDNmdRTHFoQWRVSUYxVUtCbEtMUmRVb1VPb1VLSXZjVUtHWW9VV1lvdERONm9VV2IxUW9aZ290RE1FS0xNaFF6RkNoaVVVa0FnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnTVNnTVNnZVlvbERNVUtHWW9VTTZGSG1Rb1pnaFFEZ3FsRFA2b1VZZjZvVU0vcWhReitxRkRQNm9VTS9xaFJoNVJLR1lvVU01UW9kUnlGRHFPUW8rbzVDaDFDaFE2aFFvZFZ5RkRxdVFvZFZ5RkRxRkNoMUNoUmRSeUZEcU9Rb1ozSGVoUXpGQ2htS0ZBdUtGRm45VVdobjlVS0dmMVFvWi9WQ2htOVVLTFA2b1VNd1VXaG1DRkRNaFJaMEtHWW9VTXhRb1ppaFJZbEZHSlFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQXhLQXhLQXhLQXhLQXhLQXhLQXhLQXhLQXhLQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFmL1pcIlxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vYXNzZXRzL2ltZy9sb2FkaW5nTG9nby5qcGdcbi8vIG1vZHVsZSBpZCA9IDE1MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgc3VwcG9ydCA9IHtcbiAgc2VhcmNoUGFyYW1zOiAnVVJMU2VhcmNoUGFyYW1zJyBpbiBzZWxmLFxuICBpdGVyYWJsZTogJ1N5bWJvbCcgaW4gc2VsZiAmJiAnaXRlcmF0b3InIGluIFN5bWJvbCxcbiAgYmxvYjpcbiAgICAnRmlsZVJlYWRlcicgaW4gc2VsZiAmJlxuICAgICdCbG9iJyBpbiBzZWxmICYmXG4gICAgKGZ1bmN0aW9uKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbmV3IEJsb2IoKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9KSgpLFxuICBmb3JtRGF0YTogJ0Zvcm1EYXRhJyBpbiBzZWxmLFxuICBhcnJheUJ1ZmZlcjogJ0FycmF5QnVmZmVyJyBpbiBzZWxmXG59XG5cbmZ1bmN0aW9uIGlzRGF0YVZpZXcob2JqKSB7XG4gIHJldHVybiBvYmogJiYgRGF0YVZpZXcucHJvdG90eXBlLmlzUHJvdG90eXBlT2Yob2JqKVxufVxuXG5pZiAoc3VwcG9ydC5hcnJheUJ1ZmZlcikge1xuICB2YXIgdmlld0NsYXNzZXMgPSBbXG4gICAgJ1tvYmplY3QgSW50OEFycmF5XScsXG4gICAgJ1tvYmplY3QgVWludDhBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQ4Q2xhbXBlZEFycmF5XScsXG4gICAgJ1tvYmplY3QgSW50MTZBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQxNkFycmF5XScsXG4gICAgJ1tvYmplY3QgSW50MzJBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQzMkFycmF5XScsXG4gICAgJ1tvYmplY3QgRmxvYXQzMkFycmF5XScsXG4gICAgJ1tvYmplY3QgRmxvYXQ2NEFycmF5XSdcbiAgXVxuXG4gIHZhciBpc0FycmF5QnVmZmVyVmlldyA9XG4gICAgQXJyYXlCdWZmZXIuaXNWaWV3IHx8XG4gICAgZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIHZpZXdDbGFzc2VzLmluZGV4T2YoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikpID4gLTFcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZU5hbWUobmFtZSkge1xuICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgbmFtZSA9IFN0cmluZyhuYW1lKVxuICB9XG4gIGlmICgvW15hLXowLTlcXC0jJCUmJyorLl5fYHx+XS9pLnRlc3QobmFtZSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGNoYXJhY3RlciBpbiBoZWFkZXIgZmllbGQgbmFtZScpXG4gIH1cbiAgcmV0dXJuIG5hbWUudG9Mb3dlckNhc2UoKVxufVxuXG5mdW5jdGlvbiBub3JtYWxpemVWYWx1ZSh2YWx1ZSkge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHZhbHVlID0gU3RyaW5nKHZhbHVlKVxuICB9XG4gIHJldHVybiB2YWx1ZVxufVxuXG4vLyBCdWlsZCBhIGRlc3RydWN0aXZlIGl0ZXJhdG9yIGZvciB0aGUgdmFsdWUgbGlzdFxuZnVuY3Rpb24gaXRlcmF0b3JGb3IoaXRlbXMpIHtcbiAgdmFyIGl0ZXJhdG9yID0ge1xuICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHZhbHVlID0gaXRlbXMuc2hpZnQoKVxuICAgICAgcmV0dXJuIHtkb25lOiB2YWx1ZSA9PT0gdW5kZWZpbmVkLCB2YWx1ZTogdmFsdWV9XG4gICAgfVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgICBpdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXRlcmF0b3JcbiAgICB9XG4gIH1cblxuICByZXR1cm4gaXRlcmF0b3Jcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIEhlYWRlcnMoaGVhZGVycykge1xuICB0aGlzLm1hcCA9IHt9XG5cbiAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICB0aGlzLmFwcGVuZChuYW1lLCB2YWx1ZSlcbiAgICB9LCB0aGlzKVxuICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaGVhZGVycykpIHtcbiAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24oaGVhZGVyKSB7XG4gICAgICB0aGlzLmFwcGVuZChoZWFkZXJbMF0sIGhlYWRlclsxXSlcbiAgICB9LCB0aGlzKVxuICB9IGVsc2UgaWYgKGhlYWRlcnMpIHtcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHRoaXMuYXBwZW5kKG5hbWUsIGhlYWRlcnNbbmFtZV0pXG4gICAgfSwgdGhpcylcbiAgfVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICB2YWx1ZSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxuICB2YXIgb2xkVmFsdWUgPSB0aGlzLm1hcFtuYW1lXVxuICB0aGlzLm1hcFtuYW1lXSA9IG9sZFZhbHVlID8gb2xkVmFsdWUgKyAnLCAnICsgdmFsdWUgOiB2YWx1ZVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZVsnZGVsZXRlJ10gPSBmdW5jdGlvbihuYW1lKSB7XG4gIGRlbGV0ZSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihuYW1lKSB7XG4gIG5hbWUgPSBub3JtYWxpemVOYW1lKG5hbWUpXG4gIHJldHVybiB0aGlzLmhhcyhuYW1lKSA/IHRoaXMubWFwW25hbWVdIDogbnVsbFxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbihuYW1lKSB7XG4gIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24oY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgZm9yICh2YXIgbmFtZSBpbiB0aGlzLm1hcCkge1xuICAgIGlmICh0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCB0aGlzLm1hcFtuYW1lXSwgbmFtZSwgdGhpcylcbiAgICB9XG4gIH1cbn1cblxuSGVhZGVycy5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaXRlbXMgPSBbXVxuICB0aGlzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICBpdGVtcy5wdXNoKG5hbWUpXG4gIH0pXG4gIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbn1cblxuSGVhZGVycy5wcm90b3R5cGUudmFsdWVzID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpdGVtcyA9IFtdXG4gIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSkge1xuICAgIGl0ZW1zLnB1c2godmFsdWUpXG4gIH0pXG4gIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbn1cblxuSGVhZGVycy5wcm90b3R5cGUuZW50cmllcyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaXRlbXMgPSBbXVxuICB0aGlzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICBpdGVtcy5wdXNoKFtuYW1lLCB2YWx1ZV0pXG4gIH0pXG4gIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbn1cblxuaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgSGVhZGVycy5wcm90b3R5cGVbU3ltYm9sLml0ZXJhdG9yXSA9IEhlYWRlcnMucHJvdG90eXBlLmVudHJpZXNcbn1cblxuZnVuY3Rpb24gY29uc3VtZWQoYm9keSkge1xuICBpZiAoYm9keS5ib2R5VXNlZCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgVHlwZUVycm9yKCdBbHJlYWR5IHJlYWQnKSlcbiAgfVxuICBib2R5LmJvZHlVc2VkID0gdHJ1ZVxufVxuXG5mdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXNvbHZlKHJlYWRlci5yZXN1bHQpXG4gICAgfVxuICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICByZWplY3QocmVhZGVyLmVycm9yKVxuICAgIH1cbiAgfSlcbn1cblxuZnVuY3Rpb24gcmVhZEJsb2JBc0FycmF5QnVmZmVyKGJsb2IpIHtcbiAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoYmxvYilcbiAgcmV0dXJuIHByb21pc2Vcbn1cblxuZnVuY3Rpb24gcmVhZEJsb2JBc1RleHQoYmxvYikge1xuICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxuICB2YXIgcHJvbWlzZSA9IGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gIHJlYWRlci5yZWFkQXNUZXh0KGJsb2IpXG4gIHJldHVybiBwcm9taXNlXG59XG5cbmZ1bmN0aW9uIHJlYWRBcnJheUJ1ZmZlckFzVGV4dChidWYpIHtcbiAgdmFyIHZpZXcgPSBuZXcgVWludDhBcnJheShidWYpXG4gIHZhciBjaGFycyA9IG5ldyBBcnJheSh2aWV3Lmxlbmd0aClcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHZpZXcubGVuZ3RoOyBpKyspIHtcbiAgICBjaGFyc1tpXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUodmlld1tpXSlcbiAgfVxuICByZXR1cm4gY2hhcnMuam9pbignJylcbn1cblxuZnVuY3Rpb24gYnVmZmVyQ2xvbmUoYnVmKSB7XG4gIGlmIChidWYuc2xpY2UpIHtcbiAgICByZXR1cm4gYnVmLnNsaWNlKDApXG4gIH0gZWxzZSB7XG4gICAgdmFyIHZpZXcgPSBuZXcgVWludDhBcnJheShidWYuYnl0ZUxlbmd0aClcbiAgICB2aWV3LnNldChuZXcgVWludDhBcnJheShidWYpKVxuICAgIHJldHVybiB2aWV3LmJ1ZmZlclxuICB9XG59XG5cbmZ1bmN0aW9uIEJvZHkoKSB7XG4gIHRoaXMuYm9keVVzZWQgPSBmYWxzZVxuXG4gIHRoaXMuX2luaXRCb2R5ID0gZnVuY3Rpb24oYm9keSkge1xuICAgIHRoaXMuX2JvZHlJbml0ID0gYm9keVxuICAgIGlmICghYm9keSkge1xuICAgICAgdGhpcy5fYm9keVRleHQgPSAnJ1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYmxvYiAmJiBCbG9iLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICB0aGlzLl9ib2R5QmxvYiA9IGJvZHlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuZm9ybURhdGEgJiYgRm9ybURhdGEucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkpIHtcbiAgICAgIHRoaXMuX2JvZHlGb3JtRGF0YSA9IGJvZHlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5LnRvU3RyaW5nKClcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYXJyYXlCdWZmZXIgJiYgc3VwcG9ydC5ibG9iICYmIGlzRGF0YVZpZXcoYm9keSkpIHtcbiAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkuYnVmZmVyKVxuICAgICAgLy8gSUUgMTAtMTEgY2FuJ3QgaGFuZGxlIGEgRGF0YVZpZXcgYm9keS5cbiAgICAgIHRoaXMuX2JvZHlJbml0ID0gbmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pXG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIChBcnJheUJ1ZmZlci5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSB8fCBpc0FycmF5QnVmZmVyVmlldyhib2R5KSkpIHtcbiAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChib2R5KVxuICAgIH1cblxuICAgIGlmICghdGhpcy5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykpIHtcbiAgICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzLnNldCgnY29udGVudC10eXBlJywgJ3RleHQvcGxhaW47Y2hhcnNldD1VVEYtOCcpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlCbG9iICYmIHRoaXMuX2JvZHlCbG9iLnR5cGUpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzLnNldCgnY29udGVudC10eXBlJywgdGhpcy5fYm9keUJsb2IudHlwZSlcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5zZWFyY2hQYXJhbXMgJiYgVVJMU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCcpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuYmxvYikge1xuICAgIHRoaXMuYmxvYiA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUJsb2IpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKSlcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUZvcm1EYXRhKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyBibG9iJylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlUZXh0XSkpXG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5hcnJheUJ1ZmZlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICByZXR1cm4gY29uc3VtZWQodGhpcykgfHwgUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB0aGlzLnRleHQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKVxuICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICByZXR1cm4gcmVhZEJsb2JBc1RleHQodGhpcy5fYm9keUJsb2IpXG4gICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVhZEFycmF5QnVmZmVyQXNUZXh0KHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikpXG4gICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyB0ZXh0JylcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl9ib2R5VGV4dClcbiAgICB9XG4gIH1cblxuICBpZiAoc3VwcG9ydC5mb3JtRGF0YSkge1xuICAgIHRoaXMuZm9ybURhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKGRlY29kZSlcbiAgICB9XG4gIH1cblxuICB0aGlzLmpzb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihKU09OLnBhcnNlKVxuICB9XG5cbiAgcmV0dXJuIHRoaXNcbn1cblxuLy8gSFRUUCBtZXRob2RzIHdob3NlIGNhcGl0YWxpemF0aW9uIHNob3VsZCBiZSBub3JtYWxpemVkXG52YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXVxuXG5mdW5jdGlvbiBub3JtYWxpemVNZXRob2QobWV0aG9kKSB7XG4gIHZhciB1cGNhc2VkID0gbWV0aG9kLnRvVXBwZXJDYXNlKClcbiAgcmV0dXJuIG1ldGhvZHMuaW5kZXhPZih1cGNhc2VkKSA+IC0xID8gdXBjYXNlZCA6IG1ldGhvZFxufVxuXG5leHBvcnQgZnVuY3Rpb24gUmVxdWVzdChpbnB1dCwgb3B0aW9ucykge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuICB2YXIgYm9keSA9IG9wdGlvbnMuYm9keVxuXG4gIGlmIChpbnB1dCBpbnN0YW5jZW9mIFJlcXVlc3QpIHtcbiAgICBpZiAoaW5wdXQuYm9keVVzZWQpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpXG4gICAgfVxuICAgIHRoaXMudXJsID0gaW5wdXQudXJsXG4gICAgdGhpcy5jcmVkZW50aWFscyA9IGlucHV0LmNyZWRlbnRpYWxzXG4gICAgaWYgKCFvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKGlucHV0LmhlYWRlcnMpXG4gICAgfVxuICAgIHRoaXMubWV0aG9kID0gaW5wdXQubWV0aG9kXG4gICAgdGhpcy5tb2RlID0gaW5wdXQubW9kZVxuICAgIHRoaXMuc2lnbmFsID0gaW5wdXQuc2lnbmFsXG4gICAgaWYgKCFib2R5ICYmIGlucHV0Ll9ib2R5SW5pdCAhPSBudWxsKSB7XG4gICAgICBib2R5ID0gaW5wdXQuX2JvZHlJbml0XG4gICAgICBpbnB1dC5ib2R5VXNlZCA9IHRydWVcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhpcy51cmwgPSBTdHJpbmcoaW5wdXQpXG4gIH1cblxuICB0aGlzLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscyB8fCB0aGlzLmNyZWRlbnRpYWxzIHx8ICdzYW1lLW9yaWdpbidcbiAgaWYgKG9wdGlvbnMuaGVhZGVycyB8fCAhdGhpcy5oZWFkZXJzKSB7XG4gICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICB9XG4gIHRoaXMubWV0aG9kID0gbm9ybWFsaXplTWV0aG9kKG9wdGlvbnMubWV0aG9kIHx8IHRoaXMubWV0aG9kIHx8ICdHRVQnKVxuICB0aGlzLm1vZGUgPSBvcHRpb25zLm1vZGUgfHwgdGhpcy5tb2RlIHx8IG51bGxcbiAgdGhpcy5zaWduYWwgPSBvcHRpb25zLnNpZ25hbCB8fCB0aGlzLnNpZ25hbFxuICB0aGlzLnJlZmVycmVyID0gbnVsbFxuXG4gIGlmICgodGhpcy5tZXRob2QgPT09ICdHRVQnIHx8IHRoaXMubWV0aG9kID09PSAnSEVBRCcpICYmIGJvZHkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdCb2R5IG5vdCBhbGxvd2VkIGZvciBHRVQgb3IgSEVBRCByZXF1ZXN0cycpXG4gIH1cbiAgdGhpcy5faW5pdEJvZHkoYm9keSlcbn1cblxuUmVxdWVzdC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBSZXF1ZXN0KHRoaXMsIHtib2R5OiB0aGlzLl9ib2R5SW5pdH0pXG59XG5cbmZ1bmN0aW9uIGRlY29kZShib2R5KSB7XG4gIHZhciBmb3JtID0gbmV3IEZvcm1EYXRhKClcbiAgYm9keVxuICAgIC50cmltKClcbiAgICAuc3BsaXQoJyYnKVxuICAgIC5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoJz0nKVxuICAgICAgICB2YXIgbmFtZSA9IHNwbGl0LnNoaWZ0KCkucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgIGZvcm0uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChuYW1lKSwgZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKSlcbiAgICAgIH1cbiAgICB9KVxuICByZXR1cm4gZm9ybVxufVxuXG5mdW5jdGlvbiBwYXJzZUhlYWRlcnMocmF3SGVhZGVycykge1xuICB2YXIgaGVhZGVycyA9IG5ldyBIZWFkZXJzKClcbiAgLy8gUmVwbGFjZSBpbnN0YW5jZXMgb2YgXFxyXFxuIGFuZCBcXG4gZm9sbG93ZWQgYnkgYXQgbGVhc3Qgb25lIHNwYWNlIG9yIGhvcml6b250YWwgdGFiIHdpdGggYSBzcGFjZVxuICAvLyBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNzIzMCNzZWN0aW9uLTMuMlxuICB2YXIgcHJlUHJvY2Vzc2VkSGVhZGVycyA9IHJhd0hlYWRlcnMucmVwbGFjZSgvXFxyP1xcbltcXHQgXSsvZywgJyAnKVxuICBwcmVQcm9jZXNzZWRIZWFkZXJzLnNwbGl0KC9cXHI/XFxuLykuZm9yRWFjaChmdW5jdGlvbihsaW5lKSB7XG4gICAgdmFyIHBhcnRzID0gbGluZS5zcGxpdCgnOicpXG4gICAgdmFyIGtleSA9IHBhcnRzLnNoaWZ0KCkudHJpbSgpXG4gICAgaWYgKGtleSkge1xuICAgICAgdmFyIHZhbHVlID0gcGFydHMuam9pbignOicpLnRyaW0oKVxuICAgICAgaGVhZGVycy5hcHBlbmQoa2V5LCB2YWx1ZSlcbiAgICB9XG4gIH0pXG4gIHJldHVybiBoZWFkZXJzXG59XG5cbkJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuZXhwb3J0IGZ1bmN0aW9uIFJlc3BvbnNlKGJvZHlJbml0LCBvcHRpb25zKSB7XG4gIGlmICghb3B0aW9ucykge1xuICAgIG9wdGlvbnMgPSB7fVxuICB9XG5cbiAgdGhpcy50eXBlID0gJ2RlZmF1bHQnXG4gIHRoaXMuc3RhdHVzID0gb3B0aW9ucy5zdGF0dXMgPT09IHVuZGVmaW5lZCA/IDIwMCA6IG9wdGlvbnMuc3RhdHVzXG4gIHRoaXMub2sgPSB0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDBcbiAgdGhpcy5zdGF0dXNUZXh0ID0gJ3N0YXR1c1RleHQnIGluIG9wdGlvbnMgPyBvcHRpb25zLnN0YXR1c1RleHQgOiAnT0snXG4gIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycylcbiAgdGhpcy51cmwgPSBvcHRpb25zLnVybCB8fCAnJ1xuICB0aGlzLl9pbml0Qm9keShib2R5SW5pdClcbn1cblxuQm9keS5jYWxsKFJlc3BvbnNlLnByb3RvdHlwZSlcblxuUmVzcG9uc2UucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgUmVzcG9uc2UodGhpcy5fYm9keUluaXQsIHtcbiAgICBzdGF0dXM6IHRoaXMuc3RhdHVzLFxuICAgIHN0YXR1c1RleHQ6IHRoaXMuc3RhdHVzVGV4dCxcbiAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyh0aGlzLmhlYWRlcnMpLFxuICAgIHVybDogdGhpcy51cmxcbiAgfSlcbn1cblxuUmVzcG9uc2UuZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IDAsIHN0YXR1c1RleHQ6ICcnfSlcbiAgcmVzcG9uc2UudHlwZSA9ICdlcnJvcidcbiAgcmV0dXJuIHJlc3BvbnNlXG59XG5cbnZhciByZWRpcmVjdFN0YXR1c2VzID0gWzMwMSwgMzAyLCAzMDMsIDMwNywgMzA4XVxuXG5SZXNwb25zZS5yZWRpcmVjdCA9IGZ1bmN0aW9uKHVybCwgc3RhdHVzKSB7XG4gIGlmIChyZWRpcmVjdFN0YXR1c2VzLmluZGV4T2Yoc3RhdHVzKSA9PT0gLTEpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW52YWxpZCBzdGF0dXMgY29kZScpXG4gIH1cblxuICByZXR1cm4gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IHN0YXR1cywgaGVhZGVyczoge2xvY2F0aW9uOiB1cmx9fSlcbn1cblxuZXhwb3J0IHZhciBET01FeGNlcHRpb24gPSBzZWxmLkRPTUV4Y2VwdGlvblxudHJ5IHtcbiAgbmV3IERPTUV4Y2VwdGlvbigpXG59IGNhdGNoIChlcnIpIHtcbiAgRE9NRXhjZXB0aW9uID0gZnVuY3Rpb24obWVzc2FnZSwgbmFtZSkge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2VcbiAgICB0aGlzLm5hbWUgPSBuYW1lXG4gICAgdmFyIGVycm9yID0gRXJyb3IobWVzc2FnZSlcbiAgICB0aGlzLnN0YWNrID0gZXJyb3Iuc3RhY2tcbiAgfVxuICBET01FeGNlcHRpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpXG4gIERPTUV4Y2VwdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBET01FeGNlcHRpb25cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZldGNoKGlucHV0LCBpbml0KSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB2YXIgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KGlucHV0LCBpbml0KVxuXG4gICAgaWYgKHJlcXVlc3Quc2lnbmFsICYmIHJlcXVlc3Quc2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgIHJldHVybiByZWplY3QobmV3IERPTUV4Y2VwdGlvbignQWJvcnRlZCcsICdBYm9ydEVycm9yJykpXG4gICAgfVxuXG4gICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpXG5cbiAgICBmdW5jdGlvbiBhYm9ydFhocigpIHtcbiAgICAgIHhoci5hYm9ydCgpXG4gICAgfVxuXG4gICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIHN0YXR1czogeGhyLnN0YXR1cyxcbiAgICAgICAgc3RhdHVzVGV4dDogeGhyLnN0YXR1c1RleHQsXG4gICAgICAgIGhlYWRlcnM6IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwgJycpXG4gICAgICB9XG4gICAgICBvcHRpb25zLnVybCA9ICdyZXNwb25zZVVSTCcgaW4geGhyID8geGhyLnJlc3BvbnNlVVJMIDogb3B0aW9ucy5oZWFkZXJzLmdldCgnWC1SZXF1ZXN0LVVSTCcpXG4gICAgICB2YXIgYm9keSA9ICdyZXNwb25zZScgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dFxuICAgICAgcmVzb2x2ZShuZXcgUmVzcG9uc2UoYm9keSwgb3B0aW9ucykpXG4gICAgfVxuXG4gICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKCdOZXR3b3JrIHJlcXVlc3QgZmFpbGVkJykpXG4gICAgfVxuXG4gICAgeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSlcbiAgICB9XG5cbiAgICB4aHIub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmVqZWN0KG5ldyBET01FeGNlcHRpb24oJ0Fib3J0ZWQnLCAnQWJvcnRFcnJvcicpKVxuICAgIH1cblxuICAgIHhoci5vcGVuKHJlcXVlc3QubWV0aG9kLCByZXF1ZXN0LnVybCwgdHJ1ZSlcblxuICAgIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZScpIHtcbiAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlXG4gICAgfSBlbHNlIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnb21pdCcpIHtcbiAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSBmYWxzZVxuICAgIH1cblxuICAgIGlmICgncmVzcG9uc2VUeXBlJyBpbiB4aHIgJiYgc3VwcG9ydC5ibG9iKSB7XG4gICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InXG4gICAgfVxuXG4gICAgcmVxdWVzdC5oZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKVxuICAgIH0pXG5cbiAgICBpZiAocmVxdWVzdC5zaWduYWwpIHtcbiAgICAgIHJlcXVlc3Quc2lnbmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgYWJvcnRYaHIpXG5cbiAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gRE9ORSAoc3VjY2VzcyBvciBmYWlsdXJlKVxuICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICByZXF1ZXN0LnNpZ25hbC5yZW1vdmVFdmVudExpc3RlbmVyKCdhYm9ydCcsIGFib3J0WGhyKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgeGhyLnNlbmQodHlwZW9mIHJlcXVlc3QuX2JvZHlJbml0ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiByZXF1ZXN0Ll9ib2R5SW5pdClcbiAgfSlcbn1cblxuZmV0Y2gucG9seWZpbGwgPSB0cnVlXG5cbmlmICghc2VsZi5mZXRjaCkge1xuICBzZWxmLmZldGNoID0gZmV0Y2hcbiAgc2VsZi5IZWFkZXJzID0gSGVhZGVyc1xuICBzZWxmLlJlcXVlc3QgPSBSZXF1ZXN0XG4gIHNlbGYuUmVzcG9uc2UgPSBSZXNwb25zZVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3doYXR3Zy1mZXRjaC9mZXRjaC5qc1xuLy8gbW9kdWxlIGlkID0gMTUzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=
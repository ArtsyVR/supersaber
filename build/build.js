(function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};return __webpack_require__.d(getter,'a',getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p='',__webpack_require__(__webpack_require__.s=131)})([function(module){var g=function(){return this}();try{g=g||Function('return this')()||(1,eval)('this')}catch(e){'object'==typeof window&&(g=window)}module.exports=g},function(module){module.exports=function clone(obj){return JSON.parse(JSON.stringify(obj))}},function(module){module.exports.getS3FileUrl=function getS3FileUrl(id,name){return`${'https://saber.supermedium.com'}/${id}-${name}?v=1`}},function(module){var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString;module.exports=function forEach(obj,fn,ctx){if('[object Function]'!==toString.call(fn))throw new TypeError('iterator must be a function');var l=obj.length;if(l===+l)for(var i=0;i<l;i++)fn.call(ctx,obj[i],i,obj);else for(var k in obj)hasOwn.call(obj,k)&&fn.call(ctx,obj[k],k,obj)}},function(module,exports,__webpack_require__){'use strict';function AlgoliaSearchError(message,extraProperties){var forEach=__webpack_require__(3),error=this;'function'==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):error.stack=new Error().stack||'Cannot get a stacktrace, browser is too old',this.name='AlgoliaSearchError',this.message=message||'Unknown error',extraProperties&&forEach(extraProperties,function addToErrorObject(value,key){error[key]=value})}function createCustomError(name,message){function AlgoliaSearchCustomError(){var args=Array.prototype.slice.call(arguments,0);'string'!=typeof args[0]&&args.unshift(message),AlgoliaSearchError.apply(this,args),this.name='AlgoliaSearch'+name+'Error'}return inherits(AlgoliaSearchCustomError,AlgoliaSearchError),AlgoliaSearchCustomError}var inherits=__webpack_require__(18);inherits(AlgoliaSearchError,Error),module.exports={AlgoliaSearchError:AlgoliaSearchError,UnparsableJSON:createCustomError('UnparsableJSON','Could not parse the incoming response as JSON, see err.more for details'),RequestTimeout:createCustomError('RequestTimeout','Request timedout before getting a response'),Network:createCustomError('Network','Network issue, see err.more for details'),JSONPScriptFail:createCustomError('JSONPScriptFail','<script> was loaded but did not call our provided callback'),JSONPScriptError:createCustomError('JSONPScriptError','<script> unable to load due to an `error` event on it'),Unknown:createCustomError('Unknown','Unknown error occured')}},function(module,exports,__webpack_require__){var foreach=__webpack_require__(3);module.exports=function map(arr,fn){var newArr=[];return foreach(arr,function(item,itemIndex){newArr.push(fn(item,itemIndex,arr))}),newArr}},function(module){module.exports={OFF:'#111',RED:'#ff3a7b',BLUE:'#08bfa2',UI_ACCENT:'#08bfa2',UI_ACCENT2:'#f01978',SKY_OFF:'#297547',SKY_BLUE:'#840d42',SKY_RED:'#154136',BG_OFF:'#081a0f',BG_BLUE:'#379f5e',BG_BRIGHTBLUE:'#4fd983',BG_RED:'#ff1f81',BG_BRIGHTRED:'#ff6bb0',NEON_OFF:'#000',NEON_BLUE:'#008a70',NEON_BRIGHTBLUE:'#87c2ff',NEON_RED:'#f01978',NEON_BRIGHTRED:'#ff70b5',TEXT_OFF:'#000',TEXT_NORMAL:'#444',TEXT_BOLD:'#888',BEAT_RED:'#660338',BEAT_BLUE:'#036657',MINE_RED:'#1c060e',MINE_RED_EMISSION:'#2a0d1b',MINE_BLUE:'#011114',MINE_BLUE_EMISSION:'#072020'}},function(module,exports,__webpack_require__){function load(){var r;try{r=exports.storage.debug}catch(e){}return r}exports=module.exports=__webpack_require__(137),exports.log=function log(){return'object'==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},exports.formatArgs=function formatArgs(){var args=arguments,useColors=this.useColors;if(args[0]=(useColors?'%c':'')+this.namespace+(useColors?' %c':' ')+args[0]+(useColors?'%c ':' '),!useColors)return args;var c='color: '+this.color;args=[args[0],c,'color: inherit'].concat(Array.prototype.slice.call(args,1));var index=0,lastC=0;return args[0].replace(/%[a-z%]/g,function(match){'%%'===match||(index++,'%c'===match&&(lastC=index))}),args.splice(lastC,0,c),args},exports.save=function save(namespaces){try{null==namespaces?exports.storage.removeItem('debug'):exports.storage.debug=namespaces}catch(e){}},exports.load=load,exports.useColors=function useColors(){return'WebkitAppearance'in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)},exports.storage='undefined'!=typeof chrome&&'undefined'!=typeof chrome.storage?chrome.storage.local:function localstorage(){try{return window.localStorage}catch(e){}}(),exports.colors=['lightseagreen','forestgreen','goldenrod','dodgerblue','darkorchid','crimson'],exports.formatters.j=function(v){return JSON.stringify(v)},exports.enable(load())},function(module){module.exports=Array.isArray||function(arr){return'[object Array]'==Object.prototype.toString.call(arr)}},function(module){function defaultSetTimout(){throw new Error('setTimeout has not been defined')}function defaultClearTimeout(){throw new Error('clearTimeout has not been defined')}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;(function(){try{cachedSetTimeout='function'==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout='function'==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}})();var queue=[],draining=!1,queueIndex=-1,currentQueue;process.nextTick=function(fun){var args=Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title='browser',process.browser=!0,process.env={},process.argv=[],process.version='',process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(){return[]},process.binding=function(){throw new Error('process.binding is not supported')},process.cwd=function(){return'/'},process.chdir=function(){throw new Error('process.chdir is not supported')},process.umask=function(){return 0}},function(module,__webpack_exports__){'use strict';const BEAT_WARMUP_SPEED=155;__webpack_exports__.a=BEAT_WARMUP_SPEED;__webpack_exports__.b=1e3*(25/BEAT_WARMUP_SPEED)},function(module){function getGridUvs(row,column,totalRows,totalColumns){const columnWidth=1/totalColumns,rowHeight=1/totalRows;return uvs[0].set(columnWidth*column,rowHeight*row+rowHeight),uvs[1].set(columnWidth*column,rowHeight*row),uvs[2].set(columnWidth*column+columnWidth,rowHeight*row),uvs[3].set(columnWidth*column+columnWidth,rowHeight*row+rowHeight),uvs}var uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2,new THREE.Vector2];AFRAME.registerComponent('atlas-uvs',{dependencies:['geometry'],schema:{totalColumns:{type:'int',default:1},totalRows:{type:'int',default:1},column:{type:'int',default:1},row:{type:'int',default:1}},update:function(){const data=this.data,uvs=getGridUvs(data.row-1,data.column-1,data.totalRows,data.totalColumns),geometry=this.el.getObject3D('mesh').geometry;geometry.faceVertexUvs[0][0][0].copy(uvs[0]),geometry.faceVertexUvs[0][0][1].copy(uvs[1]),geometry.faceVertexUvs[0][0][2].copy(uvs[3]),geometry.faceVertexUvs[0][1][0].copy(uvs[1]),geometry.faceVertexUvs[0][1][1].copy(uvs[2]),geometry.faceVertexUvs[0][1][2].copy(uvs[3]),geometry.uvsNeedUpdate=!0}}),AFRAME.registerComponent('dynamic-texture-atlas',{schema:{canvasId:{default:'dynamicAtlas'},canvasHeight:{default:1024},canvasWidth:{default:1024},debug:{default:!1},numColumns:{default:8},numRows:{default:8}},multiple:!0,init:function(){const canvas=this.canvas=document.createElement('canvas');canvas.id=this.data.canvasId,canvas.height=this.data.canvasHeight,canvas.width=this.data.canvasWidth,this.ctx=canvas.getContext('2d'),document.body.appendChild(canvas),this.data.debug&&(canvas.style.left=0,canvas.style.top=0,canvas.style.position='fixed',canvas.style.zIndex=9999999999)},drawTexture:function(image,row,column,width,height){const canvas=this.canvas,data=this.data;image.complete||(image.onload=()=>{this.drawTexture(image,row,column)});const gridHeight=height||canvas.height/data.numRows,gridWidth=width||canvas.width/data.numColumns;return this.ctx.drawImage(image,gridWidth*row,gridWidth*column,gridWidth,gridHeight),getGridUvs(row,column,data.numRows,data.numColumns)}}),module.exports.getGridUvs=getGridUvs},function(){THREE.BufferGeometryUtils={computeTangents:function(geometry){function handleTriangle(a,b,c){vA.fromArray(positions,3*a),vB.fromArray(positions,3*b),vC.fromArray(positions,3*c),uvA.fromArray(uvs,2*a),uvB.fromArray(uvs,2*b),uvC.fromArray(uvs,2*c);var x1=vB.x-vA.x,x2=vC.x-vA.x,y1=vB.y-vA.y,y2=vC.y-vA.y,z1=vB.z-vA.z,z2=vC.z-vA.z,s1=uvB.x-uvA.x,s2=uvC.x-uvA.x,t1=uvB.y-uvA.y,t2=uvC.y-uvA.y,r=1/(s1*t2-s2*t1);sdir.set((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r),tdir.set((s1*x2-s2*x1)*r,(s1*y2-s2*y1)*r,(s1*z2-s2*z1)*r),tan1[a].add(sdir),tan1[b].add(sdir),tan1[c].add(sdir),tan2[a].add(tdir),tan2[b].add(tdir),tan2[c].add(tdir)}function handleVertex(v){n.fromArray(normals,3*v),n2.copy(n),t=tan1[v],tmp.copy(t),tmp.sub(n.multiplyScalar(n.dot(t))).normalize(),tmp2.crossVectors(n2,t),test=tmp2.dot(tan2[v]),w=0>test?-1:1,tangents[4*v]=tmp.x,tangents[4*v+1]=tmp.y,tangents[4*v+2]=tmp.z,tangents[4*v+3]=w}var index=geometry.index,attributes=geometry.attributes;if(null===index||void 0===attributes.position||void 0===attributes.normal||void 0===attributes.uv)return void console.warn('THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()');var indices=index.array,positions=attributes.position.array,normals=attributes.normal.array,uvs=attributes.uv.array,nVertices=positions.length/3;attributes.tangent===void 0&&geometry.addAttribute('tangent',new THREE.BufferAttribute(new Float32Array(4*nVertices),4));for(var tangents=attributes.tangent.array,tan1=[],tan2=[],k=0;k<nVertices;k++)tan1[k]=new THREE.Vector3,tan2[k]=new THREE.Vector3;var vA=new THREE.Vector3,vB=new THREE.Vector3,vC=new THREE.Vector3,uvA=new THREE.Vector2,uvB=new THREE.Vector2,uvC=new THREE.Vector2,sdir=new THREE.Vector3,tdir=new THREE.Vector3,groups=geometry.groups;0===groups.length&&(groups=[{start:0,count:indices.length}]);for(var j=0,jl=groups.length;j<jl;++j)for(var group=groups[j],start=group.start,count=group.count,i=start,il=start+count;i<il;i+=3)handleTriangle(indices[i+0],indices[i+1],indices[i+2]);for(var tmp=new THREE.Vector3,tmp2=new THREE.Vector3,n=new THREE.Vector3,n2=new THREE.Vector3,j=0,jl=groups.length,w,t,test;j<jl;++j)for(var group=groups[j],start=group.start,count=group.count,i=start,il=start+count;i<il;i+=3)handleVertex(indices[i+0]),handleVertex(indices[i+1]),handleVertex(indices[i+2])},mergeBufferGeometries:function(geometries,useGroups){for(var isIndexed=null!==geometries[0].index,attributesUsed=new Set(Object.keys(geometries[0].attributes)),morphAttributesUsed=new Set(Object.keys(geometries[0].morphAttributes)),attributes={},morphAttributes={},mergedGeometry=new THREE.BufferGeometry,offset=0,i=0,geometry;i<geometries.length;++i){if(geometry=geometries[i],isIndexed!=(null!==geometry.index))return null;for(var name in geometry.attributes){if(!attributesUsed.has(name))return null;void 0===attributes[name]&&(attributes[name]=[]),attributes[name].push(geometry.attributes[name])}for(var name in geometry.morphAttributes){if(!morphAttributesUsed.has(name))return null;void 0===morphAttributes[name]&&(morphAttributes[name]=[]),morphAttributes[name].push(geometry.morphAttributes[name])}if(mergedGeometry.userData.mergedUserData=mergedGeometry.userData.mergedUserData||[],mergedGeometry.userData.mergedUserData.push(geometry.userData),useGroups){var count;if(isIndexed)count=geometry.index.count;else if(void 0!==geometry.attributes.position)count=geometry.attributes.position.count;else return null;mergedGeometry.addGroup(offset,count,i),offset+=count}}if(isIndexed){for(var indexOffset=0,indexList=[],i=0,index;i<geometries.length;++i){if(index=geometries[i].index,0<indexOffset){index=index.clone();for(var j=0;j<index.count;++j)index.setX(j,index.getX(j)+indexOffset)}indexList.push(index),indexOffset+=geometries[i].attributes.position.count}var mergedIndex=this.mergeBufferAttributes(indexList);if(!mergedIndex)return null;mergedGeometry.index=mergedIndex}for(var name in attributes){var mergedAttribute=this.mergeBufferAttributes(attributes[name]);if(!mergedAttribute)return null;mergedGeometry.addAttribute(name,mergedAttribute)}for(var name in morphAttributes){var numMorphTargets=morphAttributes[name][0].length;if(0===numMorphTargets)break;mergedGeometry.morphAttributes=mergedGeometry.morphAttributes||{},mergedGeometry.morphAttributes[name]=[];for(var i=0,morphAttributesToMerge;i<numMorphTargets;++i){morphAttributesToMerge=[];for(var j=0;j<morphAttributes[name].length;++j)morphAttributesToMerge.push(morphAttributes[name][j][i]);var mergedMorphAttribute=this.mergeBufferAttributes(morphAttributesToMerge);if(!mergedMorphAttribute)return null;mergedGeometry.morphAttributes[name].push(mergedMorphAttribute)}}return mergedGeometry},mergeBufferAttributes:function(attributes){for(var arrayLength=0,i=0,TypedArray,itemSize,normalized,attribute;i<attributes.length;++i){if(attribute=attributes[i],attribute.isInterleavedBufferAttribute)return null;if(void 0==TypedArray&&(TypedArray=attribute.array.constructor),TypedArray!==attribute.array.constructor)return null;if(void 0==itemSize&&(itemSize=attribute.itemSize),itemSize!==attribute.itemSize)return null;if(void 0==normalized&&(normalized=attribute.normalized),normalized!==attribute.normalized)return null;arrayLength+=attribute.array.length}for(var array=new TypedArray(arrayLength),offset=0,j=0;j<attributes.length;++j)array.set(attributes[j].array,offset),offset+=attributes[j].array.length;return new THREE.BufferAttribute(array,itemSize,normalized)}}},function(module,exports,__webpack_require__){'use strict';function createFirebaseNamespace(){function app(name){return name=name||DEFAULT_ENTRY_NAME,contains(apps_,name)||error('no-app',{name:name}),apps_[name]}function getApps(){return Object.keys(apps_).map(function(name){return apps_[name]})}function callAppHooks(app,eventName){Object.keys(factories).forEach(function(serviceName){var factoryName=useAsService(app,serviceName);null===factoryName||appHooks[factoryName]&&appHooks[factoryName](eventName,app)})}function useAsService(app,name){if('serverAuth'===name)return null;app.options;return name}var apps_={},factories={},appHooks={},namespace={__esModule:!0,initializeApp:function initializeApp(options,rawConfig){if(void 0===rawConfig&&(rawConfig={}),'object'!=typeof rawConfig||null===rawConfig){var name_1=rawConfig;rawConfig={name:name_1}}var config=rawConfig;void 0===config.name&&(config.name=DEFAULT_ENTRY_NAME);var name=config.name;'string'==typeof name&&name||error('bad-app-name',{name:name+''}),contains(apps_,name)&&error('duplicate-app',{name:name});var app=new FirebaseAppImpl(options,config,namespace);return apps_[name]=app,callAppHooks(app,'create'),app},app:app,apps:null,Promise:Promise,SDK_VERSION:'5.5.0',INTERNAL:{registerService:function registerService(name,createService,serviceProperties,appHook,allowMultipleInstances){factories[name]&&error('duplicate-service',{name:name}),factories[name]=createService,appHook&&(appHooks[name]=appHook,getApps().forEach(function(app){appHook('create',app)}));var serviceNamespace=function(appArg){return void 0===appArg&&(appArg=app()),'function'!=typeof appArg[name]&&error('invalid-app-argument',{name:name}),appArg[name]()};return void 0!==serviceProperties&&util.deepExtend(serviceNamespace,serviceProperties),namespace[name]=serviceNamespace,FirebaseAppImpl.prototype[name]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var serviceFxn=this._getService.bind(this,name);return serviceFxn.apply(this,allowMultipleInstances?args:[])},serviceNamespace},createFirebaseNamespace:createFirebaseNamespace,extendNamespace:function extendNamespace(props){util.deepExtend(namespace,props)},createSubscribe:util.createSubscribe,ErrorFactory:util.ErrorFactory,removeApp:function removeApp(name){var app=apps_[name];callAppHooks(app,'delete'),delete apps_[name]},factories:factories,useAsService:useAsService,Promise:Promise,deepExtend:util.deepExtend}};return util.patchProperty(namespace,'default',namespace),Object.defineProperty(namespace,'apps',{get:getApps}),util.patchProperty(app,'App',FirebaseAppImpl),namespace}function error(code,args){throw appErrors.create(code,args)}Object.defineProperty(exports,'__esModule',{value:!0});var util=__webpack_require__(38),contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},DEFAULT_ENTRY_NAME='[DEFAULT]',tokenListeners=[],FirebaseAppImpl=function(){function FirebaseAppImpl(options,config,firebase_){this.firebase_=firebase_,this.isDeleted_=!1,this.services_={},this.name_=config.name,this._automaticDataCollectionEnabled=config.automaticDataCollectionEnabled||!1,this.options_=util.deepCopy(options),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(callback){tokenListeners.push(callback),setTimeout(function(){return callback(null)},0)},removeAuthTokenListener:function(callback){tokenListeners=tokenListeners.filter(function(listener){return listener!==callback})}}}return Object.defineProperty(FirebaseAppImpl.prototype,'automaticDataCollectionEnabled',{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(val){this.checkDestroyed_(),this._automaticDataCollectionEnabled=val},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,'name',{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,'options',{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),FirebaseAppImpl.prototype.delete=function(){var _this=this;return new Promise(function(resolve){_this.checkDestroyed_(),resolve()}).then(function(){_this.firebase_.INTERNAL.removeApp(_this.name_);var services=[];return Object.keys(_this.services_).forEach(function(serviceKey){Object.keys(_this.services_[serviceKey]).forEach(function(instanceKey){services.push(_this.services_[serviceKey][instanceKey])})}),Promise.all(services.map(function(service){return service.INTERNAL.delete()}))}).then(function(){_this.isDeleted_=!0,_this.services_={}})},FirebaseAppImpl.prototype._getService=function(name,instanceIdentifier){if(void 0===instanceIdentifier&&(instanceIdentifier=DEFAULT_ENTRY_NAME),this.checkDestroyed_(),this.services_[name]||(this.services_[name]={}),!this.services_[name][instanceIdentifier]){var instanceSpecifier=instanceIdentifier===DEFAULT_ENTRY_NAME?void 0:instanceIdentifier,service=this.firebase_.INTERNAL.factories[name](this,this.extendApp.bind(this),instanceSpecifier);this.services_[name][instanceIdentifier]=service}return this.services_[name][instanceIdentifier]},FirebaseAppImpl.prototype.extendApp=function(props){var _this=this;util.deepExtend(this,props),props.INTERNAL&&props.INTERNAL.addAuthTokenListener&&(tokenListeners.forEach(function(listener){_this.INTERNAL.addAuthTokenListener(listener)}),tokenListeners=[])},FirebaseAppImpl.prototype.checkDestroyed_=function(){this.isDeleted_&&error('app-deleted',{name:this.name_})},FirebaseAppImpl}();FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log('dc');var appErrors=new util.ErrorFactory('app','Firebase',{"no-app":'No Firebase App \'{$name}\' has been created - '+'call Firebase App.initializeApp()',"bad-app-name":'Illegal App name: \'{$name}',"duplicate-app":'Firebase App named \'{$name}\' already exists',"app-deleted":'Firebase App named \'{$name}\' already deleted',"duplicate-service":'Firebase service named \'{$name}\' already registered',"sa-not-supported":'Initializing the Firebase SDK with a service '+'account is only allowed in a Node.js environment. On client '+'devices, you should instead initialize the SDK with an api key and '+'auth domain',"invalid-app-argument":'firebase.{$name}() takes either no argument or a '+'Firebase App instance.'}),firebase=createFirebaseNamespace();exports.firebase=firebase,exports.default=firebase},function(module){const decorations=function(){const funcMap=new WeakMap;return{add:function add(func,decorator){const parent=funcMap.has(func)?func:void 0,decoratedFunc=function(){func.apply(this,arguments)};return funcMap.set(decoratedFunc,{parent:parent,decorator:decorator}),decoratedFunc},getAll:function getAll(func){for(var iter=funcMap.get(func),decorators=[];iter!==void 0;)decorators.push(iter.decorator),iter=iter.parent;return decorators},isFunctionDecorated:function isFunctionDecorated(func){return funcMap.has(func)}}}();(function(){function executeDecoratorsOnNewComponent(component){const prot=Object.getPrototypeOf(component);Object.getOwnPropertyNames(prot).forEach(function(name){const prop=prot[name];'function'==typeof prop&&decorations.isFunctionDecorated(prop)&&decorations.getAll(prop).forEach(function(decorator){component[name]=decorator.call(component,name,prop)})})}function wrapComponent(name){const orig=AFRAME.components[name].Component;AFRAME.components[name].Component=function(){this.init=function(){delete this.init,executeDecoratorsOnNewComponent(this),this.init.apply(this,arguments)},orig.apply(this,arguments)},AFRAME.components[name].Component.prototype=orig.prototype}Object.keys(AFRAME.components).forEach(function(c){wrapComponent(c)}),function wrapRegister(){const origRegister=AFRAME.registerComponent;AFRAME.registerComponent=function(name){return origRegister.apply(AFRAME,arguments),wrapComponent(name)}}()})(),module.exports.decorate=function decorate(func,decoratorFunc){return decorations.add(func,decoratorFunc)}},function(module,exports,__webpack_require__){if('undefined'==typeof AFRAME)throw new Error('aframe-event-decorators was loaded before AFRAME was available');const eventBinder=__webpack_require__(40),decorate=__webpack_require__(14).decorate;module.exports.bindEvent=eventBinder.bindEvent,module.exports.bindEventPlayPause=eventBinder.bindEventPlayPause,module.exports.decorate=decorate},function(module,exports,__webpack_require__){module.exports=function buildSearchMethod(queryParam,url){return function search(query,args,callback){if('function'==typeof query&&'object'==typeof args||'object'==typeof callback)throw new errors.AlgoliaSearchError('index.search usage is index.search(query, params, cb)');0===arguments.length||'function'==typeof query?(callback=query,query=''):(1===arguments.length||'function'==typeof args)&&(callback=args,args=void 0),'object'==typeof query&&null!==query?(args=query,query=void 0):(void 0===query||null===query)&&(query='');var params='';void 0!==query&&(params+=queryParam+'='+encodeURIComponent(query));var additionalUA;return void 0!==args&&(args.additionalUA&&(additionalUA=args.additionalUA,delete args.additionalUA),params=this.as._getSearchParams(args,params)),this._search(params,url,callback,additionalUA)}};var errors=__webpack_require__(4)},function(module,exports,__webpack_require__){module.exports=function omit(obj,test){var keys=__webpack_require__(142),foreach=__webpack_require__(3),filtered={};return foreach(keys(obj),function doFilter(keyName){!0!==test(keyName)&&(filtered[keyName]=obj[keyName])}),filtered}},function(module){module.exports='function'==typeof Object.create?function inherits(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},function(module,__webpack_exports__,__webpack_require__){'use strict';function __values(o){var m='function'==typeof Symbol&&o[Symbol.iterator],i=0;return m?m.call(o):{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}}}function __read(o,n){var m='function'==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),ar=[],r,e;try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i['return'])&&m.call(i)}finally{if(e)throw e.error}}return ar}function __await(v){return this instanceof __await?(this.v=v,this):new __await(v)}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0}),__webpack_exports__.__extends=function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},__webpack_require__.d(__webpack_exports__,'__assign',function(){return __assign}),__webpack_exports__.__rest=function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&0>e.indexOf(p)&&(t[p]=s[p]);if(null!=s&&'function'==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)0>e.indexOf(p[i])&&(t[p[i]]=s[p[i]]);return t},__webpack_exports__.__decorate=function __decorate(decorators,target,key,desc){var c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;0<=i;i--)(d=decorators[i])&&(r=(3>c?d(r):3<c?d(target,key,r):d(target,key))||r);return 3<c&&r&&Object.defineProperty(target,key,r),r},__webpack_exports__.__param=function __param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}},__webpack_exports__.__metadata=function __metadata(metadataKey,metadataValue){if('object'==typeof Reflect&&'function'==typeof Reflect.metadata)return Reflect.metadata(metadataKey,metadataValue)},__webpack_exports__.__awaiter=function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator['throw'](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__webpack_exports__.__generator=function __generator(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError('Generator is already executing.');for(;_;)try{if(f=1,y&&(t=y[2&op[0]?'return':op[0]?'throw':'next'])&&!(t=t.call(y,op[1])).done)return t;switch((y=0,t)&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if((t=_.trys,!(t=0<t.length&&t[t.length-1]))&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue;}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var _={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},'function'==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},__webpack_exports__.__exportStar=function __exportStar(m,exports){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])},__webpack_exports__.__values=__values,__webpack_exports__.__read=__read,__webpack_exports__.__spread=function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar},__webpack_exports__.__await=__await,__webpack_exports__.__asyncGenerator=function __asyncGenerator(thisArg,_arguments,generator){function verb(n){g[n]&&(i[n]=function(v){return new Promise(function(a,b){1<q.push([n,v,a,b])||resume(n,v)})})}function resume(n,v){try{step(g[n](v))}catch(e){settle(q[0][3],e)}}function step(r){r.value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}function fulfill(value){resume('next',value)}function reject(value){resume('throw',value)}function settle(f,v){(f(v),q.shift(),q.length)&&resume(q[0][0],q[0][1])}if(!Symbol.asyncIterator)throw new TypeError('Symbol.asyncIterator is not defined.');var g=generator.apply(thisArg,_arguments||[]),q=[],i;return i={},verb('next'),verb('throw'),verb('return'),i[Symbol.asyncIterator]=function(){return this},i},__webpack_exports__.__asyncDelegator=function __asyncDelegator(o){function verb(n,f){o[n]&&(i[n]=function(v){return(p=!p)?{value:__await(o[n](v)),done:'return'===n}:f?f(v):v})}var i,p;return i={},verb('next'),verb('throw',function(e){throw e}),verb('return'),i[Symbol.iterator]=function(){return this},i},__webpack_exports__.__asyncValues=function __asyncValues(o){if(!Symbol.asyncIterator)throw new TypeError('Symbol.asyncIterator is not defined.');var m=o[Symbol.asyncIterator];return m?m.call(o):'function'==typeof __values?__values(o):o[Symbol.iterator]()},__webpack_exports__.__makeTemplateObject=function __makeTemplateObject(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,'raw',{value:raw}):cooked.raw=raw,cooked},__webpack_exports__.__importStar=function __importStar(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result},__webpack_exports__.__importDefault=function __importDefault(mod){return mod&&mod.__esModule?mod:{default:mod}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},__assign=Object.assign||function __assign(t){for(var i=1,n=arguments.length,s;i<n;i++)for(var p in s=arguments[i],s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}},function(){function copyArray(dest,source){var i;for(dest.length=0,i=0;i<source.length;i++)dest[i]=source[i]}if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var OBSERVER_CONFIG={childList:!0,attributes:!0,subtree:!0};AFRAME.registerComponent('aabb-collider',{schema:{collideNonVisible:{default:!1},debug:{default:!1},enabled:{default:!0},interval:{default:80},objects:{default:''}},init:function(){this.centerDifferenceVec3=new THREE.Vector3,this.clearedIntersectedEls=[],this.closestIntersectedEl=null,this.boundingBox=new THREE.Box3,this.boxCenter=new THREE.Vector3,this.boxHelper=new THREE.BoxHelper,this.boxMax=new THREE.Vector3,this.boxMin=new THREE.Vector3,this.hitClosestClearEventDetail={},this.hitClosestEventDetail={},this.intersectedEls=[],this.objectEls=[],this.newIntersectedEls=[],this.prevCheckTime=void 0,this.previousIntersectedEls=[],this.setDirty=this.setDirty.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.hitStartEventDetail={intersectedEls:this.newIntersectedEls}},play:function(){this.observer.observe(this.el.sceneEl,OBSERVER_CONFIG),this.el.sceneEl.addEventListener('object3dset',this.setDirty),this.el.sceneEl.addEventListener('object3dremove',this.setDirty)},remove:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener('object3dset',this.setDirty),this.el.sceneEl.removeEventListener('object3dremove',this.setDirty)},tick:function(time){var boundingBox=this.boundingBox,centerDifferenceVec3=this.centerDifferenceVec3,clearedIntersectedEls=this.clearedIntersectedEls,intersectedEls=this.intersectedEls,el=this.el,newIntersectedEls=this.newIntersectedEls,objectEls=this.objectEls,prevCheckTime=this.prevCheckTime,previousIntersectedEls=this.previousIntersectedEls,self=this,boxHelper,closestCenterDifference,newClosestEl,i;if(this.data.enabled&&!(prevCheckTime&&time-prevCheckTime<this.data.interval)){for(this.prevCheckTime=time,this.dirty&&this.refreshObjects(),boundingBox.setFromObject(el.object3D),this.boxMin.copy(boundingBox.min),this.boxMax.copy(boundingBox.max),boundingBox.getCenter(this.boxCenter),this.data.debug&&(this.boxHelper.setFromObject(el.object3D),!this.boxHelper.parent&&el.sceneEl.object3D.add(this.boxHelper)),copyArray(previousIntersectedEls,intersectedEls),intersectedEls.length=0,i=0;i<objectEls.length;i++)if(objectEls[i]!==this.el){if(!this.data.collideNonVisible&&!objectEls[i].getAttribute('visible')){this.data.debug&&(boxHelper=objectEls[i].object3D.boxHelper,boxHelper&&(el.sceneEl.object3D.remove(boxHelper),objectEls[i].object3D.boxHelper=null));continue}this.isIntersecting(objectEls[i])&&intersectedEls.push(objectEls[i])}for(newIntersectedEls.length=0,i=0;i<intersectedEls.length;i++)-1===previousIntersectedEls.indexOf(intersectedEls[i])&&newIntersectedEls.push(intersectedEls[i]);for(clearedIntersectedEls.length=0,i=0;i<previousIntersectedEls.length;i++)-1===intersectedEls.indexOf(previousIntersectedEls[i])&&(previousIntersectedEls[i].hasAttribute('aabb-collider')||previousIntersectedEls[i].emit('hitend'),clearedIntersectedEls.push(previousIntersectedEls[i]));for(i=0;i<newIntersectedEls.length;i++)newIntersectedEls[i]!==this.el&&(newIntersectedEls[i].hasAttribute('aabb-collider')||newIntersectedEls[i].emit('hitstart'));for(i=0;i<intersectedEls.length;i++)intersectedEls[i]!==this.el&&(centerDifferenceVec3.copy(intersectedEls[i].object3D.boundingBoxCenter).sub(this.boxCenter),(void 0==closestCenterDifference||centerDifferenceVec3.length()<closestCenterDifference)&&(closestCenterDifference=centerDifferenceVec3.length(),newClosestEl=intersectedEls[i]));!intersectedEls.length&&this.closestIntersectedEl?(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit('hitclosestclear'),this.closestIntersectedEl=null,el.emit('hitclosestclear',this.hitClosestClearEventDetail)):newClosestEl!==this.closestIntersectedEl&&(this.closestIntersectedEl&&(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit('hitclosestclear',this.hitClosestClearEventDetail)),newClosestEl&&(newClosestEl.emit('hitclosest'),this.closestIntersectedEl=newClosestEl,this.hitClosestEventDetail.el=newClosestEl,el.emit('hitclosest',this.hitClosestEventDetail))),clearedIntersectedEls.length&&el.emit('hitend'),newIntersectedEls.length&&el.emit('hitstart',this.hitStartEventDetail)}},isIntersecting:function(){var boundingBox=new THREE.Box3;return function(el){var boxMin,boxMax;return boundingBox.setFromObject(el.object3D),this.data.debug&&(!el.object3D.boxHelper&&(el.object3D.boxHelper=new THREE.BoxHelper(el.object3D,new THREE.Color(Math.random(),Math.random(),Math.random())),el.sceneEl.object3D.add(el.object3D.boxHelper)),el.object3D.boxHelper.setFromObject(el.object3D)),boxMin=boundingBox.min,boxMax=boundingBox.max,el.object3D.boundingBoxCenter=el.object3D.boundingBoxCenter||new THREE.Vector3,boundingBox.getCenter(el.object3D.boundingBoxCenter),this.boxMin.x<=boxMax.x&&this.boxMax.x>=boxMin.x&&this.boxMin.y<=boxMax.y&&this.boxMax.y>=boxMin.y&&this.boxMin.z<=boxMax.z&&this.boxMax.z>=boxMin.z}}(),setDirty:function(){this.dirty=!0},refreshObjects:function(){var data=this.data;this.objectEls=data.objects?this.el.sceneEl.querySelectorAll(data.objects):this.el.sceneEl.children,this.dirty=!1}})},function(){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var audioBufferCache={};AFRAME.registerComponent('audioanalyser',{schema:{buffer:{default:!1},beatDetectionDecay:{default:0.99},beatDetectionMinVolume:{default:15},beatDetectionThrottle:{default:250},enabled:{default:!0},enableBeatDetection:{default:!0},enableLevels:{default:!0},enableWaveform:{default:!0},enableVolume:{default:!0},fftSize:{default:2048},smoothingTimeConstant:{default:0.8},src:{parse:function(val){return val.constructor===String?val.startsWith('#')||val.startsWith('.')?document.querySelector(val):val:val}},unique:{default:!1}},init:function(){var data=this.data,analyser,gainNode;this.audioEl=null,this.context=new AudioContext,this.levels=null,this.waveform=null,this.volume=0,this.xhr=null,analyser=this.analyser=this.context.createAnalyser(),gainNode=this.gainNode=this.context.createGain(),gainNode.connect(analyser),analyser.connect(this.context.destination),analyser.fftSize=data.fftSize,analyser.smoothingTimeConstant=data.smoothingTimeConstant,this.levels=new Uint8Array(analyser.frequencyBinCount),this.waveform=new Uint8Array(analyser.fftSize)},update:function(oldData){var analyser=this.analyser,data=this.data;(oldData.fftSize!==data.fftSize||oldData.smoothingTimeConstant!==data.smoothingTimeConstant)&&(analyser.fftSize=data.fftSize,analyser.smoothingTimeConstant=data.smoothingTimeConstant,this.levels=new Uint8Array(analyser.frequencyBinCount),this.waveform=new Uint8Array(analyser.fftSize));data.src&&this.refreshSource()},tick:function(t,dt){var data=this.data,volume;if(data.enabled){if((data.enableLevels||data.enableVolume)&&this.analyser.getByteFrequencyData(this.levels),data.enableWaveform&&this.analyser.getByteTimeDomainData(this.waveform),data.enableVolume||data.enableBeatDetection){for(var sum=0,i=0;i<this.levels.length;i++)sum+=this.levels[i];this.volume=sum/this.levels.length}data.enableBeatDetection&&(volume=this.volume,!this.beatCutOff&&(this.beatCutOff=volume),volume>this.beatCutOff&&volume>this.data.beatDetectionMinVolume?(this.el.emit('audioanalyserbeat',null,!1),this.beatCutOff=1.5*volume,this.beatTime=0):this.beatTime<=this.data.beatDetectionThrottle?this.beatTime+=dt:(this.beatCutOff*=this.data.beatDetectionDecay,this.beatCutOff=Math.max(this.beatCutOff,this.data.beatDetectionMinVolume)))}},refreshSource:function(){var analyser=this.analyser,data=this.data;data.buffer&&data.src.constructor===String?this.getBufferSource().then(source=>{this.source=source,this.source.connect(this.gainNode)}):(this.source=this.getMediaSource(),this.source.connect(this.gainNode))},suspendContext:function(){this.context.suspend()},resumeContext:function(){this.context.resume()},fetchAudioBuffer:function(src){return audioBufferCache[src]?audioBufferCache[src].constructor===Promise?audioBufferCache[src]:Promise.resolve(audioBufferCache[src]):(audioBufferCache[src]=new Promise(resolve=>{const xhr=this.xhr=new XMLHttpRequest;xhr.open('GET',src),xhr.responseType='arraybuffer',xhr.addEventListener('load',()=>{this.context.decodeAudioData(xhr.response).then(audioBuffer=>{audioBufferCache[src]=audioBuffer,resolve(audioBuffer)}).catch(console.error)}),xhr.send()}),audioBufferCache[src])},getBufferSource:function(){var data=this.data;return this.fetchAudioBuffer(data.src).then(()=>{var source;return source=this.context.createBufferSource(),source.buffer=audioBufferCache[data.src],this.el.emit('audioanalyserbuffersource',source,!1),source}).catch(console.error)},getMediaSource:function(){return this.data.src.constructor===String?(!this.audio&&(this.audio=document.createElement('audio'),this.audio.crossOrigin='anonymous'),this.audio.setAttribute('src',this.data.src)):this.audio=this.data.src,this.context.createMediaElementSource(this.audio)}})},function(){var styleParser=AFRAME.utils.styleParser;if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('event-set',{schema:{default:'',parse:function(value){return styleParser.parse(value)}},multiple:!0,init:function(){this.eventHandler=null,this.eventName=null},update:function(){this.removeEventListener(),this.updateEventListener(),this.addEventListener()},remove:function(){this.removeEventListener()},pause:function(){this.removeEventListener()},play:function(){this.addEventListener()},updateEventListener:function(){var data=this.data,el=this.el,event,target,targetEl;event=data._event||this.id,target=data._target,targetEl=target?el.sceneEl.querySelector(target):el,this.eventName=event,this.eventHandler=function handler(){for(var propName in data)'_event'!==propName&&'_target'!==propName&&AFRAME.utils.entity.setComponentProperty.call(this,targetEl,propName,data[propName])}},addEventListener:function(){this.el.addEventListener(this.eventName,this.eventHandler)},removeEventListener:function(){this.el.removeEventListener(this.eventName,this.eventHandler)}})},function(module,exports,__webpack_require__){THREE.BufferGeometryUtils||__webpack_require__(41),AFRAME.registerComponent('geometry-merger',{schema:{preserveOriginal:{default:!1}},init:function(){var self=this;this.geometry=new THREE.Geometry,this.mesh=new THREE.Mesh(this.geometry),this.el.setObject3D('mesh',this.mesh),this.faceIndex={},this.vertexIndex={},this.el.object3D.traverse(function(mesh){'Mesh'!==mesh.type||mesh===self.mesh||(self.faceIndex[mesh.parent.uuid]=[self.geometry.faces.length,self.geometry.faces.length+mesh.geometry.faces.length-1],self.vertexIndex[mesh.parent.uuid]=[self.geometry.vertices.length,self.geometry.vertices.length+mesh.geometry.vertices.length-1],mesh.parent.updateMatrix(),self.geometry.merge(mesh.geometry,mesh.parent.matrix),!self.data.preserveOriginal&&mesh.parent.remove(mesh))})}}),AFRAME.registerComponent('buffer-geometry-merger',{schema:{preserveOriginal:{default:!1}},init:function(){var geometries=[];this.el.sceneEl.object3D.updateMatrixWorld(),this.el.object3D.traverse(function(mesh){'Mesh'!==mesh.type||mesh.el===self.el||(mesh.geometry.applyMatrix(mesh.matrixWorld),geometries.push(mesh.geometry.clone()),mesh.parent.remove(mesh))});const geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);this.mesh=new THREE.Mesh(geometry),this.el.setObject3D('mesh',this.mesh)}})},function(){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('haptics',{dependencies:['tracked-controls'],schema:{actuatorIndex:{default:0},dur:{default:100},enabled:{default:!0},events:{type:'array'},eventsFrom:{type:'string'},force:{default:1}},multiple:!0,init:function(){var data=this.data,self=this;if(this.callPulse=function(){self.pulse()},this.el.components['tracked-controls'].controller){if(this.gamepad=this.el.components['tracked-controls'].controller,!this.gamepad||!this.gamepad.hapticActuators.length)return;this.addEventListeners()}else this.el.addEventListener('controllerconnected',function init(){setTimeout(function(){self.gamepad=self.el.components['tracked-controls'].controller,self.gamepad&&self.gamepad.hapticActuators.length&&self.addEventListeners()},150)})},remove:function(){this.removeEventListeners()},pulse:function(force,dur){var data=this.data,actuator;data.enabled&&this.gamepad&&this.gamepad.hapticActuators&&(actuator=this.gamepad.hapticActuators[data.actuatorIndex],actuator.pulse(force||data.force,dur||data.dur))},addEventListeners:function(){var data=this.data,i,listenTarget;for(listenTarget=data.eventsFrom?document.querySelector(data.eventsFrom):this.el,i=0;i<data.events.length;i++)listenTarget.addEventListener(data.events[i],this.callPulse)},removeEventListeners:function(){var data=this.data,i,listenTarget;for(listenTarget=data.eventsFrom?document.querySelector(data.eventsFrom):this.el,i=0;i<data.events.length;i++)listenTarget.removeEventListener(data.events[i],this.callPulse)}})},function(module){function getBoxPositions(data,numChildren,marginDefined){var rows=Math.ceil(numChildren/data.columns),column,marginColumn,marginRow,offsetColumn,offsetRow,row;for(marginColumn=data.marginColumn,marginRow=data.marginRow,marginDefined&&(marginColumn=data.margin,marginRow=data.margin),offsetRow=getOffsetItemIndex(data.align,rows),offsetColumn=getOffsetItemIndex(data.align,data.columns),row=0;row<rows;row++)for(column=0;column<data.columns;column++)positionHelper.set(0,0,0),0===data.plane.indexOf('x')&&(positionHelper.x=(column-offsetColumn)*marginColumn),0===data.plane.indexOf('y')&&(positionHelper.y=(column-offsetColumn)*marginColumn),1===data.plane.indexOf('y')&&(positionHelper.y=(row-offsetRow)*marginRow),1===data.plane.indexOf('z')&&(positionHelper.z=(row-offsetRow)*marginRow),pushPositionVec3(positionHelper);return positions}function getCirclePositions(data,numChildren){var i,rad;for(i=0;i<numChildren;i++)rad,rad=isNaN(data.angle)?i*(2*Math.PI)/numChildren:0.01745329252*(i*data.angle),positionHelper.set(0,0,0),0===data.plane.indexOf('x')&&(positionHelper.x=data.radius*_Mathcos(rad)),0===data.plane.indexOf('y')&&(positionHelper.y=data.radius*_Mathcos(rad)),1===data.plane.indexOf('y')&&(positionHelper.y=data.radius*_Mathsin(rad)),1===data.plane.indexOf('z')&&(positionHelper.z=data.radius*_Mathsin(rad)),pushPositionVec3(positionHelper);return positions}function getLinePositions(data,numChildren){return data.columns=numChildren,getBoxPositions(data,numChildren,!0)}function getCubePositions(data){return pushPositions(1,0,0,0,1,0,0,0,1,-1,0,0,0,-1,0,0,0,-1),scalePositions(data.radius/2),positions}function getDodecahedronPositions(data){var PHI=(1+2.23606797749979)/2,B=1/PHI,C=2-PHI,NB=-1*B,NC=-1*C;return pushPositions(-1,C,0,-1,NC,0,0,-1,C,0,-1,NC,0,1,C,0,1,NC,1,C,0,1,NC,0,B,B,B,B,B,NB,B,NB,B,B,NB,NB,C,0,1,C,0,-1,NB,B,B,NB,B,NB,NB,NB,B,NB,NB,NB,NC,0,1,NC,0,-1),scalePositions(data.radius/2),positions}function getPyramidPositions(data){var NEG_SQRT_1_3=-1/1.7320508075688772;return pushPositions(0,0,1.7320508075688772+NEG_SQRT_1_3,-1,0,NEG_SQRT_1_3,1,0,NEG_SQRT_1_3,0,2*0.816496580927726,0),scalePositions(data.radius/2),positions}function getOffsetItemIndex(align,numItems){return'start'===align?numItems-1:'center'===align?(numItems-1)/2:'end'===align?0:void 0}function scalePositions(scale){var i;for(i=0;i<positions.length;i++)positions[i]*=scale}function setPositions(els,positions,orderAttribute){var value,i,orderIndex;if(orderAttribute){for(i=0;i<els.length;i++)(value=els[i].getAttribute(orderAttribute),null!==value&&void 0!==value)&&(orderIndex=3*parseInt(value,10),els[i].object3D.position.set(positions[orderIndex],positions[orderIndex+1],positions[orderIndex+2]));return}for(i=0;i<positions.length;i+=3){if(!els[i/3])return;els[i/3].object3D.position.set(positions[i],positions[i+1],positions[i+2])}}function pushPositions(){var i;for(i=0;i<arguments.length;i++)positions.push(i)}function pushPositionVec3(vec3){positions.push(vec3.x),positions.push(vec3.y),positions.push(vec3.z)}var _Mathsin=Math.sin,_Mathcos=Math.cos,positions=[],positionHelper=new THREE.Vector3;AFRAME.registerComponent('layout',{schema:{angle:{type:'number',default:!1,min:0,max:360,if:{type:['circle']}},columns:{default:1,min:0,if:{type:['box']}},margin:{default:1,min:0,if:{type:['box','line']}},marginColumn:{default:1,min:0,if:{type:['box']}},marginRow:{default:1,min:0,if:{type:['box']}},orderAttribute:{default:''},plane:{default:'xy'},radius:{default:1,min:0,if:{type:['circle','cube','dodecahedron','pyramid']}},reverse:{default:!1},type:{default:'line',oneOf:['box','circle','cube','dodecahedron','line','pyramid']},fill:{default:!0,if:{type:['circle']}},align:{default:'end',oneOf:['start','center','end']}},init:function(){var self=this,el=this.el;this.children=el.getChildEntities(),this.initialPositions=[],this.children.forEach(function getInitialPositions(childEl){function _getPositions(){self.initialPositions.push(childEl.object3D.position.x),self.initialPositions.push(childEl.object3D.position.y),self.initialPositions.push(childEl.object3D.position.z)}return childEl.hasLoaded?_getPositions():void childEl.addEventListener('loaded',_getPositions)}),this.handleChildAttached=this.handleChildAttached.bind(this),this.handleChildDetached=this.handleChildDetached.bind(this),el.addEventListener('child-attached',this.handleChildAttached),el.addEventListener('child-detached',this.handleChildDetached),el.addEventListener('layoutrefresh',this.update.bind(this))},update:function(){var children=this.children,data=this.data,el=this.el,definedData,numChildren,positionFn;switch(numChildren=children.length,data.type){case'box':{positionFn=getBoxPositions;break}case'circle':{positionFn=getCirclePositions;break}case'cube':{positionFn=getCubePositions;break}case'dodecahedron':{positionFn=getDodecahedronPositions;break}case'pyramid':{positionFn=getPyramidPositions;break}default:positionFn=getLinePositions;}definedData=el.getDOMAttribute('layout'),positions.length=0,positions=positionFn(data,numChildren,'string'==typeof definedData?-1!==definedData.indexOf('margin'):'margin'in definedData),data.reverse&&positions.reverse(),setPositions(children,positions,data.orderAttribute)},remove:function(){this.el.removeEventListener('child-attached',this.handleChildAttached),this.el.removeEventListener('child-detached',this.handleChildDetached),setPositions(this.children,this.initialPositions)},handleChildAttached:function(evt){var el=this.el;evt.detail.el.parentNode!==el||(this.children.push(evt.detail.el),this.update())},handleChildDetached:function(evt){-1===this.children.indexOf(evt.detail.el)||(this.children.splice(this.children.indexOf(evt.detail.el),1),this.initialPositions.splice(this.children.indexOf(evt.detail.el),1),this.update())}}),module.exports.getBoxPositions=getBoxPositions,module.exports.getCirclePositions=getCirclePositions,module.exports.getLinePositions=getLinePositions,module.exports.getCubePositions=getCubePositions,module.exports.getDodecahedronPositions=getDodecahedronPositions,module.exports.getPyramidPositions=getPyramidPositions},function(module,exports,__webpack_require__){__webpack_require__(42),AFRAME.registerComponent('orbit-controls',{dependencies:['camera'],schema:{autoRotate:{type:'boolean'},autoRotateSpeed:{default:2},dampingFactor:{default:0.1},enabled:{default:!0},enableDamping:{default:!0},enableKeys:{default:!0},enablePan:{default:!0},enableRotate:{default:!0},enableZoom:{default:!0},initialPosition:{type:'vec3'},keyPanSpeed:{default:7},minAzimuthAngle:{type:'number',default:Infinity},maxAzimuthAngle:{type:'number',default:Infinity},maxDistance:{default:1e3},maxPolarAngle:{default:AFRAME.utils.device.isMobile()?90:120},minDistance:{default:1},minPolarAngle:{default:0},minZoom:{default:0},panSpeed:{default:1},rotateSpeed:{default:0.05},screenSpacePanning:{default:!1},target:{type:'vec3'},zoomSpeed:{default:0.5}},init:function(){var el=this.el,oldPosition;this.controls=new THREE.OrbitControls(el.getObject3D('camera'),el.sceneEl.renderer.domElement),oldPosition=new THREE.Vector3,el.sceneEl.addEventListener('enter-vr',()=>{(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!1,el.hasAttribute('look-controls')&&(el.setAttribute('look-controls','enabled',!0),oldPosition.copy(el.getObject3D('camera').position),el.getObject3D('camera').position.set(0,0,0)))}),el.sceneEl.addEventListener('exit-vr',()=>{(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!0,el.getObject3D('camera').position.copy(oldPosition),el.hasAttribute('look-controls')&&el.setAttribute('look-controls','enabled',!1))}),document.body.style.cursor='grab',document.addEventListener('mousedown',()=>{document.body.style.cursor='grabbing'}),document.addEventListener('mouseup',()=>{document.body.style.cursor='grab'}),this.target=new THREE.Vector3,el.getObject3D('camera').position.copy(this.data.initialPosition)},update:function(){var controls=this.controls,data=this.data;controls.target=this.target.copy(data.target),controls.autoRotate=data.autoRotate,controls.autoRotateSpeed=data.autoRotateSpeed,controls.dampingFactor=data.dampingFactor,controls.enabled=data.enabled,controls.enableDamping=data.enableDamping,controls.enableKeys=data.enableKeys,controls.enablePan=data.enablePan,controls.enableRotate=data.enableRotate,controls.enableZoom=data.enableZoom,controls.keyPanSpeed=data.keyPanSpeed,controls.maxPolarAngle=THREE.Math.degToRad(data.maxPolarAngle),controls.maxDistance=data.maxDistance,controls.minDistance=data.minDistance,controls.minPolarAngle=THREE.Math.degToRad(data.minPolarAngle),controls.minZoom=data.minZoom,controls.panSpeed=data.panSpeed,controls.rotateSpeed=data.rotateSpeed,controls.screenSpacePanning=data.screenSpacePanning,controls.zoomSpeed=data.zoomSpeed},tick:function(){var controls=this.controls,data=this.data;!data.enabled||controls.enabled&&(controls.enableDamping||controls.autoRotate)&&this.controls.update()}})},function(){AFRAME.registerComponent('proxy-event',{schema:{captureBubbles:{default:!1},enabled:{default:!0},event:{type:'string'},from:{type:'string'},to:{type:'string'},as:{type:'string'},bubbles:{default:!1}},multiple:!0,init:function(){var data=this.data,el=this.el,self=this,from,i,to;if(data.from?'PARENT'===data.from?from=[el.parentNode]:from=document.querySelectorAll(data.from):'CHILDREN'===data.to?to=el.querySelectorAll('*'):'SELF'===data.to?to=[el]:to=document.querySelectorAll(data.to),data.from)for(i=0;i<from.length;i++)this.addEventListenerFrom(from[i]);else el.addEventListener(data.event,function(evt){var data=self.data;if(data.enabled&&(data.captureBubbles||evt.target===el))for(i=0;i<to.length;i++)to[i].emit(data.as||data.event,evt.detail?evt.detail:null,data.bubbles)})},addEventListenerFrom:function(fromEl){var data=this.data,self=this;fromEl.addEventListener(data.event,function(evt){var data=self.data;data.enabled&&(data.captureBubbles||evt.target===fromEl)&&self.el.emit(data.as||data.event,evt.detail?evt.detail:null,!1)})}})},function(module){(function webpackUniversalModuleDefinition(root,factory){module.exports=factory()})('undefined'==typeof self?this:self,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};return __webpack_require__.d(getter,'a',getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p='',__webpack_require__(__webpack_require__.s=0)}([function(module,exports,__webpack_require__){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerShader('ring',{schema:{blur:{default:0.01,is:'uniform'},color:{type:'color',is:'uniform'},progress:{default:0,is:'uniform'},radiusInner:{default:0.85,is:'uniform'},radiusOuter:{default:1,is:'uniform'}},vertexShader:__webpack_require__(1),fragmentShader:__webpack_require__(2)})},function(module){module.exports='varying vec2 vUv;\n\nvoid main () {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n'},function(module){module.exports='#define PI 3.14159265358979\nuniform float blur;\nuniform float progress;\nuniform float radiusInner;\nuniform float radiusOuter;\nuniform vec3 color;\n\nvarying vec2 vUv;\n\nvoid main () {\n  vec2 uv = vec2(vUv.x * 2. - 1., vUv.y * 2. - 1.);\n  float r = uv.x * uv.x + uv.y * uv.y;\n  float col = (1.0 - smoothstep(radiusOuter, radiusOuter + blur, r)) * smoothstep(radiusInner, radiusInner + blur, r);\n  float a = smoothstep(-PI, PI, atan(uv.y, uv.x));\n  float p = 1.0 - progress - blur;\n  col *= smoothstep(p, p + blur, a);\n  gl_FragColor = vec4(color * col, col);\n}\n'}])})},function(){function parseSide(side){return'back'===side?THREE.BackSide:'double'===side?THREE.DoubleSide:THREE.FrontSide}if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('slice9',{schema:{width:{default:1,min:0},height:{default:1,min:0},left:{default:0,min:0},right:{default:0,min:0},bottom:{default:0,min:0},top:{default:0,min:0},side:{default:'front',oneOf:['front','back','double']},padding:{default:0.1,min:0.01},color:{type:'color',default:'#fff'},opacity:{default:1,min:0,max:1},transparent:{default:!0},debug:{default:!1},src:{type:'map'}},multiple:!1,init:function(){var data=this.data,material=this.material=new THREE.MeshBasicMaterial({color:data.color,opacity:data.opacity,transparent:data.transparent,wireframe:data.debug}),geometry=this.geometry=new THREE.PlaneBufferGeometry(data.width,data.height,3,3),textureLoader=new THREE.TextureLoader;this.plane=new THREE.Mesh(geometry,material),this.el.setObject3D('mesh',this.plane),this.textureSrc=null},updateMap:function(){function setMap(texture){this.material.map=texture,this.material.needsUpdate=!0,this.regenerateMesh()}var src=this.data.src;return src?src===this.textureSrc?void 0:(this.textureSrc=src,void this.el.sceneEl.systems.material.loadTexture(src,{src:src},setMap.bind(this))):void(!this.material.map||setMap(null))},regenerateMesh:function(){function setPos(id,x,y){pos[3*id]=x,pos[3*id+1]=y}function setUV(id,u,v){uvs[2*id]=u,uvs[2*id+1]=v}var data=this.data,pos=this.geometry.attributes.position.array,uvs=this.geometry.attributes.uv.array,image=this.material.map.image;if(image){var uv={left:data.left/image.width,right:data.right/image.width,top:data.top/image.height,bottom:data.bottom/image.height};setUV(1,uv.left,1),setUV(2,uv.right,1),setUV(4,0,uv.bottom),setUV(5,uv.left,uv.bottom),setUV(6,uv.right,uv.bottom),setUV(7,1,uv.bottom),setUV(8,0,uv.top),setUV(9,uv.left,uv.top),setUV(10,uv.right,uv.top),setUV(11,1,uv.top),setUV(13,uv.left,0),setUV(14,uv.right,0);var w2=data.width/2,h2=data.height/2,left=-w2+data.padding,right=w2-data.padding,top=h2-data.padding,bottom=-h2+data.padding;setPos(0,-w2,h2),setPos(1,left,h2),setPos(2,right,h2),setPos(3,w2,h2),setPos(4,-w2,top),setPos(5,left,top),setPos(6,right,top),setPos(7,w2,top),setPos(8,-w2,bottom),setPos(9,left,bottom),setPos(10,right,bottom),setPos(11,w2,bottom),setPos(13,left,-h2),setPos(14,right,-h2),setPos(12,-w2,-h2),setPos(15,w2,-h2),this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0}},update:function(oldData){var data=this.data;this.material.color.setStyle(data.color),this.material.opacity=data.opacity,this.material.transparent=data.transparent,this.material.wireframe=data.debug,this.material.side=parseSide(data.side);var diff=AFRAME.utils.diff(data,oldData);'src'in diff?this.updateMap():('width'in diff||'height'in diff||'padding'in diff||'left'in diff||'top'in diff||'bottom'in diff||'right'in diff)&&this.regenerateMesh()},remove:function(){},pause:function(){},play:function(){}})},function(module){(function webpackUniversalModuleDefinition(root,factory){module.exports=factory()})('undefined'==typeof self?this:self,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};return __webpack_require__.d(getter,'a',getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p='',__webpack_require__(__webpack_require__.s=1)}([function(module){'use strict';function generateExpression(str){return str=str.replace(DOT_NOTATION_RE,'["$1"]'),str=str.replace(ROOT_STATE_SELECTOR_RE,'$1state["$2"]'),str=str.replace(STATE_SELECTOR_RE,'$1$2$3state["$4"]'),str=str.replace(ITEM_RE,'item'),str}function composeFunctions(){var functions=arguments;return function(){var i;for(i=0;i<functions.length;i++)functions[i].apply(this,arguments)}}function parseKeyToWatch(str){var dotIndex;return str=stripNot(str.trim()),dotIndex=str.indexOf('.'),-1===dotIndex?str:str.substring(0,str.indexOf('.'))}function stripNot(str){if(0===str.indexOf('!!'))return str.replace('!!','');return 0===str.indexOf('!')?str.replace('!',''):str}function split(str,delimiter){return(SPLIT_CACHE[delimiter]||(SPLIT_CACHE[delimiter]={}),SPLIT_CACHE[delimiter][str])?SPLIT_CACHE[delimiter][str]:(SPLIT_CACHE[delimiter][str]=str.split(delimiter),SPLIT_CACHE[delimiter][str])}var selectFunctions={};module.exports.select=function select(state,selector,item){return selectFunctions[selector]||(selectFunctions[selector]=new Function('state','item','return '+generateExpression(selector)+';')),selectFunctions[selector](state,item)};var DOT_NOTATION_RE=/\.([A-Za-z][\w_-]*)/g,WHITESPACE_RE=/\s/g,STATE_SELECTOR_RE=/([=&|!?:+-])(\s*)([\(]?)([A-Za-z][\w_-]*)/g,ROOT_STATE_SELECTOR_RE=/^([\(]?)([A-Za-z][\w_-]*)/g,ITEM_RE=/state\["item"\]/g;module.exports.generateExpression=generateExpression,module.exports.clearObject=function clearObject(obj){for(var key in obj)delete obj[key]},module.exports.composeHandlers=function composeHandlers(){var inputHandlers=arguments,actionName,i,outputHandlers;for(outputHandlers={},i=0;i<inputHandlers.length;i++)for(actionName in inputHandlers[i])actionName in outputHandlers?outputHandlers[actionName].constructor===Array?outputHandlers[actionName].push(inputHandlers[i][actionName]):outputHandlers[actionName]=[outputHandlers[actionName],inputHandlers[i][actionName]]:outputHandlers[actionName]=inputHandlers[i][actionName];for(actionName in outputHandlers)outputHandlers[actionName].constructor===Array&&(outputHandlers[actionName]=composeFunctions.apply(this,outputHandlers[actionName]));return outputHandlers},module.exports.composeFunctions=composeFunctions;var NO_WATCH_TOKENS=['||','&&','!=','!==','==','===','>','<','<=','>='],WHITESPACE_PLUS_RE=/\s+/;module.exports.parseKeysToWatch=function parseKeysToWatch(keys,str,isBindItem){var i,tokens;for(tokens=split(str,WHITESPACE_PLUS_RE),i=0;i<tokens.length;i++)if(-1===NO_WATCH_TOKENS.indexOf(tokens[i])&&!tokens[i].startsWith('\'')&&-1===keys.indexOf(tokens[i])){if(isBindItem&&'item'===tokens[i])continue;keys.push(parseKeyToWatch(tokens[i]))}};var SPLIT_CACHE={};module.exports.split=split,module.exports.copyArray=function copyArray(dest,src){var i;for(dest.length=0,i=0;i<src.length;i++)dest[i]=src[i]}},function(module,exports,__webpack_require__){'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&'function'==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};__webpack_require__(2);var diff=__webpack_require__(3),lib=__webpack_require__(0),wrapArray=__webpack_require__(4).wrapArray,State={initialState:{},nonBindedStateKeys:[],handlers:{},computeState:function computeState(){}},TYPE_OBJECT='object',WHITESPACE_REGEX=/s+/;AFRAME.registerState=function(definition){AFRAME.utils.extend(State,definition)},AFRAME.registerSystem('state',{init:function init(){var _this=this,key;for(key in this.arrays=[],this.dirtyArrays=[],this.diff={},this.state=AFRAME.utils.clone(State.initialState),this.subscriptions=[],this.initEventHandlers(),this.state)this.state[key]&&this.state[key].constructor===Array&&(this.arrays.push(key),this.state[key].__dirty=!0,wrapArray(this.state[key]));this.lastState=AFRAME.utils.clone(this.state),this.eventDetail={lastState:this.lastState,state:this.state},this.el.addEventListener('loaded',function(){var i;for(State.computeState(_this.state,'@@INIT'),i=0;i<_this.subscriptions.length;i++)_this.subscriptions[i].onStateUpdate(_this.state)})},dispatch:function dispatch(actionName,payload){var i,key;for(key in State.handlers[actionName](this.state,payload),State.computeState(this.state,actionName,payload),this.diff)delete this.diff[key];for(diff(this.lastState,this.state,this.diff,State.nonBindedStateKeys),this.dirtyArrays.length=0,i=0;i<this.arrays.length;i++)this.state[this.arrays[i]].__dirty&&this.dirtyArrays.push(this.arrays[i]);for(i=0;i<this.subscriptions.length;i++){if('bind-for'===this.subscriptions[i].name){if(!this.state[this.subscriptions[i].keysToWatch[0]].__dirty)continue;}else if(!this.shouldUpdate(this.subscriptions[i].keysToWatch,this.diff,this.dirtyArrays))continue;this.subscriptions[i].onStateUpdate()}for(key in this.state)this.state[key]&&this.state[key].constructor===Array&&(this.state[key].__dirty=!1);this.copyState(this.lastState,this.state),this.eventDetail.action=actionName,this.eventDetail.payload=payload,this.el.emit('stateupdate',this.eventDetail)},copyState:function copyState(lastState,state,isRecursive){for(var key in state)if(isRecursive||-1===State.nonBindedStateKeys.indexOf(key)){if(state[key]&&state[key].constructor===Object){if(!(key in lastState)){lastState[key]=AFRAME.utils.clone(state[key]);continue}this.copyState(lastState[key],state[key],!0);continue}lastState[key]=state[key]}},subscribe:function subscribe(component){this.subscriptions.push(component)},unsubscribe:function unsubscribe(component){this.subscriptions.splice(this.subscriptions.indexOf(component),1)},shouldUpdate:function shouldUpdate(keysToWatch,diff,dirtyArrays){for(var i=0;i<keysToWatch.length;i++)if(keysToWatch[i]in diff||-1!==dirtyArrays.indexOf(keysToWatch[i]))return!0;return!1},initEventHandlers:function initEventHandlers(){function registerListener(actionName){var _this2=this;this.el.addEventListener(actionName,function(evt){_this2.dispatch(actionName,evt.detail)})}var registeredActions=[],self=this,actionName;for(actionName in registerListener=registerListener.bind(this),State.handlers)-1===registeredActions.indexOf(actionName)&&(registeredActions.push(actionName),registerListener(actionName))},renderTemplate:function(){var interpRegex=/{{\s*(\w*\.)?([\w.]+)\s*}}/g;return function(template,data,asString){var match,str;if(str=template,data)for(;match=interpRegex.exec(template);)str=str.replace(match[0],('undefined'==typeof data?'undefined':_typeof(data))===TYPE_OBJECT?lib.select(data,match[2])||'':data);return asString?str:document.createRange().createContextualFragment(str)}}(),select:lib.select}),AFRAME.registerComponent('bind',{schema:{default:{},parse:function parse(value){var data,i,properties,pair;if(value.constructor===Object)return value;if(-1===value.indexOf(':'))return value;for(data={},properties=lib.split(value,';'),i=0;i<properties.length;i++)pair=lib.split(properties[i].trim(),':'),data[pair[0]]=pair[1].trim();return data}},multiple:!0,init:function init(){var data=this.data,componentId;this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system=this.el.sceneEl.systems.state,this.id&&(componentId=lib.split(this.id,'__')[0]),this.isNamespacedBind=this.id&&componentId in AFRAME.components&&!AFRAME.components[componentId].isSingleProp||componentId in AFRAME.systems,this.lastData={},this.updateObj={},this.system.subscribe(this),this.onStateUpdate=this.onStateUpdate.bind(this)},update:function update(){var data=this.data,key;if(this.keysToWatch.length=0,'string'==typeof data)lib.parseKeysToWatch(this.keysToWatch,data);else for(key in data)lib.parseKeysToWatch(this.keysToWatch,data[key]);this.onStateUpdate()},onStateUpdate:function onStateUpdate(){var hasKeys=!1,el=this.el,propertyName,stateSelector,state,value;if(el.parentNode){if(this.isNamespacedBind&&lib.clearObject(this.updateObj),state=this.system.state,_typeof(this.data)!==TYPE_OBJECT){try{value=lib.select(state,this.data)}catch(e){throw new Error('[aframe-state-component] Key \''+this.data+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}return('undefined'==typeof value?'undefined':_typeof(value))!==TYPE_OBJECT&&_typeof(this.lastData)!==TYPE_OBJECT&&this.lastData===value?void 0:(AFRAME.utils.entity.setComponentProperty(el,this.id,value),void(this.lastData=value))}for(propertyName in this.data){stateSelector=this.data[propertyName].trim();try{value=lib.select(state,stateSelector)}catch(e){throw console.log(e),new Error('[aframe-state-component] Key \''+stateSelector+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}if(('undefined'==typeof value?'undefined':_typeof(value))===TYPE_OBJECT||_typeof(this.lastData[propertyName])===TYPE_OBJECT||this.lastData[propertyName]!==value){if(propertyName in AFRAME.components&&void 0===value)return void el.removeAttribute(propertyName);this.isNamespacedBind?this.updateObj[propertyName]=value:AFRAME.utils.entity.setComponentProperty(el,propertyName,value),this.lastData[propertyName]=value}}for(hasKeys in this.updateObj);this.isNamespacedBind&&hasKeys&&el.setAttribute(this.id,this.updateObj)}},remove:function remove(){this.system.unsubscribe(this)}}),AFRAME.registerComponent('bind-toggle',{schema:{type:'string'},multiple:!0,init:function init(){this.system=this.el.sceneEl.systems.state,this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system.subscribe(this),this.onStateUpdate()},update:function update(){this.keysToWatch.length=0,lib.parseKeysToWatch(this.keysToWatch,this.data)},onStateUpdate:function onStateUpdate(){var el=this.el,state,value;state=this.system.state;try{value=lib.select(state,this.data)}catch(e){throw new Error('[aframe-state-component] Key \''+this.data+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}value?el.setAttribute(this.id,''):el.removeAttribute(this.id)},remove:function remove(){this.system.unsubscribe(this)}}),module.exports={composeFunctions:lib.composeFunctions,composeHandlers:lib.composeHandlers,select:lib.select}},function(module,exports,__webpack_require__){'use strict';var lib=__webpack_require__(0),ITEM_RE=/item/,ITEM_PREFIX_RE=/item./,ITEM_SELECTOR_RE=/item.(\w+)/;AFRAME.registerComponent('bind-for',{schema:{delay:{default:0},for:{type:'string',default:'item'},in:{type:'string'},key:{type:'string'},pool:{default:0},template:{type:'string'},updateInPlace:{default:!1}},init:function init(){this.system=this.el.sceneEl.systems.state,this.onStateUpdate=this.onStateUpdate.bind(this),this.keysToWatch=[],this.renderedKeys=[],this.system.subscribe(this),this.template=this.el.children[0]&&'TEMPLATE'===this.el.children[0].tagName?this.el.children[0].innerHTML.trim():document.querySelector(this.data.template).innerHTML.trim();for(var i=0;i<this.data.pool;i++)this.el.appendChild(this.generateFromTemplate(null,i))},update:function update(){this.keysToWatch[0]=lib.split(this.data.in,'.')[0],this.onStateUpdate()},onStateUpdateNaive:function(){var activeKeys=[];return function(){var data=this.data,el=this.el,list;try{list=lib.select(this.system.state,data.in)}catch(e){throw new Error('[aframe-state-component] Key \''+data.in+'\' not found in state.'+(' #'+el.getAttribute('id')+'['+this.attrName+']'))}activeKeys.length=0;for(var i=0,item;i<list.length;i++)item=list[i],activeKeys.push(data.key?item[data.key].toString():item.toString());for(var toRemoveEls=this.getElsToRemove(activeKeys,this.renderedKeys),_i=0;_i<toRemoveEls.length;_i++)toRemoveEls[_i].parentNode.removeChild(toRemoveEls[_i]);list.length&&this.renderItems(list,activeKeys,0)}}(),renderItems:function renderItems(list,activeKeys,i){var _this=this,data=this.data,el=this.el,item=list[i],keyValue=data.key?item[data.key].toString():item.toString(),itemEl;if(-1===this.renderedKeys.indexOf(keyValue))itemEl=this.generateFromTemplate(item,i),el.appendChild(itemEl),this.renderedKeys.push(keyValue);else{if(list.length&&list[0].constructor===String){var _keyValue=data.key?item[data.key].toString():item.toString();itemEl=el.querySelector('[data-bind-for-value="'+_keyValue+'"]'),itemEl.setAttribute('data-bind-for-key',i)}else{var bindForKey=this.getBindForKey(item,i);itemEl=el.querySelector('[data-bind-for-key="'+bindForKey+'"]')}itemEl.emit('bindforupdate',item,!1)}list[i+1]&&(this.data.delay?setTimeout(function(){_this.renderItems(list,activeKeys,i+1)},this.data.delay):this.renderItems(list,activeKeys,i+1))},onStateUpdateInPlace:function(){var activeKeys=[];return function(){var data=this.data,el=this.el,list,keyValue;try{list=lib.select(this.system.state,data.in)}catch(e){throw console.log(e),new Error('[aframe-state-component] Key \''+data.in+'\' not found in state.'+(' #'+el.getAttribute('id')+'['+this.attrName+']'))}activeKeys.length=0;for(var i=0,item;i<list.length;i++)item=list[i],keyValue=data.key?item[data.key].toString():item.toString(),activeKeys.push(keyValue);for(var toRemoveEls=this.getElsToRemove(activeKeys,this.renderedKeys),_i2=0;_i2<toRemoveEls.length;_i2++)toRemoveEls[_i2].object3D.visible=!1,toRemoveEls[_i2].setAttribute('data-bind-for-active','false'),toRemoveEls[_i2].removeAttribute('data-bind-for-key'),toRemoveEls[_i2].removeAttribute('data-bind-for-value'),toRemoveEls[_i2].emit('bindfordeactivate',null,!1),toRemoveEls[_i2].pause();list.length&&this.renderItemsInPlace(list,activeKeys,0)}}(),renderItemsInPlace:function renderItemsInPlace(list,activeKeys,i){var _this2=this,data=this.data,el=this.el,item=list[i],bindForKey=this.getBindForKey(item,i),keyValue=data.key?item[data.key].toString():item.toString(),itemEl;if(-1===this.renderedKeys.indexOf(keyValue)){if(!el.querySelector(':scope > [data-bind-for-active="false"]')){var _itemEl=this.generateFromTemplate(item,i);_itemEl.addEventListener('loaded',function(){_itemEl.emit('bindforupdateinplace',item,!1)}),el.appendChild(_itemEl)}else itemEl=el.querySelector('[data-bind-for-active="false"]'),itemEl.setAttribute('data-bind-for-key',bindForKey),itemEl.setAttribute('data-bind-for-value',keyValue),itemEl.object3D.visible=!0,itemEl.play(),itemEl.setAttribute('data-bind-for-active','true'),itemEl.emit('bindforupdateinplace',item,!1);this.renderedKeys.push(keyValue)}else-1!==activeKeys.indexOf(keyValue)&&(list.length&&list[0].constructor===String?(itemEl=el.querySelector('[data-bind-for-value="'+keyValue+'"]'),itemEl.setAttribute('data-bind-for-key',i)):itemEl=el.querySelector('[data-bind-for-key="'+bindForKey+'"]'),itemEl.emit('bindforupdateinplace',item,!1));list[i+1]&&(this.data.delay?setTimeout(function(){_this2.renderItemsInPlace(list,activeKeys,i+1)},this.data.delay):this.renderItemsInPlace(list,activeKeys,i+1))},generateFromTemplate:function generateFromTemplate(item,i){var data=this.data;this.el.appendChild(this.system.renderTemplate(this.template,item));var newEl=this.el.children[this.el.children.length-1];if(!item)return newEl.setAttribute('data-bind-for-key',''),newEl.setAttribute('data-bind-for-active','false'),newEl;var bindForKey=this.getBindForKey(item,i);return newEl.setAttribute('data-bind-for-key',bindForKey),data.key||newEl.setAttribute('data-bind-for-value',item),newEl.setAttribute('data-bind-for-active','true'),newEl},getElsToRemove:function(){var toRemove=[];return function(activeKeys,renderedKeys){var data=this.data,el=this.el;toRemove.length=0;for(var i=0;i<el.children.length;i++)if('TEMPLATE'!==el.children[i].tagName){var key=data.key?el.children[i].getAttribute('data-bind-for-key'):el.children[i].getAttribute('data-bind-for-value');-1===activeKeys.indexOf(key)&&-1!==renderedKeys.indexOf(key)&&(toRemove.push(el.children[i]),renderedKeys.splice(renderedKeys.indexOf(key),1))}return toRemove}}(),getBindForKey:function getBindForKey(item,i){return this.data.key?item[this.data.key].toString():i.toString()},onStateUpdate:function onStateUpdate(){this.data.updateInPlace?this.onStateUpdateInPlace():this.onStateUpdateNaive()}}),AFRAME.registerComponent('bind-item',{schema:{type:'string'},multiple:!0,init:function init(){this.itemData=null,this.keysToWatch=[],this.prevValues={};var rootEl=this.rootEl=this.el.closest('[data-bind-for-key]');if(!rootEl)throw new Error('bind-item component must be attached to entity under a bind-for item.');rootEl.addEventListener('bindforupdateinplace',this.updateInPlace.bind(this)),rootEl.addEventListener('bindfordeactivate',this.deactivate.bind(this)),this.el.sceneEl.systems.state.subscribe(this)},update:function update(){this.parseSelector()},updateInPlace:function updateInPlace(evt){var propertyMap=this.propertyMap;if('false'!==this.rootEl.getAttribute('data-bind-for-active'))for(var property in evt&&(this.itemData=evt.detail),propertyMap){var value=this.select(this.itemData,propertyMap[property]);value!==this.prevValues[property]&&(AFRAME.utils.entity.setComponentProperty(this.el,property,value),this.prevValues[property]=value)}},onStateUpdate:function onStateUpdate(){this.updateInPlace()},select:function select(itemData,selector){return lib.select(this.el.sceneEl.systems.state.state,selector,itemData)},deactivate:function deactivate(){this.prevValues={}},parseSelector:function parseSelector(){var propertyMap=this.propertyMap={};this.keysToWatch.length=0;var componentName=lib.split(this.id,'__')[0];if(componentName in AFRAME.components&&!AFRAME.components[componentName].isSingleProp){for(var propertySplitList=lib.split(this.data,';'),i=0,propertySplit;i<propertySplitList.length;i++)propertySplit=lib.split(propertySplitList[i],':'),propertyMap[this.id+'.'+propertySplit[0].trim()]=propertySplit[1].trim(),lib.parseKeysToWatch(this.keysToWatch,propertySplit[1].trim(),!0);return}propertyMap[this.id]=this.data,lib.parseKeysToWatch(this.keysToWatch,this.data,!0)}})},function(module){'use strict';module.exports=function(){var keys=[];return function(a,b,targetObject,ignoreKeys){var aVal,bVal,bKey,diff,key,i,isComparingObjects;for(key in diff=targetObject||{},keys.length=0,a)keys.push(key);if(!b)return diff;for(bKey in b)-1===keys.indexOf(bKey)&&keys.push(bKey);for(i=0;i<keys.length;i++)(key=keys[i],!(ignoreKeys&&-1!==ignoreKeys.indexOf(key)))&&(aVal=a[key],bVal=b[key],isComparingObjects=aVal&&bVal&&aVal.constructor===Object&&bVal.constructor===Object,(!isComparingObjects||AFRAME.utils.deepEqual(aVal,bVal))&&(isComparingObjects||aVal===bVal)||(diff[key]=bVal));return diff}}()},function(module){'use strict';function makeCallDirty(arr,fn){var originalFn=arr[fn];arr[fn]=function(){originalFn.apply(arr,arguments),arr.__dirty=!0}}var fns=['push','pop','shift','unshift','splice'];module.exports.wrapArray=function wrapArray(arr){var i;if(!arr.__wrapped){for(i=0;i<fns.length;i++)makeCallDirty(arr,fns[i]);arr.__wrapped=!0}}}])})},function(){var TYPE_PAD='PAD',TYPE_STICK='STICK',ANGLES=[0,90,180,270],DIRECTIONS=['right','up','left','down'],EVENTS={NULL:{START:'thumbstart',END:'thumbend'}};DIRECTIONS.forEach(direction=>{EVENTS[direction]={},EVENTS[direction].START='thumb'+direction+'start',EVENTS[direction].END='thumb'+direction+'end'});var SIZE=240;AFRAME.registerComponent('thumb-controls',{dependencies:['tracked-controls'],schema:{thresholdAngle:{default:89.5},thresholdPad:{default:0.05},thresholdStick:{default:0.75}},init:function(){var el=this.el;this.onTrackpadDown=this.onTrackpadDown.bind(this),this.onTrackpadUp=this.onTrackpadUp.bind(this),this.directionStick='',this.directionTrackpad='',this.type=TYPE_STICK,el.addEventListener('controllerconnected',evt=>'oculus-touch-controls'===evt.detail.name||'windows-motion-controls'===evt.detail.name?void(this.type=TYPE_STICK):void(this.type=TYPE_PAD)),this.axis=el.components['tracked-controls'].axis},play:function(){var el=this.el;el.addEventListener('trackpaddown',this.onTrackpadDown),el.addEventListener('trackpadup',this.onTrackpadUp)},pause:function(){var el=this.el;el.removeEventListener('trackpaddown',this.onTrackpadDown),el.removeEventListener('trackpadup',this.onTrackpadUp)},onTrackpadDown:function(){var el=this.el,direction;this.getDistance()<this.data.thresholdPad||(direction=this.getDirection(),direction&&(this.directionTrackpad=direction,el.emit(EVENTS.NULL.START,null,!1),el.emit(EVENTS[this.directionTrackpad].START,null,!1)))},onTrackpadUp:function(){var el=this.el;this.directionTrackpad&&(el.emit(EVENTS.NULL.END,null,!1),el.emit(EVENTS[this.directionTrackpad].END,null,!1),this.directionTrackpad='')},tick:function(){var el=this.el,direction;return this.type===TYPE_PAD?void 0:!this.directionStick&&this.getDistance()>this.data.thresholdStick?(direction=this.getDirection(),!direction)?void 0:(this.directionStick=direction,el.emit(EVENTS.NULL.START,null,!1),void el.emit(EVENTS[this.directionStick].START,null,!1)):void(this.directionStick&&this.getDistance()<this.data.thresholdStick&&(el.emit(EVENTS.NULL.END,null,!1),el.emit(EVENTS[this.directionStick].END,null,!1),this.directionStick=''))},getDistance:function(){var axis=this.axis;return Math.sqrt(axis[1]*axis[1]+axis[0]*axis[0])},getDirection:function(){var angle,bottomThreshold,i,threshold,topThreshold;for(angle=this.getAngle(),threshold=this.data.thresholdAngle/2,i=0;i<ANGLES.length;i++){if(topThreshold=ANGLES[i]+threshold,360<topThreshold&&(topThreshold-=360),bottomThreshold=ANGLES[i]-threshold,0>bottomThreshold&&(angle>=360+bottomThreshold&&360>=angle||0<=angle&&angle<=topThreshold))return DIRECTIONS[i];if(angle>=bottomThreshold&&angle<=topThreshold)return DIRECTIONS[i]}},getAngle:function(){var axis=this.axis,angle,flipY;return flipY=this.type===TYPE_STICK?-1:1,angle=Math.atan2(axis[1]*flipY,axis[0]),0>angle&&(angle=2*Math.PI+angle),THREE.Math.radToDeg(angle)}}),AFRAME.registerComponent('thumb-controls-debug',{dependencies:['thumb-controls','tracked-controls'],schema:{controllerType:{type:'string'},hand:{type:'string'},enabled:{default:!1}},init:function(){var el=this.el,data=this.data,isActive,axis,axisMoveEventDetail,canvas;(data.enabled||AFRAME.utils.getUrlParameter('debug-thumb'))&&(console.log('%c debug-thumb','background: #111; color: red'),el.components['tracked-controls'].handleAxes=()=>{},axis=[0,0,0],axisMoveEventDetail={axis:axis},el.components['tracked-controls'].axis=axis,el.components['thumb-controls'].axis=axis,canvas=this.createCanvas(),canvas.addEventListener('click',()=>{'vive-controls'===this.data.controllerType?isActive?el.emit('trackpadup'):el.emit('trackpaddown'):isActive&&(axis[0]=0,axis[1]=0,el.emit('axismove',axisMoveEventDetail,!1)),isActive=!isActive}),canvas.addEventListener('mousemove',evt=>{var rect;isActive&&(rect=canvas.getBoundingClientRect(),axis[0]=2*((evt.clientX-rect.left)/SIZE)-1,axis[1]=2*((evt.clientY-rect.top)/SIZE)-1,el.emit('axismove',axisMoveEventDetail,!1))}),canvas.addEventListener('mouseleave',()=>{isActive&&(axis[0]=0,axis[1]=0,el.emit('axismove',axisMoveEventDetail,!1))}))},createCanvas:function(){var canvas,ctx;return canvas=document.createElement('canvas'),canvas.classList.add('debugThumb'),canvas.height=SIZE,canvas.width=SIZE,canvas.style.bottom=0,canvas.style.borderRadius='250px',canvas.style.opacity=0.5,canvas.style.position='fixed',canvas.style.zIndex=999999999,'left'===this.data.hand?canvas.style.left=0:canvas.style.right=0,ctx=canvas.getContext('2d'),ctx.fillStyle='#333',ctx.fillRect(0,0,SIZE,SIZE),document.body.appendChild(canvas),canvas}})},function(module,exports,__webpack_require__){var content=__webpack_require__(134);'string'==typeof content&&(content=[[module.i,content,'']]);var options={hmr:!0},transform;options.transform=transform,options.insertInto=void 0;__webpack_require__(146)(content,options);content.locals&&(module.exports=content.locals),!1},function(module,exports,__webpack_require__){function webpackContext(req){return __webpack_require__(webpackContextResolve(req))}function webpackContextResolve(req){var id=map[req];if(!(id+1))throw new Error('Cannot find module \''+req+'\'.');return id}var map={"./active-color.js":59,"./audio-columns.js":60,"./beams.js":61,"./beat-hit-sound.js":62,"./beat-loader.js":63,"./beat.js":64,"./console-shortcuts.js":65,"./copy-texture.js":66,"./cursor-laser.js":67,"./cursor-mesh.js":68,"./debug-beat-loader.js":69,"./debug-controller.js":70,"./debug-cursor.js":71,"./debug-song-time.js":72,"./debug-state.js":73,"./fake-glow.js":74,"./floor-shader.js":75,"./gameover.js":76,"./gpu-preloader.js":77,"./hand-swapper.js":78,"./haptics-saber.js":79,"./haptics-wall.js":80,"./history.js":81,"./intro-song.js":82,"./keyboard-raycastable.js":83,"./leaderboard.js":84,"./logo-light.js":85,"./logoflicker.js":86,"./materials.js":87,"./menu-controls.js":88,"./menu-difficulty-select.js":89,"./menu-selected-challenge-image.js":90,"./menu-slide-animation.js":91,"./mine-fragments-loader.js":92,"./multiplier-ring.js":93,"./particleplayer.js":94,"./pause.js":95,"./pauser.js":96,"./play-sound.js":97,"./raycaster-target.js":98,"./recenter.js":99,"./saber-controls.js":100,"./saber-particles.js":101,"./score-beat.js":102,"./score-texts.js":103,"./search-thumbnail-atlas.js":104,"./search.js":105,"./song-preview.js":106,"./song-progress-ring.js":107,"./song.js":108,"./stage-colors.js":109,"./stage-lasers.js":110,"./stage-shader.js":111,"./stats-param.js":112,"./stepback.js":113,"./sub-object.js":114,"./super-keyboard.js":115,"./supercutfx-shader.js":116,"./supercutfx.js":117,"./text-counter.js":118,"./text-uppercase.js":119,"./toggle-pause-play.js":120,"./trail.js":121,"./tutorial-2d.js":122,"./twister.js":123,"./vertex-colors-buffer.js":124,"./victory-accuracy-ring.js":125,"./victory-rank.js":126,"./visible-raycastable.js":127,"./wall-shader.js":128,"./wall.js":129};webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=33},function(module,exports,__webpack_require__){function webpackContext(req){return __webpack_require__(webpackContextResolve(req))}function webpackContextResolve(req){var id=map[req];if(!(id+1))throw new Error('Cannot find module \''+req+'\'.');return id}var map={"./index.js":133};webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=34},function(module,exports,__webpack_require__){'use strict';var _Mathmin=Math.min,_Mathfloor=Math.floor,_Mathmax=Math.max;(function(process){function getLogLevel(){return logClient.logLevel===logger.LogLevel.DEBUG?LogLevel.DEBUG:logClient.logLevel===logger.LogLevel.SILENT?LogLevel.SILENT:LogLevel.ERROR}function setLogLevel(newLevel){newLevel===LogLevel.DEBUG?logClient.logLevel=logger.LogLevel.DEBUG:newLevel===LogLevel.ERROR?logClient.logLevel=logger.LogLevel.ERROR:newLevel===LogLevel.SILENT?logClient.logLevel=logger.LogLevel.SILENT:logClient.error('Firestore ('+SDK_VERSION+'): Invalid value passed to `setLogLevel`')}function debug(tag,msg){for(var obj=[],_i=2;_i<arguments.length;_i++)obj[_i-2]=arguments[_i];if(logClient.logLevel<=logger.LogLevel.DEBUG){var args=obj.map(argToString);logClient.debug.apply(logClient,['Firestore ('+SDK_VERSION+') ['+tag+']: '+msg].concat(args))}}function error(msg){for(var obj=[],_i=1;_i<arguments.length;_i++)obj[_i-1]=arguments[_i];if(logClient.logLevel<=logger.LogLevel.ERROR){var args=obj.map(argToString);logClient.error.apply(logClient,['Firestore ('+SDK_VERSION+'): '+msg].concat(args))}}function argToString(obj){if('string'==typeof obj)return obj;var platform=PlatformSupport.getPlatform();try{return platform.formatJSON(obj)}catch(e){return obj}}function fail(failure){var message='FIRESTORE ('+SDK_VERSION+') INTERNAL ASSERTION FAILED: '+failure;throw error(message),new Error(message)}function assert(assertion,message){assertion||fail(message)}function emptyByteString(){return PlatformSupport.getPlatform().emptyByteString}function makeConstructorPrivate(cls,optionalMessage){function PublicConstructor(){var error='This constructor is private.';throw optionalMessage&&(error+=' ',error+=optionalMessage),new FirestoreError(Code.INVALID_ARGUMENT,error)}for(var staticProperty in PublicConstructor.prototype=cls.prototype,cls)cls.hasOwnProperty(staticProperty)&&(PublicConstructor[staticProperty]=cls[staticProperty]);return PublicConstructor}function contains(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}function defaulted(value,defaultValue){return value===void 0?defaultValue:value}function forEachNumber(obj,fn){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var num=+key;isNaN(num)||fn(num,obj[key])}}function values(obj){var vs=[];return forEach(obj,function(_,v){return vs.push(v)}),vs}function forEach(obj,fn){for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&fn(key,obj[key])}function isEmpty(obj){for(var key in assert(null!=obj&&'object'==typeof obj,'isEmpty() expects object parameter.'),obj)if(Object.prototype.hasOwnProperty.call(obj,key))return!1;return!0}function shallowCopy(obj){assert(obj&&'object'==typeof obj,'shallowCopy() expects object parameter.');var result={};for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(result[key]=obj[key]);return result}function validateExactNumberOfArgs(functionName,args,numberOfArgs){if(args.length!==numberOfArgs)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires '+formatPlural(numberOfArgs,'argument')+', but was called with '+formatPlural(args.length,'argument')+'.')}function validateAtLeastNumberOfArgs(functionName,args,minNumberOfArgs){if(args.length<minNumberOfArgs)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires at least '+formatPlural(minNumberOfArgs,'argument')+', but was called with '+formatPlural(args.length,'argument')+'.')}function validateBetweenNumberOfArgs(functionName,args,minNumberOfArgs,maxNumberOfArgs){if(args.length<minNumberOfArgs||args.length>maxNumberOfArgs)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires between '+minNumberOfArgs+' and '+(maxNumberOfArgs+' arguments, but was called with ')+formatPlural(args.length,'argument')+'.')}function validateNamedArrayAtLeastNumberOfElements(functionName,value,name,minNumberOfElements){if(!(value instanceof Array)||value.length<minNumberOfElements)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+name+' argument to be an '+'array with at least '+(formatPlural(minNumberOfElements,'element')+'.'))}function validateArgType(functionName,type,position,argument){validateType(functionName,type,ordinal(position)+' argument',argument)}function validateOptionalArgType(functionName,type,position,argument){argument!==void 0&&validateArgType(functionName,type,position,argument)}function validateNamedType(functionName,type,optionName,argument){validateType(functionName,type,optionName+' option',argument)}function validateNamedOptionalType(functionName,type,optionName,argument){argument!==void 0&&validateNamedType(functionName,type,optionName,argument)}function validateArrayElements(functionName,optionName,typeDescription,argument,validator){if(!(argument instanceof Array))throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+optionName+' '+('option to be an array, but it was: '+valueDescription(argument)));for(var i=0;i<argument.length;++i)if(!validator(argument[i]))throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires all '+optionName+' '+('elements to be '+typeDescription+', but the value at index '+i+' ')+('was: '+valueDescription(argument[i])))}function validateOptionalArrayElements(functionName,optionName,typeDescription,argument,validator){argument!==void 0&&validateArrayElements(functionName,optionName,typeDescription,argument,validator)}function validateNamedPropertyEquals(functionName,inputName,optionName,input,expected){for(var expectedDescription=[],_i=0,expected_1=expected,val;_i<expected_1.length;_i++){if(val=expected_1[_i],val===input)return;expectedDescription.push(valueDescription(val))}var actualDescription=valueDescription(input);throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid value '+actualDescription+' provided to function '+functionName+'() for option '+('"'+optionName+'". Acceptable values: '+expectedDescription.join(', ')))}function validateNamedOptionalPropertyEquals(functionName,inputName,optionName,input,expected){input!==void 0&&validateNamedPropertyEquals(functionName,inputName,optionName,input,expected)}function validateType(functionName,type,inputName,input){var valid=!1;if(valid='object'===type?isPlainObject(input):'non-empty string'===type?'string'==typeof input&&''!==input:typeof input==type,!valid){var description=valueDescription(input);throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+inputName+' '+('to be of type '+type+', but it was: '+description))}}function isPlainObject(input){return'object'==typeof input&&null!==input&&(Object.getPrototypeOf(input)===Object.prototype||null===Object.getPrototypeOf(input))}function valueDescription(input){if(input===void 0)return'undefined';if(null===input)return'null';if('string'==typeof input)return 20<input.length&&(input=input.substring(0,20)+'...'),JSON.stringify(input);if('number'==typeof input||'boolean'==typeof input)return''+input;if('object'==typeof input){if(input instanceof Array)return'an array';var customObjectName=tryGetCustomObjectType(input);return customObjectName?'a custom '+customObjectName+' object':'an object'}return'function'==typeof input?'a function':fail('Unknown wrong type: '+typeof input)}function tryGetCustomObjectType(input){if(input.constructor){var funcNameRegex=/function\s+([^\s(]+)\s*\(/,results=funcNameRegex.exec(input.constructor.toString());if(results&&1<results.length)return results[1]}return null}function validateDefined(functionName,position,argument){if(argument===void 0)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires a valid '+ordinal(position)+' '+'argument, but it was undefined.')}function validateOptionNames(functionName,options,optionNames){forEach(options,function(key){if(0>optionNames.indexOf(key))throw new FirestoreError(Code.INVALID_ARGUMENT,'Unknown option \''+key+'\' passed to function '+functionName+'(). '+'Available options: '+optionNames.join(', '))})}function invalidClassError(functionName,type,position,argument){var description=valueDescription(argument);return new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+ordinal(position)+' '+('argument to be a '+type+', but it was: '+description))}function ordinal(num){return 1===num?'first':2===num?'second':3===num?'third':num+'th'}function formatPlural(num,str){return num+' '+str+(1===num?'':'s')}function primitiveComparator(left,right){return left<right?-1:left>right?1:0}function equals(left,right){return null!==left&&void 0!==left?!!(right&&left.isEqual(right)):left===right}function arrayEquals(left,right){if(left.length!==right.length)return!1;for(var i=0;i<left.length;i++)if(!left[i].isEqual(right[i]))return!1;return!0}function immediateSuccessor(s){return s+'\0'}function assertUint8ArrayAvailable(){if('undefined'==typeof Uint8Array)throw new FirestoreError(Code.UNIMPLEMENTED,'Uint8Arrays are not available in this environment.')}function assertBase64Available(){if(!PlatformSupport.getPlatform().base64Available)throw new FirestoreError(Code.UNIMPLEMENTED,'Blobs are unavailable in Firestore in this environment.')}function numericComparator(left,right){return left<right?-1:left>right?1:left===right?0:isNaN(left)?isNaN(right)?0:-1:1}function numericEquals(left,right){return left===right?0!==left||1/left==1/right:left!==left&&right!==right}function isNullOrUndefined(value){return null===value||value===void 0}function isSafeInteger(value){return isInteger(value)&&value<=MAX_SAFE_INTEGER&&value>=MIN_SAFE_INTEGER}function coercedFieldValuesArray(value){return value instanceof ArrayValue?value.internalValue.slice():[]}function isPermanentError(code){return code===Code.OK?fail('Treated status OK as error'):code===Code.CANCELLED||code===Code.UNKNOWN||code===Code.DEADLINE_EXCEEDED||code===Code.RESOURCE_EXHAUSTED||code===Code.INTERNAL||code===Code.UNAVAILABLE||code===Code.UNAUTHENTICATED?!1:code===Code.INVALID_ARGUMENT||code===Code.NOT_FOUND||code===Code.ALREADY_EXISTS||code===Code.PERMISSION_DENIED||code===Code.FAILED_PRECONDITION||code===Code.ABORTED||code===Code.OUT_OF_RANGE||code===Code.UNIMPLEMENTED||code===Code.DATA_LOSS||fail('Unknown status code: '+code)}function mapCodeFromRpcStatus(status){var code=RpcCode[status];return void 0===code?void 0:mapCodeFromRpcCode(code)}function mapCodeFromRpcCode(code){if(void 0===code)return error('GRPC error has no .code'),Code.UNKNOWN;return code===RpcCode.OK?Code.OK:code===RpcCode.CANCELLED?Code.CANCELLED:code===RpcCode.UNKNOWN?Code.UNKNOWN:code===RpcCode.DEADLINE_EXCEEDED?Code.DEADLINE_EXCEEDED:code===RpcCode.RESOURCE_EXHAUSTED?Code.RESOURCE_EXHAUSTED:code===RpcCode.INTERNAL?Code.INTERNAL:code===RpcCode.UNAVAILABLE?Code.UNAVAILABLE:code===RpcCode.UNAUTHENTICATED?Code.UNAUTHENTICATED:code===RpcCode.INVALID_ARGUMENT?Code.INVALID_ARGUMENT:code===RpcCode.NOT_FOUND?Code.NOT_FOUND:code===RpcCode.ALREADY_EXISTS?Code.ALREADY_EXISTS:code===RpcCode.PERMISSION_DENIED?Code.PERMISSION_DENIED:code===RpcCode.FAILED_PRECONDITION?Code.FAILED_PRECONDITION:code===RpcCode.ABORTED?Code.ABORTED:code===RpcCode.OUT_OF_RANGE?Code.OUT_OF_RANGE:code===RpcCode.UNIMPLEMENTED?Code.UNIMPLEMENTED:code===RpcCode.DATA_LOSS?Code.DATA_LOSS:fail('Unknown status code: '+code)}function mapRpcCodeFromCode(code){if(code===void 0)return RpcCode.OK;return code===Code.OK?RpcCode.OK:code===Code.CANCELLED?RpcCode.CANCELLED:code===Code.UNKNOWN?RpcCode.UNKNOWN:code===Code.DEADLINE_EXCEEDED?RpcCode.DEADLINE_EXCEEDED:code===Code.RESOURCE_EXHAUSTED?RpcCode.RESOURCE_EXHAUSTED:code===Code.INTERNAL?RpcCode.INTERNAL:code===Code.UNAVAILABLE?RpcCode.UNAVAILABLE:code===Code.UNAUTHENTICATED?RpcCode.UNAUTHENTICATED:code===Code.INVALID_ARGUMENT?RpcCode.INVALID_ARGUMENT:code===Code.NOT_FOUND?RpcCode.NOT_FOUND:code===Code.ALREADY_EXISTS?RpcCode.ALREADY_EXISTS:code===Code.PERMISSION_DENIED?RpcCode.PERMISSION_DENIED:code===Code.FAILED_PRECONDITION?RpcCode.FAILED_PRECONDITION:code===Code.ABORTED?RpcCode.ABORTED:code===Code.OUT_OF_RANGE?RpcCode.OUT_OF_RANGE:code===Code.UNIMPLEMENTED?RpcCode.UNIMPLEMENTED:code===Code.DATA_LOSS?RpcCode.DATA_LOSS:fail('Unknown status code: '+code)}function mapCodeFromHttpStatus(status){return 200===status?Code.OK:400===status?Code.INVALID_ARGUMENT:401===status?Code.UNAUTHENTICATED:403===status?Code.PERMISSION_DENIED:404===status?Code.NOT_FOUND:409===status?Code.ABORTED:416===status?Code.OUT_OF_RANGE:429===status?Code.RESOURCE_EXHAUSTED:499===status?Code.CANCELLED:500===status?Code.UNKNOWN:501===status?Code.UNIMPLEMENTED:503===status?Code.UNAVAILABLE:504===status?Code.DEADLINE_EXCEEDED:200<=status&&300>status?Code.OK:400<=status&&500>status?Code.FAILED_PRECONDITION:500<=status&&600>status?Code.INTERNAL:Code.UNKNOWN}function maybeDocumentMap(){return EMPTY_MAYBE_DOCUMENT_MAP}function documentMap(){return EMPTY_DOCUMENT_MAP}function documentVersionMap(){return EMPTY_DOCUMENT_VERSION_MAP}function documentKeySet(){return EMPTY_DOCUMENT_KEY_SET}function targetIdSet(){return EMPTY_TARGET_ID_SET}function documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}function assertPresent(value,description){assert(!isNullOrUndefined(value),description+' is missing')}function parseInt64(value){return'number'==typeof value?value:'string'==typeof value?+value:fail('can\'t parse '+value)}function hasTag(obj,type,tag){return type===tag||!type&&tag in obj}function encode(path){for(var result='',i=0;i<path.length;i++)0<result.length&&(result=encodeSeparator(result)),result=encodeSegment(path.get(i),result);return encodeSeparator(result)}function encodeSegment(segment,resultBuf){for(var result=resultBuf,length=segment.length,i=0,c;i<length;i++)c=segment.charAt(i),result+='\0'===c?escapeChar+encodedNul:c===escapeChar?escapeChar+encodedEscape:c;return result}function encodeSeparator(result){return result+escapeChar+encodedSeparatorChar}function decode$1(path){var length=path.length;if(assert(2<=length,'Invalid path '+path),2===length)return assert(path.charAt(0)===escapeChar&&path.charAt(1)===encodedSeparatorChar,'Non-empty path '+path+' had length 2'),ResourcePath.EMPTY_PATH;for(var segments=[],segmentBuilder='',start=0,end;start<length;){end=path.indexOf(escapeChar,start),(0>end||end>length-2)&&fail('Invalid encoded resource path: "'+path+'"');var next=path.charAt(end+1);switch(next){case encodedSeparatorChar:var currentPiece=path.substring(start,end),segment=void 0;0===segmentBuilder.length?segment=currentPiece:(segmentBuilder+=currentPiece,segment=segmentBuilder,segmentBuilder=''),segments.push(segment);break;case encodedNul:segmentBuilder+=path.substring(start,end),segmentBuilder+='\0';break;case encodedEscape:segmentBuilder+=path.substring(start,end+1);break;default:fail('Invalid encoded resource path: "'+path+'"');}start=end+2}return new ResourcePath(segments)}function wrapRequest(request){return new PersistencePromise(function(resolve,reject){request.onsuccess=function(event){var result=event.target.result;resolve(result)},request.onerror=function(event){reject(event.target.error)}})}function documentGlobalStore(txn){return IndexedDbPersistence.getStore(txn,DbRemoteDocumentGlobal.store)}function isDocumentChangeMissingError(err){return err.code===Code.DATA_LOSS&&err.message===REMOTE_DOCUMENT_CHANGE_MISSING_ERR_MSG}function remoteDocumentsStore(txn){return IndexedDbPersistence.getStore(txn,DbRemoteDocument.store)}function documentChangesStore(txn){return IndexedDbPersistence.getStore(txn,DbRemoteDocumentChanges.store)}function dbKey(docKey){return docKey.path.toArray()}function dbDocumentSize(doc){var value;if(doc.document)value=doc.document;else if(doc.unknownDocument)value=doc.unknownDocument;else if(doc.noDocument)value=doc.noDocument;else throw fail('Unknown remote document type');return JSON.stringify(value).length}function createPrimaryClientStore(db){db.createObjectStore(DbPrimaryClient.store)}function createMutationQueue(db){db.createObjectStore(DbMutationQueue.store,{keyPath:DbMutationQueue.keyPath});var mutationBatchesStore=db.createObjectStore(DbMutationBatch.store,{keyPath:DbMutationBatch.keyPath,autoIncrement:!0});mutationBatchesStore.createIndex(DbMutationBatch.userMutationsIndex,DbMutationBatch.userMutationsKeyPath,{unique:!0}),db.createObjectStore(DbDocumentMutation.store)}function upgradeMutationBatchSchemaAndMigrateData(db,txn){var v1MutationsStore=txn.store(DbMutationBatch.store);return v1MutationsStore.loadAll().next(function(existingMutations){db.deleteObjectStore(DbMutationBatch.store);var mutationsStore=db.createObjectStore(DbMutationBatch.store,{keyPath:DbMutationBatch.keyPath,autoIncrement:!0});mutationsStore.createIndex(DbMutationBatch.userMutationsIndex,DbMutationBatch.userMutationsKeyPath,{unique:!0});var v3MutationsStore=txn.store(DbMutationBatch.store),writeAll=existingMutations.map(function(mutation){return v3MutationsStore.put(mutation)});return PersistencePromise.waitFor(writeAll)})}function createRemoteDocumentCache(db){db.createObjectStore(DbRemoteDocument.store)}function createDocumentGlobalStore(db){db.createObjectStore(DbRemoteDocumentGlobal.store)}function createQueryCache(db){var targetDocumentsStore=db.createObjectStore(DbTargetDocument.store,{keyPath:DbTargetDocument.keyPath});targetDocumentsStore.createIndex(DbTargetDocument.documentTargetsIndex,DbTargetDocument.documentTargetsKeyPath,{unique:!0});var targetStore=db.createObjectStore(DbTarget.store,{keyPath:DbTarget.keyPath});targetStore.createIndex(DbTarget.queryTargetsIndexName,DbTarget.queryTargetsKeyPath,{unique:!0}),db.createObjectStore(DbTargetGlobal.store)}function dropQueryCache(db){db.deleteObjectStore(DbTargetDocument.store),db.deleteObjectStore(DbTarget.store),db.deleteObjectStore(DbTargetGlobal.store)}function writeEmptyTargetGlobalEntry(txn){var globalStore=txn.store(DbTargetGlobal.store),metadata=new DbTargetGlobal(0,0,SnapshotVersion.MIN.toTimestamp(),0);return globalStore.put(DbTargetGlobal.key,metadata)}function createRemoteDocumentChangesStore(db){db.createObjectStore(DbRemoteDocumentChanges.store,{keyPath:'id',autoIncrement:!0})}function createClientMetadataStore(db){db.createObjectStore(DbClientMetadata.store,{keyPath:DbClientMetadata.keyPath})}function mutationQueueContainsKey(txn,userId,key){var indexKey=DbDocumentMutation.prefixForPath(userId,key.path),encodedPath=indexKey[1],startRange=IDBKeyRange.lowerBound(indexKey),containsKey=!1;return documentMutationsStore(txn).iterate({range:startRange,keysOnly:!0},function(key,value,control){var userID=key[0],keyPath=key[1],_=key[2];userID===userId&&keyPath===encodedPath&&(containsKey=!0),control.done()}).next(function(){return containsKey})}function mutationQueuesContainKey(txn,docKey){var found=!1;return mutationQueuesStore(txn).iterateSerial(function(userId){return mutationQueueContainsKey(txn,userId,docKey).next(function(containsKey){return containsKey&&(found=!0),PersistencePromise.resolve(!containsKey)})}).next(function(){return found})}function removeMutationBatch(txn,userId,batch){var mutationStore=txn.store(DbMutationBatch.store),indexTxn=txn.store(DbDocumentMutation.store),promises=[],range=IDBKeyRange.only(batch.batchId),numDeleted=0,removePromise=mutationStore.iterate({range:range},function(key,value,control){return numDeleted++,control.delete()});promises.push(removePromise.next(function(){assert(1==numDeleted,'Dangling document-mutation reference found: Missing batch '+batch.batchId)}));for(var removedDocuments=[],_i=0,_a=batch.mutations;_i<_a.length;_i++){var mutation=_a[_i],indexKey=DbDocumentMutation.key(userId,mutation.key.path,batch.batchId);promises.push(indexTxn.delete(indexKey)),removedDocuments.push(mutation.key)}return PersistencePromise.waitFor(promises).next(function(){return removedDocuments})}function convertStreamToken(token){return token instanceof Uint8Array?(assert('YES'===process.env.USE_MOCK_PERSISTENCE,'Persisting non-string stream tokens is only supported with mock persistence.'),token.toString()):token}function mutationsStore(txn){return IndexedDbPersistence.getStore(txn,DbMutationBatch.store)}function documentMutationsStore(txn){return IndexedDbPersistence.getStore(txn,DbDocumentMutation.store)}function mutationQueuesStore(txn){return IndexedDbPersistence.getStore(txn,DbMutationQueue.store)}function targetsStore(txn){return IndexedDbPersistence.getStore(txn,DbTarget.store)}function globalTargetStore(txn){return IndexedDbPersistence.getStore(txn,DbTargetGlobal.store)}function retrieveMetadata(txn){var globalStore=SimpleDb.getStore(txn,DbTargetGlobal.store);return globalStore.get(DbTargetGlobal.key).next(function(metadata){return assert(null!==metadata,'Missing metadata row.'),metadata})}function getHighestListenSequenceNumber(txn){return retrieveMetadata(txn).next(function(targetGlobal){return targetGlobal.highestListenSequenceNumber})}function documentTargetStore(txn){return IndexedDbPersistence.getStore(txn,DbTargetDocument.store)}function isDocumentQuery(dbQuery){return dbQuery.documents!==void 0}function bufferEntryComparator(_a,_b){var aSequence=_a[0],aIndex=_a[1],bSequence=_b[0],bIndex=_b[1],seqCmp=primitiveComparator(aSequence,bSequence);return 0===seqCmp?primitiveComparator(aIndex,bIndex):seqCmp}function isPrimaryLeaseLostError(err){return err.code===Code.FAILED_PRECONDITION&&err.message===PRIMARY_LEASE_LOST_ERROR_MSG}function primaryClientStore(txn){return txn.store(DbPrimaryClient.store)}function clientMetadataStore(txn){return txn.store(DbClientMetadata.store)}function sentinelKey(key){return[0,encode(key.path)]}function sentinelRow(key,sequenceNumber){return new DbTargetDocument(0,encode(key.path),sequenceNumber)}function writeSentinelKey(txn,key){return documentTargetStore(txn).put(sentinelRow(key,txn.currentSequenceNumber))}function documentSizeMap(){return new SortedMap(DocumentKey.comparator)}function compareChangeType(c1,c2){var order=function(change){return change===ChangeType.Added?1:change===ChangeType.Modified?2:change===ChangeType.Metadata?2:change===ChangeType.Removed?0:fail('Unknown ChangeType: '+change)};return order(c1)-order(c2)}function fromWebStorageSequenceNumber(seqString){var sequenceNumber=ListenSequence.INVALID;if(null!=seqString)try{var parsed=JSON.parse(seqString);assert('number'==typeof parsed,'Found non-numeric sequence number'),sequenceNumber=parsed}catch(e){error(LOG_TAG$10,'Failed to read sequence number from WebStorage',e)}return sequenceNumber}function fromDotSeparatedString(path){var found=path.search(RESERVED);if(0<=found)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field path ('+path+'). Paths must not contain '+'\'~\', \'*\', \'/\', \'[\', or \']\'');try{return new(FieldPath$1.bind.apply(FieldPath$1,[void 0].concat(path.split('.'))))}catch(e){throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field path ('+path+'). Paths must not be empty, '+'begin with \'.\', end with \'.\', or contain \'..\'')}}function makeCredentialsProvider(credentials){if(!credentials)return new EmptyCredentialsProvider;switch(credentials.type){case'gapi':return new FirstPartyCredentialsProvider(credentials.client,credentials.sessionIndex||'0');case'provider':return credentials.client;default:throw new FirestoreError(Code.INVALID_ARGUMENT,'makeCredentialsProvider failed due to invalid credential type');}}function isPartialObserver(obj){return implementsAnyMethods$1(obj,['next','error','complete'])}function implementsAnyMethods$1(obj,methods){if('object'!=typeof obj||null===obj)return!1;for(var object=obj,_i=0,methods_1=methods,method;_i<methods_1.length;_i++)if(method=methods_1[_i],method in object&&'function'==typeof object[method])return!0;return!1}function isWrite(dataSource){switch(dataSource){case UserDataSource.Set:case UserDataSource.MergeSet:case UserDataSource.Update:return!0;case UserDataSource.Argument:return!1;default:throw fail('Unexpected case for UserDataSource: '+dataSource);}}function looksLikeJsonObject(input){return'object'==typeof input&&null!==input&&!(input instanceof Array)&&!(input instanceof Date)&&!(input instanceof Timestamp)&&!(input instanceof GeoPoint)&&!(input instanceof Blob)&&!(input instanceof DocumentKeyReference)&&!(input instanceof FieldValueImpl)}function validatePlainObject(message,context,input){if(!looksLikeJsonObject(input)||!isPlainObject(input)){var description=valueDescription(input);if('an object'===description)throw context.createError(message+' a custom object');else throw context.createError(message+' '+description)}}function fieldPathFromArgument(methodName,path){if(path instanceof FieldPath$1)return path._internalPath;if('string'==typeof path)return fieldPathFromDotSeparatedString(methodName,path);throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+methodName+'() called with invalid data. '+'Field path arguments must be of type string or FieldPath.')}function fieldPathFromDotSeparatedString(methodName,path){try{return fromDotSeparatedString(path)._internalPath}catch(e){var message=errorMessage(e);throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+methodName+'() called with invalid data. '+message)}}function errorMessage(error){return error instanceof Error?error.message:error.toString()}function throwDocChangesMethodError(){throw new FirestoreError(Code.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a '+'method, so usages like "querySnapshot.docChanges" should become '+'"querySnapshot.docChanges()"')}function validateSetOptions(methodName,options){if(void 0===options)return{merge:!1};if(validateOptionNames(methodName,options,['merge','mergeFields']),validateNamedOptionalType(methodName,'boolean','merge',options.merge),validateOptionalArrayElements(methodName,'mergeFields','a string or a FieldPath',options.mergeFields,function(element){return'string'==typeof element||element instanceof FieldPath$1}),void 0!==options.mergeFields&&void 0!==options.merge)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid options passed to function '+methodName+'(): You cannot specify both "merge" '+'and "mergeFields".');return options}function validateSnapshotOptions(methodName,options){return void 0===options?{}:(validateOptionNames(methodName,options,['serverTimestamps']),validateNamedOptionalPropertyEquals(methodName,'options','serverTimestamps',options.serverTimestamps,['estimate','previous','none']),options)}function validateGetOptions(methodName,options){validateOptionalArgType(methodName,'object',1,options),options&&(validateOptionNames(methodName,options,['source']),validateNamedOptionalPropertyEquals(methodName,'options','source',options.source,['default','server','cache']))}function validateReference(methodName,documentRef,firestore){if(!(documentRef instanceof DocumentReference))throw invalidClassError(methodName,'DocumentReference',1,documentRef);else if(documentRef.firestore!==firestore)throw new FirestoreError(Code.INVALID_ARGUMENT,'Provided document reference is from a different Firestore instance.');else return documentRef}function changesFromSnapshot(firestore,includeMetadataChanges,snapshot){if(snapshot.oldDocs.isEmpty()){var index_1=0,lastDoc_1;return snapshot.docChanges.map(function(change){var doc=new QueryDocumentSnapshot(firestore,change.doc.key,change.doc,snapshot.fromCache,snapshot.mutatedKeys.has(change.doc.key));return assert(change.type===ChangeType.Added,'Invalid event type for first snapshot'),assert(!lastDoc_1||0>snapshot.query.docComparator(lastDoc_1,change.doc),'Got added events in wrong order'),lastDoc_1=change.doc,{type:'added',doc:doc,oldIndex:-1,newIndex:index_1++}})}var indexTracker_1=snapshot.oldDocs;return snapshot.docChanges.filter(function(change){return includeMetadataChanges||change.type!==ChangeType.Metadata}).map(function(change){var doc=new QueryDocumentSnapshot(firestore,change.doc.key,change.doc,snapshot.fromCache,snapshot.mutatedKeys.has(change.doc.key)),oldIndex=-1,newIndex=-1;return change.type!==ChangeType.Added&&(oldIndex=indexTracker_1.indexOf(change.doc.key),assert(0<=oldIndex,'Index for document not found'),indexTracker_1=indexTracker_1.delete(change.doc.key)),change.type!==ChangeType.Removed&&(indexTracker_1=indexTracker_1.add(change.doc),newIndex=indexTracker_1.indexOf(change.doc.key)),{type:resultChangeType(change.type),doc:doc,oldIndex:oldIndex,newIndex:newIndex}})}function resultChangeType(type){return type===ChangeType.Added?'added':type===ChangeType.Modified||type===ChangeType.Metadata?'modified':type===ChangeType.Removed?'removed':fail('Unknown change type: '+type)}function configureForFirebase(firebase$$1){firebase$$1.INTERNAL.registerService('firestore',function(app){return new Firestore(app)},shallowCopy(firestoreNamespace))}function registerFirestore(instance){configureForFirebase(instance)}var _NumberPOSITIVE_INFINITY=Number.POSITIVE_INFINITY,_NumberNEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Object.defineProperty(exports,'__esModule',{value:!0});var firebase=function _interopDefault(ex){return ex&&'object'==typeof ex&&'default'in ex?ex['default']:ex}(__webpack_require__(13)),logger=__webpack_require__(36),tslib_1=__webpack_require__(19),webchannelWrapper=__webpack_require__(39),SDK_VERSION=firebase.SDK_VERSION,logClient=new logger.Logger('@firebase/firestore'),LogLevel;(function(LogLevel){LogLevel[LogLevel.DEBUG=0]='DEBUG',LogLevel[LogLevel.ERROR=1]='ERROR',LogLevel[LogLevel.SILENT=2]='SILENT'})(LogLevel||(LogLevel={}));var PlatformSupport=function(){function PlatformSupport(){}return PlatformSupport.setPlatform=function(platform){PlatformSupport.platform&&fail('Platform already defined'),PlatformSupport.platform=platform},PlatformSupport.getPlatform=function(){return PlatformSupport.platform||fail('Platform not set'),PlatformSupport.platform},PlatformSupport}(),Code={OK:'ok',CANCELLED:'cancelled',UNKNOWN:'unknown',INVALID_ARGUMENT:'invalid-argument',DEADLINE_EXCEEDED:'deadline-exceeded',NOT_FOUND:'not-found',ALREADY_EXISTS:'already-exists',PERMISSION_DENIED:'permission-denied',UNAUTHENTICATED:'unauthenticated',RESOURCE_EXHAUSTED:'resource-exhausted',FAILED_PRECONDITION:'failed-precondition',ABORTED:'aborted',OUT_OF_RANGE:'out-of-range',UNIMPLEMENTED:'unimplemented',INTERNAL:'internal',UNAVAILABLE:'unavailable',DATA_LOSS:'data-loss'},FirestoreError=function(_super){function FirestoreError(code,message){var _this=_super.call(this,message)||this;return _this.code=code,_this.message=message,_this.name='FirebaseError',_this.toString=function(){return _this.name+': [code='+_this.code+']: '+_this.message},_this}return tslib_1.__extends(FirestoreError,_super),FirestoreError}(Error),AutoId=function(){function AutoId(){}return AutoId.newId=function(){for(var chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',autoId='',i=0;20>i;i++)autoId+=chars.charAt(_Mathfloor(Math.random()*chars.length));return assert(20===autoId.length,'Invalid auto ID: '+autoId),autoId},AutoId}(),Blob=function(){function Blob(binaryString){assertBase64Available(),this._binaryString=binaryString}return Blob.fromBase64String=function(base64){validateExactNumberOfArgs('Blob.fromBase64String',arguments,1),validateArgType('Blob.fromBase64String','string',1,base64),assertBase64Available();try{var binaryString=PlatformSupport.getPlatform().atob(base64);return new Blob(binaryString)}catch(e){throw new FirestoreError(Code.INVALID_ARGUMENT,'Failed to construct Blob from Base64 string: '+e)}},Blob.fromUint8Array=function(array){if(validateExactNumberOfArgs('Blob.fromUint8Array',arguments,1),assertUint8ArrayAvailable(),!(array instanceof Uint8Array))throw invalidClassError('Blob.fromUint8Array','Uint8Array',1,array);var binaryString=Array.prototype.map.call(array,function(char){return String.fromCharCode(char)}).join('');return new Blob(binaryString)},Blob.prototype.toBase64=function(){return validateExactNumberOfArgs('Blob.toBase64',arguments,0),assertBase64Available(),PlatformSupport.getPlatform().btoa(this._binaryString)},Blob.prototype.toUint8Array=function(){validateExactNumberOfArgs('Blob.toUint8Array',arguments,0),assertUint8ArrayAvailable();for(var buffer=new Uint8Array(this._binaryString.length),i=0;i<this._binaryString.length;i++)buffer[i]=this._binaryString.charCodeAt(i);return buffer},Blob.prototype.toString=function(){return'Blob(base64: '+this.toBase64()+')'},Blob.prototype.isEqual=function(other){return this._binaryString===other._binaryString},Blob.prototype._compareTo=function(other){return primitiveComparator(this._binaryString,other._binaryString)},Blob}(),PublicBlob=makeConstructorPrivate(Blob,'Use Blob.fromUint8Array() or Blob.fromBase64String() instead.'),GeoPoint=function(){function GeoPoint(latitude,longitude){if(validateExactNumberOfArgs('GeoPoint',arguments,2),validateArgType('GeoPoint','number',1,latitude),validateArgType('GeoPoint','number',2,longitude),!isFinite(latitude)||-90>latitude||90<latitude)throw new FirestoreError(Code.INVALID_ARGUMENT,'Latitude must be a number between -90 and 90, but was: '+latitude);if(!isFinite(longitude)||-180>longitude||180<longitude)throw new FirestoreError(Code.INVALID_ARGUMENT,'Longitude must be a number between -180 and 180, but was: '+longitude);this._lat=latitude,this._long=longitude}return Object.defineProperty(GeoPoint.prototype,'latitude',{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(GeoPoint.prototype,'longitude',{get:function(){return this._long},enumerable:!0,configurable:!0}),GeoPoint.prototype.isEqual=function(other){return this._lat===other._lat&&this._long===other._long},GeoPoint.prototype._compareTo=function(other){return primitiveComparator(this._lat,other._lat)||primitiveComparator(this._long,other._long)},GeoPoint}(),Timestamp=function(){function Timestamp(seconds,nanoseconds){if(this.seconds=seconds,this.nanoseconds=nanoseconds,0>nanoseconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp nanoseconds out of range: '+nanoseconds);if(1e9<=nanoseconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp nanoseconds out of range: '+nanoseconds);if(-62135596800>seconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp seconds out of range: '+seconds);if(253402300800<=seconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp seconds out of range: '+seconds)}return Timestamp.now=function(){return Timestamp.fromMillis(Date.now())},Timestamp.fromDate=function(date){return Timestamp.fromMillis(date.getTime())},Timestamp.fromMillis=function(milliseconds){var seconds=_Mathfloor(milliseconds/1e3);return new Timestamp(seconds,1e6*(milliseconds-1e3*seconds))},Timestamp.prototype.toDate=function(){return new Date(this.toMillis())},Timestamp.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Timestamp.prototype._compareTo=function(other){return this.seconds===other.seconds?primitiveComparator(this.nanoseconds,other.nanoseconds):primitiveComparator(this.seconds,other.seconds)},Timestamp.prototype.isEqual=function(other){return other.seconds===this.seconds&&other.nanoseconds===this.nanoseconds},Timestamp.prototype.toString=function(){return'Timestamp(seconds='+this.seconds+', nanoseconds='+this.nanoseconds+')'},Timestamp}(),DatabaseInfo=function(){return function DatabaseInfo(databaseId,persistenceKey,host,ssl){this.databaseId=databaseId,this.persistenceKey=persistenceKey,this.host=host,this.ssl=ssl}}(),DEFAULT_DATABASE_NAME='(default)',DatabaseId=function(){function DatabaseId(projectId,database){this.projectId=projectId,this.database=database?database:DEFAULT_DATABASE_NAME}return Object.defineProperty(DatabaseId.prototype,'isDefaultDatabase',{get:function(){return this.database===DEFAULT_DATABASE_NAME},enumerable:!0,configurable:!0}),DatabaseId.prototype.isEqual=function(other){return other instanceof DatabaseId&&other.projectId===this.projectId&&other.database===this.database},DatabaseId.prototype.compareTo=function(other){return primitiveComparator(this.projectId,other.projectId)||primitiveComparator(this.database,other.database)},DatabaseId}(),DOCUMENT_KEY_NAME='__name__',Path=function(){function Path(segments,offset,length){this.init(segments,offset,length)}return Path.prototype.init=function(segments,offset,length){void 0===offset?offset=0:offset>segments.length&&fail('offset '+offset+' out of range '+segments.length),void 0===length?length=segments.length-offset:length>segments.length-offset&&fail('length '+length+' out of range '+(segments.length-offset)),this.segments=segments,this.offset=offset,this.len=length},Path.prototype.construct=function(segments,offset,length){var path=Object.create(Object.getPrototypeOf(this));return path.init(segments,offset,length),path},Object.defineProperty(Path.prototype,'length',{get:function(){return this.len},enumerable:!0,configurable:!0}),Path.prototype.isEqual=function(other){return 0===Path.comparator(this,other)},Path.prototype.child=function(nameOrPath){var segments=this.segments.slice(this.offset,this.limit());return nameOrPath instanceof Path?nameOrPath.forEach(function(segment){segments.push(segment)}):'string'==typeof nameOrPath?segments.push(nameOrPath):fail('Unknown parameter type for Path.child(): '+nameOrPath),this.construct(segments)},Path.prototype.limit=function(){return this.offset+this.length},Path.prototype.popFirst=function(size){return size=void 0===size?1:size,assert(this.length>=size,'Can\'t call popFirst() with less segments'),this.construct(this.segments,this.offset+size,this.length-size)},Path.prototype.popLast=function(){return assert(!this.isEmpty(),'Can\'t call popLast() on empty path'),this.construct(this.segments,this.offset,this.length-1)},Path.prototype.firstSegment=function(){return assert(!this.isEmpty(),'Can\'t call firstSegment() on empty path'),this.segments[this.offset]},Path.prototype.lastSegment=function(){return assert(!this.isEmpty(),'Can\'t call lastSegment() on empty path'),this.segments[this.limit()-1]},Path.prototype.get=function(index){return assert(index<this.length,'Index out of range'),this.segments[this.offset+index]},Path.prototype.isEmpty=function(){return 0===this.length},Path.prototype.isPrefixOf=function(other){if(other.length<this.length)return!1;for(var i=0;i<this.length;i++)if(this.get(i)!==other.get(i))return!1;return!0},Path.prototype.isImmediateParentOf=function(potentialChild){if(this.length+1!==potentialChild.length)return!1;for(var i=0;i<this.length;i++)if(this.get(i)!==potentialChild.get(i))return!1;return!0},Path.prototype.forEach=function(fn){for(var i=this.offset,end=this.limit();i<end;i++)fn(this.segments[i])},Path.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},Path.comparator=function(p1,p2){for(var len=_Mathmin(p1.length,p2.length),i=0;i<len;i++){var left=p1.get(i),right=p2.get(i);if(left<right)return-1;if(left>right)return 1}return p1.length<p2.length?-1:p1.length>p2.length?1:0},Path}(),ResourcePath=function(_super){function ResourcePath(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_1.__extends(ResourcePath,_super),ResourcePath.prototype.canonicalString=function(){return this.toArray().join('/')},ResourcePath.prototype.toString=function(){return this.canonicalString()},ResourcePath.fromString=function(path){if(0<=path.indexOf('//'))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid path ('+path+'). Paths must not contain // in them.');var segments=path.split('/').filter(function(segment){return 0<segment.length});return new ResourcePath(segments)},ResourcePath.EMPTY_PATH=new ResourcePath([]),ResourcePath}(Path),identifierRegExp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,FieldPath=function(_super){function FieldPath(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_1.__extends(FieldPath,_super),FieldPath.isValidIdentifier=function(segment){return identifierRegExp.test(segment)},FieldPath.prototype.canonicalString=function(){return this.toArray().map(function(str){return str=str.replace('\\','\\\\').replace('`','\\`'),FieldPath.isValidIdentifier(str)||(str='`'+str+'`'),str}).join('.')},FieldPath.prototype.toString=function(){return this.canonicalString()},FieldPath.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===DOCUMENT_KEY_NAME},FieldPath.keyField=function(){return new FieldPath([DOCUMENT_KEY_NAME])},FieldPath.fromServerFormat=function(path){for(var segments=[],current='',i=0,addCurrentSegment=function(){if(0===current.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field path ('+path+'). Paths must not be empty, begin '+'with \'.\', end with \'.\', or contain \'..\'');segments.push(current),current=''},inBackticks=!1,c;i<path.length;)if(c=path[i],'\\'===c){if(i+1===path.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Path has trailing escape character: '+path);var next=path[i+1];if('\\'!==next&&'.'!==next&&'`'!==next)throw new FirestoreError(Code.INVALID_ARGUMENT,'Path has invalid escape sequence: '+path);current+=next,i+=2}else'`'===c?(inBackticks=!inBackticks,i++):'.'!==c||inBackticks?(current+=c,i++):(addCurrentSegment(),i++);if(addCurrentSegment(),inBackticks)throw new FirestoreError(Code.INVALID_ARGUMENT,'Unterminated ` in path: '+path);return new FieldPath(segments)},FieldPath.EMPTY_PATH=new FieldPath([]),FieldPath}(Path),DocumentKey=function(){function DocumentKey(path){this.path=path,assert(DocumentKey.isDocumentKey(path),'Invalid DocumentKey with an odd number of segments: '+path.toArray().join('/'))}return DocumentKey.prototype.isEqual=function(other){return null!==other&&0===ResourcePath.comparator(this.path,other.path)},DocumentKey.prototype.toString=function(){return this.path.toString()},DocumentKey.comparator=function(k1,k2){return ResourcePath.comparator(k1.path,k2.path)},DocumentKey.isDocumentKey=function(path){return 0==path.length%2},DocumentKey.fromSegments=function(segments){return new DocumentKey(new ResourcePath(segments.slice()))},DocumentKey.fromPathString=function(path){return new DocumentKey(ResourcePath.fromString(path))},DocumentKey.EMPTY=new DocumentKey(new ResourcePath([])),DocumentKey}(),MaybeDocument=function(){function MaybeDocument(key,version){this.key=key,this.version=version}return MaybeDocument.compareByKey=function(d1,d2){return DocumentKey.comparator(d1.key,d2.key)},MaybeDocument}(),Document=function(_super){function Document(key,version,data,options){var _this=_super.call(this,key,version)||this;return _this.data=data,_this.hasLocalMutations=!!options.hasLocalMutations,_this.hasCommittedMutations=!!options.hasCommittedMutations,_this}return tslib_1.__extends(Document,_super),Document.prototype.field=function(path){return this.data.field(path)},Document.prototype.fieldValue=function(path){var field=this.field(path);return field?field.value():void 0},Document.prototype.value=function(){return this.data.value()},Document.prototype.isEqual=function(other){return other instanceof Document&&this.key.isEqual(other.key)&&this.version.isEqual(other.version)&&this.data.isEqual(other.data)&&this.hasLocalMutations===other.hasLocalMutations&&this.hasCommittedMutations===other.hasCommittedMutations},Document.prototype.toString=function(){return'Document('+this.key+', '+this.version+', '+this.data.toString()+', '+('{hasLocalMutations: '+this.hasLocalMutations+'}), ')+('{hasCommittedMutations: '+this.hasCommittedMutations+'})')},Object.defineProperty(Document.prototype,'hasPendingWrites',{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Document.compareByField=function(field,d1,d2){var v1=d1.field(field),v2=d2.field(field);return void 0!==v1&&void 0!==v2?v1.compareTo(v2):fail('Trying to compare documents on fields that don\'t exist')},Document}(MaybeDocument),NoDocument=function(_super){function NoDocument(key,version,options){var _this=_super.call(this,key,version)||this;return _this.hasCommittedMutations=!!(options&&options.hasCommittedMutations),_this}return tslib_1.__extends(NoDocument,_super),NoDocument.prototype.toString=function(){return'NoDocument('+this.key+', '+this.version+')'},Object.defineProperty(NoDocument.prototype,'hasPendingWrites',{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),NoDocument.prototype.isEqual=function(other){return other instanceof NoDocument&&other.hasCommittedMutations===this.hasCommittedMutations&&other.version.isEqual(this.version)&&other.key.isEqual(this.key)},NoDocument}(MaybeDocument),UnknownDocument=function(_super){function UnknownDocument(key,version){return _super.call(this,key,version)||this}return tslib_1.__extends(UnknownDocument,_super),UnknownDocument.prototype.toString=function(){return'UnknownDocument('+this.key+', '+this.version+')'},Object.defineProperty(UnknownDocument.prototype,'hasPendingWrites',{get:function(){return!0},enumerable:!0,configurable:!0}),UnknownDocument.prototype.isEqual=function(other){return other instanceof UnknownDocument&&other.version.isEqual(this.version)&&other.key.isEqual(this.key)},UnknownDocument}(MaybeDocument),SortedMap=function(){function SortedMap(comparator,root){this.comparator=comparator,this.root=root?root:LLRBNode.EMPTY}return SortedMap.prototype.insert=function(key,value){return new SortedMap(this.comparator,this.root.insert(key,value,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.remove=function(key){return new SortedMap(this.comparator,this.root.remove(key,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.get=function(key){for(var node=this.root,cmp;!node.isEmpty();){if(cmp=this.comparator(key,node.key),0===cmp)return node.value;0>cmp?node=node.left:0<cmp&&(node=node.right)}return null},SortedMap.prototype.indexOf=function(key){for(var prunedNodes=0,node=this.root,cmp;!node.isEmpty();){if(cmp=this.comparator(key,node.key),0===cmp)return prunedNodes+node.left.size;0>cmp?node=node.left:(prunedNodes+=node.left.size+1,node=node.right)}return-1},SortedMap.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(SortedMap.prototype,'size',{get:function(){return this.root.size},enumerable:!0,configurable:!0}),SortedMap.prototype.minKey=function(){return this.root.minKey()},SortedMap.prototype.maxKey=function(){return this.root.maxKey()},SortedMap.prototype.inorderTraversal=function(action){return this.root.inorderTraversal(action)},SortedMap.prototype.forEach=function(fn){this.inorderTraversal(function(k,v){return fn(k,v),!1})},SortedMap.prototype.reverseTraversal=function(action){return this.root.reverseTraversal(action)},SortedMap.prototype.getIterator=function(){return new SortedMapIterator(this.root,null,this.comparator,!1)},SortedMap.prototype.getIteratorFrom=function(key){return new SortedMapIterator(this.root,key,this.comparator,!1)},SortedMap.prototype.getReverseIterator=function(){return new SortedMapIterator(this.root,null,this.comparator,!0)},SortedMap.prototype.getReverseIteratorFrom=function(key){return new SortedMapIterator(this.root,key,this.comparator,!0)},SortedMap}(),SortedMapIterator=function(){function SortedMapIterator(node,startKey,comparator,isReverse){this.isReverse=isReverse,this.nodeStack=[];for(var cmp=1;!node.isEmpty();)if(cmp=startKey?comparator(node.key,startKey):1,isReverse&&(cmp*=-1),0>cmp)node=this.isReverse?node.left:node.right;else if(0===cmp){this.nodeStack.push(node);break}else this.nodeStack.push(node),node=this.isReverse?node.right:node.left}return SortedMapIterator.prototype.getNext=function(){assert(0<this.nodeStack.length,'getNext() called on iterator when hasNext() is false.');var node=this.nodeStack.pop(),result={key:node.key,value:node.value};if(this.isReverse)for(node=node.left;!node.isEmpty();)this.nodeStack.push(node),node=node.right;else for(node=node.right;!node.isEmpty();)this.nodeStack.push(node),node=node.left;return result},SortedMapIterator.prototype.hasNext=function(){return 0<this.nodeStack.length},SortedMapIterator.prototype.peek=function(){if(0===this.nodeStack.length)return null;var node=this.nodeStack[this.nodeStack.length-1];return{key:node.key,value:node.value}},SortedMapIterator}(),LLRBNode=function(){function LLRBNode(key,value,color,left,right){this.key=key,this.value=value,this.color=null==color?LLRBNode.RED:color,this.left=null==left?LLRBNode.EMPTY:left,this.right=null==right?LLRBNode.EMPTY:right,this.size=this.left.size+1+this.right.size}return LLRBNode.prototype.copy=function(key,value,color,left,right){return new LLRBNode(null==key?this.key:key,null==value?this.value:value,null==color?this.color:color,null==left?this.left:left,null==right?this.right:right)},LLRBNode.prototype.isEmpty=function(){return!1},LLRBNode.prototype.inorderTraversal=function(action){return this.left.inorderTraversal(action)||action(this.key,this.value)||this.right.inorderTraversal(action)},LLRBNode.prototype.reverseTraversal=function(action){return this.right.reverseTraversal(action)||action(this.key,this.value)||this.left.reverseTraversal(action)},LLRBNode.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},LLRBNode.prototype.minKey=function(){return this.min().key},LLRBNode.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},LLRBNode.prototype.insert=function(key,value,comparator){var n=this,cmp=comparator(key,n.key);return n=0>cmp?n.copy(null,null,null,n.left.insert(key,value,comparator),null):0===cmp?n.copy(null,value,null,null,null):n.copy(null,null,null,null,n.right.insert(key,value,comparator)),n.fixUp()},LLRBNode.prototype.removeMin=function(){if(this.left.isEmpty())return LLRBNode.EMPTY;var n=this;return n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.removeMin(),null),n.fixUp()},LLRBNode.prototype.remove=function(key,comparator){var n=this,smallest;if(0>comparator(key,n.key))n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(key,comparator),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===comparator(key,n.key)){if(n.right.isEmpty())return LLRBNode.EMPTY;smallest=n.right.min(),n=n.copy(smallest.key,smallest.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(key,comparator))}return n.fixUp()},LLRBNode.prototype.isRed=function(){return this.color},LLRBNode.prototype.fixUp=function(){var n=this;return n.right.isRed()&&!n.left.isRed()&&(n=n.rotateLeft()),n.left.isRed()&&n.left.left.isRed()&&(n=n.rotateRight()),n.left.isRed()&&n.right.isRed()&&(n=n.colorFlip()),n},LLRBNode.prototype.moveRedLeft=function(){var n=this.colorFlip();return n.right.left.isRed()&&(n=n.copy(null,null,null,null,n.right.rotateRight()),n=n.rotateLeft(),n=n.colorFlip()),n},LLRBNode.prototype.moveRedRight=function(){var n=this.colorFlip();return n.left.left.isRed()&&(n=n.rotateRight(),n=n.colorFlip()),n},LLRBNode.prototype.rotateLeft=function(){var nl=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,nl,null)},LLRBNode.prototype.rotateRight=function(){var nr=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,nr)},LLRBNode.prototype.colorFlip=function(){var left=this.left.copy(null,null,!this.left.color,null,null),right=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,left,right)},LLRBNode.prototype.checkMaxDepth=function(){var blackDepth=this.check();return!!(Math.pow(2,blackDepth)<=this.size+1)},LLRBNode.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw fail('Red node has red child('+this.key+','+this.value+')');if(this.right.isRed())throw fail('Right child of ('+this.key+','+this.value+') is red');var blackDepth=this.left.check();if(blackDepth!==this.right.check())throw fail('Black depths differ');else return blackDepth+(this.isRed()?0:1)},LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1,LLRBNode}(),LLRBEmptyNode=function(){function LLRBEmptyNode(){this.size=0}return LLRBEmptyNode.prototype.copy=function(){return this},LLRBEmptyNode.prototype.insert=function(key,value){return new LLRBNode(key,value)},LLRBEmptyNode.prototype.remove=function(){return this},LLRBEmptyNode.prototype.isEmpty=function(){return!0},LLRBEmptyNode.prototype.inorderTraversal=function(){return!1},LLRBEmptyNode.prototype.reverseTraversal=function(){return!1},LLRBEmptyNode.prototype.minKey=function(){return null},LLRBEmptyNode.prototype.maxKey=function(){return null},LLRBEmptyNode.prototype.isRed=function(){return!1},LLRBEmptyNode.prototype.checkMaxDepth=function(){return!0},LLRBEmptyNode.prototype.check=function(){return 0},LLRBEmptyNode}();LLRBNode.EMPTY=new LLRBEmptyNode;var TypeOrder;(function(TypeOrder){TypeOrder[TypeOrder.NullValue=0]='NullValue',TypeOrder[TypeOrder.BooleanValue=1]='BooleanValue',TypeOrder[TypeOrder.NumberValue=2]='NumberValue',TypeOrder[TypeOrder.TimestampValue=3]='TimestampValue',TypeOrder[TypeOrder.StringValue=4]='StringValue',TypeOrder[TypeOrder.BlobValue=5]='BlobValue',TypeOrder[TypeOrder.RefValue=6]='RefValue',TypeOrder[TypeOrder.GeoPointValue=7]='GeoPointValue',TypeOrder[TypeOrder.ArrayValue=8]='ArrayValue',TypeOrder[TypeOrder.ObjectValue=9]='ObjectValue'})(TypeOrder||(TypeOrder={}));var ServerTimestampBehavior;(function(ServerTimestampBehavior){ServerTimestampBehavior[ServerTimestampBehavior.Default=0]='Default',ServerTimestampBehavior[ServerTimestampBehavior.Estimate=1]='Estimate',ServerTimestampBehavior[ServerTimestampBehavior.Previous=2]='Previous'})(ServerTimestampBehavior||(ServerTimestampBehavior={}));var FieldValueOptions=function(){function FieldValueOptions(serverTimestampBehavior,timestampsInSnapshots){this.serverTimestampBehavior=serverTimestampBehavior,this.timestampsInSnapshots=timestampsInSnapshots}return FieldValueOptions.fromSnapshotOptions=function(options,timestampsInSnapshots){switch(options.serverTimestamps){case'estimate':return new FieldValueOptions(ServerTimestampBehavior.Estimate,timestampsInSnapshots);case'previous':return new FieldValueOptions(ServerTimestampBehavior.Previous,timestampsInSnapshots);case'none':case void 0:return new FieldValueOptions(ServerTimestampBehavior.Default,timestampsInSnapshots);default:return fail('fromSnapshotOptions() called with invalid options.');}},FieldValueOptions}(),FieldValue=function(){function FieldValue(){}return FieldValue.prototype.toString=function(){var val=this.value();return null===val?'null':val.toString()},FieldValue.prototype.defaultCompareTo=function(other){assert(this.typeOrder!==other.typeOrder,'Default compareTo should not be used for values of same type.');var cmp=primitiveComparator(this.typeOrder,other.typeOrder);return cmp},FieldValue}(),NullValue=function(_super){function NullValue(){var _this=_super.call(this)||this;return _this.typeOrder=TypeOrder.NullValue,_this.internalValue=null,_this}return tslib_1.__extends(NullValue,_super),NullValue.prototype.value=function(){return null},NullValue.prototype.isEqual=function(other){return other instanceof NullValue},NullValue.prototype.compareTo=function(other){return other instanceof NullValue?0:this.defaultCompareTo(other)},NullValue.INSTANCE=new NullValue,NullValue}(FieldValue),BooleanValue=function(_super){function BooleanValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.BooleanValue,_this}return tslib_1.__extends(BooleanValue,_super),BooleanValue.prototype.value=function(){return this.internalValue},BooleanValue.prototype.isEqual=function(other){return other instanceof BooleanValue&&this.internalValue===other.internalValue},BooleanValue.prototype.compareTo=function(other){return other instanceof BooleanValue?primitiveComparator(this,other):this.defaultCompareTo(other)},BooleanValue.of=function(value){return value?BooleanValue.TRUE:BooleanValue.FALSE},BooleanValue.TRUE=new BooleanValue(!0),BooleanValue.FALSE=new BooleanValue(!1),BooleanValue}(FieldValue),NumberValue=function(_super){function NumberValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.NumberValue,_this}return tslib_1.__extends(NumberValue,_super),NumberValue.prototype.value=function(){return this.internalValue},NumberValue.prototype.compareTo=function(other){return other instanceof NumberValue?numericComparator(this.internalValue,other.internalValue):this.defaultCompareTo(other)},NumberValue}(FieldValue),IntegerValue=function(_super){function IntegerValue(internalValue){return _super.call(this,internalValue)||this}return tslib_1.__extends(IntegerValue,_super),IntegerValue.prototype.isEqual=function(other){return!!(other instanceof IntegerValue)&&numericEquals(this.internalValue,other.internalValue)},IntegerValue}(NumberValue),DoubleValue=function(_super){function DoubleValue(internalValue){var _this=_super.call(this,internalValue)||this;return _this.internalValue=internalValue,_this}return tslib_1.__extends(DoubleValue,_super),DoubleValue.prototype.isEqual=function(other){return!!(other instanceof DoubleValue)&&numericEquals(this.internalValue,other.internalValue)},DoubleValue.NAN=new DoubleValue(NaN),DoubleValue.POSITIVE_INFINITY=new DoubleValue(Infinity),DoubleValue.NEGATIVE_INFINITY=new DoubleValue(-Infinity),DoubleValue}(NumberValue),StringValue=function(_super){function StringValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.StringValue,_this}return tslib_1.__extends(StringValue,_super),StringValue.prototype.value=function(){return this.internalValue},StringValue.prototype.isEqual=function(other){return other instanceof StringValue&&this.internalValue===other.internalValue},StringValue.prototype.compareTo=function(other){return other instanceof StringValue?primitiveComparator(this.internalValue,other.internalValue):this.defaultCompareTo(other)},StringValue}(FieldValue),TimestampValue=function(_super){function TimestampValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.TimestampValue,_this}return tslib_1.__extends(TimestampValue,_super),TimestampValue.prototype.value=function(options){return options&&options.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},TimestampValue.prototype.isEqual=function(other){return other instanceof TimestampValue&&this.internalValue.isEqual(other.internalValue)},TimestampValue.prototype.compareTo=function(other){return other instanceof TimestampValue?this.internalValue._compareTo(other.internalValue):other instanceof ServerTimestampValue?-1:this.defaultCompareTo(other)},TimestampValue}(FieldValue),ServerTimestampValue=function(_super){function ServerTimestampValue(localWriteTime,previousValue){var _this=_super.call(this)||this;return _this.localWriteTime=localWriteTime,_this.previousValue=previousValue,_this.typeOrder=TypeOrder.TimestampValue,_this}return tslib_1.__extends(ServerTimestampValue,_super),ServerTimestampValue.prototype.value=function(options){return options&&options.serverTimestampBehavior===ServerTimestampBehavior.Estimate?new TimestampValue(this.localWriteTime).value(options):options&&options.serverTimestampBehavior===ServerTimestampBehavior.Previous?this.previousValue?this.previousValue.value(options):null:null},ServerTimestampValue.prototype.isEqual=function(other){return other instanceof ServerTimestampValue&&this.localWriteTime.isEqual(other.localWriteTime)},ServerTimestampValue.prototype.compareTo=function(other){return other instanceof ServerTimestampValue?this.localWriteTime._compareTo(other.localWriteTime):other instanceof TimestampValue?1:this.defaultCompareTo(other)},ServerTimestampValue.prototype.toString=function(){return'<ServerTimestamp localTime='+this.localWriteTime.toString()+'>'},ServerTimestampValue}(FieldValue),BlobValue=function(_super){function BlobValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.BlobValue,_this}return tslib_1.__extends(BlobValue,_super),BlobValue.prototype.value=function(){return this.internalValue},BlobValue.prototype.isEqual=function(other){return other instanceof BlobValue&&this.internalValue.isEqual(other.internalValue)},BlobValue.prototype.compareTo=function(other){return other instanceof BlobValue?this.internalValue._compareTo(other.internalValue):this.defaultCompareTo(other)},BlobValue}(FieldValue),RefValue=function(_super){function RefValue(databaseId,key){var _this=_super.call(this)||this;return _this.databaseId=databaseId,_this.key=key,_this.typeOrder=TypeOrder.RefValue,_this}return tslib_1.__extends(RefValue,_super),RefValue.prototype.value=function(){return this.key},RefValue.prototype.isEqual=function(other){return!!(other instanceof RefValue)&&this.key.isEqual(other.key)&&this.databaseId.isEqual(other.databaseId)},RefValue.prototype.compareTo=function(other){if(other instanceof RefValue){var cmp=this.databaseId.compareTo(other.databaseId);return 0===cmp?DocumentKey.comparator(this.key,other.key):cmp}return this.defaultCompareTo(other)},RefValue}(FieldValue),GeoPointValue=function(_super){function GeoPointValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.GeoPointValue,_this}return tslib_1.__extends(GeoPointValue,_super),GeoPointValue.prototype.value=function(){return this.internalValue},GeoPointValue.prototype.isEqual=function(other){return other instanceof GeoPointValue&&this.internalValue.isEqual(other.internalValue)},GeoPointValue.prototype.compareTo=function(other){return other instanceof GeoPointValue?this.internalValue._compareTo(other.internalValue):this.defaultCompareTo(other)},GeoPointValue}(FieldValue),ObjectValue=function(_super){function ObjectValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.ObjectValue,_this}return tslib_1.__extends(ObjectValue,_super),ObjectValue.prototype.value=function(options){var result={};return this.internalValue.inorderTraversal(function(key,val){result[key]=val.value(options)}),result},ObjectValue.prototype.forEach=function(action){this.internalValue.inorderTraversal(action)},ObjectValue.prototype.isEqual=function(other){if(other instanceof ObjectValue){for(var it1=this.internalValue.getIterator(),it2=other.internalValue.getIterator();it1.hasNext()&&it2.hasNext();){var next1=it1.getNext(),next2=it2.getNext();if(next1.key!==next2.key||!next1.value.isEqual(next2.value))return!1}return!it1.hasNext()&&!it2.hasNext()}return!1},ObjectValue.prototype.compareTo=function(other){if(other instanceof ObjectValue){for(var it1=this.internalValue.getIterator(),it2=other.internalValue.getIterator();it1.hasNext()&&it2.hasNext();){var next1=it1.getNext(),next2=it2.getNext(),cmp=primitiveComparator(next1.key,next2.key)||next1.value.compareTo(next2.value);if(cmp)return cmp}return primitiveComparator(it1.hasNext(),it2.hasNext())}return this.defaultCompareTo(other)},ObjectValue.prototype.set=function(path,to){if(assert(!path.isEmpty(),'Cannot set field for empty path on ObjectValue'),1===path.length)return this.setChild(path.firstSegment(),to);var child=this.child(path.firstSegment());child instanceof ObjectValue||(child=ObjectValue.EMPTY);var newChild=child.set(path.popFirst(),to);return this.setChild(path.firstSegment(),newChild)},ObjectValue.prototype.delete=function(path){if(assert(!path.isEmpty(),'Cannot delete field for empty path on ObjectValue'),1===path.length)return new ObjectValue(this.internalValue.remove(path.firstSegment()));var child=this.child(path.firstSegment());if(child instanceof ObjectValue){var newChild=child.delete(path.popFirst());return new ObjectValue(this.internalValue.insert(path.firstSegment(),newChild))}return this},ObjectValue.prototype.contains=function(path){return void 0!==this.field(path)},ObjectValue.prototype.field=function(path){assert(!path.isEmpty(),'Can\'t get field of empty path');var field=this;return path.forEach(function(pathSegment){field=field instanceof ObjectValue?field.internalValue.get(pathSegment)||void 0:void 0}),field},ObjectValue.prototype.toString=function(){return JSON.stringify(this.value())},ObjectValue.prototype.child=function(childName){return this.internalValue.get(childName)||void 0},ObjectValue.prototype.setChild=function(childName,value){return new ObjectValue(this.internalValue.insert(childName,value))},ObjectValue.EMPTY=new ObjectValue(new SortedMap(primitiveComparator)),ObjectValue}(FieldValue),ArrayValue=function(_super){function ArrayValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.ArrayValue,_this}return tslib_1.__extends(ArrayValue,_super),ArrayValue.prototype.value=function(options){return this.internalValue.map(function(v){return v.value(options)})},ArrayValue.prototype.forEach=function(action){this.internalValue.forEach(action)},ArrayValue.prototype.isEqual=function(other){if(other instanceof ArrayValue){if(this.internalValue.length!==other.internalValue.length)return!1;for(var i=0;i<this.internalValue.length;i++)if(!this.internalValue[i].isEqual(other.internalValue[i]))return!1;return!0}return!1},ArrayValue.prototype.compareTo=function(other){if(other instanceof ArrayValue){for(var minLength=_Mathmin(this.internalValue.length,other.internalValue.length),i=0,cmp;i<minLength;i++)if(cmp=this.internalValue[i].compareTo(other.internalValue[i]),cmp)return cmp;return primitiveComparator(this.internalValue.length,other.internalValue.length)}return this.defaultCompareTo(other)},ArrayValue.prototype.toString=function(){return JSON.stringify(this.value())},ArrayValue}(FieldValue),NumberAsAny=Number,MIN_SAFE_INTEGER=NumberAsAny.MIN_SAFE_INTEGER||-(9007199254740992-1),MAX_SAFE_INTEGER=NumberAsAny.MAX_SAFE_INTEGER||9007199254740992-1,isInteger=NumberAsAny.isInteger||function(value){return'number'==typeof value&&isFinite(value)&&_Mathfloor(value)===value},Query=function(){function Query(path,explicitOrderBy,filters,limit,startAt,endAt){void 0===explicitOrderBy&&(explicitOrderBy=[]),void 0===filters&&(filters=[]),void 0===limit&&(limit=null),void 0===startAt&&(startAt=null),void 0===endAt&&(endAt=null),this.path=path,this.explicitOrderBy=explicitOrderBy,this.filters=filters,this.limit=limit,this.startAt=startAt,this.endAt=endAt,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return Query.atPath=function(path){return new Query(path)},Object.defineProperty(Query.prototype,'orderBy',{get:function(){if(null===this.memoizedOrderBy){var inequalityField=this.getInequalityFilterField(),firstOrderByField=this.getFirstOrderByField();if(null!==inequalityField&&null===firstOrderByField)this.memoizedOrderBy=inequalityField.isKeyField()?[KEY_ORDERING_ASC]:[new OrderBy(inequalityField),KEY_ORDERING_ASC];else{assert(null===inequalityField||null!==firstOrderByField&&inequalityField.isEqual(firstOrderByField),'First orderBy should match inequality field.'),this.memoizedOrderBy=[];for(var foundKeyOrdering=!1,_i=0,_a=this.explicitOrderBy,orderBy;_i<_a.length;_i++)orderBy=_a[_i],this.memoizedOrderBy.push(orderBy),orderBy.field.isKeyField()&&(foundKeyOrdering=!0);if(!foundKeyOrdering){var lastDirection=0<this.explicitOrderBy.length?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Direction.ASCENDING;this.memoizedOrderBy.push(lastDirection===Direction.ASCENDING?KEY_ORDERING_ASC:KEY_ORDERING_DESC)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),Query.prototype.addFilter=function(filter){assert(null==this.getInequalityFilterField()||!(filter instanceof RelationFilter)||!filter.isInequality()||filter.field.isEqual(this.getInequalityFilterField()),'Query must only have one inequality field.'),assert(!DocumentKey.isDocumentKey(this.path),'No filtering allowed for document query');var newFilters=this.filters.concat([filter]);return new Query(this.path,this.explicitOrderBy.slice(),newFilters,this.limit,this.startAt,this.endAt)},Query.prototype.addOrderBy=function(orderBy){assert(!DocumentKey.isDocumentKey(this.path),'No ordering allowed for document query'),assert(!this.startAt&&!this.endAt,'Bounds must be set after orderBy');var newOrderBy=this.explicitOrderBy.concat([orderBy]);return new Query(this.path,newOrderBy,this.filters.slice(),this.limit,this.startAt,this.endAt)},Query.prototype.withLimit=function(limit){return new Query(this.path,this.explicitOrderBy.slice(),this.filters.slice(),limit,this.startAt,this.endAt)},Query.prototype.withStartAt=function(bound){return new Query(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,bound,this.endAt)},Query.prototype.withEndAt=function(bound){return new Query(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,bound)},Query.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var canonicalId=this.path.canonicalString();canonicalId+='|f:';for(var _i=0,_a=this.filters,filter;_i<_a.length;_i++)filter=_a[_i],canonicalId+=filter.canonicalId(),canonicalId+=',';canonicalId+='|ob:';for(var _b=0,_c=this.orderBy,orderBy;_b<_c.length;_b++)orderBy=_c[_b],canonicalId+=orderBy.canonicalId(),canonicalId+=',';isNullOrUndefined(this.limit)||(canonicalId+='|l:',canonicalId+=this.limit),this.startAt&&(canonicalId+='|lb:',canonicalId+=this.startAt.canonicalId()),this.endAt&&(canonicalId+='|ub:',canonicalId+=this.endAt.canonicalId()),this.memoizedCanonicalId=canonicalId}return this.memoizedCanonicalId},Query.prototype.toString=function(){var str='Query('+this.path.canonicalString();return 0<this.filters.length&&(str+=', filters: ['+this.filters.join(', ')+']'),isNullOrUndefined(this.limit)||(str+=', limit: '+this.limit),0<this.explicitOrderBy.length&&(str+=', orderBy: ['+this.explicitOrderBy.join(', ')+']'),this.startAt&&(str+=', startAt: '+this.startAt.canonicalId()),this.endAt&&(str+=', endAt: '+this.endAt.canonicalId()),str+')'},Query.prototype.isEqual=function(other){if(this.limit!==other.limit)return!1;if(this.orderBy.length!==other.orderBy.length)return!1;for(var i=0;i<this.orderBy.length;i++)if(!this.orderBy[i].isEqual(other.orderBy[i]))return!1;if(this.filters.length!==other.filters.length)return!1;for(var i=0;i<this.filters.length;i++)if(!this.filters[i].isEqual(other.filters[i]))return!1;return!!this.path.isEqual(other.path)&&(null===this.startAt?null===other.startAt:!!this.startAt.isEqual(other.startAt))&&(null===this.endAt?null===other.endAt:this.endAt.isEqual(other.endAt))},Query.prototype.docComparator=function(d1,d2){for(var comparedOnKeyField=!1,_i=0,_a=this.orderBy;_i<_a.length;_i++){var orderBy=_a[_i],comp=orderBy.compare(d1,d2);if(0!==comp)return comp;comparedOnKeyField=comparedOnKeyField||orderBy.field.isKeyField()}return assert(comparedOnKeyField,'orderBy used that doesn\'t compare on key field'),0},Query.prototype.matches=function(doc){return this.matchesAncestor(doc)&&this.matchesOrderBy(doc)&&this.matchesFilters(doc)&&this.matchesBounds(doc)},Query.prototype.hasLimit=function(){return!isNullOrUndefined(this.limit)},Query.prototype.getFirstOrderByField=function(){return 0<this.explicitOrderBy.length?this.explicitOrderBy[0].field:null},Query.prototype.getInequalityFilterField=function(){for(var _i=0,_a=this.filters,filter;_i<_a.length;_i++)if(filter=_a[_i],filter instanceof RelationFilter&&filter.isInequality())return filter.field;return null},Query.prototype.hasArrayContainsFilter=function(){return void 0!==this.filters.find(function(filter){return filter instanceof RelationFilter&&filter.op===RelationOp.ARRAY_CONTAINS})},Query.prototype.isDocumentQuery=function(){return DocumentKey.isDocumentKey(this.path)&&0===this.filters.length},Query.prototype.matchesAncestor=function(doc){var docPath=doc.key.path;return DocumentKey.isDocumentKey(this.path)?this.path.isEqual(docPath):this.path.isPrefixOf(docPath)&&this.path.length===docPath.length-1},Query.prototype.matchesOrderBy=function(doc){for(var _i=0,_a=this.explicitOrderBy,orderBy;_i<_a.length;_i++)if(orderBy=_a[_i],!orderBy.field.isKeyField()&&void 0===doc.field(orderBy.field))return!1;return!0},Query.prototype.matchesFilters=function(doc){for(var _i=0,_a=this.filters,filter;_i<_a.length;_i++)if(filter=_a[_i],!filter.matches(doc))return!1;return!0},Query.prototype.matchesBounds=function(doc){return this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,doc)?!1:this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,doc)?!1:!0},Query.prototype.assertValidBound=function(bound){assert(bound.position.length<=this.orderBy.length,'Bound is longer than orderBy')},Query}(),Filter=function(){function Filter(){}return Filter.create=function(field,op,value){if(value.isEqual(NullValue.INSTANCE)){if(op!==RelationOp.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You can only perform equals comparisons on null.');return new NullFilter(field)}if(value.isEqual(DoubleValue.NAN)){if(op!==RelationOp.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You can only perform equals comparisons on NaN.');return new NanFilter(field)}return new RelationFilter(field,op,value)},Filter}(),RelationOp=function(){function RelationOp(name){this.name=name}return RelationOp.fromString=function(op){return'<'===op?RelationOp.LESS_THAN:'<='===op?RelationOp.LESS_THAN_OR_EQUAL:'=='===op?RelationOp.EQUAL:'>='===op?RelationOp.GREATER_THAN_OR_EQUAL:'>'===op?RelationOp.GREATER_THAN:'array-contains'===op?RelationOp.ARRAY_CONTAINS:fail('Unknown relation: '+op)},RelationOp.prototype.toString=function(){return this.name},RelationOp.prototype.isEqual=function(other){return this.name===other.name},RelationOp.LESS_THAN=new RelationOp('<'),RelationOp.LESS_THAN_OR_EQUAL=new RelationOp('<='),RelationOp.EQUAL=new RelationOp('=='),RelationOp.GREATER_THAN=new RelationOp('>'),RelationOp.GREATER_THAN_OR_EQUAL=new RelationOp('>='),RelationOp.ARRAY_CONTAINS=new RelationOp('array-contains'),RelationOp}(),RelationFilter=function(_super){function RelationFilter(field,op,value){var _this=_super.call(this)||this;return _this.field=field,_this.op=op,_this.value=value,_this}return tslib_1.__extends(RelationFilter,_super),RelationFilter.prototype.matches=function(doc){if(this.field.isKeyField()){assert(this.value instanceof RefValue,'Comparing on key, but filter value not a RefValue'),assert(this.op!==RelationOp.ARRAY_CONTAINS,'array-contains queries don\'t make sense on document keys.');var refValue=this.value,comparison=DocumentKey.comparator(doc.key,refValue.key);return this.matchesComparison(comparison)}var val=doc.field(this.field);return void 0!==val&&this.matchesValue(val)},RelationFilter.prototype.matchesValue=function(value){var _this=this;return this.op===RelationOp.ARRAY_CONTAINS?value instanceof ArrayValue&&void 0!==value.internalValue.find(function(element){return element.isEqual(_this.value)}):this.value.typeOrder===value.typeOrder&&this.matchesComparison(value.compareTo(this.value))},RelationFilter.prototype.matchesComparison=function(comparison){switch(this.op){case RelationOp.LESS_THAN:return 0>comparison;case RelationOp.LESS_THAN_OR_EQUAL:return 0>=comparison;case RelationOp.EQUAL:return 0===comparison;case RelationOp.GREATER_THAN:return 0<comparison;case RelationOp.GREATER_THAN_OR_EQUAL:return 0<=comparison;default:return fail('Unknown relation op'+this.op);}},RelationFilter.prototype.isInequality=function(){return this.op!==RelationOp.EQUAL&&this.op!==RelationOp.ARRAY_CONTAINS},RelationFilter.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},RelationFilter.prototype.isEqual=function(other){return!!(other instanceof RelationFilter)&&this.op.isEqual(other.op)&&this.field.isEqual(other.field)&&this.value.isEqual(other.value)},RelationFilter.prototype.toString=function(){return this.field.canonicalString()+' '+this.op+' '+this.value.value()},RelationFilter}(Filter),NullFilter=function(_super){function NullFilter(field){var _this=_super.call(this)||this;return _this.field=field,_this}return tslib_1.__extends(NullFilter,_super),NullFilter.prototype.matches=function(doc){var val=doc.field(this.field);return void 0!==val&&null===val.value()},NullFilter.prototype.canonicalId=function(){return this.field.canonicalString()+' IS null'},NullFilter.prototype.toString=function(){return this.field.canonicalString()+' IS null'},NullFilter.prototype.isEqual=function(other){return!!(other instanceof NullFilter)&&this.field.isEqual(other.field)},NullFilter}(Filter),NanFilter=function(_super){function NanFilter(field){var _this=_super.call(this)||this;return _this.field=field,_this}return tslib_1.__extends(NanFilter,_super),NanFilter.prototype.matches=function(doc){var field=doc.field(this.field),val=field&&field.value();return'number'==typeof val&&isNaN(val)},NanFilter.prototype.canonicalId=function(){return this.field.canonicalString()+' IS NaN'},NanFilter.prototype.toString=function(){return this.field.canonicalString()+' IS NaN'},NanFilter.prototype.isEqual=function(other){return!!(other instanceof NanFilter)&&this.field.isEqual(other.field)},NanFilter}(Filter),Direction=function(){function Direction(name){this.name=name}return Direction.prototype.toString=function(){return this.name},Direction.ASCENDING=new Direction('asc'),Direction.DESCENDING=new Direction('desc'),Direction}(),Bound=function(){function Bound(position,before){this.position=position,this.before=before}return Bound.prototype.canonicalId=function(){for(var canonicalId=this.before?'b:':'a:',_i=0,_a=this.position,component;_i<_a.length;_i++)component=_a[_i],canonicalId+=component.toString();return canonicalId},Bound.prototype.sortsBeforeDocument=function(orderBy,doc){assert(this.position.length<=orderBy.length,'Bound has more components than query\'s orderBy');for(var comparison=0,i=0;i<this.position.length;i++){var orderByComponent=orderBy[i],component=this.position[i];if(orderByComponent.field.isKeyField())assert(component instanceof RefValue,'Bound has a non-key value where the key path is being used.'),comparison=DocumentKey.comparator(component.key,doc.key);else{var docValue=doc.field(orderByComponent.field);assert(void 0!==docValue,'Field should exist since document matched the orderBy already.'),comparison=component.compareTo(docValue)}if(orderByComponent.dir===Direction.DESCENDING&&(comparison*=-1),0!==comparison)break}return this.before?0>=comparison:0>comparison},Bound.prototype.isEqual=function(other){if(null===other)return!1;if(this.before!==other.before||this.position.length!==other.position.length)return!1;for(var i=0;i<this.position.length;i++){var thisPosition=this.position[i],otherPosition=other.position[i];return thisPosition.isEqual(otherPosition)}return!0},Bound}(),OrderBy=function(){function OrderBy(field,dir){this.field=field,void 0===dir&&(dir=Direction.ASCENDING),this.dir=dir,this.isKeyOrderBy=field.isKeyField()}return OrderBy.prototype.compare=function(d1,d2){var comparison=this.isKeyOrderBy?Document.compareByKey(d1,d2):Document.compareByField(this.field,d1,d2);switch(this.dir){case Direction.ASCENDING:return comparison;case Direction.DESCENDING:return-1*comparison;default:return fail('Unknown direction: '+this.dir);}},OrderBy.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},OrderBy.prototype.toString=function(){return this.field.canonicalString()+' ('+this.dir+')'},OrderBy.prototype.isEqual=function(other){return this.dir===other.dir&&this.field.isEqual(other.field)},OrderBy}(),KEY_ORDERING_ASC=new OrderBy(FieldPath.keyField(),Direction.ASCENDING),KEY_ORDERING_DESC=new OrderBy(FieldPath.keyField(),Direction.DESCENDING),SnapshotVersion=function(){function SnapshotVersion(timestamp){this.timestamp=timestamp}return SnapshotVersion.fromMicroseconds=function(value){var seconds=_Mathfloor(value/1e6);return new SnapshotVersion(new Timestamp(seconds,1e3*(value%1e6)))},SnapshotVersion.fromTimestamp=function(value){return new SnapshotVersion(value)},SnapshotVersion.forDeletedDoc=function(){return SnapshotVersion.MIN},SnapshotVersion.prototype.compareTo=function(other){return this.timestamp._compareTo(other.timestamp)},SnapshotVersion.prototype.isEqual=function(other){return this.timestamp.isEqual(other.timestamp)},SnapshotVersion.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},SnapshotVersion.prototype.toString=function(){return'SnapshotVersion('+this.timestamp.toString()+')'},SnapshotVersion.prototype.toTimestamp=function(){return this.timestamp},SnapshotVersion.MIN=new SnapshotVersion(new Timestamp(0,0)),SnapshotVersion}(),QueryPurpose;(function(QueryPurpose){QueryPurpose[QueryPurpose.Listen=0]='Listen',QueryPurpose[QueryPurpose.ExistenceFilterMismatch=1]='ExistenceFilterMismatch',QueryPurpose[QueryPurpose.LimboResolution=2]='LimboResolution'})(QueryPurpose||(QueryPurpose={}));var QueryData=function(){function QueryData(query,targetId,purpose,sequenceNumber,snapshotVersion,resumeToken){void 0===snapshotVersion&&(snapshotVersion=SnapshotVersion.MIN),void 0===resumeToken&&(resumeToken=emptyByteString()),this.query=query,this.targetId=targetId,this.purpose=purpose,this.sequenceNumber=sequenceNumber,this.snapshotVersion=snapshotVersion,this.resumeToken=resumeToken}return QueryData.prototype.copy=function(overwrite){return new QueryData(this.query,this.targetId,this.purpose,void 0===overwrite.sequenceNumber?this.sequenceNumber:overwrite.sequenceNumber,void 0===overwrite.snapshotVersion?this.snapshotVersion:overwrite.snapshotVersion,void 0===overwrite.resumeToken?this.resumeToken:overwrite.resumeToken)},QueryData.prototype.isEqual=function(other){return this.targetId===other.targetId&&this.purpose===other.purpose&&this.sequenceNumber===other.sequenceNumber&&this.snapshotVersion.isEqual(other.snapshotVersion)&&this.resumeToken===other.resumeToken&&this.query.isEqual(other.query)},QueryData}(),FieldMask=function(){function FieldMask(fields){this.fields=fields}return FieldMask.prototype.covers=function(fieldPath){for(var _i=0,_a=this.fields,fieldMaskPath;_i<_a.length;_i++)if(fieldMaskPath=_a[_i],fieldMaskPath.isPrefixOf(fieldPath))return!0;return!1},FieldMask.prototype.isEqual=function(other){return arrayEquals(this.fields,other.fields)},FieldMask}(),FieldTransform=function(){function FieldTransform(field,transform){this.field=field,this.transform=transform}return FieldTransform.prototype.isEqual=function(other){return this.field.isEqual(other.field)&&this.transform.isEqual(other.transform)},FieldTransform}(),MutationResult=function(){return function MutationResult(version,transformResults){this.version=version,this.transformResults=transformResults}}(),MutationType;(function(MutationType){MutationType[MutationType.Set=0]='Set',MutationType[MutationType.Patch=1]='Patch',MutationType[MutationType.Transform=2]='Transform',MutationType[MutationType.Delete=3]='Delete'})(MutationType||(MutationType={}));var Precondition=function(){function Precondition(updateTime,exists){this.updateTime=updateTime,this.exists=exists,assert(void 0===updateTime||void 0===exists,'Precondition can specify "exists" or "updateTime" but not both')}return Precondition.exists=function(exists){return new Precondition(void 0,exists)},Precondition.updateTime=function(version){return new Precondition(version)},Object.defineProperty(Precondition.prototype,'isNone',{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),Precondition.prototype.isValidFor=function(maybeDoc){return void 0===this.updateTime?void 0===this.exists?(assert(this.isNone,'Precondition should be empty'),!0):this.exists===maybeDoc instanceof Document:maybeDoc instanceof Document&&maybeDoc.version.isEqual(this.updateTime)},Precondition.prototype.isEqual=function(other){return equals(this.updateTime,other.updateTime)&&this.exists===other.exists},Precondition.NONE=new Precondition,Precondition}(),Mutation=function(){function Mutation(){}return Mutation.prototype.verifyKeyMatches=function(maybeDoc){null!=maybeDoc&&assert(maybeDoc.key.isEqual(this.key),'Can only apply a mutation to a document with the same key')},Mutation.getPostMutationVersion=function(maybeDoc){return maybeDoc instanceof Document?maybeDoc.version:SnapshotVersion.MIN},Mutation}(),SetMutation=function(_super){function SetMutation(key,value,precondition){var _this=_super.call(this)||this;return _this.key=key,_this.value=value,_this.precondition=precondition,_this.type=MutationType.Set,_this}return tslib_1.__extends(SetMutation,_super),SetMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){this.verifyKeyMatches(maybeDoc),assert(null==mutationResult.transformResults,'Transform results received by SetMutation.');var version=mutationResult.version;return new Document(this.key,version,this.value,{hasCommittedMutations:!0})},SetMutation.prototype.applyToLocalView=function(maybeDoc){if(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))return maybeDoc;var version=Mutation.getPostMutationVersion(maybeDoc);return new Document(this.key,version,this.value,{hasLocalMutations:!0})},SetMutation.prototype.isEqual=function(other){return other instanceof SetMutation&&this.key.isEqual(other.key)&&this.value.isEqual(other.value)&&this.precondition.isEqual(other.precondition)},SetMutation}(Mutation),PatchMutation=function(_super){function PatchMutation(key,data,fieldMask,precondition){var _this=_super.call(this)||this;return _this.key=key,_this.data=data,_this.fieldMask=fieldMask,_this.precondition=precondition,_this.type=MutationType.Patch,_this}return tslib_1.__extends(PatchMutation,_super),PatchMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){if(this.verifyKeyMatches(maybeDoc),assert(null==mutationResult.transformResults,'Transform results received by PatchMutation.'),!this.precondition.isValidFor(maybeDoc))return new UnknownDocument(this.key,mutationResult.version);var newData=this.patchDocument(maybeDoc);return new Document(this.key,mutationResult.version,newData,{hasCommittedMutations:!0})},PatchMutation.prototype.applyToLocalView=function(maybeDoc){if(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))return maybeDoc;var version=Mutation.getPostMutationVersion(maybeDoc),newData=this.patchDocument(maybeDoc);return new Document(this.key,version,newData,{hasLocalMutations:!0})},PatchMutation.prototype.isEqual=function(other){return other instanceof PatchMutation&&this.key.isEqual(other.key)&&this.fieldMask.isEqual(other.fieldMask)&&this.precondition.isEqual(other.precondition)},PatchMutation.prototype.patchDocument=function(maybeDoc){var data;return data=maybeDoc instanceof Document?maybeDoc.data:ObjectValue.EMPTY,this.patchObject(data)},PatchMutation.prototype.patchObject=function(data){for(var _i=0,_a=this.fieldMask.fields,fieldPath;_i<_a.length;_i++)if(fieldPath=_a[_i],!fieldPath.isEmpty()){var newValue=this.data.field(fieldPath);data=void 0===newValue?data.delete(fieldPath):data.set(fieldPath,newValue)}return data},PatchMutation}(Mutation),TransformMutation=function(_super){function TransformMutation(key,fieldTransforms){var _this=_super.call(this)||this;return _this.key=key,_this.fieldTransforms=fieldTransforms,_this.type=MutationType.Transform,_this.precondition=Precondition.exists(!0),_this}return tslib_1.__extends(TransformMutation,_super),TransformMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){if(this.verifyKeyMatches(maybeDoc),assert(null!=mutationResult.transformResults,'Transform results missing for TransformMutation.'),!this.precondition.isValidFor(maybeDoc))return new UnknownDocument(this.key,mutationResult.version);var doc=this.requireDocument(maybeDoc),transformResults=this.serverTransformResults(maybeDoc,mutationResult.transformResults),version=mutationResult.version,newData=this.transformObject(doc.data,transformResults);return new Document(this.key,version,newData,{hasCommittedMutations:!0})},TransformMutation.prototype.applyToLocalView=function(maybeDoc,baseDoc,localWriteTime){if(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))return maybeDoc;var doc=this.requireDocument(maybeDoc),transformResults=this.localTransformResults(localWriteTime,baseDoc),newData=this.transformObject(doc.data,transformResults);return new Document(this.key,doc.version,newData,{hasLocalMutations:!0})},TransformMutation.prototype.isEqual=function(other){return other instanceof TransformMutation&&this.key.isEqual(other.key)&&arrayEquals(this.fieldTransforms,other.fieldTransforms)&&this.precondition.isEqual(other.precondition)},TransformMutation.prototype.requireDocument=function(maybeDoc){assert(maybeDoc instanceof Document,'Unknown MaybeDocument type '+maybeDoc);var doc=maybeDoc;return assert(doc.key.isEqual(this.key),'Can only transform a document with the same key'),doc},TransformMutation.prototype.serverTransformResults=function(baseDoc,serverTransformResults){var transformResults=[];assert(this.fieldTransforms.length===serverTransformResults.length,'server transform result count ('+serverTransformResults.length+') '+('should match field transform count ('+this.fieldTransforms.length+')'));for(var i=0;i<serverTransformResults.length;i++){var fieldTransform=this.fieldTransforms[i],transform=fieldTransform.transform,previousValue=null;baseDoc instanceof Document&&(previousValue=baseDoc.field(fieldTransform.field)||null),transformResults.push(transform.applyToRemoteDocument(previousValue,serverTransformResults[i]))}return transformResults},TransformMutation.prototype.localTransformResults=function(localWriteTime,baseDoc){for(var transformResults=[],_i=0,_a=this.fieldTransforms;_i<_a.length;_i++){var fieldTransform=_a[_i],transform=fieldTransform.transform,previousValue=null;baseDoc instanceof Document&&(previousValue=baseDoc.field(fieldTransform.field)||null),transformResults.push(transform.applyToLocalView(previousValue,localWriteTime))}return transformResults},TransformMutation.prototype.transformObject=function(data,transformResults){assert(transformResults.length===this.fieldTransforms.length,'TransformResults length mismatch.');for(var i=0;i<this.fieldTransforms.length;i++){var fieldTransform=this.fieldTransforms[i],fieldPath=fieldTransform.field;data=data.set(fieldPath,transformResults[i])}return data},TransformMutation}(Mutation),DeleteMutation=function(_super){function DeleteMutation(key,precondition){var _this=_super.call(this)||this;return _this.key=key,_this.precondition=precondition,_this.type=MutationType.Delete,_this}return tslib_1.__extends(DeleteMutation,_super),DeleteMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){return this.verifyKeyMatches(maybeDoc),assert(null==mutationResult.transformResults,'Transform results received by DeleteMutation.'),new NoDocument(this.key,mutationResult.version,{hasCommittedMutations:!0})},DeleteMutation.prototype.applyToLocalView=function(maybeDoc){return(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))?maybeDoc:(maybeDoc&&assert(maybeDoc.key.isEqual(this.key),'Can only apply mutation to document with same key'),new NoDocument(this.key,SnapshotVersion.forDeletedDoc()))},DeleteMutation.prototype.isEqual=function(other){return other instanceof DeleteMutation&&this.key.isEqual(other.key)&&this.precondition.isEqual(other.precondition)},DeleteMutation}(Mutation),ServerTimestampTransform=function(){function ServerTimestampTransform(){}return ServerTimestampTransform.prototype.applyToLocalView=function(previousValue,localWriteTime){return new ServerTimestampValue(localWriteTime,previousValue)},ServerTimestampTransform.prototype.applyToRemoteDocument=function(previousValue,transformResult){return transformResult},ServerTimestampTransform.prototype.isEqual=function(other){return other instanceof ServerTimestampTransform},ServerTimestampTransform.instance=new ServerTimestampTransform,ServerTimestampTransform}(),ArrayUnionTransformOperation=function(){function ArrayUnionTransformOperation(elements){this.elements=elements}return ArrayUnionTransformOperation.prototype.applyToLocalView=function(previousValue){return this.apply(previousValue)},ArrayUnionTransformOperation.prototype.applyToRemoteDocument=function(previousValue){return this.apply(previousValue)},ArrayUnionTransformOperation.prototype.apply=function(previousValue){for(var result=coercedFieldValuesArray(previousValue),_loop_1=function(toUnion){result.find(function(element){return element.isEqual(toUnion)})||result.push(toUnion)},_i=0,_a=this.elements,toUnion;_i<_a.length;_i++)toUnion=_a[_i],_loop_1(toUnion);return new ArrayValue(result)},ArrayUnionTransformOperation.prototype.isEqual=function(other){return other instanceof ArrayUnionTransformOperation&&arrayEquals(other.elements,this.elements)},ArrayUnionTransformOperation}(),ArrayRemoveTransformOperation=function(){function ArrayRemoveTransformOperation(elements){this.elements=elements}return ArrayRemoveTransformOperation.prototype.applyToLocalView=function(previousValue){return this.apply(previousValue)},ArrayRemoveTransformOperation.prototype.applyToRemoteDocument=function(previousValue){return this.apply(previousValue)},ArrayRemoveTransformOperation.prototype.apply=function(previousValue){for(var result=coercedFieldValuesArray(previousValue),_loop_2=function(toRemove){result=result.filter(function(element){return!element.isEqual(toRemove)})},_i=0,_a=this.elements,toRemove;_i<_a.length;_i++)toRemove=_a[_i],_loop_2(toRemove);return new ArrayValue(result)},ArrayRemoveTransformOperation.prototype.isEqual=function(other){return other instanceof ArrayRemoveTransformOperation&&arrayEquals(other.elements,this.elements)},ArrayRemoveTransformOperation}(),ExistenceFilter=function(){function ExistenceFilter(count){this.count=count}return ExistenceFilter.prototype.isEqual=function(other){return other&&other.count===this.count},ExistenceFilter}(),RpcCode;(function(RpcCode){RpcCode[RpcCode.OK=0]='OK',RpcCode[RpcCode.CANCELLED=1]='CANCELLED',RpcCode[RpcCode.UNKNOWN=2]='UNKNOWN',RpcCode[RpcCode.INVALID_ARGUMENT=3]='INVALID_ARGUMENT',RpcCode[RpcCode.DEADLINE_EXCEEDED=4]='DEADLINE_EXCEEDED',RpcCode[RpcCode.NOT_FOUND=5]='NOT_FOUND',RpcCode[RpcCode.ALREADY_EXISTS=6]='ALREADY_EXISTS',RpcCode[RpcCode.PERMISSION_DENIED=7]='PERMISSION_DENIED',RpcCode[RpcCode.UNAUTHENTICATED=16]='UNAUTHENTICATED',RpcCode[RpcCode.RESOURCE_EXHAUSTED=8]='RESOURCE_EXHAUSTED',RpcCode[RpcCode.FAILED_PRECONDITION=9]='FAILED_PRECONDITION',RpcCode[RpcCode.ABORTED=10]='ABORTED',RpcCode[RpcCode.OUT_OF_RANGE=11]='OUT_OF_RANGE',RpcCode[RpcCode.UNIMPLEMENTED=12]='UNIMPLEMENTED',RpcCode[RpcCode.INTERNAL=13]='INTERNAL',RpcCode[RpcCode.UNAVAILABLE=14]='UNAVAILABLE',RpcCode[RpcCode.DATA_LOSS=15]='DATA_LOSS'})(RpcCode||(RpcCode={}));var SortedSet=function(){function SortedSet(comparator){this.comparator=comparator,this.data=new SortedMap(this.comparator)}return SortedSet.fromMapKeys=function(map){var keys=new SortedSet(map.comparator);return map.forEach(function(key){keys=keys.add(key)}),keys},SortedSet.prototype.has=function(elem){return null!==this.data.get(elem)},SortedSet.prototype.first=function(){return this.data.minKey()},SortedSet.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(SortedSet.prototype,'size',{get:function(){return this.data.size},enumerable:!0,configurable:!0}),SortedSet.prototype.indexOf=function(elem){return this.data.indexOf(elem)},SortedSet.prototype.forEach=function(cb){this.data.inorderTraversal(function(k){return cb(k),!1})},SortedSet.prototype.forEachInRange=function(range,cb){for(var iter=this.data.getIteratorFrom(range[0]),elem;iter.hasNext();){if(elem=iter.getNext(),0<=this.comparator(elem.key,range[1]))return;cb(elem.key)}},SortedSet.prototype.forEachWhile=function(cb,start){var iter;for(iter=void 0===start?this.data.getIterator():this.data.getIteratorFrom(start);iter.hasNext();){var elem=iter.getNext(),result=cb(elem.key);if(!result)return}},SortedSet.prototype.firstAfterOrEqual=function(elem){var iter=this.data.getIteratorFrom(elem);return iter.hasNext()?iter.getNext().key:null},SortedSet.prototype.add=function(elem){return this.copy(this.data.remove(elem).insert(elem,!0))},SortedSet.prototype.delete=function(elem){return this.has(elem)?this.copy(this.data.remove(elem)):this},SortedSet.prototype.isEmpty=function(){return this.data.isEmpty()},SortedSet.prototype.unionWith=function(other){var result=this;return other.forEach(function(elem){result=result.add(elem)}),result},SortedSet.prototype.isEqual=function(other){if(!(other instanceof SortedSet))return!1;if(this.size!==other.size)return!1;for(var thisIt=this.data.getIterator(),otherIt=other.data.getIterator();thisIt.hasNext();){var thisElem=thisIt.getNext().key,otherElem=otherIt.getNext().key;if(0!==this.comparator(thisElem,otherElem))return!1}return!0},SortedSet.prototype.toArray=function(){var res=[];return this.forEach(function(targetId){res.push(targetId)}),res},SortedSet.prototype.toString=function(){var result=[];return this.forEach(function(elem){return result.push(elem)}),'SortedSet('+result.toString()+')'},SortedSet.prototype.copy=function(data){var result=new SortedSet(this.comparator);return result.data=data,result},SortedSet}(),EMPTY_MAYBE_DOCUMENT_MAP=new SortedMap(DocumentKey.comparator),EMPTY_DOCUMENT_MAP=new SortedMap(DocumentKey.comparator),EMPTY_DOCUMENT_VERSION_MAP=new SortedMap(DocumentKey.comparator),EMPTY_DOCUMENT_KEY_SET=new SortedSet(DocumentKey.comparator),EMPTY_TARGET_ID_SET=new SortedSet(primitiveComparator),DocumentSet=function(){function DocumentSet(comp){this.comparator=comp?function(d1,d2){return comp(d1,d2)||DocumentKey.comparator(d1.key,d2.key)}:function(d1,d2){return DocumentKey.comparator(d1.key,d2.key)},this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}return DocumentSet.emptySet=function(oldSet){return new DocumentSet(oldSet.comparator)},DocumentSet.prototype.has=function(key){return null!=this.keyedMap.get(key)},DocumentSet.prototype.get=function(key){return this.keyedMap.get(key)},DocumentSet.prototype.first=function(){return this.sortedSet.minKey()},DocumentSet.prototype.last=function(){return this.sortedSet.maxKey()},DocumentSet.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},DocumentSet.prototype.indexOf=function(key){var doc=this.keyedMap.get(key);return doc?this.sortedSet.indexOf(doc):-1},Object.defineProperty(DocumentSet.prototype,'size',{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),DocumentSet.prototype.forEach=function(cb){this.sortedSet.inorderTraversal(function(k){return cb(k),!1})},DocumentSet.prototype.add=function(doc){var set=this.delete(doc.key);return set.copy(set.keyedMap.insert(doc.key,doc),set.sortedSet.insert(doc,null))},DocumentSet.prototype.delete=function(key){var doc=this.get(key);return doc?this.copy(this.keyedMap.remove(key),this.sortedSet.remove(doc)):this},DocumentSet.prototype.isEqual=function(other){if(!(other instanceof DocumentSet))return!1;if(this.size!==other.size)return!1;for(var thisIt=this.sortedSet.getIterator(),otherIt=other.sortedSet.getIterator();thisIt.hasNext();){var thisDoc=thisIt.getNext().key,otherDoc=otherIt.getNext().key;if(!thisDoc.isEqual(otherDoc))return!1}return!0},DocumentSet.prototype.toString=function(){var docStrings=[];return this.forEach(function(doc){docStrings.push(doc.toString())}),0===docStrings.length?'DocumentSet ()':'DocumentSet (\n  '+docStrings.join('  \n')+'\n)'},DocumentSet.prototype.copy=function(keyedMap,sortedSet){var newSet=new DocumentSet;return newSet.comparator=this.comparator,newSet.keyedMap=keyedMap,newSet.sortedSet=sortedSet,newSet},DocumentSet}(),ChangeType;(function(ChangeType){ChangeType[ChangeType.Added=0]='Added',ChangeType[ChangeType.Removed=1]='Removed',ChangeType[ChangeType.Modified=2]='Modified',ChangeType[ChangeType.Metadata=3]='Metadata'})(ChangeType||(ChangeType={}));var SyncState;(function(SyncState){SyncState[SyncState.Local=0]='Local',SyncState[SyncState.Synced=1]='Synced'})(SyncState||(SyncState={}));var DocumentChangeSet=function(){function DocumentChangeSet(){this.changeMap=new SortedMap(DocumentKey.comparator)}return DocumentChangeSet.prototype.track=function(change){var key=change.doc.key,oldChange=this.changeMap.get(key);return oldChange?void(change.type!==ChangeType.Added&&oldChange.type===ChangeType.Metadata?this.changeMap=this.changeMap.insert(key,change):change.type===ChangeType.Metadata&&oldChange.type!==ChangeType.Removed?this.changeMap=this.changeMap.insert(key,{type:oldChange.type,doc:change.doc}):change.type===ChangeType.Modified&&oldChange.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Modified,doc:change.doc}):change.type===ChangeType.Modified&&oldChange.type===ChangeType.Added?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Added,doc:change.doc}):change.type===ChangeType.Removed&&oldChange.type===ChangeType.Added?this.changeMap=this.changeMap.remove(key):change.type===ChangeType.Removed&&oldChange.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Removed,doc:oldChange.doc}):change.type===ChangeType.Added&&oldChange.type===ChangeType.Removed?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Modified,doc:change.doc}):fail('unsupported combination of changes: '+JSON.stringify(change)+' after '+JSON.stringify(oldChange))):void(this.changeMap=this.changeMap.insert(key,change))},DocumentChangeSet.prototype.getChanges=function(){var changes=[];return this.changeMap.inorderTraversal(function(key,change){changes.push(change)}),changes},DocumentChangeSet}(),ViewSnapshot=function(){function ViewSnapshot(query,docs,oldDocs,docChanges,mutatedKeys,fromCache,syncStateChanged,excludesMetadataChanges){this.query=query,this.docs=docs,this.oldDocs=oldDocs,this.docChanges=docChanges,this.mutatedKeys=mutatedKeys,this.fromCache=fromCache,this.syncStateChanged=syncStateChanged,this.excludesMetadataChanges=excludesMetadataChanges}return ViewSnapshot.fromInitialDocuments=function(query,documents,mutatedKeys,fromCache){var changes=[];return documents.forEach(function(doc){changes.push({type:ChangeType.Added,doc:doc})}),new ViewSnapshot(query,documents,DocumentSet.emptySet(documents),changes,mutatedKeys,fromCache,!0,!1)},Object.defineProperty(ViewSnapshot.prototype,'hasPendingWrites',{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),ViewSnapshot.prototype.isEqual=function(other){if(this.fromCache!==other.fromCache||this.syncStateChanged!==other.syncStateChanged||!this.mutatedKeys.isEqual(other.mutatedKeys)||!this.query.isEqual(other.query)||!this.docs.isEqual(other.docs)||!this.oldDocs.isEqual(other.oldDocs))return!1;var changes=this.docChanges,otherChanges=other.docChanges;if(changes.length!==otherChanges.length)return!1;for(var i=0;i<changes.length;i++)if(changes[i].type!==otherChanges[i].type||!changes[i].doc.isEqual(otherChanges[i].doc))return!1;return!0},ViewSnapshot}(),RemoteEvent=function(){function RemoteEvent(snapshotVersion,targetChanges,targetMismatches,documentUpdates,resolvedLimboDocuments){this.snapshotVersion=snapshotVersion,this.targetChanges=targetChanges,this.targetMismatches=targetMismatches,this.documentUpdates=documentUpdates,this.resolvedLimboDocuments=resolvedLimboDocuments}return RemoteEvent.createSynthesizedRemoteEventForCurrentChange=function(targetId,current){var targetChanges=(_a={},_a[targetId]=TargetChange.createSynthesizedTargetChangeForCurrentChange(targetId,current),_a);return new RemoteEvent(SnapshotVersion.MIN,targetChanges,targetIdSet(),maybeDocumentMap(),documentKeySet());var _a},RemoteEvent}(),TargetChange=function(){function TargetChange(resumeToken,current,addedDocuments,modifiedDocuments,removedDocuments){this.resumeToken=resumeToken,this.current=current,this.addedDocuments=addedDocuments,this.modifiedDocuments=modifiedDocuments,this.removedDocuments=removedDocuments}return TargetChange.createSynthesizedTargetChangeForCurrentChange=function(targetId,current){return new TargetChange(emptyByteString(),current,documentKeySet(),documentKeySet(),documentKeySet())},TargetChange}(),DocumentWatchChange=function(){return function DocumentWatchChange(updatedTargetIds,removedTargetIds,key,newDoc){this.updatedTargetIds=updatedTargetIds,this.removedTargetIds=removedTargetIds,this.key=key,this.newDoc=newDoc}}(),ExistenceFilterChange=function(){return function ExistenceFilterChange(targetId,existenceFilter){this.targetId=targetId,this.existenceFilter=existenceFilter}}(),WatchTargetChangeState;(function(WatchTargetChangeState){WatchTargetChangeState[WatchTargetChangeState.NoChange=0]='NoChange',WatchTargetChangeState[WatchTargetChangeState.Added=1]='Added',WatchTargetChangeState[WatchTargetChangeState.Removed=2]='Removed',WatchTargetChangeState[WatchTargetChangeState.Current=3]='Current',WatchTargetChangeState[WatchTargetChangeState.Reset=4]='Reset'})(WatchTargetChangeState||(WatchTargetChangeState={}));var WatchTargetChange=function(){return function WatchTargetChange(state,targetIds,resumeToken,cause){void 0===resumeToken&&(resumeToken=emptyByteString()),void 0===cause&&(cause=null),this.state=state,this.targetIds=targetIds,this.resumeToken=resumeToken,this.cause=cause}}(),TargetState=function(){function TargetState(){this.pendingResponses=0,this.documentChanges=snapshotChangesMap(),this._resumeToken=emptyByteString(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(TargetState.prototype,'current',{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(TargetState.prototype,'resumeToken',{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(TargetState.prototype,'isPending',{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(TargetState.prototype,'hasPendingChanges',{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),TargetState.prototype.updateResumeToken=function(resumeToken){0<resumeToken.length&&(this._hasPendingChanges=!0,this._resumeToken=resumeToken)},TargetState.prototype.toTargetChange=function(){var addedDocuments=documentKeySet(),modifiedDocuments=documentKeySet(),removedDocuments=documentKeySet();return this.documentChanges.forEach(function(key,changeType){changeType===ChangeType.Added?addedDocuments=addedDocuments.add(key):changeType===ChangeType.Modified?modifiedDocuments=modifiedDocuments.add(key):changeType===ChangeType.Removed?removedDocuments=removedDocuments.add(key):fail('Encountered invalid change type: '+changeType)}),new TargetChange(this._resumeToken,this._current,addedDocuments,modifiedDocuments,removedDocuments)},TargetState.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=snapshotChangesMap()},TargetState.prototype.addDocumentChange=function(key,changeType){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(key,changeType)},TargetState.prototype.removeDocumentChange=function(key){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(key)},TargetState.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},TargetState.prototype.recordTargetResponse=function(){this.pendingResponses-=1},TargetState.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},TargetState}(),WatchChangeAggregator=function(){function WatchChangeAggregator(metadataProvider){this.metadataProvider=metadataProvider,this.targetStates={},this.pendingDocumentUpdates=maybeDocumentMap(),this.pendingDocumentTargetMapping=documentTargetMap(),this.pendingTargetResets=new SortedSet(primitiveComparator)}return WatchChangeAggregator.prototype.handleDocumentChange=function(docChange){for(var _i=0,_a=docChange.updatedTargetIds,targetId;_i<_a.length;_i++)targetId=_a[_i],docChange.newDoc instanceof Document?this.addDocumentToTarget(targetId,docChange.newDoc):docChange.newDoc instanceof NoDocument&&this.removeDocumentFromTarget(targetId,docChange.key,docChange.newDoc);for(var _b=0,_c=docChange.removedTargetIds,targetId;_b<_c.length;_b++)targetId=_c[_b],this.removeDocumentFromTarget(targetId,docChange.key,docChange.newDoc)},WatchChangeAggregator.prototype.handleTargetChange=function(targetChange){var _this=this;this.forEachTarget(targetChange,function(targetId){var targetState=_this.ensureTargetState(targetId);switch(targetChange.state){case WatchTargetChangeState.NoChange:_this.isActiveTarget(targetId)&&targetState.updateResumeToken(targetChange.resumeToken);break;case WatchTargetChangeState.Added:targetState.recordTargetResponse(),targetState.isPending||targetState.clearPendingChanges(),targetState.updateResumeToken(targetChange.resumeToken);break;case WatchTargetChangeState.Removed:targetState.recordTargetResponse(),targetState.isPending||_this.removeTarget(targetId),assert(!targetChange.cause,'WatchChangeAggregator does not handle errored targets');break;case WatchTargetChangeState.Current:_this.isActiveTarget(targetId)&&(targetState.markCurrent(),targetState.updateResumeToken(targetChange.resumeToken));break;case WatchTargetChangeState.Reset:_this.isActiveTarget(targetId)&&(_this.resetTarget(targetId),targetState.updateResumeToken(targetChange.resumeToken));break;default:fail('Unknown target watch change state: '+targetChange.state);}})},WatchChangeAggregator.prototype.forEachTarget=function(targetChange,fn){0<targetChange.targetIds.length?targetChange.targetIds.forEach(fn):forEachNumber(this.targetStates,fn)},WatchChangeAggregator.prototype.handleExistenceFilter=function(watchChange){var targetId=watchChange.targetId,expectedCount=watchChange.existenceFilter.count,queryData=this.queryDataForActiveTarget(targetId);if(queryData){var query=queryData.query;if(!query.isDocumentQuery()){var currentSize=this.getCurrentDocumentCountForTarget(targetId);currentSize!==expectedCount&&(this.resetTarget(targetId),this.pendingTargetResets=this.pendingTargetResets.add(targetId))}else if(0===expectedCount){var key=new DocumentKey(query.path);this.removeDocumentFromTarget(targetId,key,new NoDocument(key,SnapshotVersion.forDeletedDoc()))}else assert(1===expectedCount,'Single document existence filter with count: '+expectedCount)}},WatchChangeAggregator.prototype.createRemoteEvent=function(snapshotVersion){var _this=this,targetChanges={};forEachNumber(this.targetStates,function(targetId,targetState){var queryData=_this.queryDataForActiveTarget(targetId);if(queryData){if(targetState.current&&queryData.query.isDocumentQuery()){var key=new DocumentKey(queryData.query.path);null!==_this.pendingDocumentUpdates.get(key)||_this.targetContainsDocument(targetId,key)||_this.removeDocumentFromTarget(targetId,key,new NoDocument(key,snapshotVersion))}targetState.hasPendingChanges&&(targetChanges[targetId]=targetState.toTargetChange(),targetState.clearPendingChanges())}});var resolvedLimboDocuments=documentKeySet();this.pendingDocumentTargetMapping.forEach(function(key,targets){var isOnlyLimboTarget=!0;targets.forEachWhile(function(targetId){var queryData=_this.queryDataForActiveTarget(targetId);return queryData&&queryData.purpose!==QueryPurpose.LimboResolution?(isOnlyLimboTarget=!1,!1):!0}),isOnlyLimboTarget&&(resolvedLimboDocuments=resolvedLimboDocuments.add(key))});var remoteEvent=new RemoteEvent(snapshotVersion,targetChanges,this.pendingTargetResets,this.pendingDocumentUpdates,resolvedLimboDocuments);return this.pendingDocumentUpdates=maybeDocumentMap(),this.pendingDocumentTargetMapping=documentTargetMap(),this.pendingTargetResets=new SortedSet(primitiveComparator),remoteEvent},WatchChangeAggregator.prototype.addDocumentToTarget=function(targetId,document){if(this.isActiveTarget(targetId)){var changeType=this.targetContainsDocument(targetId,document.key)?ChangeType.Modified:ChangeType.Added,targetState=this.ensureTargetState(targetId);targetState.addDocumentChange(document.key,changeType),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(document.key,document),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(document.key,this.ensureDocumentTargetMapping(document.key).add(targetId))}},WatchChangeAggregator.prototype.removeDocumentFromTarget=function(targetId,key,updatedDocument){if(this.isActiveTarget(targetId)){var targetState=this.ensureTargetState(targetId);this.targetContainsDocument(targetId,key)?targetState.addDocumentChange(key,ChangeType.Removed):targetState.removeDocumentChange(key),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(key,this.ensureDocumentTargetMapping(key).delete(targetId)),updatedDocument&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(key,updatedDocument))}},WatchChangeAggregator.prototype.removeTarget=function(targetId){delete this.targetStates[targetId]},WatchChangeAggregator.prototype.getCurrentDocumentCountForTarget=function(targetId){var targetState=this.ensureTargetState(targetId),targetChange=targetState.toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(targetId).size+targetChange.addedDocuments.size-targetChange.removedDocuments.size},WatchChangeAggregator.prototype.recordPendingTargetRequest=function(targetId){var targetState=this.ensureTargetState(targetId);targetState.recordPendingTargetRequest()},WatchChangeAggregator.prototype.ensureTargetState=function(targetId){return this.targetStates[targetId]||(this.targetStates[targetId]=new TargetState),this.targetStates[targetId]},WatchChangeAggregator.prototype.ensureDocumentTargetMapping=function(key){var targetMapping=this.pendingDocumentTargetMapping.get(key);return targetMapping||(targetMapping=new SortedSet(primitiveComparator),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(key,targetMapping)),targetMapping},WatchChangeAggregator.prototype.isActiveTarget=function(targetId){return null!==this.queryDataForActiveTarget(targetId)},WatchChangeAggregator.prototype.queryDataForActiveTarget=function(targetId){var targetState=this.targetStates[targetId];return targetState&&targetState.isPending?null:this.metadataProvider.getQueryDataForTarget(targetId)},WatchChangeAggregator.prototype.resetTarget=function(targetId){var _this=this;assert(!this.targetStates[targetId].isPending,'Should only reset active targets'),this.targetStates[targetId]=new TargetState;var existingKeys=this.metadataProvider.getRemoteKeysForTarget(targetId);existingKeys.forEach(function(key){_this.removeDocumentFromTarget(targetId,key,null)})},WatchChangeAggregator.prototype.targetContainsDocument=function(targetId,key){var existingKeys=this.metadataProvider.getRemoteKeysForTarget(targetId);return existingKeys.has(key)},WatchChangeAggregator}(),DIRECTIONS=function(){var dirs={};return dirs[Direction.ASCENDING.name]='ASCENDING',dirs[Direction.DESCENDING.name]='DESCENDING',dirs}(),OPERATORS=function(){var ops={};return ops[RelationOp.LESS_THAN.name]='LESS_THAN',ops[RelationOp.LESS_THAN_OR_EQUAL.name]='LESS_THAN_OR_EQUAL',ops[RelationOp.GREATER_THAN.name]='GREATER_THAN',ops[RelationOp.GREATER_THAN_OR_EQUAL.name]='GREATER_THAN_OR_EQUAL',ops[RelationOp.EQUAL.name]='EQUAL',ops[RelationOp.ARRAY_CONTAINS.name]='ARRAY_CONTAINS',ops}(),ISO_REG_EXP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/),JsonProtoSerializer=function(){function JsonProtoSerializer(databaseId,options){this.databaseId=databaseId,this.options=options}return JsonProtoSerializer.prototype.emptyByteString=function(){return this.options.useProto3Json?'':new Uint8Array(0)},JsonProtoSerializer.prototype.unsafeCastProtoByteString=function(byteString){return byteString},JsonProtoSerializer.prototype.fromRpcStatus=function(status){var code=void 0===status.code?Code.UNKNOWN:mapCodeFromRpcCode(status.code);return new FirestoreError(code,status.message||'')},JsonProtoSerializer.prototype.toInt32Value=function(val){return isNullOrUndefined(val)?void 0:{value:val}},JsonProtoSerializer.prototype.fromInt32Value=function(val){var result;return result='object'==typeof val?val.value:val,isNullOrUndefined(result)?null:result},JsonProtoSerializer.prototype.toTimestamp=function(timestamp){return{seconds:timestamp.seconds,nanos:timestamp.nanoseconds}},JsonProtoSerializer.prototype.fromTimestamp=function(date){if('string'==typeof date)return this.fromIso8601String(date);assert(!!date,'Cannot deserialize null or undefined timestamp.');var seconds=parseInt64(date.seconds||'0'),nanos=date.nanos||0;return new Timestamp(seconds,nanos)},JsonProtoSerializer.prototype.fromIso8601String=function(utc){var nanos=0,fraction=ISO_REG_EXP.exec(utc);if(assert(!!fraction,'invalid timestamp: '+utc),fraction[1]){var nanoStr=fraction[1];nanoStr=(nanoStr+'000000000').substr(0,9),nanos=+nanoStr}var date=new Date(utc),seconds=_Mathfloor(date.getTime()/1e3);return new Timestamp(seconds,nanos)},JsonProtoSerializer.prototype.toBytes=function(bytes){return this.options.useProto3Json?bytes.toBase64():this.unsafeCastProtoByteString(bytes.toUint8Array())},JsonProtoSerializer.prototype.fromBlob=function(blob){return'string'==typeof blob?(assert(this.options.useProto3Json,'Expected bytes to be passed in as Uint8Array, but got a string instead.'),Blob.fromBase64String(blob)):(assert(!this.options.useProto3Json,'Expected bytes to be passed in as string, but got something else instead.'),Blob.fromUint8Array(blob))},JsonProtoSerializer.prototype.toVersion=function(version){return this.toTimestamp(version.toTimestamp())},JsonProtoSerializer.prototype.fromVersion=function(version){return assert(!!version,'Trying to deserialize version that isn\'t set'),SnapshotVersion.fromTimestamp(this.fromTimestamp(version))},JsonProtoSerializer.prototype.toResourceName=function(databaseId,path){return this.fullyQualifiedPrefixPath(databaseId).child('documents').child(path).canonicalString()},JsonProtoSerializer.prototype.fromResourceName=function(name){var resource=ResourcePath.fromString(name);return assert(this.isValidResourceName(resource),'Tried to deserialize invalid key '+resource.toString()),resource},JsonProtoSerializer.prototype.toName=function(key){return this.toResourceName(this.databaseId,key.path)},JsonProtoSerializer.prototype.fromName=function(name){var resource=this.fromResourceName(name);return assert(resource.get(1)===this.databaseId.projectId,'Tried to deserialize key from different project: '+resource.get(1)+' vs '+this.databaseId.projectId),assert(!resource.get(3)&&!this.databaseId.database||resource.get(3)===this.databaseId.database,'Tried to deserialize key from different database: '+resource.get(3)+' vs '+this.databaseId.database),new DocumentKey(this.extractLocalPathFromResourceName(resource))},JsonProtoSerializer.prototype.toQueryPath=function(path){return 0===path.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,path)},JsonProtoSerializer.prototype.fromQueryPath=function(name){var resourceName=this.fromResourceName(name);return 4===resourceName.length?ResourcePath.EMPTY_PATH:this.extractLocalPathFromResourceName(resourceName)},Object.defineProperty(JsonProtoSerializer.prototype,'encodedDatabaseId',{get:function(){var path=new ResourcePath(['projects',this.databaseId.projectId,'databases',this.databaseId.database]);return path.canonicalString()},enumerable:!0,configurable:!0}),JsonProtoSerializer.prototype.fullyQualifiedPrefixPath=function(databaseId){return new ResourcePath(['projects',databaseId.projectId,'databases',databaseId.database])},JsonProtoSerializer.prototype.extractLocalPathFromResourceName=function(resourceName){return assert(4<resourceName.length&&'documents'===resourceName.get(4),'tried to deserialize invalid key '+resourceName.toString()),resourceName.popFirst(5)},JsonProtoSerializer.prototype.isValidResourceName=function(path){return 4<=path.length&&'projects'===path.get(0)&&'databases'===path.get(2)},JsonProtoSerializer.prototype.toValue=function(val){if(val instanceof NullValue)return{nullValue:'NULL_VALUE'};if(val instanceof BooleanValue)return{booleanValue:val.value()};if(val instanceof IntegerValue)return{integerValue:''+val.value()};if(val instanceof DoubleValue){var doubleValue=val.value();if(this.options.useProto3Json){if(isNaN(doubleValue))return{doubleValue:'NaN'};if(doubleValue===Infinity)return{doubleValue:'Infinity'};if(doubleValue===-Infinity)return{doubleValue:'-Infinity'}}return{doubleValue:val.value()}}return val instanceof StringValue?{stringValue:val.value()}:val instanceof ObjectValue?{mapValue:this.toMapValue(val)}:val instanceof ArrayValue?{arrayValue:this.toArrayValue(val)}:val instanceof TimestampValue?{timestampValue:this.toTimestamp(val.internalValue)}:val instanceof GeoPointValue?{geoPointValue:{latitude:val.value().latitude,longitude:val.value().longitude}}:val instanceof BlobValue?{bytesValue:this.toBytes(val.value())}:val instanceof RefValue?{referenceValue:this.toResourceName(val.databaseId,val.key.path)}:fail('Unknown FieldValue '+JSON.stringify(val))},JsonProtoSerializer.prototype.fromValue=function(obj){var _this=this,type=obj.value_type;if(hasTag(obj,type,'nullValue'))return NullValue.INSTANCE;if(hasTag(obj,type,'booleanValue'))return BooleanValue.of(obj.booleanValue);if(hasTag(obj,type,'integerValue'))return new IntegerValue(parseInt64(obj.integerValue));if(hasTag(obj,type,'doubleValue')){if(this.options.useProto3Json){if('NaN'===obj.doubleValue)return DoubleValue.NAN;if('Infinity'===obj.doubleValue)return DoubleValue.POSITIVE_INFINITY;if('-Infinity'===obj.doubleValue)return DoubleValue.NEGATIVE_INFINITY}return new DoubleValue(obj.doubleValue)}if(hasTag(obj,type,'stringValue'))return new StringValue(obj.stringValue);if(hasTag(obj,type,'mapValue'))return this.fromFields(obj.mapValue.fields||{});if(hasTag(obj,type,'arrayValue')){assertPresent(obj.arrayValue,'arrayValue');var values$$1=obj.arrayValue.values||[];return new ArrayValue(values$$1.map(function(v){return _this.fromValue(v)}))}if(hasTag(obj,type,'timestampValue'))return assertPresent(obj.timestampValue,'timestampValue'),new TimestampValue(this.fromTimestamp(obj.timestampValue));if(hasTag(obj,type,'geoPointValue')){assertPresent(obj.geoPointValue,'geoPointValue');var latitude=obj.geoPointValue.latitude||0,longitude=obj.geoPointValue.longitude||0;return new GeoPointValue(new GeoPoint(latitude,longitude))}if(hasTag(obj,type,'bytesValue')){assertPresent(obj.bytesValue,'bytesValue');var blob=this.fromBlob(obj.bytesValue);return new BlobValue(blob)}if(hasTag(obj,type,'referenceValue')){assertPresent(obj.referenceValue,'referenceValue');var resourceName=this.fromResourceName(obj.referenceValue),dbId=new DatabaseId(resourceName.get(1),resourceName.get(3)),key=new DocumentKey(this.extractLocalPathFromResourceName(resourceName));return new RefValue(dbId,key)}return fail('Unknown Value proto '+JSON.stringify(obj))},JsonProtoSerializer.prototype.toMutationDocument=function(key,fields){return{name:this.toName(key),fields:this.toFields(fields)}},JsonProtoSerializer.prototype.toDocument=function(document){return assert(!document.hasLocalMutations,'Can\'t serialize documents with mutations.'),{name:this.toName(document.key),fields:this.toFields(document.data),updateTime:this.toTimestamp(document.version.toTimestamp())}},JsonProtoSerializer.prototype.fromDocument=function(document,hasCommittedMutations){return new Document(this.fromName(document.name),this.fromVersion(document.updateTime),this.fromFields(document.fields||{}),{hasCommittedMutations:!!hasCommittedMutations})},JsonProtoSerializer.prototype.toFields=function(fields){var _this=this,result={};return fields.forEach(function(key,value){result[key]=_this.toValue(value)}),result},JsonProtoSerializer.prototype.fromFields=function(object){var _this=this,result=ObjectValue.EMPTY;return forEach(object,function(key,value){result=result.set(new FieldPath([key]),_this.fromValue(value))}),result},JsonProtoSerializer.prototype.toMapValue=function(map){return{fields:this.toFields(map)}},JsonProtoSerializer.prototype.toArrayValue=function(array){var _this=this,result=[];return array.forEach(function(value){result.push(_this.toValue(value))}),{values:result}},JsonProtoSerializer.prototype.fromFound=function(doc){assert(!!doc.found,'Tried to deserialize a found document from a missing document.'),assertPresent(doc.found.name,'doc.found.name'),assertPresent(doc.found.updateTime,'doc.found.updateTime');var key=this.fromName(doc.found.name),version=this.fromVersion(doc.found.updateTime),fields=this.fromFields(doc.found.fields||{});return new Document(key,version,fields,{})},JsonProtoSerializer.prototype.fromMissing=function(result){assert(!!result.missing,'Tried to deserialize a missing document from a found document.'),assert(!!result.readTime,'Tried to deserialize a missing document without a read time.');var key=this.fromName(result.missing),version=this.fromVersion(result.readTime);return new NoDocument(key,version)},JsonProtoSerializer.prototype.fromMaybeDocument=function(result){var type=result.result;return hasTag(result,type,'found')?this.fromFound(result):hasTag(result,type,'missing')?this.fromMissing(result):fail('invalid batch get response: '+JSON.stringify(result))},JsonProtoSerializer.prototype.toWatchTargetChangeState=function(state){return state===WatchTargetChangeState.Added?'ADD':state===WatchTargetChangeState.Current?'CURRENT':state===WatchTargetChangeState.NoChange?'NO_CHANGE':state===WatchTargetChangeState.Removed?'REMOVE':state===WatchTargetChangeState.Reset?'RESET':fail('Unknown WatchTargetChangeState: '+state)},JsonProtoSerializer.prototype.toTestWatchChange=function(watchChange){if(watchChange instanceof ExistenceFilterChange)return{filter:{count:watchChange.existenceFilter.count,targetId:watchChange.targetId}};if(watchChange instanceof DocumentWatchChange){if(watchChange.newDoc instanceof Document){var doc=watchChange.newDoc;return{documentChange:{document:{name:this.toName(doc.key),fields:this.toFields(doc.data),updateTime:this.toVersion(doc.version)},targetIds:watchChange.updatedTargetIds,removedTargetIds:watchChange.removedTargetIds}}}if(watchChange.newDoc instanceof NoDocument){var doc=watchChange.newDoc;return{documentDelete:{document:this.toName(doc.key),readTime:this.toVersion(doc.version),removedTargetIds:watchChange.removedTargetIds}}}if(null===watchChange.newDoc)return{documentRemove:{document:this.toName(watchChange.key),removedTargetIds:watchChange.removedTargetIds}}}if(watchChange instanceof WatchTargetChange){var cause;return watchChange.cause&&(cause={code:mapRpcCodeFromCode(watchChange.cause.code),message:watchChange.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(watchChange.state),targetIds:watchChange.targetIds,resumeToken:this.unsafeCastProtoByteString(watchChange.resumeToken),cause:cause}}}return fail('Unrecognized watch change: '+JSON.stringify(watchChange))},JsonProtoSerializer.prototype.fromWatchChange=function(change){var type=change.response_type,watchChange;if(hasTag(change,type,'targetChange')){assertPresent(change.targetChange,'targetChange');var state=this.fromWatchTargetChangeState(change.targetChange.targetChangeType||'NO_CHANGE'),targetIds=change.targetChange.targetIds||[],resumeToken=change.targetChange.resumeToken||this.emptyByteString(),causeProto=change.targetChange.cause,cause=causeProto&&this.fromRpcStatus(causeProto);watchChange=new WatchTargetChange(state,targetIds,resumeToken,cause||null)}else if(hasTag(change,type,'documentChange')){assertPresent(change.documentChange,'documentChange'),assertPresent(change.documentChange.document,'documentChange.name'),assertPresent(change.documentChange.document.name,'documentChange.document.name'),assertPresent(change.documentChange.document.updateTime,'documentChange.document.updateTime');var entityChange=change.documentChange,key=this.fromName(entityChange.document.name),version=this.fromVersion(entityChange.document.updateTime),fields=this.fromFields(entityChange.document.fields||{}),doc=new Document(key,version,fields,{}),updatedTargetIds=entityChange.targetIds||[],removedTargetIds=entityChange.removedTargetIds||[];watchChange=new DocumentWatchChange(updatedTargetIds,removedTargetIds,doc.key,doc)}else if(hasTag(change,type,'documentDelete')){assertPresent(change.documentDelete,'documentDelete'),assertPresent(change.documentDelete.document,'documentDelete.document');var docDelete=change.documentDelete,key=this.fromName(docDelete.document),version=docDelete.readTime?this.fromVersion(docDelete.readTime):SnapshotVersion.forDeletedDoc(),doc=new NoDocument(key,version),removedTargetIds=docDelete.removedTargetIds||[];watchChange=new DocumentWatchChange([],removedTargetIds,doc.key,doc)}else if(hasTag(change,type,'documentRemove')){assertPresent(change.documentRemove,'documentRemove'),assertPresent(change.documentRemove.document,'documentRemove');var docRemove=change.documentRemove,key=this.fromName(docRemove.document),removedTargetIds=docRemove.removedTargetIds||[];watchChange=new DocumentWatchChange([],removedTargetIds,key,null)}else if(hasTag(change,type,'filter')){assertPresent(change.filter,'filter'),assertPresent(change.filter.targetId,'filter.targetId');var filter=change.filter,count=filter.count||0,existenceFilter=new ExistenceFilter(count),targetId=filter.targetId;watchChange=new ExistenceFilterChange(targetId,existenceFilter)}else return fail('Unknown change type '+JSON.stringify(change));return watchChange},JsonProtoSerializer.prototype.fromWatchTargetChangeState=function(state){return'NO_CHANGE'===state?WatchTargetChangeState.NoChange:'ADD'===state?WatchTargetChangeState.Added:'REMOVE'===state?WatchTargetChangeState.Removed:'CURRENT'===state?WatchTargetChangeState.Current:'RESET'===state?WatchTargetChangeState.Reset:fail('Got unexpected TargetChange.state: '+state)},JsonProtoSerializer.prototype.versionFromListenResponse=function(change){var type=change.response_type;if(!hasTag(change,type,'targetChange'))return SnapshotVersion.MIN;var targetChange=change.targetChange;return targetChange.targetIds&&targetChange.targetIds.length?SnapshotVersion.MIN:targetChange.readTime?this.fromVersion(targetChange.readTime):SnapshotVersion.MIN},JsonProtoSerializer.prototype.toMutation=function(mutation){var _this=this,result;if(mutation instanceof SetMutation)result={update:this.toMutationDocument(mutation.key,mutation.value)};else if(mutation instanceof DeleteMutation)result={delete:this.toName(mutation.key)};else if(mutation instanceof PatchMutation)result={update:this.toMutationDocument(mutation.key,mutation.data),updateMask:this.toDocumentMask(mutation.fieldMask)};else if(mutation instanceof TransformMutation)result={transform:{document:this.toName(mutation.key),fieldTransforms:mutation.fieldTransforms.map(function(transform){return _this.toFieldTransform(transform)})}};else return fail('Unknown mutation type '+mutation.type);return mutation.precondition.isNone||(result.currentDocument=this.toPrecondition(mutation.precondition)),result},JsonProtoSerializer.prototype.fromMutation=function(proto){var _this=this,precondition=proto.currentDocument?this.fromPrecondition(proto.currentDocument):Precondition.NONE;if(proto.update){assertPresent(proto.update.name,'name');var key=this.fromName(proto.update.name),value=this.fromFields(proto.update.fields||{});if(proto.updateMask){var fieldMask=this.fromDocumentMask(proto.updateMask);return new PatchMutation(key,value,fieldMask,precondition)}return new SetMutation(key,value,precondition)}if(proto.delete){var key=this.fromName(proto.delete);return new DeleteMutation(key,precondition)}if(proto.transform){var key=this.fromName(proto.transform.document),fieldTransforms=proto.transform.fieldTransforms.map(function(transform){return _this.fromFieldTransform(transform)});return assert(!0===precondition.exists,'Transforms only support precondition "exists == true"'),new TransformMutation(key,fieldTransforms)}return fail('unknown mutation proto: '+JSON.stringify(proto))},JsonProtoSerializer.prototype.toPrecondition=function(precondition){return assert(!precondition.isNone,'Can\'t serialize an empty precondition'),void 0===precondition.updateTime?void 0===precondition.exists?fail('Unknown precondition'):{exists:precondition.exists}:{updateTime:this.toVersion(precondition.updateTime)}},JsonProtoSerializer.prototype.fromPrecondition=function(precondition){return void 0===precondition.updateTime?void 0===precondition.exists?Precondition.NONE:Precondition.exists(precondition.exists):Precondition.updateTime(this.fromVersion(precondition.updateTime))},JsonProtoSerializer.prototype.fromWriteResult=function(proto,commitTime){var _this=this,version=proto.updateTime?this.fromVersion(proto.updateTime):this.fromVersion(commitTime),transformResults=null;return proto.transformResults&&0<proto.transformResults.length&&(transformResults=proto.transformResults.map(function(result){return _this.fromValue(result)})),new MutationResult(version,transformResults)},JsonProtoSerializer.prototype.fromWriteResults=function(protos,commitTime){var _this=this;return protos&&0<protos.length?(assert(void 0!==commitTime,'Received a write result without a commit time'),protos.map(function(proto){return _this.fromWriteResult(proto,commitTime)})):[]},JsonProtoSerializer.prototype.toFieldTransform=function(fieldTransform){var _this=this,transform=fieldTransform.transform;if(transform instanceof ServerTimestampTransform)return{fieldPath:fieldTransform.field.canonicalString(),setToServerValue:'REQUEST_TIME'};if(transform instanceof ArrayUnionTransformOperation)return{fieldPath:fieldTransform.field.canonicalString(),appendMissingElements:{values:transform.elements.map(function(v){return _this.toValue(v)})}};if(transform instanceof ArrayRemoveTransformOperation)return{fieldPath:fieldTransform.field.canonicalString(),removeAllFromArray:{values:transform.elements.map(function(v){return _this.toValue(v)})}};throw fail('Unknown transform: '+fieldTransform.transform)},JsonProtoSerializer.prototype.fromFieldTransform=function(proto){var _this=this,type=proto.transform_type,transform=null;if(hasTag(proto,type,'setToServerValue'))assert('REQUEST_TIME'===proto.setToServerValue,'Unknown server value transform proto: '+JSON.stringify(proto)),transform=ServerTimestampTransform.instance;else if(hasTag(proto,type,'appendMissingElements')){var values$$1=proto.appendMissingElements.values||[];transform=new ArrayUnionTransformOperation(values$$1.map(function(v){return _this.fromValue(v)}))}else if(hasTag(proto,type,'removeAllFromArray')){var values$$1=proto.removeAllFromArray.values||[];transform=new ArrayRemoveTransformOperation(values$$1.map(function(v){return _this.fromValue(v)}))}else fail('Unknown transform proto: '+JSON.stringify(proto));var fieldPath=FieldPath.fromServerFormat(proto.fieldPath);return new FieldTransform(fieldPath,transform)},JsonProtoSerializer.prototype.toDocumentsTarget=function(query){return{documents:[this.toQueryPath(query.path)]}},JsonProtoSerializer.prototype.fromDocumentsTarget=function(documentsTarget){var count=documentsTarget.documents.length;assert(1===count,'DocumentsTarget contained other than 1 document: '+count);var name=documentsTarget.documents[0];return Query.atPath(this.fromQueryPath(name))},JsonProtoSerializer.prototype.toQueryTarget=function(query){var result={structuredQuery:{}};if(query.path.isEmpty())result.parent=this.toQueryPath(ResourcePath.EMPTY_PATH);else{var path=query.path;assert(0!=path.length%2,'Document queries with filters are not supported.'),result.parent=this.toQueryPath(path.popLast()),result.structuredQuery.from=[{collectionId:path.lastSegment()}]}var where=this.toFilter(query.filters);where&&(result.structuredQuery.where=where);var orderBy=this.toOrder(query.orderBy);orderBy&&(result.structuredQuery.orderBy=orderBy);var limit=this.toInt32Value(query.limit);return void 0!==limit&&(result.structuredQuery.limit=limit),query.startAt&&(result.structuredQuery.startAt=this.toCursor(query.startAt)),query.endAt&&(result.structuredQuery.endAt=this.toCursor(query.endAt)),result},JsonProtoSerializer.prototype.fromQueryTarget=function(target){var path=this.fromQueryPath(target.parent),query=target.structuredQuery,fromCount=query.from?query.from.length:0;if(0<fromCount){assert(1===fromCount,'StructuredQuery.from with more than one collection is not supported.');var from=query.from[0];path=path.child(from.collectionId)}var filterBy=[];query.where&&(filterBy=this.fromFilter(query.where));var orderBy=[];query.orderBy&&(orderBy=this.fromOrder(query.orderBy));var limit=null;query.limit&&(limit=this.fromInt32Value(query.limit));var startAt=null;query.startAt&&(startAt=this.fromCursor(query.startAt));var endAt=null;return query.endAt&&(endAt=this.fromCursor(query.endAt)),new Query(path,orderBy,filterBy,limit,startAt,endAt)},JsonProtoSerializer.prototype.toListenRequestLabels=function(queryData){var value=this.toLabel(queryData.purpose);return null==value?null:{"goog-listen-tags":value}},JsonProtoSerializer.prototype.toLabel=function(purpose){return purpose===QueryPurpose.Listen?null:purpose===QueryPurpose.ExistenceFilterMismatch?'existence-filter-mismatch':purpose===QueryPurpose.LimboResolution?'limbo-document':fail('Unrecognized query purpose: '+purpose)},JsonProtoSerializer.prototype.toTarget=function(queryData){var query=queryData.query,result;return result=query.isDocumentQuery()?{documents:this.toDocumentsTarget(query)}:{query:this.toQueryTarget(query)},result.targetId=queryData.targetId,0<queryData.resumeToken.length&&(result.resumeToken=this.unsafeCastProtoByteString(queryData.resumeToken)),result},JsonProtoSerializer.prototype.toFilter=function(filters){var _this=this;if(0!==filters.length){var protos=filters.map(function(filter){return filter instanceof RelationFilter?_this.toRelationFilter(filter):_this.toUnaryFilter(filter)});return 1===protos.length?protos[0]:{compositeFilter:{op:'AND',filters:protos}}}},JsonProtoSerializer.prototype.fromFilter=function(filter){var _this=this;return filter?void 0===filter.unaryFilter?void 0===filter.fieldFilter?void 0===filter.compositeFilter?fail('Unknown filter: '+JSON.stringify(filter)):filter.compositeFilter.filters.map(function(f){return _this.fromFilter(f)}).reduce(function(accum,current){return accum.concat(current)}):[this.fromRelationFilter(filter)]:[this.fromUnaryFilter(filter)]:[]},JsonProtoSerializer.prototype.toOrder=function(orderBys){var _this=this;return 0===orderBys.length?void 0:orderBys.map(function(order){return _this.toPropertyOrder(order)})},JsonProtoSerializer.prototype.fromOrder=function(orderBys){var _this=this;return orderBys.map(function(order){return _this.fromPropertyOrder(order)})},JsonProtoSerializer.prototype.toCursor=function(cursor){var _this=this;return{before:cursor.before,values:cursor.position.map(function(component){return _this.toValue(component)})}},JsonProtoSerializer.prototype.fromCursor=function(cursor){var _this=this,before=!!cursor.before,position=cursor.values.map(function(component){return _this.fromValue(component)});return new Bound(position,before)},JsonProtoSerializer.prototype.toDirection=function(dir){return DIRECTIONS[dir.name]},JsonProtoSerializer.prototype.fromDirection=function(dir){return'ASCENDING'===dir?Direction.ASCENDING:'DESCENDING'===dir?Direction.DESCENDING:void 0},JsonProtoSerializer.prototype.toOperatorName=function(op){return OPERATORS[op.name]},JsonProtoSerializer.prototype.fromOperatorName=function(op){return'EQUAL'===op?RelationOp.EQUAL:'GREATER_THAN'===op?RelationOp.GREATER_THAN:'GREATER_THAN_OR_EQUAL'===op?RelationOp.GREATER_THAN_OR_EQUAL:'LESS_THAN'===op?RelationOp.LESS_THAN:'LESS_THAN_OR_EQUAL'===op?RelationOp.LESS_THAN_OR_EQUAL:'ARRAY_CONTAINS'===op?RelationOp.ARRAY_CONTAINS:'OPERATOR_UNSPECIFIED'===op?fail('Unspecified relation'):fail('Unknown relation')},JsonProtoSerializer.prototype.toFieldPathReference=function(path){return{fieldPath:path.canonicalString()}},JsonProtoSerializer.prototype.fromFieldPathReference=function(fieldReference){return FieldPath.fromServerFormat(fieldReference.fieldPath)},JsonProtoSerializer.prototype.toPropertyOrder=function(orderBy){return{field:this.toFieldPathReference(orderBy.field),direction:this.toDirection(orderBy.dir)}},JsonProtoSerializer.prototype.fromPropertyOrder=function(orderBy){return new OrderBy(this.fromFieldPathReference(orderBy.field),this.fromDirection(orderBy.direction))},JsonProtoSerializer.prototype.toRelationFilter=function(filter){return filter instanceof RelationFilter?{fieldFilter:{field:this.toFieldPathReference(filter.field),op:this.toOperatorName(filter.op),value:this.toValue(filter.value)}}:fail('Unrecognized filter: '+JSON.stringify(filter))},JsonProtoSerializer.prototype.fromRelationFilter=function(filter){return new RelationFilter(this.fromFieldPathReference(filter.fieldFilter.field),this.fromOperatorName(filter.fieldFilter.op),this.fromValue(filter.fieldFilter.value))},JsonProtoSerializer.prototype.toUnaryFilter=function(filter){return filter instanceof NanFilter?{unaryFilter:{field:this.toFieldPathReference(filter.field),op:'IS_NAN'}}:filter instanceof NullFilter?{unaryFilter:{field:this.toFieldPathReference(filter.field),op:'IS_NULL'}}:fail('Unrecognized filter: '+JSON.stringify(filter))},JsonProtoSerializer.prototype.fromUnaryFilter=function(filter){switch(filter.unaryFilter.op){case'IS_NAN':var nanField=this.fromFieldPathReference(filter.unaryFilter.field);return new NanFilter(nanField);case'IS_NULL':var nullField=this.fromFieldPathReference(filter.unaryFilter.field);return new NullFilter(nullField);case'OPERATOR_UNSPECIFIED':return fail('Unspecified filter');default:return fail('Unknown filter');}},JsonProtoSerializer.prototype.toDocumentMask=function(fieldMask){return{fieldPaths:fieldMask.fields.map(function(field){return field.canonicalString()})}},JsonProtoSerializer.prototype.fromDocumentMask=function(proto){var paths=proto.fieldPaths||[],fields=paths.map(function(path){return FieldPath.fromServerFormat(path)});return new FieldMask(fields)},JsonProtoSerializer}(),isReactNative=function(){return'object'==typeof navigator&&'ReactNative'===navigator.product},ERROR_NAME='FirebaseError',captureStackTrace=Error.captureStackTrace,FirebaseError=function(){return function FirebaseError(code,message){if(this.code=code,this.message=message,captureStackTrace)captureStackTrace(this,ErrorFactory.prototype.create);else try{throw Error.apply(this,arguments)}catch(err){this.name=ERROR_NAME,Object.defineProperty(this,'stack',{get:function(){return err.stack}})}}}();FirebaseError.prototype=Object.create(Error.prototype),FirebaseError.prototype.constructor=FirebaseError,FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors,this.pattern=/\{\$([^}]+)}/g}return ErrorFactory.prototype.create=function(code,data){void 0===data&&(data={});var template=this.errors[code],fullCode=this.service+'/'+code,message;message=void 0===template?'Error':template.replace(this.pattern,function(match,key){var value=data[key];return void 0===value?'<'+key+'?>':value.toString()}),message=this.serviceName+': '+message+' ('+fullCode+').';var err=new FirebaseError(fullCode,message);for(var prop in data)data.hasOwnProperty(prop)&&'_'!==prop.slice(-1)&&(err[prop]=data[prop]);return err},ErrorFactory}(),Hash=function(){return function Hash(){this.blockSize=-1}}(),Sha1=function(_super){function Sha1(){var _this=_super.call(this)||this;_this.chain_=[],_this.buf_=[],_this.W_=[],_this.pad_=[],_this.inbuf_=0,_this.total_=0,_this.blockSize=512/8,_this.pad_[0]=128;for(var i=1;i<_this.blockSize;++i)_this.pad_[i]=0;return _this.reset(),_this}return tslib_1.__extends(Sha1,_super),Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,opt_offset){opt_offset||(opt_offset=0);var W=this.W_;if('string'==typeof buf)for(var i=0;16>i;i++)W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3),opt_offset+=4;else for(var i=0;16>i;i++)W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3],opt_offset+=4;for(var i=16,t;80>i;i++)t=W[i-3]^W[i-8]^W[i-14]^W[i-16],W[i]=4294967295&(t<<1|t>>>31);for(var a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],i=0,f,k;80>i;i++){40>i?20>i?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):60>i?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=4294967295&(a<<5|a>>>27)+f+e+k+W[i];e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=4294967295&this.chain_[0]+a,this.chain_[1]=4294967295&this.chain_[1]+b,this.chain_[2]=4294967295&this.chain_[2]+c,this.chain_[3]=4294967295&this.chain_[3]+d,this.chain_[4]=4294967295&this.chain_[4]+e},Sha1.prototype.update=function(bytes,opt_length){if(null!=bytes){void 0===opt_length&&(opt_length=bytes.length);for(var lengthMinusBlock=opt_length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<opt_length;){if(0==inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if('string'==typeof bytes){for(;n<opt_length;)if(buf[inbuf]=bytes.charCodeAt(n),++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<opt_length;)if(buf[inbuf]=bytes[n],++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=opt_length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;56>this.inbuf_?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;56<=i;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);for(var n=0,i=0;5>i;i++)for(var j=24;0<=j;j-=8)digest[n]=255&this.chain_[i]>>j,++n;return digest},Sha1}(Hash),StreamBridge=function(){function StreamBridge(args){this.sendFn=args.sendFn,this.closeFn=args.closeFn}return StreamBridge.prototype.onOpen=function(callback){assert(!this.wrappedOnOpen,'Called onOpen on stream twice!'),this.wrappedOnOpen=callback},StreamBridge.prototype.onClose=function(callback){assert(!this.wrappedOnClose,'Called onClose on stream twice!'),this.wrappedOnClose=callback},StreamBridge.prototype.onMessage=function(callback){assert(!this.wrappedOnMessage,'Called onMessage on stream twice!'),this.wrappedOnMessage=callback},StreamBridge.prototype.close=function(){this.closeFn()},StreamBridge.prototype.send=function(msg){this.sendFn(msg)},StreamBridge.prototype.callOnOpen=function(){assert(void 0!==this.wrappedOnOpen,'Cannot call onOpen because no callback was set'),this.wrappedOnOpen()},StreamBridge.prototype.callOnClose=function(err){assert(void 0!==this.wrappedOnClose,'Cannot call onClose because no callback was set'),this.wrappedOnClose(err)},StreamBridge.prototype.callOnMessage=function(msg){assert(void 0!==this.wrappedOnMessage,'Cannot call onMessage because no callback was set'),this.wrappedOnMessage(msg)},StreamBridge}(),LOG_TAG='Connection',RPC_NAME_REST_MAPPING={BatchGetDocuments:'batchGet',Commit:'commit'},WebChannelConnection=function(){function WebChannelConnection(info){this.databaseId=info.databaseId,this.pool=new webchannelWrapper.XhrIoPool;var proto=info.ssl?'https':'http';this.baseUrl=proto+'://'+info.host}return WebChannelConnection.prototype.modifyHeadersForRequest=function(headers,token){if(token)for(var header in token.authHeaders)token.authHeaders.hasOwnProperty(header)&&(headers[header]=token.authHeaders[header]);headers['X-Goog-Api-Client']='gl-js/ fire/'+SDK_VERSION},WebChannelConnection.prototype.invokeRPC=function(rpcName,request,token){var _this=this,url=this.makeUrl(rpcName);return new Promise(function(resolve,reject){_this.pool.getObject(function(xhr){xhr.listenOnce(webchannelWrapper.EventType.COMPLETE,function(){try{switch(xhr.getLastErrorCode()){case webchannelWrapper.ErrorCode.NO_ERROR:var json=xhr.getResponseJson();debug(LOG_TAG,'XHR received:',JSON.stringify(json)),resolve(json);break;case webchannelWrapper.ErrorCode.TIMEOUT:debug(LOG_TAG,'RPC "'+rpcName+'" timed out'),reject(new FirestoreError(Code.DEADLINE_EXCEEDED,'Request time out'));break;case webchannelWrapper.ErrorCode.HTTP_ERROR:var status_1=xhr.getStatus();debug(LOG_TAG,'RPC "'+rpcName+'" failed with status:',status_1,'response text:',xhr.getResponseText()),0<status_1?reject(new FirestoreError(mapCodeFromHttpStatus(status_1),'Server responded with status '+xhr.getStatusText())):(debug(LOG_TAG,'RPC "'+rpcName+'" failed'),reject(new FirestoreError(Code.UNAVAILABLE,'Connection failed.')));break;default:fail('RPC "'+rpcName+'" failed with unanticipated '+'webchannel error '+xhr.getLastErrorCode()+': '+xhr.getLastError()+', giving up.');}}finally{debug(LOG_TAG,'RPC "'+rpcName+'" completed.'),_this.pool.releaseObject(xhr)}});var requestString=JSON.stringify(request);debug(LOG_TAG,'XHR sending: ',url+' '+requestString);var headers={"Content-Type":'text/plain'};_this.modifyHeadersForRequest(headers,token),xhr.send(url,'POST',requestString,headers,15)})})},WebChannelConnection.prototype.invokeStreamingRPC=function(rpcName,request,token){return this.invokeRPC(rpcName,request,token)},WebChannelConnection.prototype.openStream=function(rpcName,token){var urlParts=[this.baseUrl,'/','google.firestore.v1beta1.Firestore','/',rpcName,'/channel'],webchannelTransport=webchannelWrapper.createWebChannelTransport(),request={backgroundChannelTest:!0,httpSessionIdParam:'gsessionid',initMessageHeaders:{},messageUrlParams:{database:'projects/'+this.databaseId.projectId+'/databases/'+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(request.initMessageHeaders,token),isReactNative()||(request.httpHeadersOverwriteParam='$httpHeaders');var url=urlParts.join('');debug(LOG_TAG,'Creating WebChannel: '+url+' '+request);var channel=webchannelTransport.createWebChannel(url,request),opened=!1,closed=!1,streamBridge=new StreamBridge({sendFn:function(msg){closed?debug(LOG_TAG,'Not sending because WebChannel is closed:',msg):(!opened&&(debug(LOG_TAG,'Opening WebChannel transport.'),channel.open(),opened=!0),debug(LOG_TAG,'WebChannel sending:',msg),channel.send(msg))},closeFn:function(){return channel.close()}}),unguardedEventListen=function(type,fn){channel.listen(type,function(param){try{fn(param)}catch(e){setTimeout(function(){throw e},0)}})};return unguardedEventListen(webchannelWrapper.WebChannel.EventType.OPEN,function(){closed||debug(LOG_TAG,'WebChannel transport opened.')}),unguardedEventListen(webchannelWrapper.WebChannel.EventType.CLOSE,function(){closed||(closed=!0,debug(LOG_TAG,'WebChannel transport closed'),streamBridge.callOnClose())}),unguardedEventListen(webchannelWrapper.WebChannel.EventType.ERROR,function(err){closed||(closed=!0,debug(LOG_TAG,'WebChannel transport errored:',err),streamBridge.callOnClose(new FirestoreError(Code.UNAVAILABLE,'The operation could not be completed')))}),unguardedEventListen(webchannelWrapper.WebChannel.EventType.MESSAGE,function(msg){if(!closed){var msgData=msg.data[0];assert(!!msgData,'Got a webchannel message without data.');var error$$1=msgData.error||msgData[0]&&msgData[0].error;if(error$$1){debug(LOG_TAG,'WebChannel received error:',error$$1);var status_2=error$$1.status,code=mapCodeFromRpcStatus(status_2),message=error$$1.message;void 0===code&&(code=Code.INTERNAL,message='Unknown error status: '+status_2+' with message '+error$$1.message),closed=!0,streamBridge.callOnClose(new FirestoreError(code,message)),channel.close()}else debug(LOG_TAG,'WebChannel received:',msgData),streamBridge.callOnMessage(msgData)}}),setTimeout(function(){streamBridge.callOnOpen()},0),streamBridge},WebChannelConnection.prototype.makeUrl=function(rpcName){var urlRpcName=RPC_NAME_REST_MAPPING[rpcName];assert(void 0!==urlRpcName,'Unknown REST mapping for: '+rpcName);var url=[this.baseUrl,'/','v1beta1','/projects/',this.databaseId.projectId,'/databases/',this.databaseId.database,'/documents',':',urlRpcName];return url.join('')},WebChannelConnection}(),BrowserPlatform=function(){function BrowserPlatform(){this.emptyByteString='',this.base64Available='undefined'!=typeof atob}return Object.defineProperty(BrowserPlatform.prototype,'document',{get:function(){return'undefined'==typeof document?null:document},enumerable:!0,configurable:!0}),Object.defineProperty(BrowserPlatform.prototype,'window',{get:function(){return'undefined'==typeof window?null:window},enumerable:!0,configurable:!0}),BrowserPlatform.prototype.loadConnection=function(databaseInfo){return Promise.resolve(new WebChannelConnection(databaseInfo))},BrowserPlatform.prototype.newSerializer=function(databaseId){return new JsonProtoSerializer(databaseId,{useProto3Json:!0})},BrowserPlatform.prototype.formatJSON=function(value){return JSON.stringify(value)},BrowserPlatform.prototype.atob=function(encoded){return atob(encoded)},BrowserPlatform.prototype.btoa=function(raw){return btoa(raw)},BrowserPlatform}();PlatformSupport.setPlatform(new BrowserPlatform);var ListenSequence=function(){function ListenSequence(previousValue,sequenceNumberSyncer){var _this=this;this.previousValue=previousValue,sequenceNumberSyncer&&(sequenceNumberSyncer.sequenceNumberHandler=function(sequenceNumber){return _this.setPreviousValue(sequenceNumber)},this.writeNewSequenceNumber=function(sequenceNumber){return sequenceNumberSyncer.writeSequenceNumber(sequenceNumber)})}return ListenSequence.prototype.setPreviousValue=function(externalPreviousValue){return this.previousValue=_Mathmax(externalPreviousValue,this.previousValue),this.previousValue},ListenSequence.prototype.next=function(){var nextValue=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(nextValue),nextValue},ListenSequence.INVALID=-1,ListenSequence}(),Deferred$1=function(){return function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve,_this.reject=reject})}}(),TimerId;(function(TimerId){TimerId.All='all',TimerId.ListenStreamIdle='listen_stream_idle',TimerId.ListenStreamConnectionBackoff='listen_stream_connection_backoff',TimerId.WriteStreamIdle='write_stream_idle',TimerId.WriteStreamConnectionBackoff='write_stream_connection_backoff',TimerId.OnlineStateTimeout='online_state_timeout',TimerId.ClientMetadataRefresh='client_metadata_refresh'})(TimerId||(TimerId={}));var DelayedOperation=function(){function DelayedOperation(asyncQueue,timerId,targetTimeMs,op,removalCallback){this.asyncQueue=asyncQueue,this.timerId=timerId,this.targetTimeMs=targetTimeMs,this.op=op,this.removalCallback=removalCallback,this.deferred=new Deferred$1,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(){})}return DelayedOperation.createAndSchedule=function(asyncQueue,timerId,delayMs,op,removalCallback){var targetTime=Date.now()+delayMs,delayedOp=new DelayedOperation(asyncQueue,timerId,targetTime,op,removalCallback);return delayedOp.start(delayMs),delayedOp},DelayedOperation.prototype.start=function(delayMs){var _this=this;this.timerHandle=setTimeout(function(){return _this.handleDelayElapsed()},delayMs)},DelayedOperation.prototype.skipDelay=function(){return this.handleDelayElapsed()},DelayedOperation.prototype.cancel=function(reason){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(Code.CANCELLED,'Operation cancelled'+(reason?': '+reason:''))))},DelayedOperation.prototype.handleDelayElapsed=function(){var _this=this;this.asyncQueue.enqueueAndForget(function(){return null===_this.timerHandle?Promise.resolve():(_this.clearTimeout(),_this.op().then(function(result){return _this.deferred.resolve(result)}))})},DelayedOperation.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},DelayedOperation}(),AsyncQueue=function(){function AsyncQueue(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return AsyncQueue.prototype.enqueueAndForget=function(op){this.enqueue(op)},AsyncQueue.prototype.enqueue=function(op){var _this=this;this.verifyNotFailed();var newTail=this.tail.then(function(){return _this.operationInProgress=!0,op().catch(function(error$$1){_this.failure=error$$1,_this.operationInProgress=!1;var message=error$$1.stack||error$$1.message||'';throw error('INTERNAL UNHANDLED ERROR: ',message),0>message.indexOf('Firestore Test Simulated Error')&&setTimeout(function(){throw error$$1},0),error$$1}).then(function(result){return _this.operationInProgress=!1,result})});return this.tail=newTail,newTail},AsyncQueue.prototype.enqueueAfterDelay=function(timerId,delayMs,op){var _this=this;this.verifyNotFailed(),assert(0<=delayMs,'Attempted to schedule an operation with a negative delay of '+delayMs),assert(!this.containsDelayedOperation(timerId),'Attempted to schedule multiple operations with timer id '+timerId+'.');var delayedOp=DelayedOperation.createAndSchedule(this,timerId,delayMs,op,function(op){return _this.removeDelayedOperation(op)});return this.delayedOperations.push(delayedOp),delayedOp},AsyncQueue.prototype.verifyNotFailed=function(){this.failure&&fail('AsyncQueue is already failed: '+(this.failure.stack||this.failure.message))},AsyncQueue.prototype.verifyOperationInProgress=function(){assert(this.operationInProgress,'verifyOpInProgress() called when no op in progress on this queue.')},AsyncQueue.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},AsyncQueue.prototype.containsDelayedOperation=function(timerId){for(var _i=0,_a=this.delayedOperations,op;_i<_a.length;_i++)if(op=_a[_i],op.timerId===timerId)return!0;return!1},AsyncQueue.prototype.runDelayedOperationsEarly=function(lastTimerId){var _this=this;return this.drain().then(function(){assert(lastTimerId===TimerId.All||_this.containsDelayedOperation(lastTimerId),'Attempted to drain to missing operation '+lastTimerId),_this.delayedOperations.sort(function(a,b){return a.targetTimeMs-b.targetTimeMs});for(var _i=0,_a=_this.delayedOperations,op;_i<_a.length&&(op=_a[_i],op.skipDelay(),lastTimerId===TimerId.All||op.timerId!==lastTimerId);_i++);return _this.drain()})},AsyncQueue.prototype.removeDelayedOperation=function(op){var index=this.delayedOperations.indexOf(op);assert(0<=index,'Delayed operation not found.'),this.delayedOperations.splice(index,1)},AsyncQueue}(),escapeChar='\x01',encodedSeparatorChar='\x01',encodedNul='\x10',encodedEscape='\x11',BATCHID_UNKNOWN=-1,MutationBatch=function(){function MutationBatch(batchId,localWriteTime,mutations){this.batchId=batchId,this.localWriteTime=localWriteTime,this.mutations=mutations,assert(0<mutations.length,'Cannot create an empty mutation batch')}return MutationBatch.prototype.applyToRemoteDocument=function(docKey,maybeDoc,batchResult){maybeDoc&&assert(maybeDoc.key.isEqual(docKey),'applyToRemoteDocument: key '+docKey+' should match maybeDoc key\n        '+maybeDoc.key);var mutationResults=batchResult.mutationResults;assert(mutationResults.length===this.mutations.length,'Mismatch between mutations length\n      ('+this.mutations.length+') and mutation results length\n      ('+mutationResults.length+').');for(var i=0,mutation;i<this.mutations.length;i++)if(mutation=this.mutations[i],mutation.key.isEqual(docKey)){var mutationResult=mutationResults[i];maybeDoc=mutation.applyToRemoteDocument(maybeDoc,mutationResult)}return maybeDoc},MutationBatch.prototype.applyToLocalView=function(docKey,maybeDoc){maybeDoc&&assert(maybeDoc.key.isEqual(docKey),'applyToLocalDocument: key '+docKey+' should match maybeDoc key\n        '+maybeDoc.key);for(var baseDoc=maybeDoc,i=0,mutation;i<this.mutations.length;i++)mutation=this.mutations[i],mutation.key.isEqual(docKey)&&(maybeDoc=mutation.applyToLocalView(maybeDoc,baseDoc,this.localWriteTime));return maybeDoc},MutationBatch.prototype.keys=function(){for(var keySet=documentKeySet(),_i=0,_a=this.mutations,mutation;_i<_a.length;_i++)mutation=_a[_i],keySet=keySet.add(mutation.key);return keySet},MutationBatch.prototype.isEqual=function(other){return this.batchId===other.batchId&&arrayEquals(this.mutations,other.mutations)},MutationBatch}(),MutationBatchResult=function(){function MutationBatchResult(batch,commitVersion,mutationResults,streamToken,docVersions){this.batch=batch,this.commitVersion=commitVersion,this.mutationResults=mutationResults,this.streamToken=streamToken,this.docVersions=docVersions}return MutationBatchResult.from=function(batch,commitVersion,results,streamToken){assert(batch.mutations.length===results.length,'Mutations sent '+batch.mutations.length+' must equal results received '+results.length);for(var versionMap=documentVersionMap(),mutations=batch.mutations,i=0;i<mutations.length;i++)versionMap=versionMap.insert(mutations[i].key,results[i].version);return new MutationBatchResult(batch,commitVersion,results,streamToken,versionMap)},MutationBatchResult}(),PersistencePromise=function(){function PersistencePromise(callback){var _this=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,callback(function(value){_this.isDone=!0,_this.result=value,_this.nextCallback&&_this.nextCallback(value)},function(error){_this.isDone=!0,_this.error=error,_this.catchCallback&&_this.catchCallback(error)})}return PersistencePromise.prototype.catch=function(fn){return this.next(void 0,fn)},PersistencePromise.prototype.next=function(nextFn,catchFn){var _this=this;return this.callbackAttached&&fail('Called next() or catch() twice for PersistencePromise'),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(catchFn,this.error):this.wrapSuccess(nextFn,this.result):new PersistencePromise(function(resolve,reject){_this.nextCallback=function(value){_this.wrapSuccess(nextFn,value).next(resolve,reject)},_this.catchCallback=function(error){_this.wrapFailure(catchFn,error).next(resolve,reject)}})},PersistencePromise.prototype.toPromise=function(){var _this=this;return new Promise(function(resolve,reject){_this.next(resolve,reject)})},PersistencePromise.prototype.wrapUserFunction=function(fn){try{var result=fn();return result instanceof PersistencePromise?result:PersistencePromise.resolve(result)}catch(e){return PersistencePromise.reject(e)}},PersistencePromise.prototype.wrapSuccess=function(nextFn,value){return nextFn?this.wrapUserFunction(function(){return nextFn(value)}):PersistencePromise.resolve(value)},PersistencePromise.prototype.wrapFailure=function(catchFn,error){return catchFn?this.wrapUserFunction(function(){return catchFn(error)}):PersistencePromise.reject(error)},PersistencePromise.resolve=function(result){return new PersistencePromise(function(resolve){resolve(result)})},PersistencePromise.reject=function(error){return new PersistencePromise(function(resolve,reject){reject(error)})},PersistencePromise.waitFor=function(all){return new PersistencePromise(function(resolve,reject){var expectedCount=0,resolvedCount=0,done=!1;all.forEach(function(element){++expectedCount,element.next(function(){++resolvedCount,done&&resolvedCount==expectedCount&&resolve()},function(err){return reject(err)})}),done=!0,resolvedCount==expectedCount&&resolve()})},PersistencePromise.or=function(predicates){for(var p=PersistencePromise.resolve(!1),_loop_1=function(predicate){p=p.next(function(isTrue){return isTrue?PersistencePromise.resolve(isTrue):predicate()})},_i=0,predicates_1=predicates,predicate;_i<predicates_1.length;_i++)predicate=predicates_1[_i],_loop_1(predicate);return p},PersistencePromise.forEach=function(collection,f){var _this=this,promises=[];return collection.forEach(function(r,s){promises.push(f.call(_this,r,s))}),this.waitFor(promises)},PersistencePromise}(),ObjectMap=function(){function ObjectMap(mapKeyFn){this.mapKeyFn=mapKeyFn,this.inner={}}return ObjectMap.prototype.get=function(key){var id=this.mapKeyFn(key),matches=this.inner[id];if(void 0!==matches)for(var _i=0,matches_1=matches;_i<matches_1.length;_i++){var _a=matches_1[_i],otherKey=_a[0],value=_a[1];if(otherKey.isEqual(key))return value}},ObjectMap.prototype.has=function(key){return void 0!==this.get(key)},ObjectMap.prototype.set=function(key,value){var id=this.mapKeyFn(key),matches=this.inner[id];if(void 0===matches)return void(this.inner[id]=[[key,value]]);for(var i=0;i<matches.length;i++)if(matches[i][0].isEqual(key))return void(matches[i]=[key,value]);matches.push([key,value])},ObjectMap.prototype.delete=function(key){var id=this.mapKeyFn(key),matches=this.inner[id];if(void 0===matches)return!1;for(var i=0;i<matches.length;i++)if(matches[i][0].isEqual(key))return 1===matches.length?delete this.inner[id]:matches.splice(i,1),!0;return!1},ObjectMap.prototype.forEach=function(fn){forEach(this.inner,function(_,entries){for(var _i=0,entries_1=entries;_i<entries_1.length;_i++){var _a=entries_1[_i],k=_a[0],v=_a[1];fn(k,v)}})},ObjectMap.prototype.isEmpty=function(){return isEmpty(this.inner)},ObjectMap}(),RemoteDocumentChangeBuffer=function(){function RemoteDocumentChangeBuffer(){this.changes=maybeDocumentMap(),this.documentSizes=new ObjectMap(function(key){return key.toString()})}return RemoteDocumentChangeBuffer.prototype.addEntry=function(maybeDocument){var changes=this.assertChanges();this.changes=changes.insert(maybeDocument.key,maybeDocument)},RemoteDocumentChangeBuffer.prototype.getEntry=function(transaction,documentKey){var _this=this,changes=this.assertChanges(),bufferedEntry=changes.get(documentKey);return bufferedEntry?PersistencePromise.resolve(bufferedEntry):this.getFromCache(transaction,documentKey).next(function(getResult){return null===getResult?(_this.documentSizes.set(documentKey,0),null):(_this.documentSizes.set(documentKey,getResult.size),getResult.maybeDocument)})},RemoteDocumentChangeBuffer.prototype.apply=function(transaction){var result=this.applyChanges(transaction);return this.changes=null,result},RemoteDocumentChangeBuffer.prototype.assertChanges=function(){return assert(null!==this.changes,'Changes have already been applied.'),this.changes},RemoteDocumentChangeBuffer}(),LOG_TAG$1='SimpleDb',SimpleDb=function(){function SimpleDb(db){this.db=db}return SimpleDb.openOrCreate=function(name,version,schemaConverter){return assert(SimpleDb.isAvailable(),'IndexedDB not supported in current environment.'),debug(LOG_TAG$1,'Opening database:',name),new PersistencePromise(function(resolve,reject){var request=window.indexedDB.open(name,version);request.onsuccess=function(event){var db=event.target.result;resolve(new SimpleDb(db))},request.onblocked=function(){reject(new FirestoreError(Code.FAILED_PRECONDITION,'Cannot upgrade IndexedDB schema while another tab is open. '+'Close all tabs that access Firestore and reload this page to proceed.'))},request.onerror=function(event){reject(event.target.error)},request.onupgradeneeded=function(event){debug(LOG_TAG$1,'Database "'+name+'" requires upgrade from version:',event.oldVersion);var db=event.target.result,txn=new SimpleDbTransaction(request.transaction);schemaConverter.createOrUpgrade(db,txn,event.oldVersion,SCHEMA_VERSION).next(function(){debug(LOG_TAG$1,'Database upgrade to version '+SCHEMA_VERSION+' complete')})}}).toPromise()},SimpleDb.delete=function(name){return debug(LOG_TAG$1,'Removing database:',name),wrapRequest(window.indexedDB.deleteDatabase(name)).toPromise()},SimpleDb.isAvailable=function(){if('undefined'==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return'YES'===process.env.USE_MOCK_PERSISTENCE;var ua=window.navigator.userAgent;return 0<ua.indexOf('MSIE ')||0<ua.indexOf('Trident/')||0<ua.indexOf('Edge/')?!1:!0},SimpleDb.getStore=function(txn,store){return txn.store(store)},SimpleDb.prototype.runTransaction=function(mode,objectStores,transactionFn){var transaction=SimpleDbTransaction.open(this.db,mode,objectStores),transactionFnResult=transactionFn(transaction).catch(function(error$$1){transaction.abort(error$$1)}).toPromise();return transaction.completionPromise.then(function(){return transactionFnResult})},SimpleDb.prototype.close=function(){this.db.close()},SimpleDb}(),IterationController=function(){function IterationController(dbCursor){this.dbCursor=dbCursor,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(IterationController.prototype,'isDone',{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(IterationController.prototype,'skipToKey',{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(IterationController.prototype,'cursor',{set:function(value){this.dbCursor=value},enumerable:!0,configurable:!0}),IterationController.prototype.done=function(){this.shouldStop=!0},IterationController.prototype.skip=function(key){this.nextKey=key},IterationController.prototype.delete=function(){return wrapRequest(this.dbCursor.delete())},IterationController}(),SimpleDbTransaction=function(){function SimpleDbTransaction(transaction){var _this=this;this.transaction=transaction,this.aborted=!1,this.completionDeferred=new Deferred$1,this.transaction.oncomplete=function(){_this.completionDeferred.resolve()},this.transaction.onabort=function(){transaction.error?_this.completionDeferred.reject(transaction.error):_this.completionDeferred.resolve()},this.transaction.onerror=function(event){_this.completionDeferred.reject(event.target.error)}}return SimpleDbTransaction.open=function(db,mode,objectStoreNames){return new SimpleDbTransaction(db.transaction(objectStoreNames,mode))},Object.defineProperty(SimpleDbTransaction.prototype,'completionPromise',{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),SimpleDbTransaction.prototype.abort=function(error$$1){error$$1&&this.completionDeferred.reject(error$$1),this.aborted||(debug(LOG_TAG$1,'Aborting transaction:',error$$1?error$$1.message:'Client-initiated abort'),this.aborted=!0,this.transaction.abort())},SimpleDbTransaction.prototype.store=function(storeName){var store=this.transaction.objectStore(storeName);return assert(!!store,'Object store not part of transaction: '+storeName),new SimpleDbStore(store)},SimpleDbTransaction}(),SimpleDbStore=function(){function SimpleDbStore(store){this.store=store}return SimpleDbStore.prototype.put=function(keyOrValue,value){var request;return void 0===value?(debug(LOG_TAG$1,'PUT',this.store.name,'<auto-key>',keyOrValue),request=this.store.put(keyOrValue)):(debug(LOG_TAG$1,'PUT',this.store.name,keyOrValue,value),request=this.store.put(value,keyOrValue)),wrapRequest(request)},SimpleDbStore.prototype.add=function(value){debug(LOG_TAG$1,'ADD',this.store.name,value,value);var request=this.store.add(value);return wrapRequest(request)},SimpleDbStore.prototype.get=function(key){var _this=this,request=this.store.get(key);return wrapRequest(request).next(function(result){return void 0===result&&(result=null),debug(LOG_TAG$1,'GET',_this.store.name,key,result),result})},SimpleDbStore.prototype.delete=function(key){debug(LOG_TAG$1,'DELETE',this.store.name,key);var request=this.store.delete(key);return wrapRequest(request)},SimpleDbStore.prototype.count=function(){debug(LOG_TAG$1,'COUNT',this.store.name);var request=this.store.count();return wrapRequest(request)},SimpleDbStore.prototype.loadAll=function(indexOrRange,range){var cursor=this.cursor(this.options(indexOrRange,range)),results=[];return this.iterateCursor(cursor,function(key,value){results.push(value)}).next(function(){return results})},SimpleDbStore.prototype.deleteAll=function(indexOrRange,range){debug(LOG_TAG$1,'DELETE ALL',this.store.name);var options=this.options(indexOrRange,range);options.keysOnly=!1;var cursor=this.cursor(options);return this.iterateCursor(cursor,function(key,value,control){return control.delete()})},SimpleDbStore.prototype.iterate=function(optionsOrCallback,callback){var options;callback?options=optionsOrCallback:(options={},callback=optionsOrCallback);var cursor=this.cursor(options);return this.iterateCursor(cursor,callback)},SimpleDbStore.prototype.iterateSerial=function(callback){var cursorRequest=this.cursor({});return new PersistencePromise(function(resolve,reject){cursorRequest.onerror=function(event){reject(event.target.error)},cursorRequest.onsuccess=function(event){var cursor=event.target.result;return cursor?void callback(cursor.primaryKey,cursor.value).next(function(shouldContinue){shouldContinue?cursor.continue():resolve()}):void resolve()}})},SimpleDbStore.prototype.iterateCursor=function(cursorRequest,fn){var results=[];return new PersistencePromise(function(resolve,reject){cursorRequest.onerror=function(event){reject(event.target.error)},cursorRequest.onsuccess=function(event){var cursor=event.target.result;if(!cursor)return void resolve();var controller=new IterationController(cursor),userResult=fn(cursor.primaryKey,cursor.value,controller);if(userResult instanceof PersistencePromise){var userPromise=userResult.catch(function(err){return controller.done(),PersistencePromise.reject(err)});results.push(userPromise)}controller.isDone?resolve():null===controller.skipToKey?cursor.continue():cursor.continue(controller.skipToKey)}}).next(function(){return PersistencePromise.waitFor(results)})},SimpleDbStore.prototype.options=function(indexOrRange,range){var indexName;return void 0!==indexOrRange&&('string'==typeof indexOrRange?indexName=indexOrRange:(assert(void 0===range,'3rd argument must not be defined if 2nd is a range.'),range=indexOrRange)),{index:indexName,range:range}},SimpleDbStore.prototype.cursor=function(options){var direction='next';if(options.reverse&&(direction='prev'),options.index){var index=this.store.index(options.index);return options.keysOnly?index.openKeyCursor(options.range,direction):index.openCursor(options.range,direction)}return this.store.openCursor(options.range,direction)},SimpleDbStore}(),REMOTE_DOCUMENT_CHANGE_MISSING_ERR_MSG='The remote document changelog no longer contains all changes for all '+'local query views. It may be necessary to rebuild these views.',IndexedDbRemoteDocumentCache=function(){function IndexedDbRemoteDocumentCache(serializer,keepDocumentChangeLog){this.serializer=serializer,this.keepDocumentChangeLog=keepDocumentChangeLog,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(IndexedDbRemoteDocumentCache.prototype,'lastProcessedDocumentChangeId',{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),IndexedDbRemoteDocumentCache.prototype.start=function(transaction){var store=SimpleDb.getStore(transaction,DbRemoteDocumentChanges.store);return this.synchronizeLastDocumentChangeId(store)},IndexedDbRemoteDocumentCache.prototype.addEntries=function(transaction,entries,sizeDelta){var promises=[];if(0<entries.length){for(var documentStore=remoteDocumentsStore(transaction),changedKeys=documentKeySet(),_i=0,entries_1=entries;_i<entries_1.length;_i++){var _a=entries_1[_i],key=_a.key,doc=_a.doc;promises.push(documentStore.put(dbKey(key),doc)),changedKeys=changedKeys.add(key)}this.keepDocumentChangeLog&&promises.push(documentChangesStore(transaction).put({changes:this.serializer.toDbResourcePaths(changedKeys)})),promises.push(this.updateSize(transaction,sizeDelta))}return PersistencePromise.waitFor(promises)},IndexedDbRemoteDocumentCache.prototype.removeEntry=function(transaction,documentKey){var store=remoteDocumentsStore(transaction),key=dbKey(documentKey);return store.get(key).next(function(document){return document?store.delete(key).next(function(){return dbDocumentSize(document)}):PersistencePromise.resolve(0)})},IndexedDbRemoteDocumentCache.prototype.getEntry=function(transaction,documentKey){var _this=this;return remoteDocumentsStore(transaction).get(dbKey(documentKey)).next(function(dbRemoteDoc){return dbRemoteDoc?_this.serializer.fromDbRemoteDocument(dbRemoteDoc):null})},IndexedDbRemoteDocumentCache.prototype.getSizedEntry=function(transaction,documentKey){var _this=this;return remoteDocumentsStore(transaction).get(dbKey(documentKey)).next(function(dbRemoteDoc){return dbRemoteDoc?{maybeDocument:_this.serializer.fromDbRemoteDocument(dbRemoteDoc),size:dbDocumentSize(dbRemoteDoc)}:null})},IndexedDbRemoteDocumentCache.prototype.getDocumentsMatchingQuery=function(transaction,query){var _this=this,results=documentMap(),startKey=query.path.toArray(),range=IDBKeyRange.lowerBound(startKey);return remoteDocumentsStore(transaction).iterate({range:range},function(key,dbRemoteDoc,control){var maybeDoc=_this.serializer.fromDbRemoteDocument(dbRemoteDoc);query.path.isPrefixOf(maybeDoc.key.path)?maybeDoc instanceof Document&&query.matches(maybeDoc)&&(results=results.insert(maybeDoc.key,maybeDoc)):control.done()}).next(function(){return results})},IndexedDbRemoteDocumentCache.prototype.getNewDocumentChanges=function(transaction){var _this=this;assert(this.keepDocumentChangeLog,'Can only call getNewDocumentChanges() when document change log is enabled');var changedKeys=documentKeySet(),changedDocs=maybeDocumentMap(),range=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),firstIteration=!0,changesStore=documentChangesStore(transaction);return changesStore.iterate({range:range},function(_,documentChange){return firstIteration&&(firstIteration=!1,_this._lastProcessedDocumentChangeId+1!==documentChange.id)?_this.synchronizeLastDocumentChangeId(changesStore).next(function(){return PersistencePromise.reject(new FirestoreError(Code.DATA_LOSS,REMOTE_DOCUMENT_CHANGE_MISSING_ERR_MSG))}):void(changedKeys=changedKeys.unionWith(_this.serializer.fromDbResourcePaths(documentChange.changes)),_this._lastProcessedDocumentChangeId=documentChange.id)}).next(function(){var documentPromises=[];return changedKeys.forEach(function(key){documentPromises.push(_this.getEntry(transaction,key).next(function(maybeDocument){var doc=maybeDocument||new NoDocument(key,SnapshotVersion.forDeletedDoc());changedDocs=changedDocs.insert(key,doc)}))}),PersistencePromise.waitFor(documentPromises)}).next(function(){return changedDocs})},IndexedDbRemoteDocumentCache.prototype.removeDocumentChangesThroughChangeId=function(transaction,changeId){var range=IDBKeyRange.upperBound(changeId);return documentChangesStore(transaction).delete(range)},IndexedDbRemoteDocumentCache.prototype.synchronizeLastDocumentChangeId=function(documentChangesStore){var _this=this;return this._lastProcessedDocumentChangeId=0,documentChangesStore.iterate({keysOnly:!0,reverse:!0},function(key,value,control){_this._lastProcessedDocumentChangeId=key,control.done()})},IndexedDbRemoteDocumentCache.prototype.newChangeBuffer=function(){return new IndexedDbRemoteDocumentChangeBuffer(this)},IndexedDbRemoteDocumentCache.prototype.getSize=function(txn){return this.getMetadata(txn).next(function(metadata){return metadata.byteSize})},IndexedDbRemoteDocumentCache.prototype.getMetadata=function(txn){return documentGlobalStore(txn).get(DbRemoteDocumentGlobal.key).next(function(metadata){return assert(!!metadata,'Missing document cache metadata'),metadata})},IndexedDbRemoteDocumentCache.prototype.setMetadata=function(txn,metadata){return documentGlobalStore(txn).put(DbRemoteDocumentGlobal.key,metadata)},IndexedDbRemoteDocumentCache.prototype.updateSize=function(txn,sizeDelta){var _this=this;return this.getMetadata(txn).next(function(metadata){return metadata.byteSize+=sizeDelta,_this.setMetadata(txn,metadata)})},IndexedDbRemoteDocumentCache}(),IndexedDbRemoteDocumentChangeBuffer=function(_super){function IndexedDbRemoteDocumentChangeBuffer(documentCache){var _this=_super.call(this)||this;return _this.documentCache=documentCache,_this}return tslib_1.__extends(IndexedDbRemoteDocumentChangeBuffer,_super),IndexedDbRemoteDocumentChangeBuffer.prototype.applyChanges=function(transaction){var _this=this,changes=this.assertChanges(),delta=0,toApply=[];return changes.forEach(function(key,maybeDocument){var doc=_this.documentCache.serializer.toDbRemoteDocument(maybeDocument),previousSize=_this.documentSizes.get(key);assert(void 0!==previousSize,'Attempting to change document '+key.toString()+' without having read it first');var size=dbDocumentSize(doc);delta+=size-previousSize,toApply.push({key:key,doc:doc})}),this.documentCache.addEntries(transaction,toApply,delta)},IndexedDbRemoteDocumentChangeBuffer.prototype.getFromCache=function(transaction,documentKey){return this.documentCache.getSizedEntry(transaction,documentKey)},IndexedDbRemoteDocumentChangeBuffer}(RemoteDocumentChangeBuffer),SCHEMA_VERSION=6,SchemaConverter=function(){function SchemaConverter(serializer){this.serializer=serializer}return SchemaConverter.prototype.createOrUpgrade=function(db,txn,fromVersion,toVersion){var _this=this;assert(fromVersion<toVersion&&0<=fromVersion&&toVersion<=SCHEMA_VERSION,'Unexpected schema upgrade from v'+fromVersion+' to v{toVersion}.'),1>fromVersion&&1<=toVersion&&(createPrimaryClientStore(db),createMutationQueue(db),createQueryCache(db),createRemoteDocumentCache(db));var p=PersistencePromise.resolve();return 3>fromVersion&&3<=toVersion&&(0!==fromVersion&&(dropQueryCache(db),createQueryCache(db)),p=p.next(function(){return writeEmptyTargetGlobalEntry(txn)})),4>fromVersion&&4<=toVersion&&(0!==fromVersion&&(p=p.next(function(){return upgradeMutationBatchSchemaAndMigrateData(db,txn)})),p=p.next(function(){createClientMetadataStore(db),createRemoteDocumentChangesStore(db)})),5>fromVersion&&5<=toVersion&&(p=p.next(function(){return _this.removeAcknowledgedMutations(txn)})),6>fromVersion&&6<=toVersion&&(p=p.next(function(){return createDocumentGlobalStore(db),_this.addDocumentGlobal(txn)})),p},SchemaConverter.prototype.addDocumentGlobal=function(txn){var byteCount=0;return txn.store(DbRemoteDocument.store).iterate(function(_,doc){byteCount+=dbDocumentSize(doc)}).next(function(){var metadata=new DbRemoteDocumentGlobal(byteCount);return txn.store(DbRemoteDocumentGlobal.store).put(DbRemoteDocumentGlobal.key,metadata)})},SchemaConverter.prototype.removeAcknowledgedMutations=function(txn){var _this=this,queuesStore=txn.store(DbMutationQueue.store),mutationsStore=txn.store(DbMutationBatch.store);return queuesStore.loadAll().next(function(queues){return PersistencePromise.forEach(queues,function(queue){var range=IDBKeyRange.bound([queue.userId,BATCHID_UNKNOWN],[queue.userId,queue.lastAcknowledgedBatchId]);return mutationsStore.loadAll(DbMutationBatch.userMutationsIndex,range).next(function(dbBatches){return PersistencePromise.forEach(dbBatches,function(dbBatch){assert(dbBatch.userId===queue.userId,'Cannot process batch '+dbBatch.batchId+' from unexpected user');var batch=_this.serializer.fromDbMutationBatch(dbBatch);return removeMutationBatch(txn,queue.userId,batch).next(function(){})})})})})},SchemaConverter}(),DbTimestamp=function(){return function DbTimestamp(seconds,nanoseconds){this.seconds=seconds,this.nanoseconds=nanoseconds}}(),DbPrimaryClient=function(){function DbPrimaryClient(ownerId,allowTabSynchronization,leaseTimestampMs){this.ownerId=ownerId,this.allowTabSynchronization=allowTabSynchronization,this.leaseTimestampMs=leaseTimestampMs}return DbPrimaryClient.store='owner',DbPrimaryClient.key='owner',DbPrimaryClient}(),DbMutationQueue=function(){function DbMutationQueue(userId,lastAcknowledgedBatchId,lastStreamToken){this.userId=userId,this.lastAcknowledgedBatchId=lastAcknowledgedBatchId,this.lastStreamToken=lastStreamToken}return DbMutationQueue.store='mutationQueues',DbMutationQueue.keyPath='userId',DbMutationQueue}(),DbMutationBatch=function(){function DbMutationBatch(userId,batchId,localWriteTimeMs,mutations){this.userId=userId,this.batchId=batchId,this.localWriteTimeMs=localWriteTimeMs,this.mutations=mutations}return DbMutationBatch.store='mutations',DbMutationBatch.keyPath='batchId',DbMutationBatch.userMutationsIndex='userMutationsIndex',DbMutationBatch.userMutationsKeyPath=['userId','batchId'],DbMutationBatch}(),DbDocumentMutation=function(){function DbDocumentMutation(){}return DbDocumentMutation.prefixForUser=function(userId){return[userId]},DbDocumentMutation.prefixForPath=function(userId,path){return[userId,encode(path)]},DbDocumentMutation.key=function(userId,path,batchId){return[userId,encode(path),batchId]},DbDocumentMutation.store='documentMutations',DbDocumentMutation.PLACEHOLDER=new DbDocumentMutation,DbDocumentMutation}(),DbNoDocument=function(){return function DbNoDocument(path,readTime){this.path=path,this.readTime=readTime}}(),DbUnknownDocument=function(){return function DbUnknownDocument(path,version){this.path=path,this.version=version}}(),DbRemoteDocument=function(){function DbRemoteDocument(unknownDocument,noDocument,document,hasCommittedMutations){this.unknownDocument=unknownDocument,this.noDocument=noDocument,this.document=document,this.hasCommittedMutations=hasCommittedMutations}return DbRemoteDocument.store='remoteDocuments',DbRemoteDocument}(),DbRemoteDocumentGlobal=function(){function DbRemoteDocumentGlobal(byteSize){this.byteSize=byteSize}return DbRemoteDocumentGlobal.store='remoteDocumentGlobal',DbRemoteDocumentGlobal.key='remoteDocumentGlobalKey',DbRemoteDocumentGlobal}(),DbTarget=function(){function DbTarget(targetId,canonicalId,readTime,resumeToken,lastListenSequenceNumber,query){this.targetId=targetId,this.canonicalId=canonicalId,this.readTime=readTime,this.resumeToken=resumeToken,this.lastListenSequenceNumber=lastListenSequenceNumber,this.query=query}return DbTarget.store='targets',DbTarget.keyPath='targetId',DbTarget.queryTargetsIndexName='queryTargetsIndex',DbTarget.queryTargetsKeyPath=['canonicalId','targetId'],DbTarget}(),DbTargetDocument=function(){function DbTargetDocument(targetId,path,sequenceNumber){this.targetId=targetId,this.path=path,this.sequenceNumber=sequenceNumber,assert(0===targetId==(void 0!==sequenceNumber),'A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number')}return DbTargetDocument.store='targetDocuments',DbTargetDocument.keyPath=['targetId','path'],DbTargetDocument.documentTargetsIndex='documentTargetsIndex',DbTargetDocument.documentTargetsKeyPath=['path','targetId'],DbTargetDocument}(),DbTargetGlobal=function(){function DbTargetGlobal(highestTargetId,highestListenSequenceNumber,lastRemoteSnapshotVersion,targetCount){this.highestTargetId=highestTargetId,this.highestListenSequenceNumber=highestListenSequenceNumber,this.lastRemoteSnapshotVersion=lastRemoteSnapshotVersion,this.targetCount=targetCount}return DbTargetGlobal.key='targetGlobalKey',DbTargetGlobal.store='targetGlobal',DbTargetGlobal}(),DbRemoteDocumentChanges=function(){function DbRemoteDocumentChanges(changes){this.changes=changes}return DbRemoteDocumentChanges.store='remoteDocumentChanges',DbRemoteDocumentChanges.keyPath='id',DbRemoteDocumentChanges}(),DbClientMetadata=function(){function DbClientMetadata(clientId,updateTimeMs,networkEnabled,inForeground,lastProcessedDocumentChangeId){this.clientId=clientId,this.updateTimeMs=updateTimeMs,this.networkEnabled=networkEnabled,this.inForeground=inForeground,this.lastProcessedDocumentChangeId=lastProcessedDocumentChangeId}return DbClientMetadata.store='clientMetadata',DbClientMetadata.keyPath='clientId',DbClientMetadata}(),V1_STORES=[DbMutationQueue.store,DbMutationBatch.store,DbDocumentMutation.store,DbRemoteDocument.store,DbTarget.store,DbPrimaryClient.store,DbTargetGlobal.store,DbTargetDocument.store],V4_STORES=V1_STORES.concat([DbClientMetadata.store,DbRemoteDocumentChanges.store]),V6_STORES=V4_STORES.concat([DbRemoteDocumentGlobal.store]),ALL_STORES=V6_STORES,IndexedDbMutationQueue=function(){function IndexedDbMutationQueue(userId,serializer,referenceDelegate){this.userId=userId,this.serializer=serializer,this.referenceDelegate=referenceDelegate,this.documentKeysByBatchId={}}return IndexedDbMutationQueue.forUser=function(user,serializer,referenceDelegate){assert(''!==user.uid,'UserID must not be an empty string.');var userId=user.isAuthenticated()?user.uid:'';return new IndexedDbMutationQueue(userId,serializer,referenceDelegate)},IndexedDbMutationQueue.prototype.checkEmpty=function(transaction){var empty=!0,range=IDBKeyRange.bound([this.userId,_NumberNEGATIVE_INFINITY],[this.userId,_NumberPOSITIVE_INFINITY]);return mutationsStore(transaction).iterate({index:DbMutationBatch.userMutationsIndex,range:range},function(key,value,control){empty=!1,control.done()}).next(function(){return empty})},IndexedDbMutationQueue.prototype.acknowledgeBatch=function(transaction,batch,streamToken){return this.getMutationQueueMetadata(transaction).next(function(metadata){var batchId=batch.batchId;return assert(batchId>metadata.lastAcknowledgedBatchId,'Mutation batchIDs must be acknowledged in order'),metadata.lastAcknowledgedBatchId=batchId,metadata.lastStreamToken=convertStreamToken(streamToken),mutationQueuesStore(transaction).put(metadata)})},IndexedDbMutationQueue.prototype.getLastStreamToken=function(transaction){return this.getMutationQueueMetadata(transaction).next(function(metadata){return metadata.lastStreamToken})},IndexedDbMutationQueue.prototype.setLastStreamToken=function(transaction,streamToken){return this.getMutationQueueMetadata(transaction).next(function(metadata){return metadata.lastStreamToken=convertStreamToken(streamToken),mutationQueuesStore(transaction).put(metadata)})},IndexedDbMutationQueue.prototype.addMutationBatch=function(transaction,localWriteTime,mutations){var _this=this,documentStore=documentMutationsStore(transaction),mutationStore=mutationsStore(transaction);return mutationStore.add({}).next(function(batchId){assert('number'==typeof batchId,'Auto-generated key is not a number');var batch=new MutationBatch(batchId,localWriteTime,mutations),dbBatch=_this.serializer.toDbMutationBatch(_this.userId,batch);_this.documentKeysByBatchId[batchId]=batch.keys();for(var promises=[],_i=0,mutations_1=mutations;_i<mutations_1.length;_i++){var mutation=mutations_1[_i],indexKey=DbDocumentMutation.key(_this.userId,mutation.key.path,batchId);promises.push(mutationStore.put(dbBatch)),promises.push(documentStore.put(indexKey,DbDocumentMutation.PLACEHOLDER))}return PersistencePromise.waitFor(promises).next(function(){return batch})})},IndexedDbMutationQueue.prototype.lookupMutationBatch=function(transaction,batchId){var _this=this;return mutationsStore(transaction).get(batchId).next(function(dbBatch){return dbBatch?(assert(dbBatch.userId===_this.userId,'Unexpected user \''+dbBatch.userId+'\' for mutation batch '+batchId),_this.serializer.fromDbMutationBatch(dbBatch)):null})},IndexedDbMutationQueue.prototype.lookupMutationKeys=function(transaction,batchId){var _this=this;return this.documentKeysByBatchId[batchId]?PersistencePromise.resolve(this.documentKeysByBatchId[batchId]):this.lookupMutationBatch(transaction,batchId).next(function(batch){if(batch){var keys=batch.keys();return _this.documentKeysByBatchId[batchId]=keys,keys}return null})},IndexedDbMutationQueue.prototype.getNextMutationBatchAfterBatchId=function(transaction,batchId){var _this=this;return this.getMutationQueueMetadata(transaction).next(function(metadata){var nextBatchId=_Mathmax(batchId,metadata.lastAcknowledgedBatchId)+1,range=IDBKeyRange.lowerBound([_this.userId,nextBatchId]),foundBatch=null;return mutationsStore(transaction).iterate({index:DbMutationBatch.userMutationsIndex,range:range},function(key,dbBatch,control){dbBatch.userId===_this.userId&&(assert(dbBatch.batchId>=nextBatchId,'Should have found mutation after '+nextBatchId),foundBatch=_this.serializer.fromDbMutationBatch(dbBatch)),control.done()}).next(function(){return foundBatch})})},IndexedDbMutationQueue.prototype.getAllMutationBatches=function(transaction){var _this=this,range=IDBKeyRange.bound([this.userId,BATCHID_UNKNOWN],[this.userId,_NumberPOSITIVE_INFINITY]);return mutationsStore(transaction).loadAll(DbMutationBatch.userMutationsIndex,range).next(function(dbBatches){return dbBatches.map(function(dbBatch){return _this.serializer.fromDbMutationBatch(dbBatch)})})},IndexedDbMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKey=function(transaction,documentKey){var _this=this,indexPrefix=DbDocumentMutation.prefixForPath(this.userId,documentKey.path),indexStart=IDBKeyRange.lowerBound(indexPrefix),results=[];return documentMutationsStore(transaction).iterate({range:indexStart},function(indexKey,_,control){var userID=indexKey[0],encodedPath=indexKey[1],batchId=indexKey[2],path=decode$1(encodedPath);return userID===_this.userId&&documentKey.path.isEqual(path)?mutationsStore(transaction).get(batchId).next(function(mutation){if(!mutation)throw fail('Dangling document-mutation reference found: '+indexKey+' which points to '+batchId);assert(mutation.userId===_this.userId,'Unexpected user \''+mutation.userId+'\' for mutation batch '+batchId),results.push(_this.serializer.fromDbMutationBatch(mutation))}):void control.done()}).next(function(){return results})},IndexedDbMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKeys=function(transaction,documentKeys){var _this=this,uniqueBatchIDs=new SortedSet(primitiveComparator),promises=[];return documentKeys.forEach(function(documentKey){var indexStart=DbDocumentMutation.prefixForPath(_this.userId,documentKey.path),range=IDBKeyRange.lowerBound(indexStart),promise=documentMutationsStore(transaction).iterate({range:range},function(indexKey,_,control){var userID=indexKey[0],encodedPath=indexKey[1],batchID=indexKey[2],path=decode$1(encodedPath);return userID===_this.userId&&documentKey.path.isEqual(path)?void(uniqueBatchIDs=uniqueBatchIDs.add(batchID)):void control.done()});promises.push(promise)}),PersistencePromise.waitFor(promises).next(function(){return _this.lookupMutationBatches(transaction,uniqueBatchIDs)})},IndexedDbMutationQueue.prototype.getAllMutationBatchesAffectingQuery=function(transaction,query){var _this=this;assert(!query.isDocumentQuery(),'Document queries shouldn\'t go down this path');var queryPath=query.path,immediateChildrenLength=queryPath.length+1,indexPrefix=DbDocumentMutation.prefixForPath(this.userId,queryPath),indexStart=IDBKeyRange.lowerBound(indexPrefix),uniqueBatchIDs=new SortedSet(primitiveComparator);return documentMutationsStore(transaction).iterate({range:indexStart},function(indexKey,_,control){var userID=indexKey[0],encodedPath=indexKey[1],batchID=indexKey[2],path=decode$1(encodedPath);return userID===_this.userId&&queryPath.isPrefixOf(path)?void(path.length!==immediateChildrenLength||(uniqueBatchIDs=uniqueBatchIDs.add(batchID))):void control.done()}).next(function(){return _this.lookupMutationBatches(transaction,uniqueBatchIDs)})},IndexedDbMutationQueue.prototype.lookupMutationBatches=function(transaction,batchIDs){var _this=this,results=[],promises=[];return batchIDs.forEach(function(batchId){promises.push(mutationsStore(transaction).get(batchId).next(function(mutation){if(null===mutation)throw fail('Dangling document-mutation reference found, '+'which points to '+batchId);assert(mutation.userId===_this.userId,'Unexpected user \''+mutation.userId+'\' for mutation batch '+batchId),results.push(_this.serializer.fromDbMutationBatch(mutation))}))}),PersistencePromise.waitFor(promises).next(function(){return results})},IndexedDbMutationQueue.prototype.removeMutationBatch=function(transaction,batch){var _this=this;return removeMutationBatch(transaction.simpleDbTransaction,this.userId,batch).next(function(removedDocuments){return _this.removeCachedMutationKeys(batch.batchId),PersistencePromise.forEach(removedDocuments,function(key){return _this.referenceDelegate.removeMutationReference(transaction,key)})})},IndexedDbMutationQueue.prototype.removeCachedMutationKeys=function(batchId){delete this.documentKeysByBatchId[batchId]},IndexedDbMutationQueue.prototype.performConsistencyCheck=function(txn){var _this=this;return this.checkEmpty(txn).next(function(empty){if(!empty)return PersistencePromise.resolve();var startRange=IDBKeyRange.lowerBound(DbDocumentMutation.prefixForUser(_this.userId)),danglingMutationReferences=[];return documentMutationsStore(txn).iterate({range:startRange},function(key,_,control){var userID=key[0];if(userID!==_this.userId)return void control.done();var path=decode$1(key[1]);danglingMutationReferences.push(path)}).next(function(){assert(0===danglingMutationReferences.length,'Document leak -- detected dangling mutation references when queue is empty. '+'Dangling keys: '+danglingMutationReferences.map(function(p){return p.canonicalString()}))})})},IndexedDbMutationQueue.prototype.containsKey=function(txn,key){return mutationQueueContainsKey(txn,this.userId,key)},IndexedDbMutationQueue.prototype.getMutationQueueMetadata=function(transaction){var _this=this;return mutationQueuesStore(transaction).get(this.userId).next(function(metadata){return metadata||new DbMutationQueue(_this.userId,BATCHID_UNKNOWN,'')})},IndexedDbMutationQueue}(),RESERVED_BITS=1,GeneratorIds;(function(GeneratorIds){GeneratorIds[GeneratorIds.QueryCache=0]='QueryCache',GeneratorIds[GeneratorIds.SyncEngine=1]='SyncEngine'})(GeneratorIds||(GeneratorIds={}));var TargetIdGenerator=function(){function TargetIdGenerator(generatorId,seed){this.generatorId=generatorId,assert((generatorId&RESERVED_BITS)===generatorId,'Generator ID '+generatorId+' contains more than '+RESERVED_BITS+' reserved bits'),this.seek(void 0===seed?this.generatorId:seed)}return TargetIdGenerator.prototype.next=function(){var nextId=this.nextId;return this.nextId+=1<<RESERVED_BITS,nextId},TargetIdGenerator.prototype.after=function(targetId){return this.seek(targetId+(1<<RESERVED_BITS)),this.next()},TargetIdGenerator.prototype.seek=function(targetId){assert((targetId&RESERVED_BITS)===this.generatorId,'Cannot supply target ID from different generator ID'),this.nextId=targetId},TargetIdGenerator.forQueryCache=function(){var targetIdGenerator=new TargetIdGenerator(GeneratorIds.QueryCache,2);return targetIdGenerator},TargetIdGenerator.forSyncEngine=function(){return new TargetIdGenerator(GeneratorIds.SyncEngine)},TargetIdGenerator}(),IndexedDbQueryCache=function(){function IndexedDbQueryCache(referenceDelegate,serializer){this.referenceDelegate=referenceDelegate,this.serializer=serializer,this.targetIdGenerator=TargetIdGenerator.forQueryCache()}return IndexedDbQueryCache.prototype.allocateTargetId=function(transaction){var _this=this;return this.retrieveMetadata(transaction).next(function(metadata){return metadata.highestTargetId=_this.targetIdGenerator.after(metadata.highestTargetId),_this.saveMetadata(transaction,metadata).next(function(){return metadata.highestTargetId})})},IndexedDbQueryCache.prototype.getLastRemoteSnapshotVersion=function(transaction){return this.retrieveMetadata(transaction).next(function(metadata){return SnapshotVersion.fromTimestamp(new Timestamp(metadata.lastRemoteSnapshotVersion.seconds,metadata.lastRemoteSnapshotVersion.nanoseconds))})},IndexedDbQueryCache.prototype.getHighestSequenceNumber=function(transaction){return getHighestListenSequenceNumber(transaction.simpleDbTransaction)},IndexedDbQueryCache.prototype.setTargetsMetadata=function(transaction,highestListenSequenceNumber,lastRemoteSnapshotVersion){var _this=this;return this.retrieveMetadata(transaction).next(function(metadata){return metadata.highestListenSequenceNumber=highestListenSequenceNumber,lastRemoteSnapshotVersion&&(metadata.lastRemoteSnapshotVersion=lastRemoteSnapshotVersion.toTimestamp()),highestListenSequenceNumber>metadata.highestListenSequenceNumber&&(metadata.highestListenSequenceNumber=highestListenSequenceNumber),_this.saveMetadata(transaction,metadata)})},IndexedDbQueryCache.prototype.addQueryData=function(transaction,queryData){var _this=this;return this.saveQueryData(transaction,queryData).next(function(){return _this.retrieveMetadata(transaction).next(function(metadata){return metadata.targetCount+=1,_this.updateMetadataFromQueryData(queryData,metadata),_this.saveMetadata(transaction,metadata)})})},IndexedDbQueryCache.prototype.updateQueryData=function(transaction,queryData){return this.saveQueryData(transaction,queryData)},IndexedDbQueryCache.prototype.removeQueryData=function(transaction,queryData){var _this=this;return this.removeMatchingKeysForTargetId(transaction,queryData.targetId).next(function(){return targetsStore(transaction).delete(queryData.targetId)}).next(function(){return _this.retrieveMetadata(transaction)}).next(function(metadata){return assert(0<metadata.targetCount,'Removing from an empty query cache'),metadata.targetCount-=1,_this.saveMetadata(transaction,metadata)})},IndexedDbQueryCache.prototype.removeTargets=function(txn,upperBound,activeTargetIds){var _this=this,count=0,promises=[];return targetsStore(txn).iterate(function(key,value){var queryData=_this.serializer.fromDbTarget(value);queryData.sequenceNumber<=upperBound&&void 0===activeTargetIds[queryData.targetId]&&(count++,promises.push(_this.removeQueryData(txn,queryData)))}).next(function(){return PersistencePromise.waitFor(promises)}).next(function(){return count})},IndexedDbQueryCache.prototype.forEachTarget=function(txn,f){var _this=this;return targetsStore(txn).iterate(function(key,value){var queryData=_this.serializer.fromDbTarget(value);f(queryData)})},IndexedDbQueryCache.prototype.retrieveMetadata=function(transaction){return retrieveMetadata(transaction.simpleDbTransaction)},IndexedDbQueryCache.prototype.saveMetadata=function(transaction,metadata){return globalTargetStore(transaction).put(DbTargetGlobal.key,metadata)},IndexedDbQueryCache.prototype.saveQueryData=function(transaction,queryData){return targetsStore(transaction).put(this.serializer.toDbTarget(queryData))},IndexedDbQueryCache.prototype.updateMetadataFromQueryData=function(queryData,metadata){var updated=!1;return queryData.targetId>metadata.highestTargetId&&(metadata.highestTargetId=queryData.targetId,updated=!0),queryData.sequenceNumber>metadata.highestListenSequenceNumber&&(metadata.highestListenSequenceNumber=queryData.sequenceNumber,updated=!0),updated},IndexedDbQueryCache.prototype.getQueryCount=function(transaction){return this.retrieveMetadata(transaction).next(function(metadata){return metadata.targetCount})},IndexedDbQueryCache.prototype.getQueryData=function(transaction,query){var _this=this,canonicalId=query.canonicalId(),range=IDBKeyRange.bound([canonicalId,_NumberNEGATIVE_INFINITY],[canonicalId,_NumberPOSITIVE_INFINITY]),result=null;return targetsStore(transaction).iterate({range:range,index:DbTarget.queryTargetsIndexName},function(key,value,control){var found=_this.serializer.fromDbTarget(value);query.isEqual(found.query)&&(result=found,control.done())}).next(function(){return result})},IndexedDbQueryCache.prototype.addMatchingKeys=function(txn,keys,targetId){var _this=this,promises=[],store=documentTargetStore(txn);return keys.forEach(function(key){var path=encode(key.path);promises.push(store.put(new DbTargetDocument(targetId,path))),promises.push(_this.referenceDelegate.addReference(txn,key))}),PersistencePromise.waitFor(promises)},IndexedDbQueryCache.prototype.removeMatchingKeys=function(txn,keys,targetId){var _this=this,store=documentTargetStore(txn);return PersistencePromise.forEach(keys,function(key){var path=encode(key.path);return PersistencePromise.waitFor([store.delete([targetId,path]),_this.referenceDelegate.removeReference(txn,key)])})},IndexedDbQueryCache.prototype.removeMatchingKeysForTargetId=function(txn,targetId){var store=documentTargetStore(txn),range=IDBKeyRange.bound([targetId],[targetId+1],!1,!0);return store.delete(range)},IndexedDbQueryCache.prototype.getMatchingKeysForTargetId=function(txn,targetId){var range=IDBKeyRange.bound([targetId],[targetId+1],!1,!0),store=documentTargetStore(txn),result=documentKeySet();return store.iterate({range:range,keysOnly:!0},function(key){var path=decode$1(key[1]),docKey=new DocumentKey(path);result=result.add(docKey)}).next(function(){return result})},IndexedDbQueryCache.prototype.containsKey=function(txn,key){var path=encode(key.path),range=IDBKeyRange.bound([path],[immediateSuccessor(path)],!1,!0),count=0;return documentTargetStore(txn).iterate({index:DbTargetDocument.documentTargetsIndex,keysOnly:!0,range:range},function(_a,_,control){var targetId=_a[0],path=_a[1];0!==targetId&&(count++,control.done())}).next(function(){return 0<count})},IndexedDbQueryCache.prototype.getQueryDataForTarget=function(transaction,targetId){var _this=this;return targetsStore(transaction).get(targetId).next(function(found){return found?_this.serializer.fromDbTarget(found):null})},IndexedDbQueryCache}(),LocalSerializer=function(){function LocalSerializer(remoteSerializer){this.remoteSerializer=remoteSerializer}return LocalSerializer.prototype.fromDbRemoteDocument=function(remoteDoc){if(remoteDoc.document)return this.remoteSerializer.fromDocument(remoteDoc.document,!!remoteDoc.hasCommittedMutations);if(remoteDoc.noDocument){var key=DocumentKey.fromSegments(remoteDoc.noDocument.path),version=this.fromDbTimestamp(remoteDoc.noDocument.readTime);return new NoDocument(key,version,{hasCommittedMutations:!!remoteDoc.hasCommittedMutations})}if(remoteDoc.unknownDocument){var key=DocumentKey.fromSegments(remoteDoc.unknownDocument.path),version=this.fromDbTimestamp(remoteDoc.unknownDocument.version);return new UnknownDocument(key,version)}return fail('Unexpected DbRemoteDocument')},LocalSerializer.prototype.toDbRemoteDocument=function(maybeDoc){if(maybeDoc instanceof Document){var doc=this.remoteSerializer.toDocument(maybeDoc),hasCommittedMutations=maybeDoc.hasCommittedMutations;return new DbRemoteDocument(null,null,doc,hasCommittedMutations)}if(maybeDoc instanceof NoDocument){var path=maybeDoc.key.path.toArray(),readTime=this.toDbTimestamp(maybeDoc.version),hasCommittedMutations=maybeDoc.hasCommittedMutations;return new DbRemoteDocument(null,new DbNoDocument(path,readTime),null,hasCommittedMutations)}if(maybeDoc instanceof UnknownDocument){var path=maybeDoc.key.path.toArray(),readTime=this.toDbTimestamp(maybeDoc.version);return new DbRemoteDocument(new DbUnknownDocument(path,readTime),null,null,!0)}return fail('Unexpected MaybeDocumment')},LocalSerializer.prototype.toDbTimestamp=function(snapshotVersion){var timestamp=snapshotVersion.toTimestamp();return new DbTimestamp(timestamp.seconds,timestamp.nanoseconds)},LocalSerializer.prototype.fromDbTimestamp=function(dbTimestamp){var timestamp=new Timestamp(dbTimestamp.seconds,dbTimestamp.nanoseconds);return SnapshotVersion.fromTimestamp(timestamp)},LocalSerializer.prototype.toDbMutationBatch=function(userId,batch){var _this=this,serializedMutations=batch.mutations.map(function(m){return _this.remoteSerializer.toMutation(m)});return new DbMutationBatch(userId,batch.batchId,batch.localWriteTime.toMillis(),serializedMutations)},LocalSerializer.prototype.fromDbMutationBatch=function(dbBatch){var _this=this,mutations=dbBatch.mutations.map(function(m){return _this.remoteSerializer.fromMutation(m)}),timestamp=Timestamp.fromMillis(dbBatch.localWriteTimeMs);return new MutationBatch(dbBatch.batchId,timestamp,mutations)},LocalSerializer.prototype.toDbResourcePaths=function(keys){var encodedKeys=[];return keys.forEach(function(key){encodedKeys.push(encode(key.path))}),encodedKeys},LocalSerializer.prototype.fromDbResourcePaths=function(encodedPaths){for(var keys=documentKeySet(),_i=0,encodedPaths_1=encodedPaths,documentKey;_i<encodedPaths_1.length;_i++)documentKey=encodedPaths_1[_i],keys=keys.add(new DocumentKey(decode$1(documentKey)));return keys},LocalSerializer.prototype.fromDbTarget=function(dbTarget){var version=this.fromDbTimestamp(dbTarget.readTime),query;return query=isDocumentQuery(dbTarget.query)?this.remoteSerializer.fromDocumentsTarget(dbTarget.query):this.remoteSerializer.fromQueryTarget(dbTarget.query),new QueryData(query,dbTarget.targetId,QueryPurpose.Listen,dbTarget.lastListenSequenceNumber,version,dbTarget.resumeToken)},LocalSerializer.prototype.toDbTarget=function(queryData){assert(QueryPurpose.Listen===queryData.purpose,'Only queries with purpose '+QueryPurpose.Listen+' may be stored, got '+queryData.purpose);var dbTimestamp=this.toDbTimestamp(queryData.snapshotVersion),queryProto;queryProto=queryData.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(queryData.query):this.remoteSerializer.toQueryTarget(queryData.query);var resumeToken;return queryData.resumeToken instanceof Uint8Array?(assert('YES'===process.env.USE_MOCK_PERSISTENCE,'Persisting non-string stream tokens is only supported with mock persistence .'),resumeToken=queryData.resumeToken.toString()):resumeToken=queryData.resumeToken,new DbTarget(queryData.targetId,queryData.query.canonicalId(),dbTimestamp,resumeToken,queryData.sequenceNumber,queryProto)},LocalSerializer}(),RollingSequenceNumberBuffer=function(){function RollingSequenceNumberBuffer(maxElements){this.maxElements=maxElements,this.buffer=new SortedSet(bufferEntryComparator),this.previousIndex=0}return RollingSequenceNumberBuffer.prototype.nextIndex=function(){return++this.previousIndex},RollingSequenceNumberBuffer.prototype.addElement=function(sequenceNumber){var entry=[sequenceNumber,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(entry);else{var highestValue=this.buffer.last();0>bufferEntryComparator(entry,highestValue)&&(this.buffer=this.buffer.delete(highestValue).add(entry))}},Object.defineProperty(RollingSequenceNumberBuffer.prototype,'maxValue',{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),RollingSequenceNumberBuffer}(),LruGarbageCollector=function(){function LruGarbageCollector(delegate){this.delegate=delegate}return LruGarbageCollector.prototype.calculateTargetCount=function(txn,percentile){return this.delegate.getTargetCount(txn).next(function(targetCount){return _Mathfloor(percentile/100*targetCount)})},LruGarbageCollector.prototype.nthSequenceNumber=function(txn,n){var _this=this;if(0===n)return PersistencePromise.resolve(ListenSequence.INVALID);var buffer=new RollingSequenceNumberBuffer(n);return this.delegate.forEachTarget(txn,function(target){return buffer.addElement(target.sequenceNumber)}).next(function(){return _this.delegate.forEachOrphanedDocumentSequenceNumber(txn,function(sequenceNumber){return buffer.addElement(sequenceNumber)})}).next(function(){return buffer.maxValue})},LruGarbageCollector.prototype.removeTargets=function(txn,upperBound,activeTargetIds){return this.delegate.removeTargets(txn,upperBound,activeTargetIds)},LruGarbageCollector.prototype.removeOrphanedDocuments=function(txn,upperBound){return this.delegate.removeOrphanedDocuments(txn,upperBound)},LruGarbageCollector}(),PersistenceTransaction=function(){return function PersistenceTransaction(){}}(),LOG_TAG$2='IndexedDbPersistence',MAX_CLIENT_AGE_MS=1e3*(60*30),MAX_PRIMARY_ELIGIBLE_AGE_MS=5e3,PRIMARY_LEASE_LOST_ERROR_MSG='The current tab is not in the required state to perform this operation. '+'It might be necessary to refresh the browser tab.',PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG='Another tab has exclusive access to the persistence layer. '+'To allow shared access, make sure to invoke '+'`enablePersistence()` with `experimentalTabSynchronization:true` in all tabs.',IndexedDbTransaction=function(_super){function IndexedDbTransaction(simpleDbTransaction,currentSequenceNumber){var _this=_super.call(this)||this;return _this.simpleDbTransaction=simpleDbTransaction,_this.currentSequenceNumber=currentSequenceNumber,_this}return tslib_1.__extends(IndexedDbTransaction,_super),IndexedDbTransaction}(PersistenceTransaction),IndexedDbPersistence=function(){function IndexedDbPersistence(persistenceKey,clientId,platform,queue,serializer,multiClientParams){if(this.persistenceKey=persistenceKey,this.clientId=clientId,this.queue=queue,this.multiClientParams=multiClientParams,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=_NumberNEGATIVE_INFINITY,this.primaryStateListener=function(){return Promise.resolve()},!IndexedDbPersistence.isAvailable())throw new FirestoreError(Code.UNIMPLEMENTED,'This platform is either missing'+' IndexedDB or is known to have an incomplete implementation. Offline'+' persistence has been disabled.');if(this.referenceDelegate=new IndexedDbLruDelegate(this),this.dbName=persistenceKey+IndexedDbPersistence.MAIN_DATABASE,this.serializer=new LocalSerializer(serializer),this.document=platform.document,this.allowTabSynchronization=void 0!==multiClientParams,this.queryCache=new IndexedDbQueryCache(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new IndexedDbRemoteDocumentCache(this.serializer,this.allowTabSynchronization),platform.window&&platform.window.localStorage)this.window=platform.window,this.webStorage=this.window.localStorage;else throw new FirestoreError(Code.UNIMPLEMENTED,'IndexedDB persistence is only available on platforms that support LocalStorage.')}return IndexedDbPersistence.getStore=function(txn,store){if(txn instanceof IndexedDbTransaction)return SimpleDb.getStore(txn.simpleDbTransaction,store);throw fail('IndexedDbPersistence must use instances of IndexedDbTransaction')},IndexedDbPersistence.createIndexedDbPersistence=function(persistenceKey,clientId,platform,queue,serializer){return tslib_1.__awaiter(this,void 0,void 0,function(){var persistence;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return persistence=new IndexedDbPersistence(persistenceKey,clientId,platform,queue,serializer),[4,persistence.start()];case 1:return _a.sent(),[2,persistence];}})})},IndexedDbPersistence.createMultiClientIndexedDbPersistence=function(persistenceKey,clientId,platform,queue,serializer,multiClientParams){return tslib_1.__awaiter(this,void 0,void 0,function(){var persistence;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return persistence=new IndexedDbPersistence(persistenceKey,clientId,platform,queue,serializer,multiClientParams),[4,persistence.start()];case 1:return _a.sent(),[2,persistence];}})})},IndexedDbPersistence.prototype.start=function(){var _this=this;return assert(!this.started,'IndexedDbPersistence double-started!'),assert(null!==this.window,'Expected \'window\' to be defined'),SimpleDb.openOrCreate(this.dbName,SCHEMA_VERSION,new SchemaConverter(this.serializer)).then(function(db){_this.simpleDb=db}).then(function(){return _this.startRemoteDocumentCache()}).then(function(){return _this.attachVisibilityHandler(),_this.attachWindowUnloadHook(),_this.updateClientMetadataAndTryBecomePrimary().then(function(){return _this.scheduleClientMetadataAndPrimaryLeaseRefreshes()})}).then(function(){return _this.simpleDb.runTransaction('readonly',[DbTargetGlobal.store],function(txn){return getHighestListenSequenceNumber(txn).next(function(highestListenSequenceNumber){var sequenceNumberSyncer=_this.multiClientParams?_this.multiClientParams.sequenceNumberSyncer:void 0;_this.listenSequence=new ListenSequence(highestListenSequenceNumber,sequenceNumberSyncer)})})}).then(function(){_this._started=!0}).catch(function(reason){return _this.simpleDb&&_this.simpleDb.close(),Promise.reject(reason)})},IndexedDbPersistence.prototype.startRemoteDocumentCache=function(){var _this=this;return this.simpleDb.runTransaction('readonly',ALL_STORES,function(txn){return _this.remoteDocumentCache.start(txn)})},IndexedDbPersistence.prototype.setPrimaryStateListener=function(primaryStateListener){var _this=this;return this.primaryStateListener=function(primaryState){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.started?[2,primaryStateListener(primaryState)]:[2]})})},primaryStateListener(this.isPrimary)},IndexedDbPersistence.prototype.setNetworkEnabled=function(networkEnabled){var _this=this;this.networkEnabled!==networkEnabled&&(this.networkEnabled=networkEnabled,this.queue.enqueueAndForget(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2];}})})}))},IndexedDbPersistence.prototype.updateClientMetadataAndTryBecomePrimary=function(){var _this=this;return this.simpleDb.runTransaction('readwrite',ALL_STORES,function(txn){var metadataStore=clientMetadataStore(txn);return metadataStore.put(new DbClientMetadata(_this.clientId,Date.now(),_this.networkEnabled,_this.inForeground,_this.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(_this.isPrimary)return _this.verifyPrimaryLease(txn).next(function(success){success||(_this.isPrimary=!1,_this.queue.enqueueAndForget(function(){return _this.primaryStateListener(!1)}))})}).next(function(){return _this.canActAsPrimary(txn)}).next(function(canActAsPrimary){var wasPrimary=_this.isPrimary;return(_this.isPrimary=canActAsPrimary,wasPrimary!==_this.isPrimary&&_this.queue.enqueueAndForget(function(){return _this.primaryStateListener(_this.isPrimary)}),wasPrimary&&!_this.isPrimary)?_this.releasePrimaryLeaseIfHeld(txn):_this.isPrimary?_this.acquireOrExtendPrimaryLease(txn):void 0})})},IndexedDbPersistence.prototype.verifyPrimaryLease=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(primaryClient){return PersistencePromise.resolve(_this.isLocalClient(primaryClient))})},IndexedDbPersistence.prototype.removeClientMetadata=function(txn){var metadataStore=clientMetadataStore(txn);return metadataStore.delete(this.clientId)},IndexedDbPersistence.prototype.maybeGarbageCollectMultiClientState=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,activeClients_1,inactiveClients_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,MAX_CLIENT_AGE_MS)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),inactiveClients_1=[],[4,this.runTransaction('maybeGarbageCollectMultiClientState','readwrite-primary',function(txn){var metadataStore=IndexedDbPersistence.getStore(txn,DbClientMetadata.store);return metadataStore.loadAll().next(function(existingClients){activeClients_1=_this.filterActiveClients(existingClients,MAX_CLIENT_AGE_MS),inactiveClients_1=existingClients.filter(function(client){return-1===activeClients_1.indexOf(client)})}).next(function(){return PersistencePromise.forEach(inactiveClients_1,function(inactiveClient){return metadataStore.delete(inactiveClient.clientId)})}).next(function(){if(activeClients_1=activeClients_1.filter(function(client){return client.clientId!==_this.clientId}),0<activeClients_1.length){var processedChangeIds=activeClients_1.map(function(client){return client.lastProcessedDocumentChangeId||0}),oldestChangeId=_Mathmin.apply(Math,processedChangeIds);return _this.remoteDocumentCache.removeDocumentChangesThroughChangeId(txn,oldestChangeId)}})})]);case 1:_a.sent(),inactiveClients_1.forEach(function(inactiveClient){_this.window.localStorage.removeItem(_this.zombiedClientLocalStorageKey(inactiveClient.clientId))}),_a.label=2;case 2:return[2];}})})},IndexedDbPersistence.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var _this=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(TimerId.ClientMetadataRefresh,4e3,function(){return _this.updateClientMetadataAndTryBecomePrimary().then(function(){return _this.maybeGarbageCollectMultiClientState()}).then(function(){return _this.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},IndexedDbPersistence.prototype.isLocalClient=function(client){return!!client&&client.ownerId===this.clientId},IndexedDbPersistence.prototype.canActAsPrimary=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(currentPrimary){var currentLeaseIsValid=null!==currentPrimary&&_this.isWithinAge(currentPrimary.leaseTimestampMs,MAX_PRIMARY_ELIGIBLE_AGE_MS)&&!_this.isClientZombied(currentPrimary.ownerId);if(currentLeaseIsValid){if(_this.isLocalClient(currentPrimary)&&_this.networkEnabled)return!0;if(!_this.isLocalClient(currentPrimary)){if(!currentPrimary.allowTabSynchronization)throw new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG);return!1}}return _this.networkEnabled&&_this.inForeground||clientMetadataStore(txn).loadAll().next(function(existingClients){var preferredCandidate=_this.filterActiveClients(existingClients,MAX_PRIMARY_ELIGIBLE_AGE_MS).find(function(otherClient){if(_this.clientId!==otherClient.clientId){var otherClientHasBetterNetworkState=!_this.networkEnabled&&otherClient.networkEnabled,otherClientHasBetterVisibility=!_this.inForeground&&otherClient.inForeground,otherClientHasSameNetworkState=_this.networkEnabled===otherClient.networkEnabled;if(otherClientHasBetterNetworkState||otherClientHasBetterVisibility&&otherClientHasSameNetworkState)return!0}return!1});return void 0===preferredCandidate})}).next(function(canActAsPrimary){return _this.isPrimary!==canActAsPrimary&&debug(LOG_TAG$2,'Client '+(canActAsPrimary?'is':'is not')+' eligible for a primary lease.'),canActAsPrimary})},IndexedDbPersistence.prototype.shutdown=function(deleteData){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction('readwrite',[DbPrimaryClient.store,DbClientMetadata.store],function(txn){return _this.releasePrimaryLeaseIfHeld(txn).next(function(){return _this.removeClientMetadata(txn)})})];case 1:return _a.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),deleteData?[4,SimpleDb.delete(this.dbName)]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2];}})})},IndexedDbPersistence.prototype.filterActiveClients=function(clients,activityThresholdMs){var _this=this;return clients.filter(function(client){return _this.isWithinAge(client.updateTimeMs,activityThresholdMs)&&!_this.isClientZombied(client.clientId)})},IndexedDbPersistence.prototype.getActiveClients=function(){var _this=this;return this.simpleDb.runTransaction('readonly',[DbClientMetadata.store],function(txn){return clientMetadataStore(txn).loadAll().next(function(clients){return _this.filterActiveClients(clients,MAX_CLIENT_AGE_MS).map(function(clientMetadata){return clientMetadata.clientId})})})},Object.defineProperty(IndexedDbPersistence.prototype,'started',{get:function(){return this._started},enumerable:!0,configurable:!0}),IndexedDbPersistence.prototype.getMutationQueue=function(user){return assert(this.started,'Cannot initialize MutationQueue before persistence is started.'),IndexedDbMutationQueue.forUser(user,this.serializer,this.referenceDelegate)},IndexedDbPersistence.prototype.getQueryCache=function(){return assert(this.started,'Cannot initialize QueryCache before persistence is started.'),this.queryCache},IndexedDbPersistence.prototype.getRemoteDocumentCache=function(){return assert(this.started,'Cannot initialize RemoteDocumentCache before persistence is started.'),this.remoteDocumentCache},IndexedDbPersistence.prototype.runTransaction=function(action,mode,transactionOperation){var _this=this;return debug(LOG_TAG$2,'Starting transaction:',action),this.simpleDb.runTransaction('readonly'===mode?'readonly':'readwrite',ALL_STORES,function(simpleDbTxn){return'readwrite-primary'===mode?_this.verifyPrimaryLease(simpleDbTxn).next(function(success){if(!success)throw error('Failed to obtain primary lease for action \''+action+'\'.'),_this.isPrimary=!1,_this.queue.enqueueAndForget(function(){return _this.primaryStateListener(!1)}),new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_LOST_ERROR_MSG);return transactionOperation(new IndexedDbTransaction(simpleDbTxn,_this.listenSequence.next()))}).next(function(result){return _this.acquireOrExtendPrimaryLease(simpleDbTxn).next(function(){return result})}):_this.verifyAllowTabSynchronization(simpleDbTxn).next(function(){return transactionOperation(new IndexedDbTransaction(simpleDbTxn,_this.listenSequence.next()))})})},IndexedDbPersistence.prototype.verifyAllowTabSynchronization=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(currentPrimary){var currentLeaseIsValid=null!==currentPrimary&&_this.isWithinAge(currentPrimary.leaseTimestampMs,MAX_PRIMARY_ELIGIBLE_AGE_MS)&&!_this.isClientZombied(currentPrimary.ownerId);if(currentLeaseIsValid&&!_this.isLocalClient(currentPrimary)&&!currentPrimary.allowTabSynchronization)throw new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG)})},IndexedDbPersistence.prototype.acquireOrExtendPrimaryLease=function(txn){var newPrimary=new DbPrimaryClient(this.clientId,this.allowTabSynchronization,Date.now());return primaryClientStore(txn).put(DbPrimaryClient.key,newPrimary)},IndexedDbPersistence.isAvailable=function(){return SimpleDb.isAvailable()},IndexedDbPersistence.buildStoragePrefix=function(databaseInfo){var database=databaseInfo.databaseId.projectId;return databaseInfo.databaseId.isDefaultDatabase||(database+='.'+databaseInfo.databaseId.database),'firestore/'+databaseInfo.persistenceKey+'/'+database+'/'},IndexedDbPersistence.prototype.releasePrimaryLeaseIfHeld=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(primaryClient){return _this.isLocalClient(primaryClient)?(debug(LOG_TAG$2,'Releasing primary lease.'),store.delete(DbPrimaryClient.key)):PersistencePromise.resolve()})},IndexedDbPersistence.prototype.isWithinAge=function(updateTimeMs,maxAgeMs){var now=Date.now(),maxAcceptable=now;return!(updateTimeMs<now-maxAgeMs)&&(!(updateTimeMs>maxAcceptable)||(error('Detected an update time that is in the future: '+updateTimeMs+' > '+maxAcceptable),!1))},IndexedDbPersistence.prototype.attachVisibilityHandler=function(){var _this=this;null!==this.document&&'function'==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){_this.queue.enqueueAndForget(function(){return _this.inForeground='visible'===_this.document.visibilityState,_this.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener('visibilitychange',this.documentVisibilityHandler),this.inForeground='visible'===this.document.visibilityState)},IndexedDbPersistence.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(assert(null!==this.document&&'function'==typeof this.document.addEventListener,'Expected \'document.addEventListener\' to be a function'),this.document.removeEventListener('visibilitychange',this.documentVisibilityHandler),this.documentVisibilityHandler=null)},IndexedDbPersistence.prototype.attachWindowUnloadHook=function(){var _this=this;'function'==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){_this.markClientZombied(),_this.queue.enqueueAndForget(function(){return _this.shutdown()})},this.window.addEventListener('unload',this.windowUnloadHandler))},IndexedDbPersistence.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(assert('function'==typeof this.window.removeEventListener,'Expected \'window.removeEventListener\' to be a function'),this.window.removeEventListener('unload',this.windowUnloadHandler),this.windowUnloadHandler=null)},IndexedDbPersistence.prototype.isClientZombied=function(clientId){try{var isZombied=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(clientId));return debug(LOG_TAG$2,'Client \''+clientId+'\' '+(isZombied?'is':'is not')+' zombied in LocalStorage'),isZombied}catch(e){return error(LOG_TAG$2,'Failed to get zombied client id.',e),!1}},IndexedDbPersistence.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),Date.now()+'')}catch(e){error('Failed to set zombie client id.',e)}},IndexedDbPersistence.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},IndexedDbPersistence.prototype.zombiedClientLocalStorageKey=function(clientId){return'firestore_zombie'+'_'+this.persistenceKey+'_'+clientId},IndexedDbPersistence.MAIN_DATABASE='main',IndexedDbPersistence}(),IndexedDbLruDelegate=function(){function IndexedDbLruDelegate(db){this.db=db,this.garbageCollector=new LruGarbageCollector(this)}return IndexedDbLruDelegate.prototype.getTargetCount=function(txn){return this.db.getQueryCache().getQueryCount(txn)},IndexedDbLruDelegate.prototype.forEachTarget=function(txn,f){return this.db.getQueryCache().forEachTarget(txn,f)},IndexedDbLruDelegate.prototype.forEachOrphanedDocumentSequenceNumber=function(txn,f){return this.forEachOrphanedDocument(txn,function(docKey,sequenceNumber){return f(sequenceNumber)})},IndexedDbLruDelegate.prototype.setInMemoryPins=function(inMemoryPins){this.inMemoryPins=inMemoryPins},IndexedDbLruDelegate.prototype.addReference=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.removeReference=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.removeTargets=function(txn,upperBound,activeTargetIds){return this.db.getQueryCache().removeTargets(txn,upperBound,activeTargetIds)},IndexedDbLruDelegate.prototype.removeMutationReference=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.isPinned=function(txn,docKey){return this.inMemoryPins.containsKey(docKey)?PersistencePromise.resolve(!0):mutationQueuesContainKey(txn,docKey)},IndexedDbLruDelegate.prototype.removeOrphanedDocuments=function(txn,upperBound){var _this=this,count=0,bytesRemoved=0,promises=[],iteration=this.forEachOrphanedDocument(txn,function(docKey,sequenceNumber){if(sequenceNumber<=upperBound){var p=_this.isPinned(txn,docKey).next(function(isPinned){if(!isPinned)return count++,_this.removeOrphanedDocument(txn,docKey).next(function(documentBytes){bytesRemoved+=documentBytes})});promises.push(p)}});return iteration.next(function(){return PersistencePromise.waitFor(promises)}).next(function(){return _this.db.getRemoteDocumentCache().updateSize(txn,-bytesRemoved)}).next(function(){return count})},IndexedDbLruDelegate.prototype.removeOrphanedDocument=function(txn,docKey){var totalBytesRemoved=0,documentCache=this.db.getRemoteDocumentCache();return PersistencePromise.waitFor([documentTargetStore(txn).delete(sentinelKey(docKey)),documentCache.removeEntry(txn,docKey).next(function(bytesRemoved){totalBytesRemoved+=bytesRemoved})]).next(function(){return totalBytesRemoved})},IndexedDbLruDelegate.prototype.removeTarget=function(txn,queryData){var updated=queryData.copy({sequenceNumber:txn.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(txn,updated)},IndexedDbLruDelegate.prototype.updateLimboDocument=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.forEachOrphanedDocument=function(txn,f){var store=documentTargetStore(txn),nextToReport=ListenSequence.INVALID,nextPath;return store.iterate({index:DbTargetDocument.documentTargetsIndex},function(_a,_b){var targetId=_a[0],docKey=_a[1],path=_b.path,sequenceNumber=_b.sequenceNumber;0===targetId?(nextToReport!==ListenSequence.INVALID&&f(new DocumentKey(decode$1(nextPath)),nextToReport),nextToReport=sequenceNumber,nextPath=path):nextToReport=ListenSequence.INVALID}).next(function(){nextToReport!==ListenSequence.INVALID&&f(new DocumentKey(decode$1(nextPath)),nextToReport)})},IndexedDbLruDelegate}(),LocalDocumentsView=function(){function LocalDocumentsView(remoteDocumentCache,mutationQueue){this.remoteDocumentCache=remoteDocumentCache,this.mutationQueue=mutationQueue}return LocalDocumentsView.prototype.getDocument=function(transaction,key){var _this=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(transaction,key).next(function(batches){return _this.getDocumentInternal(transaction,key,batches)})},LocalDocumentsView.prototype.getDocumentInternal=function(transaction,key,inBatches){return this.remoteDocumentCache.getEntry(transaction,key).next(function(doc){for(var _i=0,inBatches_1=inBatches,batch;_i<inBatches_1.length;_i++)batch=inBatches_1[_i],doc=batch.applyToLocalView(key,doc);return doc})},LocalDocumentsView.prototype.getDocuments=function(transaction,keys){var _this=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(transaction,keys).next(function(batches){var promises=[],results=maybeDocumentMap();return keys.forEach(function(key){promises.push(_this.getDocumentInternal(transaction,key,batches).next(function(maybeDoc){maybeDoc||(maybeDoc=new NoDocument(key,SnapshotVersion.forDeletedDoc())),results=results.insert(key,maybeDoc)}))}),PersistencePromise.waitFor(promises).next(function(){return results})})},LocalDocumentsView.prototype.getDocumentsMatchingQuery=function(transaction,query){return DocumentKey.isDocumentKey(query.path)?this.getDocumentsMatchingDocumentQuery(transaction,query.path):this.getDocumentsMatchingCollectionQuery(transaction,query)},LocalDocumentsView.prototype.getDocumentsMatchingDocumentQuery=function(transaction,docPath){return this.getDocument(transaction,new DocumentKey(docPath)).next(function(maybeDoc){var result=documentMap();return maybeDoc instanceof Document&&(result=result.insert(maybeDoc.key,maybeDoc)),result})},LocalDocumentsView.prototype.getDocumentsMatchingCollectionQuery=function(transaction,query){var _this=this,results;return this.remoteDocumentCache.getDocumentsMatchingQuery(transaction,query).next(function(queryResults){return results=queryResults,_this.mutationQueue.getAllMutationBatchesAffectingQuery(transaction,query)}).next(function(matchingMutationBatches){for(var _i=0,matchingMutationBatches_1=matchingMutationBatches,batch;_i<matchingMutationBatches_1.length;_i++){batch=matchingMutationBatches_1[_i];for(var _a=0,_b=batch.mutations;_a<_b.length;_a++){var mutation=_b[_a],key=mutation.key;if(query.path.isImmediateParentOf(key.path)){var baseDoc=results.get(key),mutatedDoc=mutation.applyToLocalView(baseDoc,baseDoc,batch.localWriteTime);results=mutatedDoc instanceof Document?results.insert(key,mutatedDoc):results.remove(key)}}}}).next(function(){return results.forEach(function(key,doc){query.matches(doc)||(results=results.remove(key))}),results})},LocalDocumentsView}(),ReferenceSet=function(){function ReferenceSet(){this.refsByKey=new SortedSet(DocReference.compareByKey),this.refsByTarget=new SortedSet(DocReference.compareByTargetId)}return ReferenceSet.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},ReferenceSet.prototype.addReference=function(key,id){var ref=new DocReference(key,id);this.refsByKey=this.refsByKey.add(ref),this.refsByTarget=this.refsByTarget.add(ref)},ReferenceSet.prototype.addReferences=function(keys,id){var _this=this;keys.forEach(function(key){return _this.addReference(key,id)})},ReferenceSet.prototype.removeReference=function(key,id){this.removeRef(new DocReference(key,id))},ReferenceSet.prototype.removeReferences=function(keys,id){var _this=this;keys.forEach(function(key){return _this.removeReference(key,id)})},ReferenceSet.prototype.removeReferencesForId=function(id){var _this=this,emptyKey=DocumentKey.EMPTY,startRef=new DocReference(emptyKey,id),endRef=new DocReference(emptyKey,id+1),keys=[];return this.refsByTarget.forEachInRange([startRef,endRef],function(ref){_this.removeRef(ref),keys.push(ref.key)}),keys},ReferenceSet.prototype.removeAllReferences=function(){var _this=this;this.refsByKey.forEach(function(ref){return _this.removeRef(ref)})},ReferenceSet.prototype.removeRef=function(ref){this.refsByKey=this.refsByKey.delete(ref),this.refsByTarget=this.refsByTarget.delete(ref)},ReferenceSet.prototype.referencesForId=function(id){var emptyKey=DocumentKey.EMPTY,startRef=new DocReference(emptyKey,id),endRef=new DocReference(emptyKey,id+1),keys=documentKeySet();return this.refsByTarget.forEachInRange([startRef,endRef],function(ref){keys=keys.add(ref.key)}),keys},ReferenceSet.prototype.containsKey=function(key){var ref=new DocReference(key,0),firstRef=this.refsByKey.firstAfterOrEqual(ref);return null!==firstRef&&key.isEqual(firstRef.key)},ReferenceSet}(),DocReference=function(){function DocReference(key,targetOrBatchId){this.key=key,this.targetOrBatchId=targetOrBatchId}return DocReference.compareByKey=function(left,right){return DocumentKey.comparator(left.key,right.key)||primitiveComparator(left.targetOrBatchId,right.targetOrBatchId)},DocReference.compareByTargetId=function(left,right){return primitiveComparator(left.targetOrBatchId,right.targetOrBatchId)||DocumentKey.comparator(left.key,right.key)},DocReference}(),LocalStore=function(){function LocalStore(persistence,initialUser){this.persistence=persistence,this.localViewReferences=new ReferenceSet,this.queryDataByTarget={},assert(persistence.started,'LocalStore was passed an unstarted persistence implementation'),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=persistence.getMutationQueue(initialUser),this.remoteDocuments=persistence.getRemoteDocumentCache(),this.queryCache=persistence.getQueryCache(),this.localDocuments=new LocalDocumentsView(this.remoteDocuments,this.mutationQueue)}return LocalStore.prototype.handleUserChange=function(user){var _this=this;return this.persistence.runTransaction('Handle user change','readonly',function(txn){var oldBatches;return _this.mutationQueue.getAllMutationBatches(txn).next(function(promisedOldBatches){return oldBatches=promisedOldBatches,_this.mutationQueue=_this.persistence.getMutationQueue(user),_this.localDocuments=new LocalDocumentsView(_this.remoteDocuments,_this.mutationQueue),_this.mutationQueue.getAllMutationBatches(txn)}).next(function(newBatches){for(var removedBatchIds=[],addedBatchIds=[],changedKeys=documentKeySet(),_i=0,oldBatches_1=oldBatches,batch;_i<oldBatches_1.length;_i++){batch=oldBatches_1[_i],removedBatchIds.push(batch.batchId);for(var _a=0,_b=batch.mutations,mutation;_a<_b.length;_a++)mutation=_b[_a],changedKeys=changedKeys.add(mutation.key)}for(var _c=0,newBatches_1=newBatches,batch;_c<newBatches_1.length;_c++){batch=newBatches_1[_c],addedBatchIds.push(batch.batchId);for(var _d=0,_e=batch.mutations,mutation;_d<_e.length;_d++)mutation=_e[_d],changedKeys=changedKeys.add(mutation.key)}return _this.localDocuments.getDocuments(txn,changedKeys).next(function(affectedDocuments){return{affectedDocuments:affectedDocuments,removedBatchIds:removedBatchIds,addedBatchIds:addedBatchIds}})})})},LocalStore.prototype.localWrite=function(mutations){var _this=this;return this.persistence.runTransaction('Locally write mutations','readwrite',function(txn){var localWriteTime=Timestamp.now(),batch;return _this.mutationQueue.addMutationBatch(txn,localWriteTime,mutations).next(function(promisedBatch){batch=promisedBatch;var keys=batch.keys();return _this.localDocuments.getDocuments(txn,keys)}).next(function(changedDocuments){return{batchId:batch.batchId,changes:changedDocuments}})})},LocalStore.prototype.lookupMutationDocuments=function(batchId){var _this=this;return this.persistence.runTransaction('Lookup mutation documents','readonly',function(txn){return _this.mutationQueue.lookupMutationKeys(txn,batchId).next(function(keys){return keys?_this.localDocuments.getDocuments(txn,keys):PersistencePromise.resolve(null)})})},LocalStore.prototype.acknowledgeBatch=function(batchResult){var _this=this;return this.persistence.runTransaction('Acknowledge batch','readwrite-primary',function(txn){var affected=batchResult.batch.keys(),documentBuffer=_this.remoteDocuments.newChangeBuffer();return _this.mutationQueue.acknowledgeBatch(txn,batchResult.batch,batchResult.streamToken).next(function(){return _this.applyWriteToRemoteDocuments(txn,batchResult,documentBuffer)}).next(function(){return documentBuffer.apply(txn)}).next(function(){return _this.mutationQueue.performConsistencyCheck(txn)}).next(function(){return _this.localDocuments.getDocuments(txn,affected)})})},LocalStore.prototype.rejectBatch=function(batchId){var _this=this;return this.persistence.runTransaction('Reject batch','readwrite-primary',function(txn){var affectedKeys;return _this.mutationQueue.lookupMutationBatch(txn,batchId).next(function(batch){return assert(null!==batch,'Attempt to reject nonexistent batch!'),affectedKeys=batch.keys(),_this.mutationQueue.removeMutationBatch(txn,batch)}).next(function(){return _this.mutationQueue.performConsistencyCheck(txn)}).next(function(){return _this.localDocuments.getDocuments(txn,affectedKeys)})})},LocalStore.prototype.getLastStreamToken=function(){var _this=this;return this.persistence.runTransaction('Get last stream token','readonly',function(txn){return _this.mutationQueue.getLastStreamToken(txn)})},LocalStore.prototype.setLastStreamToken=function(streamToken){var _this=this;return this.persistence.runTransaction('Set last stream token','readwrite-primary',function(txn){return _this.mutationQueue.setLastStreamToken(txn,streamToken)})},LocalStore.prototype.getLastRemoteSnapshotVersion=function(){var _this=this;return this.persistence.runTransaction('Get last remote snapshot version','readonly',function(txn){return _this.queryCache.getLastRemoteSnapshotVersion(txn)})},LocalStore.prototype.applyRemoteEvent=function(remoteEvent){var _this=this,documentBuffer=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction('Apply remote event','readwrite-primary',function(txn){var promises=[],authoritativeUpdates=documentKeySet();forEachNumber(remoteEvent.targetChanges,function(targetId,change){var queryData=_this.queryDataByTarget[targetId];if(queryData){change.addedDocuments.forEach(function(key){authoritativeUpdates=authoritativeUpdates.add(key)}),change.modifiedDocuments.forEach(function(key){authoritativeUpdates=authoritativeUpdates.add(key)}),promises.push(_this.queryCache.removeMatchingKeys(txn,change.removedDocuments,targetId).next(function(){return _this.queryCache.addMatchingKeys(txn,change.addedDocuments,targetId)}));var resumeToken=change.resumeToken;if(0<resumeToken.length){var oldQueryData=queryData;queryData=queryData.copy({resumeToken:resumeToken,snapshotVersion:remoteEvent.snapshotVersion}),_this.queryDataByTarget[targetId]=queryData,LocalStore.shouldPersistQueryData(oldQueryData,queryData,change)&&promises.push(_this.queryCache.updateQueryData(txn,queryData))}}});var changedDocKeys=documentKeySet();remoteEvent.documentUpdates.forEach(function(key,doc){changedDocKeys=changedDocKeys.add(key),promises.push(documentBuffer.getEntry(txn,key).next(function(existingDoc){null==existingDoc||doc.version.isEqual(SnapshotVersion.MIN)||authoritativeUpdates.has(doc.key)&&!existingDoc.hasPendingWrites||0<=doc.version.compareTo(existingDoc.version)?documentBuffer.addEntry(doc):debug('LocalStore','Ignoring outdated watch update for ',key,'. Current version:',existingDoc.version,' Watch version:',doc.version)})),remoteEvent.resolvedLimboDocuments.has(key)&&promises.push(_this.persistence.referenceDelegate.updateLimboDocument(txn,key))});var remoteVersion=remoteEvent.snapshotVersion;if(!remoteVersion.isEqual(SnapshotVersion.MIN)){var updateRemoteVersion=_this.queryCache.getLastRemoteSnapshotVersion(txn).next(function(lastRemoteVersion){return assert(0<=remoteVersion.compareTo(lastRemoteVersion),'Watch stream reverted to previous snapshot?? '+remoteVersion+' < '+lastRemoteVersion),_this.queryCache.setTargetsMetadata(txn,txn.currentSequenceNumber,remoteVersion)});promises.push(updateRemoteVersion)}return PersistencePromise.waitFor(promises).next(function(){return documentBuffer.apply(txn)}).next(function(){return _this.localDocuments.getDocuments(txn,changedDocKeys)})})},LocalStore.shouldPersistQueryData=function(oldQueryData,newQueryData,change){if(0===newQueryData.resumeToken.length)return!1;if(0===oldQueryData.resumeToken.length)return!0;var timeDelta=newQueryData.snapshotVersion.toMicroseconds()-oldQueryData.snapshotVersion.toMicroseconds();if(timeDelta>=this.RESUME_TOKEN_MAX_AGE_MICROS)return!0;var changes=change.addedDocuments.size+change.modifiedDocuments.size+change.removedDocuments.size;return 0<changes},LocalStore.prototype.notifyLocalViewChanges=function(viewChanges){var _this=this;return this.persistence.runTransaction('notifyLocalViewChanges','readwrite',function(txn){return PersistencePromise.forEach(viewChanges,function(viewChange){return _this.localViewReferences.addReferences(viewChange.addedKeys,viewChange.targetId),_this.localViewReferences.removeReferences(viewChange.removedKeys,viewChange.targetId),PersistencePromise.forEach(viewChange.removedKeys,function(key){return _this.persistence.referenceDelegate.removeReference(txn,key)})})})},LocalStore.prototype.nextMutationBatch=function(afterBatchId){var _this=this;return this.persistence.runTransaction('Get next mutation batch','readonly',function(txn){return void 0===afterBatchId&&(afterBatchId=BATCHID_UNKNOWN),_this.mutationQueue.getNextMutationBatchAfterBatchId(txn,afterBatchId)})},LocalStore.prototype.readDocument=function(key){var _this=this;return this.persistence.runTransaction('read document','readonly',function(txn){return _this.localDocuments.getDocument(txn,key)})},LocalStore.prototype.allocateQuery=function(query){var _this=this;return this.persistence.runTransaction('Allocate query','readwrite',function(txn){var queryData;return _this.queryCache.getQueryData(txn,query).next(function(cached){return cached?(queryData=cached,PersistencePromise.resolve()):_this.queryCache.allocateTargetId(txn).next(function(targetId){return queryData=new QueryData(query,targetId,QueryPurpose.Listen,txn.currentSequenceNumber),_this.queryCache.addQueryData(txn,queryData)})}).next(function(){return assert(!_this.queryDataByTarget[queryData.targetId],'Tried to allocate an already allocated query: '+query),_this.queryDataByTarget[queryData.targetId]=queryData,queryData})})},LocalStore.prototype.releaseQuery=function(query,keepPersistedQueryData){var _this=this,mode=keepPersistedQueryData?'readwrite':'readwrite-primary';return this.persistence.runTransaction('Release query',mode,function(txn){return _this.queryCache.getQueryData(txn,query).next(function(queryData){assert(null!=queryData,'Tried to release nonexistent query: '+query);var targetId=queryData.targetId,cachedQueryData=_this.queryDataByTarget[targetId],removed=_this.localViewReferences.removeReferencesForId(targetId);return delete _this.queryDataByTarget[targetId],keepPersistedQueryData?PersistencePromise.resolve():PersistencePromise.forEach(removed,function(key){return _this.persistence.referenceDelegate.removeReference(txn,key)}).next(function(){return _this.persistence.referenceDelegate.removeTarget(txn,cachedQueryData)})})})},LocalStore.prototype.executeQuery=function(query){var _this=this;return this.persistence.runTransaction('Execute query','readonly',function(txn){return _this.localDocuments.getDocumentsMatchingQuery(txn,query)})},LocalStore.prototype.remoteDocumentKeys=function(targetId){var _this=this;return this.persistence.runTransaction('Remote document keys','readonly',function(txn){return _this.queryCache.getMatchingKeysForTargetId(txn,targetId)})},LocalStore.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},LocalStore.prototype.removeCachedMutationBatchMetadata=function(batchId){this.mutationQueue.removeCachedMutationKeys(batchId)},LocalStore.prototype.setNetworkEnabled=function(networkEnabled){this.persistence.setNetworkEnabled(networkEnabled)},LocalStore.prototype.applyWriteToRemoteDocuments=function(txn,batchResult,documentBuffer){var _this=this,batch=batchResult.batch,docKeys=batch.keys(),promiseChain=PersistencePromise.resolve();return docKeys.forEach(function(docKey){promiseChain=promiseChain.next(function(){return documentBuffer.getEntry(txn,docKey)}).next(function(remoteDoc){var doc=remoteDoc,ackVersion=batchResult.docVersions.get(docKey);assert(null!==ackVersion,'ackVersions should contain every doc in the write.'),(!doc||0>doc.version.compareTo(ackVersion))&&(doc=batch.applyToRemoteDocument(docKey,doc,batchResult),doc?documentBuffer.addEntry(doc):assert(!remoteDoc,'Mutation batch '+batch+' applied to document '+remoteDoc+' resulted in null'))})}),promiseChain.next(function(){return _this.mutationQueue.removeMutationBatch(txn,batch)})},LocalStore.prototype.getQueryForTarget=function(targetId){var _this=this;return this.queryDataByTarget[targetId]?Promise.resolve(this.queryDataByTarget[targetId].query):this.persistence.runTransaction('Get query data','readonly',function(txn){return _this.queryCache.getQueryDataForTarget(txn,targetId).next(function(queryData){return queryData?queryData.query:null})})},LocalStore.prototype.getNewDocumentChanges=function(){var _this=this;return this.persistence.runTransaction('Get new document changes','readonly',function(txn){return _this.remoteDocuments.getNewDocumentChanges(txn)})},LocalStore.RESUME_TOKEN_MAX_AGE_MICROS=1e6*(60*5),LocalStore}(),MemoryMutationQueue=function(){function MemoryMutationQueue(referenceDelegate){this.referenceDelegate=referenceDelegate,this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=BATCHID_UNKNOWN,this.lastStreamToken=emptyByteString(),this.batchesByDocumentKey=new SortedSet(DocReference.compareByKey)}return MemoryMutationQueue.prototype.checkEmpty=function(){return PersistencePromise.resolve(0===this.mutationQueue.length)},MemoryMutationQueue.prototype.acknowledgeBatch=function(transaction,batch,streamToken){var batchId=batch.batchId;assert(batchId>this.highestAcknowledgedBatchId,'Mutation batchIDs must be acknowledged in order');var batchIndex=this.indexOfExistingBatchId(batchId,'acknowledged');assert(0===batchIndex,'Can only acknowledge the first batch in the mutation queue');var check=this.mutationQueue[batchIndex];return assert(batchId===check.batchId,'Queue ordering failure: expected batch '+batchId+', got batch '+check.batchId),this.highestAcknowledgedBatchId=batchId,this.lastStreamToken=streamToken,PersistencePromise.resolve()},MemoryMutationQueue.prototype.getLastStreamToken=function(){return PersistencePromise.resolve(this.lastStreamToken)},MemoryMutationQueue.prototype.setLastStreamToken=function(transaction,streamToken){return this.lastStreamToken=streamToken,PersistencePromise.resolve()},MemoryMutationQueue.prototype.addMutationBatch=function(transaction,localWriteTime,mutations){assert(0!==mutations.length,'Mutation batches should not be empty');var batchId=this.nextBatchId;if(this.nextBatchId++,0<this.mutationQueue.length){var prior=this.mutationQueue[this.mutationQueue.length-1];assert(prior.batchId<batchId,'Mutation batchIDs must be monotonically increasing order')}var batch=new MutationBatch(batchId,localWriteTime,mutations);this.mutationQueue.push(batch);for(var _i=0,mutations_1=mutations,mutation;_i<mutations_1.length;_i++)mutation=mutations_1[_i],this.batchesByDocumentKey=this.batchesByDocumentKey.add(new DocReference(mutation.key,batchId));return PersistencePromise.resolve(batch)},MemoryMutationQueue.prototype.lookupMutationBatch=function(transaction,batchId){return PersistencePromise.resolve(this.findMutationBatch(batchId))},MemoryMutationQueue.prototype.lookupMutationKeys=function(transaction,batchId){var mutationBatch=this.findMutationBatch(batchId);return assert(null!=mutationBatch,'Failed to find local mutation batch.'),PersistencePromise.resolve(mutationBatch.keys())},MemoryMutationQueue.prototype.getNextMutationBatchAfterBatchId=function(transaction,batchId){var nextBatchId=_Mathmax(batchId,this.highestAcknowledgedBatchId)+1,rawIndex=this.indexOfBatchId(nextBatchId),index=0>rawIndex?0:rawIndex;return PersistencePromise.resolve(this.mutationQueue.length>index?this.mutationQueue[index]:null)},MemoryMutationQueue.prototype.getAllMutationBatches=function(){return PersistencePromise.resolve(this.mutationQueue.slice())},MemoryMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKey=function(transaction,documentKey){var _this=this,start=new DocReference(documentKey,0),end=new DocReference(documentKey,_NumberPOSITIVE_INFINITY),result=[];return this.batchesByDocumentKey.forEachInRange([start,end],function(ref){assert(documentKey.isEqual(ref.key),'Should only iterate over a single key\'s batches');var batch=_this.findMutationBatch(ref.targetOrBatchId);assert(null!==batch,'Batches in the index must exist in the main table'),result.push(batch)}),PersistencePromise.resolve(result)},MemoryMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKeys=function(transaction,documentKeys){var _this=this,uniqueBatchIDs=new SortedSet(primitiveComparator);return documentKeys.forEach(function(documentKey){var start=new DocReference(documentKey,0),end=new DocReference(documentKey,_NumberPOSITIVE_INFINITY);_this.batchesByDocumentKey.forEachInRange([start,end],function(ref){assert(documentKey.isEqual(ref.key),'For each key, should only iterate over a single key\'s batches'),uniqueBatchIDs=uniqueBatchIDs.add(ref.targetOrBatchId)})}),PersistencePromise.resolve(this.findMutationBatches(uniqueBatchIDs))},MemoryMutationQueue.prototype.getAllMutationBatchesAffectingQuery=function(transaction,query){var prefix=query.path,immediateChildrenPathLength=prefix.length+1,startPath=prefix;DocumentKey.isDocumentKey(startPath)||(startPath=startPath.child(''));var start=new DocReference(new DocumentKey(startPath),0),uniqueBatchIDs=new SortedSet(primitiveComparator);return this.batchesByDocumentKey.forEachWhile(function(ref){var rowKeyPath=ref.key.path;return!!prefix.isPrefixOf(rowKeyPath)&&(rowKeyPath.length===immediateChildrenPathLength&&(uniqueBatchIDs=uniqueBatchIDs.add(ref.targetOrBatchId)),!0)},start),PersistencePromise.resolve(this.findMutationBatches(uniqueBatchIDs))},MemoryMutationQueue.prototype.findMutationBatches=function(batchIDs){var _this=this,result=[];return batchIDs.forEach(function(batchId){var batch=_this.findMutationBatch(batchId);null!==batch&&result.push(batch)}),result},MemoryMutationQueue.prototype.removeMutationBatch=function(transaction,batch){var _this=this,batchIndex=this.indexOfExistingBatchId(batch.batchId,'removed');assert(0===batchIndex,'Can only remove the first entry of the mutation queue'),this.mutationQueue.shift();var references=this.batchesByDocumentKey;return PersistencePromise.forEach(batch.mutations,function(mutation){var ref=new DocReference(mutation.key,batch.batchId);return references=references.delete(ref),_this.referenceDelegate.removeMutationReference(transaction,mutation.key)}).next(function(){_this.batchesByDocumentKey=references})},MemoryMutationQueue.prototype.removeCachedMutationKeys=function(){},MemoryMutationQueue.prototype.containsKey=function(txn,key){var ref=new DocReference(key,0),firstRef=this.batchesByDocumentKey.firstAfterOrEqual(ref);return PersistencePromise.resolve(key.isEqual(firstRef&&firstRef.key))},MemoryMutationQueue.prototype.performConsistencyCheck=function(){return 0===this.mutationQueue.length&&assert(this.batchesByDocumentKey.isEmpty(),'Document leak -- detected dangling mutation references when queue is empty.'),PersistencePromise.resolve()},MemoryMutationQueue.prototype.indexOfExistingBatchId=function(batchId,action){var index=this.indexOfBatchId(batchId);return assert(0<=index&&index<this.mutationQueue.length,'Batches must exist to be '+action),index},MemoryMutationQueue.prototype.indexOfBatchId=function(batchId){if(0===this.mutationQueue.length)return 0;var firstBatchId=this.mutationQueue[0].batchId;return batchId-firstBatchId},MemoryMutationQueue.prototype.findMutationBatch=function(batchId){var index=this.indexOfBatchId(batchId);if(0>index||index>=this.mutationQueue.length)return null;var batch=this.mutationQueue[index];return assert(batch.batchId===batchId,'If found batch must match'),batch},MemoryMutationQueue}(),MemoryQueryCache=function(){function MemoryQueryCache(persistence){this.persistence=persistence,this.queries=new ObjectMap(function(q){return q.canonicalId()}),this.lastRemoteSnapshotVersion=SnapshotVersion.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new ReferenceSet,this.targetCount=0,this.targetIdGenerator=TargetIdGenerator.forQueryCache()}return MemoryQueryCache.prototype.getTargetCount=function(){return PersistencePromise.resolve(this.targetCount)},MemoryQueryCache.prototype.forEachTarget=function(txn,f){return this.queries.forEach(function(_,queryData){return f(queryData)}),PersistencePromise.resolve()},MemoryQueryCache.prototype.getLastRemoteSnapshotVersion=function(){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)},MemoryQueryCache.prototype.getHighestSequenceNumber=function(){return PersistencePromise.resolve(this.highestSequenceNumber)},MemoryQueryCache.prototype.allocateTargetId=function(){var nextTargetId=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=nextTargetId,PersistencePromise.resolve(nextTargetId)},MemoryQueryCache.prototype.setTargetsMetadata=function(transaction,highestListenSequenceNumber,lastRemoteSnapshotVersion){return lastRemoteSnapshotVersion&&(this.lastRemoteSnapshotVersion=lastRemoteSnapshotVersion),highestListenSequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=highestListenSequenceNumber),PersistencePromise.resolve()},MemoryQueryCache.prototype.saveQueryData=function(queryData){this.queries.set(queryData.query,queryData);var targetId=queryData.targetId;targetId>this.highestTargetId&&(this.highestTargetId=targetId),queryData.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=queryData.sequenceNumber)},MemoryQueryCache.prototype.addQueryData=function(transaction,queryData){return assert(!this.queries.has(queryData.query),'Adding a query that already exists'),this.saveQueryData(queryData),this.targetCount+=1,PersistencePromise.resolve()},MemoryQueryCache.prototype.updateQueryData=function(transaction,queryData){return assert(this.queries.has(queryData.query),'Updating a non-existent query'),this.saveQueryData(queryData),PersistencePromise.resolve()},MemoryQueryCache.prototype.removeQueryData=function(transaction,queryData){return assert(0<this.targetCount,'Removing a target from an empty cache'),assert(this.queries.has(queryData.query),'Removing a non-existent target from the cache'),this.queries.delete(queryData.query),this.references.removeReferencesForId(queryData.targetId),this.targetCount-=1,PersistencePromise.resolve()},MemoryQueryCache.prototype.removeTargets=function(transaction,upperBound,activeTargetIds){var _this=this,count=0,removals=[];return this.queries.forEach(function(key,queryData){queryData.sequenceNumber<=upperBound&&!activeTargetIds[queryData.targetId]&&(_this.queries.delete(key),removals.push(_this.removeMatchingKeysForTargetId(transaction,queryData.targetId)),count++)}),PersistencePromise.waitFor(removals).next(function(){return count})},MemoryQueryCache.prototype.getQueryCount=function(){return PersistencePromise.resolve(this.targetCount)},MemoryQueryCache.prototype.getQueryData=function(transaction,query){var queryData=this.queries.get(query)||null;return PersistencePromise.resolve(queryData)},MemoryQueryCache.prototype.getQueryDataForTarget=function(){return fail('Not yet implemented.')},MemoryQueryCache.prototype.addMatchingKeys=function(txn,keys,targetId){this.references.addReferences(keys,targetId);var referenceDelegate=this.persistence.referenceDelegate,promises=[];return referenceDelegate&&keys.forEach(function(key){promises.push(referenceDelegate.addReference(txn,key))}),PersistencePromise.waitFor(promises)},MemoryQueryCache.prototype.removeMatchingKeys=function(txn,keys,targetId){this.references.removeReferences(keys,targetId);var referenceDelegate=this.persistence.referenceDelegate,promises=[];return referenceDelegate&&keys.forEach(function(key){promises.push(referenceDelegate.removeReference(txn,key))}),PersistencePromise.waitFor(promises)},MemoryQueryCache.prototype.removeMatchingKeysForTargetId=function(txn,targetId){return this.references.removeReferencesForId(targetId),PersistencePromise.resolve()},MemoryQueryCache.prototype.getMatchingKeysForTargetId=function(txn,targetId){var matchingKeys=this.references.referencesForId(targetId);return PersistencePromise.resolve(matchingKeys)},MemoryQueryCache.prototype.containsKey=function(txn,key){return PersistencePromise.resolve(this.references.containsKey(key))},MemoryQueryCache}(),MemoryRemoteDocumentCache=function(){function MemoryRemoteDocumentCache(sizer){this.sizer=sizer,this.docs=documentSizeMap(),this.newDocumentChanges=documentKeySet(),this.size=0}return MemoryRemoteDocumentCache.prototype.addEntries=function(transaction,entries,sizeDelta){for(var _i=0,entries_1=entries;_i<entries_1.length;_i++){var entry=entries_1[_i],key=entry.maybeDocument.key;this.docs=this.docs.insert(key,entry),this.newDocumentChanges=this.newDocumentChanges.add(key)}return this.size+=sizeDelta,PersistencePromise.resolve()},MemoryRemoteDocumentCache.prototype.removeEntry=function(transaction,documentKey){var entry=this.docs.get(documentKey);return entry?(this.docs=this.docs.remove(documentKey),this.size-=entry.size,PersistencePromise.resolve(entry.size)):PersistencePromise.resolve(0)},MemoryRemoteDocumentCache.prototype.getEntry=function(transaction,documentKey){var entry=this.docs.get(documentKey);return PersistencePromise.resolve(entry?entry.maybeDocument:null)},MemoryRemoteDocumentCache.prototype.getSizedEntry=function(transaction,documentKey){return PersistencePromise.resolve(this.docs.get(documentKey))},MemoryRemoteDocumentCache.prototype.getDocumentsMatchingQuery=function(transaction,query){for(var results=documentMap(),prefix=new DocumentKey(query.path.child('')),iterator=this.docs.getIteratorFrom(prefix);iterator.hasNext();){var _a=iterator.getNext(),key=_a.key,maybeDocument=_a.value.maybeDocument;if(!query.path.isPrefixOf(key.path))break;maybeDocument instanceof Document&&query.matches(maybeDocument)&&(results=results.insert(maybeDocument.key,maybeDocument))}return PersistencePromise.resolve(results)},MemoryRemoteDocumentCache.prototype.forEachDocumentKey=function(transaction,f){return PersistencePromise.forEach(this.docs,function(key){return f(key)})},MemoryRemoteDocumentCache.prototype.getNewDocumentChanges=function(){var _this=this,changedDocs=maybeDocumentMap();return this.newDocumentChanges.forEach(function(key){var entry=_this.docs.get(key),changedDoc=entry?entry.maybeDocument:new NoDocument(key,SnapshotVersion.forDeletedDoc());changedDocs=changedDocs.insert(key,changedDoc)}),this.newDocumentChanges=documentKeySet(),PersistencePromise.resolve(changedDocs)},MemoryRemoteDocumentCache.prototype.newChangeBuffer=function(){return new MemoryRemoteDocumentChangeBuffer(this.sizer,this)},MemoryRemoteDocumentCache.prototype.getSize=function(){return PersistencePromise.resolve(this.size)},MemoryRemoteDocumentCache}(),MemoryRemoteDocumentChangeBuffer=function(_super){function MemoryRemoteDocumentChangeBuffer(sizer,documentCache){var _this=_super.call(this)||this;return _this.sizer=sizer,_this.documentCache=documentCache,_this}return tslib_1.__extends(MemoryRemoteDocumentChangeBuffer,_super),MemoryRemoteDocumentChangeBuffer.prototype.applyChanges=function(transaction){var _this=this,changes=this.assertChanges(),delta=0,docs=[];return changes.forEach(function(key,maybeDocument){var previousSize=_this.documentSizes.get(key);assert(void 0!==previousSize,'Attempting to change document '+key.toString()+' without having read it first');var size=_this.sizer(maybeDocument);delta+=size-previousSize,docs.push({maybeDocument:maybeDocument,size:size})}),this.documentCache.addEntries(transaction,docs,delta)},MemoryRemoteDocumentChangeBuffer.prototype.getFromCache=function(transaction,documentKey){return this.documentCache.getSizedEntry(transaction,documentKey)},MemoryRemoteDocumentChangeBuffer}(RemoteDocumentChangeBuffer),MemoryPersistence=function(){function MemoryPersistence(clientId,isEager,serializer){var _this=this;this.clientId=clientId,this.mutationQueues={},this.listenSequence=new ListenSequence(0),this._started=!1,this._started=!0,this.referenceDelegate=isEager?new MemoryEagerDelegate(this):new MemoryLruDelegate(this,new LocalSerializer(serializer)),this.queryCache=new MemoryQueryCache(this);this.remoteDocumentCache=new MemoryRemoteDocumentCache(function(doc){return _this.referenceDelegate.documentSize(doc)})}return MemoryPersistence.createLruPersistence=function(clientId,serializer){return new MemoryPersistence(clientId,!1,serializer)},MemoryPersistence.createEagerPersistence=function(clientId,serializer){return new MemoryPersistence(clientId,!0,serializer)},MemoryPersistence.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(MemoryPersistence.prototype,'started',{get:function(){return this._started},enumerable:!0,configurable:!0}),MemoryPersistence.prototype.getActiveClients=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return[2,[this.clientId]]})})},MemoryPersistence.prototype.setPrimaryStateListener=function(primaryStateListener){return primaryStateListener(!0)},MemoryPersistence.prototype.setNetworkEnabled=function(){},MemoryPersistence.prototype.getMutationQueue=function(user){var queue=this.mutationQueues[user.toKey()];return queue||(queue=new MemoryMutationQueue(this.referenceDelegate),this.mutationQueues[user.toKey()]=queue),queue},MemoryPersistence.prototype.getQueryCache=function(){return this.queryCache},MemoryPersistence.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},MemoryPersistence.prototype.runTransaction=function(action,mode,transactionOperation){var _this=this;debug('MemoryPersistence','Starting transaction:',action);var txn=new MemoryTransaction(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),transactionOperation(txn).next(function(result){return _this.referenceDelegate.onTransactionCommitted(txn).next(function(){return result})}).toPromise()},MemoryPersistence.prototype.mutationQueuesContainKey=function(transaction,key){return PersistencePromise.or(values(this.mutationQueues).map(function(queue){return function(){return queue.containsKey(transaction,key)}}))},MemoryPersistence}(),MemoryTransaction=function(){return function MemoryTransaction(currentSequenceNumber){this.currentSequenceNumber=currentSequenceNumber}}(),MemoryEagerDelegate=function(){function MemoryEagerDelegate(persistence){this.persistence=persistence}return MemoryEagerDelegate.prototype.setInMemoryPins=function(inMemoryPins){this.inMemoryPins=inMemoryPins},MemoryEagerDelegate.prototype.addReference=function(txn,key){return this.orphanedDocuments.delete(key),PersistencePromise.resolve()},MemoryEagerDelegate.prototype.removeReference=function(txn,key){return this.orphanedDocuments.add(key),PersistencePromise.resolve()},MemoryEagerDelegate.prototype.removeMutationReference=function(txn,key){return this.orphanedDocuments.add(key),PersistencePromise.resolve()},MemoryEagerDelegate.prototype.removeTarget=function(txn,queryData){var _this=this,cache=this.persistence.getQueryCache();return cache.getMatchingKeysForTargetId(txn,queryData.targetId).next(function(keys){keys.forEach(function(key){return _this.orphanedDocuments.add(key)})}).next(function(){return cache.removeQueryData(txn,queryData)})},MemoryEagerDelegate.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},MemoryEagerDelegate.prototype.onTransactionCommitted=function(txn){var _this=this,cache=this.persistence.getRemoteDocumentCache();return PersistencePromise.forEach(this.orphanedDocuments,function(key){return _this.isReferenced(txn,key).next(function(isReferenced){return isReferenced?PersistencePromise.resolve():cache.removeEntry(txn,key).next(function(){})})})},MemoryEagerDelegate.prototype.updateLimboDocument=function(txn,key){var _this=this;return this.isReferenced(txn,key).next(function(isReferenced){isReferenced?_this.orphanedDocuments.delete(key):_this.orphanedDocuments.add(key)})},MemoryEagerDelegate.prototype.documentSize=function(){return 0},MemoryEagerDelegate.prototype.isReferenced=function(txn,key){var _this=this;return PersistencePromise.or([function(){return _this.persistence.getQueryCache().containsKey(txn,key)},function(){return _this.persistence.mutationQueuesContainKey(txn,key)},function(){return PersistencePromise.resolve(_this.inMemoryPins.containsKey(key))}])},MemoryEagerDelegate}(),MemoryLruDelegate=function(){function MemoryLruDelegate(persistence,serializer){this.persistence=persistence,this.serializer=serializer,this.orphanedSequenceNumbers=new ObjectMap(function(k){return encode(k.path)}),this.garbageCollector=new LruGarbageCollector(this)}return MemoryLruDelegate.prototype.onTransactionStarted=function(){},MemoryLruDelegate.prototype.onTransactionCommitted=function(){return PersistencePromise.resolve()},MemoryLruDelegate.prototype.forEachTarget=function(txn,f){return this.persistence.getQueryCache().forEachTarget(txn,f)},MemoryLruDelegate.prototype.getTargetCount=function(txn){return this.persistence.getQueryCache().getTargetCount(txn)},MemoryLruDelegate.prototype.forEachOrphanedDocumentSequenceNumber=function(txn,f){var _this=this;return PersistencePromise.forEach(this.orphanedSequenceNumbers,function(key,sequenceNumber){return _this.isPinned(txn,key,sequenceNumber).next(function(isPinned){return isPinned?PersistencePromise.resolve():f(sequenceNumber)})})},MemoryLruDelegate.prototype.setInMemoryPins=function(inMemoryPins){this.inMemoryPins=inMemoryPins},MemoryLruDelegate.prototype.removeTargets=function(txn,upperBound,activeTargetIds){return this.persistence.getQueryCache().removeTargets(txn,upperBound,activeTargetIds)},MemoryLruDelegate.prototype.removeOrphanedDocuments=function(txn,upperBound){var _this=this,count=0,cache=this.persistence.getRemoteDocumentCache(),p=cache.forEachDocumentKey(txn,function(key){return _this.isPinned(txn,key,upperBound).next(function(isPinned){return isPinned?PersistencePromise.resolve():(count++,cache.removeEntry(txn,key).next())})});return p.next(function(){return count})},MemoryLruDelegate.prototype.removeMutationReference=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.removeTarget=function(txn,queryData){var updated=queryData.copy({sequenceNumber:txn.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(txn,updated)},MemoryLruDelegate.prototype.addReference=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.removeReference=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.updateLimboDocument=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.documentSize=function(maybeDoc){var remoteDocument=this.serializer.toDbRemoteDocument(maybeDoc),value;if(remoteDocument.document)value=remoteDocument.document;else if(remoteDocument.unknownDocument)value=remoteDocument.unknownDocument;else if(remoteDocument.noDocument)value=remoteDocument.noDocument;else throw fail('Unknown remote document type');return JSON.stringify(value).length},MemoryLruDelegate.prototype.isPinned=function(txn,key,upperBound){var _this=this;return PersistencePromise.or([function(){return _this.persistence.mutationQueuesContainKey(txn,key)},function(){return PersistencePromise.resolve(_this.inMemoryPins.containsKey(key))},function(){return _this.persistence.getQueryCache().containsKey(txn,key)},function(){var orphanedAt=_this.orphanedSequenceNumbers.get(key);return PersistencePromise.resolve(void 0!==orphanedAt&&orphanedAt>upperBound)}])},MemoryLruDelegate}(),ExponentialBackoff=function(){function ExponentialBackoff(queue,timerId,initialDelayMs,backoffFactor,maxDelayMs){this.queue=queue,this.timerId=timerId,this.initialDelayMs=initialDelayMs,this.backoffFactor=backoffFactor,this.maxDelayMs=maxDelayMs,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return ExponentialBackoff.prototype.reset=function(){this.currentBaseMs=0},ExponentialBackoff.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},ExponentialBackoff.prototype.backoffAndRun=function(op){var _this=this;this.cancel();var desiredDelayWithJitterMs=_Mathfloor(this.currentBaseMs+this.jitterDelayMs()),delaySoFarMs=_Mathmax(0,Date.now()-this.lastAttemptTime),remainingDelayMs=_Mathmax(0,desiredDelayWithJitterMs-delaySoFarMs);0<this.currentBaseMs&&debug('ExponentialBackoff','Backing off for '+remainingDelayMs+' ms '+('(base delay: '+this.currentBaseMs+' ms, ')+('delay with jitter: '+desiredDelayWithJitterMs+' ms, ')+('last attempt: '+delaySoFarMs+' ms ago)')),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,remainingDelayMs,function(){return _this.lastAttemptTime=Date.now(),op()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},ExponentialBackoff.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},ExponentialBackoff.prototype.jitterDelayMs=function(){return(Math.random()-0.5)*this.currentBaseMs},ExponentialBackoff}(),LOG_TAG$6='PersistentStream',PersistentStreamState;(function(PersistentStreamState){PersistentStreamState[PersistentStreamState.Initial=0]='Initial',PersistentStreamState[PersistentStreamState.Starting=1]='Starting',PersistentStreamState[PersistentStreamState.Open=2]='Open',PersistentStreamState[PersistentStreamState.Error=3]='Error',PersistentStreamState[PersistentStreamState.Backoff=4]='Backoff'})(PersistentStreamState||(PersistentStreamState={}));var PersistentStream=function(){function PersistentStream(queue,connectionTimerId,idleTimerId,connection,credentialsProvider,listener){this.queue=queue,this.idleTimerId=idleTimerId,this.connection=connection,this.credentialsProvider=credentialsProvider,this.listener=listener,this.state=PersistentStreamState.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new ExponentialBackoff(queue,connectionTimerId,1e3,1.5,1e3*60)}return PersistentStream.prototype.isStarted=function(){return this.state===PersistentStreamState.Starting||this.state===PersistentStreamState.Open||this.state===PersistentStreamState.Backoff},PersistentStream.prototype.isOpen=function(){return this.state===PersistentStreamState.Open},PersistentStream.prototype.start=function(){return this.state===PersistentStreamState.Error?void this.performBackoff():void(assert(this.state===PersistentStreamState.Initial,'Already started'),this.auth())},PersistentStream.prototype.stop=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.isStarted()?[4,this.close(PersistentStreamState.Initial)]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2];}})})},PersistentStream.prototype.inhibitBackoff=function(){assert(!this.isStarted(),'Can only inhibit backoff in a stopped state'),this.state=PersistentStreamState.Initial,this.backoff.reset()},PersistentStream.prototype.markIdle=function(){var _this=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,1e3*60,function(){return _this.handleIdleCloseTimer()}))},PersistentStream.prototype.sendRequest=function(msg){this.cancelIdleCheck(),this.stream.send(msg)},PersistentStream.prototype.handleIdleCloseTimer=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.isOpen()?[2,this.close(PersistentStreamState.Initial)]:[2]})})},PersistentStream.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},PersistentStream.prototype.close=function(finalState,error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return assert(this.isStarted(),'Only started streams should be closed.'),assert(finalState===PersistentStreamState.Error||isNullOrUndefined(error$$1),'Can\'t provide an error when not in an error state.'),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,finalState===PersistentStreamState.Error?error$$1&&error$$1.code===Code.RESOURCE_EXHAUSTED?(error(error$$1.toString()),error('Using maximum backoff delay to prevent overloading the backend.'),this.backoff.resetToMax()):error$$1&&error$$1.code===Code.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken():this.backoff.reset(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=finalState,[4,this.listener.onClose(error$$1)];case 1:return _a.sent(),[2];}})})},PersistentStream.prototype.tearDown=function(){},PersistentStream.prototype.auth=function(){var _this=this;assert(this.state===PersistentStreamState.Initial,'Must be in initial state to auth'),this.state=PersistentStreamState.Starting;var dispatchIfNotClosed=this.getCloseGuardedDispatcher(this.closeCount),closeCount=this.closeCount;this.credentialsProvider.getToken().then(function(token){_this.closeCount===closeCount&&_this.startStream(token)},function(error$$1){dispatchIfNotClosed(function(){var rpcError=new FirestoreError(Code.UNKNOWN,'Fetching auth token failed: '+error$$1.message);return _this.handleStreamClose(rpcError)})})},PersistentStream.prototype.startStream=function(token){var _this=this;assert(this.state===PersistentStreamState.Starting,'Trying to start stream in a non-starting state');var dispatchIfNotClosed=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(token),this.stream.onOpen(function(){dispatchIfNotClosed(function(){return assert(_this.state===PersistentStreamState.Starting,'Expected stream to be in state Starting, but was '+_this.state),_this.state=PersistentStreamState.Open,_this.listener.onOpen()})}),this.stream.onClose(function(error$$1){dispatchIfNotClosed(function(){return _this.handleStreamClose(error$$1)})}),this.stream.onMessage(function(msg){dispatchIfNotClosed(function(){return _this.onMessage(msg)})})},PersistentStream.prototype.performBackoff=function(){var _this=this;assert(this.state===PersistentStreamState.Error,'Should only perform backoff when in Error state'),this.state=PersistentStreamState.Backoff,this.backoff.backoffAndRun(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return assert(this.state===PersistentStreamState.Backoff,'Backoff elapsed but state is now: '+this.state),this.state=PersistentStreamState.Initial,this.start(),assert(this.isStarted(),'PersistentStream should have started'),[2]})})})},PersistentStream.prototype.handleStreamClose=function(error$$1){return assert(this.isStarted(),'Can\'t handle server close on non-started stream'),debug(LOG_TAG$6,'close with error: '+error$$1),this.stream=null,this.close(PersistentStreamState.Error,error$$1)},PersistentStream.prototype.getCloseGuardedDispatcher=function(startCloseCount){var _this=this;return function(fn){_this.queue.enqueueAndForget(function(){return _this.closeCount===startCloseCount?fn():(debug(LOG_TAG$6,'stream callback skipped by getCloseGuardedDispatcher.'),Promise.resolve())})}},PersistentStream}(),PersistentListenStream=function(_super){function PersistentListenStream(queue,connection,credentials,serializer,listener){var _this=_super.call(this,queue,TimerId.ListenStreamConnectionBackoff,TimerId.ListenStreamIdle,connection,credentials,listener)||this;return _this.serializer=serializer,_this}return tslib_1.__extends(PersistentListenStream,_super),PersistentListenStream.prototype.startRpc=function(token){return this.connection.openStream('Listen',token)},PersistentListenStream.prototype.onMessage=function(watchChangeProto){this.backoff.reset();var watchChange=this.serializer.fromWatchChange(watchChangeProto),snapshot=this.serializer.versionFromListenResponse(watchChangeProto);return this.listener.onWatchChange(watchChange,snapshot)},PersistentListenStream.prototype.watch=function(queryData){var request={database:this.serializer.encodedDatabaseId,addTarget:this.serializer.toTarget(queryData)},labels=this.serializer.toListenRequestLabels(queryData);labels&&(request.labels=labels),this.sendRequest(request)},PersistentListenStream.prototype.unwatch=function(targetId){var request={};request.database=this.serializer.encodedDatabaseId,request.removeTarget=targetId,this.sendRequest(request)},PersistentListenStream}(PersistentStream),PersistentWriteStream=function(_super){function PersistentWriteStream(queue,connection,credentials,serializer,listener){var _this=_super.call(this,queue,TimerId.WriteStreamConnectionBackoff,TimerId.WriteStreamIdle,connection,credentials,listener)||this;return _this.serializer=serializer,_this.handshakeComplete_=!1,_this}return tslib_1.__extends(PersistentWriteStream,_super),Object.defineProperty(PersistentWriteStream.prototype,'handshakeComplete',{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),PersistentWriteStream.prototype.start=function(){this.handshakeComplete_=!1,_super.prototype.start.call(this)},PersistentWriteStream.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},PersistentWriteStream.prototype.startRpc=function(token){return this.connection.openStream('Write',token)},PersistentWriteStream.prototype.onMessage=function(responseProto){if(assert(!!responseProto.streamToken,'Got a write response without a stream token'),this.lastStreamToken=responseProto.streamToken,!this.handshakeComplete_)return assert(!responseProto.writeResults||0===responseProto.writeResults.length,'Got mutation results for handshake'),this.handshakeComplete_=!0,this.listener.onHandshakeComplete();this.backoff.reset();var results=this.serializer.fromWriteResults(responseProto.writeResults,responseProto.commitTime),commitVersion=this.serializer.fromVersion(responseProto.commitTime);return this.listener.onMutationResult(commitVersion,results)},PersistentWriteStream.prototype.writeHandshake=function(){assert(this.isOpen(),'Writing handshake requires an opened stream'),assert(!this.handshakeComplete_,'Handshake already completed');var request={};request.database=this.serializer.encodedDatabaseId,this.sendRequest(request)},PersistentWriteStream.prototype.writeMutations=function(mutations){var _this=this;assert(this.isOpen(),'Writing mutations requires an opened stream'),assert(this.handshakeComplete_,'Handshake must be complete before writing mutations'),assert(0<this.lastStreamToken.length,'Trying to write mutation without a token');var request={streamToken:this.lastStreamToken,writes:mutations.map(function(mutation){return _this.serializer.toMutation(mutation)})};this.sendRequest(request)},PersistentWriteStream}(PersistentStream),Datastore=function(){function Datastore(queue,connection,credentials,serializer){this.queue=queue,this.connection=connection,this.credentials=credentials,this.serializer=serializer}return Datastore.prototype.newPersistentWriteStream=function(listener){return new PersistentWriteStream(this.queue,this.connection,this.credentials,this.serializer,listener)},Datastore.prototype.newPersistentWatchStream=function(listener){return new PersistentListenStream(this.queue,this.connection,this.credentials,this.serializer,listener)},Datastore.prototype.commit=function(mutations){var _this=this,params={database:this.serializer.encodedDatabaseId,writes:mutations.map(function(m){return _this.serializer.toMutation(m)})};return this.invokeRPC('Commit',params).then(function(response){return _this.serializer.fromWriteResults(response.writeResults,response.commitTime)})},Datastore.prototype.lookup=function(keys){var _this=this,params={database:this.serializer.encodedDatabaseId,documents:keys.map(function(k){return _this.serializer.toName(k)})};return this.invokeStreamingRPC('BatchGetDocuments',params).then(function(response){var docs=maybeDocumentMap();response.forEach(function(proto){var doc=_this.serializer.fromMaybeDocument(proto);docs=docs.insert(doc.key,doc)});var result=[];return keys.forEach(function(key){var doc=docs.get(key);assert(!!doc,'Missing entity in write response for '+key),result.push(doc)}),result})},Datastore.prototype.invokeRPC=function(rpcName,request){var _this=this;return this.credentials.getToken().then(function(token){return _this.connection.invokeRPC(rpcName,request,token)}).catch(function(error){throw error.code===Code.UNAUTHENTICATED&&_this.credentials.invalidateToken(),error})},Datastore.prototype.invokeStreamingRPC=function(rpcName,request){var _this=this;return this.credentials.getToken().then(function(token){return _this.connection.invokeStreamingRPC(rpcName,request,token)}).catch(function(error){throw error.code===Code.UNAUTHENTICATED&&_this.credentials.invalidateToken(),error})},Datastore}(),Transaction=function(){function Transaction(datastore){this.datastore=datastore,this.readVersions=documentVersionMap(),this.mutations=[],this.committed=!1}return Transaction.prototype.recordVersion=function(doc){var docVersion;if(doc instanceof Document)docVersion=doc.version;else if(doc instanceof NoDocument)docVersion=SnapshotVersion.forDeletedDoc();else throw fail('Document in a transaction was a '+doc.constructor.name);var existingVersion=this.readVersions.get(doc.key);if(null===existingVersion)this.readVersions=this.readVersions.insert(doc.key,docVersion);else if(!docVersion.isEqual(existingVersion))throw new FirestoreError(Code.ABORTED,'Document version changed between two reads.')},Transaction.prototype.lookup=function(keys){var _this=this;return this.committed?Promise.reject('Transaction has already completed.'):0<this.mutations.length?Promise.reject('Transactions lookups are invalid after writes.'):this.datastore.lookup(keys).then(function(docs){return docs.forEach(function(doc){doc instanceof NoDocument||doc instanceof Document?_this.recordVersion(doc):fail('Document in a transaction was a '+doc.constructor.name)}),docs})},Transaction.prototype.write=function(mutations){if(this.committed)throw new FirestoreError(Code.FAILED_PRECONDITION,'Transaction has already completed.');this.mutations=this.mutations.concat(mutations)},Transaction.prototype.precondition=function(key){var version=this.readVersions.get(key);return version?Precondition.updateTime(version):Precondition.NONE},Transaction.prototype.preconditionForUpdate=function(key){var version=this.readVersions.get(key);if(version&&version.isEqual(SnapshotVersion.forDeletedDoc()))throw new FirestoreError(Code.FAILED_PRECONDITION,'Can\'t update a document that doesn\'t exist.');else return version?Precondition.updateTime(version):Precondition.exists(!0)},Transaction.prototype.set=function(key,data){this.write(data.toMutations(key,this.precondition(key)))},Transaction.prototype.update=function(key,data){this.write(data.toMutations(key,this.preconditionForUpdate(key)))},Transaction.prototype.delete=function(key){this.write([new DeleteMutation(key,this.precondition(key))]),this.readVersions=this.readVersions.insert(key,SnapshotVersion.forDeletedDoc())},Transaction.prototype.commit=function(){var _this=this,unwritten=this.readVersions;return this.mutations.forEach(function(mutation){unwritten=unwritten.remove(mutation.key)}),unwritten.isEmpty()?this.datastore.commit(this.mutations).then(function(){_this.committed=!0}):Promise.reject(Error('Every document read in a transaction must also be written.'))},Transaction}(),OnlineState;(function(OnlineState){OnlineState[OnlineState.Unknown=0]='Unknown',OnlineState[OnlineState.Online=1]='Online',OnlineState[OnlineState.Offline=2]='Offline'})(OnlineState||(OnlineState={}));var OnlineStateSource;(function(OnlineStateSource){OnlineStateSource[OnlineStateSource.RemoteStore=0]='RemoteStore',OnlineStateSource[OnlineStateSource.SharedClientState=1]='SharedClientState'})(OnlineStateSource||(OnlineStateSource={}));var MAX_WATCH_STREAM_FAILURES=1,ONLINE_STATE_TIMEOUT_MS=1e3*10,OnlineStateTracker=function(){function OnlineStateTracker(asyncQueue,onlineStateHandler){this.asyncQueue=asyncQueue,this.onlineStateHandler=onlineStateHandler,this.state=OnlineState.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return OnlineStateTracker.prototype.handleWatchStreamStart=function(){var _this=this;0===this.watchStreamFailures&&(this.setAndBroadcast(OnlineState.Unknown),assert(null===this.onlineStateTimer,'onlineStateTimer shouldn\'t be started yet'),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(TimerId.OnlineStateTimeout,ONLINE_STATE_TIMEOUT_MS,function(){return _this.onlineStateTimer=null,assert(_this.state===OnlineState.Unknown,'Timer should be canceled if we transitioned to a different state.'),_this.logClientOfflineWarningIfNecessary('Backend didn\'t respond within '+ONLINE_STATE_TIMEOUT_MS/1e3+' '+'seconds.'),_this.setAndBroadcast(OnlineState.Offline),Promise.resolve()}))},OnlineStateTracker.prototype.handleWatchStreamFailure=function(error$$1){this.state===OnlineState.Online?(this.setAndBroadcast(OnlineState.Unknown),assert(0===this.watchStreamFailures,'watchStreamFailures must be 0'),assert(null===this.onlineStateTimer,'onlineStateTimer must be null')):(this.watchStreamFailures++,this.watchStreamFailures>=MAX_WATCH_STREAM_FAILURES&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary('Connection failed '+MAX_WATCH_STREAM_FAILURES+' '+('times. Most recent error: '+error$$1.toString())),this.setAndBroadcast(OnlineState.Offline)))},OnlineStateTracker.prototype.set=function(newState){this.clearOnlineStateTimer(),this.watchStreamFailures=0,newState===OnlineState.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(newState)},OnlineStateTracker.prototype.setAndBroadcast=function(newState){newState!==this.state&&(this.state=newState,this.onlineStateHandler(newState))},OnlineStateTracker.prototype.logClientOfflineWarningIfNecessary=function(details){var message='Could not reach Cloud Firestore backend. '+details+'\n'+'This typically indicates that your device does not have a healthy '+'Internet connection at the moment. The client will operate in offline '+'mode until it is able to successfully connect to the backend.';this.shouldWarnClientIsOffline?(error(message),this.shouldWarnClientIsOffline=!1):debug('OnlineStateTracker',message)},OnlineStateTracker.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},OnlineStateTracker}(),LOG_TAG$8='RemoteStore',RemoteStore=function(){function RemoteStore(localStore,datastore,asyncQueue,onlineStateHandler){this.localStore=localStore,this.datastore=datastore,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.onlineStateTracker=new OnlineStateTracker(asyncQueue,onlineStateHandler),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return RemoteStore.prototype.start=function(){return this.enableNetwork()},RemoteStore.prototype.enableNetwork=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _a;return tslib_1.__generator(this,function(_b){switch(_b.label){case 0:return(this.networkEnabled=!0,!this.canUseNetwork())?[3,3]:(_a=this.writeStream,[4,this.localStore.getLastStreamToken()]);case 1:return _a.lastStreamToken=_b.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(OnlineState.Unknown),[4,this.fillWritePipeline()];case 2:_b.sent(),_b.label=3;case 3:return[2];}})})},RemoteStore.prototype.disableNetwork=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return _a.sent(),this.onlineStateTracker.set(OnlineState.Offline),[2];}})})},RemoteStore.prototype.disableNetworkInternal=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return[4,this.writeStream.stop()];case 1:return _a.sent(),[4,this.watchStream.stop()];case 2:return _a.sent(),0<this.writePipeline.length&&(debug(LOG_TAG$8,'Stopping write stream with '+this.writePipeline.length+' pending writes'),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2];}})})},RemoteStore.prototype.shutdown=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return debug(LOG_TAG$8,'RemoteStore shutting down.'),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return _a.sent(),this.onlineStateTracker.set(OnlineState.Unknown),[2];}})})},RemoteStore.prototype.listen=function(queryData){assert(!contains(this.listenTargets,queryData.targetId),'listen called with duplicate targetId!'),this.listenTargets[queryData.targetId]=queryData,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(queryData)},RemoteStore.prototype.unlisten=function(targetId){assert(contains(this.listenTargets,targetId),'unlisten called without assigned target ID!'),delete this.listenTargets[targetId],this.watchStream.isOpen()&&this.sendUnwatchRequest(targetId),isEmpty(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(OnlineState.Unknown))},RemoteStore.prototype.getQueryDataForTarget=function(targetId){return this.listenTargets[targetId]||null},RemoteStore.prototype.getRemoteKeysForTarget=function(targetId){return this.syncEngine.getRemoteKeysForTarget(targetId)},RemoteStore.prototype.sendWatchRequest=function(queryData){this.watchChangeAggregator.recordPendingTargetRequest(queryData.targetId),this.watchStream.watch(queryData)},RemoteStore.prototype.sendUnwatchRequest=function(targetId){this.watchChangeAggregator.recordPendingTargetRequest(targetId),this.watchStream.unwatch(targetId)},RemoteStore.prototype.startWatchStream=function(){assert(this.shouldStartWatchStream(),'startWatchStream() called when shouldStartWatchStream() is false.'),this.watchChangeAggregator=new WatchChangeAggregator(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},RemoteStore.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!isEmpty(this.listenTargets)},RemoteStore.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},RemoteStore.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},RemoteStore.prototype.onWatchStreamOpen=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this;return tslib_1.__generator(this,function(){return forEachNumber(this.listenTargets,function(targetId,queryData){_this.sendWatchRequest(queryData)}),[2]})})},RemoteStore.prototype.onWatchStreamClose=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return void 0===error$$1&&assert(!this.shouldStartWatchStream(),'Watch stream was stopped gracefully while still needed.'),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(error$$1),this.startWatchStream()):this.onlineStateTracker.set(OnlineState.Unknown),[2]})})},RemoteStore.prototype.onWatchStreamChange=function(watchChange,snapshotVersion){return tslib_1.__awaiter(this,void 0,void 0,function(){var lastRemoteSnapshotVersion;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.onlineStateTracker.set(OnlineState.Online),watchChange instanceof WatchTargetChange&&watchChange.state===WatchTargetChangeState.Removed&&watchChange.cause)?[2,this.handleTargetError(watchChange)]:(watchChange instanceof DocumentWatchChange?this.watchChangeAggregator.handleDocumentChange(watchChange):watchChange instanceof ExistenceFilterChange?this.watchChangeAggregator.handleExistenceFilter(watchChange):(assert(watchChange instanceof WatchTargetChange,'Expected watchChange to be an instance of WatchTargetChange'),this.watchChangeAggregator.handleTargetChange(watchChange)),snapshotVersion.isEqual(SnapshotVersion.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return lastRemoteSnapshotVersion=_a.sent(),0<=snapshotVersion.compareTo(lastRemoteSnapshotVersion)?[4,this.raiseWatchSnapshot(snapshotVersion)]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2];}})})},RemoteStore.prototype.raiseWatchSnapshot=function(snapshotVersion){var _this=this;assert(!snapshotVersion.isEqual(SnapshotVersion.MIN),'Can\'t raise event for unknown SnapshotVersion');var remoteEvent=this.watchChangeAggregator.createRemoteEvent(snapshotVersion);return forEachNumber(remoteEvent.targetChanges,function(targetId,change){if(0<change.resumeToken.length){var queryData=_this.listenTargets[targetId];queryData&&(_this.listenTargets[targetId]=queryData.copy({resumeToken:change.resumeToken,snapshotVersion:snapshotVersion}))}}),remoteEvent.targetMismatches.forEach(function(targetId){var queryData=_this.listenTargets[targetId];if(queryData){_this.listenTargets[targetId]=queryData.copy({resumeToken:emptyByteString()}),_this.sendUnwatchRequest(targetId);var requestQueryData=new QueryData(queryData.query,targetId,QueryPurpose.ExistenceFilterMismatch,queryData.sequenceNumber);_this.sendWatchRequest(requestQueryData)}}),this.syncEngine.applyRemoteEvent(remoteEvent)},RemoteStore.prototype.handleTargetError=function(watchChange){var _this=this;assert(!!watchChange.cause,'Handling target error without a cause');var error$$1=watchChange.cause,promiseChain=Promise.resolve();return watchChange.targetIds.forEach(function(targetId){promiseChain=promiseChain.then(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return contains(this.listenTargets,targetId)?(delete this.listenTargets[targetId],this.watchChangeAggregator.removeTarget(targetId),[2,this.syncEngine.rejectListen(targetId,error$$1)]):[2]})})})}),promiseChain},RemoteStore.prototype.fillWritePipeline=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var lastBatchIdRetrieved,batch;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.canAddToWritePipeline()?(lastBatchIdRetrieved=0<this.writePipeline.length?this.writePipeline[this.writePipeline.length-1].batchId:BATCHID_UNKNOWN,[4,this.localStore.nextMutationBatch(lastBatchIdRetrieved)]):[3,4];case 1:return(batch=_a.sent(),null!==batch)?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(batch),[4,this.fillWritePipeline()];case 3:_a.sent(),_a.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2];}})})},RemoteStore.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},RemoteStore.prototype.outstandingWrites=function(){return this.writePipeline.length},RemoteStore.prototype.addToWritePipeline=function(batch){assert(this.canAddToWritePipeline(),'addToWritePipeline called when pipeline is full'),this.writePipeline.push(batch),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(batch.mutations)},RemoteStore.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&0<this.writePipeline.length},RemoteStore.prototype.startWriteStream=function(){assert(this.shouldStartWriteStream(),'startWriteStream() called when shouldStartWriteStream() is false.'),this.writeStream.start()},RemoteStore.prototype.onWriteStreamOpen=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.writeStream.writeHandshake(),[2]})})},RemoteStore.prototype.onWriteHandshakeComplete=function(){var _this=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var _i=0,_a=_this.writePipeline,batch;_i<_a.length;_i++)batch=_a[_i],_this.writeStream.writeMutations(batch.mutations)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},RemoteStore.prototype.ignoreIfPrimaryLeaseLoss=function(err){if(isPrimaryLeaseLostError(err))debug(LOG_TAG$8,'Unexpectedly lost primary lease');else throw err},RemoteStore.prototype.onMutationResult=function(commitVersion,results){var _this=this;assert(0<this.writePipeline.length,'Got result for empty write pipeline');var batch=this.writePipeline.shift(),success=MutationBatchResult.from(batch,commitVersion,results,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(success).then(function(){return _this.fillWritePipeline()})},RemoteStore.prototype.onWriteStreamClose=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,errorHandling;return tslib_1.__generator(this,function(){return void 0===error$$1&&assert(!this.shouldStartWriteStream(),'Write stream was stopped gracefully while still needed.'),error$$1&&0<this.writePipeline.length?(errorHandling=void 0,errorHandling=this.writeStream.handshakeComplete?this.handleWriteError(error$$1):this.handleHandshakeError(error$$1),[2,errorHandling.then(function(){_this.shouldStartWriteStream()&&_this.startWriteStream()})]):[2]})})},RemoteStore.prototype.handleHandshakeError=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this;return tslib_1.__generator(this,function(){return isPermanentError(error$$1.code)||error$$1.code===Code.ABORTED?(debug(LOG_TAG$8,'RemoteStore error before completed handshake; resetting stream token: ',this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=emptyByteString(),[2,this.localStore.setLastStreamToken(emptyByteString()).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})]):[2]})})},RemoteStore.prototype.handleWriteError=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,batch;return tslib_1.__generator(this,function(){return isPermanentError(error$$1.code)?(batch=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(batch.batchId,error$$1).then(function(){return _this.fillWritePipeline()})]):[2]})})},RemoteStore.prototype.createTransaction=function(){return new Transaction(this.datastore)},RemoteStore.prototype.handleCredentialChange=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.canUseNetwork()?(debug(LOG_TAG$8,'RemoteStore restarting streams for new credential'),this.networkEnabled=!1,[4,this.disableNetworkInternal()]):[3,3];case 1:return _a.sent(),this.onlineStateTracker.set(OnlineState.Unknown),[4,this.enableNetwork()];case 2:_a.sent(),_a.label=3;case 3:return[2];}})})},RemoteStore.prototype.applyPrimaryState=function(isPrimary){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.isPrimary=isPrimary,isPrimary&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return _a.sent(),[3,4];case 2:return isPrimary?[3,4]:[4,this.disableNetworkInternal()];case 3:_a.sent(),this.onlineStateTracker.set(OnlineState.Unknown),_a.label=4;case 4:return[2];}})})},RemoteStore}(),QueryListenersInfo=function(){return function QueryListenersInfo(){this.listeners=[]}}(),EventManager=function(){function EventManager(syncEngine){this.syncEngine=syncEngine,this.queries=new ObjectMap(function(q){return q.canonicalId()}),this.onlineState=OnlineState.Unknown,this.syncEngine.subscribe(this)}return EventManager.prototype.listen=function(listener){var query=listener.query,firstListen=!1,queryInfo=this.queries.get(query);return queryInfo||(firstListen=!0,queryInfo=new QueryListenersInfo,this.queries.set(query,queryInfo)),queryInfo.listeners.push(listener),listener.applyOnlineStateChange(this.onlineState),queryInfo.viewSnap&&listener.onViewSnapshot(queryInfo.viewSnap),firstListen?this.syncEngine.listen(query).then(function(targetId){return queryInfo.targetId=targetId,targetId}):Promise.resolve(queryInfo.targetId)},EventManager.prototype.unlisten=function(listener){return tslib_1.__awaiter(this,void 0,void 0,function(){var query,lastListen,queryInfo,i;return tslib_1.__generator(this,function(){return query=listener.query,lastListen=!1,queryInfo=this.queries.get(query),queryInfo&&(i=queryInfo.listeners.indexOf(listener),0<=i&&(queryInfo.listeners.splice(i,1),lastListen=0===queryInfo.listeners.length)),lastListen?(this.queries.delete(query),[2,this.syncEngine.unlisten(query)]):[2]})})},EventManager.prototype.onWatchChange=function(viewSnaps){for(var _i=0,viewSnaps_1=viewSnaps;_i<viewSnaps_1.length;_i++){var viewSnap=viewSnaps_1[_i],query=viewSnap.query,queryInfo=this.queries.get(query);if(queryInfo){for(var _a=0,_b=queryInfo.listeners,listener;_a<_b.length;_a++)listener=_b[_a],listener.onViewSnapshot(viewSnap);queryInfo.viewSnap=viewSnap}}},EventManager.prototype.onWatchError=function(query,error){var queryInfo=this.queries.get(query);if(queryInfo)for(var _i=0,_a=queryInfo.listeners,listener;_i<_a.length;_i++)listener=_a[_i],listener.onError(error);this.queries.delete(query)},EventManager.prototype.onOnlineStateChange=function(onlineState){this.onlineState=onlineState,this.queries.forEach(function(_,queryInfo){for(var _i=0,_a=queryInfo.listeners,listener;_i<_a.length;_i++)listener=_a[_i],listener.applyOnlineStateChange(onlineState)})},EventManager}(),QueryListener=function(){function QueryListener(query,queryObserver,options){this.query=query,this.queryObserver=queryObserver,this.raisedInitialEvent=!1,this.onlineState=OnlineState.Unknown,this.options=options||{}}return QueryListener.prototype.onViewSnapshot=function(snap){if(assert(0<snap.docChanges.length||snap.syncStateChanged,'We got a new snapshot with no changes?'),!this.options.includeMetadataChanges){for(var docChanges=[],_i=0,_a=snap.docChanges,docChange;_i<_a.length;_i++)docChange=_a[_i],docChange.type!==ChangeType.Metadata&&docChanges.push(docChange);snap=new ViewSnapshot(snap.query,snap.docs,snap.oldDocs,docChanges,snap.mutatedKeys,snap.fromCache,snap.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(snap)&&this.queryObserver.next(snap):this.shouldRaiseInitialEvent(snap,this.onlineState)&&this.raiseInitialEvent(snap),this.snap=snap},QueryListener.prototype.onError=function(error){this.queryObserver.error(error)},QueryListener.prototype.applyOnlineStateChange=function(onlineState){this.onlineState=onlineState,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,onlineState)&&this.raiseInitialEvent(this.snap)},QueryListener.prototype.shouldRaiseInitialEvent=function(snap,onlineState){if(assert(!this.raisedInitialEvent,'Determining whether to raise first event but already had first event'),!snap.fromCache)return!0;var maybeOnline=onlineState!==OnlineState.Offline;return this.options.waitForSyncWhenOnline&&maybeOnline?(assert(snap.fromCache,'Waiting for sync, but snapshot is not from cache'),!1):!snap.docs.isEmpty()||onlineState===OnlineState.Offline},QueryListener.prototype.shouldRaiseEvent=function(snap){if(0<snap.docChanges.length)return!0;var hasPendingWritesChanged=this.snap&&this.snap.hasPendingWrites!==snap.hasPendingWrites;return(snap.syncStateChanged||hasPendingWritesChanged)&&!0===this.options.includeMetadataChanges},QueryListener.prototype.raiseInitialEvent=function(snap){assert(!this.raisedInitialEvent,'Trying to raise initial events for second time'),snap=ViewSnapshot.fromInitialDocuments(snap.query,snap.docs,snap.mutatedKeys,snap.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(snap)},QueryListener}(),LocalViewChanges=function(){function LocalViewChanges(targetId,addedKeys,removedKeys){this.targetId=targetId,this.addedKeys=addedKeys,this.removedKeys=removedKeys}return LocalViewChanges.fromSnapshot=function(targetId,viewSnapshot){for(var addedKeys=documentKeySet(),removedKeys=documentKeySet(),_i=0,_a=viewSnapshot.docChanges,docChange;_i<_a.length;_i++)switch(docChange=_a[_i],docChange.type){case ChangeType.Added:addedKeys=addedKeys.add(docChange.doc.key);break;case ChangeType.Removed:removedKeys=removedKeys.add(docChange.doc.key);break;default:}return new LocalViewChanges(targetId,addedKeys,removedKeys)},LocalViewChanges}(),AddedLimboDocument=function(){return function AddedLimboDocument(key){this.key=key}}(),RemovedLimboDocument=function(){return function RemovedLimboDocument(key){this.key=key}}(),View=function(){function View(query,_syncedDocuments){this.query=query,this._syncedDocuments=_syncedDocuments,this.syncState=null,this.current=!1,this.limboDocuments=documentKeySet(),this.mutatedKeys=documentKeySet(),this.documentSet=new DocumentSet(query.docComparator.bind(query))}return Object.defineProperty(View.prototype,'syncedDocuments',{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),View.prototype.computeDocChanges=function(docChanges,previousChanges){var _this=this,changeSet=previousChanges?previousChanges.changeSet:new DocumentChangeSet,oldDocumentSet=previousChanges?previousChanges.documentSet:this.documentSet,newMutatedKeys=previousChanges?previousChanges.mutatedKeys:this.mutatedKeys,newDocumentSet=oldDocumentSet,needsRefill=!1,lastDocInLimit=this.query.hasLimit()&&oldDocumentSet.size===this.query.limit?oldDocumentSet.last():null;if(docChanges.inorderTraversal(function(key,newMaybeDoc){var oldDoc=oldDocumentSet.get(key),newDoc=newMaybeDoc instanceof Document?newMaybeDoc:null;newDoc&&(assert(key.isEqual(newDoc.key),'Mismatching keys found in document changes: '+key+' != '+newDoc.key),newDoc=_this.query.matches(newDoc)?newDoc:null);var oldDocHadPendingMutations=!!oldDoc&&_this.mutatedKeys.has(oldDoc.key),newDocHasPendingMutations=!!newDoc&&(newDoc.hasLocalMutations||_this.mutatedKeys.has(newDoc.key)&&newDoc.hasCommittedMutations),changeApplied=!1;if(oldDoc&&newDoc){var docsEqual=oldDoc.data.isEqual(newDoc.data);docsEqual?oldDocHadPendingMutations!==newDocHasPendingMutations&&(changeSet.track({type:ChangeType.Metadata,doc:newDoc}),changeApplied=!0):!_this.shouldWaitForSyncedDocument(oldDoc,newDoc)&&(changeSet.track({type:ChangeType.Modified,doc:newDoc}),changeApplied=!0,lastDocInLimit&&0<_this.query.docComparator(newDoc,lastDocInLimit)&&(needsRefill=!0))}else!oldDoc&&newDoc?(changeSet.track({type:ChangeType.Added,doc:newDoc}),changeApplied=!0):oldDoc&&!newDoc&&(changeSet.track({type:ChangeType.Removed,doc:oldDoc}),changeApplied=!0,lastDocInLimit&&(needsRefill=!0));changeApplied&&(newDoc?(newDocumentSet=newDocumentSet.add(newDoc),newMutatedKeys=newDocHasPendingMutations?newMutatedKeys.add(key):newMutatedKeys.delete(key)):(newDocumentSet=newDocumentSet.delete(key),newMutatedKeys=newMutatedKeys.delete(key)))}),this.query.hasLimit())for(;newDocumentSet.size>this.query.limit;){var oldDoc=newDocumentSet.last();newDocumentSet=newDocumentSet.delete(oldDoc.key),newMutatedKeys=newMutatedKeys.delete(oldDoc.key),changeSet.track({type:ChangeType.Removed,doc:oldDoc})}return assert(!needsRefill||!previousChanges,'View was refilled using docs that themselves needed refilling.'),{documentSet:newDocumentSet,changeSet:changeSet,needsRefill:needsRefill,mutatedKeys:newMutatedKeys}},View.prototype.shouldWaitForSyncedDocument=function(oldDoc,newDoc){return oldDoc.hasLocalMutations&&newDoc.hasCommittedMutations&&!newDoc.hasLocalMutations},View.prototype.applyChanges=function(docChanges,updateLimboDocuments,targetChange){var _this=this;assert(!docChanges.needsRefill,'Cannot apply changes that need a refill');var oldDocs=this.documentSet;this.documentSet=docChanges.documentSet,this.mutatedKeys=docChanges.mutatedKeys;var changes=docChanges.changeSet.getChanges();changes.sort(function(c1,c2){return compareChangeType(c1.type,c2.type)||_this.query.docComparator(c1.doc,c2.doc)}),this.applyTargetChange(targetChange);var limboChanges=updateLimboDocuments?this.updateLimboDocuments():[],synced=0===this.limboDocuments.size&&this.current,newSyncState=synced?SyncState.Synced:SyncState.Local,syncStateChanged=newSyncState!==this.syncState;if(this.syncState=newSyncState,0===changes.length&&!syncStateChanged)return{limboChanges:limboChanges};var snap=new ViewSnapshot(this.query,docChanges.documentSet,oldDocs,changes,docChanges.mutatedKeys,newSyncState===SyncState.Local,syncStateChanged,!1);return{snapshot:snap,limboChanges:limboChanges}},View.prototype.applyOnlineStateChange=function(onlineState){return this.current&&onlineState===OnlineState.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new DocumentChangeSet,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},View.prototype.shouldBeInLimbo=function(key){return!this._syncedDocuments.has(key)&&!!this.documentSet.has(key)&&!this.documentSet.get(key).hasLocalMutations},View.prototype.applyTargetChange=function(targetChange){var _this=this;targetChange&&(targetChange.addedDocuments.forEach(function(key){return _this._syncedDocuments=_this._syncedDocuments.add(key)}),targetChange.modifiedDocuments.forEach(function(key){return assert(_this._syncedDocuments.has(key),'Modified document '+key+' not found in view.')}),targetChange.removedDocuments.forEach(function(key){return _this._syncedDocuments=_this._syncedDocuments.delete(key)}),this.current=targetChange.current)},View.prototype.updateLimboDocuments=function(){var _this=this;if(!this.current)return[];var oldLimboDocuments=this.limboDocuments;this.limboDocuments=documentKeySet(),this.documentSet.forEach(function(doc){_this.shouldBeInLimbo(doc.key)&&(_this.limboDocuments=_this.limboDocuments.add(doc.key))});var changes=[];return oldLimboDocuments.forEach(function(key){_this.limboDocuments.has(key)||changes.push(new RemovedLimboDocument(key))}),this.limboDocuments.forEach(function(key){oldLimboDocuments.has(key)||changes.push(new AddedLimboDocument(key))}),changes},View.prototype.synchronizeWithPersistedState=function(localDocs,remoteKeys){this._syncedDocuments=remoteKeys,this.limboDocuments=documentKeySet();var docChanges=this.computeDocChanges(localDocs);return this.applyChanges(docChanges,!0)},View.prototype.computeInitialSnapshot=function(){return ViewSnapshot.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===SyncState.Local)},View}(),LOG_TAG$9='SyncEngine',QueryView=function(){return function QueryView(query,targetId,view){this.query=query,this.targetId=targetId,this.view=view}}(),LimboResolution=function(){return function LimboResolution(key){this.key=key}}(),SyncEngine=function(){function SyncEngine(localStore,remoteStore,sharedClientState,currentUser){this.localStore=localStore,this.remoteStore=remoteStore,this.sharedClientState=sharedClientState,this.currentUser=currentUser,this.syncEngineListener=null,this.queryViewsByQuery=new ObjectMap(function(q){return q.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new SortedMap(DocumentKey.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new ReferenceSet,this.mutationUserCallbacks={},this.limboTargetIdGenerator=TargetIdGenerator.forSyncEngine(),this.isPrimary=void 0,this.onlineState=OnlineState.Unknown}return Object.defineProperty(SyncEngine.prototype,'isPrimaryClient',{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),SyncEngine.prototype.subscribe=function(syncEngineListener){assert(null!==syncEngineListener,'SyncEngine listener cannot be null'),assert(null===this.syncEngineListener,'SyncEngine already has a subscriber.'),this.syncEngineListener=syncEngineListener},SyncEngine.prototype.listen=function(query){return tslib_1.__awaiter(this,void 0,void 0,function(){var targetId,viewSnapshot,queryView,queryData,status_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.assertSubscribed('listen()'),queryView=this.queryViewsByQuery.get(query),!queryView)?[3,1]:(targetId=queryView.targetId,this.sharedClientState.addLocalQueryTarget(targetId),viewSnapshot=queryView.view.computeInitialSnapshot(),[3,4]);case 1:return[4,this.localStore.allocateQuery(query)];case 2:return queryData=_a.sent(),status_1=this.sharedClientState.addLocalQueryTarget(queryData.targetId),targetId=queryData.targetId,[4,this.initializeViewAndComputeSnapshot(queryData,'current'===status_1)];case 3:viewSnapshot=_a.sent(),this.isPrimary&&this.remoteStore.listen(queryData),_a.label=4;case 4:return this.syncEngineListener.onWatchChange([viewSnapshot]),[2,targetId];}})})},SyncEngine.prototype.initializeViewAndComputeSnapshot=function(queryData,current){var _this=this,query=queryData.query;return this.localStore.executeQuery(query).then(function(docs){return _this.localStore.remoteDocumentKeys(queryData.targetId).then(function(remoteKeys){var view=new View(query,remoteKeys),viewDocChanges=view.computeDocChanges(docs),synthesizedTargetChange=TargetChange.createSynthesizedTargetChangeForCurrentChange(queryData.targetId,current&&_this.onlineState!==OnlineState.Offline),viewChange=view.applyChanges(viewDocChanges,!0===_this.isPrimary,synthesizedTargetChange);assert(0===viewChange.limboChanges.length,'View returned limbo docs before target ack from the server.'),assert(!!viewChange.snapshot,'applyChanges for new view should always return a snapshot');var data=new QueryView(query,queryData.targetId,view);return _this.queryViewsByQuery.set(query,data),_this.queryViewsByTarget[queryData.targetId]=data,viewChange.snapshot})})},SyncEngine.prototype.synchronizeViewAndComputeSnapshot=function(queryView){var _this=this;return this.localStore.executeQuery(queryView.query).then(function(docs){return _this.localStore.remoteDocumentKeys(queryView.targetId).then(function(remoteKeys){return tslib_1.__awaiter(_this,void 0,void 0,function(){var viewSnapshot;return tslib_1.__generator(this,function(){return viewSnapshot=queryView.view.synchronizeWithPersistedState(docs,remoteKeys),this.isPrimary&&this.updateTrackedLimbos(queryView.targetId,viewSnapshot.limboChanges),[2,viewSnapshot]})})})})},SyncEngine.prototype.unlisten=function(query){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,queryView,targetRemainsActive;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.assertSubscribed('unlisten()'),queryView=this.queryViewsByQuery.get(query),assert(!!queryView,'Trying to unlisten on query not found:'+query),!this.isPrimary)?[3,3]:(this.sharedClientState.removeLocalQueryTarget(queryView.targetId),targetRemainsActive=this.sharedClientState.isActiveQueryTarget(queryView.targetId),targetRemainsActive?[3,2]:[4,this.localStore.releaseQuery(query,!1).then(function(){_this.sharedClientState.clearQueryState(queryView.targetId),_this.remoteStore.unlisten(queryView.targetId),_this.removeAndCleanupQuery(queryView)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})]);case 1:_a.sent(),_a.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(queryView),[4,this.localStore.releaseQuery(query,!0)];case 4:_a.sent(),_a.label=5;case 5:return[2];}})})},SyncEngine.prototype.write=function(batch,userCallback){var _this=this;return this.assertSubscribed('write()'),this.localStore.localWrite(batch).then(function(result){return _this.sharedClientState.addPendingMutation(result.batchId),_this.addMutationCallback(result.batchId,userCallback),_this.emitNewSnapsAndNotifyLocalStore(result.changes)}).then(function(){return _this.remoteStore.fillWritePipeline()})},SyncEngine.prototype.wrapUpdateFunctionError=function(error$$1){return error$$1},SyncEngine.prototype.runTransaction=function(updateFunction,retries){var _this=this;void 0===retries&&(retries=5),assert(0<=retries,'Got negative number of retries for transaction.');var transaction=this.remoteStore.createTransaction();return function(){try{var userPromise=updateFunction(transaction);return!isNullOrUndefined(userPromise)&&userPromise.catch&&userPromise.then?userPromise.catch(function(e){return Promise.reject(_this.wrapUpdateFunctionError(e))}):Promise.reject(Error('Transaction callback must return a Promise'))}catch(e){return Promise.reject(_this.wrapUpdateFunctionError(e))}}().then(function(result){return transaction.commit().then(function(){return result}).catch(function(error$$1){return 0===retries?Promise.reject(error$$1):_this.runTransaction(updateFunction,retries-1)})})},SyncEngine.prototype.applyRemoteEvent=function(remoteEvent){var _this=this;return this.assertSubscribed('applyRemoteEvent()'),this.localStore.applyRemoteEvent(remoteEvent).then(function(changes){return forEach(remoteEvent.targetChanges,function(targetId,targetChange){var limboResolution=_this.limboResolutionsByTarget[targetId];limboResolution&&(assert(1>=targetChange.addedDocuments.size+targetChange.modifiedDocuments.size+targetChange.removedDocuments.size,'Limbo resolution for single document contains multiple changes.'),0<targetChange.addedDocuments.size?limboResolution.receivedDocument=!0:0<targetChange.modifiedDocuments.size?assert(limboResolution.receivedDocument,'Received change for limbo target document without add.'):0<targetChange.removedDocuments.size&&(assert(limboResolution.receivedDocument,'Received remove for limbo target document without add.'),limboResolution.receivedDocument=!1))}),_this.emitNewSnapsAndNotifyLocalStore(changes,remoteEvent)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},SyncEngine.prototype.applyOnlineStateChange=function(onlineState,source){if(this.isPrimary&&source===OnlineStateSource.RemoteStore||!this.isPrimary&&source===OnlineStateSource.SharedClientState){var newViewSnapshots_1=[];this.queryViewsByQuery.forEach(function(query,queryView){var viewChange=queryView.view.applyOnlineStateChange(onlineState);assert(0===viewChange.limboChanges.length,'OnlineState should not affect limbo documents.'),viewChange.snapshot&&newViewSnapshots_1.push(viewChange.snapshot)}),this.syncEngineListener.onOnlineStateChange(onlineState),this.syncEngineListener.onWatchChange(newViewSnapshots_1),this.onlineState=onlineState,this.isPrimary&&this.sharedClientState.setOnlineState(onlineState)}},SyncEngine.prototype.rejectListen=function(targetId,err){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,limboResolution,limboKey,documentUpdates,resolvedLimboDocuments,event_1,queryView_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.assertSubscribed('rejectListens()'),this.sharedClientState.updateQueryState(targetId,'rejected',err),limboResolution=this.limboResolutionsByTarget[targetId],limboKey=limboResolution&&limboResolution.key,!limboKey)?[3,1]:(this.limboTargetsByKey=this.limboTargetsByKey.remove(limboKey),delete this.limboResolutionsByTarget[targetId],documentUpdates=new SortedMap(DocumentKey.comparator),documentUpdates=documentUpdates.insert(limboKey,new NoDocument(limboKey,SnapshotVersion.forDeletedDoc())),resolvedLimboDocuments=documentKeySet().add(limboKey),event_1=new RemoteEvent(SnapshotVersion.MIN,{},new SortedSet(primitiveComparator),documentUpdates,resolvedLimboDocuments),[2,this.applyRemoteEvent(event_1)]);case 1:return queryView_1=this.queryViewsByTarget[targetId],assert(!!queryView_1,'Unknown targetId: '+targetId),[4,this.localStore.releaseQuery(queryView_1.query,!1).then(function(){return _this.removeAndCleanupQuery(queryView_1)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})];case 2:_a.sent(),this.syncEngineListener.onWatchError(queryView_1.query,err),_a.label=3;case 3:return[2];}})})},SyncEngine.prototype.applyBatchState=function(batchId,batchState,error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var documents;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.assertSubscribed('applyBatchState()'),[4,this.localStore.lookupMutationDocuments(batchId)];case 1:return documents=_a.sent(),null===documents?(debug(LOG_TAG$9,'Cannot apply mutation batch with id: '+batchId),[2]):'pending'===batchState?[4,this.remoteStore.fillWritePipeline()]:[3,3];case 2:return _a.sent(),[3,4];case 3:'acknowledged'===batchState||'rejected'===batchState?(this.processUserCallback(batchId,error$$1?error$$1:null),this.localStore.removeCachedMutationBatchMetadata(batchId)):fail('Unknown batchState: '+batchState),_a.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(documents)];case 5:return _a.sent(),[2];}})})},SyncEngine.prototype.applySuccessfulWrite=function(mutationBatchResult){var _this=this;this.assertSubscribed('applySuccessfulWrite()');var batchId=mutationBatchResult.batch.batchId;return this.processUserCallback(batchId,null),this.localStore.acknowledgeBatch(mutationBatchResult).then(function(changes){return _this.sharedClientState.updateMutationState(batchId,'acknowledged'),_this.emitNewSnapsAndNotifyLocalStore(changes)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},SyncEngine.prototype.rejectFailedWrite=function(batchId,error$$1){var _this=this;return this.assertSubscribed('rejectFailedWrite()'),this.processUserCallback(batchId,error$$1),this.localStore.rejectBatch(batchId).then(function(changes){return _this.sharedClientState.updateMutationState(batchId,'rejected',error$$1),_this.emitNewSnapsAndNotifyLocalStore(changes)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},SyncEngine.prototype.addMutationCallback=function(batchId,callback){var newCallbacks=this.mutationUserCallbacks[this.currentUser.toKey()];newCallbacks||(newCallbacks=new SortedMap(primitiveComparator)),newCallbacks=newCallbacks.insert(batchId,callback),this.mutationUserCallbacks[this.currentUser.toKey()]=newCallbacks},SyncEngine.prototype.processUserCallback=function(batchId,error$$1){var newCallbacks=this.mutationUserCallbacks[this.currentUser.toKey()];if(newCallbacks){var callback=newCallbacks.get(batchId);callback&&(assert(batchId===newCallbacks.minKey(),'Mutation callbacks processed out-of-order?'),error$$1?callback.reject(error$$1):callback.resolve(),newCallbacks=newCallbacks.remove(batchId)),this.mutationUserCallbacks[this.currentUser.toKey()]=newCallbacks}},SyncEngine.prototype.removeAndCleanupQuery=function(queryView){var _this=this;if(this.sharedClientState.removeLocalQueryTarget(queryView.targetId),this.queryViewsByQuery.delete(queryView.query),delete this.queryViewsByTarget[queryView.targetId],this.isPrimary){var limboKeys=this.limboDocumentRefs.referencesForId(queryView.targetId);this.limboDocumentRefs.removeReferencesForId(queryView.targetId),limboKeys.forEach(function(limboKey){var isReferenced=_this.limboDocumentRefs.containsKey(limboKey);isReferenced||_this.removeLimboTarget(limboKey)})}},SyncEngine.prototype.removeLimboTarget=function(key){var limboTargetId=this.limboTargetsByKey.get(key);null===limboTargetId||(this.remoteStore.unlisten(limboTargetId),this.limboTargetsByKey=this.limboTargetsByKey.remove(key),delete this.limboResolutionsByTarget[limboTargetId])},SyncEngine.prototype.updateTrackedLimbos=function(targetId,limboChanges){for(var _i=0,limboChanges_1=limboChanges,limboChange;_i<limboChanges_1.length;_i++)if(limboChange=limboChanges_1[_i],limboChange instanceof AddedLimboDocument)this.limboDocumentRefs.addReference(limboChange.key,targetId),this.trackLimboChange(limboChange);else if(limboChange instanceof RemovedLimboDocument){debug(LOG_TAG$9,'Document no longer in limbo: '+limboChange.key),this.limboDocumentRefs.removeReference(limboChange.key,targetId);var isReferenced=this.limboDocumentRefs.containsKey(limboChange.key);isReferenced||this.removeLimboTarget(limboChange.key)}else fail('Unknown limbo change: '+JSON.stringify(limboChange))},SyncEngine.prototype.trackLimboChange=function(limboChange){var key=limboChange.key;if(!this.limboTargetsByKey.get(key)){debug(LOG_TAG$9,'New document in limbo: '+key);var limboTargetId=this.limboTargetIdGenerator.next(),query=Query.atPath(key.path);this.limboResolutionsByTarget[limboTargetId]=new LimboResolution(key),this.remoteStore.listen(new QueryData(query,limboTargetId,QueryPurpose.LimboResolution,ListenSequence.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(key,limboTargetId)}},SyncEngine.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},SyncEngine.prototype.emitNewSnapsAndNotifyLocalStore=function(changes,remoteEvent){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,newSnaps,docChangesInAllViews,queriesProcessed;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return newSnaps=[],docChangesInAllViews=[],queriesProcessed=[],this.queryViewsByQuery.forEach(function(_,queryView){queriesProcessed.push(Promise.resolve().then(function(){var viewDocChanges=queryView.view.computeDocChanges(changes);return viewDocChanges.needsRefill?_this.localStore.executeQuery(queryView.query).then(function(docs){return queryView.view.computeDocChanges(docs,viewDocChanges)}):viewDocChanges}).then(function(viewDocChanges){var targetChange=remoteEvent&&remoteEvent.targetChanges[queryView.targetId],viewChange=queryView.view.applyChanges(viewDocChanges,!0===_this.isPrimary,targetChange);if(_this.updateTrackedLimbos(queryView.targetId,viewChange.limboChanges),viewChange.snapshot){_this.isPrimary&&_this.sharedClientState.updateQueryState(queryView.targetId,viewChange.snapshot.fromCache?'not-current':'current'),newSnaps.push(viewChange.snapshot);var docChanges=LocalViewChanges.fromSnapshot(queryView.targetId,viewChange.snapshot);docChangesInAllViews.push(docChanges)}}))}),[4,Promise.all(queriesProcessed)];case 1:return _a.sent(),this.syncEngineListener.onWatchChange(newSnaps),[4,this.localStore.notifyLocalViewChanges(docChangesInAllViews)];case 2:return _a.sent(),[2];}})})},SyncEngine.prototype.ignoreIfPrimaryLeaseLoss=function(err){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){if(isPrimaryLeaseLostError(err))debug(LOG_TAG$9,'Unexpectedly lost primary lease');else throw err;return[2]})})},SyncEngine.prototype.assertSubscribed=function(fnName){assert(null!==this.syncEngineListener,'Trying to call '+fnName+' before calling subscribe().')},SyncEngine.prototype.handleCredentialChange=function(user){return tslib_1.__awaiter(this,void 0,void 0,function(){var userChanged,result;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return userChanged=!this.currentUser.isEqual(user),this.currentUser=user,userChanged?[4,this.localStore.handleUserChange(user)]:[3,3];case 1:return result=_a.sent(),this.sharedClientState.handleUserChange(user,result.removedBatchIds,result.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(result.affectedDocuments)];case 2:_a.sent(),_a.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return _a.sent(),[2];}})})},SyncEngine.prototype.applyPrimaryState=function(isPrimary){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,activeTargets,activeQueries,_i,activeQueries_1,queryData,activeTargets_1,p_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return!0!==isPrimary||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return _a.sent(),activeTargets=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(activeTargets.toArray())];case 2:for(activeQueries=_a.sent(),_i=0,activeQueries_1=activeQueries;_i<activeQueries_1.length;_i++)queryData=activeQueries_1[_i],this.remoteStore.listen(queryData);return[3,7];case 3:return!1!==isPrimary||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,activeTargets_1=[],p_1=Promise.resolve(),forEachNumber(this.queryViewsByTarget,function(targetId,queryView){_this.sharedClientState.isLocalQueryTarget(targetId)?activeTargets_1.push(targetId):p_1=p_1.then(function(){return _this.unlisten(queryView.query)}),_this.remoteStore.unlisten(queryView.targetId)}),[4,p_1]);case 4:return _a.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(activeTargets_1)];case 5:return _a.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:_a.sent(),_a.label=7;case 7:return[2];}})})},SyncEngine.prototype.resetLimboDocuments=function(){var _this=this;forEachNumber(this.limboResolutionsByTarget,function(targetId){_this.remoteStore.unlisten(targetId)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new SortedMap(DocumentKey.comparator)},SyncEngine.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(targets){for(var _this=this,p=Promise.resolve(),activeQueries=[],newViewSnapshots=[],_loop_1=function(targetId){p=p.then(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){var queryData,queryView,viewChange,query;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return queryView=this.queryViewsByTarget[targetId],queryView?[4,this.localStore.releaseQuery(queryView.query,!0)]:[3,4];case 1:return _a.sent(),[4,this.localStore.allocateQuery(queryView.query)];case 2:return queryData=_a.sent(),[4,this.synchronizeViewAndComputeSnapshot(queryView)];case 3:return viewChange=_a.sent(),viewChange.snapshot&&newViewSnapshots.push(viewChange.snapshot),[3,8];case 4:return assert(!0===this.isPrimary,'A secondary tab should never have an active query without an active view.'),[4,this.localStore.getQueryForTarget(targetId)];case 5:return query=_a.sent(),assert(!!query,'Query data for target '+targetId+' not found'),[4,this.localStore.allocateQuery(query)];case 6:return queryData=_a.sent(),[4,this.initializeViewAndComputeSnapshot(queryData,!1)];case 7:_a.sent(),_a.label=8;case 8:return activeQueries.push(queryData),[2];}})})})},_i=0,targets_1=targets,targetId;_i<targets_1.length;_i++)targetId=targets_1[_i],_loop_1(targetId);return p.then(function(){return _this.syncEngineListener.onWatchChange(newViewSnapshots),activeQueries})},SyncEngine.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},SyncEngine.prototype.applyTargetState=function(targetId,state,error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,_a,queryView;return tslib_1.__generator(this,function(_b){switch(_b.label){case 0:return this.isPrimary?(debug(LOG_TAG$9,'Ignoring unexpected query state notification.'),[2]):this.queryViewsByTarget[targetId]?(_a=state,'current'===_a?[3,1]:'not-current'===_a?[3,1]:'rejected'===_a?[3,2]:[3,4]):[3,5];case 1:return[2,this.localStore.getNewDocumentChanges().then(function(changes){return tslib_1.__awaiter(_this,void 0,void 0,function(){var synthesizedRemoteEvent;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return synthesizedRemoteEvent=RemoteEvent.createSynthesizedRemoteEventForCurrentChange(targetId,'current'===state),[4,this.emitNewSnapsAndNotifyLocalStore(changes,synthesizedRemoteEvent)];case 1:return _a.sent(),[2];}})})},function(err){return tslib_1.__awaiter(_this,void 0,void 0,function(){var activeTargets_2;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return isDocumentChangeMissingError(err)?(activeTargets_2=[],forEachNumber(this.queryViewsByTarget,function(target){return activeTargets_2.push(target)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(activeTargets_2)]):[3,2];case 1:return _a.sent(),[3,3];case 2:throw err;case 3:return[2];}})})})];_b.label=2;case 2:return queryView=this.queryViewsByTarget[targetId],this.removeAndCleanupQuery(queryView),[4,this.localStore.releaseQuery(queryView.query,!0)];case 3:return _b.sent(),this.syncEngineListener.onWatchError(queryView.query,error$$1),[3,5];case 4:fail('Unexpected target state: '+state),_b.label=5;case 5:return[2];}})})},SyncEngine.prototype.applyActiveTargetsChange=function(added,removed){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,_i,added_1,targetId,query,queryData,_loop_2,this_1,_a,removed_1,targetId;return tslib_1.__generator(this,function(_b){switch(_b.label){case 0:if(!this.isPrimary)return[2];_i=0,added_1=added,_b.label=1;case 1:return _i<added_1.length?(targetId=added_1[_i],assert(!this.queryViewsByTarget[targetId],'Trying to add an already active target'),[4,this.localStore.getQueryForTarget(targetId)]):[3,6];case 2:return query=_b.sent(),assert(!!query,'Query data for active target '+targetId+' not found'),[4,this.localStore.allocateQuery(query)];case 3:return queryData=_b.sent(),[4,this.initializeViewAndComputeSnapshot(queryData,!1)];case 4:_b.sent(),this.remoteStore.listen(queryData),_b.label=5;case 5:return _i++,[3,1];case 6:_loop_2=function(targetId){var queryView;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return queryView=this_1.queryViewsByTarget[targetId],queryView?[4,this_1.localStore.releaseQuery(queryView.query,!1).then(function(){_this.remoteStore.unlisten(targetId),_this.removeAndCleanupQuery(queryView)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2];}})},this_1=this,_a=0,removed_1=removed,_b.label=7;case 7:return _a<removed_1.length?(targetId=removed_1[_a],[5,_loop_2(targetId)]):[3,10];case 8:_b.sent(),_b.label=9;case 9:return _a++,[3,7];case 10:return[2];}})})},SyncEngine.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},SyncEngine.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},SyncEngine.prototype.getRemoteKeysForTarget=function(targetId){var limboResolution=this.limboResolutionsByTarget[targetId];return limboResolution&&limboResolution.receivedDocument?documentKeySet().add(limboResolution.key):this.queryViewsByTarget[targetId]?this.queryViewsByTarget[targetId].view.syncedDocuments:documentKeySet()},SyncEngine}(),User=function(){function User(uid){this.uid=uid}return User.prototype.isAuthenticated=function(){return null!=this.uid},User.prototype.toKey=function(){return this.isAuthenticated()?'uid:'+this.uid:'anonymous-user'},User.prototype.isEqual=function(otherUser){return otherUser.uid===this.uid},User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User('google-credentials-uid'),User.FIRST_PARTY=new User('first-party-uid'),User}(),LOG_TAG$10='SharedClientState',CLIENT_STATE_KEY_PREFIX='firestore_clients',MUTATION_BATCH_KEY_PREFIX='firestore_mutations',QUERY_TARGET_KEY_PREFIX='firestore_targets',MutationMetadata=function(){function MutationMetadata(user,batchId,state,error$$1){this.user=user,this.batchId=batchId,this.state=state,this.error=error$$1,assert(void 0!==error$$1==('rejected'===state),'MutationMetadata must contain an error iff state is \'rejected\'')}return MutationMetadata.fromWebStorageEntry=function(user,batchId,value){var mutationBatch=JSON.parse(value),validData='object'==typeof mutationBatch&&-1!==['pending','acknowledged','rejected'].indexOf(mutationBatch.state)&&(void 0===mutationBatch.error||'object'==typeof mutationBatch.error),firestoreError=void 0;return validData&&mutationBatch.error&&(validData='string'==typeof mutationBatch.error.message&&'string'==typeof mutationBatch.error.code,validData&&(firestoreError=new FirestoreError(mutationBatch.error.code,mutationBatch.error.message))),validData?new MutationMetadata(user,batchId,mutationBatch.state,firestoreError):(error(LOG_TAG$10,'Failed to parse mutation state for ID \''+batchId+'\': '+value),null)},MutationMetadata.prototype.toWebStorageJSON=function(){var batchMetadata={state:this.state,updateTimeMs:Date.now()};return this.error&&(batchMetadata.error={code:this.error.code,message:this.error.message}),JSON.stringify(batchMetadata)},MutationMetadata}(),QueryTargetMetadata=function(){function QueryTargetMetadata(targetId,state,error$$1){this.targetId=targetId,this.state=state,this.error=error$$1,assert(void 0!==error$$1==('rejected'===state),'QueryTargetMetadata must contain an error iff state is \'rejected\'')}return QueryTargetMetadata.fromWebStorageEntry=function(targetId,value){var targetState=JSON.parse(value),validData='object'==typeof targetState&&-1!==['not-current','current','rejected'].indexOf(targetState.state)&&(void 0===targetState.error||'object'==typeof targetState.error),firestoreError=void 0;return validData&&targetState.error&&(validData='string'==typeof targetState.error.message&&'string'==typeof targetState.error.code,validData&&(firestoreError=new FirestoreError(targetState.error.code,targetState.error.message))),validData?new QueryTargetMetadata(targetId,targetState.state,firestoreError):(error(LOG_TAG$10,'Failed to parse target state for ID \''+targetId+'\': '+value),null)},QueryTargetMetadata.prototype.toWebStorageJSON=function(){var targetState={state:this.state,updateTimeMs:Date.now()};return this.error&&(targetState.error={code:this.error.code,message:this.error.message}),JSON.stringify(targetState)},QueryTargetMetadata}(),RemoteClientState=function(){function RemoteClientState(clientId,activeTargetIds){this.clientId=clientId,this.activeTargetIds=activeTargetIds}return RemoteClientState.fromWebStorageEntry=function(clientId,value){for(var clientState=JSON.parse(value),validData='object'==typeof clientState&&clientState.activeTargetIds instanceof Array,activeTargetIdsSet=targetIdSet(),i=0;validData&&i<clientState.activeTargetIds.length;++i)validData=isSafeInteger(clientState.activeTargetIds[i]),activeTargetIdsSet=activeTargetIdsSet.add(clientState.activeTargetIds[i]);return validData?new RemoteClientState(clientId,activeTargetIdsSet):(error(LOG_TAG$10,'Failed to parse client data for instance \''+clientId+'\': '+value),null)},RemoteClientState}(),SharedOnlineState=function(){function SharedOnlineState(clientId,onlineState){this.clientId=clientId,this.onlineState=onlineState}return SharedOnlineState.fromWebStorageEntry=function(value){var onlineState=JSON.parse(value),validData='object'==typeof onlineState&&void 0!==OnlineState[onlineState.onlineState]&&'string'==typeof onlineState.clientId;return validData?new SharedOnlineState(onlineState.clientId,OnlineState[onlineState.onlineState]):(error(LOG_TAG$10,'Failed to parse online state: '+value),null)},SharedOnlineState}(),LocalClientState=function(){function LocalClientState(){this.activeTargetIds=targetIdSet()}return LocalClientState.prototype.addQueryTarget=function(targetId){assert(!this.activeTargetIds.has(targetId),'Target with ID \''+targetId+'\' already active.'),this.activeTargetIds=this.activeTargetIds.add(targetId)},LocalClientState.prototype.removeQueryTarget=function(targetId){this.activeTargetIds=this.activeTargetIds.delete(targetId)},LocalClientState.prototype.toWebStorageJSON=function(){var data={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(data)},LocalClientState}(),WebStorageSharedClientState=function(){function WebStorageSharedClientState(queue,platform,persistenceKey,localClientId,initialUser){if(this.queue=queue,this.platform=platform,this.persistenceKey=persistenceKey,this.localClientId=localClientId,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!WebStorageSharedClientState.isAvailable(this.platform))throw new FirestoreError(Code.UNIMPLEMENTED,'LocalStorage is not available on this platform.');var escapedPersistenceKey=persistenceKey.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');this.storage=this.platform.window.localStorage,this.currentUser=initialUser,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey='firestore_sequence_number'+'_'+persistenceKey,this.activeClients[this.localClientId]=new LocalClientState,this.clientStateKeyRe=new RegExp('^'+CLIENT_STATE_KEY_PREFIX+'_'+escapedPersistenceKey+'_([^_]*)$'),this.mutationBatchKeyRe=new RegExp('^'+MUTATION_BATCH_KEY_PREFIX+'_'+escapedPersistenceKey+'_(\\d+)(?:_(.*))?$'),this.queryTargetKeyRe=new RegExp('^'+QUERY_TARGET_KEY_PREFIX+'_'+escapedPersistenceKey+'_(\\d+)$'),this.onlineStateKey='firestore_online_state'+'_'+persistenceKey,this.platform.window.addEventListener('storage',this.storageListener)}return WebStorageSharedClientState.isAvailable=function(platform){return!!(platform.window&&null!=platform.window.localStorage)},WebStorageSharedClientState.prototype.start=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,existingClients,_i,existingClients_1,clientId,storageItem,clientState,onlineStateJSON,onlineState,_a,_b,event_1;return tslib_1.__generator(this,function(_c){switch(_c.label){case 0:return assert(!this.started,'WebStorageSharedClientState already started'),assert(null!==this.syncEngine,'syncEngine property must be set before calling start()'),assert(null!==this.onlineStateHandler,'onlineStateHandler property must be set before calling start()'),[4,this.syncEngine.getActiveClients()];case 1:for(existingClients=_c.sent(),_i=0,existingClients_1=existingClients;_i<existingClients_1.length;_i++)(clientId=existingClients_1[_i],clientId!==this.localClientId)&&(storageItem=this.getItem(this.toWebStorageClientStateKey(clientId)),storageItem&&(clientState=RemoteClientState.fromWebStorageEntry(clientId,storageItem),clientState&&(this.activeClients[clientState.clientId]=clientState)));for(this.persistClientState(),onlineStateJSON=this.storage.getItem(this.onlineStateKey),onlineStateJSON&&(onlineState=this.fromWebStorageOnlineState(onlineStateJSON),onlineState&&this.handleOnlineStateEvent(onlineState)),(_a=0,_b=this.earlyEvents);_a<_b.length;_a++)event_1=_b[_a],this.handleWebStorageEvent(event_1);return this.earlyEvents=[],this.platform.window.addEventListener('unload',function(){return _this.shutdown()}),this.started=!0,[2];}})})},WebStorageSharedClientState.prototype.writeSequenceNumber=function(sequenceNumber){this.setItem(this.sequenceNumberKey,JSON.stringify(sequenceNumber))},WebStorageSharedClientState.prototype.getAllActiveQueryTargets=function(){var activeTargets=targetIdSet();return forEach(this.activeClients,function(key,value){activeTargets=activeTargets.unionWith(value.activeTargetIds)}),activeTargets},WebStorageSharedClientState.prototype.isActiveQueryTarget=function(targetId){for(var clientId in this.activeClients)if(this.activeClients.hasOwnProperty(clientId)&&this.activeClients[clientId].activeTargetIds.has(targetId))return!0;return!1},WebStorageSharedClientState.prototype.addPendingMutation=function(batchId){this.persistMutationState(batchId,'pending')},WebStorageSharedClientState.prototype.updateMutationState=function(batchId,state,error$$1){this.persistMutationState(batchId,state,error$$1),this.removeMutationState(batchId)},WebStorageSharedClientState.prototype.addLocalQueryTarget=function(targetId){var queryState='not-current';if(this.isActiveQueryTarget(targetId)){var storageItem=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(targetId));if(storageItem){var metadata=QueryTargetMetadata.fromWebStorageEntry(targetId,storageItem);metadata&&(queryState=metadata.state)}}return this.localClientState.addQueryTarget(targetId),this.persistClientState(),queryState},WebStorageSharedClientState.prototype.removeLocalQueryTarget=function(targetId){this.localClientState.removeQueryTarget(targetId),this.persistClientState()},WebStorageSharedClientState.prototype.isLocalQueryTarget=function(targetId){return this.localClientState.activeTargetIds.has(targetId)},WebStorageSharedClientState.prototype.clearQueryState=function(targetId){this.removeItem(this.toWebStorageQueryTargetMetadataKey(targetId))},WebStorageSharedClientState.prototype.updateQueryState=function(targetId,state,error$$1){this.persistQueryTargetState(targetId,state,error$$1)},WebStorageSharedClientState.prototype.handleUserChange=function(user,removedBatchIds,addedBatchIds){var _this=this;removedBatchIds.forEach(function(batchId){_this.removeMutationState(batchId)}),this.currentUser=user,addedBatchIds.forEach(function(batchId){_this.addPendingMutation(batchId)})},WebStorageSharedClientState.prototype.setOnlineState=function(onlineState){this.persistOnlineState(onlineState)},WebStorageSharedClientState.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener('storage',this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},WebStorageSharedClientState.prototype.getItem=function(key){var value=this.storage.getItem(key);return debug(LOG_TAG$10,'READ',key,value),value},WebStorageSharedClientState.prototype.setItem=function(key,value){debug(LOG_TAG$10,'SET',key,value),this.storage.setItem(key,value)},WebStorageSharedClientState.prototype.removeItem=function(key){debug(LOG_TAG$10,'REMOVE',key),this.storage.removeItem(key)},WebStorageSharedClientState.prototype.handleWebStorageEvent=function(event){var _this=this;if(event.storageArea===this.storage){if(debug(LOG_TAG$10,'EVENT',event.key,event.newValue),event.key===this.localClientStorageKey)return void error('Received WebStorage notification for local change. Another client might have '+'garbage-collected our state');this.queue.enqueueAndForget(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){var clientState,clientId,mutationMetadata,queryTargetMetadata,onlineState,sequenceNumber;return tslib_1.__generator(this,function(){if(!this.started)return this.earlyEvents.push(event),[2];if(null===event.key)return[2];if(this.clientStateKeyRe.test(event.key)){if(null==event.newValue)return clientId=this.fromWebStorageClientStateKey(event.key),[2,this.handleClientStateEvent(clientId,null)];if(clientState=this.fromWebStorageClientState(event.key,event.newValue),clientState)return[2,this.handleClientStateEvent(clientState.clientId,clientState)]}else if(this.mutationBatchKeyRe.test(event.key)){if(null!==event.newValue&&(mutationMetadata=this.fromWebStorageMutationMetadata(event.key,event.newValue),mutationMetadata))return[2,this.handleMutationBatchEvent(mutationMetadata)];}else if(this.queryTargetKeyRe.test(event.key)){if(null!==event.newValue&&(queryTargetMetadata=this.fromWebStorageQueryTargetMetadata(event.key,event.newValue),queryTargetMetadata))return[2,this.handleQueryTargetEvent(queryTargetMetadata)];}else if(event.key!==this.onlineStateKey)event.key===this.sequenceNumberKey&&(assert(!!this.sequenceNumberHandler,'Missing sequenceNumberHandler'),sequenceNumber=fromWebStorageSequenceNumber(event.newValue),sequenceNumber!==ListenSequence.INVALID&&this.sequenceNumberHandler(sequenceNumber));else if(null!==event.newValue&&(onlineState=this.fromWebStorageOnlineState(event.newValue),onlineState))return[2,this.handleOnlineStateEvent(onlineState)];return[2]})})})}},Object.defineProperty(WebStorageSharedClientState.prototype,'localClientState',{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),WebStorageSharedClientState.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},WebStorageSharedClientState.prototype.persistMutationState=function(batchId,state,error$$1){var mutationState=new MutationMetadata(this.currentUser,batchId,state,error$$1),mutationKey=this.toWebStorageMutationBatchKey(batchId);this.setItem(mutationKey,mutationState.toWebStorageJSON())},WebStorageSharedClientState.prototype.removeMutationState=function(batchId){var mutationKey=this.toWebStorageMutationBatchKey(batchId);this.removeItem(mutationKey)},WebStorageSharedClientState.prototype.persistOnlineState=function(onlineState){var entry={clientId:this.localClientId,onlineState:OnlineState[onlineState]};this.storage.setItem(this.onlineStateKey,JSON.stringify(entry))},WebStorageSharedClientState.prototype.persistQueryTargetState=function(targetId,state,error$$1){var targetKey=this.toWebStorageQueryTargetMetadataKey(targetId),targetMetadata=new QueryTargetMetadata(targetId,state,error$$1);this.setItem(targetKey,targetMetadata.toWebStorageJSON())},WebStorageSharedClientState.prototype.toWebStorageClientStateKey=function(clientId){return assert(-1===clientId.indexOf('_'),'Client key cannot contain \'_\', but was \''+clientId+'\''),CLIENT_STATE_KEY_PREFIX+'_'+this.persistenceKey+'_'+clientId},WebStorageSharedClientState.prototype.toWebStorageQueryTargetMetadataKey=function(targetId){return QUERY_TARGET_KEY_PREFIX+'_'+this.persistenceKey+'_'+targetId},WebStorageSharedClientState.prototype.toWebStorageMutationBatchKey=function(batchId){var mutationKey=MUTATION_BATCH_KEY_PREFIX+'_'+this.persistenceKey+'_'+batchId;return this.currentUser.isAuthenticated()&&(mutationKey+='_'+this.currentUser.uid),mutationKey},WebStorageSharedClientState.prototype.fromWebStorageClientStateKey=function(key){var match=this.clientStateKeyRe.exec(key);return match?match[1]:null},WebStorageSharedClientState.prototype.fromWebStorageClientState=function(key,value){var clientId=this.fromWebStorageClientStateKey(key);return assert(null!==clientId,'Cannot parse client state key \''+key+'\''),RemoteClientState.fromWebStorageEntry(clientId,value)},WebStorageSharedClientState.prototype.fromWebStorageMutationMetadata=function(key,value){var match=this.mutationBatchKeyRe.exec(key);assert(null!==match,'Cannot parse mutation batch key \''+key+'\'');var batchId=+match[1],userId=void 0===match[2]?null:match[2];return MutationMetadata.fromWebStorageEntry(new User(userId),batchId,value)},WebStorageSharedClientState.prototype.fromWebStorageQueryTargetMetadata=function(key,value){var match=this.queryTargetKeyRe.exec(key);assert(null!==match,'Cannot parse query target key \''+key+'\'');var targetId=+match[1];return QueryTargetMetadata.fromWebStorageEntry(targetId,value)},WebStorageSharedClientState.prototype.fromWebStorageOnlineState=function(value){return SharedOnlineState.fromWebStorageEntry(value)},WebStorageSharedClientState.prototype.handleMutationBatchEvent=function(mutationBatch){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return mutationBatch.user.uid===this.currentUser.uid?[2,this.syncEngine.applyBatchState(mutationBatch.batchId,mutationBatch.state,mutationBatch.error)]:(debug(LOG_TAG$10,'Ignoring mutation for non-active user '+mutationBatch.user.uid),[2])})})},WebStorageSharedClientState.prototype.handleQueryTargetEvent=function(targetMetadata){return this.syncEngine.applyTargetState(targetMetadata.targetId,targetMetadata.state,targetMetadata.error)},WebStorageSharedClientState.prototype.handleClientStateEvent=function(clientId,clientState){var _this=this,existingTargets=this.getAllActiveQueryTargets();clientState?this.activeClients[clientId]=clientState:delete this.activeClients[clientId];var newTargets=this.getAllActiveQueryTargets(),addedTargets=[],removedTargets=[];return newTargets.forEach(function(targetId){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return existingTargets.has(targetId)||addedTargets.push(targetId),[2]})})}),existingTargets.forEach(function(targetId){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return newTargets.has(targetId)||removedTargets.push(targetId),[2]})})}),this.syncEngine.applyActiveTargetsChange(addedTargets,removedTargets)},WebStorageSharedClientState.prototype.handleOnlineStateEvent=function(onlineState){this.activeClients[onlineState.clientId]&&this.onlineStateHandler(onlineState.onlineState)},WebStorageSharedClientState}(),MemorySharedClientState=function(){function MemorySharedClientState(){this.localState=new LocalClientState,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return MemorySharedClientState.prototype.addPendingMutation=function(){},MemorySharedClientState.prototype.updateMutationState=function(){},MemorySharedClientState.prototype.addLocalQueryTarget=function(targetId){return this.localState.addQueryTarget(targetId),this.queryState[targetId]||'not-current'},MemorySharedClientState.prototype.updateQueryState=function(targetId,state){this.queryState[targetId]=state},MemorySharedClientState.prototype.removeLocalQueryTarget=function(targetId){this.localState.removeQueryTarget(targetId)},MemorySharedClientState.prototype.isLocalQueryTarget=function(targetId){return this.localState.activeTargetIds.has(targetId)},MemorySharedClientState.prototype.clearQueryState=function(targetId){delete this.queryState[targetId]},MemorySharedClientState.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},MemorySharedClientState.prototype.isActiveQueryTarget=function(targetId){return this.localState.activeTargetIds.has(targetId)},MemorySharedClientState.prototype.start=function(){return this.localState=new LocalClientState,Promise.resolve()},MemorySharedClientState.prototype.handleUserChange=function(){},MemorySharedClientState.prototype.setOnlineState=function(){},MemorySharedClientState.prototype.shutdown=function(){},MemorySharedClientState.prototype.writeSequenceNumber=function(){},MemorySharedClientState}(),LOG_TAG$11='FirestoreClient',FirestoreClient=function(){function FirestoreClient(platform,databaseInfo,credentials,asyncQueue){this.platform=platform,this.databaseInfo=databaseInfo,this.credentials=credentials,this.asyncQueue=asyncQueue,this.clientId=AutoId.newId()}return FirestoreClient.prototype.start=function(persistenceSettings){var _this=this,initializationDone=new Deferred$1,persistenceResult=new Deferred$1,initialized=!1;return this.credentials.setChangeListener(function(user){initialized?_this.asyncQueue.enqueueAndForget(function(){return _this.handleCredentialChange(user)}):(initialized=!0,_this.initializePersistence(persistenceSettings,persistenceResult,user).then(function(){return _this.initializeRest(user)}).then(initializationDone.resolve,initializationDone.reject))}),this.asyncQueue.enqueueAndForget(function(){return initializationDone.promise}),persistenceResult.promise},FirestoreClient.prototype.enableNetwork=function(){var _this=this;return this.asyncQueue.enqueue(function(){return _this.syncEngine.enableNetwork()})},FirestoreClient.prototype.initializePersistence=function(persistenceSettings,persistenceResult,user){var _this=this;return persistenceSettings.enabled?this.startIndexedDbPersistence(user,persistenceSettings).then(persistenceResult.resolve).catch(function(error$$1){return(persistenceResult.reject(error$$1),!_this.canFallback(error$$1))?Promise.reject(error$$1):(console.warn('Error enabling offline storage. Falling back to'+' storage disabled: '+error$$1),_this.startMemoryPersistence())}):(persistenceResult.resolve(),this.startMemoryPersistence())},FirestoreClient.prototype.canFallback=function(error$$1){return error$$1 instanceof FirestoreError?error$$1.code===Code.FAILED_PRECONDITION||error$$1.code===Code.UNIMPLEMENTED:'undefined'!=typeof DOMException&&error$$1 instanceof DOMException?error$$1.code===22||error$$1.code===20:!0},FirestoreClient.prototype.startIndexedDbPersistence=function(user,settings){var _this=this;assert(settings.enabled,'Should only start IndexedDb persitence with offline persistence enabled.');var storagePrefix=IndexedDbPersistence.buildStoragePrefix(this.databaseInfo),serializer=new JsonProtoSerializer(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){var _a,_b;return tslib_1.__generator(this,function(_c){switch(_c.label){case 0:if(settings.experimentalTabSynchronization&&!WebStorageSharedClientState.isAvailable(this.platform))throw new FirestoreError(Code.UNIMPLEMENTED,'IndexedDB persistence is only available on platforms that support LocalStorage.');return settings.experimentalTabSynchronization?(this.sharedClientState=new WebStorageSharedClientState(this.asyncQueue,this.platform,storagePrefix,this.clientId,user),_a=this,[4,IndexedDbPersistence.createMultiClientIndexedDbPersistence(storagePrefix,this.clientId,this.platform,this.asyncQueue,serializer,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return _a.persistence=_c.sent(),[3,4];case 2:return this.sharedClientState=new MemorySharedClientState,_b=this,[4,IndexedDbPersistence.createIndexedDbPersistence(storagePrefix,this.clientId,this.platform,this.asyncQueue,serializer)];case 3:_b.persistence=_c.sent(),_c.label=4;case 4:return[2];}})})})},FirestoreClient.prototype.startMemoryPersistence=function(){var serializer=new JsonProtoSerializer(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=MemoryPersistence.createEagerPersistence(this.clientId,serializer),this.sharedClientState=new MemorySharedClientState,Promise.resolve()},FirestoreClient.prototype.initializeRest=function(user){var _this=this;return debug(LOG_TAG$11,'Initializing. user=',user.uid),this.platform.loadConnection(this.databaseInfo).then(function(connection){return tslib_1.__awaiter(_this,void 0,void 0,function(){var _this=this,serializer,datastore,remoteStoreOnlineStateChangedHandler,sharedClientStateOnlineStateChangedHandler;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.localStore=new LocalStore(this.persistence,user),serializer=this.platform.newSerializer(this.databaseInfo.databaseId),datastore=new Datastore(this.asyncQueue,connection,this.credentials,serializer),remoteStoreOnlineStateChangedHandler=function(onlineState){return _this.syncEngine.applyOnlineStateChange(onlineState,OnlineStateSource.RemoteStore)},sharedClientStateOnlineStateChangedHandler=function(onlineState){return _this.syncEngine.applyOnlineStateChange(onlineState,OnlineStateSource.SharedClientState)},this.remoteStore=new RemoteStore(this.localStore,datastore,this.asyncQueue,remoteStoreOnlineStateChangedHandler),this.syncEngine=new SyncEngine(this.localStore,this.remoteStore,this.sharedClientState,user),this.sharedClientState.onlineStateHandler=sharedClientStateOnlineStateChangedHandler,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new EventManager(this.syncEngine),[4,this.sharedClientState.start()];case 1:return _a.sent(),[4,this.remoteStore.start()];case 2:return _a.sent(),[4,this.persistence.setPrimaryStateListener(function(isPrimary){return _this.syncEngine.applyPrimaryState(isPrimary)})];case 3:return _a.sent(),[2];}})})})},FirestoreClient.prototype.handleCredentialChange=function(user){return this.asyncQueue.verifyOperationInProgress(),debug(LOG_TAG$11,'Credential Changed. Current user: '+user.uid),this.syncEngine.handleCredentialChange(user)},FirestoreClient.prototype.disableNetwork=function(){var _this=this;return this.asyncQueue.enqueue(function(){return _this.syncEngine.disableNetwork()})},FirestoreClient.prototype.shutdown=function(options){var _this=this;return this.asyncQueue.enqueue(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return[4,this.remoteStore.shutdown()];case 1:return _a.sent(),[4,this.sharedClientState.shutdown()];case 2:return _a.sent(),[4,this.persistence.shutdown(options&&options.purgePersistenceWithDataLoss)];case 3:return _a.sent(),this.credentials.removeChangeListener(),[2];}})})})},FirestoreClient.prototype.listen=function(query,observer,options){var _this=this,listener=new QueryListener(query,observer,options);return this.asyncQueue.enqueueAndForget(function(){return _this.eventMgr.listen(listener)}),listener},FirestoreClient.prototype.unlisten=function(listener){var _this=this;this.asyncQueue.enqueueAndForget(function(){return _this.eventMgr.unlisten(listener)})},FirestoreClient.prototype.getDocumentFromLocalCache=function(docKey){var _this=this;return this.asyncQueue.enqueue(function(){return _this.localStore.readDocument(docKey)}).then(function(maybeDoc){if(maybeDoc instanceof Document)return maybeDoc;if(maybeDoc instanceof NoDocument)return null;throw new FirestoreError(Code.UNAVAILABLE,'Failed to get document from cache. (However, this document may '+'exist on the server. Run again without setting \'source\' in '+'the GetOptions to attempt to retrieve the document from the '+'server.)')})},FirestoreClient.prototype.getDocumentsFromLocalCache=function(query){var _this=this;return this.asyncQueue.enqueue(function(){return _this.localStore.executeQuery(query)}).then(function(docs){var remoteKeys=documentKeySet(),view=new View(query,remoteKeys),viewDocChanges=view.computeDocChanges(docs);return view.applyChanges(viewDocChanges,!1).snapshot})},FirestoreClient.prototype.write=function(mutations){var _this=this,deferred=new Deferred$1;return this.asyncQueue.enqueueAndForget(function(){return _this.syncEngine.write(mutations,deferred)}),deferred.promise},FirestoreClient.prototype.databaseId=function(){return this.databaseInfo.databaseId},FirestoreClient.prototype.transaction=function(updateFunction){var _this=this;return this.asyncQueue.enqueue(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return[2]})})}).then(function(){return _this.syncEngine.runTransaction(updateFunction)})},FirestoreClient}(),AsyncObserver=function(){function AsyncObserver(observer){this.observer=observer,this.muted=!1}return AsyncObserver.prototype.next=function(value){this.scheduleEvent(this.observer.next,value)},AsyncObserver.prototype.error=function(error){this.scheduleEvent(this.observer.error,error)},AsyncObserver.prototype.mute=function(){this.muted=!0},AsyncObserver.prototype.scheduleEvent=function(eventHandler,event){var _this=this;this.muted||setTimeout(function(){_this.muted||eventHandler(event)},0)},AsyncObserver}(),FieldPath$1=function(){function FieldPath$$1(){for(var fieldNames=[],_i=0;_i<arguments.length;_i++)fieldNames[_i]=arguments[_i];validateNamedArrayAtLeastNumberOfElements('FieldPath',fieldNames,'fieldNames',1);for(var i=0;i<fieldNames.length;++i)if(validateArgType('FieldPath','string',i,fieldNames[i]),0===fieldNames[i].length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field name at argument $(i + 1). '+'Field names must not be empty.');this._internalPath=new FieldPath(fieldNames)}return FieldPath$$1.documentId=function(){return FieldPath$$1._DOCUMENT_ID},FieldPath$$1.prototype.isEqual=function(other){if(!(other instanceof FieldPath$$1))throw invalidClassError('isEqual','FieldPath',1,other);return this._internalPath.isEqual(other._internalPath)},FieldPath$$1._DOCUMENT_ID=new FieldPath$$1(FieldPath.keyField().canonicalString()),FieldPath$$1}(),RESERVED=/[~\*\/\[\]]/,OAuthToken=function(){return function OAuthToken(value,user){this.user=user,this.type='OAuth',this.authHeaders={Authorization:'Bearer '+value}}}(),EmptyCredentialsProvider=function(){function EmptyCredentialsProvider(){this.changeListener=null}return EmptyCredentialsProvider.prototype.getToken=function(){return Promise.resolve(null)},EmptyCredentialsProvider.prototype.invalidateToken=function(){},EmptyCredentialsProvider.prototype.setChangeListener=function(changeListener){assert(!this.changeListener,'Can only call setChangeListener() once.'),this.changeListener=changeListener,changeListener(User.UNAUTHENTICATED)},EmptyCredentialsProvider.prototype.removeChangeListener=function(){assert(null!==this.changeListener,'removeChangeListener() when no listener registered'),this.changeListener=null},EmptyCredentialsProvider}(),FirebaseCredentialsProvider=function(){function FirebaseCredentialsProvider(app){var _this=this;this.app=app,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){_this.tokenCounter++,_this.currentUser=_this.getUser(),_this.changeListener&&_this.changeListener(_this.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return FirebaseCredentialsProvider.prototype.getToken=function(){var _this=this;assert(null!=this.tokenListener,'getToken cannot be called after listener removed.');var initialTokenCounter=this.tokenCounter,forceRefresh=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(forceRefresh).then(function(tokenData){if(_this.tokenCounter!==initialTokenCounter)throw new FirestoreError(Code.ABORTED,'getToken aborted due to token change.');else return tokenData?(assert('string'==typeof tokenData.accessToken,'Invalid tokenData returned from getToken():'+tokenData),new OAuthToken(tokenData.accessToken,_this.currentUser)):null})},FirebaseCredentialsProvider.prototype.invalidateToken=function(){this.forceRefresh=!0},FirebaseCredentialsProvider.prototype.setChangeListener=function(changeListener){assert(!this.changeListener,'Can only call setChangeListener() once.'),this.changeListener=changeListener,this.currentUser&&changeListener(this.currentUser)},FirebaseCredentialsProvider.prototype.removeChangeListener=function(){assert(null!=this.tokenListener,'removeChangeListener() called twice'),assert(null!==this.changeListener,'removeChangeListener() called when no listener registered'),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},FirebaseCredentialsProvider.prototype.getUser=function(){var currentUid=this.app.INTERNAL.getUid();return assert(null===currentUid||'string'==typeof currentUid,'Received invalid UID: '+currentUid),new User(currentUid)},FirebaseCredentialsProvider}(),FirstPartyToken=function(){function FirstPartyToken(gapi,sessionIndex){this.gapi=gapi,this.sessionIndex=sessionIndex,this.type='FirstParty',this.user=User.FIRST_PARTY,assert(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,'unexpected gapi interface')}return Object.defineProperty(FirstPartyToken.prototype,'authHeaders',{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),FirstPartyToken}(),FirstPartyCredentialsProvider=function(){function FirstPartyCredentialsProvider(gapi,sessionIndex){this.gapi=gapi,this.sessionIndex=sessionIndex,assert(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,'unexpected gapi interface')}return FirstPartyCredentialsProvider.prototype.getToken=function(){return Promise.resolve(new FirstPartyToken(this.gapi,this.sessionIndex))},FirstPartyCredentialsProvider.prototype.setChangeListener=function(changeListener){changeListener(User.FIRST_PARTY)},FirstPartyCredentialsProvider.prototype.removeChangeListener=function(){},FirstPartyCredentialsProvider.prototype.invalidateToken=function(){},FirstPartyCredentialsProvider}(),FieldValueImpl=function(){function FieldValueImpl(_methodName){this._methodName=_methodName}return FieldValueImpl.delete=function(){return DeleteFieldValueImpl.instance},FieldValueImpl.serverTimestamp=function(){return ServerTimestampFieldValueImpl.instance},FieldValueImpl.arrayUnion=function(){for(var elements=[],_i=0;_i<arguments.length;_i++)elements[_i]=arguments[_i];return validateAtLeastNumberOfArgs('FieldValue.arrayUnion',arguments,1),new ArrayUnionFieldValueImpl(elements)},FieldValueImpl.arrayRemove=function(){for(var elements=[],_i=0;_i<arguments.length;_i++)elements[_i]=arguments[_i];return validateAtLeastNumberOfArgs('FieldValue.arrayRemove',arguments,1),new ArrayRemoveFieldValueImpl(elements)},FieldValueImpl.prototype.isEqual=function(other){return this===other},FieldValueImpl}(),DeleteFieldValueImpl=function(_super){function DeleteFieldValueImpl(){return _super.call(this,'FieldValue.delete')||this}return tslib_1.__extends(DeleteFieldValueImpl,_super),DeleteFieldValueImpl.instance=new DeleteFieldValueImpl,DeleteFieldValueImpl}(FieldValueImpl),ServerTimestampFieldValueImpl=function(_super){function ServerTimestampFieldValueImpl(){return _super.call(this,'FieldValue.serverTimestamp')||this}return tslib_1.__extends(ServerTimestampFieldValueImpl,_super),ServerTimestampFieldValueImpl.instance=new ServerTimestampFieldValueImpl,ServerTimestampFieldValueImpl}(FieldValueImpl),ArrayUnionFieldValueImpl=function(_super){function ArrayUnionFieldValueImpl(_elements){var _this=_super.call(this,'FieldValue.arrayUnion')||this;return _this._elements=_elements,_this}return tslib_1.__extends(ArrayUnionFieldValueImpl,_super),ArrayUnionFieldValueImpl}(FieldValueImpl),ArrayRemoveFieldValueImpl=function(_super){function ArrayRemoveFieldValueImpl(_elements){var _this=_super.call(this,'FieldValue.arrayRemove')||this;return _this._elements=_elements,_this}return tslib_1.__extends(ArrayRemoveFieldValueImpl,_super),ArrayRemoveFieldValueImpl}(FieldValueImpl),PublicFieldValue=makeConstructorPrivate(FieldValueImpl,'Use FieldValue.<field>() instead.'),RESERVED_FIELD_REGEX=/^__.*__$/,ParsedSetData=function(){function ParsedSetData(data,fieldMask,fieldTransforms){this.data=data,this.fieldMask=fieldMask,this.fieldTransforms=fieldTransforms}return ParsedSetData.prototype.toMutations=function(key,precondition){var mutations=[];return null===this.fieldMask?mutations.push(new SetMutation(key,this.data,precondition)):mutations.push(new PatchMutation(key,this.data,this.fieldMask,precondition)),0<this.fieldTransforms.length&&mutations.push(new TransformMutation(key,this.fieldTransforms)),mutations},ParsedSetData}(),ParsedUpdateData=function(){function ParsedUpdateData(data,fieldMask,fieldTransforms){this.data=data,this.fieldMask=fieldMask,this.fieldTransforms=fieldTransforms}return ParsedUpdateData.prototype.toMutations=function(key,precondition){var mutations=[new PatchMutation(key,this.data,this.fieldMask,precondition)];return 0<this.fieldTransforms.length&&mutations.push(new TransformMutation(key,this.fieldTransforms)),mutations},ParsedUpdateData}(),UserDataSource;(function(UserDataSource){UserDataSource[UserDataSource.Set=0]='Set',UserDataSource[UserDataSource.Update=1]='Update',UserDataSource[UserDataSource.MergeSet=2]='MergeSet',UserDataSource[UserDataSource.Argument=3]='Argument'})(UserDataSource||(UserDataSource={}));var ParseContext=function(){function ParseContext(dataSource,methodName,path,arrayElement,fieldTransforms,fieldMask){this.dataSource=dataSource,this.methodName=methodName,this.path=path,this.arrayElement=arrayElement,void 0===fieldTransforms&&this.validatePath(),this.arrayElement=void 0!==arrayElement&&arrayElement,this.fieldTransforms=fieldTransforms||[],this.fieldMask=fieldMask||[]}return ParseContext.prototype.childContextForField=function(field){var childPath=null==this.path?null:this.path.child(field),context=new ParseContext(this.dataSource,this.methodName,childPath,!1,this.fieldTransforms,this.fieldMask);return context.validatePathSegment(field),context},ParseContext.prototype.childContextForFieldPath=function(field){var childPath=null==this.path?null:this.path.child(field),context=new ParseContext(this.dataSource,this.methodName,childPath,!1,this.fieldTransforms,this.fieldMask);return context.validatePath(),context},ParseContext.prototype.childContextForArray=function(){return new ParseContext(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},ParseContext.prototype.createError=function(reason){var fieldDescription=null===this.path||this.path.isEmpty()?'':' (found in field '+this.path.toString()+')';return new FirestoreError(Code.INVALID_ARGUMENT,'Function '+this.methodName+'() called with invalid data. '+reason+fieldDescription)},ParseContext.prototype.contains=function(fieldPath){return void 0!==this.fieldMask.find(function(field){return fieldPath.isPrefixOf(field)})||void 0!==this.fieldTransforms.find(function(transform){return fieldPath.isPrefixOf(transform.field)})},ParseContext.prototype.validatePath=function(){if(null!==this.path)for(var i=0;i<this.path.length;i++)this.validatePathSegment(this.path.get(i))},ParseContext.prototype.validatePathSegment=function(segment){if(isWrite(this.dataSource)&&RESERVED_FIELD_REGEX.test(segment))throw this.createError('Document fields cannot begin and end with __')},ParseContext}(),DocumentKeyReference=function(){return function DocumentKeyReference(databaseId,key){this.databaseId=databaseId,this.key=key}}(),UserDataConverter=function(){function UserDataConverter(preConverter){this.preConverter=preConverter}return UserDataConverter.prototype.parseSetData=function(methodName,input){var context=new ParseContext(UserDataSource.Set,methodName,FieldPath.EMPTY_PATH);validatePlainObject('Data must be an object, but it was:',context,input);var updateData=this.parseData(input,context);return new ParsedSetData(updateData,null,context.fieldTransforms)},UserDataConverter.prototype.parseMergeData=function(methodName,input,fieldPaths){var context=new ParseContext(UserDataSource.MergeSet,methodName,FieldPath.EMPTY_PATH);validatePlainObject('Data must be an object, but it was:',context,input);var updateData=this.parseData(input,context),fieldMask,fieldTransforms;if(!fieldPaths)fieldMask=new FieldMask(context.fieldMask),fieldTransforms=context.fieldTransforms;else{for(var validatedFieldPaths=[],_i=0,fieldPaths_1=fieldPaths;_i<fieldPaths_1.length;_i++){var stringOrFieldPath=fieldPaths_1[_i],fieldPath=void 0;if(stringOrFieldPath instanceof FieldPath$1)fieldPath=stringOrFieldPath._internalPath;else if('string'==typeof stringOrFieldPath)fieldPath=fieldPathFromDotSeparatedString(methodName,stringOrFieldPath);else throw fail('Expected stringOrFieldPath to be a string or a FieldPath');if(!context.contains(fieldPath))throw new FirestoreError(Code.INVALID_ARGUMENT,'Field \''+fieldPath+'\' is specified in your field mask but missing from your input data.');validatedFieldPaths.push(fieldPath)}fieldMask=new FieldMask(validatedFieldPaths),fieldTransforms=context.fieldTransforms.filter(function(transform){return fieldMask.covers(transform.field)})}return new ParsedSetData(updateData,fieldMask,fieldTransforms)},UserDataConverter.prototype.parseUpdateData=function(methodName,input){var _this=this,context=new ParseContext(UserDataSource.Update,methodName,FieldPath.EMPTY_PATH);validatePlainObject('Data must be an object, but it was:',context,input);var fieldMaskPaths=[],updateData=ObjectValue.EMPTY;forEach(input,function(key,value){var path=fieldPathFromDotSeparatedString(methodName,key),childContext=context.childContextForFieldPath(path);if(value=_this.runPreConverter(value,childContext),value instanceof DeleteFieldValueImpl)fieldMaskPaths.push(path);else{var parsedValue=_this.parseData(value,childContext);null!=parsedValue&&(fieldMaskPaths.push(path),updateData=updateData.set(path,parsedValue))}});var mask=new FieldMask(fieldMaskPaths);return new ParsedUpdateData(updateData,mask,context.fieldTransforms)},UserDataConverter.prototype.parseUpdateVarargs=function(methodName,field,value,moreFieldsAndValues){var context=new ParseContext(UserDataSource.Update,methodName,FieldPath.EMPTY_PATH),keys=[fieldPathFromArgument(methodName,field)],values$$1=[value];if(0!=moreFieldsAndValues.length%2)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+methodName+'() needs to be called with an even number '+'of arguments that alternate between field names and values.');for(var i=0;i<moreFieldsAndValues.length;i+=2)keys.push(fieldPathFromArgument(methodName,moreFieldsAndValues[i])),values$$1.push(moreFieldsAndValues[i+1]);for(var fieldMaskPaths=[],updateData=ObjectValue.EMPTY,i=0;i<keys.length;++i){var path=keys[i],childContext=context.childContextForFieldPath(path),value_1=this.runPreConverter(values$$1[i],childContext);if(value_1 instanceof DeleteFieldValueImpl)fieldMaskPaths.push(path);else{var parsedValue=this.parseData(value_1,childContext);null!=parsedValue&&(fieldMaskPaths.push(path),updateData=updateData.set(path,parsedValue))}}var mask=new FieldMask(fieldMaskPaths);return new ParsedUpdateData(updateData,mask,context.fieldTransforms)},UserDataConverter.prototype.parseQueryValue=function(methodName,input){var context=new ParseContext(UserDataSource.Argument,methodName,FieldPath.EMPTY_PATH),parsed=this.parseData(input,context);return assert(null!=parsed,'Parsed data should not be null.'),assert(0===context.fieldTransforms.length,'Field transforms should have been disallowed.'),parsed},UserDataConverter.prototype.runPreConverter=function(input,context){try{return this.preConverter(input)}catch(e){var message=errorMessage(e);throw context.createError(message)}},UserDataConverter.prototype.parseData=function(input,context){if(input=this.runPreConverter(input,context),looksLikeJsonObject(input))return validatePlainObject('Unsupported field value:',context,input),this.parseObject(input,context);if(input instanceof FieldValueImpl)return this.parseSentinelFieldValue(input,context),null;if(context.path&&context.fieldMask.push(context.path),input instanceof Array){if(context.arrayElement)throw context.createError('Nested arrays are not supported');return this.parseArray(input,context)}return this.parseScalarValue(input,context)},UserDataConverter.prototype.parseObject=function(obj,context){var _this=this,result=new SortedMap(primitiveComparator);return isEmpty(obj)?context.path&&0<context.path.length&&context.fieldMask.push(context.path):forEach(obj,function(key,val){var parsedValue=_this.parseData(val,context.childContextForField(key));null!=parsedValue&&(result=result.insert(key,parsedValue))}),new ObjectValue(result)},UserDataConverter.prototype.parseArray=function(array,context){for(var result=[],entryIndex=0,_i=0,array_1=array;_i<array_1.length;_i++){var entry=array_1[_i],parsedEntry=this.parseData(entry,context.childContextForArray(entryIndex));null==parsedEntry&&(parsedEntry=NullValue.INSTANCE),result.push(parsedEntry),entryIndex++}return new ArrayValue(result)},UserDataConverter.prototype.parseSentinelFieldValue=function(value,context){if(!isWrite(context.dataSource))throw context.createError(value._methodName+'() can only be used with update() and set()');if(null===context.path)throw context.createError(value._methodName+'() is not currently supported inside arrays');if(value instanceof DeleteFieldValueImpl){if(context.dataSource===UserDataSource.MergeSet)context.fieldMask.push(context.path);else if(context.dataSource===UserDataSource.Update)throw assert(0<context.path.length,'FieldValue.delete() at the top level should have already'+' been handled.'),context.createError('FieldValue.delete() can only appear at the top level '+'of your update data');else throw context.createError('FieldValue.delete() cannot be used with set() unless you pass '+'{merge:true}');}else if(value instanceof ServerTimestampFieldValueImpl)context.fieldTransforms.push(new FieldTransform(context.path,ServerTimestampTransform.instance));else if(value instanceof ArrayUnionFieldValueImpl){var parsedElements=this.parseArrayTransformElements(value._methodName,value._elements),arrayUnion=new ArrayUnionTransformOperation(parsedElements);context.fieldTransforms.push(new FieldTransform(context.path,arrayUnion))}else if(value instanceof ArrayRemoveFieldValueImpl){var parsedElements=this.parseArrayTransformElements(value._methodName,value._elements),arrayRemove=new ArrayRemoveTransformOperation(parsedElements);context.fieldTransforms.push(new FieldTransform(context.path,arrayRemove))}else fail('Unknown FieldValue type: '+value)},UserDataConverter.prototype.parseScalarValue=function(value,context){if(null===value)return NullValue.INSTANCE;if('number'==typeof value)return isSafeInteger(value)?new IntegerValue(value):new DoubleValue(value);if('boolean'==typeof value)return BooleanValue.of(value);if('string'==typeof value)return new StringValue(value);if(value instanceof Date)return new TimestampValue(Timestamp.fromDate(value));if(value instanceof Timestamp)return new TimestampValue(new Timestamp(value.seconds,1e3*_Mathfloor(value.nanoseconds/1e3)));if(value instanceof GeoPoint)return new GeoPointValue(value);if(value instanceof Blob)return new BlobValue(value);if(value instanceof DocumentKeyReference)return new RefValue(value.databaseId,value.key);throw context.createError('Unsupported field value: '+valueDescription(value))},UserDataConverter.prototype.parseArrayTransformElements=function(methodName,elements){var _this=this;return elements.map(function(element,i){var context=new ParseContext(UserDataSource.Argument,methodName,FieldPath.EMPTY_PATH);return _this.parseData(element,context.childContextForArray(i))})},UserDataConverter}(),DEFAULT_SSL=!0,FirestoreSettings=function(){function FirestoreSettings(settings){if(void 0===settings.host){if(void 0!==settings.ssl)throw new FirestoreError(Code.INVALID_ARGUMENT,'Can\'t provide ssl option if host option is not set');this.host='firestore.googleapis.com',this.ssl=DEFAULT_SSL}else validateNamedType('settings','non-empty string','host',settings.host),this.host=settings.host,validateNamedOptionalType('settings','boolean','ssl',settings.ssl),this.ssl=defaulted(settings.ssl,DEFAULT_SSL);validateOptionNames('settings',settings,['host','ssl','credentials','timestampsInSnapshots']),validateNamedOptionalType('settings','object','credentials',settings.credentials),this.credentials=settings.credentials,validateNamedOptionalType('settings','boolean','timestampsInSnapshots',settings.timestampsInSnapshots),this.timestampsInSnapshots=defaulted(settings.timestampsInSnapshots,!1)}return FirestoreSettings.prototype.isEqual=function(other){return this.host===other.host&&this.ssl===other.ssl&&this.timestampsInSnapshots===other.timestampsInSnapshots&&this.credentials===other.credentials},FirestoreSettings}(),FirestoreConfig=function(){return function FirestoreConfig(){}}(),PersistenceSettings=function(){function PersistenceSettings(enabled,settings){this.enabled=enabled,assert(enabled||!settings,'Can only provide PersistenceSettings with persistence enabled'),settings=settings||{},this.experimentalTabSynchronization=defaulted(settings.experimentalTabSynchronization,!1)}return PersistenceSettings.prototype.isEqual=function(other){return this.enabled===other.enabled&&this.experimentalTabSynchronization===other.experimentalTabSynchronization},PersistenceSettings}(),Firestore=function(){function Firestore(databaseIdOrApp){var _this=this;this._queue=new AsyncQueue,this.INTERNAL={delete:function(options){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this._firestoreClient?[2,this._firestoreClient.shutdown(options)]:[2]})})}};var config=new FirestoreConfig;if('object'==typeof databaseIdOrApp.options){var app=databaseIdOrApp;config.firebaseApp=app,config.databaseId=Firestore.databaseIdFromApp(app),config.persistenceKey=config.firebaseApp.name,config.credentials=new FirebaseCredentialsProvider(app)}else{var external_1=databaseIdOrApp;if(!external_1.projectId)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide projectId');config.databaseId=new DatabaseId(external_1.projectId,external_1.database),config.persistenceKey='[DEFAULT]',config.credentials=new EmptyCredentialsProvider}config.settings=new FirestoreSettings({}),this._config=config,this._databaseId=config.databaseId}return Firestore.prototype.settings=function(settingsLiteral){if(validateExactNumberOfArgs('Firestore.settings',arguments,1),validateArgType('Firestore.settings','object',1,settingsLiteral),contains(settingsLiteral,'persistence'))throw new FirestoreError(Code.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to '+'firestore.enablePersistence().');var newSettings=new FirestoreSettings(settingsLiteral);if(this._firestoreClient&&!this._config.settings.isEqual(newSettings))throw new FirestoreError(Code.FAILED_PRECONDITION,'Firestore has already been started and its settings can no longer '+'be changed. You can only call settings() before calling any other '+'methods on a Firestore object.');this._config.settings=newSettings,void 0!==newSettings.credentials&&(this._config.credentials=makeCredentialsProvider(newSettings.credentials))},Firestore.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},Firestore.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},Firestore.prototype.enablePersistence=function(settings){if(this._firestoreClient)throw new FirestoreError(Code.FAILED_PRECONDITION,'Firestore has already been started and persistence can no longer '+'be enabled. You can only call enablePersistence() before calling '+'any other methods on a Firestore object.');return this.configureClient(new PersistenceSettings(!0,settings))},Firestore.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new PersistenceSettings(!1)),this._firestoreClient},Firestore.prototype.configureClient=function(persistenceSettings){var _this=this;assert(!!this._config.settings.host,'FirestoreSettings.host cannot be falsey'),this._config.settings.timestampsInSnapshots||error('\nThe behavior for Date objects stored in Firestore is going to change\nAND YOUR APP MAY BREAK.\nTo hide this warning and ensure your app does not break, you need to add the\nfollowing code to your app before calling any other Cloud Firestore methods:\n\n  const firestore = firebase.firestore();\n  const settings = {/* your settings... */ timestampsInSnapshots: true};\n  firestore.settings(settings);\n\nWith this change, timestamps stored in Cloud Firestore will be read back as\nFirebase Timestamp objects instead of as system Date objects. So you will also\nneed to update code expecting a Date to instead expect a Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get(\'created_at\');\n  // New:\n  const timestamp = snapshot.get(\'created_at\');\n  const date = timestamp.toDate();\n\nPlease audit all existing usages of Date when you enable the new behavior. In a\nfuture release, the behavior will change to the new behavior, so if you do not\nfollow these steps, YOUR APP MAY BREAK.'),assert(!this._firestoreClient,'configureClient() called multiple times');var databaseInfo=new DatabaseInfo(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl);return this._dataConverter=new UserDataConverter(function(value){if(value instanceof DocumentReference){var thisDb=_this._config.databaseId,otherDb=value.firestore._config.databaseId;if(!otherDb.isEqual(thisDb))throw new FirestoreError(Code.INVALID_ARGUMENT,'Document reference is for database '+(otherDb.projectId+'/'+otherDb.database+' but should be ')+('for database '+thisDb.projectId+'/'+thisDb.database));return new DocumentKeyReference(_this._config.databaseId,value._key)}return value}),this._firestoreClient=new FirestoreClient(PlatformSupport.getPlatform(),databaseInfo,this._config.credentials,this._queue),this._firestoreClient.start(persistenceSettings)},Firestore.databaseIdFromApp=function(app){var options=app.options;if(!contains(options,'projectId'))throw new FirestoreError(Code.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var projectId=options.projectId;if(!projectId||'string'!=typeof projectId)throw new FirestoreError(Code.INVALID_ARGUMENT,'projectId must be a string in FirebaseApp.options');return new DatabaseId(projectId)},Object.defineProperty(Firestore.prototype,'app',{get:function(){if(!this._config.firebaseApp)throw new FirestoreError(Code.FAILED_PRECONDITION,'Firestore was not initialized using the Firebase SDK. \'app\' is '+'not available');return this._config.firebaseApp},enumerable:!0,configurable:!0}),Firestore.prototype.collection=function(pathString){if(validateExactNumberOfArgs('Firestore.collection',arguments,1),validateArgType('Firestore.collection','non-empty string',1,pathString),!pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide a non-empty collection path to collection()');return this.ensureClientConfigured(),new CollectionReference(ResourcePath.fromString(pathString),this)},Firestore.prototype.doc=function(pathString){if(validateExactNumberOfArgs('Firestore.doc',arguments,1),validateArgType('Firestore.doc','non-empty string',1,pathString),!pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide a non-empty document path to doc()');return this.ensureClientConfigured(),DocumentReference.forPath(ResourcePath.fromString(pathString),this)},Firestore.prototype.runTransaction=function(updateFunction){var _this=this;return validateExactNumberOfArgs('Firestore.runTransaction',arguments,1),validateArgType('Firestore.runTransaction','function',1,updateFunction),this.ensureClientConfigured().transaction(function(transaction){return updateFunction(new Transaction$1(_this,transaction))})},Firestore.prototype.batch=function(){return this.ensureClientConfigured(),new WriteBatch(this)},Object.defineProperty(Firestore,'logLevel',{get:function(){switch(getLogLevel()){case LogLevel.DEBUG:return'debug';case LogLevel.ERROR:return'error';case LogLevel.SILENT:return'silent';default:return fail('Unknown log level: '+getLogLevel());}},enumerable:!0,configurable:!0}),Firestore.setLogLevel=function(level){switch(validateExactNumberOfArgs('Firestore.setLogLevel',arguments,1),validateArgType('Firestore.setLogLevel','non-empty string',1,level),level){case'debug':setLogLevel(LogLevel.DEBUG);break;case'error':setLogLevel(LogLevel.ERROR);break;case'silent':setLogLevel(LogLevel.SILENT);break;default:throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid log level: '+level);}},Firestore.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},Firestore}(),Transaction$1=function(){function Transaction(_firestore,_transaction){this._firestore=_firestore,this._transaction=_transaction}return Transaction.prototype.get=function(documentRef){var _this=this;validateExactNumberOfArgs('Transaction.get',arguments,1);var ref=validateReference('Transaction.get',documentRef,this._firestore);return this._transaction.lookup([ref._key]).then(function(docs){if(!docs||1!==docs.length)return fail('Mismatch in docs returned from document lookup.');var doc=docs[0];if(doc instanceof NoDocument)return new DocumentSnapshot(_this._firestore,ref._key,null,!1,!1);if(doc instanceof Document)return new DocumentSnapshot(_this._firestore,ref._key,doc,!1,!1);throw fail('BatchGetDocumentsRequest returned unexpected document type: '+doc.constructor.name)})},Transaction.prototype.set=function(documentRef,value,options){validateBetweenNumberOfArgs('Transaction.set',arguments,2,3);var ref=validateReference('Transaction.set',documentRef,this._firestore);options=validateSetOptions('Transaction.set',options);var parsed=options.merge||options.mergeFields?this._firestore._dataConverter.parseMergeData('Transaction.set',value,options.mergeFields):this._firestore._dataConverter.parseSetData('Transaction.set',value);return this._transaction.set(ref._key,parsed),this},Transaction.prototype.update=function(documentRef,fieldOrUpdateData,value){for(var moreFieldsAndValues=[],_i=3;_i<arguments.length;_i++)moreFieldsAndValues[_i-3]=arguments[_i];var ref,parsed;return'string'==typeof fieldOrUpdateData||fieldOrUpdateData instanceof FieldPath$1?(validateAtLeastNumberOfArgs('Transaction.update',arguments,3),ref=validateReference('Transaction.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateVarargs('Transaction.update',fieldOrUpdateData,value,moreFieldsAndValues)):(validateExactNumberOfArgs('Transaction.update',arguments,2),ref=validateReference('Transaction.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateData('Transaction.update',fieldOrUpdateData)),this._transaction.update(ref._key,parsed),this},Transaction.prototype.delete=function(documentRef){validateExactNumberOfArgs('Transaction.delete',arguments,1);var ref=validateReference('Transaction.delete',documentRef,this._firestore);return this._transaction.delete(ref._key),this},Transaction}(),WriteBatch=function(){function WriteBatch(_firestore){this._firestore=_firestore,this._mutations=[],this._committed=!1}return WriteBatch.prototype.set=function(documentRef,value,options){validateBetweenNumberOfArgs('WriteBatch.set',arguments,2,3),this.verifyNotCommitted();var ref=validateReference('WriteBatch.set',documentRef,this._firestore);options=validateSetOptions('WriteBatch.set',options);var parsed=options.merge||options.mergeFields?this._firestore._dataConverter.parseMergeData('WriteBatch.set',value,options.mergeFields):this._firestore._dataConverter.parseSetData('WriteBatch.set',value);return this._mutations=this._mutations.concat(parsed.toMutations(ref._key,Precondition.NONE)),this},WriteBatch.prototype.update=function(documentRef,fieldOrUpdateData,value){for(var moreFieldsAndValues=[],_i=3;_i<arguments.length;_i++)moreFieldsAndValues[_i-3]=arguments[_i];this.verifyNotCommitted();var ref,parsed;return'string'==typeof fieldOrUpdateData||fieldOrUpdateData instanceof FieldPath$1?(validateAtLeastNumberOfArgs('WriteBatch.update',arguments,3),ref=validateReference('WriteBatch.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateVarargs('WriteBatch.update',fieldOrUpdateData,value,moreFieldsAndValues)):(validateExactNumberOfArgs('WriteBatch.update',arguments,2),ref=validateReference('WriteBatch.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateData('WriteBatch.update',fieldOrUpdateData)),this._mutations=this._mutations.concat(parsed.toMutations(ref._key,Precondition.exists(!0))),this},WriteBatch.prototype.delete=function(documentRef){validateExactNumberOfArgs('WriteBatch.delete',arguments,1),this.verifyNotCommitted();var ref=validateReference('WriteBatch.delete',documentRef,this._firestore);return this._mutations=this._mutations.concat(new DeleteMutation(ref._key,Precondition.NONE)),this},WriteBatch.prototype.commit=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.verifyNotCommitted(),this._committed=!0,0<this._mutations.length?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},WriteBatch.prototype.verifyNotCommitted=function(){if(this._committed)throw new FirestoreError(Code.FAILED_PRECONDITION,'A write batch can no longer be used after commit() '+'has been called.')},WriteBatch}(),DocumentReference=function(){function DocumentReference(_key,firestore){this._key=_key,this.firestore=firestore,this._firestoreClient=this.firestore.ensureClientConfigured()}return DocumentReference.forPath=function(path,firestore){if(0!=path.length%2)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid document reference. Document '+'references must have an even number of segments, but '+(path.canonicalString()+' has '+path.length));return new DocumentReference(new DocumentKey(path),firestore)},Object.defineProperty(DocumentReference.prototype,'id',{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentReference.prototype,'parent',{get:function(){return new CollectionReference(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentReference.prototype,'path',{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),DocumentReference.prototype.collection=function(pathString){if(validateExactNumberOfArgs('DocumentReference.collection',arguments,1),validateArgType('DocumentReference.collection','non-empty string',1,pathString),!pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide a non-empty collection name to collection()');var path=ResourcePath.fromString(pathString);return new CollectionReference(this._key.path.child(path),this.firestore)},DocumentReference.prototype.isEqual=function(other){if(!(other instanceof DocumentReference))throw invalidClassError('isEqual','DocumentReference',1,other);return this.firestore===other.firestore&&this._key.isEqual(other._key)},DocumentReference.prototype.set=function(value,options){validateBetweenNumberOfArgs('DocumentReference.set',arguments,1,2),options=validateSetOptions('DocumentReference.set',options);var parsed=options.merge||options.mergeFields?this.firestore._dataConverter.parseMergeData('DocumentReference.set',value,options.mergeFields):this.firestore._dataConverter.parseSetData('DocumentReference.set',value);return this._firestoreClient.write(parsed.toMutations(this._key,Precondition.NONE))},DocumentReference.prototype.update=function(fieldOrUpdateData,value){for(var moreFieldsAndValues=[],_i=2;_i<arguments.length;_i++)moreFieldsAndValues[_i-2]=arguments[_i];var parsed;return'string'==typeof fieldOrUpdateData||fieldOrUpdateData instanceof FieldPath$1?(validateAtLeastNumberOfArgs('DocumentReference.update',arguments,2),parsed=this.firestore._dataConverter.parseUpdateVarargs('DocumentReference.update',fieldOrUpdateData,value,moreFieldsAndValues)):(validateExactNumberOfArgs('DocumentReference.update',arguments,1),parsed=this.firestore._dataConverter.parseUpdateData('DocumentReference.update',fieldOrUpdateData)),this._firestoreClient.write(parsed.toMutations(this._key,Precondition.exists(!0)))},DocumentReference.prototype.delete=function(){return validateExactNumberOfArgs('DocumentReference.delete',arguments,0),this._firestoreClient.write([new DeleteMutation(this._key,Precondition.NONE)])},DocumentReference.prototype.onSnapshot=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];validateBetweenNumberOfArgs('DocumentReference.onSnapshot',arguments,1,4);var options={includeMetadataChanges:!1},currArg=0,observer;'object'!=typeof args[currArg]||isPartialObserver(args[currArg])||(options=args[currArg],validateOptionNames('DocumentReference.onSnapshot',options,['includeMetadataChanges']),validateNamedOptionalType('DocumentReference.onSnapshot','boolean','includeMetadataChanges',options.includeMetadataChanges),currArg++);var internalOptions={includeMetadataChanges:options.includeMetadataChanges};return isPartialObserver(args[currArg])?observer=args[currArg]:(validateArgType('DocumentReference.onSnapshot','function',currArg,args[currArg]),validateOptionalArgType('DocumentReference.onSnapshot','function',currArg+1,args[currArg+1]),validateOptionalArgType('DocumentReference.onSnapshot','function',currArg+2,args[currArg+2]),observer={next:args[currArg],error:args[currArg+1],complete:args[currArg+2]}),this.onSnapshotInternal(internalOptions,observer)},DocumentReference.prototype.onSnapshotInternal=function(options,observer){var _this=this,errHandler=function(err){console.error('Uncaught Error in onSnapshot:',err)};observer.error&&(errHandler=observer.error.bind(observer));var asyncObserver=new AsyncObserver({next:function(snapshot){if(observer.next){assert(1>=snapshot.docs.size,'Too many documents returned on a document query');var doc=snapshot.docs.get(_this._key);observer.next(new DocumentSnapshot(_this.firestore,_this._key,doc,snapshot.fromCache,snapshot.hasPendingWrites))}},error:errHandler}),internalListener=this._firestoreClient.listen(Query.atPath(this._key.path),asyncObserver,options);return function(){asyncObserver.mute(),_this._firestoreClient.unlisten(internalListener)}},DocumentReference.prototype.get=function(options){var _this=this;return validateBetweenNumberOfArgs('DocumentReference.get',arguments,0,1),validateGetOptions('DocumentReference.get',options),new Promise(function(resolve,reject){options&&'cache'===options.source?_this.firestore.ensureClientConfigured().getDocumentFromLocalCache(_this._key).then(function(doc){resolve(new DocumentSnapshot(_this.firestore,_this._key,doc,!0,!!(doc instanceof Document)&&doc.hasLocalMutations))},reject):_this.getViaSnapshotListener(resolve,reject,options)})},DocumentReference.prototype.getViaSnapshotListener=function(resolve,reject,options){var unlisten=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(snap){unlisten(),!snap.exists&&snap.metadata.fromCache?reject(new FirestoreError(Code.UNAVAILABLE,'Failed to get document because the client is '+'offline.')):snap.exists&&snap.metadata.fromCache&&options&&'server'===options.source?reject(new FirestoreError(Code.UNAVAILABLE,'Failed to get document from server. (However, this '+'document does exist in the local cache. Run again '+'without setting source to "server" to '+'retrieve the cached document.)')):resolve(snap)},error:reject})},DocumentReference}(),SnapshotMetadata=function(){function SnapshotMetadata(hasPendingWrites,fromCache){this.hasPendingWrites=hasPendingWrites,this.fromCache=fromCache}return SnapshotMetadata.prototype.isEqual=function(other){return this.hasPendingWrites===other.hasPendingWrites&&this.fromCache===other.fromCache},SnapshotMetadata}(),DocumentSnapshot=function(){function DocumentSnapshot(_firestore,_key,_document,_fromCache,_hasPendingWrites){this._firestore=_firestore,this._key=_key,this._document=_document,this._fromCache=_fromCache,this._hasPendingWrites=_hasPendingWrites}return DocumentSnapshot.prototype.data=function(options){return validateBetweenNumberOfArgs('DocumentSnapshot.data',arguments,0,1),options=validateSnapshotOptions('DocumentSnapshot.data',options),this._document?this.convertObject(this._document.data,FieldValueOptions.fromSnapshotOptions(options,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},DocumentSnapshot.prototype.get=function(fieldPath,options){if(validateBetweenNumberOfArgs('DocumentSnapshot.get',arguments,1,2),options=validateSnapshotOptions('DocumentSnapshot.get',options),this._document){var value=this._document.data.field(fieldPathFromArgument('DocumentSnapshot.get',fieldPath));if(void 0!==value)return this.convertValue(value,FieldValueOptions.fromSnapshotOptions(options,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(DocumentSnapshot.prototype,'id',{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentSnapshot.prototype,'ref',{get:function(){return new DocumentReference(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentSnapshot.prototype,'exists',{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentSnapshot.prototype,'metadata',{get:function(){return new SnapshotMetadata(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),DocumentSnapshot.prototype.isEqual=function(other){if(!(other instanceof DocumentSnapshot))throw invalidClassError('isEqual','DocumentSnapshot',1,other);return this._firestore===other._firestore&&this._fromCache===other._fromCache&&this._key.isEqual(other._key)&&(null===this._document?null===other._document:this._document.isEqual(other._document))},DocumentSnapshot.prototype.convertObject=function(data,options){var _this=this,result={};return data.forEach(function(key,value){result[key]=_this.convertValue(value,options)}),result},DocumentSnapshot.prototype.convertValue=function(value,options){if(value instanceof ObjectValue)return this.convertObject(value,options);if(value instanceof ArrayValue)return this.convertArray(value,options);if(value instanceof RefValue){var key=value.value(options),database=this._firestore.ensureClientConfigured().databaseId();return value.databaseId.isEqual(database)||error('Document '+this._key.path+' contains a document '+'reference within a different database ('+(value.databaseId.projectId+'/'+value.databaseId.database+') which is not ')+'supported. It will be treated as a reference in the current '+('database ('+database.projectId+'/'+database.database+') ')+'instead.'),new DocumentReference(key,this._firestore)}return value.value(options)},DocumentSnapshot.prototype.convertArray=function(data,options){var _this=this;return data.internalValue.map(function(value){return _this.convertValue(value,options)})},DocumentSnapshot}(),QueryDocumentSnapshot=function(_super){function QueryDocumentSnapshot(firestore,key,document,fromCache,hasPendingWrites){return _super.call(this,firestore,key,document,fromCache,hasPendingWrites)||this}return tslib_1.__extends(QueryDocumentSnapshot,_super),QueryDocumentSnapshot.prototype.data=function(options){var data=_super.prototype.data.call(this,options);return assert('object'==typeof data,'Document in a QueryDocumentSnapshot should exist'),data},QueryDocumentSnapshot}(DocumentSnapshot),Query$1=function(){function Query$$1(_query,firestore){this._query=_query,this.firestore=firestore}return Query$$1.prototype.where=function(field,opStr,value){validateExactNumberOfArgs('Query.where',arguments,3),validateArgType('Query.where','non-empty string',2,opStr),validateDefined('Query.where',3,value);var fieldPath=fieldPathFromArgument('Query.where',field),relationOp=RelationOp.fromString(opStr),fieldValue;if(fieldPath.isKeyField()){if(relationOp===RelationOp.ARRAY_CONTAINS)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid Query. You can\'t perform array-contains queries on '+'FieldPath.documentId() since document IDs are not arrays.');if('string'==typeof value){if(-1!==value.indexOf('/'))throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.where() requires its third parameter to be a '+'valid document ID if the first parameter is '+'FieldPath.documentId(), but it contains a slash.');if(''===value)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.where() requires its third parameter to be a '+'valid document ID if the first parameter is '+'FieldPath.documentId(), but it was an empty string.');var path=this._query.path.child(new ResourcePath([value]));assert(0==path.length%2,'Path should be a document key'),fieldValue=new RefValue(this.firestore._databaseId,new DocumentKey(path))}else if(value instanceof DocumentReference){fieldValue=new RefValue(this.firestore._databaseId,value._key)}else throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.where() requires its third parameter to be a '+'string or a DocumentReference if the first parameter is '+'FieldPath.documentId(), but it was: '+(valueDescription(value)+'.'))}else fieldValue=this.firestore._dataConverter.parseQueryValue('Query.where',value);var filter=Filter.create(fieldPath,relationOp,fieldValue);return this.validateNewFilter(filter),new Query$$1(this._query.addFilter(filter),this.firestore)},Query$$1.prototype.orderBy=function(field,directionStr){validateBetweenNumberOfArgs('Query.orderBy',arguments,1,2),validateOptionalArgType('Query.orderBy','non-empty string',2,directionStr);var direction;if(void 0===directionStr||'asc'===directionStr)direction=Direction.ASCENDING;else if('desc'===directionStr)direction=Direction.DESCENDING;else throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.orderBy() has unknown direction \''+directionStr+'\', '+'expected \'asc\' or \'desc\'.');if(null!==this._query.startAt)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You must not call Query.startAt() or '+'Query.startAfter() before calling Query.orderBy().');if(null!==this._query.endAt)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You must not call Query.endAt() or '+'Query.endBefore() before calling Query.orderBy().');var fieldPath=fieldPathFromArgument('Query.orderBy',field),orderBy=new OrderBy(fieldPath,direction);return this.validateNewOrderBy(orderBy),new Query$$1(this._query.addOrderBy(orderBy),this.firestore)},Query$$1.prototype.limit=function(n){if(validateExactNumberOfArgs('Query.limit',arguments,1),validateArgType('Query.limit','number',1,n),0>=n)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid Query. Query limit ('+n+') is invalid. Limit must be '+'positive.');return new Query$$1(this._query.withLimit(n),this.firestore)},Query$$1.prototype.startAt=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.startAt',arguments,1);var bound=this.boundFromDocOrFields('Query.startAt',docOrField,fields,!0);return new Query$$1(this._query.withStartAt(bound),this.firestore)},Query$$1.prototype.startAfter=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.startAfter',arguments,1);var bound=this.boundFromDocOrFields('Query.startAfter',docOrField,fields,!1);return new Query$$1(this._query.withStartAt(bound),this.firestore)},Query$$1.prototype.endBefore=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.endBefore',arguments,1);var bound=this.boundFromDocOrFields('Query.endBefore',docOrField,fields,!0);return new Query$$1(this._query.withEndAt(bound),this.firestore)},Query$$1.prototype.endAt=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.endAt',arguments,1);var bound=this.boundFromDocOrFields('Query.endAt',docOrField,fields,!1);return new Query$$1(this._query.withEndAt(bound),this.firestore)},Query$$1.prototype.isEqual=function(other){if(!(other instanceof Query$$1))throw invalidClassError('isEqual','Query',1,other);return this.firestore===other.firestore&&this._query.isEqual(other._query)},Query$$1.prototype.boundFromDocOrFields=function(methodName,docOrField,fields,before){if(validateDefined(methodName,1,docOrField),docOrField instanceof DocumentSnapshot){if(0<fields.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Too many arguments provided to '+methodName+'().');var snap=docOrField;if(!snap.exists)throw new FirestoreError(Code.NOT_FOUND,'Can\'t use a DocumentSnapshot that doesn\'t exist for '+(methodName+'().'));return this.boundFromDocument(methodName,snap._document,before)}var allFields=[docOrField].concat(fields);return this.boundFromFields(methodName,allFields,before)},Query$$1.prototype.boundFromDocument=function(methodName,doc,before){for(var components=[],_i=0,_a=this._query.orderBy,orderBy;_i<_a.length;_i++)if(orderBy=_a[_i],orderBy.field.isKeyField())components.push(new RefValue(this.firestore._databaseId,doc.key));else{var value=doc.field(orderBy.field);if(void 0!==value)components.push(value);else{var field=orderBy.field.canonicalString();throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a '+('document for which the field \''+field+'\' (used as the ')+'orderBy) does not exist.')}}return new Bound(components,before)},Query$$1.prototype.boundFromFields=function(methodName,values$$1,before){var orderBy=this._query.explicitOrderBy;if(values$$1.length>orderBy.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Too many arguments provided to '+methodName+'(). '+'The number of arguments must be less than or equal to the '+'number of Query.orderBy() clauses');for(var components=[],i=0;i<values$$1.length;i++){var rawValue=values$$1[i],orderByComponent=orderBy[i];if(orderByComponent.field.isKeyField()){if('string'!=typeof rawValue)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. Expected a string for document ID in '+(methodName+'(), but got a '+typeof rawValue));if(-1!==rawValue.indexOf('/'))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. Document ID \''+rawValue+'\' contains a slash in '+(methodName+'()'));var key=new DocumentKey(this._query.path.child(rawValue));components.push(new RefValue(this.firestore._databaseId,key))}else{var wrapped=this.firestore._dataConverter.parseQueryValue(methodName,rawValue);components.push(wrapped)}}return new Bound(components,before)},Query$$1.prototype.onSnapshot=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];validateBetweenNumberOfArgs('Query.onSnapshot',arguments,1,4);var options={},currArg=0,observer;return'object'!=typeof args[currArg]||isPartialObserver(args[currArg])||(options=args[currArg],validateOptionNames('Query.onSnapshot',options,['includeMetadataChanges']),validateNamedOptionalType('Query.onSnapshot','boolean','includeMetadataChanges',options.includeMetadataChanges),currArg++),isPartialObserver(args[currArg])?observer=args[currArg]:(validateArgType('Query.onSnapshot','function',currArg,args[currArg]),validateOptionalArgType('Query.onSnapshot','function',currArg+1,args[currArg+1]),validateOptionalArgType('Query.onSnapshot','function',currArg+2,args[currArg+2]),observer={next:args[currArg],error:args[currArg+1],complete:args[currArg+2]}),this.onSnapshotInternal(options,observer)},Query$$1.prototype.onSnapshotInternal=function(options,observer){var _this=this,errHandler=function(err){console.error('Uncaught Error in onSnapshot:',err)};observer.error&&(errHandler=observer.error.bind(observer));var asyncObserver=new AsyncObserver({next:function(result){observer.next&&observer.next(new QuerySnapshot(_this.firestore,_this._query,result))},error:errHandler}),firestoreClient=this.firestore.ensureClientConfigured(),internalListener=firestoreClient.listen(this._query,asyncObserver,options);return function(){asyncObserver.mute(),firestoreClient.unlisten(internalListener)}},Query$$1.prototype.get=function(options){var _this=this;return validateBetweenNumberOfArgs('Query.get',arguments,0,1),validateGetOptions('Query.get',options),new Promise(function(resolve,reject){options&&'cache'===options.source?_this.firestore.ensureClientConfigured().getDocumentsFromLocalCache(_this._query).then(function(viewSnap){resolve(new QuerySnapshot(_this.firestore,_this._query,viewSnap))},reject):_this.getViaSnapshotListener(resolve,reject,options)})},Query$$1.prototype.getViaSnapshotListener=function(resolve,reject,options){var unlisten=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(result){unlisten(),result.metadata.fromCache&&options&&'server'===options.source?reject(new FirestoreError(Code.UNAVAILABLE,'Failed to get documents from server. (However, these '+'documents may exist in the local cache. Run again '+'without setting source to "server" to '+'retrieve the cached documents.)')):resolve(result)},error:reject})},Query$$1.prototype.validateNewFilter=function(filter){if(filter instanceof RelationFilter)if(filter.isInequality()){var existingField=this._query.getInequalityFilterField();if(null!==existingField&&!existingField.isEqual(filter.field))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. All where filters with an inequality'+' (<, <=, >, or >=) must be on the same field. But you have'+(' inequality filters on \''+existingField.toString()+'\'')+(' and \''+filter.field.toString()+'\''));var firstOrderByField=this._query.getFirstOrderByField();null!==firstOrderByField&&this.validateOrderByAndInequalityMatch(filter.field,firstOrderByField)}else if(filter.op===RelationOp.ARRAY_CONTAINS&&this._query.hasArrayContainsFilter())throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. Queries only support a single array-contains '+'filter.')},Query$$1.prototype.validateNewOrderBy=function(orderBy){if(null===this._query.getFirstOrderByField()){var inequalityField=this._query.getInequalityFilterField();null!==inequalityField&&this.validateOrderByAndInequalityMatch(inequalityField,orderBy.field)}},Query$$1.prototype.validateOrderByAndInequalityMatch=function(inequality,orderBy){if(!orderBy.isEqual(inequality))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You have a where filter with an inequality '+('(<, <=, >, or >=) on field \''+inequality.toString()+'\' ')+('and so you must also use \''+inequality.toString()+'\' ')+'as your first Query.orderBy(), but your first Query.orderBy() '+('is on field \''+orderBy.toString()+'\' instead.'))},Query$$1}(),QuerySnapshot=function(){function QuerySnapshot(_firestore,_originalQuery,_snapshot){this._firestore=_firestore,this._originalQuery=_originalQuery,this._snapshot=_snapshot,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new SnapshotMetadata(_snapshot.hasPendingWrites,_snapshot.fromCache)}return Object.defineProperty(QuerySnapshot.prototype,'docs',{get:function(){var result=[];return this.forEach(function(doc){return result.push(doc)}),result},enumerable:!0,configurable:!0}),Object.defineProperty(QuerySnapshot.prototype,'empty',{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(QuerySnapshot.prototype,'size',{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),QuerySnapshot.prototype.forEach=function(callback,thisArg){var _this=this;validateBetweenNumberOfArgs('QuerySnapshot.forEach',arguments,1,2),validateArgType('QuerySnapshot.forEach','function',1,callback),this._snapshot.docs.forEach(function(doc){callback.call(thisArg,_this.convertToDocumentImpl(doc))})},Object.defineProperty(QuerySnapshot.prototype,'query',{get:function(){return new Query$1(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),QuerySnapshot.prototype.docChanges=function(options){options&&(validateOptionNames('QuerySnapshot.docChanges',options,['includeMetadataChanges']),validateNamedOptionalType('QuerySnapshot.docChanges','boolean','includeMetadataChanges',options.includeMetadataChanges));var includeMetadataChanges=!!(options&&options.includeMetadataChanges);if(includeMetadataChanges&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(Code.INVALID_ARGUMENT,'To include metadata changes with your document changes, you must '+'also pass { includeMetadataChanges:true } to onSnapshot().');return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===includeMetadataChanges||(this._cachedChanges=changesFromSnapshot(this._firestore,includeMetadataChanges,this._snapshot),this._cachedChangesIncludeMetadataChanges=includeMetadataChanges),this._cachedChanges},QuerySnapshot.prototype.isEqual=function(other){if(!(other instanceof QuerySnapshot))throw invalidClassError('isEqual','QuerySnapshot',1,other);return this._firestore===other._firestore&&this._originalQuery.isEqual(other._originalQuery)&&this._snapshot.isEqual(other._snapshot)},QuerySnapshot.prototype.convertToDocumentImpl=function(doc){return new QueryDocumentSnapshot(this._firestore,doc.key,doc,this.metadata.fromCache,this._snapshot.mutatedKeys.has(doc.key))},QuerySnapshot}(),docChangesPropertiesToOverride=['length','forEach','map'].concat('undefined'==typeof Symbol?[]:[Symbol.iterator]);docChangesPropertiesToOverride.forEach(function(property){try{Object.defineProperty(QuerySnapshot.prototype.docChanges,property,{get:function(){return throwDocChangesMethodError()}})}catch(err){}});var CollectionReference=function(_super){function CollectionReference(path,firestore){var _this=_super.call(this,Query.atPath(path),firestore)||this;if(1!=path.length%2)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid collection reference. Collection '+'references must have an odd number of segments, but '+(path.canonicalString()+' has '+path.length));return _this}return tslib_1.__extends(CollectionReference,_super),Object.defineProperty(CollectionReference.prototype,'id',{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(CollectionReference.prototype,'parent',{get:function(){var parentPath=this._query.path.popLast();return parentPath.isEmpty()?null:new DocumentReference(new DocumentKey(parentPath),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(CollectionReference.prototype,'path',{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),CollectionReference.prototype.doc=function(pathString){if(validateBetweenNumberOfArgs('CollectionReference.doc',arguments,0,1),0===arguments.length&&(pathString=AutoId.newId()),validateArgType('CollectionReference.doc','non-empty string',1,pathString),''===pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Document path must be a non-empty string');var path=ResourcePath.fromString(pathString);return DocumentReference.forPath(this._query.path.child(path),this.firestore)},CollectionReference.prototype.add=function(value){validateExactNumberOfArgs('CollectionReference.add',arguments,1),validateArgType('CollectionReference.add','object',1,value);var docRef=this.doc();return docRef.set(value).then(function(){return docRef})},CollectionReference}(Query$1),PublicFirestore=makeConstructorPrivate(Firestore,'Use firebase.firestore() instead.'),PublicTransaction=makeConstructorPrivate(Transaction$1,'Use firebase.firestore().runTransaction() instead.'),PublicWriteBatch=makeConstructorPrivate(WriteBatch,'Use firebase.firestore().batch() instead.'),PublicDocumentReference=makeConstructorPrivate(DocumentReference,'Use firebase.firestore().doc() instead.'),PublicDocumentSnapshot=makeConstructorPrivate(DocumentSnapshot),PublicQueryDocumentSnapshot=makeConstructorPrivate(QueryDocumentSnapshot),PublicQuery=makeConstructorPrivate(Query$1),PublicQuerySnapshot=makeConstructorPrivate(QuerySnapshot),PublicCollectionReference=makeConstructorPrivate(CollectionReference,'Use firebase.firestore().collection() instead.'),firestoreNamespace={Firestore:PublicFirestore,GeoPoint:GeoPoint,Timestamp:Timestamp,Blob:PublicBlob,Transaction:PublicTransaction,WriteBatch:PublicWriteBatch,DocumentReference:PublicDocumentReference,DocumentSnapshot:PublicDocumentSnapshot,Query:PublicQuery,QueryDocumentSnapshot:PublicQueryDocumentSnapshot,QuerySnapshot:PublicQuerySnapshot,CollectionReference:PublicCollectionReference,FieldPath:FieldPath$1,FieldValue:PublicFieldValue,setLogLevel:Firestore.setLogLevel};registerFirestore(firebase),exports.registerFirestore=registerFirestore}).call(exports,__webpack_require__(9))},function(module,__webpack_exports__,__webpack_require__){'use strict';function setLogLevel(level){instances.forEach(function(inst){inst.logLevel=level})}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0}),__webpack_require__.d(__webpack_exports__,'setLogLevel',function(){return setLogLevel}),__webpack_require__.d(__webpack_exports__,'Logger',function(){return Logger}),__webpack_require__.d(__webpack_exports__,'LogLevel',function(){return LogLevel});var instances=[],LogLevel;(function(LogLevel){LogLevel[LogLevel.DEBUG=0]='DEBUG',LogLevel[LogLevel.VERBOSE=1]='VERBOSE',LogLevel[LogLevel.INFO=2]='INFO',LogLevel[LogLevel.WARN=3]='WARN',LogLevel[LogLevel.ERROR=4]='ERROR',LogLevel[LogLevel.SILENT=5]='SILENT'})(LogLevel||(LogLevel={}));var defaultLogLevel=LogLevel.INFO,defaultLogHandler=function(instance,logType){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];if(!(logType<instance.logLevel)){var now=new Date().toISOString();switch(logType){case LogLevel.DEBUG:console.log.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.VERBOSE:console.log.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.INFO:console.info.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.WARN:console.warn.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.ERROR:console.error.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;default:throw new Error('Attempted to log a message with an invalid logType (value: '+logType+')');}}},Logger=function(){function Logger(name){this.name=name,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,instances.push(this)}return Object.defineProperty(Logger.prototype,'logLevel',{get:function(){return this._logLevel},set:function(val){if(!(val in LogLevel))throw new TypeError('Invalid value assigned to `logLevel`');this._logLevel=val},enumerable:!0,configurable:!0}),Object.defineProperty(Logger.prototype,'logHandler',{get:function(){return this._logHandler},set:function(val){if('function'!=typeof val)throw new TypeError('Value assigned to `logHandler` must be a function');this._logHandler=val},enumerable:!0,configurable:!0}),Logger.prototype.debug=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.DEBUG].concat(args))},Logger.prototype.log=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.VERBOSE].concat(args))},Logger.prototype.info=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.INFO].concat(args))},Logger.prototype.warn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.WARN].concat(args))},Logger.prototype.error=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.ERROR].concat(args))},Logger}()},function(module,__webpack_exports__,__webpack_require__){'use strict';var _Mathmin2=Math.min;(function(setImmediate,global){function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError('Promises must be constructed via new');if('function'!=typeof fn)throw new TypeError('not a function');this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;return 0===self._state?void self._deferreds.push(deferred):void(self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return void(1===self._state?resolve:reject)(deferred.promise,self._value);var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}))}function resolve(self,newValue){try{if(newValue===self)throw new TypeError('A promise cannot be resolved with itself.');if(newValue&&('object'==typeof newValue||'function'==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if('function'==typeof then)return void doResolve(bind(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled='function'==typeof onFulfilled?onFulfilled:null,this.onRejected='function'==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0_whatwg_fetch__=__webpack_require__(151),setTimeoutFunc=setTimeout;Promise.prototype['catch']=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.prototype['finally']=function(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){return constructor.reject(reason)})})},Promise.all=function(arr){return new Promise(function(resolve,reject){function res(i,val){try{if(val&&('object'==typeof val||'function'==typeof val)){var then=val.then;if('function'==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}if(!arr||'undefined'==typeof arr.length)throw new TypeError('Promise.all accepts an array');var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&'object'==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn='function'==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){'undefined'!=typeof console&&console&&console.warn('Possible Unhandled Promise Rejection:',err)};var globalNS=function(){if('undefined'!=typeof self)return self;if('undefined'!=typeof window)return window;if('undefined'!=typeof global)return global;throw new Error('unable to locate global object')}();globalNS.Promise||(globalNS.Promise=Promise);var _global=createCommonjsModule(function(module){var global=module.exports='undefined'!=typeof window&&window.Math==Math?window:'undefined'!=typeof self&&self.Math==Math?self:Function('return this')();'number'==typeof __g&&(__g=global)}),_core=createCommonjsModule(function(module){var core=module.exports={version:'2.5.5'};'number'==typeof __e&&(__e=core)}),_core_1=_core.version,_isObject=function(it){return'object'==typeof it?null!==it:'function'==typeof it},_anObject=function(it){if(!_isObject(it))throw TypeError(it+' is not an object!');return it},_fails=function(exec){try{return!!exec()}catch(e){return!0}},_descriptors=!_fails(function(){return 7!=Object.defineProperty({},'a',{get:function(){return 7}}).a}),document=_global.document,is=_isObject(document)&&_isObject(document.createElement),_domCreate=function(it){return is?document.createElement(it):{}},_ie8DomDefine=!_descriptors&&!_fails(function(){return 7!=Object.defineProperty(_domCreate('div'),'a',{get:function(){return 7}}).a}),_toPrimitive=function(it,S){if(!_isObject(it))return it;var fn,val;if(S&&'function'==typeof(fn=it.toString)&&!_isObject(val=fn.call(it)))return val;if('function'==typeof(fn=it.valueOf)&&!_isObject(val=fn.call(it)))return val;if(!S&&'function'==typeof(fn=it.toString)&&!_isObject(val=fn.call(it)))return val;throw TypeError('Can\'t convert object to primitive value')},dP=Object.defineProperty,f=_descriptors?Object.defineProperty:function defineProperty(O,P,Attributes){if(_anObject(O),P=_toPrimitive(P,!0),_anObject(Attributes),_ie8DomDefine)try{return dP(O,P,Attributes)}catch(e){}if('get'in Attributes||'set'in Attributes)throw TypeError('Accessors not supported!');return'value'in Attributes&&(O[P]=Attributes.value),O},_objectDp={f:f},_propertyDesc=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}},_hide=_descriptors?function(object,key,value){return _objectDp.f(object,key,_propertyDesc(1,value))}:function(object,key,value){return object[key]=value,object},hasOwnProperty={}.hasOwnProperty,_has=function(it,key){return hasOwnProperty.call(it,key)},id=0,px=Math.random(),_uid=function(key){return'Symbol('.concat(key===void 0?'':key,')_',(++id+px).toString(36))},_redefine=createCommonjsModule(function(module){var SRC=_uid('src'),TO_STRING='toString',$toString=Function[TO_STRING],TPL=(''+$toString).split(TO_STRING);_core.inspectSource=function(it){return $toString.call(it)},(module.exports=function(O,key,val,safe){var isFunction='function'==typeof val;isFunction&&(_has(val,'name')||_hide(val,'name',key));O[key]===val||(isFunction&&(_has(val,SRC)||_hide(val,SRC,O[key]?''+O[key]:TPL.join(key+''))),O===_global?O[key]=val:safe?O[key]?O[key]=val:_hide(O,key,val):(delete O[key],_hide(O,key,val)))})(Function.prototype,TO_STRING,function toString(){return'function'==typeof this&&this[SRC]||$toString.call(this)})}),_aFunction=function(it){if('function'!=typeof it)throw TypeError(it+' is not a function!');return it},_ctx=function(fn,that,length){return(_aFunction(fn),void 0===that)?fn:1===length?function(a){return fn.call(that,a)}:2===length?function(a,b){return fn.call(that,a,b)}:3===length?function(a,b,c){return fn.call(that,a,b,c)}:function(){return fn.apply(that,arguments)}},PROTOTYPE='prototype',$export=function(type,name,source){var IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,target=IS_GLOBAL?_global:IS_STATIC?_global[name]||(_global[name]={}):(_global[name]||{})[PROTOTYPE],exports=IS_GLOBAL?_core:_core[name]||(_core[name]={}),expProto=exports[PROTOTYPE]||(exports[PROTOTYPE]={}),key,own,out,exp;for(key in IS_GLOBAL&&(source=name),source)own=!IS_FORCED&&target&&void 0!==target[key],out=(own?target:source)[key],exp=IS_BIND&&own?_ctx(out,_global):IS_PROTO&&'function'==typeof out?_ctx(Function.call,out):out,target&&_redefine(target,key,out,type&$export.U),exports[key]!=out&&_hide(exports,key,exp),IS_PROTO&&expProto[key]!=out&&(expProto[key]=out)};_global.core=_core,$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128;var _export=$export,toString={}.toString,_cof=function(it){return toString.call(it).slice(8,-1)},_iobject=Object('z').propertyIsEnumerable(0)?Object:function(it){return'String'==_cof(it)?it.split(''):Object(it)},_defined=function(it){if(it==void 0)throw TypeError('Can\'t call method on  '+it);return it},_toObject=function(it){return Object(_defined(it))},ceil=Math.ceil,floor=Math.floor,_toInteger=function(it){return isNaN(it=+it)?0:(0<it?floor:ceil)(it)},_toLength=function(it){return 0<it?_Mathmin2(_toInteger(it),9007199254740991):0},_isArray=Array.isArray||function isArray(arg){return'Array'==_cof(arg)},SHARED='__core-js_shared__',store=_global[SHARED]||(_global[SHARED]={}),_shared=function(key){return store[key]||(store[key]={})},_wks=createCommonjsModule(function(module){var store=_shared('wks'),Symbol=_global.Symbol,USE_SYMBOL='function'==typeof Symbol,$exports=module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:_uid)('Symbol.'+name))};$exports.store=store}),SPECIES=_wks('species'),_arraySpeciesConstructor=function(original){var C;return _isArray(original)&&(C=original.constructor,'function'==typeof C&&(C===Array||_isArray(C.prototype))&&(C=void 0),_isObject(C)&&(C=C[SPECIES],null===C&&(C=void 0))),void 0===C?Array:C},_arraySpeciesCreate=function(original,length){return new(_arraySpeciesConstructor(original))(length)},_arrayMethods=function(TYPE,$create){var IS_MAP=1==TYPE,IS_EVERY=4==TYPE,IS_FIND_INDEX=6==TYPE,create=$create||_arraySpeciesCreate;return function($this,callbackfn,that){for(var O=_toObject($this),self=_iobject(O),f=_ctx(callbackfn,that,3),length=_toLength(self.length),index=0,result=IS_MAP?create($this,length):2==TYPE?create($this,0):void 0,val,res;length>index;index++)if((5==TYPE||IS_FIND_INDEX||index in self)&&(val=self[index],res=f(val,index,O),TYPE))if(IS_MAP)result[index]=res;else if(res)switch(TYPE){case 3:return!0;case 5:return val;case 6:return index;case 2:result.push(val);}else if(IS_EVERY)return!1;return IS_FIND_INDEX?-1:3==TYPE||IS_EVERY?IS_EVERY:result}},UNSCOPABLES=_wks('unscopables'),ArrayProto=Array.prototype;ArrayProto[UNSCOPABLES]==void 0&&_hide(ArrayProto,UNSCOPABLES,{});var _addToUnscopables=function(key){ArrayProto[UNSCOPABLES][key]=!0},$find=_arrayMethods(5),KEY='find',forced=!0;KEY in[]&&[,][KEY](function(){forced=!1}),_export(_export.P+_export.F*forced,'Array',{find:function find(callbackfn){return $find(this,callbackfn,1<arguments.length?arguments[1]:void 0)}}),_addToUnscopables(KEY);var find=_core.Array.find,$find$1=_arrayMethods(6),KEY$1='findIndex',forced$1=!0;KEY$1 in[]&&[,][KEY$1](function(){forced$1=!1}),_export(_export.P+_export.F*forced$1,'Array',{findIndex:function findIndex(callbackfn){return $find$1(this,callbackfn,1<arguments.length?arguments[1]:void 0)}}),_addToUnscopables(KEY$1);var findIndex=_core.Array.findIndex,_toIobject=function(it){return _iobject(_defined(it))},max=Math.max,_toAbsoluteIndex=function(index,length){return index=_toInteger(index),0>index?max(index+length,0):_Mathmin2(index,length)},shared=_shared('keys'),_sharedKey=function(key){return shared[key]||(shared[key]=_uid(key))},arrayIndexOf=function(IS_INCLUDES){return function($this,el,fromIndex){var O=_toIobject($this),length=_toLength(O.length),index=_toAbsoluteIndex(fromIndex,length),value;if(IS_INCLUDES&&el!=el){for(;length>index;)if(value=O[index++],value!=value)return!0;}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}}(!1),IE_PROTO=_sharedKey('IE_PROTO'),_objectKeysInternal=function(object,names){var O=_toIobject(object),i=0,result=[],key;for(key in O)key!=IE_PROTO&&_has(O,key)&&result.push(key);for(;names.length>i;)_has(O,key=names[i++])&&(~arrayIndexOf(result,key)||result.push(key));return result},_enumBugKeys='constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'.split(','),_objectKeys=Object.keys||function keys(O){return _objectKeysInternal(O,_enumBugKeys)},f$1=Object.getOwnPropertySymbols,_objectGops={f:f$1},f$2={}.propertyIsEnumerable,_objectPie={f:f$2},$assign=Object.assign,_objectAssign=!$assign||_fails(function(){var A={},B={},S=Symbol(),K='abcdefghijklmnopqrst';return A[S]=7,K.split('').forEach(function(k){B[k]=k}),7!=$assign({},A)[S]||Object.keys($assign({},B)).join('')!=K})?function assign(target){for(var T=_toObject(target),aLen=arguments.length,index=1,getSymbols=_objectGops.f,isEnum=_objectPie.f;aLen>index;)for(var S=_iobject(arguments[index++]),keys=getSymbols?_objectKeys(S).concat(getSymbols(S)):_objectKeys(S),length=keys.length,j=0,key;length>j;)isEnum.call(S,key=keys[j++])&&(T[key]=S[key]);return T}:$assign;_export(_export.S+_export.F,'Object',{assign:_objectAssign});var assign=_core.Object.assign,MATCH=_wks('match'),_isRegexp=function(it){var isRegExp;return _isObject(it)&&((isRegExp=it[MATCH])===void 0?'RegExp'==_cof(it):!!isRegExp)},_stringContext=function(that,searchString,NAME){if(_isRegexp(searchString))throw TypeError('String#'+NAME+' doesn\'t accept regex!');return _defined(that)+''},MATCH$1=_wks('match'),STARTS_WITH='startsWith',$startsWith=''[STARTS_WITH];_export(_export.P+_export.F*function(KEY){var re=/./;try{'/./'[KEY](re)}catch(e){try{return re[MATCH$1]=!1,!'/./'[KEY](re)}catch(f){}}return!0}(STARTS_WITH),'String',{startsWith:function startsWith(searchString){var that=_stringContext(this,searchString,STARTS_WITH),index=_toLength(_Mathmin2(1<arguments.length?arguments[1]:void 0,that.length)),search=searchString+'';return that.slice(index,index+search.length)===search}});var startsWith=_core.String.startsWith;_export(_export.P,'String',{repeat:function repeat(count){var str=_defined(this)+'',res='',n=_toInteger(count);if(0>n||n==Infinity)throw RangeError('Count can\'t be negative');for(;0<n;(n>>>=1)&&(str+=str))1&n&&(res+=str);return res}});var repeat=_core.String.repeat,_meta=createCommonjsModule(function(module){var META=_uid('meta'),setDesc=_objectDp.f,id=0,isExtensible=Object.isExtensible||function(){return!0},FREEZE=!_fails(function(){return isExtensible(Object.preventExtensions({}))}),setMeta=function(it){setDesc(it,META,{value:{i:'O'+ ++id,w:{}}})},meta=module.exports={KEY:META,NEED:!1,fastKey:function(it,create){if(!_isObject(it))return'symbol'==typeof it?it:('string'==typeof it?'S':'P')+it;if(!_has(it,META)){if(!isExtensible(it))return'F';if(!create)return'E';setMeta(it)}return it[META].i},getWeak:function(it,create){if(!_has(it,META)){if(!isExtensible(it))return!0;if(!create)return!1;setMeta(it)}return it[META].w},onFreeze:function(it){return FREEZE&&meta.NEED&&isExtensible(it)&&!_has(it,META)&&setMeta(it),it}}}),_meta_1=_meta.KEY,_meta_2=_meta.NEED,_meta_3=_meta.fastKey,_meta_4=_meta.getWeak,_meta_5=_meta.onFreeze,def=_objectDp.f,TAG=_wks('toStringTag'),_setToStringTag=function(it,tag,stat){it&&!_has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})},_wksExt={f:_wks},_library=!1,defineProperty=_objectDp.f,_wksDefine=function(name){var $Symbol=_core.Symbol||(_core.Symbol=_global.Symbol||{});'_'==name.charAt(0)||name in $Symbol||defineProperty($Symbol,name,{value:_wksExt.f(name)})},_enumKeys=function(it){var result=_objectKeys(it),getSymbols=_objectGops.f;if(getSymbols)for(var symbols=getSymbols(it),isEnum=_objectPie.f,i=0,key;symbols.length>i;)isEnum.call(it,key=symbols[i++])&&result.push(key);return result},_objectDps=_descriptors?Object.defineProperties:function defineProperties(O,Properties){_anObject(O);for(var keys=_objectKeys(Properties),length=keys.length,i=0,P;length>i;)_objectDp.f(O,P=keys[i++],Properties[P]);return O},document$1=_global.document,_html=document$1&&document$1.documentElement,IE_PROTO$1=_sharedKey('IE_PROTO'),Empty=function(){},PROTOTYPE$1='prototype',createDict=function(){var iframe=_domCreate('iframe'),i=_enumBugKeys.length,lt='<',gt='>',iframeDocument;for(iframe.style.display='none',_html.appendChild(iframe),iframe.src='javascript:',iframeDocument=iframe.contentWindow.document,iframeDocument.open(),iframeDocument.write(lt+'script'+gt+'document.F=Object'+lt+'/script'+gt),iframeDocument.close(),createDict=iframeDocument.F;i--;)delete createDict[PROTOTYPE$1][_enumBugKeys[i]];return createDict()},_objectCreate=Object.create||function create(O,Properties){var result;return null===O?result=createDict():(Empty[PROTOTYPE$1]=_anObject(O),result=new Empty,Empty[PROTOTYPE$1]=null,result[IE_PROTO$1]=O),void 0===Properties?result:_objectDps(result,Properties)},hiddenKeys=_enumBugKeys.concat('length','prototype'),f$4=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return _objectKeysInternal(O,hiddenKeys)},_objectGopn={f:f$4},gOPN=_objectGopn.f,toString$1={}.toString,windowNames='object'==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(it){try{return gOPN(it)}catch(e){return windowNames.slice()}},_objectGopnExt={f:function getOwnPropertyNames(it){return windowNames&&'[object Window]'==toString$1.call(it)?getWindowNames(it):gOPN(_toIobject(it))}},gOPD=Object.getOwnPropertyDescriptor,f$6=_descriptors?gOPD:function getOwnPropertyDescriptor(O,P){if(O=_toIobject(O),P=_toPrimitive(P,!0),_ie8DomDefine)try{return gOPD(O,P)}catch(e){}return _has(O,P)?_propertyDesc(!_objectPie.f.call(O,P),O[P]):void 0},_objectGopd={f:f$6},META=_meta.KEY,gOPD$1=_objectGopd.f,dP$1=_objectDp.f,gOPN$1=_objectGopnExt.f,$Symbol=_global.Symbol,$JSON=_global.JSON,_stringify=$JSON&&$JSON.stringify,PROTOTYPE$2='prototype',HIDDEN=_wks('_hidden'),TO_PRIMITIVE=_wks('toPrimitive'),isEnum={}.propertyIsEnumerable,SymbolRegistry=_shared('symbol-registry'),AllSymbols=_shared('symbols'),OPSymbols=_shared('op-symbols'),ObjectProto=Object[PROTOTYPE$2],USE_NATIVE='function'==typeof $Symbol,QObject=_global.QObject,setter=!QObject||!QObject[PROTOTYPE$2]||!QObject[PROTOTYPE$2].findChild,setSymbolDesc=_descriptors&&_fails(function(){return 7!=_objectCreate(dP$1({},'a',{get:function(){return dP$1(this,'a',{value:7}).a}})).a})?function(it,key,D){var protoDesc=gOPD$1(ObjectProto,key);protoDesc&&delete ObjectProto[key],dP$1(it,key,D),protoDesc&&it!==ObjectProto&&dP$1(ObjectProto,key,protoDesc)}:dP$1,wrap=function(tag){var sym=AllSymbols[tag]=_objectCreate($Symbol[PROTOTYPE$2]);return sym._k=tag,sym},isSymbol=USE_NATIVE&&'symbol'==typeof $Symbol.iterator?function(it){return'symbol'==typeof it}:function(it){return it instanceof $Symbol},$defineProperty=function defineProperty(it,key,D){return it===ObjectProto&&$defineProperty(OPSymbols,key,D),_anObject(it),key=_toPrimitive(key,!0),_anObject(D),_has(AllSymbols,key)?(D.enumerable?(_has(it,HIDDEN)&&it[HIDDEN][key]&&(it[HIDDEN][key]=!1),D=_objectCreate(D,{enumerable:_propertyDesc(0,!1)})):(!_has(it,HIDDEN)&&dP$1(it,HIDDEN,_propertyDesc(1,{})),it[HIDDEN][key]=!0),setSymbolDesc(it,key,D)):dP$1(it,key,D)},$defineProperties=function defineProperties(it,P){_anObject(it);for(var keys=_enumKeys(P=_toIobject(P)),i=0,l=keys.length,key;l>i;)$defineProperty(it,key=keys[i++],P[key]);return it},$propertyIsEnumerable=function propertyIsEnumerable(key){var E=isEnum.call(this,key=_toPrimitive(key,!0));return this===ObjectProto&&_has(AllSymbols,key)&&!_has(OPSymbols,key)?!1:E||!_has(this,key)||!_has(AllSymbols,key)||_has(this,HIDDEN)&&this[HIDDEN][key]?E:!0},$getOwnPropertyDescriptor=function getOwnPropertyDescriptor(it,key){if(it=_toIobject(it),key=_toPrimitive(key,!0),it!==ObjectProto||!_has(AllSymbols,key)||_has(OPSymbols,key)){var D=gOPD$1(it,key);return D&&_has(AllSymbols,key)&&!(_has(it,HIDDEN)&&it[HIDDEN][key])&&(D.enumerable=!0),D}},$getOwnPropertyNames=function getOwnPropertyNames(it){for(var names=gOPN$1(_toIobject(it)),result=[],i=0,key;names.length>i;)_has(AllSymbols,key=names[i++])||key==HIDDEN||key==META||result.push(key);return result},$getOwnPropertySymbols=function getOwnPropertySymbols(it){for(var IS_OP=it===ObjectProto,names=gOPN$1(IS_OP?OPSymbols:_toIobject(it)),result=[],i=0,key;names.length>i;)_has(AllSymbols,key=names[i++])&&(!IS_OP||_has(ObjectProto,key))&&result.push(AllSymbols[key]);return result};USE_NATIVE||($Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError('Symbol is not a constructor!');var tag=_uid(0<arguments.length?arguments[0]:void 0),$set=function(value){this===ObjectProto&&$set.call(OPSymbols,value),_has(this,HIDDEN)&&_has(this[HIDDEN],tag)&&(this[HIDDEN][tag]=!1),setSymbolDesc(this,tag,_propertyDesc(1,value))};return _descriptors&&setter&&setSymbolDesc(ObjectProto,tag,{configurable:!0,set:$set}),wrap(tag)},_redefine($Symbol[PROTOTYPE$2],'toString',function toString(){return this._k}),_objectGopd.f=$getOwnPropertyDescriptor,_objectDp.f=$defineProperty,_objectGopn.f=_objectGopnExt.f=$getOwnPropertyNames,_objectPie.f=$propertyIsEnumerable,_objectGops.f=$getOwnPropertySymbols,_descriptors&&!_library&&_redefine(ObjectProto,'propertyIsEnumerable',$propertyIsEnumerable,!0),_wksExt.f=function(name){return wrap(_wks(name))}),_export(_export.G+_export.W+_export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols='hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'.split(','),j=0;es6Symbols.length>j;)_wks(es6Symbols[j++]);for(var wellKnownSymbols=_objectKeys(_wks.store),k=0;wellKnownSymbols.length>k;)_wksDefine(wellKnownSymbols[k++]);_export(_export.S+_export.F*!USE_NATIVE,'Symbol',{for:function(key){return _has(SymbolRegistry,key+='')?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function keyFor(sym){if(!isSymbol(sym))throw TypeError(sym+' is not a symbol!');for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),_export(_export.S+_export.F*!USE_NATIVE,'Object',{create:function create(it,P){return P===void 0?_objectCreate(it):$defineProperties(_objectCreate(it),P)},defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),$JSON&&_export(_export.S+_export.F*(!USE_NATIVE||_fails(function(){var S=$Symbol();return'[null]'!=_stringify([S])||'{}'!=_stringify({a:S})||'{}'!=_stringify(Object(S))})),'JSON',{stringify:function stringify(it){for(var args=[it],i=1,replacer,$replacer;arguments.length>i;)args.push(arguments[i++]);if($replacer=replacer=args[1],(_isObject(replacer)||void 0!==it)&&!isSymbol(it))return _isArray(replacer)||(replacer=function(key,value){if('function'==typeof $replacer&&(value=$replacer.call(this,key,value)),!isSymbol(value))return value}),args[1]=replacer,_stringify.apply($JSON,args)}}),$Symbol[PROTOTYPE$2][TO_PRIMITIVE]||_hide($Symbol[PROTOTYPE$2],TO_PRIMITIVE,$Symbol[PROTOTYPE$2].valueOf),_setToStringTag($Symbol,'Symbol'),_setToStringTag(Math,'Math',!0),_setToStringTag(_global.JSON,'JSON',!0);var TAG$1=_wks('toStringTag'),ARG='Arguments'==_cof(function(){return arguments}()),tryGet=function(it,key){try{return it[key]}catch(e){}},_classof=function(it){var O,T,B;return it===void 0?'Undefined':null===it?'Null':'string'==typeof(T=tryGet(O=Object(it),TAG$1))?T:ARG?_cof(O):'Object'==(B=_cof(O))&&'function'==typeof O.callee?'Arguments':B};({})[_wks('toStringTag')]='z',_redefine(Object.prototype,'toString',function toString(){return'[object '+_classof(this)+']'},!0),_wksDefine('asyncIterator'),_wksDefine('observable');var symbol=_core.Symbol,_iterators={},IteratorPrototype={};_hide(IteratorPrototype,_wks('iterator'),function(){return this});var _iterCreate=function(Constructor,NAME,next){Constructor.prototype=_objectCreate(IteratorPrototype,{next:_propertyDesc(1,next)}),_setToStringTag(Constructor,NAME+' Iterator')},IE_PROTO$2=_sharedKey('IE_PROTO'),ObjectProto$1=Object.prototype,_objectGpo=Object.getPrototypeOf||function(O){return O=_toObject(O),_has(O,IE_PROTO$2)?O[IE_PROTO$2]:'function'==typeof O.constructor&&O instanceof O.constructor?O.constructor.prototype:O instanceof Object?ObjectProto$1:null},ITERATOR=_wks('iterator'),BUGGY=!([].keys&&'next'in[].keys()),KEYS='keys',VALUES='values',returnThis=function(){return this},_iterDefine=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){_iterCreate(Constructor,NAME,next);var getMethod=function(kind){return!BUGGY&&kind in proto?proto[kind]:kind===KEYS?function keys(){return new Constructor(this,kind)}:kind===VALUES?function values(){return new Constructor(this,kind)}:function entries(){return new Constructor(this,kind)}},TAG=NAME+' Iterator',DEF_VALUES=DEFAULT==VALUES,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto['@@iterator']||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT),$entries=DEFAULT?DEF_VALUES?getMethod('entries'):$default:void 0,$anyNative='Array'==NAME?proto.entries||$native:$native,methods,key,IteratorPrototype;if($anyNative&&(IteratorPrototype=_objectGpo($anyNative.call(new Base)),IteratorPrototype!==Object.prototype&&IteratorPrototype.next&&(_setToStringTag(IteratorPrototype,TAG,!0),'function'!=typeof IteratorPrototype[ITERATOR]&&_hide(IteratorPrototype,ITERATOR,returnThis))),DEF_VALUES&&$native&&$native.name!==VALUES&&(VALUES_BUG=!0,$default=function values(){return $native.call(this)}),(BUGGY||VALUES_BUG||!proto[ITERATOR])&&_hide(proto,ITERATOR,$default),_iterators[NAME]=$default,_iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:$entries},FORCED)for(key in methods)key in proto||_redefine(proto,key,methods[key]);else _export(_export.P+_export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods},$at=function(TO_STRING){return function(that,pos){var s=_defined(that)+'',i=_toInteger(pos),l=s.length,a,b;return 0>i||i>=l?TO_STRING?'':void 0:(a=s.charCodeAt(i),55296>a||56319<a||i+1===l||56320>(b=s.charCodeAt(i+1))||57343<b?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536)}}(!0);_iterDefine(String,'String',function(iterated){this._t=iterated+'',this._i=0},function(){var O=this._t,index=this._i,point;return index>=O.length?{value:void 0,done:!0}:(point=$at(O,index),this._i+=point.length,{value:point,done:!1})});var _iterStep=function(done,value){return{value:value,done:!!done}},es6_array_iterator=_iterDefine(Array,'Array',function(iterated,kind){this._t=_toIobject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,_iterStep(1)):'keys'==kind?_iterStep(0,index):'values'==kind?_iterStep(0,O[index]):_iterStep(0,[index,O[index]])},'values');_iterators.Arguments=_iterators.Array,_addToUnscopables('keys'),_addToUnscopables('values'),_addToUnscopables('entries');for(var ITERATOR$1=_wks('iterator'),TO_STRING_TAG=_wks('toStringTag'),ArrayValues=_iterators.Array,DOMIterables={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},collections=_objectKeys(DOMIterables),i=0;i<collections.length;i++){var NAME=collections[i],explicit=DOMIterables[NAME],Collection=_global[NAME],proto=Collection&&Collection.prototype,key;if(proto&&(proto[ITERATOR$1]||_hide(proto,ITERATOR$1,ArrayValues),proto[TO_STRING_TAG]||_hide(proto,TO_STRING_TAG,NAME),_iterators[NAME]=ArrayValues,explicit))for(key in es6_array_iterator)proto[key]||_redefine(proto,key,es6_array_iterator[key],!0)}_wksExt.f('iterator')}).call(__webpack_exports__,__webpack_require__(148).setImmediate,__webpack_require__(0))},function(module,exports,__webpack_require__){'use strict';function deepExtend(target,source){if(!(source instanceof Object))return source;switch(source.constructor){case Date:return new Date(source.getTime());case Object:target===void 0&&(target={});break;case Array:target=[];break;default:return source;}for(var prop in source)source.hasOwnProperty(prop)&&(target[prop]=deepExtend(target[prop],source[prop]));return target}function jsonEval(str){return JSON.parse(str)}function implementsAnyMethods(obj,methods){if('object'!=typeof obj||null===obj)return!1;for(var _i=0,methods_1=methods,method;_i<methods_1.length;_i++)if(method=methods_1[_i],method in obj&&'function'==typeof obj[method])return!0;return!1}function noop(){}function errorPrefix(fnName,argumentNumber,optional){var argName='';switch(argumentNumber){case 1:argName=optional?'first':'First';break;case 2:argName=optional?'second':'Second';break;case 3:argName=optional?'third':'Third';break;case 4:argName=optional?'fourth':'Fourth';break;default:throw new Error('errorPrefix called with argumentNumber > 4.  Need to update it?');}var error=fnName+' failed: ';return error+=argName+' argument ',error}var _StringfromCharCode=String.fromCharCode;Object.defineProperty(exports,'__esModule',{value:!0});var tslib_1=__webpack_require__(19),CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:'${JSCORE_VERSION}'},assert=function(assertion,message){if(!assertion)throw assertionError(message)},assertionError=function(message){return new Error('Firebase Database ('+CONSTANTS.SDK_VERSION+') INTERNAL ASSERT FAILED: '+message)},stringToByteArray=function(str){for(var out=[],p=0,i=0,c;i<str.length;i++)c=str.charCodeAt(i),128>c?out[p++]=c:2048>c?(out[p++]=192|c>>6,out[p++]=128|63&c):55296==(64512&c)&&i+1<str.length&&56320==(64512&str.charCodeAt(i+1))?(c=65536+((1023&c)<<10)+(1023&str.charCodeAt(++i)),out[p++]=240|c>>18,out[p++]=128|63&c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c):(out[p++]=224|c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c);return out},byteArrayToString=function(bytes){for(var out=[],pos=0,c=0;pos<bytes.length;){var c1=bytes[pos++];if(128>c1)out[c++]=_StringfromCharCode(c1);else if(191<c1&&224>c1){var c2=bytes[pos++];out[c++]=_StringfromCharCode((31&c1)<<6|63&c2)}else if(239<c1&&365>c1){var c2=bytes[pos++],c3=bytes[pos++],c4=bytes[pos++],u=((7&c1)<<18|(63&c2)<<12|(63&c3)<<6|63&c4)-65536;out[c++]=_StringfromCharCode(55296+(u>>10)),out[c++]=_StringfromCharCode(56320+(1023&u))}else{var c2=bytes[pos++],c3=bytes[pos++];out[c++]=_StringfromCharCode((15&c1)<<12|(63&c2)<<6|63&c3)}}return out.join('')},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:'ABCDEFGHIJKLMNOPQRSTUVWXYZ'+'abcdefghijklmnopqrstuvwxyz'+'0123456789',get ENCODED_VALS(){return this.ENCODED_VALS_BASE+'+/='},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+'-_.'},HAS_NATIVE_SUPPORT:'function'==typeof atob,encodeByteArray:function(input,opt_webSafe){if(!Array.isArray(input))throw Error('encodeByteArray takes an array as a parameter');this.init_();for(var byteToCharMap=opt_webSafe?this.byteToCharMapWebSafe_:this.byteToCharMap_,output=[],i=0;i<input.length;i+=3){var byte1=input[i],haveByte2=i+1<input.length,byte2=haveByte2?input[i+1]:0,haveByte3=i+2<input.length,byte3=haveByte3?input[i+2]:0,outByte3=(15&byte2)<<2|byte3>>6,outByte4=63&byte3;haveByte3||(outByte4=64,!haveByte2&&(outByte3=64)),output.push(byteToCharMap[byte1>>2],byteToCharMap[(3&byte1)<<4|byte2>>4],byteToCharMap[outByte3],byteToCharMap[outByte4])}return output.join('')},encodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?btoa(input):this.encodeByteArray(stringToByteArray(input),opt_webSafe)},decodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?atob(input):byteArrayToString(this.decodeStringToByteArray(input,opt_webSafe))},decodeStringToByteArray:function(input,opt_webSafe){this.init_();for(var charToByteMap=opt_webSafe?this.charToByteMapWebSafe_:this.charToByteMap_,output=[],i=0;i<input.length;){var byte1=charToByteMap[input.charAt(i++)],haveByte2=i<input.length,byte2=haveByte2?charToByteMap[input.charAt(i)]:0;++i;var haveByte3=i<input.length,byte3=haveByte3?charToByteMap[input.charAt(i)]:64;++i;var haveByte4=i<input.length,byte4=haveByte4?charToByteMap[input.charAt(i)]:64;if(++i,null==byte1||null==byte2||null==byte3||null==byte4)throw Error();if(output.push(byte1<<2|byte2>>4),64!=byte3){if(output.push(240&byte2<<4|byte3>>2),64!=byte4){output.push(192&byte3<<6|byte4)}}}return output},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}},base64Decode=function(str){try{return base64.decodeString(str,!0)}catch(e){console.error('base64Decode failed: ',e)}return null},Deferred=function(){function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve,_this.reject=reject})}return Deferred.prototype.wrapCallback=function(callback){var _this=this;return function(error,value){error?_this.reject(error):_this.resolve(value),'function'==typeof callback&&(_this.promise.catch(function(){}),1===callback.length?callback(error):callback(error,value))}},Deferred}(),getUA=function(){return'undefined'!=typeof navigator&&'string'==typeof navigator.userAgent?navigator.userAgent:''},ERROR_NAME='FirebaseError',captureStackTrace=Error.captureStackTrace,FirebaseError=function(){return function FirebaseError(code,message){if(this.code=code,this.message=message,captureStackTrace)captureStackTrace(this,ErrorFactory.prototype.create);else try{throw Error.apply(this,arguments)}catch(err){this.name=ERROR_NAME,Object.defineProperty(this,'stack',{get:function(){return err.stack}})}}}();FirebaseError.prototype=Object.create(Error.prototype),FirebaseError.prototype.constructor=FirebaseError,FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors,this.pattern=/\{\$([^}]+)}/g}return ErrorFactory.prototype.create=function(code,data){void 0===data&&(data={});var template=this.errors[code],fullCode=this.service+'/'+code,message;message=void 0===template?'Error':template.replace(this.pattern,function(match,key){var value=data[key];return void 0===value?'<'+key+'?>':value.toString()}),message=this.serviceName+': '+message+' ('+fullCode+').';var err=new FirebaseError(fullCode,message);for(var prop in data)data.hasOwnProperty(prop)&&'_'!==prop.slice(-1)&&(err[prop]=data[prop]);return err},ErrorFactory}(),decode=function(token){var header={},claims={},data={},signature='';try{var parts=token.split('.');header=jsonEval(base64Decode(parts[0])||''),claims=jsonEval(base64Decode(parts[1])||''),signature=parts[2],data=claims.d||{},delete claims.d}catch(e){}return{header:header,claims:claims,data:data,signature:signature}},forEach=function(obj,fn){for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&fn(key,obj[key])},extend=function(objTo,objFrom){return forEach(objFrom,function(key,value){objTo[key]=value}),objTo},findKey=function(obj,fn,opt_this){for(var key in obj)if(fn.call(opt_this,obj[key],key,obj))return key},Hash=function(){return function Hash(){this.blockSize=-1}}(),Sha1=function(_super){function Sha1(){var _this=_super.call(this)||this;_this.chain_=[],_this.buf_=[],_this.W_=[],_this.pad_=[],_this.inbuf_=0,_this.total_=0,_this.blockSize=512/8,_this.pad_[0]=128;for(var i=1;i<_this.blockSize;++i)_this.pad_[i]=0;return _this.reset(),_this}return tslib_1.__extends(Sha1,_super),Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,opt_offset){opt_offset||(opt_offset=0);var W=this.W_;if('string'==typeof buf)for(var i=0;16>i;i++)W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3),opt_offset+=4;else for(var i=0;16>i;i++)W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3],opt_offset+=4;for(var i=16,t;80>i;i++)t=W[i-3]^W[i-8]^W[i-14]^W[i-16],W[i]=4294967295&(t<<1|t>>>31);for(var a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],i=0,f,k;80>i;i++){40>i?20>i?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):60>i?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=4294967295&(a<<5|a>>>27)+f+e+k+W[i];e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=4294967295&this.chain_[0]+a,this.chain_[1]=4294967295&this.chain_[1]+b,this.chain_[2]=4294967295&this.chain_[2]+c,this.chain_[3]=4294967295&this.chain_[3]+d,this.chain_[4]=4294967295&this.chain_[4]+e},Sha1.prototype.update=function(bytes,opt_length){if(null!=bytes){void 0===opt_length&&(opt_length=bytes.length);for(var lengthMinusBlock=opt_length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<opt_length;){if(0==inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if('string'==typeof bytes){for(;n<opt_length;)if(buf[inbuf]=bytes.charCodeAt(n),++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<opt_length;)if(buf[inbuf]=bytes[n],++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=opt_length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;56>this.inbuf_?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;56<=i;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);for(var n=0,i=0;5>i;i++)for(var j=24;0<=j;j-=8)digest[n]=255&this.chain_[i]>>j,++n;return digest},Sha1}(Hash),ObserverProxy=function(){function ObserverProxy(executor,onNoObservers){var _this=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=onNoObservers,this.task.then(function(){executor(_this)}).catch(function(e){_this.error(e)})}return ObserverProxy.prototype.next=function(value){this.forEachObserver(function(observer){observer.next(value)})},ObserverProxy.prototype.error=function(error){this.forEachObserver(function(observer){observer.error(error)}),this.close(error)},ObserverProxy.prototype.complete=function(){this.forEachObserver(function(observer){observer.complete()}),this.close()},ObserverProxy.prototype.subscribe=function(nextOrObserver,error,complete){var _this=this,observer;if(void 0===nextOrObserver&&void 0===error&&void 0===complete)throw new Error('Missing Observer.');observer=implementsAnyMethods(nextOrObserver,['next','error','complete'])?nextOrObserver:{next:nextOrObserver,error:error,complete:complete},void 0===observer.next&&(observer.next=noop),void 0===observer.error&&(observer.error=noop),void 0===observer.complete&&(observer.complete=noop);var unsub=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{_this.finalError?observer.error(_this.finalError):observer.complete()}catch(e){}}),this.observers.push(observer),unsub},ObserverProxy.prototype.unsubscribeOne=function(i){void 0===this.observers||void 0===this.observers[i]||(delete this.observers[i],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},ObserverProxy.prototype.forEachObserver=function(fn){if(!this.finalized)for(var i=0;i<this.observers.length;i++)this.sendOne(i,fn)},ObserverProxy.prototype.sendOne=function(i,fn){var _this=this;this.task.then(function(){if(void 0!==_this.observers&&void 0!==_this.observers[i])try{fn(_this.observers[i])}catch(e){'undefined'!=typeof console&&console.error&&console.error(e)}})},ObserverProxy.prototype.close=function(err){var _this=this;this.finalized||(this.finalized=!0,void 0!==err&&(this.finalError=err),this.task.then(function(){_this.observers=void 0,_this.onNoObservers=void 0}))},ObserverProxy}();exports.assert=assert,exports.assertionError=assertionError,exports.base64=base64,exports.base64Decode=base64Decode,exports.base64Encode=function(str){var utf8Bytes=stringToByteArray(str);return base64.encodeByteArray(utf8Bytes,!0)},exports.CONSTANTS=CONSTANTS,exports.deepCopy=function deepCopy(value){return deepExtend(void 0,value)},exports.deepExtend=deepExtend,exports.patchProperty=function patchProperty(obj,prop,value){obj[prop]=value},exports.Deferred=Deferred,exports.getUA=getUA,exports.isMobileCordova=function(){return'undefined'!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())},exports.isNodeSdk=function(){return!0===CONSTANTS.NODE_CLIENT||!0===CONSTANTS.NODE_ADMIN},exports.isReactNative=function(){return'object'==typeof navigator&&'ReactNative'===navigator.product},exports.ErrorFactory=ErrorFactory,exports.FirebaseError=FirebaseError,exports.patchCapture=function patchCapture(captureFake){var result=captureStackTrace;return captureStackTrace=captureFake,result},exports.jsonEval=jsonEval,exports.stringify=function stringify(data){return JSON.stringify(data)},exports.decode=decode,exports.isAdmin=function(token){var claims=decode(token).claims;return'object'==typeof claims&&!0===claims.admin},exports.issuedAtTime=function(token){var claims=decode(token).claims;return'object'==typeof claims&&claims.hasOwnProperty('iat')?claims.iat:null},exports.isValidFormat=function(token){var decoded=decode(token),claims=decoded.claims;return!!claims&&'object'==typeof claims&&claims.hasOwnProperty('iat')},exports.isValidTimestamp=function(token){var claims=decode(token).claims,now=Math.floor(new Date().getTime()/1e3),validSince,validUntil;return'object'==typeof claims&&(claims.hasOwnProperty('nbf')?validSince=claims.nbf:claims.hasOwnProperty('iat')&&(validSince=claims.iat),validUntil=claims.hasOwnProperty('exp')?claims.exp:validSince+86400),now&&validSince&&validUntil&&now>=validSince&&now<=validUntil},exports.clone=function(obj){return extend({},obj)},exports.contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},exports.every=function(obj,fn){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&!fn(key,obj[key]))return!1;return!0},exports.extend=extend,exports.findKey=findKey,exports.findValue=function(obj,fn,opt_this){var key=findKey(obj,fn,opt_this);return key&&obj[key]},exports.forEach=forEach,exports.getAnyKey=function(obj){for(var key in obj)return key},exports.getCount=function(obj){var rv=0;for(var key in obj)rv++;return rv},exports.getValues=function(obj){var res=[],i=0;for(var key in obj)res[i++]=obj[key];return res},exports.isEmpty=function(obj){for(var key in obj)return!1;return!0},exports.isNonNullObject=function(obj){return'object'==typeof obj&&null!==obj},exports.map=function(obj,f,opt_obj){var res={};for(var key in obj)res[key]=f.call(opt_obj,obj[key],key,obj);return res},exports.safeGet=function(obj,key){if(Object.prototype.hasOwnProperty.call(obj,key))return obj[key]},exports.querystring=function(querystringParams){var params=[];return forEach(querystringParams,function(key,value){Array.isArray(value)?value.forEach(function(arrayVal){params.push(encodeURIComponent(key)+'='+encodeURIComponent(arrayVal))}):params.push(encodeURIComponent(key)+'='+encodeURIComponent(value))}),params.length?'&'+params.join('&'):''},exports.querystringDecode=function(querystring){var obj={},tokens=querystring.replace(/^\?/,'').split('&');return tokens.forEach(function(token){if(token){var key=token.split('=');obj[key[0]]=key[1]}}),obj},exports.Sha1=Sha1,exports.async=function async(fn,onError){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];Promise.resolve(!0).then(function(){fn.apply(void 0,args)}).catch(function(error){onError&&onError(error)})}},exports.createSubscribe=function createSubscribe(executor,onNoObservers){var proxy=new ObserverProxy(executor,onNoObservers);return proxy.subscribe.bind(proxy)},exports.errorPrefix=errorPrefix,exports.validateArgCount=function(fnName,minCount,maxCount,argCount){var argError;if(argCount<minCount?argError='at least '+minCount:argCount>maxCount&&(argError=0===maxCount?'none':'no more than '+maxCount),argError){var error=fnName+' failed: Was called with '+argCount+(1===argCount?' argument.':' arguments.')+' Expects '+argError+'.';throw new Error(error)}},exports.validateCallback=function validateCallback(fnName,argumentNumber,callback,optional){if((!optional||callback)&&'function'!=typeof callback)throw new Error(errorPrefix(fnName,argumentNumber,optional)+'must be a valid function.')},exports.validateContextObject=function validateContextObject(fnName,argumentNumber,context,optional){if((!optional||context)&&('object'!=typeof context||null===context))throw new Error(errorPrefix(fnName,argumentNumber,optional)+'must be a valid context object.')},exports.validateNamespace=function validateNamespace(fnName,argumentNumber,namespace,optional){if((!optional||namespace)&&'string'!=typeof namespace)throw new Error(errorPrefix(fnName,argumentNumber,optional)+'must be a valid firebase namespace.')},exports.stringLength=function(str){for(var p=0,i=0,c;i<str.length;i++)c=str.charCodeAt(i),128>c?p++:2048>c?p+=2:55296<=c&&56319>=c?(p+=4,i++):p+=3;return p},exports.stringToByteArray=function(str){for(var out=[],p=0,i=0,c;i<str.length;i++){if(c=str.charCodeAt(i),55296<=c&&56319>=c){var high=c-55296;i++,assert(i<str.length,'Surrogate pair missing trail surrogate.');var low=str.charCodeAt(i)-56320;c=65536+(high<<10)+low}128>c?out[p++]=c:2048>c?(out[p++]=192|c>>6,out[p++]=128|63&c):65536>c?(out[p++]=224|c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c):(out[p++]=240|c>>18,out[p++]=128|63&c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c)}return out}},function(module,__webpack_exports__,__webpack_require__){'use strict';var _Mathround=Math.round,_Mathfloor2=Math.floor,_Mathmax2=Math.max;(function(global){function l(a){return'string'==typeof a}function m(a,b){a=a.split('.'),b=b||h;for(var c=0;c<a.length;c++)if(b=b[a[c]],null==b)return null;return b}function aa(){}function ba(a){var b=typeof a;if('object'==b){if(a){if(a instanceof Array)return'array';if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if('[object Window]'==c)return'object';if('[object Array]'==c||'number'==typeof a.length&&'undefined'!=typeof a.splice&&'undefined'!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable('splice'))return'array';if('[object Function]'==c||'undefined'!=typeof a.call&&'undefined'!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable('call'))return'function'}else return'null';}else if('function'==b&&'undefined'==typeof a.call)return'object';return b}function n(a){return'array'==ba(a)}function ca(a){var b=ba(a);return'array'==b||'object'==b&&'number'==typeof a.length}function q(a){return'function'==ba(a)}function r(a){var b=typeof a;return'object'==b&&null!=a||'function'==b}function ea(a){return a.call.apply(a.bind,arguments)}function fa(a,b){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function u(){return u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf('native code')?ea:fa,u.apply(null,arguments)}function v(a){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();return b.push.apply(b,arguments),a.apply(this,b)}}function x(a,b){function c(){}c.prototype=b.prototype,a.L=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.mh=function(a,c){for(var d=Array(arguments.length-2),f=2;f<arguments.length;f++)d[f-2]=arguments[f];return b.prototype[c].apply(a,d)}}function y(a){if(Error.captureStackTrace)Error.captureStackTrace(this,y);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=a+'')}function ha(a,b){a=a.split('%s');for(var c='',d=a.length-1,f=0;f<d;f++)c+=a[f]+(f<b.length?b[f]:'%s');y.call(this,c+a[d])}function ia(a){throw new ha('Failure'+(a?': '+a:''),Array.prototype.slice.call(arguments,1))}function z(){0!=ja&&(ka[this[t]||(this[t]=++da)]=this),this.Ka=this.Ka,this.Qa=this.Qa}function pa(a){a:{for(var b=qa,c=a.length,d=l(a)?a.split(''):a,f=0;f<c;f++)if(f in d&&b.call(void 0,d[f],f,a)){b=f;break a}b=-1}return 0>b?null:l(a)?a.charAt(b):a[b]}function ra(a){if(!n(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function sa(a,b){b=la(a,b);var c;return(c=0<=b)&&Array.prototype.splice.call(a,b,1),c}function ta(){return Array.prototype.concat.apply([],arguments)}function ua(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function va(a){return /^[\s\xa0]*$/.test(a)}function xa(a,b){return a<b?-1:a>b?1:0}function B(a){return-1!=A.indexOf(a)}function Aa(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function Ba(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Ca(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Da(a){var b={},c;for(c in a)b[c]=a[c];return b}function Fa(a){for(var f=1,c,d;f<arguments.length;f++){for(c in d=arguments[f],d)a[c]=d[c];for(var g=0;g<Ea.length;g++)c=Ea[g],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Ga(a){return Ga[' '](a),a}function Ha(a,b){var c=Ia;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)}function Oa(){var a=h.document;return a?a.documentMode:void 0}function Ta(a){return Ha(a,function(){for(var b=0,c=wa(Pa+'').split('.'),d=wa(a+'').split('.'),f=_Mathmax2(c.length,d.length),g=0;0==b&&g<f;g++){var k=c[g]||'',p=d[g]||'';do{if(k=/(\d*)(\D*)(.*)/.exec(k)||['','','',''],p=/(\d*)(\D*)(.*)/.exec(p)||['','','',''],0==k[0].length&&0==p[0].length)break;b=xa(0==k[1].length?0:parseInt(k[1],10),0==p[1].length?0:parseInt(p[1],10))||xa(0==k[2].length,0==p[2].length)||xa(k[2],p[2]),k=k[3],p=p[3]}while(0==b)}return 0<=b})}function D(a,b){this.type=a,this.currentTarget=this.target=b,this.defaultPrevented=this.Ea=!1,this.Be=!0}function E(a,b){D.call(this,a?a.type:''),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key='',this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType='',this.fb=null,a&&this.Kf(a,b)}function F(a){return a&&a[ab]}function cb(a,b,c,d,f){this.listener=a,this.proxy=null,this.src=b,this.type=c,this.capture=!!d,this.Ob=f,this.key=++bb,this.Sa=this.Eb=!1}function db(a){this.src=a,this.J={},this.xb=0}function eb(a,b,c,d){for(var f=0,g;f<a.length;++f)if(g=a[f],!g.Sa&&g.listener==b&&g.capture==!!c&&g.Ob==d)return f;return-1}function ib(a,b,c,d,f){if(d&&d.once)return jb(a,b,c,d,f);if(n(b)){for(var g=0;g<b.length;g++)ib(a,b[g],c,d,f);return null}return c=kb(c),F(a)?a.nb(b,c,r(d)?!!d.capture:!!d,f):lb(a,b,c,!1,d,f)}function lb(a,b,c,d,f,g){if(!b)throw Error('Invalid event type');var k=r(f)?!!f.capture:!!f,p=G(a);if(p||(a[fb]=p=new db(a)),c=p.add(b,c,d,k,g),c.proxy)return c;if(d=mb(),c.proxy=d,d.src=a,d.listener=c,a.addEventListener)Za||(f=k),void 0===f&&(f=!1),a.addEventListener(b.toString(),d,f);else if(a.attachEvent)a.attachEvent(nb(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error('addEventListener and attachEvent are unavailable.');return c}function mb(){var a=ob,b=Xa?function(c){return a.call(b.src,b.listener,c)}:function(c){if(c=a.call(b.src,b.listener,c),!c)return c};return b}function jb(a,b,c,d,f){if(n(b)){for(var g=0;g<b.length;g++)jb(a,b[g],c,d,f);return null}return c=kb(c),F(a)?a.Oc(b,c,r(d)?!!d.capture:!!d,f):lb(a,b,c,!0,d,f)}function pb(a,b,c,d,f){if(n(b))for(var g=0;g<b.length;g++)pb(a,b[g],c,d,f);else d=r(d)?!!d.capture:!!d,c=kb(c),F(a)?a.ed(b,c,d,f):a&&(a=G(a))&&(b=a.jb(b,c,d,f))&&qb(b)}function qb(a){if('number'!=typeof a&&a&&!a.Sa){var b=a.src;if(F(b))b.Le(a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(nb(c),d):b.addListener&&b.removeListener&&b.removeListener(d),(c=G(b))?(c.ye(a),0==c.xb&&(c.src=null,b[fb]=null)):a.Vb()}}}function nb(a){return a in gb?gb[a]:gb[a]='on'+a}function rb(a,b,c,d){var f=!0;if((a=G(a))&&(b=a.J[b.toString()]))for(b=b.concat(),a=0;a<b.length;a++){var g=b[a];g&&g.capture==c&&!g.Sa&&(g=sb(g,d),f=f&&!1!==g)}return f}function sb(a,b){var c=a.listener,d=a.Ob||a.src;return a.Eb&&qb(a),c.call(d,b)}function ob(a,b){if(a.Sa)return!0;if(!Xa){var c=b||m('window.event');b=new E(c,this);var d=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(k){f=!0}(f||void 0==c.returnValue)&&(c.returnValue=!0)}for(c=[],f=b.currentTarget;f;f=f.parentNode)c.push(f);for(a=a.type,f=c.length-1;!b.Ea&&0<=f;f--){b.currentTarget=c[f];var g=rb(c[f],a,!0,b);d=d&&g}for(f=0;!b.Ea&&f<c.length;f++)b.currentTarget=c[f],g=rb(c[f],a,!1,b),d=d&&g}return d}return sb(a,new E(b,this))}function G(a){return a=a[fb],a instanceof db?a:null}function kb(a){return q(a)?a:(a[tb]||(a[tb]=function(b){return a.handleEvent(b)}),a[tb])}function H(){z.call(this),this.ka=new db(this),this.Pe=this,this.Uc=null}function vb(a,b){this.Sf=100,this.ef=a,this.ug=b,this.Zb=0,this.Pb=null}function I(){this.lc=this.Va=null}function wb(){this.next=this.scope=this.Gc=null}function yb(a){h.setTimeout(function(){throw a},0)}function Ab(){var a=h.MessageChannel;if('undefined'==typeof a&&'undefined'!=typeof window&&window.postMessage&&window.addEventListener&&!B('Presto')&&(a=function(){var a=document.createElement('IFRAME');a.style.display='none',a.src='',document.documentElement.appendChild(a);var b=a.contentWindow;a=b.document,a.open(),a.write(''),a.close();var c='callImmediate'+Math.random(),d='file:'==b.location.protocol?'*':b.location.protocol+'//'+b.location.host;a=u(function(a){('*'==d||a.origin==d)&&a.data==c&&this.port1.onmessage()},this),b.addEventListener('message',a,!1),this.port1={},this.port2={postMessage:function(){b.postMessage(c,d)}}}),'undefined'!=typeof a&&!B('Trident')&&!B('MSIE')){var b=new a,c={},d=c;return b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.rd;c.rd=null,a()}},function(a){d.next={rd:a},d=d.next,b.port2.postMessage(0)}}return'undefined'!=typeof document&&'onreadystatechange'in document.createElement('SCRIPT')?function(a){var b=document.createElement('SCRIPT');b.onreadystatechange=function(){b.onreadystatechange=null,b.parentNode.removeChild(b),b=null,a(),a=null},document.documentElement.appendChild(b)}:function(a){h.setTimeout(a,0)}}function Cb(){if(h.Promise&&h.Promise.resolve){var a=h.Promise.resolve(void 0);Bb=function(){a.then(Db)}}else Bb=function(){var a=Db;!q(h.setImmediate)||h.Window&&h.Window.prototype&&!B('Edge')&&h.Window.prototype.setImmediate==h.setImmediate?(zb||(zb=Ab()),zb(a)):h.setImmediate(a)}}function Db(){for(var a;a=Fb.remove();){try{a.Gc.call(a.scope)}catch(b){yb(b)}Fb.wg(a)}Eb=!1}function Gb(a,b){H.call(this),this.Na=a||1,this.wb=b||h,this.nd=u(this.Rg,this),this.ie=w()}function Hb(a,b,c){if(q(a))c&&(a=u(a,c));else if(a&&'function'==typeof a.handleEvent)a=u(a.handleEvent,a);else throw Error('Invalid listener argument');return 2147483647<+b?-1:h.setTimeout(a,b||0)}function Ib(a,b,c){z.call(this),this.Uf=null==c?a:u(a,c),this.Na=b,this.Xe=u(this.fg,this),this.qc=[]}function Jb(a){z.call(this),this.i=a,this.o={}}function J(a,b,c){this.reset(a,b,c,void 0,void 0)}function Mb(a){this.pe=a,this.Zd=this.uc=this.mb=this.$b=null}function K(a,b){this.name=a,this.value=b}function Vb(a){Tb||(Tb=new Mb(''),Sb['']=Tb,Tb.Ge(Qb));var b;if(!(b=Sb[a])){b=new Mb(a);var c=a.lastIndexOf('.'),d=a.substr(c+1);c=Vb(a.substr(0,c)),c.Qe(d,b),b.Fg(c),Sb[a]=b}return b}function Wb(a,b){a&&a.info(b,void 0)}function L(a,b){a&&a.lf(b)}function Xb(){this.s=Vb('goog.labs.net.webChannel.WebChannelDebug'),this.Wc=!0}function Yb(a){D.call(this,'serverreachability',a)}function N(a){M.dispatchEvent(new Yb(M,a))}function Zb(a,b){D.call(this,'statevent',a),this.stat=b}function O(a){M.dispatchEvent(new Zb(M,a))}function $b(a,b,c){D.call(this,'timingevent',a),this.size=b,this.rtt=c}function ac(a,b,c){M.dispatchEvent(new $b(M,a,b,c))}function P(a,b){if(!q(a))throw Error('Fn must not be null and must be a function');return h.setTimeout(function(){a()},b)}function dc(){}function ec(){}function fc(){D.call(this,'d')}function gc(){D.call(this,'c')}function ic(){}function R(a,b,c,d,f){this.b=a,this.a=b,this.ra=c,this.R=d,this.Xc=f||1,this.Fc=new Jb(this),this.Ua=jc,a=La?125:void 0,this.Vc=new Gb(a),this.A=null,this.S=!1,this.Da=this.pa=this.ua=this.ic=this.qb=this.hd=this.Ga=null,this.ba=[],this.h=null,this.Bb=0,this.I=this.Fa=null,this.w=-1,this.Za=!1,this.Ra=0,this.ac=null,this.lb=this.Ed=this.yc=!1}function kc(a,b){return 0===a?'Non-200 return code ('+b+')':1===a?'XMLHTTP failure (no data)':2===a?'HttpConnection timeout':'Unknown error'}function nc(a){if(a.H&&'function'==typeof a.H)return a.H();if(l(a))return a.split('');if(ca(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Ba(a)}function oc(a,b,c){if(a.forEach&&'function'==typeof a.forEach)a.forEach(b,c);else if(ca(a)||l(a))na(a,b,c);else{if(a.W&&'function'==typeof a.W)var d=a.W();else if(a.H&&'function'==typeof a.H)d=void 0;else if(ca(a)||l(a)){d=[];for(var f=a.length,g=0;g<f;g++)d.push(g)}else d=Ca(a);f=nc(a),g=f.length;for(var k=0;k<g;k++)b.call(c,f[k],d&&d[k],a)}}function S(a){this.D={},this.o=[],this.j=0;var c=arguments.length;if(1<c){if(c%2)throw Error('Uneven number of arguments');for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.addAll(a)}function T(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function qc(a,b){if(a){a=a.split('&');for(var c=0;c<a.length;c++){var d=a[c].indexOf('='),f=null;if(0<=d){var g=a[c].substring(0,d);f=a[c].substring(d+1)}else g=a[c];b(g,f?decodeURIComponent(f.replace(/\+/g,' ')):'')}}}function U(a,b){this.xa=this.zb=this.qa='',this.Ca=null,this.ib=this.K='',this.O=this.Qf=!1;var c;a instanceof U?(this.O=void 0===b?a.O:b,this.tb(a.qa),this.cd(a.zb),this.rb(a.xa),this.sb(a.Ca),this.ec(a.K),this.bd(a.P.clone()),this.$c(a.ib)):a&&(c=(a+'').match(pc))?(this.O=!!b,this.tb(c[1]||'',!0),this.cd(c[2]||'',!0),this.rb(c[3]||'',!0),this.sb(c[4]),this.ec(c[5]||'',!0),this.bd(c[6]||'',!0),this.$c(c[7]||'',!0)):(this.O=!!b,this.P=new rc(null,this.O))}function Ac(a){return a instanceof U?a.clone():new U(a,void 0)}function Bc(a,b,c,d){var f=new U(null,void 0);return a&&f.tb(a),b&&f.rb(b),c&&f.sb(c),d&&f.ec(d),f}function yc(a,b){return a?b?decodeURI(a.replace(/%25/g,'%2525')):decodeURIComponent(a):''}function sc(a,b,c){return l(a)?(a=encodeURI(a).replace(b,Cc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,'%$1')),a):null}function Cc(a){return a=a.charCodeAt(0),'%'+(15&a>>4).toString(16)+(15&a).toString(16)}function rc(a,b){this.j=this.m=null,this.ja=a||null,this.O=!!b}function Hc(a,b){this.b=a,this.a=b,this.f=this.A=null,this.bc=!1,this.K=null,this.w=-1,this.Ad=this.na=null}function Ic(){this.od=this.$d=null}function Jc(a){this.D=new S,a&&this.addAll(a)}function Kc(a){var b=typeof a;return'object'==b&&a||'function'==b?'o'+(a[t]||(a[t]=++da)):b.substr(0,1)+a}function Lc(a,b){this.Pc=a,this.map=b,this.context=null}function Mc(a){this.me=a||Nc,h.PerformanceNavigationTiming?(a=h.performance.getEntriesByType('navigation'),a=0<a.length&&('hq'==a[0].nextHopProtocol||'h2'==a[0].nextHopProtocol)):a=!!(h.vc&&h.vc.ke&&h.vc.ke()&&h.vc.ke().nh),this.Xb=a?this.me:1,this.v=null,1<this.Xb&&(this.v=new Jc),this.f=null,this.ba=[]}function Oc(){this.xg=this.rg=void 0}function Pc(){this.jg=new Oc}function Qc(a,b){var c=new Xb;c.debug('TestLoadImage: loading '+a);var d=new Image;d.onload=v(Rc,c,d,'TestLoadImage: loaded',!0,b),d.onerror=v(Rc,c,d,'TestLoadImage: error',!1,b),d.onabort=v(Rc,c,d,'TestLoadImage: abort',!1,b),d.ontimeout=v(Rc,c,d,'TestLoadImage: timeout',!1,b),h.setTimeout(function(){d.ontimeout&&d.ontimeout()},1E4),d.src=a}function Rc(a,b,c,d,f){try{a.debug(c),b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,f(d)}catch(g){a.cb(g)}}function V(a){H.call(this),this.headers=new S,this.Xa=a||null,this.ha=!1,this.mc=this.c=null,this.ge=this.Tb='',this.Pa=0,this.I='',this.Aa=this.Lc=this.Qb=this.Ec=!1,this.vb=0,this.hc=null,this.Ae=Tc,this.jc=this.lg=this.Ab=!1}function Wc(a){return C&&Ta(9)&&'number'==typeof a.timeout&&void 0!==a.ontimeout}function qa(a){return'content-type'==a.toLowerCase()}function Xc(a,b){return{type:b,lengthComputable:a.lengthComputable,loaded:a.loaded,total:a.total}}function Yc(a){var b='';return Aa(a,function(a,d){b+=d,b+=':',b+=a,b+='\r\n'}),b}function Zc(a,b,c){a:{for(d in c){var d=!1;break a}d=!0}if(d)return a;if(c=Yc(c),l(a)){if(b=encodeURIComponent(b+''),c=null==c?'':'='+encodeURIComponent(c+''),b+=c){if(c=a.indexOf('#'),0>c&&(c=a.length),d=a.indexOf('?'),0>d||d>c){d=c;var f=''}else f=a.substring(d+1,c);a=[a.substr(0,d),f,a.substr(c)],c=a[1],a[1]=b?c?c+'&'+b:b:c,a=a[0]+(a[1]?'?'+a[1]:'')+a[2]}return a}return a.l(b,c),a}function $c(a){this.Bd=22,this.De=0,this.M=[],this.a=new Xb,this.Ib=new Ic,this.na=this.md=this.hb=this.K=this.u=this.Kc=this.aa=this.gb=this.N=this.Rb=this.A=null,this.Te=!0,this.ag=this.Yb=0,this.kf=!!m('internalChannelParams.failFast',a),this.fd=this.Ja=this.wa=this.ia=this.ea=this.i=null,this.Se=!0,this.w=this.he=this.Sb=-1,this.rc=this.Ha=this.La=0,this.Ve=m('internalChannelParams.baseRetryDelayMs',a)||5E3,this.vg=m('internalChannelParams.retryDelaySeedMs',a)||1E4,this.nf=m('internalChannelParams.forwardChannelMaxRetries',a)||2,this.Od=m('internalChannelParams.forwardChannelRequestTimeoutMs',a)||2E4,this.Xa=a&&a.oh||void 0,this.Db=void 0,this.Ra=0,this.gc=a&&a.supportsCrossDomainXhr||!1,this.ra='',this.G=new Mc(a&&a.concurrentRequestLimit),this.kc=new Pc,this.ta=a&&void 0!==a.backgroundChannelTest?a.backgroundChannelTest:!0,(this.Nd=a&&a.fastHandshake||!1)&&!this.ta&&(this.a.T('Force backgroundChannelTest when fastHandshake is enabled.'),this.ta=!0),a&&a.Id&&this.a.Id()}function ad(){}function bd(){for(var b=arguments[0],c=1,d;c<arguments.length;c++)if(d=arguments[c],0==d.lastIndexOf('/',0))b=d;else{var f;(f=''==b)||(f=b.length-1,f=0<=f&&b.indexOf('/',f)==f),b=f?b+d:b+('/'+d)}return b}function cd(){if(C&&!(10<=+Ua))throw Error('Environmental error: no available transport.')}function W(a,b){H.call(this),this.b=new $c(b),this.yb=a,this.Qg=b&&b.testUrl?b.testUrl:bd(this.yb,'test'),this.s=Vb('goog.labs.net.webChannel.WebChannelBaseTransport'),this.Rc=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a['X-Client-Protocol']='webchannel':a={"X-Client-Protocol":'webchannel'}),this.b.ga(a),a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a['X-WebChannel-Content-Type']=b.messageContentType:a={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.zd&&(a?a['X-WebChannel-Client-Profile']=b.zd:a={"X-WebChannel-Client-Profile":b.zd}),this.b.Eg(a),(a=b&&b.httpHeadersOverwriteParam)&&!va(a)&&this.b.Cg(a),this.Og=b&&b.supportsCrossDomainXhr||!1,this.zg=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!va(b)&&(this.b.Dg(b),a=this.Rc,null!==a&&b in a&&(a=this.Rc,b in a&&delete a[b],(a=this.s)&&a.T('Ignore httpSessionIdParam also specified with messageUrlParams: '+b,void 0))),this.vd=new X(this)}function dd(a){fc.call(this);var b=a.__sm__;if(b){a:{for(var c in b){a=c;break a}a=void 0}(this.ne=a)&&(a=this.ne,b=null!==b&&a in b?b[a]:void 0),this.data=b}else this.data=a}function ed(a){gc.call(this),this.status=1,this.errorCode=a}function X(a){this.b=a}function gd(){this.V=[],this.Z=[]}function hd(a,b){if(z.call(this),this.oe=a||0,this.Wb=b||10,this.oe>this.Wb)throw Error(id);this.fa=new gd,this.oa=new Jc,this.Ac=0,this.Nc=null,this.Cb()}function jd(a,b){this.fe=a,this.gd=b}function kd(a){this.Y=[],a&&this.Lf(a)}function ld(){kd.call(this)}function Y(a,b){this.Gd=void 0,this.cc=new ld,hd.call(this,a,b)}function Z(a,b,c,d){this.Jf=a,this.Ab=!!d,Y.call(this,b,c)}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0}),__webpack_require__.d(__webpack_exports__,'createWebChannelTransport',function(){return src_1}),__webpack_require__.d(__webpack_exports__,'ErrorCode',function(){return src_2}),__webpack_require__.d(__webpack_exports__,'EventType',function(){return src_3}),__webpack_require__.d(__webpack_exports__,'WebChannel',function(){return src_4}),__webpack_require__.d(__webpack_exports__,'XhrIoPool',function(){return src_5});var commonjsGlobal='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,goog=goog||{},h=commonjsGlobal,t='closure_uid_'+(1E9*Math.random()>>>0),da=0,w=Date.now||function(){return+new Date},e;x(y,Error),y.prototype.name='CustomError',x(ha,y),ha.prototype.name='AssertionError';var ja=0,ka={};z.prototype.Ka=!1,z.prototype.bb=function(){if(!this.Ka&&(this.Ka=!0,this.F(),0!=ja)){var a=this[t]||(this[t]=++da);if(0!=ja)throw Error(this+' did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass\' method.');delete ka[a]}},z.prototype.F=function(){if(this.Qa)for(;this.Qa.length;)this.Qa.shift()()};var la=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if(l(a))return l(b)&&1==b.length?a.indexOf(b,0):-1;for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ma=Array.prototype.lastIndexOf?function(a,b){return Array.prototype.lastIndexOf.call(a,b,a.length-1)}:function(a,b){var c=a.length-1;if(0>c&&(c=_Mathmax2(0,a.length+c)),l(a))return l(b)&&1==b.length?a.lastIndexOf(b,c):-1;for(;0<=c;c--)if(c in a&&a[c]===b)return c;return-1},na=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=l(a)?a.split(''):a,g=0;g<d;g++)g in f&&b.call(c,f[g],g,a)},oa=Array.prototype.some?function(a,b){return Array.prototype.some.call(a,b,void 0)}:function(a,b){for(var c=a.length,d=l(a)?a.split(''):a,f=0;f<c;f++)if(f in d&&b.call(void 0,d[f],f,a))return!0;return!1},wa=String.prototype.trim?function(a){return a.trim()}:function(a){return /^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]},A;a:{var ya=h.navigator;if(ya){var za=ya.userAgent;if(za){A=za;break a}}A=''}var Ea='constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf'.split(' ');Ga[' ']=aa;var Ja=B('Opera'),C=B('Trident')||B('MSIE'),Ka=B('Edge'),La=Ka||C,Ma=B('Gecko')&&(-1==A.toLowerCase().indexOf('webkit')||B('Edge'))&&!(B('Trident')||B('MSIE'))&&!B('Edge'),Na=-1!=A.toLowerCase().indexOf('webkit')&&!B('Edge'),Pa;a:{var Qa='',Ra=function(){var a=A;return Ma?/rv:([^\);]+)(\)|;)/.exec(a):Ka?/Edge\/([\d\.]+)/.exec(a):C?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):Na?/WebKit\/(\S+)/.exec(a):Ja?/(?:Version)[ \/]?(\S+)/.exec(a):void 0}();if(Ra&&(Qa=Ra?Ra[1]:''),C){var Sa=Oa();if(null!=Sa&&Sa>parseFloat(Qa)){Pa=Sa+'';break a}}Pa=Qa}var Ia={},Va=h.document,Ua;Ua=Va&&C?Oa()||('CSS1Compat'==Va.compatMode?parseInt(Pa,10):5):void 0;var Wa=Object.freeze||function(a){return a},Xa=!C||9<=+Ua,Ya=C&&!Ta('9'),Za=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},'passive',{get:function(){a=!0}});try{h.addEventListener('test',aa,b),h.removeEventListener('test',aa,b)}catch(c){}return a}();D.prototype.stopPropagation=function(){this.Ea=!0},D.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Be=!1},x(E,D);var $a=Wa({2:'touch',3:'pen',4:'mouse'});E.prototype.Kf=function(a,b){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.currentTarget=b,!(b=a.relatedTarget))'mouseover'==c?b=a.fromElement:'mouseout'==c&&(b=a.toElement);else if(Ma){a:{try{Ga(b.nodeName);var f=!0;break a}catch(g){}f=!1}f||(b=null)}this.relatedTarget=b,null===d?(this.offsetX=Na||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=Na||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0===a.clientX?a.pageX:a.clientX,this.clientY=void 0===a.clientY?a.pageY:a.clientY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0===d.clientX?d.pageX:d.clientX,this.clientY=void 0===d.clientY?d.pageY:d.clientY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=a.button,this.keyCode=a.keyCode||0,this.key=a.key||'',this.charCode=a.charCode||('keypress'==c?a.keyCode:0),this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=l(a.pointerType)?a.pointerType:$a[a.pointerType]||'',this.state=a.state,this.fb=a,a.defaultPrevented&&this.preventDefault()},E.prototype.stopPropagation=function(){E.L.stopPropagation.call(this),this.fb.stopPropagation?this.fb.stopPropagation():this.fb.cancelBubble=!0},E.prototype.preventDefault=function(){E.L.preventDefault.call(this);var a=this.fb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Ya)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(b){}};var ab='closure_listenable_'+(0|1E6*Math.random()),bb=0;cb.prototype.Vb=function(){this.Sa=!0,this.Ob=this.src=this.proxy=this.listener=null},e=db.prototype,e.add=function(a,b,c,d,f){var g=a.toString();a=this.J[g],a||(a=this.J[g]=[],this.xb++);var k=eb(a,b,d,f);return-1<k?(b=a[k],c||(b.Eb=!1)):(b=new cb(b,this.src,g,!!d,f),b.Eb=c,a.push(b)),b},e.remove=function(a,b,c,d){if(a=a.toString(),!(a in this.J))return!1;var f=this.J[a];return b=eb(f,b,c,d),!!(-1<b)&&(f[b].Vb(),Array.prototype.splice.call(f,b,1),0==f.length&&(delete this.J[a],this.xb--),!0)},e.ye=function(a){var b=a.type;b in this.J&&sa(this.J[b],a)&&(a.Vb(),0==this.J[b].length&&(delete this.J[b],this.xb--))},e.pb=function(a){a=a&&a.toString();for(var c in this.J)if(!a||c==a){for(var d=this.J[c],f=0;f<d.length;f++)d[f].Vb();delete this.J[c],this.xb--}},e.jb=function(a,b,c,d){a=this.J[a.toString()];var f=-1;return a&&(f=eb(a,b,c,d)),-1<f?a[f]:null};var fb='closure_lm_'+(0|1E6*Math.random()),gb={},tb='__closure_events_fn_'+(1E9*Math.random()>>>0);x(H,z),H.prototype[ab]=!0,e=H.prototype,e.addEventListener=function(a,b,c,d){ib(this,a,b,c,d)},e.removeEventListener=function(a,b,c,d){pb(this,a,b,c,d)},e.dispatchEvent=function(a){var c=this.Uc,b;if(c)for(b=[];c;c=c.Uc)b.push(c);c=this.Pe;var d=a.type||a;if(l(a))a=new D(a,c);else if(a instanceof D)a.target=a.target||c;else{var f=a;a=new D(d,c),Fa(a,f)}if(f=!0,b)for(var g=b.length-1,k;!a.Ea&&0<=g;g--)k=a.currentTarget=b[g],f=k.Lb(d,!0,a)&&f;if(a.Ea||(k=a.currentTarget=c,f=k.Lb(d,!0,a)&&f,a.Ea||(f=k.Lb(d,!1,a)&&f)),b)for(g=0;!a.Ea&&g<b.length;g++)k=a.currentTarget=b[g],f=k.Lb(d,!1,a)&&f;return f},e.F=function(){H.L.F.call(this),this.pg(),this.Uc=null},e.nb=function(a,b,c,d){return this.ka.add(a+'',b,!1,c,d)},e.Oc=function(a,b,c,d){return this.ka.add(a+'',b,!0,c,d)},e.ed=function(a,b,c,d){this.ka.remove(a+'',b,c,d)},e.Le=function(a){this.ka.ye(a)},e.pg=function(){this.ka&&this.ka.pb(void 0)},e.Lb=function(a,b,c){if(a=this.ka.J[a+''],!a)return!0;a=a.concat();for(var d=!0,f=0,g;f<a.length;++f)if(g=a[f],g&&!g.Sa&&g.capture==b){var k=g.listener,p=g.Ob||g.src;g.Eb&&this.Le(g),d=!1!==k.call(p,c)&&d}return d&&0!=c.Be},e.jb=function(a,b,c,d){return this.ka.jb(a+'',b,c,d)};var ub=h.JSON.stringify;vb.prototype.get=function(){if(0<this.Zb){this.Zb--;var a=this.Pb;this.Pb=a.next,a.next=null}else a=this.ef();return a},vb.prototype.put=function(a){this.ug(a),this.Zb<this.Sf&&(this.Zb++,a.next=this.Pb,this.Pb=a)};var xb=new vb(function(){return new wb},function(a){a.reset()});I.prototype.add=function(a,b){var c=this.Af();c.set(a,b),this.lc?this.lc.next=c:this.Va=c,this.lc=c},I.prototype.remove=function(){var a=null;return this.Va&&(a=this.Va,this.Va=this.Va.next,this.Va||(this.lc=null),a.next=null),a},I.prototype.wg=function(a){xb.put(a)},I.prototype.Af=function(){return xb.get()},wb.prototype.set=function(a,b){this.Gc=a,this.scope=b,this.next=null},wb.prototype.reset=function(){this.next=this.scope=this.Gc=null};var Eb=!1,Fb=new I,zb,Bb;x(Gb,H),e=Gb.prototype,e.enabled=!1,e.B=null,e.setInterval=function(a){this.Na=a,this.B&&this.enabled?(this.stop(),this.start()):this.B&&this.stop()},e.Rg=function(){if(this.enabled){var a=w()-this.ie;0<a&&a<.8*this.Na?this.B=this.wb.setTimeout(this.nd,this.Na-a):(this.B&&(this.wb.clearTimeout(this.B),this.B=null),this.ff(),this.enabled&&(this.stop(),this.start()))}},e.ff=function(){this.dispatchEvent('tick')},e.start=function(){this.enabled=!0,this.B||(this.B=this.wb.setTimeout(this.nd,this.Na),this.ie=w())},e.stop=function(){this.enabled=!1,this.B&&(this.wb.clearTimeout(this.B),this.B=null)},e.F=function(){Gb.L.F.call(this),this.stop(),delete this.wb},x(Ib,z),e=Ib.prototype,e.Ta=!1,e.ob=0,e.B=null,e.mf=function(){this.qc=arguments,this.B||this.ob?this.Ta=!0:this.Cc()},e.stop=function(){this.B&&(h.clearTimeout(this.B),this.B=null,this.Ta=!1,this.qc=[])},e.pause=function(){this.ob++},e.resume=function(){this.ob--,this.ob||!this.Ta||this.B||(this.Ta=!1,this.Cc())},e.F=function(){Ib.L.F.call(this),this.stop()},e.fg=function(){this.B=null,this.Ta&&!this.ob&&(this.Ta=!1,this.Cc())},e.Cc=function(){this.B=Hb(this.Xe,this.Na),this.Uf.apply(null,this.qc)},x(Jb,z);var Kb=[];e=Jb.prototype,e.nb=function(a,b,c,d){return this.Tf(a,b,c,d)},e.Tf=function(a,b,c,d){n(b)||(b&&(Kb[0]=b.toString()),b=Kb);for(var f=0,g;f<b.length&&(g=ib(a,b[f],c||this.handleEvent,d||!1,this.i||this),!!g);f++)this.o[g.key]=g;return this},e.Oc=function(a,b,c,d){return this.je(a,b,c,d)},e.je=function(a,b,c,d,f){if(n(b))for(var g=0;g<b.length;g++)this.je(a,b[g],c,d,f);else{if(a=jb(a,b,c||this.handleEvent,d,f||this.i||this),!a)return this;this.o[a.key]=a}return this},e.ed=function(a,b,c,d,f){if(n(b))for(var g=0;g<b.length;g++)this.ed(a,b[g],c,d,f);else c=c||this.handleEvent,d=r(d)?!!d.capture:!!d,f=f||this.i||this,c=kb(c),d=!!d,b=F(a)?a.jb(b,c,d,f):a?(a=G(a))?a.jb(b,c,d,f):null:null,b&&(qb(b),delete this.o[b.key])},e.pb=function(){Aa(this.o,function(a,b){this.o.hasOwnProperty(b)&&qb(a)},this),this.o={}},e.F=function(){Jb.L.F.call(this),this.pb()},e.handleEvent=function(){throw Error('EventHandler.handleEvent not implemented')},J.prototype.Md=null,J.prototype.reset=function(a){this.mb=a,delete this.Md},J.prototype.Bg=function(a){this.Md=a},J.prototype.Ge=function(a){this.mb=a},K.prototype.toString=function(){return this.name};var Nb=new K('SEVERE',1E3),Ob=new K('WARNING',900),Pb=new K('INFO',800),Qb=new K('CONFIG',700),Rb=new K('FINE',500);e=Mb.prototype,e.getName=function(){return this.pe},e.getParent=function(){return this.$b},e.pf=function(){return this.uc||(this.uc={}),this.uc},e.Ge=function(a){this.mb=a},e.Qd=function(){return this.mb?this.mb:this.$b?this.$b.Qd():(ia('Root logger has no level set.'),null)},e.Pf=function(a){return a.value>=this.Qd().value},e.log=function(a,b,c){this.Pf(a)&&(q(b)&&(b=b()),this.gf(this.uf(a,b,c)))},e.uf=function(a,b,c){return a=new J(a,b+'',this.pe),c&&a.Bg(c),a},e.ca=function(a,b){this.log(Nb,a,b)},e.T=function(a,b){this.log(Ob,a,b)},e.info=function(a,b){this.log(Pb,a,b)},e.lf=function(a){this.log(Rb,a,void 0)},e.gf=function(a){for(var b=this;b;)b.We(a),b=b.getParent()},e.We=function(a){if(this.Zd)for(var b=0,c;c=this.Zd[b];b++)c(a)},e.Fg=function(a){this.$b=a},e.Qe=function(a,b){this.pf()[a]=b};var Sb={},Tb=null;e=Xb.prototype,e.Id=function(){this.Wc=!1},e.Tg=function(a,b,c,d,f){var g=this;this.info(function(){return'XMLHTTP REQ ('+c+') [attempt '+d+']: '+a+'\n'+b+'\n'+g.Xf(f)})},e.Ug=function(a,b,c,d,f,g){this.info(function(){return'XMLHTTP RESP ('+c+') [ attempt '+d+']: '+a+'\n'+b+'\n'+f+' '+g})},e.Wa=function(a,b,c){var d=this;this.info(function(){return'XMLHTTP TEXT ('+a+'): '+d.ng(b)+(c?' '+c:'')})},e.Sg=function(a){this.info(function(){return'TIMEOUT: '+a})},e.debug=function(a){L(this.s,a)},e.cb=function(a,b){var c=this.s;c&&c.ca(b||'Exception',a)},e.info=function(a){Wb(this.s,a)},e.T=function(a){var b=this.s;b&&b.T(a,void 0)},e.ca=function(a){var b=this.s;b&&b.ca(a,void 0)},e.ng=function(a){if(!this.Wc)return a;if(!a)return null;try{var b=JSON.parse(a);if(b)for(var c=0;c<b.length;c++)n(b[c])&&this.Wf(b[c]);return ub(b)}catch(d){return this.debug('Exception parsing expected JS array - probably was not JS'),a}},e.Wf=function(a){if(!(2>a.length||(a=a[1],!n(a)||1>a.length))){var b=a[0];if('noop'!=b&&'stop'!=b&&'close'!=b)for(b=1;b<a.length;b++)a[b]=''}},e.Xf=function(a){if(!this.Wc)return a;if(!a)return null;var b='';a=a.split('&');for(var c=0,d;c<a.length;c++)if(d=a[c].split('='),1<d.length){var f=d[0];d=d[1];var g=f.split('_');b=2<=g.length&&'type'==g[1]?b+(f+'='+d+'&'):b+(f+'=redacted&')}return b};var M=new H;x(Yb,D),x(Zb,D),x($b,D);var bc={NO_ERROR:0,Vg:1,bh:2,ah:3,Yg:4,$g:5,dh:6,Ne:7,TIMEOUT:8,gh:9},cc={Xg:'complete',kh:'success',Oe:'error',Ne:'abort',ih:'ready',jh:'readystatechange',TIMEOUT:'timeout',eh:'incrementaldata',hh:'progress',Zg:'downloadprogress',lh:'uploadprogress'};dc.prototype.pd=null,dc.prototype.Vd=function(){return this.pd||(this.pd=this.Mf())};var Q={OPEN:'a',Wg:'b',Oe:'c',fh:'d'};x(fc,D),x(gc,D);var hc;x(ic,dc),ic.prototype.Dd=function(){var a=this.Wd();return a?new ActiveXObject(a):new XMLHttpRequest},ic.prototype.Mf=function(){var a={};return this.Wd()&&(a[0]=!0,a[1]=!0),a},ic.prototype.Wd=function(){if(!this.be&&'undefined'==typeof XMLHttpRequest&&'undefined'!=typeof ActiveXObject){for(var a=['MSXML2.XMLHTTP.6.0','MSXML2.XMLHTTP.3.0','MSXML2.XMLHTTP','Microsoft.XMLHTTP'],b=0,c;b<a.length;b++){c=a[b];try{return new ActiveXObject(c),this.be=c}catch(d){}}throw Error('Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed')}return this.be},hc=new ic;var jc=45E3,lc={},mc={};e=R.prototype,e.ga=function(a){this.A=a},e.setTimeout=function(a){this.Ua=a},e.He=function(a){this.Ra=a},e.Gg=function(a){this.ba=a},e.la=function(){return this.ba},e.kd=function(a,b){this.ic=1,this.ua=a.clone().Ub(),this.Da=b,this.yc=!0,this.Ce(null)},e.jd=function(a,b,c){this.ic=1,this.ua=a.clone().Ub(),this.Da=null,this.yc=b,this.Ce(c)},e.Ce=function(a){this.qb=w(),this.eb(),this.pa=this.ua.clone(),this.pa.dc('t',this.Xc),this.Bb=0,this.h=this.b.Jb(this.b.fc()?a:null),0<this.Ra&&(this.ac=new Ib(u(this.Me,this,this.h),this.Ra)),this.Fc.nb(this.h,'readystatechange',this.mg),a=this.A?Da(this.A):{},this.Da?(this.Fa||(this.Fa='POST'),a['Content-Type']='application/x-www-form-urlencoded',this.h.send(this.pa,this.Fa,this.Da,a)):(this.Fa='GET',this.h.send(this.pa,this.Fa,null,a)),N(1),this.a.Tg(this.Fa,this.pa,this.R,this.Xc,this.Da)},e.mg=function(a){a=a.target;var b=this.ac;b&&3==a.ma()?(this.a.debug('Throttling readystatechange.'),b.mf()):this.Me(a)},e.Me=function(a){try{a==this.h?this.hg():this.a.T('Called back with an unexpected xmlhttp')}catch(c){if(this.a.debug('Failed call to OnXmlHttpReadyStateChanged_'),this.h&&this.h.ya()){var b=this;this.a.cb(c,function(){return'ResponseText: '+b.h.ya()})}else this.a.cb(c,'No response text')}finally{}},e.hg=function(){var a=this.h.ma(),b=this.h.Ud(),c=this.h.za();if(!(3>a)&&(3!=a||La||this.h.ya())){this.Za||4!=a||7==b||(8==b||0>=c?N(3):N(2)),this.Fb();var d=this.h.za();if(this.w=d,b=this.h.ya(),!b){var f=this;this.a.debug(function(){return'No response text for uri '+f.pa+' status '+d})}if(this.S=200==d,this.a.Ug(this.Fa,this.pa,this.R,this.Xc,a,d),this.S){if(this.Ig())if(c=this.sf())this.a.Wa(this.R,c,'Initial handshake response via X-HTTP-Initial-Response'),this.lb=!0,this.Yc(c);else return this.S=!1,this.I=3,O(12),this.a.T('XMLHTTP Missing X_HTTP_INITIAL_RESPONSE ('+this.R+')'),this.Ia(),void this.Kb();this.yc?(this.Fd(a,b),La&&this.S&&3==a&&this.Ng()):(this.a.Wa(this.R,b,null),this.Yc(b)),4==a&&this.Ia(),this.S&&!this.Za&&(4==a?this.b.Tc(this):(this.S=!1,this.eb()))}else 400==d&&0<b.indexOf('Unknown SID')?(this.I=3,O(12),this.a.T('XMLHTTP Unknown SID ('+this.R+')')):(this.I=0,O(13),this.a.T('XMLHTTP Bad status '+d+' ('+this.R+')')),this.Ia(),this.Kb()}},e.Ig=function(){return this.Ed&&!this.lb},e.sf=function(){if(this.h){var a=this.h.kb('X-HTTP-Initial-Response');if(a&&!va(a))return a}return null},e.Ag=function(){this.Ed=!0},e.Fd=function(a,b){for(var c=!0,d;!this.Za&&this.Bb<b.length;)if(d=this.vf(b),d==mc){4==a&&(this.I=4,O(14),c=!1),this.a.Wa(this.R,null,'[Incomplete Response]');break}else if(d==lc){this.I=4,O(15),this.a.Wa(this.R,b,'[Invalid Chunk]'),c=!1;break}else this.a.Wa(this.R,d,null),this.Yc(d);4==a&&0==b.length&&(this.I=1,O(16),c=!1),this.S=this.S&&c,c||(this.a.Wa(this.R,b,'[Invalid Chunked Response]'),this.Ia(),this.Kb())},e.kg=function(){if(this.h){var a=this.h.ma(),b=this.h.ya();this.Bb<b.length&&(this.Fb(),this.Fd(a,b),this.S&&4!=a&&this.eb())}},e.Ng=function(){this.Fc.nb(this.Vc,'tick',this.kg),this.Vc.start()},e.vf=function(a){var b=this.Bb,c=a.indexOf('\n',b);return-1==c?mc:(b=+a.substring(b,c),isNaN(b))?lc:(c+=1,c+b>a.length)?mc:(a=a.substr(c,b),this.Bb=c+b,a)},e.yg=function(a){this.ic=2,this.ua=a.clone().Ub(),a=!1,h.navigator&&h.navigator.sendBeacon&&(a=h.navigator.sendBeacon(this.ua.toString(),'')),!a&&h.Image&&(new Image().src=this.ua,a=!0),a||(this.h=this.b.Jb(null),this.h.send(this.ua)),this.qb=w(),this.eb()},e.cancel=function(){this.Za=!0,this.Ia()},e.tg=function(a){a&&this.setTimeout(a),this.Ga&&(this.Fb(),this.eb())},e.eb=function(){this.hd=w()+this.Ua,this.Ke(this.Ua)},e.Ke=function(a){if(null!=this.Ga)throw Error('WatchDog timer not null');this.Ga=P(u(this.gg,this),a)},e.Fb=function(){this.Ga&&(h.clearTimeout(this.Ga),this.Ga=null)},e.gg=function(){this.Ga=null;var a=w();0<=a-this.hd?this.Df():(this.a.T('WatchDog timer called too early'),this.Ke(this.hd-a))},e.Df=function(){this.S&&this.a.ca('Received watchdog timeout even though request loaded successfully'),this.a.Sg(this.pa),2!=this.ic&&(N(3),O(17)),this.Ia(),this.I=2,this.Kb()},e.Kb=function(){this.b.de()||this.Za||this.b.Tc(this)},e.Ia=function(){this.Fb();var a=this.ac;a&&'function'==typeof a.bb&&a.bb(),this.ac=null,this.Vc.stop(),this.Fc.pb(),this.h&&(a=this.h,this.h=null,a.abort(),a.bb())},e.Hc=function(){return this.I},e.Yc=function(a){try{this.b.ue(this,a),N(4)}catch(b){this.a.cb(b,'Error in httprequest callback')}},e=S.prototype,e.C=function(){return this.j},e.H=function(){this.wc();for(var a=[],b=0;b<this.o.length;b++)a.push(this.D[this.o[b]]);return a},e.W=function(){return this.wc(),this.o.concat()},e.va=function(a){return T(this.D,a)},e.X=function(){return 0==this.j},e.clear=function(){this.D={},this.j=this.o.length=0},e.remove=function(a){return!!T(this.D,a)&&(delete this.D[a],this.j--,this.o.length>2*this.j&&this.wc(),!0)},e.wc=function(){if(this.j!=this.o.length){for(var a=0,b=0,c;a<this.o.length;)c=this.o[a],T(this.D,c)&&(this.o[b++]=c),a++;this.o.length=b}if(this.j!=this.o.length){var d={};for(b=a=0;a<this.o.length;)c=this.o[a],T(d,c)||(this.o[b++]=c,d[c]=1),a++;this.o.length=b}},e.get=function(a,b){return T(this.D,a)?this.D[a]:b},e.set=function(a,b){T(this.D,a)||(this.j++,this.o.push(a)),this.D[a]=b},e.addAll=function(a){if(a instanceof S)for(var b=a.W(),c=0;c<b.length;c++)this.set(b[c],a.get(b[c]));else for(b in a)this.set(b,a[b])},e.forEach=function(a,b){for(var c=this.W(),d=0;d<c.length;d++){var f=c[d],g=this.get(f);a.call(b,g,f,this)}},e.clone=function(){return new S(this)};var pc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;e=U.prototype,e.toString=function(){var a=[],b=this.qa;b&&a.push(sc(b,tc,!0),':');var c=this.xa;return(c||'file'==b)&&(a.push('//'),(b=this.zb)&&a.push(sc(b,tc,!0),'@'),a.push(encodeURIComponent(c+'').replace(/%25([0-9a-fA-F]{2})/g,'%$1')),c=this.Ca,null!=c&&a.push(':',c+'')),(c=this.K)&&(this.Ic()&&'/'!=c.charAt(0)&&a.push('/'),a.push(sc(c,'/'==c.charAt(0)?uc:wc,!0))),(c=this.Rd())&&a.push('?',c),(c=this.ib)&&a.push('#',sc(c,xc)),a.join('')},e.resolve=function(a){var b=this.clone(),c=a.Hf();c?b.tb(a.qa):c=a.If(),c?b.cd(a.zb):c=a.Ic(),c?b.rb(a.xa):c=a.Ff();var d=a.K;if(c)b.sb(a.Ca);else if(c=a.ae()){if('/'!=d.charAt(0))if(this.Ic()&&!this.ae())d='/'+d;else{var f=b.K.lastIndexOf('/');-1!=f&&(d=b.K.substr(0,f+1)+d)}if(f=d,'..'==f||'.'==f)d='';else if(-1!=f.indexOf('./')||-1!=f.indexOf('/.')){d=0==f.lastIndexOf('/',0),f=f.split('/');for(var g=[],k=0,p;k<f.length;)p=f[k++],'.'==p?d&&k==f.length&&g.push(''):'..'==p?((1<g.length||1==g.length&&''!=g[0])&&g.pop(),d&&k==f.length&&g.push('')):(g.push(p),d=!0);d=g.join('/')}else d=f}return c?b.ec(d):c=a.Gf(),c?b.bd(a.P.clone()):c=a.Ef(),c&&b.$c(a.ib),b},e.clone=function(){return new U(this)},e.tb=function(a,b){this.U(),(this.qa=b?yc(a,!0):a)&&(this.qa=this.qa.replace(/:$/,''))},e.Hf=function(){return!!this.qa},e.cd=function(a,b){this.U(),this.zb=b?yc(a):a},e.If=function(){return!!this.zb},e.rb=function(a,b){this.U(),this.xa=b?yc(a,!0):a},e.Ic=function(){return!!this.xa},e.sb=function(a){if(this.U(),a){if(a=+a,isNaN(a)||0>a)throw Error('Bad port number '+a);this.Ca=a}else this.Ca=null},e.Ff=function(){return null!=this.Ca},e.ec=function(a,b){this.U(),this.K=b?yc(a,!0):a},e.ae=function(){return!!this.K},e.Gf=function(){return''!==this.P.toString()},e.bd=function(a,b){this.U(),a instanceof rc?(this.P=a,this.P.ad(this.O)):(b||(a=sc(a,zc)),this.P=new rc(a,this.O))},e.Rd=function(){return this.P.toString()},e.getQuery=function(){return this.Rd()},e.l=function(a,b){this.U(),this.P.set(a,b)},e.dc=function(a,b){this.U(),n(b)||(b=[b+'']),this.P.Ie(a,b)},e.$c=function(a,b){this.U(),this.ib=b?yc(a):a},e.Ef=function(){return!!this.ib},e.Ub=function(){return this.U(),this.l('zx',_Mathfloor2(2147483648*Math.random()).toString(36)+Math.abs(_Mathfloor2(2147483648*Math.random())^w()).toString(36)),this},e.removeParameter=function(a){return this.U(),this.P.remove(a),this},e.U=function(){if(this.Qf)throw Error('Tried to modify a read-only Uri')},e.ad=function(a){this.O=a,this.P&&this.P.ad(a)};var tc=/[#\/\?@]/g,wc=/[#\?:]/g,uc=/[#\?]/g,zc=/[#\?@]/g,xc=/#/g;e=rc.prototype,e.$=function(){if(!this.m&&(this.m=new S,this.j=0,this.ja)){var a=this;qc(this.ja,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g,' ')),c)})}},e.C=function(){return this.$(),this.j},e.add=function(a,b){this.$(),this.Oa(),a=this.Ma(a);var c=this.m.get(a);return c||this.m.set(a,c=[]),c.push(b),this.j+=1,this},e.remove=function(a){return this.$(),a=this.Ma(a),!!this.m.va(a)&&(this.Oa(),this.j-=this.m.get(a).length,this.m.remove(a))},e.clear=function(){this.Oa(),this.m=null,this.j=0},e.X=function(){return this.$(),0==this.j},e.va=function(a){return this.$(),a=this.Ma(a),this.m.va(a)},e.forEach=function(a,b){this.$(),this.m.forEach(function(c,d){na(c,function(c){a.call(b,c,d,this)},this)},this)},e.W=function(){this.$();for(var a=this.m.H(),b=this.m.W(),c=[],d=0;d<b.length;d++)for(var f=a[d],g=0;g<f.length;g++)c.push(b[d]);return c},e.H=function(a){this.$();var b=[];if(l(a))this.va(a)&&(b=ta(b,this.m.get(this.Ma(a))));else{a=this.m.H();for(var c=0;c<a.length;c++)b=ta(b,a[c])}return b},e.set=function(a,b){return this.$(),this.Oa(),a=this.Ma(a),this.va(a)&&(this.j-=this.m.get(a).length),this.m.set(a,[b]),this.j+=1,this},e.get=function(a,b){return a?(a=this.H(a),0<a.length?a[0]+'':b):b},e.Ie=function(a,b){this.remove(a),0<b.length&&(this.Oa(),this.m.set(this.Ma(a),ua(b)),this.j+=b.length)},e.toString=function(){if(this.ja)return this.ja;if(!this.m)return'';for(var a=[],b=this.m.W(),c=0;c<b.length;c++){var d=b[c],f=encodeURIComponent(d+'');d=this.H(d);for(var g=0,k;g<d.length;g++)k=f,''!==d[g]&&(k+='='+encodeURIComponent(d[g]+'')),a.push(k)}return this.ja=a.join('&')},e.Oa=function(){this.ja=null},e.clone=function(){var a=new rc;return a.ja=this.ja,this.m&&(a.m=this.m.clone(),a.j=this.j),a},e.Ma=function(a){return a+='',this.O&&(a=a.toLowerCase()),a},e.ad=function(a){a&&!this.O&&(this.$(),this.Oa(),this.m.forEach(function(a,c){var b=c.toLowerCase();c!=b&&(this.remove(c),this.Ie(b,a))},this)),this.O=a},e.extend=function(){for(var b=0;b<arguments.length;b++)oc(arguments[b],function(a,b){this.add(b,a)},this)},x(function Gc(){},function Fc(){}),e=Hc.prototype,e.g=null,e.ga=function(a){this.A=a},e.connect=function(a){this.K=a,a=this.b.Sd(this.K),O(3);var b=this.b.Ib.$d;null==b?(a.dc('MODE','init'),!this.b.ta&&this.b.aa&&a.dc('X-HTTP-Session-Id',this.b.aa),this.f=new R(this,this.a,void 0,void 0,void 0),this.f.ga(this.A),this.f.jd(a,!1,null),this.g=0):(this.na=this.b.$a(b[0]),this.g=1,this.xd())},e.xd=function(){this.a.debug('TestConnection: starting stage 2');var a=this.b.Ib.od;if(null!=a)this.a.debug(function(){return'Buffered'}),O(4),a?(O(10),this.b.ub(this,!1)):(O(11),this.b.ub(this,!0));else{this.f=new R(this,this.a,void 0,void 0,void 0),this.f.ga(this.A);var b=this.b.Pd(this.na,this.K);O(4),b.dc('TYPE','xmlhttp');var c=this.b.aa,d=this.b.Kc;c&&d&&b.l(c,d),this.f.jd(b,!1,this.na)}},e.Jb=function(a){return this.b.Jb(a)},e.abort=function(){this.f&&(this.f.cancel(),this.f=null),this.w=-1},e.de=function(){return!1},e.ue=function(a,b){if(this.w=a.w,0!=this.g)1==this.g&&(this.bc?O(6):'11111'==b?(O(5),this.bc=!0,this.Ze()&&(this.w=200,this.f.cancel(),this.a.debug('Test connection succeeded; using streaming connection'),O(11),this.b.ub(this,!0))):(O(7),this.bc=!1));else if(this.a.debug('TestConnection: Got data for stage 1'),this.pc(a),b){try{var c=this.b.kc.zc(b)}catch(d){return this.a.cb(d),void this.b.dd(this)}this.na=this.b.$a(c[0])}else this.a.debug('TestConnection: Null responseText'),this.b.dd(this)},e.Tc=function(){this.w=this.f.w,this.f.S?0==this.g?(this.g=1,this.a.debug('TestConnection: request complete for initial check'),this.xd()):1==this.g&&(this.a.debug('TestConnection: request complete for stage 2'),this.bc?(this.a.debug('Test connection succeeded; using streaming connection'),O(11),this.b.ub(this,!0)):(this.a.debug('Test connection failed; not using streaming'),O(10),this.b.ub(this,!1))):(this.a.debug('TestConnection: request failed, in state '+this.g),0==this.g?O(8):1==this.g&&O(9),this.b.dd(this))},e.pc=function(a){if(!this.b.ta&&(a=a.h)){var b=a.kb('X-Client-Wire-Protocol');this.Ad=b?b:null,this.b.aa&&((a=a.kb('X-HTTP-Session-Id'))?this.b.Fe(a):this.a.T('Missing X_HTTP_SESSION_ID in the handshake response'))}},e.fc=function(){return this.b.fc()},e.Ba=function(){return this.b.Ba()},e.Ze=function(){return!C||10<=+Ua},e=Jc.prototype,e.C=function(){return this.D.C()},e.add=function(a){this.D.set(Kc(a),a)},e.addAll=function(a){a=nc(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])},e.pb=function(a){a=nc(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])},e.remove=function(a){return this.D.remove(Kc(a))},e.clear=function(){this.D.clear()},e.X=function(){return this.D.X()},e.contains=function(a){return this.D.va(Kc(a))},e.H=function(){return this.D.H()},e.clone=function(){return new Jc(this)};var Nc=10;e=Mc.prototype,e.ld=function(a){this.v||-1==a.indexOf('spdy')&&-1==a.indexOf('quic')&&-1==a.indexOf('h2')||(this.Xb=this.me,this.v=new Jc,this.f&&(this.oc(this.f),this.f=null))},e.ee=function(){return!!this.f||!!this.v&&this.v.C()>=this.Xb},e.xf=function(){return this.f?1:this.v?this.v.C():0},e.Jc=function(a){return this.f?this.f==a:!!this.v&&this.v.contains(a)},e.oc=function(a){this.v?this.v.add(a):this.f=a},e.ze=function(a){this.f&&this.f==a?this.f=null:this.v&&this.v.contains(a)&&this.v.remove(a)},e.cancel=function(){this.ba=this.la(),this.f?(this.f.cancel(),this.f=null):this.v&&!this.v.X()&&(na(this.v.H(),function(a){a.cancel()}),this.v.clear())},e.la=function(){if(null!=this.f)return this.ba.concat(this.f.la());if(null!=this.v&&!this.v.X()){var a=this.ba;return na(this.v.H(),function(b){a=a.concat(b.la())}),a}return ua(this.ba)},e.Re=function(a){this.ba=this.ba.concat(a)},e.$e=function(){this.ba.length=0},Oc.prototype.stringify=function(a){return h.JSON.stringify(a,this.rg)},Oc.prototype.parse=function(a){return h.JSON.parse(a,this.xg)},Pc.prototype.hf=function(a,b,c){var d=c||'';try{oc(a,function(a,c){var f=a;r(a)&&(f=ub(a)),b.push(d+c+'='+encodeURIComponent(f))})}catch(f){throw b.push(d+'type='+encodeURIComponent('_badmap')),f}},Pc.prototype.jf=function(a,b,c){for(var d=-1,f;;){f=['count='+b],-1==d?0<b?(d=a[0].Pc,f.push('ofs='+d)):d=0:f.push('ofs='+d);for(var g=!0,k=0;k<b;k++){var p=a[k].Pc,Ub=a[k].map;if(p-=d,0>p)d=_Mathmax2(0,a[k].Pc-100),g=!1;else try{this.hf(Ub,f,'req'+p+'_')}catch(md){c&&c(Ub)}}if(g)return f.join('&')}},Pc.prototype.zc=function(a){return this.jg.parse(a)};var Sc=h.JSON.parse;x(V,H);var Tc='';V.prototype.s=Vb('goog.net.XhrIo');var Uc=/^https?$/i,Vc=['POST','PUT'];e=V.prototype,e.Je=function(a){this.Ab=a},e.send=function(a,b,c,d){if(this.c)throw Error('[goog.net.XhrIo] Object is active with another request='+this.Tb+'; newUri='+a);b=b?b.toUpperCase():'GET',this.Tb=a,this.I='',this.Pa=0,this.ge=b,this.Ec=!1,this.ha=!0,this.c=this.df(),this.mc=this.Xa?this.Xa.Vd():hc.Vd(),this.c.onreadystatechange=u(this.te,this),this.lg&&'onprogress'in this.c&&(this.c.onprogress=u(function(a){this.re(a,!0)},this),this.c.upload&&(this.c.upload.onprogress=u(this.re,this)));try{L(this.s,this.da('Opening Xhr')),this.Lc=!0,this.c.open(b,a+'',!0),this.Lc=!1}catch(g){return L(this.s,this.da('Error opening Xhr: '+g.message)),void this.Ld(g)}a=c||'';var f=this.headers.clone();d&&oc(d,function(a,b){f.set(b,a)}),d=pa(f.W()),c=h.FormData&&a instanceof h.FormData,!(0<=la(Vc,b))||d||c||f.set('Content-Type','application/x-www-form-urlencoded;charset=utf-8'),f.forEach(function(a,b){this.c.setRequestHeader(b,a)},this),this.Ae&&(this.c.responseType=this.Ae),'withCredentials'in this.c&&this.c.withCredentials!==this.Ab&&(this.c.withCredentials=this.Ab);try{this.yd(),0<this.vb&&(this.jc=Wc(this.c),L(this.s,this.da('Will abort after '+this.vb+'ms if incomplete, xhr2 '+this.jc)),this.jc?(this.c.timeout=this.vb,this.c.ontimeout=u(this.Ua,this)):this.hc=Hb(this.Ua,this.vb,this)),L(this.s,this.da('Sending request')),this.Qb=!0,this.c.send(a),this.Qb=!1}catch(g){L(this.s,this.da('Send error: '+g.message)),this.Ld(g)}},e.df=function(){return this.Xa?this.Xa.Dd():hc.Dd()},e.Ua=function(){'undefined'!=typeof goog&&this.c&&(this.I='Timed out after '+this.vb+'ms, aborting',this.Pa=8,L(this.s,this.da(this.I)),this.dispatchEvent('timeout'),this.abort(8))},e.Ld=function(a){this.ha=!1,this.c&&(this.Aa=!0,this.c.abort(),this.Aa=!1),this.I=a,this.Pa=5,this.Jd(),this.Gb()},e.Jd=function(){this.Ec||(this.Ec=!0,this.dispatchEvent('complete'),this.dispatchEvent('error'))},e.abort=function(a){this.c&&this.ha&&(L(this.s,this.da('Aborting')),this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1,this.Pa=a||7,this.dispatchEvent('complete'),this.dispatchEvent('abort'),this.Gb())},e.F=function(){this.c&&(this.ha&&(this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1),this.Gb(!0)),V.L.F.call(this)},e.te=function(){this.Ka||(this.Lc||this.Qb||this.Aa?this.se():this.eg())},e.eg=function(){this.se()},e.se=function(){if(this.ha&&'undefined'!=typeof goog)if(this.mc[1]&&4==this.ma()&&2==this.za())L(this.s,this.da('Local request error detected and ignored'));else if(this.Qb&&4==this.ma())Hb(this.te,0,this);else if(this.dispatchEvent('readystatechange'),this.Mc()){L(this.s,this.da('Request complete')),this.ha=!1;try{this.Rf()?(this.dispatchEvent('complete'),this.dispatchEvent('success')):(this.Pa=6,this.I=this.Yd()+' ['+this.za()+']',this.Jd())}finally{this.Gb()}}},e.re=function(a,b){this.dispatchEvent(Xc(a,'progress')),this.dispatchEvent(Xc(a,b?'downloadprogress':'uploadprogress'))},e.Gb=function(a){if(this.c){this.yd();var b=this.c,c=this.mc[0]?aa:null;this.mc=this.c=null,a||this.dispatchEvent('ready');try{b.onreadystatechange=c}catch(d){(a=this.s)&&a.ca('Problem encountered resetting onreadystatechange: '+d.message,void 0)}}},e.yd=function(){this.c&&this.jc&&(this.c.ontimeout=null),this.hc&&(h.clearTimeout(this.hc),this.hc=null)},e.Ba=function(){return!!this.c},e.Mc=function(){return 4==this.ma()},e.Rf=function(){var a=this.za();a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1;}return b||0===a&&!this.Of()},e.Of=function(){var a=(this.Tb+'').match(pc)[1]||null;return!a&&h.self&&h.self.location&&(a=h.self.location.protocol,a=a.substr(0,a.length-1)),Uc.test(a?a.toLowerCase():'')},e.ma=function(){return this.c?this.c.readyState:0},e.za=function(){try{return 2<this.ma()?this.c.status:-1}catch(a){return-1}},e.Yd=function(){try{return 2<this.ma()?this.c.statusText:''}catch(a){return L(this.s,'Can not get status: '+a.message),''}},e.ya=function(){try{return this.c?this.c.responseText:''}catch(a){return L(this.s,'Can not get responseText: '+a.message),''}},e.yf=function(a){if(this.c){var b=this.c.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),Sc(b)}},e.getResponseHeader=function(a){if(this.c&&this.Mc())return a=this.c.getResponseHeader(a),null===a?void 0:a},e.getAllResponseHeaders=function(){return this.c&&this.Mc()?this.c.getAllResponseHeaders()||'':''},e.kb=function(a){return this.c?this.c.getResponseHeader(a):null},e.Ud=function(){return this.Pa},e.Hc=function(){return l(this.I)?this.I:this.I+''},e.da=function(a){return a+' ['+this.ge+' '+this.Tb+' '+this.za()+']'},e=$c.prototype,e.tc=8,e.g=1,e.connect=function(a,b,c,d,f){this.a.debug('connect()'),O(0),this.K=b,this.gb=c||{},d&&void 0!==f&&(this.gb.OSID=d,this.gb.OAID=f),this.ta&&(this.a.debug('connect() bypassed channel-test.'),this.Ib.$d=[],this.Ib.od=!1),this.bf(a)},e.disconnect=function(){if(this.a.debug('disconnect()'),this.qd(),3==this.g){var a=this.Yb++,b=this.hb.clone();b.l('SID',this.ra),b.l('RID',a),b.l('TYPE','terminate'),this.Ya(b),new R(this,this.a,this.ra,a,void 0).yg(b)}this.qe()},e.bf=function(a){this.a.debug('connectTest_()'),this.Ja=new Hc(this,this.a),null===this.N&&this.Ja.ga(this.A);var b=a;this.N&&this.A&&(b=Zc(a,this.N,this.A)),this.Ja.connect(b)},e.af=function(){this.a.debug('connectChannel_()'),this.hb=this.Sd(this.K),this.Dc()},e.qd=function(){this.Ja&&(this.Ja.abort(),this.Ja=null),this.u&&(this.u.cancel(),this.u=null),this.ia&&(h.clearTimeout(this.ia),this.ia=null),this.Hb(),this.G.cancel(),this.ea&&(h.clearTimeout(this.ea),this.ea=null)},e.ga=function(a){this.A=a},e.Eg=function(a){this.Rb=a},e.Cg=function(a){this.N=a},e.Dg=function(a){this.aa=a},e.Fe=function(a){this.Kc=a},e.He=function(a){this.Ra=a},e.Hg=function(){this.gc=!0},e.Ee=function(a){this.i=a},e.Nf=function(){return!this.fd},e.Zc=function(a){1E3==this.M.length&&this.a.ca(function(){return'Already have 1000 queued maps upon queueing '+ub(a)}),this.M.push(new Lc(this.ag++,a)),3==this.g&&this.Dc()},e.qf=function(){return this.kf?0:this.nf},e.de=function(){return 0==this.g},e.getState=function(){return this.g},e.Dc=function(){this.G.ee()||this.ea||(this.ea=P(u(this.we,this),0),this.La=0)},e.Yf=function(a){return this.G.xf()>=this.G.Xb-(this.ea?1:0)?(this.a.ca('Unexpected retry request is scheduled.'),!1):this.ea?(this.a.debug('Use the retry request that is already scheduled.'),this.M=a.la().concat(this.M),!0):1==this.g||2==this.g||this.La>=this.qf()?!1:(this.a.debug('Going to retry POST'),this.ea=P(u(this.we,this,a),this.Xd(this.La)),this.La++,!0)},e.we=function(a){this.ea=null,this.Mg(a)},e.Mg=function(a){this.a.debug('startForwardChannel_'),1==this.g?a?this.a.ca('Not supposed to retry the open'):(this.ig(),this.g=2):3==this.g&&(a?this.le(a):0==this.M.length?this.a.debug('startForwardChannel_ returned: nothing to send'):this.G.ee()?this.a.ca('startForwardChannel_ returned: connection already in progress'):(this.le(),this.a.debug('startForwardChannel_ finished, sent request')))},e.ig=function(){this.a.debug('open_()'),this.Yb=_Mathfloor2(1E5*Math.random());var a=this.Yb++,b=new R(this,this.a,'',a,void 0),c=this.A;this.Rb&&(c?(c=Da(c),Fa(c,this.Rb)):c=this.Rb),null===this.N&&b.ga(c);var d=this.Hd(b),f=this.hb.clone();f.l('RID',a),0<this.Bd&&f.l('CVER',this.Bd),this.ta&&this.aa&&f.l('X-HTTP-Session-Id',this.aa),this.Ya(f),this.N&&c&&Zc(f,this.N,c),this.G.oc(b),this.Nd?(f.l('$req',d),f.l('SID','null'),b.Ag(),b.kd(f,null)):b.kd(f,d)},e.le=function(a){var b=a?a.R:this.Yb++,c=this.hb.clone();c.l('SID',this.ra),c.l('RID',b),c.l('AID',this.Sb),this.Ya(c),this.N&&this.A&&Zc(c,this.N,this.A),b=new R(this,this.a,this.ra,b,this.La+1),null===this.N&&b.ga(this.A),a&&this.sg(a),a=this.Hd(b),b.setTimeout(_Mathround(.5*this.Od)+_Mathround(.5*this.Od*Math.random())),this.G.oc(b),b.kd(c,a)},e.Ya=function(a){this.i&&oc({},function(b,c){a.l(c,b)})},e.Hd=function(a){var b=Math.min(this.M.length,1E3),c=this.i?u(this.i.Ue,this.i,this):null;return c=this.kc.jf(this.M,b,c),a.Gg(this.M.splice(0,b)),c},e.sg=function(a){this.M=a.la().concat(this.M)},e.Kd=function(){if(!this.u&&!this.ia){this.rc=1;var a=this.ve;Bb||Cb(),Eb||(Bb(),Eb=!0),Fb.add(a,this),this.Ha=0}},e.Qc=function(){return this.u||this.ia?(this.a.ca('Request already in progress'),!1):!(3<=this.Ha)&&(this.a.debug('Going to retry GET'),this.rc++,this.ia=P(u(this.ve,this),this.Xd(this.Ha)),this.Ha++,!0)},e.ve=function(){this.ia=null,this.Kg()},e.Kg=function(){this.a.debug('Creating new HttpRequest'),this.u=new R(this,this.a,this.ra,'rpc',this.rc),null===this.N&&this.u.ga(this.A),this.u.He(this.Ra);var a=this.md.clone();a.l('RID','rpc'),a.l('SID',this.ra),a.l('CI',this.fd?'0':'1'),a.l('AID',this.Sb),this.Ya(a),a.l('TYPE','xmlhttp'),this.N&&this.A&&Zc(a,this.N,this.A),this.Db&&this.u.setTimeout(this.Db),this.u.jd(a,!0,this.na),this.a.debug('New Request created')},e.ub=function(a,b){this.a.debug('Test Connection Finished');var c=a.Ad;c&&this.G.ld(c),this.fd=this.Se&&b,this.w=a.w,this.af()},e.dd=function(a){this.a.debug('Test Connection Failed'),this.w=a.w,this.sa(2)},e.ue=function(a,b){if(0!=this.g&&(this.u==a||this.G.Jc(a)))if(this.w=a.w,!a.lb&&this.G.Jc(a)&&3==this.g){try{var c=this.kc.zc(b)}catch(d){c=null}n(c)&&3==c.length?this.Cf(c,a):(this.a.debug('Bad POST response data returned'),this.sa(11))}else(a.lb||this.u==a)&&this.Hb(),va(b)||(c=this.kc.zc(b),this.dg(c,a))},e.Cf=function(a,b){0==a[0]?this.Bf(b):(this.he=a[1],b=this.he-this.Sb,0<b&&(a=a[2],this.a.debug(a+' bytes (in '+b+' arrays) are outstanding on the BackChannel'),this.Jg(a)&&!this.wa&&(this.wa=P(u(this.bg,this),6E3))))},e.Bf=function(a){if(this.a.debug('Server claims our backchannel is missing.'),this.ia)this.a.debug('But we are currently starting the request.');else{if(!this.u)this.a.T('We do not have a BackChannel established');else if(this.u.qb+3E3<a.qb)this.Hb(),this.u.cancel(),this.u=null;else return;this.Qc(),O(18)}},e.Jg=function(a){return 37500>a&&!this.Nf()&&0==this.Ha},e.$a=function(a){return this.Te?this.i?this.i.$a(a):a:null},e.bg=function(){null!=this.wa&&(this.wa=null,this.u.cancel(),this.u=null,this.Qc(),O(19))},e.Hb=function(){null!=this.wa&&(h.clearTimeout(this.wa),this.wa=null)},e.Tc=function(a){this.a.debug('Request complete');var b=null;if(this.u==a){this.Hb(),this.u=null;var c=2}else if(this.G.Jc(a))b=a.la(),this.G.ze(a),c=1;else return;if(this.w=a.w,0!=this.g)if(a.S)1==c?(ac(a.Da?a.Da.length:0,w()-a.qb,this.La),this.Dc()):this.Kd();else{var d=a.Hc();if(3==d||0==d&&0<this.w)this.a.debug('Not retrying due to error type');else{var f=this;if(this.a.debug(function(){return'Maybe retrying, last error: '+kc(d,f.w)}),1==c&&this.Yf(a)||2==c&&this.Qc())return;this.a.debug('Exceeded max number of retries')}b&&0<b.length&&this.G.Re(b),this.a.debug('Error: HTTP request failed'),1===d?this.sa(5):4===d?this.sa(10):3===d?this.sa(6):this.sa(2)}},e.Xd=function(a){var b=this.Ve+_Mathfloor2(Math.random()*this.vg);return this.Ba()||(this.a.debug('Inactive channel'),b*=2),b*a},e.pc=function(a){if(this.ta&&(a=a.h)){var b=a.kb('X-Client-Wire-Protocol');b&&this.G.ld(b),this.aa&&((a=a.kb('X-HTTP-Session-Id'))?(this.Fe(a),this.hb.l(this.aa,a)):this.a.T('Missing X_HTTP_SESSION_ID in the handshake response'))}},e.dg=function(a,b){for(var c=this.i&&this.i.sc?[]:null,d=0,f;d<a.length;d++)if(f=a[d],this.Sb=f[0],f=f[1],2!=this.g)3==this.g&&('stop'==f[0]||'close'==f[0]?(c&&0!=c.length&&(this.i.sc(this,c),c.length=0),'stop'==f[0]?this.sa(7):this.disconnect()):'noop'!=f[0]&&(c?c.push(f):this.i&&this.i.ud(f)),this.Ha=0);else if('c'==f[0]){this.ra=f[1],this.na=this.$a(f[2]);var g=f[3];null!=g&&(this.tc=g,this.a.info('VER='+this.tc)),g=f[4],null!=g&&(this.De=g,this.a.info('SVER='+this.De)),f=f[5],null!=f&&'number'==typeof f&&0<f&&(this.Db=f*=1.5,this.a.info('backChannelRequestTimeoutMs_='+f)),this.pc(b),this.g=3,this.i&&this.i.wd(),this.Lg(b)}else'stop'!=f[0]&&'close'!=f[0]||this.sa(7);c&&0!=c.length&&this.i.sc(this,c)},e.Lg=function(a){this.md=this.Pd(this.na,this.K),a.lb?(this.a.debug('Upgrade the handshake request to a backchannel.'),this.G.ze(a),a.tg(this.Db),this.u=a):this.Kd()},e.sa=function(a){if(this.a.info('Error code '+a),2==a){var b=null;this.i&&(b=null);var c=u(this.Pg,this);b||(b=new U('//www.google.com/images/cleardot.gif'),h.location&&'http'==h.location.protocol||b.tb('https'),b.Ub()),Qc(b.toString(),c)}else O(2);this.cg(a)},e.Pg=function(a){a?(this.a.info('Successfully pinged google.com'),O(2)):(this.a.info('Failed to ping google.com'),O(1))},e.cg=function(a){this.a.debug('HttpChannel: error - '+a),this.g=0,this.i&&this.i.td(a),this.qe(),this.qd()},e.qe=function(){if(this.g=0,this.w=-1,this.i){var a=this.G.la();if(0!=a.length||0!=this.M.length){var b=this;this.a.debug(function(){return'Number of undelivered maps, pending: '+a.length+', outgoing: '+b.M.length}),this.G.$e(),ua(this.M),this.M.length=0}this.i.sd()}},e.Sd=function(a){return a=this.Cd(null,a),this.a.debug('GetForwardChannelUri: '+a),a},e.Pd=function(a,b){return a=this.Cd(this.fc()?a:null,b),this.a.debug('GetBackChannelUri: '+a),a},e.Cd=function(a,b){var c=Ac(b);if(''!=c.xa)a&&c.rb(a+'.'+c.xa),c.sb(c.Ca);else{var d=h.location;c=Bc(d.protocol,a?a+'.'+d.hostname:d.hostname,+d.port,b)}return this.gb&&Aa(this.gb,function(a,b){c.l(b,a)}),a=this.aa,b=this.Kc,a&&b&&c.l(a,b),c.l('VER',this.tc),this.Ya(c),c},e.Jb=function(a){if(a&&!this.gc)throw Error('Can\'t create secondary domain capable XhrIo object.');return a=new V(this.Xa),a.Je(this.gc),a},e.Ba=function(){return!!this.i&&this.i.Ba()},e.fc=function(){return this.gc},e=ad.prototype,e.sc=null,e.wd=function(){},e.ud=function(){},e.td=function(){},e.sd=function(){},e.Ba=function(){return!0},e.Ue=function(){},e.$a=function(a){return a},cd.prototype.cf=function(a,b){return new W(a,b)},x(W,H),e=W.prototype,e.addEventListener=function(a,b,c,d){W.L.addEventListener.call(this,a,b,c,d)},e.removeEventListener=function(a,b,c,d){W.L.removeEventListener.call(this,a,b,c,d)},e.open=function(){this.b.Ee(this.vd),this.Og&&this.b.Hg(),this.b.connect(this.Qg,this.yb,this.Rc||void 0)},e.close=function(){this.b.disconnect()},e.send=function(a){if(l(a)){var b={};b.__data__=a,this.b.Zc(b)}else this.zg?(b={},b.__data__=ub(a),this.b.Zc(b)):this.b.Zc(a)},e.F=function(){this.b.Ee(null),delete this.vd,this.b.disconnect(),delete this.b,W.L.F.call(this)},x(dd,fc),x(ed,gc),x(X,ad),X.prototype.wd=function(){Wb(this.b.s,'WebChannel opened on '+this.b.yb),this.b.dispatchEvent('a')},X.prototype.ud=function(a){this.b.dispatchEvent(new dd(a))},X.prototype.td=function(a){Wb(this.b.s,'WebChannel aborted on '+this.b.yb+' due to channel error: '+a),this.b.dispatchEvent(new ed(a))},X.prototype.sd=function(){Wb(this.b.s,'WebChannel closed on '+this.b.yb),this.b.dispatchEvent('b')};var fd=v(function(a){function c(){}c.prototype=a.prototype;var d=new c;return a.apply(d,Array.prototype.slice.call(arguments,1)),d},cd);e=gd.prototype,e.Vf=function(){0==this.V.length&&(this.V=this.Z,this.V.reverse(),this.Z=[])},e.enqueue=function(a){this.Z.push(a)},e.ab=function(){return this.Vf(),this.V.pop()},e.C=function(){return this.V.length+this.Z.length},e.X=function(){return 0==this.V.length&&0==this.Z.length},e.clear=function(){this.V=[],this.Z=[]},e.contains=function(a){return 0<=la(this.V,a)||0<=la(this.Z,a)},e.remove=function(a){var b=this.V,c=ma(b,a);return 0<=c?(Array.prototype.splice.call(b,c,1),b=!0):b=!1,b||sa(this.Z,a)},e.H=function(){for(var a=[],b=this.V.length-1;0<=b;--b)a.push(this.V[b]);var c=this.Z.length;for(b=0;b<c;++b)a.push(this.Z[b]);return a},x(hd,z);var id='[goog.structs.Pool] Min can not be greater than max';e=hd.prototype,e.Mb=function(){var a=w();if(!(null!=this.Nc&&a-this.Nc<this.Ac)){var b=this.qg();return b&&(this.Nc=a,this.oa.add(b)),b}},e.og=function(a){return!!this.oa.remove(a)&&(this.nc(a),!0)},e.qg=function(){for(var a;0<this.Td()&&(a=this.fa.ab(),!this.Sc(a));)this.Cb();return!a&&this.C()<this.Wb&&(a=this.xc()),a},e.nc=function(a){this.oa.remove(a),this.Sc(a)&&this.C()<this.Wb?this.fa.enqueue(a):this.Bc(a)},e.Cb=function(){for(var a=this.fa;this.C()<this.oe;)a.enqueue(this.xc());for(;this.C()>this.Wb&&0<this.Td();)this.Bc(a.ab())},e.xc=function(){return{}},e.Bc=function(a){if('function'==typeof a.bb)a.bb();else for(var b in a)a[b]=null},e.Sc=function(a){return'function'!=typeof a.Ye||a.Ye()},e.contains=function(a){return this.fa.contains(a)||this.oa.contains(a)},e.C=function(){return this.fa.C()+this.oa.C()},e.rf=function(){return this.oa.C()},e.Td=function(){return this.fa.C()},e.X=function(){return this.fa.X()&&this.oa.X()},e.F=function(){if(hd.L.F.call(this),0<this.rf())throw Error('[goog.structs.Pool] Objects not released');delete this.oa;for(var a=this.fa;!a.X();)this.Bc(a.ab());delete this.fa},jd.prototype.getKey=function(){return this.fe},jd.prototype.clone=function(){return new jd(this.fe,this.gd)},e=kd.prototype,e.ce=function(a,b){var c=this.Y;c.push(new jd(a,b)),this.$f(c.length-1)},e.Lf=function(a){if(a instanceof kd){var b=a.W();if(a=a.H(),0>=this.C()){for(var c=this.Y,d=0;d<b.length;d++)c.push(new jd(b[d],a[d]));return}}else b=Ca(a),a=Ba(a);for(d=0;d<b.length;d++)this.ce(b[d],a[d])},e.remove=function(){var a=this.Y,b=a.length,c=a[0];if(!(0>=b))return 1==b?ra(a):(a[0]=a.pop(),this.Zf()),c.gd},e.Zf=function(){for(var a=0,b=this.Y,c=b.length,d=b[a];a<c>>1;){var f=this.tf(a),g=this.zf(a);if(f=g<c&&b[g].getKey()<b[f].getKey()?g:f,b[f].getKey()>d.getKey())break;b[a]=b[f],a=f}b[a]=d},e.$f=function(a){for(var b=this.Y,c=b[a],d;0<a&&(d=this.wf(a),b[d].getKey()>c.getKey());)b[a]=b[d],a=d;b[a]=c},e.tf=function(a){return 2*a+1},e.zf=function(a){return 2*a+2},e.wf=function(a){return a-1>>1},e.H=function(){for(var a=this.Y,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].gd);return b},e.W=function(){for(var a=this.Y,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].getKey());return b},e.va=function(a){return oa(this.Y,function(b){return b.getKey()==a})},e.clone=function(){return new kd(this)},e.C=function(){return this.Y.length},e.X=function(){return 0==this.Y.length},e.clear=function(){ra(this.Y)},x(ld,kd),ld.prototype.enqueue=function(a,b){this.ce(a,b)},ld.prototype.ab=function(){return this.remove()},x(Y,hd),e=Y.prototype,e.Mb=function(a,b){return a?void(this.cc.enqueue(void 0===b?100:b,a),this.Nb()):((a=Y.L.Mb.call(this))&&this.Ac&&(this.Gd=h.setTimeout(u(this.Nb,this),this.Ac)),a)},e.Nb=function(){for(var a=this.cc,b;0<a.C()&&(b=this.Mb(),b);)a.ab().apply(this,[b])},e.nc=function(a){Y.L.nc.call(this,a),this.Nb()},e.Cb=function(){Y.L.Cb.call(this),this.Nb()},e.F=function(){Y.L.F.call(this),h.clearTimeout(this.Gd),this.cc.clear(),this.cc=null},x(Z,Y),Z.prototype.xc=function(){var a=new V,b=this.Jf;return b&&b.forEach(function(b,d){a.headers.set(d,b)}),this.Ab&&a.Je(!0),a},Z.prototype.Sc=function(a){return!a.Ka&&!a.Ba()},cd.prototype.createWebChannel=cd.prototype.cf,W.prototype.send=W.prototype.send,W.prototype.open=W.prototype.open,W.prototype.close=W.prototype.close,bc.NO_ERROR=0,bc.TIMEOUT=8,bc.HTTP_ERROR=6,cc.COMPLETE='complete',ec.EventType=Q,Q.OPEN='a',Q.CLOSE='b',Q.ERROR='c',Q.MESSAGE='d',H.prototype.listen=H.prototype.nb,Z.prototype.getObject=Z.prototype.Mb,Z.prototype.releaseObject=Z.prototype.og,V.prototype.listenOnce=V.prototype.Oc,V.prototype.getLastError=V.prototype.Hc,V.prototype.getLastErrorCode=V.prototype.Ud,V.prototype.getStatus=V.prototype.za,V.prototype.getStatusText=V.prototype.Yd,V.prototype.getResponseJson=V.prototype.yf,V.prototype.getResponseText=V.prototype.ya,V.prototype.getResponseText=V.prototype.ya,V.prototype.send=V.prototype.send;var src={createWebChannelTransport:fd,ErrorCode:bc,EventType:cc,WebChannel:ec,XhrIoPool:Z},src_1=src.createWebChannelTransport,src_2=src.ErrorCode,src_3=src.EventType,src_4=src.WebChannel,src_5=src.XhrIoPool;__webpack_exports__['default']=src}).call(__webpack_exports__,__webpack_require__(0))},function(module,exports,__webpack_require__){function BindToEventDecorator(_event,_target,_listenIn,_removeIn){return function(propertyName,func){const scope=this,event=_event||propertyName,target=_target?document.querySelector(_target):this.el;if(!target)return void console.warn('Couldn\'t subscribe '+this.name+'.'+propertyName+' to '+event+' on '+_target+' because querySelector returned undefined.');const listenIn=_listenIn||'init',removeIn=_removeIn||'remove',listenFunc=this[listenIn],removeFunc=this[removeIn],boundFunc=func.bind(this);return this[listenIn]=function(){void 0!==listenFunc&&listenFunc.apply(scope,arguments),target.addEventListener(event,boundFunc)},this[removeIn]=function(){void 0!==removeFunc&&removeFunc.apply(scope,arguments),target.removeEventListener(event,boundFunc)},func}}const decorate=__webpack_require__(14).decorate;module.exports.bindEvent=function bindEvent(p1,p2){if('function'==typeof p1)return decorate(p1,BindToEventDecorator());if('object'==typeof p1&&'function'==typeof p2)return decorate(p2,BindToEventDecorator(p1.event,p1.target,p1.listenIn,p1.removeIn));throw new Error('bindEvent must take: (function), or a ([object], function)')},module.exports.bindEventPlayPause=function bindEventPlayPause(p1,p2){if('function'==typeof p1)return decorate(p1,BindToEventDecorator(void 0,void 0,'play','pause'));if('object'==typeof p1&&'function'==typeof p2)return decorate(p2,BindToEventDecorator(p1.event,p1.target,'play','pause'));throw new Error('bindEventPlayPause must take: (function), or a ([object], function)')}},function(){THREE.BufferGeometryUtils={computeTangents:function(geometry){function handleTriangle(a,b,c){vA.fromArray(positions,3*a),vB.fromArray(positions,3*b),vC.fromArray(positions,3*c),uvA.fromArray(uvs,2*a),uvB.fromArray(uvs,2*b),uvC.fromArray(uvs,2*c);var x1=vB.x-vA.x,x2=vC.x-vA.x,y1=vB.y-vA.y,y2=vC.y-vA.y,z1=vB.z-vA.z,z2=vC.z-vA.z,s1=uvB.x-uvA.x,s2=uvC.x-uvA.x,t1=uvB.y-uvA.y,t2=uvC.y-uvA.y,r=1/(s1*t2-s2*t1);sdir.set((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r),tdir.set((s1*x2-s2*x1)*r,(s1*y2-s2*y1)*r,(s1*z2-s2*z1)*r),tan1[a].add(sdir),tan1[b].add(sdir),tan1[c].add(sdir),tan2[a].add(tdir),tan2[b].add(tdir),tan2[c].add(tdir)}function handleVertex(v){n.fromArray(normals,3*v),n2.copy(n),t=tan1[v],tmp.copy(t),tmp.sub(n.multiplyScalar(n.dot(t))).normalize(),tmp2.crossVectors(n2,t),test=tmp2.dot(tan2[v]),w=0>test?-1:1,tangents[4*v]=tmp.x,tangents[4*v+1]=tmp.y,tangents[4*v+2]=tmp.z,tangents[4*v+3]=w}var index=geometry.index,attributes=geometry.attributes;if(null===index||void 0===attributes.position||void 0===attributes.normal||void 0===attributes.uv)return void console.warn('THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()');var indices=index.array,positions=attributes.position.array,normals=attributes.normal.array,uvs=attributes.uv.array,nVertices=positions.length/3;attributes.tangent===void 0&&geometry.addAttribute('tangent',new THREE.BufferAttribute(new Float32Array(4*nVertices),4));for(var tangents=attributes.tangent.array,tan1=[],tan2=[],i=0;i<nVertices;i++)tan1[i]=new THREE.Vector3,tan2[i]=new THREE.Vector3;var vA=new THREE.Vector3,vB=new THREE.Vector3,vC=new THREE.Vector3,uvA=new THREE.Vector2,uvB=new THREE.Vector2,uvC=new THREE.Vector2,sdir=new THREE.Vector3,tdir=new THREE.Vector3,groups=geometry.groups;0===groups.length&&(groups=[{start:0,count:indices.length}]);for(var i=0,il=groups.length;i<il;++i)for(var group=groups[i],start=group.start,count=group.count,j=start,jl=start+count;j<jl;j+=3)handleTriangle(indices[j+0],indices[j+1],indices[j+2]);for(var tmp=new THREE.Vector3,tmp2=new THREE.Vector3,n=new THREE.Vector3,n2=new THREE.Vector3,i=0,il=groups.length,w,t,test;i<il;++i)for(var group=groups[i],start=group.start,count=group.count,j=start,jl=start+count;j<jl;j+=3)handleVertex(indices[j+0]),handleVertex(indices[j+1]),handleVertex(indices[j+2])},mergeBufferGeometries:function(geometries,useGroups){for(var isIndexed=null!==geometries[0].index,attributesUsed=new Set(Object.keys(geometries[0].attributes)),morphAttributesUsed=new Set(Object.keys(geometries[0].morphAttributes)),attributes={},morphAttributes={},mergedGeometry=new THREE.BufferGeometry,offset=0,i=0,geometry;i<geometries.length;++i){if(geometry=geometries[i],isIndexed!=(null!==geometry.index))return null;for(var name in geometry.attributes){if(!attributesUsed.has(name))return null;void 0===attributes[name]&&(attributes[name]=[]),attributes[name].push(geometry.attributes[name])}for(var name in geometry.morphAttributes){if(!morphAttributesUsed.has(name))return null;void 0===morphAttributes[name]&&(morphAttributes[name]=[]),morphAttributes[name].push(geometry.morphAttributes[name])}if(mergedGeometry.userData&&(mergedGeometry.userData.mergedUserData=mergedGeometry.userData.mergedUserData||[],mergedGeometry.userData.mergedUserData.push(geometry.userData)),useGroups){var count;if(isIndexed)count=geometry.index.count;else if(void 0!==geometry.attributes.position)count=geometry.attributes.position.count;else return null;mergedGeometry.addGroup(offset,count,i),offset+=count}}if(isIndexed){for(var indexOffset=0,mergedIndex=[],i=0,index;i<geometries.length;++i){index=geometries[i].index;for(var j=0;j<index.count;++j)mergedIndex.push(index.getX(j)+indexOffset);indexOffset+=geometries[i].attributes.position.count}mergedGeometry.setIndex(mergedIndex)}for(var name in attributes){var mergedAttribute=this.mergeBufferAttributes(attributes[name]);if(!mergedAttribute)return null;mergedGeometry.addAttribute(name,mergedAttribute)}for(var name in morphAttributes){var numMorphTargets=morphAttributes[name][0].length;if(0===numMorphTargets)break;mergedGeometry.morphAttributes=mergedGeometry.morphAttributes||{},mergedGeometry.morphAttributes[name]=[];for(var i=0,morphAttributesToMerge;i<numMorphTargets;++i){morphAttributesToMerge=[];for(var j=0;j<morphAttributes[name].length;++j)morphAttributesToMerge.push(morphAttributes[name][j][i]);var mergedMorphAttribute=this.mergeBufferAttributes(morphAttributesToMerge);if(!mergedMorphAttribute)return null;mergedGeometry.morphAttributes[name].push(mergedMorphAttribute)}}return mergedGeometry},mergeBufferAttributes:function(attributes){for(var arrayLength=0,i=0,TypedArray,itemSize,normalized,attribute;i<attributes.length;++i){if(attribute=attributes[i],attribute.isInterleavedBufferAttribute)return null;if(void 0==TypedArray&&(TypedArray=attribute.array.constructor),TypedArray!==attribute.array.constructor)return null;if(void 0==itemSize&&(itemSize=attribute.itemSize),itemSize!==attribute.itemSize)return null;if(void 0==normalized&&(normalized=attribute.normalized),normalized!==attribute.normalized)return null;arrayLength+=attribute.array.length}for(var array=new TypedArray(arrayLength),offset=0,i=0;i<attributes.length;++i)array.set(attributes[i].array,offset),offset+=attributes[i].array.length;return new THREE.BufferAttribute(array,itemSize,normalized)}}},function(){var _Mathmin3=Math.min,_Mathsqrt=Math.sqrt,_MathPI=Math.PI,_Mathmax3=Math.max;THREE.OrbitControls=function(object,domElement){function getAutoRotationAngle(){return 2*_MathPI/60/60*scope.autoRotateSpeed}function getZoomScale(){return Math.pow(0.95,scope.zoomSpeed)}function rotateLeft(angle){sphericalDelta.theta-=angle}function rotateUp(angle){sphericalDelta.phi-=angle}function dollyIn(dollyScale){scope.object.isPerspectiveCamera?scale/=dollyScale:scope.object.isOrthographicCamera?(scope.object.zoom=_Mathmax3(scope.minZoom,_Mathmin3(scope.maxZoom,scope.object.zoom*dollyScale)),scope.object.updateProjectionMatrix(),zoomChanged=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),scope.enableZoom=!1)}function dollyOut(dollyScale){scope.object.isPerspectiveCamera?scale*=dollyScale:scope.object.isOrthographicCamera?(scope.object.zoom=_Mathmax3(scope.minZoom,_Mathmin3(scope.maxZoom,scope.object.zoom/dollyScale)),scope.object.updateProjectionMatrix(),zoomChanged=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),scope.enableZoom=!1)}function handleMouseDownRotate(event){rotateStart.set(event.clientX,event.clientY)}function handleMouseDownDolly(event){dollyStart.set(event.clientX,event.clientY)}function handleMouseDownPan(event){panStart.set(event.clientX,event.clientY)}function handleMouseMoveRotate(event){rotateEnd.set(event.clientX,event.clientY),rotateDelta.subVectors(rotateEnd,rotateStart);var element=scope.domElement===document?scope.domElement.body:scope.domElement;rotateLeft(2*_MathPI*rotateDelta.x/element.clientWidth*scope.rotateSpeed),rotateUp(2*_MathPI*rotateDelta.y/element.clientHeight*scope.rotateSpeed),rotateStart.copy(rotateEnd),scope.update()}function handleMouseMoveDolly(event){dollyEnd.set(event.clientX,event.clientY),dollyDelta.subVectors(dollyEnd,dollyStart),0<dollyDelta.y?dollyIn(getZoomScale()):0>dollyDelta.y&&dollyOut(getZoomScale()),dollyStart.copy(dollyEnd),scope.update()}function handleMouseMovePan(event){panEnd.set(event.clientX,event.clientY),panDelta.subVectors(panEnd,panStart),pan(panDelta.x,panDelta.y),panStart.copy(panEnd),scope.update()}function handleMouseUp(){}function handleMouseWheel(event){0>event.deltaY?dollyOut(getZoomScale()):0<event.deltaY&&dollyIn(getZoomScale()),scope.update()}function handleKeyDown(event){switch(event.keyCode){case scope.keys.UP:pan(0,scope.keyPanSpeed),scope.update();break;case scope.keys.BOTTOM:pan(0,-scope.keyPanSpeed),scope.update();break;case scope.keys.LEFT:pan(scope.keyPanSpeed,0),scope.update();break;case scope.keys.RIGHT:pan(-scope.keyPanSpeed,0),scope.update();}}function handleTouchStartRotate(event){rotateStart.set(event.touches[0].pageX,event.touches[0].pageY)}function handleTouchStartDolly(event){var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY,distance=_Mathsqrt(dx*dx+dy*dy);dollyStart.set(0,distance)}function handleTouchStartPan(event){panStart.set(event.touches[0].pageX,event.touches[0].pageY)}function handleTouchMoveRotate(event){rotateEnd.set(event.touches[0].pageX,event.touches[0].pageY),rotateDelta.subVectors(rotateEnd,rotateStart);var element=scope.domElement===document?scope.domElement.body:scope.domElement;rotateLeft(2*_MathPI*rotateDelta.x/element.clientWidth*scope.rotateSpeed),rotateUp(2*_MathPI*rotateDelta.y/element.clientHeight*scope.rotateSpeed),rotateStart.copy(rotateEnd),scope.update()}function handleTouchMoveDolly(event){var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY,distance=_Mathsqrt(dx*dx+dy*dy);dollyEnd.set(0,distance),dollyDelta.subVectors(dollyEnd,dollyStart),0<dollyDelta.y?dollyOut(getZoomScale()):0>dollyDelta.y&&dollyIn(getZoomScale()),dollyStart.copy(dollyEnd),scope.update()}function handleTouchMovePan(event){panEnd.set(event.touches[0].pageX,event.touches[0].pageY),panDelta.subVectors(panEnd,panStart),pan(panDelta.x,panDelta.y),panStart.copy(panEnd),scope.update()}function handleTouchEnd(){}function onMouseDown(event){if(!1!==scope.enabled){switch(event.preventDefault(),event.button){case scope.mouseButtons.ORBIT:if(!1===scope.enableRotate)return;handleMouseDownRotate(event),state=STATE.ROTATE;break;case scope.mouseButtons.ZOOM:if(!1===scope.enableZoom)return;handleMouseDownDolly(event),state=STATE.DOLLY;break;case scope.mouseButtons.PAN:if(!1===scope.enablePan)return;handleMouseDownPan(event),state=STATE.PAN;}state!==STATE.NONE&&(document.addEventListener('mousemove',onMouseMove,!1),document.addEventListener('mouseup',onMouseUp,!1),scope.dispatchEvent(startEvent))}}function onMouseMove(event){if(!1!==scope.enabled)switch(event.preventDefault(),state){case STATE.ROTATE:if(!1===scope.enableRotate)return;handleMouseMoveRotate(event);break;case STATE.DOLLY:if(!1===scope.enableZoom)return;handleMouseMoveDolly(event);break;case STATE.PAN:if(!1===scope.enablePan)return;handleMouseMovePan(event);}}function onMouseUp(event){!1===scope.enabled||(handleMouseUp(event),document.removeEventListener('mousemove',onMouseMove,!1),document.removeEventListener('mouseup',onMouseUp,!1),scope.dispatchEvent(endEvent),state=STATE.NONE)}function onMouseWheel(event){!1===scope.enabled||!1===scope.enableZoom||state!==STATE.NONE&&state!==STATE.ROTATE||(event.preventDefault(),event.stopPropagation(),scope.dispatchEvent(startEvent),handleMouseWheel(event),scope.dispatchEvent(endEvent))}function onKeyDown(event){!1===scope.enabled||!1===scope.enableKeys||!1===scope.enablePan||handleKeyDown(event)}function onTouchStart(event){if(!1!==scope.enabled){switch(event.touches.length){case 1:if(!1===scope.enableRotate)return;handleTouchStartRotate(event),state=STATE.TOUCH_ROTATE;break;case 2:if(!1===scope.enableZoom)return;handleTouchStartDolly(event),state=STATE.TOUCH_DOLLY;break;case 3:if(!1===scope.enablePan)return;handleTouchStartPan(event),state=STATE.TOUCH_PAN;break;default:state=STATE.NONE;}state!==STATE.NONE&&scope.dispatchEvent(startEvent)}}function onTouchMove(event){if(!1!==scope.enabled)switch(event.preventDefault(),event.stopPropagation(),event.touches.length){case 1:if(!1===scope.enableRotate)return;if(state!==STATE.TOUCH_ROTATE)return;handleTouchMoveRotate(event);break;case 2:if(!1===scope.enableZoom)return;if(state!==STATE.TOUCH_DOLLY)return;handleTouchMoveDolly(event);break;case 3:if(!1===scope.enablePan)return;if(state!==STATE.TOUCH_PAN)return;handleTouchMovePan(event);break;default:state=STATE.NONE;}}function onTouchEnd(event){!1===scope.enabled||(handleTouchEnd(event),scope.dispatchEvent(endEvent),state=STATE.NONE)}function onContextMenu(event){!1===scope.enabled||event.preventDefault()}this.object=object,this.domElement=domElement===void 0?document:domElement,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=Infinity,this.minZoom=0,this.maxZoom=Infinity,this.minPolarAngle=0,this.maxPolarAngle=_MathPI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.enableDamping=!1,this.dampingFactor=0.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return spherical.phi},this.getAzimuthalAngle=function(){return spherical.theta},this.saveState=function(){scope.target0.copy(scope.target),scope.position0.copy(scope.object.position),scope.zoom0=scope.object.zoom},this.reset=function(){scope.target.copy(scope.target0),scope.object.position.copy(scope.position0),scope.object.zoom=scope.zoom0,scope.object.updateProjectionMatrix(),scope.dispatchEvent(changeEvent),scope.update(),state=STATE.NONE},this.update=function(){var offset=new THREE.Vector3,quat=new THREE.Quaternion().setFromUnitVectors(object.up,new THREE.Vector3(0,1,0)),quatInverse=quat.clone().inverse(),lastPosition=new THREE.Vector3,lastQuaternion=new THREE.Quaternion;return function update(){var position=scope.object.position;return offset.copy(position).sub(scope.target),offset.applyQuaternion(quat),spherical.setFromVector3(offset),scope.autoRotate&&state===STATE.NONE&&rotateLeft(getAutoRotationAngle()),spherical.theta+=sphericalDelta.theta,spherical.phi+=sphericalDelta.phi,spherical.theta=_Mathmax3(scope.minAzimuthAngle,_Mathmin3(scope.maxAzimuthAngle,spherical.theta)),spherical.phi=_Mathmax3(scope.minPolarAngle,_Mathmin3(scope.maxPolarAngle,spherical.phi)),spherical.makeSafe(),spherical.radius*=scale,spherical.radius=_Mathmax3(scope.minDistance,_Mathmin3(scope.maxDistance,spherical.radius)),scope.target.add(panOffset),offset.setFromSpherical(spherical),offset.applyQuaternion(quatInverse),position.copy(scope.target).add(offset),scope.object.lookAt(scope.target),!0===scope.enableDamping?(sphericalDelta.theta*=1-scope.dampingFactor,sphericalDelta.phi*=1-scope.dampingFactor):sphericalDelta.set(0,0,0),scale=1,panOffset.set(0,0,0),(zoomChanged||lastPosition.distanceToSquared(scope.object.position)>EPS||8*(1-lastQuaternion.dot(scope.object.quaternion))>EPS)&&(scope.dispatchEvent(changeEvent),lastPosition.copy(scope.object.position),lastQuaternion.copy(scope.object.quaternion),zoomChanged=!1,!0)}}(),this.dispose=function(){scope.domElement.removeEventListener('contextmenu',onContextMenu,!1),scope.domElement.removeEventListener('mousedown',onMouseDown,!1),scope.domElement.removeEventListener('wheel',onMouseWheel,!1),scope.domElement.removeEventListener('touchstart',onTouchStart,!1),scope.domElement.removeEventListener('touchend',onTouchEnd,!1),scope.domElement.removeEventListener('touchmove',onTouchMove,!1),document.removeEventListener('mousemove',onMouseMove,!1),document.removeEventListener('mouseup',onMouseUp,!1),window.removeEventListener('keydown',onKeyDown,!1)};var scope=this,changeEvent={type:'change'},startEvent={type:'start'},endEvent={type:'end'},STATE={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},state=STATE.NONE,EPS=1e-6,spherical=new THREE.Spherical,sphericalDelta=new THREE.Spherical,scale=1,panOffset=new THREE.Vector3,zoomChanged=!1,rotateStart=new THREE.Vector2,rotateEnd=new THREE.Vector2,rotateDelta=new THREE.Vector2,panStart=new THREE.Vector2,panEnd=new THREE.Vector2,panDelta=new THREE.Vector2,dollyStart=new THREE.Vector2,dollyEnd=new THREE.Vector2,dollyDelta=new THREE.Vector2,panLeft=function(){var v=new THREE.Vector3;return function panLeft(distance,objectMatrix){v.setFromMatrixColumn(objectMatrix,0),v.multiplyScalar(-distance),panOffset.add(v)}}(),panUp=function(){var v=new THREE.Vector3;return function panUp(distance,objectMatrix){v.setFromMatrixColumn(objectMatrix,1),v.multiplyScalar(distance),panOffset.add(v)}}(),pan=function(){var offset=new THREE.Vector3;return function pan(deltaX,deltaY){var element=scope.domElement===document?scope.domElement.body:scope.domElement;if(scope.object.isPerspectiveCamera){var position=scope.object.position;offset.copy(position).sub(scope.target);var targetDistance=offset.length();targetDistance*=Math.tan(scope.object.fov/2*_MathPI/180),panLeft(2*deltaX*targetDistance/element.clientHeight,scope.object.matrix),panUp(2*deltaY*targetDistance/element.clientHeight,scope.object.matrix)}else scope.object.isOrthographicCamera?(panLeft(deltaX*(scope.object.right-scope.object.left)/scope.object.zoom/element.clientWidth,scope.object.matrix),panUp(deltaY*(scope.object.top-scope.object.bottom)/scope.object.zoom/element.clientHeight,scope.object.matrix)):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.'),scope.enablePan=!1)}}();scope.domElement.addEventListener('contextmenu',onContextMenu,!1),scope.domElement.addEventListener('mousedown',onMouseDown,!1),scope.domElement.addEventListener('wheel',onMouseWheel,!1),scope.domElement.addEventListener('touchstart',onTouchStart,!1),scope.domElement.addEventListener('touchend',onTouchEnd,!1),scope.domElement.addEventListener('touchmove',onTouchMove,!1),window.addEventListener('keydown',onKeyDown,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn('THREE.OrbitControls: .center has been renamed to .target'),this.target}},noZoom:{get:function(){return console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),!this.enableZoom},set:function(value){console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),this.enableZoom=!value}},noRotate:{get:function(){return console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),!this.enableRotate},set:function(value){console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),this.enableRotate=!value}},noPan:{get:function(){return console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),!this.enablePan},set:function(value){console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),this.enablePan=!value}},noKeys:{get:function(){return console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),!this.enableKeys},set:function(value){console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),this.enableKeys=!value}},staticMoving:{get:function(){return console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),!this.enableDamping},set:function(value){console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),this.enableDamping=!value}},dynamicDampingFactor:{get:function(){return console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor},set:function(value){console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor=value}}})},function(module,exports,__webpack_require__){var _Mathfloor3=Math.floor;(function(process){function AlgoliaSearchCore(applicationID,apiKey,opts){var debug=__webpack_require__(7)('algoliasearch'),clone=__webpack_require__(1),isArray=__webpack_require__(8),map=__webpack_require__(5),usage='Usage: algoliasearch(applicationID, apiKey, opts)';if(!0!==opts._allowEmptyCredentials&&!applicationID)throw new errors.AlgoliaSearchError('Please provide an application ID. '+usage);if(!0!==opts._allowEmptyCredentials&&!apiKey)throw new errors.AlgoliaSearchError('Please provide an API key. '+usage);this.applicationID=applicationID,this.apiKey=apiKey,this.hosts={read:[],write:[]},opts=opts||{},this._timeouts=opts.timeouts||{connect:1*1e3,read:2*1e3,write:30*1e3},opts.timeout&&(this._timeouts.connect=this._timeouts.read=this._timeouts.write=opts.timeout);var protocol=opts.protocol||'https:';if(/:$/.test(protocol)||(protocol+=':'),'http:'!==protocol&&'https:'!==protocol)throw new errors.AlgoliaSearchError('protocol must be `http:` or `https:` (was `'+opts.protocol+'`)');if(this._checkAppIdData(),!opts.hosts){var defaultHosts=map(this._shuffleResult,function(hostNumber){return applicationID+'-'+hostNumber+'.algolianet.com'}),mainSuffix=(!1===opts.dsn?'':'-dsn')+'.algolia.net';this.hosts.read=[this.applicationID+mainSuffix].concat(defaultHosts),this.hosts.write=[this.applicationID+'.algolia.net'].concat(defaultHosts)}else isArray(opts.hosts)?(this.hosts.read=clone(opts.hosts),this.hosts.write=clone(opts.hosts)):(this.hosts.read=clone(opts.hosts.read),this.hosts.write=clone(opts.hosts.write));this.hosts.read=map(this.hosts.read,prepareHost(protocol)),this.hosts.write=map(this.hosts.write,prepareHost(protocol)),this.extraHeaders={},this.cache=opts._cache||{},this._ua=opts._ua,this._useCache=void 0===opts._useCache||opts._cache||opts._useCache,this._useRequestCache=this._useCache&&opts._useRequestCache,this._useFallback=void 0===opts.useFallback||opts.useFallback,this._setTimeout=opts._setTimeout,debug('init done, %j',this)}function prepareHost(protocol){return function prepare(host){return protocol+'//'+host.toLowerCase()}}function safeJSONStringify(obj){if(void 0===Array.prototype.toJSON)return JSON.stringify(obj);var toJSON=Array.prototype.toJSON;delete Array.prototype.toJSON;var out=JSON.stringify(obj);return Array.prototype.toJSON=toJSON,out}function shuffle(array){for(var currentIndex=array.length,temporaryValue,randomIndex;0!==currentIndex;)randomIndex=_Mathfloor3(Math.random()*currentIndex),currentIndex-=1,temporaryValue=array[currentIndex],array[currentIndex]=array[randomIndex],array[randomIndex]=temporaryValue;return array}function removeCredentials(headers){var newHeaders={};for(var headerName in headers)if(Object.prototype.hasOwnProperty.call(headers,headerName)){var value;value='x-algolia-api-key'==headerName||'x-algolia-application-id'==headerName?'**hidden for security purposes**':headers[headerName],newHeaders[headerName]=value}return newHeaders}module.exports=AlgoliaSearchCore;var errors=__webpack_require__(4),exitPromise=__webpack_require__(51),IndexCore=__webpack_require__(44),store=__webpack_require__(54),RESET_APP_DATA_TIMER=process.env.RESET_APP_DATA_TIMER&&parseInt(process.env.RESET_APP_DATA_TIMER,10)||1e3*(2*60);AlgoliaSearchCore.prototype.initIndex=function(indexName){return new IndexCore(this,indexName)},AlgoliaSearchCore.prototype.setExtraHeader=function(name,value){this.extraHeaders[name.toLowerCase()]=value},AlgoliaSearchCore.prototype.getExtraHeader=function(name){return this.extraHeaders[name.toLowerCase()]},AlgoliaSearchCore.prototype.unsetExtraHeader=function(name){delete this.extraHeaders[name.toLowerCase()]},AlgoliaSearchCore.prototype.addAlgoliaAgent=function(algoliaAgent){-1===this._ua.indexOf(';'+algoliaAgent)&&(this._ua+=';'+algoliaAgent)},AlgoliaSearchCore.prototype._jsonRequest=function(initialOpts){function doRequest(requester,reqOpts){function retryRequest(){return requestDebug('retrying request'),client._incrementHostIndex(initialOpts.hostType),doRequest(requester,reqOpts)}function retryRequestWithHigherTimeout(){return requestDebug('retrying request with higher timeout'),client._incrementHostIndex(initialOpts.hostType),client._incrementTimeoutMultipler(),reqOpts.timeouts=client._getTimeoutsForRequest(initialOpts.hostType),doRequest(requester,reqOpts)}client._checkAppIdData();var startTime=new Date;if(client._useCache&&!client._useRequestCache&&(cacheID=initialOpts.url),client._useCache&&!client._useRequestCache&&body&&(cacheID+='_body_'+reqOpts.body),isCacheValidWithCurrentID(!client._useRequestCache,cache,cacheID)){requestDebug('serving response from cache');var responseText=cache[cacheID];return client._promise.resolve({body:JSON.parse(responseText),responseText:responseText})}if(tries>=client.hosts[initialOpts.hostType].length)return!hasFallback||usingFallback?(requestDebug('could not get any response'),client._promise.reject(new errors.AlgoliaSearchError('Cannot connect to the AlgoliaSearch API.'+' Send an email to support@algolia.com to report and resolve the issue.'+' Application id was: '+client.applicationID,{debugData:debugData}))):(requestDebug('switching to fallback'),tries=0,reqOpts.method=initialOpts.fallback.method,reqOpts.url=initialOpts.fallback.url,reqOpts.jsonBody=initialOpts.fallback.body,reqOpts.jsonBody&&(reqOpts.body=safeJSONStringify(reqOpts.jsonBody)),headers=client._computeRequestHeaders({additionalUA:additionalUA,headers:initialOpts.headers}),reqOpts.timeouts=client._getTimeoutsForRequest(initialOpts.hostType),client._setHostIndexByType(0,initialOpts.hostType),usingFallback=!0,doRequest(client._request.fallback,reqOpts));var currentHost=client._getHostByType(initialOpts.hostType),url=currentHost+reqOpts.url,options={body:reqOpts.body,jsonBody:reqOpts.jsonBody,method:reqOpts.method,headers:headers,timeouts:reqOpts.timeouts,debug:requestDebug,forceAuthHeaders:reqOpts.forceAuthHeaders};return requestDebug('method: %s, url: %s, headers: %j, timeouts: %d',options.method,url,options.headers,options.timeouts),requester===client._request.fallback&&requestDebug('using fallback'),requester.call(client,url,options).then(function success(httpResponse){var status=httpResponse&&httpResponse.body&&httpResponse.body.message&&httpResponse.body.status||httpResponse.statusCode||httpResponse&&httpResponse.body&&200;requestDebug('received response: statusCode: %s, computed statusCode: %d, headers: %j',httpResponse.statusCode,status,httpResponse.headers);var httpResponseOk=2===_Mathfloor3(status/100),endTime=new Date;if(debugData.push({currentHost:currentHost,headers:removeCredentials(headers),content:body||null,contentLength:void 0===body?null:body.length,method:reqOpts.method,timeouts:reqOpts.timeouts,url:reqOpts.url,startTime:startTime,endTime:endTime,duration:endTime-startTime,statusCode:status}),httpResponseOk)return client._useCache&&!client._useRequestCache&&cache&&(cache[cacheID]=httpResponse.responseText),{responseText:httpResponse.responseText,body:httpResponse.body};var shouldRetry=4!==_Mathfloor3(status/100);if(shouldRetry)return tries+=1,retryRequest();requestDebug('unrecoverable error');var unrecoverableError=new errors.AlgoliaSearchError(httpResponse.body&&httpResponse.body.message,{debugData:debugData,statusCode:status});return client._promise.reject(unrecoverableError)},function tryFallback(err){requestDebug('error: %s, stack: %s',err.message,err.stack);var endTime=new Date;return debugData.push({currentHost:currentHost,headers:removeCredentials(headers),content:body||null,contentLength:void 0===body?null:body.length,method:reqOpts.method,timeouts:reqOpts.timeouts,url:reqOpts.url,startTime:startTime,endTime:endTime,duration:endTime-startTime}),err instanceof errors.AlgoliaSearchError||(err=new errors.Unknown(err&&err.message,err)),tries+=1,err instanceof errors.Unknown||err instanceof errors.UnparsableJSON||tries>=client.hosts[initialOpts.hostType].length&&(usingFallback||!hasFallback)?(err.debugData=debugData,client._promise.reject(err)):err instanceof errors.RequestTimeout?retryRequestWithHigherTimeout():retryRequest()})}function isCacheValidWithCurrentID(useRequestCache,currentCache,currentCacheID){return client._useCache&&useRequestCache&&currentCache&&void 0!==currentCache[currentCacheID]}function interopCallbackReturn(request,callback){return isCacheValidWithCurrentID(client._useRequestCache,cache,cacheID)&&request.catch(function(){delete cache[cacheID]}),'function'==typeof initialOpts.callback?void request.then(function okCb(content){exitPromise(function(){initialOpts.callback(null,callback(content))},client._setTimeout||setTimeout)},function nookCb(err){exitPromise(function(){initialOpts.callback(err)},client._setTimeout||setTimeout)}):request.then(callback)}this._checkAppIdData();var requestDebug=__webpack_require__(7)('algoliasearch:'+initialOpts.url),additionalUA=initialOpts.additionalUA||'',cache=initialOpts.cache,client=this,tries=0,usingFallback=!1,hasFallback=client._useFallback&&client._request.fallback&&initialOpts.fallback,body,cacheID,headers;this.apiKey.length>500&&void 0!==initialOpts.body&&(void 0!==initialOpts.body.params||void 0!==initialOpts.body.requests)?(initialOpts.body.apiKey=this.apiKey,headers=this._computeRequestHeaders({additionalUA:additionalUA,withApiKey:!1,headers:initialOpts.headers})):headers=this._computeRequestHeaders({additionalUA:additionalUA,headers:initialOpts.headers}),void 0!==initialOpts.body&&(body=safeJSONStringify(initialOpts.body)),requestDebug('request start');var debugData=[];if(client._useCache&&client._useRequestCache&&(cacheID=initialOpts.url),client._useCache&&client._useRequestCache&&body&&(cacheID+='_body_'+body),isCacheValidWithCurrentID(client._useRequestCache,cache,cacheID)){requestDebug('serving request from cache');var maybePromiseForCache=cache[cacheID],promiseForCache='function'==typeof maybePromiseForCache.then?maybePromiseForCache:client._promise.resolve({responseText:maybePromiseForCache});return interopCallbackReturn(promiseForCache,function(content){return JSON.parse(content.responseText)})}var request=doRequest(client._request,{url:initialOpts.url,method:initialOpts.method,body:body,jsonBody:initialOpts.body,timeouts:client._getTimeoutsForRequest(initialOpts.hostType),forceAuthHeaders:initialOpts.forceAuthHeaders});return client._useCache&&client._useRequestCache&&cache&&(cache[cacheID]=request),interopCallbackReturn(request,function(content){return content.body})},AlgoliaSearchCore.prototype._getSearchParams=function(args,params){if(args===void 0||null===args)return params;for(var key in args)null!==key&&void 0!==args[key]&&args.hasOwnProperty(key)&&(params+=''===params?'':'&',params+=key+'='+encodeURIComponent('[object Array]'===Object.prototype.toString.call(args[key])?safeJSONStringify(args[key]):args[key]));return params},AlgoliaSearchCore.prototype._computeRequestHeaders=function(options){var forEach=__webpack_require__(3),ua=options.additionalUA?this._ua+';'+options.additionalUA:this._ua,requestHeaders={"x-algolia-agent":ua,"x-algolia-application-id":this.applicationID};return!1!==options.withApiKey&&(requestHeaders['x-algolia-api-key']=this.apiKey),this.userToken&&(requestHeaders['x-algolia-usertoken']=this.userToken),this.securityTags&&(requestHeaders['x-algolia-tagfilters']=this.securityTags),forEach(this.extraHeaders,function addToRequestHeaders(value,key){requestHeaders[key]=value}),options.headers&&forEach(options.headers,function addToRequestHeaders(value,key){requestHeaders[key]=value}),requestHeaders},AlgoliaSearchCore.prototype.search=function(queries,opts,callback){var isArray=__webpack_require__(8),map=__webpack_require__(5);if(!isArray(queries))throw new Error('Usage: client.search(arrayOfQueries[, callback])');'function'==typeof opts?(callback=opts,opts={}):void 0===opts&&(opts={});var client=this,postObj={requests:map(queries,function prepareRequest(query){var params='';return void 0!==query.query&&(params+='query='+encodeURIComponent(query.query)),{indexName:query.indexName,params:client._getSearchParams(query.params,params)}})},JSONPParams=map(postObj.requests,function prepareJSONPParams(request,requestId){return requestId+'='+encodeURIComponent('/1/indexes/'+encodeURIComponent(request.indexName)+'?'+request.params)}).join('&'),url='/1/indexes/*/queries';return void 0!==opts.strategy&&(url+='?strategy='+opts.strategy),this._jsonRequest({cache:this.cache,method:'POST',url:url,body:postObj,hostType:'read',fallback:{method:'GET',url:'/1/indexes/*',body:{params:JSONPParams}},callback:callback})},AlgoliaSearchCore.prototype.searchForFacetValues=function(queries){var isArray=__webpack_require__(8),map=__webpack_require__(5),usage='Usage: client.searchForFacetValues([{indexName, params: {facetName, facetQuery, ...params}}, ...queries])';if(!isArray(queries))throw new Error(usage);var client=this;return client._promise.all(map(queries,function performQuery(query){if(!query||query.indexName===void 0||query.params.facetName===void 0||query.params.facetQuery===void 0)throw new Error(usage);var clone=__webpack_require__(1),omit=__webpack_require__(17),indexName=query.indexName,params=query.params,facetName=params.facetName,filteredParams=omit(clone(params),function(keyName){return'facetName'===keyName}),searchParameters=client._getSearchParams(filteredParams,'');return client._jsonRequest({cache:client.cache,method:'POST',url:'/1/indexes/'+encodeURIComponent(indexName)+'/facets/'+encodeURIComponent(facetName)+'/query',hostType:'read',body:{params:searchParameters}})}))},AlgoliaSearchCore.prototype.setSecurityTags=function(tags){if('[object Array]'===Object.prototype.toString.call(tags)){for(var strTags=[],i=0;i<tags.length;++i)if('[object Array]'===Object.prototype.toString.call(tags[i])){for(var oredTags=[],j=0;j<tags[i].length;++j)oredTags.push(tags[i][j]);strTags.push('('+oredTags.join(',')+')')}else strTags.push(tags[i]);tags=strTags.join(',')}this.securityTags=tags},AlgoliaSearchCore.prototype.setUserToken=function(userToken){this.userToken=userToken},AlgoliaSearchCore.prototype.clearCache=function(){this.cache={}},AlgoliaSearchCore.prototype.setRequestTimeout=function(milliseconds){milliseconds&&(this._timeouts.connect=this._timeouts.read=this._timeouts.write=milliseconds)},AlgoliaSearchCore.prototype.setTimeouts=function(timeouts){this._timeouts=timeouts},AlgoliaSearchCore.prototype.getTimeouts=function(){return this._timeouts},AlgoliaSearchCore.prototype._getAppIdData=function(){var data=store.get(this.applicationID);return null!==data&&this._cacheAppIdData(data),data},AlgoliaSearchCore.prototype._setAppIdData=function(data){return data.lastChange=new Date().getTime(),this._cacheAppIdData(data),store.set(this.applicationID,data)},AlgoliaSearchCore.prototype._checkAppIdData=function(){var data=this._getAppIdData(),now=new Date().getTime();return null===data||now-data.lastChange>RESET_APP_DATA_TIMER?this._resetInitialAppIdData(data):data},AlgoliaSearchCore.prototype._resetInitialAppIdData=function(data){var newData=data||{};return newData.hostIndexes={read:0,write:0},newData.timeoutMultiplier=1,newData.shuffleResult=newData.shuffleResult||shuffle([1,2,3]),this._setAppIdData(newData)},AlgoliaSearchCore.prototype._cacheAppIdData=function(data){this._hostIndexes=data.hostIndexes,this._timeoutMultiplier=data.timeoutMultiplier,this._shuffleResult=data.shuffleResult},AlgoliaSearchCore.prototype._partialAppIdDataUpdate=function(newData){var foreach=__webpack_require__(3),currentData=this._getAppIdData();return foreach(newData,function(value,key){currentData[key]=value}),this._setAppIdData(currentData)},AlgoliaSearchCore.prototype._getHostByType=function(hostType){return this.hosts[hostType][this._getHostIndexByType(hostType)]},AlgoliaSearchCore.prototype._getTimeoutMultiplier=function(){return this._timeoutMultiplier},AlgoliaSearchCore.prototype._getHostIndexByType=function(hostType){return this._hostIndexes[hostType]},AlgoliaSearchCore.prototype._setHostIndexByType=function(hostIndex,hostType){var clone=__webpack_require__(1),newHostIndexes=clone(this._hostIndexes);return newHostIndexes[hostType]=hostIndex,this._partialAppIdDataUpdate({hostIndexes:newHostIndexes}),hostIndex},AlgoliaSearchCore.prototype._incrementHostIndex=function(hostType){return this._setHostIndexByType((this._getHostIndexByType(hostType)+1)%this.hosts[hostType].length,hostType)},AlgoliaSearchCore.prototype._incrementTimeoutMultipler=function(){var timeoutMultiplier=Math.max(this._timeoutMultiplier+1,4);return this._partialAppIdDataUpdate({timeoutMultiplier:timeoutMultiplier})},AlgoliaSearchCore.prototype._getTimeoutsForRequest=function(hostType){return{connect:this._timeouts.connect*this._timeoutMultiplier,complete:this._timeouts[hostType]*this._timeoutMultiplier}}}).call(exports,__webpack_require__(9))},function(module,exports,__webpack_require__){function IndexCore(algoliasearch,indexName){this.indexName=indexName,this.as=algoliasearch,this.typeAheadArgs=null,this.typeAheadValueOption=null,this.cache={}}var buildSearchMethod=__webpack_require__(16),deprecate=__webpack_require__(49),deprecatedMessage=__webpack_require__(50);module.exports=IndexCore,IndexCore.prototype.clearCache=function(){this.cache={}},IndexCore.prototype.search=buildSearchMethod('query'),IndexCore.prototype.similarSearch=buildSearchMethod('similarQuery'),IndexCore.prototype.browse=function(query,queryParameters,callback){var merge=__webpack_require__(52),indexObj=this,page,hitsPerPage;0===arguments.length||1===arguments.length&&'function'==typeof arguments[0]?(page=0,callback=arguments[0],query=void 0):'number'==typeof arguments[0]?(page=arguments[0],'number'==typeof arguments[1]?hitsPerPage=arguments[1]:'function'==typeof arguments[1]&&(callback=arguments[1],hitsPerPage=void 0),query=void 0,queryParameters=void 0):'object'==typeof arguments[0]?('function'==typeof arguments[1]&&(callback=arguments[1]),queryParameters=arguments[0],query=void 0):'string'==typeof arguments[0]&&'function'==typeof arguments[1]&&(callback=arguments[1],queryParameters=void 0),queryParameters=merge({},queryParameters||{},{page:page,hitsPerPage:hitsPerPage,query:query});var params=this.as._getSearchParams(queryParameters,'');return this.as._jsonRequest({method:'POST',url:'/1/indexes/'+encodeURIComponent(indexObj.indexName)+'/browse',body:{params:params},hostType:'read',callback:callback})},IndexCore.prototype.browseFrom=function(cursor,callback){return this.as._jsonRequest({method:'POST',url:'/1/indexes/'+encodeURIComponent(this.indexName)+'/browse',body:{cursor:cursor},hostType:'read',callback:callback})},IndexCore.prototype.searchForFacetValues=function(params,callback){var clone=__webpack_require__(1),omit=__webpack_require__(17);if(params.facetName===void 0||params.facetQuery===void 0)throw new Error('Usage: index.searchForFacetValues({facetName, facetQuery, ...params}[, callback])');var facetName=params.facetName,filteredParams=omit(clone(params),function(keyName){return'facetName'===keyName}),searchParameters=this.as._getSearchParams(filteredParams,'');return this.as._jsonRequest({method:'POST',url:'/1/indexes/'+encodeURIComponent(this.indexName)+'/facets/'+encodeURIComponent(facetName)+'/query',hostType:'read',body:{params:searchParameters},callback:callback})},IndexCore.prototype.searchFacet=deprecate(function(params,callback){return this.searchForFacetValues(params,callback)},deprecatedMessage('index.searchFacet(params[, callback])','index.searchForFacetValues(params[, callback])')),IndexCore.prototype._search=function(params,url,callback,additionalUA){return this.as._jsonRequest({cache:this.cache,method:'POST',url:url||'/1/indexes/'+encodeURIComponent(this.indexName)+'/query',body:{params:params},hostType:'read',fallback:{method:'GET',url:'/1/indexes/'+encodeURIComponent(this.indexName),body:{params:params}},callback:callback,additionalUA:additionalUA})},IndexCore.prototype.getObject=function(objectID,attrs,callback){var indexObj=this;(1===arguments.length||'function'==typeof attrs)&&(callback=attrs,attrs=void 0);var params='';if(attrs!==void 0){params='?attributes=';for(var i=0;i<attrs.length;++i)0!==i&&(params+=','),params+=attrs[i]}return this.as._jsonRequest({method:'GET',url:'/1/indexes/'+encodeURIComponent(indexObj.indexName)+'/'+encodeURIComponent(objectID)+params,hostType:'read',callback:callback})},IndexCore.prototype.getObjects=function(objectIDs,attributesToRetrieve,callback){var isArray=__webpack_require__(8),map=__webpack_require__(5);if(!isArray(objectIDs))throw new Error('Usage: index.getObjects(arrayOfObjectIDs[, callback])');var indexObj=this;(1===arguments.length||'function'==typeof attributesToRetrieve)&&(callback=attributesToRetrieve,attributesToRetrieve=void 0);var body={requests:map(objectIDs,function prepareRequest(objectID){var request={indexName:indexObj.indexName,objectID:objectID};return attributesToRetrieve&&(request.attributesToRetrieve=attributesToRetrieve.join(',')),request})};return this.as._jsonRequest({method:'POST',url:'/1/indexes/*/objects',hostType:'read',body:body,callback:callback})},IndexCore.prototype.as=null,IndexCore.prototype.indexName=null,IndexCore.prototype.typeAheadArgs=null,IndexCore.prototype.typeAheadValueOption=null},function(module,exports,__webpack_require__){'use strict';var AlgoliaSearchCore=__webpack_require__(43),createAlgoliasearch=__webpack_require__(46);module.exports=createAlgoliasearch(AlgoliaSearchCore,'(lite) ')},function(module,exports,__webpack_require__){'use strict';var global=__webpack_require__(141),Promise=global.Promise||__webpack_require__(138).Promise;module.exports=function createAlgoliasearch(AlgoliaSearch,uaSuffix){function algoliasearch(applicationID,apiKey,opts){var cloneDeep=__webpack_require__(1);return opts=cloneDeep(opts||{}),opts._ua=opts._ua||algoliasearch.ua,new AlgoliaSearchBrowser(applicationID,apiKey,opts)}function AlgoliaSearchBrowser(){AlgoliaSearch.apply(this,arguments)}var inherits=__webpack_require__(18),errors=__webpack_require__(4),inlineHeaders=__webpack_require__(47),jsonpRequest=__webpack_require__(48),places=__webpack_require__(53);uaSuffix=uaSuffix||'',!1,algoliasearch.version=__webpack_require__(55),algoliasearch.ua='Algolia for vanilla JavaScript '+uaSuffix+algoliasearch.version,algoliasearch.initPlaces=places(algoliasearch),global.__algolia={debug:__webpack_require__(7),algoliasearch:algoliasearch};var support={hasXMLHttpRequest:'XMLHttpRequest'in global,hasXDomainRequest:'XDomainRequest'in global};return support.hasXMLHttpRequest&&(support.cors='withCredentials'in new XMLHttpRequest),inherits(AlgoliaSearchBrowser,AlgoliaSearch),AlgoliaSearchBrowser.prototype._request=function request(url,opts){return new Promise(function wrapRequest(resolve,reject){function onTimeout(){timedOut=!0,req.abort(),reject(new errors.RequestTimeout)}function onConnect(){connected=!0,clearTimeout(reqTimeout),reqTimeout=setTimeout(onTimeout,opts.timeouts.complete)}if(!support.cors&&!support.hasXDomainRequest)return void reject(new errors.Network('CORS not supported'));url=inlineHeaders(url,opts.headers);var body=opts.body,req=support.cors?new XMLHttpRequest:new XDomainRequest,connected=!1,reqTimeout,timedOut;reqTimeout=setTimeout(onTimeout,opts.timeouts.connect),req.onprogress=function onProgress(){connected||onConnect()},'onreadystatechange'in req&&(req.onreadystatechange=function onReadyStateChange(){!connected&&1<req.readyState&&onConnect()}),req.onload=function onLoad(){if(!timedOut){clearTimeout(reqTimeout);var out;try{out={body:JSON.parse(req.responseText),responseText:req.responseText,statusCode:req.status,headers:req.getAllResponseHeaders&&req.getAllResponseHeaders()||{}}}catch(e){out=new errors.UnparsableJSON({more:req.responseText})}out instanceof errors.UnparsableJSON?reject(out):resolve(out)}},req.onerror=function onError(event){timedOut||(clearTimeout(reqTimeout),reject(new errors.Network({more:event})))},req instanceof XMLHttpRequest?(req.open(opts.method,url,!0),opts.forceAuthHeaders&&(req.setRequestHeader('x-algolia-application-id',opts.headers['x-algolia-application-id']),req.setRequestHeader('x-algolia-api-key',opts.headers['x-algolia-api-key']))):req.open(opts.method,url),support.cors&&(body&&('POST'===opts.method?req.setRequestHeader('content-type','application/x-www-form-urlencoded'):req.setRequestHeader('content-type','application/json')),req.setRequestHeader('accept','application/json')),body?req.send(body):req.send()})},AlgoliaSearchBrowser.prototype._request.fallback=function requestFallback(url,opts){return url=inlineHeaders(url,opts.headers),new Promise(function wrapJsonpRequest(resolve,reject){jsonpRequest(url,opts,function jsonpRequestDone(err,content){return err?void reject(err):void resolve(content)})})},AlgoliaSearchBrowser.prototype._promise={reject:function rejectPromise(val){return Promise.reject(val)},resolve:function resolvePromise(val){return Promise.resolve(val)},delay:function delayPromise(ms){return new Promise(function resolveOnTimeout(resolve){setTimeout(resolve,ms)})},all:function all(promises){return Promise.all(promises)}},algoliasearch}},function(module,exports,__webpack_require__){'use strict';module.exports=function inlineHeaders(url,headers){return url+=/\?/.test(url)?'&':'?',url+encode(headers)};var encode=__webpack_require__(144)},function(module,exports,__webpack_require__){'use strict';module.exports=function jsonpRequest(url,opts,cb){function success(){opts.debug('JSONP: success');done||timedOut||(done=!0,!cbCalled&&(opts.debug('JSONP: Fail. Script loaded but did not call the callback'),clean(),cb(new errors.JSONPScriptFail)))}function clean(){clearTimeout(ontimeout),script.onload=null,script.onreadystatechange=null,script.onerror=null,head.removeChild(script)}function removeGlobals(){try{delete window[cbName],delete window[cbName+'_loaded']}catch(e){window[cbName]=window[cbName+'_loaded']=void 0}}if('GET'!==opts.method)return void cb(new Error('Method '+opts.method+' '+url+' is not supported by JSONP.'));opts.debug('JSONP: start');var cbCalled=!1,timedOut=!1;JSONPCounter+=1;var head=document.getElementsByTagName('head')[0],script=document.createElement('script'),cbName='algoliaJSONP_'+JSONPCounter,done=!1;window[cbName]=function(data){return removeGlobals(),timedOut?void opts.debug('JSONP: Late answer, ignoring'):void(cbCalled=!0,clean(),cb(null,{body:data,responseText:JSON.stringify(data)}))},url+='&callback='+cbName,opts.jsonBody&&opts.jsonBody.params&&(url+='&'+opts.jsonBody.params);var ontimeout=setTimeout(function timeout(){opts.debug('JSONP: Script timeout'),timedOut=!0,clean(),cb(new errors.RequestTimeout)},opts.timeouts.complete);script.onreadystatechange=function readystatechange(){('loaded'===this.readyState||'complete'===this.readyState)&&success()},script.onload=success,script.onerror=function error(){opts.debug('JSONP: Script error');done||timedOut||(clean(),cb(new errors.JSONPScriptError))},script.async=!0,script.defer=!0,script.src=url,head.appendChild(script)};var errors=__webpack_require__(4),JSONPCounter=0},function(module){module.exports=function deprecate(fn,message){var warned=!1;return function deprecated(){return warned||(console.warn(message),warned=!0),fn.apply(this,arguments)}}},function(module){module.exports=function deprecatedMessage(previousUsage,newUsage){var githubAnchorLink=previousUsage.toLowerCase().replace(/[\.\(\)]/g,'');return'algoliasearch: `'+previousUsage+'` was replaced by `'+newUsage+'`. Please see https://github.com/algolia/algoliasearch-client-javascript/wiki/Deprecated#'+githubAnchorLink}},function(module){module.exports=function exitPromise(fn,_setTimeout){_setTimeout(fn,0)}},function(module,exports,__webpack_require__){var foreach=__webpack_require__(3);module.exports=function merge(destination){var sources=Array.prototype.slice.call(arguments);return foreach(sources,function(source){for(var keyName in source)source.hasOwnProperty(keyName)&&('object'==typeof destination[keyName]&&'object'==typeof source[keyName]?destination[keyName]=merge({},destination[keyName],source[keyName]):void 0!==source[keyName]&&(destination[keyName]=source[keyName]))}),destination}},function(module,exports,__webpack_require__){module.exports=function createPlacesClient(algoliasearch){return function places(appID,apiKey,opts){var cloneDeep=__webpack_require__(1);opts=opts&&cloneDeep(opts)||{},opts.hosts=opts.hosts||['places-dsn.algolia.net','places-1.algolianet.com','places-2.algolianet.com','places-3.algolianet.com'],(0===arguments.length||'object'==typeof appID||void 0===appID)&&(appID='',apiKey='',opts._allowEmptyCredentials=!0);var client=algoliasearch(appID,apiKey,opts),index=client.initIndex('places');return index.search=buildSearchMethod('query','/1/places/query'),index.getObject=function(objectID,callback){return this.as._jsonRequest({method:'GET',url:'/1/places/'+encodeURIComponent(objectID),hostType:'read',callback:callback})},index}};var buildSearchMethod=__webpack_require__(16)},function(module,exports,__webpack_require__){(function(global){function localStorageFailure(key,e){return debug('localStorage failed with',e),cleanup(),store=moduleStore,store.get(key)}function getOrSet(key,data){return 1===arguments.length?store.get(key):store.set(key,data)}function supportsLocalStorage(){try{return'localStorage'in global&&null!==global.localStorage&&(global.localStorage[localStorageNamespace]||global.localStorage.setItem(localStorageNamespace,JSON.stringify({})),!0)}catch(_){return!1}}function cleanup(){try{global.localStorage.removeItem(localStorageNamespace)}catch(_){}}var debug=__webpack_require__(7)('algoliasearch:src/hostIndexState.js'),localStorageNamespace='algoliasearch-client-js',moduleStore={state:{},set:function(key,data){return this.state[key]=data,this.state[key]},get:function(key){return this.state[key]||null}},store;store=supportsLocalStorage()?{set:function(key,data){moduleStore.set(key,data);try{var namespace=JSON.parse(global.localStorage[localStorageNamespace]);return namespace[key]=data,global.localStorage[localStorageNamespace]=JSON.stringify(namespace),namespace[key]}catch(e){return localStorageFailure(key,e)}},get:function(key){try{return JSON.parse(global.localStorage[localStorageNamespace])[key]||null}catch(e){return localStorageFailure(key,e)}}}:moduleStore,module.exports={get:getOrSet,set:getOrSet,supportsLocalStorage:supportsLocalStorage}}).call(exports,__webpack_require__(0))},function(module){'use strict';module.exports='3.29.0'},function(module){module.exports={vertexShader:`
    varying vec2 uvs;
    void main() {
      uvs.xy = uv.xy;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
  `,fragmentShader:`
    varying vec2 uvs;
    uniform sampler2D src;

    void main() {
      gl_FragColor = texture2D(src, uvs);
    }
`}},function(module){module.exports={vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 tunnelNeon;
    uniform vec3 leftLaser;
    uniform vec3 rightLaser;
    uniform vec3 floorNeon;
    uniform vec3 textGlow;
    uniform sampler2D src;

    void main() {
      float mask;
      vec4 col = texture2D(src, uvs);

      // tunnel neon
      mask = step(0.87, uvs.x) *  step(0.5, uvs.y) * (1.0 - step(0.935, uvs.x)) * ( 1.0 - step(0.75, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * tunnelNeon, mask);

      // floor & corridor neons
      mask = step(0.935, uvs.x) * step(0.5, uvs.y) * ( 1.0 - step(0.75, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * floorNeon, mask);

      // left laser
      mask = step(0.5, uvs.x) * (1.0 - step(0.625, uvs.x)) * (1.0 - step(0.5, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * leftLaser, mask);

      // right laser
      mask = step(0.625, uvs.x) * (1.0 - step(0.75, uvs.x)) * (1.0 - step(0.5, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * rightLaser, mask);

      // text glows
      mask = step(0.87, uvs.x) *  step(0.25, uvs.y) * (1.0 - step(0.935, uvs.x)) * ( 1.0 - step(0.5, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * textGlow, mask);

      gl_FragColor = col;
    }
  `}},function(module){module.exports={vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    #define FOG_RADIUS  55.0
    #define FOG_FALLOFF 48.0
    #define FOG_COLOR_MULT 0.8
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 skyColor;
    uniform vec3 backglowColor;
    uniform sampler2D src;

    void main() {
      vec4 col = texture2D(src, uvs);
      float mask;

      // bg
      mask = step(0.5, uvs.x);
      col.xyz = mix(col.xyz * skyColor, col.xyz, mask);

      // backglow
      mask = step(0.5, uvs.x) * step(0.5, uvs.y) * (1.0 - step(0.75, uvs.x));
      col.xyz = mix(col.xyz, col.xyz * backglowColor, mask);

      float fogDensity = 1.0 - pow(clamp(distance(worldPos, vec3(0., 0., -FOG_RADIUS)) / FOG_FALLOFF, 0.0, 1.0), 1.5);
      fogDensity += clamp(0.2 - pow(distance(worldPos, vec3(0.0, 0.0, worldPos.z)) / 10.0, 2.0), 0.0, 1.0);
      col.xyz = mix(col.xyz, backglowColor * FOG_COLOR_MULT, fogDensity);

      gl_FragColor = col;
    }
  `}},function(){AFRAME.registerComponent('active-color',{dependencies:['material'],schema:{active:{default:!1},color:{default:'#ffffff'}},init:function(){this.defaultColor=this.el.getAttribute('material').color,this.materialObj={color:this.data.color,opacity:1}},update:function(){var el=this.el;this.data.active?(el.setAttribute('material',this.materialObj),el.object3D.visible=!0):(el.setAttribute('material','color',this.defaultColor),el.components.animation__mouseleave&&setTimeout(()=>{el.emit('mouseleave',null,!1)}))}}),AFRAME.registerComponent('active-text-color',{dependencies:['text'],schema:{active:{default:!1},color:{default:'#333'}},init:function(){this.defaultColor=this.el.getAttribute('text').color},update:function(){var el=this.el;this.data.active?el.setAttribute('text','color',this.data.color):el.setAttribute('text','color',this.defaultColor)}})},function(){const NUM_VALUES_PER_BOX=90;AFRAME.registerComponent('audio-columns',{schema:{analyser:{type:'selector',default:'#audioAnalyser'},height:{default:1},mirror:{default:3},scale:{default:4},separation:{default:0.3},thickness:{default:0.1}},init:function(){var objData=document.getElementById('audiocolumnObj').data,loader=new THREE.OBJLoader,columnGeometry=loader.parse(objData).children[0].geometry;this.analyser=this.data.analyser.components.audioanalyser,this.frequencyBinCount=this.analyser.data.fftSize/2;const geometries=[];let zPosition=0;for(let i=0;i<this.frequencyBinCount;i++)for(let side=0;2>side;side++){const box=columnGeometry.clone();this.initBox(box,0===side?1:-1,zPosition),geometries.push(box),zPosition-=this.data.separation}this.geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);const mesh=new THREE.Mesh(this.geometry,this.el.sceneEl.systems.materials.stageNormal);this.el.setObject3D('mesh',mesh)},tick:function(){for(let i=0,yScale;i<2*this.frequencyBinCount;i+=2){if(yScale=this.data.height/2+this.analyser.levels[Math.floor(i/2)]/256*this.data.scale,isNaN(yScale))return;this.setBoxHeight(2*this.frequencyBinCount-i-1,yScale),this.setBoxHeight(2*this.frequencyBinCount-i-2,yScale),this.geometry.attributes.position.needsUpdate=!0}},initBox:function(box,flip,zPosition){const data=this.data;for(let v=0;v<box.attributes.position.array.length;v+=3)box.attributes.position.array[v+2]+=zPosition,box.attributes.position.array[v+1]*=data.height/2,box.attributes.position.array[v]+=flip*data.mirror},setBoxHeight:function(boxNumber,height){const boxIndex=boxNumber*NUM_VALUES_PER_BOX;for(let i=boxIndex,yValue;i<boxIndex+NUM_VALUES_PER_BOX;i+=3)yValue=this.geometry.attributes.position.array[i+1],this.geometry.attributes.position.array[i+1]=0<=yValue?height:-1*height}})},function(){const ANIME=AFRAME.ANIME||AFRAME.anime;AFRAME.registerComponent('beams',{schema:{isPlaying:{default:!1},poolSize:{default:3}},init:function(){this.beams=[],this.currentRed=0,this.currentBlue=0,this.clearBeams=this.clearBeams.bind(this),this.el.sceneEl.addEventListener('cleargame',this.clearBeams)},update:function(){for(let i=0;i<this.beams.length;i++)this.beams[i].time&&(this.beams[i].visible=this.data.isPlaying)},play:function(){var loader=new THREE.OBJLoader,objData,loader,redGeometry,blueGeometry;objData=document.getElementById('redbeamObj').data,redGeometry=loader.parse(objData).children[0].geometry,objData=document.getElementById('bluebeamObj').data,blueGeometry=loader.parse(objData).children[0].geometry,this.redBeams=this.createBeamPool(redGeometry,this.el.sceneEl.systems.materials.stageAdditive),this.blueBeams=this.createBeamPool(blueGeometry,this.el.sceneEl.systems.materials.stageAdditive)},tick:function(t,dt){if(this.data.isPlaying)for(let i=0,beam;i<this.beams.length;i++)(beam=this.beams[i],!!beam.visible)&&(beam.time+=dt,beam.animation.tick(beam.time))},createBeamPool:function(geometry,material){const beams=[];for(let i=0,beam;i<this.data.poolSize;i++)beam=new THREE.Mesh(geometry,material),beam.visible=!1,beam.animation=ANIME({autoplay:!1,targets:beam.scale,x:1e-5,duration:300,easing:'easeInCubic',complete:()=>{beam.visible=!1}}),this.el.object3D.add(beam),beams.push(beam),this.beams.push(beam);return beams},newBeam:function(color,position){var beam;'red'===color?(beam=this.redBeams[this.currentRed],this.currentRed=(this.currentRed+1)%this.redBeams.length,beam.position.set(position.x,position.y,position.z+this.currentRed/50)):(beam=this.blueBeams[this.currentBlue],this.currentBlue=(this.currentBlue+1)%this.blueBeams.length,beam.position.set(position.x,position.y,position.z+this.currentBlue/50)),beam.visible=!0,beam.scale.x=1,beam.time=0},clearBeams:function(){for(let i=0;i<this.beams.length;i++)this.beams[i].visible=!1,this.beams[i].time=0,this.beams[i].scale.x=1}})},function(){var audioContext=new window.AudioContext,sourceCreatedCallback;const LAYER_BOTTOM='bottom',LAYER_TOP='top',VOLUME=0.25;THREE.Audio.prototype.play=function(){if(!0===this.isPlaying)return void console.warn('THREE.Audio: Audio is already playing.');if(!1===this.hasPlaybackControl)return void console.warn('THREE.Audio: this Audio has no playback control.');var source=this.context.createBufferSource();return source.buffer=this.buffer,source.detune.value=this.detune,source.loop=this.loop,source.onended=this.onEnded.bind(this),source.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,sourceCreatedCallback&&sourceCreatedCallback(source),source.start(this.startTime,this.offset),this.isPlaying=!0,this.source=source,this.connect()},AFRAME.registerComponent('beat-hit-sound',{directionsToSounds:{up:'',down:'',upleft:'left',upright:'right',downleft:'left',downright:'right',left:'left',right:'right'},init:function(){this.currentBeatEl=null,this.currentCutDirection='',this.processSound=this.processSound.bind(this),sourceCreatedCallback=this.sourceCreatedCallback.bind(this);for(let i=1;10>=i;i++)this.el.setAttribute(`sound__beathit${i}`,{poolSize:4,src:`#hitSound${i}`,volume:VOLUME}),this.el.setAttribute(`sound__beathit${i}left`,{poolSize:4,src:`#hitSound${i}left`,volume:VOLUME}),this.el.setAttribute(`sound__beathit${i}right`,{poolSize:4,src:`#hitSound${i}right`,volume:VOLUME})},play:function(){for(let i=1;10>=i;i++)this.el.components[`sound__beathit${i}`].loaded||(this.el.setAttribute(`sound__beathit${i}`,'src',''),this.el.setAttribute(`sound__beathit${i}`,'src',`#hitSound${i}`)),this.el.components[`sound__beathit${i}left`].loaded||(this.el.setAttribute(`sound__beathit${i}left`,'src',''),this.el.setAttribute(`sound__beathit${i}left`,'src',`#hitSound${i}left`)),this.el.components[`sound__beathit${i}right`].loaded||(this.el.setAttribute(`sound__beathit${i}right`,'src',''),this.el.setAttribute(`sound__beathit${i}right`,'src',`#hitSound${i}right`))},playSound:function(beatEl,cutDirection){const rand=1+Math.floor(10*Math.random()),dir=this.directionsToSounds[cutDirection||'up'],soundPool=this.el.components[`sound__beathit${rand}${dir}`];this.currentBeatEl=beatEl,soundPool.playSound(this.processSound)},processSound:function(audio){audio.detune=0,this.currentBeatEl.object3D.getWorldPosition(audio.position)},sourceCreatedCallback:function(source){const layer=this.getLayer(this.currentBeatEl.object3D.position.y);layer===LAYER_BOTTOM?source.detune.setValueAtTime(-400,0):layer===LAYER_TOP&&source.detune.setValueAtTime(200,0),'down'===this.currentCutDirection&&source.detune.linearRampToValueAtTime(-400,1),'up'===this.currentCutDirection&&source.detune.linearRampToValueAtTime(400,1)},getLayer:function(y){return 1===y?LAYER_BOTTOM:1.7===y?LAYER_TOP:'middle'}})},function(module,__webpack_exports__,__webpack_require__){'use strict';function lessThan(a,b){return a._time-b._time}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__constants_beat__=__webpack_require__(10),__WEBPACK_IMPORTED_MODULE_1__utils__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_1__utils___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__utils__);let skipDebug=AFRAME.utils.getUrlParameter('skip')||0;skipDebug=parseInt(skipDebug,10),AFRAME.registerComponent('beat-loader',{dependencies:['stage-colors'],schema:{beatAnticipationTime:{default:1.1},beatSpeed:{default:8},beatWarmupTime:{default:__WEBPACK_IMPORTED_MODULE_0__constants_beat__.b/1e3},beatWarmupSpeed:{default:__WEBPACK_IMPORTED_MODULE_0__constants_beat__.a},challengeId:{type:'string'},difficulty:{type:'string'},isPlaying:{default:!1},menuSelectedChallengeId:{type:'string'}},orientationsHumanized:['up','down','left','right','upleft','upright','downleft','downright'],horizontalPositions:[-0.75,-0.25,0.25,0.75],horizontalPositionsHumanized:{0:'left',1:'middleleft',2:'middleright',3:'right'},positionHumanized:{topLeft:{layer:2,index:0},topCenterLeft:{layer:2,index:1},topCenterRight:{layer:2,index:2},topRight:{layer:2,index:3},middleLeft:{layer:1,index:0},middleCenterLeft:{layer:1,index:1},middleCenterRight:{layer:1,index:2},middleRight:{layer:1,index:3},bottomLeft:{layer:0,index:0},bottomCenterLeft:{layer:0,index:1},bottomCenterRight:{layer:0,index:2},bottomRight:{layer:0,index:3}},verticalPositionsHumanized:{0:'bottom',1:'middle',2:'top'},init:function(){this.audioAnalyserEl=document.getElementById('audioanalyser'),this.beatData=null,this.beatDataProcessed=!1,this.beatContainer=document.getElementById('beatContainer'),this.beatsTime=void 0,this.beatsPreloadTime=0,this.beatsPreloadTimeTotal=1e3*(this.data.beatAnticipationTime+this.data.beatWarmupTime),this.bpm=void 0,this.xhr=null,this.stageColors=this.el.components['stage-colors'],this.swordOffset=1.5,this.twister=document.getElementById('twister'),this.leftStageLasers=document.getElementById('leftStageLasers'),this.rightStageLasers=document.getElementById('rightStageLasers'),this.el.addEventListener('cleargame',this.clearBeats.bind(this))},update:function(oldData){const data=this.data;return!oldData.challengeId&&data.challengeId&&this.beatData?void this.processBeats():void(!data.menuSelectedChallengeId||!data.difficulty||(data.menuSelectedChallengeId!==oldData.menuSelectedChallengeId||data.difficulty!==oldData.difficulty)&&this.fetchBeats())},fetchBeats:function(){var el=this.el;this.xhr&&this.xhr.abort();let url=__WEBPACK_IMPORTED_MODULE_1__utils___default.a.getS3FileUrl(this.data.menuSelectedChallengeId,`${this.data.difficulty}.json`);const xhr=this.xhr=new XMLHttpRequest;el.emit('beatloaderstart'),console.log(`[beat-loader] Fetching ${url}...`),xhr.open('GET',url),xhr.addEventListener('load',()=>{this.beatData=JSON.parse(xhr.responseText),this.beatDataProcessed=!1,this.xhr=null,this.el.sceneEl.emit('beatloaderfinish',null,!1)}),xhr.send()},processBeats:function(){this.beatsTime=0,this.beatsPreloadTime=0,this.beatData._events.sort(lessThan),this.beatData._obstacles.sort(lessThan),this.beatData._notes.sort(lessThan),this.bpm=this.beatData._beatsPerMinute;const events=this.beatData._events;if(events.length&&0>events[0]._time)for(let i=0;0>events[i]._time;i++)this.generateEvent(events[i]);this.beatDataProcessed=!0,console.log('[beat-loader] Finished processing beat data.')},tick:function(time,delta){if(this.data.isPlaying&&this.data.challengeId&&this.beatData){const prevBeatsTime=this.beatsTime+skipDebug;if(void 0===this.beatsPreloadTime){const song=this.el.components.song;if(!song.isPlaying)return;this.beatsTime=1e3*(song.getCurrentTime()+this.data.beatAnticipationTime+this.data.beatWarmupTime)}else this.beatsTime=this.beatsPreloadTime;const beatsTime=this.beatsTime+skipDebug,bpm=this.beatData._beatsPerMinute,msPerBeat=1e3*60/this.beatData._beatsPerMinute,notes=this.beatData._notes;for(let i=0,noteTime;i<notes.length;++i)noteTime=notes[i]._time*msPerBeat,noteTime>prevBeatsTime&&noteTime<=beatsTime&&(notes[i].time=noteTime,this.generateBeat(notes[i]));const obstacles=this.beatData._obstacles;for(let i=0,noteTime;i<obstacles.length;++i)noteTime=obstacles[i]._time*msPerBeat,noteTime>prevBeatsTime&&noteTime<=beatsTime&&this.generateWall(obstacles[i]);const events=this.beatData._events;for(let i=0,noteTime;i<events.length;++i)noteTime=events[i]._time*msPerBeat,noteTime>prevBeatsTime&&noteTime<=beatsTime&&this.generateEvent(events[i]);void 0===this.beatsPreloadTime||(this.beatsPreloadTime>=this.beatsPreloadTimeTotal?(this.el.sceneEl.emit('beatloaderpreloadfinish',null,!1),this.beatsPreloadTime=void 0):this.beatsPreloadTime+=delta)}},generateBeat:function(){const beatObj={};return function(noteInfo){const data=this.data;let type=8===noteInfo._cutDirection?'dot':'arrow',color;0===noteInfo._type?color='red':1===noteInfo._type?color='blue':(type='mine',color=void 0);const beatEl=this.requestBeat(type,color);beatEl&&(beatObj.anticipationPosition=-data.beatAnticipationTime*data.beatSpeed-this.swordOffset,beatObj.color=color,beatObj.cutDirection=this.orientationsHumanized[noteInfo._cutDirection],beatObj.horizontalPosition=this.horizontalPositionsHumanized[noteInfo._lineIndex],beatObj.speed=this.data.beatSpeed,beatObj.type=type,beatObj.verticalPosition=this.verticalPositionsHumanized[noteInfo._lineLayer],beatObj.warmupPosition=-data.beatWarmupTime*data.beatWarmupSpeed,beatEl.setAttribute('beat',beatObj),beatEl.components.beat.updatePosition(),beatEl.play(),beatEl.components.beat.onGenerate())}}(),generateWall:function(){const wallObj={};return function(wallInfo){const el=this.el.sceneEl.components.pool__wall.requestEntity();if(el){const data=this.data,speed=this.data.beatSpeed,durationSeconds=60*(wallInfo._duration/this.bpm);wallObj.anticipationPosition=-data.beatAnticipationTime*data.beatSpeed-this.swordOffset,wallObj.durationSeconds=durationSeconds,wallObj.horizontalPosition=this.horizontalPositionsHumanized[wallInfo._lineIndex],wallObj.isCeiling=1===wallInfo._type,wallObj.speed=speed,wallObj.warmupPosition=-data.beatWarmupTime*data.beatWarmupSpeed,wallObj.width=wallInfo._width,el.setAttribute('wall',wallObj),el.play()}}}(),generateEvent:function(event){switch(event._type){case 0:this.stageColors.setColor('bg',event._value);break;case 1:this.stageColors.setColor('tunnel',event._value);break;case 2:this.stageColors.setColor('leftlaser',event._value);break;case 3:this.stageColors.setColor('rightlaser',event._value);break;case 4:this.stageColors.setColor('floor',event._value);break;case 8:this.twister.components.twister.pulse(event._value);break;case 9:this.twister.components.twister.pulse(event._value);break;case 12:this.leftStageLasers.components['stage-lasers'].pulse(event._value);break;case 13:this.rightStageLasers.components['stage-lasers'].pulse(event._value);}},requestBeat:function(type,color){var beatPoolName='pool__beat-'+type,pool;return color&&(beatPoolName+='-'+color),pool=this.el.sceneEl.components[beatPoolName],pool?pool.requestEntity():void console.warn('Pool '+beatPoolName+' unavailable')},clearBeats:function(){this.beatsPreloadTime=0,this.beatsTime=0;for(let i=0,child;i<this.beatContainer.children.length;i++)child=this.beatContainer.children[i],child.components.beat&&child.components.beat.returnToPool(!0),child.components.wall&&child.components.wall.returnToPool(!0)}})},function(module,__webpack_exports__,__webpack_require__){'use strict';function getGravityVelocity(velocity,timeDelta){return velocity+-9.8*(timeDelta/1e3)}var _MathPI2=Math.PI,_Mathmax4=Math.max;Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__constants_beat__=__webpack_require__(10);const COLORS=__webpack_require__(6),auxObj3D=new THREE.Object3D,BEAT_WARMUP_ROTATION_TIME=750,DESTROYED_SPEED=1,ONCE={once:!0},SCORE_POOL={OK:'pool__beatscoreok',GOOD:'pool__beatscoregood',GREAT:'pool__beatscoregreat',SUPER:'pool__beatscoresuper'};AFRAME.registerComponent('beat',{schema:{anticipationPosition:{default:0},color:{default:'red',oneOf:['red','blue']},cutDirection:{default:'down'},debug:{default:!1},horizontalPosition:{default:'middleleft',oneOf:['left','middleleft','middleright','right']},size:{default:0.4},speed:{default:8},type:{default:'arrow',oneOf:['arrow','dot','mine']},verticalPosition:{default:'middle',oneOf:['bottom','middle','top']},warmupPosition:{default:0}},materialColor:{blue:COLORS.BEAT_BLUE,red:COLORS.BEAT_RED},cutColor:{blue:'#fff',red:'#fff'},models:{arrow:'beatObjTemplate',dot:'beatObjTemplate',mine:'mineObjTemplate'},signModels:{arrowred:'arrowRedObjTemplate',arrowblue:'arrowBlueObjTemplate',dotred:'dotRedObjTemplate',dotblue:'dotBlueObjTemplate'},orientations:[180,0,270,90,225,135,315,45,0],rotations:{up:180,down:0,left:270,right:90,upleft:225,upright:135,downleft:315,downright:45},horizontalPositions:{left:-0.75,middleleft:-0.25,middleright:0.25,right:0.75},verticalPositions:{bottom:0.7,middle:1.2,top:1.7},init:function(){this.backToPool=!1,this.beams=document.getElementById('beams').components.beams,this.beatBoundingBox=new THREE.Box3,this.currentRotationWarmupTime=0,this.cutDirection=new THREE.Vector3,this.destroyed=!1,this.gravityVelocity=0,this.hitEventDetail={},this.hitBoundingBox=new THREE.Box3,this.poolName=void 0,this.returnToPoolTimer=800,this.rotationAxis=new THREE.Vector3,this.saberEls=this.el.sceneEl.querySelectorAll('[saber-controls]'),this.scoreEl=null,this.scoreElTime=void 0,this.startPositionZ=void 0,this.rightCutPlanePoints=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.leftCutPlanePoints=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.mineParticles=document.getElementById('mineParticles'),this.wrongElLeft=document.getElementById('wrongLeft'),this.wrongElRight=document.getElementById('wrongRight'),this.missElLeft=document.getElementById('missLeft'),this.missElRight=document.getElementById('missRight'),this.particles=document.getElementById('saberParticles'),this.mineParticles=document.getElementById('mineParticles'),this.superCuts=document.querySelectorAll('.superCutFx'),this.superCutIdx=0,this.explodeEventDetail={position:null,rotation:null},this.saberColors={right:'blue',left:'red'},this.onEndStroke=this.onEndStroke.bind(this),this.initBlock(),'mine'===this.data.type?this.initMineFragments():this.initFragments()},updatePosition:function(){const el=this.el,data=this.data;el.object3D.position.set(this.horizontalPositions[data.horizontalPosition],this.verticalPositions[data.verticalPosition],data.anticipationPosition+data.warmupPosition),el.object3D.rotation.z=THREE.Math.degToRad(this.rotations[data.cutDirection])},update:function(){this.updatePosition(),this.updateBlock(),this.updateFragments(),this.poolName='mine'===this.data.type?`pool__beat-mine`:`pool__beat-${this.data.type}-${this.data.color}`},pause:function(){this.el.object3D.visible=!1,'mine'!==this.data.type&&(this.partLeftEl.object3D.visible=!1,this.partRightEl.object3D.visible=!1)},play:function(){this.blockEl.object3D.visible=!0,this.destroyed=!1,this.el.object3D.visible=!0},tock:function(time,timeDelta){const el=this.el,data=this.data,position=el.object3D.position,rotation=el.object3D.rotation;if(this.destroyed)this.tockDestroyed(timeDelta);else{if(position.z>-1.65&&this.checkCollisions(),position.z<data.anticipationPosition){let newPositionZ=position.z+__WEBPACK_IMPORTED_MODULE_0__constants_beat__.a*(timeDelta/1e3);newPositionZ<data.anticipationPosition?position.z=newPositionZ:(position.z=data.anticipationPosition,this.beams.newBeam(this.data.color,position))}else position.z+=this.data.speed*(timeDelta/1e3),rotation.z=this.startRotationZ;if(position.z>data.anticipationPosition-0.4&&this.currentRotationWarmupTime<BEAT_WARMUP_ROTATION_TIME){const progress=AFRAME.ANIME.easings.easeOutBack(this.currentRotationWarmupTime/BEAT_WARMUP_ROTATION_TIME);el.object3D.rotation.z=this.rotationZStart+progress*this.rotationZChange,this.currentRotationWarmupTime+=timeDelta}this.backToPool=2<=position.z,this.backToPool&&this.missHit()}this.returnToPool()},onGenerate:function(){this.startRotationZ=this.el.object3D.rotation.z,this.currentRotationWarmupTime=0,this.rotationZChange=_MathPI2/5,0.5<Math.random&&(this.rotationZChange*=-1),this.el.object3D.rotation.z-=this.rotationZChange,this.rotationZStart=this.el.object3D.rotation.z,'mine'==this.data.type&&this.resetMineFragments()},initBlock:function(){var el=this.el,blockEl=this.blockEl=document.createElement('a-entity'),signEl=this.signEl=document.createElement('a-entity');blockEl.setAttribute('mixin','beatBlock'),blockEl.setAttribute('mixin','beatSign'),signEl.object3D.position.z+=0.02,blockEl.appendChild(signEl),el.appendChild(blockEl)},updateBlock:function(){const blockEl=this.blockEl,signEl=this.signEl;if(blockEl)if(blockEl.setAttribute('material',{metalness:0.7,roughness:0.1,sphericalEnvMap:'#envmapTexture',emissive:this.materialColor[this.data.color],emissiveIntensity:0.05,color:this.materialColor[this.data.color]}),this.setObjModelFromTemplate(blockEl,this.models[this.data.type]),blockEl.object3D.scale.set(1,1,1),blockEl.object3D.scale.multiplyScalar(3.45).multiplyScalar(this.data.size),'mine'===this.data.type){const model=blockEl.getObject3D('mesh');model?model.material=this.el.sceneEl.systems.materials['mineMaterial'+this.data.color]:blockEl.addEventListener('model-loaded',()=>{model.material=this.el.sceneEl.systems.materials['mineMaterial'+this.data.color]},ONCE)}else signEl.setAttribute('materials',{name:'stageAdditive'}),this.setObjModelFromTemplate(signEl,this.signModels[this.data.type+this.data.color])},initFragments:function(){var cutEl,partEl;partEl=this.partLeftEl=document.createElement('a-entity'),cutEl=this.cutLeftEl=document.createElement('a-entity'),partEl.appendChild(cutEl),this.el.appendChild(partEl),partEl=this.partRightEl=document.createElement('a-entity'),cutEl=this.cutRightEl=document.createElement('a-entity'),partEl.appendChild(cutEl),this.el.appendChild(partEl),this.initCuttingClippingPlanes()},initMineFragments:function(){var fragments=this.el.sceneEl.systems['mine-fragments-loader'].fragments.children,material=this.el.sceneEl.systems.materials['mineMaterial'+this.data.color],fragment;this.randVec=new THREE.Vector3(Math.random()*_MathPI2,Math.random()*_MathPI2,Math.random()*_MathPI2),this.mineFragments=[],this.mineBroken=document.createElement('a-entity'),this.el.appendChild(this.mineBroken);for(var i=0;i<fragments.length;i++)fragment=new THREE.Mesh(fragments[i].geometry,material),fragment.speed=new THREE.Vector3,fragment.speed.set(Math.random()-0.5,Math.random()-0.5,Math.random()-0.5),this.mineFragments.push(fragment),this.mineBroken.object3D.add(fragment)},updateFragments:function(){var cutLeftEl=this.cutLeftEl,cutRightEl=this.cutRightEl,partLeftEl=this.partLeftEl,partRightEl=this.partRightEl;return partLeftEl?'mine'===this.data.type?void this.resetMineFragments():void(partLeftEl.setAttribute('material',{metalness:0.7,roughness:0.1,sphericalEnvMap:'#envmapTexture',emissive:this.materialColor[this.data.color],emissiveIntensity:0.05,color:this.materialColor[this.data.color],side:'double'}),this.setObjModelFromTemplate(partLeftEl,this.models.dot),partLeftEl.object3D.visible=!1,cutLeftEl.setAttribute('material',{shader:'flat',color:this.data.cutColor,side:'double'}),this.setObjModelFromTemplate(cutLeftEl,this.models.dot),partRightEl.setAttribute('material',{metalness:0.7,roughness:0.1,sphericalEnvMap:'#envmapTexture',emissive:this.materialColor[this.data.color],emissiveIntensity:0.05,color:this.materialColor[this.data.color],side:'double'}),this.setObjModelFromTemplate(partRightEl,this.models.dot),partRightEl.object3D.visible=!1,cutRightEl.setAttribute('material',{shader:'flat',color:this.data.cutColor,side:'double'}),this.setObjModelFromTemplate(cutRightEl,this.models.dot)):void 0},resetMineFragments:function(){if('mine'===this.data.type)for(let i=0,fragment;i<this.mineFragments.length;i++)fragment=this.mineFragments[i],fragment.visible=!1,fragment.position.set(0,0,0),fragment.scale.set(1,1,1),fragment.speed.set(5*Math.random()-2.5,5*Math.random()-2.5,5*Math.random()-2.5)},wrongHit:function(hand){var wrongEl='left'===hand?this.wrongElLeft:this.wrongElRight;wrongEl&&(wrongEl.object3D.position.copy(this.el.object3D.position),wrongEl.object3D.position.y+=0.2,wrongEl.object3D.position.z-=0.5,wrongEl.object3D.visible=!0,wrongEl.emit('beatwrong',null,!0),this.destroyed=!0)},missHit:function(hand){var missEl='left'===hand?this.missElLeft:this.missElRight;missEl&&'mine'!==this.data.type&&(missEl.object3D.position.copy(this.el.object3D.position),missEl.object3D.position.y+=0.2,missEl.object3D.position.z-=0.5,missEl.object3D.visible=!0,missEl.emit('beatmiss',null,!0),AFRAME.utils.getUrlParameter('synctest')&&console.log(this.el.sceneEl.components.song.getCurrentTime()))},destroyBeat:function(){var parallelPlaneMaterial=new THREE.MeshBasicMaterial({color:'#00008b',side:THREE.DoubleSide}),planeMaterial=new THREE.MeshBasicMaterial({color:'grey',side:THREE.DoubleSide}),point1=new THREE.Vector3,point2=new THREE.Vector3,point3=new THREE.Vector3;return function(saberEl){var cutThickness=this.cutThickness=0.02,direction=this.cutDirection,leftBorderInnerPlane=this.leftBorderInnerPlane,leftBorderOuterPlane=this.leftBorderOuterPlane,leftCutPlane=this.leftCutPlane,rightBorderInnerPlane=this.rightBorderInnerPlane,rightBorderOuterPlane=this.rightBorderOuterPlane,rightCutPlane=this.rightCutPlane,trailPoints=saberEl.components.trail.saberTrajectory,coplanarPoint,planeGeometry,planeMesh;if(point1.copy(trailPoints[0].top),point2.copy(trailPoints[0].center),point3.copy(trailPoints[trailPoints.length-1].top),direction.copy(point1).sub(point3),this.partRightEl.object3D.position.set(0,0,0),this.partRightEl.object3D.rotation.set(0,0,0),this.partRightEl.object3D.updateMatrixWorld(),this.partRightEl.object3D.worldToLocal(this.rightCutPlanePoints[0].copy(point1)),this.partRightEl.object3D.worldToLocal(this.rightCutPlanePoints[1].copy(point2)),this.partRightEl.object3D.worldToLocal(this.rightCutPlanePoints[2].copy(point3)),this.partLeftEl.object3D.position.set(0,0,0),this.partLeftEl.object3D.rotation.set(0,0,0),this.partLeftEl.object3D.updateMatrixWorld(),this.partLeftEl.object3D.worldToLocal(this.leftCutPlanePoints[0].copy(point3)),this.partLeftEl.object3D.worldToLocal(this.leftCutPlanePoints[1].copy(point2)),this.partLeftEl.object3D.worldToLocal(this.leftCutPlanePoints[2].copy(point1)),this.generateCutClippingPlanes(),this.data.debug){coplanarPoint=new THREE.Vector3,planeGeometry=new THREE.PlaneGeometry(4,4,1,1),rightCutPlane.coplanarPoint(coplanarPoint),planeGeometry.lookAt(rightCutPlane.normal),planeGeometry.translate(coplanarPoint.x,coplanarPoint.y,coplanarPoint.z),planeMesh=new THREE.Mesh(planeGeometry,planeMaterial),this.el.sceneEl.setObject3D('rightCutPlane',planeMesh),planeGeometry=new THREE.PlaneGeometry(4,4,1,1),rightBorderOuterPlane.coplanarPoint(coplanarPoint),planeGeometry.lookAt(rightBorderOuterPlane.normal),planeGeometry.translate(coplanarPoint.x,coplanarPoint.y,coplanarPoint.z);const parallelPlaneMesh=new THREE.Mesh(planeGeometry,parallelPlaneMaterial);this.el.sceneEl.setObject3D('planeParallel',parallelPlaneMesh)}this.blockEl.object3D.visible=!1;const partRightMaterial=this.partRightEl.getObject3D('mesh').material;partRightMaterial.clippingPlanes=partRightMaterial.clippingPlanes||[],partRightMaterial.clippingPlanes.length=0,partRightMaterial.clippingPlanes.push(rightCutPlane);const cutRightMaterial=this.cutRightEl.getObject3D('mesh').material;cutRightMaterial.clippingPlanes=cutRightMaterial.clippingPlanes||[],cutRightMaterial.clippingPlanes.length=0,cutRightMaterial.clippingPlanes.push(rightBorderOuterPlane),cutRightMaterial.clippingPlanes.push(rightBorderInnerPlane);const partLeftMaterial=this.partLeftEl.getObject3D('mesh').material;partLeftMaterial.clippingPlanes=partLeftMaterial.clippingPlanes||[],partLeftMaterial.clippingPlanes.length=0,partLeftMaterial.clippingPlanes.push(leftCutPlane);const cutLeftMaterial=this.cutLeftEl.getObject3D('mesh').material;cutLeftMaterial.clippingPlanes=cutLeftMaterial.clippingPlanes||[],cutLeftMaterial.clippingPlanes.length=0,cutLeftMaterial.clippingPlanes.push(leftBorderInnerPlane),cutLeftMaterial.clippingPlanes.push(leftBorderOuterPlane),this.partLeftEl.object3D.visible=!0,this.partRightEl.object3D.visible=!0,this.el.sceneEl.renderer.localClippingEnabled=!0,this.destroyed=!0,this.gravityVelocity=0.1,this.rotationAxis.copy(this.rightCutPlanePoints[0]).sub(this.rightCutPlanePoints[1]),this.returnToPoolTimer=800,auxObj3D.up.copy(rightCutPlane.normal),auxObj3D.lookAt(direction),this.explodeEventDetail.position=this.el.object3D.position,this.explodeEventDetail.rotation=auxObj3D.rotation,this.particles.emit('explode',this.explodeEventDetail,!1)}}(),destroyMine:function(){for(let i=0;i<this.mineFragments.length;i++)this.mineFragments[i].visible=!0;this.blockEl.object3D.visible=!1,this.destroyed=!0,this.gravityVelocity=0.1,this.returnToPoolTimer=800,this.explodeEventDetail.position=this.el.object3D.position,this.explodeEventDetail.rotation=this.randVec,this.mineParticles.emit('explode',this.explodeEventDetail,!1)},initCuttingClippingPlanes:function(){this.leftCutPlanePointsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.rightCutPlanePointsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.rightCutPlane=new THREE.Plane,this.rightBorderOuterPlane=new THREE.Plane,this.rightBorderInnerPlane=new THREE.Plane,this.leftCutPlane=new THREE.Plane,this.leftBorderOuterPlane=new THREE.Plane,this.leftBorderInnerPlane=new THREE.Plane},generateCutClippingPlanes:function(){var leftBorderInnerPlane=this.leftBorderInnerPlane,leftBorderOuterPlane=this.leftBorderOuterPlane,leftCutPlane=this.leftCutPlane,leftCutPlanePointsWorld=this.leftCutPlanePointsWorld,partLeftEl=this.partLeftEl,partRightEl=this.partRightEl,rightBorderInnerPlane=this.rightBorderInnerPlane,rightBorderOuterPlane=this.rightBorderOuterPlane,rightCutPlane=this.rightCutPlane,rightCutPlanePointsWorld=this.rightCutPlanePointsWorld;partRightEl.object3D.updateMatrixWorld(),partRightEl.object3D.localToWorld(rightCutPlanePointsWorld[0].copy(this.rightCutPlanePoints[0])),partRightEl.object3D.localToWorld(rightCutPlanePointsWorld[1].copy(this.rightCutPlanePoints[1])),partRightEl.object3D.localToWorld(rightCutPlanePointsWorld[2].copy(this.rightCutPlanePoints[2])),partLeftEl.object3D.updateMatrixWorld(),partLeftEl.object3D.localToWorld(leftCutPlanePointsWorld[0].copy(this.leftCutPlanePoints[0])),partLeftEl.object3D.localToWorld(leftCutPlanePointsWorld[1].copy(this.leftCutPlanePoints[1])),partLeftEl.object3D.localToWorld(leftCutPlanePointsWorld[2].copy(this.leftCutPlanePoints[2])),rightCutPlane.setFromCoplanarPoints(rightCutPlanePointsWorld[0],rightCutPlanePointsWorld[1],rightCutPlanePointsWorld[2]),rightBorderOuterPlane.set(rightCutPlane.normal,rightCutPlane.constant+this.cutThickness),leftCutPlane.setFromCoplanarPoints(leftCutPlanePointsWorld[0],leftCutPlanePointsWorld[1],leftCutPlanePointsWorld[2]),leftBorderOuterPlane.set(leftCutPlane.normal,leftCutPlane.constant+this.cutThickness),rightBorderInnerPlane.setFromCoplanarPoints(rightCutPlanePointsWorld[2],rightCutPlanePointsWorld[1],rightCutPlanePointsWorld[0]),leftBorderInnerPlane.setFromCoplanarPoints(leftCutPlanePointsWorld[2],leftCutPlanePointsWorld[1],leftCutPlanePointsWorld[0])},returnToPool:function(force){(this.backToPool||force)&&this.el.sceneEl.components[this.poolName].returnEntity(this.el)},checkCollisions:function(){const cutDirection=this.data.cutDirection,saberColors=this.saberColors,saberEls=this.saberEls,hitBoundingBox=this.hitColliderEl&&this.hitBoundingBox.setFromObject(this.hitColliderEl.getObject3D('mesh')),beatBoundingBox=this.beatBoundingBox.setFromObject(this.blockEl.getObject3D('mesh'));for(let i=0;i<saberEls.length;i++){let saberBoundingBox=saberEls[i].components['saber-controls'].boundingBox,saberControls,maxAngle;if(!saberBoundingBox)break;const hand=saberEls[i].getAttribute('saber-controls').hand;if(saberBoundingBox.intersectsBox(beatBoundingBox)){if(this.el.emit(`beatcollide${hand}`,null,!0),this.el.parentNode.components['beat-hit-sound'].playSound(this.el),'mine'===this.data.type){this.el.emit('minehit',null,!0),this.destroyMine();break}if(this.destroyBeat(saberEls[i]),saberEls[i].components['saber-controls'].swinging&&this.data.color===saberColors[hand]){if(this.hitSaberEl=saberEls[i],this.hitSaberEl.addEventListener('strokeend',this.onEndStroke,ONCE),saberControls=saberEls[i].components['saber-controls'],this.hitHand=hand,saberControls.maxAnglePlaneX=0,saberControls.maxAnglePlaneY=0,saberControls.maxAnglePlaneXY=0,'arrow'===this.data.type){if(saberControls.updateStrokeDirection(),!saberControls.strokeDirection[this.data.cutDirection]){this.wrongHit(hand);break}maxAngle='up'===cutDirection||'down'===cutDirection?saberControls.maxAnglePlaneX:'left'===cutDirection||'right'===cutDirection?saberControls.maxAnglePlaneY:saberControls.maxAnglePlaneXY}else maxAngle=_Mathmax4(saberControls.maxAnglePlaneX,saberControls.maxAnglePlaneY,saberControls.maxAnglePlaneXY);this.angleBeforeHit=maxAngle}else this.wrongHit(hand);break}}},onEndStroke:function(){var cutDirection=this.data.cutDirection,hitEventDetail=this.hitEventDetail,saberControls=this.hitSaberEl.components['saber-controls'],maxAngle;const saberRotation=3.14/12;maxAngle='up'===cutDirection||'down'===cutDirection?saberControls.maxAnglePlaneX:'left'===cutDirection||'right'===cutDirection?saberControls.maxAnglePlaneY:saberControls.maxAnglePlaneXY;const angleBeforeHit=_Mathmax4(0,180*(this.angleBeforeHit-saberRotation)/_MathPI2),angleAfterHit=_Mathmax4(0,180*(maxAngle-saberRotation)/_MathPI2);let score=0;score+=85<=angleBeforeHit?70:70*(angleBeforeHit/80),score+=60<=angleAfterHit?30:30*(angleAfterHit/60),hitEventDetail.score=score,this.el.emit('beathit',hitEventDetail,!0),this.el.sceneEl.emit('textglowbold',null,!1);let beatScorePool;60>score?beatScorePool=SCORE_POOL.OK:80>score?beatScorePool=SCORE_POOL.GOOD:100>score?beatScorePool=SCORE_POOL.GREAT:(beatScorePool=SCORE_POOL.SUPER,this.superCuts[this.superCutIdx].components.supercutfx.createSuperCut(this.el.object3D.position),this.superCutIdx=(this.superCutIdx+1)%this.superCuts.length);const scoreEl=this.el.sceneEl.components[beatScorePool].requestEntity();scoreEl&&(scoreEl.object3D.position.copy(this.el.object3D.position),scoreEl.play(),scoreEl.emit('beatscorestart',null,!1))},tockDestroyed:function(){var leftCutNormal=new THREE.Vector3,leftRotation=0,rightCutNormal=new THREE.Vector3,rightRotation=0,rotationStep=2*_MathPI2/150,fragment;return function(timeDelta){if(this.gravityVelocity=getGravityVelocity(this.gravityVelocity,timeDelta),this.el.object3D.position.y+=this.gravityVelocity*(timeDelta/1e3),'mine'==this.data.type){for(var i=0;i<this.mineFragments.length;i++)(fragment=this.mineFragments[i],!!fragment.visible)&&(fragment.position.addScaledVector(fragment.speed,timeDelta/1e3),fragment.scale.multiplyScalar(0.97),0.1>fragment.scale.y&&(fragment.visible=!1));return}rightCutNormal.copy(this.rightCutPlane.normal).multiplyScalar(DESTROYED_SPEED*(timeDelta/500)),rightCutNormal.y=0,this.partRightEl.object3D.position.add(rightCutNormal),this.partRightEl.object3D.setRotationFromAxisAngle(this.rotationAxis,rightRotation),rightRotation=rightRotation>=2*_MathPI2?0:rightRotation+rotationStep,leftCutNormal.copy(this.leftCutPlane.normal).multiplyScalar(DESTROYED_SPEED*(timeDelta/500)),leftCutNormal.y=0,this.partLeftEl.object3D.position.add(leftCutNormal),this.partLeftEl.object3D.setRotationFromAxisAngle(this.rotationAxis,leftRotation),leftRotation=leftRotation>=2*_MathPI2?0:leftRotation+rotationStep,this.generateCutClippingPlanes(),this.returnToPoolTimer-=timeDelta,this.backToPool=0>=this.returnToPoolTimer}}(),setObjModelFromTemplate:function(){const geometries={};return function(el,templateId){if(!geometries[templateId]){const templateEl=document.getElementById(templateId);if(templateEl.getObject3D('mesh'))geometries[templateId]=templateEl.getObject3D('mesh').children[0].geometry;else return void templateEl.addEventListener('model-loaded',()=>{geometries[templateId]=templateEl.getObject3D('mesh').children[0].geometry,this.setObjModelFromTemplate(el,templateId)})}el.getObject3D('mesh')||el.setObject3D('mesh',new THREE.Mesh),el.getObject3D('mesh').geometry=geometries[templateId]}}()})},function(){AFRAME.registerComponent('console-shortcuts',{play:function(){window.$=val=>document.querySelector(val),window.$$=val=>document.querySelectorAll(val),window.$$$=val=>document.querySelector(`[${val}]`).getAttribute(val),window.$$$$=val=>document.querySelector(`[${val}]`).components[val],window.scene=this.el,window.state=this.el.systems.state.state}})},function(){AFRAME.registerComponent('copy-texture',{dependencies:['geometry','material'],schema:{from:{type:'selector'}},init:function(){const data=this.data;data.from.addEventListener('materialtextureloaded',()=>{this.copyTexture()}),this.copyTexture()},copyTexture:function(){const el=this.el,target=this.data.from,material=el.getObject3D('mesh').material;target.getObject3D('mesh')&&(material.map=target.getObject3D('mesh').material.map,material.map&&(material.map.needsUpdate=!0,material.needsUpdate=!0))}})},function(){AFRAME.registerComponent('cursor-laser',{dependencies:['geometry'],schema:{enabled:{default:!0}},init:function(){const el=this.el;this.saberEl=this.el.closest('.saber');const geometry=this.el.getAttribute('geometry');el.object3D.position.z=-1*geometry.height/2,this.originalSize=geometry.height,this.currentLength=geometry.height},update:function(){this.el.object3D.visible=this.data.enabled},tick:function(){const el=this.el;if(this.data.enabled){const cursor=this.saberEl.components.cursor;if(cursor){const intersectedEl=cursor.intersectedEl;if(!intersectedEl)return el.object3D.position.z=-25,el.object3D.scale.x=0.75,el.getObject3D('mesh').scale.y=50,void(this.currentLength=1);const intersection=this.saberEl.components.raycaster.intersections[0];intersection&&(el.object3D.scale.x=1,el.object3D.position.z=-intersection.distance/2,el.getObject3D('mesh').scale.y=this.currentLength=intersection.distance)}}}})},function(){AFRAME.registerComponent('cursor-mesh',{schema:{active:{default:!0},cursorEl:{type:'selector'}},init:function(){this.scenePivotEl=document.getElementById('scenePivot')},update:function(){this.el.object3D.visible=this.data.active},tick:function(){var cursorEl=this.data.cursorEl,el=this.el,scenePivotEl=this.scenePivotEl,cursor,intersection,intersectedEl;if(this.data.active&&(cursor=cursorEl.components.cursor,!!cursor)){if(intersectedEl=cursorEl.components.cursor.intersectedEl,intersectedEl)el.object3D.visible=!0;else return void(el.object3D.visible=!1);intersection=cursorEl.components.raycaster.getIntersection(intersectedEl),intersection&&(el.object3D.position.copy(intersection.point),scenePivotEl&&el.object3D.rotation.copy(scenePivotEl.object3D.rotation))}}})},function(){AFRAME.registerComponent('debug-beat-loader',{dependencies:['beat-loader'],schema:{beatEnabled:{default:!1},stageEnabled:{default:!1}},init:function(){this.beatLoader=this.el.components['beat-loader'],this.selectedBeat={color:'red',position:'middleCenterLeft',type:'arrow',orientation:'up'},this.beats={},this.onKeyDown=this.onKeyDown.bind(this),(this.data.stageEnabled||AFRAME.utils.getUrlParameter('debugstage'))&&this.addDebugStageControls(),(this.data.beatEnabled||'gameplay'===AFRAME.utils.getUrlParameter('debugstate').trim())&&(window.addEventListener('keydown',this.onKeyDown),this.addDebugBeatControls())},spawn:function(){var self=this;Object.keys(this.beats).forEach(function(key){self.generateBeat(self.beats[key])})},generateBeat:function(beatInfo){var type;return'wall'===beatInfo.type?void this.generateWall(beatInfo):void(type='mine'===beatInfo.type?3:'red'===beatInfo.color?0:1,this.beatLoader.generateBeat({_lineIndex:this.beatLoader.positionHumanized[beatInfo.position].index,_lineLayer:this.beatLoader.positionHumanized[beatInfo.position].layer,_cutDirection:'dot'===beatInfo.type?8:this.beatLoader.orientationsHumanized.indexOf(beatInfo.orientation),_type:type}))},generateWall:function(wallInfo){this.beatLoader.bpm=90,this.beatLoader.generateWall({_lineIndex:this.beatLoader.positionHumanized[wallInfo.position].index,_width:1,_duration:3})},onKeyDown:function(event){const keyCode=event.keyCode;switch(keyCode){case 32:{this.spawn();break}}},addDebugBeatControls:function(){function addMenu(name){const menuDiv=document.createElement('div');return menuDiv.id=name,menuDiv.style.marginBottom='20px',menuDiv.style.width='500px',menuDiv.style.display='inline-block',parentDiv.appendChild(menuDiv),menuDiv}function addButton(text,containerEl,clickHandler){const div=document.createElement('div');return div.classList.add('button'),div.id=text,div.style.width='100px',div.style.height='30px',div.style.background='#000',div.style.color='#fff',div.style.zIndex=999999999,div.style.padding='5px',div.style.margin='5px',div.style.font='14px sans-serif',div.style.textAlign='center',div.style.lineHeight='30px',div.style.cursor='pointer',div.style.display='inline-block',div.innerHTML=text,containerEl.appendChild(div),div.addEventListener('click',clickHandler||function onClick(){const buttons=div.parentElement.querySelectorAll('.button');for(let i=0;i<buttons.length;i++)buttons[i].style.background='#000';div.style.background='#66f',self.selectedBeat[div.parentElement.id]=this.id,self['selected'+div.parentElement.id.charAt(0).toUpperCase()+div.parentElement.id.slice(1)+'El']=this}),div}const parentDiv=document.createElement('div'),self=this;parentDiv.style.position='absolute',parentDiv.style.right='0',parentDiv.style.top='0',parentDiv.style.padding='10px',parentDiv.style.width='500px',parentDiv.style.height='600px',document.body.appendChild(parentDiv),function addTypeBeatMenu(){const menuDiv=addMenu('type');addButton('arrow',menuDiv),addButton('dot',menuDiv),addButton('mine',menuDiv),addButton('wall',menuDiv),parentDiv.appendChild(menuDiv)}(),function addColorBeatMenu(){const menuDiv=addMenu('color');addButton('blue',menuDiv),addButton('red',menuDiv),parentDiv.appendChild(menuDiv)}(),function addOrientationMenu(){const menuDiv=addMenu('orientation');addButton('top',menuDiv),addButton('left',menuDiv),addButton('right',menuDiv),addButton('down',menuDiv),parentDiv.appendChild(menuDiv)}(),function setBeatButton(){var buttonEl=addButton('Set Beat',parentDiv,function(){var color='mine'===self.selectedBeat.type?'':' '+self.selectedBeat.color,orientation='arrow'===self.selectedBeat.type?' '+self.selectedBeat.orientation:'';self.selectedBeat={position:self.selectedBeat.position,type:self.selectedBeat.type,orientation:self.selectedBeat.orientation,color:self.selectedBeat.color};self.selectedPositionEl&&(self.selectedPositionEl.innerHTML=self.selectedBeat.type+color+orientation,self.beats[self.selectedPositionEl.id]={position:self.selectedBeat.position,type:self.selectedBeat.type,orientation:self.selectedBeat.orientation,color:self.selectedBeat.color})});buttonEl.style.width='460px',buttonEl.style.bottomMargin='10px'}(),function addBeatPositionMenu(){const menuDiv=addMenu('position');addButton('topLeft',menuDiv),addButton('topCenterLeft',menuDiv),addButton('topCenterRight',menuDiv),addButton('topRight',menuDiv),addButton('middleLeft',menuDiv),addButton('middleCenterLeft',menuDiv),addButton('middleCenterRight',menuDiv),addButton('middleRight',menuDiv),addButton('bottomLeft',menuDiv),addButton('bottomCenterLeft',menuDiv),addButton('bottomCenterRight',menuDiv),addButton('bottomRight',menuDiv)}(),function addGenerateButton(){const buttonEl=addButton('Spawn (Space Bar)',parentDiv,()=>{self.spawn()});buttonEl.style.width='460px',buttonEl.style.bottomMargin='10px'}()},addDebugStageControls:function(){var currControl=0;const addControl=(i,name,type)=>{const div=document.createElement('div');div.style.position='absolute',div.id='stagecontrol'+i,div.style.width='100px',div.style.height='30px',div.style.top='element'===type?'20px':'70px',div.style.background='#000',div.style.color='#fff',div.style.zIndex=999999999,div.style.padding='5px',div.style.font='14px sans-serif',div.style.textAlign='center',div.style.cursor='pointer',div.style.left=20+120*i+'px',div.innerHTML=name,'element'===type?div.addEventListener('click',()=>{document.getElementById('stagecontrol'+currControl).style.background='#000',div.style.background='#66f',currControl=i}):div.addEventListener('click',()=>{this.beatLoader.generateEvent({_type:currControl,_value:i})}),document.body.appendChild(div)};['sky','tunnelNeon','leftStageLasers','rightStageLasers','floor'].forEach((id,i)=>{addControl(i,id,'element')}),['off','blue','blue','bluefade','','red','red','redfade'].forEach((id,i)=>{addControl(i,id,'value')})}})},function(){AFRAME.registerComponent('debug-controller',{init:function(){var primaryHand,secondaryHand;AFRAME.utils.getUrlParameter('debug')&&(console.log('%c debug-controller enabled ','background: #111; color: red'),this.isCloning=!1,this.isDeleting=!1,this.isTriggerDown=!1,window.addEventListener('mousemove',this.onMouseMove.bind(this)),primaryHand=document.getElementById('rightHand'),secondaryHand=document.getElementById('leftHand'),window.addEventListener('click',evt=>{evt.isTrusted&&(primaryHand.emit('triggerdown'),primaryHand.emit('triggerup'))}),'oculus'===AFRAME.utils.getUrlParameter('debug')?(primaryHand.emit('controllerconnected',{name:'oculus-touch-controls'}),secondaryHand.emit('controllerconnected',{name:'oculus-touch-controls'}),primaryHand.setAttribute('controller','controllerType','oculus-touch-controls'),secondaryHand.setAttribute('controller','controllerType','oculus-touch-controls')):(primaryHand.emit('controllerconnected',{name:'vive-controls'}),secondaryHand.emit('controllerconnected',{name:'vive-controls'}),primaryHand.setAttribute('controller','controllerType','vive-controls'),secondaryHand.setAttribute('controller','controllerType','vive-controls')),this.el.emit('enter-vr',null,!1),document.addEventListener('keydown',evt=>{var primaryPosition,primaryRotation,secondaryPosition,secondaryRotation;return evt.shiftKey?32===evt.keyCode?void(this.isTriggerDown?(primaryHand.emit('triggerup'),this.isTriggerDown=!1):(primaryHand.emit('triggerdown'),this.isTriggerDown=!0)):81===evt.keyCode?void(this.isSecondaryTriggerDown?(secondaryHand.emit('triggerup'),this.isSecondaryTriggerDown=!1):(secondaryHand.emit('triggerdown'),this.isSecondaryTriggerDown=!0)):void(78===evt.keyCode&&(this.secondaryGripDown?(secondaryHand.emit('gripup'),this.secondaryGripDown=!1):(secondaryHand.emit('gripdown'),this.secondaryGripDown=!0)),77===evt.keyCode&&(this.primaryGripDown?(primaryHand.emit('gripup'),this.primaryGripDown=!1):(primaryHand.emit('gripdown'),this.primaryGripDown=!0)),49===evt.keyCode&&secondaryHand.emit('menudown'),evt.ctrlKey?(secondaryPosition=secondaryHand.getAttribute('position'),72===evt.keyCode&&(secondaryPosition.x-=0.01),74===evt.keyCode&&(secondaryPosition.y-=0.01),75===evt.keyCode&&(secondaryPosition.y+=0.01),76===evt.keyCode&&(secondaryPosition.x+=0.01),(59===evt.keyCode||186===evt.keyCode)&&(secondaryPosition.z-=0.01),222===evt.keyCode&&(secondaryPosition.z+=0.01),secondaryHand.setAttribute('position',AFRAME.utils.clone(secondaryPosition))):(primaryPosition=primaryHand.getAttribute('position'),72===evt.keyCode&&(primaryPosition.x-=0.01),74===evt.keyCode&&(primaryPosition.y-=0.01),75===evt.keyCode&&(primaryPosition.y+=0.01),76===evt.keyCode&&(primaryPosition.x+=0.01),(59===evt.keyCode||186===evt.keyCode)&&(primaryPosition.z-=0.01),222===evt.keyCode&&(primaryPosition.z+=0.01),primaryHand.setAttribute('position',AFRAME.utils.clone(primaryPosition))),evt.ctrlKey?(secondaryRotation=secondaryHand.getAttribute('rotation'),89===evt.keyCode&&(secondaryRotation.x-=10),79===evt.keyCode&&(secondaryRotation.x+=10),85===evt.keyCode&&(secondaryRotation.y-=10),73===evt.keyCode&&(secondaryRotation.y+=10),secondaryHand.setAttribute('rotation',AFRAME.utils.clone(secondaryRotation))):(primaryRotation=primaryHand.getAttribute('rotation'),89===evt.keyCode&&(primaryRotation.x-=10),79===evt.keyCode&&(primaryRotation.x+=10),85===evt.keyCode&&(primaryRotation.y-=10),73===evt.keyCode&&(primaryRotation.y+=10),primaryHand.setAttribute('rotation',AFRAME.utils.clone(primaryRotation)))):void 0}))},play:function(){var primaryHand,secondaryHand;this.bounds=document.body.getBoundingClientRect();AFRAME.utils.getUrlParameter('debug')&&(primaryHand=document.getElementById('rightHand'),secondaryHand=document.getElementById('leftHand'),secondaryHand.object3D.position.set(-0.2,1.5,-0.5),primaryHand.object3D.position.set(0.2,1.5,-0.5),secondaryHand.setAttribute('rotation',{x:35,y:0,z:0}))},onMouseMove:function(){const direction=new THREE.Vector3,mouse=new THREE.Vector2,cameraPos=new THREE.Vector3;return function(evt){const bounds=this.bounds,camera=this.el.sceneEl.camera,left=evt.clientX-bounds.left,top=evt.clientY-bounds.top;mouse.x=2*(left/bounds.width)-1,mouse.y=2*(-top/bounds.height)-1,document.getElementById('camera').object3D.getWorldPosition(cameraPos),direction.set(mouse.x,mouse.y,0.5).unproject(camera).sub(cameraPos).normalize();const handPos=document.getElementById('rightHand').object3D.position,distance=-cameraPos.z/direction.z;camera.getWorldPosition(handPos).add(direction.multiplyScalar(distance)),handPos.y+=0.8}}()})},function(){AFRAME.registerComponent('debug-cursor',{init:function(){},log:function(event,intersectedEl,color){intersectedEl.id?console.log(`%c[${event}] ${intersectedEl.id}`,`color: ${color}`):(console.log(`%c[${event}]`,`color: ${color}`),console.log(intersectedEl))}})},function(){AFRAME.registerComponent('debug-song-time',{dependencies:['song'],init:function(){AFRAME.utils.getUrlParameter('debug-song-time')&&setInterval(()=>{console.log(this.el.components.song.getCurrentTime())},250)}})},function(){AFRAME.registerComponent('debug-state',{play:function(){const flags=AFRAME.utils.getUrlParameter('debugstate').trim();flags&&setTimeout(()=>{flags.split(',').forEach(flag=>{this.el.sceneEl.emit(`debug${flag.trim()}`,null,!1)})},500)}})},function(module,__webpack_exports__,__webpack_require__){'use strict';function createGeometry(color){colorHelper.set(color);const geometries=[{height:0.1831,radius:0.0055},{height:0.1832,radius:0.0065},{height:0.1833,radius:0.0075},{height:0.1834,radius:0.0085}].map((cylinderData,i)=>{const cylinder=new THREE.CylinderBufferGeometry(cylinderData.radius,cylinderData.radius,cylinderData.height),colorArray=[];for(let i=0;i<cylinder.attributes.position.array.length;i+=3)colorArray[i]=colorHelper.r,colorArray[i+1]=colorHelper.g,colorArray[i+2]=colorHelper.b;cylinder.addAttribute('color',new THREE.Float32BufferAttribute(colorArray,3));const alphaUvs=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component__.getGridUvs)(0,i,1,4),uvs=cylinder.attributes.uv.array;for(let i=0;i<uvs.length;i+=6)uvs[i]=alphaUvs[0].x,uvs[i+1]=alphaUvs[0].y,uvs[i+2]=alphaUvs[1].x,uvs[i+3]=alphaUvs[1].y,uvs[i+4]=alphaUvs[2].x,uvs[i+5]=alphaUvs[2].y;return cylinder.attributes.uv.needsUpdate=!0,cylinder}),geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);return geometry}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component__=__webpack_require__(11),__WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component__);__webpack_require__(12);const colorHelper=new THREE.Color,geometry=createGeometry(),material=new THREE.MeshBasicMaterial({alphaMap:function createAlphaMap(){const alphaCanvas=document.createElement('canvas');alphaCanvas.height=1,alphaCanvas.width=4;const ctx=alphaCanvas.getContext('2d');return ctx.fillStyle='rgb(10, 10, 10)',ctx.fillRect(0,0,1,1),ctx.fillStyle='rgb(15, 15, 15)',ctx.fillRect(1,0,1,1),ctx.fillStyle='rgb(23, 23 ,23)',ctx.fillRect(2,0,1,1),ctx.fillStyle='rgb(28, 28, 28)',ctx.fillRect(3,0,1,1),setTimeout(()=>{alphaCanvas.style.position='fixed',alphaCanvas.style.zIndex=999999999999,alphaCanvas.style.left=0,alphaCanvas.style.top=0,document.body.appendChild(alphaCanvas)},1e3),new THREE.CanvasTexture(alphaCanvas)}(),transparent:!0,vertexColors:THREE.VertexColors});AFRAME.registerComponent('fake-glow',{schema:{color:{default:'#FFF'}},play:function(){this.el.setObject3D('mesh',new THREE.Mesh(createGeometry(this.data.color),material))}})},function(module,exports,__webpack_require__){const COLORS=__webpack_require__(6),HIT_COLOR=new THREE.Color(COLORS.NEON_RED),BORDER_COLOR=new THREE.Color(COLORS.NEON_BLUE);AFRAME.registerShader('floorShader',{schema:{normalMap:{type:'map',is:'uniform'},envMap:{type:'map',is:'uniform'},hitRight:{type:'vec3',is:'uniform',default:{x:0,y:1,z:0}},hitLeft:{type:'vec3',is:'uniform',default:{x:0,y:0,z:0}}},vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 color;
    uniform sampler2D normalMap;
    uniform sampler2D envMap;
    uniform vec3 hitRight;
    uniform vec3 hitLeft;

    #define HIT_COLOR vec3(${HIT_COLOR.r}, ${HIT_COLOR.g}, ${HIT_COLOR.b})
    #define BORDER_COLOR vec3(${BORDER_COLOR.r}, ${BORDER_COLOR.g}, ${BORDER_COLOR.b})

    vec3 drawCircle(vec3 p, vec3 center, float radius, float edgeWidth, vec3 color) {
      return color*(1.0-smoothstep(radius, radius+edgeWidth, length(p-center)));
    }

    void main() {
      vec2 p = uvs.xy - 0.5;
      vec3 border = vec3(smoothstep(0.49, 0.495, abs(p.x)) + smoothstep(0.49, 0.495, abs(p.y)));
      border += BORDER_COLOR * (smoothstep(0.475, 0.495, abs(p.x)) + smoothstep(0.475, 0.495, abs(p.y))) * .7;
      p*= 4.0;

      vec3 hitColor = HIT_COLOR;
      vec3 hit = vec3(0.0);

      hit += drawCircle(worldPos, hitRight, 0.04, 0.05, hitColor);
      hit += drawCircle(worldPos, hitRight, 0.02, 0.03, vec3(0.7, 0.7, 0.7));
      hit += drawCircle(worldPos, hitLeft, 0.04, 0.05, hitColor);
      hit += drawCircle(worldPos, hitLeft, 0.02, 0.03, vec3(0.7, 0.7, 0.7));

      vec3 normal = normalize(texture2D(normalMap, uvs).xyz);

      // environment reflection
      vec3 reflectVec = normalize(reflect(normalize(worldPos - cameraPosition), normal));
      //vec3 reflectView = normalize((viewMatrix * vec4(reflectVec, 0.0)).xyz + vec3(0.0, 0.0, 1.0));

      vec3 ref = texture2D(envMap, reflectVec.xy * vec2(0.3, 1.0) + vec2(0.75, -cameraPosition.z * 0.05)).xyz * 0.14;

      gl_FragColor = vec4(ref + border + hit, 1.0);
    }
  `})},function(){AFRAME.registerComponent('gameover',{schema:{isGameOver:{default:!1}},init:function(){this.beatContainer=document.getElementById('beatContainer'),this.gameOverEls=document.querySelectorAll('[animation__gameover]')},update:function(oldData){this.data;!oldData.isGameOver&&this.data.isGameOver&&(this.triggerAnimations(),this.countDown=1),oldData.isGameOver&&!this.data.isGameOver&&this.reset()},tick:function(time,delta){!this.data.isGameOver||0<=this.countDown&&(this.beatContainer.object3D.position.z=1.5*-Math.pow(1-this.countDown,2),this.countDown-=delta/1e3)},reset:function(){this.beatContainer.object3D.position.z=0,this.el.sceneEl.setAttribute('stage-colors','color','blue')},triggerAnimations:function(){for(let i=0;i<this.gameOverEls.length;i++)this.gameOverEls[i].emit('gameover',null,!1);this.el.emit('textglowoff',null,!1),this.el.emit('bgcolorgameover',null,!1)}})},function(){let i=0;AFRAME.registerComponent('gpu-preloader',{dependencies:['materials'],play:function(){this.preloadMineEnvMaps(),setTimeout(()=>{this.preloadAtlas(),this.preloadLogo(),this.preloadBeatEnvMap(),this.preloadCutParticles(),this.preloadKeyboard(),this.preloadPlayButton(),this.preloadSearchPrevPage(),this.preloadGenres()},1e3)},preloadAtlas:function(){const stage=document.querySelector('#stageObj');this.preloadTexture(stage.getObject3D('mesh').children[0].material.uniforms.src.value)},preloadLogo:function(){const logo=document.querySelector('#logoBody');this.preloadTexture(logo.getObject3D('mesh').children[0].material.uniforms.src.value)},preloadBeamMap:function(){const beams=document.querySelector('[beams]');this.preloadTexture(beams.components.beams.texture)},preloadBeatEnvMap:function(){const beat=document.querySelector('#beatContainer [mixin~="beat"]');beat.object3D.traverse(node=>{node.material&&(node.material.envMap&&this.preloadTexture(node.material.envMap),node.material.map&&this.preloadTexture(node.material.map))})},preloadCutParticles:function(){const particles=document.querySelector('#saberParticles');this.preloadTexture(particles.components.particleplayer.material.map)},preloadKeyboard:function(){const keyboard=document.getElementById('keyboard').components['super-keyboard'];this.preloadTexture(keyboard.kbImg.getObject3D('mesh').material.map),this.preloadTexture(keyboard.keyColorPlane.getObject3D('mesh').material.map)},preloadMineEnvMaps:function(){const stageColors=this.el.sceneEl.components['stage-colors'];this.el.sceneEl.addEventListener('mineredenvmaploaded',()=>{this.preloadTexture(stageColors.mineEnvMap.red)}),this.el.sceneEl.addEventListener('mineblueenvmaploaded',()=>{this.preloadTexture(stageColors.mineEnvMap.blue)})},preloadMissMap:function(){const miss=document.querySelector('#missLeft');this.preloadTexture(miss.getObject3D('mesh').material.map)},preloadPlayButton:function(){const playButton=document.querySelector('#playButton');this.preloadTexture(playButton.getObject3D('mesh').material.map)},preloadSearchPrevPage:function(){const prevPage=document.querySelector('#searchPrevPage');this.preloadTexture(prevPage.children[0].getObject3D('mesh').material.map)},preloadWallMap:function(){const wall=document.querySelector('a-entity[wall]');this.preloadTexture(wall.getObject3D('mesh').material.uniforms.tex.value),this.preloadTexture(wall.getObject3D('mesh').material.uniforms.env.value)},preloadWrongMap:function(){const wrong=document.querySelector('#wrongLeft');this.preloadTexture(wrong.getObject3D('mesh').material.map)},preloadGenres:function(){const genres=document.querySelector('.genreIcon');this.preloadTexture(genres.getObject3D('mesh').material.map)},preloadTexture:function(texture){return texture&&texture.image?texture.image.complete?void this.el.renderer.setTexture2D(texture,i++%8):void console.warn('[gpu-preloader] Error preloading, image not loaded',texture):void console.warn('[gpu-preloader] Error preloading texture',texture)}})},function(){const events=['triggerdown','gripdown','abuttondown','bbuttondown','xbuttondown','ybuttondown','trackpaddown'];AFRAME.registerComponent('hand-swapper',{schema:{enabled:{default:!1}},init:function(){this.swapHand=this.swapHand.bind(this),events.forEach(event=>{this.el.addEventListener(event,this.swapHand)})},swapHand:function(){this.data.enabled&&this.el.sceneEl.emit('activehandswap',null,!1)}})},function(){AFRAME.registerComponent('haptics-saber',{init:function(){const el=this.el;this.isColliding=!1,this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),100),el.setAttribute('haptics__saber',{dur:100,force:0.075}),el.addEventListener('mouseenter',evt=>{if(evt.detail&&evt.detail.intersectedEl){const intersectedEl=evt.detail.intersectedEl;return intersectedEl.classList.contains('blade')&&intersectedEl!==el?void(this.isColliding=!0,this.el.components.haptics__saber.pulse()):void(this.isColliding=!1)}}),el.addEventListener('mouseleave',()=>{this.isColliding=!1})},tick:function(){this.isColliding&&this.el.components.haptics__saber.pulse()}})},function(){AFRAME.registerComponent('haptics-wall',{init:function(){const el=this.el;this.isHittingWall=!1,el.setAttribute('haptics__wall',{dur:50,force:0.075}),this.checkIfHittingWall=this.checkIfHittingWall.bind(this),el.addEventListener('mouseenter',this.checkIfHittingWall),el.addEventListener('mouseleave',this.checkIfHittingWall),this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),50)},checkIfHittingWall:function(){const intersectedEls=this.el.components.raycaster__game.intersectedEls;this.isHittingWall=!1;for(let i=0;i<intersectedEls.length;i++)if(intersectedEls[i].components.wall)return void(this.isHittingWall=!0)},tick:function(){this.isHittingWall&&this.el.components.haptics__wall.pulse()}})},function(){AFRAME.registerComponent('history',{schema:{challengeId:{type:'string'},songName:{type:'string'},songSubName:{type:'string'}},update:function(){const data=this.data;history.pushState('',data.songName,updateQueryParam(window.location.href,'challenge',data.challengeId)),document.title=`Super Saber - ${data.songName}`}})},function(){AFRAME.registerComponent('intro-song',{schema:{isPlaying:{default:!0},isSearching:{default:!1}},init:function(){this.analyserEl=document.getElementById('audioAnalyser'),this.audio=document.getElementById('introSong'),this.timeout=null},update:function(oldData){const audio=this.audio;this.el.sceneEl.isPlaying&&(oldData.isSearching||!this.data.isSearching)&&(!oldData.isPlaying&&this.data.isPlaying&&(this.analyserEl.components.audioanalyser.resumeContext(),this.analyserEl.setAttribute('audioanalyser','src',audio),this.fadeInAudio()),oldData.isPlaying&&!this.data.isPlaying&&audio.pause())},pause:function(){this.audio.pause()},play:function(){this.fadeInAudio()},fadeInAudio:function(){if(!AFRAME.utils.getUrlParameter('mute')){const context=this.analyserEl.components.audioanalyser.context,gainNode=this.analyserEl.components.audioanalyser.gainNode;gainNode.gain.setValueAtTime(0,context.currentTime),this.audio.play(),gainNode.gain.linearRampToValueAtTime(0.5,context.currentTime+0.5)}}})},function(){AFRAME.registerComponent('keyboard-raycastable',{dependencies:['super-keyboard'],schema:{condition:{default:''}},play:function(){this.el.components['super-keyboard'].kbImg.setAttribute('bind-toggle__raycastable',this.data.condition)}})},function(module,exports,__webpack_require__){const firebase=__webpack_require__(139);__webpack_require__(140);AFRAME.registerComponent('leaderboard',{schema:{apiKey:{type:'string'},authDomain:{type:'string'},databaseURL:{type:'string'},projectId:{type:'string'},storageBucket:{type:'string'},messagingSenderId:{type:'string'},challengeId:{default:''},menuSelectedChallengeId:{default:''},isVictory:{default:!1}},init:function(){this.qualifyingIndex=void 0,this.scores=[],this.eventDetail={scores:this.scores},this.addEventDetail={scoreData:void 0,index:void 0},this.username=localStorage.getItem('supersaberusername')||'Super Zealot',this.el.addEventListener('leaderboardusername',evt=>{this.username=evt.detail.value,localStorage.setItem('supersaberusername',this.username)}),this.el.addEventListener('leaderboardsubmit',this.addScore.bind(this))},update:function(oldData){!firebase.apps.length&&this.data.apiKey&&(firebase.initializeApp({apiKey:this.data.apiKey,authDomain:this.data.authDomain,databaseURL:this.data.databaseURL,projectId:this.data.projectId,storageBucket:this.data.storageBucket,messagingSenderId:this.data.messagingSenderId}),this.firestore=firebase.firestore(),this.firestore.settings({timestampsInSnapshots:!0}),this.db=this.firestore.collection('scores')),!oldData.isVictory&&this.data.isVictory&&this.checkLeaderboardQualify(),this.data.menuSelectedChallengeId&&oldData.menuSelectedChallengeId!==this.data.menuSelectedChallengeId&&this.fetchScores(this.data.menuSelectedChallengeId),this.data.challengeId&&oldData.challengeId!==this.data.challengeId&&this.fetchScores(this.data.challengeId)},addScore:function(){const state=this.el.sceneEl.systems.state.state;if(state.isVictory){const scoreData={accuracy:state.score.accuracy,challengeId:state.challenge.id,score:state.score.score,username:this.username,difficulty:state.challenge.difficulty,time:new Date};this.db.add(scoreData),this.addEventDetail.scoreData=scoreData,this.el.emit('leaderboardscoreadded',this.addEventDetail,!1)}},fetchScores:function(challengeId){const state=this.el.sceneEl.systems.state.state,query=this.db.where('challengeId','==',challengeId).where('difficulty','==',state.menuSelectedChallenge.id?state.menuSelectedChallenge.difficulty:state.challenge.difficulty).orderBy('score','desc').orderBy('time','asc').limit(10);query.get().then(snapshot=>{this.eventDetail.challengeId=challengeId,this.scores.length=0,snapshot.empty||snapshot.forEach(score=>this.scores.push(score.data())),this.el.sceneEl.emit('leaderboard',this.eventDetail,!1)}).catch(e=>{console.error('[firestore]',e)})},checkLeaderboardQualify:function(){const state=this.el.sceneEl.systems.state.state,score=state.score.score;if(this.scores.length<10)return this.qualifyingIndex=this.scores.length,void this.el.sceneEl.emit('leaderboardqualify',this.scores.length,!1);for(let i=0;i<this.scores.length;i++)if(score>this.scores[i].score)return this.qualifyingIndex=i,void this.el.sceneEl.emit('leaderboardqualify',i,!1)}})},function(){var ONCE={once:!0};AFRAME.registerComponent('logo-light',{init:function(){this.logoBack=document.getElementById('logoBack'),this.logoFront=document.getElementById('logoFront'),this.logoFrontU=document.getElementById('logoFrontU')},play:function(){setTimeout(()=>{this.el.setAttribute('light',{type:'spot',penumbra:1,intensity:5,angle:20}),this.waitAndUpdate(this.logoBack),this.waitAndUpdate(this.logoFront),this.waitAndUpdate(this.logoFrontU)},1e3)},waitAndUpdate:function(el){el.getObject3D('mesh')?el.object3D.traverse(this.updateMaterials):el.addEventListener('model-loaded',()=>{el.object3D.traverse(this.updateMaterials)},ONCE)},updateMaterials:function(node){node.material&&(node.material.needsUpdate=!0)}})},function(){var _Mathfloor4=Math.floor;AFRAME.registerComponent('logoflicker',{schema:{delay:{default:1e3},active:{default:!0}},init:function(){this.setOff=this.setOff.bind(this),this.setOn=this.setOn.bind(this),this.timeout=0,this.sparks=document.getElementById('logosparks'),this.sparkPositions=[{position:new THREE.Vector3(0,0.1,0)},{position:new THREE.Vector3(0.3,0.8,0)},{position:new THREE.Vector3(-0.3,0.8,0)}]},update:function(oldData){this.data.active!==oldData.active&&(this.data.active?this.setOn():clearTimeout(this.timeout))},setOff:function(){this.el.object3D.visible=!1,this.sparks.emit('logoflicker',this.sparkPositions[_Mathfloor4(Math.random()*this.sparkPositions.length)],!1),this.timeout=setTimeout(this.setOn,50)},setOn:function(){this.el.object3D.visible=!0,this.timeout=setTimeout(this.setOff,_Mathfloor4(3*this.data.delay/10+Math.random()*this.data.delay))}})},function(module,exports,__webpack_require__){const COLORS=__webpack_require__(6),flatShaders=__webpack_require__(56),stageAdditiveShaders=__webpack_require__(57),stageNormalShaders=__webpack_require__(58);AFRAME.registerSystem('materials',{init:function(){'loading'===document.readyState?document.addEventListener('DOMContentLoaded',this.createMaterials.bind(this)):this.createMaterials()},createMaterials:function(){this.stageNormal=new THREE.ShaderMaterial({uniforms:{skyColor:{value:new THREE.Color(COLORS.SKY_BLUE)},backglowColor:{value:new THREE.Color(COLORS.BG_BLUE)},src:{value:new THREE.TextureLoader().load(document.getElementById('atlasImg').src)}},vertexShader:stageNormalShaders.vertexShader,fragmentShader:stageNormalShaders.fragmentShader,fog:!1,transparent:!0}),this.stageAdditive=new THREE.ShaderMaterial({uniforms:{tunnelNeon:{value:new THREE.Color(COLORS.NEON_RED)},floorNeon:{value:new THREE.Color(COLORS.NEON_RED)},leftLaser:{value:new THREE.Color(COLORS.NEON_BLUE)},rightLaser:{value:new THREE.Color(COLORS.NEON_BLUE)},textGlow:{value:new THREE.Color(COLORS.TEXT_OFF)},src:{value:new THREE.TextureLoader().load(document.getElementById('atlasImg').src)}},vertexShader:stageAdditiveShaders.vertexShader,fragmentShader:stageAdditiveShaders.fragmentShader,blending:THREE.AdditiveBlending,fog:!1,transparent:!0}),this.logo=new THREE.ShaderMaterial({uniforms:{src:{value:new THREE.TextureLoader().load(document.getElementById('logotexImg').src)}},vertexShader:flatShaders.vertexShader,fragmentShader:flatShaders.fragmentShader,depthTest:!1,fog:!1,transparent:!0}),this.logoadditive=new THREE.ShaderMaterial({uniforms:{src:{value:new THREE.TextureLoader().load(document.getElementById('logotexImg').src)}},vertexShader:flatShaders.vertexShader,fragmentShader:flatShaders.fragmentShader,depthTest:!1,blending:THREE.AdditiveBlending,fog:!1,transparent:!0}),this.mineMaterialred=new THREE.MeshStandardMaterial({roughness:0.38,metalness:0.48,color:new THREE.Color(COLORS.MINE_RED),emissive:new THREE.Color(COLORS.MINE_RED_EMISSION),envMap:new THREE.TextureLoader().load('assets/img/mineenviro-red.jpg')}),this.mineMaterialblue=new THREE.MeshStandardMaterial({roughness:0.38,metalness:0.48,color:new THREE.Color(COLORS.MINE_BLUE),emissive:new THREE.Color(COLORS.MINE_BLUE_EMISSION),envMap:new THREE.TextureLoader().load('assets/img/mineenviro-blue.jpg')})}}),AFRAME.registerComponent('materials',{schema:{name:{default:''},recursive:{default:!0}},update:function(){if(''!==this.data.name){const material=this.system[this.data.name];if(!material)return void console.warn(`undefined material "${this.system[this.data.name]}"`);const mesh=this.el.getObject3D('mesh');mesh?this.applyMaterial(mesh):this.el.addEventListener('model-loaded',this.applyMaterial.bind(this))}},applyMaterial:function(obj){const material=this.system[this.data.name];obj.detail&&(obj=obj.detail.model),this.data.recursive?obj.traverse(o=>{'Mesh'===o.type&&(o.material=material)}):obj.material=material}})},function(){var keyEventsRegistered=!1,results=null,hoveredIndex;const PER_PAGE=6;AFRAME.registerComponent('menu-controls',{schema:{enabled:{default:!0},page:{default:0},selectedChallengeId:{default:''}},init:function(){const el=this.el;results=document.getElementById('searchResultList').children,this.goPrevResult=this.goPrevResult.bind(this),this.goNextResult=this.goNextResult.bind(this),this.select=this.select.bind(this),this.unselect=this.unselect.bind(this),el.addEventListener('thumbupstart',this.goPrevResult),el.addEventListener('thumbdownstart',this.goNextResult),el.addEventListener('thumbleftstart',this.unselect),el.addEventListener('thumbrightstart',this.select),el.addEventListener('mouseenter',()=>{!el.components.cursor.intersectedEl||el.components.cursor.intersectedEl.closest('#searchResultList')&&this.cancelMenuControls()}),AFRAME.utils.getUrlParameter('debug')&&!keyEventsRegistered&&(window.addEventListener('keydown',evt=>{37===evt.keyCode&&this.unselect(),38===evt.keyCode&&this.goPrevResult(),39===evt.keyCode&&this.select(),40===evt.keyCode&&this.goNextResult()}),keyEventsRegistered=!0)},goPrevResult:function(){return this.data.enabled?void 0==hoveredIndex?void this.hoverResult(0):void(0<hoveredIndex?results[hoveredIndex-1].dataset.id===this.data.selectedChallengeId?0>hoveredIndex-2?this.goPrevPage():this.hoverResult(hoveredIndex-2):this.hoverResult(hoveredIndex-1):this.goPrevPage()):void 0},goPrevPage:function(){this.hoverResult(PER_PAGE-1),this.el.sceneEl.emit('searchprevpage',null,!1)},goNextResult:function(){return this.data.enabled?void 0==hoveredIndex?void this.hoverResult(0):void(hoveredIndex<PER_PAGE-1?results[hoveredIndex+1].dataset.id===this.data.selectedChallengeId?hoveredIndex+2>PER_PAGE-1?this.goNextPage():this.hoverResult(hoveredIndex+2):this.hoverResult(hoveredIndex+1):this.goNextPage()):void 0},goNextPage:function(){this.hoverResult(0),this.el.sceneEl.emit('searchnextpage',null,!1)},select:function(){this.data.enabled&&void 0!=hoveredIndex&&this.el.sceneEl.emit('menuchallengeselect',results[hoveredIndex].dataset.id,!1)},unselect:function(){!this.data.enabled||this.data.selectedChallengeId&&this.el.sceneEl.emit('menuchallengeunselect',null,!1)},hoverResult:function(i){hoveredIndex!=void 0&&results[hoveredIndex].querySelector('.searchResultBackground').emit('mouseleave',null,!1),hoveredIndex=i,results[i].querySelector('.searchResultBackground').emit('mouseenter',null,!1)},cancelMenuControls:function(){void 0===hoveredIndex||(results[hoveredIndex].querySelector('.searchResultBackground').emit('mouseleave',null,!1),hoveredIndex=void 0)}})},function(module,exports,__webpack_require__){var bindEvent=__webpack_require__(15).bindEvent;AFRAME.registerComponent('menu-difficulty-select',{init:function(){this.el.sceneEl.addEventListener('menuchallengeselect',()=>{this.el.object3D.visible=!1,setTimeout(()=>{this.el.components.layout.update(),this.el.object3D.visible=!0},150)})},click:bindEvent(function(evt){this.el.sceneEl.emit('menudifficultyselect',evt.target.closest('.difficultyOption').dataset.difficulty,!1)})})},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__utils__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_0__utils___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__utils__);AFRAME.registerComponent('menu-selected-challenge-image',{schema:{selectedChallengeId:{type:'string'}},update:function(){const el=this.el;this.data.selectedChallengeId&&el.setAttribute('material','src',__WEBPACK_IMPORTED_MODULE_0__utils___default.a.getS3FileUrl(this.data.selectedChallengeId,'image.jpg'))}})},function(){AFRAME.registerComponent('menu-slide-animation',{schema:{isSearching:{default:!1},menuSelectedChallengeId:{type:'string'}},init:function(){this.isLeft=!1},update:function(oldData){const data=this.data;return this.isLeft?(!oldData.menuSelectedChallengeId||data.menuSelectedChallengeId||data.isSearching||this.rightMenu(),void(!oldData.isSearching||data.isSearching||data.menuSelectedChallengeId||this.rightMenu())):void(!this.isLeft&&(!oldData.menuSelectedChallengeId&&data.menuSelectedChallengeId&&this.leftMenu(),!oldData.isSearching&&data.isSearching&&this.leftMenu()))},rightMenu:function(){this.isLeft&&(this.el.components.animation__menuright.beginAnimation(),this.isLeft=!1)},leftMenu:function(){this.isLeft||(this.el.components.animation__menuleft.beginAnimation(),this.isLeft=!0)}})},function(){const objLoader=new THREE.OBJLoader;AFRAME.registerSystem('mine-fragments-loader',{init:function(){this.fragments=null;const objData=document.getElementById('mineBrokenObj');objData.addEventListener('loaded',evt=>{this.fragments=objLoader.parse(evt.target.data)})}})},function(){const COMBO_PROGRESS_MAP={0:0,1:0.5,2:0,3:0.25,4:0.5,5:0.75,6:0,7:0.125,8:0.25,9:0.375,10:0.5,11:0.625,12:0.75,13:0.875};AFRAME.registerComponent('multiplier-ring',{dependencies:['geometry','material'],schema:{combo:{default:0},multiplier:{default:1}},init:function(){this.animationSet={from:void 0,to:void 0},this.progress=this.el.getObject3D('mesh').material.uniforms.progress,this.el.setAttribute('animation',{property:'components.material.material.uniforms.progress.value',dur:100,autoplay:!1})},update:function(){this.updateRing()},updateRing:function(){const data=this.data,el=this.el,progress=this.progress;if(8===data.multiplier)return void(progress.value=1);const animationSet=this.animationSet;animationSet.from=progress.value,animationSet.to=COMBO_PROGRESS_MAP[data.combo],el.setAttribute('animation',animationSet),el.components.animation.beginAnimation()}})},function(module){function transformPlane(particleIndex,geometry,originalArray,position,rotation,scale){const array=geometry.attributes.position.array,index=particleIndex*NUM_PLANE_POSITIONS;tri.vertices[0].set(originalArray[index+0],originalArray[index+1],originalArray[index+2]),tri.vertices[1].set(originalArray[index+3],originalArray[index+4],originalArray[index+5]),tri.vertices[2].set(originalArray[index+6],originalArray[index+7],originalArray[index+8]),null!==scale&&tri.scale(scale.x,scale.y,scale.z),rotation&&(tri.rotateX(rotation.x),tri.rotateY(rotation.y),tri.rotateZ(rotation.z)),tri.vertices[0].add(position),tri.vertices[1].add(position),tri.vertices[2].add(position),array[index+0]=tri.vertices[0].x,array[index+1]=tri.vertices[0].y,array[index+2]=tri.vertices[0].z,array[index+3]=tri.vertices[1].x,array[index+4]=tri.vertices[1].y,array[index+5]=tri.vertices[1].z,array[index+6]=tri.vertices[2].x,array[index+7]=tri.vertices[2].y,array[index+8]=tri.vertices[2].z,tri.vertices[0].set(originalArray[index+3],originalArray[index+4],originalArray[index+5]),tri.vertices[1].set(originalArray[index+6],originalArray[index+7],originalArray[index+8]),tri.vertices[2].set(originalArray[index+9],originalArray[index+10],originalArray[index+11]),null!==scale&&tri.scale(scale.x,scale.y,scale.z),rotation&&(tri.rotateX(rotation.x),tri.rotateY(rotation.y),tri.rotateZ(rotation.z)),tri.vertices[0].add(position),tri.vertices[1].add(position),tri.vertices[2].add(position),array[index+9]=tri.vertices[2].x,array[index+10]=tri.vertices[2].y,array[index+11]=tri.vertices[2].z,geometry.attributes.position.needsUpdate=!0}function copyArray(dest,src){dest.length=0;for(let i=0;i<src.length;i++)dest[i]=src[i]}var _Mathfloor5=Math.floor,_MathPI3=Math.PI;const NUM_PLANE_POSITIONS=12,BLENDINGS={normal:THREE.NormalBlending,additive:THREE.AdditiveBlending,substractive:THREE.SubstractiveBlending,multiply:THREE.MultiplyBlending},SHADERS={flat:THREE.MeshBasicMaterial,lambert:THREE.MeshLambertMaterial,phong:THREE.MeshPhongMaterial,standard:THREE.MeshStandardMaterial},OFFSCREEN_VEC3=new THREE.Vector3(-99999,-99999,-99999);AFRAME.registerComponent('particleplayer',{schema:{blending:{default:'additive',oneOf:['normal','additive','multiply','substractive']},color:{default:'#fff',type:'color'},count:{default:'100%'},delay:{default:0,type:'int'},dur:{default:1e3,type:'int'},img:{type:'selector'},interpolate:{default:!1},loop:{default:'false'},on:{default:'init'},poolSize:{default:5,type:'int'},protation:{type:'vec3'},pscale:{default:1,type:'float'},scale:{default:1,type:'float'},initialScale:{type:'vec3'},finalScale:{type:'vec3'},animateScale:{default:!1},shader:{default:'flat',oneOf:['flat','lambert','phong','standard']},src:{type:'selector'}},multiple:!0,init:function(){this.frame=0,this.framedata=null,this.indexPool=null,this.lastFrame=0,this.material=null,this.msPerFrame=0,this.numFrames=0,this.numParticles=0,this.originalVertexPositions=[],this.particleCount=0,this.particleSystems=[],this.protation=!1,this.restPositions=[],this.restRotations=[],this.sprite_rotation=!1,this.systems=null,this.useRotation=!1,this.useAge=!1,this.scaleAnim=new THREE.Vector3,this.partScale=new THREE.Vector3(1,1,1)},update:function(oldData){const data=this.data;if(data.src){oldData.on!==data.on&&(oldData.on&&this.el.removeEventListener(oldData.on,this.start),'play'!==data.on&&this.el.addEventListener(data.on,this.start.bind(this))),this.partScale.set(1,1,1),this.loadParticlesJSON(data.src,data.scale),this.numFrames=this.framedata.length,this.numParticles=0<this.numFrames?this.framedata[0].length:0,this.particleCount='%'===data.count[data.count.length-1]?_Mathfloor5(parseInt(data.count)*this.numParticles/100):parseInt(data.count),this.particleCount=Math.min(this.numParticles,Math.max(0,this.particleCount)),this.msPerFrame=data.dur/this.numFrames,this.indexPool=Array(this.numParticles);const materialParams={color:new THREE.Color(data.color),side:THREE.DoubleSide,blending:BLENDINGS[data.blending],map:data.img?new THREE.TextureLoader().load(data.img.src):null,depthWrite:!1,opacity:data.opacity,transparent:!!data.img||'normal'!==data.blending||1>data.opacity};this.material=void 0===SHADERS[data.shader]?new SHADERS.flat(materialParams):new SHADERS[data.shader](materialParams),this.createParticles(data.poolSize),'init'===data.on&&this.start()}},loadParticlesJSON:function(json,scale){var alive;this.restPositions.length=0,this.restRotations.length=0;const jsonData=JSON.parse(json.data),frames=jsonData.frames,precision=jsonData.precision;this.useRotation=jsonData.rotation,this.useAge=jsonData.age!==void 0&&jsonData.age,this.sprite_rotation=!1!==jsonData.sprite_rotation&&{x:jsonData.sprite_rotation[0]/precision,y:jsonData.sprite_rotation[1]/precision,z:jsonData.sprite_rotation[2]/precision},this.framedata=Array(frames.length);for(let frameIndex=0;frameIndex<frames.length;frameIndex++){this.framedata[frameIndex]=Array(frames[frameIndex].length);for(let particleIndex=0,rawP;particleIndex<frames[frameIndex].length;particleIndex++){rawP=frames[frameIndex][particleIndex],alive=0!==rawP;let p=this.framedata[frameIndex][particleIndex]={position:alive?{x:rawP[0]/precision*scale,y:rawP[1]/precision*scale,z:rawP[2]/precision*scale}:null,alive:alive};this.useRotation&&(p.rotation=alive?{x:rawP[3]/precision,y:rawP[4]/precision,z:rawP[5]/precision}:null),this.useAge&&(p.age=alive?rawP[6]/precision:0),alive&&0===frameIndex&&(this.restPositions[particleIndex]=p.position?{x:p.position.y,y:p.position.y,z:p.position.z}:null,this.restRotations[particleIndex]=p.rotation?{x:p.rotation.y,y:p.rotation.y,z:p.rotation.z}:null)}}},createParticles:function(){const tempGeometries=[];return function(numParticleSystems){const data=this.data;var loop=parseInt(this.data.loop);this.particleSystems.length=0,isNaN(loop)&&(loop='true'===this.data.loop?Number.MAX_VALUE:0);for(let i=0,particleSystem;i<numParticleSystems;i++){particleSystem={active:!1,activeParticleIndices:Array(this.particleCount),loopCount:0,loopTotal:loop,mesh:null,time:0};const ratio=data.img?data.img.width/data.img.height:1;tempGeometries.length=0;for(let p=0,geometry;p<this.numParticles;p++)geometry=new THREE.PlaneBufferGeometry(0.1*ratio*data.pscale,0.1*data.pscale),!1===this.sprite_rotation?(geometry.rotateX(this.data.protation.x*_MathPI3/180),geometry.rotateY(this.data.protation.y*_MathPI3/180),geometry.rotateZ(this.data.protation.z*_MathPI3/180)):(geometry.rotateX(this.sprite_rotation.x),geometry.rotateY(this.sprite_rotation.y),geometry.rotateZ(this.sprite_rotation.z)),tempGeometries.push(geometry);let mergedBufferGeometry=THREE.BufferGeometryUtils.mergeBufferGeometries(tempGeometries);particleSystem.mesh=new THREE.Mesh(mergedBufferGeometry,this.material),particleSystem.mesh.visible=!1,this.el.setObject3D(`particleplayer${i}`,particleSystem.mesh),copyArray(this.originalVertexPositions,mergedBufferGeometry.attributes.position.array);for(let i=0;i<mergedBufferGeometry.attributes.position.array.length;i++)mergedBufferGeometry.attributes.position.array[i]=-99999;for(let i=0;i<particleSystem.activeParticleIndices.length;i++)particleSystem.activeParticleIndices[i]=i;this.particleSystems.push(particleSystem)}}}(),start:function(evt){0<this.data.delay?setTimeout(()=>this.startAfterDelay(evt),this.data.delay):this.startAfterDelay(evt)},startAfterDelay:function(evt){var found=-1,oldestTime=0,position=evt?evt.detail.position:null,rotation=evt?evt.detail.rotation:null,particleSystem;position instanceof THREE.Vector3||(position=new THREE.Vector3),rotation instanceof THREE.Euler||(rotation=new THREE.Euler);for(var i=0;i<this.particleSystems.length;i++){if(!1===this.particleSystems[i].active){found=i;break}this.particleSystems[i].time>oldestTime&&(found=i,oldestTime=this.particleSystems[i].time)}if(-1!==found)return particleSystem=this.particleSystems[found],particleSystem.active=!0,particleSystem.loopCount=1,particleSystem.mesh.visible=!0,particleSystem.mesh.position.copy(position),particleSystem.mesh.rotation.copy(rotation),particleSystem.time=0,this.resetParticles(particleSystem),particleSystem},doLoop:function(particleSystem){particleSystem.loopCount++,particleSystem.frame=-1,particleSystem.time=0,this.resetParticles(particleSystem)},resetParticle:function(particleSystem,particleIndex){const geometry=particleSystem.mesh.geometry;this.restPositions[particleIndex]?transformPlane(particleIndex,geometry,this.originalVertexPositions,this.restPositions[particleIndex],this.useRotation&&this.restRotations[particleIndex],null):transformPlane(particleIndex,geometry,this.originalVertexPositions,OFFSCREEN_VEC3,void 0,null)},resetParticles:function(particleSystem){var i,rand;if(this.particleCount===this.numParticles){for(i=0;i<this.numParticles;i++)this.resetParticle(particleSystem,i);return}const geometry=particleSystem.mesh.geometry;for(i=0;i<this.numParticles;i++)i<this.particleCount&&transformPlane(particleSystem.activeParticleIndices[i],geometry,this.originalVertexPositions,OFFSCREEN_VEC3,void 0,null),this.indexPool[i]=i;for(i=0;i<this.particleCount;i++)rand=i+_Mathfloor5(Math.random()*(this.numParticles-i)),particleSystem.activeParticleIndices[i]=this.indexPool[rand],this.indexPool[rand]=this.indexPool[i],this.resetParticle(particleSystem,particleSystem.activeParticleIndices[i])},tick:function(){const helperPositionVec3=new THREE.Vector3;return function(time,delta){var useRotation=this.useRotation,frame,fdata,fdataNext,frameTime,relTime,interpolate;const scaleSystem=this.data.animateScale&&!this.useAge,scaleParticle=this.data.animateScale&&this.useAge;for(let particleSystemIndex=0,particleSystem;particleSystemIndex<this.particleSystems.length;particleSystemIndex++)if(particleSystem=this.particleSystems[particleSystemIndex],!!particleSystem.active){interpolate=this.data.interpolate&&this.data.dur/this.numFrames>delta,relTime=particleSystem.time/this.data.dur,frame=relTime*this.numFrames,fdata=this.framedata[_Mathfloor5(frame)],interpolate&&(frameTime=frame-_Mathfloor5(frame),fdataNext=frame<this.numFrames-1?this.framedata[_Mathfloor5(frame)+1]:null),scaleSystem&&this.partScale.lerpVectors(this.data.initialScale,this.data.finalScale,relTime);for(let activeParticleIndex=0;activeParticleIndex<particleSystem.activeParticleIndices.length;activeParticleIndex++){let particleIndex=particleSystem.activeParticleIndices[activeParticleIndex],rotation=useRotation&&fdata[particleIndex].rotation;if(scaleParticle&&this.partScale.lerpVectors(this.data.initialScale,this.data.finalScale,fdata[particleIndex].age),!fdata[particleIndex].alive){transformPlane(particleIndex,particleSystem.mesh.geometry,this.originalVertexPositions,OFFSCREEN_VEC3,void 0,null);continue}interpolate&&fdataNext&&fdataNext[particleIndex].alive?(helperPositionVec3.lerpVectors(fdata[particleIndex].position,fdataNext[particleIndex].position,frameTime),transformPlane(particleIndex,particleSystem.mesh.geometry,this.originalVertexPositions,helperPositionVec3,rotation,this.partScale)):transformPlane(particleIndex,particleSystem.mesh.geometry,this.originalVertexPositions,fdata[particleIndex].position,rotation,this.partScale)}if(particleSystem.time+=delta,particleSystem.time>=this.data.dur){particleSystem.loopCount<particleSystem.loopTotal?(this.el.emit('particleplayerloop',null,!1),this.doLoop(particleSystem)):(this.el.emit('particleplayerfinished',null,!1),particleSystem.active=!1,particleSystem.mesh.visible=!1);continue}}}}(),_transformPlane:transformPlane});const tri=function(){const tri=new THREE.Geometry;return tri.vertices.push(new THREE.Vector3),tri.vertices.push(new THREE.Vector3),tri.vertices.push(new THREE.Vector3),tri.faces.push(new THREE.Face3(0,1,2)),tri}();module.exports.transformPlane=transformPlane},function(){AFRAME.registerComponent('pause',{schema:{isPaused:{default:!1}},update:function(){this.data.isPaused&&this.el.isPlaying?this.el.pause():!this.data.isPaused&&!this.el.isPlaying&&this.el.sceneEl.isPlaying&&this.el.play()}})},function(){AFRAME.registerComponent('pauser',{schema:{enabled:{default:!0}},init:function(){this.pauseGame=this.pauseGame.bind(this),this.el.sceneEl.addEventListener('controllerconnected',evt=>{'vive-controls'===evt.detail.name?this.el.addEventListener('menudown',this.pauseGame):this.el.addEventListener('thumbstickdown',this.pauseGame)}),document.addEventListener('visibilitychange',()=>{'hidden'===document.visibilityState&&this.pauseGame()})},pauseGame:function(){this.data.enabled&&this.el.sceneEl.emit('pausegame',null,!1)}})},function(module,exports,__webpack_require__){var SoundPool=__webpack_require__(132);AFRAME.registerSystem('play-sound',{init:function(){this.lastSoundPlayed='',this.lastSoundPlayedTime=0,this.pools={}},createPool:function(sound,volume){this.pools[sound]||(this.pools[sound]=new SoundPool(sound,volume))},playSound:function(sound,volume){this.pools[sound]||this.createPool(sound,volume),this.pools[sound].play(),this.lastSoundPlayed=sound,this.lastSoundTime=this.el.time}}),AFRAME.registerComponent('play-sound',{schema:{enabled:{default:!0},event:{type:'string'},sound:{type:'string'},volume:{type:'number',default:1}},multiple:!0,init:function(){this.el.addEventListener(this.data.event,()=>{this.data.enabled&&this.system.playSound(this.src,this.data.volume)})},update:function(){this.src=this.data.sound,this.data.sound.startsWith('#')&&(this.src=document.querySelector(this.data.sound).getAttribute('src'))}})},function(){AFRAME.registerComponent('raycaster-target',{schema:{bindToggle:{default:''},depth:{type:'number'},height:{type:'number'},position:{type:'vec3',default:{x:0,y:0,z:0}},rotation:{type:'vec3',default:{x:0,y:0,z:0}},useBoxTarget:{default:!1},width:{type:'number'}},init:function(){var boxGeometry={primitive:'box'},planeGeometry={primitive:'plane'};return function(){var data=this.data,el=this.el,geometry,raycastTarget;raycastTarget=document.createElement('a-entity'),raycastTarget.classList.add('raycasterTarget'),data.bindToggle?raycastTarget.setAttribute('bind-toggle__raycastable',data.bindToggle):raycastTarget.setAttribute('data-raycastable',''),data.useBoxTarget?(geometry=boxGeometry,geometry.depth=data.depth,geometry.height=data.height,geometry.width=data.width):(geometry=planeGeometry,geometry.height=data.height,geometry.width=data.width),raycastTarget.setAttribute('geometry',geometry),raycastTarget.object3D.visible=!1,raycastTarget.object3D.position.copy(data.position),raycastTarget.object3D.rotation.x=THREE.Math.degToRad(data.rotation.x),raycastTarget.object3D.rotation.y=THREE.Math.degToRad(data.rotation.y),raycastTarget.object3D.rotation.z=THREE.Math.degToRad(data.rotation.z),el.appendChild(raycastTarget)}}()})},function(){AFRAME.registerComponent('recenter',{schema:{enabled:{default:!0}},init:function(){this.el.sceneEl;this.recenter=this.recenter.bind(this),document.querySelectorAll('[tracked-controls]').forEach(controlEl=>{controlEl.addEventListener('menudown',this.recenter),controlEl.addEventListener('thumbstickdown',this.recenter)}),this.el.addEventListener('recenter',this.recenter)},recenter:function(){var euler=new THREE.Euler,matrix=new THREE.Matrix4,rotationMatrix=new THREE.Matrix4,translationMatrix=new THREE.Matrix4;return function(){const el=this.el;if(this.data.enabled){const camera=el.sceneEl.camera.el.object3D;matrix.identity(),euler.set(0,-1*camera.rotation.y,0),rotationMatrix.makeRotationFromEuler(euler),translationMatrix.makeTranslation(-1*camera.position.x,0,-1*camera.position.z),matrix.multiply(rotationMatrix).multiply(translationMatrix),matrix.decompose(el.object3D.position,el.object3D.quaternion,el.object3D.scale),el.object3D.updateMatrixWorld(!0),el.emit('recentered',null,!1)}}}()})},function(){AFRAME.registerComponent('saber-controls',{schema:{bladeEnabled:{default:!1},hand:{default:'right',oneOf:['left','right']},isPaused:{default:!1},strokeMinSpeed:{default:2e-3},strokeMinDuration:{default:40}},init:function(){var el=this.el,data=this.data;this.boundingBox=new THREE.Box3,this.controllerType='',this.xPlaneNormal=new THREE.Vector3(0,1,0),this.yPlaneNormal=new THREE.Vector3(1,0,0),this.xyPlaneNormal=new THREE.Vector3(1,1,0),this.bladeTipPosition=new THREE.Vector3,this.bladePosition=new THREE.Vector3,this.bladeVector=new THREE.Vector3,this.bladeTipPreviousPosition=new THREE.Vector3,this.projectedBladeVector=new THREE.Vector3,this.saberPosition=new THREE.Vector3,this.swinging=!1,this.strokeCount=0,this.distanceSamples=[],this.deltaSamples=[],this.startStrokePosition=new THREE.Vector3,this.strokeDirectionVector=new THREE.Vector3,this.strokeDirection={down:!1,left:!1,right:!1,up:!1},this.accumulatedDistance=0,this.accumulatedDelta=0,el.addEventListener('controllerconnected',this.initSaber.bind(this));const hand={hand:data.hand,model:!1};el.setAttribute('oculus-touch-controls',hand),el.setAttribute('vive-controls',hand),el.setAttribute('windows-motion-controls',hand),this.bladeEl=this.el.querySelector('.blade')},update:function(oldData){!oldData.bladeEnabled&&this.data.bladeEnabled&&this.bladeEl.emit('drawblade')},tick:function(time,delta){this.data.bladeEnabled&&(this.boundingBox.setFromObject(this.bladeEl.getObject3D('mesh')),this.detectStroke(delta))},detectStroke:function(delta){var distanceSamples=this.distanceSamples,data=this.data,distance;this.bladeTipPosition.set(0,0,-0.8),this.bladePosition.set(0,0,0);const saberObj=this.el.object3D;saberObj.parent.updateMatrixWorld(),saberObj.localToWorld(this.bladeTipPosition),saberObj.localToWorld(this.bladePosition),this.bladeVector.copy(this.bladeTipPosition).sub(this.bladePosition).normalize();var anglePlaneX=this.projectedBladeVector.copy(this.bladeTipPosition).projectOnPlane(this.xPlaneNormal).angleTo(this.bladeVector),anglePlaneY=this.projectedBladeVector.copy(this.bladeTipPosition).projectOnPlane(this.yPlaneNormal).angleTo(this.bladeVector),anglePlaneXY=this.projectedBladeVector.copy(this.bladeTipPosition).projectOnPlane(this.xyPlaneNormal).angleTo(this.bladeVector);if(distance=this.bladeTipPreviousPosition.sub(this.bladeTipPosition).length(),5===this.distanceSamples.length&&(this.accumulatedDistance-=this.distanceSamples.shift(),this.accumulatedDelta-=this.deltaSamples.shift()),this.distanceSamples.push(distance),this.accumulatedDistance+=distance,this.deltaSamples.push(delta),this.accumulatedDelta+=delta,this.accumulatedDistance/this.accumulatedDelta>this.data.strokeMinSpeed){this.swinging||(this.startStrokePosition.copy(this.bladeTipPosition),this.swinging=!0,this.strokeDuration=0,this.maxAnglePlaneX=0,this.maxAnglePlaneY=0,this.maxAnglePlaneXY=0),this.updateStrokeDirection(),this.strokeDuration+=delta;const anglePlaneXIncreased=anglePlaneX>this.maxAnglePlaneX,anglePlaneYIncreased=anglePlaneY>this.maxAnglePlaneY,anglePlaneXYIncreased=anglePlaneXY>this.maxAnglePlaneXY;this.maxAnglePlaneX=anglePlaneXIncreased?anglePlaneX:this.maxAnglePlaneX,this.maxAnglePlaneY=anglePlaneYIncreased?anglePlaneY:this.maxAnglePlaneY,this.maxAnglePlaneXY=anglePlaneXYIncreased?anglePlaneXY:this.maxAnglePlaneXY,anglePlaneXIncreased||anglePlaneYIncreased||this.endStroke()}else this.endStroke();this.bladeTipPreviousPosition.copy(this.bladeTipPosition)},endStroke:function(){if(this.swinging&&!(this.strokeDuration<this.data.strokeMinDuration)){this.el.emit('strokeend'),this.swinging=!1,this.accumulatedDistance=0,this.accumulatedDelta=0,this.maxAnglePlaneX=0,this.maxAnglePlaneY=0,this.maxAnglePlaneXY=0;for(let i=0;i<this.distanceSamples.length;i++)this.distanceSamples[i]=0;for(let i=0;i<this.deltaSamples.length;i++)this.deltaSamples[i]=0}},updateStrokeDirection:function(){this.strokeDirectionVector.copy(this.bladeTipPosition).sub(this.startStrokePosition);0===this.strokeDirectionVector.x&&0===this.strokeDirectionVector.y||(this.strokeDirection.right=0<this.strokeDirectionVector.x,this.strokeDirection.left=0>this.strokeDirectionVector.x,this.strokeDirection.up=0<this.strokeDirectionVector.y,this.strokeDirection.down=0>this.strokeDirectionVector.y)},initSaber:function(evt){this.controllerType=evt.detail.name,this.el.setAttribute('cursor',this.config[this.controllerType].cursor||{})},config:{"oculus-touch-controls":{cursor:{downEvents:['triggerdown','gripdown','abuttondown','bbuttondown','xbuttondown','ybuttondown'],upEvents:['triggerup','gripup','abuttonup','bbuttonup','xbuttonup','ybuttonup']}},"vive-controls":{cursor:{downEvents:['trackpaddown','triggerdown','gripdown'],upEvents:['trackpadup','triggerup','gripup']}},"windows-motion-controls":{cursor:{downEvents:['trackpaddown','triggerdown','gripdown'],upEvents:['trackpadup','triggerup','gripup']}}}})},function(){AFRAME.registerComponent('saber-particles',{schema:{enabled:{default:!1},hand:{type:'string'}},init:function(){this.hiddenIntersection={x:999,y:0,z:0},this.intersectedEl=null,this.particles=document.getElementById('sparkParticles'),this.particleEventDetail={position:new THREE.Vector3,rotation:new THREE.Euler},this.particleEvent={detail:this.particleEventDetail},this.particleSystem=null,this.saberEnter=this.saberEnter.bind(this),this.saberLeave=this.saberLeave.bind(this)},pause:function(){this.el.removeEventListener('mouseenter',this.saberEnter),this.el.removeEventListener('mouseleave',this.saberLeave)},play:function(){this.el.addEventListener('mouseenter',this.saberEnter),this.el.addEventListener('mouseleave',this.saberLeave),this.particlesDur=this.particles.getAttribute('particleplayer').dur},saberEnter:function(evt){this.data.enabled&&evt.target===this.el&&evt.detail.intersectedEl.hasAttribute('data-saber-particles')&&(this.intersectedEl=evt.detail.intersectedEl)},saberLeave:function(evt){if(evt.detail.target===this.el){if(this.intersectedEl.components.wall||'floor'===this.intersectedEl.id){const uniform=this.data.hand==='right'?'hitRight':'hitLeft',material=this.intersectedEl.getObject3D('mesh').material;material.uniforms[uniform].value=this.hiddenIntersection}this.intersectedEl=null,this.particleSystem=null}},tick:function(){if(this.data.enabled&&this.intersectedEl){const raycaster=this.el.components.raycaster__game,intersection=raycaster.getIntersection(this.intersectedEl);intersection&&(this.particleSystem&&this.particleSystem.active?this.particleSystem.mesh.position.copy(intersection.point):(this.particleEventDetail.position.copy(intersection.point),this.particleSystem=this.particles.components.particleplayer.startAfterDelay(this.particleEvent)))}}})},function(){AFRAME.registerComponent('score-beat',{schema:{type:{type:'string'}},play:function(){this.poolComponent=`pool__beatscore${this.data.type}`,this.startTime=this.el.sceneEl.time},tick:function(time){time>this.startTime+1200&&this.el.sceneEl.components[this.poolComponent].returnEntity(this.el)}})},function(){AFRAME.registerComponent('score-texts',{schema:{isSongLoading:{default:!1}},init:function(){this.textEls=this.el.querySelectorAll('[text]');for(let i=0;i<this.textEls.length;i++)this.textEls[i].setAttribute('animation__fadein',{autoplay:!1,property:'components.text.material.uniforms.opacity.value',delay:250,dur:750,easing:'easeInOutCubic',from:0,to:1})},update:function(oldData){if(oldData.isSongLoading&&!this.data.isSongLoading){for(let i=0;i<this.textEls.length;i++)this.textEls[i].components.animation__fadein.beginAnimation();this.el.sceneEl.emit('textglownormal',null,!1)}if(!oldData.isSongLoading&&this.data.isSongLoading){for(let i=0;i<this.textEls.length;i++)this.textEls[i].components.text.material.uniforms.opacity.value=0;this.el.sceneEl.emit('textglowoff',null,!1)}}})},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__utils__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_0__utils___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__utils__),CANVAS_HEIGHT=512,HEIGHT=64,NUM_PER_PAGE=6,WIDTH=64,IMAGE_HEIGHT_CANVAS=HEIGHT*(CANVAS_HEIGHT/(HEIGHT*NUM_PER_PAGE));AFRAME.registerComponent('search-thumbnail-atlas',{dependencies:['geometry','material'],schema:{dummyUpdater:{type:'string'}},init:function(){const canvas=this.canvas=document.createElement('canvas');canvas.setAttribute('id','thumbnailAtlasMap'),canvas.height=CANVAS_HEIGHT,canvas.width=WIDTH,this.ctx=canvas.getContext('2d'),this.clearCanvas(),document.body.appendChild(canvas);const alphaCanvas=this.alphaCanvas=document.createElement('canvas');alphaCanvas.setAttribute('id','thumbnailAlphaMap'),alphaCanvas.height=CANVAS_HEIGHT,alphaCanvas.width=WIDTH,this.alphaCtx=alphaCanvas.getContext('2d'),document.body.appendChild(alphaCanvas),this.el.components.material.material.alphaMap=new THREE.CanvasTexture(alphaCanvas),this.el.setAttribute('material','src',canvas),this.images=[],this.lastNumResults=NUM_PER_PAGE},update:function(){var el=this.el;const results=el.sceneEl.systems.state.state.searchResultsPage;for(let i=0,img;i<results.length;i++)img=this.images[i]=this.images[i]||document.createElement('img'),img.crossOrigin='anonymous',img.src=__WEBPACK_IMPORTED_MODULE_0__utils___default.a.getS3FileUrl(results[i].id,'image.jpg'),img.complete?this.draw(img,i):img.onload=()=>{this.draw(img,i)};results.length!==this.lastNumResults&&this.updateAlphaMap(results.length),this.lastNumResults=results.length},draw:function(img,i){this.ctx.drawImage(img,0,i*IMAGE_HEIGHT_CANVAS,WIDTH,IMAGE_HEIGHT_CANVAS),this.el.getObject3D('mesh').material.map.needsUpdate=!0},clearCanvas:function(){const canvas=this.canvas;this.ctx.fillStyle='#111',this.ctx.fillRect(0,0,canvas.width,canvas.height)},updateAlphaMap:function(numResults){const canvas=this.alphaCanvas,ctx=this.alphaCtx;ctx.fillStyle='#FFF',ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle='#000',ctx.fillRect(0,numResults*IMAGE_HEIGHT_CANVAS,canvas.width,canvas.height-numResults*IMAGE_HEIGHT_CANVAS),this.el.getObject3D('mesh').material.alphaMap.needsUpdate=!0,this.el.getObject3D('mesh').material.needsUpdate=!0}})},function(module,exports,__webpack_require__){var algoliasearch=__webpack_require__(45),bindEvent=__webpack_require__(15).bindEvent,client=algoliasearch('QULTOY3ZWU','be07164192471df7e97e6fa70c1d041d'),algolia=client.initIndex('supersaber');AFRAME.registerComponent('search',{init:function(){this.eventDetail={query:'',results:[]},this.popularHits=null,this.queryObject={hitsPerPage:100,query:''},this.search(''),this.queryObject.hitsPerPage=30,this.el.sceneEl.addEventListener('searchclear',()=>{this.search('')})},superkeyboardchange:bindEvent(function(evt){evt.target!==this.el||this.search(evt.detail.value)}),search:function(query){return!query&&this.popularHits?(this.eventDetail.results=this.popularHits,this.eventDetail.query='',void this.el.sceneEl.emit('searchresults',this.eventDetail)):void(this.eventDetail.query=query,this.queryObject.query=query,algolia.search(this.queryObject,(err,content)=>err?(this.el.sceneEl.emit('searcherror',null,!1),void console.error(err)):void(!query&&(this.popularHits=content.hits),this.eventDetail.results=content.hits,this.el.sceneEl.emit('searchresults',this.eventDetail))))}}),AFRAME.registerComponent('search-genre',{init:function(){this.eventDetail={isGenreSearch:!0,genre:'',results:[]},this.queryObject={filters:'',hitsPerPage:100},this.el.addEventListener('click',evt=>{this.search(evt.target.closest('.genre').dataset.bindForKey)})},search:function(genre){this.queryObject.filters='Video Games'===genre?`genre:"Video Game" OR genre:"Video Games"`:`genre:"${genre}"`,algolia.search(this.queryObject,(err,content)=>err?(this.el.sceneEl.emit('searcherror',null,!1),void console.error(err)):void(this.eventDetail.genre=genre,this.eventDetail.results=content.hits,this.el.sceneEl.emit('searchresults',this.eventDetail)))}}),AFRAME.registerComponent('search-result-list',{init:function(){const obv=new MutationObserver(mutations=>{for(let i=0;i<mutations.length;i++)'data-index'===mutations[i].attributeName&&this.refreshLayout()});obv.observe(this.el,{attributes:!0,childList:!1,subtree:!0})},refreshLayout:function(){this.el.emit('layoutrefresh',null,!1)},click:bindEvent(function(evt){this.el.sceneEl.emit('menuchallengeselect',evt.target.closest('.searchResult').dataset.id,!1)})}),AFRAME.registerComponent('search-song-name-selected',{schema:{anchor:{default:0},index:{default:0},offset:{default:0},selectedChallengeId:{default:''}},update:function(){const data=this.data,el=this.el;el.object3D.visible=!!data.selectedChallengeId&&-1!==data.index,el.object3D.position.y=data.index*data.offset+data.anchor}})},function(module,exports,__webpack_require__){var utils=__webpack_require__(2);AFRAME.registerComponent('song-preview-system',{schema:{challengeId:{default:''},debug:{default:!1},isSearching:{default:!1},isSongLoading:{default:!1},selectedChallengeId:{type:'string'}},init:function(){this.analyserEl=document.getElementById('audioAnalyser'),this.audio=document.createElement('audio'),this.audioStore={},this.preloadedAudioIds=[],this.preloadQueue=[]},update:function(oldData){const data=this.data;return!oldData.challengeId&&data.challengeId?void((0===this.analyserEl.components.audioanalyser.volume||1>this.audio.currentTime)&&this.stopSong()):(!oldData.selectedChallengeId||data.selectedChallengeId||data.isSearching||this.stopSong(),oldData.isSongLoading&&!data.isSongLoading?void this.stopSong():void(data.selectedChallengeId&&oldData.selectedChallengeId!==data.selectedChallengeId&&(this.audio&&this.stopSong(),!this.preloadedAudioIds.includes(data.selectedChallengeId)&&data.selectedChallengeId!==this.currentLoadingId&&this.prioritizePreloadSong(),this.playSong(data.selectedChallengeId))))},log:function(str){this.data.debug&&console.log(str)},prioritizePreloadSong:function(){const data=this.data,preloadQueue=this.preloadQueue;this.log(`[song-preview] Prioritizing loading of ${data.selectedChallengeId}`),this.priorityLoadingChallengeId=data.selectedChallengeId,this.audioStore[data.selectedChallengeId].addEventListener('loadeddata',()=>{this.log(`[song-preview] Finished load of priority ${data.selectedChallengeId}`),this.preloadedAudioIds.push(data.selectedChallengeId),this.priorityLoadingChallengeId='',preloadQueue.length&&(this.log(`[song-preview] Resuming queue with ${preloadQueue[0].challengeId}`),this.preloadMetadata(preloadQueue[0]))}),this.audioStore[data.selectedChallengeId].src=utils.getS3FileUrl(data.selectedChallengeId,'song.ogg');for(let i=0;i<preloadQueue.length;i++)if(preloadQueue[i].challengeId===data.selectedChallengeId){preloadQueue.splice(i,1);break}},queuePreloadSong:function(challengeId,previewStartTime){if(!this.audioStore[challengeId]){const audio=document.createElement('audio');audio.crossOrigin='anonymous',audio.dataset.previewStartTime=previewStartTime,this.audioStore[challengeId]=audio;let src=utils.getS3FileUrl(challengeId,'song.ogg');this.currentLoadingId?this.preloadQueue.push({audio:audio,challengeId:challengeId,src:src}):this.preloadMetadata({audio:audio,challengeId:challengeId,src:src})}},preloadMetadata:function(preloadItem){const audio=preloadItem.audio;this.log(`[song-preview] Preloading song preview ${preloadItem.challengeId}`),audio.addEventListener('loadedmetadata',()=>{this.log(`[song-preview] Finished preloading song preview ${preloadItem.challengeId}`),this.preloadedAudioIds.push(preloadItem.challengeId),this.currentLoadingId='',this.log(`[song-preview] ${this.preloadQueue.length} in queue`),this.preloadQueue.length&&!this.priorityLoadingChallengeId&&this.preloadMetadata(this.preloadQueue.shift())}),audio.preload='metadata',audio.src=preloadItem.src,this.currentLoadingId=preloadItem.challengeId},stopSong:function(){this.audio&&(this.audio.paused||this.audio.pause())},playSong:function(challengeId){if(challengeId){this.audio=this.audioStore[challengeId],this.audio.load(),this.audio.volume=0.5,this.audio.currentTime=this.audio.dataset.previewStartTime,this.analyserEl.setAttribute('audioanalyser','src',this.audio);const audioanalyser=this.analyserEl.components.audioanalyser;audioanalyser.resumeContext(),this.audio.play(),audioanalyser.xhr&&audioanalyser.xhr.abort(),audioanalyser.fetchAudioBuffer(utils.getS3FileUrl(challengeId,'song.ogg'))}},clearSong:function(challengeId){let audio=this.audioStore[challengeId];audio.preload='none';let index;for(let i=0;i<this.preloadQueue.length;i++)if(this.preloadQueue[i].id===challengeId){index=i;break}index&&this.preloadQueue.splice(index,1)}}),AFRAME.registerComponent('song-preview',{schema:{challengeId:{type:'string'},previewStartTime:{type:'number'}},update:function(oldData){oldData.challengeId&&this.data.challengeId!==oldData.challengeId&&this.el.sceneEl.components['song-preview-system'].clearSong(oldData.challengeId),this.el.sceneEl.components['song-preview-system'].queuePreloadSong(this.data.challengeId,this.data.previewStartTime)}})},function(){AFRAME.registerComponent('song-progress-ring',{dependencies:['geometry','material'],schema:{enabled:{default:!1}},init:function(){this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),1e3),this.progress=this.el.getObject3D('mesh').material.uniforms.progress,this.el.sceneEl.addEventListener('cleargame',()=>{this.progress.value=0})},update:function(){this.progress.value=0},updateRing:function(){const source=this.el.sceneEl.components.song.source;if(source){const progress=this.el.sceneEl.components.song.getCurrentTime()/source.buffer.duration;this.progress.value=progress}},tick:function(){this.data.enabled&&this.updateRing()}})},function(module,exports,__webpack_require__){const utils=__webpack_require__(2),GAME_OVER_LENGTH=3.5,ONCE={once:!0},BASE_VOLUME=0.75;let skipDebug=AFRAME.utils.getUrlParameter('skip');!skipDebug||(skipDebug=parseInt(skipDebug)/1e3),AFRAME.registerComponent('song',{schema:{analyserEl:{type:'selector',default:'#audioAnalyser'},challengeId:{default:''},isBeatsPreloaded:{default:!1},isGameOver:{default:!1},isPlaying:{default:!1},isVictory:{default:!1}},init:function(){this.analyserSetter={buffer:!0},this.audioAnalyser=this.data.analyserEl.components.audioanalyser,this.context=this.audioAnalyser.context,this.isPlaying=!1,this.songLoadingIndicator=document.getElementById('songLoadingIndicator'),this.songStartTime=0,this.victory=this.victory.bind(this),this.audioAnalyser.gainNode.gain.value=BASE_VOLUME,this.el.addEventListener('gamemenurestart',this.onRestart.bind(this)),this.el.addEventListener('wallhitstart',this.onWallHitStart.bind(this)),this.el.addEventListener('wallhitend',this.onWallHitEnd.bind(this)),!1},update:function(oldData){var data=this.data;return!oldData.isGameOver&&data.isGameOver?void this.onGameOver():(oldData.isGameOver&&!data.isGameOver&&(this.audioAnalyser.gainNode.value=BASE_VOLUME),!oldData.isVictory&&data.isVictory)?(this.data.analyserEl.addEventListener('audioanalyserbuffersource',evt=>{this.audioAnalyser.resumeContext();const gain=this.audioAnalyser.gainNode.gain;gain.cancelScheduledValues(0),gain.setValueAtTime(0.05,0),this.source=evt.detail,this.source.start()},ONCE),void this.audioAnalyser.refreshSource()):(!oldData.isBeatsPreloaded&&this.data.isBeatsPreloaded&&this.source&&this.startAudio(),oldData.challengeId&&!data.challengeId?void this.stopAudio():void(oldData.challengeId!==data.challengeId&&data.challengeId&&(this.el.sceneEl.emit('songloadstart',null,!1),this.getAudio().then(()=>{this.el.sceneEl.emit('songloadfinish',null,!1)}).catch(console.error)),oldData.isPlaying&&!data.isPlaying&&this.audioAnalyser.suspendContext(),!oldData.isPlaying&&data.isPlaying&&this.source&&this.audioAnalyser.resumeContext()))},getAudio:function(){const data=this.data;return this.isPlaying=!1,new Promise(resolve=>(data.analyserEl.addEventListener('audioanalyserbuffersource',evt=>{this.source=evt.detail,resolve(this.source)},ONCE),this.analyserSetter.src=utils.getS3FileUrl(data.challengeId,'song.ogg'),data.analyserEl.setAttribute('audioanalyser',this.analyserSetter),this.audioAnalyser.xhr.response?(this.songLoadingIndicator.setAttribute('material','progress',1),void this.el.sceneEl.emit('songfetchfinish',null,!1)):void this.audioAnalyser.xhr.addEventListener('progress',evt=>{this.onFetchProgress(evt)})))},stopAudio:function(){return this.source?void(this.source.stop(),this.source.disconnect(),this.source=null,this.isPlaying=!1):void console.warn('[song] Tried to stopAudio, but not playing.')},victory:function(){this.data.isPlaying&&this.el.sceneEl.emit('victory',null,!1)},onFetchProgress:function(evt){const progress=evt.loaded/evt.total;this.songLoadingIndicator.setAttribute('material','progress',progress),1<=progress&&this.el.sceneEl.emit('songfetchfinish',null,!1)},onGameOver:function(){this.isPlaying=!1;const playbackRate=this.source.playbackRate;playbackRate.setValueAtTime(playbackRate.value,this.context.currentTime),playbackRate.linearRampToValueAtTime(0,this.context.currentTime+GAME_OVER_LENGTH);const gain=this.audioAnalyser.gainNode.gain;gain.setValueAtTime(gain.value,this.context.currentTime),gain.linearRampToValueAtTime(0,this.context.currentTime+GAME_OVER_LENGTH),setTimeout(()=>{this.data.isGameOver&&this.stopAudio()},3500)},onRestart:function(){this.isPlaying=!1,this.source&&this.source.disconnect();const gain=this.audioAnalyser.gainNode.gain;gain.cancelScheduledValues(0),this.data.analyserEl.addEventListener('audioanalyserbuffersource',evt=>{this.source=evt.detail,this.el.sceneEl.emit('songloadfinish',null,!1)},ONCE),this.audioAnalyser.refreshSource()},onWallHitStart:function(){const gain=this.audioAnalyser.gainNode.gain;gain.linearRampToValueAtTime(0.2,this.context.currentTime+0.1)},onWallHitEnd:function(){const gain=this.audioAnalyser.gainNode.gain;gain.linearRampToValueAtTime(BASE_VOLUME,this.context.currentTime+0.1)},startAudio:function(){const gain=this.audioAnalyser.gainNode.gain;gain.setValueAtTime(BASE_VOLUME,this.context.currentTime),this.songStartTime=this.context.currentTime,this.source.onended=this.victory,this.source.start(0,skipDebug),this.isPlaying=!0},getCurrentTime:function(){return this.context.currentTime-this.songStartTime}})},function(){AFRAME.registerComponent('stage-colors',{dependencies:['background'],schema:{color:{default:'blue',oneOf:['blue','red']}},init:function(){this.colorCodes=['off','blue','blue','bluefade','','red','red','redfade'],this.el.addEventListener('cleargame',this.resetColors.bind(this))},update:function(){this.updateColors(this.data.color)},setColor:function(target,code){this.el.emit(`${target}color${this.colorCodes[code]}`,null,!1)},resetColors:function(){this.updateColors('blue'),this.el.emit('bgcolorblue',null,!1),this.el.emit('tunnelcolorred',null,!1),this.el.emit('floorcolorred',null,!1),this.el.emit('leftlasercolorblue',null,!1),this.el.emit('rightlasercolorblue',null,!1)},updateColors:function(){}})},function(){AFRAME.registerComponent('stage-lasers',{schema:{enabled:{default:!0}},init:function(){this.speed=0,this.lasers=[this.el.children[0].object3D,this.el.children[1].object3D,this.el.children[2].object3D]},pulse:function(speed){this.speed=speed/8},tick:function(time,delta){if(0!==this.speed)return delta/=1e3,!this.data.enabled&&(this.speed*=0.97,0.01>Math.abs(this.speed))?void(this.speed=0):void(this.lasers[0].rotation.z+=this.speed*delta,this.lasers[1].rotation.z-=1.01*(this.speed*delta),this.lasers[2].rotation.z+=1.02*(this.speed*delta))}})},function(){AFRAME.registerShader('stageShader',{schema:{color:{type:'vec3',is:'uniform',default:{x:0,y:0,z:0}},fogColor:{type:'vec3',is:'uniform',default:{x:0,y:0.48,z:0.72}},src:{type:'map',is:'uniform'}},vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    #define FOG_RADIUS  50.0
    #define FOG_FALLOFF 45.0
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 color;
    uniform vec3 fogColor;
    uniform sampler2D src;

    void main() {
      vec4 col = texture2D(src, uvs);
      col.xyz = mix(fogColor, col.xyz, clamp(distance(worldPos, vec3(0., 0., -FOG_RADIUS)) / FOG_FALLOFF, 0., 1.));
      gl_FragColor = col;
    }
  `})},function(){AFRAME.registerComponent('stats-param',{init:function(){'true'===AFRAME.utils.getUrlParameter('stats')&&this.el.setAttribute('stats','')}})},function(){AFRAME.registerComponent('stepback',{init:function(){this.message=document.getElementById('stepback'),this.camera=document.getElementById('camera'),this.lastTime=0,this.limit=-(this.el.getAttribute('geometry').height/2-0.6),this.throttling=300},tick:function(time){if(!(time-this.lastTime<this.throttling)){var camPos=this.camera.object3D.position,msgPos=this.message.object3D.position;camPos.z<this.limit?(this.throttling=20,this.message.object3D.visible=!0,this.message.getObject3D('mesh').material.opacity=1-Math.abs(camPos.z-msgPos.z),msgPos.x=camPos.x,msgPos.y=camPos.y):(this.message.object3D.visible=!1,this.throttling=300),this.lastTime=time}}})},function(){AFRAME.registerComponent('sub-object',{schema:{from:{type:'selector'},name:{type:'string'}},init:function(){var el=this.el,data=this.data;data.from.addEventListener('model-loaded',evt=>{const model=evt.detail.model,subset=model.getObjectByName(data.name);el.setObject3D('mesh',subset.clone()),el.setAttribute('material','shader','flat'),el.emit('subobjectloaded',null,!1)})}})},function(){function findFontChar(chars,code){for(var i=0;i<chars.length;i++)if(chars[i].id===code)return chars[i];return null}var _Mathfloor6=Math.floor,KEYBOARDS={supersaber:{wrapCount:20,inputOffsetY:8e-3,inputOffsetX:0.08,img:'keyboard.png',hoverImg:'keyboard-hover.png',layout:[{key:'1',x:0.014,y:0.024,w:0.094,h:0.183},{key:'2',x:0.108,y:0.024,w:0.094,h:0.183},{key:'3',x:0.203,y:0.024,w:0.095,h:0.183},{key:'4',x:0.299,y:0.024,w:0.094,h:0.183},{key:'5',x:0.394,y:0.024,w:0.093,h:0.183},{key:'6',x:0.487,y:0.024,w:0.095,h:0.183},{key:'7',x:0.583,y:0.024,w:0.093,h:0.183},{key:'8',x:0.677,y:0.024,w:0.095,h:0.183},{key:'9',x:0.772,y:0.024,w:0.093,h:0.183},{key:'0',x:0.866,y:0.024,w:0.093,h:0.183},{key:'q',x:0.014,y:0.215,w:0.094,h:0.183},{key:'w',x:0.108,y:0.215,w:0.094,h:0.183},{key:'e',x:0.203,y:0.215,w:0.095,h:0.183},{key:'r',x:0.299,y:0.215,w:0.094,h:0.183},{key:'t',x:0.394,y:0.215,w:0.093,h:0.183},{key:'y',x:0.487,y:0.215,w:0.095,h:0.183},{key:'i',x:0.677,y:0.215,w:0.095,h:0.183},{key:'u',x:0.583,y:0.215,w:0.093,h:0.183},{key:'o',x:0.772,y:0.215,w:0.093,h:0.183},{key:'p',x:0.866,y:0.215,w:0.093,h:0.183},{key:'a',x:0.063,y:0.405,w:0.094,h:0.183},{key:'s',x:0.158,y:0.405,w:0.094,h:0.183},{key:'d',x:0.253,y:0.405,w:0.095,h:0.183},{key:'f',x:0.349,y:0.405,w:0.094,h:0.183},{key:'g',x:0.443,y:0.405,w:0.093,h:0.183},{key:'h',x:0.537,y:0.405,w:0.095,h:0.183},{key:'j',x:0.633,y:0.405,w:0.092,h:0.183},{key:'k',x:0.726,y:0.405,w:0.095,h:0.183},{key:'l',x:0.821,y:0.405,w:0.093,h:0.183},{key:'z',x:0.111,y:0.598,w:0.093,h:0.181},{key:'x',x:0.205,y:0.598,w:0.095,h:0.181},{key:'c',x:0.301,y:0.598,w:0.095,h:0.181},{key:'v',x:0.396,y:0.598,w:0.093,h:0.181},{key:'b',x:0.49,y:0.598,w:0.094,h:0.181},{key:'n',x:0.585,y:0.598,w:0.094,h:0.181},{key:'m',x:0.68,y:0.598,w:0.093,h:0.181},{key:'Delete',x:0.777,y:0.598,w:0.137,h:0.181},{key:' ',x:0.297,y:0.788,w:0.381,h:0.201},{key:'Escape',x:0.013,y:0.797,w:0.137,h:0.181},{key:'Insert',x:0.014,y:-1e-3,w:0.01,h:5e-3}]}};if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var FontFactors={roboto:17,aileronsemibold:20,dejavu:20.5,exo2bold:20,exo2semibold:20.3,kelsonsans:22.8,monoid:19.5,mozillavr:9.5,sourcecodepro:20.3};AFRAME.registerComponent('super-keyboard',{schema:{align:{default:'left',oneOf:['left','center','right']},blinkingSpeed:{type:'int',default:400},filters:{type:'array'},font:{default:'aileronsemibold'},hand:{type:'selector'},imagePath:{default:'.'},injectToRaycasterObjects:{default:!0},inputColor:{type:'color',default:'#6699ff'},interval:{type:'int',default:50},keyBgColor:{type:'color',default:'#000'},keyColor:{type:'color',default:'#6699ff'},keyHoverColor:{type:'color',default:'#1A407F'},keyPressColor:{type:'color',default:'#5290F6'},label:{type:'string',default:''},labelColor:{type:'color',default:'#aaa'},maxLength:{type:'int',default:0},model:{default:'basic'},show:{default:!0},value:{type:'string',default:''},width:{default:0.8}},init:function(){this.el.addEventListener('click',this.click.bind(this)),this.changeEventDetail={},this.textInputObject={},this.keys=null,this.focused=!1,this.keyHover=null,this.prevCheckTime=null,this.shift=!1,this.rawValue=this.data.value,this.defaultValue=this.data.value,this.userFilterFunc=null,this.intervalId=0,this.kbImg=document.createElement('a-entity'),this.kbImg.classList.add('keyboardRaycastable'),this.kbImg.classList.add('superKeyboardImage'),this.kbImg.addEventListener('raycaster-intersected',this.hover.bind(this)),this.kbImg.addEventListener('raycaster-intersected-cleared',this.blur.bind(this)),this.el.appendChild(this.kbImg),this.label=document.createElement('a-entity'),this.label.setAttribute('text',{align:'center',font:this.data.font,baseline:'bottom',lineHeight:40,shader:'msdf',negate:!0,value:this.data.label,color:this.data.labelColor,width:this.data.width,wrapCount:30}),this.el.appendChild(this.label),this.textInput=document.createElement('a-entity'),this.textInput.setAttribute('mixin','superKeyboardTextInput'),this.textInput.setAttribute('text',{align:this.data.align,font:this.data.font,lineHeight:35,value:this.data.value,color:this.data.inputColor,width:this.data.width,wrapCount:20}),this.el.appendChild(this.textInput),this.cursor=document.createElement('a-entity'),this.cursor.object3D.position.set(0,0,1e-3),this.cursor.setAttribute('material',{shader:'flat',color:this.data.inputColor}),this.textInput.appendChild(this.cursor),this.cursorUpdated=!1,this.keyBgColor=new THREE.Color,this.keyHoverColor=new THREE.Color,this.keyPressColor=new THREE.Color;var self=this;document.addEventListener('keydown',function(ev){if('t'===ev.key){for(var ss='',s='abcdefghijklmopqrstuvQWIEUTGASDLIGKBXACQWETL102394676457',l=_Mathfloor6(20*Math.random()),i=0;i<l;i++)ss+=s[_Mathfloor6(Math.random()*s.length)];self.el.setAttribute('super-keyboard',{value:ss})}}),document.addEventListener('show',this.open.bind(this)),this.hand=null,this.handListenersSet=!1,this.raycaster=null},update:function(oldData){var kbdata=KEYBOARDS[this.data.model],w=this.data.width,h=this.data.width/2;if(void 0===kbdata)return void console.error('super-keyboard ERROR: model "'+this.data.model+'" undefined.');oldData&&this.defaultValue===oldData.defaultValue?this.updateTextInput(this.filter(this.rawValue)):(this.rawValue=this.data.value,this.defaultValue=this.data.value,this.updateTextInput(this.filter(this.data.value))),(this.data.width!==oldData.width||this.data.height!==oldData.height||this.data.keyColor!==oldData.keyColor)&&(this.kbImg.setAttribute('geometry',{primitive:'plane',width:w,height:h}),this.kbImg.setAttribute('material',{shader:'flat',src:this.data.imagePath+'/'+kbdata.img,color:this.data.keyColor,transparent:!0})),(this.data.label!==oldData.label||this.data.labelColor!==oldData.labelColor||this.data.width!==oldData.width)&&(this.label.setAttribute('text',{value:this.data.label,color:this.data.labelColor,width:this.data.width}),this.label.object3D.position.set(0,0.35*w,-0.02)),(this.data.width!==oldData.width||this.data.keyBgColor!==oldData.keyBgColor)&&this.initKeyColorPlane();var inputx='center'===this.data.align?0:kbdata.inputOffsetX*w;'right'===this.data.align&&(inputx*=-1),(this.data.font!==oldData.font||this.data.inputColor!==oldData.inputColor||this.data.width!==oldData.width||this.data.align!==oldData.align)&&this.textInput.setAttribute('text',{font:this.data.font,color:this.data.inputColor,width:w,wrapCount:kbdata.wrapCount,align:this.data.align});for(var i=0,kdata;i<kbdata.layout.length;i++)kdata=kbdata.layout[i],'Insert'===kdata.key&&(this.inputRect=kdata);this.textInput.object3D.position.set(inputx,w/4-(this.inputRect.y+this.inputRect.h/2)*w/2+kbdata.inputOffsetY*w,2e-3),this.data.width!==oldData.width&&this.cursor.setAttribute('geometry',{primitive:'plane',width:0.03*w,height:0.01*w}),this.updateCursorPosition(),this.setupHand(),this.keyBgColor.set(this.data.keyBgColor),this.keyHoverColor.set(this.data.keyHoverColor),this.keyPressColor.set(this.data.keyPressColor),this.data.show?this.open():this.close()},tick:function(time){var intersection;if(!(this.prevCheckTime&&time-this.prevCheckTime<this.data.interval)){if(!this.prevCheckTime)return void(this.prevCheckTime=time);if(this.raycaster&&this.focused&&(intersection=this.raycaster.getIntersection(this.kbImg),!!intersection))for(var uv=intersection.uv,keys=KEYBOARDS[this.data.model].layout,i=0,k;i<keys.length;i++)if(k=keys[i],uv.x>k.x&&uv.x<k.x+k.w&&1-uv.y>k.y&&1-uv.y<k.y+k.h){this.keyHover!==k&&(this.keyHover=k,this.updateKeyColorPlane(this.keyHover.key,this.keyHoverColor));break}}},play:function(){this.cursorUpdated&&this.startBlinking()},pause:function(){this.stopBlinking()},initKeyColorPlane:function(){var kbdata=KEYBOARDS[this.data.model],keyColorPlane=this.keyColorPlane=document.createElement('a-entity');keyColorPlane.classList.add('superKeyboardKeyColorPlane'),keyColorPlane.object3D.position.z=1e-3,keyColorPlane.object3D.visible=!1,keyColorPlane.setAttribute('geometry',{primitive:'plane',buffer:!1}),keyColorPlane.setAttribute('material',{shader:'flat',color:this.data.keyBgColor,transparent:!0}),kbdata.hoverImg&&keyColorPlane.setAttribute('material',{src:this.data.imagePath+'/'+kbdata.hoverImg}),keyColorPlane.addEventListener('componentinitialized',function(evt){'material'===evt.detail.name&&(kbdata.hoverImg||(this.getObject3D('mesh').material.blending=THREE.AdditiveBlending))}),this.el.appendChild(keyColorPlane)},updateKeyColorPlane:function(key,color){var kbdata=KEYBOARDS[this.data.model],keyColorPlane=this.keyColorPlane;if(!key)return void(keyColorPlane.object3D.visible=!1);for(var i=0,kdata;i<kbdata.layout.length;i++)if(kdata=kbdata.layout[i],kdata.key===key){var w=this.data.width,h=this.data.width/2,keyw=kdata.w*w,keyh=kdata.h*h;keyColorPlane.object3D.scale.x=keyw,keyColorPlane.object3D.scale.y=keyh,keyColorPlane.object3D.position.x=kdata.x*w-w/2+keyw/2,keyColorPlane.object3D.position.y=(1-kdata.y)*h-h/2-keyh/2,keyColorPlane.getObject3D('mesh').material.color.copy(color);var geometry=keyColorPlane.getObject3D('mesh').geometry,uvSet=geometry.faceVertexUvs[0],kdataY=1-kdata.y;uvSet[0][0].set(kdata.x,kdataY),uvSet[0][1].set(kdata.x,kdataY-kdata.h),uvSet[0][2].set(kdata.x+kdata.w,kdataY),uvSet[1][0].set(kdata.x,kdataY-kdata.h),uvSet[1][1].set(kdata.x+kdata.w,kdataY-kdata.h),uvSet[1][2].set(kdata.x+kdata.w,kdataY),geometry.uvsNeedUpdate=!0;break}keyColorPlane.object3D.visible=!0},setupHand:function(){if(this.hand&&this.hand.ownRaycaster&&this.hand.removeAttribute('raycaster'),this.hand=this.data.hand?this.data.hand:document.querySelector(['[cursor]','[vive-controls]','[tracked-controls]','[oculus-touch-controls]','[windows-motion-controls]','[hand-controls]','[daydream-controls] [cursor] > [raycaster]'].join(',')),!this.hand)console.error('super-keyboard: no controller found. Add <a-entity> with controller or specify with super-keyboard="hand: #selectorToController".');else{if(!this.hand.hasLoaded)return void this.hand.addEventListener('loaded',this.setupHand.bind(this));var raycaster=this.hand.components.raycaster,params={};if(!raycaster)this.hand.ownRaycaster=!0,params.showLine=this.data.show,params.enabled=this.data.show,this.data.injectToRaycasterObjects&&(params.objects='.keyboardRaycastable'),this.hand.setAttribute('raycaster',params);else if(this.hand.ownRaycaster=!1,this.data.injectToRaycasterObjects){var objs=raycaster.data.objects.split(',');-1===objs.indexOf('.keyboardRaycastable')&&objs.push('.keyboardRaycastable'),params.objects=objs.join(',').replace(/^,/,''),this.hand.setAttribute('raycaster',params)}this.raycaster=this.hand.components.raycaster}},filter:function(str){if(''===str)return'';for(var i=0;i<this.data.filters.length;i++)switch(this.data.filters[i]){case'custom':{this.userFilterFunc&&(str=this.userFilterFunc(str));break}case'allupper':{str=str.toUpperCase();break}case'alllower':{str=str.toLowerCase();break}case'title':{str=str.split(' ').map(function(s){return s[0].toUpperCase()+s.substr(1)}).join(' ');break}case'numbers':{str=str.split('').filter(function(c){return!isNaN(parseInt(c))||'.'===c}).join('');break}case'first':{str=str[0].toUpperCase()+str.substr(1);break}case'trim':{str=str.trim();break}}return 0<this.data.maxLength?str.substr(0,this.data.maxLength):str},click:function(){if(this.keyHover){switch(this.keyHover.key){case'Enter':{this.accept();break}case'Insert':return;case'Delete':{this.rawValue=this.rawValue.substr(0,this.rawValue.length-1);var newValue=this.filter(this.rawValue);this.el.setAttribute('super-keyboard','value',newValue),this.updateTextInput(newValue),this.changeEventDetail.value=newValue,this.el.emit('superkeyboardchange',this.changeEventDetail);break}case'Shift':{this.shift=!this.shift,this.keyHover.el.setAttribute('material','color',this.shift?this.data.keyHoverColor:this.data.keyBgColor);break}case'Escape':{this.dismiss();break}default:{if(0<this.data.maxLength&&this.rawValue.length>this.data.maxLength)break;this.rawValue+=this.shift?this.keyHover.key.toUpperCase():this.keyHover.key;var newValue=this.filter(this.rawValue);this.el.setAttribute('super-keyboard','value',newValue),this.updateTextInput(newValue),this.changeEventDetail.value=newValue,this.el.emit('superkeyboardchange',this.changeEventDetail);break}}this.updateKeyColorPlane(this.keyHover.key,this.keyPressColor);var self=this;setTimeout(function(){self.updateKeyColorPlane(self.keyHover.key,self.keyHoverColor)},100),this.updateCursorPosition()}},open:function(){this.el.object3D.visible=!0,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!0,enabled:!0})},close:function(){this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!1,enabled:!1})},accept:function(){this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!1,enabled:!1}),this.el.emit('superkeyboardinput',{value:this.data.value}),this.data.show=!1},dismiss:function(){this.data.value=this.defaultValue,this.updateTextInput(),this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!1,enabled:!1}),this.el.emit('superkeyboarddismiss'),this.data.show=!1},blur:function(){this.focused=!1,this.keyHover&&'Shift'!==this.keyHover.key&&this.updateKeyColorPlane(this.keyHover.key,this.keyBgColor),this.keyHover=null},hover:function(){this.focused=!0},startBlinking:function(){this.stopBlinking(),this.intervalId=window.setInterval(this.blink.bind(this),this.data.blinkingSpeed)},stopBlinking:function(){window.clearInterval(this.intervalId),this.intervalId=0},blink:function(){this.cursor.object3D.visible=!this.cursor.object3D.visible},setCustomFilter:function(f){this.userFilterFunc=f},addCustomModel:function(name,model){name&&(KEYBOARDS[name]=model)},updateCursorPosition:function(){var font=this.textInput.components.text.currentFont;if(!font){var self=this;return this.cursor.object3D.visible=!1,void window.setTimeout(function(){self.updateCursorPosition(),self.startBlinking()},700)}var w=this.data.width,kbdata=KEYBOARDS[this.data.model],posy=-this.inputRect.h/2*w/2.4+kbdata.inputOffsetY*w,ratio=this.data.width/this.textInput.components.text.data.wrapCount,pos=0,fontFactor=FontFactors[this.textInput.components.text.data.font];fontFactor===void 0&&(fontFactor=20);for(var i=0,char;i<this.data.value.length;i++)char=findFontChar(font.chars,this.data.value.charCodeAt(i)),pos+=char.width+char.xadvance*(32===char.id?2:1);'center'===this.data.align?pos=0.0011*(pos*ratio*fontFactor)/2+0.02*w:'left'===this.data.align?(pos=0.0011*(pos*ratio*fontFactor)+0.02*w,pos-=w/2):'right'===this.data.align&&(pos=0.0011*(-pos*ratio*fontFactor)-0.02*w,pos+=w/2),this.cursor.object3D.position.set(pos,posy,1e-3),this.cursorUpdated=!0},updateTextInput:function(value){this.textInputObject.value=value||this.data.value,this.textInput.setAttribute('text',this.textInputObject)}})},function(){AFRAME.registerShader('superCutFxShader',{schema:{startTime:{type:'float',is:'uniform'},timems:{type:'time',is:'uniform'}},vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
  `,fragmentShader:`
    uniform float startTime;
    uniform float timems;
    varying vec2 uvs;
    varying vec3 worldPos;

    #define COLOR vec3(0, 0.67, 0.98)

    void main() {
      float time = (timems - startTime) / 2000.0;
      vec2 p = uvs.xy - 0.5;
      float r = p.x * p.x + p.y * p.y;
      float alpha = 1.0 - smoothstep(time - 0.01, time, r);
      alpha *= smoothstep(time - 0.1, time, r);
      alpha *= 1.0 - time * 5.5;
      gl_FragColor = vec4(COLOR, alpha);
    }
  `})},function(){AFRAME.registerComponent('supercutfx',{init:function(){this.startTime=-1100},createSuperCut:function(position){const mesh=this.el.getObject3D('mesh');this.el.object3D.position.copy(position),this.el.object3D.position.z=-1,this.el.object3D.visible=!0,this.startTime=this.el.sceneEl.time,mesh.material.uniforms.startTime.value=this.startTime-50,this.el.play()},tick:function(time){time>this.startTime+1e3&&(this.el.object3D.visible=!1,this.el.pause())}})},function(){AFRAME.registerComponent('text-counter',{dependencies:['text'],schema:{decimals:{default:0},dur:{default:2e3,type:'int'},enabled:{default:!1},emit:{default:!1},prefix:{default:''},suffix:{default:''},value:{default:0,type:'float'}},init:function(){this.currentValue=0,this.hasCompleted=!1,this.textValue={value:''}},update:function(){this.currentValue=0,this.textValue.value=`${this.data.prefix}${this.decimals(0)}${this.data.suffix}`,this.el.setAttribute('text',this.textValue),this.hasCompleted=!1},tick:function(time,timeDelta){!this.data.enabled||this.hasCompleted||(this.currentValue+=this.data.value*(timeDelta/this.data.dur),this.currentValue>=this.data.value&&(this.currentValue=this.data.value,this.data.emit&&this.el.emit('textcounterdone',null,!1),this.hasCompleted=!0),this.textValue.value=`${this.data.prefix}${this.decimals(this.currentValue)}${this.data.suffix}`,this.el.setAttribute('text',this.textValue))},decimals:function(n){var d=Math.pow(10,this.data.decimals);return(parseInt(n*d)/d).toFixed(this.data.decimals)}})},function(){AFRAME.registerComponent('text-uppercase',{schema:{value:{type:'string'}},update:function(){this.el.setAttribute('text','value',this.data.value.toUpperCase())}})},function(){AFRAME.registerComponent('toggle-pause-play',{schema:{isPlaying:{default:!1}},update:function(){const action=this.data.isPlaying?'pause':'play';parent.postMessage(JSON.stringify({verify:'game-action',action}),'*')}})},function(){AFRAME.registerComponent('trail',{schema:{color:{type:'color'},enabled:{default:!1},hand:{type:'string'}},init:function(){var geometry=this.geometry=new THREE.BufferGeometry,maxPoints=this.maxPoints=12,vertices=this.vertices=new Float32Array(36*maxPoints),colors=this.colors=new Float32Array(48*maxPoints),bladeColor=this.bladeColor=new THREE.Color(this.data.color);this.bladeColor={red:bladeColor.r,green:bladeColor.g,blue:bladeColor.b,alpha:1},this.saberEl=this.el.querySelector('.blade'),this.layers=0,this.saberTrajectory=[{top:new THREE.Vector3(-0.5,0,0),center:new THREE.Vector3(0,0,0),bottom:new THREE.Vector3(0.5,0,0)},{top:new THREE.Vector3(-0.5,0.5,0),center:new THREE.Vector3(0,0.5,0),bottom:new THREE.Vector3(0.5,0.5,0)},{top:new THREE.Vector3(-0.5,1,0),center:new THREE.Vector3(0,1,0),bottom:new THREE.Vector3(0.5,1,0)}],geometry.addAttribute('position',new THREE.BufferAttribute(vertices,3).setDynamic(!0)),geometry.addAttribute('vertexColor',new THREE.BufferAttribute(colors,4).setDynamic(!0));const material=new THREE.ShaderMaterial({side:THREE.DoubleSide,vertexColors:THREE.VertexColors,transparent:!0,blending:THREE.AdditiveBlending,vertexShader:['varying vec4 vColor;','attribute vec4 vertexColor;','void main() {','vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);','vColor = vertexColor;','gl_Position = projectionMatrix * modelViewPosition;','}'].join(''),fragmentShader:['varying vec4 vColor;','void main() {','gl_FragColor = vColor;','}'].join('')}),mesh=this.mesh=new THREE.Mesh(geometry,material);mesh.frustumCulled=!1,mesh.vertices=vertices,this.el.sceneEl.setObject3D(`trail__${this.data.hand}`,mesh)},update:function(oldData){!oldData.enabled&&this.data.enabled&&(this.enabledTime=this.el.sceneEl.time,this.mesh.visible=!1),oldData.enabled&&!this.data.enabled&&(this.mesh.visible=!1)},tock:function(time){this.data.enabled&&(!this.mesh.visible&&time>this.enabledTime+250&&(this.mesh.visible=!0),this.sampleSaberPosition())},addLayer:function(length){var startX=-1,segments=this.segments,dx=2/segments,colors=this.colors,vertices=this.vertices,color=this.bladeColor;this.layers>=this.maxLayers&&(this.layers=0);const bottomLayer=this.layers*length;length=bottomLayer+length;const indexOffset=18*(this.layers*segments),colorOffset=24*(this.layers*segments);for(var i=0;i<segments;++i)vertices[indexOffset+18*i]=startX+i*dx,vertices[indexOffset+18*i+1]=bottomLayer,vertices[indexOffset+18*i+2]=0,colors[colorOffset+24*i]=color.red,colors[colorOffset+24*i+1]=color.green,colors[colorOffset+24*i+2]=color.blue,colors[colorOffset+24*i+3]=color.alpha,vertices[indexOffset+18*i+3]=startX+i*dx,vertices[indexOffset+18*i+4]=length,vertices[indexOffset+18*i+5]=0,colors[colorOffset+24*i+4]=color.red,colors[colorOffset+24*i+5]=color.green,colors[colorOffset+24*i+6]=color.blue,colors[colorOffset+24*i+7]=color.alpha,vertices[indexOffset+18*i+6]=startX+i*dx+dx,vertices[indexOffset+18*i+7]=length,vertices[indexOffset+18*i+8]=0,colors[colorOffset+24*i+8]=color.red,colors[colorOffset+24*i+9]=color.green,colors[colorOffset+24*i+10]=color.blue,colors[colorOffset+24*i+11]=color.alpha,vertices[indexOffset+18*i+9]=startX+i*dx+dx,vertices[indexOffset+18*i+10]=bottomLayer,vertices[indexOffset+18*i+11]=0,colors[colorOffset+24*i+12]=color.red,colors[colorOffset+24*i+13]=color.green,colors[colorOffset+24*i+14]=color.blue,colors[colorOffset+24*i+15]=color.alpha,vertices[indexOffset+18*i+12]=startX+i*dx,vertices[indexOffset+18*i+13]=bottomLayer,vertices[indexOffset+18*i+14]=0,colors[colorOffset+24*i+16]=color.red,colors[colorOffset+24*i+17]=color.green,colors[colorOffset+24*i+18]=color.blue,colors[colorOffset+24*i+19]=color.alpha,vertices[indexOffset+18*i+15]=startX+i*dx+dx,vertices[indexOffset+18*i+16]=length,vertices[indexOffset+18*i+17]=0,colors[colorOffset+24*i+20]=color.red,colors[colorOffset+24*i+21]=color.green,colors[colorOffset+24*i+22]=color.blue,colors[colorOffset+24*i+23]=color.alpha;this.layers++,this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.vertexColor.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0},initGeometry:function(){var saberTrajectory=this.saberTrajectory,vertices=this.geometry.attributes.position.array,colors=this.geometry.attributes.vertexColor.array,color=this.bladeColor,i,previousPoint,currentPoint,alpha,previousAlpha;for(i=1;i<saberTrajectory.length;i++)1===i&&(previousAlpha=alpha),alpha=1-(saberTrajectory.length-i)/saberTrajectory.length,currentPoint=saberTrajectory[i],previousPoint=saberTrajectory[i-1],vertices[36*i]=previousPoint.center.x,vertices[36*i+1]=previousPoint.center.y,vertices[36*i+2]=previousPoint.center.z,colors[48*i]=color.red,colors[48*i+1]=color.green,colors[48*i+2]=color.blue,colors[48*i+3]=0.2*previousAlpha,vertices[36*i+3]=currentPoint.top.x,vertices[36*i+4]=currentPoint.top.y,vertices[36*i+5]=currentPoint.top.z,colors[48*i+4]=color.red,colors[48*i+5]=color.green,colors[48*i+6]=color.blue,colors[48*i+7]=alpha,vertices[36*i+6]=previousPoint.top.x,vertices[36*i+7]=previousPoint.top.y,vertices[36*i+8]=previousPoint.top.z,colors[48*i+8]=color.red,colors[48*i+9]=color.green,colors[48*i+10]=color.blue,colors[48*i+11]=previousAlpha,vertices[36*i+9]=previousPoint.center.x,vertices[36*i+10]=previousPoint.center.y,vertices[36*i+11]=previousPoint.center.z,colors[48*i+12]=color.red,colors[48*i+13]=color.green,colors[48*i+14]=color.blue,colors[48*i+15]=0.2*previousAlpha,vertices[36*i+12]=currentPoint.center.x,vertices[36*i+13]=currentPoint.center.y,vertices[36*i+14]=currentPoint.center.z,colors[48*i+16]=color.red,colors[48*i+17]=color.green,colors[48*i+18]=color.blue,colors[48*i+19]=0.2*alpha,vertices[36*i+15]=currentPoint.top.x,vertices[36*i+16]=currentPoint.top.y,vertices[36*i+17]=currentPoint.top.z,colors[48*i+20]=color.red,colors[48*i+21]=color.green,colors[48*i+22]=color.blue,colors[48*i+23]=alpha,vertices[36*i+18]=previousPoint.bottom.x,vertices[36*i+19]=previousPoint.bottom.y,vertices[36*i+20]=previousPoint.bottom.z,colors[48*i+24]=color.red,colors[48*i+25]=color.green,colors[48*i+26]=color.blue,colors[48*i+27]=0,vertices[36*i+21]=currentPoint.center.x,vertices[36*i+22]=currentPoint.center.y,vertices[36*i+23]=currentPoint.center.z,colors[48*i+28]=color.red,colors[48*i+29]=color.green,colors[48*i+30]=color.blue,colors[48*i+31]=0.2*alpha,vertices[36*i+24]=previousPoint.center.x,vertices[36*i+25]=previousPoint.center.y,vertices[36*i+26]=previousPoint.center.z,colors[48*i+32]=color.red,colors[48*i+33]=color.green,colors[48*i+34]=color.blue,colors[48*i+35]=0.2*previousAlpha,vertices[36*i+27]=previousPoint.bottom.x,vertices[36*i+28]=previousPoint.bottom.y,vertices[36*i+29]=previousPoint.bottom.z,colors[48*i+36]=color.red,colors[48*i+37]=color.green,colors[48*i+38]=color.blue,colors[48*i+39]=0,vertices[36*i+30]=currentPoint.bottom.x,vertices[36*i+31]=currentPoint.bottom.y,vertices[36*i+32]=currentPoint.bottom.z,colors[48*i+40]=color.red,colors[48*i+41]=color.green,colors[48*i+42]=color.blue,colors[48*i+43]=0,vertices[36*i+33]=currentPoint.center.x,vertices[36*i+34]=currentPoint.center.y,vertices[36*i+35]=currentPoint.center.z,colors[48*i+44]=color.red,colors[48*i+45]=color.green,colors[48*i+46]=color.blue,colors[48*i+47]=0.2*alpha,previousAlpha=alpha;this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.vertexColor.needsUpdate=!0},sampleSaberPosition:function(){var saberEl=this.saberEl,saberObject,sample;this.saberTrajectory.length===this.maxPoints?(sample=this.saberTrajectory.shift(),sample.top.set(0,-0.4,0),sample.center.set(0,0,0),sample.bottom.set(0,0.4,0)):sample={top:new THREE.Vector3(0,-0.4,0),center:new THREE.Vector3(0,0,0),bottom:new THREE.Vector3(0,0.4,0)},saberObject=saberEl.object3D,saberObject.parent.updateMatrixWorld(),saberObject.localToWorld(sample.top),saberObject.localToWorld(sample.center),saberObject.localToWorld(sample.bottom),this.saberTrajectory.push(sample),this.initGeometry()}})},function(){AFRAME.registerComponent('tutorial-2d',{init:function(){this.el.sceneEl.canvas.style.display='none'},play:function(){this.el.sceneEl.canvas.style.display='block',document.getElementById('tutorial2d').style.display='none'}})},function(){var _Mathabs=Math.abs;const NUM_VALUES_PER_SEGMENT=75;AFRAME.registerComponent('twister',{schema:{enabled:{default:!1},twist:{default:0},vertices:{default:4,type:'int'},count:{default:12,type:'int'},positionIncrement:{default:1.4},radiusIncrement:{default:0.4},thickness:{default:0.37}},init:function(){this.currentTwist=0,this.animate=!1,this.geometry=null},pulse:function(twist){this.data.enabled&&(twist=0==twist?0.03+0.25*Math.random():Math.min(0.4*twist,0.4),twist*=0.5>Math.random()?-1:1,this.el.setAttribute('twister',{twist:twist}))},update:function(){var radius=6,segments=[];if(1e-3<_Mathabs(this.data.twist-this.currentTwist))return void(this.animate=!0);this.clear();for(var i=0;i<this.data.count;i++){let segment=this.createSegment(radius);segment.translate(0,this.data.positionIncrement*i,0),segments.push(segment),radius+=this.data.radiusIncrement}this.geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(segments);var material=this.el.sceneEl.systems.materials.stageNormal,mesh=new THREE.Mesh(this.geometry,material);this.el.object3D.add(mesh)},createSegment:function(radius){const R=this.data.thickness;var points=[new THREE.Vector2(radius-R,R),new THREE.Vector2(radius-R,-R),new THREE.Vector2(radius+R,-R),new THREE.Vector2(radius+R,R),new THREE.Vector2(radius-R,R)],geometry;geometry=new THREE.LatheBufferGeometry(points,this.data.vertices);for(let i=0;i<geometry.attributes.uv.array.length;i+=2)geometry.attributes.uv.array[i]=0.77,geometry.attributes.uv.array[i+1]=1e-3;return geometry},clear:function(){this.el.object3D.remove(this.el.object3D.children[0]),this.geometry&&this.geometry.dispose(),this.geometry=new THREE.BufferGeometry},tick:function(time,delta){if(this.animate){var posArray=this.geometry.attributes.position.array,rotation,x,y,sin,cos,diff;delta*=1e-3,diff=(this.data.twist-this.currentTwist)*delta,this.currentTwist+=diff,rotation=3*diff;for(var s=0;s<this.data.count;s++){for(var i=0;i<NUM_VALUES_PER_SEGMENT;i+=3)cos=Math.cos(rotation),sin=Math.sin(rotation),x=posArray[s*NUM_VALUES_PER_SEGMENT+i],y=posArray[s*NUM_VALUES_PER_SEGMENT+i+2],posArray[s*NUM_VALUES_PER_SEGMENT+i]=x*cos-y*sin,posArray[s*NUM_VALUES_PER_SEGMENT+i+2]=y*cos+x*sin;rotation*=1.05}this.geometry.attributes.position.needsUpdate=!0,1e-3>_Mathabs(this.data.twist-this.currentTwist)&&(this.animate=!1)}}})},function(){var colorHelper=new THREE.Color;AFRAME.registerComponent('vertex-colors-buffer',{schema:{baseColor:{type:'color'},itemSize:{default:3}},update:function(oldData){var data=this.data,el=this.el,self=this,colors,i,geometry,mesh;if(mesh=this.el.getObject3D('mesh'),!mesh||!mesh.geometry)return void el.addEventListener('object3dset',function reUpdate(evt){'mesh'!==evt.detail.type||(el.removeEventListener('object3dset',reUpdate),self.update(oldData))});if(geometry=mesh.geometry,!geometry.attributes.position)return void console.warn('Geometry has no vertices',el);for(geometry.attributes.color||geometry.addAttribute('color',new THREE.BufferAttribute(new Float32Array(geometry.attributes.position.array.length),3)),colors=geometry.attributes.color.array,colorHelper.set(data.baseColor),i=0;i<colors.length;i+=data.itemSize)colors[i]=colorHelper.r,colors[i+1]=colorHelper.g,colors[i+2]=colorHelper.b;geometry.attributes.color.needsUpdate=!0}})},function(){AFRAME.registerComponent('victory-accuracy-ring',{dependencies:['geometry','material'],schema:{accuracy:{default:0}},update:function(){this.el.getObject3D('mesh').material.uniforms.progress.value=0,this.el.setAttribute('animation','to',this.data.accuracy/100),this.el.components.animation.beginAnimation()}})},function(){AFRAME.registerComponent('victory-rank',{schema:{rank:{type:'string'}},update:function(){const rank=this.data.rank;if(rank)switch(this.el.setAttribute('text','value',rank),rank[0]){case'S':{this.setColor('#FFF');break}case'A':{this.setColor('#c2d076');break}case'B':{this.setColor('#23f0c7');break}case'C':{this.setColor('#ffe347');break}case'D':{this.setColor('#ce6c47');break}case'F':{this.setColor('#960200');break}}},setColor:function(color){this.el.setAttribute('text','color',color)}})},function(){AFRAME.registerComponent('visible-raycastable',{schema:{default:!0},update:function(){this.el.object3D.visible=this.data,this.data?this.el.setAttribute('raycastable',''):this.el.removeAttribute('raycastable','')}})},function(module,exports,__webpack_require__){const COLORS=__webpack_require__(6),WALL_COLOR=new THREE.Color(COLORS.NEON_RED),WALL_BG=new THREE.Color(COLORS.SKY_RED);AFRAME.registerShader('wallShader',{schema:{iTime:{type:'time',is:'uniform'},hitRight:{type:'vec3',is:'uniform',default:{x:0,y:1,z:0}},hitLeft:{type:'vec3',is:'uniform',default:{x:0,y:0,z:0}}},vertexShader:`
    varying vec2 uvs;
    varying vec3 nrml;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      nrml.xyz = normal.xyz;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    varying vec2 uvs;
    varying vec3 nrml;
    varying vec3 worldPos;
    uniform float iTime;
    //uniform sampler2D env;
    uniform vec3 hitRight;
    uniform vec3 hitLeft;

    #define SEED 19.1254
    #define time (3.0 + iTime)/1000.0 * 0.15

    float noise(vec3 uv) {
      return fract(sin(uv.x*123243. + uv.y*424. + uv.z*642. + SEED) * 1524.);
    }

    vec3 drawCircle(vec3 p, vec3 center, float radius, float edgeWidth, vec3 color) {
      return color * (1.0 - smoothstep(radius, radius + edgeWidth, length(p - center)));
    }

    float smoothNoise(vec3 uvw, float frec){
      vec3 luvw = vec3(smoothstep(0.0, 1.0, fract(uvw.xy * frec)), fract(uvw.z * frec));
      vec3 id = floor(uvw * frec);
      float blt = noise(id);
      float brt = noise(id + vec3(1.0, 0.0, 0.0));
      float tlt = noise(id + vec3(0.0, 1.0, 0.0));
      float trt = noise(id + vec3(1.0, 1.0, 0.0));

      float blb = noise(id + vec3(0.0, 0.0, 1.0));
      float brb = noise(id + vec3(1.0, 0.0, 1.0));
      float tlb = noise(id + vec3(0.0, 1.0, 1.0));
      float trb = noise(id + vec3(1.0, 1.0, 1.0));

      float a = mix(blt, brt, luvw.x);
      float b = mix(tlt, trt, luvw.x);
      float c = mix(a, b, luvw.y);

      float d = mix(blb, brb, luvw.x);
      float e = mix(tlb, trb, luvw.x);
      float f = mix(d, e, luvw.y);

      return mix(c, f, luvw.z);
    }

    #define WALL_COLOR vec3(${WALL_COLOR.r}, ${WALL_COLOR.g}, ${WALL_COLOR.b})
    #define WALL_BG vec3(${WALL_BG.r}, ${WALL_BG.g}, ${WALL_BG.b})

    void main() {
      vec2 uv1 = uvs.xy-0.5;
      float angle = time / 10.0;
      vec2 uv;
      uv.x = uv1.x * cos(angle) - uv1.y * sin(angle);
      uv.y = uv1.y * cos(angle) + uv1.x * sin(angle);
      uv.x += sin(uv.y * 2.7 + time / 1.7) * 0.2;
      uv.y += sin(uv.x * 3.1 + time / 2.4) * 0.3;

      float w, r, bg;
      r = smoothNoise(vec3(uv + worldPos.x, time / 2.0), 3.0) * 0.65;
      r += smoothNoise(vec3(uv, time / 6.0), 8.0) * 0.3;
      r += smoothNoise(vec3(uv, time / 14.0), 50.0) * 0.04;

      bg = smoothstep(0.5, 1.0, r) + smoothstep(0.5, 0.0, r);
      r = smoothstep(0.4, 0.50, r) - smoothstep(0.50, 0.6, r);
      w = smoothstep(0.97, 1.0, r);


      r += smoothstep(0.44, 0.50, abs(uv1.x));
      r += smoothstep(0.44, 0.50, abs(uv1.y));

      w += smoothstep(0.49, 0.498, abs(uv1.x));
      w += smoothstep(0.49, 0.498, abs(uv1.y));

      w *= 0.9;
      bg *= 0.5;

      vec3 COL = WALL_COLOR;
      vec3 BG = WALL_BG * 0.1;

      vec3 col = vec3(r * COL.r + w + BG.r, r * COL.g + w + BG.g, r * COL.b + w + BG.b);

      vec3 hit;
      hit = drawCircle(worldPos, hitRight, 0.04, 0.05, COL);
      hit += drawCircle(worldPos, hitRight, 0.02, 0.03, vec3(0.7, 0.7, 0.7));
      hit += drawCircle(worldPos, hitLeft, 0.04, 0.05, COL);
      hit += drawCircle(worldPos, hitLeft, 0.02, 0.03, vec3(0.7, 0.7, 0.7));

      gl_FragColor = vec4(col + hit, 0.7 + w + hit.x);
    }
`})},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__constants_beat__=__webpack_require__(10);const CEILING_THICKNESS=1.5;AFRAME.registerComponent('wall',{schema:{anticipationPosition:{default:0},durationSeconds:{default:0},height:{default:1.3},horizontalPosition:{default:'middleleft',oneOf:['left','middleleft','middleright','right']},isCeiling:{default:!1},speed:{default:1},warmupPosition:{default:0},width:{default:1}},horizontalPositions:{left:-0.75,middleleft:-0.25,middleright:0.25,right:0.75},init:function(){this.maxZ=10},update:function(){const el=this.el,data=this.data,width=data.width*0.5,halfDepth=data.durationSeconds*data.speed/2;return data.isCeiling?(el.object3D.position.set(0,1.4+CEILING_THICKNESS/2,data.anticipationPosition+data.warmupPosition-halfDepth),void el.object3D.scale.set(width,CEILING_THICKNESS,data.durationSeconds*data.speed)):void(el.object3D.position.set(this.horizontalPositions[data.horizontalPosition]+width/2-0.25,data.height+0.1,data.anticipationPosition+data.warmupPosition-halfDepth),el.object3D.scale.set(width,2.5,data.durationSeconds*data.speed))},pause:function(){this.el.object3D.visible=!1,this.el.removeAttribute('data-collidable-head')},play:function(){this.el.object3D.visible=!0,this.el.setAttribute('data-collidable-head',''),this.el.setAttribute('data-saber-particles',''),this.el.setAttribute('raycastable-game','')},tock:function(time,timeDelta){const data=this.data,halfDepth=data.durationSeconds*data.speed/2,position=this.el.object3D.position;if(position.z<data.anticipationPosition-halfDepth){let newPositionZ=position.z+__WEBPACK_IMPORTED_MODULE_0__constants_beat__.a*(timeDelta/1e3);position.z=newPositionZ<data.anticipationPosition-halfDepth?newPositionZ:data.anticipationPosition-halfDepth}else position.z+=this.data.speed*(timeDelta/1e3);return this.el.object3D.position.z>this.maxZ+halfDepth?void this.returnToPool():void 0},returnToPool:function(){this.el.sceneEl.components.pool__wall.returnEntity(this.el),this.el.object3D.position.z=9999,this.el.pause(),this.el.removeAttribute('data-collidable-head'),this.el.removeAttribute('raycastable-game')}})},function(module){module.exports=[{name:'Pop',row:1,column:1},{name:'R&B',row:1,column:2},{name:'Rap',row:1,column:3},{name:'Rock',row:1,column:4},{name:'Soundtrack',row:1,column:5},{name:'Video Games',row:1,column:6},{name:'Electronic',row:2,column:1},{name:'Hip Hop',row:2,column:2},{name:'House',row:2,column:3},{name:'J-Pop',row:2,column:4},{name:'K-Pop',row:2,column:5},{name:'Meme',row:2,column:6},{name:'Alternative',row:3,column:1},{name:'Anime',row:3,column:2},{name:'Comedy',row:3,column:3},{name:'Disney',row:3,column:4},{name:'Dubstep',row:3,column:5},{name:'EDM',row:3,column:6}]},function(module,exports,__webpack_require__){function requireAll(req){req.keys().forEach(req)}__webpack_require__(12),__webpack_require__(20),__webpack_require__(11),__webpack_require__(21),__webpack_require__(22),__webpack_require__(23),__webpack_require__(24),__webpack_require__(25),__webpack_require__(26),__webpack_require__(27),__webpack_require__(28),__webpack_require__(30),__webpack_require__(29),__webpack_require__(31),requireAll(__webpack_require__(33)),requireAll(__webpack_require__(34)),__webpack_require__(32)},function(module){module.exports=function SoundPool(src,volume){var currSound=0,pool=[],sound;return sound=new Audio(src),sound.volume=volume,pool.push(sound),{play:function(){0===pool[currSound].currentTime&&pool[currSound].ended||(sound=new Audio(src),sound.volume=volume,pool.push(sound),currSound++),(0===pool[currSound].currentTime||pool[currSound].ended)&&pool[currSound].play(),currSound=(currSound+1)%pool.length}}}},function(module,exports,__webpack_require__){function computeSearchPagination(state){let numPages=_Mathceil(state.search.results.length/SEARCH_PER_PAGE);state.search.hasPrev=0<state.search.page,state.search.hasNext=state.search.page<numPages-1,state.search.songNameTexts='',state.search.songSubNameTexts='',state.searchResultsPage.length=0,state.searchResultsPage.__dirty=!0;for(let i=state.search.page*SEARCH_PER_PAGE;i<state.search.page*SEARCH_PER_PAGE+SEARCH_PER_PAGE&&!!state.search.results[i];i++)state.searchResultsPage.push(state.search.results[i]),state.search.songNameTexts+=truncate(state.search.results[i].songName,SONG_NAME_TRUNCATE).toUpperCase()+'\n',state.search.songSubNameTexts+=truncate(state.search.results[i].songSubName,SONG_SUB_NAME_TRUNCATE)+'\n';for(let i=0;i<state.searchResultsPage.length;i++)state.searchResultsPage[i].index=i;computeMenuSelectedChallengeIndex(state)}function truncate(str,length){return str?str.length>=length?str.substring(0,length-3)+'...':str:''}function difficultyComparator(a,b){const aIndex=DIFFICULTIES.indexOf(a),bIndex=DIFFICULTIES.indexOf(b);return aIndex<bIndex?-1:aIndex>bIndex?1:0}function takeDamage(state){state.isPlaying&&(state.score.combo=0,state.score.multiplier=1<state.score.multiplier?_Mathceil(state.score.multiplier/2):1,AFRAME.utils.getUrlParameter('godmode')||(state.damage++,checkGameOver(state)))}function checkGameOver(state){state.damage>=DAMAGE_MAX&&(state.damage=0,state.isGameOver=!0)}function resetScore(state){state.damage=0,state.score.beatsHit=0,state.score.beatsMissed=0,state.score.combo=0,state.score.maxCombo=0,state.score.score=0,state.score.multiplier=1}function computeMenuSelectedChallengeIndex(state){state.menuSelectedChallenge.index=-1;for(let i=0;i<state.searchResultsPage.length;i++)if(state.searchResultsPage[i].id===state.menuSelectedChallenge.id){state.menuSelectedChallenge.index=i;break}}function formatSongLength(songLength){songLength/=60;const minutes=`${_Mathfloor7(songLength)}`;return`${minutes}:${Math.round(60*(songLength-minutes))}`}function computeBeatsText(state){state.score.beatsText=`${state.score.beatsHit} / ${state.score.beatsMissed+state.score.beatsHit} BEATS`}function clearLeaderboard(state){state.leaderboard.length=0,state.leaderboard.__dirty=!0,state.leaderboardNames='',state.leaderboardScores='',state.leaderboardFetched=!1}function updateMenuSongInfo(state,challenge){state.menuSelectedChallenge.songInfoText=`By ${truncate(challenge.author,12)} ${challenge.genre&&'Uncategorized'!==challenge.genre?'/ '+challenge.genre:''}\n${challenge.downloads} Downloads\nUpvotes: ${challenge.upvotes} / Downvotes: ${challenge.downvotes}\n${formatSongLength(challenge.songDuration)} / ${challenge.numBeats[state.menuSelectedChallenge.difficulty]} beats`}function updateScoreAccuracy(state){const currentNumBeats=state.score.beatsHit+state.score.beatsMissed;state.score.accuracy=100*(state.score.score/(110*currentNumBeats))}var _Mathfloor7=Math.floor,_Mathceil=Math.ceil,utils=__webpack_require__(2);const challengeDataStore={},SEARCH_PER_PAGE=6,SONG_NAME_TRUNCATE=24,SONG_SUB_NAME_TRUNCATE=32,DAMAGE_DECAY=0.25,DAMAGE_MAX=10,DEBUG_CHALLENGE={author:'Superman',difficulty:'Expert',id:'31',image:'assets/img/molerat.jpg',songName:'Friday',songLength:100,songSubName:'Rebecca Black'};AFRAME.registerState({nonBindedStateKeys:['genres'],initialState:{activeHand:localStorage.getItem('hand')||'right',challenge:{author:'',difficulty:'',id:AFRAME.utils.getUrlParameter('challenge'),image:'',isLoading:!1,isBeatsPreloaded:!1,numBeats:void 0,songDuration:0,songName:'',songSubName:''},controllerType:'',damage:0,genre:'',genres:__webpack_require__(130),genreMenuOpen:!1,inVR:!1,isGameOver:!1,isPaused:!1,isPlaying:!1,isSearching:!1,isSongFetching:!1,isSongLoading:!1,isVictory:!1,leaderboard:[],leaderboardFetched:!1,leaderboardQualified:!1,leaderboardNames:'',leaderboardScores:'',menuActive:!0,menuDifficulties:[],menuSelectedChallenge:{author:'',difficulty:'',downloads:'',downloadsText:'',genre:'',id:'',index:-1,image:'',numBeats:void 0,songDuration:0,songInfoText:'',songLength:void 0,songName:'',songSubName:''},score:{accuracy:0,beatsHit:0,beatsMissed:0,beatsText:'',combo:0,maxCombo:0,multiplier:1,rank:'',score:0},search:{active:!0,page:0,hasError:!1,hasNext:!1,hasPrev:!1,query:'',results:[],songNameTexts:'',songSubNameTexts:''},searchResultsPage:[]},handlers:{activehandswap:state=>{state.activeHand='right'===state.activeHand?'left':'right',localStorage.setItem('activeHand',state.activeHand)},beathit:(state,payload)=>{state.damage>DAMAGE_DECAY&&(state.damage-=DAMAGE_DECAY),state.score.beatsHit++,state.score.combo++,state.score.combo>state.score.maxCombo&&(state.score.maxCombo=state.score.combo),state.score.score+=_Mathfloor7(payload.score*state.score.multiplier),state.score.multiplier=2>state.score.combo?1:6>state.score.combo?2:14>state.score.combo?4:8,updateScoreAccuracy(state)},beatmiss:state=>{state.score.beatsMissed++,takeDamage(state),updateScoreAccuracy(state)},beatwrong:state=>{state.score.beatsMissed++,takeDamage(state),updateScoreAccuracy(state)},beatloaderfinish:state=>{state.challenge.isLoading=!1},beatloaderpreloadfinish:state=>{state.menuActive||(state.challenge.isBeatsPreloaded=!0)},beatloaderstart:state=>{state.challenge.isBeatsPreloaded=!1,state.challenge.isLoading=!0},controllerconnected:(state,payload)=>{state.controllerType=payload.name},debuggameplay:state=>{resetScore(state),Object.assign(state.challenge,state.menuSelectedChallenge),state.menuActive=!1,state.menuSelectedChallenge.id='',state.isSearching=!1,state.isSongLoading=!1},debuggameover:state=>{state.isGameOver=!0,state.menuActive=!1},debugloading:state=>{DEBUG_CHALLENGE.id='-1',Object.assign(state.menuSelectedChallenge,DEBUG_CHALLENGE),Object.assign(state.challenge,DEBUG_CHALLENGE),state.menuActive=!1,state.isSongFetching=!0,state.isSongLoading=!0},debugvictory:state=>{Object.assign(state.menuSelectedChallenge,DEBUG_CHALLENGE),Object.assign(state.challenge,DEBUG_CHALLENGE),state.isVictory=!0,state.leaderboardQualified=!0,state.menuActive=!1,state.score.accuracy=74.99,state.score.beatsHit=125,state.score.beatsMissed=125,state.score.maxCombo=123,state.score.rank='C',state.score.score=9001,computeBeatsText(state)},gamemenuresume:state=>{state.isPaused=!1},gamemenurestart:state=>{resetScore(state),state.challenge.isBeatsPreloaded=!1,state.isGameOver=!1,state.isPaused=!1,state.isSongLoading=!0,state.isVictory=!1,state.leaderboardQualified=!1},gamemenuexit:state=>{resetScore(state),state.challenge.isBeatsPreloaded=!1,state.isGameOver=!1,state.isPaused=!1,state.isVictory=!1,state.menuActive=!0,state.challenge.id='',state.leaderboardQualified=!1},genreclear:state=>{state.genre=''},genremenuclose:state=>{state.genreMenuOpen=!1},genremenuopen:state=>{state.genreMenuOpen=!0},keyboardclose:state=>{state.isSearching=!1},keyboardopen:state=>{state.isSearching=!0,state.menuSelectedChallenge.id=''},leaderboard:(state,payload)=>{state.leaderboard.length=0,state.leaderboardFetched=!0,state.leaderboardNames='',state.leaderboardScores='';for(let i=0,score;i<payload.scores.length;i++)score=payload.scores[i],state.leaderboard.push(score),state.leaderboardNames+=`${score.username} (${score.accuracy||0}%)\n`,state.leaderboardScores+=`${score.score}\n`;state.leaderboardLoading=!1},leaderboardqualify:state=>{state.leaderboardQualified=!0},leaderboardscoreadded:(state,payload)=>{state.leaderboard.splice(payload.index,0,payload.scoreData),state.leaderboardNames='',state.leaderboardScores='';for(let i=0,score;i<10;i++)score=state.leaderboard[i],state.leaderboardNames+=`${score.username} (${score.accuracy||0}%)\n`,state.leaderboardScores+=`${score.score}\n`},leaderboardsubmit:state=>{state.leaderboardQualified=!1},menuchallengeselect:(state,id)=>{let challenge=challengeDataStore[id];Object.assign(state.menuSelectedChallenge,challenge),state.menuDifficulties.length=0;for(let i=0;i<challenge.difficulties.length;i++)state.menuDifficulties.unshift(challenge.difficulties[i]);state.menuDifficulties.sort(difficultyComparator),state.menuSelectedChallenge.difficulty=state.menuDifficulties[0],state.menuSelectedChallenge.image=utils.getS3FileUrl(id,'image.jpg'),updateMenuSongInfo(state,challenge),computeMenuSelectedChallengeIndex(state),state.isSearching=!1,clearLeaderboard(state),state.leaderboardLoading=!0},menuchallengeunselect:state=>{state.menuSelectedChallenge.id='',clearLeaderboard(state)},menudifficultyselect:(state,difficulty)=>{state.menuSelectedChallenge.difficulty=difficulty,updateMenuSongInfo(state,state.menuSelectedChallenge),clearLeaderboard(state),state.leaderboardLoading=!0},minehit:state=>{takeDamage(state)},pausegame:state=>{state.isPlaying&&(state.isPaused=!0)},playbuttonclick:state=>{resetScore(state),Object.assign(state.challenge,state.menuSelectedChallenge),state.menuActive=!1,state.menuSelectedChallenge.id='',state.isSearching=!1,state.isSongLoading=!0},searcherror:state=>{state.search.hasError=!0},searchprevpage:function(state){0===state.search.page||(state.search.page--,computeSearchPagination(state))},searchnextpage:function(state){state.search.page>_Mathfloor7(state.search.results.length/SEARCH_PER_PAGE)||(state.search.page++,computeSearchPagination(state))},searchresults:(state,payload)=>{var i;for(state.search.hasError=!1,state.search.page=0,state.search.query=payload.query,state.search.results=payload.results,i=0;i<payload.results.length;i++){let result=payload.results[i];result.songSubName=result.songSubName||'Unknown Artist',result.shortSongName=truncate(result.songName,SONG_NAME_TRUNCATE).toUpperCase(),result.shortSongSubName=truncate(result.songSubName,SONG_SUB_NAME_TRUNCATE),challengeDataStore[result.id]=result}computeSearchPagination(state),payload.isGenreSearch?(state.genreMenuOpen=!1,state.genre=payload.genre,state.menuSelectedChallenge.id=''):(state.genre='',computeMenuSelectedChallengeIndex(state))},songfetchfinish:state=>{state.isSongFetching=!1},songloadcancel:state=>{state.challenge.isBeatsPreloaded=!1,state.challenge.isLoading=!1,state.isSongLoading=!1,state.isSongFetching=!1,state.menuActive=!0},songloadfinish:state=>{state.isSongFetching=!1,state.isSongLoading=!1},songloadstart:state=>{state.isSongFetching=!0,state.isSongLoading=!0},"enter-vr":state=>{state.inVR=!0},"exit-vr":state=>{state.inVR=!1},victory:function(state){state.isVictory=!0;const accuracy=100*(state.score.score/(110*state.challenge.numBeats));state.score.accuracy=isNaN(accuracy)?0:accuracy,state.score.score=isNaN(state.score.score)?0:state.score.score,state.score.rank=95<=accuracy?'S':93<=accuracy?'A':90<=accuracy?'A-':88<=accuracy?'B+':83<=accuracy?'B':80<=accuracy?'B-':78<=accuracy?'C+':73<=accuracy?'C':70<=accuracy?'C-':60<=accuracy?'D':'F',computeBeatsText(state)},victoryfake:function(state){state.score.accuracy='74.99',state.score.rank='C'},wallhitstart:function(state){takeDamage(state)}},computeState:state=>{state.isPlaying=!state.menuActive&&!state.isPaused&&!state.isVictory&&!state.isGameOver&&!state.challenge.isLoading&&!state.isSongLoading&&!!state.challenge.id;const anyMenuOpen=state.menuActive||state.isPaused||state.isVictory||state.isGameOver||state.isSongLoading||state.isSongFetching;state.leftRaycasterActive=anyMenuOpen&&'left'===state.activeHand&&state.inVR,state.rightRaycasterActive=anyMenuOpen&&'right'===state.activeHand&&state.inVR,state.loadingText=state.isSongLoading?state.isSongFetching?'Downloading song...':'Processing song...':''}});const DIFFICULTIES=['Easy','Normal','Hard','Expert','ExpertPlus']},function(module,exports,__webpack_require__){var escape=__webpack_require__(136);exports=module.exports=__webpack_require__(135)(!1),exports.push([module.i,'html {\n  background: #000;\n}\n\n#vrButton {\n  position: absolute;\n  background: url('+escape(__webpack_require__(149))+') no-repeat;\n  background-size: cover;\n  border: 0;\n  cursor: pointer;\n  right: 20px;\n  bottom: 20px;\n  z-index: 9999999;\n  width: 84px;\n  height: 47px;\n}\n\n#vrButton.a-hidden {\n  visibility: hidden;\n}\n\n#vrButton:active {\n  border: 0;\n}\n\n#vrButton:hover {\n  background-position: 0 -50.5px;\n}\n\n.a-loader-title {\n  animation: loaderTitle 1s infinite alternate;\n  color: rgba(0,0,0,0);\n  background: none;\n  background-image: url('+escape(__webpack_require__(150))+');\n  height: 36.2vh;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-top: 0;\n  background-size: contain;\n  margin-left: -1vh;\n}\n\n@keyframes loaderTitle {\n  0% { opacity: 1; }\n  50% { opacity: 0.8; }\n  100% { opacity: 1; }\n}\n\n#tutorial2d {\n  position: absolute;\n  width: 60%;\n  left: 20%;\n  top: 35%;\n}\n\n@media (max-width: 1280px) {\n  #tutorial2d {\n    width: 80%;\n    left: 10%;\n  }\n}\n',''])},function(module){function cssWithMappingToString(item,useSourceMap){var content=item[1]||'',cssMapping=item[3];if(!cssMapping)return content;if(useSourceMap&&'function'==typeof btoa){var sourceMapping=toComment(cssMapping),sourceURLs=cssMapping.sources.map(function(source){return'/*# sourceURL='+cssMapping.sourceRoot+source+' */'});return[content].concat(sourceURLs).concat([sourceMapping]).join('\n')}return[content].join('\n')}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));return'/*# '+('sourceMappingURL=data:application/json;charset=utf-8;base64,'+base64)+' */'}module.exports=function(useSourceMap){var list=[];return list.toString=function toString(){return this.map(function(item){var content=cssWithMappingToString(item,useSourceMap);return item[2]?'@media '+item[2]+'{'+content+'}':content}).join('')},list.i=function(modules,mediaQuery){'string'==typeof modules&&(modules=[[null,modules,'']]);for(var alreadyImportedModules={},i=0,id;i<this.length;i++)id=this[i][0],'number'==typeof id&&(alreadyImportedModules[id]=!0);for(i=0;i<modules.length;i++){var item=modules[i];'number'==typeof item[0]&&alreadyImportedModules[item[0]]||(mediaQuery&&!item[2]?item[2]=mediaQuery:mediaQuery&&(item[2]='('+item[2]+') and ('+mediaQuery+')'),list.push(item))}},list}},function(module){module.exports=function escape(url){return'string'==typeof url?(/^['"].*['"]$/.test(url)&&(url=url.slice(1,-1)),/["'() \t\n]/.test(url)?'"'+url.replace(/"/g,'\\"').replace(/\n/g,'\\n')+'"':url):url}},function(module,exports){function selectColor(){return exports.colors[prevColor++%exports.colors.length]}exports=module.exports=function debug(namespace){function disabled(){}function enabled(){var self=enabled;null==self.useColors&&(self.useColors=exports.useColors()),null==self.color&&self.useColors&&(self.color=selectColor());var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]),'string'!=typeof args[0]&&(args=['%o'].concat(args));var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if('%%'===match)return match;index++;var formatter=exports.formatters[format];if('function'==typeof formatter){var val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),'function'==typeof exports.formatArgs&&(args=exports.formatArgs.apply(self,args));var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}disabled.enabled=!1,enabled.enabled=!0;var fn=exports.enabled(namespace)?enabled:disabled;return fn.namespace=namespace,fn},exports.coerce=function coerce(val){return val instanceof Error?val.stack||val.message:val},exports.disable=function disable(){exports.enable('')},exports.enable=function enable(namespaces){exports.save(namespaces);for(var split=(namespaces||'').split(/[\s,]+/),len=split.length,i=0;i<len;i++)split[i]&&(namespaces=split[i].replace(/\*/g,'.*?'),'-'===namespaces[0]?exports.skips.push(new RegExp('^'+namespaces.substr(1)+'$')):exports.names.push(new RegExp('^'+namespaces+'$')))},exports.enabled=function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++)if(exports.skips[i].test(name))return!1;for(i=0,len=exports.names.length;i<len;i++)if(exports.names[i].test(name))return!0;return!1},exports.names=[],exports.skips=[],exports.formatters={};var prevColor=0},function(module,exports,__webpack_require__){(function(process,global){(function(global,factory){module.exports=factory()})(this,function(){'use strict';function objectOrFunction(x){var type=typeof x;return null!==x&&('object'==type||'function'==type)}function isFunction(x){return'function'==typeof x}function useVertxTimer(){return'undefined'==typeof vertxNext?useSetTimeout():function(){vertxNext(flush)}}function useSetTimeout(){var globalSetTimeout=setTimeout;return function(){return globalSetTimeout(flush,1)}}function flush(){for(var i=0;i<len;i+=2){var callback=queue[i],arg=queue[i+1];callback(arg),queue[i]=void 0,queue[i+1]=void 0}len=0}function then(onFulfillment,onRejection){var parent=this,child=new this.constructor(noop);void 0===child[PROMISE_ID]&&makePromise(child);var _state=parent._state;if(_state){var callback=arguments[_state-1];asap(function(){return invokeCallback(_state,child,callback,parent._result)})}else subscribe(parent,child,onFulfillment,onRejection);return child}function resolve$1(object){var Constructor=this;if(object&&'object'==typeof object&&object.constructor===Constructor)return object;var promise=new Constructor(noop);return resolve(promise,object),promise}function noop(){}function selfFulfillment(){return new TypeError('You cannot resolve a promise with itself')}function cannotReturnOwn(){return new TypeError('A promises callback cannot return that same promise.')}function getThen(promise){try{return promise.then}catch(error){return TRY_CATCH_ERROR.error=error,TRY_CATCH_ERROR}}function tryThen(then$$1,value,fulfillmentHandler,rejectionHandler){try{then$$1.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function handleForeignThenable(promise,thenable,then$$1){asap(function(promise){var sealed=!1,error=tryThen(then$$1,thenable,function(value){sealed||(sealed=!0,thenable===value?fulfill(promise,value):resolve(promise,value))},function(reason){sealed||(sealed=!0,reject(promise,reason))},'Settle: '+(promise._label||' unknown promise'));!sealed&&error&&(sealed=!0,reject(promise,error))},promise)}function handleOwnThenable(promise,thenable){thenable._state===FULFILLED?fulfill(promise,thenable._result):thenable._state===REJECTED?reject(promise,thenable._result):subscribe(thenable,void 0,function(value){return resolve(promise,value)},function(reason){return reject(promise,reason)})}function handleMaybeThenable(promise,maybeThenable,then$$1){maybeThenable.constructor===promise.constructor&&then$$1===then&&maybeThenable.constructor.resolve===resolve$1?handleOwnThenable(promise,maybeThenable):then$$1===TRY_CATCH_ERROR?(reject(promise,TRY_CATCH_ERROR.error),TRY_CATCH_ERROR.error=null):void 0===then$$1?fulfill(promise,maybeThenable):isFunction(then$$1)?handleForeignThenable(promise,maybeThenable,then$$1):fulfill(promise,maybeThenable)}function resolve(promise,value){promise===value?reject(promise,selfFulfillment()):objectOrFunction(value)?handleMaybeThenable(promise,value,getThen(value)):fulfill(promise,value)}function publishRejection(promise){promise._onerror&&promise._onerror(promise._result),publish(promise)}function fulfill(promise,value){promise._state!==PENDING||(promise._result=value,promise._state=FULFILLED,0!==promise._subscribers.length&&asap(publish,promise))}function reject(promise,reason){promise._state!==PENDING||(promise._state=REJECTED,promise._result=reason,asap(publishRejection,promise))}function subscribe(parent,child,onFulfillment,onRejection){var _subscribers=parent._subscribers,length=_subscribers.length;parent._onerror=null,_subscribers[length]=child,_subscribers[length+FULFILLED]=onFulfillment,_subscribers[length+REJECTED]=onRejection,0===length&&parent._state&&asap(publish,parent)}function publish(promise){var subscribers=promise._subscribers,settled=promise._state;if(0!==subscribers.length){for(var child=void 0,callback=void 0,detail=promise._result,i=0;i<subscribers.length;i+=3)child=subscribers[i],callback=subscribers[i+settled],child?invokeCallback(settled,child,callback,detail):callback(detail);promise._subscribers.length=0}}function tryCatch(callback,detail){try{return callback(detail)}catch(e){return TRY_CATCH_ERROR.error=e,TRY_CATCH_ERROR}}function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value,error,succeeded,failed;if(!hasCallback)value=detail,succeeded=!0;else if(value=tryCatch(callback,detail),value===TRY_CATCH_ERROR?(failed=!0,error=value.error,value.error=null):succeeded=!0,promise===value)return void reject(promise,cannotReturnOwn());promise._state!==PENDING||(hasCallback&&succeeded?resolve(promise,value):failed?reject(promise,error):settled===FULFILLED?fulfill(promise,value):settled===REJECTED&&reject(promise,value))}function initializePromise(promise,resolver){try{resolver(function resolvePromise(value){resolve(promise,value)},function rejectPromise(reason){reject(promise,reason)})}catch(e){reject(promise,e)}}function nextId(){return id++}function makePromise(promise){promise[PROMISE_ID]=id++,promise._state=void 0,promise._result=void 0,promise._subscribers=[]}function validationError(){return new Error('Array Methods must be provided an Array')}function needsResolver(){throw new TypeError('You must pass a resolver function as the first argument to the promise constructor')}function needsNew(){throw new TypeError('Failed to construct \'Promise\': Please use the \'new\' operator, this object constructor cannot be called as a function.')}var _isArray=Array.isArray?Array.isArray:function(x){return'[object Array]'===Object.prototype.toString.call(x)};var isArray=_isArray,len=0,vertxNext=void 0,customSchedulerFn=void 0,asap=function asap(callback,arg){queue[len]=callback,queue[len+1]=arg,len+=2,2==len&&(customSchedulerFn?customSchedulerFn(flush):scheduleFlush())},browserWindow='undefined'==typeof window?void 0:window,browserGlobal=browserWindow||{},BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver,isNode='undefined'==typeof self&&'undefined'!=typeof process&&'[object process]'==={}.toString.call(process),isWorker='undefined'!=typeof Uint8ClampedArray&&'undefined'!=typeof importScripts&&'undefined'!=typeof MessageChannel,queue=Array(1e3),scheduleFlush=void 0;scheduleFlush=isNode?function useNextTick(){return function(){return process.nextTick(flush)}}():BrowserMutationObserver?function useMutationObserver(){var iterations=0,observer=new BrowserMutationObserver(flush),node=document.createTextNode('');return observer.observe(node,{characterData:!0}),function(){node.data=iterations=++iterations%2}}():isWorker?function useMessageChannel(){var channel=new MessageChannel;return channel.port1.onmessage=flush,function(){return channel.port2.postMessage(0)}}():void 0===browserWindow&&'function'=='function'?function attemptVertx(){try{var vertx=Function('return this')().require('vertx');return vertxNext=vertx.runOnLoop||vertx.runOnContext,useVertxTimer()}catch(e){return useSetTimeout()}}():useSetTimeout();var PROMISE_ID=Math.random().toString(36).substring(2),PENDING=void 0,FULFILLED=1,REJECTED=2,TRY_CATCH_ERROR={error:null},id=0,Enumerator=function(){function Enumerator(Constructor,input){this._instanceConstructor=Constructor,this.promise=new Constructor(noop),this.promise[PROMISE_ID]||makePromise(this.promise),isArray(input)?(this.length=input.length,this._remaining=input.length,this._result=Array(this.length),0===this.length?fulfill(this.promise,this._result):(this.length=this.length||0,this._enumerate(input),0===this._remaining&&fulfill(this.promise,this._result))):reject(this.promise,validationError())}return Enumerator.prototype._enumerate=function _enumerate(input){for(var i=0;this._state===PENDING&&i<input.length;i++)this._eachEntry(input[i],i)},Enumerator.prototype._eachEntry=function _eachEntry(entry,i){var c=this._instanceConstructor,resolve$$1=c.resolve;if(resolve$$1===resolve$1){var _then=getThen(entry);if(_then===then&&entry._state!==PENDING)this._settledAt(entry._state,i,entry._result);else if('function'!=typeof _then)this._remaining--,this._result[i]=entry;else if(c===Promise$1){var promise=new c(noop);handleMaybeThenable(promise,entry,_then),this._willSettleAt(promise,i)}else this._willSettleAt(new c(function(resolve$$1){return resolve$$1(entry)}),i)}else this._willSettleAt(resolve$$1(entry),i)},Enumerator.prototype._settledAt=function _settledAt(state,i,value){var promise=this.promise;promise._state===PENDING&&(this._remaining--,state===REJECTED?reject(promise,value):this._result[i]=value),0===this._remaining&&fulfill(promise,this._result)},Enumerator.prototype._willSettleAt=function _willSettleAt(promise,i){var enumerator=this;subscribe(promise,void 0,function(value){return enumerator._settledAt(FULFILLED,i,value)},function(reason){return enumerator._settledAt(REJECTED,i,reason)})},Enumerator}(),Promise$1=function(){function Promise(resolver){this[PROMISE_ID]=nextId(),this._result=this._state=void 0,this._subscribers=[],noop!==resolver&&('function'!=typeof resolver&&needsResolver(),this instanceof Promise?initializePromise(this,resolver):needsNew())}return Promise.prototype.catch=function _catch(onRejection){return this.then(null,onRejection)},Promise.prototype.finally=function _finally(callback){var promise=this,constructor=promise.constructor;return promise.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){throw reason})})},Promise}();return Promise$1.prototype.then=then,Promise$1.all=function all(entries){return new Enumerator(this,entries).promise},Promise$1.race=function race(entries){var Constructor=this;return isArray(entries)?new Constructor(function(resolve,reject){for(var length=entries.length,i=0;i<length;i++)Constructor.resolve(entries[i]).then(resolve,reject)}):new Constructor(function(_,reject){return reject(new TypeError('You must pass an array to race.'))})},Promise$1.resolve=resolve$1,Promise$1.reject=function reject$1(reason){var Constructor=this,promise=new Constructor(noop);return reject(promise,reason),promise},Promise$1._setScheduler=function setScheduler(scheduleFn){customSchedulerFn=scheduleFn},Promise$1._setAsap=function setAsap(asapFn){asap=asapFn},Promise$1._asap=asap,Promise$1.polyfill=function polyfill(){var local;if('undefined'!=typeof global)local=global;else if('undefined'!=typeof self)local=self;else try{local=Function('return this')()}catch(e){throw new Error('polyfill failed because global object is unavailable in this environment')}var P=local.Promise;if(P){var promiseToString=null;try{promiseToString=Object.prototype.toString.call(P.resolve())}catch(e){}if('[object Promise]'===promiseToString&&!P.cast)return}local.Promise=Promise$1},Promise$1.Promise=Promise$1,Promise$1})}).call(exports,__webpack_require__(9),__webpack_require__(0))},function(module,exports,__webpack_require__){'use strict';__webpack_require__(37);var firebase=function _interopDefault(ex){return ex&&'object'==typeof ex&&'default'in ex?ex['default']:ex}(__webpack_require__(13));module.exports=firebase},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__firebase_firestore__=__webpack_require__(35),__WEBPACK_IMPORTED_MODULE_0__firebase_firestore___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__firebase_firestore__)},function(module,exports,__webpack_require__){(function(global){var win;win='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,module.exports=win}).call(exports,__webpack_require__(0))},function(module,exports,__webpack_require__){'use strict';var has=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,slice=Array.prototype.slice,isArgs=__webpack_require__(143),isEnumerable=Object.prototype.propertyIsEnumerable,hasDontEnumBug=!isEnumerable.call({toString:null},'toString'),hasProtoEnumBug=isEnumerable.call(function(){},'prototype'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},excludedKeys={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},hasAutomationEqualityBug=function(){if('undefined'==typeof window)return!1;for(var k in window)try{if(!excludedKeys['$'+k]&&has.call(window,k)&&null!==window[k]&&'object'==typeof window[k])try{equalsConstructorPrototype(window[k])}catch(e){return!0}}catch(e){return!0}return!1}(),equalsConstructorPrototypeIfNotBuggy=function(o){if('undefined'==typeof window||!hasAutomationEqualityBug)return equalsConstructorPrototype(o);try{return equalsConstructorPrototype(o)}catch(e){return!1}},keysShim=function keys(object){var isObject=null!==object&&'object'==typeof object,isFunction='[object Function]'===toStr.call(object),isArguments=isArgs(object),isString=isObject&&'[object String]'===toStr.call(object),theKeys=[];if(!isObject&&!isFunction&&!isArguments)throw new TypeError('Object.keys called on a non-object');if(isString&&0<object.length&&!has.call(object,0))for(var i=0;i<object.length;++i)theKeys.push(i+'');if(isArguments&&0<object.length)for(var j=0;j<object.length;++j)theKeys.push(j+'');else for(var name in object)!(hasProtoEnumBug&&isFunction&&'prototype'==name)&&has.call(object,name)&&theKeys.push(name+'');if(hasDontEnumBug)for(var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object),k=0;k<dontEnums.length;++k)!(skipConstructor&&'constructor'===dontEnums[k])&&has.call(object,dontEnums[k])&&theKeys.push(dontEnums[k]);return theKeys};keysShim.shim=function shimObjectKeys(){if(Object.keys){var keysWorksWithArguments=function(){return 2===(Object.keys(arguments)||'').length}(1,2);if(!keysWorksWithArguments){var originalKeys=Object.keys;Object.keys=function keys(object){return isArgs(object)?originalKeys(slice.call(object)):originalKeys(object)}}}else Object.keys=keysShim;return Object.keys||keysShim},module.exports=keysShim},function(module){'use strict';var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value),isArgs='[object Arguments]'===str;return isArgs||(isArgs='[object Array]'!==str&&null!==value&&'object'==typeof value&&'number'==typeof value.length&&0<=value.length&&'[object Function]'===toStr.call(value.callee)),isArgs}},function(module){'use strict';function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case'string':return v;case'boolean':return v?'true':'false';case'number':return isFinite(v)?v:'';default:return'';}};module.exports=function(obj,sep,eq,name){return sep=sep||'&',eq=eq||'=',null===obj&&(obj=void 0),'object'==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):''};var isArray=Array.isArray||function(xs){return'[object Array]'===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},function(module,exports,__webpack_require__){(function(global,process){(function(global){'use strict';function setImmediate(callback){'function'!=typeof callback&&(callback=new Function(''+callback));for(var args=Array(arguments.length-1),i=0;i<args.length;i++)args[i]=arguments[i+1];var task={callback:callback,args:args};return tasksByHandle[nextHandle]=task,registerImmediate(nextHandle),nextHandle++}function clearImmediate(handle){delete tasksByHandle[handle]}function run(task){var callback=task.callback,args=task.args;switch(args.length){case 0:callback();break;case 1:callback(args[0]);break;case 2:callback(args[0],args[1]);break;case 3:callback(args[0],args[1],args[2]);break;default:callback.apply(void 0,args);}}function runIfPresent(handle){if(currentlyRunningATask)setTimeout(runIfPresent,0,handle);else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=!0;try{run(task)}finally{clearImmediate(handle),currentlyRunningATask=!1}}}}function installNextTickImplementation(){registerImmediate=function(handle){process.nextTick(function(){runIfPresent(handle)})}}function canUsePostMessage(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=!0,oldOnMessage=global.onmessage;return global.onmessage=function(){postMessageIsAsynchronous=!1},global.postMessage('','*'),global.onmessage=oldOnMessage,postMessageIsAsynchronous}}function installPostMessageImplementation(){var messagePrefix='setImmediate$'+Math.random()+'$',onGlobalMessage=function(event){event.source===global&&'string'==typeof event.data&&0===event.data.indexOf(messagePrefix)&&runIfPresent(+event.data.slice(messagePrefix.length))};global.addEventListener?global.addEventListener('message',onGlobalMessage,!1):global.attachEvent('onmessage',onGlobalMessage),registerImmediate=function(handle){global.postMessage(messagePrefix+handle,'*')}}function installMessageChannelImplementation(){var channel=new MessageChannel;channel.port1.onmessage=function(event){var handle=event.data;runIfPresent(handle)},registerImmediate=function(handle){channel.port2.postMessage(handle)}}function installReadyStateChangeImplementation(){var html=doc.documentElement;registerImmediate=function(handle){var script=doc.createElement('script');script.onreadystatechange=function(){runIfPresent(handle),script.onreadystatechange=null,html.removeChild(script),script=null},html.appendChild(script)}}function installSetTimeoutImplementation(){registerImmediate=function(handle){setTimeout(runIfPresent,0,handle)}}if(!global.setImmediate){var nextHandle=1,tasksByHandle={},currentlyRunningATask=!1,doc=global.document,attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global),registerImmediate;attachTo=attachTo&&attachTo.setTimeout?attachTo:global,'[object process]'==={}.toString.call(global.process)?installNextTickImplementation():canUsePostMessage()?installPostMessageImplementation():global.MessageChannel?installMessageChannelImplementation():doc&&'onreadystatechange'in doc.createElement('script')?installReadyStateChangeImplementation():installSetTimeoutImplementation(),attachTo.setImmediate=setImmediate,attachTo.clearImmediate=clearImmediate}})('undefined'==typeof self?'undefined'==typeof global?this:global:self)}).call(exports,__webpack_require__(0),__webpack_require__(9))},function(module,exports,__webpack_require__){function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j](item.parts[j]);for(;j<item.parts.length;j++)domStyle.parts.push(addStyle(item.parts[j],options))}else{for(var parts=[],j=0;j<item.parts.length;j++)parts.push(addStyle(item.parts[j],options));stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list,options){for(var styles=[],newStyles={},i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],css=item[1],media=item[2],sourceMap=item[3],part={css:css,media:media,sourceMap:sourceMap};newStyles[id]?newStyles[id].parts.push(part):styles.push(newStyles[id]={id:id,parts:[part]})}return styles}function insertStyleElement(options,style){var target=getElement(options.insertInto);if(!target)throw new Error('Couldn\'t find a style target. This probably means that the value for the \'insertInto\' parameter is invalid.');var lastStyleElementInsertedAtTop=stylesInsertedAtTop[stylesInsertedAtTop.length-1];if('top'===options.insertAt)lastStyleElementInsertedAtTop?lastStyleElementInsertedAtTop.nextSibling?target.insertBefore(style,lastStyleElementInsertedAtTop.nextSibling):target.appendChild(style):target.insertBefore(style,target.firstChild),stylesInsertedAtTop.push(style);else if('bottom'===options.insertAt)target.appendChild(style);else if('object'==typeof options.insertAt&&options.insertAt.before){var nextSibling=getElement(options.insertAt.before,target);target.insertBefore(style,nextSibling)}else throw new Error('[Style Loader]\n\n Invalid value for parameter \'insertAt\' (\'options.insertAt\') found.\n Must be \'top\', \'bottom\', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n')}function removeStyleElement(style){if(null===style.parentNode)return!1;style.parentNode.removeChild(style);var idx=stylesInsertedAtTop.indexOf(style);0<=idx&&stylesInsertedAtTop.splice(idx,1)}function createStyleElement(options){var style=document.createElement('style');if(void 0===options.attrs.type&&(options.attrs.type='text/css'),void 0===options.attrs.nonce){var nonce=getNonce();nonce&&(options.attrs.nonce=nonce)}return addAttrs(style,options.attrs),insertStyleElement(options,style),style}function createLinkElement(options){var link=document.createElement('link');return void 0===options.attrs.type&&(options.attrs.type='text/css'),options.attrs.rel='stylesheet',addAttrs(link,options.attrs),insertStyleElement(options,link),link}function addAttrs(el,attrs){Object.keys(attrs).forEach(function(key){el.setAttribute(key,attrs[key])})}function getNonce(){return __webpack_require__.nc}function addStyle(obj,options){var style,update,remove,result;if(options.transform&&obj.css)if(result='function'==typeof options.transform?options.transform(obj.css):options.transform.default(obj.css),result)obj.css=result;else return function(){};if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=createStyleElement(options)),update=applyToSingletonTag.bind(null,style,styleIndex,!1),remove=applyToSingletonTag.bind(null,style,styleIndex,!0)}else obj.sourceMap&&'function'==typeof URL&&'function'==typeof URL.createObjectURL&&'function'==typeof URL.revokeObjectURL&&'function'==typeof Blob&&'function'==typeof btoa?(style=createLinkElement(options),update=updateLink.bind(null,style,options),remove=function(){removeStyleElement(style),style.href&&URL.revokeObjectURL(style.href)}):(style=createStyleElement(options),update=applyToTag.bind(null,style),remove=function(){removeStyleElement(style)});return update(obj),function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}function applyToSingletonTag(style,index,remove,obj){var css=remove?'':obj.css;if(style.styleSheet)style.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=style.childNodes;childNodes[index]&&style.removeChild(childNodes[index]),childNodes.length?style.insertBefore(cssNode,childNodes[index]):style.appendChild(cssNode)}}function applyToTag(style,obj){var css=obj.css,media=obj.media;if(media&&style.setAttribute('media',media),style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}function updateLink(link,options,obj){var css=obj.css,sourceMap=obj.sourceMap,autoFixUrls=options.convertToAbsoluteUrls===void 0&&sourceMap;(options.convertToAbsoluteUrls||autoFixUrls)&&(css=fixUrls(css)),sourceMap&&(css+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+' */');var blob=new Blob([css],{type:'text/css'}),oldSrc=link.href;link.href=URL.createObjectURL(blob),oldSrc&&URL.revokeObjectURL(oldSrc)}var stylesInDom={},isOldIE=function(fn){var memo;return function(){return'undefined'==typeof memo&&(memo=fn.apply(this,arguments)),memo}}(function(){return window&&document&&document.all&&!window.atob}),getTarget=function(target,parent){return parent?parent.querySelector(target):document.querySelector(target)},getElement=function(){var memo={};return function(target,parent){if('function'==typeof target)return target();if('undefined'==typeof memo[target]){var styleTarget=getTarget.call(this,target,parent);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),singleton=null,singletonCounter=0,stylesInsertedAtTop=[],fixUrls=__webpack_require__(147);module.exports=function(list,options){if('undefined'!=typeof DEBUG&&DEBUG&&'object'!=typeof document)throw new Error('The style-loader cannot be used in a non-browser environment');options=options||{},options.attrs='object'==typeof options.attrs?options.attrs:{},options.singleton||'boolean'==typeof options.singleton||(options.singleton=isOldIE()),options.insertInto||(options.insertInto='head'),options.insertAt||(options.insertAt='bottom');var styles=listToStyles(list,options);return addStylesToDom(styles,options),function update(newList){for(var mayRemove=[],i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];domStyle.refs--,mayRemove.push(domStyle)}if(newList){var newStyles=listToStyles(newList,options);addStylesToDom(newStyles,options)}for(var i=0,domStyle;i<mayRemove.length;i++)if(domStyle=mayRemove[i],0===domStyle.refs){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}};var replaceText=function(){var textStore=[];return function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join('\n')}}()},function(module){module.exports=function(css){var location='undefined'!=typeof window&&window.location;if(!location)throw new Error('fixUrls requires window.location');if(!css||'string'!=typeof css)return css;var baseUrl=location.protocol+'//'+location.host,currentDir=baseUrl+location.pathname.replace(/\/[^\/]*$/,'/'),fixedCss=css.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(fullMatch,origUrl){var unquotedOrigUrl=origUrl.trim().replace(/^"(.*)"$/,function(o,$1){return $1}).replace(/^'(.*)'$/,function(o,$1){return $1});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(unquotedOrigUrl))return fullMatch;var newUrl;return newUrl=0===unquotedOrigUrl.indexOf('//')?unquotedOrigUrl:0===unquotedOrigUrl.indexOf('/')?baseUrl+unquotedOrigUrl:currentDir+unquotedOrigUrl.replace(/^\.\//,''),'url('+JSON.stringify(newUrl)+')'});return fixedCss}},function(module,exports,__webpack_require__){(function(global){function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}var scope='undefined'!=typeof global&&global||'undefined'!=typeof self&&self||window,apply=Function.prototype.apply;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,scope,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,scope,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout&&timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(scope,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function onTimeout(){item._onTimeout&&item._onTimeout()},msecs))},__webpack_require__(145),exports.setImmediate='undefined'!=typeof self&&self.setImmediate||'undefined'!=typeof global&&global.setImmediate||this&&this.setImmediate,exports.clearImmediate='undefined'!=typeof self&&self.clearImmediate||'undefined'!=typeof global&&global.clearImmediate||this&&this.clearImmediate}).call(exports,__webpack_require__(0))},function(module){module.exports='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAU0AAAGDCAMAAACYzLIyAAACWFBMVEUAAAAAkP8AkP8AkP8AkP8AkP8AkP8AkP8AkP8AkP8AkP8BkP8AkP8AkP8AkP8AkP8Bkf8AkP8AkP8Dkf8BkP8BkP8Bkf8Vj/y44P8Rl///drb/drZx/+n/drZx/+n/drb/drZx/+n/drf/drZw/+pu/upx/+n/drdx/+lWtv//drb/drbL6f9w/+r+drdx/+n/drZw/+pu/utx/+ll9exMsv9x/+lx/+lw/+r/drb/drb/drb8drf+drdx/+nh8v9q+uzR7P9w/+phu//e8f8wpf9s++qJzP8Ek/9w/urZ7v9v/url9P9x/+n9drf/drb9drdDrv9x/+l2w/9uwf9u/eps++px/+mt3P//drY7qv//drZ7xv/2d7ml2P9x/+knov9x/+m+4//W7f+03/9I1/H8drf/drYru/iZ0/+AyP/B5P//drZx/+kXp/tpvv/t9/86yvX/draU0P8gnv/+drbp9v//drZ+g9xx/+mSgdZK2fHF5v9x/+nWe8Py+f8Xp/uQz///drYbnP/3/P+f1f9x/+kVpfsxwPZO3vD/drbfecArjPMwi/IktPncesBx/+lV5e9Wh+dx/+khjfY9iu5+g9ucgNMajvhx/+mDyf8Kmv6+fcmOgte4fcr/dra5fcpGiexOiOkpjPSwfs1J2PEVpfuIgtkpufcouPj/drb/drbteLzSe8MPoPyof89KiesPoPzreLxghuQ8y/Rx/+n/drZx/+kktPnGfMc9zfNLierleb64fctd7O3oeL1x/+n/drZb6vj/////drZx/+lv/exr+vEkKZq9AAAAw3RSTlMAeUKEWG9nmlCMKho2YJMVCkolDyEwOgbfoXqEZ5R3Zm6EN0xPI4xUk7iNROZEH1qcLjacCbRgbT8qYFoVP3zxFepKvO+rD8ygVu0p83EPdTCxOsPCHRng2uCuJcUK1+2poeHt3Q8Zox7Rx+LvmEC+9xazz6cG9cVD8g8i5Lkm+SvN6qX806lINy+sQGRXLzfASDW0XEwhFWf4yFIvLBrmIVRDQjYpYjYlUdjPbF5YThhsU0xJx7rOW1RBKUlCPGTZ+uxEzOy6AABDfElEQVR42uycz05iSRTGZ2zaK9oiyP9HuAlb1oQAoUPYEFkQQowBN8pCEw0rE2NsX6Jfhxeb+nu/W/dUUVywp3smfGaSnhm7+9SvvnOq6lThXwcddNBBBx100EEHHXTQ/1dVKfYL8XXQrhzzxQuiIlNeijP+jxGuCnPkDUUDqv6ykeQ5ybOzUulSqyR1FgmAdSx/INiqAKix6YjPrJJD+fQQFMnL09NyufxNqqx0GiliDLgg+1vQgmAE0MRXUu44NYQB8bF8LtFqUZP8VqkcWVThijOO2CbJ/mto4UAABD/g4+bQqiQkhsMHAqKfgPKCoWQkBcjCSUKFk4JUgm/E9jSG1qwIn12cYEAHQM0P8IygC1psUBgRGwmI7ssSKDnITOac6ZjpHMpEigE2nAuyFtcCraa7HV+sHrQAugEa9LQ3Mg6J0YDonjzzjGWEMsMxfhX6+++vho6FANlgywSyEVomghZ0FWGIAVO64F8GO1IACUAnPxkuj/vYKjEWEAXP3YzJWLI/SaJkFJm+GPob+sq/TLwgC7RGPTAKAuhiMaMqSV1KRb+tDH4OgOAHdCpcETuEEYmhRETBc0djMpYFFgdHyUFms9lcXFmIMJZsCVmgBVvDtsZiRlVWwuIBfFsANPCZ3sgmpIcSEd2DZ14Yk7EEylwQBL3mw9Ws359djR86YXM07U0DCIQB17CtURAIWs6WqgIdWSUWDvBzAxQy6eWEAof4aMQQROgxnvnUMIUxOUvlyiBo9petNdGP18dht92YT67v+vdXnXA01YAJWiSQja1WcsNwor/ELyOBHfh5AFJ+YdgZz/pvd9eT2/lLo90edFut1nA47C4aL/Pr/jj8HkREwbN0VkwFs8hgCmMKliyGYPrWXm+r4YDB/XibPYSjUcy2IGthaxR/LY4pjkyvG2AHfG6AhN99/25yu2wPho/+odz+7Eii4MntWaymgMlLpjImz/Bev7HeUY+tdqPGbHvVaY6QQVwGW7qUQQliICe+gM/lwGYzHN+/fUzmjUWL8vNr+PHQ+R7nWUG2bwXz8rRypIzJWALlfnplpl3eCrRhs0nQgi0IQxQb4AFfDOCMObD20u6uPiP04Rg8GU6S7X6Yyphg+bladdsvtclHfzYGWuAVhDlkUzmgM1aPUZNnMCuAt0s48FM1fNA8o2zfEmZZw2T18tfApAWB1/1btpS9sbVszLwLwoZGTE2ObvazLxYPRq+LAvgrNZT5/lVm+3Y48wZMsPwN+vHjx+vr4+NqOGQL7Wr1+Mr+w/p3ahh+z3Gc5wpnfput0R8C80/UkONkPAXO0kV1i32mhvm9vT4oifM9kNl+wmonct0HMxs8d9cHEa1Ytiuc5c2ls3pxBpi91fogm1oC53nGVzqLZ0jz6ev6oA04UTqd1iyVjwqqZrbWNrUn/auHsPNwxTYoT3yHUls2xBHt/yDWcli1uNarVw/OLErnZmueu1fzWg+ba7P1Uq8/T5v8BMwPcN3/Ro1gh94XdjITx4dp771eNwc07Uxart8aBqJ0FljpdJkzr6zpgFmb1gO2eyXCOYVLx9JrdmZ9djJZDNd/kIaLxu31089xOOpJeOgjUuXYOJpPbetEPMvSCXPSPNfWzFpgtkOGMiu6p0rOIzTYRrYNx/2732Ta4YB3XRjA6bMGCHwwh7UlIIi+12y5HjCcMKcrz4U1e9SYQU6ijPpl7BfiS+grRWwYN27aUXjF+xGNwWe7FhksHHjPAN5ogOBH6dF+1Vc5IEk0F9RrNpzZjeZUeQ5rmjC/SJQZ0qxFt5b0u0GWoIVr75+ub18Wrdfd6Q15/4QXwAfJzwswjo7bQinZSD0Wtw4Onh2rOZHol3oJCtemur1AHU8zJwV6k8CVQAy2IOtGq9m+30ybohn+9DFhu4X5fPnSYA3xxaDb7Q4W7XajsZzXbieT6+uPJ7Z2dFj1Y/A0PSQwADr4GfBOINyoF+RY2BgUT4KzazcnEr1yZF2CGu+ydSJRiiuwb5C+sqnYr7koWTda9Cm9QlsU+NwGpHfT9HJafknJwaiLb9XlfU4m7BjmtCY6r5o0zxeBPugLlOJ69hI3sNY7WMAFWQPtOWELup57RAjswM8LMIaPacMVaZmNhAMVPGFPak4ciMhe80s2uQRNoybUtzJ/QnIBmdfcArKMQs0sMgimpWhhW+D1Ceho/aP3zLjahCEZSAEw+dwPAxJjETyVPecmmCtpzool1bHX7CcXoKzKct6+vyjK+6UqF148crE3NppkQQGLl3f9CsXz8MLcLVCp/2l7uhOvfjCgiAZFJ/EkBgYpSmE88lkg56nsmavbzMmaH6WLPFmDsNckq7lq3pcuJEoqwZKhlCRF2IbdzFcoRj2AcSBjccWX+Hfr2gF8yGAzGi4Y2QimzHgWi/bHv5KntGc2meth7otahxKVM88TXVhzav6Outj08yzHPZ2dpQw+o98rJRMTr1AK3BRlvBcCWgEXKjDKkGIGgR593kSjcQdzBJ7WoTEyah+ewPkUSKN9wyYJK3pBrEEvNM/FysX+PjvMvGSp39jI90rJJUStGGIQaginqLVKxpuYCv8i4v9Vy3yNiwJIohHh2IMRQAVP1/iYPy/Leu9Yp6l+LMyZJ2VTJPqNeZ4Mcho/Si3521T0Inh9Isup7XlPtxP4bkYOQg5BjsB4ZqnpArBLtrfiF0IkGrYc63ACvTnNIRg1uzL3ig634FxjmrPJcep1iNJM7txDmefuw31eZILeSOjYg/ro6mPeja7EXhe1p3GvLonqIUSOqEaVH5sFn+KvEvHo3xVNr9OftFuizfa6arGuYgfBsGgUz1OnPc8uxZmbmPNHL1qHyCLEvz14MqtmlOf2mpmXVtDRf5Ek+8u1VbUZH4QaAhyRtzxz9anKREdti6Z3X9sQDAOqeSIYV6uSmnPG1yFdOOkiFMwTVXNjnhfNt188+CaJnbRIxRDgCEzUjkKapI2m1mRANU+9bdncq2yaW07QtC5Cg3VMPVE1keckfLz9QnPAp8aMDQGOwAj2EdIE0TxvE03tWfNkwSDbaa4rc9ZdNL2LUJtZU31z3hk+Tl5+lvA8HOEawY5PJNNHUxP+lME4s73IzUnP3eONNM1j5SRQ5/pS0Rm+sgKJ3uPPEI7ACPaGWUgbDXiqYFylpxiVwpqdprGkX6olvbOOqc8THVXTHj5aAqk0H0lHYAT7w6QNilTJgmxHMHRhud7oTZwrjxnNWaIhKtZ/kLeHnwuaL+vUqt0EOTKCPWAiTULc5aRJFpXtCMakWbFk+gMIEZpoeeAcit2UM3xYIS1PMoI9YaY3Jr1eIMF4aCLT6Xbzbh3TCDS94e8/grPi3jBFxVzuGMxSvCcETgfNtrtu4pWhrSpgp09rMsJ/N2Zrx3qF6rwnzNruwXSnQY7iTE8TNXayjulZ0yyS3dd+4UMvfDnFeeu3wUSuIFX2pmlGU5c0T0HTOBl4w18s5xP+/LfR9Y7gfLfSiTzxRzMctBvLRrs79OMkqeKnWTW/90h879JDE2Y43xh++7o/GsWfpc8WG0eA9PIrfZ50WZ8DD7/Dh/6kuxEnTZV8tLJ8OM5CvhXrVfabjmB6I7Pc4bf7U9314pItMUZ04RpBNs1KlDZPum8MpP5ETXTpHD61UqSKddfjpxkf8CrI4hbJkllZe/jtn7yvYd4oCqQM6NjqiRuSXims6cmTbshQmtGICeZAW06cmNu9aLbigUQ08/bMmtpYdkTw8rrgGFe9fBDcoQvb79lxJUI0gElYGtFwxZ7EdFr2VMHcUpo/vTTRQloZg7TQjD/xHNDor2T0+tpF61x/9JX5c+FML/ghVZ4786Q7FhswFY0Ox3gSc2VZk6aWucVp8Z72NylNFhSP6XUNNUCTtKaM62XwV9Hrz3QX8GRCfixbjGA0sOOEH3bI8zqlMjCikTfr7B/jSYzt1W/3O51bP01fQ24e6O5mPmFNZBbN2Ph7pYq6MFP3h1HnETgtt3nFnfKcnIBWTRKN1JG+zdSn+kdyKiJzSzsZoHm8Hc1b0CTWRGaRo8S5vuPFdaL+cRbRCAb29DpPZ87ihjwf1APVtMwkoynLaDKq4xQ8tzxzi/cGSZr3oOlrb16DJu3ov1uMibdfFf6EAi9R9I9aKWSiptPQ5ustzUmrTkhgKmNyluLFz2UpFgyPRvCUk0uzPUzOLWhe0Z4lpSm/dbSO6U7QROed3DYRGgKmjF7+oCsl9WOA9AhEvRpQP6Q0ZxFVp01hCmOqaEoyGgRzxniiU09xNsjcRjTHW9M05/gtwLcm61SPwMQHEEX0xTz5uUolNQKV7cmtZz0awIWPI606FKY0pj0aRpTzFMmicHrmFv30By9NtN4dRcFXp9po/FZE9FXXzwOqRIa4ed3PnKg6dQtMfPLZGk1V8FSTC5zuuQUiYriMSbMKGzu3pubr46bt013k7Zd1BNoQ2aDpHEBxL2sCZqW8KRoxucDpnlt3+t4RmnQzRS8yUDVlnXqhCzLCBwsLTxgCt81kAIjNraLLmsO6iMb/EyPyfHI5TqSKa279NPOpLjIQvy3Pszr8EsJ3vFrShrBslJ7J9T0VYnZZsxkAJoxpn1zgzAahe25BM5GWH5rmWd57kZEFTSP+uqVoKpg6fJ8hMvI41SUD2HYdQqI8J/M8C5i+WYnjTOb6O+bWSfMaNFNeZCD+0L7xrnj6k8j26Kg/TmTXtqnuTpQuphYwvThlxVg55jZOMztybMnTXWTQ+JHnpEngtZW9dM6kHSreVHcnyhifdgZMD06VKsHMPbc44BiNswloprrIcMc/Jf1AL4mS8AO1ecOwg1MImWwvBtHUAqYXZ9me66McUIFmb3uaczdNxD8m1tR5Xt22kSb9QM15k8WmzOfvii1RwhRTSz8R+WCmOrrlLpq3dpoVAcrsxChMKi4aPzZ3aRu9qnRSa/2EHfxlE4liWvM8Q6bWnyqZc2rOeqzUFX2NIc8l2w/Q3BD/fco+L/xgM+ectFR9ZbNHrCnzHFO71c8sUubsmJmCwpmOJj5CYNLMKJo4L4kyDPWwBPnMQH9KA+oGrS5bls2ZxZqY2rRz+31oHgbBykszzZUl4jd3+AuJHPGnHABSne5xqSwR18ixOd3UwunYcNPCuT/NR3zgwPieOdlwoU6lM+cJUt3RlHGXzVNb2WnmvqS3JrbSODeSTNmJZttO0x1/Ty3CjjrlX5TRfqW3J25hhaU0T1JYk7R9QlvhLO9Fk16n00UI2yNHZvp3SUh1euvspWnrjw2MSp9ubplXsKrTTsVONBdraAiaznPqJMDhJaVIqvuXIXebBvsr91T46zA+4UM7vLvQHNhp+u9FUsePVA+WjuYAke8o3BFlM23ZwR+I4dFj+EV6mkZPpxVPujzaTO4WqF/+l+QdJBeRZ9lE2Uwfjb1wNoAgBU3fwxmnG6apy2b6lz2QZ/qHqcum72Zs8Hk0B3aaNUdephWtHah9oOk7pf/D3pnsphEEYTi77Sw2MUmARxhprpwRYhAR8gUNB4SQZYEvhgOWQD5ZiiySl8jr5MXSK383RdMzwwx2lkoUJ5HiFF9X9VJdXXXhGv4cliG4Z96e7j8uZXeuPtmAJ6PJV7BbT96URzxLxx02iV6aaRIO/VvS7M7Vcty0pN28h7nQbG63lrM8T5b+ZT+nqQrLaGqaM/lP96QZbg+jeeKb3ogctn7/rG0aBpX8XghLzLWDZqHz5vxJzZuRY9703ACnuBf6v6aXMPa+IA3uLH9sR/Vn7DfvitxvejMOfXUo8DDwXz0L3YOmd+zT5Hr48xf/9nM6rMnzBhioHA+q/5AYUidzDKnsiyHRBA73K2lvjpwzvikXvceLbwY5xDcBwB3fJN5A5pY0+Zvu2PvzvyD2LllhdOiuBjTHPpr+3GLnvVD/9C+5F1JD23LcC5F1j1ySQ5Cy5Dg2Oe8sw7zvLE/3ubNcpLuzxHeDozvuLNOcBXGkd5zUCrxPnz/6fbpO9oBv0vt00Iw8cQpytqAngUPlesweI9eDJiLRXA9MLf41k9gxMZQD5SF1HiUPCUlyrjykVHEWegqnCZxwrri4HLn2vjlyrWw5cirXue/KkXNsIqp0B0IrA9D1/6D5m8ep8jd7OeVv0ncZQzgKDR/SgJzzUQbdcP4xucVx1txi+DmtolchgOh+zr3hpFukPybvvfE1W947/VgdPHGhzkuLpHi3SBNMHMnfZDw79JuMVUFvMmp6Dn9XJgsLOXk6JvXIsah53wvhiUvm90JXytGfzHshOYefkYCqJwToYD+E59lv2ULi6+T12KO9ZbtdmdqAJ1XGesvW/k7esmFo3dtNerCk8WJ6GNjZ5aVBXjb631m+PNA7S4wunXI87ywxtHhyTkI02G46o0h0x+V7A4xnq0nfAC9vD/EGWIxuaXuV4M/kDbCj+AANANN3gf5lCBPnGcwBHQscT6o/S56+9+ndQ7xPV2+qNVA8Txfvqd3v01tW8YQybl3cNVL8NHtY13y1E0i1gkPWTggdtRPUe/9zrU5Zl05Qb/1dtRPu7cIeWH+b7iXd39mhg8rFqOuBt6IEp7Oux6fNuh6NA9T10KP75b1WB2U9vqxLmW+r4lM3is6QvaGfJk5qcxK+VMbsqznTXR6d0Joz57rMi6fmTC+3mjPQRo4u1LFKzhzrgkJH7e01ZxAYw2am5VnSaYjL9WTcWw/p1qhA9HGjHhJTv9h6SONt2sjRNQoivTDKIemK0cF3oowZF3NvtH84lnRgQqiePCsmtbpmO2p1vdqo1XVccK2ubQXqump0jWJdZqkuVVuq4ShrB9Okjo7rX3cnMWenDDigXUcuoh/AqtxmNWh8U2QdOVTBsSTi2iigTJQqGiXqntnSNurI2YdYe4kOcEOe9MlMD4tDshqHgf4ETNDekqvvrHE42bPGobt8ZTQ/OjXV4T+Ngot9f41D4uj+aZNeqro3Lv76myOj/uZr8UOXvOzN4eTEGDLW3/SUVo1adQGUiVV+k/n43F9/c1ePjAWmzV3R7NB13ktcG/bnUHVnEqK7NxVTG9Zf9jcK1sVhURo2iBKVUYZpEl9sYdr0VCNwGGeKusU3U6tucS++nORVtzhDSeroIa7rwsVBEC+A0lu3uGQGq/zTJg1xNV0nvlK6mtrN8TXrMjuozrq51tTOWi69ETW/qZLaPpibMxvCAd5pk3a0dG5lc6/3Hq6IMaTHWVS9d3xW130eps3E3VZr5l6QfoDlAXoRoG+Yr3x+e5JZmWab9CKAH5Ibh8CaNqnGpBMwjBPWc7g+GRXV++7MENnSDmTz0wYjC5j2+WBO+6dj2tzVpTogxomZrdAeLgDJIKIv40a/RYYVTIk2+fVwgZ/TGp8BbQKcqnstDIj2FwrCDOq3SX8hxZGDZAjRM3SjFygnC6a5dDua1cnIOmp2wzTh6J5odstzPMje+wrqk95XFebXkuO5arjN5AWRL5wsmJbLlb20QZF6jCxgump2T+3m6Z62jSH1dUyd2fuyQX3Sl02SFBzRM5y32T+G8D+hYfd7wVT0zS5l1gYzpjmy3nNK4M8UrewwTkydsM78egYqknbvdbt9vRY07EbLbm6iWbVBjzv0DESzTscZuvF1vQZVnqU3Tkyd6JdI+1muqkns8ifpZwmSmqPu0v2aCvtbDVW37JYmSrprdprJlEGQG5+OfTgFE37uWoP8xhm4DtNfxOg5e60GHqDVIem1ii72du91dAnRov/GYGp1lbe1YeoMqwmUwQUMOpVKU9cwt5smkuOSGyei8BIn/k9XH+D6Q+hQfir7AEN95lgCJUgyjqRJ96kSNOwGU3SVF0AtbcTwLvuOPsD9JZThTg4vR9d0AyY1TWw2fcZJo6+hjpvBH2iPagWUER1dzoyAVzS+iYdbelTL+y70jTdB6ibd7V7Qn47iVlAftpeqeziYWl3l2TeENmp4OdFVwNSZRHffvn+7iyazy1F9ZSijeyrLT4WG8B8Bk5om1qBsxhliR4Zm4+7+6YLEqj0cXq1qte3905VVHptd7DXHWo8BaDaQwYDu4dcPrTa+o9VVnn9T9KIn/dO1nBJlVFIFPpCYMVwwYZqVpOn9FOdXtBsQ5lne2dv/xNPbn6PEP3oOu75qPVQjb4O/6o3qyC6+M4ByA/2sBmnD2qELVeYcLLV542hF/Rymmcg44euQ5gp7XO5UmmdZ8YTHYg0xVg44Jb+QtVFqnwxuwlTnqTkzUmVnJhsxgUAbqKN0sZVRXfElS0y9Moti/Gubn8M0ExknfN2QyRLeTnnaqwkTsqvRCwY+q5zddN/4cZaY3kNPmqjltwKotUtQComvHyxl3srPAZYvcPE/JKHZi6/kmJ3wpiV0xAawIsuMI60J2TNaW269mVHQYZUcZau6T1yyv1JAbQOFNsfq7lR+OYYy8iPwhA7JEk6OEyr1czz78Bqn8nUnTmO3qJUpVbh9npHzjBacXDBZAuWqE/7aV+7nzEKpgUKbF+Iynf+C4746mFYYSrDEcaqH3b9hmghZlNLetEwcBzHwVCc7EXfEWVvELJjK8oc6VZsosT3tz/ZGiaAUNVChDUIo/IsMm2i9Ncq3YImj/j5+TiPr7Z2nbJjAuY47lhEHYoIwmvY6oMTRKTe572810HOhDoRHn7QFlNYowdJycgrzNX2m6/d1rES087nJE14jI7oI8vIor0CqSWqUjnNfIQYqgdope2zUhYhAqkJps+zNXDDT+DkNRYWOuAsyjrC8KDuEVeqULqz0mCx/OmISec+gGO63wibXVD+JiDRQguUSw0xhws/T4MRKtJvnG+w2pCDGqziuSWIJjzH2BUh1CQOFcnK+hCCQivkHsTw3TLyMynLn377byRMpXAwbYyfXTv47xNY0SeyGCpZqoLVTymFjoQUbD4VSsryCcm6Y8PO0K9HJ0dWFZ46SRFVIF0FexNbWJFOuO41uOL6+XHTieNR5uLkcDMZ3UWKgnCeGWyDlTLVop7Hmn55Lu+8tEyb8PNVKJFOZV66PEI5ULEYiVYJDkB0TqtUTbCwRdUKyyymXdRZOMPox7ibb1CugONhaaZASpDn/ONW7aB+dZIVJrwHdFGbTtiaKeC6ivDqCUxv+JOdGT7fzUzQNh+iAUK8+TZKHMI7JcCMNEl6DzZrTy0+eZ4NJLiWB0yHVUa+mA10QZVC1dqszaCa2yVgltG0G2+1BEkx7wU0CovfTZQ0hUQicxjeVXygvzwgTOBF/7jV2K92t/pi2hiyWqYK8VyzK2+ovqvBJP8lOHcmWRj7tB+ai/Av/qS1KEmU2OkpiorNFa1Ujwy2dphZ0sMFwGKb08mww8fgMT+dYbCrhnPft7uIWifnJUc7ryibpLHcs5JUULG0qrbUXJ8s9Gj/M61eMqZbaVT1eSJv0GCbCuplg0haF8PYipBtroyQr8AtbPq7jU2aP+3pyD7i9aHSb4aRxgbC+1zC1l+P+O53gybG5FrUL4dnt1I3s9M3d4XtLsEtURPWJvx4DaH5yEWjDxAPnPaS8kZLSC3NnaaCUNklOLudacIIBUQEUBpovS2WY8HICM/taJHj2wzxRsq0QUHKSeHh2vg5UnCnRx2uOFXedxnVvfZQHUEyYOqFmLy+na9F7MwOhFeaEsi/MEihlgEJ3O8e714oU8XuRzyk7suPyxzDQICeeDckShgkv3xen8PZ8eXan8HDcd+lQKZIJiSC9kxFVQG0D7UT7swzWLGGYe8GE8nLytHgO9+I56ViTJVBqkkm04kQlUGKg825uLKlh5uTtNs92RgOd/Jj3juzJEiiFTaYYZwEUBprHDNqIN1nmaJjw9g2eWYBOLmNG0rRKaZZAmcFxXAZaj6P0KB8YSsTBOctcDRNK2zw10OG0mUzPcDDSJDVKeDhFmdlA1ftYCXQepUSJPC+whGbF8USCxnA4X4zdakezy2nAQIIkR2lNlvsqXCIGCqBBZxAlIDmIgbJQlpQnVNZEjxjTYLQYXI/vmxN2cptVB5c3i84oriuOJxZJGyUpUbO/gQKoeOHZ6lxHTpDjG0ESKItlSXkCKMLBViIaorwIfIIkUBIPz8tAARRIp4vBOOxG7Ij+7a4RTZqzwWLUCuA12PcWzBI8tQlAZyZ2dBgxXjO2BpL5o6QGCuWeG0iJiKgVnX8Eywwuk3kRtVKrEcm2BCldAiRI5oqSGqgGCt02BhtDDq8xUR6CJXhqlTdSuHhAV4v8g/WIAiSBshjtABTDTUcbXmOGCDjKQ7CkKmuiL9QNoCmKIh74mCQL1bVkAjWRatGXQ5wjAoBA6R/pQoBKoshDE1y50MdnRZOkQKVyQEpGm3jNwVHSo7IOkXGoTL5IeS8FsTWQPJAo5YAUg32M1EMBUpF8FJSUqFQbiWhGkJc82j2k6Cewargx2CrjA6MtSZaePQGpCKYCqhQEeR+JIw3fcaQYbQy4BPlUSFpMKyVLKkyePQWpcCvFaEOewGj/qfKbPTqmAQAAgRgoggH/TiEhePjhbure/tu1rkJuAwAAAAAAAMCwdwariQRBGL6EiLKQQNjVVxC8zlkGFZfQF1kPQWQPiZeNBz0sngSR1ZfI6/hiW2Pb801PMehMxtUFv44QkkvyUfZ4qPrrxo2zUbfIN3JuvRKf6odTPAlx39H/JrgenXT71D/oq3mkV9PCFhAHgt3fco1m0SfamNUGeDhP79zBJD2vwtcDqX5NBPtmL1OzFKAT6Otz+2FqCrabYLSsIQx63H3IEks6jt2mzaL2fG6pQC0Qf2QHEnKR4gubOMoyWtcN+Rb2gFhSfmO3tYRa/0Yo+3LCX7ZA/OkFMXEgmhwvQhajn3WphkWE/SwD3MU4w4JXuZhVVYvavC20deSpCzBboGfP1cYd6BEDjOKz+By1U+myvgU7ZgP3MUm/qMVsrFbQarFrDYMIczxEB3fqAlQCM/2xIMYmgN8r9v8LRvFZrDBrcQ59PKTqkZxjkpPSi1nUeveBdyFgl4cZoG0PITROH/4yBOLPyXLFYU/maJYzis+ChZkaUbbhcFAF5di6VWZRi1vK1sHDDNCGOoEozWMC8RfL8/L+fBi2dUbxWTB8QlyiMhr67AUzicKUSenhrNMMBqPeqAIJw9lmyenUly3AN1C/I3kcf0pglj+2w1QAGGk9BLEVjVIgBondMtWKhLmwlgU2q7nphq1XmUfvv8umlcHICUatbzbbLXrZGyYvd1grhjvtTwvM9teU4ECbkyqD9a0wlHHrdtsY031rLV9/9odubl3FfBSL6GLv0TrcnYp5Frnb9XjWHAwSZYtZ3KIWvK1h8kKZfME98AaWowQqf+/9Xy+Tafh8QpScmXx0xKiKoMkz1GqXBhHK3yu+LGDeDlsNKdsfnUDMWrh0lVoqFzAGPDyov6wKDAJZULTeyqT/Gxt2cmC2M6Km8gfKPRFtWGoW30qKdjrZq20GgVKLWwyD1oY89CUEjqUCG8uwu9iVgBnikxi0XDJtYeKyXBbdcNl42fbHQ9SiV6iKY7DSUCdUYBBE72C5ACdTKrBUzEx85gjiRGacYUoo15mZt6N7fyKPsrU8y4ZSuxj2GAhBpG780d8/PMRelwvwnJhO/pDYR08mLi/AZrNZrebzhTHyoF0s5iv5we5SEMcpqRWEvh//aHQlMq8RQ+wui0dOW0b+PdzdSGH+VKpqWcZxmdXK7+7uxl/2zsI3qiAI4wSHQFIguBxWipQCpRToXaEUKEEqSJEipViRKwR3De7ursHd3f8tZmZ339y92XePu5Ig4SuQd/Ag4cc3M7uzG0ZoBUa7GczGOH1m4eB4jP8iyQmMNEyMU6f/nKaSjZ//KwZOTp0+8wIpZw60TyGeOGzsoi6DF42FBcpSXKE0W5BKW7R/QdByWDEQ9XnFRh+cdfxTZyMx304ObaHFtWy9NG++rKQP7oBxAzfk78gRsOldBzsz2j6UDNVTFPgvVDJ4onaUVJdaep6890zLJPucVR7oTCN7hOoYMWKc3ttn8JRhsDOZOerzH6RRM1NhwM7pcV1GDyV43EcU0vOMlw6y/kMsE/NWRZzLGcCsQV14Wg/JewvNbB3bdhk3bN5vMu2oEdh1AYAlywzACHxeTQGe7WIfCj8QBycKc9rHgg6VxuRJUqYhRl/u/o6bLdu2Fo+cHov9iNQRv9q1HMHkwPkAcLoByPwkPdmvqsHDTcxoMYkz9pxq68hahmmmnIlmLckgVnwZsCYr0bJr5y+dNmvdzIEbE6c3CvsnmAAXKX6+ABmdmgyj5Wqk6klyHjwHW83Jgd5Qxbmc6z9kKMDkCXwuqUNo1lHQXvyOOrn3JKiGP1qaDz69pA81w5dumwirhRkzFqxLhYb4zBFDhgwZMXPQoNTUBTOazZo4cdq0bUuhdgyG7AfwgJ4IYAnwodF1R/eUzqD4OAVVm8eMeY63HGI3Jwd6k6rWEpTKo6lpOiSfcYH4yAa/X7ly5diVY6RLRvtACBa5ohkMVolW9imlZMeZ8UkDRhJ8oXXzxU2lHVoLWeZv08TMO+TRq8vcATuOzWkNdMyaMs5nOoOUCSUdz/IYENcZ7GGlVY4ea2muZFzmShKVzOcc0bOh7GrWX2eICO/JzSdar5R2OtqP2sSqy9NhI8YCN/MwJ2+IxFqzWh13CSoxTSjz37Kj5O0A/PH16+Pnzp27cePqqreg+45W3XfIomsZK5/vuCbj+UmWDqyJJv1RBJP/NMFDbr179y49fdc10FqjuREyo0MbR82ldw2WG6vM2cQS6rzWHOYuQHXMAPq6NI+6qXMllm88gtY8OH4cSF69Chxfou6y8CNC1boMwnygEy4XMi5l+GWX+UV5dae2lgpf40CC17Fjxx6sjqjc7t2JKOAcnwOarZSRAX+f2c5YWx6nDmSa28wJzQ89KlTWIAx0Wc1VlMOmVKGUWkMskeSeN28ePXr0HnQnQvARoBqkN27cOAyqd/kKiM/EWZG11fnS3ww6VtStMkh+9eph9O7alf4OQRLHzFaovih6yszM7DGciPZLT++VnDw+L896+ZdH/dNap5kYpa7rkCtzJmGgkzVLon9Hc1r0Y5TzOZ1keeL4xbNX3+7ZAyRTglmBQNu2bQtbRKiwsJCYKp++fXv16jnQ69fAlK8LOcmf1cAleXcBvyKuN0H6278f4hdRds8FkpmZSDG/DWoAip7ykSoSJaDMU6iROr7V63AXzqW19PRvXiRxRW9ANWidjHOqXJ6TN5quOXHx4tkDCiWQJJAtQV0jBB+RKSF99OjNnj1vr567eBz1+jVPtSKZxQJ+CdFP8/Ua9w0mSHlrQcASUA5HSwJIoNiuXbtOLPiEVPOBKAE1PDPsVwvgaAfjVsb6EIJD5kwSaZMCfXr0ftLEeT3PxuiaE+c3AMvsDoQSSSLH1qCePcvLy3fvhh964kdgSkQDgfcpCPTA2Q0Xz58APQC572vVjS3LXXGsjotBc4FlP2BJKJEkcuzcuaKid+/eZWVl8GNFRefOyBSJElDNszjHas8ksCfVFBnrfRCnqUOSpnvl3sXEuXlfGvP8xQ0HsrM7pABLQtkVUPYsX7Ly9qTwxy9aH8OTbq/cDVCJaGHbQCArpUO24rmmKYkqGS8W/BR5K5Ev/WfMXpw8klgOzySURLJ32faDzz+Urj516uvXr6dOrS798Hz99rLeRJSAZip/jmR7ilNc2nMLc24d6tQhUYTw9VpLo7OmE+f2nNkUjFnU3mHZUpG8feGLVZOIKPBEoEHgmX2gaMP5E029rrlKxb4zOzunOLlXej/Dsp0i+XTCV5smPFVE2xmeyp4ZMVqV0pxTsA6ZxCmLkF5TcdbkOLdGORqzWwfNklBOYnpWoruBJwBtG8gCnt2y229IC02t8iuUMXs8GdOwRJRHmKSV6BEEaniSPTna7b3KPq4lJ9O0FaGokVFDKWtynFuiHI0ZdFhKlFIXVoJBMd6JZ3b7/mmhgl8B0xizh2G5XaC0Ad1uePYge3K0i1gnczb3oulbhAaBNfXLSfYoPwAw0ZiCpY9BwZ+Kp8I5p2Bq5WGyMZUvmaUPT/KntqdXtDdCc8p997iYNKO3lRNxPUVZs5EFpolyMqZg6ePPZ4Yn4iyaTNFeeZhkTKg9gqU/T6hHYE8d7RmSppMKm9lpRpX0hrqkD458dxgGOmdNCROjXBtTsPSz5xLiiTi7UbRPrTxMNqZg6ceT7EnRbsfJhWVaTG/yvrIm0JziaohS/WfyAiZEORpziazi/jwpfVJxZ5yVg4kZE4y5vvRrvCpdD/Zsk4/RrnBKmk0skb6ICQma3PLgfSivpiRMHeXxG5PTJxV3xpkwzF4IMzFjsj0p2hFnL8bpS5MjXS4350W+O1rQFDA5yhPFScmTcBZUxpndCWasjPmN5ZE9VbRDLWJ3SpqDvPMm3zK0ZQWx0jdac55WRirKy+OMclncFc7JcwoqE+Y9FMwJ3hi/G3nwLIXFEiVPDvaEaHKOnRj57jJDs5Eb5mSGicZMXBcoeRLOIo71BHOmhKkoSnnZU+Gk3FmcVymasv43VzTrumg2DaUV/RTM8IVJt27dmjTpQtg3eWaldEswdeYVe8B0g/xkJGhaccIyPh6aTaPfrUrvLvCnOTWU1r99t5SsmDC33Lq9BNZASlDzl6wMx8JZGAh2SAxn3vhkAVOo9MPTg0d6Vyj1Xo89kK+xceb2i65ESU5l2ea7F7JXrI2q31SV95UMs0MwUOgJc8ttBEkNIxI8ENGwF86uLbgSxV/O++XGhFn6HEB2hiYciLqc8AxIn6+OgTMTKpHCKVc9cdCcGXnvE2jKU6QCgJndARftXe0wt6ykvobqD6Oo5UntJQ+HlreOuxJxnGM5z2SYciEJKLE/jM030gD80AmBrvbEibsiSJ2zK0lzoKu1rGgmRcCcwxVot40l7hkJJJxmBLTgEYmiQ8O23xN/JeI4p3LOMAVLRImNduy0k/rm5yNSXJkeXG3F2WlAPuDE1Dlb0jztS5NbSCtcTQ9BkyuQjUx4pWKJILOygsFgSkpKEJSVFVBAwZ/h2JWoIKE472SDWXoQWAJKAEnnakrwhEgBqAfP7ZbUybvF+bK/KWlChwSboZG3gVIlTbKmdwXaQstH3N5gsw3UjQQPwJSAgj+Zp6xEFOsJxXmZBaZmScdpeOabm9sdvsPTcDx8UzzLJM7SMpM6Odb9afo15GbUMt3NJLc1C71gEktASSCz22tlA1EECpYmnmHvSlTE5qxcnJ86QlvFfH2QBkeTY5T6wTMewRFP3NWf8kqdHOuyk8E0a/4czVlMU1jTUoHCSwCmZokgi4r6OyoCogAU/dnCniN261iPx5x5Os4HQJxLg1WAMYllLoBM7wUaicKHdECaSzzBnhXbV9tSp471KJr13TTnM02/9uY0QXMqWZMWR+W2KEeYimVR/8lpaWlztNLSJiNQaIYST5U9pa8LhTn9rGnifL2AqY1JLNN7jUxOTi4uHo8qLobnkb3Siaeyp4z29SbWjTmZ5ljZs5Q01aujI1+dRzSp886rI7amPcqDhmUoFCqYqlUQCiFQ9KdpiJaHZayzOeOwJsV5qYSpjNlRsSyGqzF5GUp5OTnjixXPjmhPjVPGepQ5HZrjfGnaz38313Je5TjX1twtYVKUA0xgmZYWcp1NLEeg4E/gGfSI9nLHnKH4rElxLmEqY44hlq6zHiCKPMegPb1wdmJzRvXTF/nRlK13e1IoUCWIrClgmihvTyyXV2FxmkCegFNFe/nHypkzx7FmmR2mMiazFDzJnh44yxxz5tgRseGqR9NsKmxsXZouDzmroyWuAqRh0qGEZMn+xHDX0d4V/xBpziBnzgStyTDJmIal5Dke7SlxSnN6h+88QVMspuRBhgl0QKFWRxcsBTlAUc7nuXaelD31xjTsZc7Q8p/Mmj0s1lxdxjD5ANLjzJhxbj/lZc6fopkU70FGgSroljhHDLoL5LM1LKDsiThV6pTmxA2RCHUbCi9rHqlgmMKYwp4GZ6eK9V7mzMlgmq7rCT/Yu5YVJ6IgGtSNj4XgIuILRHCh+MLxAT5Q0YiPAR1QUYni20Ui6qZJQBHRLGYhAReSjbocxvWMW/0zu27n9unOuZfqm86MmWh/QEOf1DlVt6rOzUeL5vqN6iBjLdDMEn3PM4do9sFklrN63kVDr0HBmVD9ZAGix8cgo5qdQZ7vzoCpvgVwDnK9Y4IzPhAJ1T1o3gOagYMMEH2ReF6o3Qu2mxgXOKOB4CSqq0RHaEI0dxCYOpyiGD0Kzm0HEqoDzbXXPSV5wCCDiM48L9IAQtXqls7I5CFQXSd6HFL5iOrGonns6CWAWQjOS0dj6Wwu9Jv2Vjl3n06pjgPOHdrfIDT1QYaf6LPguS53yZv6cG4ZDPNvKdVVNFOif2aem4gCmDqcx8H1DJqfU6pn0bxQHM2HfjTrKdEjCk3Lc/BT0c5EOhGcoPrWYlSv3Tg04yL6G7R6a0GNKMP1LtAE1WcO3XhCaHIrg8ZCq/NjoWSnSwYZlp99olOpSTxXHiudVLlGaVav67LJRJfQTHk+FdAkFa6b4EzRBNUT4dykNYaUIdsHoJnKJhM9Cuvz8oG/4cjq8cvqBWRTAOg4QhN93mJwCtcRnECzA+EMQZMtBBbNNQmakM2te2bzqokUBHIWkU4bnBFn9V2n8NNosrngCk3muc51BGc6Hu5COAPQVEeWftlsiGoiBQUH5yDVX4tw7tqrVZxTbtn82QwMTUR6EpzNn4ImC2d5NF/mDAd1t2zOG9VECgoLTqb6DxFOSkOqbCILTyM0Q4Nz27Q0SgVNFs6h0DzrQ1OCySWbszYJcwrSg9NB9dvm11HT0BmLZofQjIUuLDQhw4ImC6egWas8KYEmj9ORhLg8orNgsSrJRfUG0pCCZv/rSTYPxF9PoakHp431Vj6p2V+n8uS5gqaynHAVaCbjNXw8Ez18XZCoTmlIiyVJQrHO4VlIMvqMZA16FB2+IjoswjnwwultSVIfBs3LPjSraShFTpkDMcOpfjsvHQh2PaU3f1EoxbIZRnS8UIK9m33hr2aa1F8Ngeb57D0gGKdbNCWl/8h+++J2I5vX7gYSPVckzDveqKKZpPTmfbdsVkIfCGeu8dFMknoYmvriTNX97a+Hk02c+1Fy4TSAs6VeIGXRbGmyGS7EFs0bpdG8TGjKfI14WQpN1o4IJVKRU3qLv92Uh5WRpKGWLTgFzU8jZPrTfrm5PTvE+G1qd+SMoEdRYh1N2UroEZqhSQjRztrRk/67QbOmohmycAg03zOaQzkAUCUsutGsBxbvOprBStyDdhCaZU6W1f0WzQZVhyNFcx5dpFA0b5lz5b7yaOIx536gyf1NtSPH/c1/PDbPWTSVuRB1ix+70fyvm0BTmwDrc6EVktMPL2VOn9ugbM7wzPKje2a5MurN3pLWm3PKxqF2DwWMgf/PQoKm4iII2PWoqio3Buf07lKe0+dogYM8wLQ4695DGt8e0kKu9T50D6mm9ZCA5j3VJV1gR67t72+eWPn9TTPK8Pc3Bc13rkR9BGgG7W+2fb33LZPQezdEx6/DvXeg+VBHU98trrrnQtGkzIUM0QfRfJBFE8dF55AcD60s8bGp6p5Zfhv1zHL735hZ3hwgOs8sBU1ldOZ3uLD7qvrFztNfT9o83S57gOg8T596btE87x32sDPwqq8lV2mP4a7HsZK7HryIxLJpx0LvXtDtUuREpaGld62r/XSC95CwJOeWzQqhyexVVg7zC5zVr8uwIzdbdkeuG7wjh70ZhCbvyMkggxtym6khRzcDOPO/COdk72/uIF9GB7IpaFINSQ05NmX4z/Ttt5O9W2x5jh8Gsjn1igHiFhIXnP7OcvvrSth7bz0Ycu8dCR3HSrv3zuTlS1LUEukRCgBD9bdFPBmV5fZkPBixJwM5aOe0tV9tfPWOEgsf07lEOs9J3foI2t8VvxAsLiX9QvvHxC8Uv0UEmKa6rsSiJ/U7giaE8+tb1csm5t/68nnZXMHZ62S9bMCTsSzgZdsXd4rNnva6Vc5ykw+W3C9GFwnCCaq7fJawBhb1WW5dHp8lvIHsC9R8ljYHseUcl0ug3FS7SJshnJbqHg8wbKvj5gGGb5U9q34P8P2cQZ0bwOwL1NOQCCeEQajO/nS2VF9L8BwPf3riqe4DCo7fNH5qvz+9m7s8YRPuMlXuSCE0yWppb4cVOPnuBLb7nxI8tbsTDo7y7gQfnEet399enlCzVydYrz/dneC82AO3Fp/1p3T9nx0uZm8uFuV03usBOL33euz/S/d6mLsoZtKLPf4wd94tTkRRFMduxN6SAUUFEaIRbFFBsBDjig1j7IqR2HvFsvbeC/beRVEQUcQ/FFECfi7vfWXOJDeTlyZ6bBtBWX85572Zt+M9i/yxHgso5HrsTLkpPjcxdAZBxybkoonWkR2lt/VBM7dWmjmzYeBwOXNmhZ45M981c2Z3s2fOnN02zMxJGYqhM6MxcmaompESPnMGA5EQdN5V3Fu6xo/bemhvycR3DJ2ROH/trjAPacS/mIekZ/gEBiJNDIxD0vN7wuch4WAPQY+JTQhbumxrwlE9dnUbdTGr62mFWV2TSmZ1Ecu/OqsLY2egnJkvNQHDugKjuiaY2VLKmHI/19bknMug48u/FZrEwpoysA8Vz5HbEDJHjnhijhxJzZEjln9xjhz+07+cfWaAkswYOYtSzj2Tc+SK0HRfLZZNOXIcUZcHH/zAhzCnxbm70ozDwcUzDoll6IzDrQ3POJyLpVPM5TNA1ZBD/k4faZRVzTiUQXcvm3JeF6IOczYwf5MUPn/zYoPzN7F0luNJefcHcE72x29SxpmlHsb7O3z+ZnhHxh6xbIprJNnA6MGcrtmw4En7EUbDmvamUZVnw06qezasGGcqhnD6w2ExGtZM2GeaGLGN2bBmSjmsKUvWUmLZLHuNlAw1Zw1zi9/vL5lb/G5r0+cWu0ftYtru9Zs8uHjstrEE8vrXHCZFE8yKc4t7ov8vVsWyKVsDpwlzorGJcTpmagPpsmXvSI3M1G58DDR0MJe7n8vppRI0y8LEohnYg7yCa9l0N1rCnPznzE70H817FyPKqxNoVpr3jhYxWBNBF8umq20V5jRZx07U/C6C1lBi6A1zdRGczdUNU3YRoPUKexCCjmWzbNTRBCzNWZJ14GxaT0YpzKhpce0RkK60i4b0ZNRXOgJjip4MWIxvuWV/OpbNSi3VcWFOk3WBs5kdLtEgSIKoC4ZZJX2LhFUzlR0uk2tJ+2/6FtrhUtoWWLKbxGUJcG3ttVg6gbORfqGLol/IcGSQhBDl1yVdoEwWTIvKmuZy2m+6ecq+O9kvhJzLDX2KLKgO34dSBZl1LJ3AWX/31VPZfRWNUqwVx96mcJvUVqg/kwXTPuvGBYrEak87xsKj+wowdc5lo/JmUZ5eqbYxIbOOpRM46+1lOyl72VpbqXFVGZK9qCmqmv1gfzJ/62WZdlVM++7aRc3SpuSuzl42YmlSPlLCRAOw3IMQVqloBXNi6Qy4c8X8ZnUG3n1CjcC9u4Cjbaq2JeDBfm8F1vfp8bcbN+6aqme91tsZSCxFZ2AfCxM5R9Bn+nsQlm+3OeXSyTijGue89WTPmvssT8o+yyfP7jz+doNIgiMjJHWQot/VUA3Trl2vHn/LJeiLkXbN80vOnfEvfv8ipRzttdz+a2CKnIs9yG3OeCFk6ewfqP6ex2lvqGuVYR49+vgxNX+/VCQtx0DFfztf5jeCTBXQ/kSUWuVLulZVQai7GtTvBg12ra7btbF3Px9meWvKcmq3OXEKzzj9WnqkvfYeYDam/frR0aNHH715Q13/bTVJy5EZRoy6G5mXFqtiykCJKHXQn+ea/qIe4CG6UTmkB/j6WWVL9NYi5esIJj0qA5hlrYmLTbc504ViJdJqJyIz6LT3DKZ9hOWpgKqO6nfBu3PuqN5d1FFtWT569ebAixe3r3Q2JAGyeyeW56Uz8YWbV2ZT8eTy9F7P49/sDqYEVFv03PbtVOh/6JDfUT1gLjqqj3z5uSSXo5Lq+3SnvuTnl5voqJ47wHYq25SPI5Zv/UZ/wJTWRNBrNmdC7URkBlP0b+8y2Z6Kp+hP5/r03dyfThxtf7pZL9VWTihfHThAKK/cumxI+hy9zMpVW6ZN2Vko1bE1a0+k0p5hykSNRR8yUDIo96ebIoyi/vRtY7W2Ffen2z56YqlTziyvdt1OxuwWBhPWxB7kMKfEyX+LTTvbs4+1p89zUqDbf7jo9ieSbEuV8UvXFMoDn58TynsdtScVSG916kRsesGh6bFNC9MeE1UeNUCNQZnnyKG6kH6C6PanF5qkraJHFz23hu869Lbr9u3amBqmzLmwpsOcyDo07VT3iEk729Pn2dpqeGqgTJSRKjFE5kggmSShpFr/S9eIZTFK7UkvvilRqEGxHWRStqgBSjy1QS+M+WEMykS5oIk1mSCy5s5VJI0tFxBLDrlhycY891AbM9J9Zr5QLuewZlXmFFlnrdmLtJfwfHKUaukVUEuUmVoNYpBM8tN3YvmKFktGSSzv3WMDKFN66c35Qu1KnMiQRS1QGPQ1G5SAMlFGyppAEEnEUZE0tpzNLGcEWG6nkBtjLp9VKNEck3NY021OZL3Mdae2p+ZJ62dUF9M/eUZAr/lEuZ/J1yReKRXJa69evXnDtlQoO9p8e6lYoX7FFp5SQIVBxyzQRJkpazz/xByZJLuSbMkZn6H2Hs2SjalYRpDyMjnv36UvW9NpTmS9PM6IsSd49olGiacGaokyU4hBMsnHhJL2nedXrlwGylMtiUKjOryDHWoN+sE3qCJKSAkqaSj9IIwEUpFUtqTnkwglsVSbTyDknTI4NoI1Tc71eYdTODhhnGskTk/ZEzy7ENCPH1tb6USXgRJR0jXWJV/04tWjx4SSr4bMYmlduXBLoTmKpcsZ9NDrC/SwDDElTZw48QeJOSqSixZPXbfOojwOlirkHozpzrk769iJpD2DPAmoIkoiqJroM2L6CFIk9YWlj7Kd2nUaCbg06EJpUH1RT9ehsy9ovabXJLq359MSoOSN3LBEyCVMDqbIuTvr2IkEztXgae/smGjv3nSUS1TvBPSYRCRvMEmg1LZc7kDZsEGJpwH6mvkZ7SKtU6IP6LVB2TbIMrMlDKbMuTvrITsR4g6efGdnjsj0ce431o0b9F3pBcmQDKI89WCam03jK6gFev7q1atv3/o81S8M8vjxfoSyLaMEy72xggOmyLkbp9yJJE+2gCFq9JKwvrS6/fI2gbQkfZRedkvhLyq2FwZloJ2Z6Hb6vK72Ox6Qf5DaqzOj1Czlgilhcs5hzdp2ovS+UJ64s7PnjoSVxAe7Wu2JY7d7liSuhv6yYnEYVH1yD/0jUSscpBqUmuXqWMENEzmvdSeKdFo9x7FGaaLmSBeHvDhb80nWuO9MmZXIr121pyWbXdlyYtOqpUvz+6ZXDZR54u3WCSKmRvx+2wNArD+ZsM/udCoIEzmvdSdqE+l+KuyfkFjp6cMHjdSIAFq1CZ4JecnqLyyn5zdlk8lOWt1ZnYwy8ZVn8rOqu6jXQHF8x0x9ddMgg+tP6Kc3J90pUh9MLJ04RwmnsGVz2hLFea6FaDiyJ5c/yFcLcmlLKqkZ8l8L4a8jpsnNawpu5bPi7e5oxB8jNQhNSMojbeqECZw440tUNMHKjKf++ZGgjKG8dKpl6bSqPZlNKo54cwyG4jdJMc3EN1VB9PDmvR6ORCGExrWUzzEprxMmcOL8OTOlUFGzYmc2p5af8jxzyLuaTnlTC/fEkEk3yRbKtgGpEJrVmCOqP4CjNFHy6MpqLLplT+qUJ95uHRov3iIuMIQxVcoBsx6ctHb26084zdlUlWvesX1zdp4u1KzpO5LGk3KVM5cHWtjamChbNMtA3cqf2JFcTUytvNXJ7B7tSYcxcawLmPXg7N3F4ETa/4ZmZa0pxQ7ctli9/K9pWqIMNFl9AnbOmTJrWmLNlDk41nca06YcX/+uR1F6Die4F6X/Cs9ZLQal9qQCiavDrkXCVaImaoASzyyANk9z4sqYSDku2utRH+xF+v410XSWAZT4oi4ekCH1tlKv1B0MiCqgMGhzWRpjIuUCZv17keK5MNFMlHQpZFHiDrU/cbTPGbF6GPHH9jmlfpqoAWoNurIpQLFgRmBMkfL69yKVdsszlWgSyoXKlkDJJBklgcSDhaSolvpYPc/JTA1RBho0aLxJPKdoljAmUt4oTpX25vKctRkJNyg1yS5MEg8TCuHxTiJqgBYbtGV64yzjPksYEzAbUVQvnkU8l/9p345ZEwaiOIBLF1uoECzUfgXB1VnElIBbyRIkOCQu6pAh0KlQOvR7917uHv87H4LGS0wh/w4tnR6/9y6YZ3KTZx45F0tQsuQlVZGoBhUDWqy9WcrB9HTaXc/3mgOa/xYfQ/diCcpqJq/pM4FiQH1cQRfxqaXHwcRpP/GsA5pvY5K0plKPJShrHJxzAzqPw+spfxQl9uBk6XUwUbTryaCbw/KyOmdJypJMiRMuKWsP6IgHlECL8EpKOjTCEpU15okHNDaboszOlx0et4epgoQkUToXy1sLDsSAAnQaJeEFkkkMykYtpSdKZtGhMp2mZbLLvpa5unM7viXbfRml8dw4PjmSLiU94ID4GVCAquLmq2gXnoXM9pUkKBu2lJ4MqkWxd+Rgy4vFJyRBKU64rwEFKEgPZZLN1qG6Rf/+XIT58piU6WqKU4PPvQ1bwpNHADWruNth7Hid3Rok/VPKAX3EZgSkInprJa4/xlIemUY8xwyKb1YMKoJlN0NC0iulHFAGRW0nzUbLcWpsyjYs4cklu4/9j2ifyxlVP85LFJAEZTPVARTtlt3GqbFXBETZhqUsmUVp7ahREaOIF3xsyUZrDWxQm5RDghRyxAIQlDU67QO0EsXbUtqVIl8+a0cSoNxukIpui1PTOqW8VeYVGaGqvOo862C3BsmWwsWBlGK+SkfLCZIl70EpRXXZhGpnTBEv7bYZfgXWtBvNftC/0G0tGQw6kIk2pcLt0D/u5YjaiNRsRMnUzdhAdkXSMZ0ETiYqg24k4CPk5v7d/q9Bt19U9F+d6XafPn369Olza/4AHTMK9clhnYAAAAAASUVORK5CYII='},function(module){module.exports='data:image/jpeg;base64,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'},function(){'use strict';function isDataView(obj){return obj&&DataView.prototype.isPrototypeOf(obj)}function normalizeName(name){if('string'!=typeof name&&(name+=''),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(name))throw new TypeError('Invalid character in header field name');return name.toLowerCase()}function normalizeValue(value){return'string'!=typeof value&&(value+=''),value}function iteratorFor(items){var iterator={next:function(){var value=items.shift();return{done:void 0===value,value:value}}};return support.iterable&&(iterator[Symbol.iterator]=function(){return iterator}),iterator}function Headers(headers){this.map={},headers instanceof Headers?headers.forEach(function(value,name){this.append(name,value)},this):Array.isArray(headers)?headers.forEach(function(header){this.append(header[0],header[1])},this):headers&&Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name])},this)}function consumed(body){return body.bodyUsed?Promise.reject(new TypeError('Already read')):void(body.bodyUsed=!0)}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsArrayBuffer(blob),promise}function readBlobAsText(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsText(blob),promise}function readArrayBufferAsText(buf){for(var view=new Uint8Array(buf),chars=Array(view.length),i=0;i<view.length;i++)chars[i]=String.fromCharCode(view[i]);return chars.join('')}function bufferClone(buf){if(buf.slice)return buf.slice(0);var view=new Uint8Array(buf.byteLength);return view.set(new Uint8Array(buf)),view.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(body){this._bodyInit=body,body?'string'==typeof body?this._bodyText=body:support.blob&&Blob.prototype.isPrototypeOf(body)?this._bodyBlob=body:support.formData&&FormData.prototype.isPrototypeOf(body)?this._bodyFormData=body:support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)?this._bodyText=body.toString():support.arrayBuffer&&support.blob&&isDataView(body)?(this._bodyArrayBuffer=bufferClone(body.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):support.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(body)||isArrayBufferView(body))?this._bodyArrayBuffer=bufferClone(body):this._bodyText=body=Object.prototype.toString.call(body):this._bodyText='',this.headers.get('content-type')||('string'==typeof body?this.headers.set('content-type','text/plain;charset=UTF-8'):this._bodyBlob&&this._bodyBlob.type?this.headers.set('content-type',this._bodyBlob.type):support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)&&this.headers.set('content-type','application/x-www-form-urlencoded;charset=UTF-8'))},support.blob&&(this.blob=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error('could not read FormData body as blob');else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return readBlobAsText(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error('could not read FormData body as text');else return Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}function normalizeMethod(method){var upcased=method.toUpperCase();return-1<methods.indexOf(upcased)?upcased:method}function Request(input,options){options=options||{};var body=options.body;if(input instanceof Request){if(input.bodyUsed)throw new TypeError('Already read');this.url=input.url,this.credentials=input.credentials,options.headers||(this.headers=new Headers(input.headers)),this.method=input.method,this.mode=input.mode,this.signal=input.signal,body||null==input._bodyInit||(body=input._bodyInit,input.bodyUsed=!0)}else this.url=input+'';if(this.credentials=options.credentials||this.credentials||'same-origin',(options.headers||!this.headers)&&(this.headers=new Headers(options.headers)),this.method=normalizeMethod(options.method||this.method||'GET'),this.mode=options.mode||this.mode||null,this.signal=options.signal||this.signal,this.referrer=null,('GET'===this.method||'HEAD'===this.method)&&body)throw new TypeError('Body not allowed for GET or HEAD requests');this._initBody(body)}function decode(body){var form=new FormData;return body.trim().split('&').forEach(function(bytes){if(bytes){var split=bytes.split('='),name=split.shift().replace(/\+/g,' '),value=split.join('=').replace(/\+/g,' ');form.append(decodeURIComponent(name),decodeURIComponent(value))}}),form}function parseHeaders(rawHeaders){var headers=new Headers,preProcessedHeaders=rawHeaders.replace(/\r?\n[\t ]+/g,' ');return preProcessedHeaders.split(/\r?\n/).forEach(function(line){var parts=line.split(':'),key=parts.shift().trim();if(key){var value=parts.join(':').trim();headers.append(key,value)}}),headers}function Response(bodyInit,options){options||(options={}),this.type='default',this.status=options.status===void 0?200:options.status,this.ok=200<=this.status&&300>this.status,this.statusText='statusText'in options?options.statusText:'OK',this.headers=new Headers(options.headers),this.url=options.url||'',this._initBody(bodyInit)}function fetch(input,init){return new Promise(function(resolve,reject){function abortXhr(){xhr.abort()}var request=new Request(input,init);if(request.signal&&request.signal.aborted)return reject(new DOMException('Aborted','AbortError'));var xhr=new XMLHttpRequest;xhr.onload=function(){var options={status:xhr.status,statusText:xhr.statusText,headers:parseHeaders(xhr.getAllResponseHeaders()||'')};options.url='responseURL'in xhr?xhr.responseURL:options.headers.get('X-Request-URL');var body='response'in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))},xhr.onerror=function(){reject(new TypeError('Network request failed'))},xhr.ontimeout=function(){reject(new TypeError('Network request failed'))},xhr.onabort=function(){reject(new DOMException('Aborted','AbortError'))},xhr.open(request.method,request.url,!0),'include'===request.credentials?xhr.withCredentials=!0:'omit'===request.credentials&&(xhr.withCredentials=!1),'responseType'in xhr&&support.blob&&(xhr.responseType='blob'),request.headers.forEach(function(value,name){xhr.setRequestHeader(name,value)}),request.signal&&(request.signal.addEventListener('abort',abortXhr),xhr.onreadystatechange=function(){4===xhr.readyState&&request.signal.removeEventListener('abort',abortXhr)}),xhr.send('undefined'==typeof request._bodyInit?null:request._bodyInit)})}var support={searchParams:'URLSearchParams'in self,iterable:'Symbol'in self&&'iterator'in Symbol,blob:'FileReader'in self&&'Blob'in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:'FormData'in self,arrayBuffer:'ArrayBuffer'in self};if(support.arrayBuffer)var viewClasses=['[object Int8Array]','[object Uint8Array]','[object Uint8ClampedArray]','[object Int16Array]','[object Uint16Array]','[object Int32Array]','[object Uint32Array]','[object Float32Array]','[object Float64Array]'],isArrayBufferView=ArrayBuffer.isView||function(obj){return obj&&-1<viewClasses.indexOf(Object.prototype.toString.call(obj))};Headers.prototype.append=function(name,value){name=normalizeName(name),value=normalizeValue(value);var oldValue=this.map[name];this.map[name]=oldValue?oldValue+', '+value:value},Headers.prototype['delete']=function(name){delete this.map[normalizeName(name)]},Headers.prototype.get=function(name){return name=normalizeName(name),this.has(name)?this.map[name]:null},Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))},Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=normalizeValue(value)},Headers.prototype.forEach=function(callback,thisArg){for(var name in this.map)this.map.hasOwnProperty(name)&&callback.call(thisArg,this.map[name],name,this)},Headers.prototype.keys=function(){var items=[];return this.forEach(function(value,name){items.push(name)}),iteratorFor(items)},Headers.prototype.values=function(){var items=[];return this.forEach(function(value){items.push(value)}),iteratorFor(items)},Headers.prototype.entries=function(){var items=[];return this.forEach(function(value,name){items.push([name,value])}),iteratorFor(items)},support.iterable&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var methods=['DELETE','GET','HEAD','OPTIONS','POST','PUT'];Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var response=new Response(null,{status:0,statusText:''});return response.type='error',response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(-1===redirectStatuses.indexOf(status))throw new RangeError('Invalid status code');return new Response(null,{status:status,headers:{location:url}})};var DOMException=self.DOMException;try{new DOMException}catch(err){DOMException=function(message,name){this.message=message,this.name=name;var error=Error(message);this.stack=error.stack},DOMException.prototype=Object.create(Error.prototype),DOMException.prototype.constructor=DOMException}fetch.polyfill=!0,self.fetch||(self.fetch=fetch,self.Headers=Headers,self.Request=Request,self.Response=Response)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMDUwOThhNzhhNmRjZDgwMjkwZDMiLCJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Nsb25lLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlscy5qcyIsIndlYnBhY2s6Ly8vLi9+L2ZvcmVhY2gvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9lcnJvcnMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9tYXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnN0YW50cy9jb2xvcnMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9kZWJ1Zy9icm93c2VyLmpzIiwid2VicGFjazovLy8uL34vaXNhcnJheS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L25vZGUtbGlicy1icm93c2VyL34vcHJvY2Vzcy9icm93c2VyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb25zdGFudHMvYmVhdC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1hdGxhcy11dnMtY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL3ZlbmRvci9CdWZmZXJHZW9tZXRyeVV0aWxzLmpzIiwid2VicGFjazovLy8uL34vQGZpcmViYXNlL2FwcC9kaXN0L2luZGV4LmNqcy5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzL2NvbXBvbmVudC1kZWNvcmF0b3JzLmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9idWlsZFNlYXJjaE1ldGhvZC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL29taXQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9pbmhlcml0cy9pbmhlcml0c19icm93c2VyLmpzIiwid2VicGFjazovLy8uL34vdHNsaWIvdHNsaWIuZXM2LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWFhYmItY29sbGlkZXItY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWF1ZGlvYW5hbHlzZXItY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWV2ZW50LXNldC1jb21wb25lbnQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtZ2VvbWV0cnktbWVyZ2VyLWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1oYXB0aWNzLWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1sYXlvdXQtY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLW9yYml0LWNvbnRyb2xzL2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLXByb3h5LWV2ZW50LWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1yaW5nLXNoYWRlci9kaXN0L2FmcmFtZS1yaW5nLXNoYWRlci5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1zbGljZTktY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLXN0YXRlLWNvbXBvbmVudC9kaXN0L2FmcmFtZS1zdGF0ZS1jb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtdGh1bWItY29udHJvbHMtY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5jc3M/Y2I3MyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cyBcXC5qcyQiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0YXRlIFxcLmpzJCIsIndlYnBhY2s6Ly8vLi9+L0BmaXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5janMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9AZmlyZWJhc2UvbG9nZ2VyL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovLy8uL34vQGZpcmViYXNlL3BvbHlmaWxsL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovLy8uL34vQGZpcmViYXNlL3V0aWwvZGlzdC9pbmRleC5janMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9AZmlyZWJhc2Uvd2ViY2hhbm5lbC13cmFwcGVyL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMvZXZlbnQtYmluZGVyLmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWdlb21ldHJ5LW1lcmdlci1jb21wb25lbnQvbGliL0J1ZmZlckdlb21ldHJ5VXRpbHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtb3JiaXQtY29udHJvbHMvbGliL09yYml0Q29udHJvbHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9BbGdvbGlhU2VhcmNoQ29yZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL0luZGV4Q29yZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvYnVpbGRzL2FsZ29saWFzZWFyY2hMaXRlLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvYnJvd3Nlci9jcmVhdGVBbGdvbGlhc2VhcmNoLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvYnJvd3Nlci9pbmxpbmUtaGVhZGVycy5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvanNvbnAtcmVxdWVzdC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2RlcHJlY2F0ZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2RlcHJlY2F0ZWRNZXNzYWdlLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvZXhpdFByb21pc2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9tZXJnZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL3BsYWNlcy5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL3N0b3JlLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvdmVyc2lvbi5qcyIsIndlYnBhY2s6Ly8vLi9hc3NldHMvc2hhZGVycy9mbGF0LmpzIiwid2VicGFjazovLy8uL2Fzc2V0cy9zaGFkZXJzL3N0YWdlQWRkaXRpdmUuanMiLCJ3ZWJwYWNrOi8vLy4vYXNzZXRzL3NoYWRlcnMvc3RhZ2VOb3JtYWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYWN0aXZlLWNvbG9yLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1ZGlvLWNvbHVtbnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmVhbXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmVhdC1oaXQtc291bmQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmVhdC1sb2FkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmVhdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jb25zb2xlLXNob3J0Y3V0cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jb3B5LXRleHR1cmUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvY3Vyc29yLWxhc2VyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2N1cnNvci1tZXNoLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2RlYnVnLWJlYXQtbG9hZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2RlYnVnLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvZGVidWctY3Vyc29yLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2RlYnVnLXNvbmctdGltZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1zdGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9mYWtlLWdsb3cuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvZmxvb3Itc2hhZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2dhbWVvdmVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2dwdS1wcmVsb2FkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaGFuZC1zd2FwcGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2hhcHRpY3Mtc2FiZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaGFwdGljcy13YWxsLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2hpc3RvcnkuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaW50cm8tc29uZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9rZXlib2FyZC1yYXljYXN0YWJsZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9sZWFkZXJib2FyZC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9sb2dvLWxpZ2h0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2xvZ29mbGlja2VyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL21hdGVyaWFscy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9tZW51LWNvbnRyb2xzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL21lbnUtZGlmZmljdWx0eS1zZWxlY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVudS1zZWxlY3RlZC1jaGFsbGVuZ2UtaW1hZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVudS1zbGlkZS1hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWluZS1mcmFnbWVudHMtbG9hZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL211bHRpcGxpZXItcmluZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9wYXJ0aWNsZXBsYXllci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9wYXVzZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9wYXVzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvcGxheS1zb3VuZC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9yYXljYXN0ZXItdGFyZ2V0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3JlY2VudGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NhYmVyLWNvbnRyb2xzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NhYmVyLXBhcnRpY2xlcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zY29yZS1iZWF0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3Njb3JlLXRleHRzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NlYXJjaC10aHVtYm5haWwtYXRsYXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2VhcmNoLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NvbmctcHJldmlldy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zb25nLXByb2dyZXNzLXJpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc29uZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zdGFnZS1jb2xvcnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc3RhZ2UtbGFzZXJzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N0YWdlLXNoYWRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zdGF0cy1wYXJhbS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zdGVwYmFjay5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zdWItb2JqZWN0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N1cGVyLWtleWJvYXJkLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N1cGVyY3V0Zngtc2hhZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N1cGVyY3V0ZnguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdGV4dC1jb3VudGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3RleHQtdXBwZXJjYXNlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3RvZ2dsZS1wYXVzZS1wbGF5LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3RyYWlsLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3R1dG9yaWFsLTJkLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3R3aXN0ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdmVydGV4LWNvbG9ycy1idWZmZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdmljdG9yeS1hY2N1cmFjeS1yaW5nLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3ZpY3RvcnktcmFuay5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy92aXNpYmxlLXJheWNhc3RhYmxlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3dhbGwtc2hhZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3dhbGwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnN0YW50cy9nZW5yZXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9saWIvc291bmRwb29sLmpzIiwid2VicGFjazovLy8uL3NyYy9zdGF0ZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguY3NzIiwid2VicGFjazovLy8uL34vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9jc3MtbG9hZGVyL2xpYi91cmwvZXNjYXBlLmpzIiwid2VicGFjazovLy8uL34vZGVidWcvZGVidWcuanMiLCJ3ZWJwYWNrOi8vLy4vfi9lczYtcHJvbWlzZS9kaXN0L2VzNi1wcm9taXNlLmpzIiwid2VicGFjazovLy8uL34vZmlyZWJhc2UvYXBwL2Rpc3QvaW5kZXguY2pzLmpzIiwid2VicGFjazovLy8uL34vZmlyZWJhc2UvZmlyZXN0b3JlL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovLy8uL34vZ2xvYmFsL3dpbmRvdy5qcyIsIndlYnBhY2s6Ly8vLi9+L29iamVjdC1rZXlzL2luZGV4LmpzIiwid2VicGFjazovLy8uL34vb2JqZWN0LWtleXMvaXNBcmd1bWVudHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9xdWVyeXN0cmluZy1lczMvZW5jb2RlLmpzIiwid2VicGFjazovLy8uL34vc2V0aW1tZWRpYXRlL3NldEltbWVkaWF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9+L3N0eWxlLWxvYWRlci9saWIvYWRkU3R5bGVzLmpzIiwid2VicGFjazovLy8uL34vc3R5bGUtbG9hZGVyL2xpYi91cmxzLmpzIiwid2VicGFjazovLy8uL34vdGltZXJzLWJyb3dzZXJpZnkvbWFpbi5qcyIsIndlYnBhY2s6Ly8vLi9hc3NldHMvaW1nL2VudGVyLXZyLWJ1dHRvbi1iYWNrZ3JvdW5kLnBuZyIsIndlYnBhY2s6Ly8vLi9hc3NldHMvaW1nL2xvYWRpbmdMb2dvLmpwZyIs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Q0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksS0FBTSxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUks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Q0FDQSxhQUNBLHVCQUNBLG9DQUNBLGtCQUVBLE9BRUEseUJBQ0EsaUNBQXFDLG9CQUNyQywwQkFDQSxRQUNBLFVBRUEsMkNBRUEsc0NBQ0EsS0FDQSwwREFHQSxpREFBNkIsdUJBQTBCLFNBQ3ZELFFBRUEsbUNBQ0EsR0FDQSxJQUNBLGFBQUMsV0FDRCxvQ0FDQSxjQUNBLGtCQUNBLHFCQUNBLDBCQUNBLEtBQ0EsNkNBQ0EsOENBQ0EsYUFzRUEsTUFFQSxpQkFDQSxtQkFDQSxtQkFDQSxxQkFDQSxzQkFDQSIsImZpbGUiOiJidWlsZC9idWlsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEzMSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgMDUwOThhNzhhNmRjZDgwMjkwZDMiLCJ2YXIgZztcclxuXHJcbi8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXHJcbmcgPSAoZnVuY3Rpb24oKSB7XHJcblx0cmV0dXJuIHRoaXM7XHJcbn0pKCk7XHJcblxyXG50cnkge1xyXG5cdC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxyXG5cdGcgPSBnIHx8IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKSB8fCAoMSxldmFsKShcInRoaXNcIik7XHJcbn0gY2F0Y2goZSkge1xyXG5cdC8vIFRoaXMgd29ya3MgaWYgdGhlIHdpbmRvdyByZWZlcmVuY2UgaXMgYXZhaWxhYmxlXHJcblx0aWYodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIilcclxuXHRcdGcgPSB3aW5kb3c7XHJcbn1cclxuXHJcbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cclxuLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3NcclxuLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBnO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAod2VicGFjaykvYnVpbGRpbi9nbG9iYWwuanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjbG9uZShvYmopIHtcbiAgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Nsb25lLmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImNvbnN0IEJBU0VfVVJMID0gJ2h0dHBzOi8vc2FiZXIuc3VwZXJtZWRpdW0uY29tJztcblxuZnVuY3Rpb24gZ2V0UzNGaWxlVXJsIChpZCwgbmFtZSkge1xuICByZXR1cm4gYCR7QkFTRV9VUkx9LyR7aWR9LSR7bmFtZX0/dj0xYDtcbn1cbm1vZHVsZS5leHBvcnRzLmdldFMzRmlsZVVybCA9IGdldFMzRmlsZVVybDtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlscy5qcyIsIlxudmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGZvckVhY2ggKG9iaiwgZm4sIGN0eCkge1xuICAgIGlmICh0b1N0cmluZy5jYWxsKGZuKSAhPT0gJ1tvYmplY3QgRnVuY3Rpb25dJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpdGVyYXRvciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG4gICAgdmFyIGwgPSBvYmoubGVuZ3RoO1xuICAgIGlmIChsID09PSArbCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgZm4uY2FsbChjdHgsIG9ialtpXSwgaSwgb2JqKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAodmFyIGsgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAoaGFzT3duLmNhbGwob2JqLCBrKSkge1xuICAgICAgICAgICAgICAgIGZuLmNhbGwoY3R4LCBvYmpba10sIGssIG9iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vZm9yZWFjaC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbi8vIFRoaXMgZmlsZSBob3N0cyBvdXIgZXJyb3IgZGVmaW5pdGlvbnNcbi8vIFdlIHVzZSBjdXN0b20gZXJyb3IgXCJ0eXBlc1wiIHNvIHRoYXQgd2UgY2FuIGFjdCBvbiB0aGVtIHdoZW4gd2UgbmVlZCBpdFxuLy8gZS5nLjogaWYgZXJyb3IgaW5zdGFuY2VvZiBlcnJvcnMuVW5wYXJzYWJsZUpTT04gdGhlbi4uXG5cbnZhciBpbmhlcml0cyA9IHJlcXVpcmUoJ2luaGVyaXRzJyk7XG5cbmZ1bmN0aW9uIEFsZ29saWFTZWFyY2hFcnJvcihtZXNzYWdlLCBleHRyYVByb3BlcnRpZXMpIHtcbiAgdmFyIGZvckVhY2ggPSByZXF1aXJlKCdmb3JlYWNoJyk7XG5cbiAgdmFyIGVycm9yID0gdGhpcztcblxuICAvLyB0cnkgdG8gZ2V0IGEgc3RhY2t0cmFjZVxuICBpZiAodHlwZW9mIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH0gZWxzZSB7XG4gICAgZXJyb3Iuc3RhY2sgPSAobmV3IEVycm9yKCkpLnN0YWNrIHx8ICdDYW5ub3QgZ2V0IGEgc3RhY2t0cmFjZSwgYnJvd3NlciBpcyB0b28gb2xkJztcbiAgfVxuXG4gIHRoaXMubmFtZSA9ICdBbGdvbGlhU2VhcmNoRXJyb3InO1xuICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJztcblxuICBpZiAoZXh0cmFQcm9wZXJ0aWVzKSB7XG4gICAgZm9yRWFjaChleHRyYVByb3BlcnRpZXMsIGZ1bmN0aW9uIGFkZFRvRXJyb3JPYmplY3QodmFsdWUsIGtleSkge1xuICAgICAgZXJyb3Jba2V5XSA9IHZhbHVlO1xuICAgIH0pO1xuICB9XG59XG5cbmluaGVyaXRzKEFsZ29saWFTZWFyY2hFcnJvciwgRXJyb3IpO1xuXG5mdW5jdGlvbiBjcmVhdGVDdXN0b21FcnJvcihuYW1lLCBtZXNzYWdlKSB7XG4gIGZ1bmN0aW9uIEFsZ29saWFTZWFyY2hDdXN0b21FcnJvcigpIHtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG5cbiAgICAvLyBjdXN0b20gbWVzc2FnZSBub3Qgc2V0LCB1c2UgZGVmYXVsdFxuICAgIGlmICh0eXBlb2YgYXJnc1swXSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGFyZ3MudW5zaGlmdChtZXNzYWdlKTtcbiAgICB9XG5cbiAgICBBbGdvbGlhU2VhcmNoRXJyb3IuYXBwbHkodGhpcywgYXJncyk7XG4gICAgdGhpcy5uYW1lID0gJ0FsZ29saWFTZWFyY2gnICsgbmFtZSArICdFcnJvcic7XG4gIH1cblxuICBpbmhlcml0cyhBbGdvbGlhU2VhcmNoQ3VzdG9tRXJyb3IsIEFsZ29saWFTZWFyY2hFcnJvcik7XG5cbiAgcmV0dXJuIEFsZ29saWFTZWFyY2hDdXN0b21FcnJvcjtcbn1cblxuLy8gbGF0ZSBleHBvcnRzIHRvIGxldCB2YXJpb3VzIGZuIGRlZnMgYW5kIGluaGVyaXRzIHRha2UgcGxhY2Vcbm1vZHVsZS5leHBvcnRzID0ge1xuICBBbGdvbGlhU2VhcmNoRXJyb3I6IEFsZ29saWFTZWFyY2hFcnJvcixcbiAgVW5wYXJzYWJsZUpTT046IGNyZWF0ZUN1c3RvbUVycm9yKFxuICAgICdVbnBhcnNhYmxlSlNPTicsXG4gICAgJ0NvdWxkIG5vdCBwYXJzZSB0aGUgaW5jb21pbmcgcmVzcG9uc2UgYXMgSlNPTiwgc2VlIGVyci5tb3JlIGZvciBkZXRhaWxzJ1xuICApLFxuICBSZXF1ZXN0VGltZW91dDogY3JlYXRlQ3VzdG9tRXJyb3IoXG4gICAgJ1JlcXVlc3RUaW1lb3V0JyxcbiAgICAnUmVxdWVzdCB0aW1lZG91dCBiZWZvcmUgZ2V0dGluZyBhIHJlc3BvbnNlJ1xuICApLFxuICBOZXR3b3JrOiBjcmVhdGVDdXN0b21FcnJvcihcbiAgICAnTmV0d29yaycsXG4gICAgJ05ldHdvcmsgaXNzdWUsIHNlZSBlcnIubW9yZSBmb3IgZGV0YWlscydcbiAgKSxcbiAgSlNPTlBTY3JpcHRGYWlsOiBjcmVhdGVDdXN0b21FcnJvcihcbiAgICAnSlNPTlBTY3JpcHRGYWlsJyxcbiAgICAnPHNjcmlwdD4gd2FzIGxvYWRlZCBidXQgZGlkIG5vdCBjYWxsIG91ciBwcm92aWRlZCBjYWxsYmFjaydcbiAgKSxcbiAgSlNPTlBTY3JpcHRFcnJvcjogY3JlYXRlQ3VzdG9tRXJyb3IoXG4gICAgJ0pTT05QU2NyaXB0RXJyb3InLFxuICAgICc8c2NyaXB0PiB1bmFibGUgdG8gbG9hZCBkdWUgdG8gYW4gYGVycm9yYCBldmVudCBvbiBpdCdcbiAgKSxcbiAgVW5rbm93bjogY3JlYXRlQ3VzdG9tRXJyb3IoXG4gICAgJ1Vua25vd24nLFxuICAgICdVbmtub3duIGVycm9yIG9jY3VyZWQnXG4gIClcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvZXJyb3JzLmpzXG4vLyBtb2R1bGUgaWQgPSA0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBmb3JlYWNoID0gcmVxdWlyZSgnZm9yZWFjaCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG1hcChhcnIsIGZuKSB7XG4gIHZhciBuZXdBcnIgPSBbXTtcbiAgZm9yZWFjaChhcnIsIGZ1bmN0aW9uKGl0ZW0sIGl0ZW1JbmRleCkge1xuICAgIG5ld0Fyci5wdXNoKGZuKGl0ZW0sIGl0ZW1JbmRleCwgYXJyKSk7XG4gIH0pO1xuICByZXR1cm4gbmV3QXJyO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9tYXAuanNcbi8vIG1vZHVsZSBpZCA9IDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIE9GRjogJyMxMTEnLFxuICBSRUQ6ICcjZmYzYTdiJyxcbiAgQkxVRTogJyMwOGJmYTInLFxuXG4gIFVJX0FDQ0VOVDogJyMwOGJmYTInLFxuICBVSV9BQ0NFTlQyOiAnI2YwMTk3OCcsXG5cbiAgU0tZX09GRjogJyMyOTc1NDcnLFxuICBTS1lfQkxVRTogJyM4NDBkNDInLFxuICBTS1lfUkVEOiAnIzE1NDEzNicsXG5cbiAgQkdfT0ZGOiAnIzA4MWEwZicsXG4gIEJHX0JMVUU6ICcjMzc5ZjVlJyxcbiAgQkdfQlJJR0hUQkxVRTogJyM0ZmQ5ODMnLFxuICBCR19SRUQ6ICcjZmYxZjgxJyxcbiAgQkdfQlJJR0hUUkVEOiAnI2ZmNmJiMCcsXG5cbiAgTkVPTl9PRkY6ICcjMDAwJyxcbiAgTkVPTl9CTFVFOiAnIzAwOGE3MCcsXG4gIE5FT05fQlJJR0hUQkxVRTogJyM4N2MyZmYnLFxuICBORU9OX1JFRDogJyNmMDE5NzgnLFxuICBORU9OX0JSSUdIVFJFRDogJyNmZjcwYjUnLFxuXG4gIFRFWFRfT0ZGOiAnIzAwMCcsXG4gIFRFWFRfTk9STUFMOiAnIzQ0NCcsXG4gIFRFWFRfQk9MRDogJyM4ODgnLFxuXG4gIEJFQVRfUkVEOiAnIzY2MDMzOCcsXG4gIEJFQVRfQkxVRTogJyMwMzY2NTcnLFxuXG4gIE1JTkVfUkVEOiAnIzFjMDYwZScsXG4gIE1JTkVfUkVEX0VNSVNTSU9OOiAnIzJhMGQxYicsXG4gIE1JTkVfQkxVRTogJyMwMTExMTQnLFxuICBNSU5FX0JMVUVfRU1JU1NJT046ICcjMDcyMDIwJyxcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29uc3RhbnRzL2NvbG9ycy5qcyIsIlxuLyoqXG4gKiBUaGlzIGlzIHRoZSB3ZWIgYnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBgZGVidWcoKWAuXG4gKlxuICogRXhwb3NlIGBkZWJ1ZygpYCBhcyB0aGUgbW9kdWxlLlxuICovXG5cbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vZGVidWcnKTtcbmV4cG9ydHMubG9nID0gbG9nO1xuZXhwb3J0cy5mb3JtYXRBcmdzID0gZm9ybWF0QXJncztcbmV4cG9ydHMuc2F2ZSA9IHNhdmU7XG5leHBvcnRzLmxvYWQgPSBsb2FkO1xuZXhwb3J0cy51c2VDb2xvcnMgPSB1c2VDb2xvcnM7XG5leHBvcnRzLnN0b3JhZ2UgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2YgY2hyb21lXG4gICAgICAgICAgICAgICAmJiAndW5kZWZpbmVkJyAhPSB0eXBlb2YgY2hyb21lLnN0b3JhZ2VcbiAgICAgICAgICAgICAgICAgID8gY2hyb21lLnN0b3JhZ2UubG9jYWxcbiAgICAgICAgICAgICAgICAgIDogbG9jYWxzdG9yYWdlKCk7XG5cbi8qKlxuICogQ29sb3JzLlxuICovXG5cbmV4cG9ydHMuY29sb3JzID0gW1xuICAnbGlnaHRzZWFncmVlbicsXG4gICdmb3Jlc3RncmVlbicsXG4gICdnb2xkZW5yb2QnLFxuICAnZG9kZ2VyYmx1ZScsXG4gICdkYXJrb3JjaGlkJyxcbiAgJ2NyaW1zb24nXG5dO1xuXG4vKipcbiAqIEN1cnJlbnRseSBvbmx5IFdlYktpdC1iYXNlZCBXZWIgSW5zcGVjdG9ycywgRmlyZWZveCA+PSB2MzEsXG4gKiBhbmQgdGhlIEZpcmVidWcgZXh0ZW5zaW9uIChhbnkgRmlyZWZveCB2ZXJzaW9uKSBhcmUga25vd25cbiAqIHRvIHN1cHBvcnQgXCIlY1wiIENTUyBjdXN0b21pemF0aW9ucy5cbiAqXG4gKiBUT0RPOiBhZGQgYSBgbG9jYWxTdG9yYWdlYCB2YXJpYWJsZSB0byBleHBsaWNpdGx5IGVuYWJsZS9kaXNhYmxlIGNvbG9yc1xuICovXG5cbmZ1bmN0aW9uIHVzZUNvbG9ycygpIHtcbiAgLy8gaXMgd2Via2l0PyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNjQ1OTYwNi8zNzY3NzNcbiAgcmV0dXJuICgnV2Via2l0QXBwZWFyYW5jZScgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlKSB8fFxuICAgIC8vIGlzIGZpcmVidWc/IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM5ODEyMC8zNzY3NzNcbiAgICAod2luZG93LmNvbnNvbGUgJiYgKGNvbnNvbGUuZmlyZWJ1ZyB8fCAoY29uc29sZS5leGNlcHRpb24gJiYgY29uc29sZS50YWJsZSkpKSB8fFxuICAgIC8vIGlzIGZpcmVmb3ggPj0gdjMxP1xuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvVG9vbHMvV2ViX0NvbnNvbGUjU3R5bGluZ19tZXNzYWdlc1xuICAgIChuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2ZpcmVmb3hcXC8oXFxkKykvKSAmJiBwYXJzZUludChSZWdFeHAuJDEsIDEwKSA+PSAzMSk7XG59XG5cbi8qKlxuICogTWFwICVqIHRvIGBKU09OLnN0cmluZ2lmeSgpYCwgc2luY2Ugbm8gV2ViIEluc3BlY3RvcnMgZG8gdGhhdCBieSBkZWZhdWx0LlxuICovXG5cbmV4cG9ydHMuZm9ybWF0dGVycy5qID0gZnVuY3Rpb24odikge1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodik7XG59O1xuXG5cbi8qKlxuICogQ29sb3JpemUgbG9nIGFyZ3VtZW50cyBpZiBlbmFibGVkLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuZnVuY3Rpb24gZm9ybWF0QXJncygpIHtcbiAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gIHZhciB1c2VDb2xvcnMgPSB0aGlzLnVzZUNvbG9ycztcblxuICBhcmdzWzBdID0gKHVzZUNvbG9ycyA/ICclYycgOiAnJylcbiAgICArIHRoaXMubmFtZXNwYWNlXG4gICAgKyAodXNlQ29sb3JzID8gJyAlYycgOiAnICcpXG4gICAgKyBhcmdzWzBdXG4gICAgKyAodXNlQ29sb3JzID8gJyVjICcgOiAnICcpO1xuXG4gIGlmICghdXNlQ29sb3JzKSByZXR1cm4gYXJncztcblxuICB2YXIgYyA9ICdjb2xvcjogJyArIHRoaXMuY29sb3I7XG4gIGFyZ3MgPSBbYXJnc1swXSwgYywgJ2NvbG9yOiBpbmhlcml0J10uY29uY2F0KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3MsIDEpKTtcblxuICAvLyB0aGUgZmluYWwgXCIlY1wiIGlzIHNvbWV3aGF0IHRyaWNreSwgYmVjYXVzZSB0aGVyZSBjb3VsZCBiZSBvdGhlclxuICAvLyBhcmd1bWVudHMgcGFzc2VkIGVpdGhlciBiZWZvcmUgb3IgYWZ0ZXIgdGhlICVjLCBzbyB3ZSBuZWVkIHRvXG4gIC8vIGZpZ3VyZSBvdXQgdGhlIGNvcnJlY3QgaW5kZXggdG8gaW5zZXJ0IHRoZSBDU1MgaW50b1xuICB2YXIgaW5kZXggPSAwO1xuICB2YXIgbGFzdEMgPSAwO1xuICBhcmdzWzBdLnJlcGxhY2UoLyVbYS16JV0vZywgZnVuY3Rpb24obWF0Y2gpIHtcbiAgICBpZiAoJyUlJyA9PT0gbWF0Y2gpIHJldHVybjtcbiAgICBpbmRleCsrO1xuICAgIGlmICgnJWMnID09PSBtYXRjaCkge1xuICAgICAgLy8gd2Ugb25seSBhcmUgaW50ZXJlc3RlZCBpbiB0aGUgKmxhc3QqICVjXG4gICAgICAvLyAodGhlIHVzZXIgbWF5IGhhdmUgcHJvdmlkZWQgdGhlaXIgb3duKVxuICAgICAgbGFzdEMgPSBpbmRleDtcbiAgICB9XG4gIH0pO1xuXG4gIGFyZ3Muc3BsaWNlKGxhc3RDLCAwLCBjKTtcbiAgcmV0dXJuIGFyZ3M7XG59XG5cbi8qKlxuICogSW52b2tlcyBgY29uc29sZS5sb2coKWAgd2hlbiBhdmFpbGFibGUuXG4gKiBOby1vcCB3aGVuIGBjb25zb2xlLmxvZ2AgaXMgbm90IGEgXCJmdW5jdGlvblwiLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuZnVuY3Rpb24gbG9nKCkge1xuICAvLyB0aGlzIGhhY2tlcnkgaXMgcmVxdWlyZWQgZm9yIElFOC85LCB3aGVyZVxuICAvLyB0aGUgYGNvbnNvbGUubG9nYCBmdW5jdGlvbiBkb2Vzbid0IGhhdmUgJ2FwcGx5J1xuICByZXR1cm4gJ29iamVjdCcgPT09IHR5cGVvZiBjb25zb2xlXG4gICAgJiYgY29uc29sZS5sb2dcbiAgICAmJiBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuY2FsbChjb25zb2xlLmxvZywgY29uc29sZSwgYXJndW1lbnRzKTtcbn1cblxuLyoqXG4gKiBTYXZlIGBuYW1lc3BhY2VzYC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlc1xuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gc2F2ZShuYW1lc3BhY2VzKSB7XG4gIHRyeSB7XG4gICAgaWYgKG51bGwgPT0gbmFtZXNwYWNlcykge1xuICAgICAgZXhwb3J0cy5zdG9yYWdlLnJlbW92ZUl0ZW0oJ2RlYnVnJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4cG9ydHMuc3RvcmFnZS5kZWJ1ZyA9IG5hbWVzcGFjZXM7XG4gICAgfVxuICB9IGNhdGNoKGUpIHt9XG59XG5cbi8qKlxuICogTG9hZCBgbmFtZXNwYWNlc2AuXG4gKlxuICogQHJldHVybiB7U3RyaW5nfSByZXR1cm5zIHRoZSBwcmV2aW91c2x5IHBlcnNpc3RlZCBkZWJ1ZyBtb2Rlc1xuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gbG9hZCgpIHtcbiAgdmFyIHI7XG4gIHRyeSB7XG4gICAgciA9IGV4cG9ydHMuc3RvcmFnZS5kZWJ1ZztcbiAgfSBjYXRjaChlKSB7fVxuICByZXR1cm4gcjtcbn1cblxuLyoqXG4gKiBFbmFibGUgbmFtZXNwYWNlcyBsaXN0ZWQgaW4gYGxvY2FsU3RvcmFnZS5kZWJ1Z2AgaW5pdGlhbGx5LlxuICovXG5cbmV4cG9ydHMuZW5hYmxlKGxvYWQoKSk7XG5cbi8qKlxuICogTG9jYWxzdG9yYWdlIGF0dGVtcHRzIHRvIHJldHVybiB0aGUgbG9jYWxzdG9yYWdlLlxuICpcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugc2FmYXJpIHRocm93c1xuICogd2hlbiBhIHVzZXIgZGlzYWJsZXMgY29va2llcy9sb2NhbHN0b3JhZ2VcbiAqIGFuZCB5b3UgYXR0ZW1wdCB0byBhY2Nlc3MgaXQuXG4gKlxuICogQHJldHVybiB7TG9jYWxTdG9yYWdlfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gbG9jYWxzdG9yYWdlKCl7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2U7XG4gIH0gY2F0Y2ggKGUpIHt9XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vZGVidWcvYnJvd3Nlci5qc1xuLy8gbW9kdWxlIGlkID0gN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGFycikge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFycikgPT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaXNhcnJheS9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gOFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L25vZGUtbGlicy1icm93c2VyL34vcHJvY2Vzcy9icm93c2VyLmpzXG4vLyBtb2R1bGUgaWQgPSA5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImV4cG9ydCBjb25zdCBCRUFUX1dBUk1VUF9PRkZTRVQgPSAyNTtcbmV4cG9ydCBjb25zdCBCRUFUX1dBUk1VUF9TUEVFRCA9IDE1NTtcbmV4cG9ydCBjb25zdCBCRUFUX1dBUk1VUF9USU1FID0gKEJFQVRfV0FSTVVQX09GRlNFVCAvIEJFQVRfV0FSTVVQX1NQRUVEKSAqIDEwMDA7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29uc3RhbnRzL2JlYXQuanMiLCIvLyBGb3IgYXV4IHVzZS5cbnZhciB1dnMgPSBbXG4gIG5ldyBUSFJFRS5WZWN0b3IyKCksXG4gIG5ldyBUSFJFRS5WZWN0b3IyKCksXG4gIG5ldyBUSFJFRS5WZWN0b3IyKCksXG4gIG5ldyBUSFJFRS5WZWN0b3IyKClcbl07XG5cbi8qKlxuICogMS1pbmRleGVkLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2F0bGFzLXV2cycsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ2dlb21ldHJ5J10sXG5cbiAgc2NoZW1hOiB7XG4gICAgdG90YWxDb2x1bW5zOiB7dHlwZTogJ2ludCcsIGRlZmF1bHQ6IDF9LFxuICAgIHRvdGFsUm93czoge3R5cGU6ICdpbnQnLCBkZWZhdWx0OiAxfSxcbiAgICBjb2x1bW46IHt0eXBlOiAnaW50JywgZGVmYXVsdDogMX0sXG4gICAgcm93OiB7dHlwZTogJ2ludCcsIGRlZmF1bHQ6IDF9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBjb25zdCB1dnMgPSBnZXRHcmlkVXZzKGRhdGEucm93IC0gMSwgZGF0YS5jb2x1bW4gLSAxLCBkYXRhLnRvdGFsUm93cywgZGF0YS50b3RhbENvbHVtbnMpO1xuXG4gICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJykuZ2VvbWV0cnk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVswXVswXS5jb3B5KHV2c1swXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVswXVsxXS5jb3B5KHV2c1sxXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVswXVsyXS5jb3B5KHV2c1szXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVsxXVswXS5jb3B5KHV2c1sxXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVsxXVsxXS5jb3B5KHV2c1syXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVsxXVsyXS5jb3B5KHV2c1szXSk7XG4gICAgZ2VvbWV0cnkudXZzTmVlZFVwZGF0ZSA9IHRydWU7XG4gIH1cbn0pO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2R5bmFtaWMtdGV4dHVyZS1hdGxhcycsIHtcbiAgc2NoZW1hOiB7XG4gICAgY2FudmFzSWQ6IHtkZWZhdWx0OiAnZHluYW1pY0F0bGFzJ30sXG4gICAgY2FudmFzSGVpZ2h0OiB7ZGVmYXVsdDogMTAyNH0sXG4gICAgY2FudmFzV2lkdGg6IHtkZWZhdWx0OiAxMDI0fSxcbiAgICBkZWJ1Zzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBudW1Db2x1bW5zOiB7ZGVmYXVsdDogOH0sXG4gICAgbnVtUm93czoge2RlZmF1bHQ6IDh9XG4gIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgY2FudmFzLmlkID0gdGhpcy5kYXRhLmNhbnZhc0lkO1xuICAgIGNhbnZhcy5oZWlnaHQgPSB0aGlzLmRhdGEuY2FudmFzSGVpZ2h0O1xuICAgIGNhbnZhcy53aWR0aCA9IHRoaXMuZGF0YS5jYW52YXNXaWR0aDtcbiAgICB0aGlzLmN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKTtcblxuICAgIGlmICh0aGlzLmRhdGEuZGVidWcpIHtcbiAgICAgIGNhbnZhcy5zdHlsZS5sZWZ0ID0gMDtcbiAgICAgIGNhbnZhcy5zdHlsZS50b3AgPSAwO1xuICAgICAgY2FudmFzLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICAgIGNhbnZhcy5zdHlsZS56SW5kZXggPSA5OTk5OTk5OTk5O1xuICAgIH1cbiAgfSxcblxuICBkcmF3VGV4dHVyZTogZnVuY3Rpb24gKGltYWdlLCByb3csIGNvbHVtbiwgd2lkdGgsIGhlaWdodCkge1xuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY2FudmFzO1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICBpZiAoIWltYWdlLmNvbXBsZXRlKSB7XG4gICAgICBpbWFnZS5vbmxvYWQgPSAoKSA9PiB7IHRoaXMuZHJhd1RleHR1cmUoaW1hZ2UsIHJvdywgY29sdW1uKTsgfVxuICAgIH1cblxuICAgIGNvbnN0IGdyaWRIZWlnaHQgPSBoZWlnaHQgfHwgKGNhbnZhcy5oZWlnaHQgLyBkYXRhLm51bVJvd3MpO1xuICAgIGNvbnN0IGdyaWRXaWR0aCA9IHdpZHRoIHx8IChjYW52YXMud2lkdGggLyBkYXRhLm51bUNvbHVtbnMpO1xuXG4gICAgLy8gaW1hZ2UsIGR4LCBkeSwgZHdpZHRoLCBkaGVpZ2h0XG4gICAgdGhpcy5jdHguZHJhd0ltYWdlKGltYWdlLCBncmlkV2lkdGggKiByb3csIGdyaWRXaWR0aCAqIGNvbHVtbiwgZ3JpZFdpZHRoLCBncmlkSGVpZ2h0KTtcblxuICAgIC8vIFJldHVybiBVVnMuXG4gICAgcmV0dXJuIGdldEdyaWRVdnMocm93LCBjb2x1bW4sIGRhdGEubnVtUm93cywgZGF0YS5udW1Db2x1bW5zKTtcbiAgfVxufSk7XG5cbi8qKlxuICogUmV0dXJuIFVWcyBmb3IgYW4gdGV4dHVyZSB3aXRoaW4gYW4gYXRsYXMsIGdpdmVuIHRoZSByb3cgYW5kIGNvbHVtbiBpbmZvLlxuICovXG5mdW5jdGlvbiBnZXRHcmlkVXZzIChyb3csIGNvbHVtbiwgdG90YWxSb3dzLCB0b3RhbENvbHVtbnMpIHtcbiAgY29uc3QgY29sdW1uV2lkdGggPSAxIC8gdG90YWxDb2x1bW5zO1xuICBjb25zdCByb3dIZWlnaHQgPSAxIC8gdG90YWxSb3dzO1xuXG4gIHV2c1swXS5zZXQoY29sdW1uV2lkdGggKiBjb2x1bW4sXG4gICAgICAgICAgICAgcm93SGVpZ2h0ICogcm93ICsgcm93SGVpZ2h0KTtcbiAgdXZzWzFdLnNldChjb2x1bW5XaWR0aCAqIGNvbHVtbixcbiAgICAgICAgICAgICByb3dIZWlnaHQgKiByb3cpO1xuICB1dnNbMl0uc2V0KGNvbHVtbldpZHRoICogY29sdW1uICsgY29sdW1uV2lkdGgsXG4gICAgICAgICAgICAgcm93SGVpZ2h0ICogcm93KTtcbiAgdXZzWzNdLnNldChjb2x1bW5XaWR0aCAqIGNvbHVtbiArIGNvbHVtbldpZHRoLFxuICAgICAgICAgICAgIHJvd0hlaWdodCAqIHJvdyArIHJvd0hlaWdodCk7XG4gIHJldHVybiB1dnM7XG59XG5tb2R1bGUuZXhwb3J0cy5nZXRHcmlkVXZzID0gZ2V0R3JpZFV2cztcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtYXRsYXMtdXZzLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMTFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tL1xuICovXG5cblRIUkVFLkJ1ZmZlckdlb21ldHJ5VXRpbHMgPSB7XG5cblx0Y29tcHV0ZVRhbmdlbnRzOiBmdW5jdGlvbiAoIGdlb21ldHJ5ICkge1xuXG5cdFx0dmFyIGluZGV4ID0gZ2VvbWV0cnkuaW5kZXg7XG5cdFx0dmFyIGF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzO1xuXG5cdFx0Ly8gYmFzZWQgb24gaHR0cDovL3d3dy50ZXJhdGhvbi5jb20vY29kZS90YW5nZW50Lmh0bWxcblx0XHQvLyAocGVyIHZlcnRleCB0YW5nZW50cylcblxuXHRcdGlmICggaW5kZXggPT09IG51bGwgfHxcblx0XHRcdCBhdHRyaWJ1dGVzLnBvc2l0aW9uID09PSB1bmRlZmluZWQgfHxcblx0XHRcdCBhdHRyaWJ1dGVzLm5vcm1hbCA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHQgYXR0cmlidXRlcy51diA9PT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5CdWZmZXJHZW9tZXRyeTogTWlzc2luZyByZXF1aXJlZCBhdHRyaWJ1dGVzIChpbmRleCwgcG9zaXRpb24sIG5vcm1hbCBvciB1dikgaW4gQnVmZmVyR2VvbWV0cnkuY29tcHV0ZVRhbmdlbnRzKCknICk7XG5cdFx0XHRyZXR1cm47XG5cblx0XHR9XG5cblx0XHR2YXIgaW5kaWNlcyA9IGluZGV4LmFycmF5O1xuXHRcdHZhciBwb3NpdGlvbnMgPSBhdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5O1xuXHRcdHZhciBub3JtYWxzID0gYXR0cmlidXRlcy5ub3JtYWwuYXJyYXk7XG5cdFx0dmFyIHV2cyA9IGF0dHJpYnV0ZXMudXYuYXJyYXk7XG5cblx0XHR2YXIgblZlcnRpY2VzID0gcG9zaXRpb25zLmxlbmd0aCAvIDM7XG5cblx0XHRpZiAoIGF0dHJpYnV0ZXMudGFuZ2VudCA9PT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICd0YW5nZW50JywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggbmV3IEZsb2F0MzJBcnJheSggNCAqIG5WZXJ0aWNlcyApLCA0ICkgKTtcblxuXHRcdH1cblxuXHRcdHZhciB0YW5nZW50cyA9IGF0dHJpYnV0ZXMudGFuZ2VudC5hcnJheTtcblxuXHRcdHZhciB0YW4xID0gW10sIHRhbjIgPSBbXTtcblxuXHRcdGZvciAoIHZhciBrID0gMDsgayA8IG5WZXJ0aWNlczsgayArKyApIHtcblxuXHRcdFx0dGFuMVsgayBdID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblx0XHRcdHRhbjJbIGsgXSA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHR9XG5cblx0XHR2YXIgdkEgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRcdFx0dkIgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRcdFx0dkMgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXG5cdFx0XHR1dkEgPSBuZXcgVEhSRUUuVmVjdG9yMigpLFxuXHRcdFx0dXZCID0gbmV3IFRIUkVFLlZlY3RvcjIoKSxcblx0XHRcdHV2QyA9IG5ldyBUSFJFRS5WZWN0b3IyKCksXG5cblx0XHRcdHNkaXIgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRcdFx0dGRpciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHRmdW5jdGlvbiBoYW5kbGVUcmlhbmdsZSggYSwgYiwgYyApIHtcblxuXHRcdFx0dkEuZnJvbUFycmF5KCBwb3NpdGlvbnMsIGEgKiAzICk7XG5cdFx0XHR2Qi5mcm9tQXJyYXkoIHBvc2l0aW9ucywgYiAqIDMgKTtcblx0XHRcdHZDLmZyb21BcnJheSggcG9zaXRpb25zLCBjICogMyApO1xuXG5cdFx0XHR1dkEuZnJvbUFycmF5KCB1dnMsIGEgKiAyICk7XG5cdFx0XHR1dkIuZnJvbUFycmF5KCB1dnMsIGIgKiAyICk7XG5cdFx0XHR1dkMuZnJvbUFycmF5KCB1dnMsIGMgKiAyICk7XG5cblx0XHRcdHZhciB4MSA9IHZCLnggLSB2QS54O1xuXHRcdFx0dmFyIHgyID0gdkMueCAtIHZBLng7XG5cblx0XHRcdHZhciB5MSA9IHZCLnkgLSB2QS55O1xuXHRcdFx0dmFyIHkyID0gdkMueSAtIHZBLnk7XG5cblx0XHRcdHZhciB6MSA9IHZCLnogLSB2QS56O1xuXHRcdFx0dmFyIHoyID0gdkMueiAtIHZBLno7XG5cblx0XHRcdHZhciBzMSA9IHV2Qi54IC0gdXZBLng7XG5cdFx0XHR2YXIgczIgPSB1dkMueCAtIHV2QS54O1xuXG5cdFx0XHR2YXIgdDEgPSB1dkIueSAtIHV2QS55O1xuXHRcdFx0dmFyIHQyID0gdXZDLnkgLSB1dkEueTtcblxuXHRcdFx0dmFyIHIgPSAxLjAgLyAoIHMxICogdDIgLSBzMiAqIHQxICk7XG5cblx0XHRcdHNkaXIuc2V0KFxuXHRcdFx0XHQoIHQyICogeDEgLSB0MSAqIHgyICkgKiByLFxuXHRcdFx0XHQoIHQyICogeTEgLSB0MSAqIHkyICkgKiByLFxuXHRcdFx0XHQoIHQyICogejEgLSB0MSAqIHoyICkgKiByXG5cdFx0XHQpO1xuXG5cdFx0XHR0ZGlyLnNldChcblx0XHRcdFx0KCBzMSAqIHgyIC0gczIgKiB4MSApICogcixcblx0XHRcdFx0KCBzMSAqIHkyIC0gczIgKiB5MSApICogcixcblx0XHRcdFx0KCBzMSAqIHoyIC0gczIgKiB6MSApICogclxuXHRcdFx0KTtcblxuXHRcdFx0dGFuMVsgYSBdLmFkZCggc2RpciApO1xuXHRcdFx0dGFuMVsgYiBdLmFkZCggc2RpciApO1xuXHRcdFx0dGFuMVsgYyBdLmFkZCggc2RpciApO1xuXG5cdFx0XHR0YW4yWyBhIF0uYWRkKCB0ZGlyICk7XG5cdFx0XHR0YW4yWyBiIF0uYWRkKCB0ZGlyICk7XG5cdFx0XHR0YW4yWyBjIF0uYWRkKCB0ZGlyICk7XG5cblx0XHR9XG5cblx0XHR2YXIgZ3JvdXBzID0gZ2VvbWV0cnkuZ3JvdXBzO1xuXG5cdFx0aWYgKCBncm91cHMubGVuZ3RoID09PSAwICkge1xuXG5cdFx0XHRncm91cHMgPSBbIHtcblx0XHRcdFx0c3RhcnQ6IDAsXG5cdFx0XHRcdGNvdW50OiBpbmRpY2VzLmxlbmd0aFxuXHRcdFx0fSBdO1xuXG5cdFx0fVxuXG5cdFx0Zm9yICggdmFyIGogPSAwLCBqbCA9IGdyb3Vwcy5sZW5ndGg7IGogPCBqbDsgKysgaiApIHtcblxuXHRcdFx0dmFyIGdyb3VwID0gZ3JvdXBzWyBqIF07XG5cblx0XHRcdHZhciBzdGFydCA9IGdyb3VwLnN0YXJ0O1xuXHRcdFx0dmFyIGNvdW50ID0gZ3JvdXAuY291bnQ7XG5cblx0XHRcdGZvciAoIHZhciBpID0gc3RhcnQsIGlsID0gc3RhcnQgKyBjb3VudDsgaSA8IGlsOyBpICs9IDMgKSB7XG5cblx0XHRcdFx0aGFuZGxlVHJpYW5nbGUoXG5cdFx0XHRcdFx0aW5kaWNlc1sgaSArIDAgXSxcblx0XHRcdFx0XHRpbmRpY2VzWyBpICsgMSBdLFxuXHRcdFx0XHRcdGluZGljZXNbIGkgKyAyIF1cblx0XHRcdFx0KTtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0dmFyIHRtcCA9IG5ldyBUSFJFRS5WZWN0b3IzKCksIHRtcDIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHRcdHZhciBuID0gbmV3IFRIUkVFLlZlY3RvcjMoKSwgbjIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHRcdHZhciB3LCB0LCB0ZXN0O1xuXG5cdFx0ZnVuY3Rpb24gaGFuZGxlVmVydGV4KCB2ICkge1xuXG5cdFx0XHRuLmZyb21BcnJheSggbm9ybWFscywgdiAqIDMgKTtcblx0XHRcdG4yLmNvcHkoIG4gKTtcblxuXHRcdFx0dCA9IHRhbjFbIHYgXTtcblxuXHRcdFx0Ly8gR3JhbS1TY2htaWR0IG9ydGhvZ29uYWxpemVcblxuXHRcdFx0dG1wLmNvcHkoIHQgKTtcblx0XHRcdHRtcC5zdWIoIG4ubXVsdGlwbHlTY2FsYXIoIG4uZG90KCB0ICkgKSApLm5vcm1hbGl6ZSgpO1xuXG5cdFx0XHQvLyBDYWxjdWxhdGUgaGFuZGVkbmVzc1xuXG5cdFx0XHR0bXAyLmNyb3NzVmVjdG9ycyggbjIsIHQgKTtcblx0XHRcdHRlc3QgPSB0bXAyLmRvdCggdGFuMlsgdiBdICk7XG5cdFx0XHR3ID0gKCB0ZXN0IDwgMC4wICkgPyAtIDEuMCA6IDEuMDtcblxuXHRcdFx0dGFuZ2VudHNbIHYgKiA0IF0gPSB0bXAueDtcblx0XHRcdHRhbmdlbnRzWyB2ICogNCArIDEgXSA9IHRtcC55O1xuXHRcdFx0dGFuZ2VudHNbIHYgKiA0ICsgMiBdID0gdG1wLno7XG5cdFx0XHR0YW5nZW50c1sgdiAqIDQgKyAzIF0gPSB3O1xuXG5cdFx0fVxuXG5cdFx0Zm9yICggdmFyIGogPSAwLCBqbCA9IGdyb3Vwcy5sZW5ndGg7IGogPCBqbDsgKysgaiApIHtcblxuXHRcdFx0dmFyIGdyb3VwID0gZ3JvdXBzWyBqIF07XG5cblx0XHRcdHZhciBzdGFydCA9IGdyb3VwLnN0YXJ0O1xuXHRcdFx0dmFyIGNvdW50ID0gZ3JvdXAuY291bnQ7XG5cblx0XHRcdGZvciAoIHZhciBpID0gc3RhcnQsIGlsID0gc3RhcnQgKyBjb3VudDsgaSA8IGlsOyBpICs9IDMgKSB7XG5cblx0XHRcdFx0aGFuZGxlVmVydGV4KCBpbmRpY2VzWyBpICsgMCBdICk7XG5cdFx0XHRcdGhhbmRsZVZlcnRleCggaW5kaWNlc1sgaSArIDEgXSApO1xuXHRcdFx0XHRoYW5kbGVWZXJ0ZXgoIGluZGljZXNbIGkgKyAyIF0gKTtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdH0sXG5cblx0LyoqXG5cdCAqIEBwYXJhbSAge0FycmF5PFRIUkVFLkJ1ZmZlckdlb21ldHJ5Pn0gZ2VvbWV0cmllc1xuXHQgKiBAcmV0dXJuIHtUSFJFRS5CdWZmZXJHZW9tZXRyeX1cblx0ICovXG5cdG1lcmdlQnVmZmVyR2VvbWV0cmllczogZnVuY3Rpb24gKCBnZW9tZXRyaWVzLCB1c2VHcm91cHMgKSB7XG5cblx0XHR2YXIgaXNJbmRleGVkID0gZ2VvbWV0cmllc1sgMCBdLmluZGV4ICE9PSBudWxsO1xuXG5cdFx0dmFyIGF0dHJpYnV0ZXNVc2VkID0gbmV3IFNldCggT2JqZWN0LmtleXMoIGdlb21ldHJpZXNbIDAgXS5hdHRyaWJ1dGVzICkgKTtcblx0XHR2YXIgbW9ycGhBdHRyaWJ1dGVzVXNlZCA9IG5ldyBTZXQoIE9iamVjdC5rZXlzKCBnZW9tZXRyaWVzWyAwIF0ubW9ycGhBdHRyaWJ1dGVzICkgKTtcblxuXHRcdHZhciBhdHRyaWJ1dGVzID0ge307XG5cdFx0dmFyIG1vcnBoQXR0cmlidXRlcyA9IHt9O1xuXG5cdFx0dmFyIG1lcmdlZEdlb21ldHJ5ID0gbmV3IFRIUkVFLkJ1ZmZlckdlb21ldHJ5KCk7XG5cblx0XHR2YXIgb2Zmc2V0ID0gMDtcblxuXHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGdlb21ldHJpZXMubGVuZ3RoOyArKyBpICkge1xuXG5cdFx0XHR2YXIgZ2VvbWV0cnkgPSBnZW9tZXRyaWVzWyBpIF07XG5cblx0XHRcdC8vIGVuc3VyZSB0aGF0IGFsbCBnZW9tZXRyaWVzIGFyZSBpbmRleGVkLCBvciBub25lXG5cblx0XHRcdGlmICggaXNJbmRleGVkICE9PSAoIGdlb21ldHJ5LmluZGV4ICE9PSBudWxsICkgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0Ly8gZ2F0aGVyIGF0dHJpYnV0ZXMsIGV4aXQgZWFybHkgaWYgdGhleSdyZSBkaWZmZXJlbnRcblxuXHRcdFx0Zm9yICggdmFyIG5hbWUgaW4gZ2VvbWV0cnkuYXR0cmlidXRlcyApIHtcblxuXHRcdFx0XHRpZiAoICFhdHRyaWJ1dGVzVXNlZC5oYXMoIG5hbWUgKSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRcdGlmICggYXR0cmlidXRlc1sgbmFtZSBdID09PSB1bmRlZmluZWQgKSBhdHRyaWJ1dGVzWyBuYW1lIF0gPSBbXTtcblxuXHRcdFx0XHRhdHRyaWJ1dGVzWyBuYW1lIF0ucHVzaCggZ2VvbWV0cnkuYXR0cmlidXRlc1sgbmFtZSBdICk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gZ2F0aGVyIG1vcnBoIGF0dHJpYnV0ZXMsIGV4aXQgZWFybHkgaWYgdGhleSdyZSBkaWZmZXJlbnRcblxuXHRcdFx0Zm9yICggdmFyIG5hbWUgaW4gZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzICkge1xuXG5cdFx0XHRcdGlmICggIW1vcnBoQXR0cmlidXRlc1VzZWQuaGFzKCBuYW1lICkgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0XHRpZiAoIG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdID09PSB1bmRlZmluZWQgKSBtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXSA9IFtdO1xuXG5cdFx0XHRcdG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdLnB1c2goIGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlc1sgbmFtZSBdICk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gZ2F0aGVyIC51c2VyRGF0YVxuXG5cdFx0XHRtZXJnZWRHZW9tZXRyeS51c2VyRGF0YS5tZXJnZWRVc2VyRGF0YSA9IG1lcmdlZEdlb21ldHJ5LnVzZXJEYXRhLm1lcmdlZFVzZXJEYXRhIHx8IFtdO1xuXHRcdFx0bWVyZ2VkR2VvbWV0cnkudXNlckRhdGEubWVyZ2VkVXNlckRhdGEucHVzaCggZ2VvbWV0cnkudXNlckRhdGEgKTtcblxuXHRcdFx0aWYgKCB1c2VHcm91cHMgKSB7XG5cblx0XHRcdFx0dmFyIGNvdW50O1xuXG5cdFx0XHRcdGlmICggaXNJbmRleGVkICkge1xuXG5cdFx0XHRcdFx0Y291bnQgPSBnZW9tZXRyeS5pbmRleC5jb3VudDtcblxuXHRcdFx0XHR9IGVsc2UgaWYgKCBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uICE9PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdFx0XHRjb3VudCA9IGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uY291bnQ7XG5cblx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRtZXJnZWRHZW9tZXRyeS5hZGRHcm91cCggb2Zmc2V0LCBjb3VudCwgaSApO1xuXG5cdFx0XHRcdG9mZnNldCArPSBjb3VudDtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0Ly8gbWVyZ2UgaW5kaWNlc1xuXG5cdFx0aWYgKCBpc0luZGV4ZWQgKSB7XG5cblx0XHRcdHZhciBpbmRleE9mZnNldCA9IDA7XG5cdFx0XHR2YXIgaW5kZXhMaXN0ID0gW107XG5cblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGdlb21ldHJpZXMubGVuZ3RoOyArKyBpICkge1xuXG5cdFx0XHRcdHZhciBpbmRleCA9IGdlb21ldHJpZXNbIGkgXS5pbmRleDtcblxuXHRcdFx0XHRpZiAoIGluZGV4T2Zmc2V0ID4gMCApIHtcblxuXHRcdFx0XHRcdGluZGV4ID0gaW5kZXguY2xvbmUoKTtcblxuXHRcdFx0XHRcdGZvciAoIHZhciBqID0gMDsgaiA8IGluZGV4LmNvdW50OyArKyBqICkge1xuXG5cdFx0XHRcdFx0XHRpbmRleC5zZXRYKCBqLCBpbmRleC5nZXRYKCBqICkgKyBpbmRleE9mZnNldCApO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpbmRleExpc3QucHVzaCggaW5kZXggKTtcblx0XHRcdFx0aW5kZXhPZmZzZXQgKz0gZ2VvbWV0cmllc1sgaSBdLmF0dHJpYnV0ZXMucG9zaXRpb24uY291bnQ7XG5cblx0XHRcdH1cblxuXHRcdFx0dmFyIG1lcmdlZEluZGV4ID0gdGhpcy5tZXJnZUJ1ZmZlckF0dHJpYnV0ZXMoIGluZGV4TGlzdCApO1xuXG5cdFx0XHRpZiAoICFtZXJnZWRJbmRleCApIHJldHVybiBudWxsO1xuXG5cdFx0XHRtZXJnZWRHZW9tZXRyeS5pbmRleCA9IG1lcmdlZEluZGV4O1xuXG5cdFx0fVxuXG5cdFx0Ly8gbWVyZ2UgYXR0cmlidXRlc1xuXG5cdFx0Zm9yICggdmFyIG5hbWUgaW4gYXR0cmlidXRlcyApIHtcblxuXHRcdFx0dmFyIG1lcmdlZEF0dHJpYnV0ZSA9IHRoaXMubWVyZ2VCdWZmZXJBdHRyaWJ1dGVzKCBhdHRyaWJ1dGVzWyBuYW1lIF0gKTtcblxuXHRcdFx0aWYgKCAhIG1lcmdlZEF0dHJpYnV0ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRtZXJnZWRHZW9tZXRyeS5hZGRBdHRyaWJ1dGUoIG5hbWUsIG1lcmdlZEF0dHJpYnV0ZSApO1xuXG5cdFx0fVxuXG5cdFx0Ly8gbWVyZ2UgbW9ycGggYXR0cmlidXRlc1xuXG5cdFx0Zm9yICggdmFyIG5hbWUgaW4gbW9ycGhBdHRyaWJ1dGVzICkge1xuXG5cdFx0XHR2YXIgbnVtTW9ycGhUYXJnZXRzID0gbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF1bIDAgXS5sZW5ndGg7XG5cblx0XHRcdGlmICggbnVtTW9ycGhUYXJnZXRzID09PSAwICkgYnJlYWs7XG5cblx0XHRcdG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcyA9IG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcyB8fCB7fTtcblx0XHRcdG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlc1sgbmFtZSBdID0gW107XG5cblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IG51bU1vcnBoVGFyZ2V0czsgKysgaSApIHtcblxuXHRcdFx0XHR2YXIgbW9ycGhBdHRyaWJ1dGVzVG9NZXJnZSA9IFtdO1xuXG5cdFx0XHRcdGZvciAoIHZhciBqID0gMDsgaiA8IG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdLmxlbmd0aDsgKysgaiApIHtcblxuXHRcdFx0XHRcdG1vcnBoQXR0cmlidXRlc1RvTWVyZ2UucHVzaCggbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF1bIGogXVsgaSBdICk7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBtZXJnZWRNb3JwaEF0dHJpYnV0ZSA9IHRoaXMubWVyZ2VCdWZmZXJBdHRyaWJ1dGVzKCBtb3JwaEF0dHJpYnV0ZXNUb01lcmdlICk7XG5cblx0XHRcdFx0aWYgKCAhbWVyZ2VkTW9ycGhBdHRyaWJ1dGUgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0XHRtZXJnZWRHZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXS5wdXNoKCBtZXJnZWRNb3JwaEF0dHJpYnV0ZSApO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gbWVyZ2VkR2VvbWV0cnk7XG5cblx0fSxcblxuXHQvKipcblx0ICogQHBhcmFtIHtBcnJheTxUSFJFRS5CdWZmZXJBdHRyaWJ1dGU+fSBhdHRyaWJ1dGVzXG5cdCAqIEByZXR1cm4ge1RIUkVFLkJ1ZmZlckF0dHJpYnV0ZX1cblx0ICovXG5cdG1lcmdlQnVmZmVyQXR0cmlidXRlczogZnVuY3Rpb24gKCBhdHRyaWJ1dGVzICkge1xuXG5cdFx0dmFyIFR5cGVkQXJyYXk7XG5cdFx0dmFyIGl0ZW1TaXplO1xuXHRcdHZhciBub3JtYWxpemVkO1xuXHRcdHZhciBhcnJheUxlbmd0aCA9IDA7XG5cblx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgKysgaSApIHtcblxuXHRcdFx0dmFyIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXNbIGkgXTtcblxuXHRcdFx0aWYgKCBhdHRyaWJ1dGUuaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRpZiAoIFR5cGVkQXJyYXkgPT09IHVuZGVmaW5lZCApIFR5cGVkQXJyYXkgPSBhdHRyaWJ1dGUuYXJyYXkuY29uc3RydWN0b3I7XG5cdFx0XHRpZiAoIFR5cGVkQXJyYXkgIT09IGF0dHJpYnV0ZS5hcnJheS5jb25zdHJ1Y3RvciApIHJldHVybiBudWxsO1xuXG5cdFx0XHRpZiAoIGl0ZW1TaXplID09PSB1bmRlZmluZWQgKSBpdGVtU2l6ZSA9IGF0dHJpYnV0ZS5pdGVtU2l6ZTtcblx0XHRcdGlmICggaXRlbVNpemUgIT09IGF0dHJpYnV0ZS5pdGVtU2l6ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRpZiAoIG5vcm1hbGl6ZWQgPT09IHVuZGVmaW5lZCApIG5vcm1hbGl6ZWQgPSBhdHRyaWJ1dGUubm9ybWFsaXplZDtcblx0XHRcdGlmICggbm9ybWFsaXplZCAhPT0gYXR0cmlidXRlLm5vcm1hbGl6ZWQgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0YXJyYXlMZW5ndGggKz0gYXR0cmlidXRlLmFycmF5Lmxlbmd0aDtcblxuXHRcdH1cblxuXHRcdHZhciBhcnJheSA9IG5ldyBUeXBlZEFycmF5KCBhcnJheUxlbmd0aCApO1xuXHRcdHZhciBvZmZzZXQgPSAwO1xuXG5cdFx0Zm9yICggdmFyIGogPSAwOyBqIDwgYXR0cmlidXRlcy5sZW5ndGg7ICsrIGogKSB7XG5cblx0XHRcdGFycmF5LnNldCggYXR0cmlidXRlc1sgaiBdLmFycmF5LCBvZmZzZXQgKTtcblxuXHRcdFx0b2Zmc2V0ICs9IGF0dHJpYnV0ZXNbIGogXS5hcnJheS5sZW5ndGg7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggYXJyYXksIGl0ZW1TaXplLCBub3JtYWxpemVkICk7XG5cblx0fVxuXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vdmVuZG9yL0J1ZmZlckdlb21ldHJ5VXRpbHMuanMiLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG5cbnZhciB1dGlsID0gcmVxdWlyZSgnQGZpcmViYXNlL3V0aWwnKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBjb250YWlucyA9IGZ1bmN0aW9uIChvYmosIGtleSkge1xyXG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7XHJcbn07XHJcbnZhciBERUZBVUxUX0VOVFJZX05BTUUgPSAnW0RFRkFVTFRdJztcclxuLy8gQW4gYXJyYXkgdG8gY2FwdHVyZSBsaXN0ZW5lcnMgYmVmb3JlIHRoZSB0cnVlIGF1dGggZnVuY3Rpb25zXHJcbi8vIGV4aXN0XHJcbnZhciB0b2tlbkxpc3RlbmVycyA9IFtdO1xyXG4vKipcclxuICogR2xvYmFsIGNvbnRleHQgb2JqZWN0IGZvciBhIGNvbGxlY3Rpb24gb2Ygc2VydmljZXMgdXNpbmdcclxuICogYSBzaGFyZWQgYXV0aGVudGljYXRpb24gc3RhdGUuXHJcbiAqL1xyXG52YXIgRmlyZWJhc2VBcHBJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyZWJhc2VBcHBJbXBsKG9wdGlvbnMsIGNvbmZpZywgZmlyZWJhc2VfKSB7XHJcbiAgICAgICAgdGhpcy5maXJlYmFzZV8gPSBmaXJlYmFzZV87XHJcbiAgICAgICAgdGhpcy5pc0RlbGV0ZWRfID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlc18gPSB7fTtcclxuICAgICAgICB0aGlzLm5hbWVfID0gY29uZmlnLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID1cclxuICAgICAgICAgICAgY29uZmlnLmF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCB8fCBmYWxzZTtcclxuICAgICAgICB0aGlzLm9wdGlvbnNfID0gdXRpbC5kZWVwQ29weShvcHRpb25zKTtcclxuICAgICAgICB0aGlzLklOVEVSTkFMID0ge1xyXG4gICAgICAgICAgICBnZXRVaWQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG51bGw7IH0sXHJcbiAgICAgICAgICAgIGdldFRva2VuOiBmdW5jdGlvbiAoKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7IH0sXHJcbiAgICAgICAgICAgIGFkZEF1dGhUb2tlbkxpc3RlbmVyOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRva2VuTGlzdGVuZXJzLnB1c2goY2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIGNhbGxiYWNrIGlzIGNhbGxlZCwgYXN5bmNocm9ub3VzbHksIGluIHRoZSBhYnNlbmNlIG9mIHRoZSBhdXRoIG1vZHVsZVxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBjYWxsYmFjayhudWxsKTsgfSwgMCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRva2VuTGlzdGVuZXJzID0gdG9rZW5MaXN0ZW5lcnMuZmlsdGVyKGZ1bmN0aW9uIChsaXN0ZW5lcikgeyByZXR1cm4gbGlzdGVuZXIgIT09IGNhbGxiYWNrOyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZSwgXCJhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkXygpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWRfKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9IHZhbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLCBcIm5hbWVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkXygpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYW1lXztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLCBcIm9wdGlvbnNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkXygpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zXztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmNoZWNrRGVzdHJveWVkXygpO1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5maXJlYmFzZV8uSU5URVJOQUwucmVtb3ZlQXBwKF90aGlzLm5hbWVfKTtcclxuICAgICAgICAgICAgdmFyIHNlcnZpY2VzID0gW107XHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKF90aGlzLnNlcnZpY2VzXykuZm9yRWFjaChmdW5jdGlvbiAoc2VydmljZUtleSkge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoX3RoaXMuc2VydmljZXNfW3NlcnZpY2VLZXldKS5mb3JFYWNoKGZ1bmN0aW9uIChpbnN0YW5jZUtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlcnZpY2VzLnB1c2goX3RoaXMuc2VydmljZXNfW3NlcnZpY2VLZXldW2luc3RhbmNlS2V5XSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChzZXJ2aWNlcy5tYXAoZnVuY3Rpb24gKHNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLklOVEVSTkFMLmRlbGV0ZSgpO1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5pc0RlbGV0ZWRfID0gdHJ1ZTtcclxuICAgICAgICAgICAgX3RoaXMuc2VydmljZXNfID0ge307XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYSBzZXJ2aWNlIGluc3RhbmNlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGFwcCAoY3JlYXRpbmcgaXRcclxuICAgICAqIG9uIGRlbWFuZCksIGlkZW50aWZpZWQgYnkgdGhlIHBhc3NlZCBpbnN0YW5jZUlkZW50aWZpZXIuXHJcbiAgICAgKlxyXG4gICAgICogTk9URTogQ3VycmVudGx5IHN0b3JhZ2UgaXMgdGhlIG9ubHkgb25lIHRoYXQgaXMgbGV2ZXJhZ2luZyB0aGlzXHJcbiAgICAgKiBmdW5jdGlvbmFsaXR5LiBUaGV5IGludm9rZSBpdCBieSBjYWxsaW5nOlxyXG4gICAgICpcclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIGZpcmViYXNlLmFwcCgpLnN0b3JhZ2UoJ1NUT1JBR0UgQlVDS0VUIElEJylcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIFRoZSBzZXJ2aWNlIG5hbWUgaXMgcGFzc2VkIHRvIHRoaXMgYWxyZWFkeVxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUuX2dldFNlcnZpY2UgPSBmdW5jdGlvbiAobmFtZSwgaW5zdGFuY2VJZGVudGlmaWVyKSB7XHJcbiAgICAgICAgaWYgKGluc3RhbmNlSWRlbnRpZmllciA9PT0gdm9pZCAwKSB7IGluc3RhbmNlSWRlbnRpZmllciA9IERFRkFVTFRfRU5UUllfTkFNRTsgfVxyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWRfKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNlcnZpY2VzX1tuYW1lXSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VzX1tuYW1lXSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuc2VydmljZXNfW25hbWVdW2luc3RhbmNlSWRlbnRpZmllcl0pIHtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIElmIGEgY3VzdG9tIGluc3RhbmNlIGhhcyBiZWVuIGRlZmluZWQgKGkuZS4gbm90ICdbREVGQVVMVF0nKVxyXG4gICAgICAgICAgICAgKiB0aGVuIHdlIHdpbGwgcGFzcyB0aGF0IGluc3RhbmNlIG9uLCBvdGhlcndpc2Ugd2UgcGFzcyBgbnVsbGBcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHZhciBpbnN0YW5jZVNwZWNpZmllciA9IGluc3RhbmNlSWRlbnRpZmllciAhPT0gREVGQVVMVF9FTlRSWV9OQU1FXHJcbiAgICAgICAgICAgICAgICA/IGluc3RhbmNlSWRlbnRpZmllclxyXG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0gdGhpcy5maXJlYmFzZV8uSU5URVJOQUwuZmFjdG9yaWVzW25hbWVdKHRoaXMsIHRoaXMuZXh0ZW5kQXBwLmJpbmQodGhpcyksIGluc3RhbmNlU3BlY2lmaWVyKTtcclxuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlc19bbmFtZV1baW5zdGFuY2VJZGVudGlmaWVyXSA9IHNlcnZpY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnNlcnZpY2VzX1tuYW1lXVtpbnN0YW5jZUlkZW50aWZpZXJdO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGJhY2sgZnVuY3Rpb24gdXNlZCB0byBleHRlbmQgYW4gQXBwIGluc3RhbmNlIGF0IHRoZSB0aW1lXHJcbiAgICAgKiBvZiBzZXJ2aWNlIGluc3RhbmNlIGNyZWF0aW9uLlxyXG4gICAgICovXHJcbiAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLmV4dGVuZEFwcCA9IGZ1bmN0aW9uIChwcm9wcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gQ29weSB0aGUgb2JqZWN0IG9udG8gdGhlIEZpcmViYXNlQXBwSW1wbCBwcm90b3R5cGVcclxuICAgICAgICB1dGlsLmRlZXBFeHRlbmQodGhpcywgcHJvcHMpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIElmIHRoZSBhcHAgaGFzIG92ZXJ3cml0dGVuIHRoZSBhZGRBdXRoVG9rZW5MaXN0ZW5lciBzdHViLCBmb3J3YXJkXHJcbiAgICAgICAgICogdGhlIGFjdGl2ZSB0b2tlbiBsaXN0ZW5lcnMgb24gdG8gdGhlIHRydWUgZnhuLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogVE9ETzogVGhpcyBmdW5jdGlvbiBpcyByZXF1aXJlZCBkdWUgdG8gb3VyIGN1cnJlbnQgbW9kdWxlXHJcbiAgICAgICAgICogc3RydWN0dXJlLiBPbmNlIHdlIGFyZSBhYmxlIHRvIHJlbHkgc3RyaWN0bHkgdXBvbiBhIHNpbmdsZSBtb2R1bGVcclxuICAgICAgICAgKiBpbXBsZW1lbnRhdGlvbiwgdGhpcyBjb2RlIHNob3VsZCBiZSByZWZhY3RvcmVkIGFuZCBBdXRoIHNob3VsZFxyXG4gICAgICAgICAqIHByb3ZpZGUgdGhlc2Ugc3R1YnMgYW5kIHRoZSB1cGdyYWRlIGxvZ2ljXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaWYgKHByb3BzLklOVEVSTkFMICYmIHByb3BzLklOVEVSTkFMLmFkZEF1dGhUb2tlbkxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgIHRva2VuTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5JTlRFUk5BTC5hZGRBdXRoVG9rZW5MaXN0ZW5lcihsaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0b2tlbkxpc3RlbmVycyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgZnVuY3Rpb24gd2lsbCB0aHJvdyBhbiBFcnJvciBpZiB0aGUgQXBwIGhhcyBhbHJlYWR5IGJlZW4gZGVsZXRlZCAtXHJcbiAgICAgKiB1c2UgYmVmb3JlIHBlcmZvcm1pbmcgQVBJIGFjdGlvbnMgb24gdGhlIEFwcC5cclxuICAgICAqL1xyXG4gICAgRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZS5jaGVja0Rlc3Ryb3llZF8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNEZWxldGVkXykge1xyXG4gICAgICAgICAgICBlcnJvcignYXBwLWRlbGV0ZWQnLCB7IG5hbWU6IHRoaXMubmFtZV8gfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBGaXJlYmFzZUFwcEltcGw7XHJcbn0oKSk7XHJcbi8vIFByZXZlbnQgZGVhZC1jb2RlIGVsaW1pbmF0aW9uIG9mIHRoZXNlIG1ldGhvZHMgdy9vIGludmFsaWQgcHJvcGVydHlcclxuLy8gY29weWluZy5cclxuKEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUubmFtZSAmJiBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLm9wdGlvbnMpIHx8XHJcbiAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLmRlbGV0ZSB8fFxyXG4gICAgY29uc29sZS5sb2coJ2RjJyk7XHJcbi8qKlxyXG4gKiBSZXR1cm4gYSBmaXJlYmFzZSBuYW1lc3BhY2Ugb2JqZWN0LlxyXG4gKlxyXG4gKiBJbiBwcm9kdWN0aW9uLCB0aGlzIHdpbGwgYmUgY2FsbGVkIGV4YWN0bHkgb25jZSBhbmQgdGhlIHJlc3VsdFxyXG4gKiBhc3NpZ25lZCB0byB0aGUgJ2ZpcmViYXNlJyBnbG9iYWwuICBJdCBtYXkgYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzXHJcbiAqIGluIHVuaXQgdGVzdHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVGaXJlYmFzZU5hbWVzcGFjZSgpIHtcclxuICAgIHZhciBhcHBzXyA9IHt9O1xyXG4gICAgdmFyIGZhY3RvcmllcyA9IHt9O1xyXG4gICAgdmFyIGFwcEhvb2tzID0ge307XHJcbiAgICAvLyBBIG5hbWVzcGFjZSBpcyBhIHBsYWluIEphdmFTY3JpcHQgT2JqZWN0LlxyXG4gICAgdmFyIG5hbWVzcGFjZSA9IHtcclxuICAgICAgICAvLyBIYWNrIHRvIHByZXZlbnQgQmFiZWwgZnJvbSBtb2RpZnlpbmcgdGhlIG9iamVjdCByZXR1cm5lZFxyXG4gICAgICAgIC8vIGFzIHRoZSBmaXJlYmFzZSBuYW1lc3BhY2UuXHJcbiAgICAgICAgX19lc01vZHVsZTogdHJ1ZSxcclxuICAgICAgICBpbml0aWFsaXplQXBwOiBpbml0aWFsaXplQXBwLFxyXG4gICAgICAgIGFwcDogYXBwLFxyXG4gICAgICAgIGFwcHM6IG51bGwsXHJcbiAgICAgICAgUHJvbWlzZTogUHJvbWlzZSxcclxuICAgICAgICBTREtfVkVSU0lPTjogJzUuNS4wJyxcclxuICAgICAgICBJTlRFUk5BTDoge1xyXG4gICAgICAgICAgICByZWdpc3RlclNlcnZpY2U6IHJlZ2lzdGVyU2VydmljZSxcclxuICAgICAgICAgICAgY3JlYXRlRmlyZWJhc2VOYW1lc3BhY2U6IGNyZWF0ZUZpcmViYXNlTmFtZXNwYWNlLFxyXG4gICAgICAgICAgICBleHRlbmROYW1lc3BhY2U6IGV4dGVuZE5hbWVzcGFjZSxcclxuICAgICAgICAgICAgY3JlYXRlU3Vic2NyaWJlOiB1dGlsLmNyZWF0ZVN1YnNjcmliZSxcclxuICAgICAgICAgICAgRXJyb3JGYWN0b3J5OiB1dGlsLkVycm9yRmFjdG9yeSxcclxuICAgICAgICAgICAgcmVtb3ZlQXBwOiByZW1vdmVBcHAsXHJcbiAgICAgICAgICAgIGZhY3RvcmllczogZmFjdG9yaWVzLFxyXG4gICAgICAgICAgICB1c2VBc1NlcnZpY2U6IHVzZUFzU2VydmljZSxcclxuICAgICAgICAgICAgUHJvbWlzZTogUHJvbWlzZSxcclxuICAgICAgICAgICAgZGVlcEV4dGVuZDogdXRpbC5kZWVwRXh0ZW5kXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIEluamVjdCBhIGNpcmN1bGFyIGRlZmF1bHQgZXhwb3J0IHRvIGFsbG93IEJhYmVsIHVzZXJzIHdobyB3ZXJlIHByZXZpb3VzbHlcclxuICAgIC8vIHVzaW5nOlxyXG4gICAgLy9cclxuICAgIC8vICAgaW1wb3J0IGZpcmViYXNlIGZyb20gJ2ZpcmViYXNlJztcclxuICAgIC8vICAgd2hpY2ggYmVjb21lczogdmFyIGZpcmViYXNlID0gcmVxdWlyZSgnZmlyZWJhc2UnKS5kZWZhdWx0O1xyXG4gICAgLy9cclxuICAgIC8vIGluc3RlYWQgb2ZcclxuICAgIC8vXHJcbiAgICAvLyAgIGltcG9ydCAqIGFzIGZpcmViYXNlIGZyb20gJ2ZpcmViYXNlJztcclxuICAgIC8vICAgd2hpY2ggYmVjb21lczogdmFyIGZpcmViYXNlID0gcmVxdWlyZSgnZmlyZWJhc2UnKTtcclxuICAgIHV0aWwucGF0Y2hQcm9wZXJ0eShuYW1lc3BhY2UsICdkZWZhdWx0JywgbmFtZXNwYWNlKTtcclxuICAgIC8vIGZpcmViYXNlLmFwcHMgaXMgYSByZWFkLW9ubHkgZ2V0dGVyLlxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5hbWVzcGFjZSwgJ2FwcHMnLCB7XHJcbiAgICAgICAgZ2V0OiBnZXRBcHBzXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIGJ5IEFwcC5kZWxldGUoKSAtIGJ1dCBiZWZvcmUgYW55IHNlcnZpY2VzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQXBwXHJcbiAgICAgKiBhcmUgZGVsZXRlZC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcmVtb3ZlQXBwKG5hbWUpIHtcclxuICAgICAgICB2YXIgYXBwID0gYXBwc19bbmFtZV07XHJcbiAgICAgICAgY2FsbEFwcEhvb2tzKGFwcCwgJ2RlbGV0ZScpO1xyXG4gICAgICAgIGRlbGV0ZSBhcHBzX1tuYW1lXTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBBcHAgb2JqZWN0IGZvciBhIGdpdmVuIG5hbWUgKG9yIERFRkFVTFQpLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBhcHAobmFtZSkge1xyXG4gICAgICAgIG5hbWUgPSBuYW1lIHx8IERFRkFVTFRfRU5UUllfTkFNRTtcclxuICAgICAgICBpZiAoIWNvbnRhaW5zKGFwcHNfLCBuYW1lKSkge1xyXG4gICAgICAgICAgICBlcnJvcignbm8tYXBwJywgeyBuYW1lOiBuYW1lIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXBwc19bbmFtZV07XHJcbiAgICB9XHJcbiAgICB1dGlsLnBhdGNoUHJvcGVydHkoYXBwLCAnQXBwJywgRmlyZWJhc2VBcHBJbXBsKTtcclxuICAgIGZ1bmN0aW9uIGluaXRpYWxpemVBcHAob3B0aW9ucywgcmF3Q29uZmlnKSB7XHJcbiAgICAgICAgaWYgKHJhd0NvbmZpZyA9PT0gdm9pZCAwKSB7IHJhd0NvbmZpZyA9IHt9OyB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiByYXdDb25maWcgIT09ICdvYmplY3QnIHx8IHJhd0NvbmZpZyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgbmFtZV8xID0gcmF3Q29uZmlnO1xyXG4gICAgICAgICAgICByYXdDb25maWcgPSB7IG5hbWU6IG5hbWVfMSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY29uZmlnID0gcmF3Q29uZmlnO1xyXG4gICAgICAgIGlmIChjb25maWcubmFtZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5uYW1lID0gREVGQVVMVF9FTlRSWV9OQU1FO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbmFtZSA9IGNvbmZpZy5uYW1lO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycgfHwgIW5hbWUpIHtcclxuICAgICAgICAgICAgZXJyb3IoJ2JhZC1hcHAtbmFtZScsIHsgbmFtZTogbmFtZSArICcnIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29udGFpbnMoYXBwc18sIG5hbWUpKSB7XHJcbiAgICAgICAgICAgIGVycm9yKCdkdXBsaWNhdGUtYXBwJywgeyBuYW1lOiBuYW1lIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYXBwID0gbmV3IEZpcmViYXNlQXBwSW1wbChvcHRpb25zLCBjb25maWcsIG5hbWVzcGFjZSk7XHJcbiAgICAgICAgYXBwc19bbmFtZV0gPSBhcHA7XHJcbiAgICAgICAgY2FsbEFwcEhvb2tzKGFwcCwgJ2NyZWF0ZScpO1xyXG4gICAgICAgIHJldHVybiBhcHA7XHJcbiAgICB9XHJcbiAgICAvKlxyXG4gICAgICogUmV0dXJuIGFuIGFycmF5IG9mIGFsbCB0aGUgbm9uLWRlbGV0ZWQgRmlyZWJhc2VBcHBzLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBnZXRBcHBzKCkge1xyXG4gICAgICAgIC8vIE1ha2UgYSBjb3B5IHNvIGNhbGxlciBjYW5ub3QgbXV0YXRlIHRoZSBhcHBzIGxpc3QuXHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGFwcHNfKS5tYXAoZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIGFwcHNfW25hbWVdOyB9KTtcclxuICAgIH1cclxuICAgIC8qXHJcbiAgICAgKiBSZWdpc3RlciBhIEZpcmViYXNlIFNlcnZpY2UuXHJcbiAgICAgKlxyXG4gICAgICogZmlyZWJhc2UuSU5URVJOQUwucmVnaXN0ZXJTZXJ2aWNlKClcclxuICAgICAqXHJcbiAgICAgKiBUT0RPOiBJbXBsZW1lbnQgc2VydmljZVByb3BlcnRpZXMuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHJlZ2lzdGVyU2VydmljZShuYW1lLCBjcmVhdGVTZXJ2aWNlLCBzZXJ2aWNlUHJvcGVydGllcywgYXBwSG9vaywgYWxsb3dNdWx0aXBsZUluc3RhbmNlcykge1xyXG4gICAgICAgIC8vIENhbm5vdCByZS1yZWdpc3RlciBhIHNlcnZpY2UgdGhhdCBhbHJlYWR5IGV4aXN0c1xyXG4gICAgICAgIGlmIChmYWN0b3JpZXNbbmFtZV0pIHtcclxuICAgICAgICAgICAgZXJyb3IoJ2R1cGxpY2F0ZS1zZXJ2aWNlJywgeyBuYW1lOiBuYW1lIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDYXB0dXJlIHRoZSBzZXJ2aWNlIGZhY3RvcnkgZm9yIGxhdGVyIHNlcnZpY2UgaW5zdGFudGlhdGlvblxyXG4gICAgICAgIGZhY3Rvcmllc1tuYW1lXSA9IGNyZWF0ZVNlcnZpY2U7XHJcbiAgICAgICAgLy8gQ2FwdHVyZSB0aGUgYXBwSG9vaywgaWYgcGFzc2VkXHJcbiAgICAgICAgaWYgKGFwcEhvb2spIHtcclxuICAgICAgICAgICAgYXBwSG9va3NbbmFtZV0gPSBhcHBIb29rO1xyXG4gICAgICAgICAgICAvLyBSdW4gdGhlICoqbmV3KiogYXBwIGhvb2sgb24gYWxsIGV4aXN0aW5nIGFwcHNcclxuICAgICAgICAgICAgZ2V0QXBwcygpLmZvckVhY2goZnVuY3Rpb24gKGFwcCkge1xyXG4gICAgICAgICAgICAgICAgYXBwSG9vaygnY3JlYXRlJywgYXBwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRoZSBTZXJ2aWNlIG5hbWVzcGFjZSBpcyBhbiBhY2Nlc3NvciBmdW5jdGlvbiAuLi5cclxuICAgICAgICB2YXIgc2VydmljZU5hbWVzcGFjZSA9IGZ1bmN0aW9uIChhcHBBcmcpIHtcclxuICAgICAgICAgICAgaWYgKGFwcEFyZyA9PT0gdm9pZCAwKSB7IGFwcEFyZyA9IGFwcCgpOyB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXBwQXJnW25hbWVdICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJbnZhbGlkIGFyZ3VtZW50LlxyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBoYXBwZW5zIGluIHRoZSBmb2xsb3dpbmcgY2FzZTogZmlyZWJhc2Uuc3RvcmFnZSgnZ3M6LycpXHJcbiAgICAgICAgICAgICAgICBlcnJvcignaW52YWxpZC1hcHAtYXJndW1lbnQnLCB7IG5hbWU6IG5hbWUgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gRm9yd2FyZCBzZXJ2aWNlIGluc3RhbmNlIGxvb2t1cCB0byB0aGUgRmlyZWJhc2VBcHAuXHJcbiAgICAgICAgICAgIHJldHVybiBhcHBBcmdbbmFtZV0oKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIC4uLiBhbmQgYSBjb250YWluZXIgZm9yIHNlcnZpY2UtbGV2ZWwgcHJvcGVydGllcy5cclxuICAgICAgICBpZiAoc2VydmljZVByb3BlcnRpZXMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB1dGlsLmRlZXBFeHRlbmQoc2VydmljZU5hbWVzcGFjZSwgc2VydmljZVByb3BlcnRpZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBNb25rZXktcGF0Y2ggdGhlIHNlcnZpY2VOYW1lc3BhY2Ugb250byB0aGUgZmlyZWJhc2UgbmFtZXNwYWNlXHJcbiAgICAgICAgbmFtZXNwYWNlW25hbWVdID0gc2VydmljZU5hbWVzcGFjZTtcclxuICAgICAgICAvLyBQYXRjaCB0aGUgRmlyZWJhc2VBcHBJbXBsIHByb3RvdHlwZVxyXG4gICAgICAgIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHNlcnZpY2VGeG4gPSB0aGlzLl9nZXRTZXJ2aWNlLmJpbmQodGhpcywgbmFtZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlRnhuLmFwcGx5KHRoaXMsIGFsbG93TXVsdGlwbGVJbnN0YW5jZXMgPyBhcmdzIDogW10pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2VOYW1lc3BhY2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFBhdGNoIHRoZSB0b3AtbGV2ZWwgZmlyZWJhc2UgbmFtZXNwYWNlIHdpdGggYWRkaXRpb25hbCBwcm9wZXJ0aWVzLlxyXG4gICAgICpcclxuICAgICAqIGZpcmViYXNlLklOVEVSTkFMLmV4dGVuZE5hbWVzcGFjZSgpXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGV4dGVuZE5hbWVzcGFjZShwcm9wcykge1xyXG4gICAgICAgIHV0aWwuZGVlcEV4dGVuZChuYW1lc3BhY2UsIHByb3BzKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNhbGxBcHBIb29rcyhhcHAsIGV2ZW50TmFtZSkge1xyXG4gICAgICAgIE9iamVjdC5rZXlzKGZhY3RvcmllcykuZm9yRWFjaChmdW5jdGlvbiAoc2VydmljZU5hbWUpIHtcclxuICAgICAgICAgICAgLy8gSWdub3JlIHZpcnR1YWwgc2VydmljZXNcclxuICAgICAgICAgICAgdmFyIGZhY3RvcnlOYW1lID0gdXNlQXNTZXJ2aWNlKGFwcCwgc2VydmljZU5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoZmFjdG9yeU5hbWUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYXBwSG9va3NbZmFjdG9yeU5hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICBhcHBIb29rc1tmYWN0b3J5TmFtZV0oZXZlbnROYW1lLCBhcHApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvLyBNYXAgdGhlIHJlcXVlc3RlZCBzZXJ2aWNlIHRvIGEgcmVnaXN0ZXJlZCBzZXJ2aWNlIG5hbWVcclxuICAgIC8vICh1c2VkIHRvIG1hcCBhdXRoIHRvIHNlcnZlckF1dGggc2VydmljZSB3aGVuIG5lZWRlZCkuXHJcbiAgICBmdW5jdGlvbiB1c2VBc1NlcnZpY2UoYXBwLCBuYW1lKSB7XHJcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzZXJ2ZXJBdXRoJykge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHVzZVNlcnZpY2UgPSBuYW1lO1xyXG4gICAgICAgIHZhciBvcHRpb25zID0gYXBwLm9wdGlvbnM7XHJcbiAgICAgICAgcmV0dXJuIHVzZVNlcnZpY2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmFtZXNwYWNlO1xyXG59XHJcbmZ1bmN0aW9uIGVycm9yKGNvZGUsIGFyZ3MpIHtcclxuICAgIHRocm93IGFwcEVycm9ycy5jcmVhdGUoY29kZSwgYXJncyk7XHJcbn1cclxuLy8gVHlwZVNjcmlwdCBkb2VzIG5vdCBzdXBwb3J0IG5vbi1zdHJpbmcgaW5kZXhlcyFcclxuLy8gbGV0IGVycm9yczoge1tjb2RlOiBBcHBFcnJvcjogc3RyaW5nfSA9IHtcclxudmFyIGVycm9ycyA9IHtcclxuICAgICduby1hcHAnOiBcIk5vIEZpcmViYXNlIEFwcCAneyRuYW1lfScgaGFzIGJlZW4gY3JlYXRlZCAtIFwiICtcclxuICAgICAgICAnY2FsbCBGaXJlYmFzZSBBcHAuaW5pdGlhbGl6ZUFwcCgpJyxcclxuICAgICdiYWQtYXBwLW5hbWUnOiBcIklsbGVnYWwgQXBwIG5hbWU6ICd7JG5hbWV9XCIsXHJcbiAgICAnZHVwbGljYXRlLWFwcCc6IFwiRmlyZWJhc2UgQXBwIG5hbWVkICd7JG5hbWV9JyBhbHJlYWR5IGV4aXN0c1wiLFxyXG4gICAgJ2FwcC1kZWxldGVkJzogXCJGaXJlYmFzZSBBcHAgbmFtZWQgJ3skbmFtZX0nIGFscmVhZHkgZGVsZXRlZFwiLFxyXG4gICAgJ2R1cGxpY2F0ZS1zZXJ2aWNlJzogXCJGaXJlYmFzZSBzZXJ2aWNlIG5hbWVkICd7JG5hbWV9JyBhbHJlYWR5IHJlZ2lzdGVyZWRcIixcclxuICAgICdzYS1ub3Qtc3VwcG9ydGVkJzogJ0luaXRpYWxpemluZyB0aGUgRmlyZWJhc2UgU0RLIHdpdGggYSBzZXJ2aWNlICcgK1xyXG4gICAgICAgICdhY2NvdW50IGlzIG9ubHkgYWxsb3dlZCBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQuIE9uIGNsaWVudCAnICtcclxuICAgICAgICAnZGV2aWNlcywgeW91IHNob3VsZCBpbnN0ZWFkIGluaXRpYWxpemUgdGhlIFNESyB3aXRoIGFuIGFwaSBrZXkgYW5kICcgK1xyXG4gICAgICAgICdhdXRoIGRvbWFpbicsXHJcbiAgICAnaW52YWxpZC1hcHAtYXJndW1lbnQnOiAnZmlyZWJhc2UueyRuYW1lfSgpIHRha2VzIGVpdGhlciBubyBhcmd1bWVudCBvciBhICcgK1xyXG4gICAgICAgICdGaXJlYmFzZSBBcHAgaW5zdGFuY2UuJ1xyXG59O1xyXG52YXIgYXBwRXJyb3JzID0gbmV3IHV0aWwuRXJyb3JGYWN0b3J5KCdhcHAnLCAnRmlyZWJhc2UnLCBlcnJvcnMpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIGZpcmViYXNlID0gY3JlYXRlRmlyZWJhc2VOYW1lc3BhY2UoKTtcblxuZXhwb3J0cy5maXJlYmFzZSA9IGZpcmViYXNlO1xuZXhwb3J0cy5kZWZhdWx0ID0gZmlyZWJhc2U7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vQGZpcmViYXNlL2FwcC9kaXN0L2luZGV4LmNqcy5qc1xuLy8gbW9kdWxlIGlkID0gMTNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyogZ2xvYmFsIEFGUkFNRSAqL1xyXG5cclxuLypcclxuICogUHJvdmlkZXMgYSBzaW1wbGUgQVBJIGZvciBjcmVhdGluZyBkZWNvcmF0b3IgZnVuY3Rpb25zIHdoaWNoIHlvdSBjYW4gYXBwbHkgdG8geW91ciBDb21wb25lbnQgZGVmaW5pdGlvbnMuXHJcbiAqIFRoZXNlIGRlY29yYXRlZCBmdW5jdGlvbnMgYXJlIGV4ZWN1dGVkIHdoZW4gdGhlaXIgQ29tcG9uZW50IGlzIGluc3RhbnRpYXRlZCwgYW5kIGhhdmUgdGhlaXIgJ3RoaXMnIGF0dHJpYnV0ZSBzZXRcclxuICogdG8gdGhlIG5ldyBDb21wb25lbnQuXHJcbiAqXHJcbiAqIERlY29yYXRvcnMgc2hvdWxkIG9ubHkgYmUgdXNlZCBvbiBmdW5jdGlvbnMgdGhhdCBhcmUgb3duZWQgYnkgQ29tcG9uZW50IGRlc2NyaXB0b3JzIHJlZ2lzdGVyZWQgd2l0aFxyXG4gKiBBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQuIERlY29yYXRpbmcgYW55IG90aGVyIGZ1bmN0aW9uIHdpbGwgaGF2ZSBubyBlZmZlY3QsIGFzIHRoZSBkZWNvcmF0b3JcclxuICogZnVuY3RvciB3aWxsIG5ldmVyIGJlIGV4ZWN1dGVkLlxyXG4gKi9cclxuXHJcbi8qXHJcbiAqIERlY29yYXRlcyBhIGZ1bmN0aW9uIHdpdGggYSBmdW5jdG9yIHRoYXQgaXMgZXhlY3V0ZWQgaW4gdGhlIGNvbnRleHQgb2YgZWFjaCBpbnN0YW50aWF0ZWQgQ29tcG9uZW50IHdoaWNoIG93bnMgaXQuXHJcbiAqXHJcbiAqIEBwYXJhbSBmdW5jIC0gRnVuY3Rpb24gdG8gZGVjb3JhdGUuXHJcbiAqIEBwYXJhbSBkZWNvcmF0b3JGdW5jIC0gRnVuY3RvciB3aGljaCBkZWNvcmF0ZXMgZnVuYy4gSXQncyBkZWZpbml0aW9uIHNob3VsZCBhcHBlYXIgbGlrZSB0aGlzOlxyXG4gKiAgICBmdW5jdGlvbiBkZWNvcmF0b3JGdW5jdG9yKGZ1bmNQcm9wZXJ0eU5hbWUpIHtcclxuICogICAgICBjb25zdCBmdW5jID0gdGhpc1tmdW5jUHJvcGVydHlOYW1lXTsgLy8gJ3RoaXMnIGlzIGFzc2lnbmVkIHRvIHRoZSBpbnN0YW50aWF0ZWQgQ29tcG9uZW50LlxyXG4gKiAgICAgIC8vIERlY29yYXRvciBzaG91bGQgcmV0dXJuIGEgZnVuY3Rpb25cclxuICogICAgICByZXR1cm4gKCkgPT4ge1xyXG4gKiAgICAgICAgY29uc29sZS5sb2codGhpcy5lbC5pZCArIFwiIGhhcyBhIGRlY29yYXRlZCBmdW5jdGlvbiFcIik7XHJcbiAqICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gKiAgICAgIH1cclxuICogICAgfVxyXG4gKlxyXG4gKiBAcmV0dXJucyBBIHBlbmRpbmcgZGVjb3JhdGVkIGZ1bmN0b3Igd2hpY2ggd2lsbCBiZSBleGVjdXRlZCB3aGVuIGEgY29tcG9uZW50IHRoYXQgb3ducyBpdCBpcyBpbnN0YW50aWF0ZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWNvcmF0ZShmdW5jLCBkZWNvcmF0b3JGdW5jKSB7XHJcbiAgcmV0dXJuIGRlY29yYXRpb25zLmFkZChmdW5jLCBkZWNvcmF0b3JGdW5jKTtcclxufVxyXG5cclxuLy8gSGVscGVyIGZvciBzdG9yaW5nIGFuZCByZXRyaWV2aW5nIGRlY29yYXRvciBmdW5jdG9ycyBmb3IgYSBnaXZlbiBmdW5jdGlvbi5cclxuY29uc3QgZGVjb3JhdGlvbnMgPSAoZnVuY3Rpb24oKSB7XHJcbiAgY29uc3QgZnVuY01hcCA9IG5ldyBXZWFrTWFwKCk7XHJcblxyXG4gIGZ1bmN0aW9uIGFkZChmdW5jLCBkZWNvcmF0b3IpIHtcclxuICAgIGNvbnN0IHBhcmVudCA9IGZ1bmNNYXAuaGFzKGZ1bmMpID8gZnVuYyA6IHVuZGVmaW5lZDsgLy8gSW4gY2FzZSBkZWNvcmF0b3JzIGFyZSBuZXN0ZWQuXHJcbiAgICBjb25zdCBkZWNvcmF0ZWRGdW5jID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgIH1cclxuICAgIGZ1bmNNYXAuc2V0KGRlY29yYXRlZEZ1bmMsIHtwYXJlbnQ6IHBhcmVudCwgZGVjb3JhdG9yOiBkZWNvcmF0b3J9KTtcclxuICAgIHJldHVybiBkZWNvcmF0ZWRGdW5jO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0QWxsKGZ1bmMpIHtcclxuICAgIHZhciBpdGVyID0gZnVuY01hcC5nZXQoZnVuYyk7XHJcbiAgICB2YXIgZGVjb3JhdG9ycyA9IFtdO1xyXG4gICAgd2hpbGUgKGl0ZXIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBkZWNvcmF0b3JzLnB1c2goaXRlci5kZWNvcmF0b3IpO1xyXG4gICAgICBpdGVyID0gaXRlci5wYXJlbnQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGVjb3JhdG9ycztcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGlzRnVuY3Rpb25EZWNvcmF0ZWQoZnVuYykge1xyXG4gICAgcmV0dXJuIGZ1bmNNYXAuaGFzKGZ1bmMpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGFkZDogYWRkLFxyXG4gICAgZ2V0QWxsOiBnZXRBbGwsXHJcbiAgICBpc0Z1bmN0aW9uRGVjb3JhdGVkOiBpc0Z1bmN0aW9uRGVjb3JhdGVkXHJcbiAgfVxyXG59KSgpO1xyXG5cclxuLy8gSGVyZSBJJ20gd3JhcHBpbmcgdGhlIEFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCBmdW5jdGlvbiBhbmQgYWxzbyBlYWNoIENvbXBvbmVudCBjb25zdHJ1Y3Rvci4gV2hlbmV2ZXIgYSBuZXcgY29tcG9uZW50XHJcbi8vIGlzIGluc3RhbnRpYXRlZCBJJ20gc2Nhbm5pbmcgaXRzIGxpc3Qgb2YgcHJvcGVydGllcyBmb3IgYW55IGZ1bmN0aW9ucyB3aGljaCBoYXZlIGJlZW4gZGVjb3JhdGVkLiBFYWNoIGRlY29yYXRpb25cclxuLy8gZnVuY3RvciB3aWxsIHRoZW4gYmUgZXhlY3V0ZWQgaW4gdGhlIGNvbnRleHQgb2YgdGhlIGNvbXBvbmVudCB3aGljaCBvd25zIHRoZSBmdW5jdGlvbi5cclxuKGZ1bmN0aW9uKCkge1xyXG4gIE9iamVjdC5rZXlzKEFGUkFNRS5jb21wb25lbnRzKS5mb3JFYWNoKCBmdW5jdGlvbihjKSB7XHJcbiAgICB3cmFwQ29tcG9uZW50KGMpXHJcbiAgfSk7XHJcbiAgd3JhcFJlZ2lzdGVyKCk7XHJcblxyXG4gIGZ1bmN0aW9uIGV4ZWN1dGVEZWNvcmF0b3JzT25OZXdDb21wb25lbnQoY29tcG9uZW50KSB7XHJcbiAgICBjb25zdCBwcm90ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGNvbXBvbmVudCk7XHJcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhwcm90KS5mb3JFYWNoKCBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgIGNvbnN0IHByb3AgPSBwcm90W25hbWVdO1xyXG4gICAgICBpZiAodHlwZW9mIHByb3AgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWNvcmF0aW9ucy5pc0Z1bmN0aW9uRGVjb3JhdGVkKHByb3ApKSB7XHJcbiAgICAgICAgZGVjb3JhdGlvbnMuZ2V0QWxsKHByb3ApLmZvckVhY2goZnVuY3Rpb24oZGVjb3JhdG9yKSB7XHJcbiAgICAgICAgICBjb21wb25lbnRbbmFtZV0gPSBkZWNvcmF0b3IuY2FsbChjb21wb25lbnQsIG5hbWUsIHByb3ApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHdyYXBDb21wb25lbnQobmFtZSkge1xyXG4gICAgY29uc3Qgb3JpZyA9IEFGUkFNRS5jb21wb25lbnRzW25hbWVdLkNvbXBvbmVudDtcclxuXHJcbiAgICBBRlJBTUUuY29tcG9uZW50c1tuYW1lXS5Db21wb25lbnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgLy8gT3ZlcnJpZGUgaW5pdCBvbiB0aGUgaW5zdGFuY2UgdG8gZXhlY3V0ZSB0aGUgZGVjb3JhdG9yIGZ1bmN0b3JzIGJlZm9yZSBpbml0aWFsaXppbmcuXHJcbiAgICAgIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmluaXQ7XHJcbiAgICAgICAgZXhlY3V0ZURlY29yYXRvcnNPbk5ld0NvbXBvbmVudCh0aGlzKTtcclxuICAgICAgICB0aGlzLmluaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgfVxyXG4gICAgICBvcmlnLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICB9XHJcbiAgICBBRlJBTUUuY29tcG9uZW50c1tuYW1lXS5Db21wb25lbnQucHJvdG90eXBlID0gb3JpZy5wcm90b3R5cGU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB3cmFwUmVnaXN0ZXIoKSB7XHJcbiAgICBjb25zdCBvcmlnUmVnaXN0ZXIgPSBBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQ7XHJcbiAgICBBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgIG9yaWdSZWdpc3Rlci5hcHBseShBRlJBTUUsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHJldHVybiB3cmFwQ29tcG9uZW50KG5hbWUpO1xyXG4gICAgfVxyXG4gIH1cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzLmRlY29yYXRlID0gZGVjb3JhdGU7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzL2NvbXBvbmVudC1kZWNvcmF0b3JzLmpzXG4vLyBtb2R1bGUgaWQgPSAxNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKiBnbG9iYWwgQUZSQU1FICovXG5cbmlmICh0eXBlb2YgQUZSQU1FID09PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzIHdhcyBsb2FkZWQgYmVmb3JlIEFGUkFNRSB3YXMgYXZhaWxhYmxlJyk7XG59XG5cbmNvbnN0IGV2ZW50QmluZGVyID0gcmVxdWlyZShcIi4vZXZlbnQtYmluZGVyXCIpO1xuY29uc3QgZGVjb3JhdGUgPSByZXF1aXJlKFwiLi9jb21wb25lbnQtZGVjb3JhdG9yc1wiKS5kZWNvcmF0ZTtcblxubW9kdWxlLmV4cG9ydHMuYmluZEV2ZW50ID0gZXZlbnRCaW5kZXIuYmluZEV2ZW50O1xubW9kdWxlLmV4cG9ydHMuYmluZEV2ZW50UGxheVBhdXNlID0gZXZlbnRCaW5kZXIuYmluZEV2ZW50UGxheVBhdXNlO1xubW9kdWxlLmV4cG9ydHMuZGVjb3JhdGUgPSBkZWNvcmF0ZTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDE1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gYnVpbGRTZWFyY2hNZXRob2Q7XG5cbnZhciBlcnJvcnMgPSByZXF1aXJlKCcuL2Vycm9ycy5qcycpO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBzZWFyY2ggbWV0aG9kIHRvIGJlIHVzZWQgaW4gY2xpZW50c1xuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5UGFyYW0gdGhlIG5hbWUgb2YgdGhlIGF0dHJpYnV0ZSB1c2VkIGZvciB0aGUgcXVlcnlcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgdGhlIHVybFxuICogQHJldHVybiB7ZnVuY3Rpb259IHRoZSBzZWFyY2ggbWV0aG9kXG4gKi9cbmZ1bmN0aW9uIGJ1aWxkU2VhcmNoTWV0aG9kKHF1ZXJ5UGFyYW0sIHVybCkge1xuICAvKipcbiAgICogVGhlIHNlYXJjaCBtZXRob2QuIFByZXBhcmVzIHRoZSBkYXRhIGFuZCBzZW5kIHRoZSBxdWVyeSB0byBBbGdvbGlhLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcXVlcnkgdGhlIHN0cmluZyB1c2VkIGZvciBxdWVyeSBzZWFyY2hcbiAgICogQHBhcmFtIHtvYmplY3R9IGFyZ3MgYWRkaXRpb25hbCBwYXJhbWV0ZXJzIHRvIHNlbmQgd2l0aCB0aGUgc2VhcmNoXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IFtjYWxsYmFja10gdGhlIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCB3aXRoIHRoZSBjbGllbnQgZ2V0cyB0aGUgYW5zd2VyXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZHxQcm9taXNlfSBJZiB0aGUgY2FsbGJhY2sgaXMgbm90IHByb3ZpZGVkIHRoZW4gdGhpcyBtZXRob2RzIHJldHVybnMgYSBQcm9taXNlXG4gICAqL1xuICByZXR1cm4gZnVuY3Rpb24gc2VhcmNoKHF1ZXJ5LCBhcmdzLCBjYWxsYmFjaykge1xuICAgIC8vIHdhcm4gVjIgdXNlcnMgb24gaG93IHRvIHNlYXJjaFxuICAgIGlmICh0eXBlb2YgcXVlcnkgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGFyZ3MgPT09ICdvYmplY3QnIHx8XG4gICAgICB0eXBlb2YgY2FsbGJhY2sgPT09ICdvYmplY3QnKSB7XG4gICAgICAvLyAuc2VhcmNoKHF1ZXJ5LCBwYXJhbXMsIGNiKVxuICAgICAgLy8gLnNlYXJjaChjYiwgcGFyYW1zKVxuICAgICAgdGhyb3cgbmV3IGVycm9ycy5BbGdvbGlhU2VhcmNoRXJyb3IoJ2luZGV4LnNlYXJjaCB1c2FnZSBpcyBpbmRleC5zZWFyY2gocXVlcnksIHBhcmFtcywgY2IpJyk7XG4gICAgfVxuXG4gICAgLy8gTm9ybWFsaXppbmcgdGhlIGZ1bmN0aW9uIHNpZ25hdHVyZVxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwIHx8IHR5cGVvZiBxdWVyeSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gVXNhZ2UgOiAuc2VhcmNoKCksIC5zZWFyY2goY2IpXG4gICAgICBjYWxsYmFjayA9IHF1ZXJ5O1xuICAgICAgcXVlcnkgPSAnJztcbiAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgfHwgdHlwZW9mIGFyZ3MgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIC8vIFVzYWdlIDogLnNlYXJjaChxdWVyeS9hcmdzKSwgLnNlYXJjaChxdWVyeSwgY2IpXG4gICAgICBjYWxsYmFjayA9IGFyZ3M7XG4gICAgICBhcmdzID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLyBBdCB0aGlzIHBvaW50IHdlIGhhdmUgMyBhcmd1bWVudHMgd2l0aCB2YWx1ZXNcblxuICAgIC8vIFVzYWdlIDogLnNlYXJjaChhcmdzKSAvLyBjYXJlZnVsOiB0eXBlb2YgbnVsbCA9PT0gJ29iamVjdCdcbiAgICBpZiAodHlwZW9mIHF1ZXJ5ID09PSAnb2JqZWN0JyAmJiBxdWVyeSAhPT0gbnVsbCkge1xuICAgICAgYXJncyA9IHF1ZXJ5O1xuICAgICAgcXVlcnkgPSB1bmRlZmluZWQ7XG4gICAgfSBlbHNlIGlmIChxdWVyeSA9PT0gdW5kZWZpbmVkIHx8IHF1ZXJ5ID09PSBudWxsKSB7IC8vIC5zZWFyY2godW5kZWZpbmVkL251bGwpXG4gICAgICBxdWVyeSA9ICcnO1xuICAgIH1cblxuICAgIHZhciBwYXJhbXMgPSAnJztcblxuICAgIGlmIChxdWVyeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBwYXJhbXMgKz0gcXVlcnlQYXJhbSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChxdWVyeSk7XG4gICAgfVxuXG4gICAgdmFyIGFkZGl0aW9uYWxVQTtcbiAgICBpZiAoYXJncyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoYXJncy5hZGRpdGlvbmFsVUEpIHtcbiAgICAgICAgYWRkaXRpb25hbFVBID0gYXJncy5hZGRpdGlvbmFsVUE7XG4gICAgICAgIGRlbGV0ZSBhcmdzLmFkZGl0aW9uYWxVQTtcbiAgICAgIH1cbiAgICAgIC8vIGBfZ2V0U2VhcmNoUGFyYW1zYCB3aWxsIGF1Z21lbnQgcGFyYW1zLCBkbyBub3QgYmUgZm9vbGVkIGJ5IHRoZSA9IHZlcnN1cyArPSBmcm9tIHByZXZpb3VzIGlmXG4gICAgICBwYXJhbXMgPSB0aGlzLmFzLl9nZXRTZWFyY2hQYXJhbXMoYXJncywgcGFyYW1zKTtcbiAgICB9XG5cblxuICAgIHJldHVybiB0aGlzLl9zZWFyY2gocGFyYW1zLCB1cmwsIGNhbGxiYWNrLCBhZGRpdGlvbmFsVUEpO1xuICB9O1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2J1aWxkU2VhcmNoTWV0aG9kLmpzXG4vLyBtb2R1bGUgaWQgPSAxNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG9taXQob2JqLCB0ZXN0KSB7XG4gIHZhciBrZXlzID0gcmVxdWlyZSgnb2JqZWN0LWtleXMnKTtcbiAgdmFyIGZvcmVhY2ggPSByZXF1aXJlKCdmb3JlYWNoJyk7XG5cbiAgdmFyIGZpbHRlcmVkID0ge307XG5cbiAgZm9yZWFjaChrZXlzKG9iaiksIGZ1bmN0aW9uIGRvRmlsdGVyKGtleU5hbWUpIHtcbiAgICBpZiAodGVzdChrZXlOYW1lKSAhPT0gdHJ1ZSkge1xuICAgICAgZmlsdGVyZWRba2V5TmFtZV0gPSBvYmpba2V5TmFtZV07XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gZmlsdGVyZWQ7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL29taXQuanNcbi8vIG1vZHVsZSBpZCA9IDE3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImlmICh0eXBlb2YgT2JqZWN0LmNyZWF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAvLyBpbXBsZW1lbnRhdGlvbiBmcm9tIHN0YW5kYXJkIG5vZGUuanMgJ3V0aWwnIG1vZHVsZVxuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3Rvcikge1xuICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yXG4gICAgY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ3Rvci5wcm90b3R5cGUsIHtcbiAgICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICAgIHZhbHVlOiBjdG9yLFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xufSBlbHNlIHtcbiAgLy8gb2xkIHNjaG9vbCBzaGltIGZvciBvbGQgYnJvd3NlcnNcbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbmhlcml0cyhjdG9yLCBzdXBlckN0b3IpIHtcbiAgICBjdG9yLnN1cGVyXyA9IHN1cGVyQ3RvclxuICAgIHZhciBUZW1wQ3RvciA9IGZ1bmN0aW9uICgpIHt9XG4gICAgVGVtcEN0b3IucHJvdG90eXBlID0gc3VwZXJDdG9yLnByb3RvdHlwZVxuICAgIGN0b3IucHJvdG90eXBlID0gbmV3IFRlbXBDdG9yKClcbiAgICBjdG9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGN0b3JcbiAgfVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2luaGVyaXRzL2luaGVyaXRzX2Jyb3dzZXIuanNcbi8vIG1vZHVsZSBpZCA9IDE4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0geVtvcFswXSAmIDIgPyBcInJldHVyblwiIDogb3BbMF0gPyBcInRocm93XCIgOiBcIm5leHRcIl0pICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gWzAsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7ICB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpZiAob1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vdHNsaWIvdHNsaWIuZXM2LmpzXG4vLyBtb2R1bGUgaWQgPSAxOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKiBnbG9iYWwgQUZSQU1FLCBUSFJFRSAqL1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxuLy8gQ29uZmlndXJhdGlvbiBmb3IgdGhlIE11dGF0aW9uT2JzZXJ2ZXIgdXNlZCB0byByZWZyZXNoIHRoZSB3aGl0ZWxpc3QuXG4vLyBMaXN0ZW5zIGZvciBhZGRpdGlvbi9yZW1vdmFsIG9mIGVsZW1lbnRzIGFuZCBhdHRyaWJ1dGVzIHdpdGhpbiB0aGUgc2NlbmUuXG52YXIgT0JTRVJWRVJfQ09ORklHID0ge1xuICBjaGlsZExpc3Q6IHRydWUsXG4gIGF0dHJpYnV0ZXM6IHRydWUsXG4gIHN1YnRyZWU6IHRydWVcbn07XG5cbi8qKlxuICogSW1wbGVtZW50IEFBQkIgY29sbGlzaW9uIGRldGVjdGlvbiBmb3IgZW50aXRpZXMgd2l0aCBhIG1lc2guXG4gKiBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9NaW5pbXVtX2JvdW5kaW5nX2JveCNBeGlzLWFsaWduZWRfbWluaW11bV9ib3VuZGluZ19ib3hcbiAqXG4gKiBAcHJvcGVydHkge3N0cmluZ30gb2JqZWN0cyAtIFNlbGVjdG9yIG9mIGVudGl0aWVzIHRvIHRlc3QgZm9yIGNvbGxpc2lvbi5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdhYWJiLWNvbGxpZGVyJywge1xuICBzY2hlbWE6IHtcbiAgICBjb2xsaWRlTm9uVmlzaWJsZToge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBkZWJ1Zzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgaW50ZXJ2YWw6IHtkZWZhdWx0OiA4MH0sXG4gICAgb2JqZWN0czoge2RlZmF1bHQ6ICcnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmNlbnRlckRpZmZlcmVuY2VWZWMzID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLmNsZWFyZWRJbnRlcnNlY3RlZEVscyA9IFtdO1xuICAgIHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWwgPSBudWxsO1xuICAgIHRoaXMuYm91bmRpbmdCb3ggPSBuZXcgVEhSRUUuQm94MygpO1xuICAgIHRoaXMuYm94Q2VudGVyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLmJveEhlbHBlciA9IG5ldyBUSFJFRS5Cb3hIZWxwZXIoKTtcbiAgICB0aGlzLmJveE1heCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5ib3hNaW4gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuaGl0Q2xvc2VzdENsZWFyRXZlbnREZXRhaWwgPSB7fTtcbiAgICB0aGlzLmhpdENsb3Nlc3RFdmVudERldGFpbCA9IHt9O1xuICAgIHRoaXMuaW50ZXJzZWN0ZWRFbHMgPSBbXTtcbiAgICB0aGlzLm9iamVjdEVscyA9IFtdO1xuICAgIHRoaXMubmV3SW50ZXJzZWN0ZWRFbHMgPSBbXTtcbiAgICB0aGlzLnByZXZDaGVja1RpbWUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5wcmV2aW91c0ludGVyc2VjdGVkRWxzID0gW107XG5cbiAgICB0aGlzLnNldERpcnR5ID0gdGhpcy5zZXREaXJ0eS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcih0aGlzLnNldERpcnR5KTtcbiAgICB0aGlzLmRpcnR5ID0gdHJ1ZTtcblxuICAgIHRoaXMuaGl0U3RhcnRFdmVudERldGFpbCA9IHtpbnRlcnNlY3RlZEVsczogdGhpcy5uZXdJbnRlcnNlY3RlZEVsc307XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMub2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsLnNjZW5lRWwsIE9CU0VSVkVSX0NPTkZJRyk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ29iamVjdDNkc2V0JywgdGhpcy5zZXREaXJ0eSk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ29iamVjdDNkcmVtb3ZlJywgdGhpcy5zZXREaXJ0eSk7XG4gIH0sXG5cbiAgcmVtb3ZlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29iamVjdDNkc2V0JywgdGhpcy5zZXREaXJ0eSk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29iamVjdDNkcmVtb3ZlJywgdGhpcy5zZXREaXJ0eSk7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUpIHtcbiAgICB2YXIgYm94SGVscGVyO1xuICAgIHZhciBib3VuZGluZ0JveCA9IHRoaXMuYm91bmRpbmdCb3g7XG4gICAgdmFyIGNlbnRlckRpZmZlcmVuY2VWZWMzID0gdGhpcy5jZW50ZXJEaWZmZXJlbmNlVmVjMztcbiAgICB2YXIgY2xlYXJlZEludGVyc2VjdGVkRWxzID0gdGhpcy5jbGVhcmVkSW50ZXJzZWN0ZWRFbHM7XG4gICAgdmFyIGNsb3Nlc3RDZW50ZXJEaWZmZXJlbmNlO1xuICAgIHZhciBuZXdDbG9zZXN0RWw7XG4gICAgdmFyIGludGVyc2VjdGVkRWxzID0gdGhpcy5pbnRlcnNlY3RlZEVscztcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBpO1xuICAgIHZhciBuZXdJbnRlcnNlY3RlZEVscyA9IHRoaXMubmV3SW50ZXJzZWN0ZWRFbHM7XG4gICAgdmFyIG9iamVjdEVscyA9IHRoaXMub2JqZWN0RWxzO1xuICAgIHZhciBwcmV2Q2hlY2tUaW1lID0gdGhpcy5wcmV2Q2hlY2tUaW1lO1xuICAgIHZhciBwcmV2aW91c0ludGVyc2VjdGVkRWxzID0gdGhpcy5wcmV2aW91c0ludGVyc2VjdGVkRWxzO1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBPbmx5IGNoZWNrIGZvciBpbnRlcnNlY3Rpb24gaWYgaW50ZXJ2YWwgdGltZSBoYXMgcGFzc2VkLlxuICAgIGlmIChwcmV2Q2hlY2tUaW1lICYmICh0aW1lIC0gcHJldkNoZWNrVGltZSA8IHRoaXMuZGF0YS5pbnRlcnZhbCkpIHsgcmV0dXJuOyB9XG4gICAgLy8gVXBkYXRlIGNoZWNrIHRpbWUuXG4gICAgdGhpcy5wcmV2Q2hlY2tUaW1lID0gdGltZTtcblxuICAgIGlmICh0aGlzLmRpcnR5KSB7IHRoaXMucmVmcmVzaE9iamVjdHMoKTsgfVxuXG4gICAgLy8gVXBkYXRlIHRoZSBib3VuZGluZyBib3ggdG8gYWNjb3VudCBmb3Igcm90YXRpb25zIGFuZCBwb3NpdGlvbiBjaGFuZ2VzLlxuICAgIGJvdW5kaW5nQm94LnNldEZyb21PYmplY3QoZWwub2JqZWN0M0QpO1xuICAgIHRoaXMuYm94TWluLmNvcHkoYm91bmRpbmdCb3gubWluKTtcbiAgICB0aGlzLmJveE1heC5jb3B5KGJvdW5kaW5nQm94Lm1heCk7XG4gICAgYm91bmRpbmdCb3guZ2V0Q2VudGVyKHRoaXMuYm94Q2VudGVyKTtcblxuICAgIGlmICh0aGlzLmRhdGEuZGVidWcpIHtcbiAgICAgIHRoaXMuYm94SGVscGVyLnNldEZyb21PYmplY3QoZWwub2JqZWN0M0QpO1xuICAgICAgaWYgKCF0aGlzLmJveEhlbHBlci5wYXJlbnQpIHsgZWwuc2NlbmVFbC5vYmplY3QzRC5hZGQodGhpcy5ib3hIZWxwZXIpOyB9XG4gICAgfVxuXG4gICAgY29weUFycmF5KHByZXZpb3VzSW50ZXJzZWN0ZWRFbHMsIGludGVyc2VjdGVkRWxzKTtcblxuICAgIC8vIFBvcHVsYXRlIGludGVyc2VjdGVkRWxzIGFycmF5LlxuICAgIGludGVyc2VjdGVkRWxzLmxlbmd0aCA9IDA7XG4gICAgZm9yIChpID0gMDsgaSA8IG9iamVjdEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKG9iamVjdEVsc1tpXSA9PT0gdGhpcy5lbCkgeyBjb250aW51ZTsgfVxuXG4gICAgICAvLyBEb24ndCBjb2xsaWRlIHdpdGggbm9uLXZpc2libGUgaWYgZmxhZyBzZXQuXG4gICAgICBpZiAoIXRoaXMuZGF0YS5jb2xsaWRlTm9uVmlzaWJsZSAmJiAhb2JqZWN0RWxzW2ldLmdldEF0dHJpYnV0ZSgndmlzaWJsZScpKSB7XG4gICAgICAgIC8vIFJlbW92ZSBib3ggaGVscGVyIGlmIGRlYnVnIGZsYWcgc2V0IGFuZCBoYXMgYm94IGhlbHBlci5cbiAgICAgICAgaWYgKHRoaXMuZGF0YS5kZWJ1Zykge1xuICAgICAgICAgIGJveEhlbHBlciA9IG9iamVjdEVsc1tpXS5vYmplY3QzRC5ib3hIZWxwZXI7XG4gICAgICAgICAgaWYgKGJveEhlbHBlcikge1xuICAgICAgICAgICAgZWwuc2NlbmVFbC5vYmplY3QzRC5yZW1vdmUoYm94SGVscGVyKTtcbiAgICAgICAgICAgIG9iamVjdEVsc1tpXS5vYmplY3QzRC5ib3hIZWxwZXIgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZm9yIGludGVyZWN0aW9uLlxuICAgICAgaWYgKHRoaXMuaXNJbnRlcnNlY3Rpbmcob2JqZWN0RWxzW2ldKSkgeyBpbnRlcnNlY3RlZEVscy5wdXNoKG9iamVjdEVsc1tpXSk7IH1cbiAgICB9XG5cbiAgICAvLyBHZXQgbmV3bHkgaW50ZXJzZWN0ZWQgZW50aXRpZXMuXG4gICAgbmV3SW50ZXJzZWN0ZWRFbHMubGVuZ3RoID0gMDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgaW50ZXJzZWN0ZWRFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChwcmV2aW91c0ludGVyc2VjdGVkRWxzLmluZGV4T2YoaW50ZXJzZWN0ZWRFbHNbaV0pID09PSAtMSkge1xuICAgICAgICBuZXdJbnRlcnNlY3RlZEVscy5wdXNoKGludGVyc2VjdGVkRWxzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbWl0IGNsZWFyZWQgZXZlbnRzIG9uIG5vIGxvbmdlciBpbnRlcnNlY3RlZCBlbnRpdGllcy5cbiAgICBjbGVhcmVkSW50ZXJzZWN0ZWRFbHMubGVuZ3RoID0gMDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgcHJldmlvdXNJbnRlcnNlY3RlZEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGludGVyc2VjdGVkRWxzLmluZGV4T2YocHJldmlvdXNJbnRlcnNlY3RlZEVsc1tpXSkgIT09IC0xKSB7IGNvbnRpbnVlOyB9XG4gICAgICBpZiAoIXByZXZpb3VzSW50ZXJzZWN0ZWRFbHNbaV0uaGFzQXR0cmlidXRlKCdhYWJiLWNvbGxpZGVyJykpIHtcbiAgICAgICAgcHJldmlvdXNJbnRlcnNlY3RlZEVsc1tpXS5lbWl0KCdoaXRlbmQnKTtcbiAgICAgIH1cbiAgICAgIGNsZWFyZWRJbnRlcnNlY3RlZEVscy5wdXNoKHByZXZpb3VzSW50ZXJzZWN0ZWRFbHNbaV0pO1xuICAgIH1cblxuICAgIC8vIEVtaXQgZXZlbnRzIG9uIGludGVyc2VjdGVkIGVudGl0aWVzLiBEbyB0aGlzIGFmdGVyIHRoZSBjbGVhcmVkIGV2ZW50cy5cbiAgICBmb3IgKGkgPSAwOyBpIDwgbmV3SW50ZXJzZWN0ZWRFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChuZXdJbnRlcnNlY3RlZEVsc1tpXSA9PT0gdGhpcy5lbCkgeyBjb250aW51ZTsgfVxuICAgICAgaWYgKG5ld0ludGVyc2VjdGVkRWxzW2ldLmhhc0F0dHJpYnV0ZSgnYWFiYi1jb2xsaWRlcicpKSB7IGNvbnRpbnVlOyB9XG4gICAgICBuZXdJbnRlcnNlY3RlZEVsc1tpXS5lbWl0KCdoaXRzdGFydCcpO1xuICAgIH1cblxuICAgIC8vIENhbGN1bGF0ZSBjbG9zZXN0IGludGVyc2VjdGVkIGVudGl0eSBiYXNlZCBvbiBjZW50ZXJzLlxuICAgIGZvciAoaSA9IDA7IGkgPCBpbnRlcnNlY3RlZEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGludGVyc2VjdGVkRWxzW2ldID09PSB0aGlzLmVsKSB7IGNvbnRpbnVlOyB9XG4gICAgICBjZW50ZXJEaWZmZXJlbmNlVmVjM1xuICAgICAgICAuY29weShpbnRlcnNlY3RlZEVsc1tpXS5vYmplY3QzRC5ib3VuZGluZ0JveENlbnRlcilcbiAgICAgICAgLnN1Yih0aGlzLmJveENlbnRlcik7XG4gICAgICBpZiAoY2xvc2VzdENlbnRlckRpZmZlcmVuY2UgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgIGNlbnRlckRpZmZlcmVuY2VWZWMzLmxlbmd0aCgpIDwgY2xvc2VzdENlbnRlckRpZmZlcmVuY2UpIHtcbiAgICAgICAgY2xvc2VzdENlbnRlckRpZmZlcmVuY2UgPSBjZW50ZXJEaWZmZXJlbmNlVmVjMy5sZW5ndGgoKTtcbiAgICAgICAgbmV3Q2xvc2VzdEVsID0gaW50ZXJzZWN0ZWRFbHNbaV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRW1pdCBldmVudHMgZm9yIHRoZSBuZXcgY2xvc2VzdCBlbnRpdHkgYW5kIHRoZSBvbGQgY2xvc2VzdCBlbnRpdHkuXG4gICAgaWYgKCFpbnRlcnNlY3RlZEVscy5sZW5ndGggJiYgdGhpcy5jbG9zZXN0SW50ZXJzZWN0ZWRFbCkge1xuICAgICAgLy8gTm8gaW50ZXJzZWN0ZWQgZW50aXRpZXMsIGNsZWFyIGFueSBjbG9zZXN0IGVudGl0eS5cbiAgICAgIHRoaXMuaGl0Q2xvc2VzdENsZWFyRXZlbnREZXRhaWwuZWwgPSB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsO1xuICAgICAgdGhpcy5jbG9zZXN0SW50ZXJzZWN0ZWRFbC5lbWl0KCdoaXRjbG9zZXN0Y2xlYXInKTtcbiAgICAgIHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWwgPSBudWxsO1xuICAgICAgZWwuZW1pdCgnaGl0Y2xvc2VzdGNsZWFyJywgdGhpcy5oaXRDbG9zZXN0Q2xlYXJFdmVudERldGFpbCk7XG4gICAgfSBlbHNlIGlmIChuZXdDbG9zZXN0RWwgIT09IHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWwpIHtcbiAgICAgIC8vIENsZWFyIHRoZSBwcmV2aW91cyBjbG9zZXN0IGVudGl0eS5cbiAgICAgIGlmICh0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsKSB7XG4gICAgICAgIHRoaXMuaGl0Q2xvc2VzdENsZWFyRXZlbnREZXRhaWwuZWwgPSB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsO1xuICAgICAgICB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsLmVtaXQoJ2hpdGNsb3Nlc3RjbGVhcicsIHRoaXMuaGl0Q2xvc2VzdENsZWFyRXZlbnREZXRhaWwpO1xuICAgICAgfVxuICAgICAgaWYgKG5ld0Nsb3Nlc3RFbCkge1xuICAgICAgICAvLyBFbWl0IGZvciB0aGUgbmV3IGNsb3Nlc3QgZW50aXR5LlxuICAgICAgICBuZXdDbG9zZXN0RWwuZW1pdCgnaGl0Y2xvc2VzdCcpO1xuICAgICAgICB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsID0gbmV3Q2xvc2VzdEVsO1xuICAgICAgICB0aGlzLmhpdENsb3Nlc3RFdmVudERldGFpbC5lbCA9IG5ld0Nsb3Nlc3RFbDtcbiAgICAgICAgZWwuZW1pdCgnaGl0Y2xvc2VzdCcsIHRoaXMuaGl0Q2xvc2VzdEV2ZW50RGV0YWlsKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY2xlYXJlZEludGVyc2VjdGVkRWxzLmxlbmd0aCkge1xuICAgICAgZWwuZW1pdCgnaGl0ZW5kJyk7XG4gICAgfVxuXG4gICAgaWYgKG5ld0ludGVyc2VjdGVkRWxzLmxlbmd0aCkge1xuICAgICAgZWwuZW1pdCgnaGl0c3RhcnQnLCB0aGlzLmhpdFN0YXJ0RXZlbnREZXRhaWwpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogQUFCQiBjb2xsaXNpb24gZGV0ZWN0aW9uLlxuICAgKiAzRCB2ZXJzaW9uIG9mIGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9Z2hxRDNlMzdSN0VcbiAgICovXG4gIGlzSW50ZXJzZWN0aW5nOiAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBib3VuZGluZ0JveCA9IG5ldyBUSFJFRS5Cb3gzKCk7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKGVsKSB7XG4gICAgICB2YXIgaXNJbnRlcnNlY3Rpbmc7XG4gICAgICB2YXIgYm94SGVscGVyO1xuICAgICAgdmFyIGJveE1pbjtcbiAgICAgIHZhciBib3hNYXg7XG5cbiAgICAgIGJvdW5kaW5nQm94LnNldEZyb21PYmplY3QoZWwub2JqZWN0M0QpO1xuXG4gICAgICBpZiAodGhpcy5kYXRhLmRlYnVnKSB7XG4gICAgICAgIGlmICghZWwub2JqZWN0M0QuYm94SGVscGVyKSB7XG4gICAgICAgICAgZWwub2JqZWN0M0QuYm94SGVscGVyID0gbmV3IFRIUkVFLkJveEhlbHBlcihcbiAgICAgICAgICAgIGVsLm9iamVjdDNELCBuZXcgVEhSRUUuQ29sb3IoTWF0aC5yYW5kb20oKSwgTWF0aC5yYW5kb20oKSwgTWF0aC5yYW5kb20oKSkpO1xuICAgICAgICAgIGVsLnNjZW5lRWwub2JqZWN0M0QuYWRkKGVsLm9iamVjdDNELmJveEhlbHBlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWwub2JqZWN0M0QuYm94SGVscGVyLnNldEZyb21PYmplY3QoZWwub2JqZWN0M0QpO1xuICAgICAgfVxuXG4gICAgICBib3hNaW4gPSBib3VuZGluZ0JveC5taW47XG4gICAgICBib3hNYXggPSBib3VuZGluZ0JveC5tYXg7XG4gICAgICBlbC5vYmplY3QzRC5ib3VuZGluZ0JveENlbnRlciA9IGVsLm9iamVjdDNELmJvdW5kaW5nQm94Q2VudGVyIHx8IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgICBib3VuZGluZ0JveC5nZXRDZW50ZXIoZWwub2JqZWN0M0QuYm91bmRpbmdCb3hDZW50ZXIpO1xuICAgICAgcmV0dXJuICh0aGlzLmJveE1pbi54IDw9IGJveE1heC54ICYmIHRoaXMuYm94TWF4LnggPj0gYm94TWluLngpICYmXG4gICAgICAgICAgICAgKHRoaXMuYm94TWluLnkgPD0gYm94TWF4LnkgJiYgdGhpcy5ib3hNYXgueSA+PSBib3hNaW4ueSkgJiZcbiAgICAgICAgICAgICAodGhpcy5ib3hNaW4ueiA8PSBib3hNYXgueiAmJiB0aGlzLmJveE1heC56ID49IGJveE1pbi56KTtcbiAgICB9O1xuICB9KSgpLFxuXG4gIC8qKlxuICAgKiBNYXJrIHRoZSBvYmplY3QgbGlzdCBhcyBkaXJ0eSwgdG8gYmUgcmVmcmVzaGVkIGJlZm9yZSBuZXh0IHJheWNhc3QuXG4gICAqL1xuICBzZXREaXJ0eTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZGlydHkgPSB0cnVlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBVcGRhdGUgbGlzdCBvZiBvYmplY3RzIHRvIHRlc3QgZm9yIGludGVyc2VjdGlvbi5cbiAgICovXG4gIHJlZnJlc2hPYmplY3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgLy8gSWYgb2JqZWN0cyBub3QgZGVmaW5lZCwgaW50ZXJzZWN0IHdpdGggZXZlcnl0aGluZy5cbiAgICB0aGlzLm9iamVjdEVscyA9IGRhdGEub2JqZWN0c1xuICAgICAgPyB0aGlzLmVsLnNjZW5lRWwucXVlcnlTZWxlY3RvckFsbChkYXRhLm9iamVjdHMpXG4gICAgICA6IHRoaXMuZWwuc2NlbmVFbC5jaGlsZHJlbjtcbiAgICB0aGlzLmRpcnR5ID0gZmFsc2U7XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBjb3B5QXJyYXkgKGRlc3QsIHNvdXJjZSkge1xuICB2YXIgaTtcbiAgZGVzdC5sZW5ndGggPSAwO1xuICBmb3IgKGkgPSAwOyBpIDwgc291cmNlLmxlbmd0aDsgaSsrKSB7IGRlc3RbaV0gPSBzb3VyY2VbaV07IH1cbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtYWFiYi1jb2xsaWRlci1jb21wb25lbnQvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDIwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImlmICh0eXBlb2YgQUZSQU1FID09PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0NvbXBvbmVudCBhdHRlbXB0ZWQgdG8gcmVnaXN0ZXIgYmVmb3JlIEFGUkFNRSB3YXMgYXZhaWxhYmxlLicpO1xufVxuXG52YXIgYXVkaW9CdWZmZXJDYWNoZSA9IHt9O1xuXG4vKipcbiAqIEF1ZGlvIHZpc3VhbGl6ZXIgY29tcG9uZW50IGZvciBBLUZyYW1lIHVzaW5nIEFuYWx5c2VyTm9kZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdhdWRpb2FuYWx5c2VyJywge1xuICBzY2hlbWE6IHtcbiAgICBidWZmZXI6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgYmVhdERldGVjdGlvbkRlY2F5OiB7ZGVmYXVsdDogMC45OX0sXG4gICAgYmVhdERldGVjdGlvbk1pblZvbHVtZToge2RlZmF1bHQ6IDE1fSxcbiAgICBiZWF0RGV0ZWN0aW9uVGhyb3R0bGU6IHtkZWZhdWx0OiAyNTB9LFxuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVCZWF0RGV0ZWN0aW9uOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlTGV2ZWxzOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlV2F2ZWZvcm06IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVWb2x1bWU6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBmZnRTaXplOiB7ZGVmYXVsdDogMjA0OH0sXG4gICAgc21vb3RoaW5nVGltZUNvbnN0YW50OiB7ZGVmYXVsdDogMC44fSxcbiAgICBzcmM6IHtcbiAgICAgIHBhcnNlOiBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgIGlmICh2YWwuY29uc3RydWN0b3IgIT09IFN0cmluZykgeyByZXR1cm4gdmFsOyB9XG4gICAgICAgIGlmICh2YWwuc3RhcnRzV2l0aCgnIycpIHx8IHZhbC5zdGFydHNXaXRoKCcuJykpIHtcbiAgICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih2YWwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgICB9XG4gICAgfSxcbiAgICB1bmlxdWU6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFuYWx5c2VyO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBnYWluTm9kZVxuXG4gICAgdGhpcy5hdWRpb0VsID0gbnVsbDtcbiAgICB0aGlzLmNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG4gICAgdGhpcy5sZXZlbHMgPSBudWxsO1xuICAgIHRoaXMud2F2ZWZvcm0gPSBudWxsO1xuICAgIHRoaXMudm9sdW1lID0gMDtcbiAgICB0aGlzLnhociA9IG51bGw7XG5cbiAgICBhbmFseXNlciA9IHRoaXMuYW5hbHlzZXIgPSB0aGlzLmNvbnRleHQuY3JlYXRlQW5hbHlzZXIoKTtcbiAgICBnYWluTm9kZSA9IHRoaXMuZ2Fpbk5vZGUgPSB0aGlzLmNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIGdhaW5Ob2RlLmNvbm5lY3QoYW5hbHlzZXIpO1xuICAgIGFuYWx5c2VyLmNvbm5lY3QodGhpcy5jb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICBhbmFseXNlci5mZnRTaXplID0gZGF0YS5mZnRTaXplO1xuICAgIGFuYWx5c2VyLnNtb290aGluZ1RpbWVDb25zdGFudCA9IGRhdGEuc21vb3RoaW5nVGltZUNvbnN0YW50O1xuICAgIHRoaXMubGV2ZWxzID0gbmV3IFVpbnQ4QXJyYXkoYW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQpO1xuICAgIHRoaXMud2F2ZWZvcm0gPSBuZXcgVWludDhBcnJheShhbmFseXNlci5mZnRTaXplKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGFuYWx5c2VyID0gdGhpcy5hbmFseXNlcjtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIC8vIFVwZGF0ZSBhbmFseXNlciBzdHVmZi5cbiAgICBpZiAob2xkRGF0YS5mZnRTaXplICE9PSBkYXRhLmZmdFNpemUgfHxcbiAgICAgICAgb2xkRGF0YS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQgIT09IGRhdGEuc21vb3RoaW5nVGltZUNvbnN0YW50KSB7XG4gICAgICBhbmFseXNlci5mZnRTaXplID0gZGF0YS5mZnRTaXplO1xuICAgICAgYW5hbHlzZXIuc21vb3RoaW5nVGltZUNvbnN0YW50ID0gZGF0YS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQ7XG4gICAgICB0aGlzLmxldmVscyA9IG5ldyBVaW50OEFycmF5KGFuYWx5c2VyLmZyZXF1ZW5jeUJpbkNvdW50KTtcbiAgICAgIHRoaXMud2F2ZWZvcm0gPSBuZXcgVWludDhBcnJheShhbmFseXNlci5mZnRTaXplKTtcbiAgICB9XG5cbiAgICBpZiAoIWRhdGEuc3JjKSB7IHJldHVybjsgfVxuICAgIHRoaXMucmVmcmVzaFNvdXJjZSgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBVcGRhdGUgc3BlY3RydW0gb24gZWFjaCBmcmFtZS5cbiAgICovXG4gIHRpY2s6IGZ1bmN0aW9uICh0LCBkdCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciB2b2x1bWU7XG5cbiAgICBpZiAoIWRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cblxuICAgIC8vIExldmVscyAoZnJlcXVlbmN5KS5cbiAgICBpZiAoZGF0YS5lbmFibGVMZXZlbHMgfHwgZGF0YS5lbmFibGVWb2x1bWUpIHtcbiAgICAgIHRoaXMuYW5hbHlzZXIuZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEodGhpcy5sZXZlbHMpO1xuICAgIH1cblxuICAgIC8vIFdhdmVmb3JtLlxuICAgIGlmIChkYXRhLmVuYWJsZVdhdmVmb3JtKSB7XG4gICAgICB0aGlzLmFuYWx5c2VyLmdldEJ5dGVUaW1lRG9tYWluRGF0YSh0aGlzLndhdmVmb3JtKTtcbiAgICB9XG5cbiAgICAvLyBBdmVyYWdlIHZvbHVtZS5cbiAgICBpZiAoZGF0YS5lbmFibGVWb2x1bWUgfHwgZGF0YS5lbmFibGVCZWF0RGV0ZWN0aW9uKSB7XG4gICAgICB2YXIgc3VtID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZXZlbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc3VtICs9IHRoaXMubGV2ZWxzW2ldOztcbiAgICAgIH1cbiAgICAgIHRoaXMudm9sdW1lID0gc3VtIC8gdGhpcy5sZXZlbHMubGVuZ3RoO1xuICAgIH1cblxuICAgIC8vIEJlYXQgZGV0ZWN0aW9uLlxuICAgIGlmIChkYXRhLmVuYWJsZUJlYXREZXRlY3Rpb24pIHtcbiAgICAgIHZvbHVtZSA9IHRoaXMudm9sdW1lO1xuICAgICAgaWYgKCF0aGlzLmJlYXRDdXRPZmYpIHsgdGhpcy5iZWF0Q3V0T2ZmID0gdm9sdW1lOyB9XG4gICAgICBpZiAodm9sdW1lID4gdGhpcy5iZWF0Q3V0T2ZmICYmIHZvbHVtZSA+IHRoaXMuZGF0YS5iZWF0RGV0ZWN0aW9uTWluVm9sdW1lKSB7XG4gICAgICAgIHRoaXMuZWwuZW1pdCgnYXVkaW9hbmFseXNlcmJlYXQnLCBudWxsLCBmYWxzZSk7XG4gICAgICAgIHRoaXMuYmVhdEN1dE9mZiA9IHZvbHVtZSAqIDEuNTtcbiAgICAgICAgdGhpcy5iZWF0VGltZSA9IDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5iZWF0VGltZSA8PSB0aGlzLmRhdGEuYmVhdERldGVjdGlvblRocm90dGxlKSB7XG4gICAgICAgICAgdGhpcy5iZWF0VGltZSArPSBkdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmJlYXRDdXRPZmYgKj0gdGhpcy5kYXRhLmJlYXREZXRlY3Rpb25EZWNheTtcbiAgICAgICAgICB0aGlzLmJlYXRDdXRPZmYgPSBNYXRoLm1heCh0aGlzLmJlYXRDdXRPZmYsIHRoaXMuZGF0YS5iZWF0RGV0ZWN0aW9uTWluVm9sdW1lKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICByZWZyZXNoU291cmNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFuYWx5c2VyID0gdGhpcy5hbmFseXNlcjtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGlmIChkYXRhLmJ1ZmZlciAmJiBkYXRhLnNyYy5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7XG4gICAgICB0aGlzLmdldEJ1ZmZlclNvdXJjZSgpLnRoZW4oc291cmNlID0+IHtcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIHRoaXMuc291cmNlLmNvbm5lY3QodGhpcy5nYWluTm9kZSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zb3VyY2UgPSB0aGlzLmdldE1lZGlhU291cmNlKCk7XG4gICAgICB0aGlzLnNvdXJjZS5jb25uZWN0KHRoaXMuZ2Fpbk5vZGUpO1xuICAgIH1cbiAgfSxcblxuICBzdXNwZW5kQ29udGV4dDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY29udGV4dC5zdXNwZW5kKCk7XG4gIH0sXG5cbiAgcmVzdW1lQ29udGV4dDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY29udGV4dC5yZXN1bWUoKTtcbiAgfSxcblxuICAvKipcbiAgICogRmV0Y2ggYW5kIHBhcnNlIGJ1ZmZlciB0byBhdWRpbyBidWZmZXIuIFJlc29sdmUgYSBzb3VyY2UuXG4gICAqL1xuICBmZXRjaEF1ZGlvQnVmZmVyOiBmdW5jdGlvbiAoc3JjKSB7XG4gICAgLy8gRnJvbSBjYWNoZS5cbiAgICBpZiAoYXVkaW9CdWZmZXJDYWNoZVtzcmNdKSB7XG4gICAgICBpZiAoYXVkaW9CdWZmZXJDYWNoZVtzcmNdLmNvbnN0cnVjdG9yID09PSBQcm9taXNlKSB7XG4gICAgICAgIHJldHVybiBhdWRpb0J1ZmZlckNhY2hlW3NyY107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGF1ZGlvQnVmZmVyQ2FjaGVbc3JjXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYXVkaW9CdWZmZXJDYWNoZVtzcmNdID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAvLyBGZXRjaCBpZiBkb2VzIG5vdCBleGlzdC5cbiAgICAgIGNvbnN0IHhociA9IHRoaXMueGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICB4aHIub3BlbignR0VUJywgc3JjKTtcbiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuY29udGV4dC5kZWNvZGVBdWRpb0RhdGEoeGhyLnJlc3BvbnNlKS50aGVuKGF1ZGlvQnVmZmVyID0+IHtcbiAgICAgICAgICBhdWRpb0J1ZmZlckNhY2hlW3NyY10gPSBhdWRpb0J1ZmZlcjtcbiAgICAgICAgICByZXNvbHZlKGF1ZGlvQnVmZmVyKTtcbiAgICAgICAgfSkuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gICAgICB9KTtcbiAgICAgIHhoci5zZW5kKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGF1ZGlvQnVmZmVyQ2FjaGVbc3JjXTtcbiAgfSxcblxuICBnZXRCdWZmZXJTb3VyY2U6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICByZXR1cm4gdGhpcy5mZXRjaEF1ZGlvQnVmZmVyKGRhdGEuc3JjKS50aGVuKCgpID0+IHtcbiAgICAgIHZhciBzb3VyY2U7XG4gICAgICBzb3VyY2UgPSB0aGlzLmNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICBzb3VyY2UuYnVmZmVyID0gYXVkaW9CdWZmZXJDYWNoZVtkYXRhLnNyY107XG4gICAgICB0aGlzLmVsLmVtaXQoJ2F1ZGlvYW5hbHlzZXJidWZmZXJzb3VyY2UnLCBzb3VyY2UsIGZhbHNlKTtcbiAgICAgIHJldHVybiBzb3VyY2U7XG4gICAgfSkuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gIH0sXG5cbiAgZ2V0TWVkaWFTb3VyY2U6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kYXRhLnNyYy5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7XG4gICAgICBpZiAoIXRoaXMuYXVkaW8pIHtcbiAgICAgICAgdGhpcy5hdWRpbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XG4gICAgICAgIHRoaXMuYXVkaW8uY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJztcbiAgICAgIH1cbiAgICAgIHRoaXMuYXVkaW8uc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLmRhdGEuc3JjKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5hdWRpbyA9IHRoaXMuZGF0YS5zcmM7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmNvbnRleHQuY3JlYXRlTWVkaWFFbGVtZW50U291cmNlKHRoaXMuYXVkaW8pXG4gIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1hdWRpb2FuYWx5c2VyLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyogZ2xvYmFsIEFGUkFNRSAqL1xudmFyIHN0eWxlUGFyc2VyID0gQUZSQU1FLnV0aWxzLnN0eWxlUGFyc2VyO1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdldmVudC1zZXQnLCB7XG4gIHNjaGVtYToge1xuICAgIGRlZmF1bHQ6ICcnLFxuICAgIHBhcnNlOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiBzdHlsZVBhcnNlci5wYXJzZSh2YWx1ZSk7XG4gICAgfVxuICB9LFxuXG4gIG11bHRpcGxlOiB0cnVlLFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmV2ZW50SGFuZGxlciA9IG51bGw7XG4gICAgdGhpcy5ldmVudE5hbWUgPSBudWxsO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICB0aGlzLnVwZGF0ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoKTtcbiAgfSxcblxuICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgfSxcblxuICBwYXVzZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigpO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoKTtcbiAgfSxcblxuICAvKipcbiAgICogVXBkYXRlIHNvdXJjZS1vZi10cnV0aCBldmVudCBsaXN0ZW5lciByZWdpc3RyeS5cbiAgICogRG9lcyBub3QgYWN0dWFsbHkgYXR0YWNoIGV2ZW50IGxpc3RlbmVycyB5ZXQuXG4gICAqL1xuICB1cGRhdGVFdmVudExpc3RlbmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgZXZlbnQ7XG4gICAgdmFyIHRhcmdldDtcbiAgICB2YXIgdGFyZ2V0RWw7XG5cbiAgICAvLyBTZXQgZXZlbnQgbGlzdGVuZXIgdXNpbmcgYF9ldmVudGAuXG4gICAgZXZlbnQgPSBkYXRhLl9ldmVudCB8fCB0aGlzLmlkO1xuICAgIHRhcmdldCA9IGRhdGEuX3RhcmdldDtcblxuICAgIC8vIERlY2lkZSB0aGUgdGFyZ2V0IHRvIGBzZXRBdHRyaWJ1dGVgIG9uLlxuICAgIHRhcmdldEVsID0gdGFyZ2V0ID8gZWwuc2NlbmVFbC5xdWVyeVNlbGVjdG9yKHRhcmdldCkgOiBlbDtcblxuICAgIHRoaXMuZXZlbnROYW1lID0gZXZlbnQ7XG4gICAgdGhpcy5ldmVudEhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyICgpIHtcbiAgICAgIHZhciBwcm9wTmFtZTtcbiAgICAgIC8vIFNldCBhdHRyaWJ1dGVzLlxuICAgICAgZm9yIChwcm9wTmFtZSBpbiBkYXRhKSB7XG4gICAgICAgIGlmIChwcm9wTmFtZSA9PT0gJ19ldmVudCcgfHwgcHJvcE5hbWUgPT09ICdfdGFyZ2V0JykgeyBjb250aW51ZTsgfVxuICAgICAgICBBRlJBTUUudXRpbHMuZW50aXR5LnNldENvbXBvbmVudFByb3BlcnR5LmNhbGwodGhpcywgdGFyZ2V0RWwsIHByb3BOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtwcm9wTmFtZV0pO1xuICAgICAgfVxuICAgIH07XG4gIH0sXG5cbiAgYWRkRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmV2ZW50TmFtZSwgdGhpcy5ldmVudEhhbmRsZXIpO1xuICB9LFxuXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIHRoaXMuZXZlbnRIYW5kbGVyKTtcbiAgfVxufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLWV2ZW50LXNldC1jb21wb25lbnQvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDIyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImlmICghVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscykge1xuICByZXF1aXJlKCcuL2xpYi9CdWZmZXJHZW9tZXRyeVV0aWxzJyk7XG59XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZ2VvbWV0cnktbWVyZ2VyJywge1xuICBzY2hlbWE6IHtcbiAgICBwcmVzZXJ2ZU9yaWdpbmFsOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBmYWNlSW5kZXhFbmQ7XG4gICAgdmFyIGZhY2VJbmRleFN0YXJ0O1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHRoaXMuZ2VvbWV0cnkgPSBuZXcgVEhSRUUuR2VvbWV0cnkoKTtcbiAgICB0aGlzLm1lc2ggPSBuZXcgVEhSRUUuTWVzaCh0aGlzLmdlb21ldHJ5KTtcbiAgICB0aGlzLmVsLnNldE9iamVjdDNEKCdtZXNoJywgdGhpcy5tZXNoKTtcblxuICAgIHRoaXMuZmFjZUluZGV4ID0ge307ICAvLyBLZWVwIGluZGV4IG9mIG9yaWdpbmFsIGVudGl0eSBVVUlEIHRvIG5ldyBmYWNlIGFycmF5LlxuICAgIHRoaXMudmVydGV4SW5kZXggPSB7fTsgIC8vIEtlZXAgaW5kZXggb2Ygb3JpZ2luYWwgZW50aXR5IFVVSUQgdG8gdmVydGV4IGFycmF5LlxuXG4gICAgdGhpcy5lbC5vYmplY3QzRC50cmF2ZXJzZShmdW5jdGlvbiAobWVzaCkge1xuICAgICAgaWYgKG1lc2gudHlwZSAhPT0gJ01lc2gnKSB7IHJldHVybjsgfVxuICAgICAgaWYgKG1lc2ggPT09IHNlbGYubWVzaCkgeyByZXR1cm47IH1cblxuICAgICAgc2VsZi5mYWNlSW5kZXhbbWVzaC5wYXJlbnQudXVpZF0gPSBbXG4gICAgICAgIHNlbGYuZ2VvbWV0cnkuZmFjZXMubGVuZ3RoLFxuICAgICAgICBzZWxmLmdlb21ldHJ5LmZhY2VzLmxlbmd0aCArIG1lc2guZ2VvbWV0cnkuZmFjZXMubGVuZ3RoIC0gMVxuICAgICAgXTtcblxuICAgICAgc2VsZi52ZXJ0ZXhJbmRleFttZXNoLnBhcmVudC51dWlkXSA9IFtcbiAgICAgICAgc2VsZi5nZW9tZXRyeS52ZXJ0aWNlcy5sZW5ndGgsXG4gICAgICAgIHNlbGYuZ2VvbWV0cnkudmVydGljZXMubGVuZ3RoICsgbWVzaC5nZW9tZXRyeS52ZXJ0aWNlcy5sZW5ndGggLSAxXG4gICAgICBdO1xuXG4gICAgICAvLyBNZXJnZS4gVXNlIHBhcmVudCdzIG1hdHJpeCBkdWUgdG8gQS1GcmFtZSdzIDxhLWVudGl0eT4oR3JvdXAtTWVzaCkgaGllcmFyY2h5LlxuICAgICAgbWVzaC5wYXJlbnQudXBkYXRlTWF0cml4KCk7XG4gICAgICBzZWxmLmdlb21ldHJ5Lm1lcmdlKG1lc2guZ2VvbWV0cnksIG1lc2gucGFyZW50Lm1hdHJpeCk7XG5cbiAgICAgIC8vIFJlbW92ZSBtZXNoIGlmIG5vdCBwcmVzZXJ2aW5nLlxuICAgICAgaWYgKCFzZWxmLmRhdGEucHJlc2VydmVPcmlnaW5hbCkgeyBtZXNoLnBhcmVudC5yZW1vdmUobWVzaCk7IH1cbiAgICB9KTtcbiAgfVxufSk7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYnVmZmVyLWdlb21ldHJ5LW1lcmdlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgcHJlc2VydmVPcmlnaW5hbDoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZ2VvbWV0cmllcyA9IFtdO1xuXG4gICAgdGhpcy5lbC5zY2VuZUVsLm9iamVjdDNELnVwZGF0ZU1hdHJpeFdvcmxkKClcbiAgICB0aGlzLmVsLm9iamVjdDNELnRyYXZlcnNlKGZ1bmN0aW9uIChtZXNoKSB7XG4gICAgICBpZiAobWVzaC50eXBlICE9PSAnTWVzaCcgfHwgbWVzaC5lbCA9PT0gc2VsZi5lbCkgeyByZXR1cm47IH1cbiAgICAgIG1lc2guZ2VvbWV0cnkuYXBwbHlNYXRyaXgobWVzaC5tYXRyaXhXb3JsZCk7XG4gICAgICBnZW9tZXRyaWVzLnB1c2gobWVzaC5nZW9tZXRyeS5jbG9uZSgpKTtcbiAgICAgIG1lc2gucGFyZW50LnJlbW92ZShtZXNoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGdlb21ldHJ5ID0gVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscy5tZXJnZUJ1ZmZlckdlb21ldHJpZXMoZ2VvbWV0cmllcyk7XG4gICAgdGhpcy5tZXNoID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnkpO1xuICAgIHRoaXMuZWwuc2V0T2JqZWN0M0QoJ21lc2gnLCB0aGlzLm1lc2gpO1xuICB9XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtZ2VvbWV0cnktbWVyZ2VyLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyogZ2xvYmFsIEFGUkFNRSAqL1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxuLyoqXG4gKiBIYXB0aWNzIGNvbXBvbmVudCBmb3IgQS1GcmFtZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdoYXB0aWNzJywge1xuICBkZXBlbmRlbmNpZXM6IFsndHJhY2tlZC1jb250cm9scyddLFxuXG4gIHNjaGVtYToge1xuICAgIGFjdHVhdG9ySW5kZXg6IHtkZWZhdWx0OiAwfSxcbiAgICBkdXI6IHtkZWZhdWx0OiAxMDB9LFxuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBldmVudHM6IHt0eXBlOiAnYXJyYXknfSxcbiAgICBldmVudHNGcm9tOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIGZvcmNlOiB7ZGVmYXVsdDogMX1cbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGk7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5jYWxsUHVsc2UgPSBmdW5jdGlvbiAoKSB7IHNlbGYucHVsc2UoKTsgfTtcblxuICAgIGlmICh0aGlzLmVsLmNvbXBvbmVudHNbJ3RyYWNrZWQtY29udHJvbHMnXS5jb250cm9sbGVyKSB7XG4gICAgICB0aGlzLmdhbWVwYWQgPSB0aGlzLmVsLmNvbXBvbmVudHNbJ3RyYWNrZWQtY29udHJvbHMnXS5jb250cm9sbGVyO1xuICAgICAgaWYgKCF0aGlzLmdhbWVwYWQgfHwgIXRoaXMuZ2FtZXBhZC5oYXB0aWNBY3R1YXRvcnMubGVuZ3RoKSB7IHJldHVybjsgfVxuICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVycygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCBmdW5jdGlvbiBpbml0ICgpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi5nYW1lcGFkID0gc2VsZi5lbC5jb21wb25lbnRzWyd0cmFja2VkLWNvbnRyb2xzJ10uY29udHJvbGxlcjtcbiAgICAgICAgICBpZiAoIXNlbGYuZ2FtZXBhZCB8fCAhc2VsZi5nYW1lcGFkLmhhcHRpY0FjdHVhdG9ycy5sZW5ndGgpIHsgcmV0dXJuOyB9XG4gICAgICAgICAgc2VsZi5hZGRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB9LCAxNTApO1xuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIHJlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgfSxcblxuICBwdWxzZTogZnVuY3Rpb24gKGZvcmNlLCBkdXIpIHtcbiAgICB2YXIgYWN0dWF0b3I7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgaWYgKCFkYXRhLmVuYWJsZWQgfHwgIXRoaXMuZ2FtZXBhZCB8fCAhdGhpcy5nYW1lcGFkLmhhcHRpY0FjdHVhdG9ycykgeyByZXR1cm47IH1cbiAgICBhY3R1YXRvciA9IHRoaXMuZ2FtZXBhZC5oYXB0aWNBY3R1YXRvcnNbZGF0YS5hY3R1YXRvckluZGV4XTtcbiAgICBhY3R1YXRvci5wdWxzZShmb3JjZSB8fCBkYXRhLmZvcmNlLCBkdXIgfHwgZGF0YS5kdXIpO1xuICB9LFxuXG4gIGFkZEV2ZW50TGlzdGVuZXJzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGk7XG4gICAgdmFyIGxpc3RlblRhcmdldDtcblxuICAgIGxpc3RlblRhcmdldCA9IGRhdGEuZXZlbnRzRnJvbSA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YS5ldmVudHNGcm9tKSA6IHRoaXMuZWw7XG4gICAgZm9yIChpID0gMDsgaSA8IGRhdGEuZXZlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsaXN0ZW5UYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihkYXRhLmV2ZW50c1tpXSwgdGhpcy5jYWxsUHVsc2UpO1xuICAgIH1cbiAgfSxcblxuICByZW1vdmVFdmVudExpc3RlbmVyczogZnVuY3Rpb24gKCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBpO1xuICAgIHZhciBsaXN0ZW5UYXJnZXQ7XG5cbiAgICBsaXN0ZW5UYXJnZXQgPSBkYXRhLmV2ZW50c0Zyb20gPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRhdGEuZXZlbnRzRnJvbSkgOiB0aGlzLmVsO1xuICAgIGZvciAoaSA9IDA7IGkgPCBkYXRhLmV2ZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgbGlzdGVuVGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZGF0YS5ldmVudHNbaV0sIHRoaXMuY2FsbFB1bHNlKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1oYXB0aWNzLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIHBvc2l0aW9ucyA9IFtdO1xudmFyIHBvc2l0aW9uSGVscGVyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuLyoqXG4gKiBMYXlvdXQgY29tcG9uZW50IGZvciBBLUZyYW1lLlxuICogU29tZSBsYXlvdXRzIGFkYXB0ZWQgZnJvbSBodHRwOi8vd3d3LnZiLWhlbHBlci5jb20vdHV0b3JpYWxfcGxhdG9uaWNfc29saWRzLmh0bWxcbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdsYXlvdXQnLCB7XG4gIHNjaGVtYToge1xuICAgIGFuZ2xlOiB7dHlwZTogJ251bWJlcicsIGRlZmF1bHQ6IGZhbHNlLCBtaW46IDAsIG1heDogMzYwLCBpZjoge3R5cGU6IFsnY2lyY2xlJ119fSxcbiAgICBjb2x1bW5zOiB7ZGVmYXVsdDogMSwgbWluOiAwLCBpZjoge3R5cGU6IFsnYm94J119fSxcbiAgICBtYXJnaW46IHtkZWZhdWx0OiAxLCBtaW46IDAsIGlmOiB7dHlwZTogWydib3gnLCAnbGluZSddfX0sXG4gICAgbWFyZ2luQ29sdW1uOiB7ZGVmYXVsdDogMSwgbWluOiAwLCBpZjoge3R5cGU6IFsnYm94J119fSxcbiAgICBtYXJnaW5Sb3c6IHtkZWZhdWx0OiAxLCBtaW46IDAsIGlmOiB7dHlwZTogWydib3gnXX19LFxuICAgIG9yZGVyQXR0cmlidXRlOiB7ZGVmYXVsdDogJyd9LFxuICAgIHBsYW5lOiB7ZGVmYXVsdDogJ3h5J30sXG4gICAgcmFkaXVzOiB7ZGVmYXVsdDogMSwgbWluOiAwLCBpZjoge3R5cGU6IFsnY2lyY2xlJywgJ2N1YmUnLCAnZG9kZWNhaGVkcm9uJywgJ3B5cmFtaWQnXX19LFxuICAgIHJldmVyc2U6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgdHlwZToge2RlZmF1bHQ6ICdsaW5lJywgb25lT2Y6IFsnYm94JywgJ2NpcmNsZScsICdjdWJlJywgJ2RvZGVjYWhlZHJvbicsICdsaW5lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdweXJhbWlkJ119LFxuICAgIGZpbGw6IHtkZWZhdWx0OiB0cnVlLCBpZjoge3R5cGU6IFsnY2lyY2xlJ119fSxcbiAgICBhbGlnbjoge2RlZmF1bHQ6ICdlbmQnLCBvbmVPZjogWydzdGFydCcsICdjZW50ZXInLCAnZW5kJ119XG4gIH0sXG5cbiAgLyoqXG4gICAqIFN0b3JlIGluaXRpYWwgcG9zaXRpb25zIGluIGNhc2UgbmVlZCB0byByZXNldCBvbiBjb21wb25lbnQgcmVtb3ZhbC5cbiAgICovXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcblxuICAgIHRoaXMuY2hpbGRyZW4gPSBlbC5nZXRDaGlsZEVudGl0aWVzKCk7XG4gICAgdGhpcy5pbml0aWFsUG9zaXRpb25zID0gW107XG5cbiAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gZ2V0SW5pdGlhbFBvc2l0aW9ucyAoY2hpbGRFbCkge1xuICAgICAgaWYgKGNoaWxkRWwuaGFzTG9hZGVkKSB7IHJldHVybiBfZ2V0UG9zaXRpb25zKCk7IH1cbiAgICAgIGNoaWxkRWwuYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkJywgX2dldFBvc2l0aW9ucyk7XG4gICAgICBmdW5jdGlvbiBfZ2V0UG9zaXRpb25zICgpIHtcbiAgICAgICAgc2VsZi5pbml0aWFsUG9zaXRpb25zLnB1c2goY2hpbGRFbC5vYmplY3QzRC5wb3NpdGlvbi54KTtcbiAgICAgICAgc2VsZi5pbml0aWFsUG9zaXRpb25zLnB1c2goY2hpbGRFbC5vYmplY3QzRC5wb3NpdGlvbi55KTtcbiAgICAgICAgc2VsZi5pbml0aWFsUG9zaXRpb25zLnB1c2goY2hpbGRFbC5vYmplY3QzRC5wb3NpdGlvbi56KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuaGFuZGxlQ2hpbGRBdHRhY2hlZCA9IHRoaXMuaGFuZGxlQ2hpbGRBdHRhY2hlZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlQ2hpbGREZXRhY2hlZCA9IHRoaXMuaGFuZGxlQ2hpbGREZXRhY2hlZC5iaW5kKHRoaXMpO1xuXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hpbGQtYXR0YWNoZWQnLCB0aGlzLmhhbmRsZUNoaWxkQXR0YWNoZWQpO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoaWxkLWRldGFjaGVkJywgdGhpcy5oYW5kbGVDaGlsZERldGFjaGVkKTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdsYXlvdXRyZWZyZXNoJywgdGhpcy51cGRhdGUuYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBjaGlsZCBlbnRpdHkgcG9zaXRpb25zLlxuICAgKi9cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGRlZmluZWREYXRhO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIG51bUNoaWxkcmVuO1xuICAgIHZhciBwb3NpdGlvbkZuO1xuXG4gICAgbnVtQ2hpbGRyZW4gPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICAvLyBDYWxjdWxhdGUgZGlmZmVyZW50IHBvc2l0aW9ucyBiYXNlZCBvbiBsYXlvdXQgc2hhcGUuXG4gICAgc3dpdGNoIChkYXRhLnR5cGUpIHtcbiAgICAgIGNhc2UgJ2JveCc6IHtcbiAgICAgICAgcG9zaXRpb25GbiA9IGdldEJveFBvc2l0aW9ucztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdjaXJjbGUnOiB7XG4gICAgICAgIHBvc2l0aW9uRm4gPSBnZXRDaXJjbGVQb3NpdGlvbnM7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnY3ViZSc6IHtcbiAgICAgICAgcG9zaXRpb25GbiA9IGdldEN1YmVQb3NpdGlvbnM7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnZG9kZWNhaGVkcm9uJzoge1xuICAgICAgICBwb3NpdGlvbkZuID0gZ2V0RG9kZWNhaGVkcm9uUG9zaXRpb25zO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ3B5cmFtaWQnOiB7XG4gICAgICAgIHBvc2l0aW9uRm4gPSBnZXRQeXJhbWlkUG9zaXRpb25zO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgLy8gTGluZS5cbiAgICAgICAgcG9zaXRpb25GbiA9IGdldExpbmVQb3NpdGlvbnM7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZGVmaW5lZERhdGEgPSBlbC5nZXRET01BdHRyaWJ1dGUoJ2xheW91dCcpO1xuICAgIHBvc2l0aW9ucy5sZW5ndGggPSAwO1xuICAgIHBvc2l0aW9ucyA9IHBvc2l0aW9uRm4oXG4gICAgICBkYXRhLCBudW1DaGlsZHJlbixcbiAgICAgIHR5cGVvZiBkZWZpbmVkRGF0YSA9PT0gJ3N0cmluZydcbiAgICAgICAgPyBkZWZpbmVkRGF0YS5pbmRleE9mKCdtYXJnaW4nKSAhPT0gLTFcbiAgICAgICAgOiAnbWFyZ2luJyBpbiBkZWZpbmVkRGF0YVxuICAgICk7XG4gICAgaWYgKGRhdGEucmV2ZXJzZSkgeyBwb3NpdGlvbnMucmV2ZXJzZSgpOyB9XG4gICAgc2V0UG9zaXRpb25zKGNoaWxkcmVuLCBwb3NpdGlvbnMsIGRhdGEub3JkZXJBdHRyaWJ1dGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZXNldCBwb3NpdGlvbnMuXG4gICAqL1xuICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoaWxkLWF0dGFjaGVkJywgdGhpcy5oYW5kbGVDaGlsZEF0dGFjaGVkKTtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoaWxkLWRldGFjaGVkJywgdGhpcy5oYW5kbGVDaGlsZERldGFjaGVkKTtcbiAgICBzZXRQb3NpdGlvbnModGhpcy5jaGlsZHJlbiwgdGhpcy5pbml0aWFsUG9zaXRpb25zKTtcbiAgfSxcblxuICBoYW5kbGVDaGlsZEF0dGFjaGVkOiBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgLy8gT25seSB1cGRhdGUgaWYgZGlyZWN0IGNoaWxkIGF0dGFjaGVkLlxuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgaWYgKGV2dC5kZXRhaWwuZWwucGFyZW50Tm9kZSAhPT0gZWwpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKGV2dC5kZXRhaWwuZWwpO1xuICAgIHRoaXMudXBkYXRlKCk7XG4gIH0sXG5cbiAgaGFuZGxlQ2hpbGREZXRhY2hlZDogZnVuY3Rpb24gKGV2dCkge1xuICAgIC8vIE9ubHkgdXBkYXRlIGlmIGRpcmVjdCBjaGlsZCBkZXRhY2hlZC5cbiAgICBpZiAodGhpcy5jaGlsZHJlbi5pbmRleE9mKGV2dC5kZXRhaWwuZWwpID09PSAtMSkgeyByZXR1cm47IH1cbiAgICB0aGlzLmNoaWxkcmVuLnNwbGljZSh0aGlzLmNoaWxkcmVuLmluZGV4T2YoZXZ0LmRldGFpbC5lbCksIDEpO1xuICAgIHRoaXMuaW5pdGlhbFBvc2l0aW9ucy5zcGxpY2UodGhpcy5jaGlsZHJlbi5pbmRleE9mKGV2dC5kZXRhaWwuZWwpLCAxKTtcbiAgICB0aGlzLnVwZGF0ZSgpO1xuICB9XG59KTtcblxuLyoqXG4gKiBHZXQgcG9zaXRpb25zIGZvciBgYm94YCBsYXlvdXQuXG4gKi9cbmZ1bmN0aW9uIGdldEJveFBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4sIG1hcmdpbkRlZmluZWQpIHtcbiAgdmFyIGNvbHVtbjtcbiAgdmFyIG1hcmdpbkNvbHVtbjtcbiAgdmFyIG1hcmdpblJvdztcbiAgdmFyIG9mZnNldENvbHVtbjtcbiAgdmFyIG9mZnNldFJvdztcbiAgdmFyIHJvdztcbiAgdmFyIHJvd3MgPSBNYXRoLmNlaWwobnVtQ2hpbGRyZW4gLyBkYXRhLmNvbHVtbnMpO1xuXG4gIG1hcmdpbkNvbHVtbiA9IGRhdGEubWFyZ2luQ29sdW1uO1xuICBtYXJnaW5Sb3cgPSBkYXRhLm1hcmdpblJvdztcbiAgaWYgKG1hcmdpbkRlZmluZWQpIHtcbiAgICBtYXJnaW5Db2x1bW4gPSBkYXRhLm1hcmdpbjtcbiAgICBtYXJnaW5Sb3cgPSBkYXRhLm1hcmdpbjtcbiAgfVxuXG4gIG9mZnNldFJvdyA9IGdldE9mZnNldEl0ZW1JbmRleChkYXRhLmFsaWduLCByb3dzKTtcbiAgb2Zmc2V0Q29sdW1uID0gZ2V0T2Zmc2V0SXRlbUluZGV4KGRhdGEuYWxpZ24sIGRhdGEuY29sdW1ucyk7XG5cbiAgZm9yIChyb3cgPSAwOyByb3cgPCByb3dzOyByb3crKykge1xuICAgIGZvciAoY29sdW1uID0gMDsgY29sdW1uIDwgZGF0YS5jb2x1bW5zOyBjb2x1bW4rKykge1xuICAgICAgcG9zaXRpb25IZWxwZXIuc2V0KDAsIDAsIDApO1xuICAgICAgaWYgKGRhdGEucGxhbmUuaW5kZXhPZigneCcpID09PSAwKSB7XG4gICAgICAgIHBvc2l0aW9uSGVscGVyLnggPSAoY29sdW1uIC0gb2Zmc2V0Q29sdW1uKSAqIG1hcmdpbkNvbHVtbjtcbiAgICAgIH1cbiAgICAgIGlmIChkYXRhLnBsYW5lLmluZGV4T2YoJ3knKSA9PT0gMCkge1xuICAgICAgICBwb3NpdGlvbkhlbHBlci55ID0gKGNvbHVtbiAtIG9mZnNldENvbHVtbikgKiBtYXJnaW5Db2x1bW47XG4gICAgICB9XG4gICAgICBpZiAoZGF0YS5wbGFuZS5pbmRleE9mKCd5JykgPT09IDEpIHtcbiAgICAgICAgcG9zaXRpb25IZWxwZXIueSA9IChyb3cgLSBvZmZzZXRSb3cpICogbWFyZ2luUm93O1xuICAgICAgfVxuICAgICAgaWYgKGRhdGEucGxhbmUuaW5kZXhPZigneicpID09PSAxKSB7XG4gICAgICAgIHBvc2l0aW9uSGVscGVyLnogPSAocm93IC0gb2Zmc2V0Um93KSAqIG1hcmdpblJvdztcbiAgICAgIH1cbiAgICAgIHB1c2hQb3NpdGlvblZlYzMocG9zaXRpb25IZWxwZXIpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwb3NpdGlvbnM7XG59XG5tb2R1bGUuZXhwb3J0cy5nZXRCb3hQb3NpdGlvbnMgPSBnZXRCb3hQb3NpdGlvbnM7XG5cbi8qKlxuICogR2V0IHBvc2l0aW9ucyBmb3IgYGNpcmNsZWAgbGF5b3V0LlxuICovXG5mdW5jdGlvbiBnZXRDaXJjbGVQb3NpdGlvbnMgKGRhdGEsIG51bUNoaWxkcmVuKSB7XG4gIHZhciBpO1xuICB2YXIgcmFkO1xuXG4gIGZvciAoaSA9IDA7IGkgPCBudW1DaGlsZHJlbjsgaSsrKSB7XG4gICAgcmFkO1xuXG4gICAgaWYgKGlzTmFOKGRhdGEuYW5nbGUpKSB7XG4gICAgICByYWQgPSBpICogKDIgKiBNYXRoLlBJKSAvIG51bUNoaWxkcmVuO1xuICAgIH0gZWxzZSB7XG4gICAgICByYWQgPSBpICogZGF0YS5hbmdsZSAqIDAuMDE3NDUzMjkyNTI7ICAvLyBBbmdsZSB0byByYWRpYW4uXG4gICAgfVxuXG4gICAgcG9zaXRpb25IZWxwZXIuc2V0KDAsIDAsIDApO1xuICAgIGlmIChkYXRhLnBsYW5lLmluZGV4T2YoJ3gnKSA9PT0gMCkge1xuICAgICAgcG9zaXRpb25IZWxwZXIueCA9IGRhdGEucmFkaXVzICogTWF0aC5jb3MocmFkKTtcbiAgICB9XG4gICAgaWYgKGRhdGEucGxhbmUuaW5kZXhPZigneScpID09PSAwKSB7XG4gICAgICBwb3NpdGlvbkhlbHBlci55ID0gZGF0YS5yYWRpdXMgKiBNYXRoLmNvcyhyYWQpO1xuICAgIH1cbiAgICBpZiAoZGF0YS5wbGFuZS5pbmRleE9mKCd5JykgPT09IDEpIHtcbiAgICAgIHBvc2l0aW9uSGVscGVyLnkgPSBkYXRhLnJhZGl1cyAqIE1hdGguc2luKHJhZCk7XG4gICAgfVxuICAgIGlmIChkYXRhLnBsYW5lLmluZGV4T2YoJ3onKSA9PT0gMSkge1xuICAgICAgcG9zaXRpb25IZWxwZXIueiA9IGRhdGEucmFkaXVzICogTWF0aC5zaW4ocmFkKTtcbiAgICB9XG4gICAgcHVzaFBvc2l0aW9uVmVjMyhwb3NpdGlvbkhlbHBlcik7XG4gIH1cbiAgcmV0dXJuIHBvc2l0aW9ucztcbn1cbm1vZHVsZS5leHBvcnRzLmdldENpcmNsZVBvc2l0aW9ucyA9IGdldENpcmNsZVBvc2l0aW9ucztcblxuLyoqXG4gKiBHZXQgcG9zaXRpb25zIGZvciBgbGluZWAgbGF5b3V0LlxuICogVE9ETzogM0QgbWFyZ2lucy5cbiAqL1xuZnVuY3Rpb24gZ2V0TGluZVBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4pIHtcbiAgZGF0YS5jb2x1bW5zID0gbnVtQ2hpbGRyZW47XG4gIHJldHVybiBnZXRCb3hQb3NpdGlvbnMoZGF0YSwgbnVtQ2hpbGRyZW4sIHRydWUpO1xufVxubW9kdWxlLmV4cG9ydHMuZ2V0TGluZVBvc2l0aW9ucyA9IGdldExpbmVQb3NpdGlvbnM7XG5cbi8qKlxuICogR2V0IHBvc2l0aW9ucyBmb3IgYGN1YmVgIGxheW91dC5cbiAqL1xuZnVuY3Rpb24gZ2V0Q3ViZVBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4pIHtcbiAgcHVzaFBvc2l0aW9ucyhcbiAgICAxLCAwLCAwLFxuICAgIDAsIDEsIDAsXG4gICAgMCwgMCwgMSxcbiAgICAtMSwgMCwgMCxcbiAgICAwLCAtMSwgMCxcbiAgICAwLCAwLCAtMVxuICApO1xuICBzY2FsZVBvc2l0aW9ucyhkYXRhLnJhZGl1cyAvIDIpO1xuICByZXR1cm4gcG9zaXRpb25zO1xufVxubW9kdWxlLmV4cG9ydHMuZ2V0Q3ViZVBvc2l0aW9ucyA9IGdldEN1YmVQb3NpdGlvbnM7XG5cbi8qKlxuICogR2V0IHBvc2l0aW9ucyBmb3IgYGRvZGVjYWhlZHJvbmAgbGF5b3V0LlxuICovXG5mdW5jdGlvbiBnZXREb2RlY2FoZWRyb25Qb3NpdGlvbnMgKGRhdGEsIG51bUNoaWxkcmVuKSB7XG4gIHZhciBQSEkgPSAoMSArIE1hdGguc3FydCg1KSkgLyAyO1xuICB2YXIgQiA9IDEgLyBQSEk7XG4gIHZhciBDID0gMiAtIFBISTtcbiAgdmFyIE5CID0gLTEgKiBCO1xuICB2YXIgTkMgPSAtMSAqIEM7XG4gIHB1c2hQb3NpdGlvbnMoXG4gICAgLTEsIEMsIDAsXG4gICAgLTEsIE5DLCAwLFxuICAgIDAsIC0xLCBDLFxuICAgIDAsIC0xLCBOQyxcbiAgICAwLCAxLCBDLFxuICAgIDAsIDEsIE5DLFxuICAgIDEsIEMsIDAsXG4gICAgMSwgTkMsIDAsXG4gICAgQiwgQiwgQixcbiAgICBCLCBCLCBOQixcbiAgICBCLCBOQiwgQixcbiAgICBCLCBOQiwgTkIsXG4gICAgQywgMCwgMSxcbiAgICBDLCAwLCAtMSxcbiAgICBOQiwgQiwgQixcbiAgICBOQiwgQiwgTkIsXG4gICAgTkIsIE5CLCBCLFxuICAgIE5CLCBOQiwgTkIsXG4gICAgTkMsIDAsIDEsXG4gICAgTkMsIDAsIC0xXG4gICk7XG4gIHNjYWxlUG9zaXRpb25zKGRhdGEucmFkaXVzIC8gMik7XG4gIHJldHVybiBwb3NpdGlvbnM7XG59XG5tb2R1bGUuZXhwb3J0cy5nZXREb2RlY2FoZWRyb25Qb3NpdGlvbnMgPSBnZXREb2RlY2FoZWRyb25Qb3NpdGlvbnM7XG5cbi8qKlxuICogR2V0IHBvc2l0aW9ucyBmb3IgYHB5cmFtaWRgIGxheW91dC5cbiAqL1xuZnVuY3Rpb24gZ2V0UHlyYW1pZFBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4pIHtcbiAgdmFyIFNRUlRfMyA9IE1hdGguc3FydCgzKTtcbiAgdmFyIE5FR19TUVJUXzFfMyA9IC0xIC8gTWF0aC5zcXJ0KDMpO1xuICB2YXIgREJMX1NRUlRfMl8zID0gMiAqIE1hdGguc3FydCgyIC8gMyk7XG4gIHB1c2hQb3NpdGlvbnMoXG4gICAgMCwgMCwgU1FSVF8zICsgTkVHX1NRUlRfMV8zLFxuICAgIC0xLCAwLCBORUdfU1FSVF8xXzMsXG4gICAgMSwgMCwgTkVHX1NRUlRfMV8zLFxuICAgIDAsIERCTF9TUVJUXzJfMywgMFxuICApO1xuICBzY2FsZVBvc2l0aW9ucyhkYXRhLnJhZGl1cyAvIDIpO1xuICByZXR1cm4gcG9zaXRpb25zO1xufVxubW9kdWxlLmV4cG9ydHMuZ2V0UHlyYW1pZFBvc2l0aW9ucyA9IGdldFB5cmFtaWRQb3NpdGlvbnM7XG5cbi8qKlxuICogUmV0dXJuIHRoZSBpdGVtIGluZGV4IGluIGEgZ2l2ZW4gbGlzdCB0byBjYWxjdWxhdGUgb2Zmc2V0cyBmcm9tXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFsaWduIC0gT25lIG9mIGAnc3RhcnQnYCwgYCdjZW50ZXInYCwgYCdlbmQnYFxuICogQHBhcmFtIHtpbnRlZ2VyfSBudW1JdGVtcyAtIFRvdGFsIG51bWJlciBvZiBpdGVtc1xuICovXG5mdW5jdGlvbiBnZXRPZmZzZXRJdGVtSW5kZXggKGFsaWduLCBudW1JdGVtcykge1xuICBzd2l0Y2ggKGFsaWduKSB7XG4gICAgY2FzZSAnc3RhcnQnOlxuICAgICAgcmV0dXJuIG51bUl0ZW1zIC0gMTtcbiAgICBjYXNlICdjZW50ZXInOlxuICAgICAgcmV0dXJuIChudW1JdGVtcyAtIDEpIC8gMjtcbiAgICBjYXNlICdlbmQnOlxuICAgICAgcmV0dXJuIDA7XG4gIH1cbn1cblxuLyoqXG4gKiBNdWx0aXBseSBhbGwgY29vcmRpbmF0ZXMgYnkgYSBzY2FsZSBmYWN0b3IgYW5kIGFkZCB0cmFuc2xhdGUuXG4gKlxuICogQHBhcmFtcyB7YXJyYXl9IHBvc2l0aW9ucyAtIEFycmF5IG9mIGNvb3JkaW5hdGVzIGluIGFycmF5IGZvcm0uXG4gKiBAcmV0dXJucyB7YXJyYXl9IHBvc2l0aW9uc1xuICovXG5mdW5jdGlvbiBzY2FsZVBvc2l0aW9ucyAoc2NhbGUpIHtcbiAgdmFyIGk7XG4gIGZvciAoaSA9IDA7IGkgPCBwb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICBwb3NpdGlvbnNbaV0gPSBwb3NpdGlvbnNbaV0gKiBzY2FsZTtcbiAgfVxufTtcblxuLyoqXG4gKiBTZXQgcG9zaXRpb24gb24gY2hpbGQgZW50aXRpZXMuXG4gKlxuICogQHBhcmFtIHthcnJheX0gZWxzIC0gQ2hpbGQgZW50aXRpZXMgdG8gc2V0LlxuICogQHBhcmFtIHthcnJheX0gcG9zaXRpb25zIC0gQXJyYXkgb2YgY29vcmRpbmF0ZXMuXG4gKi9cbmZ1bmN0aW9uIHNldFBvc2l0aW9ucyAoZWxzLCBwb3NpdGlvbnMsIG9yZGVyQXR0cmlidXRlKSB7XG4gIHZhciB2YWx1ZTtcbiAgdmFyIGk7XG4gIHZhciBvcmRlckluZGV4O1xuXG4gIC8vIEFsbG93IGZvciBjb250cm9sbGluZyBvcmRlciBleHBsaWNpdGx5IHNpbmNlIERPTSBvcmRlciBkb2VzIG5vdCBoYXZlIGFzIG11Y2hcbiAgLy8gbWVhbmluZyBpbiBBLUZyYW1lLlxuICBpZiAob3JkZXJBdHRyaWJ1dGUpIHtcbiAgICBmb3IgKGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZSA9IGVsc1tpXS5nZXRBdHRyaWJ1dGUob3JkZXJBdHRyaWJ1dGUpO1xuICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHsgY29udGludWU7IH1cbiAgICAgIG9yZGVySW5kZXggPSBwYXJzZUludCh2YWx1ZSwgMTApICogMztcbiAgICAgIGVsc1tpXS5vYmplY3QzRC5wb3NpdGlvbi5zZXQocG9zaXRpb25zW29yZGVySW5kZXhdLCBwb3NpdGlvbnNbb3JkZXJJbmRleCArIDFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbnNbb3JkZXJJbmRleCArIDJdKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgZm9yIChpID0gMDsgaSA8IHBvc2l0aW9ucy5sZW5ndGg7IGkgKz0gMykge1xuICAgIGlmICghZWxzW2kgLyAzXSkgeyByZXR1cm47IH1cbiAgICBlbHNbaSAvIDNdLm9iamVjdDNELnBvc2l0aW9uLnNldChwb3NpdGlvbnNbaV0sIHBvc2l0aW9uc1tpICsgMV0sIHBvc2l0aW9uc1tpICsgMl0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1c2hQb3NpdGlvbnMgKCkge1xuICB2YXIgaTtcbiAgZm9yIChpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIHBvc2l0aW9ucy5wdXNoKGkpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1c2hQb3NpdGlvblZlYzMgKHZlYzMpIHtcbiAgcG9zaXRpb25zLnB1c2godmVjMy54KTtcbiAgcG9zaXRpb25zLnB1c2godmVjMy55KTtcbiAgcG9zaXRpb25zLnB1c2godmVjMy56KTtcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtbGF5b3V0LWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwicmVxdWlyZSgnLi9saWIvT3JiaXRDb250cm9scycpO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ29yYml0LWNvbnRyb2xzJywge1xuICBkZXBlbmRlbmNpZXM6IFsnY2FtZXJhJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgYXV0b1JvdGF0ZToge3R5cGU6ICdib29sZWFuJ30sXG4gICAgYXV0b1JvdGF0ZVNwZWVkOiB7ZGVmYXVsdDogMn0sXG4gICAgZGFtcGluZ0ZhY3Rvcjoge2RlZmF1bHQ6IDAuMX0sXG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGVuYWJsZURhbXBpbmc6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVLZXlzOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlUGFuOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlUm90YXRlOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlWm9vbToge2RlZmF1bHQ6IHRydWV9LFxuICAgIGluaXRpYWxQb3NpdGlvbjoge3R5cGU6ICd2ZWMzJ30sXG4gICAga2V5UGFuU3BlZWQ6IHtkZWZhdWx0OiA3fSxcbiAgICBtaW5BemltdXRoQW5nbGU6IHt0eXBlOiAnbnVtYmVyJywgZGVmYXVsdDogSW5maW5pdHl9LFxuICAgIG1heEF6aW11dGhBbmdsZToge3R5cGU6ICdudW1iZXInLCBkZWZhdWx0OiBJbmZpbml0eX0sXG4gICAgbWF4RGlzdGFuY2U6IHtkZWZhdWx0OiAxMDAwfSxcbiAgICBtYXhQb2xhckFuZ2xlOiB7ZGVmYXVsdDogQUZSQU1FLnV0aWxzLmRldmljZS5pc01vYmlsZSgpID8gOTAgOiAxMjB9LFxuICAgIG1pbkRpc3RhbmNlOiB7ZGVmYXVsdDogMX0sXG4gICAgbWluUG9sYXJBbmdsZToge2RlZmF1bHQ6IDB9LFxuICAgIG1pblpvb206IHtkZWZhdWx0OiAwfSxcbiAgICBwYW5TcGVlZDoge2RlZmF1bHQ6IDF9LFxuICAgIHJvdGF0ZVNwZWVkOiB7ZGVmYXVsdDogMC4wNX0sXG4gICAgc2NyZWVuU3BhY2VQYW5uaW5nOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHRhcmdldDoge3R5cGU6ICd2ZWMzJ30sXG4gICAgem9vbVNwZWVkOiB7ZGVmYXVsdDogMC41fVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBvbGRQb3NpdGlvbjtcblxuICAgIHRoaXMuY29udHJvbHMgPSBuZXcgVEhSRUUuT3JiaXRDb250cm9scyhlbC5nZXRPYmplY3QzRCgnY2FtZXJhJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsLnNjZW5lRWwucmVuZGVyZXIuZG9tRWxlbWVudCk7XG5cbiAgICBvbGRQb3NpdGlvbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cbiAgICBlbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2VudGVyLXZyJywgKCkgPT4ge1xuICAgICAgaWYgKCFBRlJBTUUudXRpbHMuZGV2aWNlLmNoZWNrSGVhZHNldENvbm5lY3RlZCgpICYmXG4gICAgICAgICAgIUFGUkFNRS51dGlscy5kZXZpY2UuaXNNb2JpbGUoKSkgeyByZXR1cm47IH1cbiAgICAgIHRoaXMuY29udHJvbHMuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnbG9vay1jb250cm9scycpKSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbG9vay1jb250cm9scycsICdlbmFibGVkJywgdHJ1ZSk7XG4gICAgICAgIG9sZFBvc2l0aW9uLmNvcHkoZWwuZ2V0T2JqZWN0M0QoJ2NhbWVyYScpLnBvc2l0aW9uKTtcbiAgICAgICAgZWwuZ2V0T2JqZWN0M0QoJ2NhbWVyYScpLnBvc2l0aW9uLnNldCgwLCAwLCAwKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignZXhpdC12cicsICgpID0+IHtcbiAgICAgIGlmICghQUZSQU1FLnV0aWxzLmRldmljZS5jaGVja0hlYWRzZXRDb25uZWN0ZWQoKSAmJlxuICAgICAgICAgICFBRlJBTUUudXRpbHMuZGV2aWNlLmlzTW9iaWxlKCkpIHsgcmV0dXJuOyB9XG4gICAgICB0aGlzLmNvbnRyb2xzLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgZWwuZ2V0T2JqZWN0M0QoJ2NhbWVyYScpLnBvc2l0aW9uLmNvcHkob2xkUG9zaXRpb24pO1xuICAgICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnbG9vay1jb250cm9scycpKSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbG9vay1jb250cm9scycsICdlbmFibGVkJywgZmFsc2UpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSAnZ3JhYic7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKCkgPT4ge1xuICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnO1xuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoKSA9PiB7XG4gICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICdncmFiJztcbiAgICB9KTtcblxuICAgIHRoaXMudGFyZ2V0ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICBlbC5nZXRPYmplY3QzRCgnY2FtZXJhJykucG9zaXRpb24uY29weSh0aGlzLmRhdGEuaW5pdGlhbFBvc2l0aW9uKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGNvbnRyb2xzID0gdGhpcy5jb250cm9scztcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGNvbnRyb2xzLnRhcmdldCA9IHRoaXMudGFyZ2V0LmNvcHkoZGF0YS50YXJnZXQpO1xuICAgIGNvbnRyb2xzLmF1dG9Sb3RhdGUgPSBkYXRhLmF1dG9Sb3RhdGU7XG4gICAgY29udHJvbHMuYXV0b1JvdGF0ZVNwZWVkID0gZGF0YS5hdXRvUm90YXRlU3BlZWQ7XG4gICAgY29udHJvbHMuZGFtcGluZ0ZhY3RvciA9IGRhdGEuZGFtcGluZ0ZhY3RvcjtcbiAgICBjb250cm9scy5lbmFibGVkID0gZGF0YS5lbmFibGVkO1xuICAgIGNvbnRyb2xzLmVuYWJsZURhbXBpbmcgPSBkYXRhLmVuYWJsZURhbXBpbmc7XG4gICAgY29udHJvbHMuZW5hYmxlS2V5cyA9IGRhdGEuZW5hYmxlS2V5cztcbiAgICBjb250cm9scy5lbmFibGVQYW4gPSBkYXRhLmVuYWJsZVBhbjtcbiAgICBjb250cm9scy5lbmFibGVSb3RhdGUgPSBkYXRhLmVuYWJsZVJvdGF0ZTtcbiAgICBjb250cm9scy5lbmFibGVab29tID0gZGF0YS5lbmFibGVab29tO1xuICAgIGNvbnRyb2xzLmtleVBhblNwZWVkID0gZGF0YS5rZXlQYW5TcGVlZDtcbiAgICBjb250cm9scy5tYXhQb2xhckFuZ2xlID0gVEhSRUUuTWF0aC5kZWdUb1JhZChkYXRhLm1heFBvbGFyQW5nbGUpO1xuICAgIGNvbnRyb2xzLm1heERpc3RhbmNlID0gZGF0YS5tYXhEaXN0YW5jZTtcbiAgICBjb250cm9scy5taW5EaXN0YW5jZSA9IGRhdGEubWluRGlzdGFuY2U7XG4gICAgY29udHJvbHMubWluUG9sYXJBbmdsZSA9IFRIUkVFLk1hdGguZGVnVG9SYWQoZGF0YS5taW5Qb2xhckFuZ2xlKTtcbiAgICBjb250cm9scy5taW5ab29tID0gZGF0YS5taW5ab29tO1xuICAgIGNvbnRyb2xzLnBhblNwZWVkID0gZGF0YS5wYW5TcGVlZDtcbiAgICBjb250cm9scy5yb3RhdGVTcGVlZCA9IGRhdGEucm90YXRlU3BlZWQ7XG4gICAgY29udHJvbHMuc2NyZWVuU3BhY2VQYW5uaW5nID0gZGF0YS5zY3JlZW5TcGFjZVBhbm5pbmc7XG4gICAgY29udHJvbHMuem9vbVNwZWVkID0gZGF0YS56b29tU3BlZWQ7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjb250cm9scyA9IHRoaXMuY29udHJvbHM7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgaWYgKCFkYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgaWYgKGNvbnRyb2xzLmVuYWJsZWQgJiYgKGNvbnRyb2xzLmVuYWJsZURhbXBpbmcgfHwgY29udHJvbHMuYXV0b1JvdGF0ZSkpIHtcbiAgICAgIHRoaXMuY29udHJvbHMudXBkYXRlKCk7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtb3JiaXQtY29udHJvbHMvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDI2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogTGlzdGVuIHRvIGV2ZW50IGFuZCBmb3J3YXJkIHRvIGFub3RoZXIgZW50aXR5IG9yIGVudGl0aWVzLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3Byb3h5LWV2ZW50Jywge1xuICBzY2hlbWE6IHtcbiAgICBjYXB0dXJlQnViYmxlczoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZXZlbnQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgZnJvbToge3R5cGU6ICdzdHJpbmcnfSxcbiAgICB0bzoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBhczoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBidWJibGVzOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGZyb207XG4gICAgdmFyIGk7XG4gICAgdmFyIHRvO1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIGlmIChkYXRhLmZyb20pIHtcbiAgICAgIGlmIChkYXRhLmZyb20gPT09ICdQQVJFTlQnKSB7XG4gICAgICAgIGZyb20gPSBbZWwucGFyZW50Tm9kZV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmcm9tID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChkYXRhLmZyb20pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZGF0YS50byA9PT0gJ0NISUxEUkVOJykge1xuICAgICAgICB0byA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJyonKTtcbiAgICAgIH0gZWxzZSBpZiAoZGF0YS50byA9PT0gJ1NFTEYnKSB7XG4gICAgICAgIHRvID0gW2VsXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChkYXRhLnRvKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZGF0YS5mcm9tKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgZnJvbS5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJGcm9tKGZyb21baV0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKGRhdGEuZXZlbnQsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBzZWxmLmRhdGE7XG4gICAgICAgIGlmICghZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgICAgICBpZiAoIWRhdGEuY2FwdHVyZUJ1YmJsZXMgJiYgZXZ0LnRhcmdldCAhPT0gZWwpIHsgcmV0dXJuOyB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCB0by5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRvW2ldLmVtaXQoZGF0YS5hcyB8fCBkYXRhLmV2ZW50LCBldnRbJ2RldGFpbCddID8gZXZ0LmRldGFpbCA6IG51bGwsIGRhdGEuYnViYmxlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICBhZGRFdmVudExpc3RlbmVyRnJvbTogZnVuY3Rpb24gKGZyb21FbCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBmcm9tRWwuYWRkRXZlbnRMaXN0ZW5lcihkYXRhLmV2ZW50LCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICB2YXIgZGF0YSA9IHNlbGYuZGF0YTtcbiAgICAgIGlmICghZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgICAgaWYgKCFkYXRhLmNhcHR1cmVCdWJibGVzICYmIGV2dC50YXJnZXQgIT09IGZyb21FbCkgeyByZXR1cm47IH1cbiAgICAgIHNlbGYuZWwuZW1pdChkYXRhLmFzIHx8IGRhdGEuZXZlbnQsIGV2dFsnZGV0YWlsJ10gPyBldnQuZGV0YWlsIDogbnVsbCwgZmFsc2UpO1xuICAgIH0pO1xuICB9XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtcHJveHktZXZlbnQtY29tcG9uZW50L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAyN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gZmFjdG9yeSgpO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuLyogZ2xvYmFsIEFGUkFNRSAqL1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0dGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxuQUZSQU1FLnJlZ2lzdGVyU2hhZGVyKCdyaW5nJywge1xuXHRzY2hlbWE6IHtcblx0XHRibHVyOiB7IGRlZmF1bHQ6IDAuMDEsIGlzOiAndW5pZm9ybScgfSxcblx0XHRjb2xvcjogeyB0eXBlOiAnY29sb3InLCBpczogJ3VuaWZvcm0nIH0sXG5cdFx0cHJvZ3Jlc3M6IHsgZGVmYXVsdDogMCwgaXM6ICd1bmlmb3JtJyB9LFxuXHRcdHJhZGl1c0lubmVyOiB7IGRlZmF1bHQ6IDAuODUsIGlzOiAndW5pZm9ybScgfSxcblx0XHRyYWRpdXNPdXRlcjogeyBkZWZhdWx0OiAxLCBpczogJ3VuaWZvcm0nIH1cblx0fSxcblxuXHR2ZXJ0ZXhTaGFkZXI6IF9fd2VicGFja19yZXF1aXJlX18oMSksXG5cblx0ZnJhZ21lbnRTaGFkZXI6IF9fd2VicGFja19yZXF1aXJlX18oMilcbn0pO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSBcInZhcnlpbmcgdmVjMiB2VXY7XFxuXFxudm9pZCBtYWluICgpIHtcXG4gIHZVdiA9IHV2O1xcbiAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNChwb3NpdGlvbiwgMS4wKTtcXG59XFxuXCJcblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gXCIjZGVmaW5lIFBJIDMuMTQxNTkyNjUzNTg5NzlcXG51bmlmb3JtIGZsb2F0IGJsdXI7XFxudW5pZm9ybSBmbG9hdCBwcm9ncmVzcztcXG51bmlmb3JtIGZsb2F0IHJhZGl1c0lubmVyO1xcbnVuaWZvcm0gZmxvYXQgcmFkaXVzT3V0ZXI7XFxudW5pZm9ybSB2ZWMzIGNvbG9yO1xcblxcbnZhcnlpbmcgdmVjMiB2VXY7XFxuXFxudm9pZCBtYWluICgpIHtcXG4gIHZlYzIgdXYgPSB2ZWMyKHZVdi54ICogMi4gLSAxLiwgdlV2LnkgKiAyLiAtIDEuKTtcXG4gIGZsb2F0IHIgPSB1di54ICogdXYueCArIHV2LnkgKiB1di55O1xcbiAgZmxvYXQgY29sID0gKDEuMCAtIHNtb290aHN0ZXAocmFkaXVzT3V0ZXIsIHJhZGl1c091dGVyICsgYmx1ciwgcikpICogc21vb3Roc3RlcChyYWRpdXNJbm5lciwgcmFkaXVzSW5uZXIgKyBibHVyLCByKTtcXG4gIGZsb2F0IGEgPSBzbW9vdGhzdGVwKC1QSSwgUEksIGF0YW4odXYueSwgdXYueCkpO1xcbiAgZmxvYXQgcCA9IDEuMCAtIHByb2dyZXNzIC0gYmx1cjtcXG4gIGNvbCAqPSBzbW9vdGhzdGVwKHAsIHAgKyBibHVyLCBhKTtcXG4gIGdsX0ZyYWdDb2xvciA9IHZlYzQoY29sb3IgKiBjb2wsIGNvbCk7XFxufVxcblwiXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcbn0pO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtcmluZy1zaGFkZXIvZGlzdC9hZnJhbWUtcmluZy1zaGFkZXIuanNcbi8vIG1vZHVsZSBpZCA9IDI4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qIGdsb2JhbCBBRlJBTUUgKi9cblxuaWYgKHR5cGVvZiBBRlJBTUUgPT09ICd1bmRlZmluZWQnKSB7XG4gIHRocm93IG5ldyBFcnJvcignQ29tcG9uZW50IGF0dGVtcHRlZCB0byByZWdpc3RlciBiZWZvcmUgQUZSQU1FIHdhcyBhdmFpbGFibGUuJyk7XG59XG5cbi8qKlxuICogU2xpY2U5IGNvbXBvbmVudCBmb3IgQS1GcmFtZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzbGljZTknLCB7XG4gIHNjaGVtYToge1xuICAgIHdpZHRoOiB7ZGVmYXVsdDogMSwgbWluOiAwfSxcbiAgICBoZWlnaHQ6IHtkZWZhdWx0OiAxLCBtaW46IDB9LFxuICAgIGxlZnQ6IHtkZWZhdWx0OiAwLCBtaW46IDB9LFxuICAgIHJpZ2h0OiB7ZGVmYXVsdDogMCwgbWluOiAwfSxcbiAgICBib3R0b206IHtkZWZhdWx0OiAwLCBtaW46IDB9LFxuICAgIHRvcDoge2RlZmF1bHQ6IDAsIG1pbjogMH0sXG4gICAgc2lkZToge2RlZmF1bHQ6ICdmcm9udCcsIG9uZU9mOiBbJ2Zyb250JywgJ2JhY2snLCAnZG91YmxlJ119LFxuICAgIHBhZGRpbmc6IHtkZWZhdWx0OiAwLjEsIG1pbjogMC4wMX0sXG4gICAgY29sb3I6IHt0eXBlOiAnY29sb3InLCBkZWZhdWx0OiAnI2ZmZid9LFxuICAgIG9wYWNpdHk6IHtkZWZhdWx0OiAxLjAsIG1pbjogMCwgbWF4OiAxfSxcbiAgICB0cmFuc3BhcmVudDoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGRlYnVnOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHNyYzoge3R5cGU6ICdtYXAnfVxuICB9LFxuXG4gIC8qKlxuICAgKiBTZXQgaWYgY29tcG9uZW50IG5lZWRzIG11bHRpcGxlIGluc3RhbmNpbmcuXG4gICAqL1xuICBtdWx0aXBsZTogZmFsc2UsXG5cbiAgLyoqXG4gICAqIENhbGxlZCBvbmNlIHdoZW4gY29tcG9uZW50IGlzIGF0dGFjaGVkLiBHZW5lcmFsbHkgZm9yIGluaXRpYWwgc2V0dXAuXG4gICAqL1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIG1hdGVyaWFsID0gdGhpcy5tYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7Y29sb3I6IGRhdGEuY29sb3IsIG9wYWNpdHk6IGRhdGEub3BhY2l0eSwgdHJhbnNwYXJlbnQ6IGRhdGEudHJhbnNwYXJlbnQsIHdpcmVmcmFtZTogZGF0YS5kZWJ1Z30pO1xuICAgIHZhciBnZW9tZXRyeSA9IHRoaXMuZ2VvbWV0cnkgPSBuZXcgVEhSRUUuUGxhbmVCdWZmZXJHZW9tZXRyeShkYXRhLndpZHRoLCBkYXRhLmhlaWdodCwgMywgMyk7XG5cbiAgICB2YXIgdGV4dHVyZUxvYWRlciA9IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCk7XG4gICAgdGhpcy5wbGFuZSA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7XG4gICAgdGhpcy5lbC5zZXRPYmplY3QzRCgnbWVzaCcsIHRoaXMucGxhbmUpO1xuICAgIHRoaXMudGV4dHVyZVNyYyA9IG51bGw7XG4gIH0sXG5cbiAgdXBkYXRlTWFwOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNyYyA9IHRoaXMuZGF0YS5zcmM7XG5cbiAgICBpZiAoc3JjKSB7XG4gICAgICBpZiAoc3JjID09PSB0aGlzLnRleHR1cmVTcmMpIHsgcmV0dXJuOyB9XG4gICAgICAvLyBUZXh0dXJlIGFkZGVkIG9yIGNoYW5nZWQuXG4gICAgICB0aGlzLnRleHR1cmVTcmMgPSBzcmM7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbC5sb2FkVGV4dHVyZShzcmMsIHtzcmM6IHNyY30sIHNldE1hcC5iaW5kKHRoaXMpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBUZXh0dXJlIHJlbW92ZWQuXG4gICAgaWYgKCF0aGlzLm1hdGVyaWFsLm1hcCkgeyByZXR1cm47IH1cbiAgICBzZXRNYXAobnVsbCk7XG5cblxuICAgIGZ1bmN0aW9uIHNldE1hcCAodGV4dHVyZSkge1xuICAgICAgdGhpcy5tYXRlcmlhbC5tYXAgPSB0ZXh0dXJlO1xuICAgICAgdGhpcy5tYXRlcmlhbC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgICB0aGlzLnJlZ2VuZXJhdGVNZXNoKCk7XG4gICAgfVxuICB9LFxuXG4gIHJlZ2VuZXJhdGVNZXNoOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIHBvcyA9IHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheTtcbiAgICB2YXIgdXZzID0gdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnV2LmFycmF5O1xuICAgIHZhciBpbWFnZSA9IHRoaXMubWF0ZXJpYWwubWFwLmltYWdlO1xuXG4gICAgaWYgKCFpbWFnZSkge3JldHVybjt9XG5cbiAgICAvKlxuICAgICAgMC0tMS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTItLTNcbiAgICAgIHwgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICB8XG4gICAgICA0LS01LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tNi0tN1xuICAgICAgfCAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIHxcbiAgICAgIHwgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICB8XG4gICAgICB8ICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgfFxuICAgICAgOC0tOS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTAtLTExXG4gICAgICB8ICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgfFxuICAgICAgMTItMTMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTQtLTE1XG4gICAgKi9cbiAgICBmdW5jdGlvbiBzZXRQb3MoaWQsIHgsIHkpIHtcbiAgICAgIHBvc1szICogaWRdID0geDtcbiAgICAgIHBvc1szICogaWQgKyAxXSA9IHk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0VVYoaWQsIHUsIHYpIHtcbiAgICAgIHV2c1syICogaWRdID0gdTtcbiAgICAgIHV2c1syICogaWQgKyAxXSA9IHY7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIFVWU1xuICAgIHZhciB1diA9IHtcbiAgICAgIGxlZnQ6IGRhdGEubGVmdCAvIGltYWdlLndpZHRoLFxuICAgICAgcmlnaHQ6IGRhdGEucmlnaHQgLyBpbWFnZS53aWR0aCxcbiAgICAgIHRvcDogZGF0YS50b3AgLyBpbWFnZS5oZWlnaHQsXG4gICAgICBib3R0b206IGRhdGEuYm90dG9tIC8gaW1hZ2UuaGVpZ2h0XG4gICAgfTtcblxuICAgIHNldFVWKDEsICB1di5sZWZ0LCAgMSk7XG4gICAgc2V0VVYoMiwgIHV2LnJpZ2h0LCAxKTtcblxuICAgIHNldFVWKDQsICAwLCAgICAgICAgdXYuYm90dG9tKTtcbiAgICBzZXRVVig1LCAgdXYubGVmdCwgIHV2LmJvdHRvbSk7XG4gICAgc2V0VVYoNiwgIHV2LnJpZ2h0LCB1di5ib3R0b20pO1xuICAgIHNldFVWKDcsICAxLCAgICAgICAgdXYuYm90dG9tKTtcblxuICAgIHNldFVWKDgsICAwLCAgICAgICAgdXYudG9wKTtcbiAgICBzZXRVVig5LCAgdXYubGVmdCwgIHV2LnRvcCk7XG4gICAgc2V0VVYoMTAsIHV2LnJpZ2h0LCB1di50b3ApO1xuICAgIHNldFVWKDExLCAxLCAgICAgICAgdXYudG9wKTtcblxuICAgIHNldFVWKDEzLCB1di5sZWZ0LCAgMCk7XG4gICAgc2V0VVYoMTQsIHV2LnJpZ2h0LCAwKTtcblxuICAgIC8vIFVwZGF0ZSB2ZXJ0ZXggcG9zaXRpb25zXG4gICAgdmFyIHcyID0gZGF0YS53aWR0aCAvIDI7XG4gICAgdmFyIGgyID0gZGF0YS5oZWlnaHQgLyAyO1xuICAgIHZhciBsZWZ0ID0gLXcyICsgZGF0YS5wYWRkaW5nO1xuICAgIHZhciByaWdodCA9IHcyIC0gZGF0YS5wYWRkaW5nO1xuICAgIHZhciB0b3AgPSBoMiAtIGRhdGEucGFkZGluZztcbiAgICB2YXIgYm90dG9tID0gLWgyICsgZGF0YS5wYWRkaW5nO1xuXG4gICAgc2V0UG9zKDAsIC13MiwgICAgaDIpO1xuICAgIHNldFBvcygxLCBsZWZ0LCAgIGgyKTtcbiAgICBzZXRQb3MoMiwgcmlnaHQsICBoMik7XG4gICAgc2V0UG9zKDMsIHcyLCAgICAgaDIpO1xuXG4gICAgc2V0UG9zKDQsIC13MiwgICAgdG9wKTtcbiAgICBzZXRQb3MoNSwgbGVmdCwgICB0b3ApO1xuICAgIHNldFBvcyg2LCByaWdodCwgIHRvcCk7XG4gICAgc2V0UG9zKDcsIHcyLCAgICAgdG9wKTtcblxuICAgIHNldFBvcyg4LCAtdzIsICAgIGJvdHRvbSk7XG4gICAgc2V0UG9zKDksIGxlZnQsICAgYm90dG9tKTtcbiAgICBzZXRQb3MoMTAsIHJpZ2h0LCBib3R0b20pO1xuICAgIHNldFBvcygxMSwgdzIsICAgIGJvdHRvbSk7XG5cbiAgICBzZXRQb3MoMTMsIGxlZnQsICAtaDIpO1xuICAgIHNldFBvcygxNCwgcmlnaHQsIC1oMik7XG4gICAgc2V0UG9zKDEyLCAtdzIsICAgLWgyKTtcbiAgICBzZXRQb3MoMTUsIHcyLCAgICAtaDIpO1xuXG4gICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMudXYubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBjb21wb25lbnQgaXMgYXR0YWNoZWQgYW5kIHdoZW4gY29tcG9uZW50IGRhdGEgY2hhbmdlcy5cbiAgICogR2VuZXJhbGx5IG1vZGlmaWVzIHRoZSBlbnRpdHkgYmFzZWQgb24gdGhlIGRhdGEuXG4gICAqL1xuICAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgICB0aGlzLm1hdGVyaWFsLmNvbG9yLnNldFN0eWxlKGRhdGEuY29sb3IpO1xuICAgICB0aGlzLm1hdGVyaWFsLm9wYWNpdHkgPSBkYXRhLm9wYWNpdHk7XG4gICAgIHRoaXMubWF0ZXJpYWwudHJhbnNwYXJlbnQgPSBkYXRhLnRyYW5zcGFyZW50O1xuICAgICB0aGlzLm1hdGVyaWFsLndpcmVmcmFtZSA9IGRhdGEuZGVidWc7XG4gICAgIHRoaXMubWF0ZXJpYWwuc2lkZSA9IHBhcnNlU2lkZShkYXRhLnNpZGUpO1xuXG4gICAgIHZhciBkaWZmID0gQUZSQU1FLnV0aWxzLmRpZmYoZGF0YSwgb2xkRGF0YSk7XG4gICAgIGlmICgnc3JjJyBpbiBkaWZmKSB7XG4gICAgICAgdGhpcy51cGRhdGVNYXAoKTtcbiAgICAgfVxuICAgICBlbHNlIGlmICgnd2lkdGgnIGluIGRpZmYgfHwgJ2hlaWdodCcgaW4gZGlmZiB8fCAncGFkZGluZycgaW4gZGlmZiB8fCAnbGVmdCcgaW4gZGlmZiB8fMKgJ3RvcCcgaW4gZGlmZiB8fMKgJ2JvdHRvbScgaW4gZGlmZiB8fMKgJ3JpZ2h0JyBpbiBkaWZmKSB7XG4gICAgICAgdGhpcy5yZWdlbmVyYXRlTWVzaCgpO1xuICAgICB9XG4gICB9LFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIGNvbXBvbmVudCBpcyByZW1vdmVkIChlLmcuLCB2aWEgcmVtb3ZlQXR0cmlidXRlKS5cbiAgICogR2VuZXJhbGx5IHVuZG9lcyBhbGwgbW9kaWZpY2F0aW9ucyB0byB0aGUgZW50aXR5LlxuICAgKi9cbiAgcmVtb3ZlOiBmdW5jdGlvbiAoKSB7IH0sXG5cbiAgLyoqXG4gICAqIENhbGxlZCBvbiBlYWNoIHNjZW5lIHRpY2suXG4gICAqL1xuICAvLyB0aWNrOiBmdW5jdGlvbiAodCkgeyB9LFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBlbnRpdHkgcGF1c2VzLlxuICAgKiBVc2UgdG8gc3RvcCBvciByZW1vdmUgYW55IGR5bmFtaWMgb3IgYmFja2dyb3VuZCBiZWhhdmlvciBzdWNoIGFzIGV2ZW50cy5cbiAgICovXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7IH0sXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGVudGl0eSByZXN1bWVzLlxuICAgKiBVc2UgdG8gY29udGludWUgb3IgYWRkIGFueSBkeW5hbWljIG9yIGJhY2tncm91bmQgYmVoYXZpb3Igc3VjaCBhcyBldmVudHMuXG4gICAqL1xuICBwbGF5OiBmdW5jdGlvbiAoKSB7IH1cbn0pO1xuXG5mdW5jdGlvbiBwYXJzZVNpZGUgKHNpZGUpIHtcbiAgc3dpdGNoIChzaWRlKSB7XG4gICAgY2FzZSAnYmFjayc6IHtcbiAgICAgIHJldHVybiBUSFJFRS5CYWNrU2lkZTtcbiAgICB9XG4gICAgY2FzZSAnZG91YmxlJzoge1xuICAgICAgcmV0dXJuIFRIUkVFLkRvdWJsZVNpZGU7XG4gICAgfVxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIC8vIEluY2x1ZGluZyBjYXNlIGBmcm9udGAuXG4gICAgICByZXR1cm4gVEhSRUUuRnJvbnRTaWRlO1xuICAgIH1cbiAgfVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1zbGljZTktY29tcG9uZW50L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAyOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gZmFjdG9yeSgpO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuLy8gUHJlLWNvbXBpbGVkIGZ1bmN0aW9ucy5cbnZhciBzZWxlY3RGdW5jdGlvbnMgPSB7fTtcblxuLyoqXG4gKiBTZWxlY3QgdmFsdWUgZnJvbSBzdG9yZS4gSGFuZGxlcyBib29sZWFuIG9wZXJhdGlvbnMsIGNhbGxzIGBzZWxlY3RQcm9wZXJ0eWAuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHN0YXRlIC0gU3RhdGUgb2JqZWN0LlxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yIC0gRG90LWRlbGltaXRlZCBzdG9yZSBrZXlzIChlLmcuLCBnYW1lLnBsYXllci5oZWFsdGgpLlxuICogQHBhcmFtIHtvYmplY3R9IGl0ZW0gLSBGcm9tIGJpbmQtaXRlbS5cbiAqL1xuZnVuY3Rpb24gc2VsZWN0KHN0YXRlLCBzZWxlY3RvciwgaXRlbSkge1xuICBpZiAoIXNlbGVjdEZ1bmN0aW9uc1tzZWxlY3Rvcl0pIHtcbiAgICBzZWxlY3RGdW5jdGlvbnNbc2VsZWN0b3JdID0gbmV3IEZ1bmN0aW9uKCdzdGF0ZScsICdpdGVtJywgJ3JldHVybiAnICsgZ2VuZXJhdGVFeHByZXNzaW9uKHNlbGVjdG9yKSArICc7Jyk7XG4gIH1cbiAgcmV0dXJuIHNlbGVjdEZ1bmN0aW9uc1tzZWxlY3Rvcl0oc3RhdGUsIGl0ZW0pO1xufVxubW9kdWxlLmV4cG9ydHMuc2VsZWN0ID0gc2VsZWN0O1xuXG52YXIgRE9UX05PVEFUSU9OX1JFID0gL1xcLihbQS1aYS16XVtcXHdfLV0qKS9nO1xudmFyIFdISVRFU1BBQ0VfUkUgPSAvXFxzL2c7XG52YXIgU1RBVEVfU0VMRUNUT1JfUkUgPSAvKFs9JnwhPzorLV0pKFxccyopKFtcXChdPykoW0EtWmEtel1bXFx3Xy1dKikvZztcbnZhciBST09UX1NUQVRFX1NFTEVDVE9SX1JFID0gL14oW1xcKF0/KShbQS1aYS16XVtcXHdfLV0qKS9nO1xudmFyIElURU1fUkUgPSAvc3RhdGVcXFtcIml0ZW1cIlxcXS9nO1xudmFyIFNUQVRFX1NUUiA9ICdzdGF0ZSc7XG5mdW5jdGlvbiBnZW5lcmF0ZUV4cHJlc3Npb24oc3RyKSB7XG4gIHN0ciA9IHN0ci5yZXBsYWNlKERPVF9OT1RBVElPTl9SRSwgJ1tcIiQxXCJdJyk7XG4gIHN0ciA9IHN0ci5yZXBsYWNlKFJPT1RfU1RBVEVfU0VMRUNUT1JfUkUsICckMXN0YXRlW1wiJDJcIl0nKTtcbiAgc3RyID0gc3RyLnJlcGxhY2UoU1RBVEVfU0VMRUNUT1JfUkUsICckMSQyJDNzdGF0ZVtcIiQ0XCJdJyk7XG4gIHN0ciA9IHN0ci5yZXBsYWNlKElURU1fUkUsICdpdGVtJyk7XG4gIHJldHVybiBzdHI7XG59XG5tb2R1bGUuZXhwb3J0cy5nZW5lcmF0ZUV4cHJlc3Npb24gPSBnZW5lcmF0ZUV4cHJlc3Npb247XG5cbmZ1bmN0aW9uIGNsZWFyT2JqZWN0KG9iaikge1xuICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgZGVsZXRlIG9ialtrZXldO1xuICB9XG59XG5tb2R1bGUuZXhwb3J0cy5jbGVhck9iamVjdCA9IGNsZWFyT2JqZWN0O1xuXG4vKipcbiAqIEhlbHBlciB0byBjb21wb3NlIG9iamVjdCBvZiBoYW5kbGVycywgbWVyZ2luZyBmdW5jdGlvbnMgaGFuZGxpbmcgc2FtZSBhY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIGNvbXBvc2VIYW5kbGVycygpIHtcbiAgdmFyIGFjdGlvbk5hbWU7XG4gIHZhciBpO1xuICB2YXIgaW5wdXRIYW5kbGVycyA9IGFyZ3VtZW50cztcbiAgdmFyIG91dHB1dEhhbmRsZXJzO1xuXG4gIG91dHB1dEhhbmRsZXJzID0ge307XG4gIGZvciAoaSA9IDA7IGkgPCBpbnB1dEhhbmRsZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChhY3Rpb25OYW1lIGluIGlucHV0SGFuZGxlcnNbaV0pIHtcbiAgICAgIGlmIChhY3Rpb25OYW1lIGluIG91dHB1dEhhbmRsZXJzKSB7XG4gICAgICAgIC8vIEluaXRpYWwgY29tcG9zZS9tZXJnZSBmdW5jdGlvbnMgaW50byBhcnJheXMuXG4gICAgICAgIGlmIChvdXRwdXRIYW5kbGVyc1thY3Rpb25OYW1lXS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHtcbiAgICAgICAgICBvdXRwdXRIYW5kbGVyc1thY3Rpb25OYW1lXS5wdXNoKGlucHV0SGFuZGxlcnNbaV1bYWN0aW9uTmFtZV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG91dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdID0gW291dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdLCBpbnB1dEhhbmRsZXJzW2ldW2FjdGlvbk5hbWVdXTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3V0cHV0SGFuZGxlcnNbYWN0aW9uTmFtZV0gPSBpbnB1dEhhbmRsZXJzW2ldW2FjdGlvbk5hbWVdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIENvbXBvc2UgZnVuY3Rpb25zIHNwZWNpZmllZCB2aWEgYXJyYXkuXG4gIGZvciAoYWN0aW9uTmFtZSBpbiBvdXRwdXRIYW5kbGVycykge1xuICAgIGlmIChvdXRwdXRIYW5kbGVyc1thY3Rpb25OYW1lXS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHtcbiAgICAgIG91dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdID0gY29tcG9zZUZ1bmN0aW9ucy5hcHBseSh0aGlzLCBvdXRwdXRIYW5kbGVyc1thY3Rpb25OYW1lXSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG91dHB1dEhhbmRsZXJzO1xufVxubW9kdWxlLmV4cG9ydHMuY29tcG9zZUhhbmRsZXJzID0gY29tcG9zZUhhbmRsZXJzO1xuXG5mdW5jdGlvbiBjb21wb3NlRnVuY3Rpb25zKCkge1xuICB2YXIgZnVuY3Rpb25zID0gYXJndW1lbnRzO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBmdW5jdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZ1bmN0aW9uc1tpXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfTtcbn1cbm1vZHVsZS5leHBvcnRzLmNvbXBvc2VGdW5jdGlvbnMgPSBjb21wb3NlRnVuY3Rpb25zO1xuXG52YXIgTk9fV0FUQ0hfVE9LRU5TID0gWyd8fCcsICcmJicsICchPScsICchPT0nLCAnPT0nLCAnPT09JywgJz4nLCAnPCcsICc8PScsICc+PSddO1xudmFyIFdISVRFU1BBQ0VfUExVU19SRSA9IC9cXHMrLztcbmZ1bmN0aW9uIHBhcnNlS2V5c1RvV2F0Y2goa2V5cywgc3RyLCBpc0JpbmRJdGVtKSB7XG4gIHZhciBpO1xuICB2YXIgdG9rZW5zO1xuICB0b2tlbnMgPSBzcGxpdChzdHIsIFdISVRFU1BBQ0VfUExVU19SRSk7XG4gIGZvciAoaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoTk9fV0FUQ0hfVE9LRU5TLmluZGV4T2YodG9rZW5zW2ldKSA9PT0gLTEgJiYgIXRva2Vuc1tpXS5zdGFydHNXaXRoKFwiJ1wiKSAmJiBrZXlzLmluZGV4T2YodG9rZW5zW2ldKSA9PT0gLTEpIHtcbiAgICAgIGlmIChpc0JpbmRJdGVtICYmIHRva2Vuc1tpXSA9PT0gJ2l0ZW0nKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAga2V5cy5wdXNoKHBhcnNlS2V5VG9XYXRjaCh0b2tlbnNbaV0pKTtcbiAgICB9XG4gIH1cbn1cbm1vZHVsZS5leHBvcnRzLnBhcnNlS2V5c1RvV2F0Y2ggPSBwYXJzZUtleXNUb1dhdGNoO1xuXG5mdW5jdGlvbiBwYXJzZUtleVRvV2F0Y2goc3RyKSB7XG4gIHZhciBkb3RJbmRleDtcbiAgc3RyID0gc3RyaXBOb3Qoc3RyLnRyaW0oKSk7XG4gIGRvdEluZGV4ID0gc3RyLmluZGV4T2YoJy4nKTtcbiAgaWYgKGRvdEluZGV4ID09PSAtMSkge1xuICAgIHJldHVybiBzdHI7XG4gIH1cbiAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCwgc3RyLmluZGV4T2YoJy4nKSk7XG59XG5cbmZ1bmN0aW9uIHN0cmlwTm90KHN0cikge1xuICBpZiAoc3RyLmluZGV4T2YoJyEhJykgPT09IDApIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoJyEhJywgJycpO1xuICB9IGVsc2UgaWYgKHN0ci5pbmRleE9mKCchJykgPT09IDApIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoJyEnLCAnJyk7XG4gIH1cbiAgcmV0dXJuIHN0cjtcbn1cblxuLyoqXG4gKiBDYWNoZWQgc3BsaXQuXG4gKi9cbnZhciBTUExJVF9DQUNIRSA9IHt9O1xuZnVuY3Rpb24gc3BsaXQoc3RyLCBkZWxpbWl0ZXIpIHtcbiAgaWYgKCFTUExJVF9DQUNIRVtkZWxpbWl0ZXJdKSB7XG4gICAgU1BMSVRfQ0FDSEVbZGVsaW1pdGVyXSA9IHt9O1xuICB9XG4gIGlmIChTUExJVF9DQUNIRVtkZWxpbWl0ZXJdW3N0cl0pIHtcbiAgICByZXR1cm4gU1BMSVRfQ0FDSEVbZGVsaW1pdGVyXVtzdHJdO1xuICB9XG4gIFNQTElUX0NBQ0hFW2RlbGltaXRlcl1bc3RyXSA9IHN0ci5zcGxpdChkZWxpbWl0ZXIpO1xuICByZXR1cm4gU1BMSVRfQ0FDSEVbZGVsaW1pdGVyXVtzdHJdO1xufVxubW9kdWxlLmV4cG9ydHMuc3BsaXQgPSBzcGxpdDtcblxuZnVuY3Rpb24gY29weUFycmF5KGRlc3QsIHNyYykge1xuICB2YXIgaTtcbiAgZGVzdC5sZW5ndGggPSAwO1xuICBmb3IgKGkgPSAwOyBpIDwgc3JjLmxlbmd0aDsgaSsrKSB7XG4gICAgZGVzdFtpXSA9IHNyY1tpXTtcbiAgfVxufVxubW9kdWxlLmV4cG9ydHMuY29weUFycmF5ID0gY29weUFycmF5O1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xudmFyIGRpZmYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xudmFyIGxpYiA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG52YXIgd3JhcEFycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS53cmFwQXJyYXk7XG5cbi8vIFNpbmdsZXRvbiBzdGF0ZSBkZWZpbml0aW9uLlxudmFyIFN0YXRlID0ge1xuICBpbml0aWFsU3RhdGU6IHt9LFxuICBub25CaW5kZWRTdGF0ZUtleXM6IFtdLFxuICBoYW5kbGVyczoge30sXG4gIGNvbXB1dGVTdGF0ZTogZnVuY3Rpb24gY29tcHV0ZVN0YXRlKCkgey8qIG5vLW9wICovfVxufTtcblxudmFyIFNUQVRFX1VQREFURV9FVkVOVCA9ICdzdGF0ZXVwZGF0ZSc7XG52YXIgVFlQRV9PQkpFQ1QgPSAnb2JqZWN0JztcbnZhciBXSElURVNQQUNFX1JFR0VYID0gL3MrLztcblxuQUZSQU1FLnJlZ2lzdGVyU3RhdGUgPSBmdW5jdGlvbiAoZGVmaW5pdGlvbikge1xuICBBRlJBTUUudXRpbHMuZXh0ZW5kKFN0YXRlLCBkZWZpbml0aW9uKTtcbn07XG5cbkFGUkFNRS5yZWdpc3RlclN5c3RlbSgnc3RhdGUnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHZhciBrZXk7XG5cbiAgICB0aGlzLmFycmF5cyA9IFtdO1xuICAgIHRoaXMuZGlydHlBcnJheXMgPSBbXTtcbiAgICB0aGlzLmRpZmYgPSB7fTtcbiAgICB0aGlzLnN0YXRlID0gQUZSQU1FLnV0aWxzLmNsb25lKFN0YXRlLmluaXRpYWxTdGF0ZSk7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zID0gW107XG4gICAgdGhpcy5pbml0RXZlbnRIYW5kbGVycygpO1xuXG4gICAgLy8gV3JhcCBhcnJheSB0byBkZXRlY3QgZGlydHkuXG4gICAgZm9yIChrZXkgaW4gdGhpcy5zdGF0ZSkge1xuICAgICAgaWYgKHRoaXMuc3RhdGVba2V5XSAmJiB0aGlzLnN0YXRlW2tleV0uY29uc3RydWN0b3IgPT09IEFycmF5KSB7XG4gICAgICAgIHRoaXMuYXJyYXlzLnB1c2goa2V5KTtcbiAgICAgICAgdGhpcy5zdGF0ZVtrZXldLl9fZGlydHkgPSB0cnVlO1xuICAgICAgICB3cmFwQXJyYXkodGhpcy5zdGF0ZVtrZXldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmxhc3RTdGF0ZSA9IEFGUkFNRS51dGlscy5jbG9uZSh0aGlzLnN0YXRlKTtcblxuICAgIHRoaXMuZXZlbnREZXRhaWwgPSB7XG4gICAgICBsYXN0U3RhdGU6IHRoaXMubGFzdFN0YXRlLFxuICAgICAgc3RhdGU6IHRoaXMuc3RhdGVcbiAgICB9O1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgaTtcbiAgICAgIC8vIEluaXRpYWwgY29tcHV0ZS5cbiAgICAgIFN0YXRlLmNvbXB1dGVTdGF0ZShfdGhpcy5zdGF0ZSwgJ0BASU5JVCcpO1xuICAgICAgLy8gSW5pdGlhbCBkaXNwYXRjaC5cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBfdGhpcy5zdWJzY3JpcHRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIF90aGlzLnN1YnNjcmlwdGlvbnNbaV0ub25TdGF0ZVVwZGF0ZShfdGhpcy5zdGF0ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERpc3BhdGNoIGFjdGlvbi5cbiAgICovXG4gIGRpc3BhdGNoOiBmdW5jdGlvbiBkaXNwYXRjaChhY3Rpb25OYW1lLCBwYXlsb2FkKSB7XG4gICAgdmFyIGRpcnR5QXJyYXlzO1xuICAgIHZhciBpO1xuICAgIHZhciBrZXk7XG4gICAgdmFyIHN1YnNjcmlwdGlvbjtcblxuICAgIC8vIE1vZGlmeSBzdGF0ZS5cbiAgICBTdGF0ZS5oYW5kbGVyc1thY3Rpb25OYW1lXSh0aGlzLnN0YXRlLCBwYXlsb2FkKTtcblxuICAgIC8vIFBvc3QtY29tcHV0ZS5cbiAgICBTdGF0ZS5jb21wdXRlU3RhdGUodGhpcy5zdGF0ZSwgYWN0aW9uTmFtZSwgcGF5bG9hZCk7XG5cbiAgICAvLyBHZXQgYSBkaWZmIHRvIG9wdGltaXplIGJpbmQgdXBkYXRlcy5cbiAgICBmb3IgKGtleSBpbiB0aGlzLmRpZmYpIHtcbiAgICAgIGRlbGV0ZSB0aGlzLmRpZmZba2V5XTtcbiAgICB9XG4gICAgZGlmZih0aGlzLmxhc3RTdGF0ZSwgdGhpcy5zdGF0ZSwgdGhpcy5kaWZmLCBTdGF0ZS5ub25CaW5kZWRTdGF0ZUtleXMpO1xuXG4gICAgdGhpcy5kaXJ0eUFycmF5cy5sZW5ndGggPSAwO1xuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLmFycmF5cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMuc3RhdGVbdGhpcy5hcnJheXNbaV1dLl9fZGlydHkpIHtcbiAgICAgICAgdGhpcy5kaXJ0eUFycmF5cy5wdXNoKHRoaXMuYXJyYXlzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBOb3RpZnkgc3Vic2NyaXB0aW9ucyAvIGJpbmRlcnMuXG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMuc3Vic2NyaXB0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9uc1tpXS5uYW1lID09PSAnYmluZC1mb3InKSB7XG4gICAgICAgIC8vIEZvciBhcnJheXMgYW5kIGJpbmQtZm9yLCBjaGVjayBfX2RpcnR5IGZsYWcgb24gYXJyYXkgcmF0aGVyIHRoYW4gdGhlIGRpZmYuXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZVt0aGlzLnN1YnNjcmlwdGlvbnNbaV0ua2V5c1RvV2F0Y2hbMF1dLl9fZGlydHkpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCF0aGlzLnNob3VsZFVwZGF0ZSh0aGlzLnN1YnNjcmlwdGlvbnNbaV0ua2V5c1RvV2F0Y2gsIHRoaXMuZGlmZiwgdGhpcy5kaXJ0eUFycmF5cykpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLnN1YnNjcmlwdGlvbnNbaV0ub25TdGF0ZVVwZGF0ZSgpO1xuICAgIH1cblxuICAgIC8vIFVuc2V0IGFycmF5IGRpcnR5LlxuICAgIGZvciAoa2V5IGluIHRoaXMuc3RhdGUpIHtcbiAgICAgIGlmICh0aGlzLnN0YXRlW2tleV0gJiYgdGhpcy5zdGF0ZVtrZXldLmNvbnN0cnVjdG9yID09PSBBcnJheSkge1xuICAgICAgICB0aGlzLnN0YXRlW2tleV0uX19kaXJ0eSA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFN0b3JlIGxhc3Qgc3RhdGUuXG4gICAgdGhpcy5jb3B5U3RhdGUodGhpcy5sYXN0U3RhdGUsIHRoaXMuc3RhdGUpO1xuXG4gICAgLy8gRW1pdC5cbiAgICB0aGlzLmV2ZW50RGV0YWlsLmFjdGlvbiA9IGFjdGlvbk5hbWU7XG4gICAgdGhpcy5ldmVudERldGFpbC5wYXlsb2FkID0gcGF5bG9hZDtcbiAgICB0aGlzLmVsLmVtaXQoU1RBVEVfVVBEQVRFX0VWRU5ULCB0aGlzLmV2ZW50RGV0YWlsKTtcbiAgfSxcblxuICAvKipcbiAgICogU3RvcmUgbGFzdCBzdGF0ZSB0aHJvdWdoIGEgZGVlcCBleHRlbmQsIGJ1dCBub3QgZm9yIGFycmF5cy5cbiAgICovXG4gIGNvcHlTdGF0ZTogZnVuY3Rpb24gY29weVN0YXRlKGxhc3RTdGF0ZSwgc3RhdGUsIGlzUmVjdXJzaXZlKSB7XG4gICAgdmFyIGtleTtcblxuICAgIGZvciAoa2V5IGluIHN0YXRlKSB7XG4gICAgICAvLyBEb24ndCBjb3B5IHBpZWNlcyBvZiBzdGF0ZSBrZXlzIHRoYXQgYXJlIG5vbi1iaW5kZWQgb3IgdW50cmFja2VkLlxuICAgICAgaWYgKCFpc1JlY3Vyc2l2ZSAmJiBTdGF0ZS5ub25CaW5kZWRTdGF0ZUtleXMuaW5kZXhPZihrZXkpICE9PSAtMSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gTmVzdGVkIHN0YXRlLlxuICAgICAgaWYgKHN0YXRlW2tleV0gJiYgc3RhdGVba2V5XS5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7XG4gICAgICAgIGlmICghKGtleSBpbiBsYXN0U3RhdGUpKSB7XG4gICAgICAgICAgLy8gQ2xvbmUgb2JqZWN0IGlmIGRlc3RpbmF0aW9uIGRvZXMgbm90IGV4aXN0LlxuICAgICAgICAgIGxhc3RTdGF0ZVtrZXldID0gQUZSQU1FLnV0aWxzLmNsb25lKHN0YXRlW2tleV0pO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlY3Vyc2l2ZWx5IGNvcHkgc3RhdGUuXG4gICAgICAgIHRoaXMuY29weVN0YXRlKGxhc3RTdGF0ZVtrZXldLCBzdGF0ZVtrZXldLCB0cnVlKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIENvcHkgYnkgdmFsdWUuXG4gICAgICBsYXN0U3RhdGVba2V5XSA9IHN0YXRlW2tleV07XG4gICAgfVxuICB9LFxuXG4gIHN1YnNjcmliZTogZnVuY3Rpb24gc3Vic2NyaWJlKGNvbXBvbmVudCkge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKGNvbXBvbmVudCk7XG4gIH0sXG5cbiAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKGNvbXBvbmVudCkge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5zcGxpY2UodGhpcy5zdWJzY3JpcHRpb25zLmluZGV4T2YoY29tcG9uZW50KSwgMSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHN0YXRlIGNoYW5nZXMgd2VyZSByZWxldmFudCB0byB0aGlzIGJpbmRpbmcuIElmIG5vdCwgZG9uJ3QgY2FsbC5cbiAgICovXG4gIHNob3VsZFVwZGF0ZTogZnVuY3Rpb24gc2hvdWxkVXBkYXRlKGtleXNUb1dhdGNoLCBkaWZmLCBkaXJ0eUFycmF5cykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5c1RvV2F0Y2gubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChrZXlzVG9XYXRjaFtpXSBpbiBkaWZmIHx8IGRpcnR5QXJyYXlzLmluZGV4T2Yoa2V5c1RvV2F0Y2hbaV0pICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBQcm94eSBldmVudHMgdG8gYWN0aW9uIGRpc3BhdGNoZXMgc28gY29tcG9uZW50cyBjYW4ganVzdCBidWJibGUgYWN0aW9ucyB1cCBhcyBldmVudHMuXG4gICAqIEhhbmRsZXJzIGRlZmluZSB3aGljaCBhY3Rpb25zIHRoZXkgaGFuZGxlLiBHbyB0aHJvdWdoIGFsbCBhbmQgYWRkIGV2ZW50IGxpc3RlbmVycy5cbiAgICovXG4gIGluaXRFdmVudEhhbmRsZXJzOiBmdW5jdGlvbiBpbml0RXZlbnRIYW5kbGVycygpIHtcbiAgICB2YXIgYWN0aW9uTmFtZTtcbiAgICB2YXIgcmVnaXN0ZXJlZEFjdGlvbnMgPSBbXTtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICByZWdpc3Rlckxpc3RlbmVyID0gcmVnaXN0ZXJMaXN0ZW5lci5iaW5kKHRoaXMpO1xuXG4gICAgLy8gVXNlIGRlY2xhcmVkIGhhbmRsZXJzIHRvIGtub3cgd2hhdCBldmVudHMgdG8gbGlzdGVuIHRvLlxuICAgIGZvciAoYWN0aW9uTmFtZSBpbiBTdGF0ZS5oYW5kbGVycykge1xuICAgICAgLy8gT25seSBuZWVkIHRvIHJlZ2lzdGVyIG9uZSBoYW5kbGVyIGZvciBlYWNoIGV2ZW50LlxuICAgICAgaWYgKHJlZ2lzdGVyZWRBY3Rpb25zLmluZGV4T2YoYWN0aW9uTmFtZSkgIT09IC0xKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgcmVnaXN0ZXJlZEFjdGlvbnMucHVzaChhY3Rpb25OYW1lKTtcbiAgICAgIHJlZ2lzdGVyTGlzdGVuZXIoYWN0aW9uTmFtZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJMaXN0ZW5lcihhY3Rpb25OYW1lKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKGFjdGlvbk5hbWUsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgX3RoaXMyLmRpc3BhdGNoKGFjdGlvbk5hbWUsIGV2dC5kZXRhaWwpO1xuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBSZW5kZXIgdGVtcGxhdGUgdG8gc3RyaW5nIHdpdGggaXRlbSBkYXRhLlxuICAgKi9cbiAgcmVuZGVyVGVtcGxhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBCcmFjZXMsIHdoaXRlc3BhY2UsIG9wdGlvbmFsIGl0ZW0gbmFtZSwgaXRlbSBrZXksIHdoaXRlc3BhY2UsIGJyYWNlcy5cbiAgICB2YXIgaW50ZXJwUmVnZXggPSAve3tcXHMqKFxcdypcXC4pPyhbXFx3Ll0rKVxccyp9fS9nO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZW1wbGF0ZSwgZGF0YSwgYXNTdHJpbmcpIHtcbiAgICAgIHZhciBtYXRjaDtcbiAgICAgIHZhciBzdHI7XG5cbiAgICAgIHN0ciA9IHRlbXBsYXRlO1xuXG4gICAgICAvLyBEYXRhIHdpbGwgYmUgbnVsbCBpZiBpbml0aWFsaXplIHBvb2wgZm9yIGJpbmQtZm9yLnVwZGF0ZUluUGxhY2UuXG4gICAgICBpZiAoZGF0YSkge1xuICAgICAgICB3aGlsZSAobWF0Y2ggPSBpbnRlcnBSZWdleC5leGVjKHRlbXBsYXRlKSkge1xuICAgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKG1hdGNoWzBdLCAodHlwZW9mIGRhdGEgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGRhdGEpKSA9PT0gVFlQRV9PQkpFQ1QgPyBsaWIuc2VsZWN0KGRhdGEsIG1hdGNoWzJdKSB8fCAnJyA6IGRhdGEpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFJldHVybiBhcyBzdHJpbmcuXG4gICAgICBpZiAoYXNTdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgIH1cblxuICAgICAgLy8gUmV0dXJuIGFzIERPTS5cbiAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVSYW5nZSgpLmNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudChzdHIpO1xuICAgIH07XG4gIH0oKSxcblxuICBzZWxlY3Q6IGxpYi5zZWxlY3Rcbn0pO1xuXG4vKipcbiAqIEJpbmQgY29tcG9uZW50IHByb3BlcnR5IHRvIGEgdmFsdWUgaW4gc3RhdGUuXG4gKlxuICogYmluZD1cImdlb21ldHJ5LndpZHRoOiBjYXIud2lkdGhcIlwiXG4gKiBiaW5kX19tYXRlcmlhbD1cImNvbG9yOiBlbmVteS5jb2xvcjsgb3BhY2l0eTogZW5lbXkub3BhY2l0eVwiXG4gKiBiaW5kX192aXNpYmxlPVwicGxheWVyLnZpc2libGVcIlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2JpbmQnLCB7XG4gIHNjaGVtYToge1xuICAgIGRlZmF1bHQ6IHt9LFxuICAgIHBhcnNlOiBmdW5jdGlvbiBwYXJzZSh2YWx1ZSkge1xuICAgICAgLy8gUGFyc2Ugc3R5bGUtbGlrZSBvYmplY3QuXG4gICAgICB2YXIgZGF0YTtcbiAgICAgIHZhciBpO1xuICAgICAgdmFyIHByb3BlcnRpZXM7XG4gICAgICB2YXIgcGFpcjtcblxuICAgICAgLy8gVXNpbmcgc2V0QXR0cmlidXRlIHdpdGggb2JqZWN0LCBubyBuZWVkIHRvIHBhcnNlLlxuICAgICAgaWYgKHZhbHVlLmNvbnN0cnVjdG9yID09PSBPYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuXG4gICAgICAvLyBVc2luZyBpbnN0YW5jZWQgSUQgYXMgY29tcG9uZW50IG5hbWVzcGFjZSBmb3Igc2luZ2xlLXByb3BlcnR5IGNvbXBvbmVudCxcbiAgICAgIC8vIG5vdGhpbmcgdG8gc2VwYXJhdGUuXG4gICAgICBpZiAodmFsdWUuaW5kZXhPZignOicpID09PSAtMSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFBhcnNlIHN0eWxlLWxpa2Ugb2JqZWN0IGFzIGtleXMgdG8gdmFsdWVzLlxuICAgICAgZGF0YSA9IHt9O1xuICAgICAgcHJvcGVydGllcyA9IGxpYi5zcGxpdCh2YWx1ZSwgJzsnKTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBhaXIgPSBsaWIuc3BsaXQocHJvcGVydGllc1tpXS50cmltKCksICc6Jyk7XG4gICAgICAgIGRhdGFbcGFpclswXV0gPSBwYWlyWzFdLnRyaW0oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgIHZhciBjb21wb25lbnRJZDtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIga2V5O1xuXG4gICAgdGhpcy5rZXlzVG9XYXRjaCA9IFtdO1xuICAgIHRoaXMub25TdGF0ZVVwZGF0ZSA9IHRoaXMub25TdGF0ZVVwZGF0ZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc3lzdGVtID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMuc3RhdGU7XG5cbiAgICAvLyBXaGV0aGVyIHdlIGFyZSBiaW5kaW5nIGJ5IG5hbWVzcGFjZSAoZS5nLiwgYmluZF9fZm9vPVwicHJvcDE6IHRydWVcIikuXG4gICAgaWYgKHRoaXMuaWQpIHtcbiAgICAgIGNvbXBvbmVudElkID0gbGliLnNwbGl0KHRoaXMuaWQsICdfXycpWzBdO1xuICAgIH1cbiAgICB0aGlzLmlzTmFtZXNwYWNlZEJpbmQgPSB0aGlzLmlkICYmIGNvbXBvbmVudElkIGluIEFGUkFNRS5jb21wb25lbnRzICYmICFBRlJBTUUuY29tcG9uZW50c1tjb21wb25lbnRJZF0uaXNTaW5nbGVQcm9wIHx8IGNvbXBvbmVudElkIGluIEFGUkFNRS5zeXN0ZW1zO1xuXG4gICAgdGhpcy5sYXN0RGF0YSA9IHt9O1xuICAgIHRoaXMudXBkYXRlT2JqID0ge307XG5cbiAgICAvLyBTdWJzY3JpYmUgdG8gc3RvcmUgYW5kIHJlZ2lzdGVyIGhhbmRsZXIgdG8gZG8gZGF0YS1iaW5kaW5nIHRvIGNvbXBvbmVudHMuXG4gICAgdGhpcy5zeXN0ZW0uc3Vic2NyaWJlKHRoaXMpO1xuXG4gICAgdGhpcy5vblN0YXRlVXBkYXRlID0gdGhpcy5vblN0YXRlVXBkYXRlLmJpbmQodGhpcyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGtleTtcbiAgICB2YXIgcHJvcGVydHk7XG5cbiAgICAvLyBJbmRleCBga2V5c1RvV2F0Y2hgIHRvIG9ubHkgdXBkYXRlIHN0YXRlIG9uIHJlbGV2YW50IGNoYW5nZXMuXG4gICAgdGhpcy5rZXlzVG9XYXRjaC5sZW5ndGggPSAwO1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGxpYi5wYXJzZUtleXNUb1dhdGNoKHRoaXMua2V5c1RvV2F0Y2gsIGRhdGEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGtleSBpbiBkYXRhKSB7XG4gICAgICAgIGxpYi5wYXJzZUtleXNUb1dhdGNoKHRoaXMua2V5c1RvV2F0Y2gsIGRhdGFba2V5XSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5vblN0YXRlVXBkYXRlKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEhhbmRsZSBzdGF0ZSB1cGRhdGUuXG4gICAqL1xuICBvblN0YXRlVXBkYXRlOiBmdW5jdGlvbiBvblN0YXRlVXBkYXRlKCkge1xuICAgIC8vIFVwZGF0ZSBjb21wb25lbnQgd2l0aCB0aGUgc3RhdGUuXG4gICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBwcm9wZXJ0eU5hbWU7XG4gICAgdmFyIHN0YXRlU2VsZWN0b3I7XG4gICAgdmFyIHN0YXRlO1xuICAgIHZhciB0ZW1wTm9kZTtcbiAgICB2YXIgdmFsdWU7XG5cbiAgICBpZiAoIWVsLnBhcmVudE5vZGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNOYW1lc3BhY2VkQmluZCkge1xuICAgICAgbGliLmNsZWFyT2JqZWN0KHRoaXMudXBkYXRlT2JqKTtcbiAgICB9XG5cbiAgICBzdGF0ZSA9IHRoaXMuc3lzdGVtLnN0YXRlO1xuXG4gICAgLy8gU2luZ2xlLXByb3BlcnR5IGJpbmQuXG4gICAgaWYgKF90eXBlb2YodGhpcy5kYXRhKSAhPT0gVFlQRV9PQkpFQ1QpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhbHVlID0gbGliLnNlbGVjdChzdGF0ZSwgdGhpcy5kYXRhKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbYWZyYW1lLXN0YXRlLWNvbXBvbmVudF0gS2V5IFxcJycgKyB0aGlzLmRhdGEgKyAnXFwnIG5vdCBmb3VuZCBpbiBzdGF0ZS4nICsgKCcgIycgKyB0aGlzLmVsLmdldEF0dHJpYnV0ZSgnaWQnKSArICdbJyArIHRoaXMuYXR0ck5hbWUgKyAnXScpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCh0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHZhbHVlKSkgIT09IFRZUEVfT0JKRUNUICYmIF90eXBlb2YodGhpcy5sYXN0RGF0YSkgIT09IFRZUEVfT0JKRUNUICYmIHRoaXMubGFzdERhdGEgPT09IHZhbHVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgQUZSQU1FLnV0aWxzLmVudGl0eS5zZXRDb21wb25lbnRQcm9wZXJ0eShlbCwgdGhpcy5pZCwgdmFsdWUpO1xuICAgICAgdGhpcy5sYXN0RGF0YSA9IHZhbHVlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZvciAocHJvcGVydHlOYW1lIGluIHRoaXMuZGF0YSkge1xuICAgICAgLy8gUG9pbnRlciB0byBhIHZhbHVlIGluIHRoZSBzdGF0ZSAoZS5nLiwgYHBsYXllci5oZWFsdGhgKS5cbiAgICAgIHN0YXRlU2VsZWN0b3IgPSB0aGlzLmRhdGFbcHJvcGVydHlOYW1lXS50cmltKCk7XG4gICAgICB0cnkge1xuICAgICAgICB2YWx1ZSA9IGxpYi5zZWxlY3Qoc3RhdGUsIHN0YXRlU2VsZWN0b3IpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbYWZyYW1lLXN0YXRlLWNvbXBvbmVudF0gS2V5IFxcJycgKyBzdGF0ZVNlbGVjdG9yICsgJ1xcJyBub3QgZm91bmQgaW4gc3RhdGUuJyArICgnICMnICsgdGhpcy5lbC5nZXRBdHRyaWJ1dGUoJ2lkJykgKyAnWycgKyB0aGlzLmF0dHJOYW1lICsgJ10nKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICgodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZih2YWx1ZSkpICE9PSBUWVBFX09CSkVDVCAmJiBfdHlwZW9mKHRoaXMubGFzdERhdGFbcHJvcGVydHlOYW1lXSkgIT09IFRZUEVfT0JKRUNUICYmIHRoaXMubGFzdERhdGFbcHJvcGVydHlOYW1lXSA9PT0gdmFsdWUpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBjb21wb25lbnQgaWYgdmFsdWUgaXMgYHVuZGVmaW5lZGAuXG4gICAgICBpZiAocHJvcGVydHlOYW1lIGluIEFGUkFNRS5jb21wb25lbnRzICYmIHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKHByb3BlcnR5TmFtZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gU2V0IHVzaW5nIGRvdC1kZWxpbWl0ZWQgcHJvcGVydHkgbmFtZS5cbiAgICAgIGlmICh0aGlzLmlzTmFtZXNwYWNlZEJpbmQpIHtcbiAgICAgICAgLy8gQmF0Y2ggaWYgZG9pbmcgbmFtZXNwYWNlZCBiaW5kLlxuICAgICAgICB0aGlzLnVwZGF0ZU9ialtwcm9wZXJ0eU5hbWVdID0gdmFsdWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBBRlJBTUUudXRpbHMuZW50aXR5LnNldENvbXBvbmVudFByb3BlcnR5KGVsLCBwcm9wZXJ0eU5hbWUsIHZhbHVlKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5sYXN0RGF0YVtwcm9wZXJ0eU5hbWVdID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLy8gQmF0Y2ggaWYgZG9pbmcgbmFtZXNwYWNlZCBiaW5kLlxuICAgIGZvciAoaGFzS2V5cyBpbiB0aGlzLnVwZGF0ZU9iaikge1xuICAgICAgLy8gU2VlIGlmIG9iamVjdCBpcyBlbXB0eS5cbiAgICB9XG4gICAgaWYgKHRoaXMuaXNOYW1lc3BhY2VkQmluZCAmJiBoYXNLZXlzKSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUodGhpcy5pZCwgdGhpcy51cGRhdGVPYmopO1xuICAgIH1cbiAgfSxcblxuICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICB0aGlzLnN5c3RlbS51bnN1YnNjcmliZSh0aGlzKTtcbiAgfVxufSk7XG5cbi8qKlxuICogVG9nZ2xlIGNvbXBvbmVudCBhdHRhY2ggYW5kIGRldGFjaCBiYXNlZCBvbiBib29sZWFuIHZhbHVlLlxuICpcbiAqIGJpbmQtdG9nZ2xlX19yYXljYXN0YWJsZT1cImlzUmF5Y2FzdGFibGVcIlwiXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmluZC10b2dnbGUnLCB7XG4gIHNjaGVtYTogeyB0eXBlOiAnc3RyaW5nJyB9LFxuXG4gIG11bHRpcGxlOiB0cnVlLFxuXG4gIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdGhpcy5zeXN0ZW0gPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZTtcbiAgICB0aGlzLmtleXNUb1dhdGNoID0gW107XG4gICAgdGhpcy5vblN0YXRlVXBkYXRlID0gdGhpcy5vblN0YXRlVXBkYXRlLmJpbmQodGhpcyk7XG5cbiAgICAvLyBTdWJzY3JpYmUgdG8gc3RvcmUgYW5kIHJlZ2lzdGVyIGhhbmRsZXIgdG8gZG8gZGF0YS1iaW5kaW5nIHRvIGNvbXBvbmVudHMuXG4gICAgdGhpcy5zeXN0ZW0uc3Vic2NyaWJlKHRoaXMpO1xuXG4gICAgdGhpcy5vblN0YXRlVXBkYXRlKCk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgdGhpcy5rZXlzVG9XYXRjaC5sZW5ndGggPSAwO1xuICAgIGxpYi5wYXJzZUtleXNUb1dhdGNoKHRoaXMua2V5c1RvV2F0Y2gsIHRoaXMuZGF0YSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEhhbmRsZSBzdGF0ZSB1cGRhdGUuXG4gICAqL1xuICBvblN0YXRlVXBkYXRlOiBmdW5jdGlvbiBvblN0YXRlVXBkYXRlKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIHN0YXRlO1xuICAgIHZhciB2YWx1ZTtcblxuICAgIHN0YXRlID0gdGhpcy5zeXN0ZW0uc3RhdGU7XG5cbiAgICB0cnkge1xuICAgICAgdmFsdWUgPSBsaWIuc2VsZWN0KHN0YXRlLCB0aGlzLmRhdGEpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW2FmcmFtZS1zdGF0ZS1jb21wb25lbnRdIEtleSBcXCcnICsgdGhpcy5kYXRhICsgJ1xcJyBub3QgZm91bmQgaW4gc3RhdGUuJyArICgnICMnICsgdGhpcy5lbC5nZXRBdHRyaWJ1dGUoJ2lkJykgKyAnWycgKyB0aGlzLmF0dHJOYW1lICsgJ10nKSk7XG4gICAgfVxuXG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUodGhpcy5pZCwgJycpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUodGhpcy5pZCk7XG4gICAgfVxuICB9LFxuXG4gIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgIHRoaXMuc3lzdGVtLnVuc3Vic2NyaWJlKHRoaXMpO1xuICB9XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNvbXBvc2VGdW5jdGlvbnM6IGxpYi5jb21wb3NlRnVuY3Rpb25zLFxuICBjb21wb3NlSGFuZGxlcnM6IGxpYi5jb21wb3NlSGFuZGxlcnMsXG4gIHNlbGVjdDogbGliLnNlbGVjdFxufTtcblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBsaWIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgSVRFTV9SRSA9IC9pdGVtLztcbnZhciBJVEVNX1BSRUZJWF9SRSA9IC9pdGVtLi87XG52YXIgSVRFTV9TRUxFQ1RPUl9SRSA9IC9pdGVtLihcXHcrKS87XG5cbi8qKlxuICogUmVuZGVyIGFycmF5IGZyb20gc3RhdGUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmluZC1mb3InLCB7XG4gIHNjaGVtYToge1xuICAgIGRlbGF5OiB7IGRlZmF1bHQ6IDAgfSxcbiAgICBmb3I6IHsgdHlwZTogJ3N0cmluZycsIGRlZmF1bHQ6ICdpdGVtJyB9LFxuICAgIGluOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAga2V5OiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgcG9vbDogeyBkZWZhdWx0OiAwIH0sXG4gICAgdGVtcGxhdGU6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICB1cGRhdGVJblBsYWNlOiB7IGRlZmF1bHQ6IGZhbHNlIH1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgIC8vIFN1YnNjcmliZSB0byBzdG9yZSBhbmQgcmVnaXN0ZXIgaGFuZGxlciB0byBkbyBkYXRhLWJpbmRpbmcgdG8gY29tcG9uZW50cy5cbiAgICB0aGlzLnN5c3RlbSA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlO1xuICAgIHRoaXMub25TdGF0ZVVwZGF0ZSA9IHRoaXMub25TdGF0ZVVwZGF0ZS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5rZXlzVG9XYXRjaCA9IFtdO1xuICAgIHRoaXMucmVuZGVyZWRLZXlzID0gW107IC8vIEtleXMgdGhhdCBhcmUgY3VycmVudGx5IHJlbmRlcmVkLlxuICAgIHRoaXMuc3lzdGVtLnN1YnNjcmliZSh0aGlzKTtcblxuICAgIGlmICh0aGlzLmVsLmNoaWxkcmVuWzBdICYmIHRoaXMuZWwuY2hpbGRyZW5bMF0udGFnTmFtZSA9PT0gJ1RFTVBMQVRFJykge1xuICAgICAgdGhpcy50ZW1wbGF0ZSA9IHRoaXMuZWwuY2hpbGRyZW5bMF0uaW5uZXJIVE1MLnRyaW0oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5kYXRhLnRlbXBsYXRlKS5pbm5lckhUTUwudHJpbSgpO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5kYXRhLnBvb2w7IGkrKykge1xuICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmdlbmVyYXRlRnJvbVRlbXBsYXRlKG51bGwsIGkpKTtcbiAgICB9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgdGhpcy5rZXlzVG9XYXRjaFswXSA9IGxpYi5zcGxpdCh0aGlzLmRhdGEuaW4sICcuJylbMF07XG4gICAgdGhpcy5vblN0YXRlVXBkYXRlKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZW4gaXRlbXMgYXJlIHN3YXBwZWQgb3V0LCB0aGUgb2xkIG9uZXMgYXJlIHJlbW92ZWQsIGFuZCBuZXcgb25lcyBhcmUgYWRkZWQuIEFsbFxuICAgKiBlbnRpdGllcyB3aWxsIGJlIHJlaW5pdGlhbGl6ZWQuXG4gICAqL1xuICBvblN0YXRlVXBkYXRlTmFpdmU6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYWN0aXZlS2V5cyA9IFtdO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjaGlsZDtcbiAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICAgIHZhciBsaXN0O1xuICAgICAgdmFyIGtleTtcbiAgICAgIHZhciBrZXlWYWx1ZTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgbGlzdCA9IGxpYi5zZWxlY3QodGhpcy5zeXN0ZW0uc3RhdGUsIGRhdGEuaW4pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1thZnJhbWUtc3RhdGUtY29tcG9uZW50XSBLZXkgXFwnJyArIGRhdGEuaW4gKyAnXFwnIG5vdCBmb3VuZCBpbiBzdGF0ZS4nICsgKCcgIycgKyBlbC5nZXRBdHRyaWJ1dGUoJ2lkJykgKyAnWycgKyB0aGlzLmF0dHJOYW1lICsgJ10nKSk7XG4gICAgICB9XG5cbiAgICAgIGFjdGl2ZUtleXMubGVuZ3RoID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgaXRlbSA9IGxpc3RbaV07XG4gICAgICAgIC8vIElmIGtleSBub3QgZGVmaW5lZCwgdXNlIGluZGV4IChlLmcuLCBhcnJheSBvZiBzdHJpbmdzKS5cbiAgICAgICAgYWN0aXZlS2V5cy5wdXNoKGRhdGEua2V5ID8gaXRlbVtkYXRhLmtleV0udG9TdHJpbmcoKSA6IGl0ZW0udG9TdHJpbmcoKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBpdGVtcyBieSByZW1vdmluZyBlbnRpdGllcy5cbiAgICAgIHZhciB0b1JlbW92ZUVscyA9IHRoaXMuZ2V0RWxzVG9SZW1vdmUoYWN0aXZlS2V5cywgdGhpcy5yZW5kZXJlZEtleXMpO1xuICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHRvUmVtb3ZlRWxzLmxlbmd0aDsgX2krKykge1xuICAgICAgICB0b1JlbW92ZUVsc1tfaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0b1JlbW92ZUVsc1tfaV0pO1xuICAgICAgfVxuXG4gICAgICBpZiAobGlzdC5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJJdGVtcyhsaXN0LCBhY3RpdmVLZXlzLCAwKTtcbiAgICAgIH1cbiAgICB9O1xuICB9KCksXG5cbiAgLyoqXG4gICAqIEFkZCBvciB1cGRhdGUgaXRlbSB3aXRoIGRlbGF5IHN1cHBvcnQuXG4gICAqL1xuICByZW5kZXJJdGVtczogZnVuY3Rpb24gcmVuZGVySXRlbXMobGlzdCwgYWN0aXZlS2V5cywgaSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBpdGVtRWw7XG4gICAgdmFyIGl0ZW0gPSBsaXN0W2ldO1xuXG4gICAgLy8gSWYga2V5IG5vdCBkZWZpbmVkLCB1c2UgaW5kZXggKGUuZy4sIGFycmF5IG9mIHN0cmluZ3MpLlxuICAgIHZhciBrZXlWYWx1ZSA9IGRhdGEua2V5ID8gaXRlbVtkYXRhLmtleV0udG9TdHJpbmcoKSA6IGl0ZW0udG9TdHJpbmcoKTtcblxuICAgIGlmICh0aGlzLnJlbmRlcmVkS2V5cy5pbmRleE9mKGtleVZhbHVlKSA9PT0gLTEpIHtcbiAgICAgIC8vIEFkZC5cbiAgICAgIGl0ZW1FbCA9IHRoaXMuZ2VuZXJhdGVGcm9tVGVtcGxhdGUoaXRlbSwgaSk7XG4gICAgICBlbC5hcHBlbmRDaGlsZChpdGVtRWwpO1xuICAgICAgdGhpcy5yZW5kZXJlZEtleXMucHVzaChrZXlWYWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVwZGF0ZS5cbiAgICAgIGlmIChsaXN0Lmxlbmd0aCAmJiBsaXN0WzBdLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHtcbiAgICAgICAgLy8gVXBkYXRlIGluZGV4IGZvciBzaW1wbGUgbGlzdC5cbiAgICAgICAgdmFyIF9rZXlWYWx1ZSA9IGRhdGEua2V5ID8gaXRlbVtkYXRhLmtleV0udG9TdHJpbmcoKSA6IGl0ZW0udG9TdHJpbmcoKTtcbiAgICAgICAgaXRlbUVsID0gZWwucXVlcnlTZWxlY3RvcignW2RhdGEtYmluZC1mb3ItdmFsdWU9XCInICsgX2tleVZhbHVlICsgJ1wiXScpO1xuICAgICAgICBpdGVtRWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWtleScsIGkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGJpbmRGb3JLZXkgPSB0aGlzLmdldEJpbmRGb3JLZXkoaXRlbSwgaSk7XG4gICAgICAgIGl0ZW1FbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJpbmQtZm9yLWtleT1cIicgKyBiaW5kRm9yS2V5ICsgJ1wiXScpO1xuICAgICAgfVxuICAgICAgaXRlbUVsLmVtaXQoJ2JpbmRmb3J1cGRhdGUnLCBpdGVtLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgaWYgKCFsaXN0W2kgKyAxXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEuZGVsYXkpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5yZW5kZXJJdGVtcyhsaXN0LCBhY3RpdmVLZXlzLCBpICsgMSk7XG4gICAgICB9LCB0aGlzLmRhdGEuZGVsYXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbmRlckl0ZW1zKGxpc3QsIGFjdGl2ZUtleXMsIGkgKyAxKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZW4gaXRlbXMgYXJlIHN3YXBwZWQgb3V0LCB0aGlzIGFsZ29yaXRobSB3aWxsIHVwZGF0ZSBjb21wb25lbnQgdmFsdWVzIGluLXBsYWNlIHVzaW5nXG4gICAqIGJpbmQtaXRlbS5cbiAgICovXG4gIG9uU3RhdGVVcGRhdGVJblBsYWNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFjdGl2ZUtleXMgPSBbXTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgICB2YXIgbGlzdDtcbiAgICAgIHZhciBrZXk7XG4gICAgICB2YXIga2V5VmFsdWU7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGxpc3QgPSBsaWIuc2VsZWN0KHRoaXMuc3lzdGVtLnN0YXRlLCBkYXRhLmluKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW2FmcmFtZS1zdGF0ZS1jb21wb25lbnRdIEtleSBcXCcnICsgZGF0YS5pbiArICdcXCcgbm90IGZvdW5kIGluIHN0YXRlLicgKyAoJyAjJyArIGVsLmdldEF0dHJpYnV0ZSgnaWQnKSArICdbJyArIHRoaXMuYXR0ck5hbWUgKyAnXScpKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2FsY3VsYXRlIGtleXMgdGhhdCBzaG91bGQgYmUgYWN0aXZlLlxuICAgICAgYWN0aXZlS2V5cy5sZW5ndGggPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBpdGVtID0gbGlzdFtpXTtcbiAgICAgICAga2V5VmFsdWUgPSBkYXRhLmtleSA/IGl0ZW1bZGF0YS5rZXldLnRvU3RyaW5nKCkgOiBpdGVtLnRvU3RyaW5nKCk7XG4gICAgICAgIGFjdGl2ZUtleXMucHVzaChrZXlWYWx1ZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBpdGVtcyBieSBwb29saW5nLiBEbyBiZWZvcmUgYWRkaW5nLlxuICAgICAgdmFyIHRvUmVtb3ZlRWxzID0gdGhpcy5nZXRFbHNUb1JlbW92ZShhY3RpdmVLZXlzLCB0aGlzLnJlbmRlcmVkS2V5cyk7XG4gICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCB0b1JlbW92ZUVscy5sZW5ndGg7IF9pMisrKSB7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pMl0ub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0b1JlbW92ZUVsc1tfaTJdLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1hY3RpdmUnLCAnZmFsc2UnKTtcbiAgICAgICAgdG9SZW1vdmVFbHNbX2kyXS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3Ita2V5Jyk7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pMl0ucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLXZhbHVlJyk7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pMl0uZW1pdCgnYmluZGZvcmRlYWN0aXZhdGUnLCBudWxsLCBmYWxzZSk7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pMl0ucGF1c2UoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGxpc3QubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMucmVuZGVySXRlbXNJblBsYWNlKGxpc3QsIGFjdGl2ZUtleXMsIDApO1xuICAgICAgfVxuICAgIH07XG4gIH0oKSxcblxuICAvKipcbiAgICogQWRkLCB0YWtlb3Zlciwgb3IgdXBkYXRlIGl0ZW0gd2l0aCBkZWxheSBzdXBwb3J0LlxuICAgKi9cbiAgcmVuZGVySXRlbXNJblBsYWNlOiBmdW5jdGlvbiByZW5kZXJJdGVtc0luUGxhY2UobGlzdCwgYWN0aXZlS2V5cywgaSkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgaXRlbUVsO1xuXG4gICAgdmFyIGl0ZW0gPSBsaXN0W2ldO1xuICAgIHZhciBiaW5kRm9yS2V5ID0gdGhpcy5nZXRCaW5kRm9yS2V5KGl0ZW0sIGkpO1xuICAgIHZhciBrZXlWYWx1ZSA9IGRhdGEua2V5ID8gaXRlbVtkYXRhLmtleV0udG9TdHJpbmcoKSA6IGl0ZW0udG9TdHJpbmcoKTtcblxuICAgIC8vIEFkZCBpdGVtLlxuICAgIGlmICh0aGlzLnJlbmRlcmVkS2V5cy5pbmRleE9mKGtleVZhbHVlKSA9PT0gLTEpIHtcbiAgICAgIGlmICghZWwucXVlcnlTZWxlY3RvcignOnNjb3BlID4gW2RhdGEtYmluZC1mb3ItYWN0aXZlPVwiZmFsc2VcIl0nKSkge1xuICAgICAgICAvLyBObyBpdGVtcyBhdmFpbGFibGUgaW4gcG9vbC4gR2VuZXJhdGUgbmV3IGVudGl0eS5cbiAgICAgICAgdmFyIF9pdGVtRWwgPSB0aGlzLmdlbmVyYXRlRnJvbVRlbXBsYXRlKGl0ZW0sIGkpO1xuICAgICAgICBfaXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfaXRlbUVsLmVtaXQoJ2JpbmRmb3J1cGRhdGVpbnBsYWNlJywgaXRlbSwgZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoX2l0ZW1FbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBUYWtlIG92ZXIgaW5hY3RpdmUgaXRlbS5cbiAgICAgICAgaXRlbUVsID0gZWwucXVlcnlTZWxlY3RvcignW2RhdGEtYmluZC1mb3ItYWN0aXZlPVwiZmFsc2VcIl0nKTtcbiAgICAgICAgaXRlbUVsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1rZXknLCBiaW5kRm9yS2V5KTtcbiAgICAgICAgaXRlbUVsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci12YWx1ZScsIGtleVZhbHVlKTtcbiAgICAgICAgaXRlbUVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgICAgICBpdGVtRWwucGxheSgpO1xuICAgICAgICBpdGVtRWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWFjdGl2ZScsICd0cnVlJyk7XG4gICAgICAgIGl0ZW1FbC5lbWl0KCdiaW5kZm9ydXBkYXRlaW5wbGFjZScsIGl0ZW0sIGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMucmVuZGVyZWRLZXlzLnB1c2goa2V5VmFsdWUpO1xuICAgIH0gZWxzZSBpZiAoYWN0aXZlS2V5cy5pbmRleE9mKGtleVZhbHVlKSAhPT0gLTEpIHtcbiAgICAgIC8vIFVwZGF0ZSBpdGVtLlxuICAgICAgaWYgKGxpc3QubGVuZ3RoICYmIGxpc3RbMF0uY29uc3RydWN0b3IgPT09IFN0cmluZykge1xuICAgICAgICAvLyBVcGRhdGUgaW5kZXggZm9yIHNpbXBsZSBsaXN0LlxuICAgICAgICBpdGVtRWwgPSBlbC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1iaW5kLWZvci12YWx1ZT1cIicgKyBrZXlWYWx1ZSArICdcIl0nKTtcbiAgICAgICAgaXRlbUVsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1rZXknLCBpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGl0ZW1FbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJpbmQtZm9yLWtleT1cIicgKyBiaW5kRm9yS2V5ICsgJ1wiXScpO1xuICAgICAgfVxuICAgICAgaXRlbUVsLmVtaXQoJ2JpbmRmb3J1cGRhdGVpbnBsYWNlJywgaXRlbSwgZmFsc2UpO1xuICAgIH1cblxuICAgIGlmICghbGlzdFtpICsgMV0pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kYXRhLmRlbGF5KSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMyLnJlbmRlckl0ZW1zSW5QbGFjZShsaXN0LCBhY3RpdmVLZXlzLCBpICsgMSk7XG4gICAgICB9LCB0aGlzLmRhdGEuZGVsYXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbmRlckl0ZW1zSW5QbGFjZShsaXN0LCBhY3RpdmVLZXlzLCBpICsgMSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBlbnRpdHkgZnJvbSB0ZW1wbGF0ZS5cbiAgICovXG4gIGdlbmVyYXRlRnJvbVRlbXBsYXRlOiBmdW5jdGlvbiBnZW5lcmF0ZUZyb21UZW1wbGF0ZShpdGVtLCBpKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMuc3lzdGVtLnJlbmRlclRlbXBsYXRlKHRoaXMudGVtcGxhdGUsIGl0ZW0pKTtcbiAgICB2YXIgbmV3RWwgPSB0aGlzLmVsLmNoaWxkcmVuW3RoaXMuZWwuY2hpbGRyZW4ubGVuZ3RoIC0gMV07O1xuXG4gICAgLy8gRnJvbSBwb29sLnRydWVcbiAgICBpZiAoIWl0ZW0pIHtcbiAgICAgIG5ld0VsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1rZXknLCAnJyk7XG4gICAgICBuZXdFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3ItYWN0aXZlJywgJ2ZhbHNlJyk7XG4gICAgICByZXR1cm4gbmV3RWw7XG4gICAgfVxuXG4gICAgdmFyIGJpbmRGb3JLZXkgPSB0aGlzLmdldEJpbmRGb3JLZXkoaXRlbSwgaSk7XG4gICAgbmV3RWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWtleScsIGJpbmRGb3JLZXkpO1xuICAgIGlmICghZGF0YS5rZXkpIHtcbiAgICAgIG5ld0VsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci12YWx1ZScsIGl0ZW0pO1xuICAgIH1cblxuICAgIC8vIEtlZXAgdHJhY2sgb2YgcG9vbGVkIGFuZCBub24tcG9vbGVkIGVudGl0aWVzIGlmIHVwZGF0aW5nIGluIHBsYWNlLlxuICAgIG5ld0VsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1hY3RpdmUnLCAndHJ1ZScpO1xuICAgIHJldHVybiBuZXdFbDtcbiAgfSxcblxuICAvKipcbiAgICogR2V0IGVudGl0aWVzIG1hcmtlZCBmb3IgcmVtb3ZhbC5cbiAgICpcbiAgICogQHBhcmFtIHthcnJheX0gYWN0aXZlS2V5cyAtIExpc3Qgb2Yga2V5IHZhbHVlcyB0aGF0IHNob3VsZCBiZSBhY3RpdmUuXG4gICAqIEBwYXJhbSB7YXJyYXl9IHJlbmRlcmVkS2V5cyAtIExpc3Qgb2Yga2V5IHZhbHVlcyBjdXJyZW50bHkgcmVuZGVyZWQuXG4gICAqL1xuICBnZXRFbHNUb1JlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciB0b1JlbW92ZSA9IFtdO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhY3RpdmVLZXlzLCByZW5kZXJlZEtleXMpIHtcbiAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgdmFyIGVsID0gdGhpcy5lbDtcblxuICAgICAgdG9SZW1vdmUubGVuZ3RoID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWwuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGVsLmNoaWxkcmVuW2ldLnRhZ05hbWUgPT09ICdURU1QTEFURScpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIga2V5ID0gZGF0YS5rZXkgPyBlbC5jaGlsZHJlbltpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3Ita2V5JykgOiBlbC5jaGlsZHJlbltpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3ItdmFsdWUnKTtcbiAgICAgICAgaWYgKGFjdGl2ZUtleXMuaW5kZXhPZihrZXkpID09PSAtMSAmJiByZW5kZXJlZEtleXMuaW5kZXhPZihrZXkpICE9PSAtMSkge1xuICAgICAgICAgIHRvUmVtb3ZlLnB1c2goZWwuY2hpbGRyZW5baV0pO1xuICAgICAgICAgIHJlbmRlcmVkS2V5cy5zcGxpY2UocmVuZGVyZWRLZXlzLmluZGV4T2Yoa2V5KSwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0b1JlbW92ZTtcbiAgICB9O1xuICB9KCksXG5cbiAgLyoqXG4gICAqIEdldCB2YWx1ZSB0byB1c2UgYXMgdGhlIGRhdGEtYmluZC1mb3Ita2V5LlxuICAgKiBGb3IgaXRlbXMsIHdpbGwgYmUgdmFsdWUgc3BlY2lmaWVkIGJ5IGBiaW5kLWZvci5rZXlgLlxuICAgKiBGb3Igc2ltcGxlIGxpc3QsIHdpbGwgYmUgdGhlIGluZGV4LlxuICAgKi9cbiAgZ2V0QmluZEZvcktleTogZnVuY3Rpb24gZ2V0QmluZEZvcktleShpdGVtLCBpKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YS5rZXkgPyBpdGVtW3RoaXMuZGF0YS5rZXldLnRvU3RyaW5nKCkgOiBpLnRvU3RyaW5nKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEhhbmRsZSBzdGF0ZSB1cGRhdGUuXG4gICAqL1xuICBvblN0YXRlVXBkYXRlOiBmdW5jdGlvbiBvblN0YXRlVXBkYXRlKCkge1xuICAgIGlmICh0aGlzLmRhdGEudXBkYXRlSW5QbGFjZSkge1xuICAgICAgdGhpcy5vblN0YXRlVXBkYXRlSW5QbGFjZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9uU3RhdGVVcGRhdGVOYWl2ZSgpO1xuICAgIH1cbiAgfVxufSk7XG5cbi8qKlxuICogSGFuZGxlIHBhcnNpbmcgYW5kIHVwZGF0ZSBpbi1wbGFjZSB1cGRhdGVzIHVuZGVyIGJpbmQtZm9yLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2JpbmQtaXRlbScsIHtcbiAgc2NoZW1hOiB7XG4gICAgdHlwZTogJ3N0cmluZydcbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgIHRoaXMuaXRlbURhdGEgPSBudWxsO1xuICAgIHRoaXMua2V5c1RvV2F0Y2ggPSBbXTtcbiAgICB0aGlzLnByZXZWYWx1ZXMgPSB7fTtcblxuICAgIC8vIExpc3RlbiB0byByb290IGl0ZW0gZm9yIGV2ZW50cy5cbiAgICB2YXIgcm9vdEVsID0gdGhpcy5yb290RWwgPSB0aGlzLmVsLmNsb3Nlc3QoJ1tkYXRhLWJpbmQtZm9yLWtleV0nKTtcbiAgICBpZiAoIXJvb3RFbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdiaW5kLWl0ZW0gY29tcG9uZW50IG11c3QgYmUgYXR0YWNoZWQgdG8gZW50aXR5IHVuZGVyIGEgYmluZC1mb3IgaXRlbS4nKTtcbiAgICB9XG4gICAgcm9vdEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2JpbmRmb3J1cGRhdGVpbnBsYWNlJywgdGhpcy51cGRhdGVJblBsYWNlLmJpbmQodGhpcykpO1xuICAgIHJvb3RFbC5hZGRFdmVudExpc3RlbmVyKCdiaW5kZm9yZGVhY3RpdmF0ZScsIHRoaXMuZGVhY3RpdmF0ZS5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlLnN1YnNjcmliZSh0aGlzKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICB0aGlzLnBhcnNlU2VsZWN0b3IoKTtcbiAgfSxcblxuICAvKipcbiAgICogUnVuIHdpdGggYmluZC1mb3IgdGVsbHMgdG8gdmlhIGV2ZW50IGBiaW5kZm9ydXBkYXRlaW5wbGFjZWAsIHBhc3NpbmcgaXRlbSBkYXRhLlxuICAgKi9cbiAgdXBkYXRlSW5QbGFjZTogZnVuY3Rpb24gdXBkYXRlSW5QbGFjZShldnQpIHtcbiAgICB2YXIgcHJvcGVydHlNYXAgPSB0aGlzLnByb3BlcnR5TWFwO1xuXG4gICAgaWYgKHRoaXMucm9vdEVsLmdldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1hY3RpdmUnKSA9PT0gJ2ZhbHNlJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChldnQpIHtcbiAgICAgIHRoaXMuaXRlbURhdGEgPSBldnQuZGV0YWlsO1xuICAgIH1cblxuICAgIGZvciAodmFyIHByb3BlcnR5IGluIHByb3BlcnR5TWFwKSB7XG4gICAgICAvLyBHZXQgdmFsdWUgZnJvbSBpdGVtLlxuICAgICAgdmFyIHZhbHVlID0gdGhpcy5zZWxlY3QodGhpcy5pdGVtRGF0YSwgcHJvcGVydHlNYXBbcHJvcGVydHldKTtcblxuICAgICAgLy8gRGlmZiBhZ2FpbnN0IHByZXZpb3VzIHZhbHVlLlxuICAgICAgaWYgKHZhbHVlID09PSB0aGlzLnByZXZWYWx1ZXNbcHJvcGVydHldKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBVcGRhdGUuXG4gICAgICBBRlJBTUUudXRpbHMuZW50aXR5LnNldENvbXBvbmVudFByb3BlcnR5KHRoaXMuZWwsIHByb3BlcnR5LCB2YWx1ZSk7XG5cbiAgICAgIHRoaXMucHJldlZhbHVlc1twcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICB9XG4gIH0sXG5cbiAgb25TdGF0ZVVwZGF0ZTogZnVuY3Rpb24gb25TdGF0ZVVwZGF0ZSgpIHtcbiAgICB0aGlzLnVwZGF0ZUluUGxhY2UoKTtcbiAgfSxcblxuICBzZWxlY3Q6IGZ1bmN0aW9uIHNlbGVjdChpdGVtRGF0YSwgc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gbGliLnNlbGVjdCh0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZS5zdGF0ZSwgc2VsZWN0b3IsIGl0ZW1EYXRhKTtcbiAgfSxcblxuICBkZWFjdGl2YXRlOiBmdW5jdGlvbiBkZWFjdGl2YXRlKCkge1xuICAgIHRoaXMucHJldlZhbHVlcyA9IHt9O1xuICB9LFxuXG4gIHBhcnNlU2VsZWN0b3I6IGZ1bmN0aW9uIHBhcnNlU2VsZWN0b3IoKSB7XG4gICAgdmFyIHByb3BlcnR5TWFwID0gdGhpcy5wcm9wZXJ0eU1hcCA9IHt9O1xuICAgIHRoaXMua2V5c1RvV2F0Y2gubGVuZ3RoID0gMDtcblxuICAgIHZhciBjb21wb25lbnROYW1lID0gbGliLnNwbGl0KHRoaXMuaWQsICdfXycpWzBdO1xuXG4gICAgLy8gRGlmZmVyZW50IHBhcnNpbmcgZm9yIG11bHRpLXByb3AgY29tcG9uZW50cy5cbiAgICBpZiAoY29tcG9uZW50TmFtZSBpbiBBRlJBTUUuY29tcG9uZW50cyAmJiAhQUZSQU1FLmNvbXBvbmVudHNbY29tcG9uZW50TmFtZV0uaXNTaW5nbGVQcm9wKSB7XG4gICAgICB2YXIgcHJvcGVydHlTcGxpdExpc3QgPSBsaWIuc3BsaXQodGhpcy5kYXRhLCAnOycpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wZXJ0eVNwbGl0TGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcHJvcGVydHlTcGxpdCA9IGxpYi5zcGxpdChwcm9wZXJ0eVNwbGl0TGlzdFtpXSwgJzonKTtcbiAgICAgICAgcHJvcGVydHlNYXBbdGhpcy5pZCArICcuJyArIHByb3BlcnR5U3BsaXRbMF0udHJpbSgpXSA9IHByb3BlcnR5U3BsaXRbMV0udHJpbSgpO1xuICAgICAgICBsaWIucGFyc2VLZXlzVG9XYXRjaCh0aGlzLmtleXNUb1dhdGNoLCBwcm9wZXJ0eVNwbGl0WzFdLnRyaW0oKSwgdHJ1ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcHJvcGVydHlNYXBbdGhpcy5pZF0gPSB0aGlzLmRhdGE7XG4gICAgbGliLnBhcnNlS2V5c1RvV2F0Y2godGhpcy5rZXlzVG9XYXRjaCwgdGhpcy5kYXRhLCB0cnVlKTtcbiAgfVxufSk7XG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdHdvIG9iamVjdHMgd2l0aCBhYmlsaXR5IHRvIGlnbm9yZSBrZXlzLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhIC0gRmlyc3Qgb2JqZWN0IHRvIGNvbXBhcmUgKGUuZy4sIG9sZERhdGEpLlxuICogQHBhcmFtIHtvYmplY3R9IGIgLSBTZWNvbmQgb2JqZWN0IHRvIGNvbXBhcmUgKGUuZy4sIG5ld0RhdGEpLlxuICogQHJldHVybnMge29iamVjdH1cbiAqICAgRGlmZmVyZW5jZSBvYmplY3Qgd2hlcmUgc2V0IG9mIGtleXMgbm90ZSB3aGljaCB2YWx1ZXMgd2VyZSBub3QgZXF1YWwsIGFuZCB2YWx1ZXMgYXJlXG4gKiAgIGBiYCdzIHZhbHVlcy5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBrZXlzID0gW107XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChhLCBiLCB0YXJnZXRPYmplY3QsIGlnbm9yZUtleXMpIHtcbiAgICB2YXIgYVZhbDtcbiAgICB2YXIgYlZhbDtcbiAgICB2YXIgYktleTtcbiAgICB2YXIgZGlmZjtcbiAgICB2YXIga2V5O1xuICAgIHZhciBpO1xuICAgIHZhciBpc0NvbXBhcmluZ09iamVjdHM7XG5cbiAgICBkaWZmID0gdGFyZ2V0T2JqZWN0IHx8IHt9O1xuXG4gICAgLy8gQ29sbGVjdCBBIGtleXMuXG4gICAga2V5cy5sZW5ndGggPSAwO1xuICAgIGZvciAoa2V5IGluIGEpIHtcbiAgICAgIGtleXMucHVzaChrZXkpO1xuICAgIH1cblxuICAgIGlmICghYikge1xuICAgICAgcmV0dXJuIGRpZmY7XG4gICAgfVxuXG4gICAgLy8gQ29sbGVjdCBCIGtleXMuXG4gICAgZm9yIChiS2V5IGluIGIpIHtcbiAgICAgIGlmIChrZXlzLmluZGV4T2YoYktleSkgPT09IC0xKSB7XG4gICAgICAgIGtleXMucHVzaChiS2V5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAga2V5ID0ga2V5c1tpXTtcblxuICAgICAgLy8gSWdub3JlIHNwZWNpZmllZCBrZXlzLlxuICAgICAgaWYgKGlnbm9yZUtleXMgJiYgaWdub3JlS2V5cy5pbmRleE9mKGtleSkgIT09IC0xKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBhVmFsID0gYVtrZXldO1xuICAgICAgYlZhbCA9IGJba2V5XTtcbiAgICAgIGlzQ29tcGFyaW5nT2JqZWN0cyA9IGFWYWwgJiYgYlZhbCAmJiBhVmFsLmNvbnN0cnVjdG9yID09PSBPYmplY3QgJiYgYlZhbC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0O1xuICAgICAgaWYgKGlzQ29tcGFyaW5nT2JqZWN0cyAmJiAhQUZSQU1FLnV0aWxzLmRlZXBFcXVhbChhVmFsLCBiVmFsKSB8fCAhaXNDb21wYXJpbmdPYmplY3RzICYmIGFWYWwgIT09IGJWYWwpIHtcbiAgICAgICAgZGlmZltrZXldID0gYlZhbDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRpZmY7XG4gIH07XG59KCk7XG5cbi8qKiovIH0pLFxuLyogNCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgZm5zID0gWydwdXNoJywgJ3BvcCcsICdzaGlmdCcsICd1bnNoaWZ0JywgJ3NwbGljZSddO1xuXG5mdW5jdGlvbiB3cmFwQXJyYXkoYXJyKSB7XG4gIHZhciBpO1xuICBpZiAoYXJyLl9fd3JhcHBlZCkge1xuICAgIHJldHVybjtcbiAgfVxuICBmb3IgKGkgPSAwOyBpIDwgZm5zLmxlbmd0aDsgaSsrKSB7XG4gICAgbWFrZUNhbGxEaXJ0eShhcnIsIGZuc1tpXSk7XG4gIH1cbiAgYXJyLl9fd3JhcHBlZCA9IHRydWU7XG59XG5tb2R1bGUuZXhwb3J0cy53cmFwQXJyYXkgPSB3cmFwQXJyYXk7XG5cbmZ1bmN0aW9uIG1ha2VDYWxsRGlydHkoYXJyLCBmbikge1xuICB2YXIgb3JpZ2luYWxGbiA9IGFycltmbl07XG4gIGFycltmbl0gPSBmdW5jdGlvbiAoKSB7XG4gICAgb3JpZ2luYWxGbi5hcHBseShhcnIsIGFyZ3VtZW50cyk7XG4gICAgYXJyLl9fZGlydHkgPSB0cnVlO1xuICB9O1xufVxuXG4vKioqLyB9KVxuLyoqKioqKi8gXSk7XG59KTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLXN0YXRlLWNvbXBvbmVudC9kaXN0L2FmcmFtZS1zdGF0ZS1jb21wb25lbnQuanNcbi8vIG1vZHVsZSBpZCA9IDMwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBUWVBFX1BBRCA9ICdQQUQnO1xudmFyIFRZUEVfU1RJQ0sgPSAnU1RJQ0snO1xuXG52YXIgQU5HTEVfUklHSFQgPSAwO1xudmFyIEFOR0xFX1VQID0gOTA7XG52YXIgQU5HTEVfTEVGVCA9IDE4MDtcbnZhciBBTkdMRV9ET1dOID0gMjcwO1xuXG52YXIgUklHSFQgPSAncmlnaHQnO1xudmFyIFVQID0gJ3VwJztcbnZhciBMRUZUID0gJ2xlZnQnO1xudmFyIERPV04gPSAnZG93bic7XG5cbnZhciBBTkdMRVMgPSBbQU5HTEVfUklHSFQsIEFOR0xFX1VQLCBBTkdMRV9MRUZULCBBTkdMRV9ET1dOXTtcbnZhciBESVJFQ1RJT05TID0gW1JJR0hULCBVUCwgTEVGVCwgRE9XTl07XG5cbnZhciBFVkVOVFMgPSB7TlVMTDoge1NUQVJUOiAndGh1bWJzdGFydCcsIEVORDogJ3RodW1iZW5kJ319O1xuRElSRUNUSU9OUy5mb3JFYWNoKGRpcmVjdGlvbiA9PiB7XG4gIEVWRU5UU1tkaXJlY3Rpb25dID0ge307XG4gIEVWRU5UU1tkaXJlY3Rpb25dLlNUQVJUID0gJ3RodW1iJyArIGRpcmVjdGlvbiArICdzdGFydCc7XG4gIEVWRU5UU1tkaXJlY3Rpb25dLkVORCAgPSAndGh1bWInICsgZGlyZWN0aW9uICsgJ2VuZCc7XG59KTtcblxuLy8gRm9yIGRlYnVnLlxudmFyIFNJWkUgPSAyNDA7XG5cbi8qKlxuICogTm9ybWFsaXplIHRyYWNrcGFkIHZzIHRodW1ic3RpY2sgY29udHJvbHMuXG4gKiBgdGh1bWJzdGFydGBcbiAqIGB0aHVtYmVuZGBcbiAqIGB0aHVtYmxlZnRzdGFydGBcbiAqIGB0aHVtYmxlZnRlbmRgXG4gKiBgdGh1bWJyaWdodHN0YXJ0YFxuICogYHRodW1icmlnaHRlbmRgXG4gKiBgdGh1bWJ1cHN0YXJ0YFxuICogYHRodW1idXBlbmRgXG4gKiBgdGh1bWJkb3duc3RhcnRgXG4gKiBgdGh1bWJkb3duZW5kYFxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3RodW1iLWNvbnRyb2xzJywge1xuICBkZXBlbmRlbmNpZXM6IFsndHJhY2tlZC1jb250cm9scyddLFxuXG4gIHNjaGVtYToge1xuICAgIHRocmVzaG9sZEFuZ2xlOiB7ZGVmYXVsdDogODkuNX0sXG4gICAgdGhyZXNob2xkUGFkOiB7ZGVmYXVsdDogMC4wNX0sXG4gICAgdGhyZXNob2xkU3RpY2s6IHtkZWZhdWx0OiAwLjc1fVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHRoaXMub25UcmFja3BhZERvd24gPSB0aGlzLm9uVHJhY2twYWREb3duLmJpbmQodGhpcylcbiAgICB0aGlzLm9uVHJhY2twYWRVcCA9IHRoaXMub25UcmFja3BhZFVwLmJpbmQodGhpcylcblxuICAgIHRoaXMuZGlyZWN0aW9uU3RpY2sgPSAnJztcbiAgICB0aGlzLmRpcmVjdGlvblRyYWNrcGFkID0gJyc7XG5cbiAgICAvLyBHZXQgdGh1bWIgdHlwZSAoc3RpY2sgdnMgcGFkKS5cbiAgICB0aGlzLnR5cGUgPSBUWVBFX1NUSUNLO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCBldnQgPT4ge1xuICAgICAgaWYgKGV2dC5kZXRhaWwubmFtZSA9PT0gJ29jdWx1cy10b3VjaC1jb250cm9scycgfHxcbiAgICAgICAgICBldnQuZGV0YWlsLm5hbWUgPT09ICd3aW5kb3dzLW1vdGlvbi1jb250cm9scycpIHtcbiAgICAgICAgdGhpcy50eXBlID0gVFlQRV9TVElDSztcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy50eXBlID0gVFlQRV9QQUQ7XG4gICAgfSk7XG5cbiAgICB0aGlzLmF4aXMgPSBlbC5jb21wb25lbnRzWyd0cmFja2VkLWNvbnRyb2xzJ10uYXhpcztcbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0cmFja3BhZGRvd24nLCB0aGlzLm9uVHJhY2twYWREb3duKTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0cmFja3BhZHVwJywgdGhpcy5vblRyYWNrcGFkVXApO1xuICB9LFxuXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFja3BhZGRvd24nLCB0aGlzLm9uVHJhY2twYWREb3duKTtcbiAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFja3BhZHVwJywgdGhpcy5vblRyYWNrcGFkVXApO1xuICB9LFxuXG4gIC8vIEZvciBwYWQuXG4gIG9uVHJhY2twYWREb3duOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRpcmVjdGlvbjtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBpO1xuICAgIGlmICh0aGlzLmdldERpc3RhbmNlKCkgPCB0aGlzLmRhdGEudGhyZXNob2xkUGFkKSB7IHJldHVybjsgfVxuICAgIGRpcmVjdGlvbiA9IHRoaXMuZ2V0RGlyZWN0aW9uKCk7XG4gICAgaWYgKCFkaXJlY3Rpb24pIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5kaXJlY3Rpb25UcmFja3BhZCA9IGRpcmVjdGlvbjtcbiAgICBlbC5lbWl0KEVWRU5UUy5OVUxMLlNUQVJULCBudWxsLCBmYWxzZSk7XG4gICAgZWwuZW1pdChFVkVOVFNbdGhpcy5kaXJlY3Rpb25UcmFja3BhZF0uU1RBUlQsIG51bGwsIGZhbHNlKTtcbiAgfSxcblxuICAvLyBGb3IgcGFkLlxuICBvblRyYWNrcGFkVXA6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIGlmICghdGhpcy5kaXJlY3Rpb25UcmFja3BhZCkgeyByZXR1cm47IH1cbiAgICBlbC5lbWl0KEVWRU5UUy5OVUxMLkVORCwgbnVsbCwgZmFsc2UpO1xuICAgIGVsLmVtaXQoRVZFTlRTW3RoaXMuZGlyZWN0aW9uVHJhY2twYWRdLkVORCwgbnVsbCwgZmFsc2UpO1xuICAgIHRoaXMuZGlyZWN0aW9uVHJhY2twYWQgPSAnJztcbiAgfSxcblxuICAvLyBBeGlzLlxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRpcmVjdGlvbjtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gVFlQRV9QQUQpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBTdGljayBwdWxsZWQuIFN0b3JlIGRpcmVjdGlvbiBhbmQgZW1pdCBzdGFydCBldmVudC5cbiAgICBpZiAoIXRoaXMuZGlyZWN0aW9uU3RpY2sgJiYgdGhpcy5nZXREaXN0YW5jZSgpID4gdGhpcy5kYXRhLnRocmVzaG9sZFN0aWNrKSB7XG4gICAgICBkaXJlY3Rpb24gPSB0aGlzLmdldERpcmVjdGlvbigpO1xuICAgICAgaWYgKCFkaXJlY3Rpb24pIHsgcmV0dXJuOyB9XG4gICAgICB0aGlzLmRpcmVjdGlvblN0aWNrID0gZGlyZWN0aW9uO1xuICAgICAgZWwuZW1pdChFVkVOVFMuTlVMTC5TVEFSVCwgbnVsbCwgZmFsc2UpO1xuICAgICAgZWwuZW1pdChFVkVOVFNbdGhpcy5kaXJlY3Rpb25TdGlja10uU1RBUlQsIG51bGwsIGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTdGljayBwdWxsZWQgYmFjay4gUmVzZXQgZGlyZWNpdG9uIGFuZCBlbWl0IGVuZCBldmVudC5cbiAgICBpZiAodGhpcy5kaXJlY3Rpb25TdGljayAmJiB0aGlzLmdldERpc3RhbmNlKCkgPCB0aGlzLmRhdGEudGhyZXNob2xkU3RpY2spIHtcbiAgICAgIGVsLmVtaXQoRVZFTlRTLk5VTEwuRU5ELCBudWxsLCBmYWxzZSk7XG4gICAgICBlbC5lbWl0KEVWRU5UU1t0aGlzLmRpcmVjdGlvblN0aWNrXS5FTkQsIG51bGwsIGZhbHNlKTtcbiAgICAgIHRoaXMuZGlyZWN0aW9uU3RpY2sgPSAnJztcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIERpc3RhbmNlIGZyb20gY2VudGVyIG9mIHRodW1iLlxuICAgKi9cbiAgZ2V0RGlzdGFuY2U6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXhpcyA9IHRoaXMuYXhpcztcbiAgICByZXR1cm4gTWF0aC5zcXJ0KGF4aXNbMV0gKiBheGlzWzFdICsgYXhpc1swXSAqIGF4aXNbMF0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUcmFuc2xhdGUgYW5nbGUgaW50byBkaXJlY3Rpb24uXG4gICAqL1xuICBnZXREaXJlY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYW5nbGU7XG4gICAgdmFyIGJvdHRvbVRocmVzaG9sZDtcbiAgICB2YXIgaTtcbiAgICB2YXIgdGhyZXNob2xkO1xuICAgIHZhciB0b3BUaHJlc2hvbGQ7XG4gICAgYW5nbGUgPSB0aGlzLmdldEFuZ2xlKCk7XG4gICAgdGhyZXNob2xkID0gdGhpcy5kYXRhLnRocmVzaG9sZEFuZ2xlIC8gMjtcbiAgICBmb3IgKGkgPSAwOyBpIDwgQU5HTEVTLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0b3BUaHJlc2hvbGQgPSBBTkdMRVNbaV0gKyB0aHJlc2hvbGQ7XG4gICAgICBpZiAodG9wVGhyZXNob2xkID4gMzYwKSB7IHRvcFRocmVzaG9sZCA9IHRvcFRocmVzaG9sZCAtIDM2MDsgfVxuXG4gICAgICBib3R0b21UaHJlc2hvbGQgPSBBTkdMRVNbaV0gLSB0aHJlc2hvbGQ7XG4gICAgICBpZiAoYm90dG9tVGhyZXNob2xkIDwgMCkge1xuICAgICAgICBpZiAoKGFuZ2xlID49IDM2MCArIGJvdHRvbVRocmVzaG9sZCAmJiBhbmdsZSA8PSAzNjApIHx8XG4gICAgICAgICAgICAoYW5nbGUgPj0gMCAmJiBhbmdsZSA8PSB0b3BUaHJlc2hvbGQpKSB7XG4gICAgICAgICAgcmV0dXJuIERJUkVDVElPTlNbaV07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGFuZ2xlID49IGJvdHRvbVRocmVzaG9sZCAmJiBhbmdsZSA8PSB0b3BUaHJlc2hvbGQpIHtcbiAgICAgICAgcmV0dXJuIERJUkVDVElPTlNbaV07XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgYW5nbGUgaW4gZGVncmVlcywgd2l0aCAwIHN0YXJ0aW5nIG9uIHRoZSByaWdodCBnb2luZyB0byAzNjAuIExpa2UgdW5pdCBjaXJjbGUuXG4gICAqL1xuICBnZXRBbmdsZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBhbmdsZTtcbiAgICB2YXIgYXhpcyA9IHRoaXMuYXhpcztcbiAgICB2YXIgZmxpcFk7XG4gICAgZmxpcFkgPSB0aGlzLnR5cGUgPT09IFRZUEVfU1RJQ0sgPyAtMSA6IDE7XG4gICAgYW5nbGUgPSBNYXRoLmF0YW4yKGF4aXNbMV0gKiBmbGlwWSwgYXhpc1swXSk7XG4gICAgaWYgKGFuZ2xlIDwgMCkgeyBhbmdsZSA9IDIgKiBNYXRoLlBJICsgYW5nbGU7IH1cbiAgICByZXR1cm4gVEhSRUUuTWF0aC5yYWRUb0RlZyhhbmdsZSk7XG4gIH1cbn0pO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3RodW1iLWNvbnRyb2xzLWRlYnVnJywge1xuICBkZXBlbmRlbmNpZXM6IFsndGh1bWItY29udHJvbHMnLCAndHJhY2tlZC1jb250cm9scyddLFxuXG4gIHNjaGVtYToge1xuICAgIGNvbnRyb2xsZXJUeXBlOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIGhhbmQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaXNBY3RpdmU7XG4gICAgdmFyIGF4aXM7XG4gICAgdmFyIGF4aXNNb3ZlRXZlbnREZXRhaWw7XG4gICAgdmFyIGNhbnZhcztcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgaWYgKCFkYXRhLmVuYWJsZWQgJiYgIUFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2RlYnVnLXRodW1iJykpIHsgcmV0dXJuOyB9XG4gICAgY29uc29sZS5sb2coJyVjIGRlYnVnLXRodW1iJywgJ2JhY2tncm91bmQ6ICMxMTE7IGNvbG9yOiByZWQnKTtcblxuICAgIC8vIFN0dWIuXG4gICAgZWwuY29tcG9uZW50c1sndHJhY2tlZC1jb250cm9scyddLmhhbmRsZUF4ZXMgPSAoKSA9PiB7fTtcblxuICAgIGF4aXMgPSBbMCwgMCwgMF07XG4gICAgYXhpc01vdmVFdmVudERldGFpbCA9IHtheGlzOiBheGlzfTtcbiAgICBlbC5jb21wb25lbnRzWyd0cmFja2VkLWNvbnRyb2xzJ10uYXhpcyA9IGF4aXM7XG4gICAgZWwuY29tcG9uZW50c1sndGh1bWItY29udHJvbHMnXS5heGlzID0gYXhpcztcblxuICAgIGNhbnZhcyA9IHRoaXMuY3JlYXRlQ2FudmFzKCk7XG5cbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldnQgPT4ge1xuICAgICAgaWYgKHRoaXMuZGF0YS5jb250cm9sbGVyVHlwZSA9PT0gJ3ZpdmUtY29udHJvbHMnKSB7XG4gICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgIGVsLmVtaXQoJ3RyYWNrcGFkdXAnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbC5lbWl0KCd0cmFja3BhZGRvd24nKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgICAgYXhpc1swXSA9IDA7XG4gICAgICAgICAgYXhpc1sxXSA9IDA7XG4gICAgICAgICAgZWwuZW1pdCgnYXhpc21vdmUnLCBheGlzTW92ZUV2ZW50RGV0YWlsLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlzQWN0aXZlID0gIWlzQWN0aXZlO1xuICAgIH0pO1xuXG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGV2dCA9PiB7XG4gICAgICB2YXIgcmVjdDtcbiAgICAgIGlmICghaXNBY3RpdmUpIHsgcmV0dXJuOyB9XG4gICAgICByZWN0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgYXhpc1swXSA9IChldnQuY2xpZW50WCAtIHJlY3QubGVmdCkgLyBTSVpFICogMiAtIDE7XG4gICAgICBheGlzWzFdID0gKGV2dC5jbGllbnRZIC0gcmVjdC50b3ApIC8gU0laRSAqIDIgLSAxO1xuICAgICAgZWwuZW1pdCgnYXhpc21vdmUnLCBheGlzTW92ZUV2ZW50RGV0YWlsLCBmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGV2dCA9PiB7XG4gICAgICBpZiAoIWlzQWN0aXZlKSB7IHJldHVybjsgfVxuICAgICAgYXhpc1swXSA9IDA7XG4gICAgICBheGlzWzFdID0gMDtcbiAgICAgIGVsLmVtaXQoJ2F4aXNtb3ZlJywgYXhpc01vdmVFdmVudERldGFpbCwgZmFsc2UpO1xuICAgIH0pO1xuICB9LFxuXG4gIGNyZWF0ZUNhbnZhczogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjYW52YXM7XG4gICAgdmFyIGN0eDtcbiAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICBjYW52YXMuY2xhc3NMaXN0LmFkZCgnZGVidWdUaHVtYicpO1xuICAgIGNhbnZhcy5oZWlnaHQgPSBTSVpFO1xuICAgIGNhbnZhcy53aWR0aCA9IFNJWkU7XG4gICAgY2FudmFzLnN0eWxlLmJvdHRvbSA9IDA7XG4gICAgY2FudmFzLnN0eWxlLmJvcmRlclJhZGl1cyA9ICcyNTBweCc7XG4gICAgY2FudmFzLnN0eWxlLm9wYWNpdHkgPSAwLjU7XG4gICAgY2FudmFzLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICBjYW52YXMuc3R5bGUuekluZGV4ID0gOTk5OTk5OTk5O1xuICAgIGlmICh0aGlzLmRhdGEuaGFuZCA9PT0gJ2xlZnQnKSB7XG4gICAgICBjYW52YXMuc3R5bGUubGVmdCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNhbnZhcy5zdHlsZS5yaWdodCA9IDA7XG4gICAgfVxuICAgIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGN0eC5maWxsU3R5bGUgPSBcIiMzMzNcIjtcbiAgICBjdHguZmlsbFJlY3QoMCwgMCwgU0laRSwgU0laRSk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjYW52YXMpO1xuICAgIHJldHVybiBjYW52YXM7XG4gIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS10aHVtYi1jb250cm9scy1jb21wb25lbnQvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDMxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIlxudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuL2luZGV4LmNzc1wiKTtcblxuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5cbnZhciB0cmFuc2Zvcm07XG52YXIgaW5zZXJ0SW50bztcblxuXG5cbnZhciBvcHRpb25zID0ge1wiaG1yXCI6dHJ1ZX1cblxub3B0aW9ucy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm1cbm9wdGlvbnMuaW5zZXJ0SW50byA9IHVuZGVmaW5lZDtcblxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9saWIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2FscztcblxuaWYobW9kdWxlLmhvdCkge1xuXHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhLi9pbmRleC5jc3NcIiwgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuL2luZGV4LmNzc1wiKTtcblxuXHRcdGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuXG5cdFx0dmFyIGxvY2FscyA9IChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHR2YXIga2V5LCBpZHggPSAwO1xuXG5cdFx0XHRmb3Ioa2V5IGluIGEpIHtcblx0XHRcdFx0aWYoIWIgfHwgYVtrZXldICE9PSBiW2tleV0pIHJldHVybiBmYWxzZTtcblx0XHRcdFx0aWR4Kys7XG5cdFx0XHR9XG5cblx0XHRcdGZvcihrZXkgaW4gYikgaWR4LS07XG5cblx0XHRcdHJldHVybiBpZHggPT09IDA7XG5cdFx0fShjb250ZW50LmxvY2FscywgbmV3Q29udGVudC5sb2NhbHMpKTtcblxuXHRcdGlmKCFsb2NhbHMpIHRocm93IG5ldyBFcnJvcignQWJvcnRpbmcgQ1NTIEhNUiBkdWUgdG8gY2hhbmdlZCBjc3MtbW9kdWxlcyBsb2NhbHMuJyk7XG5cblx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdH0pO1xuXG5cdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2luZGV4LmNzc1xuLy8gbW9kdWxlIGlkID0gMzJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIG1hcCA9IHtcblx0XCIuL2FjdGl2ZS1jb2xvci5qc1wiOiA1OSxcblx0XCIuL2F1ZGlvLWNvbHVtbnMuanNcIjogNjAsXG5cdFwiLi9iZWFtcy5qc1wiOiA2MSxcblx0XCIuL2JlYXQtaGl0LXNvdW5kLmpzXCI6IDYyLFxuXHRcIi4vYmVhdC1sb2FkZXIuanNcIjogNjMsXG5cdFwiLi9iZWF0LmpzXCI6IDY0LFxuXHRcIi4vY29uc29sZS1zaG9ydGN1dHMuanNcIjogNjUsXG5cdFwiLi9jb3B5LXRleHR1cmUuanNcIjogNjYsXG5cdFwiLi9jdXJzb3ItbGFzZXIuanNcIjogNjcsXG5cdFwiLi9jdXJzb3ItbWVzaC5qc1wiOiA2OCxcblx0XCIuL2RlYnVnLWJlYXQtbG9hZGVyLmpzXCI6IDY5LFxuXHRcIi4vZGVidWctY29udHJvbGxlci5qc1wiOiA3MCxcblx0XCIuL2RlYnVnLWN1cnNvci5qc1wiOiA3MSxcblx0XCIuL2RlYnVnLXNvbmctdGltZS5qc1wiOiA3Mixcblx0XCIuL2RlYnVnLXN0YXRlLmpzXCI6IDczLFxuXHRcIi4vZmFrZS1nbG93LmpzXCI6IDc0LFxuXHRcIi4vZmxvb3Itc2hhZGVyLmpzXCI6IDc1LFxuXHRcIi4vZ2FtZW92ZXIuanNcIjogNzYsXG5cdFwiLi9ncHUtcHJlbG9hZGVyLmpzXCI6IDc3LFxuXHRcIi4vaGFuZC1zd2FwcGVyLmpzXCI6IDc4LFxuXHRcIi4vaGFwdGljcy1zYWJlci5qc1wiOiA3OSxcblx0XCIuL2hhcHRpY3Mtd2FsbC5qc1wiOiA4MCxcblx0XCIuL2hpc3RvcnkuanNcIjogODEsXG5cdFwiLi9pbnRyby1zb25nLmpzXCI6IDgyLFxuXHRcIi4va2V5Ym9hcmQtcmF5Y2FzdGFibGUuanNcIjogODMsXG5cdFwiLi9sZWFkZXJib2FyZC5qc1wiOiA4NCxcblx0XCIuL2xvZ28tbGlnaHQuanNcIjogODUsXG5cdFwiLi9sb2dvZmxpY2tlci5qc1wiOiA4Nixcblx0XCIuL21hdGVyaWFscy5qc1wiOiA4Nyxcblx0XCIuL21lbnUtY29udHJvbHMuanNcIjogODgsXG5cdFwiLi9tZW51LWRpZmZpY3VsdHktc2VsZWN0LmpzXCI6IDg5LFxuXHRcIi4vbWVudS1zZWxlY3RlZC1jaGFsbGVuZ2UtaW1hZ2UuanNcIjogOTAsXG5cdFwiLi9tZW51LXNsaWRlLWFuaW1hdGlvbi5qc1wiOiA5MSxcblx0XCIuL21pbmUtZnJhZ21lbnRzLWxvYWRlci5qc1wiOiA5Mixcblx0XCIuL211bHRpcGxpZXItcmluZy5qc1wiOiA5Myxcblx0XCIuL3BhcnRpY2xlcGxheWVyLmpzXCI6IDk0LFxuXHRcIi4vcGF1c2UuanNcIjogOTUsXG5cdFwiLi9wYXVzZXIuanNcIjogOTYsXG5cdFwiLi9wbGF5LXNvdW5kLmpzXCI6IDk3LFxuXHRcIi4vcmF5Y2FzdGVyLXRhcmdldC5qc1wiOiA5OCxcblx0XCIuL3JlY2VudGVyLmpzXCI6IDk5LFxuXHRcIi4vc2FiZXItY29udHJvbHMuanNcIjogMTAwLFxuXHRcIi4vc2FiZXItcGFydGljbGVzLmpzXCI6IDEwMSxcblx0XCIuL3Njb3JlLWJlYXQuanNcIjogMTAyLFxuXHRcIi4vc2NvcmUtdGV4dHMuanNcIjogMTAzLFxuXHRcIi4vc2VhcmNoLXRodW1ibmFpbC1hdGxhcy5qc1wiOiAxMDQsXG5cdFwiLi9zZWFyY2guanNcIjogMTA1LFxuXHRcIi4vc29uZy1wcmV2aWV3LmpzXCI6IDEwNixcblx0XCIuL3NvbmctcHJvZ3Jlc3MtcmluZy5qc1wiOiAxMDcsXG5cdFwiLi9zb25nLmpzXCI6IDEwOCxcblx0XCIuL3N0YWdlLWNvbG9ycy5qc1wiOiAxMDksXG5cdFwiLi9zdGFnZS1sYXNlcnMuanNcIjogMTEwLFxuXHRcIi4vc3RhZ2Utc2hhZGVyLmpzXCI6IDExMSxcblx0XCIuL3N0YXRzLXBhcmFtLmpzXCI6IDExMixcblx0XCIuL3N0ZXBiYWNrLmpzXCI6IDExMyxcblx0XCIuL3N1Yi1vYmplY3QuanNcIjogMTE0LFxuXHRcIi4vc3VwZXIta2V5Ym9hcmQuanNcIjogMTE1LFxuXHRcIi4vc3VwZXJjdXRmeC1zaGFkZXIuanNcIjogMTE2LFxuXHRcIi4vc3VwZXJjdXRmeC5qc1wiOiAxMTcsXG5cdFwiLi90ZXh0LWNvdW50ZXIuanNcIjogMTE4LFxuXHRcIi4vdGV4dC11cHBlcmNhc2UuanNcIjogMTE5LFxuXHRcIi4vdG9nZ2xlLXBhdXNlLXBsYXkuanNcIjogMTIwLFxuXHRcIi4vdHJhaWwuanNcIjogMTIxLFxuXHRcIi4vdHV0b3JpYWwtMmQuanNcIjogMTIyLFxuXHRcIi4vdHdpc3Rlci5qc1wiOiAxMjMsXG5cdFwiLi92ZXJ0ZXgtY29sb3JzLWJ1ZmZlci5qc1wiOiAxMjQsXG5cdFwiLi92aWN0b3J5LWFjY3VyYWN5LXJpbmcuanNcIjogMTI1LFxuXHRcIi4vdmljdG9yeS1yYW5rLmpzXCI6IDEyNixcblx0XCIuL3Zpc2libGUtcmF5Y2FzdGFibGUuanNcIjogMTI3LFxuXHRcIi4vd2FsbC1zaGFkZXIuanNcIjogMTI4LFxuXHRcIi4vd2FsbC5qc1wiOiAxMjlcbn07XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dChyZXEpIHtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18od2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkpO1xufTtcbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpIHtcblx0dmFyIGlkID0gbWFwW3JlcV07XG5cdGlmKCEoaWQgKyAxKSkgLy8gY2hlY2sgZm9yIG51bWJlciBvciBzdHJpbmdcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInLlwiKTtcblx0cmV0dXJuIGlkO1xufTtcbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSAzMztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9jb21wb25lbnRzIFxcLmpzJFxuLy8gbW9kdWxlIGlkID0gMzNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIG1hcCA9IHtcblx0XCIuL2luZGV4LmpzXCI6IDEzM1xufTtcbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyh3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSk7XG59O1xuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHR2YXIgaWQgPSBtYXBbcmVxXTtcblx0aWYoIShpZCArIDEpKSAvLyBjaGVjayBmb3IgbnVtYmVyIG9yIHN0cmluZ1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIgKyByZXEgKyBcIicuXCIpO1xuXHRyZXR1cm4gaWQ7XG59O1xud2VicGFja0NvbnRleHQua2V5cyA9IGZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0S2V5cygpIHtcblx0cmV0dXJuIE9iamVjdC5rZXlzKG1hcCk7XG59O1xud2VicGFja0NvbnRleHQucmVzb2x2ZSA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZTtcbm1vZHVsZS5leHBvcnRzID0gd2VicGFja0NvbnRleHQ7XG53ZWJwYWNrQ29udGV4dC5pZCA9IDM0O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL3N0YXRlIFxcLmpzJFxuLy8gbW9kdWxlIGlkID0gMzRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuXG5mdW5jdGlvbiBfaW50ZXJvcERlZmF1bHQgKGV4KSB7IHJldHVybiAoZXggJiYgKHR5cGVvZiBleCA9PT0gJ29iamVjdCcpICYmICdkZWZhdWx0JyBpbiBleCkgPyBleFsnZGVmYXVsdCddIDogZXg7IH1cblxudmFyIGZpcmViYXNlID0gX2ludGVyb3BEZWZhdWx0KHJlcXVpcmUoJ0BmaXJlYmFzZS9hcHAnKSk7XG52YXIgbG9nZ2VyID0gcmVxdWlyZSgnQGZpcmViYXNlL2xvZ2dlcicpO1xudmFyIHRzbGliXzEgPSByZXF1aXJlKCd0c2xpYicpO1xudmFyIHdlYmNoYW5uZWxXcmFwcGVyID0gcmVxdWlyZSgnQGZpcmViYXNlL3dlYmNoYW5uZWwtd3JhcHBlcicpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqIFRoZSBzZW12ZXIgKHd3dy5zZW12ZXIub3JnKSB2ZXJzaW9uIG9mIHRoZSBTREsuICovXHJcbnZhciBTREtfVkVSU0lPTiA9IGZpcmViYXNlLlNES19WRVJTSU9OO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIGxvZ0NsaWVudCA9IG5ldyBsb2dnZXIuTG9nZ2VyKCdAZmlyZWJhc2UvZmlyZXN0b3JlJyk7XHJcbnZhciBMb2dMZXZlbDtcclxuKGZ1bmN0aW9uIChMb2dMZXZlbCkge1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJERUJVR1wiXSA9IDBdID0gXCJERUJVR1wiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJFUlJPUlwiXSA9IDFdID0gXCJFUlJPUlwiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJTSUxFTlRcIl0gPSAyXSA9IFwiU0lMRU5UXCI7XHJcbn0pKExvZ0xldmVsIHx8IChMb2dMZXZlbCA9IHt9KSk7XHJcbi8vIEhlbHBlciBtZXRob2RzIGFyZSBuZWVkZWQgYmVjYXVzZSB2YXJpYWJsZXMgY2FuJ3QgYmUgZXhwb3J0ZWQgYXMgcmVhZC93cml0ZVxyXG5mdW5jdGlvbiBnZXRMb2dMZXZlbCgpIHtcclxuICAgIGlmIChsb2dDbGllbnQubG9nTGV2ZWwgPT09IGxvZ2dlci5Mb2dMZXZlbC5ERUJVRykge1xyXG4gICAgICAgIHJldHVybiBMb2dMZXZlbC5ERUJVRztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGxvZ0NsaWVudC5sb2dMZXZlbCA9PT0gbG9nZ2VyLkxvZ0xldmVsLlNJTEVOVCkge1xyXG4gICAgICAgIHJldHVybiBMb2dMZXZlbC5TSUxFTlQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gTG9nTGV2ZWwuRVJST1I7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gc2V0TG9nTGV2ZWwobmV3TGV2ZWwpIHtcclxuICAgIC8qKlxyXG4gICAgICogTWFwIHRoZSBuZXcgbG9nIGxldmVsIHRvIHRoZSBhc3NvY2lhdGVkIEZpcmViYXNlIExvZyBMZXZlbFxyXG4gICAgICovXHJcbiAgICBzd2l0Y2ggKG5ld0xldmVsKSB7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5ERUJVRzpcclxuICAgICAgICAgICAgbG9nQ2xpZW50LmxvZ0xldmVsID0gbG9nZ2VyLkxvZ0xldmVsLkRFQlVHO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIExvZ0xldmVsLkVSUk9SOlxyXG4gICAgICAgICAgICBsb2dDbGllbnQubG9nTGV2ZWwgPSBsb2dnZXIuTG9nTGV2ZWwuRVJST1I7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgTG9nTGV2ZWwuU0lMRU5UOlxyXG4gICAgICAgICAgICBsb2dDbGllbnQubG9nTGV2ZWwgPSBsb2dnZXIuTG9nTGV2ZWwuU0lMRU5UO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBsb2dDbGllbnQuZXJyb3IoXCJGaXJlc3RvcmUgKFwiICsgU0RLX1ZFUlNJT04gKyBcIik6IEludmFsaWQgdmFsdWUgcGFzc2VkIHRvIGBzZXRMb2dMZXZlbGBcIik7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZGVidWcodGFnLCBtc2cpIHtcclxuICAgIHZhciBvYmogPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgb2JqW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgaWYgKGxvZ0NsaWVudC5sb2dMZXZlbCA8PSBsb2dnZXIuTG9nTGV2ZWwuREVCVUcpIHtcclxuICAgICAgICB2YXIgYXJncyA9IG9iai5tYXAoYXJnVG9TdHJpbmcpO1xyXG4gICAgICAgIGxvZ0NsaWVudC5kZWJ1Zy5hcHBseShsb2dDbGllbnQsIFtcIkZpcmVzdG9yZSAoXCIgKyBTREtfVkVSU0lPTiArIFwiKSBbXCIgKyB0YWcgKyBcIl06IFwiICsgbXNnXS5jb25jYXQoYXJncykpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGVycm9yKG1zZykge1xyXG4gICAgdmFyIG9iaiA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICBvYmpbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICBpZiAobG9nQ2xpZW50LmxvZ0xldmVsIDw9IGxvZ2dlci5Mb2dMZXZlbC5FUlJPUikge1xyXG4gICAgICAgIHZhciBhcmdzID0gb2JqLm1hcChhcmdUb1N0cmluZyk7XHJcbiAgICAgICAgbG9nQ2xpZW50LmVycm9yLmFwcGx5KGxvZ0NsaWVudCwgW1wiRmlyZXN0b3JlIChcIiArIFNES19WRVJTSU9OICsgXCIpOiBcIiArIG1zZ10uY29uY2F0KGFyZ3MpKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogQ29udmVydHMgYW4gYWRkaXRpb25hbCBsb2cgcGFyYW1ldGVyIHRvIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uLlxyXG4gKi9cclxuZnVuY3Rpb24gYXJnVG9TdHJpbmcob2JqKSB7XHJcbiAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdmFyIHBsYXRmb3JtID0gUGxhdGZvcm1TdXBwb3J0LmdldFBsYXRmb3JtKCk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIHBsYXRmb3JtLmZvcm1hdEpTT04ob2JqKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgLy8gQ29udmVydGluZyB0byBKU09OIGZhaWxlZCwganVzdCBsb2cgdGhlIG9iamVjdCBkaXJlY3RseVxyXG4gICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFVuY29uZGl0aW9uYWxseSBmYWlscywgdGhyb3dpbmcgYW4gRXJyb3Igd2l0aCB0aGUgZ2l2ZW4gbWVzc2FnZS5cclxuICpcclxuICogUmV0dXJucyBhbnkgc28gaXQgY2FuIGJlIHVzZWQgaW4gZXhwcmVzc2lvbnM6XHJcbiAqIEBleGFtcGxlXHJcbiAqIGxldCBmdXR1cmVWYXIgPSBmYWlsKCdub3QgaW1wbGVtZW50ZWQgeWV0Jyk7XHJcbiAqL1xyXG5mdW5jdGlvbiBmYWlsKGZhaWx1cmUpIHtcclxuICAgIC8vIExvZyB0aGUgZmFpbHVyZSBpbiBhZGRpdGlvbiB0byB0aHJvdyBhbiBleGNlcHRpb24sIGp1c3QgaW4gY2FzZSB0aGVcclxuICAgIC8vIGV4Y2VwdGlvbiBpcyBzd2FsbG93ZWQuXHJcbiAgICB2YXIgbWVzc2FnZSA9IFwiRklSRVNUT1JFIChcIiArIFNES19WRVJTSU9OICsgXCIpIElOVEVSTkFMIEFTU0VSVElPTiBGQUlMRUQ6IFwiICsgZmFpbHVyZTtcclxuICAgIGVycm9yKG1lc3NhZ2UpO1xyXG4gICAgLy8gTk9URTogV2UgZG9uJ3QgdXNlIEZpcmVzdG9yZUVycm9yIGhlcmUgYmVjYXVzZSB0aGVzZSBhcmUgaW50ZXJuYWwgZmFpbHVyZXNcclxuICAgIC8vIHRoYXQgY2Fubm90IGJlIGhhbmRsZWQgYnkgdGhlIHVzZXIuIChBbHNvIGl0IHdvdWxkIGNyZWF0ZSBhIGNpcmN1bGFyXHJcbiAgICAvLyBkZXBlbmRlbmN5IGJldHdlZW4gdGhlIGVycm9yIGFuZCBhc3NlcnQgbW9kdWxlcyB3aGljaCBkb2Vzbid0IHdvcmsuKVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xyXG59XHJcbi8qKlxyXG4gKiBGYWlscyBpZiB0aGUgZ2l2ZW4gYXNzZXJ0aW9uIGNvbmRpdGlvbiBpcyBmYWxzZSwgdGhyb3dpbmcgYW4gRXJyb3Igd2l0aCB0aGVcclxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBhc3NlcnQoYXNzZXJ0aW9uLCBtZXNzYWdlKSB7XHJcbiAgICBpZiAoIWFzc2VydGlvbikge1xyXG4gICAgICAgIGZhaWwobWVzc2FnZSk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQcm92aWRlcyBzaW5nbGV0b24gaGVscGVycyB3aGVyZSBzZXR1cCBjb2RlIGNhbiBpbmplY3QgYSBwbGF0Zm9ybSBhdCBydW50aW1lLlxyXG4gKiBzZXRQbGF0Zm9ybSBuZWVkcyB0byBiZSBzZXQgYmVmb3JlIEZpcmVzdG9yZSBpcyB1c2VkIGFuZCBtdXN0IGJlIHNldCBleGFjdGx5XHJcbiAqIG9uY2UuXHJcbiAqL1xyXG52YXIgUGxhdGZvcm1TdXBwb3J0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGxhdGZvcm1TdXBwb3J0KCkge1xyXG4gICAgfVxyXG4gICAgUGxhdGZvcm1TdXBwb3J0LnNldFBsYXRmb3JtID0gZnVuY3Rpb24gKHBsYXRmb3JtKSB7XHJcbiAgICAgICAgaWYgKFBsYXRmb3JtU3VwcG9ydC5wbGF0Zm9ybSkge1xyXG4gICAgICAgICAgICBmYWlsKCdQbGF0Zm9ybSBhbHJlYWR5IGRlZmluZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgUGxhdGZvcm1TdXBwb3J0LnBsYXRmb3JtID0gcGxhdGZvcm07XHJcbiAgICB9O1xyXG4gICAgUGxhdGZvcm1TdXBwb3J0LmdldFBsYXRmb3JtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghUGxhdGZvcm1TdXBwb3J0LnBsYXRmb3JtKSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ1BsYXRmb3JtIG5vdCBzZXQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFBsYXRmb3JtU3VwcG9ydC5wbGF0Zm9ybTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGxhdGZvcm1TdXBwb3J0O1xyXG59KCkpO1xyXG4vKipcclxuICogUmV0dXJucyB0aGUgcmVwcmVzZW50YXRpb24gb2YgYW4gZW1wdHkgXCJwcm90b1wiIGJ5dGUgc3RyaW5nIGZvciB0aGVcclxuICogcGxhdGZvcm0uXHJcbiAqL1xyXG5mdW5jdGlvbiBlbXB0eUJ5dGVTdHJpbmcoKSB7XHJcbiAgICByZXR1cm4gUGxhdGZvcm1TdXBwb3J0LmdldFBsYXRmb3JtKCkuZW1wdHlCeXRlU3RyaW5nO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBUT0RPKG1jZyk6IENoYW5nZSB0byBhIHN0cmluZyBlbnVtIG9uY2Ugd2UndmUgdXBncmFkZWQgdG8gdHlwZXNjcmlwdCAyLjQuXHJcbi8vICB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dmFyaWFibGUtbmFtZSBJbnRlbmRlZCB0byBsb29rIGxpa2UgYSBUUyAyLjQgZW51bVxyXG52YXIgQ29kZSA9IHtcclxuICAgIC8vIENhdXNlcyBhcmUgY29waWVkIGZyb206XHJcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ3JwYy9ncnBjL2Jsb2IvYmNlZWM5NGVhNGZjNWYwMDg1ZDgxMjM1ZDhlMWMwNjc5OGRjMzQxYS9pbmNsdWRlL2dycGMlMkIlMkIvaW1wbC9jb2RlZ2VuL3N0YXR1c19jb2RlX2VudW0uaFxyXG4gICAgLyoqIE5vdCBhbiBlcnJvcjsgcmV0dXJuZWQgb24gc3VjY2Vzcy4gKi9cclxuICAgIE9LOiAnb2snLFxyXG4gICAgLyoqIFRoZSBvcGVyYXRpb24gd2FzIGNhbmNlbGxlZCAodHlwaWNhbGx5IGJ5IHRoZSBjYWxsZXIpLiAqL1xyXG4gICAgQ0FOQ0VMTEVEOiAnY2FuY2VsbGVkJyxcclxuICAgIC8qKiBVbmtub3duIGVycm9yIG9yIGFuIGVycm9yIGZyb20gYSBkaWZmZXJlbnQgZXJyb3IgZG9tYWluLiAqL1xyXG4gICAgVU5LTk9XTjogJ3Vua25vd24nLFxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGllbnQgc3BlY2lmaWVkIGFuIGludmFsaWQgYXJndW1lbnQuIE5vdGUgdGhhdCB0aGlzIGRpZmZlcnMgZnJvbVxyXG4gICAgICogRkFJTEVEX1BSRUNPTkRJVElPTi4gSU5WQUxJRF9BUkdVTUVOVCBpbmRpY2F0ZXMgYXJndW1lbnRzIHRoYXQgYXJlXHJcbiAgICAgKiBwcm9ibGVtYXRpYyByZWdhcmRsZXNzIG9mIHRoZSBzdGF0ZSBvZiB0aGUgc3lzdGVtIChlLmcuLCBhIG1hbGZvcm1lZCBmaWxlXHJcbiAgICAgKiBuYW1lKS5cclxuICAgICAqL1xyXG4gICAgSU5WQUxJRF9BUkdVTUVOVDogJ2ludmFsaWQtYXJndW1lbnQnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWFkbGluZSBleHBpcmVkIGJlZm9yZSBvcGVyYXRpb24gY291bGQgY29tcGxldGUuIEZvciBvcGVyYXRpb25zIHRoYXRcclxuICAgICAqIGNoYW5nZSB0aGUgc3RhdGUgb2YgdGhlIHN5c3RlbSwgdGhpcyBlcnJvciBtYXkgYmUgcmV0dXJuZWQgZXZlbiBpZiB0aGVcclxuICAgICAqIG9wZXJhdGlvbiBoYXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4gRm9yIGV4YW1wbGUsIGEgc3VjY2Vzc2Z1bCByZXNwb25zZVxyXG4gICAgICogZnJvbSBhIHNlcnZlciBjb3VsZCBoYXZlIGJlZW4gZGVsYXllZCBsb25nIGVub3VnaCBmb3IgdGhlIGRlYWRsaW5lIHRvXHJcbiAgICAgKiBleHBpcmUuXHJcbiAgICAgKi9cclxuICAgIERFQURMSU5FX0VYQ0VFREVEOiAnZGVhZGxpbmUtZXhjZWVkZWQnLFxyXG4gICAgLyoqIFNvbWUgcmVxdWVzdGVkIGVudGl0eSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIHdhcyBub3QgZm91bmQuICovXHJcbiAgICBOT1RfRk9VTkQ6ICdub3QtZm91bmQnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBTb21lIGVudGl0eSB0aGF0IHdlIGF0dGVtcHRlZCB0byBjcmVhdGUgKGUuZy4sIGZpbGUgb3IgZGlyZWN0b3J5KSBhbHJlYWR5XHJcbiAgICAgKiBleGlzdHMuXHJcbiAgICAgKi9cclxuICAgIEFMUkVBRFlfRVhJU1RTOiAnYWxyZWFkeS1leGlzdHMnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgY2FsbGVyIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbiB0byBleGVjdXRlIHRoZSBzcGVjaWZpZWQgb3BlcmF0aW9uLlxyXG4gICAgICogUEVSTUlTU0lPTl9ERU5JRUQgbXVzdCBub3QgYmUgdXNlZCBmb3IgcmVqZWN0aW9ucyBjYXVzZWQgYnkgZXhoYXVzdGluZ1xyXG4gICAgICogc29tZSByZXNvdXJjZSAodXNlIFJFU09VUkNFX0VYSEFVU1RFRCBpbnN0ZWFkIGZvciB0aG9zZSBlcnJvcnMpLlxyXG4gICAgICogUEVSTUlTU0lPTl9ERU5JRUQgbXVzdCBub3QgYmUgdXNlZCBpZiB0aGUgY2FsbGVyIGNhbiBub3QgYmUgaWRlbnRpZmllZFxyXG4gICAgICogKHVzZSBVTkFVVEhFTlRJQ0FURUQgaW5zdGVhZCBmb3IgdGhvc2UgZXJyb3JzKS5cclxuICAgICAqL1xyXG4gICAgUEVSTUlTU0lPTl9ERU5JRUQ6ICdwZXJtaXNzaW9uLWRlbmllZCcsXHJcbiAgICAvKipcclxuICAgICAqIFRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgdmFsaWQgYXV0aGVudGljYXRpb24gY3JlZGVudGlhbHMgZm9yIHRoZVxyXG4gICAgICogb3BlcmF0aW9uLlxyXG4gICAgICovXHJcbiAgICBVTkFVVEhFTlRJQ0FURUQ6ICd1bmF1dGhlbnRpY2F0ZWQnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBTb21lIHJlc291cmNlIGhhcyBiZWVuIGV4aGF1c3RlZCwgcGVyaGFwcyBhIHBlci11c2VyIHF1b3RhLCBvciBwZXJoYXBzIHRoZVxyXG4gICAgICogZW50aXJlIGZpbGUgc3lzdGVtIGlzIG91dCBvZiBzcGFjZS5cclxuICAgICAqL1xyXG4gICAgUkVTT1VSQ0VfRVhIQVVTVEVEOiAncmVzb3VyY2UtZXhoYXVzdGVkJyxcclxuICAgIC8qKlxyXG4gICAgICogT3BlcmF0aW9uIHdhcyByZWplY3RlZCBiZWNhdXNlIHRoZSBzeXN0ZW0gaXMgbm90IGluIGEgc3RhdGUgcmVxdWlyZWQgZm9yXHJcbiAgICAgKiB0aGUgb3BlcmF0aW9uJ3MgZXhlY3V0aW9uLiBGb3IgZXhhbXBsZSwgZGlyZWN0b3J5IHRvIGJlIGRlbGV0ZWQgbWF5IGJlXHJcbiAgICAgKiBub24tZW1wdHksIGFuIHJtZGlyIG9wZXJhdGlvbiBpcyBhcHBsaWVkIHRvIGEgbm9uLWRpcmVjdG9yeSwgZXRjLlxyXG4gICAgICpcclxuICAgICAqIEEgbGl0bXVzIHRlc3QgdGhhdCBtYXkgaGVscCBhIHNlcnZpY2UgaW1wbGVtZW50b3IgaW4gZGVjaWRpbmdcclxuICAgICAqIGJldHdlZW4gRkFJTEVEX1BSRUNPTkRJVElPTiwgQUJPUlRFRCwgYW5kIFVOQVZBSUxBQkxFOlxyXG4gICAgICogIChhKSBVc2UgVU5BVkFJTEFCTEUgaWYgdGhlIGNsaWVudCBjYW4gcmV0cnkganVzdCB0aGUgZmFpbGluZyBjYWxsLlxyXG4gICAgICogIChiKSBVc2UgQUJPUlRFRCBpZiB0aGUgY2xpZW50IHNob3VsZCByZXRyeSBhdCBhIGhpZ2hlci1sZXZlbFxyXG4gICAgICogICAgICAoZS5nLiwgcmVzdGFydGluZyBhIHJlYWQtbW9kaWZ5LXdyaXRlIHNlcXVlbmNlKS5cclxuICAgICAqICAoYykgVXNlIEZBSUxFRF9QUkVDT05ESVRJT04gaWYgdGhlIGNsaWVudCBzaG91bGQgbm90IHJldHJ5IHVudGlsXHJcbiAgICAgKiAgICAgIHRoZSBzeXN0ZW0gc3RhdGUgaGFzIGJlZW4gZXhwbGljaXRseSBmaXhlZC4gRS5nLiwgaWYgYW4gXCJybWRpclwiXHJcbiAgICAgKiAgICAgIGZhaWxzIGJlY2F1c2UgdGhlIGRpcmVjdG9yeSBpcyBub24tZW1wdHksIEZBSUxFRF9QUkVDT05ESVRJT05cclxuICAgICAqICAgICAgc2hvdWxkIGJlIHJldHVybmVkIHNpbmNlIHRoZSBjbGllbnQgc2hvdWxkIG5vdCByZXRyeSB1bmxlc3NcclxuICAgICAqICAgICAgdGhleSBoYXZlIGZpcnN0IGZpeGVkIHVwIHRoZSBkaXJlY3RvcnkgYnkgZGVsZXRpbmcgZmlsZXMgZnJvbSBpdC5cclxuICAgICAqICAoZCkgVXNlIEZBSUxFRF9QUkVDT05ESVRJT04gaWYgdGhlIGNsaWVudCBwZXJmb3JtcyBjb25kaXRpb25hbFxyXG4gICAgICogICAgICBSRVNUIEdldC9VcGRhdGUvRGVsZXRlIG9uIGEgcmVzb3VyY2UgYW5kIHRoZSByZXNvdXJjZSBvbiB0aGVcclxuICAgICAqICAgICAgc2VydmVyIGRvZXMgbm90IG1hdGNoIHRoZSBjb25kaXRpb24uIEUuZy4sIGNvbmZsaWN0aW5nXHJcbiAgICAgKiAgICAgIHJlYWQtbW9kaWZ5LXdyaXRlIG9uIHRoZSBzYW1lIHJlc291cmNlLlxyXG4gICAgICovXHJcbiAgICBGQUlMRURfUFJFQ09ORElUSU9OOiAnZmFpbGVkLXByZWNvbmRpdGlvbicsXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBvcGVyYXRpb24gd2FzIGFib3J0ZWQsIHR5cGljYWxseSBkdWUgdG8gYSBjb25jdXJyZW5jeSBpc3N1ZSBsaWtlXHJcbiAgICAgKiBzZXF1ZW5jZXIgY2hlY2sgZmFpbHVyZXMsIHRyYW5zYWN0aW9uIGFib3J0cywgZXRjLlxyXG4gICAgICpcclxuICAgICAqIFNlZSBsaXRtdXMgdGVzdCBhYm92ZSBmb3IgZGVjaWRpbmcgYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OLCBBQk9SVEVELFxyXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxyXG4gICAgICovXHJcbiAgICBBQk9SVEVEOiAnYWJvcnRlZCcsXHJcbiAgICAvKipcclxuICAgICAqIE9wZXJhdGlvbiB3YXMgYXR0ZW1wdGVkIHBhc3QgdGhlIHZhbGlkIHJhbmdlLiBFLmcuLCBzZWVraW5nIG9yIHJlYWRpbmdcclxuICAgICAqIHBhc3QgZW5kIG9mIGZpbGUuXHJcbiAgICAgKlxyXG4gICAgICogVW5saWtlIElOVkFMSURfQVJHVU1FTlQsIHRoaXMgZXJyb3IgaW5kaWNhdGVzIGEgcHJvYmxlbSB0aGF0IG1heSBiZSBmaXhlZFxyXG4gICAgICogaWYgdGhlIHN5c3RlbSBzdGF0ZSBjaGFuZ2VzLiBGb3IgZXhhbXBsZSwgYSAzMi1iaXQgZmlsZSBzeXN0ZW0gd2lsbFxyXG4gICAgICogZ2VuZXJhdGUgSU5WQUxJRF9BUkdVTUVOVCBpZiBhc2tlZCB0byByZWFkIGF0IGFuIG9mZnNldCB0aGF0IGlzIG5vdCBpbiB0aGVcclxuICAgICAqIHJhbmdlIFswLDJeMzItMV0sIGJ1dCBpdCB3aWxsIGdlbmVyYXRlIE9VVF9PRl9SQU5HRSBpZiBhc2tlZCB0byByZWFkIGZyb21cclxuICAgICAqIGFuIG9mZnNldCBwYXN0IHRoZSBjdXJyZW50IGZpbGUgc2l6ZS5cclxuICAgICAqXHJcbiAgICAgKiBUaGVyZSBpcyBhIGZhaXIgYml0IG9mIG92ZXJsYXAgYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OIGFuZFxyXG4gICAgICogT1VUX09GX1JBTkdFLiBXZSByZWNvbW1lbmQgdXNpbmcgT1VUX09GX1JBTkdFICh0aGUgbW9yZSBzcGVjaWZpYyBlcnJvcilcclxuICAgICAqIHdoZW4gaXQgYXBwbGllcyBzbyB0aGF0IGNhbGxlcnMgd2hvIGFyZSBpdGVyYXRpbmcgdGhyb3VnaCBhIHNwYWNlIGNhblxyXG4gICAgICogZWFzaWx5IGxvb2sgZm9yIGFuIE9VVF9PRl9SQU5HRSBlcnJvciB0byBkZXRlY3Qgd2hlbiB0aGV5IGFyZSBkb25lLlxyXG4gICAgICovXHJcbiAgICBPVVRfT0ZfUkFOR0U6ICdvdXQtb2YtcmFuZ2UnLFxyXG4gICAgLyoqIE9wZXJhdGlvbiBpcyBub3QgaW1wbGVtZW50ZWQgb3Igbm90IHN1cHBvcnRlZC9lbmFibGVkIGluIHRoaXMgc2VydmljZS4gKi9cclxuICAgIFVOSU1QTEVNRU5URUQ6ICd1bmltcGxlbWVudGVkJyxcclxuICAgIC8qKlxyXG4gICAgICogSW50ZXJuYWwgZXJyb3JzLiBNZWFucyBzb21lIGludmFyaWFudHMgZXhwZWN0ZWQgYnkgdW5kZXJseWluZyBTeXN0ZW0gaGFzXHJcbiAgICAgKiBiZWVuIGJyb2tlbi4gSWYgeW91IHNlZSBvbmUgb2YgdGhlc2UgZXJyb3JzLCBTb21ldGhpbmcgaXMgdmVyeSBicm9rZW4uXHJcbiAgICAgKi9cclxuICAgIElOVEVSTkFMOiAnaW50ZXJuYWwnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc2VydmljZSBpcyBjdXJyZW50bHkgdW5hdmFpbGFibGUuIFRoaXMgaXMgYSBtb3N0IGxpa2VseSBhIHRyYW5zaWVudFxyXG4gICAgICogY29uZGl0aW9uIGFuZCBtYXkgYmUgY29ycmVjdGVkIGJ5IHJldHJ5aW5nIHdpdGggYSBiYWNrb2ZmLlxyXG4gICAgICpcclxuICAgICAqIFNlZSBsaXRtdXMgdGVzdCBhYm92ZSBmb3IgZGVjaWRpbmcgYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OLCBBQk9SVEVELFxyXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxyXG4gICAgICovXHJcbiAgICBVTkFWQUlMQUJMRTogJ3VuYXZhaWxhYmxlJyxcclxuICAgIC8qKiBVbnJlY292ZXJhYmxlIGRhdGEgbG9zcyBvciBjb3JydXB0aW9uLiAqL1xyXG4gICAgREFUQV9MT1NTOiAnZGF0YS1sb3NzJ1xyXG59O1xyXG4vKipcclxuICogQW4gZXJyb3IgY2xhc3MgdXNlZCBmb3IgRmlyZXN0b3JlLWdlbmVyYXRlZCBlcnJvcnMuIElkZWFsbHkgd2Ugc2hvdWxkIGJlXHJcbiAqIHVzaW5nIEZpcmViYXNlRXJyb3IsIGJ1dCBpbnRlZ3JhdGluZyB3aXRoIGl0IGlzIG92ZXJseSBhcmR1b3VzIGF0IHRoZSBtb21lbnQsXHJcbiAqIHNvIHdlIGRlZmluZSBvdXIgb3duIGNvbXBhdGlibGUgZXJyb3IgY2xhc3MgKHdpdGggYSBgbmFtZWAgb2YgJ0ZpcmViYXNlRXJyb3InXHJcbiAqIGFuZCBjb21wYXRpYmxlIGBjb2RlYCBhbmQgYG1lc3NhZ2VgIGZpZWxkcy4pXHJcbiAqL1xyXG52YXIgRmlyZXN0b3JlRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhGaXJlc3RvcmVFcnJvciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEZpcmVzdG9yZUVycm9yKGNvZGUsIG1lc3NhZ2UpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmNvZGUgPSBjb2RlO1xyXG4gICAgICAgIF90aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgICAgIF90aGlzLm5hbWUgPSAnRmlyZWJhc2VFcnJvcic7XHJcbiAgICAgICAgLy8gSEFDSzogV2Ugd3JpdGUgYSB0b1N0cmluZyBwcm9wZXJ0eSBkaXJlY3RseSBiZWNhdXNlIEVycm9yIGlzIG5vdCBhIHJlYWxcclxuICAgICAgICAvLyBjbGFzcyBhbmQgc28gaW5oZXJpdGFuY2UgZG9lcyBub3Qgd29yayBjb3JyZWN0bHkuIFdlIGNvdWxkIGFsdGVybmF0aXZlbHlcclxuICAgICAgICAvLyBkbyB0aGUgc2FtZSBcImJhY2stZG9vciBpbmhlcml0YW5jZVwiIHRyaWNrIHRoYXQgRmlyZWJhc2VFcnJvciBkb2VzLlxyXG4gICAgICAgIF90aGlzLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMubmFtZSArIFwiOiBbY29kZT1cIiArIF90aGlzLmNvZGUgKyBcIl06IFwiICsgX3RoaXMubWVzc2FnZTsgfTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRmlyZXN0b3JlRXJyb3I7XHJcbn0oRXJyb3IpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gcHJldmVudCBpbnN0YW50aWF0aW9uIHRocm91Z2ggdGhlIGNvbnN0cnVjdG9yLlxyXG4gKlxyXG4gKiBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgbmV3IGNvbnN0cnVjdG9yIHRoYXQgdGhyb3dzIHdoZW4gaXQncyBpbnZva2VkLlxyXG4gKiBUaGUgcHJvdG90eXBlIG9mIHRoYXQgY29uc3RydWN0b3IgaXMgdGhlbiBzZXQgdG8gdGhlIHByb3RvdHlwZSBvZiB0aGUgaGlkZGVuXHJcbiAqIFwiY2xhc3NcIiB0byBleHBvc2UgYWxsIHRoZSBwcm90b3R5cGUgbWV0aG9kcyBhbmQgYWxsb3cgZm9yIGluc3RhbmNlb2ZcclxuICogY2hlY2tzLlxyXG4gKlxyXG4gKiBUbyBhbHNvIG1ha2UgYWxsIHRoZSBzdGF0aWMgbWV0aG9kcyBhdmFpbGFibGUsIGFsbCBwcm9wZXJ0aWVzIG9mIHRoZVxyXG4gKiBvcmlnaW5hbCBjb25zdHJ1Y3RvciBhcmUgY29waWVkIHRvIHRoZSBuZXcgY29uc3RydWN0b3IuXHJcbiAqL1xyXG5mdW5jdGlvbiBtYWtlQ29uc3RydWN0b3JQcml2YXRlKGNscywgb3B0aW9uYWxNZXNzYWdlKSB7XHJcbiAgICBmdW5jdGlvbiBQdWJsaWNDb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB2YXIgZXJyb3IgPSAnVGhpcyBjb25zdHJ1Y3RvciBpcyBwcml2YXRlLic7XHJcbiAgICAgICAgaWYgKG9wdGlvbmFsTWVzc2FnZSkge1xyXG4gICAgICAgICAgICBlcnJvciArPSAnICc7XHJcbiAgICAgICAgICAgIGVycm9yICs9IG9wdGlvbmFsTWVzc2FnZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgZXJyb3IpO1xyXG4gICAgfVxyXG4gICAgLy8gTWFrZSBzdXJlIGluc3RhbmNlb2YgY2hlY2tzIHdvcmsgYW5kIGFsbCBtZXRob2RzIGFyZSBleHBvc2VkIG9uIHRoZSBwdWJsaWNcclxuICAgIC8vIGNvbnN0cnVjdG9yXHJcbiAgICBQdWJsaWNDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBjbHMucHJvdG90eXBlO1xyXG4gICAgLy8gQ29weSBhbnkgc3RhdGljIG1ldGhvZHMvbWVtYmVyc1xyXG4gICAgZm9yICh2YXIgc3RhdGljUHJvcGVydHkgaW4gY2xzKSB7XHJcbiAgICAgICAgaWYgKGNscy5oYXNPd25Qcm9wZXJ0eShzdGF0aWNQcm9wZXJ0eSkpIHtcclxuICAgICAgICAgICAgUHVibGljQ29uc3RydWN0b3Jbc3RhdGljUHJvcGVydHldID0gY2xzW3N0YXRpY1Byb3BlcnR5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHVibGljQ29uc3RydWN0b3I7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGNvbnRhaW5zKG9iaiwga2V5KSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcclxufVxyXG4vKiogUmV0dXJucyB0aGUgZ2l2ZW4gdmFsdWUgaWYgaXQncyBkZWZpbmVkIG9yIHRoZSBkZWZhdWx0VmFsdWUgb3RoZXJ3aXNlLiAqL1xyXG5mdW5jdGlvbiBkZWZhdWx0ZWQodmFsdWUsIGRlZmF1bHRWYWx1ZSkge1xyXG4gICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IGRlZmF1bHRWYWx1ZTtcclxufVxyXG5mdW5jdGlvbiBmb3JFYWNoTnVtYmVyKG9iaiwgZm4pIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICB2YXIgbnVtID0gTnVtYmVyKGtleSk7XHJcbiAgICAgICAgICAgIGlmICghaXNOYU4obnVtKSkge1xyXG4gICAgICAgICAgICAgICAgZm4obnVtLCBvYmpba2V5XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdmFsdWVzKG9iaikge1xyXG4gICAgdmFyIHZzID0gW107XHJcbiAgICBmb3JFYWNoKG9iaiwgZnVuY3Rpb24gKF8sIHYpIHsgcmV0dXJuIHZzLnB1c2godik7IH0pO1xyXG4gICAgcmV0dXJuIHZzO1xyXG59XHJcbmZ1bmN0aW9uIGZvckVhY2gob2JqLCBmbikge1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIGZuKGtleSwgb2JqW2tleV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpc0VtcHR5KG9iaikge1xyXG4gICAgYXNzZXJ0KG9iaiAhPSBudWxsICYmIHR5cGVvZiBvYmogPT09ICdvYmplY3QnLCAnaXNFbXB0eSgpIGV4cGVjdHMgb2JqZWN0IHBhcmFtZXRlci4nKTtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuZnVuY3Rpb24gc2hhbGxvd0NvcHkob2JqKSB7XHJcbiAgICBhc3NlcnQob2JqICYmIHR5cGVvZiBvYmogPT09ICdvYmplY3QnLCAnc2hhbGxvd0NvcHkoKSBleHBlY3RzIG9iamVjdCBwYXJhbWV0ZXIuJyk7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBvYmpba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVmFsaWRhdGVzIHRoZSBpbnZvY2F0aW9uIG9mIGZ1bmN0aW9uTmFtZSBoYXMgdGhlIGV4YWN0IG51bWJlciBvZiBhcmd1bWVudHMuXHJcbiAqXHJcbiAqIEZvcndhcmQgdGhlIG1hZ2ljIFwiYXJndW1lbnRzXCIgdmFyaWFibGUgYXMgc2Vjb25kIHBhcmFtZXRlciBvbiB3aGljaCB0aGVcclxuICogcGFyYW1ldGVyIHZhbGlkYXRpb24gaXMgcGVyZm9ybWVkOlxyXG4gKiB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdteUZ1bmN0aW9uJywgYXJndW1lbnRzLCAyKTtcclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoZnVuY3Rpb25OYW1lLCBhcmdzLCBudW1iZXJPZkFyZ3MpIHtcclxuICAgIGlmIChhcmdzLmxlbmd0aCAhPT0gbnVtYmVyT2ZBcmdzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgcmVxdWlyZXMgXCIgK1xyXG4gICAgICAgICAgICBmb3JtYXRQbHVyYWwobnVtYmVyT2ZBcmdzLCAnYXJndW1lbnQnKSArXHJcbiAgICAgICAgICAgICcsIGJ1dCB3YXMgY2FsbGVkIHdpdGggJyArXHJcbiAgICAgICAgICAgIGZvcm1hdFBsdXJhbChhcmdzLmxlbmd0aCwgJ2FyZ3VtZW50JykgK1xyXG4gICAgICAgICAgICAnLicpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhlIGludm9jYXRpb24gb2YgZnVuY3Rpb25OYW1lIGhhcyBhdCBsZWFzdCB0aGUgcHJvdmlkZWQgbnVtYmVyIG9mXHJcbiAqIGFyZ3VtZW50cyAoYnV0IGNhbiBoYXZlIG1hbnkgbW9yZSkuXHJcbiAqXHJcbiAqIEZvcndhcmQgdGhlIG1hZ2ljIFwiYXJndW1lbnRzXCIgdmFyaWFibGUgYXMgc2Vjb25kIHBhcmFtZXRlciBvbiB3aGljaCB0aGVcclxuICogcGFyYW1ldGVyIHZhbGlkYXRpb24gaXMgcGVyZm9ybWVkOlxyXG4gKiB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ215RnVuY3Rpb24nLCBhcmd1bWVudHMsIDIpO1xyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKGZ1bmN0aW9uTmFtZSwgYXJncywgbWluTnVtYmVyT2ZBcmdzKSB7XHJcbiAgICBpZiAoYXJncy5sZW5ndGggPCBtaW5OdW1iZXJPZkFyZ3MpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSByZXF1aXJlcyBhdCBsZWFzdCBcIiArXHJcbiAgICAgICAgICAgIGZvcm1hdFBsdXJhbChtaW5OdW1iZXJPZkFyZ3MsICdhcmd1bWVudCcpICtcclxuICAgICAgICAgICAgJywgYnV0IHdhcyBjYWxsZWQgd2l0aCAnICtcclxuICAgICAgICAgICAgZm9ybWF0UGx1cmFsKGFyZ3MubGVuZ3RoLCAnYXJndW1lbnQnKSArXHJcbiAgICAgICAgICAgICcuJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGUgaW52b2NhdGlvbiBvZiBmdW5jdGlvbk5hbWUgaGFzIG51bWJlciBvZiBhcmd1bWVudHMgYmV0d2VlblxyXG4gKiB0aGUgdmFsdWVzIHByb3ZpZGVkLlxyXG4gKlxyXG4gKiBGb3J3YXJkIHRoZSBtYWdpYyBcImFyZ3VtZW50c1wiIHZhcmlhYmxlIGFzIHNlY29uZCBwYXJhbWV0ZXIgb24gd2hpY2ggdGhlXHJcbiAqIHBhcmFtZXRlciB2YWxpZGF0aW9uIGlzIHBlcmZvcm1lZDpcclxuICogdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdteUZ1bmN0aW9uJywgYXJndW1lbnRzLCAyLCAzKTtcclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncyhmdW5jdGlvbk5hbWUsIGFyZ3MsIG1pbk51bWJlck9mQXJncywgbWF4TnVtYmVyT2ZBcmdzKSB7XHJcbiAgICBpZiAoYXJncy5sZW5ndGggPCBtaW5OdW1iZXJPZkFyZ3MgfHwgYXJncy5sZW5ndGggPiBtYXhOdW1iZXJPZkFyZ3MpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSByZXF1aXJlcyBiZXR3ZWVuIFwiICsgbWluTnVtYmVyT2ZBcmdzICsgXCIgYW5kIFwiICtcclxuICAgICAgICAgICAgKG1heE51bWJlck9mQXJncyArIFwiIGFyZ3VtZW50cywgYnV0IHdhcyBjYWxsZWQgd2l0aCBcIikgK1xyXG4gICAgICAgICAgICBmb3JtYXRQbHVyYWwoYXJncy5sZW5ndGgsICdhcmd1bWVudCcpICtcclxuICAgICAgICAgICAgJy4nKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoZSBwcm92aWRlZCBhcmd1bWVudCBpcyBhbiBhcnJheSBhbmQgaGFzIGFzIGxlYXN0IHRoZSBleHBlY3RlZFxyXG4gKiBudW1iZXIgb2YgZWxlbWVudHMuXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVkQXJyYXlBdExlYXN0TnVtYmVyT2ZFbGVtZW50cyhmdW5jdGlvbk5hbWUsIHZhbHVlLCBuYW1lLCBtaW5OdW1iZXJPZkVsZW1lbnRzKSB7XHJcbiAgICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB8fCB2YWx1ZS5sZW5ndGggPCBtaW5OdW1iZXJPZkVsZW1lbnRzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgcmVxdWlyZXMgaXRzIFwiICsgbmFtZSArIFwiIGFyZ3VtZW50IHRvIGJlIGFuIFwiICtcclxuICAgICAgICAgICAgJ2FycmF5IHdpdGggYXQgbGVhc3QgJyArXHJcbiAgICAgICAgICAgIChmb3JtYXRQbHVyYWwobWluTnVtYmVyT2ZFbGVtZW50cywgJ2VsZW1lbnQnKSArIFwiLlwiKSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGUgcHJvdmlkZWQgcG9zaXRpb25hbCBhcmd1bWVudCBoYXMgdGhlIG5hdGl2ZSBKYXZhU2NyaXB0IHR5cGVcclxuICogdXNpbmcgdHlwZW9mIGNoZWNrcy5cclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlQXJnVHlwZShmdW5jdGlvbk5hbWUsIHR5cGUsIHBvc2l0aW9uLCBhcmd1bWVudCkge1xyXG4gICAgdmFsaWRhdGVUeXBlKGZ1bmN0aW9uTmFtZSwgdHlwZSwgb3JkaW5hbChwb3NpdGlvbikgKyBcIiBhcmd1bWVudFwiLCBhcmd1bWVudCk7XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGUgcHJvdmlkZWQgYXJndW1lbnQgaGFzIHRoZSBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlIHVzaW5nXHJcbiAqIHR5cGVvZiBjaGVja3Mgb3IgaXMgdW5kZWZpbmVkLlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVPcHRpb25hbEFyZ1R5cGUoZnVuY3Rpb25OYW1lLCB0eXBlLCBwb3NpdGlvbiwgYXJndW1lbnQpIHtcclxuICAgIGlmIChhcmd1bWVudCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKGZ1bmN0aW9uTmFtZSwgdHlwZSwgcG9zaXRpb24sIGFyZ3VtZW50KTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoZSBwcm92aWRlZCBuYW1lZCBvcHRpb24gaGFzIHRoZSBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlIHVzaW5nXHJcbiAqIHR5cGVvZiBjaGVja3MuXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVkVHlwZShmdW5jdGlvbk5hbWUsIHR5cGUsIG9wdGlvbk5hbWUsIGFyZ3VtZW50KSB7XHJcbiAgICB2YWxpZGF0ZVR5cGUoZnVuY3Rpb25OYW1lLCB0eXBlLCBvcHRpb25OYW1lICsgXCIgb3B0aW9uXCIsIGFyZ3VtZW50KTtcclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoZSBwcm92aWRlZCBuYW1lZCBvcHRpb24gaGFzIHRoZSBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlIHVzaW5nXHJcbiAqIHR5cGVvZiBjaGVja3Mgb3IgaXMgdW5kZWZpbmVkLlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lZE9wdGlvbmFsVHlwZShmdW5jdGlvbk5hbWUsIHR5cGUsIG9wdGlvbk5hbWUsIGFyZ3VtZW50KSB7XHJcbiAgICBpZiAoYXJndW1lbnQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbGlkYXRlTmFtZWRUeXBlKGZ1bmN0aW9uTmFtZSwgdHlwZSwgb3B0aW9uTmFtZSwgYXJndW1lbnQpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlQXJyYXlFbGVtZW50cyhmdW5jdGlvbk5hbWUsIG9wdGlvbk5hbWUsIHR5cGVEZXNjcmlwdGlvbiwgYXJndW1lbnQsIHZhbGlkYXRvcikge1xyXG4gICAgaWYgKCEoYXJndW1lbnQgaW5zdGFuY2VvZiBBcnJheSkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSByZXF1aXJlcyBpdHMgXCIgKyBvcHRpb25OYW1lICsgXCIgXCIgK1xyXG4gICAgICAgICAgICAoXCJvcHRpb24gdG8gYmUgYW4gYXJyYXksIGJ1dCBpdCB3YXM6IFwiICsgdmFsdWVEZXNjcmlwdGlvbihhcmd1bWVudCkpKTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnQubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICBpZiAoIXZhbGlkYXRvcihhcmd1bWVudFtpXSkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgcmVxdWlyZXMgYWxsIFwiICsgb3B0aW9uTmFtZSArIFwiIFwiICtcclxuICAgICAgICAgICAgICAgIChcImVsZW1lbnRzIHRvIGJlIFwiICsgdHlwZURlc2NyaXB0aW9uICsgXCIsIGJ1dCB0aGUgdmFsdWUgYXQgaW5kZXggXCIgKyBpICsgXCIgXCIpICtcclxuICAgICAgICAgICAgICAgIChcIndhczogXCIgKyB2YWx1ZURlc2NyaXB0aW9uKGFyZ3VtZW50W2ldKSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZU9wdGlvbmFsQXJyYXlFbGVtZW50cyhmdW5jdGlvbk5hbWUsIG9wdGlvbk5hbWUsIHR5cGVEZXNjcmlwdGlvbiwgYXJndW1lbnQsIHZhbGlkYXRvcikge1xyXG4gICAgaWYgKGFyZ3VtZW50ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWxpZGF0ZUFycmF5RWxlbWVudHMoZnVuY3Rpb25OYW1lLCBvcHRpb25OYW1lLCB0eXBlRGVzY3JpcHRpb24sIGFyZ3VtZW50LCB2YWxpZGF0b3IpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhhdCB0aGUgcHJvdmlkZWQgbmFtZWQgb3B0aW9uIGVxdWFscyBvbmUgb2YgdGhlIGV4cGVjdGVkIHZhbHVlcy5cclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTmFtZWRQcm9wZXJ0eUVxdWFscyhmdW5jdGlvbk5hbWUsIGlucHV0TmFtZSwgb3B0aW9uTmFtZSwgaW5wdXQsIGV4cGVjdGVkKSB7XHJcbiAgICB2YXIgZXhwZWN0ZWREZXNjcmlwdGlvbiA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBleHBlY3RlZF8xID0gZXhwZWN0ZWQ7IF9pIDwgZXhwZWN0ZWRfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgdmFsID0gZXhwZWN0ZWRfMVtfaV07XHJcbiAgICAgICAgaWYgKHZhbCA9PT0gaW5wdXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBleHBlY3RlZERlc2NyaXB0aW9uLnB1c2godmFsdWVEZXNjcmlwdGlvbih2YWwpKTtcclxuICAgIH1cclxuICAgIHZhciBhY3R1YWxEZXNjcmlwdGlvbiA9IHZhbHVlRGVzY3JpcHRpb24oaW5wdXQpO1xyXG4gICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHZhbHVlIFwiICsgYWN0dWFsRGVzY3JpcHRpb24gKyBcIiBwcm92aWRlZCB0byBmdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgZm9yIG9wdGlvbiBcIiArXHJcbiAgICAgICAgKFwiXFxcIlwiICsgb3B0aW9uTmFtZSArIFwiXFxcIi4gQWNjZXB0YWJsZSB2YWx1ZXM6IFwiICsgZXhwZWN0ZWREZXNjcmlwdGlvbi5qb2luKCcsICcpKSk7XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGF0IHRoZSBwcm92aWRlZCBuYW1lZCBvcHRpb24gZXF1YWxzIG9uZSBvZiB0aGUgZXhwZWN0ZWQgdmFsdWVzIG9yXHJcbiAqIGlzIHVuZGVmaW5lZC5cclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTmFtZWRPcHRpb25hbFByb3BlcnR5RXF1YWxzKGZ1bmN0aW9uTmFtZSwgaW5wdXROYW1lLCBvcHRpb25OYW1lLCBpbnB1dCwgZXhwZWN0ZWQpIHtcclxuICAgIGlmIChpbnB1dCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsaWRhdGVOYW1lZFByb3BlcnR5RXF1YWxzKGZ1bmN0aW9uTmFtZSwgaW5wdXROYW1lLCBvcHRpb25OYW1lLCBpbnB1dCwgZXhwZWN0ZWQpO1xyXG4gICAgfVxyXG59XHJcbi8qKiBIZWxwZXIgdG8gdmFsaWRhdGUgdGhlIHR5cGUgb2YgYSBwcm92aWRlZCBpbnB1dC4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVUeXBlKGZ1bmN0aW9uTmFtZSwgdHlwZSwgaW5wdXROYW1lLCBpbnB1dCkge1xyXG4gICAgdmFyIHZhbGlkID0gZmFsc2U7XHJcbiAgICBpZiAodHlwZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICB2YWxpZCA9IGlzUGxhaW5PYmplY3QoaW5wdXQpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZSA9PT0gJ25vbi1lbXB0eSBzdHJpbmcnKSB7XHJcbiAgICAgICAgdmFsaWQgPSB0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnICYmIGlucHV0ICE9PSAnJztcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHZhbGlkID0gdHlwZW9mIGlucHV0ID09PSB0eXBlO1xyXG4gICAgfVxyXG4gICAgaWYgKCF2YWxpZCkge1xyXG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IHZhbHVlRGVzY3JpcHRpb24oaW5wdXQpO1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIHJlcXVpcmVzIGl0cyBcIiArIGlucHV0TmFtZSArIFwiIFwiICtcclxuICAgICAgICAgICAgKFwidG8gYmUgb2YgdHlwZSBcIiArIHR5cGUgKyBcIiwgYnV0IGl0IHdhczogXCIgKyBkZXNjcmlwdGlvbikpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRydWUgaWYgaXQncyBhIG5vbi1udWxsIG9iamVjdCB3aXRob3V0IGEgY3VzdG9tIHByb3RvdHlwZVxyXG4gKiAoaS5lLiBleGNsdWRlcyBBcnJheSwgRGF0ZSwgZXRjLikuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1BsYWluT2JqZWN0KGlucHV0KSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcgJiZcclxuICAgICAgICBpbnB1dCAhPT0gbnVsbCAmJlxyXG4gICAgICAgIChPYmplY3QuZ2V0UHJvdG90eXBlT2YoaW5wdXQpID09PSBPYmplY3QucHJvdG90eXBlIHx8XHJcbiAgICAgICAgICAgIE9iamVjdC5nZXRQcm90b3R5cGVPZihpbnB1dCkgPT09IG51bGwpKTtcclxufVxyXG4vKiogUmV0dXJucyBhIHN0cmluZyBkZXNjcmliaW5nIHRoZSB0eXBlIC8gdmFsdWUgb2YgdGhlIHByb3ZpZGVkIGlucHV0LiAqL1xyXG5mdW5jdGlvbiB2YWx1ZURlc2NyaXB0aW9uKGlucHV0KSB7XHJcbiAgICBpZiAoaW5wdXQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiAndW5kZWZpbmVkJztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlucHV0ID09PSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuICdudWxsJztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBpZiAoaW5wdXQubGVuZ3RoID4gMjApIHtcclxuICAgICAgICAgICAgaW5wdXQgPSBpbnB1dC5zdWJzdHJpbmcoMCwgMjApICsgXCIuLi5cIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGlucHV0KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ251bWJlcicgfHwgdHlwZW9mIGlucHV0ID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICByZXR1cm4gJycgKyBpbnB1dDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ2FuIGFycmF5JztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBjdXN0b21PYmplY3ROYW1lID0gdHJ5R2V0Q3VzdG9tT2JqZWN0VHlwZShpbnB1dCk7XHJcbiAgICAgICAgICAgIGlmIChjdXN0b21PYmplY3ROYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhIGN1c3RvbSBcIiArIGN1c3RvbU9iamVjdE5hbWUgKyBcIiBvYmplY3RcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnYW4gb2JqZWN0JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIHJldHVybiAnYSBmdW5jdGlvbic7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biB3cm9uZyB0eXBlOiAnICsgdHlwZW9mIGlucHV0KTtcclxuICAgIH1cclxufVxyXG4vKiogSGFja3kgbWV0aG9kIHRvIHRyeSB0byBnZXQgdGhlIGNvbnN0cnVjdG9yIG5hbWUgZm9yIGFuIG9iamVjdC4gKi9cclxuZnVuY3Rpb24gdHJ5R2V0Q3VzdG9tT2JqZWN0VHlwZShpbnB1dCkge1xyXG4gICAgaWYgKGlucHV0LmNvbnN0cnVjdG9yKSB7XHJcbiAgICAgICAgdmFyIGZ1bmNOYW1lUmVnZXggPSAvZnVuY3Rpb25cXHMrKFteXFxzKF0rKVxccypcXCgvO1xyXG4gICAgICAgIHZhciByZXN1bHRzID0gZnVuY05hbWVSZWdleC5leGVjKGlucHV0LmNvbnN0cnVjdG9yLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGlmIChyZXN1bHRzICYmIHJlc3VsdHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0c1sxXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG4vKiogVmFsaWRhdGVzIHRoZSBwcm92aWRlZCBhcmd1bWVudCBpcyBkZWZpbmVkLiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZURlZmluZWQoZnVuY3Rpb25OYW1lLCBwb3NpdGlvbiwgYXJndW1lbnQpIHtcclxuICAgIGlmIChhcmd1bWVudCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgcmVxdWlyZXMgYSB2YWxpZCBcIiArIG9yZGluYWwocG9zaXRpb24pICsgXCIgXCIgK1xyXG4gICAgICAgICAgICBcImFyZ3VtZW50LCBidXQgaXQgd2FzIHVuZGVmaW5lZC5cIik7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGUgcHJvdmlkZWQgcG9zaXRpb25hbCBhcmd1bWVudCBpcyBhbiBvYmplY3QsIGFuZCBpdHMga2V5cyBhbmRcclxuICogdmFsdWVzIG1hdGNoIHRoZSBleHBlY3RlZCBrZXlzIGFuZCB0eXBlcyBwcm92aWRlZCBpbiBvcHRpb25UeXBlcy5cclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlT3B0aW9uTmFtZXMoZnVuY3Rpb25OYW1lLCBvcHRpb25zLCBvcHRpb25OYW1lcykge1xyXG4gICAgZm9yRWFjaChvcHRpb25zLCBmdW5jdGlvbiAoa2V5LCBfKSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbk5hbWVzLmluZGV4T2Yoa2V5KSA8IDApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJVbmtub3duIG9wdGlvbiAnXCIgKyBrZXkgKyBcIicgcGFzc2VkIHRvIGZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKS4gXCIgK1xyXG4gICAgICAgICAgICAgICAgJ0F2YWlsYWJsZSBvcHRpb25zOiAnICtcclxuICAgICAgICAgICAgICAgIG9wdGlvbk5hbWVzLmpvaW4oJywgJykpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgbWV0aG9kIHRvIHRocm93IGFuIGVycm9yIHRoYXQgdGhlIHByb3ZpZGVkIGFyZ3VtZW50IGRpZCBub3QgcGFzc1xyXG4gKiBhbiBpbnN0YW5jZW9mIGNoZWNrLlxyXG4gKi9cclxuZnVuY3Rpb24gaW52YWxpZENsYXNzRXJyb3IoZnVuY3Rpb25OYW1lLCB0eXBlLCBwb3NpdGlvbiwgYXJndW1lbnQpIHtcclxuICAgIHZhciBkZXNjcmlwdGlvbiA9IHZhbHVlRGVzY3JpcHRpb24oYXJndW1lbnQpO1xyXG4gICAgcmV0dXJuIG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIHJlcXVpcmVzIGl0cyBcIiArIG9yZGluYWwocG9zaXRpb24pICsgXCIgXCIgK1xyXG4gICAgICAgIChcImFyZ3VtZW50IHRvIGJlIGEgXCIgKyB0eXBlICsgXCIsIGJ1dCBpdCB3YXM6IFwiICsgZGVzY3JpcHRpb24pKTtcclxufVxyXG4vKiogQ29udmVydHMgYSBudW1iZXIgdG8gaXRzIGVuZ2xpc2ggd29yZCByZXByZXNlbnRhdGlvbiAqL1xyXG5mdW5jdGlvbiBvcmRpbmFsKG51bSkge1xyXG4gICAgc3dpdGNoIChudW0pIHtcclxuICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgIHJldHVybiAnZmlyc3QnO1xyXG4gICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgcmV0dXJuICdzZWNvbmQnO1xyXG4gICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgcmV0dXJuICd0aGlyZCc7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIG51bSArICd0aCc7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEZvcm1hdHMgdGhlIGdpdmVuIHdvcmQgYXMgcGx1cmFsIGNvbmRpdGlvbmFsbHkgZ2l2ZW4gdGhlIHByZWNlZGluZyBudW1iZXIuXHJcbiAqL1xyXG5mdW5jdGlvbiBmb3JtYXRQbHVyYWwobnVtLCBzdHIpIHtcclxuICAgIHJldHVybiBudW0gKyBcIiBcIiArIHN0ciArIChudW0gPT09IDEgPyAnJyA6ICdzJyk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjbGFzcy1hcy1uYW1lc3BhY2VcclxudmFyIEF1dG9JZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEF1dG9JZCgpIHtcclxuICAgIH1cclxuICAgIEF1dG9JZC5uZXdJZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBBbHBoYW51bWVyaWMgY2hhcmFjdGVyc1xyXG4gICAgICAgIHZhciBjaGFycyA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSc7XHJcbiAgICAgICAgdmFyIGF1dG9JZCA9ICcnO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjA7IGkrKykge1xyXG4gICAgICAgICAgICBhdXRvSWQgKz0gY2hhcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJzLmxlbmd0aCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhc3NlcnQoYXV0b0lkLmxlbmd0aCA9PT0gMjAsICdJbnZhbGlkIGF1dG8gSUQ6ICcgKyBhdXRvSWQpO1xyXG4gICAgICAgIHJldHVybiBhdXRvSWQ7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEF1dG9JZDtcclxufSgpKTtcclxuZnVuY3Rpb24gcHJpbWl0aXZlQ29tcGFyYXRvcihsZWZ0LCByaWdodCkge1xyXG4gICAgaWYgKGxlZnQgPCByaWdodClcclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICBpZiAobGVmdCA+IHJpZ2h0KVxyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgcmV0dXJuIDA7XHJcbn1cclxuLyoqIEhlbHBlciB0byBjb21wYXJlIG51bGxhYmxlIChvciB1bmRlZmluZWQtYWJsZSkgb2JqZWN0cyB1c2luZyBpc0VxdWFsKCkuICovXHJcbmZ1bmN0aW9uIGVxdWFscyhsZWZ0LCByaWdodCkge1xyXG4gICAgaWYgKGxlZnQgIT09IG51bGwgJiYgbGVmdCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuICEhKHJpZ2h0ICYmIGxlZnQuaXNFcXVhbChyaWdodCkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gSEFDSzogRXhwbGljaXRseSBjYXN0IHNpbmNlIFR5cGVTY3JpcHQncyB0eXBlIG5hcnJvd2luZyBhcHBhcmVudGx5IGlzbid0XHJcbiAgICAgICAgLy8gc21hcnQgZW5vdWdoLlxyXG4gICAgICAgIHJldHVybiBsZWZ0ID09PSByaWdodDtcclxuICAgIH1cclxufVxyXG4vKiogSGVscGVyIHRvIGNvbXBhcmUgYXJyYXlzIHVzaW5nIGlzRXF1YWwoKS4gKi9cclxuZnVuY3Rpb24gYXJyYXlFcXVhbHMobGVmdCwgcmlnaHQpIHtcclxuICAgIGlmIChsZWZ0Lmxlbmd0aCAhPT0gcmlnaHQubGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZWZ0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKCFsZWZ0W2ldLmlzRXF1YWwocmlnaHRbaV0pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyB0aGUgaW1tZWRpYXRlIGxleGljb2dyYXBoaWNhbGx5LWZvbGxvd2luZyBzdHJpbmcuIFRoaXMgaXMgdXNlZnVsIHRvXHJcbiAqIGNvbnN0cnVjdCBhbiBpbmNsdXNpdmUgcmFuZ2UgZm9yIGluZGV4ZWRkYiBpdGVyYXRvcnMuXHJcbiAqL1xyXG5mdW5jdGlvbiBpbW1lZGlhdGVTdWNjZXNzb3Iocykge1xyXG4gICAgLy8gUmV0dXJuIHRoZSBpbnB1dCBzdHJpbmcsIHdpdGggYW4gYWRkaXRpb25hbCBOVUwgYnl0ZSBhcHBlbmRlZC5cclxuICAgIHJldHVybiBzICsgJ1xcMCc7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKiBIZWxwZXIgZnVuY3Rpb24gdG8gYXNzZXJ0IFVpbnQ4QXJyYXkgaXMgYXZhaWxhYmxlIGF0IHJ1bnRpbWUuICovXHJcbmZ1bmN0aW9uIGFzc2VydFVpbnQ4QXJyYXlBdmFpbGFibGUoKSB7XHJcbiAgICBpZiAodHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5JTVBMRU1FTlRFRCwgJ1VpbnQ4QXJyYXlzIGFyZSBub3QgYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQuJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqIEhlbHBlciBmdW5jdGlvbiB0byBhc3NlcnQgQmFzZTY0IGZ1bmN0aW9ucyBhcmUgYXZhaWxhYmxlIGF0IHJ1bnRpbWUuICovXHJcbmZ1bmN0aW9uIGFzc2VydEJhc2U2NEF2YWlsYWJsZSgpIHtcclxuICAgIGlmICghUGxhdGZvcm1TdXBwb3J0LmdldFBsYXRmb3JtKCkuYmFzZTY0QXZhaWxhYmxlKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5JTVBMRU1FTlRFRCwgJ0Jsb2JzIGFyZSB1bmF2YWlsYWJsZSBpbiBGaXJlc3RvcmUgaW4gdGhpcyBlbnZpcm9ubWVudC4nKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogSW1tdXRhYmxlIGNsYXNzIGhvbGRpbmcgYSBibG9iIChiaW5hcnkgZGF0YSkuXHJcbiAqIFRoaXMgY2xhc3MgaXMgZGlyZWN0bHkgZXhwb3NlZCBpbiB0aGUgcHVibGljIEFQSS5cclxuICpcclxuICogTm90ZSB0aGF0IHdoaWxlIHlvdSBjYW4ndCBoaWRlIHRoZSBjb25zdHJ1Y3RvciBpbiBKYXZhU2NyaXB0IGNvZGUsIHdlIGFyZVxyXG4gKiB1c2luZyB0aGUgaGFjayBhYm92ZSB0byBtYWtlIHN1cmUgbm8tb25lIG91dHNpZGUgdGhpcyBtb2R1bGUgY2FuIGNhbGwgaXQuXHJcbiAqL1xyXG52YXIgQmxvYiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJsb2IoYmluYXJ5U3RyaW5nKSB7XHJcbiAgICAgICAgYXNzZXJ0QmFzZTY0QXZhaWxhYmxlKCk7XHJcbiAgICAgICAgdGhpcy5fYmluYXJ5U3RyaW5nID0gYmluYXJ5U3RyaW5nO1xyXG4gICAgfVxyXG4gICAgQmxvYi5mcm9tQmFzZTY0U3RyaW5nID0gZnVuY3Rpb24gKGJhc2U2NCkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0Jsb2IuZnJvbUJhc2U2NFN0cmluZycsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdCbG9iLmZyb21CYXNlNjRTdHJpbmcnLCAnc3RyaW5nJywgMSwgYmFzZTY0KTtcclxuICAgICAgICBhc3NlcnRCYXNlNjRBdmFpbGFibGUoKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2YXIgYmluYXJ5U3RyaW5nID0gUGxhdGZvcm1TdXBwb3J0LmdldFBsYXRmb3JtKCkuYXRvYihiYXNlNjQpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEJsb2IoYmluYXJ5U3RyaW5nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ZhaWxlZCB0byBjb25zdHJ1Y3QgQmxvYiBmcm9tIEJhc2U2NCBzdHJpbmc6ICcgKyBlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQmxvYi5mcm9tVWludDhBcnJheSA9IGZ1bmN0aW9uIChhcnJheSkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0Jsb2IuZnJvbVVpbnQ4QXJyYXknLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIGFzc2VydFVpbnQ4QXJyYXlBdmFpbGFibGUoKTtcclxuICAgICAgICBpZiAoIShhcnJheSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludmFsaWRDbGFzc0Vycm9yKCdCbG9iLmZyb21VaW50OEFycmF5JywgJ1VpbnQ4QXJyYXknLCAxLCBhcnJheSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFdlIGNhbid0IGNhbGwgYXJyYXkubWFwIGRpcmVjdGx5IGJlY2F1c2UgaXQgZXhwZWN0cyB0aGUgcmV0dXJuIHR5cGUgdG9cclxuICAgICAgICAvLyBiZSBhIFVpbnQ4QXJyYXksIHdoZXJlYXMgd2UgY2FuIGNvbnZlcnQgaXQgdG8gYSByZWd1bGFyIGFycmF5IGJ5IGludm9raW5nXHJcbiAgICAgICAgLy8gbWFwIG9uIHRoZSBBcnJheSBwcm90b3R5cGUuXHJcbiAgICAgICAgdmFyIGJpbmFyeVN0cmluZyA9IEFycmF5LnByb3RvdHlwZS5tYXBcclxuICAgICAgICAgICAgLmNhbGwoYXJyYXksIGZ1bmN0aW9uIChjaGFyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5qb2luKCcnKTtcclxuICAgICAgICByZXR1cm4gbmV3IEJsb2IoYmluYXJ5U3RyaW5nKTtcclxuICAgIH07XHJcbiAgICBCbG9iLnByb3RvdHlwZS50b0Jhc2U2NCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdCbG9iLnRvQmFzZTY0JywgYXJndW1lbnRzLCAwKTtcclxuICAgICAgICBhc3NlcnRCYXNlNjRBdmFpbGFibGUoKTtcclxuICAgICAgICByZXR1cm4gUGxhdGZvcm1TdXBwb3J0LmdldFBsYXRmb3JtKCkuYnRvYSh0aGlzLl9iaW5hcnlTdHJpbmcpO1xyXG4gICAgfTtcclxuICAgIEJsb2IucHJvdG90eXBlLnRvVWludDhBcnJheSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdCbG9iLnRvVWludDhBcnJheScsIGFyZ3VtZW50cywgMCk7XHJcbiAgICAgICAgYXNzZXJ0VWludDhBcnJheUF2YWlsYWJsZSgpO1xyXG4gICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSh0aGlzLl9iaW5hcnlTdHJpbmcubGVuZ3RoKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2JpbmFyeVN0cmluZy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBidWZmZXJbaV0gPSB0aGlzLl9iaW5hcnlTdHJpbmcuY2hhckNvZGVBdChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJ1ZmZlcjtcclxuICAgIH07XHJcbiAgICBCbG9iLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gJ0Jsb2IoYmFzZTY0OiAnICsgdGhpcy50b0Jhc2U2NCgpICsgJyknO1xyXG4gICAgfTtcclxuICAgIEJsb2IucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYmluYXJ5U3RyaW5nID09PSBvdGhlci5fYmluYXJ5U3RyaW5nO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWN0dWFsbHkgcHJpdmF0ZSB0byBKUyBjb25zdW1lcnMgb2Ygb3VyIEFQSSwgc28gdGhpcyBmdW5jdGlvbiBpcyBwcmVmaXhlZFxyXG4gICAgICogd2l0aCBhbiB1bmRlcnNjb3JlLlxyXG4gICAgICovXHJcbiAgICBCbG9iLnByb3RvdHlwZS5fY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5fYmluYXJ5U3RyaW5nLCBvdGhlci5fYmluYXJ5U3RyaW5nKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQmxvYjtcclxufSgpKTtcclxuLy8gUHVibGljIGluc3RhbmNlIHRoYXQgZGlzYWxsb3dzIGNvbnN0cnVjdGlvbiBhdCBydW50aW1lLiBUaGlzIGNvbnN0cnVjdG9yIGlzXHJcbi8vIHVzZWQgd2hlbiBleHBvcnRpbmcgQmxvYiBvbiBmaXJlYmFzZS5maXJlc3RvcmUuQmxvYiBhbmQgd2lsbCBiZSBjYWxsZWQgQmxvYlxyXG4vLyBwdWJsaWNseS4gSW50ZXJuYWxseSB3ZSBzdGlsbCB1c2UgQmxvYiB3aGljaCBoYXMgYSB0eXBlIGNoZWNrZWQgcHJpdmF0ZVxyXG4vLyBjb25zdHJ1Y3Rvci4gTm90ZSB0aGF0IEJsb2IgYW5kIFB1YmxpY0Jsb2IgY2FuIGJlIHVzZWQgaW50ZXJjaGFuZ2VhYmx5IGluXHJcbi8vIGluc3RhbmNlb2YgY2hlY2tzLlxyXG4vLyBGb3Igb3VyIGludGVybmFsIFR5cGVTY3JpcHQgY29kZSBQdWJsaWNCbG9iIGRvZXNuJ3QgZXhpc3QgYXMgYSB0eXBlLCBhbmQgc29cclxuLy8gd2UgbmVlZCB0byB1c2UgQmxvYiBhcyB0eXBlIGFuZCBleHBvcnQgaXQgdG9vLlxyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dmFyaWFibGUtbmFtZSBXZSdyZSB0cmVhdGluZyB0aGlzIGFzIGEgY2xhc3MgbmFtZS5cclxudmFyIFB1YmxpY0Jsb2IgPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKEJsb2IsICdVc2UgQmxvYi5mcm9tVWludDhBcnJheSgpIG9yIEJsb2IuZnJvbUJhc2U2NFN0cmluZygpIGluc3RlYWQuJyk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogSW1tdXRhYmxlIGNsYXNzIHJlcHJlc2VudGluZyBhIGdlbyBwb2ludCBhcyBsYXRpdHVkZS1sb25naXR1ZGUgcGFpci5cclxuICogVGhpcyBjbGFzcyBpcyBkaXJlY3RseSBleHBvc2VkIGluIHRoZSBwdWJsaWMgQVBJLCBpbmNsdWRpbmcgaXRzIGNvbnN0cnVjdG9yLlxyXG4gKi9cclxudmFyIEdlb1BvaW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gR2VvUG9pbnQobGF0aXR1ZGUsIGxvbmdpdHVkZSkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0dlb1BvaW50JywgYXJndW1lbnRzLCAyKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0dlb1BvaW50JywgJ251bWJlcicsIDEsIGxhdGl0dWRlKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0dlb1BvaW50JywgJ251bWJlcicsIDIsIGxvbmdpdHVkZSk7XHJcbiAgICAgICAgaWYgKCFpc0Zpbml0ZShsYXRpdHVkZSkgfHwgbGF0aXR1ZGUgPCAtOTAgfHwgbGF0aXR1ZGUgPiA5MCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnTGF0aXR1ZGUgbXVzdCBiZSBhIG51bWJlciBiZXR3ZWVuIC05MCBhbmQgOTAsIGJ1dCB3YXM6ICcgKyBsYXRpdHVkZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaXNGaW5pdGUobG9uZ2l0dWRlKSB8fCBsb25naXR1ZGUgPCAtMTgwIHx8IGxvbmdpdHVkZSA+IDE4MCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnTG9uZ2l0dWRlIG11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAtMTgwIGFuZCAxODAsIGJ1dCB3YXM6ICcgKyBsb25naXR1ZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9sYXQgPSBsYXRpdHVkZTtcclxuICAgICAgICB0aGlzLl9sb25nID0gbG9uZ2l0dWRlO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEdlb1BvaW50LnByb3RvdHlwZSwgXCJsYXRpdHVkZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJucyB0aGUgbGF0aXR1ZGUgb2YgdGhpcyBnZW8gcG9pbnQsIGEgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MC5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xhdDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHZW9Qb2ludC5wcm90b3R5cGUsIFwibG9uZ2l0dWRlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSBsb25naXR1ZGUgb2YgdGhpcyBnZW8gcG9pbnQsIGEgbnVtYmVyIGJldHdlZW4gLTE4MCBhbmQgMTgwLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9uZztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEdlb1BvaW50LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xhdCA9PT0gb3RoZXIuX2xhdCAmJiB0aGlzLl9sb25nID09PSBvdGhlci5fbG9uZztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFjdHVhbGx5IHByaXZhdGUgdG8gSlMgY29uc3VtZXJzIG9mIG91ciBBUEksIHNvIHRoaXMgZnVuY3Rpb24gaXMgcHJlZml4ZWRcclxuICAgICAqIHdpdGggYW4gdW5kZXJzY29yZS5cclxuICAgICAqL1xyXG4gICAgR2VvUG9pbnQucHJvdG90eXBlLl9jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5fbGF0LCBvdGhlci5fbGF0KSB8fFxyXG4gICAgICAgICAgICBwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMuX2xvbmcsIG90aGVyLl9sb25nKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEdlb1BvaW50O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIFRpbWVzdGFtcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRpbWVzdGFtcChzZWNvbmRzLCBuYW5vc2Vjb25kcykge1xyXG4gICAgICAgIHRoaXMuc2Vjb25kcyA9IHNlY29uZHM7XHJcbiAgICAgICAgdGhpcy5uYW5vc2Vjb25kcyA9IG5hbm9zZWNvbmRzO1xyXG4gICAgICAgIGlmIChuYW5vc2Vjb25kcyA8IDApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1RpbWVzdGFtcCBuYW5vc2Vjb25kcyBvdXQgb2YgcmFuZ2U6ICcgKyBuYW5vc2Vjb25kcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuYW5vc2Vjb25kcyA+PSAxZTkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1RpbWVzdGFtcCBuYW5vc2Vjb25kcyBvdXQgb2YgcmFuZ2U6ICcgKyBuYW5vc2Vjb25kcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE1pZG5pZ2h0IGF0IHRoZSBiZWdpbm5pbmcgb2YgMS8xLzEgaXMgdGhlIGVhcmxpZXN0IEZpcmVzdG9yZSBzdXBwb3J0cy5cclxuICAgICAgICBpZiAoc2Vjb25kcyA8IC02MjEzNTU5NjgwMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnVGltZXN0YW1wIHNlY29uZHMgb3V0IG9mIHJhbmdlOiAnICsgc2Vjb25kcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRoaXMgd2lsbCBicmVhayBpbiB0aGUgeWVhciAxMCwwMDAuXHJcbiAgICAgICAgaWYgKHNlY29uZHMgPj0gMjUzNDAyMzAwODAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdUaW1lc3RhbXAgc2Vjb25kcyBvdXQgb2YgcmFuZ2U6ICcgKyBzZWNvbmRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBUaW1lc3RhbXAubm93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBUaW1lc3RhbXAuZnJvbU1pbGxpcyhEYXRlLm5vdygpKTtcclxuICAgIH07XHJcbiAgICBUaW1lc3RhbXAuZnJvbURhdGUgPSBmdW5jdGlvbiAoZGF0ZSkge1xyXG4gICAgICAgIHJldHVybiBUaW1lc3RhbXAuZnJvbU1pbGxpcyhkYXRlLmdldFRpbWUoKSk7XHJcbiAgICB9O1xyXG4gICAgVGltZXN0YW1wLmZyb21NaWxsaXMgPSBmdW5jdGlvbiAobWlsbGlzZWNvbmRzKSB7XHJcbiAgICAgICAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKG1pbGxpc2Vjb25kcyAvIDEwMDApO1xyXG4gICAgICAgIHZhciBuYW5vcyA9IChtaWxsaXNlY29uZHMgLSBzZWNvbmRzICogMTAwMCkgKiAxZTY7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBUaW1lc3RhbXAoc2Vjb25kcywgbmFub3MpO1xyXG4gICAgfTtcclxuICAgIFRpbWVzdGFtcC5wcm90b3R5cGUudG9EYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSh0aGlzLnRvTWlsbGlzKCkpO1xyXG4gICAgfTtcclxuICAgIFRpbWVzdGFtcC5wcm90b3R5cGUudG9NaWxsaXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2Vjb25kcyAqIDEwMDAgKyB0aGlzLm5hbm9zZWNvbmRzIC8gMWU2O1xyXG4gICAgfTtcclxuICAgIFRpbWVzdGFtcC5wcm90b3R5cGUuX2NvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICh0aGlzLnNlY29uZHMgPT09IG90aGVyLnNlY29uZHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5uYW5vc2Vjb25kcywgb3RoZXIubmFub3NlY29uZHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLnNlY29uZHMsIG90aGVyLnNlY29uZHMpO1xyXG4gICAgfTtcclxuICAgIFRpbWVzdGFtcC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIuc2Vjb25kcyA9PT0gdGhpcy5zZWNvbmRzICYmIG90aGVyLm5hbm9zZWNvbmRzID09PSB0aGlzLm5hbm9zZWNvbmRzKTtcclxuICAgIH07XHJcbiAgICBUaW1lc3RhbXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAoJ1RpbWVzdGFtcChzZWNvbmRzPScgK1xyXG4gICAgICAgICAgICB0aGlzLnNlY29uZHMgK1xyXG4gICAgICAgICAgICAnLCBuYW5vc2Vjb25kcz0nICtcclxuICAgICAgICAgICAgdGhpcy5uYW5vc2Vjb25kcyArXHJcbiAgICAgICAgICAgICcpJyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRpbWVzdGFtcDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBEYXRhYmFzZUluZm8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgYSBEYXRhYmFzZUluZm8gdXNpbmcgdGhlIHByb3ZpZGVkIGhvc3QsIGRhdGFiYXNlSWQgYW5kXHJcbiAgICAgKiBwZXJzaXN0ZW5jZUtleS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZGF0YWJhc2VJZCBUaGUgZGF0YWJhc2UgdG8gdXNlLlxyXG4gICAgICogQHBhcmFtIHBlcnNpc3RlbmNlS2V5IEEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoaXMgRmlyZXN0b3JlJ3MgbG9jYWxcclxuICAgICAqIHN0b3JhZ2UgKHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCB0aGUgZGF0YWJhc2VJZCkuXHJcbiAgICAgKiBAcGFyYW0gaG9zdCBUaGUgRmlyZXN0b3JlIGJhY2tlbmQgaG9zdCB0byBjb25uZWN0IHRvLlxyXG4gICAgICogQHBhcmFtIHNzbCBXaGV0aGVyIHRvIHVzZSBTU0wgd2hlbiBjb25uZWN0aW5nLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBEYXRhYmFzZUluZm8oZGF0YWJhc2VJZCwgcGVyc2lzdGVuY2VLZXksIGhvc3QsIHNzbCkge1xyXG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IGRhdGFiYXNlSWQ7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IHBlcnNpc3RlbmNlS2V5O1xyXG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XHJcbiAgICAgICAgdGhpcy5zc2wgPSBzc2w7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRGF0YWJhc2VJbmZvO1xyXG59KCkpO1xyXG4vKiogVGhlIGRlZmF1bHQgZGF0YWJhc2UgbmFtZSBmb3IgYSBwcm9qZWN0LiAqL1xyXG52YXIgREVGQVVMVF9EQVRBQkFTRV9OQU1FID0gJyhkZWZhdWx0KSc7XHJcbi8qKiBSZXByZXNlbnRzIHRoZSBkYXRhYmFzZSBJRCBhIEZpcmVzdG9yZSBjbGllbnQgaXMgYXNzb2NpYXRlZCB3aXRoLiAqL1xyXG52YXIgRGF0YWJhc2VJZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERhdGFiYXNlSWQocHJvamVjdElkLCBkYXRhYmFzZSkge1xyXG4gICAgICAgIHRoaXMucHJvamVjdElkID0gcHJvamVjdElkO1xyXG4gICAgICAgIHRoaXMuZGF0YWJhc2UgPSBkYXRhYmFzZSA/IGRhdGFiYXNlIDogREVGQVVMVF9EQVRBQkFTRV9OQU1FO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERhdGFiYXNlSWQucHJvdG90eXBlLCBcImlzRGVmYXVsdERhdGFiYXNlXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YWJhc2UgPT09IERFRkFVTFRfREFUQUJBU0VfTkFNRTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIERhdGFiYXNlSWQucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgRGF0YWJhc2VJZCAmJlxyXG4gICAgICAgICAgICBvdGhlci5wcm9qZWN0SWQgPT09IHRoaXMucHJvamVjdElkICYmXHJcbiAgICAgICAgICAgIG90aGVyLmRhdGFiYXNlID09PSB0aGlzLmRhdGFiYXNlKTtcclxuICAgIH07XHJcbiAgICBEYXRhYmFzZUlkLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5wcm9qZWN0SWQsIG90aGVyLnByb2plY3RJZCkgfHxcclxuICAgICAgICAgICAgcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLmRhdGFiYXNlLCBvdGhlci5kYXRhYmFzZSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEYXRhYmFzZUlkO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIERPQ1VNRU5UX0tFWV9OQU1FID0gJ19fbmFtZV9fJztcclxuLyoqXHJcbiAqIFBhdGggcmVwcmVzZW50cyBhbiBvcmRlcmVkIHNlcXVlbmNlIG9mIHN0cmluZyBzZWdtZW50cy5cclxuICovXHJcbnZhciBQYXRoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGF0aChzZWdtZW50cywgb2Zmc2V0LCBsZW5ndGgpIHtcclxuICAgICAgICB0aGlzLmluaXQoc2VnbWVudHMsIG9mZnNldCwgbGVuZ3RoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQW4gaW5pdGlhbGl6YXRpb24gbWV0aG9kIHRoYXQgY2FuIGJlIGNhbGxlZCBmcm9tIG91dHNpZGUgdGhlIGNvbnN0cnVjdG9yLlxyXG4gICAgICogV2UgbmVlZCB0aGlzIHNvIHRoYXQgd2UgY2FuIGhhdmUgYSBub24tc3RhdGljIGNvbnN0cnVjdCBtZXRob2QgdGhhdCByZXR1cm5zXHJcbiAgICAgKiB0aGUgcG9seW1vcnBoaWMgYHRoaXNgIHR5cGUuXHJcbiAgICAgKi9cclxuICAgIFBhdGgucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoc2VnbWVudHMsIG9mZnNldCwgbGVuZ3RoKSB7XHJcbiAgICAgICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9mZnNldCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG9mZnNldCA+IHNlZ21lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBmYWlsKCdvZmZzZXQgJyArIG9mZnNldCArICcgb3V0IG9mIHJhbmdlICcgKyBzZWdtZW50cy5sZW5ndGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgbGVuZ3RoID0gc2VnbWVudHMubGVuZ3RoIC0gb2Zmc2V0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChsZW5ndGggPiBzZWdtZW50cy5sZW5ndGggLSBvZmZzZXQpIHtcclxuICAgICAgICAgICAgZmFpbCgnbGVuZ3RoICcgKyBsZW5ndGggKyAnIG91dCBvZiByYW5nZSAnICsgKHNlZ21lbnRzLmxlbmd0aCAtIG9mZnNldCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNlZ21lbnRzID0gc2VnbWVudHM7XHJcbiAgICAgICAgdGhpcy5vZmZzZXQgPSBvZmZzZXQ7XHJcbiAgICAgICAgdGhpcy5sZW4gPSBsZW5ndGg7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGluc3RhbmNlIG9mIFBhdGggdXNpbmcgdGhlIHNhbWUgY29uY3JldGUgdHlwZSBhcyBgdGhpc2AuXHJcbiAgICAgKiBXZSBuZWVkIHRoaXMgaW5zdGVhZCBvZiB1c2luZyB0aGUgbm9ybWFsIGNvbnN0cnVjdG9yLCBiZWNhdXNlIHBvbHltb3JwaGljXHJcbiAgICAgKiBgdGhpc2AgZG9lc24ndCB3b3JrIG9uIHN0YXRpYyBtZXRob2RzLlxyXG4gICAgICovXHJcbiAgICBQYXRoLnByb3RvdHlwZS5jb25zdHJ1Y3QgPSBmdW5jdGlvbiAoc2VnbWVudHMsIG9mZnNldCwgbGVuZ3RoKSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSBPYmplY3QuY3JlYXRlKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSk7XHJcbiAgICAgICAgcGF0aC5pbml0KHNlZ21lbnRzLCBvZmZzZXQsIGxlbmd0aCk7XHJcbiAgICAgICAgcmV0dXJuIHBhdGg7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhdGgucHJvdG90eXBlLCBcImxlbmd0aFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxlbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFBhdGgucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gUGF0aC5jb21wYXJhdG9yKHRoaXMsIG90aGVyKSA9PT0gMDtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5jaGlsZCA9IGZ1bmN0aW9uIChuYW1lT3JQYXRoKSB7XHJcbiAgICAgICAgdmFyIHNlZ21lbnRzID0gdGhpcy5zZWdtZW50cy5zbGljZSh0aGlzLm9mZnNldCwgdGhpcy5saW1pdCgpKTtcclxuICAgICAgICBpZiAobmFtZU9yUGF0aCBpbnN0YW5jZW9mIFBhdGgpIHtcclxuICAgICAgICAgICAgbmFtZU9yUGF0aC5mb3JFYWNoKGZ1bmN0aW9uIChzZWdtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBzZWdtZW50cy5wdXNoKHNlZ21lbnQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIG5hbWVPclBhdGggPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHNlZ21lbnRzLnB1c2gobmFtZU9yUGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmYWlsKCdVbmtub3duIHBhcmFtZXRlciB0eXBlIGZvciBQYXRoLmNoaWxkKCk6ICcgKyBuYW1lT3JQYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0KHNlZ21lbnRzKTtcclxuICAgIH07XHJcbiAgICAvKiogVGhlIGluZGV4IG9mIG9uZSBwYXN0IHRoZSBsYXN0IHNlZ21lbnQgb2YgdGhlIHBhdGguICovXHJcbiAgICBQYXRoLnByb3RvdHlwZS5saW1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vZmZzZXQgKyB0aGlzLmxlbmd0aDtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5wb3BGaXJzdCA9IGZ1bmN0aW9uIChzaXplKSB7XHJcbiAgICAgICAgc2l6ZSA9IHNpemUgPT09IHVuZGVmaW5lZCA/IDEgOiBzaXplO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmxlbmd0aCA+PSBzaXplLCBcIkNhbid0IGNhbGwgcG9wRmlyc3QoKSB3aXRoIGxlc3Mgc2VnbWVudHNcIik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0KHRoaXMuc2VnbWVudHMsIHRoaXMub2Zmc2V0ICsgc2l6ZSwgdGhpcy5sZW5ndGggLSBzaXplKTtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5wb3BMYXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5pc0VtcHR5KCksIFwiQ2FuJ3QgY2FsbCBwb3BMYXN0KCkgb24gZW1wdHkgcGF0aFwiKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3QodGhpcy5zZWdtZW50cywgdGhpcy5vZmZzZXQsIHRoaXMubGVuZ3RoIC0gMSk7XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUuZmlyc3RTZWdtZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5pc0VtcHR5KCksIFwiQ2FuJ3QgY2FsbCBmaXJzdFNlZ21lbnQoKSBvbiBlbXB0eSBwYXRoXCIpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzW3RoaXMub2Zmc2V0XTtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5sYXN0U2VnbWVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMuaXNFbXB0eSgpLCBcIkNhbid0IGNhbGwgbGFzdFNlZ21lbnQoKSBvbiBlbXB0eSBwYXRoXCIpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzW3RoaXMubGltaXQoKSAtIDFdO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgIGFzc2VydChpbmRleCA8IHRoaXMubGVuZ3RoLCAnSW5kZXggb3V0IG9mIHJhbmdlJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHNbdGhpcy5vZmZzZXQgKyBpbmRleF07XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sZW5ndGggPT09IDA7XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUuaXNQcmVmaXhPZiA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlci5sZW5ndGggPCB0aGlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5nZXQoaSkgIT09IG90aGVyLmdldChpKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLmlzSW1tZWRpYXRlUGFyZW50T2YgPSBmdW5jdGlvbiAocG90ZW50aWFsQ2hpbGQpIHtcclxuICAgICAgICBpZiAodGhpcy5sZW5ndGggKyAxICE9PSBwb3RlbnRpYWxDaGlsZC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0KGkpICE9PSBwb3RlbnRpYWxDaGlsZC5nZXQoaSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMub2Zmc2V0LCBlbmQgPSB0aGlzLmxpbWl0KCk7IGkgPCBlbmQ7IGkrKykge1xyXG4gICAgICAgICAgICBmbih0aGlzLnNlZ21lbnRzW2ldKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUudG9BcnJheSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50cy5zbGljZSh0aGlzLm9mZnNldCwgdGhpcy5saW1pdCgpKTtcclxuICAgIH07XHJcbiAgICBQYXRoLmNvbXBhcmF0b3IgPSBmdW5jdGlvbiAocDEsIHAyKSB7XHJcbiAgICAgICAgdmFyIGxlbiA9IE1hdGgubWluKHAxLmxlbmd0aCwgcDIubGVuZ3RoKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBsZWZ0ID0gcDEuZ2V0KGkpO1xyXG4gICAgICAgICAgICB2YXIgcmlnaHQgPSBwMi5nZXQoaSk7XHJcbiAgICAgICAgICAgIGlmIChsZWZ0IDwgcmlnaHQpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgIGlmIChsZWZ0ID4gcmlnaHQpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHAxLmxlbmd0aCA8IHAyLmxlbmd0aClcclxuICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgIGlmIChwMS5sZW5ndGggPiBwMi5sZW5ndGgpXHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQYXRoO1xyXG59KCkpO1xyXG4vKipcclxuICogQSBzbGFzaC1zZXBhcmF0ZWQgcGF0aCBmb3IgbmF2aWdhdGluZyByZXNvdXJjZXMgKGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMpXHJcbiAqIHdpdGhpbiBGaXJlc3RvcmUuXHJcbiAqL1xyXG52YXIgUmVzb3VyY2VQYXRoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUmVzb3VyY2VQYXRoLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gUmVzb3VyY2VQYXRoKCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIFJlc291cmNlUGF0aC5wcm90b3R5cGUuY2Fub25pY2FsU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIE5PVEU6IFRoZSBjbGllbnQgaXMgaWdub3JhbnQgb2YgYW55IHBhdGggc2VnbWVudHMgY29udGFpbmluZyBlc2NhcGVcclxuICAgICAgICAvLyBzZXF1ZW5jZXMgKGUuZy4gX19pZDEyM19fKSBhbmQganVzdCBwYXNzZXMgdGhlbSB0aHJvdWdoIHJhdyAodGhleSBleGlzdFxyXG4gICAgICAgIC8vIGZvciBsZWdhY3kgcmVhc29ucyBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGZyZXF1ZW50bHkpLlxyXG4gICAgICAgIHJldHVybiB0aGlzLnRvQXJyYXkoKS5qb2luKCcvJyk7XHJcbiAgICB9O1xyXG4gICAgUmVzb3VyY2VQYXRoLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jYW5vbmljYWxTdHJpbmcoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSByZXNvdXJjZSBwYXRoIGZyb20gdGhlIGdpdmVuIHNsYXNoLWRlbGltaXRlZCBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIFJlc291cmNlUGF0aC5mcm9tU3RyaW5nID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICAvLyBOT1RFOiBUaGUgY2xpZW50IGlzIGlnbm9yYW50IG9mIGFueSBwYXRoIHNlZ21lbnRzIGNvbnRhaW5pbmcgZXNjYXBlXHJcbiAgICAgICAgLy8gc2VxdWVuY2VzIChlLmcuIF9faWQxMjNfXykgYW5kIGp1c3QgcGFzc2VzIHRoZW0gdGhyb3VnaCByYXcgKHRoZXkgZXhpc3RcclxuICAgICAgICAvLyBmb3IgbGVnYWN5IHJlYXNvbnMgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBmcmVxdWVudGx5KS5cclxuICAgICAgICBpZiAocGF0aC5pbmRleE9mKCcvLycpID49IDApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHBhdGggKFwiICsgcGF0aCArIFwiKS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiAvLyBpbiB0aGVtLlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gV2UgbWF5IHN0aWxsIGhhdmUgYW4gZW1wdHkgc2VnbWVudCBhdCB0aGUgYmVnaW5uaW5nIG9yIGVuZCBpZiB0aGV5IGhhZCBhXHJcbiAgICAgICAgLy8gbGVhZGluZyBvciB0cmFpbGluZyBzbGFzaCAod2hpY2ggd2UgYWxsb3cpLlxyXG4gICAgICAgIHZhciBzZWdtZW50cyA9IHBhdGguc3BsaXQoJy8nKS5maWx0ZXIoZnVuY3Rpb24gKHNlZ21lbnQpIHsgcmV0dXJuIHNlZ21lbnQubGVuZ3RoID4gMDsgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZXNvdXJjZVBhdGgoc2VnbWVudHMpO1xyXG4gICAgfTtcclxuICAgIFJlc291cmNlUGF0aC5FTVBUWV9QQVRIID0gbmV3IFJlc291cmNlUGF0aChbXSk7XHJcbiAgICByZXR1cm4gUmVzb3VyY2VQYXRoO1xyXG59KFBhdGgpKTtcclxudmFyIGlkZW50aWZpZXJSZWdFeHAgPSAvXltfYS16QS1aXVtfYS16QS1aMC05XSokLztcclxuLyoqIEEgZG90LXNlcGFyYXRlZCBwYXRoIGZvciBuYXZpZ2F0aW5nIHN1Yi1vYmplY3RzIHdpdGhpbiBhIGRvY3VtZW50LiAqL1xyXG52YXIgRmllbGRQYXRoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRmllbGRQYXRoLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gRmllbGRQYXRoKCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBzdHJpbmcgY291bGQgYmUgdXNlZCBhcyBhIHNlZ21lbnQgaW4gYSBmaWVsZCBwYXRoXHJcbiAgICAgKiB3aXRob3V0IGVzY2FwaW5nLlxyXG4gICAgICovXHJcbiAgICBGaWVsZFBhdGguaXNWYWxpZElkZW50aWZpZXIgPSBmdW5jdGlvbiAoc2VnbWVudCkge1xyXG4gICAgICAgIHJldHVybiBpZGVudGlmaWVyUmVnRXhwLnRlc3Qoc2VnbWVudCk7XHJcbiAgICB9O1xyXG4gICAgRmllbGRQYXRoLnByb3RvdHlwZS5jYW5vbmljYWxTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpXHJcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHN0cikge1xyXG4gICAgICAgICAgICBzdHIgPSBzdHIucmVwbGFjZSgnXFxcXCcsICdcXFxcXFxcXCcpLnJlcGxhY2UoJ2AnLCAnXFxcXGAnKTtcclxuICAgICAgICAgICAgaWYgKCFGaWVsZFBhdGguaXNWYWxpZElkZW50aWZpZXIoc3RyKSkge1xyXG4gICAgICAgICAgICAgICAgc3RyID0gJ2AnICsgc3RyICsgJ2AnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBzdHI7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmpvaW4oJy4nKTtcclxuICAgIH07XHJcbiAgICBGaWVsZFBhdGgucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNhbm9uaWNhbFN0cmluZygpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgZmllbGQgcmVmZXJlbmNlcyB0aGUga2V5IG9mIGEgZG9jdW1lbnQuXHJcbiAgICAgKi9cclxuICAgIEZpZWxkUGF0aC5wcm90b3R5cGUuaXNLZXlGaWVsZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sZW5ndGggPT09IDEgJiYgdGhpcy5nZXQoMCkgPT09IERPQ1VNRU5UX0tFWV9OQU1FO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGZpZWxkIGRlc2lnbmF0aW5nIHRoZSBrZXkgb2YgYSBkb2N1bWVudC5cclxuICAgICAqL1xyXG4gICAgRmllbGRQYXRoLmtleUZpZWxkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgRmllbGRQYXRoKFtET0NVTUVOVF9LRVlfTkFNRV0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGEgZmllbGQgc3RyaW5nIGZyb20gdGhlIGdpdmVuIHNlcnZlci1mb3JtYXR0ZWQgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIC0gU3BsaXR0aW5nIHRoZSBlbXB0eSBzdHJpbmcgaXMgbm90IGFsbG93ZWQgKGZvciBub3cgYXQgbGVhc3QpLlxyXG4gICAgICogLSBFbXB0eSBzZWdtZW50cyB3aXRoaW4gdGhlIHN0cmluZyAoZS5nLiBpZiB0aGVyZSBhcmUgdHdvIGNvbnNlY3V0aXZlXHJcbiAgICAgKiAgIHNlcGFyYXRvcnMpIGFyZSBub3QgYWxsb3dlZC5cclxuICAgICAqXHJcbiAgICAgKiBUT0RPKGIvMzcyNDQxNTcpOiB3ZSBzaG91bGQgbWFrZSB0aGlzIG1vcmUgc3RyaWN0LiBSaWdodCBub3csIGl0IGFsbG93c1xyXG4gICAgICogbm9uLWlkZW50aWZpZXIgcGF0aCBjb21wb25lbnRzLCBldmVuIGlmIHRoZXkgYXJlbid0IGVzY2FwZWQuXHJcbiAgICAgKi9cclxuICAgIEZpZWxkUGF0aC5mcm9tU2VydmVyRm9ybWF0ID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICB2YXIgc2VnbWVudHMgPSBbXTtcclxuICAgICAgICB2YXIgY3VycmVudCA9ICcnO1xyXG4gICAgICAgIHZhciBpID0gMDtcclxuICAgICAgICB2YXIgYWRkQ3VycmVudFNlZ21lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIGZpZWxkIHBhdGggKFwiICsgcGF0aCArIFwiKS4gUGF0aHMgbXVzdCBub3QgYmUgZW1wdHksIGJlZ2luIFwiICtcclxuICAgICAgICAgICAgICAgICAgICBcIndpdGggJy4nLCBlbmQgd2l0aCAnLicsIG9yIGNvbnRhaW4gJy4uJ1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWdtZW50cy5wdXNoKGN1cnJlbnQpO1xyXG4gICAgICAgICAgICBjdXJyZW50ID0gJyc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgaW5CYWNrdGlja3MgPSBmYWxzZTtcclxuICAgICAgICB3aGlsZSAoaSA8IHBhdGgubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gcGF0aFtpXTtcclxuICAgICAgICAgICAgaWYgKGMgPT09ICdcXFxcJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgKyAxID09PSBwYXRoLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdQYXRoIGhhcyB0cmFpbGluZyBlc2NhcGUgY2hhcmFjdGVyOiAnICsgcGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dCA9IHBhdGhbaSArIDFdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCEobmV4dCA9PT0gJ1xcXFwnIHx8IG5leHQgPT09ICcuJyB8fCBuZXh0ID09PSAnYCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1BhdGggaGFzIGludmFsaWQgZXNjYXBlIHNlcXVlbmNlOiAnICsgcGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ICs9IG5leHQ7XHJcbiAgICAgICAgICAgICAgICBpICs9IDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoYyA9PT0gJ2AnKSB7XHJcbiAgICAgICAgICAgICAgICBpbkJhY2t0aWNrcyA9ICFpbkJhY2t0aWNrcztcclxuICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjID09PSAnLicgJiYgIWluQmFja3RpY2tzKSB7XHJcbiAgICAgICAgICAgICAgICBhZGRDdXJyZW50U2VnbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudCArPSBjO1xyXG4gICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFkZEN1cnJlbnRTZWdtZW50KCk7XHJcbiAgICAgICAgaWYgKGluQmFja3RpY2tzKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdVbnRlcm1pbmF0ZWQgYCBpbiBwYXRoOiAnICsgcGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgRmllbGRQYXRoKHNlZ21lbnRzKTtcclxuICAgIH07XHJcbiAgICBGaWVsZFBhdGguRU1QVFlfUEFUSCA9IG5ldyBGaWVsZFBhdGgoW10pO1xyXG4gICAgcmV0dXJuIEZpZWxkUGF0aDtcclxufShQYXRoKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRG9jdW1lbnRLZXkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEb2N1bWVudEtleShwYXRoKSB7XHJcbiAgICAgICAgdGhpcy5wYXRoID0gcGF0aDtcclxuICAgICAgICBhc3NlcnQoRG9jdW1lbnRLZXkuaXNEb2N1bWVudEtleShwYXRoKSwgJ0ludmFsaWQgRG9jdW1lbnRLZXkgd2l0aCBhbiBvZGQgbnVtYmVyIG9mIHNlZ21lbnRzOiAnICtcclxuICAgICAgICAgICAgcGF0aC50b0FycmF5KCkuam9pbignLycpKTtcclxuICAgIH1cclxuICAgIERvY3VtZW50S2V5LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciAhPT0gbnVsbCAmJiBSZXNvdXJjZVBhdGguY29tcGFyYXRvcih0aGlzLnBhdGgsIG90aGVyLnBhdGgpID09PSAwKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEtleS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aC50b1N0cmluZygpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50S2V5LmNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoazEsIGsyKSB7XHJcbiAgICAgICAgcmV0dXJuIFJlc291cmNlUGF0aC5jb21wYXJhdG9yKGsxLnBhdGgsIGsyLnBhdGgpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIHJldHVybiBwYXRoLmxlbmd0aCAlIDIgPT09IDA7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IGRvY3VtZW50IGtleSB3aXRoIHRoZSBnaXZlbiBzZWdtZW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGF0aCBUaGUgc2VnbWVudHMgb2YgdGhlIHBhdGggdG8gdGhlIGRvY3VtZW50XHJcbiAgICAgKiBAcmV0dXJuIEEgbmV3IGluc3RhbmNlIG9mIERvY3VtZW50S2V5XHJcbiAgICAgKi9cclxuICAgIERvY3VtZW50S2V5LmZyb21TZWdtZW50cyA9IGZ1bmN0aW9uIChzZWdtZW50cykge1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRLZXkobmV3IFJlc291cmNlUGF0aChzZWdtZW50cy5zbGljZSgpKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IGRvY3VtZW50IGtleSB1c2luZyAnLycgdG8gc3BsaXQgdGhlIHN0cmluZyBpbnRvXHJcbiAgICAgKiBzZWdtZW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGF0aCBUaGUgc2xhc2gtc2VwYXJhdGVkIHBhdGggc3RyaW5nIHRvIHRoZSBkb2N1bWVudFxyXG4gICAgICogQHJldHVybiBBIG5ldyBpbnN0YW5jZSBvZiBEb2N1bWVudEtleVxyXG4gICAgICovXHJcbiAgICBEb2N1bWVudEtleS5mcm9tUGF0aFN0cmluZyA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEtleShSZXNvdXJjZVBhdGguZnJvbVN0cmluZyhwYXRoKSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRLZXkuRU1QVFkgPSBuZXcgRG9jdW1lbnRLZXkobmV3IFJlc291cmNlUGF0aChbXSkpO1xyXG4gICAgcmV0dXJuIERvY3VtZW50S2V5O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSByZXN1bHQgb2YgYSBsb29rdXAgZm9yIGEgZ2l2ZW4gcGF0aCBtYXkgYmUgYW4gZXhpc3RpbmcgZG9jdW1lbnQgb3IgYVxyXG4gKiBtYXJrZXIgdGhhdCB0aGlzIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IGF0IGEgZ2l2ZW4gdmVyc2lvbi5cclxuICovXHJcbnZhciBNYXliZURvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWF5YmVEb2N1bWVudChrZXksIHZlcnNpb24pIHtcclxuICAgICAgICB0aGlzLmtleSA9IGtleTtcclxuICAgICAgICB0aGlzLnZlcnNpb24gPSB2ZXJzaW9uO1xyXG4gICAgfVxyXG4gICAgTWF5YmVEb2N1bWVudC5jb21wYXJlQnlLZXkgPSBmdW5jdGlvbiAoZDEsIGQyKSB7XHJcbiAgICAgICAgcmV0dXJuIERvY3VtZW50S2V5LmNvbXBhcmF0b3IoZDEua2V5LCBkMi5rZXkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNYXliZURvY3VtZW50O1xyXG59KCkpO1xyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGRvY3VtZW50IGluIEZpcmVzdG9yZSB3aXRoIGEga2V5LCB2ZXJzaW9uLCBkYXRhIGFuZCB3aGV0aGVyIHRoZVxyXG4gKiBkYXRhIGhhcyBsb2NhbCBtdXRhdGlvbnMgYXBwbGllZCB0byBpdC5cclxuICovXHJcbnZhciBEb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKERvY3VtZW50LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnQoa2V5LCB2ZXJzaW9uLCBkYXRhLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywga2V5LCB2ZXJzaW9uKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIF90aGlzLmhhc0xvY2FsTXV0YXRpb25zID0gISFvcHRpb25zLmhhc0xvY2FsTXV0YXRpb25zO1xyXG4gICAgICAgIF90aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucyA9ICEhb3B0aW9ucy5oYXNDb21taXR0ZWRNdXRhdGlvbnM7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgRG9jdW1lbnQucHJvdG90eXBlLmZpZWxkID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmZpZWxkKHBhdGgpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50LnByb3RvdHlwZS5maWVsZFZhbHVlID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkKHBhdGgpO1xyXG4gICAgICAgIHJldHVybiBmaWVsZCA/IGZpZWxkLnZhbHVlKCkgOiB1bmRlZmluZWQ7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnQucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEudmFsdWUoKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBEb2N1bWVudCAmJlxyXG4gICAgICAgICAgICB0aGlzLmtleS5pc0VxdWFsKG90aGVyLmtleSkgJiZcclxuICAgICAgICAgICAgdGhpcy52ZXJzaW9uLmlzRXF1YWwob3RoZXIudmVyc2lvbikgJiZcclxuICAgICAgICAgICAgdGhpcy5kYXRhLmlzRXF1YWwob3RoZXIuZGF0YSkgJiZcclxuICAgICAgICAgICAgdGhpcy5oYXNMb2NhbE11dGF0aW9ucyA9PT0gb3RoZXIuaGFzTG9jYWxNdXRhdGlvbnMgJiZcclxuICAgICAgICAgICAgdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnMgPT09IG90aGVyLmhhc0NvbW1pdHRlZE11dGF0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAoXCJEb2N1bWVudChcIiArIHRoaXMua2V5ICsgXCIsIFwiICsgdGhpcy52ZXJzaW9uICsgXCIsIFwiICsgdGhpcy5kYXRhLnRvU3RyaW5nKCkgKyBcIiwgXCIgK1xyXG4gICAgICAgICAgICAoXCJ7aGFzTG9jYWxNdXRhdGlvbnM6IFwiICsgdGhpcy5oYXNMb2NhbE11dGF0aW9ucyArIFwifSksIFwiKSArXHJcbiAgICAgICAgICAgIChcIntoYXNDb21taXR0ZWRNdXRhdGlvbnM6IFwiICsgdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnMgKyBcIn0pXCIpKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRG9jdW1lbnQucHJvdG90eXBlLCBcImhhc1BlbmRpbmdXcml0ZXNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oYXNMb2NhbE11dGF0aW9ucyB8fCB0aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIERvY3VtZW50LmNvbXBhcmVCeUZpZWxkID0gZnVuY3Rpb24gKGZpZWxkLCBkMSwgZDIpIHtcclxuICAgICAgICB2YXIgdjEgPSBkMS5maWVsZChmaWVsZCk7XHJcbiAgICAgICAgdmFyIHYyID0gZDIuZmllbGQoZmllbGQpO1xyXG4gICAgICAgIGlmICh2MSAhPT0gdW5kZWZpbmVkICYmIHYyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHYxLmNvbXBhcmVUbyh2Mik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbChcIlRyeWluZyB0byBjb21wYXJlIGRvY3VtZW50cyBvbiBmaWVsZHMgdGhhdCBkb24ndCBleGlzdFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERvY3VtZW50O1xyXG59KE1heWJlRG9jdW1lbnQpKTtcclxuLyoqXHJcbiAqIEEgY2xhc3MgcmVwcmVzZW50aW5nIGEgZGVsZXRlZCBkb2N1bWVudC5cclxuICogVmVyc2lvbiBpcyBzZXQgdG8gMCBpZiB3ZSBkb24ndCBwb2ludCB0byBhbnkgc3BlY2lmaWMgdGltZSwgb3RoZXJ3aXNlIGl0XHJcbiAqIGRlbm90ZXMgdGltZSB3ZSBrbm93IGl0IGRpZG4ndCBleGlzdCBhdC5cclxuICovXHJcbnZhciBOb0RvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoTm9Eb2N1bWVudCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIE5vRG9jdW1lbnQoa2V5LCB2ZXJzaW9uLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywga2V5LCB2ZXJzaW9uKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucyA9ICEhKG9wdGlvbnMgJiYgb3B0aW9ucy5oYXNDb21taXR0ZWRNdXRhdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE5vRG9jdW1lbnQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBcIk5vRG9jdW1lbnQoXCIgKyB0aGlzLmtleSArIFwiLCBcIiArIHRoaXMudmVyc2lvbiArIFwiKVwiO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb0RvY3VtZW50LnByb3RvdHlwZSwgXCJoYXNQZW5kaW5nV3JpdGVzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgTm9Eb2N1bWVudC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBOb0RvY3VtZW50ICYmXHJcbiAgICAgICAgICAgIG90aGVyLmhhc0NvbW1pdHRlZE11dGF0aW9ucyA9PT0gdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnMgJiZcclxuICAgICAgICAgICAgb3RoZXIudmVyc2lvbi5pc0VxdWFsKHRoaXMudmVyc2lvbikgJiZcclxuICAgICAgICAgICAgb3RoZXIua2V5LmlzRXF1YWwodGhpcy5rZXkpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTm9Eb2N1bWVudDtcclxufShNYXliZURvY3VtZW50KSk7XHJcbi8qKlxyXG4gKiBBIGNsYXNzIHJlcHJlc2VudGluZyBhbiBleGlzdGluZyBkb2N1bWVudCB3aG9zZSBkYXRhIGlzIHVua25vd24gKGUuZy4gYVxyXG4gKiBkb2N1bWVudCB0aGF0IHdhcyB1cGRhdGVkIHdpdGhvdXQgYSBrbm93biBiYXNlIGRvY3VtZW50KS5cclxuICovXHJcbnZhciBVbmtub3duRG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhVbmtub3duRG9jdW1lbnQsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBVbmtub3duRG9jdW1lbnQoa2V5LCB2ZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGtleSwgdmVyc2lvbikgfHwgdGhpcztcclxuICAgIH1cclxuICAgIFVua25vd25Eb2N1bWVudC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiVW5rbm93bkRvY3VtZW50KFwiICsgdGhpcy5rZXkgKyBcIiwgXCIgKyB0aGlzLnZlcnNpb24gKyBcIilcIjtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVW5rbm93bkRvY3VtZW50LnByb3RvdHlwZSwgXCJoYXNQZW5kaW5nV3JpdGVzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBVbmtub3duRG9jdW1lbnQucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgVW5rbm93bkRvY3VtZW50ICYmXHJcbiAgICAgICAgICAgIG90aGVyLnZlcnNpb24uaXNFcXVhbCh0aGlzLnZlcnNpb24pICYmXHJcbiAgICAgICAgICAgIG90aGVyLmtleS5pc0VxdWFsKHRoaXMua2V5KSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFVua25vd25Eb2N1bWVudDtcclxufShNYXliZURvY3VtZW50KSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBBbiBpbW11dGFibGUgc29ydGVkIG1hcCBpbXBsZW1lbnRhdGlvbiwgYmFzZWQgb24gYSBMZWZ0LWxlYW5pbmcgUmVkLUJsYWNrXHJcbi8vIHRyZWUuXHJcbnZhciBTb3J0ZWRNYXAgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTb3J0ZWRNYXAoY29tcGFyYXRvciwgcm9vdCkge1xyXG4gICAgICAgIHRoaXMuY29tcGFyYXRvciA9IGNvbXBhcmF0b3I7XHJcbiAgICAgICAgdGhpcy5yb290ID0gcm9vdCA/IHJvb3QgOiBMTFJCTm9kZS5FTVBUWTtcclxuICAgIH1cclxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBtYXAsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkvdmFsdWUgYWRkZWQgb3IgcmVwbGFjZWQuXHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXAodGhpcy5jb21wYXJhdG9yLCB0aGlzLnJvb3RcclxuICAgICAgICAgICAgLmluc2VydChrZXksIHZhbHVlLCB0aGlzLmNvbXBhcmF0b3IpXHJcbiAgICAgICAgICAgIC5jb3B5KG51bGwsIG51bGwsIExMUkJOb2RlLkJMQUNLLCBudWxsLCBudWxsKSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIG1hcCwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSByZW1vdmVkLlxyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXAodGhpcy5jb21wYXJhdG9yLCB0aGlzLnJvb3RcclxuICAgICAgICAgICAgLnJlbW92ZShrZXksIHRoaXMuY29tcGFyYXRvcilcclxuICAgICAgICAgICAgLmNvcHkobnVsbCwgbnVsbCwgTExSQk5vZGUuQkxBQ0ssIG51bGwsIG51bGwpKTtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgbm9kZSB3aXRoIHRoZSBnaXZlbiBrZXksIG9yIG51bGwuXHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgbm9kZSA9IHRoaXMucm9vdDtcclxuICAgICAgICB3aGlsZSAoIW5vZGUuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHZhciBjbXAgPSB0aGlzLmNvbXBhcmF0b3Ioa2V5LCBub2RlLmtleSk7XHJcbiAgICAgICAgICAgIGlmIChjbXAgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlLnZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHtcclxuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY21wID4gMCkge1xyXG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGVsZW1lbnQgaW4gdGhpcyBzb3J0ZWQgbWFwLCBvciAtMSBpZiBpdCBkb2Vzbid0XHJcbiAgICAvLyBleGlzdC5cclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAvLyBOdW1iZXIgb2Ygbm9kZXMgdGhhdCB3ZXJlIHBydW5lZCB3aGVuIGRlc2NlbmRpbmcgcmlnaHRcclxuICAgICAgICB2YXIgcHJ1bmVkTm9kZXMgPSAwO1xyXG4gICAgICAgIHZhciBub2RlID0gdGhpcy5yb290O1xyXG4gICAgICAgIHdoaWxlICghbm9kZS5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgdmFyIGNtcCA9IHRoaXMuY29tcGFyYXRvcihrZXksIG5vZGUua2V5KTtcclxuICAgICAgICAgICAgaWYgKGNtcCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBydW5lZE5vZGVzICsgbm9kZS5sZWZ0LnNpemU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY21wIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUubGVmdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIENvdW50IGFsbCBub2RlcyBsZWZ0IG9mIHRoZSBub2RlIHBsdXMgdGhlIG5vZGUgaXRzZWxmXHJcbiAgICAgICAgICAgICAgICBwcnVuZWROb2RlcyArPSBub2RlLmxlZnQuc2l6ZSArIDE7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5yaWdodDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBOb2RlIG5vdCBmb3VuZFxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5pc0VtcHR5KCk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNvcnRlZE1hcC5wcm90b3R5cGUsIFwic2l6ZVwiLCB7XHJcbiAgICAgICAgLy8gUmV0dXJucyB0aGUgdG90YWwgbnVtYmVyIG9mIG5vZGVzIGluIHRoZSBtYXAuXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJvb3Quc2l6ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8vIFJldHVybnMgdGhlIG1pbmltdW0ga2V5IGluIHRoZSBtYXAuXHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLm1pbktleSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yb290Lm1pbktleSgpO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgdGhlIG1heGltdW0ga2V5IGluIHRoZSBtYXAuXHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLm1heEtleSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yb290Lm1heEtleSgpO1xyXG4gICAgfTtcclxuICAgIC8vIFRyYXZlcnNlcyB0aGUgbWFwIGluIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb24gZnVuY3Rpb25cclxuICAgIC8vIGZvciBlYWNoIGtleS92YWx1ZSBwYWlyLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cclxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxyXG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5pbm9yZGVyVHJhdmVyc2FsID0gZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QuaW5vcmRlclRyYXZlcnNhbChhY3Rpb24pO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgIHRoaXMuaW5vcmRlclRyYXZlcnNhbChmdW5jdGlvbiAoaywgdikge1xyXG4gICAgICAgICAgICBmbihrLCB2KTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFRyYXZlcnNlcyB0aGUgbWFwIGluIHJldmVyc2Uga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvblxyXG4gICAgLy8gZnVuY3Rpb24gZm9yIGVhY2gga2V5L3ZhbHVlIHBhaXIuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpc1xyXG4gICAgLy8gYWJvcnRlZC5cclxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxyXG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5yZXZlcnNlVHJhdmVyc2FsID0gZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QucmV2ZXJzZVRyYXZlcnNhbChhY3Rpb24pO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgYW4gaXRlcmF0b3Igb3ZlciB0aGUgU29ydGVkTWFwLlxyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5nZXRJdGVyYXRvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcEl0ZXJhdG9yKHRoaXMucm9vdCwgbnVsbCwgdGhpcy5jb21wYXJhdG9yLCBmYWxzZSk7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5nZXRJdGVyYXRvckZyb20gPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXBJdGVyYXRvcih0aGlzLnJvb3QsIGtleSwgdGhpcy5jb21wYXJhdG9yLCBmYWxzZSk7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5nZXRSZXZlcnNlSXRlcmF0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXBJdGVyYXRvcih0aGlzLnJvb3QsIG51bGwsIHRoaXMuY29tcGFyYXRvciwgdHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5nZXRSZXZlcnNlSXRlcmF0b3JGcm9tID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgU29ydGVkTWFwSXRlcmF0b3IodGhpcy5yb290LCBrZXksIHRoaXMuY29tcGFyYXRvciwgdHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNvcnRlZE1hcDtcclxufSgpKTsgLy8gZW5kIFNvcnRlZE1hcFxyXG4vLyBBbiBpdGVyYXRvciBvdmVyIGFuIExMUkJOb2RlLlxyXG52YXIgU29ydGVkTWFwSXRlcmF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTb3J0ZWRNYXBJdGVyYXRvcihub2RlLCBzdGFydEtleSwgY29tcGFyYXRvciwgaXNSZXZlcnNlKSB7XHJcbiAgICAgICAgdGhpcy5pc1JldmVyc2UgPSBpc1JldmVyc2U7XHJcbiAgICAgICAgdGhpcy5ub2RlU3RhY2sgPSBbXTtcclxuICAgICAgICB2YXIgY21wID0gMTtcclxuICAgICAgICB3aGlsZSAoIW5vZGUuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIGNtcCA9IHN0YXJ0S2V5ID8gY29tcGFyYXRvcihub2RlLmtleSwgc3RhcnRLZXkpIDogMTtcclxuICAgICAgICAgICAgLy8gZmxpcCB0aGUgY29tcGFyaXNvbiBpZiB3ZSdyZSBnb2luZyBpbiByZXZlcnNlXHJcbiAgICAgICAgICAgIGlmIChpc1JldmVyc2UpXHJcbiAgICAgICAgICAgICAgICBjbXAgKj0gLTE7XHJcbiAgICAgICAgICAgIGlmIChjbXAgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIG5vZGUgaXMgbGVzcyB0aGFuIG91ciBzdGFydCBrZXkuIGlnbm9yZSBpdFxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNSZXZlcnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUubGVmdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBub2RlIGlzIGV4YWN0bHkgZXF1YWwgdG8gb3VyIHN0YXJ0IGtleS4gUHVzaCBpdCBvbiB0aGUgc3RhY2ssXHJcbiAgICAgICAgICAgICAgICAvLyBidXQgc3RvcCBpdGVyYXRpbmc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVTdGFjay5wdXNoKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIG5vZGUgaXMgZ3JlYXRlciB0aGFuIG91ciBzdGFydCBrZXksIGFkZCBpdCB0byB0aGUgc3RhY2sgYW5kIG1vdmVcclxuICAgICAgICAgICAgICAgIC8vIHRvIHRoZSBuZXh0IG9uZVxyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlU3RhY2sucHVzaChub2RlKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUmV2ZXJzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUubGVmdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFNvcnRlZE1hcEl0ZXJhdG9yLnByb3RvdHlwZS5nZXROZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLm5vZGVTdGFjay5sZW5ndGggPiAwLCAnZ2V0TmV4dCgpIGNhbGxlZCBvbiBpdGVyYXRvciB3aGVuIGhhc05leHQoKSBpcyBmYWxzZS4nKTtcclxuICAgICAgICB2YXIgbm9kZSA9IHRoaXMubm9kZVN0YWNrLnBvcCgpO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSB7IGtleTogbm9kZS5rZXksIHZhbHVlOiBub2RlLnZhbHVlIH07XHJcbiAgICAgICAgaWYgKHRoaXMuaXNSZXZlcnNlKSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XHJcbiAgICAgICAgICAgIHdoaWxlICghbm9kZS5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrLnB1c2gobm9kZSk7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5yaWdodDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XHJcbiAgICAgICAgICAgIHdoaWxlICghbm9kZS5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrLnB1c2gobm9kZSk7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkTWFwSXRlcmF0b3IucHJvdG90eXBlLmhhc05leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubm9kZVN0YWNrLmxlbmd0aCA+IDA7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkTWFwSXRlcmF0b3IucHJvdG90eXBlLnBlZWsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZVN0YWNrLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm5vZGVTdGFja1t0aGlzLm5vZGVTdGFjay5sZW5ndGggLSAxXTtcclxuICAgICAgICByZXR1cm4geyBrZXk6IG5vZGUua2V5LCB2YWx1ZTogbm9kZS52YWx1ZSB9O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTb3J0ZWRNYXBJdGVyYXRvcjtcclxufSgpKTsgLy8gZW5kIFNvcnRlZE1hcEl0ZXJhdG9yXHJcbi8vIFJlcHJlc2VudHMgYSBub2RlIGluIGEgTGVmdC1sZWFuaW5nIFJlZC1CbGFjayB0cmVlLlxyXG52YXIgTExSQk5vZGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMTFJCTm9kZShrZXksIHZhbHVlLCBjb2xvciwgbGVmdCwgcmlnaHQpIHtcclxuICAgICAgICB0aGlzLmtleSA9IGtleTtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5jb2xvciA9IGNvbG9yICE9IG51bGwgPyBjb2xvciA6IExMUkJOb2RlLlJFRDtcclxuICAgICAgICB0aGlzLmxlZnQgPSBsZWZ0ICE9IG51bGwgPyBsZWZ0IDogTExSQk5vZGUuRU1QVFk7XHJcbiAgICAgICAgdGhpcy5yaWdodCA9IHJpZ2h0ICE9IG51bGwgPyByaWdodCA6IExMUkJOb2RlLkVNUFRZO1xyXG4gICAgICAgIHRoaXMuc2l6ZSA9IHRoaXMubGVmdC5zaXplICsgMSArIHRoaXMucmlnaHQuc2l6ZTtcclxuICAgIH1cclxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50IG5vZGUsIG9wdGlvbmFsbHkgcmVwbGFjaW5nIHBpZWNlcyBvZiBpdC5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbG9yLCBsZWZ0LCByaWdodCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgTExSQk5vZGUoa2V5ICE9IG51bGwgPyBrZXkgOiB0aGlzLmtleSwgdmFsdWUgIT0gbnVsbCA/IHZhbHVlIDogdGhpcy52YWx1ZSwgY29sb3IgIT0gbnVsbCA/IGNvbG9yIDogdGhpcy5jb2xvciwgbGVmdCAhPSBudWxsID8gbGVmdCA6IHRoaXMubGVmdCwgcmlnaHQgIT0gbnVsbCA/IHJpZ2h0IDogdGhpcy5yaWdodCk7XHJcbiAgICB9O1xyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIC8vIFRyYXZlcnNlcyB0aGUgdHJlZSBpbiBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIGZ1bmN0aW9uXHJcbiAgICAvLyBmb3IgZWFjaCBub2RlLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cclxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxyXG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmlub3JkZXJUcmF2ZXJzYWwgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmxlZnQuaW5vcmRlclRyYXZlcnNhbChhY3Rpb24pIHx8XHJcbiAgICAgICAgICAgIGFjdGlvbih0aGlzLmtleSwgdGhpcy52YWx1ZSkgfHxcclxuICAgICAgICAgICAgdGhpcy5yaWdodC5pbm9yZGVyVHJhdmVyc2FsKGFjdGlvbikpO1xyXG4gICAgfTtcclxuICAgIC8vIFRyYXZlcnNlcyB0aGUgdHJlZSBpbiByZXZlcnNlIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb25cclxuICAgIC8vIGZ1bmN0aW9uIGZvciBlYWNoIG5vZGUuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxyXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XHJcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUucmV2ZXJzZVRyYXZlcnNhbCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMucmlnaHQucmV2ZXJzZVRyYXZlcnNhbChhY3Rpb24pIHx8XHJcbiAgICAgICAgICAgIGFjdGlvbih0aGlzLmtleSwgdGhpcy52YWx1ZSkgfHxcclxuICAgICAgICAgICAgdGhpcy5sZWZ0LnJldmVyc2VUcmF2ZXJzYWwoYWN0aW9uKSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyB0aGUgbWluaW11bSBub2RlIGluIHRoZSB0cmVlLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLm1pbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5sZWZ0LmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxlZnQubWluKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgdGhlIG1heGltdW0ga2V5IGluIHRoZSB0cmVlLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLm1pbktleSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5taW4oKS5rZXk7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyB0aGUgbWF4aW11bSBrZXkgaW4gdGhlIHRyZWUuXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUubWF4S2V5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnJpZ2h0LmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5rZXk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yaWdodC5tYXhLZXkoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSwgd2l0aCB0aGUga2V5L3ZhbHVlIGFkZGVkLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb21wYXJhdG9yKSB7XHJcbiAgICAgICAgdmFyIG4gPSB0aGlzO1xyXG4gICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGtleSwgbi5rZXkpO1xyXG4gICAgICAgIGlmIChjbXAgPCAwKSB7XHJcbiAgICAgICAgICAgIG4gPSBuLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbi5sZWZ0Lmluc2VydChrZXksIHZhbHVlLCBjb21wYXJhdG9yKSwgbnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNtcCA9PT0gMCkge1xyXG4gICAgICAgICAgICBuID0gbi5jb3B5KG51bGwsIHZhbHVlLCBudWxsLCBudWxsLCBudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG4gPSBuLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbi5yaWdodC5pbnNlcnQoa2V5LCB2YWx1ZSwgY29tcGFyYXRvcikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbi5maXhVcCgpO1xyXG4gICAgfTtcclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5yZW1vdmVNaW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubGVmdC5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIExMUkJOb2RlLkVNUFRZO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFuLmxlZnQuaXNSZWQoKSAmJiAhbi5sZWZ0LmxlZnQuaXNSZWQoKSlcclxuICAgICAgICAgICAgbiA9IG4ubW92ZVJlZExlZnQoKTtcclxuICAgICAgICBuID0gbi5jb3B5KG51bGwsIG51bGwsIG51bGwsIG4ubGVmdC5yZW1vdmVNaW4oKSwgbnVsbCk7XHJcbiAgICAgICAgcmV0dXJuIG4uZml4VXAoKTtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIG5ldyB0cmVlLCB3aXRoIHRoZSBzcGVjaWZpZWQgaXRlbSByZW1vdmVkLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXksIGNvbXBhcmF0b3IpIHtcclxuICAgICAgICB2YXIgc21hbGxlc3Q7XHJcbiAgICAgICAgdmFyIG4gPSB0aGlzO1xyXG4gICAgICAgIGlmIChjb21wYXJhdG9yKGtleSwgbi5rZXkpIDwgMCkge1xyXG4gICAgICAgICAgICBpZiAoIW4ubGVmdC5pc0VtcHR5KCkgJiYgIW4ubGVmdC5pc1JlZCgpICYmICFuLmxlZnQubGVmdC5pc1JlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBuID0gbi5tb3ZlUmVkTGVmdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG4gPSBuLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbi5sZWZ0LnJlbW92ZShrZXksIGNvbXBhcmF0b3IpLCBudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChuLmxlZnQuaXNSZWQoKSlcclxuICAgICAgICAgICAgICAgIG4gPSBuLnJvdGF0ZVJpZ2h0KCk7XHJcbiAgICAgICAgICAgIGlmICghbi5yaWdodC5pc0VtcHR5KCkgJiYgIW4ucmlnaHQuaXNSZWQoKSAmJiAhbi5yaWdodC5sZWZ0LmlzUmVkKCkpIHtcclxuICAgICAgICAgICAgICAgIG4gPSBuLm1vdmVSZWRSaWdodCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb21wYXJhdG9yKGtleSwgbi5rZXkpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobi5yaWdodC5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTExSQk5vZGUuRU1QVFk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzbWFsbGVzdCA9IG4ucmlnaHQubWluKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IG4uY29weShzbWFsbGVzdC5rZXksIHNtYWxsZXN0LnZhbHVlLCBudWxsLCBudWxsLCBuLnJpZ2h0LnJlbW92ZU1pbigpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBuID0gbi5jb3B5KG51bGwsIG51bGwsIG51bGwsIG51bGwsIG4ucmlnaHQucmVtb3ZlKGtleSwgY29tcGFyYXRvcikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbi5maXhVcCgpO1xyXG4gICAgfTtcclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5pc1JlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb2xvcjtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIG5ldyB0cmVlIGFmdGVyIHBlcmZvcm1pbmcgYW55IG5lZWRlZCByb3RhdGlvbnMuXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuZml4VXAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG4gPSB0aGlzO1xyXG4gICAgICAgIGlmIChuLnJpZ2h0LmlzUmVkKCkgJiYgIW4ubGVmdC5pc1JlZCgpKVxyXG4gICAgICAgICAgICBuID0gbi5yb3RhdGVMZWZ0KCk7XHJcbiAgICAgICAgaWYgKG4ubGVmdC5pc1JlZCgpICYmIG4ubGVmdC5sZWZ0LmlzUmVkKCkpXHJcbiAgICAgICAgICAgIG4gPSBuLnJvdGF0ZVJpZ2h0KCk7XHJcbiAgICAgICAgaWYgKG4ubGVmdC5pc1JlZCgpICYmIG4ucmlnaHQuaXNSZWQoKSlcclxuICAgICAgICAgICAgbiA9IG4uY29sb3JGbGlwKCk7XHJcbiAgICAgICAgcmV0dXJuIG47XHJcbiAgICB9O1xyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLm1vdmVSZWRMZWZ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBuID0gdGhpcy5jb2xvckZsaXAoKTtcclxuICAgICAgICBpZiAobi5yaWdodC5sZWZ0LmlzUmVkKCkpIHtcclxuICAgICAgICAgICAgbiA9IG4uY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBuLnJpZ2h0LnJvdGF0ZVJpZ2h0KCkpO1xyXG4gICAgICAgICAgICBuID0gbi5yb3RhdGVMZWZ0KCk7XHJcbiAgICAgICAgICAgIG4gPSBuLmNvbG9yRmxpcCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbjtcclxuICAgIH07XHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUubW92ZVJlZFJpZ2h0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBuID0gdGhpcy5jb2xvckZsaXAoKTtcclxuICAgICAgICBpZiAobi5sZWZ0LmxlZnQuaXNSZWQoKSkge1xyXG4gICAgICAgICAgICBuID0gbi5yb3RhdGVSaWdodCgpO1xyXG4gICAgICAgICAgICBuID0gbi5jb2xvckZsaXAoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG47XHJcbiAgICB9O1xyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLnJvdGF0ZUxlZnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG5sID0gdGhpcy5jb3B5KG51bGwsIG51bGwsIExMUkJOb2RlLlJFRCwgbnVsbCwgdGhpcy5yaWdodC5sZWZ0KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5yaWdodC5jb3B5KG51bGwsIG51bGwsIHRoaXMuY29sb3IsIG5sLCBudWxsKTtcclxuICAgIH07XHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUucm90YXRlUmlnaHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG5yID0gdGhpcy5jb3B5KG51bGwsIG51bGwsIExMUkJOb2RlLlJFRCwgdGhpcy5sZWZ0LnJpZ2h0LCBudWxsKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0LmNvcHkobnVsbCwgbnVsbCwgdGhpcy5jb2xvciwgbnVsbCwgbnIpO1xyXG4gICAgfTtcclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5jb2xvckZsaXAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGxlZnQgPSB0aGlzLmxlZnQuY29weShudWxsLCBudWxsLCAhdGhpcy5sZWZ0LmNvbG9yLCBudWxsLCBudWxsKTtcclxuICAgICAgICB2YXIgcmlnaHQgPSB0aGlzLnJpZ2h0LmNvcHkobnVsbCwgbnVsbCwgIXRoaXMucmlnaHQuY29sb3IsIG51bGwsIG51bGwpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkobnVsbCwgbnVsbCwgIXRoaXMuY29sb3IsIGxlZnQsIHJpZ2h0KTtcclxuICAgIH07XHJcbiAgICAvLyBGb3IgdGVzdGluZy5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5jaGVja01heERlcHRoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBibGFja0RlcHRoID0gdGhpcy5jaGVjaygpO1xyXG4gICAgICAgIGlmIChNYXRoLnBvdygyLjAsIGJsYWNrRGVwdGgpIDw9IHRoaXMuc2l6ZSArIDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIEluIGEgYmFsYW5jZWQgUkIgdHJlZSwgdGhlIGJsYWNrLWRlcHRoIChudW1iZXIgb2YgYmxhY2sgbm9kZXMpIGZyb20gcm9vdCB0b1xyXG4gICAgLy8gbGVhdmVzIGlzIGVxdWFsIG9uIGJvdGggc2lkZXMuICBUaGlzIGZ1bmN0aW9uIHZlcmlmaWVzIHRoYXQgb3IgYXNzZXJ0cy5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5jaGVjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc1JlZCgpICYmIHRoaXMubGVmdC5pc1JlZCgpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGZhaWwoJ1JlZCBub2RlIGhhcyByZWQgY2hpbGQoJyArIHRoaXMua2V5ICsgJywnICsgdGhpcy52YWx1ZSArICcpJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnJpZ2h0LmlzUmVkKCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgZmFpbCgnUmlnaHQgY2hpbGQgb2YgKCcgKyB0aGlzLmtleSArICcsJyArIHRoaXMudmFsdWUgKyAnKSBpcyByZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGJsYWNrRGVwdGggPSB0aGlzLmxlZnQuY2hlY2soKTtcclxuICAgICAgICBpZiAoYmxhY2tEZXB0aCAhPT0gdGhpcy5yaWdodC5jaGVjaygpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGZhaWwoJ0JsYWNrIGRlcHRocyBkaWZmZXInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBibGFja0RlcHRoICsgKHRoaXMuaXNSZWQoKSA/IDAgOiAxKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBFbXB0eSBub2RlIGlzIHNoYXJlZCBiZXR3ZWVuIGFsbCBMTFJCIHRyZWVzLlxyXG4gICAgTExSQk5vZGUuRU1QVFkgPSBudWxsO1xyXG4gICAgTExSQk5vZGUuUkVEID0gdHJ1ZTtcclxuICAgIExMUkJOb2RlLkJMQUNLID0gZmFsc2U7XHJcbiAgICByZXR1cm4gTExSQk5vZGU7XHJcbn0oKSk7IC8vIGVuZCBMTFJCTm9kZVxyXG4vLyBSZXByZXNlbnRzIGFuIGVtcHR5IG5vZGUgKGEgbGVhZiBub2RlIGluIHRoZSBSZWQtQmxhY2sgVHJlZSkuXHJcbnZhciBMTFJCRW1wdHlOb2RlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTExSQkVtcHR5Tm9kZSgpIHtcclxuICAgICAgICB0aGlzLnNpemUgPSAwO1xyXG4gICAgfVxyXG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIGN1cnJlbnQgbm9kZS5cclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29sb3IsIGxlZnQsIHJpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIHRyZWUsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkvdmFsdWUgYWRkZWQuXHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29tcGFyYXRvcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgTExSQk5vZGUoa2V5LCB2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIHRyZWUsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkgcmVtb3ZlZC5cclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXksIGNvbXBhcmF0b3IpIHtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmlub3JkZXJUcmF2ZXJzYWwgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLnJldmVyc2VUcmF2ZXJzYWwgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLm1pbktleSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5tYXhLZXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUuaXNSZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIC8vIEZvciB0ZXN0aW5nLlxyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUuY2hlY2tNYXhEZXB0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5jaGVjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTExSQkVtcHR5Tm9kZTtcclxufSgpKTsgLy8gZW5kIExMUkJFbXB0eU5vZGVcclxuTExSQk5vZGUuRU1QVFkgPSBuZXcgTExSQkVtcHR5Tm9kZSgpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIFR5cGVPcmRlcjtcclxuKGZ1bmN0aW9uIChUeXBlT3JkZXIpIHtcclxuICAgIC8vIFRoaXMgb3JkZXIgaXMgZGVmaW5lZCBieSB0aGUgYmFja2VuZC5cclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJOdWxsVmFsdWVcIl0gPSAwXSA9IFwiTnVsbFZhbHVlXCI7XHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiQm9vbGVhblZhbHVlXCJdID0gMV0gPSBcIkJvb2xlYW5WYWx1ZVwiO1xyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIk51bWJlclZhbHVlXCJdID0gMl0gPSBcIk51bWJlclZhbHVlXCI7XHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiVGltZXN0YW1wVmFsdWVcIl0gPSAzXSA9IFwiVGltZXN0YW1wVmFsdWVcIjtcclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJTdHJpbmdWYWx1ZVwiXSA9IDRdID0gXCJTdHJpbmdWYWx1ZVwiO1xyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIkJsb2JWYWx1ZVwiXSA9IDVdID0gXCJCbG9iVmFsdWVcIjtcclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJSZWZWYWx1ZVwiXSA9IDZdID0gXCJSZWZWYWx1ZVwiO1xyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIkdlb1BvaW50VmFsdWVcIl0gPSA3XSA9IFwiR2VvUG9pbnRWYWx1ZVwiO1xyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIkFycmF5VmFsdWVcIl0gPSA4XSA9IFwiQXJyYXlWYWx1ZVwiO1xyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIk9iamVjdFZhbHVlXCJdID0gOV0gPSBcIk9iamVjdFZhbHVlXCI7XHJcbn0pKFR5cGVPcmRlciB8fCAoVHlwZU9yZGVyID0ge30pKTtcclxuLyoqIERlZmluZXMgdGhlIHJldHVybiB2YWx1ZSBmb3IgcGVuZGluZyBzZXJ2ZXIgdGltZXN0YW1wcy4gKi9cclxudmFyIFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yO1xyXG4oZnVuY3Rpb24gKFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yKSB7XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvcltTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvcltcIkRlZmF1bHRcIl0gPSAwXSA9IFwiRGVmYXVsdFwiO1xyXG4gICAgU2VydmVyVGltZXN0YW1wQmVoYXZpb3JbU2VydmVyVGltZXN0YW1wQmVoYXZpb3JbXCJFc3RpbWF0ZVwiXSA9IDFdID0gXCJFc3RpbWF0ZVwiO1xyXG4gICAgU2VydmVyVGltZXN0YW1wQmVoYXZpb3JbU2VydmVyVGltZXN0YW1wQmVoYXZpb3JbXCJQcmV2aW91c1wiXSA9IDJdID0gXCJQcmV2aW91c1wiO1xyXG59KShTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvciB8fCAoU2VydmVyVGltZXN0YW1wQmVoYXZpb3IgPSB7fSkpO1xyXG4vKiogSG9sZHMgcHJvcGVydGllcyB0aGF0IGRlZmluZSBmaWVsZCB2YWx1ZSBkZXNlcmlhbGl6YXRpb24gb3B0aW9ucy4gKi9cclxudmFyIEZpZWxkVmFsdWVPcHRpb25zID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmllbGRWYWx1ZU9wdGlvbnMoc2VydmVyVGltZXN0YW1wQmVoYXZpb3IsIHRpbWVzdGFtcHNJblNuYXBzaG90cykge1xyXG4gICAgICAgIHRoaXMuc2VydmVyVGltZXN0YW1wQmVoYXZpb3IgPSBzZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvcjtcclxuICAgICAgICB0aGlzLnRpbWVzdGFtcHNJblNuYXBzaG90cyA9IHRpbWVzdGFtcHNJblNuYXBzaG90cztcclxuICAgIH1cclxuICAgIEZpZWxkVmFsdWVPcHRpb25zLmZyb21TbmFwc2hvdE9wdGlvbnMgPSBmdW5jdGlvbiAob3B0aW9ucywgdGltZXN0YW1wc0luU25hcHNob3RzKSB7XHJcbiAgICAgICAgc3dpdGNoIChvcHRpb25zLnNlcnZlclRpbWVzdGFtcHMpIHtcclxuICAgICAgICAgICAgY2FzZSAnZXN0aW1hdGUnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFZhbHVlT3B0aW9ucyhTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvci5Fc3RpbWF0ZSwgdGltZXN0YW1wc0luU25hcHNob3RzKTtcclxuICAgICAgICAgICAgY2FzZSAncHJldmlvdXMnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFZhbHVlT3B0aW9ucyhTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvci5QcmV2aW91cywgdGltZXN0YW1wc0luU25hcHNob3RzKTtcclxuICAgICAgICAgICAgY2FzZSAnbm9uZSc6IC8vIEZhbGwtdGhyb3VnaCBpbnRlbmRlZC5cclxuICAgICAgICAgICAgY2FzZSB1bmRlZmluZWQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZpZWxkVmFsdWVPcHRpb25zKFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yLkRlZmF1bHQsIHRpbWVzdGFtcHNJblNuYXBzaG90cyk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnZnJvbVNuYXBzaG90T3B0aW9ucygpIGNhbGxlZCB3aXRoIGludmFsaWQgb3B0aW9ucy4nKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpZWxkVmFsdWVPcHRpb25zO1xyXG59KCkpO1xyXG4vKipcclxuICogQSBmaWVsZCB2YWx1ZSByZXByZXNlbnRzIGEgZGF0YXR5cGUgYXMgc3RvcmVkIGJ5IEZpcmVzdG9yZS5cclxuICovXHJcbnZhciBGaWVsZFZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmllbGRWYWx1ZSgpIHtcclxuICAgIH1cclxuICAgIEZpZWxkVmFsdWUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB2YWwgPSB0aGlzLnZhbHVlKCk7XHJcbiAgICAgICAgcmV0dXJuIHZhbCA9PT0gbnVsbCA/ICdudWxsJyA6IHZhbC50b1N0cmluZygpO1xyXG4gICAgfTtcclxuICAgIEZpZWxkVmFsdWUucHJvdG90eXBlLmRlZmF1bHRDb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy50eXBlT3JkZXIgIT09IG90aGVyLnR5cGVPcmRlciwgJ0RlZmF1bHQgY29tcGFyZVRvIHNob3VsZCBub3QgYmUgdXNlZCBmb3IgdmFsdWVzIG9mIHNhbWUgdHlwZS4nKTtcclxuICAgICAgICB2YXIgY21wID0gcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLnR5cGVPcmRlciwgb3RoZXIudHlwZU9yZGVyKTtcclxuICAgICAgICByZXR1cm4gY21wO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBGaWVsZFZhbHVlO1xyXG59KCkpO1xyXG52YXIgTnVsbFZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoTnVsbFZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gTnVsbFZhbHVlKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLk51bGxWYWx1ZTtcclxuICAgICAgICAvLyBpbnRlcm5hbFZhbHVlIGlzIHVudXNlZCBidXQgd2UgYWRkIGl0IHRvIHdvcmsgYXJvdW5kXHJcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy8xNTU4NVxyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE51bGxWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIE51bGxWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiBvdGhlciBpbnN0YW5jZW9mIE51bGxWYWx1ZTtcclxuICAgIH07XHJcbiAgICBOdWxsVmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIE51bGxWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICB9O1xyXG4gICAgTnVsbFZhbHVlLklOU1RBTkNFID0gbmV3IE51bGxWYWx1ZSgpO1xyXG4gICAgcmV0dXJuIE51bGxWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbnZhciBCb29sZWFuVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhCb29sZWFuVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBCb29sZWFuVmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IGludGVybmFsVmFsdWU7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLkJvb2xlYW5WYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBCb29sZWFuVmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlO1xyXG4gICAgfTtcclxuICAgIEJvb2xlYW5WYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBCb29sZWFuVmFsdWUgJiZcclxuICAgICAgICAgICAgdGhpcy5pbnRlcm5hbFZhbHVlID09PSBvdGhlci5pbnRlcm5hbFZhbHVlKTtcclxuICAgIH07XHJcbiAgICBCb29sZWFuVmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIEJvb2xlYW5WYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLCBvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgfTtcclxuICAgIEJvb2xlYW5WYWx1ZS5vZiA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB2YWx1ZSA/IEJvb2xlYW5WYWx1ZS5UUlVFIDogQm9vbGVhblZhbHVlLkZBTFNFO1xyXG4gICAgfTtcclxuICAgIEJvb2xlYW5WYWx1ZS5UUlVFID0gbmV3IEJvb2xlYW5WYWx1ZSh0cnVlKTtcclxuICAgIEJvb2xlYW5WYWx1ZS5GQUxTRSA9IG5ldyBCb29sZWFuVmFsdWUoZmFsc2UpO1xyXG4gICAgcmV0dXJuIEJvb2xlYW5WYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbi8qKiBCYXNlIGNsYXNzIGZvciBJbnRlZ2VyVmFsdWUgYW5kIERvdWJsZVZhbHVlLiAqL1xyXG52YXIgTnVtYmVyVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhOdW1iZXJWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIE51bWJlclZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBpbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5OdW1iZXJWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBOdW1iZXJWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWU7XHJcbiAgICB9O1xyXG4gICAgTnVtYmVyVmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIE51bWJlclZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudW1lcmljQ29tcGFyYXRvcih0aGlzLmludGVybmFsVmFsdWUsIG90aGVyLmludGVybmFsVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTnVtYmVyVmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG4vKiogVXRpbGl0eSBmdW5jdGlvbiB0byBjb21wYXJlIGRvdWJsZXMgKHVzaW5nIEZpcmVzdG9yZSBzZW1hbnRpY3MgZm9yIE5hTikuICovXHJcbmZ1bmN0aW9uIG51bWVyaWNDb21wYXJhdG9yKGxlZnQsIHJpZ2h0KSB7XHJcbiAgICBpZiAobGVmdCA8IHJpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobGVmdCA+IHJpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIDE7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChsZWZ0ID09PSByaWdodCkge1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gb25lIG9yIGJvdGggYXJlIE5hTi5cclxuICAgICAgICBpZiAoaXNOYU4obGVmdCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlzTmFOKHJpZ2h0KSA/IDAgOiAtMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICogVXRpbGl0eSBmdW5jdGlvbiB0byBjaGVjayBudW1iZXJzIGZvciBlcXVhbGl0eSB1c2luZyBGaXJlc3RvcmUgc2VtYW50aWNzXHJcbiAqIChOYU4gPT09IE5hTiwgLTAuMCAhPT0gMC4wKS5cclxuICovXHJcbmZ1bmN0aW9uIG51bWVyaWNFcXVhbHMobGVmdCwgcmlnaHQpIHtcclxuICAgIC8vIEltcGxlbWVudGVkIGJhc2VkIG9uIE9iamVjdC5pcygpIHBvbHlmaWxsIGZyb21cclxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL09iamVjdC9pc1xyXG4gICAgaWYgKGxlZnQgPT09IHJpZ2h0KSB7XHJcbiAgICAgICAgLy8gKzAgIT0gLTBcclxuICAgICAgICByZXR1cm4gbGVmdCAhPT0gMCB8fCAxIC8gbGVmdCA9PT0gMSAvIHJpZ2h0O1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gTmFOID09IE5hTlxyXG4gICAgICAgIHJldHVybiBsZWZ0ICE9PSBsZWZ0ICYmIHJpZ2h0ICE9PSByaWdodDtcclxuICAgIH1cclxufVxyXG52YXIgSW50ZWdlclZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoSW50ZWdlclZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gSW50ZWdlclZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgaW50ZXJuYWxWYWx1ZSkgfHwgdGhpcztcclxuICAgIH1cclxuICAgIEludGVnZXJWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIC8vIE5PVEU6IERvdWJsZVZhbHVlIGFuZCBJbnRlZ2VyVmFsdWUgaW5zdGFuY2VzIG1heSBjb21wYXJlVG8oKSB0aGUgc2FtZSxcclxuICAgICAgICAvLyBidXQgdGhhdCBkb2Vzbid0IG1ha2UgdGhlbSBlcXVhbCB2aWEgaXNFcXVhbCgpLlxyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIEludGVnZXJWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVtZXJpY0VxdWFscyh0aGlzLmludGVybmFsVmFsdWUsIG90aGVyLmludGVybmFsVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gSW50ZWdlclZhbHVlO1xyXG59KE51bWJlclZhbHVlKSk7XHJcbnZhciBEb3VibGVWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKERvdWJsZVZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gRG91YmxlVmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGludGVybmFsVmFsdWUpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IGludGVybmFsVmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgRG91YmxlVmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICAvLyBOT1RFOiBEb3VibGVWYWx1ZSBhbmQgSW50ZWdlclZhbHVlIGluc3RhbmNlcyBtYXkgY29tcGFyZVRvKCkgdGhlIHNhbWUsXHJcbiAgICAgICAgLy8gYnV0IHRoYXQgZG9lc24ndCBtYWtlIHRoZW0gZXF1YWwgdmlhIGlzRXF1YWwoKS5cclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBEb3VibGVWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVtZXJpY0VxdWFscyh0aGlzLmludGVybmFsVmFsdWUsIG90aGVyLmludGVybmFsVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEb3VibGVWYWx1ZS5OQU4gPSBuZXcgRG91YmxlVmFsdWUoTmFOKTtcclxuICAgIERvdWJsZVZhbHVlLlBPU0lUSVZFX0lORklOSVRZID0gbmV3IERvdWJsZVZhbHVlKEluZmluaXR5KTtcclxuICAgIERvdWJsZVZhbHVlLk5FR0FUSVZFX0lORklOSVRZID0gbmV3IERvdWJsZVZhbHVlKC1JbmZpbml0eSk7XHJcbiAgICByZXR1cm4gRG91YmxlVmFsdWU7XHJcbn0oTnVtYmVyVmFsdWUpKTtcclxuLy8gVE9ETyhiLzM3MjY3ODg1KTogQWRkIHRydW5jYXRpb24gc3VwcG9ydFxyXG52YXIgU3RyaW5nVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTdHJpbmdWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFN0cmluZ1ZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBpbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5TdHJpbmdWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBTdHJpbmdWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWU7XHJcbiAgICB9O1xyXG4gICAgU3RyaW5nVmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgU3RyaW5nVmFsdWUgJiYgdGhpcy5pbnRlcm5hbFZhbHVlID09PSBvdGhlci5pbnRlcm5hbFZhbHVlKTtcclxuICAgIH07XHJcbiAgICBTdHJpbmdWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgU3RyaW5nVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5pbnRlcm5hbFZhbHVlLCBvdGhlci5pbnRlcm5hbFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFN0cmluZ1ZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxudmFyIFRpbWVzdGFtcFZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoVGltZXN0YW1wVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBUaW1lc3RhbXBWYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuVGltZXN0YW1wVmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgVGltZXN0YW1wVmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnRpbWVzdGFtcHNJblNuYXBzaG90cykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZS50b0RhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVGltZXN0YW1wVmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgVGltZXN0YW1wVmFsdWUgJiZcclxuICAgICAgICAgICAgdGhpcy5pbnRlcm5hbFZhbHVlLmlzRXF1YWwob3RoZXIuaW50ZXJuYWxWYWx1ZSkpO1xyXG4gICAgfTtcclxuICAgIFRpbWVzdGFtcFZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBUaW1lc3RhbXBWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlLl9jb21wYXJlVG8ob3RoZXIuaW50ZXJuYWxWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG90aGVyIGluc3RhbmNlb2YgU2VydmVyVGltZXN0YW1wVmFsdWUpIHtcclxuICAgICAgICAgICAgLy8gQ29uY3JldGUgdGltZXN0YW1wcyBjb21lIGJlZm9yZSBzZXJ2ZXIgdGltZXN0YW1wcy5cclxuICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBUaW1lc3RhbXBWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgbG9jYWxseS1hcHBsaWVkIFNlcnZlclRpbWVzdGFtcC5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gU2VydmVyVGltZXN0YW1wVmFsdWUgaW5zdGFuY2VzIGFyZSBjcmVhdGVkIGFzIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYVxyXG4gKiAgIFRyYW5zZm9ybU11dGF0aW9uIChzZWUgVHJhbnNmb3JtTXV0YXRpb24uYXBwbHlUbygpKS4gVGhleSBjYW4gb25seSBleGlzdCBpblxyXG4gKiAgIHRoZSBsb2NhbCB2aWV3IG9mIGEgZG9jdW1lbnQuIFRoZXJlZm9yZSB0aGV5IGRvIG5vdCBuZWVkIHRvIGJlIHBhcnNlZCBvclxyXG4gKiAgIHNlcmlhbGl6ZWQuXHJcbiAqIC0gV2hlbiBldmFsdWF0ZWQgbG9jYWxseSAoZS5nLiBmb3Igc25hcHNob3QuZGF0YSgpKSwgdGhleSBieSBkZWZhdWx0XHJcbiAqICAgZXZhbHVhdGUgdG8gYG51bGxgLiBUaGlzIGJlaGF2aW9yIGNhbiBiZSBjb25maWd1cmVkIGJ5IHBhc3NpbmcgY3VzdG9tXHJcbiAqICAgRmllbGRWYWx1ZU9wdGlvbnMgdG8gdmFsdWUoKS5cclxuICogLSBXaXRoIHJlc3BlY3QgdG8gb3RoZXIgU2VydmVyVGltZXN0YW1wVmFsdWVzLCB0aGV5IHNvcnQgYnkgdGhlaXJcclxuICogICBsb2NhbFdyaXRlVGltZS5cclxuICovXHJcbnZhciBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFNlcnZlclRpbWVzdGFtcFZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU2VydmVyVGltZXN0YW1wVmFsdWUobG9jYWxXcml0ZVRpbWUsIHByZXZpb3VzVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmxvY2FsV3JpdGVUaW1lID0gbG9jYWxXcml0ZVRpbWU7XHJcbiAgICAgICAgX3RoaXMucHJldmlvdXNWYWx1ZSA9IHByZXZpb3VzVmFsdWU7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLlRpbWVzdGFtcFZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFNlcnZlclRpbWVzdGFtcFZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgJiZcclxuICAgICAgICAgICAgb3B0aW9ucy5zZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvciA9PT0gU2VydmVyVGltZXN0YW1wQmVoYXZpb3IuRXN0aW1hdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaW1lc3RhbXBWYWx1ZSh0aGlzLmxvY2FsV3JpdGVUaW1lKS52YWx1ZShvcHRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAob3B0aW9ucyAmJlxyXG4gICAgICAgICAgICBvcHRpb25zLnNlcnZlclRpbWVzdGFtcEJlaGF2aW9yID09PSBTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvci5QcmV2aW91cykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcmV2aW91c1ZhbHVlID8gdGhpcy5wcmV2aW91c1ZhbHVlLnZhbHVlKG9wdGlvbnMpIDogbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAmJlxyXG4gICAgICAgICAgICB0aGlzLmxvY2FsV3JpdGVUaW1lLmlzRXF1YWwob3RoZXIubG9jYWxXcml0ZVRpbWUpKTtcclxuICAgIH07XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgU2VydmVyVGltZXN0YW1wVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxXcml0ZVRpbWUuX2NvbXBhcmVUbyhvdGhlci5sb2NhbFdyaXRlVGltZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG90aGVyIGluc3RhbmNlb2YgVGltZXN0YW1wVmFsdWUpIHtcclxuICAgICAgICAgICAgLy8gU2VydmVyIHRpbWVzdGFtcHMgY29tZSBhZnRlciBhbGwgY29uY3JldGUgdGltZXN0YW1wcy5cclxuICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2VydmVyVGltZXN0YW1wVmFsdWUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAnPFNlcnZlclRpbWVzdGFtcCBsb2NhbFRpbWU9JyArIHRoaXMubG9jYWxXcml0ZVRpbWUudG9TdHJpbmcoKSArICc+JztcclxuICAgIH07XHJcbiAgICByZXR1cm4gU2VydmVyVGltZXN0YW1wVmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG52YXIgQmxvYlZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQmxvYlZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQmxvYlZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBpbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5CbG9iVmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgQmxvYlZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZTtcclxuICAgIH07XHJcbiAgICBCbG9iVmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgQmxvYlZhbHVlICYmXHJcbiAgICAgICAgICAgIHRoaXMuaW50ZXJuYWxWYWx1ZS5pc0VxdWFsKG90aGVyLmludGVybmFsVmFsdWUpKTtcclxuICAgIH07XHJcbiAgICBCbG9iVmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIEJsb2JWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlLl9jb21wYXJlVG8ob3RoZXIuaW50ZXJuYWxWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBCbG9iVmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG52YXIgUmVmVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhSZWZWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFJlZlZhbHVlKGRhdGFiYXNlSWQsIGtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuZGF0YWJhc2VJZCA9IGRhdGFiYXNlSWQ7XHJcbiAgICAgICAgX3RoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5SZWZWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBSZWZWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmtleTtcclxuICAgIH07XHJcbiAgICBSZWZWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIFJlZlZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5rZXkuaXNFcXVhbChvdGhlci5rZXkpICYmIHRoaXMuZGF0YWJhc2VJZC5pc0VxdWFsKG90aGVyLmRhdGFiYXNlSWQpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVmVmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIFJlZlZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBjbXAgPSB0aGlzLmRhdGFiYXNlSWQuY29tcGFyZVRvKG90aGVyLmRhdGFiYXNlSWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gY21wICE9PSAwID8gY21wIDogRG9jdW1lbnRLZXkuY29tcGFyYXRvcih0aGlzLmtleSwgb3RoZXIua2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlZlZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxudmFyIEdlb1BvaW50VmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhHZW9Qb2ludFZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gR2VvUG9pbnRWYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuR2VvUG9pbnRWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBHZW9Qb2ludFZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZTtcclxuICAgIH07XHJcbiAgICBHZW9Qb2ludFZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIEdlb1BvaW50VmFsdWUgJiZcclxuICAgICAgICAgICAgdGhpcy5pbnRlcm5hbFZhbHVlLmlzRXF1YWwob3RoZXIuaW50ZXJuYWxWYWx1ZSkpO1xyXG4gICAgfTtcclxuICAgIEdlb1BvaW50VmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIEdlb1BvaW50VmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZS5fY29tcGFyZVRvKG90aGVyLmludGVybmFsVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gR2VvUG9pbnRWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbnZhciBPYmplY3RWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKE9iamVjdFZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gT2JqZWN0VmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IGludGVybmFsVmFsdWU7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLk9iamVjdFZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuaW50ZXJuYWxWYWx1ZS5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChrZXksIHZhbCkge1xyXG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbC52YWx1ZShvcHRpb25zKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgIHRoaXMuaW50ZXJuYWxWYWx1ZS5pbm9yZGVyVHJhdmVyc2FsKGFjdGlvbik7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBPYmplY3RWYWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgaXQxID0gdGhpcy5pbnRlcm5hbFZhbHVlLmdldEl0ZXJhdG9yKCk7XHJcbiAgICAgICAgICAgIHZhciBpdDIgPSBvdGhlci5pbnRlcm5hbFZhbHVlLmdldEl0ZXJhdG9yKCk7XHJcbiAgICAgICAgICAgIHdoaWxlIChpdDEuaGFzTmV4dCgpICYmIGl0Mi5oYXNOZXh0KCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuZXh0MSA9IGl0MS5nZXROZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dDIgPSBpdDIuZ2V0TmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5leHQxLmtleSAhPT0gbmV4dDIua2V5IHx8ICFuZXh0MS52YWx1ZS5pc0VxdWFsKG5leHQyLnZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gIWl0MS5oYXNOZXh0KCkgJiYgIWl0Mi5oYXNOZXh0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgT2JqZWN0VmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGl0MSA9IHRoaXMuaW50ZXJuYWxWYWx1ZS5nZXRJdGVyYXRvcigpO1xyXG4gICAgICAgICAgICB2YXIgaXQyID0gb3RoZXIuaW50ZXJuYWxWYWx1ZS5nZXRJdGVyYXRvcigpO1xyXG4gICAgICAgICAgICB3aGlsZSAoaXQxLmhhc05leHQoKSAmJiBpdDIuaGFzTmV4dCgpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dDEgPSBpdDEuZ2V0TmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5leHQyID0gaXQyLmdldE5leHQoKTtcclxuICAgICAgICAgICAgICAgIHZhciBjbXAgPSBwcmltaXRpdmVDb21wYXJhdG9yKG5leHQxLmtleSwgbmV4dDIua2V5KSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIG5leHQxLnZhbHVlLmNvbXBhcmVUbyhuZXh0Mi52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY21wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNtcDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBPbmx5IGVxdWFsIGlmIGJvdGggaXRlcmF0b3JzIGFyZSBleGhhdXN0ZWRcclxuICAgICAgICAgICAgcmV0dXJuIHByaW1pdGl2ZUNvbXBhcmF0b3IoaXQxLmhhc05leHQoKSwgaXQyLmhhc05leHQoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChwYXRoLCB0bykge1xyXG4gICAgICAgIGFzc2VydCghcGF0aC5pc0VtcHR5KCksICdDYW5ub3Qgc2V0IGZpZWxkIGZvciBlbXB0eSBwYXRoIG9uIE9iamVjdFZhbHVlJyk7XHJcbiAgICAgICAgaWYgKHBhdGgubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldENoaWxkKHBhdGguZmlyc3RTZWdtZW50KCksIHRvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IHRoaXMuY2hpbGQocGF0aC5maXJzdFNlZ21lbnQoKSk7XHJcbiAgICAgICAgICAgIGlmICghKGNoaWxkIGluc3RhbmNlb2YgT2JqZWN0VmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZCA9IE9iamVjdFZhbHVlLkVNUFRZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBuZXdDaGlsZCA9IGNoaWxkLnNldChwYXRoLnBvcEZpcnN0KCksIHRvKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0Q2hpbGQocGF0aC5maXJzdFNlZ21lbnQoKSwgbmV3Q2hpbGQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICBhc3NlcnQoIXBhdGguaXNFbXB0eSgpLCAnQ2Fubm90IGRlbGV0ZSBmaWVsZCBmb3IgZW1wdHkgcGF0aCBvbiBPYmplY3RWYWx1ZScpO1xyXG4gICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IE9iamVjdFZhbHVlKHRoaXMuaW50ZXJuYWxWYWx1ZS5yZW1vdmUocGF0aC5maXJzdFNlZ21lbnQoKSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gbmVzdGVkIGZpZWxkXHJcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IHRoaXMuY2hpbGQocGF0aC5maXJzdFNlZ21lbnQoKSk7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIE9iamVjdFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3Q2hpbGQgPSBjaGlsZC5kZWxldGUocGF0aC5wb3BGaXJzdCgpKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT2JqZWN0VmFsdWUodGhpcy5pbnRlcm5hbFZhbHVlLmluc2VydChwYXRoLmZpcnN0U2VnbWVudCgpLCBuZXdDaGlsZCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgYWN0dWFsbHkgY2hhbmdlIGEgcHJpbWl0aXZlIHZhbHVlIHRvIGFuIG9iamVjdCBmb3IgYSBkZWxldGVcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS5jb250YWlucyA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQocGF0aCkgIT09IHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUuZmllbGQgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIGFzc2VydCghcGF0aC5pc0VtcHR5KCksIFwiQ2FuJ3QgZ2V0IGZpZWxkIG9mIGVtcHR5IHBhdGhcIik7XHJcbiAgICAgICAgdmFyIGZpZWxkID0gdGhpcztcclxuICAgICAgICBwYXRoLmZvckVhY2goZnVuY3Rpb24gKHBhdGhTZWdtZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChmaWVsZCBpbnN0YW5jZW9mIE9iamVjdFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZCA9IGZpZWxkLmludGVybmFsVmFsdWUuZ2V0KHBhdGhTZWdtZW50KSB8fCB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBmaWVsZDtcclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMudmFsdWUoKSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLmNoaWxkID0gZnVuY3Rpb24gKGNoaWxkTmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWUuZ2V0KGNoaWxkTmFtZSkgfHwgdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS5zZXRDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBPYmplY3RWYWx1ZSh0aGlzLmludGVybmFsVmFsdWUuaW5zZXJ0KGNoaWxkTmFtZSwgdmFsdWUpKTtcclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5FTVBUWSA9IG5ldyBPYmplY3RWYWx1ZShuZXcgU29ydGVkTWFwKHByaW1pdGl2ZUNvbXBhcmF0b3IpKTtcclxuICAgIHJldHVybiBPYmplY3RWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbnZhciBBcnJheVZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQXJyYXlWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEFycmF5VmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IGludGVybmFsVmFsdWU7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLkFycmF5VmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgQXJyYXlWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWUubWFwKGZ1bmN0aW9uICh2KSB7IHJldHVybiB2LnZhbHVlKG9wdGlvbnMpOyB9KTtcclxuICAgIH07XHJcbiAgICBBcnJheVZhbHVlLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgIHRoaXMuaW50ZXJuYWxWYWx1ZS5mb3JFYWNoKGFjdGlvbik7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIEFycmF5VmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaW50ZXJuYWxWYWx1ZS5sZW5ndGggIT09IG90aGVyLmludGVybmFsVmFsdWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmludGVybmFsVmFsdWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbnRlcm5hbFZhbHVlW2ldLmlzRXF1YWwob3RoZXIuaW50ZXJuYWxWYWx1ZVtpXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBBcnJheVZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBBcnJheVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBtaW5MZW5ndGggPSBNYXRoLm1pbih0aGlzLmludGVybmFsVmFsdWUubGVuZ3RoLCBvdGhlci5pbnRlcm5hbFZhbHVlLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWluTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbXAgPSB0aGlzLmludGVybmFsVmFsdWVbaV0uY29tcGFyZVRvKG90aGVyLmludGVybmFsVmFsdWVbaV0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNtcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjbXA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5pbnRlcm5hbFZhbHVlLmxlbmd0aCwgb3RoZXIuaW50ZXJuYWxWYWx1ZS5sZW5ndGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEFycmF5VmFsdWUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnZhbHVlKCkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBcnJheVZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIFVudHlwZWQgTnVtYmVyIGFsaWFzIHdlIGNhbiB1c2UgdG8gY2hlY2sgZm9yIEVTNiBtZXRob2RzIC8gcHJvcGVydGllcy5cclxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSB2YXJpYWJsZS1uYW1lXHJcbnZhciBOdW1iZXJBc0FueSA9IE51bWJlcjtcclxuLyoqXHJcbiAqIE1pbmltdW0gc2FmZSBpbnRlZ2VyIGluIEphdmFzY3JpcHQgYmVjYXVzZSBvZiBmbG9hdGluZyBwb2ludCBwcmVjaXNpb24uXHJcbiAqIEFkZGVkIHRvIG5vdCByZWx5IG9uIEVTNiBmZWF0dXJlcy5cclxuICovXHJcbnZhciBNSU5fU0FGRV9JTlRFR0VSID0gTnVtYmVyQXNBbnkuTUlOX1NBRkVfSU5URUdFUiB8fCAtKE1hdGgucG93KDIsIDUzKSAtIDEpO1xyXG4vKipcclxuICogTWF4aW11bSBzYWZlIGludGVnZXIgaW4gSmF2YXNjcmlwdCBiZWNhdXNlIG9mIGZsb2F0aW5nIHBvaW50IHByZWNpc2lvbi5cclxuICogQWRkZWQgdG8gbm90IHJlbHkgb24gRVM2IGZlYXR1cmVzLlxyXG4gKi9cclxudmFyIE1BWF9TQUZFX0lOVEVHRVIgPSBOdW1iZXJBc0FueS5NQVhfU0FGRV9JTlRFR0VSIHx8IE1hdGgucG93KDIsIDUzKSAtIDE7XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHdoZXRoZXIgYW4gbnVtYmVyIGlzIGFuIGludGVnZXIsIHVzZXMgbmF0aXZlIGltcGxlbWVudGF0aW9uIGlmXHJcbiAqIGF2YWlsYWJsZS5cclxuICogQWRkZWQgdG8gbm90IHJlbHkgb24gRVM2IGZlYXR1cmVzLlxyXG4gKiBAcGFyYW0gdmFsdWUgVGhlIHZhbHVlIHRvIHRlc3QgZm9yIGJlaW5nIGFuIGludGVnZXJcclxuICovXHJcbnZhciBpc0ludGVnZXIgPSBOdW1iZXJBc0FueS5pc0ludGVnZXIgfHxcclxuICAgIChmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJlxyXG4gICAgICAgICAgICBpc0Zpbml0ZSh2YWx1ZSkgJiZcclxuICAgICAgICAgICAgTWF0aC5mbG9vcih2YWx1ZSkgPT09IHZhbHVlO1xyXG4gICAgfSk7XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHdoZXRoZXIgYSB2YXJpYWJsZSBpcyBlaXRoZXIgdW5kZWZpbmVkIG9yIG51bGwuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc051bGxPclVuZGVmaW5lZCh2YWx1ZSkge1xyXG4gICAgcmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQ7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgd2hldGhlciBhIHZhbHVlIGlzIGFuIGludGVnZXIgYW5kIGluIHRoZSBzYWZlIGludGVnZXIgcmFuZ2VcclxuICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0byB0ZXN0IGZvciBiZWluZyBhbiBpbnRlZ2VyIGFuZCBpbiB0aGUgc2FmZSByYW5nZVxyXG4gKi9cclxuZnVuY3Rpb24gaXNTYWZlSW50ZWdlcih2YWx1ZSkge1xyXG4gICAgcmV0dXJuIChpc0ludGVnZXIodmFsdWUpICYmXHJcbiAgICAgICAgdmFsdWUgPD0gTUFYX1NBRkVfSU5URUdFUiAmJlxyXG4gICAgICAgIHZhbHVlID49IE1JTl9TQUZFX0lOVEVHRVIpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgUXVlcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBRdWVyeShwYXRoLCBleHBsaWNpdE9yZGVyQnksIGZpbHRlcnMsIGxpbWl0LCBzdGFydEF0LCBlbmRBdCkge1xyXG4gICAgICAgIGlmIChleHBsaWNpdE9yZGVyQnkgPT09IHZvaWQgMCkgeyBleHBsaWNpdE9yZGVyQnkgPSBbXTsgfVxyXG4gICAgICAgIGlmIChmaWx0ZXJzID09PSB2b2lkIDApIHsgZmlsdGVycyA9IFtdOyB9XHJcbiAgICAgICAgaWYgKGxpbWl0ID09PSB2b2lkIDApIHsgbGltaXQgPSBudWxsOyB9XHJcbiAgICAgICAgaWYgKHN0YXJ0QXQgPT09IHZvaWQgMCkgeyBzdGFydEF0ID0gbnVsbDsgfVxyXG4gICAgICAgIGlmIChlbmRBdCA9PT0gdm9pZCAwKSB7IGVuZEF0ID0gbnVsbDsgfVxyXG4gICAgICAgIHRoaXMucGF0aCA9IHBhdGg7XHJcbiAgICAgICAgdGhpcy5leHBsaWNpdE9yZGVyQnkgPSBleHBsaWNpdE9yZGVyQnk7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJzID0gZmlsdGVycztcclxuICAgICAgICB0aGlzLmxpbWl0ID0gbGltaXQ7XHJcbiAgICAgICAgdGhpcy5zdGFydEF0ID0gc3RhcnRBdDtcclxuICAgICAgICB0aGlzLmVuZEF0ID0gZW5kQXQ7XHJcbiAgICAgICAgdGhpcy5tZW1vaXplZENhbm9uaWNhbElkID0gbnVsbDtcclxuICAgICAgICB0aGlzLm1lbW9pemVkT3JkZXJCeSA9IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRBdCkge1xyXG4gICAgICAgICAgICB0aGlzLmFzc2VydFZhbGlkQm91bmQodGhpcy5zdGFydEF0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZW5kQXQpIHtcclxuICAgICAgICAgICAgdGhpcy5hc3NlcnRWYWxpZEJvdW5kKHRoaXMuZW5kQXQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFF1ZXJ5LmF0UGF0aCA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeShwYXRoKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUXVlcnkucHJvdG90eXBlLCBcIm9yZGVyQnlcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tZW1vaXplZE9yZGVyQnkgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbmVxdWFsaXR5RmllbGQgPSB0aGlzLmdldEluZXF1YWxpdHlGaWx0ZXJGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0T3JkZXJCeUZpZWxkID0gdGhpcy5nZXRGaXJzdE9yZGVyQnlGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZXF1YWxpdHlGaWVsZCAhPT0gbnVsbCAmJiBmaXJzdE9yZGVyQnlGaWVsZCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEluIG9yZGVyIHRvIGltcGxpY2l0bHkgYWRkIGtleSBvcmRlcmluZywgd2UgbXVzdCBhbHNvIGFkZCB0aGVcclxuICAgICAgICAgICAgICAgICAgICAvLyBpbmVxdWFsaXR5IGZpbHRlciBmaWVsZCBmb3IgaXQgdG8gYmUgYSB2YWxpZCBxdWVyeS5cclxuICAgICAgICAgICAgICAgICAgICAvLyBOb3RlIHRoYXQgdGhlIGRlZmF1bHQgaW5lcXVhbGl0eSBmaWVsZCBhbmQga2V5IG9yZGVyaW5nIGlzIGFzY2VuZGluZy5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5lcXVhbGl0eUZpZWxkLmlzS2V5RmllbGQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbW9pemVkT3JkZXJCeSA9IFtLRVlfT1JERVJJTkdfQVNDXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVtb2l6ZWRPcmRlckJ5ID0gW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE9yZGVyQnkoaW5lcXVhbGl0eUZpZWxkKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtFWV9PUkRFUklOR19BU0NcclxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoaW5lcXVhbGl0eUZpZWxkID09PSBudWxsIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChmaXJzdE9yZGVyQnlGaWVsZCAhPT0gbnVsbCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5lcXVhbGl0eUZpZWxkLmlzRXF1YWwoZmlyc3RPcmRlckJ5RmllbGQpKSwgJ0ZpcnN0IG9yZGVyQnkgc2hvdWxkIG1hdGNoIGluZXF1YWxpdHkgZmllbGQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW1vaXplZE9yZGVyQnkgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmRLZXlPcmRlcmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmV4cGxpY2l0T3JkZXJCeTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9yZGVyQnkgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVtb2l6ZWRPcmRlckJ5LnB1c2gob3JkZXJCeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcmRlckJ5LmZpZWxkLmlzS2V5RmllbGQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRLZXlPcmRlcmluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZEtleU9yZGVyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBvcmRlciBvZiB0aGUgaW1wbGljaXQga2V5IG9yZGVyaW5nIGFsd2F5cyBtYXRjaGVzIHRoZSBsYXN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV4cGxpY2l0IG9yZGVyIGJ5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXN0RGlyZWN0aW9uID0gdGhpcy5leHBsaWNpdE9yZGVyQnkubGVuZ3RoID4gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLmV4cGxpY2l0T3JkZXJCeVt0aGlzLmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggLSAxXS5kaXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogRGlyZWN0aW9uLkFTQ0VORElORztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW1vaXplZE9yZGVyQnkucHVzaChsYXN0RGlyZWN0aW9uID09PSBEaXJlY3Rpb24uQVNDRU5ESU5HXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IEtFWV9PUkRFUklOR19BU0NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogS0VZX09SREVSSU5HX0RFU0MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZW1vaXplZE9yZGVyQnk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuYWRkRmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmdldEluZXF1YWxpdHlGaWx0ZXJGaWVsZCgpID09IG51bGwgfHxcclxuICAgICAgICAgICAgIShmaWx0ZXIgaW5zdGFuY2VvZiBSZWxhdGlvbkZpbHRlcikgfHxcclxuICAgICAgICAgICAgIWZpbHRlci5pc0luZXF1YWxpdHkoKSB8fFxyXG4gICAgICAgICAgICBmaWx0ZXIuZmllbGQuaXNFcXVhbCh0aGlzLmdldEluZXF1YWxpdHlGaWx0ZXJGaWVsZCgpKSwgJ1F1ZXJ5IG11c3Qgb25seSBoYXZlIG9uZSBpbmVxdWFsaXR5IGZpZWxkLicpO1xyXG4gICAgICAgIGFzc2VydCghRG9jdW1lbnRLZXkuaXNEb2N1bWVudEtleSh0aGlzLnBhdGgpLCAnTm8gZmlsdGVyaW5nIGFsbG93ZWQgZm9yIGRvY3VtZW50IHF1ZXJ5Jyk7XHJcbiAgICAgICAgdmFyIG5ld0ZpbHRlcnMgPSB0aGlzLmZpbHRlcnMuY29uY2F0KFtmaWx0ZXJdKTtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucGF0aCwgdGhpcy5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgbmV3RmlsdGVycywgdGhpcy5saW1pdCwgdGhpcy5zdGFydEF0LCB0aGlzLmVuZEF0KTtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuYWRkT3JkZXJCeSA9IGZ1bmN0aW9uIChvcmRlckJ5KSB7XHJcbiAgICAgICAgYXNzZXJ0KCFEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5KHRoaXMucGF0aCksICdObyBvcmRlcmluZyBhbGxvd2VkIGZvciBkb2N1bWVudCBxdWVyeScpO1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5zdGFydEF0ICYmICF0aGlzLmVuZEF0LCAnQm91bmRzIG11c3QgYmUgc2V0IGFmdGVyIG9yZGVyQnknKTtcclxuICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IHZhbGlkYXRlIHRoYXQgb3JkZXJCeSBkb2VzIG5vdCBsaXN0IHRoZSBzYW1lIGtleSB0d2ljZS5cclxuICAgICAgICB2YXIgbmV3T3JkZXJCeSA9IHRoaXMuZXhwbGljaXRPcmRlckJ5LmNvbmNhdChbb3JkZXJCeV0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkodGhpcy5wYXRoLCBuZXdPcmRlckJ5LCB0aGlzLmZpbHRlcnMuc2xpY2UoKSwgdGhpcy5saW1pdCwgdGhpcy5zdGFydEF0LCB0aGlzLmVuZEF0KTtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUud2l0aExpbWl0ID0gZnVuY3Rpb24gKGxpbWl0KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSh0aGlzLnBhdGgsIHRoaXMuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIHRoaXMuZmlsdGVycy5zbGljZSgpLCBsaW1pdCwgdGhpcy5zdGFydEF0LCB0aGlzLmVuZEF0KTtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUud2l0aFN0YXJ0QXQgPSBmdW5jdGlvbiAoYm91bmQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucGF0aCwgdGhpcy5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdGhpcy5maWx0ZXJzLnNsaWNlKCksIHRoaXMubGltaXQsIGJvdW5kLCB0aGlzLmVuZEF0KTtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUud2l0aEVuZEF0ID0gZnVuY3Rpb24gKGJvdW5kKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSh0aGlzLnBhdGgsIHRoaXMuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIHRoaXMuZmlsdGVycy5zbGljZSgpLCB0aGlzLmxpbWl0LCB0aGlzLnN0YXJ0QXQsIGJvdW5kKTtcclxuICAgIH07XHJcbiAgICAvLyBUT0RPKGIvMjkxODMxNjUpOiBUaGlzIGlzIHVzZWQgdG8gZ2V0IGEgdW5pcXVlIHN0cmluZyBmcm9tIGEgcXVlcnkgdG8sIGZvclxyXG4gICAgLy8gZXhhbXBsZSwgdXNlIGFzIGEgZGljdGlvbmFyeSBrZXksIGJ1dCB0aGUgaW1wbGVtZW50YXRpb24gaXMgc3ViamVjdCB0b1xyXG4gICAgLy8gY29sbGlzaW9ucy4gTWFrZSBpdCBjb2xsaXNpb24tZnJlZS5cclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5jYW5vbmljYWxJZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5tZW1vaXplZENhbm9uaWNhbElkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciBjYW5vbmljYWxJZCA9IHRoaXMucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcclxuICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gJ3xmOic7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmZpbHRlcnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmlsdGVyID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gZmlsdGVyLmNhbm9uaWNhbElkKCk7XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSAnLCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gJ3xvYjonO1xyXG4gICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IG1ha2UgdGhpcyBjb2xsaXNpb24gcmVzaXN0YW50XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gMCwgX2MgPSB0aGlzLm9yZGVyQnk7IF9iIDwgX2MubGVuZ3RoOyBfYisrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3JkZXJCeSA9IF9jW19iXTtcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9IG9yZGVyQnkuY2Fub25pY2FsSWQoKTtcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9ICcsJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubGltaXQpKSB7XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSAnfGw6JztcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9IHRoaXMubGltaXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhcnRBdCkge1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gJ3xsYjonO1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gdGhpcy5zdGFydEF0LmNhbm9uaWNhbElkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZW5kQXQpIHtcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9ICd8dWI6JztcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9IHRoaXMuZW5kQXQuY2Fub25pY2FsSWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm1lbW9pemVkQ2Fub25pY2FsSWQgPSBjYW5vbmljYWxJZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWVtb2l6ZWRDYW5vbmljYWxJZDtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHN0ciA9ICdRdWVyeSgnICsgdGhpcy5wYXRoLmNhbm9uaWNhbFN0cmluZygpO1xyXG4gICAgICAgIGlmICh0aGlzLmZpbHRlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBzdHIgKz0gXCIsIGZpbHRlcnM6IFtcIiArIHRoaXMuZmlsdGVycy5qb2luKCcsICcpICsgXCJdXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5saW1pdCkpIHtcclxuICAgICAgICAgICAgc3RyICs9ICcsIGxpbWl0OiAnICsgdGhpcy5saW1pdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgc3RyICs9IFwiLCBvcmRlckJ5OiBbXCIgKyB0aGlzLmV4cGxpY2l0T3JkZXJCeS5qb2luKCcsICcpICsgXCJdXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnN0YXJ0QXQpIHtcclxuICAgICAgICAgICAgc3RyICs9ICcsIHN0YXJ0QXQ6ICcgKyB0aGlzLnN0YXJ0QXQuY2Fub25pY2FsSWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZW5kQXQpIHtcclxuICAgICAgICAgICAgc3RyICs9ICcsIGVuZEF0OiAnICsgdGhpcy5lbmRBdC5jYW5vbmljYWxJZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyICsgJyknO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubGltaXQgIT09IG90aGVyLmxpbWl0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMub3JkZXJCeS5sZW5ndGggIT09IG90aGVyLm9yZGVyQnkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm9yZGVyQnkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLm9yZGVyQnlbaV0uaXNFcXVhbChvdGhlci5vcmRlckJ5W2ldKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmZpbHRlcnMubGVuZ3RoICE9PSBvdGhlci5maWx0ZXJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5maWx0ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5maWx0ZXJzW2ldLmlzRXF1YWwob3RoZXIuZmlsdGVyc1tpXSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMucGF0aC5pc0VxdWFsKG90aGVyLnBhdGgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRBdCAhPT0gbnVsbFxyXG4gICAgICAgICAgICA/ICF0aGlzLnN0YXJ0QXQuaXNFcXVhbChvdGhlci5zdGFydEF0KVxyXG4gICAgICAgICAgICA6IG90aGVyLnN0YXJ0QXQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5lbmRBdCAhPT0gbnVsbFxyXG4gICAgICAgICAgICA/IHRoaXMuZW5kQXQuaXNFcXVhbChvdGhlci5lbmRBdClcclxuICAgICAgICAgICAgOiBvdGhlci5lbmRBdCA9PT0gbnVsbDtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuZG9jQ29tcGFyYXRvciA9IGZ1bmN0aW9uIChkMSwgZDIpIHtcclxuICAgICAgICB2YXIgY29tcGFyZWRPbktleUZpZWxkID0gZmFsc2U7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMub3JkZXJCeTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG9yZGVyQnkgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIHZhciBjb21wID0gb3JkZXJCeS5jb21wYXJlKGQxLCBkMik7XHJcbiAgICAgICAgICAgIGlmIChjb21wICE9PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXA7XHJcbiAgICAgICAgICAgIGNvbXBhcmVkT25LZXlGaWVsZCA9IGNvbXBhcmVkT25LZXlGaWVsZCB8fCBvcmRlckJ5LmZpZWxkLmlzS2V5RmllbGQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQXNzZXJ0IHRoYXQgd2UgYWN0dWFsbHkgY29tcGFyZWQgYnkga2V5XHJcbiAgICAgICAgYXNzZXJ0KGNvbXBhcmVkT25LZXlGaWVsZCwgXCJvcmRlckJ5IHVzZWQgdGhhdCBkb2Vzbid0IGNvbXBhcmUgb24ga2V5IGZpZWxkXCIpO1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5tYXRjaGVzID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5tYXRjaGVzQW5jZXN0b3IoZG9jKSAmJlxyXG4gICAgICAgICAgICB0aGlzLm1hdGNoZXNPcmRlckJ5KGRvYykgJiZcclxuICAgICAgICAgICAgdGhpcy5tYXRjaGVzRmlsdGVycyhkb2MpICYmXHJcbiAgICAgICAgICAgIHRoaXMubWF0Y2hlc0JvdW5kcyhkb2MpKTtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuaGFzTGltaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICFpc051bGxPclVuZGVmaW5lZCh0aGlzLmxpbWl0KTtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuZ2V0Rmlyc3RPcmRlckJ5RmllbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDBcclxuICAgICAgICAgICAgPyB0aGlzLmV4cGxpY2l0T3JkZXJCeVswXS5maWVsZFxyXG4gICAgICAgICAgICA6IG51bGw7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmdldEluZXF1YWxpdHlGaWx0ZXJGaWVsZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5maWx0ZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZmlsdGVyID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBpZiAoZmlsdGVyIGluc3RhbmNlb2YgUmVsYXRpb25GaWx0ZXIgJiYgZmlsdGVyLmlzSW5lcXVhbGl0eSgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyLmZpZWxkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5oYXNBcnJheUNvbnRhaW5zRmlsdGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5maWx0ZXJzLmZpbmQoZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyIGluc3RhbmNlb2YgUmVsYXRpb25GaWx0ZXIgJiZcclxuICAgICAgICAgICAgICAgIGZpbHRlci5vcCA9PT0gUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUztcclxuICAgICAgICB9KSAhPT0gdW5kZWZpbmVkKTtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuaXNEb2N1bWVudFF1ZXJ5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5KHRoaXMucGF0aCkgJiYgdGhpcy5maWx0ZXJzLmxlbmd0aCA9PT0gMDtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUubWF0Y2hlc0FuY2VzdG9yID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIHZhciBkb2NQYXRoID0gZG9jLmtleS5wYXRoO1xyXG4gICAgICAgIGlmIChEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5KHRoaXMucGF0aCkpIHtcclxuICAgICAgICAgICAgLy8gZXhhY3QgbWF0Y2ggZm9yIGRvY3VtZW50IHF1ZXJpZXNcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGF0aC5pc0VxdWFsKGRvY1BhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gc2hhbGxvdyBhbmNlc3RvciBxdWVyaWVzIGJ5IGRlZmF1bHRcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLnBhdGguaXNQcmVmaXhPZihkb2NQYXRoKSAmJiB0aGlzLnBhdGgubGVuZ3RoID09PSBkb2NQYXRoLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEEgZG9jdW1lbnQgbXVzdCBoYXZlIGEgdmFsdWUgZm9yIGV2ZXJ5IG9yZGVyaW5nIGNsYXVzZSBpbiBvcmRlciB0byBzaG93IHVwXHJcbiAgICAgKiBpbiB0aGUgcmVzdWx0cy5cclxuICAgICAqL1xyXG4gICAgUXVlcnkucHJvdG90eXBlLm1hdGNoZXNPcmRlckJ5ID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmV4cGxpY2l0T3JkZXJCeTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG9yZGVyQnkgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIC8vIG9yZGVyIGJ5IGtleSBhbHdheXMgbWF0Y2hlc1xyXG4gICAgICAgICAgICBpZiAoIW9yZGVyQnkuZmllbGQuaXNLZXlGaWVsZCgpICYmXHJcbiAgICAgICAgICAgICAgICBkb2MuZmllbGQob3JkZXJCeS5maWVsZCkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5tYXRjaGVzRmlsdGVycyA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5maWx0ZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZmlsdGVyID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBpZiAoIWZpbHRlci5tYXRjaGVzKGRvYykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIE1ha2VzIHN1cmUgYSBkb2N1bWVudCBpcyB3aXRoaW4gdGhlIGJvdW5kcywgaWYgcHJvdmlkZWQuXHJcbiAgICAgKi9cclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5tYXRjaGVzQm91bmRzID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXJ0QXQgJiYgIXRoaXMuc3RhcnRBdC5zb3J0c0JlZm9yZURvY3VtZW50KHRoaXMub3JkZXJCeSwgZG9jKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmVuZEF0ICYmIHRoaXMuZW5kQXQuc29ydHNCZWZvcmVEb2N1bWVudCh0aGlzLm9yZGVyQnksIGRvYykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuYXNzZXJ0VmFsaWRCb3VuZCA9IGZ1bmN0aW9uIChib3VuZCkge1xyXG4gICAgICAgIGFzc2VydChib3VuZC5wb3NpdGlvbi5sZW5ndGggPD0gdGhpcy5vcmRlckJ5Lmxlbmd0aCwgJ0JvdW5kIGlzIGxvbmdlciB0aGFuIG9yZGVyQnknKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUXVlcnk7XHJcbn0oKSk7XHJcbnZhciBGaWx0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaWx0ZXIoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBmaWx0ZXIgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGFyZ3VtZW50cy5cclxuICAgICAqL1xyXG4gICAgRmlsdGVyLmNyZWF0ZSA9IGZ1bmN0aW9uIChmaWVsZCwgb3AsIHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlLmlzRXF1YWwoTnVsbFZhbHVlLklOU1RBTkNFKSkge1xyXG4gICAgICAgICAgICBpZiAob3AgIT09IFJlbGF0aW9uT3AuRVFVQUwpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdJbnZhbGlkIHF1ZXJ5LiBZb3UgY2FuIG9ubHkgcGVyZm9ybSBlcXVhbHMgY29tcGFyaXNvbnMgb24gbnVsbC4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IE51bGxGaWx0ZXIoZmllbGQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZS5pc0VxdWFsKERvdWJsZVZhbHVlLk5BTikpIHtcclxuICAgICAgICAgICAgaWYgKG9wICE9PSBSZWxhdGlvbk9wLkVRVUFMKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnSW52YWxpZCBxdWVyeS4gWW91IGNhbiBvbmx5IHBlcmZvcm0gZXF1YWxzIGNvbXBhcmlzb25zIG9uIE5hTi4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IE5hbkZpbHRlcihmaWVsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlbGF0aW9uRmlsdGVyKGZpZWxkLCBvcCwgdmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gRmlsdGVyO1xyXG59KCkpO1xyXG52YXIgUmVsYXRpb25PcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlbGF0aW9uT3AobmFtZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB9XHJcbiAgICBSZWxhdGlvbk9wLmZyb21TdHJpbmcgPSBmdW5jdGlvbiAob3ApIHtcclxuICAgICAgICBzd2l0Y2ggKG9wKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJzwnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuTEVTU19USEFOO1xyXG4gICAgICAgICAgICBjYXNlICc8PSc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5MRVNTX1RIQU5fT1JfRVFVQUw7XHJcbiAgICAgICAgICAgIGNhc2UgJz09JzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkVRVUFMO1xyXG4gICAgICAgICAgICBjYXNlICc+PSc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5HUkVBVEVSX1RIQU5fT1JfRVFVQUw7XHJcbiAgICAgICAgICAgIGNhc2UgJz4nOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuR1JFQVRFUl9USEFOO1xyXG4gICAgICAgICAgICBjYXNlICdhcnJheS1jb250YWlucyc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIHJlbGF0aW9uOiAnICsgb3ApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZWxhdGlvbk9wLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5uYW1lO1xyXG4gICAgfTtcclxuICAgIFJlbGF0aW9uT3AucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5uYW1lID09PSBvdGhlci5uYW1lO1xyXG4gICAgfTtcclxuICAgIFJlbGF0aW9uT3AuTEVTU19USEFOID0gbmV3IFJlbGF0aW9uT3AoJzwnKTtcclxuICAgIFJlbGF0aW9uT3AuTEVTU19USEFOX09SX0VRVUFMID0gbmV3IFJlbGF0aW9uT3AoJzw9Jyk7XHJcbiAgICBSZWxhdGlvbk9wLkVRVUFMID0gbmV3IFJlbGF0aW9uT3AoJz09Jyk7XHJcbiAgICBSZWxhdGlvbk9wLkdSRUFURVJfVEhBTiA9IG5ldyBSZWxhdGlvbk9wKCc+Jyk7XHJcbiAgICBSZWxhdGlvbk9wLkdSRUFURVJfVEhBTl9PUl9FUVVBTCA9IG5ldyBSZWxhdGlvbk9wKCc+PScpO1xyXG4gICAgUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUyA9IG5ldyBSZWxhdGlvbk9wKCdhcnJheS1jb250YWlucycpO1xyXG4gICAgcmV0dXJuIFJlbGF0aW9uT3A7XHJcbn0oKSk7XHJcbnZhciBSZWxhdGlvbkZpbHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFJlbGF0aW9uRmlsdGVyLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gUmVsYXRpb25GaWx0ZXIoZmllbGQsIG9wLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuZmllbGQgPSBmaWVsZDtcclxuICAgICAgICBfdGhpcy5vcCA9IG9wO1xyXG4gICAgICAgIF90aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgUmVsYXRpb25GaWx0ZXIucHJvdG90eXBlLm1hdGNoZXMgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZmllbGQuaXNLZXlGaWVsZCgpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLnZhbHVlIGluc3RhbmNlb2YgUmVmVmFsdWUsICdDb21wYXJpbmcgb24ga2V5LCBidXQgZmlsdGVyIHZhbHVlIG5vdCBhIFJlZlZhbHVlJyk7XHJcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLm9wICE9PSBSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TLCBcImFycmF5LWNvbnRhaW5zIHF1ZXJpZXMgZG9uJ3QgbWFrZSBzZW5zZSBvbiBkb2N1bWVudCBrZXlzLlwiKTtcclxuICAgICAgICAgICAgdmFyIHJlZlZhbHVlID0gdGhpcy52YWx1ZTtcclxuICAgICAgICAgICAgdmFyIGNvbXBhcmlzb24gPSBEb2N1bWVudEtleS5jb21wYXJhdG9yKGRvYy5rZXksIHJlZlZhbHVlLmtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hdGNoZXNDb21wYXJpc29uKGNvbXBhcmlzb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHZhbCA9IGRvYy5maWVsZCh0aGlzLmZpZWxkKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbCAhPT0gdW5kZWZpbmVkICYmIHRoaXMubWF0Y2hlc1ZhbHVlKHZhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlbGF0aW9uRmlsdGVyLnByb3RvdHlwZS5tYXRjaGVzVmFsdWUgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLm9wID09PSBSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheVZhbHVlICYmXHJcbiAgICAgICAgICAgICAgICB2YWx1ZS5pbnRlcm5hbFZhbHVlLmZpbmQoZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuIGVsZW1lbnQuaXNFcXVhbChfdGhpcy52YWx1ZSk7IH0pICE9PVxyXG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBPbmx5IGNvbXBhcmUgdHlwZXMgd2l0aCBtYXRjaGluZyBiYWNrZW5kIG9yZGVyIChzdWNoIGFzIGRvdWJsZSBhbmQgaW50KS5cclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLnZhbHVlLnR5cGVPcmRlciA9PT0gdmFsdWUudHlwZU9yZGVyICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hdGNoZXNDb21wYXJpc29uKHZhbHVlLmNvbXBhcmVUbyh0aGlzLnZhbHVlKSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZWxhdGlvbkZpbHRlci5wcm90b3R5cGUubWF0Y2hlc0NvbXBhcmlzb24gPSBmdW5jdGlvbiAoY29tcGFyaXNvbikge1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5vcCkge1xyXG4gICAgICAgICAgICBjYXNlIFJlbGF0aW9uT3AuTEVTU19USEFOOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmlzb24gPCAwO1xyXG4gICAgICAgICAgICBjYXNlIFJlbGF0aW9uT3AuTEVTU19USEFOX09SX0VRVUFMOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmlzb24gPD0gMDtcclxuICAgICAgICAgICAgY2FzZSBSZWxhdGlvbk9wLkVRVUFMOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmlzb24gPT09IDA7XHJcbiAgICAgICAgICAgIGNhc2UgUmVsYXRpb25PcC5HUkVBVEVSX1RIQU46XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyaXNvbiA+IDA7XHJcbiAgICAgICAgICAgIGNhc2UgUmVsYXRpb25PcC5HUkVBVEVSX1RIQU5fT1JfRVFVQUw6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyaXNvbiA+PSAwO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gcmVsYXRpb24gb3AnICsgdGhpcy5vcCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlbGF0aW9uRmlsdGVyLnByb3RvdHlwZS5pc0luZXF1YWxpdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLm9wICE9PSBSZWxhdGlvbk9wLkVRVUFMICYmIHRoaXMub3AgIT09IFJlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlMpO1xyXG4gICAgfTtcclxuICAgIFJlbGF0aW9uRmlsdGVyLnByb3RvdHlwZS5jYW5vbmljYWxJZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBUT0RPKGIvMjkxODMxNjUpOiBUZWNobmljYWxseSwgdGhpcyB3b24ndCBiZSB1bmlxdWUgaWYgdHdvIHZhbHVlcyBoYXZlXHJcbiAgICAgICAgLy8gdGhlIHNhbWUgZGVzY3JpcHRpb24sIHN1Y2ggYXMgdGhlIGludCAzIGFuZCB0aGUgc3RyaW5nIFwiM1wiLiBTbyB3ZSBzaG91bGRcclxuICAgICAgICAvLyBhZGQgdGhlIHR5cGVzIGluIGhlcmUgc29tZWhvdywgdG9vLlxyXG4gICAgICAgIHJldHVybiAodGhpcy5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIHRoaXMub3AudG9TdHJpbmcoKSArIHRoaXMudmFsdWUudG9TdHJpbmcoKSk7XHJcbiAgICB9O1xyXG4gICAgUmVsYXRpb25GaWx0ZXIucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBSZWxhdGlvbkZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMub3AuaXNFcXVhbChvdGhlci5vcCkgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQuaXNFcXVhbChvdGhlci5maWVsZCkgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUuaXNFcXVhbChvdGhlci52YWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZWxhdGlvbkZpbHRlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyBcIiBcIiArIHRoaXMub3AgKyBcIiBcIiArIHRoaXMudmFsdWUudmFsdWUoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVsYXRpb25GaWx0ZXI7XHJcbn0oRmlsdGVyKSk7XHJcbi8qKlxyXG4gKiBGaWx0ZXIgdGhhdCBtYXRjaGVzICdudWxsJyB2YWx1ZXMuXHJcbiAqL1xyXG52YXIgTnVsbEZpbHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKE51bGxGaWx0ZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBOdWxsRmlsdGVyKGZpZWxkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5maWVsZCA9IGZpZWxkO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE51bGxGaWx0ZXIucHJvdG90eXBlLm1hdGNoZXMgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgdmFyIHZhbCA9IGRvYy5maWVsZCh0aGlzLmZpZWxkKTtcclxuICAgICAgICByZXR1cm4gdmFsICE9PSB1bmRlZmluZWQgJiYgdmFsLnZhbHVlKCkgPT09IG51bGw7XHJcbiAgICB9O1xyXG4gICAgTnVsbEZpbHRlci5wcm90b3R5cGUuY2Fub25pY2FsSWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyAnIElTIG51bGwnO1xyXG4gICAgfTtcclxuICAgIE51bGxGaWx0ZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgXCIgSVMgbnVsbFwiO1xyXG4gICAgfTtcclxuICAgIE51bGxGaWx0ZXIucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBOdWxsRmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmlzRXF1YWwob3RoZXIuZmllbGQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gTnVsbEZpbHRlcjtcclxufShGaWx0ZXIpKTtcclxuLyoqXHJcbiAqIEZpbHRlciB0aGF0IG1hdGNoZXMgJ05hTicgdmFsdWVzLlxyXG4gKi9cclxudmFyIE5hbkZpbHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKE5hbkZpbHRlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIE5hbkZpbHRlcihmaWVsZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuZmllbGQgPSBmaWVsZDtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBOYW5GaWx0ZXIucHJvdG90eXBlLm1hdGNoZXMgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgdmFyIGZpZWxkID0gZG9jLmZpZWxkKHRoaXMuZmllbGQpO1xyXG4gICAgICAgIHZhciB2YWwgPSBmaWVsZCAmJiBmaWVsZC52YWx1ZSgpO1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsID09PSAnbnVtYmVyJyAmJiBpc05hTih2YWwpO1xyXG4gICAgfTtcclxuICAgIE5hbkZpbHRlci5wcm90b3R5cGUuY2Fub25pY2FsSWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyAnIElTIE5hTic7XHJcbiAgICB9O1xyXG4gICAgTmFuRmlsdGVyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIFwiIElTIE5hTlwiO1xyXG4gICAgfTtcclxuICAgIE5hbkZpbHRlci5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIE5hbkZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5pc0VxdWFsKG90aGVyLmZpZWxkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE5hbkZpbHRlcjtcclxufShGaWx0ZXIpKTtcclxuLyoqXHJcbiAqIFRoZSBkaXJlY3Rpb24gb2Ygc29ydGluZyBpbiBhbiBvcmRlciBieS5cclxuICovXHJcbnZhciBEaXJlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEaXJlY3Rpb24obmFtZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB9XHJcbiAgICBEaXJlY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5hbWU7XHJcbiAgICB9O1xyXG4gICAgRGlyZWN0aW9uLkFTQ0VORElORyA9IG5ldyBEaXJlY3Rpb24oJ2FzYycpO1xyXG4gICAgRGlyZWN0aW9uLkRFU0NFTkRJTkcgPSBuZXcgRGlyZWN0aW9uKCdkZXNjJyk7XHJcbiAgICByZXR1cm4gRGlyZWN0aW9uO1xyXG59KCkpO1xyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGJvdW5kIG9mIGEgcXVlcnkuXHJcbiAqXHJcbiAqIFRoZSBib3VuZCBpcyBzcGVjaWZpZWQgd2l0aCB0aGUgZ2l2ZW4gY29tcG9uZW50cyByZXByZXNlbnRpbmcgYSBwb3NpdGlvbiBhbmRcclxuICogd2hldGhlciBpdCdzIGp1c3QgYmVmb3JlIG9yIGp1c3QgYWZ0ZXIgdGhlIHBvc2l0aW9uIChyZWxhdGl2ZSB0byB3aGF0ZXZlciB0aGVcclxuICogcXVlcnkgb3JkZXIgaXMpLlxyXG4gKlxyXG4gKiBUaGUgcG9zaXRpb24gcmVwcmVzZW50cyBhIGxvZ2ljYWwgaW5kZXggcG9zaXRpb24gZm9yIGEgcXVlcnkuIEl0J3MgYSBwcmVmaXhcclxuICogb2YgdmFsdWVzIGZvciB0aGUgKHBvdGVudGlhbGx5IGltcGxpY2l0KSBvcmRlciBieSBjbGF1c2VzIG9mIGEgcXVlcnkuXHJcbiAqXHJcbiAqIEJvdW5kIHByb3ZpZGVzIGEgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHdoZXRoZXIgYSBkb2N1bWVudCBjb21lcyBiZWZvcmUgb3JcclxuICogYWZ0ZXIgYSBib3VuZC4gVGhpcyBpcyBpbmZsdWVuY2VkIGJ5IHdoZXRoZXIgdGhlIHBvc2l0aW9uIGlzIGp1c3QgYmVmb3JlIG9yXHJcbiAqIGp1c3QgYWZ0ZXIgdGhlIHByb3ZpZGVkIHZhbHVlcy5cclxuICovXHJcbnZhciBCb3VuZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJvdW5kKHBvc2l0aW9uLCBiZWZvcmUpIHtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICAgICAgdGhpcy5iZWZvcmUgPSBiZWZvcmU7XHJcbiAgICB9XHJcbiAgICBCb3VuZC5wcm90b3R5cGUuY2Fub25pY2FsSWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogTWFrZSB0aGlzIGNvbGxpc2lvbiByb2J1c3QuXHJcbiAgICAgICAgdmFyIGNhbm9uaWNhbElkID0gdGhpcy5iZWZvcmUgPyAnYjonIDogJ2E6JztcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5wb3NpdGlvbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGNvbXBvbmVudCA9IF9hW19pXTtcclxuICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gY29tcG9uZW50LnRvU3RyaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjYW5vbmljYWxJZDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiBhIGRvY3VtZW50IHNvcnRzIGJlZm9yZSBhIGJvdW5kIHVzaW5nIHRoZSBwcm92aWRlZCBzb3J0XHJcbiAgICAgKiBvcmRlci5cclxuICAgICAqL1xyXG4gICAgQm91bmQucHJvdG90eXBlLnNvcnRzQmVmb3JlRG9jdW1lbnQgPSBmdW5jdGlvbiAob3JkZXJCeSwgZG9jKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMucG9zaXRpb24ubGVuZ3RoIDw9IG9yZGVyQnkubGVuZ3RoLCBcIkJvdW5kIGhhcyBtb3JlIGNvbXBvbmVudHMgdGhhbiBxdWVyeSdzIG9yZGVyQnlcIik7XHJcbiAgICAgICAgdmFyIGNvbXBhcmlzb24gPSAwO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wb3NpdGlvbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgb3JkZXJCeUNvbXBvbmVudCA9IG9yZGVyQnlbaV07XHJcbiAgICAgICAgICAgIHZhciBjb21wb25lbnQgPSB0aGlzLnBvc2l0aW9uW2ldO1xyXG4gICAgICAgICAgICBpZiAob3JkZXJCeUNvbXBvbmVudC5maWVsZC5pc0tleUZpZWxkKCkpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChjb21wb25lbnQgaW5zdGFuY2VvZiBSZWZWYWx1ZSwgJ0JvdW5kIGhhcyBhIG5vbi1rZXkgdmFsdWUgd2hlcmUgdGhlIGtleSBwYXRoIGlzIGJlaW5nIHVzZWQuJyk7XHJcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uID0gRG9jdW1lbnRLZXkuY29tcGFyYXRvcihjb21wb25lbnQua2V5LCBkb2Mua2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBkb2NWYWx1ZSA9IGRvYy5maWVsZChvcmRlckJ5Q29tcG9uZW50LmZpZWxkKTtcclxuICAgICAgICAgICAgICAgIGFzc2VydChkb2NWYWx1ZSAhPT0gdW5kZWZpbmVkLCAnRmllbGQgc2hvdWxkIGV4aXN0IHNpbmNlIGRvY3VtZW50IG1hdGNoZWQgdGhlIG9yZGVyQnkgYWxyZWFkeS4nKTtcclxuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSBjb21wb25lbnQuY29tcGFyZVRvKGRvY1ZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3JkZXJCeUNvbXBvbmVudC5kaXIgPT09IERpcmVjdGlvbi5ERVNDRU5ESU5HKSB7XHJcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uID0gY29tcGFyaXNvbiAqIC0xO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb21wYXJpc29uICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5iZWZvcmUgPyBjb21wYXJpc29uIDw9IDAgOiBjb21wYXJpc29uIDwgMDtcclxuICAgIH07XHJcbiAgICBCb3VuZC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmJlZm9yZSAhPT0gb3RoZXIuYmVmb3JlIHx8XHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24ubGVuZ3RoICE9PSBvdGhlci5wb3NpdGlvbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucG9zaXRpb24ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHRoaXNQb3NpdGlvbiA9IHRoaXMucG9zaXRpb25baV07XHJcbiAgICAgICAgICAgIHZhciBvdGhlclBvc2l0aW9uID0gb3RoZXIucG9zaXRpb25baV07XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzUG9zaXRpb24uaXNFcXVhbChvdGhlclBvc2l0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJvdW5kO1xyXG59KCkpO1xyXG4vKipcclxuICogQW4gb3JkZXJpbmcgb24gYSBmaWVsZCwgaW4gc29tZSBEaXJlY3Rpb24uIERpcmVjdGlvbiBkZWZhdWx0cyB0byBBU0NFTkRJTkcuXHJcbiAqL1xyXG52YXIgT3JkZXJCeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE9yZGVyQnkoZmllbGQsIGRpcikge1xyXG4gICAgICAgIHRoaXMuZmllbGQgPSBmaWVsZDtcclxuICAgICAgICBpZiAoZGlyID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgZGlyID0gRGlyZWN0aW9uLkFTQ0VORElORztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kaXIgPSBkaXI7XHJcbiAgICAgICAgdGhpcy5pc0tleU9yZGVyQnkgPSBmaWVsZC5pc0tleUZpZWxkKCk7XHJcbiAgICB9XHJcbiAgICBPcmRlckJ5LnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24gKGQxLCBkMikge1xyXG4gICAgICAgIHZhciBjb21wYXJpc29uID0gdGhpcy5pc0tleU9yZGVyQnlcclxuICAgICAgICAgICAgPyBEb2N1bWVudC5jb21wYXJlQnlLZXkoZDEsIGQyKVxyXG4gICAgICAgICAgICA6IERvY3VtZW50LmNvbXBhcmVCeUZpZWxkKHRoaXMuZmllbGQsIGQxLCBkMik7XHJcbiAgICAgICAgc3dpdGNoICh0aGlzLmRpcikge1xyXG4gICAgICAgICAgICBjYXNlIERpcmVjdGlvbi5BU0NFTkRJTkc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyaXNvbjtcclxuICAgICAgICAgICAgY2FzZSBEaXJlY3Rpb24uREVTQ0VORElORzpcclxuICAgICAgICAgICAgICAgIHJldHVybiAtMSAqIGNvbXBhcmlzb247XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBkaXJlY3Rpb246ICcgKyB0aGlzLmRpcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9yZGVyQnkucHJvdG90eXBlLmNhbm9uaWNhbElkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIFRPRE8oYi8yOTE4MzE2NSk6IE1ha2UgdGhpcyBjb2xsaXNpb24gcm9idXN0LlxyXG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgdGhpcy5kaXIudG9TdHJpbmcoKTtcclxuICAgIH07XHJcbiAgICBPcmRlckJ5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIFwiIChcIiArIHRoaXMuZGlyICsgXCIpXCI7XHJcbiAgICB9O1xyXG4gICAgT3JkZXJCeS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRpciA9PT0gb3RoZXIuZGlyICYmIHRoaXMuZmllbGQuaXNFcXVhbChvdGhlci5maWVsZCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE9yZGVyQnk7XHJcbn0oKSk7XHJcbnZhciBLRVlfT1JERVJJTkdfQVNDID0gbmV3IE9yZGVyQnkoRmllbGRQYXRoLmtleUZpZWxkKCksIERpcmVjdGlvbi5BU0NFTkRJTkcpO1xyXG52YXIgS0VZX09SREVSSU5HX0RFU0MgPSBuZXcgT3JkZXJCeShGaWVsZFBhdGgua2V5RmllbGQoKSwgRGlyZWN0aW9uLkRFU0NFTkRJTkcpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEEgdmVyc2lvbiBvZiBhIGRvY3VtZW50IGluIEZpcmVzdG9yZS4gVGhpcyBjb3JyZXNwb25kcyB0byB0aGUgdmVyc2lvblxyXG4gKiB0aW1lc3RhbXAsIHN1Y2ggYXMgdXBkYXRlX3RpbWUgb3IgcmVhZF90aW1lLlxyXG4gKi9cclxudmFyIFNuYXBzaG90VmVyc2lvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNuYXBzaG90VmVyc2lvbih0aW1lc3RhbXApIHtcclxuICAgICAgICB0aGlzLnRpbWVzdGFtcCA9IHRpbWVzdGFtcDtcclxuICAgIH1cclxuICAgIC8vIFRPRE8oYi8zNDE3NjM0NCk6IE9uY2Ugd2Ugbm8gbG9uZ2VyIG5lZWQgdG8gdXNlIHRoZSBvbGQgYWxwaGEgcHJvdG9zLFxyXG4gICAgLy8gZGVsZXRlIHRoaXMgY29uc3RydWN0b3IgYW5kIHVzZSBhIHRpbWVzdGFtcC1iYWNrZWQgdmVyc2lvbiBldmVyeXdoZXJlLlxyXG4gICAgU25hcHNob3RWZXJzaW9uLmZyb21NaWNyb3NlY29uZHMgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICB2YXIgc2Vjb25kcyA9IE1hdGguZmxvb3IodmFsdWUgLyAxZTYpO1xyXG4gICAgICAgIHZhciBuYW5vcyA9ICh2YWx1ZSAlIDFlNikgKiAxZTM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTbmFwc2hvdFZlcnNpb24obmV3IFRpbWVzdGFtcChzZWNvbmRzLCBuYW5vcykpO1xyXG4gICAgfTtcclxuICAgIFNuYXBzaG90VmVyc2lvbi5mcm9tVGltZXN0YW1wID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTbmFwc2hvdFZlcnNpb24odmFsdWUpO1xyXG4gICAgfTtcclxuICAgIFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBTbmFwc2hvdFZlcnNpb24uTUlOO1xyXG4gICAgfTtcclxuICAgIFNuYXBzaG90VmVyc2lvbi5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wLl9jb21wYXJlVG8ob3RoZXIudGltZXN0YW1wKTtcclxuICAgIH07XHJcbiAgICBTbmFwc2hvdFZlcnNpb24ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXAuaXNFcXVhbChvdGhlci50aW1lc3RhbXApO1xyXG4gICAgfTtcclxuICAgIC8qKiBSZXR1cm5zIGEgbnVtYmVyIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB2ZXJzaW9uIGZvciB1c2UgaW4gc3BlYyB0ZXN0cy4gKi9cclxuICAgIFNuYXBzaG90VmVyc2lvbi5wcm90b3R5cGUudG9NaWNyb3NlY29uZHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gQ29udmVydCB0byBtaWNyb3NlY29uZHMuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wLnNlY29uZHMgKiAxZTYgKyB0aGlzLnRpbWVzdGFtcC5uYW5vc2Vjb25kcyAvIDEwMDA7XHJcbiAgICB9O1xyXG4gICAgU25hcHNob3RWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gJ1NuYXBzaG90VmVyc2lvbignICsgdGhpcy50aW1lc3RhbXAudG9TdHJpbmcoKSArICcpJztcclxuICAgIH07XHJcbiAgICBTbmFwc2hvdFZlcnNpb24ucHJvdG90eXBlLnRvVGltZXN0YW1wID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVzdGFtcDtcclxuICAgIH07XHJcbiAgICBTbmFwc2hvdFZlcnNpb24uTUlOID0gbmV3IFNuYXBzaG90VmVyc2lvbihuZXcgVGltZXN0YW1wKDAsIDApKTtcclxuICAgIHJldHVybiBTbmFwc2hvdFZlcnNpb247XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKiogQW4gZW51bWVyYXRpb24gb2YgdGhlIGRpZmZlcmVudCBwdXJwb3NlcyB3ZSBoYXZlIGZvciBxdWVyaWVzLiAqL1xyXG52YXIgUXVlcnlQdXJwb3NlO1xyXG4oZnVuY3Rpb24gKFF1ZXJ5UHVycG9zZSkge1xyXG4gICAgLyoqIEEgcmVndWxhciwgbm9ybWFsIHF1ZXJ5LiAqL1xyXG4gICAgUXVlcnlQdXJwb3NlW1F1ZXJ5UHVycG9zZVtcIkxpc3RlblwiXSA9IDBdID0gXCJMaXN0ZW5cIjtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHF1ZXJ5IHdhcyB1c2VkIHRvIHJlZmlsbCBhIHF1ZXJ5IGFmdGVyIGFuIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2guXHJcbiAgICAgKi9cclxuICAgIFF1ZXJ5UHVycG9zZVtRdWVyeVB1cnBvc2VbXCJFeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaFwiXSA9IDFdID0gXCJFeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaFwiO1xyXG4gICAgLyoqIFRoZSBxdWVyeSB3YXMgdXNlZCB0byByZXNvbHZlIGEgbGltYm8gZG9jdW1lbnQuICovXHJcbiAgICBRdWVyeVB1cnBvc2VbUXVlcnlQdXJwb3NlW1wiTGltYm9SZXNvbHV0aW9uXCJdID0gMl0gPSBcIkxpbWJvUmVzb2x1dGlvblwiO1xyXG59KShRdWVyeVB1cnBvc2UgfHwgKFF1ZXJ5UHVycG9zZSA9IHt9KSk7XHJcbi8qKlxyXG4gKiBBbiBpbW11dGFibGUgc2V0IG9mIG1ldGFkYXRhIHRoYXQgdGhlIGxvY2FsIHN0b3JlIHRyYWNrcyBmb3IgZWFjaCBxdWVyeS5cclxuICovXHJcbnZhciBRdWVyeURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBRdWVyeURhdGEoXHJcbiAgICAvKiogVGhlIHF1ZXJ5IGJlaW5nIGxpc3RlbmVkIHRvLiAqL1xyXG4gICAgcXVlcnksIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgdGFyZ2V0IElEIHRvIHdoaWNoIHRoZSBxdWVyeSBjb3JyZXNwb25kczsgQXNzaWduZWQgYnkgdGhlXHJcbiAgICAgKiBMb2NhbFN0b3JlIGZvciB1c2VyIGxpc3RlbnMgYW5kIGJ5IHRoZSBTeW5jRW5naW5lIGZvciBsaW1ibyB3YXRjaGVzLlxyXG4gICAgICovXHJcbiAgICB0YXJnZXRJZCwgXHJcbiAgICAvKiogVGhlIHB1cnBvc2Ugb2YgdGhlIHF1ZXJ5LiAqL1xyXG4gICAgcHVycG9zZSwgXHJcbiAgICAvKiogVGhlIHNlcXVlbmNlIG51bWJlciBvZiB0aGUgbGFzdCB0cmFuc2FjdGlvbiBkdXJpbmcgd2hpY2ggdGhpcyBxdWVyeSBkYXRhIHdhcyBtb2RpZmllZCAqL1xyXG4gICAgc2VxdWVuY2VOdW1iZXIsIFxyXG4gICAgLyoqIFRoZSBsYXRlc3Qgc25hcHNob3QgdmVyc2lvbiBzZWVuIGZvciB0aGlzIHRhcmdldC4gKi9cclxuICAgIHNuYXBzaG90VmVyc2lvbiwgXHJcbiAgICAvKipcclxuICAgICAqIEFuIG9wYXF1ZSwgc2VydmVyLWFzc2lnbmVkIHRva2VuIHRoYXQgYWxsb3dzIHdhdGNoaW5nIGEgcXVlcnkgdG8gYmVcclxuICAgICAqIHJlc3VtZWQgYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YSB0aGF0XHJcbiAgICAgKiBtYXRjaGVzIHRoZSBxdWVyeS4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW5cclxuICAgICAqIHRpbWUgZnJvbSB3aGljaCB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxyXG4gICAgICovXHJcbiAgICByZXN1bWVUb2tlbikge1xyXG4gICAgICAgIGlmIChzbmFwc2hvdFZlcnNpb24gPT09IHZvaWQgMCkgeyBzbmFwc2hvdFZlcnNpb24gPSBTbmFwc2hvdFZlcnNpb24uTUlOOyB9XHJcbiAgICAgICAgaWYgKHJlc3VtZVRva2VuID09PSB2b2lkIDApIHsgcmVzdW1lVG9rZW4gPSBlbXB0eUJ5dGVTdHJpbmcoKTsgfVxyXG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICB0aGlzLnRhcmdldElkID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgdGhpcy5wdXJwb3NlID0gcHVycG9zZTtcclxuICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVyID0gc2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgdGhpcy5zbmFwc2hvdFZlcnNpb24gPSBzbmFwc2hvdFZlcnNpb247XHJcbiAgICAgICAgdGhpcy5yZXN1bWVUb2tlbiA9IHJlc3VtZVRva2VuO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHF1ZXJ5IGRhdGEgaW5zdGFuY2Ugd2l0aCBhbiB1cGRhdGVkIHNuYXBzaG90IHZlcnNpb24gYW5kXHJcbiAgICAgKiByZXN1bWUgdG9rZW4uXHJcbiAgICAgKi9cclxuICAgIFF1ZXJ5RGF0YS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChvdmVyd3JpdGUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5RGF0YSh0aGlzLnF1ZXJ5LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIG92ZXJ3cml0ZS5zZXF1ZW5jZU51bWJlciA9PT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgID8gdGhpcy5zZXF1ZW5jZU51bWJlclxyXG4gICAgICAgICAgICA6IG92ZXJ3cml0ZS5zZXF1ZW5jZU51bWJlciwgb3ZlcndyaXRlLnNuYXBzaG90VmVyc2lvbiA9PT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgID8gdGhpcy5zbmFwc2hvdFZlcnNpb25cclxuICAgICAgICAgICAgOiBvdmVyd3JpdGUuc25hcHNob3RWZXJzaW9uLCBvdmVyd3JpdGUucmVzdW1lVG9rZW4gPT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICA/IHRoaXMucmVzdW1lVG9rZW5cclxuICAgICAgICAgICAgOiBvdmVyd3JpdGUucmVzdW1lVG9rZW4pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5RGF0YS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAodGhpcy50YXJnZXRJZCA9PT0gb3RoZXIudGFyZ2V0SWQgJiZcclxuICAgICAgICAgICAgdGhpcy5wdXJwb3NlID09PSBvdGhlci5wdXJwb3NlICYmXHJcbiAgICAgICAgICAgIHRoaXMuc2VxdWVuY2VOdW1iZXIgPT09IG90aGVyLnNlcXVlbmNlTnVtYmVyICYmXHJcbiAgICAgICAgICAgIHRoaXMuc25hcHNob3RWZXJzaW9uLmlzRXF1YWwob3RoZXIuc25hcHNob3RWZXJzaW9uKSAmJlxyXG4gICAgICAgICAgICB0aGlzLnJlc3VtZVRva2VuID09PSBvdGhlci5yZXN1bWVUb2tlbiAmJlxyXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5LmlzRXF1YWwob3RoZXIucXVlcnkpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUXVlcnlEYXRhO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVzIGEgc2V0IG9mIGZpZWxkcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHBhcnRpYWxseSBwYXRjaCBhIGRvY3VtZW50LlxyXG4gKiBGaWVsZE1hc2sgaXMgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIE9iamVjdFZhbHVlLlxyXG4gKiBFeGFtcGxlczpcclxuICogICBmb28gLSBPdmVyd3JpdGVzIGZvbyBlbnRpcmVseSB3aXRoIHRoZSBwcm92aWRlZCB2YWx1ZS4gSWYgZm9vIGlzIG5vdFxyXG4gKiAgICAgICAgIHByZXNlbnQgaW4gdGhlIGNvbXBhbmlvbiBPYmplY3RWYWx1ZSwgdGhlIGZpZWxkIGlzIGRlbGV0ZWQuXHJcbiAqICAgZm9vLmJhciAtIE92ZXJ3cml0ZXMgb25seSB0aGUgZmllbGQgYmFyIG9mIHRoZSBvYmplY3QgZm9vLlxyXG4gKiAgICAgICAgICAgICBJZiBmb28gaXMgbm90IGFuIG9iamVjdCwgZm9vIGlzIHJlcGxhY2VkIHdpdGggYW4gb2JqZWN0XHJcbiAqICAgICAgICAgICAgIGNvbnRhaW5pbmcgZm9vXHJcbiAqL1xyXG52YXIgRmllbGRNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmllbGRNYXNrKGZpZWxkcykge1xyXG4gICAgICAgIHRoaXMuZmllbGRzID0gZmllbGRzO1xyXG4gICAgICAgIC8vIFRPRE8oZGltb25kKTogdmFsaWRhdGlvbiBvZiBGaWVsZE1hc2tcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVmVyaWZpZXMgdGhhdCBgZmllbGRQYXRoYCBpcyBpbmNsdWRlZCBieSBhdCBsZWFzdCBvbmUgZmllbGQgaW4gdGhpcyBmaWVsZFxyXG4gICAgICogbWFzay5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIGlzIGFuIE8obikgb3BlcmF0aW9uLCB3aGVyZSBgbmAgaXMgdGhlIHNpemUgb2YgdGhlIGZpZWxkIG1hc2suXHJcbiAgICAgKi9cclxuICAgIEZpZWxkTWFzay5wcm90b3R5cGUuY292ZXJzID0gZnVuY3Rpb24gKGZpZWxkUGF0aCkge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmZpZWxkczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGZpZWxkTWFza1BhdGggPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGlmIChmaWVsZE1hc2tQYXRoLmlzUHJlZml4T2YoZmllbGRQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIEZpZWxkTWFzay5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiBhcnJheUVxdWFscyh0aGlzLmZpZWxkcywgb3RoZXIuZmllbGRzKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRmllbGRNYXNrO1xyXG59KCkpO1xyXG4vKiogQSBmaWVsZCBwYXRoIGFuZCB0aGUgVHJhbnNmb3JtT3BlcmF0aW9uIHRvIHBlcmZvcm0gdXBvbiBpdC4gKi9cclxudmFyIEZpZWxkVHJhbnNmb3JtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmllbGRUcmFuc2Zvcm0oZmllbGQsIHRyYW5zZm9ybSkge1xyXG4gICAgICAgIHRoaXMuZmllbGQgPSBmaWVsZDtcclxuICAgICAgICB0aGlzLnRyYW5zZm9ybSA9IHRyYW5zZm9ybTtcclxuICAgIH1cclxuICAgIEZpZWxkVHJhbnNmb3JtLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmZpZWxkLmlzRXF1YWwob3RoZXIuZmllbGQpICYmIHRoaXMudHJhbnNmb3JtLmlzRXF1YWwob3RoZXIudHJhbnNmb3JtKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpZWxkVHJhbnNmb3JtO1xyXG59KCkpO1xyXG4vKiogVGhlIHJlc3VsdCBvZiBzdWNjZXNzZnVsbHkgYXBwbHlpbmcgYSBtdXRhdGlvbiB0byB0aGUgYmFja2VuZC4gKi9cclxudmFyIE11dGF0aW9uUmVzdWx0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTXV0YXRpb25SZXN1bHQoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSB2ZXJzaW9uIGF0IHdoaWNoIHRoZSBtdXRhdGlvbiB3YXMgY29tbWl0dGVkOlxyXG4gICAgICpcclxuICAgICAqIC0gRm9yIG1vc3Qgb3BlcmF0aW9ucywgdGhpcyBpcyB0aGUgdXBkYXRlVGltZSBpbiB0aGUgV3JpdGVSZXN1bHQuXHJcbiAgICAgKiAtIEZvciBkZWxldGVzLCB0aGUgY29tbWl0VGltZSBvZiB0aGUgV3JpdGVSZXNwb25zZSAoYmVjYXVzZSBkZWxldGVzIGFyZVxyXG4gICAgICogICBub3Qgc3RvcmVkIGFuZCBoYXZlIG5vIHVwZGF0ZVRpbWUpLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCB0aGVzZSB2ZXJzaW9ucyBjYW4gYmUgZGlmZmVyZW50OiBOby1vcCB3cml0ZXMgd2lsbCBub3QgY2hhbmdlXHJcbiAgICAgKiB0aGUgdXBkYXRlVGltZSBldmVuIHRob3VnaCB0aGUgY29tbWl0VGltZSBhZHZhbmNlcy5cclxuICAgICAqL1xyXG4gICAgdmVyc2lvbiwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSByZXN1bHRpbmcgZmllbGRzIHJldHVybmVkIGZyb20gdGhlIGJhY2tlbmQgYWZ0ZXIgYVxyXG4gICAgICogVHJhbnNmb3JtTXV0YXRpb24gaGFzIGJlZW4gY29tbWl0dGVkLiBDb250YWlucyBvbmUgRmllbGRWYWx1ZSBmb3IgZWFjaFxyXG4gICAgICogRmllbGRUcmFuc2Zvcm0gdGhhdCB3YXMgaW4gdGhlIG11dGF0aW9uLlxyXG4gICAgICpcclxuICAgICAqIFdpbGwgYmUgbnVsbCBpZiB0aGUgbXV0YXRpb24gd2FzIG5vdCBhIFRyYW5zZm9ybU11dGF0aW9uLlxyXG4gICAgICovXHJcbiAgICB0cmFuc2Zvcm1SZXN1bHRzKSB7XHJcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcclxuICAgICAgICB0aGlzLnRyYW5zZm9ybVJlc3VsdHMgPSB0cmFuc2Zvcm1SZXN1bHRzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE11dGF0aW9uUmVzdWx0O1xyXG59KCkpO1xyXG52YXIgTXV0YXRpb25UeXBlO1xyXG4oZnVuY3Rpb24gKE11dGF0aW9uVHlwZSkge1xyXG4gICAgTXV0YXRpb25UeXBlW011dGF0aW9uVHlwZVtcIlNldFwiXSA9IDBdID0gXCJTZXRcIjtcclxuICAgIE11dGF0aW9uVHlwZVtNdXRhdGlvblR5cGVbXCJQYXRjaFwiXSA9IDFdID0gXCJQYXRjaFwiO1xyXG4gICAgTXV0YXRpb25UeXBlW011dGF0aW9uVHlwZVtcIlRyYW5zZm9ybVwiXSA9IDJdID0gXCJUcmFuc2Zvcm1cIjtcclxuICAgIE11dGF0aW9uVHlwZVtNdXRhdGlvblR5cGVbXCJEZWxldGVcIl0gPSAzXSA9IFwiRGVsZXRlXCI7XHJcbn0pKE11dGF0aW9uVHlwZSB8fCAoTXV0YXRpb25UeXBlID0ge30pKTtcclxuLyoqXHJcbiAqIEVuY29kZXMgYSBwcmVjb25kaXRpb24gZm9yIGEgbXV0YXRpb24uIFRoaXMgZm9sbG93cyB0aGUgbW9kZWwgdGhhdCB0aGVcclxuICogYmFja2VuZCBhY2NlcHRzIHdpdGggdGhlIHNwZWNpYWwgY2FzZSBvZiBhbiBleHBsaWNpdCBcImVtcHR5XCIgcHJlY29uZGl0aW9uXHJcbiAqIChtZWFuaW5nIG5vIHByZWNvbmRpdGlvbikuXHJcbiAqL1xyXG52YXIgUHJlY29uZGl0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUHJlY29uZGl0aW9uKHVwZGF0ZVRpbWUsIGV4aXN0cykge1xyXG4gICAgICAgIHRoaXMudXBkYXRlVGltZSA9IHVwZGF0ZVRpbWU7XHJcbiAgICAgICAgdGhpcy5leGlzdHMgPSBleGlzdHM7XHJcbiAgICAgICAgYXNzZXJ0KHVwZGF0ZVRpbWUgPT09IHVuZGVmaW5lZCB8fCBleGlzdHMgPT09IHVuZGVmaW5lZCwgJ1ByZWNvbmRpdGlvbiBjYW4gc3BlY2lmeSBcImV4aXN0c1wiIG9yIFwidXBkYXRlVGltZVwiIGJ1dCBub3QgYm90aCcpO1xyXG4gICAgfVxyXG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgUHJlY29uZGl0aW9uIHdpdGggYW4gZXhpc3RzIGZsYWcuICovXHJcbiAgICBQcmVjb25kaXRpb24uZXhpc3RzID0gZnVuY3Rpb24gKGV4aXN0cykge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJlY29uZGl0aW9uKHVuZGVmaW5lZCwgZXhpc3RzKTtcclxuICAgIH07XHJcbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBQcmVjb25kaXRpb24gYmFzZWQgb24gYSB2ZXJzaW9uIGEgZG9jdW1lbnQgZXhpc3RzIGF0LiAqL1xyXG4gICAgUHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUgPSBmdW5jdGlvbiAodmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJlY29uZGl0aW9uKHZlcnNpb24pO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcmVjb25kaXRpb24ucHJvdG90eXBlLCBcImlzTm9uZVwiLCB7XHJcbiAgICAgICAgLyoqIFJldHVybnMgd2hldGhlciB0aGlzIFByZWNvbmRpdGlvbiBpcyBlbXB0eS4gKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXBkYXRlVGltZSA9PT0gdW5kZWZpbmVkICYmIHRoaXMuZXhpc3RzID09PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcHJlY29uZGl0aW9ucyBpcyB2YWxpZCBmb3IgdGhlIGdpdmVuIGRvY3VtZW50XHJcbiAgICAgKiAob3IgbnVsbCBpZiBubyBkb2N1bWVudCBpcyBhdmFpbGFibGUpLlxyXG4gICAgICovXHJcbiAgICBQcmVjb25kaXRpb24ucHJvdG90eXBlLmlzVmFsaWRGb3IgPSBmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICBpZiAodGhpcy51cGRhdGVUaW1lICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChtYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50ICYmXHJcbiAgICAgICAgICAgICAgICBtYXliZURvYy52ZXJzaW9uLmlzRXF1YWwodGhpcy51cGRhdGVUaW1lKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMuZXhpc3RzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXhpc3RzID09PSBtYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgYXNzZXJ0KHRoaXMuaXNOb25lLCAnUHJlY29uZGl0aW9uIHNob3VsZCBiZSBlbXB0eScpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUHJlY29uZGl0aW9uLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChlcXVhbHModGhpcy51cGRhdGVUaW1lLCBvdGhlci51cGRhdGVUaW1lKSAmJlxyXG4gICAgICAgICAgICB0aGlzLmV4aXN0cyA9PT0gb3RoZXIuZXhpc3RzKTtcclxuICAgIH07XHJcbiAgICBQcmVjb25kaXRpb24uTk9ORSA9IG5ldyBQcmVjb25kaXRpb24oKTtcclxuICAgIHJldHVybiBQcmVjb25kaXRpb247XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIG11dGF0aW9uIGRlc2NyaWJlcyBhIHNlbGYtY29udGFpbmVkIGNoYW5nZSB0byBhIGRvY3VtZW50LiBNdXRhdGlvbnMgY2FuXHJcbiAqIGNyZWF0ZSwgcmVwbGFjZSwgZGVsZXRlLCBhbmQgdXBkYXRlIHN1YnNldHMgb2YgZG9jdW1lbnRzLlxyXG4gKlxyXG4gKiBNdXRhdGlvbnMgbm90IG9ubHkgYWN0IG9uIHRoZSB2YWx1ZSBvZiB0aGUgZG9jdW1lbnQgYnV0IGFsc28gaXQgdmVyc2lvbi5cclxuICpcclxuICogRm9yIGxvY2FsIG11dGF0aW9ucyAobXV0YXRpb25zIHRoYXQgaGF2ZW4ndCBiZWVuIGNvbW1pdHRlZCB5ZXQpLCB3ZSBwcmVzZXJ2ZVxyXG4gKiB0aGUgZXhpc3RpbmcgdmVyc2lvbiBmb3IgU2V0LCBQYXRjaCwgYW5kIFRyYW5zZm9ybSBtdXRhdGlvbnMuIEZvciBEZWxldGVcclxuICogbXV0YXRpb25zLCB3ZSByZXNldCB0aGUgdmVyc2lvbiB0byAwLlxyXG4gKlxyXG4gKiBIZXJlJ3MgdGhlIGV4cGVjdGVkIHRyYW5zaXRpb24gdGFibGUuXHJcbiAqXHJcbiAqIE1VVEFUSU9OICAgICAgICAgICBBUFBMSUVEIFRPICAgICAgICAgICAgUkVTVUxUUyBJTlxyXG4gKlxyXG4gKiBTZXRNdXRhdGlvbiAgICAgICAgRG9jdW1lbnQodjMpICAgICAgICAgIERvY3VtZW50KHYzKVxyXG4gKiBTZXRNdXRhdGlvbiAgICAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIERvY3VtZW50KHYwKVxyXG4gKiBTZXRNdXRhdGlvbiAgICAgICAgbnVsbCAgICAgICAgICAgICAgICAgIERvY3VtZW50KHYwKVxyXG4gKiBQYXRjaE11dGF0aW9uICAgICAgRG9jdW1lbnQodjMpICAgICAgICAgIERvY3VtZW50KHYzKVxyXG4gKiBQYXRjaE11dGF0aW9uICAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIE5vRG9jdW1lbnQodjMpXHJcbiAqIFBhdGNoTXV0YXRpb24gICAgICBudWxsICAgICAgICAgICAgICAgICAgbnVsbFxyXG4gKiBUcmFuc2Zvcm1NdXRhdGlvbiAgRG9jdW1lbnQodjMpICAgICAgICAgIERvY3VtZW50KHYzKVxyXG4gKiBUcmFuc2Zvcm1NdXRhdGlvbiAgTm9Eb2N1bWVudCh2MykgICAgICAgIE5vRG9jdW1lbnQodjMpXHJcbiAqIFRyYW5zZm9ybU11dGF0aW9uICBudWxsICAgICAgICAgICAgICAgICAgbnVsbFxyXG4gKiBEZWxldGVNdXRhdGlvbiAgICAgRG9jdW1lbnQodjMpICAgICAgICAgIE5vRG9jdW1lbnQodjApXHJcbiAqIERlbGV0ZU11dGF0aW9uICAgICBOb0RvY3VtZW50KHYzKSAgICAgICAgTm9Eb2N1bWVudCh2MClcclxuICogRGVsZXRlTXV0YXRpb24gICAgIG51bGwgICAgICAgICAgICAgICAgICBOb0RvY3VtZW50KHYwKVxyXG4gKlxyXG4gKiBGb3IgYWNrbm93bGVkZ2VkIG11dGF0aW9ucywgd2UgdXNlIHRoZSB1cGRhdGVUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIGFzXHJcbiAqIHRoZSByZXN1bHRpbmcgdmVyc2lvbiBmb3IgU2V0LCBQYXRjaCwgYW5kIFRyYW5zZm9ybSBtdXRhdGlvbnMuIEFzIGRlbGV0ZXNcclxuICogaGF2ZSBubyBleHBsaWNpdCB1cGRhdGUgdGltZSwgd2UgdXNlIHRoZSBjb21taXRUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIGZvclxyXG4gKiBEZWxldGUgbXV0YXRpb25zLlxyXG4gKlxyXG4gKiBJZiBhIG11dGF0aW9uIGlzIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZCBidXQgZmFpbHMgdGhlIHByZWNvbmRpdGlvbiBjaGVja1xyXG4gKiBsb2NhbGx5LCB3ZSByZXR1cm4gYW4gYFVua25vd25Eb2N1bWVudGAgYW5kIHJlbHkgb24gV2F0Y2ggdG8gc2VuZCB1cyB0aGVcclxuICogdXBkYXRlZCB2ZXJzaW9uLlxyXG4gKlxyXG4gKiBOb3RlIHRoYXQgVHJhbnNmb3JtTXV0YXRpb25zIGRvbid0IGNyZWF0ZSBEb2N1bWVudHMgKGluIHRoZSBjYXNlIG9mIGJlaW5nXHJcbiAqIGFwcGxpZWQgdG8gYSBOb0RvY3VtZW50KSwgZXZlbiB0aG91Z2ggdGhleSB3b3VsZCBvbiB0aGUgYmFja2VuZC4gVGhpcyBpc1xyXG4gKiBiZWNhdXNlIHRoZSBjbGllbnQgYWx3YXlzIGNvbWJpbmVzIHRoZSBUcmFuc2Zvcm1NdXRhdGlvbiB3aXRoIGEgU2V0TXV0YXRpb25cclxuICogb3IgUGF0Y2hNdXRhdGlvbiBhbmQgd2Ugb25seSB3YW50IHRvIGFwcGx5IHRoZSB0cmFuc2Zvcm0gaWYgdGhlIHByaW9yXHJcbiAqIG11dGF0aW9uIHJlc3VsdGVkIGluIGEgRG9jdW1lbnQgKGFsd2F5cyB0cnVlIGZvciBhIFNldE11dGF0aW9uLCBidXQgbm90XHJcbiAqIG5lY2Vzc2FyaWx5IGZvciBhIFBhdGNoTXV0YXRpb24pLlxyXG4gKlxyXG4gKiAjIyBTdWJjbGFzc2luZyBOb3Rlc1xyXG4gKlxyXG4gKiBTdWJjbGFzc2VzIG9mIE11dGF0aW9uIG5lZWQgdG8gaW1wbGVtZW50IGFwcGx5VG9SZW1vdGVEb2N1bWVudCgpIGFuZFxyXG4gKiBhcHBseVRvTG9jYWxWaWV3KCkgdG8gaW1wbGVtZW50IHRoZSBhY3R1YWwgYmVoYXZpb3Igb2YgYXBwbHlpbmcgdGhlIG11dGF0aW9uXHJcbiAqIHRvIHNvbWUgc291cmNlIGRvY3VtZW50LlxyXG4gKi9cclxudmFyIE11dGF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTXV0YXRpb24oKSB7XHJcbiAgICB9XHJcbiAgICBNdXRhdGlvbi5wcm90b3R5cGUudmVyaWZ5S2V5TWF0Y2hlcyA9IGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgIGlmIChtYXliZURvYyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChtYXliZURvYy5rZXkuaXNFcXVhbCh0aGlzLmtleSksICdDYW4gb25seSBhcHBseSBhIG11dGF0aW9uIHRvIGEgZG9jdW1lbnQgd2l0aCB0aGUgc2FtZSBrZXknKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSB2ZXJzaW9uIGZyb20gdGhlIGdpdmVuIGRvY3VtZW50IGZvciB1c2UgYXMgdGhlIHJlc3VsdCBvZiBhXHJcbiAgICAgKiBtdXRhdGlvbi4gTXV0YXRpb25zIGFyZSBkZWZpbmVkIHRvIHJldHVybiB0aGUgdmVyc2lvbiBvZiB0aGUgYmFzZSBkb2N1bWVudFxyXG4gICAgICogb25seSBpZiBpdCBpcyBhbiBleGlzdGluZyBkb2N1bWVudC4gRGVsZXRlZCBhbmQgdW5rbm93biBkb2N1bWVudHMgaGF2ZSBhXHJcbiAgICAgKiBwb3N0LW11dGF0aW9uIHZlcnNpb24gb2YgU25hcHNob3RWZXJzaW9uLk1JTi5cclxuICAgICAqL1xyXG4gICAgTXV0YXRpb24uZ2V0UG9zdE11dGF0aW9uVmVyc2lvbiA9IGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgIGlmIChtYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtYXliZURvYy52ZXJzaW9uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5NSU47XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBNdXRhdGlvbjtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgbXV0YXRpb24gdGhhdCBjcmVhdGVzIG9yIHJlcGxhY2VzIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5IHdpdGggdGhlXHJcbiAqIG9iamVjdCB2YWx1ZSBjb250ZW50cy5cclxuICovXHJcbnZhciBTZXRNdXRhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFNldE11dGF0aW9uLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU2V0TXV0YXRpb24oa2V5LCB2YWx1ZSwgcHJlY29uZGl0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgX3RoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICBfdGhpcy5wcmVjb25kaXRpb24gPSBwcmVjb25kaXRpb247XHJcbiAgICAgICAgX3RoaXMudHlwZSA9IE11dGF0aW9uVHlwZS5TZXQ7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgU2V0TXV0YXRpb24ucHJvdG90eXBlLmFwcGx5VG9SZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChtYXliZURvYywgbXV0YXRpb25SZXN1bHQpIHtcclxuICAgICAgICB0aGlzLnZlcmlmeUtleU1hdGNoZXMobWF5YmVEb2MpO1xyXG4gICAgICAgIGFzc2VydChtdXRhdGlvblJlc3VsdC50cmFuc2Zvcm1SZXN1bHRzID09IG51bGwsICdUcmFuc2Zvcm0gcmVzdWx0cyByZWNlaXZlZCBieSBTZXRNdXRhdGlvbi4nKTtcclxuICAgICAgICAvLyBVbmxpa2UgYXBwbHlUb0xvY2FsVmlldywgaWYgd2UncmUgYXBwbHlpbmcgYSBtdXRhdGlvbiB0byBhIHJlbW90ZVxyXG4gICAgICAgIC8vIGRvY3VtZW50IHRoZSBzZXJ2ZXIgaGFzIGFjY2VwdGVkIHRoZSBtdXRhdGlvbiBzbyB0aGUgcHJlY29uZGl0aW9uIG11c3RcclxuICAgICAgICAvLyBoYXZlIGhlbGQuXHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSBtdXRhdGlvblJlc3VsdC52ZXJzaW9uO1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnQodGhpcy5rZXksIHZlcnNpb24sIHRoaXMudmFsdWUsIHtcclxuICAgICAgICAgICAgaGFzQ29tbWl0dGVkTXV0YXRpb25zOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2V0TXV0YXRpb24ucHJvdG90eXBlLmFwcGx5VG9Mb2NhbFZpZXcgPSBmdW5jdGlvbiAobWF5YmVEb2MsIGJhc2VEb2MsIGxvY2FsV3JpdGVUaW1lKSB7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlLZXlNYXRjaGVzKG1heWJlRG9jKTtcclxuICAgICAgICBpZiAoIXRoaXMucHJlY29uZGl0aW9uLmlzVmFsaWRGb3IobWF5YmVEb2MpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtYXliZURvYztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSBNdXRhdGlvbi5nZXRQb3N0TXV0YXRpb25WZXJzaW9uKG1heWJlRG9jKTtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50KHRoaXMua2V5LCB2ZXJzaW9uLCB0aGlzLnZhbHVlLCB7XHJcbiAgICAgICAgICAgIGhhc0xvY2FsTXV0YXRpb25zOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2V0TXV0YXRpb24ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgU2V0TXV0YXRpb24gJiZcclxuICAgICAgICAgICAgdGhpcy5rZXkuaXNFcXVhbChvdGhlci5rZXkpICYmXHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUuaXNFcXVhbChvdGhlci52YWx1ZSkgJiZcclxuICAgICAgICAgICAgdGhpcy5wcmVjb25kaXRpb24uaXNFcXVhbChvdGhlci5wcmVjb25kaXRpb24pKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU2V0TXV0YXRpb247XHJcbn0oTXV0YXRpb24pKTtcclxuLyoqXHJcbiAqIEEgbXV0YXRpb24gdGhhdCBtb2RpZmllcyBmaWVsZHMgb2YgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkgd2l0aCB0aGVcclxuICogZ2l2ZW4gdmFsdWVzLiBUaGUgdmFsdWVzIGFyZSBhcHBsaWVkIHRocm91Z2ggYSBmaWVsZCBtYXNrOlxyXG4gKlxyXG4gKiAgKiBXaGVuIGEgZmllbGQgaXMgaW4gYm90aCB0aGUgbWFzayBhbmQgdGhlIHZhbHVlcywgdGhlIGNvcnJlc3BvbmRpbmcgZmllbGRcclxuICogICAgaXMgdXBkYXRlZC5cclxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIG5laXRoZXIgdGhlIG1hc2sgbm9yIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nXHJcbiAqICAgIGZpZWxkIGlzIHVubW9kaWZpZWQuXHJcbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBpbiB0aGUgbWFzayBidXQgbm90IGluIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nIGZpZWxkXHJcbiAqICAgIGlzIGRlbGV0ZWQuXHJcbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBub3QgaW4gdGhlIG1hc2sgYnV0IGlzIGluIHRoZSB2YWx1ZXMsIHRoZSB2YWx1ZXMgbWFwIGlzXHJcbiAqICAgIGlnbm9yZWQuXHJcbiAqL1xyXG52YXIgUGF0Y2hNdXRhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFBhdGNoTXV0YXRpb24sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBQYXRjaE11dGF0aW9uKGtleSwgZGF0YSwgZmllbGRNYXNrLCBwcmVjb25kaXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmtleSA9IGtleTtcclxuICAgICAgICBfdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICBfdGhpcy5maWVsZE1hc2sgPSBmaWVsZE1hc2s7XHJcbiAgICAgICAgX3RoaXMucHJlY29uZGl0aW9uID0gcHJlY29uZGl0aW9uO1xyXG4gICAgICAgIF90aGlzLnR5cGUgPSBNdXRhdGlvblR5cGUuUGF0Y2g7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgUGF0Y2hNdXRhdGlvbi5wcm90b3R5cGUuYXBwbHlUb1JlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKG1heWJlRG9jLCBtdXRhdGlvblJlc3VsdCkge1xyXG4gICAgICAgIHRoaXMudmVyaWZ5S2V5TWF0Y2hlcyhtYXliZURvYyk7XHJcbiAgICAgICAgYXNzZXJ0KG11dGF0aW9uUmVzdWx0LnRyYW5zZm9ybVJlc3VsdHMgPT0gbnVsbCwgJ1RyYW5zZm9ybSByZXN1bHRzIHJlY2VpdmVkIGJ5IFBhdGNoTXV0YXRpb24uJyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnByZWNvbmRpdGlvbi5pc1ZhbGlkRm9yKG1heWJlRG9jKSkge1xyXG4gICAgICAgICAgICAvLyBTaW5jZSB0aGUgbXV0YXRpb24gd2FzIG5vdCByZWplY3RlZCwgd2Uga25vdyB0aGF0IHRoZSAgcHJlY29uZGl0aW9uXHJcbiAgICAgICAgICAgIC8vIG1hdGNoZWQgb24gdGhlIGJhY2tlbmQuIFdlIHRoZXJlZm9yZSBtdXN0IG5vdCBoYXZlIHRoZSBleHBlY3RlZCB2ZXJzaW9uXHJcbiAgICAgICAgICAgIC8vIG9mIHRoZSBkb2N1bWVudCBpbiBvdXIgY2FjaGUgYW5kIHJldHVybiBhbiBVbmtub3duRG9jdW1lbnQgd2l0aCB0aGVcclxuICAgICAgICAgICAgLy8ga25vd24gdXBkYXRlVGltZS5cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBVbmtub3duRG9jdW1lbnQodGhpcy5rZXksIG11dGF0aW9uUmVzdWx0LnZlcnNpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbmV3RGF0YSA9IHRoaXMucGF0Y2hEb2N1bWVudChtYXliZURvYyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudCh0aGlzLmtleSwgbXV0YXRpb25SZXN1bHQudmVyc2lvbiwgbmV3RGF0YSwge1xyXG4gICAgICAgICAgICBoYXNDb21taXR0ZWRNdXRhdGlvbnM6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBQYXRjaE11dGF0aW9uLnByb3RvdHlwZS5hcHBseVRvTG9jYWxWaWV3ID0gZnVuY3Rpb24gKG1heWJlRG9jLCBiYXNlRG9jLCBsb2NhbFdyaXRlVGltZSkge1xyXG4gICAgICAgIHRoaXMudmVyaWZ5S2V5TWF0Y2hlcyhtYXliZURvYyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnByZWNvbmRpdGlvbi5pc1ZhbGlkRm9yKG1heWJlRG9jKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbWF5YmVEb2M7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gTXV0YXRpb24uZ2V0UG9zdE11dGF0aW9uVmVyc2lvbihtYXliZURvYyk7XHJcbiAgICAgICAgdmFyIG5ld0RhdGEgPSB0aGlzLnBhdGNoRG9jdW1lbnQobWF5YmVEb2MpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnQodGhpcy5rZXksIHZlcnNpb24sIG5ld0RhdGEsIHtcclxuICAgICAgICAgICAgaGFzTG9jYWxNdXRhdGlvbnM6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBQYXRjaE11dGF0aW9uLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIFBhdGNoTXV0YXRpb24gJiZcclxuICAgICAgICAgICAgdGhpcy5rZXkuaXNFcXVhbChvdGhlci5rZXkpICYmXHJcbiAgICAgICAgICAgIHRoaXMuZmllbGRNYXNrLmlzRXF1YWwob3RoZXIuZmllbGRNYXNrKSAmJlxyXG4gICAgICAgICAgICB0aGlzLnByZWNvbmRpdGlvbi5pc0VxdWFsKG90aGVyLnByZWNvbmRpdGlvbikpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGF0Y2hlcyB0aGUgZGF0YSBvZiBkb2N1bWVudCBpZiBhdmFpbGFibGUgb3IgY3JlYXRlcyBhIG5ldyBkb2N1bWVudC4gTm90ZVxyXG4gICAgICogdGhhdCB0aGlzIGRvZXMgbm90IGNoZWNrIHdoZXRoZXIgb3Igbm90IHRoZSBwcmVjb25kaXRpb24gb2YgdGhpcyBwYXRjaFxyXG4gICAgICogaG9sZHMuXHJcbiAgICAgKi9cclxuICAgIFBhdGNoTXV0YXRpb24ucHJvdG90eXBlLnBhdGNoRG9jdW1lbnQgPSBmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICB2YXIgZGF0YTtcclxuICAgICAgICBpZiAobWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICBkYXRhID0gbWF5YmVEb2MuZGF0YTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBPYmplY3RWYWx1ZS5FTVBUWTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0Y2hPYmplY3QoZGF0YSk7XHJcbiAgICB9O1xyXG4gICAgUGF0Y2hNdXRhdGlvbi5wcm90b3R5cGUucGF0Y2hPYmplY3QgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmZpZWxkTWFzay5maWVsZHM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZFBhdGggPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGlmICghZmllbGRQYXRoLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gdGhpcy5kYXRhLmZpZWxkKGZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3VmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhLnNldChmaWVsZFBhdGgsIG5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhLmRlbGV0ZShmaWVsZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQYXRjaE11dGF0aW9uO1xyXG59KE11dGF0aW9uKSk7XHJcbi8qKlxyXG4gKiBBIG11dGF0aW9uIHRoYXQgbW9kaWZpZXMgc3BlY2lmaWMgZmllbGRzIG9mIHRoZSBkb2N1bWVudCB3aXRoIHRyYW5zZm9ybVxyXG4gKiBvcGVyYXRpb25zLiBDdXJyZW50bHkgdGhlIG9ubHkgc3VwcG9ydGVkIHRyYW5zZm9ybSBpcyBhIHNlcnZlciB0aW1lc3RhbXAsIGJ1dFxyXG4gKiBJUCBBZGRyZXNzLCBpbmNyZW1lbnQobiksIGV0Yy4gY291bGQgYmUgc3VwcG9ydGVkIGluIHRoZSBmdXR1cmUuXHJcbiAqXHJcbiAqIEl0IGlzIHNvbWV3aGF0IHNpbWlsYXIgdG8gYSBQYXRjaE11dGF0aW9uIGluIHRoYXQgaXQgcGF0Y2hlcyBzcGVjaWZpYyBmaWVsZHNcclxuICogYW5kIGhhcyBubyBlZmZlY3Qgd2hlbiBhcHBsaWVkIHRvIGEgbnVsbCBvciBOb0RvY3VtZW50IChzZWUgY29tbWVudCBvblxyXG4gKiBNdXRhdGlvbiBmb3IgcmF0aW9uYWxlKS5cclxuICovXHJcbnZhciBUcmFuc2Zvcm1NdXRhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFRyYW5zZm9ybU11dGF0aW9uLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gVHJhbnNmb3JtTXV0YXRpb24oa2V5LCBmaWVsZFRyYW5zZm9ybXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmtleSA9IGtleTtcclxuICAgICAgICBfdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBmaWVsZFRyYW5zZm9ybXM7XHJcbiAgICAgICAgX3RoaXMudHlwZSA9IE11dGF0aW9uVHlwZS5UcmFuc2Zvcm07XHJcbiAgICAgICAgLy8gTk9URTogV2Ugc2V0IGEgcHJlY29uZGl0aW9uIG9mIGV4aXN0czogdHJ1ZSBhcyBhIHNhZmV0eS1jaGVjaywgc2luY2Ugd2VcclxuICAgICAgICAvLyBhbHdheXMgY29tYmluZSBUcmFuc2Zvcm1NdXRhdGlvbnMgd2l0aCBhIFNldE11dGF0aW9uIG9yIFBhdGNoTXV0YXRpb24gd2hpY2hcclxuICAgICAgICAvLyAoaWYgc3VjY2Vzc2Z1bCkgc2hvdWxkIGVuZCB1cCB3aXRoIGFuIGV4aXN0aW5nIGRvY3VtZW50LlxyXG4gICAgICAgIF90aGlzLnByZWNvbmRpdGlvbiA9IFByZWNvbmRpdGlvbi5leGlzdHModHJ1ZSk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgVHJhbnNmb3JtTXV0YXRpb24ucHJvdG90eXBlLmFwcGx5VG9SZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChtYXliZURvYywgbXV0YXRpb25SZXN1bHQpIHtcclxuICAgICAgICB0aGlzLnZlcmlmeUtleU1hdGNoZXMobWF5YmVEb2MpO1xyXG4gICAgICAgIGFzc2VydChtdXRhdGlvblJlc3VsdC50cmFuc2Zvcm1SZXN1bHRzICE9IG51bGwsICdUcmFuc2Zvcm0gcmVzdWx0cyBtaXNzaW5nIGZvciBUcmFuc2Zvcm1NdXRhdGlvbi4nKTtcclxuICAgICAgICBpZiAoIXRoaXMucHJlY29uZGl0aW9uLmlzVmFsaWRGb3IobWF5YmVEb2MpKSB7XHJcbiAgICAgICAgICAgIC8vIFNpbmNlIHRoZSBtdXRhdGlvbiB3YXMgbm90IHJlamVjdGVkLCB3ZSBrbm93IHRoYXQgdGhlICBwcmVjb25kaXRpb25cclxuICAgICAgICAgICAgLy8gbWF0Y2hlZCBvbiB0aGUgYmFja2VuZC4gV2UgdGhlcmVmb3JlIG11c3Qgbm90IGhhdmUgdGhlIGV4cGVjdGVkIHZlcnNpb25cclxuICAgICAgICAgICAgLy8gb2YgdGhlIGRvY3VtZW50IGluIG91ciBjYWNoZSBhbmQgcmV0dXJuIGFuIFVua25vd25Eb2N1bWVudCB3aXRoIHRoZVxyXG4gICAgICAgICAgICAvLyBrbm93biB1cGRhdGVUaW1lLlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFVua25vd25Eb2N1bWVudCh0aGlzLmtleSwgbXV0YXRpb25SZXN1bHQudmVyc2lvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBkb2MgPSB0aGlzLnJlcXVpcmVEb2N1bWVudChtYXliZURvYyk7XHJcbiAgICAgICAgdmFyIHRyYW5zZm9ybVJlc3VsdHMgPSB0aGlzLnNlcnZlclRyYW5zZm9ybVJlc3VsdHMobWF5YmVEb2MsIG11dGF0aW9uUmVzdWx0LnRyYW5zZm9ybVJlc3VsdHMpO1xyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gbXV0YXRpb25SZXN1bHQudmVyc2lvbjtcclxuICAgICAgICB2YXIgbmV3RGF0YSA9IHRoaXMudHJhbnNmb3JtT2JqZWN0KGRvYy5kYXRhLCB0cmFuc2Zvcm1SZXN1bHRzKTtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50KHRoaXMua2V5LCB2ZXJzaW9uLCBuZXdEYXRhLCB7XHJcbiAgICAgICAgICAgIGhhc0NvbW1pdHRlZE11dGF0aW9uczogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRyYW5zZm9ybU11dGF0aW9uLnByb3RvdHlwZS5hcHBseVRvTG9jYWxWaWV3ID0gZnVuY3Rpb24gKG1heWJlRG9jLCBiYXNlRG9jLCBsb2NhbFdyaXRlVGltZSkge1xyXG4gICAgICAgIHRoaXMudmVyaWZ5S2V5TWF0Y2hlcyhtYXliZURvYyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnByZWNvbmRpdGlvbi5pc1ZhbGlkRm9yKG1heWJlRG9jKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbWF5YmVEb2M7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBkb2MgPSB0aGlzLnJlcXVpcmVEb2N1bWVudChtYXliZURvYyk7XHJcbiAgICAgICAgdmFyIHRyYW5zZm9ybVJlc3VsdHMgPSB0aGlzLmxvY2FsVHJhbnNmb3JtUmVzdWx0cyhsb2NhbFdyaXRlVGltZSwgYmFzZURvYyk7XHJcbiAgICAgICAgdmFyIG5ld0RhdGEgPSB0aGlzLnRyYW5zZm9ybU9iamVjdChkb2MuZGF0YSwgdHJhbnNmb3JtUmVzdWx0cyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudCh0aGlzLmtleSwgZG9jLnZlcnNpb24sIG5ld0RhdGEsIHtcclxuICAgICAgICAgICAgaGFzTG9jYWxNdXRhdGlvbnM6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBUcmFuc2Zvcm1NdXRhdGlvbi5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBUcmFuc2Zvcm1NdXRhdGlvbiAmJlxyXG4gICAgICAgICAgICB0aGlzLmtleS5pc0VxdWFsKG90aGVyLmtleSkgJiZcclxuICAgICAgICAgICAgYXJyYXlFcXVhbHModGhpcy5maWVsZFRyYW5zZm9ybXMsIG90aGVyLmZpZWxkVHJhbnNmb3JtcykgJiZcclxuICAgICAgICAgICAgdGhpcy5wcmVjb25kaXRpb24uaXNFcXVhbChvdGhlci5wcmVjb25kaXRpb24pKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFzc2VydHMgdGhhdCB0aGUgZ2l2ZW4gTWF5YmVEb2N1bWVudCBpcyBhY3R1YWxseSBhIERvY3VtZW50IGFuZCB2ZXJpZmllc1xyXG4gICAgICogdGhhdCBpdCBtYXRjaGVzIHRoZSBrZXkgZm9yIHRoaXMgbXV0YXRpb24uIFNpbmNlIHdlIG9ubHkgc3VwcG9ydFxyXG4gICAgICogdHJhbnNmb3JtYXRpb25zIHdpdGggcHJlY29uZGl0aW9uIGV4aXN0cyB0aGlzIG1ldGhvZCBpcyBndWFyYW50ZWVkIHRvIGJlXHJcbiAgICAgKiBzYWZlLlxyXG4gICAgICovXHJcbiAgICBUcmFuc2Zvcm1NdXRhdGlvbi5wcm90b3R5cGUucmVxdWlyZURvY3VtZW50ID0gZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgYXNzZXJ0KG1heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQsICdVbmtub3duIE1heWJlRG9jdW1lbnQgdHlwZSAnICsgbWF5YmVEb2MpO1xyXG4gICAgICAgIHZhciBkb2MgPSBtYXliZURvYztcclxuICAgICAgICBhc3NlcnQoZG9jLmtleS5pc0VxdWFsKHRoaXMua2V5KSwgJ0NhbiBvbmx5IHRyYW5zZm9ybSBhIGRvY3VtZW50IHdpdGggdGhlIHNhbWUga2V5Jyk7XHJcbiAgICAgICAgcmV0dXJuIGRvYztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBsaXN0IG9mIFwidHJhbnNmb3JtIHJlc3VsdHNcIiAoYSB0cmFuc2Zvcm0gcmVzdWx0IGlzIGEgZmllbGQgdmFsdWVcclxuICAgICAqIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIGEgdHJhbnNmb3JtKSBmb3IgdXNlIGFmdGVyIGFcclxuICAgICAqIFRyYW5zZm9ybU11dGF0aW9uIGhhcyBiZWVuIGFja25vd2xlZGdlZCBieSB0aGUgc2VydmVyLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBiYXNlRG9jIFRoZSBkb2N1bWVudCBwcmlvciB0byBhcHBseWluZyB0aGlzIG11dGF0aW9uIGJhdGNoLlxyXG4gICAgICogQHBhcmFtIHNlcnZlclRyYW5zZm9ybVJlc3VsdHMgVGhlIHRyYW5zZm9ybSByZXN1bHRzIHJlY2VpdmVkIGJ5IHRoZSBzZXJ2ZXIuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxyXG4gICAgICovXHJcbiAgICBUcmFuc2Zvcm1NdXRhdGlvbi5wcm90b3R5cGUuc2VydmVyVHJhbnNmb3JtUmVzdWx0cyA9IGZ1bmN0aW9uIChiYXNlRG9jLCBzZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzKSB7XHJcbiAgICAgICAgdmFyIHRyYW5zZm9ybVJlc3VsdHMgPSBbXTtcclxuICAgICAgICBhc3NlcnQodGhpcy5maWVsZFRyYW5zZm9ybXMubGVuZ3RoID09PSBzZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzLmxlbmd0aCwgXCJzZXJ2ZXIgdHJhbnNmb3JtIHJlc3VsdCBjb3VudCAoXCIgKyBzZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzLmxlbmd0aCArIFwiKSBcIiArXHJcbiAgICAgICAgICAgIChcInNob3VsZCBtYXRjaCBmaWVsZCB0cmFuc2Zvcm0gY291bnQgKFwiICsgdGhpcy5maWVsZFRyYW5zZm9ybXMubGVuZ3RoICsgXCIpXCIpKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlcnZlclRyYW5zZm9ybVJlc3VsdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGZpZWxkVHJhbnNmb3JtID0gdGhpcy5maWVsZFRyYW5zZm9ybXNbaV07XHJcbiAgICAgICAgICAgIHZhciB0cmFuc2Zvcm0gPSBmaWVsZFRyYW5zZm9ybS50cmFuc2Zvcm07XHJcbiAgICAgICAgICAgIHZhciBwcmV2aW91c1ZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKGJhc2VEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgcHJldmlvdXNWYWx1ZSA9IGJhc2VEb2MuZmllbGQoZmllbGRUcmFuc2Zvcm0uZmllbGQpIHx8IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdHJhbnNmb3JtUmVzdWx0cy5wdXNoKHRyYW5zZm9ybS5hcHBseVRvUmVtb3RlRG9jdW1lbnQocHJldmlvdXNWYWx1ZSwgc2VydmVyVHJhbnNmb3JtUmVzdWx0c1tpXSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJhbnNmb3JtUmVzdWx0cztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBsaXN0IG9mIFwidHJhbnNmb3JtIHJlc3VsdHNcIiAoYSB0cmFuc2Zvcm0gcmVzdWx0IGlzIGEgZmllbGQgdmFsdWVcclxuICAgICAqIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIGEgdHJhbnNmb3JtKSBmb3IgdXNlIHdoZW4gYXBwbHlpbmcgYVxyXG4gICAgICogVHJhbnNmb3JtTXV0YXRpb24gbG9jYWxseS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbG9jYWxXcml0ZVRpbWUgVGhlIGxvY2FsIHRpbWUgb2YgdGhlIHRyYW5zZm9ybSBtdXRhdGlvbiAodXNlZCB0b1xyXG4gICAgICogICAgIGdlbmVyYXRlIFNlcnZlclRpbWVzdGFtcFZhbHVlcykuXHJcbiAgICAgKiBAcGFyYW0gYmFzZURvYyBUaGUgZG9jdW1lbnQgcHJpb3IgdG8gYXBwbHlpbmcgdGhpcyBtdXRhdGlvbiBiYXRjaC5cclxuICAgICAqIEByZXR1cm4gVGhlIHRyYW5zZm9ybSByZXN1bHRzIGxpc3QuXHJcbiAgICAgKi9cclxuICAgIFRyYW5zZm9ybU11dGF0aW9uLnByb3RvdHlwZS5sb2NhbFRyYW5zZm9ybVJlc3VsdHMgPSBmdW5jdGlvbiAobG9jYWxXcml0ZVRpbWUsIGJhc2VEb2MpIHtcclxuICAgICAgICB2YXIgdHJhbnNmb3JtUmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmZpZWxkVHJhbnNmb3JtczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGZpZWxkVHJhbnNmb3JtID0gX2FbX2ldO1xyXG4gICAgICAgICAgICB2YXIgdHJhbnNmb3JtID0gZmllbGRUcmFuc2Zvcm0udHJhbnNmb3JtO1xyXG4gICAgICAgICAgICB2YXIgcHJldmlvdXNWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChiYXNlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHByZXZpb3VzVmFsdWUgPSBiYXNlRG9jLmZpZWxkKGZpZWxkVHJhbnNmb3JtLmZpZWxkKSB8fCBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybVJlc3VsdHMucHVzaCh0cmFuc2Zvcm0uYXBwbHlUb0xvY2FsVmlldyhwcmV2aW91c1ZhbHVlLCBsb2NhbFdyaXRlVGltZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJhbnNmb3JtUmVzdWx0cztcclxuICAgIH07XHJcbiAgICBUcmFuc2Zvcm1NdXRhdGlvbi5wcm90b3R5cGUudHJhbnNmb3JtT2JqZWN0ID0gZnVuY3Rpb24gKGRhdGEsIHRyYW5zZm9ybVJlc3VsdHMpIHtcclxuICAgICAgICBhc3NlcnQodHJhbnNmb3JtUmVzdWx0cy5sZW5ndGggPT09IHRoaXMuZmllbGRUcmFuc2Zvcm1zLmxlbmd0aCwgJ1RyYW5zZm9ybVJlc3VsdHMgbGVuZ3RoIG1pc21hdGNoLicpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5maWVsZFRyYW5zZm9ybXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGZpZWxkVHJhbnNmb3JtID0gdGhpcy5maWVsZFRyYW5zZm9ybXNbaV07XHJcbiAgICAgICAgICAgIHZhciBmaWVsZFBhdGggPSBmaWVsZFRyYW5zZm9ybS5maWVsZDtcclxuICAgICAgICAgICAgZGF0YSA9IGRhdGEuc2V0KGZpZWxkUGF0aCwgdHJhbnNmb3JtUmVzdWx0c1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUcmFuc2Zvcm1NdXRhdGlvbjtcclxufShNdXRhdGlvbikpO1xyXG4vKiogQSBtdXRhdGlvbiB0aGF0IGRlbGV0ZXMgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkuICovXHJcbnZhciBEZWxldGVNdXRhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKERlbGV0ZU11dGF0aW9uLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gRGVsZXRlTXV0YXRpb24oa2V5LCBwcmVjb25kaXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmtleSA9IGtleTtcclxuICAgICAgICBfdGhpcy5wcmVjb25kaXRpb24gPSBwcmVjb25kaXRpb247XHJcbiAgICAgICAgX3RoaXMudHlwZSA9IE11dGF0aW9uVHlwZS5EZWxldGU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgRGVsZXRlTXV0YXRpb24ucHJvdG90eXBlLmFwcGx5VG9SZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChtYXliZURvYywgbXV0YXRpb25SZXN1bHQpIHtcclxuICAgICAgICB0aGlzLnZlcmlmeUtleU1hdGNoZXMobWF5YmVEb2MpO1xyXG4gICAgICAgIGFzc2VydChtdXRhdGlvblJlc3VsdC50cmFuc2Zvcm1SZXN1bHRzID09IG51bGwsICdUcmFuc2Zvcm0gcmVzdWx0cyByZWNlaXZlZCBieSBEZWxldGVNdXRhdGlvbi4nKTtcclxuICAgICAgICAvLyBVbmxpa2UgYXBwbHlUb0xvY2FsVmlldywgaWYgd2UncmUgYXBwbHlpbmcgYSBtdXRhdGlvbiB0byBhIHJlbW90ZVxyXG4gICAgICAgIC8vIGRvY3VtZW50IHRoZSBzZXJ2ZXIgaGFzIGFjY2VwdGVkIHRoZSBtdXRhdGlvbiBzbyB0aGUgcHJlY29uZGl0aW9uIG11c3RcclxuICAgICAgICAvLyBoYXZlIGhlbGQuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBOb0RvY3VtZW50KHRoaXMua2V5LCBtdXRhdGlvblJlc3VsdC52ZXJzaW9uLCB7XHJcbiAgICAgICAgICAgIGhhc0NvbW1pdHRlZE11dGF0aW9uczogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIERlbGV0ZU11dGF0aW9uLnByb3RvdHlwZS5hcHBseVRvTG9jYWxWaWV3ID0gZnVuY3Rpb24gKG1heWJlRG9jLCBiYXNlRG9jLCBsb2NhbFdyaXRlVGltZSkge1xyXG4gICAgICAgIHRoaXMudmVyaWZ5S2V5TWF0Y2hlcyhtYXliZURvYyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnByZWNvbmRpdGlvbi5pc1ZhbGlkRm9yKG1heWJlRG9jKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbWF5YmVEb2M7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChtYXliZURvYykge1xyXG4gICAgICAgICAgICBhc3NlcnQobWF5YmVEb2Mua2V5LmlzRXF1YWwodGhpcy5rZXkpLCAnQ2FuIG9ubHkgYXBwbHkgbXV0YXRpb24gdG8gZG9jdW1lbnQgd2l0aCBzYW1lIGtleScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IE5vRG9jdW1lbnQodGhpcy5rZXksIFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCkpO1xyXG4gICAgfTtcclxuICAgIERlbGV0ZU11dGF0aW9uLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIERlbGV0ZU11dGF0aW9uICYmXHJcbiAgICAgICAgICAgIHRoaXMua2V5LmlzRXF1YWwob3RoZXIua2V5KSAmJlxyXG4gICAgICAgICAgICB0aGlzLnByZWNvbmRpdGlvbi5pc0VxdWFsKG90aGVyLnByZWNvbmRpdGlvbikpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEZWxldGVNdXRhdGlvbjtcclxufShNdXRhdGlvbikpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqIFRyYW5zZm9ybXMgYSB2YWx1ZSBpbnRvIGEgc2VydmVyLWdlbmVyYXRlZCB0aW1lc3RhbXAuICovXHJcbnZhciBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0oKSB7XHJcbiAgICB9XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0ucHJvdG90eXBlLmFwcGx5VG9Mb2NhbFZpZXcgPSBmdW5jdGlvbiAocHJldmlvdXNWYWx1ZSwgbG9jYWxXcml0ZVRpbWUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNlcnZlclRpbWVzdGFtcFZhbHVlKGxvY2FsV3JpdGVUaW1lLCBwcmV2aW91c1ZhbHVlKTtcclxuICAgIH07XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0ucHJvdG90eXBlLmFwcGx5VG9SZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlLCB0cmFuc2Zvcm1SZXN1bHQpIHtcclxuICAgICAgICByZXR1cm4gdHJhbnNmb3JtUmVzdWx0O1xyXG4gICAgfTtcclxuICAgIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiBvdGhlciBpbnN0YW5jZW9mIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybTtcclxuICAgIH07XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0uaW5zdGFuY2UgPSBuZXcgU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtKCk7XHJcbiAgICByZXR1cm4gU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtO1xyXG59KCkpO1xyXG4vKiogVHJhbnNmb3JtcyBhbiBhcnJheSB2YWx1ZSB2aWEgYSB1bmlvbiBvcGVyYXRpb24uICovXHJcbnZhciBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbihlbGVtZW50cykge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudHMgPSBlbGVtZW50cztcclxuICAgIH1cclxuICAgIEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24ucHJvdG90eXBlLmFwcGx5VG9Mb2NhbFZpZXcgPSBmdW5jdGlvbiAocHJldmlvdXNWYWx1ZSwgbG9jYWxXcml0ZVRpbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseShwcmV2aW91c1ZhbHVlKTtcclxuICAgIH07XHJcbiAgICBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uLnByb3RvdHlwZS5hcHBseVRvUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAocHJldmlvdXNWYWx1ZSwgdHJhbnNmb3JtUmVzdWx0KSB7XHJcbiAgICAgICAgLy8gVGhlIHNlcnZlciBqdXN0IHNlbmRzIG51bGwgYXMgdGhlIHRyYW5zZm9ybSByZXN1bHQgZm9yIGFycmF5IG9wZXJhdGlvbnMsXHJcbiAgICAgICAgLy8gc28gd2UgaGF2ZSB0byBjYWxjdWxhdGUgYSByZXN1bHQgdGhlIHNhbWUgYXMgd2UgZG8gZm9yIGxvY2FsXHJcbiAgICAgICAgLy8gYXBwbGljYXRpb25zLlxyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5KHByZXZpb3VzVmFsdWUpO1xyXG4gICAgfTtcclxuICAgIEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24ucHJvdG90eXBlLmFwcGx5ID0gZnVuY3Rpb24gKHByZXZpb3VzVmFsdWUpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gY29lcmNlZEZpZWxkVmFsdWVzQXJyYXkocHJldmlvdXNWYWx1ZSk7XHJcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAodG9Vbmlvbikge1xyXG4gICAgICAgICAgICBpZiAoIXJlc3VsdC5maW5kKGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBlbGVtZW50LmlzRXF1YWwodG9Vbmlvbik7IH0pKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh0b1VuaW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZWxlbWVudHM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0b1VuaW9uID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBfbG9vcF8xKHRvVW5pb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IEFycmF5VmFsdWUocmVzdWx0KTtcclxuICAgIH07XHJcbiAgICBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24gJiZcclxuICAgICAgICAgICAgYXJyYXlFcXVhbHMob3RoZXIuZWxlbWVudHMsIHRoaXMuZWxlbWVudHMpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbjtcclxufSgpKTtcclxuLyoqIFRyYW5zZm9ybXMgYW4gYXJyYXkgdmFsdWUgdmlhIGEgcmVtb3ZlIG9wZXJhdGlvbi4gKi9cclxudmFyIEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24oZWxlbWVudHMpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnRzID0gZWxlbWVudHM7XHJcbiAgICB9XHJcbiAgICBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbi5wcm90b3R5cGUuYXBwbHlUb0xvY2FsVmlldyA9IGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlLCBsb2NhbFdyaXRlVGltZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5KHByZXZpb3VzVmFsdWUpO1xyXG4gICAgfTtcclxuICAgIEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uLnByb3RvdHlwZS5hcHBseVRvUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAocHJldmlvdXNWYWx1ZSwgdHJhbnNmb3JtUmVzdWx0KSB7XHJcbiAgICAgICAgLy8gVGhlIHNlcnZlciBqdXN0IHNlbmRzIG51bGwgYXMgdGhlIHRyYW5zZm9ybSByZXN1bHQgZm9yIGFycmF5IG9wZXJhdGlvbnMsXHJcbiAgICAgICAgLy8gc28gd2UgaGF2ZSB0byBjYWxjdWxhdGUgYSByZXN1bHQgdGhlIHNhbWUgYXMgd2UgZG8gZm9yIGxvY2FsXHJcbiAgICAgICAgLy8gYXBwbGljYXRpb25zLlxyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5KHByZXZpb3VzVmFsdWUpO1xyXG4gICAgfTtcclxuICAgIEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uLnByb3RvdHlwZS5hcHBseSA9IGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IGNvZXJjZWRGaWVsZFZhbHVlc0FycmF5KHByZXZpb3VzVmFsdWUpO1xyXG4gICAgICAgIHZhciBfbG9vcF8yID0gZnVuY3Rpb24gKHRvUmVtb3ZlKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIoZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuICFlbGVtZW50LmlzRXF1YWwodG9SZW1vdmUpOyB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmVsZW1lbnRzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgdG9SZW1vdmUgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIF9sb29wXzIodG9SZW1vdmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IEFycmF5VmFsdWUocmVzdWx0KTtcclxuICAgIH07XHJcbiAgICBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbi5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbiAmJlxyXG4gICAgICAgICAgICBhcnJheUVxdWFscyhvdGhlci5lbGVtZW50cywgdGhpcy5lbGVtZW50cykpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbjtcclxufSgpKTtcclxuZnVuY3Rpb24gY29lcmNlZEZpZWxkVmFsdWVzQXJyYXkodmFsdWUpIHtcclxuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5VmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUuaW50ZXJuYWxWYWx1ZS5zbGljZSgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gY29lcmNlIHRvIGVtcHR5IGFycmF5LlxyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIEV4aXN0ZW5jZUZpbHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8vIFRPRE8oYi8zMzA3ODE2Myk6IGp1c3QgdXNlIHNpbXBsZXN0IGZvcm0gb2YgZXhpc3RlbmNlIGZpbHRlciBmb3Igbm93XHJcbiAgICBmdW5jdGlvbiBFeGlzdGVuY2VGaWx0ZXIoY291bnQpIHtcclxuICAgICAgICB0aGlzLmNvdW50ID0gY291bnQ7XHJcbiAgICB9XHJcbiAgICBFeGlzdGVuY2VGaWx0ZXIucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gb3RoZXIgJiYgb3RoZXIuY291bnQgPT09IHRoaXMuY291bnQ7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEV4aXN0ZW5jZUZpbHRlcjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBFcnJvciBDb2RlcyBkZXNjcmliaW5nIHRoZSBkaWZmZXJlbnQgd2F5cyBHUlBDIGNhbiBmYWlsLiBUaGVzZSBhcmUgY29waWVkXHJcbiAqIGRpcmVjdGx5IGZyb20gR1JQQydzIHNvdXJjZXMgaGVyZTpcclxuICpcclxuICogaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcclxuICpcclxuICogSW1wb3J0YW50ISBUaGUgbmFtZXMgb2YgdGhlc2UgaWRlbnRpZmllcnMgbWF0dGVyIGJlY2F1c2UgdGhlIHN0cmluZyBmb3Jtc1xyXG4gKiBhcmUgdXNlZCBmb3IgcmV2ZXJzZSBsb29rdXBzIGZyb20gdGhlIHdlYmNoYW5uZWwgc3RyZWFtLiBEbyBOT1QgY2hhbmdlIHRoZVxyXG4gKiBuYW1lcyBvZiB0aGVzZSBpZGVudGlmaWVycy5cclxuICovXHJcbnZhciBScGNDb2RlO1xyXG4oZnVuY3Rpb24gKFJwY0NvZGUpIHtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIk9LXCJdID0gMF0gPSBcIk9LXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJDQU5DRUxMRURcIl0gPSAxXSA9IFwiQ0FOQ0VMTEVEXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJVTktOT1dOXCJdID0gMl0gPSBcIlVOS05PV05cIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIklOVkFMSURfQVJHVU1FTlRcIl0gPSAzXSA9IFwiSU5WQUxJRF9BUkdVTUVOVFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiREVBRExJTkVfRVhDRUVERURcIl0gPSA0XSA9IFwiREVBRExJTkVfRVhDRUVERURcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIk5PVF9GT1VORFwiXSA9IDVdID0gXCJOT1RfRk9VTkRcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIkFMUkVBRFlfRVhJU1RTXCJdID0gNl0gPSBcIkFMUkVBRFlfRVhJU1RTXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJQRVJNSVNTSU9OX0RFTklFRFwiXSA9IDddID0gXCJQRVJNSVNTSU9OX0RFTklFRFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiVU5BVVRIRU5USUNBVEVEXCJdID0gMTZdID0gXCJVTkFVVEhFTlRJQ0FURURcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIlJFU09VUkNFX0VYSEFVU1RFRFwiXSA9IDhdID0gXCJSRVNPVVJDRV9FWEhBVVNURURcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIkZBSUxFRF9QUkVDT05ESVRJT05cIl0gPSA5XSA9IFwiRkFJTEVEX1BSRUNPTkRJVElPTlwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiQUJPUlRFRFwiXSA9IDEwXSA9IFwiQUJPUlRFRFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiT1VUX09GX1JBTkdFXCJdID0gMTFdID0gXCJPVVRfT0ZfUkFOR0VcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIlVOSU1QTEVNRU5URURcIl0gPSAxMl0gPSBcIlVOSU1QTEVNRU5URURcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIklOVEVSTkFMXCJdID0gMTNdID0gXCJJTlRFUk5BTFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiVU5BVkFJTEFCTEVcIl0gPSAxNF0gPSBcIlVOQVZBSUxBQkxFXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJEQVRBX0xPU1NcIl0gPSAxNV0gPSBcIkRBVEFfTE9TU1wiO1xyXG59KShScGNDb2RlIHx8IChScGNDb2RlID0ge30pKTtcclxuZnVuY3Rpb24gaXNQZXJtYW5lbnRFcnJvcihjb2RlKSB7XHJcbiAgICBzd2l0Y2ggKGNvZGUpIHtcclxuICAgICAgICBjYXNlIENvZGUuT0s6XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdUcmVhdGVkIHN0YXR1cyBPSyBhcyBlcnJvcicpO1xyXG4gICAgICAgIGNhc2UgQ29kZS5DQU5DRUxMRUQ6XHJcbiAgICAgICAgY2FzZSBDb2RlLlVOS05PV046XHJcbiAgICAgICAgY2FzZSBDb2RlLkRFQURMSU5FX0VYQ0VFREVEOlxyXG4gICAgICAgIGNhc2UgQ29kZS5SRVNPVVJDRV9FWEhBVVNURUQ6XHJcbiAgICAgICAgY2FzZSBDb2RlLklOVEVSTkFMOlxyXG4gICAgICAgIGNhc2UgQ29kZS5VTkFWQUlMQUJMRTpcclxuICAgICAgICAvLyBVbmF1dGhlbnRpY2F0ZWQgbWVhbnMgc29tZXRoaW5nIHdlbnQgd3Jvbmcgd2l0aCBvdXIgdG9rZW4gYW5kIHdlIG5lZWRcclxuICAgICAgICAvLyB0byByZXRyeSB3aXRoIG5ldyBjcmVkZW50aWFscyB3aGljaCB3aWxsIGhhcHBlbiBhdXRvbWF0aWNhbGx5LlxyXG4gICAgICAgIGNhc2UgQ29kZS5VTkFVVEhFTlRJQ0FURUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICBjYXNlIENvZGUuSU5WQUxJRF9BUkdVTUVOVDpcclxuICAgICAgICBjYXNlIENvZGUuTk9UX0ZPVU5EOlxyXG4gICAgICAgIGNhc2UgQ29kZS5BTFJFQURZX0VYSVNUUzpcclxuICAgICAgICBjYXNlIENvZGUuUEVSTUlTU0lPTl9ERU5JRUQ6XHJcbiAgICAgICAgY2FzZSBDb2RlLkZBSUxFRF9QUkVDT05ESVRJT046XHJcbiAgICAgICAgLy8gQWJvcnRlZCBtaWdodCBiZSByZXRyaWVkIGluIHNvbWUgc2NlbmFyaW9zLCBidXQgdGhhdCBpcyBkZXBlbmRhbnQgb25cclxuICAgICAgICAvLyB0aGUgY29udGV4dCBhbmQgc2hvdWxkIGhhbmRsZWQgaW5kaXZpZHVhbGx5IGJ5IHRoZSBjYWxsaW5nIGNvZGUuXHJcbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9hcGlzL2Rlc2lnbi9lcnJvcnMuXHJcbiAgICAgICAgY2FzZSBDb2RlLkFCT1JURUQ6XHJcbiAgICAgICAgY2FzZSBDb2RlLk9VVF9PRl9SQU5HRTpcclxuICAgICAgICBjYXNlIENvZGUuVU5JTVBMRU1FTlRFRDpcclxuICAgICAgICBjYXNlIENvZGUuREFUQV9MT1NTOlxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBzdGF0dXMgY29kZTogJyArIGNvZGUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBNYXBzIGFuIGVycm9yIENvZGUgZnJvbSBhIEdSUEMgc3RhdHVzIGlkZW50aWZpZXIgbGlrZSAnTk9UX0ZPVU5EJy5cclxuICpcclxuICogQHJldHVybnMgVGhlIENvZGUgZXF1aXZhbGVudCB0byB0aGUgZ2l2ZW4gc3RhdHVzIHN0cmluZyBvciB1bmRlZmluZWQgaWZcclxuICogICAgIHRoZXJlIGlzIG5vIG1hdGNoLlxyXG4gKi9cclxuZnVuY3Rpb24gbWFwQ29kZUZyb21ScGNTdGF0dXMoc3RhdHVzKSB7XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IGxvb2t1cCBieSBzdHJpbmdcclxuICAgIHZhciBjb2RlID0gUnBjQ29kZVtzdGF0dXNdO1xyXG4gICAgaWYgKGNvZGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWFwQ29kZUZyb21ScGNDb2RlKGNvZGUpO1xyXG59XHJcbi8qKlxyXG4gKiBNYXBzIGFuIGVycm9yIENvZGUgZnJvbSBHUlBDIHN0YXR1cyBjb2RlIG51bWJlciwgbGlrZSAwLCAxLCBvciAxNC4gVGhlc2VcclxuICogYXJlIG5vdCB0aGUgc2FtZSBhcyBIVFRQIHN0YXR1cyBjb2Rlcy5cclxuICpcclxuICogQHJldHVybnMgVGhlIENvZGUgZXF1aXZhbGVudCB0byB0aGUgZ2l2ZW4gR1JQQyBzdGF0dXMgY29kZS4gRmFpbHMgaWYgdGhlcmVcclxuICogICAgIGlzIG5vIG1hdGNoLlxyXG4gKi9cclxuZnVuY3Rpb24gbWFwQ29kZUZyb21ScGNDb2RlKGNvZGUpIHtcclxuICAgIGlmIChjb2RlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAvLyBUaGlzIHNob3VsZG4ndCBub3JtYWxseSBoYXBwZW4sIGJ1dCBpbiBjZXJ0YWluIGVycm9yIGNhc2VzIChsaWtlIHRyeWluZ1xyXG4gICAgICAgIC8vIHRvIHNlbmQgaW52YWxpZCBwcm90byBtZXNzYWdlcykgd2UgbWF5IGdldCBhbiBlcnJvciB3aXRoIG5vIEdSUEMgY29kZS5cclxuICAgICAgICBlcnJvcignR1JQQyBlcnJvciBoYXMgbm8gLmNvZGUnKTtcclxuICAgICAgICByZXR1cm4gQ29kZS5VTktOT1dOO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLk9LOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5PSztcclxuICAgICAgICBjYXNlIFJwY0NvZGUuQ0FOQ0VMTEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5DQU5DRUxMRUQ7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLlVOS05PV046XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlVOS05PV047XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLkRFQURMSU5FX0VYQ0VFREVEOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5ERUFETElORV9FWENFRURFRDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuUkVTT1VSQ0VfRVhIQVVTVEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5SRVNPVVJDRV9FWEhBVVNURUQ7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLklOVEVSTkFMOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5JTlRFUk5BTDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuVU5BVkFJTEFCTEU6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlVOQVZBSUxBQkxFO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5VTkFVVEhFTlRJQ0FURUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlVOQVVUSEVOVElDQVRFRDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuSU5WQUxJRF9BUkdVTUVOVDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuSU5WQUxJRF9BUkdVTUVOVDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuTk9UX0ZPVU5EOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5OT1RfRk9VTkQ7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLkFMUkVBRFlfRVhJU1RTOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5BTFJFQURZX0VYSVNUUztcclxuICAgICAgICBjYXNlIFJwY0NvZGUuUEVSTUlTU0lPTl9ERU5JRUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlBFUk1JU1NJT05fREVOSUVEO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5BQk9SVEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5BQk9SVEVEO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5PVVRfT0ZfUkFOR0U6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLk9VVF9PRl9SQU5HRTtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuVU5JTVBMRU1FTlRFRDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuVU5JTVBMRU1FTlRFRDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuREFUQV9MT1NTOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5EQVRBX0xPU1M7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gc3RhdHVzIGNvZGU6ICcgKyBjb2RlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogTWFwcyBhbiBSUEMgY29kZSBmcm9tIGEgQ29kZS4gVGhpcyBpcyB0aGUgcmV2ZXJzZSBvcGVyYXRpb24gZnJvbVxyXG4gKiBtYXBDb2RlRnJvbVJwY0NvZGUgYW5kIHNob3VsZCByZWFsbHkgb25seSBiZSB1c2VkIGluIHRlc3RzLlxyXG4gKi9cclxuZnVuY3Rpb24gbWFwUnBjQ29kZUZyb21Db2RlKGNvZGUpIHtcclxuICAgIGlmIChjb2RlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4gUnBjQ29kZS5PSztcclxuICAgIH1cclxuICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgIGNhc2UgQ29kZS5PSzpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuT0s7XHJcbiAgICAgICAgY2FzZSBDb2RlLkNBTkNFTExFRDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuQ0FOQ0VMTEVEO1xyXG4gICAgICAgIGNhc2UgQ29kZS5VTktOT1dOOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5VTktOT1dOO1xyXG4gICAgICAgIGNhc2UgQ29kZS5ERUFETElORV9FWENFRURFRDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuREVBRExJTkVfRVhDRUVERUQ7XHJcbiAgICAgICAgY2FzZSBDb2RlLlJFU09VUkNFX0VYSEFVU1RFRDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuUkVTT1VSQ0VfRVhIQVVTVEVEO1xyXG4gICAgICAgIGNhc2UgQ29kZS5JTlRFUk5BTDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuSU5URVJOQUw7XHJcbiAgICAgICAgY2FzZSBDb2RlLlVOQVZBSUxBQkxFOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5VTkFWQUlMQUJMRTtcclxuICAgICAgICBjYXNlIENvZGUuVU5BVVRIRU5USUNBVEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5VTkFVVEhFTlRJQ0FURUQ7XHJcbiAgICAgICAgY2FzZSBDb2RlLklOVkFMSURfQVJHVU1FTlQ6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLklOVkFMSURfQVJHVU1FTlQ7XHJcbiAgICAgICAgY2FzZSBDb2RlLk5PVF9GT1VORDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuTk9UX0ZPVU5EO1xyXG4gICAgICAgIGNhc2UgQ29kZS5BTFJFQURZX0VYSVNUUzpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuQUxSRUFEWV9FWElTVFM7XHJcbiAgICAgICAgY2FzZSBDb2RlLlBFUk1JU1NJT05fREVOSUVEOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5QRVJNSVNTSU9OX0RFTklFRDtcclxuICAgICAgICBjYXNlIENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTjpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuRkFJTEVEX1BSRUNPTkRJVElPTjtcclxuICAgICAgICBjYXNlIENvZGUuQUJPUlRFRDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuQUJPUlRFRDtcclxuICAgICAgICBjYXNlIENvZGUuT1VUX09GX1JBTkdFOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5PVVRfT0ZfUkFOR0U7XHJcbiAgICAgICAgY2FzZSBDb2RlLlVOSU1QTEVNRU5URUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLlVOSU1QTEVNRU5URUQ7XHJcbiAgICAgICAgY2FzZSBDb2RlLkRBVEFfTE9TUzpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuREFUQV9MT1NTO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIHN0YXR1cyBjb2RlOiAnICsgY29kZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIENvbnZlcnRzIGFuIEhUVFAgU3RhdHVzIENvZGUgdG8gdGhlIGVxdWl2YWxlbnQgZXJyb3IgY29kZS5cclxuICpcclxuICogQHBhcmFtIHN0YXR1cyBBbiBIVFRQIFN0YXR1cyBDb2RlLCBsaWtlIDIwMCwgNDA0LCA1MDMsIGV0Yy5cclxuICogQHJldHVybnMgVGhlIGVxdWl2YWxlbnQgQ29kZS4gVW5rbm93biBzdGF0dXMgY29kZXMgYXJlIG1hcHBlZCB0b1xyXG4gKiAgICAgQ29kZS5VTktOT1dOLlxyXG4gKi9cclxuZnVuY3Rpb24gbWFwQ29kZUZyb21IdHRwU3RhdHVzKHN0YXR1cykge1xyXG4gICAgLy8gVGhlIGNhbm9uaWNhbCBlcnJvciBjb2RlcyBmb3IgR29vZ2xlIEFQSXMgWzFdIHNwZWNpZnkgbWFwcGluZyBvbnRvIEhUVFBcclxuICAgIC8vIHN0YXR1cyBjb2RlcyBidXQgdGhlIG1hcHBpbmcgaXMgbm90IGJpamVjdGl2ZS4gSW4gZWFjaCBjYXNlIG9mIGFtYmlndWl0eVxyXG4gICAgLy8gdGhpcyBmdW5jdGlvbiBjaG9vc2VzIGEgcHJpbWFyeSBlcnJvci5cclxuICAgIC8vXHJcbiAgICAvLyBbMV1cclxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGVhcGlzL2dvb2dsZWFwaXMvYmxvYi9tYXN0ZXIvZ29vZ2xlL3JwYy9jb2RlLnByb3RvXHJcbiAgICBzd2l0Y2ggKHN0YXR1cykge1xyXG4gICAgICAgIGNhc2UgMjAwOiAvLyBPS1xyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5PSztcclxuICAgICAgICBjYXNlIDQwMDogLy8gQmFkIFJlcXVlc3RcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuSU5WQUxJRF9BUkdVTUVOVDtcclxuICAgICAgICAvLyBPdGhlciBwb3NzaWJpbGl0aWVzIGJhc2VkIG9uIHRoZSBmb3J3YXJkIG1hcHBpbmdcclxuICAgICAgICAvLyByZXR1cm4gQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OO1xyXG4gICAgICAgIC8vIHJldHVybiBDb2RlLk9VVF9PRl9SQU5HRTtcclxuICAgICAgICBjYXNlIDQwMTogLy8gVW5hdXRob3JpemVkXHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlVOQVVUSEVOVElDQVRFRDtcclxuICAgICAgICBjYXNlIDQwMzogLy8gRm9yYmlkZGVuXHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlBFUk1JU1NJT05fREVOSUVEO1xyXG4gICAgICAgIGNhc2UgNDA0OiAvLyBOb3QgRm91bmRcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuTk9UX0ZPVU5EO1xyXG4gICAgICAgIGNhc2UgNDA5OiAvLyBDb25mbGljdFxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5BQk9SVEVEO1xyXG4gICAgICAgIC8vIE90aGVyIHBvc3NpYmlsaXRpZXM6XHJcbiAgICAgICAgLy8gcmV0dXJuIENvZGUuQUxSRUFEWV9FWElTVFM7XHJcbiAgICAgICAgY2FzZSA0MTY6IC8vIFJhbmdlIE5vdCBTYXRpc2ZpYWJsZVxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5PVVRfT0ZfUkFOR0U7XHJcbiAgICAgICAgY2FzZSA0Mjk6IC8vIFRvbyBNYW55IFJlcXVlc3RzXHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlJFU09VUkNFX0VYSEFVU1RFRDtcclxuICAgICAgICBjYXNlIDQ5OTogLy8gQ2xpZW50IENsb3NlZCBSZXF1ZXN0XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLkNBTkNFTExFRDtcclxuICAgICAgICBjYXNlIDUwMDogLy8gSW50ZXJuYWwgU2VydmVyIEVycm9yXHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlVOS05PV047XHJcbiAgICAgICAgLy8gT3RoZXIgcG9zc2liaWxpdGllczpcclxuICAgICAgICAvLyByZXR1cm4gQ29kZS5JTlRFUk5BTDtcclxuICAgICAgICAvLyByZXR1cm4gQ29kZS5EQVRBX0xPU1M7XHJcbiAgICAgICAgY2FzZSA1MDE6IC8vIFVuaW1wbGVtZW50ZWRcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuVU5JTVBMRU1FTlRFRDtcclxuICAgICAgICBjYXNlIDUwMzogLy8gU2VydmljZSBVbmF2YWlsYWJsZVxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5VTkFWQUlMQUJMRTtcclxuICAgICAgICBjYXNlIDUwNDogLy8gR2F0ZXdheSBUaW1lb3V0XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLkRFQURMSU5FX0VYQ0VFREVEO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMClcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb2RlLk9LO1xyXG4gICAgICAgICAgICBpZiAoc3RhdHVzID49IDQwMCAmJiBzdGF0dXMgPCA1MDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OO1xyXG4gICAgICAgICAgICBpZiAoc3RhdHVzID49IDUwMCAmJiBzdGF0dXMgPCA2MDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29kZS5JTlRFUk5BTDtcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuVU5LTk9XTjtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFNvcnRlZFNldCBpcyBhbiBpbW11dGFibGUgKGNvcHktb24td3JpdGUpIGNvbGxlY3Rpb24gdGhhdCBob2xkcyBlbGVtZW50c1xyXG4gKiBpbiBvcmRlciBzcGVjaWZpZWQgYnkgdGhlIHByb3ZpZGVkIGNvbXBhcmF0b3IuXHJcbiAqXHJcbiAqIE5PVEU6IGlmIHByb3ZpZGVkIGNvbXBhcmF0b3IgcmV0dXJucyAwIGZvciB0d28gZWxlbWVudHMsIHdlIGNvbnNpZGVyIHRoZW0gdG9cclxuICogYmUgZXF1YWwhXHJcbiAqL1xyXG52YXIgU29ydGVkU2V0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU29ydGVkU2V0KGNvbXBhcmF0b3IpIHtcclxuICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSBjb21wYXJhdG9yO1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IG5ldyBTb3J0ZWRNYXAodGhpcy5jb21wYXJhdG9yKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIFNvcnRlZFNldCBmcm9tIHRoZSBrZXlzIG9mIHRoZSBtYXAuXHJcbiAgICAgKiBUaGlzIGlzIGN1cnJlbnRseSBpbXBsZW1lbnRlZCBhcyBhbiBPKG4pIGNvcHkuXHJcbiAgICAgKi9cclxuICAgIFNvcnRlZFNldC5mcm9tTWFwS2V5cyA9IGZ1bmN0aW9uIChtYXApIHtcclxuICAgICAgICB2YXIga2V5cyA9IG5ldyBTb3J0ZWRTZXQobWFwLmNvbXBhcmF0b3IpO1xyXG4gICAgICAgIG1hcC5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAga2V5cyA9IGtleXMuYWRkKGtleSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGtleXM7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAoZWxlbSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuZ2V0KGVsZW0pICE9PSBudWxsO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuZmlyc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5taW5LZXkoKTtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmxhc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5tYXhLZXkoKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU29ydGVkU2V0LnByb3RvdHlwZSwgXCJzaXplXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5zaXplO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gKGVsZW0pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmluZGV4T2YoZWxlbSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEl0ZXJhdGVzIGVsZW1lbnRzIGluIG9yZGVyIGRlZmluZWQgYnkgXCJjb21wYXJhdG9yXCIgKi9cclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYikge1xyXG4gICAgICAgIHRoaXMuZGF0YS5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICAgICAgICAgIGNiKGspO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEl0ZXJhdGVzIG92ZXIgYGVsZW1gcyBzdWNoIHRoYXQ6IHJhbmdlWzBdIDw9IGVsZW0gPCByYW5nZVsxXS4gKi9cclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuZm9yRWFjaEluUmFuZ2UgPSBmdW5jdGlvbiAocmFuZ2UsIGNiKSB7XHJcbiAgICAgICAgdmFyIGl0ZXIgPSB0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKHJhbmdlWzBdKTtcclxuICAgICAgICB3aGlsZSAoaXRlci5oYXNOZXh0KCkpIHtcclxuICAgICAgICAgICAgdmFyIGVsZW0gPSBpdGVyLmdldE5leHQoKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY29tcGFyYXRvcihlbGVtLmtleSwgcmFuZ2VbMV0pID49IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIGNiKGVsZW0ua2V5KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGBlbGVtYHMgc3VjaCB0aGF0OiBzdGFydCA8PSBlbGVtIHVudGlsIGZhbHNlIGlzIHJldHVybmVkLlxyXG4gICAgICovXHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmZvckVhY2hXaGlsZSA9IGZ1bmN0aW9uIChjYiwgc3RhcnQpIHtcclxuICAgICAgICB2YXIgaXRlcjtcclxuICAgICAgICBpZiAoc3RhcnQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBpdGVyID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yRnJvbShzdGFydCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpdGVyID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHdoaWxlIChpdGVyLmhhc05leHQoKSkge1xyXG4gICAgICAgICAgICB2YXIgZWxlbSA9IGl0ZXIuZ2V0TmV4dCgpO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gY2IoZWxlbS5rZXkpO1xyXG4gICAgICAgICAgICBpZiAoIXJlc3VsdClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIEZpbmRzIHRoZSBsZWFzdCBlbGVtZW50IGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBgZWxlbWAuICovXHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmZpcnN0QWZ0ZXJPckVxdWFsID0gZnVuY3Rpb24gKGVsZW0pIHtcclxuICAgICAgICB2YXIgaXRlciA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20oZWxlbSk7XHJcbiAgICAgICAgcmV0dXJuIGl0ZXIuaGFzTmV4dCgpID8gaXRlci5nZXROZXh0KCkua2V5IDogbnVsbDtcclxuICAgIH07XHJcbiAgICAvKiogSW5zZXJ0cyBvciB1cGRhdGVzIGFuIGVsZW1lbnQgKi9cclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGVsZW0pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb3B5KHRoaXMuZGF0YS5yZW1vdmUoZWxlbSkuaW5zZXJ0KGVsZW0sIHRydWUpKTtcclxuICAgIH07XHJcbiAgICAvKiogRGVsZXRlcyBhbiBlbGVtZW50ICovXHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChlbGVtKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmhhcyhlbGVtKSlcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29weSh0aGlzLmRhdGEucmVtb3ZlKGVsZW0pKTtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5pc0VtcHR5KCk7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS51bmlvbldpdGggPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcztcclxuICAgICAgICBvdGhlci5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5hZGQoZWxlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIFNvcnRlZFNldCkpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5zaXplICE9PSBvdGhlci5zaXplKVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgdmFyIHRoaXNJdCA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpO1xyXG4gICAgICAgIHZhciBvdGhlckl0ID0gb3RoZXIuZGF0YS5nZXRJdGVyYXRvcigpO1xyXG4gICAgICAgIHdoaWxlICh0aGlzSXQuaGFzTmV4dCgpKSB7XHJcbiAgICAgICAgICAgIHZhciB0aGlzRWxlbSA9IHRoaXNJdC5nZXROZXh0KCkua2V5O1xyXG4gICAgICAgICAgICB2YXIgb3RoZXJFbGVtID0gb3RoZXJJdC5nZXROZXh0KCkua2V5O1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jb21wYXJhdG9yKHRoaXNFbGVtLCBvdGhlckVsZW0pICE9PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHJlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgcmVzLnB1c2godGFyZ2V0SWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtKSB7IHJldHVybiByZXN1bHQucHVzaChlbGVtKTsgfSk7XHJcbiAgICAgICAgcmV0dXJuICdTb3J0ZWRTZXQoJyArIHJlc3VsdC50b1N0cmluZygpICsgJyknO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTb3J0ZWRTZXQodGhpcy5jb21wYXJhdG9yKTtcclxuICAgICAgICByZXN1bHQuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU29ydGVkU2V0O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIEVNUFRZX01BWUJFX0RPQ1VNRU5UX01BUCA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbmZ1bmN0aW9uIG1heWJlRG9jdW1lbnRNYXAoKSB7XHJcbiAgICByZXR1cm4gRU1QVFlfTUFZQkVfRE9DVU1FTlRfTUFQO1xyXG59XHJcbnZhciBFTVBUWV9ET0NVTUVOVF9NQVAgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG5mdW5jdGlvbiBkb2N1bWVudE1hcCgpIHtcclxuICAgIHJldHVybiBFTVBUWV9ET0NVTUVOVF9NQVA7XHJcbn1cclxudmFyIEVNUFRZX0RPQ1VNRU5UX1ZFUlNJT05fTUFQID0gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxuZnVuY3Rpb24gZG9jdW1lbnRWZXJzaW9uTWFwKCkge1xyXG4gICAgcmV0dXJuIEVNUFRZX0RPQ1VNRU5UX1ZFUlNJT05fTUFQO1xyXG59XHJcbnZhciBFTVBUWV9ET0NVTUVOVF9LRVlfU0VUID0gbmV3IFNvcnRlZFNldChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxuZnVuY3Rpb24gZG9jdW1lbnRLZXlTZXQoKSB7XHJcbiAgICByZXR1cm4gRU1QVFlfRE9DVU1FTlRfS0VZX1NFVDtcclxufVxyXG52YXIgRU1QVFlfVEFSR0VUX0lEX1NFVCA9IG5ldyBTb3J0ZWRTZXQocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbmZ1bmN0aW9uIHRhcmdldElkU2V0KCkge1xyXG4gICAgcmV0dXJuIEVNUFRZX1RBUkdFVF9JRF9TRVQ7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBEb2N1bWVudFNldCBpcyBhbiBpbW11dGFibGUgKGNvcHktb24td3JpdGUpIGNvbGxlY3Rpb24gdGhhdCBob2xkcyBkb2N1bWVudHNcclxuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLiBXZSBhbHdheXMgYWRkIGEgZG9jdW1lbnQga2V5XHJcbiAqIGNvbXBhcmF0b3Igb24gdG9wIG9mIHdoYXQgaXMgcHJvdmlkZWQgdG8gZ3VhcmFudGVlIGRvY3VtZW50IGVxdWFsaXR5IGJhc2VkIG9uXHJcbiAqIHRoZSBrZXkuXHJcbiAqL1xyXG52YXIgRG9jdW1lbnRTZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKiogVGhlIGRlZmF1bHQgb3JkZXJpbmcgaXMgYnkga2V5IGlmIHRoZSBjb21wYXJhdG9yIGlzIG9taXR0ZWQgKi9cclxuICAgIGZ1bmN0aW9uIERvY3VtZW50U2V0KGNvbXApIHtcclxuICAgICAgICAvLyBXZSBhcmUgYWRkaW5nIGRvY3VtZW50IGtleSBjb21wYXJhdG9yIHRvIHRoZSBlbmQgYXMgaXQncyB0aGUgb25seVxyXG4gICAgICAgIC8vIGd1YXJhbnRlZWQgdW5pcXVlIHByb3BlcnR5IG9mIGEgZG9jdW1lbnQuXHJcbiAgICAgICAgaWYgKGNvbXApIHtcclxuICAgICAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gZnVuY3Rpb24gKGQxLCBkMikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXAoZDEsIGQyKSB8fCBEb2N1bWVudEtleS5jb21wYXJhdG9yKGQxLmtleSwgZDIua2V5KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcGFyYXRvciA9IGZ1bmN0aW9uIChkMSwgZDIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBEb2N1bWVudEtleS5jb21wYXJhdG9yKGQxLmtleSwgZDIua2V5KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5rZXllZE1hcCA9IGRvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgdGhpcy5zb3J0ZWRTZXQgPSBuZXcgU29ydGVkTWFwKHRoaXMuY29tcGFyYXRvcik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYW4gZW1wdHkgY29weSBvZiB0aGUgZXhpc3RpbmcgRG9jdW1lbnRTZXQsIHVzaW5nIHRoZSBzYW1lXHJcbiAgICAgKiBjb21wYXJhdG9yLlxyXG4gICAgICovXHJcbiAgICBEb2N1bWVudFNldC5lbXB0eVNldCA9IGZ1bmN0aW9uIChvbGRTZXQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50U2V0KG9sZFNldC5jb21wYXJhdG9yKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmtleWVkTWFwLmdldChrZXkpICE9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5rZXllZE1hcC5nZXQoa2V5KTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuZmlyc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0Lm1pbktleSgpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5sYXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5tYXhLZXkoKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQuaXNFbXB0eSgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIHByb3ZpZGVkIGtleSBpbiB0aGUgZG9jdW1lbnQgc2V0LCBvciAtMSBpZiB0aGVcclxuICAgICAqIGRvY3VtZW50IGtleSBpcyBub3QgcHJlc2VudCBpbiB0aGUgc2V0O1xyXG4gICAgICovXHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgZG9jID0gdGhpcy5rZXllZE1hcC5nZXQoa2V5KTtcclxuICAgICAgICByZXR1cm4gZG9jID8gdGhpcy5zb3J0ZWRTZXQuaW5kZXhPZihkb2MpIDogLTE7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvY3VtZW50U2V0LnByb3RvdHlwZSwgXCJzaXplXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0LnNpemU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKiogSXRlcmF0ZXMgZG9jdW1lbnRzIGluIG9yZGVyIGRlZmluZWQgYnkgXCJjb21wYXJhdG9yXCIgKi9cclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNiKSB7XHJcbiAgICAgICAgdGhpcy5zb3J0ZWRTZXQuaW5vcmRlclRyYXZlcnNhbChmdW5jdGlvbiAoaywgdikge1xyXG4gICAgICAgICAgICBjYihrKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBJbnNlcnRzIG9yIHVwZGF0ZXMgYSBkb2N1bWVudCB3aXRoIHRoZSBzYW1lIGtleSAqL1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAvLyBGaXJzdCByZW1vdmUgdGhlIGVsZW1lbnQgaWYgd2UgaGF2ZSBpdC5cclxuICAgICAgICB2YXIgc2V0ID0gdGhpcy5kZWxldGUoZG9jLmtleSk7XHJcbiAgICAgICAgcmV0dXJuIHNldC5jb3B5KHNldC5rZXllZE1hcC5pbnNlcnQoZG9jLmtleSwgZG9jKSwgc2V0LnNvcnRlZFNldC5pbnNlcnQoZG9jLCBudWxsKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIERlbGV0ZXMgYSBkb2N1bWVudCB3aXRoIGEgZ2l2ZW4ga2V5ICovXHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBkb2MgPSB0aGlzLmdldChrZXkpO1xyXG4gICAgICAgIGlmICghZG9jKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5jb3B5KHRoaXMua2V5ZWRNYXAucmVtb3ZlKGtleSksIHRoaXMuc29ydGVkU2V0LnJlbW92ZShkb2MpKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgRG9jdW1lbnRTZXQpKVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSlcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHZhciB0aGlzSXQgPSB0aGlzLnNvcnRlZFNldC5nZXRJdGVyYXRvcigpO1xyXG4gICAgICAgIHZhciBvdGhlckl0ID0gb3RoZXIuc29ydGVkU2V0LmdldEl0ZXJhdG9yKCk7XHJcbiAgICAgICAgd2hpbGUgKHRoaXNJdC5oYXNOZXh0KCkpIHtcclxuICAgICAgICAgICAgdmFyIHRoaXNEb2MgPSB0aGlzSXQuZ2V0TmV4dCgpLmtleTtcclxuICAgICAgICAgICAgdmFyIG90aGVyRG9jID0gb3RoZXJJdC5nZXROZXh0KCkua2V5O1xyXG4gICAgICAgICAgICBpZiAoIXRoaXNEb2MuaXNFcXVhbChvdGhlckRvYykpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZG9jU3RyaW5ncyA9IFtdO1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgICAgIGRvY1N0cmluZ3MucHVzaChkb2MudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKGRvY1N0cmluZ3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnRG9jdW1lbnRTZXQgKCknO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuICdEb2N1bWVudFNldCAoXFxuICAnICsgZG9jU3RyaW5ncy5qb2luKCcgIFxcbicpICsgJ1xcbiknO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChrZXllZE1hcCwgc29ydGVkU2V0KSB7XHJcbiAgICAgICAgdmFyIG5ld1NldCA9IG5ldyBEb2N1bWVudFNldCgpO1xyXG4gICAgICAgIG5ld1NldC5jb21wYXJhdG9yID0gdGhpcy5jb21wYXJhdG9yO1xyXG4gICAgICAgIG5ld1NldC5rZXllZE1hcCA9IGtleWVkTWFwO1xyXG4gICAgICAgIG5ld1NldC5zb3J0ZWRTZXQgPSBzb3J0ZWRTZXQ7XHJcbiAgICAgICAgcmV0dXJuIG5ld1NldDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRG9jdW1lbnRTZXQ7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgQ2hhbmdlVHlwZTtcclxuKGZ1bmN0aW9uIChDaGFuZ2VUeXBlKSB7XHJcbiAgICBDaGFuZ2VUeXBlW0NoYW5nZVR5cGVbXCJBZGRlZFwiXSA9IDBdID0gXCJBZGRlZFwiO1xyXG4gICAgQ2hhbmdlVHlwZVtDaGFuZ2VUeXBlW1wiUmVtb3ZlZFwiXSA9IDFdID0gXCJSZW1vdmVkXCI7XHJcbiAgICBDaGFuZ2VUeXBlW0NoYW5nZVR5cGVbXCJNb2RpZmllZFwiXSA9IDJdID0gXCJNb2RpZmllZFwiO1xyXG4gICAgQ2hhbmdlVHlwZVtDaGFuZ2VUeXBlW1wiTWV0YWRhdGFcIl0gPSAzXSA9IFwiTWV0YWRhdGFcIjtcclxufSkoQ2hhbmdlVHlwZSB8fCAoQ2hhbmdlVHlwZSA9IHt9KSk7XHJcbnZhciBTeW5jU3RhdGU7XHJcbihmdW5jdGlvbiAoU3luY1N0YXRlKSB7XHJcbiAgICBTeW5jU3RhdGVbU3luY1N0YXRlW1wiTG9jYWxcIl0gPSAwXSA9IFwiTG9jYWxcIjtcclxuICAgIFN5bmNTdGF0ZVtTeW5jU3RhdGVbXCJTeW5jZWRcIl0gPSAxXSA9IFwiU3luY2VkXCI7XHJcbn0pKFN5bmNTdGF0ZSB8fCAoU3luY1N0YXRlID0ge30pKTtcclxuLyoqXHJcbiAqIERvY3VtZW50Q2hhbmdlU2V0IGtlZXBzIHRyYWNrIG9mIGEgc2V0IG9mIGNoYW5nZXMgdG8gZG9jcyBpbiBhIHF1ZXJ5LCBtZXJnaW5nXHJcbiAqIGR1cGxpY2F0ZSBldmVudHMgZm9yIHRoZSBzYW1lIGRvYy5cclxuICovXHJcbnZhciBEb2N1bWVudENoYW5nZVNldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERvY3VtZW50Q2hhbmdlU2V0KCkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlTWFwID0gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxuICAgIH1cclxuICAgIERvY3VtZW50Q2hhbmdlU2V0LnByb3RvdHlwZS50cmFjayA9IGZ1bmN0aW9uIChjaGFuZ2UpIHtcclxuICAgICAgICB2YXIga2V5ID0gY2hhbmdlLmRvYy5rZXk7XHJcbiAgICAgICAgdmFyIG9sZENoYW5nZSA9IHRoaXMuY2hhbmdlTWFwLmdldChrZXkpO1xyXG4gICAgICAgIGlmICghb2xkQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwID0gdGhpcy5jaGFuZ2VNYXAuaW5zZXJ0KGtleSwgY2hhbmdlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBNZXJnZSB0aGUgbmV3IGNoYW5nZSB3aXRoIHRoZSBleGlzdGluZyBjaGFuZ2UuXHJcbiAgICAgICAgaWYgKGNoYW5nZS50eXBlICE9PSBDaGFuZ2VUeXBlLkFkZGVkICYmXHJcbiAgICAgICAgICAgIG9sZENoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLk1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwID0gdGhpcy5jaGFuZ2VNYXAuaW5zZXJ0KGtleSwgY2hhbmdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuTWV0YWRhdGEgJiZcclxuICAgICAgICAgICAgb2xkQ2hhbmdlLnR5cGUgIT09IENoYW5nZVR5cGUuUmVtb3ZlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IHRoaXMuY2hhbmdlTWFwLmluc2VydChrZXksIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IG9sZENoYW5nZS50eXBlLFxyXG4gICAgICAgICAgICAgICAgZG9jOiBjaGFuZ2UuZG9jXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5Nb2RpZmllZCAmJlxyXG4gICAgICAgICAgICBvbGRDaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5Nb2RpZmllZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IHRoaXMuY2hhbmdlTWFwLmluc2VydChrZXksIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IENoYW5nZVR5cGUuTW9kaWZpZWQsXHJcbiAgICAgICAgICAgICAgICBkb2M6IGNoYW5nZS5kb2NcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLk1vZGlmaWVkICYmXHJcbiAgICAgICAgICAgIG9sZENoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLkFkZGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwID0gdGhpcy5jaGFuZ2VNYXAuaW5zZXJ0KGtleSwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQ2hhbmdlVHlwZS5BZGRlZCxcclxuICAgICAgICAgICAgICAgIGRvYzogY2hhbmdlLmRvY1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuUmVtb3ZlZCAmJlxyXG4gICAgICAgICAgICBvbGRDaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5BZGRlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IHRoaXMuY2hhbmdlTWFwLnJlbW92ZShrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5SZW1vdmVkICYmXHJcbiAgICAgICAgICAgIG9sZENoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLk1vZGlmaWVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwID0gdGhpcy5jaGFuZ2VNYXAuaW5zZXJ0KGtleSwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQ2hhbmdlVHlwZS5SZW1vdmVkLFxyXG4gICAgICAgICAgICAgICAgZG9jOiBvbGRDaGFuZ2UuZG9jXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5BZGRlZCAmJlxyXG4gICAgICAgICAgICBvbGRDaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5SZW1vdmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwID0gdGhpcy5jaGFuZ2VNYXAuaW5zZXJ0KGtleSwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQ2hhbmdlVHlwZS5Nb2RpZmllZCxcclxuICAgICAgICAgICAgICAgIGRvYzogY2hhbmdlLmRvY1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgaW5jbHVkZXMgdGhlc2UgY2FzZXMsIHdoaWNoIGRvbid0IG1ha2Ugc2Vuc2U6XHJcbiAgICAgICAgICAgIC8vIEFkZGVkLT5BZGRlZFxyXG4gICAgICAgICAgICAvLyBSZW1vdmVkLT5SZW1vdmVkXHJcbiAgICAgICAgICAgIC8vIE1vZGlmaWVkLT5BZGRlZFxyXG4gICAgICAgICAgICAvLyBSZW1vdmVkLT5Nb2RpZmllZFxyXG4gICAgICAgICAgICAvLyBNZXRhZGF0YS0+QWRkZWRcclxuICAgICAgICAgICAgLy8gUmVtb3ZlZC0+TWV0YWRhdGFcclxuICAgICAgICAgICAgZmFpbCgndW5zdXBwb3J0ZWQgY29tYmluYXRpb24gb2YgY2hhbmdlczogJyArXHJcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShjaGFuZ2UpICtcclxuICAgICAgICAgICAgICAgICcgYWZ0ZXIgJyArXHJcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShvbGRDaGFuZ2UpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRDaGFuZ2VTZXQucHJvdG90eXBlLmdldENoYW5nZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSBbXTtcclxuICAgICAgICB0aGlzLmNoYW5nZU1hcC5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChrZXksIGNoYW5nZSkge1xyXG4gICAgICAgICAgICBjaGFuZ2VzLnB1c2goY2hhbmdlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gY2hhbmdlcztcclxuICAgIH07XHJcbiAgICByZXR1cm4gRG9jdW1lbnRDaGFuZ2VTZXQ7XHJcbn0oKSk7XHJcbnZhciBWaWV3U25hcHNob3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBWaWV3U25hcHNob3QocXVlcnksIGRvY3MsIG9sZERvY3MsIGRvY0NoYW5nZXMsIG11dGF0ZWRLZXlzLCBmcm9tQ2FjaGUsIHN5bmNTdGF0ZUNoYW5nZWQsIGV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgIHRoaXMuZG9jcyA9IGRvY3M7XHJcbiAgICAgICAgdGhpcy5vbGREb2NzID0gb2xkRG9jcztcclxuICAgICAgICB0aGlzLmRvY0NoYW5nZXMgPSBkb2NDaGFuZ2VzO1xyXG4gICAgICAgIHRoaXMubXV0YXRlZEtleXMgPSBtdXRhdGVkS2V5cztcclxuICAgICAgICB0aGlzLmZyb21DYWNoZSA9IGZyb21DYWNoZTtcclxuICAgICAgICB0aGlzLnN5bmNTdGF0ZUNoYW5nZWQgPSBzeW5jU3RhdGVDaGFuZ2VkO1xyXG4gICAgICAgIHRoaXMuZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMgPSBleGNsdWRlc01ldGFkYXRhQ2hhbmdlcztcclxuICAgIH1cclxuICAgIC8qKiBSZXR1cm5zIGEgdmlldyBzbmFwc2hvdCBhcyBpZiBhbGwgZG9jdW1lbnRzIGluIHRoZSBzbmFwc2hvdCB3ZXJlIGFkZGVkLiAqL1xyXG4gICAgVmlld1NuYXBzaG90LmZyb21Jbml0aWFsRG9jdW1lbnRzID0gZnVuY3Rpb24gKHF1ZXJ5LCBkb2N1bWVudHMsIG11dGF0ZWRLZXlzLCBmcm9tQ2FjaGUpIHtcclxuICAgICAgICB2YXIgY2hhbmdlcyA9IFtdO1xyXG4gICAgICAgIGRvY3VtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgY2hhbmdlcy5wdXNoKHsgdHlwZTogQ2hhbmdlVHlwZS5BZGRlZCwgZG9jOiBkb2MgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWaWV3U25hcHNob3QocXVlcnksIGRvY3VtZW50cywgRG9jdW1lbnRTZXQuZW1wdHlTZXQoZG9jdW1lbnRzKSwgY2hhbmdlcywgbXV0YXRlZEtleXMsIGZyb21DYWNoZSwgdHJ1ZSwgZmFsc2UpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3U25hcHNob3QucHJvdG90eXBlLCBcImhhc1BlbmRpbmdXcml0ZXNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIXRoaXMubXV0YXRlZEtleXMuaXNFbXB0eSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgVmlld1NuYXBzaG90LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZnJvbUNhY2hlICE9PSBvdGhlci5mcm9tQ2FjaGUgfHxcclxuICAgICAgICAgICAgdGhpcy5zeW5jU3RhdGVDaGFuZ2VkICE9PSBvdGhlci5zeW5jU3RhdGVDaGFuZ2VkIHx8XHJcbiAgICAgICAgICAgICF0aGlzLm11dGF0ZWRLZXlzLmlzRXF1YWwob3RoZXIubXV0YXRlZEtleXMpIHx8XHJcbiAgICAgICAgICAgICF0aGlzLnF1ZXJ5LmlzRXF1YWwob3RoZXIucXVlcnkpIHx8XHJcbiAgICAgICAgICAgICF0aGlzLmRvY3MuaXNFcXVhbChvdGhlci5kb2NzKSB8fFxyXG4gICAgICAgICAgICAhdGhpcy5vbGREb2NzLmlzRXF1YWwob3RoZXIub2xkRG9jcykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY2hhbmdlcyA9IHRoaXMuZG9jQ2hhbmdlcztcclxuICAgICAgICB2YXIgb3RoZXJDaGFuZ2VzID0gb3RoZXIuZG9jQ2hhbmdlcztcclxuICAgICAgICBpZiAoY2hhbmdlcy5sZW5ndGggIT09IG90aGVyQ2hhbmdlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYW5nZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGNoYW5nZXNbaV0udHlwZSAhPT0gb3RoZXJDaGFuZ2VzW2ldLnR5cGUgfHxcclxuICAgICAgICAgICAgICAgICFjaGFuZ2VzW2ldLmRvYy5pc0VxdWFsKG90aGVyQ2hhbmdlc1tpXS5kb2MpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFZpZXdTbmFwc2hvdDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBbiBldmVudCBmcm9tIHRoZSBSZW1vdGVTdG9yZS4gSXQgaXMgc3BsaXQgaW50byB0YXJnZXRDaGFuZ2VzIChjaGFuZ2VzIHRvIHRoZVxyXG4gKiBzdGF0ZSBvciB0aGUgc2V0IG9mIGRvY3VtZW50cyBpbiBvdXIgd2F0Y2hlZCB0YXJnZXRzKSBhbmQgZG9jdW1lbnRVcGRhdGVzXHJcbiAqIChjaGFuZ2VzIHRvIHRoZSBhY3R1YWwgZG9jdW1lbnRzKS5cclxuICovXHJcbnZhciBSZW1vdGVFdmVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlbW90ZUV2ZW50KFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc25hcHNob3QgdmVyc2lvbiB0aGlzIGV2ZW50IGJyaW5ncyB1cyB1cCB0bywgb3IgTUlOIGlmIG5vdCBzZXQuXHJcbiAgICAgKi9cclxuICAgIHNuYXBzaG90VmVyc2lvbiwgXHJcbiAgICAvKipcclxuICAgICAqIEEgbWFwIGZyb20gdGFyZ2V0IHRvIGNoYW5nZXMgdG8gdGhlIHRhcmdldC4gU2VlIFRhcmdldENoYW5nZS5cclxuICAgICAqL1xyXG4gICAgdGFyZ2V0Q2hhbmdlcywgXHJcbiAgICAvKipcclxuICAgICAqIEEgc2V0IG9mIHRhcmdldHMgdGhhdCBpcyBrbm93biB0byBiZSBpbmNvbnNpc3RlbnQuIExpc3RlbnMgZm9yIHRoZXNlXHJcbiAgICAgKiB0YXJnZXRzIHNob3VsZCBiZSByZS1lc3RhYmxpc2hlZCB3aXRob3V0IHJlc3VtZSB0b2tlbnMuXHJcbiAgICAgKi9cclxuICAgIHRhcmdldE1pc21hdGNoZXMsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBIHNldCBvZiB3aGljaCBkb2N1bWVudHMgaGF2ZSBjaGFuZ2VkIG9yIGJlZW4gZGVsZXRlZCwgYWxvbmcgd2l0aCB0aGVcclxuICAgICAqIGRvYydzIG5ldyB2YWx1ZXMgKGlmIG5vdCBkZWxldGVkKS5cclxuICAgICAqL1xyXG4gICAgZG9jdW1lbnRVcGRhdGVzLCBcclxuICAgIC8qKlxyXG4gICAgICogQSBzZXQgb2Ygd2hpY2ggZG9jdW1lbnQgdXBkYXRlcyBhcmUgZHVlIG9ubHkgdG8gbGltYm8gcmVzb2x1dGlvbiB0YXJnZXRzLlxyXG4gICAgICovXHJcbiAgICByZXNvbHZlZExpbWJvRG9jdW1lbnRzKSB7XHJcbiAgICAgICAgdGhpcy5zbmFwc2hvdFZlcnNpb24gPSBzbmFwc2hvdFZlcnNpb247XHJcbiAgICAgICAgdGhpcy50YXJnZXRDaGFuZ2VzID0gdGFyZ2V0Q2hhbmdlcztcclxuICAgICAgICB0aGlzLnRhcmdldE1pc21hdGNoZXMgPSB0YXJnZXRNaXNtYXRjaGVzO1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRVcGRhdGVzID0gZG9jdW1lbnRVcGRhdGVzO1xyXG4gICAgICAgIHRoaXMucmVzb2x2ZWRMaW1ib0RvY3VtZW50cyA9IHJlc29sdmVkTGltYm9Eb2N1bWVudHM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEhBQ0s6IFZpZXdzIHJlcXVpcmUgUmVtb3RlRXZlbnRzIGluIG9yZGVyIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSB2aWV3IGlzXHJcbiAgICAgKiBDVVJSRU5ULCBidXQgc2Vjb25kYXJ5IHRhYnMgZG9uJ3QgcmVjZWl2ZSByZW1vdGUgZXZlbnRzLiBTbyB0aGlzIG1ldGhvZCBpc1xyXG4gICAgICogdXNlZCB0byBjcmVhdGUgYSBzeW50aGVzaXplZCBSZW1vdGVFdmVudCB0aGF0IGNhbiBiZSB1c2VkIHRvIGFwcGx5IGFcclxuICAgICAqIENVUlJFTlQgc3RhdHVzIGNoYW5nZSB0byBhIFZpZXcsIGZvciBxdWVyaWVzIGV4ZWN1dGVkIGluIGEgZGlmZmVyZW50IHRhYi5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxyXG4gICAgUmVtb3RlRXZlbnQuY3JlYXRlU3ludGhlc2l6ZWRSZW1vdGVFdmVudEZvckN1cnJlbnRDaGFuZ2UgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIGN1cnJlbnQpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0Q2hhbmdlcyA9IChfYSA9IHt9LCBfYVt0YXJnZXRJZF0gPSBUYXJnZXRDaGFuZ2UuY3JlYXRlU3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2VGb3JDdXJyZW50Q2hhbmdlKHRhcmdldElkLCBjdXJyZW50KSwgX2EpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUmVtb3RlRXZlbnQoU25hcHNob3RWZXJzaW9uLk1JTiwgdGFyZ2V0Q2hhbmdlcywgdGFyZ2V0SWRTZXQoKSwgbWF5YmVEb2N1bWVudE1hcCgpLCBkb2N1bWVudEtleVNldCgpKTtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlbW90ZUV2ZW50O1xyXG59KCkpO1xyXG4vKipcclxuICogQSBUYXJnZXRDaGFuZ2Ugc3BlY2lmaWVzIHRoZSBzZXQgb2YgY2hhbmdlcyBmb3IgYSBzcGVjaWZpYyB0YXJnZXQgYXMgcGFydCBvZlxyXG4gKiBhIFJlbW90ZUV2ZW50LiBUaGVzZSBjaGFuZ2VzIHRyYWNrIHdoaWNoIGRvY3VtZW50cyBhcmUgYWRkZWQsIG1vZGlmaWVkIG9yXHJcbiAqIHJlbW92ZWQsIGFzIHdlbGwgYXMgdGhlIHRhcmdldCdzIHJlc3VtZSB0b2tlbiBhbmQgd2hldGhlciB0aGUgdGFyZ2V0IGlzXHJcbiAqIG1hcmtlZCBDVVJSRU5ULlxyXG4gKiBUaGUgYWN0dWFsIGNoYW5nZXMgKnRvKiBkb2N1bWVudHMgYXJlIG5vdCBwYXJ0IG9mIHRoZSBUYXJnZXRDaGFuZ2Ugc2luY2VcclxuICogZG9jdW1lbnRzIG1heSBiZSBwYXJ0IG9mIG11bHRpcGxlIHRhcmdldHMuXHJcbiAqL1xyXG52YXIgVGFyZ2V0Q2hhbmdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVGFyZ2V0Q2hhbmdlKFxyXG4gICAgLyoqXHJcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHF1ZXJ5IHRvIGJlIHJlc3VtZWRcclxuICAgICAqIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdCBtYXRjaGVzIHRoZVxyXG4gICAgICogcXVlcnkuIFRoZSByZXN1bWUgdG9rZW4gZXNzZW50aWFsbHkgaWRlbnRpZmllcyBhIHBvaW50IGluIHRpbWUgZnJvbSB3aGljaFxyXG4gICAgICogdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cclxuICAgICAqL1xyXG4gICAgcmVzdW1lVG9rZW4sIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgXCJjdXJyZW50XCIgKHN5bmNlZCkgc3RhdHVzIG9mIHRoaXMgdGFyZ2V0LiBOb3RlIHRoYXQgXCJjdXJyZW50XCJcclxuICAgICAqIGhhcyBzcGVjaWFsIG1lYW5pbmcgaW4gdGhlIFJQQyBwcm90b2NvbCB0aGF0IGltcGxpZXMgdGhhdCBhIHRhcmdldCBpc1xyXG4gICAgICogYm90aCB1cC10by1kYXRlIGFuZCBjb25zaXN0ZW50IHdpdGggdGhlIHJlc3Qgb2YgdGhlIHdhdGNoIHN0cmVhbS5cclxuICAgICAqL1xyXG4gICAgY3VycmVudCwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgd2VyZSBuZXdseSBhc3NpZ25lZCB0byB0aGlzIHRhcmdldCBhcyBwYXJ0IG9mXHJcbiAgICAgKiB0aGlzIHJlbW90ZSBldmVudC5cclxuICAgICAqL1xyXG4gICAgYWRkZWREb2N1bWVudHMsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IHdlcmUgYWxyZWFkeSBhc3NpZ25lZCB0byB0aGlzIHRhcmdldCBidXQgcmVjZWl2ZWRcclxuICAgICAqIGFuIHVwZGF0ZSBkdXJpbmcgdGhpcyByZW1vdGUgZXZlbnQuXHJcbiAgICAgKi9cclxuICAgIG1vZGlmaWVkRG9jdW1lbnRzLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCB3ZXJlIHJlbW92ZWQgZnJvbSB0aGlzIHRhcmdldCBhcyBwYXJ0IG9mIHRoaXNcclxuICAgICAqIHJlbW90ZSBldmVudC5cclxuICAgICAqL1xyXG4gICAgcmVtb3ZlZERvY3VtZW50cykge1xyXG4gICAgICAgIHRoaXMucmVzdW1lVG9rZW4gPSByZXN1bWVUb2tlbjtcclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSBjdXJyZW50O1xyXG4gICAgICAgIHRoaXMuYWRkZWREb2N1bWVudHMgPSBhZGRlZERvY3VtZW50cztcclxuICAgICAgICB0aGlzLm1vZGlmaWVkRG9jdW1lbnRzID0gbW9kaWZpZWREb2N1bWVudHM7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVkRG9jdW1lbnRzID0gcmVtb3ZlZERvY3VtZW50cztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogSEFDSzogVmlld3MgcmVxdWlyZSBUYXJnZXRDaGFuZ2VzIGluIG9yZGVyIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSB2aWV3IGlzXHJcbiAgICAgKiBDVVJSRU5ULCBidXQgc2Vjb25kYXJ5IHRhYnMgZG9uJ3QgcmVjZWl2ZSByZW1vdGUgZXZlbnRzLiBTbyB0aGlzIG1ldGhvZCBpc1xyXG4gICAgICogdXNlZCB0byBjcmVhdGUgYSBzeW50aGVzaXplZCBUYXJnZXRDaGFuZ2VzIHRoYXQgY2FuIGJlIHVzZWQgdG8gYXBwbHkgYVxyXG4gICAgICogQ1VSUkVOVCBzdGF0dXMgY2hhbmdlIHRvIGEgVmlldywgZm9yIHF1ZXJpZXMgZXhlY3V0ZWQgaW4gYSBkaWZmZXJlbnQgdGFiLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5XHJcbiAgICBUYXJnZXRDaGFuZ2UuY3JlYXRlU3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2VGb3JDdXJyZW50Q2hhbmdlID0gZnVuY3Rpb24gKHRhcmdldElkLCBjdXJyZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBUYXJnZXRDaGFuZ2UoZW1wdHlCeXRlU3RyaW5nKCksIGN1cnJlbnQsIGRvY3VtZW50S2V5U2V0KCksIGRvY3VtZW50S2V5U2V0KCksIGRvY3VtZW50S2V5U2V0KCkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUYXJnZXRDaGFuZ2U7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGNoYW5nZWQgZG9jdW1lbnQgYW5kIGEgbGlzdCBvZiB0YXJnZXQgaWRzIHRvIHdoaWNoIHRoaXMgY2hhbmdlXHJcbiAqIGFwcGxpZXMuXHJcbiAqXHJcbiAqIElmIGRvY3VtZW50IGhhcyBiZWVuIGRlbGV0ZWQgTm9Eb2N1bWVudCB3aWxsIGJlIHByb3ZpZGVkLlxyXG4gKi9cclxudmFyIERvY3VtZW50V2F0Y2hDaGFuZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEb2N1bWVudFdhdGNoQ2hhbmdlKFxyXG4gICAgLyoqIFRoZSBuZXcgZG9jdW1lbnQgYXBwbGllcyB0byBhbGwgb2YgdGhlc2UgdGFyZ2V0cy4gKi9cclxuICAgIHVwZGF0ZWRUYXJnZXRJZHMsIFxyXG4gICAgLyoqIFRoZSBuZXcgZG9jdW1lbnQgaXMgcmVtb3ZlZCBmcm9tIGFsbCBvZiB0aGVzZSB0YXJnZXRzLiAqL1xyXG4gICAgcmVtb3ZlZFRhcmdldElkcywgXHJcbiAgICAvKiogVGhlIGtleSBvZiB0aGUgZG9jdW1lbnQgZm9yIHRoaXMgY2hhbmdlLiAqL1xyXG4gICAga2V5LCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG5ldyBkb2N1bWVudCBvciBOb0RvY3VtZW50IGlmIGl0IHdhcyBkZWxldGVkLiBJcyBudWxsIGlmIHRoZVxyXG4gICAgICogZG9jdW1lbnQgd2VudCBvdXQgb2YgdmlldyB3aXRob3V0IHRoZSBzZXJ2ZXIgc2VuZGluZyBhIG5ldyBkb2N1bWVudC5cclxuICAgICAqL1xyXG4gICAgbmV3RG9jKSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVkVGFyZ2V0SWRzID0gdXBkYXRlZFRhcmdldElkcztcclxuICAgICAgICB0aGlzLnJlbW92ZWRUYXJnZXRJZHMgPSByZW1vdmVkVGFyZ2V0SWRzO1xyXG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIHRoaXMubmV3RG9jID0gbmV3RG9jO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIERvY3VtZW50V2F0Y2hDaGFuZ2U7XHJcbn0oKSk7XHJcbnZhciBFeGlzdGVuY2VGaWx0ZXJDaGFuZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFeGlzdGVuY2VGaWx0ZXJDaGFuZ2UodGFyZ2V0SWQsIGV4aXN0ZW5jZUZpbHRlcikge1xyXG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0YXJnZXRJZDtcclxuICAgICAgICB0aGlzLmV4aXN0ZW5jZUZpbHRlciA9IGV4aXN0ZW5jZUZpbHRlcjtcclxuICAgIH1cclxuICAgIHJldHVybiBFeGlzdGVuY2VGaWx0ZXJDaGFuZ2U7XHJcbn0oKSk7XHJcbnZhciBXYXRjaFRhcmdldENoYW5nZVN0YXRlO1xyXG4oZnVuY3Rpb24gKFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUpIHtcclxuICAgIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtcIk5vQ2hhbmdlXCJdID0gMF0gPSBcIk5vQ2hhbmdlXCI7XHJcbiAgICBXYXRjaFRhcmdldENoYW5nZVN0YXRlW1dhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbXCJBZGRlZFwiXSA9IDFdID0gXCJBZGRlZFwiO1xyXG4gICAgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtXYXRjaFRhcmdldENoYW5nZVN0YXRlW1wiUmVtb3ZlZFwiXSA9IDJdID0gXCJSZW1vdmVkXCI7XHJcbiAgICBXYXRjaFRhcmdldENoYW5nZVN0YXRlW1dhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbXCJDdXJyZW50XCJdID0gM10gPSBcIkN1cnJlbnRcIjtcclxuICAgIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtcIlJlc2V0XCJdID0gNF0gPSBcIlJlc2V0XCI7XHJcbn0pKFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUgfHwgKFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUgPSB7fSkpO1xyXG52YXIgV2F0Y2hUYXJnZXRDaGFuZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBXYXRjaFRhcmdldENoYW5nZShcclxuICAgIC8qKiBXaGF0IGtpbmQgb2YgY2hhbmdlIG9jY3VycmVkIHRvIHRoZSB3YXRjaCB0YXJnZXQuICovXHJcbiAgICBzdGF0ZSwgXHJcbiAgICAvKiogVGhlIHRhcmdldCBJRHMgdGhhdCB3ZXJlIGFkZGVkL3JlbW92ZWQvc2V0LiAqL1xyXG4gICAgdGFyZ2V0SWRzLCBcclxuICAgIC8qKlxyXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSBxdWVyeSB0byBiZVxyXG4gICAgICogcmVzdW1lZCBhZnRlciBkaXNjb25uZWN0aW5nIHdpdGhvdXQgcmV0cmFuc21pdHRpbmcgYWxsIHRoZSBkYXRhIHRoYXRcclxuICAgICAqIG1hdGNoZXMgdGhlIHF1ZXJ5LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpblxyXG4gICAgICogdGltZSBmcm9tIHdoaWNoIHRoZSBzZXJ2ZXIgc2hvdWxkIHJlc3VtZSBzZW5kaW5nIHJlc3VsdHMuXHJcbiAgICAgKi9cclxuICAgIHJlc3VtZVRva2VuLCBcclxuICAgIC8qKiBBbiBSUEMgZXJyb3IgaW5kaWNhdGluZyB3aHkgdGhlIHdhdGNoIGZhaWxlZC4gKi9cclxuICAgIGNhdXNlKSB7XHJcbiAgICAgICAgaWYgKHJlc3VtZVRva2VuID09PSB2b2lkIDApIHsgcmVzdW1lVG9rZW4gPSBlbXB0eUJ5dGVTdHJpbmcoKTsgfVxyXG4gICAgICAgIGlmIChjYXVzZSA9PT0gdm9pZCAwKSB7IGNhdXNlID0gbnVsbDsgfVxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICB0aGlzLnRhcmdldElkcyA9IHRhcmdldElkcztcclxuICAgICAgICB0aGlzLnJlc3VtZVRva2VuID0gcmVzdW1lVG9rZW47XHJcbiAgICAgICAgdGhpcy5jYXVzZSA9IGNhdXNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFdhdGNoVGFyZ2V0Q2hhbmdlO1xyXG59KCkpO1xyXG4vKiogVHJhY2tzIHRoZSBpbnRlcm5hbCBzdGF0ZSBvZiBhIFdhdGNoIHRhcmdldC4gKi9cclxudmFyIFRhcmdldFN0YXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVGFyZ2V0U3RhdGUoKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIG51bWJlciBvZiBwZW5kaW5nIHJlc3BvbnNlcyAoYWRkcyBvciByZW1vdmVzKSB0aGF0IHdlIGFyZSB3YWl0aW5nIG9uLlxyXG4gICAgICAgICAqIFdlIG9ubHkgY29uc2lkZXIgdGFyZ2V0cyBhY3RpdmUgdGhhdCBoYXZlIG5vIHBlbmRpbmcgcmVzcG9uc2VzLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucGVuZGluZ1Jlc3BvbnNlcyA9IDA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogS2VlcHMgdHJhY2sgb2YgdGhlIGRvY3VtZW50IGNoYW5nZXMgc2luY2UgdGhlIGxhc3QgcmFpc2VkIHNuYXBzaG90LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogVGhlc2UgY2hhbmdlcyBhcmUgY29udGludW91c2x5IHVwZGF0ZWQgYXMgd2UgcmVjZWl2ZSBkb2N1bWVudCB1cGRhdGVzIGFuZFxyXG4gICAgICAgICAqIGFsd2F5cyByZWZsZWN0IHRoZSBjdXJyZW50IHNldCBvZiBjaGFuZ2VzIGFnYWluc3QgdGhlIGxhc3QgaXNzdWVkIHNuYXBzaG90LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRDaGFuZ2VzID0gc25hcHNob3RDaGFuZ2VzTWFwKCk7XHJcbiAgICAgICAgLyoqIFNlZSBwdWJsaWMgZ2V0dGVycyBmb3IgZXhwbGFuYXRpb25zIG9mIHRoZXNlIGZpZWxkcy4gKi9cclxuICAgICAgICB0aGlzLl9yZXN1bWVUb2tlbiA9IGVtcHR5Qnl0ZVN0cmluZygpO1xyXG4gICAgICAgIHRoaXMuX2N1cnJlbnQgPSBmYWxzZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBXaGV0aGVyIHRoaXMgdGFyZ2V0IHN0YXRlIHNob3VsZCBiZSBpbmNsdWRlZCBpbiB0aGUgbmV4dCBzbmFwc2hvdC4gV2VcclxuICAgICAgICAgKiBpbml0aWFsaXplIHRvIHRydWUgc28gdGhhdCBuZXdseS1hZGRlZCB0YXJnZXRzIGFyZSBpbmNsdWRlZCBpbiB0aGUgbmV4dFxyXG4gICAgICAgICAqIFJlbW90ZUV2ZW50LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX2hhc1BlbmRpbmdDaGFuZ2VzID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYXJnZXRTdGF0ZS5wcm90b3R5cGUsIFwiY3VycmVudFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogV2hldGhlciB0aGlzIHRhcmdldCBoYXMgYmVlbiBtYXJrZWQgJ2N1cnJlbnQnLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogJ0N1cnJlbnQnIGhhcyBzcGVjaWFsIG1lYW5pbmcgaW4gdGhlIFJQQyBwcm90b2NvbDogSXQgaW1wbGllcyB0aGF0IHRoZVxyXG4gICAgICAgICAqIFdhdGNoIGJhY2tlbmQgaGFzIHNlbnQgdXMgYWxsIGNoYW5nZXMgdXAgdG8gdGhlIHBvaW50IGF0IHdoaWNoIHRoZSB0YXJnZXRcclxuICAgICAgICAgKiB3YXMgYWRkZWQgYW5kIHRoYXQgdGhlIHRhcmdldCBpcyBjb25zaXN0ZW50IHdpdGggdGhlIHJlc3Qgb2YgdGhlIHdhdGNoXHJcbiAgICAgICAgICogc3RyZWFtLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYXJnZXRTdGF0ZS5wcm90b3R5cGUsIFwicmVzdW1lVG9rZW5cIiwge1xyXG4gICAgICAgIC8qKiBUaGUgbGFzdCByZXN1bWUgdG9rZW4gc2VudCB0byB1cyBmb3IgdGhpcyB0YXJnZXQuICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZXN1bWVUb2tlbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYXJnZXRTdGF0ZS5wcm90b3R5cGUsIFwiaXNQZW5kaW5nXCIsIHtcclxuICAgICAgICAvKiogV2hldGhlciB0aGlzIHRhcmdldCBoYXMgcGVuZGluZyB0YXJnZXQgYWRkcyBvciB0YXJnZXQgcmVtb3Zlcy4gKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGVuZGluZ1Jlc3BvbnNlcyAhPT0gMDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYXJnZXRTdGF0ZS5wcm90b3R5cGUsIFwiaGFzUGVuZGluZ0NoYW5nZXNcIiwge1xyXG4gICAgICAgIC8qKiBXaGV0aGVyIHdlIGhhdmUgbW9kaWZpZWQgYW55IHN0YXRlIHRoYXQgc2hvdWxkIHRyaWdnZXIgYSBzbmFwc2hvdC4gKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hhc1BlbmRpbmdDaGFuZ2VzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBsaWVzIHRoZSByZXN1bWUgdG9rZW4gdG8gdGhlIFRhcmdldENoYW5nZSwgYnV0IG9ubHkgd2hlbiBpdCBoYXMgYSBuZXdcclxuICAgICAqIHZhbHVlLiBFbXB0eSByZXN1bWVUb2tlbnMgYXJlIGRpc2NhcmRlZC5cclxuICAgICAqL1xyXG4gICAgVGFyZ2V0U3RhdGUucHJvdG90eXBlLnVwZGF0ZVJlc3VtZVRva2VuID0gZnVuY3Rpb24gKHJlc3VtZVRva2VuKSB7XHJcbiAgICAgICAgaWYgKHJlc3VtZVRva2VuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5faGFzUGVuZGluZ0NoYW5nZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXN1bWVUb2tlbiA9IHJlc3VtZVRva2VuO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSB0YXJnZXQgY2hhbmdlIGZyb20gdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMuXHJcbiAgICAgKlxyXG4gICAgICogVG8gcmVzZXQgdGhlIGRvY3VtZW50IGNoYW5nZXMgYWZ0ZXIgcmFpc2luZyB0aGlzIHNuYXBzaG90LCBjYWxsXHJcbiAgICAgKiBgY2xlYXJQZW5kaW5nQ2hhbmdlcygpYC5cclxuICAgICAqL1xyXG4gICAgVGFyZ2V0U3RhdGUucHJvdG90eXBlLnRvVGFyZ2V0Q2hhbmdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhZGRlZERvY3VtZW50cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdmFyIG1vZGlmaWVkRG9jdW1lbnRzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB2YXIgcmVtb3ZlZERvY3VtZW50cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudENoYW5nZXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCBjaGFuZ2VUeXBlKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoY2hhbmdlVHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLkFkZGVkOlxyXG4gICAgICAgICAgICAgICAgICAgIGFkZGVkRG9jdW1lbnRzID0gYWRkZWREb2N1bWVudHMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuTW9kaWZpZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZWREb2N1bWVudHMgPSBtb2RpZmllZERvY3VtZW50cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5SZW1vdmVkOlxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZWREb2N1bWVudHMgPSByZW1vdmVkRG9jdW1lbnRzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBmYWlsKCdFbmNvdW50ZXJlZCBpbnZhbGlkIGNoYW5nZSB0eXBlOiAnICsgY2hhbmdlVHlwZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbmV3IFRhcmdldENoYW5nZSh0aGlzLl9yZXN1bWVUb2tlbiwgdGhpcy5fY3VycmVudCwgYWRkZWREb2N1bWVudHMsIG1vZGlmaWVkRG9jdW1lbnRzLCByZW1vdmVkRG9jdW1lbnRzKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgZG9jdW1lbnQgY2hhbmdlcyBhbmQgc2V0cyBgaGFzUGVuZGluZ0NoYW5nZXNgIHRvIGZhbHNlLlxyXG4gICAgICovXHJcbiAgICBUYXJnZXRTdGF0ZS5wcm90b3R5cGUuY2xlYXJQZW5kaW5nQ2hhbmdlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9oYXNQZW5kaW5nQ2hhbmdlcyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRDaGFuZ2VzID0gc25hcHNob3RDaGFuZ2VzTWFwKCk7XHJcbiAgICB9O1xyXG4gICAgVGFyZ2V0U3RhdGUucHJvdG90eXBlLmFkZERvY3VtZW50Q2hhbmdlID0gZnVuY3Rpb24gKGtleSwgY2hhbmdlVHlwZSkge1xyXG4gICAgICAgIHRoaXMuX2hhc1BlbmRpbmdDaGFuZ2VzID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmRvY3VtZW50Q2hhbmdlcyA9IHRoaXMuZG9jdW1lbnRDaGFuZ2VzLmluc2VydChrZXksIGNoYW5nZVR5cGUpO1xyXG4gICAgfTtcclxuICAgIFRhcmdldFN0YXRlLnByb3RvdHlwZS5yZW1vdmVEb2N1bWVudENoYW5nZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB0aGlzLl9oYXNQZW5kaW5nQ2hhbmdlcyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudENoYW5nZXMgPSB0aGlzLmRvY3VtZW50Q2hhbmdlcy5yZW1vdmUoa2V5KTtcclxuICAgIH07XHJcbiAgICBUYXJnZXRTdGF0ZS5wcm90b3R5cGUucmVjb3JkUGVuZGluZ1RhcmdldFJlcXVlc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nUmVzcG9uc2VzICs9IDE7XHJcbiAgICB9O1xyXG4gICAgVGFyZ2V0U3RhdGUucHJvdG90eXBlLnJlY29yZFRhcmdldFJlc3BvbnNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMucGVuZGluZ1Jlc3BvbnNlcyAtPSAxO1xyXG4gICAgfTtcclxuICAgIFRhcmdldFN0YXRlLnByb3RvdHlwZS5tYXJrQ3VycmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9oYXNQZW5kaW5nQ2hhbmdlcyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudCA9IHRydWU7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRhcmdldFN0YXRlO1xyXG59KCkpO1xyXG4vKipcclxuICogQSBoZWxwZXIgY2xhc3MgdG8gYWNjdW11bGF0ZSB3YXRjaCBjaGFuZ2VzIGludG8gYSBSZW1vdGVFdmVudC5cclxuICovXHJcbnZhciBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IobWV0YWRhdGFQcm92aWRlcikge1xyXG4gICAgICAgIHRoaXMubWV0YWRhdGFQcm92aWRlciA9IG1ldGFkYXRhUHJvdmlkZXI7XHJcbiAgICAgICAgLyoqIFRoZSBpbnRlcm5hbCBzdGF0ZSBvZiBhbGwgdHJhY2tlZCB0YXJnZXRzLiAqL1xyXG4gICAgICAgIHRoaXMudGFyZ2V0U3RhdGVzID0ge307XHJcbiAgICAgICAgLyoqIEtlZXBzIHRyYWNrIG9mIHRoZSBkb2N1bWVudHMgdG8gdXBkYXRlIHNpbmNlIHRoZSBsYXN0IHJhaXNlZCBzbmFwc2hvdC4gKi9cclxuICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFVwZGF0ZXMgPSBtYXliZURvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgLyoqIEEgbWFwcGluZyBvZiBkb2N1bWVudCBrZXlzIHRvIHRoZWlyIHNldCBvZiB0YXJnZXQgSURzLiAqL1xyXG4gICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZyA9IGRvY3VtZW50VGFyZ2V0TWFwKCk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBsaXN0IG9mIHRhcmdldHMgd2l0aCBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoZXMuIFRoZXNlIHRhcmdldHMgYXJlXHJcbiAgICAgICAgICoga25vd24gdG8gYmUgaW5jb25zaXN0ZW50IGFuZCB0aGVpciBsaXN0ZW5zIG5lZWRzIHRvIGJlIHJlLWVzdGFibGlzaGVkIGJ5XHJcbiAgICAgICAgICogUmVtb3RlU3RvcmUuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wZW5kaW5nVGFyZ2V0UmVzZXRzID0gbmV3IFNvcnRlZFNldChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUHJvY2Vzc2VzIGFuZCBhZGRzIHRoZSBEb2N1bWVudFdhdGNoQ2hhbmdlIHRvIHRoZSBjdXJyZW50IHNldCBvZiBjaGFuZ2VzLlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmhhbmRsZURvY3VtZW50Q2hhbmdlID0gZnVuY3Rpb24gKGRvY0NoYW5nZSkge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBkb2NDaGFuZ2UudXBkYXRlZFRhcmdldElkczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldElkID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBpZiAoZG9jQ2hhbmdlLm5ld0RvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkZERvY3VtZW50VG9UYXJnZXQodGFyZ2V0SWQsIGRvY0NoYW5nZS5uZXdEb2MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGRvY0NoYW5nZS5uZXdEb2MgaW5zdGFuY2VvZiBOb0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZURvY3VtZW50RnJvbVRhcmdldCh0YXJnZXRJZCwgZG9jQ2hhbmdlLmtleSwgZG9jQ2hhbmdlLm5ld0RvYyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgX2IgPSAwLCBfYyA9IGRvY0NoYW5nZS5yZW1vdmVkVGFyZ2V0SWRzOyBfYiA8IF9jLmxlbmd0aDsgX2IrKykge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBfY1tfYl07XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRG9jdW1lbnRGcm9tVGFyZ2V0KHRhcmdldElkLCBkb2NDaGFuZ2Uua2V5LCBkb2NDaGFuZ2UubmV3RG9jKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgV2F0Y2hUYXJnZXRDaGFuZ2UgdG8gdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMuICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmhhbmRsZVRhcmdldENoYW5nZSA9IGZ1bmN0aW9uICh0YXJnZXRDaGFuZ2UpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaFRhcmdldCh0YXJnZXRDaGFuZ2UsIGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0U3RhdGUgPSBfdGhpcy5lbnN1cmVUYXJnZXRTdGF0ZSh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodGFyZ2V0Q2hhbmdlLnN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuTm9DaGFuZ2U6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzQWN0aXZlVGFyZ2V0KHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZS51cGRhdGVSZXN1bWVUb2tlbih0YXJnZXRDaGFuZ2UucmVzdW1lVG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5BZGRlZDpcclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGRlY3JlbWVudCB0aGUgbnVtYmVyIG9mIHBlbmRpbmcgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciB0aGlzIHRhcmdldElkLlxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlLnJlY29yZFRhcmdldFJlc3BvbnNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXRTdGF0ZS5pc1BlbmRpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBhIGZyZXNobHkgYWRkZWQgdGFyZ2V0LCBzbyB3ZSBuZWVkIHRvIHJlc2V0IGFueSBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGF0IHdlIGhhZCBwcmV2aW91c2x5LiBUaGlzIGNhbiBoYXBwZW4gZS5nLiB3aGVuIHJlbW92ZSBhbmQgYWRkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2sgYSB0YXJnZXQgZm9yIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hlcy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGUuY2xlYXJQZW5kaW5nQ2hhbmdlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZS51cGRhdGVSZXN1bWVUb2tlbih0YXJnZXRDaGFuZ2UucmVzdW1lVG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlbW92ZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBrZWVwIHRyYWNrIG9mIHJlbW92ZWQgdGFyZ2V0cyB0byB3ZSBjYW4gcG9zdC1maWx0ZXIgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFueSB0YXJnZXQgY2hhbmdlcy5cclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGRlY3JlbWVudCB0aGUgbnVtYmVyIG9mIHBlbmRpbmcgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciB0aGlzIHRhcmdldElkLlxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlLnJlY29yZFRhcmdldFJlc3BvbnNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXRTdGF0ZS5pc1BlbmRpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVtb3ZlVGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0YXJnZXRDaGFuZ2UuY2F1c2UsICdXYXRjaENoYW5nZUFnZ3JlZ2F0b3IgZG9lcyBub3QgaGFuZGxlIGVycm9yZWQgdGFyZ2V0cycpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLkN1cnJlbnQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzQWN0aXZlVGFyZ2V0KHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZS5tYXJrQ3VycmVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZS51cGRhdGVSZXN1bWVUb2tlbih0YXJnZXRDaGFuZ2UucmVzdW1lVG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5SZXNldDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNBY3RpdmVUYXJnZXQodGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc2V0IHRoZSB0YXJnZXQgYW5kIHN5bnRoZXNpemVzIHJlbW92ZXMgZm9yIGFsbCBleGlzdGluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudHMuIFRoZSBiYWNrZW5kIHdpbGwgcmUtYWRkIGFueSBkb2N1bWVudHMgdGhhdCBzdGlsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtYXRjaCB0aGUgdGFyZ2V0IGJlZm9yZSBpdCBzZW5kcyB0aGUgbmV4dCBnbG9iYWwgc25hcHNob3QuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlc2V0VGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGUudXBkYXRlUmVzdW1lVG9rZW4odGFyZ2V0Q2hhbmdlLnJlc3VtZVRva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGZhaWwoJ1Vua25vd24gdGFyZ2V0IHdhdGNoIGNoYW5nZSBzdGF0ZTogJyArIHRhcmdldENoYW5nZS5zdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYWxsIHRhcmdldElkcyB0aGF0IHRoZSB3YXRjaCBjaGFuZ2UgYXBwbGllcyB0bzogZWl0aGVyIHRoZVxyXG4gICAgICogdGFyZ2V0SWRzIGV4cGxpY2l0bHkgbGlzdGVkIGluIHRoZSBjaGFuZ2Ugb3IgdGhlIHRhcmdldElkcyBvZiBhbGwgY3VycmVudGx5XHJcbiAgICAgKiBhY3RpdmUgdGFyZ2V0cy5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5mb3JFYWNoVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldENoYW5nZSwgZm4pIHtcclxuICAgICAgICBpZiAodGFyZ2V0Q2hhbmdlLnRhcmdldElkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRhcmdldENoYW5nZS50YXJnZXRJZHMuZm9yRWFjaChmbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3JFYWNoTnVtYmVyKHRoaXMudGFyZ2V0U3RhdGVzLCBmbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSGFuZGxlcyBleGlzdGVuY2UgZmlsdGVycyBhbmQgc3ludGhlc2l6ZXMgZGVsZXRlcyBmb3IgZmlsdGVyIG1pc21hdGNoZXMuXHJcbiAgICAgKiBUYXJnZXRzIHRoYXQgYXJlIGludmFsaWRhdGVkIGJ5IGZpbHRlciBtaXNtYXRjaGVzIGFyZSBhZGRlZCB0b1xyXG4gICAgICogYHBlbmRpbmdUYXJnZXRSZXNldHNgLlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmhhbmRsZUV4aXN0ZW5jZUZpbHRlciA9IGZ1bmN0aW9uICh3YXRjaENoYW5nZSkge1xyXG4gICAgICAgIHZhciB0YXJnZXRJZCA9IHdhdGNoQ2hhbmdlLnRhcmdldElkO1xyXG4gICAgICAgIHZhciBleHBlY3RlZENvdW50ID0gd2F0Y2hDaGFuZ2UuZXhpc3RlbmNlRmlsdGVyLmNvdW50O1xyXG4gICAgICAgIHZhciBxdWVyeURhdGEgPSB0aGlzLnF1ZXJ5RGF0YUZvckFjdGl2ZVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgaWYgKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnkgPSBxdWVyeURhdGEucXVlcnk7XHJcbiAgICAgICAgICAgIGlmIChxdWVyeS5pc0RvY3VtZW50UXVlcnkoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4cGVjdGVkQ291bnQgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZXhpc3RlbmNlIGZpbHRlciB0b2xkIHVzIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBleGlzdC4gV2UgZGVkdWNlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhhdCB0aGlzIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IGFuZCBhcHBseSBhIGRlbGV0ZWQgZG9jdW1lbnQgdG9cclxuICAgICAgICAgICAgICAgICAgICAvLyBvdXIgdXBkYXRlcy4gV2l0aG91dCBhcHBseWluZyB0aGlzIGRlbGV0ZWQgZG9jdW1lbnQgdGhlcmUgbWlnaHQgYmVcclxuICAgICAgICAgICAgICAgICAgICAvLyBhbm90aGVyIHF1ZXJ5IHRoYXQgd2lsbCByYWlzZSB0aGlzIGRvY3VtZW50IGFzIHBhcnQgb2YgYSBzbmFwc2hvdFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVudGlsIGl0IGlzIHJlc29sdmVkLCBlc3NlbnRpYWxseSBleHBvc2luZyBpbmNvbnNpc3RlbmN5IGJldHdlZW5cclxuICAgICAgICAgICAgICAgICAgICAvLyBxdWVyaWVzLlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBuZXcgRG9jdW1lbnRLZXkocXVlcnkucGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVEb2N1bWVudEZyb21UYXJnZXQodGFyZ2V0SWQsIGtleSwgbmV3IE5vRG9jdW1lbnQoa2V5LCBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoZXhwZWN0ZWRDb3VudCA9PT0gMSwgJ1NpbmdsZSBkb2N1bWVudCBleGlzdGVuY2UgZmlsdGVyIHdpdGggY291bnQ6ICcgKyBleHBlY3RlZENvdW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50U2l6ZSA9IHRoaXMuZ2V0Q3VycmVudERvY3VtZW50Q291bnRGb3JUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTaXplICE9PSBleHBlY3RlZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaDogV2UgcmVzZXQgdGhlIG1hcHBpbmcgYW5kIHJhaXNlIGEgbmV3XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc25hcHNob3Qgd2l0aCBgaXNGcm9tQ2FjaGU6dHJ1ZWAuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldFRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wZW5kaW5nVGFyZ2V0UmVzZXRzID0gdGhpcy5wZW5kaW5nVGFyZ2V0UmVzZXRzLmFkZCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0cyB0aGUgY3VycmVudGx5IGFjY3VtdWxhdGVkIHN0YXRlIGludG8gYSByZW1vdGUgZXZlbnQgYXQgdGhlXHJcbiAgICAgKiBwcm92aWRlZCBzbmFwc2hvdCB2ZXJzaW9uLiBSZXNldHMgdGhlIGFjY3VtdWxhdGVkIGNoYW5nZXMgYmVmb3JlIHJldHVybmluZy5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5jcmVhdGVSZW1vdGVFdmVudCA9IGZ1bmN0aW9uIChzbmFwc2hvdFZlcnNpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciB0YXJnZXRDaGFuZ2VzID0ge307XHJcbiAgICAgICAgZm9yRWFjaE51bWJlcih0aGlzLnRhcmdldFN0YXRlcywgZnVuY3Rpb24gKHRhcmdldElkLCB0YXJnZXRTdGF0ZSkge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnlEYXRhID0gX3RoaXMucXVlcnlEYXRhRm9yQWN0aXZlVGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICAgICAgaWYgKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldFN0YXRlLmN1cnJlbnQgJiYgcXVlcnlEYXRhLnF1ZXJ5LmlzRG9jdW1lbnRRdWVyeSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRG9jdW1lbnQgcXVlcmllcyBmb3IgZG9jdW1lbnQgdGhhdCBkb24ndCBleGlzdCBjYW4gcHJvZHVjZSBhbiBlbXB0eVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc3VsdCBzZXQuIFRvIHVwZGF0ZSBvdXIgbG9jYWwgY2FjaGUsIHdlIHN5bnRoZXNpemUgYSBkb2N1bWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSBpZiB3ZSBoYXZlIG5vdCBwcmV2aW91c2x5IHJlY2VpdmVkIHRoZSBkb2N1bWVudC4gVGhpc1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc29sdmVzIHRoZSBsaW1ibyBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQsIHJlbW92aW5nIGl0IGZyb21cclxuICAgICAgICAgICAgICAgICAgICAvLyBsaW1ib0RvY3VtZW50UmVmcy5cclxuICAgICAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogSWRlYWxseSB3ZSB3b3VsZCBoYXZlIGFuIGV4cGxpY2l0IGxvb2t1cCBxdWVyeVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGluc3RlYWQgcmVzdWx0aW5nIGluIGFuIGV4cGxpY2l0IGRlbGV0ZSBtZXNzYWdlIGFuZCB3ZSBjb3VsZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGlzIHNwZWNpYWwgbG9naWMuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IG5ldyBEb2N1bWVudEtleShxdWVyeURhdGEucXVlcnkucGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnBlbmRpbmdEb2N1bWVudFVwZGF0ZXMuZ2V0KGtleSkgPT09IG51bGwgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgIV90aGlzLnRhcmdldENvbnRhaW5zRG9jdW1lbnQodGFyZ2V0SWQsIGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVtb3ZlRG9jdW1lbnRGcm9tVGFyZ2V0KHRhcmdldElkLCBrZXksIG5ldyBOb0RvY3VtZW50KGtleSwgc25hcHNob3RWZXJzaW9uKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldFN0YXRlLmhhc1BlbmRpbmdDaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlc1t0YXJnZXRJZF0gPSB0YXJnZXRTdGF0ZS50b1RhcmdldENoYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlLmNsZWFyUGVuZGluZ0NoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciByZXNvbHZlZExpbWJvRG9jdW1lbnRzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICAvLyBXZSBleHRyYWN0IHRoZSBzZXQgb2YgbGltYm8tb25seSBkb2N1bWVudCB1cGRhdGVzIGFzIHRoZSBHQyBsb2dpY1xyXG4gICAgICAgIC8vIHNwZWNpYWwtY2FzZXMgZG9jdW1lbnRzIHRoYXQgZG8gbm90IGFwcGVhciBpbiB0aGUgcXVlcnkgY2FjaGUuXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBUT0RPKGdzb2x0aXMpOiBFeHBhbmQgb24gdGhpcyBjb21tZW50IG9uY2UgR0MgaXMgYXZhaWxhYmxlIGluIHRoZSBKU1xyXG4gICAgICAgIC8vIGNsaWVudC5cclxuICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCB0YXJnZXRzKSB7XHJcbiAgICAgICAgICAgIHZhciBpc09ubHlMaW1ib1RhcmdldCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRhcmdldHMuZm9yRWFjaFdoaWxlKGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5RGF0YSA9IF90aGlzLnF1ZXJ5RGF0YUZvckFjdGl2ZVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocXVlcnlEYXRhICYmIHF1ZXJ5RGF0YS5wdXJwb3NlICE9PSBRdWVyeVB1cnBvc2UuTGltYm9SZXNvbHV0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNPbmx5TGltYm9UYXJnZXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChpc09ubHlMaW1ib1RhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZWRMaW1ib0RvY3VtZW50cyA9IHJlc29sdmVkTGltYm9Eb2N1bWVudHMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgcmVtb3RlRXZlbnQgPSBuZXcgUmVtb3RlRXZlbnQoc25hcHNob3RWZXJzaW9uLCB0YXJnZXRDaGFuZ2VzLCB0aGlzLnBlbmRpbmdUYXJnZXRSZXNldHMsIHRoaXMucGVuZGluZ0RvY3VtZW50VXBkYXRlcywgcmVzb2x2ZWRMaW1ib0RvY3VtZW50cyk7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRVcGRhdGVzID0gbWF5YmVEb2N1bWVudE1hcCgpO1xyXG4gICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZyA9IGRvY3VtZW50VGFyZ2V0TWFwKCk7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nVGFyZ2V0UmVzZXRzID0gbmV3IFNvcnRlZFNldChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuICAgICAgICByZXR1cm4gcmVtb3RlRXZlbnQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIHRoZSBwcm92aWRlZCBkb2N1bWVudCB0byB0aGUgaW50ZXJuYWwgbGlzdCBvZiBkb2N1bWVudCB1cGRhdGVzIGFuZFxyXG4gICAgICogaXRzIGRvY3VtZW50IGtleSB0byB0aGUgZ2l2ZW4gdGFyZ2V0J3MgbWFwcGluZy5cclxuICAgICAqL1xyXG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuYWRkRG9jdW1lbnRUb1RhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgZG9jdW1lbnQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNBY3RpdmVUYXJnZXQodGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNoYW5nZVR5cGUgPSB0aGlzLnRhcmdldENvbnRhaW5zRG9jdW1lbnQodGFyZ2V0SWQsIGRvY3VtZW50LmtleSlcclxuICAgICAgICAgICAgPyBDaGFuZ2VUeXBlLk1vZGlmaWVkXHJcbiAgICAgICAgICAgIDogQ2hhbmdlVHlwZS5BZGRlZDtcclxuICAgICAgICB2YXIgdGFyZ2V0U3RhdGUgPSB0aGlzLmVuc3VyZVRhcmdldFN0YXRlKHRhcmdldElkKTtcclxuICAgICAgICB0YXJnZXRTdGF0ZS5hZGREb2N1bWVudENoYW5nZShkb2N1bWVudC5rZXksIGNoYW5nZVR5cGUpO1xyXG4gICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VXBkYXRlcyA9IHRoaXMucGVuZGluZ0RvY3VtZW50VXBkYXRlcy5pbnNlcnQoZG9jdW1lbnQua2V5LCBkb2N1bWVudCk7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nID0gdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nLmluc2VydChkb2N1bWVudC5rZXksIHRoaXMuZW5zdXJlRG9jdW1lbnRUYXJnZXRNYXBwaW5nKGRvY3VtZW50LmtleSkuYWRkKHRhcmdldElkKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIHRoZSBwcm92aWRlZCBkb2N1bWVudCBmcm9tIHRoZSB0YXJnZXQgbWFwcGluZy4gSWYgdGhlXHJcbiAgICAgKiBkb2N1bWVudCBubyBsb25nZXIgbWF0Y2hlcyB0aGUgdGFyZ2V0LCBidXQgdGhlIGRvY3VtZW50J3Mgc3RhdGUgaXMgc3RpbGxcclxuICAgICAqIGtub3duIChlLmcuIHdlIGtub3cgdGhhdCB0aGUgZG9jdW1lbnQgd2FzIGRlbGV0ZWQgb3Igd2UgcmVjZWl2ZWQgdGhlIGNoYW5nZVxyXG4gICAgICogdGhhdCBjYXVzZWQgdGhlIGZpbHRlciBtaXNtYXRjaCksIHRoZSBuZXcgZG9jdW1lbnQgY2FuIGJlIHByb3ZpZGVkXHJcbiAgICAgKiB0byB1cGRhdGUgdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZS5cclxuICAgICAqL1xyXG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUucmVtb3ZlRG9jdW1lbnRGcm9tVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkLCBrZXksIHVwZGF0ZWREb2N1bWVudCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0FjdGl2ZVRhcmdldCh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdGFyZ2V0U3RhdGUgPSB0aGlzLmVuc3VyZVRhcmdldFN0YXRlKHRhcmdldElkKTtcclxuICAgICAgICBpZiAodGhpcy50YXJnZXRDb250YWluc0RvY3VtZW50KHRhcmdldElkLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHRhcmdldFN0YXRlLmFkZERvY3VtZW50Q2hhbmdlKGtleSwgQ2hhbmdlVHlwZS5SZW1vdmVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFRoZSBkb2N1bWVudCBtYXkgaGF2ZSBlbnRlcmVkIGFuZCBsZWZ0IHRoZSB0YXJnZXQgYmVmb3JlIHdlIHJhaXNlZCBhXHJcbiAgICAgICAgICAgIC8vIHNuYXBzaG90LCBzbyB3ZSBjYW4ganVzdCBpZ25vcmUgdGhlIGNoYW5nZS5cclxuICAgICAgICAgICAgdGFyZ2V0U3RhdGUucmVtb3ZlRG9jdW1lbnRDaGFuZ2Uoa2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nID0gdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nLmluc2VydChrZXksIHRoaXMuZW5zdXJlRG9jdW1lbnRUYXJnZXRNYXBwaW5nKGtleSkuZGVsZXRlKHRhcmdldElkKSk7XHJcbiAgICAgICAgaWYgKHVwZGF0ZWREb2N1bWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFVwZGF0ZXMgPSB0aGlzLnBlbmRpbmdEb2N1bWVudFVwZGF0ZXMuaW5zZXJ0KGtleSwgdXBkYXRlZERvY3VtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5yZW1vdmVUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICBkZWxldGUgdGhpcy50YXJnZXRTdGF0ZXNbdGFyZ2V0SWRdO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgY3VycmVudCBjb3VudCBvZiBkb2N1bWVudHMgaW4gdGhlIHRhcmdldC4gVGhpcyBpbmNsdWRlcyBib3RoXHJcbiAgICAgKiB0aGUgbnVtYmVyIG9mIGRvY3VtZW50cyB0aGF0IHRoZSBMb2NhbFN0b3JlIGNvbnNpZGVycyB0byBiZSBwYXJ0IG9mIHRoZVxyXG4gICAgICogdGFyZ2V0IGFzIHdlbGwgYXMgYW55IGFjY3VtdWxhdGVkIGNoYW5nZXMuXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuZ2V0Q3VycmVudERvY3VtZW50Q291bnRGb3JUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0U3RhdGUgPSB0aGlzLmVuc3VyZVRhcmdldFN0YXRlKHRhcmdldElkKTtcclxuICAgICAgICB2YXIgdGFyZ2V0Q2hhbmdlID0gdGFyZ2V0U3RhdGUudG9UYXJnZXRDaGFuZ2UoKTtcclxuICAgICAgICByZXR1cm4gKHRoaXMubWV0YWRhdGFQcm92aWRlci5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHRhcmdldElkKS5zaXplICtcclxuICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlLmFkZGVkRG9jdW1lbnRzLnNpemUgLVxyXG4gICAgICAgICAgICB0YXJnZXRDaGFuZ2UucmVtb3ZlZERvY3VtZW50cy5zaXplKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEluY3JlbWVudCB0aGUgbnVtYmVyIG9mIGFja3MgbmVlZGVkIGZyb20gd2F0Y2ggYmVmb3JlIHdlIGNhbiBjb25zaWRlciB0aGVcclxuICAgICAqIHNlcnZlciB0byBiZSAnaW4tc3luYycgd2l0aCB0aGUgY2xpZW50J3MgYWN0aXZlIHRhcmdldHMuXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUucmVjb3JkUGVuZGluZ1RhcmdldFJlcXVlc3QgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAvLyBGb3IgZWFjaCByZXF1ZXN0IHdlIGdldCB3ZSBuZWVkIHRvIHJlY29yZCB3ZSBuZWVkIGEgcmVzcG9uc2UgZm9yIGl0LlxyXG4gICAgICAgIHZhciB0YXJnZXRTdGF0ZSA9IHRoaXMuZW5zdXJlVGFyZ2V0U3RhdGUodGFyZ2V0SWQpO1xyXG4gICAgICAgIHRhcmdldFN0YXRlLnJlY29yZFBlbmRpbmdUYXJnZXRSZXF1ZXN0KCk7XHJcbiAgICB9O1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5lbnN1cmVUYXJnZXRTdGF0ZSA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIGlmICghdGhpcy50YXJnZXRTdGF0ZXNbdGFyZ2V0SWRdKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0U3RhdGVzW3RhcmdldElkXSA9IG5ldyBUYXJnZXRTdGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy50YXJnZXRTdGF0ZXNbdGFyZ2V0SWRdO1xyXG4gICAgfTtcclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuZW5zdXJlRG9jdW1lbnRUYXJnZXRNYXBwaW5nID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciB0YXJnZXRNYXBwaW5nID0gdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nLmdldChrZXkpO1xyXG4gICAgICAgIGlmICghdGFyZ2V0TWFwcGluZykge1xyXG4gICAgICAgICAgICB0YXJnZXRNYXBwaW5nID0gbmV3IFNvcnRlZFNldChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuICAgICAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nID0gdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nLmluc2VydChrZXksIHRhcmdldE1hcHBpbmcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGFyZ2V0TWFwcGluZztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFZlcmlmaWVzIHRoYXQgdGhlIHVzZXIgaXMgc3RpbGwgaW50ZXJlc3RlZCBpbiB0aGlzIHRhcmdldCAoYnkgY2FsbGluZ1xyXG4gICAgICogYGdldFF1ZXJ5RGF0YUZvclRhcmdldCgpYCkgYW5kIHRoYXQgd2UgYXJlIG5vdCB3YWl0aW5nIGZvciBwZW5kaW5nIEFERHNcclxuICAgICAqIGZyb20gd2F0Y2guXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuaXNBY3RpdmVUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5xdWVyeURhdGFGb3JBY3RpdmVUYXJnZXQodGFyZ2V0SWQpICE9PSBudWxsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgUXVlcnlEYXRhIGZvciBhbiBhY3RpdmUgdGFyZ2V0IChpLmUuIGEgdGFyZ2V0IHRoYXQgdGhlIHVzZXJcclxuICAgICAqIGlzIHN0aWxsIGludGVyZXN0ZWQgaW4gdGhhdCBoYXMgbm8gb3V0c3RhbmRpbmcgdGFyZ2V0IGNoYW5nZSByZXF1ZXN0cykuXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUucXVlcnlEYXRhRm9yQWN0aXZlVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldFN0YXRlID0gdGhpcy50YXJnZXRTdGF0ZXNbdGFyZ2V0SWRdO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRTdGF0ZSAmJiB0YXJnZXRTdGF0ZS5pc1BlbmRpbmdcclxuICAgICAgICAgICAgPyBudWxsXHJcbiAgICAgICAgICAgIDogdGhpcy5tZXRhZGF0YVByb3ZpZGVyLmdldFF1ZXJ5RGF0YUZvclRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIHN0YXRlIG9mIGEgV2F0Y2ggdGFyZ2V0IHRvIGl0cyBpbml0aWFsIHN0YXRlIChlLmcuIHNldHNcclxuICAgICAqICdjdXJyZW50JyB0byBmYWxzZSwgY2xlYXJzIHRoZSByZXN1bWUgdG9rZW4gYW5kIHJlbW92ZXMgaXRzIHRhcmdldCBtYXBwaW5nXHJcbiAgICAgKiBmcm9tIGFsbCBkb2N1bWVudHMpLlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLnJlc2V0VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQoIXRoaXMudGFyZ2V0U3RhdGVzW3RhcmdldElkXS5pc1BlbmRpbmcsICdTaG91bGQgb25seSByZXNldCBhY3RpdmUgdGFyZ2V0cycpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0U3RhdGVzW3RhcmdldElkXSA9IG5ldyBUYXJnZXRTdGF0ZSgpO1xyXG4gICAgICAgIC8vIFRyaWdnZXIgcmVtb3ZhbCBmb3IgYW55IGRvY3VtZW50cyBjdXJyZW50bHkgbWFwcGVkIHRvIHRoaXMgdGFyZ2V0LlxyXG4gICAgICAgIC8vIFRoZXNlIHJlbW92YWxzIHdpbGwgYmUgcGFydCBvZiB0aGUgaW5pdGlhbCBzbmFwc2hvdCBpZiBXYXRjaCBkb2VzIG5vdFxyXG4gICAgICAgIC8vIHJlc2VuZCB0aGVzZSBkb2N1bWVudHMuXHJcbiAgICAgICAgdmFyIGV4aXN0aW5nS2V5cyA9IHRoaXMubWV0YWRhdGFQcm92aWRlci5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICBleGlzdGluZ0tleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIF90aGlzLnJlbW92ZURvY3VtZW50RnJvbVRhcmdldCh0YXJnZXRJZCwga2V5LCAvKnVwZGF0ZWREb2N1bWVudD0qLyBudWxsKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgTG9jYWxTdG9yZSBjb25zaWRlcnMgdGhlIGRvY3VtZW50IHRvIGJlIHBhcnQgb2YgdGhlXHJcbiAgICAgKiBzcGVjaWZpZWQgdGFyZ2V0LlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLnRhcmdldENvbnRhaW5zRG9jdW1lbnQgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIGtleSkge1xyXG4gICAgICAgIHZhciBleGlzdGluZ0tleXMgPSB0aGlzLm1ldGFkYXRhUHJvdmlkZXIuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nS2V5cy5oYXMoa2V5KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBkb2N1bWVudFRhcmdldE1hcCgpIHtcclxuICAgIHJldHVybiBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG59XHJcbmZ1bmN0aW9uIHNuYXBzaG90Q2hhbmdlc01hcCgpIHtcclxuICAgIHJldHVybiBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRElSRUNUSU9OUyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZGlycyA9IHt9O1xyXG4gICAgZGlyc1tEaXJlY3Rpb24uQVNDRU5ESU5HLm5hbWVdID0gJ0FTQ0VORElORyc7XHJcbiAgICBkaXJzW0RpcmVjdGlvbi5ERVNDRU5ESU5HLm5hbWVdID0gJ0RFU0NFTkRJTkcnO1xyXG4gICAgcmV0dXJuIGRpcnM7XHJcbn0pKCk7XHJcbnZhciBPUEVSQVRPUlMgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG9wcyA9IHt9O1xyXG4gICAgb3BzW1JlbGF0aW9uT3AuTEVTU19USEFOLm5hbWVdID0gJ0xFU1NfVEhBTic7XHJcbiAgICBvcHNbUmVsYXRpb25PcC5MRVNTX1RIQU5fT1JfRVFVQUwubmFtZV0gPSAnTEVTU19USEFOX09SX0VRVUFMJztcclxuICAgIG9wc1tSZWxhdGlvbk9wLkdSRUFURVJfVEhBTi5uYW1lXSA9ICdHUkVBVEVSX1RIQU4nO1xyXG4gICAgb3BzW1JlbGF0aW9uT3AuR1JFQVRFUl9USEFOX09SX0VRVUFMLm5hbWVdID0gJ0dSRUFURVJfVEhBTl9PUl9FUVVBTCc7XHJcbiAgICBvcHNbUmVsYXRpb25PcC5FUVVBTC5uYW1lXSA9ICdFUVVBTCc7XHJcbiAgICBvcHNbUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUy5uYW1lXSA9ICdBUlJBWV9DT05UQUlOUyc7XHJcbiAgICByZXR1cm4gb3BzO1xyXG59KSgpO1xyXG4vLyBBIFJlZ0V4cCBtYXRjaGluZyBJU08gODYwMSBVVEMgdGltZXN0YW1wcyB3aXRoIG9wdGlvbmFsIGZyYWN0aW9uLlxyXG52YXIgSVNPX1JFR19FWFAgPSBuZXcgUmVnRXhwKC9eXFxkezR9LVxcZFxcZC1cXGRcXGRUXFxkXFxkOlxcZFxcZDpcXGRcXGQoPzpcXC4oXFxkKykpP1okLyk7XHJcbmZ1bmN0aW9uIGFzc2VydFByZXNlbnQodmFsdWUsIGRlc2NyaXB0aW9uKSB7XHJcbiAgICBhc3NlcnQoIWlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSwgZGVzY3JpcHRpb24gKyAnIGlzIG1pc3NpbmcnKTtcclxufVxyXG5mdW5jdGlvbiBwYXJzZUludDY0KHZhbHVlKSB7XHJcbiAgICAvLyBUT0RPKGJqb3JuaWNrKTogSGFuZGxlIGludDY0IGdyZWF0ZXIgdGhhbiA1MyBiaXRzLlxyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgcmV0dXJuIE51bWJlcih2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFpbChcImNhbid0IHBhcnNlIFwiICsgdmFsdWUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBHZW5lcmF0ZXMgSnNvbk9iamVjdCB2YWx1ZXMgZm9yIHRoZSBEYXRhc3RvcmUgQVBJIHN1aXRhYmxlIGZvciBzZW5kaW5nIHRvXHJcbiAqIGVpdGhlciBHUlBDIHN0dWIgbWV0aG9kcyBvciB2aWEgdGhlIEpTT04vSFRUUCBSRVNUIEFQSS5cclxuICogVE9ETyhrbGltdCk6IFdlIGNhbiByZW1vdmUgdGhlIGRhdGFiYXNlSWQgYXJndW1lbnQgaWYgd2Uga2VlcCB0aGUgZnVsbFxyXG4gKiByZXNvdXJjZSBuYW1lIGluIGRvY3VtZW50cy5cclxuICovXHJcbnZhciBKc29uUHJvdG9TZXJpYWxpemVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSnNvblByb3RvU2VyaWFsaXplcihkYXRhYmFzZUlkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gZGF0YWJhc2VJZDtcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgfVxyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZW1wdHlCeXRlU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMudXNlUHJvdG8zSnNvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnVuc2FmZUNhc3RQcm90b0J5dGVTdHJpbmcgPSBmdW5jdGlvbiAoYnl0ZVN0cmluZykge1xyXG4gICAgICAgIC8vIGJ5dGVTdHJpbmdzIGNhbiBiZSBlaXRoZXIgc3RyaW5nIG9yIFVJbnQ4QXJyYXksIGJ1dCB0aGUgdHlwaW5ncyBzYXlcclxuICAgICAgICAvLyBpdCdzIGFsd2F5cyBhIHN0cmluZy4gQ2FzdCBhcyBzdHJpbmcgdG8gYXZvaWQgdHlwZSBjaGVjayBmYWlsaW5nXHJcbiAgICAgICAgcmV0dXJuIGJ5dGVTdHJpbmc7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVJwY1N0YXR1cyA9IGZ1bmN0aW9uIChzdGF0dXMpIHtcclxuICAgICAgICB2YXIgY29kZSA9IHN0YXR1cy5jb2RlID09PSB1bmRlZmluZWRcclxuICAgICAgICAgICAgPyBDb2RlLlVOS05PV05cclxuICAgICAgICAgICAgOiBtYXBDb2RlRnJvbVJwY0NvZGUoc3RhdHVzLmNvZGUpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRmlyZXN0b3JlRXJyb3IoY29kZSwgc3RhdHVzLm1lc3NhZ2UgfHwgJycpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIHZhbHVlIGZvciBhIG51bWJlciAob3IgdW5kZWZpbmVkKSB0aGF0J3MgYXBwcm9wcmlhdGUgdG8gcHV0IGludG9cclxuICAgICAqIGEgZ29vZ2xlLnByb3RvYnVmLkludDMyVmFsdWUgcHJvdG8uXHJcbiAgICAgKiBETyBOT1QgVVNFIFRISVMgRk9SIEFOWVRISU5HIEVMU0UuXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBjaGVhdHMuIEl0J3MgdHlwZWQgYXMgcmV0dXJuaW5nIFwibnVtYmVyXCIgYmVjYXVzZSB0aGF0J3Mgd2hhdFxyXG4gICAgICogb3VyIGdlbmVyYXRlZCBwcm90byBpbnRlcmZhY2VzIHNheSBJbnQzMlZhbHVlIG11c3QgYmUuIEJ1dCBHUlBDIGFjdHVhbGx5XHJcbiAgICAgKiBleHBlY3RzIGEgeyB2YWx1ZTogPG51bWJlcj4gfSBzdHJ1Y3QuXHJcbiAgICAgKi9cclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvSW50MzJWYWx1ZSA9IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHZhbCkpIHtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBXZSBuZWVkIHRvIG1hdGNoIGdlbmVyYXRlZCBQcm90byB0eXBlcy5cclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHZhbCB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgbnVtYmVyIChvciBudWxsKSBmcm9tIGEgZ29vZ2xlLnByb3RvYnVmLkludDMyVmFsdWUgcHJvdG8uXHJcbiAgICAgKiBETyBOT1QgVVNFIFRISVMgRk9SIEFOWVRISU5HIEVMU0UuXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBjaGVhdHMuIEl0J3MgdHlwZWQgYXMgYWNjZXB0aW5nIFwibnVtYmVyXCIgYmVjYXVzZSB0aGF0J3Mgd2hhdFxyXG4gICAgICogb3VyIGdlbmVyYXRlZCBwcm90byBpbnRlcmZhY2VzIHNheSBJbnQzMlZhbHVlIG11c3QgYmUsIGJ1dCBpdCBhY3R1YWxseVxyXG4gICAgICogYWNjZXB0cyB7IHZhbHVlOiBudW1iZXIgfSB0byBtYXRjaCBvdXIgc2VyaWFsaXphdGlvbiBpbiB0b0ludDMyVmFsdWUoKS5cclxuICAgICAqL1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbUludDMyVmFsdWUgPSBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdDtcclxuICAgICAgICBpZiAodHlwZW9mIHZhbCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBXZSBuZWVkIHRvIG1hdGNoIGdlbmVyYXRlZCBQcm90byB0eXBlcy5cclxuICAgICAgICAgICAgcmVzdWx0ID0gdmFsLnZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gV2UgYWNjZXB0IHJhdyBudW1iZXJzICh3aXRob3V0IHRoZSB7dmFsdWU6IC4uLiB9IHdyYXBwZXIpIGZvclxyXG4gICAgICAgICAgICAvLyBjb21wYXRpYmlsaXR5IHdpdGggbGVnYWN5IHBlcnNpc3RlZCBkYXRhLlxyXG4gICAgICAgICAgICByZXN1bHQgPSB2YWw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpc051bGxPclVuZGVmaW5lZChyZXN1bHQpID8gbnVsbCA6IHJlc3VsdDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBEYXRlIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50byBhIHByb3RvLlxyXG4gICAgICogRE8gTk9UIFVTRSBUSElTIEZPUiBBTllUSElORyBFTFNFLlxyXG4gICAgICogVGhpcyBtZXRob2QgY2hlYXRzLiBJdCdzIHR5cGVkIGFzIHJldHVybmluZyBcInN0cmluZ1wiIGJlY2F1c2UgdGhhdCdzIHdoYXRcclxuICAgICAqIG91ciBnZW5lcmF0ZWQgcHJvdG8gaW50ZXJmYWNlcyBzYXkgZGF0ZXMgbXVzdCBiZS4gQnV0IGl0J3MgZWFzaWVyIGFuZCBzYWZlclxyXG4gICAgICogdG8gYWN0dWFsbHkgcmV0dXJuIGEgVGltZXN0YW1wIHByb3RvLlxyXG4gICAgICovXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1RpbWVzdGFtcCA9IGZ1bmN0aW9uICh0aW1lc3RhbXApIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZWNvbmRzOiB0aW1lc3RhbXAuc2Vjb25kcyxcclxuICAgICAgICAgICAgbmFub3M6IHRpbWVzdGFtcC5uYW5vc2Vjb25kc1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tVGltZXN0YW1wID0gZnVuY3Rpb24gKGRhdGUpIHtcclxuICAgICAgICAvLyBUaGUganNvbiBpbnRlcmZhY2UgKGZvciB0aGUgYnJvd3Nlcikgd2lsbCByZXR1cm4gYW4gaXNvIHRpbWVzdGFtcCBzdHJpbmcsXHJcbiAgICAgICAgLy8gd2hpbGUgdGhlIHByb3RvIGpzIGxpYnJhcnkgKGZvciBub2RlKSB3aWxsIHJldHVybiBhXHJcbiAgICAgICAgLy8gZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcCBpbnN0YW5jZS5cclxuICAgICAgICBpZiAodHlwZW9mIGRhdGUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE8oYi8zNzI4MjIzNyk6IFVzZSBzdHJpbmdzIGZvciBQcm90bzMgdGltZXN0YW1wc1xyXG4gICAgICAgICAgICAvLyBhc3NlcnQodGhpcy5vcHRpb25zLnVzZVByb3RvM0pzb24sXHJcbiAgICAgICAgICAgIC8vICAgJ1RoZSB0aW1lc3RhbXAgc3RyaW5nIGZvcm1hdCByZXF1aXJlcyBQcm90bzMuJyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZyb21Jc284NjAxU3RyaW5nKGRhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgYXNzZXJ0KCEhZGF0ZSwgJ0Nhbm5vdCBkZXNlcmlhbGl6ZSBudWxsIG9yIHVuZGVmaW5lZCB0aW1lc3RhbXAuJyk7XHJcbiAgICAgICAgICAgIC8vIFRPRE8oYi8zNzI4MjIzNyk6IFVzZSBzdHJpbmdzIGZvciBQcm90bzMgdGltZXN0YW1wc1xyXG4gICAgICAgICAgICAvLyBhc3NlcnQoIXRoaXMub3B0aW9ucy51c2VQcm90bzNKc29uLFxyXG4gICAgICAgICAgICAvLyAgICdUaGUgdGltZXN0YW1wIGluc3RhbmNlIGZvcm1hdCByZXF1aXJlcyBQcm90byBKUy4nKTtcclxuICAgICAgICAgICAgdmFyIHNlY29uZHMgPSBwYXJzZUludDY0KGRhdGUuc2Vjb25kcyB8fCAnMCcpO1xyXG4gICAgICAgICAgICB2YXIgbmFub3MgPSBkYXRlLm5hbm9zIHx8IDA7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVGltZXN0YW1wKHNlY29uZHMsIG5hbm9zKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbUlzbzg2MDFTdHJpbmcgPSBmdW5jdGlvbiAodXRjKSB7XHJcbiAgICAgICAgLy8gVGhlIGRhdGUgc3RyaW5nIGNhbiBoYXZlIGhpZ2hlciBwcmVjaXNpb24gKG5hbm9zKSB0aGFuIHRoZSBEYXRlIGNsYXNzXHJcbiAgICAgICAgLy8gKG1pbGxpcyksIHNvIHdlIGRvIHNvbWUgY3VzdG9tIHBhcnNpbmcgaGVyZS5cclxuICAgICAgICAvLyBQYXJzZSB0aGUgbmFub3MgcmlnaHQgb3V0IG9mIHRoZSBzdHJpbmcuXHJcbiAgICAgICAgdmFyIG5hbm9zID0gMDtcclxuICAgICAgICB2YXIgZnJhY3Rpb24gPSBJU09fUkVHX0VYUC5leGVjKHV0Yyk7XHJcbiAgICAgICAgYXNzZXJ0KCEhZnJhY3Rpb24sICdpbnZhbGlkIHRpbWVzdGFtcDogJyArIHV0Yyk7XHJcbiAgICAgICAgaWYgKGZyYWN0aW9uWzFdKSB7XHJcbiAgICAgICAgICAgIC8vIFBhZCB0aGUgZnJhY3Rpb24gb3V0IHRvIDkgZGlnaXRzIChuYW5vcykuXHJcbiAgICAgICAgICAgIHZhciBuYW5vU3RyID0gZnJhY3Rpb25bMV07XHJcbiAgICAgICAgICAgIG5hbm9TdHIgPSAobmFub1N0ciArICcwMDAwMDAwMDAnKS5zdWJzdHIoMCwgOSk7XHJcbiAgICAgICAgICAgIG5hbm9zID0gTnVtYmVyKG5hbm9TdHIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBQYXJzZSB0aGUgZGF0ZSB0byBnZXQgdGhlIHNlY29uZHMuXHJcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSh1dGMpO1xyXG4gICAgICAgIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcihkYXRlLmdldFRpbWUoKSAvIDEwMDApO1xyXG4gICAgICAgIHJldHVybiBuZXcgVGltZXN0YW1wKHNlY29uZHMsIG5hbm9zKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYnl0ZXMgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbiBhIHByb3RvLlxyXG4gICAgICogRE8gTk9UIFVTRSBUSElTIEZPUiBBTllUSElORyBFTFNFLlxyXG4gICAgICogVGhpcyBtZXRob2QgY2hlYXRzLiBJdCdzIHR5cGVkIGFzIHJldHVybmluZyBcInN0cmluZ1wiIGJlY2F1c2UgdGhhdCdzIHdoYXRcclxuICAgICAqIG91ciBnZW5lcmF0ZWQgcHJvdG8gaW50ZXJmYWNlcyBzYXkgYnl0ZXMgbXVzdCBiZS4gQnV0IGl0IHNob3VsZCByZXR1cm5cclxuICAgICAqIGFuIFVpbnQ4QXJyYXkgaW4gTm9kZS5cclxuICAgICAqL1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChieXRlcykge1xyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMudXNlUHJvdG8zSnNvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gYnl0ZXMudG9CYXNlNjQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFRoZSB0eXBpbmdzIHNheSBpdCdzIGEgc3RyaW5nLCBidXQgaXQgbmVlZHMgdG8gYmUgYSBVaW50OEFycmF5IGluIE5vZGUuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnVuc2FmZUNhc3RQcm90b0J5dGVTdHJpbmcoYnl0ZXMudG9VaW50OEFycmF5KCkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlIHRoZSBibG9iIGZyb20gdGhlIHByb3RvcyBpbnRvIHRoZSBpbnRlcm5hbCBCbG9iIGNsYXNzLiBOb3RlIHRoYXQgdGhlXHJcbiAgICAgKiB0eXBpbmdzIGFzc3VtZSBhbGwgYmxvYnMgYXJlIHN0cmluZ3MsIGJ1dCB0aGV5IGFyZSBhY3R1YWxseSBVaW50OEFycmF5c1xyXG4gICAgICogb24gTm9kZS5cclxuICAgICAqL1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbUJsb2IgPSBmdW5jdGlvbiAoYmxvYikge1xyXG4gICAgICAgIGlmICh0eXBlb2YgYmxvYiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KHRoaXMub3B0aW9ucy51c2VQcm90bzNKc29uLCAnRXhwZWN0ZWQgYnl0ZXMgdG8gYmUgcGFzc2VkIGluIGFzIFVpbnQ4QXJyYXksIGJ1dCBnb3QgYSBzdHJpbmcgaW5zdGVhZC4nKTtcclxuICAgICAgICAgICAgcmV0dXJuIEJsb2IuZnJvbUJhc2U2NFN0cmluZyhibG9iKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGFzc2VydCghdGhpcy5vcHRpb25zLnVzZVByb3RvM0pzb24sICdFeHBlY3RlZCBieXRlcyB0byBiZSBwYXNzZWQgaW4gYXMgc3RyaW5nLCBidXQgZ290IHNvbWV0aGluZyBlbHNlIGluc3RlYWQuJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBCbG9iLmZyb21VaW50OEFycmF5KGJsb2IpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1ZlcnNpb24gPSBmdW5jdGlvbiAodmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRvVGltZXN0YW1wKHZlcnNpb24udG9UaW1lc3RhbXAoKSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVZlcnNpb24gPSBmdW5jdGlvbiAodmVyc2lvbikge1xyXG4gICAgICAgIGFzc2VydCghIXZlcnNpb24sIFwiVHJ5aW5nIHRvIGRlc2VyaWFsaXplIHZlcnNpb24gdGhhdCBpc24ndCBzZXRcIik7XHJcbiAgICAgICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5mcm9tVGltZXN0YW1wKHRoaXMuZnJvbVRpbWVzdGFtcCh2ZXJzaW9uKSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9SZXNvdXJjZU5hbWUgPSBmdW5jdGlvbiAoZGF0YWJhc2VJZCwgcGF0aCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZ1bGx5UXVhbGlmaWVkUHJlZml4UGF0aChkYXRhYmFzZUlkKVxyXG4gICAgICAgICAgICAuY2hpbGQoJ2RvY3VtZW50cycpXHJcbiAgICAgICAgICAgIC5jaGlsZChwYXRoKVxyXG4gICAgICAgICAgICAuY2Fub25pY2FsU3RyaW5nKCk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVJlc291cmNlTmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgdmFyIHJlc291cmNlID0gUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcobmFtZSk7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuaXNWYWxpZFJlc291cmNlTmFtZShyZXNvdXJjZSksICdUcmllZCB0byBkZXNlcmlhbGl6ZSBpbnZhbGlkIGtleSAnICsgcmVzb3VyY2UudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc291cmNlO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvTmFtZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50b1Jlc291cmNlTmFtZSh0aGlzLmRhdGFiYXNlSWQsIGtleS5wYXRoKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tTmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgdmFyIHJlc291cmNlID0gdGhpcy5mcm9tUmVzb3VyY2VOYW1lKG5hbWUpO1xyXG4gICAgICAgIGFzc2VydChyZXNvdXJjZS5nZXQoMSkgPT09IHRoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWQsICdUcmllZCB0byBkZXNlcmlhbGl6ZSBrZXkgZnJvbSBkaWZmZXJlbnQgcHJvamVjdDogJyArXHJcbiAgICAgICAgICAgIHJlc291cmNlLmdldCgxKSArXHJcbiAgICAgICAgICAgICcgdnMgJyArXHJcbiAgICAgICAgICAgIHRoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWQpO1xyXG4gICAgICAgIGFzc2VydCgoIXJlc291cmNlLmdldCgzKSAmJiAhdGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlKSB8fFxyXG4gICAgICAgICAgICByZXNvdXJjZS5nZXQoMykgPT09IHRoaXMuZGF0YWJhc2VJZC5kYXRhYmFzZSwgJ1RyaWVkIHRvIGRlc2VyaWFsaXplIGtleSBmcm9tIGRpZmZlcmVudCBkYXRhYmFzZTogJyArXHJcbiAgICAgICAgICAgIHJlc291cmNlLmdldCgzKSArXHJcbiAgICAgICAgICAgICcgdnMgJyArXHJcbiAgICAgICAgICAgIHRoaXMuZGF0YWJhc2VJZC5kYXRhYmFzZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEtleSh0aGlzLmV4dHJhY3RMb2NhbFBhdGhGcm9tUmVzb3VyY2VOYW1lKHJlc291cmNlKSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9RdWVyeVBhdGggPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAvLyBJZiB0aGUgcGF0aCBpcyBlbXB0eSwgdGhlIGJhY2tlbmQgcmVxdWlyZXMgd2UgbGVhdmUgb2ZmIHRoZSAvZG9jdW1lbnRzXHJcbiAgICAgICAgICAgIC8vIGF0IHRoZSBlbmQuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVuY29kZWREYXRhYmFzZUlkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy50b1Jlc291cmNlTmFtZSh0aGlzLmRhdGFiYXNlSWQsIHBhdGgpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21RdWVyeVBhdGggPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHZhciByZXNvdXJjZU5hbWUgPSB0aGlzLmZyb21SZXNvdXJjZU5hbWUobmFtZSk7XHJcbiAgICAgICAgaWYgKHJlc291cmNlTmFtZS5sZW5ndGggPT09IDQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFJlc291cmNlUGF0aC5FTVBUWV9QQVRIO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5leHRyYWN0TG9jYWxQYXRoRnJvbVJlc291cmNlTmFtZShyZXNvdXJjZU5hbWUpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZSwgXCJlbmNvZGVkRGF0YWJhc2VJZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gbmV3IFJlc291cmNlUGF0aChbXHJcbiAgICAgICAgICAgICAgICAncHJvamVjdHMnLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhYmFzZUlkLnByb2plY3RJZCxcclxuICAgICAgICAgICAgICAgICdkYXRhYmFzZXMnLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlXHJcbiAgICAgICAgICAgIF0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZ1bGx5UXVhbGlmaWVkUHJlZml4UGF0aCA9IGZ1bmN0aW9uIChkYXRhYmFzZUlkKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZXNvdXJjZVBhdGgoW1xyXG4gICAgICAgICAgICAncHJvamVjdHMnLFxyXG4gICAgICAgICAgICBkYXRhYmFzZUlkLnByb2plY3RJZCxcclxuICAgICAgICAgICAgJ2RhdGFiYXNlcycsXHJcbiAgICAgICAgICAgIGRhdGFiYXNlSWQuZGF0YWJhc2VcclxuICAgICAgICBdKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5leHRyYWN0TG9jYWxQYXRoRnJvbVJlc291cmNlTmFtZSA9IGZ1bmN0aW9uIChyZXNvdXJjZU5hbWUpIHtcclxuICAgICAgICBhc3NlcnQocmVzb3VyY2VOYW1lLmxlbmd0aCA+IDQgJiYgcmVzb3VyY2VOYW1lLmdldCg0KSA9PT0gJ2RvY3VtZW50cycsICd0cmllZCB0byBkZXNlcmlhbGl6ZSBpbnZhbGlkIGtleSAnICsgcmVzb3VyY2VOYW1lLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIHJldHVybiByZXNvdXJjZU5hbWUucG9wRmlyc3QoNSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuaXNWYWxpZFJlc291cmNlTmFtZSA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgLy8gUmVzb3VyY2UgbmFtZXMgaGF2ZSBhdCBsZWFzdCA0IGNvbXBvbmVudHMgKHByb2plY3QgSUQsIGRhdGFiYXNlIElEKVxyXG4gICAgICAgIHJldHVybiAocGF0aC5sZW5ndGggPj0gNCAmJlxyXG4gICAgICAgICAgICBwYXRoLmdldCgwKSA9PT0gJ3Byb2plY3RzJyAmJlxyXG4gICAgICAgICAgICBwYXRoLmdldCgyKSA9PT0gJ2RhdGFiYXNlcycpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvVmFsdWUgPSBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIE51bGxWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBudWxsVmFsdWU6ICdOVUxMX1ZBTFVFJyB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBCb29sZWFuVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgYm9vbGVhblZhbHVlOiB2YWwudmFsdWUoKSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBJbnRlZ2VyVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgaW50ZWdlclZhbHVlOiAnJyArIHZhbC52YWx1ZSgpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIERvdWJsZVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBkb3VibGVWYWx1ZSA9IHZhbC52YWx1ZSgpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnVzZVByb3RvM0pzb24pIHtcclxuICAgICAgICAgICAgICAgIC8vIFByb3RvIDMgbGV0J3MgdXMgZW5jb2RlIE5hTiBhbmQgSW5maW5pdHkgYXMgc3RyaW5nIHZhbHVlcyBhc1xyXG4gICAgICAgICAgICAgICAgLy8gZXhwZWN0ZWQgYnkgdGhlIGJhY2tlbmQuIFRoaXMgaXMgY3VycmVudGx5IG5vdCBjaGVja2VkIGJ5IG91ciB1bml0XHJcbiAgICAgICAgICAgICAgICAvLyB0ZXN0cyBiZWNhdXNlIHRoZXkgcmVseSBvbiBwcm90b2J1Zi5qcy5cclxuICAgICAgICAgICAgICAgIGlmIChpc05hTihkb3VibGVWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBkb3VibGVWYWx1ZTogJ05hTicgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGRvdWJsZVZhbHVlID09PSBJbmZpbml0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGRvdWJsZVZhbHVlOiAnSW5maW5pdHknIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChkb3VibGVWYWx1ZSA9PT0gLUluZmluaXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgZG91YmxlVmFsdWU6ICctSW5maW5pdHknIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHsgZG91YmxlVmFsdWU6IHZhbC52YWx1ZSgpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIFN0cmluZ1ZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN0cmluZ1ZhbHVlOiB2YWwudmFsdWUoKSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBPYmplY3RWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBtYXBWYWx1ZTogdGhpcy50b01hcFZhbHVlKHZhbCkgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgQXJyYXlWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBhcnJheVZhbHVlOiB0aGlzLnRvQXJyYXlWYWx1ZSh2YWwpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIFRpbWVzdGFtcFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXBWYWx1ZTogdGhpcy50b1RpbWVzdGFtcCh2YWwuaW50ZXJuYWxWYWx1ZSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgR2VvUG9pbnRWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZ2VvUG9pbnRWYWx1ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGxhdGl0dWRlOiB2YWwudmFsdWUoKS5sYXRpdHVkZSxcclxuICAgICAgICAgICAgICAgICAgICBsb25naXR1ZGU6IHZhbC52YWx1ZSgpLmxvbmdpdHVkZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBCbG9iVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGJ5dGVzVmFsdWU6IHRoaXMudG9CeXRlcyh2YWwudmFsdWUoKSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgUmVmVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHJlZmVyZW5jZVZhbHVlOiB0aGlzLnRvUmVzb3VyY2VOYW1lKHZhbC5kYXRhYmFzZUlkLCB2YWwua2V5LnBhdGgpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBGaWVsZFZhbHVlICcgKyBKU09OLnN0cmluZ2lmeSh2YWwpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVZhbHVlID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxyXG4gICAgICAgIHZhciB0eXBlID0gb2JqWyd2YWx1ZV90eXBlJ107XHJcbiAgICAgICAgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdudWxsVmFsdWUnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gTnVsbFZhbHVlLklOU1RBTkNFO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAnYm9vbGVhblZhbHVlJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW5WYWx1ZS5vZihvYmouYm9vbGVhblZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ2ludGVnZXJWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgSW50ZWdlclZhbHVlKHBhcnNlSW50NjQob2JqLmludGVnZXJWYWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAnZG91YmxlVmFsdWUnKSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnVzZVByb3RvM0pzb24pIHtcclxuICAgICAgICAgICAgICAgIC8vIFByb3RvIDMgdXNlcyB0aGUgc3RyaW5nIHZhbHVlcyAnTmFOJyBhbmQgJ0luZmluaXR5Jy5cclxuICAgICAgICAgICAgICAgIGlmIChvYmouZG91YmxlVmFsdWUgPT09ICdOYU4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERvdWJsZVZhbHVlLk5BTjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9iai5kb3VibGVWYWx1ZSA9PT0gJ0luZmluaXR5Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBEb3VibGVWYWx1ZS5QT1NJVElWRV9JTkZJTklUWTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9iai5kb3VibGVWYWx1ZSA9PT0gJy1JbmZpbml0eScpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRG91YmxlVmFsdWUuTkVHQVRJVkVfSU5GSU5JVFk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEb3VibGVWYWx1ZShvYmouZG91YmxlVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAnc3RyaW5nVmFsdWUnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1ZhbHVlKG9iai5zdHJpbmdWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdtYXBWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZyb21GaWVsZHMob2JqLm1hcFZhbHVlLmZpZWxkcyB8fCB7fSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdhcnJheVZhbHVlJykpIHtcclxuICAgICAgICAgICAgLy8gXCJ2YWx1ZXNcIiBpcyBub3QgcHJlc2VudCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChvYmouYXJyYXlWYWx1ZSwgJ2FycmF5VmFsdWUnKTtcclxuICAgICAgICAgICAgdmFyIHZhbHVlcyQkMSA9IG9iai5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBBcnJheVZhbHVlKHZhbHVlcyQkMS5tYXAoZnVuY3Rpb24gKHYpIHsgcmV0dXJuIF90aGlzLmZyb21WYWx1ZSh2KTsgfSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAndGltZXN0YW1wVmFsdWUnKSkge1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KG9iai50aW1lc3RhbXBWYWx1ZSwgJ3RpbWVzdGFtcFZhbHVlJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVGltZXN0YW1wVmFsdWUodGhpcy5mcm9tVGltZXN0YW1wKG9iai50aW1lc3RhbXBWYWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAnZ2VvUG9pbnRWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQob2JqLmdlb1BvaW50VmFsdWUsICdnZW9Qb2ludFZhbHVlJyk7XHJcbiAgICAgICAgICAgIHZhciBsYXRpdHVkZSA9IG9iai5nZW9Qb2ludFZhbHVlLmxhdGl0dWRlIHx8IDA7XHJcbiAgICAgICAgICAgIHZhciBsb25naXR1ZGUgPSBvYmouZ2VvUG9pbnRWYWx1ZS5sb25naXR1ZGUgfHwgMDtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW9Qb2ludFZhbHVlKG5ldyBHZW9Qb2ludChsYXRpdHVkZSwgbG9uZ2l0dWRlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdieXRlc1ZhbHVlJykpIHtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChvYmouYnl0ZXNWYWx1ZSwgJ2J5dGVzVmFsdWUnKTtcclxuICAgICAgICAgICAgdmFyIGJsb2IgPSB0aGlzLmZyb21CbG9iKG9iai5ieXRlc1ZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBCbG9iVmFsdWUoYmxvYik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdyZWZlcmVuY2VWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQob2JqLnJlZmVyZW5jZVZhbHVlLCAncmVmZXJlbmNlVmFsdWUnKTtcclxuICAgICAgICAgICAgdmFyIHJlc291cmNlTmFtZSA9IHRoaXMuZnJvbVJlc291cmNlTmFtZShvYmoucmVmZXJlbmNlVmFsdWUpO1xyXG4gICAgICAgICAgICB2YXIgZGJJZCA9IG5ldyBEYXRhYmFzZUlkKHJlc291cmNlTmFtZS5nZXQoMSksIHJlc291cmNlTmFtZS5nZXQoMykpO1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gbmV3IERvY3VtZW50S2V5KHRoaXMuZXh0cmFjdExvY2FsUGF0aEZyb21SZXNvdXJjZU5hbWUocmVzb3VyY2VOYW1lKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVmVmFsdWUoZGJJZCwga2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIFZhbHVlIHByb3RvICcgKyBKU09OLnN0cmluZ2lmeShvYmopKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIENyZWF0ZXMgYW4gYXBpLkRvY3VtZW50IGZyb20ga2V5IGFuZCBmaWVsZHMgKGJ1dCBubyBjcmVhdGUvdXBkYXRlIHRpbWUpICovXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b011dGF0aW9uRG9jdW1lbnQgPSBmdW5jdGlvbiAoa2V5LCBmaWVsZHMpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLnRvTmFtZShrZXkpLFxyXG4gICAgICAgICAgICBmaWVsZHM6IHRoaXMudG9GaWVsZHMoZmllbGRzKVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9Eb2N1bWVudCA9IGZ1bmN0aW9uIChkb2N1bWVudCkge1xyXG4gICAgICAgIGFzc2VydCghZG9jdW1lbnQuaGFzTG9jYWxNdXRhdGlvbnMsIFwiQ2FuJ3Qgc2VyaWFsaXplIGRvY3VtZW50cyB3aXRoIG11dGF0aW9ucy5cIik7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmFtZTogdGhpcy50b05hbWUoZG9jdW1lbnQua2V5KSxcclxuICAgICAgICAgICAgZmllbGRzOiB0aGlzLnRvRmllbGRzKGRvY3VtZW50LmRhdGEpLFxyXG4gICAgICAgICAgICB1cGRhdGVUaW1lOiB0aGlzLnRvVGltZXN0YW1wKGRvY3VtZW50LnZlcnNpb24udG9UaW1lc3RhbXAoKSlcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21Eb2N1bWVudCA9IGZ1bmN0aW9uIChkb2N1bWVudCwgaGFzQ29tbWl0dGVkTXV0YXRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudCh0aGlzLmZyb21OYW1lKGRvY3VtZW50Lm5hbWUpLCB0aGlzLmZyb21WZXJzaW9uKGRvY3VtZW50LnVwZGF0ZVRpbWUpLCB0aGlzLmZyb21GaWVsZHMoZG9jdW1lbnQuZmllbGRzIHx8IHt9KSwgeyBoYXNDb21taXR0ZWRNdXRhdGlvbnM6ICEhaGFzQ29tbWl0dGVkTXV0YXRpb25zIH0pO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvRmllbGRzID0gZnVuY3Rpb24gKGZpZWxkcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgIGZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gX3RoaXMudG9WYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRmllbGRzID0gZnVuY3Rpb24gKG9iamVjdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gUHJvdG8gbWFwPHN0cmluZywgVmFsdWU+IGdldHMgbWFwcGVkIHRvIE9iamVjdCwgc28gY2FzdCBpdC5cclxuICAgICAgICB2YXIgbWFwID0gb2JqZWN0O1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBPYmplY3RWYWx1ZS5FTVBUWTtcclxuICAgICAgICBmb3JFYWNoKG1hcCwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnNldChuZXcgRmllbGRQYXRoKFtrZXldKSwgX3RoaXMuZnJvbVZhbHVlKHZhbHVlKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b01hcFZhbHVlID0gZnVuY3Rpb24gKG1hcCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGZpZWxkczogdGhpcy50b0ZpZWxkcyhtYXApXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0FycmF5VmFsdWUgPSBmdW5jdGlvbiAoYXJyYXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChfdGhpcy50b1ZhbHVlKHZhbHVlKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgdmFsdWVzOiByZXN1bHQgfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRm91bmQgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgYXNzZXJ0KCEhZG9jLmZvdW5kLCAnVHJpZWQgdG8gZGVzZXJpYWxpemUgYSBmb3VuZCBkb2N1bWVudCBmcm9tIGEgbWlzc2luZyBkb2N1bWVudC4nKTtcclxuICAgICAgICBhc3NlcnRQcmVzZW50KGRvYy5mb3VuZC5uYW1lLCAnZG9jLmZvdW5kLm5hbWUnKTtcclxuICAgICAgICBhc3NlcnRQcmVzZW50KGRvYy5mb3VuZC51cGRhdGVUaW1lLCAnZG9jLmZvdW5kLnVwZGF0ZVRpbWUnKTtcclxuICAgICAgICB2YXIga2V5ID0gdGhpcy5mcm9tTmFtZShkb2MuZm91bmQubmFtZSk7XHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLmZyb21WZXJzaW9uKGRvYy5mb3VuZC51cGRhdGVUaW1lKTtcclxuICAgICAgICB2YXIgZmllbGRzID0gdGhpcy5mcm9tRmllbGRzKGRvYy5mb3VuZC5maWVsZHMgfHwge30pO1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnQoa2V5LCB2ZXJzaW9uLCBmaWVsZHMsIHt9KTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tTWlzc2luZyA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICBhc3NlcnQoISFyZXN1bHQubWlzc2luZywgJ1RyaWVkIHRvIGRlc2VyaWFsaXplIGEgbWlzc2luZyBkb2N1bWVudCBmcm9tIGEgZm91bmQgZG9jdW1lbnQuJyk7XHJcbiAgICAgICAgYXNzZXJ0KCEhcmVzdWx0LnJlYWRUaW1lLCAnVHJpZWQgdG8gZGVzZXJpYWxpemUgYSBtaXNzaW5nIGRvY3VtZW50IHdpdGhvdXQgYSByZWFkIHRpbWUuJyk7XHJcbiAgICAgICAgdmFyIGtleSA9IHRoaXMuZnJvbU5hbWUocmVzdWx0Lm1pc3NpbmcpO1xyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gdGhpcy5mcm9tVmVyc2lvbihyZXN1bHQucmVhZFRpbWUpO1xyXG4gICAgICAgIHJldHVybiBuZXcgTm9Eb2N1bWVudChrZXksIHZlcnNpb24pO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21NYXliZURvY3VtZW50ID0gZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnlcclxuICAgICAgICB2YXIgdHlwZSA9IHJlc3VsdFsncmVzdWx0J107XHJcbiAgICAgICAgaWYgKGhhc1RhZyhyZXN1bHQsIHR5cGUsICdmb3VuZCcpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZyb21Gb3VuZChyZXN1bHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcocmVzdWx0LCB0eXBlLCAnbWlzc2luZycpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZyb21NaXNzaW5nKHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWlsKCdpbnZhbGlkIGJhdGNoIGdldCByZXNwb25zZTogJyArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZSkge1xyXG4gICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcclxuICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLkFkZGVkOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdBREQnO1xyXG4gICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQ3VycmVudDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnQ1VSUkVOVCc7XHJcbiAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5Ob0NoYW5nZTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnTk9fQ0hBTkdFJztcclxuICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlbW92ZWQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1JFTU9WRSc7XHJcbiAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5SZXNldDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnUkVTRVQnO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZTogJyArIHN0YXRlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9UZXN0V2F0Y2hDaGFuZ2UgPSBmdW5jdGlvbiAod2F0Y2hDaGFuZ2UpIHtcclxuICAgICAgICBpZiAod2F0Y2hDaGFuZ2UgaW5zdGFuY2VvZiBFeGlzdGVuY2VGaWx0ZXJDaGFuZ2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGZpbHRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50OiB3YXRjaENoYW5nZS5leGlzdGVuY2VGaWx0ZXIuY291bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IHdhdGNoQ2hhbmdlLnRhcmdldElkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh3YXRjaENoYW5nZSBpbnN0YW5jZW9mIERvY3VtZW50V2F0Y2hDaGFuZ2UpIHtcclxuICAgICAgICAgICAgaWYgKHdhdGNoQ2hhbmdlLm5ld0RvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jID0gd2F0Y2hDaGFuZ2UubmV3RG9jO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudENoYW5nZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy50b05hbWUoZG9jLmtleSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHRoaXMudG9GaWVsZHMoZG9jLmRhdGEpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGltZTogdGhpcy50b1ZlcnNpb24oZG9jLnZlcnNpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkczogd2F0Y2hDaGFuZ2UudXBkYXRlZFRhcmdldElkcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZFRhcmdldElkczogd2F0Y2hDaGFuZ2UucmVtb3ZlZFRhcmdldElkc1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAod2F0Y2hDaGFuZ2UubmV3RG9jIGluc3RhbmNlb2YgTm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRvYyA9IHdhdGNoQ2hhbmdlLm5ld0RvYztcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnREZWxldGU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQ6IHRoaXMudG9OYW1lKGRvYy5rZXkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkVGltZTogdGhpcy50b1ZlcnNpb24oZG9jLnZlcnNpb24pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkVGFyZ2V0SWRzOiB3YXRjaENoYW5nZS5yZW1vdmVkVGFyZ2V0SWRzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh3YXRjaENoYW5nZS5uZXdEb2MgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRSZW1vdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQ6IHRoaXMudG9OYW1lKHdhdGNoQ2hhbmdlLmtleSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWRUYXJnZXRJZHM6IHdhdGNoQ2hhbmdlLnJlbW92ZWRUYXJnZXRJZHNcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh3YXRjaENoYW5nZSBpbnN0YW5jZW9mIFdhdGNoVGFyZ2V0Q2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHZhciBjYXVzZSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgaWYgKHdhdGNoQ2hhbmdlLmNhdXNlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXVzZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBjb2RlOiBtYXBScGNDb2RlRnJvbUNvZGUod2F0Y2hDaGFuZ2UuY2F1c2UuY29kZSksXHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogd2F0Y2hDaGFuZ2UuY2F1c2UubWVzc2FnZVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlVHlwZTogdGhpcy50b1dhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUod2F0Y2hDaGFuZ2Uuc3RhdGUpLFxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldElkczogd2F0Y2hDaGFuZ2UudGFyZ2V0SWRzLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VtZVRva2VuOiB0aGlzLnVuc2FmZUNhc3RQcm90b0J5dGVTdHJpbmcod2F0Y2hDaGFuZ2UucmVzdW1lVG9rZW4pLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdXNlOiBjYXVzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFpbCgnVW5yZWNvZ25pemVkIHdhdGNoIGNoYW5nZTogJyArIEpTT04uc3RyaW5naWZ5KHdhdGNoQ2hhbmdlKSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVdhdGNoQ2hhbmdlID0gZnVuY3Rpb24gKGNoYW5nZSkge1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnlcclxuICAgICAgICB2YXIgdHlwZSA9IGNoYW5nZVsncmVzcG9uc2VfdHlwZSddO1xyXG4gICAgICAgIHZhciB3YXRjaENoYW5nZTtcclxuICAgICAgICBpZiAoaGFzVGFnKGNoYW5nZSwgdHlwZSwgJ3RhcmdldENoYW5nZScpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLnRhcmdldENoYW5nZSwgJ3RhcmdldENoYW5nZScpO1xyXG4gICAgICAgICAgICAvLyBwcm90bzMgZGVmYXVsdCB2YWx1ZSBpcyB1bnNldCBpbiBKU09OICh1bmRlZmluZWQpLCBzbyB1c2UgJ05PX0NIQU5HRSdcclxuICAgICAgICAgICAgLy8gaWYgdW5zZXRcclxuICAgICAgICAgICAgdmFyIHN0YXRlID0gdGhpcy5mcm9tV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZShjaGFuZ2UudGFyZ2V0Q2hhbmdlLnRhcmdldENoYW5nZVR5cGUgfHwgJ05PX0NIQU5HRScpO1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0SWRzID0gY2hhbmdlLnRhcmdldENoYW5nZS50YXJnZXRJZHMgfHwgW107XHJcbiAgICAgICAgICAgIHZhciByZXN1bWVUb2tlbiA9IGNoYW5nZS50YXJnZXRDaGFuZ2UucmVzdW1lVG9rZW4gfHwgdGhpcy5lbXB0eUJ5dGVTdHJpbmcoKTtcclxuICAgICAgICAgICAgdmFyIGNhdXNlUHJvdG8gPSBjaGFuZ2UudGFyZ2V0Q2hhbmdlLmNhdXNlO1xyXG4gICAgICAgICAgICB2YXIgY2F1c2UgPSBjYXVzZVByb3RvICYmIHRoaXMuZnJvbVJwY1N0YXR1cyhjYXVzZVByb3RvKTtcclxuICAgICAgICAgICAgd2F0Y2hDaGFuZ2UgPSBuZXcgV2F0Y2hUYXJnZXRDaGFuZ2Uoc3RhdGUsIHRhcmdldElkcywgcmVzdW1lVG9rZW4sIGNhdXNlIHx8IG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcoY2hhbmdlLCB0eXBlLCAnZG9jdW1lbnRDaGFuZ2UnKSkge1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5kb2N1bWVudENoYW5nZSwgJ2RvY3VtZW50Q2hhbmdlJyk7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmRvY3VtZW50Q2hhbmdlLmRvY3VtZW50LCAnZG9jdW1lbnRDaGFuZ2UubmFtZScpO1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5kb2N1bWVudENoYW5nZS5kb2N1bWVudC5uYW1lLCAnZG9jdW1lbnRDaGFuZ2UuZG9jdW1lbnQubmFtZScpO1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5kb2N1bWVudENoYW5nZS5kb2N1bWVudC51cGRhdGVUaW1lLCAnZG9jdW1lbnRDaGFuZ2UuZG9jdW1lbnQudXBkYXRlVGltZScpO1xyXG4gICAgICAgICAgICB2YXIgZW50aXR5Q2hhbmdlID0gY2hhbmdlLmRvY3VtZW50Q2hhbmdlO1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5mcm9tTmFtZShlbnRpdHlDaGFuZ2UuZG9jdW1lbnQubmFtZSk7XHJcbiAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gdGhpcy5mcm9tVmVyc2lvbihlbnRpdHlDaGFuZ2UuZG9jdW1lbnQudXBkYXRlVGltZSk7XHJcbiAgICAgICAgICAgIHZhciBmaWVsZHMgPSB0aGlzLmZyb21GaWVsZHMoZW50aXR5Q2hhbmdlLmRvY3VtZW50LmZpZWxkcyB8fCB7fSk7XHJcbiAgICAgICAgICAgIHZhciBkb2MgPSBuZXcgRG9jdW1lbnQoa2V5LCB2ZXJzaW9uLCBmaWVsZHMsIHt9KTtcclxuICAgICAgICAgICAgdmFyIHVwZGF0ZWRUYXJnZXRJZHMgPSBlbnRpdHlDaGFuZ2UudGFyZ2V0SWRzIHx8IFtdO1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZFRhcmdldElkcyA9IGVudGl0eUNoYW5nZS5yZW1vdmVkVGFyZ2V0SWRzIHx8IFtdO1xyXG4gICAgICAgICAgICB3YXRjaENoYW5nZSA9IG5ldyBEb2N1bWVudFdhdGNoQ2hhbmdlKHVwZGF0ZWRUYXJnZXRJZHMsIHJlbW92ZWRUYXJnZXRJZHMsIGRvYy5rZXksIGRvYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhjaGFuZ2UsIHR5cGUsICdkb2N1bWVudERlbGV0ZScpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmRvY3VtZW50RGVsZXRlLCAnZG9jdW1lbnREZWxldGUnKTtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZG9jdW1lbnREZWxldGUuZG9jdW1lbnQsICdkb2N1bWVudERlbGV0ZS5kb2N1bWVudCcpO1xyXG4gICAgICAgICAgICB2YXIgZG9jRGVsZXRlID0gY2hhbmdlLmRvY3VtZW50RGVsZXRlO1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5mcm9tTmFtZShkb2NEZWxldGUuZG9jdW1lbnQpO1xyXG4gICAgICAgICAgICB2YXIgdmVyc2lvbiA9IGRvY0RlbGV0ZS5yZWFkVGltZVxyXG4gICAgICAgICAgICAgICAgPyB0aGlzLmZyb21WZXJzaW9uKGRvY0RlbGV0ZS5yZWFkVGltZSlcclxuICAgICAgICAgICAgICAgIDogU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKTtcclxuICAgICAgICAgICAgdmFyIGRvYyA9IG5ldyBOb0RvY3VtZW50KGtleSwgdmVyc2lvbik7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVkVGFyZ2V0SWRzID0gZG9jRGVsZXRlLnJlbW92ZWRUYXJnZXRJZHMgfHwgW107XHJcbiAgICAgICAgICAgIHdhdGNoQ2hhbmdlID0gbmV3IERvY3VtZW50V2F0Y2hDaGFuZ2UoW10sIHJlbW92ZWRUYXJnZXRJZHMsIGRvYy5rZXksIGRvYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhjaGFuZ2UsIHR5cGUsICdkb2N1bWVudFJlbW92ZScpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmRvY3VtZW50UmVtb3ZlLCAnZG9jdW1lbnRSZW1vdmUnKTtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZG9jdW1lbnRSZW1vdmUuZG9jdW1lbnQsICdkb2N1bWVudFJlbW92ZScpO1xyXG4gICAgICAgICAgICB2YXIgZG9jUmVtb3ZlID0gY2hhbmdlLmRvY3VtZW50UmVtb3ZlO1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5mcm9tTmFtZShkb2NSZW1vdmUuZG9jdW1lbnQpO1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZFRhcmdldElkcyA9IGRvY1JlbW92ZS5yZW1vdmVkVGFyZ2V0SWRzIHx8IFtdO1xyXG4gICAgICAgICAgICB3YXRjaENoYW5nZSA9IG5ldyBEb2N1bWVudFdhdGNoQ2hhbmdlKFtdLCByZW1vdmVkVGFyZ2V0SWRzLCBrZXksIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcoY2hhbmdlLCB0eXBlLCAnZmlsdGVyJykpIHtcclxuICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBpbXBsZW1lbnQgZXhpc3RlbmNlIGZpbHRlciBwYXJzaW5nIHdpdGggc3RyYXRlZ3kuXHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmZpbHRlciwgJ2ZpbHRlcicpO1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5maWx0ZXIudGFyZ2V0SWQsICdmaWx0ZXIudGFyZ2V0SWQnKTtcclxuICAgICAgICAgICAgdmFyIGZpbHRlciA9IGNoYW5nZS5maWx0ZXI7XHJcbiAgICAgICAgICAgIHZhciBjb3VudCA9IGZpbHRlci5jb3VudCB8fCAwO1xyXG4gICAgICAgICAgICB2YXIgZXhpc3RlbmNlRmlsdGVyID0gbmV3IEV4aXN0ZW5jZUZpbHRlcihjb3VudCk7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IGZpbHRlci50YXJnZXRJZDtcclxuICAgICAgICAgICAgd2F0Y2hDaGFuZ2UgPSBuZXcgRXhpc3RlbmNlRmlsdGVyQ2hhbmdlKHRhcmdldElkLCBleGlzdGVuY2VGaWx0ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gY2hhbmdlIHR5cGUgJyArIEpTT04uc3RyaW5naWZ5KGNoYW5nZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gd2F0Y2hDaGFuZ2U7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUgPSBmdW5jdGlvbiAoc3RhdGUpIHtcclxuICAgICAgICBpZiAoc3RhdGUgPT09ICdOT19DSEFOR0UnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLk5vQ2hhbmdlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChzdGF0ZSA9PT0gJ0FERCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQWRkZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHN0YXRlID09PSAnUkVNT1ZFJykge1xyXG4gICAgICAgICAgICByZXR1cm4gV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5SZW1vdmVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChzdGF0ZSA9PT0gJ0NVUlJFTlQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLkN1cnJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHN0YXRlID09PSAnUkVTRVQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlc2V0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ0dvdCB1bmV4cGVjdGVkIFRhcmdldENoYW5nZS5zdGF0ZTogJyArIHN0YXRlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudmVyc2lvbkZyb21MaXN0ZW5SZXNwb25zZSA9IGZ1bmN0aW9uIChjaGFuZ2UpIHtcclxuICAgICAgICAvLyBXZSBoYXZlIG9ubHkgcmVhY2hlZCBhIGNvbnNpc3RlbnQgc25hcHNob3QgZm9yIHRoZSBlbnRpcmUgc3RyZWFtIGlmIHRoZXJlXHJcbiAgICAgICAgLy8gaXMgYSByZWFkX3RpbWUgc2V0IGFuZCBpdCBhcHBsaWVzIHRvIGFsbCB0YXJnZXRzIChpLmUuIHRoZSBsaXN0IG9mXHJcbiAgICAgICAgLy8gdGFyZ2V0cyBpcyBlbXB0eSkuIFRoZSBiYWNrZW5kIGlzIGd1YXJhbnRlZWQgdG8gc2VuZCBzdWNoIHJlc3BvbnNlcy5cclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55XHJcbiAgICAgICAgdmFyIHR5cGUgPSBjaGFuZ2VbJ3Jlc3BvbnNlX3R5cGUnXTtcclxuICAgICAgICBpZiAoIWhhc1RhZyhjaGFuZ2UsIHR5cGUsICd0YXJnZXRDaGFuZ2UnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uLk1JTjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHRhcmdldENoYW5nZSA9IGNoYW5nZS50YXJnZXRDaGFuZ2U7XHJcbiAgICAgICAgaWYgKHRhcmdldENoYW5nZS50YXJnZXRJZHMgJiYgdGFyZ2V0Q2hhbmdlLnRhcmdldElkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5NSU47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGFyZ2V0Q2hhbmdlLnJlYWRUaW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTbmFwc2hvdFZlcnNpb24uTUlOO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5mcm9tVmVyc2lvbih0YXJnZXRDaGFuZ2UucmVhZFRpbWUpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvTXV0YXRpb24gPSBmdW5jdGlvbiAobXV0YXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXN1bHQ7XHJcbiAgICAgICAgaWYgKG11dGF0aW9uIGluc3RhbmNlb2YgU2V0TXV0YXRpb24pIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlOiB0aGlzLnRvTXV0YXRpb25Eb2N1bWVudChtdXRhdGlvbi5rZXksIG11dGF0aW9uLnZhbHVlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtdXRhdGlvbiBpbnN0YW5jZW9mIERlbGV0ZU11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHsgZGVsZXRlOiB0aGlzLnRvTmFtZShtdXRhdGlvbi5rZXkpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG11dGF0aW9uIGluc3RhbmNlb2YgUGF0Y2hNdXRhdGlvbikge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGU6IHRoaXMudG9NdXRhdGlvbkRvY3VtZW50KG11dGF0aW9uLmtleSwgbXV0YXRpb24uZGF0YSksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVNYXNrOiB0aGlzLnRvRG9jdW1lbnRNYXNrKG11dGF0aW9uLmZpZWxkTWFzaylcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobXV0YXRpb24gaW5zdGFuY2VvZiBUcmFuc2Zvcm1NdXRhdGlvbikge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudDogdGhpcy50b05hbWUobXV0YXRpb24ua2V5KSxcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZFRyYW5zZm9ybXM6IG11dGF0aW9uLmZpZWxkVHJhbnNmb3Jtcy5tYXAoZnVuY3Rpb24gKHRyYW5zZm9ybSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudG9GaWVsZFRyYW5zZm9ybSh0cmFuc2Zvcm0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBtdXRhdGlvbiB0eXBlICcgKyBtdXRhdGlvbi50eXBlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFtdXRhdGlvbi5wcmVjb25kaXRpb24uaXNOb25lKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5jdXJyZW50RG9jdW1lbnQgPSB0aGlzLnRvUHJlY29uZGl0aW9uKG11dGF0aW9uLnByZWNvbmRpdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbU11dGF0aW9uID0gZnVuY3Rpb24gKHByb3RvKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcHJlY29uZGl0aW9uID0gcHJvdG8uY3VycmVudERvY3VtZW50XHJcbiAgICAgICAgICAgID8gdGhpcy5mcm9tUHJlY29uZGl0aW9uKHByb3RvLmN1cnJlbnREb2N1bWVudClcclxuICAgICAgICAgICAgOiBQcmVjb25kaXRpb24uTk9ORTtcclxuICAgICAgICBpZiAocHJvdG8udXBkYXRlKSB7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQocHJvdG8udXBkYXRlLm5hbWUsICduYW1lJyk7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzLmZyb21OYW1lKHByb3RvLnVwZGF0ZS5uYW1lKTtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5mcm9tRmllbGRzKHByb3RvLnVwZGF0ZS5maWVsZHMgfHwge30pO1xyXG4gICAgICAgICAgICBpZiAocHJvdG8udXBkYXRlTWFzaykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkTWFzayA9IHRoaXMuZnJvbURvY3VtZW50TWFzayhwcm90by51cGRhdGVNYXNrKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUGF0Y2hNdXRhdGlvbihrZXksIHZhbHVlLCBmaWVsZE1hc2ssIHByZWNvbmRpdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNldE11dGF0aW9uKGtleSwgdmFsdWUsIHByZWNvbmRpdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocHJvdG8uZGVsZXRlKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzLmZyb21OYW1lKHByb3RvLmRlbGV0ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGVsZXRlTXV0YXRpb24oa2V5LCBwcmVjb25kaXRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwcm90by50cmFuc2Zvcm0pIHtcclxuICAgICAgICAgICAgdmFyIGtleSA9IHRoaXMuZnJvbU5hbWUocHJvdG8udHJhbnNmb3JtLmRvY3VtZW50KTtcclxuICAgICAgICAgICAgdmFyIGZpZWxkVHJhbnNmb3JtcyA9IHByb3RvLnRyYW5zZm9ybS5maWVsZFRyYW5zZm9ybXMubWFwKGZ1bmN0aW9uICh0cmFuc2Zvcm0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5mcm9tRmllbGRUcmFuc2Zvcm0odHJhbnNmb3JtKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGFzc2VydChwcmVjb25kaXRpb24uZXhpc3RzID09PSB0cnVlLCAnVHJhbnNmb3JtcyBvbmx5IHN1cHBvcnQgcHJlY29uZGl0aW9uIFwiZXhpc3RzID09IHRydWVcIicpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFRyYW5zZm9ybU11dGF0aW9uKGtleSwgZmllbGRUcmFuc2Zvcm1zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCd1bmtub3duIG11dGF0aW9uIHByb3RvOiAnICsgSlNPTi5zdHJpbmdpZnkocHJvdG8pKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9QcmVjb25kaXRpb24gPSBmdW5jdGlvbiAocHJlY29uZGl0aW9uKSB7XHJcbiAgICAgICAgYXNzZXJ0KCFwcmVjb25kaXRpb24uaXNOb25lLCBcIkNhbid0IHNlcmlhbGl6ZSBhbiBlbXB0eSBwcmVjb25kaXRpb25cIik7XHJcbiAgICAgICAgaWYgKHByZWNvbmRpdGlvbi51cGRhdGVUaW1lICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVRpbWU6IHRoaXMudG9WZXJzaW9uKHByZWNvbmRpdGlvbi51cGRhdGVUaW1lKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwcmVjb25kaXRpb24uZXhpc3RzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgZXhpc3RzOiBwcmVjb25kaXRpb24uZXhpc3RzIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBwcmVjb25kaXRpb24nKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVByZWNvbmRpdGlvbiA9IGZ1bmN0aW9uIChwcmVjb25kaXRpb24pIHtcclxuICAgICAgICBpZiAocHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUodGhpcy5mcm9tVmVyc2lvbihwcmVjb25kaXRpb24udXBkYXRlVGltZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwcmVjb25kaXRpb24uZXhpc3RzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByZWNvbmRpdGlvbi5leGlzdHMocHJlY29uZGl0aW9uLmV4aXN0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJlY29uZGl0aW9uLk5PTkU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21Xcml0ZVJlc3VsdCA9IGZ1bmN0aW9uIChwcm90bywgY29tbWl0VGltZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gTk9URTogRGVsZXRlcyBkb24ndCBoYXZlIGFuIHVwZGF0ZVRpbWUuXHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSBwcm90by51cGRhdGVUaW1lXHJcbiAgICAgICAgICAgID8gdGhpcy5mcm9tVmVyc2lvbihwcm90by51cGRhdGVUaW1lKVxyXG4gICAgICAgICAgICA6IHRoaXMuZnJvbVZlcnNpb24oY29tbWl0VGltZSk7XHJcbiAgICAgICAgdmFyIHRyYW5zZm9ybVJlc3VsdHMgPSBudWxsO1xyXG4gICAgICAgIGlmIChwcm90by50cmFuc2Zvcm1SZXN1bHRzICYmIHByb3RvLnRyYW5zZm9ybVJlc3VsdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm1SZXN1bHRzID0gcHJvdG8udHJhbnNmb3JtUmVzdWx0cy5tYXAoZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmZyb21WYWx1ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNdXRhdGlvblJlc3VsdCh2ZXJzaW9uLCB0cmFuc2Zvcm1SZXN1bHRzKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tV3JpdGVSZXN1bHRzID0gZnVuY3Rpb24gKHByb3RvcywgY29tbWl0VGltZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHByb3RvcyAmJiBwcm90b3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBhc3NlcnQoY29tbWl0VGltZSAhPT0gdW5kZWZpbmVkLCAnUmVjZWl2ZWQgYSB3cml0ZSByZXN1bHQgd2l0aG91dCBhIGNvbW1pdCB0aW1lJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBwcm90b3MubWFwKGZ1bmN0aW9uIChwcm90bykgeyByZXR1cm4gX3RoaXMuZnJvbVdyaXRlUmVzdWx0KHByb3RvLCBjb21taXRUaW1lKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvRmllbGRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoZmllbGRUcmFuc2Zvcm0pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciB0cmFuc2Zvcm0gPSBmaWVsZFRyYW5zZm9ybS50cmFuc2Zvcm07XHJcbiAgICAgICAgaWYgKHRyYW5zZm9ybSBpbnN0YW5jZW9mIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZmllbGRQYXRoOiBmaWVsZFRyYW5zZm9ybS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHNldFRvU2VydmVyVmFsdWU6ICdSRVFVRVNUX1RJTUUnXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRyYW5zZm9ybSBpbnN0YW5jZW9mIEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGZpZWxkUGF0aDogZmllbGRUcmFuc2Zvcm0uZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBhcHBlbmRNaXNzaW5nRWxlbWVudHM6IHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IHRyYW5zZm9ybS5lbGVtZW50cy5tYXAoZnVuY3Rpb24gKHYpIHsgcmV0dXJuIF90aGlzLnRvVmFsdWUodik7IH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRyYW5zZm9ybSBpbnN0YW5jZW9mIEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZFBhdGg6IGZpZWxkVHJhbnNmb3JtLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcmVtb3ZlQWxsRnJvbUFycmF5OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiB0cmFuc2Zvcm0uZWxlbWVudHMubWFwKGZ1bmN0aW9uICh2KSB7IHJldHVybiBfdGhpcy50b1ZhbHVlKHYpOyB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgZmFpbCgnVW5rbm93biB0cmFuc2Zvcm06ICcgKyBmaWVsZFRyYW5zZm9ybS50cmFuc2Zvcm0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRmllbGRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAocHJvdG8pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgV2UgbmVlZCB0byBtYXRjaCBnZW5lcmF0ZWQgUHJvdG8gdHlwZXMuXHJcbiAgICAgICAgdmFyIHR5cGUgPSBwcm90b1sndHJhbnNmb3JtX3R5cGUnXTtcclxuICAgICAgICB2YXIgdHJhbnNmb3JtID0gbnVsbDtcclxuICAgICAgICBpZiAoaGFzVGFnKHByb3RvLCB0eXBlLCAnc2V0VG9TZXJ2ZXJWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChwcm90by5zZXRUb1NlcnZlclZhbHVlID09PSAnUkVRVUVTVF9USU1FJywgJ1Vua25vd24gc2VydmVyIHZhbHVlIHRyYW5zZm9ybSBwcm90bzogJyArIEpTT04uc3RyaW5naWZ5KHByb3RvKSk7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybSA9IFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybS5pbnN0YW5jZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKHByb3RvLCB0eXBlLCAnYXBwZW5kTWlzc2luZ0VsZW1lbnRzJykpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlcyQkMSA9IHByb3RvLmFwcGVuZE1pc3NpbmdFbGVtZW50cy52YWx1ZXMgfHwgW107XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybSA9IG5ldyBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uKHZhbHVlcyQkMS5tYXAoZnVuY3Rpb24gKHYpIHsgcmV0dXJuIF90aGlzLmZyb21WYWx1ZSh2KTsgfSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcocHJvdG8sIHR5cGUsICdyZW1vdmVBbGxGcm9tQXJyYXknKSkge1xyXG4gICAgICAgICAgICB2YXIgdmFsdWVzJCQxID0gcHJvdG8ucmVtb3ZlQWxsRnJvbUFycmF5LnZhbHVlcyB8fCBbXTtcclxuICAgICAgICAgICAgdHJhbnNmb3JtID0gbmV3IEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uKHZhbHVlcyQkMS5tYXAoZnVuY3Rpb24gKHYpIHsgcmV0dXJuIF90aGlzLmZyb21WYWx1ZSh2KTsgfSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZmFpbCgnVW5rbm93biB0cmFuc2Zvcm0gcHJvdG86ICcgKyBKU09OLnN0cmluZ2lmeShwcm90bykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZmllbGRQYXRoID0gRmllbGRQYXRoLmZyb21TZXJ2ZXJGb3JtYXQocHJvdG8uZmllbGRQYXRoKTtcclxuICAgICAgICByZXR1cm4gbmV3IEZpZWxkVHJhbnNmb3JtKGZpZWxkUGF0aCwgdHJhbnNmb3JtKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0RvY3VtZW50c1RhcmdldCA9IGZ1bmN0aW9uIChxdWVyeSkge1xyXG4gICAgICAgIHJldHVybiB7IGRvY3VtZW50czogW3RoaXMudG9RdWVyeVBhdGgocXVlcnkucGF0aCldIH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbURvY3VtZW50c1RhcmdldCA9IGZ1bmN0aW9uIChkb2N1bWVudHNUYXJnZXQpIHtcclxuICAgICAgICB2YXIgY291bnQgPSBkb2N1bWVudHNUYXJnZXQuZG9jdW1lbnRzLmxlbmd0aDtcclxuICAgICAgICBhc3NlcnQoY291bnQgPT09IDEsICdEb2N1bWVudHNUYXJnZXQgY29udGFpbmVkIG90aGVyIHRoYW4gMSBkb2N1bWVudDogJyArIGNvdW50KTtcclxuICAgICAgICB2YXIgbmFtZSA9IGRvY3VtZW50c1RhcmdldC5kb2N1bWVudHNbMF07XHJcbiAgICAgICAgcmV0dXJuIFF1ZXJ5LmF0UGF0aCh0aGlzLmZyb21RdWVyeVBhdGgobmFtZSkpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICAvLyBEaXNzZWN0IHRoZSBwYXRoIGludG8gcGFyZW50LCBjb2xsZWN0aW9uSWQsIGFuZCBvcHRpb25hbCBrZXkgZmlsdGVyLlxyXG4gICAgICAgIHZhciByZXN1bHQgPSB7IHN0cnVjdHVyZWRRdWVyeToge30gfTtcclxuICAgICAgICBpZiAocXVlcnkucGF0aC5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgcmVzdWx0LnBhcmVudCA9IHRoaXMudG9RdWVyeVBhdGgoUmVzb3VyY2VQYXRoLkVNUFRZX1BBVEgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBxdWVyeS5wYXRoO1xyXG4gICAgICAgICAgICBhc3NlcnQocGF0aC5sZW5ndGggJSAyICE9PSAwLCAnRG9jdW1lbnQgcXVlcmllcyB3aXRoIGZpbHRlcnMgYXJlIG5vdCBzdXBwb3J0ZWQuJyk7XHJcbiAgICAgICAgICAgIHJlc3VsdC5wYXJlbnQgPSB0aGlzLnRvUXVlcnlQYXRoKHBhdGgucG9wTGFzdCgpKTtcclxuICAgICAgICAgICAgcmVzdWx0LnN0cnVjdHVyZWRRdWVyeS5mcm9tID0gW3sgY29sbGVjdGlvbklkOiBwYXRoLmxhc3RTZWdtZW50KCkgfV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB3aGVyZSA9IHRoaXMudG9GaWx0ZXIocXVlcnkuZmlsdGVycyk7XHJcbiAgICAgICAgaWYgKHdoZXJlKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5zdHJ1Y3R1cmVkUXVlcnkud2hlcmUgPSB3aGVyZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG9yZGVyQnkgPSB0aGlzLnRvT3JkZXIocXVlcnkub3JkZXJCeSk7XHJcbiAgICAgICAgaWYgKG9yZGVyQnkpIHtcclxuICAgICAgICAgICAgcmVzdWx0LnN0cnVjdHVyZWRRdWVyeS5vcmRlckJ5ID0gb3JkZXJCeTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGxpbWl0ID0gdGhpcy50b0ludDMyVmFsdWUocXVlcnkubGltaXQpO1xyXG4gICAgICAgIGlmIChsaW1pdCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5zdHJ1Y3R1cmVkUXVlcnkubGltaXQgPSBsaW1pdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHF1ZXJ5LnN0YXJ0QXQpIHtcclxuICAgICAgICAgICAgcmVzdWx0LnN0cnVjdHVyZWRRdWVyeS5zdGFydEF0ID0gdGhpcy50b0N1cnNvcihxdWVyeS5zdGFydEF0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHF1ZXJ5LmVuZEF0KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5zdHJ1Y3R1cmVkUXVlcnkuZW5kQXQgPSB0aGlzLnRvQ3Vyc29yKHF1ZXJ5LmVuZEF0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSB0aGlzLmZyb21RdWVyeVBhdGgodGFyZ2V0LnBhcmVudCk7XHJcbiAgICAgICAgdmFyIHF1ZXJ5ID0gdGFyZ2V0LnN0cnVjdHVyZWRRdWVyeTtcclxuICAgICAgICB2YXIgZnJvbUNvdW50ID0gcXVlcnkuZnJvbSA/IHF1ZXJ5LmZyb20ubGVuZ3RoIDogMDtcclxuICAgICAgICBpZiAoZnJvbUNvdW50ID4gMCkge1xyXG4gICAgICAgICAgICBhc3NlcnQoZnJvbUNvdW50ID09PSAxLCAnU3RydWN0dXJlZFF1ZXJ5LmZyb20gd2l0aCBtb3JlIHRoYW4gb25lIGNvbGxlY3Rpb24gaXMgbm90IHN1cHBvcnRlZC4nKTtcclxuICAgICAgICAgICAgdmFyIGZyb20gPSBxdWVyeS5mcm9tWzBdO1xyXG4gICAgICAgICAgICBwYXRoID0gcGF0aC5jaGlsZChmcm9tLmNvbGxlY3Rpb25JZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBmaWx0ZXJCeSA9IFtdO1xyXG4gICAgICAgIGlmIChxdWVyeS53aGVyZSkge1xyXG4gICAgICAgICAgICBmaWx0ZXJCeSA9IHRoaXMuZnJvbUZpbHRlcihxdWVyeS53aGVyZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBvcmRlckJ5ID0gW107XHJcbiAgICAgICAgaWYgKHF1ZXJ5Lm9yZGVyQnkpIHtcclxuICAgICAgICAgICAgb3JkZXJCeSA9IHRoaXMuZnJvbU9yZGVyKHF1ZXJ5Lm9yZGVyQnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbGltaXQgPSBudWxsO1xyXG4gICAgICAgIGlmIChxdWVyeS5saW1pdCkge1xyXG4gICAgICAgICAgICBsaW1pdCA9IHRoaXMuZnJvbUludDMyVmFsdWUocXVlcnkubGltaXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc3RhcnRBdCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHF1ZXJ5LnN0YXJ0QXQpIHtcclxuICAgICAgICAgICAgc3RhcnRBdCA9IHRoaXMuZnJvbUN1cnNvcihxdWVyeS5zdGFydEF0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGVuZEF0ID0gbnVsbDtcclxuICAgICAgICBpZiAocXVlcnkuZW5kQXQpIHtcclxuICAgICAgICAgICAgZW5kQXQgPSB0aGlzLmZyb21DdXJzb3IocXVlcnkuZW5kQXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHBhdGgsIG9yZGVyQnksIGZpbHRlckJ5LCBsaW1pdCwgc3RhcnRBdCwgZW5kQXQpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvTGlzdGVuUmVxdWVzdExhYmVscyA9IGZ1bmN0aW9uIChxdWVyeURhdGEpIHtcclxuICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLnRvTGFiZWwocXVlcnlEYXRhLnB1cnBvc2UpO1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICdnb29nLWxpc3Rlbi10YWdzJzogdmFsdWVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9MYWJlbCA9IGZ1bmN0aW9uIChwdXJwb3NlKSB7XHJcbiAgICAgICAgc3dpdGNoIChwdXJwb3NlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgUXVlcnlQdXJwb3NlLkxpc3RlbjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICBjYXNlIFF1ZXJ5UHVycG9zZS5FeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnZXhpc3RlbmNlLWZpbHRlci1taXNtYXRjaCc7XHJcbiAgICAgICAgICAgIGNhc2UgUXVlcnlQdXJwb3NlLkxpbWJvUmVzb2x1dGlvbjpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnbGltYm8tZG9jdW1lbnQnO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1VucmVjb2duaXplZCBxdWVyeSBwdXJwb3NlOiAnICsgcHVycG9zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvVGFyZ2V0ID0gZnVuY3Rpb24gKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHZhciByZXN1bHQ7XHJcbiAgICAgICAgdmFyIHF1ZXJ5ID0gcXVlcnlEYXRhLnF1ZXJ5O1xyXG4gICAgICAgIGlmIChxdWVyeS5pc0RvY3VtZW50UXVlcnkoKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7IGRvY3VtZW50czogdGhpcy50b0RvY3VtZW50c1RhcmdldChxdWVyeSkgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHsgcXVlcnk6IHRoaXMudG9RdWVyeVRhcmdldChxdWVyeSkgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVzdWx0LnRhcmdldElkID0gcXVlcnlEYXRhLnRhcmdldElkO1xyXG4gICAgICAgIGlmIChxdWVyeURhdGEucmVzdW1lVG9rZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICByZXN1bHQucmVzdW1lVG9rZW4gPSB0aGlzLnVuc2FmZUNhc3RQcm90b0J5dGVTdHJpbmcocXVlcnlEYXRhLnJlc3VtZVRva2VuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0ZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXJzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoZmlsdGVycy5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB2YXIgcHJvdG9zID0gZmlsdGVycy5tYXAoZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyIGluc3RhbmNlb2YgUmVsYXRpb25GaWx0ZXJcclxuICAgICAgICAgICAgICAgID8gX3RoaXMudG9SZWxhdGlvbkZpbHRlcihmaWx0ZXIpXHJcbiAgICAgICAgICAgICAgICA6IF90aGlzLnRvVW5hcnlGaWx0ZXIoZmlsdGVyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAocHJvdG9zLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvdG9zWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyBjb21wb3NpdGVGaWx0ZXI6IHsgb3A6ICdBTkQnLCBmaWx0ZXJzOiBwcm90b3MgfSB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21GaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoIWZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGZpbHRlci51bmFyeUZpbHRlciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbdGhpcy5mcm9tVW5hcnlGaWx0ZXIoZmlsdGVyKV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGZpbHRlci5maWVsZEZpbHRlciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbdGhpcy5mcm9tUmVsYXRpb25GaWx0ZXIoZmlsdGVyKV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGZpbHRlci5jb21wb3NpdGVGaWx0ZXIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyLmNvbXBvc2l0ZUZpbHRlclxyXG4gICAgICAgICAgICAgICAgLmZpbHRlcnMubWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBfdGhpcy5mcm9tRmlsdGVyKGYpOyB9KVxyXG4gICAgICAgICAgICAgICAgLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGN1cnJlbnQpIHsgcmV0dXJuIGFjY3VtLmNvbmNhdChjdXJyZW50KTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBmaWx0ZXI6ICcgKyBKU09OLnN0cmluZ2lmeShmaWx0ZXIpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9PcmRlciA9IGZ1bmN0aW9uIChvcmRlckJ5cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKG9yZGVyQnlzLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHJldHVybiBvcmRlckJ5cy5tYXAoZnVuY3Rpb24gKG9yZGVyKSB7IHJldHVybiBfdGhpcy50b1Byb3BlcnR5T3JkZXIob3JkZXIpOyB9KTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tT3JkZXIgPSBmdW5jdGlvbiAob3JkZXJCeXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBvcmRlckJ5cy5tYXAoZnVuY3Rpb24gKG9yZGVyKSB7IHJldHVybiBfdGhpcy5mcm9tUHJvcGVydHlPcmRlcihvcmRlcik7IH0pO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvQ3Vyc29yID0gZnVuY3Rpb24gKGN1cnNvcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgYmVmb3JlOiBjdXJzb3IuYmVmb3JlLFxyXG4gICAgICAgICAgICB2YWx1ZXM6IGN1cnNvci5wb3NpdGlvbi5tYXAoZnVuY3Rpb24gKGNvbXBvbmVudCkgeyByZXR1cm4gX3RoaXMudG9WYWx1ZShjb21wb25lbnQpOyB9KVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbUN1cnNvciA9IGZ1bmN0aW9uIChjdXJzb3IpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBiZWZvcmUgPSAhIWN1cnNvci5iZWZvcmU7XHJcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gY3Vyc29yLnZhbHVlcy5tYXAoZnVuY3Rpb24gKGNvbXBvbmVudCkgeyByZXR1cm4gX3RoaXMuZnJvbVZhbHVlKGNvbXBvbmVudCk7IH0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgQm91bmQocG9zaXRpb24sIGJlZm9yZSk7XHJcbiAgICB9O1xyXG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9EaXJlY3Rpb24gPSBmdW5jdGlvbiAoZGlyKSB7XHJcbiAgICAgICAgcmV0dXJuIERJUkVDVElPTlNbZGlyLm5hbWVdO1xyXG4gICAgfTtcclxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21EaXJlY3Rpb24gPSBmdW5jdGlvbiAoZGlyKSB7XHJcbiAgICAgICAgc3dpdGNoIChkaXIpIHtcclxuICAgICAgICAgICAgY2FzZSAnQVNDRU5ESU5HJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBEaXJlY3Rpb24uQVNDRU5ESU5HO1xyXG4gICAgICAgICAgICBjYXNlICdERVNDRU5ESU5HJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBEaXJlY3Rpb24uREVTQ0VORElORztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvT3BlcmF0b3JOYW1lID0gZnVuY3Rpb24gKG9wKSB7XHJcbiAgICAgICAgcmV0dXJuIE9QRVJBVE9SU1tvcC5uYW1lXTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tT3BlcmF0b3JOYW1lID0gZnVuY3Rpb24gKG9wKSB7XHJcbiAgICAgICAgc3dpdGNoIChvcCkge1xyXG4gICAgICAgICAgICBjYXNlICdFUVVBTCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5FUVVBTDtcclxuICAgICAgICAgICAgY2FzZSAnR1JFQVRFUl9USEFOJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkdSRUFURVJfVEhBTjtcclxuICAgICAgICAgICAgY2FzZSAnR1JFQVRFUl9USEFOX09SX0VRVUFMJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkdSRUFURVJfVEhBTl9PUl9FUVVBTDtcclxuICAgICAgICAgICAgY2FzZSAnTEVTU19USEFOJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkxFU1NfVEhBTjtcclxuICAgICAgICAgICAgY2FzZSAnTEVTU19USEFOX09SX0VRVUFMJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkxFU1NfVEhBTl9PUl9FUVVBTDtcclxuICAgICAgICAgICAgY2FzZSAnQVJSQVlfQ09OVEFJTlMnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlM7XHJcbiAgICAgICAgICAgIGNhc2UgJ09QRVJBVE9SX1VOU1BFQ0lGSUVEJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbnNwZWNpZmllZCByZWxhdGlvbicpO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gcmVsYXRpb24nKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9GaWVsZFBhdGhSZWZlcmVuY2UgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIHJldHVybiB7IGZpZWxkUGF0aDogcGF0aC5jYW5vbmljYWxTdHJpbmcoKSB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21GaWVsZFBhdGhSZWZlcmVuY2UgPSBmdW5jdGlvbiAoZmllbGRSZWZlcmVuY2UpIHtcclxuICAgICAgICByZXR1cm4gRmllbGRQYXRoLmZyb21TZXJ2ZXJGb3JtYXQoZmllbGRSZWZlcmVuY2UuZmllbGRQYXRoKTtcclxuICAgIH07XHJcbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1Byb3BlcnR5T3JkZXIgPSBmdW5jdGlvbiAob3JkZXJCeSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGZpZWxkOiB0aGlzLnRvRmllbGRQYXRoUmVmZXJlbmNlKG9yZGVyQnkuZmllbGQpLFxyXG4gICAgICAgICAgICBkaXJlY3Rpb246IHRoaXMudG9EaXJlY3Rpb24ob3JkZXJCeS5kaXIpXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tUHJvcGVydHlPcmRlciA9IGZ1bmN0aW9uIChvcmRlckJ5KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBPcmRlckJ5KHRoaXMuZnJvbUZpZWxkUGF0aFJlZmVyZW5jZShvcmRlckJ5LmZpZWxkKSwgdGhpcy5mcm9tRGlyZWN0aW9uKG9yZGVyQnkuZGlyZWN0aW9uKSk7XHJcbiAgICB9O1xyXG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9SZWxhdGlvbkZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICBpZiAoZmlsdGVyIGluc3RhbmNlb2YgUmVsYXRpb25GaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGZpZWxkRmlsdGVyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IHRoaXMudG9GaWVsZFBhdGhSZWZlcmVuY2UoZmlsdGVyLmZpZWxkKSxcclxuICAgICAgICAgICAgICAgICAgICBvcDogdGhpcy50b09wZXJhdG9yTmFtZShmaWx0ZXIub3ApLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnRvVmFsdWUoZmlsdGVyLnZhbHVlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1VucmVjb2duaXplZCBmaWx0ZXI6ICcgKyBKU09OLnN0cmluZ2lmeShmaWx0ZXIpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVJlbGF0aW9uRmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgUmVsYXRpb25GaWx0ZXIodGhpcy5mcm9tRmllbGRQYXRoUmVmZXJlbmNlKGZpbHRlci5maWVsZEZpbHRlci5maWVsZCksIHRoaXMuZnJvbU9wZXJhdG9yTmFtZShmaWx0ZXIuZmllbGRGaWx0ZXIub3ApLCB0aGlzLmZyb21WYWx1ZShmaWx0ZXIuZmllbGRGaWx0ZXIudmFsdWUpKTtcclxuICAgIH07XHJcbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1VuYXJ5RmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgIGlmIChmaWx0ZXIgaW5zdGFuY2VvZiBOYW5GaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IHRoaXMudG9GaWVsZFBhdGhSZWZlcmVuY2UoZmlsdGVyLmZpZWxkKSxcclxuICAgICAgICAgICAgICAgICAgICBvcDogJ0lTX05BTidcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZmlsdGVyIGluc3RhbmNlb2YgTnVsbEZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZDogdGhpcy50b0ZpZWxkUGF0aFJlZmVyZW5jZShmaWx0ZXIuZmllbGQpLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wOiAnSVNfTlVMTCdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbnJlY29nbml6ZWQgZmlsdGVyOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21VbmFyeUZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICBzd2l0Y2ggKGZpbHRlci51bmFyeUZpbHRlci5vcCkge1xyXG4gICAgICAgICAgICBjYXNlICdJU19OQU4nOlxyXG4gICAgICAgICAgICAgICAgdmFyIG5hbkZpZWxkID0gdGhpcy5mcm9tRmllbGRQYXRoUmVmZXJlbmNlKGZpbHRlci51bmFyeUZpbHRlci5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE5hbkZpbHRlcihuYW5GaWVsZCk7XHJcbiAgICAgICAgICAgIGNhc2UgJ0lTX05VTEwnOlxyXG4gICAgICAgICAgICAgICAgdmFyIG51bGxGaWVsZCA9IHRoaXMuZnJvbUZpZWxkUGF0aFJlZmVyZW5jZShmaWx0ZXIudW5hcnlGaWx0ZXIuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBOdWxsRmlsdGVyKG51bGxGaWVsZCk7XHJcbiAgICAgICAgICAgIGNhc2UgJ09QRVJBVE9SX1VOU1BFQ0lGSUVEJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbnNwZWNpZmllZCBmaWx0ZXInKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIGZpbHRlcicpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0RvY3VtZW50TWFzayA9IGZ1bmN0aW9uIChmaWVsZE1hc2spIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBmaWVsZFBhdGhzOiBmaWVsZE1hc2suZmllbGRzLm1hcChmdW5jdGlvbiAoZmllbGQpIHsgcmV0dXJuIGZpZWxkLmNhbm9uaWNhbFN0cmluZygpOyB9KVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbURvY3VtZW50TWFzayA9IGZ1bmN0aW9uIChwcm90bykge1xyXG4gICAgICAgIHZhciBwYXRocyA9IHByb3RvLmZpZWxkUGF0aHMgfHwgW107XHJcbiAgICAgICAgdmFyIGZpZWxkcyA9IHBhdGhzLm1hcChmdW5jdGlvbiAocGF0aCkgeyByZXR1cm4gRmllbGRQYXRoLmZyb21TZXJ2ZXJGb3JtYXQocGF0aCk7IH0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgRmllbGRNYXNrKGZpZWxkcyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEpzb25Qcm90b1NlcmlhbGl6ZXI7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBDaGVja3MgZm9yIGEgc3BlY2lmaWMgb25lb2YgdGFnIGluIGEgcHJvdG9jb2wgYnVmZmVyIG1lc3NhZ2UuXHJcbiAqXHJcbiAqIFRoaXMgaW50ZW50aW9uYWxseSBhY2NvbW1vZGF0ZXMgdHdvIGRpc3RpbmN0IGNhc2VzOlxyXG4gKlxyXG4gKiAxKSBNZXNzYWdlcyBjb250YWluaW5nIGEgdHlwZSB0YWc6IHRoZXNlIGFyZSB0aGUgZm9ybWF0IHByb2R1Y2VkIGJ5IEdSUEMgaW5cclxuICogcmV0dXJuIHZhbHVlcy4gVGhlc2UgbWF5IGNvbnRhaW4gZGVmYXVsdC12YWx1ZSBtYXBwaW5ncyBmb3IgYWxsIHRhZ3MgaW4gdGhlXHJcbiAqIG9uZW9mIGJ1dCB0aGUgdHlwZSB0YWcgc3BlY2lmaWVzIHdoaWNoIG9uZSB3YXMgYWN0dWFsbHkgc2V0LlxyXG4gKlxyXG4gKiAyKSBNZXNzYWdlcyB0aGF0IGRvbid0IGNvbnRhaW4gYSB0eXBlIHRhZzogdGhlc2UgYXJlIHRoZSBmb3JtYXQgcmVxdWlyZWQgYnlcclxuICogR1JQQyBhcyBpbnB1dHMuIElmIHdlIGVtaXR0ZWQgb2JqZWN0cyB3aXRoIHR5cGUgdGFncywgUHJvdG9CdWYuanMgd291bGRcclxuICogY2hva2UgY2xhaW1pbmcgdGhhdCB0aGUgdGFncyBhcmVuJ3QgZmllbGRzIGluIHRoZSBNZXNzYWdlLlxyXG4gKlxyXG4gKiBBbGxvd2luZyBib3RoIGZvcm1hdHMgaGVyZSBtYWtlcyB0aGUgc2VyaWFsaXplciBhYmxlIHRvIGNvbnN1bWUgdGhlIG91dHB1dHNcclxuICogaXQgcHJvZHVjZXM6IGZvciBhbGwgbWVzc2FnZXMgaXQgc3VwcG9ydHMsIGZyb21YKHRvWCh2YWx1ZSkpID09IHZhbHVlLlxyXG4gKlxyXG4gKiBOb3RlIHRoYXQgY2FzZSAyIHN1ZmZlcnMgZnJvbSBhbWJpZ3VpdHk6IGlmIG11bHRpcGxlIHRhZ3MgYXJlIHByZXNlbnRcclxuICogd2l0aG91dCBhIHR5cGUgdGFnIHRoZW4gdGhlIGNhbGxlcnMgYXJlIHN0cnVjdHVyZWQgaW4gc3VjaCBhIHdheSB0aGF0IHRoZVxyXG4gKiBmaXJzdCBpbnZvY2F0aW9uIHdpbGwgd2luLiBTaW5jZSB3ZSBvbmx5IHBhcnNlIGluIHRoaXMgbW9kZSB3aGVuIHBhcnNpbmdcclxuICogdGhlIG91dHB1dCBvZiBhIHNlcmlhbGl6ZSBtZXRob2QgdGhpcyB3b3JrcywgYnV0IGl0J3Mgbm90IGEgZ2VuZXJhbFxyXG4gKiBzb2x1dGlvbi5cclxuICpcclxuICogVW5mb3J0dW5hdGVseSB0aGVyZSBpcyBubyBnZW5lcmFsIHNvbHV0aW9uIGhlcmUgYmVjYXVzZSBwcm90bzMgbWFrZXMgaXRcclxuICogaW1wb3NzaWJsZSB0byBkaXN0aW5ndWlzaCB1bnNldCBmcm9tIGV4cGxpY2l0bHkgc2V0IGZpZWxkczogYm90aCBoYXZlIHRoZVxyXG4gKiBkZWZhdWx0IHZhbHVlIGZvciB0aGUgdHlwZS4gV2l0aG91dCB0aGUgdHlwZSB0YWcgYnV0IG11bHRpcGxlIHZhbHVlIHRhZ3NcclxuICogaXQncyBwb3NzaWJsZSB0byBoYXZlIGRlZmF1bHQgdmFsdWVzIGZvciBlYWNoIHRhZyBpbiB0aGUgb25lb2YgYW5kIG5vdCBiZVxyXG4gKiBhYmxlIHRvIGtub3cgd2hpY2ggd2FzIGFjdHVhbGx5IGluIGVmZmVjdC5cclxuICovXHJcbmZ1bmN0aW9uIGhhc1RhZyhvYmosIHR5cGUsIHRhZykge1xyXG4gICAgcmV0dXJuIHR5cGUgPT09IHRhZyB8fCAoIXR5cGUgJiYgdGFnIGluIG9iaik7XHJcbn1cblxuLyoqXHJcbiAqIERldGVjdCBSZWFjdCBOYXRpdmUuXHJcbiAqXHJcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgUmVhY3ROYXRpdmUgZW52aXJvbm1lbnQgaXMgZGV0ZWN0ZWQuXHJcbiAqL1xyXG52YXIgaXNSZWFjdE5hdGl2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ29iamVjdCcgJiYgbmF2aWdhdG9yWydwcm9kdWN0J10gPT09ICdSZWFjdE5hdGl2ZScpO1xyXG59O1xyXG5cbnZhciBFUlJPUl9OQU1FID0gJ0ZpcmViYXNlRXJyb3InO1xyXG52YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvclxyXG4gICAgLmNhcHR1cmVTdGFja1RyYWNlO1xyXG52YXIgRmlyZWJhc2VFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpcmViYXNlRXJyb3IoY29kZSwgbWVzc2FnZSkge1xyXG4gICAgICAgIHRoaXMuY29kZSA9IGNvZGU7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcclxuICAgICAgICAvLyBXZSB3YW50IHRoZSBzdGFjayB2YWx1ZSwgaWYgaW1wbGVtZW50ZWQgYnkgRXJyb3JcclxuICAgICAgICBpZiAoY2FwdHVyZVN0YWNrVHJhY2UpIHtcclxuICAgICAgICAgICAgLy8gUGF0Y2hlcyB0aGlzLnN0YWNrLCBvbWl0dGVkIGNhbGxzIGFib3ZlIEVycm9yRmFjdG9yeSNjcmVhdGVcclxuICAgICAgICAgICAgY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgRXJyb3JGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIC8vIEluIGNhc2Ugb2YgSUUxMSwgc3RhY2sgd2lsbCBiZSBzZXQgb25seSBhZnRlciBlcnJvciBpcyByYWlzZWQuXHJcbiAgICAgICAgICAgICAgICAvLyBodHRwczovL2RvY3MubWljcm9zb2Z0LmNvbS9lbi11cy9zY3JpcHRpbmcvamF2YXNjcmlwdC9yZWZlcmVuY2Uvc3RhY2stcHJvcGVydHktZXJyb3ItamF2YXNjcmlwdFxyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSBFUlJPUl9OQU1FO1xyXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBub24tZW51bWVyYWJsZSBnZXR0ZXIgZm9yIHRoZSBwcm9wZXJ0eS5cclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnc3RhY2snLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnIuc3RhY2s7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRmlyZWJhc2VFcnJvcjtcclxufSgpKTtcclxuLy8gQmFjay1kb29yIGluaGVyaXRhbmNlXHJcbkZpcmViYXNlRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xyXG5GaXJlYmFzZUVycm9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEZpcmViYXNlRXJyb3I7XHJcbkZpcmViYXNlRXJyb3IucHJvdG90eXBlLm5hbWUgPSBFUlJPUl9OQU1FO1xyXG52YXIgRXJyb3JGYWN0b3J5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRXJyb3JGYWN0b3J5KHNlcnZpY2UsIHNlcnZpY2VOYW1lLCBlcnJvcnMpIHtcclxuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMuc2VydmljZU5hbWUgPSBzZXJ2aWNlTmFtZTtcclxuICAgICAgICB0aGlzLmVycm9ycyA9IGVycm9ycztcclxuICAgICAgICAvLyBNYXRjaGVzIHskbmFtZX0sIGJ5IGRlZmF1bHQuXHJcbiAgICAgICAgdGhpcy5wYXR0ZXJuID0gL1xce1xcJChbXn1dKyl9L2c7XHJcbiAgICAgICAgLy8gZW1wdHlcclxuICAgIH1cclxuICAgIEVycm9yRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKGNvZGUsIGRhdGEpIHtcclxuICAgICAgICBpZiAoZGF0YSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHRlbXBsYXRlID0gdGhpcy5lcnJvcnNbY29kZV07XHJcbiAgICAgICAgdmFyIGZ1bGxDb2RlID0gdGhpcy5zZXJ2aWNlICsgJy8nICsgY29kZTtcclxuICAgICAgICB2YXIgbWVzc2FnZTtcclxuICAgICAgICBpZiAodGVtcGxhdGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBtZXNzYWdlID0gJ0Vycm9yJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSB0ZW1wbGF0ZS5yZXBsYWNlKHRoaXMucGF0dGVybiwgZnVuY3Rpb24gKG1hdGNoLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRhdGFba2V5XTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUudG9TdHJpbmcoKSA6ICc8JyArIGtleSArICc/Pic7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTZXJ2aWNlOiBFcnJvciBtZXNzYWdlIChzZXJ2aWNlL2NvZGUpLlxyXG4gICAgICAgIG1lc3NhZ2UgPSB0aGlzLnNlcnZpY2VOYW1lICsgJzogJyArIG1lc3NhZ2UgKyAnICgnICsgZnVsbENvZGUgKyAnKS4nO1xyXG4gICAgICAgIHZhciBlcnIgPSBuZXcgRmlyZWJhc2VFcnJvcihmdWxsQ29kZSwgbWVzc2FnZSk7XHJcbiAgICAgICAgLy8gUG9wdWxhdGUgdGhlIEVycm9yIG9iamVjdCB3aXRoIG1lc3NhZ2UgcGFydHMgZm9yIHByb2dyYW1tYXRpY1xyXG4gICAgICAgIC8vIGFjY2Vzc2VzIChlLmcuLCBlLmZpbGUpLlxyXG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoIWRhdGEuaGFzT3duUHJvcGVydHkocHJvcCkgfHwgcHJvcC5zbGljZSgtMSkgPT09ICdfJykge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZXJyW3Byb3BdID0gZGF0YVtwcm9wXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGVycjtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRXJyb3JGYWN0b3J5O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gQ29weXJpZ2h0IDIwMTEgVGhlIENsb3N1cmUgTGlicmFyeSBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4vL1xyXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4vL1xyXG4vLyAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4vL1xyXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcclxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbi8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbi8qKlxyXG4gKiBAZmlsZW92ZXJ2aWV3IEFic3RyYWN0IGNyeXB0b2dyYXBoaWMgaGFzaCBpbnRlcmZhY2UuXHJcbiAqXHJcbiAqIFNlZSBTaGExIGFuZCBNZDUgZm9yIHNhbXBsZSBpbXBsZW1lbnRhdGlvbnMuXHJcbiAqXHJcbiAqL1xyXG4vKipcclxuICogQ3JlYXRlIGEgY3J5cHRvZ3JhcGhpYyBoYXNoIGluc3RhbmNlLlxyXG4gKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQHN0cnVjdFxyXG4gKi9cclxudmFyIEhhc2ggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBIYXNoKCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBibG9jayBzaXplIGZvciB0aGUgaGFzaGVyLlxyXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5ibG9ja1NpemUgPSAtMTtcclxuICAgIH1cclxuICAgIHJldHVybiBIYXNoO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgU0hBLTEgY3J5cHRvZ3JhcGhpYyBoYXNoLlxyXG4gKiBWYXJpYWJsZSBuYW1lcyBmb2xsb3cgdGhlIG5vdGF0aW9uIGluIEZJUFMgUFVCIDE4MC0zOlxyXG4gKiBodHRwOi8vY3NyYy5uaXN0Lmdvdi9wdWJsaWNhdGlvbnMvZmlwcy9maXBzMTgwLTMvZmlwczE4MC0zX2ZpbmFsLnBkZi5cclxuICpcclxuICogVXNhZ2U6XHJcbiAqICAgdmFyIHNoYTEgPSBuZXcgc2hhMSgpO1xyXG4gKiAgIHNoYTEudXBkYXRlKGJ5dGVzKTtcclxuICogICB2YXIgaGFzaCA9IHNoYTEuZGlnZXN0KCk7XHJcbiAqXHJcbiAqIFBlcmZvcm1hbmNlOlxyXG4gKiAgIENocm9tZSAyMzogICB+NDAwIE1iaXQvc1xyXG4gKiAgIEZpcmVmb3ggMTY6ICB+MjUwIE1iaXQvc1xyXG4gKlxyXG4gKi9cclxuLyoqXHJcbiAqIFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaCBjb25zdHJ1Y3Rvci5cclxuICpcclxuICogVGhlIHByb3BlcnRpZXMgZGVjbGFyZWQgaGVyZSBhcmUgZGlzY3Vzc2VkIGluIHRoZSBhYm92ZSBhbGdvcml0aG0gZG9jdW1lbnQuXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyB7SGFzaH1cclxuICogQGZpbmFsXHJcbiAqIEBzdHJ1Y3RcclxuICovXHJcbnZhciBTaGExID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU2hhMSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFNoYTEoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBIb2xkcyB0aGUgcHJldmlvdXMgdmFsdWVzIG9mIGFjY3VtdWxhdGVkIHZhcmlhYmxlcyBhLWUgaW4gdGhlIGNvbXByZXNzX1xyXG4gICAgICAgICAqIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLmNoYWluXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgYnVmZmVyIGhvbGRpbmcgdGhlIHBhcnRpYWxseSBjb21wdXRlZCBoYXNoIHJlc3VsdC5cclxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5idWZfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQW4gYXJyYXkgb2YgODAgYnl0ZXMsIGVhY2ggYSBwYXJ0IG9mIHRoZSBtZXNzYWdlIHRvIGJlIGhhc2hlZC4gIFJlZmVycmVkIHRvXHJcbiAgICAgICAgICogYXMgdGhlIG1lc3NhZ2Ugc2NoZWR1bGUgaW4gdGhlIGRvY3MuXHJcbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMuV18gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb250YWlucyBkYXRhIG5lZWRlZCB0byBwYWQgbWVzc2FnZXMgbGVzcyB0aGFuIDY0IGJ5dGVzLlxyXG4gICAgICAgICAqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLnBhZF8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy50b3RhbF8gPSAwO1xyXG4gICAgICAgIF90aGlzLmJsb2NrU2l6ZSA9IDUxMiAvIDg7XHJcbiAgICAgICAgX3RoaXMucGFkX1swXSA9IDEyODtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IF90aGlzLmJsb2NrU2l6ZTsgKytpKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnBhZF9baV0gPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFNoYTEucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzBdID0gMHg2NzQ1MjMwMTtcclxuICAgICAgICB0aGlzLmNoYWluX1sxXSA9IDB4ZWZjZGFiODk7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMl0gPSAweDk4YmFkY2ZlO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzNdID0gMHgxMDMyNTQ3NjtcclxuICAgICAgICB0aGlzLmNoYWluX1s0XSA9IDB4YzNkMmUxZjA7XHJcbiAgICAgICAgdGhpcy5pbmJ1Zl8gPSAwO1xyXG4gICAgICAgIHRoaXMudG90YWxfID0gMDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEludGVybmFsIGNvbXByZXNzIGhlbHBlciBmdW5jdGlvbi5cclxuICAgICAqIEBwYXJhbSB7IUFycmF5PG51bWJlcj58IVVpbnQ4QXJyYXl8c3RyaW5nfSBidWYgQmxvY2sgdG8gY29tcHJlc3MuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcj19IG9wdF9vZmZzZXQgT2Zmc2V0IG9mIHRoZSBibG9jayBpbiB0aGUgYnVmZmVyLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgU2hhMS5wcm90b3R5cGUuY29tcHJlc3NfID0gZnVuY3Rpb24gKGJ1Ziwgb3B0X29mZnNldCkge1xyXG4gICAgICAgIGlmICghb3B0X29mZnNldCkge1xyXG4gICAgICAgICAgICBvcHRfb2Zmc2V0ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIFcgPSB0aGlzLldfO1xyXG4gICAgICAgIC8vIGdldCAxNiBiaWcgZW5kaWFuIHdvcmRzXHJcbiAgICAgICAgaWYgKHR5cGVvZiBidWYgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyh1c2VyKTogW2J1ZyA4MTQwMTIyXSBSZWNlbnQgdmVyc2lvbnMgb2YgU2FmYXJpIGZvciBNYWMgT1MgYW5kIGlPU1xyXG4gICAgICAgICAgICAgICAgLy8gaGF2ZSBhIGJ1ZyB0aGF0IHR1cm5zIHRoZSBwb3N0LWluY3JlbWVudCArKyBvcGVyYXRvciBpbnRvIHByZS1pbmNyZW1lbnRcclxuICAgICAgICAgICAgICAgIC8vIGR1cmluZyBKSVQgY29tcGlsYXRpb24uICBXZSBoYXZlIGNvZGUgdGhhdCBkZXBlbmRzIGhlYXZpbHkgb24gU0hBLTEgZm9yXHJcbiAgICAgICAgICAgICAgICAvLyBjb3JyZWN0bmVzcyBhbmQgd2hpY2ggaXMgYWZmZWN0ZWQgYnkgdGhpcyBidWcsIHNvIEkndmUgcmVtb3ZlZCBhbGwgdXNlc1xyXG4gICAgICAgICAgICAgICAgLy8gb2YgcG9zdC1pbmNyZW1lbnQgKysgaW4gd2hpY2ggdGhlIHJlc3VsdCB2YWx1ZSBpcyB1c2VkLiAgV2UgY2FuIHJldmVydFxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBjaGFuZ2Ugb25jZSB0aGUgU2FmYXJpIGJ1Z1xyXG4gICAgICAgICAgICAgICAgLy8gKGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDkwMzYpIGhhcyBiZWVuIGZpeGVkIGFuZFxyXG4gICAgICAgICAgICAgICAgLy8gbW9zdCBjbGllbnRzIGhhdmUgYmVlbiB1cGRhdGVkLlxyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQpIDw8IDI0KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvcHRfb2Zmc2V0ICsgMSkgPDwgMTYpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQgKyAyKSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQgKyAzKTtcclxuICAgICAgICAgICAgICAgIG9wdF9vZmZzZXQgKz0gNDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBXW2ldID1cclxuICAgICAgICAgICAgICAgICAgICAoYnVmW29wdF9vZmZzZXRdIDw8IDI0KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb3B0X29mZnNldCArIDFdIDw8IDE2KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb3B0X29mZnNldCArIDJdIDw8IDgpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnVmW29wdF9vZmZzZXQgKyAzXTtcclxuICAgICAgICAgICAgICAgIG9wdF9vZmZzZXQgKz0gNDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBleHBhbmQgdG8gODAgd29yZHNcclxuICAgICAgICBmb3IgKHZhciBpID0gMTY7IGkgPCA4MDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gV1tpIC0gM10gXiBXW2kgLSA4XSBeIFdbaSAtIDE0XSBeIFdbaSAtIDE2XTtcclxuICAgICAgICAgICAgV1tpXSA9ICgodCA8PCAxKSB8ICh0ID4+PiAzMSkpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGEgPSB0aGlzLmNoYWluX1swXTtcclxuICAgICAgICB2YXIgYiA9IHRoaXMuY2hhaW5fWzFdO1xyXG4gICAgICAgIHZhciBjID0gdGhpcy5jaGFpbl9bMl07XHJcbiAgICAgICAgdmFyIGQgPSB0aGlzLmNoYWluX1szXTtcclxuICAgICAgICB2YXIgZSA9IHRoaXMuY2hhaW5fWzRdO1xyXG4gICAgICAgIHZhciBmLCBrO1xyXG4gICAgICAgIC8vIFRPRE8odXNlcik6IFRyeSB0byB1bnJvbGwgdGhpcyBsb29wIHRvIHNwZWVkIHVwIHRoZSBjb21wdXRhdGlvbi5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDgwOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGkgPCA0MCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPCAyMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSBkIF4gKGIgJiAoYyBeIGQpKTtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg1YTgyNzk5OTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSBiIF4gYyBeIGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4NmVkOWViYTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IChiICYgYykgfCAoZCAmIChiIHwgYykpO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDhmMWJiY2RjO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGIgXiBjIF4gZDtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHhjYTYyYzFkNjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdCA9ICgoKGEgPDwgNSkgfCAoYSA+Pj4gMjcpKSArIGYgKyBlICsgayArIFdbaV0pICYgMHhmZmZmZmZmZjtcclxuICAgICAgICAgICAgZSA9IGQ7XHJcbiAgICAgICAgICAgIGQgPSBjO1xyXG4gICAgICAgICAgICBjID0gKChiIDw8IDMwKSB8IChiID4+PiAyKSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgICAgICBiID0gYTtcclxuICAgICAgICAgICAgYSA9IHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hhaW5fWzBdID0gKHRoaXMuY2hhaW5fWzBdICsgYSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzFdID0gKHRoaXMuY2hhaW5fWzFdICsgYikgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzJdID0gKHRoaXMuY2hhaW5fWzJdICsgYykgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzNdID0gKHRoaXMuY2hhaW5fWzNdICsgZCkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzRdID0gKHRoaXMuY2hhaW5fWzRdICsgZSkgJiAweGZmZmZmZmZmO1xyXG4gICAgfTtcclxuICAgIFNoYTEucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChieXRlcywgb3B0X2xlbmd0aCkge1xyXG4gICAgICAgIC8vIFRPRE8oam9obmxlbnopOiB0aWdodGVuIHRoZSBmdW5jdGlvbiBzaWduYXR1cmUgYW5kIHJlbW92ZSB0aGlzIGNoZWNrXHJcbiAgICAgICAgaWYgKGJ5dGVzID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0X2xlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9wdF9sZW5ndGggPSBieXRlcy5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsZW5ndGhNaW51c0Jsb2NrID0gb3B0X2xlbmd0aCAtIHRoaXMuYmxvY2tTaXplO1xyXG4gICAgICAgIHZhciBuID0gMDtcclxuICAgICAgICAvLyBVc2luZyBsb2NhbCBpbnN0ZWFkIG9mIG1lbWJlciB2YXJpYWJsZXMgZ2l2ZXMgfjUlIHNwZWVkdXAgb24gRmlyZWZveCAxNi5cclxuICAgICAgICB2YXIgYnVmID0gdGhpcy5idWZfO1xyXG4gICAgICAgIHZhciBpbmJ1ZiA9IHRoaXMuaW5idWZfO1xyXG4gICAgICAgIC8vIFRoZSBvdXRlciB3aGlsZSBsb29wIHNob3VsZCBleGVjdXRlIGF0IG1vc3QgdHdpY2UuXHJcbiAgICAgICAgd2hpbGUgKG4gPCBvcHRfbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgaGF2ZSBubyBkYXRhIGluIHRoZSBibG9jayB0byB0b3AgdXAsIHdlIGNhbiBkaXJlY3RseSBwcm9jZXNzIHRoZVxyXG4gICAgICAgICAgICAvLyBpbnB1dCBidWZmZXIgKGFzc3VtaW5nIGl0IGNvbnRhaW5zIHN1ZmZpY2llbnQgZGF0YSkuIFRoaXMgZ2l2ZXMgfjI1JVxyXG4gICAgICAgICAgICAvLyBzcGVlZHVwIG9uIENocm9tZSAyMyBhbmQgfjE1JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYsIGJ1dCByZXF1aXJlcyB0aGF0XHJcbiAgICAgICAgICAgIC8vIHRoZSBkYXRhIGlzIHByb3ZpZGVkIGluIGxhcmdlIGNodW5rcyAob3IgaW4gbXVsdGlwbGVzIG9mIDY0IGJ5dGVzKS5cclxuICAgICAgICAgICAgaWYgKGluYnVmID09IDApIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDw9IGxlbmd0aE1pbnVzQmxvY2spIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhieXRlcywgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgbiArPSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGJ5dGVzID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPCBvcHRfbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzLmNoYXJDb2RlQXQobik7XHJcbiAgICAgICAgICAgICAgICAgICAgKytpbmJ1ZjtcclxuICAgICAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluYnVmID09IHRoaXMuYmxvY2tTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ1Zik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYnVmID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IG9wdF9sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBidWZbaW5idWZdID0gYnl0ZXNbbl07XHJcbiAgICAgICAgICAgICAgICAgICAgKytpbmJ1ZjtcclxuICAgICAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluYnVmID09IHRoaXMuYmxvY2tTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ1Zik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYnVmID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbmJ1Zl8gPSBpbmJ1ZjtcclxuICAgICAgICB0aGlzLnRvdGFsXyArPSBvcHRfbGVuZ3RoO1xyXG4gICAgfTtcclxuICAgIC8qKiBAb3ZlcnJpZGUgKi9cclxuICAgIFNoYTEucHJvdG90eXBlLmRpZ2VzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZGlnZXN0ID0gW107XHJcbiAgICAgICAgdmFyIHRvdGFsQml0cyA9IHRoaXMudG90YWxfICogODtcclxuICAgICAgICAvLyBBZGQgcGFkIDB4ODAgMHgwMCouXHJcbiAgICAgICAgaWYgKHRoaXMuaW5idWZfIDwgNTYpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCA1NiAtIHRoaXMuaW5idWZfKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgdGhpcy5ibG9ja1NpemUgLSAodGhpcy5pbmJ1Zl8gLSA1NikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBZGQgIyBiaXRzLlxyXG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLmJsb2NrU2l6ZSAtIDE7IGkgPj0gNTY7IGktLSkge1xyXG4gICAgICAgICAgICB0aGlzLmJ1Zl9baV0gPSB0b3RhbEJpdHMgJiAyNTU7XHJcbiAgICAgICAgICAgIHRvdGFsQml0cyAvPSAyNTY7IC8vIERvbid0IHVzZSBiaXQtc2hpZnRpbmcgaGVyZSFcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wcmVzc18odGhpcy5idWZfKTtcclxuICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDI0OyBqID49IDA7IGogLT0gOCkge1xyXG4gICAgICAgICAgICAgICAgZGlnZXN0W25dID0gKHRoaXMuY2hhaW5fW2ldID4+IGopICYgMjU1O1xyXG4gICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkaWdlc3Q7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNoYTE7XHJcbn0oSGFzaCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVzIGEgc2ltcGxlIGhlbHBlciBjbGFzcyB0aGF0IGltcGxlbWVudHMgdGhlIFN0cmVhbSBpbnRlcmZhY2UgdG9cclxuICogYnJpZGdlIHRvIG90aGVyIGltcGxlbWVudGF0aW9ucyB0aGF0IGFyZSBzdHJlYW1zIGJ1dCBkbyBub3QgaW1wbGVtZW50IHRoZVxyXG4gKiBpbnRlcmZhY2UuIFRoZSBzdHJlYW0gY2FsbGJhY2tzIGFyZSBpbnZva2VkIHdpdGggdGhlIGNhbGxPbi4uLiBtZXRob2RzLlxyXG4gKi9cclxudmFyIFN0cmVhbUJyaWRnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFN0cmVhbUJyaWRnZShhcmdzKSB7XHJcbiAgICAgICAgdGhpcy5zZW5kRm4gPSBhcmdzLnNlbmRGbjtcclxuICAgICAgICB0aGlzLmNsb3NlRm4gPSBhcmdzLmNsb3NlRm47XHJcbiAgICB9XHJcbiAgICBTdHJlYW1CcmlkZ2UucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy53cmFwcGVkT25PcGVuLCAnQ2FsbGVkIG9uT3BlbiBvbiBzdHJlYW0gdHdpY2UhJyk7XHJcbiAgICAgICAgdGhpcy53cmFwcGVkT25PcGVuID0gY2FsbGJhY2s7XHJcbiAgICB9O1xyXG4gICAgU3RyZWFtQnJpZGdlLnByb3RvdHlwZS5vbkNsb3NlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLndyYXBwZWRPbkNsb3NlLCAnQ2FsbGVkIG9uQ2xvc2Ugb24gc3RyZWFtIHR3aWNlIScpO1xyXG4gICAgICAgIHRoaXMud3JhcHBlZE9uQ2xvc2UgPSBjYWxsYmFjaztcclxuICAgIH07XHJcbiAgICBTdHJlYW1CcmlkZ2UucHJvdG90eXBlLm9uTWVzc2FnZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy53cmFwcGVkT25NZXNzYWdlLCAnQ2FsbGVkIG9uTWVzc2FnZSBvbiBzdHJlYW0gdHdpY2UhJyk7XHJcbiAgICAgICAgdGhpcy53cmFwcGVkT25NZXNzYWdlID0gY2FsbGJhY2s7XHJcbiAgICB9O1xyXG4gICAgU3RyZWFtQnJpZGdlLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNsb3NlRm4oKTtcclxuICAgIH07XHJcbiAgICBTdHJlYW1CcmlkZ2UucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgdGhpcy5zZW5kRm4obXNnKTtcclxuICAgIH07XHJcbiAgICBTdHJlYW1CcmlkZ2UucHJvdG90eXBlLmNhbGxPbk9wZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMud3JhcHBlZE9uT3BlbiAhPT0gdW5kZWZpbmVkLCAnQ2Fubm90IGNhbGwgb25PcGVuIGJlY2F1c2Ugbm8gY2FsbGJhY2sgd2FzIHNldCcpO1xyXG4gICAgICAgIHRoaXMud3JhcHBlZE9uT3BlbigpO1xyXG4gICAgfTtcclxuICAgIFN0cmVhbUJyaWRnZS5wcm90b3R5cGUuY2FsbE9uQ2xvc2UgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMud3JhcHBlZE9uQ2xvc2UgIT09IHVuZGVmaW5lZCwgJ0Nhbm5vdCBjYWxsIG9uQ2xvc2UgYmVjYXVzZSBubyBjYWxsYmFjayB3YXMgc2V0Jyk7XHJcbiAgICAgICAgdGhpcy53cmFwcGVkT25DbG9zZShlcnIpO1xyXG4gICAgfTtcclxuICAgIFN0cmVhbUJyaWRnZS5wcm90b3R5cGUuY2FsbE9uTWVzc2FnZSA9IGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy53cmFwcGVkT25NZXNzYWdlICE9PSB1bmRlZmluZWQsICdDYW5ub3QgY2FsbCBvbk1lc3NhZ2UgYmVjYXVzZSBubyBjYWxsYmFjayB3YXMgc2V0Jyk7XHJcbiAgICAgICAgdGhpcy53cmFwcGVkT25NZXNzYWdlKG1zZyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFN0cmVhbUJyaWRnZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHID0gJ0Nvbm5lY3Rpb24nO1xyXG52YXIgUlBDX1NUUkVBTV9TRVJWSUNFID0gJ2dvb2dsZS5maXJlc3RvcmUudjFiZXRhMS5GaXJlc3RvcmUnO1xyXG52YXIgUlBDX1VSTF9WRVJTSU9OID0gJ3YxYmV0YTEnO1xyXG4vKiogTWFwcyBSUEMgbmFtZXMgdG8gdGhlIGNvcnJlc3BvbmRpbmcgUkVTVCBlbmRwb2ludCBuYW1lLiAqL1xyXG52YXIgUlBDX05BTUVfUkVTVF9NQVBQSU5HID0ge1xyXG4gICAgQmF0Y2hHZXREb2N1bWVudHM6ICdiYXRjaEdldCcsXHJcbiAgICBDb21taXQ6ICdjb21taXQnXHJcbn07XHJcbi8vIFRPRE8oYi8zODIwMzM0NCk6IFRoZSBTREtfVkVSU0lPTiBpcyBzZXQgaW5kZXBlbmRlbnRseSBmcm9tIEZpcmViYXNlIGJlY2F1c2VcclxuLy8gd2UgYXJlIGRvaW5nIG91dC1vZi1iYW5kIHJlbGVhc2VzLiBPbmNlIHdlIHJlbGVhc2UgYXMgcGFydCBvZiBGaXJlYmFzZSwgd2VcclxuLy8gc2hvdWxkIHVzZSB0aGUgRmlyZWJhc2UgdmVyc2lvbiBpbnN0ZWFkLlxyXG52YXIgWF9HT09HX0FQSV9DTElFTlRfVkFMVUUgPSAnZ2wtanMvIGZpcmUvJyArIFNES19WRVJTSU9OO1xyXG52YXIgWEhSX1RJTUVPVVRfU0VDUyA9IDE1O1xyXG52YXIgV2ViQ2hhbm5lbENvbm5lY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBXZWJDaGFubmVsQ29ubmVjdGlvbihpbmZvKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gaW5mby5kYXRhYmFzZUlkO1xyXG4gICAgICAgIHRoaXMucG9vbCA9IG5ldyB3ZWJjaGFubmVsV3JhcHBlci5YaHJJb1Bvb2woKTtcclxuICAgICAgICB2YXIgcHJvdG8gPSBpbmZvLnNzbCA/ICdodHRwcycgOiAnaHR0cCc7XHJcbiAgICAgICAgdGhpcy5iYXNlVXJsID0gcHJvdG8gKyAnOi8vJyArIGluZm8uaG9zdDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTW9kaWZpZXMgdGhlIGhlYWRlcnMgZm9yIGEgcmVxdWVzdCwgYWRkaW5nIGFueSBhdXRob3JpemF0aW9uIHRva2VuIGlmXHJcbiAgICAgKiBwcmVzZW50IGFuZCBhbnkgYWRkaXRpb25hbCBoZWFkZXJzIGZvciB0aGUgcmVxdWVzdC5cclxuICAgICAqL1xyXG4gICAgV2ViQ2hhbm5lbENvbm5lY3Rpb24ucHJvdG90eXBlLm1vZGlmeUhlYWRlcnNGb3JSZXF1ZXN0ID0gZnVuY3Rpb24gKGhlYWRlcnMsIHRva2VuKSB7XHJcbiAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGhlYWRlciBpbiB0b2tlbi5hdXRoSGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRva2VuLmF1dGhIZWFkZXJzLmhhc093blByb3BlcnR5KGhlYWRlcikpIHtcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW2hlYWRlcl0gPSB0b2tlbi5hdXRoSGVhZGVyc1toZWFkZXJdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGhlYWRlcnNbJ1gtR29vZy1BcGktQ2xpZW50J10gPSBYX0dPT0dfQVBJX0NMSUVOVF9WQUxVRTtcclxuICAgIH07XHJcbiAgICBXZWJDaGFubmVsQ29ubmVjdGlvbi5wcm90b3R5cGUuaW52b2tlUlBDID0gZnVuY3Rpb24gKHJwY05hbWUsIHJlcXVlc3QsIHRva2VuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgdXJsID0gdGhpcy5tYWtlVXJsKHJwY05hbWUpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgWGhySW9Qb29sIGRvZXNuJ3QgaGF2ZSBUUyB0eXBpbmdzLlxyXG4gICAgICAgICAgICBfdGhpcy5wb29sLmdldE9iamVjdChmdW5jdGlvbiAoeGhyKSB7XHJcbiAgICAgICAgICAgICAgICB4aHIubGlzdGVuT25jZSh3ZWJjaGFubmVsV3JhcHBlci5FdmVudFR5cGUuQ09NUExFVEUsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHhoci5nZXRMYXN0RXJyb3JDb2RlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Ugd2ViY2hhbm5lbFdyYXBwZXIuRXJyb3JDb2RlLk5PX0VSUk9SOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqc29uID0geGhyLmdldFJlc3BvbnNlSnNvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdYSFIgcmVjZWl2ZWQ6JywgSlNPTi5zdHJpbmdpZnkoanNvbikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoanNvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIHdlYmNoYW5uZWxXcmFwcGVyLkVycm9yQ29kZS5USU1FT1VUOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdSUEMgXCInICsgcnBjTmFtZSArICdcIiB0aW1lZCBvdXQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKENvZGUuREVBRExJTkVfRVhDRUVERUQsICdSZXF1ZXN0IHRpbWUgb3V0JykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSB3ZWJjaGFubmVsV3JhcHBlci5FcnJvckNvZGUuSFRUUF9FUlJPUjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdHVzXzEgPSB4aHIuZ2V0U3RhdHVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1JQQyBcIicgKyBycGNOYW1lICsgJ1wiIGZhaWxlZCB3aXRoIHN0YXR1czonLCBzdGF0dXNfMSwgJ3Jlc3BvbnNlIHRleHQ6JywgeGhyLmdldFJlc3BvbnNlVGV4dCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdHVzXzEgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRmlyZXN0b3JlRXJyb3IobWFwQ29kZUZyb21IdHRwU3RhdHVzKHN0YXR1c18xKSwgJ1NlcnZlciByZXNwb25kZWQgd2l0aCBzdGF0dXMgJyArIHhoci5nZXRTdGF0dXNUZXh0KCkpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIHJlY2VpdmVkIGFuIEhUVFBfRVJST1IgYnV0IHRoZXJlJ3Mgbm8gc3RhdHVzIGNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGl0J3MgbW9zdCBwcm9iYWJseSBhIGNvbm5lY3Rpb24gaXNzdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1JQQyBcIicgKyBycGNOYW1lICsgJ1wiIGZhaWxlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5BVkFJTEFCTEUsICdDb25uZWN0aW9uIGZhaWxlZC4nKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlsKCdSUEMgXCInICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnBjTmFtZSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdcIiBmYWlsZWQgd2l0aCB1bmFudGljaXBhdGVkICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnd2ViY2hhbm5lbCBlcnJvciAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGhyLmdldExhc3RFcnJvckNvZGUoKSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4aHIuZ2V0TGFzdEVycm9yKCkgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLCBnaXZpbmcgdXAuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdSUEMgXCInICsgcnBjTmFtZSArICdcIiBjb21wbGV0ZWQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBvb2wucmVsZWFzZU9iamVjdCh4aHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3RTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShyZXF1ZXN0KTtcclxuICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdYSFIgc2VuZGluZzogJywgdXJsICsgJyAnICsgcmVxdWVzdFN0cmluZyk7XHJcbiAgICAgICAgICAgICAgICAvLyBDb250ZW50LVR5cGU6IHRleHQvcGxhaW4gd2lsbCBhdm9pZCBwcmVmbGlnaHQgcmVxdWVzdHMgd2hpY2ggbWlnaHRcclxuICAgICAgICAgICAgICAgIC8vIG1lc3Mgd2l0aCBDT1JTIGFuZCByZWRpcmVjdHMgYnkgcHJveGllcy4gSWYgd2UgYWRkIGN1c3RvbSBoZWFkZXJzXHJcbiAgICAgICAgICAgICAgICAvLyB3ZSB3aWxsIG5lZWQgdG8gY2hhbmdlIHRoaXMgY29kZSB0byBwb3RlbnRpYWxseSB1c2UgdGhlXHJcbiAgICAgICAgICAgICAgICAvLyAkaHR0cE92ZXJ3cml0ZSBwYXJhbWV0ZXIgc3VwcG9ydGVkIGJ5IEVTRiB0byBhdm9pZFxyXG4gICAgICAgICAgICAgICAgLy8gdHJpZ2dlcmluZyBwcmVmbGlnaHQgcmVxdWVzdHMuXHJcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IHsgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJyB9O1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubW9kaWZ5SGVhZGVyc0ZvclJlcXVlc3QoaGVhZGVycywgdG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgeGhyLnNlbmQodXJsLCAnUE9TVCcsIHJlcXVlc3RTdHJpbmcsIGhlYWRlcnMsIFhIUl9USU1FT1VUX1NFQ1MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBXZWJDaGFubmVsQ29ubmVjdGlvbi5wcm90b3R5cGUuaW52b2tlU3RyZWFtaW5nUlBDID0gZnVuY3Rpb24gKHJwY05hbWUsIHJlcXVlc3QsIHRva2VuKSB7XHJcbiAgICAgICAgLy8gVGhlIFJFU1QgQVBJIGF1dG9tYXRpY2FsbHkgYWdncmVnYXRlcyBhbGwgb2YgdGhlIHN0cmVhbWVkIHJlc3VsdHMsIHNvIHdlXHJcbiAgICAgICAgLy8gY2FuIGp1c3QgdXNlIHRoZSBub3JtYWwgaW52b2tlKCkgbWV0aG9kLlxyXG4gICAgICAgIHJldHVybiB0aGlzLmludm9rZVJQQyhycGNOYW1lLCByZXF1ZXN0LCB0b2tlbik7XHJcbiAgICB9O1xyXG4gICAgV2ViQ2hhbm5lbENvbm5lY3Rpb24ucHJvdG90eXBlLm9wZW5TdHJlYW0gPSBmdW5jdGlvbiAocnBjTmFtZSwgdG9rZW4pIHtcclxuICAgICAgICB2YXIgdXJsUGFydHMgPSBbXHJcbiAgICAgICAgICAgIHRoaXMuYmFzZVVybCxcclxuICAgICAgICAgICAgJy8nLFxyXG4gICAgICAgICAgICBSUENfU1RSRUFNX1NFUlZJQ0UsXHJcbiAgICAgICAgICAgICcvJyxcclxuICAgICAgICAgICAgcnBjTmFtZSxcclxuICAgICAgICAgICAgJy9jaGFubmVsJ1xyXG4gICAgICAgIF07XHJcbiAgICAgICAgdmFyIHdlYmNoYW5uZWxUcmFuc3BvcnQgPSB3ZWJjaGFubmVsV3JhcHBlci5jcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0KCk7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB7XHJcbiAgICAgICAgICAgIC8vIEJhY2tncm91bmQgY2hhbm5lbCB0ZXN0IGF2b2lkcyB0aGUgaW5pdGlhbCB0d28gdGVzdCBjYWxscyBhbmQgZGVjcmVhc2VzXHJcbiAgICAgICAgICAgIC8vIGluaXRpYWwgY29sZCBzdGFydCB0aW1lLlxyXG4gICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IHdlbmJvekAgbWVudGlvbmVkIHRoaXMgbWlnaHQgYWZmZWN0IHVzZSB3aXRoIHByb3hpZXMgYW5kXHJcbiAgICAgICAgICAgIC8vIHdlIHNob3VsZCBtb25pdG9yIGNsb3NlbHkgZm9yIGFueSByZXBvcnRzLlxyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ2hhbm5lbFRlc3Q6IHRydWUsXHJcbiAgICAgICAgICAgIC8vIFJlcXVpcmVkIGZvciBiYWNrZW5kIHN0aWNraW5lc3MsIHJvdXRpbmcgYmVoYXZpb3IgaXMgYmFzZWQgb24gdGhpc1xyXG4gICAgICAgICAgICAvLyBwYXJhbWV0ZXIuXHJcbiAgICAgICAgICAgIGh0dHBTZXNzaW9uSWRQYXJhbTogJ2dzZXNzaW9uaWQnLFxyXG4gICAgICAgICAgICBpbml0TWVzc2FnZUhlYWRlcnM6IHt9LFxyXG4gICAgICAgICAgICBtZXNzYWdlVXJsUGFyYW1zOiB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHBhcmFtIGlzIHVzZWQgdG8gaW1wcm92ZSByb3V0aW5nIGFuZCBwcm9qZWN0IGlzb2xhdGlvbiBieSB0aGVcclxuICAgICAgICAgICAgICAgIC8vIGJhY2tlbmQgYW5kIG11c3QgYmUgaW5jbHVkZWQgaW4gZXZlcnkgcmVxdWVzdC5cclxuICAgICAgICAgICAgICAgIGRhdGFiYXNlOiBcInByb2plY3RzL1wiICsgdGhpcy5kYXRhYmFzZUlkLnByb2plY3RJZCArIFwiL2RhdGFiYXNlcy9cIiArIHRoaXMuZGF0YWJhc2VJZC5kYXRhYmFzZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZW5kUmF3SnNvbjogdHJ1ZSxcclxuICAgICAgICAgICAgc3VwcG9ydHNDcm9zc0RvbWFpblhocjogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5tb2RpZnlIZWFkZXJzRm9yUmVxdWVzdChyZXF1ZXN0LmluaXRNZXNzYWdlSGVhZGVycywgdG9rZW4pO1xyXG4gICAgICAgIC8vIFNlbmRpbmcgdGhlIGN1c3RvbSBoZWFkZXJzIHdlIGp1c3QgYWRkZWQgdG8gcmVxdWVzdC5pbml0TWVzc2FnZUhlYWRlcnNcclxuICAgICAgICAvLyAoQXV0aG9yaXphdGlvbiwgZXRjLikgd2lsbCB0cmlnZ2VyIHRoZSBicm93c2VyIHRvIG1ha2UgYSBDT1JTIHByZWZsaWdodFxyXG4gICAgICAgIC8vIHJlcXVlc3QgYmVjYXVzZSB0aGUgWEhSIHdpbGwgbm8gbG9uZ2VyIG1lZXQgdGhlIGNyaXRlcmlhIGZvciBhIFwic2ltcGxlXCJcclxuICAgICAgICAvLyBDT1JTIHJlcXVlc3Q6XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRUUC9DT1JTI1NpbXBsZV9yZXF1ZXN0c1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gVGhlcmVmb3JlIHRvIGF2b2lkIHRoZSBDT1JTIHByZWZsaWdodCByZXF1ZXN0IChhbiBleHRyYSBuZXR3b3JrXHJcbiAgICAgICAgLy8gcm91bmR0cmlwKSwgd2UgdXNlIHRoZSBodHRwSGVhZGVyc092ZXJ3cml0ZVBhcmFtIG9wdGlvbiB0byBzcGVjaWZ5IHRoYXRcclxuICAgICAgICAvLyB0aGUgaGVhZGVycyBzaG91bGQgaW5zdGVhZCBiZSBlbmNvZGVkIGludG8gYSBzcGVjaWFsIFwiJGh0dHBIZWFkZXJzXCIgcXVlcnlcclxuICAgICAgICAvLyBwYXJhbWV0ZXIsIHdoaWNoIGlzIHJlY29nbml6ZWQgYnkgdGhlIHdlYmNoYW5uZWwgYmFja2VuZC4gVGhpcyBpc1xyXG4gICAgICAgIC8vIGZvcm1hbGx5IGRlZmluZWQgaGVyZTpcclxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2Nsb3N1cmUtbGlicmFyeS9ibG9iL2IwZTE4MTViMTNmYjkyYTQ2ZDdjOWIzYzMwZGU1ZDZhMzk2YTMyNDUvY2xvc3VyZS9nb29nL25ldC9ycGMvaHR0cGNvcnMuanMjTDMyXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBCdXQgZm9yIHNvbWUgdW5jbGVhciByZWFzb24gKHNlZVxyXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1qcy1zZGsvaXNzdWVzLzcwMyksIHRoaXMgYnJlYWtzXHJcbiAgICAgICAgLy8gUmVhY3ROYXRpdmUgYW5kIHNvIHdlIGV4Y2x1ZGUgaXQsIHdoaWNoIGp1c3QgbWVhbnMgUmVhY3ROYXRpdmUgbWF5IGJlXHJcbiAgICAgICAgLy8gc3ViamVjdCB0byB0aGUgZXh0cmEgbmV0d29yayByb3VuZHRyaXAgZm9yIENPUlMgcHJlZmxpZ2h0LlxyXG4gICAgICAgIGlmICghaXNSZWFjdE5hdGl2ZSgpKSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RbJ2h0dHBIZWFkZXJzT3ZlcndyaXRlUGFyYW0nXSA9ICckaHR0cEhlYWRlcnMnO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdXJsID0gdXJsUGFydHMuam9pbignJyk7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRywgJ0NyZWF0aW5nIFdlYkNoYW5uZWw6ICcgKyB1cmwgKyAnICcgKyByZXF1ZXN0KTtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IEJlY2F1c2UgbGlzdGVuIGlzbid0IGRlZmluZWQgb24gaXQuXHJcbiAgICAgICAgdmFyIGNoYW5uZWwgPSB3ZWJjaGFubmVsVHJhbnNwb3J0LmNyZWF0ZVdlYkNoYW5uZWwodXJsLCByZXF1ZXN0KTtcclxuICAgICAgICAvLyBXZWJDaGFubmVsIHN1cHBvcnRzIHNlbmRpbmcgdGhlIGZpcnN0IG1lc3NhZ2Ugd2l0aCB0aGUgaGFuZHNoYWtlIC0gc2F2aW5nXHJcbiAgICAgICAgLy8gYSBuZXR3b3JrIHJvdW5kIHRyaXAuIEhvd2V2ZXIsIGl0IHdpbGwgaGF2ZSB0byBjYWxsIHNlbmQgaW4gdGhlIHNhbWVcclxuICAgICAgICAvLyBKUyBldmVudCBsb29wIGFzIG9wZW4uIEluIG9yZGVyIHRvIGVuZm9yY2UgdGhpcywgd2UgZGVsYXkgYWN0dWFsbHlcclxuICAgICAgICAvLyBvcGVuaW5nIHRoZSBXZWJDaGFubmVsIHVudGlsIHNlbmQgaXMgY2FsbGVkLiBXaGV0aGVyIHdlIGhhdmUgY2FsbGVkXHJcbiAgICAgICAgLy8gb3BlbiBpcyB0cmFja2VkIHdpdGggdGhpcyB2YXJpYWJsZS5cclxuICAgICAgICB2YXIgb3BlbmVkID0gZmFsc2U7XHJcbiAgICAgICAgLy8gQSBmbGFnIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSBzdHJlYW0gd2FzIGNsb3NlZCAoYnkgdXMgb3IgdGhyb3VnaCBhblxyXG4gICAgICAgIC8vIGVycm9yL2Nsb3NlIGV2ZW50KSB0byBhdm9pZCBkZWxpdmVyaW5nIG11bHRpcGxlIGNsb3NlIGV2ZW50cyBvciBzZW5kaW5nXHJcbiAgICAgICAgLy8gb24gYSBjbG9zZWQgc3RyZWFtXHJcbiAgICAgICAgdmFyIGNsb3NlZCA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBzdHJlYW1CcmlkZ2UgPSBuZXcgU3RyZWFtQnJpZGdlKHtcclxuICAgICAgICAgICAgc2VuZEZuOiBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNsb3NlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghb3BlbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdPcGVuaW5nIFdlYkNoYW5uZWwgdHJhbnNwb3J0LicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsLm9wZW4oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BlbmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1dlYkNoYW5uZWwgc2VuZGluZzonLCBtc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5uZWwuc2VuZChtc2cpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ05vdCBzZW5kaW5nIGJlY2F1c2UgV2ViQ2hhbm5lbCBpcyBjbG9zZWQ6JywgbXNnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY2xvc2VGbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gY2hhbm5lbC5jbG9zZSgpOyB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gQ2xvc3VyZSBldmVudHMgYXJlIGd1YXJkZWQgYW5kIGV4Y2VwdGlvbnMgYXJlIHN3YWxsb3dlZCwgc28gY2F0Y2ggYW55XHJcbiAgICAgICAgLy8gZXhjZXB0aW9uIGFuZCByZXRocm93IHVzaW5nIGEgc2V0VGltZW91dCBzbyB0aGV5IGJlY29tZSB2aXNpYmxlIGFnYWluLlxyXG4gICAgICAgIC8vIE5vdGUgdGhhdCBldmVudHVhbGx5IHRoaXMgZnVuY3Rpb24gY291bGQgZ28gYXdheSBpZiB3ZSBhcmUgY29uZmlkZW50XHJcbiAgICAgICAgLy8gZW5vdWdoIHRoZSBjb2RlIGlzIGV4Y2VwdGlvbiBmcmVlLlxyXG4gICAgICAgIHZhciB1bmd1YXJkZWRFdmVudExpc3RlbiA9IGZ1bmN0aW9uICh0eXBlLCBmbikge1xyXG4gICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IGNsb3N1cmUgdHlwaW5nIHNlZW1zIGJyb2tlbiBiZWNhdXNlIFdlYkNoYW5uZWwgZG9lc1xyXG4gICAgICAgICAgICAvLyBub3QgaW1wbGVtZW50IGdvb2cuZXZlbnRzLkxpc3RlbmFibGVcclxuICAgICAgICAgICAgY2hhbm5lbC5saXN0ZW4odHlwZSwgZnVuY3Rpb24gKHBhcmFtKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZuKHBhcmFtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdW5ndWFyZGVkRXZlbnRMaXN0ZW4od2ViY2hhbm5lbFdyYXBwZXIuV2ViQ2hhbm5lbC5FdmVudFR5cGUuT1BFTiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWNsb3NlZCkge1xyXG4gICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1dlYkNoYW5uZWwgdHJhbnNwb3J0IG9wZW5lZC4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHVuZ3VhcmRlZEV2ZW50TGlzdGVuKHdlYmNoYW5uZWxXcmFwcGVyLldlYkNoYW5uZWwuRXZlbnRUeXBlLkNMT1NFLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghY2xvc2VkKSB7XHJcbiAgICAgICAgICAgICAgICBjbG9zZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1dlYkNoYW5uZWwgdHJhbnNwb3J0IGNsb3NlZCcpO1xyXG4gICAgICAgICAgICAgICAgc3RyZWFtQnJpZGdlLmNhbGxPbkNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB1bmd1YXJkZWRFdmVudExpc3Rlbih3ZWJjaGFubmVsV3JhcHBlci5XZWJDaGFubmVsLkV2ZW50VHlwZS5FUlJPUiwgZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBpZiAoIWNsb3NlZCkge1xyXG4gICAgICAgICAgICAgICAgY2xvc2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdXZWJDaGFubmVsIHRyYW5zcG9ydCBlcnJvcmVkOicsIGVycik7XHJcbiAgICAgICAgICAgICAgICBzdHJlYW1CcmlkZ2UuY2FsbE9uQ2xvc2UobmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5BVkFJTEFCTEUsICdUaGUgb3BlcmF0aW9uIGNvdWxkIG5vdCBiZSBjb21wbGV0ZWQnKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB1bmd1YXJkZWRFdmVudExpc3Rlbih3ZWJjaGFubmVsV3JhcHBlci5XZWJDaGFubmVsLkV2ZW50VHlwZS5NRVNTQUdFLCBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgICAgIGlmICghY2xvc2VkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbXNnRGF0YSA9IG1zZy5kYXRhWzBdO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KCEhbXNnRGF0YSwgJ0dvdCBhIHdlYmNoYW5uZWwgbWVzc2FnZSB3aXRob3V0IGRhdGEuJyk7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGIvMzUxNDM4OTEpOiBUaGVyZSBpcyBhIGJ1ZyBpbiBPbmUgUGxhdGZvcm0gdGhhdCBjYXVzZWQgZXJyb3JzXHJcbiAgICAgICAgICAgICAgICAvLyAoYW5kIG9ubHkgZXJyb3JzKSB0byBiZSB3cmFwcGVkIGluIGFuIGV4dHJhIGFycmF5LiBUbyBiZSBmb3J3YXJkXHJcbiAgICAgICAgICAgICAgICAvLyBjb21wYXRpYmxlIHdpdGggdGhlIGJ1ZyB3ZSBuZWVkIHRvIGNoZWNrIGVpdGhlciBjb25kaXRpb24uIFRoZSBsYXR0ZXJcclxuICAgICAgICAgICAgICAgIC8vIGNhbiBiZSByZW1vdmVkIG9uY2UgdGhlIGZpeCBoYXMgYmVlbiByb2xsZWQgb3V0LlxyXG4gICAgICAgICAgICAgICAgdmFyIGVycm9yJCQxID0gXHJcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IG1zZ0RhdGEuZXJyb3IgaXMgbm90IHR5cGVkLlxyXG4gICAgICAgICAgICAgICAgbXNnRGF0YS5lcnJvciB8fCAobXNnRGF0YVswXSAmJiBtc2dEYXRhWzBdLmVycm9yKTtcclxuICAgICAgICAgICAgICAgIGlmIChlcnJvciQkMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdXZWJDaGFubmVsIHJlY2VpdmVkIGVycm9yOicsIGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBlcnJvci5zdGF0dXMgd2lsbCBiZSBhIHN0cmluZyBsaWtlICdPSycgb3IgJ05PVF9GT1VORCcuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1c18yID0gZXJyb3IkJDEuc3RhdHVzO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gbWFwQ29kZUZyb21ScGNTdGF0dXMoc3RhdHVzXzIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gZXJyb3IkJDEubWVzc2FnZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29kZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgPSBDb2RlLklOVEVSTkFMO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdVbmtub3duIGVycm9yIHN0YXR1czogJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzXzIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgd2l0aCBtZXNzYWdlICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yJCQxLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgY2xvc2VkIHNvIG5vIGZ1cnRoZXIgZXZlbnRzIGFyZSBwcm9wYWdhdGVkXHJcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBzdHJlYW1CcmlkZ2UuY2FsbE9uQ2xvc2UobmV3IEZpcmVzdG9yZUVycm9yKGNvZGUsIG1lc3NhZ2UpKTtcclxuICAgICAgICAgICAgICAgICAgICBjaGFubmVsLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnV2ViQ2hhbm5lbCByZWNlaXZlZDonLCBtc2dEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICBzdHJlYW1CcmlkZ2UuY2FsbE9uTWVzc2FnZShtc2dEYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBUZWNobmljYWxseSB3ZSBjb3VsZC9zaG91bGQgd2FpdCBmb3IgdGhlIFdlYkNoYW5uZWwgb3BlbmVkIGV2ZW50LFxyXG4gICAgICAgICAgICAvLyBidXQgYmVjYXVzZSB3ZSB3YW50IHRvIHNlbmQgdGhlIGZpcnN0IG1lc3NhZ2Ugd2l0aCB0aGUgV2ViQ2hhbm5lbFxyXG4gICAgICAgICAgICAvLyBoYW5kc2hha2Ugd2UgcHJldGVuZCB0aGUgY2hhbm5lbCBvcGVuZWQgaGVyZSAoYXN5bmNocm9ub3VzbHkpLCBhbmRcclxuICAgICAgICAgICAgLy8gdGhlbiBkZWxheSB0aGUgYWN0dWFsIG9wZW4gdW50aWwgdGhlIGZpcnN0IG1lc3NhZ2UgaXMgc2VudC5cclxuICAgICAgICAgICAgc3RyZWFtQnJpZGdlLmNhbGxPbk9wZW4oKTtcclxuICAgICAgICB9LCAwKTtcclxuICAgICAgICByZXR1cm4gc3RyZWFtQnJpZGdlO1xyXG4gICAgfTtcclxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcclxuICAgIFdlYkNoYW5uZWxDb25uZWN0aW9uLnByb3RvdHlwZS5tYWtlVXJsID0gZnVuY3Rpb24gKHJwY05hbWUpIHtcclxuICAgICAgICB2YXIgdXJsUnBjTmFtZSA9IFJQQ19OQU1FX1JFU1RfTUFQUElOR1tycGNOYW1lXTtcclxuICAgICAgICBhc3NlcnQodXJsUnBjTmFtZSAhPT0gdW5kZWZpbmVkLCAnVW5rbm93biBSRVNUIG1hcHBpbmcgZm9yOiAnICsgcnBjTmFtZSk7XHJcbiAgICAgICAgdmFyIHVybCA9IFt0aGlzLmJhc2VVcmwsICcvJywgUlBDX1VSTF9WRVJTSU9OXTtcclxuICAgICAgICB1cmwucHVzaCgnL3Byb2plY3RzLycpO1xyXG4gICAgICAgIHVybC5wdXNoKHRoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWQpO1xyXG4gICAgICAgIHVybC5wdXNoKCcvZGF0YWJhc2VzLycpO1xyXG4gICAgICAgIHVybC5wdXNoKHRoaXMuZGF0YWJhc2VJZC5kYXRhYmFzZSk7XHJcbiAgICAgICAgdXJsLnB1c2goJy9kb2N1bWVudHMnKTtcclxuICAgICAgICB1cmwucHVzaCgnOicpO1xyXG4gICAgICAgIHVybC5wdXNoKHVybFJwY05hbWUpO1xyXG4gICAgICAgIHJldHVybiB1cmwuam9pbignJyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFdlYkNoYW5uZWxDb25uZWN0aW9uO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIEJyb3dzZXJQbGF0Zm9ybSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJyb3dzZXJQbGF0Zm9ybSgpIHtcclxuICAgICAgICB0aGlzLmVtcHR5Qnl0ZVN0cmluZyA9ICcnO1xyXG4gICAgICAgIHRoaXMuYmFzZTY0QXZhaWxhYmxlID0gdHlwZW9mIGF0b2IgIT09ICd1bmRlZmluZWQnO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJyb3dzZXJQbGF0Zm9ybS5wcm90b3R5cGUsIFwiZG9jdW1lbnRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyA/IGRvY3VtZW50IDogbnVsbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCcm93c2VyUGxhdGZvcm0ucHJvdG90eXBlLCBcIndpbmRvd1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IG51bGw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBCcm93c2VyUGxhdGZvcm0ucHJvdG90eXBlLmxvYWRDb25uZWN0aW9uID0gZnVuY3Rpb24gKGRhdGFiYXNlSW5mbykge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IFdlYkNoYW5uZWxDb25uZWN0aW9uKGRhdGFiYXNlSW5mbykpO1xyXG4gICAgfTtcclxuICAgIEJyb3dzZXJQbGF0Zm9ybS5wcm90b3R5cGUubmV3U2VyaWFsaXplciA9IGZ1bmN0aW9uIChkYXRhYmFzZUlkKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBKc29uUHJvdG9TZXJpYWxpemVyKGRhdGFiYXNlSWQsIHsgdXNlUHJvdG8zSnNvbjogdHJ1ZSB9KTtcclxuICAgIH07XHJcbiAgICBCcm93c2VyUGxhdGZvcm0ucHJvdG90eXBlLmZvcm1hdEpTT04gPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xyXG4gICAgfTtcclxuICAgIEJyb3dzZXJQbGF0Zm9ybS5wcm90b3R5cGUuYXRvYiA9IGZ1bmN0aW9uIChlbmNvZGVkKSB7XHJcbiAgICAgICAgcmV0dXJuIGF0b2IoZW5jb2RlZCk7XHJcbiAgICB9O1xyXG4gICAgQnJvd3NlclBsYXRmb3JtLnByb3RvdHlwZS5idG9hID0gZnVuY3Rpb24gKHJhdykge1xyXG4gICAgICAgIHJldHVybiBidG9hKHJhdyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJyb3dzZXJQbGF0Zm9ybTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGlzIGNvZGUgbmVlZHMgdG8gcnVuIGJlZm9yZSBGaXJlc3RvcmUgaXMgdXNlZC4gVGhpcyBjYW4gYmUgYWNoaWV2ZWQgaW5cclxuICogc2V2ZXJhbCB3YXlzOlxyXG4gKiAgIDEpIFRocm91Z2ggdGhlIEpTQ29tcGlsZXIgY29tcGlsaW5nIHRoaXMgY29kZSBhbmQgdGhlbiAoYXV0b21hdGljYWxseSlcclxuICogICAgICBleGVjdXRpbmcgaXQgYmVmb3JlIGV4cG9ydGluZyB0aGUgRmlyZXN0b3JlIHN5bWJvbHMuXHJcbiAqICAgMikgVGhyb3VnaCBpbXBvcnRpbmcgdGhpcyBtb2R1bGUgZmlyc3QgaW4gYSBGaXJlc3RvcmUgbWFpbiBtb2R1bGVcclxuICovXHJcblBsYXRmb3JtU3VwcG9ydC5zZXRQbGF0Zm9ybShuZXcgQnJvd3NlclBsYXRmb3JtKCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIGBMaXN0ZW5TZXF1ZW5jZWAgaXMgYSBtb25vdG9uaWMgc2VxdWVuY2UuIEl0IGlzIGluaXRpYWxpemVkIHdpdGggYSBtaW5pbXVtIHZhbHVlIHRvXHJcbiAqIGV4Y2VlZC4gQWxsIHN1YnNlcXVlbnQgY2FsbHMgdG8gbmV4dCB3aWxsIHJldHVybiBpbmNyZWFzaW5nIHZhbHVlcy4gSWYgcHJvdmlkZWQgd2l0aCBhXHJcbiAqIGBTZXF1ZW5jZU51bWJlclN5bmNlcmAsIGl0IHdpbGwgYWRkaXRpb25hbGx5IGJ1bXAgaXRzIG5leHQgdmFsdWUgd2hlbiB0b2xkIG9mIGEgbmV3IHZhbHVlLCBhc1xyXG4gKiB3ZWxsIGFzIHdyaXRlIG91dCBzZXF1ZW5jZSBudW1iZXJzIHRoYXQgaXQgcHJvZHVjZXMgdmlhIGBuZXh0KClgLlxyXG4gKi9cclxudmFyIExpc3RlblNlcXVlbmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTGlzdGVuU2VxdWVuY2UocHJldmlvdXNWYWx1ZSwgc2VxdWVuY2VOdW1iZXJTeW5jZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMucHJldmlvdXNWYWx1ZSA9IHByZXZpb3VzVmFsdWU7XHJcbiAgICAgICAgaWYgKHNlcXVlbmNlTnVtYmVyU3luY2VyKSB7XHJcbiAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyU3luY2VyLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IGZ1bmN0aW9uIChzZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNldFByZXZpb3VzVmFsdWUoc2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLndyaXRlTmV3U2VxdWVuY2VOdW1iZXIgPSBmdW5jdGlvbiAoc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZXF1ZW5jZU51bWJlclN5bmNlci53cml0ZVNlcXVlbmNlTnVtYmVyKHNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBMaXN0ZW5TZXF1ZW5jZS5wcm90b3R5cGUuc2V0UHJldmlvdXNWYWx1ZSA9IGZ1bmN0aW9uIChleHRlcm5hbFByZXZpb3VzVmFsdWUpIHtcclxuICAgICAgICB0aGlzLnByZXZpb3VzVmFsdWUgPSBNYXRoLm1heChleHRlcm5hbFByZXZpb3VzVmFsdWUsIHRoaXMucHJldmlvdXNWYWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJldmlvdXNWYWx1ZTtcclxuICAgIH07XHJcbiAgICBMaXN0ZW5TZXF1ZW5jZS5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbmV4dFZhbHVlID0gKyt0aGlzLnByZXZpb3VzVmFsdWU7XHJcbiAgICAgICAgaWYgKHRoaXMud3JpdGVOZXdTZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICB0aGlzLndyaXRlTmV3U2VxdWVuY2VOdW1iZXIobmV4dFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5leHRWYWx1ZTtcclxuICAgIH07XHJcbiAgICBMaXN0ZW5TZXF1ZW5jZS5JTlZBTElEID0gLTE7XHJcbiAgICByZXR1cm4gTGlzdGVuU2VxdWVuY2U7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRGVmZXJyZWQkMSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERlZmVycmVkKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgX3RoaXMucmVqZWN0ID0gcmVqZWN0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIERlZmVycmVkO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFdlbGxrbm93biBcInRpbWVyXCIgSURzIHVzZWQgd2hlbiBzY2hlZHVsaW5nIGRlbGF5ZWQgb3BlcmF0aW9ucyBvbiB0aGVcclxuICogQXN5bmNRdWV1ZS4gVGhlc2UgSURzIGNhbiB0aGVuIGJlIHVzZWQgZnJvbSB0ZXN0cyB0byBjaGVjayBmb3IgdGhlIHByZXNlbmNlXHJcbiAqIG9mIG9wZXJhdGlvbnMgb3IgdG8gcnVuIHRoZW0gZWFybHkuXHJcbiAqXHJcbiAqIFRoZSBzdHJpbmcgdmFsdWVzIGFyZSB1c2VkIHdoZW4gZW5jb2RpbmcgdGhlc2UgdGltZXIgSURzIGluIEpTT04gc3BlYyB0ZXN0cy5cclxuICovXHJcbnZhciBUaW1lcklkO1xyXG4oZnVuY3Rpb24gKFRpbWVySWQpIHtcclxuICAgIC8qKiBBbGwgY2FuIGJlIHVzZWQgd2l0aCBydW5EZWxheWVkT3BlcmF0aW9uc0Vhcmx5KCkgdG8gcnVuIGFsbCB0aW1lcnMuICovXHJcbiAgICBUaW1lcklkW1wiQWxsXCJdID0gXCJhbGxcIjtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGZvbGxvd2luZyA0IHRpbWVycyBhcmUgdXNlZCBpbiBwZXJzaXN0ZW50X3N0cmVhbS50cyBmb3IgdGhlIGxpc3RlbiBhbmRcclxuICAgICAqIHdyaXRlIHN0cmVhbXMuIFRoZSBcIklkbGVcIiB0aW1lciBpcyB1c2VkIHRvIGNsb3NlIHRoZSBzdHJlYW0gZHVlIHRvXHJcbiAgICAgKiBpbmFjdGl2aXR5LiBUaGUgXCJDb25uZWN0aW9uQmFja29mZlwiIHRpbWVyIGlzIHVzZWQgdG8gcmVzdGFydCBhIHN0cmVhbSBvbmNlXHJcbiAgICAgKiB0aGUgYXBwcm9wcmlhdGUgYmFja29mZiBkZWxheSBoYXMgZWxhcHNlZC5cclxuICAgICAqL1xyXG4gICAgVGltZXJJZFtcIkxpc3RlblN0cmVhbUlkbGVcIl0gPSBcImxpc3Rlbl9zdHJlYW1faWRsZVwiO1xyXG4gICAgVGltZXJJZFtcIkxpc3RlblN0cmVhbUNvbm5lY3Rpb25CYWNrb2ZmXCJdID0gXCJsaXN0ZW5fc3RyZWFtX2Nvbm5lY3Rpb25fYmFja29mZlwiO1xyXG4gICAgVGltZXJJZFtcIldyaXRlU3RyZWFtSWRsZVwiXSA9IFwid3JpdGVfc3RyZWFtX2lkbGVcIjtcclxuICAgIFRpbWVySWRbXCJXcml0ZVN0cmVhbUNvbm5lY3Rpb25CYWNrb2ZmXCJdID0gXCJ3cml0ZV9zdHJlYW1fY29ubmVjdGlvbl9iYWNrb2ZmXCI7XHJcbiAgICAvKipcclxuICAgICAqIEEgdGltZXIgdXNlZCBpbiBvbmxpbmVfc3RhdGVfdHJhY2tlci50cyB0byB0cmFuc2l0aW9uIGZyb21cclxuICAgICAqIE9ubGluZVN0YXRlLlVua25vd24gdG8gT2ZmbGluZSBhZnRlciBhIHNldCB0aW1lb3V0LCByYXRoZXIgdGhhbiB3YWl0aW5nXHJcbiAgICAgKiBpbmRlZmluaXRlbHkgZm9yIHN1Y2Nlc3Mgb3IgZmFpbHVyZS5cclxuICAgICAqL1xyXG4gICAgVGltZXJJZFtcIk9ubGluZVN0YXRlVGltZW91dFwiXSA9IFwib25saW5lX3N0YXRlX3RpbWVvdXRcIjtcclxuICAgIC8qKlxyXG4gICAgICogQSB0aW1lciB1c2VkIHRvIHVwZGF0ZSB0aGUgY2xpZW50IG1ldGFkYXRhIGluIEluZGV4ZWREYiwgd2hpY2ggaXMgdXNlZFxyXG4gICAgICogdG8gZGV0ZXJtaW5lIHRoZSBwcmltYXJ5IGxlYXNlaG9sZGVyLlxyXG4gICAgICovXHJcbiAgICBUaW1lcklkW1wiQ2xpZW50TWV0YWRhdGFSZWZyZXNoXCJdID0gXCJjbGllbnRfbWV0YWRhdGFfcmVmcmVzaFwiO1xyXG59KShUaW1lcklkIHx8IChUaW1lcklkID0ge30pKTtcclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYW4gb3BlcmF0aW9uIHNjaGVkdWxlZCB0byBiZSBydW4gaW4gdGhlIGZ1dHVyZSBvbiBhbiBBc3luY1F1ZXVlLlxyXG4gKlxyXG4gKiBJdCBpcyBjcmVhdGVkIHZpYSBEZWxheWVkT3BlcmF0aW9uLmNyZWF0ZUFuZFNjaGVkdWxlKCkuXHJcbiAqXHJcbiAqIFN1cHBvcnRzIGNhbmNlbGxhdGlvbiAodmlhIGNhbmNlbCgpKSBhbmQgZWFybHkgZXhlY3V0aW9uICh2aWEgc2tpcERlbGF5KCkpLlxyXG4gKi9cclxudmFyIERlbGF5ZWRPcGVyYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEZWxheWVkT3BlcmF0aW9uKGFzeW5jUXVldWUsIHRpbWVySWQsIHRhcmdldFRpbWVNcywgb3AsIHJlbW92YWxDYWxsYmFjaykge1xyXG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZSA9IGFzeW5jUXVldWU7XHJcbiAgICAgICAgdGhpcy50aW1lcklkID0gdGltZXJJZDtcclxuICAgICAgICB0aGlzLnRhcmdldFRpbWVNcyA9IHRhcmdldFRpbWVNcztcclxuICAgICAgICB0aGlzLm9wID0gb3A7XHJcbiAgICAgICAgdGhpcy5yZW1vdmFsQ2FsbGJhY2sgPSByZW1vdmFsQ2FsbGJhY2s7XHJcbiAgICAgICAgdGhpcy5kZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCQxKCk7XHJcbiAgICAgICAgdGhpcy50aGVuID0gdGhpcy5kZWZlcnJlZC5wcm9taXNlLnRoZW4uYmluZCh0aGlzLmRlZmVycmVkLnByb21pc2UpO1xyXG4gICAgICAgIHRoaXMuY2F0Y2ggPSB0aGlzLmRlZmVycmVkLnByb21pc2UuY2F0Y2guYmluZCh0aGlzLmRlZmVycmVkLnByb21pc2UpO1xyXG4gICAgICAgIC8vIEl0J3Mgbm9ybWFsIGZvciB0aGUgZGVmZXJyZWQgcHJvbWlzZSB0byBiZSBjYW5jZWxlZCAoZHVlIHRvIGNhbmNlbGxhdGlvbilcclxuICAgICAgICAvLyBhbmQgc28gd2UgYXR0YWNoIGEgZHVtbXkgY2F0Y2ggY2FsbGJhY2sgdG8gYXZvaWRcclxuICAgICAgICAvLyAnVW5oYW5kbGVkUHJvbWlzZVJlamVjdGlvbldhcm5pbmcnIGxvZyBzcGFtLlxyXG4gICAgICAgIHRoaXMuZGVmZXJyZWQucHJvbWlzZS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgRGVsYXllZE9wZXJhdGlvbiB0aGF0IGhhcyBiZWVuIHNjaGVkdWxlZCB0byBiZVxyXG4gICAgICogZXhlY3V0ZWQgb24gdGhlIHByb3ZpZGVkIGFzeW5jUXVldWUgYWZ0ZXIgdGhlIHByb3ZpZGVkIGRlbGF5TXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGFzeW5jUXVldWUgVGhlIHF1ZXVlIHRvIHNjaGVkdWxlIHRoZSBvcGVyYXRpb24gb24uXHJcbiAgICAgKiBAcGFyYW0gaWQgQSBUaW1lciBJRCBpZGVudGlmeWluZyB0aGUgdHlwZSBvZiBvcGVyYXRpb24gdGhpcyBpcy5cclxuICAgICAqIEBwYXJhbSBkZWxheU1zIFRoZSBkZWxheSAobXMpIGJlZm9yZSB0aGUgb3BlcmF0aW9uIHNob3VsZCBiZSBzY2hlZHVsZWQuXHJcbiAgICAgKiBAcGFyYW0gb3AgVGhlIG9wZXJhdGlvbiB0byBydW4uXHJcbiAgICAgKiBAcGFyYW0gcmVtb3ZhbENhbGxiYWNrIEEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHN5bmNocm9ub3VzbHkgb25jZSB0aGVcclxuICAgICAqICAgb3BlcmF0aW9uIGlzIGV4ZWN1dGVkIG9yIGNhbmNlbGVkLCBub3RpZnlpbmcgdGhlIEFzeW5jUXVldWUgdG8gcmVtb3ZlIGl0XHJcbiAgICAgKiAgIGZyb20gaXRzIGRlbGF5ZWRPcGVyYXRpb25zIGxpc3QuXHJcbiAgICAgKiAgIFBPUlRJTkcgTk9URTogVGhpcyBleGlzdHMgdG8gcHJldmVudCBtYWtpbmcgcmVtb3ZlRGVsYXllZE9wZXJhdGlvbigpIGFuZFxyXG4gICAgICogICB0aGUgRGVsYXllZE9wZXJhdGlvbiBjbGFzcyBwdWJsaWMuXHJcbiAgICAgKi9cclxuICAgIERlbGF5ZWRPcGVyYXRpb24uY3JlYXRlQW5kU2NoZWR1bGUgPSBmdW5jdGlvbiAoYXN5bmNRdWV1ZSwgdGltZXJJZCwgZGVsYXlNcywgb3AsIHJlbW92YWxDYWxsYmFjaykge1xyXG4gICAgICAgIHZhciB0YXJnZXRUaW1lID0gRGF0ZS5ub3coKSArIGRlbGF5TXM7XHJcbiAgICAgICAgdmFyIGRlbGF5ZWRPcCA9IG5ldyBEZWxheWVkT3BlcmF0aW9uKGFzeW5jUXVldWUsIHRpbWVySWQsIHRhcmdldFRpbWUsIG9wLCByZW1vdmFsQ2FsbGJhY2spO1xyXG4gICAgICAgIGRlbGF5ZWRPcC5zdGFydChkZWxheU1zKTtcclxuICAgICAgICByZXR1cm4gZGVsYXllZE9wO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIHRoZSB0aW1lci4gVGhpcyBpcyBjYWxsZWQgaW1tZWRpYXRlbHkgYWZ0ZXIgY29uc3RydWN0aW9uIGJ5XHJcbiAgICAgKiBjcmVhdGVBbmRTY2hlZHVsZSgpLlxyXG4gICAgICovXHJcbiAgICBEZWxheWVkT3BlcmF0aW9uLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uIChkZWxheU1zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnRpbWVySGFuZGxlID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVEZWxheUVsYXBzZWQoKTsgfSwgZGVsYXlNcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBRdWV1ZXMgdGhlIG9wZXJhdGlvbiB0byBydW4gaW1tZWRpYXRlbHkgKGlmIGl0IGhhc24ndCBhbHJlYWR5IGJlZW4gcnVuIG9yXHJcbiAgICAgKiBjYW5jZWxlZCkuXHJcbiAgICAgKi9cclxuICAgIERlbGF5ZWRPcGVyYXRpb24ucHJvdG90eXBlLnNraXBEZWxheSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVEZWxheUVsYXBzZWQoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENhbmNlbHMgdGhlIG9wZXJhdGlvbiBpZiBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIGV4ZWN1dGVkIG9yIGNhbmNlbGVkLiBUaGVcclxuICAgICAqIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZC5cclxuICAgICAqXHJcbiAgICAgKiBBcyBsb25nIGFzIHRoZSBvcGVyYXRpb24gaGFzIG5vdCB5ZXQgYmVlbiBydW4sIGNhbGxpbmcgY2FuY2VsKCkgcHJvdmlkZXMgYVxyXG4gICAgICogZ3VhcmFudGVlIHRoYXQgdGhlIG9wZXJhdGlvbiB3aWxsIG5vdCBiZSBydW4uXHJcbiAgICAgKi9cclxuICAgIERlbGF5ZWRPcGVyYXRpb24ucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICBpZiAodGhpcy50aW1lckhhbmRsZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNsZWFyVGltZW91dCgpO1xyXG4gICAgICAgICAgICB0aGlzLmRlZmVycmVkLnJlamVjdChuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5DQU5DRUxMRUQsICdPcGVyYXRpb24gY2FuY2VsbGVkJyArIChyZWFzb24gPyAnOiAnICsgcmVhc29uIDogJycpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIERlbGF5ZWRPcGVyYXRpb24ucHJvdG90eXBlLmhhbmRsZURlbGF5RWxhcHNlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKF90aGlzLnRpbWVySGFuZGxlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jbGVhclRpbWVvdXQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5vcCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5kZWZlcnJlZC5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIERlbGF5ZWRPcGVyYXRpb24ucHJvdG90eXBlLmNsZWFyVGltZW91dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy50aW1lckhhbmRsZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92YWxDYWxsYmFjayh0aGlzKTtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJIYW5kbGUpO1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVySGFuZGxlID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlbGF5ZWRPcGVyYXRpb247XHJcbn0oKSk7XHJcbnZhciBBc3luY1F1ZXVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXN5bmNRdWV1ZSgpIHtcclxuICAgICAgICAvLyBUaGUgbGFzdCBwcm9taXNlIGluIHRoZSBxdWV1ZS5cclxuICAgICAgICB0aGlzLnRhaWwgPSBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAvLyBPcGVyYXRpb25zIHNjaGVkdWxlZCB0byBiZSBxdWV1ZWQgaW4gdGhlIGZ1dHVyZS4gT3BlcmF0aW9ucyBhcmVcclxuICAgICAgICAvLyBhdXRvbWF0aWNhbGx5IHJlbW92ZWQgYWZ0ZXIgdGhleSBhcmUgcnVuIG9yIGNhbmNlbGVkLlxyXG4gICAgICAgIHRoaXMuZGVsYXllZE9wZXJhdGlvbnMgPSBbXTtcclxuICAgICAgICAvLyBGbGFnIHNldCB3aGlsZSB0aGVyZSdzIGFuIG91dHN0YW5kaW5nIEFzeW5jUXVldWUgb3BlcmF0aW9uLCB1c2VkIGZvclxyXG4gICAgICAgIC8vIGFzc2VydGlvbiBzYW5pdHktY2hlY2tzLlxyXG4gICAgICAgIHRoaXMub3BlcmF0aW9uSW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgbmV3IG9wZXJhdGlvbiB0byB0aGUgcXVldWUgd2l0aG91dCB3YWl0aW5nIGZvciBpdCB0byBjb21wbGV0ZSAoaS5lLlxyXG4gICAgICogd2UgaWdub3JlIHRoZSBQcm9taXNlIHJlc3VsdCkuXHJcbiAgICAgKi9cclxuICAgIEFzeW5jUXVldWUucHJvdG90eXBlLmVucXVldWVBbmRGb3JnZXQgPSBmdW5jdGlvbiAob3ApIHtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICB0aGlzLmVucXVldWUob3ApO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhIG5ldyBvcGVyYXRpb24gdG8gdGhlIHF1ZXVlLiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWRcclxuICAgICAqIHdoZW4gdGhlIHByb21pc2UgcmV0dXJuZWQgYnkgdGhlIG5ldyBvcGVyYXRpb24gaXMgKHdpdGggaXRzIHZhbHVlKS5cclxuICAgICAqL1xyXG4gICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUuZW5xdWV1ZSA9IGZ1bmN0aW9uIChvcCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlOb3RGYWlsZWQoKTtcclxuICAgICAgICB2YXIgbmV3VGFpbCA9IHRoaXMudGFpbC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMub3BlcmF0aW9uSW5Qcm9ncmVzcyA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybiBvcCgpXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5mYWlsdXJlID0gZXJyb3IkJDE7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vcGVyYXRpb25JblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGVycm9yJCQxLnN0YWNrIHx8IGVycm9yJCQxLm1lc3NhZ2UgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICBlcnJvcignSU5URVJOQUwgVU5IQU5ETEVEIEVSUk9SOiAnLCBtZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIC8vIEVzY2FwZSB0aGUgcHJvbWlzZSBjaGFpbiBhbmQgdGhyb3cgdGhlIGVycm9yIGdsb2JhbGx5IHNvIHRoYXRcclxuICAgICAgICAgICAgICAgIC8vIGUuZy4gYW55IGdsb2JhbCBjcmFzaCByZXBvcnRpbmcgbGlicmFyeSBkZXRlY3RzIGFuZCByZXBvcnRzIGl0LlxyXG4gICAgICAgICAgICAgICAgLy8gKGJ1dCBub3QgZm9yIHNpbXVsYXRlZCBlcnJvcnMgaW4gb3VyIHRlc3RzIHNpbmNlIHRoaXMgYnJlYWtzIG1vY2hhKVxyXG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2UuaW5kZXhPZignRmlyZXN0b3JlIFRlc3QgU2ltdWxhdGVkIEVycm9yJykgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yJCQxO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gUmUtdGhyb3cgdGhlIGVycm9yIHNvIHRoYXQgdGhpcy50YWlsIGJlY29tZXMgYSByZWplY3RlZCBQcm9taXNlIGFuZFxyXG4gICAgICAgICAgICAgICAgLy8gYWxsIGZ1cnRoZXIgYXR0ZW1wdHMgdG8gY2hhaW4gKHZpYSAudGhlbikgd2lsbCBqdXN0IHNob3J0LWNpcmN1aXRcclxuICAgICAgICAgICAgICAgIC8vIGFuZCByZXR1cm4gdGhlIHJlamVjdGVkIFByb21pc2UuXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvciQkMTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLm9wZXJhdGlvbkluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMudGFpbCA9IG5ld1RhaWw7XHJcbiAgICAgICAgcmV0dXJuIG5ld1RhaWw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTY2hlZHVsZXMgYW4gb3BlcmF0aW9uIHRvIGJlIHF1ZXVlZCBvbiB0aGUgQXN5bmNRdWV1ZSBvbmNlIHRoZSBzcGVjaWZpZWRcclxuICAgICAqIGBkZWxheU1zYCBoYXMgZWxhcHNlZC4gVGhlIHJldHVybmVkIENhbmNlbGFibGVQcm9taXNlIGNhbiBiZSB1c2VkIHRvIGNhbmNlbFxyXG4gICAgICogdGhlIG9wZXJhdGlvbiBwcmlvciB0byBpdHMgcnVubmluZy5cclxuICAgICAqL1xyXG4gICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUuZW5xdWV1ZUFmdGVyRGVsYXkgPSBmdW5jdGlvbiAodGltZXJJZCwgZGVsYXlNcywgb3ApIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMudmVyaWZ5Tm90RmFpbGVkKCk7XHJcbiAgICAgICAgYXNzZXJ0KGRlbGF5TXMgPj0gMCwgXCJBdHRlbXB0ZWQgdG8gc2NoZWR1bGUgYW4gb3BlcmF0aW9uIHdpdGggYSBuZWdhdGl2ZSBkZWxheSBvZiBcIiArIGRlbGF5TXMpO1xyXG4gICAgICAgIC8vIFdoaWxlIG5vdCBuZWNlc3NhcmlseSBoYXJtZnVsLCB3ZSBjdXJyZW50bHkgZG9uJ3QgZXhwZWN0IHRvIGhhdmUgbXVsdGlwbGVcclxuICAgICAgICAvLyBvcHMgd2l0aCB0aGUgc2FtZSB0aW1lciBpZCBpbiB0aGUgcXVldWUsIHNvIGRlZmVuc2l2ZWx5IHJlamVjdCB0aGVtLlxyXG4gICAgICAgIGFzc2VydCghdGhpcy5jb250YWluc0RlbGF5ZWRPcGVyYXRpb24odGltZXJJZCksIFwiQXR0ZW1wdGVkIHRvIHNjaGVkdWxlIG11bHRpcGxlIG9wZXJhdGlvbnMgd2l0aCB0aW1lciBpZCBcIiArIHRpbWVySWQgKyBcIi5cIik7XHJcbiAgICAgICAgdmFyIGRlbGF5ZWRPcCA9IERlbGF5ZWRPcGVyYXRpb24uY3JlYXRlQW5kU2NoZWR1bGUodGhpcywgdGltZXJJZCwgZGVsYXlNcywgb3AsIGZ1bmN0aW9uIChvcCkgeyByZXR1cm4gX3RoaXMucmVtb3ZlRGVsYXllZE9wZXJhdGlvbihvcCk7IH0pO1xyXG4gICAgICAgIHRoaXMuZGVsYXllZE9wZXJhdGlvbnMucHVzaChkZWxheWVkT3ApO1xyXG4gICAgICAgIHJldHVybiBkZWxheWVkT3A7XHJcbiAgICB9O1xyXG4gICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUudmVyaWZ5Tm90RmFpbGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmZhaWx1cmUpIHtcclxuICAgICAgICAgICAgZmFpbCgnQXN5bmNRdWV1ZSBpcyBhbHJlYWR5IGZhaWxlZDogJyArXHJcbiAgICAgICAgICAgICAgICAodGhpcy5mYWlsdXJlLnN0YWNrIHx8IHRoaXMuZmFpbHVyZS5tZXNzYWdlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVmVyaWZpZXMgdGhlcmUncyBhbiBvcGVyYXRpb24gY3VycmVudGx5IGluLXByb2dyZXNzIG9uIHRoZSBBc3luY1F1ZXVlLlxyXG4gICAgICogVW5mb3J0dW5hdGVseSB3ZSBjYW4ndCB2ZXJpZnkgdGhhdCB0aGUgcnVubmluZyBjb2RlIGlzIGluIHRoZSBwcm9taXNlIGNoYWluXHJcbiAgICAgKiBvZiB0aGF0IG9wZXJhdGlvbiwgc28gdGhpcyBpc24ndCBhIGZvb2xwcm9vZiBjaGVjaywgYnV0IGl0IHNob3VsZCBiZSBlbm91Z2hcclxuICAgICAqIHRvIGNhdGNoIHNvbWUgYnVncy5cclxuICAgICAqL1xyXG4gICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUudmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5vcGVyYXRpb25JblByb2dyZXNzLCAndmVyaWZ5T3BJblByb2dyZXNzKCkgY2FsbGVkIHdoZW4gbm8gb3AgaW4gcHJvZ3Jlc3Mgb24gdGhpcyBxdWV1ZS4nKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFdhaXRzIHVudGlsIGFsbCBjdXJyZW50bHkgcXVldWVkIHRhc2tzIGFyZSBmaW5pc2hlZCBleGVjdXRpbmcuIERlbGF5ZWRcclxuICAgICAqIG9wZXJhdGlvbnMgYXJlIG5vdCBydW4uXHJcbiAgICAgKi9cclxuICAgIEFzeW5jUXVldWUucHJvdG90eXBlLmRyYWluID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVucXVldWUoZnVuY3Rpb24gKCkgeyByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogRm9yIFRlc3RzOiBEZXRlcm1pbmUgaWYgYSBkZWxheWVkIG9wZXJhdGlvbiB3aXRoIGEgcGFydGljdWxhciBUaW1lcklkXHJcbiAgICAgKiBleGlzdHMuXHJcbiAgICAgKi9cclxuICAgIEFzeW5jUXVldWUucHJvdG90eXBlLmNvbnRhaW5zRGVsYXllZE9wZXJhdGlvbiA9IGZ1bmN0aW9uICh0aW1lcklkKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZGVsYXllZE9wZXJhdGlvbnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvcCA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKG9wLnRpbWVySWQgPT09IHRpbWVySWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEZvciBUZXN0czogUnVucyBzb21lIG9yIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMgZWFybHkuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGxhc3RUaW1lcklkIERlbGF5ZWQgb3BlcmF0aW9ucyB1cCB0byBhbmQgaW5jbHVkaW5nIHRoaXMgVGltZXJJZCB3aWxsXHJcbiAgICAgKiAgYmUgZHJhaW5lZC4gVGhyb3dzIGlmIG5vIHN1Y2ggb3BlcmF0aW9uIGV4aXN0cy4gUGFzcyBUaW1lcklkLkFsbCB0byBydW5cclxuICAgICAqICBhbGwgZGVsYXllZCBvcGVyYXRpb25zLlxyXG4gICAgICogQHJldHVybnMgYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgb25jZSBhbGwgb3BlcmF0aW9ucyBoYXZlIGJlZW4gcnVuLlxyXG4gICAgICovXHJcbiAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS5ydW5EZWxheWVkT3BlcmF0aW9uc0Vhcmx5ID0gZnVuY3Rpb24gKGxhc3RUaW1lcklkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBOb3RlIHRoYXQgZHJhaW5pbmcgbWF5IGdlbmVyYXRlIG1vcmUgZGVsYXllZCBvcHMsIHNvIHdlIGRvIHRoYXQgZmlyc3QuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZHJhaW4oKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KGxhc3RUaW1lcklkID09PSBUaW1lcklkLkFsbCB8fFxyXG4gICAgICAgICAgICAgICAgX3RoaXMuY29udGFpbnNEZWxheWVkT3BlcmF0aW9uKGxhc3RUaW1lcklkKSwgXCJBdHRlbXB0ZWQgdG8gZHJhaW4gdG8gbWlzc2luZyBvcGVyYXRpb24gXCIgKyBsYXN0VGltZXJJZCk7XHJcbiAgICAgICAgICAgIC8vIFJ1biBvcHMgaW4gdGhlIHNhbWUgb3JkZXIgdGhleSdkIHJ1biBpZiB0aGV5IHJhbiBuYXR1cmFsbHkuXHJcbiAgICAgICAgICAgIF90aGlzLmRlbGF5ZWRPcGVyYXRpb25zLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEudGFyZ2V0VGltZU1zIC0gYi50YXJnZXRUaW1lTXM7IH0pO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gX3RoaXMuZGVsYXllZE9wZXJhdGlvbnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3AgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBvcC5za2lwRGVsYXkoKTtcclxuICAgICAgICAgICAgICAgIGlmIChsYXN0VGltZXJJZCAhPT0gVGltZXJJZC5BbGwgJiYgb3AudGltZXJJZCA9PT0gbGFzdFRpbWVySWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZHJhaW4oKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogQ2FsbGVkIG9uY2UgYSBEZWxheWVkT3BlcmF0aW9uIGlzIHJ1biBvciBjYW5jZWxlZC4gKi9cclxuICAgIEFzeW5jUXVldWUucHJvdG90eXBlLnJlbW92ZURlbGF5ZWRPcGVyYXRpb24gPSBmdW5jdGlvbiAob3ApIHtcclxuICAgICAgICAvLyBOT1RFOiBpbmRleE9mIC8gc2xpY2UgYXJlIE8obiksIGJ1dCBkZWxheWVkT3BlcmF0aW9ucyBpcyBleHBlY3RlZCB0byBiZSBzbWFsbC5cclxuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmRlbGF5ZWRPcGVyYXRpb25zLmluZGV4T2Yob3ApO1xyXG4gICAgICAgIGFzc2VydChpbmRleCA+PSAwLCAnRGVsYXllZCBvcGVyYXRpb24gbm90IGZvdW5kLicpO1xyXG4gICAgICAgIHRoaXMuZGVsYXllZE9wZXJhdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQXN5bmNRdWV1ZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBlc2NhcGVDaGFyID0gJ1xcdTAwMDEnO1xyXG52YXIgZW5jb2RlZFNlcGFyYXRvckNoYXIgPSAnXFx1MDAwMSc7XHJcbnZhciBlbmNvZGVkTnVsID0gJ1xcdTAwMTAnO1xyXG52YXIgZW5jb2RlZEVzY2FwZSA9ICdcXHUwMDExJztcclxuLyoqXHJcbiAqIEVuY29kZXMgYSByZXNvdXJjZSBwYXRoIGludG8gYSBJbmRleGVkRGItY29tcGF0aWJsZSBzdHJpbmcgZm9ybS5cclxuICovXHJcbmZ1bmN0aW9uIGVuY29kZShwYXRoKSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gJyc7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhdGgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gZW5jb2RlU2VwYXJhdG9yKHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlc3VsdCA9IGVuY29kZVNlZ21lbnQocGF0aC5nZXQoaSksIHJlc3VsdCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZW5jb2RlU2VwYXJhdG9yKHJlc3VsdCk7XHJcbn1cclxuLyoqIEVuY29kZXMgYSBzaW5nbGUgc2VnbWVudCBvZiBhIHJlc291cmNlIHBhdGggaW50byB0aGUgZ2l2ZW4gcmVzdWx0ICovXHJcbmZ1bmN0aW9uIGVuY29kZVNlZ21lbnQoc2VnbWVudCwgcmVzdWx0QnVmKSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gcmVzdWx0QnVmO1xyXG4gICAgdmFyIGxlbmd0aCA9IHNlZ21lbnQubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBjID0gc2VnbWVudC5jaGFyQXQoaSk7XHJcbiAgICAgICAgc3dpdGNoIChjKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ1xcMCc6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgKz0gZXNjYXBlQ2hhciArIGVuY29kZWROdWw7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBlc2NhcGVDaGFyOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IGVzY2FwZUNoYXIgKyBlbmNvZGVkRXNjYXBlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgKz0gYztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbi8qKiBFbmNvZGVzIGEgcGF0aCBzZXBhcmF0b3IgaW50byB0aGUgZ2l2ZW4gcmVzdWx0ICovXHJcbmZ1bmN0aW9uIGVuY29kZVNlcGFyYXRvcihyZXN1bHQpIHtcclxuICAgIHJldHVybiByZXN1bHQgKyBlc2NhcGVDaGFyICsgZW5jb2RlZFNlcGFyYXRvckNoYXI7XHJcbn1cclxuLyoqXHJcbiAqIERlY29kZXMgdGhlIGdpdmVuIEluZGV4ZWREYi1jb21wYXRpYmxlIHN0cmluZyBmb3JtIG9mIGEgcmVzb3VyY2UgcGF0aCBpbnRvXHJcbiAqIGEgUmVzb3VyY2VQYXRoIGluc3RhbmNlLiBOb3RlIHRoYXQgdGhpcyBtZXRob2QgaXMgbm90IHN1aXRhYmxlIGZvciB1c2Ugd2l0aFxyXG4gKiBkZWNvZGluZyByZXNvdXJjZSBuYW1lcyBmcm9tIHRoZSBzZXJ2ZXI7IHRob3NlIGFyZSBPbmUgUGxhdGZvcm0gZm9ybWF0XHJcbiAqIHN0cmluZ3MuXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWNvZGUkMShwYXRoKSB7XHJcbiAgICAvLyBFdmVudCB0aGUgZW1wdHkgcGF0aCBtdXN0IGVuY29kZSBhcyBhIHBhdGggb2YgYXQgbGVhc3QgbGVuZ3RoIDIuIEEgcGF0aFxyXG4gICAgLy8gd2l0aCBleGFjdGx5IDIgbXVzdCBiZSB0aGUgZW1wdHkgcGF0aC5cclxuICAgIHZhciBsZW5ndGggPSBwYXRoLmxlbmd0aDtcclxuICAgIGFzc2VydChsZW5ndGggPj0gMiwgJ0ludmFsaWQgcGF0aCAnICsgcGF0aCk7XHJcbiAgICBpZiAobGVuZ3RoID09PSAyKSB7XHJcbiAgICAgICAgYXNzZXJ0KHBhdGguY2hhckF0KDApID09PSBlc2NhcGVDaGFyICYmIHBhdGguY2hhckF0KDEpID09PSBlbmNvZGVkU2VwYXJhdG9yQ2hhciwgJ05vbi1lbXB0eSBwYXRoICcgKyBwYXRoICsgJyBoYWQgbGVuZ3RoIDInKTtcclxuICAgICAgICByZXR1cm4gUmVzb3VyY2VQYXRoLkVNUFRZX1BBVEg7XHJcbiAgICB9XHJcbiAgICAvLyBFc2NhcGUgY2hhcmFjdGVycyBjYW5ub3QgZXhpc3QgcGFzdCB0aGUgc2Vjb25kLXRvLWxhc3QgcG9zaXRpb24gaW4gdGhlXHJcbiAgICAvLyBzb3VyY2UgdmFsdWUuXHJcbiAgICB2YXIgbGFzdFJlYXNvbmFibGVFc2NhcGVJbmRleCA9IGxlbmd0aCAtIDI7XHJcbiAgICB2YXIgc2VnbWVudHMgPSBbXTtcclxuICAgIHZhciBzZWdtZW50QnVpbGRlciA9ICcnO1xyXG4gICAgZm9yICh2YXIgc3RhcnQgPSAwOyBzdGFydCA8IGxlbmd0aDspIHtcclxuICAgICAgICAvLyBUaGUgbGFzdCB0d28gY2hhcmFjdGVycyBvZiBhIHZhbGlkIGVuY29kZWQgcGF0aCBtdXN0IGJlIGEgc2VwYXJhdG9yLCBzb1xyXG4gICAgICAgIC8vIHRoZXJlIG11c3QgYmUgYW4gZW5kIHRvIHRoaXMgc2VnbWVudC5cclxuICAgICAgICB2YXIgZW5kID0gcGF0aC5pbmRleE9mKGVzY2FwZUNoYXIsIHN0YXJ0KTtcclxuICAgICAgICBpZiAoZW5kIDwgMCB8fCBlbmQgPiBsYXN0UmVhc29uYWJsZUVzY2FwZUluZGV4KSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ0ludmFsaWQgZW5jb2RlZCByZXNvdXJjZSBwYXRoOiBcIicgKyBwYXRoICsgJ1wiJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuZXh0ID0gcGF0aC5jaGFyQXQoZW5kICsgMSk7XHJcbiAgICAgICAgc3dpdGNoIChuZXh0KSB7XHJcbiAgICAgICAgICAgIGNhc2UgZW5jb2RlZFNlcGFyYXRvckNoYXI6XHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFBpZWNlID0gcGF0aC5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VnbWVudCA9IHZvaWQgMDtcclxuICAgICAgICAgICAgICAgIGlmIChzZWdtZW50QnVpbGRlci5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBBdm9pZCBjb3B5aW5nIGZvciB0aGUgY29tbW9uIGNhc2Ugb2YgYSBzZWdtZW50IHRoYXQgZXhjbHVkZXMgXFwwXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYW5kIFxcMDAxXHJcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudCA9IGN1cnJlbnRQaWVjZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlZ21lbnRCdWlsZGVyICs9IGN1cnJlbnRQaWVjZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWdtZW50ID0gc2VnbWVudEJ1aWxkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudEJ1aWxkZXIgPSAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlZ21lbnRzLnB1c2goc2VnbWVudCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBlbmNvZGVkTnVsOlxyXG4gICAgICAgICAgICAgICAgc2VnbWVudEJ1aWxkZXIgKz0gcGF0aC5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7XHJcbiAgICAgICAgICAgICAgICBzZWdtZW50QnVpbGRlciArPSAnXFwwJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGVuY29kZWRFc2NhcGU6XHJcbiAgICAgICAgICAgICAgICAvLyBUaGUgZXNjYXBlIGNoYXJhY3RlciBjYW4gYmUgdXNlZCBpbiB0aGUgb3V0cHV0IHRvIGVuY29kZSBpdHNlbGYuXHJcbiAgICAgICAgICAgICAgICBzZWdtZW50QnVpbGRlciArPSBwYXRoLnN1YnN0cmluZyhzdGFydCwgZW5kICsgMSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGZhaWwoJ0ludmFsaWQgZW5jb2RlZCByZXNvdXJjZSBwYXRoOiBcIicgKyBwYXRoICsgJ1wiJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN0YXJ0ID0gZW5kICsgMjtcclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUmVzb3VyY2VQYXRoKHNlZ21lbnRzKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIEJBVENISURfVU5LTk9XTiA9IC0xO1xyXG4vKipcclxuICogQSBiYXRjaCBvZiBtdXRhdGlvbnMgdGhhdCB3aWxsIGJlIHNlbnQgYXMgb25lIHVuaXQgdG8gdGhlIGJhY2tlbmQuXHJcbiAqL1xyXG52YXIgTXV0YXRpb25CYXRjaCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE11dGF0aW9uQmF0Y2goYmF0Y2hJZCwgbG9jYWxXcml0ZVRpbWUsIG11dGF0aW9ucykge1xyXG4gICAgICAgIHRoaXMuYmF0Y2hJZCA9IGJhdGNoSWQ7XHJcbiAgICAgICAgdGhpcy5sb2NhbFdyaXRlVGltZSA9IGxvY2FsV3JpdGVUaW1lO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25zID0gbXV0YXRpb25zO1xyXG4gICAgICAgIGFzc2VydChtdXRhdGlvbnMubGVuZ3RoID4gMCwgJ0Nhbm5vdCBjcmVhdGUgYW4gZW1wdHkgbXV0YXRpb24gYmF0Y2gnKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQXBwbGllcyBhbGwgdGhlIG11dGF0aW9ucyBpbiB0aGlzIE11dGF0aW9uQmF0Y2ggdG8gdGhlIHNwZWNpZmllZCBkb2N1bWVudFxyXG4gICAgICogdG8gY3JlYXRlIGEgbmV3IHJlbW90ZSBkb2N1bWVudFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkb2NLZXkgVGhlIGtleSBvZiB0aGUgZG9jdW1lbnQgdG8gYXBwbHkgbXV0YXRpb25zIHRvLlxyXG4gICAgICogQHBhcmFtIG1heWJlRG9jIFRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXHJcbiAgICAgKiBAcGFyYW0gYmF0Y2hSZXN1bHQgVGhlIHJlc3VsdCBvZiBhcHBseWluZyB0aGUgTXV0YXRpb25CYXRjaCB0byB0aGVcclxuICAgICAqIGJhY2tlbmQuXHJcbiAgICAgKi9cclxuICAgIE11dGF0aW9uQmF0Y2gucHJvdG90eXBlLmFwcGx5VG9SZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChkb2NLZXksIG1heWJlRG9jLCBiYXRjaFJlc3VsdCkge1xyXG4gICAgICAgIGlmIChtYXliZURvYykge1xyXG4gICAgICAgICAgICBhc3NlcnQobWF5YmVEb2Mua2V5LmlzRXF1YWwoZG9jS2V5KSwgXCJhcHBseVRvUmVtb3RlRG9jdW1lbnQ6IGtleSBcIiArIGRvY0tleSArIFwiIHNob3VsZCBtYXRjaCBtYXliZURvYyBrZXlcXG4gICAgICAgIFwiICsgbWF5YmVEb2Mua2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG11dGF0aW9uUmVzdWx0cyA9IGJhdGNoUmVzdWx0Lm11dGF0aW9uUmVzdWx0cztcclxuICAgICAgICBhc3NlcnQobXV0YXRpb25SZXN1bHRzLmxlbmd0aCA9PT0gdGhpcy5tdXRhdGlvbnMubGVuZ3RoLCBcIk1pc21hdGNoIGJldHdlZW4gbXV0YXRpb25zIGxlbmd0aFxcbiAgICAgIChcIiArIHRoaXMubXV0YXRpb25zLmxlbmd0aCArIFwiKSBhbmQgbXV0YXRpb24gcmVzdWx0cyBsZW5ndGhcXG4gICAgICAoXCIgKyBtdXRhdGlvblJlc3VsdHMubGVuZ3RoICsgXCIpLlwiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubXV0YXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBtdXRhdGlvbiA9IHRoaXMubXV0YXRpb25zW2ldO1xyXG4gICAgICAgICAgICBpZiAobXV0YXRpb24ua2V5LmlzRXF1YWwoZG9jS2V5KSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG11dGF0aW9uUmVzdWx0ID0gbXV0YXRpb25SZXN1bHRzW2ldO1xyXG4gICAgICAgICAgICAgICAgbWF5YmVEb2MgPSBtdXRhdGlvbi5hcHBseVRvUmVtb3RlRG9jdW1lbnQobWF5YmVEb2MsIG11dGF0aW9uUmVzdWx0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWF5YmVEb2M7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50IGdpdmVuIGFsbCB0aGUgbXV0YXRpb25zIGluIHRoaXNcclxuICAgICAqIGJhdGNoLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkb2NLZXkgVGhlIGtleSBvZiB0aGUgZG9jdW1lbnQgdG8gYXBwbHkgbXV0YXRpb25zIHRvLlxyXG4gICAgICogQHBhcmFtIG1heWJlRG9jIFRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXHJcbiAgICAgKi9cclxuICAgIE11dGF0aW9uQmF0Y2gucHJvdG90eXBlLmFwcGx5VG9Mb2NhbFZpZXcgPSBmdW5jdGlvbiAoZG9jS2V5LCBtYXliZURvYykge1xyXG4gICAgICAgIGlmIChtYXliZURvYykge1xyXG4gICAgICAgICAgICBhc3NlcnQobWF5YmVEb2Mua2V5LmlzRXF1YWwoZG9jS2V5KSwgXCJhcHBseVRvTG9jYWxEb2N1bWVudDoga2V5IFwiICsgZG9jS2V5ICsgXCIgc2hvdWxkIG1hdGNoIG1heWJlRG9jIGtleVxcbiAgICAgICAgXCIgKyBtYXliZURvYy5rZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYmFzZURvYyA9IG1heWJlRG9jO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tdXRhdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIG11dGF0aW9uID0gdGhpcy5tdXRhdGlvbnNbaV07XHJcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbi5rZXkuaXNFcXVhbChkb2NLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBtYXliZURvYyA9IG11dGF0aW9uLmFwcGx5VG9Mb2NhbFZpZXcobWF5YmVEb2MsIGJhc2VEb2MsIHRoaXMubG9jYWxXcml0ZVRpbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtYXliZURvYztcclxuICAgIH07XHJcbiAgICBNdXRhdGlvbkJhdGNoLnByb3RvdHlwZS5rZXlzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBrZXlTZXQgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLm11dGF0aW9uczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG11dGF0aW9uID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBrZXlTZXQgPSBrZXlTZXQuYWRkKG11dGF0aW9uLmtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBrZXlTZXQ7XHJcbiAgICB9O1xyXG4gICAgTXV0YXRpb25CYXRjaC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5iYXRjaElkID09PSBvdGhlci5iYXRjaElkICYmXHJcbiAgICAgICAgICAgIGFycmF5RXF1YWxzKHRoaXMubXV0YXRpb25zLCBvdGhlci5tdXRhdGlvbnMpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTXV0YXRpb25CYXRjaDtcclxufSgpKTtcclxuLyoqIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSBtdXRhdGlvbiBiYXRjaCB0byB0aGUgYmFja2VuZC4gKi9cclxudmFyIE11dGF0aW9uQmF0Y2hSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNdXRhdGlvbkJhdGNoUmVzdWx0KGJhdGNoLCBjb21taXRWZXJzaW9uLCBtdXRhdGlvblJlc3VsdHMsIHN0cmVhbVRva2VuLCBcclxuICAgIC8qKlxyXG4gICAgICogQSBwcmUtY29tcHV0ZWQgbWFwcGluZyBmcm9tIGVhY2ggbXV0YXRlZCBkb2N1bWVudCB0byB0aGUgcmVzdWx0aW5nXHJcbiAgICAgKiB2ZXJzaW9uLlxyXG4gICAgICovXHJcbiAgICBkb2NWZXJzaW9ucykge1xyXG4gICAgICAgIHRoaXMuYmF0Y2ggPSBiYXRjaDtcclxuICAgICAgICB0aGlzLmNvbW1pdFZlcnNpb24gPSBjb21taXRWZXJzaW9uO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXN1bHRzID0gbXV0YXRpb25SZXN1bHRzO1xyXG4gICAgICAgIHRoaXMuc3RyZWFtVG9rZW4gPSBzdHJlYW1Ub2tlbjtcclxuICAgICAgICB0aGlzLmRvY1ZlcnNpb25zID0gZG9jVmVyc2lvbnM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBuZXcgTXV0YXRpb25CYXRjaFJlc3VsdCBmb3IgdGhlIGdpdmVuIGJhdGNoIGFuZCByZXN1bHRzLiBUaGVyZVxyXG4gICAgICogbXVzdCBiZSBvbmUgcmVzdWx0IGZvciBlYWNoIG11dGF0aW9uIGluIHRoZSBiYXRjaC4gVGhpcyBzdGF0aWMgZmFjdG9yeVxyXG4gICAgICogY2FjaGVzIGEgZG9jdW1lbnQ9PnZlcnNpb24gbWFwcGluZyAoZG9jVmVyc2lvbnMpLlxyXG4gICAgICovXHJcbiAgICBNdXRhdGlvbkJhdGNoUmVzdWx0LmZyb20gPSBmdW5jdGlvbiAoYmF0Y2gsIGNvbW1pdFZlcnNpb24sIHJlc3VsdHMsIHN0cmVhbVRva2VuKSB7XHJcbiAgICAgICAgYXNzZXJ0KGJhdGNoLm11dGF0aW9ucy5sZW5ndGggPT09IHJlc3VsdHMubGVuZ3RoLCAnTXV0YXRpb25zIHNlbnQgJyArXHJcbiAgICAgICAgICAgIGJhdGNoLm11dGF0aW9ucy5sZW5ndGggK1xyXG4gICAgICAgICAgICAnIG11c3QgZXF1YWwgcmVzdWx0cyByZWNlaXZlZCAnICtcclxuICAgICAgICAgICAgcmVzdWx0cy5sZW5ndGgpO1xyXG4gICAgICAgIHZhciB2ZXJzaW9uTWFwID0gZG9jdW1lbnRWZXJzaW9uTWFwKCk7XHJcbiAgICAgICAgdmFyIG11dGF0aW9ucyA9IGJhdGNoLm11dGF0aW9ucztcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG11dGF0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2ZXJzaW9uTWFwID0gdmVyc2lvbk1hcC5pbnNlcnQobXV0YXRpb25zW2ldLmtleSwgcmVzdWx0c1tpXS52ZXJzaW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNdXRhdGlvbkJhdGNoUmVzdWx0KGJhdGNoLCBjb21taXRWZXJzaW9uLCByZXN1bHRzLCBzdHJlYW1Ub2tlbiwgdmVyc2lvbk1hcCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE11dGF0aW9uQmF0Y2hSZXN1bHQ7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUGVyc2lzdGVuY2VQcm9taXNlPD4gaXMgZXNzZW50aWFsbHkgYSByZS1pbXBsZW1lbnRhdGlvbiBvZiBQcm9taXNlPD4gZXhjZXB0XHJcbiAqIGl0IGhhcyBhIC5uZXh0KCkgbWV0aG9kIGluc3RlYWQgb2YgLnRoZW4oKSBhbmQgLm5leHQoKSBhbmQgLmNhdGNoKCkgY2FsbGJhY2tzXHJcbiAqIGFyZSBleGVjdXRlZCBzeW5jaHJvbm91c2x5IHdoZW4gYSBQZXJzaXN0ZW5jZVByb21pc2UgcmVzb2x2ZXMgcmF0aGVyIHRoYW5cclxuICogYXN5bmNocm9ub3VzbHkgKFByb21pc2U8PiBpbXBsZW1lbnRhdGlvbnMgdXNlIHNldEltbWVkaWF0ZSgpIG9yIHNpbWlsYXIpLlxyXG4gKlxyXG4gKiBUaGlzIGlzIG5lY2Vzc2FyeSB0byBpbnRlcm9wZXJhdGUgd2l0aCBJbmRleGVkREIgd2hpY2ggd2lsbCBhdXRvbWF0aWNhbGx5XHJcbiAqIGNvbW1pdCB0cmFuc2FjdGlvbnMgaWYgY29udHJvbCBpcyByZXR1cm5lZCB0byB0aGUgZXZlbnQgbG9vcCB3aXRob3V0XHJcbiAqIHN5bmNocm9ub3VzbHkgaW5pdGlhdGluZyBhbm90aGVyIG9wZXJhdGlvbiBvbiB0aGUgdHJhbnNhY3Rpb24uXHJcbiAqXHJcbiAqIE5PVEU6IC50aGVuKCkgYW5kIC5jYXRjaCgpIG9ubHkgYWxsb3cgYSBzaW5nbGUgY29uc3VtZXIsIHVubGlrZSBub3JtYWxcclxuICogUHJvbWlzZXMuXHJcbiAqL1xyXG52YXIgUGVyc2lzdGVuY2VQcm9taXNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGVyc2lzdGVuY2VQcm9taXNlKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBOT1RFOiBuZXh0L2NhdGNoQ2FsbGJhY2sgd2lsbCBhbHdheXMgcG9pbnQgdG8gb3VyIG93biB3cmFwcGVyIGZ1bmN0aW9ucyxcclxuICAgICAgICAvLyBub3QgdGhlIHVzZXIncyByYXcgbmV4dCgpIG9yIGNhdGNoKCkgY2FsbGJhY2tzLlxyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgQWNjZXB0IGFueSByZXN1bHQgdHlwZSBmb3IgdGhlIG5leHQgY2FsbCBpbiB0aGUgUHJvbWlzZSBjaGFpbi5cclxuICAgICAgICB0aGlzLm5leHRDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBBY2NlcHQgYW55IHJlc3VsdCB0eXBlIGZvciB0aGUgZXJyb3IgaGFuZGxlci5cclxuICAgICAgICB0aGlzLmNhdGNoQ2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIC8vIFdoZW4gdGhlIG9wZXJhdGlvbiByZXNvbHZlcywgd2UnbGwgc2V0IHJlc3VsdCBvciBlcnJvciBhbmQgbWFyayBpc0RvbmUuXHJcbiAgICAgICAgdGhpcy5yZXN1bHQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5lcnJvciA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLmlzRG9uZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vIFNldCB0byB0cnVlIHdoZW4gLnRoZW4oKSBvciAuY2F0Y2goKSBhcmUgY2FsbGVkIGFuZCBwcmV2ZW50cyBhZGRpdGlvbmFsXHJcbiAgICAgICAgLy8gY2hhaW5pbmcuXHJcbiAgICAgICAgdGhpcy5jYWxsYmFja0F0dGFjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgY2FsbGJhY2soZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmlzRG9uZSA9IHRydWU7XHJcbiAgICAgICAgICAgIF90aGlzLnJlc3VsdCA9IHZhbHVlO1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMubmV4dENhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB2YWx1ZSBzaG91bGQgYmUgZGVmaW5lZCB1bmxlc3MgVCBpcyBWb2lkLCBidXQgd2UgY2FuJ3QgZXhwcmVzc1xyXG4gICAgICAgICAgICAgICAgLy8gdGhhdCBpbiB0aGUgdHlwZSBzeXN0ZW0uXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5uZXh0Q2FsbGJhY2sodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmlzRG9uZSA9IHRydWU7XHJcbiAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3I7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5jYXRjaENhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jYXRjaENhbGxiYWNrKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLnByb3RvdHlwZS5jYXRjaCA9IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5leHQodW5kZWZpbmVkLCBmbik7XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKG5leHRGbiwgY2F0Y2hGbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tBdHRhY2hlZCkge1xyXG4gICAgICAgICAgICBmYWlsKCdDYWxsZWQgbmV4dCgpIG9yIGNhdGNoKCkgdHdpY2UgZm9yIFBlcnNpc3RlbmNlUHJvbWlzZScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLmlzRG9uZSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLndyYXBTdWNjZXNzKG5leHRGbiwgdGhpcy5yZXN1bHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMud3JhcEZhaWx1cmUoY2F0Y2hGbiwgdGhpcy5lcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLm5leHRDYWxsYmFjayA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLndyYXBTdWNjZXNzKG5leHRGbiwgdmFsdWUpLm5leHQocmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jYXRjaENhbGxiYWNrID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMud3JhcEZhaWx1cmUoY2F0Y2hGbiwgZXJyb3IpLm5leHQocmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2UucHJvdG90eXBlLnRvUHJvbWlzZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIF90aGlzLm5leHQocmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2UucHJvdG90eXBlLndyYXBVc2VyRnVuY3Rpb24gPSBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gZm4oKTtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVqZWN0KGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2UucHJvdG90eXBlLndyYXBTdWNjZXNzID0gZnVuY3Rpb24gKG5leHRGbiwgdmFsdWUpIHtcclxuICAgICAgICBpZiAobmV4dEZuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndyYXBVc2VyRnVuY3Rpb24oZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV4dEZuKHZhbHVlKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBJZiB0aGVyZSdzIG5vIG5leHRGbiwgdGhlbiBSIG11c3QgYmUgdGhlIHNhbWUgYXMgVCBidXQgd2VcclxuICAgICAgICAgICAgLy8gY2FuJ3QgZXhwcmVzcyB0aGF0IGluIHRoZSB0eXBlIHN5c3RlbS5cclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2UucHJvdG90eXBlLndyYXBGYWlsdXJlID0gZnVuY3Rpb24gKGNhdGNoRm4sIGVycm9yKSB7XHJcbiAgICAgICAgaWYgKGNhdGNoRm4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMud3JhcFVzZXJGdW5jdGlvbihmdW5jdGlvbiAoKSB7IHJldHVybiBjYXRjaEZuKGVycm9yKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlID0gZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5yZWplY3QgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IgPSBmdW5jdGlvbiAoXHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IEFjY2VwdCBhbGwgUHJvbWlzZSB0eXBlcyBpbiB3YWl0Rm9yKCkuXHJcbiAgICBhbGwpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIHZhciBleHBlY3RlZENvdW50ID0gMDtcclxuICAgICAgICAgICAgdmFyIHJlc29sdmVkQ291bnQgPSAwO1xyXG4gICAgICAgICAgICB2YXIgZG9uZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBhbGwuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgKytleHBlY3RlZENvdW50O1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICArK3Jlc29sdmVkQ291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvbmUgJiYgcmVzb2x2ZWRDb3VudCA9PT0gZXhwZWN0ZWRDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikgeyByZXR1cm4gcmVqZWN0KGVycik7IH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZG9uZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChyZXNvbHZlZENvdW50ID09PSBleHBlY3RlZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEdpdmVuIGFuIGFycmF5IG9mIHByZWRpY2F0ZSBmdW5jdGlvbnMgdGhhdCBhc3luY2hyb25vdXNseSBldmFsdWF0ZSB0byBhXHJcbiAgICAgKiBib29sZWFuLCBpbXBsZW1lbnRzIGEgc2hvcnQtY2lyY3VpdGluZyBgb3JgIGJldHdlZW4gdGhlIHJlc3VsdHMuIFByZWRpY2F0ZXNcclxuICAgICAqIHdpbGwgYmUgZXZhbHVhdGVkIHVudGlsIG9uZSBvZiB0aGVtIHJldHVybnMgYHRydWVgLCB0aGVuIHN0b3AuIFRoZSBmaW5hbFxyXG4gICAgICogcmVzdWx0IHdpbGwgYmUgd2hldGhlciBhbnkgb2YgdGhlbSByZXR1cm5lZCBgdHJ1ZWAuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5vciA9IGZ1bmN0aW9uIChwcmVkaWNhdGVzKSB7XHJcbiAgICAgICAgdmFyIHAgPSBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XHJcbiAgICAgICAgICAgIHAgPSBwLm5leHQoZnVuY3Rpb24gKGlzVHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzVHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShpc1RydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZWRpY2F0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcHJlZGljYXRlc18xID0gcHJlZGljYXRlczsgX2kgPCBwcmVkaWNhdGVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwcmVkaWNhdGUgPSBwcmVkaWNhdGVzXzFbX2ldO1xyXG4gICAgICAgICAgICBfbG9vcF8xKHByZWRpY2F0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogR2l2ZW4gYW4gaXRlcmFibGUsIGNhbGwgdGhlIGdpdmVuIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCBpbiB0aGVcclxuICAgICAqIGNvbGxlY3Rpb24gYW5kIHdhaXQgZm9yIGFsbCBvZiB0aGUgcmVzdWx0aW5nIGNvbmN1cnJlbnQgUGVyc2lzdGVuY2VQcm9taXNlc1xyXG4gICAgICogdG8gcmVzb2x2ZS5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2ggPSBmdW5jdGlvbiAoY29sbGVjdGlvbiwgZikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgY29sbGVjdGlvbi5mb3JFYWNoKGZ1bmN0aW9uIChyLCBzKSB7XHJcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2goZi5jYWxsKF90aGlzLCByLCBzKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMud2FpdEZvcihwcm9taXNlcyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBIG1hcCBpbXBsZW1lbnRhdGlvbiB0aGF0IHVzZXMgb2JqZWN0cyBhcyBrZXlzLiBPYmplY3RzIG11c3QgaW1wbGVtZW50IHRoZVxyXG4gKiBFcXVhdGFibGUgaW50ZXJmYWNlIGFuZCBtdXN0IGJlIGltbXV0YWJsZS4gRW50cmllcyBpbiB0aGUgbWFwIGFyZSBzdG9yZWRcclxuICogdG9nZXRoZXIgd2l0aCB0aGUga2V5IGJlaW5nIHByb2R1Y2VkIGZyb20gdGhlIG1hcEtleUZuLiBUaGlzIG1hcFxyXG4gKiBhdXRvbWF0aWNhbGx5IGhhbmRsZXMgY29sbGlzaW9ucyBvZiBrZXlzLlxyXG4gKi9cclxudmFyIE9iamVjdE1hcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE9iamVjdE1hcChtYXBLZXlGbikge1xyXG4gICAgICAgIHRoaXMubWFwS2V5Rm4gPSBtYXBLZXlGbjtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgaW5uZXIgbWFwIGZvciBhIGtleSAtPiB2YWx1ZSBwYWlyLiBEdWUgdG8gdGhlIHBvc3NpYmlsaXR5IG9mXHJcbiAgICAgICAgICogY29sbGlzaW9ucyB3ZSBrZWVwIGEgbGlzdCBvZiBlbnRyaWVzIHRoYXQgd2UgZG8gYSBsaW5lYXIgc2VhcmNoIHRocm91Z2hcclxuICAgICAgICAgKiB0byBmaW5kIGFuIGFjdHVhbCBtYXRjaC4gTm90ZSB0aGF0IGNvbGxpc2lvbnMgc2hvdWxkIGJlIHJhcmUsIHNvIHdlIHN0aWxsXHJcbiAgICAgICAgICogZXhwZWN0IG5lYXIgY29uc3RhbnQgdGltZSBsb29rdXBzIGluIHByYWN0aWNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuaW5uZXIgPSB7fTtcclxuICAgIH1cclxuICAgIC8qKiBHZXQgYSB2YWx1ZSBmb3IgdGhpcyBrZXksIG9yIHVuZGVmaW5lZCBpZiBpdCBkb2VzIG5vdCBleGlzdC4gKi9cclxuICAgIE9iamVjdE1hcC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBpZCA9IHRoaXMubWFwS2V5Rm4oa2V5KTtcclxuICAgICAgICB2YXIgbWF0Y2hlcyA9IHRoaXMuaW5uZXJbaWRdO1xyXG4gICAgICAgIGlmIChtYXRjaGVzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBtYXRjaGVzXzEgPSBtYXRjaGVzOyBfaSA8IG1hdGNoZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIF9hID0gbWF0Y2hlc18xW19pXSwgb3RoZXJLZXkgPSBfYVswXSwgdmFsdWUgPSBfYVsxXTtcclxuICAgICAgICAgICAgaWYgKG90aGVyS2V5LmlzRXF1YWwoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0TWFwLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KGtleSkgIT09IHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICAvKiogUHV0IHRoaXMga2V5IGFuZCB2YWx1ZSBpbiB0aGUgbWFwLiAqL1xyXG4gICAgT2JqZWN0TWFwLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBpZCA9IHRoaXMubWFwS2V5Rm4oa2V5KTtcclxuICAgICAgICB2YXIgbWF0Y2hlcyA9IHRoaXMuaW5uZXJbaWRdO1xyXG4gICAgICAgIGlmIChtYXRjaGVzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5pbm5lcltpZF0gPSBbW2tleSwgdmFsdWVdXTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hdGNoZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKG1hdGNoZXNbaV1bMF0uaXNFcXVhbChrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBtYXRjaGVzW2ldID0gW2tleSwgdmFsdWVdO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1hdGNoZXMucHVzaChba2V5LCB2YWx1ZV0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIHRoaXMga2V5IGZyb20gdGhlIG1hcC4gUmV0dXJucyBhIGJvb2xlYW4gaWYgYW55dGhpbmcgd2FzIGRlbGV0ZWQuXHJcbiAgICAgKi9cclxuICAgIE9iamVjdE1hcC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBpZCA9IHRoaXMubWFwS2V5Rm4oa2V5KTtcclxuICAgICAgICB2YXIgbWF0Y2hlcyA9IHRoaXMuaW5uZXJbaWRdO1xyXG4gICAgICAgIGlmIChtYXRjaGVzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hdGNoZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKG1hdGNoZXNbaV1bMF0uaXNFcXVhbChrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hlcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5pbm5lcltpZF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXRjaGVzLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBPYmplY3RNYXAucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICBmb3JFYWNoKHRoaXMuaW5uZXIsIGZ1bmN0aW9uIChfLCBlbnRyaWVzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgZW50cmllc18xID0gZW50cmllczsgX2kgPCBlbnRyaWVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2EgPSBlbnRyaWVzXzFbX2ldLCBrID0gX2FbMF0sIHYgPSBfYVsxXTtcclxuICAgICAgICAgICAgICAgIGZuKGssIHYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0TWFwLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBpc0VtcHR5KHRoaXMuaW5uZXIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBPYmplY3RNYXA7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQW4gaW4tbWVtb3J5IGJ1ZmZlciBvZiBlbnRyaWVzIHRvIGJlIHdyaXR0ZW4gdG8gYSBSZW1vdGVEb2N1bWVudENhY2hlLlxyXG4gKiBJdCBjYW4gYmUgdXNlZCB0byBiYXRjaCB1cCBhIHNldCBvZiBjaGFuZ2VzIHRvIGJlIHdyaXR0ZW4gdG8gdGhlIGNhY2hlLCBidXRcclxuICogYWRkaXRpb25hbGx5IHN1cHBvcnRzIHJlYWRpbmcgZW50cmllcyBiYWNrIHdpdGggdGhlIGBnZXRFbnRyeSgpYCBtZXRob2QsXHJcbiAqIGZhbGxpbmcgYmFjayB0byB0aGUgdW5kZXJseWluZyBSZW1vdGVEb2N1bWVudENhY2hlIGlmIG5vIGVudHJ5IGlzXHJcbiAqIGJ1ZmZlcmVkLlxyXG4gKlxyXG4gKiBFbnRyaWVzIGFkZGVkIHRvIHRoZSBjYWNoZSAqbXVzdCogYmUgcmVhZCBmaXJzdC4gVGhpcyBpcyB0byBmYWNpbGl0YXRlXHJcbiAqIGNhbGN1bGF0aW5nIHRoZSBzaXplIGRlbHRhIG9mIHRoZSBwZW5kaW5nIGNoYW5nZXMuXHJcbiAqXHJcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBjbGFzcyB3YXMgaW1wbGVtZW50ZWQgdGhlbiByZW1vdmVkIGZyb20gb3RoZXIgcGxhdGZvcm1zLlxyXG4gKiBJZiBieXRlLWNvdW50aW5nIGVuZHMgdXAgYmVpbmcgbmVlZGVkIG9uIHRoZSBvdGhlciBwbGF0Zm9ybXMsIGNvbnNpZGVyXHJcbiAqIHBvcnRpbmcgdGhpcyBjbGFzcyBhcyBwYXJ0IG9mIHRoYXQgaW1wbGVtZW50YXRpb24gd29yay5cclxuICovXHJcbnZhciBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyKCkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IG1heWJlRG9jdW1lbnRNYXAoKTtcclxuICAgICAgICB0aGlzLmRvY3VtZW50U2l6ZXMgPSBuZXcgT2JqZWN0TWFwKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGtleS50b1N0cmluZygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqIEJ1ZmZlcnMgYSBgUmVtb3RlRG9jdW1lbnRDYWNoZS5hZGRFbnRyeSgpYCBjYWxsLiAqL1xyXG4gICAgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIucHJvdG90eXBlLmFkZEVudHJ5ID0gZnVuY3Rpb24gKG1heWJlRG9jdW1lbnQpIHtcclxuICAgICAgICB2YXIgY2hhbmdlcyA9IHRoaXMuYXNzZXJ0Q2hhbmdlcygpO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IGNoYW5nZXMuaW5zZXJ0KG1heWJlRG9jdW1lbnQua2V5LCBtYXliZURvY3VtZW50KTtcclxuICAgIH07XHJcbiAgICAvLyBOT1RFOiByZW1vdmVFbnRyeSgpIGlzIGludGVudGlvbmFsbHkgb21pdHRlZC4gSWYgaXQgbmVlZHMgdG8gYmUgYWRkZWQgaW5cclxuICAgIC8vIHRoZSBmdXR1cmUgaXQgbXVzdCB0YWtlIGJ5dGUgY291bnRpbmcgaW50byBhY2NvdW50LlxyXG4gICAgLyoqXHJcbiAgICAgKiBMb29rcyB1cCBhbiBlbnRyeSBpbiB0aGUgY2FjaGUuIFRoZSBidWZmZXJlZCBjaGFuZ2VzIHdpbGwgZmlyc3QgYmUgY2hlY2tlZCxcclxuICAgICAqIGFuZCBpZiBubyBidWZmZXJlZCBjaGFuZ2UgYXBwbGllcywgdGhpcyB3aWxsIGZvcndhcmQgdG9cclxuICAgICAqIGBSZW1vdGVEb2N1bWVudENhY2hlLmdldEVudHJ5KClgLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiBUaGUgdHJhbnNhY3Rpb24gaW4gd2hpY2ggdG8gcGVyZm9ybSBhbnkgcGVyc2lzdGVuY2VcclxuICAgICAqICAgICBvcGVyYXRpb25zLlxyXG4gICAgICogQHBhcmFtIGRvY3VtZW50S2V5IFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGxvb2sgdXAuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBjYWNoZWQgRG9jdW1lbnQgb3IgTm9Eb2N1bWVudCBlbnRyeSwgb3IgbnVsbCBpZiB3ZSBoYXZlIG5vdGhpbmdcclxuICAgICAqIGNhY2hlZC5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIucHJvdG90eXBlLmdldEVudHJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSB0aGlzLmFzc2VydENoYW5nZXMoKTtcclxuICAgICAgICB2YXIgYnVmZmVyZWRFbnRyeSA9IGNoYW5nZXMuZ2V0KGRvY3VtZW50S2V5KTtcclxuICAgICAgICBpZiAoYnVmZmVyZWRFbnRyeSkge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoYnVmZmVyZWRFbnRyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBSZWNvcmQgdGhlIHNpemUgb2YgZXZlcnl0aGluZyB3ZSBsb2FkIGZyb20gdGhlIGNhY2hlIHNvIHdlIGNhbiBjb21wdXRlIGEgZGVsdGEgbGF0ZXIuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZyb21DYWNoZSh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpLm5leHQoZnVuY3Rpb24gKGdldFJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGdldFJlc3VsdCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmRvY3VtZW50U2l6ZXMuc2V0KGRvY3VtZW50S2V5LCAwKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmRvY3VtZW50U2l6ZXMuc2V0KGRvY3VtZW50S2V5LCBnZXRSZXN1bHQuc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFJlc3VsdC5tYXliZURvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBsaWVzIGJ1ZmZlcmVkIGNoYW5nZXMgdG8gdGhlIHVuZGVybHlpbmcgUmVtb3RlRG9jdW1lbnRDYWNoZSwgdXNpbmdcclxuICAgICAqIHRoZSBwcm92aWRlZCB0cmFuc2FjdGlvbi5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIucHJvdG90eXBlLmFwcGx5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuYXBwbHlDaGFuZ2VzKHRyYW5zYWN0aW9uKTtcclxuICAgICAgICAvLyBXZSBzaG91bGQgbm90IGJ1ZmZlciBhbnkgbW9yZSBjaGFuZ2VzLlxyXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICAvKiogSGVscGVyIHRvIGFzc2VydCB0aGlzLmNoYW5nZXMgaXMgbm90IG51bGwgYW5kIHJldHVybiBpdC4gKi9cclxuICAgIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLnByb3RvdHlwZS5hc3NlcnRDaGFuZ2VzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmNoYW5nZXMgIT09IG51bGwsICdDaGFuZ2VzIGhhdmUgYWxyZWFkeSBiZWVuIGFwcGxpZWQuJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlcztcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXI7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQxID0gJ1NpbXBsZURiJztcclxuLyoqXHJcbiAqIFByb3ZpZGVzIGEgd3JhcHBlciBhcm91bmQgSW5kZXhlZERiIHdpdGggYSBzaW1wbGlmaWVkIGludGVyZmFjZSB0aGF0IHVzZXNcclxuICogUHJvbWlzZS1saWtlIHJldHVybiB2YWx1ZXMgdG8gY2hhaW4gb3BlcmF0aW9ucy4gUmVhbCBwcm9taXNlcyBjYW5ub3QgYmUgdXNlZFxyXG4gKiBzaW5jZSAudGhlbigpIGNvbnRpbnVhdGlvbnMgYXJlIGV4ZWN1dGVkIGFzeW5jaHJvbm91c2x5IChlLmcuIHZpYVxyXG4gKiAuc2V0SW1tZWRpYXRlKSwgd2hpY2ggd291bGQgY2F1c2UgSW5kZXhlZERCIHRvIGVuZCB0aGUgdHJhbnNhY3Rpb24uXHJcbiAqIFNlZSBQZXJzaXN0ZW5jZVByb21pc2UgZm9yIG1vcmUgZGV0YWlscy5cclxuICovXHJcbnZhciBTaW1wbGVEYiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNpbXBsZURiKGRiKSB7XHJcbiAgICAgICAgdGhpcy5kYiA9IGRiO1xyXG4gICAgfVxyXG4gICAgLyoqIE9wZW5zIHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UsIGNyZWF0aW5nIG9yIHVwZ3JhZGluZyBpdCBpZiBuZWNlc3NhcnkuICovXHJcbiAgICBTaW1wbGVEYi5vcGVuT3JDcmVhdGUgPSBmdW5jdGlvbiAobmFtZSwgdmVyc2lvbiwgc2NoZW1hQ29udmVydGVyKSB7XHJcbiAgICAgICAgYXNzZXJ0KFNpbXBsZURiLmlzQXZhaWxhYmxlKCksICdJbmRleGVkREIgbm90IHN1cHBvcnRlZCBpbiBjdXJyZW50IGVudmlyb25tZW50LicpO1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMSwgJ09wZW5pbmcgZGF0YWJhc2U6JywgbmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IEludmVzdGlnYXRlIGJyb3dzZXIgY29tcGF0aWJpbGl0eS5cclxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0luZGV4ZWREQl9BUEkvVXNpbmdfSW5kZXhlZERCXHJcbiAgICAgICAgICAgIC8vIHN1Z2dlc3RzIElFOSBhbmQgb2xkZXIgV2ViS2l0IGJyb3dzZXJzIGhhbmRsZSB1cGdyYWRlXHJcbiAgICAgICAgICAgIC8vIGRpZmZlcmVudGx5LiBUaGV5IGV4cGVjdCBzZXRWZXJzaW9uLCBhcyBkZXNjcmliZWQgaGVyZTpcclxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0lEQlZlcnNpb25DaGFuZ2VSZXF1ZXN0L3NldFZlcnNpb25cclxuICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSB3aW5kb3cuaW5kZXhlZERCLm9wZW4obmFtZSwgdmVyc2lvbik7XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGIgPSBldmVudC50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShuZXcgU2ltcGxlRGIoZGIpKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVxdWVzdC5vbmJsb2NrZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgJ0Nhbm5vdCB1cGdyYWRlIEluZGV4ZWREQiBzY2hlbWEgd2hpbGUgYW5vdGhlciB0YWIgaXMgb3Blbi4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgJ0Nsb3NlIGFsbCB0YWJzIHRoYXQgYWNjZXNzIEZpcmVzdG9yZSBhbmQgcmVsb2FkIHRoaXMgcGFnZSB0byBwcm9jZWVkLicpKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoZXZlbnQudGFyZ2V0LmVycm9yKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckMSwgJ0RhdGFiYXNlIFwiJyArIG5hbWUgKyAnXCIgcmVxdWlyZXMgdXBncmFkZSBmcm9tIHZlcnNpb246JywgZXZlbnQub2xkVmVyc2lvbik7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGIgPSBldmVudC50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgLy8gV2UgYXJlIHByb3ZpZGVkIGEgdmVyc2lvbiB1cGdyYWRlIHRyYW5zYWN0aW9uIGZyb20gdGhlIHJlcXVlc3QsIHNvXHJcbiAgICAgICAgICAgICAgICAvLyB3ZSB3cmFwIHRoYXQgaW4gYSBTaW1wbGVEYlRyYW5zYWN0aW9uIHRvIGFsbG93IHVzZSBvZiBvdXIgZnJpZW5kbGllclxyXG4gICAgICAgICAgICAgICAgLy8gQVBJIGZvciBzY2hlbWEgbWlncmF0aW9uIG9wZXJhdGlvbnMuXHJcbiAgICAgICAgICAgICAgICB2YXIgdHhuID0gbmV3IFNpbXBsZURiVHJhbnNhY3Rpb24ocmVxdWVzdC50cmFuc2FjdGlvbik7XHJcbiAgICAgICAgICAgICAgICBzY2hlbWFDb252ZXJ0ZXJcclxuICAgICAgICAgICAgICAgICAgICAuY3JlYXRlT3JVcGdyYWRlKGRiLCB0eG4sIGV2ZW50Lm9sZFZlcnNpb24sIFNDSEVNQV9WRVJTSU9OKVxyXG4gICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdEYXRhYmFzZSB1cGdyYWRlIHRvIHZlcnNpb24gJyArIFNDSEVNQV9WRVJTSU9OICsgJyBjb21wbGV0ZScpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSkudG9Qcm9taXNlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqIERlbGV0ZXMgdGhlIHNwZWNpZmllZCBkYXRhYmFzZS4gKi9cclxuICAgIFNpbXBsZURiLmRlbGV0ZSA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnUmVtb3ZpbmcgZGF0YWJhc2U6JywgbmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIHdyYXBSZXF1ZXN0KHdpbmRvdy5pbmRleGVkREIuZGVsZXRlRGF0YWJhc2UobmFtZSkpLnRvUHJvbWlzZSgpO1xyXG4gICAgfTtcclxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgSW5kZXhlZERCIGlzIGF2YWlsYWJsZSBpbiB0aGUgY3VycmVudCBlbnZpcm9ubWVudC4gKi9cclxuICAgIFNpbXBsZURiLmlzQXZhaWxhYmxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCB3aW5kb3cuaW5kZXhlZERCID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBXZSBleHRlbnNpdmVseSB1c2UgaW5kZXhlZCBhcnJheSB2YWx1ZXMgYW5kIGNvbXBvdW5kIGtleXMsXHJcbiAgICAgICAgLy8gd2hpY2ggSUUgYW5kIEVkZ2UgZG8gbm90IHN1cHBvcnQuIEhvd2V2ZXIsIHRoZXkgc3RpbGwgaGF2ZSBpbmRleGVkREJcclxuICAgICAgICAvLyBkZWZpbmVkIG9uIHRoZSB3aW5kb3csIHNvIHdlIG5lZWQgdG8gY2hlY2sgZm9yIHRoZW0gaGVyZSBhbmQgbWFrZSBzdXJlXHJcbiAgICAgICAgLy8gdG8gcmV0dXJuIHRoYXQgcGVyc2lzdGVuY2UgaXMgbm90IGVuYWJsZWQgZm9yIHRob3NlIGJyb3dzZXJzLlxyXG4gICAgICAgIC8vIEZvciB0cmFja2luZyBzdXBwb3J0IG9mIHRoaXMgZmVhdHVyZSwgc2VlIGhlcmU6XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubWljcm9zb2Z0LmNvbS9lbi11cy9taWNyb3NvZnQtZWRnZS9wbGF0Zm9ybS9zdGF0dXMvaW5kZXhlZGRiYXJyYXlzYW5kbXVsdGllbnRyeXN1cHBvcnQvXHJcbiAgICAgICAgLy8gSWYgd2UgYXJlIHJ1bm5pbmcgaW4gTm9kZSB1c2luZyB0aGUgSW5kZXhlZERCU2hpbSwgYHdpbmRvd2AgaXMgZGVmaW5lZCxcclxuICAgICAgICAvLyBidXQgYHdpbmRvdy5uYXZpZ2F0b3JgIGlzIG5vdC4gSW4gdGhpcyBjYXNlLCB3ZSBzdXBwb3J0IEluZGV4ZWREQiBhbmRcclxuICAgICAgICAvLyByZXR1cm4gYHRydWVgLlxyXG4gICAgICAgIGlmICh3aW5kb3cubmF2aWdhdG9yID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3MuZW52LlVTRV9NT0NLX1BFUlNJU1RFTkNFID09PSAnWUVTJztcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQ2hlY2sgdGhlIFVBIHN0cmluZyB0byBmaW5kIG91dCB0aGUgYnJvd3Nlci5cclxuICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IE1vdmUgdGhpcyBsb2dpYyBpbnRvIHBhY2thZ2VzL3V0aWwvZW52aXJvbm1lbnQudHNcclxuICAgICAgICB2YXIgdWEgPSB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudDtcclxuICAgICAgICAvLyBJRSAxMFxyXG4gICAgICAgIC8vIHVhID0gJ01vemlsbGEvNS4wIChjb21wYXRpYmxlOyBNU0lFIDEwLjA7IFdpbmRvd3MgTlQgNi4yOyBUcmlkZW50LzYuMCknO1xyXG4gICAgICAgIC8vIElFIDExXHJcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4zOyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbyc7XHJcbiAgICAgICAgLy8gRWRnZVxyXG4gICAgICAgIC8vIHVhID0gJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLFxyXG4gICAgICAgIC8vIGxpa2UgR2Vja28pIENocm9tZS8zOS4wLjIxNzEuNzEgU2FmYXJpLzUzNy4zNiBFZGdlLzEyLjAnO1xyXG4gICAgICAgIGlmICh1YS5pbmRleE9mKCdNU0lFICcpID4gMCB8fFxyXG4gICAgICAgICAgICB1YS5pbmRleE9mKCdUcmlkZW50LycpID4gMCB8fFxyXG4gICAgICAgICAgICB1YS5pbmRleE9mKCdFZGdlLycpID4gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZyb20gYSB0cmFuc2FjdGlvbi4gKi9cclxuICAgIFNpbXBsZURiLmdldFN0b3JlID0gZnVuY3Rpb24gKHR4biwgc3RvcmUpIHtcclxuICAgICAgICByZXR1cm4gdHhuLnN0b3JlKHN0b3JlKTtcclxuICAgIH07XHJcbiAgICBTaW1wbGVEYi5wcm90b3R5cGUucnVuVHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAobW9kZSwgb2JqZWN0U3RvcmVzLCB0cmFuc2FjdGlvbkZuKSB7XHJcbiAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gU2ltcGxlRGJUcmFuc2FjdGlvbi5vcGVuKHRoaXMuZGIsIG1vZGUsIG9iamVjdFN0b3Jlcyk7XHJcbiAgICAgICAgdmFyIHRyYW5zYWN0aW9uRm5SZXN1bHQgPSB0cmFuc2FjdGlvbkZuKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgICAgIC8vIEFib3J0IHRoZSB0cmFuc2FjdGlvbiBpZiB0aGVyZSB3YXMgYW4gZXJyb3IuXHJcbiAgICAgICAgICAgIHRyYW5zYWN0aW9uLmFib3J0KGVycm9yJCQxKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudG9Qcm9taXNlKCk7XHJcbiAgICAgICAgLy8gV2FpdCBmb3IgdGhlIHRyYW5zYWN0aW9uIHRvIGNvbXBsZXRlIChpLmUuIEluZGV4ZWREYidzIG9uc3VjY2VzcyBldmVudCB0b1xyXG4gICAgICAgIC8vIGZpcmUpLCBidXQgc3RpbGwgcmV0dXJuIHRoZSBvcmlnaW5hbCB0cmFuc2FjdGlvbkZuUmVzdWx0IGJhY2sgdG8gdGhlXHJcbiAgICAgICAgLy8gY2FsbGVyLlxyXG4gICAgICAgIHJldHVybiB0cmFuc2FjdGlvbi5jb21wbGV0aW9uUHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRyYW5zYWN0aW9uRm5SZXN1bHQ7IH0pO1xyXG4gICAgfTtcclxuICAgIFNpbXBsZURiLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmRiLmNsb3NlKCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNpbXBsZURiO1xyXG59KCkpO1xyXG4vKipcclxuICogQSBjb250cm9sbGVyIGZvciBpdGVyYXRpbmcgb3ZlciBhIGtleSByYW5nZSBvciBpbmRleC4gSXQgYWxsb3dzIGFuIGl0ZXJhdGVcclxuICogY2FsbGJhY2sgdG8gZGVsZXRlIHRoZSBjdXJyZW50bHktcmVmZXJlbmNlZCBvYmplY3QsIG9yIGp1bXAgdG8gYSBuZXcga2V5XHJcbiAqIHdpdGhpbiB0aGUga2V5IHJhbmdlIG9yIGluZGV4LlxyXG4gKi9cclxudmFyIEl0ZXJhdGlvbkNvbnRyb2xsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBJdGVyYXRpb25Db250cm9sbGVyKGRiQ3Vyc29yKSB7XHJcbiAgICAgICAgdGhpcy5kYkN1cnNvciA9IGRiQ3Vyc29yO1xyXG4gICAgICAgIHRoaXMuc2hvdWxkU3RvcCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmV4dEtleSA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlcmF0aW9uQ29udHJvbGxlci5wcm90b3R5cGUsIFwiaXNEb25lXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2hvdWxkU3RvcDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVyYXRpb25Db250cm9sbGVyLnByb3RvdHlwZSwgXCJza2lwVG9LZXlcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uZXh0S2V5O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEl0ZXJhdGlvbkNvbnRyb2xsZXIucHJvdG90eXBlLCBcImN1cnNvclwiLCB7XHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5kYkN1cnNvciA9IHZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgdG8gc3RvcCBpdGVyYXRpb24gYXQgYW55IHBvaW50LlxyXG4gICAgICovXHJcbiAgICBJdGVyYXRpb25Db250cm9sbGVyLnByb3RvdHlwZS5kb25lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2hvdWxkU3RvcCA9IHRydWU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgdG8gc2tpcCB0byB0aGF0IG5leHQga2V5LCB3aGljaCBjb3VsZCBiZVxyXG4gICAgICogYW4gaW5kZXggb3IgYSBwcmltYXJ5IGtleS5cclxuICAgICAqL1xyXG4gICAgSXRlcmF0aW9uQ29udHJvbGxlci5wcm90b3R5cGUuc2tpcCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB0aGlzLm5leHRLZXkgPSBrZXk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBEZWxldGUgdGhlIGN1cnJlbnQgY3Vyc29yIHZhbHVlIGZyb20gdGhlIG9iamVjdCBzdG9yZS5cclxuICAgICAqXHJcbiAgICAgKiBOT1RFOiBZb3UgQ0FOTk9UIGRvIHRoaXMgd2l0aCBhIGtleXNPbmx5IHF1ZXJ5LlxyXG4gICAgICovXHJcbiAgICBJdGVyYXRpb25Db250cm9sbGVyLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHdyYXBSZXF1ZXN0KHRoaXMuZGJDdXJzb3IuZGVsZXRlKCkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBJdGVyYXRpb25Db250cm9sbGVyO1xyXG59KCkpO1xyXG4vKipcclxuICogV3JhcHMgYW4gSURCVHJhbnNhY3Rpb24gYW5kIGV4cG9zZXMgYSBzdG9yZSgpIG1ldGhvZCB0byBnZXQgYSBoYW5kbGUgdG8gYVxyXG4gKiBzcGVjaWZpYyBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG52YXIgU2ltcGxlRGJUcmFuc2FjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNpbXBsZURiVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMudHJhbnNhY3Rpb24gPSB0cmFuc2FjdGlvbjtcclxuICAgICAgICB0aGlzLmFib3J0ZWQgPSBmYWxzZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSByZXN1bHQgb2YgdGhlIEluZGV4ZWREYiB0cmFuc2FjdGlvbi5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmNvbXBsZXRpb25EZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCQxKCk7XHJcbiAgICAgICAgdGhpcy50cmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5jb21wbGV0aW9uRGVmZXJyZWQucmVzb2x2ZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy50cmFuc2FjdGlvbi5vbmFib3J0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAodHJhbnNhY3Rpb24uZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNvbXBsZXRpb25EZWZlcnJlZC5yZWplY3QodHJhbnNhY3Rpb24uZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY29tcGxldGlvbkRlZmVycmVkLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy50cmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIF90aGlzLmNvbXBsZXRpb25EZWZlcnJlZC5yZWplY3QoZXZlbnQudGFyZ2V0LmVycm9yKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgU2ltcGxlRGJUcmFuc2FjdGlvbi5vcGVuID0gZnVuY3Rpb24gKGRiLCBtb2RlLCBvYmplY3RTdG9yZU5hbWVzKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTaW1wbGVEYlRyYW5zYWN0aW9uKGRiLnRyYW5zYWN0aW9uKG9iamVjdFN0b3JlTmFtZXMsIG1vZGUpKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2ltcGxlRGJUcmFuc2FjdGlvbi5wcm90b3R5cGUsIFwiY29tcGxldGlvblByb21pc2VcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wbGV0aW9uRGVmZXJyZWQucHJvbWlzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFNpbXBsZURiVHJhbnNhY3Rpb24ucHJvdG90eXBlLmFib3J0ID0gZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgaWYgKGVycm9yJCQxKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGlvbkRlZmVycmVkLnJlamVjdChlcnJvciQkMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5hYm9ydGVkKSB7XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckMSwgJ0Fib3J0aW5nIHRyYW5zYWN0aW9uOicsIGVycm9yJCQxID8gZXJyb3IkJDEubWVzc2FnZSA6ICdDbGllbnQtaW5pdGlhdGVkIGFib3J0Jyk7XHJcbiAgICAgICAgICAgIHRoaXMuYWJvcnRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb24uYWJvcnQoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgU2ltcGxlRGJTdG9yZTxLZXlUeXBlLCBWYWx1ZVR5cGU+IGZvciB0aGUgc3BlY2lmaWVkIHN0b3JlLiBBbGxcclxuICAgICAqIG9wZXJhdGlvbnMgcGVyZm9ybWVkIG9uIHRoZSBTaW1wbGVEYlN0b3JlIGhhcHBlbiB3aXRoaW4gdGhlIGNvbnRleHQgb2YgdGhpc1xyXG4gICAgICogdHJhbnNhY3Rpb24gYW5kIGl0IGNhbm5vdCBiZSB1c2VkIGFueW1vcmUgb25jZSB0aGUgdHJhbnNhY3Rpb24gaXNcclxuICAgICAqIGNvbXBsZXRlZC5cclxuICAgICAqXHJcbiAgICAgKiBOb3RlIHRoYXQgd2UgY2FuJ3QgYWN0dWFsbHkgZW5mb3JjZSB0aGF0IHRoZSBLZXlUeXBlIGFuZCBWYWx1ZVR5cGUgYXJlXHJcbiAgICAgKiBjb3JyZWN0LCBidXQgdGhleSBhbGxvdyB0eXBlIHNhZmV0eSB0aHJvdWdoIHRoZSByZXN0IG9mIHRoZSBjb25zdW1pbmcgY29kZS5cclxuICAgICAqL1xyXG4gICAgU2ltcGxlRGJUcmFuc2FjdGlvbi5wcm90b3R5cGUuc3RvcmUgPSBmdW5jdGlvbiAoc3RvcmVOYW1lKSB7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gdGhpcy50cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xyXG4gICAgICAgIGFzc2VydCghIXN0b3JlLCAnT2JqZWN0IHN0b3JlIG5vdCBwYXJ0IG9mIHRyYW5zYWN0aW9uOiAnICsgc3RvcmVOYW1lKTtcclxuICAgICAgICByZXR1cm4gbmV3IFNpbXBsZURiU3RvcmUoc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTaW1wbGVEYlRyYW5zYWN0aW9uO1xyXG59KCkpO1xyXG4vKipcclxuICogQSB3cmFwcGVyIGFyb3VuZCBhbiBJREJPYmplY3RTdG9yZSBwcm92aWRpbmcgYW4gQVBJIHRoYXQ6XHJcbiAqXHJcbiAqIDEpIEhhcyBnZW5lcmljIEtleVR5cGUgLyBWYWx1ZVR5cGUgcGFyYW1ldGVycyB0byBwcm92aWRlIHN0cm9uZ2x5LXR5cGVkXHJcbiAqIG1ldGhvZHMgZm9yIGFjdGluZyBhZ2FpbnN0IHRoZSBvYmplY3Qgc3RvcmUuXHJcbiAqIDIpIERlYWxzIHdpdGggSW5kZXhlZERCJ3Mgb25zdWNjZXNzIC8gb25lcnJvciBldmVudCBjYWxsYmFja3MsIG1ha2luZyBldmVyeVxyXG4gKiBtZXRob2QgcmV0dXJuIGEgUGVyc2lzdGVuY2VQcm9taXNlIGluc3RlYWQuXHJcbiAqIDMpIFByb3ZpZGVzIGEgaGlnaGVyLWxldmVsIEFQSSB0byBhdm9pZCBuZWVkaW5nIHRvIGRvIGV4Y2Vzc2l2ZSB3cmFwcGluZyBvZlxyXG4gKiBpbnRlcm1lZGlhdGUgSW5kZXhlZERCIHR5cGVzIChJREJDdXJzb3JXaXRoVmFsdWUsIGV0Yy4pXHJcbiAqL1xyXG52YXIgU2ltcGxlRGJTdG9yZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNpbXBsZURiU3RvcmUoc3RvcmUpIHtcclxuICAgICAgICB0aGlzLnN0b3JlID0gc3RvcmU7XHJcbiAgICB9XHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5wdXQgPSBmdW5jdGlvbiAoa2V5T3JWYWx1ZSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgcmVxdWVzdDtcclxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdQVVQnLCB0aGlzLnN0b3JlLm5hbWUsIGtleU9yVmFsdWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgcmVxdWVzdCA9IHRoaXMuc3RvcmUucHV0KHZhbHVlLCBrZXlPclZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckMSwgJ1BVVCcsIHRoaXMuc3RvcmUubmFtZSwgJzxhdXRvLWtleT4nLCBrZXlPclZhbHVlKTtcclxuICAgICAgICAgICAgcmVxdWVzdCA9IHRoaXMuc3RvcmUucHV0KGtleU9yVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gd3JhcFJlcXVlc3QocmVxdWVzdCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgbmV3IHZhbHVlIGludG8gYW4gT2JqZWN0IFN0b3JlIGFuZCByZXR1cm5zIHRoZSBuZXcga2V5LiBTaW1pbGFyIHRvXHJcbiAgICAgKiBJbmRleGVkRGIncyBgYWRkKClgLCB0aGlzIG1ldGhvZCB3aWxsIGZhaWwgb24gcHJpbWFyeSBrZXkgY29sbGlzaW9ucy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdmFsdWUgVGhlIG9iamVjdCB0byB3cml0ZS5cclxuICAgICAqIEByZXR1cm4gVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gYWRkLlxyXG4gICAgICovXHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdBREQnLCB0aGlzLnN0b3JlLm5hbWUsIHZhbHVlLCB2YWx1ZSk7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB0aGlzLnN0b3JlLmFkZCh2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHdyYXBSZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogR2V0cyB0aGUgb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBrZXkgZnJvbSB0aGUgc3BlY2lmaWVkIHN0b3JlLCBvciBudWxsXHJcbiAgICAgKiBpZiBubyBvYmplY3QgZXhpc3RzIHdpdGggdGhlIHNwZWNpZmllZCBrZXkuXHJcbiAgICAgKlxyXG4gICAgICogQGtleSBUaGUga2V5IG9mIHRoZSBvYmplY3QgdG8gZ2V0LlxyXG4gICAgICogQHJldHVybiBUaGUgb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBrZXkgb3IgbnVsbCBpZiBubyBvYmplY3QgZXhpc3RzLlxyXG4gICAgICovXHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IHRoaXMuc3RvcmUuZ2V0KGtleSk7XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBXZSdyZSBkb2luZyBhbiB1bnNhZmUgY2FzdCB0byBWYWx1ZVR5cGUuXHJcbiAgICAgICAgcmV0dXJuIHdyYXBSZXF1ZXN0KHJlcXVlc3QpLm5leHQoZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAvLyBOb3JtYWxpemUgbm9uZXhpc3RlbmNlIHRvIG51bGwuXHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdHRVQnLCBfdGhpcy5zdG9yZS5uYW1lLCBrZXksIHJlc3VsdCk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMSwgJ0RFTEVURScsIHRoaXMuc3RvcmUubmFtZSwga2V5KTtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IHRoaXMuc3RvcmUuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIHdyYXBSZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSWYgd2UgZXZlciBuZWVkIG1vcmUgb2YgdGhlIGNvdW50IHZhcmlhbnRzLCB3ZSBjYW4gYWRkIG92ZXJsb2Fkcy4gRm9yIG5vdyxcclxuICAgICAqIGFsbCB3ZSBuZWVkIGlzIHRvIGNvdW50IGV2ZXJ5dGhpbmcgaW4gYSBzdG9yZS5cclxuICAgICAqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2Ygcm93cyBpbiB0aGUgc3RvcmUuXHJcbiAgICAgKi9cclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLmNvdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMSwgJ0NPVU5UJywgdGhpcy5zdG9yZS5uYW1lKTtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IHRoaXMuc3RvcmUuY291bnQoKTtcclxuICAgICAgICByZXR1cm4gd3JhcFJlcXVlc3QocmVxdWVzdCk7XHJcbiAgICB9O1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUubG9hZEFsbCA9IGZ1bmN0aW9uIChpbmRleE9yUmFuZ2UsIHJhbmdlKSB7XHJcbiAgICAgICAgdmFyIGN1cnNvciA9IHRoaXMuY3Vyc29yKHRoaXMub3B0aW9ucyhpbmRleE9yUmFuZ2UsIHJhbmdlKSk7XHJcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcclxuICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRlQ3Vyc29yKGN1cnNvciwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHZhbHVlKTtcclxuICAgICAgICB9KS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUuZGVsZXRlQWxsID0gZnVuY3Rpb24gKGluZGV4T3JSYW5nZSwgcmFuZ2UpIHtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdERUxFVEUgQUxMJywgdGhpcy5zdG9yZS5uYW1lKTtcclxuICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyhpbmRleE9yUmFuZ2UsIHJhbmdlKTtcclxuICAgICAgICBvcHRpb25zLmtleXNPbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIGN1cnNvciA9IHRoaXMuY3Vyc29yKG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLml0ZXJhdGVDdXJzb3IoY3Vyc29yLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29udHJvbCkge1xyXG4gICAgICAgICAgICAvLyBOT1RFOiBDYWxsaW5nIGRlbGV0ZSgpIG9uIGEgY3Vyc29yIGlzIGRvY3VtZW50ZWQgYXMgbW9yZSBlZmZpY2llbnQgdGhhblxyXG4gICAgICAgICAgICAvLyBjYWxsaW5nIGRlbGV0ZSgpIG9uIGFuIG9iamVjdCBzdG9yZSB3aXRoIGEgc2luZ2xlIGtleVxyXG4gICAgICAgICAgICAvLyAoaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0lEQk9iamVjdFN0b3JlL2RlbGV0ZSksXHJcbiAgICAgICAgICAgIC8vIGhvd2V2ZXIsIHRoaXMgcmVxdWlyZXMgdXMgKm5vdCogdG8gdXNlIGEga2V5c09ubHkgY3Vyc29yXHJcbiAgICAgICAgICAgIC8vIChodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSURCQ3Vyc29yL2RlbGV0ZSkuIFdlXHJcbiAgICAgICAgICAgIC8vIG1heSB3YW50IHRvIGNvbXBhcmUgdGhlIHBlcmZvcm1hbmNlIG9mIGVhY2ggbWV0aG9kLlxyXG4gICAgICAgICAgICByZXR1cm4gY29udHJvbC5kZWxldGUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5pdGVyYXRlID0gZnVuY3Rpb24gKG9wdGlvbnNPckNhbGxiYWNrLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBvcHRpb25zO1xyXG4gICAgICAgIGlmICghY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgb3B0aW9ucyA9IHt9O1xyXG4gICAgICAgICAgICBjYWxsYmFjayA9IG9wdGlvbnNPckNhbGxiYWNrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnNPckNhbGxiYWNrO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY3Vyc29yID0gdGhpcy5jdXJzb3Iob3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlcmF0ZUN1cnNvcihjdXJzb3IsIGNhbGxiYWNrKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYSBzdG9yZSwgYnV0IHdhaXRzIGZvciB0aGUgZ2l2ZW4gY2FsbGJhY2sgdG8gY29tcGxldGUgZm9yXHJcbiAgICAgKiBlYWNoIGVudHJ5IGJlZm9yZSBpdGVyYXRpbmcgdGhlIG5leHQgZW50cnkuIFRoaXMgYWxsb3dzIHRoZSBjYWxsYmFjayB0byBkb1xyXG4gICAgICogYXN5bmNocm9ub3VzIHdvcmsgdG8gZGV0ZXJtaW5lIGlmIHRoaXMgaXRlcmF0aW9uIHNob3VsZCBjb250aW51ZS5cclxuICAgICAqXHJcbiAgICAgKiBUaGUgcHJvdmlkZWQgY2FsbGJhY2sgc2hvdWxkIHJldHVybiBgdHJ1ZWAgdG8gY29udGludWUgaXRlcmF0aW9uLCBhbmRcclxuICAgICAqIGBmYWxzZWAgb3RoZXJ3aXNlLlxyXG4gICAgICovXHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5pdGVyYXRlU2VyaWFsID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIGN1cnNvclJlcXVlc3QgPSB0aGlzLmN1cnNvcih7fSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBjdXJzb3JSZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjdXJzb3JSZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnNvciA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnNvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhjdXJzb3IucHJpbWFyeUtleSwgY3Vyc29yLnZhbHVlKS5uZXh0KGZ1bmN0aW9uIChzaG91bGRDb250aW51ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaG91bGRDb250aW51ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5pdGVyYXRlQ3Vyc29yID0gZnVuY3Rpb24gKGN1cnNvclJlcXVlc3QsIGZuKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcclxuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIGN1cnNvclJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGN1cnNvclJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3Vyc29yID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgIGlmICghY3Vyc29yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBjb250cm9sbGVyID0gbmV3IEl0ZXJhdGlvbkNvbnRyb2xsZXIoY3Vyc29yKTtcclxuICAgICAgICAgICAgICAgIHZhciB1c2VyUmVzdWx0ID0gZm4oY3Vyc29yLnByaW1hcnlLZXksIGN1cnNvci52YWx1ZSwgY29udHJvbGxlcik7XHJcbiAgICAgICAgICAgICAgICBpZiAodXNlclJlc3VsdCBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1c2VyUHJvbWlzZSA9IHVzZXJSZXN1bHQuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmRvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2godXNlclByb21pc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRyb2xsZXIuaXNEb25lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29udHJvbGxlci5za2lwVG9LZXkgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnNvci5jb250aW51ZShjb250cm9sbGVyLnNraXBUb0tleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSkubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihyZXN1bHRzKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5vcHRpb25zID0gZnVuY3Rpb24gKGluZGV4T3JSYW5nZSwgcmFuZ2UpIHtcclxuICAgICAgICB2YXIgaW5kZXhOYW1lID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGlmIChpbmRleE9yUmFuZ2UgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGluZGV4T3JSYW5nZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIGluZGV4TmFtZSA9IGluZGV4T3JSYW5nZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChyYW5nZSA9PT0gdW5kZWZpbmVkLCAnM3JkIGFyZ3VtZW50IG11c3Qgbm90IGJlIGRlZmluZWQgaWYgMm5kIGlzIGEgcmFuZ2UuJyk7XHJcbiAgICAgICAgICAgICAgICByYW5nZSA9IGluZGV4T3JSYW5nZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyBpbmRleDogaW5kZXhOYW1lLCByYW5nZTogcmFuZ2UgfTtcclxuICAgIH07XHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5jdXJzb3IgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBkaXJlY3Rpb24gPSAnbmV4dCc7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMucmV2ZXJzZSkge1xyXG4gICAgICAgICAgICBkaXJlY3Rpb24gPSAncHJldic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvcHRpb25zLmluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuc3RvcmUuaW5kZXgob3B0aW9ucy5pbmRleCk7XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmtleXNPbmx5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXgub3BlbktleUN1cnNvcihvcHRpb25zLnJhbmdlLCBkaXJlY3Rpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4Lm9wZW5DdXJzb3Iob3B0aW9ucy5yYW5nZSwgZGlyZWN0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmUub3BlbkN1cnNvcihvcHRpb25zLnJhbmdlLCBkaXJlY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gU2ltcGxlRGJTdG9yZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIFdyYXBzIGFuIElEQlJlcXVlc3QgaW4gYSBQZXJzaXN0ZW5jZVByb21pc2UsIHVzaW5nIHRoZSBvbnN1Y2Nlc3MgLyBvbmVycm9yXHJcbiAqIGhhbmRsZXJzIHRvIHJlc29sdmUgLyByZWplY3QgdGhlIFBlcnNpc3RlbmNlUHJvbWlzZSBhcyBhcHByb3ByaWF0ZS5cclxuICovXHJcbmZ1bmN0aW9uIHdyYXBSZXF1ZXN0KHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIFJFTU9URV9ET0NVTUVOVF9DSEFOR0VfTUlTU0lOR19FUlJfTVNHID0gJ1RoZSByZW1vdGUgZG9jdW1lbnQgY2hhbmdlbG9nIG5vIGxvbmdlciBjb250YWlucyBhbGwgY2hhbmdlcyBmb3IgYWxsICcgK1xyXG4gICAgJ2xvY2FsIHF1ZXJ5IHZpZXdzLiBJdCBtYXkgYmUgbmVjZXNzYXJ5IHRvIHJlYnVpbGQgdGhlc2Ugdmlld3MuJztcclxudmFyIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSB7TG9jYWxTZXJpYWxpemVyfSBzZXJpYWxpemVyIFRoZSBkb2N1bWVudCBzZXJpYWxpemVyLlxyXG4gICAgICogQHBhcmFtIGtlZXBEb2N1bWVudENoYW5nZUxvZyBXaGV0aGVyIHRvIGtlZXAgYSBkb2N1bWVudCBjaGFuZ2UgbG9nIGluXHJcbiAgICAgKiBJbmRleGVkRGIuIFRoaXMgY2hhbmdlIGxvZyBpcyByZXF1aXJlZCBmb3IgTXVsdGktVGFiIHN5bmNocm9uaXphdGlvbiwgYnV0XHJcbiAgICAgKiBub3QgbmVlZGVkIGluIGNsaWVudHMgdGhhdCBkb24ndCBzaGFyZSBhY2Nlc3MgdG8gdGhlaXIgcmVtb3RlIGRvY3VtZW50XHJcbiAgICAgKiBjYWNoZS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZShzZXJpYWxpemVyLCBrZWVwRG9jdW1lbnRDaGFuZ2VMb2cpIHtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgICAgIHRoaXMua2VlcERvY3VtZW50Q2hhbmdlTG9nID0ga2VlcERvY3VtZW50Q2hhbmdlTG9nO1xyXG4gICAgICAgIC8qKiBUaGUgbGFzdCBpZCByZWFkIGJ5IGBnZXROZXdEb2N1bWVudENoYW5nZXMoKWAuICovXHJcbiAgICAgICAgdGhpcy5fbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQgPSAwO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLCBcImxhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBTdGFydHMgdXAgdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZS5cclxuICAgICAqXHJcbiAgICAgKiBSZWFkcyB0aGUgSUQgb2YgdGhlIGxhc3QgIGRvY3VtZW50IGNoYW5nZSBmcm9tIHRoZSBkb2N1bWVudENoYW5nZXMgc3RvcmUuXHJcbiAgICAgKiBFeGlzdGluZyBjaGFuZ2VzIHdpbGwgbm90IGJlIHJldHVybmVkIGFzIHBhcnQgb2ZcclxuICAgICAqIGBnZXROZXdEb2N1bWVudENoYW5nZXMoKWAuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uXHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBzdG9yZSA9IFNpbXBsZURiLmdldFN0b3JlKHRyYW5zYWN0aW9uLCBEYlJlbW90ZURvY3VtZW50Q2hhbmdlcy5zdG9yZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY2hyb25pemVMYXN0RG9jdW1lbnRDaGFuZ2VJZChzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIHRoZSBzdXBwbGllZCBlbnRyaWVzIHRvIHRoZSBjYWNoZS4gQWRkcyB0aGUgZ2l2ZW4gc2l6ZSBkZWx0YSB0byB0aGUgY2FjaGVkIHNpemUuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmFkZEVudHJpZXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGVudHJpZXMsIHNpemVEZWx0YSkge1xyXG4gICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIGlmIChlbnRyaWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdmFyIGRvY3VtZW50U3RvcmUgPSByZW1vdGVEb2N1bWVudHNTdG9yZSh0cmFuc2FjdGlvbik7XHJcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkS2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgZW50cmllc18xID0gZW50cmllczsgX2kgPCBlbnRyaWVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2EgPSBlbnRyaWVzXzFbX2ldLCBrZXkgPSBfYS5rZXksIGRvYyA9IF9hLmRvYztcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goZG9jdW1lbnRTdG9yZS5wdXQoZGJLZXkoa2V5KSwgZG9jKSk7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VkS2V5cyA9IGNoYW5nZWRLZXlzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmtlZXBEb2N1bWVudENoYW5nZUxvZykge1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChkb2N1bWVudENoYW5nZXNTdG9yZSh0cmFuc2FjdGlvbikucHV0KHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VzOiB0aGlzLnNlcmlhbGl6ZXIudG9EYlJlc291cmNlUGF0aHMoY2hhbmdlZEtleXMpXHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLnVwZGF0ZVNpemUodHJhbnNhY3Rpb24sIHNpemVEZWx0YSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyBhIGRvY3VtZW50IGZyb20gdGhlIGNhY2hlLiBOb3RlIHRoYXQgdGhpcyBtZXRob2QgZG9lcyAqbm90KiBkbyBhbnlcclxuICAgICAqIHNpemUgYWNjb3VudGluZy4gSXQgaXMgdGhlIHJlc3BvbnNpYmlsaXR5IG9mIHRoZSBjYWxsZXIgdG8gY291bnQgdGhlIGJ5dGVzIHJlbW92ZWRcclxuICAgICAqIGFuZCBpc3N1ZSBhIGZpbmFsIHVwZGF0ZVNpemUoKSBjYWxsIGFmdGVyIHJlbW92aW5nIGRvY3VtZW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXkgVGhlIGtleSBvZiB0aGUgZG9jdW1lbnQgdG8gcmVtb3ZlXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBzaXplIG9mIHRoZSBkb2N1bWVudCB0aGF0IHdhcyByZW1vdmVkLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5yZW1vdmVFbnRyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIGtlZXAgY2hhbmdlbG9nIGZvciB0aGVzZSByZW1vdmFscyBzaW5jZSBgcmVtb3ZlRW50cnlgIGlzXHJcbiAgICAgICAgLy8gb25seSB1c2VkIGZvciBnYXJiYWdlIGNvbGxlY3Rpb24uXHJcbiAgICAgICAgdmFyIHN0b3JlID0gcmVtb3RlRG9jdW1lbnRzU3RvcmUodHJhbnNhY3Rpb24pO1xyXG4gICAgICAgIHZhciBrZXkgPSBkYktleShkb2N1bWVudEtleSk7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlLmdldChrZXkpLm5leHQoZnVuY3Rpb24gKGRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChkb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRlbGV0ZShrZXkpLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gZGJEb2N1bWVudFNpemUoZG9jdW1lbnQpOyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldEVudHJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHJlbW90ZURvY3VtZW50c1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuZ2V0KGRiS2V5KGRvY3VtZW50S2V5KSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGRiUmVtb3RlRG9jKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYlJlbW90ZURvY1xyXG4gICAgICAgICAgICAgICAgPyBfdGhpcy5zZXJpYWxpemVyLmZyb21EYlJlbW90ZURvY3VtZW50KGRiUmVtb3RlRG9jKVxyXG4gICAgICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogTG9va3MgdXAgYW4gZW50cnkgaW4gdGhlIGNhY2hlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBsb29rIHVwLlxyXG4gICAgICogQHJldHVybiBUaGUgY2FjaGVkIE1heWJlRG9jdW1lbnQgZW50cnkgYW5kIGl0cyBzaXplLCBvciBudWxsIGlmIHdlIGhhdmUgbm90aGluZyBjYWNoZWQuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldFNpemVkRW50cnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gcmVtb3RlRG9jdW1lbnRzU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5nZXQoZGJLZXkoZG9jdW1lbnRLZXkpKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoZGJSZW1vdGVEb2MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRiUmVtb3RlRG9jXHJcbiAgICAgICAgICAgICAgICA/IHtcclxuICAgICAgICAgICAgICAgICAgICBtYXliZURvY3VtZW50OiBfdGhpcy5zZXJpYWxpemVyLmZyb21EYlJlbW90ZURvY3VtZW50KGRiUmVtb3RlRG9jKSxcclxuICAgICAgICAgICAgICAgICAgICBzaXplOiBkYkRvY3VtZW50U2l6ZShkYlJlbW90ZURvYylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIDogbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBkb2N1bWVudE1hcCgpO1xyXG4gICAgICAgIC8vIERvY3VtZW50cyBhcmUgb3JkZXJlZCBieSBrZXksIHNvIHdlIGNhbiB1c2UgYSBwcmVmaXggc2NhbiB0byBuYXJyb3cgZG93blxyXG4gICAgICAgIC8vIHRoZSBkb2N1bWVudHMgd2UgbmVlZCB0byBtYXRjaCB0aGUgcXVlcnkgYWdhaW5zdC5cclxuICAgICAgICB2YXIgc3RhcnRLZXkgPSBxdWVyeS5wYXRoLnRvQXJyYXkoKTtcclxuICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKHN0YXJ0S2V5KTtcclxuICAgICAgICByZXR1cm4gcmVtb3RlRG9jdW1lbnRzU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKHsgcmFuZ2U6IHJhbmdlIH0sIGZ1bmN0aW9uIChrZXksIGRiUmVtb3RlRG9jLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXliZURvYyA9IF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiUmVtb3RlRG9jdW1lbnQoZGJSZW1vdGVEb2MpO1xyXG4gICAgICAgICAgICBpZiAoIXF1ZXJ5LnBhdGguaXNQcmVmaXhPZihtYXliZURvYy5rZXkucGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG1heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQgJiYgcXVlcnkubWF0Y2hlcyhtYXliZURvYykpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmluc2VydChtYXliZURvYy5rZXksIG1heWJlRG9jKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlc3VsdHM7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldE5ld0RvY3VtZW50Q2hhbmdlcyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMua2VlcERvY3VtZW50Q2hhbmdlTG9nLCAnQ2FuIG9ubHkgY2FsbCBnZXROZXdEb2N1bWVudENoYW5nZXMoKSB3aGVuIGRvY3VtZW50IGNoYW5nZSBsb2cgaXMgZW5hYmxlZCcpO1xyXG4gICAgICAgIHZhciBjaGFuZ2VkS2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdmFyIGNoYW5nZWREb2NzID0gbWF5YmVEb2N1bWVudE1hcCgpO1xyXG4gICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmxvd2VyQm91bmQodGhpcy5fbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQgKyAxKTtcclxuICAgICAgICB2YXIgZmlyc3RJdGVyYXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBjaGFuZ2VzU3RvcmUgPSBkb2N1bWVudENoYW5nZXNTdG9yZSh0cmFuc2FjdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIGNoYW5nZXNTdG9yZVxyXG4gICAgICAgICAgICAuaXRlcmF0ZSh7IHJhbmdlOiByYW5nZSB9LCBmdW5jdGlvbiAoXywgZG9jdW1lbnRDaGFuZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGZpcnN0SXRlcmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBmaXJzdEl0ZXJhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gSWYgb3VyIGNsaWVudCB3YXMgdGhyb3R0bGVkIGZvciBtb3JlIHRoYW4gMzAgbWludXRlcywgYW5vdGhlclxyXG4gICAgICAgICAgICAgICAgLy8gY2xpZW50IG1heSBoYXZlIGdhcmJhZ2UgY29sbGVjdGVkIHRoZSByZW1vdGUgZG9jdW1lbnQgY2hhbmdlbG9nLlxyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCArIDEgIT09IGRvY3VtZW50Q2hhbmdlLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIGBsYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZGAgdG8gYWxsb3cgZnVydGhlclxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGludm9jYXRpb25zIHRvIHN1Y2Nlc3NmdWxseSByZXR1cm4gdGhlIGNoYW5nZXMgYWZ0ZXIgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlamVjdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc3luY2hyb25pemVMYXN0RG9jdW1lbnRDaGFuZ2VJZChjaGFuZ2VzU3RvcmUpLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlamVjdChuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5EQVRBX0xPU1MsIFJFTU9URV9ET0NVTUVOVF9DSEFOR0VfTUlTU0lOR19FUlJfTVNHKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2hhbmdlZEtleXMgPSBjaGFuZ2VkS2V5cy51bmlvbldpdGgoX3RoaXMuc2VyaWFsaXplci5mcm9tRGJSZXNvdXJjZVBhdGhzKGRvY3VtZW50Q2hhbmdlLmNoYW5nZXMpKTtcclxuICAgICAgICAgICAgX3RoaXMuX2xhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkID0gZG9jdW1lbnRDaGFuZ2UuaWQ7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZG9jdW1lbnRQcm9taXNlcyA9IFtdO1xyXG4gICAgICAgICAgICBjaGFuZ2VkS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50UHJvbWlzZXMucHVzaChfdGhpcy5nZXRFbnRyeSh0cmFuc2FjdGlvbiwga2V5KS5uZXh0KGZ1bmN0aW9uIChtYXliZURvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvYyA9IG1heWJlRG9jdW1lbnQgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vRG9jdW1lbnQoa2V5LCBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpKTtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkRG9jcyA9IGNoYW5nZWREb2NzLmluc2VydChrZXksIGRvYyk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IoZG9jdW1lbnRQcm9taXNlcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gY2hhbmdlZERvY3M7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyBhbGwgY2hhbmdlcyBpbiB0aGUgcmVtb3RlIGRvY3VtZW50IGNoYW5nZWxvZyB0aHJvdWdoIGBjaGFuZ2VJZGBcclxuICAgICAqIChpbmNsdXNpdmUpLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5yZW1vdmVEb2N1bWVudENoYW5nZXNUaHJvdWdoQ2hhbmdlSWQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGNoYW5nZUlkKSB7XHJcbiAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UudXBwZXJCb3VuZChjaGFuZ2VJZCk7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50Q2hhbmdlc1N0b3JlKHRyYW5zYWN0aW9uKS5kZWxldGUocmFuZ2UpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLnN5bmNocm9uaXplTGFzdERvY3VtZW50Q2hhbmdlSWQgPSBmdW5jdGlvbiAoZG9jdW1lbnRDaGFuZ2VzU3RvcmUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIElmIHRoZXJlIGFyZSBubyBleGlzdGluZyBjaGFuZ2VzLCB3ZSBzZXQgYGxhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkYFxyXG4gICAgICAgIC8vIHRvIDAgc2luY2UgSW5kZXhlZERiJ3MgYXV0by1nZW5lcmF0ZWQga2V5cyBzdGFydCBhdCAxLlxyXG4gICAgICAgIHRoaXMuX2xhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkID0gMDtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnRDaGFuZ2VzU3RvcmUuaXRlcmF0ZSh7IGtleXNPbmx5OiB0cnVlLCByZXZlcnNlOiB0cnVlIH0sIGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCA9IGtleTtcclxuICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUubmV3Q2hhbmdlQnVmZmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXRhZGF0YSh0eG4pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7IHJldHVybiBtZXRhZGF0YS5ieXRlU2l6ZTsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50R2xvYmFsU3RvcmUodHhuKVxyXG4gICAgICAgICAgICAuZ2V0KERiUmVtb3RlRG9jdW1lbnRHbG9iYWwua2V5KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KCEhbWV0YWRhdGEsICdNaXNzaW5nIGRvY3VtZW50IGNhY2hlIG1ldGFkYXRhJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5zZXRNZXRhZGF0YSA9IGZ1bmN0aW9uICh0eG4sIG1ldGFkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50R2xvYmFsU3RvcmUodHhuKS5wdXQoRGJSZW1vdGVEb2N1bWVudEdsb2JhbC5rZXksIG1ldGFkYXRhKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgdGhlIGdpdmVuIGRlbHRhIHRvIHRoZSBjYWNoZWQgY3VycmVudCBzaXplLiBDYWxsZXJzIHRvIHJlbW92ZUVudHJ5ICptdXN0KiBjYWxsIHRoaXNcclxuICAgICAqIGFmdGVyd2FyZHMgdG8gdXBkYXRlIHRoZSBzaXplIG9mIHRoZSBjYWNoZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gc2l6ZURlbHRhXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLnVwZGF0ZVNpemUgPSBmdW5jdGlvbiAodHhuLCBzaXplRGVsdGEpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE1ldGFkYXRhKHR4bikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgbWV0YWRhdGEuYnl0ZVNpemUgKz0gc2l6ZURlbHRhO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc2V0TWV0YWRhdGEodHhuLCBtZXRhZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGU7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGRvY3VtZW50R2xvYmFsU3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYlJlbW90ZURvY3VtZW50R2xvYmFsLnN0b3JlKTtcclxufVxyXG4vKipcclxuICogSGFuZGxlcyB0aGUgZGV0YWlscyBvZiBhZGRpbmcgYW5kIHVwZGF0aW5nIGRvY3VtZW50cyBpbiB0aGUgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZVxyXG4gKi9cclxudmFyIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcihkb2N1bWVudENhY2hlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5kb2N1bWVudENhY2hlID0gZG9jdW1lbnRDYWNoZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlci5wcm90b3R5cGUuYXBwbHlDaGFuZ2VzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY2hhbmdlcyA9IHRoaXMuYXNzZXJ0Q2hhbmdlcygpO1xyXG4gICAgICAgIHZhciBkZWx0YSA9IDA7XHJcbiAgICAgICAgdmFyIHRvQXBwbHkgPSBbXTtcclxuICAgICAgICBjaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGtleSwgbWF5YmVEb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YXIgZG9jID0gX3RoaXMuZG9jdW1lbnRDYWNoZS5zZXJpYWxpemVyLnRvRGJSZW1vdGVEb2N1bWVudChtYXliZURvY3VtZW50KTtcclxuICAgICAgICAgICAgdmFyIHByZXZpb3VzU2l6ZSA9IF90aGlzLmRvY3VtZW50U2l6ZXMuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgIC8vIE5PVEU6IGlmIHdlIGV2ZXIgZGVjaWRlIHdlIG5lZWQgdG8gc3VwcG9ydCBkb2luZyB3cml0ZXMgd2l0aG91dFxyXG4gICAgICAgICAgICAvLyByZWFkaW5nIGZpcnN0LCB0aGlzIGFzc2VydCB3aWxsIG5lZWQgdG8gY2hhbmdlIHRvIGRvIHRoZSByZWFkIGF1dG9tYXRpY2FsbHkuXHJcbiAgICAgICAgICAgIGFzc2VydChwcmV2aW91c1NpemUgIT09IHVuZGVmaW5lZCwgXCJBdHRlbXB0aW5nIHRvIGNoYW5nZSBkb2N1bWVudCBcIiArIGtleS50b1N0cmluZygpICsgXCIgd2l0aG91dCBoYXZpbmcgcmVhZCBpdCBmaXJzdFwiKTtcclxuICAgICAgICAgICAgdmFyIHNpemUgPSBkYkRvY3VtZW50U2l6ZShkb2MpO1xyXG4gICAgICAgICAgICBkZWx0YSArPSBzaXplIC0gcHJldmlvdXNTaXplO1xyXG4gICAgICAgICAgICB0b0FwcGx5LnB1c2goeyBrZXk6IGtleSwgZG9jOiBkb2MgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRDYWNoZS5hZGRFbnRyaWVzKHRyYW5zYWN0aW9uLCB0b0FwcGx5LCBkZWx0YSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIucHJvdG90eXBlLmdldEZyb21DYWNoZSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudENhY2hlLmdldFNpemVkRW50cnkodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXI7XHJcbn0oUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIpKTtcclxuZnVuY3Rpb24gaXNEb2N1bWVudENoYW5nZU1pc3NpbmdFcnJvcihlcnIpIHtcclxuICAgIHJldHVybiAoZXJyLmNvZGUgPT09IENvZGUuREFUQV9MT1NTICYmXHJcbiAgICAgICAgZXJyLm1lc3NhZ2UgPT09IFJFTU9URV9ET0NVTUVOVF9DSEFOR0VfTUlTU0lOR19FUlJfTVNHKTtcclxufVxyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSByZW1vdGVEb2N1bWVudHMgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gcmVtb3RlRG9jdW1lbnRzU3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYlJlbW90ZURvY3VtZW50LnN0b3JlKTtcclxufVxyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSByZW1vdGVEb2N1bWVudENoYW5nZXMgb2JqZWN0XHJcbiAqIHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gZG9jdW1lbnRDaGFuZ2VzU3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYlJlbW90ZURvY3VtZW50Q2hhbmdlcy5zdG9yZSk7XHJcbn1cclxuZnVuY3Rpb24gZGJLZXkoZG9jS2V5KSB7XHJcbiAgICByZXR1cm4gZG9jS2V5LnBhdGgudG9BcnJheSgpO1xyXG59XHJcbi8qKlxyXG4gKiBSZXRydXNuIGFuIGFwcHJveGltYXRlIHNpemUgZm9yIHRoZSBnaXZlbiBkb2N1bWVudC5cclxuICovXHJcbmZ1bmN0aW9uIGRiRG9jdW1lbnRTaXplKGRvYykge1xyXG4gICAgdmFyIHZhbHVlO1xyXG4gICAgaWYgKGRvYy5kb2N1bWVudCkge1xyXG4gICAgICAgIHZhbHVlID0gZG9jLmRvY3VtZW50O1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoZG9jLnVua25vd25Eb2N1bWVudCkge1xyXG4gICAgICAgIHZhbHVlID0gZG9jLnVua25vd25Eb2N1bWVudDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGRvYy5ub0RvY3VtZW50KSB7XHJcbiAgICAgICAgdmFsdWUgPSBkb2Mubm9Eb2N1bWVudDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHRocm93IGZhaWwoJ1Vua25vd24gcmVtb3RlIGRvY3VtZW50IHR5cGUnKTtcclxuICAgIH1cclxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh2YWx1ZSkubGVuZ3RoO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogU2NoZW1hIFZlcnNpb24gZm9yIHRoZSBXZWIgY2xpZW50OlxyXG4gKiAxLiBJbml0aWFsIHZlcnNpb24gaW5jbHVkaW5nIE11dGF0aW9uIFF1ZXVlLCBRdWVyeSBDYWNoZSwgYW5kIFJlbW90ZSBEb2N1bWVudFxyXG4gKiAgICBDYWNoZVxyXG4gKiAyLiBVc2VkIHRvIGVuc3VyZSBhIHRhcmdldEdsb2JhbCBvYmplY3QgZXhpc3RzIGFuZCBhZGQgdGFyZ2V0Q291bnQgdG8gaXQuIE5vXHJcbiAqICAgIGxvbmdlciByZXF1aXJlZCBiZWNhdXNlIG1pZ3JhdGlvbiAzIHVuY29uZGl0aW9uYWxseSBjbGVhcnMgaXQuXHJcbiAqIDMuIERyb3BwZWQgYW5kIHJlLWNyZWF0ZWQgUXVlcnkgQ2FjaGUgdG8gZGVhbCB3aXRoIGNhY2hlIGNvcnJ1cHRpb24gcmVsYXRlZFxyXG4gKiAgICB0byBsaW1ibyByZXNvbHV0aW9uLiBBZGRyZXNzZXNcclxuICogICAgaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWlvcy1zZGsvaXNzdWVzLzE1NDhcclxuICogNC4gTXVsdGktVGFiIFN1cHBvcnQuXHJcbiAqIDUuIFJlbW92YWwgb2YgaGVsZCB3cml0ZSBhY2tzLlxyXG4gKi9cclxudmFyIFNDSEVNQV9WRVJTSU9OID0gNjtcclxuLyoqIFBlcmZvcm1zIGRhdGFiYXNlIGNyZWF0aW9uIGFuZCBzY2hlbWEgdXBncmFkZXMuICovXHJcbnZhciBTY2hlbWFDb252ZXJ0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTY2hlbWFDb252ZXJ0ZXIoc2VyaWFsaXplcikge1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFBlcmZvcm1zIGRhdGFiYXNlIGNyZWF0aW9uIGFuZCBzY2hlbWEgdXBncmFkZXMuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IGluIHByb2R1Y3Rpb24sIHRoaXMgbWV0aG9kIGlzIG9ubHkgZXZlciB1c2VkIHRvIHVwZ3JhZGUgdGhlIHNjaGVtYVxyXG4gICAgICogdG8gU0NIRU1BX1ZFUlNJT04uIERpZmZlcmVudCB2YWx1ZXMgb2YgdG9WZXJzaW9uIGFyZSBvbmx5IHVzZWQgZm9yIHRlc3RpbmdcclxuICAgICAqIGFuZCBsb2NhbCBmZWF0dXJlIGRldmVsb3BtZW50LlxyXG4gICAgICovXHJcbiAgICBTY2hlbWFDb252ZXJ0ZXIucHJvdG90eXBlLmNyZWF0ZU9yVXBncmFkZSA9IGZ1bmN0aW9uIChkYiwgdHhuLCBmcm9tVmVyc2lvbiwgdG9WZXJzaW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQoZnJvbVZlcnNpb24gPCB0b1ZlcnNpb24gJiZcclxuICAgICAgICAgICAgZnJvbVZlcnNpb24gPj0gMCAmJlxyXG4gICAgICAgICAgICB0b1ZlcnNpb24gPD0gU0NIRU1BX1ZFUlNJT04sIFwiVW5leHBlY3RlZCBzY2hlbWEgdXBncmFkZSBmcm9tIHZcIiArIGZyb21WZXJzaW9uICsgXCIgdG8gdnt0b1ZlcnNpb259LlwiKTtcclxuICAgICAgICBpZiAoZnJvbVZlcnNpb24gPCAxICYmIHRvVmVyc2lvbiA+PSAxKSB7XHJcbiAgICAgICAgICAgIGNyZWF0ZVByaW1hcnlDbGllbnRTdG9yZShkYik7XHJcbiAgICAgICAgICAgIGNyZWF0ZU11dGF0aW9uUXVldWUoZGIpO1xyXG4gICAgICAgICAgICBjcmVhdGVRdWVyeUNhY2hlKGRiKTtcclxuICAgICAgICAgICAgY3JlYXRlUmVtb3RlRG9jdW1lbnRDYWNoZShkYik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE1pZ3JhdGlvbiAyIHRvIHBvcHVsYXRlIHRoZSB0YXJnZXRHbG9iYWwgb2JqZWN0IG5vIGxvbmdlciBuZWVkZWQgc2luY2VcclxuICAgICAgICAvLyBtaWdyYXRpb24gMyB1bmNvbmRpdGlvbmFsbHkgY2xlYXJzIGl0LlxyXG4gICAgICAgIHZhciBwID0gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICBpZiAoZnJvbVZlcnNpb24gPCAzICYmIHRvVmVyc2lvbiA+PSAzKSB7XHJcbiAgICAgICAgICAgIC8vIEJyYW5kIG5ldyBjbGllbnRzIGRvbid0IG5lZWQgdG8gZHJvcCBhbmQgcmVjcmVhdGUtLW9ubHkgY2xpZW50cyB0aGF0XHJcbiAgICAgICAgICAgIC8vIHBvdGVudGlhbGx5IGhhdmUgY29ycnVwdCBkYXRhLlxyXG4gICAgICAgICAgICBpZiAoZnJvbVZlcnNpb24gIT09IDApIHtcclxuICAgICAgICAgICAgICAgIGRyb3BRdWVyeUNhY2hlKGRiKTtcclxuICAgICAgICAgICAgICAgIGNyZWF0ZVF1ZXJ5Q2FjaGUoZGIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHAgPSBwLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gd3JpdGVFbXB0eVRhcmdldEdsb2JhbEVudHJ5KHR4bik7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZnJvbVZlcnNpb24gPCA0ICYmIHRvVmVyc2lvbiA+PSA0KSB7XHJcbiAgICAgICAgICAgIGlmIChmcm9tVmVyc2lvbiAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gU2NoZW1hIHZlcnNpb24gMyB1c2VzIGF1dG8tZ2VuZXJhdGVkIGtleXMgdG8gZ2VuZXJhdGUgZ2xvYmFsbHkgdW5pcXVlXHJcbiAgICAgICAgICAgICAgICAvLyBtdXRhdGlvbiBiYXRjaCBJRHMgKHRoaXMgd2FzIHByZXZpb3VzbHkgZW5zdXJlZCBpbnRlcm5hbGx5IGJ5IHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gY2xpZW50KS4gVG8gbWlncmF0ZSB0byB0aGUgbmV3IHNjaGVtYSwgd2UgaGF2ZSB0byByZWFkIGFsbCBtdXRhdGlvbnNcclxuICAgICAgICAgICAgICAgIC8vIGFuZCB3cml0ZSB0aGVtIGJhY2sgb3V0LiBXZSBwcmVzZXJ2ZSB0aGUgZXhpc3RpbmcgYmF0Y2ggSURzIHRvIGd1YXJhbnRlZVxyXG4gICAgICAgICAgICAgICAgLy8gY29uc2lzdGVuY3kgd2l0aCBvdGhlciBvYmplY3Qgc3RvcmVzLiBBbnkgZnVydGhlciBtdXRhdGlvbiBiYXRjaCBJRHMgd2lsbFxyXG4gICAgICAgICAgICAgICAgLy8gYmUgYXV0by1nZW5lcmF0ZWQuXHJcbiAgICAgICAgICAgICAgICBwID0gcC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHVwZ3JhZGVNdXRhdGlvbkJhdGNoU2NoZW1hQW5kTWlncmF0ZURhdGEoZGIsIHR4bik7IH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHAgPSBwLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY3JlYXRlQ2xpZW50TWV0YWRhdGFTdG9yZShkYik7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVSZW1vdGVEb2N1bWVudENoYW5nZXNTdG9yZShkYik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZnJvbVZlcnNpb24gPCA1ICYmIHRvVmVyc2lvbiA+PSA1KSB7XHJcbiAgICAgICAgICAgIHAgPSBwLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucmVtb3ZlQWNrbm93bGVkZ2VkTXV0YXRpb25zKHR4bik7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZnJvbVZlcnNpb24gPCA2ICYmIHRvVmVyc2lvbiA+PSA2KSB7XHJcbiAgICAgICAgICAgIHAgPSBwLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY3JlYXRlRG9jdW1lbnRHbG9iYWxTdG9yZShkYik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuYWRkRG9jdW1lbnRHbG9iYWwodHhuKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwO1xyXG4gICAgfTtcclxuICAgIFNjaGVtYUNvbnZlcnRlci5wcm90b3R5cGUuYWRkRG9jdW1lbnRHbG9iYWwgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIGJ5dGVDb3VudCA9IDA7XHJcbiAgICAgICAgcmV0dXJuIHR4blxyXG4gICAgICAgICAgICAuc3RvcmUoRGJSZW1vdGVEb2N1bWVudC5zdG9yZSlcclxuICAgICAgICAgICAgLml0ZXJhdGUoZnVuY3Rpb24gKF8sIGRvYykge1xyXG4gICAgICAgICAgICBieXRlQ291bnQgKz0gZGJEb2N1bWVudFNpemUoZG9jKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YSA9IG5ldyBEYlJlbW90ZURvY3VtZW50R2xvYmFsKGJ5dGVDb3VudCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0eG5cclxuICAgICAgICAgICAgICAgIC5zdG9yZShEYlJlbW90ZURvY3VtZW50R2xvYmFsLnN0b3JlKVxyXG4gICAgICAgICAgICAgICAgLnB1dChEYlJlbW90ZURvY3VtZW50R2xvYmFsLmtleSwgbWV0YWRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNjaGVtYUNvbnZlcnRlci5wcm90b3R5cGUucmVtb3ZlQWNrbm93bGVkZ2VkTXV0YXRpb25zID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHF1ZXVlc1N0b3JlID0gdHhuLnN0b3JlKERiTXV0YXRpb25RdWV1ZS5zdG9yZSk7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uc1N0b3JlID0gdHhuLnN0b3JlKERiTXV0YXRpb25CYXRjaC5zdG9yZSk7XHJcbiAgICAgICAgcmV0dXJuIHF1ZXVlc1N0b3JlLmxvYWRBbGwoKS5uZXh0KGZ1bmN0aW9uIChxdWV1ZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHF1ZXVlcywgZnVuY3Rpb24gKHF1ZXVlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5ib3VuZChbcXVldWUudXNlcklkLCBCQVRDSElEX1VOS05PV05dLCBbcXVldWUudXNlcklkLCBxdWV1ZS5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZF0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9uc1N0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgLmxvYWRBbGwoRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNJbmRleCwgcmFuZ2UpXHJcbiAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGRiQmF0Y2hlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaChkYkJhdGNoZXMsIGZ1bmN0aW9uIChkYkJhdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydChkYkJhdGNoLnVzZXJJZCA9PT0gcXVldWUudXNlcklkLCBcIkNhbm5vdCBwcm9jZXNzIGJhdGNoIFwiICsgZGJCYXRjaC5iYXRjaElkICsgXCIgZnJvbSB1bmV4cGVjdGVkIHVzZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiYXRjaCA9IF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiTXV0YXRpb25CYXRjaChkYkJhdGNoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbW92ZU11dGF0aW9uQmF0Y2godHhuLCBxdWV1ZS51c2VySWQsIGJhdGNoKS5uZXh0KGZ1bmN0aW9uICgpIHsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNjaGVtYUNvbnZlcnRlcjtcclxufSgpKTtcclxuLyoqXHJcbiAqIFdyYXBwZXIgY2xhc3MgdG8gc3RvcmUgdGltZXN0YW1wcyAoc2Vjb25kcyBhbmQgbmFub3MpIGluIEluZGV4ZWREYiBvYmplY3RzLlxyXG4gKi9cclxudmFyIERiVGltZXN0YW1wID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJUaW1lc3RhbXAoc2Vjb25kcywgbmFub3NlY29uZHMpIHtcclxuICAgICAgICB0aGlzLnNlY29uZHMgPSBzZWNvbmRzO1xyXG4gICAgICAgIHRoaXMubmFub3NlY29uZHMgPSBuYW5vc2Vjb25kcztcclxuICAgIH1cclxuICAgIHJldHVybiBEYlRpbWVzdGFtcDtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgc2luZ2xldG9uIG9iamVjdCB0byBiZSBzdG9yZWQgaW4gdGhlICdvd25lcicgc3RvcmUgaW4gSW5kZXhlZERiLlxyXG4gKlxyXG4gKiBBIGdpdmVuIGRhdGFiYXNlIGNhbiBoYXZlIGEgc2luZ2xlIHByaW1hcnkgdGFiIGFzc2lnbmVkIGF0IGEgZ2l2ZW4gdGltZS4gVGhhdFxyXG4gKiB0YWIgbXVzdCB2YWxpZGF0ZSB0aGF0IGl0IGlzIHN0aWxsIGhvbGRpbmcgdGhlIHByaW1hcnkgbGVhc2UgYmVmb3JlIGV2ZXJ5XHJcbiAqIG9wZXJhdGlvbiB0aGF0IHJlcXVpcmVzIGxvY2tlZCBhY2Nlc3MuIFRoZSBwcmltYXJ5IHRhYiBzaG91bGQgcmVndWxhcmx5XHJcbiAqIHdyaXRlIGFuIHVwZGF0ZWQgdGltZXN0YW1wIHRvIHRoaXMgbGVhc2UgdG8gcHJldmVudCBvdGhlciB0YWJzIGZyb21cclxuICogXCJzdGVhbGluZ1wiIHRoZSBwcmltYXJ5IGxlYXNlXHJcbiAqL1xyXG52YXIgRGJQcmltYXJ5Q2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJQcmltYXJ5Q2xpZW50KG93bmVySWQsIFxyXG4gICAgLyoqIFdoZXRoZXIgdG8gYWxsb3cgc2hhcmVkIGFjY2VzcyBmcm9tIG11bHRpcGxlIHRhYnMuICovXHJcbiAgICBhbGxvd1RhYlN5bmNocm9uaXphdGlvbiwgbGVhc2VUaW1lc3RhbXBNcykge1xyXG4gICAgICAgIHRoaXMub3duZXJJZCA9IG93bmVySWQ7XHJcbiAgICAgICAgdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbiA9IGFsbG93VGFiU3luY2hyb25pemF0aW9uO1xyXG4gICAgICAgIHRoaXMubGVhc2VUaW1lc3RhbXBNcyA9IGxlYXNlVGltZXN0YW1wTXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IHRoZSBuYW1lICdvd25lcicgaXMgY2hvc2VuIHRvIGVuc3VyZSBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoXHJcbiAgICAgKiBvbGRlciBjbGllbnRzIHRoYXQgb25seSBzdXBwb3J0ZWQgc2luZ2xlIGxvY2tlZCBhY2Nlc3MgdG8gdGhlIHBlcnNpc3RlbmNlXHJcbiAgICAgKiBsYXllci5cclxuICAgICAqL1xyXG4gICAgRGJQcmltYXJ5Q2xpZW50LnN0b3JlID0gJ293bmVyJztcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGtleSBzdHJpbmcgdXNlZCBmb3IgdGhlIHNpbmdsZSBvYmplY3QgdGhhdCBleGlzdHMgaW4gdGhlXHJcbiAgICAgKiBEYlByaW1hcnlDbGllbnQgc3RvcmUuXHJcbiAgICAgKi9cclxuICAgIERiUHJpbWFyeUNsaWVudC5rZXkgPSAnb3duZXInO1xyXG4gICAgcmV0dXJuIERiUHJpbWFyeUNsaWVudDtcclxufSgpKTtcclxuZnVuY3Rpb24gY3JlYXRlUHJpbWFyeUNsaWVudFN0b3JlKGRiKSB7XHJcbiAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShEYlByaW1hcnlDbGllbnQuc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAnbXV0YXRpb25RdWV1ZXMnIHN0b3JlIGluIEluZGV4ZWREYi5cclxuICpcclxuICogRWFjaCB1c2VyIGdldHMgYSBzaW5nbGUgcXVldWUgb2YgTXV0YXRpb25CYXRjaGVzIHRvIGFwcGx5IHRvIHRoZSBzZXJ2ZXIuXHJcbiAqIERiTXV0YXRpb25RdWV1ZSB0cmFja3MgdGhlIG1ldGFkYXRhIGFib3V0IHRoZSBxdWV1ZS5cclxuICovXHJcbnZhciBEYk11dGF0aW9uUXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYk11dGF0aW9uUXVldWUoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBub3JtYWxpemVkIHVzZXIgSUQgdG8gd2hpY2ggdGhpcyBxdWV1ZSBiZWxvbmdzLlxyXG4gICAgICovXHJcbiAgICB1c2VySWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBbiBpZGVudGlmaWVyIGZvciB0aGUgaGlnaGVzdCBudW1iZXJlZCBiYXRjaCB0aGF0IGhhcyBiZWVuIGFja25vd2xlZGdlZFxyXG4gICAgICogYnkgdGhlIHNlcnZlci4gQWxsIE11dGF0aW9uQmF0Y2hlcyBpbiB0aGlzIHF1ZXVlIHdpdGggYmF0Y2hJZHMgbGVzc1xyXG4gICAgICogdGhhbiBvciBlcXVhbCB0byB0aGlzIHZhbHVlIGFyZSBjb25zaWRlcmVkIHRvIGhhdmUgYmVlbiBhY2tub3dsZWRnZWQgYnlcclxuICAgICAqIHRoZSBzZXJ2ZXIuXHJcbiAgICAgKi9cclxuICAgIGxhc3RBY2tub3dsZWRnZWRCYXRjaElkLCBcclxuICAgIC8qKlxyXG4gICAgICogQSBzdHJlYW0gdG9rZW4gdGhhdCB3YXMgcHJldmlvdXNseSBzZW50IGJ5IHRoZSBzZXJ2ZXIuXHJcbiAgICAgKlxyXG4gICAgICogU2VlIFN0cmVhbWluZ1dyaXRlUmVxdWVzdCBpbiBkYXRhc3RvcmUucHJvdG8gZm9yIG1vcmUgZGV0YWlscyBhYm91dFxyXG4gICAgICogdXNhZ2UuXHJcbiAgICAgKlxyXG4gICAgICogQWZ0ZXIgc2VuZGluZyB0aGlzIHRva2VuLCBlYXJsaWVyIHRva2VucyBtYXkgbm90IGJlIHVzZWQgYW55bW9yZSBzb1xyXG4gICAgICogb25seSBhIHNpbmdsZSBzdHJlYW0gdG9rZW4gaXMgcmV0YWluZWQuXHJcbiAgICAgKi9cclxuICAgIGxhc3RTdHJlYW1Ub2tlbikge1xyXG4gICAgICAgIHRoaXMudXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMubGFzdEFja25vd2xlZGdlZEJhdGNoSWQgPSBsYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZDtcclxuICAgICAgICB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IGxhc3RTdHJlYW1Ub2tlbjtcclxuICAgIH1cclxuICAgIC8qKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLiAgKi9cclxuICAgIERiTXV0YXRpb25RdWV1ZS5zdG9yZSA9ICdtdXRhdGlvblF1ZXVlcyc7XHJcbiAgICAvKiogS2V5cyBhcmUgYXV0b21hdGljYWxseSBhc3NpZ25lZCB2aWEgdGhlIHVzZXJJZCBwcm9wZXJ0eS4gKi9cclxuICAgIERiTXV0YXRpb25RdWV1ZS5rZXlQYXRoID0gJ3VzZXJJZCc7XHJcbiAgICByZXR1cm4gRGJNdXRhdGlvblF1ZXVlO1xyXG59KCkpO1xyXG4vKipcclxuICogQW4gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ211dGF0aW9ucycgc3RvcmUgaW4gSW5kZXhlZERiLlxyXG4gKlxyXG4gKiBSZXByZXNlbnRzIGEgYmF0Y2ggb2YgdXNlci1sZXZlbCBtdXRhdGlvbnMgaW50ZW5kZWQgdG8gYmUgc2VudCB0byB0aGUgc2VydmVyXHJcbiAqIGluIGEgc2luZ2xlIHdyaXRlLiBFYWNoIHVzZXItbGV2ZWwgYmF0Y2ggZ2V0cyBhIHNlcGFyYXRlIERiTXV0YXRpb25CYXRjaFxyXG4gKiB3aXRoIGEgbmV3IGJhdGNoSWQuXHJcbiAqL1xyXG52YXIgRGJNdXRhdGlvbkJhdGNoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJNdXRhdGlvbkJhdGNoKFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbm9ybWFsaXplZCB1c2VyIElEIHRvIHdoaWNoIHRoaXMgYmF0Y2ggYmVsb25ncy5cclxuICAgICAqL1xyXG4gICAgdXNlcklkLCBcclxuICAgIC8qKlxyXG4gICAgICogQW4gaWRlbnRpZmllciBmb3IgdGhpcyBiYXRjaCwgYWxsb2NhdGVkIHVzaW5nIGFuIGF1dG8tZ2VuZXJhdGVkIGtleS5cclxuICAgICAqL1xyXG4gICAgYmF0Y2hJZCwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBsb2NhbCB3cml0ZSB0aW1lIG9mIHRoZSBiYXRjaCwgc3RvcmVkIGFzIG1pbGxpc2Vjb25kcyBzaW5jZSB0aGVcclxuICAgICAqIGVwb2NoLlxyXG4gICAgICovXHJcbiAgICBsb2NhbFdyaXRlVGltZU1zLCBcclxuICAgIC8qKlxyXG4gICAgICogQSBsaXN0IG9mIG11dGF0aW9ucyB0byBhcHBseS4gQWxsIG11dGF0aW9ucyB3aWxsIGJlIGFwcGxpZWQgYXRvbWljYWxseS5cclxuICAgICAqXHJcbiAgICAgKiBNdXRhdGlvbnMgYXJlIHNlcmlhbGl6ZWQgdmlhIEpzb25Qcm90b1NlcmlhbGl6ZXIudG9NdXRhdGlvbigpLlxyXG4gICAgICovXHJcbiAgICBtdXRhdGlvbnMpIHtcclxuICAgICAgICB0aGlzLnVzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICB0aGlzLmJhdGNoSWQgPSBiYXRjaElkO1xyXG4gICAgICAgIHRoaXMubG9jYWxXcml0ZVRpbWVNcyA9IGxvY2FsV3JpdGVUaW1lTXM7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvbnMgPSBtdXRhdGlvbnM7XHJcbiAgICB9XHJcbiAgICAvKiogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS4gICovXHJcbiAgICBEYk11dGF0aW9uQmF0Y2guc3RvcmUgPSAnbXV0YXRpb25zJztcclxuICAgIC8qKiBLZXlzIGFyZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHZpYSB0aGUgdXNlcklkLCBiYXRjaElkIHByb3BlcnRpZXMuICovXHJcbiAgICBEYk11dGF0aW9uQmF0Y2gua2V5UGF0aCA9ICdiYXRjaElkJztcclxuICAgIC8qKiBUaGUgaW5kZXggbmFtZSBmb3IgbG9va3VwIG9mIG11dGF0aW9ucyBieSB1c2VyLiAqL1xyXG4gICAgRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNJbmRleCA9ICd1c2VyTXV0YXRpb25zSW5kZXgnO1xyXG4gICAgLyoqIFRoZSB1c2VyIG11dGF0aW9ucyBpbmRleCBpcyBrZXllZCBieSBbdXNlcklkLCBiYXRjaElkXSBwYWlycy4gKi9cclxuICAgIERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zS2V5UGF0aCA9IFsndXNlcklkJywgJ2JhdGNoSWQnXTtcclxuICAgIHJldHVybiBEYk11dGF0aW9uQmF0Y2g7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGNyZWF0ZU11dGF0aW9uUXVldWUoZGIpIHtcclxuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiTXV0YXRpb25RdWV1ZS5zdG9yZSwge1xyXG4gICAgICAgIGtleVBhdGg6IERiTXV0YXRpb25RdWV1ZS5rZXlQYXRoXHJcbiAgICB9KTtcclxuICAgIHZhciBtdXRhdGlvbkJhdGNoZXNTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiTXV0YXRpb25CYXRjaC5zdG9yZSwge1xyXG4gICAgICAgIGtleVBhdGg6IERiTXV0YXRpb25CYXRjaC5rZXlQYXRoLFxyXG4gICAgICAgIGF1dG9JbmNyZW1lbnQ6IHRydWVcclxuICAgIH0pO1xyXG4gICAgbXV0YXRpb25CYXRjaGVzU3RvcmUuY3JlYXRlSW5kZXgoRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNJbmRleCwgRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNLZXlQYXRoLCB7IHVuaXF1ZTogdHJ1ZSB9KTtcclxuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiRG9jdW1lbnRNdXRhdGlvbi5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIFVwZ3JhZGUgZnVuY3Rpb24gdG8gbWlncmF0ZSB0aGUgJ211dGF0aW9ucycgc3RvcmUgZnJvbSBWMSB0byBWMy4gTG9hZHNcclxuICogYW5kIHJld3JpdGVzIGFsbCBkYXRhLlxyXG4gKi9cclxuZnVuY3Rpb24gdXBncmFkZU11dGF0aW9uQmF0Y2hTY2hlbWFBbmRNaWdyYXRlRGF0YShkYiwgdHhuKSB7XHJcbiAgICB2YXIgdjFNdXRhdGlvbnNTdG9yZSA9IHR4bi5zdG9yZShEYk11dGF0aW9uQmF0Y2guc3RvcmUpO1xyXG4gICAgcmV0dXJuIHYxTXV0YXRpb25zU3RvcmUubG9hZEFsbCgpLm5leHQoZnVuY3Rpb24gKGV4aXN0aW5nTXV0YXRpb25zKSB7XHJcbiAgICAgICAgZGIuZGVsZXRlT2JqZWN0U3RvcmUoRGJNdXRhdGlvbkJhdGNoLnN0b3JlKTtcclxuICAgICAgICB2YXIgbXV0YXRpb25zU3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZShEYk11dGF0aW9uQmF0Y2guc3RvcmUsIHtcclxuICAgICAgICAgICAga2V5UGF0aDogRGJNdXRhdGlvbkJhdGNoLmtleVBhdGgsXHJcbiAgICAgICAgICAgIGF1dG9JbmNyZW1lbnQ6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgICBtdXRhdGlvbnNTdG9yZS5jcmVhdGVJbmRleChEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0luZGV4LCBEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0tleVBhdGgsIHsgdW5pcXVlOiB0cnVlIH0pO1xyXG4gICAgICAgIHZhciB2M011dGF0aW9uc1N0b3JlID0gdHhuLnN0b3JlKERiTXV0YXRpb25CYXRjaC5zdG9yZSk7XHJcbiAgICAgICAgdmFyIHdyaXRlQWxsID0gZXhpc3RpbmdNdXRhdGlvbnMubWFwKGZ1bmN0aW9uIChtdXRhdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdjNNdXRhdGlvbnNTdG9yZS5wdXQobXV0YXRpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcih3cml0ZUFsbCk7XHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICogQW4gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ2RvY3VtZW50TXV0YXRpb25zJyBzdG9yZSBpbiBJbmRleGVkRGIuXHJcbiAqXHJcbiAqIEEgbWFudWFsbHkgbWFpbnRhaW5lZCBpbmRleCBvZiBhbGwgdGhlIG11dGF0aW9uIGJhdGNoZXMgdGhhdCBhZmZlY3QgYSBnaXZlblxyXG4gKiBkb2N1bWVudCBrZXkuIFRoZSByb3dzIGluIHRoaXMgdGFibGUgYXJlIHJlZmVyZW5jZXMgYmFzZWQgb24gdGhlIGNvbnRlbnRzIG9mXHJcbiAqIERiTXV0YXRpb25CYXRjaC5tdXRhdGlvbnMuXHJcbiAqL1xyXG52YXIgRGJEb2N1bWVudE11dGF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJEb2N1bWVudE11dGF0aW9uKCkge1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgW3VzZXJJZF0ga2V5IGZvciB1c2UgaW4gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnMgaW5kZXggdG8gaXRlcmF0ZVxyXG4gICAgICogb3ZlciBhbGwgb2YgYSB1c2VyJ3MgZG9jdW1lbnQgbXV0YXRpb25zLlxyXG4gICAgICovXHJcbiAgICBEYkRvY3VtZW50TXV0YXRpb24ucHJlZml4Rm9yVXNlciA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICByZXR1cm4gW3VzZXJJZF07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgW3VzZXJJZCwgZW5jb2RlZFBhdGhdIGtleSBmb3IgdXNlIGluIHRoZSBEYkRvY3VtZW50TXV0YXRpb25zXHJcbiAgICAgKiBpbmRleCB0byBpdGVyYXRlIG92ZXIgYWxsIGF0IGRvY3VtZW50IG11dGF0aW9ucyBmb3IgYSBnaXZlbiBwYXRoIG9yIGxvd2VyLlxyXG4gICAgICovXHJcbiAgICBEYkRvY3VtZW50TXV0YXRpb24ucHJlZml4Rm9yUGF0aCA9IGZ1bmN0aW9uICh1c2VySWQsIHBhdGgpIHtcclxuICAgICAgICByZXR1cm4gW3VzZXJJZCwgZW5jb2RlKHBhdGgpXTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBmdWxsIGluZGV4IGtleSBvZiBbdXNlcklkLCBlbmNvZGVkUGF0aCwgYmF0Y2hJZF0gZm9yIGluc2VydGluZ1xyXG4gICAgICogYW5kIGRlbGV0aW5nIGludG8gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnMgaW5kZXguXHJcbiAgICAgKi9cclxuICAgIERiRG9jdW1lbnRNdXRhdGlvbi5rZXkgPSBmdW5jdGlvbiAodXNlcklkLCBwYXRoLCBiYXRjaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIFt1c2VySWQsIGVuY29kZShwYXRoKSwgYmF0Y2hJZF07XHJcbiAgICB9O1xyXG4gICAgRGJEb2N1bWVudE11dGF0aW9uLnN0b3JlID0gJ2RvY3VtZW50TXV0YXRpb25zJztcclxuICAgIC8qKlxyXG4gICAgICogQmVjYXVzZSB3ZSBzdG9yZSBhbGwgdGhlIHVzZWZ1bCBpbmZvcm1hdGlvbiBmb3IgdGhpcyBzdG9yZSBpbiB0aGUga2V5LFxyXG4gICAgICogdGhlcmUgaXMgbm8gdXNlZnVsIGluZm9ybWF0aW9uIHRvIHN0b3JlIGFzIHRoZSB2YWx1ZS4gVGhlIHJhdyAodW5lbmNvZGVkKVxyXG4gICAgICogcGF0aCBjYW5ub3QgYmUgc3RvcmVkIGJlY2F1c2UgSW5kZXhlZERiIGRvZXNuJ3Qgc3RvcmUgcHJvdG90eXBlXHJcbiAgICAgKiBpbmZvcm1hdGlvbi5cclxuICAgICAqL1xyXG4gICAgRGJEb2N1bWVudE11dGF0aW9uLlBMQUNFSE9MREVSID0gbmV3IERiRG9jdW1lbnRNdXRhdGlvbigpO1xyXG4gICAgcmV0dXJuIERiRG9jdW1lbnRNdXRhdGlvbjtcclxufSgpKTtcclxuZnVuY3Rpb24gY3JlYXRlUmVtb3RlRG9jdW1lbnRDYWNoZShkYikge1xyXG4gICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJSZW1vdGVEb2N1bWVudC5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgdGhlIGtub3duIGFic2VuY2Ugb2YgYSBkb2N1bWVudCBhdCBhIHBhcnRpY3VsYXIgdmVyc2lvbi5cclxuICogU3RvcmVkIGluIEluZGV4ZWREYiBhcyBwYXJ0IG9mIGEgRGJSZW1vdGVEb2N1bWVudCBvYmplY3QuXHJcbiAqL1xyXG52YXIgRGJOb0RvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJOb0RvY3VtZW50KHBhdGgsIHJlYWRUaW1lKSB7XHJcbiAgICAgICAgdGhpcy5wYXRoID0gcGF0aDtcclxuICAgICAgICB0aGlzLnJlYWRUaW1lID0gcmVhZFRpbWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRGJOb0RvY3VtZW50O1xyXG59KCkpO1xyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gZXhpc3QgYnV0IHdob3NlIGRhdGEgaXMgdW5rbm93bi5cclxuICogU3RvcmVkIGluIEluZGV4ZWREYiBhcyBwYXJ0IG9mIGEgRGJSZW1vdGVEb2N1bWVudCBvYmplY3QuXHJcbiAqL1xyXG52YXIgRGJVbmtub3duRG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYlVua25vd25Eb2N1bWVudChwYXRoLCB2ZXJzaW9uKSB7XHJcbiAgICAgICAgdGhpcy5wYXRoID0gcGF0aDtcclxuICAgICAgICB0aGlzLnZlcnNpb24gPSB2ZXJzaW9uO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIERiVW5rbm93bkRvY3VtZW50O1xyXG59KCkpO1xyXG4vKipcclxuICogQW4gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ3JlbW90ZURvY3VtZW50cycgc3RvcmUgaW4gSW5kZXhlZERiLlxyXG4gKiBJdCByZXByZXNlbnRzIGVpdGhlcjpcclxuICpcclxuICogLSBBIGNvbXBsZXRlIGRvY3VtZW50LlxyXG4gKiAtIEEgXCJubyBkb2N1bWVudFwiIHJlcHJlc2VudGluZyBhIGRvY3VtZW50IHRoYXQgaXMga25vd24gbm90IHRvIGV4aXN0IChhdFxyXG4gKiBzb21lIHZlcnNpb24pLlxyXG4gKiAtIEFuIFwidW5rbm93biBkb2N1bWVudFwiIHJlcHJlc2VudGluZyBhIGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gZXhpc3QgKGF0XHJcbiAqIHNvbWUgdmVyc2lvbikgYnV0IHdob3NlIGNvbnRlbnRzIGFyZSB1bmtub3duLlxyXG4gKlxyXG4gKiBOb3RlOiBUaGlzIGlzIHRoZSBwZXJzaXN0ZWQgZXF1aXZhbGVudCBvZiBhIE1heWJlRG9jdW1lbnQgYW5kIGNvdWxkIHBlcmhhcHNcclxuICogYmUgbWFkZSBtb3JlIGdlbmVyYWwgaWYgbmVjZXNzYXJ5LlxyXG4gKi9cclxudmFyIERiUmVtb3RlRG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYlJlbW90ZURvY3VtZW50KFxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdG8gYW4gaW5zdGFuY2Ugb2YgRGJVbmtub3duRG9jdW1lbnQgaWYgdGhlIGRhdGEgZm9yIGEgZG9jdW1lbnQgaXNcclxuICAgICAqIG5vdCBrbm93biwgYnV0IGl0IGlzIGtub3duIHRoYXQgYSBkb2N1bWVudCBleGlzdHMgYXQgdGhlIHNwZWNpZmllZFxyXG4gICAgICogdmVyc2lvbiAoZS5nLiBpdCBoYWQgYSBzdWNjZXNzZnVsIHVwZGF0ZSBhcHBsaWVkIHRvIGl0KVxyXG4gICAgICovXHJcbiAgICB1bmtub3duRG9jdW1lbnQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdG8gYW4gaW5zdGFuY2Ugb2YgYSBEYk5vRG9jdW1lbnQgaWYgaXQgaXMga25vd24gdGhhdCBubyBkb2N1bWVudFxyXG4gICAgICogZXhpc3RzLlxyXG4gICAgICovXHJcbiAgICBub0RvY3VtZW50LCBcclxuICAgIC8qKlxyXG4gICAgICogU2V0IHRvIGFuIGluc3RhbmNlIG9mIGEgRG9jdW1lbnQgaWYgdGhlcmUncyBhIGNhY2hlZCB2ZXJzaW9uIG9mIHRoZVxyXG4gICAgICogZG9jdW1lbnQuXHJcbiAgICAgKi9cclxuICAgIGRvY3VtZW50LCBcclxuICAgIC8qKlxyXG4gICAgICogRG9jdW1lbnRzIHRoYXQgd2VyZSB3cml0dGVuIHRvIHRoZSByZW1vdGUgZG9jdW1lbnQgc3RvcmUgYmFzZWQgb25cclxuICAgICAqIGEgd3JpdGUgYWNrbm93bGVkZ21lbnQgYXJlIG1hcmtlZCB3aXRoIGBoYXNDb21taXR0ZWRNdXRhdGlvbnNgLiBUaGVzZVxyXG4gICAgICogZG9jdW1lbnRzIGFyZSBwb3RlbnRpYWxseSBpbmNvbnNpc3RlbnQgd2l0aCB0aGUgYmFja2VuZCdzIGNvcHkgYW5kIHVzZVxyXG4gICAgICogdGhlIHdyaXRlJ3MgY29tbWl0IHZlcnNpb24gYXMgdGhlaXIgZG9jdW1lbnQgdmVyc2lvbi5cclxuICAgICAqL1xyXG4gICAgaGFzQ29tbWl0dGVkTXV0YXRpb25zKSB7XHJcbiAgICAgICAgdGhpcy51bmtub3duRG9jdW1lbnQgPSB1bmtub3duRG9jdW1lbnQ7XHJcbiAgICAgICAgdGhpcy5ub0RvY3VtZW50ID0gbm9Eb2N1bWVudDtcclxuICAgICAgICB0aGlzLmRvY3VtZW50ID0gZG9jdW1lbnQ7XHJcbiAgICAgICAgdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnMgPSBoYXNDb21taXR0ZWRNdXRhdGlvbnM7XHJcbiAgICB9XHJcbiAgICBEYlJlbW90ZURvY3VtZW50LnN0b3JlID0gJ3JlbW90ZURvY3VtZW50cyc7XHJcbiAgICByZXR1cm4gRGJSZW1vdGVEb2N1bWVudDtcclxufSgpKTtcclxuLyoqXHJcbiAqIENvbnRhaW5zIGEgc2luZ2xlIGVudHJ5IHRoYXQgaGFzIG1ldGFkYXRhIGFib3V0IHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUuXHJcbiAqL1xyXG52YXIgRGJSZW1vdGVEb2N1bWVudEdsb2JhbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIGJ5dGVTaXplIEFwcHJveGltYXRlbHkgdGhlIHRvdGFsIHNpemUgaW4gYnl0ZXMgb2YgYWxsIHRoZSBkb2N1bWVudHMgaW4gdGhlIGRvY3VtZW50XHJcbiAgICAgKiBjYWNoZS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gRGJSZW1vdGVEb2N1bWVudEdsb2JhbChieXRlU2l6ZSkge1xyXG4gICAgICAgIHRoaXMuYnl0ZVNpemUgPSBieXRlU2l6ZTtcclxuICAgIH1cclxuICAgIERiUmVtb3RlRG9jdW1lbnRHbG9iYWwuc3RvcmUgPSAncmVtb3RlRG9jdW1lbnRHbG9iYWwnO1xyXG4gICAgRGJSZW1vdGVEb2N1bWVudEdsb2JhbC5rZXkgPSAncmVtb3RlRG9jdW1lbnRHbG9iYWxLZXknO1xyXG4gICAgcmV0dXJuIERiUmVtb3RlRG9jdW1lbnRHbG9iYWw7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGNyZWF0ZURvY3VtZW50R2xvYmFsU3RvcmUoZGIpIHtcclxuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiUmVtb3RlRG9jdW1lbnRHbG9iYWwuc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAndGFyZ2V0cycgc3RvcmUgaW4gSW5kZXhlZERiLlxyXG4gKlxyXG4gKiBUaGlzIGlzIGJhc2VkIG9uIGFuZCBzaG91bGQgYmUga2VwdCBpbiBzeW5jIHdpdGggdGhlIHByb3RvIHVzZWQgaW4gdGhlIGlPU1xyXG4gKiBjbGllbnQuXHJcbiAqXHJcbiAqIEVhY2ggcXVlcnkgdGhlIGNsaWVudCBsaXN0ZW5zIHRvIGFnYWluc3QgdGhlIHNlcnZlciBpcyB0cmFja2VkIG9uIGRpc2sgc29cclxuICogdGhhdCB0aGUgcXVlcnkgY2FuIGJlIGVmZmljaWVudGx5IHJlc3VtZWQgb24gcmVzdGFydC5cclxuICovXHJcbnZhciBEYlRhcmdldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiVGFyZ2V0KFxyXG4gICAgLyoqXHJcbiAgICAgKiBBbiBhdXRvLWdlbmVyYXRlZCBzZXF1ZW50aWFsIG51bWVyaWMgaWRlbnRpZmllciBmb3IgdGhlIHF1ZXJ5LlxyXG4gICAgICpcclxuICAgICAqIFF1ZXJpZXMgYXJlIHN0b3JlZCB1c2luZyB0aGVpciBjYW5vbmljYWxJZCBhcyB0aGUga2V5LCBidXQgdGhlc2VcclxuICAgICAqIGNhbm9uaWNhbElkcyBjYW4gYmUgcXVpdGUgbG9uZyBzbyB3ZSBhZGRpdGlvbmFsbHkgYXNzaWduIGEgdW5pcXVlXHJcbiAgICAgKiBxdWVyeUlkIHdoaWNoIGNhbiBiZSB1c2VkIGJ5IHJlZmVyZW5jZWQgZGF0YSBzdHJ1Y3R1cmVzIChlLmcuXHJcbiAgICAgKiBpbmRleGVzKSB0byBtaW5pbWl6ZSB0aGUgb24tZGlzayBjb3N0LlxyXG4gICAgICovXHJcbiAgICB0YXJnZXRJZCwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBjYW5vbmljYWwgc3RyaW5nIHJlcHJlc2VudGluZyB0aGlzIHF1ZXJ5LiBUaGlzIGlzIG5vdCB1bmlxdWUuXHJcbiAgICAgKi9cclxuICAgIGNhbm9uaWNhbElkLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGxhc3QgcmVhZFRpbWUgcmVjZWl2ZWQgZnJvbSB0aGUgV2F0Y2ggU2VydmljZSBmb3IgdGhpcyBxdWVyeS5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIGlzIHRoZSBzYW1lIHZhbHVlIGFzIFRhcmdldENoYW5nZS5yZWFkX3RpbWUgaW4gdGhlIHByb3Rvcy5cclxuICAgICAqL1xyXG4gICAgcmVhZFRpbWUsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHF1ZXJ5IHRvIGJlXHJcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGFcclxuICAgICAqIHRoYXQgbWF0Y2hlcyB0aGUgcXVlcnkuIFRoZSByZXN1bWUgdG9rZW4gZXNzZW50aWFsbHkgaWRlbnRpZmllcyBhXHJcbiAgICAgKiBwb2ludCBpbiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIGlzIHJlbGF0ZWQgdG8gdGhlIHNuYXBzaG90VmVyc2lvbiBpbiB0aGF0IHRoZSByZXN1bWVUb2tlblxyXG4gICAgICogZWZmZWN0aXZlbHkgYWxzbyBlbmNvZGVzIHRoYXQgdmFsdWUsIGJ1dCB0aGUgcmVzdW1lVG9rZW4gaXMgb3BhcXVlXHJcbiAgICAgKiBhbmQgc29tZXRpbWVzIGVuY29kZXMgYWRkaXRpb25hbCBpbmZvcm1hdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBBIGNvbnNlcXVlbmNlIG9mIHRoaXMgaXMgdGhhdCB0aGUgcmVzdW1lVG9rZW4gc2hvdWxkIGJlIHVzZWQgd2hlblxyXG4gICAgICogYXNraW5nIHRoZSBzZXJ2ZXIgdG8gcmVhc29uIGFib3V0IHdoZXJlIHRoaXMgY2xpZW50IGlzIGluIHRoZSB3YXRjaFxyXG4gICAgICogc3RyZWFtLCBidXQgdGhlIGNsaWVudCBzaG91bGQgdXNlIHRoZSBzbmFwc2hvdFZlcnNpb24gZm9yIGl0cyBvd25cclxuICAgICAqIHB1cnBvc2VzLlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgaXMgdGhlIHNhbWUgdmFsdWUgYXMgVGFyZ2V0Q2hhbmdlLnJlc3VtZV90b2tlbiBpbiB0aGUgcHJvdG9zLlxyXG4gICAgICovXHJcbiAgICByZXN1bWVUb2tlbiwgXHJcbiAgICAvKipcclxuICAgICAqIEEgc2VxdWVuY2UgbnVtYmVyIHJlcHJlc2VudGluZyB0aGUgbGFzdCB0aW1lIHRoaXMgcXVlcnkgd2FzXHJcbiAgICAgKiBsaXN0ZW5lZCB0bywgdXNlZCBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIHB1cnBvc2VzLlxyXG4gICAgICpcclxuICAgICAqIENvbnZlbnRpb25hbGx5IHRoaXMgd291bGQgYmUgYSB0aW1lc3RhbXAgdmFsdWUsIGJ1dCBkZXZpY2UtbG9jYWxcclxuICAgICAqIGNsb2NrcyBhcmUgdW5yZWxpYWJsZSBhbmQgdGhleSBtdXN0IGJlIGFibGUgdG8gY3JlYXRlIG5ldyBsaXN0ZW5zXHJcbiAgICAgKiBldmVuIHdoaWxlIGRpc2Nvbm5lY3RlZC4gSW5zdGVhZCB0aGlzIHNob3VsZCBiZSBhIG1vbm90b25pY2FsbHlcclxuICAgICAqIGluY3JlYXNpbmcgbnVtYmVyIHRoYXQncyBpbmNyZW1lbnRlZCBvbiBlYWNoIGxpc3RlbiBjYWxsLlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgaXMgZGlmZmVyZW50IGZyb20gdGhlIHF1ZXJ5SWQgc2luY2UgdGhlIHF1ZXJ5SWQgaXMgYW5cclxuICAgICAqIGltbXV0YWJsZSBpZGVudGlmaWVyIGFzc2lnbmVkIHRvIHRoZSBRdWVyeSBvbiBmaXJzdCB1c2Ugd2hpbGVcclxuICAgICAqIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciBpcyB1cGRhdGVkIGV2ZXJ5IHRpbWUgdGhlIHF1ZXJ5IGlzXHJcbiAgICAgKiBsaXN0ZW5lZCB0by5cclxuICAgICAqL1xyXG4gICAgbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHF1ZXJ5IGZvciB0aGlzIHRhcmdldC5cclxuICAgICAqXHJcbiAgICAgKiBCZWNhdXNlIGNhbm9uaWNhbCBpZHMgYXJlIG5vdCB1bmlxdWUgd2UgbXVzdCBzdG9yZSB0aGUgYWN0dWFsIHF1ZXJ5LiBXZVxyXG4gICAgICogdXNlIHRoZSBwcm90byB0byBoYXZlIGFuIG9iamVjdCB3ZSBjYW4gcGVyc2lzdCB3aXRob3V0IGhhdmluZyB0b1xyXG4gICAgICogZHVwbGljYXRlIHRyYW5zbGF0aW9uIGxvZ2ljIHRvIGFuZCBmcm9tIGEgYFF1ZXJ5YCBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIHF1ZXJ5KSB7XHJcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHRhcmdldElkO1xyXG4gICAgICAgIHRoaXMuY2Fub25pY2FsSWQgPSBjYW5vbmljYWxJZDtcclxuICAgICAgICB0aGlzLnJlYWRUaW1lID0gcmVhZFRpbWU7XHJcbiAgICAgICAgdGhpcy5yZXN1bWVUb2tlbiA9IHJlc3VtZVRva2VuO1xyXG4gICAgICAgIHRoaXMubGFzdExpc3RlblNlcXVlbmNlTnVtYmVyID0gbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgIH1cclxuICAgIERiVGFyZ2V0LnN0b3JlID0gJ3RhcmdldHMnO1xyXG4gICAgLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB0YXJnZXRJZCBwcm9wZXJ0eS4gKi9cclxuICAgIERiVGFyZ2V0LmtleVBhdGggPSAndGFyZ2V0SWQnO1xyXG4gICAgLyoqIFRoZSBuYW1lIG9mIHRoZSBxdWVyeVRhcmdldHMgaW5kZXguICovXHJcbiAgICBEYlRhcmdldC5xdWVyeVRhcmdldHNJbmRleE5hbWUgPSAncXVlcnlUYXJnZXRzSW5kZXgnO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgaW5kZXggb2YgYWxsIGNhbm9uaWNhbElkcyB0byB0aGUgdGFyZ2V0cyB0aGF0IHRoZXkgbWF0Y2guIFRoaXMgaXMgbm90XHJcbiAgICAgKiBhIHVuaXF1ZSBtYXBwaW5nIGJlY2F1c2UgY2Fub25pY2FsSWQgZG9lcyBub3QgcHJvbWlzZSBhIHVuaXF1ZSBuYW1lIGZvciBhbGxcclxuICAgICAqIHBvc3NpYmxlIHF1ZXJpZXMsIHNvIHdlIGFwcGVuZCB0aGUgdGFyZ2V0SWQgdG8gbWFrZSB0aGUgbWFwcGluZyB1bmlxdWUuXHJcbiAgICAgKi9cclxuICAgIERiVGFyZ2V0LnF1ZXJ5VGFyZ2V0c0tleVBhdGggPSBbJ2Nhbm9uaWNhbElkJywgJ3RhcmdldElkJ107XHJcbiAgICByZXR1cm4gRGJUYXJnZXQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBbiBvYmplY3QgcmVwcmVzZW50aW5nIGFuIGFzc29jaWF0aW9uIGJldHdlZW4gYSB0YXJnZXQgYW5kIGEgZG9jdW1lbnQsIG9yIGFcclxuICogc2VudGluZWwgcm93IG1hcmtpbmcgdGhlIGxhc3Qgc2VxdWVuY2UgbnVtYmVyIGF0IHdoaWNoIGEgZG9jdW1lbnQgd2FzIHVzZWQuXHJcbiAqIEVhY2ggZG9jdW1lbnQgY2FjaGVkIG11c3QgaGF2ZSBhIGNvcnJlc3BvbmRpbmcgc2VudGluZWwgcm93IGJlZm9yZSBscnVcclxuICogZ2FyYmFnZSBjb2xsZWN0aW9uIGlzIGVuYWJsZWQuXHJcbiAqXHJcbiAqIFRoZSB0YXJnZXQgYXNzb2NpYXRpb25zIGFuZCBzZW50aW5lbCByb3dzIGFyZSBjby1sb2NhdGVkIHNvIHRoYXQgb3JwaGFuZWRcclxuICogZG9jdW1lbnRzIGFuZCB0aGVpciBzZXF1ZW5jZSBudW1iZXJzIGNhbiBiZSBpZGVudGlmaWVkIGVmZmljaWVudGx5IHZpYSBhIHNjYW5cclxuICogb2YgdGhpcyBzdG9yZS5cclxuICovXHJcbnZhciBEYlRhcmdldERvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJUYXJnZXREb2N1bWVudChcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHRhcmdldElkIGlkZW50aWZ5aW5nIGEgdGFyZ2V0IG9yIDAgZm9yIGEgc2VudGluZWwgcm93LlxyXG4gICAgICovXHJcbiAgICB0YXJnZXRJZCwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBwYXRoIHRvIHRoZSBkb2N1bWVudCwgYXMgZW5jb2RlZCBpbiB0aGUga2V5LlxyXG4gICAgICovXHJcbiAgICBwYXRoLCBcclxuICAgIC8qKlxyXG4gICAgICogSWYgdGhpcyBpcyBhIHNlbnRpbmVsIHJvdywgdGhpcyBzaG91bGQgYmUgdGhlIHNlcXVlbmNlIG51bWJlciBvZiB0aGUgbGFzdFxyXG4gICAgICogdGltZSB0aGUgZG9jdW1lbnQgc3BlY2lmaWVkIGJ5IGBwYXRoYCB3YXMgdXNlZC4gT3RoZXJ3aXNlLCBpdCBzaG91bGQgYmVcclxuICAgICAqIGB1bmRlZmluZWRgLlxyXG4gICAgICovXHJcbiAgICBzZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0YXJnZXRJZDtcclxuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xyXG4gICAgICAgIHRoaXMuc2VxdWVuY2VOdW1iZXIgPSBzZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICBhc3NlcnQoKHRhcmdldElkID09PSAwKSA9PT0gKHNlcXVlbmNlTnVtYmVyICE9PSB1bmRlZmluZWQpLCBcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoXHJcbiAgICAgICAgJ0EgdGFyZ2V0LWRvY3VtZW50IHJvdyBtdXN0IGVpdGhlciBoYXZlIHRhcmdldElkID09IDAgYW5kIGEgZGVmaW5lZCBzZXF1ZW5jZSBudW1iZXIsIG9yIGEgbm9uLXplcm8gdGFyZ2V0SWQgYW5kIG5vIHNlcXVlbmNlIG51bWJlcicpO1xyXG4gICAgfVxyXG4gICAgLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICAqL1xyXG4gICAgRGJUYXJnZXREb2N1bWVudC5zdG9yZSA9ICd0YXJnZXREb2N1bWVudHMnO1xyXG4gICAgLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB0YXJnZXRJZCwgcGF0aCBwcm9wZXJ0aWVzLiAqL1xyXG4gICAgRGJUYXJnZXREb2N1bWVudC5rZXlQYXRoID0gWyd0YXJnZXRJZCcsICdwYXRoJ107XHJcbiAgICAvKiogVGhlIGluZGV4IG5hbWUgZm9yIHRoZSByZXZlcnNlIGluZGV4LiAqL1xyXG4gICAgRGJUYXJnZXREb2N1bWVudC5kb2N1bWVudFRhcmdldHNJbmRleCA9ICdkb2N1bWVudFRhcmdldHNJbmRleCc7XHJcbiAgICAvKiogV2UgYWxzbyBuZWVkIHRvIGNyZWF0ZSB0aGUgcmV2ZXJzZSBpbmRleCBmb3IgdGhlc2UgcHJvcGVydGllcy4gKi9cclxuICAgIERiVGFyZ2V0RG9jdW1lbnQuZG9jdW1lbnRUYXJnZXRzS2V5UGF0aCA9IFsncGF0aCcsICd0YXJnZXRJZCddO1xyXG4gICAgcmV0dXJuIERiVGFyZ2V0RG9jdW1lbnQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIHJlY29yZCBvZiBnbG9iYWwgc3RhdGUgdHJhY2tlZCBhY3Jvc3MgYWxsIFRhcmdldHMsIHRyYWNrZWQgc2VwYXJhdGVseVxyXG4gKiB0byBhdm9pZCB0aGUgbmVlZCBmb3IgZXh0cmEgaW5kZXhlcy5cclxuICpcclxuICogVGhpcyBzaG91bGQgYmUga2VwdCBpbi1zeW5jIHdpdGggdGhlIHByb3RvIHVzZWQgaW4gdGhlIGlPUyBjbGllbnQuXHJcbiAqL1xyXG52YXIgRGJUYXJnZXRHbG9iYWwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYlRhcmdldEdsb2JhbChcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGhpZ2hlc3QgbnVtYmVyZWQgdGFyZ2V0IGlkIGFjcm9zcyBhbGwgdGFyZ2V0cy5cclxuICAgICAqXHJcbiAgICAgKiBTZWUgRGJUYXJnZXQudGFyZ2V0SWQuXHJcbiAgICAgKi9cclxuICAgIGhpZ2hlc3RUYXJnZXRJZCwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBoaWdoZXN0IG51bWJlcmVkIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciBhY3Jvc3MgYWxsIHRhcmdldHMuXHJcbiAgICAgKlxyXG4gICAgICogU2VlIERiVGFyZ2V0Lmxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlci5cclxuICAgICAqL1xyXG4gICAgaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyLCBcclxuICAgIC8qKlxyXG4gICAgICogQSBnbG9iYWwgc25hcHNob3QgdmVyc2lvbiByZXByZXNlbnRpbmcgdGhlIGxhc3QgY29uc2lzdGVudCBzbmFwc2hvdCB3ZVxyXG4gICAgICogcmVjZWl2ZWQgZnJvbSB0aGUgYmFja2VuZC4gVGhpcyBpcyBtb25vdG9uaWNhbGx5IGluY3JlYXNpbmcgYW5kIGFueVxyXG4gICAgICogc25hcHNob3RzIHJlY2VpdmVkIGZyb20gdGhlIGJhY2tlbmQgcHJpb3IgdG8gdGhpcyB2ZXJzaW9uIChlLmcuIGZvclxyXG4gICAgICogdGFyZ2V0cyByZXN1bWVkIHdpdGggYSByZXN1bWVUb2tlbikgc2hvdWxkIGJlIHN1cHByZXNzZWQgKGJ1ZmZlcmVkKVxyXG4gICAgICogdW50aWwgdGhlIGJhY2tlbmQgaGFzIGNhdWdodCB1cCB0byB0aGlzIHNuYXBzaG90IHZlcnNpb24gYWdhaW4uIFRoaXNcclxuICAgICAqIHByZXZlbnRzIG91ciBjYWNoZSBmcm9tIGV2ZXIgZ29pbmcgYmFja3dhcmRzIGluIHRpbWUuXHJcbiAgICAgKi9cclxuICAgIGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24sIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbnVtYmVyIG9mIHRhcmdldHMgcGVyc2lzdGVkLlxyXG4gICAgICovXHJcbiAgICB0YXJnZXRDb3VudCkge1xyXG4gICAgICAgIHRoaXMuaGlnaGVzdFRhcmdldElkID0gaGlnaGVzdFRhcmdldElkO1xyXG4gICAgICAgIHRoaXMuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID0gaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgIHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb247XHJcbiAgICAgICAgdGhpcy50YXJnZXRDb3VudCA9IHRhcmdldENvdW50O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUga2V5IHN0cmluZyB1c2VkIGZvciB0aGUgc2luZ2xlIG9iamVjdCB0aGF0IGV4aXN0cyBpbiB0aGVcclxuICAgICAqIERiVGFyZ2V0R2xvYmFsIHN0b3JlLlxyXG4gICAgICovXHJcbiAgICBEYlRhcmdldEdsb2JhbC5rZXkgPSAndGFyZ2V0R2xvYmFsS2V5JztcclxuICAgIERiVGFyZ2V0R2xvYmFsLnN0b3JlID0gJ3RhcmdldEdsb2JhbCc7XHJcbiAgICByZXR1cm4gRGJUYXJnZXRHbG9iYWw7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGNyZWF0ZVF1ZXJ5Q2FjaGUoZGIpIHtcclxuICAgIHZhciB0YXJnZXREb2N1bWVudHNTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiVGFyZ2V0RG9jdW1lbnQuc3RvcmUsIHtcclxuICAgICAgICBrZXlQYXRoOiBEYlRhcmdldERvY3VtZW50LmtleVBhdGhcclxuICAgIH0pO1xyXG4gICAgdGFyZ2V0RG9jdW1lbnRzU3RvcmUuY3JlYXRlSW5kZXgoRGJUYXJnZXREb2N1bWVudC5kb2N1bWVudFRhcmdldHNJbmRleCwgRGJUYXJnZXREb2N1bWVudC5kb2N1bWVudFRhcmdldHNLZXlQYXRoLCB7IHVuaXF1ZTogdHJ1ZSB9KTtcclxuICAgIHZhciB0YXJnZXRTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiVGFyZ2V0LnN0b3JlLCB7XHJcbiAgICAgICAga2V5UGF0aDogRGJUYXJnZXQua2V5UGF0aFxyXG4gICAgfSk7XHJcbiAgICAvLyBOT1RFOiBUaGlzIGlzIHVuaXF1ZSBvbmx5IGJlY2F1c2UgdGhlIFRhcmdldElkIGlzIHRoZSBzdWZmaXguXHJcbiAgICB0YXJnZXRTdG9yZS5jcmVhdGVJbmRleChEYlRhcmdldC5xdWVyeVRhcmdldHNJbmRleE5hbWUsIERiVGFyZ2V0LnF1ZXJ5VGFyZ2V0c0tleVBhdGgsIHsgdW5pcXVlOiB0cnVlIH0pO1xyXG4gICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJUYXJnZXRHbG9iYWwuc3RvcmUpO1xyXG59XHJcbmZ1bmN0aW9uIGRyb3BRdWVyeUNhY2hlKGRiKSB7XHJcbiAgICBkYi5kZWxldGVPYmplY3RTdG9yZShEYlRhcmdldERvY3VtZW50LnN0b3JlKTtcclxuICAgIGRiLmRlbGV0ZU9iamVjdFN0b3JlKERiVGFyZ2V0LnN0b3JlKTtcclxuICAgIGRiLmRlbGV0ZU9iamVjdFN0b3JlKERiVGFyZ2V0R2xvYmFsLnN0b3JlKTtcclxufVxyXG4vKipcclxuICogQ3JlYXRlcyB0aGUgdGFyZ2V0IGdsb2JhbCBzaW5nbGV0b24gcm93LlxyXG4gKlxyXG4gKiBAcGFyYW0ge0lEQlRyYW5zYWN0aW9ufSB0eG4gVGhlIHZlcnNpb24gdXBncmFkZSB0cmFuc2FjdGlvbiBmb3IgaW5kZXhlZGRiXHJcbiAqL1xyXG5mdW5jdGlvbiB3cml0ZUVtcHR5VGFyZ2V0R2xvYmFsRW50cnkodHhuKSB7XHJcbiAgICB2YXIgZ2xvYmFsU3RvcmUgPSB0eG4uc3RvcmUoRGJUYXJnZXRHbG9iYWwuc3RvcmUpO1xyXG4gICAgdmFyIG1ldGFkYXRhID0gbmV3IERiVGFyZ2V0R2xvYmFsKFxyXG4gICAgLypoaWdoZXN0VGFyZ2V0SWQ9Ki8gMCwgXHJcbiAgICAvKmxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcj0qLyAwLCBTbmFwc2hvdFZlcnNpb24uTUlOLnRvVGltZXN0YW1wKCksIFxyXG4gICAgLyp0YXJnZXRDb3VudD0qLyAwKTtcclxuICAgIHJldHVybiBnbG9iYWxTdG9yZS5wdXQoRGJUYXJnZXRHbG9iYWwua2V5LCBtZXRhZGF0YSk7XHJcbn1cclxuLyoqXHJcbiAqIEFuIG9iamVjdCBzdG9yZSB0byBzdG9yZSB0aGUga2V5cyBvZiBjaGFuZ2VkIGRvY3VtZW50cy4gVGhpcyBpcyB1c2VkIHRvXHJcbiAqIGZhY2lsaXRhdGUgc3RvcmluZyBkb2N1bWVudCBjaGFuZ2Vsb2dzIGluIHRoZSBSZW1vdGUgRG9jdW1lbnQgQ2FjaGUuXHJcbiAqXHJcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyB1c2VkIGZvciBjaGFuZ2UgcHJvcGFnYXRpb24gZHVyaW5nIG11bHRpLXRhYiBzeW5jaW5nXHJcbiAqIGFuZCBub3QgbmVlZGVkIG9uIGlPUyBhbmQgQW5kcm9pZC5cclxuICovXHJcbnZhciBEYlJlbW90ZURvY3VtZW50Q2hhbmdlcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzKFxyXG4gICAgLyoqIFRoZSBrZXlzIG9mIHRoZSBjaGFuZ2VkIGRvY3VtZW50cy4gKi9cclxuICAgIGNoYW5nZXMpIHtcclxuICAgICAgICB0aGlzLmNoYW5nZXMgPSBjaGFuZ2VzO1xyXG4gICAgfVxyXG4gICAgLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICAqL1xyXG4gICAgRGJSZW1vdGVEb2N1bWVudENoYW5nZXMuc3RvcmUgPSAncmVtb3RlRG9jdW1lbnRDaGFuZ2VzJztcclxuICAgIC8qKiBLZXlzIGFyZSBhdXRvLWdlbmVyYXRlZCB2aWEgdGhlIGBpZGAgcHJvcGVydHkuICovXHJcbiAgICBEYlJlbW90ZURvY3VtZW50Q2hhbmdlcy5rZXlQYXRoID0gJ2lkJztcclxuICAgIHJldHVybiBEYlJlbW90ZURvY3VtZW50Q2hhbmdlcztcclxufSgpKTtcclxuZnVuY3Rpb24gY3JlYXRlUmVtb3RlRG9jdW1lbnRDaGFuZ2VzU3RvcmUoZGIpIHtcclxuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzLnN0b3JlLCB7XHJcbiAgICAgICAga2V5UGF0aDogJ2lkJyxcclxuICAgICAgICBhdXRvSW5jcmVtZW50OiB0cnVlXHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICogQSByZWNvcmQgb2YgdGhlIG1ldGFkYXRhIHN0YXRlIG9mIGVhY2ggY2xpZW50LlxyXG4gKlxyXG4gKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgdXNlZCB0byBzeW5jaHJvbml6ZSBtdWx0aS10YWIgc3RhdGUgYW5kIGRvZXMgbm90IG5lZWRcclxuICogdG8gYmUgcG9ydGVkIHRvIGlPUyBvciBBbmRyb2lkLlxyXG4gKi9cclxudmFyIERiQ2xpZW50TWV0YWRhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYkNsaWVudE1ldGFkYXRhKFxyXG4gICAgLyoqIFRoZSBhdXRvLWdlbmVyYXRlZCBjbGllbnQgaWQgYXNzaWduZWQgYXQgY2xpZW50IHN0YXJ0dXAuICovXHJcbiAgICBjbGllbnRJZCwgXHJcbiAgICAvKiogVGhlIGxhc3QgdGltZSB0aGlzIHN0YXRlIHdhcyB1cGRhdGVkLiAqL1xyXG4gICAgdXBkYXRlVGltZU1zLCBcclxuICAgIC8qKiBXaGV0aGVyIHRoZSBjbGllbnQncyBuZXR3b3JrIGNvbm5lY3Rpb24gaXMgZW5hYmxlZC4gKi9cclxuICAgIG5ldHdvcmtFbmFibGVkLCBcclxuICAgIC8qKiBXaGV0aGVyIHRoaXMgY2xpZW50IGlzIHJ1bm5pbmcgaW4gYSBmb3JlZ3JvdW5kIHRhYi4gKi9cclxuICAgIGluRm9yZWdyb3VuZCwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBsYXN0IGNoYW5nZSByZWFkIGZyb20gdGhlIERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzIHN0b3JlLlxyXG4gICAgICogQ2FuIGJlIHVuZGVmaW5lZCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuXHJcbiAgICAgKi9cclxuICAgIGxhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkKSB7XHJcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xyXG4gICAgICAgIHRoaXMudXBkYXRlVGltZU1zID0gdXBkYXRlVGltZU1zO1xyXG4gICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgPSBuZXR3b3JrRW5hYmxlZDtcclxuICAgICAgICB0aGlzLmluRm9yZWdyb3VuZCA9IGluRm9yZWdyb3VuZDtcclxuICAgICAgICB0aGlzLmxhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkID0gbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQ7XHJcbiAgICB9XHJcbiAgICAvKiogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS4gKi9cclxuICAgIERiQ2xpZW50TWV0YWRhdGEuc3RvcmUgPSAnY2xpZW50TWV0YWRhdGEnO1xyXG4gICAgLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSBjbGllbnRJZCBwcm9wZXJ0aWVzLiAqL1xyXG4gICAgRGJDbGllbnRNZXRhZGF0YS5rZXlQYXRoID0gJ2NsaWVudElkJztcclxuICAgIHJldHVybiBEYkNsaWVudE1ldGFkYXRhO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBjcmVhdGVDbGllbnRNZXRhZGF0YVN0b3JlKGRiKSB7XHJcbiAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShEYkNsaWVudE1ldGFkYXRhLnN0b3JlLCB7XHJcbiAgICAgICAga2V5UGF0aDogRGJDbGllbnRNZXRhZGF0YS5rZXlQYXRoXHJcbiAgICB9KTtcclxufVxyXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXHJcbnZhciBWMV9TVE9SRVMgPSBbXHJcbiAgICBEYk11dGF0aW9uUXVldWUuc3RvcmUsXHJcbiAgICBEYk11dGF0aW9uQmF0Y2guc3RvcmUsXHJcbiAgICBEYkRvY3VtZW50TXV0YXRpb24uc3RvcmUsXHJcbiAgICBEYlJlbW90ZURvY3VtZW50LnN0b3JlLFxyXG4gICAgRGJUYXJnZXQuc3RvcmUsXHJcbiAgICBEYlByaW1hcnlDbGllbnQuc3RvcmUsXHJcbiAgICBEYlRhcmdldEdsb2JhbC5zdG9yZSxcclxuICAgIERiVGFyZ2V0RG9jdW1lbnQuc3RvcmVcclxuXTtcclxuLy8gVjIgaXMgbm8gbG9uZ2VyIHVzYWJsZSAoc2VlIGNvbW1lbnQgYXQgdG9wIG9mIGZpbGUpXHJcbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcclxudmFyIFYzX1NUT1JFUyA9IFYxX1NUT1JFUztcclxuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xyXG52YXIgVjRfU1RPUkVTID0gVjNfU1RPUkVTLmNvbmNhdChbXHJcbiAgICBEYkNsaWVudE1ldGFkYXRhLnN0b3JlLFxyXG4gICAgRGJSZW1vdGVEb2N1bWVudENoYW5nZXMuc3RvcmVcclxuXSk7XHJcbi8vIFY1IGRvZXMgbm90IGNoYW5nZSB0aGUgc2V0IG9mIHN0b3Jlcy5cclxudmFyIFY2X1NUT1JFUyA9IFY0X1NUT1JFUy5jb25jYXQoW0RiUmVtb3RlRG9jdW1lbnRHbG9iYWwuc3RvcmVdKTtcclxuLyoqXHJcbiAqIFRoZSBsaXN0IG9mIGFsbCBkZWZhdWx0IEluZGV4ZWREQiBzdG9yZXMgdXNlZCB0aHJvdWdob3V0IHRoZSBTREsuIFRoaXMgaXNcclxuICogdXNlZCB3aGVuIGNyZWF0aW5nIHRyYW5zYWN0aW9ucyBzbyB0aGF0IGFjY2VzcyBhY3Jvc3MgYWxsIHN0b3JlcyBpcyBkb25lXHJcbiAqIGF0b21pY2FsbHkuXHJcbiAqL1xyXG52YXIgQUxMX1NUT1JFUyA9IFY2X1NUT1JFUztcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKiBBIG11dGF0aW9uIHF1ZXVlIGZvciBhIHNwZWNpZmljIHVzZXIsIGJhY2tlZCBieSBJbmRleGVkREIuICovXHJcbnZhciBJbmRleGVkRGJNdXRhdGlvblF1ZXVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSW5kZXhlZERiTXV0YXRpb25RdWV1ZShcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG5vcm1hbGl6ZWQgdXNlcklkIChlLmcuIG51bGwgVUlEID0+IFwiXCIgdXNlcklkKSB1c2VkIHRvIHN0b3JlIC9cclxuICAgICAqIHJldHJpZXZlIG11dGF0aW9ucy5cclxuICAgICAqL1xyXG4gICAgdXNlcklkLCBzZXJpYWxpemVyLCByZWZlcmVuY2VEZWxlZ2F0ZSkge1xyXG4gICAgICAgIHRoaXMudXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHJlZmVyZW5jZURlbGVnYXRlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENhY2hlcyB0aGUgZG9jdW1lbnQga2V5cyBmb3IgcGVuZGluZyBtdXRhdGlvbiBiYXRjaGVzLiBJZiB0aGUgbXV0YXRpb25cclxuICAgICAgICAgKiBoYXMgYmVlbiByZW1vdmVkIGZyb20gSW5kZXhlZERiLCB0aGUgY2FjaGVkIHZhbHVlIG1heSBjb250aW51ZSB0b1xyXG4gICAgICAgICAqIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIGJhdGNoJ3MgZG9jdW1lbnQga2V5cy4gVG8gcmVtb3ZlIGEgY2FjaGVkIHZhbHVlXHJcbiAgICAgICAgICogbG9jYWxseSwgYHJlbW92ZUNhY2hlZE11dGF0aW9uS2V5cygpYCBzaG91bGQgYmUgaW52b2tlZCBlaXRoZXIgZGlyZWN0bHlcclxuICAgICAgICAgKiBvciB0aHJvdWdoIGByZW1vdmVNdXRhdGlvbkJhdGNoZXMoKWAuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBXaXRoIG11bHRpLXRhYiwgd2hlbiB0aGUgcHJpbWFyeSBjbGllbnQgYWNrbm93bGVkZ2VzIG9yIHJlamVjdHMgYSBtdXRhdGlvbixcclxuICAgICAgICAgKiB0aGlzIGNhY2hlIGlzIHVzZWQgYnkgc2Vjb25kYXJ5IGNsaWVudHMgdG8gaW52YWxpZGF0ZSB0aGUgbG9jYWxcclxuICAgICAgICAgKiB2aWV3IG9mIHRoZSBkb2N1bWVudHMgdGhhdCB3ZXJlIHByZXZpb3VzbHkgYWZmZWN0ZWQgYnkgdGhlIG11dGF0aW9uLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICAgICAgdGhpcy5kb2N1bWVudEtleXNCeUJhdGNoSWQgPSB7fTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIG5ldyBtdXRhdGlvbiBxdWV1ZSBmb3IgdGhlIGdpdmVuIHVzZXIuXHJcbiAgICAgKiBAcGFyYW0gdXNlciBUaGUgdXNlciBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgbXV0YXRpb24gcXVldWUuXHJcbiAgICAgKiBAcGFyYW0gc2VyaWFsaXplciBUaGUgc2VyaWFsaXplciB0byB1c2Ugd2hlbiBwZXJzaXN0aW5nIHRvIEluZGV4ZWREYi5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5mb3JVc2VyID0gZnVuY3Rpb24gKHVzZXIsIHNlcmlhbGl6ZXIsIHJlZmVyZW5jZURlbGVnYXRlKSB7XHJcbiAgICAgICAgLy8gVE9ETyhtY2cpOiBGaWd1cmUgb3V0IHdoYXQgY29uc3RyYWludHMgdGhlcmUgYXJlIG9uIHVzZXJJRHNcclxuICAgICAgICAvLyBJbiBwYXJ0aWN1bGFyLCBhcmUgdGhlcmUgYW55IHJlc2VydmVkIGNoYXJhY3RlcnM/IGFyZSBlbXB0eSBpZHMgYWxsb3dlZD9cclxuICAgICAgICAvLyBGb3IgdGhlIG1vbWVudCBzdG9yZSB0aGVzZSB0b2dldGhlciBpbiB0aGUgc2FtZSBtdXRhdGlvbnMgdGFibGUgYXNzdW1pbmdcclxuICAgICAgICAvLyB0aGF0IGVtcHR5IHVzZXJJRHMgYXJlbid0IGFsbG93ZWQuXHJcbiAgICAgICAgYXNzZXJ0KHVzZXIudWlkICE9PSAnJywgJ1VzZXJJRCBtdXN0IG5vdCBiZSBhbiBlbXB0eSBzdHJpbmcuJyk7XHJcbiAgICAgICAgdmFyIHVzZXJJZCA9IHVzZXIuaXNBdXRoZW50aWNhdGVkKCkgPyB1c2VyLnVpZCA6ICcnO1xyXG4gICAgICAgIHJldHVybiBuZXcgSW5kZXhlZERiTXV0YXRpb25RdWV1ZSh1c2VySWQsIHNlcmlhbGl6ZXIsIHJlZmVyZW5jZURlbGVnYXRlKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5jaGVja0VtcHR5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5ib3VuZChbdGhpcy51c2VySWQsIE51bWJlci5ORUdBVElWRV9JTkZJTklUWV0sIFt0aGlzLnVzZXJJZCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZXSk7XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuaXRlcmF0ZSh7IGluZGV4OiBEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0luZGV4LCByYW5nZTogcmFuZ2UgfSwgZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgZW1wdHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gZW1wdHk7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmFja25vd2xlZGdlQmF0Y2ggPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoLCBzdHJlYW1Ub2tlbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE11dGF0aW9uUXVldWVNZXRhZGF0YSh0cmFuc2FjdGlvbikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGJhdGNoSWQgPSBiYXRjaC5iYXRjaElkO1xyXG4gICAgICAgICAgICBhc3NlcnQoYmF0Y2hJZCA+IG1ldGFkYXRhLmxhc3RBY2tub3dsZWRnZWRCYXRjaElkLCAnTXV0YXRpb24gYmF0Y2hJRHMgbXVzdCBiZSBhY2tub3dsZWRnZWQgaW4gb3JkZXInKTtcclxuICAgICAgICAgICAgbWV0YWRhdGEubGFzdEFja25vd2xlZGdlZEJhdGNoSWQgPSBiYXRjaElkO1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5sYXN0U3RyZWFtVG9rZW4gPSBjb252ZXJ0U3RyZWFtVG9rZW4oc3RyZWFtVG9rZW4pO1xyXG4gICAgICAgICAgICByZXR1cm4gbXV0YXRpb25RdWV1ZXNTdG9yZSh0cmFuc2FjdGlvbikucHV0KG1ldGFkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRMYXN0U3RyZWFtVG9rZW4gPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRNdXRhdGlvblF1ZXVlTWV0YWRhdGEodHJhbnNhY3Rpb24pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7IHJldHVybiBtZXRhZGF0YS5sYXN0U3RyZWFtVG9rZW47IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLnNldExhc3RTdHJlYW1Ub2tlbiA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgc3RyZWFtVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRNdXRhdGlvblF1ZXVlTWV0YWRhdGEodHJhbnNhY3Rpb24pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLmxhc3RTdHJlYW1Ub2tlbiA9IGNvbnZlcnRTdHJlYW1Ub2tlbihzdHJlYW1Ub2tlbik7XHJcbiAgICAgICAgICAgIHJldHVybiBtdXRhdGlvblF1ZXVlc1N0b3JlKHRyYW5zYWN0aW9uKS5wdXQobWV0YWRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmFkZE11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGxvY2FsV3JpdGVUaW1lLCBtdXRhdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBkb2N1bWVudFN0b3JlID0gZG9jdW1lbnRNdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbik7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uU3RvcmUgPSBtdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbik7XHJcbiAgICAgICAgLy8gVGhlIEluZGV4ZWREYiBpbXBsZW1lbnRhdGlvbiBpbiBDaHJvbWUgKGFuZCBGaXJlZm94KSBkb2VzIG5vdCBoYW5kbGVcclxuICAgICAgICAvLyBjb21wb3VuZCBpbmRpY2VzIHRoYXQgaW5jbHVkZSBhdXRvLWdlbmVyYXRlZCBrZXlzIGNvcnJlY3RseS4gVG8gZW5zdXJlXHJcbiAgICAgICAgLy8gdGhhdCB0aGUgaW5kZXggZW50cnkgaXMgYWRkZWQgY29ycmVjdGx5IGluIGFsbCBicm93c2Vycywgd2UgcGVyZm9ybSB0d29cclxuICAgICAgICAvLyB3cml0ZXM6IFRoZSBmaXJzdCB3cml0ZSBpcyB1c2VkIHRvIHJldHJpZXZlIHRoZSBuZXh0IGF1dG8tZ2VuZXJhdGVkIEJhdGNoXHJcbiAgICAgICAgLy8gSUQsIGFuZCB0aGUgc2Vjb25kIHdyaXRlIHBvcHVsYXRlcyB0aGUgaW5kZXggYW5kIHN0b3JlcyB0aGUgYWN0dWFsXHJcbiAgICAgICAgLy8gbXV0YXRpb24gYmF0Y2guXHJcbiAgICAgICAgLy8gU2VlOiBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD03MDE5NzJcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IFdlIHdyaXRlIGFuIGVtcHR5IG9iamVjdCB0byBvYnRhaW4ga2V5XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9uU3RvcmUuYWRkKHt9KS5uZXh0KGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgICAgIGFzc2VydCh0eXBlb2YgYmF0Y2hJZCA9PT0gJ251bWJlcicsICdBdXRvLWdlbmVyYXRlZCBrZXkgaXMgbm90IGEgbnVtYmVyJyk7XHJcbiAgICAgICAgICAgIHZhciBiYXRjaCA9IG5ldyBNdXRhdGlvbkJhdGNoKGJhdGNoSWQsIGxvY2FsV3JpdGVUaW1lLCBtdXRhdGlvbnMpO1xyXG4gICAgICAgICAgICB2YXIgZGJCYXRjaCA9IF90aGlzLnNlcmlhbGl6ZXIudG9EYk11dGF0aW9uQmF0Y2goX3RoaXMudXNlcklkLCBiYXRjaCk7XHJcbiAgICAgICAgICAgIF90aGlzLmRvY3VtZW50S2V5c0J5QmF0Y2hJZFtiYXRjaElkXSA9IGJhdGNoLmtleXMoKTtcclxuICAgICAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgbXV0YXRpb25zXzEgPSBtdXRhdGlvbnM7IF9pIDwgbXV0YXRpb25zXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbXV0YXRpb24gPSBtdXRhdGlvbnNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhLZXkgPSBEYkRvY3VtZW50TXV0YXRpb24ua2V5KF90aGlzLnVzZXJJZCwgbXV0YXRpb24ua2V5LnBhdGgsIGJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChtdXRhdGlvblN0b3JlLnB1dChkYkJhdGNoKSk7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGRvY3VtZW50U3RvcmUucHV0KGluZGV4S2V5LCBEYkRvY3VtZW50TXV0YXRpb24uUExBQ0VIT0xERVIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYmF0Y2g7IH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmxvb2t1cE11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBtdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLmdldChiYXRjaElkKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoZGJCYXRjaCkge1xyXG4gICAgICAgICAgICBpZiAoZGJCYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGRiQmF0Y2gudXNlcklkID09PSBfdGhpcy51c2VySWQsIFwiVW5leHBlY3RlZCB1c2VyICdcIiArIGRiQmF0Y2gudXNlcklkICsgXCInIGZvciBtdXRhdGlvbiBiYXRjaCBcIiArIGJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiTXV0YXRpb25CYXRjaChkYkJhdGNoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5sb29rdXBNdXRhdGlvbktleXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLmRvY3VtZW50S2V5c0J5QmF0Y2hJZFtiYXRjaElkXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5kb2N1bWVudEtleXNCeUJhdGNoSWRbYmF0Y2hJZF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9va3VwTXV0YXRpb25CYXRjaCh0cmFuc2FjdGlvbiwgYmF0Y2hJZCkubmV4dChmdW5jdGlvbiAoYmF0Y2gpIHtcclxuICAgICAgICAgICAgICAgIGlmIChiYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXlzID0gYmF0Y2gua2V5cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmRvY3VtZW50S2V5c0J5QmF0Y2hJZFtiYXRjaElkXSA9IGtleXM7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRNdXRhdGlvblF1ZXVlTWV0YWRhdGEodHJhbnNhY3Rpb24pLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIEFsbCBiYXRjaGVzIHdpdGggYmF0Y2hJZCA8PSB0aGlzLm1ldGFkYXRhLmxhc3RBY2tub3dsZWRnZWRCYXRjaElkIGhhdmVcclxuICAgICAgICAgICAgLy8gYmVlbiBhY2tub3dsZWRnZWQgc28gdGhlIGZpcnN0IHVuYWNrbm93bGVkZ2VkIGJhdGNoIGFmdGVyIGJhdGNoSUQgd2lsbFxyXG4gICAgICAgICAgICAvLyBoYXZlIGEgYmF0Y2hJRCBsYXJnZXIgdGhhbiBib3RoIG9mIHRoZXNlIHZhbHVlcy5cclxuICAgICAgICAgICAgdmFyIG5leHRCYXRjaElkID0gTWF0aC5tYXgoYmF0Y2hJZCwgbWV0YWRhdGEubGFzdEFja25vd2xlZGdlZEJhdGNoSWQpICsgMTtcclxuICAgICAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChbX3RoaXMudXNlcklkLCBuZXh0QmF0Y2hJZF0pO1xyXG4gICAgICAgICAgICB2YXIgZm91bmRCYXRjaCA9IG51bGw7XHJcbiAgICAgICAgICAgIHJldHVybiBtdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgICAgIC5pdGVyYXRlKHsgaW5kZXg6IERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zSW5kZXgsIHJhbmdlOiByYW5nZSB9LCBmdW5jdGlvbiAoa2V5LCBkYkJhdGNoLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGJCYXRjaC51c2VySWQgPT09IF90aGlzLnVzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChkYkJhdGNoLmJhdGNoSWQgPj0gbmV4dEJhdGNoSWQsICdTaG91bGQgaGF2ZSBmb3VuZCBtdXRhdGlvbiBhZnRlciAnICsgbmV4dEJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvdW5kQmF0Y2ggPSBfdGhpcy5zZXJpYWxpemVyLmZyb21EYk11dGF0aW9uQmF0Y2goZGJCYXRjaCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZvdW5kQmF0Y2g7IH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldEFsbE11dGF0aW9uQmF0Y2hlcyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UuYm91bmQoW3RoaXMudXNlcklkLCBCQVRDSElEX1VOS05PV05dLCBbdGhpcy51c2VySWQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWV0pO1xyXG4gICAgICAgIHJldHVybiBtdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLmxvYWRBbGwoRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNJbmRleCwgcmFuZ2UpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChkYkJhdGNoZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRiQmF0Y2hlcy5tYXAoZnVuY3Rpb24gKGRiQmF0Y2gpIHsgcmV0dXJuIF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiTXV0YXRpb25CYXRjaChkYkJhdGNoKTsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBTY2FuIHRoZSBkb2N1bWVudC1tdXRhdGlvbiBpbmRleCBzdGFydGluZyB3aXRoIGEgcHJlZml4IHN0YXJ0aW5nIHdpdGhcclxuICAgICAgICAvLyB0aGUgZ2l2ZW4gZG9jdW1lbnRLZXkuXHJcbiAgICAgICAgdmFyIGluZGV4UHJlZml4ID0gRGJEb2N1bWVudE11dGF0aW9uLnByZWZpeEZvclBhdGgodGhpcy51c2VySWQsIGRvY3VtZW50S2V5LnBhdGgpO1xyXG4gICAgICAgIHZhciBpbmRleFN0YXJ0ID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChpbmRleFByZWZpeCk7XHJcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnRNdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLml0ZXJhdGUoeyByYW5nZTogaW5kZXhTdGFydCB9LCBmdW5jdGlvbiAoaW5kZXhLZXksIF8sIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgdmFyIHVzZXJJRCA9IGluZGV4S2V5WzBdLCBlbmNvZGVkUGF0aCA9IGluZGV4S2V5WzFdLCBiYXRjaElkID0gaW5kZXhLZXlbMl07XHJcbiAgICAgICAgICAgIC8vIE9ubHkgY29uc2lkZXIgcm93cyBtYXRjaGluZyBleGFjdGx5IHRoZSBzcGVjaWZpYyBrZXkgb2ZcclxuICAgICAgICAgICAgLy8gaW50ZXJlc3QuIE5vdGUgdGhhdCBiZWNhdXNlIHdlIG9yZGVyIGJ5IHBhdGggZmlyc3QsIGFuZCB3ZVxyXG4gICAgICAgICAgICAvLyBvcmRlciB0ZXJtaW5hdG9ycyBiZWZvcmUgcGF0aCBzZXBhcmF0b3JzLCB3ZSdsbCBlbmNvdW50ZXIgYWxsXHJcbiAgICAgICAgICAgIC8vIHRoZSBpbmRleCByb3dzIGZvciBkb2N1bWVudEtleSBjb250aWd1b3VzbHkuIEluIHBhcnRpY3VsYXIsIGFsbFxyXG4gICAgICAgICAgICAvLyB0aGUgcm93cyBmb3IgZG9jdW1lbnRLZXkgd2lsbCBvY2N1ciBiZWZvcmUgYW55IHJvd3MgZm9yXHJcbiAgICAgICAgICAgIC8vIGRvY3VtZW50cyBuZXN0ZWQgaW4gYSBzdWJjb2xsZWN0aW9uIGJlbmVhdGggZG9jdW1lbnRLZXkgc28gd2VcclxuICAgICAgICAgICAgLy8gY2FuIHN0b3AgYXMgc29vbiBhcyB3ZSBoaXQgYW55IHN1Y2ggcm93LlxyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IGRlY29kZSQxKGVuY29kZWRQYXRoKTtcclxuICAgICAgICAgICAgaWYgKHVzZXJJRCAhPT0gX3RoaXMudXNlcklkIHx8ICFkb2N1bWVudEtleS5wYXRoLmlzRXF1YWwocGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIExvb2sgdXAgdGhlIG11dGF0aW9uIGJhdGNoIGluIHRoZSBzdG9yZS5cclxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgLmdldChiYXRjaElkKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKG11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZmFpbCgnRGFuZ2xpbmcgZG9jdW1lbnQtbXV0YXRpb24gcmVmZXJlbmNlIGZvdW5kOiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXhLZXkgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnIHdoaWNoIHBvaW50cyB0byAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQobXV0YXRpb24udXNlcklkID09PSBfdGhpcy51c2VySWQsIFwiVW5leHBlY3RlZCB1c2VyICdcIiArIG11dGF0aW9uLnVzZXJJZCArIFwiJyBmb3IgbXV0YXRpb24gYmF0Y2ggXCIgKyBiYXRjaElkKTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChfdGhpcy5zZXJpYWxpemVyLmZyb21EYk11dGF0aW9uQmF0Y2gobXV0YXRpb24pKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0czsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciB1bmlxdWVCYXRjaElEcyA9IG5ldyBTb3J0ZWRTZXQocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbiAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgZG9jdW1lbnRLZXlzLmZvckVhY2goZnVuY3Rpb24gKGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleFN0YXJ0ID0gRGJEb2N1bWVudE11dGF0aW9uLnByZWZpeEZvclBhdGgoX3RoaXMudXNlcklkLCBkb2N1bWVudEtleS5wYXRoKTtcclxuICAgICAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChpbmRleFN0YXJ0KTtcclxuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBkb2N1bWVudE11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKS5pdGVyYXRlKHsgcmFuZ2U6IHJhbmdlIH0sIGZ1bmN0aW9uIChpbmRleEtleSwgXywgY29udHJvbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJRCA9IGluZGV4S2V5WzBdLCBlbmNvZGVkUGF0aCA9IGluZGV4S2V5WzFdLCBiYXRjaElEID0gaW5kZXhLZXlbMl07XHJcbiAgICAgICAgICAgICAgICAvLyBPbmx5IGNvbnNpZGVyIHJvd3MgbWF0Y2hpbmcgZXhhY3RseSB0aGUgc3BlY2lmaWMga2V5IG9mXHJcbiAgICAgICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXHJcbiAgICAgICAgICAgICAgICAvLyBvcmRlciB0ZXJtaW5hdG9ycyBiZWZvcmUgcGF0aCBzZXBhcmF0b3JzLCB3ZSdsbCBlbmNvdW50ZXIgYWxsXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgaW5kZXggcm93cyBmb3IgZG9jdW1lbnRLZXkgY29udGlndW91c2x5LiBJbiBwYXJ0aWN1bGFyLCBhbGxcclxuICAgICAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcclxuICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50cyBuZXN0ZWQgaW4gYSBzdWJjb2xsZWN0aW9uIGJlbmVhdGggZG9jdW1lbnRLZXkgc28gd2VcclxuICAgICAgICAgICAgICAgIC8vIGNhbiBzdG9wIGFzIHNvb24gYXMgd2UgaGl0IGFueSBzdWNoIHJvdy5cclxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gZGVjb2RlJDEoZW5jb2RlZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJJRCAhPT0gX3RoaXMudXNlcklkIHx8ICFkb2N1bWVudEtleS5wYXRoLmlzRXF1YWwocGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB1bmlxdWVCYXRjaElEcyA9IHVuaXF1ZUJhdGNoSURzLmFkZChiYXRjaElEKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2gocHJvbWlzZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvb2t1cE11dGF0aW9uQmF0Y2hlcyh0cmFuc2FjdGlvbiwgdW5pcXVlQmF0Y2hJRHMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ1F1ZXJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KCFxdWVyeS5pc0RvY3VtZW50UXVlcnkoKSwgXCJEb2N1bWVudCBxdWVyaWVzIHNob3VsZG4ndCBnbyBkb3duIHRoaXMgcGF0aFwiKTtcclxuICAgICAgICB2YXIgcXVlcnlQYXRoID0gcXVlcnkucGF0aDtcclxuICAgICAgICB2YXIgaW1tZWRpYXRlQ2hpbGRyZW5MZW5ndGggPSBxdWVyeVBhdGgubGVuZ3RoICsgMTtcclxuICAgICAgICAvLyBUT0RPKG1jZyk6IEFjdHVhbGx5IGltcGxlbWVudCBhIHNpbmdsZS1jb2xsZWN0aW9uIHF1ZXJ5XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBUaGlzIGlzIGFjdHVhbGx5IGV4ZWN1dGluZyBhbiBhbmNlc3RvciBxdWVyeSwgdHJhdmVyc2luZyB0aGUgd2hvbGVcclxuICAgICAgICAvLyBzdWJ0cmVlIGJlbG93IHRoZSBjb2xsZWN0aW9uIHdoaWNoIGNhbiBiZSBob3JyaWZpY2FsbHkgaW5lZmZpY2llbnQgZm9yXHJcbiAgICAgICAgLy8gc29tZSBzdHJ1Y3R1cmVzLiBUaGUgcmlnaHQgd2F5IHRvIHNvbHZlIHRoaXMgaXMgdG8gaW1wbGVtZW50IHRoZSBmdWxsXHJcbiAgICAgICAgLy8gdmFsdWUgaW5kZXgsIGJ1dCB0aGF0J3Mgbm90IGluIHRoZSBjYXJkcyBpbiB0aGUgbmVhciBmdXR1cmUgc28gdGhpcyBpc1xyXG4gICAgICAgIC8vIHRoZSBiZXN0IHdlIGNhbiBkbyBmb3IgdGhlIG1vbWVudC5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIFNpbmNlIHdlIGRvbid0IHlldCBpbmRleCB0aGUgYWN0dWFsIHByb3BlcnRpZXMgaW4gdGhlIG11dGF0aW9ucywgb3VyXHJcbiAgICAgICAgLy8gY3VycmVudCBhcHByb2FjaCBpcyB0byBqdXN0IHJldHVybiBhbGwgbXV0YXRpb24gYmF0Y2hlcyB0aGF0IGFmZmVjdFxyXG4gICAgICAgIC8vIGRvY3VtZW50cyBpbiB0aGUgY29sbGVjdGlvbiBiZWluZyBxdWVyaWVkLlxyXG4gICAgICAgIHZhciBpbmRleFByZWZpeCA9IERiRG9jdW1lbnRNdXRhdGlvbi5wcmVmaXhGb3JQYXRoKHRoaXMudXNlcklkLCBxdWVyeVBhdGgpO1xyXG4gICAgICAgIHZhciBpbmRleFN0YXJ0ID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChpbmRleFByZWZpeCk7XHJcbiAgICAgICAgLy8gQ29sbGVjdCB1cCB1bmlxdWUgYmF0Y2hJRHMgZW5jb3VudGVyZWQgZHVyaW5nIGEgc2NhbiBvZiB0aGUgaW5kZXguIFVzZSBhXHJcbiAgICAgICAgLy8gU29ydGVkU2V0IHRvIGFjY3VtdWxhdGUgYmF0Y2ggSURzIHNvIHRoZXkgY2FuIGJlIHRyYXZlcnNlZCBpbiBvcmRlciBpbiBhXHJcbiAgICAgICAgLy8gc2NhbiBvZiB0aGUgbWFpbiB0YWJsZS5cclxuICAgICAgICB2YXIgdW5pcXVlQmF0Y2hJRHMgPSBuZXcgU29ydGVkU2V0KHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudE11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuaXRlcmF0ZSh7IHJhbmdlOiBpbmRleFN0YXJ0IH0sIGZ1bmN0aW9uIChpbmRleEtleSwgXywgY29udHJvbCkge1xyXG4gICAgICAgICAgICB2YXIgdXNlcklEID0gaW5kZXhLZXlbMF0sIGVuY29kZWRQYXRoID0gaW5kZXhLZXlbMV0sIGJhdGNoSUQgPSBpbmRleEtleVsyXTtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBkZWNvZGUkMShlbmNvZGVkUGF0aCk7XHJcbiAgICAgICAgICAgIGlmICh1c2VySUQgIT09IF90aGlzLnVzZXJJZCB8fCAhcXVlcnlQYXRoLmlzUHJlZml4T2YocGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFJvd3Mgd2l0aCBkb2N1bWVudCBrZXlzIG1vcmUgdGhhbiBvbmUgc2VnbWVudCBsb25nZXIgdGhhbiB0aGVcclxuICAgICAgICAgICAgLy8gcXVlcnkgcGF0aCBjYW4ndCBiZSBtYXRjaGVzLiBGb3IgZXhhbXBsZSwgYSBxdWVyeSBvbiAncm9vbXMnXHJcbiAgICAgICAgICAgIC8vIGNhbid0IG1hdGNoIHRoZSBkb2N1bWVudCAvcm9vbXMvYWJjL21lc3NhZ2VzL3h5eC5cclxuICAgICAgICAgICAgLy8gVE9ETyhtY2cpOiB3ZSdsbCBuZWVkIGEgZGlmZmVyZW50IHNjYW5uZXIgd2hlbiB3ZSBpbXBsZW1lbnRcclxuICAgICAgICAgICAgLy8gYW5jZXN0b3IgcXVlcmllcy5cclxuICAgICAgICAgICAgaWYgKHBhdGgubGVuZ3RoICE9PSBpbW1lZGlhdGVDaGlsZHJlbkxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHVuaXF1ZUJhdGNoSURzID0gdW5pcXVlQmF0Y2hJRHMuYWRkKGJhdGNoSUQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmxvb2t1cE11dGF0aW9uQmF0Y2hlcyh0cmFuc2FjdGlvbiwgdW5pcXVlQmF0Y2hJRHMpOyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5sb29rdXBNdXRhdGlvbkJhdGNoZXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoSURzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIC8vIFRPRE8ocm9ja3dvb2QpOiBJbXBsZW1lbnQgdGhpcyB1c2luZyBpdGVyYXRlLlxyXG4gICAgICAgIGJhdGNoSURzLmZvckVhY2goZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICAgICAgcHJvbWlzZXMucHVzaChtdXRhdGlvbnNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgICAgIC5nZXQoYmF0Y2hJZClcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChtdXRhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG11dGF0aW9uID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZmFpbCgnRGFuZ2xpbmcgZG9jdW1lbnQtbXV0YXRpb24gcmVmZXJlbmNlIGZvdW5kLCAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3doaWNoIHBvaW50cyB0byAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQobXV0YXRpb24udXNlcklkID09PSBfdGhpcy51c2VySWQsIFwiVW5leHBlY3RlZCB1c2VyICdcIiArIG11dGF0aW9uLnVzZXJJZCArIFwiJyBmb3IgbXV0YXRpb24gYmF0Y2ggXCIgKyBiYXRjaElkKTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChfdGhpcy5zZXJpYWxpemVyLmZyb21EYk11dGF0aW9uQmF0Y2gobXV0YXRpb24pKTtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcykubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiByZXN1bHRzOyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5yZW1vdmVNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHJlbW92ZU11dGF0aW9uQmF0Y2godHJhbnNhY3Rpb24uc2ltcGxlRGJUcmFuc2FjdGlvbiwgdGhpcy51c2VySWQsIGJhdGNoKS5uZXh0KGZ1bmN0aW9uIChyZW1vdmVkRG9jdW1lbnRzKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnJlbW92ZUNhY2hlZE11dGF0aW9uS2V5cyhiYXRjaC5iYXRjaElkKTtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHJlbW92ZWREb2N1bWVudHMsIGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVNdXRhdGlvblJlZmVyZW5jZSh0cmFuc2FjdGlvbiwga2V5KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUucmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICBkZWxldGUgdGhpcy5kb2N1bWVudEtleXNCeUJhdGNoSWRbYmF0Y2hJZF07XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5jaGVja0VtcHR5KHR4bikubmV4dChmdW5jdGlvbiAoZW1wdHkpIHtcclxuICAgICAgICAgICAgaWYgKCFlbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVmVyaWZ5IHRoYXQgdGhlcmUgYXJlIG5vIGVudHJpZXMgaW4gdGhlIGRvY3VtZW50TXV0YXRpb25zIGluZGV4IGlmXHJcbiAgICAgICAgICAgIC8vIHRoZSBxdWV1ZSBpcyBlbXB0eS5cclxuICAgICAgICAgICAgdmFyIHN0YXJ0UmFuZ2UgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKERiRG9jdW1lbnRNdXRhdGlvbi5wcmVmaXhGb3JVc2VyKF90aGlzLnVzZXJJZCkpO1xyXG4gICAgICAgICAgICB2YXIgZGFuZ2xpbmdNdXRhdGlvblJlZmVyZW5jZXMgPSBbXTtcclxuICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50TXV0YXRpb25zU3RvcmUodHhuKVxyXG4gICAgICAgICAgICAgICAgLml0ZXJhdGUoeyByYW5nZTogc3RhcnRSYW5nZSB9LCBmdW5jdGlvbiAoa2V5LCBfLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlcklEID0ga2V5WzBdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJJRCAhPT0gX3RoaXMudXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBkZWNvZGUkMShrZXlbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGRhbmdsaW5nTXV0YXRpb25SZWZlcmVuY2VzLnB1c2gocGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoZGFuZ2xpbmdNdXRhdGlvblJlZmVyZW5jZXMubGVuZ3RoID09PSAwLCAnRG9jdW1lbnQgbGVhayAtLSBkZXRlY3RlZCBkYW5nbGluZyBtdXRhdGlvbiByZWZlcmVuY2VzIHdoZW4gcXVldWUgaXMgZW1wdHkuICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICdEYW5nbGluZyBrZXlzOiAnICtcclxuICAgICAgICAgICAgICAgICAgICBkYW5nbGluZ011dGF0aW9uUmVmZXJlbmNlcy5tYXAoZnVuY3Rpb24gKHApIHsgcmV0dXJuIHAuY2Fub25pY2FsU3RyaW5nKCk7IH0pKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuY29udGFpbnNLZXkgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICByZXR1cm4gbXV0YXRpb25RdWV1ZUNvbnRhaW5zS2V5KHR4biwgdGhpcy51c2VySWQsIGtleSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seSAoc3RhdGUgaXMgaGVsZCBpbiBtZW1vcnkgaW4gb3RoZXIgY2xpZW50cykuXHJcbiAgICAvKiogUmV0dXJucyB0aGUgbXV0YXRpb24gcXVldWUncyBtZXRhZGF0YSBmcm9tIEluZGV4ZWREYi4gKi9cclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldE11dGF0aW9uUXVldWVNZXRhZGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9uUXVldWVzU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5nZXQodGhpcy51c2VySWQpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gKG1ldGFkYXRhIHx8XHJcbiAgICAgICAgICAgICAgICBuZXcgRGJNdXRhdGlvblF1ZXVlKF90aGlzLnVzZXJJZCwgQkFUQ0hJRF9VTktOT1dOLCBcclxuICAgICAgICAgICAgICAgIC8qbGFzdFN0cmVhbVRva2VuPSovICcnKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYk11dGF0aW9uUXVldWU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBAcmV0dXJuIHRydWUgaWYgdGhlIG11dGF0aW9uIHF1ZXVlIGZvciB0aGUgZ2l2ZW4gdXNlciBjb250YWlucyBhIHBlbmRpbmdcclxuICogICAgICAgICBtdXRhdGlvbiBmb3IgdGhlIGdpdmVuIGtleS5cclxuICovXHJcbmZ1bmN0aW9uIG11dGF0aW9uUXVldWVDb250YWluc0tleSh0eG4sIHVzZXJJZCwga2V5KSB7XHJcbiAgICB2YXIgaW5kZXhLZXkgPSBEYkRvY3VtZW50TXV0YXRpb24ucHJlZml4Rm9yUGF0aCh1c2VySWQsIGtleS5wYXRoKTtcclxuICAgIHZhciBlbmNvZGVkUGF0aCA9IGluZGV4S2V5WzFdO1xyXG4gICAgdmFyIHN0YXJ0UmFuZ2UgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKGluZGV4S2V5KTtcclxuICAgIHZhciBjb250YWluc0tleSA9IGZhbHNlO1xyXG4gICAgcmV0dXJuIGRvY3VtZW50TXV0YXRpb25zU3RvcmUodHhuKVxyXG4gICAgICAgIC5pdGVyYXRlKHsgcmFuZ2U6IHN0YXJ0UmFuZ2UsIGtleXNPbmx5OiB0cnVlIH0sIGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb250cm9sKSB7XHJcbiAgICAgICAgdmFyIHVzZXJJRCA9IGtleVswXSwga2V5UGF0aCA9IGtleVsxXSwgLypiYXRjaElEKi8gXyA9IGtleVsyXTtcclxuICAgICAgICBpZiAodXNlcklEID09PSB1c2VySWQgJiYga2V5UGF0aCA9PT0gZW5jb2RlZFBhdGgpIHtcclxuICAgICAgICAgICAgY29udGFpbnNLZXkgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgIH0pXHJcbiAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gY29udGFpbnNLZXk7IH0pO1xyXG59XHJcbi8qKiBSZXR1cm5zIHRydWUgaWYgYW55IG11dGF0aW9uIHF1ZXVlIGNvbnRhaW5zIHRoZSBnaXZlbiBkb2N1bWVudC4gKi9cclxuZnVuY3Rpb24gbXV0YXRpb25RdWV1ZXNDb250YWluS2V5KHR4biwgZG9jS2V5KSB7XHJcbiAgICB2YXIgZm91bmQgPSBmYWxzZTtcclxuICAgIHJldHVybiBtdXRhdGlvblF1ZXVlc1N0b3JlKHR4bilcclxuICAgICAgICAuaXRlcmF0ZVNlcmlhbChmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9uUXVldWVDb250YWluc0tleSh0eG4sIHVzZXJJZCwgZG9jS2V5KS5uZXh0KGZ1bmN0aW9uIChjb250YWluc0tleSkge1xyXG4gICAgICAgICAgICBpZiAoY29udGFpbnNLZXkpIHtcclxuICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoIWNvbnRhaW5zS2V5KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pXHJcbiAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gZm91bmQ7IH0pO1xyXG59XHJcbi8qKlxyXG4gKiBEZWxldGUgYSBtdXRhdGlvbiBiYXRjaCBhbmQgdGhlIGFzc29jaWF0ZWQgZG9jdW1lbnQgbXV0YXRpb25zLlxyXG4gKiBAcmV0dXJuIEEgUGVyc2lzdGVuY2VQcm9taXNlIG9mIHRoZSBkb2N1bWVudCBtdXRhdGlvbnMgdGhhdCB3ZXJlIHJlbW92ZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiByZW1vdmVNdXRhdGlvbkJhdGNoKHR4biwgdXNlcklkLCBiYXRjaCkge1xyXG4gICAgdmFyIG11dGF0aW9uU3RvcmUgPSB0eG4uc3RvcmUoRGJNdXRhdGlvbkJhdGNoLnN0b3JlKTtcclxuICAgIHZhciBpbmRleFR4biA9IHR4bi5zdG9yZShEYkRvY3VtZW50TXV0YXRpb24uc3RvcmUpO1xyXG4gICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5vbmx5KGJhdGNoLmJhdGNoSWQpO1xyXG4gICAgdmFyIG51bURlbGV0ZWQgPSAwO1xyXG4gICAgdmFyIHJlbW92ZVByb21pc2UgPSBtdXRhdGlvblN0b3JlLml0ZXJhdGUoeyByYW5nZTogcmFuZ2UgfSwgZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbnRyb2wpIHtcclxuICAgICAgICBudW1EZWxldGVkKys7XHJcbiAgICAgICAgcmV0dXJuIGNvbnRyb2wuZGVsZXRlKCk7XHJcbiAgICB9KTtcclxuICAgIHByb21pc2VzLnB1c2gocmVtb3ZlUHJvbWlzZS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQobnVtRGVsZXRlZCA9PT0gMSwgJ0RhbmdsaW5nIGRvY3VtZW50LW11dGF0aW9uIHJlZmVyZW5jZSBmb3VuZDogTWlzc2luZyBiYXRjaCAnICtcclxuICAgICAgICAgICAgYmF0Y2guYmF0Y2hJZCk7XHJcbiAgICB9KSk7XHJcbiAgICB2YXIgcmVtb3ZlZERvY3VtZW50cyA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGJhdGNoLm11dGF0aW9uczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgbXV0YXRpb24gPSBfYVtfaV07XHJcbiAgICAgICAgdmFyIGluZGV4S2V5ID0gRGJEb2N1bWVudE11dGF0aW9uLmtleSh1c2VySWQsIG11dGF0aW9uLmtleS5wYXRoLCBiYXRjaC5iYXRjaElkKTtcclxuICAgICAgICBwcm9taXNlcy5wdXNoKGluZGV4VHhuLmRlbGV0ZShpbmRleEtleSkpO1xyXG4gICAgICAgIHJlbW92ZWREb2N1bWVudHMucHVzaChtdXRhdGlvbi5rZXkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKS5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlbW92ZWREb2N1bWVudHM7IH0pO1xyXG59XHJcbmZ1bmN0aW9uIGNvbnZlcnRTdHJlYW1Ub2tlbih0b2tlbikge1xyXG4gICAgaWYgKHRva2VuIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xyXG4gICAgICAgIC8vIFRPRE8oYi83ODc3MTQwMyk6IENvbnZlcnQgdG9rZW5zIHRvIHN0cmluZ3MgZHVyaW5nIGRlc2VyaWFsaXphdGlvblxyXG4gICAgICAgIGFzc2VydChwcm9jZXNzLmVudi5VU0VfTU9DS19QRVJTSVNURU5DRSA9PT0gJ1lFUycsICdQZXJzaXN0aW5nIG5vbi1zdHJpbmcgc3RyZWFtIHRva2VucyBpcyBvbmx5IHN1cHBvcnRlZCB3aXRoIG1vY2sgcGVyc2lzdGVuY2UuJyk7XHJcbiAgICAgICAgcmV0dXJuIHRva2VuLnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gdG9rZW47XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25zIG9iamVjdCBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIG11dGF0aW9uc1N0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJNdXRhdGlvbkJhdGNoLnN0b3JlKTtcclxufVxyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBtdXRhdGlvblF1ZXVlcyBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiBkb2N1bWVudE11dGF0aW9uc1N0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJEb2N1bWVudE11dGF0aW9uLnN0b3JlKTtcclxufVxyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBtdXRhdGlvblF1ZXVlcyBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiBtdXRhdGlvblF1ZXVlc1N0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJNdXRhdGlvblF1ZXVlLnN0b3JlKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIFJFU0VSVkVEX0JJVFMgPSAxO1xyXG52YXIgR2VuZXJhdG9ySWRzO1xyXG4oZnVuY3Rpb24gKEdlbmVyYXRvcklkcykge1xyXG4gICAgR2VuZXJhdG9ySWRzW0dlbmVyYXRvcklkc1tcIlF1ZXJ5Q2FjaGVcIl0gPSAwXSA9IFwiUXVlcnlDYWNoZVwiO1xyXG4gICAgR2VuZXJhdG9ySWRzW0dlbmVyYXRvcklkc1tcIlN5bmNFbmdpbmVcIl0gPSAxXSA9IFwiU3luY0VuZ2luZVwiOyAvLyBUaGUgdGFyZ2V0IElEcyBmb3IgbGltYm8gZGV0ZWN0aW9uIGFyZSBvZGQgKGVuZCBpbiAxKS5cclxufSkoR2VuZXJhdG9ySWRzIHx8IChHZW5lcmF0b3JJZHMgPSB7fSkpO1xyXG4vKipcclxuICogR2VuZXJhdGVzIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZyB0YXJnZXQgSURzIGZvciBzZW5kaW5nIHRhcmdldHMgdG8gdGhlXHJcbiAqIHdhdGNoIHN0cmVhbS5cclxuICpcclxuICogVGhlIGNsaWVudCBjb25zdHJ1Y3RzIHR3byBnZW5lcmF0b3JzLCBvbmUgZm9yIHRoZSBxdWVyeSBjYWNoZSAodmlhXHJcbiAqIGZvclF1ZXJ5Q2FjaGUoKSksIGFuZCBvbmUgZm9yIGxpbWJvIGRvY3VtZW50cyAodmlhIGZvclN5bmNFbmdpbmUoKSkuIFRoZXNlXHJcbiAqIHR3byBnZW5lcmF0b3JzIHByb2R1Y2Ugbm9uLW92ZXJsYXBwaW5nIElEcyAoYnkgdXNpbmcgZXZlbiBhbmQgb2RkIElEc1xyXG4gKiByZXNwZWN0aXZlbHkpLlxyXG4gKlxyXG4gKiBCeSBzZXBhcmF0aW5nIHRoZSB0YXJnZXQgSUQgc3BhY2UsIHRoZSBxdWVyeSBjYWNoZSBjYW4gZ2VuZXJhdGUgdGFyZ2V0IElEc1xyXG4gKiB0aGF0IHBlcnNpc3QgYWNyb3NzIGNsaWVudCByZXN0YXJ0cywgd2hpbGUgc3luYyBlbmdpbmUgY2FuIGluZGVwZW5kZW50bHlcclxuICogZ2VuZXJhdGUgaW4tbWVtb3J5IHRhcmdldCBJRHMgdGhhdCBhcmUgdHJhbnNpZW50IGFuZCBjYW4gYmUgcmV1c2VkIGFmdGVyIGFcclxuICogcmVzdGFydC5cclxuICovXHJcbi8vIFRPRE8obXJzY2htaWR0KTogRXhwbG9yZSByZW1vdmluZyB0aGlzIGNsYXNzIGluIGZhdm9yIG9mIGdlbmVyYXRpbmcgdGhlc2UgSURzXHJcbi8vIGRpcmVjdGx5IGluIFN5bmNFbmdpbmUgYW5kIExvY2FsU3RvcmUuXHJcbnZhciBUYXJnZXRJZEdlbmVyYXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogSW5zdGFudGlhdGVzIGEgbmV3IFRhcmdldElkR2VuZXJhdG9yLiBJZiBhIHNlZWQgaXMgcHJvdmlkZWQsIHRoZSBnZW5lcmF0b3JcclxuICAgICAqIHdpbGwgdXNlIHRoZSBzZWVkIHZhbHVlIGFzIHRoZSBuZXh0IHRhcmdldCBJRC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gVGFyZ2V0SWRHZW5lcmF0b3IoZ2VuZXJhdG9ySWQsIHNlZWQpIHtcclxuICAgICAgICB0aGlzLmdlbmVyYXRvcklkID0gZ2VuZXJhdG9ySWQ7XHJcbiAgICAgICAgYXNzZXJ0KChnZW5lcmF0b3JJZCAmIFJFU0VSVkVEX0JJVFMpID09PSBnZW5lcmF0b3JJZCwgXCJHZW5lcmF0b3IgSUQgXCIgKyBnZW5lcmF0b3JJZCArIFwiIGNvbnRhaW5zIG1vcmUgdGhhbiBcIiArIFJFU0VSVkVEX0JJVFMgKyBcIiByZXNlcnZlZCBiaXRzXCIpO1xyXG4gICAgICAgIHRoaXMuc2VlayhzZWVkICE9PSB1bmRlZmluZWQgPyBzZWVkIDogdGhpcy5nZW5lcmF0b3JJZCk7XHJcbiAgICB9XHJcbiAgICBUYXJnZXRJZEdlbmVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbmV4dElkID0gdGhpcy5uZXh0SWQ7XHJcbiAgICAgICAgdGhpcy5uZXh0SWQgKz0gMSA8PCBSRVNFUlZFRF9CSVRTO1xyXG4gICAgICAgIHJldHVybiBuZXh0SWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBJRCB0aGF0IGZvbGxvd3MgdGhlIGdpdmVuIElELiBTdWJzZXF1ZW50IGNhbGxzIHRvIGBuZXh0KClgXHJcbiAgICAgKiB1c2UgdGhlIG5ld2x5IHJldHVybmVkIHRhcmdldCBJRCBhcyB0aGVpciBiYXNlLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgVGFyZ2V0SWRHZW5lcmF0b3IucHJvdG90eXBlLmFmdGVyID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy5zZWVrKHRhcmdldElkICsgKDEgPDwgUkVTRVJWRURfQklUUykpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5leHQoKTtcclxuICAgIH07XHJcbiAgICBUYXJnZXRJZEdlbmVyYXRvci5wcm90b3R5cGUuc2VlayA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIGFzc2VydCgodGFyZ2V0SWQgJiBSRVNFUlZFRF9CSVRTKSA9PT0gdGhpcy5nZW5lcmF0b3JJZCwgJ0Nhbm5vdCBzdXBwbHkgdGFyZ2V0IElEIGZyb20gZGlmZmVyZW50IGdlbmVyYXRvciBJRCcpO1xyXG4gICAgICAgIHRoaXMubmV4dElkID0gdGFyZ2V0SWQ7XHJcbiAgICB9O1xyXG4gICAgVGFyZ2V0SWRHZW5lcmF0b3IuZm9yUXVlcnlDYWNoZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBXZSBzZWVkIHRoZSBxdWVyeSBjYWNoZSBnZW5lcmF0b3IgdG8gcmV0dXJuICcyJyBhcyBpdHMgZmlyc3QgSUQsIGFzIHRoZXJlXHJcbiAgICAgICAgLy8gaXMgbm8gZGlmZmVyZW50aWF0aW9uIGluIHRoZSBwcm90b2NvbCBsYXllciBiZXR3ZWVuIGFuIHVuc2V0IG51bWJlciBhbmRcclxuICAgICAgICAvLyB0aGUgbnVtYmVyICcwJy4gSWYgd2Ugd2VyZSB0byBzZW50IGEgdGFyZ2V0IHdpdGggdGFyZ2V0IElEICcwJywgdGhlXHJcbiAgICAgICAgLy8gYmFja2VuZCB3b3VsZCBjb25zaWRlciBpdCB1bnNldCBhbmQgcmVwbGFjZSBpdCB3aXRoIGl0cyBvd24gSUQuXHJcbiAgICAgICAgdmFyIHRhcmdldElkR2VuZXJhdG9yID0gbmV3IFRhcmdldElkR2VuZXJhdG9yKEdlbmVyYXRvcklkcy5RdWVyeUNhY2hlLCAyKTtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0SWRHZW5lcmF0b3I7XHJcbiAgICB9O1xyXG4gICAgVGFyZ2V0SWRHZW5lcmF0b3IuZm9yU3luY0VuZ2luZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBTeW5jIGVuZ2luZSBhc3NpZ25zIHRhcmdldCBJRHMgZm9yIGxpbWJvIGRvY3VtZW50IGRldGVjdGlvbi5cclxuICAgICAgICByZXR1cm4gbmV3IFRhcmdldElkR2VuZXJhdG9yKEdlbmVyYXRvcklkcy5TeW5jRW5naW5lKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVGFyZ2V0SWRHZW5lcmF0b3I7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgSW5kZXhlZERiUXVlcnlDYWNoZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEluZGV4ZWREYlF1ZXJ5Q2FjaGUocmVmZXJlbmNlRGVsZWdhdGUsIHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gcmVmZXJlbmNlRGVsZWdhdGU7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcclxuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IFdlIGRvbid0IGNhY2hlIGdsb2JhbCBtZXRhZGF0YSBmb3IgdGhlIHF1ZXJ5IGNhY2hlLCBzaW5jZVxyXG4gICAgICAgIC8vIHNvbWUgb2YgaXQgKGluIHBhcnRpY3VsYXIgYGhpZ2hlc3RUYXJnZXRJZGApIGNhbiBiZSBtb2RpZmllZCBieSBzZWNvbmRhcnlcclxuICAgICAgICAvLyB0YWJzLiBXZSBjb3VsZCBwZXJoYXBzIGJlIG1vcmUgZ3JhbnVsYXIgKGFuZCBlLmcuIHN0aWxsIGNhY2hlXHJcbiAgICAgICAgLy8gYGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb25gIGluIG1lbW9yeSkgYnV0IGZvciBzaW1wbGljaXR5IHdlIGN1cnJlbnRseSBnb1xyXG4gICAgICAgIC8vIHRvIEluZGV4ZWREYiB3aGVuZXZlciB3ZSBuZWVkIHRvIHJlYWQgbWV0YWRhdGEuIFdlIGNhbiByZXZpc2l0IGlmIGl0IHR1cm5zXHJcbiAgICAgICAgLy8gb3V0IHRvIGhhdmUgYSBtZWFuaW5nZnVsIHBlcmZvcm1hbmNlIGltcGFjdC5cclxuICAgICAgICB0aGlzLnRhcmdldElkR2VuZXJhdG9yID0gVGFyZ2V0SWRHZW5lcmF0b3IuZm9yUXVlcnlDYWNoZSgpO1xyXG4gICAgfVxyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuYWxsb2NhdGVUYXJnZXRJZCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cmlldmVNZXRhZGF0YSh0cmFuc2FjdGlvbikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgbWV0YWRhdGEuaGlnaGVzdFRhcmdldElkID0gX3RoaXMudGFyZ2V0SWRHZW5lcmF0b3IuYWZ0ZXIobWV0YWRhdGEuaGlnaGVzdFRhcmdldElkKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNhdmVNZXRhZGF0YSh0cmFuc2FjdGlvbiwgbWV0YWRhdGEpLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gbWV0YWRhdGEuaGlnaGVzdFRhcmdldElkOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cmlldmVNZXRhZGF0YSh0cmFuc2FjdGlvbikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5mcm9tVGltZXN0YW1wKG5ldyBUaW1lc3RhbXAobWV0YWRhdGEubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbi5zZWNvbmRzLCBtZXRhZGF0YS5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uLm5hbm9zZWNvbmRzKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIGdldEhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcih0cmFuc2FjdGlvbi5zaW1wbGVEYlRyYW5zYWN0aW9uKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5zZXRUYXJnZXRzTWV0YWRhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciwgbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cmlldmVNZXRhZGF0YSh0cmFuc2FjdGlvbikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgbWV0YWRhdGEuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID0gaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgICAgICBpZiAobGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgbWV0YWRhdGEubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24udG9UaW1lc3RhbXAoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID4gbWV0YWRhdGEuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICBtZXRhZGF0YS5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNhdmVNZXRhZGF0YSh0cmFuc2FjdGlvbiwgbWV0YWRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmFkZFF1ZXJ5RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5zYXZlUXVlcnlEYXRhKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEpLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucmV0cmlldmVNZXRhZGF0YSh0cmFuc2FjdGlvbikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhLnRhcmdldENvdW50ICs9IDE7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVNZXRhZGF0YUZyb21RdWVyeURhdGEocXVlcnlEYXRhLCBtZXRhZGF0YSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc2F2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uLCBtZXRhZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnVwZGF0ZVF1ZXJ5RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZVF1ZXJ5RGF0YSh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5yZW1vdmVRdWVyeURhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlTWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YS50YXJnZXRJZClcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gdGFyZ2V0c1N0b3JlKHRyYW5zYWN0aW9uKS5kZWxldGUocXVlcnlEYXRhLnRhcmdldElkKTsgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucmV0cmlldmVNZXRhZGF0YSh0cmFuc2FjdGlvbik7IH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICBhc3NlcnQobWV0YWRhdGEudGFyZ2V0Q291bnQgPiAwLCAnUmVtb3ZpbmcgZnJvbSBhbiBlbXB0eSBxdWVyeSBjYWNoZScpO1xyXG4gICAgICAgICAgICBtZXRhZGF0YS50YXJnZXRDb3VudCAtPSAxO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc2F2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uLCBtZXRhZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBEcm9wcyBhbnkgdGFyZ2V0cyB3aXRoIHNlcXVlbmNlIG51bWJlciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHVwcGVyIGJvdW5kLCBleGNlcHRpbmcgdGhvc2VcclxuICAgICAqIHByZXNlbnQgaW4gYGFjdGl2ZVRhcmdldElkc2AuIERvY3VtZW50IGFzc29jaWF0aW9ucyBmb3IgdGhlIHJlbW92ZWQgdGFyZ2V0cyBhcmUgYWxzbyByZW1vdmVkLlxyXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHRhcmdldHMgcmVtb3ZlZC5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUucmVtb3ZlVGFyZ2V0cyA9IGZ1bmN0aW9uICh0eG4sIHVwcGVyQm91bmQsIGFjdGl2ZVRhcmdldElkcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcclxuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0c1N0b3JlKHR4bilcclxuICAgICAgICAgICAgLml0ZXJhdGUoZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5RGF0YSA9IF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiVGFyZ2V0KHZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKHF1ZXJ5RGF0YS5zZXF1ZW5jZU51bWJlciA8PSB1cHBlckJvdW5kICYmXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVUYXJnZXRJZHNbcXVlcnlEYXRhLnRhcmdldElkXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChfdGhpcy5yZW1vdmVRdWVyeURhdGEodHhuLCBxdWVyeURhdGEpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKTsgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gY291bnQ7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2FsbCBwcm92aWRlZCBmdW5jdGlvbiB3aXRoIGVhY2ggYFF1ZXJ5RGF0YWAgdGhhdCB3ZSBoYXZlIGNhY2hlZC5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuZm9yRWFjaFRhcmdldCA9IGZ1bmN0aW9uICh0eG4sIGYpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRzU3RvcmUodHhuKS5pdGVyYXRlKGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeURhdGEgPSBfdGhpcy5zZXJpYWxpemVyLmZyb21EYlRhcmdldCh2YWx1ZSk7XHJcbiAgICAgICAgICAgIGYocXVlcnlEYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5yZXRyaWV2ZU1ldGFkYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHJldHJpZXZlTWV0YWRhdGEodHJhbnNhY3Rpb24uc2ltcGxlRGJUcmFuc2FjdGlvbik7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuc2F2ZU1ldGFkYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBtZXRhZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBnbG9iYWxUYXJnZXRTdG9yZSh0cmFuc2FjdGlvbikucHV0KERiVGFyZ2V0R2xvYmFsLmtleSwgbWV0YWRhdGEpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnNhdmVRdWVyeURhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRzU3RvcmUodHJhbnNhY3Rpb24pLnB1dCh0aGlzLnNlcmlhbGl6ZXIudG9EYlRhcmdldChxdWVyeURhdGEpKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEluLXBsYWNlIHVwZGF0ZXMgdGhlIHByb3ZpZGVkIG1ldGFkYXRhIHRvIGFjY291bnQgZm9yIHZhbHVlcyBpbiB0aGUgZ2l2ZW5cclxuICAgICAqIFF1ZXJ5RGF0YS4gU2F2aW5nIGlzIGRvbmUgc2VwYXJhdGVseS4gUmV0dXJucyB0cnVlIGlmIHRoZXJlIHdlcmUgYW55XHJcbiAgICAgKiBjaGFuZ2VzIHRvIHRoZSBtZXRhZGF0YS5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUudXBkYXRlTWV0YWRhdGFGcm9tUXVlcnlEYXRhID0gZnVuY3Rpb24gKHF1ZXJ5RGF0YSwgbWV0YWRhdGEpIHtcclxuICAgICAgICB2YXIgdXBkYXRlZCA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChxdWVyeURhdGEudGFyZ2V0SWQgPiBtZXRhZGF0YS5oaWdoZXN0VGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgbWV0YWRhdGEuaGlnaGVzdFRhcmdldElkID0gcXVlcnlEYXRhLnRhcmdldElkO1xyXG4gICAgICAgICAgICB1cGRhdGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHF1ZXJ5RGF0YS5zZXF1ZW5jZU51bWJlciA+IG1ldGFkYXRhLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBxdWVyeURhdGEuc2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgICAgIHVwZGF0ZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdXBkYXRlZDtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRRdWVyeUNvdW50ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cmlldmVNZXRhZGF0YSh0cmFuc2FjdGlvbikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHsgcmV0dXJuIG1ldGFkYXRhLnRhcmdldENvdW50OyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRRdWVyeURhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBJdGVyYXRpbmcgYnkgdGhlIGNhbm9uaWNhbElkIG1heSB5aWVsZCBtb3JlIHRoYW4gb25lIHJlc3VsdCBiZWNhdXNlXHJcbiAgICAgICAgLy8gY2Fub25pY2FsSWQgdmFsdWVzIGFyZSBub3QgcmVxdWlyZWQgdG8gYmUgdW5pcXVlIHBlciB0YXJnZXQuIFRoaXMgcXVlcnlcclxuICAgICAgICAvLyBkZXBlbmRzIG9uIHRoZSBxdWVyeVRhcmdldHMgaW5kZXggdG8gYmUgZWZmaWNpZW50LlxyXG4gICAgICAgIHZhciBjYW5vbmljYWxJZCA9IHF1ZXJ5LmNhbm9uaWNhbElkKCk7XHJcbiAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UuYm91bmQoW2Nhbm9uaWNhbElkLCBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFldLCBbY2Fub25pY2FsSWQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWV0pO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRzU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKHsgcmFuZ2U6IHJhbmdlLCBpbmRleDogRGJUYXJnZXQucXVlcnlUYXJnZXRzSW5kZXhOYW1lIH0sIGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgIHZhciBmb3VuZCA9IF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiVGFyZ2V0KHZhbHVlKTtcclxuICAgICAgICAgICAgLy8gQWZ0ZXIgZmluZGluZyBhIHBvdGVudGlhbCBtYXRjaCwgY2hlY2sgdGhhdCB0aGUgcXVlcnkgaXNcclxuICAgICAgICAgICAgLy8gYWN0dWFsbHkgZXF1YWwgdG8gdGhlIHJlcXVlc3RlZCBxdWVyeS5cclxuICAgICAgICAgICAgaWYgKHF1ZXJ5LmlzRXF1YWwoZm91bmQucXVlcnkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBmb3VuZDtcclxuICAgICAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0OyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5hZGRNYXRjaGluZ0tleXMgPSBmdW5jdGlvbiAodHhuLCBrZXlzLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBUaGUgcmV2ZXJzZSBpbmRleCAoZG9jdW1lbnRzVGFyZ2V0cykgaXMgbWFpbnRhaW5lZCBieVxyXG4gICAgICAgIC8vIEluZGV4ZWREYi5cclxuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICB2YXIgc3RvcmUgPSBkb2N1bWVudFRhcmdldFN0b3JlKHR4bik7XHJcbiAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBlbmNvZGUoa2V5LnBhdGgpO1xyXG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKHN0b3JlLnB1dChuZXcgRGJUYXJnZXREb2N1bWVudCh0YXJnZXRJZCwgcGF0aCkpKTtcclxuICAgICAgICAgICAgcHJvbWlzZXMucHVzaChfdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5hZGRSZWZlcmVuY2UodHhuLCBrZXkpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnJlbW92ZU1hdGNoaW5nS2V5cyA9IGZ1bmN0aW9uICh0eG4sIGtleXMsIHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IFRoZSByZXZlcnNlIGluZGV4IChkb2N1bWVudHNUYXJnZXRzKSBpcyBtYWludGFpbmVkIGJ5XHJcbiAgICAgICAgLy8gSW5kZXhlZERiLlxyXG4gICAgICAgIHZhciBzdG9yZSA9IGRvY3VtZW50VGFyZ2V0U3RvcmUodHhuKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2goa2V5cywgZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IGVuY29kZShrZXkucGF0aCk7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihbXHJcbiAgICAgICAgICAgICAgICBzdG9yZS5kZWxldGUoW3RhcmdldElkLCBwYXRoXSksXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVSZWZlcmVuY2UodHhuLCBrZXkpXHJcbiAgICAgICAgICAgIF0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkID0gZnVuY3Rpb24gKHR4biwgdGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgc3RvcmUgPSBkb2N1bWVudFRhcmdldFN0b3JlKHR4bik7XHJcbiAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UuYm91bmQoW3RhcmdldElkXSwgW3RhcmdldElkICsgMV0sIFxyXG4gICAgICAgIC8qbG93ZXJPcGVuPSovIGZhbHNlLCBcclxuICAgICAgICAvKnVwcGVyT3Blbj0qLyB0cnVlKTtcclxuICAgICAgICByZXR1cm4gc3RvcmUuZGVsZXRlKHJhbmdlKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCA9IGZ1bmN0aW9uICh0eG4sIHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UuYm91bmQoW3RhcmdldElkXSwgW3RhcmdldElkICsgMV0sIFxyXG4gICAgICAgIC8qbG93ZXJPcGVuPSovIGZhbHNlLCBcclxuICAgICAgICAvKnVwcGVyT3Blbj0qLyB0cnVlKTtcclxuICAgICAgICB2YXIgc3RvcmUgPSBkb2N1bWVudFRhcmdldFN0b3JlKHR4bik7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKHsgcmFuZ2U6IHJhbmdlLCBrZXlzT25seTogdHJ1ZSB9LCBmdW5jdGlvbiAoa2V5LCBfLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gZGVjb2RlJDEoa2V5WzFdKTtcclxuICAgICAgICAgICAgdmFyIGRvY0tleSA9IG5ldyBEb2N1bWVudEtleShwYXRoKTtcclxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmFkZChkb2NLZXkpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlc3VsdDsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuY29udGFpbnNLZXkgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB2YXIgcGF0aCA9IGVuY29kZShrZXkucGF0aCk7XHJcbiAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UuYm91bmQoW3BhdGhdLCBbaW1tZWRpYXRlU3VjY2Vzc29yKHBhdGgpXSwgXHJcbiAgICAgICAgLypsb3dlck9wZW49Ki8gZmFsc2UsIFxyXG4gICAgICAgIC8qdXBwZXJPcGVuPSovIHRydWUpO1xyXG4gICAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50VGFyZ2V0U3RvcmUodHhuKVxyXG4gICAgICAgICAgICAuaXRlcmF0ZSh7XHJcbiAgICAgICAgICAgIGluZGV4OiBEYlRhcmdldERvY3VtZW50LmRvY3VtZW50VGFyZ2V0c0luZGV4LFxyXG4gICAgICAgICAgICBrZXlzT25seTogdHJ1ZSxcclxuICAgICAgICAgICAgcmFuZ2U6IHJhbmdlXHJcbiAgICAgICAgfSwgZnVuY3Rpb24gKF9hLCBfLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IF9hWzBdLCBwYXRoID0gX2FbMV07XHJcbiAgICAgICAgICAgIC8vIEhhdmluZyBhIHNlbnRpbmVsIHJvdyBmb3IgYSBkb2N1bWVudCBkb2VzIG5vdCBjb3VudCBhcyBjb250YWluaW5nIHRoYXQgZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgIC8vIEZvciB0aGUgcXVlcnkgY2FjaGUsIGNvbnRhaW5pbmcgdGhlIGRvY3VtZW50IG1lYW5zIHRoZSBkb2N1bWVudCBpcyBwYXJ0IG9mIHNvbWVcclxuICAgICAgICAgICAgLy8gdGFyZ2V0LlxyXG4gICAgICAgICAgICBpZiAodGFyZ2V0SWQgIT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNvdW50ID4gMDsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0UXVlcnlEYXRhRm9yVGFyZ2V0ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldHNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLmdldCh0YXJnZXRJZClcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGZvdW5kKSB7XHJcbiAgICAgICAgICAgIGlmIChmb3VuZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiVGFyZ2V0KGZvdW5kKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlF1ZXJ5Q2FjaGU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHF1ZXJpZXMgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gdGFyZ2V0c1N0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJUYXJnZXQuc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHRhcmdldCBnbG9iYWxzIG9iamVjdCBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIGdsb2JhbFRhcmdldFN0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJUYXJnZXRHbG9iYWwuc3RvcmUpO1xyXG59XHJcbmZ1bmN0aW9uIHJldHJpZXZlTWV0YWRhdGEodHhuKSB7XHJcbiAgICB2YXIgZ2xvYmFsU3RvcmUgPSBTaW1wbGVEYi5nZXRTdG9yZSh0eG4sIERiVGFyZ2V0R2xvYmFsLnN0b3JlKTtcclxuICAgIHJldHVybiBnbG9iYWxTdG9yZS5nZXQoRGJUYXJnZXRHbG9iYWwua2V5KS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgIGFzc2VydChtZXRhZGF0YSAhPT0gbnVsbCwgJ01pc3NpbmcgbWV0YWRhdGEgcm93LicpO1xyXG4gICAgICAgIHJldHVybiBtZXRhZGF0YTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGdldEhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcih0eG4pIHtcclxuICAgIHJldHVybiByZXRyaWV2ZU1ldGFkYXRhKHR4bikubmV4dChmdW5jdGlvbiAodGFyZ2V0R2xvYmFsKSB7IHJldHVybiB0YXJnZXRHbG9iYWwuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyOyB9KTtcclxufVxyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBkb2N1bWVudCB0YXJnZXQgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gZG9jdW1lbnRUYXJnZXRTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiVGFyZ2V0RG9jdW1lbnQuc3RvcmUpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKiogU2VyaWFsaXplciBmb3IgdmFsdWVzIHN0b3JlZCBpbiB0aGUgTG9jYWxTdG9yZS4gKi9cclxudmFyIExvY2FsU2VyaWFsaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExvY2FsU2VyaWFsaXplcihyZW1vdGVTZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdGVTZXJpYWxpemVyID0gcmVtb3RlU2VyaWFsaXplcjtcclxuICAgIH1cclxuICAgIC8qKiBEZWNvZGVzIGEgcmVtb3RlIGRvY3VtZW50IGZyb20gc3RvcmFnZSBsb2NhbGx5IHRvIGEgRG9jdW1lbnQuICovXHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21EYlJlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKHJlbW90ZURvYykge1xyXG4gICAgICAgIGlmIChyZW1vdGVEb2MuZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlU2VyaWFsaXplci5mcm9tRG9jdW1lbnQocmVtb3RlRG9jLmRvY3VtZW50LCAhIXJlbW90ZURvYy5oYXNDb21taXR0ZWRNdXRhdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChyZW1vdGVEb2Mubm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gRG9jdW1lbnRLZXkuZnJvbVNlZ21lbnRzKHJlbW90ZURvYy5ub0RvY3VtZW50LnBhdGgpO1xyXG4gICAgICAgICAgICB2YXIgdmVyc2lvbiA9IHRoaXMuZnJvbURiVGltZXN0YW1wKHJlbW90ZURvYy5ub0RvY3VtZW50LnJlYWRUaW1lKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBOb0RvY3VtZW50KGtleSwgdmVyc2lvbiwge1xyXG4gICAgICAgICAgICAgICAgaGFzQ29tbWl0dGVkTXV0YXRpb25zOiAhIXJlbW90ZURvYy5oYXNDb21taXR0ZWRNdXRhdGlvbnNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHJlbW90ZURvYy51bmtub3duRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIGtleSA9IERvY3VtZW50S2V5LmZyb21TZWdtZW50cyhyZW1vdGVEb2MudW5rbm93bkRvY3VtZW50LnBhdGgpO1xyXG4gICAgICAgICAgICB2YXIgdmVyc2lvbiA9IHRoaXMuZnJvbURiVGltZXN0YW1wKHJlbW90ZURvYy51bmtub3duRG9jdW1lbnQudmVyc2lvbik7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVW5rbm93bkRvY3VtZW50KGtleSwgdmVyc2lvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5leHBlY3RlZCBEYlJlbW90ZURvY3VtZW50Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiBFbmNvZGVzIGEgZG9jdW1lbnQgZm9yIHN0b3JhZ2UgbG9jYWxseS4gKi9cclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUudG9EYlJlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgaWYgKG1heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIGRvYyA9IHRoaXMucmVtb3RlU2VyaWFsaXplci50b0RvY3VtZW50KG1heWJlRG9jKTtcclxuICAgICAgICAgICAgdmFyIGhhc0NvbW1pdHRlZE11dGF0aW9ucyA9IG1heWJlRG9jLmhhc0NvbW1pdHRlZE11dGF0aW9ucztcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYlJlbW90ZURvY3VtZW50KFxyXG4gICAgICAgICAgICAvKiB1bmtub3duRG9jdW1lbnQ9ICovIG51bGwsIFxyXG4gICAgICAgICAgICAvKiBub0RvY3VtZW50PSAqLyBudWxsLCBkb2MsIGhhc0NvbW1pdHRlZE11dGF0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG1heWJlRG9jIGluc3RhbmNlb2YgTm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IG1heWJlRG9jLmtleS5wYXRoLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgdmFyIHJlYWRUaW1lID0gdGhpcy50b0RiVGltZXN0YW1wKG1heWJlRG9jLnZlcnNpb24pO1xyXG4gICAgICAgICAgICB2YXIgaGFzQ29tbWl0dGVkTXV0YXRpb25zID0gbWF5YmVEb2MuaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERiUmVtb3RlRG9jdW1lbnQoXHJcbiAgICAgICAgICAgIC8qIHVua25vd25Eb2N1bWVudD0gKi8gbnVsbCwgbmV3IERiTm9Eb2N1bWVudChwYXRoLCByZWFkVGltZSksIFxyXG4gICAgICAgICAgICAvKiBkb2N1bWVudD0gKi8gbnVsbCwgaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobWF5YmVEb2MgaW5zdGFuY2VvZiBVbmtub3duRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBtYXliZURvYy5rZXkucGF0aC50b0FycmF5KCk7XHJcbiAgICAgICAgICAgIHZhciByZWFkVGltZSA9IHRoaXMudG9EYlRpbWVzdGFtcChtYXliZURvYy52ZXJzaW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYlJlbW90ZURvY3VtZW50KG5ldyBEYlVua25vd25Eb2N1bWVudChwYXRoLCByZWFkVGltZSksIFxyXG4gICAgICAgICAgICAvKiBub0RvY3VtZW50PSAqLyBudWxsLCBcclxuICAgICAgICAgICAgLyogZG9jdW1lbnQ9ICovIG51bGwsIFxyXG4gICAgICAgICAgICAvKiBoYXNDb21taXR0ZWRNdXRhdGlvbnM9ICovIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1VuZXhwZWN0ZWQgTWF5YmVEb2N1bW1lbnQnKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS50b0RiVGltZXN0YW1wID0gZnVuY3Rpb24gKHNuYXBzaG90VmVyc2lvbikge1xyXG4gICAgICAgIHZhciB0aW1lc3RhbXAgPSBzbmFwc2hvdFZlcnNpb24udG9UaW1lc3RhbXAoKTtcclxuICAgICAgICByZXR1cm4gbmV3IERiVGltZXN0YW1wKHRpbWVzdGFtcC5zZWNvbmRzLCB0aW1lc3RhbXAubmFub3NlY29uZHMpO1xyXG4gICAgfTtcclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbURiVGltZXN0YW1wID0gZnVuY3Rpb24gKGRiVGltZXN0YW1wKSB7XHJcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IG5ldyBUaW1lc3RhbXAoZGJUaW1lc3RhbXAuc2Vjb25kcywgZGJUaW1lc3RhbXAubmFub3NlY29uZHMpO1xyXG4gICAgICAgIHJldHVybiBTbmFwc2hvdFZlcnNpb24uZnJvbVRpbWVzdGFtcCh0aW1lc3RhbXApO1xyXG4gICAgfTtcclxuICAgIC8qKiBFbmNvZGVzIGEgYmF0Y2ggb2YgbXV0YXRpb25zIGludG8gYSBEYk11dGF0aW9uQmF0Y2ggZm9yIGxvY2FsIHN0b3JhZ2UuICovXHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLnRvRGJNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKHVzZXJJZCwgYmF0Y2gpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzZXJpYWxpemVkTXV0YXRpb25zID0gYmF0Y2gubXV0YXRpb25zLm1hcChmdW5jdGlvbiAobSkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucmVtb3RlU2VyaWFsaXplci50b011dGF0aW9uKG0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgRGJNdXRhdGlvbkJhdGNoKHVzZXJJZCwgYmF0Y2guYmF0Y2hJZCwgYmF0Y2gubG9jYWxXcml0ZVRpbWUudG9NaWxsaXMoKSwgc2VyaWFsaXplZE11dGF0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgLyoqIERlY29kZXMgYSBEYk11dGF0aW9uQmF0Y2ggaW50byBhIE11dGF0aW9uQmF0Y2ggKi9cclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbURiTXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uIChkYkJhdGNoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgbXV0YXRpb25zID0gZGJCYXRjaC5tdXRhdGlvbnMubWFwKGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW1vdGVTZXJpYWxpemVyLmZyb21NdXRhdGlvbihtKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgdGltZXN0YW1wID0gVGltZXN0YW1wLmZyb21NaWxsaXMoZGJCYXRjaC5sb2NhbFdyaXRlVGltZU1zKTtcclxuICAgICAgICByZXR1cm4gbmV3IE11dGF0aW9uQmF0Y2goZGJCYXRjaC5iYXRjaElkLCB0aW1lc3RhbXAsIG11dGF0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgLypcclxuICAgICAqIEVuY29kZXMgYSBzZXQgb2YgZG9jdW1lbnQga2V5cyBpbnRvIGFuIGFycmF5IG9mIEVuY29kZWRSZXNvdXJjZVBhdGhzLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLnRvRGJSZXNvdXJjZVBhdGhzID0gZnVuY3Rpb24gKGtleXMpIHtcclxuICAgICAgICB2YXIgZW5jb2RlZEtleXMgPSBbXTtcclxuICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICBlbmNvZGVkS2V5cy5wdXNoKGVuY29kZShrZXkucGF0aCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBlbmNvZGVkS2V5cztcclxuICAgIH07XHJcbiAgICAvKiogRGVjb2RlcyBhbiBhcnJheSBvZiBFbmNvZGVkUmVzb3VyY2VQYXRocyBpbnRvIGEgc2V0IG9mIGRvY3VtZW50IGtleXMuICovXHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21EYlJlc291cmNlUGF0aHMgPSBmdW5jdGlvbiAoZW5jb2RlZFBhdGhzKSB7XHJcbiAgICAgICAgdmFyIGtleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgZW5jb2RlZFBhdGhzXzEgPSBlbmNvZGVkUGF0aHM7IF9pIDwgZW5jb2RlZFBhdGhzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBkb2N1bWVudEtleSA9IGVuY29kZWRQYXRoc18xW19pXTtcclxuICAgICAgICAgICAga2V5cyA9IGtleXMuYWRkKG5ldyBEb2N1bWVudEtleShkZWNvZGUkMShkb2N1bWVudEtleSkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGtleXM7XHJcbiAgICB9O1xyXG4gICAgLyoqIERlY29kZXMgYSBEYlRhcmdldCBpbnRvIFF1ZXJ5RGF0YSAqL1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRGJUYXJnZXQgPSBmdW5jdGlvbiAoZGJUYXJnZXQpIHtcclxuICAgICAgICB2YXIgdmVyc2lvbiA9IHRoaXMuZnJvbURiVGltZXN0YW1wKGRiVGFyZ2V0LnJlYWRUaW1lKTtcclxuICAgICAgICB2YXIgcXVlcnk7XHJcbiAgICAgICAgaWYgKGlzRG9jdW1lbnRRdWVyeShkYlRhcmdldC5xdWVyeSkpIHtcclxuICAgICAgICAgICAgcXVlcnkgPSB0aGlzLnJlbW90ZVNlcmlhbGl6ZXIuZnJvbURvY3VtZW50c1RhcmdldChkYlRhcmdldC5xdWVyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBxdWVyeSA9IHRoaXMucmVtb3RlU2VyaWFsaXplci5mcm9tUXVlcnlUYXJnZXQoZGJUYXJnZXQucXVlcnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5RGF0YShxdWVyeSwgZGJUYXJnZXQudGFyZ2V0SWQsIFF1ZXJ5UHVycG9zZS5MaXN0ZW4sIGRiVGFyZ2V0Lmxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciwgdmVyc2lvbiwgZGJUYXJnZXQucmVzdW1lVG9rZW4pO1xyXG4gICAgfTtcclxuICAgIC8qKiBFbmNvZGVzIFF1ZXJ5RGF0YSBpbnRvIGEgRGJUYXJnZXQgZm9yIHN0b3JhZ2UgbG9jYWxseS4gKi9cclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUudG9EYlRhcmdldCA9IGZ1bmN0aW9uIChxdWVyeURhdGEpIHtcclxuICAgICAgICBhc3NlcnQoUXVlcnlQdXJwb3NlLkxpc3RlbiA9PT0gcXVlcnlEYXRhLnB1cnBvc2UsICdPbmx5IHF1ZXJpZXMgd2l0aCBwdXJwb3NlICcgK1xyXG4gICAgICAgICAgICBRdWVyeVB1cnBvc2UuTGlzdGVuICtcclxuICAgICAgICAgICAgJyBtYXkgYmUgc3RvcmVkLCBnb3QgJyArXHJcbiAgICAgICAgICAgIHF1ZXJ5RGF0YS5wdXJwb3NlKTtcclxuICAgICAgICB2YXIgZGJUaW1lc3RhbXAgPSB0aGlzLnRvRGJUaW1lc3RhbXAocXVlcnlEYXRhLnNuYXBzaG90VmVyc2lvbik7XHJcbiAgICAgICAgdmFyIHF1ZXJ5UHJvdG87XHJcbiAgICAgICAgaWYgKHF1ZXJ5RGF0YS5xdWVyeS5pc0RvY3VtZW50UXVlcnkoKSkge1xyXG4gICAgICAgICAgICBxdWVyeVByb3RvID0gdGhpcy5yZW1vdGVTZXJpYWxpemVyLnRvRG9jdW1lbnRzVGFyZ2V0KHF1ZXJ5RGF0YS5xdWVyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBxdWVyeVByb3RvID0gdGhpcy5yZW1vdGVTZXJpYWxpemVyLnRvUXVlcnlUYXJnZXQocXVlcnlEYXRhLnF1ZXJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHJlc3VtZVRva2VuO1xyXG4gICAgICAgIGlmIChxdWVyeURhdGEucmVzdW1lVG9rZW4gaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE8oYi83ODc3MTQwMyk6IENvbnZlcnQgdG9rZW5zIHRvIHN0cmluZ3MgZHVyaW5nIGRlc2VyaWFsaXphdGlvblxyXG4gICAgICAgICAgICBhc3NlcnQocHJvY2Vzcy5lbnYuVVNFX01PQ0tfUEVSU0lTVEVOQ0UgPT09ICdZRVMnLCAnUGVyc2lzdGluZyBub24tc3RyaW5nIHN0cmVhbSB0b2tlbnMgaXMgb25seSBzdXBwb3J0ZWQgd2l0aCBtb2NrIHBlcnNpc3RlbmNlIC4nKTtcclxuICAgICAgICAgICAgcmVzdW1lVG9rZW4gPSBxdWVyeURhdGEucmVzdW1lVG9rZW4udG9TdHJpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJlc3VtZVRva2VuID0gcXVlcnlEYXRhLnJlc3VtZVRva2VuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgaXMgYWx3YXlzIDAgdW50aWwgd2UgZG8gcmVhbCBHQy5cclxuICAgICAgICByZXR1cm4gbmV3IERiVGFyZ2V0KHF1ZXJ5RGF0YS50YXJnZXRJZCwgcXVlcnlEYXRhLnF1ZXJ5LmNhbm9uaWNhbElkKCksIGRiVGltZXN0YW1wLCByZXN1bWVUb2tlbiwgcXVlcnlEYXRhLnNlcXVlbmNlTnVtYmVyLCBxdWVyeVByb3RvKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTG9jYWxTZXJpYWxpemVyO1xyXG59KCkpO1xyXG4vKipcclxuICogQSBoZWxwZXIgZnVuY3Rpb24gZm9yIGZpZ3VyaW5nIG91dCB3aGF0IGtpbmQgb2YgcXVlcnkgaGFzIGJlZW4gc3RvcmVkLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNEb2N1bWVudFF1ZXJ5KGRiUXVlcnkpIHtcclxuICAgIHJldHVybiBkYlF1ZXJ5LmRvY3VtZW50cyAhPT0gdW5kZWZpbmVkO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBidWZmZXJFbnRyeUNvbXBhcmF0b3IoX2EsIF9iKSB7XHJcbiAgICB2YXIgYVNlcXVlbmNlID0gX2FbMF0sIGFJbmRleCA9IF9hWzFdO1xyXG4gICAgdmFyIGJTZXF1ZW5jZSA9IF9iWzBdLCBiSW5kZXggPSBfYlsxXTtcclxuICAgIHZhciBzZXFDbXAgPSBwcmltaXRpdmVDb21wYXJhdG9yKGFTZXF1ZW5jZSwgYlNlcXVlbmNlKTtcclxuICAgIGlmIChzZXFDbXAgPT09IDApIHtcclxuICAgICAgICAvLyBUaGlzIG9yZGVyIGRvZXNuJ3QgbWF0dGVyLCBidXQgd2UgY2FuIGJpYXMgYWdhaW5zdCBjaHVybiBieSBzb3J0aW5nXHJcbiAgICAgICAgLy8gZW50cmllcyBjcmVhdGVkIGVhcmxpZXIgYXMgbGVzcyB0aGFuIG5ld2VyIGVudHJpZXMuXHJcbiAgICAgICAgcmV0dXJuIHByaW1pdGl2ZUNvbXBhcmF0b3IoYUluZGV4LCBiSW5kZXgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHNlcUNtcDtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVXNlZCB0byBjYWxjdWxhdGUgdGhlIG50aCBzZXF1ZW5jZSBudW1iZXIuIEtlZXBzIGEgcm9sbGluZyBidWZmZXIgb2YgdGhlXHJcbiAqIGxvd2VzdCBuIHZhbHVlcyBwYXNzZWQgdG8gYGFkZEVsZW1lbnRgLCBhbmQgZmluYWxseSByZXBvcnRzIHRoZSBsYXJnZXN0IG9mXHJcbiAqIHRoZW0gaW4gYG1heFZhbHVlYC5cclxuICovXHJcbnZhciBSb2xsaW5nU2VxdWVuY2VOdW1iZXJCdWZmZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSb2xsaW5nU2VxdWVuY2VOdW1iZXJCdWZmZXIobWF4RWxlbWVudHMpIHtcclxuICAgICAgICB0aGlzLm1heEVsZW1lbnRzID0gbWF4RWxlbWVudHM7XHJcbiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXcgU29ydGVkU2V0KGJ1ZmZlckVudHJ5Q29tcGFyYXRvcik7XHJcbiAgICAgICAgdGhpcy5wcmV2aW91c0luZGV4ID0gMDtcclxuICAgIH1cclxuICAgIFJvbGxpbmdTZXF1ZW5jZU51bWJlckJ1ZmZlci5wcm90b3R5cGUubmV4dEluZGV4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiArK3RoaXMucHJldmlvdXNJbmRleDtcclxuICAgIH07XHJcbiAgICBSb2xsaW5nU2VxdWVuY2VOdW1iZXJCdWZmZXIucHJvdG90eXBlLmFkZEVsZW1lbnQgPSBmdW5jdGlvbiAoc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICB2YXIgZW50cnkgPSBbc2VxdWVuY2VOdW1iZXIsIHRoaXMubmV4dEluZGV4KCldO1xyXG4gICAgICAgIGlmICh0aGlzLmJ1ZmZlci5zaXplIDwgdGhpcy5tYXhFbGVtZW50cykge1xyXG4gICAgICAgICAgICB0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLmFkZChlbnRyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgaGlnaGVzdFZhbHVlID0gdGhpcy5idWZmZXIubGFzdCgpO1xyXG4gICAgICAgICAgICBpZiAoYnVmZmVyRW50cnlDb21wYXJhdG9yKGVudHJ5LCBoaWdoZXN0VmFsdWUpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5kZWxldGUoaGlnaGVzdFZhbHVlKS5hZGQoZW50cnkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSb2xsaW5nU2VxdWVuY2VOdW1iZXJCdWZmZXIucHJvdG90eXBlLCBcIm1heFZhbHVlXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gR3VhcmFudGVlZCB0byBiZSBub24tZW1wdHkuIElmIHdlIGRlY2lkZSB3ZSBhcmUgbm90IGNvbGxlY3RpbmcgYW55XHJcbiAgICAgICAgICAgIC8vIHNlcXVlbmNlIG51bWJlcnMsIG50aFNlcXVlbmNlTnVtYmVyIGJlbG93IHNob3J0LWNpcmN1aXRzLiBJZiB3ZSBoYXZlXHJcbiAgICAgICAgICAgIC8vIGRlY2lkZWQgdGhhdCB3ZSBhcmUgY29sbGVjdGluZyBuIHNlcXVlbmNlIG51bWJlcnMsIGl0J3MgYmVjYXVzZSBuIGlzIHNvbWVcclxuICAgICAgICAgICAgLy8gcGVyY2VudGFnZSBvZiB0aGUgZXhpc3Rpbmcgc2VxdWVuY2UgbnVtYmVycy4gVGhhdCBtZWFucyB3ZSBzaG91bGQgbmV2ZXJcclxuICAgICAgICAgICAgLy8gYmUgaW4gYSBzaXR1YXRpb24gd2hlcmUgd2UgYXJlIGNvbGxlY3Rpbmcgc2VxdWVuY2UgbnVtYmVycyBidXQgZG9uJ3RcclxuICAgICAgICAgICAgLy8gYWN0dWFsbHkgaGF2ZSBhbnkuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlci5sYXN0KClbMF07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gUm9sbGluZ1NlcXVlbmNlTnVtYmVyQnVmZmVyO1xyXG59KCkpO1xyXG4vKiogSW1wbGVtZW50cyB0aGUgc3RlcHMgZm9yIExSVSBnYXJiYWdlIGNvbGxlY3Rpb24uICovXHJcbnZhciBMcnVHYXJiYWdlQ29sbGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTHJ1R2FyYmFnZUNvbGxlY3RvcihkZWxlZ2F0ZSkge1xyXG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcclxuICAgIH1cclxuICAgIC8qKiBHaXZlbiBhIHBlcmNlbnRpbGUgb2YgdGFyZ2V0IHRvIGNvbGxlY3QsIHJldHVybnMgdGhlIG51bWJlciBvZiB0YXJnZXRzIHRvIGNvbGxlY3QuICovXHJcbiAgICBMcnVHYXJiYWdlQ29sbGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVUYXJnZXRDb3VudCA9IGZ1bmN0aW9uICh0eG4sIHBlcmNlbnRpbGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5nZXRUYXJnZXRDb3VudCh0eG4pLm5leHQoZnVuY3Rpb24gKHRhcmdldENvdW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKHBlcmNlbnRpbGUgLyAxMDAuMCAqIHRhcmdldENvdW50KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogUmV0dXJucyB0aGUgbnRoIHNlcXVlbmNlIG51bWJlciwgY291bnRpbmcgaW4gb3JkZXIgZnJvbSB0aGUgc21hbGxlc3QuICovXHJcbiAgICBMcnVHYXJiYWdlQ29sbGVjdG9yLnByb3RvdHlwZS5udGhTZXF1ZW5jZU51bWJlciA9IGZ1bmN0aW9uICh0eG4sIG4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChuID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShMaXN0ZW5TZXF1ZW5jZS5JTlZBTElEKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBSb2xsaW5nU2VxdWVuY2VOdW1iZXJCdWZmZXIobik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGVcclxuICAgICAgICAgICAgLmZvckVhY2hUYXJnZXQodHhuLCBmdW5jdGlvbiAodGFyZ2V0KSB7IHJldHVybiBidWZmZXIuYWRkRWxlbWVudCh0YXJnZXQuc2VxdWVuY2VOdW1iZXIpOyB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5kZWxlZ2F0ZS5mb3JFYWNoT3JwaGFuZWREb2N1bWVudFNlcXVlbmNlTnVtYmVyKHR4biwgZnVuY3Rpb24gKHNlcXVlbmNlTnVtYmVyKSB7IHJldHVybiBidWZmZXIuYWRkRWxlbWVudChzZXF1ZW5jZU51bWJlcik7IH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGJ1ZmZlci5tYXhWYWx1ZTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIHRhcmdldHMgd2l0aCBhIHNlcXVlbmNlIG51bWJlciBlcXVhbCB0byBvciBsZXNzIHRoYW4gdGhlIGdpdmVuIHVwcGVyIGJvdW5kLCBhbmQgcmVtb3Zlc1xyXG4gICAgICogZG9jdW1lbnQgYXNzb2NpYXRpb25zIHdpdGggdGhvc2UgdGFyZ2V0cy5cclxuICAgICAqL1xyXG4gICAgTHJ1R2FyYmFnZUNvbGxlY3Rvci5wcm90b3R5cGUucmVtb3ZlVGFyZ2V0cyA9IGZ1bmN0aW9uICh0eG4sIHVwcGVyQm91bmQsIGFjdGl2ZVRhcmdldElkcykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLnJlbW92ZVRhcmdldHModHhuLCB1cHBlckJvdW5kLCBhY3RpdmVUYXJnZXRJZHMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyBkb2N1bWVudHMgdGhhdCBoYXZlIGEgc2VxdWVuY2UgbnVtYmVyIGVxdWFsIHRvIG9yIGxlc3MgdGhhbiB0aGUgdXBwZXIgYm91bmQgYW5kIGFyZSBub3RcclxuICAgICAqIG90aGVyd2lzZSBwaW5uZWQuXHJcbiAgICAgKi9cclxuICAgIExydUdhcmJhZ2VDb2xsZWN0b3IucHJvdG90eXBlLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzID0gZnVuY3Rpb24gKHR4biwgdXBwZXJCb3VuZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKHR4biwgdXBwZXJCb3VuZCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExydUdhcmJhZ2VDb2xsZWN0b3I7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogT3BhcXVlIGludGVyZmFjZSByZXByZXNlbnRpbmcgYSBwZXJzaXN0ZW5jZSB0cmFuc2FjdGlvbi5cclxuICpcclxuICogV2hlbiB5b3UgY2FsbCBQZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbigpLCBpdCB3aWxsIGNyZWF0ZSBhIHRyYW5zYWN0aW9uIGFuZFxyXG4gKiBwYXNzIGl0IHRvIHlvdXIgY2FsbGJhY2suIFlvdSB0aGVuIHBhc3MgaXQgdG8gYW55IG1ldGhvZCB0aGF0IG9wZXJhdGVzXHJcbiAqIG9uIHBlcnNpc3RlbmNlLlxyXG4gKi9cclxudmFyIFBlcnNpc3RlbmNlVHJhbnNhY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQZXJzaXN0ZW5jZVRyYW5zYWN0aW9uKCkge1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFBlcnNpc3RlbmNlVHJhbnNhY3Rpb247XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQyID0gJ0luZGV4ZWREYlBlcnNpc3RlbmNlJztcclxuLyoqXHJcbiAqIE9sZGVzdCBhY2NlcHRhYmxlIGFnZSBpbiBtaWxsaXNlY29uZHMgZm9yIGNsaWVudCBtZXRhZGF0YSBiZWZvcmUgdGhlIGNsaWVudFxyXG4gKiBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCBpdHMgYXNzb2NpYXRlZCBkYXRhIChzdWNoIGFzIHRoZSByZW1vdGUgZG9jdW1lbnRcclxuICogY2FjaGUgY2hhbmdlbG9nKSBpcyBnYXJiYWdlIGNvbGxlY3RlZC5cclxuICovXHJcbnZhciBNQVhfQ0xJRU5UX0FHRV9NUyA9IDMwICogNjAgKiAxMDAwOyAvLyAzMCBtaW51dGVzXHJcbi8qKlxyXG4gKiBPbGRlc3QgYWNjZXB0YWJsZSBtZXRhZGF0YSBhZ2UgZm9yIGNsaWVudHMgdGhhdCBtYXkgcGFydGljaXBhdGUgaW4gdGhlXHJcbiAqIHByaW1hcnkgbGVhc2UgZWxlY3Rpb24uIENsaWVudHMgdGhhdCBoYXZlIG5vdCB1cGRhdGVkIHRoZWlyIGNsaWVudCBtZXRhZGF0YVxyXG4gKiB3aXRoaW4gNSBzZWNvbmRzIGFyZSBub3QgZWxpZ2libGUgdG8gcmVjZWl2ZSBhIHByaW1hcnkgbGVhc2UuXHJcbiAqL1xyXG52YXIgTUFYX1BSSU1BUllfRUxJR0lCTEVfQUdFX01TID0gNTAwMDtcclxuLyoqXHJcbiAqIFRoZSBpbnRlcnZhbCBhdCB3aGljaCBjbGllbnRzIHdpbGwgdXBkYXRlIHRoZWlyIG1ldGFkYXRhLCBpbmNsdWRpbmdcclxuICogcmVmcmVzaGluZyB0aGVpciBwcmltYXJ5IGxlYXNlIGlmIGhlbGQgb3IgcG90ZW50aWFsbHkgdHJ5aW5nIHRvIGFjcXVpcmUgaXQgaWZcclxuICogbm90IGhlbGQuXHJcbiAqXHJcbiAqIFByaW1hcnkgY2xpZW50cyBtYXkgb3Bwb3J0dW5pc3RpY2FsbHkgcmVmcmVzaCB0aGVpciBtZXRhZGF0YSBlYXJsaWVyXHJcbiAqIGlmIHRoZXkncmUgYWxyZWFkeSBwZXJmb3JtaW5nIGFuIEluZGV4ZWREQiBvcGVyYXRpb24uXHJcbiAqL1xyXG52YXIgQ0xJRU5UX01FVEFEQVRBX1JFRlJFU0hfSU5URVJWQUxfTVMgPSA0MDAwO1xyXG4vKiogVXNlci1mYWNpbmcgZXJyb3Igd2hlbiB0aGUgcHJpbWFyeSBsZWFzZSBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZS4gKi9cclxudmFyIFBSSU1BUllfTEVBU0VfTE9TVF9FUlJPUl9NU0cgPSAnVGhlIGN1cnJlbnQgdGFiIGlzIG5vdCBpbiB0aGUgcmVxdWlyZWQgc3RhdGUgdG8gcGVyZm9ybSB0aGlzIG9wZXJhdGlvbi4gJyArXHJcbiAgICAnSXQgbWlnaHQgYmUgbmVjZXNzYXJ5IHRvIHJlZnJlc2ggdGhlIGJyb3dzZXIgdGFiLic7XHJcbnZhciBQUklNQVJZX0xFQVNFX0VYQ0xVU0lWRV9FUlJPUl9NU0cgPSAnQW5vdGhlciB0YWIgaGFzIGV4Y2x1c2l2ZSBhY2Nlc3MgdG8gdGhlIHBlcnNpc3RlbmNlIGxheWVyLiAnICtcclxuICAgICdUbyBhbGxvdyBzaGFyZWQgYWNjZXNzLCBtYWtlIHN1cmUgdG8gaW52b2tlICcgK1xyXG4gICAgJ2BlbmFibGVQZXJzaXN0ZW5jZSgpYCB3aXRoIGBleHBlcmltZW50YWxUYWJTeW5jaHJvbml6YXRpb246dHJ1ZWAgaW4gYWxsIHRhYnMuJztcclxudmFyIFVOU1VQUE9SVEVEX1BMQVRGT1JNX0VSUk9SX01TRyA9ICdUaGlzIHBsYXRmb3JtIGlzIGVpdGhlciBtaXNzaW5nJyArXHJcbiAgICAnIEluZGV4ZWREQiBvciBpcyBrbm93biB0byBoYXZlIGFuIGluY29tcGxldGUgaW1wbGVtZW50YXRpb24uIE9mZmxpbmUnICtcclxuICAgICcgcGVyc2lzdGVuY2UgaGFzIGJlZW4gZGlzYWJsZWQuJztcclxuLy8gVGhlIGZvcm1hdCBvZiB0aGUgTG9jYWxTdG9yYWdlIGtleSB0aGF0IHN0b3JlcyB6b21iaWVkIGNsaWVudCBpczpcclxuLy8gICAgIGZpcmVzdG9yZV96b21iaWVfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGluc3RhbmNlX2tleT5cclxudmFyIFpPTUJJRURfQ0xJRU5UU19LRVlfUFJFRklYID0gJ2ZpcmVzdG9yZV96b21iaWUnO1xyXG52YXIgSW5kZXhlZERiVHJhbnNhY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhJbmRleGVkRGJUcmFuc2FjdGlvbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEluZGV4ZWREYlRyYW5zYWN0aW9uKHNpbXBsZURiVHJhbnNhY3Rpb24sIGN1cnJlbnRTZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuc2ltcGxlRGJUcmFuc2FjdGlvbiA9IHNpbXBsZURiVHJhbnNhY3Rpb247XHJcbiAgICAgICAgX3RoaXMuY3VycmVudFNlcXVlbmNlTnVtYmVyID0gY3VycmVudFNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIHJldHVybiBJbmRleGVkRGJUcmFuc2FjdGlvbjtcclxufShQZXJzaXN0ZW5jZVRyYW5zYWN0aW9uKSk7XHJcbnZhciBJbmRleGVkRGJQZXJzaXN0ZW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8vIE5vdGUgdGhhdCBgbXVsdGlDbGllbnRQYXJhbXNgIG11c3QgYmUgcHJlc2VudCB0byBlbmFibGUgbXVsdGktY2xpZW50IHN1cHBvcnQgd2hpbGUgbXVsdGktdGFiXHJcbiAgICAvLyBpcyBzdGlsbCBleHBlcmltZW50YWwuIFdoZW4gbXVsdGktY2xpZW50IGlzIHN3aXRjaGVkIHRvIGFsd2F5cyBvbiwgYG11bHRpQ2xpZW50UGFyYW1zYCB3aWxsXHJcbiAgICAvLyBubyBsb25nZXIgYmUgb3B0aW9uYWwuXHJcbiAgICBmdW5jdGlvbiBJbmRleGVkRGJQZXJzaXN0ZW5jZShwZXJzaXN0ZW5jZUtleSwgY2xpZW50SWQsIHBsYXRmb3JtLCBxdWV1ZSwgc2VyaWFsaXplciwgbXVsdGlDbGllbnRQYXJhbXMpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlS2V5ID0gcGVyc2lzdGVuY2VLZXk7XHJcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xyXG4gICAgICAgIHRoaXMucXVldWUgPSBxdWV1ZTtcclxuICAgICAgICB0aGlzLm11bHRpQ2xpZW50UGFyYW1zID0gbXVsdGlDbGllbnRQYXJhbXM7XHJcbiAgICAgICAgdGhpcy5fc3RhcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNQcmltYXJ5ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5uZXR3b3JrRW5hYmxlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5pbkZvcmVncm91bmQgPSBmYWxzZTtcclxuICAgICAgICAvKiogVGhlIGxhc3QgdGltZSB3ZSBnYXJiYWdlIGNvbGxlY3RlZCB0aGUgUmVtb3RlIERvY3VtZW50IENoYW5nZWxvZy4gKi9cclxuICAgICAgICB0aGlzLmxhc3RHYXJiYWdlQ29sbGVjdGlvblRpbWUgPSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFk7XHJcbiAgICAgICAgLyoqIEEgbGlzdGVuZXIgdG8gbm90aWZ5IG9uIHByaW1hcnkgc3RhdGUgY2hhbmdlcy4gKi9cclxuICAgICAgICB0aGlzLnByaW1hcnlTdGF0ZUxpc3RlbmVyID0gZnVuY3Rpb24gKF8pIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOyB9O1xyXG4gICAgICAgIGlmICghSW5kZXhlZERiUGVyc2lzdGVuY2UuaXNBdmFpbGFibGUoKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTklNUExFTUVOVEVELCBVTlNVUFBPUlRFRF9QTEFURk9STV9FUlJPUl9NU0cpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gbmV3IEluZGV4ZWREYkxydURlbGVnYXRlKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuZGJOYW1lID0gcGVyc2lzdGVuY2VLZXkgKyBJbmRleGVkRGJQZXJzaXN0ZW5jZS5NQUlOX0RBVEFCQVNFO1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IG5ldyBMb2NhbFNlcmlhbGl6ZXIoc2VyaWFsaXplcik7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudCA9IHBsYXRmb3JtLmRvY3VtZW50O1xyXG4gICAgICAgIHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24gPSBtdWx0aUNsaWVudFBhcmFtcyAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMucXVlcnlDYWNoZSA9IG5ldyBJbmRleGVkRGJRdWVyeUNhY2hlKHRoaXMucmVmZXJlbmNlRGVsZWdhdGUsIHRoaXMuc2VyaWFsaXplcik7XHJcbiAgICAgICAgdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlID0gbmV3IEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUodGhpcy5zZXJpYWxpemVyLCBcclxuICAgICAgICAvKmtlZXBEb2N1bWVudENoYW5nZUxvZz0qLyB0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uKTtcclxuICAgICAgICBpZiAocGxhdGZvcm0ud2luZG93ICYmIHBsYXRmb3JtLndpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3cgPSBwbGF0Zm9ybS53aW5kb3c7XHJcbiAgICAgICAgICAgIHRoaXMud2ViU3RvcmFnZSA9IHRoaXMud2luZG93LmxvY2FsU3RvcmFnZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOSU1QTEVNRU5URUQsICdJbmRleGVkREIgcGVyc2lzdGVuY2UgaXMgb25seSBhdmFpbGFibGUgb24gcGxhdGZvcm1zIHRoYXQgc3VwcG9ydCBMb2NhbFN0b3JhZ2UuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUgPSBmdW5jdGlvbiAodHhuLCBzdG9yZSkge1xyXG4gICAgICAgIGlmICh0eG4gaW5zdGFuY2VvZiBJbmRleGVkRGJUcmFuc2FjdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gU2ltcGxlRGIuZ2V0U3RvcmUodHhuLnNpbXBsZURiVHJhbnNhY3Rpb24sIHN0b3JlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGZhaWwoJ0luZGV4ZWREYlBlcnNpc3RlbmNlIG11c3QgdXNlIGluc3RhbmNlcyBvZiBJbmRleGVkRGJUcmFuc2FjdGlvbicpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5jcmVhdGVJbmRleGVkRGJQZXJzaXN0ZW5jZSA9IGZ1bmN0aW9uIChwZXJzaXN0ZW5jZUtleSwgY2xpZW50SWQsIHBsYXRmb3JtLCBxdWV1ZSwgc2VyaWFsaXplcikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcGVyc2lzdGVuY2U7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdGVuY2UgPSBuZXcgSW5kZXhlZERiUGVyc2lzdGVuY2UocGVyc2lzdGVuY2VLZXksIGNsaWVudElkLCBwbGF0Zm9ybSwgcXVldWUsIHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBwZXJzaXN0ZW5jZS5zdGFydCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHBlcnNpc3RlbmNlXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UuY3JlYXRlTXVsdGlDbGllbnRJbmRleGVkRGJQZXJzaXN0ZW5jZSA9IGZ1bmN0aW9uIChwZXJzaXN0ZW5jZUtleSwgY2xpZW50SWQsIHBsYXRmb3JtLCBxdWV1ZSwgc2VyaWFsaXplciwgbXVsdGlDbGllbnRQYXJhbXMpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBlcnNpc3RlbmNlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3RlbmNlID0gbmV3IEluZGV4ZWREYlBlcnNpc3RlbmNlKHBlcnNpc3RlbmNlS2V5LCBjbGllbnRJZCwgcGxhdGZvcm0sIHF1ZXVlLCBzZXJpYWxpemVyLCBtdWx0aUNsaWVudFBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBlcnNpc3RlbmNlLnN0YXJ0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcGVyc2lzdGVuY2VdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEF0dGVtcHQgdG8gc3RhcnQgSW5kZXhlZERiIHBlcnNpc3RlbmNlLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8dm9pZD59IFdoZXRoZXIgcGVyc2lzdGVuY2Ugd2FzIGVuYWJsZWQuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5zdGFydGVkLCAnSW5kZXhlZERiUGVyc2lzdGVuY2UgZG91YmxlLXN0YXJ0ZWQhJyk7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMud2luZG93ICE9PSBudWxsLCBcIkV4cGVjdGVkICd3aW5kb3cnIHRvIGJlIGRlZmluZWRcIik7XHJcbiAgICAgICAgcmV0dXJuIFNpbXBsZURiLm9wZW5PckNyZWF0ZSh0aGlzLmRiTmFtZSwgU0NIRU1BX1ZFUlNJT04sIG5ldyBTY2hlbWFDb252ZXJ0ZXIodGhpcy5zZXJpYWxpemVyKSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRiKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnNpbXBsZURiID0gZGI7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc3RhcnRSZW1vdGVEb2N1bWVudENhY2hlKCk7IH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMuYXR0YWNoVmlzaWJpbGl0eUhhbmRsZXIoKTtcclxuICAgICAgICAgICAgX3RoaXMuYXR0YWNoV2luZG93VW5sb2FkSG9vaygpO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlQ2xpZW50TWV0YWRhdGFBbmRUcnlCZWNvbWVQcmltYXJ5KCkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc2NoZWR1bGVDbGllbnRNZXRhZGF0YUFuZFByaW1hcnlMZWFzZVJlZnJlc2hlcygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zaW1wbGVEYi5ydW5UcmFuc2FjdGlvbigncmVhZG9ubHknLCBbRGJUYXJnZXRHbG9iYWwuc3RvcmVdLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyKHR4bikubmV4dChmdW5jdGlvbiAoaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlcXVlbmNlTnVtYmVyU3luY2VyID0gX3RoaXMubXVsdGlDbGllbnRQYXJhbXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBfdGhpcy5tdWx0aUNsaWVudFBhcmFtcy5zZXF1ZW5jZU51bWJlclN5bmNlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5saXN0ZW5TZXF1ZW5jZSA9IG5ldyBMaXN0ZW5TZXF1ZW5jZShoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIsIHNlcXVlbmNlTnVtYmVyU3luY2VyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgICAgICBfdGhpcy5zaW1wbGVEYiAmJiBfdGhpcy5zaW1wbGVEYi5jbG9zZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuc3RhcnRSZW1vdGVEb2N1bWVudENhY2hlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2ltcGxlRGIucnVuVHJhbnNhY3Rpb24oJ3JlYWRvbmx5JywgQUxMX1NUT1JFUywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5zdGFydCh0eG4pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5zZXRQcmltYXJ5U3RhdGVMaXN0ZW5lciA9IGZ1bmN0aW9uIChwcmltYXJ5U3RhdGVMaXN0ZW5lcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5wcmltYXJ5U3RhdGVMaXN0ZW5lciA9IGZ1bmN0aW9uIChwcmltYXJ5U3RhdGUpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcHJpbWFyeVN0YXRlTGlzdGVuZXIocHJpbWFyeVN0YXRlKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyB9O1xyXG4gICAgICAgIHJldHVybiBwcmltYXJ5U3RhdGVMaXN0ZW5lcih0aGlzLmlzUHJpbWFyeSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnNldE5ldHdvcmtFbmFibGVkID0gZnVuY3Rpb24gKG5ldHdvcmtFbmFibGVkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrRW5hYmxlZCAhPT0gbmV0d29ya0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrRW5hYmxlZCA9IG5ldHdvcmtFbmFibGVkO1xyXG4gICAgICAgICAgICAvLyBTY2hlZHVsZSBhIHByaW1hcnkgbGVhc2UgcmVmcmVzaCBmb3IgaW1tZWRpYXRlIGV4ZWN1dGlvbi4gVGhlIGV2ZW50dWFsXHJcbiAgICAgICAgICAgIC8vIGxlYXNlIHVwZGF0ZSB3aWxsIGJlIHByb3BhZ2F0ZWQgdmlhIGBwcmltYXJ5U3RhdGVMaXN0ZW5lcmAuXHJcbiAgICAgICAgICAgIHRoaXMucXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy51cGRhdGVDbGllbnRNZXRhZGF0YUFuZFRyeUJlY29tZVByaW1hcnkoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pOyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSBjbGllbnQgbWV0YWRhdGEgaW4gSW5kZXhlZERiIGFuZCBhdHRlbXB0cyB0byBlaXRoZXIgb2J0YWluIG9yXHJcbiAgICAgKiBleHRlbmQgdGhlIHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIEFzeW5jaHJvbm91c2x5IG5vdGlmaWVzIHRoZVxyXG4gICAgICogcHJpbWFyeSBzdGF0ZSBsaXN0ZW5lciBpZiB0aGUgY2xpZW50IGVpdGhlciBuZXdseSBvYnRhaW5lZCBvciByZWxlYXNlZCBpdHNcclxuICAgICAqIHByaW1hcnkgbGVhc2UuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS51cGRhdGVDbGllbnRNZXRhZGF0YUFuZFRyeUJlY29tZVByaW1hcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5zaW1wbGVEYi5ydW5UcmFuc2FjdGlvbigncmVhZHdyaXRlJywgQUxMX1NUT1JFUywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICB2YXIgbWV0YWRhdGFTdG9yZSA9IGNsaWVudE1ldGFkYXRhU3RvcmUodHhuKTtcclxuICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhU3RvcmVcclxuICAgICAgICAgICAgICAgIC5wdXQobmV3IERiQ2xpZW50TWV0YWRhdGEoX3RoaXMuY2xpZW50SWQsIERhdGUubm93KCksIF90aGlzLm5ldHdvcmtFbmFibGVkLCBfdGhpcy5pbkZvcmVncm91bmQsIF90aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUubGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQpKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy52ZXJpZnlQcmltYXJ5TGVhc2UodHhuKS5uZXh0KGZ1bmN0aW9uIChzdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNQcmltYXJ5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5xdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucHJpbWFyeVN0YXRlTGlzdGVuZXIoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmNhbkFjdEFzUHJpbWFyeSh0eG4pOyB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGNhbkFjdEFzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHdhc1ByaW1hcnkgPSBfdGhpcy5pc1ByaW1hcnk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5pc1ByaW1hcnkgPSBjYW5BY3RBc1ByaW1hcnk7XHJcbiAgICAgICAgICAgICAgICBpZiAod2FzUHJpbWFyeSAhPT0gX3RoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wcmltYXJ5U3RhdGVMaXN0ZW5lcihfdGhpcy5pc1ByaW1hcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHdhc1ByaW1hcnkgJiYgIV90aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZWxlYXNlUHJpbWFyeUxlYXNlSWZIZWxkKHR4bik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChfdGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuYWNxdWlyZU9yRXh0ZW5kUHJpbWFyeUxlYXNlKHR4bik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS52ZXJpZnlQcmltYXJ5TGVhc2UgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgc3RvcmUgPSBwcmltYXJ5Q2xpZW50U3RvcmUodHhuKTtcclxuICAgICAgICByZXR1cm4gc3RvcmUuZ2V0KERiUHJpbWFyeUNsaWVudC5rZXkpLm5leHQoZnVuY3Rpb24gKHByaW1hcnlDbGllbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKF90aGlzLmlzTG9jYWxDbGllbnQocHJpbWFyeUNsaWVudCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5yZW1vdmVDbGllbnRNZXRhZGF0YSA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgbWV0YWRhdGFTdG9yZSA9IGNsaWVudE1ldGFkYXRhU3RvcmUodHhuKTtcclxuICAgICAgICByZXR1cm4gbWV0YWRhdGFTdG9yZS5kZWxldGUodGhpcy5jbGllbnRJZCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJZiB0aGUgZ2FyYmFnZSBjb2xsZWN0aW9uIHRocmVzaG9sZCBoYXMgcGFzc2VkLCBwcnVuZXMgdGhlXHJcbiAgICAgKiBSZW1vdGVEb2N1bWVudENoYW5nZXMgYW5kIHRoZSBDbGllbnRNZXRhZGF0YSBzdG9yZSBiYXNlZCBvbiB0aGUgbGFzdCB1cGRhdGVcclxuICAgICAqIHRpbWUgb2YgYWxsIGNsaWVudHMuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5tYXliZUdhcmJhZ2VDb2xsZWN0TXVsdGlDbGllbnRTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGFjdGl2ZUNsaWVudHNfMSwgaW5hY3RpdmVDbGllbnRzXzE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5pc1ByaW1hcnkgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLmlzV2l0aGluQWdlKHRoaXMubGFzdEdhcmJhZ2VDb2xsZWN0aW9uVGltZSwgTUFYX0NMSUVOVF9BR0VfTVMpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdEdhcmJhZ2VDb2xsZWN0aW9uVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYWN0aXZlQ2xpZW50c18xID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucnVuVHJhbnNhY3Rpb24oJ21heWJlR2FyYmFnZUNvbGxlY3RNdWx0aUNsaWVudFN0YXRlJywgJ3JlYWR3cml0ZS1wcmltYXJ5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXRhZGF0YVN0b3JlID0gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYkNsaWVudE1ldGFkYXRhLnN0b3JlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWV0YWRhdGFTdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubG9hZEFsbCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChleGlzdGluZ0NsaWVudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlQ2xpZW50c18xID0gX3RoaXMuZmlsdGVyQWN0aXZlQ2xpZW50cyhleGlzdGluZ0NsaWVudHMsIE1BWF9DTElFTlRfQUdFX01TKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5hY3RpdmVDbGllbnRzXzEgPSBleGlzdGluZ0NsaWVudHMuZmlsdGVyKGZ1bmN0aW9uIChjbGllbnQpIHsgcmV0dXJuIGFjdGl2ZUNsaWVudHNfMS5pbmRleE9mKGNsaWVudCkgPT09IC0xOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBtZXRhZGF0YSBmb3IgY2xpZW50cyB0aGF0IGFyZSBubyBsb25nZXIgY29uc2lkZXJlZCBhY3RpdmUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaChpbmFjdGl2ZUNsaWVudHNfMSwgZnVuY3Rpb24gKGluYWN0aXZlQ2xpZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWV0YWRhdGFTdG9yZS5kZWxldGUoaW5hY3RpdmVDbGllbnQuY2xpZW50SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJldHJpZXZlIHRoZSBtaW5pbXVtIGNoYW5nZSBJRCBmcm9tIHRoZSBzZXQgb2YgYWN0aXZlIGNsaWVudHMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBwcmltYXJ5IGNsaWVudCBkb2Vzbid0IHJlYWQgZnJvbSB0aGUgZG9jdW1lbnQgY2hhbmdlIGxvZyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIGhlbmNlIHdlIGV4Y2x1ZGUgaXQgd2hlbiB3ZSBkZXRlcm1pbmUgdGhlIG1pbmltdW1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYGxhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkYC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlQ2xpZW50c18xID0gYWN0aXZlQ2xpZW50c18xLmZpbHRlcihmdW5jdGlvbiAoY2xpZW50KSB7IHJldHVybiBjbGllbnQuY2xpZW50SWQgIT09IF90aGlzLmNsaWVudElkOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2ZUNsaWVudHNfMS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc2VkQ2hhbmdlSWRzID0gYWN0aXZlQ2xpZW50c18xLm1hcChmdW5jdGlvbiAoY2xpZW50KSB7IHJldHVybiBjbGllbnQubGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQgfHwgMDsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2xkZXN0Q2hhbmdlSWQgPSBNYXRoLm1pbi5hcHBseShNYXRoLCBwcm9jZXNzZWRDaGFuZ2VJZHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUucmVtb3ZlRG9jdW1lbnRDaGFuZ2VzVGhyb3VnaENoYW5nZUlkKHR4biwgb2xkZXN0Q2hhbmdlSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBwb3RlbnRpYWwgbGVmdG92ZXIgZW50cmllcyB0aGF0IG1heSBjb250aW51ZSB0byBtYXJrIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpbmFjdGl2ZSBjbGllbnRzIGFzIHpvbWJpZWQgaW4gTG9jYWxTdG9yYWdlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZGVhbGx5IHdlJ2QgZGVsZXRlIHRoZSBJbmRleGVkRGIgYW5kIExvY2FsU3RvcmFnZSB6b21iaWUgZW50cmllcyBmb3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNsaWVudCBhdG9taWNhbGx5LCBidXQgd2UgY2FuJ3QuIFNvIHdlIG9wdCB0byBkZWxldGUgdGhlIEluZGV4ZWREYlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbnRyaWVzIGZpcnN0IHRvIGF2b2lkIHBvdGVudGlhbGx5IHJldml2aW5nIGEgem9tYmllZCBjbGllbnQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYWN0aXZlQ2xpZW50c18xLmZvckVhY2goZnVuY3Rpb24gKGluYWN0aXZlQ2xpZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy53aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oX3RoaXMuem9tYmllZENsaWVudExvY2FsU3RvcmFnZUtleShpbmFjdGl2ZUNsaWVudC5jbGllbnRJZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFNjaGVkdWxlcyBhIHJlY3VycmluZyB0aW1lciB0byB1cGRhdGUgdGhlIGNsaWVudCBtZXRhZGF0YSBhbmQgdG8gZWl0aGVyXHJcbiAgICAgKiBleHRlbmQgb3IgYWNxdWlyZSB0aGUgcHJpbWFyeSBsZWFzZSBpZiB0aGUgY2xpZW50IGlzIGVsaWdpYmxlLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuc2NoZWR1bGVDbGllbnRNZXRhZGF0YUFuZFByaW1hcnlMZWFzZVJlZnJlc2hlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuY2xpZW50TWV0YWRhdGFSZWZyZXNoZXIgPSB0aGlzLnF1ZXVlLmVucXVldWVBZnRlckRlbGF5KFRpbWVySWQuQ2xpZW50TWV0YWRhdGFSZWZyZXNoLCBDTElFTlRfTUVUQURBVEFfUkVGUkVTSF9JTlRFUlZBTF9NUywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlQ2xpZW50TWV0YWRhdGFBbmRUcnlCZWNvbWVQcmltYXJ5KClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLm1heWJlR2FyYmFnZUNvbGxlY3RNdWx0aUNsaWVudFN0YXRlKCk7IH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zY2hlZHVsZUNsaWVudE1ldGFkYXRhQW5kUHJpbWFyeUxlYXNlUmVmcmVzaGVzKCk7IH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBDaGVja3Mgd2hldGhlciBgY2xpZW50YCBpcyB0aGUgbG9jYWwgY2xpZW50LiAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmlzTG9jYWxDbGllbnQgPSBmdW5jdGlvbiAoY2xpZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIGNsaWVudCA/IGNsaWVudC5vd25lcklkID09PSB0aGlzLmNsaWVudElkIDogZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBFdmFsdWF0ZSB0aGUgc3RhdGUgb2YgYWxsIGFjdGl2ZSBjbGllbnRzIGFuZCBkZXRlcm1pbmUgd2hldGhlciB0aGUgbG9jYWxcclxuICAgICAqIGNsaWVudCBpcyBvciBjYW4gYWN0IGFzIHRoZSBob2xkZXIgb2YgdGhlIHByaW1hcnkgbGVhc2UuIFJldHVybnMgd2hldGhlclxyXG4gICAgICogdGhlIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhlIGxlYXNlLCBidXQgZG9lcyBub3QgYWN0dWFsbHkgYWNxdWlyZSBpdC5cclxuICAgICAqIE1heSByZXR1cm4gJ2ZhbHNlJyBldmVuIGlmIHRoZXJlIGlzIG5vIGFjdGl2ZSBsZWFzZWhvbGRlciBhbmQgYW5vdGhlclxyXG4gICAgICogKGZvcmVncm91bmQpIGNsaWVudCBzaG91bGQgYmVjb21lIGxlYXNlaG9sZGVyIGluc3RlYWQuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5jYW5BY3RBc1ByaW1hcnkgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgc3RvcmUgPSBwcmltYXJ5Q2xpZW50U3RvcmUodHhuKTtcclxuICAgICAgICByZXR1cm4gc3RvcmVcclxuICAgICAgICAgICAgLmdldChEYlByaW1hcnlDbGllbnQua2V5KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoY3VycmVudFByaW1hcnkpIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnRMZWFzZUlzVmFsaWQgPSBjdXJyZW50UHJpbWFyeSAhPT0gbnVsbCAmJlxyXG4gICAgICAgICAgICAgICAgX3RoaXMuaXNXaXRoaW5BZ2UoY3VycmVudFByaW1hcnkubGVhc2VUaW1lc3RhbXBNcywgTUFYX1BSSU1BUllfRUxJR0lCTEVfQUdFX01TKSAmJlxyXG4gICAgICAgICAgICAgICAgIV90aGlzLmlzQ2xpZW50Wm9tYmllZChjdXJyZW50UHJpbWFyeS5vd25lcklkKTtcclxuICAgICAgICAgICAgLy8gQSBjbGllbnQgaXMgZWxpZ2libGUgZm9yIHRoZSBwcmltYXJ5IGxlYXNlIGlmOlxyXG4gICAgICAgICAgICAvLyAtIGl0cyBuZXR3b3JrIGlzIGVuYWJsZWQgYW5kIHRoZSBjbGllbnQncyB0YWIgaXMgaW4gdGhlIGZvcmVncm91bmQuXHJcbiAgICAgICAgICAgIC8vIC0gaXRzIG5ldHdvcmsgaXMgZW5hYmxlZCBhbmQgbm8gb3RoZXIgY2xpZW50J3MgdGFiIGlzIGluIHRoZVxyXG4gICAgICAgICAgICAvLyAgIGZvcmVncm91bmQuXHJcbiAgICAgICAgICAgIC8vIC0gZXZlcnkgY2xpZW50cyBuZXR3b3JrIGlzIGRpc2FibGVkIGFuZCB0aGUgY2xpZW50J3MgdGFiIGlzIGluIHRoZVxyXG4gICAgICAgICAgICAvLyAgIGZvcmVncm91bmQuXHJcbiAgICAgICAgICAgIC8vIC0gZXZlcnkgY2xpZW50cyBuZXR3b3JrIGlzIGRpc2FibGVkIGFuZCBubyBvdGhlciBjbGllbnQncyB0YWIgaXMgaW5cclxuICAgICAgICAgICAgLy8gICB0aGUgZm9yZWdyb3VuZC5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRMZWFzZUlzVmFsaWQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc0xvY2FsQ2xpZW50KGN1cnJlbnRQcmltYXJ5KSAmJiBfdGhpcy5uZXR3b3JrRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5pc0xvY2FsQ2xpZW50KGN1cnJlbnRQcmltYXJ5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY3VycmVudFByaW1hcnkuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmFpbCB0aGUgYGNhbkFjdEFzUHJpbWFyeWAgY2hlY2sgaWYgdGhlIGN1cnJlbnQgbGVhc2Vob2xkZXIgaGFzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vdCBvcHRlZCBpbnRvIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uIElmIHRoaXMgaGFwcGVucyBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGllbnQgc3RhcnR1cCwgd2UgcmVqZWN0IHRoZSBQcm9taXNlIHJldHVybmVkIGJ5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGBlbmFibGVQZXJzaXN0ZW5jZSgpYCBhbmQgdGhlIHVzZXIgY2FuIGNvbnRpbnVlIHRvIHVzZSBGaXJlc3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2l0aCBpbi1tZW1vcnkgcGVyc2lzdGVuY2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgZmFpbHMgZHVyaW5nIGEgbGVhc2UgcmVmcmVzaCwgd2Ugd2lsbCBpbnN0ZWFkIGJsb2NrIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBc3luY1F1ZXVlIGZyb20gZXhlY3V0aW5nIGZ1cnRoZXIgb3BlcmF0aW9ucy4gTm90ZSB0aGF0IHRoaXMgaXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWNjZXB0YWJsZSBzaW5jZSBtaXhpbmcgJiBtYXRjaGluZyBkaWZmZXJlbnQgYHN5bmNocm9uaXplVGFic2BcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0dGluZ3MgaXMgbm90IHN1cHBvcnRlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhiLzExNDIyNjIzNCk6IFJlbW92ZSB0aGlzIGNoZWNrIHdoZW4gYHN5bmNocm9uaXplVGFic2AgY2FuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vIGxvbmdlciBiZSB0dXJuZWQgb2ZmLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCBQUklNQVJZX0xFQVNFX0VYQ0xVU0lWRV9FUlJPUl9NU0cpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKF90aGlzLm5ldHdvcmtFbmFibGVkICYmIF90aGlzLmluRm9yZWdyb3VuZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNsaWVudE1ldGFkYXRhU3RvcmUodHhuKVxyXG4gICAgICAgICAgICAgICAgLmxvYWRBbGwoKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGV4aXN0aW5nQ2xpZW50cykge1xyXG4gICAgICAgICAgICAgICAgLy8gUHJvY2VzcyBhbGwgZXhpc3RpbmcgY2xpZW50cyBhbmQgZGV0ZXJtaW5lIHdoZXRoZXIgYXQgbGVhc3Qgb25lIG9mXHJcbiAgICAgICAgICAgICAgICAvLyB0aGVtIGlzIGJldHRlciBzdWl0ZWQgdG8gb2J0YWluIHRoZSBwcmltYXJ5IGxlYXNlLlxyXG4gICAgICAgICAgICAgICAgdmFyIHByZWZlcnJlZENhbmRpZGF0ZSA9IF90aGlzLmZpbHRlckFjdGl2ZUNsaWVudHMoZXhpc3RpbmdDbGllbnRzLCBNQVhfUFJJTUFSWV9FTElHSUJMRV9BR0VfTVMpLmZpbmQoZnVuY3Rpb24gKG90aGVyQ2xpZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmNsaWVudElkICE9PSBvdGhlckNsaWVudC5jbGllbnRJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXJDbGllbnRIYXNCZXR0ZXJOZXR3b3JrU3RhdGUgPSAhX3RoaXMubmV0d29ya0VuYWJsZWQgJiYgb3RoZXJDbGllbnQubmV0d29ya0VuYWJsZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdGhlckNsaWVudEhhc0JldHRlclZpc2liaWxpdHkgPSAhX3RoaXMuaW5Gb3JlZ3JvdW5kICYmIG90aGVyQ2xpZW50LmluRm9yZWdyb3VuZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG90aGVyQ2xpZW50SGFzU2FtZU5ldHdvcmtTdGF0ZSA9IF90aGlzLm5ldHdvcmtFbmFibGVkID09PSBvdGhlckNsaWVudC5uZXR3b3JrRW5hYmxlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG90aGVyQ2xpZW50SGFzQmV0dGVyTmV0d29ya1N0YXRlIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3RoZXJDbGllbnRIYXNCZXR0ZXJWaXNpYmlsaXR5ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3RoZXJDbGllbnRIYXNTYW1lTmV0d29ya1N0YXRlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJlZmVycmVkQ2FuZGlkYXRlID09PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChjYW5BY3RBc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgaWYgKF90aGlzLmlzUHJpbWFyeSAhPT0gY2FuQWN0QXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDIsIFwiQ2xpZW50IFwiICsgKGNhbkFjdEFzUHJpbWFyeSA/ICdpcycgOiAnaXMgbm90JykgKyBcIiBlbGlnaWJsZSBmb3IgYSBwcmltYXJ5IGxlYXNlLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY2FuQWN0QXNQcmltYXJ5O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5zaHV0ZG93biA9IGZ1bmN0aW9uIChkZWxldGVEYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHNodXRkb3duKCkgb3BlcmF0aW9ucyBhcmUgaWRlbXBvdGVudCBhbmQgY2FuIGJlIGNhbGxlZCBldmVuIHdoZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RhcnQoKSBhYm9ydGVkIChlLmcuIGJlY2F1c2UgaXQgY291bGRuJ3QgYWNxdWlyZSB0aGUgcGVyc2lzdGVuY2UgbGVhc2UpLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFydGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFya0NsaWVudFpvbWJpZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2xpZW50TWV0YWRhdGFSZWZyZXNoZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xpZW50TWV0YWRhdGFSZWZyZXNoZXIuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhY2hWaXNpYmlsaXR5SGFuZGxlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRldGFjaFdpbmRvd1VubG9hZEhvb2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zaW1wbGVEYi5ydW5UcmFuc2FjdGlvbigncmVhZHdyaXRlJywgW0RiUHJpbWFyeUNsaWVudC5zdG9yZSwgRGJDbGllbnRNZXRhZGF0YS5zdG9yZV0sIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVsZWFzZVByaW1hcnlMZWFzZUlmSGVsZCh0eG4pLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVtb3ZlQ2xpZW50TWV0YWRhdGEodHhuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaW1wbGVEYi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGVudHJ5IG1hcmtpbmcgdGhlIGNsaWVudCBhcyB6b21iaWVkIGZyb20gTG9jYWxTdG9yYWdlIHNpbmNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlIHN1Y2Nlc3NmdWxseSBkZWxldGVkIGl0cyBtZXRhZGF0YSBmcm9tIEluZGV4ZWREYi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDbGllbnRab21iaWVkRW50cnkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkZWxldGVEYXRhKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgU2ltcGxlRGIuZGVsZXRlKHRoaXMuZGJOYW1lKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGNsaWVudHMgdGhhdCBhcmUgbm90IHpvbWJpZWQgYW5kIGhhdmUgYW4gdXBkYXRlVGltZSB3aXRoaW4gdGhlXHJcbiAgICAgKiBwcm92aWRlZCB0aHJlc2hvbGQuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5maWx0ZXJBY3RpdmVDbGllbnRzID0gZnVuY3Rpb24gKGNsaWVudHMsIGFjdGl2aXR5VGhyZXNob2xkTXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBjbGllbnRzLmZpbHRlcihmdW5jdGlvbiAoY2xpZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5pc1dpdGhpbkFnZShjbGllbnQudXBkYXRlVGltZU1zLCBhY3Rpdml0eVRocmVzaG9sZE1zKSAmJlxyXG4gICAgICAgICAgICAgICAgIV90aGlzLmlzQ2xpZW50Wm9tYmllZChjbGllbnQuY2xpZW50SWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRBY3RpdmVDbGllbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2ltcGxlRGIucnVuVHJhbnNhY3Rpb24oJ3JlYWRvbmx5JywgW0RiQ2xpZW50TWV0YWRhdGEuc3RvcmVdLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjbGllbnRNZXRhZGF0YVN0b3JlKHR4bilcclxuICAgICAgICAgICAgICAgIC5sb2FkQWxsKClcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChjbGllbnRzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZmlsdGVyQWN0aXZlQ2xpZW50cyhjbGllbnRzLCBNQVhfQ0xJRU5UX0FHRV9NUykubWFwKGZ1bmN0aW9uIChjbGllbnRNZXRhZGF0YSkgeyByZXR1cm4gY2xpZW50TWV0YWRhdGEuY2xpZW50SWQ7IH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLCBcInN0YXJ0ZWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhcnRlZDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRNdXRhdGlvblF1ZXVlID0gZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5zdGFydGVkLCAnQ2Fubm90IGluaXRpYWxpemUgTXV0YXRpb25RdWV1ZSBiZWZvcmUgcGVyc2lzdGVuY2UgaXMgc3RhcnRlZC4nKTtcclxuICAgICAgICByZXR1cm4gSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5mb3JVc2VyKHVzZXIsIHRoaXMuc2VyaWFsaXplciwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmdldFF1ZXJ5Q2FjaGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc3RhcnRlZCwgJ0Nhbm5vdCBpbml0aWFsaXplIFF1ZXJ5Q2FjaGUgYmVmb3JlIHBlcnNpc3RlbmNlIGlzIHN0YXJ0ZWQuJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcnlDYWNoZTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5zdGFydGVkLCAnQ2Fubm90IGluaXRpYWxpemUgUmVtb3RlRG9jdW1lbnRDYWNoZSBiZWZvcmUgcGVyc2lzdGVuY2UgaXMgc3RhcnRlZC4nKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5ydW5UcmFuc2FjdGlvbiA9IGZ1bmN0aW9uIChhY3Rpb24sIG1vZGUsIHRyYW5zYWN0aW9uT3BlcmF0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDIsICdTdGFydGluZyB0cmFuc2FjdGlvbjonLCBhY3Rpb24pO1xyXG4gICAgICAgIC8vIERvIGFsbCB0cmFuc2FjdGlvbnMgYXMgcmVhZHdyaXRlIGFnYWluc3QgYWxsIG9iamVjdCBzdG9yZXMsIHNpbmNlIHdlXHJcbiAgICAgICAgLy8gYXJlIHRoZSBvbmx5IHJlYWRlci93cml0ZXIuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2ltcGxlRGIucnVuVHJhbnNhY3Rpb24obW9kZSA9PT0gJ3JlYWRvbmx5JyA/ICdyZWFkb25seScgOiAncmVhZHdyaXRlJywgQUxMX1NUT1JFUywgZnVuY3Rpb24gKHNpbXBsZURiVHhuKSB7XHJcbiAgICAgICAgICAgIGlmIChtb2RlID09PSAncmVhZHdyaXRlLXByaW1hcnknKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBXaGlsZSB3ZSBtZXJlbHkgdmVyaWZ5IHRoYXQgd2UgaGF2ZSAob3IgY2FuIGFjcXVpcmUpIHRoZSBsZWFzZVxyXG4gICAgICAgICAgICAgICAgLy8gaW1tZWRpYXRlbHksIHdlIHdhaXQgdG8gZXh0ZW5kIHRoZSBwcmltYXJ5IGxlYXNlIHVudGlsIGFmdGVyXHJcbiAgICAgICAgICAgICAgICAvLyBleGVjdXRpbmcgdHJhbnNhY3Rpb25PcGVyYXRpb24oKS4gVGhpcyBlbnN1cmVzIHRoYXQgZXZlbiBpZiB0aGVcclxuICAgICAgICAgICAgICAgIC8vIHRyYW5zYWN0aW9uT3BlcmF0aW9uIHRha2VzIGEgbG9uZyB0aW1lLCB3ZSdsbCB1c2UgYSByZWNlbnRcclxuICAgICAgICAgICAgICAgIC8vIGxlYXNlVGltZXN0YW1wTXMgaW4gdGhlIGV4dGVuZGVkIChvciBuZXdseSBhY3F1aXJlZCkgbGVhc2UuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudmVyaWZ5UHJpbWFyeUxlYXNlKHNpbXBsZURiVHhuKVxyXG4gICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChzdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKFwiRmFpbGVkIHRvIG9idGFpbiBwcmltYXJ5IGxlYXNlIGZvciBhY3Rpb24gJ1wiICsgYWN0aW9uICsgXCInLlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNQcmltYXJ5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnF1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnByaW1hcnlTdGF0ZUxpc3RlbmVyKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sIFBSSU1BUllfTEVBU0VfTE9TVF9FUlJPUl9NU0cpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25PcGVyYXRpb24obmV3IEluZGV4ZWREYlRyYW5zYWN0aW9uKHNpbXBsZURiVHhuLCBfdGhpcy5saXN0ZW5TZXF1ZW5jZS5uZXh0KCkpKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5hY3F1aXJlT3JFeHRlbmRQcmltYXJ5TGVhc2Uoc2ltcGxlRGJUeG4pLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0OyB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnZlcmlmeUFsbG93VGFiU3luY2hyb25pemF0aW9uKHNpbXBsZURiVHhuKS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25PcGVyYXRpb24obmV3IEluZGV4ZWREYlRyYW5zYWN0aW9uKHNpbXBsZURiVHhuLCBfdGhpcy5saXN0ZW5TZXF1ZW5jZS5uZXh0KCkpKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBWZXJpZmllcyB0aGF0IHRoZSBjdXJyZW50IHRhYiBpcyB0aGUgcHJpbWFyeSBsZWFzZWhvbGRlciBvciBhbHRlcm5hdGl2ZWx5XHJcbiAgICAgKiB0aGF0IHRoZSBsZWFzZWhvbGRlciBoYXMgb3B0ZWQgaW50byBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLlxyXG4gICAgICovXHJcbiAgICAvLyBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIHRoaXMgY2hlY2sgd2hlbiBgc3luY2hyb25pemVUYWJzYCBjYW4gbm8gbG9uZ2VyXHJcbiAgICAvLyBiZSB0dXJuZWQgb2ZmLlxyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnZlcmlmeUFsbG93VGFiU3luY2hyb25pemF0aW9uID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gcHJpbWFyeUNsaWVudFN0b3JlKHR4bik7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlLmdldChEYlByaW1hcnlDbGllbnQua2V5KS5uZXh0KGZ1bmN0aW9uIChjdXJyZW50UHJpbWFyeSkge1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudExlYXNlSXNWYWxpZCA9IGN1cnJlbnRQcmltYXJ5ICE9PSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5pc1dpdGhpbkFnZShjdXJyZW50UHJpbWFyeS5sZWFzZVRpbWVzdGFtcE1zLCBNQVhfUFJJTUFSWV9FTElHSUJMRV9BR0VfTVMpICYmXHJcbiAgICAgICAgICAgICAgICAhX3RoaXMuaXNDbGllbnRab21iaWVkKGN1cnJlbnRQcmltYXJ5Lm93bmVySWQpO1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudExlYXNlSXNWYWxpZCAmJiAhX3RoaXMuaXNMb2NhbENsaWVudChjdXJyZW50UHJpbWFyeSkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudFByaW1hcnkuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCBQUklNQVJZX0xFQVNFX0VYQ0xVU0lWRV9FUlJPUl9NU0cpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBPYnRhaW5zIG9yIGV4dGVuZHMgdGhlIG5ldyBwcmltYXJ5IGxlYXNlIGZvciB0aGUgbG9jYWwgY2xpZW50LiBUaGlzXHJcbiAgICAgKiBtZXRob2QgZG9lcyBub3QgdmVyaWZ5IHRoYXQgdGhlIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhpcyBsZWFzZS5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmFjcXVpcmVPckV4dGVuZFByaW1hcnlMZWFzZSA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgbmV3UHJpbWFyeSA9IG5ldyBEYlByaW1hcnlDbGllbnQodGhpcy5jbGllbnRJZCwgdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbiwgRGF0ZS5ub3coKSk7XHJcbiAgICAgICAgcmV0dXJuIHByaW1hcnlDbGllbnRTdG9yZSh0eG4pLnB1dChEYlByaW1hcnlDbGllbnQua2V5LCBuZXdQcmltYXJ5KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5pc0F2YWlsYWJsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gU2ltcGxlRGIuaXNBdmFpbGFibGUoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlcyBhIHN0cmluZyB1c2VkIGFzIGEgcHJlZml4IHdoZW4gc3RvcmluZyBkYXRhIGluIEluZGV4ZWREQiBhbmRcclxuICAgICAqIExvY2FsU3RvcmFnZS5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UuYnVpbGRTdG9yYWdlUHJlZml4ID0gZnVuY3Rpb24gKGRhdGFiYXNlSW5mbykge1xyXG4gICAgICAgIC8vIFVzZSB0d28gZGlmZmVyZW50IHByZWZpeCBmb3JtYXRzOlxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAqIGZpcmVzdG9yZSAvIHBlcnNpc3RlbmNlS2V5IC8gcHJvamVjdElEIC4gZGF0YWJhc2VJRCAvIC4uLlxyXG4gICAgICAgIC8vICAgKiBmaXJlc3RvcmUgLyBwZXJzaXN0ZW5jZUtleSAvIHByb2plY3RJRCAvIC4uLlxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gcHJvamVjdElEcyBhcmUgRE5TLWNvbXBhdGlibGUgbmFtZXMgYW5kIGNhbm5vdCBjb250YWluIGRvdHNcclxuICAgICAgICAvLyBzbyB0aGVyZSdzIG5vIGRhbmdlciBvZiBjb2xsaXNpb25zLlxyXG4gICAgICAgIHZhciBkYXRhYmFzZSA9IGRhdGFiYXNlSW5mby5kYXRhYmFzZUlkLnByb2plY3RJZDtcclxuICAgICAgICBpZiAoIWRhdGFiYXNlSW5mby5kYXRhYmFzZUlkLmlzRGVmYXVsdERhdGFiYXNlKSB7XHJcbiAgICAgICAgICAgIGRhdGFiYXNlICs9ICcuJyArIGRhdGFiYXNlSW5mby5kYXRhYmFzZUlkLmRhdGFiYXNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJ2ZpcmVzdG9yZS8nICsgZGF0YWJhc2VJbmZvLnBlcnNpc3RlbmNlS2V5ICsgJy8nICsgZGF0YWJhc2UgKyAnLyc7XHJcbiAgICB9O1xyXG4gICAgLyoqIENoZWNrcyB0aGUgcHJpbWFyeSBsZWFzZSBhbmQgcmVtb3ZlcyBpdCBpZiB3ZSBhcmUgdGhlIGN1cnJlbnQgcHJpbWFyeS4gKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5yZWxlYXNlUHJpbWFyeUxlYXNlSWZIZWxkID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gcHJpbWFyeUNsaWVudFN0b3JlKHR4bik7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlLmdldChEYlByaW1hcnlDbGllbnQua2V5KS5uZXh0KGZ1bmN0aW9uIChwcmltYXJ5Q2xpZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5pc0xvY2FsQ2xpZW50KHByaW1hcnlDbGllbnQpKSB7XHJcbiAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDIsICdSZWxlYXNpbmcgcHJpbWFyeSBsZWFzZS4nKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdG9yZS5kZWxldGUoRGJQcmltYXJ5Q2xpZW50LmtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBWZXJpZmllcyB0aGF0IGB1cGRhdGVUaW1lTXNgIGlzIHdpdGhpbiBgbWF4QWdlTXNgLiAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmlzV2l0aGluQWdlID0gZnVuY3Rpb24gKHVwZGF0ZVRpbWVNcywgbWF4QWdlTXMpIHtcclxuICAgICAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICB2YXIgbWluQWNjZXB0YWJsZSA9IG5vdyAtIG1heEFnZU1zO1xyXG4gICAgICAgIHZhciBtYXhBY2NlcHRhYmxlID0gbm93O1xyXG4gICAgICAgIGlmICh1cGRhdGVUaW1lTXMgPCBtaW5BY2NlcHRhYmxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodXBkYXRlVGltZU1zID4gbWF4QWNjZXB0YWJsZSkge1xyXG4gICAgICAgICAgICBlcnJvcihcIkRldGVjdGVkIGFuIHVwZGF0ZSB0aW1lIHRoYXQgaXMgaW4gdGhlIGZ1dHVyZTogXCIgKyB1cGRhdGVUaW1lTXMgKyBcIiA+IFwiICsgbWF4QWNjZXB0YWJsZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmF0dGFjaFZpc2liaWxpdHlIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMuZG9jdW1lbnQgIT09IG51bGwgJiZcclxuICAgICAgICAgICAgdHlwZW9mIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICB0aGlzLmRvY3VtZW50VmlzaWJpbGl0eUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5xdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pbkZvcmVncm91bmQgPSBfdGhpcy5kb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT09ICd2aXNpYmxlJztcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlQ2xpZW50TWV0YWRhdGFBbmRUcnlCZWNvbWVQcmltYXJ5KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd2aXNpYmlsaXR5Y2hhbmdlJywgdGhpcy5kb2N1bWVudFZpc2liaWxpdHlIYW5kbGVyKTtcclxuICAgICAgICAgICAgdGhpcy5pbkZvcmVncm91bmQgPSB0aGlzLmRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gJ3Zpc2libGUnO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZGV0YWNoVmlzaWJpbGl0eUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZG9jdW1lbnRWaXNpYmlsaXR5SGFuZGxlcikge1xyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy5kb2N1bWVudCAhPT0gbnVsbCAmJlxyXG4gICAgICAgICAgICAgICAgdHlwZW9mIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJywgXCJFeHBlY3RlZCAnZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcicgdG8gYmUgYSBmdW5jdGlvblwiKTtcclxuICAgICAgICAgICAgdGhpcy5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd2aXNpYmlsaXR5Y2hhbmdlJywgdGhpcy5kb2N1bWVudFZpc2liaWxpdHlIYW5kbGVyKTtcclxuICAgICAgICAgICAgdGhpcy5kb2N1bWVudFZpc2liaWxpdHlIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBdHRhY2hlcyBhIHdpbmRvdy51bmxvYWQgaGFuZGxlciB0aGF0IHdpbGwgc3luY2hyb25vdXNseSB3cml0ZSBvdXJcclxuICAgICAqIGNsaWVudElkIHRvIGEgXCJ6b21iaWUgY2xpZW50IGlkXCIgbG9jYXRpb24gaW4gTG9jYWxTdG9yYWdlLiBUaGlzIGNhbiBiZSB1c2VkXHJcbiAgICAgKiBieSB0YWJzIHRyeWluZyB0byBhY3F1aXJlIHRoZSBwcmltYXJ5IGxlYXNlIHRvIGRldGVybWluZSB0aGF0IHRoZSBsZWFzZVxyXG4gICAgICogaXMgbm8gbG9uZ2VyIHZhbGlkIGV2ZW4gaWYgdGhlIHRpbWVzdGFtcCBpcyByZWNlbnQuIFRoaXMgaXMgcGFydGljdWxhcmx5XHJcbiAgICAgKiBpbXBvcnRhbnQgZm9yIHRoZSByZWZyZXNoIGNhc2UgKHNvIHRoZSB0YWIgY29ycmVjdGx5IHJlLWFjcXVpcmVzIHRoZVxyXG4gICAgICogcHJpbWFyeSBsZWFzZSkuIExvY2FsU3RvcmFnZSBpcyB1c2VkIGZvciB0aGlzIHJhdGhlciB0aGFuIEluZGV4ZWREYiBiZWNhdXNlXHJcbiAgICAgKiBpdCBpcyBhIHN5bmNocm9ub3VzIEFQSSBhbmQgc28gY2FuIGJlIHVzZWQgcmVsaWFibHkgZnJvbSAgYW4gdW5sb2FkXHJcbiAgICAgKiBoYW5kbGVyLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuYXR0YWNoV2luZG93VW5sb2FkSG9vayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICB0aGlzLndpbmRvd1VubG9hZEhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBOb3RlOiBJbiB0aGVvcnksIHRoaXMgc2hvdWxkIGJlIHNjaGVkdWxlZCBvbiB0aGUgQXN5bmNRdWV1ZSBzaW5jZSBpdFxyXG4gICAgICAgICAgICAgICAgLy8gYWNjZXNzZXMgaW50ZXJuYWwgc3RhdGUuIFdlIGV4ZWN1dGUgdGhpcyBjb2RlIGRpcmVjdGx5IGR1cmluZyBzaHV0ZG93blxyXG4gICAgICAgICAgICAgICAgLy8gdG8gbWFrZSBzdXJlIGl0IGdldHMgYSBjaGFuY2UgdG8gcnVuLlxyXG4gICAgICAgICAgICAgICAgX3RoaXMubWFya0NsaWVudFpvbWJpZWQoKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEF0dGVtcHQgZ3JhY2VmdWwgc2h1dGRvd24gKGluY2x1ZGluZyByZWxlYXNpbmcgb3VyIHByaW1hcnkgbGVhc2UpLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGJ1dCB0aGVyZSdzIG5vIGd1YXJhbnRlZSBpdCB3aWxsIGNvbXBsZXRlLlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zaHV0ZG93bigpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3VubG9hZCcsIHRoaXMud2luZG93VW5sb2FkSGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5kZXRhY2hXaW5kb3dVbmxvYWRIb29rID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLndpbmRvd1VubG9hZEhhbmRsZXIpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KHR5cGVvZiB0aGlzLndpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nLCBcIkV4cGVjdGVkICd3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcicgdG8gYmUgYSBmdW5jdGlvblwiKTtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndW5sb2FkJywgdGhpcy53aW5kb3dVbmxvYWRIYW5kbGVyKTtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3dVbmxvYWRIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgYSBjbGllbnQgaXMgXCJ6b21iaWVkXCIgYmFzZWQgb24gaXRzIExvY2FsU3RvcmFnZSBlbnRyeS5cclxuICAgICAqIENsaWVudHMgYmVjb21lIHpvbWJpZWQgd2hlbiB0aGVpciB0YWIgY2xvc2VzIHdpdGhvdXQgcnVubmluZyBhbGwgb2YgdGhlXHJcbiAgICAgKiBjbGVhbnVwIGxvZ2ljIGluIGBzaHV0ZG93bigpYC5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmlzQ2xpZW50Wm9tYmllZCA9IGZ1bmN0aW9uIChjbGllbnRJZCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHZhciBpc1pvbWJpZWQgPSB0aGlzLndlYlN0b3JhZ2UuZ2V0SXRlbSh0aGlzLnpvbWJpZWRDbGllbnRMb2NhbFN0b3JhZ2VLZXkoY2xpZW50SWQpKSAhPT1cclxuICAgICAgICAgICAgICAgIG51bGw7XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckMiwgXCJDbGllbnQgJ1wiICsgY2xpZW50SWQgKyBcIicgXCIgKyAoaXNab21iaWVkID8gJ2lzJyA6ICdpcyBub3QnKSArIFwiIHpvbWJpZWQgaW4gTG9jYWxTdG9yYWdlXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gaXNab21iaWVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3Qgd29ya2luZy5cclxuICAgICAgICAgICAgZXJyb3IoTE9HX1RBRyQyLCAnRmFpbGVkIHRvIGdldCB6b21iaWVkIGNsaWVudCBpZC4nLCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlY29yZCBjbGllbnQgYXMgem9tYmllZCAoYSBjbGllbnQgdGhhdCBoYWQgaXRzIHRhYiBjbG9zZWQpLiBab21iaWVkXHJcbiAgICAgKiBjbGllbnRzIGFyZSBpZ25vcmVkIGR1cmluZyBwcmltYXJ5IHRhYiBzZWxlY3Rpb24uXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5tYXJrQ2xpZW50Wm9tYmllZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB0aGlzLndlYlN0b3JhZ2Uuc2V0SXRlbSh0aGlzLnpvbWJpZWRDbGllbnRMb2NhbFN0b3JhZ2VLZXkodGhpcy5jbGllbnRJZCksIFN0cmluZyhEYXRlLm5vdygpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIEdyYWNlZnVsbHkgaGFuZGxlIGlmIExvY2FsU3RvcmFnZSBpc24ndCBhdmFpbGFibGUgLyB3b3JraW5nLlxyXG4gICAgICAgICAgICBlcnJvcignRmFpbGVkIHRvIHNldCB6b21iaWUgY2xpZW50IGlkLicsIGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiogUmVtb3ZlcyB0aGUgem9tYmllZCBjbGllbnQgZW50cnkgaWYgaXQgZXhpc3RzLiAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnJlbW92ZUNsaWVudFpvbWJpZWRFbnRyeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB0aGlzLndlYlN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLnpvbWJpZWRDbGllbnRMb2NhbFN0b3JhZ2VLZXkodGhpcy5jbGllbnRJZCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvLyBJZ25vcmVcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnpvbWJpZWRDbGllbnRMb2NhbFN0b3JhZ2VLZXkgPSBmdW5jdGlvbiAoY2xpZW50SWQpIHtcclxuICAgICAgICByZXR1cm4gWk9NQklFRF9DTElFTlRTX0tFWV9QUkVGSVggKyBcIl9cIiArIHRoaXMucGVyc2lzdGVuY2VLZXkgKyBcIl9cIiArIGNsaWVudElkO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG5hbWUgb2YgdGhlIG1haW4gKGFuZCBjdXJyZW50bHkgb25seSkgSW5kZXhlZERCIGRhdGFiYXNlLiB0aGlzIG5hbWUgaXNcclxuICAgICAqIGFwcGVuZGVkIHRvIHRoZSBwcmVmaXggcHJvdmlkZWQgdG8gdGhlIEluZGV4ZWREYlBlcnNpc3RlbmNlIGNvbnN0cnVjdG9yLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5NQUlOX0RBVEFCQVNFID0gJ21haW4nO1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBpc1ByaW1hcnlMZWFzZUxvc3RFcnJvcihlcnIpIHtcclxuICAgIHJldHVybiAoZXJyLmNvZGUgPT09IENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiAmJlxyXG4gICAgICAgIGVyci5tZXNzYWdlID09PSBQUklNQVJZX0xFQVNFX0xPU1RfRVJST1JfTVNHKTtcclxufVxyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBwcmltYXJ5IGNsaWVudCBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiBwcmltYXJ5Q2xpZW50U3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gdHhuLnN0b3JlKERiUHJpbWFyeUNsaWVudC5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgY2xpZW50IG1ldGFkYXRhIG9iamVjdCBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIGNsaWVudE1ldGFkYXRhU3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gdHhuLnN0b3JlKERiQ2xpZW50TWV0YWRhdGEuc3RvcmUpO1xyXG59XHJcbi8qKiBQcm92aWRlcyBMUlUgZnVuY3Rpb25hbGl0eSBmb3IgSW5kZXhlZERCIHBlcnNpc3RlbmNlLiAqL1xyXG52YXIgSW5kZXhlZERiTHJ1RGVsZWdhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBJbmRleGVkRGJMcnVEZWxlZ2F0ZShkYikge1xyXG4gICAgICAgIHRoaXMuZGIgPSBkYjtcclxuICAgICAgICB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IgPSBuZXcgTHJ1R2FyYmFnZUNvbGxlY3Rvcih0aGlzKTtcclxuICAgIH1cclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5nZXRUYXJnZXRDb3VudCA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRRdWVyeUNhY2hlKCkuZ2V0UXVlcnlDb3VudCh0eG4pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5mb3JFYWNoVGFyZ2V0ID0gZnVuY3Rpb24gKHR4biwgZikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFF1ZXJ5Q2FjaGUoKS5mb3JFYWNoVGFyZ2V0KHR4biwgZik7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLmZvckVhY2hPcnBoYW5lZERvY3VtZW50U2VxdWVuY2VOdW1iZXIgPSBmdW5jdGlvbiAodHhuLCBmKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaE9ycGhhbmVkRG9jdW1lbnQodHhuLCBmdW5jdGlvbiAoZG9jS2V5LCBzZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZihzZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLnNldEluTWVtb3J5UGlucyA9IGZ1bmN0aW9uIChpbk1lbW9yeVBpbnMpIHtcclxuICAgICAgICB0aGlzLmluTWVtb3J5UGlucyA9IGluTWVtb3J5UGlucztcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuYWRkUmVmZXJlbmNlID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHdyaXRlU2VudGluZWxLZXkodHhuLCBrZXkpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVSZWZlcmVuY2UgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICByZXR1cm4gd3JpdGVTZW50aW5lbEtleSh0eG4sIGtleSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZVRhcmdldHMgPSBmdW5jdGlvbiAodHhuLCB1cHBlckJvdW5kLCBhY3RpdmVUYXJnZXRJZHMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYlxyXG4gICAgICAgICAgICAuZ2V0UXVlcnlDYWNoZSgpXHJcbiAgICAgICAgICAgIC5yZW1vdmVUYXJnZXRzKHR4biwgdXBwZXJCb3VuZCwgYWN0aXZlVGFyZ2V0SWRzKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlTXV0YXRpb25SZWZlcmVuY2UgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICByZXR1cm4gd3JpdGVTZW50aW5lbEtleSh0eG4sIGtleSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgYW55dGhpbmcgd291bGQgcHJldmVudCB0aGlzIGRvY3VtZW50IGZyb20gYmVpbmcgZ2FyYmFnZVxyXG4gICAgICogY29sbGVjdGVkLCBnaXZlbiB0aGF0IHRoZSBkb2N1bWVudCBpbiBxdWVzdGlvbiBpcyBub3QgcHJlc2VudCBpbiBhbnlcclxuICAgICAqIHRhcmdldHMgYW5kIGhhcyBhIHNlcXVlbmNlIG51bWJlciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHVwcGVyIGJvdW5kIGZvclxyXG4gICAgICogdGhlIGNvbGxlY3Rpb24gcnVuLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuaXNQaW5uZWQgPSBmdW5jdGlvbiAodHhuLCBkb2NLZXkpIHtcclxuICAgICAgICBpZiAodGhpcy5pbk1lbW9yeVBpbnMuY29udGFpbnNLZXkoZG9jS2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbXV0YXRpb25RdWV1ZXNDb250YWluS2V5KHR4biwgZG9jS2V5KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzID0gZnVuY3Rpb24gKHR4biwgdXBwZXJCb3VuZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcclxuICAgICAgICB2YXIgYnl0ZXNSZW1vdmVkID0gMDtcclxuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICB2YXIgaXRlcmF0aW9uID0gdGhpcy5mb3JFYWNoT3JwaGFuZWREb2N1bWVudCh0eG4sIGZ1bmN0aW9uIChkb2NLZXksIHNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIGlmIChzZXF1ZW5jZU51bWJlciA8PSB1cHBlckJvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcCA9IF90aGlzLmlzUGlubmVkKHR4biwgZG9jS2V5KS5uZXh0KGZ1bmN0aW9uIChpc1Bpbm5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNQaW5uZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnQodHhuLCBkb2NLZXkpLm5leHQoZnVuY3Rpb24gKGRvY3VtZW50Qnl0ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVzUmVtb3ZlZCArPSBkb2N1bWVudEJ5dGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2gocCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBXYWl0IGZvciBpdGVyYXRpb24gZmlyc3QgdG8gbWFrZSBzdXJlIHdlIGhhdmUgYSBjaGFuY2UgdG8gYWRkIGFsbCBvZiB0aGVcclxuICAgICAgICAvLyByZW1vdmFsIHByb21pc2VzIHRvIHRoZSBhcnJheS5cclxuICAgICAgICByZXR1cm4gaXRlcmF0aW9uXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKTsgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZGIuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLnVwZGF0ZVNpemUodHhuLCAtYnl0ZXNSZW1vdmVkKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBjb3VudDsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhcnMgYSBkb2N1bWVudCBmcm9tIHRoZSBjYWNoZS4gVGhlIGRvY3VtZW50IGlzIGFzc3VtZWQgdG8gYmUgb3JwaGFuZWQsIHNvIHRhcmdldC1kb2N1bWVudFxyXG4gICAgICogYXNzb2NpYXRpb25zIGFyZSBub3QgcXVlcmllZC4gV2UgcmVtb3ZlIGl0IGZyb20gdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZSwgYXMgd2VsbCBhcyByZW1vdmVcclxuICAgICAqIGl0cyBzZW50aW5lbCByb3cuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVPcnBoYW5lZERvY3VtZW50ID0gZnVuY3Rpb24gKHR4biwgZG9jS2V5KSB7XHJcbiAgICAgICAgdmFyIHRvdGFsQnl0ZXNSZW1vdmVkID0gMDtcclxuICAgICAgICB2YXIgZG9jdW1lbnRDYWNoZSA9IHRoaXMuZGIuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihbXHJcbiAgICAgICAgICAgIGRvY3VtZW50VGFyZ2V0U3RvcmUodHhuKS5kZWxldGUoc2VudGluZWxLZXkoZG9jS2V5KSksXHJcbiAgICAgICAgICAgIGRvY3VtZW50Q2FjaGUucmVtb3ZlRW50cnkodHhuLCBkb2NLZXkpLm5leHQoZnVuY3Rpb24gKGJ5dGVzUmVtb3ZlZCkge1xyXG4gICAgICAgICAgICAgICAgdG90YWxCeXRlc1JlbW92ZWQgKz0gYnl0ZXNSZW1vdmVkO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIF0pLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gdG90YWxCeXRlc1JlbW92ZWQ7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVUYXJnZXQgPSBmdW5jdGlvbiAodHhuLCBxdWVyeURhdGEpIHtcclxuICAgICAgICB2YXIgdXBkYXRlZCA9IHF1ZXJ5RGF0YS5jb3B5KHtcclxuICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXI6IHR4bi5jdXJyZW50U2VxdWVuY2VOdW1iZXJcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRRdWVyeUNhY2hlKCkudXBkYXRlUXVlcnlEYXRhKHR4biwgdXBkYXRlZCk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLnVwZGF0ZUxpbWJvRG9jdW1lbnQgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICByZXR1cm4gd3JpdGVTZW50aW5lbEtleSh0eG4sIGtleSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsIHByb3ZpZGVkIGZ1bmN0aW9uIGZvciBlYWNoIGRvY3VtZW50IGluIHRoZSBjYWNoZSB0aGF0IGlzICdvcnBoYW5lZCcuIE9ycGhhbmVkXHJcbiAgICAgKiBtZWFucyBub3QgYSBwYXJ0IG9mIGFueSB0YXJnZXQsIHNvIHRoZSBvbmx5IGVudHJ5IGluIHRoZSB0YXJnZXQtZG9jdW1lbnQgaW5kZXggZm9yXHJcbiAgICAgKiB0aGF0IGRvY3VtZW50IHdpbGwgYmUgdGhlIHNlbnRpbmVsIHJvdyAodGFyZ2V0SWQgMCksIHdoaWNoIHdpbGwgYWxzbyBoYXZlIHRoZSBzZXF1ZW5jZVxyXG4gICAgICogbnVtYmVyIGZvciB0aGUgbGFzdCB0aW1lIHRoZSBkb2N1bWVudCB3YXMgYWNjZXNzZWQuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5mb3JFYWNoT3JwaGFuZWREb2N1bWVudCA9IGZ1bmN0aW9uICh0eG4sIGYpIHtcclxuICAgICAgICB2YXIgc3RvcmUgPSBkb2N1bWVudFRhcmdldFN0b3JlKHR4bik7XHJcbiAgICAgICAgdmFyIG5leHRUb1JlcG9ydCA9IExpc3RlblNlcXVlbmNlLklOVkFMSUQ7XHJcbiAgICAgICAgdmFyIG5leHRQYXRoO1xyXG4gICAgICAgIHJldHVybiBzdG9yZVxyXG4gICAgICAgICAgICAuaXRlcmF0ZSh7XHJcbiAgICAgICAgICAgIGluZGV4OiBEYlRhcmdldERvY3VtZW50LmRvY3VtZW50VGFyZ2V0c0luZGV4XHJcbiAgICAgICAgfSwgZnVuY3Rpb24gKF9hLCBfYikge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBfYVswXSwgZG9jS2V5ID0gX2FbMV07XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gX2IucGF0aCwgc2VxdWVuY2VOdW1iZXIgPSBfYi5zZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICAgICAgaWYgKHRhcmdldElkID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiBuZXh0VG9SZXBvcnQgaXMgdmFsaWQsIHJlcG9ydCBpdCwgdGhpcyBpcyBhIG5ldyBrZXkgc28gdGhlXHJcbiAgICAgICAgICAgICAgICAvLyBsYXN0IG9uZSBtdXN0IG5vdCBiZSBhIG1lbWJlciBvZiBhbnkgdGFyZ2V0cy5cclxuICAgICAgICAgICAgICAgIGlmIChuZXh0VG9SZXBvcnQgIT09IExpc3RlblNlcXVlbmNlLklOVkFMSUQpIHtcclxuICAgICAgICAgICAgICAgICAgICBmKG5ldyBEb2N1bWVudEtleShkZWNvZGUkMShuZXh0UGF0aCkpLCBuZXh0VG9SZXBvcnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gc2V0IG5leHRUb1JlcG9ydCB0byBiZSB0aGlzIHNlcXVlbmNlIG51bWJlci4gSXQncyB0aGUgbmV4dCBvbmUgd2VcclxuICAgICAgICAgICAgICAgIC8vIG1pZ2h0IHJlcG9ydCwgaWYgd2UgZG9uJ3QgZmluZCBhbnkgdGFyZ2V0cyBmb3IgdGhpcyBkb2N1bWVudC5cclxuICAgICAgICAgICAgICAgIC8vIE5vdGUgdGhhdCB0aGUgc2VxdWVuY2UgbnVtYmVyIG11c3QgYmUgZGVmaW5lZCB3aGVuIHRoZSB0YXJnZXRJZFxyXG4gICAgICAgICAgICAgICAgLy8gaXMgMC5cclxuICAgICAgICAgICAgICAgIG5leHRUb1JlcG9ydCA9IHNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgICAgICAgICAgbmV4dFBhdGggPSBwYXRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gc2V0IG5leHRUb1JlcG9ydCB0byBiZSBpbnZhbGlkLCB3ZSBrbm93IHdlIGRvbid0IG5lZWQgdG8gcmVwb3J0XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzIG9uZSBzaW5jZSB3ZSBmb3VuZCBhIHRhcmdldCBmb3IgaXQuXHJcbiAgICAgICAgICAgICAgICBuZXh0VG9SZXBvcnQgPSBMaXN0ZW5TZXF1ZW5jZS5JTlZBTElEO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBTaW5jZSB3ZSByZXBvcnQgc2VxdWVuY2UgbnVtYmVycyBhZnRlciBnZXR0aW5nIHRvIHRoZSBuZXh0IGtleSwgd2VcclxuICAgICAgICAgICAgLy8gbmVlZCB0byBjaGVjayBpZiB0aGUgbGFzdCBrZXkgd2UgaXRlcmF0ZWQgb3ZlciB3YXMgYW4gb3JwaGFuZWRcclxuICAgICAgICAgICAgLy8gZG9jdW1lbnQgYW5kIHJlcG9ydCBpdC5cclxuICAgICAgICAgICAgaWYgKG5leHRUb1JlcG9ydCAhPT0gTGlzdGVuU2VxdWVuY2UuSU5WQUxJRCkge1xyXG4gICAgICAgICAgICAgICAgZihuZXcgRG9jdW1lbnRLZXkoZGVjb2RlJDEobmV4dFBhdGgpKSwgbmV4dFRvUmVwb3J0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBJbmRleGVkRGJMcnVEZWxlZ2F0ZTtcclxufSgpKTtcclxuZnVuY3Rpb24gc2VudGluZWxLZXkoa2V5KSB7XHJcbiAgICByZXR1cm4gWzAsIGVuY29kZShrZXkucGF0aCldO1xyXG59XHJcbi8qKlxyXG4gKiBAcmV0dXJuIEEgdmFsdWUgc3VpdGFibGUgZm9yIHdyaXRpbmcgYSBzZW50aW5lbCByb3cgaW4gdGhlIHRhcmdldC1kb2N1bWVudFxyXG4gKiBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIHNlbnRpbmVsUm93KGtleSwgc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgIHJldHVybiBuZXcgRGJUYXJnZXREb2N1bWVudCgwLCBlbmNvZGUoa2V5LnBhdGgpLCBzZXF1ZW5jZU51bWJlcik7XHJcbn1cclxuZnVuY3Rpb24gd3JpdGVTZW50aW5lbEtleSh0eG4sIGtleSkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50VGFyZ2V0U3RvcmUodHhuKS5wdXQoc2VudGluZWxSb3coa2V5LCB0eG4uY3VycmVudFNlcXVlbmNlTnVtYmVyKSk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBIHJlYWRvbmx5IHZpZXcgb2YgdGhlIGxvY2FsIHN0YXRlIG9mIGFsbCBkb2N1bWVudHMgd2UncmUgdHJhY2tpbmcgKGkuZS4gd2VcclxuICogaGF2ZSBhIGNhY2hlZCB2ZXJzaW9uIGluIHJlbW90ZURvY3VtZW50Q2FjaGUgb3IgbG9jYWwgbXV0YXRpb25zIGZvciB0aGVcclxuICogZG9jdW1lbnQpLiBUaGUgdmlldyBpcyBjb21wdXRlZCBieSBhcHBseWluZyB0aGUgbXV0YXRpb25zIGluIHRoZVxyXG4gKiBNdXRhdGlvblF1ZXVlIHRvIHRoZSBSZW1vdGVEb2N1bWVudENhY2hlLlxyXG4gKi9cclxudmFyIExvY2FsRG9jdW1lbnRzVmlldyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExvY2FsRG9jdW1lbnRzVmlldyhyZW1vdGVEb2N1bWVudENhY2hlLCBtdXRhdGlvblF1ZXVlKSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlID0gcmVtb3RlRG9jdW1lbnRDYWNoZTtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50IGlkZW50aWZpZWQgYnkgYGtleWAuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybiBMb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudCBvciBudWxsIGlmIHdlIGRvbid0IGhhdmUgYW55IGNhY2hlZFxyXG4gICAgICogc3RhdGUgZm9yIGl0LlxyXG4gICAgICovXHJcbiAgICBMb2NhbERvY3VtZW50c1ZpZXcucHJvdG90eXBlLmdldERvY3VtZW50ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBrZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm11dGF0aW9uUXVldWVcclxuICAgICAgICAgICAgLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5KHRyYW5zYWN0aW9uLCBrZXkpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChiYXRjaGVzKSB7IHJldHVybiBfdGhpcy5nZXREb2N1bWVudEludGVybmFsKHRyYW5zYWN0aW9uLCBrZXksIGJhdGNoZXMpOyB9KTtcclxuICAgIH07XHJcbiAgICAvKiogSW50ZXJuYWwgdmVyc2lvbiBvZiBgZ2V0RG9jdW1lbnRgIHRoYXQgYWxsb3dzIHJldXNpbmcgYmF0Y2hlcy4gKi9cclxuICAgIExvY2FsRG9jdW1lbnRzVmlldy5wcm90b3R5cGUuZ2V0RG9jdW1lbnRJbnRlcm5hbCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwga2V5LCBpbkJhdGNoZXMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlLmdldEVudHJ5KHRyYW5zYWN0aW9uLCBrZXkpLm5leHQoZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGluQmF0Y2hlc18xID0gaW5CYXRjaGVzOyBfaSA8IGluQmF0Y2hlc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJhdGNoID0gaW5CYXRjaGVzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgZG9jID0gYmF0Y2guYXBwbHlUb0xvY2FsVmlldyhrZXksIGRvYyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGRvYztcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEdldHMgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50cyBpZGVudGlmaWVkIGJ5IGBrZXlzYC5cclxuICAgICAqXHJcbiAgICAgKiBJZiB3ZSBkb24ndCBoYXZlIGNhY2hlZCBzdGF0ZSBmb3IgYSBkb2N1bWVudCBpbiBga2V5c2AsIGEgTm9Eb2N1bWVudCB3aWxsXHJcbiAgICAgKiBiZSBzdG9yZWQgZm9yIHRoYXQga2V5IGluIHRoZSByZXN1bHRpbmcgc2V0LlxyXG4gICAgICovXHJcbiAgICBMb2NhbERvY3VtZW50c1ZpZXcucHJvdG90eXBlLmdldERvY3VtZW50cyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwga2V5cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubXV0YXRpb25RdWV1ZVxyXG4gICAgICAgICAgICAuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzKHRyYW5zYWN0aW9uLCBrZXlzKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoYmF0Y2hlcykge1xyXG4gICAgICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBtYXliZURvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKF90aGlzLmdldERvY3VtZW50SW50ZXJuYWwodHJhbnNhY3Rpb24sIGtleSwgYmF0Y2hlcykubmV4dChmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGh0dHA6Ly9iLzMyMjc1Mzc4KTogRG9uJ3QgY29uZmxhdGUgbWlzc2luZyAvIGRlbGV0ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXliZURvYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXliZURvYyA9IG5ldyBOb0RvY3VtZW50KGtleSwgU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmluc2VydChrZXksIG1heWJlRG9jKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcykubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiByZXN1bHRzOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogUGVyZm9ybXMgYSBxdWVyeSBhZ2FpbnN0IHRoZSBsb2NhbCB2aWV3IG9mIGFsbCBkb2N1bWVudHMuICovXHJcbiAgICBMb2NhbERvY3VtZW50c1ZpZXcucHJvdG90eXBlLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5KSB7XHJcbiAgICAgICAgaWYgKERvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkocXVlcnkucGF0aCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdEb2N1bWVudFF1ZXJ5KHRyYW5zYWN0aW9uLCBxdWVyeS5wYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvblF1ZXJ5KHRyYW5zYWN0aW9uLCBxdWVyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIExvY2FsRG9jdW1lbnRzVmlldy5wcm90b3R5cGUuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdEb2N1bWVudFF1ZXJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2NQYXRoKSB7XHJcbiAgICAgICAgLy8gSnVzdCBkbyBhIHNpbXBsZSBkb2N1bWVudCBsb29rdXAuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9jdW1lbnQodHJhbnNhY3Rpb24sIG5ldyBEb2N1bWVudEtleShkb2NQYXRoKSkubmV4dChmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGRvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgICAgIGlmIChtYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuaW5zZXJ0KG1heWJlRG9jLmtleSwgbWF5YmVEb2MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgTG9jYWxEb2N1bWVudHNWaWV3LnByb3RvdHlwZS5nZXREb2N1bWVudHNNYXRjaGluZ0NvbGxlY3Rpb25RdWVyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFF1ZXJ5IHRoZSByZW1vdGUgZG9jdW1lbnRzIGFuZCBvdmVybGF5IG11dGF0aW9ucy5cclxuICAgICAgICB2YXIgcmVzdWx0cztcclxuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlXHJcbiAgICAgICAgICAgIC5nZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHRyYW5zYWN0aW9uLCBxdWVyeSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKHF1ZXJ5UmVzdWx0cykge1xyXG4gICAgICAgICAgICByZXN1bHRzID0gcXVlcnlSZXN1bHRzO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSh0cmFuc2FjdGlvbiwgcXVlcnkpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChtYXRjaGluZ011dGF0aW9uQmF0Y2hlcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIG1hdGNoaW5nTXV0YXRpb25CYXRjaGVzXzEgPSBtYXRjaGluZ011dGF0aW9uQmF0Y2hlczsgX2kgPCBtYXRjaGluZ011dGF0aW9uQmF0Y2hlc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJhdGNoID0gbWF0Y2hpbmdNdXRhdGlvbkJhdGNoZXNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIF9iID0gYmF0Y2gubXV0YXRpb25zOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtdXRhdGlvbiA9IF9iW19hXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gbXV0YXRpb24ua2V5O1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgcHJvY2VzcyBkb2N1bWVudHMgYmVsb25naW5nIHRvIHRoZSBjb2xsZWN0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnkucGF0aC5pc0ltbWVkaWF0ZVBhcmVudE9mKGtleS5wYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhc2VEb2MgPSByZXN1bHRzLmdldChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtdXRhdGVkRG9jID0gbXV0YXRpb24uYXBwbHlUb0xvY2FsVmlldyhiYXNlRG9jLCBiYXNlRG9jLCBiYXRjaC5sb2NhbFdyaXRlVGltZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG11dGF0ZWREb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5pbnNlcnQoa2V5LCBtdXRhdGVkRG9jKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLnJlbW92ZShrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gRmluYWxseSwgZmlsdGVyIG91dCBhbnkgZG9jdW1lbnRzIHRoYXQgZG9uJ3QgYWN0dWFsbHkgbWF0Y2hcclxuICAgICAgICAgICAgLy8gdGhlIHF1ZXJ5LlxyXG4gICAgICAgICAgICByZXN1bHRzLmZvckVhY2goZnVuY3Rpb24gKGtleSwgZG9jKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5Lm1hdGNoZXMoZG9jKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLnJlbW92ZShrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExvY2FsRG9jdW1lbnRzVmlldztcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBIGNvbGxlY3Rpb24gb2YgcmVmZXJlbmNlcyB0byBhIGRvY3VtZW50IGZyb20gc29tZSBraW5kIG9mIG51bWJlcmVkIGVudGl0eVxyXG4gKiAoZWl0aGVyIGEgdGFyZ2V0IElEIG9yIGJhdGNoIElEKS4gQXMgcmVmZXJlbmNlcyBhcmUgYWRkZWQgdG8gb3IgcmVtb3ZlZCBmcm9tXHJcbiAqIHRoZSBzZXQgY29ycmVzcG9uZGluZyBldmVudHMgYXJlIGVtaXR0ZWQgdG8gYSByZWdpc3RlcmVkIGdhcmJhZ2UgY29sbGVjdG9yLlxyXG4gKlxyXG4gKiBFYWNoIHJlZmVyZW5jZSBpcyByZXByZXNlbnRlZCBieSBhIERvY3VtZW50UmVmZXJlbmNlIG9iamVjdC4gRWFjaCBvZiB0aGVtXHJcbiAqIGNvbnRhaW5zIGVub3VnaCBpbmZvcm1hdGlvbiB0byB1bmlxdWVseSBpZGVudGlmeSB0aGUgcmVmZXJlbmNlLiBUaGV5IGFyZSBhbGxcclxuICogc3RvcmVkIHByaW1hcmlseSBpbiBhIHNldCBzb3J0ZWQgYnkga2V5LiBBIGRvY3VtZW50IGlzIGNvbnNpZGVyZWQgZ2FyYmFnZSBpZlxyXG4gKiB0aGVyZSdzIG5vIHJlZmVyZW5jZXMgaW4gdGhhdCBzZXQgKHRoaXMgY2FuIGJlIGVmZmljaWVudGx5IGNoZWNrZWQgdGhhbmtzIHRvXHJcbiAqIHNvcnRpbmcgYnkga2V5KS5cclxuICpcclxuICogUmVmZXJlbmNlU2V0IGFsc28ga2VlcHMgYSBzZWNvbmRhcnkgc2V0IHRoYXQgY29udGFpbnMgcmVmZXJlbmNlcyBzb3J0ZWQgYnlcclxuICogSURzLiBUaGlzIG9uZSBpcyB1c2VkIHRvIGVmZmljaWVudGx5IGltcGxlbWVudCByZW1vdmFsIG9mIGFsbCByZWZlcmVuY2VzIGJ5XHJcbiAqIHNvbWUgdGFyZ2V0IElELlxyXG4gKi9cclxudmFyIFJlZmVyZW5jZVNldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlZmVyZW5jZVNldCgpIHtcclxuICAgICAgICAvLyBBIHNldCBvZiBvdXRzdGFuZGluZyByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgc29ydGVkIGJ5IGtleS5cclxuICAgICAgICB0aGlzLnJlZnNCeUtleSA9IG5ldyBTb3J0ZWRTZXQoRG9jUmVmZXJlbmNlLmNvbXBhcmVCeUtleSk7XHJcbiAgICAgICAgLy8gQSBzZXQgb2Ygb3V0c3RhbmRpbmcgcmVmZXJlbmNlcyB0byBhIGRvY3VtZW50IHNvcnRlZCBieSB0YXJnZXQgaWQuXHJcbiAgICAgICAgdGhpcy5yZWZzQnlUYXJnZXQgPSBuZXcgU29ydGVkU2V0KERvY1JlZmVyZW5jZS5jb21wYXJlQnlUYXJnZXRJZCk7XHJcbiAgICB9XHJcbiAgICAvKiogUmV0dXJucyB0cnVlIGlmIHRoZSByZWZlcmVuY2Ugc2V0IGNvbnRhaW5zIG5vIHJlZmVyZW5jZXMuICovXHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVmc0J5S2V5LmlzRW1wdHkoKTtcclxuICAgIH07XHJcbiAgICAvKiogQWRkcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5IGZvciB0aGUgZ2l2ZW4gSUQuICovXHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLmFkZFJlZmVyZW5jZSA9IGZ1bmN0aW9uIChrZXksIGlkKSB7XHJcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBEb2NSZWZlcmVuY2Uoa2V5LCBpZCk7XHJcbiAgICAgICAgdGhpcy5yZWZzQnlLZXkgPSB0aGlzLnJlZnNCeUtleS5hZGQocmVmKTtcclxuICAgICAgICB0aGlzLnJlZnNCeVRhcmdldCA9IHRoaXMucmVmc0J5VGFyZ2V0LmFkZChyZWYpO1xyXG4gICAgfTtcclxuICAgIC8qKiBBZGQgcmVmZXJlbmNlcyB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5cyBmb3IgdGhlIGdpdmVuIElELiAqL1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5hZGRSZWZlcmVuY2VzID0gZnVuY3Rpb24gKGtleXMsIGlkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gX3RoaXMuYWRkUmVmZXJlbmNlKGtleSwgaWQpOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgYSByZWZlcmVuY2UgdG8gdGhlIGdpdmVuIGRvY3VtZW50IGtleSBmb3IgdGhlIGdpdmVuXHJcbiAgICAgKiBJRC5cclxuICAgICAqL1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5yZW1vdmVSZWZlcmVuY2UgPSBmdW5jdGlvbiAoa2V5LCBpZCkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlUmVmKG5ldyBEb2NSZWZlcmVuY2Uoa2V5LCBpZCkpO1xyXG4gICAgfTtcclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUucmVtb3ZlUmVmZXJlbmNlcyA9IGZ1bmN0aW9uIChrZXlzLCBpZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIF90aGlzLnJlbW92ZVJlZmVyZW5jZShrZXksIGlkKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhcnMgYWxsIHJlZmVyZW5jZXMgd2l0aCBhIGdpdmVuIElELiBDYWxscyByZW1vdmVSZWYoKSBmb3IgZWFjaCBrZXlcclxuICAgICAqIHJlbW92ZWQuXHJcbiAgICAgKi9cclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUucmVtb3ZlUmVmZXJlbmNlc0ZvcklkID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZW1wdHlLZXkgPSBEb2N1bWVudEtleS5FTVBUWTtcclxuICAgICAgICB2YXIgc3RhcnRSZWYgPSBuZXcgRG9jUmVmZXJlbmNlKGVtcHR5S2V5LCBpZCk7XHJcbiAgICAgICAgdmFyIGVuZFJlZiA9IG5ldyBEb2NSZWZlcmVuY2UoZW1wdHlLZXksIGlkICsgMSk7XHJcbiAgICAgICAgdmFyIGtleXMgPSBbXTtcclxuICAgICAgICB0aGlzLnJlZnNCeVRhcmdldC5mb3JFYWNoSW5SYW5nZShbc3RhcnRSZWYsIGVuZFJlZl0sIGZ1bmN0aW9uIChyZWYpIHtcclxuICAgICAgICAgICAgX3RoaXMucmVtb3ZlUmVmKHJlZik7XHJcbiAgICAgICAgICAgIGtleXMucHVzaChyZWYua2V5KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4ga2V5cztcclxuICAgIH07XHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLnJlbW92ZUFsbFJlZmVyZW5jZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnJlZnNCeUtleS5mb3JFYWNoKGZ1bmN0aW9uIChyZWYpIHsgcmV0dXJuIF90aGlzLnJlbW92ZVJlZihyZWYpOyB9KTtcclxuICAgIH07XHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLnJlbW92ZVJlZiA9IGZ1bmN0aW9uIChyZWYpIHtcclxuICAgICAgICB0aGlzLnJlZnNCeUtleSA9IHRoaXMucmVmc0J5S2V5LmRlbGV0ZShyZWYpO1xyXG4gICAgICAgIHRoaXMucmVmc0J5VGFyZ2V0ID0gdGhpcy5yZWZzQnlUYXJnZXQuZGVsZXRlKHJlZik7XHJcbiAgICB9O1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5yZWZlcmVuY2VzRm9ySWQgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICB2YXIgZW1wdHlLZXkgPSBEb2N1bWVudEtleS5FTVBUWTtcclxuICAgICAgICB2YXIgc3RhcnRSZWYgPSBuZXcgRG9jUmVmZXJlbmNlKGVtcHR5S2V5LCBpZCk7XHJcbiAgICAgICAgdmFyIGVuZFJlZiA9IG5ldyBEb2NSZWZlcmVuY2UoZW1wdHlLZXksIGlkICsgMSk7XHJcbiAgICAgICAgdmFyIGtleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHRoaXMucmVmc0J5VGFyZ2V0LmZvckVhY2hJblJhbmdlKFtzdGFydFJlZiwgZW5kUmVmXSwgZnVuY3Rpb24gKHJlZikge1xyXG4gICAgICAgICAgICBrZXlzID0ga2V5cy5hZGQocmVmLmtleSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGtleXM7XHJcbiAgICB9O1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5jb250YWluc0tleSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgcmVmID0gbmV3IERvY1JlZmVyZW5jZShrZXksIDApO1xyXG4gICAgICAgIHZhciBmaXJzdFJlZiA9IHRoaXMucmVmc0J5S2V5LmZpcnN0QWZ0ZXJPckVxdWFsKHJlZik7XHJcbiAgICAgICAgcmV0dXJuIGZpcnN0UmVmICE9PSBudWxsICYmIGtleS5pc0VxdWFsKGZpcnN0UmVmLmtleSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlZmVyZW5jZVNldDtcclxufSgpKTtcclxudmFyIERvY1JlZmVyZW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERvY1JlZmVyZW5jZShrZXksIHRhcmdldE9yQmF0Y2hJZCkge1xyXG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIHRoaXMudGFyZ2V0T3JCYXRjaElkID0gdGFyZ2V0T3JCYXRjaElkO1xyXG4gICAgfVxyXG4gICAgLyoqIENvbXBhcmUgYnkga2V5IHRoZW4gYnkgSUQgKi9cclxuICAgIERvY1JlZmVyZW5jZS5jb21wYXJlQnlLZXkgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcclxuICAgICAgICByZXR1cm4gKERvY3VtZW50S2V5LmNvbXBhcmF0b3IobGVmdC5rZXksIHJpZ2h0LmtleSkgfHxcclxuICAgICAgICAgICAgcHJpbWl0aXZlQ29tcGFyYXRvcihsZWZ0LnRhcmdldE9yQmF0Y2hJZCwgcmlnaHQudGFyZ2V0T3JCYXRjaElkKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIENvbXBhcmUgYnkgSUQgdGhlbiBieSBrZXkgKi9cclxuICAgIERvY1JlZmVyZW5jZS5jb21wYXJlQnlUYXJnZXRJZCA9IGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xyXG4gICAgICAgIHJldHVybiAocHJpbWl0aXZlQ29tcGFyYXRvcihsZWZ0LnRhcmdldE9yQmF0Y2hJZCwgcmlnaHQudGFyZ2V0T3JCYXRjaElkKSB8fFxyXG4gICAgICAgICAgICBEb2N1bWVudEtleS5jb21wYXJhdG9yKGxlZnQua2V5LCByaWdodC5rZXkpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRG9jUmVmZXJlbmNlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckMyA9ICdMb2NhbFN0b3JlJztcclxuLyoqXHJcbiAqIExvY2FsIHN0b3JhZ2UgaW4gdGhlIEZpcmVzdG9yZSBjbGllbnQuIENvb3JkaW5hdGVzIHBlcnNpc3RlbmNlIGNvbXBvbmVudHNcclxuICogbGlrZSB0aGUgbXV0YXRpb24gcXVldWUgYW5kIHJlbW90ZSBkb2N1bWVudCBjYWNoZSB0byBwcmVzZW50IGFcclxuICogbGF0ZW5jeS1jb21wZW5zYXRlZCB2aWV3IG9mIHN0b3JlZCBkYXRhLlxyXG4gKlxyXG4gKiBUaGUgTG9jYWxTdG9yZSBpcyByZXNwb25zaWJsZSBmb3IgYWNjZXB0aW5nIG11dGF0aW9ucyBmcm9tIHRoZSBTeW5jIEVuZ2luZS5cclxuICogV3JpdGVzIGZyb20gdGhlIGNsaWVudCBhcmUgcHV0IGludG8gYSBxdWV1ZSBhcyBwcm92aXNpb25hbCBNdXRhdGlvbnMgdW50aWxcclxuICogdGhleSBhcmUgcHJvY2Vzc2VkIGJ5IHRoZSBSZW1vdGVTdG9yZSBhbmQgY29uZmlybWVkIGFzIGhhdmluZyBiZWVuIHdyaXR0ZW5cclxuICogdG8gdGhlIHNlcnZlci5cclxuICpcclxuICogVGhlIGxvY2FsIHN0b3JlIHByb3ZpZGVzIHRoZSBsb2NhbCB2ZXJzaW9uIG9mIGRvY3VtZW50cyB0aGF0IGhhdmUgYmVlblxyXG4gKiBtb2RpZmllZCBsb2NhbGx5LiBJdCBtYWludGFpbnMgdGhlIGNvbnN0cmFpbnQ6XHJcbiAqXHJcbiAqICAgTG9jYWxEb2N1bWVudCA9IFJlbW90ZURvY3VtZW50ICsgQWN0aXZlKExvY2FsTXV0YXRpb25zKVxyXG4gKlxyXG4gKiAoQWN0aXZlIG11dGF0aW9ucyBhcmUgdGhvc2UgdGhhdCBhcmUgZW5xdWV1ZWQgYW5kIGhhdmUgbm90IGJlZW4gcHJldmlvdXNseVxyXG4gKiBhY2tub3dsZWRnZWQgb3IgcmVqZWN0ZWQpLlxyXG4gKlxyXG4gKiBUaGUgUmVtb3RlRG9jdW1lbnQgKFwiZ3JvdW5kIHRydXRoXCIpIHN0YXRlIGlzIHByb3ZpZGVkIHZpYSB0aGVcclxuICogYXBwbHlDaGFuZ2VCYXRjaCBtZXRob2QuIEl0IHdpbGwgYmUgc29tZSB2ZXJzaW9uIG9mIGEgc2VydmVyLXByb3ZpZGVkXHJcbiAqIGRvY3VtZW50IE9SIHdpbGwgYmUgYSBzZXJ2ZXItcHJvdmlkZWQgZG9jdW1lbnQgUExVUyBhY2tub3dsZWRnZWQgbXV0YXRpb25zOlxyXG4gKlxyXG4gKiAgIFJlbW90ZURvY3VtZW50JyA9IFJlbW90ZURvY3VtZW50ICsgQWNrbm93bGVkZ2VkKExvY2FsTXV0YXRpb25zKVxyXG4gKlxyXG4gKiBOb3RlIHRoYXQgdGhpcyBcImRpcnR5XCIgdmVyc2lvbiBvZiBhIFJlbW90ZURvY3VtZW50IHdpbGwgbm90IGJlIGlkZW50aWNhbCB0byBhXHJcbiAqIHNlcnZlciBiYXNlIHZlcnNpb24sIHNpbmNlIGl0IGhhcyBMb2NhbE11dGF0aW9ucyBhZGRlZCB0byBpdCBwZW5kaW5nIGdldHRpbmdcclxuICogYW4gYXV0aG9yaXRhdGl2ZSBjb3B5IGZyb20gdGhlIHNlcnZlci5cclxuICpcclxuICogU2luY2UgTG9jYWxNdXRhdGlvbnMgY2FuIGJlIHJlamVjdGVkIGJ5IHRoZSBzZXJ2ZXIsIHdlIGhhdmUgdG8gYmUgYWJsZSB0b1xyXG4gKiByZXZlcnQgYSBMb2NhbE11dGF0aW9uIHRoYXQgaGFzIGFscmVhZHkgYmVlbiBhcHBsaWVkIHRvIHRoZSBMb2NhbERvY3VtZW50XHJcbiAqICh0eXBpY2FsbHkgZG9uZSBieSByZXBsYXlpbmcgYWxsIHJlbWFpbmluZyBMb2NhbE11dGF0aW9ucyB0byB0aGVcclxuICogUmVtb3RlRG9jdW1lbnQgdG8gcmUtYXBwbHkpLlxyXG4gKlxyXG4gKiBUaGUgTG9jYWxTdG9yZSBpcyByZXNwb25zaWJsZSBmb3IgdGhlIGdhcmJhZ2UgY29sbGVjdGlvbiBvZiB0aGUgZG9jdW1lbnRzIGl0XHJcbiAqIGNvbnRhaW5zLiBGb3Igbm93LCBpdCBldmVyeSBkb2MgcmVmZXJlbmNlZCBieSBhIHZpZXcsIHRoZSBtdXRhdGlvbiBxdWV1ZSwgb3JcclxuICogdGhlIFJlbW90ZVN0b3JlLlxyXG4gKlxyXG4gKiBJdCBhbHNvIG1haW50YWlucyB0aGUgcGVyc2lzdGVuY2Ugb2YgbWFwcGluZyBxdWVyaWVzIHRvIHJlc3VtZSB0b2tlbnMgYW5kXHJcbiAqIHRhcmdldCBpZHMuIEl0IG5lZWRzIHRvIGtub3cgdGhpcyBkYXRhIGFib3V0IHF1ZXJpZXMgdG8gcHJvcGVybHkga25vdyB3aGF0XHJcbiAqIGRvY3MgaXQgd291bGQgYmUgYWxsb3dlZCB0byBnYXJiYWdlIGNvbGxlY3QuXHJcbiAqXHJcbiAqIFRoZSBMb2NhbFN0b3JlIG11c3QgYmUgYWJsZSB0byBlZmZpY2llbnRseSBleGVjdXRlIHF1ZXJpZXMgYWdhaW5zdCBpdHMgbG9jYWxcclxuICogY2FjaGUgb2YgdGhlIGRvY3VtZW50cywgdG8gcHJvdmlkZSB0aGUgaW5pdGlhbCBzZXQgb2YgcmVzdWx0cyBiZWZvcmUgYW55XHJcbiAqIHJlbW90ZSBjaGFuZ2VzIGhhdmUgYmVlbiByZWNlaXZlZC5cclxuICpcclxuICogTm90ZTogSW4gVHlwZVNjcmlwdCwgbW9zdCBtZXRob2RzIHJldHVybiBQcm9taXNlcyBzaW5jZSB0aGUgaW1wbGVtZW50YXRpb25cclxuICogbWF5IHJlbHkgb24gZmV0Y2hpbmcgZGF0YSBmcm9tIEluZGV4ZWREQiB3aGljaCBpcyBhc3luYy5cclxuICogVGhlc2UgUHJvbWlzZXMgd2lsbCBvbmx5IGJlIHJlamVjdGVkIG9uIGFuIEkvTyBlcnJvciBvciBvdGhlciBpbnRlcm5hbFxyXG4gKiAodW5leHBlY3RlZCkgZmFpbHVyZSAoZS5nLiBmYWlsZWQgYXNzZXJ0KSBhbmQgYWx3YXlzIHJlcHJlc2VudCBhblxyXG4gKiB1bnJlY292ZXJhYmxlIGVycm9yIChzaG91bGQgYmUgY2F1Z2h0IC8gcmVwb3J0ZWQgYnkgdGhlIGFzeW5jX3F1ZXVlKS5cclxuICovXHJcbnZhciBMb2NhbFN0b3JlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTG9jYWxTdG9yZShcclxuICAgIC8qKiBNYW5hZ2VzIG91ciBpbi1tZW1vcnkgb3IgZHVyYWJsZSBwZXJzaXN0ZW5jZS4gKi9cclxuICAgIHBlcnNpc3RlbmNlLCBpbml0aWFsVXNlcikge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSBwZXJzaXN0ZW5jZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50IHJlZmVyZW5jZXMgbWFpbnRhaW5lZCBieSBhbnkgbG9jYWwgdmlld3MuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5sb2NhbFZpZXdSZWZlcmVuY2VzID0gbmV3IFJlZmVyZW5jZVNldCgpO1xyXG4gICAgICAgIC8qKiBNYXBzIGEgdGFyZ2V0SUQgdG8gZGF0YSBhYm91dCBpdHMgcXVlcnkuICovXHJcbiAgICAgICAgdGhpcy5xdWVyeURhdGFCeVRhcmdldCA9IHt9O1xyXG4gICAgICAgIGFzc2VydChwZXJzaXN0ZW5jZS5zdGFydGVkLCAnTG9jYWxTdG9yZSB3YXMgcGFzc2VkIGFuIHVuc3RhcnRlZCBwZXJzaXN0ZW5jZSBpbXBsZW1lbnRhdGlvbicpO1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUuc2V0SW5NZW1vcnlQaW5zKHRoaXMubG9jYWxWaWV3UmVmZXJlbmNlcyk7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gcGVyc2lzdGVuY2UuZ2V0TXV0YXRpb25RdWV1ZShpbml0aWFsVXNlcik7XHJcbiAgICAgICAgdGhpcy5yZW1vdGVEb2N1bWVudHMgPSBwZXJzaXN0ZW5jZS5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCk7XHJcbiAgICAgICAgdGhpcy5xdWVyeUNhY2hlID0gcGVyc2lzdGVuY2UuZ2V0UXVlcnlDYWNoZSgpO1xyXG4gICAgICAgIHRoaXMubG9jYWxEb2N1bWVudHMgPSBuZXcgTG9jYWxEb2N1bWVudHNWaWV3KHRoaXMucmVtb3RlRG9jdW1lbnRzLCB0aGlzLm11dGF0aW9uUXVldWUpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUZWxscyB0aGUgTG9jYWxTdG9yZSB0aGF0IHRoZSBjdXJyZW50bHkgYXV0aGVudGljYXRlZCB1c2VyIGhhcyBjaGFuZ2VkLlxyXG4gICAgICpcclxuICAgICAqIEluIHJlc3BvbnNlIHRoZSBsb2NhbCBzdG9yZSBzd2l0Y2hlcyB0aGUgbXV0YXRpb24gcXVldWUgdG8gdGhlIG5ldyB1c2VyIGFuZFxyXG4gICAgICogcmV0dXJucyBhbnkgcmVzdWx0aW5nIGRvY3VtZW50IGNoYW5nZXMuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogQW5kcm9pZCBhbmQgaU9TIG9ubHkgcmV0dXJuIHRoZSBkb2N1bWVudHMgYWZmZWN0ZWQgYnkgdGhlXHJcbiAgICAvLyBjaGFuZ2UuXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5oYW5kbGVVc2VyQ2hhbmdlID0gZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdIYW5kbGUgdXNlciBjaGFuZ2UnLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIC8vIFN3YXAgb3V0IHRoZSBtdXRhdGlvbiBxdWV1ZSwgZ3JhYmJpbmcgdGhlIHBlbmRpbmcgbXV0YXRpb24gYmF0Y2hlc1xyXG4gICAgICAgICAgICAvLyBiZWZvcmUgYW5kIGFmdGVyLlxyXG4gICAgICAgICAgICB2YXIgb2xkQmF0Y2hlcztcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWVcclxuICAgICAgICAgICAgICAgIC5nZXRBbGxNdXRhdGlvbkJhdGNoZXModHhuKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKHByb21pc2VkT2xkQmF0Y2hlcykge1xyXG4gICAgICAgICAgICAgICAgb2xkQmF0Y2hlcyA9IHByb21pc2VkT2xkQmF0Y2hlcztcclxuICAgICAgICAgICAgICAgIF90aGlzLm11dGF0aW9uUXVldWUgPSBfdGhpcy5wZXJzaXN0ZW5jZS5nZXRNdXRhdGlvblF1ZXVlKHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgLy8gUmVjcmVhdGUgb3VyIExvY2FsRG9jdW1lbnRzVmlldyB1c2luZyB0aGUgbmV3XHJcbiAgICAgICAgICAgICAgICAvLyBNdXRhdGlvblF1ZXVlLlxyXG4gICAgICAgICAgICAgICAgX3RoaXMubG9jYWxEb2N1bWVudHMgPSBuZXcgTG9jYWxEb2N1bWVudHNWaWV3KF90aGlzLnJlbW90ZURvY3VtZW50cywgX3RoaXMubXV0YXRpb25RdWV1ZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXModHhuKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChuZXdCYXRjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3ZlZEJhdGNoSWRzID0gW107XHJcbiAgICAgICAgICAgICAgICB2YXIgYWRkZWRCYXRjaElkcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgLy8gVW5pb24gdGhlIG9sZC9uZXcgY2hhbmdlZCBrZXlzLlxyXG4gICAgICAgICAgICAgICAgdmFyIGNoYW5nZWRLZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgb2xkQmF0Y2hlc18xID0gb2xkQmF0Y2hlczsgX2kgPCBvbGRCYXRjaGVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhdGNoID0gb2xkQmF0Y2hlc18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVkQmF0Y2hJZHMucHVzaChiYXRjaC5iYXRjaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIF9iID0gYmF0Y2gubXV0YXRpb25zOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXV0YXRpb24gPSBfYltfYV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZWRLZXlzID0gY2hhbmdlZEtleXMuYWRkKG11dGF0aW9uLmtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSAwLCBuZXdCYXRjaGVzXzEgPSBuZXdCYXRjaGVzOyBfYyA8IG5ld0JhdGNoZXNfMS5sZW5ndGg7IF9jKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYmF0Y2ggPSBuZXdCYXRjaGVzXzFbX2NdO1xyXG4gICAgICAgICAgICAgICAgICAgIGFkZGVkQmF0Y2hJZHMucHVzaChiYXRjaC5iYXRjaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfZCA9IDAsIF9lID0gYmF0Y2gubXV0YXRpb25zOyBfZCA8IF9lLmxlbmd0aDsgX2QrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXV0YXRpb24gPSBfZVtfZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZWRLZXlzID0gY2hhbmdlZEtleXMuYWRkKG11dGF0aW9uLmtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSBzZXQgb2YgYWxsIChwb3RlbnRpYWxseSkgY2hhbmdlZCBkb2N1bWVudHMgYW5kIHRoZSBsaXN0XHJcbiAgICAgICAgICAgICAgICAvLyBvZiBtdXRhdGlvbiBiYXRjaCBJRHMgdGhhdCB3ZXJlIGFmZmVjdGVkIGJ5IGNoYW5nZS5cclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbERvY3VtZW50c1xyXG4gICAgICAgICAgICAgICAgICAgIC5nZXREb2N1bWVudHModHhuLCBjaGFuZ2VkS2V5cylcclxuICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoYWZmZWN0ZWREb2N1bWVudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZERvY3VtZW50czogYWZmZWN0ZWREb2N1bWVudHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWRCYXRjaElkczogcmVtb3ZlZEJhdGNoSWRzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRlZEJhdGNoSWRzOiBhZGRlZEJhdGNoSWRzXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiBBY2NlcHQgbG9jYWxseSBnZW5lcmF0ZWQgTXV0YXRpb25zIGFuZCBjb21taXQgdGhlbSB0byBzdG9yYWdlLiAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUubG9jYWxXcml0ZSA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdMb2NhbGx5IHdyaXRlIG11dGF0aW9ucycsICdyZWFkd3JpdGUnLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHZhciBiYXRjaDtcclxuICAgICAgICAgICAgdmFyIGxvY2FsV3JpdGVUaW1lID0gVGltZXN0YW1wLm5vdygpO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZVxyXG4gICAgICAgICAgICAgICAgLmFkZE11dGF0aW9uQmF0Y2godHhuLCBsb2NhbFdyaXRlVGltZSwgbXV0YXRpb25zKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKHByb21pc2VkQmF0Y2gpIHtcclxuICAgICAgICAgICAgICAgIGJhdGNoID0gcHJvbWlzZWRCYXRjaDtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oa29zcyk6IFRoaXMgaXMgZG9pbmcgYW4gTl4yIHVwZGF0ZSBieSByZXBsYXlpbmcgQUxMIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gbXV0YXRpb25zIG9uIGVhY2ggZG9jdW1lbnQgKGluc3RlYWQgb2YganVzdCB0aGUgb25lcyBhZGRlZCkgaW5cclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgYmF0Y2guXHJcbiAgICAgICAgICAgICAgICB2YXIga2V5cyA9IGJhdGNoLmtleXMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudHModHhuLCBrZXlzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChjaGFuZ2VkRG9jdW1lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyBiYXRjaElkOiBiYXRjaC5iYXRjaElkLCBjaGFuZ2VzOiBjaGFuZ2VkRG9jdW1lbnRzIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBSZXR1cm5zIHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudHMgYWZmZWN0ZWQgYnkgYSBtdXRhdGlvbiBiYXRjaC4gKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5sb29rdXBNdXRhdGlvbkRvY3VtZW50cyA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignTG9va3VwIG11dGF0aW9uIGRvY3VtZW50cycsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWVcclxuICAgICAgICAgICAgICAgIC5sb29rdXBNdXRhdGlvbktleXModHhuLCBiYXRjaElkKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGtleXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChrZXlzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyh0eG4sIGtleXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFja25vd2xlZGdlIHRoZSBnaXZlbiBiYXRjaC5cclxuICAgICAqXHJcbiAgICAgKiBPbiB0aGUgaGFwcHkgcGF0aCB3aGVuIGEgYmF0Y2ggaXMgYWNrbm93bGVkZ2VkLCB0aGUgbG9jYWwgc3RvcmUgd2lsbFxyXG4gICAgICpcclxuICAgICAqICArIHJlbW92ZSB0aGUgYmF0Y2ggZnJvbSB0aGUgbXV0YXRpb24gcXVldWU7XHJcbiAgICAgKiAgKyBhcHBseSB0aGUgY2hhbmdlcyB0byB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlO1xyXG4gICAgICogICsgcmVjYWxjdWxhdGUgdGhlIGxhdGVuY3kgY29tcGVuc2F0ZWQgdmlldyBpbXBsaWVkIGJ5IHRob3NlIGNoYW5nZXMgKHRoZXJlXHJcbiAgICAgKiAgICBtYXkgYmUgbXV0YXRpb25zIGluIHRoZSBxdWV1ZSB0aGF0IGFmZmVjdCB0aGUgZG9jdW1lbnRzIGJ1dCBoYXZlbid0IGJlZW5cclxuICAgICAqICAgIGFja25vd2xlZGdlZCB5ZXQpOyBhbmRcclxuICAgICAqICArIGdpdmUgdGhlIGNoYW5nZWQgZG9jdW1lbnRzIGJhY2sgdGhlIHN5bmMgZW5naW5lXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgVGhlIHJlc3VsdGluZyAobW9kaWZpZWQpIGRvY3VtZW50cy5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuYWNrbm93bGVkZ2VCYXRjaCA9IGZ1bmN0aW9uIChiYXRjaFJlc3VsdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0Fja25vd2xlZGdlIGJhdGNoJywgJ3JlYWR3cml0ZS1wcmltYXJ5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICB2YXIgYWZmZWN0ZWQgPSBiYXRjaFJlc3VsdC5iYXRjaC5rZXlzKCk7XHJcbiAgICAgICAgICAgIHZhciBkb2N1bWVudEJ1ZmZlciA9IF90aGlzLnJlbW90ZURvY3VtZW50cy5uZXdDaGFuZ2VCdWZmZXIoKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWVcclxuICAgICAgICAgICAgICAgIC5hY2tub3dsZWRnZUJhdGNoKHR4biwgYmF0Y2hSZXN1bHQuYmF0Y2gsIGJhdGNoUmVzdWx0LnN0cmVhbVRva2VuKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmFwcGx5V3JpdGVUb1JlbW90ZURvY3VtZW50cyh0eG4sIGJhdGNoUmVzdWx0LCBkb2N1bWVudEJ1ZmZlcik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBkb2N1bWVudEJ1ZmZlci5hcHBseSh0eG4pOyB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZS5wZXJmb3JtQ29uc2lzdGVuY3lDaGVjayh0eG4pOyB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzKHR4biwgYWZmZWN0ZWQpOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZSBtdXRhdGlvbnMgZnJvbSB0aGUgTXV0YXRpb25RdWV1ZSBmb3IgdGhlIHNwZWNpZmllZCBiYXRjaDtcclxuICAgICAqIExvY2FsRG9jdW1lbnRzIHdpbGwgYmUgcmVjYWxjdWxhdGVkLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIFRoZSByZXN1bHRpbmcgbW9kaWZpZWQgZG9jdW1lbnRzLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5yZWplY3RCYXRjaCA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignUmVqZWN0IGJhdGNoJywgJ3JlYWR3cml0ZS1wcmltYXJ5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICB2YXIgYWZmZWN0ZWRLZXlzO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZVxyXG4gICAgICAgICAgICAgICAgLmxvb2t1cE11dGF0aW9uQmF0Y2godHhuLCBiYXRjaElkKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGJhdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoYmF0Y2ggIT09IG51bGwsICdBdHRlbXB0IHRvIHJlamVjdCBub25leGlzdGVudCBiYXRjaCEnKTtcclxuICAgICAgICAgICAgICAgIGFmZmVjdGVkS2V5cyA9IGJhdGNoLmtleXMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlLnJlbW92ZU11dGF0aW9uQmF0Y2godHhuLCBiYXRjaCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZS5wZXJmb3JtQ29uc2lzdGVuY3lDaGVjayh0eG4pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyh0eG4sIGFmZmVjdGVkS2V5cyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBSZXR1cm5zIHRoZSBsYXN0IHJlY29yZGVkIHN0cmVhbSB0b2tlbiBmb3IgdGhlIGN1cnJlbnQgdXNlci4gKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmdldExhc3RTdHJlYW1Ub2tlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdHZXQgbGFzdCBzdHJlYW0gdG9rZW4nLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlLmdldExhc3RTdHJlYW1Ub2tlbih0eG4pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU2V0cyB0aGUgc3RyZWFtIHRva2VuIGZvciB0aGUgY3VycmVudCB1c2VyIHdpdGhvdXQgYWNrbm93bGVkZ2luZyBhbnlcclxuICAgICAqIG11dGF0aW9uIGJhdGNoLiBUaGlzIGlzIHVzdWFsbHkgb25seSB1c2VmdWwgYWZ0ZXIgYSBzdHJlYW0gaGFuZHNoYWtlIG9yIGluXHJcbiAgICAgKiByZXNwb25zZSB0byBhbiBlcnJvciB0aGF0IHJlcXVpcmVzIGNsZWFyaW5nIHRoZSBzdHJlYW0gdG9rZW4uXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLnNldExhc3RTdHJlYW1Ub2tlbiA9IGZ1bmN0aW9uIChzdHJlYW1Ub2tlbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ1NldCBsYXN0IHN0cmVhbSB0b2tlbicsICdyZWFkd3JpdGUtcHJpbWFyeScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWUuc2V0TGFzdFN0cmVhbVRva2VuKHR4biwgc3RyZWFtVG9rZW4pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgbGFzdCBjb25zaXN0ZW50IHNuYXBzaG90IHByb2Nlc3NlZCAodXNlZCBieSB0aGUgUmVtb3RlU3RvcmUgdG9cclxuICAgICAqIGRldGVybWluZSB3aGV0aGVyIHRvIGJ1ZmZlciBpbmNvbWluZyBzbmFwc2hvdHMgZnJvbSB0aGUgYmFja2VuZCkuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignR2V0IGxhc3QgcmVtb3RlIHNuYXBzaG90IHZlcnNpb24nLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7IHJldHVybiBfdGhpcy5xdWVyeUNhY2hlLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24odHhuKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGUgdGhlIFwiZ3JvdW5kLXN0YXRlXCIgKHJlbW90ZSkgZG9jdW1lbnRzLiBXZSBhc3N1bWUgdGhhdCB0aGUgcmVtb3RlXHJcbiAgICAgKiBldmVudCByZWZsZWN0cyBhbnkgd3JpdGUgYmF0Y2hlcyB0aGF0IGhhdmUgYmVlbiBhY2tub3dsZWRnZWQgb3IgcmVqZWN0ZWRcclxuICAgICAqIChpLmUuIHdlIGRvIG5vdCByZS1hcHBseSBsb2NhbCBtdXRhdGlvbnMgdG8gdXBkYXRlcyBmcm9tIHRoaXMgZXZlbnQpLlxyXG4gICAgICpcclxuICAgICAqIExvY2FsRG9jdW1lbnRzIGFyZSByZS1jYWxjdWxhdGVkIGlmIHRoZXJlIGFyZSByZW1haW5pbmcgbXV0YXRpb25zIGluIHRoZVxyXG4gICAgICogcXVldWUuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmFwcGx5UmVtb3RlRXZlbnQgPSBmdW5jdGlvbiAocmVtb3RlRXZlbnQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBkb2N1bWVudEJ1ZmZlciA9IHRoaXMucmVtb3RlRG9jdW1lbnRzLm5ld0NoYW5nZUJ1ZmZlcigpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdBcHBseSByZW1vdGUgZXZlbnQnLCAncmVhZHdyaXRlLXByaW1hcnknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgYXV0aG9yaXRhdGl2ZVVwZGF0ZXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgICAgICBmb3JFYWNoTnVtYmVyKHJlbW90ZUV2ZW50LnRhcmdldENoYW5nZXMsIGZ1bmN0aW9uICh0YXJnZXRJZCwgY2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBEbyBub3QgcmVmL3VucmVmIHVuYXNzaWduZWQgdGFyZ2V0SWRzIC0gaXQgbWF5IGxlYWQgdG8gbGVha3MuXHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnlEYXRhID0gX3RoaXMucXVlcnlEYXRhQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFxdWVyeURhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgLy8gV2hlbiBhIGdsb2JhbCBzbmFwc2hvdCBjb250YWlucyB1cGRhdGVzIChlaXRoZXIgYWRkIG9yIG1vZGlmeSkgd2VcclxuICAgICAgICAgICAgICAgIC8vIGNhbiBjb21wbGV0ZWx5IHRydXN0IHRoZXNlIHVwZGF0ZXMgYXMgYXV0aG9yaXRhdGl2ZSBhbmQgYmxpbmRseVxyXG4gICAgICAgICAgICAgICAgLy8gYXBwbHkgdGhlbSB0byBvdXIgY2FjaGUgKGFzIGEgZGVmZW5zaXZlIG1lYXN1cmUgdG8gcHJvbW90ZVxyXG4gICAgICAgICAgICAgICAgLy8gc2VsZi1oZWFsaW5nIGluIHRoZSB1bmZvcnR1bmF0ZSBjYXNlIHRoYXQgb3VyIGNhY2hlIGlzIGV2ZXIgc29tZWhvd1xyXG4gICAgICAgICAgICAgICAgLy8gY29ycnVwdGVkIC8gb3V0LW9mLXN5bmMpLlxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBkb2N1bWVudCBpcyBvbmx5IHVwZGF0ZWQgd2hpbGUgcmVtb3ZpbmcgaXQgZnJvbSBhIHRhcmdldFxyXG4gICAgICAgICAgICAgICAgLy8gdGhlbiB3YXRjaCBpc24ndCBvYmxpZ2F0ZWQgdG8gc2VuZCB0aGUgYWJzb2x1dGUgbGF0ZXN0IHZlcnNpb246IGl0XHJcbiAgICAgICAgICAgICAgICAvLyBjYW4gc2VuZCB0aGUgZmlyc3QgdmVyc2lvbiB0aGF0IGNhdXNlZCB0aGUgZG9jdW1lbnQgbm90IHRvIG1hdGNoLlxyXG4gICAgICAgICAgICAgICAgY2hhbmdlLmFkZGVkRG9jdW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcml0YXRpdmVVcGRhdGVzID0gYXV0aG9yaXRhdGl2ZVVwZGF0ZXMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNoYW5nZS5tb2RpZmllZERvY3VtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRob3JpdGF0aXZlVXBkYXRlcyA9IGF1dGhvcml0YXRpdmVVcGRhdGVzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKF90aGlzLnF1ZXJ5Q2FjaGVcclxuICAgICAgICAgICAgICAgICAgICAucmVtb3ZlTWF0Y2hpbmdLZXlzKHR4biwgY2hhbmdlLnJlbW92ZWREb2N1bWVudHMsIHRhcmdldElkKVxyXG4gICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucXVlcnlDYWNoZS5hZGRNYXRjaGluZ0tleXModHhuLCBjaGFuZ2UuYWRkZWREb2N1bWVudHMsIHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcmVzdW1lIHRva2VuIGlmIHRoZSBjaGFuZ2UgaW5jbHVkZXMgb25lLiBEb24ndCBjbGVhclxyXG4gICAgICAgICAgICAgICAgLy8gYW55IHByZWV4aXN0aW5nIHZhbHVlLlxyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VtZVRva2VuID0gY2hhbmdlLnJlc3VtZVRva2VuO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VtZVRva2VuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkUXVlcnlEYXRhID0gcXVlcnlEYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5RGF0YSA9IHF1ZXJ5RGF0YS5jb3B5KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdW1lVG9rZW46IHJlc3VtZVRva2VuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzbmFwc2hvdFZlcnNpb246IHJlbW90ZUV2ZW50LnNuYXBzaG90VmVyc2lvblxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnF1ZXJ5RGF0YUJ5VGFyZ2V0W3RhcmdldElkXSA9IHF1ZXJ5RGF0YTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoTG9jYWxTdG9yZS5zaG91bGRQZXJzaXN0UXVlcnlEYXRhKG9sZFF1ZXJ5RGF0YSwgcXVlcnlEYXRhLCBjaGFuZ2UpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goX3RoaXMucXVlcnlDYWNoZS51cGRhdGVRdWVyeURhdGEodHhuLCBxdWVyeURhdGEpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgY2hhbmdlZERvY0tleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgICAgICByZW1vdGVFdmVudC5kb2N1bWVudFVwZGF0ZXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCBkb2MpIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZWREb2NLZXlzID0gY2hhbmdlZERvY0tleXMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGRvY3VtZW50QnVmZmVyLmdldEVudHJ5KHR4biwga2V5KS5uZXh0KGZ1bmN0aW9uIChleGlzdGluZ0RvYykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGEgZG9jdW1lbnQgdXBkYXRlIGlzbid0IGF1dGhvcml0YXRpdmUsIG1ha2Ugc3VyZSB3ZSBkb24ndFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFwcGx5IGFuIG9sZCBkb2N1bWVudCB2ZXJzaW9uIHRvIHRoZSByZW1vdGUgY2FjaGUuIFdlIG1ha2UgYW5cclxuICAgICAgICAgICAgICAgICAgICAvLyBleGNlcHRpb24gZm9yIFNuYXBzaG90VmVyc2lvbi5NSU4gd2hpY2ggY2FuIGhhcHBlbiBmb3JcclxuICAgICAgICAgICAgICAgICAgICAvLyBtYW51ZmFjdHVyZWQgZXZlbnRzIChlLmcuIGluIHRoZSBjYXNlIG9mIGEgbGltYm8gZG9jdW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAvLyByZXNvbHV0aW9uIGZhaWxpbmcpLlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0RvYyA9PSBudWxsIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvYy52ZXJzaW9uLmlzRXF1YWwoU25hcHNob3RWZXJzaW9uLk1JTikgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGF1dGhvcml0YXRpdmVVcGRhdGVzLmhhcyhkb2Mua2V5KSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIWV4aXN0aW5nRG9jLmhhc1BlbmRpbmdXcml0ZXMpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvYy52ZXJzaW9uLmNvbXBhcmVUbyhleGlzdGluZ0RvYy52ZXJzaW9uKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50QnVmZmVyLmFkZEVudHJ5KGRvYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDMsICdJZ25vcmluZyBvdXRkYXRlZCB3YXRjaCB1cGRhdGUgZm9yICcsIGtleSwgJy4gQ3VycmVudCB2ZXJzaW9uOicsIGV4aXN0aW5nRG9jLnZlcnNpb24sICcgV2F0Y2ggdmVyc2lvbjonLCBkb2MudmVyc2lvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlbW90ZUV2ZW50LnJlc29sdmVkTGltYm9Eb2N1bWVudHMuaGFzKGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKF90aGlzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnVwZGF0ZUxpbWJvRG9jdW1lbnQodHhuLCBrZXkpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIEhBQ0s6IFRoZSBvbmx5IHJlYXNvbiB3ZSBhbGxvdyBhIG51bGwgc25hcHNob3QgdmVyc2lvbiBpcyBzbyB0aGF0IHdlXHJcbiAgICAgICAgICAgIC8vIGNhbiBzeW50aGVzaXplIHJlbW90ZSBldmVudHMgd2hlbiB3ZSBnZXQgcGVybWlzc2lvbiBkZW5pZWQgZXJyb3JzIHdoaWxlXHJcbiAgICAgICAgICAgIC8vIHRyeWluZyB0byByZXNvbHZlIHRoZSBzdGF0ZSBvZiBhIGxvY2FsbHkgY2FjaGVkIGRvY3VtZW50IHRoYXQgaXMgaW5cclxuICAgICAgICAgICAgLy8gbGltYm8uXHJcbiAgICAgICAgICAgIHZhciByZW1vdGVWZXJzaW9uID0gcmVtb3RlRXZlbnQuc25hcHNob3RWZXJzaW9uO1xyXG4gICAgICAgICAgICBpZiAoIXJlbW90ZVZlcnNpb24uaXNFcXVhbChTbmFwc2hvdFZlcnNpb24uTUlOKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVwZGF0ZVJlbW90ZVZlcnNpb24gPSBfdGhpcy5xdWVyeUNhY2hlXHJcbiAgICAgICAgICAgICAgICAgICAgLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24odHhuKVxyXG4gICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChsYXN0UmVtb3RlVmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChyZW1vdGVWZXJzaW9uLmNvbXBhcmVUbyhsYXN0UmVtb3RlVmVyc2lvbikgPj0gMCwgJ1dhdGNoIHN0cmVhbSByZXZlcnRlZCB0byBwcmV2aW91cyBzbmFwc2hvdD8/ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVWZXJzaW9uICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJyA8ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0UmVtb3RlVmVyc2lvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5Q2FjaGUuc2V0VGFyZ2V0c01ldGFkYXRhKHR4biwgdHhuLmN1cnJlbnRTZXF1ZW5jZU51bWJlciwgcmVtb3RlVmVyc2lvbik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2godXBkYXRlUmVtb3RlVmVyc2lvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gZG9jdW1lbnRCdWZmZXIuYXBwbHkodHhuKTsgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudHModHhuLCBjaGFuZ2VkRG9jS2V5cyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBuZXdRdWVyeURhdGEgc2hvdWxkIGJlIHBlcnNpc3RlZCBkdXJpbmcgYW4gdXBkYXRlIG9mXHJcbiAgICAgKiBhbiBhY3RpdmUgdGFyZ2V0LiBRdWVyeURhdGEgc2hvdWxkIGFsd2F5cyBiZSBwZXJzaXN0ZWQgd2hlbiBhIHRhcmdldCBpc1xyXG4gICAgICogYmVpbmcgcmVsZWFzZWQgYW5kIHNob3VsZCBub3QgY2FsbCB0aGlzIGZ1bmN0aW9uLlxyXG4gICAgICpcclxuICAgICAqIFdoaWxlIHRoZSB0YXJnZXQgaXMgYWN0aXZlLCBRdWVyeURhdGEgdXBkYXRlcyBjYW4gYmUgb21pdHRlZCB3aGVuIG5vdGhpbmdcclxuICAgICAqIGFib3V0IHRoZSB0YXJnZXQgaGFzIGNoYW5nZWQgZXhjZXB0IG1ldGFkYXRhIGxpa2UgdGhlIHJlc3VtZSB0b2tlbiBvclxyXG4gICAgICogc25hcHNob3QgdmVyc2lvbi4gT2NjYXNpb25hbGx5IGl0J3Mgd29ydGggdGhlIGV4dHJhIHdyaXRlIHRvIHByZXZlbnQgdGhlc2VcclxuICAgICAqIHZhbHVlcyBmcm9tIGdldHRpbmcgdG9vIHN0YWxlIGFmdGVyIGEgY3Jhc2gsIGJ1dCB0aGlzIGRvZXNuJ3QgaGF2ZSB0byBiZVxyXG4gICAgICogdG9vIGZyZXF1ZW50LlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnNob3VsZFBlcnNpc3RRdWVyeURhdGEgPSBmdW5jdGlvbiAob2xkUXVlcnlEYXRhLCBuZXdRdWVyeURhdGEsIGNoYW5nZSkge1xyXG4gICAgICAgIC8vIEF2b2lkIGNsZWFyaW5nIGFueSBleGlzdGluZyB2YWx1ZVxyXG4gICAgICAgIGlmIChuZXdRdWVyeURhdGEucmVzdW1lVG9rZW4ubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgLy8gQW55IHJlc3VtZSB0b2tlbiBpcyBpbnRlcmVzdGluZyBpZiB0aGVyZSBpc24ndCBvbmUgYWxyZWFkeS5cclxuICAgICAgICBpZiAob2xkUXVlcnlEYXRhLnJlc3VtZVRva2VuLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgLy8gRG9uJ3QgYWxsb3cgcmVzdW1lIHRva2VuIGNoYW5nZXMgdG8gYmUgYnVmZmVyZWQgaW5kZWZpbml0ZWx5LiBUaGlzXHJcbiAgICAgICAgLy8gYWxsb3dzIHVzIHRvIGJlIHJlYXNvbmFibHkgdXAtdG8tZGF0ZSBhZnRlciBhIGNyYXNoIGFuZCBhdm9pZHMgbmVlZGluZ1xyXG4gICAgICAgIC8vIHRvIGxvb3Agb3ZlciBhbGwgYWN0aXZlIHF1ZXJpZXMgb24gc2h1dGRvd24uIEVzcGVjaWFsbHkgaW4gdGhlIGJyb3dzZXJcclxuICAgICAgICAvLyB3ZSBtYXkgbm90IGdldCB0aW1lIHRvIGRvIGFueXRoaW5nIGludGVyZXN0aW5nIHdoaWxlIHRoZSBjdXJyZW50IHRhYiBpc1xyXG4gICAgICAgIC8vIGNsb3NpbmcuXHJcbiAgICAgICAgdmFyIHRpbWVEZWx0YSA9IG5ld1F1ZXJ5RGF0YS5zbmFwc2hvdFZlcnNpb24udG9NaWNyb3NlY29uZHMoKSAtXHJcbiAgICAgICAgICAgIG9sZFF1ZXJ5RGF0YS5zbmFwc2hvdFZlcnNpb24udG9NaWNyb3NlY29uZHMoKTtcclxuICAgICAgICBpZiAodGltZURlbHRhID49IHRoaXMuUkVTVU1FX1RPS0VOX01BWF9BR0VfTUlDUk9TKVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAvLyBPdGhlcndpc2UgaWYgdGhlIG9ubHkgdGhpbmcgdGhhdCBoYXMgY2hhbmdlZCBhYm91dCBhIHRhcmdldCBpcyBpdHMgcmVzdW1lXHJcbiAgICAgICAgLy8gdG9rZW4gaXQncyBub3Qgd29ydGggcGVyc2lzdGluZy4gTm90ZSB0aGF0IHRoZSBSZW1vdGVTdG9yZSBrZWVwcyBhblxyXG4gICAgICAgIC8vIGluLW1lbW9yeSB2aWV3IG9mIHRoZSBjdXJyZW50bHkgYWN0aXZlIHRhcmdldHMgd2hpY2ggaW5jbHVkZXMgdGhlIGN1cnJlbnRcclxuICAgICAgICAvLyByZXN1bWUgdG9rZW4sIHNvIHN0cmVhbSBmYWlsdXJlIG9yIHVzZXIgY2hhbmdlcyB3aWxsIHN0aWxsIHVzZSBhblxyXG4gICAgICAgIC8vIHVwLXRvLWRhdGUgcmVzdW1lIHRva2VuIHJlZ2FyZGxlc3Mgb2Ygd2hhdCB3ZSBkbyBoZXJlLlxyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gY2hhbmdlLmFkZGVkRG9jdW1lbnRzLnNpemUgK1xyXG4gICAgICAgICAgICBjaGFuZ2UubW9kaWZpZWREb2N1bWVudHMuc2l6ZSArXHJcbiAgICAgICAgICAgIGNoYW5nZS5yZW1vdmVkRG9jdW1lbnRzLnNpemU7XHJcbiAgICAgICAgcmV0dXJuIGNoYW5nZXMgPiAwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogTm90aWZ5IGxvY2FsIHN0b3JlIG9mIHRoZSBjaGFuZ2VkIHZpZXdzIHRvIGxvY2FsbHkgcGluIGRvY3VtZW50cy5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUubm90aWZ5TG9jYWxWaWV3Q2hhbmdlcyA9IGZ1bmN0aW9uICh2aWV3Q2hhbmdlcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ25vdGlmeUxvY2FsVmlld0NoYW5nZXMnLCAncmVhZHdyaXRlJywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2godmlld0NoYW5nZXMsIGZ1bmN0aW9uICh2aWV3Q2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5sb2NhbFZpZXdSZWZlcmVuY2VzLmFkZFJlZmVyZW5jZXModmlld0NoYW5nZS5hZGRlZEtleXMsIHZpZXdDaGFuZ2UudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubG9jYWxWaWV3UmVmZXJlbmNlcy5yZW1vdmVSZWZlcmVuY2VzKHZpZXdDaGFuZ2UucmVtb3ZlZEtleXMsIHZpZXdDaGFuZ2UudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHZpZXdDaGFuZ2UucmVtb3ZlZEtleXMsIGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlUmVmZXJlbmNlKHR4biwga2V5KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEdldHMgdGhlIG11dGF0aW9uIGJhdGNoIGFmdGVyIHRoZSBwYXNzZWQgaW4gYmF0Y2hJZCBpbiB0aGUgbXV0YXRpb24gcXVldWVcclxuICAgICAqIG9yIG51bGwgaWYgZW1wdHkuXHJcbiAgICAgKiBAcGFyYW0gYWZ0ZXJCYXRjaElkIElmIHByb3ZpZGVkLCB0aGUgYmF0Y2ggdG8gc2VhcmNoIGFmdGVyLlxyXG4gICAgICogQHJldHVybnMgVGhlIG5leHQgbXV0YXRpb24gb3IgbnVsbCBpZiB0aGVyZSB3YXNuJ3Qgb25lLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5uZXh0TXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uIChhZnRlckJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdHZXQgbmV4dCBtdXRhdGlvbiBiYXRjaCcsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgaWYgKGFmdGVyQmF0Y2hJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBhZnRlckJhdGNoSWQgPSBCQVRDSElEX1VOS05PV047XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWUuZ2V0TmV4dE11dGF0aW9uQmF0Y2hBZnRlckJhdGNoSWQodHhuLCBhZnRlckJhdGNoSWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVhZCB0aGUgY3VycmVudCB2YWx1ZSBvZiBhIERvY3VtZW50IHdpdGggYSBnaXZlbiBrZXkgb3IgbnVsbCBpZiBub3RcclxuICAgICAqIGZvdW5kIC0gdXNlZCBmb3IgdGVzdGluZy5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUucmVhZERvY3VtZW50ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ3JlYWQgZG9jdW1lbnQnLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudCh0eG4sIGtleSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBc3NpZ25zIHRoZSBnaXZlbiBxdWVyeSBhbiBpbnRlcm5hbCBJRCBzbyB0aGF0IGl0cyByZXN1bHRzIGNhbiBiZSBwaW5uZWQgc29cclxuICAgICAqIHRoZXkgZG9uJ3QgZ2V0IEdDJ2QuIEEgcXVlcnkgbXVzdCBiZSBhbGxvY2F0ZWQgaW4gdGhlIGxvY2FsIHN0b3JlIGJlZm9yZVxyXG4gICAgICogdGhlIHN0b3JlIGNhbiBiZSB1c2VkIHRvIG1hbmFnZSBpdHMgdmlldy5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuYWxsb2NhdGVRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0FsbG9jYXRlIHF1ZXJ5JywgJ3JlYWR3cml0ZScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5RGF0YTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5Q2FjaGVcclxuICAgICAgICAgICAgICAgIC5nZXRRdWVyeURhdGEodHhuLCBxdWVyeSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChjYWNoZWQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWNoZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHF1ZXJ5IGhhcyBiZWVuIGxpc3RlbmVkIHRvIHByZXZpb3VzbHksIHNvIHJldXNlIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHByZXZpb3VzIHRhcmdldElELlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8obWNnKTogZnJlc2hlbiBsYXN0IGFjY2Vzc2VkIGRhdGU/XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlEYXRhID0gY2FjaGVkO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5Q2FjaGUuYWxsb2NhdGVUYXJnZXRJZCh0eG4pLm5leHQoZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5RGF0YSA9IG5ldyBRdWVyeURhdGEocXVlcnksIHRhcmdldElkLCBRdWVyeVB1cnBvc2UuTGlzdGVuLCB0eG4uY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5Q2FjaGUuYWRkUXVlcnlEYXRhKHR4biwgcXVlcnlEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydCghX3RoaXMucXVlcnlEYXRhQnlUYXJnZXRbcXVlcnlEYXRhLnRhcmdldElkXSwgJ1RyaWVkIHRvIGFsbG9jYXRlIGFuIGFscmVhZHkgYWxsb2NhdGVkIHF1ZXJ5OiAnICsgcXVlcnkpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucXVlcnlEYXRhQnlUYXJnZXRbcXVlcnlEYXRhLnRhcmdldElkXSA9IHF1ZXJ5RGF0YTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeURhdGE7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVW5waW4gYWxsIHRoZSBkb2N1bWVudHMgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlbiBxdWVyeS4gSWZcclxuICAgICAqIGBrZWVwUGVyc2lzdGVkUXVlcnlEYXRhYCBpcyBzZXQgdG8gZmFsc2UgYW5kIEVhZ2VyIEdDIGVuYWJsZWQsIHRoZSBtZXRob2RcclxuICAgICAqIGRpcmVjdGx5IHJlbW92ZXMgdGhlIGFzc29jaWF0ZWQgcXVlcnkgZGF0YSBmcm9tIHRoZSBxdWVyeSBjYWNoZS5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBga2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YWAgaXMgbXVsdGktdGFiIG9ubHkuXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5yZWxlYXNlUXVlcnkgPSBmdW5jdGlvbiAocXVlcnksIGtlZXBQZXJzaXN0ZWRRdWVyeURhdGEpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBtb2RlID0ga2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YSA/ICdyZWFkd3JpdGUnIDogJ3JlYWR3cml0ZS1wcmltYXJ5JztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignUmVsZWFzZSBxdWVyeScsIG1vZGUsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5Q2FjaGVcclxuICAgICAgICAgICAgICAgIC5nZXRRdWVyeURhdGEodHhuLCBxdWVyeSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChxdWVyeURhdGEpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChxdWVyeURhdGEgIT0gbnVsbCwgJ1RyaWVkIHRvIHJlbGVhc2Ugbm9uZXhpc3RlbnQgcXVlcnk6ICcgKyBxdWVyeSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBxdWVyeURhdGEudGFyZ2V0SWQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2FjaGVkUXVlcnlEYXRhID0gX3RoaXMucXVlcnlEYXRhQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgLy8gUmVmZXJlbmNlcyBmb3IgZG9jdW1lbnRzIHNlbnQgdmlhIFdhdGNoIGFyZSBhdXRvbWF0aWNhbGx5IHJlbW92ZWQgd2hlbiB3ZSBkZWxldGUgYVxyXG4gICAgICAgICAgICAgICAgLy8gcXVlcnkncyB0YXJnZXQgZGF0YSBmcm9tIHRoZSByZWZlcmVuY2UgZGVsZWdhdGUuIFNpbmNlIHRoaXMgZG9lcyBub3QgcmVtb3ZlIHJlZmVyZW5jZXNcclxuICAgICAgICAgICAgICAgIC8vIGZvciBsb2NhbGx5IG11dGF0ZWQgZG9jdW1lbnRzLCB3ZSBoYXZlIHRvIHJlbW92ZSB0aGUgdGFyZ2V0IGFzc29jaWF0aW9ucyBmb3IgdGhlc2VcclxuICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50cyBtYW51YWxseS5cclxuICAgICAgICAgICAgICAgIHZhciByZW1vdmVkID0gX3RoaXMubG9jYWxWaWV3UmVmZXJlbmNlcy5yZW1vdmVSZWZlcmVuY2VzRm9ySWQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIF90aGlzLnF1ZXJ5RGF0YUJ5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgIGlmICgha2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaChyZW1vdmVkLCBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVSZWZlcmVuY2UodHhuLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlVGFyZ2V0KHR4biwgY2FjaGVkUXVlcnlEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJ1bnMgdGhlIHNwZWNpZmllZCBxdWVyeSBhZ2FpbnN0IGFsbCB0aGUgZG9jdW1lbnRzIGluIHRoZSBsb2NhbCBzdG9yZSBhbmRcclxuICAgICAqIHJldHVybnMgdGhlIHJlc3VsdHMuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmV4ZWN1dGVRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0V4ZWN1dGUgcXVlcnknLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHR4biwgcXVlcnkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUga2V5cyBvZiB0aGUgZG9jdW1lbnRzIHRoYXQgYXJlIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW5cclxuICAgICAqIHRhcmdldCBpZCBpbiB0aGUgcmVtb3RlIHRhYmxlLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5yZW1vdGVEb2N1bWVudEtleXMgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdSZW1vdGUgZG9jdW1lbnQga2V5cycsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnF1ZXJ5Q2FjaGUuZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQodHhuLCB0YXJnZXRJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmdldEFjdGl2ZUNsaWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuZ2V0QWN0aXZlQ2xpZW50cygpO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5yZW1vdmVDYWNoZWRNdXRhdGlvbkJhdGNoTWV0YWRhdGEgPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5yZW1vdmVDYWNoZWRNdXRhdGlvbktleXMoYmF0Y2hJZCk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLnNldE5ldHdvcmtFbmFibGVkID0gZnVuY3Rpb24gKG5ldHdvcmtFbmFibGVkKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZS5zZXROZXR3b3JrRW5hYmxlZChuZXR3b3JrRW5hYmxlZCk7XHJcbiAgICB9O1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuYXBwbHlXcml0ZVRvUmVtb3RlRG9jdW1lbnRzID0gZnVuY3Rpb24gKHR4biwgYmF0Y2hSZXN1bHQsIGRvY3VtZW50QnVmZmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgYmF0Y2ggPSBiYXRjaFJlc3VsdC5iYXRjaDtcclxuICAgICAgICB2YXIgZG9jS2V5cyA9IGJhdGNoLmtleXMoKTtcclxuICAgICAgICB2YXIgcHJvbWlzZUNoYWluID0gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICBkb2NLZXlzLmZvckVhY2goZnVuY3Rpb24gKGRvY0tleSkge1xyXG4gICAgICAgICAgICBwcm9taXNlQ2hhaW4gPSBwcm9taXNlQ2hhaW5cclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkb2N1bWVudEJ1ZmZlci5nZXRFbnRyeSh0eG4sIGRvY0tleSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAocmVtb3RlRG9jKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jID0gcmVtb3RlRG9jO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFja1ZlcnNpb24gPSBiYXRjaFJlc3VsdC5kb2NWZXJzaW9ucy5nZXQoZG9jS2V5KTtcclxuICAgICAgICAgICAgICAgIGFzc2VydChhY2tWZXJzaW9uICE9PSBudWxsLCAnYWNrVmVyc2lvbnMgc2hvdWxkIGNvbnRhaW4gZXZlcnkgZG9jIGluIHRoZSB3cml0ZS4nKTtcclxuICAgICAgICAgICAgICAgIGlmICghZG9jIHx8IGRvYy52ZXJzaW9uLmNvbXBhcmVUbyhhY2tWZXJzaW9uKSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBkb2MgPSBiYXRjaC5hcHBseVRvUmVtb3RlRG9jdW1lbnQoZG9jS2V5LCBkb2MsIGJhdGNoUmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWRvYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIXJlbW90ZURvYywgJ011dGF0aW9uIGJhdGNoICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2ggK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJyBhcHBsaWVkIHRvIGRvY3VtZW50ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRG9jICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgcmVzdWx0ZWQgaW4gbnVsbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRCdWZmZXIuYWRkRW50cnkoZG9jKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBwcm9taXNlQ2hhaW4ubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlLnJlbW92ZU11dGF0aW9uQmF0Y2godHhuLCBiYXRjaCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmdldFF1ZXJ5Rm9yVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5xdWVyeURhdGFCeVRhcmdldFt0YXJnZXRJZF0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnF1ZXJ5RGF0YUJ5VGFyZ2V0W3RhcmdldElkXS5xdWVyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignR2V0IHF1ZXJ5IGRhdGEnLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucXVlcnlDYWNoZVxyXG4gICAgICAgICAgICAgICAgICAgIC5nZXRRdWVyeURhdGFGb3JUYXJnZXQodHhuLCB0YXJnZXRJZClcclxuICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAocXVlcnlEYXRhKSB7IHJldHVybiAocXVlcnlEYXRhID8gcXVlcnlEYXRhLnF1ZXJ5IDogbnVsbCk7IH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmdldE5ld0RvY3VtZW50Q2hhbmdlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdHZXQgbmV3IGRvY3VtZW50IGNoYW5nZXMnLCAncmVhZG9ubHknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW1vdGVEb2N1bWVudHMuZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKHR4bik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbWF4aW11bSB0aW1lIHRvIGxlYXZlIGEgcmVzdW1lIHRva2VuIGJ1ZmZlcmVkIHdpdGhvdXQgd3JpdGluZyBpdCBvdXQuXHJcbiAgICAgKiBUaGlzIHZhbHVlIGlzIGFyYml0cmFyeTogaXQncyBsb25nIGVub3VnaCB0byBhdm9pZCBzZXZlcmFsIHdyaXRlc1xyXG4gICAgICogKHBvc3NpYmx5IGluZGVmaW5pdGVseSBpZiB1cGRhdGVzIGNvbWUgbW9yZSBmcmVxdWVudGx5IHRoYW4gdGhpcykgYnV0XHJcbiAgICAgKiBzaG9ydCBlbm91Z2ggdGhhdCByZXN0YXJ0aW5nIGFmdGVyIGNyYXNoaW5nIHdpbGwgc3RpbGwgaGF2ZSBhIHByZXR0eVxyXG4gICAgICogcmVjZW50IHJlc3VtZSB0b2tlbi5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5SRVNVTUVfVE9LRU5fTUFYX0FHRV9NSUNST1MgPSA1ICogNjAgKiAxZTY7XHJcbiAgICByZXR1cm4gTG9jYWxTdG9yZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBNZW1vcnlNdXRhdGlvblF1ZXVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVtb3J5TXV0YXRpb25RdWV1ZShyZWZlcmVuY2VEZWxlZ2F0ZSkge1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSByZWZlcmVuY2VEZWxlZ2F0ZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgc2V0IG9mIGFsbCBtdXRhdGlvbnMgdGhhdCBoYXZlIGJlZW4gc2VudCBidXQgbm90IHlldCBiZWVuIGFwcGxpZWQgdG9cclxuICAgICAgICAgKiB0aGUgYmFja2VuZC5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBbXTtcclxuICAgICAgICAvKiogTmV4dCB2YWx1ZSB0byB1c2Ugd2hlbiBhc3NpZ25pbmcgc2VxdWVudGlhbCBJRHMgdG8gZWFjaCBtdXRhdGlvbiBiYXRjaC4gKi9cclxuICAgICAgICB0aGlzLm5leHRCYXRjaElkID0gMTtcclxuICAgICAgICAvKiogVGhlIGhpZ2hlc3QgYWNrbm93bGVkZ2VkIG11dGF0aW9uIGluIHRoZSBxdWV1ZS4gKi9cclxuICAgICAgICB0aGlzLmhpZ2hlc3RBY2tub3dsZWRnZWRCYXRjaElkID0gQkFUQ0hJRF9VTktOT1dOO1xyXG4gICAgICAgIC8qKiBUaGUgbGFzdCByZWNlaXZlZCBzdHJlYW0gdG9rZW4gZnJvbSB0aGUgc2VydmVyLCB1c2VkIHRvIGFja25vd2xlZGdlIHdoaWNoXHJcbiAgICAgICAgICogcmVzcG9uc2VzIHRoZSBjbGllbnQgaGFzIHByb2Nlc3NlZC4gU3RyZWFtIHRva2VucyBhcmUgb3BhcXVlIGNoZWNrcG9pbnRcclxuICAgICAgICAgKiBtYXJrZXJzIHdob3NlIG9ubHkgcmVhbCB2YWx1ZSBpcyB0aGVpciBpbmNsdXNpb24gaW4gdGhlIG5leHQgcmVxdWVzdC5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IGVtcHR5Qnl0ZVN0cmluZygpO1xyXG4gICAgICAgIC8qKiBBbiBvcmRlcmVkIG1hcHBpbmcgYmV0d2VlbiBkb2N1bWVudHMgYW5kIHRoZSBtdXRhdGlvbnMgYmF0Y2ggSURzLiAqL1xyXG4gICAgICAgIHRoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXkgPSBuZXcgU29ydGVkU2V0KERvY1JlZmVyZW5jZS5jb21wYXJlQnlLZXkpO1xyXG4gICAgfVxyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuY2hlY2tFbXB0eSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoID09PSAwKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hY2tub3dsZWRnZUJhdGNoID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaCwgc3RyZWFtVG9rZW4pIHtcclxuICAgICAgICB2YXIgYmF0Y2hJZCA9IGJhdGNoLmJhdGNoSWQ7XHJcbiAgICAgICAgYXNzZXJ0KGJhdGNoSWQgPiB0aGlzLmhpZ2hlc3RBY2tub3dsZWRnZWRCYXRjaElkLCAnTXV0YXRpb24gYmF0Y2hJRHMgbXVzdCBiZSBhY2tub3dsZWRnZWQgaW4gb3JkZXInKTtcclxuICAgICAgICB2YXIgYmF0Y2hJbmRleCA9IHRoaXMuaW5kZXhPZkV4aXN0aW5nQmF0Y2hJZChiYXRjaElkLCAnYWNrbm93bGVkZ2VkJyk7XHJcbiAgICAgICAgYXNzZXJ0KGJhdGNoSW5kZXggPT09IDAsICdDYW4gb25seSBhY2tub3dsZWRnZSB0aGUgZmlyc3QgYmF0Y2ggaW4gdGhlIG11dGF0aW9uIHF1ZXVlJyk7XHJcbiAgICAgICAgLy8gVmVyaWZ5IHRoYXQgdGhlIGJhdGNoIGluIHRoZSBxdWV1ZSBpcyB0aGUgb25lIHRvIGJlIGFja25vd2xlZGdlZC5cclxuICAgICAgICB2YXIgY2hlY2sgPSB0aGlzLm11dGF0aW9uUXVldWVbYmF0Y2hJbmRleF07XHJcbiAgICAgICAgYXNzZXJ0KGJhdGNoSWQgPT09IGNoZWNrLmJhdGNoSWQsICdRdWV1ZSBvcmRlcmluZyBmYWlsdXJlOiBleHBlY3RlZCBiYXRjaCAnICtcclxuICAgICAgICAgICAgYmF0Y2hJZCArXHJcbiAgICAgICAgICAgICcsIGdvdCBiYXRjaCAnICtcclxuICAgICAgICAgICAgY2hlY2suYmF0Y2hJZCk7XHJcbiAgICAgICAgdGhpcy5oaWdoZXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCA9IGJhdGNoSWQ7XHJcbiAgICAgICAgdGhpcy5sYXN0U3RyZWFtVG9rZW4gPSBzdHJlYW1Ub2tlbjtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRMYXN0U3RyZWFtVG9rZW4gPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5sYXN0U3RyZWFtVG9rZW4pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLnNldExhc3RTdHJlYW1Ub2tlbiA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgc3RyZWFtVG9rZW4pIHtcclxuICAgICAgICB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHN0cmVhbVRva2VuO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmFkZE11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGxvY2FsV3JpdGVUaW1lLCBtdXRhdGlvbnMpIHtcclxuICAgICAgICBhc3NlcnQobXV0YXRpb25zLmxlbmd0aCAhPT0gMCwgJ011dGF0aW9uIGJhdGNoZXMgc2hvdWxkIG5vdCBiZSBlbXB0eScpO1xyXG4gICAgICAgIHZhciBiYXRjaElkID0gdGhpcy5uZXh0QmF0Y2hJZDtcclxuICAgICAgICB0aGlzLm5leHRCYXRjaElkKys7XHJcbiAgICAgICAgaWYgKHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBwcmlvciA9IHRoaXMubXV0YXRpb25RdWV1ZVt0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGFzc2VydChwcmlvci5iYXRjaElkIDwgYmF0Y2hJZCwgJ011dGF0aW9uIGJhdGNoSURzIG11c3QgYmUgbW9ub3RvbmljYWxseSBpbmNyZWFzaW5nIG9yZGVyJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBiYXRjaCA9IG5ldyBNdXRhdGlvbkJhdGNoKGJhdGNoSWQsIGxvY2FsV3JpdGVUaW1lLCBtdXRhdGlvbnMpO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5wdXNoKGJhdGNoKTtcclxuICAgICAgICAvLyBUcmFjayByZWZlcmVuY2VzIGJ5IGRvY3VtZW50IGtleS5cclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIG11dGF0aW9uc18xID0gbXV0YXRpb25zOyBfaSA8IG11dGF0aW9uc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgbXV0YXRpb24gPSBtdXRhdGlvbnNfMVtfaV07XHJcbiAgICAgICAgICAgIHRoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXkgPSB0aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5LmFkZChuZXcgRG9jUmVmZXJlbmNlKG11dGF0aW9uLmtleSwgYmF0Y2hJZCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoYmF0Y2gpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmxvb2t1cE11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoSWQpIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5maW5kTXV0YXRpb25CYXRjaChiYXRjaElkKSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUubG9va3VwTXV0YXRpb25LZXlzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uQmF0Y2ggPSB0aGlzLmZpbmRNdXRhdGlvbkJhdGNoKGJhdGNoSWQpO1xyXG4gICAgICAgIGFzc2VydChtdXRhdGlvbkJhdGNoICE9IG51bGwsICdGYWlsZWQgdG8gZmluZCBsb2NhbCBtdXRhdGlvbiBiYXRjaC4nKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUobXV0YXRpb25CYXRjaC5rZXlzKCkpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaElkKSB7XHJcbiAgICAgICAgLy8gQWxsIGJhdGNoZXMgd2l0aCBiYXRjaElkIDw9IHRoaXMuaGlnaGVzdEFja25vd2xlZGdlZEJhdGNoSWQgaGF2ZSBiZWVuXHJcbiAgICAgICAgLy8gYWNrbm93bGVkZ2VkIHNvIHRoZSBmaXJzdCB1bmFja25vd2xlZGdlZCBiYXRjaCBhZnRlciBiYXRjaElEIHdpbGwgaGF2ZSBhXHJcbiAgICAgICAgLy8gYmF0Y2hJRCBsYXJnZXIgdGhhbiBib3RoIG9mIHRoZXNlIHZhbHVlcy5cclxuICAgICAgICB2YXIgbmV4dEJhdGNoSWQgPSBNYXRoLm1heChiYXRjaElkLCB0aGlzLmhpZ2hlc3RBY2tub3dsZWRnZWRCYXRjaElkKSArIDE7XHJcbiAgICAgICAgLy8gVGhlIHJlcXVlc3RlZCBiYXRjaElkIG1heSBzdGlsbCBiZSBvdXQgb2YgcmFuZ2Ugc28gbm9ybWFsaXplIGl0IHRvIHRoZVxyXG4gICAgICAgIC8vIHN0YXJ0IG9mIHRoZSBxdWV1ZS5cclxuICAgICAgICB2YXIgcmF3SW5kZXggPSB0aGlzLmluZGV4T2ZCYXRjaElkKG5leHRCYXRjaElkKTtcclxuICAgICAgICB2YXIgaW5kZXggPSByYXdJbmRleCA8IDAgPyAwIDogcmF3SW5kZXg7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGggPiBpbmRleCA/IHRoaXMubXV0YXRpb25RdWV1ZVtpbmRleF0gOiBudWxsKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5tdXRhdGlvblF1ZXVlLnNsaWNlKCkpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHN0YXJ0ID0gbmV3IERvY1JlZmVyZW5jZShkb2N1bWVudEtleSwgMCk7XHJcbiAgICAgICAgdmFyIGVuZCA9IG5ldyBEb2NSZWZlcmVuY2UoZG9jdW1lbnRLZXksIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSk7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIHRoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXkuZm9yRWFjaEluUmFuZ2UoW3N0YXJ0LCBlbmRdLCBmdW5jdGlvbiAocmVmKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChkb2N1bWVudEtleS5pc0VxdWFsKHJlZi5rZXkpLCBcIlNob3VsZCBvbmx5IGl0ZXJhdGUgb3ZlciBhIHNpbmdsZSBrZXkncyBiYXRjaGVzXCIpO1xyXG4gICAgICAgICAgICB2YXIgYmF0Y2ggPSBfdGhpcy5maW5kTXV0YXRpb25CYXRjaChyZWYudGFyZ2V0T3JCYXRjaElkKTtcclxuICAgICAgICAgICAgYXNzZXJ0KGJhdGNoICE9PSBudWxsLCAnQmF0Y2hlcyBpbiB0aGUgaW5kZXggbXVzdCBleGlzdCBpbiB0aGUgbWFpbiB0YWJsZScpO1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChiYXRjaCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciB1bmlxdWVCYXRjaElEcyA9IG5ldyBTb3J0ZWRTZXQocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbiAgICAgICAgZG9jdW1lbnRLZXlzLmZvckVhY2goZnVuY3Rpb24gKGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgICAgIHZhciBzdGFydCA9IG5ldyBEb2NSZWZlcmVuY2UoZG9jdW1lbnRLZXksIDApO1xyXG4gICAgICAgICAgICB2YXIgZW5kID0gbmV3IERvY1JlZmVyZW5jZShkb2N1bWVudEtleSwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKTtcclxuICAgICAgICAgICAgX3RoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXkuZm9yRWFjaEluUmFuZ2UoW3N0YXJ0LCBlbmRdLCBmdW5jdGlvbiAocmVmKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoZG9jdW1lbnRLZXkuaXNFcXVhbChyZWYua2V5KSwgXCJGb3IgZWFjaCBrZXksIHNob3VsZCBvbmx5IGl0ZXJhdGUgb3ZlciBhIHNpbmdsZSBrZXkncyBiYXRjaGVzXCIpO1xyXG4gICAgICAgICAgICAgICAgdW5pcXVlQmF0Y2hJRHMgPSB1bmlxdWVCYXRjaElEcy5hZGQocmVmLnRhcmdldE9yQmF0Y2hJZCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLmZpbmRNdXRhdGlvbkJhdGNoZXModW5pcXVlQmF0Y2hJRHMpKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnkpIHtcclxuICAgICAgICAvLyBVc2UgdGhlIHF1ZXJ5IHBhdGggYXMgYSBwcmVmaXggZm9yIHRlc3RpbmcgaWYgYSBkb2N1bWVudCBtYXRjaGVzIHRoZVxyXG4gICAgICAgIC8vIHF1ZXJ5LlxyXG4gICAgICAgIHZhciBwcmVmaXggPSBxdWVyeS5wYXRoO1xyXG4gICAgICAgIHZhciBpbW1lZGlhdGVDaGlsZHJlblBhdGhMZW5ndGggPSBwcmVmaXgubGVuZ3RoICsgMTtcclxuICAgICAgICAvLyBDb25zdHJ1Y3QgYSBkb2N1bWVudCByZWZlcmVuY2UgZm9yIGFjdHVhbGx5IHNjYW5uaW5nIHRoZSBpbmRleC4gVW5saWtlXHJcbiAgICAgICAgLy8gdGhlIHByZWZpeCB0aGUgZG9jdW1lbnQga2V5IGluIHRoaXMgcmVmZXJlbmNlIG11c3QgaGF2ZSBhbiBldmVuIG51bWJlciBvZlxyXG4gICAgICAgIC8vIHNlZ21lbnRzLiBUaGUgZW1wdHkgc2VnbWVudCBjYW4gYmUgdXNlZCBhIHN1ZmZpeCBvZiB0aGUgcXVlcnkgcGF0aFxyXG4gICAgICAgIC8vIGJlY2F1c2UgaXQgcHJlY2VkZXMgYWxsIG90aGVyIHNlZ21lbnRzIGluIGFuIG9yZGVyZWQgdHJhdmVyc2FsLlxyXG4gICAgICAgIHZhciBzdGFydFBhdGggPSBwcmVmaXg7XHJcbiAgICAgICAgaWYgKCFEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5KHN0YXJ0UGF0aCkpIHtcclxuICAgICAgICAgICAgc3RhcnRQYXRoID0gc3RhcnRQYXRoLmNoaWxkKCcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHN0YXJ0ID0gbmV3IERvY1JlZmVyZW5jZShuZXcgRG9jdW1lbnRLZXkoc3RhcnRQYXRoKSwgMCk7XHJcbiAgICAgICAgLy8gRmluZCB1bmlxdWUgYmF0Y2hJRHMgcmVmZXJlbmNlZCBieSBhbGwgZG9jdW1lbnRzIHBvdGVudGlhbGx5IG1hdGNoaW5nIHRoZVxyXG4gICAgICAgIC8vIHF1ZXJ5LlxyXG4gICAgICAgIHZhciB1bmlxdWVCYXRjaElEcyA9IG5ldyBTb3J0ZWRTZXQocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbiAgICAgICAgdGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleS5mb3JFYWNoV2hpbGUoZnVuY3Rpb24gKHJlZikge1xyXG4gICAgICAgICAgICB2YXIgcm93S2V5UGF0aCA9IHJlZi5rZXkucGF0aDtcclxuICAgICAgICAgICAgaWYgKCFwcmVmaXguaXNQcmVmaXhPZihyb3dLZXlQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gUm93cyB3aXRoIGRvY3VtZW50IGtleXMgbW9yZSB0aGFuIG9uZSBzZWdtZW50IGxvbmdlciB0aGFuIHRoZSBxdWVyeVxyXG4gICAgICAgICAgICAgICAgLy8gcGF0aCBjYW4ndCBiZSBtYXRjaGVzLiBGb3IgZXhhbXBsZSwgYSBxdWVyeSBvbiAncm9vbXMnIGNhbid0IG1hdGNoXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgZG9jdW1lbnQgL3Jvb21zL2FiYy9tZXNzYWdlcy94eXguXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKG1jZyk6IHdlJ2xsIG5lZWQgYSBkaWZmZXJlbnQgc2Nhbm5lciB3aGVuIHdlIGltcGxlbWVudFxyXG4gICAgICAgICAgICAgICAgLy8gYW5jZXN0b3IgcXVlcmllcy5cclxuICAgICAgICAgICAgICAgIGlmIChyb3dLZXlQYXRoLmxlbmd0aCA9PT0gaW1tZWRpYXRlQ2hpbGRyZW5QYXRoTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlQmF0Y2hJRHMgPSB1bmlxdWVCYXRjaElEcy5hZGQocmVmLnRhcmdldE9yQmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHN0YXJ0KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5maW5kTXV0YXRpb25CYXRjaGVzKHVuaXF1ZUJhdGNoSURzKSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZmluZE11dGF0aW9uQmF0Y2hlcyA9IGZ1bmN0aW9uIChiYXRjaElEcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gQ29uc3RydWN0IGFuIGFycmF5IG9mIG1hdGNoaW5nIGJhdGNoZXMsIHNvcnRlZCBieSBiYXRjaElEIHRvIGVuc3VyZSB0aGF0XHJcbiAgICAgICAgLy8gbXVsdGlwbGUgbXV0YXRpb25zIGFmZmVjdGluZyB0aGUgc2FtZSBkb2N1bWVudCBrZXkgYXJlIGFwcGxpZWQgaW4gb3JkZXIuXHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGJhdGNoSURzLmZvckVhY2goZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICAgICAgdmFyIGJhdGNoID0gX3RoaXMuZmluZE11dGF0aW9uQmF0Y2goYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgIGlmIChiYXRjaCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goYmF0Y2gpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5yZW1vdmVNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBiYXRjaCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gRmluZCB0aGUgcG9zaXRpb24gb2YgdGhlIGZpcnN0IGJhdGNoIGZvciByZW1vdmFsLiBUaGlzIG5lZWQgbm90IGJlIHRoZVxyXG4gICAgICAgIC8vIGZpcnN0IGVudHJ5IGluIHRoZSBxdWV1ZS5cclxuICAgICAgICB2YXIgYmF0Y2hJbmRleCA9IHRoaXMuaW5kZXhPZkV4aXN0aW5nQmF0Y2hJZChiYXRjaC5iYXRjaElkLCAncmVtb3ZlZCcpO1xyXG4gICAgICAgIGFzc2VydChiYXRjaEluZGV4ID09PSAwLCAnQ2FuIG9ubHkgcmVtb3ZlIHRoZSBmaXJzdCBlbnRyeSBvZiB0aGUgbXV0YXRpb24gcXVldWUnKTtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUuc2hpZnQoKTtcclxuICAgICAgICB2YXIgcmVmZXJlbmNlcyA9IHRoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKGJhdGNoLm11dGF0aW9ucywgZnVuY3Rpb24gKG11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciByZWYgPSBuZXcgRG9jUmVmZXJlbmNlKG11dGF0aW9uLmtleSwgYmF0Y2guYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgIHJlZmVyZW5jZXMgPSByZWZlcmVuY2VzLmRlbGV0ZShyZWYpO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlTXV0YXRpb25SZWZlcmVuY2UodHJhbnNhY3Rpb24sIG11dGF0aW9uLmtleSk7XHJcbiAgICAgICAgfSkubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5ID0gcmVmZXJlbmNlcztcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5yZW1vdmVDYWNoZWRNdXRhdGlvbktleXMgPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIC8vIE5vLW9wIHNpbmNlIHRoZSBtZW1vcnkgbXV0YXRpb24gcXVldWUgZG9lcyBub3QgbWFpbnRhaW4gYSBzZXBhcmF0ZSBjYWNoZS5cclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5jb250YWluc0tleSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHZhciByZWYgPSBuZXcgRG9jUmVmZXJlbmNlKGtleSwgMCk7XHJcbiAgICAgICAgdmFyIGZpcnN0UmVmID0gdGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleS5maXJzdEFmdGVyT3JFcXVhbChyZWYpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShrZXkuaXNFcXVhbChmaXJzdFJlZiAmJiBmaXJzdFJlZi5rZXkpKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5wZXJmb3JtQ29uc2lzdGVuY3lDaGVjayA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICBpZiAodGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleS5pc0VtcHR5KCksICdEb2N1bWVudCBsZWFrIC0tIGRldGVjdGVkIGRhbmdsaW5nIG11dGF0aW9uIHJlZmVyZW5jZXMgd2hlbiBxdWV1ZSBpcyBlbXB0eS4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5kcyB0aGUgaW5kZXggb2YgdGhlIGdpdmVuIGJhdGNoSWQgaW4gdGhlIG11dGF0aW9uIHF1ZXVlIGFuZCBhc3NlcnRzIHRoYXRcclxuICAgICAqIHRoZSByZXN1bHRpbmcgaW5kZXggaXMgd2l0aGluIHRoZSBib3VuZHMgb2YgdGhlIHF1ZXVlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBiYXRjaElkIFRoZSBiYXRjaElkIHRvIHNlYXJjaCBmb3JcclxuICAgICAqIEBwYXJhbSBhY3Rpb24gQSBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoZSBjYWxsZXIgaXMgZG9pbmcsIHBocmFzZWQgaW4gcGFzc2l2ZVxyXG4gICAgICogZm9ybSAoZS5nLiBcImFja25vd2xlZGdlZFwiIGluIGEgcm91dGluZSB0aGF0IGFja25vd2xlZGdlcyBiYXRjaGVzKS5cclxuICAgICAqL1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuaW5kZXhPZkV4aXN0aW5nQmF0Y2hJZCA9IGZ1bmN0aW9uIChiYXRjaElkLCBhY3Rpb24pIHtcclxuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmluZGV4T2ZCYXRjaElkKGJhdGNoSWQpO1xyXG4gICAgICAgIGFzc2VydChpbmRleCA+PSAwICYmIGluZGV4IDwgdGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCwgJ0JhdGNoZXMgbXVzdCBleGlzdCB0byBiZSAnICsgYWN0aW9uKTtcclxuICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5kcyB0aGUgaW5kZXggb2YgdGhlIGdpdmVuIGJhdGNoSWQgaW4gdGhlIG11dGF0aW9uIHF1ZXVlLiBUaGlzIG9wZXJhdGlvblxyXG4gICAgICogaXMgTygxKS5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBjb21wdXRlZCBpbmRleCBvZiB0aGUgYmF0Y2ggd2l0aCB0aGUgZ2l2ZW4gYmF0Y2hJZCwgYmFzZWQgb25cclxuICAgICAqIHRoZSBzdGF0ZSBvZiB0aGUgcXVldWUuIE5vdGUgdGhpcyBpbmRleCBjYW4gYmUgbmVnYXRpdmUgaWYgdGhlIHJlcXVlc3RlZFxyXG4gICAgICogYmF0Y2hJZCBoYXMgYWxyZWFkeSBiZWVuIHJlbXZvZWQgZnJvbSB0aGUgcXVldWUgb3IgcGFzdCB0aGUgZW5kIG9mIHRoZVxyXG4gICAgICogcXVldWUgaWYgdGhlIGJhdGNoSWQgaXMgbGFyZ2VyIHRoYW4gdGhlIGxhc3QgYWRkZWQgYmF0Y2guXHJcbiAgICAgKi9cclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmluZGV4T2ZCYXRjaElkID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICBpZiAodGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAvLyBBcyBhbiBpbmRleCB0aGlzIGlzIHBhc3QgdGhlIGVuZCBvZiB0aGUgcXVldWVcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEV4YW1pbmUgdGhlIGZyb250IG9mIHRoZSBxdWV1ZSB0byBmaWd1cmUgb3V0IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlXHJcbiAgICAgICAgLy8gYmF0Y2hJZCBhbmQgaW5kZXhlcyBpbiB0aGUgYXJyYXkuIE5vdGUgdGhhdCBzaW5jZSB0aGUgcXVldWUgaXMgb3JkZXJlZFxyXG4gICAgICAgIC8vIGJ5IGJhdGNoSWQsIGlmIHRoZSBmaXJzdCBiYXRjaCBoYXMgYSBsYXJnZXIgYmF0Y2hJZCB0aGVuIHRoZSByZXF1ZXN0ZWRcclxuICAgICAgICAvLyBiYXRjaElkIGRvZXNuJ3QgZXhpc3QgaW4gdGhlIHF1ZXVlLlxyXG4gICAgICAgIHZhciBmaXJzdEJhdGNoSWQgPSB0aGlzLm11dGF0aW9uUXVldWVbMF0uYmF0Y2hJZDtcclxuICAgICAgICByZXR1cm4gYmF0Y2hJZCAtIGZpcnN0QmF0Y2hJZDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEEgdmVyc2lvbiBvZiBsb29rdXBNdXRhdGlvbkJhdGNoIHRoYXQgZG9lc24ndCByZXR1cm4gYSBwcm9taXNlLCB0aGlzIG1ha2VzXHJcbiAgICAgKiBvdGhlciBmdW5jdGlvbnMgdGhhdCB1c2VzIHRoaXMgY29kZSBlYXNpZXIgdG8gcmVhZCBhbmQgbW9yZSBlZmZpY2VudC5cclxuICAgICAqL1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZmluZE11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXhPZkJhdGNoSWQoYmF0Y2hJZCk7XHJcbiAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYmF0Y2ggPSB0aGlzLm11dGF0aW9uUXVldWVbaW5kZXhdO1xyXG4gICAgICAgIGFzc2VydChiYXRjaC5iYXRjaElkID09PSBiYXRjaElkLCAnSWYgZm91bmQgYmF0Y2ggbXVzdCBtYXRjaCcpO1xyXG4gICAgICAgIHJldHVybiBiYXRjaDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWVtb3J5TXV0YXRpb25RdWV1ZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBNZW1vcnlRdWVyeUNhY2hlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVtb3J5UXVlcnlDYWNoZShwZXJzaXN0ZW5jZSkge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSBwZXJzaXN0ZW5jZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBNYXBzIGEgcXVlcnkgdG8gdGhlIGRhdGEgYWJvdXQgdGhhdCBxdWVyeVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucXVlcmllcyA9IG5ldyBPYmplY3RNYXAoZnVuY3Rpb24gKHEpIHsgcmV0dXJuIHEuY2Fub25pY2FsSWQoKTsgfSk7XHJcbiAgICAgICAgLyoqIFRoZSBsYXN0IHJlY2VpdmVkIHNuYXBzaG90IHZlcnNpb24uICovXHJcbiAgICAgICAgdGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gU25hcHNob3RWZXJzaW9uLk1JTjtcclxuICAgICAgICAvKiogVGhlIGhpZ2hlc3QgbnVtYmVyZWQgdGFyZ2V0IElEIGVuY291bnRlcmVkLiAqL1xyXG4gICAgICAgIHRoaXMuaGlnaGVzdFRhcmdldElkID0gMDtcclxuICAgICAgICAvKiogVGhlIGhpZ2hlc3Qgc2VxdWVuY2UgbnVtYmVyIGVuY291bnRlcmVkLiAqL1xyXG4gICAgICAgIHRoaXMuaGlnaGVzdFNlcXVlbmNlTnVtYmVyID0gMDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIG9yZGVyZWQgYmlkaXJlY3Rpb25hbCBtYXBwaW5nIGJldHdlZW4gZG9jdW1lbnRzIGFuZCB0aGUgcmVtb3RlIHRhcmdldFxyXG4gICAgICAgICAqIElEcy5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnJlZmVyZW5jZXMgPSBuZXcgUmVmZXJlbmNlU2V0KCk7XHJcbiAgICAgICAgdGhpcy50YXJnZXRDb3VudCA9IDA7XHJcbiAgICAgICAgdGhpcy50YXJnZXRJZEdlbmVyYXRvciA9IFRhcmdldElkR2VuZXJhdG9yLmZvclF1ZXJ5Q2FjaGUoKTtcclxuICAgIH1cclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldFRhcmdldENvdW50ID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLnRhcmdldENvdW50KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5mb3JFYWNoVGFyZ2V0ID0gZnVuY3Rpb24gKHR4biwgZikge1xyXG4gICAgICAgIHRoaXMucXVlcmllcy5mb3JFYWNoKGZ1bmN0aW9uIChfLCBxdWVyeURhdGEpIHsgcmV0dXJuIGYocXVlcnlEYXRhKTsgfSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldEhpZ2hlc3RTZXF1ZW5jZU51bWJlciA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLmhpZ2hlc3RTZXF1ZW5jZU51bWJlcik7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuYWxsb2NhdGVUYXJnZXRJZCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBuZXh0VGFyZ2V0SWQgPSB0aGlzLnRhcmdldElkR2VuZXJhdG9yLmFmdGVyKHRoaXMuaGlnaGVzdFRhcmdldElkKTtcclxuICAgICAgICB0aGlzLmhpZ2hlc3RUYXJnZXRJZCA9IG5leHRUYXJnZXRJZDtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUobmV4dFRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5zZXRUYXJnZXRzTWV0YWRhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciwgbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbikge1xyXG4gICAgICAgIGlmIChsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPiB0aGlzLmhpZ2hlc3RTZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICB0aGlzLmhpZ2hlc3RTZXF1ZW5jZU51bWJlciA9IGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuc2F2ZVF1ZXJ5RGF0YSA9IGZ1bmN0aW9uIChxdWVyeURhdGEpIHtcclxuICAgICAgICB0aGlzLnF1ZXJpZXMuc2V0KHF1ZXJ5RGF0YS5xdWVyeSwgcXVlcnlEYXRhKTtcclxuICAgICAgICB2YXIgdGFyZ2V0SWQgPSBxdWVyeURhdGEudGFyZ2V0SWQ7XHJcbiAgICAgICAgaWYgKHRhcmdldElkID4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSB0YXJnZXRJZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHF1ZXJ5RGF0YS5zZXF1ZW5jZU51bWJlciA+IHRoaXMuaGlnaGVzdFNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlnaGVzdFNlcXVlbmNlTnVtYmVyID0gcXVlcnlEYXRhLnNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5hZGRRdWVyeURhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5xdWVyaWVzLmhhcyhxdWVyeURhdGEucXVlcnkpLCAnQWRkaW5nIGEgcXVlcnkgdGhhdCBhbHJlYWR5IGV4aXN0cycpO1xyXG4gICAgICAgIHRoaXMuc2F2ZVF1ZXJ5RGF0YShxdWVyeURhdGEpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0Q291bnQgKz0gMTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS51cGRhdGVRdWVyeURhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnF1ZXJpZXMuaGFzKHF1ZXJ5RGF0YS5xdWVyeSksICdVcGRhdGluZyBhIG5vbi1leGlzdGVudCBxdWVyeScpO1xyXG4gICAgICAgIHRoaXMuc2F2ZVF1ZXJ5RGF0YShxdWVyeURhdGEpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLnJlbW92ZVF1ZXJ5RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMudGFyZ2V0Q291bnQgPiAwLCAnUmVtb3ZpbmcgYSB0YXJnZXQgZnJvbSBhbiBlbXB0eSBjYWNoZScpO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnF1ZXJpZXMuaGFzKHF1ZXJ5RGF0YS5xdWVyeSksICdSZW1vdmluZyBhIG5vbi1leGlzdGVudCB0YXJnZXQgZnJvbSB0aGUgY2FjaGUnKTtcclxuICAgICAgICB0aGlzLnF1ZXJpZXMuZGVsZXRlKHF1ZXJ5RGF0YS5xdWVyeSk7XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VzLnJlbW92ZVJlZmVyZW5jZXNGb3JJZChxdWVyeURhdGEudGFyZ2V0SWQpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0Q291bnQgLT0gMTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5yZW1vdmVUYXJnZXRzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCB1cHBlckJvdW5kLCBhY3RpdmVUYXJnZXRJZHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgICAgdmFyIHJlbW92YWxzID0gW107XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzLmZvckVhY2goZnVuY3Rpb24gKGtleSwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgICAgIGlmIChxdWVyeURhdGEuc2VxdWVuY2VOdW1iZXIgPD0gdXBwZXJCb3VuZCAmJlxyXG4gICAgICAgICAgICAgICAgIWFjdGl2ZVRhcmdldElkc1txdWVyeURhdGEudGFyZ2V0SWRdKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5xdWVyaWVzLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZhbHMucHVzaChfdGhpcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhLnRhcmdldElkKSk7XHJcbiAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHJlbW92YWxzKS5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNvdW50OyB9KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRRdWVyeUNvdW50ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMudGFyZ2V0Q291bnQpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldFF1ZXJ5RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnkpIHtcclxuICAgICAgICB2YXIgcXVlcnlEYXRhID0gdGhpcy5xdWVyaWVzLmdldChxdWVyeSkgfHwgbnVsbDtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUocXVlcnlEYXRhKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRRdWVyeURhdGFGb3JUYXJnZXQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHRhcmdldElkKSB7XHJcbiAgICAgICAgLy8gVGhpcyBtZXRob2QgaXMgb25seSBuZWVkZWQgZm9yIG11bHRpLXRhYiBhbmQgd2UgY2FuJ3QgaW1wbGVtZW50IGl0XHJcbiAgICAgICAgLy8gZWZmaWNpZW50bHkgd2l0aG91dCBhZGRpdGlvbmFsIGRhdGEgc3RydWN0dXJlcy5cclxuICAgICAgICByZXR1cm4gZmFpbCgnTm90IHlldCBpbXBsZW1lbnRlZC4nKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5hZGRNYXRjaGluZ0tleXMgPSBmdW5jdGlvbiAodHhuLCBrZXlzLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlcy5hZGRSZWZlcmVuY2VzKGtleXMsIHRhcmdldElkKTtcclxuICAgICAgICB2YXIgcmVmZXJlbmNlRGVsZWdhdGUgPSB0aGlzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlO1xyXG4gICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIGlmIChyZWZlcmVuY2VEZWxlZ2F0ZSkge1xyXG4gICAgICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChyZWZlcmVuY2VEZWxlZ2F0ZS5hZGRSZWZlcmVuY2UodHhuLCBrZXkpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcyk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUucmVtb3ZlTWF0Y2hpbmdLZXlzID0gZnVuY3Rpb24gKHR4biwga2V5cywgdGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLnJlZmVyZW5jZXMucmVtb3ZlUmVmZXJlbmNlcyhrZXlzLCB0YXJnZXRJZCk7XHJcbiAgICAgICAgdmFyIHJlZmVyZW5jZURlbGVnYXRlID0gdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZTtcclxuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICBpZiAocmVmZXJlbmNlRGVsZWdhdGUpIHtcclxuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2gocmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlUmVmZXJlbmNlKHR4biwga2V5KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkID0gZnVuY3Rpb24gKHR4biwgdGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLnJlZmVyZW5jZXMucmVtb3ZlUmVmZXJlbmNlc0ZvcklkKHRhcmdldElkKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCA9IGZ1bmN0aW9uICh0eG4sIHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIG1hdGNoaW5nS2V5cyA9IHRoaXMucmVmZXJlbmNlcy5yZWZlcmVuY2VzRm9ySWQodGFyZ2V0SWQpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShtYXRjaGluZ0tleXMpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmNvbnRhaW5zS2V5ID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMucmVmZXJlbmNlcy5jb250YWluc0tleShrZXkpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWVtb3J5UXVlcnlDYWNoZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGRvY3VtZW50U2l6ZU1hcCgpIHtcclxuICAgIHJldHVybiBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG59XHJcbnZhciBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gc2l6ZXIgVXNlZCB0byBhc3Nlc3MgdGhlIHNpemUgb2YgYSBkb2N1bWVudC4gRm9yIGVhZ2VyIEdDLCB0aGlzIGlzIGV4cGVjdGVkIHRvIGp1c3RcclxuICAgICAqIHJldHVybiAwIHRvIGF2b2lkIHVubmVjZXNzYXJpbHkgZG9pbmcgdGhlIHdvcmsgb2YgY2FsY3VsYXRpbmcgdGhlIHNpemUuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUoc2l6ZXIpIHtcclxuICAgICAgICB0aGlzLnNpemVyID0gc2l6ZXI7XHJcbiAgICAgICAgdGhpcy5kb2NzID0gZG9jdW1lbnRTaXplTWFwKCk7XHJcbiAgICAgICAgdGhpcy5uZXdEb2N1bWVudENoYW5nZXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHRoaXMuc2l6ZSA9IDA7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgdGhlIHN1cHBsaWVkIGVudHJpZXMgdG8gdGhlIGNhY2hlLiBBZGRzIHRoZSBnaXZlbiBzaXplIGRlbHRhIHRvIHRoZSBjYWNoZWQgc2l6ZS5cclxuICAgICAqL1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuYWRkRW50cmllcyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZW50cmllcywgc2l6ZURlbHRhKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBlbnRyaWVzXzEgPSBlbnRyaWVzOyBfaSA8IGVudHJpZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGVudHJ5ID0gZW50cmllc18xW19pXTtcclxuICAgICAgICAgICAgdmFyIGtleSA9IGVudHJ5Lm1heWJlRG9jdW1lbnQua2V5O1xyXG4gICAgICAgICAgICB0aGlzLmRvY3MgPSB0aGlzLmRvY3MuaW5zZXJ0KGtleSwgZW50cnkpO1xyXG4gICAgICAgICAgICB0aGlzLm5ld0RvY3VtZW50Q2hhbmdlcyA9IHRoaXMubmV3RG9jdW1lbnRDaGFuZ2VzLmFkZChrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNpemUgKz0gc2l6ZURlbHRhO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyB0aGUgc3BlY2lmaWVkIGVudHJ5IGZyb20gdGhlIGNhY2hlIGFuZCB1cGRhdGVzIHRoZSBzaXplIGFzIGFwcHJvcHJpYXRlLlxyXG4gICAgICovXHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5yZW1vdmVFbnRyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLmRvY3MuZ2V0KGRvY3VtZW50S2V5KTtcclxuICAgICAgICBpZiAoZW50cnkpIHtcclxuICAgICAgICAgICAgdGhpcy5kb2NzID0gdGhpcy5kb2NzLnJlbW92ZShkb2N1bWVudEtleSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2l6ZSAtPSBlbnRyeS5zaXplO1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoZW50cnkuc2l6ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldEVudHJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMuZG9jcy5nZXQoZG9jdW1lbnRLZXkpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShlbnRyeSA/IGVudHJ5Lm1heWJlRG9jdW1lbnQgOiBudWxsKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIExvb2tzIHVwIGFuIGVudHJ5IGluIHRoZSBjYWNoZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXkgVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gbG9vayB1cC5cclxuICAgICAqIEByZXR1cm4gVGhlIGNhY2hlZCBNYXliZURvY3VtZW50IGVudHJ5IGFuZCBpdHMgc2l6ZSwgb3IgbnVsbCBpZiB3ZSBoYXZlIG5vdGhpbmcgY2FjaGVkLlxyXG4gICAgICovXHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXRTaXplZEVudHJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLmRvY3MuZ2V0KGRvY3VtZW50S2V5KSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnkpIHtcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IGRvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgLy8gRG9jdW1lbnRzIGFyZSBvcmRlcmVkIGJ5IGtleSwgc28gd2UgY2FuIHVzZSBhIHByZWZpeCBzY2FuIHRvIG5hcnJvdyBkb3duXHJcbiAgICAgICAgLy8gdGhlIGRvY3VtZW50cyB3ZSBuZWVkIHRvIG1hdGNoIHRoZSBxdWVyeSBhZ2FpbnN0LlxyXG4gICAgICAgIHZhciBwcmVmaXggPSBuZXcgRG9jdW1lbnRLZXkocXVlcnkucGF0aC5jaGlsZCgnJykpO1xyXG4gICAgICAgIHZhciBpdGVyYXRvciA9IHRoaXMuZG9jcy5nZXRJdGVyYXRvckZyb20ocHJlZml4KTtcclxuICAgICAgICB3aGlsZSAoaXRlcmF0b3IuaGFzTmV4dCgpKSB7XHJcbiAgICAgICAgICAgIHZhciBfYSA9IGl0ZXJhdG9yLmdldE5leHQoKSwga2V5ID0gX2Eua2V5LCBtYXliZURvY3VtZW50ID0gX2EudmFsdWUubWF5YmVEb2N1bWVudDtcclxuICAgICAgICAgICAgaWYgKCFxdWVyeS5wYXRoLmlzUHJlZml4T2Yoa2V5LnBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobWF5YmVEb2N1bWVudCBpbnN0YW5jZW9mIERvY3VtZW50ICYmIHF1ZXJ5Lm1hdGNoZXMobWF5YmVEb2N1bWVudCkpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmluc2VydChtYXliZURvY3VtZW50LmtleSwgbWF5YmVEb2N1bWVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHJlc3VsdHMpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmZvckVhY2hEb2N1bWVudEtleSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0aGlzLmRvY3MsIGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIGYoa2V5KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY2hhbmdlZERvY3MgPSBtYXliZURvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgdGhpcy5uZXdEb2N1bWVudENoYW5nZXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIHZhciBlbnRyeSA9IF90aGlzLmRvY3MuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkRG9jID0gZW50cnlcclxuICAgICAgICAgICAgICAgID8gZW50cnkubWF5YmVEb2N1bWVudFxyXG4gICAgICAgICAgICAgICAgOiBuZXcgTm9Eb2N1bWVudChrZXksIFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCkpO1xyXG4gICAgICAgICAgICBjaGFuZ2VkRG9jcyA9IGNoYW5nZWREb2NzLmluc2VydChrZXksIGNoYW5nZWREb2MpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubmV3RG9jdW1lbnRDaGFuZ2VzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoY2hhbmdlZERvY3MpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLm5ld0NoYW5nZUJ1ZmZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyKHRoaXMuc2l6ZXIsIHRoaXMpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuc2l6ZSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBIYW5kbGVzIHRoZSBkZXRhaWxzIG9mIGFkZGluZyBhbmQgdXBkYXRpbmcgZG9jdW1lbnRzIGluIHRoZSBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLlxyXG4gKi9cclxudmFyIE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBNZW1vcnlSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcihzaXplciwgZG9jdW1lbnRDYWNoZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuc2l6ZXIgPSBzaXplcjtcclxuICAgICAgICBfdGhpcy5kb2N1bWVudENhY2hlID0gZG9jdW1lbnRDYWNoZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlci5wcm90b3R5cGUuYXBwbHlDaGFuZ2VzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY2hhbmdlcyA9IHRoaXMuYXNzZXJ0Q2hhbmdlcygpO1xyXG4gICAgICAgIHZhciBkZWx0YSA9IDA7XHJcbiAgICAgICAgdmFyIGRvY3MgPSBbXTtcclxuICAgICAgICBjaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGtleSwgbWF5YmVEb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YXIgcHJldmlvdXNTaXplID0gX3RoaXMuZG9jdW1lbnRTaXplcy5nZXQoa2V5KTtcclxuICAgICAgICAgICAgYXNzZXJ0KHByZXZpb3VzU2l6ZSAhPT0gdW5kZWZpbmVkLCBcIkF0dGVtcHRpbmcgdG8gY2hhbmdlIGRvY3VtZW50IFwiICsga2V5LnRvU3RyaW5nKCkgKyBcIiB3aXRob3V0IGhhdmluZyByZWFkIGl0IGZpcnN0XCIpO1xyXG4gICAgICAgICAgICB2YXIgc2l6ZSA9IF90aGlzLnNpemVyKG1heWJlRG9jdW1lbnQpO1xyXG4gICAgICAgICAgICBkZWx0YSArPSBzaXplIC0gcHJldmlvdXNTaXplO1xyXG4gICAgICAgICAgICBkb2NzLnB1c2goeyBtYXliZURvY3VtZW50OiBtYXliZURvY3VtZW50LCBzaXplOiBzaXplIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50Q2FjaGUuYWRkRW50cmllcyh0cmFuc2FjdGlvbiwgZG9jcywgZGVsdGEpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLnByb3RvdHlwZS5nZXRGcm9tQ2FjaGUgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRDYWNoZS5nZXRTaXplZEVudHJ5KHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyO1xyXG59KFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQ0ID0gJ01lbW9yeVBlcnNpc3RlbmNlJztcclxuLyoqXHJcbiAqIEEgbWVtb3J5LWJhY2tlZCBpbnN0YW5jZSBvZiBQZXJzaXN0ZW5jZS4gRGF0YSBpcyBzdG9yZWQgb25seSBpbiBSQU0gYW5kXHJcbiAqIG5vdCBwZXJzaXN0ZWQgYWNyb3NzIHNlc3Npb25zLlxyXG4gKi9cclxudmFyIE1lbW9yeVBlcnNpc3RlbmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVtb3J5UGVyc2lzdGVuY2UoY2xpZW50SWQsIGlzRWFnZXIsIHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBOb3RlIHRoYXQgdGhlc2UgYXJlIHJldGFpbmVkIGhlcmUgdG8gbWFrZSBpdCBlYXNpZXIgdG8gd3JpdGUgdGVzdHNcclxuICAgICAgICAgKiBhZmZlY3RpbmcgYm90aCB0aGUgaW4tbWVtb3J5IGFuZCBJbmRleGVkREItYmFja2VkIHBlcnNpc3RlbmNlIGxheWVycy4gVGVzdHNcclxuICAgICAgICAgKiBjYW4gY3JlYXRlIGEgbmV3IExvY2FsU3RvcmUgd3JhcHBpbmcgdGhpcyBQZXJzaXN0ZW5jZSBpbnN0YW5jZSBhbmQgdGhpc1xyXG4gICAgICAgICAqIHdpbGwgbWFrZSB0aGUgaW4tbWVtb3J5IHBlcnNpc3RlbmNlIGxheWVyIGJlaGF2ZSBhcyBpZiBpdCB3ZXJlIGFjdHVhbGx5XHJcbiAgICAgICAgICogcGVyc2lzdGluZyB2YWx1ZXMuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlcyA9IHt9O1xyXG4gICAgICAgIHRoaXMubGlzdGVuU2VxdWVuY2UgPSBuZXcgTGlzdGVuU2VxdWVuY2UoMCk7XHJcbiAgICAgICAgdGhpcy5fc3RhcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3N0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgIGlmIChpc0VhZ2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBuZXcgTWVtb3J5RWFnZXJEZWxlZ2F0ZSh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBuZXcgTWVtb3J5THJ1RGVsZWdhdGUodGhpcywgbmV3IExvY2FsU2VyaWFsaXplcihzZXJpYWxpemVyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucXVlcnlDYWNoZSA9IG5ldyBNZW1vcnlRdWVyeUNhY2hlKHRoaXMpO1xyXG4gICAgICAgIHZhciBzaXplciA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlZmVyZW5jZURlbGVnYXRlLmRvY3VtZW50U2l6ZShkb2MpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlID0gbmV3IE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUoc2l6ZXIpO1xyXG4gICAgfVxyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UuY3JlYXRlTHJ1UGVyc2lzdGVuY2UgPSBmdW5jdGlvbiAoY2xpZW50SWQsIHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IE1lbW9yeVBlcnNpc3RlbmNlKGNsaWVudElkLCAvKiBpc0VhZ2VyPSAqLyBmYWxzZSwgc2VyaWFsaXplcik7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UuY3JlYXRlRWFnZXJQZXJzaXN0ZW5jZSA9IGZ1bmN0aW9uIChjbGllbnRJZCwgc2VyaWFsaXplcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgTWVtb3J5UGVyc2lzdGVuY2UoY2xpZW50SWQsIC8qIGlzRWFnZXI9ICovIHRydWUsIHNlcmlhbGl6ZXIpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZS5zaHV0ZG93biA9IGZ1bmN0aW9uIChkZWxldGVEYXRhKSB7XHJcbiAgICAgICAgLy8gTm8gZHVyYWJsZSBzdGF0ZSB0byBlbnN1cmUgaXMgY2xvc2VkIG9uIHNodXRkb3duLlxyXG4gICAgICAgIHRoaXMuX3N0YXJ0ZWQgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZSwgXCJzdGFydGVkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXJ0ZWQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZ2V0QWN0aXZlQ2xpZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgW3RoaXMuY2xpZW50SWRdXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLnNldFByaW1hcnlTdGF0ZUxpc3RlbmVyID0gZnVuY3Rpb24gKHByaW1hcnlTdGF0ZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgLy8gQWxsIGNsaWVudHMgdXNpbmcgbWVtb3J5IHBlcnNpc3RlbmNlIGFjdCBhcyBwcmltYXJ5LlxyXG4gICAgICAgIHJldHVybiBwcmltYXJ5U3RhdGVMaXN0ZW5lcih0cnVlKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUuc2V0TmV0d29ya0VuYWJsZWQgPSBmdW5jdGlvbiAobmV0d29ya0VuYWJsZWQpIHtcclxuICAgICAgICAvLyBObyBvcC5cclxuICAgIH07XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZ2V0TXV0YXRpb25RdWV1ZSA9IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgdmFyIHF1ZXVlID0gdGhpcy5tdXRhdGlvblF1ZXVlc1t1c2VyLnRvS2V5KCldO1xyXG4gICAgICAgIGlmICghcXVldWUpIHtcclxuICAgICAgICAgICAgcXVldWUgPSBuZXcgTWVtb3J5TXV0YXRpb25RdWV1ZSh0aGlzLnJlZmVyZW5jZURlbGVnYXRlKTtcclxuICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlc1t1c2VyLnRvS2V5KCldID0gcXVldWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBxdWV1ZTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZ2V0UXVlcnlDYWNoZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5xdWVyeUNhY2hlO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRSZW1vdGVEb2N1bWVudENhY2hlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGU7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLnJ1blRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKGFjdGlvbiwgbW9kZSwgdHJhbnNhY3Rpb25PcGVyYXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckNCwgJ1N0YXJ0aW5nIHRyYW5zYWN0aW9uOicsIGFjdGlvbik7XHJcbiAgICAgICAgdmFyIHR4biA9IG5ldyBNZW1vcnlUcmFuc2FjdGlvbih0aGlzLmxpc3RlblNlcXVlbmNlLm5leHQoKSk7XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5vblRyYW5zYWN0aW9uU3RhcnRlZCgpO1xyXG4gICAgICAgIHJldHVybiB0cmFuc2FjdGlvbk9wZXJhdGlvbih0eG4pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlZmVyZW5jZURlbGVnYXRlXHJcbiAgICAgICAgICAgICAgICAub25UcmFuc2FjdGlvbkNvbW1pdHRlZCh0eG4pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiByZXN1bHQ7IH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50b1Byb21pc2UoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUubXV0YXRpb25RdWV1ZXNDb250YWluS2V5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBrZXkpIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLm9yKHZhbHVlcyh0aGlzLm11dGF0aW9uUXVldWVzKVxyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChxdWV1ZSkgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyByZXR1cm4gcXVldWUuY29udGFpbnNLZXkodHJhbnNhY3Rpb24sIGtleSk7IH07IH0pKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWVtb3J5UGVyc2lzdGVuY2U7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBNZW1vcnkgcGVyc2lzdGVuY2UgaXMgbm90IGFjdHVhbGx5IHRyYW5zYWN0aW9uYWwsIGJ1dCBmdXR1cmUgaW1wbGVtZW50YXRpb25zXHJcbiAqIG1heSBoYXZlIHRyYW5zYWN0aW9uLXNjb3BlZCBzdGF0ZS5cclxuICovXHJcbnZhciBNZW1vcnlUcmFuc2FjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lbW9yeVRyYW5zYWN0aW9uKGN1cnJlbnRTZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgIHRoaXMuY3VycmVudFNlcXVlbmNlTnVtYmVyID0gY3VycmVudFNlcXVlbmNlTnVtYmVyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIE1lbW9yeVRyYW5zYWN0aW9uO1xyXG59KCkpO1xyXG52YXIgTWVtb3J5RWFnZXJEZWxlZ2F0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lbW9yeUVhZ2VyRGVsZWdhdGUocGVyc2lzdGVuY2UpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gcGVyc2lzdGVuY2U7XHJcbiAgICB9XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS5zZXRJbk1lbW9yeVBpbnMgPSBmdW5jdGlvbiAoaW5NZW1vcnlQaW5zKSB7XHJcbiAgICAgICAgdGhpcy5pbk1lbW9yeVBpbnMgPSBpbk1lbW9yeVBpbnM7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUuYWRkUmVmZXJlbmNlID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdGhpcy5vcnBoYW5lZERvY3VtZW50cy5kZWxldGUoa2V5KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVSZWZlcmVuY2UgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB0aGlzLm9ycGhhbmVkRG9jdW1lbnRzLmFkZChrZXkpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZU11dGF0aW9uUmVmZXJlbmNlID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdGhpcy5vcnBoYW5lZERvY3VtZW50cy5hZGQoa2V5KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVUYXJnZXQgPSBmdW5jdGlvbiAodHhuLCBxdWVyeURhdGEpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjYWNoZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0UXVlcnlDYWNoZSgpO1xyXG4gICAgICAgIHJldHVybiBjYWNoZVxyXG4gICAgICAgICAgICAuZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQodHhuLCBxdWVyeURhdGEudGFyZ2V0SWQpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChrZXlzKSB7XHJcbiAgICAgICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBfdGhpcy5vcnBoYW5lZERvY3VtZW50cy5hZGQoa2V5KTsgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gY2FjaGUucmVtb3ZlUXVlcnlEYXRhKHR4biwgcXVlcnlEYXRhKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUub25UcmFuc2FjdGlvblN0YXJ0ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5vcnBoYW5lZERvY3VtZW50cyA9IG5ldyBTZXQoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS5vblRyYW5zYWN0aW9uQ29tbWl0dGVkID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNhY2hlID0gdGhpcy5wZXJzaXN0ZW5jZS5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHRoaXMub3JwaGFuZWREb2N1bWVudHMsIGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmlzUmVmZXJlbmNlZCh0eG4sIGtleSkubmV4dChmdW5jdGlvbiAoaXNSZWZlcmVuY2VkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzUmVmZXJlbmNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFNpbmNlIHRoaXMgaXMgdGhlIGVhZ2VyIGRlbGVnYXRlIGFuZCBtZW1vcnkgcGVyc2lzdGVuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgZG9uJ3QgY2FyZSBhYm91dCB0aGUgc2l6ZSBvZiBkb2N1bWVudHMuIFdlIGRvbid0IHRyYWNrXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNpemUgb2YgdGhlIGNhY2hlIGZvciBlYWdlciBHQy5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUucmVtb3ZlRW50cnkodHhuLCBrZXkpLm5leHQoZnVuY3Rpb24gKCkgeyB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS51cGRhdGVMaW1ib0RvY3VtZW50ID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5pc1JlZmVyZW5jZWQodHhuLCBrZXkpLm5leHQoZnVuY3Rpb24gKGlzUmVmZXJlbmNlZCkge1xyXG4gICAgICAgICAgICBpZiAoaXNSZWZlcmVuY2VkKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vcnBoYW5lZERvY3VtZW50cy5kZWxldGUoa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLm9ycGhhbmVkRG9jdW1lbnRzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUuZG9jdW1lbnRTaXplID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIC8vIEZvciBlYWdlciBHQywgd2UgZG9uJ3QgY2FyZSBhYm91dCB0aGUgZG9jdW1lbnQgc2l6ZSwgdGhlcmUgYXJlIG5vIHNpemUgdGhyZXNob2xkcy5cclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS5pc1JlZmVyZW5jZWQgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uub3IoW1xyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5wZXJzaXN0ZW5jZS5nZXRRdWVyeUNhY2hlKCkuY29udGFpbnNLZXkodHhuLCBrZXkpOyB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5wZXJzaXN0ZW5jZS5tdXRhdGlvblF1ZXVlc0NvbnRhaW5LZXkodHhuLCBrZXkpOyB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7IHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShfdGhpcy5pbk1lbW9yeVBpbnMuY29udGFpbnNLZXkoa2V5KSk7IH1cclxuICAgICAgICBdKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWVtb3J5RWFnZXJEZWxlZ2F0ZTtcclxufSgpKTtcclxudmFyIE1lbW9yeUxydURlbGVnYXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVtb3J5THJ1RGVsZWdhdGUocGVyc2lzdGVuY2UsIHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gcGVyc2lzdGVuY2U7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcclxuICAgICAgICB0aGlzLm9ycGhhbmVkU2VxdWVuY2VOdW1iZXJzID0gbmV3IE9iamVjdE1hcChmdW5jdGlvbiAoaykgeyByZXR1cm4gZW5jb2RlKGsucGF0aCk7IH0pO1xyXG4gICAgICAgIHRoaXMuZ2FyYmFnZUNvbGxlY3RvciA9IG5ldyBMcnVHYXJiYWdlQ29sbGVjdG9yKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgLy8gTm8tb3BzLCBwcmVzZW50IHNvIG1lbW9yeSBwZXJzaXN0ZW5jZSBkb2Vzbid0IGhhdmUgdG8gY2FyZSB3aGljaCBkZWxlZ2F0ZVxyXG4gICAgLy8gaXQgaGFzLlxyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLm9uVHJhbnNhY3Rpb25TdGFydGVkID0gZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLm9uVHJhbnNhY3Rpb25Db21taXR0ZWQgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLmZvckVhY2hUYXJnZXQgPSBmdW5jdGlvbiAodHhuLCBmKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuZ2V0UXVlcnlDYWNoZSgpLmZvckVhY2hUYXJnZXQodHhuLCBmKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuZ2V0VGFyZ2V0Q291bnQgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuZ2V0UXVlcnlDYWNoZSgpLmdldFRhcmdldENvdW50KHR4bik7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLmZvckVhY2hPcnBoYW5lZERvY3VtZW50U2VxdWVuY2VOdW1iZXIgPSBmdW5jdGlvbiAodHhuLCBmKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2godGhpcy5vcnBoYW5lZFNlcXVlbmNlTnVtYmVycywgZnVuY3Rpb24gKGtleSwgc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gUGFzcyBpbiB0aGUgZXhhY3Qgc2VxdWVuY2UgbnVtYmVyIGFzIHRoZSB1cHBlciBib3VuZCBzbyB3ZSBrbm93IGl0IHdvbid0IGJlIHBpbm5lZCBieVxyXG4gICAgICAgICAgICAvLyBiZWluZyB0b28gcmVjZW50LlxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuaXNQaW5uZWQodHhuLCBrZXksIHNlcXVlbmNlTnVtYmVyKS5uZXh0KGZ1bmN0aW9uIChpc1Bpbm5lZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpc1Bpbm5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmKHNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuc2V0SW5NZW1vcnlQaW5zID0gZnVuY3Rpb24gKGluTWVtb3J5UGlucykge1xyXG4gICAgICAgIHRoaXMuaW5NZW1vcnlQaW5zID0gaW5NZW1vcnlQaW5zO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVUYXJnZXRzID0gZnVuY3Rpb24gKHR4biwgdXBwZXJCb3VuZCwgYWN0aXZlVGFyZ2V0SWRzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2VcclxuICAgICAgICAgICAgLmdldFF1ZXJ5Q2FjaGUoKVxyXG4gICAgICAgICAgICAucmVtb3ZlVGFyZ2V0cyh0eG4sIHVwcGVyQm91bmQsIGFjdGl2ZVRhcmdldElkcyk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzID0gZnVuY3Rpb24gKHR4biwgdXBwZXJCb3VuZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcclxuICAgICAgICB2YXIgY2FjaGUgPSB0aGlzLnBlcnNpc3RlbmNlLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKTtcclxuICAgICAgICB2YXIgcCA9IGNhY2hlLmZvckVhY2hEb2N1bWVudEtleSh0eG4sIGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmlzUGlubmVkKHR4biwga2V5LCB1cHBlckJvdW5kKS5uZXh0KGZ1bmN0aW9uIChpc1Bpbm5lZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzUGlubmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBtZW1vcnkgcmVtb3RlIGRvY3VtZW50IGNhY2hlIGRvZXMgaXRzIG93biBieXRlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWNjb3VudGluZyBvbiByZW1vdmFsLiBUaGlzIGlzIG9rIGJlY2F1c2UgdXBkYXRpbmcgdGhlIHNpemVcclxuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgbWVtb3J5IHBlcnNpc3RlbmNlIGRvZXMgbm90IGluY3VyIElPLlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZS5yZW1vdmVFbnRyeSh0eG4sIGtleSkubmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNvdW50OyB9KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlTXV0YXRpb25SZWZlcmVuY2UgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB0aGlzLm9ycGhhbmVkU2VxdWVuY2VOdW1iZXJzLnNldChrZXksIHR4bi5jdXJyZW50U2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVUYXJnZXQgPSBmdW5jdGlvbiAodHhuLCBxdWVyeURhdGEpIHtcclxuICAgICAgICB2YXIgdXBkYXRlZCA9IHF1ZXJ5RGF0YS5jb3B5KHtcclxuICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXI6IHR4bi5jdXJyZW50U2VxdWVuY2VOdW1iZXJcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5nZXRRdWVyeUNhY2hlKCkudXBkYXRlUXVlcnlEYXRhKHR4biwgdXBkYXRlZCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLmFkZFJlZmVyZW5jZSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHRoaXMub3JwaGFuZWRTZXF1ZW5jZU51bWJlcnMuc2V0KGtleSwgdHhuLmN1cnJlbnRTZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZVJlZmVyZW5jZSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHRoaXMub3JwaGFuZWRTZXF1ZW5jZU51bWJlcnMuc2V0KGtleSwgdHhuLmN1cnJlbnRTZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLnVwZGF0ZUxpbWJvRG9jdW1lbnQgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB0aGlzLm9ycGhhbmVkU2VxdWVuY2VOdW1iZXJzLnNldChrZXksIHR4bi5jdXJyZW50U2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5kb2N1bWVudFNpemUgPSBmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICB2YXIgcmVtb3RlRG9jdW1lbnQgPSB0aGlzLnNlcmlhbGl6ZXIudG9EYlJlbW90ZURvY3VtZW50KG1heWJlRG9jKTtcclxuICAgICAgICB2YXIgdmFsdWU7XHJcbiAgICAgICAgaWYgKHJlbW90ZURvY3VtZW50LmRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gcmVtb3RlRG9jdW1lbnQuZG9jdW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHJlbW90ZURvY3VtZW50LnVua25vd25Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHJlbW90ZURvY3VtZW50LnVua25vd25Eb2N1bWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocmVtb3RlRG9jdW1lbnQubm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHJlbW90ZURvY3VtZW50Lm5vRG9jdW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBmYWlsKCdVbmtub3duIHJlbW90ZSBkb2N1bWVudCB0eXBlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh2YWx1ZSkubGVuZ3RoO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5pc1Bpbm5lZCA9IGZ1bmN0aW9uICh0eG4sIGtleSwgdXBwZXJCb3VuZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5vcihbXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnBlcnNpc3RlbmNlLm11dGF0aW9uUXVldWVzQ29udGFpbktleSh0eG4sIGtleSk7IH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKF90aGlzLmluTWVtb3J5UGlucy5jb250YWluc0tleShrZXkpKTsgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucGVyc2lzdGVuY2UuZ2V0UXVlcnlDYWNoZSgpLmNvbnRhaW5zS2V5KHR4biwga2V5KTsgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9ycGhhbmVkQXQgPSBfdGhpcy5vcnBoYW5lZFNlcXVlbmNlTnVtYmVycy5nZXQoa2V5KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShvcnBoYW5lZEF0ICE9PSB1bmRlZmluZWQgJiYgb3JwaGFuZWRBdCA+IHVwcGVyQm91bmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1lbW9yeUxydURlbGVnYXRlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckNSA9ICdFeHBvbmVudGlhbEJhY2tvZmYnO1xyXG4vKipcclxuICogQSBoZWxwZXIgZm9yIHJ1bm5pbmcgZGVsYXllZCB0YXNrcyBmb2xsb3dpbmcgYW4gZXhwb25lbnRpYWwgYmFja29mZiBjdXJ2ZVxyXG4gKiBiZXR3ZWVuIGF0dGVtcHRzLlxyXG4gKlxyXG4gKiBFYWNoIGRlbGF5IGlzIG1hZGUgdXAgb2YgYSBcImJhc2VcIiBkZWxheSB3aGljaCBmb2xsb3dzIHRoZSBleHBvbmVudGlhbFxyXG4gKiBiYWNrb2ZmIGN1cnZlLCBhbmQgYSArLy0gNTAlIFwiaml0dGVyXCIgdGhhdCBpcyBjYWxjdWxhdGVkIGFuZCBhZGRlZCB0byB0aGVcclxuICogYmFzZSBkZWxheS4gVGhpcyBwcmV2ZW50cyBjbGllbnRzIGZyb20gYWNjaWRlbnRhbGx5IHN5bmNocm9uaXppbmcgdGhlaXJcclxuICogZGVsYXlzIGNhdXNpbmcgc3Bpa2VzIG9mIGxvYWQgdG8gdGhlIGJhY2tlbmQuXHJcbiAqL1xyXG52YXIgRXhwb25lbnRpYWxCYWNrb2ZmID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRXhwb25lbnRpYWxCYWNrb2ZmKFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgQXN5bmNRdWV1ZSB0byBydW4gYmFja29mZiBvcGVyYXRpb25zIG9uLlxyXG4gICAgICovXHJcbiAgICBxdWV1ZSwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBJRCB0byB1c2Ugd2hlbiBzY2hlZHVsaW5nIGJhY2tvZmYgb3BlcmF0aW9ucyBvbiB0aGUgQXN5bmNRdWV1ZS5cclxuICAgICAqL1xyXG4gICAgdGltZXJJZCwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBpbml0aWFsIGRlbGF5ICh1c2VkIGFzIHRoZSBiYXNlIGRlbGF5IG9uIHRoZSBmaXJzdCByZXRyeSBhdHRlbXB0KS5cclxuICAgICAqIE5vdGUgdGhhdCBqaXR0ZXIgd2lsbCBzdGlsbCBiZSBhcHBsaWVkLCBzbyB0aGUgYWN0dWFsIGRlbGF5IGNvdWxkIGJlIGFzXHJcbiAgICAgKiBsaXR0bGUgYXMgMC41KmluaXRpYWxEZWxheU1zLlxyXG4gICAgICovXHJcbiAgICBpbml0aWFsRGVsYXlNcywgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBtdWx0aXBsaWVyIHRvIHVzZSB0byBkZXRlcm1pbmUgdGhlIGV4dGVuZGVkIGJhc2UgZGVsYXkgYWZ0ZXIgZWFjaFxyXG4gICAgICogYXR0ZW1wdC5cclxuICAgICAqL1xyXG4gICAgYmFja29mZkZhY3RvciwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBtYXhpbXVtIGJhc2UgZGVsYXkgYWZ0ZXIgd2hpY2ggbm8gZnVydGhlciBiYWNrb2ZmIGlzIHBlcmZvcm1lZC5cclxuICAgICAqIE5vdGUgdGhhdCBqaXR0ZXIgd2lsbCBzdGlsbCBiZSBhcHBsaWVkLCBzbyB0aGUgYWN0dWFsIGRlbGF5IGNvdWxkIGJlIGFzXHJcbiAgICAgKiBtdWNoIGFzIDEuNSptYXhEZWxheU1zLlxyXG4gICAgICovXHJcbiAgICBtYXhEZWxheU1zKSB7XHJcbiAgICAgICAgdGhpcy5xdWV1ZSA9IHF1ZXVlO1xyXG4gICAgICAgIHRoaXMudGltZXJJZCA9IHRpbWVySWQ7XHJcbiAgICAgICAgdGhpcy5pbml0aWFsRGVsYXlNcyA9IGluaXRpYWxEZWxheU1zO1xyXG4gICAgICAgIHRoaXMuYmFja29mZkZhY3RvciA9IGJhY2tvZmZGYWN0b3I7XHJcbiAgICAgICAgdGhpcy5tYXhEZWxheU1zID0gbWF4RGVsYXlNcztcclxuICAgICAgICB0aGlzLnRpbWVyUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgICAgLyoqIFRoZSBsYXN0IGJhY2tvZmYgYXR0ZW1wdCwgYXMgZXBvY2ggbWlsbGlzZWNvbmRzLiAqL1xyXG4gICAgICAgIHRoaXMubGFzdEF0dGVtcHRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgYmFja29mZiBkZWxheS5cclxuICAgICAqXHJcbiAgICAgKiBUaGUgdmVyeSBuZXh0IGJhY2tvZmZBbmRXYWl0KCkgd2lsbCBoYXZlIG5vIGRlbGF5LiBJZiBpdCBpcyBjYWxsZWQgYWdhaW5cclxuICAgICAqIChpLmUuIGR1ZSB0byBhbiBlcnJvciksIGluaXRpYWxEZWxheU1zIChwbHVzIGppdHRlcikgd2lsbCBiZSB1c2VkLCBhbmRcclxuICAgICAqIHN1YnNlcXVlbnQgb25lcyB3aWxsIGluY3JlYXNlIGFjY29yZGluZyB0byB0aGUgYmFja29mZkZhY3Rvci5cclxuICAgICAqL1xyXG4gICAgRXhwb25lbnRpYWxCYWNrb2ZmLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRCYXNlTXMgPSAwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVzZXRzIHRoZSBiYWNrb2ZmIGRlbGF5IHRvIHRoZSBtYXhpbXVtIGRlbGF5IChlLmcuIGZvciB1c2UgYWZ0ZXIgYVxyXG4gICAgICogUkVTT1VSQ0VfRVhIQVVTVEVEIGVycm9yKS5cclxuICAgICAqL1xyXG4gICAgRXhwb25lbnRpYWxCYWNrb2ZmLnByb3RvdHlwZS5yZXNldFRvTWF4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEJhc2VNcyA9IHRoaXMubWF4RGVsYXlNcztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgYWZ0ZXIgY3VycmVudERlbGF5TXMsIGFuZCBpbmNyZWFzZXMgdGhlXHJcbiAgICAgKiBkZWxheSBmb3IgYW55IHN1YnNlcXVlbnQgYXR0ZW1wdHMuIElmIHRoZXJlIHdhcyBhIHBlbmRpbmcgYmFja29mZiBvcGVyYXRpb25cclxuICAgICAqIGFscmVhZHksIGl0IHdpbGwgYmUgY2FuY2VsZWQuXHJcbiAgICAgKi9cclxuICAgIEV4cG9uZW50aWFsQmFja29mZi5wcm90b3R5cGUuYmFja29mZkFuZFJ1biA9IGZ1bmN0aW9uIChvcCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gQ2FuY2VsIGFueSBwZW5kaW5nIGJhY2tvZmYgb3BlcmF0aW9uLlxyXG4gICAgICAgIHRoaXMuY2FuY2VsKCk7XHJcbiAgICAgICAgLy8gRmlyc3Qgc2NoZWR1bGUgdXNpbmcgdGhlIGN1cnJlbnQgYmFzZSAod2hpY2ggbWF5IGJlIDAgYW5kIHNob3VsZCBiZVxyXG4gICAgICAgIC8vIGhvbm9yZWQgYXMgc3VjaCkuXHJcbiAgICAgICAgdmFyIGRlc2lyZWREZWxheVdpdGhKaXR0ZXJNcyA9IE1hdGguZmxvb3IodGhpcy5jdXJyZW50QmFzZU1zICsgdGhpcy5qaXR0ZXJEZWxheU1zKCkpO1xyXG4gICAgICAgIC8vIEd1YXJkIGFnYWluc3QgbGFzdEF0dGVtcHRUaW1lIGJlaW5nIGluIHRoZSBmdXR1cmUgZHVlIHRvIGEgY2xvY2sgY2hhbmdlLlxyXG4gICAgICAgIHZhciBkZWxheVNvRmFyTXMgPSBNYXRoLm1heCgwLCBEYXRlLm5vdygpIC0gdGhpcy5sYXN0QXR0ZW1wdFRpbWUpO1xyXG4gICAgICAgIC8vIEd1YXJkIGFnYWluc3QgdGhlIGJhY2tvZmYgZGVsYXkgYWxyZWFkeSBiZWluZyBwYXN0LlxyXG4gICAgICAgIHZhciByZW1haW5pbmdEZWxheU1zID0gTWF0aC5tYXgoMCwgZGVzaXJlZERlbGF5V2l0aEppdHRlck1zIC0gZGVsYXlTb0Zhck1zKTtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50QmFzZU1zID4gMCkge1xyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDUsIFwiQmFja2luZyBvZmYgZm9yIFwiICsgcmVtYWluaW5nRGVsYXlNcyArIFwiIG1zIFwiICtcclxuICAgICAgICAgICAgICAgIChcIihiYXNlIGRlbGF5OiBcIiArIHRoaXMuY3VycmVudEJhc2VNcyArIFwiIG1zLCBcIikgK1xyXG4gICAgICAgICAgICAgICAgKFwiZGVsYXkgd2l0aCBqaXR0ZXI6IFwiICsgZGVzaXJlZERlbGF5V2l0aEppdHRlck1zICsgXCIgbXMsIFwiKSArXHJcbiAgICAgICAgICAgICAgICAoXCJsYXN0IGF0dGVtcHQ6IFwiICsgZGVsYXlTb0Zhck1zICsgXCIgbXMgYWdvKVwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudGltZXJQcm9taXNlID0gdGhpcy5xdWV1ZS5lbnF1ZXVlQWZ0ZXJEZWxheSh0aGlzLnRpbWVySWQsIHJlbWFpbmluZ0RlbGF5TXMsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMubGFzdEF0dGVtcHRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgcmV0dXJuIG9wKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gQXBwbHkgYmFja29mZiBmYWN0b3IgdG8gZGV0ZXJtaW5lIG5leHQgZGVsYXkgYW5kIGVuc3VyZSBpdCBpcyB3aXRoaW5cclxuICAgICAgICAvLyBib3VuZHMuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50QmFzZU1zICo9IHRoaXMuYmFja29mZkZhY3RvcjtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50QmFzZU1zIDwgdGhpcy5pbml0aWFsRGVsYXlNcykge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRCYXNlTXMgPSB0aGlzLmluaXRpYWxEZWxheU1zO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50QmFzZU1zID4gdGhpcy5tYXhEZWxheU1zKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEJhc2VNcyA9IHRoaXMubWF4RGVsYXlNcztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRXhwb25lbnRpYWxCYWNrb2ZmLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudGltZXJQcm9taXNlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXJQcm9taXNlLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVyUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiBSZXR1cm5zIGEgcmFuZG9tIHZhbHVlIGluIHRoZSByYW5nZSBbLWN1cnJlbnRCYXNlTXMvMiwgY3VycmVudEJhc2VNcy8yXSAqL1xyXG4gICAgRXhwb25lbnRpYWxCYWNrb2ZmLnByb3RvdHlwZS5qaXR0ZXJEZWxheU1zID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiB0aGlzLmN1cnJlbnRCYXNlTXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEV4cG9uZW50aWFsQmFja29mZjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDYgPSAnUGVyc2lzdGVudFN0cmVhbSc7XHJcbi8qKlxyXG4gKiBQZXJzaXN0ZW50U3RyZWFtIGNhbiBiZSBpbiBvbmUgb2YgNSBzdGF0ZXMgKGVhY2ggZGVzY3JpYmVkIGluIGRldGFpbCBiZWxvdylcclxuICogYmFzZWQgb24gdGhlIGZvbGxvd2luZyBzdGF0ZSB0cmFuc2l0aW9uIGRpYWdyYW06XHJcbiAqXHJcbiAqICAgICAgICAgIHN0YXJ0KCkgY2FsbGVkICAgICAgICAgICAgIGF1dGggJiBjb25uZWN0aW9uIHN1Y2NlZWRlZFxyXG4gKiBJTklUSUFMIC0tLS0tLS0tLS0tLS0tLS0+IFNUQVJUSU5HIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPiBPUEVOXHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBeICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICB8ICAgICAgICAgICAgICAgICAgICBlcnJvciBvY2N1cnJlZCB8XHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICBcXC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tdi0tLS0tL1xyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiAgICAgICAgICAgICAgICAgICAgYmFja29mZiAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiAgICAgICAgICAgICAgICAgICAgZWxhcHNlZCAgfCAgICAgICAgICAgICAgc3RhcnQoKSBjYWxsZWQgICAgfFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFwtLS0gQkFDS09GRiA8LS0tLS0tLS0tLS0tLS0tLSBFUlJPUlxyXG4gKlxyXG4gKiBbYW55IHN0YXRlXSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT4gSU5JVElBTFxyXG4gKiAgICAgICAgICAgICAgIHN0b3AoKSBjYWxsZWQgb3JcclxuICogICAgICAgICAgICAgICBpZGxlIHRpbWVyIGV4cGlyZWRcclxuICovXHJcbnZhciBQZXJzaXN0ZW50U3RyZWFtU3RhdGU7XHJcbihmdW5jdGlvbiAoUGVyc2lzdGVudFN0cmVhbVN0YXRlKSB7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzdHJlYW1pbmcgUlBDIGlzIG5vdCB5ZXQgcnVubmluZyBhbmQgdGhlcmUncyBubyBlcnJvciBjb25kaXRpb24uXHJcbiAgICAgKiBDYWxsaW5nIHN0YXJ0KCkgd2lsbCBzdGFydCB0aGUgc3RyZWFtIGltbWVkaWF0ZWx5IHdpdGhvdXQgYmFja29mZi5cclxuICAgICAqIFdoaWxlIGluIHRoaXMgc3RhdGUgaXNTdGFydGVkKCkgd2lsbCByZXR1cm4gZmFsc2UuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZVtQZXJzaXN0ZW50U3RyZWFtU3RhdGVbXCJJbml0aWFsXCJdID0gMF0gPSBcIkluaXRpYWxcIjtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHN0cmVhbSBpcyBzdGFydGluZywgZWl0aGVyIHdhaXRpbmcgZm9yIGFuIGF1dGggdG9rZW4gb3IgZm9yIHRoZSBzdHJlYW1cclxuICAgICAqIHRvIHN1Y2Nlc3NmdWxseSBvcGVuLiBXaGlsZSBpbiB0aGlzIHN0YXRlLCBpc1N0YXJ0ZWQoKSB3aWxsIHJldHVybiB0cnVlIGJ1dFxyXG4gICAgICogaXNPcGVuKCkgd2lsbCByZXR1cm4gZmFsc2UuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZVtQZXJzaXN0ZW50U3RyZWFtU3RhdGVbXCJTdGFydGluZ1wiXSA9IDFdID0gXCJTdGFydGluZ1wiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc3RyZWFtaW5nIFJQQyBpcyB1cCBhbmQgcnVubmluZy4gUmVxdWVzdHMgYW5kIHJlc3BvbnNlcyBjYW4gZmxvd1xyXG4gICAgICogZnJlZWx5LiBCb3RoIGlzU3RhcnRlZCgpIGFuZCBpc09wZW4oKSB3aWxsIHJldHVybiB0cnVlLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtU3RhdGVbUGVyc2lzdGVudFN0cmVhbVN0YXRlW1wiT3BlblwiXSA9IDJdID0gXCJPcGVuXCI7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzdHJlYW0gZW5jb3VudGVyZWQgYW4gZXJyb3IuIFRoZSBuZXh0IHN0YXJ0IGF0dGVtcHQgd2lsbCBiYWNrIG9mZi5cclxuICAgICAqIFdoaWxlIGluIHRoaXMgc3RhdGUgaXNTdGFydGVkKCkgd2lsbCByZXR1cm4gZmFsc2UuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZVtQZXJzaXN0ZW50U3RyZWFtU3RhdGVbXCJFcnJvclwiXSA9IDNdID0gXCJFcnJvclwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBBbiBpbi1iZXR3ZWVuIHN0YXRlIGFmdGVyIGFuIGVycm9yIHdoZXJlIHRoZSBzdHJlYW0gaXMgd2FpdGluZyBiZWZvcmVcclxuICAgICAqIHJlLXN0YXJ0aW5nLiBBZnRlciB3YWl0aW5nIGlzIGNvbXBsZXRlLCB0aGUgc3RyZWFtIHdpbGwgdHJ5IHRvIG9wZW4uXHJcbiAgICAgKiBXaGlsZSBpbiB0aGlzIHN0YXRlIGlzU3RhcnRlZCgpIHdpbGwgcmV0dXJuIHRydWUgYnV0IGlzT3BlbigpIHdpbGwgcmV0dXJuXHJcbiAgICAgKiBmYWxzZS5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbVN0YXRlW1BlcnNpc3RlbnRTdHJlYW1TdGF0ZVtcIkJhY2tvZmZcIl0gPSA0XSA9IFwiQmFja29mZlwiO1xyXG59KShQZXJzaXN0ZW50U3RyZWFtU3RhdGUgfHwgKFBlcnNpc3RlbnRTdHJlYW1TdGF0ZSA9IHt9KSk7XHJcbi8qKlxyXG4gKiBJbml0aWFsIGJhY2tvZmYgdGltZSBpbiBtaWxsaXNlY29uZHMgYWZ0ZXIgYW4gZXJyb3IuXHJcbiAqIFNldCB0byAxcyBhY2NvcmRpbmcgdG8gaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL2FwaXMvZGVzaWduL2Vycm9ycy5cclxuICovXHJcbnZhciBCQUNLT0ZGX0lOSVRJQUxfREVMQVlfTVMgPSAxMDAwO1xyXG4vKiogTWF4aW11bSBiYWNrb2ZmIHRpbWUgaW4gbWlsbGlzZWNvbmRzICovXHJcbnZhciBCQUNLT0ZGX01BWF9ERUxBWV9NUyA9IDYwICogMTAwMDtcclxudmFyIEJBQ0tPRkZfRkFDVE9SID0gMS41O1xyXG4vKiogVGhlIHRpbWUgYSBzdHJlYW0gc3RheXMgb3BlbiBhZnRlciBpdCBpcyBtYXJrZWQgaWRsZS4gKi9cclxudmFyIElETEVfVElNRU9VVF9NUyA9IDYwICogMTAwMDtcclxuLyoqXHJcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSBpcyBhbiBhYnN0cmFjdCBiYXNlIGNsYXNzIHRoYXQgcmVwcmVzZW50cyBhIHN0cmVhbWluZyBSUENcclxuICogdG8gdGhlIEZpcmVzdG9yZSBiYWNrZW5kLiBJdCdzIGJ1aWx0IG9uIHRvcCBvZiB0aGUgY29ubmVjdGlvbnMgb3duIHN1cHBvcnRcclxuICogZm9yIHN0cmVhbWluZyBSUENzLCBhbmQgYWRkcyBzZXZlcmFsIGNyaXRpY2FsIGZlYXR1cmVzIGZvciBvdXIgY2xpZW50czpcclxuICpcclxuICogICAtIEV4cG9uZW50aWFsIGJhY2tvZmYgb24gZmFpbHVyZVxyXG4gKiAgIC0gQXV0aGVudGljYXRpb24gdmlhIENyZWRlbnRpYWxzUHJvdmlkZXJcclxuICogICAtIERpc3BhdGNoaW5nIGFsbCBjYWxsYmFja3MgaW50byB0aGUgc2hhcmVkIHdvcmtlciBxdWV1ZVxyXG4gKiAgIC0gQ2xvc2luZyBpZGxlIHN0cmVhbXMgYWZ0ZXIgNjAgc2Vjb25kcyBvZiBpbmFjdGl2aXR5XHJcbiAqXHJcbiAqIFN1YmNsYXNzZXMgb2YgUGVyc2lzdGVudFN0cmVhbSBpbXBsZW1lbnQgc2VyaWFsaXphdGlvbiBvZiBtb2RlbHMgdG8gYW5kXHJcbiAqIGZyb20gdGhlIEpTT04gcmVwcmVzZW50YXRpb24gb2YgdGhlIHByb3RvY29sIGJ1ZmZlcnMgZm9yIGEgc3BlY2lmaWNcclxuICogc3RyZWFtaW5nIFJQQy5cclxuICpcclxuICogIyMgU3RhcnRpbmcgYW5kIFN0b3BwaW5nXHJcbiAqXHJcbiAqIFN0cmVhbWluZyBSUENzIGFyZSBzdGF0ZWZ1bCBhbmQgbmVlZCB0byBiZSBzdGFydCgpZWQgYmVmb3JlIG1lc3NhZ2VzIGNhblxyXG4gKiBiZSBzZW50IGFuZCByZWNlaXZlZC4gVGhlIFBlcnNpc3RlbnRTdHJlYW0gd2lsbCBjYWxsIHRoZSBvbk9wZW4oKSBmdW5jdGlvblxyXG4gKiBvZiB0aGUgbGlzdGVuZXIgb25jZSB0aGUgc3RyZWFtIGlzIHJlYWR5IHRvIGFjY2VwdCByZXF1ZXN0cy5cclxuICpcclxuICogU2hvdWxkIGEgc3RhcnQoKSBmYWlsLCBQZXJzaXN0ZW50U3RyZWFtIHdpbGwgY2FsbCB0aGUgcmVnaXN0ZXJlZCBvbkNsb3NlKClcclxuICogbGlzdGVuZXIgd2l0aCBhIEZpcmVzdG9yZUVycm9yIGluZGljYXRpbmcgd2hhdCB3ZW50IHdyb25nLlxyXG4gKlxyXG4gKiBBIFBlcnNpc3RlbnRTdHJlYW0gY2FuIGJlIHN0YXJ0ZWQgYW5kIHN0b3BwZWQgcmVwZWF0ZWRseS5cclxuICpcclxuICogR2VuZXJpYyB0eXBlczpcclxuICogIFNlbmRUeXBlOiBUaGUgdHlwZSBvZiB0aGUgb3V0Z29pbmcgbWVzc2FnZSBvZiB0aGUgdW5kZXJseWluZ1xyXG4gKiAgICBjb25uZWN0aW9uIHN0cmVhbVxyXG4gKiAgUmVjZWl2ZVR5cGU6IFRoZSB0eXBlIG9mIHRoZSBpbmNvbWluZyBtZXNzYWdlIG9mIHRoZSB1bmRlcmx5aW5nXHJcbiAqICAgIGNvbm5lY3Rpb24gc3RyZWFtXHJcbiAqICBMaXN0ZW5lclR5cGU6IFRoZSB0eXBlIG9mIHRoZSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgdXNlZCBmb3IgY2FsbGJhY2tzXHJcbiAqL1xyXG52YXIgUGVyc2lzdGVudFN0cmVhbSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFBlcnNpc3RlbnRTdHJlYW0ocXVldWUsIGNvbm5lY3Rpb25UaW1lcklkLCBpZGxlVGltZXJJZCwgY29ubmVjdGlvbiwgY3JlZGVudGlhbHNQcm92aWRlciwgbGlzdGVuZXIpIHtcclxuICAgICAgICB0aGlzLnF1ZXVlID0gcXVldWU7XHJcbiAgICAgICAgdGhpcy5pZGxlVGltZXJJZCA9IGlkbGVUaW1lcklkO1xyXG4gICAgICAgIHRoaXMuY29ubmVjdGlvbiA9IGNvbm5lY3Rpb247XHJcbiAgICAgICAgdGhpcy5jcmVkZW50aWFsc1Byb3ZpZGVyID0gY3JlZGVudGlhbHNQcm92aWRlcjtcclxuICAgICAgICB0aGlzLmxpc3RlbmVyID0gbGlzdGVuZXI7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgY2xvc2UgY291bnQgdGhhdCdzIGluY3JlbWVudGVkIGV2ZXJ5IHRpbWUgdGhlIHN0cmVhbSBpcyBjbG9zZWQ7IHVzZWQgYnlcclxuICAgICAgICAgKiBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyKCkgdG8gaW52YWxpZGF0ZSBjYWxsYmFja3MgdGhhdCBoYXBwZW4gYWZ0ZXJcclxuICAgICAgICAgKiBjbG9zZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmNsb3NlQ291bnQgPSAwO1xyXG4gICAgICAgIHRoaXMuaWRsZVRpbWVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnN0cmVhbSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5iYWNrb2ZmID0gbmV3IEV4cG9uZW50aWFsQmFja29mZihxdWV1ZSwgY29ubmVjdGlvblRpbWVySWQsIEJBQ0tPRkZfSU5JVElBTF9ERUxBWV9NUywgQkFDS09GRl9GQUNUT1IsIEJBQ0tPRkZfTUFYX0RFTEFZX01TKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHN0YXJ0KCkgaGFzIGJlZW4gY2FsbGVkIGFuZCBubyBlcnJvciBoYXMgb2NjdXJyZWQuIFRydWVcclxuICAgICAqIGluZGljYXRlcyB0aGUgc3RyZWFtIGlzIG9wZW4gb3IgaW4gdGhlIHByb2Nlc3Mgb2Ygb3BlbmluZyAod2hpY2hcclxuICAgICAqIGVuY29tcGFzc2VzIHJlc3BlY3RpbmcgYmFja29mZiwgZ2V0dGluZyBhdXRoIHRva2VucywgYW5kIHN0YXJ0aW5nIHRoZVxyXG4gICAgICogYWN0dWFsIFJQQykuIFVzZSBpc09wZW4oKSB0byBkZXRlcm1pbmUgaWYgdGhlIHN0cmVhbSBpcyBvcGVuIGFuZCByZWFkeSBmb3JcclxuICAgICAqIG91dGJvdW5kIHJlcXVlc3RzLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5pc1N0YXJ0ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuU3RhcnRpbmcgfHxcclxuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLk9wZW4gfHxcclxuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkJhY2tvZmYpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSB1bmRlcmx5aW5nIFJQQyBpcyBvcGVuICh0aGUgb25PcGVuKCkgbGlzdGVuZXIgaGFzIGJlZW5cclxuICAgICAqIGNhbGxlZCkgYW5kIHRoZSBzdHJlYW0gaXMgcmVhZHkgZm9yIG91dGJvdW5kIHJlcXVlc3RzLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5PcGVuO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIHRoZSBSUEMuIE9ubHkgYWxsb3dlZCBpZiBpc1N0YXJ0ZWQoKSByZXR1cm5zIGZhbHNlLiBUaGUgc3RyZWFtIGlzXHJcbiAgICAgKiBub3QgaW1tZWRpYXRlbHkgcmVhZHkgZm9yIHVzZTogb25PcGVuKCkgd2lsbCBiZSBpbnZva2VkIHdoZW4gdGhlIFJQQyBpc1xyXG4gICAgICogcmVhZHkgZm9yIG91dGJvdW5kIHJlcXVlc3RzLCBhdCB3aGljaCBwb2ludCBpc09wZW4oKSB3aWxsIHJldHVybiB0cnVlLlxyXG4gICAgICpcclxuICAgICAqIFdoZW4gc3RhcnQgcmV0dXJucywgaXNTdGFydGVkKCkgd2lsbCByZXR1cm4gdHJ1ZS5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5FcnJvcikge1xyXG4gICAgICAgICAgICB0aGlzLnBlcmZvcm1CYWNrb2ZmKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsLCAnQWxyZWFkeSBzdGFydGVkJyk7XHJcbiAgICAgICAgdGhpcy5hdXRoKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTdG9wcyB0aGUgUlBDLiBUaGlzIGNhbGwgaXMgaWRlbXBvdGVudCBhbmQgYWxsb3dlZCByZWdhcmRsZXNzIG9mIHRoZVxyXG4gICAgICogY3VycmVudCBpc1N0YXJ0ZWQoKSBzdGF0ZS5cclxuICAgICAqXHJcbiAgICAgKiBXaGVuIHN0b3AgcmV0dXJucywgaXNTdGFydGVkKCkgYW5kIGlzT3BlbigpIHdpbGwgYm90aCByZXR1cm4gZmFsc2UuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzU3RhcnRlZCgpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jbG9zZShQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWZ0ZXIgYW4gZXJyb3IgdGhlIHN0cmVhbSB3aWxsIHVzdWFsbHkgYmFjayBvZmYgb24gdGhlIG5leHQgYXR0ZW1wdCB0b1xyXG4gICAgICogc3RhcnQgaXQuIElmIHRoZSBlcnJvciB3YXJyYW50cyBhbiBpbW1lZGlhdGUgcmVzdGFydCBvZiB0aGUgc3RyZWFtLCB0aGVcclxuICAgICAqIHNlbmRlciBjYW4gdXNlIHRoaXMgdG8gaW5kaWNhdGUgdGhhdCB0aGUgcmVjZWl2ZXIgc2hvdWxkIG5vdCBiYWNrIG9mZi5cclxuICAgICAqXHJcbiAgICAgKiBFYWNoIGVycm9yIHdpbGwgY2FsbCB0aGUgb25DbG9zZSgpIGxpc3RlbmVyLiBUaGF0IGZ1bmN0aW9uIGNhbiBkZWNpZGUgdG9cclxuICAgICAqIGluaGliaXQgYmFja29mZiBpZiByZXF1aXJlZC5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuaW5oaWJpdEJhY2tvZmYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLmlzU3RhcnRlZCgpLCAnQ2FuIG9ubHkgaW5oaWJpdCBiYWNrb2ZmIGluIGEgc3RvcHBlZCBzdGF0ZScpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbDtcclxuICAgICAgICB0aGlzLmJhY2tvZmYucmVzZXQoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIE1hcmtzIHRoaXMgc3RyZWFtIGFzIGlkbGUuIElmIG5vIGZ1cnRoZXIgYWN0aW9ucyBhcmUgcGVyZm9ybWVkIG9uIHRoZVxyXG4gICAgICogc3RyZWFtIGZvciBvbmUgbWludXRlLCB0aGUgc3RyZWFtIHdpbGwgYXV0b21hdGljYWxseSBjbG9zZSBpdHNlbGYgYW5kXHJcbiAgICAgKiBub3RpZnkgdGhlIHN0cmVhbSdzIG9uQ2xvc2UoKSBoYW5kbGVyIHdpdGggU3RhdHVzLk9LLiBUaGUgc3RyZWFtIHdpbGwgdGhlblxyXG4gICAgICogYmUgaW4gYSAhaXNTdGFydGVkKCkgc3RhdGUsIHJlcXVpcmluZyB0aGUgY2FsbGVyIHRvIHN0YXJ0IHRoZSBzdHJlYW0gYWdhaW5cclxuICAgICAqIGJlZm9yZSBmdXJ0aGVyIHVzZS5cclxuICAgICAqXHJcbiAgICAgKiBPbmx5IHN0cmVhbXMgdGhhdCBhcmUgaW4gc3RhdGUgJ09wZW4nIGNhbiBiZSBtYXJrZWQgaWRsZSwgYXMgYWxsIG90aGVyXHJcbiAgICAgKiBzdGF0ZXMgaW1wbHkgcGVuZGluZyBuZXR3b3JrIG9wZXJhdGlvbnMuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLm1hcmtJZGxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gU3RhcnRzIHRoZSBpZGxlIHRpbWUgaWYgd2UgYXJlIGluIHN0YXRlICdPcGVuJyBhbmQgYXJlIG5vdCB5ZXQgYWxyZWFkeVxyXG4gICAgICAgIC8vIHJ1bm5pbmcgYSB0aW1lciAoaW4gd2hpY2ggY2FzZSB0aGUgcHJldmlvdXMgaWRsZSB0aW1lb3V0IHN0aWxsIGFwcGxpZXMpLlxyXG4gICAgICAgIGlmICh0aGlzLmlzT3BlbigpICYmIHRoaXMuaWRsZVRpbWVyID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaWRsZVRpbWVyID0gdGhpcy5xdWV1ZS5lbnF1ZXVlQWZ0ZXJEZWxheSh0aGlzLmlkbGVUaW1lcklkLCBJRExFX1RJTUVPVVRfTVMsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUlkbGVDbG9zZVRpbWVyKCk7IH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiogU2VuZHMgYSBtZXNzYWdlIHRvIHRoZSB1bmRlcmx5aW5nIHN0cmVhbS4gKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLnNlbmRSZXF1ZXN0ID0gZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgIHRoaXMuY2FuY2VsSWRsZUNoZWNrKCk7XHJcbiAgICAgICAgdGhpcy5zdHJlYW0uc2VuZChtc2cpO1xyXG4gICAgfTtcclxuICAgIC8qKiBDYWxsZWQgYnkgdGhlIGlkbGUgdGltZXIgd2hlbiB0aGUgc3RyZWFtIHNob3VsZCBjbG9zZSBkdWUgdG8gaW5hY3Rpdml0eS4gKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLmhhbmRsZUlkbGVDbG9zZVRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzT3BlbigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2hlbiB0aW1pbmcgb3V0IGFuIGlkbGUgc3RyZWFtIHRoZXJlJ3Mgbm8gcmVhc29uIHRvIGZvcmNlIHRoZSBzdHJlYW0gaW50byBiYWNrb2ZmIHdoZW5cclxuICAgICAgICAgICAgICAgICAgICAvLyBpdCByZXN0YXJ0cyBzbyBzZXQgdGhlIHN0cmVhbSBzdGF0ZSB0byBJbml0aWFsIGluc3RlYWQgb2YgRXJyb3IuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuY2xvc2UoUGVyc2lzdGVudFN0cmVhbVN0YXRlLkluaXRpYWwpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIE1hcmtzIHRoZSBzdHJlYW0gYXMgYWN0aXZlIGFnYWluLiAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuY2FuY2VsSWRsZUNoZWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlkbGVUaW1lcikge1xyXG4gICAgICAgICAgICB0aGlzLmlkbGVUaW1lci5jYW5jZWwoKTtcclxuICAgICAgICAgICAgdGhpcy5pZGxlVGltZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENsb3NlcyB0aGUgc3RyZWFtIGFuZCBjbGVhbnMgdXAgYXMgbmVjZXNzYXJ5OlxyXG4gICAgICpcclxuICAgICAqICogY2xvc2VzIHRoZSB1bmRlcmx5aW5nIEdSUEMgc3RyZWFtO1xyXG4gICAgICogKiBjYWxscyB0aGUgb25DbG9zZSBoYW5kbGVyIHdpdGggdGhlIGdpdmVuICdlcnJvcic7XHJcbiAgICAgKiAqIHNldHMgaW50ZXJuYWwgc3RyZWFtIHN0YXRlIHRvICdmaW5hbFN0YXRlJztcclxuICAgICAqICogYWRqdXN0cyB0aGUgYmFja29mZiB0aW1lciBiYXNlZCBvbiB0aGUgZXJyb3JcclxuICAgICAqXHJcbiAgICAgKiBBIG5ldyBzdHJlYW0gY2FuIGJlIG9wZW5lZCBieSBjYWxsaW5nIHN0YXJ0KCkuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGZpbmFsU3RhdGUgdGhlIGludGVuZGVkIHN0YXRlIG9mIHRoZSBzdHJlYW0gYWZ0ZXIgY2xvc2luZy5cclxuICAgICAqIEBwYXJhbSBlcnJvciB0aGUgZXJyb3IgdGhlIGNvbm5lY3Rpb24gd2FzIGNsb3NlZCB3aXRoLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uIChmaW5hbFN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCh0aGlzLmlzU3RhcnRlZCgpLCAnT25seSBzdGFydGVkIHN0cmVhbXMgc2hvdWxkIGJlIGNsb3NlZC4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KGZpbmFsU3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5FcnJvciB8fCBpc051bGxPclVuZGVmaW5lZChlcnJvciQkMSksIFwiQ2FuJ3QgcHJvdmlkZSBhbiBlcnJvciB3aGVuIG5vdCBpbiBhbiBlcnJvciBzdGF0ZS5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhbmNlbCBhbnkgb3V0c3RhbmRpbmcgdGltZXJzICh0aGV5J3JlIGd1YXJhbnRlZWQgbm90IHRvIGV4ZWN1dGUpLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbElkbGVDaGVjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhY2tvZmYuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEludmFsaWRhdGVzIGFueSBzdHJlYW0tcmVsYXRlZCBjYWxsYmFja3MgKGUuZy4gZnJvbSBhdXRoIG9yIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1bmRlcmx5aW5nIHN0cmVhbSksIGd1YXJhbnRlZWluZyB0aGV5IHdvbid0IGV4ZWN1dGUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmluYWxTdGF0ZSAhPT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGlzIGFuIGludGVudGlvbmFsIGNsb3NlIGVuc3VyZSB3ZSBkb24ndCBkZWxheSBvdXIgbmV4dCBjb25uZWN0aW9uIGF0dGVtcHQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhY2tvZmYucmVzZXQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChlcnJvciQkMSAmJiBlcnJvciQkMS5jb2RlID09PSBDb2RlLlJFU09VUkNFX0VYSEFVU1RFRCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTG9nIHRoZSBlcnJvci4gKFByb2JhYmx5IGVpdGhlciAncXVvdGEgZXhjZWVkZWQnIG9yICdtYXggcXVldWUgbGVuZ3RoIHJlYWNoZWQnLilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKGVycm9yJCQxLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoJ1VzaW5nIG1heGltdW0gYmFja29mZiBkZWxheSB0byBwcmV2ZW50IG92ZXJsb2FkaW5nIHRoZSBiYWNrZW5kLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iYWNrb2ZmLnJlc2V0VG9NYXgoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChlcnJvciQkMSAmJiBlcnJvciQkMS5jb2RlID09PSBDb2RlLlVOQVVUSEVOVElDQVRFRCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gXCJ1bmF1dGhlbnRpY2F0ZWRcIiBlcnJvciBtZWFucyB0aGUgdG9rZW4gd2FzIHJlamVjdGVkLiBUcnkgZm9yY2UgcmVmcmVzaGluZyBpdCBpbiBjYXNlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBqdXN0IGV4cGlyZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWRlbnRpYWxzUHJvdmlkZXIuaW52YWxpZGF0ZVRva2VuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYW4gdXAgdGhlIHVuZGVybHlpbmcgc3RyZWFtIGJlY2F1c2Ugd2UgYXJlIG5vIGxvbmdlciBpbnRlcmVzdGVkIGluIGV2ZW50cy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RyZWFtICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlYXJEb3duKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0cmVhbS5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHJlYW0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgc3RhdGUgbXVzdCBiZSBhc3NpZ25lZCBiZWZvcmUgY2FsbGluZyBvbkNsb3NlKCkgdG8gYWxsb3cgdGhlIGNhbGxiYWNrIHRvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluaGliaXQgYmFja29mZiBvciBvdGhlcndpc2UgbWFuaXB1bGF0ZSB0aGUgc3RhdGUgaW4gaXRzIG5vbi1zdGFydGVkIHN0YXRlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlID0gZmluYWxTdGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90aWZ5IHRoZSBsaXN0ZW5lciB0aGF0IHRoZSBzdHJlYW0gY2xvc2VkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxpc3RlbmVyLm9uQ2xvc2UoZXJyb3IkJDEpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmeSB0aGUgbGlzdGVuZXIgdGhhdCB0aGUgc3RyZWFtIGNsb3NlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2FuIGJlIG92ZXJyaWRkZW4gdG8gcGVyZm9ybSBhZGRpdGlvbmFsIGNsZWFudXAgYmVmb3JlIHRoZSBzdHJlYW0gaXMgY2xvc2VkLlxyXG4gICAgICogQ2FsbGluZyBzdXBlci50ZWFyRG93bigpIGlzIG5vdCByZXF1aXJlZC5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUudGVhckRvd24gPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5hdXRoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsLCAnTXVzdCBiZSBpbiBpbml0aWFsIHN0YXRlIHRvIGF1dGgnKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLlN0YXJ0aW5nO1xyXG4gICAgICAgIHZhciBkaXNwYXRjaElmTm90Q2xvc2VkID0gdGhpcy5nZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyKHRoaXMuY2xvc2VDb3VudCk7XHJcbiAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBKdXN0IHVzZSBkaXNwYXRjaElmTm90Q2xvc2VkLCBidXQgc2VlIFRPRE8gYmVsb3cuXHJcbiAgICAgICAgdmFyIGNsb3NlQ291bnQgPSB0aGlzLmNsb3NlQ291bnQ7XHJcbiAgICAgICAgdGhpcy5jcmVkZW50aWFsc1Byb3ZpZGVyLmdldFRva2VuKCkudGhlbihmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICAgICAgLy8gU3RyZWFtIGNhbiBiZSBzdG9wcGVkIHdoaWxlIHdhaXRpbmcgZm9yIGF1dGhlbnRpY2F0aW9uLlxyXG4gICAgICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IFdlIHJlYWxseSBzaG91bGQganVzdCB1c2UgZGlzcGF0Y2hJZk5vdENsb3NlZFxyXG4gICAgICAgICAgICAvLyBhbmQgbGV0IHRoaXMgZGlzcGF0Y2ggb250byB0aGUgcXVldWUsIGJ1dCB0aGF0IG9wZW5lZCBhIHNwZWMgdGVzdCBjYW5cclxuICAgICAgICAgICAgLy8gb2Ygd29ybXMgdGhhdCBJIGRvbid0IHdhbnQgdG8gZGVhbCB3aXRoIGluIHRoaXMgUFIuXHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5jbG9zZUNvdW50ID09PSBjbG9zZUNvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBOb3JtYWxseSB3ZSdkIGhhdmUgdG8gc2NoZWR1bGUgdGhlIGNhbGxiYWNrIG9uIHRoZSBBc3luY1F1ZXVlLlxyXG4gICAgICAgICAgICAgICAgLy8gSG93ZXZlciwgdGhlIGZvbGxvd2luZyBjYWxscyBhcmUgc2FmZSB0byBiZSBjYWxsZWQgb3V0c2lkZSB0aGVcclxuICAgICAgICAgICAgICAgIC8vIEFzeW5jUXVldWUgc2luY2UgdGhleSBkb24ndCBjaGFpbiBhc3luY2hyb25vdXMgY2FsbHNcclxuICAgICAgICAgICAgICAgIF90aGlzLnN0YXJ0U3RyZWFtKHRva2VuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgICAgICBkaXNwYXRjaElmTm90Q2xvc2VkKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBycGNFcnJvciA9IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOS05PV04sICdGZXRjaGluZyBhdXRoIHRva2VuIGZhaWxlZDogJyArIGVycm9yJCQxLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmhhbmRsZVN0cmVhbUNsb3NlKHJwY0Vycm9yKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuc3RhcnRTdHJlYW0gPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuU3RhcnRpbmcsICdUcnlpbmcgdG8gc3RhcnQgc3RyZWFtIGluIGEgbm9uLXN0YXJ0aW5nIHN0YXRlJyk7XHJcbiAgICAgICAgdmFyIGRpc3BhdGNoSWZOb3RDbG9zZWQgPSB0aGlzLmdldENsb3NlR3VhcmRlZERpc3BhdGNoZXIodGhpcy5jbG9zZUNvdW50KTtcclxuICAgICAgICB0aGlzLnN0cmVhbSA9IHRoaXMuc3RhcnRScGModG9rZW4pO1xyXG4gICAgICAgIHRoaXMuc3RyZWFtLm9uT3BlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRpc3BhdGNoSWZOb3RDbG9zZWQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KF90aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuU3RhcnRpbmcsICdFeHBlY3RlZCBzdHJlYW0gdG8gYmUgaW4gc3RhdGUgU3RhcnRpbmcsIGJ1dCB3YXMgJyArIF90aGlzLnN0YXRlKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLnN0YXRlID0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLk9wZW47XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubGlzdGVuZXIub25PcGVuKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3RyZWFtLm9uQ2xvc2UoZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgICAgIGRpc3BhdGNoSWZOb3RDbG9zZWQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmhhbmRsZVN0cmVhbUNsb3NlKGVycm9yJCQxKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdHJlYW0ub25NZXNzYWdlKGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICAgICAgZGlzcGF0Y2hJZk5vdENsb3NlZChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMub25NZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLnBlcmZvcm1CYWNrb2ZmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5FcnJvciwgJ1Nob3VsZCBvbmx5IHBlcmZvcm0gYmFja29mZiB3aGVuIGluIEVycm9yIHN0YXRlJyk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5CYWNrb2ZmO1xyXG4gICAgICAgIHRoaXMuYmFja29mZi5iYWNrb2ZmQW5kUnVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydCh0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuQmFja29mZiwgJ0JhY2tvZmYgZWxhcHNlZCBidXQgc3RhdGUgaXMgbm93OiAnICsgdGhpcy5zdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlID0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkluaXRpYWw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQodGhpcy5pc1N0YXJ0ZWQoKSwgJ1BlcnNpc3RlbnRTdHJlYW0gc2hvdWxkIGhhdmUgc3RhcnRlZCcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdHNcclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLmhhbmRsZVN0cmVhbUNsb3NlID0gZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuaXNTdGFydGVkKCksIFwiQ2FuJ3QgaGFuZGxlIHNlcnZlciBjbG9zZSBvbiBub24tc3RhcnRlZCBzdHJlYW1cIik7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQ2LCBcImNsb3NlIHdpdGggZXJyb3I6IFwiICsgZXJyb3IkJDEpO1xyXG4gICAgICAgIHRoaXMuc3RyZWFtID0gbnVsbDtcclxuICAgICAgICAvLyBJbiB0aGVvcnkgdGhlIHN0cmVhbSBjb3VsZCBjbG9zZSBjbGVhbmx5LCBob3dldmVyLCBpbiBvdXIgY3VycmVudCBtb2RlbFxyXG4gICAgICAgIC8vIHdlIG5ldmVyIGV4cGVjdCB0aGlzIHRvIGhhcHBlbiBiZWNhdXNlIGlmIHdlIHN0b3AgYSBzdHJlYW0gb3Vyc2VsdmVzLFxyXG4gICAgICAgIC8vIHRoaXMgY2FsbGJhY2sgd2lsbCBuZXZlciBiZSBjYWxsZWQuIFRvIHByZXZlbnQgY2FzZXMgd2hlcmUgd2UgcmV0cnlcclxuICAgICAgICAvLyB3aXRob3V0IGEgYmFja29mZiBhY2NpZGVudGFsbHksIHdlIHNldCB0aGUgc3RyZWFtIHRvIGVycm9yIGluIGFsbCBjYXNlcy5cclxuICAgICAgICByZXR1cm4gdGhpcy5jbG9zZShQZXJzaXN0ZW50U3RyZWFtU3RhdGUuRXJyb3IsIGVycm9yJCQxKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBcImRpc3BhdGNoZXJcIiBmdW5jdGlvbiB0aGF0IGRpc3BhdGNoZXMgb3BlcmF0aW9ucyBvbnRvIHRoZVxyXG4gICAgICogQXN5bmNRdWV1ZSBidXQgb25seSBydW5zIHRoZW0gaWYgY2xvc2VDb3VudCByZW1haW5zIHVuY2hhbmdlZC4gVGhpcyBhbGxvd3NcclxuICAgICAqIHVzIHRvIHR1cm4gYXV0aCAvIHN0cmVhbSBjYWxsYmFja3MgaW50byBuby1vcHMgaWYgdGhlIHN0cmVhbSBpcyBjbG9zZWQgL1xyXG4gICAgICogcmUtb3BlbmVkLCBldGMuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLmdldENsb3NlR3VhcmRlZERpc3BhdGNoZXIgPSBmdW5jdGlvbiAoc3RhcnRDbG9zZUNvdW50KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnF1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmNsb3NlQ291bnQgPT09IHN0YXJ0Q2xvc2VDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ2LCAnc3RyZWFtIGNhbGxiYWNrIHNraXBwZWQgYnkgZ2V0Q2xvc2VHdWFyZGVkRGlzcGF0Y2hlci4nKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBlcnNpc3RlbnRTdHJlYW07XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIFBlcnNpc3RlbnRTdHJlYW0gdGhhdCBpbXBsZW1lbnRzIHRoZSBMaXN0ZW4gUlBDLlxyXG4gKlxyXG4gKiBPbmNlIHRoZSBMaXN0ZW4gc3RyZWFtIGhhcyBjYWxsZWQgdGhlIG9uT3BlbigpIGxpc3RlbmVyLCBhbnkgbnVtYmVyIG9mXHJcbiAqIGxpc3RlbigpIGFuZCB1bmxpc3RlbigpIGNhbGxzIGNhbiBiZSBtYWRlIHRvIGNvbnRyb2wgd2hhdCBjaGFuZ2VzIHdpbGwgYmVcclxuICogc2VudCBmcm9tIHRoZSBzZXJ2ZXIgZm9yIExpc3RlblJlc3BvbnNlcy5cclxuICovXHJcbnZhciBQZXJzaXN0ZW50TGlzdGVuU3RyZWFtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUGVyc2lzdGVudExpc3RlblN0cmVhbSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFBlcnNpc3RlbnRMaXN0ZW5TdHJlYW0ocXVldWUsIGNvbm5lY3Rpb24sIGNyZWRlbnRpYWxzLCBzZXJpYWxpemVyLCBsaXN0ZW5lcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHF1ZXVlLCBUaW1lcklkLkxpc3RlblN0cmVhbUNvbm5lY3Rpb25CYWNrb2ZmLCBUaW1lcklkLkxpc3RlblN0cmVhbUlkbGUsIGNvbm5lY3Rpb24sIGNyZWRlbnRpYWxzLCBsaXN0ZW5lcikgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBQZXJzaXN0ZW50TGlzdGVuU3RyZWFtLnByb3RvdHlwZS5zdGFydFJwYyA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3Rpb24ub3BlblN0cmVhbSgnTGlzdGVuJywgdG9rZW4pO1xyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbnRMaXN0ZW5TdHJlYW0ucHJvdG90eXBlLm9uTWVzc2FnZSA9IGZ1bmN0aW9uICh3YXRjaENoYW5nZVByb3RvKSB7XHJcbiAgICAgICAgLy8gQSBzdWNjZXNzZnVsIHJlc3BvbnNlIG1lYW5zIHRoZSBzdHJlYW0gaXMgaGVhbHRoeVxyXG4gICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xyXG4gICAgICAgIHZhciB3YXRjaENoYW5nZSA9IHRoaXMuc2VyaWFsaXplci5mcm9tV2F0Y2hDaGFuZ2Uod2F0Y2hDaGFuZ2VQcm90byk7XHJcbiAgICAgICAgdmFyIHNuYXBzaG90ID0gdGhpcy5zZXJpYWxpemVyLnZlcnNpb25Gcm9tTGlzdGVuUmVzcG9uc2Uod2F0Y2hDaGFuZ2VQcm90byk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIub25XYXRjaENoYW5nZSh3YXRjaENoYW5nZSwgc25hcHNob3QpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXJzIGludGVyZXN0IGluIHRoZSByZXN1bHRzIG9mIHRoZSBnaXZlbiBxdWVyeS4gSWYgdGhlIHF1ZXJ5XHJcbiAgICAgKiBpbmNsdWRlcyBhIHJlc3VtZVRva2VuIGl0IHdpbGwgYmUgaW5jbHVkZWQgaW4gdGhlIHJlcXVlc3QuIFJlc3VsdHMgdGhhdFxyXG4gICAgICogYWZmZWN0IHRoZSBxdWVyeSB3aWxsIGJlIHN0cmVhbWVkIGJhY2sgYXMgV2F0Y2hDaGFuZ2UgbWVzc2FnZXMgdGhhdFxyXG4gICAgICogcmVmZXJlbmNlIHRoZSB0YXJnZXRJZC5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudExpc3RlblN0cmVhbS5wcm90b3R5cGUud2F0Y2ggPSBmdW5jdGlvbiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB7fTtcclxuICAgICAgICByZXF1ZXN0LmRhdGFiYXNlID0gdGhpcy5zZXJpYWxpemVyLmVuY29kZWREYXRhYmFzZUlkO1xyXG4gICAgICAgIHJlcXVlc3QuYWRkVGFyZ2V0ID0gdGhpcy5zZXJpYWxpemVyLnRvVGFyZ2V0KHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgdmFyIGxhYmVscyA9IHRoaXMuc2VyaWFsaXplci50b0xpc3RlblJlcXVlc3RMYWJlbHMocXVlcnlEYXRhKTtcclxuICAgICAgICBpZiAobGFiZWxzKSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3QubGFiZWxzID0gbGFiZWxzO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVW5yZWdpc3RlcnMgaW50ZXJlc3QgaW4gdGhlIHJlc3VsdHMgb2YgdGhlIHF1ZXJ5IGFzc29jaWF0ZWQgd2l0aCB0aGVcclxuICAgICAqIGdpdmVuIHRhcmdldElkLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50TGlzdGVuU3RyZWFtLnByb3RvdHlwZS51bndhdGNoID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB7fTtcclxuICAgICAgICByZXF1ZXN0LmRhdGFiYXNlID0gdGhpcy5zZXJpYWxpemVyLmVuY29kZWREYXRhYmFzZUlkO1xyXG4gICAgICAgIHJlcXVlc3QucmVtb3ZlVGFyZ2V0ID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGVyc2lzdGVudExpc3RlblN0cmVhbTtcclxufShQZXJzaXN0ZW50U3RyZWFtKSk7XHJcbi8qKlxyXG4gKiBBIFN0cmVhbSB0aGF0IGltcGxlbWVudHMgdGhlIFdyaXRlIFJQQy5cclxuICpcclxuICogVGhlIFdyaXRlIFJQQyByZXF1aXJlcyB0aGUgY2FsbGVyIHRvIG1haW50YWluIHNwZWNpYWwgc3RyZWFtVG9rZW5cclxuICogc3RhdGUgaW4gYmV0d2VlbiBjYWxscywgdG8gaGVscCB0aGUgc2VydmVyIHVuZGVyc3RhbmQgd2hpY2ggcmVzcG9uc2VzIHRoZVxyXG4gKiBjbGllbnQgaGFzIHByb2Nlc3NlZCBieSB0aGUgdGltZSB0aGUgbmV4dCByZXF1ZXN0IGlzIG1hZGUuIEV2ZXJ5IHJlc3BvbnNlXHJcbiAqIHdpbGwgY29udGFpbiBhIHN0cmVhbVRva2VuOyB0aGlzIHZhbHVlIG11c3QgYmUgcGFzc2VkIHRvIHRoZSBuZXh0XHJcbiAqIHJlcXVlc3QuXHJcbiAqXHJcbiAqIEFmdGVyIGNhbGxpbmcgc3RhcnQoKSBvbiB0aGlzIHN0cmVhbSwgdGhlIG5leHQgcmVxdWVzdCBtdXN0IGJlIGEgaGFuZHNoYWtlLFxyXG4gKiBjb250YWluaW5nIHdoYXRldmVyIHN0cmVhbVRva2VuIGlzIG9uIGhhbmQuIE9uY2UgYSByZXNwb25zZSB0byB0aGlzXHJcbiAqIHJlcXVlc3QgaXMgcmVjZWl2ZWQsIGFsbCBwZW5kaW5nIG11dGF0aW9ucyBtYXkgYmUgc3VibWl0dGVkLiBXaGVuXHJcbiAqIHN1Ym1pdHRpbmcgbXVsdGlwbGUgYmF0Y2hlcyBvZiBtdXRhdGlvbnMgYXQgdGhlIHNhbWUgdGltZSwgaXQnc1xyXG4gKiBva2F5IHRvIHVzZSB0aGUgc2FtZSBzdHJlYW1Ub2tlbiBmb3IgdGhlIGNhbGxzIHRvIHdyaXRlTXV0YXRpb25zLlxyXG4gKlxyXG4gKiBUT0RPKGIvMzMyNzEyMzUpOiBVc2UgcHJvdG8gdHlwZXNcclxuICovXHJcbnZhciBQZXJzaXN0ZW50V3JpdGVTdHJlYW0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhQZXJzaXN0ZW50V3JpdGVTdHJlYW0sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBQZXJzaXN0ZW50V3JpdGVTdHJlYW0ocXVldWUsIGNvbm5lY3Rpb24sIGNyZWRlbnRpYWxzLCBzZXJpYWxpemVyLCBsaXN0ZW5lcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHF1ZXVlLCBUaW1lcklkLldyaXRlU3RyZWFtQ29ubmVjdGlvbkJhY2tvZmYsIFRpbWVySWQuV3JpdGVTdHJlYW1JZGxlLCBjb25uZWN0aW9uLCBjcmVkZW50aWFscywgbGlzdGVuZXIpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICAgICAgX3RoaXMuaGFuZHNoYWtlQ29tcGxldGVfID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNpc3RlbnRXcml0ZVN0cmVhbS5wcm90b3R5cGUsIFwiaGFuZHNoYWtlQ29tcGxldGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRyYWNrcyB3aGV0aGVyIG9yIG5vdCBhIGhhbmRzaGFrZSBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgZXhjaGFuZ2VkIGFuZFxyXG4gICAgICAgICAqIHRoZSBzdHJlYW0gaXMgcmVhZHkgdG8gYWNjZXB0IG11dGF0aW9ucy5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZHNoYWtlQ29tcGxldGVfO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLy8gT3ZlcnJpZGUgb2YgUGVyc2lzdGVudFN0cmVhbS5zdGFydFxyXG4gICAgUGVyc2lzdGVudFdyaXRlU3RyZWFtLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmhhbmRzaGFrZUNvbXBsZXRlXyA9IGZhbHNlO1xyXG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuc3RhcnQuY2FsbCh0aGlzKTtcclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW50V3JpdGVTdHJlYW0ucHJvdG90eXBlLnRlYXJEb3duID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmhhbmRzaGFrZUNvbXBsZXRlXykge1xyXG4gICAgICAgICAgICB0aGlzLndyaXRlTXV0YXRpb25zKFtdKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVudFdyaXRlU3RyZWFtLnByb3RvdHlwZS5zdGFydFJwYyA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3Rpb24ub3BlblN0cmVhbSgnV3JpdGUnLCB0b2tlbik7XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVudFdyaXRlU3RyZWFtLnByb3RvdHlwZS5vbk1lc3NhZ2UgPSBmdW5jdGlvbiAocmVzcG9uc2VQcm90bykge1xyXG4gICAgICAgIC8vIEFsd2F5cyBjYXB0dXJlIHRoZSBsYXN0IHN0cmVhbSB0b2tlbi5cclxuICAgICAgICBhc3NlcnQoISFyZXNwb25zZVByb3RvLnN0cmVhbVRva2VuLCAnR290IGEgd3JpdGUgcmVzcG9uc2Ugd2l0aG91dCBhIHN0cmVhbSB0b2tlbicpO1xyXG4gICAgICAgIHRoaXMubGFzdFN0cmVhbVRva2VuID0gcmVzcG9uc2VQcm90by5zdHJlYW1Ub2tlbjtcclxuICAgICAgICBpZiAoIXRoaXMuaGFuZHNoYWtlQ29tcGxldGVfKSB7XHJcbiAgICAgICAgICAgIC8vIFRoZSBmaXJzdCByZXNwb25zZSBpcyBhbHdheXMgdGhlIGhhbmRzaGFrZSByZXNwb25zZVxyXG4gICAgICAgICAgICBhc3NlcnQoIXJlc3BvbnNlUHJvdG8ud3JpdGVSZXN1bHRzIHx8IHJlc3BvbnNlUHJvdG8ud3JpdGVSZXN1bHRzLmxlbmd0aCA9PT0gMCwgJ0dvdCBtdXRhdGlvbiByZXN1bHRzIGZvciBoYW5kc2hha2UnKTtcclxuICAgICAgICAgICAgdGhpcy5oYW5kc2hha2VDb21wbGV0ZV8gPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5lci5vbkhhbmRzaGFrZUNvbXBsZXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBBIHN1Y2Nlc3NmdWwgZmlyc3Qgd3JpdGUgcmVzcG9uc2UgbWVhbnMgdGhlIHN0cmVhbSBpcyBoZWFsdGh5LFxyXG4gICAgICAgICAgICAvLyBOb3RlLCB0aGF0IHdlIGNvdWxkIGNvbnNpZGVyIGEgc3VjY2Vzc2Z1bCBoYW5kc2hha2UgaGVhbHRoeSwgaG93ZXZlcixcclxuICAgICAgICAgICAgLy8gdGhlIHdyaXRlIGl0c2VsZiBtaWdodCBiZSBjYXVzaW5nIGFuIGVycm9yIHdlIHdhbnQgdG8gYmFjayBvZmYgZnJvbS5cclxuICAgICAgICAgICAgdGhpcy5iYWNrb2ZmLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHRzID0gdGhpcy5zZXJpYWxpemVyLmZyb21Xcml0ZVJlc3VsdHMocmVzcG9uc2VQcm90by53cml0ZVJlc3VsdHMsIHJlc3BvbnNlUHJvdG8uY29tbWl0VGltZSk7XHJcbiAgICAgICAgICAgIHZhciBjb21taXRWZXJzaW9uID0gdGhpcy5zZXJpYWxpemVyLmZyb21WZXJzaW9uKHJlc3BvbnNlUHJvdG8uY29tbWl0VGltZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVyLm9uTXV0YXRpb25SZXN1bHQoY29tbWl0VmVyc2lvbiwgcmVzdWx0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU2VuZHMgYW4gaW5pdGlhbCBzdHJlYW1Ub2tlbiB0byB0aGUgc2VydmVyLCBwZXJmb3JtaW5nIHRoZSBoYW5kc2hha2VcclxuICAgICAqIHJlcXVpcmVkIHRvIG1ha2UgdGhlIFN0cmVhbWluZ1dyaXRlIFJQQyB3b3JrLiBTdWJzZXF1ZW50XHJcbiAgICAgKiBjYWxscyBzaG91bGQgd2FpdCB1bnRpbCBvbkhhbmRzaGFrZUNvbXBsZXRlIHdhcyBjYWxsZWQuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRXcml0ZVN0cmVhbS5wcm90b3R5cGUud3JpdGVIYW5kc2hha2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuaXNPcGVuKCksICdXcml0aW5nIGhhbmRzaGFrZSByZXF1aXJlcyBhbiBvcGVuZWQgc3RyZWFtJyk7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLmhhbmRzaGFrZUNvbXBsZXRlXywgJ0hhbmRzaGFrZSBhbHJlYWR5IGNvbXBsZXRlZCcpO1xyXG4gICAgICAgIC8vIFRPRE8oZGltb25kKTogU3VwcG9ydCBzdHJlYW0gcmVzdW1wdGlvbi4gV2UgaW50ZW50aW9uYWxseSBkbyBub3Qgc2V0IHRoZVxyXG4gICAgICAgIC8vIHN0cmVhbSB0b2tlbiBvbiB0aGUgaGFuZHNoYWtlLCBpZ25vcmluZyBhbnkgc3RyZWFtIHRva2VuIHdlIG1pZ2h0IGhhdmUuXHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB7fTtcclxuICAgICAgICByZXF1ZXN0LmRhdGFiYXNlID0gdGhpcy5zZXJpYWxpemVyLmVuY29kZWREYXRhYmFzZUlkO1xyXG4gICAgICAgIHRoaXMuc2VuZFJlcXVlc3QocmVxdWVzdCk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFNlbmRzIGEgZ3JvdXAgb2YgbXV0YXRpb25zIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZCB0byBhcHBseS4gKi9cclxuICAgIFBlcnNpc3RlbnRXcml0ZVN0cmVhbS5wcm90b3R5cGUud3JpdGVNdXRhdGlvbnMgPSBmdW5jdGlvbiAobXV0YXRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQodGhpcy5pc09wZW4oKSwgJ1dyaXRpbmcgbXV0YXRpb25zIHJlcXVpcmVzIGFuIG9wZW5lZCBzdHJlYW0nKTtcclxuICAgICAgICBhc3NlcnQodGhpcy5oYW5kc2hha2VDb21wbGV0ZV8sICdIYW5kc2hha2UgbXVzdCBiZSBjb21wbGV0ZSBiZWZvcmUgd3JpdGluZyBtdXRhdGlvbnMnKTtcclxuICAgICAgICBhc3NlcnQodGhpcy5sYXN0U3RyZWFtVG9rZW4ubGVuZ3RoID4gMCwgJ1RyeWluZyB0byB3cml0ZSBtdXRhdGlvbiB3aXRob3V0IGEgdG9rZW4nKTtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IHtcclxuICAgICAgICAgICAgLy8gUHJvdG9zIGFyZSB0eXBlZCB3aXRoIHN0cmluZywgYnV0IHdlIHN1cHBvcnQgVUludDhBcnJheSBvbiBOb2RlXHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnlcclxuICAgICAgICAgICAgc3RyZWFtVG9rZW46IHRoaXMubGFzdFN0cmVhbVRva2VuLFxyXG4gICAgICAgICAgICB3cml0ZXM6IG11dGF0aW9ucy5tYXAoZnVuY3Rpb24gKG11dGF0aW9uKSB7IHJldHVybiBfdGhpcy5zZXJpYWxpemVyLnRvTXV0YXRpb24obXV0YXRpb24pOyB9KVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGVyc2lzdGVudFdyaXRlU3RyZWFtO1xyXG59KFBlcnNpc3RlbnRTdHJlYW0pKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBEYXRhc3RvcmUgaXMgYSB3cmFwcGVyIGFyb3VuZCB0aGUgZXh0ZXJuYWwgR29vZ2xlIENsb3VkIERhdGFzdG9yZSBncnBjIEFQSSxcclxuICogd2hpY2ggcHJvdmlkZXMgYW4gaW50ZXJmYWNlIHRoYXQgaXMgbW9yZSBjb252ZW5pZW50IGZvciB0aGUgcmVzdCBvZiB0aGVcclxuICogY2xpZW50IFNESyBhcmNoaXRlY3R1cmUgdG8gY29uc3VtZS5cclxuICovXHJcbnZhciBEYXRhc3RvcmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYXRhc3RvcmUocXVldWUsIGNvbm5lY3Rpb24sIGNyZWRlbnRpYWxzLCBzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdGhpcy5xdWV1ZSA9IHF1ZXVlO1xyXG4gICAgICAgIHRoaXMuY29ubmVjdGlvbiA9IGNvbm5lY3Rpb247XHJcbiAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IGNyZWRlbnRpYWxzO1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICB9XHJcbiAgICBEYXRhc3RvcmUucHJvdG90eXBlLm5ld1BlcnNpc3RlbnRXcml0ZVN0cmVhbSA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVudFdyaXRlU3RyZWFtKHRoaXMucXVldWUsIHRoaXMuY29ubmVjdGlvbiwgdGhpcy5jcmVkZW50aWFscywgdGhpcy5zZXJpYWxpemVyLCBsaXN0ZW5lcik7XHJcbiAgICB9O1xyXG4gICAgRGF0YXN0b3JlLnByb3RvdHlwZS5uZXdQZXJzaXN0ZW50V2F0Y2hTdHJlYW0gPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbnRMaXN0ZW5TdHJlYW0odGhpcy5xdWV1ZSwgdGhpcy5jb25uZWN0aW9uLCB0aGlzLmNyZWRlbnRpYWxzLCB0aGlzLnNlcmlhbGl6ZXIsIGxpc3RlbmVyKTtcclxuICAgIH07XHJcbiAgICBEYXRhc3RvcmUucHJvdG90eXBlLmNvbW1pdCA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgIGRhdGFiYXNlOiB0aGlzLnNlcmlhbGl6ZXIuZW5jb2RlZERhdGFiYXNlSWQsXHJcbiAgICAgICAgICAgIHdyaXRlczogbXV0YXRpb25zLm1hcChmdW5jdGlvbiAobSkgeyByZXR1cm4gX3RoaXMuc2VyaWFsaXplci50b011dGF0aW9uKG0pOyB9KVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW52b2tlUlBDKCdDb21taXQnLCBwYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zZXJpYWxpemVyLmZyb21Xcml0ZVJlc3VsdHMocmVzcG9uc2Uud3JpdGVSZXN1bHRzLCByZXNwb25zZS5jb21taXRUaW1lKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBEYXRhc3RvcmUucHJvdG90eXBlLmxvb2t1cCA9IGZ1bmN0aW9uIChrZXlzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICBkYXRhYmFzZTogdGhpcy5zZXJpYWxpemVyLmVuY29kZWREYXRhYmFzZUlkLFxyXG4gICAgICAgICAgICBkb2N1bWVudHM6IGtleXMubWFwKGZ1bmN0aW9uIChrKSB7IHJldHVybiBfdGhpcy5zZXJpYWxpemVyLnRvTmFtZShrKTsgfSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludm9rZVN0cmVhbWluZ1JQQygnQmF0Y2hHZXREb2N1bWVudHMnLCBwYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHZhciBkb2NzID0gbWF5YmVEb2N1bWVudE1hcCgpO1xyXG4gICAgICAgICAgICByZXNwb25zZS5mb3JFYWNoKGZ1bmN0aW9uIChwcm90bykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRvYyA9IF90aGlzLnNlcmlhbGl6ZXIuZnJvbU1heWJlRG9jdW1lbnQocHJvdG8pO1xyXG4gICAgICAgICAgICAgICAgZG9jcyA9IGRvY3MuaW5zZXJ0KGRvYy5rZXksIGRvYyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jID0gZG9jcy5nZXQoa2V5KTtcclxuICAgICAgICAgICAgICAgIGFzc2VydCghIWRvYywgJ01pc3NpbmcgZW50aXR5IGluIHdyaXRlIHJlc3BvbnNlIGZvciAnICsga2V5KTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGRvYyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBHZXRzIGFuIGF1dGggdG9rZW4gYW5kIGludm9rZXMgdGhlIHByb3ZpZGVkIFJQQy4gKi9cclxuICAgIERhdGFzdG9yZS5wcm90b3R5cGUuaW52b2tlUlBDID0gZnVuY3Rpb24gKHJwY05hbWUsIHJlcXVlc3QpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWRlbnRpYWxzXHJcbiAgICAgICAgICAgIC5nZXRUb2tlbigpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuY29ubmVjdGlvbi5pbnZva2VSUEMocnBjTmFtZSwgcmVxdWVzdCwgdG9rZW4pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IENvZGUuVU5BVVRIRU5USUNBVEVEKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogR2V0cyBhbiBhdXRoIHRva2VuIGFuZCBpbnZva2VzIHRoZSBwcm92aWRlZCBSUEMgd2l0aCBzdHJlYW1lZCByZXN1bHRzLiAqL1xyXG4gICAgRGF0YXN0b3JlLnByb3RvdHlwZS5pbnZva2VTdHJlYW1pbmdSUEMgPSBmdW5jdGlvbiAocnBjTmFtZSwgcmVxdWVzdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlZGVudGlhbHNcclxuICAgICAgICAgICAgLmdldFRva2VuKClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5jb25uZWN0aW9uLmludm9rZVN0cmVhbWluZ1JQQyhycGNOYW1lLCByZXF1ZXN0LCB0b2tlbik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gQ29kZS5VTkFVVEhFTlRJQ0FURUQpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNyZWRlbnRpYWxzLmludmFsaWRhdGVUb2tlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEYXRhc3RvcmU7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogSW50ZXJuYWwgdHJhbnNhY3Rpb24gb2JqZWN0IHJlc3BvbnNpYmxlIGZvciBhY2N1bXVsYXRpbmcgdGhlIG11dGF0aW9ucyB0b1xyXG4gKiBwZXJmb3JtIGFuZCB0aGUgYmFzZSB2ZXJzaW9ucyBmb3IgYW55IGRvY3VtZW50cyByZWFkLlxyXG4gKi9cclxudmFyIFRyYW5zYWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVHJhbnNhY3Rpb24oZGF0YXN0b3JlKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhc3RvcmUgPSBkYXRhc3RvcmU7XHJcbiAgICAgICAgLy8gVGhlIHZlcnNpb24gb2YgZWFjaCBkb2N1bWVudCB0aGF0IHdhcyByZWFkIGR1cmluZyB0aGlzIHRyYW5zYWN0aW9uLlxyXG4gICAgICAgIHRoaXMucmVhZFZlcnNpb25zID0gZG9jdW1lbnRWZXJzaW9uTWFwKCk7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvbnMgPSBbXTtcclxuICAgICAgICB0aGlzLmNvbW1pdHRlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLnJlY29yZFZlcnNpb24gPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgdmFyIGRvY1ZlcnNpb247XHJcbiAgICAgICAgaWYgKGRvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIGRvY1ZlcnNpb24gPSBkb2MudmVyc2lvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZG9jIGluc3RhbmNlb2YgTm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICAvLyBGb3IgZGVsZXRlZCBkb2NzLCB3ZSBtdXN0IHVzZSBiYXNlVmVyc2lvbiAwIHdoZW4gd2Ugb3ZlcndyaXRlIHRoZW0uXHJcbiAgICAgICAgICAgIGRvY1ZlcnNpb24gPSBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgZmFpbCgnRG9jdW1lbnQgaW4gYSB0cmFuc2FjdGlvbiB3YXMgYSAnICsgZG9jLmNvbnN0cnVjdG9yLm5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZXhpc3RpbmdWZXJzaW9uID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KGRvYy5rZXkpO1xyXG4gICAgICAgIGlmIChleGlzdGluZ1ZlcnNpb24gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2NWZXJzaW9uLmlzRXF1YWwoZXhpc3RpbmdWZXJzaW9uKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyB0cmFuc2FjdGlvbiB3aWxsIGZhaWwgbm8gbWF0dGVyIHdoYXQuXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5BQk9SVEVELCAnRG9jdW1lbnQgdmVyc2lvbiBjaGFuZ2VkIGJldHdlZW4gdHdvIHJlYWRzLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnJlYWRWZXJzaW9ucyA9IHRoaXMucmVhZFZlcnNpb25zLmluc2VydChkb2Mua2V5LCBkb2NWZXJzaW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLmxvb2t1cCA9IGZ1bmN0aW9uIChrZXlzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5jb21taXR0ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdUcmFuc2FjdGlvbiBoYXMgYWxyZWFkeSBjb21wbGV0ZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm11dGF0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnVHJhbnNhY3Rpb25zIGxvb2t1cHMgYXJlIGludmFsaWQgYWZ0ZXIgd3JpdGVzLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhc3RvcmUubG9va3VwKGtleXMpLnRoZW4oZnVuY3Rpb24gKGRvY3MpIHtcclxuICAgICAgICAgICAgZG9jcy5mb3JFYWNoKGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkb2MgaW5zdGFuY2VvZiBOb0RvY3VtZW50IHx8IGRvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVjb3JkVmVyc2lvbihkb2MpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmFpbCgnRG9jdW1lbnQgaW4gYSB0cmFuc2FjdGlvbiB3YXMgYSAnICsgZG9jLmNvbnN0cnVjdG9yLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGRvY3M7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbW1pdHRlZCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCAnVHJhbnNhY3Rpb24gaGFzIGFscmVhZHkgY29tcGxldGVkLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm11dGF0aW9ucyA9IHRoaXMubXV0YXRpb25zLmNvbmNhdChtdXRhdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgdmVyc2lvbiBvZiB0aGlzIGRvY3VtZW50IHdoZW4gaXQgd2FzIHJlYWQgaW4gdGhpcyB0cmFuc2FjdGlvbixcclxuICAgICAqIGFzIGEgcHJlY29uZGl0aW9uLCBvciBubyBwcmVjb25kaXRpb24gaWYgaXQgd2FzIG5vdCByZWFkLlxyXG4gICAgICovXHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUucHJlY29uZGl0aW9uID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KGtleSk7XHJcbiAgICAgICAgaWYgKHZlcnNpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByZWNvbmRpdGlvbi51cGRhdGVUaW1lKHZlcnNpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByZWNvbmRpdGlvbi5OT05FO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHByZWNvbmRpdGlvbiBmb3IgYSBkb2N1bWVudCBpZiB0aGUgb3BlcmF0aW9uIGlzIGFuIHVwZGF0ZS5cclxuICAgICAqL1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLnByZWNvbmRpdGlvbkZvclVwZGF0ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgdmVyc2lvbiA9IHRoaXMucmVhZFZlcnNpb25zLmdldChrZXkpO1xyXG4gICAgICAgIGlmICh2ZXJzaW9uICYmIHZlcnNpb24uaXNFcXVhbChTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpKSkge1xyXG4gICAgICAgICAgICAvLyBUaGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdCwgc28gZmFpbCB0aGUgdHJhbnNhY3Rpb24uXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQ2FuJ3QgdXBkYXRlIGEgZG9jdW1lbnQgdGhhdCBkb2Vzbid0IGV4aXN0LlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmVyc2lvbikge1xyXG4gICAgICAgICAgICAvLyBEb2N1bWVudCBleGlzdHMsIGJhc2UgcHJlY29uZGl0aW9uIG9uIGRvY3VtZW50IHVwZGF0ZSB0aW1lLlxyXG4gICAgICAgICAgICByZXR1cm4gUHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUodmVyc2lvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBEb2N1bWVudCB3YXMgbm90IHJlYWQsIHNvIHdlIGp1c3QgdXNlIHRoZSBwcmVjb25kaXRpb25zIGZvciBhIGJsaW5kXHJcbiAgICAgICAgICAgIC8vIHVwZGF0ZS5cclxuICAgICAgICAgICAgcmV0dXJuIFByZWNvbmRpdGlvbi5leGlzdHModHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoa2V5LCBkYXRhKSB7XHJcbiAgICAgICAgdGhpcy53cml0ZShkYXRhLnRvTXV0YXRpb25zKGtleSwgdGhpcy5wcmVjb25kaXRpb24oa2V5KSkpO1xyXG4gICAgfTtcclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoa2V5LCBkYXRhKSB7XHJcbiAgICAgICAgdGhpcy53cml0ZShkYXRhLnRvTXV0YXRpb25zKGtleSwgdGhpcy5wcmVjb25kaXRpb25Gb3JVcGRhdGUoa2V5KSkpO1xyXG4gICAgfTtcclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdGhpcy53cml0ZShbbmV3IERlbGV0ZU11dGF0aW9uKGtleSwgdGhpcy5wcmVjb25kaXRpb24oa2V5KSldKTtcclxuICAgICAgICAvLyBTaW5jZSB0aGUgZGVsZXRlIHdpbGwgYmUgYXBwbGllZCBiZWZvcmUgYWxsIGZvbGxvd2luZyB3cml0ZXMsIHdlIG5lZWQgdG9cclxuICAgICAgICAvLyBlbnN1cmUgdGhhdCB0aGUgcHJlY29uZGl0aW9uIGZvciB0aGUgbmV4dCB3cml0ZSB3aWxsIGJlIGV4aXN0czogZmFsc2UuXHJcbiAgICAgICAgdGhpcy5yZWFkVmVyc2lvbnMgPSB0aGlzLnJlYWRWZXJzaW9ucy5pbnNlcnQoa2V5LCBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpKTtcclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUuY29tbWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHVud3JpdHRlbiA9IHRoaXMucmVhZFZlcnNpb25zO1xyXG4gICAgICAgIC8vIEZvciBlYWNoIG11dGF0aW9uLCBub3RlIHRoYXQgdGhlIGRvYyB3YXMgd3JpdHRlbi5cclxuICAgICAgICB0aGlzLm11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChtdXRhdGlvbikge1xyXG4gICAgICAgICAgICB1bndyaXR0ZW4gPSB1bndyaXR0ZW4ucmVtb3ZlKG11dGF0aW9uLmtleSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKCF1bndyaXR0ZW4uaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChFcnJvcignRXZlcnkgZG9jdW1lbnQgcmVhZCBpbiBhIHRyYW5zYWN0aW9uIG11c3QgYWxzbyBiZSB3cml0dGVuLicpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YXN0b3JlLmNvbW1pdCh0aGlzLm11dGF0aW9ucykudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmNvbW1pdHRlZCA9IHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRyYW5zYWN0aW9uO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERlc2NyaWJlcyB0aGUgb25saW5lIHN0YXRlIG9mIHRoZSBGaXJlc3RvcmUgY2xpZW50LiBOb3RlIHRoYXQgdGhpcyBkb2VzIG5vdFxyXG4gKiBpbmRpY2F0ZSB3aGV0aGVyIG9yIG5vdCB0aGUgcmVtb3RlIHN0b3JlIGlzIHRyeWluZyB0byBjb25uZWN0IG9yIG5vdC4gVGhpcyBpc1xyXG4gKiBwcmltYXJpbHkgdXNlZCBieSB0aGUgVmlldyAvIEV2ZW50TWFuYWdlciBjb2RlIHRvIGNoYW5nZSB0aGVpciBiZWhhdmlvciB3aGlsZVxyXG4gKiBvZmZsaW5lIChlLmcuIGdldCgpIGNhbGxzIHNob3VsZG4ndCB3YWl0IGZvciBkYXRhIGZyb20gdGhlIHNlcnZlciBhbmRcclxuICogc25hcHNob3QgZXZlbnRzIHNob3VsZCBzZXQgbWV0YWRhdGEuaXNGcm9tQ2FjaGU9dHJ1ZSkuXHJcbiAqL1xyXG52YXIgT25saW5lU3RhdGU7XHJcbihmdW5jdGlvbiAoT25saW5lU3RhdGUpIHtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIEZpcmVzdG9yZSBjbGllbnQgaXMgaW4gYW4gdW5rbm93biBvbmxpbmUgc3RhdGUuIFRoaXMgbWVhbnMgdGhlIGNsaWVudFxyXG4gICAgICogaXMgZWl0aGVyIG5vdCBhY3RpdmVseSB0cnlpbmcgdG8gZXN0YWJsaXNoIGEgY29ubmVjdGlvbiBvciBpdCBpcyBjdXJyZW50bHlcclxuICAgICAqIHRyeWluZyB0byBlc3RhYmxpc2ggYSBjb25uZWN0aW9uLCBidXQgaXQgaGFzIG5vdCBzdWNjZWVkZWQgb3IgZmFpbGVkIHlldC5cclxuICAgICAqIEhpZ2hlci1sZXZlbCBjb21wb25lbnRzIHNob3VsZCBub3Qgb3BlcmF0ZSBpbiBvZmZsaW5lIG1vZGUuXHJcbiAgICAgKi9cclxuICAgIE9ubGluZVN0YXRlW09ubGluZVN0YXRlW1wiVW5rbm93blwiXSA9IDBdID0gXCJVbmtub3duXCI7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBjbGllbnQgaXMgY29ubmVjdGVkIGFuZCB0aGUgY29ubmVjdGlvbnMgYXJlIGhlYWx0aHkuIFRoaXMgc3RhdGUgaXNcclxuICAgICAqIHJlYWNoZWQgYWZ0ZXIgYSBzdWNjZXNzZnVsIGNvbm5lY3Rpb24gYW5kIHRoZXJlIGhhcyBiZWVuIGF0IGxlYXN0IG9uZVxyXG4gICAgICogc3VjY2Vzc2Z1bCBtZXNzYWdlIHJlY2VpdmVkIGZyb20gdGhlIGJhY2tlbmRzLlxyXG4gICAgICovXHJcbiAgICBPbmxpbmVTdGF0ZVtPbmxpbmVTdGF0ZVtcIk9ubGluZVwiXSA9IDFdID0gXCJPbmxpbmVcIjtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGNsaWVudCBpcyBlaXRoZXIgdHJ5aW5nIHRvIGVzdGFibGlzaCBhIGNvbm5lY3Rpb24gYnV0IGZhaWxpbmcsIG9yIGl0XHJcbiAgICAgKiBoYXMgYmVlbiBleHBsaWNpdGx5IG1hcmtlZCBvZmZsaW5lIHZpYSBhIGNhbGwgdG8gZGlzYWJsZU5ldHdvcmsoKS5cclxuICAgICAqIEhpZ2hlci1sZXZlbCBjb21wb25lbnRzIHNob3VsZCBvcGVyYXRlIGluIG9mZmxpbmUgbW9kZS5cclxuICAgICAqL1xyXG4gICAgT25saW5lU3RhdGVbT25saW5lU3RhdGVbXCJPZmZsaW5lXCJdID0gMl0gPSBcIk9mZmxpbmVcIjtcclxufSkoT25saW5lU3RhdGUgfHwgKE9ubGluZVN0YXRlID0ge30pKTtcclxuLyoqIFRoZSBzb3VyY2Ugb2YgYW4gb25saW5lIHN0YXRlIGV2ZW50LiAqL1xyXG52YXIgT25saW5lU3RhdGVTb3VyY2U7XHJcbihmdW5jdGlvbiAoT25saW5lU3RhdGVTb3VyY2UpIHtcclxuICAgIE9ubGluZVN0YXRlU291cmNlW09ubGluZVN0YXRlU291cmNlW1wiUmVtb3RlU3RvcmVcIl0gPSAwXSA9IFwiUmVtb3RlU3RvcmVcIjtcclxuICAgIE9ubGluZVN0YXRlU291cmNlW09ubGluZVN0YXRlU291cmNlW1wiU2hhcmVkQ2xpZW50U3RhdGVcIl0gPSAxXSA9IFwiU2hhcmVkQ2xpZW50U3RhdGVcIjtcclxufSkoT25saW5lU3RhdGVTb3VyY2UgfHwgKE9ubGluZVN0YXRlU291cmNlID0ge30pKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDcgPSAnT25saW5lU3RhdGVUcmFja2VyJztcclxuLy8gVG8gZGVhbCB3aXRoIHRyYW5zaWVudCBmYWlsdXJlcywgd2UgYWxsb3cgbXVsdGlwbGUgc3RyZWFtIGF0dGVtcHRzIGJlZm9yZVxyXG4vLyBnaXZpbmcgdXAgYW5kIHRyYW5zaXRpb25pbmcgZnJvbSBPbmxpbmVTdGF0ZS5Vbmtub3duIHRvIE9mZmxpbmUuXHJcbi8vIFRPRE8obWlrZWxlaGVuKTogVGhpcyB1c2VkIHRvIGJlIHNldCB0byAyIGFzIGEgbWl0aWdhdGlvbiBmb3IgYi82NjIyODM5NC5cclxuLy8gQGpkaW1vbmQgdGhpbmtzIHRoYXQgYnVnIGlzIHN1ZmZpY2llbnRseSBmaXhlZCBzbyB0aGF0IHdlIGNhbiBzZXQgdGhpcyBiYWNrXHJcbi8vIHRvIDEuIElmIHRoYXQgd29ya3Mgb2theSwgd2UgY291bGQgcG90ZW50aWFsbHkgcmVtb3ZlIHRoaXMgbG9naWMgZW50aXJlbHkuXHJcbnZhciBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTID0gMTtcclxuLy8gVG8gZGVhbCB3aXRoIHN0cmVhbSBhdHRlbXB0cyB0aGF0IGRvbid0IHN1Y2NlZWQgb3IgZmFpbCBpbiBhIHRpbWVseSBtYW5uZXIsXHJcbi8vIHdlIGhhdmUgYSB0aW1lb3V0IGZvciBPbmxpbmVTdGF0ZSB0byByZWFjaCBPbmxpbmUgb3IgT2ZmbGluZS5cclxuLy8gSWYgdGhlIHRpbWVvdXQgaXMgcmVhY2hlZCwgd2UgdHJhbnNpdGlvbiB0byBPZmZsaW5lIHJhdGhlciB0aGFuIHdhaXRpbmdcclxuLy8gaW5kZWZpbml0ZWx5LlxyXG52YXIgT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMgPSAxMCAqIDEwMDA7XHJcbi8qKlxyXG4gKiBBIGNvbXBvbmVudCB1c2VkIGJ5IHRoZSBSZW1vdGVTdG9yZSB0byB0cmFjayB0aGUgT25saW5lU3RhdGUgKHRoYXQgaXMsXHJcbiAqIHdoZXRoZXIgb3Igbm90IHRoZSBjbGllbnQgYXMgYSB3aG9sZSBzaG91bGQgYmUgY29uc2lkZXJlZCB0byBiZSBvbmxpbmUgb3JcclxuICogb2ZmbGluZSksIGltcGxlbWVudGluZyB0aGUgYXBwcm9wcmlhdGUgaGV1cmlzdGljcy5cclxuICpcclxuICogSW4gcGFydGljdWxhciwgd2hlbiB0aGUgY2xpZW50IGlzIHRyeWluZyB0byBjb25uZWN0IHRvIHRoZSBiYWNrZW5kLCB3ZVxyXG4gKiBhbGxvdyB1cCB0byBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTIHdpdGhpbiBPTkxJTkVfU1RBVEVfVElNRU9VVF9NUyBmb3JcclxuICogYSBjb25uZWN0aW9uIHRvIHN1Y2NlZWQuIElmIHdlIGhhdmUgdG9vIG1hbnkgZmFpbHVyZXMgb3IgdGhlIHRpbWVvdXQgZWxhcHNlcyxcclxuICogdGhlbiB3ZSBzZXQgdGhlIE9ubGluZVN0YXRlIHRvIE9mZmxpbmUsIGFuZCB0aGUgY2xpZW50IHdpbGwgYmVoYXZlIGFzIGlmXHJcbiAqIGl0IGlzIG9mZmxpbmUgKGdldCgpcyB3aWxsIHJldHVybiBjYWNoZWQgZGF0YSwgZXRjLikuXHJcbiAqL1xyXG52YXIgT25saW5lU3RhdGVUcmFja2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gT25saW5lU3RhdGVUcmFja2VyKGFzeW5jUXVldWUsIG9ubGluZVN0YXRlSGFuZGxlcikge1xyXG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZSA9IGFzeW5jUXVldWU7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBvbmxpbmVTdGF0ZUhhbmRsZXI7XHJcbiAgICAgICAgLyoqIFRoZSBjdXJyZW50IE9ubGluZVN0YXRlLiAqL1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBPbmxpbmVTdGF0ZS5Vbmtub3duO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgY291bnQgb2YgY29uc2VjdXRpdmUgZmFpbHVyZXMgdG8gb3BlbiB0aGUgc3RyZWFtLiBJZiBpdCByZWFjaGVzIHRoZVxyXG4gICAgICAgICAqIG1heGltdW0gZGVmaW5lZCBieSBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTLCB3ZSdsbCBzZXQgdGhlIE9ubGluZVN0YXRlIHRvXHJcbiAgICAgICAgICogT2ZmbGluZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLndhdGNoU3RyZWFtRmFpbHVyZXMgPSAwO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgdGltZXIgdGhhdCBlbGFwc2VzIGFmdGVyIE9OTElORV9TVEFURV9USU1FT1VUX01TLCBhdCB3aGljaCBwb2ludCB3ZVxyXG4gICAgICAgICAqIHRyYW5zaXRpb24gZnJvbSBPbmxpbmVTdGF0ZS5Vbmtub3duIHRvIE9ubGluZVN0YXRlLk9mZmxpbmUgd2l0aG91dCB3YWl0aW5nXHJcbiAgICAgICAgICogZm9yIHRoZSBzdHJlYW0gdG8gYWN0dWFsbHkgZmFpbCAoTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUyB0aW1lcykuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRpbWVyID0gbnVsbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBXaGV0aGVyIHRoZSBjbGllbnQgc2hvdWxkIGxvZyBhIHdhcm5pbmcgbWVzc2FnZSBpZiBpdCBmYWlscyB0byBjb25uZWN0IHRvXHJcbiAgICAgICAgICogdGhlIGJhY2tlbmQgKGluaXRpYWxseSB0cnVlLCBjbGVhcmVkIGFmdGVyIGEgc3VjY2Vzc2Z1bCBzdHJlYW0sIG9yIGlmIHdlJ3ZlXHJcbiAgICAgICAgICogbG9nZ2VkIHRoZSBtZXNzYWdlIGFscmVhZHkpLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuc2hvdWxkV2FybkNsaWVudElzT2ZmbGluZSA9IHRydWU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCBieSBSZW1vdGVTdG9yZSB3aGVuIGEgd2F0Y2ggc3RyZWFtIGlzIHN0YXJ0ZWQgKGluY2x1ZGluZyBvbiBlYWNoXHJcbiAgICAgKiBiYWNrb2ZmIGF0dGVtcHQpLlxyXG4gICAgICpcclxuICAgICAqIElmIHRoaXMgaXMgdGhlIGZpcnN0IGF0dGVtcHQsIGl0IHNldHMgdGhlIE9ubGluZVN0YXRlIHRvIFVua25vd24gYW5kIHN0YXJ0c1xyXG4gICAgICogdGhlIG9ubGluZVN0YXRlVGltZXIuXHJcbiAgICAgKi9cclxuICAgIE9ubGluZVN0YXRlVHJhY2tlci5wcm90b3R5cGUuaGFuZGxlV2F0Y2hTdHJlYW1TdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLndhdGNoU3RyZWFtRmFpbHVyZXMgPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRBbmRCcm9hZGNhc3QoT25saW5lU3RhdGUuVW5rbm93bik7XHJcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLm9ubGluZVN0YXRlVGltZXIgPT09IG51bGwsIFwib25saW5lU3RhdGVUaW1lciBzaG91bGRuJ3QgYmUgc3RhcnRlZCB5ZXRcIik7XHJcbiAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUaW1lciA9IHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQWZ0ZXJEZWxheShUaW1lcklkLk9ubGluZVN0YXRlVGltZW91dCwgT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLm9ubGluZVN0YXRlVGltZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KF90aGlzLnN0YXRlID09PSBPbmxpbmVTdGF0ZS5Vbmtub3duLCAnVGltZXIgc2hvdWxkIGJlIGNhbmNlbGVkIGlmIHdlIHRyYW5zaXRpb25lZCB0byBhIGRpZmZlcmVudCBzdGF0ZS4nKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmxvZ0NsaWVudE9mZmxpbmVXYXJuaW5nSWZOZWNlc3NhcnkoXCJCYWNrZW5kIGRpZG4ndCByZXNwb25kIHdpdGhpbiBcIiArIE9OTElORV9TVEFURV9USU1FT1VUX01TIC8gMTAwMCArIFwiIFwiICtcclxuICAgICAgICAgICAgICAgICAgICBcInNlY29uZHMuXCIpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0QW5kQnJvYWRjYXN0KE9ubGluZVN0YXRlLk9mZmxpbmUpO1xyXG4gICAgICAgICAgICAgICAgLy8gTk9URTogaGFuZGxlV2F0Y2hTdHJlYW1GYWlsdXJlKCkgd2lsbCBjb250aW51ZSB0byBpbmNyZW1lbnRcclxuICAgICAgICAgICAgICAgIC8vIHdhdGNoU3RyZWFtRmFpbHVyZXMgZXZlbiB0aG91Z2ggd2UgYXJlIGFscmVhZHkgbWFya2VkIE9mZmxpbmUsXHJcbiAgICAgICAgICAgICAgICAvLyBidXQgdGhpcyBpcyBub24taGFybWZ1bC5cclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlcyBvdXIgT25saW5lU3RhdGUgYXMgYXBwcm9wcmlhdGUgYWZ0ZXIgdGhlIHdhdGNoIHN0cmVhbSByZXBvcnRzIGFcclxuICAgICAqIGZhaWx1cmUuIFRoZSBmaXJzdCBmYWlsdXJlIG1vdmVzIHVzIHRvIHRoZSAnVW5rbm93bicgc3RhdGUuIFdlIHRoZW4gbWF5XHJcbiAgICAgKiBhbGxvdyBtdWx0aXBsZSBmYWlsdXJlcyAoYmFzZWQgb24gTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUykgYmVmb3JlIHdlXHJcbiAgICAgKiBhY3R1YWxseSB0cmFuc2l0aW9uIHRvIHRoZSAnT2ZmbGluZScgc3RhdGUuXHJcbiAgICAgKi9cclxuICAgIE9ubGluZVN0YXRlVHJhY2tlci5wcm90b3R5cGUuaGFuZGxlV2F0Y2hTdHJlYW1GYWlsdXJlID0gZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IE9ubGluZVN0YXRlLk9ubGluZSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldEFuZEJyb2FkY2FzdChPbmxpbmVTdGF0ZS5Vbmtub3duKTtcclxuICAgICAgICAgICAgLy8gVG8gZ2V0IHRvIE9ubGluZVN0YXRlLk9ubGluZSwgc2V0KCkgbXVzdCBoYXZlIGJlZW4gY2FsbGVkIHdoaWNoIHdvdWxkXHJcbiAgICAgICAgICAgIC8vIGhhdmUgcmVzZXQgb3VyIGhldXJpc3RpY3MuXHJcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLndhdGNoU3RyZWFtRmFpbHVyZXMgPT09IDAsICd3YXRjaFN0cmVhbUZhaWx1cmVzIG11c3QgYmUgMCcpO1xyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy5vbmxpbmVTdGF0ZVRpbWVyID09PSBudWxsLCAnb25saW5lU3RhdGVUaW1lciBtdXN0IGJlIG51bGwnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMud2F0Y2hTdHJlYW1GYWlsdXJlcysrO1xyXG4gICAgICAgICAgICBpZiAodGhpcy53YXRjaFN0cmVhbUZhaWx1cmVzID49IE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJPbmxpbmVTdGF0ZVRpbWVyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ0NsaWVudE9mZmxpbmVXYXJuaW5nSWZOZWNlc3NhcnkoXCJDb25uZWN0aW9uIGZhaWxlZCBcIiArIE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMgKyBcIiBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgKFwidGltZXMuIE1vc3QgcmVjZW50IGVycm9yOiBcIiArIGVycm9yJCQxLnRvU3RyaW5nKCkpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0QW5kQnJvYWRjYXN0KE9ubGluZVN0YXRlLk9mZmxpbmUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogRXhwbGljaXRseSBzZXRzIHRoZSBPbmxpbmVTdGF0ZSB0byB0aGUgc3BlY2lmaWVkIHN0YXRlLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCB0aGlzIHJlc2V0cyBvdXIgdGltZXJzIC8gZmFpbHVyZSBjb3VudGVycywgZXRjLiB1c2VkIGJ5IG91clxyXG4gICAgICogT2ZmbGluZSBoZXVyaXN0aWNzLCBzbyBtdXN0IG5vdCBiZSB1c2VkIGluIHBsYWNlIG9mXHJcbiAgICAgKiBoYW5kbGVXYXRjaFN0cmVhbVN0YXJ0KCkgYW5kIGhhbmRsZVdhdGNoU3RyZWFtRmFpbHVyZSgpLlxyXG4gICAgICovXHJcbiAgICBPbmxpbmVTdGF0ZVRyYWNrZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChuZXdTdGF0ZSkge1xyXG4gICAgICAgIHRoaXMuY2xlYXJPbmxpbmVTdGF0ZVRpbWVyKCk7XHJcbiAgICAgICAgdGhpcy53YXRjaFN0cmVhbUZhaWx1cmVzID0gMDtcclxuICAgICAgICBpZiAobmV3U3RhdGUgPT09IE9ubGluZVN0YXRlLk9ubGluZSkge1xyXG4gICAgICAgICAgICAvLyBXZSd2ZSBjb25uZWN0ZWQgdG8gd2F0Y2ggYXQgbGVhc3Qgb25jZS4gRG9uJ3Qgd2FybiB0aGUgZGV2ZWxvcGVyXHJcbiAgICAgICAgICAgIC8vIGFib3V0IGJlaW5nIG9mZmxpbmUgZ29pbmcgZm9yd2FyZC5cclxuICAgICAgICAgICAgdGhpcy5zaG91bGRXYXJuQ2xpZW50SXNPZmZsaW5lID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0QW5kQnJvYWRjYXN0KG5ld1N0YXRlKTtcclxuICAgIH07XHJcbiAgICBPbmxpbmVTdGF0ZVRyYWNrZXIucHJvdG90eXBlLnNldEFuZEJyb2FkY2FzdCA9IGZ1bmN0aW9uIChuZXdTdGF0ZSkge1xyXG4gICAgICAgIGlmIChuZXdTdGF0ZSAhPT0gdGhpcy5zdGF0ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gbmV3U3RhdGU7XHJcbiAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVIYW5kbGVyKG5ld1N0YXRlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT25saW5lU3RhdGVUcmFja2VyLnByb3RvdHlwZS5sb2dDbGllbnRPZmZsaW5lV2FybmluZ0lmTmVjZXNzYXJ5ID0gZnVuY3Rpb24gKGRldGFpbHMpIHtcclxuICAgICAgICB2YXIgbWVzc2FnZSA9IFwiQ291bGQgbm90IHJlYWNoIENsb3VkIEZpcmVzdG9yZSBiYWNrZW5kLiBcIiArIGRldGFpbHMgKyBcIlxcblwiICtcclxuICAgICAgICAgICAgXCJUaGlzIHR5cGljYWxseSBpbmRpY2F0ZXMgdGhhdCB5b3VyIGRldmljZSBkb2VzIG5vdCBoYXZlIGEgaGVhbHRoeSBcIiArXHJcbiAgICAgICAgICAgIFwiSW50ZXJuZXQgY29ubmVjdGlvbiBhdCB0aGUgbW9tZW50LiBUaGUgY2xpZW50IHdpbGwgb3BlcmF0ZSBpbiBvZmZsaW5lIFwiICtcclxuICAgICAgICAgICAgXCJtb2RlIHVudGlsIGl0IGlzIGFibGUgdG8gc3VjY2Vzc2Z1bGx5IGNvbm5lY3QgdG8gdGhlIGJhY2tlbmQuXCI7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvdWxkV2FybkNsaWVudElzT2ZmbGluZSkge1xyXG4gICAgICAgICAgICBlcnJvcihtZXNzYWdlKTtcclxuICAgICAgICAgICAgdGhpcy5zaG91bGRXYXJuQ2xpZW50SXNPZmZsaW5lID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDcsIG1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPbmxpbmVTdGF0ZVRyYWNrZXIucHJvdG90eXBlLmNsZWFyT25saW5lU3RhdGVUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5vbmxpbmVTdGF0ZVRpbWVyICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUaW1lci5jYW5jZWwoKTtcclxuICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRpbWVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE9ubGluZVN0YXRlVHJhY2tlcjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDggPSAnUmVtb3RlU3RvcmUnO1xyXG4vLyBUT0RPKGIvMzU4NTM0MDIpOiBOZWdvdGlhdGUgdGhpcyB3aXRoIHRoZSBzdHJlYW0uXHJcbnZhciBNQVhfUEVORElOR19XUklURVMgPSAxMDtcclxuLyoqXHJcbiAqIFJlbW90ZVN0b3JlIC0gQW4gaW50ZXJmYWNlIHRvIHJlbW90ZWx5IHN0b3JlZCBkYXRhLCBiYXNpY2FsbHkgcHJvdmlkaW5nIGFcclxuICogd3JhcHBlciBhcm91bmQgdGhlIERhdGFzdG9yZSB0aGF0IGlzIG1vcmUgcmVsaWFibGUgZm9yIHRoZSByZXN0IG9mIHRoZVxyXG4gKiBzeXN0ZW0uXHJcbiAqXHJcbiAqIFJlbW90ZVN0b3JlIGlzIHJlc3BvbnNpYmxlIGZvciBtYWludGFpbmluZyB0aGUgY29ubmVjdGlvbiB0byB0aGUgc2VydmVyLlxyXG4gKiAtIG1haW50YWluaW5nIGEgbGlzdCBvZiBhY3RpdmUgbGlzdGVucy5cclxuICogLSByZWNvbm5lY3Rpbmcgd2hlbiB0aGUgY29ubmVjdGlvbiBpcyBkcm9wcGVkLlxyXG4gKiAtIHJlc3VtaW5nIGFsbCB0aGUgYWN0aXZlIGxpc3RlbnMgb24gcmVjb25uZWN0LlxyXG4gKlxyXG4gKiBSZW1vdGVTdG9yZSBoYW5kbGVzIGFsbCBpbmNvbWluZyBldmVudHMgZnJvbSB0aGUgRGF0YXN0b3JlLlxyXG4gKiAtIGxpc3RlbmluZyB0byB0aGUgd2F0Y2ggc3RyZWFtIGFuZCByZXBhY2thZ2luZyB0aGUgZXZlbnRzIGFzIFJlbW90ZUV2ZW50c1xyXG4gKiAtIG5vdGlmeWluZyBTeW5jRW5naW5lIG9mIGFueSBjaGFuZ2VzIHRvIHRoZSBhY3RpdmUgbGlzdGVucy5cclxuICpcclxuICogUmVtb3RlU3RvcmUgdGFrZXMgd3JpdGVzIGZyb20gb3RoZXIgY29tcG9uZW50cyBhbmQgaGFuZGxlcyB0aGVtIHJlbGlhYmx5LlxyXG4gKiAtIHB1bGxpbmcgcGVuZGluZyBtdXRhdGlvbnMgZnJvbSBMb2NhbFN0b3JlIGFuZCBzZW5kaW5nIHRoZW0gdG8gRGF0YXN0b3JlLlxyXG4gKiAtIHJldHJ5aW5nIG11dGF0aW9ucyB0aGF0IGZhaWxlZCBiZWNhdXNlIG9mIG5ldHdvcmsgcHJvYmxlbXMuXHJcbiAqIC0gYWNraW5nIG11dGF0aW9ucyB0byB0aGUgU3luY0VuZ2luZSBvbmNlIHRoZXkgYXJlIGFjY2VwdGVkIG9yIHJlamVjdGVkLlxyXG4gKi9cclxudmFyIFJlbW90ZVN0b3JlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUmVtb3RlU3RvcmUoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBsb2NhbCBzdG9yZSwgdXNlZCB0byBmaWxsIHRoZSB3cml0ZSBwaXBlbGluZSB3aXRoIG91dGJvdW5kIG11dGF0aW9ucy5cclxuICAgICAqL1xyXG4gICAgbG9jYWxTdG9yZSwgXHJcbiAgICAvKiogVGhlIGNsaWVudC1zaWRlIHByb3h5IGZvciBpbnRlcmFjdGluZyB3aXRoIHRoZSBiYWNrZW5kLiAqL1xyXG4gICAgZGF0YXN0b3JlLCBhc3luY1F1ZXVlLCBvbmxpbmVTdGF0ZUhhbmRsZXIpIHtcclxuICAgICAgICB0aGlzLmxvY2FsU3RvcmUgPSBsb2NhbFN0b3JlO1xyXG4gICAgICAgIHRoaXMuZGF0YXN0b3JlID0gZGF0YXN0b3JlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgbGlzdCBvZiB1cCB0byBNQVhfUEVORElOR19XUklURVMgd3JpdGVzIHRoYXQgd2UgaGF2ZSBmZXRjaGVkIGZyb20gdGhlXHJcbiAgICAgICAgICogTG9jYWxTdG9yZSB2aWEgZmlsbFdyaXRlUGlwZWxpbmUoKSBhbmQgaGF2ZSBvciB3aWxsIHNlbmQgdG8gdGhlIHdyaXRlXHJcbiAgICAgICAgICogc3RyZWFtLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogV2hlbmV2ZXIgd3JpdGVQaXBlbGluZS5sZW5ndGggPiAwIHRoZSBSZW1vdGVTdG9yZSB3aWxsIGF0dGVtcHQgdG8gc3RhcnQgb3JcclxuICAgICAgICAgKiByZXN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0uIFdoZW4gdGhlIHN0cmVhbSBpcyBlc3RhYmxpc2hlZCB0aGUgd3JpdGVzIGluIHRoZVxyXG4gICAgICAgICAqIHBpcGVsaW5lIHdpbGwgYmUgc2VudCBpbiBvcmRlci5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIFdyaXRlcyByZW1haW4gaW4gd3JpdGVQaXBlbGluZSB1bnRpbCB0aGV5IGFyZSBhY2tub3dsZWRnZWQgYnkgdGhlIGJhY2tlbmRcclxuICAgICAgICAgKiBhbmQgdGh1cyB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgcmUtc2VudCBpZiB0aGUgc3RyZWFtIGlzIGludGVycnVwdGVkIC9cclxuICAgICAgICAgKiByZXN0YXJ0ZWQgYmVmb3JlIHRoZXkncmUgYWNrbm93bGVkZ2VkLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogV3JpdGUgcmVzcG9uc2VzIGZyb20gdGhlIGJhY2tlbmQgYXJlIGxpbmtlZCB0byB0aGVpciBvcmlnaW5hdGluZyByZXF1ZXN0XHJcbiAgICAgICAgICogcHVyZWx5IGJhc2VkIG9uIG9yZGVyLCBhbmQgc28gd2UgY2FuIGp1c3Qgc2hpZnQoKSB3cml0ZXMgZnJvbSB0aGUgZnJvbnQgb2ZcclxuICAgICAgICAgKiB0aGUgd3JpdGVQaXBlbGluZSBhcyB3ZSByZWNlaXZlIHJlc3BvbnNlcy5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLndyaXRlUGlwZWxpbmUgPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIG1hcHBpbmcgb2Ygd2F0Y2hlZCB0YXJnZXRzIHRoYXQgdGhlIGNsaWVudCBjYXJlcyBhYm91dCB0cmFja2luZyBhbmQgdGhlXHJcbiAgICAgICAgICogdXNlciBoYXMgZXhwbGljaXRseSBjYWxsZWQgYSAnbGlzdGVuJyBmb3IgdGhpcyB0YXJnZXQuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBUaGVzZSB0YXJnZXRzIG1heSBvciBtYXkgbm90IGhhdmUgYmVlbiBzZW50IHRvIG9yIGFja25vd2xlZGdlZCBieSB0aGVcclxuICAgICAgICAgKiBzZXJ2ZXIuIE9uIHJlLWVzdGFibGlzaGluZyB0aGUgbGlzdGVuIHN0cmVhbSwgdGhlc2UgdGFyZ2V0cyBzaG91bGQgYmUgc2VudFxyXG4gICAgICAgICAqIHRvIHRoZSBzZXJ2ZXIuIFRoZSB0YXJnZXRzIHJlbW92ZWQgd2l0aCB1bmxpc3RlbnMgYXJlIHJlbW92ZWQgZWFnZXJseVxyXG4gICAgICAgICAqIHdpdGhvdXQgd2FpdGluZyBmb3IgY29uZmlybWF0aW9uIGZyb20gdGhlIGxpc3RlbiBzdHJlYW0uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5saXN0ZW5UYXJnZXRzID0ge307XHJcbiAgICAgICAgdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFNldCB0byB0cnVlIGJ5IGVuYWJsZU5ldHdvcmsoKSBhbmQgZmFsc2UgYnkgZGlzYWJsZU5ldHdvcmsoKSBhbmQgaW5kaWNhdGVzXHJcbiAgICAgICAgICogdGhlIHVzZXItcHJlZmVycmVkIG5ldHdvcmsgc3RhdGUuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5uZXR3b3JrRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNQcmltYXJ5ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIgPSBuZXcgT25saW5lU3RhdGVUcmFja2VyKGFzeW5jUXVldWUsIG9ubGluZVN0YXRlSGFuZGxlcik7XHJcbiAgICAgICAgLy8gQ3JlYXRlIHN0cmVhbXMgKGJ1dCBub3RlIHRoZXkncmUgbm90IHN0YXJ0ZWQgeWV0KS5cclxuICAgICAgICB0aGlzLndhdGNoU3RyZWFtID0gdGhpcy5kYXRhc3RvcmUubmV3UGVyc2lzdGVudFdhdGNoU3RyZWFtKHtcclxuICAgICAgICAgICAgb25PcGVuOiB0aGlzLm9uV2F0Y2hTdHJlYW1PcGVuLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIG9uQ2xvc2U6IHRoaXMub25XYXRjaFN0cmVhbUNsb3NlLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIG9uV2F0Y2hDaGFuZ2U6IHRoaXMub25XYXRjaFN0cmVhbUNoYW5nZS5iaW5kKHRoaXMpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy53cml0ZVN0cmVhbSA9IHRoaXMuZGF0YXN0b3JlLm5ld1BlcnNpc3RlbnRXcml0ZVN0cmVhbSh7XHJcbiAgICAgICAgICAgIG9uT3BlbjogdGhpcy5vbldyaXRlU3RyZWFtT3Blbi5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICBvbkNsb3NlOiB0aGlzLm9uV3JpdGVTdHJlYW1DbG9zZS5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICBvbkhhbmRzaGFrZUNvbXBsZXRlOiB0aGlzLm9uV3JpdGVIYW5kc2hha2VDb21wbGV0ZS5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICBvbk11dGF0aW9uUmVzdWx0OiB0aGlzLm9uTXV0YXRpb25SZXN1bHQuYmluZCh0aGlzKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTdGFydHMgdXAgdGhlIHJlbW90ZSBzdG9yZSwgY3JlYXRpbmcgc3RyZWFtcywgcmVzdG9yaW5nIHN0YXRlIGZyb21cclxuICAgICAqIExvY2FsU3RvcmUsIGV0Yy5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVuYWJsZU5ldHdvcmsoKTtcclxuICAgIH07XHJcbiAgICAvKiogUmUtZW5hYmxlcyB0aGUgbmV0d29yay4gSWRlbXBvdGVudC4gKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5lbmFibGVOZXR3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXR3b3JrRW5hYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYW5Vc2VOZXR3b3JrKCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXMud3JpdGVTdHJlYW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5nZXRMYXN0U3RyZWFtVG9rZW4oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYXN0U3RyZWFtVG9rZW4gPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNob3VsZFN0YXJ0V2F0Y2hTdHJlYW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydFdhdGNoU3RyZWFtKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5zZXQoT25saW5lU3RhdGUuVW5rbm93bik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3aWxsIHN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0gaWYgbmVjZXNzYXJ5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmZpbGxXcml0ZVBpcGVsaW5lKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3aWxsIHN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0gaWYgbmVjZXNzYXJ5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBUZW1wb3JhcmlseSBkaXNhYmxlcyB0aGUgbmV0d29yay4gVGhlIG5ldHdvcmsgY2FuIGJlIHJlLWVuYWJsZWQgdXNpbmdcclxuICAgICAqIGVuYWJsZU5ldHdvcmsoKS5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmRpc2FibGVOZXR3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5kaXNhYmxlTmV0d29ya0ludGVybmFsKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIE9ubGluZVN0YXRlIHRvIE9mZmxpbmUgc28gZ2V0KClzIHJldHVybiBmcm9tIGNhY2hlLCBldGMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLnNldChPbmxpbmVTdGF0ZS5PZmZsaW5lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuZGlzYWJsZU5ldHdvcmtJbnRlcm5hbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLndyaXRlU3RyZWFtLnN0b3AoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMud2F0Y2hTdHJlYW0uc3RvcCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud3JpdGVQaXBlbGluZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDgsIFwiU3RvcHBpbmcgd3JpdGUgc3RyZWFtIHdpdGggXCIgKyB0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoICsgXCIgcGVuZGluZyB3cml0ZXNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndyaXRlUGlwZWxpbmUgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFuVXBXYXRjaFN0cmVhbVN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnNodXRkb3duID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckOCwgJ1JlbW90ZVN0b3JlIHNodXR0aW5nIGRvd24uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5kaXNhYmxlTmV0d29ya0ludGVybmFsKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIE9ubGluZVN0YXRlIHRvIFVua25vd24gKHJhdGhlciB0aGFuIE9mZmxpbmUpIHRvIGF2b2lkIHBvdGVudGlhbGx5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaWdnZXJpbmcgc3B1cmlvdXMgbGlzdGVuZXIgZXZlbnRzIHdpdGggY2FjaGVkIGRhdGEsIGV0Yy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuc2V0KE9ubGluZVN0YXRlLlVua25vd24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBTdGFydHMgbmV3IGxpc3RlbiBmb3IgdGhlIGdpdmVuIHF1ZXJ5LiBVc2VzIHJlc3VtZSB0b2tlbiBpZiBwcm92aWRlZCAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmxpc3RlbiA9IGZ1bmN0aW9uIChxdWVyeURhdGEpIHtcclxuICAgICAgICBhc3NlcnQoIWNvbnRhaW5zKHRoaXMubGlzdGVuVGFyZ2V0cywgcXVlcnlEYXRhLnRhcmdldElkKSwgJ2xpc3RlbiBjYWxsZWQgd2l0aCBkdXBsaWNhdGUgdGFyZ2V0SWQhJyk7XHJcbiAgICAgICAgLy8gTWFyayB0aGlzIGFzIHNvbWV0aGluZyB0aGUgY2xpZW50IGlzIGN1cnJlbnRseSBsaXN0ZW5pbmcgZm9yLlxyXG4gICAgICAgIHRoaXMubGlzdGVuVGFyZ2V0c1txdWVyeURhdGEudGFyZ2V0SWRdID0gcXVlcnlEYXRhO1xyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZFN0YXJ0V2F0Y2hTdHJlYW0oKSkge1xyXG4gICAgICAgICAgICAvLyBUaGUgbGlzdGVuIHdpbGwgYmUgc2VudCBpbiBvbldhdGNoU3RyZWFtT3BlblxyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0V2F0Y2hTdHJlYW0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy53YXRjaFN0cmVhbS5pc09wZW4oKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbmRXYXRjaFJlcXVlc3QocXVlcnlEYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIFJlbW92ZXMgdGhlIGxpc3RlbiBmcm9tIHNlcnZlciAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnVubGlzdGVuID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgYXNzZXJ0KGNvbnRhaW5zKHRoaXMubGlzdGVuVGFyZ2V0cywgdGFyZ2V0SWQpLCAndW5saXN0ZW4gY2FsbGVkIHdpdGhvdXQgYXNzaWduZWQgdGFyZ2V0IElEIScpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlblRhcmdldHNbdGFyZ2V0SWRdO1xyXG4gICAgICAgIGlmICh0aGlzLndhdGNoU3RyZWFtLmlzT3BlbigpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZFVud2F0Y2hSZXF1ZXN0KHRhcmdldElkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzRW1wdHkodGhpcy5saXN0ZW5UYXJnZXRzKSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy53YXRjaFN0cmVhbS5pc09wZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy53YXRjaFN0cmVhbS5tYXJrSWRsZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuY2FuVXNlTmV0d29yaygpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZXZlcnQgdG8gT25saW5lU3RhdGUuVW5rbm93biBpZiB0aGUgd2F0Y2ggc3RyZWFtIGlzIG5vdCBvcGVuIGFuZCB3ZVxyXG4gICAgICAgICAgICAgICAgLy8gaGF2ZSBubyBsaXN0ZW5lcnMsIHNpbmNlIHdpdGhvdXQgYW55IGxpc3RlbnMgdG8gc2VuZCB3ZSBjYW5ub3RcclxuICAgICAgICAgICAgICAgIC8vIGNvbmZpcm0gaWYgdGhlIHN0cmVhbSBpcyBoZWFsdGh5IGFuZCB1cGdyYWRlIHRvIE9ubGluZVN0YXRlLk9ubGluZS5cclxuICAgICAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLnNldChPbmxpbmVTdGF0ZS5Vbmtub3duKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKioge0BsaW5rIFRhcmdldE1ldGFkYXRhUHJvdmlkZXIuZ2V0UXVlcnlEYXRhRm9yVGFyZ2V0fSAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmdldFF1ZXJ5RGF0YUZvclRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxpc3RlblRhcmdldHNbdGFyZ2V0SWRdIHx8IG51bGw7XHJcbiAgICB9O1xyXG4gICAgLyoqIHtAbGluayBUYXJnZXRNZXRhZGF0YVByb3ZpZGVyLmdldFJlbW90ZUtleXNGb3JUYXJnZXR9ICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBXZSBuZWVkIHRvIGluY3JlbWVudCB0aGUgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBwZW5kaW5nIHJlc3BvbnNlcyB3ZSdyZSBkdWVcclxuICAgICAqIGZyb20gd2F0Y2ggc28gd2Ugd2FpdCBmb3IgdGhlIGFjayB0byBwcm9jZXNzIGFueSBtZXNzYWdlcyBmcm9tIHRoaXMgdGFyZ2V0LlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuc2VuZFdhdGNoUmVxdWVzdCA9IGZ1bmN0aW9uIChxdWVyeURhdGEpIHtcclxuICAgICAgICB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvci5yZWNvcmRQZW5kaW5nVGFyZ2V0UmVxdWVzdChxdWVyeURhdGEudGFyZ2V0SWQpO1xyXG4gICAgICAgIHRoaXMud2F0Y2hTdHJlYW0ud2F0Y2gocXVlcnlEYXRhKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFdlIG5lZWQgdG8gaW5jcmVtZW50IHRoZSBleHBlY3RlZCBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgd2UncmUgZHVlXHJcbiAgICAgKiBmcm9tIHdhdGNoIHNvIHdlIHdhaXQgZm9yIHRoZSByZW1vdmFsIG9uIHRoZSBzZXJ2ZXIgYmVmb3JlIHdlIHByb2Nlc3MgYW55XHJcbiAgICAgKiBtZXNzYWdlcyBmcm9tIHRoaXMgdGFyZ2V0LlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuc2VuZFVud2F0Y2hSZXF1ZXN0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IucmVjb3JkUGVuZGluZ1RhcmdldFJlcXVlc3QodGFyZ2V0SWQpO1xyXG4gICAgICAgIHRoaXMud2F0Y2hTdHJlYW0udW53YXRjaCh0YXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnN0YXJ0V2F0Y2hTdHJlYW0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc2hvdWxkU3RhcnRXYXRjaFN0cmVhbSgpLCAnc3RhcnRXYXRjaFN0cmVhbSgpIGNhbGxlZCB3aGVuIHNob3VsZFN0YXJ0V2F0Y2hTdHJlYW0oKSBpcyBmYWxzZS4nKTtcclxuICAgICAgICB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvciA9IG5ldyBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IodGhpcyk7XHJcbiAgICAgICAgdGhpcy53YXRjaFN0cmVhbS5zdGFydCgpO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLmhhbmRsZVdhdGNoU3RyZWFtU3RhcnQoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgd2F0Y2ggc3RyZWFtIHNob3VsZCBiZSBzdGFydGVkIGJlY2F1c2UgaXQncyBuZWNlc3NhcnlcclxuICAgICAqIGFuZCBoYXMgbm90IHlldCBiZWVuIHN0YXJ0ZWQuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5zaG91bGRTdGFydFdhdGNoU3RyZWFtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5jYW5Vc2VOZXR3b3JrKCkgJiZcclxuICAgICAgICAgICAgIXRoaXMud2F0Y2hTdHJlYW0uaXNTdGFydGVkKCkgJiZcclxuICAgICAgICAgICAgIWlzRW1wdHkodGhpcy5saXN0ZW5UYXJnZXRzKSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmNhblVzZU5ldHdvcmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNQcmltYXJ5ICYmIHRoaXMubmV0d29ya0VuYWJsZWQ7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmNsZWFuVXBXYXRjaFN0cmVhbVN0YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yID0gbnVsbDtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUub25XYXRjaFN0cmVhbU9wZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgZm9yRWFjaE51bWJlcih0aGlzLmxpc3RlblRhcmdldHMsIGZ1bmN0aW9uICh0YXJnZXRJZCwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2VuZFdhdGNoUmVxdWVzdChxdWVyeURhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5vbldhdGNoU3RyZWFtQ2xvc2UgPSBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IkJDEgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEdyYWNlZnVsIHN0b3AgKGR1ZSB0byBzdG9wKCkgb3IgaWRsZSB0aW1lb3V0KS4gTWFrZSBzdXJlIHRoYXQnc1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRlc2lyYWJsZS5cclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIXRoaXMuc2hvdWxkU3RhcnRXYXRjaFN0cmVhbSgpLCAnV2F0Y2ggc3RyZWFtIHdhcyBzdG9wcGVkIGdyYWNlZnVsbHkgd2hpbGUgc3RpbGwgbmVlZGVkLicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhblVwV2F0Y2hTdHJlYW1TdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgLy8gSWYgd2Ugc3RpbGwgbmVlZCB0aGUgd2F0Y2ggc3RyZWFtLCByZXRyeSB0aGUgY29ubmVjdGlvbi5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNob3VsZFN0YXJ0V2F0Y2hTdHJlYW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLmhhbmRsZVdhdGNoU3RyZWFtRmFpbHVyZShlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydFdhdGNoU3RyZWFtKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBObyBuZWVkIHRvIHJlc3RhcnQgd2F0Y2ggc3RyZWFtIGJlY2F1c2UgdGhlcmUgYXJlIG5vIGFjdGl2ZSB0YXJnZXRzLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBvbmxpbmUgc3RhdGUgaXMgc2V0IHRvIHVua25vd24gYmVjYXVzZSB0aGVyZSBpcyBubyBhY3RpdmUgYXR0ZW1wdFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGF0IGVzdGFibGlzaGluZyBhIGNvbm5lY3Rpb25cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5zZXQoT25saW5lU3RhdGUuVW5rbm93bik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5vbldhdGNoU3RyZWFtQ2hhbmdlID0gZnVuY3Rpb24gKHdhdGNoQ2hhbmdlLCBzbmFwc2hvdFZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb247XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayB0aGUgY2xpZW50IGFzIG9ubGluZSBzaW5jZSB3ZSBnb3QgYSBtZXNzYWdlIGZyb20gdGhlIHNlcnZlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5zZXQoT25saW5lU3RhdGUuT25saW5lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdhdGNoQ2hhbmdlIGluc3RhbmNlb2YgV2F0Y2hUYXJnZXRDaGFuZ2UgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhdGNoQ2hhbmdlLnN0YXRlID09PSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlbW92ZWQgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhdGNoQ2hhbmdlLmNhdXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSB3YXMgYW4gZXJyb3Igb24gYSB0YXJnZXQsIGRvbid0IHdhaXQgZm9yIGEgY29uc2lzdGVudCBzbmFwc2hvdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gcmFpc2UgZXZlbnRzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5oYW5kbGVUYXJnZXRFcnJvcih3YXRjaENoYW5nZSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3YXRjaENoYW5nZSBpbnN0YW5jZW9mIERvY3VtZW50V2F0Y2hDaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLmhhbmRsZURvY3VtZW50Q2hhbmdlKHdhdGNoQ2hhbmdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh3YXRjaENoYW5nZSBpbnN0YW5jZW9mIEV4aXN0ZW5jZUZpbHRlckNoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IuaGFuZGxlRXhpc3RlbmNlRmlsdGVyKHdhdGNoQ2hhbmdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCh3YXRjaENoYW5nZSBpbnN0YW5jZW9mIFdhdGNoVGFyZ2V0Q2hhbmdlLCAnRXhwZWN0ZWQgd2F0Y2hDaGFuZ2UgdG8gYmUgYW4gaW5zdGFuY2Ugb2YgV2F0Y2hUYXJnZXRDaGFuZ2UnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLmhhbmRsZVRhcmdldENoYW5nZSh3YXRjaENoYW5nZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhc25hcHNob3RWZXJzaW9uLmlzRXF1YWwoU25hcHNob3RWZXJzaW9uLk1JTikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUuZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHNuYXBzaG90VmVyc2lvbi5jb21wYXJlVG8obGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbikgPj0gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHJlY2VpdmVkIGEgdGFyZ2V0IGNoYW5nZSB3aXRoIGEgZ2xvYmFsIHNuYXBzaG90IGlmIHRoZSBzbmFwc2hvdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB2ZXJzaW9uIGlzIG5vdCBlcXVhbCB0byBTbmFwc2hvdFZlcnNpb24uTUlOLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJhaXNlV2F0Y2hTbmFwc2hvdChzbmFwc2hvdFZlcnNpb24pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgcmVjZWl2ZWQgYSB0YXJnZXQgY2hhbmdlIHdpdGggYSBnbG9iYWwgc25hcHNob3QgaWYgdGhlIHNuYXBzaG90XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZlcnNpb24gaXMgbm90IGVxdWFsIHRvIFNuYXBzaG90VmVyc2lvbi5NSU4uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRha2VzIGEgYmF0Y2ggb2YgY2hhbmdlcyBmcm9tIHRoZSBEYXRhc3RvcmUsIHJlcGFja2FnZXMgdGhlbSBhcyBhXHJcbiAgICAgKiBSZW1vdGVFdmVudCwgYW5kIHBhc3NlcyB0aGF0IG9uIHRvIHRoZSBsaXN0ZW5lciwgd2hpY2ggaXMgdHlwaWNhbGx5IHRoZVxyXG4gICAgICogU3luY0VuZ2luZS5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnJhaXNlV2F0Y2hTbmFwc2hvdCA9IGZ1bmN0aW9uIChzbmFwc2hvdFZlcnNpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCghc25hcHNob3RWZXJzaW9uLmlzRXF1YWwoU25hcHNob3RWZXJzaW9uLk1JTiksIFwiQ2FuJ3QgcmFpc2UgZXZlbnQgZm9yIHVua25vd24gU25hcHNob3RWZXJzaW9uXCIpO1xyXG4gICAgICAgIHZhciByZW1vdGVFdmVudCA9IHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLmNyZWF0ZVJlbW90ZUV2ZW50KHNuYXBzaG90VmVyc2lvbik7XHJcbiAgICAgICAgLy8gVXBkYXRlIGluLW1lbW9yeSByZXN1bWUgdG9rZW5zLiBMb2NhbFN0b3JlIHdpbGwgdXBkYXRlIHRoZVxyXG4gICAgICAgIC8vIHBlcnNpc3RlbnQgdmlldyBvZiB0aGVzZSB3aGVuIGFwcGx5aW5nIHRoZSBjb21wbGV0ZWQgUmVtb3RlRXZlbnQuXHJcbiAgICAgICAgZm9yRWFjaE51bWJlcihyZW1vdGVFdmVudC50YXJnZXRDaGFuZ2VzLCBmdW5jdGlvbiAodGFyZ2V0SWQsIGNoYW5nZSkge1xyXG4gICAgICAgICAgICBpZiAoY2hhbmdlLnJlc3VtZVRva2VuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBxdWVyeURhdGEgPSBfdGhpcy5saXN0ZW5UYXJnZXRzW3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cclxuICAgICAgICAgICAgICAgIGlmIChxdWVyeURhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5saXN0ZW5UYXJnZXRzW3RhcmdldElkXSA9IHF1ZXJ5RGF0YS5jb3B5KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdW1lVG9rZW46IGNoYW5nZS5yZXN1bWVUb2tlbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgc25hcHNob3RWZXJzaW9uOiBzbmFwc2hvdFZlcnNpb25cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIFJlLWVzdGFibGlzaCBsaXN0ZW5zIGZvciB0aGUgdGFyZ2V0cyB0aGF0IGhhdmUgYmVlbiBpbnZhbGlkYXRlZCBieVxyXG4gICAgICAgIC8vIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hlcy5cclxuICAgICAgICByZW1vdGVFdmVudC50YXJnZXRNaXNtYXRjaGVzLmZvckVhY2goZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeURhdGEgPSBfdGhpcy5saXN0ZW5UYXJnZXRzW3RhcmdldElkXTtcclxuICAgICAgICAgICAgaWYgKCFxdWVyeURhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBDbGVhciB0aGUgcmVzdW1lIHRva2VuIGZvciB0aGUgcXVlcnksIHNpbmNlIHdlJ3JlIGluIGEga25vd24gbWlzbWF0Y2hcclxuICAgICAgICAgICAgLy8gc3RhdGUuXHJcbiAgICAgICAgICAgIF90aGlzLmxpc3RlblRhcmdldHNbdGFyZ2V0SWRdID0gcXVlcnlEYXRhLmNvcHkoe1xyXG4gICAgICAgICAgICAgICAgcmVzdW1lVG9rZW46IGVtcHR5Qnl0ZVN0cmluZygpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyBDYXVzZSBhIGhhcmQgcmVzZXQgYnkgdW53YXRjaGluZyBhbmQgcmV3YXRjaGluZyBpbW1lZGlhdGVseSwgYnV0XHJcbiAgICAgICAgICAgIC8vIGRlbGliZXJhdGVseSBkb24ndCBzZW5kIGEgcmVzdW1lIHRva2VuIHNvIHRoYXQgd2UgZ2V0IGEgZnVsbCB1cGRhdGUuXHJcbiAgICAgICAgICAgIF90aGlzLnNlbmRVbndhdGNoUmVxdWVzdCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgIC8vIE1hcmsgdGhlIHF1ZXJ5IHdlIHNlbmQgYXMgYmVpbmcgb24gYmVoYWxmIG9mIGFuIGV4aXN0ZW5jZSBmaWx0ZXJcclxuICAgICAgICAgICAgLy8gbWlzbWF0Y2gsIGJ1dCBkb24ndCBhY3R1YWxseSByZXRhaW4gdGhhdCBpbiBsaXN0ZW5UYXJnZXRzLiBUaGlzIGVuc3VyZXNcclxuICAgICAgICAgICAgLy8gdGhhdCB3ZSBmbGFnIHRoZSBmaXJzdCByZS1saXN0ZW4gdGhpcyB3YXkgd2l0aG91dCBpbXBhY3RpbmcgZnV0dXJlXHJcbiAgICAgICAgICAgIC8vIGxpc3RlbnMgb2YgdGhpcyB0YXJnZXQgKHRoYXQgbWlnaHQgaGFwcGVuIGUuZy4gb24gcmVjb25uZWN0KS5cclxuICAgICAgICAgICAgdmFyIHJlcXVlc3RRdWVyeURhdGEgPSBuZXcgUXVlcnlEYXRhKHF1ZXJ5RGF0YS5xdWVyeSwgdGFyZ2V0SWQsIFF1ZXJ5UHVycG9zZS5FeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaCwgcXVlcnlEYXRhLnNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICAgICAgX3RoaXMuc2VuZFdhdGNoUmVxdWVzdChyZXF1ZXN0UXVlcnlEYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBGaW5hbGx5IHJhaXNlIHJlbW90ZSBldmVudFxyXG4gICAgICAgIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuYXBwbHlSZW1vdGVFdmVudChyZW1vdGVFdmVudCk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEhhbmRsZXMgYW4gZXJyb3Igb24gYSB0YXJnZXQgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5oYW5kbGVUYXJnZXRFcnJvciA9IGZ1bmN0aW9uICh3YXRjaENoYW5nZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KCEhd2F0Y2hDaGFuZ2UuY2F1c2UsICdIYW5kbGluZyB0YXJnZXQgZXJyb3Igd2l0aG91dCBhIGNhdXNlJyk7XHJcbiAgICAgICAgdmFyIGVycm9yJCQxID0gd2F0Y2hDaGFuZ2UuY2F1c2U7XHJcbiAgICAgICAgdmFyIHByb21pc2VDaGFpbiA9IFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgIHdhdGNoQ2hhbmdlLnRhcmdldElkcy5mb3JFYWNoKGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICBwcm9taXNlQ2hhaW4gPSBwcm9taXNlQ2hhaW4udGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbnModGhpcy5saXN0ZW5UYXJnZXRzLCB0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMubGlzdGVuVGFyZ2V0c1t0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnJlbW92ZVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnN5bmNFbmdpbmUucmVqZWN0TGlzdGVuKHRhcmdldElkLCBlcnJvciQkMSldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7IH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBwcm9taXNlQ2hhaW47XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBdHRlbXB0cyB0byBmaWxsIG91ciB3cml0ZSBwaXBlbGluZSB3aXRoIHdyaXRlcyBmcm9tIHRoZSBMb2NhbFN0b3JlLlxyXG4gICAgICpcclxuICAgICAqIENhbGxlZCBpbnRlcm5hbGx5IHRvIGJvb3RzdHJhcCBvciByZWZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIGFuZCBieVxyXG4gICAgICogU3luY0VuZ2luZSB3aGVuZXZlciB0aGVyZSBhcmUgbmV3IG11dGF0aW9ucyB0byBwcm9jZXNzLlxyXG4gICAgICpcclxuICAgICAqIFN0YXJ0cyB0aGUgd3JpdGUgc3RyZWFtIGlmIG5lY2Vzc2FyeS5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmZpbGxXcml0ZVBpcGVsaW5lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbGFzdEJhdGNoSWRSZXRyaWV2ZWQsIGJhdGNoO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYW5BZGRUb1dyaXRlUGlwZWxpbmUoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RCYXRjaElkUmV0cmlldmVkID0gdGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aCA+IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy53cml0ZVBpcGVsaW5lW3RoaXMud3JpdGVQaXBlbGluZS5sZW5ndGggLSAxXS5iYXRjaElkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IEJBVENISURfVU5LTk9XTjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLm5leHRNdXRhdGlvbkJhdGNoKGxhc3RCYXRjaElkUmV0cmlldmVkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXRjaCA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoYmF0Y2ggPT09IG51bGwpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud3JpdGVQaXBlbGluZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGVTdHJlYW0ubWFya0lkbGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkVG9Xcml0ZVBpcGVsaW5lKGJhdGNoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5maWxsV3JpdGVQaXBlbGluZSgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvdWxkU3RhcnRXcml0ZVN0cmVhbSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0V3JpdGVTdHJlYW0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHdlIGNhbiBhZGQgdG8gdGhlIHdyaXRlIHBpcGVsaW5lIChpLmUuIHRoZSBuZXR3b3JrIGlzXHJcbiAgICAgKiBlbmFibGVkIGFuZCB0aGUgd3JpdGUgcGlwZWxpbmUgaXMgbm90IGZ1bGwpLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuY2FuQWRkVG9Xcml0ZVBpcGVsaW5lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5jYW5Vc2VOZXR3b3JrKCkgJiYgdGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aCA8IE1BWF9QRU5ESU5HX1dSSVRFUyk7XHJcbiAgICB9O1xyXG4gICAgLy8gRm9yIHRlc3RpbmdcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5vdXRzdGFuZGluZ1dyaXRlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFF1ZXVlcyBhZGRpdGlvbmFsIHdyaXRlcyB0byBiZSBzZW50IHRvIHRoZSB3cml0ZSBzdHJlYW0sIHNlbmRpbmcgdGhlbVxyXG4gICAgICogaW1tZWRpYXRlbHkgaWYgdGhlIHdyaXRlIHN0cmVhbSBpcyBlc3RhYmxpc2hlZC5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmFkZFRvV3JpdGVQaXBlbGluZSA9IGZ1bmN0aW9uIChiYXRjaCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmNhbkFkZFRvV3JpdGVQaXBlbGluZSgpLCAnYWRkVG9Xcml0ZVBpcGVsaW5lIGNhbGxlZCB3aGVuIHBpcGVsaW5lIGlzIGZ1bGwnKTtcclxuICAgICAgICB0aGlzLndyaXRlUGlwZWxpbmUucHVzaChiYXRjaCk7XHJcbiAgICAgICAgaWYgKHRoaXMud3JpdGVTdHJlYW0uaXNPcGVuKCkgJiYgdGhpcy53cml0ZVN0cmVhbS5oYW5kc2hha2VDb21wbGV0ZSkge1xyXG4gICAgICAgICAgICB0aGlzLndyaXRlU3RyZWFtLndyaXRlTXV0YXRpb25zKGJhdGNoLm11dGF0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5zaG91bGRTdGFydFdyaXRlU3RyZWFtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5jYW5Vc2VOZXR3b3JrKCkgJiZcclxuICAgICAgICAgICAgIXRoaXMud3JpdGVTdHJlYW0uaXNTdGFydGVkKCkgJiZcclxuICAgICAgICAgICAgdGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aCA+IDApO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5zdGFydFdyaXRlU3RyZWFtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnNob3VsZFN0YXJ0V3JpdGVTdHJlYW0oKSwgJ3N0YXJ0V3JpdGVTdHJlYW0oKSBjYWxsZWQgd2hlbiBzaG91bGRTdGFydFdyaXRlU3RyZWFtKCkgaXMgZmFsc2UuJyk7XHJcbiAgICAgICAgdGhpcy53cml0ZVN0cmVhbS5zdGFydCgpO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5vbldyaXRlU3RyZWFtT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndyaXRlU3RyZWFtLndyaXRlSGFuZHNoYWtlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5vbldyaXRlSGFuZHNoYWtlQ29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBSZWNvcmQgdGhlIHN0cmVhbSB0b2tlbi5cclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgIC5zZXRMYXN0U3RyZWFtVG9rZW4odGhpcy53cml0ZVN0cmVhbS5sYXN0U3RyZWFtVG9rZW4pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gU2VuZCB0aGUgd3JpdGUgcGlwZWxpbmUgbm93IHRoYXQgdGhlIHN0cmVhbSBpcyBlc3RhYmxpc2hlZC5cclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IF90aGlzLndyaXRlUGlwZWxpbmU7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmF0Y2ggPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBfdGhpcy53cml0ZVN0cmVhbS53cml0ZU11dGF0aW9ucyhiYXRjaC5tdXRhdGlvbnMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIF90aGlzLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhlcnIpOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFZlcmlmaWVzIHRoZSBlcnJvciB0aHJvd24gYnkgYW4gTG9jYWxTdG9yZSBvcGVyYXRpb24uIElmIGEgTG9jYWxTdG9yZVxyXG4gICAgICogb3BlcmF0aW9uIGZhaWxzIGJlY2F1c2UgdGhlIHByaW1hcnkgbGVhc2UgaGFzIGJlZW4gdGFrZW4gYnkgYW5vdGhlciBjbGllbnQsXHJcbiAgICAgKiB3ZSBpZ25vcmUgdGhlIGVycm9yLiBBbGwgb3RoZXIgZXJyb3JzIGFyZSByZS10aHJvd24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGVyciBBbiBlcnJvciByZXR1cm5lZCBieSBhIExvY2FsU3RvcmUgb3BlcmF0aW9uLlxyXG4gICAgICogQHJldHVybiBBIFByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciB3ZSByZWNvdmVyZWQsIG9yIHRoZSBvcmlnaW5hbCBlcnJvci5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICBpZiAoaXNQcmltYXJ5TGVhc2VMb3N0RXJyb3IoZXJyKSkge1xyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDgsICdVbmV4cGVjdGVkbHkgbG9zdCBwcmltYXJ5IGxlYXNlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5vbk11dGF0aW9uUmVzdWx0ID0gZnVuY3Rpb24gKGNvbW1pdFZlcnNpb24sIHJlc3VsdHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFRoaXMgaXMgYSByZXNwb25zZSB0byBhIHdyaXRlIGNvbnRhaW5pbmcgbXV0YXRpb25zIGFuZCBzaG91bGQgYmVcclxuICAgICAgICAvLyBjb3JyZWxhdGVkIHRvIHRoZSBmaXJzdCB3cml0ZSBpbiBvdXIgd3JpdGUgcGlwZWxpbmUuXHJcbiAgICAgICAgYXNzZXJ0KHRoaXMud3JpdGVQaXBlbGluZS5sZW5ndGggPiAwLCAnR290IHJlc3VsdCBmb3IgZW1wdHkgd3JpdGUgcGlwZWxpbmUnKTtcclxuICAgICAgICB2YXIgYmF0Y2ggPSB0aGlzLndyaXRlUGlwZWxpbmUuc2hpZnQoKTtcclxuICAgICAgICB2YXIgc3VjY2VzcyA9IE11dGF0aW9uQmF0Y2hSZXN1bHQuZnJvbShiYXRjaCwgY29tbWl0VmVyc2lvbiwgcmVzdWx0cywgdGhpcy53cml0ZVN0cmVhbS5sYXN0U3RyZWFtVG9rZW4pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuYXBwbHlTdWNjZXNzZnVsV3JpdGUoc3VjY2VzcykudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB3aXRoIHRoZSBjb21wbGV0aW9uIG9mIHRoaXMgbXV0YXRpb24gYW5vdGhlclxyXG4gICAgICAgICAgICAvLyBzbG90IGhhcyBmcmVlZCB1cC5cclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmZpbGxXcml0ZVBpcGVsaW5lKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLm9uV3JpdGVTdHJlYW1DbG9zZSA9IGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgZXJyb3JIYW5kbGluZztcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IkJDEgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEdyYWNlZnVsIHN0b3AgKGR1ZSB0byBzdG9wKCkgb3IgaWRsZSB0aW1lb3V0KS4gTWFrZSBzdXJlIHRoYXQnc1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRlc2lyYWJsZS5cclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIXRoaXMuc2hvdWxkU3RhcnRXcml0ZVN0cmVhbSgpLCAnV3JpdGUgc3RyZWFtIHdhcyBzdG9wcGVkIGdyYWNlZnVsbHkgd2hpbGUgc3RpbGwgbmVlZGVkLicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHdyaXRlIHN0cmVhbSBjbG9zZWQgZHVlIHRvIGFuIGVycm9yLCBpbnZva2UgdGhlIGVycm9yIGNhbGxiYWNrcyBpZlxyXG4gICAgICAgICAgICAgICAgLy8gdGhlcmUgYXJlIHBlbmRpbmcgd3JpdGVzLlxyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yJCQxICYmIHRoaXMud3JpdGVQaXBlbGluZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JIYW5kbGluZyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy53cml0ZVN0cmVhbS5oYW5kc2hha2VDb21wbGV0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGVycm9yIGFmZmVjdHMgdGhlIGFjdHVhbCB3cml0ZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JIYW5kbGluZyA9IHRoaXMuaGFuZGxlV3JpdGVFcnJvcihlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGVyZSB3YXMgYW4gZXJyb3IgYmVmb3JlIHRoZSBoYW5kc2hha2UgaGFzIGZpbmlzaGVkLCBpdCdzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvc3NpYmxlIHRoYXQgdGhlIHNlcnZlciBpcyB1bmFibGUgdG8gcHJvY2VzcyB0aGUgc3RyZWFtIHRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlJ3JlIHNlbmRpbmcuIChQZXJoYXBzIGl0J3MgdG9vIG9sZD8pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ySGFuZGxpbmcgPSB0aGlzLmhhbmRsZUhhbmRzaGFrZUVycm9yKGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGVycm9ySGFuZGxpbmcudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgd3JpdGUgc3RyZWFtIG1pZ2h0IGhhdmUgYmVlbiBzdGFydGVkIGJ5IHJlZmlsbGluZyB0aGUgd3JpdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBpcGVsaW5lIGZvciBmYWlsZWQgd3JpdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc2hvdWxkU3RhcnRXcml0ZVN0cmVhbSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3RhcnRXcml0ZVN0cmVhbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5oYW5kbGVIYW5kc2hha2VFcnJvciA9IGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlc2V0IHRoZSB0b2tlbiBpZiBpdCdzIGEgcGVybWFuZW50IGVycm9yIG9yIHRoZSBlcnJvciBjb2RlIGlzXHJcbiAgICAgICAgICAgICAgICAvLyBBQk9SVEVELCBzaWduYWxpbmcgdGhlIHdyaXRlIHN0cmVhbSBpcyBubyBsb25nZXIgdmFsaWQuXHJcbiAgICAgICAgICAgICAgICBpZiAoaXNQZXJtYW5lbnRFcnJvcihlcnJvciQkMS5jb2RlKSB8fCBlcnJvciQkMS5jb2RlID09PSBDb2RlLkFCT1JURUQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDgsICdSZW1vdGVTdG9yZSBlcnJvciBiZWZvcmUgY29tcGxldGVkIGhhbmRzaGFrZTsgcmVzZXR0aW5nIHN0cmVhbSB0b2tlbjogJywgdGhpcy53cml0ZVN0cmVhbS5sYXN0U3RyZWFtVG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGVTdHJlYW0ubGFzdFN0cmVhbVRva2VuID0gZW1wdHlCeXRlU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldExhc3RTdHJlYW1Ub2tlbihlbXB0eUJ5dGVTdHJpbmcoKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBfdGhpcy5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZXJyKTsgfSldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gU29tZSBvdGhlciBlcnJvciwgZG9uJ3QgcmVzZXQgc3RyZWFtIHRva2VuLiBPdXIgc3RyZWFtIGxvZ2ljIHdpbGxcclxuICAgICAgICAgICAgICAgICAgICAvLyBqdXN0IHJldHJ5IHdpdGggZXhwb25lbnRpYWwgYmFja29mZi5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmhhbmRsZVdyaXRlRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGJhdGNoO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc1Blcm1hbmVudEVycm9yKGVycm9yJCQxLmNvZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmF0Y2ggPSB0aGlzLndyaXRlUGlwZWxpbmUuc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UgaXQncyBhbHNvIHVubGlrZWx5IHRoYXQgdGhlIHNlcnZlciBpdHNlbGYgaXMgbWVsdGluZ1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRvd24gLS0gdGhpcyB3YXMganVzdCBhIGJhZCByZXF1ZXN0IHNvIGluaGliaXQgYmFja29mZiBvbiB0aGUgbmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc3RhcnQuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53cml0ZVN0cmVhbS5pbmhpYml0QmFja29mZigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnN5bmNFbmdpbmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZWplY3RGYWlsZWRXcml0ZShiYXRjaC5iYXRjaElkLCBlcnJvciQkMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB3aXRoIHRoZSBjb21wbGV0aW9uIG9mIHRoaXMgbXV0YXRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFub3RoZXIgc2xvdCBoYXMgZnJlZWQgdXAuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZmlsbFdyaXRlUGlwZWxpbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVHJhbnNpZW50IGVycm9yLCBqdXN0IGxldCB0aGUgcmV0cnkgbG9naWMga2ljayBpbi5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmNyZWF0ZVRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgVHJhbnNhY3Rpb24odGhpcy5kYXRhc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYW5Vc2VOZXR3b3JrKCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUZWFyIGRvd24gYW5kIHJlLWNyZWF0ZSBvdXIgbmV0d29yayBzdHJlYW1zLiBUaGlzIHdpbGwgZW5zdXJlIHdlIGdldCBhIGZyZXNoIGF1dGggdG9rZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yIHRoZSBuZXcgdXNlciBhbmQgcmUtZmlsbCB0aGUgd3JpdGUgcGlwZWxpbmUgd2l0aCBuZXcgbXV0YXRpb25zIGZyb20gdGhlIExvY2FsU3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gKHNpbmNlIG11dGF0aW9ucyBhcmUgcGVyLXVzZXIpLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDgsICdSZW1vdGVTdG9yZSByZXN0YXJ0aW5nIHN0cmVhbXMgZm9yIG5ldyBjcmVkZW50aWFsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5kaXNhYmxlTmV0d29ya0ludGVybmFsKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5zZXQoT25saW5lU3RhdGUuVW5rbm93bik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZW5hYmxlTmV0d29yaygpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRvZ2dsZXMgdGhlIG5ldHdvcmsgc3RhdGUgd2hlbiB0aGUgY2xpZW50IGdhaW5zIG9yIGxvc2VzIGl0cyBwcmltYXJ5IGxlYXNlLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuYXBwbHlQcmltYXJ5U3RhdGUgPSBmdW5jdGlvbiAoaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1ByaW1hcnkgPSBpc1ByaW1hcnk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGlzUHJpbWFyeSAmJiB0aGlzLm5ldHdvcmtFbmFibGVkKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZW5hYmxlTmV0d29yaygpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFpc1ByaW1hcnkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmRpc2FibGVOZXR3b3JrSW50ZXJuYWwoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLnNldChPbmxpbmVTdGF0ZS5Vbmtub3duKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVtb3RlU3RvcmU7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogSG9sZHMgdGhlIGxpc3RlbmVycyBhbmQgdGhlIGxhc3QgcmVjZWl2ZWQgVmlld1NuYXBzaG90IGZvciBhIHF1ZXJ5IGJlaW5nXHJcbiAqIHRyYWNrZWQgYnkgRXZlbnRNYW5hZ2VyLlxyXG4gKi9cclxudmFyIFF1ZXJ5TGlzdGVuZXJzSW5mbyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5TGlzdGVuZXJzSW5mbygpIHtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IFtdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFF1ZXJ5TGlzdGVuZXJzSW5mbztcclxufSgpKTtcclxuLyoqXHJcbiAqIEV2ZW50TWFuYWdlciBpcyByZXNwb25zaWJsZSBmb3IgbWFwcGluZyBxdWVyaWVzIHRvIHF1ZXJ5IGV2ZW50IGVtaXR0ZXJzLlxyXG4gKiBJdCBoYW5kbGVzIFwiZmFuLW91dFwiLiAtLSBJZGVudGljYWwgcXVlcmllcyB3aWxsIHJlLXVzZSB0aGUgc2FtZSB3YXRjaCBvbiB0aGVcclxuICogYmFja2VuZC5cclxuICovXHJcbnZhciBFdmVudE1hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFdmVudE1hbmFnZXIoc3luY0VuZ2luZSkge1xyXG4gICAgICAgIHRoaXMuc3luY0VuZ2luZSA9IHN5bmNFbmdpbmU7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzID0gbmV3IE9iamVjdE1hcChmdW5jdGlvbiAocSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcS5jYW5vbmljYWxJZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGUgPSBPbmxpbmVTdGF0ZS5Vbmtub3duO1xyXG4gICAgICAgIHRoaXMuc3luY0VuZ2luZS5zdWJzY3JpYmUodGhpcyk7XHJcbiAgICB9XHJcbiAgICBFdmVudE1hbmFnZXIucHJvdG90eXBlLmxpc3RlbiA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xyXG4gICAgICAgIHZhciBxdWVyeSA9IGxpc3RlbmVyLnF1ZXJ5O1xyXG4gICAgICAgIHZhciBmaXJzdExpc3RlbiA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBxdWVyeUluZm8gPSB0aGlzLnF1ZXJpZXMuZ2V0KHF1ZXJ5KTtcclxuICAgICAgICBpZiAoIXF1ZXJ5SW5mbykge1xyXG4gICAgICAgICAgICBmaXJzdExpc3RlbiA9IHRydWU7XHJcbiAgICAgICAgICAgIHF1ZXJ5SW5mbyA9IG5ldyBRdWVyeUxpc3RlbmVyc0luZm8oKTtcclxuICAgICAgICAgICAgdGhpcy5xdWVyaWVzLnNldChxdWVyeSwgcXVlcnlJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcXVlcnlJbmZvLmxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcclxuICAgICAgICBsaXN0ZW5lci5hcHBseU9ubGluZVN0YXRlQ2hhbmdlKHRoaXMub25saW5lU3RhdGUpO1xyXG4gICAgICAgIGlmIChxdWVyeUluZm8udmlld1NuYXApXHJcbiAgICAgICAgICAgIGxpc3RlbmVyLm9uVmlld1NuYXBzaG90KHF1ZXJ5SW5mby52aWV3U25hcCk7XHJcbiAgICAgICAgaWYgKGZpcnN0TGlzdGVuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN5bmNFbmdpbmUubGlzdGVuKHF1ZXJ5KS50aGVuKGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlJbmZvLnRhcmdldElkID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0SWQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShxdWVyeUluZm8udGFyZ2V0SWQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBFdmVudE1hbmFnZXIucHJvdG90eXBlLnVubGlzdGVuID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeSwgbGFzdExpc3RlbiwgcXVlcnlJbmZvLCBpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gbGlzdGVuZXIucXVlcnk7XHJcbiAgICAgICAgICAgICAgICBsYXN0TGlzdGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBxdWVyeUluZm8gPSB0aGlzLnF1ZXJpZXMuZ2V0KHF1ZXJ5KTtcclxuICAgICAgICAgICAgICAgIGlmIChxdWVyeUluZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICBpID0gcXVlcnlJbmZvLmxpc3RlbmVycy5pbmRleE9mKGxpc3RlbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5SW5mby5saXN0ZW5lcnMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0TGlzdGVuID0gcXVlcnlJbmZvLmxpc3RlbmVycy5sZW5ndGggPT09IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGxhc3RMaXN0ZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJpZXMuZGVsZXRlKHF1ZXJ5KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5zeW5jRW5naW5lLnVubGlzdGVuKHF1ZXJ5KV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEV2ZW50TWFuYWdlci5wcm90b3R5cGUub25XYXRjaENoYW5nZSA9IGZ1bmN0aW9uICh2aWV3U25hcHMpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHZpZXdTbmFwc18xID0gdmlld1NuYXBzOyBfaSA8IHZpZXdTbmFwc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgdmlld1NuYXAgPSB2aWV3U25hcHNfMVtfaV07XHJcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IHZpZXdTbmFwLnF1ZXJ5O1xyXG4gICAgICAgICAgICB2YXIgcXVlcnlJbmZvID0gdGhpcy5xdWVyaWVzLmdldChxdWVyeSk7XHJcbiAgICAgICAgICAgIGlmIChxdWVyeUluZm8pIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgX2IgPSBxdWVyeUluZm8ubGlzdGVuZXJzOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IF9iW19hXTtcclxuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lci5vblZpZXdTbmFwc2hvdCh2aWV3U25hcCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBxdWVyeUluZm8udmlld1NuYXAgPSB2aWV3U25hcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBFdmVudE1hbmFnZXIucHJvdG90eXBlLm9uV2F0Y2hFcnJvciA9IGZ1bmN0aW9uIChxdWVyeSwgZXJyb3IpIHtcclxuICAgICAgICB2YXIgcXVlcnlJbmZvID0gdGhpcy5xdWVyaWVzLmdldChxdWVyeSk7XHJcbiAgICAgICAgaWYgKHF1ZXJ5SW5mbykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gcXVlcnlJbmZvLmxpc3RlbmVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIGxpc3RlbmVyLm9uRXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFJlbW92ZSBhbGwgbGlzdGVuZXJzLiBOT1RFOiBXZSBkb24ndCBuZWVkIHRvIGNhbGwgc3luY0VuZ2luZS51bmxpc3RlbigpXHJcbiAgICAgICAgLy8gYWZ0ZXIgYW4gZXJyb3IuXHJcbiAgICAgICAgdGhpcy5xdWVyaWVzLmRlbGV0ZShxdWVyeSk7XHJcbiAgICB9O1xyXG4gICAgRXZlbnRNYW5hZ2VyLnByb3RvdHlwZS5vbk9ubGluZVN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZSA9IG9ubGluZVN0YXRlO1xyXG4gICAgICAgIHRoaXMucXVlcmllcy5mb3JFYWNoKGZ1bmN0aW9uIChfLCBxdWVyeUluZm8pIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHF1ZXJ5SW5mby5saXN0ZW5lcnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lci5hcHBseU9ubGluZVN0YXRlQ2hhbmdlKG9ubGluZVN0YXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBFdmVudE1hbmFnZXI7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBRdWVyeUxpc3RlbmVyIHRha2VzIGEgc2VyaWVzIG9mIGludGVybmFsIHZpZXcgc25hcHNob3RzIGFuZCBkZXRlcm1pbmVzXHJcbiAqIHdoZW4gdG8gcmFpc2UgdGhlIGV2ZW50LlxyXG4gKlxyXG4gKiBJdCB1c2VzIGFuIE9ic2VydmVyIHRvIGRpc3BhdGNoIGV2ZW50cy5cclxuICovXHJcbnZhciBRdWVyeUxpc3RlbmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnlMaXN0ZW5lcihxdWVyeSwgcXVlcnlPYnNlcnZlciwgb3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICB0aGlzLnF1ZXJ5T2JzZXJ2ZXIgPSBxdWVyeU9ic2VydmVyO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEluaXRpYWwgc25hcHNob3RzIChlLmcuIGZyb20gY2FjaGUpIG1heSBub3QgYmUgcHJvcGFnYXRlZCB0byB0aGUgd3JhcHBlZFxyXG4gICAgICAgICAqIG9ic2VydmVyLiBUaGlzIGZsYWcgaXMgc2V0IHRvIHRydWUgb25jZSB3ZSd2ZSBhY3R1YWxseSByYWlzZWQgYW4gZXZlbnQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5yYWlzZWRJbml0aWFsRXZlbnQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gT25saW5lU3RhdGUuVW5rbm93bjtcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgfVxyXG4gICAgUXVlcnlMaXN0ZW5lci5wcm90b3R5cGUub25WaWV3U25hcHNob3QgPSBmdW5jdGlvbiAoc25hcCkge1xyXG4gICAgICAgIGFzc2VydChzbmFwLmRvY0NoYW5nZXMubGVuZ3RoID4gMCB8fCBzbmFwLnN5bmNTdGF0ZUNoYW5nZWQsICdXZSBnb3QgYSBuZXcgc25hcHNob3Qgd2l0aCBubyBjaGFuZ2VzPycpO1xyXG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXMpIHtcclxuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBtZXRhZGF0YSBvbmx5IGNoYW5nZXMuXHJcbiAgICAgICAgICAgIHZhciBkb2NDaGFuZ2VzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBzbmFwLmRvY0NoYW5nZXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jQ2hhbmdlID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRvY0NoYW5nZS50eXBlICE9PSBDaGFuZ2VUeXBlLk1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jQ2hhbmdlcy5wdXNoKGRvY0NoYW5nZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc25hcCA9IG5ldyBWaWV3U25hcHNob3Qoc25hcC5xdWVyeSwgc25hcC5kb2NzLCBzbmFwLm9sZERvY3MsIGRvY0NoYW5nZXMsIHNuYXAubXV0YXRlZEtleXMsIHNuYXAuZnJvbUNhY2hlLCBzbmFwLnN5bmNTdGF0ZUNoYW5nZWQsIFxyXG4gICAgICAgICAgICAvKiBleGNsdWRlc01ldGFkYXRhQ2hhbmdlcz0gKi8gdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5yYWlzZWRJbml0aWFsRXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2hvdWxkUmFpc2VJbml0aWFsRXZlbnQoc25hcCwgdGhpcy5vbmxpbmVTdGF0ZSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmFpc2VJbml0aWFsRXZlbnQoc25hcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5zaG91bGRSYWlzZUV2ZW50KHNuYXApKSB7XHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlPYnNlcnZlci5uZXh0KHNuYXApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNuYXAgPSBzbmFwO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5TGlzdGVuZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5T2JzZXJ2ZXIuZXJyb3IoZXJyb3IpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5TGlzdGVuZXIucHJvdG90eXBlLmFwcGx5T25saW5lU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gb25saW5lU3RhdGU7XHJcbiAgICAgICAgaWYgKHRoaXMuc25hcCAmJlxyXG4gICAgICAgICAgICAhdGhpcy5yYWlzZWRJbml0aWFsRXZlbnQgJiZcclxuICAgICAgICAgICAgdGhpcy5zaG91bGRSYWlzZUluaXRpYWxFdmVudCh0aGlzLnNuYXAsIG9ubGluZVN0YXRlKSkge1xyXG4gICAgICAgICAgICB0aGlzLnJhaXNlSW5pdGlhbEV2ZW50KHRoaXMuc25hcCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFF1ZXJ5TGlzdGVuZXIucHJvdG90eXBlLnNob3VsZFJhaXNlSW5pdGlhbEV2ZW50ID0gZnVuY3Rpb24gKHNuYXAsIG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLnJhaXNlZEluaXRpYWxFdmVudCwgJ0RldGVybWluaW5nIHdoZXRoZXIgdG8gcmFpc2UgZmlyc3QgZXZlbnQgYnV0IGFscmVhZHkgaGFkIGZpcnN0IGV2ZW50Jyk7XHJcbiAgICAgICAgLy8gQWx3YXlzIHJhaXNlIHRoZSBmaXJzdCBldmVudCB3aGVuIHdlJ3JlIHN5bmNlZFxyXG4gICAgICAgIGlmICghc25hcC5mcm9tQ2FjaGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE5PVEU6IFdlIGNvbnNpZGVyIE9ubGluZVN0YXRlLlVua25vd24gYXMgb25saW5lIChpdCBzaG91bGQgYmVjb21lIE9mZmxpbmVcclxuICAgICAgICAvLyBvciBPbmxpbmUgaWYgd2Ugd2FpdCBsb25nIGVub3VnaCkuXHJcbiAgICAgICAgdmFyIG1heWJlT25saW5lID0gb25saW5lU3RhdGUgIT09IE9ubGluZVN0YXRlLk9mZmxpbmU7XHJcbiAgICAgICAgLy8gRG9uJ3QgcmFpc2UgdGhlIGV2ZW50IGlmIHdlJ3JlIG9ubGluZSwgYXJlbid0IHN5bmNlZCB5ZXQgKGNoZWNrZWRcclxuICAgICAgICAvLyBhYm92ZSkgYW5kIGFyZSB3YWl0aW5nIGZvciBhIHN5bmMuXHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy53YWl0Rm9yU3luY1doZW5PbmxpbmUgJiYgbWF5YmVPbmxpbmUpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KHNuYXAuZnJvbUNhY2hlLCAnV2FpdGluZyBmb3Igc3luYywgYnV0IHNuYXBzaG90IGlzIG5vdCBmcm9tIGNhY2hlJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gUmFpc2UgZGF0YSBmcm9tIGNhY2hlIGlmIHdlIGhhdmUgYW55IGRvY3VtZW50cyBvciB3ZSBhcmUgb2ZmbGluZVxyXG4gICAgICAgIHJldHVybiAhc25hcC5kb2NzLmlzRW1wdHkoKSB8fCBvbmxpbmVTdGF0ZSA9PT0gT25saW5lU3RhdGUuT2ZmbGluZTtcclxuICAgIH07XHJcbiAgICBRdWVyeUxpc3RlbmVyLnByb3RvdHlwZS5zaG91bGRSYWlzZUV2ZW50ID0gZnVuY3Rpb24gKHNuYXApIHtcclxuICAgICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIGhhbmRsZSBpbmNsdWRlRG9jdW1lbnRNZXRhZGF0YUNoYW5nZXMgaGVyZSBiZWNhdXNlXHJcbiAgICAgICAgLy8gdGhlIE1ldGFkYXRhIG9ubHkgY2hhbmdlcyBoYXZlIGFscmVhZHkgYmVlbiBzdHJpcHBlZCBvdXQgaWYgbmVlZGVkLlxyXG4gICAgICAgIC8vIEF0IHRoaXMgcG9pbnQgdGhlIG9ubHkgY2hhbmdlcyB3ZSB3aWxsIHNlZSBhcmUgdGhlIG9uZXMgd2Ugc2hvdWxkXHJcbiAgICAgICAgLy8gcHJvcGFnYXRlLlxyXG4gICAgICAgIGlmIChzbmFwLmRvY0NoYW5nZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGhhc1BlbmRpbmdXcml0ZXNDaGFuZ2VkID0gdGhpcy5zbmFwICYmIHRoaXMuc25hcC5oYXNQZW5kaW5nV3JpdGVzICE9PSBzbmFwLmhhc1BlbmRpbmdXcml0ZXM7XHJcbiAgICAgICAgaWYgKHNuYXAuc3luY1N0YXRlQ2hhbmdlZCB8fCBoYXNQZW5kaW5nV3JpdGVzQ2hhbmdlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPT09IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEdlbmVyYWxseSB3ZSBzaG91bGQgaGF2ZSBoaXQgb25lIG9mIHRoZSBjYXNlcyBhYm92ZSwgYnV0IGl0J3MgcG9zc2libGVcclxuICAgICAgICAvLyB0byBnZXQgaGVyZSBpZiB0aGVyZSB3ZXJlIG9ubHkgbWV0YWRhdGEgZG9jQ2hhbmdlcyBhbmQgdGhleSBnb3RcclxuICAgICAgICAvLyBzdHJpcHBlZCBvdXQuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5TGlzdGVuZXIucHJvdG90eXBlLnJhaXNlSW5pdGlhbEV2ZW50ID0gZnVuY3Rpb24gKHNuYXApIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMucmFpc2VkSW5pdGlhbEV2ZW50LCAnVHJ5aW5nIHRvIHJhaXNlIGluaXRpYWwgZXZlbnRzIGZvciBzZWNvbmQgdGltZScpO1xyXG4gICAgICAgIHNuYXAgPSBWaWV3U25hcHNob3QuZnJvbUluaXRpYWxEb2N1bWVudHMoc25hcC5xdWVyeSwgc25hcC5kb2NzLCBzbmFwLm11dGF0ZWRLZXlzLCBzbmFwLmZyb21DYWNoZSk7XHJcbiAgICAgICAgdGhpcy5yYWlzZWRJbml0aWFsRXZlbnQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucXVlcnlPYnNlcnZlci5uZXh0KHNuYXApO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBRdWVyeUxpc3RlbmVyO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEEgc2V0IG9mIGNoYW5nZXMgdG8gd2hhdCBkb2N1bWVudHMgYXJlIGN1cnJlbnRseSBpbiB2aWV3IGFuZCBvdXQgb2YgdmlldyBmb3JcclxuICogYSBnaXZlbiBxdWVyeS4gVGhlc2UgY2hhbmdlcyBhcmUgc2VudCB0byB0aGUgTG9jYWxTdG9yZSBieSB0aGUgVmlldyAodmlhXHJcbiAqIHRoZSBTeW5jRW5naW5lKSBhbmQgYXJlIHVzZWQgdG8gcGluIC8gdW5waW4gZG9jdW1lbnRzIGFzIGFwcHJvcHJpYXRlLlxyXG4gKi9cclxudmFyIExvY2FsVmlld0NoYW5nZXMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMb2NhbFZpZXdDaGFuZ2VzKHRhcmdldElkLCBhZGRlZEtleXMsIHJlbW92ZWRLZXlzKSB7XHJcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHRhcmdldElkO1xyXG4gICAgICAgIHRoaXMuYWRkZWRLZXlzID0gYWRkZWRLZXlzO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlZEtleXMgPSByZW1vdmVkS2V5cztcclxuICAgIH1cclxuICAgIExvY2FsVmlld0NoYW5nZXMuZnJvbVNuYXBzaG90ID0gZnVuY3Rpb24gKHRhcmdldElkLCB2aWV3U25hcHNob3QpIHtcclxuICAgICAgICB2YXIgYWRkZWRLZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB2YXIgcmVtb3ZlZEtleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB2aWV3U25hcHNob3QuZG9jQ2hhbmdlczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGRvY0NoYW5nZSA9IF9hW19pXTtcclxuICAgICAgICAgICAgc3dpdGNoIChkb2NDaGFuZ2UudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLkFkZGVkOlxyXG4gICAgICAgICAgICAgICAgICAgIGFkZGVkS2V5cyA9IGFkZGVkS2V5cy5hZGQoZG9jQ2hhbmdlLmRvYy5rZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLlJlbW92ZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZEtleXMgPSByZW1vdmVkS2V5cy5hZGQoZG9jQ2hhbmdlLmRvYy5rZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIC8vIGRvIG5vdGhpbmdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IExvY2FsVmlld0NoYW5nZXModGFyZ2V0SWQsIGFkZGVkS2V5cywgcmVtb3ZlZEtleXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBMb2NhbFZpZXdDaGFuZ2VzO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIEFkZGVkTGltYm9Eb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFkZGVkTGltYm9Eb2N1bWVudChrZXkpIHtcclxuICAgICAgICB0aGlzLmtleSA9IGtleTtcclxuICAgIH1cclxuICAgIHJldHVybiBBZGRlZExpbWJvRG9jdW1lbnQ7XHJcbn0oKSk7XHJcbnZhciBSZW1vdmVkTGltYm9Eb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlbW92ZWRMaW1ib0RvY3VtZW50KGtleSkge1xyXG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFJlbW92ZWRMaW1ib0RvY3VtZW50O1xyXG59KCkpO1xyXG4vKipcclxuICogVmlldyBpcyByZXNwb25zaWJsZSBmb3IgY29tcHV0aW5nIHRoZSBmaW5hbCBtZXJnZWQgdHJ1dGggb2Ygd2hhdCBkb2NzIGFyZSBpblxyXG4gKiBhIHF1ZXJ5LiBJdCBnZXRzIG5vdGlmaWVkIG9mIGxvY2FsIGFuZCByZW1vdGUgY2hhbmdlcyB0byBkb2NzLCBhbmQgYXBwbGllc1xyXG4gKiB0aGUgcXVlcnkgZmlsdGVycyBhbmQgbGltaXRzIHRvIGRldGVybWluZSB0aGUgbW9zdCBjb3JyZWN0IHBvc3NpYmxlIHJlc3VsdHMuXHJcbiAqL1xyXG52YXIgVmlldyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFZpZXcocXVlcnksIFxyXG4gICAgLyoqIERvY3VtZW50cyBpbmNsdWRlZCBpbiB0aGUgcmVtb3RlIHRhcmdldCAqL1xyXG4gICAgX3N5bmNlZERvY3VtZW50cykge1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICB0aGlzLl9zeW5jZWREb2N1bWVudHMgPSBfc3luY2VkRG9jdW1lbnRzO1xyXG4gICAgICAgIHRoaXMuc3luY1N0YXRlID0gbnVsbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGZsYWcgd2hldGhlciB0aGUgdmlldyBpcyBjdXJyZW50IHdpdGggdGhlIGJhY2tlbmQuIEEgdmlldyBpcyBjb25zaWRlcmVkXHJcbiAgICAgICAgICogY3VycmVudCBhZnRlciBpdCBoYXMgc2VlbiB0aGUgY3VycmVudCBmbGFnIGZyb20gdGhlIGJhY2tlbmQgYW5kIGRpZCBub3RcclxuICAgICAgICAgKiBsb3NlIGNvbnNpc3RlbmN5IHdpdGhpbiB0aGUgd2F0Y2ggc3RyZWFtIChlLmcuIGJlY2F1c2Ugb2YgYW4gZXhpc3RlbmNlXHJcbiAgICAgICAgICogZmlsdGVyIG1pc21hdGNoKS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSBmYWxzZTtcclxuICAgICAgICAvKiogRG9jdW1lbnRzIGluIHRoZSB2aWV3IGJ1dCBub3QgaW4gdGhlIHJlbW90ZSB0YXJnZXQgKi9cclxuICAgICAgICB0aGlzLmxpbWJvRG9jdW1lbnRzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICAvKiogRG9jdW1lbnQgS2V5cyB0aGF0IGhhdmUgbG9jYWwgY2hhbmdlcyAqL1xyXG4gICAgICAgIHRoaXMubXV0YXRlZEtleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTZXQgPSBuZXcgRG9jdW1lbnRTZXQocXVlcnkuZG9jQ29tcGFyYXRvci5iaW5kKHF1ZXJ5KSk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlldy5wcm90b3R5cGUsIFwic3luY2VkRG9jdW1lbnRzXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgc2V0IG9mIHJlbW90ZSBkb2N1bWVudHMgdGhhdCB0aGUgc2VydmVyIGhhcyB0b2xkIHVzIGJlbG9uZ3MgdG8gdGhlIHRhcmdldCBhc3NvY2lhdGVkIHdpdGhcclxuICAgICAgICAgKiB0aGlzIHZpZXcuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zeW5jZWREb2N1bWVudHM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYSBzZXQgb2YgZG9jIGNoYW5nZXMsIGFwcGxpZXMgdGhlIHF1ZXJ5IGxpbWl0LCBhbmQgY29tcHV0ZXNcclxuICAgICAqIHdoYXQgdGhlIG5ldyByZXN1bHRzIHNob3VsZCBiZSwgd2hhdCB0aGUgY2hhbmdlcyB3ZXJlLCBhbmQgd2hldGhlciB3ZSBtYXlcclxuICAgICAqIG5lZWQgdG8gZ28gYmFjayB0byB0aGUgbG9jYWwgY2FjaGUgZm9yIG1vcmUgcmVzdWx0cy4gRG9lcyBub3QgbWFrZSBhbnlcclxuICAgICAqIGNoYW5nZXMgdG8gdGhlIHZpZXcuXHJcbiAgICAgKiBAcGFyYW0gZG9jQ2hhbmdlcyBUaGUgZG9jIGNoYW5nZXMgdG8gYXBwbHkgdG8gdGhpcyB2aWV3LlxyXG4gICAgICogQHBhcmFtIHByZXZpb3VzQ2hhbmdlcyBJZiB0aGlzIGlzIGJlaW5nIGNhbGxlZCB3aXRoIGEgcmVmaWxsLCB0aGVuIHN0YXJ0XHJcbiAgICAgKiAgICAgICAgd2l0aCB0aGlzIHNldCBvZiBkb2NzIGFuZCBjaGFuZ2VzIGluc3RlYWQgb2YgdGhlIGN1cnJlbnQgdmlldy5cclxuICAgICAqIEByZXR1cm4gYSBuZXcgc2V0IG9mIGRvY3MsIGNoYW5nZXMsIGFuZCByZWZpbGwgZmxhZy5cclxuICAgICAqL1xyXG4gICAgVmlldy5wcm90b3R5cGUuY29tcHV0ZURvY0NoYW5nZXMgPSBmdW5jdGlvbiAoZG9jQ2hhbmdlcywgcHJldmlvdXNDaGFuZ2VzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY2hhbmdlU2V0ID0gcHJldmlvdXNDaGFuZ2VzXHJcbiAgICAgICAgICAgID8gcHJldmlvdXNDaGFuZ2VzLmNoYW5nZVNldFxyXG4gICAgICAgICAgICA6IG5ldyBEb2N1bWVudENoYW5nZVNldCgpO1xyXG4gICAgICAgIHZhciBvbGREb2N1bWVudFNldCA9IHByZXZpb3VzQ2hhbmdlc1xyXG4gICAgICAgICAgICA/IHByZXZpb3VzQ2hhbmdlcy5kb2N1bWVudFNldFxyXG4gICAgICAgICAgICA6IHRoaXMuZG9jdW1lbnRTZXQ7XHJcbiAgICAgICAgdmFyIG5ld011dGF0ZWRLZXlzID0gcHJldmlvdXNDaGFuZ2VzXHJcbiAgICAgICAgICAgID8gcHJldmlvdXNDaGFuZ2VzLm11dGF0ZWRLZXlzXHJcbiAgICAgICAgICAgIDogdGhpcy5tdXRhdGVkS2V5cztcclxuICAgICAgICB2YXIgbmV3RG9jdW1lbnRTZXQgPSBvbGREb2N1bWVudFNldDtcclxuICAgICAgICB2YXIgbmVlZHNSZWZpbGwgPSBmYWxzZTtcclxuICAgICAgICAvLyBUcmFjayB0aGUgbGFzdCBkb2MgaW4gYSAoZnVsbCkgbGltaXQuIFRoaXMgaXMgbmVjZXNzYXJ5LCBiZWNhdXNlIHNvbWVcclxuICAgICAgICAvLyB1cGRhdGUgKGEgZGVsZXRlLCBvciBhbiB1cGRhdGUgbW92aW5nIGEgZG9jIHBhc3QgdGhlIG9sZCBsaW1pdCkgbWlnaHRcclxuICAgICAgICAvLyBtZWFuIHRoZXJlIGlzIHNvbWUgb3RoZXIgZG9jdW1lbnQgaW4gdGhlIGxvY2FsIGNhY2hlIHRoYXQgZWl0aGVyIHNob3VsZFxyXG4gICAgICAgIC8vIGNvbWUgKDEpIGJldHdlZW4gdGhlIG9sZCBsYXN0IGxpbWl0IGRvYyBhbmQgdGhlIG5ldyBsYXN0IGRvY3VtZW50LCBpbiB0aGVcclxuICAgICAgICAvLyBjYXNlIG9mIHVwZGF0ZXMsIG9yICgyKSBhZnRlciB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZSBjYXNlIG9mXHJcbiAgICAgICAgLy8gZGVsZXRlcy4gU28gd2Uga2VlcCB0aGlzIGRvYyBhdCB0aGUgb2xkIGxpbWl0IHRvIGNvbXBhcmUgdGhlIHVwZGF0ZXMgdG8uXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBOb3RlIHRoYXQgdGhpcyBzaG91bGQgbmV2ZXIgZ2V0IHVzZWQgaW4gYSByZWZpbGwgKHdoZW4gcHJldmlvdXNDaGFuZ2VzIGlzXHJcbiAgICAgICAgLy8gc2V0KSwgYmVjYXVzZSB0aGVyZSB3aWxsIG9ubHkgYmUgYWRkcyAtLSBubyBkZWxldGVzIG9yIHVwZGF0ZXMuXHJcbiAgICAgICAgdmFyIGxhc3REb2NJbkxpbWl0ID0gdGhpcy5xdWVyeS5oYXNMaW1pdCgpICYmIG9sZERvY3VtZW50U2V0LnNpemUgPT09IHRoaXMucXVlcnkubGltaXRcclxuICAgICAgICAgICAgPyBvbGREb2N1bWVudFNldC5sYXN0KClcclxuICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgIGRvY0NoYW5nZXMuaW5vcmRlclRyYXZlcnNhbChmdW5jdGlvbiAoa2V5LCBuZXdNYXliZURvYykge1xyXG4gICAgICAgICAgICB2YXIgb2xkRG9jID0gb2xkRG9jdW1lbnRTZXQuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgIHZhciBuZXdEb2MgPSBuZXdNYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50ID8gbmV3TWF5YmVEb2MgOiBudWxsO1xyXG4gICAgICAgICAgICBpZiAobmV3RG9jKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoa2V5LmlzRXF1YWwobmV3RG9jLmtleSksICdNaXNtYXRjaGluZyBrZXlzIGZvdW5kIGluIGRvY3VtZW50IGNoYW5nZXM6ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgIGtleSArXHJcbiAgICAgICAgICAgICAgICAgICAgJyAhPSAnICtcclxuICAgICAgICAgICAgICAgICAgICBuZXdEb2Mua2V5KTtcclxuICAgICAgICAgICAgICAgIG5ld0RvYyA9IF90aGlzLnF1ZXJ5Lm1hdGNoZXMobmV3RG9jKSA/IG5ld0RvYyA6IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG9sZERvY0hhZFBlbmRpbmdNdXRhdGlvbnMgPSBvbGREb2NcclxuICAgICAgICAgICAgICAgID8gX3RoaXMubXV0YXRlZEtleXMuaGFzKG9sZERvYy5rZXkpXHJcbiAgICAgICAgICAgICAgICA6IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgbmV3RG9jSGFzUGVuZGluZ011dGF0aW9ucyA9IG5ld0RvY1xyXG4gICAgICAgICAgICAgICAgPyBuZXdEb2MuaGFzTG9jYWxNdXRhdGlvbnMgfHxcclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSBvbmx5IGNvbnNpZGVyIGNvbW1pdHRlZCBtdXRhdGlvbnMgZm9yIGRvY3VtZW50cyB0aGF0IHdlcmVcclxuICAgICAgICAgICAgICAgICAgICAvLyBtdXRhdGVkIGR1cmluZyB0aGUgbGlmZXRpbWUgb2YgdGhlIHZpZXcuXHJcbiAgICAgICAgICAgICAgICAgICAgKF90aGlzLm11dGF0ZWRLZXlzLmhhcyhuZXdEb2Mua2V5KSAmJiBuZXdEb2MuaGFzQ29tbWl0dGVkTXV0YXRpb25zKVxyXG4gICAgICAgICAgICAgICAgOiBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIGNoYW5nZUFwcGxpZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNoYW5nZVxyXG4gICAgICAgICAgICBpZiAob2xkRG9jICYmIG5ld0RvYykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRvY3NFcXVhbCA9IG9sZERvYy5kYXRhLmlzRXF1YWwobmV3RG9jLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFkb2NzRXF1YWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIV90aGlzLnNob3VsZFdhaXRGb3JTeW5jZWREb2N1bWVudChvbGREb2MsIG5ld0RvYykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlU2V0LnRyYWNrKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IENoYW5nZVR5cGUuTW9kaWZpZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2M6IG5ld0RvY1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlQXBwbGllZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYXN0RG9jSW5MaW1pdCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVlcnkuZG9jQ29tcGFyYXRvcihuZXdEb2MsIGxhc3REb2NJbkxpbWl0KSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZG9jIG1vdmVkIGZyb20gaW5zaWRlIHRoZSBsaW1pdCB0byBhZnRlciB0aGUgbGltaXQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGF0IG1lYW5zIHRoZXJlIG1heSBiZSBzb21lIGRvYyBpbiB0aGUgbG9jYWwgY2FjaGUgdGhhdCdzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhY3R1YWxseSBsZXNzIHRoYW4gdGhpcyBvbmUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZWVkc1JlZmlsbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChvbGREb2NIYWRQZW5kaW5nTXV0YXRpb25zICE9PSBuZXdEb2NIYXNQZW5kaW5nTXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlU2V0LnRyYWNrKHsgdHlwZTogQ2hhbmdlVHlwZS5NZXRhZGF0YSwgZG9jOiBuZXdEb2MgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlQXBwbGllZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoIW9sZERvYyAmJiBuZXdEb2MpIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZVNldC50cmFjayh7IHR5cGU6IENoYW5nZVR5cGUuQWRkZWQsIGRvYzogbmV3RG9jIH0pO1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlQXBwbGllZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAob2xkRG9jICYmICFuZXdEb2MpIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZVNldC50cmFjayh7IHR5cGU6IENoYW5nZVR5cGUuUmVtb3ZlZCwgZG9jOiBvbGREb2MgfSk7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VBcHBsaWVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmIChsYXN0RG9jSW5MaW1pdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEEgZG9jIHdhcyByZW1vdmVkIGZyb20gYSBmdWxsIGxpbWl0IHF1ZXJ5LiBXZSdsbCBuZWVkIHRvXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVxdWVyeSBmcm9tIHRoZSBsb2NhbCBjYWNoZSB0byBzZWUgaWYgd2Uga25vdyBhYm91dCBzb21lIG90aGVyXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZG9jIHRoYXQgc2hvdWxkIGJlIGluIHRoZSByZXN1bHRzLlxyXG4gICAgICAgICAgICAgICAgICAgIG5lZWRzUmVmaWxsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY2hhbmdlQXBwbGllZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld0RvYykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0RvY3VtZW50U2V0ID0gbmV3RG9jdW1lbnRTZXQuYWRkKG5ld0RvYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0RvY0hhc1BlbmRpbmdNdXRhdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3TXV0YXRlZEtleXMgPSBuZXdNdXRhdGVkS2V5cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld011dGF0ZWRLZXlzID0gbmV3TXV0YXRlZEtleXMuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3RG9jdW1lbnRTZXQgPSBuZXdEb2N1bWVudFNldC5kZWxldGUoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICBuZXdNdXRhdGVkS2V5cyA9IG5ld011dGF0ZWRLZXlzLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMucXVlcnkuaGFzTGltaXQoKSkge1xyXG4gICAgICAgICAgICB3aGlsZSAobmV3RG9jdW1lbnRTZXQuc2l6ZSA+IHRoaXMucXVlcnkubGltaXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvbGREb2MgPSBuZXdEb2N1bWVudFNldC5sYXN0KCk7XHJcbiAgICAgICAgICAgICAgICBuZXdEb2N1bWVudFNldCA9IG5ld0RvY3VtZW50U2V0LmRlbGV0ZShvbGREb2Mua2V5KTtcclxuICAgICAgICAgICAgICAgIG5ld011dGF0ZWRLZXlzID0gbmV3TXV0YXRlZEtleXMuZGVsZXRlKG9sZERvYy5rZXkpO1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlU2V0LnRyYWNrKHsgdHlwZTogQ2hhbmdlVHlwZS5SZW1vdmVkLCBkb2M6IG9sZERvYyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBhc3NlcnQoIW5lZWRzUmVmaWxsIHx8ICFwcmV2aW91c0NoYW5nZXMsICdWaWV3IHdhcyByZWZpbGxlZCB1c2luZyBkb2NzIHRoYXQgdGhlbXNlbHZlcyBuZWVkZWQgcmVmaWxsaW5nLicpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50U2V0OiBuZXdEb2N1bWVudFNldCxcclxuICAgICAgICAgICAgY2hhbmdlU2V0OiBjaGFuZ2VTZXQsXHJcbiAgICAgICAgICAgIG5lZWRzUmVmaWxsOiBuZWVkc1JlZmlsbCxcclxuICAgICAgICAgICAgbXV0YXRlZEtleXM6IG5ld011dGF0ZWRLZXlzXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBWaWV3LnByb3RvdHlwZS5zaG91bGRXYWl0Rm9yU3luY2VkRG9jdW1lbnQgPSBmdW5jdGlvbiAob2xkRG9jLCBuZXdEb2MpIHtcclxuICAgICAgICAvLyBXZSBzdXBwcmVzcyB0aGUgaW5pdGlhbCBjaGFuZ2UgZXZlbnQgZm9yIGRvY3VtZW50cyB0aGF0IHdlcmUgbW9kaWZpZWQgYXNcclxuICAgICAgICAvLyBwYXJ0IG9mIGEgd3JpdGUgYWNrbm93bGVkZ21lbnQgKGUuZy4gd2hlbiB0aGUgdmFsdWUgb2YgYSBzZXJ2ZXIgdHJhbnNmb3JtXHJcbiAgICAgICAgLy8gaXMgYXBwbGllZCkgYXMgV2F0Y2ggd2lsbCBzZW5kIHVzIHRoZSBzYW1lIGRvY3VtZW50IGFnYWluLlxyXG4gICAgICAgIC8vIEJ5IHN1cHByZXNzaW5nIHRoZSBldmVudCwgd2Ugb25seSByYWlzZSB0d28gdXNlciB2aXNpYmxlIGV2ZW50cyAob25lIHdpdGhcclxuICAgICAgICAvLyBgaGFzUGVuZGluZ1dyaXRlc2AgYW5kIHRoZSBmaW5hbCBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQpIGluc3RlYWQgb2YgdGhyZWVcclxuICAgICAgICAvLyAob25lIHdpdGggYGhhc1BlbmRpbmdXcml0ZXNgLCB0aGUgbW9kaWZpZWQgZG9jdW1lbnQgd2l0aFxyXG4gICAgICAgIC8vIGBoYXNQZW5kaW5nV3JpdGVzYCBhbmQgdGhlIGZpbmFsIHN0YXRlIG9mIHRoZSBkb2N1bWVudCkuXHJcbiAgICAgICAgcmV0dXJuIChvbGREb2MuaGFzTG9jYWxNdXRhdGlvbnMgJiZcclxuICAgICAgICAgICAgbmV3RG9jLmhhc0NvbW1pdHRlZE11dGF0aW9ucyAmJlxyXG4gICAgICAgICAgICAhbmV3RG9jLmhhc0xvY2FsTXV0YXRpb25zKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgdGhlIHZpZXcgd2l0aCB0aGUgZ2l2ZW4gVmlld0RvY3VtZW50Q2hhbmdlcyBhbmQgb3B0aW9uYWxseSB1cGRhdGVzXHJcbiAgICAgKiBsaW1ibyBkb2NzIGFuZCBzeW5jIHN0YXRlIGZyb20gdGhlIHByb3ZpZGVkIHRhcmdldCBjaGFuZ2UuXHJcbiAgICAgKiBAcGFyYW0gZG9jQ2hhbmdlcyBUaGUgc2V0IG9mIGNoYW5nZXMgdG8gbWFrZSB0byB0aGUgdmlldydzIGRvY3MuXHJcbiAgICAgKiBAcGFyYW0gdXBkYXRlTGltYm9Eb2N1bWVudHMgV2hldGhlciB0byB1cGRhdGUgbGltYm8gZG9jdW1lbnRzIGJhc2VkIG9uIHRoaXNcclxuICAgICAqICAgICAgICBjaGFuZ2UuXHJcbiAgICAgKiBAcGFyYW0gdGFyZ2V0Q2hhbmdlIEEgdGFyZ2V0IGNoYW5nZSB0byBhcHBseSBmb3IgY29tcHV0aW5nIGxpbWJvIGRvY3MgYW5kXHJcbiAgICAgKiAgICAgICAgc3luYyBzdGF0ZS5cclxuICAgICAqIEByZXR1cm4gQSBuZXcgVmlld0NoYW5nZSB3aXRoIHRoZSBnaXZlbiBkb2NzLCBjaGFuZ2VzLCBhbmQgc3luYyBzdGF0ZS5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBUaGUgaU9TL0FuZHJvaWQgY2xpZW50cyBhbHdheXMgY29tcHV0ZSBsaW1ibyBkb2N1bWVudCBjaGFuZ2VzLlxyXG4gICAgVmlldy5wcm90b3R5cGUuYXBwbHlDaGFuZ2VzID0gZnVuY3Rpb24gKGRvY0NoYW5nZXMsIHVwZGF0ZUxpbWJvRG9jdW1lbnRzLCB0YXJnZXRDaGFuZ2UpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCghZG9jQ2hhbmdlcy5uZWVkc1JlZmlsbCwgJ0Nhbm5vdCBhcHBseSBjaGFuZ2VzIHRoYXQgbmVlZCBhIHJlZmlsbCcpO1xyXG4gICAgICAgIHZhciBvbGREb2NzID0gdGhpcy5kb2N1bWVudFNldDtcclxuICAgICAgICB0aGlzLmRvY3VtZW50U2V0ID0gZG9jQ2hhbmdlcy5kb2N1bWVudFNldDtcclxuICAgICAgICB0aGlzLm11dGF0ZWRLZXlzID0gZG9jQ2hhbmdlcy5tdXRhdGVkS2V5cztcclxuICAgICAgICAvLyBTb3J0IGNoYW5nZXMgYmFzZWQgb24gdHlwZSBhbmQgcXVlcnkgY29tcGFyYXRvclxyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gZG9jQ2hhbmdlcy5jaGFuZ2VTZXQuZ2V0Q2hhbmdlcygpO1xyXG4gICAgICAgIGNoYW5nZXMuc29ydChmdW5jdGlvbiAoYzEsIGMyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoY29tcGFyZUNoYW5nZVR5cGUoYzEudHlwZSwgYzIudHlwZSkgfHxcclxuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXJ5LmRvY0NvbXBhcmF0b3IoYzEuZG9jLCBjMi5kb2MpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmFwcGx5VGFyZ2V0Q2hhbmdlKHRhcmdldENoYW5nZSk7XHJcbiAgICAgICAgdmFyIGxpbWJvQ2hhbmdlcyA9IHVwZGF0ZUxpbWJvRG9jdW1lbnRzXHJcbiAgICAgICAgICAgID8gdGhpcy51cGRhdGVMaW1ib0RvY3VtZW50cygpXHJcbiAgICAgICAgICAgIDogW107XHJcbiAgICAgICAgdmFyIHN5bmNlZCA9IHRoaXMubGltYm9Eb2N1bWVudHMuc2l6ZSA9PT0gMCAmJiB0aGlzLmN1cnJlbnQ7XHJcbiAgICAgICAgdmFyIG5ld1N5bmNTdGF0ZSA9IHN5bmNlZCA/IFN5bmNTdGF0ZS5TeW5jZWQgOiBTeW5jU3RhdGUuTG9jYWw7XHJcbiAgICAgICAgdmFyIHN5bmNTdGF0ZUNoYW5nZWQgPSBuZXdTeW5jU3RhdGUgIT09IHRoaXMuc3luY1N0YXRlO1xyXG4gICAgICAgIHRoaXMuc3luY1N0YXRlID0gbmV3U3luY1N0YXRlO1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmxlbmd0aCA9PT0gMCAmJiAhc3luY1N0YXRlQ2hhbmdlZCkge1xyXG4gICAgICAgICAgICAvLyBubyBjaGFuZ2VzXHJcbiAgICAgICAgICAgIHJldHVybiB7IGxpbWJvQ2hhbmdlczogbGltYm9DaGFuZ2VzIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgc25hcCA9IG5ldyBWaWV3U25hcHNob3QodGhpcy5xdWVyeSwgZG9jQ2hhbmdlcy5kb2N1bWVudFNldCwgb2xkRG9jcywgY2hhbmdlcywgZG9jQ2hhbmdlcy5tdXRhdGVkS2V5cywgbmV3U3luY1N0YXRlID09PSBTeW5jU3RhdGUuTG9jYWwsIHN5bmNTdGF0ZUNoYW5nZWQsIFxyXG4gICAgICAgICAgICAvKiBleGNsdWRlc01ldGFkYXRhQ2hhbmdlcz0gKi8gZmFsc2UpO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgc25hcHNob3Q6IHNuYXAsXHJcbiAgICAgICAgICAgICAgICBsaW1ib0NoYW5nZXM6IGxpbWJvQ2hhbmdlc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFwcGxpZXMgYW4gT25saW5lU3RhdGUgY2hhbmdlIHRvIHRoZSB2aWV3LCBwb3RlbnRpYWxseSBnZW5lcmF0aW5nIGFcclxuICAgICAqIFZpZXdDaGFuZ2UgaWYgdGhlIHZpZXcncyBzeW5jU3RhdGUgY2hhbmdlcyBhcyBhIHJlc3VsdC5cclxuICAgICAqL1xyXG4gICAgVmlldy5wcm90b3R5cGUuYXBwbHlPbmxpbmVTdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnQgJiYgb25saW5lU3RhdGUgPT09IE9ubGluZVN0YXRlLk9mZmxpbmUpIHtcclxuICAgICAgICAgICAgLy8gSWYgd2UncmUgb2ZmbGluZSwgc2V0IGBjdXJyZW50YCB0byBmYWxzZSBhbmQgdGhlbiBjYWxsIGFwcGx5Q2hhbmdlcygpXHJcbiAgICAgICAgICAgIC8vIHRvIHJlZnJlc2ggb3VyIHN5bmNTdGF0ZSBhbmQgZ2VuZXJhdGUgYSBWaWV3Q2hhbmdlIGFzIGFwcHJvcHJpYXRlLiBXZVxyXG4gICAgICAgICAgICAvLyBhcmUgZ3VhcmFudGVlZCB0byBnZXQgYSBuZXcgVGFyZ2V0Q2hhbmdlIHRoYXQgc2V0cyBgY3VycmVudGAgYmFjayB0b1xyXG4gICAgICAgICAgICAvLyB0cnVlIG9uY2UgdGhlIGNsaWVudCBpcyBiYWNrIG9ubGluZS5cclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwcGx5Q2hhbmdlcyh7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudFNldDogdGhpcy5kb2N1bWVudFNldCxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVNldDogbmV3IERvY3VtZW50Q2hhbmdlU2V0KCksXHJcbiAgICAgICAgICAgICAgICBtdXRhdGVkS2V5czogdGhpcy5tdXRhdGVkS2V5cyxcclxuICAgICAgICAgICAgICAgIG5lZWRzUmVmaWxsOiBmYWxzZVxyXG4gICAgICAgICAgICB9LCBcclxuICAgICAgICAgICAgLyogdXBkYXRlTGltYm9Eb2N1bWVudHM9ICovIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIE5vIGVmZmVjdCwganVzdCByZXR1cm4gYSBuby1vcCBWaWV3Q2hhbmdlLlxyXG4gICAgICAgICAgICByZXR1cm4geyBsaW1ib0NoYW5nZXM6IFtdIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBkb2MgZm9yIHRoZSBnaXZlbiBrZXkgc2hvdWxkIGJlIGluIGxpbWJvLlxyXG4gICAgICovXHJcbiAgICBWaWV3LnByb3RvdHlwZS5zaG91bGRCZUluTGltYm8gPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgLy8gSWYgdGhlIHJlbW90ZSBlbmQgc2F5cyBpdCdzIHBhcnQgb2YgdGhpcyBxdWVyeSwgaXQncyBub3QgaW4gbGltYm8uXHJcbiAgICAgICAgaWYgKHRoaXMuX3N5bmNlZERvY3VtZW50cy5oYXMoa2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRoZSBsb2NhbCBzdG9yZSBkb2Vzbid0IHRoaW5rIGl0J3MgYSByZXN1bHQsIHNvIGl0IHNob3VsZG4ndCBiZSBpbiBsaW1iby5cclxuICAgICAgICBpZiAoIXRoaXMuZG9jdW1lbnRTZXQuaGFzKGtleSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiB0aGVyZSBhcmUgbG9jYWwgY2hhbmdlcyB0byB0aGUgZG9jLCB0aGV5IG1pZ2h0IGV4cGxhaW4gd2h5IHRoZSBzZXJ2ZXJcclxuICAgICAgICAvLyBkb2Vzbid0IGtub3cgdGhhdCBpdCdzIHBhcnQgb2YgdGhlIHF1ZXJ5LiBTbyBkb24ndCBwdXQgaXQgaW4gbGltYm8uXHJcbiAgICAgICAgLy8gVE9ETyhrbGltdCk6IElkZWFsbHksIHdlIHdvdWxkIG9ubHkgY29uc2lkZXIgY2hhbmdlcyB0aGF0IG1pZ2h0IGFjdHVhbGx5XHJcbiAgICAgICAgLy8gYWZmZWN0IHRoaXMgc3BlY2lmaWMgcXVlcnkuXHJcbiAgICAgICAgaWYgKHRoaXMuZG9jdW1lbnRTZXQuZ2V0KGtleSkuaGFzTG9jYWxNdXRhdGlvbnMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBFdmVyeXRoaW5nIGVsc2UgaXMgaW4gbGltYm8uXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHN5bmNlZERvY3VtZW50cywgY3VycmVudCwgYW5kIGxpbWJvIGRvY3MgYmFzZWQgb24gdGhlIGdpdmVuIGNoYW5nZS5cclxuICAgICAqIFJldHVybnMgdGhlIGxpc3Qgb2YgY2hhbmdlcyB0byB3aGljaCBkb2NzIGFyZSBpbiBsaW1iby5cclxuICAgICAqL1xyXG4gICAgVmlldy5wcm90b3R5cGUuYXBwbHlUYXJnZXRDaGFuZ2UgPSBmdW5jdGlvbiAodGFyZ2V0Q2hhbmdlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGFyZ2V0Q2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHRhcmdldENoYW5nZS5hZGRlZERvY3VtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIChfdGhpcy5fc3luY2VkRG9jdW1lbnRzID0gX3RoaXMuX3N5bmNlZERvY3VtZW50cy5hZGQoa2V5KSk7IH0pO1xyXG4gICAgICAgICAgICB0YXJnZXRDaGFuZ2UubW9kaWZpZWREb2N1bWVudHMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXJ0KF90aGlzLl9zeW5jZWREb2N1bWVudHMuaGFzKGtleSksIFwiTW9kaWZpZWQgZG9jdW1lbnQgXCIgKyBrZXkgKyBcIiBub3QgZm91bmQgaW4gdmlldy5cIik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0YXJnZXRDaGFuZ2UucmVtb3ZlZERvY3VtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIChfdGhpcy5fc3luY2VkRG9jdW1lbnRzID0gX3RoaXMuX3N5bmNlZERvY3VtZW50cy5kZWxldGUoa2V5KSk7IH0pO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSB0YXJnZXRDaGFuZ2UuY3VycmVudDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVmlldy5wcm90b3R5cGUudXBkYXRlTGltYm9Eb2N1bWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBXZSBjYW4gb25seSBkZXRlcm1pbmUgbGltYm8gZG9jdW1lbnRzIHdoZW4gd2UncmUgaW4tc3luYyB3aXRoIHRoZSBzZXJ2ZXIuXHJcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUT0RPKGtsaW10KTogRG8gdGhpcyBpbmNyZW1lbnRhbGx5IHNvIHRoYXQgaXQncyBub3QgcXVhZHJhdGljIHdoZW5cclxuICAgICAgICAvLyB1cGRhdGluZyBtYW55IGRvY3VtZW50cy5cclxuICAgICAgICB2YXIgb2xkTGltYm9Eb2N1bWVudHMgPSB0aGlzLmxpbWJvRG9jdW1lbnRzO1xyXG4gICAgICAgIHRoaXMubGltYm9Eb2N1bWVudHMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTZXQuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5zaG91bGRCZUluTGltYm8oZG9jLmtleSkpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmxpbWJvRG9jdW1lbnRzID0gX3RoaXMubGltYm9Eb2N1bWVudHMuYWRkKGRvYy5rZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gRGlmZiB0aGUgbmV3IGxpbWJvIGRvY3Mgd2l0aCB0aGUgb2xkIGxpbWJvIGRvY3MuXHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSBbXTtcclxuICAgICAgICBvbGRMaW1ib0RvY3VtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFfdGhpcy5saW1ib0RvY3VtZW50cy5oYXMoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlcy5wdXNoKG5ldyBSZW1vdmVkTGltYm9Eb2N1bWVudChrZXkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubGltYm9Eb2N1bWVudHMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIGlmICghb2xkTGltYm9Eb2N1bWVudHMuaGFzKGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZXMucHVzaChuZXcgQWRkZWRMaW1ib0RvY3VtZW50KGtleSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGNoYW5nZXM7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGUgdGhlIGluLW1lbW9yeSBzdGF0ZSBvZiB0aGUgY3VycmVudCB2aWV3IHdpdGggdGhlIHN0YXRlIHJlYWQgZnJvbVxyXG4gICAgICogcGVyc2lzdGVuY2UuXHJcbiAgICAgKlxyXG4gICAgICogV2UgdXBkYXRlIHRoZSBxdWVyeSB2aWV3IHdoZW5ldmVyIGEgY2xpZW50J3MgcHJpbWFyeSBzdGF0dXMgY2hhbmdlczpcclxuICAgICAqIC0gV2hlbiBhIGNsaWVudCB0cmFuc2l0aW9ucyBmcm9tIHByaW1hcnkgdG8gc2Vjb25kYXJ5LCBpdCBjYW4gbWlzc1xyXG4gICAgICogICBMb2NhbFN0b3JhZ2UgdXBkYXRlcyBhbmQgaXRzIHF1ZXJ5IHZpZXdzIG1heSB0ZW1wb3JhcmlseSBub3QgYmVcclxuICAgICAqICAgc3luY2hyb25pemVkIHdpdGggdGhlIHN0YXRlIG9uIGRpc2suXHJcbiAgICAgKiAtIEZvciBzZWNvbmRhcnkgdG8gcHJpbWFyeSB0cmFuc2l0aW9ucywgdGhlIGNsaWVudCBuZWVkcyB0byB1cGRhdGUgdGhlIGxpc3RcclxuICAgICAqICAgb2YgYHN5bmNlZERvY3VtZW50c2Agc2luY2Ugc2Vjb25kYXJ5IGNsaWVudHMgdXBkYXRlIHRoZWlyIHF1ZXJ5IHZpZXdzXHJcbiAgICAgKiAgIGJhc2VkIHB1cmVseSBvbiBzeW50aGVzaXplZCBSZW1vdGVFdmVudHMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGxvY2FsRG9jcyAtIFRoZSBkb2N1bWVudHMgdGhhdCBtYXRjaCB0aGUgcXVlcnkgYWNjb3JkaW5nIHRvIHRoZVxyXG4gICAgICogTG9jYWxTdG9yZS5cclxuICAgICAqIEBwYXJhbSByZW1vdGVLZXlzIC0gVGhlIGtleXMgb2YgdGhlIGRvY3VtZW50cyB0aGF0IG1hdGNoIHRoZSBxdWVyeVxyXG4gICAgICogYWNjb3JkaW5nIHRvIHRoZSBiYWNrZW5kLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm4gVGhlIFZpZXdDaGFuZ2UgdGhhdCByZXN1bHRlZCBmcm9tIHRoaXMgc3luY2hyb25pemF0aW9uLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgVmlldy5wcm90b3R5cGUuc3luY2hyb25pemVXaXRoUGVyc2lzdGVkU3RhdGUgPSBmdW5jdGlvbiAobG9jYWxEb2NzLCByZW1vdGVLZXlzKSB7XHJcbiAgICAgICAgdGhpcy5fc3luY2VkRG9jdW1lbnRzID0gcmVtb3RlS2V5cztcclxuICAgICAgICB0aGlzLmxpbWJvRG9jdW1lbnRzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB2YXIgZG9jQ2hhbmdlcyA9IHRoaXMuY29tcHV0ZURvY0NoYW5nZXMobG9jYWxEb2NzKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseUNoYW5nZXMoZG9jQ2hhbmdlcywgLyp1cGRhdGVMaW1ib0RvY3VtZW50cz0qLyB0cnVlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSB2aWV3IHNuYXBzaG90IGFzIGlmIHRoaXMgcXVlcnkgd2FzIGp1c3QgbGlzdGVuZWQgdG8uIENvbnRhaW5zXHJcbiAgICAgKiBhIGRvY3VtZW50IGFkZCBmb3IgZXZlcnkgZXhpc3RpbmcgZG9jdW1lbnQgYW5kIHRoZSBgZnJvbUNhY2hlYCBhbmRcclxuICAgICAqIGBoYXNQZW5kaW5nV3JpdGVzYCBzdGF0dXMgb2YgdGhlIGFscmVhZHkgZXN0YWJsaXNoZWQgdmlldy5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIFZpZXcucHJvdG90eXBlLmNvbXB1dGVJbml0aWFsU25hcHNob3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZpZXdTbmFwc2hvdC5mcm9tSW5pdGlhbERvY3VtZW50cyh0aGlzLnF1ZXJ5LCB0aGlzLmRvY3VtZW50U2V0LCB0aGlzLm11dGF0ZWRLZXlzLCB0aGlzLnN5bmNTdGF0ZSA9PT0gU3luY1N0YXRlLkxvY2FsKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVmlldztcclxufSgpKTtcclxuZnVuY3Rpb24gY29tcGFyZUNoYW5nZVR5cGUoYzEsIGMyKSB7XHJcbiAgICB2YXIgb3JkZXIgPSBmdW5jdGlvbiAoY2hhbmdlKSB7XHJcbiAgICAgICAgc3dpdGNoIChjaGFuZ2UpIHtcclxuICAgICAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLkFkZGVkOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5Nb2RpZmllZDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAyO1xyXG4gICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuTWV0YWRhdGE6XHJcbiAgICAgICAgICAgICAgICAvLyBBIG1ldGFkYXRhIGNoYW5nZSBpcyBjb252ZXJ0ZWQgdG8gYSBtb2RpZmllZCBjaGFuZ2UgYXQgdGhlIHB1YmxpY1xyXG4gICAgICAgICAgICAgICAgLy8gYXBpIGxheWVyLiAgU2luY2Ugd2Ugc29ydCBieSBkb2N1bWVudCBrZXkgYW5kIHRoZW4gY2hhbmdlIHR5cGUsXHJcbiAgICAgICAgICAgICAgICAvLyBtZXRhZGF0YSBhbmQgbW9kaWZpZWQgY2hhbmdlcyBtdXN0IGJlIHNvcnRlZCBlcXVpdmFsZW50bHkuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMjtcclxuICAgICAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLlJlbW92ZWQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIENoYW5nZVR5cGU6ICcgKyBjaGFuZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gb3JkZXIoYzEpIC0gb3JkZXIoYzIpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQ5ID0gJ1N5bmNFbmdpbmUnO1xyXG4vKipcclxuICogUXVlcnlWaWV3IGNvbnRhaW5zIGFsbCBvZiB0aGUgZGF0YSB0aGF0IFN5bmNFbmdpbmUgbmVlZHMgdG8ga2VlcCB0cmFjayBvZiBmb3JcclxuICogYSBwYXJ0aWN1bGFyIHF1ZXJ5LlxyXG4gKi9cclxudmFyIFF1ZXJ5VmlldyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5VmlldyhcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHF1ZXJ5IGl0c2VsZi5cclxuICAgICAqL1xyXG4gICAgcXVlcnksIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgdGFyZ2V0IG51bWJlciBjcmVhdGVkIGJ5IHRoZSBjbGllbnQgdGhhdCBpcyB1c2VkIGluIHRoZSB3YXRjaFxyXG4gICAgICogc3RyZWFtIHRvIGlkZW50aWZ5IHRoaXMgcXVlcnkuXHJcbiAgICAgKi9cclxuICAgIHRhcmdldElkLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHZpZXcgaXMgcmVzcG9uc2libGUgZm9yIGNvbXB1dGluZyB0aGUgZmluYWwgbWVyZ2VkIHRydXRoIG9mIHdoYXRcclxuICAgICAqIGRvY3MgYXJlIGluIHRoZSBxdWVyeS4gSXQgZ2V0cyBub3RpZmllZCBvZiBsb2NhbCBhbmQgcmVtb3RlIGNoYW5nZXMsXHJcbiAgICAgKiBhbmQgYXBwbGllcyB0aGUgcXVlcnkgZmlsdGVycyBhbmQgbGltaXRzIHRvIGRldGVybWluZSB0aGUgbW9zdCBjb3JyZWN0XHJcbiAgICAgKiBwb3NzaWJsZSByZXN1bHRzLlxyXG4gICAgICovXHJcbiAgICB2aWV3KSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0YXJnZXRJZDtcclxuICAgICAgICB0aGlzLnZpZXcgPSB2aWV3O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFF1ZXJ5VmlldztcclxufSgpKTtcclxuLyoqIFRyYWNrcyBhIGxpbWJvIHJlc29sdXRpb24uICovXHJcbnZhciBMaW1ib1Jlc29sdXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMaW1ib1Jlc29sdXRpb24oa2V5KSB7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTGltYm9SZXNvbHV0aW9uO1xyXG59KCkpO1xyXG4vKipcclxuICogU3luY0VuZ2luZSBpcyB0aGUgY2VudHJhbCBjb250cm9sbGVyIGluIHRoZSBjbGllbnQgU0RLIGFyY2hpdGVjdHVyZS4gSXQgaXNcclxuICogdGhlIGdsdWUgY29kZSBiZXR3ZWVuIHRoZSBFdmVudE1hbmFnZXIsIExvY2FsU3RvcmUsIGFuZCBSZW1vdGVTdG9yZS4gU29tZSBvZlxyXG4gKiBTeW5jRW5naW5lJ3MgcmVzcG9uc2liaWxpdGllcyBpbmNsdWRlOlxyXG4gKiAxLiBDb29yZGluYXRpbmcgY2xpZW50IHJlcXVlc3RzIGFuZCByZW1vdGUgZXZlbnRzIGJldHdlZW4gdGhlIEV2ZW50TWFuYWdlclxyXG4gKiAgICBhbmQgdGhlIGxvY2FsIGFuZCByZW1vdGUgZGF0YSBzdG9yZXMuXHJcbiAqIDIuIE1hbmFnaW5nIGEgVmlldyBvYmplY3QgZm9yIGVhY2ggcXVlcnksIHByb3ZpZGluZyB0aGUgdW5pZmllZCB2aWV3IGJldHdlZW5cclxuICogICAgdGhlIGxvY2FsIGFuZCByZW1vdGUgZGF0YSBzdG9yZXMuXHJcbiAqIDMuIE5vdGlmeWluZyB0aGUgUmVtb3RlU3RvcmUgd2hlbiB0aGUgTG9jYWxTdG9yZSBoYXMgbmV3IG11dGF0aW9ucyBpbiBpdHNcclxuICogICAgcXVldWUgdGhhdCBuZWVkIHNlbmRpbmcgdG8gdGhlIGJhY2tlbmQuXHJcbiAqXHJcbiAqIFRoZSBTeW5jRW5naW5l4oCZcyBtZXRob2RzIHNob3VsZCBvbmx5IGV2ZXIgYmUgY2FsbGVkIGJ5IG1ldGhvZHMgcnVubmluZyBpbiB0aGVcclxuICogZ2xvYmFsIGFzeW5jIHF1ZXVlLlxyXG4gKi9cclxudmFyIFN5bmNFbmdpbmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTeW5jRW5naW5lKGxvY2FsU3RvcmUsIHJlbW90ZVN0b3JlLCBcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTWFuYWdlcyBzdGF0ZSBzeW5jaHJvbml6YXRpb24gaW4gbXVsdGktdGFiIGVudmlyb25tZW50cy5cclxuICAgIHNoYXJlZENsaWVudFN0YXRlLCBjdXJyZW50VXNlcikge1xyXG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IGxvY2FsU3RvcmU7XHJcbiAgICAgICAgdGhpcy5yZW1vdGVTdG9yZSA9IHJlbW90ZVN0b3JlO1xyXG4gICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSBzaGFyZWRDbGllbnRTdGF0ZTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gY3VycmVudFVzZXI7XHJcbiAgICAgICAgdGhpcy5zeW5jRW5naW5lTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucXVlcnlWaWV3c0J5UXVlcnkgPSBuZXcgT2JqZWN0TWFwKGZ1bmN0aW9uIChxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBxLmNhbm9uaWNhbElkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXQgPSB7fTtcclxuICAgICAgICB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5ID0gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxuICAgICAgICB0aGlzLmxpbWJvUmVzb2x1dGlvbnNCeVRhcmdldCA9IHt9O1xyXG4gICAgICAgIHRoaXMubGltYm9Eb2N1bWVudFJlZnMgPSBuZXcgUmVmZXJlbmNlU2V0KCk7XHJcbiAgICAgICAgLyoqIFN0b3JlcyB1c2VyIGNvbXBsZXRpb24gaGFuZGxlcnMsIGluZGV4ZWQgYnkgVXNlciBhbmQgQmF0Y2hJZC4gKi9cclxuICAgICAgICB0aGlzLm11dGF0aW9uVXNlckNhbGxiYWNrcyA9IHt9O1xyXG4gICAgICAgIHRoaXMubGltYm9UYXJnZXRJZEdlbmVyYXRvciA9IFRhcmdldElkR2VuZXJhdG9yLmZvclN5bmNFbmdpbmUoKTtcclxuICAgICAgICAvLyBUaGUgcHJpbWFyeSBzdGF0ZSBpcyBzZXQgdG8gYHRydWVgIG9yIGBmYWxzZWAgaW1tZWRpYXRlbHkgYWZ0ZXIgRmlyZXN0b3JlXHJcbiAgICAgICAgLy8gc3RhcnR1cC4gSW4gdGhlIGludGVyaW0sIGEgY2xpZW50IHNob3VsZCBvbmx5IGJlIGNvbnNpZGVyZWQgcHJpbWFyeSBpZlxyXG4gICAgICAgIC8vIGBpc1ByaW1hcnlgIGlzIHRydWUuXHJcbiAgICAgICAgdGhpcy5pc1ByaW1hcnkgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZSA9IE9ubGluZVN0YXRlLlVua25vd247XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3luY0VuZ2luZS5wcm90b3R5cGUsIFwiaXNQcmltYXJ5Q2xpZW50XCIsIHtcclxuICAgICAgICAvLyBPbmx5IHVzZWQgZm9yIHRlc3RpbmcuXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzUHJpbWFyeSA9PT0gdHJ1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKiBTdWJzY3JpYmVzIHRvIFN5bmNFbmdpbmUgbm90aWZpY2F0aW9ucy4gSGFzIHRvIGJlIGNhbGxlZCBleGFjdGx5IG9uY2UuICovXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3luY0VuZ2luZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgYXNzZXJ0KHN5bmNFbmdpbmVMaXN0ZW5lciAhPT0gbnVsbCwgJ1N5bmNFbmdpbmUgbGlzdGVuZXIgY2Fubm90IGJlIG51bGwnKTtcclxuICAgICAgICBhc3NlcnQodGhpcy5zeW5jRW5naW5lTGlzdGVuZXIgPT09IG51bGwsICdTeW5jRW5naW5lIGFscmVhZHkgaGFzIGEgc3Vic2NyaWJlci4nKTtcclxuICAgICAgICB0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lciA9IHN5bmNFbmdpbmVMaXN0ZW5lcjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYXRlcyB0aGUgbmV3IGxpc3RlbiwgcmVzb2x2ZXMgcHJvbWlzZSB3aGVuIGxpc3RlbiBlbnF1ZXVlZCB0byB0aGVcclxuICAgICAqIHNlcnZlci4gQWxsIHRoZSBzdWJzZXF1ZW50IHZpZXcgc25hcHNob3RzIG9yIGVycm9ycyBhcmUgc2VudCB0byB0aGVcclxuICAgICAqIHN1YnNjcmliZWQgaGFuZGxlcnMuIFJldHVybnMgdGhlIHRhcmdldElkIG9mIHRoZSBxdWVyeS5cclxuICAgICAqL1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUubGlzdGVuID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRJZCwgdmlld1NuYXBzaG90LCBxdWVyeVZpZXcsIHF1ZXJ5RGF0YSwgc3RhdHVzXzE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRTdWJzY3JpYmVkKCdsaXN0ZW4oKScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVZpZXcgPSB0aGlzLnF1ZXJ5Vmlld3NCeVF1ZXJ5LmdldChxdWVyeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnlWaWV3KSByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUE9SVElORyBOT1RFOiBXaXRoIE11bHQtVGFiIFdlYiwgaXQgaXMgcG9zc2libGUgdGhhdCBhIHF1ZXJ5IHZpZXdcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWxyZWFkeSBleGlzdHMgd2hlbiBFdmVudE1hbmFnZXIgY2FsbHMgdXMgZm9yIHRoZSBmaXJzdCB0aW1lLiBUaGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhcHBlbnMgd2hlbiB0aGUgcHJpbWFyeSB0YWIgaXMgYWxyZWFkeSBsaXN0ZW5pbmcgdG8gdGhpcyBxdWVyeSBvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBiZWhhbGYgb2YgYW5vdGhlciB0YWIgYW5kIHRoZSB1c2VyIG9mIHRoZSBwcmltYXJ5IGFsc28gc3RhcnRzIGxpc3RlbmluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0byB0aGUgcXVlcnkuIEV2ZW50TWFuYWdlciB3aWxsIG5vdCBoYXZlIGFuIGFzc2lnbmVkIHRhcmdldCBJRCBpbiB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNhc2UgYW5kIGNhbGxzIGBsaXN0ZW5gIHRvIG9idGFpbiB0aGlzIElELlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZCA9IHF1ZXJ5Vmlldy50YXJnZXRJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5hZGRMb2NhbFF1ZXJ5VGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld1NuYXBzaG90ID0gcXVlcnlWaWV3LnZpZXcuY29tcHV0ZUluaXRpYWxTbmFwc2hvdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5hbGxvY2F0ZVF1ZXJ5KHF1ZXJ5KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeURhdGEgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c18xID0gdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5hZGRMb2NhbFF1ZXJ5VGFyZ2V0KHF1ZXJ5RGF0YS50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkID0gcXVlcnlEYXRhLnRhcmdldElkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmluaXRpYWxpemVWaWV3QW5kQ29tcHV0ZVNuYXBzaG90KHF1ZXJ5RGF0YSwgc3RhdHVzXzEgPT09ICdjdXJyZW50JyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld1NuYXBzaG90ID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3RlU3RvcmUubGlzdGVuKHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zeW5jRW5naW5lTGlzdGVuZXIub25XYXRjaENoYW5nZShbdmlld1NuYXBzaG90XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXJzIGEgdmlldyBmb3IgYSBwcmV2aW91c2x5IHVua25vd24gcXVlcnkgYW5kIGNvbXB1dGVzIGl0cyBpbml0aWFsXHJcbiAgICAgKiBzbmFwc2hvdC5cclxuICAgICAqL1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuaW5pdGlhbGl6ZVZpZXdBbmRDb21wdXRlU25hcHNob3QgPSBmdW5jdGlvbiAocXVlcnlEYXRhLCBjdXJyZW50KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcXVlcnkgPSBxdWVyeURhdGEucXVlcnk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZS5leGVjdXRlUXVlcnkocXVlcnkpLnRoZW4oZnVuY3Rpb24gKGRvY3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgICAgIC5yZW1vdGVEb2N1bWVudEtleXMocXVlcnlEYXRhLnRhcmdldElkKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlbW90ZUtleXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2aWV3ID0gbmV3IFZpZXcocXVlcnksIHJlbW90ZUtleXMpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHZpZXdEb2NDaGFuZ2VzID0gdmlldy5jb21wdXRlRG9jQ2hhbmdlcyhkb2NzKTtcclxuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGggUHJldHRpZXIgZm9ybWF0cyB0aGlzIGV4Y2VlZCAxMDAgY2hhcmFjdGVycy5cclxuICAgICAgICAgICAgICAgIHZhciBzeW50aGVzaXplZFRhcmdldENoYW5nZSA9IFRhcmdldENoYW5nZS5jcmVhdGVTeW50aGVzaXplZFRhcmdldENoYW5nZUZvckN1cnJlbnRDaGFuZ2UocXVlcnlEYXRhLnRhcmdldElkLCBjdXJyZW50ICYmIF90aGlzLm9ubGluZVN0YXRlICE9PSBPbmxpbmVTdGF0ZS5PZmZsaW5lKTtcclxuICAgICAgICAgICAgICAgIHZhciB2aWV3Q2hhbmdlID0gdmlldy5hcHBseUNoYW5nZXModmlld0RvY0NoYW5nZXMsIFxyXG4gICAgICAgICAgICAgICAgLyogdXBkYXRlTGltYm9Eb2N1bWVudHM9ICovIF90aGlzLmlzUHJpbWFyeSA9PT0gdHJ1ZSwgc3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KHZpZXdDaGFuZ2UubGltYm9DaGFuZ2VzLmxlbmd0aCA9PT0gMCwgJ1ZpZXcgcmV0dXJuZWQgbGltYm8gZG9jcyBiZWZvcmUgdGFyZ2V0IGFjayBmcm9tIHRoZSBzZXJ2ZXIuJyk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoISF2aWV3Q2hhbmdlLnNuYXBzaG90LCAnYXBwbHlDaGFuZ2VzIGZvciBuZXcgdmlldyBzaG91bGQgYWx3YXlzIHJldHVybiBhIHNuYXBzaG90Jyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBRdWVyeVZpZXcocXVlcnksIHF1ZXJ5RGF0YS50YXJnZXRJZCwgdmlldyk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5xdWVyeVZpZXdzQnlRdWVyeS5zZXQocXVlcnksIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucXVlcnlWaWV3c0J5VGFyZ2V0W3F1ZXJ5RGF0YS50YXJnZXRJZF0gPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdDaGFuZ2Uuc25hcHNob3Q7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVjb25jaWxlIHRoZSBsaXN0IG9mIHN5bmNlZCBkb2N1bWVudHMgaW4gYW4gZXhpc3RpbmcgdmlldyB3aXRoIHRob3NlXHJcbiAgICAgKiBmcm9tIHBlcnNpc3RlbmNlLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuc3luY2hyb25pemVWaWV3QW5kQ29tcHV0ZVNuYXBzaG90ID0gZnVuY3Rpb24gKHF1ZXJ5Vmlldykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZS5leGVjdXRlUXVlcnkocXVlcnlWaWV3LnF1ZXJ5KS50aGVuKGZ1bmN0aW9uIChkb2NzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgICAgICAucmVtb3RlRG9jdW1lbnRLZXlzKHF1ZXJ5Vmlldy50YXJnZXRJZClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZW1vdGVLZXlzKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2aWV3U25hcHNob3Q7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3U25hcHNob3QgPSBxdWVyeVZpZXcudmlldy5zeW5jaHJvbml6ZVdpdGhQZXJzaXN0ZWRTdGF0ZShkb2NzLCByZW1vdGVLZXlzKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUcmFja2VkTGltYm9zKHF1ZXJ5Vmlldy50YXJnZXRJZCwgdmlld1NuYXBzaG90LmxpbWJvQ2hhbmdlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB2aWV3U25hcHNob3RdO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogU3RvcHMgbGlzdGVuaW5nIHRvIHRoZSBxdWVyeS4gKi9cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnVubGlzdGVuID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeVZpZXcsIHRhcmdldFJlbWFpbnNBY3RpdmU7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRTdWJzY3JpYmVkKCd1bmxpc3RlbigpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VmlldyA9IHRoaXMucXVlcnlWaWV3c0J5UXVlcnkuZ2V0KHF1ZXJ5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCEhcXVlcnlWaWV3LCAnVHJ5aW5nIHRvIHVubGlzdGVuIG9uIHF1ZXJ5IG5vdCBmb3VuZDonICsgcXVlcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNQcmltYXJ5KSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byByZW1vdmUgdGhlIGxvY2FsIHF1ZXJ5IHRhcmdldCBmaXJzdCB0byBhbGxvdyB1cyB0byB2ZXJpZnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2hldGhlciBhbnkgb3RoZXIgY2xpZW50IGlzIHN0aWxsIGludGVyZXN0ZWQgaW4gdGhpcyB0YXJnZXQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUucmVtb3ZlTG9jYWxRdWVyeVRhcmdldChxdWVyeVZpZXcudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRSZW1haW5zQWN0aXZlID0gdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHF1ZXJ5Vmlldy50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRhcmdldFJlbWFpbnNBY3RpdmUpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVsZWFzZVF1ZXJ5KHF1ZXJ5LCAvKmtlZXBQZXJzaXN0ZWRRdWVyeURhdGE9Ki8gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNoYXJlZENsaWVudFN0YXRlLmNsZWFyUXVlcnlTdGF0ZShxdWVyeVZpZXcudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbW90ZVN0b3JlLnVubGlzdGVuKHF1ZXJ5Vmlldy50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVtb3ZlQW5kQ2xlYW51cFF1ZXJ5KHF1ZXJ5Vmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBfdGhpcy5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZXJyKTsgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzMgLypicmVhayovLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQW5kQ2xlYW51cFF1ZXJ5KHF1ZXJ5Vmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5yZWxlYXNlUXVlcnkocXVlcnksIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyprZWVwUGVyc2lzdGVkUXVlcnlEYXRhPSovIHRydWUpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYXRlcyB0aGUgd3JpdGUgb2YgbG9jYWwgbXV0YXRpb24gYmF0Y2ggd2hpY2ggaW52b2x2ZXMgYWRkaW5nIHRoZVxyXG4gICAgICogd3JpdGVzIHRvIHRoZSBtdXRhdGlvbiBxdWV1ZSwgbm90aWZ5aW5nIHRoZSByZW1vdGUgc3RvcmUgYWJvdXQgbmV3XHJcbiAgICAgKiBtdXRhdGlvbnMgYW5kIHJhaXNpbmcgZXZlbnRzIGZvciBhbnkgY2hhbmdlcyB0aGlzIHdyaXRlIGNhdXNlZC5cclxuICAgICAqXHJcbiAgICAgKiBUaGUgcHJvbWlzZSByZXR1cm5lZCBieSB0aGlzIGNhbGwgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgYWJvdmUgc3RlcHNcclxuICAgICAqIGhhdmUgY29tcGxldGVkLCAqbm90KiB3aGVuIHRoZSB3cml0ZSB3YXMgYWNrZWQgYnkgdGhlIGJhY2tlbmQuIFRoZVxyXG4gICAgICogdXNlckNhbGxiYWNrIGlzIHJlc29sdmVkIG9uY2UgdGhlIHdyaXRlIHdhcyBhY2tlZC9yZWplY3RlZCBieSB0aGVcclxuICAgICAqIGJhY2tlbmQgKG9yIGZhaWxlZCBsb2NhbGx5IGZvciBhbnkgb3RoZXIgcmVhc29uKS5cclxuICAgICAqL1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAoYmF0Y2gsIHVzZXJDYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5hc3NlcnRTdWJzY3JpYmVkKCd3cml0ZSgpJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAubG9jYWxXcml0ZShiYXRjaClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5hZGRQZW5kaW5nTXV0YXRpb24ocmVzdWx0LmJhdGNoSWQpO1xyXG4gICAgICAgICAgICBfdGhpcy5hZGRNdXRhdGlvbkNhbGxiYWNrKHJlc3VsdC5iYXRjaElkLCB1c2VyQ2FsbGJhY2spO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShyZXN1bHQuY2hhbmdlcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucmVtb3RlU3RvcmUuZmlsbFdyaXRlUGlwZWxpbmUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBUT0RPKGtsaW10KTogV3JhcCB0aGUgZ2l2ZW4gZXJyb3IgaW4gYSBzdGFuZGFyZCBGaXJlc3RvcmUgZXJyb3Igb2JqZWN0LlxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUud3JhcFVwZGF0ZUZ1bmN0aW9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICByZXR1cm4gZXJyb3IkJDE7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBUYWtlcyBhbiB1cGRhdGVGdW5jdGlvbiBpbiB3aGljaCBhIHNldCBvZiByZWFkcyBhbmQgd3JpdGVzIGNhbiBiZSBwZXJmb3JtZWRcclxuICAgICAqIGF0b21pY2FsbHkuIEluIHRoZSB1cGRhdGVGdW5jdGlvbiwgdGhlIGNsaWVudCBjYW4gcmVhZCBhbmQgd3JpdGUgdmFsdWVzXHJcbiAgICAgKiB1c2luZyB0aGUgc3VwcGxpZWQgdHJhbnNhY3Rpb24gb2JqZWN0LiBBZnRlciB0aGUgdXBkYXRlRnVuY3Rpb24sIGFsbFxyXG4gICAgICogY2hhbmdlcyB3aWxsIGJlIGNvbW1pdHRlZC4gSWYgc29tZSBvdGhlciBjbGllbnQgaGFzIGNoYW5nZWQgYW55IG9mIHRoZSBkYXRhXHJcbiAgICAgKiByZWZlcmVuY2VkLCB0aGVuIHRoZSB1cGRhdGVGdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCBhZ2Fpbi4gSWYgdGhlXHJcbiAgICAgKiB1cGRhdGVGdW5jdGlvbiBzdGlsbCBmYWlscyBhZnRlciB0aGUgZ2l2ZW4gbnVtYmVyIG9mIHJldHJpZXMsIHRoZW4gdGhlXHJcbiAgICAgKiB0cmFuc2FjdGlvbiB3aWxsIGJlIHJlamVjdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBUaGUgdHJhbnNhY3Rpb24gb2JqZWN0IHBhc3NlZCB0byB0aGUgdXBkYXRlRnVuY3Rpb24gY29udGFpbnMgbWV0aG9kcyBmb3JcclxuICAgICAqIGFjY2Vzc2luZyBkb2N1bWVudHMgYW5kIGNvbGxlY3Rpb25zLiBVbmxpa2Ugb3RoZXIgZGF0YXN0b3JlIGFjY2VzcywgZGF0YVxyXG4gICAgICogYWNjZXNzZWQgd2l0aCB0aGUgdHJhbnNhY3Rpb24gd2lsbCBub3QgcmVmbGVjdCBsb2NhbCBjaGFuZ2VzIHRoYXQgaGF2ZSBub3RcclxuICAgICAqIGJlZW4gY29tbWl0dGVkLiBGb3IgdGhpcyByZWFzb24sIGl0IGlzIHJlcXVpcmVkIHRoYXQgYWxsIHJlYWRzIGFyZVxyXG4gICAgICogcGVyZm9ybWVkIGJlZm9yZSBhbnkgd3JpdGVzLiBUcmFuc2FjdGlvbnMgbXVzdCBiZSBwZXJmb3JtZWQgd2hpbGUgb25saW5lLlxyXG4gICAgICpcclxuICAgICAqIFRoZSBwcm9taXNlIHJldHVybmVkIGlzIHJlc29sdmVkIHdoZW4gdGhlIHRyYW5zYWN0aW9uIGlzIGZ1bGx5IGNvbW1pdHRlZC5cclxuICAgICAqL1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUucnVuVHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAodXBkYXRlRnVuY3Rpb24sIHJldHJpZXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChyZXRyaWVzID09PSB2b2lkIDApIHsgcmV0cmllcyA9IDU7IH1cclxuICAgICAgICBhc3NlcnQocmV0cmllcyA+PSAwLCAnR290IG5lZ2F0aXZlIG51bWJlciBvZiByZXRyaWVzIGZvciB0cmFuc2FjdGlvbi4nKTtcclxuICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSB0aGlzLnJlbW90ZVN0b3JlLmNyZWF0ZVRyYW5zYWN0aW9uKCk7XHJcbiAgICAgICAgdmFyIHdyYXBwZWRVcGRhdGVGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHZhciB1c2VyUHJvbWlzZSA9IHVwZGF0ZUZ1bmN0aW9uKHRyYW5zYWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZCh1c2VyUHJvbWlzZSkgfHxcclxuICAgICAgICAgICAgICAgICAgICAhdXNlclByb21pc2UuY2F0Y2ggfHxcclxuICAgICAgICAgICAgICAgICAgICAhdXNlclByb21pc2UudGhlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChFcnJvcignVHJhbnNhY3Rpb24gY2FsbGJhY2sgbXVzdCByZXR1cm4gYSBQcm9taXNlJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJQcm9taXNlLmNhdGNoKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF90aGlzLndyYXBVcGRhdGVGdW5jdGlvbkVycm9yKGUpKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3RoaXMud3JhcFVwZGF0ZUZ1bmN0aW9uRXJyb3IoZSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gd3JhcHBlZFVwZGF0ZUZ1bmN0aW9uKCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAgICAgLmNvbW1pdCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJldHJpZXMgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhrbGltdCk6IFB1dCBpbiBhIHJldHJ5IGRlbGF5P1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJ1blRyYW5zYWN0aW9uKHVwZGF0ZUZ1bmN0aW9uLCByZXRyaWVzIC0gMSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmFwcGx5UmVtb3RlRXZlbnQgPSBmdW5jdGlvbiAocmVtb3RlRXZlbnQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuYXNzZXJ0U3Vic2NyaWJlZCgnYXBwbHlSZW1vdGVFdmVudCgpJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAuYXBwbHlSZW1vdGVFdmVudChyZW1vdGVFdmVudClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGNoYW5nZXMpIHtcclxuICAgICAgICAgICAgLy8gVXBkYXRlIGByZWNlaXZlZERvY3VtZW50YCBhcyBhcHByb3ByaWF0ZSBmb3IgYW55IGxpbWJvIHRhcmdldHMuXHJcbiAgICAgICAgICAgIGZvckVhY2gocmVtb3RlRXZlbnQudGFyZ2V0Q2hhbmdlcywgZnVuY3Rpb24gKHRhcmdldElkLCB0YXJnZXRDaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaW1ib1Jlc29sdXRpb24gPSBfdGhpcy5saW1ib1Jlc29sdXRpb25zQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxpbWJvUmVzb2x1dGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFNpbmNlIHRoaXMgaXMgYSBsaW1ibyByZXNvbHV0aW9uIGxvb2t1cCwgaXQncyBmb3IgYSBzaW5nbGUgZG9jdW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaXQgY291bGQgYmUgYWRkZWQsIG1vZGlmaWVkLCBvciByZW1vdmVkLCBidXQgbm90IGEgY29tYmluYXRpb24uXHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHRhcmdldENoYW5nZS5hZGRlZERvY3VtZW50cy5zaXplICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlLm1vZGlmaWVkRG9jdW1lbnRzLnNpemUgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRDaGFuZ2UucmVtb3ZlZERvY3VtZW50cy5zaXplIDw9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDEsICdMaW1ibyByZXNvbHV0aW9uIGZvciBzaW5nbGUgZG9jdW1lbnQgY29udGFpbnMgbXVsdGlwbGUgY2hhbmdlcy4nKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Q2hhbmdlLmFkZGVkRG9jdW1lbnRzLnNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWJvUmVzb2x1dGlvbi5yZWNlaXZlZERvY3VtZW50ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGFyZ2V0Q2hhbmdlLm1vZGlmaWVkRG9jdW1lbnRzLnNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydChsaW1ib1Jlc29sdXRpb24ucmVjZWl2ZWREb2N1bWVudCwgJ1JlY2VpdmVkIGNoYW5nZSBmb3IgbGltYm8gdGFyZ2V0IGRvY3VtZW50IHdpdGhvdXQgYWRkLicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0YXJnZXRDaGFuZ2UucmVtb3ZlZERvY3VtZW50cy5zaXplID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQobGltYm9SZXNvbHV0aW9uLnJlY2VpdmVkRG9jdW1lbnQsICdSZWNlaXZlZCByZW1vdmUgZm9yIGxpbWJvIHRhcmdldCBkb2N1bWVudCB3aXRob3V0IGFkZC4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGltYm9SZXNvbHV0aW9uLnJlY2VpdmVkRG9jdW1lbnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2FzIHByb2JhYmx5IGp1c3QgYSBDVVJSRU5UIHRhcmdldENoYW5nZSBvciBzaW1pbGFyLlxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5lbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKGNoYW5nZXMsIHJlbW90ZUV2ZW50KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX3RoaXMuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGVycik7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQXBwbGllcyBhbiBPbmxpbmVTdGF0ZSBjaGFuZ2UgdG8gdGhlIHN5bmMgZW5naW5lIGFuZCBub3RpZmllcyBhbnkgdmlld3Mgb2ZcclxuICAgICAqIHRoZSBjaGFuZ2UuXHJcbiAgICAgKi9cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmFwcGx5T25saW5lU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAob25saW5lU3RhdGUsIHNvdXJjZSkge1xyXG4gICAgICAgIC8vIElmIHdlIGFyZSB0aGUgc2Vjb25kYXJ5IGNsaWVudCwgd2UgZXhwbGljaXRseSBpZ25vcmUgdGhlIHJlbW90ZSBzdG9yZSdzXHJcbiAgICAgICAgLy8gb25saW5lIHN0YXRlICh0aGUgbG9jYWwgY2xpZW50IG1heSBnbyBvZmZsaW5lLCBldmVuIHRob3VnaCB0aGUgcHJpbWFyeVxyXG4gICAgICAgIC8vIHRhYiByZW1haW5zIG9ubGluZSkgYW5kIG9ubHkgYXBwbHkgdGhlIHByaW1hcnkgdGFiJ3Mgb25saW5lIHN0YXRlIGZyb21cclxuICAgICAgICAvLyBTaGFyZWRDbGllbnRTdGF0ZS5cclxuICAgICAgICBpZiAoKHRoaXMuaXNQcmltYXJ5ICYmIHNvdXJjZSA9PT0gT25saW5lU3RhdGVTb3VyY2UuUmVtb3RlU3RvcmUpIHx8XHJcbiAgICAgICAgICAgICghdGhpcy5pc1ByaW1hcnkgJiYgc291cmNlID09PSBPbmxpbmVTdGF0ZVNvdXJjZS5TaGFyZWRDbGllbnRTdGF0ZSkpIHtcclxuICAgICAgICAgICAgdmFyIG5ld1ZpZXdTbmFwc2hvdHNfMSA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5Vmlld3NCeVF1ZXJ5LmZvckVhY2goZnVuY3Rpb24gKHF1ZXJ5LCBxdWVyeVZpZXcpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2aWV3Q2hhbmdlID0gcXVlcnlWaWV3LnZpZXcuYXBwbHlPbmxpbmVTdGF0ZUNoYW5nZShvbmxpbmVTdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQodmlld0NoYW5nZS5saW1ib0NoYW5nZXMubGVuZ3RoID09PSAwLCAnT25saW5lU3RhdGUgc2hvdWxkIG5vdCBhZmZlY3QgbGltYm8gZG9jdW1lbnRzLicpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZpZXdDaGFuZ2Uuc25hcHNob3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdWaWV3U25hcHNob3RzXzEucHVzaCh2aWV3Q2hhbmdlLnNuYXBzaG90KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyLm9uT25saW5lU3RhdGVDaGFuZ2Uob25saW5lU3RhdGUpO1xyXG4gICAgICAgICAgICB0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lci5vbldhdGNoQ2hhbmdlKG5ld1ZpZXdTbmFwc2hvdHNfMSk7XHJcbiAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGUgPSBvbmxpbmVTdGF0ZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlLnNldE9ubGluZVN0YXRlKG9ubGluZVN0YXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5yZWplY3RMaXN0ZW4gPSBmdW5jdGlvbiAodGFyZ2V0SWQsIGVycikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgbGltYm9SZXNvbHV0aW9uLCBsaW1ib0tleSwgZG9jdW1lbnRVcGRhdGVzLCByZXNvbHZlZExpbWJvRG9jdW1lbnRzLCBldmVudF8xLCBxdWVyeVZpZXdfMTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFzc2VydFN1YnNjcmliZWQoJ3JlamVjdExpc3RlbnMoKScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlLnVwZGF0ZVF1ZXJ5U3RhdGUodGFyZ2V0SWQsICdyZWplY3RlZCcsIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWJvUmVzb2x1dGlvbiA9IHRoaXMubGltYm9SZXNvbHV0aW9uc0J5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGltYm9LZXkgPSBsaW1ib1Jlc29sdXRpb24gJiYgbGltYm9SZXNvbHV0aW9uLmtleTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsaW1ib0tleSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNpbmNlIHRoaXMgcXVlcnkgZmFpbGVkLCB3ZSB3b24ndCB3YW50IHRvIG1hbnVhbGx5IHVubGlzdGVuIHRvIGl0LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTbyBnbyBhaGVhZCBhbmQgcmVtb3ZlIGl0IGZyb20gYm9va2tlZXBpbmcuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGltYm9UYXJnZXRzQnlLZXkgPSB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5LnJlbW92ZShsaW1ib0tleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmxpbWJvUmVzb2x1dGlvbnNCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50VXBkYXRlcyA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50VXBkYXRlcyA9IGRvY3VtZW50VXBkYXRlcy5pbnNlcnQobGltYm9LZXksIG5ldyBOb0RvY3VtZW50KGxpbWJvS2V5LCBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVkTGltYm9Eb2N1bWVudHMgPSBkb2N1bWVudEtleVNldCgpLmFkZChsaW1ib0tleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50XzEgPSBuZXcgUmVtb3RlRXZlbnQoU25hcHNob3RWZXJzaW9uLk1JTiwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHRhcmdldENoYW5nZXM9ICovIHt9LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgLyogdGFyZ2V0TWlzbWF0Y2hlcz0gKi8gbmV3IFNvcnRlZFNldChwcmltaXRpdmVDb21wYXJhdG9yKSwgZG9jdW1lbnRVcGRhdGVzLCByZXNvbHZlZExpbWJvRG9jdW1lbnRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuYXBwbHlSZW1vdGVFdmVudChldmVudF8xKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVZpZXdfMSA9IHRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCEhcXVlcnlWaWV3XzEsICdVbmtub3duIHRhcmdldElkOiAnICsgdGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVsZWFzZVF1ZXJ5KHF1ZXJ5Vmlld18xLnF1ZXJ5LCAvKiBrZWVwUGVyc2lzdGVkUXVlcnlEYXRhICovIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnJlbW92ZUFuZENsZWFudXBRdWVyeShxdWVyeVZpZXdfMSk7IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIF90aGlzLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhlcnIpOyB9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyLm9uV2F0Y2hFcnJvcihxdWVyeVZpZXdfMS5xdWVyeSwgZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5hcHBseUJhdGNoU3RhdGUgPSBmdW5jdGlvbiAoYmF0Y2hJZCwgYmF0Y2hTdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRvY3VtZW50cztcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFzc2VydFN1YnNjcmliZWQoJ2FwcGx5QmF0Y2hTdGF0ZSgpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5sb29rdXBNdXRhdGlvbkRvY3VtZW50cyhiYXRjaElkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudHMgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudHMgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEEgdGhyb3R0bGVkIHRhYiBtYXkgbm90IGhhdmUgc2VlbiB0aGUgbXV0YXRpb24gYmVmb3JlIGl0IHdhcyBjb21wbGV0ZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCByZW1vdmVkIGZyb20gdGhlIG11dGF0aW9uIHF1ZXVlLCBpbiB3aGljaCBjYXNlIHdlIHdvbid0IGhhdmUgY2FjaGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgYWZmZWN0ZWQgZG9jdW1lbnRzLiBJbiB0aGlzIGNhc2Ugd2UgY2FuIHNhZmVseSBpZ25vcmUgdGhlIHVwZGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2luY2UgdGhhdCBtZWFucyB3ZSBkaWRuJ3QgYXBwbHkgdGhlIG11dGF0aW9uIGxvY2FsbHkgYXQgYWxsIChpZiB3ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGFkLCB3ZSB3b3VsZCBoYXZlIGNhY2hlZCB0aGUgYWZmZWN0ZWQgZG9jdW1lbnRzKSwgYW5kIHNvIHdlIHdpbGwganVzdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VlIGFueSByZXN1bHRpbmcgZG9jdW1lbnQgY2hhbmdlcyB2aWEgbm9ybWFsIHJlbW90ZSBkb2N1bWVudCB1cGRhdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhcyBhcHBsaWNhYmxlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ5LCAnQ2Fubm90IGFwcGx5IG11dGF0aW9uIGJhdGNoIHdpdGggaWQ6ICcgKyBiYXRjaElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShiYXRjaFN0YXRlID09PSAncGVuZGluZycpKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgYXJlIHRoZSBwcmltYXJ5IGNsaWVudCwgd2UgbmVlZCB0byBzZW5kIHRoaXMgd3JpdGUgdG8gdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tlbmQuIFNlY29uZGFyeSBjbGllbnRzIHdpbGwgaWdub3JlIHRoZXNlIHdyaXRlcyBzaW5jZSB0aGVpciByZW1vdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29ubmVjdGlvbiBpcyBkaXNhYmxlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZW1vdGVTdG9yZS5maWxsV3JpdGVQaXBlbGluZSgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIGFyZSB0aGUgcHJpbWFyeSBjbGllbnQsIHdlIG5lZWQgdG8gc2VuZCB0aGlzIHdyaXRlIHRvIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBiYWNrZW5kLiBTZWNvbmRhcnkgY2xpZW50cyB3aWxsIGlnbm9yZSB0aGVzZSB3cml0ZXMgc2luY2UgdGhlaXIgcmVtb3RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbm5lY3Rpb24gaXMgZGlzYWJsZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmF0Y2hTdGF0ZSA9PT0gJ2Fja25vd2xlZGdlZCcgfHwgYmF0Y2hTdGF0ZSA9PT0gJ3JlamVjdGVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTk9URTogQm90aCB0aGVzZSBtZXRob2RzIGFyZSBuby1vcHMgZm9yIGJhdGNoZXMgdGhhdCBvcmlnaW5hdGVkIGZyb21cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG90aGVyIGNsaWVudHMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NVc2VyQ2FsbGJhY2soYmF0Y2hJZCwgZXJyb3IkJDEgPyBlcnJvciQkMSA6IG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhbFN0b3JlLnJlbW92ZUNhY2hlZE11dGF0aW9uQmF0Y2hNZXRhZGF0YShiYXRjaElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWwoXCJVbmtub3duIGJhdGNoU3RhdGU6IFwiICsgYmF0Y2hTdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKGRvY3VtZW50cyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmFwcGx5U3VjY2Vzc2Z1bFdyaXRlID0gZnVuY3Rpb24gKG11dGF0aW9uQmF0Y2hSZXN1bHQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuYXNzZXJ0U3Vic2NyaWJlZCgnYXBwbHlTdWNjZXNzZnVsV3JpdGUoKScpO1xyXG4gICAgICAgIHZhciBiYXRjaElkID0gbXV0YXRpb25CYXRjaFJlc3VsdC5iYXRjaC5iYXRjaElkO1xyXG4gICAgICAgIC8vIFRoZSBsb2NhbCBzdG9yZSBtYXkgb3IgbWF5IG5vdCBiZSBhYmxlIHRvIGFwcGx5IHRoZSB3cml0ZSByZXN1bHQgYW5kXHJcbiAgICAgICAgLy8gcmFpc2UgZXZlbnRzIGltbWVkaWF0ZWx5IChkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgd2F0Y2hlciBpcyBjYXVnaHRcclxuICAgICAgICAvLyB1cCksIHNvIHdlIHJhaXNlIHVzZXIgY2FsbGJhY2tzIGZpcnN0IHNvIHRoYXQgdGhleSBjb25zaXN0ZW50bHkgaGFwcGVuXHJcbiAgICAgICAgLy8gYmVmb3JlIGxpc3RlbiBldmVudHMuXHJcbiAgICAgICAgdGhpcy5wcm9jZXNzVXNlckNhbGxiYWNrKGJhdGNoSWQsIC8qZXJyb3I9Ki8gbnVsbCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAuYWNrbm93bGVkZ2VCYXRjaChtdXRhdGlvbkJhdGNoUmVzdWx0KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoY2hhbmdlcykge1xyXG4gICAgICAgICAgICBfdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKGJhdGNoSWQsICdhY2tub3dsZWRnZWQnKTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUoY2hhbmdlcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIF90aGlzLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhlcnIpOyB9KTtcclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5yZWplY3RGYWlsZWRXcml0ZSA9IGZ1bmN0aW9uIChiYXRjaElkLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5hc3NlcnRTdWJzY3JpYmVkKCdyZWplY3RGYWlsZWRXcml0ZSgpJyk7XHJcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIG1heSBvciBtYXkgbm90IGJlIGFibGUgdG8gYXBwbHkgdGhlIHdyaXRlIHJlc3VsdCBhbmRcclxuICAgICAgICAvLyByYWlzZSBldmVudHMgaW1tZWRpYXRlbHkgKGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSB3YXRjaGVyIGlzIGNhdWdodCB1cCksXHJcbiAgICAgICAgLy8gc28gd2UgcmFpc2UgdXNlciBjYWxsYmFja3MgZmlyc3Qgc28gdGhhdCB0aGV5IGNvbnNpc3RlbnRseSBoYXBwZW4gYmVmb3JlXHJcbiAgICAgICAgLy8gbGlzdGVuIGV2ZW50cy5cclxuICAgICAgICB0aGlzLnByb2Nlc3NVc2VyQ2FsbGJhY2soYmF0Y2hJZCwgZXJyb3IkJDEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgLnJlamVjdEJhdGNoKGJhdGNoSWQpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChjaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnNoYXJlZENsaWVudFN0YXRlLnVwZGF0ZU11dGF0aW9uU3RhdGUoYmF0Y2hJZCwgJ3JlamVjdGVkJywgZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShjaGFuZ2VzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX3RoaXMuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGVycik7IH0pO1xyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmFkZE11dGF0aW9uQ2FsbGJhY2sgPSBmdW5jdGlvbiAoYmF0Y2hJZCwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgbmV3Q2FsbGJhY2tzID0gdGhpcy5tdXRhdGlvblVzZXJDYWxsYmFja3NbdGhpcy5jdXJyZW50VXNlci50b0tleSgpXTtcclxuICAgICAgICBpZiAoIW5ld0NhbGxiYWNrcykge1xyXG4gICAgICAgICAgICBuZXdDYWxsYmFja3MgPSBuZXcgU29ydGVkTWFwKHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBuZXdDYWxsYmFja3MgPSBuZXdDYWxsYmFja3MuaW5zZXJ0KGJhdGNoSWQsIGNhbGxiYWNrKTtcclxuICAgICAgICB0aGlzLm11dGF0aW9uVXNlckNhbGxiYWNrc1t0aGlzLmN1cnJlbnRVc2VyLnRvS2V5KCldID0gbmV3Q2FsbGJhY2tzO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVzb2x2ZXMgb3IgcmVqZWN0cyB0aGUgdXNlciBjYWxsYmFjayBmb3IgdGhlIGdpdmVuIGJhdGNoIGFuZCB0aGVuIGRpc2NhcmRzXHJcbiAgICAgKiBpdC5cclxuICAgICAqL1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUucHJvY2Vzc1VzZXJDYWxsYmFjayA9IGZ1bmN0aW9uIChiYXRjaElkLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHZhciBuZXdDYWxsYmFja3MgPSB0aGlzLm11dGF0aW9uVXNlckNhbGxiYWNrc1t0aGlzLmN1cnJlbnRVc2VyLnRvS2V5KCldO1xyXG4gICAgICAgIC8vIE5PVEU6IE11dGF0aW9ucyByZXN0b3JlZCBmcm9tIHBlcnNpc3RlbmNlIHdvbid0IGhhdmUgY2FsbGJhY2tzLCBzbyBpdCdzXHJcbiAgICAgICAgLy8gb2theSBmb3IgdGhlcmUgdG8gYmUgbm8gY2FsbGJhY2sgZm9yIHRoaXMgSUQuXHJcbiAgICAgICAgaWYgKG5ld0NhbGxiYWNrcykge1xyXG4gICAgICAgICAgICB2YXIgY2FsbGJhY2sgPSBuZXdDYWxsYmFja3MuZ2V0KGJhdGNoSWQpO1xyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChiYXRjaElkID09PSBuZXdDYWxsYmFja3MubWluS2V5KCksICdNdXRhdGlvbiBjYWxsYmFja3MgcHJvY2Vzc2VkIG91dC1vZi1vcmRlcj8nKTtcclxuICAgICAgICAgICAgICAgIGlmIChlcnJvciQkMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLnJlamVjdChlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBuZXdDYWxsYmFja3MgPSBuZXdDYWxsYmFja3MucmVtb3ZlKGJhdGNoSWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25Vc2VyQ2FsbGJhY2tzW3RoaXMuY3VycmVudFVzZXIudG9LZXkoKV0gPSBuZXdDYWxsYmFja3M7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnJlbW92ZUFuZENsZWFudXBRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeVZpZXcpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUucmVtb3ZlTG9jYWxRdWVyeVRhcmdldChxdWVyeVZpZXcudGFyZ2V0SWQpO1xyXG4gICAgICAgIHRoaXMucXVlcnlWaWV3c0J5UXVlcnkuZGVsZXRlKHF1ZXJ5Vmlldy5xdWVyeSk7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0W3F1ZXJ5Vmlldy50YXJnZXRJZF07XHJcbiAgICAgICAgaWYgKHRoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgIHZhciBsaW1ib0tleXMgPSB0aGlzLmxpbWJvRG9jdW1lbnRSZWZzLnJlZmVyZW5jZXNGb3JJZChxdWVyeVZpZXcudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWJvRG9jdW1lbnRSZWZzLnJlbW92ZVJlZmVyZW5jZXNGb3JJZChxdWVyeVZpZXcudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICBsaW1ib0tleXMuZm9yRWFjaChmdW5jdGlvbiAobGltYm9LZXkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpc1JlZmVyZW5jZWQgPSBfdGhpcy5saW1ib0RvY3VtZW50UmVmcy5jb250YWluc0tleShsaW1ib0tleSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzUmVmZXJlbmNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIHJlbW92ZWQgdGhlIGxhc3QgcmVmZXJlbmNlIGZvciB0aGlzIGtleVxyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbW92ZUxpbWJvVGFyZ2V0KGxpbWJvS2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnJlbW92ZUxpbWJvVGFyZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB0aGUgdGFyZ2V0IGFscmVhZHkgZ290IHJlbW92ZWQgYmVjYXVzZSB0aGUgcXVlcnkgZmFpbGVkLiBJbiB0aGF0IGNhc2UsXHJcbiAgICAgICAgLy8gdGhlIGtleSB3b24ndCBleGlzdCBpbiBgbGltYm9UYXJnZXRzQnlLZXlgLiBPbmx5IGRvIHRoZSBjbGVhbnVwIGlmIHdlIHN0aWxsIGhhdmUgdGhlIHRhcmdldC5cclxuICAgICAgICB2YXIgbGltYm9UYXJnZXRJZCA9IHRoaXMubGltYm9UYXJnZXRzQnlLZXkuZ2V0KGtleSk7XHJcbiAgICAgICAgaWYgKGxpbWJvVGFyZ2V0SWQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgLy8gVGhpcyB0YXJnZXQgYWxyZWFkeSBnb3QgcmVtb3ZlZCwgYmVjYXVzZSB0aGUgcXVlcnkgZmFpbGVkLlxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVtb3RlU3RvcmUudW5saXN0ZW4obGltYm9UYXJnZXRJZCk7XHJcbiAgICAgICAgdGhpcy5saW1ib1RhcmdldHNCeUtleSA9IHRoaXMubGltYm9UYXJnZXRzQnlLZXkucmVtb3ZlKGtleSk7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMubGltYm9SZXNvbHV0aW9uc0J5VGFyZ2V0W2xpbWJvVGFyZ2V0SWRdO1xyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnVwZGF0ZVRyYWNrZWRMaW1ib3MgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIGxpbWJvQ2hhbmdlcykge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgbGltYm9DaGFuZ2VzXzEgPSBsaW1ib0NoYW5nZXM7IF9pIDwgbGltYm9DaGFuZ2VzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBsaW1ib0NoYW5nZSA9IGxpbWJvQ2hhbmdlc18xW19pXTtcclxuICAgICAgICAgICAgaWYgKGxpbWJvQ2hhbmdlIGluc3RhbmNlb2YgQWRkZWRMaW1ib0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpbWJvRG9jdW1lbnRSZWZzLmFkZFJlZmVyZW5jZShsaW1ib0NoYW5nZS5rZXksIHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJhY2tMaW1ib0NoYW5nZShsaW1ib0NoYW5nZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAobGltYm9DaGFuZ2UgaW5zdGFuY2VvZiBSZW1vdmVkTGltYm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ5LCAnRG9jdW1lbnQgbm8gbG9uZ2VyIGluIGxpbWJvOiAnICsgbGltYm9DaGFuZ2Uua2V5KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGltYm9Eb2N1bWVudFJlZnMucmVtb3ZlUmVmZXJlbmNlKGxpbWJvQ2hhbmdlLmtleSwgdGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGlzUmVmZXJlbmNlZCA9IHRoaXMubGltYm9Eb2N1bWVudFJlZnMuY29udGFpbnNLZXkobGltYm9DaGFuZ2Uua2V5KTtcclxuICAgICAgICAgICAgICAgIGlmICghaXNSZWZlcmVuY2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgcmVtb3ZlZCB0aGUgbGFzdCByZWZlcmVuY2UgZm9yIHRoaXMga2V5XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVMaW1ib1RhcmdldChsaW1ib0NoYW5nZS5rZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZmFpbCgnVW5rbm93biBsaW1ibyBjaGFuZ2U6ICcgKyBKU09OLnN0cmluZ2lmeShsaW1ib0NoYW5nZSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnRyYWNrTGltYm9DaGFuZ2UgPSBmdW5jdGlvbiAobGltYm9DaGFuZ2UpIHtcclxuICAgICAgICB2YXIga2V5ID0gbGltYm9DaGFuZ2Uua2V5O1xyXG4gICAgICAgIGlmICghdGhpcy5saW1ib1RhcmdldHNCeUtleS5nZXQoa2V5KSkge1xyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDksICdOZXcgZG9jdW1lbnQgaW4gbGltYm86ICcgKyBrZXkpO1xyXG4gICAgICAgICAgICB2YXIgbGltYm9UYXJnZXRJZCA9IHRoaXMubGltYm9UYXJnZXRJZEdlbmVyYXRvci5uZXh0KCk7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IFF1ZXJ5LmF0UGF0aChrZXkucGF0aCk7XHJcbiAgICAgICAgICAgIHRoaXMubGltYm9SZXNvbHV0aW9uc0J5VGFyZ2V0W2xpbWJvVGFyZ2V0SWRdID0gbmV3IExpbWJvUmVzb2x1dGlvbihrZXkpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLmxpc3RlbihuZXcgUXVlcnlEYXRhKHF1ZXJ5LCBsaW1ib1RhcmdldElkLCBRdWVyeVB1cnBvc2UuTGltYm9SZXNvbHV0aW9uLCBMaXN0ZW5TZXF1ZW5jZS5JTlZBTElEKSk7XHJcbiAgICAgICAgICAgIHRoaXMubGltYm9UYXJnZXRzQnlLZXkgPSB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5Lmluc2VydChrZXksIGxpbWJvVGFyZ2V0SWQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyBWaXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5jdXJyZW50TGltYm9Eb2NzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5O1xyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUgPSBmdW5jdGlvbiAoY2hhbmdlcywgcmVtb3RlRXZlbnQpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIG5ld1NuYXBzLCBkb2NDaGFuZ2VzSW5BbGxWaWV3cywgcXVlcmllc1Byb2Nlc3NlZDtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdTbmFwcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2NDaGFuZ2VzSW5BbGxWaWV3cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyaWVzUHJvY2Vzc2VkID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlWaWV3c0J5UXVlcnkuZm9yRWFjaChmdW5jdGlvbiAoXywgcXVlcnlWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyaWVzUHJvY2Vzc2VkLnB1c2goUHJvbWlzZS5yZXNvbHZlKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpZXdEb2NDaGFuZ2VzID0gcXVlcnlWaWV3LnZpZXcuY29tcHV0ZURvY0NoYW5nZXMoY2hhbmdlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF2aWV3RG9jQ2hhbmdlcy5uZWVkc1JlZmlsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmlld0RvY0NoYW5nZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBxdWVyeSBoYXMgYSBsaW1pdCBhbmQgc29tZSBkb2NzIHdlcmUgcmVtb3ZlZCwgc28gd2UgbmVlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvIHJlLXJ1biB0aGUgcXVlcnkgYWdhaW5zdCB0aGUgbG9jYWwgc3RvcmUgdG8gbWFrZSBzdXJlIHdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGlkbid0IGxvc2UgYW55IGdvb2QgZG9jcyB0aGF0IGhhZCBiZWVuIHBhc3QgdGhlIGxpbWl0LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbFN0b3JlLmV4ZWN1dGVRdWVyeShxdWVyeVZpZXcucXVlcnkpLnRoZW4oZnVuY3Rpb24gKGRvY3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5Vmlldy52aWV3LmNvbXB1dGVEb2NDaGFuZ2VzKGRvY3MsIHZpZXdEb2NDaGFuZ2VzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHZpZXdEb2NDaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldENoYW5nZSA9IHJlbW90ZUV2ZW50ICYmIHJlbW90ZUV2ZW50LnRhcmdldENoYW5nZXNbcXVlcnlWaWV3LnRhcmdldElkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmlld0NoYW5nZSA9IHF1ZXJ5Vmlldy52aWV3LmFwcGx5Q2hhbmdlcyh2aWV3RG9jQ2hhbmdlcywgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogdXBkYXRlTGltYm9Eb2N1bWVudHM9ICovIF90aGlzLmlzUHJpbWFyeSA9PT0gdHJ1ZSwgdGFyZ2V0Q2hhbmdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVUcmFja2VkTGltYm9zKHF1ZXJ5Vmlldy50YXJnZXRJZCwgdmlld0NoYW5nZS5saW1ib0NoYW5nZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Q2hhbmdlLnNuYXBzaG90KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNoYXJlZENsaWVudFN0YXRlLnVwZGF0ZVF1ZXJ5U3RhdGUocXVlcnlWaWV3LnRhcmdldElkLCB2aWV3Q2hhbmdlLnNuYXBzaG90LmZyb21DYWNoZSA/ICdub3QtY3VycmVudCcgOiAnY3VycmVudCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1NuYXBzLnB1c2godmlld0NoYW5nZS5zbmFwc2hvdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb2NDaGFuZ2VzID0gTG9jYWxWaWV3Q2hhbmdlcy5mcm9tU25hcHNob3QocXVlcnlWaWV3LnRhcmdldElkLCB2aWV3Q2hhbmdlLnNuYXBzaG90KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jQ2hhbmdlc0luQWxsVmlld3MucHVzaChkb2NDaGFuZ2VzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBQcm9taXNlLmFsbChxdWVyaWVzUHJvY2Vzc2VkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyLm9uV2F0Y2hDaGFuZ2UobmV3U25hcHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUubm90aWZ5TG9jYWxWaWV3Q2hhbmdlcyhkb2NDaGFuZ2VzSW5BbGxWaWV3cyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVmVyaWZpZXMgdGhlIGVycm9yIHRocm93biBieSBhbiBMb2NhbFN0b3JlIG9wZXJhdGlvbi4gSWYgYSBMb2NhbFN0b3JlXHJcbiAgICAgKiBvcGVyYXRpb24gZmFpbHMgYmVjYXVzZSB0aGUgcHJpbWFyeSBsZWFzZSBoYXMgYmVlbiB0YWtlbiBieSBhbm90aGVyIGNsaWVudCxcclxuICAgICAqIHdlIGlnbm9yZSB0aGUgZXJyb3IgKHRoZSBwZXJzaXN0ZW5jZSBsYXllciB3aWxsIGltbWVkaWF0ZWx5IGNhbGxcclxuICAgICAqIGBhcHBseVByaW1hcnlMZWFzZWAgdG8gcHJvcGFnYXRlIHRoZSBwcmltYXJ5IHN0YXRlIGNoYW5nZSkuIEFsbCBvdGhlclxyXG4gICAgICogZXJyb3JzIGFyZSByZS10aHJvd24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGVyciBBbiBlcnJvciByZXR1cm5lZCBieSBhIExvY2FsU3RvcmUgb3BlcmF0aW9uLlxyXG4gICAgICogQHJldHVybiBBIFByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciB3ZSByZWNvdmVyZWQsIG9yIHRoZSBvcmlnaW5hbCBlcnJvci5cclxuICAgICAqL1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc1ByaW1hcnlMZWFzZUxvc3RFcnJvcihlcnIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ5LCAnVW5leHBlY3RlZGx5IGxvc3QgcHJpbWFyeSBsZWFzZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5hc3NlcnRTdWJzY3JpYmVkID0gZnVuY3Rpb24gKGZuTmFtZSkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lciAhPT0gbnVsbCwgJ1RyeWluZyB0byBjYWxsICcgKyBmbk5hbWUgKyAnIGJlZm9yZSBjYWxsaW5nIHN1YnNjcmliZSgpLicpO1xyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UgPSBmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdXNlckNoYW5nZWQsIHJlc3VsdDtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyQ2hhbmdlZCA9ICF0aGlzLmN1cnJlbnRVc2VyLmlzRXF1YWwodXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSB1c2VyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXVzZXJDaGFuZ2VkKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmhhbmRsZVVzZXJDaGFuZ2UodXNlcildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGIvMTE0MjI2NDE3KTogQ29uc2lkZXIgY2FsbGluZyB0aGlzIG9ubHkgaW4gdGhlIHByaW1hcnkgdGFiLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlLmhhbmRsZVVzZXJDaGFuZ2UodXNlciwgcmVzdWx0LnJlbW92ZWRCYXRjaElkcywgcmVzdWx0LmFkZGVkQmF0Y2hJZHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUocmVzdWx0LmFmZmVjdGVkRG9jdW1lbnRzKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVtb3RlU3RvcmUuaGFuZGxlQ3JlZGVudGlhbENoYW5nZSgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5hcHBseVByaW1hcnlTdGF0ZSA9IGZ1bmN0aW9uIChpc1ByaW1hcnkpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGFjdGl2ZVRhcmdldHMsIGFjdGl2ZVF1ZXJpZXMsIF9pLCBhY3RpdmVRdWVyaWVzXzEsIHF1ZXJ5RGF0YSwgYWN0aXZlVGFyZ2V0c18xLCBwXzE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoaXNQcmltYXJ5ID09PSB0cnVlICYmIHRoaXMuaXNQcmltYXJ5ICE9PSB0cnVlKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNQcmltYXJ5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZW1vdGVTdG9yZS5hcHBseVByaW1hcnlTdGF0ZSh0cnVlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhcmdldHMgPSB0aGlzLnNoYXJlZENsaWVudFN0YXRlLmdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnN5bmNocm9uaXplUXVlcnlWaWV3c0FuZFJhaXNlU25hcHNob3RzKGFjdGl2ZVRhcmdldHMudG9BcnJheSgpKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVRdWVyaWVzID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pID0gMCwgYWN0aXZlUXVlcmllc18xID0gYWN0aXZlUXVlcmllczsgX2kgPCBhY3RpdmVRdWVyaWVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeURhdGEgPSBhY3RpdmVRdWVyaWVzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVTdG9yZS5saXN0ZW4ocXVlcnlEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGlzUHJpbWFyeSA9PT0gZmFsc2UgJiYgdGhpcy5pc1ByaW1hcnkgIT09IGZhbHNlKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNQcmltYXJ5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhcmdldHNfMSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwXzEgPSBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yRWFjaE51bWJlcih0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldCwgZnVuY3Rpb24gKHRhcmdldElkLCBxdWVyeVZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5pc0xvY2FsUXVlcnlUYXJnZXQodGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGFyZ2V0c18xLnB1c2godGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcF8xID0gcF8xLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMudW5saXN0ZW4ocXVlcnlWaWV3LnF1ZXJ5KTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdGVTdG9yZS51bmxpc3RlbihxdWVyeVZpZXcudGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcF8xXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zeW5jaHJvbml6ZVF1ZXJ5Vmlld3NBbmRSYWlzZVNuYXBzaG90cyhhY3RpdmVUYXJnZXRzXzEpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldExpbWJvRG9jdW1lbnRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVtb3RlU3RvcmUuYXBwbHlQcmltYXJ5U3RhdGUoZmFsc2UpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA3O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUucmVzZXRMaW1ib0RvY3VtZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGZvckVhY2hOdW1iZXIodGhpcy5saW1ib1Jlc29sdXRpb25zQnlUYXJnZXQsIGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICBfdGhpcy5yZW1vdGVTdG9yZS51bmxpc3Rlbih0YXJnZXRJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5saW1ib0RvY3VtZW50UmVmcy5yZW1vdmVBbGxSZWZlcmVuY2VzKCk7XHJcbiAgICAgICAgdGhpcy5saW1ib1Jlc29sdXRpb25zQnlUYXJnZXQgPSBbXTtcclxuICAgICAgICB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5ID0gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlY29uY2lsZSB0aGUgcXVlcnkgdmlld3Mgb2YgdGhlIHByb3ZpZGVkIHF1ZXJ5IHRhcmdldHMgd2l0aCB0aGUgc3RhdGUgZnJvbVxyXG4gICAgICogcGVyc2lzdGVuY2UuIFJhaXNlcyBzbmFwc2hvdHMgZm9yIGFueSBjaGFuZ2VzIHRoYXQgYWZmZWN0IHRoZSBsb2NhbFxyXG4gICAgICogY2xpZW50IGFuZCByZXR1cm5zIHRoZSB1cGRhdGVkIHN0YXRlIG9mIGFsbCB0YXJnZXQncyBxdWVyeSBkYXRhLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuc3luY2hyb25pemVRdWVyeVZpZXdzQW5kUmFpc2VTbmFwc2hvdHMgPSBmdW5jdGlvbiAodGFyZ2V0cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHAgPSBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICB2YXIgYWN0aXZlUXVlcmllcyA9IFtdO1xyXG4gICAgICAgIHZhciBuZXdWaWV3U25hcHNob3RzID0gW107XHJcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgcCA9IHAudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBxdWVyeURhdGEsIHF1ZXJ5Vmlldywgdmlld0NoYW5nZSwgcXVlcnk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VmlldyA9IHRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnlWaWV3KSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBxdWVyaWVzIHRoYXQgaGF2ZSBhIGxvY2FsIFZpZXcsIHdlIG5lZWQgdG8gdXBkYXRlIHRoZWlyIHN0YXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbiBMb2NhbFN0b3JlIChhcyB0aGUgcmVzdW1lIHRva2VuIGFuZCB0aGUgc25hcHNob3QgdmVyc2lvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWlnaHQgaGF2ZSBjaGFuZ2VkKSBhbmQgcmVjb25jaWxlIHRoZWlyIHZpZXdzIHdpdGggdGhlIHBlcnNpc3RlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RhdGUgKHRoZSBsaXN0IG9mIHN5bmNlZERvY3VtZW50cyBtYXkgaGF2ZSBnb3R0ZW4gb3V0IG9mIHN5bmMpLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLnJlbGVhc2VRdWVyeShxdWVyeVZpZXcucXVlcnksIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qa2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YT0qLyB0cnVlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBxdWVyaWVzIHRoYXQgaGF2ZSBhIGxvY2FsIFZpZXcsIHdlIG5lZWQgdG8gdXBkYXRlIHRoZWlyIHN0YXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbiBMb2NhbFN0b3JlIChhcyB0aGUgcmVzdW1lIHRva2VuIGFuZCB0aGUgc25hcHNob3QgdmVyc2lvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWlnaHQgaGF2ZSBjaGFuZ2VkKSBhbmQgcmVjb25jaWxlIHRoZWlyIHZpZXdzIHdpdGggdGhlIHBlcnNpc3RlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RhdGUgKHRoZSBsaXN0IG9mIHN5bmNlZERvY3VtZW50cyBtYXkgaGF2ZSBnb3R0ZW4gb3V0IG9mIHN5bmMpLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmFsbG9jYXRlUXVlcnkocXVlcnlWaWV3LnF1ZXJ5KV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5RGF0YSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc3luY2hyb25pemVWaWV3QW5kQ29tcHV0ZVNuYXBzaG90KHF1ZXJ5VmlldyldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Q2hhbmdlID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdDaGFuZ2Uuc25hcHNob3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdWaWV3U25hcHNob3RzLnB1c2godmlld0NoYW5nZS5zbmFwc2hvdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHRoaXMuaXNQcmltYXJ5ID09PSB0cnVlLCAnQSBzZWNvbmRhcnkgdGFiIHNob3VsZCBuZXZlciBoYXZlIGFuIGFjdGl2ZSBxdWVyeSB3aXRob3V0IGFuIGFjdGl2ZSB2aWV3LicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmdldFF1ZXJ5Rm9yVGFyZ2V0KHRhcmdldElkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCEhcXVlcnksIFwiUXVlcnkgZGF0YSBmb3IgdGFyZ2V0IFwiICsgdGFyZ2V0SWQgKyBcIiBub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUuYWxsb2NhdGVRdWVyeShxdWVyeSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeURhdGEgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmluaXRpYWxpemVWaWV3QW5kQ29tcHV0ZVNuYXBzaG90KHF1ZXJ5RGF0YSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLypjdXJyZW50PSovIGZhbHNlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gODtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlUXVlcmllcy5wdXNoKHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pOyB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgdGFyZ2V0c18xID0gdGFyZ2V0czsgX2kgPCB0YXJnZXRzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IHRhcmdldHNfMVtfaV07XHJcbiAgICAgICAgICAgIF9sb29wXzEodGFyZ2V0SWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMuc3luY0VuZ2luZUxpc3RlbmVyLm9uV2F0Y2hDaGFuZ2UobmV3Vmlld1NuYXBzaG90cyk7XHJcbiAgICAgICAgICAgIHJldHVybiBhY3RpdmVRdWVyaWVzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmdldEFjdGl2ZUNsaWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZS5nZXRBY3RpdmVDbGllbnRzKCk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuYXBwbHlUYXJnZXRTdGF0ZSA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgc3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBfYSwgcXVlcnlWaWV3O1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgcmVjZWl2ZSBhIHRhcmdldCBzdGF0ZSBub3RpZmljYXRpb24gdmlhIFdlYlN0b3JhZ2UsIHdlIGFyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWl0aGVyIGFscmVhZHkgc2Vjb25kYXJ5IG9yIGFub3RoZXIgdGFiIGhhcyB0YWtlbiB0aGUgcHJpbWFyeSBsZWFzZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckOSwgJ0lnbm9yaW5nIHVuZXhwZWN0ZWQgcXVlcnkgc3RhdGUgbm90aWZpY2F0aW9uLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXRbdGFyZ2V0SWRdKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBzdGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3VycmVudCc6IHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbm90LWN1cnJlbnQnOiByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlamVjdGVkJzogcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5sb2NhbFN0b3JlLmdldE5ld0RvY3VtZW50Q2hhbmdlcygpLnRoZW4oZnVuY3Rpb24gKGNoYW5nZXMpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ludGhlc2l6ZWRSZW1vdGVFdmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeW50aGVzaXplZFJlbW90ZUV2ZW50ID0gUmVtb3RlRXZlbnQuY3JlYXRlU3ludGhlc2l6ZWRSZW1vdGVFdmVudEZvckN1cnJlbnRDaGFuZ2UodGFyZ2V0SWQsIHN0YXRlID09PSAnY3VycmVudCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUoY2hhbmdlcywgc3ludGhlc2l6ZWRSZW1vdGVFdmVudCldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9LCBmdW5jdGlvbiAoZXJyKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVRhcmdldHNfMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRG9jdW1lbnRDaGFuZ2VNaXNzaW5nRXJyb3IoZXJyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhcmdldHNfMiA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JFYWNoTnVtYmVyKHRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0LCBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZlVGFyZ2V0c18yLnB1c2godGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc3luY2hyb25pemVRdWVyeVZpZXdzQW5kUmFpc2VTbmFwc2hvdHMoYWN0aXZlVGFyZ2V0c18yKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VmlldyA9IHRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbmRDbGVhbnVwUXVlcnkocXVlcnlWaWV3KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLnJlbGVhc2VRdWVyeShxdWVyeVZpZXcucXVlcnksIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyprZWVwUGVyc2lzdGVkUXVlcnlEYXRhPSovIHRydWUpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zeW5jRW5naW5lTGlzdGVuZXIub25XYXRjaEVycm9yKHF1ZXJ5Vmlldy5xdWVyeSwgZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWwoJ1VuZXhwZWN0ZWQgdGFyZ2V0IHN0YXRlOiAnICsgc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDU7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmFwcGx5QWN0aXZlVGFyZ2V0c0NoYW5nZSA9IGZ1bmN0aW9uIChhZGRlZCwgcmVtb3ZlZCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgX2ksIGFkZGVkXzEsIHRhcmdldElkLCBxdWVyeSwgcXVlcnlEYXRhLCBfbG9vcF8yLCB0aGlzXzEsIF9hLCByZW1vdmVkXzEsIHRhcmdldElkO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaSA9IDAsIGFkZGVkXzEgPSBhZGRlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2kgPCBhZGRlZF8xLmxlbmd0aCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZCA9IGFkZGVkXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIXRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0W3RhcmdldElkXSwgJ1RyeWluZyB0byBhZGQgYW4gYWxyZWFkeSBhY3RpdmUgdGFyZ2V0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5nZXRRdWVyeUZvclRhcmdldCh0YXJnZXRJZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCghIXF1ZXJ5LCBcIlF1ZXJ5IGRhdGEgZm9yIGFjdGl2ZSB0YXJnZXQgXCIgKyB0YXJnZXRJZCArIFwiIG5vdCBmb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmFsbG9jYXRlUXVlcnkocXVlcnkpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5RGF0YSA9IF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5pbml0aWFsaXplVmlld0FuZENvbXB1dGVTbmFwc2hvdChxdWVyeURhdGEsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLypjdXJyZW50PSovIGZhbHNlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3RlU3RvcmUubGlzdGVuKHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2xvb3BfMiA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHF1ZXJ5VmlldztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlWaWV3ID0gdGhpc18xLnF1ZXJ5Vmlld3NCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5VmlldykgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzXzEubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVsZWFzZVF1ZXJ5KHF1ZXJ5Vmlldy5xdWVyeSwgLyprZWVwUGVyc2lzdGVkUXVlcnlEYXRhPSovIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbW90ZVN0b3JlLnVubGlzdGVuKHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVtb3ZlQW5kQ2xlYW51cFF1ZXJ5KHF1ZXJ5Vmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIF90aGlzLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhlcnIpOyB9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNfMSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gMCwgcmVtb3ZlZF8xID0gcmVtb3ZlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA3O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2EgPCByZW1vdmVkXzEubGVuZ3RoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMTBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZCA9IHJlbW92ZWRfMVtfYV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNSAvKnlpZWxkKiovLCBfbG9vcF8yKHRhcmdldElkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gOTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS4gSW4gb3RoZXIgY2xpZW50cywgTG9jYWxTdG9yZSBpcyB1bmF3YXJlIG9mXHJcbiAgICAvLyB0aGUgb25saW5lIHN0YXRlLlxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuZW5hYmxlTmV0d29yayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmxvY2FsU3RvcmUuc2V0TmV0d29ya0VuYWJsZWQodHJ1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlU3RvcmUuZW5hYmxlTmV0d29yaygpO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuIEluIG90aGVyIGNsaWVudHMsIExvY2FsU3RvcmUgaXMgdW5hd2FyZSBvZlxyXG4gICAgLy8gdGhlIG9ubGluZSBzdGF0ZS5cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmRpc2FibGVOZXR3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubG9jYWxTdG9yZS5zZXROZXR3b3JrRW5hYmxlZChmYWxzZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlU3RvcmUuZGlzYWJsZU5ldHdvcmsoKTtcclxuICAgIH07XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIGxpbWJvUmVzb2x1dGlvbiA9IHRoaXMubGltYm9SZXNvbHV0aW9uc0J5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICBpZiAobGltYm9SZXNvbHV0aW9uICYmIGxpbWJvUmVzb2x1dGlvbi5yZWNlaXZlZERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkb2N1bWVudEtleVNldCgpLmFkZChsaW1ib1Jlc29sdXRpb24ua2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldFt0YXJnZXRJZF1cclxuICAgICAgICAgICAgICAgID8gdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXRbdGFyZ2V0SWRdLnZpZXcuc3luY2VkRG9jdW1lbnRzXHJcbiAgICAgICAgICAgICAgICA6IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBTeW5jRW5naW5lO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFNpbXBsZSB3cmFwcGVyIGFyb3VuZCBhIG51bGxhYmxlIFVJRC4gTW9zdGx5IGV4aXN0cyB0byBtYWtlIGNvZGUgbW9yZVxyXG4gKiByZWFkYWJsZS5cclxuICovXHJcbnZhciBVc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVXNlcih1aWQpIHtcclxuICAgICAgICB0aGlzLnVpZCA9IHVpZDtcclxuICAgIH1cclxuICAgIFVzZXIucHJvdG90eXBlLmlzQXV0aGVudGljYXRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy51aWQgIT0gbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBrZXkgcmVwcmVzZW50aW5nIHRoaXMgdXNlciwgc3VpdGFibGUgZm9yIGluY2x1c2lvbiBpbiBhXHJcbiAgICAgKiBkaWN0aW9uYXJ5LlxyXG4gICAgICovXHJcbiAgICBVc2VyLnByb3RvdHlwZS50b0tleSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ3VpZDonICsgdGhpcy51aWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gJ2Fub255bW91cy11c2VyJztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVXNlci5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlclVzZXIpIHtcclxuICAgICAgICByZXR1cm4gb3RoZXJVc2VyLnVpZCA9PT0gdGhpcy51aWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqIEEgdXNlciB3aXRoIGEgbnVsbCBVSUQuICovXHJcbiAgICBVc2VyLlVOQVVUSEVOVElDQVRFRCA9IG5ldyBVc2VyKG51bGwpO1xyXG4gICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBMb29rIGludG8gZ2V0dGluZyBhIHByb3BlciB1aWQtZXF1aXZhbGVudCBmb3JcclxuICAgIC8vIG5vbi1GaXJlYmFzZUF1dGggcHJvdmlkZXJzLlxyXG4gICAgVXNlci5HT09HTEVfQ1JFREVOVElBTFMgPSBuZXcgVXNlcignZ29vZ2xlLWNyZWRlbnRpYWxzLXVpZCcpO1xyXG4gICAgVXNlci5GSVJTVF9QQVJUWSA9IG5ldyBVc2VyKCdmaXJzdC1wYXJ0eS11aWQnKTtcclxuICAgIHJldHVybiBVc2VyO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckMTAgPSAnU2hhcmVkQ2xpZW50U3RhdGUnO1xyXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBMb2NhbFN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIHRoZSBjbGllbnQgc3RhdGUgaXM6XHJcbi8vICAgICBmaXJlc3RvcmVfY2xpZW50c188cGVyc2lzdGVuY2VfcHJlZml4Pl88aW5zdGFuY2Vfa2V5PlxyXG52YXIgQ0xJRU5UX1NUQVRFX0tFWV9QUkVGSVggPSAnZmlyZXN0b3JlX2NsaWVudHMnO1xyXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBXZWJTdG9yYWdlIGtleSB0aGF0IHN0b3JlcyB0aGUgbXV0YXRpb24gc3RhdGUgaXM6XHJcbi8vICAgICBmaXJlc3RvcmVfbXV0YXRpb25zXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XzxiYXRjaF9pZD5cclxuLy8gICAgIChmb3IgdW5hdXRoZW50aWNhdGVkIHVzZXJzKVxyXG4vLyBvcjogZmlyZXN0b3JlX211dGF0aW9uc188cGVyc2lzdGVuY2VfcHJlZml4Pl88YmF0Y2hfaWQ+Xzx1c2VyX3VpZD5cclxuLy9cclxuLy8gJ3VzZXJfdWlkJyBpcyBsYXN0IHRvIGF2b2lkIG5lZWRpbmcgdG8gZXNjYXBlICdfJyBjaGFyYWN0ZXJzIHRoYXQgaXQgbWlnaHRcclxuLy8gY29udGFpbi5cclxudmFyIE1VVEFUSU9OX0JBVENIX0tFWV9QUkVGSVggPSAnZmlyZXN0b3JlX211dGF0aW9ucyc7XHJcbi8vIFRoZSBmb3JtYXQgb2YgdGhlIFdlYlN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIGEgcXVlcnkgdGFyZ2V0J3MgbWV0YWRhdGEgaXM6XHJcbi8vICAgICBmaXJlc3RvcmVfdGFyZ2V0c188cGVyc2lzdGVuY2VfcHJlZml4Pl88dGFyZ2V0X2lkPlxyXG52YXIgUVVFUllfVEFSR0VUX0tFWV9QUkVGSVggPSAnZmlyZXN0b3JlX3RhcmdldHMnO1xyXG4vLyBUaGUgV2ViU3RvcmFnZSBwcmVmaXggdGhhdCBzdG9yZXMgdGhlIHByaW1hcnkgdGFiJ3Mgb25saW5lIHN0YXRlLiBUaGVcclxuLy8gZm9ybWF0IG9mIHRoZSBrZXkgaXM6XHJcbi8vICAgICBmaXJlc3RvcmVfb25saW5lX3N0YXRlXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XHJcbnZhciBPTkxJTkVfU1RBVEVfS0VZX1BSRUZJWCA9ICdmaXJlc3RvcmVfb25saW5lX3N0YXRlJztcclxuLy8gVGhlIFdlYlN0b3JhZ2Uga2V5IHByZWZpeCBmb3IgdGhlIGtleSB0aGF0IHN0b3JlcyB0aGUgbGFzdCBzZXF1ZW5jZSBudW1iZXIgYWxsb2NhdGVkLiBUaGUga2V5XHJcbi8vIGxvb2tzIGxpa2UgJ2ZpcmVzdG9yZV9zZXF1ZW5jZV9udW1iZXJfPHBlcnNpc3RlbmNlX3ByZWZpeD4nLlxyXG52YXIgU0VRVUVOQ0VfTlVNQkVSX0tFWV9QUkVGSVggPSAnZmlyZXN0b3JlX3NlcXVlbmNlX251bWJlcic7XHJcbi8qKlxyXG4gKiBIb2xkcyB0aGUgc3RhdGUgb2YgYSBtdXRhdGlvbiBiYXRjaCwgaW5jbHVkaW5nIGl0cyB1c2VyIElELCBiYXRjaCBJRCBhbmRcclxuICogd2hldGhlciB0aGUgYmF0Y2ggaXMgJ3BlbmRpbmcnLCAnYWNrbm93bGVkZ2VkJyBvciAncmVqZWN0ZWQnLlxyXG4gKi9cclxuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xyXG52YXIgTXV0YXRpb25NZXRhZGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE11dGF0aW9uTWV0YWRhdGEodXNlciwgYmF0Y2hJZCwgc3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcclxuICAgICAgICB0aGlzLmJhdGNoSWQgPSBiYXRjaElkO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICB0aGlzLmVycm9yID0gZXJyb3IkJDE7XHJcbiAgICAgICAgYXNzZXJ0KChlcnJvciQkMSAhPT0gdW5kZWZpbmVkKSA9PT0gKHN0YXRlID09PSAncmVqZWN0ZWQnKSwgXCJNdXRhdGlvbk1ldGFkYXRhIG11c3QgY29udGFpbiBhbiBlcnJvciBpZmYgc3RhdGUgaXMgJ3JlamVjdGVkJ1wiKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGEgTXV0YXRpb25NZXRhZGF0YSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXHJcbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxyXG4gICAgICovXHJcbiAgICBNdXRhdGlvbk1ldGFkYXRhLmZyb21XZWJTdG9yYWdlRW50cnkgPSBmdW5jdGlvbiAodXNlciwgYmF0Y2hJZCwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25CYXRjaCA9IEpTT04ucGFyc2UodmFsdWUpO1xyXG4gICAgICAgIHZhciB2YWxpZERhdGEgPSB0eXBlb2YgbXV0YXRpb25CYXRjaCA9PT0gJ29iamVjdCcgJiZcclxuICAgICAgICAgICAgWydwZW5kaW5nJywgJ2Fja25vd2xlZGdlZCcsICdyZWplY3RlZCddLmluZGV4T2YobXV0YXRpb25CYXRjaC5zdGF0ZSkgIT09XHJcbiAgICAgICAgICAgICAgICAtMSAmJlxyXG4gICAgICAgICAgICAobXV0YXRpb25CYXRjaC5lcnJvciA9PT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgICAgICAgICAgICB0eXBlb2YgbXV0YXRpb25CYXRjaC5lcnJvciA9PT0gJ29iamVjdCcpO1xyXG4gICAgICAgIHZhciBmaXJlc3RvcmVFcnJvciA9IHVuZGVmaW5lZDtcclxuICAgICAgICBpZiAodmFsaWREYXRhICYmIG11dGF0aW9uQmF0Y2guZXJyb3IpIHtcclxuICAgICAgICAgICAgdmFsaWREYXRhID1cclxuICAgICAgICAgICAgICAgIHR5cGVvZiBtdXRhdGlvbkJhdGNoLmVycm9yLm1lc3NhZ2UgPT09ICdzdHJpbmcnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZW9mIG11dGF0aW9uQmF0Y2guZXJyb3IuY29kZSA9PT0gJ3N0cmluZyc7XHJcbiAgICAgICAgICAgIGlmICh2YWxpZERhdGEpIHtcclxuICAgICAgICAgICAgICAgIGZpcmVzdG9yZUVycm9yID0gbmV3IEZpcmVzdG9yZUVycm9yKG11dGF0aW9uQmF0Y2guZXJyb3IuY29kZSwgbXV0YXRpb25CYXRjaC5lcnJvci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsaWREYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgTXV0YXRpb25NZXRhZGF0YSh1c2VyLCBiYXRjaElkLCBtdXRhdGlvbkJhdGNoLnN0YXRlLCBmaXJlc3RvcmVFcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlcnJvcihMT0dfVEFHJDEwLCBcIkZhaWxlZCB0byBwYXJzZSBtdXRhdGlvbiBzdGF0ZSBmb3IgSUQgJ1wiICsgYmF0Y2hJZCArIFwiJzogXCIgKyB2YWx1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBNdXRhdGlvbk1ldGFkYXRhLnByb3RvdHlwZS50b1dlYlN0b3JhZ2VKU09OID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBiYXRjaE1ldGFkYXRhID0ge1xyXG4gICAgICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcclxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpIC8vIE1vZGlmeSB0aGUgZXhpc3RpbmcgdmFsdWUgdG8gdHJpZ2dlciB1cGRhdGUuXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAodGhpcy5lcnJvcikge1xyXG4gICAgICAgICAgICBiYXRjaE1ldGFkYXRhLmVycm9yID0ge1xyXG4gICAgICAgICAgICAgICAgY29kZTogdGhpcy5lcnJvci5jb2RlLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5lcnJvci5tZXNzYWdlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShiYXRjaE1ldGFkYXRhKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTXV0YXRpb25NZXRhZGF0YTtcclxufSgpKTtcclxuLyoqXHJcbiAqIEhvbGRzIHRoZSBzdGF0ZSBvZiBhIHF1ZXJ5IHRhcmdldCwgaW5jbHVkaW5nIGl0cyB0YXJnZXQgSUQgYW5kIHdoZXRoZXIgdGhlXHJcbiAqIHRhcmdldCBpcyAnbm90LWN1cnJlbnQnLCAnY3VycmVudCcgb3IgJ3JlamVjdGVkJy5cclxuICovXHJcbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcclxudmFyIFF1ZXJ5VGFyZ2V0TWV0YWRhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBRdWVyeVRhcmdldE1ldGFkYXRhKHRhcmdldElkLCBzdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICB0aGlzLnRhcmdldElkID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvciQkMTtcclxuICAgICAgICBhc3NlcnQoKGVycm9yJCQxICE9PSB1bmRlZmluZWQpID09PSAoc3RhdGUgPT09ICdyZWplY3RlZCcpLCBcIlF1ZXJ5VGFyZ2V0TWV0YWRhdGEgbXVzdCBjb250YWluIGFuIGVycm9yIGlmZiBzdGF0ZSBpcyAncmVqZWN0ZWQnXCIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBRdWVyeVRhcmdldE1ldGFkYXRhIGZyb20gaXRzIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cclxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXHJcbiAgICAgKi9cclxuICAgIFF1ZXJ5VGFyZ2V0TWV0YWRhdGEuZnJvbVdlYlN0b3JhZ2VFbnRyeSA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0U3RhdGUgPSBKU09OLnBhcnNlKHZhbHVlKTtcclxuICAgICAgICB2YXIgdmFsaWREYXRhID0gdHlwZW9mIHRhcmdldFN0YXRlID09PSAnb2JqZWN0JyAmJlxyXG4gICAgICAgICAgICBbJ25vdC1jdXJyZW50JywgJ2N1cnJlbnQnLCAncmVqZWN0ZWQnXS5pbmRleE9mKHRhcmdldFN0YXRlLnN0YXRlKSAhPT1cclxuICAgICAgICAgICAgICAgIC0xICYmXHJcbiAgICAgICAgICAgICh0YXJnZXRTdGF0ZS5lcnJvciA9PT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgICAgICAgICAgICB0eXBlb2YgdGFyZ2V0U3RhdGUuZXJyb3IgPT09ICdvYmplY3QnKTtcclxuICAgICAgICB2YXIgZmlyZXN0b3JlRXJyb3IgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgaWYgKHZhbGlkRGF0YSAmJiB0YXJnZXRTdGF0ZS5lcnJvcikge1xyXG4gICAgICAgICAgICB2YWxpZERhdGEgPVxyXG4gICAgICAgICAgICAgICAgdHlwZW9mIHRhcmdldFN0YXRlLmVycm9yLm1lc3NhZ2UgPT09ICdzdHJpbmcnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZW9mIHRhcmdldFN0YXRlLmVycm9yLmNvZGUgPT09ICdzdHJpbmcnO1xyXG4gICAgICAgICAgICBpZiAodmFsaWREYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBmaXJlc3RvcmVFcnJvciA9IG5ldyBGaXJlc3RvcmVFcnJvcih0YXJnZXRTdGF0ZS5lcnJvci5jb2RlLCB0YXJnZXRTdGF0ZS5lcnJvci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsaWREYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUXVlcnlUYXJnZXRNZXRhZGF0YSh0YXJnZXRJZCwgdGFyZ2V0U3RhdGUuc3RhdGUsIGZpcmVzdG9yZUVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGVycm9yKExPR19UQUckMTAsIFwiRmFpbGVkIHRvIHBhcnNlIHRhcmdldCBzdGF0ZSBmb3IgSUQgJ1wiICsgdGFyZ2V0SWQgKyBcIic6IFwiICsgdmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUXVlcnlUYXJnZXRNZXRhZGF0YS5wcm90b3R5cGUudG9XZWJTdG9yYWdlSlNPTiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0U3RhdGUgPSB7XHJcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxyXG4gICAgICAgICAgICB1cGRhdGVUaW1lTXM6IERhdGUubm93KCkgLy8gTW9kaWZ5IHRoZSBleGlzdGluZyB2YWx1ZSB0byB0cmlnZ2VyIHVwZGF0ZS5cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICh0aGlzLmVycm9yKSB7XHJcbiAgICAgICAgICAgIHRhcmdldFN0YXRlLmVycm9yID0ge1xyXG4gICAgICAgICAgICAgICAgY29kZTogdGhpcy5lcnJvci5jb2RlLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5lcnJvci5tZXNzYWdlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0YXJnZXRTdGF0ZSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5VGFyZ2V0TWV0YWRhdGE7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBUaGlzIGNsYXNzIHJlcHJlc2VudHMgdGhlIGltbXV0YWJsZSBDbGllbnRTdGF0ZSBmb3IgYSBjbGllbnQgcmVhZCBmcm9tXHJcbiAqIFdlYlN0b3JhZ2UsIGNvbnRhaW5pbmcgdGhlIGxpc3Qgb2YgYWN0aXZlIHF1ZXJ5IHRhcmdldHMuXHJcbiAqL1xyXG52YXIgUmVtb3RlQ2xpZW50U3RhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZW1vdGVDbGllbnRTdGF0ZShjbGllbnRJZCwgYWN0aXZlVGFyZ2V0SWRzKSB7XHJcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlVGFyZ2V0SWRzID0gYWN0aXZlVGFyZ2V0SWRzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBSZW1vdGVDbGllbnRTdGF0ZSBmcm9tIHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXHJcbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVDbGllbnRTdGF0ZS5mcm9tV2ViU3RvcmFnZUVudHJ5ID0gZnVuY3Rpb24gKGNsaWVudElkLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBjbGllbnRTdGF0ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xyXG4gICAgICAgIHZhciB2YWxpZERhdGEgPSB0eXBlb2YgY2xpZW50U3RhdGUgPT09ICdvYmplY3QnICYmXHJcbiAgICAgICAgICAgIGNsaWVudFN0YXRlLmFjdGl2ZVRhcmdldElkcyBpbnN0YW5jZW9mIEFycmF5O1xyXG4gICAgICAgIHZhciBhY3RpdmVUYXJnZXRJZHNTZXQgPSB0YXJnZXRJZFNldCgpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyB2YWxpZERhdGEgJiYgaSA8IGNsaWVudFN0YXRlLmFjdGl2ZVRhcmdldElkcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2YWxpZERhdGEgPSBpc1NhZmVJbnRlZ2VyKGNsaWVudFN0YXRlLmFjdGl2ZVRhcmdldElkc1tpXSk7XHJcbiAgICAgICAgICAgIGFjdGl2ZVRhcmdldElkc1NldCA9IGFjdGl2ZVRhcmdldElkc1NldC5hZGQoY2xpZW50U3RhdGUuYWN0aXZlVGFyZ2V0SWRzW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZhbGlkRGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlbW90ZUNsaWVudFN0YXRlKGNsaWVudElkLCBhY3RpdmVUYXJnZXRJZHNTZXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZXJyb3IoTE9HX1RBRyQxMCwgXCJGYWlsZWQgdG8gcGFyc2UgY2xpZW50IGRhdGEgZm9yIGluc3RhbmNlICdcIiArIGNsaWVudElkICsgXCInOiBcIiArIHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBSZW1vdGVDbGllbnRTdGF0ZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIFRoaXMgY2xhc3MgcmVwcmVzZW50cyB0aGUgb25saW5lIHN0YXRlIGZvciBhbGwgY2xpZW50cyBwYXJ0aWNpcGF0aW5nIGluXHJcbiAqIG11bHRpLXRhYi4gVGhlIG9ubGluZSBzdGF0ZSBpcyBvbmx5IHdyaXR0ZW4gdG8gYnkgdGhlIHByaW1hcnkgY2xpZW50LCBhbmRcclxuICogdXNlZCBpbiBzZWNvbmRhcnkgY2xpZW50cyB0byB1cGRhdGUgdGhlaXIgcXVlcnkgdmlld3MuXHJcbiAqL1xyXG52YXIgU2hhcmVkT25saW5lU3RhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTaGFyZWRPbmxpbmVTdGF0ZShjbGllbnRJZCwgb25saW5lU3RhdGUpIHtcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZSA9IG9ubGluZVN0YXRlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBTaGFyZWRPbmxpbmVTdGF0ZSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXHJcbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxyXG4gICAgICovXHJcbiAgICBTaGFyZWRPbmxpbmVTdGF0ZS5mcm9tV2ViU3RvcmFnZUVudHJ5ID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIG9ubGluZVN0YXRlID0gSlNPTi5wYXJzZSh2YWx1ZSk7XHJcbiAgICAgICAgdmFyIHZhbGlkRGF0YSA9IHR5cGVvZiBvbmxpbmVTdGF0ZSA9PT0gJ29iamVjdCcgJiZcclxuICAgICAgICAgICAgT25saW5lU3RhdGVbb25saW5lU3RhdGUub25saW5lU3RhdGVdICE9PSB1bmRlZmluZWQgJiZcclxuICAgICAgICAgICAgdHlwZW9mIG9ubGluZVN0YXRlLmNsaWVudElkID09PSAnc3RyaW5nJztcclxuICAgICAgICBpZiAodmFsaWREYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgU2hhcmVkT25saW5lU3RhdGUob25saW5lU3RhdGUuY2xpZW50SWQsIE9ubGluZVN0YXRlW29ubGluZVN0YXRlLm9ubGluZVN0YXRlXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlcnJvcihMT0dfVEFHJDEwLCBcIkZhaWxlZCB0byBwYXJzZSBvbmxpbmUgc3RhdGU6IFwiICsgdmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNoYXJlZE9ubGluZVN0YXRlO1xyXG59KCkpO1xyXG4vKipcclxuICogTWV0YWRhdGEgc3RhdGUgb2YgdGhlIGxvY2FsIGNsaWVudC4gVW5saWtlIGBSZW1vdGVDbGllbnRTdGF0ZWAsIHRoaXMgY2xhc3MgaXNcclxuICogbXV0YWJsZSBhbmQga2VlcHMgdHJhY2sgb2YgYWxsIHBlbmRpbmcgbXV0YXRpb25zLCB3aGljaCBhbGxvd3MgdXMgdG9cclxuICogdXBkYXRlIHRoZSByYW5nZSBvZiBwZW5kaW5nIG11dGF0aW9uIGJhdGNoIElEcyBhcyBuZXcgbXV0YXRpb25zIGFyZSBhZGRlZCBvclxyXG4gKiByZW1vdmVkLlxyXG4gKlxyXG4gKiBUaGUgZGF0YSBpbiBgTG9jYWxDbGllbnRTdGF0ZWAgaXMgbm90IHJlYWQgZnJvbSBXZWJTdG9yYWdlIGFuZCBpbnN0ZWFkXHJcbiAqIHVwZGF0ZWQgdmlhIGl0cyBpbnN0YW5jZSBtZXRob2RzLiBUaGUgdXBkYXRlZCBzdGF0ZSBjYW4gYmUgc2VyaWFsaXplZCB2aWFcclxuICogYHRvV2ViU3RvcmFnZUpTT04oKWAuXHJcbiAqL1xyXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nLlxyXG52YXIgTG9jYWxDbGllbnRTdGF0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExvY2FsQ2xpZW50U3RhdGUoKSB7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSB0YXJnZXRJZFNldCgpO1xyXG4gICAgfVxyXG4gICAgTG9jYWxDbGllbnRTdGF0ZS5wcm90b3R5cGUuYWRkUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0YXJnZXRJZCksIFwiVGFyZ2V0IHdpdGggSUQgJ1wiICsgdGFyZ2V0SWQgKyBcIicgYWxyZWFkeSBhY3RpdmUuXCIpO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlVGFyZ2V0SWRzID0gdGhpcy5hY3RpdmVUYXJnZXRJZHMuYWRkKHRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICBMb2NhbENsaWVudFN0YXRlLnByb3RvdHlwZS5yZW1vdmVRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMuYWN0aXZlVGFyZ2V0SWRzID0gdGhpcy5hY3RpdmVUYXJnZXRJZHMuZGVsZXRlKHRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnRzIHRoaXMgZW50cnkgaW50byBhIEpTT04tZW5jb2RlZCBmb3JtYXQgd2UgY2FuIHVzZSBmb3IgV2ViU3RvcmFnZS5cclxuICAgICAqIERvZXMgbm90IGVuY29kZSBgY2xpZW50SWRgIGFzIGl0IGlzIHBhcnQgb2YgdGhlIGtleSBpbiBXZWJTdG9yYWdlLlxyXG4gICAgICovXHJcbiAgICBMb2NhbENsaWVudFN0YXRlLnByb3RvdHlwZS50b1dlYlN0b3JhZ2VKU09OID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICBhY3RpdmVUYXJnZXRJZHM6IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLnRvQXJyYXkoKSxcclxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpIC8vIE1vZGlmeSB0aGUgZXhpc3RpbmcgdmFsdWUgdG8gdHJpZ2dlciB1cGRhdGUuXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExvY2FsQ2xpZW50U3RhdGU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlYCB1c2VzIFdlYlN0b3JhZ2UgKHdpbmRvdy5sb2NhbFN0b3JhZ2UpIGFzIHRoZVxyXG4gKiBiYWNraW5nIHN0b3JlIGZvciB0aGUgU2hhcmVkQ2xpZW50U3RhdGUuIEl0IGtlZXBzIHRyYWNrIG9mIGFsbCBhY3RpdmVcclxuICogY2xpZW50cyBhbmQgc3VwcG9ydHMgbW9kaWZpY2F0aW9ucyBvZiB0aGUgbG9jYWwgY2xpZW50J3MgZGF0YS5cclxuICovXHJcbnZhciBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUocXVldWUsIHBsYXRmb3JtLCBwZXJzaXN0ZW5jZUtleSwgbG9jYWxDbGllbnRJZCwgaW5pdGlhbFVzZXIpIHtcclxuICAgICAgICB0aGlzLnF1ZXVlID0gcXVldWU7XHJcbiAgICAgICAgdGhpcy5wbGF0Zm9ybSA9IHBsYXRmb3JtO1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2VLZXkgPSBwZXJzaXN0ZW5jZUtleTtcclxuICAgICAgICB0aGlzLmxvY2FsQ2xpZW50SWQgPSBsb2NhbENsaWVudElkO1xyXG4gICAgICAgIHRoaXMuc3luY0VuZ2luZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuc2VxdWVuY2VOdW1iZXJIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmFjdGl2ZUNsaWVudHMgPSB7fTtcclxuICAgICAgICB0aGlzLnN0b3JhZ2VMaXN0ZW5lciA9IHRoaXMuaGFuZGxlV2ViU3RvcmFnZUV2ZW50LmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2FwdHVyZXMgV2ViU3RvcmFnZSBldmVudHMgdGhhdCBvY2N1ciBiZWZvcmUgYHN0YXJ0KClgIGlzIGNhbGxlZC4gVGhlc2VcclxuICAgICAgICAgKiBldmVudHMgYXJlIHJlcGxheWVkIG9uY2UgYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWAgaXMgc3RhcnRlZC5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmVhcmx5RXZlbnRzID0gW107XHJcbiAgICAgICAgaWYgKCFXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUuaXNBdmFpbGFibGUodGhpcy5wbGF0Zm9ybSkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5JTVBMRU1FTlRFRCwgJ0xvY2FsU3RvcmFnZSBpcyBub3QgYXZhaWxhYmxlIG9uIHRoaXMgcGxhdGZvcm0uJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEVzY2FwZSB0aGUgc3BlY2lhbCBjaGFyYWN0ZXJzIG1lbnRpb25lZCBoZXJlOlxyXG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvR3VpZGUvUmVndWxhcl9FeHByZXNzaW9uc1xyXG4gICAgICAgIHZhciBlc2NhcGVkUGVyc2lzdGVuY2VLZXkgPSBwZXJzaXN0ZW5jZUtleS5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpO1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZSA9IHRoaXMucGxhdGZvcm0ud2luZG93LmxvY2FsU3RvcmFnZTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gaW5pdGlhbFVzZXI7XHJcbiAgICAgICAgdGhpcy5sb2NhbENsaWVudFN0b3JhZ2VLZXkgPSB0aGlzLnRvV2ViU3RvcmFnZUNsaWVudFN0YXRlS2V5KHRoaXMubG9jYWxDbGllbnRJZCk7XHJcbiAgICAgICAgdGhpcy5zZXF1ZW5jZU51bWJlcktleSA9IFNFUVVFTkNFX05VTUJFUl9LRVlfUFJFRklYICsgXCJfXCIgKyBwZXJzaXN0ZW5jZUtleTtcclxuICAgICAgICB0aGlzLmFjdGl2ZUNsaWVudHNbdGhpcy5sb2NhbENsaWVudElkXSA9IG5ldyBMb2NhbENsaWVudFN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5jbGllbnRTdGF0ZUtleVJlID0gbmV3IFJlZ0V4cChcIl5cIiArIENMSUVOVF9TVEFURV9LRVlfUFJFRklYICsgXCJfXCIgKyBlc2NhcGVkUGVyc2lzdGVuY2VLZXkgKyBcIl8oW15fXSopJFwiKTtcclxuICAgICAgICB0aGlzLm11dGF0aW9uQmF0Y2hLZXlSZSA9IG5ldyBSZWdFeHAoXCJeXCIgKyBNVVRBVElPTl9CQVRDSF9LRVlfUFJFRklYICsgXCJfXCIgKyBlc2NhcGVkUGVyc2lzdGVuY2VLZXkgKyBcIl8oXFxcXGQrKSg/Ol8oLiopKT8kXCIpO1xyXG4gICAgICAgIHRoaXMucXVlcnlUYXJnZXRLZXlSZSA9IG5ldyBSZWdFeHAoXCJeXCIgKyBRVUVSWV9UQVJHRVRfS0VZX1BSRUZJWCArIFwiX1wiICsgZXNjYXBlZFBlcnNpc3RlbmNlS2V5ICsgXCJfKFxcXFxkKykkXCIpO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGVLZXkgPSBPTkxJTkVfU1RBVEVfS0VZX1BSRUZJWCArIFwiX1wiICsgcGVyc2lzdGVuY2VLZXk7XHJcbiAgICAgICAgLy8gUmF0aGVyIHRoYW4gYWRkaW5nIHRoZSBzdG9yYWdlIG9ic2VydmVyIGR1cmluZyBzdGFydCgpLCB3ZSBhZGQgdGhlXHJcbiAgICAgICAgLy8gc3RvcmFnZSBvYnNlcnZlciBkdXJpbmcgaW5pdGlhbGl6YXRpb24uIFRoaXMgZW5zdXJlcyB0aGF0IHdlIGNvbGxlY3RcclxuICAgICAgICAvLyBldmVudHMgYmVmb3JlIG90aGVyIGNvbXBvbmVudHMgcG9wdWxhdGUgdGhlaXIgaW5pdGlhbCBzdGF0ZSAoZHVyaW5nIHRoZWlyXHJcbiAgICAgICAgLy8gcmVzcGVjdGl2ZSBzdGFydCgpIGNhbGxzKS4gT3RoZXJ3aXNlLCB3ZSBtaWdodCBmb3IgZXhhbXBsZSBtaXNzIGFcclxuICAgICAgICAvLyBtdXRhdGlvbiB0aGF0IGlzIGFkZGVkIGFmdGVyIExvY2FsU3RvcmUncyBzdGFydCgpIHByb2Nlc3NlZCB0aGUgZXhpc3RpbmdcclxuICAgICAgICAvLyBtdXRhdGlvbnMgYnV0IGJlZm9yZSB3ZSBvYnNlcnZlIFdlYlN0b3JhZ2UgZXZlbnRzLlxyXG4gICAgICAgIHRoaXMucGxhdGZvcm0ud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3N0b3JhZ2UnLCB0aGlzLnN0b3JhZ2VMaXN0ZW5lcik7XHJcbiAgICB9XHJcbiAgICAvKiogUmV0dXJucyAndHJ1ZScgaWYgV2ViU3RvcmFnZSBpcyBhdmFpbGFibGUgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuICovXHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUuaXNBdmFpbGFibGUgPSBmdW5jdGlvbiAocGxhdGZvcm0pIHtcclxuICAgICAgICByZXR1cm4gISEocGxhdGZvcm0ud2luZG93ICYmIHBsYXRmb3JtLndpbmRvdy5sb2NhbFN0b3JhZ2UgIT0gbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGV4aXN0aW5nQ2xpZW50cywgX2ksIGV4aXN0aW5nQ2xpZW50c18xLCBjbGllbnRJZCwgc3RvcmFnZUl0ZW0sIGNsaWVudFN0YXRlLCBvbmxpbmVTdGF0ZUpTT04sIG9ubGluZVN0YXRlLCBfYSwgX2IsIGV2ZW50XzE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLnN0YXJ0ZWQsICdXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUgYWxyZWFkeSBzdGFydGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCh0aGlzLnN5bmNFbmdpbmUgIT09IG51bGwsICdzeW5jRW5naW5lIHByb3BlcnR5IG11c3QgYmUgc2V0IGJlZm9yZSBjYWxsaW5nIHN0YXJ0KCknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHRoaXMub25saW5lU3RhdGVIYW5kbGVyICE9PSBudWxsLCAnb25saW5lU3RhdGVIYW5kbGVyIHByb3BlcnR5IG11c3QgYmUgc2V0IGJlZm9yZSBjYWxsaW5nIHN0YXJ0KCknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zeW5jRW5naW5lLmdldEFjdGl2ZUNsaWVudHMoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ0NsaWVudHMgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2kgPSAwLCBleGlzdGluZ0NsaWVudHNfMSA9IGV4aXN0aW5nQ2xpZW50czsgX2kgPCBleGlzdGluZ0NsaWVudHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudElkID0gZXhpc3RpbmdDbGllbnRzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsaWVudElkID09PSB0aGlzLmxvY2FsQ2xpZW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VJdGVtID0gdGhpcy5nZXRJdGVtKHRoaXMudG9XZWJTdG9yYWdlQ2xpZW50U3RhdGVLZXkoY2xpZW50SWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdG9yYWdlSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudFN0YXRlID0gUmVtb3RlQ2xpZW50U3RhdGUuZnJvbVdlYlN0b3JhZ2VFbnRyeShjbGllbnRJZCwgc3RvcmFnZUl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbGllbnRTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUNsaWVudHNbY2xpZW50U3RhdGUuY2xpZW50SWRdID0gY2xpZW50U3RhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGVyc2lzdENsaWVudFN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ubGluZVN0YXRlSlNPTiA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHRoaXMub25saW5lU3RhdGVLZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob25saW5lU3RhdGVKU09OKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmxpbmVTdGF0ZSA9IHRoaXMuZnJvbVdlYlN0b3JhZ2VPbmxpbmVTdGF0ZShvbmxpbmVTdGF0ZUpTT04pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVPbmxpbmVTdGF0ZUV2ZW50KG9ubGluZVN0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9hID0gMCwgX2IgPSB0aGlzLmVhcmx5RXZlbnRzOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRfMSA9IF9iW19hXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlV2ViU3RvcmFnZUV2ZW50KGV2ZW50XzEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWFybHlFdmVudHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgYSB3aW5kb3cgdW5sb2FkIGhvb2sgdG8gcmVtb3ZlIHRoZSBjbGllbnQgbWV0YWRhdGEgZW50cnkgZnJvbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZWJTdG9yYWdlIGV2ZW4gaWYgYHNodXRkb3duKClgIHdhcyBub3QgY2FsbGVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXRmb3JtLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zaHV0ZG93bigpOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLndyaXRlU2VxdWVuY2VOdW1iZXIgPSBmdW5jdGlvbiAoc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICB0aGlzLnNldEl0ZW0odGhpcy5zZXF1ZW5jZU51bWJlcktleSwgSlNPTi5zdHJpbmdpZnkoc2VxdWVuY2VOdW1iZXIpKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYWN0aXZlVGFyZ2V0cyA9IHRhcmdldElkU2V0KCk7XHJcbiAgICAgICAgZm9yRWFjaCh0aGlzLmFjdGl2ZUNsaWVudHMsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGFjdGl2ZVRhcmdldHMgPSBhY3RpdmVUYXJnZXRzLnVuaW9uV2l0aCh2YWx1ZS5hY3RpdmVUYXJnZXRJZHMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBhY3RpdmVUYXJnZXRzO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaXNBY3RpdmVRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIC8vIFRoaXMgaXMgbm90IHVzaW5nIGBvYmouZm9yRWFjaGAgc2luY2UgYGZvckVhY2hgIGRvZXNuJ3Qgc3VwcG9ydCBlYXJseVxyXG4gICAgICAgIC8vIHJldHVybi5cclxuICAgICAgICBmb3IgKHZhciBjbGllbnRJZCBpbiB0aGlzLmFjdGl2ZUNsaWVudHMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlQ2xpZW50cy5oYXNPd25Qcm9wZXJ0eShjbGllbnRJZCkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZUNsaWVudHNbY2xpZW50SWRdLmFjdGl2ZVRhcmdldElkcy5oYXModGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuYWRkUGVuZGluZ011dGF0aW9uID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RNdXRhdGlvblN0YXRlKGJhdGNoSWQsICdwZW5kaW5nJyk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS51cGRhdGVNdXRhdGlvblN0YXRlID0gZnVuY3Rpb24gKGJhdGNoSWQsIHN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdE11dGF0aW9uU3RhdGUoYmF0Y2hJZCwgc3RhdGUsIGVycm9yJCQxKTtcclxuICAgICAgICAvLyBPbmNlIGEgZmluYWwgbXV0YXRpb24gcmVzdWx0IGlzIG9ic2VydmVkIGJ5IG90aGVyIGNsaWVudHMsIHRoZXkgbm8gbG9uZ2VyXHJcbiAgICAgICAgLy8gYWNjZXNzIHRoZSBtdXRhdGlvbidzIG1ldGFkYXRhIGVudHJ5LiBTaW5jZSBXZWJTdG9yYWdlIHJlcGxheXMgZXZlbnRzXHJcbiAgICAgICAgLy8gaW4gb3JkZXIsIGl0IGlzIHNhZmUgdG8gZGVsZXRlIHRoZSBlbnRyeSByaWdodCBhZnRlciB1cGRhdGluZyBpdC5cclxuICAgICAgICB0aGlzLnJlbW92ZU11dGF0aW9uU3RhdGUoYmF0Y2hJZCk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5hZGRMb2NhbFF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIHF1ZXJ5U3RhdGUgPSAnbm90LWN1cnJlbnQnO1xyXG4gICAgICAgIC8vIExvb2t1cCBhbiBleGlzdGluZyBxdWVyeSBzdGF0ZSBpZiB0aGUgdGFyZ2V0IElEIHdhcyBhbHJlYWR5IHJlZ2lzdGVyZWRcclxuICAgICAgICAvLyBieSBhbm90aGVyIHRhYlxyXG4gICAgICAgIGlmICh0aGlzLmlzQWN0aXZlUXVlcnlUYXJnZXQodGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgIHZhciBzdG9yYWdlSXRlbSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHRoaXMudG9XZWJTdG9yYWdlUXVlcnlUYXJnZXRNZXRhZGF0YUtleSh0YXJnZXRJZCkpO1xyXG4gICAgICAgICAgICBpZiAoc3RvcmFnZUl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBtZXRhZGF0YSA9IFF1ZXJ5VGFyZ2V0TWV0YWRhdGEuZnJvbVdlYlN0b3JhZ2VFbnRyeSh0YXJnZXRJZCwgc3RvcmFnZUl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlTdGF0ZSA9IG1ldGFkYXRhLnN0YXRlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubG9jYWxDbGllbnRTdGF0ZS5hZGRRdWVyeVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0Q2xpZW50U3RhdGUoKTtcclxuICAgICAgICByZXR1cm4gcXVlcnlTdGF0ZTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnJlbW92ZUxvY2FsUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLmxvY2FsQ2xpZW50U3RhdGUucmVtb3ZlUXVlcnlUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgIHRoaXMucGVyc2lzdENsaWVudFN0YXRlKCk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5pc0xvY2FsUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbENsaWVudFN0YXRlLmFjdGl2ZVRhcmdldElkcy5oYXModGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuY2xlYXJRdWVyeVN0YXRlID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVJdGVtKHRoaXMudG9XZWJTdG9yYWdlUXVlcnlUYXJnZXRNZXRhZGF0YUtleSh0YXJnZXRJZCkpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUudXBkYXRlUXVlcnlTdGF0ZSA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgc3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0UXVlcnlUYXJnZXRTdGF0ZSh0YXJnZXRJZCwgc3RhdGUsIGVycm9yJCQxKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmhhbmRsZVVzZXJDaGFuZ2UgPSBmdW5jdGlvbiAodXNlciwgcmVtb3ZlZEJhdGNoSWRzLCBhZGRlZEJhdGNoSWRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZW1vdmVkQmF0Y2hJZHMuZm9yRWFjaChmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgICAgICBfdGhpcy5yZW1vdmVNdXRhdGlvblN0YXRlKGJhdGNoSWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSB1c2VyO1xyXG4gICAgICAgIGFkZGVkQmF0Y2hJZHMuZm9yRWFjaChmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hZGRQZW5kaW5nTXV0YXRpb24oYmF0Y2hJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5zZXRPbmxpbmVTdGF0ZSA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdE9ubGluZVN0YXRlKG9ubGluZVN0YXRlKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnNodXRkb3duID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF0Zm9ybS53aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuc3RvcmFnZUxpc3RlbmVyKTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVJdGVtKHRoaXMubG9jYWxDbGllbnRTdG9yYWdlS2V5KTtcclxuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuZ2V0SXRlbSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMTAsICdSRUFEJywga2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuc2V0SXRlbSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxMCwgJ1NFVCcsIGtleSwgdmFsdWUpO1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKGtleSwgdmFsdWUpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUucmVtb3ZlSXRlbSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEwLCAnUkVNT1ZFJywga2V5KTtcclxuICAgICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaGFuZGxlV2ViU3RvcmFnZUV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoZXZlbnQuc3RvcmFnZUFyZWEgPT09IHRoaXMuc3RvcmFnZSkge1xyXG4gICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEwLCAnRVZFTlQnLCBldmVudC5rZXksIGV2ZW50Lm5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gdGhpcy5sb2NhbENsaWVudFN0b3JhZ2VLZXkpIHtcclxuICAgICAgICAgICAgICAgIGVycm9yKCdSZWNlaXZlZCBXZWJTdG9yYWdlIG5vdGlmaWNhdGlvbiBmb3IgbG9jYWwgY2hhbmdlLiBBbm90aGVyIGNsaWVudCBtaWdodCBoYXZlICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICdnYXJiYWdlLWNvbGxlY3RlZCBvdXIgc3RhdGUnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnF1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2xpZW50U3RhdGUsIGNsaWVudElkLCBtdXRhdGlvbk1ldGFkYXRhLCBxdWVyeVRhcmdldE1ldGFkYXRhLCBvbmxpbmVTdGF0ZSwgc2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVhcmx5RXZlbnRzLnB1c2goZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jbGllbnRTdGF0ZUtleVJlLnRlc3QoZXZlbnQua2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQubmV3VmFsdWUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50U3RhdGUgPSB0aGlzLmZyb21XZWJTdG9yYWdlQ2xpZW50U3RhdGUoZXZlbnQua2V5LCBldmVudC5uZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xpZW50U3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5oYW5kbGVDbGllbnRTdGF0ZUV2ZW50KGNsaWVudFN0YXRlLmNsaWVudElkLCBjbGllbnRTdGF0ZSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgPSB0aGlzLmZyb21XZWJTdG9yYWdlQ2xpZW50U3RhdGVLZXkoZXZlbnQua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmhhbmRsZUNsaWVudFN0YXRlRXZlbnQoY2xpZW50SWQsIG51bGwpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLm11dGF0aW9uQmF0Y2hLZXlSZS50ZXN0KGV2ZW50LmtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50Lm5ld1ZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbk1ldGFkYXRhID0gdGhpcy5mcm9tV2ViU3RvcmFnZU11dGF0aW9uTWV0YWRhdGEoZXZlbnQua2V5LCBldmVudC5uZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobXV0YXRpb25NZXRhZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmhhbmRsZU11dGF0aW9uQmF0Y2hFdmVudChtdXRhdGlvbk1ldGFkYXRhKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5xdWVyeVRhcmdldEtleVJlLnRlc3QoZXZlbnQua2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQubmV3VmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VGFyZ2V0TWV0YWRhdGEgPSB0aGlzLmZyb21XZWJTdG9yYWdlUXVlcnlUYXJnZXRNZXRhZGF0YShldmVudC5rZXksIGV2ZW50Lm5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWVyeVRhcmdldE1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuaGFuZGxlUXVlcnlUYXJnZXRFdmVudChxdWVyeVRhcmdldE1ldGFkYXRhKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnQua2V5ID09PSB0aGlzLm9ubGluZVN0YXRlS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5uZXdWYWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25saW5lU3RhdGUgPSB0aGlzLmZyb21XZWJTdG9yYWdlT25saW5lU3RhdGUoZXZlbnQubmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuaGFuZGxlT25saW5lU3RhdGVFdmVudChvbmxpbmVTdGF0ZSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gdGhpcy5zZXF1ZW5jZU51bWJlcktleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoISF0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlciwgJ01pc3Npbmcgc2VxdWVuY2VOdW1iZXJIYW5kbGVyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyID0gZnJvbVdlYlN0b3JhZ2VTZXF1ZW5jZU51bWJlcihldmVudC5uZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXF1ZW5jZU51bWJlciAhPT0gTGlzdGVuU2VxdWVuY2UuSU5WQUxJRCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIoc2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLCBcImxvY2FsQ2xpZW50U3RhdGVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY3RpdmVDbGllbnRzW3RoaXMubG9jYWxDbGllbnRJZF07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnBlcnNpc3RDbGllbnRTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNldEl0ZW0odGhpcy5sb2NhbENsaWVudFN0b3JhZ2VLZXksIHRoaXMubG9jYWxDbGllbnRTdGF0ZS50b1dlYlN0b3JhZ2VKU09OKCkpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUucGVyc2lzdE11dGF0aW9uU3RhdGUgPSBmdW5jdGlvbiAoYmF0Y2hJZCwgc3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uU3RhdGUgPSBuZXcgTXV0YXRpb25NZXRhZGF0YSh0aGlzLmN1cnJlbnRVc2VyLCBiYXRjaElkLCBzdGF0ZSwgZXJyb3IkJDEpO1xyXG4gICAgICAgIHZhciBtdXRhdGlvbktleSA9IHRoaXMudG9XZWJTdG9yYWdlTXV0YXRpb25CYXRjaEtleShiYXRjaElkKTtcclxuICAgICAgICB0aGlzLnNldEl0ZW0obXV0YXRpb25LZXksIG11dGF0aW9uU3RhdGUudG9XZWJTdG9yYWdlSlNPTigpKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnJlbW92ZU11dGF0aW9uU3RhdGUgPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBtdXRhdGlvbktleSA9IHRoaXMudG9XZWJTdG9yYWdlTXV0YXRpb25CYXRjaEtleShiYXRjaElkKTtcclxuICAgICAgICB0aGlzLnJlbW92ZUl0ZW0obXV0YXRpb25LZXkpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUucGVyc2lzdE9ubGluZVN0YXRlID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgdmFyIGVudHJ5ID0ge1xyXG4gICAgICAgICAgICBjbGllbnRJZDogdGhpcy5sb2NhbENsaWVudElkLFxyXG4gICAgICAgICAgICBvbmxpbmVTdGF0ZTogT25saW5lU3RhdGVbb25saW5lU3RhdGVdXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbSh0aGlzLm9ubGluZVN0YXRlS2V5LCBKU09OLnN0cmluZ2lmeShlbnRyeSkpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUucGVyc2lzdFF1ZXJ5VGFyZ2V0U3RhdGUgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIHN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHZhciB0YXJnZXRLZXkgPSB0aGlzLnRvV2ViU3RvcmFnZVF1ZXJ5VGFyZ2V0TWV0YWRhdGFLZXkodGFyZ2V0SWQpO1xyXG4gICAgICAgIHZhciB0YXJnZXRNZXRhZGF0YSA9IG5ldyBRdWVyeVRhcmdldE1ldGFkYXRhKHRhcmdldElkLCBzdGF0ZSwgZXJyb3IkJDEpO1xyXG4gICAgICAgIHRoaXMuc2V0SXRlbSh0YXJnZXRLZXksIHRhcmdldE1ldGFkYXRhLnRvV2ViU3RvcmFnZUpTT04oKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIGNsaWVudCBzdGF0ZSBpbiBXZWJTdG9yYWdlICovXHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnRvV2ViU3RvcmFnZUNsaWVudFN0YXRlS2V5ID0gZnVuY3Rpb24gKGNsaWVudElkKSB7XHJcbiAgICAgICAgYXNzZXJ0KGNsaWVudElkLmluZGV4T2YoJ18nKSA9PT0gLTEsIFwiQ2xpZW50IGtleSBjYW5ub3QgY29udGFpbiAnXycsIGJ1dCB3YXMgJ1wiICsgY2xpZW50SWQgKyBcIidcIik7XHJcbiAgICAgICAgcmV0dXJuIENMSUVOVF9TVEFURV9LRVlfUFJFRklYICsgXCJfXCIgKyB0aGlzLnBlcnNpc3RlbmNlS2V5ICsgXCJfXCIgKyBjbGllbnRJZDtcclxuICAgIH07XHJcbiAgICAvKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIGEgcXVlcnkgc3RhdGUgaW4gV2ViU3RvcmFnZSAqL1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS50b1dlYlN0b3JhZ2VRdWVyeVRhcmdldE1ldGFkYXRhS2V5ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgcmV0dXJuIFFVRVJZX1RBUkdFVF9LRVlfUFJFRklYICsgXCJfXCIgKyB0aGlzLnBlcnNpc3RlbmNlS2V5ICsgXCJfXCIgKyB0YXJnZXRJZDtcclxuICAgIH07XHJcbiAgICAvKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIGEgbXV0YXRpb24gYmF0Y2ggaW4gV2ViU3RvcmFnZSAqL1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS50b1dlYlN0b3JhZ2VNdXRhdGlvbkJhdGNoS2V5ID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25LZXkgPSBNVVRBVElPTl9CQVRDSF9LRVlfUFJFRklYICsgXCJfXCIgKyB0aGlzLnBlcnNpc3RlbmNlS2V5ICsgXCJfXCIgKyBiYXRjaElkO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyLmlzQXV0aGVudGljYXRlZCgpKSB7XHJcbiAgICAgICAgICAgIG11dGF0aW9uS2V5ICs9IFwiX1wiICsgdGhpcy5jdXJyZW50VXNlci51aWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtdXRhdGlvbktleTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIGNsaWVudCBzdGF0ZSBrZXkgaW4gV2ViU3RvcmFnZS4gUmV0dXJucyBudWxsIGlmIHRoZSBrZXkgZG9lcyBub3RcclxuICAgICAqIG1hdGNoIHRoZSBleHBlY3RlZCBrZXkgZm9ybWF0LlxyXG4gICAgICovXHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmZyb21XZWJTdG9yYWdlQ2xpZW50U3RhdGVLZXkgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIG1hdGNoID0gdGhpcy5jbGllbnRTdGF0ZUtleVJlLmV4ZWMoa2V5KTtcclxuICAgICAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6IG51bGw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBjbGllbnQgc3RhdGUgaW4gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlIGNvdWxkIG5vdFxyXG4gICAgICogYmUgcGFyc2VkLlxyXG4gICAgICovXHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmZyb21XZWJTdG9yYWdlQ2xpZW50U3RhdGUgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBjbGllbnRJZCA9IHRoaXMuZnJvbVdlYlN0b3JhZ2VDbGllbnRTdGF0ZUtleShrZXkpO1xyXG4gICAgICAgIGFzc2VydChjbGllbnRJZCAhPT0gbnVsbCwgXCJDYW5ub3QgcGFyc2UgY2xpZW50IHN0YXRlIGtleSAnXCIgKyBrZXkgKyBcIidcIik7XHJcbiAgICAgICAgcmV0dXJuIFJlbW90ZUNsaWVudFN0YXRlLmZyb21XZWJTdG9yYWdlRW50cnkoY2xpZW50SWQsIHZhbHVlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIG11dGF0aW9uIGJhdGNoIHN0YXRlIGluIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxyXG4gICAgICogY291bGQgbm90IGJlIHBhcnNlZC5cclxuICAgICAqL1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5mcm9tV2ViU3RvcmFnZU11dGF0aW9uTWV0YWRhdGEgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBtYXRjaCA9IHRoaXMubXV0YXRpb25CYXRjaEtleVJlLmV4ZWMoa2V5KTtcclxuICAgICAgICBhc3NlcnQobWF0Y2ggIT09IG51bGwsIFwiQ2Fubm90IHBhcnNlIG11dGF0aW9uIGJhdGNoIGtleSAnXCIgKyBrZXkgKyBcIidcIik7XHJcbiAgICAgICAgdmFyIGJhdGNoSWQgPSBOdW1iZXIobWF0Y2hbMV0pO1xyXG4gICAgICAgIHZhciB1c2VySWQgPSBtYXRjaFsyXSAhPT0gdW5kZWZpbmVkID8gbWF0Y2hbMl0gOiBudWxsO1xyXG4gICAgICAgIHJldHVybiBNdXRhdGlvbk1ldGFkYXRhLmZyb21XZWJTdG9yYWdlRW50cnkobmV3IFVzZXIodXNlcklkKSwgYmF0Y2hJZCwgdmFsdWUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGEgcXVlcnkgdGFyZ2V0IHN0YXRlIGZyb20gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlXHJcbiAgICAgKiBjb3VsZCBub3QgYmUgcGFyc2VkLlxyXG4gICAgICovXHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmZyb21XZWJTdG9yYWdlUXVlcnlUYXJnZXRNZXRhZGF0YSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIG1hdGNoID0gdGhpcy5xdWVyeVRhcmdldEtleVJlLmV4ZWMoa2V5KTtcclxuICAgICAgICBhc3NlcnQobWF0Y2ggIT09IG51bGwsIFwiQ2Fubm90IHBhcnNlIHF1ZXJ5IHRhcmdldCBrZXkgJ1wiICsga2V5ICsgXCInXCIpO1xyXG4gICAgICAgIHZhciB0YXJnZXRJZCA9IE51bWJlcihtYXRjaFsxXSk7XHJcbiAgICAgICAgcmV0dXJuIFF1ZXJ5VGFyZ2V0TWV0YWRhdGEuZnJvbVdlYlN0b3JhZ2VFbnRyeSh0YXJnZXRJZCwgdmFsdWUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGFuIG9ubGluZSBzdGF0ZSBmcm9tIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxyXG4gICAgICogY291bGQgbm90IGJlIHBhcnNlZC5cclxuICAgICAqL1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5mcm9tV2ViU3RvcmFnZU9ubGluZVN0YXRlID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIFNoYXJlZE9ubGluZVN0YXRlLmZyb21XZWJTdG9yYWdlRW50cnkodmFsdWUpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaGFuZGxlTXV0YXRpb25CYXRjaEV2ZW50ID0gZnVuY3Rpb24gKG11dGF0aW9uQmF0Y2gpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobXV0YXRpb25CYXRjaC51c2VyLnVpZCAhPT0gdGhpcy5jdXJyZW50VXNlci51aWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEwLCBcIklnbm9yaW5nIG11dGF0aW9uIGZvciBub24tYWN0aXZlIHVzZXIgXCIgKyBtdXRhdGlvbkJhdGNoLnVzZXIudWlkKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5zeW5jRW5naW5lLmFwcGx5QmF0Y2hTdGF0ZShtdXRhdGlvbkJhdGNoLmJhdGNoSWQsIG11dGF0aW9uQmF0Y2guc3RhdGUsIG11dGF0aW9uQmF0Y2guZXJyb3IpXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5oYW5kbGVRdWVyeVRhcmdldEV2ZW50ID0gZnVuY3Rpb24gKHRhcmdldE1ldGFkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5hcHBseVRhcmdldFN0YXRlKHRhcmdldE1ldGFkYXRhLnRhcmdldElkLCB0YXJnZXRNZXRhZGF0YS5zdGF0ZSwgdGFyZ2V0TWV0YWRhdGEuZXJyb3IpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaGFuZGxlQ2xpZW50U3RhdGVFdmVudCA9IGZ1bmN0aW9uIChjbGllbnRJZCwgY2xpZW50U3RhdGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBleGlzdGluZ1RhcmdldHMgPSB0aGlzLmdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cygpO1xyXG4gICAgICAgIGlmIChjbGllbnRTdGF0ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUNsaWVudHNbY2xpZW50SWRdID0gY2xpZW50U3RhdGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5hY3RpdmVDbGllbnRzW2NsaWVudElkXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG5ld1RhcmdldHMgPSB0aGlzLmdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cygpO1xyXG4gICAgICAgIHZhciBhZGRlZFRhcmdldHMgPSBbXTtcclxuICAgICAgICB2YXIgcmVtb3ZlZFRhcmdldHMgPSBbXTtcclxuICAgICAgICBuZXdUYXJnZXRzLmZvckVhY2goZnVuY3Rpb24gKHRhcmdldElkKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWV4aXN0aW5nVGFyZ2V0cy5oYXModGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRkZWRUYXJnZXRzLnB1c2godGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgZXhpc3RpbmdUYXJnZXRzLmZvckVhY2goZnVuY3Rpb24gKHRhcmdldElkKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW5ld1RhcmdldHMuaGFzKHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZWRUYXJnZXRzLnB1c2godGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5hcHBseUFjdGl2ZVRhcmdldHNDaGFuZ2UoYWRkZWRUYXJnZXRzLCByZW1vdmVkVGFyZ2V0cyk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5oYW5kbGVPbmxpbmVTdGF0ZUV2ZW50ID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgLy8gV2UgY2hlY2sgd2hldGhlciB0aGUgY2xpZW50IHRoYXQgd3JvdGUgdGhpcyBvbmxpbmUgc3RhdGUgaXMgc3RpbGwgYWN0aXZlXHJcbiAgICAgICAgLy8gYnkgY29tcGFyaW5nIGl0cyBjbGllbnQgSUQgdG8gdGhlIGxpc3Qgb2YgY2xpZW50cyBrZXB0IGFjdGl2ZSBpblxyXG4gICAgICAgIC8vIEluZGV4ZWREYi4gSWYgYSBjbGllbnQgZG9lcyBub3QgdXBkYXRlIHRoZWlyIEluZGV4ZWREYiBjbGllbnQgc3RhdGVcclxuICAgICAgICAvLyB3aXRoaW4gNSBzZWNvbmRzLCBpdCBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCB3ZSBkb24ndCBlbWl0IGFuIG9ubGluZVxyXG4gICAgICAgIC8vIHN0YXRlIGV2ZW50LlxyXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZUNsaWVudHNbb25saW5lU3RhdGUuY2xpZW50SWRdKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVIYW5kbGVyKG9ubGluZVN0YXRlLm9ubGluZVN0YXRlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZTtcclxufSgpKTtcclxuZnVuY3Rpb24gZnJvbVdlYlN0b3JhZ2VTZXF1ZW5jZU51bWJlcihzZXFTdHJpbmcpIHtcclxuICAgIHZhciBzZXF1ZW5jZU51bWJlciA9IExpc3RlblNlcXVlbmNlLklOVkFMSUQ7XHJcbiAgICBpZiAoc2VxU3RyaW5nICE9IG51bGwpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2YXIgcGFyc2VkID0gSlNPTi5wYXJzZShzZXFTdHJpbmcpO1xyXG4gICAgICAgICAgICBhc3NlcnQodHlwZW9mIHBhcnNlZCA9PT0gJ251bWJlcicsICdGb3VuZCBub24tbnVtZXJpYyBzZXF1ZW5jZSBudW1iZXInKTtcclxuICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXIgPSBwYXJzZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGVycm9yKExPR19UQUckMTAsICdGYWlsZWQgdG8gcmVhZCBzZXF1ZW5jZSBudW1iZXIgZnJvbSBXZWJTdG9yYWdlJywgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHNlcXVlbmNlTnVtYmVyO1xyXG59XHJcbi8qKlxyXG4gKiBgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGVgIGlzIGEgc2ltcGxlIGltcGxlbWVudGF0aW9uIG9mIFNoYXJlZENsaWVudFN0YXRlIGZvclxyXG4gKiBjbGllbnRzIHVzaW5nIG1lbW9yeSBwZXJzaXN0ZW5jZS4gVGhlIHN0YXRlIGluIHRoaXMgY2xhc3MgcmVtYWlucyBmdWxseVxyXG4gKiBpc29sYXRlZCBhbmQgbm8gc3luY2hyb25pemF0aW9uIGlzIHBlcmZvcm1lZC5cclxuICovXHJcbnZhciBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlKCkge1xyXG4gICAgICAgIHRoaXMubG9jYWxTdGF0ZSA9IG5ldyBMb2NhbENsaWVudFN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5xdWVyeVN0YXRlID0ge307XHJcbiAgICAgICAgdGhpcy5zeW5jRW5naW5lID0gbnVsbDtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlSGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmFkZFBlbmRpbmdNdXRhdGlvbiA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgLy8gTm8gb3AuXHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnVwZGF0ZU11dGF0aW9uU3RhdGUgPSBmdW5jdGlvbiAoYmF0Y2hJZCwgc3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgLy8gTm8gb3AuXHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmFkZExvY2FsUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLmxvY2FsU3RhdGUuYWRkUXVlcnlUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5U3RhdGVbdGFyZ2V0SWRdIHx8ICdub3QtY3VycmVudCc7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnVwZGF0ZVF1ZXJ5U3RhdGUgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIHN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHRoaXMucXVlcnlTdGF0ZVt0YXJnZXRJZF0gPSBzdGF0ZTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUucmVtb3ZlTG9jYWxRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMubG9jYWxTdGF0ZS5yZW1vdmVRdWVyeVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmlzTG9jYWxRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RhdGUuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0YXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmNsZWFyUXVlcnlTdGF0ZSA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLnF1ZXJ5U3RhdGVbdGFyZ2V0SWRdO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5nZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdGF0ZS5hY3RpdmVUYXJnZXRJZHM7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmlzQWN0aXZlUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0YXRlLmFjdGl2ZVRhcmdldElkcy5oYXModGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmxvY2FsU3RhdGUgPSBuZXcgTG9jYWxDbGllbnRTdGF0ZSgpO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaGFuZGxlVXNlckNoYW5nZSA9IGZ1bmN0aW9uICh1c2VyLCByZW1vdmVkQmF0Y2hJZHMsIGFkZGVkQmF0Y2hJZHMpIHtcclxuICAgICAgICAvLyBObyBvcC5cclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuc2V0T25saW5lU3RhdGUgPSBmdW5jdGlvbiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICAvLyBObyBvcC5cclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuc2h1dGRvd24gPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUud3JpdGVTZXF1ZW5jZU51bWJlciA9IGZ1bmN0aW9uIChzZXF1ZW5jZU51bWJlcikgeyB9O1xyXG4gICAgcmV0dXJuIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckMTEgPSAnRmlyZXN0b3JlQ2xpZW50JztcclxuLyoqIFRoZSBET01FeGNlcHRpb24gY29kZSBmb3IgYW4gYWJvcnRlZCBvcGVyYXRpb24uICovXHJcbnZhciBET01fRVhDRVBUSU9OX0FCT1JURUQgPSAyMDtcclxuLyoqIFRoZSBET01FeGNlcHRpb24gY29kZSBmb3IgcXVvdGEgZXhjZWVkZWQuICovXHJcbnZhciBET01fRVhDRVBUSU9OX1FVT1RBX0VYQ0VFREVEID0gMjI7XHJcbi8qKlxyXG4gKiBGaXJlc3RvcmVDbGllbnQgaXMgYSB0b3AtbGV2ZWwgY2xhc3MgdGhhdCBjb25zdHJ1Y3RzIGFuZCBvd25zIGFsbCBvZiB0aGVcclxuICogcGllY2VzIG9mIHRoZSBjbGllbnQgU0RLIGFyY2hpdGVjdHVyZS4gSXQgaXMgcmVzcG9uc2libGUgZm9yIGNyZWF0aW5nIHRoZVxyXG4gKiBhc3luYyBxdWV1ZSB0aGF0IGlzIHNoYXJlZCBieSBhbGwgb2YgdGhlIG90aGVyIGNvbXBvbmVudHMgaW4gdGhlIHN5c3RlbS5cclxuICovXHJcbnZhciBGaXJlc3RvcmVDbGllbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJlc3RvcmVDbGllbnQocGxhdGZvcm0sIGRhdGFiYXNlSW5mbywgY3JlZGVudGlhbHMsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBc3luY2hyb25vdXMgcXVldWUgcmVzcG9uc2libGUgZm9yIGFsbCBvZiBvdXIgaW50ZXJuYWwgcHJvY2Vzc2luZy4gV2hlblxyXG4gICAgICogd2UgZ2V0IGluY29taW5nIHdvcmsgZnJvbSB0aGUgdXNlciAodmlhIHB1YmxpYyBBUEkpIG9yIHRoZSBuZXR3b3JrXHJcbiAgICAgKiAoaW5jb21pbmcgR1JQQyBtZXNzYWdlcyksIHdlIHNob3VsZCBhbHdheXMgc2NoZWR1bGUgb250byB0aGlzIHF1ZXVlLlxyXG4gICAgICogVGhpcyBlbnN1cmVzIGFsbCBvZiBvdXIgd29yayBpcyBwcm9wZXJseSBzZXJpYWxpemVkIChlLmcuIHdlIGRvbid0XHJcbiAgICAgKiBzdGFydCBwcm9jZXNzaW5nIGEgbmV3IG9wZXJhdGlvbiB3aGlsZSB0aGUgcHJldmlvdXMgb25lIGlzIHdhaXRpbmcgZm9yXHJcbiAgICAgKiBhbiBhc3luYyBJL08gdG8gY29tcGxldGUpLlxyXG4gICAgICovXHJcbiAgICBhc3luY1F1ZXVlKSB7XHJcbiAgICAgICAgdGhpcy5wbGF0Zm9ybSA9IHBsYXRmb3JtO1xyXG4gICAgICAgIHRoaXMuZGF0YWJhc2VJbmZvID0gZGF0YWJhc2VJbmZvO1xyXG4gICAgICAgIHRoaXMuY3JlZGVudGlhbHMgPSBjcmVkZW50aWFscztcclxuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSBhc3luY1F1ZXVlO1xyXG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBBdXRvSWQubmV3SWQoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIHVwIHRoZSBGaXJlc3RvcmVDbGllbnQsIHJldHVybmluZyBvbmx5IHdoZXRoZXIgb3Igbm90IGVuYWJsaW5nXHJcbiAgICAgKiBwZXJzaXN0ZW5jZSBzdWNjZWVkZWQuXHJcbiAgICAgKlxyXG4gICAgICogVGhlIGludGVudCBoZXJlIGlzIHRvIFwiZG8gdGhlIHJpZ2h0IHRoaW5nXCIgYXMgZmFyIGFzIHVzZXJzIGFyZSBjb25jZXJuZWQuXHJcbiAgICAgKiBOYW1lbHksIGluIGNhc2VzIHdoZXJlIG9mZmxpbmUgcGVyc2lzdGVuY2UgaXMgcmVxdWVzdGVkIGFuZCBwb3NzaWJsZSxcclxuICAgICAqIGVuYWJsZSBpdCwgYnV0IG90aGVyd2lzZSBmYWxsIGJhY2sgdG8gcGVyc2lzdGVuY2UgZGlzYWJsZWQuIEZvciB0aGUgbW9zdFxyXG4gICAgICogcGFydCB3ZSBleHBlY3QgdGhpcyB0byBzdWNjZWVkIG9uZSB3YXkgb3IgdGhlIG90aGVyIHNvIHdlIGRvbid0IGV4cGVjdCBvdXJcclxuICAgICAqIHVzZXJzIHRvIGFjdHVhbGx5IHdhaXQgb24gdGhlIGZpcmVzdG9yZS5lbmFibGVQZXJzaXN0ZW5jZSBQcm9taXNlIHNpbmNlXHJcbiAgICAgKiB0aGV5IGdlbmVyYWxseSB3b24ndCBjYXJlLlxyXG4gICAgICpcclxuICAgICAqIE9mIGNvdXJzZSBzb21lIHVzZXJzIGFjdHVhbGx5IGRvIGNhcmUgYWJvdXQgd2hldGhlciBvciBub3QgcGVyc2lzdGVuY2VcclxuICAgICAqIHdhcyBzdWNjZXNzZnVsbHkgZW5hYmxlZCwgc28gdGhlIFByb21pc2UgcmV0dXJuZWQgZnJvbSB0aGlzIG1ldGhvZFxyXG4gICAgICogaW5kaWNhdGVzIHRoaXMgb3V0Y29tZS5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIHByZXNlbnRzIGEgcHJvYmxlbSB0aG91Z2g6IGV2ZW4gYmVmb3JlIGVuYWJsZVBlcnNpc3RlbmNlIHJlc29sdmVzIG9yXHJcbiAgICAgKiByZWplY3RzLCB1c2VycyBtYXkgaGF2ZSBtYWRlIGNhbGxzIHRvIGUuZy4gZmlyZXN0b3JlLmNvbGxlY3Rpb24oKSB3aGljaFxyXG4gICAgICogbWVhbnMgdGhhdCB0aGUgRmlyZXN0b3JlQ2xpZW50IGluIHRoZXJlIHdpbGwgYmUgYXZhaWxhYmxlIGFuZCB3aWxsIGJlXHJcbiAgICAgKiBlbnF1ZXVpbmcgYWN0aW9ucyBvbiB0aGUgYXN5bmMgcXVldWUuXHJcbiAgICAgKlxyXG4gICAgICogTWVhbndoaWxlIGFueSBmYWlsdXJlIG9mIGFuIG9wZXJhdGlvbiBvbiB0aGUgYXN5bmMgcXVldWUgY2F1c2VzIGl0IHRvXHJcbiAgICAgKiBwYW5pYyBhbmQgcmVqZWN0IGFueSBmdXJ0aGVyIHdvcmssIG9uIHRoZSBwcmVtaXNlIHRoYXQgdW5oYW5kbGVkIGVycm9yc1xyXG4gICAgICogYXJlIGZhdGFsLlxyXG4gICAgICpcclxuICAgICAqIENvbnNlcXVlbnRseSB0aGUgZmFsbGJhY2sgaXMgaGFuZGxlZCBpbnRlcm5hbGx5IGhlcmUgaW4gc3RhcnQsIGFuZCBpZiB0aGVcclxuICAgICAqIGZhbGxiYWNrIHN1Y2NlZWRzIHdlIHNpZ25hbCBzdWNjZXNzIHRvIHRoZSBhc3luYyBxdWV1ZSBldmVuIHRob3VnaCB0aGVcclxuICAgICAqIHN0YXJ0KCkgaXRzZWxmIHNpZ25hbHMgZmFpbHVyZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGVyc2lzdGVuY2VTZXR0aW5ncyBTZXR0aW5ncyBvYmplY3QgdG8gY29uZmlndXJlIG9mZmxpbmVcclxuICAgICAqICAgICBwZXJzaXN0ZW5jZS5cclxuICAgICAqIEByZXR1cm5zIEEgZGVmZXJyZWQgcmVzdWx0IGluZGljYXRpbmcgdGhlIHVzZXItdmlzaWJsZSByZXN1bHQgb2YgZW5hYmxpbmdcclxuICAgICAqICAgICBvZmZsaW5lIHBlcnNpc3RlbmNlLiBUaGlzIG1ldGhvZCB3aWxsIHJlamVjdCB0aGlzIGlmIEluZGV4ZWREQiBmYWlscyB0b1xyXG4gICAgICogICAgIHN0YXJ0IGZvciBhbnkgcmVhc29uLiBJZiB1c2VQZXJzaXN0ZW5jZSBpcyBmYWxzZSB0aGlzIGlzXHJcbiAgICAgKiAgICAgdW5jb25kaXRpb25hbGx5IHJlc29sdmVkLlxyXG4gICAgICovXHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKHBlcnNpc3RlbmNlU2V0dGluZ3MpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFdlIGRlZmVyIG91ciBpbml0aWFsaXphdGlvbiB1bnRpbCB3ZSBnZXQgdGhlIGN1cnJlbnQgdXNlciBmcm9tXHJcbiAgICAgICAgLy8gc2V0Q2hhbmdlTGlzdGVuZXIoKS4gV2UgYmxvY2sgdGhlIGFzeW5jIHF1ZXVlIHVudGlsIHdlIGdvdCB0aGUgaW5pdGlhbFxyXG4gICAgICAgIC8vIHVzZXIgYW5kIHRoZSBpbml0aWFsaXphdGlvbiBpcyBjb21wbGV0ZWQuIFRoaXMgd2lsbCBwcmV2ZW50IGFueSBzY2hlZHVsZWRcclxuICAgICAgICAvLyB3b3JrIGZyb20gaGFwcGVuaW5nIGJlZm9yZSBpbml0aWFsaXphdGlvbiBpcyBjb21wbGV0ZWQuXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBJZiBpbml0aWFsaXphdGlvbkRvbmUgcmVzb2x2ZWQgdGhlbiB0aGUgRmlyZXN0b3JlQ2xpZW50IGlzIGluIGEgdXNhYmxlXHJcbiAgICAgICAgLy8gc3RhdGUuXHJcbiAgICAgICAgdmFyIGluaXRpYWxpemF0aW9uRG9uZSA9IG5ldyBEZWZlcnJlZCQxKCk7XHJcbiAgICAgICAgLy8gSWYgdXNlUGVyc2lzdGVuY2UgaXMgdHJ1ZSwgY2VydGFpbiBjbGFzc2VzIG9mIGVycm9ycyB3aGlsZSBzdGFydGluZyBhcmVcclxuICAgICAgICAvLyByZWNvdmVyYWJsZSBidXQgb25seSBieSBmYWxsaW5nIGJhY2sgdG8gcGVyc2lzdGVuY2UgZGlzYWJsZWQuXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBJZiB0aGVyZSdzIGFuIGVycm9yIGluIHRoZSBmaXJzdCBjYXNlIGJ1dCBub3QgaW4gcmVjb3Zlcnkgd2UgY2Fubm90XHJcbiAgICAgICAgLy8gcmVqZWN0IHRoZSBwcm9taXNlIGJsb2NraW5nIHRoZSBhc3luYyBxdWV1ZSBiZWNhdXNlIHRoaXMgd2lsbCBjYXVzZSB0aGVcclxuICAgICAgICAvLyBhc3luYyBxdWV1ZSB0byBwYW5pYy5cclxuICAgICAgICB2YXIgcGVyc2lzdGVuY2VSZXN1bHQgPSBuZXcgRGVmZXJyZWQkMSgpO1xyXG4gICAgICAgIHZhciBpbml0aWFsaXplZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY3JlZGVudGlhbHMuc2V0Q2hhbmdlTGlzdGVuZXIoZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICAgICAgaWYgKCFpbml0aWFsaXplZCkge1xyXG4gICAgICAgICAgICAgICAgaW5pdGlhbGl6ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuaW5pdGlhbGl6ZVBlcnNpc3RlbmNlKHBlcnNpc3RlbmNlU2V0dGluZ3MsIHBlcnNpc3RlbmNlUmVzdWx0LCB1c2VyKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmluaXRpYWxpemVSZXN0KHVzZXIpOyB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGluaXRpYWxpemF0aW9uRG9uZS5yZXNvbHZlLCBpbml0aWFsaXphdGlvbkRvbmUucmVqZWN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UodXNlcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIEJsb2NrIHRoZSBhc3luYyBxdWV1ZSB1bnRpbCBpbml0aWFsaXphdGlvbiBpcyBkb25lXHJcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5pdGlhbGl6YXRpb25Eb25lLnByb21pc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gUmV0dXJuIG9ubHkgdGhlIHJlc3VsdCBvZiBlbmFibGluZyBwZXJzaXN0ZW5jZS4gTm90ZSB0aGF0IHRoaXMgZG9lcyBub3RcclxuICAgICAgICAvLyBuZWVkIHRvIGF3YWl0IHRoZSBjb21wbGV0aW9uIG9mIGluaXRpYWxpemF0aW9uRG9uZSBiZWNhdXNlIHRoZSByZXN1bHQgb2ZcclxuICAgICAgICAvLyB0aGlzIG1ldGhvZCBzaG91bGQgbm90IHJlZmxlY3QgYW55IG90aGVyIGtpbmQgb2YgZmFpbHVyZSB0byBzdGFydC5cclxuICAgICAgICByZXR1cm4gcGVyc2lzdGVuY2VSZXN1bHQucHJvbWlzZTtcclxuICAgIH07XHJcbiAgICAvKiogRW5hYmxlcyB0aGUgbmV0d29yayBjb25uZWN0aW9uIGFuZCByZXF1ZXVlcyBhbGwgcGVuZGluZyBvcGVyYXRpb25zLiAqL1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5lbmFibGVOZXR3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN5bmNFbmdpbmUuZW5hYmxlTmV0d29yaygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZXMgcGVyc2lzdGVudCBzdG9yYWdlLCBhdHRlbXB0aW5nIHRvIHVzZSBJbmRleGVkREIgaWZcclxuICAgICAqIHVzZVBlcnNpc3RlbmNlIGlzIHRydWUgb3IgbWVtb3J5LW9ubHkgaWYgZmFsc2UuXHJcbiAgICAgKlxyXG4gICAgICogSWYgSW5kZXhlZERCIGZhaWxzIGJlY2F1c2UgaXQncyBhbHJlYWR5IG9wZW4gaW4gYW5vdGhlciB0YWIgb3IgYmVjYXVzZSB0aGVcclxuICAgICAqIHBsYXRmb3JtIGNhbid0IHBvc3NpYmx5IHN1cHBvcnQgb3VyIGltcGxlbWVudGF0aW9uIHRoZW4gdGhpcyBtZXRob2QgcmVqZWN0c1xyXG4gICAgICogdGhlIHBlcnNpc3RlbmNlUmVzdWx0IGFuZCBmYWxscyBiYWNrIG9uIG1lbW9yeS1vbmx5IHBlcnNpc3RlbmNlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwZXJzaXN0ZW5jZVNldHRpbmdzIFNldHRpbmdzIG9iamVjdCB0byBjb25maWd1cmUgb2ZmbGluZSBwZXJzaXN0ZW5jZVxyXG4gICAgICogQHBhcmFtIHBlcnNpc3RlbmNlUmVzdWx0IEEgZGVmZXJyZWQgcmVzdWx0IGluZGljYXRpbmcgdGhlIHVzZXItdmlzaWJsZVxyXG4gICAgICogICAgIHJlc3VsdCBvZiBlbmFibGluZyBvZmZsaW5lIHBlcnNpc3RlbmNlLiBUaGlzIG1ldGhvZCB3aWxsIHJlamVjdCB0aGlzIGlmXHJcbiAgICAgKiAgICAgSW5kZXhlZERCIGZhaWxzIHRvIHN0YXJ0IGZvciBhbnkgcmVhc29uLiBJZiB1c2VQZXJzaXN0ZW5jZSBpcyBmYWxzZVxyXG4gICAgICogICAgIHRoaXMgaXMgdW5jb25kaXRpb25hbGx5IHJlc29sdmVkLlxyXG4gICAgICogQHJldHVybnMgYSBQcm9taXNlIGluZGljYXRpbmcgd2hldGhlciBvciBub3QgaW5pdGlhbGl6YXRpb24gc2hvdWxkXHJcbiAgICAgKiAgICAgY29udGludWUsIGkuZS4gdGhhdCBvbmUgb2YgdGhlIHBlcnNpc3RlbmNlIGltcGxlbWVudGF0aW9ucyBhY3R1YWxseVxyXG4gICAgICogICAgIHN1Y2NlZWRlZC5cclxuICAgICAqL1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5pbml0aWFsaXplUGVyc2lzdGVuY2UgPSBmdW5jdGlvbiAocGVyc2lzdGVuY2VTZXR0aW5ncywgcGVyc2lzdGVuY2VSZXN1bHQsIHVzZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChwZXJzaXN0ZW5jZVNldHRpbmdzLmVuYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnRJbmRleGVkRGJQZXJzaXN0ZW5jZSh1c2VyLCBwZXJzaXN0ZW5jZVNldHRpbmdzKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocGVyc2lzdGVuY2VSZXN1bHQucmVzb2x2ZSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlZ2FyZGxlc3Mgb2Ygd2hldGhlciBvciBub3QgdGhlIHJldHJ5IHN1Y2NlZWRzLCBmcm9tIGFuIHVzZXJcclxuICAgICAgICAgICAgICAgIC8vIHBlcnNwZWN0aXZlLCBvZmZsaW5lIHBlcnNpc3RlbmNlIGhhcyBmYWlsZWQuXHJcbiAgICAgICAgICAgICAgICBwZXJzaXN0ZW5jZVJlc3VsdC5yZWplY3QoZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgLy8gQW4gdW5rbm93biBmYWlsdXJlIG9uIHRoZSBmaXJzdCBzdGFnZSBzaHV0cyBldmVyeXRoaW5nIGRvd24uXHJcbiAgICAgICAgICAgICAgICBpZiAoIV90aGlzLmNhbkZhbGxiYWNrKGVycm9yJCQxKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0Vycm9yIGVuYWJsaW5nIG9mZmxpbmUgc3RvcmFnZS4gRmFsbGluZyBiYWNrIHRvJyArXHJcbiAgICAgICAgICAgICAgICAgICAgJyBzdG9yYWdlIGRpc2FibGVkOiAnICtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc3RhcnRNZW1vcnlQZXJzaXN0ZW5jZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFdoZW4gdXNlUGVyc2lzdGVuY2UgPT0gZmFsc2UsIGVuYWJsaW5nIG9mZmxpbmUgcGVyc2lzdGVuY2UgaXMgZGVmaW5lZFxyXG4gICAgICAgICAgICAvLyB0byB1bmNvbmRpdGlvbmFsbHkgc3VjY2VlZC4gVGhpcyBhbGxvd3Mgc3RhcnQoKSB0byBoYXZlIHRoZSBzYW1lXHJcbiAgICAgICAgICAgIC8vIHNpZ25hdHVyZSBmb3IgYm90aCBjYXNlcywgZGVzcGl0ZSB0aGUgZmFjdCB0aGF0IHRoZSByZXR1cm5lZCBwcm9taXNlXHJcbiAgICAgICAgICAgIC8vIGlzIG9ubHkgdXNlZCBpbiB0aGUgZW5hYmxlUGVyc2lzdGVuY2UgY2FsbC5cclxuICAgICAgICAgICAgcGVyc2lzdGVuY2VSZXN1bHQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdGFydE1lbW9yeVBlcnNpc3RlbmNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogRGVjaWRlcyB3aGV0aGVyIHRoZSBwcm92aWRlZCBlcnJvciBhbGxvd3MgdXMgdG8gZ3JhY2VmdWxseSBkaXNhYmxlXHJcbiAgICAgKiBwZXJzaXN0ZW5jZSAoYXMgb3Bwb3NlZCB0byBjcmFzaGluZyB0aGUgY2xpZW50KS5cclxuICAgICAqL1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5jYW5GYWxsYmFjayA9IGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgIGlmIChlcnJvciQkMSBpbnN0YW5jZW9mIEZpcmVzdG9yZUVycm9yKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZXJyb3IkJDEuY29kZSA9PT0gQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OIHx8XHJcbiAgICAgICAgICAgICAgICBlcnJvciQkMS5jb2RlID09PSBDb2RlLlVOSU1QTEVNRU5URUQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgRE9NRXhjZXB0aW9uICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgICAgICBlcnJvciQkMSBpbnN0YW5jZW9mIERPTUV4Y2VwdGlvbikge1xyXG4gICAgICAgICAgICAvLyBXZSBmYWxsIGJhY2sgdG8gbWVtb3J5IHBlcnNpc3RlbmNlIGlmIHdlIGNhbm5vdCB3cml0ZSB0aGUgcHJpbWFyeVxyXG4gICAgICAgICAgICAvLyBsZWFzZS4gVGhpcyBjYW4gaGFwcGVuIGNhbiBkdXJpbmcgYSBzY2hlbWEgbWlncmF0aW9uLCBvciBpZiB3ZSBydW4gb3V0XHJcbiAgICAgICAgICAgIC8vIG9mIHF1b3RhIHdoZW4gd2UgdHJ5IHRvIHdyaXRlIHRoZSBwcmltYXJ5IGxlYXNlLlxyXG4gICAgICAgICAgICAvLyBGb3IgYm90aCB0aGUgYFF1b3RhRXhjZWVkZWRFcnJvcmAgYW5kIHRoZSAgYEFib3J0RXJyb3JgLCBpdCBpcyBzYWZlIHRvXHJcbiAgICAgICAgICAgIC8vIGZhbGwgYmFjayB0byBtZW1vcnkgcGVyc2lzdGVuY2Ugc2luY2UgYWxsIG1vZGlmaWNhdGlvbnMgdG8gSW5kZXhlZERiXHJcbiAgICAgICAgICAgIC8vIGZhaWxlZCB0byBjb21taXQuXHJcbiAgICAgICAgICAgIHJldHVybiAoZXJyb3IkJDEuY29kZSA9PT0gRE9NX0VYQ0VQVElPTl9RVU9UQV9FWENFRURFRCB8fFxyXG4gICAgICAgICAgICAgICAgZXJyb3IkJDEuY29kZSA9PT0gRE9NX0VYQ0VQVElPTl9BQk9SVEVEKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTdGFydHMgSW5kZXhlZERCLWJhc2VkIHBlcnNpc3RlbmNlLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIEEgcHJvbWlzZSBpbmRpY2F0aW5nIHN1Y2Nlc3Mgb3IgZmFpbHVyZS5cclxuICAgICAqL1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5zdGFydEluZGV4ZWREYlBlcnNpc3RlbmNlID0gZnVuY3Rpb24gKHVzZXIsIHNldHRpbmdzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQoc2V0dGluZ3MuZW5hYmxlZCwgJ1Nob3VsZCBvbmx5IHN0YXJ0IEluZGV4ZWREYiBwZXJzaXRlbmNlIHdpdGggb2ZmbGluZSBwZXJzaXN0ZW5jZSBlbmFibGVkLicpO1xyXG4gICAgICAgIC8vIFRPRE8oaHR0cDovL2IvMzMzODQ1MjMpOiBGb3Igbm93IHdlIGp1c3QgZGlzYWJsZSBnYXJiYWdlIGNvbGxlY3Rpb25cclxuICAgICAgICAvLyB3aGVuIHBlcnNpc3RlbmNlIGlzIGVuYWJsZWQuXHJcbiAgICAgICAgdmFyIHN0b3JhZ2VQcmVmaXggPSBJbmRleGVkRGJQZXJzaXN0ZW5jZS5idWlsZFN0b3JhZ2VQcmVmaXgodGhpcy5kYXRhYmFzZUluZm8pO1xyXG4gICAgICAgIC8vIE9wdCB0byB1c2UgcHJvdG8zIEpTT04gaW4gY2FzZSB0aGUgcGxhdGZvcm0gZG9lc24ndCBzdXBwb3J0IFVpbnQ4QXJyYXkuXHJcbiAgICAgICAgdmFyIHNlcmlhbGl6ZXIgPSBuZXcgSnNvblByb3RvU2VyaWFsaXplcih0aGlzLmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkLCB7XHJcbiAgICAgICAgICAgIHVzZVByb3RvM0pzb246IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hLCBfYjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuZXhwZXJpbWVudGFsVGFiU3luY2hyb25pemF0aW9uICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLmlzQXZhaWxhYmxlKHRoaXMucGxhdGZvcm0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTklNUExFTUVOVEVELCAnSW5kZXhlZERCIHBlcnNpc3RlbmNlIGlzIG9ubHkgYXZhaWxhYmxlIG9uIHBsYXRmb3JtcyB0aGF0IHN1cHBvcnQgTG9jYWxTdG9yYWdlLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2V0dGluZ3MuZXhwZXJpbWVudGFsVGFiU3luY2hyb25pemF0aW9uKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IG5ldyBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUodGhpcy5hc3luY1F1ZXVlLCB0aGlzLnBsYXRmb3JtLCBzdG9yYWdlUHJlZml4LCB0aGlzLmNsaWVudElkLCB1c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBJbmRleGVkRGJQZXJzaXN0ZW5jZS5jcmVhdGVNdWx0aUNsaWVudEluZGV4ZWREYlBlcnNpc3RlbmNlKHN0b3JhZ2VQcmVmaXgsIHRoaXMuY2xpZW50SWQsIHRoaXMucGxhdGZvcm0sIHRoaXMuYXN5bmNRdWV1ZSwgc2VyaWFsaXplciwgeyBzZXF1ZW5jZU51bWJlclN5bmNlcjogdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSB9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5wZXJzaXN0ZW5jZSA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlID0gbmV3IE1lbW9yeVNoYXJlZENsaWVudFN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgSW5kZXhlZERiUGVyc2lzdGVuY2UuY3JlYXRlSW5kZXhlZERiUGVyc2lzdGVuY2Uoc3RvcmFnZVByZWZpeCwgdGhpcy5jbGllbnRJZCwgdGhpcy5wbGF0Zm9ybSwgdGhpcy5hc3luY1F1ZXVlLCBzZXJpYWxpemVyKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5wZXJzaXN0ZW5jZSA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTdGFydHMgTWVtb3J5LWJhY2tlZCBwZXJzaXN0ZW5jZS4gSW4gcHJhY3RpY2UgdGhpcyBjYW5ub3QgZmFpbC5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBBIHByb21pc2UgdGhhdCB3aWxsIHN1Y2Nlc3NmdWxseSByZXNvbHZlLlxyXG4gICAgICovXHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLnN0YXJ0TWVtb3J5UGVyc2lzdGVuY2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gT3B0IHRvIHVzZSBwcm90bzMgSlNPTiBpbiBjYXNlIHRoZSBwbGF0Zm9ybSBkb2Vzbid0IHN1cHBvcnQgVWludDhBcnJheS5cclxuICAgICAgICB2YXIgc2VyaWFsaXplciA9IG5ldyBKc29uUHJvdG9TZXJpYWxpemVyKHRoaXMuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQsIHtcclxuICAgICAgICAgICAgdXNlUHJvdG8zSnNvbjogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSBNZW1vcnlQZXJzaXN0ZW5jZS5jcmVhdGVFYWdlclBlcnNpc3RlbmNlKHRoaXMuY2xpZW50SWQsIHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSBuZXcgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUoKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWFsaXplcyB0aGUgcmVzdCBvZiB0aGUgRmlyZXN0b3JlQ2xpZW50LCBhc3N1bWluZyB0aGUgaW5pdGlhbCB1c2VyXHJcbiAgICAgKiBoYXMgYmVlbiBvYnRhaW5lZCBmcm9tIHRoZSBjcmVkZW50aWFsIHByb3ZpZGVyIGFuZCBzb21lIHBlcnNpc3RlbmNlXHJcbiAgICAgKiBpbXBsZW1lbnRhdGlvbiBpcyBhdmFpbGFibGUgaW4gdGhpcy5wZXJzaXN0ZW5jZS5cclxuICAgICAqL1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5pbml0aWFsaXplUmVzdCA9IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDExLCAnSW5pdGlhbGl6aW5nLiB1c2VyPScsIHVzZXIudWlkKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5wbGF0Zm9ybVxyXG4gICAgICAgICAgICAubG9hZENvbm5lY3Rpb24odGhpcy5kYXRhYmFzZUluZm8pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChjb25uZWN0aW9uKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHNlcmlhbGl6ZXIsIGRhdGFzdG9yZSwgcmVtb3RlU3RvcmVPbmxpbmVTdGF0ZUNoYW5nZWRIYW5kbGVyLCBzaGFyZWRDbGllbnRTdGF0ZU9ubGluZVN0YXRlQ2hhbmdlZEhhbmRsZXI7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhbFN0b3JlID0gbmV3IExvY2FsU3RvcmUodGhpcy5wZXJzaXN0ZW5jZSwgdXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZXIgPSB0aGlzLnBsYXRmb3JtLm5ld1NlcmlhbGl6ZXIodGhpcy5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzdG9yZSA9IG5ldyBEYXRhc3RvcmUodGhpcy5hc3luY1F1ZXVlLCBjb25uZWN0aW9uLCB0aGlzLmNyZWRlbnRpYWxzLCBzZXJpYWxpemVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU3RvcmVPbmxpbmVTdGF0ZUNoYW5nZWRIYW5kbGVyID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc3luY0VuZ2luZS5hcHBseU9ubGluZVN0YXRlQ2hhbmdlKG9ubGluZVN0YXRlLCBPbmxpbmVTdGF0ZVNvdXJjZS5SZW1vdGVTdG9yZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZENsaWVudFN0YXRlT25saW5lU3RhdGVDaGFuZ2VkSGFuZGxlciA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN5bmNFbmdpbmUuYXBwbHlPbmxpbmVTdGF0ZUNoYW5nZShvbmxpbmVTdGF0ZSwgT25saW5lU3RhdGVTb3VyY2UuU2hhcmVkQ2xpZW50U3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZVN0b3JlID0gbmV3IFJlbW90ZVN0b3JlKHRoaXMubG9jYWxTdG9yZSwgZGF0YXN0b3JlLCB0aGlzLmFzeW5jUXVldWUsIHJlbW90ZVN0b3JlT25saW5lU3RhdGVDaGFuZ2VkSGFuZGxlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3luY0VuZ2luZSA9IG5ldyBTeW5jRW5naW5lKHRoaXMubG9jYWxTdG9yZSwgdGhpcy5yZW1vdGVTdG9yZSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSwgdXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUub25saW5lU3RhdGVIYW5kbGVyID0gc2hhcmVkQ2xpZW50U3RhdGVPbmxpbmVTdGF0ZUNoYW5nZWRIYW5kbGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdXAgd2lyaW5nIGJldHdlZW4gc3luYyBlbmdpbmUgYW5kIG90aGVyIGNvbXBvbmVudHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVTdG9yZS5zeW5jRW5naW5lID0gdGhpcy5zeW5jRW5naW5lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlLnN5bmNFbmdpbmUgPSB0aGlzLnN5bmNFbmdpbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRNZ3IgPSBuZXcgRXZlbnRNYW5hZ2VyKHRoaXMuc3luY0VuZ2luZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBPUlRJTkcgTk9URTogTG9jYWxTdG9yZSBkb2Vzbid0IG5lZWQgYW4gZXhwbGljaXQgc3RhcnQoKSBvbiB0aGUgV2ViLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlLnN0YXJ0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUE9SVElORyBOT1RFOiBMb2NhbFN0b3JlIGRvZXNuJ3QgbmVlZCBhbiBleHBsaWNpdCBzdGFydCgpIG9uIHRoZSBXZWIuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZW1vdGVTdG9yZS5zdGFydCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTk9URTogVGhpcyB3aWxsIGltbWVkaWF0ZWx5IGNhbGwgdGhlIGxpc3RlbmVyLCBzbyB3ZSBtYWtlIHN1cmUgdG9cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGl0IGFmdGVyIGxvY2FsU3RvcmUgLyByZW1vdGVTdG9yZSBhcmUgc3RhcnRlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wZXJzaXN0ZW5jZS5zZXRQcmltYXJ5U3RhdGVMaXN0ZW5lcihmdW5jdGlvbiAoaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN5bmNFbmdpbmUuYXBwbHlQcmltYXJ5U3RhdGUoaXNQcmltYXJ5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlID0gZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICB0aGlzLmFzeW5jUXVldWUudmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpO1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMTEsICdDcmVkZW50aWFsIENoYW5nZWQuIEN1cnJlbnQgdXNlcjogJyArIHVzZXIudWlkKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zeW5jRW5naW5lLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UodXNlcik7XHJcbiAgICB9O1xyXG4gICAgLyoqIERpc2FibGVzIHRoZSBuZXR3b3JrIGNvbm5lY3Rpb24uIFBlbmRpbmcgb3BlcmF0aW9ucyB3aWxsIG5vdCBjb21wbGV0ZS4gKi9cclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuZGlzYWJsZU5ldHdvcmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5hc3luY1F1ZXVlLmVucXVldWUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc3luY0VuZ2luZS5kaXNhYmxlTmV0d29yaygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuc2h1dGRvd24gPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFBPUlRJTkcgTk9URTogTG9jYWxTdG9yZSBkb2VzIG5vdCBuZWVkIGFuIGV4cGxpY2l0IHNodXRkb3duIG9uIHdlYi5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlbW90ZVN0b3JlLnNodXRkb3duKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUE9SVElORyBOT1RFOiBMb2NhbFN0b3JlIGRvZXMgbm90IG5lZWQgYW4gZXhwbGljaXQgc2h1dGRvd24gb24gd2ViLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc2h1dGRvd24oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGVyc2lzdGVuY2Uuc2h1dGRvd24ob3B0aW9ucyAmJiBvcHRpb25zLnB1cmdlUGVyc2lzdGVuY2VXaXRoRGF0YUxvc3MpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYHJlbW92ZUNoYW5nZUxpc3RlbmVyYCBtdXN0IGJlIGNhbGxlZCBhZnRlciBzaHV0dGluZyBkb3duIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdGVTdG9yZSBhcyBpdCB3aWxsIHByZXZlbnQgdGhlIFJlbW90ZVN0b3JlIGZyb20gcmV0cmlldmluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhdXRoIHRva2Vucy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVkZW50aWFscy5yZW1vdmVDaGFuZ2VMaXN0ZW5lcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyB9KTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmxpc3RlbiA9IGZ1bmN0aW9uIChxdWVyeSwgb2JzZXJ2ZXIsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBsaXN0ZW5lciA9IG5ldyBRdWVyeUxpc3RlbmVyKHF1ZXJ5LCBvYnNlcnZlciwgb3B0aW9ucyk7XHJcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZXZlbnRNZ3IubGlzdGVuKGxpc3RlbmVyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbGlzdGVuZXI7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS51bmxpc3RlbiA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZXZlbnRNZ3IudW5saXN0ZW4obGlzdGVuZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuZ2V0RG9jdW1lbnRGcm9tTG9jYWxDYWNoZSA9IGZ1bmN0aW9uIChkb2NLZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWVcclxuICAgICAgICAgICAgLmVucXVldWUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxTdG9yZS5yZWFkRG9jdW1lbnQoZG9jS2V5KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICAgICAgaWYgKG1heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBtYXliZURvYztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChtYXliZURvYyBpbnN0YW5jZW9mIE5vRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5BVkFJTEFCTEUsICdGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gY2FjaGUuIChIb3dldmVyLCB0aGlzIGRvY3VtZW50IG1heSAnICtcclxuICAgICAgICAgICAgICAgICAgICBcImV4aXN0IG9uIHRoZSBzZXJ2ZXIuIFJ1biBhZ2FpbiB3aXRob3V0IHNldHRpbmcgJ3NvdXJjZScgaW4gXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICd0aGUgR2V0T3B0aW9ucyB0byBhdHRlbXB0IHRvIHJldHJpZXZlIHRoZSBkb2N1bWVudCBmcm9tIHRoZSAnICtcclxuICAgICAgICAgICAgICAgICAgICAnc2VydmVyLiknKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuZ2V0RG9jdW1lbnRzRnJvbUxvY2FsQ2FjaGUgPSBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWVcclxuICAgICAgICAgICAgLmVucXVldWUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxTdG9yZS5leGVjdXRlUXVlcnkocXVlcnkpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkb2NzKSB7XHJcbiAgICAgICAgICAgIHZhciByZW1vdGVLZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICAgICAgdmFyIHZpZXcgPSBuZXcgVmlldyhxdWVyeSwgcmVtb3RlS2V5cyk7XHJcbiAgICAgICAgICAgIHZhciB2aWV3RG9jQ2hhbmdlcyA9IHZpZXcuY29tcHV0ZURvY0NoYW5nZXMoZG9jcyk7XHJcbiAgICAgICAgICAgIHJldHVybiB2aWV3LmFwcGx5Q2hhbmdlcyh2aWV3RG9jQ2hhbmdlcywgXHJcbiAgICAgICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyBmYWxzZSkuc25hcHNob3Q7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCQxKCk7XHJcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc3luY0VuZ2luZS53cml0ZShtdXRhdGlvbnMsIGRlZmVycmVkKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmRhdGFiYXNlSWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQ7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS50cmFuc2FjdGlvbiA9IGZ1bmN0aW9uICh1cGRhdGVGdW5jdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gV2UgaGF2ZSB0byB3YWl0IGZvciB0aGUgYXN5bmMgcXVldWUgdG8gYmUgc3VyZSBzeW5jRW5naW5lIGlzIGluaXRpYWxpemVkLlxyXG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWVcclxuICAgICAgICAgICAgLmVucXVldWUoZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgfSk7IH0pOyB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zeW5jRW5naW5lLnJ1blRyYW5zYWN0aW9uKHVwZGF0ZUZ1bmN0aW9uKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpcmVzdG9yZUNsaWVudDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qXHJcbiAqIEEgd3JhcHBlciBpbXBsZW1lbnRhdGlvbiBvZiBPYnNlcnZlcjxUPiB0aGF0IHdpbGwgZGlzcGF0Y2ggZXZlbnRzXHJcbiAqIGFzeW5jaHJvbm91c2x5LiBUbyBhbGxvdyBpbW1lZGlhdGUgc2lsZW5jaW5nLCBhIG11dGUgY2FsbCBpcyBhZGRlZCB3aGljaFxyXG4gKiBjYXVzZXMgZXZlbnRzIHNjaGVkdWxlZCB0byBubyBsb25nZXIgYmUgcmFpc2VkLlxyXG4gKi9cclxudmFyIEFzeW5jT2JzZXJ2ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBc3luY09ic2VydmVyKG9ic2VydmVyKSB7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFdoZW4gc2V0IHRvIHRydWUsIHdpbGwgbm90IHJhaXNlIGZ1dHVyZSBldmVudHMuIE5lY2Vzc2FyeSB0byBkZWFsIHdpdGhcclxuICAgICAgICAgKiBhc3luYyBkZXRhY2htZW50IG9mIGxpc3RlbmVyLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubXV0ZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIEFzeW5jT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlRXZlbnQodGhpcy5vYnNlcnZlci5uZXh0LCB2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgQXN5bmNPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlRXZlbnQodGhpcy5vYnNlcnZlci5lcnJvciwgZXJyb3IpO1xyXG4gICAgfTtcclxuICAgIEFzeW5jT2JzZXJ2ZXIucHJvdG90eXBlLm11dGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5tdXRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG4gICAgQXN5bmNPYnNlcnZlci5wcm90b3R5cGUuc2NoZWR1bGVFdmVudCA9IGZ1bmN0aW9uIChldmVudEhhbmRsZXIsIGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoIXRoaXMubXV0ZWQpIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIV90aGlzLm11dGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRIYW5kbGVyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBBc3luY09ic2VydmVyO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gVGhlIG9iamVjdHMgdGhhdCBhcmUgYSBwYXJ0IG9mIHRoaXMgQVBJIGFyZSBleHBvc2VkIHRvIHRoaXJkLXBhcnRpZXMgYXNcclxuLy8gY29tcGlsZWQgamF2YXNjcmlwdCBzbyB3ZSB3YW50IHRvIGZsYWcgb3VyIHByaXZhdGUgbWVtYmVycyB3aXRoIGEgbGVhZGluZ1xyXG4vLyB1bmRlcnNjb3JlIHRvIGRpc2NvdXJhZ2UgdGhlaXIgdXNlLlxyXG4vLyB0c2xpbnQ6ZGlzYWJsZTpzdHJpcC1wcml2YXRlLXByb3BlcnR5LXVuZGVyc2NvcmVcclxuLyoqXHJcbiAqIEEgRmllbGRQYXRoIHJlZmVycyB0byBhIGZpZWxkIGluIGEgZG9jdW1lbnQuIFRoZSBwYXRoIG1heSBjb25zaXN0IG9mIGEgc2luZ2xlXHJcbiAqIGZpZWxkIG5hbWUgKHJlZmVycmluZyB0byBhIHRvcC1sZXZlbCBmaWVsZCBpbiB0aGUgZG9jdW1lbnQpLCBvciBhIGxpc3Qgb2ZcclxuICogZmllbGQgbmFtZXMgKHJlZmVycmluZyB0byBhIG5lc3RlZCBmaWVsZCBpbiB0aGUgZG9jdW1lbnQpLlxyXG4gKi9cclxudmFyIEZpZWxkUGF0aCQxID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgRmllbGRQYXRoIGZyb20gdGhlIHByb3ZpZGVkIGZpZWxkIG5hbWVzLiBJZiBtb3JlIHRoYW4gb25lIGZpZWxkXHJcbiAgICAgKiBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgcGF0aCB3aWxsIHBvaW50IHRvIGEgbmVzdGVkIGZpZWxkIGluIGEgZG9jdW1lbnQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGZpZWxkTmFtZXMgQSBsaXN0IG9mIGZpZWxkIG5hbWVzLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBGaWVsZFBhdGgkJDEoKSB7XHJcbiAgICAgICAgdmFyIGZpZWxkTmFtZXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBmaWVsZE5hbWVzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlTmFtZWRBcnJheUF0TGVhc3ROdW1iZXJPZkVsZW1lbnRzKCdGaWVsZFBhdGgnLCBmaWVsZE5hbWVzLCAnZmllbGROYW1lcycsIDEpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmllbGROYW1lcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0ZpZWxkUGF0aCcsICdzdHJpbmcnLCBpLCBmaWVsZE5hbWVzW2ldKTtcclxuICAgICAgICAgICAgaWYgKGZpZWxkTmFtZXNbaV0ubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgZmllbGQgbmFtZSBhdCBhcmd1bWVudCAkKGkgKyAxKS4gXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICdGaWVsZCBuYW1lcyBtdXN0IG5vdCBiZSBlbXB0eS4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9pbnRlcm5hbFBhdGggPSBuZXcgRmllbGRQYXRoKGZpZWxkTmFtZXMpO1xyXG4gICAgfVxyXG4gICAgRmllbGRQYXRoJCQxLmRvY3VtZW50SWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIEZpZWxkUGF0aCQkMS5fRE9DVU1FTlRfSUQ7XHJcbiAgICB9O1xyXG4gICAgRmllbGRQYXRoJCQxLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBGaWVsZFBhdGgkJDEpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludmFsaWRDbGFzc0Vycm9yKCdpc0VxdWFsJywgJ0ZpZWxkUGF0aCcsIDEsIG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludGVybmFsUGF0aC5pc0VxdWFsKG90aGVyLl9pbnRlcm5hbFBhdGgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW50ZXJuYWwgTm90ZTogVGhlIGJhY2tlbmQgZG9lc24ndCB0ZWNobmljYWxseSBzdXBwb3J0IHF1ZXJ5aW5nIGJ5XHJcbiAgICAgKiBkb2N1bWVudCBJRC4gSW5zdGVhZCBpdCBxdWVyaWVzIGJ5IHRoZSBlbnRpcmUgZG9jdW1lbnQgbmFtZSAoZnVsbCBwYXRoXHJcbiAgICAgKiBpbmNsdWRlZCksIGJ1dCBpbiB0aGUgY2FzZXMgd2UgY3VycmVudGx5IHN1cHBvcnQgZG9jdW1lbnRJZCgpLCB0aGUgbmV0XHJcbiAgICAgKiBlZmZlY3QgaXMgdGhlIHNhbWUuXHJcbiAgICAgKi9cclxuICAgIEZpZWxkUGF0aCQkMS5fRE9DVU1FTlRfSUQgPSBuZXcgRmllbGRQYXRoJCQxKEZpZWxkUGF0aC5rZXlGaWVsZCgpLmNhbm9uaWNhbFN0cmluZygpKTtcclxuICAgIHJldHVybiBGaWVsZFBhdGgkJDE7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBNYXRjaGVzIGFueSBjaGFyYWN0ZXJzIGluIGEgZmllbGQgcGF0aCBzdHJpbmcgdGhhdCBhcmUgcmVzZXJ2ZWQuXHJcbiAqL1xyXG52YXIgUkVTRVJWRUQgPSBuZXcgUmVnRXhwKCdbflxcXFwqL1xcXFxbXFxcXF1dJyk7XHJcbi8qKlxyXG4gKiBQYXJzZXMgYSBmaWVsZCBwYXRoIHN0cmluZyBpbnRvIGEgRmllbGRQYXRoLCB0cmVhdGluZyBkb3RzIGFzIHNlcGFyYXRvcnMuXHJcbiAqL1xyXG5mdW5jdGlvbiBmcm9tRG90U2VwYXJhdGVkU3RyaW5nKHBhdGgpIHtcclxuICAgIHZhciBmb3VuZCA9IHBhdGguc2VhcmNoKFJFU0VSVkVEKTtcclxuICAgIGlmIChmb3VuZCA+PSAwKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIGZpZWxkIHBhdGggKFwiICsgcGF0aCArIFwiKS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiBcIiArXHJcbiAgICAgICAgICAgIFwiJ34nLCAnKicsICcvJywgJ1snLCBvciAnXSdcIik7XHJcbiAgICB9XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiBuZXcgKEZpZWxkUGF0aCQxLmJpbmQuYXBwbHkoRmllbGRQYXRoJDEsIFt2b2lkIDBdLmNvbmNhdChwYXRoLnNwbGl0KCcuJykpKSkoKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIGZpZWxkIHBhdGggKFwiICsgcGF0aCArIFwiKS4gUGF0aHMgbXVzdCBub3QgYmUgZW1wdHksIFwiICtcclxuICAgICAgICAgICAgXCJiZWdpbiB3aXRoICcuJywgZW5kIHdpdGggJy4nLCBvciBjb250YWluICcuLidcIik7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBPQXV0aFRva2VuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gT0F1dGhUb2tlbih2YWx1ZSwgdXNlcikge1xyXG4gICAgICAgIHRoaXMudXNlciA9IHVzZXI7XHJcbiAgICAgICAgdGhpcy50eXBlID0gJ09BdXRoJztcclxuICAgICAgICB0aGlzLmF1dGhIZWFkZXJzID0geyBBdXRob3JpemF0aW9uOiBcIkJlYXJlciBcIiArIHZhbHVlIH07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gT0F1dGhUb2tlbjtcclxufSgpKTtcclxuLyoqIEEgQ3JlZGVudGlhbHNQcm92aWRlciB0aGF0IGFsd2F5cyB5aWVsZHMgYW4gZW1wdHkgdG9rZW4uICovXHJcbnZhciBFbXB0eUNyZWRlbnRpYWxzUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFbXB0eUNyZWRlbnRpYWxzUHJvdmlkZXIoKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogU3RvcmVzIHRoZSBsaXN0ZW5lciByZWdpc3RlcmVkIHdpdGggc2V0Q2hhbmdlTGlzdGVuZXIoKVxyXG4gICAgICAgICAqIFRoaXMgaXNuJ3QgYWN0dWFsbHkgbmVjZXNzYXJ5IHNpbmNlIHRoZSBVSUQgbmV2ZXIgY2hhbmdlcywgYnV0IHdlIHVzZSB0aGlzXHJcbiAgICAgICAgICogdG8gdmVyaWZ5IHRoZSBsaXN0ZW4gY29udHJhY3QgaXMgYWRoZXJlZCB0byBpbiB0ZXN0cy5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gbnVsbDtcclxuICAgIH1cclxuICAgIEVtcHR5Q3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTtcclxuICAgIH07XHJcbiAgICBFbXB0eUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLmludmFsaWRhdGVUb2tlbiA9IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgIEVtcHR5Q3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuc2V0Q2hhbmdlTGlzdGVuZXIgPSBmdW5jdGlvbiAoY2hhbmdlTGlzdGVuZXIpIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMuY2hhbmdlTGlzdGVuZXIsICdDYW4gb25seSBjYWxsIHNldENoYW5nZUxpc3RlbmVyKCkgb25jZS4nKTtcclxuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gY2hhbmdlTGlzdGVuZXI7XHJcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdXNlci5cclxuICAgICAgICBjaGFuZ2VMaXN0ZW5lcihVc2VyLlVOQVVUSEVOVElDQVRFRCk7XHJcbiAgICB9O1xyXG4gICAgRW1wdHlDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5yZW1vdmVDaGFuZ2VMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5jaGFuZ2VMaXN0ZW5lciAhPT0gbnVsbCwgJ3JlbW92ZUNoYW5nZUxpc3RlbmVyKCkgd2hlbiBubyBsaXN0ZW5lciByZWdpc3RlcmVkJyk7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VMaXN0ZW5lciA9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEVtcHR5Q3JlZGVudGlhbHNQcm92aWRlcjtcclxufSgpKTtcclxudmFyIEZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlcihhcHApIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBhdXRoIHRva2VuIGxpc3RlbmVyIHJlZ2lzdGVyZWQgd2l0aCBGaXJlYmFzZUFwcCwgcmV0YWluZWQgaGVyZSBzbyB3ZVxyXG4gICAgICAgICAqIGNhbiB1bnJlZ2lzdGVyIGl0LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMudG9rZW5MaXN0ZW5lciA9IG51bGw7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ291bnRlciB1c2VkIHRvIGRldGVjdCBpZiB0aGUgdG9rZW4gY2hhbmdlZCB3aGlsZSBhIGdldFRva2VuIHJlcXVlc3Qgd2FzXHJcbiAgICAgICAgICogb3V0c3RhbmRpbmcuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy50b2tlbkNvdW50ZXIgPSAwO1xyXG4gICAgICAgIC8qKiBUaGUgbGlzdGVuZXIgcmVnaXN0ZXJlZCB3aXRoIHNldENoYW5nZUxpc3RlbmVyKCkuICovXHJcbiAgICAgICAgdGhpcy5jaGFuZ2VMaXN0ZW5lciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5mb3JjZVJlZnJlc2ggPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnRva2VuTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnRva2VuQ291bnRlcisrO1xyXG4gICAgICAgICAgICBfdGhpcy5jdXJyZW50VXNlciA9IF90aGlzLmdldFVzZXIoKTtcclxuICAgICAgICAgICAgaWYgKF90aGlzLmNoYW5nZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jaGFuZ2VMaXN0ZW5lcihfdGhpcy5jdXJyZW50VXNlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMudG9rZW5Db3VudGVyID0gMDtcclxuICAgICAgICAvLyBXaWxsIGZpcmUgYXQgbGVhc3Qgb25jZSB3aGVyZSB3ZSBzZXQgdGhpcy5jdXJyZW50VXNlclxyXG4gICAgICAgIHRoaXMuYXBwLklOVEVSTkFMLmFkZEF1dGhUb2tlbkxpc3RlbmVyKHRoaXMudG9rZW5MaXN0ZW5lcik7XHJcbiAgICB9XHJcbiAgICBGaXJlYmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMudG9rZW5MaXN0ZW5lciAhPSBudWxsLCAnZ2V0VG9rZW4gY2Fubm90IGJlIGNhbGxlZCBhZnRlciBsaXN0ZW5lciByZW1vdmVkLicpO1xyXG4gICAgICAgIC8vIFRha2Ugbm90ZSBvZiB0aGUgY3VycmVudCB2YWx1ZSBvZiB0aGUgdG9rZW5Db3VudGVyIHNvIHRoYXQgdGhpcyBtZXRob2RcclxuICAgICAgICAvLyBjYW4gZmFpbCAod2l0aCBhbiBBQk9SVEVEIGVycm9yKSBpZiB0aGVyZSBpcyBhIHRva2VuIGNoYW5nZSB3aGlsZSB0aGVcclxuICAgICAgICAvLyByZXF1ZXN0IGlzIG91dHN0YW5kaW5nLlxyXG4gICAgICAgIHZhciBpbml0aWFsVG9rZW5Db3VudGVyID0gdGhpcy50b2tlbkNvdW50ZXI7XHJcbiAgICAgICAgdmFyIGZvcmNlUmVmcmVzaCA9IHRoaXMuZm9yY2VSZWZyZXNoO1xyXG4gICAgICAgIHRoaXMuZm9yY2VSZWZyZXNoID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwLklOVEVSTkFMLmdldFRva2VuKGZvcmNlUmVmcmVzaCkudGhlbihmdW5jdGlvbiAodG9rZW5EYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIENhbmNlbCB0aGUgcmVxdWVzdCBzaW5jZSB0aGUgdG9rZW4gY2hhbmdlZCB3aGlsZSB0aGUgcmVxdWVzdCB3YXNcclxuICAgICAgICAgICAgLy8gb3V0c3RhbmRpbmcgc28gdGhlIHJlc3BvbnNlIGlzIHBvdGVudGlhbGx5IGZvciBhIHByZXZpb3VzIHVzZXIgKHdoaWNoXHJcbiAgICAgICAgICAgIC8vIHVzZXIsIHdlIGNhbid0IGJlIHN1cmUpLlxyXG4gICAgICAgICAgICBpZiAoX3RoaXMudG9rZW5Db3VudGVyICE9PSBpbml0aWFsVG9rZW5Db3VudGVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5BQk9SVEVELCAnZ2V0VG9rZW4gYWJvcnRlZCBkdWUgdG8gdG9rZW4gY2hhbmdlLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRva2VuRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydCh0eXBlb2YgdG9rZW5EYXRhLmFjY2Vzc1Rva2VuID09PSAnc3RyaW5nJywgJ0ludmFsaWQgdG9rZW5EYXRhIHJldHVybmVkIGZyb20gZ2V0VG9rZW4oKTonICsgdG9rZW5EYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE9BdXRoVG9rZW4odG9rZW5EYXRhLmFjY2Vzc1Rva2VuLCBfdGhpcy5jdXJyZW50VXNlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuaW52YWxpZGF0ZVRva2VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuZm9yY2VSZWZyZXNoID0gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBGaXJlYmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLnNldENoYW5nZUxpc3RlbmVyID0gZnVuY3Rpb24gKGNoYW5nZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLmNoYW5nZUxpc3RlbmVyLCAnQ2FuIG9ubHkgY2FsbCBzZXRDaGFuZ2VMaXN0ZW5lcigpIG9uY2UuJyk7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VMaXN0ZW5lciA9IGNoYW5nZUxpc3RlbmVyO1xyXG4gICAgICAgIC8vIEZpcmUgdGhlIGluaXRpYWwgZXZlbnQsIGJ1dCBvbmx5IGlmIHdlIHJlY2VpdmVkIHRoZSBpbml0aWFsIHVzZXJcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50VXNlcikge1xyXG4gICAgICAgICAgICBjaGFuZ2VMaXN0ZW5lcih0aGlzLmN1cnJlbnRVc2VyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5yZW1vdmVDaGFuZ2VMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy50b2tlbkxpc3RlbmVyICE9IG51bGwsICdyZW1vdmVDaGFuZ2VMaXN0ZW5lcigpIGNhbGxlZCB0d2ljZScpO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmNoYW5nZUxpc3RlbmVyICE9PSBudWxsLCAncmVtb3ZlQ2hhbmdlTGlzdGVuZXIoKSBjYWxsZWQgd2hlbiBubyBsaXN0ZW5lciByZWdpc3RlcmVkJyk7XHJcbiAgICAgICAgdGhpcy5hcHAuSU5URVJOQUwucmVtb3ZlQXV0aFRva2VuTGlzdGVuZXIodGhpcy50b2tlbkxpc3RlbmVyKTtcclxuICAgICAgICB0aGlzLnRva2VuTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgfTtcclxuICAgIEZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY3VycmVudFVpZCA9IHRoaXMuYXBwLklOVEVSTkFMLmdldFVpZCgpO1xyXG4gICAgICAgIGFzc2VydChjdXJyZW50VWlkID09PSBudWxsIHx8IHR5cGVvZiBjdXJyZW50VWlkID09PSAnc3RyaW5nJywgJ1JlY2VpdmVkIGludmFsaWQgVUlEOiAnICsgY3VycmVudFVpZCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBVc2VyKGN1cnJlbnRVaWQpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBGaXJlYmFzZUNyZWRlbnRpYWxzUHJvdmlkZXI7XHJcbn0oKSk7XHJcbi8qXHJcbiAqIEZpcnN0UGFydHlUb2tlbiBwcm92aWRlcyBhIGZyZXNoIHRva2VuIGVhY2ggdGltZSBpdHMgdmFsdWVcclxuICogaXMgcmVxdWVzdGVkLCBiZWNhdXNlIGlmIHRoZSB0b2tlbiBpcyB0b28gb2xkLCByZXF1ZXN0cyB3aWxsIGJlIHJlamVjdGVkLlxyXG4gKiBUT0RPKGIvMzMxNDc4MTgpIHRoaXMgaW1wbGVtZW50YXRpb24gdmlvbGF0ZXMgdGhlIGN1cnJlbnQgYXNzdW1wdGlvbiB0aGF0XHJcbiAqIHRva2VucyBhcmUgaW1tdXRhYmxlLiAgV2UgbmVlZCB0byBlaXRoZXIgcmV2aXNpdCB0aGlzIGFzc3VtcHRpb24gb3IgY29tZVxyXG4gKiB1cCB3aXRoIHNvbWUgd2F5IGZvciBGUEEgdG8gdXNlIHRoZSBsaXN0ZW4vdW5saXN0ZW4gaW50ZXJmYWNlLlxyXG4gKi9cclxudmFyIEZpcnN0UGFydHlUb2tlbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpcnN0UGFydHlUb2tlbihnYXBpLCBzZXNzaW9uSW5kZXgpIHtcclxuICAgICAgICB0aGlzLmdhcGkgPSBnYXBpO1xyXG4gICAgICAgIHRoaXMuc2Vzc2lvbkluZGV4ID0gc2Vzc2lvbkluZGV4O1xyXG4gICAgICAgIHRoaXMudHlwZSA9ICdGaXJzdFBhcnR5JztcclxuICAgICAgICB0aGlzLnVzZXIgPSBVc2VyLkZJUlNUX1BBUlRZO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmdhcGkgJiZcclxuICAgICAgICAgICAgdGhpcy5nYXBpWydhdXRoJ10gJiZcclxuICAgICAgICAgICAgdGhpcy5nYXBpWydhdXRoJ11bJ2dldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHknXSwgJ3VuZXhwZWN0ZWQgZ2FwaSBpbnRlcmZhY2UnKTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaXJzdFBhcnR5VG9rZW4ucHJvdG90eXBlLCBcImF1dGhIZWFkZXJzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IHRoaXMuZ2FwaVsnYXV0aCddWydnZXRBdXRoSGVhZGVyVmFsdWVGb3JGaXJzdFBhcnR5J10oW10pLFxyXG4gICAgICAgICAgICAgICAgJ1gtR29vZy1BdXRoVXNlcic6IHRoaXMuc2Vzc2lvbkluZGV4XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gRmlyc3RQYXJ0eVRva2VuO1xyXG59KCkpO1xyXG4vKlxyXG4gKiBQcm92aWRlcyB1c2VyIGNyZWRlbnRpYWxzIHJlcXVpcmVkIGZvciB0aGUgRmlyZXN0b3JlIEphdmFTY3JpcHQgU0RLXHJcbiAqIHRvIGF1dGhlbnRpY2F0ZSB0aGUgdXNlciwgdXNpbmcgdGVjaG5pcXVlIHRoYXQgaXMgb25seSBhdmFpbGFibGVcclxuICogdG8gYXBwbGljYXRpb25zIGhvc3RlZCBieSBHb29nbGUuXHJcbiAqL1xyXG52YXIgRmlyc3RQYXJ0eUNyZWRlbnRpYWxzUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJzdFBhcnR5Q3JlZGVudGlhbHNQcm92aWRlcihnYXBpLCBzZXNzaW9uSW5kZXgpIHtcclxuICAgICAgICB0aGlzLmdhcGkgPSBnYXBpO1xyXG4gICAgICAgIHRoaXMuc2Vzc2lvbkluZGV4ID0gc2Vzc2lvbkluZGV4O1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmdhcGkgJiZcclxuICAgICAgICAgICAgdGhpcy5nYXBpWydhdXRoJ10gJiZcclxuICAgICAgICAgICAgdGhpcy5nYXBpWydhdXRoJ11bJ2dldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHknXSwgJ3VuZXhwZWN0ZWQgZ2FwaSBpbnRlcmZhY2UnKTtcclxuICAgIH1cclxuICAgIEZpcnN0UGFydHlDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBGaXJzdFBhcnR5VG9rZW4odGhpcy5nYXBpLCB0aGlzLnNlc3Npb25JbmRleCkpO1xyXG4gICAgfTtcclxuICAgIC8vIFRPRE8oMzMxMDg5MjUpOiBjYW4gc29tZW9uZSBzd2l0Y2ggdXNlcnMgdy9vIGEgcGFnZSByZWZyZXNoP1xyXG4gICAgLy8gVE9ETygzMzExMDYyMSk6IG5lZWQgdG8gdW5kZXJzdGFuZCB0b2tlbi9zZXNzaW9uIGxpZmVjeWNsZVxyXG4gICAgRmlyc3RQYXJ0eUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLnNldENoYW5nZUxpc3RlbmVyID0gZnVuY3Rpb24gKGNoYW5nZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdWlkLlxyXG4gICAgICAgIGNoYW5nZUxpc3RlbmVyKFVzZXIuRklSU1RfUEFSVFkpO1xyXG4gICAgfTtcclxuICAgIEZpcnN0UGFydHlDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5yZW1vdmVDaGFuZ2VMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgIEZpcnN0UGFydHlDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5pbnZhbGlkYXRlVG9rZW4gPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICByZXR1cm4gRmlyc3RQYXJ0eUNyZWRlbnRpYWxzUHJvdmlkZXI7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBCdWlsZHMgYSBDcmVkZW50aWFsc1Byb3ZpZGVyIGRlcGVuZGluZyBvbiB0aGUgdHlwZSBvZlxyXG4gKiB0aGUgY3JlZGVudGlhbHMgcGFzc2VkIGluLlxyXG4gKi9cclxuZnVuY3Rpb24gbWFrZUNyZWRlbnRpYWxzUHJvdmlkZXIoY3JlZGVudGlhbHMpIHtcclxuICAgIGlmICghY3JlZGVudGlhbHMpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEVtcHR5Q3JlZGVudGlhbHNQcm92aWRlcigpO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoIChjcmVkZW50aWFscy50eXBlKSB7XHJcbiAgICAgICAgY2FzZSAnZ2FwaSc6XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRmlyc3RQYXJ0eUNyZWRlbnRpYWxzUHJvdmlkZXIoY3JlZGVudGlhbHMuY2xpZW50LCBjcmVkZW50aWFscy5zZXNzaW9uSW5kZXggfHwgJzAnKTtcclxuICAgICAgICBjYXNlICdwcm92aWRlcic6XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVkZW50aWFscy5jbGllbnQ7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ21ha2VDcmVkZW50aWFsc1Byb3ZpZGVyIGZhaWxlZCBkdWUgdG8gaW52YWxpZCBjcmVkZW50aWFsIHR5cGUnKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNQYXJ0aWFsT2JzZXJ2ZXIob2JqKSB7XHJcbiAgICByZXR1cm4gaW1wbGVtZW50c0FueU1ldGhvZHMkMShvYmosIFsnbmV4dCcsICdlcnJvcicsICdjb21wbGV0ZSddKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyB0cnVlIGlmIG9iaiBpcyBhbiBvYmplY3QgYW5kIGNvbnRhaW5zIGF0IGxlYXN0IG9uZSBvZiB0aGUgc3BlY2lmaWVkXHJcbiAqIG1ldGhvZHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBpbXBsZW1lbnRzQW55TWV0aG9kcyQxKG9iaiwgbWV0aG9kcykge1xyXG4gICAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnIHx8IG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHZhciBvYmplY3QgPSBvYmo7XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIG1ldGhvZHNfMSA9IG1ldGhvZHM7IF9pIDwgbWV0aG9kc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBtZXRob2QgPSBtZXRob2RzXzFbX2ldO1xyXG4gICAgICAgIGlmIChtZXRob2QgaW4gb2JqZWN0ICYmIHR5cGVvZiBvYmplY3RbbWV0aG9kXSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBbiBvcGFxdWUgYmFzZSBjbGFzcyBmb3IgRmllbGRWYWx1ZSBzZW50aW5lbCBvYmplY3RzIGluIG91ciBwdWJsaWMgQVBJLFxyXG4gKiB3aXRoIHB1YmxpYyBzdGF0aWMgbWV0aG9kcyBmb3IgY3JlYXRpbmcgc2FpZCBzZW50aW5lbCBvYmplY3RzLlxyXG4gKi9cclxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNsYXNzLWFzLW5hbWVzcGFjZSAgV2UgdXNlIHRoaXMgYXMgYSBiYXNlIGNsYXNzLlxyXG52YXIgRmllbGRWYWx1ZUltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaWVsZFZhbHVlSW1wbChfbWV0aG9kTmFtZSkge1xyXG4gICAgICAgIHRoaXMuX21ldGhvZE5hbWUgPSBfbWV0aG9kTmFtZTtcclxuICAgIH1cclxuICAgIEZpZWxkVmFsdWVJbXBsLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gRGVsZXRlRmllbGRWYWx1ZUltcGwuaW5zdGFuY2U7XHJcbiAgICB9O1xyXG4gICAgRmllbGRWYWx1ZUltcGwuc2VydmVyVGltZXN0YW1wID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBTZXJ2ZXJUaW1lc3RhbXBGaWVsZFZhbHVlSW1wbC5pbnN0YW5jZTtcclxuICAgIH07XHJcbiAgICBGaWVsZFZhbHVlSW1wbC5hcnJheVVuaW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBlbGVtZW50cyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnRzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnRmllbGRWYWx1ZS5hcnJheVVuaW9uJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICAvLyBOT1RFOiBXZSBkb24ndCBhY3R1YWxseSBwYXJzZSB0aGUgZGF0YSB1bnRpbCBpdCdzIHVzZWQgaW4gc2V0KCkgb3JcclxuICAgICAgICAvLyB1cGRhdGUoKSBzaW5jZSB3ZSBuZWVkIGFjY2VzcyB0byB0aGUgRmlyZXN0b3JlIGluc3RhbmNlLlxyXG4gICAgICAgIHJldHVybiBuZXcgQXJyYXlVbmlvbkZpZWxkVmFsdWVJbXBsKGVsZW1lbnRzKTtcclxuICAgIH07XHJcbiAgICBGaWVsZFZhbHVlSW1wbC5hcnJheVJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZWxlbWVudHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBlbGVtZW50c1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ0ZpZWxkVmFsdWUuYXJyYXlSZW1vdmUnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIC8vIE5PVEU6IFdlIGRvbid0IGFjdHVhbGx5IHBhcnNlIHRoZSBkYXRhIHVudGlsIGl0J3MgdXNlZCBpbiBzZXQoKSBvclxyXG4gICAgICAgIC8vIHVwZGF0ZSgpIHNpbmNlIHdlIG5lZWQgYWNjZXNzIHRvIHRoZSBGaXJlc3RvcmUgaW5zdGFuY2UuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBBcnJheVJlbW92ZUZpZWxkVmFsdWVJbXBsKGVsZW1lbnRzKTtcclxuICAgIH07XHJcbiAgICBGaWVsZFZhbHVlSW1wbC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzID09PSBvdGhlcjtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRmllbGRWYWx1ZUltcGw7XHJcbn0oKSk7XHJcbnZhciBEZWxldGVGaWVsZFZhbHVlSW1wbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKERlbGV0ZUZpZWxkVmFsdWVJbXBsLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gRGVsZXRlRmllbGRWYWx1ZUltcGwoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsICdGaWVsZFZhbHVlLmRlbGV0ZScpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICAvKiogU2luZ2xldG9uIGluc3RhbmNlLiAqL1xyXG4gICAgRGVsZXRlRmllbGRWYWx1ZUltcGwuaW5zdGFuY2UgPSBuZXcgRGVsZXRlRmllbGRWYWx1ZUltcGwoKTtcclxuICAgIHJldHVybiBEZWxldGVGaWVsZFZhbHVlSW1wbDtcclxufShGaWVsZFZhbHVlSW1wbCkpO1xyXG52YXIgU2VydmVyVGltZXN0YW1wRmllbGRWYWx1ZUltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTZXJ2ZXJUaW1lc3RhbXBGaWVsZFZhbHVlSW1wbCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFNlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsKCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCAnRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAnKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqIFNpbmdsZXRvbiBpbnN0YW5jZS4gKi9cclxuICAgIFNlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsLmluc3RhbmNlID0gbmV3IFNlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsKCk7XHJcbiAgICByZXR1cm4gU2VydmVyVGltZXN0YW1wRmllbGRWYWx1ZUltcGw7XHJcbn0oRmllbGRWYWx1ZUltcGwpKTtcclxudmFyIEFycmF5VW5pb25GaWVsZFZhbHVlSW1wbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEFycmF5VW5pb25GaWVsZFZhbHVlSW1wbCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEFycmF5VW5pb25GaWVsZFZhbHVlSW1wbChfZWxlbWVudHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCAnRmllbGRWYWx1ZS5hcnJheVVuaW9uJykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5fZWxlbWVudHMgPSBfZWxlbWVudHM7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEFycmF5VW5pb25GaWVsZFZhbHVlSW1wbDtcclxufShGaWVsZFZhbHVlSW1wbCkpO1xyXG52YXIgQXJyYXlSZW1vdmVGaWVsZFZhbHVlSW1wbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEFycmF5UmVtb3ZlRmllbGRWYWx1ZUltcGwsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBBcnJheVJlbW92ZUZpZWxkVmFsdWVJbXBsKF9lbGVtZW50cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsICdGaWVsZFZhbHVlLmFycmF5UmVtb3ZlJykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5fZWxlbWVudHMgPSBfZWxlbWVudHM7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEFycmF5UmVtb3ZlRmllbGRWYWx1ZUltcGw7XHJcbn0oRmllbGRWYWx1ZUltcGwpKTtcclxuLy8gUHVibGljIGluc3RhbmNlIHRoYXQgZGlzYWxsb3dzIGNvbnN0cnVjdGlvbiBhdCBydW50aW1lLiBUaGlzIGNvbnN0cnVjdG9yIGlzXHJcbi8vIHVzZWQgd2hlbiBleHBvcnRpbmcgRmllbGRWYWx1ZUltcGwgb24gZmlyZWJhc2UuZmlyZXN0b3JlLkZpZWxkVmFsdWUgYW5kIHdpbGxcclxuLy8gYmUgY2FsbGVkIEZpZWxkVmFsdWUgcHVibGljbHkuIEludGVybmFsbHkgd2Ugc3RpbGwgdXNlIEZpZWxkVmFsdWVJbXBsIHdoaWNoXHJcbi8vIGhhcyBhIHR5cGUtY2hlY2tlZCBwcml2YXRlIGNvbnN0cnVjdG9yLiBOb3RlIHRoYXQgRmllbGRWYWx1ZUltcGwgYW5kXHJcbi8vIFB1YmxpY0ZpZWxkVmFsdWUgY2FuIGJlIHVzZWQgaW50ZXJjaGFuZ2VhYmx5IGluIGluc3RhbmNlb2YgY2hlY2tzLlxyXG4vLyBGb3Igb3VyIGludGVybmFsIFR5cGVTY3JpcHQgY29kZSBQdWJsaWNGaWVsZFZhbHVlIGRvZXNuJ3QgZXhpc3QgYXMgYSB0eXBlLFxyXG4vLyBhbmQgc28gd2UgbmVlZCB0byB1c2UgRmllbGRWYWx1ZUltcGwgYXMgdHlwZSBhbmQgZXhwb3J0IGl0IHRvby5cclxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnZhcmlhYmxlLW5hbWUgIFdlIHRyZWF0IHRoaXMgYXMgYSBjbGFzcyBuYW1lLlxyXG52YXIgUHVibGljRmllbGRWYWx1ZSA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoRmllbGRWYWx1ZUltcGwsICdVc2UgRmllbGRWYWx1ZS48ZmllbGQ+KCkgaW5zdGVhZC4nKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBSRVNFUlZFRF9GSUVMRF9SRUdFWCA9IC9eX18uKl9fJC87XHJcbi8qKiBUaGUgcmVzdWx0IG9mIHBhcnNpbmcgZG9jdW1lbnQgZGF0YSAoZS5nLiBmb3IgYSBzZXREYXRhIGNhbGwpLiAqL1xyXG52YXIgUGFyc2VkU2V0RGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFBhcnNlZFNldERhdGEoZGF0YSwgZmllbGRNYXNrLCBmaWVsZFRyYW5zZm9ybXMpIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuZmllbGRNYXNrID0gZmllbGRNYXNrO1xyXG4gICAgICAgIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gZmllbGRUcmFuc2Zvcm1zO1xyXG4gICAgfVxyXG4gICAgUGFyc2VkU2V0RGF0YS5wcm90b3R5cGUudG9NdXRhdGlvbnMgPSBmdW5jdGlvbiAoa2V5LCBwcmVjb25kaXRpb24pIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25zID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuZmllbGRNYXNrICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIG11dGF0aW9ucy5wdXNoKG5ldyBQYXRjaE11dGF0aW9uKGtleSwgdGhpcy5kYXRhLCB0aGlzLmZpZWxkTWFzaywgcHJlY29uZGl0aW9uKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBtdXRhdGlvbnMucHVzaChuZXcgU2V0TXV0YXRpb24oa2V5LCB0aGlzLmRhdGEsIHByZWNvbmRpdGlvbikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5maWVsZFRyYW5zZm9ybXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBtdXRhdGlvbnMucHVzaChuZXcgVHJhbnNmb3JtTXV0YXRpb24oa2V5LCB0aGlzLmZpZWxkVHJhbnNmb3JtcykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbXV0YXRpb25zO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQYXJzZWRTZXREYXRhO1xyXG59KCkpO1xyXG4vKiogVGhlIHJlc3VsdCBvZiBwYXJzaW5nIFwidXBkYXRlXCIgZGF0YSAoaS5lLiBmb3IgYW4gdXBkYXRlRGF0YSBjYWxsKS4gKi9cclxudmFyIFBhcnNlZFVwZGF0ZURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQYXJzZWRVcGRhdGVEYXRhKGRhdGEsIGZpZWxkTWFzaywgZmllbGRUcmFuc2Zvcm1zKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICB0aGlzLmZpZWxkTWFzayA9IGZpZWxkTWFzaztcclxuICAgICAgICB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IGZpZWxkVHJhbnNmb3JtcztcclxuICAgIH1cclxuICAgIFBhcnNlZFVwZGF0ZURhdGEucHJvdG90eXBlLnRvTXV0YXRpb25zID0gZnVuY3Rpb24gKGtleSwgcHJlY29uZGl0aW9uKSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9ucyA9IFtcclxuICAgICAgICAgICAgbmV3IFBhdGNoTXV0YXRpb24oa2V5LCB0aGlzLmRhdGEsIHRoaXMuZmllbGRNYXNrLCBwcmVjb25kaXRpb24pXHJcbiAgICAgICAgXTtcclxuICAgICAgICBpZiAodGhpcy5maWVsZFRyYW5zZm9ybXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBtdXRhdGlvbnMucHVzaChuZXcgVHJhbnNmb3JtTXV0YXRpb24oa2V5LCB0aGlzLmZpZWxkVHJhbnNmb3JtcykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbXV0YXRpb25zO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQYXJzZWRVcGRhdGVEYXRhO1xyXG59KCkpO1xyXG4vKlxyXG4gKiBSZXByZXNlbnRzIHdoYXQgdHlwZSBvZiBBUEkgbWV0aG9kIHByb3ZpZGVkIHRoZSBkYXRhIGJlaW5nIHBhcnNlZDsgdXNlZnVsXHJcbiAqIGZvciBkZXRlcm1pbmluZyB3aGljaCBlcnJvciBjb25kaXRpb25zIGFwcGx5IGR1cmluZyBwYXJzaW5nIGFuZCBwcm92aWRpbmdcclxuICogYmV0dGVyIGVycm9yIG1lc3NhZ2VzLlxyXG4gKi9cclxudmFyIFVzZXJEYXRhU291cmNlO1xyXG4oZnVuY3Rpb24gKFVzZXJEYXRhU291cmNlKSB7XHJcbiAgICBVc2VyRGF0YVNvdXJjZVtVc2VyRGF0YVNvdXJjZVtcIlNldFwiXSA9IDBdID0gXCJTZXRcIjtcclxuICAgIFVzZXJEYXRhU291cmNlW1VzZXJEYXRhU291cmNlW1wiVXBkYXRlXCJdID0gMV0gPSBcIlVwZGF0ZVwiO1xyXG4gICAgVXNlckRhdGFTb3VyY2VbVXNlckRhdGFTb3VyY2VbXCJNZXJnZVNldFwiXSA9IDJdID0gXCJNZXJnZVNldFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHNvdXJjZSBpcyBhIHdoZXJlIGNsYXVzZSwgY3Vyc29yIGJvdW5kLCBhcnJheVVuaW9uKClcclxuICAgICAqIGVsZW1lbnQsIGV0Yy4gT2Ygbm90ZSwgaXNXcml0ZShzb3VyY2UpIHdpbGwgcmV0dXJuIGZhbHNlLlxyXG4gICAgICovXHJcbiAgICBVc2VyRGF0YVNvdXJjZVtVc2VyRGF0YVNvdXJjZVtcIkFyZ3VtZW50XCJdID0gM10gPSBcIkFyZ3VtZW50XCI7XHJcbn0pKFVzZXJEYXRhU291cmNlIHx8IChVc2VyRGF0YVNvdXJjZSA9IHt9KSk7XHJcbmZ1bmN0aW9uIGlzV3JpdGUoZGF0YVNvdXJjZSkge1xyXG4gICAgc3dpdGNoIChkYXRhU291cmNlKSB7XHJcbiAgICAgICAgY2FzZSBVc2VyRGF0YVNvdXJjZS5TZXQ6IC8vIGZhbGwgdGhyb3VnaFxyXG4gICAgICAgIGNhc2UgVXNlckRhdGFTb3VyY2UuTWVyZ2VTZXQ6IC8vIGZhbGwgdGhyb3VnaFxyXG4gICAgICAgIGNhc2UgVXNlckRhdGFTb3VyY2UuVXBkYXRlOlxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBjYXNlIFVzZXJEYXRhU291cmNlLkFyZ3VtZW50OlxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgdGhyb3cgZmFpbChcIlVuZXhwZWN0ZWQgY2FzZSBmb3IgVXNlckRhdGFTb3VyY2U6IFwiICsgZGF0YVNvdXJjZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqIEEgXCJjb250ZXh0XCIgb2JqZWN0IHBhc3NlZCBhcm91bmQgd2hpbGUgcGFyc2luZyB1c2VyIGRhdGEuICovXHJcbnZhciBQYXJzZUNvbnRleHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYWxpemVzIGEgUGFyc2VDb250ZXh0IHdpdGggdGhlIGdpdmVuIHNvdXJjZSBhbmQgcGF0aC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZGF0YVNvdXJjZSBJbmRpY2F0ZXMgd2hhdCBraW5kIG9mIEFQSSBtZXRob2QgdGhpcyBkYXRhIGNhbWUgZnJvbS5cclxuICAgICAqIEBwYXJhbSBtZXRob2ROYW1lIFRoZSBuYW1lIG9mIHRoZSBtZXRob2QgdGhlIHVzZXIgY2FsbGVkIHRvIGNyZWF0ZSB0aGlzXHJcbiAgICAgKiAgICAgUGFyc2VDb250ZXh0LlxyXG4gICAgICogQHBhcmFtIHBhdGggQSBwYXRoIHdpdGhpbiB0aGUgb2JqZWN0IGJlaW5nIHBhcnNlZC4gVGhpcyBjb3VsZCBiZSBhbiBlbXB0eVxyXG4gICAgICogICAgIHBhdGggKGluIHdoaWNoIGNhc2UgdGhlIGNvbnRleHQgcmVwcmVzZW50cyB0aGUgcm9vdCBvZiB0aGUgZGF0YSBiZWluZ1xyXG4gICAgICogICAgIHBhcnNlZCksIG9yIGEgbm9uZW1wdHkgcGF0aCAoaW5kaWNhdGluZyB0aGUgY29udGV4dCByZXByZXNlbnRzIGEgbmVzdGVkXHJcbiAgICAgKiAgICAgbG9jYXRpb24gd2l0aGluIHRoZSBkYXRhKS5cclxuICAgICAqIEBwYXJhbSBhcnJheUVsZW1lbnQgV2hldGhlciBvciBub3QgdGhpcyBjb250ZXh0IGNvcnJlc3BvbmRzIHRvIGFuIGVsZW1lbnRcclxuICAgICAqICAgICBvZiBhbiBhcnJheS5cclxuICAgICAqIEBwYXJhbSBmaWVsZFRyYW5zZm9ybXMgQSBtdXRhYmxlIGxpc3Qgb2YgZmllbGQgdHJhbnNmb3JtcyBlbmNvdW50ZXJlZCB3aGlsZVxyXG4gICAgICogICAgIHBhcnNpbmcgdGhlIGRhdGEuXHJcbiAgICAgKiBAcGFyYW0gZmllbGRNYXNrIEEgbXV0YWJsZSBsaXN0IG9mIGZpZWxkIHBhdGhzIGVuY291bnRlcmVkIHdoaWxlIHBhcnNpbmdcclxuICAgICAqICAgICB0aGUgZGF0YS5cclxuICAgICAqXHJcbiAgICAgKiBUT0RPKGIvMzQ4NzExMzEpOiBXZSBkb24ndCBzdXBwb3J0IGFycmF5IHBhdGhzIHJpZ2h0IG5vdywgc28gcGF0aCBjYW4gYmVcclxuICAgICAqIG51bGwgdG8gaW5kaWNhdGUgdGhlIGNvbnRleHQgcmVwcmVzZW50cyBhbnkgbG9jYXRpb24gd2l0aGluIGFuIGFycmF5IChpblxyXG4gICAgICogd2hpY2ggY2FzZSBjZXJ0YWluIGZlYXR1cmVzIHdpbGwgbm90IHdvcmsgYW5kIGVycm9ycyB3aWxsIGJlIHNvbWV3aGF0XHJcbiAgICAgKiBjb21wcm9taXNlZCkuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIFBhcnNlQ29udGV4dChkYXRhU291cmNlLCBtZXRob2ROYW1lLCBwYXRoLCBhcnJheUVsZW1lbnQsIGZpZWxkVHJhbnNmb3JtcywgZmllbGRNYXNrKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcclxuICAgICAgICB0aGlzLm1ldGhvZE5hbWUgPSBtZXRob2ROYW1lO1xyXG4gICAgICAgIHRoaXMucGF0aCA9IHBhdGg7XHJcbiAgICAgICAgdGhpcy5hcnJheUVsZW1lbnQgPSBhcnJheUVsZW1lbnQ7XHJcbiAgICAgICAgLy8gTWlub3IgaGFjazogSWYgZmllbGRUcmFuc2Zvcm1zIGlzIHVuZGVmaW5lZCwgd2UgYXNzdW1lIHRoaXMgaXMgYW5cclxuICAgICAgICAvLyBleHRlcm5hbCBjYWxsIGFuZCB3ZSBuZWVkIHRvIHZhbGlkYXRlIHRoZSBlbnRpcmUgcGF0aC5cclxuICAgICAgICBpZiAoZmllbGRUcmFuc2Zvcm1zID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy52YWxpZGF0ZVBhdGgoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hcnJheUVsZW1lbnQgPSBhcnJheUVsZW1lbnQgIT09IHVuZGVmaW5lZCA/IGFycmF5RWxlbWVudCA6IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gZmllbGRUcmFuc2Zvcm1zIHx8IFtdO1xyXG4gICAgICAgIHRoaXMuZmllbGRNYXNrID0gZmllbGRNYXNrIHx8IFtdO1xyXG4gICAgfVxyXG4gICAgUGFyc2VDb250ZXh0LnByb3RvdHlwZS5jaGlsZENvbnRleHRGb3JGaWVsZCA9IGZ1bmN0aW9uIChmaWVsZCkge1xyXG4gICAgICAgIHZhciBjaGlsZFBhdGggPSB0aGlzLnBhdGggPT0gbnVsbCA/IG51bGwgOiB0aGlzLnBhdGguY2hpbGQoZmllbGQpO1xyXG4gICAgICAgIHZhciBjb250ZXh0ID0gbmV3IFBhcnNlQ29udGV4dCh0aGlzLmRhdGFTb3VyY2UsIHRoaXMubWV0aG9kTmFtZSwgY2hpbGRQYXRoLCBcclxuICAgICAgICAvKmFycmF5RWxlbWVudD0qLyBmYWxzZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMsIHRoaXMuZmllbGRNYXNrKTtcclxuICAgICAgICBjb250ZXh0LnZhbGlkYXRlUGF0aFNlZ21lbnQoZmllbGQpO1xyXG4gICAgICAgIHJldHVybiBjb250ZXh0O1xyXG4gICAgfTtcclxuICAgIFBhcnNlQ29udGV4dC5wcm90b3R5cGUuY2hpbGRDb250ZXh0Rm9yRmllbGRQYXRoID0gZnVuY3Rpb24gKGZpZWxkKSB7XHJcbiAgICAgICAgdmFyIGNoaWxkUGF0aCA9IHRoaXMucGF0aCA9PSBudWxsID8gbnVsbCA6IHRoaXMucGF0aC5jaGlsZChmaWVsZCk7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgUGFyc2VDb250ZXh0KHRoaXMuZGF0YVNvdXJjZSwgdGhpcy5tZXRob2ROYW1lLCBjaGlsZFBhdGgsIFxyXG4gICAgICAgIC8qYXJyYXlFbGVtZW50PSovIGZhbHNlLCB0aGlzLmZpZWxkVHJhbnNmb3JtcywgdGhpcy5maWVsZE1hc2spO1xyXG4gICAgICAgIGNvbnRleHQudmFsaWRhdGVQYXRoKCk7XHJcbiAgICAgICAgcmV0dXJuIGNvbnRleHQ7XHJcbiAgICB9O1xyXG4gICAgUGFyc2VDb250ZXh0LnByb3RvdHlwZS5jaGlsZENvbnRleHRGb3JBcnJheSA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgIC8vIFRPRE8oYi8zNDg3MTEzMSk6IFdlIGRvbid0IHN1cHBvcnQgYXJyYXkgcGF0aHMgcmlnaHQgbm93OyBzbyBtYWtlIHBhdGhcclxuICAgICAgICAvLyBudWxsLlxyXG4gICAgICAgIHJldHVybiBuZXcgUGFyc2VDb250ZXh0KHRoaXMuZGF0YVNvdXJjZSwgdGhpcy5tZXRob2ROYW1lLCBcclxuICAgICAgICAvKnBhdGg9Ki8gbnVsbCwgXHJcbiAgICAgICAgLyphcnJheUVsZW1lbnQ9Ki8gdHJ1ZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMsIHRoaXMuZmllbGRNYXNrKTtcclxuICAgIH07XHJcbiAgICBQYXJzZUNvbnRleHQucHJvdG90eXBlLmNyZWF0ZUVycm9yID0gZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgIHZhciBmaWVsZERlc2NyaXB0aW9uID0gdGhpcy5wYXRoID09PSBudWxsIHx8IHRoaXMucGF0aC5pc0VtcHR5KClcclxuICAgICAgICAgICAgPyAnJ1xyXG4gICAgICAgICAgICA6IFwiIChmb3VuZCBpbiBmaWVsZCBcIiArIHRoaXMucGF0aC50b1N0cmluZygpICsgXCIpXCI7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyB0aGlzLm1ldGhvZE5hbWUgKyBcIigpIGNhbGxlZCB3aXRoIGludmFsaWQgZGF0YS4gXCIgK1xyXG4gICAgICAgICAgICByZWFzb24gK1xyXG4gICAgICAgICAgICBmaWVsZERlc2NyaXB0aW9uKTtcclxuICAgIH07XHJcbiAgICAvKiogUmV0dXJucyAndHJ1ZScgaWYgJ2ZpZWxkUGF0aCcgd2FzIHRyYXZlcnNlZCB3aGVuIGNyZWF0aW5nIHRoaXMgY29udGV4dC4gKi9cclxuICAgIFBhcnNlQ29udGV4dC5wcm90b3R5cGUuY29udGFpbnMgPSBmdW5jdGlvbiAoZmllbGRQYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmZpZWxkTWFzay5maW5kKGZ1bmN0aW9uIChmaWVsZCkgeyByZXR1cm4gZmllbGRQYXRoLmlzUHJlZml4T2YoZmllbGQpOyB9KSAhPT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgICAgICAgIHRoaXMuZmllbGRUcmFuc2Zvcm1zLmZpbmQoZnVuY3Rpb24gKHRyYW5zZm9ybSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkUGF0aC5pc1ByZWZpeE9mKHRyYW5zZm9ybS5maWVsZCk7XHJcbiAgICAgICAgICAgIH0pICE9PSB1bmRlZmluZWQpO1xyXG4gICAgfTtcclxuICAgIFBhcnNlQ29udGV4dC5wcm90b3R5cGUudmFsaWRhdGVQYXRoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIFRPRE8oYi8zNDg3MTEzMSk6IFJlbW92ZSBudWxsIGNoZWNrIG9uY2Ugd2UgaGF2ZSBwcm9wZXIgcGF0aHMgZm9yIGZpZWxkc1xyXG4gICAgICAgIC8vIHdpdGhpbiBhcnJheXMuXHJcbiAgICAgICAgaWYgKHRoaXMucGF0aCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wYXRoLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsaWRhdGVQYXRoU2VnbWVudCh0aGlzLnBhdGguZ2V0KGkpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUGFyc2VDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZVBhdGhTZWdtZW50ID0gZnVuY3Rpb24gKHNlZ21lbnQpIHtcclxuICAgICAgICBpZiAoaXNXcml0ZSh0aGlzLmRhdGFTb3VyY2UpICYmIFJFU0VSVkVEX0ZJRUxEX1JFR0VYLnRlc3Qoc2VnbWVudCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgdGhpcy5jcmVhdGVFcnJvcignRG9jdW1lbnQgZmllbGRzIGNhbm5vdCBiZWdpbiBhbmQgZW5kIHdpdGggX18nKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBhcnNlQ29udGV4dDtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgcGxhY2Vob2xkZXIgb2JqZWN0IGZvciBEb2N1bWVudFJlZmVyZW5jZXMgaW4gdGhpcyBmaWxlLCBpbiBvcmRlciB0b1xyXG4gKiBhdm9pZCBhIGNpcmN1bGFyIGRlcGVuZGVuY3kuIFNlZSB0aGUgY29tbWVudHMgZm9yIGBEYXRhUHJlQ29udmVydGVyYCBmb3JcclxuICogdGhlIGZ1bGwgY29udGV4dC5cclxuICovXHJcbnZhciBEb2N1bWVudEtleVJlZmVyZW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERvY3VtZW50S2V5UmVmZXJlbmNlKGRhdGFiYXNlSWQsIGtleSkge1xyXG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IGRhdGFiYXNlSWQ7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRG9jdW1lbnRLZXlSZWZlcmVuY2U7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBIZWxwZXIgZm9yIHBhcnNpbmcgcmF3IHVzZXIgaW5wdXQgKHByb3ZpZGVkIHZpYSB0aGUgQVBJKSBpbnRvIGludGVybmFsIG1vZGVsXHJcbiAqIGNsYXNzZXMuXHJcbiAqL1xyXG52YXIgVXNlckRhdGFDb252ZXJ0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBVc2VyRGF0YUNvbnZlcnRlcihwcmVDb252ZXJ0ZXIpIHtcclxuICAgICAgICB0aGlzLnByZUNvbnZlcnRlciA9IHByZUNvbnZlcnRlcjtcclxuICAgIH1cclxuICAgIC8qKiBQYXJzZSBkb2N1bWVudCBkYXRhIGZyb20gYSBub24tbWVyZ2Ugc2V0KCkgY2FsbC4gKi9cclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZVNldERhdGEgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgaW5wdXQpIHtcclxuICAgICAgICB2YXIgY29udGV4dCA9IG5ldyBQYXJzZUNvbnRleHQoVXNlckRhdGFTb3VyY2UuU2V0LCBtZXRob2ROYW1lLCBGaWVsZFBhdGguRU1QVFlfUEFUSCk7XHJcbiAgICAgICAgdmFsaWRhdGVQbGFpbk9iamVjdCgnRGF0YSBtdXN0IGJlIGFuIG9iamVjdCwgYnV0IGl0IHdhczonLCBjb250ZXh0LCBpbnB1dCk7XHJcbiAgICAgICAgdmFyIHVwZGF0ZURhdGEgPSB0aGlzLnBhcnNlRGF0YShpbnB1dCwgY29udGV4dCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQYXJzZWRTZXREYXRhKHVwZGF0ZURhdGEsIFxyXG4gICAgICAgIC8qIGZpZWxkTWFzaz0gKi8gbnVsbCwgY29udGV4dC5maWVsZFRyYW5zZm9ybXMpO1xyXG4gICAgfTtcclxuICAgIC8qKiBQYXJzZSBkb2N1bWVudCBkYXRhIGZyb20gYSBzZXQoKSBjYWxsIHdpdGggJ3ttZXJnZTp0cnVlfScuICovXHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VNZXJnZURhdGEgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgaW5wdXQsIGZpZWxkUGF0aHMpIHtcclxuICAgICAgICB2YXIgY29udGV4dCA9IG5ldyBQYXJzZUNvbnRleHQoVXNlckRhdGFTb3VyY2UuTWVyZ2VTZXQsIG1ldGhvZE5hbWUsIEZpZWxkUGF0aC5FTVBUWV9QQVRIKTtcclxuICAgICAgICB2YWxpZGF0ZVBsYWluT2JqZWN0KCdEYXRhIG11c3QgYmUgYW4gb2JqZWN0LCBidXQgaXQgd2FzOicsIGNvbnRleHQsIGlucHV0KTtcclxuICAgICAgICB2YXIgdXBkYXRlRGF0YSA9IHRoaXMucGFyc2VEYXRhKGlucHV0LCBjb250ZXh0KTtcclxuICAgICAgICB2YXIgZmllbGRNYXNrO1xyXG4gICAgICAgIHZhciBmaWVsZFRyYW5zZm9ybXM7XHJcbiAgICAgICAgaWYgKCFmaWVsZFBhdGhzKSB7XHJcbiAgICAgICAgICAgIGZpZWxkTWFzayA9IG5ldyBGaWVsZE1hc2soY29udGV4dC5maWVsZE1hc2spO1xyXG4gICAgICAgICAgICBmaWVsZFRyYW5zZm9ybXMgPSBjb250ZXh0LmZpZWxkVHJhbnNmb3JtcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB2YWxpZGF0ZWRGaWVsZFBhdGhzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgZmllbGRQYXRoc18xID0gZmllbGRQYXRoczsgX2kgPCBmaWVsZFBhdGhzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RyaW5nT3JGaWVsZFBhdGggPSBmaWVsZFBhdGhzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkUGF0aCA9IHZvaWQgMDtcclxuICAgICAgICAgICAgICAgIGlmIChzdHJpbmdPckZpZWxkUGF0aCBpbnN0YW5jZW9mIEZpZWxkUGF0aCQxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRQYXRoID0gc3RyaW5nT3JGaWVsZFBhdGguX2ludGVybmFsUGF0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBzdHJpbmdPckZpZWxkUGF0aCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZFBhdGggPSBmaWVsZFBhdGhGcm9tRG90U2VwYXJhdGVkU3RyaW5nKG1ldGhvZE5hbWUsIHN0cmluZ09yRmllbGRQYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGZhaWwoJ0V4cGVjdGVkIHN0cmluZ09yRmllbGRQYXRoIHRvIGJlIGEgc3RyaW5nIG9yIGEgRmllbGRQYXRoJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRleHQuY29udGFpbnMoZmllbGRQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRmllbGQgJ1wiICsgZmllbGRQYXRoICsgXCInIGlzIHNwZWNpZmllZCBpbiB5b3VyIGZpZWxkIG1hc2sgYnV0IG1pc3NpbmcgZnJvbSB5b3VyIGlucHV0IGRhdGEuXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFsaWRhdGVkRmllbGRQYXRocy5wdXNoKGZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmllbGRNYXNrID0gbmV3IEZpZWxkTWFzayh2YWxpZGF0ZWRGaWVsZFBhdGhzKTtcclxuICAgICAgICAgICAgZmllbGRUcmFuc2Zvcm1zID0gY29udGV4dC5maWVsZFRyYW5zZm9ybXMuZmlsdGVyKGZ1bmN0aW9uICh0cmFuc2Zvcm0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWVsZE1hc2suY292ZXJzKHRyYW5zZm9ybS5maWVsZCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFBhcnNlZFNldERhdGEodXBkYXRlRGF0YSwgZmllbGRNYXNrLCBmaWVsZFRyYW5zZm9ybXMpO1xyXG4gICAgfTtcclxuICAgIC8qKiBQYXJzZSB1cGRhdGUgZGF0YSBmcm9tIGFuIHVwZGF0ZSgpIGNhbGwuICovXHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VVcGRhdGVEYXRhID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIGlucHV0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY29udGV4dCA9IG5ldyBQYXJzZUNvbnRleHQoVXNlckRhdGFTb3VyY2UuVXBkYXRlLCBtZXRob2ROYW1lLCBGaWVsZFBhdGguRU1QVFlfUEFUSCk7XHJcbiAgICAgICAgdmFsaWRhdGVQbGFpbk9iamVjdCgnRGF0YSBtdXN0IGJlIGFuIG9iamVjdCwgYnV0IGl0IHdhczonLCBjb250ZXh0LCBpbnB1dCk7XHJcbiAgICAgICAgdmFyIGZpZWxkTWFza1BhdGhzID0gW107XHJcbiAgICAgICAgdmFyIHVwZGF0ZURhdGEgPSBPYmplY3RWYWx1ZS5FTVBUWTtcclxuICAgICAgICBmb3JFYWNoKGlucHV0LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IGZpZWxkUGF0aEZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcobWV0aG9kTmFtZSwga2V5KTtcclxuICAgICAgICAgICAgdmFyIGNoaWxkQ29udGV4dCA9IGNvbnRleHQuY2hpbGRDb250ZXh0Rm9yRmllbGRQYXRoKHBhdGgpO1xyXG4gICAgICAgICAgICB2YWx1ZSA9IF90aGlzLnJ1blByZUNvbnZlcnRlcih2YWx1ZSwgY2hpbGRDb250ZXh0KTtcclxuICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGVsZXRlRmllbGRWYWx1ZUltcGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIEFkZCBpdCB0byB0aGUgZmllbGQgbWFzaywgYnV0IGRvbid0IGFkZCBhbnl0aGluZyB0byB1cGRhdGVEYXRhLlxyXG4gICAgICAgICAgICAgICAgZmllbGRNYXNrUGF0aHMucHVzaChwYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJzZWRWYWx1ZSA9IF90aGlzLnBhcnNlRGF0YSh2YWx1ZSwgY2hpbGRDb250ZXh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJzZWRWYWx1ZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRNYXNrUGF0aHMucHVzaChwYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVEYXRhID0gdXBkYXRlRGF0YS5zZXQocGF0aCwgcGFyc2VkVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIG1hc2sgPSBuZXcgRmllbGRNYXNrKGZpZWxkTWFza1BhdGhzKTtcclxuICAgICAgICByZXR1cm4gbmV3IFBhcnNlZFVwZGF0ZURhdGEodXBkYXRlRGF0YSwgbWFzaywgY29udGV4dC5maWVsZFRyYW5zZm9ybXMpO1xyXG4gICAgfTtcclxuICAgIC8qKiBQYXJzZSB1cGRhdGUgZGF0YSBmcm9tIGEgbGlzdCBvZiBmaWVsZC92YWx1ZSBhcmd1bWVudHMuICovXHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VVcGRhdGVWYXJhcmdzID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIGZpZWxkLCB2YWx1ZSwgbW9yZUZpZWxkc0FuZFZhbHVlcykge1xyXG4gICAgICAgIHZhciBjb250ZXh0ID0gbmV3IFBhcnNlQ29udGV4dChVc2VyRGF0YVNvdXJjZS5VcGRhdGUsIG1ldGhvZE5hbWUsIEZpZWxkUGF0aC5FTVBUWV9QQVRIKTtcclxuICAgICAgICB2YXIga2V5cyA9IFtmaWVsZFBhdGhGcm9tQXJndW1lbnQobWV0aG9kTmFtZSwgZmllbGQpXTtcclxuICAgICAgICB2YXIgdmFsdWVzJCQxID0gW3ZhbHVlXTtcclxuICAgICAgICBpZiAobW9yZUZpZWxkc0FuZFZhbHVlcy5sZW5ndGggJSAyICE9PSAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBtZXRob2ROYW1lICsgXCIoKSBuZWVkcyB0byBiZSBjYWxsZWQgd2l0aCBhbiBldmVuIG51bWJlciBcIiArXHJcbiAgICAgICAgICAgICAgICAnb2YgYXJndW1lbnRzIHRoYXQgYWx0ZXJuYXRlIGJldHdlZW4gZmllbGQgbmFtZXMgYW5kIHZhbHVlcy4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtb3JlRmllbGRzQW5kVmFsdWVzLmxlbmd0aDsgaSArPSAyKSB7XHJcbiAgICAgICAgICAgIGtleXMucHVzaChmaWVsZFBhdGhGcm9tQXJndW1lbnQobWV0aG9kTmFtZSwgbW9yZUZpZWxkc0FuZFZhbHVlc1tpXSkpO1xyXG4gICAgICAgICAgICB2YWx1ZXMkJDEucHVzaChtb3JlRmllbGRzQW5kVmFsdWVzW2kgKyAxXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBmaWVsZE1hc2tQYXRocyA9IFtdO1xyXG4gICAgICAgIHZhciB1cGRhdGVEYXRhID0gT2JqZWN0VmFsdWUuRU1QVFk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0ga2V5c1tpXTtcclxuICAgICAgICAgICAgdmFyIGNoaWxkQ29udGV4dCA9IGNvbnRleHQuY2hpbGRDb250ZXh0Rm9yRmllbGRQYXRoKHBhdGgpO1xyXG4gICAgICAgICAgICB2YXIgdmFsdWVfMSA9IHRoaXMucnVuUHJlQ29udmVydGVyKHZhbHVlcyQkMVtpXSwgY2hpbGRDb250ZXh0KTtcclxuICAgICAgICAgICAgaWYgKHZhbHVlXzEgaW5zdGFuY2VvZiBEZWxldGVGaWVsZFZhbHVlSW1wbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSBmaWVsZCBtYXNrLCBidXQgZG9uJ3QgYWRkIGFueXRoaW5nIHRvIHVwZGF0ZURhdGEuXHJcbiAgICAgICAgICAgICAgICBmaWVsZE1hc2tQYXRocy5wdXNoKHBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcnNlZFZhbHVlID0gdGhpcy5wYXJzZURhdGEodmFsdWVfMSwgY2hpbGRDb250ZXh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJzZWRWYWx1ZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRNYXNrUGF0aHMucHVzaChwYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVEYXRhID0gdXBkYXRlRGF0YS5zZXQocGF0aCwgcGFyc2VkVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtYXNrID0gbmV3IEZpZWxkTWFzayhmaWVsZE1hc2tQYXRocyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQYXJzZWRVcGRhdGVEYXRhKHVwZGF0ZURhdGEsIG1hc2ssIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlIGEgXCJxdWVyeSB2YWx1ZVwiIChlLmcuIHZhbHVlIGluIGEgd2hlcmUgZmlsdGVyIG9yIGEgdmFsdWUgaW4gYSBjdXJzb3JcclxuICAgICAqIGJvdW5kKS5cclxuICAgICAqL1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlUXVlcnlWYWx1ZSA9IGZ1bmN0aW9uIChtZXRob2ROYW1lLCBpbnB1dCkge1xyXG4gICAgICAgIHZhciBjb250ZXh0ID0gbmV3IFBhcnNlQ29udGV4dChVc2VyRGF0YVNvdXJjZS5Bcmd1bWVudCwgbWV0aG9kTmFtZSwgRmllbGRQYXRoLkVNUFRZX1BBVEgpO1xyXG4gICAgICAgIHZhciBwYXJzZWQgPSB0aGlzLnBhcnNlRGF0YShpbnB1dCwgY29udGV4dCk7XHJcbiAgICAgICAgYXNzZXJ0KHBhcnNlZCAhPSBudWxsLCAnUGFyc2VkIGRhdGEgc2hvdWxkIG5vdCBiZSBudWxsLicpO1xyXG4gICAgICAgIGFzc2VydChjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGggPT09IDAsICdGaWVsZCB0cmFuc2Zvcm1zIHNob3VsZCBoYXZlIGJlZW4gZGlzYWxsb3dlZC4nKTtcclxuICAgICAgICByZXR1cm4gcGFyc2VkO1xyXG4gICAgfTtcclxuICAgIC8qKiBTZW5kcyBkYXRhIHRocm91Z2ggdGhpcy5wcmVDb252ZXJ0ZXIsIGhhbmRsaW5nIGFueSB0aHJvd24gZXJyb3JzLiAqL1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnJ1blByZUNvbnZlcnRlciA9IGZ1bmN0aW9uIChpbnB1dCwgY29udGV4dCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByZUNvbnZlcnRlcihpbnB1dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gZXJyb3JNZXNzYWdlKGUpO1xyXG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmNyZWF0ZUVycm9yKG1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEludGVybmFsIGhlbHBlciBmb3IgcGFyc2luZyB1c2VyIGRhdGEuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IERhdGEgdG8gYmUgcGFyc2VkLlxyXG4gICAgICogQHBhcmFtIGNvbnRleHQgQSBjb250ZXh0IG9iamVjdCByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgcGF0aCBiZWluZyBwYXJzZWQsXHJcbiAgICAgKiB0aGUgc291cmNlIG9mIHRoZSBkYXRhIGJlaW5nIHBhcnNlZCwgZXRjLlxyXG4gICAgICogQHJldHVybiBUaGUgcGFyc2VkIHZhbHVlLCBvciBudWxsIGlmIHRoZSB2YWx1ZSB3YXMgYSBGaWVsZFZhbHVlIHNlbnRpbmVsXHJcbiAgICAgKiB0aGF0IHNob3VsZCBub3QgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdGluZyBwYXJzZWQgZGF0YS5cclxuICAgICAqL1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlRGF0YSA9IGZ1bmN0aW9uIChpbnB1dCwgY29udGV4dCkge1xyXG4gICAgICAgIGlucHV0ID0gdGhpcy5ydW5QcmVDb252ZXJ0ZXIoaW5wdXQsIGNvbnRleHQpO1xyXG4gICAgICAgIGlmIChsb29rc0xpa2VKc29uT2JqZWN0KGlucHV0KSkge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZVBsYWluT2JqZWN0KCdVbnN1cHBvcnRlZCBmaWVsZCB2YWx1ZTonLCBjb250ZXh0LCBpbnB1dCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlT2JqZWN0KGlucHV0LCBjb250ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBGaWVsZFZhbHVlSW1wbCkge1xyXG4gICAgICAgICAgICAvLyBGaWVsZFZhbHVlcyB1c3VhbGx5IHBhcnNlIGludG8gdHJhbnNmb3JtcyAoZXhjZXB0IEZpZWxkVmFsdWUuZGVsZXRlKCkpXHJcbiAgICAgICAgICAgIC8vIGluIHdoaWNoIGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gaW5jbHVkZSB0aGlzIGZpZWxkIGluIG91ciBwYXJzZWQgZGF0YVxyXG4gICAgICAgICAgICAvLyAoYXMgZG9pbmcgc28gd2lsbCBvdmVyd3JpdGUgdGhlIGZpZWxkIGRpcmVjdGx5IHByaW9yIHRvIHRoZSB0cmFuc2Zvcm1cclxuICAgICAgICAgICAgLy8gdHJ5aW5nIHRvIHRyYW5zZm9ybSBpdCkuIFNvIHdlIGRvbid0IGFkZCB0aGlzIGxvY2F0aW9uIHRvXHJcbiAgICAgICAgICAgIC8vIGNvbnRleHQuZmllbGRNYXNrIGFuZCB3ZSByZXR1cm4gbnVsbCBhcyBvdXIgcGFyc2luZyByZXN1bHQuXHJcbiAgICAgICAgICAgIHRoaXMucGFyc2VTZW50aW5lbEZpZWxkVmFsdWUoaW5wdXQsIGNvbnRleHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIElmIGNvbnRleHQucGF0aCBpcyBudWxsIHdlIGFyZSBpbnNpZGUgYW4gYXJyYXkgYW5kIHdlIGRvbid0IHN1cHBvcnRcclxuICAgICAgICAgICAgLy8gZmllbGQgbWFzayBwYXRocyBtb3JlIGdyYW51bGFyIHRoYW4gdGhlIHRvcC1sZXZlbCBhcnJheS5cclxuICAgICAgICAgICAgaWYgKGNvbnRleHQucGF0aCkge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWVsZE1hc2sucHVzaChjb250ZXh0LnBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBJbmNsdWRlIHRoZSBwYXRoIGNvbnRhaW5pbmcgdGhlIGFycmF5IGluIHRoZSBlcnJvclxyXG4gICAgICAgICAgICAgICAgLy8gbWVzc2FnZS5cclxuICAgICAgICAgICAgICAgIGlmIChjb250ZXh0LmFycmF5RWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGNvbnRleHQuY3JlYXRlRXJyb3IoJ05lc3RlZCBhcnJheXMgYXJlIG5vdCBzdXBwb3J0ZWQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlQXJyYXkoaW5wdXQsIGNvbnRleHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VTY2FsYXJWYWx1ZShpbnB1dCwgY29udGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlT2JqZWN0ID0gZnVuY3Rpb24gKG9iaiwgY29udGV4dCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTb3J0ZWRNYXAocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbiAgICAgICAgaWYgKGlzRW1wdHkob2JqKSkge1xyXG4gICAgICAgICAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgYW4gZW1wdHkgb2JqZWN0LCB3ZSBleHBsaWNpdGx5IGFkZCBpdCB0byB0aGUgdXBkYXRlXHJcbiAgICAgICAgICAgIC8vIG1hc2sgdG8gZW5zdXJlIHRoYXQgdGhlIHNlcnZlciBjcmVhdGVzIGEgbWFwIGVudHJ5LlxyXG4gICAgICAgICAgICBpZiAoY29udGV4dC5wYXRoICYmIGNvbnRleHQucGF0aC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpZWxkTWFzay5wdXNoKGNvbnRleHQucGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvckVhY2gob2JqLCBmdW5jdGlvbiAoa2V5LCB2YWwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJzZWRWYWx1ZSA9IF90aGlzLnBhcnNlRGF0YSh2YWwsIGNvbnRleHQuY2hpbGRDb250ZXh0Rm9yRmllbGQoa2V5KSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VkVmFsdWUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5pbnNlcnQoa2V5LCBwYXJzZWRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IE9iamVjdFZhbHVlKHJlc3VsdCk7XHJcbiAgICB9O1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlQXJyYXkgPSBmdW5jdGlvbiAoYXJyYXksIGNvbnRleHQpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgdmFyIGVudHJ5SW5kZXggPSAwO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXJyYXlfMSA9IGFycmF5OyBfaSA8IGFycmF5XzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBlbnRyeSA9IGFycmF5XzFbX2ldO1xyXG4gICAgICAgICAgICB2YXIgcGFyc2VkRW50cnkgPSB0aGlzLnBhcnNlRGF0YShlbnRyeSwgY29udGV4dC5jaGlsZENvbnRleHRGb3JBcnJheShlbnRyeUluZGV4KSk7XHJcbiAgICAgICAgICAgIGlmIChwYXJzZWRFbnRyeSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBKdXN0IGluY2x1ZGUgbnVsbHMgaW4gdGhlIGFycmF5IGZvciBmaWVsZHMgYmVpbmcgcmVwbGFjZWQgd2l0aCBhXHJcbiAgICAgICAgICAgICAgICAvLyBzZW50aW5lbC5cclxuICAgICAgICAgICAgICAgIHBhcnNlZEVudHJ5ID0gTnVsbFZhbHVlLklOU1RBTkNFO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHBhcnNlZEVudHJ5KTtcclxuICAgICAgICAgICAgZW50cnlJbmRleCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IEFycmF5VmFsdWUocmVzdWx0KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFwiUGFyc2VzXCIgdGhlIHByb3ZpZGVkIEZpZWxkVmFsdWVJbXBsLCBhZGRpbmcgYW55IG5lY2Vzc2FyeSB0cmFuc2Zvcm1zIHRvXHJcbiAgICAgKiBjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcy5cclxuICAgICAqL1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlU2VudGluZWxGaWVsZFZhbHVlID0gZnVuY3Rpb24gKHZhbHVlLCBjb250ZXh0KSB7XHJcbiAgICAgICAgLy8gU2VudGluZWxzIGFyZSBvbmx5IHN1cHBvcnRlZCB3aXRoIHdyaXRlcywgYW5kIG5vdCB3aXRoaW4gYXJyYXlzLlxyXG4gICAgICAgIGlmICghaXNXcml0ZShjb250ZXh0LmRhdGFTb3VyY2UpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGNvbnRleHQuY3JlYXRlRXJyb3IodmFsdWUuX21ldGhvZE5hbWUgKyBcIigpIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCB1cGRhdGUoKSBhbmQgc2V0KClcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb250ZXh0LnBhdGggPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhyb3cgY29udGV4dC5jcmVhdGVFcnJvcih2YWx1ZS5fbWV0aG9kTmFtZSArIFwiKCkgaXMgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgaW5zaWRlIGFycmF5c1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGVsZXRlRmllbGRWYWx1ZUltcGwpIHtcclxuICAgICAgICAgICAgaWYgKGNvbnRleHQuZGF0YVNvdXJjZSA9PT0gVXNlckRhdGFTb3VyY2UuTWVyZ2VTZXQpIHtcclxuICAgICAgICAgICAgICAgIC8vIE5vIHRyYW5zZm9ybSB0byBhZGQgZm9yIGEgZGVsZXRlLCBidXQgd2UgbmVlZCB0byBhZGQgaXQgdG8gb3VyXHJcbiAgICAgICAgICAgICAgICAvLyBmaWVsZE1hc2sgc28gaXQgZ2V0cyBkZWxldGVkLlxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5maWVsZE1hc2sucHVzaChjb250ZXh0LnBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbnRleHQuZGF0YVNvdXJjZSA9PT0gVXNlckRhdGFTb3VyY2UuVXBkYXRlKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoY29udGV4dC5wYXRoLmxlbmd0aCA+IDAsICdGaWVsZFZhbHVlLmRlbGV0ZSgpIGF0IHRoZSB0b3AgbGV2ZWwgc2hvdWxkIGhhdmUgYWxyZWFkeScgK1xyXG4gICAgICAgICAgICAgICAgICAgICcgYmVlbiBoYW5kbGVkLicpO1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgY29udGV4dC5jcmVhdGVFcnJvcignRmllbGRWYWx1ZS5kZWxldGUoKSBjYW4gb25seSBhcHBlYXIgYXQgdGhlIHRvcCBsZXZlbCAnICtcclxuICAgICAgICAgICAgICAgICAgICAnb2YgeW91ciB1cGRhdGUgZGF0YScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gV2Ugc2hvdWxkbid0IGVuY291bnRlciBkZWxldGUgc2VudGluZWxzIGZvciBxdWVyaWVzIG9yIG5vbi1tZXJnZSBzZXQoKSBjYWxscy5cclxuICAgICAgICAgICAgICAgIHRocm93IGNvbnRleHQuY3JlYXRlRXJyb3IoJ0ZpZWxkVmFsdWUuZGVsZXRlKCkgY2Fubm90IGJlIHVzZWQgd2l0aCBzZXQoKSB1bmxlc3MgeW91IHBhc3MgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgJ3ttZXJnZTp0cnVlfScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgU2VydmVyVGltZXN0YW1wRmllbGRWYWx1ZUltcGwpIHtcclxuICAgICAgICAgICAgY29udGV4dC5maWVsZFRyYW5zZm9ybXMucHVzaChuZXcgRmllbGRUcmFuc2Zvcm0oY29udGV4dC5wYXRoLCBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0uaW5zdGFuY2UpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheVVuaW9uRmllbGRWYWx1ZUltcGwpIHtcclxuICAgICAgICAgICAgdmFyIHBhcnNlZEVsZW1lbnRzID0gdGhpcy5wYXJzZUFycmF5VHJhbnNmb3JtRWxlbWVudHModmFsdWUuX21ldGhvZE5hbWUsIHZhbHVlLl9lbGVtZW50cyk7XHJcbiAgICAgICAgICAgIHZhciBhcnJheVVuaW9uID0gbmV3IEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24ocGFyc2VkRWxlbWVudHMpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcy5wdXNoKG5ldyBGaWVsZFRyYW5zZm9ybShjb250ZXh0LnBhdGgsIGFycmF5VW5pb24pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheVJlbW92ZUZpZWxkVmFsdWVJbXBsKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJzZWRFbGVtZW50cyA9IHRoaXMucGFyc2VBcnJheVRyYW5zZm9ybUVsZW1lbnRzKHZhbHVlLl9tZXRob2ROYW1lLCB2YWx1ZS5fZWxlbWVudHMpO1xyXG4gICAgICAgICAgICB2YXIgYXJyYXlSZW1vdmUgPSBuZXcgQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24ocGFyc2VkRWxlbWVudHMpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcy5wdXNoKG5ldyBGaWVsZFRyYW5zZm9ybShjb250ZXh0LnBhdGgsIGFycmF5UmVtb3ZlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmYWlsKCdVbmtub3duIEZpZWxkVmFsdWUgdHlwZTogJyArIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBIZWxwZXIgdG8gcGFyc2UgYSBzY2FsYXIgdmFsdWUgKGkuZS4gbm90IGFuIE9iamVjdCwgQXJyYXksIG9yIEZpZWxkVmFsdWUpXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybiBUaGUgcGFyc2VkIHZhbHVlXHJcbiAgICAgKi9cclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZVNjYWxhclZhbHVlID0gZnVuY3Rpb24gKHZhbHVlLCBjb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOdWxsVmFsdWUuSU5TVEFOQ0U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgaWYgKGlzU2FmZUludGVnZXIodmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEludGVnZXJWYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERvdWJsZVZhbHVlKHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICByZXR1cm4gQm9vbGVhblZhbHVlLm9mKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1ZhbHVlKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVGltZXN0YW1wVmFsdWUoVGltZXN0YW1wLmZyb21EYXRlKHZhbHVlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgVGltZXN0YW1wKSB7XHJcbiAgICAgICAgICAgIC8vIEZpcmVzdG9yZSBiYWNrZW5kIHRydW5jYXRlcyBwcmVjaXNpb24gZG93biB0byBtaWNyb3NlY29uZHMuIFRvIGVuc3VyZVxyXG4gICAgICAgICAgICAvLyBvZmZsaW5lIG1vZGUgd29ya3MgdGhlIHNhbWUgd2l0aCByZWdhcmRzIHRvIHRydW5jYXRpb24sIHBlcmZvcm0gdGhlXHJcbiAgICAgICAgICAgIC8vIHRydW5jYXRpb24gaW1tZWRpYXRlbHkgd2l0aG91dCB3YWl0aW5nIGZvciB0aGUgYmFja2VuZCB0byBkbyB0aGF0LlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFRpbWVzdGFtcFZhbHVlKG5ldyBUaW1lc3RhbXAodmFsdWUuc2Vjb25kcywgTWF0aC5mbG9vcih2YWx1ZS5uYW5vc2Vjb25kcyAvIDEwMDApICogMTAwMCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEdlb1BvaW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgR2VvUG9pbnRWYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQmxvYikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEJsb2JWYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgRG9jdW1lbnRLZXlSZWZlcmVuY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWZWYWx1ZSh2YWx1ZS5kYXRhYmFzZUlkLCB2YWx1ZS5rZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgY29udGV4dC5jcmVhdGVFcnJvcihcIlVuc3VwcG9ydGVkIGZpZWxkIHZhbHVlOiBcIiArIHZhbHVlRGVzY3JpcHRpb24odmFsdWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlQXJyYXlUcmFuc2Zvcm1FbGVtZW50cyA9IGZ1bmN0aW9uIChtZXRob2ROYW1lLCBlbGVtZW50cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRzLm1hcChmdW5jdGlvbiAoZWxlbWVudCwgaSkge1xyXG4gICAgICAgICAgICAvLyBBbHRob3VnaCBhcnJheSB0cmFuc2Zvcm1zIGFyZSB1c2VkIHdpdGggd3JpdGVzLCB0aGUgYWN0dWFsIGVsZW1lbnRzXHJcbiAgICAgICAgICAgIC8vIGJlaW5nIHVuaW9uZWQgb3IgcmVtb3ZlZCBhcmUgbm90IGNvbnNpZGVyZWQgd3JpdGVzIHNpbmNlIHRoZXkgY2Fubm90XHJcbiAgICAgICAgICAgIC8vIGNvbnRhaW4gYW55IEZpZWxkVmFsdWUgc2VudGluZWxzLCBldGMuXHJcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gbmV3IFBhcnNlQ29udGV4dChVc2VyRGF0YVNvdXJjZS5Bcmd1bWVudCwgbWV0aG9kTmFtZSwgRmllbGRQYXRoLkVNUFRZX1BBVEgpO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucGFyc2VEYXRhKGVsZW1lbnQsIGNvbnRleHQuY2hpbGRDb250ZXh0Rm9yQXJyYXkoaSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBVc2VyRGF0YUNvbnZlcnRlcjtcclxufSgpKTtcclxuLyoqXHJcbiAqIENoZWNrcyB3aGV0aGVyIGFuIG9iamVjdCBsb29rcyBsaWtlIGEgSlNPTiBvYmplY3QgdGhhdCBzaG91bGQgYmUgY29udmVydGVkXHJcbiAqIGludG8gYSBzdHJ1Y3QuIE5vcm1hbCBjbGFzcy9wcm90b3R5cGUgaW5zdGFuY2VzIGFyZSBjb25zaWRlcmVkIHRvIGxvb2sgbGlrZVxyXG4gKiBKU09OIG9iamVjdHMgc2luY2UgdGhleSBzaG91bGQgYmUgY29udmVydGVkIHRvIGEgc3RydWN0IHZhbHVlLiBBcnJheXMsIERhdGVzLFxyXG4gKiBHZW9Qb2ludHMsIGV0Yy4gYXJlIG5vdCBjb25zaWRlcmVkIHRvIGxvb2sgbGlrZSBKU09OIG9iamVjdHMgc2luY2UgdGhleSBtYXBcclxuICogdG8gc3BlY2lmaWMgRmllbGRWYWx1ZSB0eXBlcyBvdGhlciB0aGFuIE9iamVjdFZhbHVlLlxyXG4gKi9cclxuZnVuY3Rpb24gbG9va3NMaWtlSnNvbk9iamVjdChpbnB1dCkge1xyXG4gICAgcmV0dXJuICh0eXBlb2YgaW5wdXQgPT09ICdvYmplY3QnICYmXHJcbiAgICAgICAgaW5wdXQgIT09IG51bGwgJiZcclxuICAgICAgICAhKGlucHV0IGluc3RhbmNlb2YgQXJyYXkpICYmXHJcbiAgICAgICAgIShpbnB1dCBpbnN0YW5jZW9mIERhdGUpICYmXHJcbiAgICAgICAgIShpbnB1dCBpbnN0YW5jZW9mIFRpbWVzdGFtcCkgJiZcclxuICAgICAgICAhKGlucHV0IGluc3RhbmNlb2YgR2VvUG9pbnQpICYmXHJcbiAgICAgICAgIShpbnB1dCBpbnN0YW5jZW9mIEJsb2IpICYmXHJcbiAgICAgICAgIShpbnB1dCBpbnN0YW5jZW9mIERvY3VtZW50S2V5UmVmZXJlbmNlKSAmJlxyXG4gICAgICAgICEoaW5wdXQgaW5zdGFuY2VvZiBGaWVsZFZhbHVlSW1wbCkpO1xyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlUGxhaW5PYmplY3QobWVzc2FnZSwgY29udGV4dCwgaW5wdXQpIHtcclxuICAgIGlmICghbG9va3NMaWtlSnNvbk9iamVjdChpbnB1dCkgfHwgIWlzUGxhaW5PYmplY3QoaW5wdXQpKSB7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gdmFsdWVEZXNjcmlwdGlvbihpbnB1dCk7XHJcbiAgICAgICAgaWYgKGRlc2NyaXB0aW9uID09PSAnYW4gb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAvLyBNYXNzYWdlIHRoZSBlcnJvciBpZiBpdCB3YXMgYW4gb2JqZWN0LlxyXG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmNyZWF0ZUVycm9yKG1lc3NhZ2UgKyAnIGEgY3VzdG9tIG9iamVjdCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgY29udGV4dC5jcmVhdGVFcnJvcihtZXNzYWdlICsgJyAnICsgZGVzY3JpcHRpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICogSGVscGVyIHRoYXQgY2FsbHMgZnJvbURvdFNlcGFyYXRlZFN0cmluZygpIGJ1dCB3cmFwcyBhbnkgZXJyb3IgdGhyb3duLlxyXG4gKi9cclxuZnVuY3Rpb24gZmllbGRQYXRoRnJvbUFyZ3VtZW50KG1ldGhvZE5hbWUsIHBhdGgpIHtcclxuICAgIGlmIChwYXRoIGluc3RhbmNlb2YgRmllbGRQYXRoJDEpIHtcclxuICAgICAgICByZXR1cm4gcGF0aC5faW50ZXJuYWxQYXRoO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIHBhdGggPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgcmV0dXJuIGZpZWxkUGF0aEZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcobWV0aG9kTmFtZSwgcGF0aCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2YXIgbWVzc2FnZSA9ICdGaWVsZCBwYXRoIGFyZ3VtZW50cyBtdXN0IGJlIG9mIHR5cGUgc3RyaW5nIG9yIEZpZWxkUGF0aC4nO1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBtZXRob2ROYW1lICsgXCIoKSBjYWxsZWQgd2l0aCBpbnZhbGlkIGRhdGEuIFwiICsgbWVzc2FnZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFdyYXBzIGZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcgd2l0aCBhbiBlcnJvciBtZXNzYWdlIGFib3V0IHRoZSBtZXRob2QgdGhhdFxyXG4gKiB3YXMgdGhyb3duLlxyXG4gKiBAcGFyYW0gbWV0aG9kTmFtZSBUaGUgcHVibGljbHkgdmlzaWJsZSBtZXRob2QgbmFtZVxyXG4gKiBAcGFyYW0gcGF0aCBUaGUgZG90LXNlcGFyYXRlZCBzdHJpbmcgZm9ybSBvZiBhIGZpZWxkIHBhdGggd2hpY2ggd2lsbCBiZSBzcGxpdFxyXG4gKiBvbiBkb3RzLlxyXG4gKi9cclxuZnVuY3Rpb24gZmllbGRQYXRoRnJvbURvdFNlcGFyYXRlZFN0cmluZyhtZXRob2ROYW1lLCBwYXRoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiBmcm9tRG90U2VwYXJhdGVkU3RyaW5nKHBhdGgpLl9pbnRlcm5hbFBhdGg7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIHZhciBtZXNzYWdlID0gZXJyb3JNZXNzYWdlKGUpO1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBtZXRob2ROYW1lICsgXCIoKSBjYWxsZWQgd2l0aCBpbnZhbGlkIGRhdGEuIFwiICsgbWVzc2FnZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEV4dHJhY3RzIHRoZSBtZXNzYWdlIGZyb20gYSBjYXVnaHQgZXhjZXB0aW9uLCB3aGljaCBzaG91bGQgYmUgYW4gRXJyb3Igb2JqZWN0XHJcbiAqIHRob3VnaCBKUyBkb2Vzbid0IGd1YXJhbnRlZSB0aGF0LlxyXG4gKi9cclxuZnVuY3Rpb24gZXJyb3JNZXNzYWdlKGVycm9yKSB7XHJcbiAgICByZXR1cm4gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBlcnJvci50b1N0cmluZygpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBUaGUgb2JqZWN0cyB0aGF0IGFyZSBhIHBhcnQgb2YgdGhpcyBBUEkgYXJlIGV4cG9zZWQgdG8gdGhpcmQtcGFydGllcyBhc1xyXG4vLyBjb21waWxlZCBqYXZhc2NyaXB0IHNvIHdlIHdhbnQgdG8gZmxhZyBvdXIgcHJpdmF0ZSBtZW1iZXJzIHdpdGggYSBsZWFkaW5nXHJcbi8vIHVuZGVyc2NvcmUgdG8gZGlzY291cmFnZSB0aGVpciB1c2UuXHJcbi8vIHRzbGludDpkaXNhYmxlOnN0cmlwLXByaXZhdGUtcHJvcGVydHktdW5kZXJzY29yZVxyXG4vLyBzZXR0aW5ncygpIGRlZmF1bHRzOlxyXG52YXIgREVGQVVMVF9IT1NUID0gJ2ZpcmVzdG9yZS5nb29nbGVhcGlzLmNvbSc7XHJcbnZhciBERUZBVUxUX1NTTCA9IHRydWU7XHJcbnZhciBERUZBVUxUX1RJTUVTVEFNUFNfSU5fU05BUFNIT1RTID0gZmFsc2U7XHJcbi8vIGVuYWJsZVBlcnNpc3RlbmNlKCkgZGVmYXVsdHM6XHJcbnZhciBERUZBVUxUX1NZTkNIUk9OSVpFX1RBQlMgPSBmYWxzZTtcclxuLyoqXHJcbiAqIEEgY29uY3JldGUgdHlwZSBkZXNjcmliaW5nIGFsbCB0aGUgdmFsdWVzIHRoYXQgY2FuIGJlIGFwcGxpZWQgdmlhIGFcclxuICogdXNlci1zdXBwbGllZCBmaXJlc3RvcmUuU2V0dGluZ3Mgb2JqZWN0LiBUaGlzIGlzIGEgc2VwYXJhdGUgdHlwZSBzbyB0aGF0XHJcbiAqIGRlZmF1bHRzIGNhbiBiZSBzdXBwbGllZCBhbmQgdGhlIHZhbHVlIGNhbiBiZSBjaGVja2VkIGZvciBlcXVhbGl0eS5cclxuICovXHJcbnZhciBGaXJlc3RvcmVTZXR0aW5ncyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpcmVzdG9yZVNldHRpbmdzKHNldHRpbmdzKSB7XHJcbiAgICAgICAgaWYgKHNldHRpbmdzLmhvc3QgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3Muc3NsICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiQ2FuJ3QgcHJvdmlkZSBzc2wgb3B0aW9uIGlmIGhvc3Qgb3B0aW9uIGlzIG5vdCBzZXRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5ob3N0ID0gREVGQVVMVF9IT1NUO1xyXG4gICAgICAgICAgICB0aGlzLnNzbCA9IERFRkFVTFRfU1NMO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVOYW1lZFR5cGUoJ3NldHRpbmdzJywgJ25vbi1lbXB0eSBzdHJpbmcnLCAnaG9zdCcsIHNldHRpbmdzLmhvc3QpO1xyXG4gICAgICAgICAgICB0aGlzLmhvc3QgPSBzZXR0aW5ncy5ob3N0O1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxUeXBlKCdzZXR0aW5ncycsICdib29sZWFuJywgJ3NzbCcsIHNldHRpbmdzLnNzbCk7XHJcbiAgICAgICAgICAgIHRoaXMuc3NsID0gZGVmYXVsdGVkKHNldHRpbmdzLnNzbCwgREVGQVVMVF9TU0wpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZU9wdGlvbk5hbWVzKCdzZXR0aW5ncycsIHNldHRpbmdzLCBbXHJcbiAgICAgICAgICAgICdob3N0JyxcclxuICAgICAgICAgICAgJ3NzbCcsXHJcbiAgICAgICAgICAgICdjcmVkZW50aWFscycsXHJcbiAgICAgICAgICAgICd0aW1lc3RhbXBzSW5TbmFwc2hvdHMnXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgdmFsaWRhdGVOYW1lZE9wdGlvbmFsVHlwZSgnc2V0dGluZ3MnLCAnb2JqZWN0JywgJ2NyZWRlbnRpYWxzJywgc2V0dGluZ3MuY3JlZGVudGlhbHMpO1xyXG4gICAgICAgIHRoaXMuY3JlZGVudGlhbHMgPSBzZXR0aW5ncy5jcmVkZW50aWFscztcclxuICAgICAgICB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxUeXBlKCdzZXR0aW5ncycsICdib29sZWFuJywgJ3RpbWVzdGFtcHNJblNuYXBzaG90cycsIHNldHRpbmdzLnRpbWVzdGFtcHNJblNuYXBzaG90cyk7XHJcbiAgICAgICAgdGhpcy50aW1lc3RhbXBzSW5TbmFwc2hvdHMgPSBkZWZhdWx0ZWQoc2V0dGluZ3MudGltZXN0YW1wc0luU25hcHNob3RzLCBERUZBVUxUX1RJTUVTVEFNUFNfSU5fU05BUFNIT1RTKTtcclxuICAgIH1cclxuICAgIEZpcmVzdG9yZVNldHRpbmdzLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmhvc3QgPT09IG90aGVyLmhvc3QgJiZcclxuICAgICAgICAgICAgdGhpcy5zc2wgPT09IG90aGVyLnNzbCAmJlxyXG4gICAgICAgICAgICB0aGlzLnRpbWVzdGFtcHNJblNuYXBzaG90cyA9PT0gb3RoZXIudGltZXN0YW1wc0luU25hcHNob3RzICYmXHJcbiAgICAgICAgICAgIHRoaXMuY3JlZGVudGlhbHMgPT09IG90aGVyLmNyZWRlbnRpYWxzKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRmlyZXN0b3JlU2V0dGluZ3M7XHJcbn0oKSk7XHJcbnZhciBGaXJlc3RvcmVDb25maWcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaXJlc3RvcmVDb25maWcoKSB7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRmlyZXN0b3JlQ29uZmlnO1xyXG59KCkpO1xyXG4vKipcclxuICogRW5jYXBzdWxhdGVzIHRoZSBzZXR0aW5ncyB0aGF0IGNhbiBiZSB1c2VkIHRvIGNvbmZpZ3VyZSBGaXJlc3RvcmVcclxuICogcGVyc2lzdGVuY2UuXHJcbiAqL1xyXG52YXIgUGVyc2lzdGVuY2VTZXR0aW5ncyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFBlcnNpc3RlbmNlU2V0dGluZ3MoZW5hYmxlZCwgc2V0dGluZ3MpIHtcclxuICAgICAgICB0aGlzLmVuYWJsZWQgPSBlbmFibGVkO1xyXG4gICAgICAgIGFzc2VydChlbmFibGVkIHx8ICFzZXR0aW5ncywgJ0NhbiBvbmx5IHByb3ZpZGUgUGVyc2lzdGVuY2VTZXR0aW5ncyB3aXRoIHBlcnNpc3RlbmNlIGVuYWJsZWQnKTtcclxuICAgICAgICBzZXR0aW5ncyA9IHNldHRpbmdzIHx8IHt9O1xyXG4gICAgICAgIHRoaXMuZXhwZXJpbWVudGFsVGFiU3luY2hyb25pemF0aW9uID0gZGVmYXVsdGVkKHNldHRpbmdzLmV4cGVyaW1lbnRhbFRhYlN5bmNocm9uaXphdGlvbiwgREVGQVVMVF9TWU5DSFJPTklaRV9UQUJTKTtcclxuICAgIH1cclxuICAgIFBlcnNpc3RlbmNlU2V0dGluZ3MucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuZW5hYmxlZCA9PT0gb3RoZXIuZW5hYmxlZCAmJlxyXG4gICAgICAgICAgICB0aGlzLmV4cGVyaW1lbnRhbFRhYlN5bmNocm9uaXphdGlvbiA9PT1cclxuICAgICAgICAgICAgICAgIG90aGVyLmV4cGVyaW1lbnRhbFRhYlN5bmNocm9uaXphdGlvbik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBlcnNpc3RlbmNlU2V0dGluZ3M7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBUaGUgcm9vdCByZWZlcmVuY2UgdG8gdGhlIGRhdGFiYXNlLlxyXG4gKi9cclxudmFyIEZpcmVzdG9yZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpcmVzdG9yZShkYXRhYmFzZUlkT3JBcHApIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFB1YmxpYyBmb3IgdXNlIGluIHRlc3RzLlxyXG4gICAgICAgIC8vIFRPRE8obWlrZWxlaGVuKTogVXNlIG1vZHVsYXJpemVkIGluaXRpYWxpemF0aW9uIGluc3RlYWQuXHJcbiAgICAgICAgdGhpcy5fcXVldWUgPSBuZXcgQXN5bmNRdWV1ZSgpO1xyXG4gICAgICAgIHRoaXMuSU5URVJOQUwgPSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZTogZnVuY3Rpb24gKG9wdGlvbnMpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2ZpcmVzdG9yZUNsaWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5fZmlyZXN0b3JlQ2xpZW50LnNodXRkb3duKG9wdGlvbnMpXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pOyB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgY29uZmlnID0gbmV3IEZpcmVzdG9yZUNvbmZpZygpO1xyXG4gICAgICAgIGlmICh0eXBlb2YgZGF0YWJhc2VJZE9yQXBwLm9wdGlvbnMgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgdmVyeSBsaWtlbHkgYSBGaXJlYmFzZSBhcHAgb2JqZWN0XHJcbiAgICAgICAgICAgIC8vIFRPRE8oYi8zNDE3NzYwNSk6IENhbiB3ZSBzb21laG93IHVzZSBpbnN0YW5jZW9mP1xyXG4gICAgICAgICAgICB2YXIgYXBwID0gZGF0YWJhc2VJZE9yQXBwO1xyXG4gICAgICAgICAgICBjb25maWcuZmlyZWJhc2VBcHAgPSBhcHA7XHJcbiAgICAgICAgICAgIGNvbmZpZy5kYXRhYmFzZUlkID0gRmlyZXN0b3JlLmRhdGFiYXNlSWRGcm9tQXBwKGFwcCk7XHJcbiAgICAgICAgICAgIGNvbmZpZy5wZXJzaXN0ZW5jZUtleSA9IGNvbmZpZy5maXJlYmFzZUFwcC5uYW1lO1xyXG4gICAgICAgICAgICBjb25maWcuY3JlZGVudGlhbHMgPSBuZXcgRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyKGFwcCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgZXh0ZXJuYWxfMSA9IGRhdGFiYXNlSWRPckFwcDtcclxuICAgICAgICAgICAgaWYgKCFleHRlcm5hbF8xLnByb2plY3RJZCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ011c3QgcHJvdmlkZSBwcm9qZWN0SWQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25maWcuZGF0YWJhc2VJZCA9IG5ldyBEYXRhYmFzZUlkKGV4dGVybmFsXzEucHJvamVjdElkLCBleHRlcm5hbF8xLmRhdGFiYXNlKTtcclxuICAgICAgICAgICAgLy8gVXNlIGEgZGVmYXVsdCBwZXJzaXN0ZW5jZUtleSB0aGF0IGxpbmVzIHVwIHdpdGggRmlyZWJhc2VBcHAuXHJcbiAgICAgICAgICAgIGNvbmZpZy5wZXJzaXN0ZW5jZUtleSA9ICdbREVGQVVMVF0nO1xyXG4gICAgICAgICAgICBjb25maWcuY3JlZGVudGlhbHMgPSBuZXcgRW1wdHlDcmVkZW50aWFsc1Byb3ZpZGVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbmZpZy5zZXR0aW5ncyA9IG5ldyBGaXJlc3RvcmVTZXR0aW5ncyh7fSk7XHJcbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xyXG4gICAgICAgIHRoaXMuX2RhdGFiYXNlSWQgPSBjb25maWcuZGF0YWJhc2VJZDtcclxuICAgIH1cclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuc2V0dGluZ3MgPSBmdW5jdGlvbiAoc2V0dGluZ3NMaXRlcmFsKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnRmlyZXN0b3JlLnNldHRpbmdzJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0ZpcmVzdG9yZS5zZXR0aW5ncycsICdvYmplY3QnLCAxLCBzZXR0aW5nc0xpdGVyYWwpO1xyXG4gICAgICAgIGlmIChjb250YWlucyhzZXR0aW5nc0xpdGVyYWwsICdwZXJzaXN0ZW5jZScpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdcInBlcnNpc3RlbmNlXCIgaXMgbm93IHNwZWNpZmllZCB3aXRoIGEgc2VwYXJhdGUgY2FsbCB0byAnICtcclxuICAgICAgICAgICAgICAgICdmaXJlc3RvcmUuZW5hYmxlUGVyc2lzdGVuY2UoKS4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG5ld1NldHRpbmdzID0gbmV3IEZpcmVzdG9yZVNldHRpbmdzKHNldHRpbmdzTGl0ZXJhbCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2ZpcmVzdG9yZUNsaWVudCAmJiAhdGhpcy5fY29uZmlnLnNldHRpbmdzLmlzRXF1YWwobmV3U2V0dGluZ3MpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sICdGaXJlc3RvcmUgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIGFuZCBpdHMgc2V0dGluZ3MgY2FuIG5vIGxvbmdlciAnICtcclxuICAgICAgICAgICAgICAgICdiZSBjaGFuZ2VkLiBZb3UgY2FuIG9ubHkgY2FsbCBzZXR0aW5ncygpIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciAnICtcclxuICAgICAgICAgICAgICAgICdtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fY29uZmlnLnNldHRpbmdzID0gbmV3U2V0dGluZ3M7XHJcbiAgICAgICAgaWYgKG5ld1NldHRpbmdzLmNyZWRlbnRpYWxzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fY29uZmlnLmNyZWRlbnRpYWxzID0gbWFrZUNyZWRlbnRpYWxzUHJvdmlkZXIobmV3U2V0dGluZ3MuY3JlZGVudGlhbHMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLmVuYWJsZU5ldHdvcmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5lbnN1cmVDbGllbnRDb25maWd1cmVkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpcmVzdG9yZUNsaWVudC5lbmFibGVOZXR3b3JrKCk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5kaXNhYmxlTmV0d29yayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50LmRpc2FibGVOZXR3b3JrKCk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5lbmFibGVQZXJzaXN0ZW5jZSA9IGZ1bmN0aW9uIChzZXR0aW5ncykge1xyXG4gICAgICAgIGlmICh0aGlzLl9maXJlc3RvcmVDbGllbnQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgJ0ZpcmVzdG9yZSBoYXMgYWxyZWFkeSBiZWVuIHN0YXJ0ZWQgYW5kIHBlcnNpc3RlbmNlIGNhbiBubyBsb25nZXIgJyArXHJcbiAgICAgICAgICAgICAgICAnYmUgZW5hYmxlZC4gWW91IGNhbiBvbmx5IGNhbGwgZW5hYmxlUGVyc2lzdGVuY2UoKSBiZWZvcmUgY2FsbGluZyAnICtcclxuICAgICAgICAgICAgICAgICdhbnkgb3RoZXIgbWV0aG9kcyBvbiBhIEZpcmVzdG9yZSBvYmplY3QuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ3VyZUNsaWVudChuZXcgUGVyc2lzdGVuY2VTZXR0aW5ncygvKiBlbmFibGVkPSAqLyB0cnVlLCBzZXR0aW5ncykpO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX2ZpcmVzdG9yZUNsaWVudCkge1xyXG4gICAgICAgICAgICAvLyBLaWNrIG9mZiBzdGFydGluZyB0aGUgY2xpZW50IGJ1dCBkb24ndCBhY3R1YWxseSB3YWl0IGZvciBpdC5cclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlndXJlQ2xpZW50KG5ldyBQZXJzaXN0ZW5jZVNldHRpbmdzKC8qIGVuYWJsZWQ9ICovIGZhbHNlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9maXJlc3RvcmVDbGllbnQ7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5jb25maWd1cmVDbGllbnQgPSBmdW5jdGlvbiAocGVyc2lzdGVuY2VTZXR0aW5ncykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KCEhdGhpcy5fY29uZmlnLnNldHRpbmdzLmhvc3QsICdGaXJlc3RvcmVTZXR0aW5ncy5ob3N0IGNhbm5vdCBiZSBmYWxzZXknKTtcclxuICAgICAgICBpZiAoIXRoaXMuX2NvbmZpZy5zZXR0aW5ncy50aW1lc3RhbXBzSW5TbmFwc2hvdHMpIHtcclxuICAgICAgICAgICAgZXJyb3IoXCJcXG5UaGUgYmVoYXZpb3IgZm9yIERhdGUgb2JqZWN0cyBzdG9yZWQgaW4gRmlyZXN0b3JlIGlzIGdvaW5nIHRvIGNoYW5nZVxcbkFORCBZT1VSIEFQUCBNQVkgQlJFQUsuXFxuVG8gaGlkZSB0aGlzIHdhcm5pbmcgYW5kIGVuc3VyZSB5b3VyIGFwcCBkb2VzIG5vdCBicmVhaywgeW91IG5lZWQgdG8gYWRkIHRoZVxcbmZvbGxvd2luZyBjb2RlIHRvIHlvdXIgYXBwIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBDbG91ZCBGaXJlc3RvcmUgbWV0aG9kczpcXG5cXG4gIGNvbnN0IGZpcmVzdG9yZSA9IGZpcmViYXNlLmZpcmVzdG9yZSgpO1xcbiAgY29uc3Qgc2V0dGluZ3MgPSB7LyogeW91ciBzZXR0aW5ncy4uLiAqLyB0aW1lc3RhbXBzSW5TbmFwc2hvdHM6IHRydWV9O1xcbiAgZmlyZXN0b3JlLnNldHRpbmdzKHNldHRpbmdzKTtcXG5cXG5XaXRoIHRoaXMgY2hhbmdlLCB0aW1lc3RhbXBzIHN0b3JlZCBpbiBDbG91ZCBGaXJlc3RvcmUgd2lsbCBiZSByZWFkIGJhY2sgYXNcXG5GaXJlYmFzZSBUaW1lc3RhbXAgb2JqZWN0cyBpbnN0ZWFkIG9mIGFzIHN5c3RlbSBEYXRlIG9iamVjdHMuIFNvIHlvdSB3aWxsIGFsc29cXG5uZWVkIHRvIHVwZGF0ZSBjb2RlIGV4cGVjdGluZyBhIERhdGUgdG8gaW5zdGVhZCBleHBlY3QgYSBUaW1lc3RhbXAuIEZvciBleGFtcGxlOlxcblxcbiAgLy8gT2xkOlxcbiAgY29uc3QgZGF0ZSA9IHNuYXBzaG90LmdldCgnY3JlYXRlZF9hdCcpO1xcbiAgLy8gTmV3OlxcbiAgY29uc3QgdGltZXN0YW1wID0gc25hcHNob3QuZ2V0KCdjcmVhdGVkX2F0Jyk7XFxuICBjb25zdCBkYXRlID0gdGltZXN0YW1wLnRvRGF0ZSgpO1xcblxcblBsZWFzZSBhdWRpdCBhbGwgZXhpc3RpbmcgdXNhZ2VzIG9mIERhdGUgd2hlbiB5b3UgZW5hYmxlIHRoZSBuZXcgYmVoYXZpb3IuIEluIGFcXG5mdXR1cmUgcmVsZWFzZSwgdGhlIGJlaGF2aW9yIHdpbGwgY2hhbmdlIHRvIHRoZSBuZXcgYmVoYXZpb3IsIHNvIGlmIHlvdSBkbyBub3RcXG5mb2xsb3cgdGhlc2Ugc3RlcHMsIFlPVVIgQVBQIE1BWSBCUkVBSy5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFzc2VydCghdGhpcy5fZmlyZXN0b3JlQ2xpZW50LCAnY29uZmlndXJlQ2xpZW50KCkgY2FsbGVkIG11bHRpcGxlIHRpbWVzJyk7XHJcbiAgICAgICAgdmFyIGRhdGFiYXNlSW5mbyA9IG5ldyBEYXRhYmFzZUluZm8odGhpcy5fY29uZmlnLmRhdGFiYXNlSWQsIHRoaXMuX2NvbmZpZy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5fY29uZmlnLnNldHRpbmdzLmhvc3QsIHRoaXMuX2NvbmZpZy5zZXR0aW5ncy5zc2wpO1xyXG4gICAgICAgIHZhciBwcmVDb252ZXJ0ZXIgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRG9jdW1lbnRSZWZlcmVuY2UpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0aGlzRGIgPSBfdGhpcy5fY29uZmlnLmRhdGFiYXNlSWQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3RoZXJEYiA9IHZhbHVlLmZpcmVzdG9yZS5fY29uZmlnLmRhdGFiYXNlSWQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW90aGVyRGIuaXNFcXVhbCh0aGlzRGIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0RvY3VtZW50IHJlZmVyZW5jZSBpcyBmb3IgZGF0YWJhc2UgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChvdGhlckRiLnByb2plY3RJZCArIFwiL1wiICsgb3RoZXJEYi5kYXRhYmFzZSArIFwiIGJ1dCBzaG91bGQgYmUgXCIpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKFwiZm9yIGRhdGFiYXNlIFwiICsgdGhpc0RiLnByb2plY3RJZCArIFwiL1wiICsgdGhpc0RiLmRhdGFiYXNlKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50S2V5UmVmZXJlbmNlKF90aGlzLl9jb25maWcuZGF0YWJhc2VJZCwgdmFsdWUuX2tleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX2RhdGFDb252ZXJ0ZXIgPSBuZXcgVXNlckRhdGFDb252ZXJ0ZXIocHJlQ29udmVydGVyKTtcclxuICAgICAgICB0aGlzLl9maXJlc3RvcmVDbGllbnQgPSBuZXcgRmlyZXN0b3JlQ2xpZW50KFBsYXRmb3JtU3VwcG9ydC5nZXRQbGF0Zm9ybSgpLCBkYXRhYmFzZUluZm8sIHRoaXMuX2NvbmZpZy5jcmVkZW50aWFscywgdGhpcy5fcXVldWUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9maXJlc3RvcmVDbGllbnQuc3RhcnQocGVyc2lzdGVuY2VTZXR0aW5ncyk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlLmRhdGFiYXNlSWRGcm9tQXBwID0gZnVuY3Rpb24gKGFwcCkge1xyXG4gICAgICAgIHZhciBvcHRpb25zID0gYXBwLm9wdGlvbnM7XHJcbiAgICAgICAgaWYgKCFjb250YWlucyhvcHRpb25zLCAncHJvamVjdElkJykpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1wicHJvamVjdElkXCIgbm90IHByb3ZpZGVkIGluIGZpcmViYXNlLmluaXRpYWxpemVBcHAuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwcm9qZWN0SWQgPSBvcHRpb25zWydwcm9qZWN0SWQnXTtcclxuICAgICAgICBpZiAoIXByb2plY3RJZCB8fCB0eXBlb2YgcHJvamVjdElkICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAncHJvamVjdElkIG11c3QgYmUgYSBzdHJpbmcgaW4gRmlyZWJhc2VBcHAub3B0aW9ucycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IERhdGFiYXNlSWQocHJvamVjdElkKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyZXN0b3JlLnByb3RvdHlwZSwgXCJhcHBcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2NvbmZpZy5maXJlYmFzZUFwcCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJGaXJlc3RvcmUgd2FzIG5vdCBpbml0aWFsaXplZCB1c2luZyB0aGUgRmlyZWJhc2UgU0RLLiAnYXBwJyBpcyBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgJ25vdCBhdmFpbGFibGUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnLmZpcmViYXNlQXBwO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5jb2xsZWN0aW9uID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdGaXJlc3RvcmUuY29sbGVjdGlvbicsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdGaXJlc3RvcmUuY29sbGVjdGlvbicsICdub24tZW1wdHkgc3RyaW5nJywgMSwgcGF0aFN0cmluZyk7XHJcbiAgICAgICAgaWYgKCFwYXRoU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdNdXN0IHByb3ZpZGUgYSBub24tZW1wdHkgY29sbGVjdGlvbiBwYXRoIHRvIGNvbGxlY3Rpb24oKScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKTtcclxuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb25SZWZlcmVuY2UoUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcocGF0aFN0cmluZyksIHRoaXMpO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuZG9jID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdGaXJlc3RvcmUuZG9jJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0ZpcmVzdG9yZS5kb2MnLCAnbm9uLWVtcHR5IHN0cmluZycsIDEsIHBhdGhTdHJpbmcpO1xyXG4gICAgICAgIGlmICghcGF0aFN0cmluZykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnTXVzdCBwcm92aWRlIGEgbm9uLWVtcHR5IGRvY3VtZW50IHBhdGggdG8gZG9jKCknKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbnN1cmVDbGllbnRDb25maWd1cmVkKCk7XHJcbiAgICAgICAgcmV0dXJuIERvY3VtZW50UmVmZXJlbmNlLmZvclBhdGgoUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcocGF0aFN0cmluZyksIHRoaXMpO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUucnVuVHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAodXBkYXRlRnVuY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0ZpcmVzdG9yZS5ydW5UcmFuc2FjdGlvbicsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdGaXJlc3RvcmUucnVuVHJhbnNhY3Rpb24nLCAnZnVuY3Rpb24nLCAxLCB1cGRhdGVGdW5jdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpLnRyYW5zYWN0aW9uKGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlRnVuY3Rpb24obmV3IFRyYW5zYWN0aW9uJDEoX3RoaXMsIHRyYW5zYWN0aW9uKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5iYXRjaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKTtcclxuICAgICAgICByZXR1cm4gbmV3IFdyaXRlQmF0Y2godGhpcyk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpcmVzdG9yZSwgXCJsb2dMZXZlbFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZ2V0TG9nTGV2ZWwoKSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBMb2dMZXZlbC5ERUJVRzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2RlYnVnJztcclxuICAgICAgICAgICAgICAgIGNhc2UgTG9nTGV2ZWwuRVJST1I6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdlcnJvcic7XHJcbiAgICAgICAgICAgICAgICBjYXNlIExvZ0xldmVsLlNJTEVOVDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3NpbGVudCc7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIGxvZyBsZXZlbDogJyArIGdldExvZ0xldmVsKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBGaXJlc3RvcmUuc2V0TG9nTGV2ZWwgPSBmdW5jdGlvbiAobGV2ZWwpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdGaXJlc3RvcmUuc2V0TG9nTGV2ZWwnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnRmlyZXN0b3JlLnNldExvZ0xldmVsJywgJ25vbi1lbXB0eSBzdHJpbmcnLCAxLCBsZXZlbCk7XHJcbiAgICAgICAgc3dpdGNoIChsZXZlbCkge1xyXG4gICAgICAgICAgICBjYXNlICdkZWJ1Zyc6XHJcbiAgICAgICAgICAgICAgICBzZXRMb2dMZXZlbChMb2dMZXZlbC5ERUJVRyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZXJyb3InOlxyXG4gICAgICAgICAgICAgICAgc2V0TG9nTGV2ZWwoTG9nTGV2ZWwuRVJST1IpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3NpbGVudCc6XHJcbiAgICAgICAgICAgICAgICBzZXRMb2dMZXZlbChMb2dMZXZlbC5TSUxFTlQpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnSW52YWxpZCBsb2cgbGV2ZWw6ICcgKyBsZXZlbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIE5vdGU6IHRoaXMgaXMgbm90IGEgcHJvcGVydHkgYmVjYXVzZSB0aGUgbWluaWZpZXIgY2FuJ3Qgd29yayBjb3JyZWN0bHkgd2l0aFxyXG4gICAgLy8gdGhlIHdheSBUeXBlU2NyaXB0IGNvbXBpbGVyIG91dHB1dHMgcHJvcGVydGllcy5cclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuX2FyZVRpbWVzdGFtcHNJblNuYXBzaG90c0VuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZy5zZXR0aW5ncy50aW1lc3RhbXBzSW5TbmFwc2hvdHM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpcmVzdG9yZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgcmVmZXJlbmNlIHRvIGEgdHJhbnNhY3Rpb24uXHJcbiAqL1xyXG52YXIgVHJhbnNhY3Rpb24kMSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRyYW5zYWN0aW9uKF9maXJlc3RvcmUsIF90cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IF9maXJlc3RvcmU7XHJcbiAgICAgICAgdGhpcy5fdHJhbnNhY3Rpb24gPSBfdHJhbnNhY3Rpb247XHJcbiAgICB9XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGRvY3VtZW50UmVmKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdUcmFuc2FjdGlvbi5nZXQnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhciByZWYgPSB2YWxpZGF0ZVJlZmVyZW5jZSgnVHJhbnNhY3Rpb24uZ2V0JywgZG9jdW1lbnRSZWYsIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIC5sb29rdXAoW3JlZi5fa2V5XSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRvY3MpIHtcclxuICAgICAgICAgICAgaWYgKCFkb2NzIHx8IGRvY3MubGVuZ3RoICE9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnTWlzbWF0Y2ggaW4gZG9jcyByZXR1cm5lZCBmcm9tIGRvY3VtZW50IGxvb2t1cC4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZG9jID0gZG9jc1swXTtcclxuICAgICAgICAgICAgaWYgKGRvYyBpbnN0YW5jZW9mIE5vRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRTbmFwc2hvdChfdGhpcy5fZmlyZXN0b3JlLCByZWYuX2tleSwgbnVsbCwgXHJcbiAgICAgICAgICAgICAgICAvKiBmcm9tQ2FjaGU9ICovIGZhbHNlLCBcclxuICAgICAgICAgICAgICAgIC8qIGhhc1BlbmRpbmdXcml0ZXM9ICovIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChkb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudFNuYXBzaG90KF90aGlzLl9maXJlc3RvcmUsIHJlZi5fa2V5LCBkb2MsIFxyXG4gICAgICAgICAgICAgICAgLyogZnJvbUNhY2hlPSAqLyBmYWxzZSwgXHJcbiAgICAgICAgICAgICAgICAvKiBoYXNQZW5kaW5nV3JpdGVzPSAqLyBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBmYWlsKFwiQmF0Y2hHZXREb2N1bWVudHNSZXF1ZXN0IHJldHVybmVkIHVuZXhwZWN0ZWQgZG9jdW1lbnQgdHlwZTogXCIgKyBkb2MuY29uc3RydWN0b3IubmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGRvY3VtZW50UmVmLCB2YWx1ZSwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnVHJhbnNhY3Rpb24uc2V0JywgYXJndW1lbnRzLCAyLCAzKTtcclxuICAgICAgICB2YXIgcmVmID0gdmFsaWRhdGVSZWZlcmVuY2UoJ1RyYW5zYWN0aW9uLnNldCcsIGRvY3VtZW50UmVmLCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgIG9wdGlvbnMgPSB2YWxpZGF0ZVNldE9wdGlvbnMoJ1RyYW5zYWN0aW9uLnNldCcsIG9wdGlvbnMpO1xyXG4gICAgICAgIHZhciBwYXJzZWQgPSBvcHRpb25zLm1lcmdlIHx8IG9wdGlvbnMubWVyZ2VGaWVsZHNcclxuICAgICAgICAgICAgPyB0aGlzLl9maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VNZXJnZURhdGEoJ1RyYW5zYWN0aW9uLnNldCcsIHZhbHVlLCBvcHRpb25zLm1lcmdlRmllbGRzKVxyXG4gICAgICAgICAgICA6IHRoaXMuX2ZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVNldERhdGEoJ1RyYW5zYWN0aW9uLnNldCcsIHZhbHVlKTtcclxuICAgICAgICB0aGlzLl90cmFuc2FjdGlvbi5zZXQocmVmLl9rZXksIHBhcnNlZCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkb2N1bWVudFJlZiwgZmllbGRPclVwZGF0ZURhdGEsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIG1vcmVGaWVsZHNBbmRWYWx1ZXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBtb3JlRmllbGRzQW5kVmFsdWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmVmO1xyXG4gICAgICAgIHZhciBwYXJzZWQ7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBmaWVsZE9yVXBkYXRlRGF0YSA9PT0gJ3N0cmluZycgfHxcclxuICAgICAgICAgICAgZmllbGRPclVwZGF0ZURhdGEgaW5zdGFuY2VvZiBGaWVsZFBhdGgkMSkge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ1RyYW5zYWN0aW9uLnVwZGF0ZScsIGFyZ3VtZW50cywgMyk7XHJcbiAgICAgICAgICAgIHJlZiA9IHZhbGlkYXRlUmVmZXJlbmNlKCdUcmFuc2FjdGlvbi51cGRhdGUnLCBkb2N1bWVudFJlZiwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICAgICAgcGFyc2VkID0gdGhpcy5fZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlVXBkYXRlVmFyYXJncygnVHJhbnNhY3Rpb24udXBkYXRlJywgZmllbGRPclVwZGF0ZURhdGEsIHZhbHVlLCBtb3JlRmllbGRzQW5kVmFsdWVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ1RyYW5zYWN0aW9uLnVwZGF0ZScsIGFyZ3VtZW50cywgMik7XHJcbiAgICAgICAgICAgIHJlZiA9IHZhbGlkYXRlUmVmZXJlbmNlKCdUcmFuc2FjdGlvbi51cGRhdGUnLCBkb2N1bWVudFJlZiwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICAgICAgcGFyc2VkID0gdGhpcy5fZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlVXBkYXRlRGF0YSgnVHJhbnNhY3Rpb24udXBkYXRlJywgZmllbGRPclVwZGF0ZURhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl90cmFuc2FjdGlvbi51cGRhdGUocmVmLl9rZXksIHBhcnNlZCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChkb2N1bWVudFJlZikge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ1RyYW5zYWN0aW9uLmRlbGV0ZScsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFyIHJlZiA9IHZhbGlkYXRlUmVmZXJlbmNlKCdUcmFuc2FjdGlvbi5kZWxldGUnLCBkb2N1bWVudFJlZiwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICB0aGlzLl90cmFuc2FjdGlvbi5kZWxldGUocmVmLl9rZXkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUcmFuc2FjdGlvbjtcclxufSgpKTtcclxudmFyIFdyaXRlQmF0Y2ggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBXcml0ZUJhdGNoKF9maXJlc3RvcmUpIHtcclxuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSBfZmlyZXN0b3JlO1xyXG4gICAgICAgIHRoaXMuX211dGF0aW9ucyA9IFtdO1xyXG4gICAgICAgIHRoaXMuX2NvbW1pdHRlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgV3JpdGVCYXRjaC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGRvY3VtZW50UmVmLCB2YWx1ZSwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnV3JpdGVCYXRjaC5zZXQnLCBhcmd1bWVudHMsIDIsIDMpO1xyXG4gICAgICAgIHRoaXMudmVyaWZ5Tm90Q29tbWl0dGVkKCk7XHJcbiAgICAgICAgdmFyIHJlZiA9IHZhbGlkYXRlUmVmZXJlbmNlKCdXcml0ZUJhdGNoLnNldCcsIGRvY3VtZW50UmVmLCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgIG9wdGlvbnMgPSB2YWxpZGF0ZVNldE9wdGlvbnMoJ1dyaXRlQmF0Y2guc2V0Jywgb3B0aW9ucyk7XHJcbiAgICAgICAgdmFyIHBhcnNlZCA9IG9wdGlvbnMubWVyZ2UgfHwgb3B0aW9ucy5tZXJnZUZpZWxkc1xyXG4gICAgICAgICAgICA/IHRoaXMuX2ZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZU1lcmdlRGF0YSgnV3JpdGVCYXRjaC5zZXQnLCB2YWx1ZSwgb3B0aW9ucy5tZXJnZUZpZWxkcylcclxuICAgICAgICAgICAgOiB0aGlzLl9maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VTZXREYXRhKCdXcml0ZUJhdGNoLnNldCcsIHZhbHVlKTtcclxuICAgICAgICB0aGlzLl9tdXRhdGlvbnMgPSB0aGlzLl9tdXRhdGlvbnMuY29uY2F0KHBhcnNlZC50b011dGF0aW9ucyhyZWYuX2tleSwgUHJlY29uZGl0aW9uLk5PTkUpKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBXcml0ZUJhdGNoLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZG9jdW1lbnRSZWYsIGZpZWxkT3JVcGRhdGVEYXRhLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBtb3JlRmllbGRzQW5kVmFsdWVzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAzOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgbW9yZUZpZWxkc0FuZFZhbHVlc1tfaSAtIDNdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy52ZXJpZnlOb3RDb21taXR0ZWQoKTtcclxuICAgICAgICB2YXIgcmVmO1xyXG4gICAgICAgIHZhciBwYXJzZWQ7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBmaWVsZE9yVXBkYXRlRGF0YSA9PT0gJ3N0cmluZycgfHxcclxuICAgICAgICAgICAgZmllbGRPclVwZGF0ZURhdGEgaW5zdGFuY2VvZiBGaWVsZFBhdGgkMSkge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ1dyaXRlQmF0Y2gudXBkYXRlJywgYXJndW1lbnRzLCAzKTtcclxuICAgICAgICAgICAgcmVmID0gdmFsaWRhdGVSZWZlcmVuY2UoJ1dyaXRlQmF0Y2gudXBkYXRlJywgZG9jdW1lbnRSZWYsIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgICAgIHBhcnNlZCA9IHRoaXMuX2ZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVVwZGF0ZVZhcmFyZ3MoJ1dyaXRlQmF0Y2gudXBkYXRlJywgZmllbGRPclVwZGF0ZURhdGEsIHZhbHVlLCBtb3JlRmllbGRzQW5kVmFsdWVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ1dyaXRlQmF0Y2gudXBkYXRlJywgYXJndW1lbnRzLCAyKTtcclxuICAgICAgICAgICAgcmVmID0gdmFsaWRhdGVSZWZlcmVuY2UoJ1dyaXRlQmF0Y2gudXBkYXRlJywgZG9jdW1lbnRSZWYsIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgICAgIHBhcnNlZCA9IHRoaXMuX2ZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVVwZGF0ZURhdGEoJ1dyaXRlQmF0Y2gudXBkYXRlJywgZmllbGRPclVwZGF0ZURhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9tdXRhdGlvbnMgPSB0aGlzLl9tdXRhdGlvbnMuY29uY2F0KHBhcnNlZC50b011dGF0aW9ucyhyZWYuX2tleSwgUHJlY29uZGl0aW9uLmV4aXN0cyh0cnVlKSkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIFdyaXRlQmF0Y2gucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChkb2N1bWVudFJlZikge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ1dyaXRlQmF0Y2guZGVsZXRlJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB0aGlzLnZlcmlmeU5vdENvbW1pdHRlZCgpO1xyXG4gICAgICAgIHZhciByZWYgPSB2YWxpZGF0ZVJlZmVyZW5jZSgnV3JpdGVCYXRjaC5kZWxldGUnLCBkb2N1bWVudFJlZiwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICB0aGlzLl9tdXRhdGlvbnMgPSB0aGlzLl9tdXRhdGlvbnMuY29uY2F0KG5ldyBEZWxldGVNdXRhdGlvbihyZWYuX2tleSwgUHJlY29uZGl0aW9uLk5PTkUpKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBXcml0ZUJhdGNoLnByb3RvdHlwZS5jb21taXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52ZXJpZnlOb3RDb21taXR0ZWQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbW1pdHRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbXV0YXRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5fZmlyZXN0b3JlLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKS53cml0ZSh0aGlzLl9tdXRhdGlvbnMpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgV3JpdGVCYXRjaC5wcm90b3R5cGUudmVyaWZ5Tm90Q29tbWl0dGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9jb21taXR0ZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgJ0Egd3JpdGUgYmF0Y2ggY2FuIG5vIGxvbmdlciBiZSB1c2VkIGFmdGVyIGNvbW1pdCgpICcgK1xyXG4gICAgICAgICAgICAgICAgJ2hhcyBiZWVuIGNhbGxlZC4nKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFdyaXRlQmF0Y2g7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIHJlZmVyZW5jZSB0byBhIHBhcnRpY3VsYXIgZG9jdW1lbnQgaW4gYSBjb2xsZWN0aW9uIGluIHRoZSBkYXRhYmFzZS5cclxuICovXHJcbnZhciBEb2N1bWVudFJlZmVyZW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERvY3VtZW50UmVmZXJlbmNlKF9rZXksIGZpcmVzdG9yZSkge1xyXG4gICAgICAgIHRoaXMuX2tleSA9IF9rZXk7XHJcbiAgICAgICAgdGhpcy5maXJlc3RvcmUgPSBmaXJlc3RvcmU7XHJcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlQ2xpZW50ID0gdGhpcy5maXJlc3RvcmUuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpO1xyXG4gICAgfVxyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UuZm9yUGF0aCA9IGZ1bmN0aW9uIChwYXRoLCBmaXJlc3RvcmUpIHtcclxuICAgICAgICBpZiAocGF0aC5sZW5ndGggJSAyICE9PSAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdJbnZhbGlkIGRvY3VtZW50IHJlZmVyZW5jZS4gRG9jdW1lbnQgJyArXHJcbiAgICAgICAgICAgICAgICAncmVmZXJlbmNlcyBtdXN0IGhhdmUgYW4gZXZlbiBudW1iZXIgb2Ygc2VnbWVudHMsIGJ1dCAnICtcclxuICAgICAgICAgICAgICAgIChwYXRoLmNhbm9uaWNhbFN0cmluZygpICsgXCIgaGFzIFwiICsgcGF0aC5sZW5ndGgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudFJlZmVyZW5jZShuZXcgRG9jdW1lbnRLZXkocGF0aCksIGZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZSwgXCJpZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5sYXN0U2VnbWVudCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZSwgXCJwYXJlbnRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb25SZWZlcmVuY2UodGhpcy5fa2V5LnBhdGgucG9wTGFzdCgpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLCBcInBhdGhcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUuY29sbGVjdGlvbiA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnRG9jdW1lbnRSZWZlcmVuY2UuY29sbGVjdGlvbicsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdEb2N1bWVudFJlZmVyZW5jZS5jb2xsZWN0aW9uJywgJ25vbi1lbXB0eSBzdHJpbmcnLCAxLCBwYXRoU3RyaW5nKTtcclxuICAgICAgICBpZiAoIXBhdGhTdHJpbmcpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ011c3QgcHJvdmlkZSBhIG5vbi1lbXB0eSBjb2xsZWN0aW9uIG5hbWUgdG8gY29sbGVjdGlvbigpJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwYXRoID0gUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcocGF0aFN0cmluZyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uUmVmZXJlbmNlKHRoaXMuX2tleS5wYXRoLmNoaWxkKHBhdGgpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIERvY3VtZW50UmVmZXJlbmNlKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkQ2xhc3NFcnJvcignaXNFcXVhbCcsICdEb2N1bWVudFJlZmVyZW5jZScsIDEsIG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlyZXN0b3JlID09PSBvdGhlci5maXJlc3RvcmUgJiYgdGhpcy5fa2V5LmlzRXF1YWwob3RoZXIuX2tleSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh2YWx1ZSwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnRG9jdW1lbnRSZWZlcmVuY2Uuc2V0JywgYXJndW1lbnRzLCAxLCAyKTtcclxuICAgICAgICBvcHRpb25zID0gdmFsaWRhdGVTZXRPcHRpb25zKCdEb2N1bWVudFJlZmVyZW5jZS5zZXQnLCBvcHRpb25zKTtcclxuICAgICAgICB2YXIgcGFyc2VkID0gb3B0aW9ucy5tZXJnZSB8fCBvcHRpb25zLm1lcmdlRmllbGRzXHJcbiAgICAgICAgICAgID8gdGhpcy5maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VNZXJnZURhdGEoJ0RvY3VtZW50UmVmZXJlbmNlLnNldCcsIHZhbHVlLCBvcHRpb25zLm1lcmdlRmllbGRzKVxyXG4gICAgICAgICAgICA6IHRoaXMuZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlU2V0RGF0YSgnRG9jdW1lbnRSZWZlcmVuY2Uuc2V0JywgdmFsdWUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9maXJlc3RvcmVDbGllbnQud3JpdGUocGFyc2VkLnRvTXV0YXRpb25zKHRoaXMuX2tleSwgUHJlY29uZGl0aW9uLk5PTkUpKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGZpZWxkT3JVcGRhdGVEYXRhLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBtb3JlRmllbGRzQW5kVmFsdWVzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgbW9yZUZpZWxkc0FuZFZhbHVlc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHBhcnNlZDtcclxuICAgICAgICBpZiAodHlwZW9mIGZpZWxkT3JVcGRhdGVEYXRhID09PSAnc3RyaW5nJyB8fFxyXG4gICAgICAgICAgICBmaWVsZE9yVXBkYXRlRGF0YSBpbnN0YW5jZW9mIEZpZWxkUGF0aCQxKSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnRG9jdW1lbnRSZWZlcmVuY2UudXBkYXRlJywgYXJndW1lbnRzLCAyKTtcclxuICAgICAgICAgICAgcGFyc2VkID0gdGhpcy5maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VVcGRhdGVWYXJhcmdzKCdEb2N1bWVudFJlZmVyZW5jZS51cGRhdGUnLCBmaWVsZE9yVXBkYXRlRGF0YSwgdmFsdWUsIG1vcmVGaWVsZHNBbmRWYWx1ZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnRG9jdW1lbnRSZWZlcmVuY2UudXBkYXRlJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICAgICAgcGFyc2VkID0gdGhpcy5maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VVcGRhdGVEYXRhKCdEb2N1bWVudFJlZmVyZW5jZS51cGRhdGUnLCBmaWVsZE9yVXBkYXRlRGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9maXJlc3RvcmVDbGllbnQud3JpdGUocGFyc2VkLnRvTXV0YXRpb25zKHRoaXMuX2tleSwgUHJlY29uZGl0aW9uLmV4aXN0cyh0cnVlKSkpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnRG9jdW1lbnRSZWZlcmVuY2UuZGVsZXRlJywgYXJndW1lbnRzLCAwKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50LndyaXRlKFtcclxuICAgICAgICAgICAgbmV3IERlbGV0ZU11dGF0aW9uKHRoaXMuX2tleSwgUHJlY29uZGl0aW9uLk5PTkUpXHJcbiAgICAgICAgXSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLm9uU25hcHNob3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnRG9jdW1lbnRSZWZlcmVuY2Uub25TbmFwc2hvdCcsIGFyZ3VtZW50cywgMSwgNCk7XHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgb2JzZXJ2ZXI7XHJcbiAgICAgICAgdmFyIGN1cnJBcmcgPSAwO1xyXG4gICAgICAgIGlmICh0eXBlb2YgYXJnc1tjdXJyQXJnXSA9PT0gJ29iamVjdCcgJiZcclxuICAgICAgICAgICAgIWlzUGFydGlhbE9ic2VydmVyKGFyZ3NbY3VyckFyZ10pKSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMgPSBhcmdzW2N1cnJBcmddO1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU9wdGlvbk5hbWVzKCdEb2N1bWVudFJlZmVyZW5jZS5vblNuYXBzaG90Jywgb3B0aW9ucywgW1xyXG4gICAgICAgICAgICAgICAgJ2luY2x1ZGVNZXRhZGF0YUNoYW5nZXMnXHJcbiAgICAgICAgICAgIF0pO1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxUeXBlKCdEb2N1bWVudFJlZmVyZW5jZS5vblNuYXBzaG90JywgJ2Jvb2xlYW4nLCAnaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcycsIG9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyk7XHJcbiAgICAgICAgICAgIGN1cnJBcmcrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGludGVybmFsT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogb3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoaXNQYXJ0aWFsT2JzZXJ2ZXIoYXJnc1tjdXJyQXJnXSkpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSBhcmdzW2N1cnJBcmddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdEb2N1bWVudFJlZmVyZW5jZS5vblNuYXBzaG90JywgJ2Z1bmN0aW9uJywgY3VyckFyZywgYXJnc1tjdXJyQXJnXSk7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlT3B0aW9uYWxBcmdUeXBlKCdEb2N1bWVudFJlZmVyZW5jZS5vblNuYXBzaG90JywgJ2Z1bmN0aW9uJywgY3VyckFyZyArIDEsIGFyZ3NbY3VyckFyZyArIDFdKTtcclxuICAgICAgICAgICAgdmFsaWRhdGVPcHRpb25hbEFyZ1R5cGUoJ0RvY3VtZW50UmVmZXJlbmNlLm9uU25hcHNob3QnLCAnZnVuY3Rpb24nLCBjdXJyQXJnICsgMiwgYXJnc1tjdXJyQXJnICsgMl0pO1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IHtcclxuICAgICAgICAgICAgICAgIG5leHQ6IGFyZ3NbY3VyckFyZ10sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogYXJnc1tjdXJyQXJnICsgMV0sXHJcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogYXJnc1tjdXJyQXJnICsgMl1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub25TbmFwc2hvdEludGVybmFsKGludGVybmFsT3B0aW9ucywgb2JzZXJ2ZXIpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZS5vblNuYXBzaG90SW50ZXJuYWwgPSBmdW5jdGlvbiAob3B0aW9ucywgb2JzZXJ2ZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBlcnJIYW5kbGVyID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmNhdWdodCBFcnJvciBpbiBvblNuYXBzaG90OicsIGVycik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IpIHtcclxuICAgICAgICAgICAgZXJySGFuZGxlciA9IG9ic2VydmVyLmVycm9yLmJpbmQob2JzZXJ2ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYXN5bmNPYnNlcnZlciA9IG5ldyBBc3luY09ic2VydmVyKHtcclxuICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKHNuYXBzaG90KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIubmV4dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChzbmFwc2hvdC5kb2NzLnNpemUgPD0gMSwgJ1RvbyBtYW55IGRvY3VtZW50cyByZXR1cm5lZCBvbiBhIGRvY3VtZW50IHF1ZXJ5Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvYyA9IHNuYXBzaG90LmRvY3MuZ2V0KF90aGlzLl9rZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQobmV3IERvY3VtZW50U25hcHNob3QoX3RoaXMuZmlyZXN0b3JlLCBfdGhpcy5fa2V5LCBkb2MsIHNuYXBzaG90LmZyb21DYWNoZSwgc25hcHNob3QuaGFzUGVuZGluZ1dyaXRlcykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjogZXJySGFuZGxlclxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBpbnRlcm5hbExpc3RlbmVyID0gdGhpcy5fZmlyZXN0b3JlQ2xpZW50Lmxpc3RlbihRdWVyeS5hdFBhdGgodGhpcy5fa2V5LnBhdGgpLCBhc3luY09ic2VydmVyLCBvcHRpb25zKTtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBhc3luY09ic2VydmVyLm11dGUoKTtcclxuICAgICAgICAgICAgX3RoaXMuX2ZpcmVzdG9yZUNsaWVudC51bmxpc3RlbihpbnRlcm5hbExpc3RlbmVyKTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdEb2N1bWVudFJlZmVyZW5jZS5nZXQnLCBhcmd1bWVudHMsIDAsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlR2V0T3B0aW9ucygnRG9jdW1lbnRSZWZlcmVuY2UuZ2V0Jywgb3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5zb3VyY2UgPT09ICdjYWNoZScpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmZpcmVzdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgIC5lbnN1cmVDbGllbnRDb25maWd1cmVkKClcclxuICAgICAgICAgICAgICAgICAgICAuZ2V0RG9jdW1lbnRGcm9tTG9jYWxDYWNoZShfdGhpcy5fa2V5KVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG5ldyBEb2N1bWVudFNuYXBzaG90KF90aGlzLmZpcmVzdG9yZSwgX3RoaXMuX2tleSwgZG9jLCBcclxuICAgICAgICAgICAgICAgICAgICAvKmZyb21DYWNoZT0qLyB0cnVlLCBkb2MgaW5zdGFuY2VvZiBEb2N1bWVudCA/IGRvYy5oYXNMb2NhbE11dGF0aW9ucyA6IGZhbHNlKSk7XHJcbiAgICAgICAgICAgICAgICB9LCByZWplY3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZ2V0VmlhU25hcHNob3RMaXN0ZW5lcihyZXNvbHZlLCByZWplY3QsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLmdldFZpYVNuYXBzaG90TGlzdGVuZXIgPSBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0LCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIHVubGlzdGVuID0gdGhpcy5vblNuYXBzaG90SW50ZXJuYWwoe1xyXG4gICAgICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiB0cnVlLFxyXG4gICAgICAgICAgICB3YWl0Rm9yU3luY1doZW5PbmxpbmU6IHRydWVcclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIChzbmFwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVlcnkgZmlyc3QgYmVmb3JlIHBhc3NpbmcgZXZlbnQgdG8gdXNlciB0byBhdm9pZFxyXG4gICAgICAgICAgICAgICAgLy8gdXNlciBhY3Rpb25zIGFmZmVjdGluZyB0aGUgbm93IHN0YWxlIHF1ZXJ5LlxyXG4gICAgICAgICAgICAgICAgdW5saXN0ZW4oKTtcclxuICAgICAgICAgICAgICAgIGlmICghc25hcC5leGlzdHMgJiYgc25hcC5tZXRhZGF0YS5mcm9tQ2FjaGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IElmIHdlJ3JlIG9ubGluZSBhbmQgdGhlIGRvY3VtZW50IGRvZXNuJ3RcclxuICAgICAgICAgICAgICAgICAgICAvLyBleGlzdCB0aGVuIHdlIHJlc29sdmUgd2l0aCBhIGRvYy5leGlzdHMgc2V0IHRvIGZhbHNlLiBJZlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlJ3JlIG9mZmxpbmUgaG93ZXZlciwgd2UgcmVqZWN0IHRoZSBQcm9taXNlIGluIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICAvLyBjYXNlLiBUd28gb3B0aW9uczogMSkgQ2FjaGUgdGhlIG5lZ2F0aXZlIHJlc3BvbnNlIGZyb21cclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc2VydmVyIHNvIHdlIGNhbiBkZWxpdmVyIHRoYXQgZXZlbiB3aGVuIHlvdSdyZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG9mZmxpbmUgMikgQWN0dWFsbHkgcmVqZWN0IHRoZSBQcm9taXNlIGluIHRoZSBvbmxpbmUgY2FzZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBkb2N1bWVudCBkb2Vzbid0IGV4aXN0LlxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTkFWQUlMQUJMRSwgJ0ZhaWxlZCB0byBnZXQgZG9jdW1lbnQgYmVjYXVzZSB0aGUgY2xpZW50IGlzICcgKyAnb2ZmbGluZS4nKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzbmFwLmV4aXN0cyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHNuYXAubWV0YWRhdGEuZnJvbUNhY2hlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuc291cmNlID09PSAnc2VydmVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTkFWQUlMQUJMRSwgJ0ZhaWxlZCB0byBnZXQgZG9jdW1lbnQgZnJvbSBzZXJ2ZXIuIChIb3dldmVyLCB0aGlzICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZG9jdW1lbnQgZG9lcyBleGlzdCBpbiB0aGUgbG9jYWwgY2FjaGUuIFJ1biBhZ2FpbiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3dpdGhvdXQgc2V0dGluZyBzb3VyY2UgdG8gXCJzZXJ2ZXJcIiB0byAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3JldHJpZXZlIHRoZSBjYWNoZWQgZG9jdW1lbnQuKScpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc25hcCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiByZWplY3RcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRG9jdW1lbnRSZWZlcmVuY2U7XHJcbn0oKSk7XHJcbnZhciBTbmFwc2hvdE1ldGFkYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU25hcHNob3RNZXRhZGF0YShoYXNQZW5kaW5nV3JpdGVzLCBmcm9tQ2FjaGUpIHtcclxuICAgICAgICB0aGlzLmhhc1BlbmRpbmdXcml0ZXMgPSBoYXNQZW5kaW5nV3JpdGVzO1xyXG4gICAgICAgIHRoaXMuZnJvbUNhY2hlID0gZnJvbUNhY2hlO1xyXG4gICAgfVxyXG4gICAgU25hcHNob3RNZXRhZGF0YS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5oYXNQZW5kaW5nV3JpdGVzID09PSBvdGhlci5oYXNQZW5kaW5nV3JpdGVzICYmXHJcbiAgICAgICAgICAgIHRoaXMuZnJvbUNhY2hlID09PSBvdGhlci5mcm9tQ2FjaGUpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTbmFwc2hvdE1ldGFkYXRhO1xyXG59KCkpO1xyXG52YXIgRG9jdW1lbnRTbmFwc2hvdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERvY3VtZW50U25hcHNob3QoX2ZpcmVzdG9yZSwgX2tleSwgX2RvY3VtZW50LCBfZnJvbUNhY2hlLCBfaGFzUGVuZGluZ1dyaXRlcykge1xyXG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IF9maXJlc3RvcmU7XHJcbiAgICAgICAgdGhpcy5fa2V5ID0gX2tleTtcclxuICAgICAgICB0aGlzLl9kb2N1bWVudCA9IF9kb2N1bWVudDtcclxuICAgICAgICB0aGlzLl9mcm9tQ2FjaGUgPSBfZnJvbUNhY2hlO1xyXG4gICAgICAgIHRoaXMuX2hhc1BlbmRpbmdXcml0ZXMgPSBfaGFzUGVuZGluZ1dyaXRlcztcclxuICAgIH1cclxuICAgIERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLmRhdGEgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnRG9jdW1lbnRTbmFwc2hvdC5kYXRhJywgYXJndW1lbnRzLCAwLCAxKTtcclxuICAgICAgICBvcHRpb25zID0gdmFsaWRhdGVTbmFwc2hvdE9wdGlvbnMoJ0RvY3VtZW50U25hcHNob3QuZGF0YScsIG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5fZG9jdW1lbnRcclxuICAgICAgICAgICAgPyB1bmRlZmluZWRcclxuICAgICAgICAgICAgOiB0aGlzLmNvbnZlcnRPYmplY3QodGhpcy5fZG9jdW1lbnQuZGF0YSwgRmllbGRWYWx1ZU9wdGlvbnMuZnJvbVNuYXBzaG90T3B0aW9ucyhvcHRpb25zLCB0aGlzLl9maXJlc3RvcmUuX2FyZVRpbWVzdGFtcHNJblNuYXBzaG90c0VuYWJsZWQoKSkpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChmaWVsZFBhdGgsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ0RvY3VtZW50U25hcHNob3QuZ2V0JywgYXJndW1lbnRzLCAxLCAyKTtcclxuICAgICAgICBvcHRpb25zID0gdmFsaWRhdGVTbmFwc2hvdE9wdGlvbnMoJ0RvY3VtZW50U25hcHNob3QuZ2V0Jywgb3B0aW9ucyk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX2RvY3VtZW50LmRhdGEuZmllbGQoZmllbGRQYXRoRnJvbUFyZ3VtZW50KCdEb2N1bWVudFNuYXBzaG90LmdldCcsIGZpZWxkUGF0aCkpO1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydFZhbHVlKHZhbHVlLCBGaWVsZFZhbHVlT3B0aW9ucy5mcm9tU25hcHNob3RPcHRpb25zKG9wdGlvbnMsIHRoaXMuX2ZpcmVzdG9yZS5fYXJlVGltZXN0YW1wc0luU25hcHNob3RzRW5hYmxlZCgpKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUsIFwiaWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGgubGFzdFNlZ21lbnQoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZSwgXCJyZWZcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50UmVmZXJlbmNlKHRoaXMuX2tleSwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZSwgXCJleGlzdHNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZG9jdW1lbnQgIT09IG51bGw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUsIFwibWV0YWRhdGFcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFNuYXBzaG90TWV0YWRhdGEodGhpcy5faGFzUGVuZGluZ1dyaXRlcywgdGhpcy5fZnJvbUNhY2hlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIERvY3VtZW50U25hcHNob3QpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludmFsaWRDbGFzc0Vycm9yKCdpc0VxdWFsJywgJ0RvY3VtZW50U25hcHNob3QnLCAxLCBvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAodGhpcy5fZmlyZXN0b3JlID09PSBvdGhlci5fZmlyZXN0b3JlICYmXHJcbiAgICAgICAgICAgIHRoaXMuX2Zyb21DYWNoZSA9PT0gb3RoZXIuX2Zyb21DYWNoZSAmJlxyXG4gICAgICAgICAgICB0aGlzLl9rZXkuaXNFcXVhbChvdGhlci5fa2V5KSAmJlxyXG4gICAgICAgICAgICAodGhpcy5fZG9jdW1lbnQgPT09IG51bGxcclxuICAgICAgICAgICAgICAgID8gb3RoZXIuX2RvY3VtZW50ID09PSBudWxsXHJcbiAgICAgICAgICAgICAgICA6IHRoaXMuX2RvY3VtZW50LmlzRXF1YWwob3RoZXIuX2RvY3VtZW50KSkpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLmNvbnZlcnRPYmplY3QgPSBmdW5jdGlvbiAoZGF0YSwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgICAgIGRhdGEuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IF90aGlzLmNvbnZlcnRWYWx1ZSh2YWx1ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZS5jb252ZXJ0VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUsIG9wdGlvbnMpIHtcclxuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3RWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0T2JqZWN0KHZhbHVlLCBvcHRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRBcnJheSh2YWx1ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgUmVmVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGtleSA9IHZhbHVlLnZhbHVlKG9wdGlvbnMpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YWJhc2UgPSB0aGlzLl9maXJlc3RvcmUuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpLmRhdGFiYXNlSWQoKTtcclxuICAgICAgICAgICAgaWYgKCF2YWx1ZS5kYXRhYmFzZUlkLmlzRXF1YWwoZGF0YWJhc2UpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGIvNjQxMzAyMDIpOiBTb21laG93IHN1cHBvcnQgZm9yZWlnbiByZWZlcmVuY2VzLlxyXG4gICAgICAgICAgICAgICAgZXJyb3IoXCJEb2N1bWVudCBcIiArIHRoaXMuX2tleS5wYXRoICsgXCIgY29udGFpbnMgYSBkb2N1bWVudCBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgXCJyZWZlcmVuY2Ugd2l0aGluIGEgZGlmZmVyZW50IGRhdGFiYXNlIChcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgKHZhbHVlLmRhdGFiYXNlSWQucHJvamVjdElkICsgXCIvXCIgKyB2YWx1ZS5kYXRhYmFzZUlkLmRhdGFiYXNlICsgXCIpIHdoaWNoIGlzIG5vdCBcIikgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwic3VwcG9ydGVkLiBJdCB3aWxsIGJlIHRyZWF0ZWQgYXMgYSByZWZlcmVuY2UgaW4gdGhlIGN1cnJlbnQgXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIChcImRhdGFiYXNlIChcIiArIGRhdGFiYXNlLnByb2plY3RJZCArIFwiL1wiICsgZGF0YWJhc2UuZGF0YWJhc2UgKyBcIikgXCIpICtcclxuICAgICAgICAgICAgICAgICAgICBcImluc3RlYWQuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRSZWZlcmVuY2Uoa2V5LCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnZhbHVlKG9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZS5jb252ZXJ0QXJyYXkgPSBmdW5jdGlvbiAoZGF0YSwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuaW50ZXJuYWxWYWx1ZS5tYXAoZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5jb252ZXJ0VmFsdWUodmFsdWUsIG9wdGlvbnMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEb2N1bWVudFNuYXBzaG90O1xyXG59KCkpO1xyXG52YXIgUXVlcnlEb2N1bWVudFNuYXBzaG90ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUXVlcnlEb2N1bWVudFNuYXBzaG90LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gUXVlcnlEb2N1bWVudFNuYXBzaG90KGZpcmVzdG9yZSwga2V5LCBkb2N1bWVudCwgZnJvbUNhY2hlLCBoYXNQZW5kaW5nV3JpdGVzKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGZpcmVzdG9yZSwga2V5LCBkb2N1bWVudCwgZnJvbUNhY2hlLCBoYXNQZW5kaW5nV3JpdGVzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgUXVlcnlEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZS5kYXRhID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IF9zdXBlci5wcm90b3R5cGUuZGF0YS5jYWxsKHRoaXMsIG9wdGlvbnMpO1xyXG4gICAgICAgIGFzc2VydCh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcsICdEb2N1bWVudCBpbiBhIFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdCBzaG91bGQgZXhpc3QnKTtcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUXVlcnlEb2N1bWVudFNuYXBzaG90O1xyXG59KERvY3VtZW50U25hcHNob3QpKTtcclxudmFyIFF1ZXJ5JDEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBRdWVyeSQkMShfcXVlcnksIGZpcmVzdG9yZSkge1xyXG4gICAgICAgIHRoaXMuX3F1ZXJ5ID0gX3F1ZXJ5O1xyXG4gICAgICAgIHRoaXMuZmlyZXN0b3JlID0gZmlyZXN0b3JlO1xyXG4gICAgfVxyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLndoZXJlID0gZnVuY3Rpb24gKGZpZWxkLCBvcFN0ciwgdmFsdWUpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdRdWVyeS53aGVyZScsIGFyZ3VtZW50cywgMyk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdRdWVyeS53aGVyZScsICdub24tZW1wdHkgc3RyaW5nJywgMiwgb3BTdHIpO1xyXG4gICAgICAgIHZhbGlkYXRlRGVmaW5lZCgnUXVlcnkud2hlcmUnLCAzLCB2YWx1ZSk7XHJcbiAgICAgICAgdmFyIGZpZWxkVmFsdWU7XHJcbiAgICAgICAgdmFyIGZpZWxkUGF0aCA9IGZpZWxkUGF0aEZyb21Bcmd1bWVudCgnUXVlcnkud2hlcmUnLCBmaWVsZCk7XHJcbiAgICAgICAgdmFyIHJlbGF0aW9uT3AgPSBSZWxhdGlvbk9wLmZyb21TdHJpbmcob3BTdHIpO1xyXG4gICAgICAgIGlmIChmaWVsZFBhdGguaXNLZXlGaWVsZCgpKSB7XHJcbiAgICAgICAgICAgIGlmIChyZWxhdGlvbk9wID09PSBSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgUXVlcnkuIFlvdSBjYW4ndCBwZXJmb3JtIGFycmF5LWNvbnRhaW5zIHF1ZXJpZXMgb24gXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICdGaWVsZFBhdGguZG9jdW1lbnRJZCgpIHNpbmNlIGRvY3VtZW50IElEcyBhcmUgbm90IGFycmF5cy4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLmluZGV4T2YoJy8nKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IEFsbG93IHNsYXNoZXMgb25jZSBhbmNlc3RvciBxdWVyaWVzIGFyZSBzdXBwb3J0ZWRcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnRnVuY3Rpb24gUXVlcnkud2hlcmUoKSByZXF1aXJlcyBpdHMgdGhpcmQgcGFyYW1ldGVyIHRvIGJlIGEgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd2YWxpZCBkb2N1bWVudCBJRCBpZiB0aGUgZmlyc3QgcGFyYW1ldGVyIGlzICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnRmllbGRQYXRoLmRvY3VtZW50SWQoKSwgYnV0IGl0IGNvbnRhaW5zIGEgc2xhc2guJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0Z1bmN0aW9uIFF1ZXJ5LndoZXJlKCkgcmVxdWlyZXMgaXRzIHRoaXJkIHBhcmFtZXRlciB0byBiZSBhICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAndmFsaWQgZG9jdW1lbnQgSUQgaWYgdGhlIGZpcnN0IHBhcmFtZXRlciBpcyAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ0ZpZWxkUGF0aC5kb2N1bWVudElkKCksIGJ1dCBpdCB3YXMgYW4gZW1wdHkgc3RyaW5nLicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSB0aGlzLl9xdWVyeS5wYXRoLmNoaWxkKG5ldyBSZXNvdXJjZVBhdGgoW3ZhbHVlXSkpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KHBhdGgubGVuZ3RoICUgMiA9PT0gMCwgJ1BhdGggc2hvdWxkIGJlIGEgZG9jdW1lbnQga2V5Jyk7XHJcbiAgICAgICAgICAgICAgICBmaWVsZFZhbHVlID0gbmV3IFJlZlZhbHVlKHRoaXMuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCBuZXcgRG9jdW1lbnRLZXkocGF0aCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgRG9jdW1lbnRSZWZlcmVuY2UpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZWYgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGZpZWxkVmFsdWUgPSBuZXcgUmVmVmFsdWUodGhpcy5maXJlc3RvcmUuX2RhdGFiYXNlSWQsIHJlZi5fa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gUXVlcnkud2hlcmUoKSByZXF1aXJlcyBpdHMgdGhpcmQgcGFyYW1ldGVyIHRvIGJlIGEgXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwic3RyaW5nIG9yIGEgRG9jdW1lbnRSZWZlcmVuY2UgaWYgdGhlIGZpcnN0IHBhcmFtZXRlciBpcyBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgXCJGaWVsZFBhdGguZG9jdW1lbnRJZCgpLCBidXQgaXQgd2FzOiBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgKHZhbHVlRGVzY3JpcHRpb24odmFsdWUpICsgXCIuXCIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZmllbGRWYWx1ZSA9IHRoaXMuZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlUXVlcnlWYWx1ZSgnUXVlcnkud2hlcmUnLCB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBmaWx0ZXIgPSBGaWx0ZXIuY3JlYXRlKGZpZWxkUGF0aCwgcmVsYXRpb25PcCwgZmllbGRWYWx1ZSk7XHJcbiAgICAgICAgdGhpcy52YWxpZGF0ZU5ld0ZpbHRlcihmaWx0ZXIpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkkJDEodGhpcy5fcXVlcnkuYWRkRmlsdGVyKGZpbHRlciksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUub3JkZXJCeSA9IGZ1bmN0aW9uIChmaWVsZCwgZGlyZWN0aW9uU3RyKSB7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdRdWVyeS5vcmRlckJ5JywgYXJndW1lbnRzLCAxLCAyKTtcclxuICAgICAgICB2YWxpZGF0ZU9wdGlvbmFsQXJnVHlwZSgnUXVlcnkub3JkZXJCeScsICdub24tZW1wdHkgc3RyaW5nJywgMiwgZGlyZWN0aW9uU3RyKTtcclxuICAgICAgICB2YXIgZGlyZWN0aW9uO1xyXG4gICAgICAgIGlmIChkaXJlY3Rpb25TdHIgPT09IHVuZGVmaW5lZCB8fCBkaXJlY3Rpb25TdHIgPT09ICdhc2MnKSB7XHJcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9IERpcmVjdGlvbi5BU0NFTkRJTkc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGRpcmVjdGlvblN0ciA9PT0gJ2Rlc2MnKSB7XHJcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9IERpcmVjdGlvbi5ERVNDRU5ESU5HO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBRdWVyeS5vcmRlckJ5KCkgaGFzIHVua25vd24gZGlyZWN0aW9uICdcIiArIGRpcmVjdGlvblN0ciArIFwiJywgXCIgK1xyXG4gICAgICAgICAgICAgICAgXCJleHBlY3RlZCAnYXNjJyBvciAnZGVzYycuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fcXVlcnkuc3RhcnRBdCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnSW52YWxpZCBxdWVyeS4gWW91IG11c3Qgbm90IGNhbGwgUXVlcnkuc3RhcnRBdCgpIG9yICcgK1xyXG4gICAgICAgICAgICAgICAgJ1F1ZXJ5LnN0YXJ0QWZ0ZXIoKSBiZWZvcmUgY2FsbGluZyBRdWVyeS5vcmRlckJ5KCkuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9xdWVyeS5lbmRBdCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnSW52YWxpZCBxdWVyeS4gWW91IG11c3Qgbm90IGNhbGwgUXVlcnkuZW5kQXQoKSBvciAnICtcclxuICAgICAgICAgICAgICAgICdRdWVyeS5lbmRCZWZvcmUoKSBiZWZvcmUgY2FsbGluZyBRdWVyeS5vcmRlckJ5KCkuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBmaWVsZFBhdGggPSBmaWVsZFBhdGhGcm9tQXJndW1lbnQoJ1F1ZXJ5Lm9yZGVyQnknLCBmaWVsZCk7XHJcbiAgICAgICAgdmFyIG9yZGVyQnkgPSBuZXcgT3JkZXJCeShmaWVsZFBhdGgsIGRpcmVjdGlvbik7XHJcbiAgICAgICAgdGhpcy52YWxpZGF0ZU5ld09yZGVyQnkob3JkZXJCeSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSQkMSh0aGlzLl9xdWVyeS5hZGRPcmRlckJ5KG9yZGVyQnkpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLmxpbWl0ID0gZnVuY3Rpb24gKG4pIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdRdWVyeS5saW1pdCcsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdRdWVyeS5saW1pdCcsICdudW1iZXInLCAxLCBuKTtcclxuICAgICAgICBpZiAobiA8PSAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBRdWVyeS4gUXVlcnkgbGltaXQgKFwiICsgbiArIFwiKSBpcyBpbnZhbGlkLiBMaW1pdCBtdXN0IGJlIFwiICtcclxuICAgICAgICAgICAgICAgICdwb3NpdGl2ZS4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSQkMSh0aGlzLl9xdWVyeS53aXRoTGltaXQobiksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuc3RhcnRBdCA9IGZ1bmN0aW9uIChkb2NPckZpZWxkKSB7XHJcbiAgICAgICAgdmFyIGZpZWxkcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGZpZWxkc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdRdWVyeS5zdGFydEF0JywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YXIgYm91bmQgPSB0aGlzLmJvdW5kRnJvbURvY09yRmllbGRzKCdRdWVyeS5zdGFydEF0JywgZG9jT3JGaWVsZCwgZmllbGRzLCBcclxuICAgICAgICAvKmJlZm9yZT0qLyB0cnVlKTtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5JCQxKHRoaXMuX3F1ZXJ5LndpdGhTdGFydEF0KGJvdW5kKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5zdGFydEFmdGVyID0gZnVuY3Rpb24gKGRvY09yRmllbGQpIHtcclxuICAgICAgICB2YXIgZmllbGRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgZmllbGRzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ1F1ZXJ5LnN0YXJ0QWZ0ZXInLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhciBib3VuZCA9IHRoaXMuYm91bmRGcm9tRG9jT3JGaWVsZHMoJ1F1ZXJ5LnN0YXJ0QWZ0ZXInLCBkb2NPckZpZWxkLCBmaWVsZHMsIFxyXG4gICAgICAgIC8qYmVmb3JlPSovIGZhbHNlKTtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5JCQxKHRoaXMuX3F1ZXJ5LndpdGhTdGFydEF0KGJvdW5kKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5lbmRCZWZvcmUgPSBmdW5jdGlvbiAoZG9jT3JGaWVsZCkge1xyXG4gICAgICAgIHZhciBmaWVsZHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBmaWVsZHNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnUXVlcnkuZW5kQmVmb3JlJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YXIgYm91bmQgPSB0aGlzLmJvdW5kRnJvbURvY09yRmllbGRzKCdRdWVyeS5lbmRCZWZvcmUnLCBkb2NPckZpZWxkLCBmaWVsZHMsIFxyXG4gICAgICAgIC8qYmVmb3JlPSovIHRydWUpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkkJDEodGhpcy5fcXVlcnkud2l0aEVuZEF0KGJvdW5kKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5lbmRBdCA9IGZ1bmN0aW9uIChkb2NPckZpZWxkKSB7XHJcbiAgICAgICAgdmFyIGZpZWxkcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGZpZWxkc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdRdWVyeS5lbmRBdCcsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFyIGJvdW5kID0gdGhpcy5ib3VuZEZyb21Eb2NPckZpZWxkcygnUXVlcnkuZW5kQXQnLCBkb2NPckZpZWxkLCBmaWVsZHMsIFxyXG4gICAgICAgIC8qYmVmb3JlPSovIGZhbHNlKTtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5JCQxKHRoaXMuX3F1ZXJ5LndpdGhFbmRBdChib3VuZCksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgUXVlcnkkJDEpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludmFsaWRDbGFzc0Vycm9yKCdpc0VxdWFsJywgJ1F1ZXJ5JywgMSwgb3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKHRoaXMuZmlyZXN0b3JlID09PSBvdGhlci5maXJlc3RvcmUgJiYgdGhpcy5fcXVlcnkuaXNFcXVhbChvdGhlci5fcXVlcnkpKTtcclxuICAgIH07XHJcbiAgICAvKiogSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIGJvdW5kIGZyb20gYSBkb2N1bWVudCBvciBmaWVsZHMgKi9cclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5ib3VuZEZyb21Eb2NPckZpZWxkcyA9IGZ1bmN0aW9uIChtZXRob2ROYW1lLCBkb2NPckZpZWxkLCBmaWVsZHMsIGJlZm9yZSkge1xyXG4gICAgICAgIHZhbGlkYXRlRGVmaW5lZChtZXRob2ROYW1lLCAxLCBkb2NPckZpZWxkKTtcclxuICAgICAgICBpZiAoZG9jT3JGaWVsZCBpbnN0YW5jZW9mIERvY3VtZW50U25hcHNob3QpIHtcclxuICAgICAgICAgICAgaWYgKGZpZWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIlRvbyBtYW55IGFyZ3VtZW50cyBwcm92aWRlZCB0byBcIiArIG1ldGhvZE5hbWUgKyBcIigpLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgc25hcCA9IGRvY09yRmllbGQ7XHJcbiAgICAgICAgICAgIGlmICghc25hcC5leGlzdHMpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLk5PVF9GT1VORCwgXCJDYW4ndCB1c2UgYSBEb2N1bWVudFNuYXBzaG90IHRoYXQgZG9lc24ndCBleGlzdCBmb3IgXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIChtZXRob2ROYW1lICsgXCIoKS5cIikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvdW5kRnJvbURvY3VtZW50KG1ldGhvZE5hbWUsIHNuYXAuX2RvY3VtZW50LCBiZWZvcmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGFsbEZpZWxkcyA9IFtkb2NPckZpZWxkXS5jb25jYXQoZmllbGRzKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm91bmRGcm9tRmllbGRzKG1ldGhvZE5hbWUsIGFsbEZpZWxkcywgYmVmb3JlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGUgYSBCb3VuZCBmcm9tIGEgcXVlcnkgYW5kIGEgZG9jdW1lbnQuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IHRoZSBCb3VuZCB3aWxsIGFsd2F5cyBpbmNsdWRlIHRoZSBrZXkgb2YgdGhlIGRvY3VtZW50XHJcbiAgICAgKiBhbmQgc28gb25seSB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgd2lsbCBjb21wYXJlIGVxdWFsIHRvIHRoZSByZXR1cm5lZFxyXG4gICAgICogcG9zaXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogV2lsbCB0aHJvdyBpZiB0aGUgZG9jdW1lbnQgZG9lcyBub3QgY29udGFpbiBhbGwgZmllbGRzIG9mIHRoZSBvcmRlciBieVxyXG4gICAgICogb2YgdGhlIHF1ZXJ5LlxyXG4gICAgICovXHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuYm91bmRGcm9tRG9jdW1lbnQgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgZG9jLCBiZWZvcmUpIHtcclxuICAgICAgICB2YXIgY29tcG9uZW50cyA9IFtdO1xyXG4gICAgICAgIC8vIEJlY2F1c2UgcGVvcGxlIGV4cGVjdCB0byBjb250aW51ZS9lbmQgYSBxdWVyeSBhdCB0aGUgZXhhY3QgZG9jdW1lbnRcclxuICAgICAgICAvLyBwcm92aWRlZCwgd2UgbmVlZCB0byB1c2UgdGhlIGltcGxpY2l0IHNvcnQgb3JkZXIgcmF0aGVyIHRoYW4gdGhlIGV4cGxpY2l0XHJcbiAgICAgICAgLy8gc29ydCBvcmRlciwgYmVjYXVzZSBpdCdzIGd1YXJhbnRlZWQgdG8gY29udGFpbiB0aGUgZG9jdW1lbnQga2V5LiBUaGF0IHdheVxyXG4gICAgICAgIC8vIHRoZSBwb3NpdGlvbiBiZWNvbWVzIHVuYW1iaWd1b3VzIGFuZCB0aGUgcXVlcnkgY29udGludWVzL2VuZHMgZXhhY3RseSBhdFxyXG4gICAgICAgIC8vIHRoZSBwcm92aWRlZCBkb2N1bWVudC4gV2l0aG91dCB0aGUga2V5IChieSB1c2luZyB0aGUgZXhwbGljaXQgc29ydFxyXG4gICAgICAgIC8vIG9yZGVycyksIG11bHRpcGxlIGRvY3VtZW50cyBjb3VsZCBtYXRjaCB0aGUgcG9zaXRpb24sIHlpZWxkaW5nIGR1cGxpY2F0ZVxyXG4gICAgICAgIC8vIHJlc3VsdHMuXHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuX3F1ZXJ5Lm9yZGVyQnk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvcmRlckJ5ID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBpZiAob3JkZXJCeS5maWVsZC5pc0tleUZpZWxkKCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudHMucHVzaChuZXcgUmVmVmFsdWUodGhpcy5maXJlc3RvcmUuX2RhdGFiYXNlSWQsIGRvYy5rZXkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRvYy5maWVsZChvcmRlckJ5LmZpZWxkKTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50cy5wdXNoKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZCA9IG9yZGVyQnkuZmllbGQuY2Fub25pY2FsU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHF1ZXJ5LiBZb3UgYXJlIHRyeWluZyB0byBzdGFydCBvciBlbmQgYSBxdWVyeSB1c2luZyBhIFwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKFwiZG9jdW1lbnQgZm9yIHdoaWNoIHRoZSBmaWVsZCAnXCIgKyBmaWVsZCArIFwiJyAodXNlZCBhcyB0aGUgXCIpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvcmRlckJ5KSBkb2VzIG5vdCBleGlzdC5cIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBCb3VuZChjb21wb25lbnRzLCBiZWZvcmUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgYSBsaXN0IG9mIGZpZWxkIHZhbHVlcyB0byBhIEJvdW5kIGZvciB0aGUgZ2l2ZW4gcXVlcnkuXHJcbiAgICAgKi9cclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5ib3VuZEZyb21GaWVsZHMgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgdmFsdWVzJCQxLCBiZWZvcmUpIHtcclxuICAgICAgICAvLyBVc2UgZXhwbGljaXQgb3JkZXIgYnkncyBiZWNhdXNlIGl0IGhhcyB0byBtYXRjaCB0aGUgcXVlcnkgdGhlIHVzZXIgbWFkZVxyXG4gICAgICAgIHZhciBvcmRlckJ5ID0gdGhpcy5fcXVlcnkuZXhwbGljaXRPcmRlckJ5O1xyXG4gICAgICAgIGlmICh2YWx1ZXMkJDEubGVuZ3RoID4gb3JkZXJCeS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJUb28gbWFueSBhcmd1bWVudHMgcHJvdmlkZWQgdG8gXCIgKyBtZXRob2ROYW1lICsgXCIoKS4gXCIgK1xyXG4gICAgICAgICAgICAgICAgXCJUaGUgbnVtYmVyIG9mIGFyZ3VtZW50cyBtdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgXCIgK1xyXG4gICAgICAgICAgICAgICAgXCJudW1iZXIgb2YgUXVlcnkub3JkZXJCeSgpIGNsYXVzZXNcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjb21wb25lbnRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZXMkJDEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHJhd1ZhbHVlID0gdmFsdWVzJCQxW2ldO1xyXG4gICAgICAgICAgICB2YXIgb3JkZXJCeUNvbXBvbmVudCA9IG9yZGVyQnlbaV07XHJcbiAgICAgICAgICAgIGlmIChvcmRlckJ5Q29tcG9uZW50LmZpZWxkLmlzS2V5RmllbGQoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByYXdWYWx1ZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIEV4cGVjdGVkIGEgc3RyaW5nIGZvciBkb2N1bWVudCBJRCBpbiBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChtZXRob2ROYW1lICsgXCIoKSwgYnV0IGdvdCBhIFwiICsgdHlwZW9mIHJhd1ZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocmF3VmFsdWUuaW5kZXhPZignLycpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gRG9jdW1lbnQgSUQgJ1wiICsgcmF3VmFsdWUgKyBcIicgY29udGFpbnMgYSBzbGFzaCBpbiBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChtZXRob2ROYW1lICsgXCIoKVwiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gbmV3IERvY3VtZW50S2V5KHRoaXMuX3F1ZXJ5LnBhdGguY2hpbGQocmF3VmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudHMucHVzaChuZXcgUmVmVmFsdWUodGhpcy5maXJlc3RvcmUuX2RhdGFiYXNlSWQsIGtleSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSB0aGlzLmZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVF1ZXJ5VmFsdWUobWV0aG9kTmFtZSwgcmF3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50cy5wdXNoKHdyYXBwZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgQm91bmQoY29tcG9uZW50cywgYmVmb3JlKTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUub25TbmFwc2hvdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdRdWVyeS5vblNuYXBzaG90JywgYXJndW1lbnRzLCAxLCA0KTtcclxuICAgICAgICB2YXIgb3B0aW9ucyA9IHt9O1xyXG4gICAgICAgIHZhciBvYnNlcnZlcjtcclxuICAgICAgICB2YXIgY3VyckFyZyA9IDA7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBhcmdzW2N1cnJBcmddID09PSAnb2JqZWN0JyAmJlxyXG4gICAgICAgICAgICAhaXNQYXJ0aWFsT2JzZXJ2ZXIoYXJnc1tjdXJyQXJnXSkpIHtcclxuICAgICAgICAgICAgb3B0aW9ucyA9IGFyZ3NbY3VyckFyZ107XHJcbiAgICAgICAgICAgIHZhbGlkYXRlT3B0aW9uTmFtZXMoJ1F1ZXJ5Lm9uU25hcHNob3QnLCBvcHRpb25zLCBbXHJcbiAgICAgICAgICAgICAgICAnaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcydcclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlTmFtZWRPcHRpb25hbFR5cGUoJ1F1ZXJ5Lm9uU25hcHNob3QnLCAnYm9vbGVhbicsICdpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzJywgb3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzKTtcclxuICAgICAgICAgICAgY3VyckFyZysrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNQYXJ0aWFsT2JzZXJ2ZXIoYXJnc1tjdXJyQXJnXSkpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSBhcmdzW2N1cnJBcmddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdRdWVyeS5vblNuYXBzaG90JywgJ2Z1bmN0aW9uJywgY3VyckFyZywgYXJnc1tjdXJyQXJnXSk7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlT3B0aW9uYWxBcmdUeXBlKCdRdWVyeS5vblNuYXBzaG90JywgJ2Z1bmN0aW9uJywgY3VyckFyZyArIDEsIGFyZ3NbY3VyckFyZyArIDFdKTtcclxuICAgICAgICAgICAgdmFsaWRhdGVPcHRpb25hbEFyZ1R5cGUoJ1F1ZXJ5Lm9uU25hcHNob3QnLCAnZnVuY3Rpb24nLCBjdXJyQXJnICsgMiwgYXJnc1tjdXJyQXJnICsgMl0pO1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IHtcclxuICAgICAgICAgICAgICAgIG5leHQ6IGFyZ3NbY3VyckFyZ10sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogYXJnc1tjdXJyQXJnICsgMV0sXHJcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogYXJnc1tjdXJyQXJnICsgMl1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub25TbmFwc2hvdEludGVybmFsKG9wdGlvbnMsIG9ic2VydmVyKTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUub25TbmFwc2hvdEludGVybmFsID0gZnVuY3Rpb24gKG9wdGlvbnMsIG9ic2VydmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZXJySGFuZGxlciA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVW5jYXVnaHQgRXJyb3IgaW4gb25TbmFwc2hvdDonLCBlcnIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKG9ic2VydmVyLmVycm9yKSB7XHJcbiAgICAgICAgICAgIGVyckhhbmRsZXIgPSBvYnNlcnZlci5lcnJvci5iaW5kKG9ic2VydmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGFzeW5jT2JzZXJ2ZXIgPSBuZXcgQXN5bmNPYnNlcnZlcih7XHJcbiAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlci5uZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChuZXcgUXVlcnlTbmFwc2hvdChfdGhpcy5maXJlc3RvcmUsIF90aGlzLl9xdWVyeSwgcmVzdWx0KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiBlcnJIYW5kbGVyXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGZpcmVzdG9yZUNsaWVudCA9IHRoaXMuZmlyZXN0b3JlLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKTtcclxuICAgICAgICB2YXIgaW50ZXJuYWxMaXN0ZW5lciA9IGZpcmVzdG9yZUNsaWVudC5saXN0ZW4odGhpcy5fcXVlcnksIGFzeW5jT2JzZXJ2ZXIsIG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGFzeW5jT2JzZXJ2ZXIubXV0ZSgpO1xyXG4gICAgICAgICAgICBmaXJlc3RvcmVDbGllbnQudW5saXN0ZW4oaW50ZXJuYWxMaXN0ZW5lcik7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnUXVlcnkuZ2V0JywgYXJndW1lbnRzLCAwLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUdldE9wdGlvbnMoJ1F1ZXJ5LmdldCcsIG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuc291cmNlID09PSAnY2FjaGUnKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5maXJlc3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgLmdldERvY3VtZW50c0Zyb21Mb2NhbENhY2hlKF90aGlzLl9xdWVyeSlcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodmlld1NuYXApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG5ldyBRdWVyeVNuYXBzaG90KF90aGlzLmZpcmVzdG9yZSwgX3RoaXMuX3F1ZXJ5LCB2aWV3U25hcCkpO1xyXG4gICAgICAgICAgICAgICAgfSwgcmVqZWN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmdldFZpYVNuYXBzaG90TGlzdGVuZXIocmVzb2x2ZSwgcmVqZWN0LCBvcHRpb25zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5nZXRWaWFTbmFwc2hvdExpc3RlbmVyID0gZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciB1bmxpc3RlbiA9IHRoaXMub25TbmFwc2hvdEludGVybmFsKHtcclxuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogdHJ1ZSxcclxuICAgICAgICAgICAgd2FpdEZvclN5bmNXaGVuT25saW5lOiB0cnVlXHJcbiAgICAgICAgfSwge1xyXG4gICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVlcnkgZmlyc3QgYmVmb3JlIHBhc3NpbmcgZXZlbnQgdG8gdXNlciB0byBhdm9pZFxyXG4gICAgICAgICAgICAgICAgLy8gdXNlciBhY3Rpb25zIGFmZmVjdGluZyB0aGUgbm93IHN0YWxlIHF1ZXJ5LlxyXG4gICAgICAgICAgICAgICAgdW5saXN0ZW4oKTtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubWV0YWRhdGEuZnJvbUNhY2hlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuc291cmNlID09PSAnc2VydmVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTkFWQUlMQUJMRSwgJ0ZhaWxlZCB0byBnZXQgZG9jdW1lbnRzIGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhlc2UgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdkb2N1bWVudHMgbWF5IGV4aXN0IGluIHRoZSBsb2NhbCBjYWNoZS4gUnVuIGFnYWluICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnd2l0aG91dCBzZXR0aW5nIHNvdXJjZSB0byBcInNlcnZlclwiIHRvICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAncmV0cmlldmUgdGhlIGNhY2hlZCBkb2N1bWVudHMuKScpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IHJlamVjdFxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS52YWxpZGF0ZU5ld0ZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICBpZiAoZmlsdGVyIGluc3RhbmNlb2YgUmVsYXRpb25GaWx0ZXIpIHtcclxuICAgICAgICAgICAgaWYgKGZpbHRlci5pc0luZXF1YWxpdHkoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRmllbGQgPSB0aGlzLl9xdWVyeS5nZXRJbmVxdWFsaXR5RmlsdGVyRmllbGQoKTtcclxuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZpZWxkICE9PSBudWxsICYmICFleGlzdGluZ0ZpZWxkLmlzRXF1YWwoZmlsdGVyLmZpZWxkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdJbnZhbGlkIHF1ZXJ5LiBBbGwgd2hlcmUgZmlsdGVycyB3aXRoIGFuIGluZXF1YWxpdHknICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJyAoPCwgPD0sID4sIG9yID49KSBtdXN0IGJlIG9uIHRoZSBzYW1lIGZpZWxkLiBCdXQgeW91IGhhdmUnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKFwiIGluZXF1YWxpdHkgZmlsdGVycyBvbiAnXCIgKyBleGlzdGluZ0ZpZWxkLnRvU3RyaW5nKCkgKyBcIidcIikgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAoXCIgYW5kICdcIiArIGZpbHRlci5maWVsZC50b1N0cmluZygpICsgXCInXCIpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBmaXJzdE9yZGVyQnlGaWVsZCA9IHRoaXMuX3F1ZXJ5LmdldEZpcnN0T3JkZXJCeUZpZWxkKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlyc3RPcmRlckJ5RmllbGQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRlT3JkZXJCeUFuZEluZXF1YWxpdHlNYXRjaChmaWx0ZXIuZmllbGQsIGZpcnN0T3JkZXJCeUZpZWxkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChmaWx0ZXIub3AgPT09IFJlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlMpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9xdWVyeS5oYXNBcnJheUNvbnRhaW5zRmlsdGVyKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnSW52YWxpZCBxdWVyeS4gUXVlcmllcyBvbmx5IHN1cHBvcnQgYSBzaW5nbGUgYXJyYXktY29udGFpbnMgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdmaWx0ZXIuJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLnZhbGlkYXRlTmV3T3JkZXJCeSA9IGZ1bmN0aW9uIChvcmRlckJ5KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3F1ZXJ5LmdldEZpcnN0T3JkZXJCeUZpZWxkKCkgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3Qgb3JkZXIgYnkuIEl0IG11c3QgbWF0Y2ggYW55IGluZXF1YWxpdHkuXHJcbiAgICAgICAgICAgIHZhciBpbmVxdWFsaXR5RmllbGQgPSB0aGlzLl9xdWVyeS5nZXRJbmVxdWFsaXR5RmlsdGVyRmllbGQoKTtcclxuICAgICAgICAgICAgaWYgKGluZXF1YWxpdHlGaWVsZCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZU9yZGVyQnlBbmRJbmVxdWFsaXR5TWF0Y2goaW5lcXVhbGl0eUZpZWxkLCBvcmRlckJ5LmZpZWxkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUudmFsaWRhdGVPcmRlckJ5QW5kSW5lcXVhbGl0eU1hdGNoID0gZnVuY3Rpb24gKGluZXF1YWxpdHksIG9yZGVyQnkpIHtcclxuICAgICAgICBpZiAoIW9yZGVyQnkuaXNFcXVhbChpbmVxdWFsaXR5KSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIFlvdSBoYXZlIGEgd2hlcmUgZmlsdGVyIHdpdGggYW4gaW5lcXVhbGl0eSBcIiArXHJcbiAgICAgICAgICAgICAgICAoXCIoPCwgPD0sID4sIG9yID49KSBvbiBmaWVsZCAnXCIgKyBpbmVxdWFsaXR5LnRvU3RyaW5nKCkgKyBcIicgXCIpICtcclxuICAgICAgICAgICAgICAgIChcImFuZCBzbyB5b3UgbXVzdCBhbHNvIHVzZSAnXCIgKyBpbmVxdWFsaXR5LnRvU3RyaW5nKCkgKyBcIicgXCIpICtcclxuICAgICAgICAgICAgICAgIFwiYXMgeW91ciBmaXJzdCBRdWVyeS5vcmRlckJ5KCksIGJ1dCB5b3VyIGZpcnN0IFF1ZXJ5Lm9yZGVyQnkoKSBcIiArXHJcbiAgICAgICAgICAgICAgICAoXCJpcyBvbiBmaWVsZCAnXCIgKyBvcmRlckJ5LnRvU3RyaW5nKCkgKyBcIicgaW5zdGVhZC5cIikpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gUXVlcnkkJDE7XHJcbn0oKSk7XHJcbnZhciBRdWVyeVNuYXBzaG90ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnlTbmFwc2hvdChfZmlyZXN0b3JlLCBfb3JpZ2luYWxRdWVyeSwgX3NuYXBzaG90KSB7XHJcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gX2ZpcmVzdG9yZTtcclxuICAgICAgICB0aGlzLl9vcmlnaW5hbFF1ZXJ5ID0gX29yaWdpbmFsUXVlcnk7XHJcbiAgICAgICAgdGhpcy5fc25hcHNob3QgPSBfc25hcHNob3Q7XHJcbiAgICAgICAgdGhpcy5fY2FjaGVkQ2hhbmdlcyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubWV0YWRhdGEgPSBuZXcgU25hcHNob3RNZXRhZGF0YShfc25hcHNob3QuaGFzUGVuZGluZ1dyaXRlcywgX3NuYXBzaG90LmZyb21DYWNoZSk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUsIFwiZG9jc1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChkb2MpIHsgcmV0dXJuIHJlc3VsdC5wdXNoKGRvYyk7IH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLCBcImVtcHR5XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NuYXBzaG90LmRvY3MuaXNFbXB0eSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLCBcInNpemVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc25hcHNob3QuZG9jcy5zaXplO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgdGhpc0FyZykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdRdWVyeVNuYXBzaG90LmZvckVhY2gnLCBhcmd1bWVudHMsIDEsIDIpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnUXVlcnlTbmFwc2hvdC5mb3JFYWNoJywgJ2Z1bmN0aW9uJywgMSwgY2FsbGJhY2spO1xyXG4gICAgICAgIHRoaXMuX3NuYXBzaG90LmRvY3MuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgX3RoaXMuY29udmVydFRvRG9jdW1lbnRJbXBsKGRvYykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShRdWVyeVNuYXBzaG90LnByb3RvdHlwZSwgXCJxdWVyeVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUXVlcnkkMSh0aGlzLl9vcmlnaW5hbFF1ZXJ5LCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUuZG9jQ2hhbmdlcyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVPcHRpb25OYW1lcygnUXVlcnlTbmFwc2hvdC5kb2NDaGFuZ2VzJywgb3B0aW9ucywgW1xyXG4gICAgICAgICAgICAgICAgJ2luY2x1ZGVNZXRhZGF0YUNoYW5nZXMnXHJcbiAgICAgICAgICAgIF0pO1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxUeXBlKCdRdWVyeVNuYXBzaG90LmRvY0NoYW5nZXMnLCAnYm9vbGVhbicsICdpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzJywgb3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPSAhIShvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyk7XHJcbiAgICAgICAgaWYgKGluY2x1ZGVNZXRhZGF0YUNoYW5nZXMgJiYgdGhpcy5fc25hcHNob3QuZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1RvIGluY2x1ZGUgbWV0YWRhdGEgY2hhbmdlcyB3aXRoIHlvdXIgZG9jdW1lbnQgY2hhbmdlcywgeW91IG11c3QgJyArXHJcbiAgICAgICAgICAgICAgICAnYWxzbyBwYXNzIHsgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczp0cnVlIH0gdG8gb25TbmFwc2hvdCgpLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuX2NhY2hlZENoYW5nZXMgfHxcclxuICAgICAgICAgICAgdGhpcy5fY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMgIT09IGluY2x1ZGVNZXRhZGF0YUNoYW5nZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5fY2FjaGVkQ2hhbmdlcyA9IGNoYW5nZXNGcm9tU25hcHNob3QodGhpcy5fZmlyZXN0b3JlLCBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzLCB0aGlzLl9zbmFwc2hvdCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlZENoYW5nZXNJbmNsdWRlTWV0YWRhdGFDaGFuZ2VzID0gaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZENoYW5nZXM7XHJcbiAgICB9O1xyXG4gICAgLyoqIENoZWNrIHRoZSBlcXVhbGl0eS4gVGhlIGNhbGwgY2FuIGJlIHZlcnkgZXhwZW5zaXZlLiAqL1xyXG4gICAgUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgUXVlcnlTbmFwc2hvdCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZENsYXNzRXJyb3IoJ2lzRXF1YWwnLCAnUXVlcnlTbmFwc2hvdCcsIDEsIG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLl9maXJlc3RvcmUgPT09IG90aGVyLl9maXJlc3RvcmUgJiZcclxuICAgICAgICAgICAgdGhpcy5fb3JpZ2luYWxRdWVyeS5pc0VxdWFsKG90aGVyLl9vcmlnaW5hbFF1ZXJ5KSAmJlxyXG4gICAgICAgICAgICB0aGlzLl9zbmFwc2hvdC5pc0VxdWFsKG90aGVyLl9zbmFwc2hvdCkpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLmNvbnZlcnRUb0RvY3VtZW50SW1wbCA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdCh0aGlzLl9maXJlc3RvcmUsIGRvYy5rZXksIGRvYywgdGhpcy5tZXRhZGF0YS5mcm9tQ2FjaGUsIHRoaXMuX3NuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyhkb2Mua2V5KSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5U25hcHNob3Q7XHJcbn0oKSk7XHJcbi8vIFRPRE8oMjAxOC8xMS8wMSk6IEFzIG9mIDIwMTgvMDQvMTcgd2UncmUgY2hhbmdpbmcgZG9jQ2hhbmdlcyBmcm9tIGFuIGFycmF5XHJcbi8vIGludG8gYSBtZXRob2QuIEJlY2F1c2UgdGhpcyBpcyBhIHJ1bnRpbWUgYnJlYWtpbmcgY2hhbmdlIGFuZCBzb21ld2hhdCBzdWJ0bGVcclxuLy8gKGJvdGggQXJyYXkgYW5kIEZ1bmN0aW9uIGhhdmUgYSAubGVuZ3RoLCBldGMuKSwgd2UnbGwgcmVwbGFjZSBjb21tb25seS11c2VkXHJcbi8vIHByb3BlcnRpZXMgKGluY2x1ZGluZyBTeW1ib2wuaXRlcmF0b3IpIHRvIHRocm93IGEgY3VzdG9tIGVycm9yIG1lc3NhZ2UuIEluXHJcbi8vIH42IG1vbnRocyB3ZSBjYW4gZGVsZXRlIHRoZSBjdXN0b20gZXJyb3IgYXMgbW9zdCBmb2xrcyB3aWxsIGhhdmUgaG9wZWZ1bGx5XHJcbi8vIG1pZ3JhdGVkLlxyXG5mdW5jdGlvbiB0aHJvd0RvY0NoYW5nZXNNZXRob2RFcnJvcigpIHtcclxuICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdRdWVyeVNuYXBzaG90LmRvY0NoYW5nZXMgaGFzIGJlZW4gY2hhbmdlZCBmcm9tIGEgcHJvcGVydHkgaW50byBhICcgK1xyXG4gICAgICAgICdtZXRob2QsIHNvIHVzYWdlcyBsaWtlIFwicXVlcnlTbmFwc2hvdC5kb2NDaGFuZ2VzXCIgc2hvdWxkIGJlY29tZSAnICtcclxuICAgICAgICAnXCJxdWVyeVNuYXBzaG90LmRvY0NoYW5nZXMoKVwiJyk7XHJcbn1cclxudmFyIGRvY0NoYW5nZXNQcm9wZXJ0aWVzVG9PdmVycmlkZSA9IFtcclxuICAgICdsZW5ndGgnLFxyXG4gICAgJ2ZvckVhY2gnLFxyXG4gICAgJ21hcCdcclxuXS5jb25jYXQoKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnID8gW1N5bWJvbC5pdGVyYXRvcl0gOiBbXSkpO1xyXG5kb2NDaGFuZ2VzUHJvcGVydGllc1RvT3ZlcnJpZGUuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHkpIHtcclxuICAgIC8qKlxyXG4gICAgICogV2UgYXJlIChyZS0pZGVmaW5pbmcgcHJvcGVydGllcyBvbiBRdWVyeVNuYXBzaG90LnByb3RvdHlwZS5kb2NDaGFuZ2VzIHdoaWNoXHJcbiAgICAgKiBpcyBhIEZ1bmN0aW9uLiBUaGlzIGNvdWxkIGZhaWwsIGluIHBhcnRpY3VsYXIgaW4gdGhlIGNhc2Ugb2YgJ2xlbmd0aCcgd2hpY2hcclxuICAgICAqIGFscmVhZHkgZXhpc3RzIG9uIEZ1bmN0aW9uLnByb3RvdHlwZSBhbmQgb24gSUUxMSBpcyBpbXByb3Blcmx5IGRlZmluZWQgd2l0aFxyXG4gICAgICogYHsgY29uZmlndXJhYmxlOiBmYWxzZSB9YC4gU28gd2Ugd3JhcCB0aGlzIGluIGEgdHJ5L2NhdGNoIHRvIGVuc3VyZSB0aGF0IHdlXHJcbiAgICAgKiBzdGlsbCBoYXZlIGEgZnVuY3Rpb25hbCBTREsuXHJcbiAgICAgKi9cclxuICAgIHRyeSB7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLmRvY0NoYW5nZXMsIHByb3BlcnR5LCB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhyb3dEb2NDaGFuZ2VzTWV0aG9kRXJyb3IoKTsgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycikgeyB9IC8vIElnbm9yZSB0aGlzIGZhaWx1cmUgaW50ZW50aW9uYWxseVxyXG59KTtcclxudmFyIENvbGxlY3Rpb25SZWZlcmVuY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhDb2xsZWN0aW9uUmVmZXJlbmNlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQ29sbGVjdGlvblJlZmVyZW5jZShwYXRoLCBmaXJlc3RvcmUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBRdWVyeS5hdFBhdGgocGF0aCksIGZpcmVzdG9yZSkgfHwgdGhpcztcclxuICAgICAgICBpZiAocGF0aC5sZW5ndGggJSAyICE9PSAxKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdJbnZhbGlkIGNvbGxlY3Rpb24gcmVmZXJlbmNlLiBDb2xsZWN0aW9uICcgK1xyXG4gICAgICAgICAgICAgICAgJ3JlZmVyZW5jZXMgbXVzdCBoYXZlIGFuIG9kZCBudW1iZXIgb2Ygc2VnbWVudHMsIGJ1dCAnICtcclxuICAgICAgICAgICAgICAgIChwYXRoLmNhbm9uaWNhbFN0cmluZygpICsgXCIgaGFzIFwiICsgcGF0aC5sZW5ndGgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbGxlY3Rpb25SZWZlcmVuY2UucHJvdG90eXBlLCBcImlkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5LnBhdGgubGFzdFNlZ21lbnQoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xsZWN0aW9uUmVmZXJlbmNlLnByb3RvdHlwZSwgXCJwYXJlbnRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50UGF0aCA9IHRoaXMuX3F1ZXJ5LnBhdGgucG9wTGFzdCgpO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50UGF0aC5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudFJlZmVyZW5jZShuZXcgRG9jdW1lbnRLZXkocGFyZW50UGF0aCksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbGxlY3Rpb25SZWZlcmVuY2UucHJvdG90eXBlLCBcInBhdGhcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcXVlcnkucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIENvbGxlY3Rpb25SZWZlcmVuY2UucHJvdG90eXBlLmRvYyA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nKSB7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdDb2xsZWN0aW9uUmVmZXJlbmNlLmRvYycsIGFyZ3VtZW50cywgMCwgMSk7XHJcbiAgICAgICAgLy8gV2UgYWxsb3cgb21pc3Npb24gb2YgJ3BhdGhTdHJpbmcnIGJ1dCBleHBsaWNpdGx5IHByb2hpYml0IHBhc3NpbmcgaW4gYm90aFxyXG4gICAgICAgIC8vICd1bmRlZmluZWQnIGFuZCAnbnVsbCcuXHJcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcGF0aFN0cmluZyA9IEF1dG9JZC5uZXdJZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0NvbGxlY3Rpb25SZWZlcmVuY2UuZG9jJywgJ25vbi1lbXB0eSBzdHJpbmcnLCAxLCBwYXRoU3RyaW5nKTtcclxuICAgICAgICBpZiAocGF0aFN0cmluZyA9PT0gJycpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0RvY3VtZW50IHBhdGggbXVzdCBiZSBhIG5vbi1lbXB0eSBzdHJpbmcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHBhdGggPSBSZXNvdXJjZVBhdGguZnJvbVN0cmluZyhwYXRoU3RyaW5nKTtcclxuICAgICAgICByZXR1cm4gRG9jdW1lbnRSZWZlcmVuY2UuZm9yUGF0aCh0aGlzLl9xdWVyeS5wYXRoLmNoaWxkKHBhdGgpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvblJlZmVyZW5jZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnQ29sbGVjdGlvblJlZmVyZW5jZS5hZGQnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnQ29sbGVjdGlvblJlZmVyZW5jZS5hZGQnLCAnb2JqZWN0JywgMSwgdmFsdWUpO1xyXG4gICAgICAgIHZhciBkb2NSZWYgPSB0aGlzLmRvYygpO1xyXG4gICAgICAgIHJldHVybiBkb2NSZWYuc2V0KHZhbHVlKS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGRvY1JlZjsgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENvbGxlY3Rpb25SZWZlcmVuY2U7XHJcbn0oUXVlcnkkMSkpO1xyXG5mdW5jdGlvbiB2YWxpZGF0ZVNldE9wdGlvbnMobWV0aG9kTmFtZSwgb3B0aW9ucykge1xyXG4gICAgaWYgKG9wdGlvbnMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG1lcmdlOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICB2YWxpZGF0ZU9wdGlvbk5hbWVzKG1ldGhvZE5hbWUsIG9wdGlvbnMsIFsnbWVyZ2UnLCAnbWVyZ2VGaWVsZHMnXSk7XHJcbiAgICB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxUeXBlKG1ldGhvZE5hbWUsICdib29sZWFuJywgJ21lcmdlJywgb3B0aW9ucy5tZXJnZSk7XHJcbiAgICB2YWxpZGF0ZU9wdGlvbmFsQXJyYXlFbGVtZW50cyhtZXRob2ROYW1lLCAnbWVyZ2VGaWVsZHMnLCAnYSBzdHJpbmcgb3IgYSBGaWVsZFBhdGgnLCBvcHRpb25zLm1lcmdlRmllbGRzLCBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgZWxlbWVudCA9PT0gJ3N0cmluZycgfHwgZWxlbWVudCBpbnN0YW5jZW9mIEZpZWxkUGF0aCQxO1xyXG4gICAgfSk7XHJcbiAgICBpZiAob3B0aW9ucy5tZXJnZUZpZWxkcyAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbnMubWVyZ2UgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBvcHRpb25zIHBhc3NlZCB0byBmdW5jdGlvbiBcIiArIG1ldGhvZE5hbWUgKyBcIigpOiBZb3UgY2Fubm90IHNwZWNpZnkgYm90aCBcXFwibWVyZ2VcXFwiIFwiICtcclxuICAgICAgICAgICAgXCJhbmQgXFxcIm1lcmdlRmllbGRzXFxcIi5cIik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3B0aW9ucztcclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZVNuYXBzaG90T3B0aW9ucyhtZXRob2ROYW1lLCBvcHRpb25zKSB7XHJcbiAgICBpZiAob3B0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgfVxyXG4gICAgdmFsaWRhdGVPcHRpb25OYW1lcyhtZXRob2ROYW1lLCBvcHRpb25zLCBbJ3NlcnZlclRpbWVzdGFtcHMnXSk7XHJcbiAgICB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxQcm9wZXJ0eUVxdWFscyhtZXRob2ROYW1lLCAnb3B0aW9ucycsICdzZXJ2ZXJUaW1lc3RhbXBzJywgb3B0aW9ucy5zZXJ2ZXJUaW1lc3RhbXBzLCBbJ2VzdGltYXRlJywgJ3ByZXZpb3VzJywgJ25vbmUnXSk7XHJcbiAgICByZXR1cm4gb3B0aW9ucztcclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUdldE9wdGlvbnMobWV0aG9kTmFtZSwgb3B0aW9ucykge1xyXG4gICAgdmFsaWRhdGVPcHRpb25hbEFyZ1R5cGUobWV0aG9kTmFtZSwgJ29iamVjdCcsIDEsIG9wdGlvbnMpO1xyXG4gICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICB2YWxpZGF0ZU9wdGlvbk5hbWVzKG1ldGhvZE5hbWUsIG9wdGlvbnMsIFsnc291cmNlJ10pO1xyXG4gICAgICAgIHZhbGlkYXRlTmFtZWRPcHRpb25hbFByb3BlcnR5RXF1YWxzKG1ldGhvZE5hbWUsICdvcHRpb25zJywgJ3NvdXJjZScsIG9wdGlvbnMuc291cmNlLCBbJ2RlZmF1bHQnLCAnc2VydmVyJywgJ2NhY2hlJ10pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlUmVmZXJlbmNlKG1ldGhvZE5hbWUsIGRvY3VtZW50UmVmLCBmaXJlc3RvcmUpIHtcclxuICAgIGlmICghKGRvY3VtZW50UmVmIGluc3RhbmNlb2YgRG9jdW1lbnRSZWZlcmVuY2UpKSB7XHJcbiAgICAgICAgdGhyb3cgaW52YWxpZENsYXNzRXJyb3IobWV0aG9kTmFtZSwgJ0RvY3VtZW50UmVmZXJlbmNlJywgMSwgZG9jdW1lbnRSZWYpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoZG9jdW1lbnRSZWYuZmlyZXN0b3JlICE9PSBmaXJlc3RvcmUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnUHJvdmlkZWQgZG9jdW1lbnQgcmVmZXJlbmNlIGlzIGZyb20gYSBkaWZmZXJlbnQgRmlyZXN0b3JlIGluc3RhbmNlLicpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50UmVmO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBDYWxjdWxhdGVzIHRoZSBhcnJheSBvZiBmaXJlc3RvcmUuRG9jdW1lbnRDaGFuZ2UncyBmb3IgYSBnaXZlbiBWaWV3U25hcHNob3QuXHJcbiAqXHJcbiAqIEV4cG9ydGVkIGZvciB0ZXN0aW5nLlxyXG4gKi9cclxuZnVuY3Rpb24gY2hhbmdlc0Zyb21TbmFwc2hvdChmaXJlc3RvcmUsIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXMsIHNuYXBzaG90KSB7XHJcbiAgICBpZiAoc25hcHNob3Qub2xkRG9jcy5pc0VtcHR5KCkpIHtcclxuICAgICAgICAvLyBTcGVjaWFsIGNhc2UgdGhlIGZpcnN0IHNuYXBzaG90IGJlY2F1c2UgaW5kZXggY2FsY3VsYXRpb24gaXMgZWFzeSBhbmRcclxuICAgICAgICAvLyBmYXN0XHJcbiAgICAgICAgdmFyIGxhc3REb2NfMTtcclxuICAgICAgICB2YXIgaW5kZXhfMSA9IDA7XHJcbiAgICAgICAgcmV0dXJuIHNuYXBzaG90LmRvY0NoYW5nZXMubWFwKGZ1bmN0aW9uIChjaGFuZ2UpIHtcclxuICAgICAgICAgICAgdmFyIGRvYyA9IG5ldyBRdWVyeURvY3VtZW50U25hcHNob3QoZmlyZXN0b3JlLCBjaGFuZ2UuZG9jLmtleSwgY2hhbmdlLmRvYywgc25hcHNob3QuZnJvbUNhY2hlLCBzbmFwc2hvdC5tdXRhdGVkS2V5cy5oYXMoY2hhbmdlLmRvYy5rZXkpKTtcclxuICAgICAgICAgICAgYXNzZXJ0KGNoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLkFkZGVkLCAnSW52YWxpZCBldmVudCB0eXBlIGZvciBmaXJzdCBzbmFwc2hvdCcpO1xyXG4gICAgICAgICAgICBhc3NlcnQoIWxhc3REb2NfMSB8fCBzbmFwc2hvdC5xdWVyeS5kb2NDb21wYXJhdG9yKGxhc3REb2NfMSwgY2hhbmdlLmRvYykgPCAwLCAnR290IGFkZGVkIGV2ZW50cyBpbiB3cm9uZyBvcmRlcicpO1xyXG4gICAgICAgICAgICBsYXN0RG9jXzEgPSBjaGFuZ2UuZG9jO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ2FkZGVkJyxcclxuICAgICAgICAgICAgICAgIGRvYzogZG9jLFxyXG4gICAgICAgICAgICAgICAgb2xkSW5kZXg6IC0xLFxyXG4gICAgICAgICAgICAgICAgbmV3SW5kZXg6IGluZGV4XzErK1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gQSBEb2N1bWVudFNldCB0aGF0IGlzIHVwZGF0ZWQgaW5jcmVtZW50YWxseSBhcyBjaGFuZ2VzIGFyZSBhcHBsaWVkIHRvIHVzZVxyXG4gICAgICAgIC8vIHRvIGxvb2t1cCB0aGUgaW5kZXggb2YgYSBkb2N1bWVudC5cclxuICAgICAgICB2YXIgaW5kZXhUcmFja2VyXzEgPSBzbmFwc2hvdC5vbGREb2NzO1xyXG4gICAgICAgIHJldHVybiBzbmFwc2hvdC5kb2NDaGFuZ2VzXHJcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGNoYW5nZSkgeyByZXR1cm4gaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyB8fCBjaGFuZ2UudHlwZSAhPT0gQ2hhbmdlVHlwZS5NZXRhZGF0YTsgfSlcclxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoY2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHZhciBkb2MgPSBuZXcgUXVlcnlEb2N1bWVudFNuYXBzaG90KGZpcmVzdG9yZSwgY2hhbmdlLmRvYy5rZXksIGNoYW5nZS5kb2MsIHNuYXBzaG90LmZyb21DYWNoZSwgc25hcHNob3QubXV0YXRlZEtleXMuaGFzKGNoYW5nZS5kb2Mua2V5KSk7XHJcbiAgICAgICAgICAgIHZhciBvbGRJbmRleCA9IC0xO1xyXG4gICAgICAgICAgICB2YXIgbmV3SW5kZXggPSAtMTtcclxuICAgICAgICAgICAgaWYgKGNoYW5nZS50eXBlICE9PSBDaGFuZ2VUeXBlLkFkZGVkKSB7XHJcbiAgICAgICAgICAgICAgICBvbGRJbmRleCA9IGluZGV4VHJhY2tlcl8xLmluZGV4T2YoY2hhbmdlLmRvYy5rZXkpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KG9sZEluZGV4ID49IDAsICdJbmRleCBmb3IgZG9jdW1lbnQgbm90IGZvdW5kJyk7XHJcbiAgICAgICAgICAgICAgICBpbmRleFRyYWNrZXJfMSA9IGluZGV4VHJhY2tlcl8xLmRlbGV0ZShjaGFuZ2UuZG9jLmtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNoYW5nZS50eXBlICE9PSBDaGFuZ2VUeXBlLlJlbW92ZWQpIHtcclxuICAgICAgICAgICAgICAgIGluZGV4VHJhY2tlcl8xID0gaW5kZXhUcmFja2VyXzEuYWRkKGNoYW5nZS5kb2MpO1xyXG4gICAgICAgICAgICAgICAgbmV3SW5kZXggPSBpbmRleFRyYWNrZXJfMS5pbmRleE9mKGNoYW5nZS5kb2Mua2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiByZXN1bHRDaGFuZ2VUeXBlKGNoYW5nZS50eXBlKSwgZG9jOiBkb2MsIG9sZEluZGV4OiBvbGRJbmRleCwgbmV3SW5kZXg6IG5ld0luZGV4IH07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVzdWx0Q2hhbmdlVHlwZSh0eXBlKSB7XHJcbiAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICBjYXNlIENoYW5nZVR5cGUuQWRkZWQ6XHJcbiAgICAgICAgICAgIHJldHVybiAnYWRkZWQnO1xyXG4gICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5Nb2RpZmllZDpcclxuICAgICAgICBjYXNlIENoYW5nZVR5cGUuTWV0YWRhdGE6XHJcbiAgICAgICAgICAgIHJldHVybiAnbW9kaWZpZWQnO1xyXG4gICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5SZW1vdmVkOlxyXG4gICAgICAgICAgICByZXR1cm4gJ3JlbW92ZWQnO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIGNoYW5nZSB0eXBlOiAnICsgdHlwZSk7XHJcbiAgICB9XHJcbn1cclxuLy8gRXhwb3J0IHRoZSBjbGFzc2VzIHdpdGggYSBwcml2YXRlIGNvbnN0cnVjdG9yIChpdCB3aWxsIGZhaWwgaWYgaW52b2tlZFxyXG4vLyBhdCBydW50aW1lKS4gTm90ZSB0aGF0IHRoaXMgc3RpbGwgYWxsb3dzIGluc3RhbmNlb2YgY2hlY2tzLlxyXG4vLyBXZSdyZSB0cmVhdGluZyB0aGUgdmFyaWFibGVzIGFzIGNsYXNzIG5hbWVzLCBzbyBkaXNhYmxlIGNoZWNraW5nIGZvciBsb3dlclxyXG4vLyBjYXNlIHZhcmlhYmxlIG5hbWVzLlxyXG4vLyB0c2xpbnQ6ZGlzYWJsZTp2YXJpYWJsZS1uYW1lXHJcbnZhciBQdWJsaWNGaXJlc3RvcmUgPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKEZpcmVzdG9yZSwgJ1VzZSBmaXJlYmFzZS5maXJlc3RvcmUoKSBpbnN0ZWFkLicpO1xyXG52YXIgUHVibGljVHJhbnNhY3Rpb24gPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKFRyYW5zYWN0aW9uJDEsICdVc2UgZmlyZWJhc2UuZmlyZXN0b3JlKCkucnVuVHJhbnNhY3Rpb24oKSBpbnN0ZWFkLicpO1xyXG52YXIgUHVibGljV3JpdGVCYXRjaCA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoV3JpdGVCYXRjaCwgJ1VzZSBmaXJlYmFzZS5maXJlc3RvcmUoKS5iYXRjaCgpIGluc3RlYWQuJyk7XHJcbnZhciBQdWJsaWNEb2N1bWVudFJlZmVyZW5jZSA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoRG9jdW1lbnRSZWZlcmVuY2UsICdVc2UgZmlyZWJhc2UuZmlyZXN0b3JlKCkuZG9jKCkgaW5zdGVhZC4nKTtcclxudmFyIFB1YmxpY0RvY3VtZW50U25hcHNob3QgPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKERvY3VtZW50U25hcHNob3QpO1xyXG52YXIgUHVibGljUXVlcnlEb2N1bWVudFNuYXBzaG90ID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShRdWVyeURvY3VtZW50U25hcHNob3QpO1xyXG52YXIgUHVibGljUXVlcnkgPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKFF1ZXJ5JDEpO1xyXG52YXIgUHVibGljUXVlcnlTbmFwc2hvdCA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoUXVlcnlTbmFwc2hvdCk7XHJcbnZhciBQdWJsaWNDb2xsZWN0aW9uUmVmZXJlbmNlID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShDb2xsZWN0aW9uUmVmZXJlbmNlLCAnVXNlIGZpcmViYXNlLmZpcmVzdG9yZSgpLmNvbGxlY3Rpb24oKSBpbnN0ZWFkLicpO1xyXG4vLyB0c2xpbnQ6ZW5hYmxlOnZhcmlhYmxlLW5hbWVcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBmaXJlc3RvcmVOYW1lc3BhY2UgPSB7XHJcbiAgICBGaXJlc3RvcmU6IFB1YmxpY0ZpcmVzdG9yZSxcclxuICAgIEdlb1BvaW50OiBHZW9Qb2ludCxcclxuICAgIFRpbWVzdGFtcDogVGltZXN0YW1wLFxyXG4gICAgQmxvYjogUHVibGljQmxvYixcclxuICAgIFRyYW5zYWN0aW9uOiBQdWJsaWNUcmFuc2FjdGlvbixcclxuICAgIFdyaXRlQmF0Y2g6IFB1YmxpY1dyaXRlQmF0Y2gsXHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZTogUHVibGljRG9jdW1lbnRSZWZlcmVuY2UsXHJcbiAgICBEb2N1bWVudFNuYXBzaG90OiBQdWJsaWNEb2N1bWVudFNuYXBzaG90LFxyXG4gICAgUXVlcnk6IFB1YmxpY1F1ZXJ5LFxyXG4gICAgUXVlcnlEb2N1bWVudFNuYXBzaG90OiBQdWJsaWNRdWVyeURvY3VtZW50U25hcHNob3QsXHJcbiAgICBRdWVyeVNuYXBzaG90OiBQdWJsaWNRdWVyeVNuYXBzaG90LFxyXG4gICAgQ29sbGVjdGlvblJlZmVyZW5jZTogUHVibGljQ29sbGVjdGlvblJlZmVyZW5jZSxcclxuICAgIEZpZWxkUGF0aDogRmllbGRQYXRoJDEsXHJcbiAgICBGaWVsZFZhbHVlOiBQdWJsaWNGaWVsZFZhbHVlLFxyXG4gICAgc2V0TG9nTGV2ZWw6IEZpcmVzdG9yZS5zZXRMb2dMZXZlbFxyXG59O1xyXG4vKipcclxuICogQ29uZmlndXJlcyBGaXJlc3RvcmUgYXMgcGFydCBvZiB0aGUgRmlyZWJhc2UgU0RLIGJ5IGNhbGxpbmcgcmVnaXN0ZXJTZXJ2aWNlLlxyXG4gKi9cclxuZnVuY3Rpb24gY29uZmlndXJlRm9yRmlyZWJhc2UoZmlyZWJhc2UkJDEpIHtcclxuICAgIGZpcmViYXNlJCQxLklOVEVSTkFMLnJlZ2lzdGVyU2VydmljZSgnZmlyZXN0b3JlJywgZnVuY3Rpb24gKGFwcCkgeyByZXR1cm4gbmV3IEZpcmVzdG9yZShhcHApOyB9LCBzaGFsbG93Q29weShmaXJlc3RvcmVOYW1lc3BhY2UpKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gcmVnaXN0ZXJGaXJlc3RvcmUoaW5zdGFuY2UpIHtcclxuICAgIGNvbmZpZ3VyZUZvckZpcmViYXNlKGluc3RhbmNlKTtcclxufVxyXG5yZWdpc3RlckZpcmVzdG9yZShmaXJlYmFzZSk7XG5cbmV4cG9ydHMucmVnaXN0ZXJGaXJlc3RvcmUgPSByZWdpc3RlckZpcmVzdG9yZTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9AZmlyZWJhc2UvZmlyZXN0b3JlL2Rpc3QvaW5kZXguY2pzLmpzXG4vLyBtb2R1bGUgaWQgPSAzNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEEgY29udGFpbmVyIGZvciBhbGwgb2YgdGhlIExvZ2dlciBpbnN0YW5jZXNcclxuICovXHJcbnZhciBpbnN0YW5jZXMgPSBbXTtcclxuLyoqXHJcbiAqIFRoZSBKUyBTREsgc3VwcG9ydHMgNSBsb2cgbGV2ZWxzIGFuZCBhbHNvIGFsbG93cyBhIHVzZXIgdGhlIGFiaWxpdHkgdG9cclxuICogc2lsZW5jZSB0aGUgbG9ncyBhbHRvZ2V0aGVyLlxyXG4gKlxyXG4gKiBUaGUgb3JkZXIgaXMgYSBmb2xsb3dzOlxyXG4gKiBERUJVRyA8IFZFUkJPU0UgPCBJTkZPIDwgV0FSTiA8IEVSUk9SXHJcbiAqXHJcbiAqIEFsbCBvZiB0aGUgbG9nIHR5cGVzIGFib3ZlIHRoZSBjdXJyZW50IGxvZyBsZXZlbCB3aWxsIGJlIGNhcHR1cmVkIChpLmUuIGlmXHJcbiAqIHlvdSBzZXQgdGhlIGxvZyBsZXZlbCB0byBgSU5GT2AsIGVycm9ycyB3aWxsIHN0aWxsIGJlIGxvZ2dlZCwgYnV0IGBERUJVR2AgYW5kXHJcbiAqIGBWRVJCT1NFYCBsb2dzIHdpbGwgbm90KVxyXG4gKi9cclxudmFyIExvZ0xldmVsO1xyXG4oZnVuY3Rpb24gKExvZ0xldmVsKSB7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIkRFQlVHXCJdID0gMF0gPSBcIkRFQlVHXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIlZFUkJPU0VcIl0gPSAxXSA9IFwiVkVSQk9TRVwiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJJTkZPXCJdID0gMl0gPSBcIklORk9cIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiV0FSTlwiXSA9IDNdID0gXCJXQVJOXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIkVSUk9SXCJdID0gNF0gPSBcIkVSUk9SXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIlNJTEVOVFwiXSA9IDVdID0gXCJTSUxFTlRcIjtcclxufSkoTG9nTGV2ZWwgfHwgKExvZ0xldmVsID0ge30pKTtcclxuLyoqXHJcbiAqIFRoZSBkZWZhdWx0IGxvZyBsZXZlbFxyXG4gKi9cclxudmFyIGRlZmF1bHRMb2dMZXZlbCA9IExvZ0xldmVsLklORk87XHJcbi8qKlxyXG4gKiBUaGUgZGVmYXVsdCBsb2cgaGFuZGxlciB3aWxsIGZvcndhcmQgREVCVUcsIFZFUkJPU0UsIElORk8sIFdBUk4sIGFuZCBFUlJPUlxyXG4gKiBtZXNzYWdlcyBvbiB0byB0aGVpciBjb3JyZXNwb25kaW5nIGNvbnNvbGUgY291bnRlcnBhcnRzIChpZiB0aGUgbG9nIG1ldGhvZFxyXG4gKiBpcyBzdXBwb3J0ZWQgYnkgdGhlIGN1cnJlbnQgbG9nIGxldmVsKVxyXG4gKi9cclxudmFyIGRlZmF1bHRMb2dIYW5kbGVyID0gZnVuY3Rpb24gKGluc3RhbmNlLCBsb2dUeXBlKSB7XHJcbiAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgaWYgKGxvZ1R5cGUgPCBpbnN0YW5jZS5sb2dMZXZlbClcclxuICAgICAgICByZXR1cm47XHJcbiAgICB2YXIgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xyXG4gICAgc3dpdGNoIChsb2dUeXBlKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQnkgZGVmYXVsdCwgYGNvbnNvbGUuZGVidWdgIGlzIG5vdCBkaXNwbGF5ZWQgaW4gdGhlIGRldmVsb3BlciBjb25zb2xlIChpblxyXG4gICAgICAgICAqIGNocm9tZSkuIFRvIGF2b2lkIGZvcmNpbmcgdXNlcnMgdG8gaGF2ZSB0byBvcHQtaW4gdG8gdGhlc2UgbG9ncyB0d2ljZVxyXG4gICAgICAgICAqIChpLmUuIG9uY2UgZm9yIGZpcmViYXNlLCBhbmQgb25jZSBpbiB0aGUgY29uc29sZSksIHdlIGFyZSBzZW5kaW5nIGBERUJVR2BcclxuICAgICAgICAgKiBsb2dzIHRvIHRoZSBgY29uc29sZS5sb2dgIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNhc2UgTG9nTGV2ZWwuREVCVUc6XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIFtcIltcIiArIG5vdyArIFwiXSAgXCIgKyBpbnN0YW5jZS5uYW1lICsgXCI6XCJdLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgTG9nTGV2ZWwuVkVSQk9TRTpcclxuICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgW1wiW1wiICsgbm93ICsgXCJdICBcIiArIGluc3RhbmNlLm5hbWUgKyBcIjpcIl0uY29uY2F0KGFyZ3MpKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5JTkZPOlxyXG4gICAgICAgICAgICBjb25zb2xlLmluZm8uYXBwbHkoY29uc29sZSwgW1wiW1wiICsgbm93ICsgXCJdICBcIiArIGluc3RhbmNlLm5hbWUgKyBcIjpcIl0uY29uY2F0KGFyZ3MpKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5XQVJOOlxyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4uYXBwbHkoY29uc29sZSwgW1wiW1wiICsgbm93ICsgXCJdICBcIiArIGluc3RhbmNlLm5hbWUgKyBcIjpcIl0uY29uY2F0KGFyZ3MpKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5FUlJPUjpcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvci5hcHBseShjb25zb2xlLCBbXCJbXCIgKyBub3cgKyBcIl0gIFwiICsgaW5zdGFuY2UubmFtZSArIFwiOlwiXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gbG9nIGEgbWVzc2FnZSB3aXRoIGFuIGludmFsaWQgbG9nVHlwZSAodmFsdWU6IFwiICsgbG9nVHlwZSArIFwiKVwiKTtcclxuICAgIH1cclxufTtcclxudmFyIExvZ2dlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogR2l2ZXMgeW91IGFuIGluc3RhbmNlIG9mIGEgTG9nZ2VyIHRvIGNhcHR1cmUgbWVzc2FnZXMgYWNjb3JkaW5nIHRvXHJcbiAgICAgKiBGaXJlYmFzZSdzIGxvZ2dpbmcgc2NoZW1lLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIHRoYXQgdGhlIGxvZ3Mgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGhcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gTG9nZ2VyKG5hbWUpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBsb2cgbGV2ZWwgb2YgdGhlIGdpdmVuIExvZ2dlciBpbnN0YW5jZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9sb2dMZXZlbCA9IGRlZmF1bHRMb2dMZXZlbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgbG9nIGhhbmRsZXIgZm9yIHRoZSBMb2dnZXIgaW5zdGFuY2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlciA9IGRlZmF1bHRMb2dIYW5kbGVyO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENhcHR1cmUgdGhlIGN1cnJlbnQgaW5zdGFuY2UgZm9yIGxhdGVyIHVzZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluc3RhbmNlcy5wdXNoKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExvZ2dlci5wcm90b3R5cGUsIFwibG9nTGV2ZWxcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9nTGV2ZWw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICAgICAgaWYgKCEodmFsIGluIExvZ0xldmVsKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB2YWx1ZSBhc3NpZ25lZCB0byBgbG9nTGV2ZWxgJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB2YWw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTG9nZ2VyLnByb3RvdHlwZSwgXCJsb2dIYW5kbGVyXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvZ0hhbmRsZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWwgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1ZhbHVlIGFzc2lnbmVkIHRvIGBsb2dIYW5kbGVyYCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9sb2dIYW5kbGVyID0gdmFsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgZnVuY3Rpb25zIGJlbG93IGFyZSBhbGwgYmFzZWQgb24gdGhlIGBjb25zb2xlYCBpbnRlcmZhY2VcclxuICAgICAqL1xyXG4gICAgTG9nZ2VyLnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBbdGhpcywgTG9nTGV2ZWwuREVCVUddLmNvbmNhdChhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgTG9nZ2VyLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIuYXBwbHkodGhpcywgW3RoaXMsIExvZ0xldmVsLlZFUkJPU0VdLmNvbmNhdChhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgTG9nZ2VyLnByb3RvdHlwZS5pbmZvID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyLmFwcGx5KHRoaXMsIFt0aGlzLCBMb2dMZXZlbC5JTkZPXS5jb25jYXQoYXJncykpO1xyXG4gICAgfTtcclxuICAgIExvZ2dlci5wcm90b3R5cGUud2FybiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBbdGhpcywgTG9nTGV2ZWwuV0FSTl0uY29uY2F0KGFyZ3MpKTtcclxuICAgIH07XHJcbiAgICBMb2dnZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyLmFwcGx5KHRoaXMsIFt0aGlzLCBMb2dMZXZlbC5FUlJPUl0uY29uY2F0KGFyZ3MpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTG9nZ2VyO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gc2V0TG9nTGV2ZWwobGV2ZWwpIHtcclxuICAgIGluc3RhbmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChpbnN0KSB7XHJcbiAgICAgICAgaW5zdC5sb2dMZXZlbCA9IGxldmVsO1xyXG4gICAgfSk7XHJcbn1cblxuZXhwb3J0IHsgc2V0TG9nTGV2ZWwsIExvZ2dlciwgTG9nTGV2ZWwgfTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9AZmlyZWJhc2UvbG9nZ2VyL2Rpc3QvaW5kZXguZXNtLmpzXG4vLyBtb2R1bGUgaWQgPSAzNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgJ3doYXR3Zy1mZXRjaCc7XG5cbi8vIFN0b3JlIHNldFRpbWVvdXQgcmVmZXJlbmNlIHNvIHByb21pc2UtcG9seWZpbGwgd2lsbCBiZSB1bmFmZmVjdGVkIGJ5XG4vLyBvdGhlciBjb2RlIG1vZGlmeWluZyBzZXRUaW1lb3V0IChsaWtlIHNpbm9uLnVzZUZha2VUaW1lcnMoKSlcbnZhciBzZXRUaW1lb3V0RnVuYyA9IHNldFRpbWVvdXQ7XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG4vLyBQb2x5ZmlsbCBmb3IgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmRcbmZ1bmN0aW9uIGJpbmQoZm4sIHRoaXNBcmcpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIGZuLmFwcGx5KHRoaXNBcmcsIGFyZ3VtZW50cyk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIFByb21pc2UoZm4pIHtcbiAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFByb21pc2UpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Byb21pc2VzIG11c3QgYmUgY29uc3RydWN0ZWQgdmlhIG5ldycpO1xuICBpZiAodHlwZW9mIGZuICE9PSAnZnVuY3Rpb24nKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdub3QgYSBmdW5jdGlvbicpO1xuICB0aGlzLl9zdGF0ZSA9IDA7XG4gIHRoaXMuX2hhbmRsZWQgPSBmYWxzZTtcbiAgdGhpcy5fdmFsdWUgPSB1bmRlZmluZWQ7XG4gIHRoaXMuX2RlZmVycmVkcyA9IFtdO1xuXG4gIGRvUmVzb2x2ZShmbiwgdGhpcyk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZShzZWxmLCBkZWZlcnJlZCkge1xuICB3aGlsZSAoc2VsZi5fc3RhdGUgPT09IDMpIHtcbiAgICBzZWxmID0gc2VsZi5fdmFsdWU7XG4gIH1cbiAgaWYgKHNlbGYuX3N0YXRlID09PSAwKSB7XG4gICAgc2VsZi5fZGVmZXJyZWRzLnB1c2goZGVmZXJyZWQpO1xuICAgIHJldHVybjtcbiAgfVxuICBzZWxmLl9oYW5kbGVkID0gdHJ1ZTtcbiAgUHJvbWlzZS5faW1tZWRpYXRlRm4oZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNiID0gc2VsZi5fc3RhdGUgPT09IDEgPyBkZWZlcnJlZC5vbkZ1bGZpbGxlZCA6IGRlZmVycmVkLm9uUmVqZWN0ZWQ7XG4gICAgaWYgKGNiID09PSBudWxsKSB7XG4gICAgICAoc2VsZi5fc3RhdGUgPT09IDEgPyByZXNvbHZlIDogcmVqZWN0KShkZWZlcnJlZC5wcm9taXNlLCBzZWxmLl92YWx1ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciByZXQ7XG4gICAgdHJ5IHtcbiAgICAgIHJldCA9IGNiKHNlbGYuX3ZhbHVlKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZWplY3QoZGVmZXJyZWQucHJvbWlzZSwgZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJlc29sdmUoZGVmZXJyZWQucHJvbWlzZSwgcmV0KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHJlc29sdmUoc2VsZiwgbmV3VmFsdWUpIHtcbiAgdHJ5IHtcbiAgICAvLyBQcm9taXNlIFJlc29sdXRpb24gUHJvY2VkdXJlOiBodHRwczovL2dpdGh1Yi5jb20vcHJvbWlzZXMtYXBsdXMvcHJvbWlzZXMtc3BlYyN0aGUtcHJvbWlzZS1yZXNvbHV0aW9uLXByb2NlZHVyZVxuICAgIGlmIChuZXdWYWx1ZSA9PT0gc2VsZilcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0EgcHJvbWlzZSBjYW5ub3QgYmUgcmVzb2x2ZWQgd2l0aCBpdHNlbGYuJyk7XG4gICAgaWYgKFxuICAgICAgbmV3VmFsdWUgJiZcbiAgICAgICh0eXBlb2YgbmV3VmFsdWUgPT09ICdvYmplY3QnIHx8IHR5cGVvZiBuZXdWYWx1ZSA9PT0gJ2Z1bmN0aW9uJylcbiAgICApIHtcbiAgICAgIHZhciB0aGVuID0gbmV3VmFsdWUudGhlbjtcbiAgICAgIGlmIChuZXdWYWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgc2VsZi5fc3RhdGUgPSAzO1xuICAgICAgICBzZWxmLl92YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICBmaW5hbGUoc2VsZik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZG9SZXNvbHZlKGJpbmQodGhlbiwgbmV3VmFsdWUpLCBzZWxmKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICBzZWxmLl9zdGF0ZSA9IDE7XG4gICAgc2VsZi5fdmFsdWUgPSBuZXdWYWx1ZTtcbiAgICBmaW5hbGUoc2VsZik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZWplY3Qoc2VsZiwgZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVqZWN0KHNlbGYsIG5ld1ZhbHVlKSB7XG4gIHNlbGYuX3N0YXRlID0gMjtcbiAgc2VsZi5fdmFsdWUgPSBuZXdWYWx1ZTtcbiAgZmluYWxlKHNlbGYpO1xufVxuXG5mdW5jdGlvbiBmaW5hbGUoc2VsZikge1xuICBpZiAoc2VsZi5fc3RhdGUgPT09IDIgJiYgc2VsZi5fZGVmZXJyZWRzLmxlbmd0aCA9PT0gMCkge1xuICAgIFByb21pc2UuX2ltbWVkaWF0ZUZuKGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCFzZWxmLl9oYW5kbGVkKSB7XG4gICAgICAgIFByb21pc2UuX3VuaGFuZGxlZFJlamVjdGlvbkZuKHNlbGYuX3ZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBzZWxmLl9kZWZlcnJlZHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBoYW5kbGUoc2VsZiwgc2VsZi5fZGVmZXJyZWRzW2ldKTtcbiAgfVxuICBzZWxmLl9kZWZlcnJlZHMgPSBudWxsO1xufVxuXG5mdW5jdGlvbiBIYW5kbGVyKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkLCBwcm9taXNlKSB7XG4gIHRoaXMub25GdWxmaWxsZWQgPSB0eXBlb2Ygb25GdWxmaWxsZWQgPT09ICdmdW5jdGlvbicgPyBvbkZ1bGZpbGxlZCA6IG51bGw7XG4gIHRoaXMub25SZWplY3RlZCA9IHR5cGVvZiBvblJlamVjdGVkID09PSAnZnVuY3Rpb24nID8gb25SZWplY3RlZCA6IG51bGw7XG4gIHRoaXMucHJvbWlzZSA9IHByb21pc2U7XG59XG5cbi8qKlxuICogVGFrZSBhIHBvdGVudGlhbGx5IG1pc2JlaGF2aW5nIHJlc29sdmVyIGZ1bmN0aW9uIGFuZCBtYWtlIHN1cmVcbiAqIG9uRnVsZmlsbGVkIGFuZCBvblJlamVjdGVkIGFyZSBvbmx5IGNhbGxlZCBvbmNlLlxuICpcbiAqIE1ha2VzIG5vIGd1YXJhbnRlZXMgYWJvdXQgYXN5bmNocm9ueS5cbiAqL1xuZnVuY3Rpb24gZG9SZXNvbHZlKGZuLCBzZWxmKSB7XG4gIHZhciBkb25lID0gZmFsc2U7XG4gIHRyeSB7XG4gICAgZm4oXG4gICAgICBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBpZiAoZG9uZSkgcmV0dXJuO1xuICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgcmVzb2x2ZShzZWxmLCB2YWx1ZSk7XG4gICAgICB9LFxuICAgICAgZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgIGlmIChkb25lKSByZXR1cm47XG4gICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICByZWplY3Qoc2VsZiwgcmVhc29uKTtcbiAgICAgIH1cbiAgICApO1xuICB9IGNhdGNoIChleCkge1xuICAgIGlmIChkb25lKSByZXR1cm47XG4gICAgZG9uZSA9IHRydWU7XG4gICAgcmVqZWN0KHNlbGYsIGV4KTtcbiAgfVxufVxuXG5Qcm9taXNlLnByb3RvdHlwZVsnY2F0Y2gnXSA9IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpIHtcbiAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBvblJlamVjdGVkKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnRoZW4gPSBmdW5jdGlvbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkge1xuICB2YXIgcHJvbSA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG5vb3ApO1xuXG4gIGhhbmRsZSh0aGlzLCBuZXcgSGFuZGxlcihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgcHJvbSkpO1xuICByZXR1cm4gcHJvbTtcbn07XG5cblByb21pc2UucHJvdG90eXBlWydmaW5hbGx5J10gPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICB2YXIgY29uc3RydWN0b3IgPSB0aGlzLmNvbnN0cnVjdG9yO1xuICByZXR1cm4gdGhpcy50aGVuKFxuICAgIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlamVjdChyZWFzb24pO1xuICAgICAgfSk7XG4gICAgfVxuICApO1xufTtcblxuUHJvbWlzZS5hbGwgPSBmdW5jdGlvbihhcnIpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIGlmICghYXJyIHx8IHR5cGVvZiBhcnIubGVuZ3RoID09PSAndW5kZWZpbmVkJylcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Byb21pc2UuYWxsIGFjY2VwdHMgYW4gYXJyYXknKTtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFycik7XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09PSAwKSByZXR1cm4gcmVzb2x2ZShbXSk7XG4gICAgdmFyIHJlbWFpbmluZyA9IGFyZ3MubGVuZ3RoO1xuXG4gICAgZnVuY3Rpb24gcmVzKGksIHZhbCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKHZhbCAmJiAodHlwZW9mIHZhbCA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgICB2YXIgdGhlbiA9IHZhbC50aGVuO1xuICAgICAgICAgIGlmICh0eXBlb2YgdGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhlbi5jYWxsKFxuICAgICAgICAgICAgICB2YWwsXG4gICAgICAgICAgICAgIGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgICAgIHJlcyhpLCB2YWwpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICByZWplY3RcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGFyZ3NbaV0gPSB2YWw7XG4gICAgICAgIGlmICgtLXJlbWFpbmluZyA9PT0gMCkge1xuICAgICAgICAgIHJlc29sdmUoYXJncyk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICAgIHJlamVjdChleCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICByZXMoaSwgYXJnc1tpXSk7XG4gICAgfVxuICB9KTtcbn07XG5cblByb21pc2UucmVzb2x2ZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlLmNvbnN0cnVjdG9yID09PSBQcm9taXNlKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICByZXNvbHZlKHZhbHVlKTtcbiAgfSk7XG59O1xuXG5Qcm9taXNlLnJlamVjdCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICByZWplY3QodmFsdWUpO1xuICB9KTtcbn07XG5cblByb21pc2UucmFjZSA9IGZ1bmN0aW9uKHZhbHVlcykge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHZhbHVlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgdmFsdWVzW2ldLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICB9XG4gIH0pO1xufTtcblxuLy8gVXNlIHBvbHlmaWxsIGZvciBzZXRJbW1lZGlhdGUgZm9yIHBlcmZvcm1hbmNlIGdhaW5zXG5Qcm9taXNlLl9pbW1lZGlhdGVGbiA9XG4gICh0eXBlb2Ygc2V0SW1tZWRpYXRlID09PSAnZnVuY3Rpb24nICYmXG4gICAgZnVuY3Rpb24oZm4pIHtcbiAgICAgIHNldEltbWVkaWF0ZShmbik7XG4gICAgfSkgfHxcbiAgZnVuY3Rpb24oZm4pIHtcbiAgICBzZXRUaW1lb3V0RnVuYyhmbiwgMCk7XG4gIH07XG5cblByb21pc2UuX3VuaGFuZGxlZFJlamVjdGlvbkZuID0gZnVuY3Rpb24gX3VuaGFuZGxlZFJlamVjdGlvbkZuKGVycikge1xuICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUpIHtcbiAgICBjb25zb2xlLndhcm4oJ1Bvc3NpYmxlIFVuaGFuZGxlZCBQcm9taXNlIFJlamVjdGlvbjonLCBlcnIpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgfVxufTtcblxudmFyIGdsb2JhbE5TID0gKGZ1bmN0aW9uKCkge1xuICAvLyB0aGUgb25seSByZWxpYWJsZSBtZWFucyB0byBnZXQgdGhlIGdsb2JhbCBvYmplY3QgaXNcbiAgLy8gYEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKClgXG4gIC8vIEhvd2V2ZXIsIHRoaXMgY2F1c2VzIENTUCB2aW9sYXRpb25zIGluIENocm9tZSBhcHBzLlxuICBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIHNlbGY7XG4gIH1cbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbiAgfVxuICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gZ2xvYmFsO1xuICB9XG4gIHRocm93IG5ldyBFcnJvcigndW5hYmxlIHRvIGxvY2F0ZSBnbG9iYWwgb2JqZWN0Jyk7XG59KSgpO1xuXG5pZiAoIWdsb2JhbE5TLlByb21pc2UpIHtcbiAgZ2xvYmFsTlMuUHJvbWlzZSA9IFByb21pc2U7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZuLCBtb2R1bGUpIHtcblx0cmV0dXJuIG1vZHVsZSA9IHsgZXhwb3J0czoge30gfSwgZm4obW9kdWxlLCBtb2R1bGUuZXhwb3J0cyksIG1vZHVsZS5leHBvcnRzO1xufVxuXG52YXIgX2dsb2JhbCA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHtcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4XG52YXIgZ2xvYmFsID0gbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdy5NYXRoID09IE1hdGhcbiAgPyB3aW5kb3cgOiB0eXBlb2Ygc2VsZiAhPSAndW5kZWZpbmVkJyAmJiBzZWxmLk1hdGggPT0gTWF0aCA/IHNlbGZcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW5ldy1mdW5jXG4gIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbmlmICh0eXBlb2YgX19nID09ICdudW1iZXInKSBfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbn0pO1xuXG52YXIgX2NvcmUgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7XG52YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0geyB2ZXJzaW9uOiAnMi41LjUnIH07XG5pZiAodHlwZW9mIF9fZSA9PSAnbnVtYmVyJykgX19lID0gY29yZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxufSk7XG52YXIgX2NvcmVfMSA9IF9jb3JlLnZlcnNpb247XG5cbnZhciBfaXNPYmplY3QgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIHR5cGVvZiBpdCA9PT0gJ29iamVjdCcgPyBpdCAhPT0gbnVsbCA6IHR5cGVvZiBpdCA9PT0gJ2Z1bmN0aW9uJztcbn07XG5cbnZhciBfYW5PYmplY3QgPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKCFfaXNPYmplY3QoaXQpKSB0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7XG4gIHJldHVybiBpdDtcbn07XG5cbnZhciBfZmFpbHMgPSBmdW5jdGlvbiAoZXhlYykge1xuICB0cnkge1xuICAgIHJldHVybiAhIWV4ZWMoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59O1xuXG4vLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5XG52YXIgX2Rlc2NyaXB0b3JzID0gIV9mYWlscyhmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdhJywgeyBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDc7IH0gfSkuYSAhPSA3O1xufSk7XG5cbnZhciBkb2N1bWVudCA9IF9nbG9iYWwuZG9jdW1lbnQ7XG4vLyB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JyBpbiBvbGQgSUVcbnZhciBpcyA9IF9pc09iamVjdChkb2N1bWVudCkgJiYgX2lzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpO1xudmFyIF9kb21DcmVhdGUgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGlzID8gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChpdCkgOiB7fTtcbn07XG5cbnZhciBfaWU4RG9tRGVmaW5lID0gIV9kZXNjcmlwdG9ycyAmJiAhX2ZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfZG9tQ3JlYXRlKCdkaXYnKSwgJ2EnLCB7IGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gNzsgfSB9KS5hICE9IDc7XG59KTtcblxuLy8gNy4xLjEgVG9QcmltaXRpdmUoaW5wdXQgWywgUHJlZmVycmVkVHlwZV0pXG5cbi8vIGluc3RlYWQgb2YgdGhlIEVTNiBzcGVjIHZlcnNpb24sIHdlIGRpZG4ndCBpbXBsZW1lbnQgQEB0b1ByaW1pdGl2ZSBjYXNlXG4vLyBhbmQgdGhlIHNlY29uZCBhcmd1bWVudCAtIGZsYWcgLSBwcmVmZXJyZWQgdHlwZSBpcyBhIHN0cmluZ1xudmFyIF90b1ByaW1pdGl2ZSA9IGZ1bmN0aW9uIChpdCwgUykge1xuICBpZiAoIV9pc09iamVjdChpdCkpIHJldHVybiBpdDtcbiAgdmFyIGZuLCB2YWw7XG4gIGlmIChTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhX2lzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSkgcmV0dXJuIHZhbDtcbiAgaWYgKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFfaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKSByZXR1cm4gdmFsO1xuICBpZiAoIVMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFfaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKSByZXR1cm4gdmFsO1xuICB0aHJvdyBUeXBlRXJyb3IoXCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWVcIik7XG59O1xuXG52YXIgZFAgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG5cbnZhciBmID0gX2Rlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnR5IDogZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykge1xuICBfYW5PYmplY3QoTyk7XG4gIFAgPSBfdG9QcmltaXRpdmUoUCwgdHJ1ZSk7XG4gIF9hbk9iamVjdChBdHRyaWJ1dGVzKTtcbiAgaWYgKF9pZThEb21EZWZpbmUpIHRyeSB7XG4gICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpO1xuICB9IGNhdGNoIChlKSB7IC8qIGVtcHR5ICovIH1cbiAgaWYgKCdnZXQnIGluIEF0dHJpYnV0ZXMgfHwgJ3NldCcgaW4gQXR0cmlidXRlcykgdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTtcbiAgaWYgKCd2YWx1ZScgaW4gQXR0cmlidXRlcykgT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7XG4gIHJldHVybiBPO1xufTtcblxudmFyIF9vYmplY3REcCA9IHtcblx0ZjogZlxufTtcblxudmFyIF9wcm9wZXJ0eURlc2MgPSBmdW5jdGlvbiAoYml0bWFwLCB2YWx1ZSkge1xuICByZXR1cm4ge1xuICAgIGVudW1lcmFibGU6ICEoYml0bWFwICYgMSksXG4gICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLFxuICAgIHdyaXRhYmxlOiAhKGJpdG1hcCAmIDQpLFxuICAgIHZhbHVlOiB2YWx1ZVxuICB9O1xufTtcblxudmFyIF9oaWRlID0gX2Rlc2NyaXB0b3JzID8gZnVuY3Rpb24gKG9iamVjdCwga2V5LCB2YWx1ZSkge1xuICByZXR1cm4gX29iamVjdERwLmYob2JqZWN0LCBrZXksIF9wcm9wZXJ0eURlc2MoMSwgdmFsdWUpKTtcbn0gOiBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7XG4gIG9iamVjdFtrZXldID0gdmFsdWU7XG4gIHJldHVybiBvYmplY3Q7XG59O1xuXG52YXIgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbnZhciBfaGFzID0gZnVuY3Rpb24gKGl0LCBrZXkpIHtcbiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7XG59O1xuXG52YXIgaWQgPSAwO1xudmFyIHB4ID0gTWF0aC5yYW5kb20oKTtcbnZhciBfdWlkID0gZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gJ1N5bWJvbCgnLmNvbmNhdChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5LCAnKV8nLCAoKytpZCArIHB4KS50b1N0cmluZygzNikpO1xufTtcblxudmFyIF9yZWRlZmluZSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHtcbnZhciBTUkMgPSBfdWlkKCdzcmMnKTtcbnZhciBUT19TVFJJTkcgPSAndG9TdHJpbmcnO1xudmFyICR0b1N0cmluZyA9IEZ1bmN0aW9uW1RPX1NUUklOR107XG52YXIgVFBMID0gKCcnICsgJHRvU3RyaW5nKS5zcGxpdChUT19TVFJJTkcpO1xuXG5fY29yZS5pbnNwZWN0U291cmNlID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiAkdG9TdHJpbmcuY2FsbChpdCk7XG59O1xuXG4obW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoTywga2V5LCB2YWwsIHNhZmUpIHtcbiAgdmFyIGlzRnVuY3Rpb24gPSB0eXBlb2YgdmFsID09ICdmdW5jdGlvbic7XG4gIGlmIChpc0Z1bmN0aW9uKSBfaGFzKHZhbCwgJ25hbWUnKSB8fCBfaGlkZSh2YWwsICduYW1lJywga2V5KTtcbiAgaWYgKE9ba2V5XSA9PT0gdmFsKSByZXR1cm47XG4gIGlmIChpc0Z1bmN0aW9uKSBfaGFzKHZhbCwgU1JDKSB8fCBfaGlkZSh2YWwsIFNSQywgT1trZXldID8gJycgKyBPW2tleV0gOiBUUEwuam9pbihTdHJpbmcoa2V5KSkpO1xuICBpZiAoTyA9PT0gX2dsb2JhbCkge1xuICAgIE9ba2V5XSA9IHZhbDtcbiAgfSBlbHNlIGlmICghc2FmZSkge1xuICAgIGRlbGV0ZSBPW2tleV07XG4gICAgX2hpZGUoTywga2V5LCB2YWwpO1xuICB9IGVsc2UgaWYgKE9ba2V5XSkge1xuICAgIE9ba2V5XSA9IHZhbDtcbiAgfSBlbHNlIHtcbiAgICBfaGlkZShPLCBrZXksIHZhbCk7XG4gIH1cbi8vIGFkZCBmYWtlIEZ1bmN0aW9uI3RvU3RyaW5nIGZvciBjb3JyZWN0IHdvcmsgd3JhcHBlZCBtZXRob2RzIC8gY29uc3RydWN0b3JzIHdpdGggbWV0aG9kcyBsaWtlIExvRGFzaCBpc05hdGl2ZVxufSkoRnVuY3Rpb24ucHJvdG90eXBlLCBUT19TVFJJTkcsIGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICByZXR1cm4gdHlwZW9mIHRoaXMgPT0gJ2Z1bmN0aW9uJyAmJiB0aGlzW1NSQ10gfHwgJHRvU3RyaW5nLmNhbGwodGhpcyk7XG59KTtcbn0pO1xuXG52YXIgX2FGdW5jdGlvbiA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpIHRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgZnVuY3Rpb24hJyk7XG4gIHJldHVybiBpdDtcbn07XG5cbi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZ1xuXG52YXIgX2N0eCA9IGZ1bmN0aW9uIChmbiwgdGhhdCwgbGVuZ3RoKSB7XG4gIF9hRnVuY3Rpb24oZm4pO1xuICBpZiAodGhhdCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZm47XG4gIHN3aXRjaCAobGVuZ3RoKSB7XG4gICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpO1xuICAgIH07XG4gICAgY2FzZSAyOiByZXR1cm4gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIpO1xuICAgIH07XG4gICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpO1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIGZ1bmN0aW9uICgvKiAuLi5hcmdzICovKSB7XG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7XG4gIH07XG59O1xuXG52YXIgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7XG5cbnZhciAkZXhwb3J0ID0gZnVuY3Rpb24gKHR5cGUsIG5hbWUsIHNvdXJjZSkge1xuICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRjtcbiAgdmFyIElTX0dMT0JBTCA9IHR5cGUgJiAkZXhwb3J0Lkc7XG4gIHZhciBJU19TVEFUSUMgPSB0eXBlICYgJGV4cG9ydC5TO1xuICB2YXIgSVNfUFJPVE8gPSB0eXBlICYgJGV4cG9ydC5QO1xuICB2YXIgSVNfQklORCA9IHR5cGUgJiAkZXhwb3J0LkI7XG4gIHZhciB0YXJnZXQgPSBJU19HTE9CQUwgPyBfZ2xvYmFsIDogSVNfU1RBVElDID8gX2dsb2JhbFtuYW1lXSB8fCAoX2dsb2JhbFtuYW1lXSA9IHt9KSA6IChfZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdO1xuICB2YXIgZXhwb3J0cyA9IElTX0dMT0JBTCA/IF9jb3JlIDogX2NvcmVbbmFtZV0gfHwgKF9jb3JlW25hbWVdID0ge30pO1xuICB2YXIgZXhwUHJvdG8gPSBleHBvcnRzW1BST1RPVFlQRV0gfHwgKGV4cG9ydHNbUFJPVE9UWVBFXSA9IHt9KTtcbiAgdmFyIGtleSwgb3duLCBvdXQsIGV4cDtcbiAgaWYgKElTX0dMT0JBTCkgc291cmNlID0gbmFtZTtcbiAgZm9yIChrZXkgaW4gc291cmNlKSB7XG4gICAgLy8gY29udGFpbnMgaW4gbmF0aXZlXG4gICAgb3duID0gIUlTX0ZPUkNFRCAmJiB0YXJnZXQgJiYgdGFyZ2V0W2tleV0gIT09IHVuZGVmaW5lZDtcbiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZFxuICAgIG91dCA9IChvd24gPyB0YXJnZXQgOiBzb3VyY2UpW2tleV07XG4gICAgLy8gYmluZCB0aW1lcnMgdG8gZ2xvYmFsIGZvciBjYWxsIGZyb20gZXhwb3J0IGNvbnRleHRcbiAgICBleHAgPSBJU19CSU5EICYmIG93biA/IF9jdHgob3V0LCBfZ2xvYmFsKSA6IElTX1BST1RPICYmIHR5cGVvZiBvdXQgPT0gJ2Z1bmN0aW9uJyA/IF9jdHgoRnVuY3Rpb24uY2FsbCwgb3V0KSA6IG91dDtcbiAgICAvLyBleHRlbmQgZ2xvYmFsXG4gICAgaWYgKHRhcmdldCkgX3JlZGVmaW5lKHRhcmdldCwga2V5LCBvdXQsIHR5cGUgJiAkZXhwb3J0LlUpO1xuICAgIC8vIGV4cG9ydFxuICAgIGlmIChleHBvcnRzW2tleV0gIT0gb3V0KSBfaGlkZShleHBvcnRzLCBrZXksIGV4cCk7XG4gICAgaWYgKElTX1BST1RPICYmIGV4cFByb3RvW2tleV0gIT0gb3V0KSBleHBQcm90b1trZXldID0gb3V0O1xuICB9XG59O1xuX2dsb2JhbC5jb3JlID0gX2NvcmU7XG4vLyB0eXBlIGJpdG1hcFxuJGV4cG9ydC5GID0gMTsgICAvLyBmb3JjZWRcbiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsXG4kZXhwb3J0LlMgPSA0OyAgIC8vIHN0YXRpY1xuJGV4cG9ydC5QID0gODsgICAvLyBwcm90b1xuJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kXG4kZXhwb3J0LlcgPSAzMjsgIC8vIHdyYXBcbiRleHBvcnQuVSA9IDY0OyAgLy8gc2FmZVxuJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgXG52YXIgX2V4cG9ydCA9ICRleHBvcnQ7XG5cbnZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXG52YXIgX2NvZiA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpO1xufTtcblxuLy8gZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBhbmQgbm9uLWVudW1lcmFibGUgb2xkIFY4IHN0cmluZ3NcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXByb3RvdHlwZS1idWlsdGluc1xudmFyIF9pb2JqZWN0ID0gT2JqZWN0KCd6JykucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIF9jb2YoaXQpID09ICdTdHJpbmcnID8gaXQuc3BsaXQoJycpIDogT2JqZWN0KGl0KTtcbn07XG5cbi8vIDcuMi4xIFJlcXVpcmVPYmplY3RDb2VyY2libGUoYXJndW1lbnQpXG52YXIgX2RlZmluZWQgPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKGl0ID09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gIFwiICsgaXQpO1xuICByZXR1cm4gaXQ7XG59O1xuXG4vLyA3LjEuMTMgVG9PYmplY3QoYXJndW1lbnQpXG5cbnZhciBfdG9PYmplY3QgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIE9iamVjdChfZGVmaW5lZChpdCkpO1xufTtcblxuLy8gNy4xLjQgVG9JbnRlZ2VyXG52YXIgY2VpbCA9IE1hdGguY2VpbDtcbnZhciBmbG9vciA9IE1hdGguZmxvb3I7XG52YXIgX3RvSW50ZWdlciA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTtcbn07XG5cbi8vIDcuMS4xNSBUb0xlbmd0aFxuXG52YXIgbWluID0gTWF0aC5taW47XG52YXIgX3RvTGVuZ3RoID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpdCA+IDAgPyBtaW4oX3RvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDsgLy8gcG93KDIsIDUzKSAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MVxufTtcblxuLy8gNy4yLjIgSXNBcnJheShhcmd1bWVudClcblxudmFyIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZykge1xuICByZXR1cm4gX2NvZihhcmcpID09ICdBcnJheSc7XG59O1xuXG52YXIgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXyc7XG52YXIgc3RvcmUgPSBfZ2xvYmFsW1NIQVJFRF0gfHwgKF9nbG9iYWxbU0hBUkVEXSA9IHt9KTtcbnZhciBfc2hhcmVkID0gZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gc3RvcmVba2V5XSB8fCAoc3RvcmVba2V5XSA9IHt9KTtcbn07XG5cbnZhciBfd2tzID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkge1xudmFyIHN0b3JlID0gX3NoYXJlZCgnd2tzJyk7XG5cbnZhciBTeW1ib2wgPSBfZ2xvYmFsLlN5bWJvbDtcbnZhciBVU0VfU1lNQk9MID0gdHlwZW9mIFN5bWJvbCA9PSAnZnVuY3Rpb24nO1xuXG52YXIgJGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gIHJldHVybiBzdG9yZVtuYW1lXSB8fCAoc3RvcmVbbmFtZV0gPVxuICAgIFVTRV9TWU1CT0wgJiYgU3ltYm9sW25hbWVdIHx8IChVU0VfU1lNQk9MID8gU3ltYm9sIDogX3VpZCkoJ1N5bWJvbC4nICsgbmFtZSkpO1xufTtcblxuJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTtcbn0pO1xuXG52YXIgU1BFQ0lFUyA9IF93a3MoJ3NwZWNpZXMnKTtcblxudmFyIF9hcnJheVNwZWNpZXNDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uIChvcmlnaW5hbCkge1xuICB2YXIgQztcbiAgaWYgKF9pc0FycmF5KG9yaWdpbmFsKSkge1xuICAgIEMgPSBvcmlnaW5hbC5jb25zdHJ1Y3RvcjtcbiAgICAvLyBjcm9zcy1yZWFsbSBmYWxsYmFja1xuICAgIGlmICh0eXBlb2YgQyA9PSAnZnVuY3Rpb24nICYmIChDID09PSBBcnJheSB8fCBfaXNBcnJheShDLnByb3RvdHlwZSkpKSBDID0gdW5kZWZpbmVkO1xuICAgIGlmIChfaXNPYmplY3QoQykpIHtcbiAgICAgIEMgPSBDW1NQRUNJRVNdO1xuICAgICAgaWYgKEMgPT09IG51bGwpIEMgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9IHJldHVybiBDID09PSB1bmRlZmluZWQgPyBBcnJheSA6IEM7XG59O1xuXG4vLyA5LjQuMi4zIEFycmF5U3BlY2llc0NyZWF0ZShvcmlnaW5hbEFycmF5LCBsZW5ndGgpXG5cblxudmFyIF9hcnJheVNwZWNpZXNDcmVhdGUgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGxlbmd0aCkge1xuICByZXR1cm4gbmV3IChfYXJyYXlTcGVjaWVzQ29uc3RydWN0b3Iob3JpZ2luYWwpKShsZW5ndGgpO1xufTtcblxuLy8gMCAtPiBBcnJheSNmb3JFYWNoXG4vLyAxIC0+IEFycmF5I21hcFxuLy8gMiAtPiBBcnJheSNmaWx0ZXJcbi8vIDMgLT4gQXJyYXkjc29tZVxuLy8gNCAtPiBBcnJheSNldmVyeVxuLy8gNSAtPiBBcnJheSNmaW5kXG4vLyA2IC0+IEFycmF5I2ZpbmRJbmRleFxuXG5cblxuXG5cbnZhciBfYXJyYXlNZXRob2RzID0gZnVuY3Rpb24gKFRZUEUsICRjcmVhdGUpIHtcbiAgdmFyIElTX01BUCA9IFRZUEUgPT0gMTtcbiAgdmFyIElTX0ZJTFRFUiA9IFRZUEUgPT0gMjtcbiAgdmFyIElTX1NPTUUgPSBUWVBFID09IDM7XG4gIHZhciBJU19FVkVSWSA9IFRZUEUgPT0gNDtcbiAgdmFyIElTX0ZJTkRfSU5ERVggPSBUWVBFID09IDY7XG4gIHZhciBOT19IT0xFUyA9IFRZUEUgPT0gNSB8fCBJU19GSU5EX0lOREVYO1xuICB2YXIgY3JlYXRlID0gJGNyZWF0ZSB8fCBfYXJyYXlTcGVjaWVzQ3JlYXRlO1xuICByZXR1cm4gZnVuY3Rpb24gKCR0aGlzLCBjYWxsYmFja2ZuLCB0aGF0KSB7XG4gICAgdmFyIE8gPSBfdG9PYmplY3QoJHRoaXMpO1xuICAgIHZhciBzZWxmID0gX2lvYmplY3QoTyk7XG4gICAgdmFyIGYgPSBfY3R4KGNhbGxiYWNrZm4sIHRoYXQsIDMpO1xuICAgIHZhciBsZW5ndGggPSBfdG9MZW5ndGgoc2VsZi5sZW5ndGgpO1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIHJlc3VsdCA9IElTX01BUCA/IGNyZWF0ZSgkdGhpcywgbGVuZ3RoKSA6IElTX0ZJTFRFUiA/IGNyZWF0ZSgkdGhpcywgMCkgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHZhbCwgcmVzO1xuICAgIGZvciAoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKSBpZiAoTk9fSE9MRVMgfHwgaW5kZXggaW4gc2VsZikge1xuICAgICAgdmFsID0gc2VsZltpbmRleF07XG4gICAgICByZXMgPSBmKHZhbCwgaW5kZXgsIE8pO1xuICAgICAgaWYgKFRZUEUpIHtcbiAgICAgICAgaWYgKElTX01BUCkgcmVzdWx0W2luZGV4XSA9IHJlczsgICAvLyBtYXBcbiAgICAgICAgZWxzZSBpZiAocmVzKSBzd2l0Y2ggKFRZUEUpIHtcbiAgICAgICAgICBjYXNlIDM6IHJldHVybiB0cnVlOyAgICAgICAgICAgICAvLyBzb21lXG4gICAgICAgICAgY2FzZSA1OiByZXR1cm4gdmFsOyAgICAgICAgICAgICAgLy8gZmluZFxuICAgICAgICAgIGNhc2UgNjogcmV0dXJuIGluZGV4OyAgICAgICAgICAgIC8vIGZpbmRJbmRleFxuICAgICAgICAgIGNhc2UgMjogcmVzdWx0LnB1c2godmFsKTsgICAgICAgIC8vIGZpbHRlclxuICAgICAgICB9IGVsc2UgaWYgKElTX0VWRVJZKSByZXR1cm4gZmFsc2U7IC8vIGV2ZXJ5XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBJU19GSU5EX0lOREVYID8gLTEgOiBJU19TT01FIHx8IElTX0VWRVJZID8gSVNfRVZFUlkgOiByZXN1bHQ7XG4gIH07XG59O1xuXG4vLyAyMi4xLjMuMzEgQXJyYXkucHJvdG90eXBlW0BAdW5zY29wYWJsZXNdXG52YXIgVU5TQ09QQUJMRVMgPSBfd2tzKCd1bnNjb3BhYmxlcycpO1xudmFyIEFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGU7XG5pZiAoQXJyYXlQcm90b1tVTlNDT1BBQkxFU10gPT0gdW5kZWZpbmVkKSBfaGlkZShBcnJheVByb3RvLCBVTlNDT1BBQkxFUywge30pO1xudmFyIF9hZGRUb1Vuc2NvcGFibGVzID0gZnVuY3Rpb24gKGtleSkge1xuICBBcnJheVByb3RvW1VOU0NPUEFCTEVTXVtrZXldID0gdHJ1ZTtcbn07XG5cbi8vIDIyLjEuMy44IEFycmF5LnByb3RvdHlwZS5maW5kKHByZWRpY2F0ZSwgdGhpc0FyZyA9IHVuZGVmaW5lZClcblxudmFyICRmaW5kID0gX2FycmF5TWV0aG9kcyg1KTtcbnZhciBLRVkgPSAnZmluZCc7XG52YXIgZm9yY2VkID0gdHJ1ZTtcbi8vIFNob3VsZG4ndCBza2lwIGhvbGVzXG5pZiAoS0VZIGluIFtdKSBBcnJheSgxKVtLRVldKGZ1bmN0aW9uICgpIHsgZm9yY2VkID0gZmFsc2U7IH0pO1xuX2V4cG9ydChfZXhwb3J0LlAgKyBfZXhwb3J0LkYgKiBmb3JjZWQsICdBcnJheScsIHtcbiAgZmluZDogZnVuY3Rpb24gZmluZChjYWxsYmFja2ZuIC8qICwgdGhhdCA9IHVuZGVmaW5lZCAqLykge1xuICAgIHJldHVybiAkZmluZCh0aGlzLCBjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7XG4gIH1cbn0pO1xuX2FkZFRvVW5zY29wYWJsZXMoS0VZKTtcblxudmFyIGZpbmQgPSBfY29yZS5BcnJheS5maW5kO1xuXG4vLyAyMi4xLjMuOSBBcnJheS5wcm90b3R5cGUuZmluZEluZGV4KHByZWRpY2F0ZSwgdGhpc0FyZyA9IHVuZGVmaW5lZClcblxudmFyICRmaW5kJDEgPSBfYXJyYXlNZXRob2RzKDYpO1xudmFyIEtFWSQxID0gJ2ZpbmRJbmRleCc7XG52YXIgZm9yY2VkJDEgPSB0cnVlO1xuLy8gU2hvdWxkbid0IHNraXAgaG9sZXNcbmlmIChLRVkkMSBpbiBbXSkgQXJyYXkoMSlbS0VZJDFdKGZ1bmN0aW9uICgpIHsgZm9yY2VkJDEgPSBmYWxzZTsgfSk7XG5fZXhwb3J0KF9leHBvcnQuUCArIF9leHBvcnQuRiAqIGZvcmNlZCQxLCAnQXJyYXknLCB7XG4gIGZpbmRJbmRleDogZnVuY3Rpb24gZmluZEluZGV4KGNhbGxiYWNrZm4gLyogLCB0aGF0ID0gdW5kZWZpbmVkICovKSB7XG4gICAgcmV0dXJuICRmaW5kJDEodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpO1xuICB9XG59KTtcbl9hZGRUb1Vuc2NvcGFibGVzKEtFWSQxKTtcblxudmFyIGZpbmRJbmRleCA9IF9jb3JlLkFycmF5LmZpbmRJbmRleDtcblxuLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzXG5cblxudmFyIF90b0lvYmplY3QgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIF9pb2JqZWN0KF9kZWZpbmVkKGl0KSk7XG59O1xuXG52YXIgbWF4ID0gTWF0aC5tYXg7XG52YXIgbWluJDEgPSBNYXRoLm1pbjtcbnZhciBfdG9BYnNvbHV0ZUluZGV4ID0gZnVuY3Rpb24gKGluZGV4LCBsZW5ndGgpIHtcbiAgaW5kZXggPSBfdG9JbnRlZ2VyKGluZGV4KTtcbiAgcmV0dXJuIGluZGV4IDwgMCA/IG1heChpbmRleCArIGxlbmd0aCwgMCkgOiBtaW4kMShpbmRleCwgbGVuZ3RoKTtcbn07XG5cbi8vIGZhbHNlIC0+IEFycmF5I2luZGV4T2Zcbi8vIHRydWUgIC0+IEFycmF5I2luY2x1ZGVzXG5cblxuXG52YXIgX2FycmF5SW5jbHVkZXMgPSBmdW5jdGlvbiAoSVNfSU5DTFVERVMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgZWwsIGZyb21JbmRleCkge1xuICAgIHZhciBPID0gX3RvSW9iamVjdCgkdGhpcyk7XG4gICAgdmFyIGxlbmd0aCA9IF90b0xlbmd0aChPLmxlbmd0aCk7XG4gICAgdmFyIGluZGV4ID0gX3RvQWJzb2x1dGVJbmRleChmcm9tSW5kZXgsIGxlbmd0aCk7XG4gICAgdmFyIHZhbHVlO1xuICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gICAgaWYgKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKSB3aGlsZSAobGVuZ3RoID4gaW5kZXgpIHtcbiAgICAgIHZhbHVlID0gT1tpbmRleCsrXTtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zZWxmLWNvbXBhcmVcbiAgICAgIGlmICh2YWx1ZSAhPSB2YWx1ZSkgcmV0dXJuIHRydWU7XG4gICAgLy8gQXJyYXkjaW5kZXhPZiBpZ25vcmVzIGhvbGVzLCBBcnJheSNpbmNsdWRlcyAtIG5vdFxuICAgIH0gZWxzZSBmb3IgKDtsZW5ndGggPiBpbmRleDsgaW5kZXgrKykgaWYgKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pIHtcbiAgICAgIGlmIChPW2luZGV4XSA9PT0gZWwpIHJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwO1xuICAgIH0gcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTtcbiAgfTtcbn07XG5cbnZhciBzaGFyZWQgPSBfc2hhcmVkKCdrZXlzJyk7XG5cbnZhciBfc2hhcmVkS2V5ID0gZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gc2hhcmVkW2tleV0gfHwgKHNoYXJlZFtrZXldID0gX3VpZChrZXkpKTtcbn07XG5cbnZhciBhcnJheUluZGV4T2YgPSBfYXJyYXlJbmNsdWRlcyhmYWxzZSk7XG52YXIgSUVfUFJPVE8gPSBfc2hhcmVkS2V5KCdJRV9QUk9UTycpO1xuXG52YXIgX29iamVjdEtleXNJbnRlcm5hbCA9IGZ1bmN0aW9uIChvYmplY3QsIG5hbWVzKSB7XG4gIHZhciBPID0gX3RvSW9iamVjdChvYmplY3QpO1xuICB2YXIgaSA9IDA7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgdmFyIGtleTtcbiAgZm9yIChrZXkgaW4gTykgaWYgKGtleSAhPSBJRV9QUk9UTykgX2hhcyhPLCBrZXkpICYmIHJlc3VsdC5wdXNoKGtleSk7XG4gIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXNcbiAgd2hpbGUgKG5hbWVzLmxlbmd0aCA+IGkpIGlmIChfaGFzKE8sIGtleSA9IG5hbWVzW2krK10pKSB7XG4gICAgfmFycmF5SW5kZXhPZihyZXN1bHQsIGtleSkgfHwgcmVzdWx0LnB1c2goa2V5KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuLy8gSUUgOC0gZG9uJ3QgZW51bSBidWcga2V5c1xudmFyIF9lbnVtQnVnS2V5cyA9IChcbiAgJ2NvbnN0cnVjdG9yLGhhc093blByb3BlcnR5LGlzUHJvdG90eXBlT2YscHJvcGVydHlJc0VudW1lcmFibGUsdG9Mb2NhbGVTdHJpbmcsdG9TdHJpbmcsdmFsdWVPZidcbikuc3BsaXQoJywnKTtcblxuLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pXG5cblxuXG52YXIgX29iamVjdEtleXMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pIHtcbiAgcmV0dXJuIF9vYmplY3RLZXlzSW50ZXJuYWwoTywgX2VudW1CdWdLZXlzKTtcbn07XG5cbnZhciBmJDEgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xuXG52YXIgX29iamVjdEdvcHMgPSB7XG5cdGY6IGYkMVxufTtcblxudmFyIGYkMiA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlO1xuXG52YXIgX29iamVjdFBpZSA9IHtcblx0ZjogZiQyXG59O1xuXG4vLyAxOS4xLjIuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlLCAuLi4pXG5cblxuXG5cblxudmFyICRhc3NpZ24gPSBPYmplY3QuYXNzaWduO1xuXG4vLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZylcbnZhciBfb2JqZWN0QXNzaWduID0gISRhc3NpZ24gfHwgX2ZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgdmFyIEEgPSB7fTtcbiAgdmFyIEIgPSB7fTtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gIHZhciBTID0gU3ltYm9sKCk7XG4gIHZhciBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JztcbiAgQVtTXSA9IDc7XG4gIEsuc3BsaXQoJycpLmZvckVhY2goZnVuY3Rpb24gKGspIHsgQltrXSA9IGs7IH0pO1xuICByZXR1cm4gJGFzc2lnbih7fSwgQSlbU10gIT0gNyB8fCBPYmplY3Qua2V5cygkYXNzaWduKHt9LCBCKSkuam9pbignJykgIT0gSztcbn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgdmFyIFQgPSBfdG9PYmplY3QodGFyZ2V0KTtcbiAgdmFyIGFMZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICB2YXIgaW5kZXggPSAxO1xuICB2YXIgZ2V0U3ltYm9scyA9IF9vYmplY3RHb3BzLmY7XG4gIHZhciBpc0VudW0gPSBfb2JqZWN0UGllLmY7XG4gIHdoaWxlIChhTGVuID4gaW5kZXgpIHtcbiAgICB2YXIgUyA9IF9pb2JqZWN0KGFyZ3VtZW50c1tpbmRleCsrXSk7XG4gICAgdmFyIGtleXMgPSBnZXRTeW1ib2xzID8gX29iamVjdEtleXMoUykuY29uY2F0KGdldFN5bWJvbHMoUykpIDogX29iamVjdEtleXMoUyk7XG4gICAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIHZhciBqID0gMDtcbiAgICB2YXIga2V5O1xuICAgIHdoaWxlIChsZW5ndGggPiBqKSBpZiAoaXNFbnVtLmNhbGwoUywga2V5ID0ga2V5c1tqKytdKSkgVFtrZXldID0gU1trZXldO1xuICB9IHJldHVybiBUO1xufSA6ICRhc3NpZ247XG5cbi8vIDE5LjEuMy4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UpXG5cblxuX2V4cG9ydChfZXhwb3J0LlMgKyBfZXhwb3J0LkYsICdPYmplY3QnLCB7IGFzc2lnbjogX29iamVjdEFzc2lnbiB9KTtcblxudmFyIGFzc2lnbiA9IF9jb3JlLk9iamVjdC5hc3NpZ247XG5cbi8vIDcuMi44IElzUmVnRXhwKGFyZ3VtZW50KVxuXG5cbnZhciBNQVRDSCA9IF93a3MoJ21hdGNoJyk7XG52YXIgX2lzUmVnZXhwID0gZnVuY3Rpb24gKGl0KSB7XG4gIHZhciBpc1JlZ0V4cDtcbiAgcmV0dXJuIF9pc09iamVjdChpdCkgJiYgKChpc1JlZ0V4cCA9IGl0W01BVENIXSkgIT09IHVuZGVmaW5lZCA/ICEhaXNSZWdFeHAgOiBfY29mKGl0KSA9PSAnUmVnRXhwJyk7XG59O1xuXG4vLyBoZWxwZXIgZm9yIFN0cmluZyN7c3RhcnRzV2l0aCwgZW5kc1dpdGgsIGluY2x1ZGVzfVxuXG5cblxudmFyIF9zdHJpbmdDb250ZXh0ID0gZnVuY3Rpb24gKHRoYXQsIHNlYXJjaFN0cmluZywgTkFNRSkge1xuICBpZiAoX2lzUmVnZXhwKHNlYXJjaFN0cmluZykpIHRocm93IFR5cGVFcnJvcignU3RyaW5nIycgKyBOQU1FICsgXCIgZG9lc24ndCBhY2NlcHQgcmVnZXghXCIpO1xuICByZXR1cm4gU3RyaW5nKF9kZWZpbmVkKHRoYXQpKTtcbn07XG5cbnZhciBNQVRDSCQxID0gX3drcygnbWF0Y2gnKTtcbnZhciBfZmFpbHNJc1JlZ2V4cCA9IGZ1bmN0aW9uIChLRVkpIHtcbiAgdmFyIHJlID0gLy4vO1xuICB0cnkge1xuICAgICcvLi8nW0tFWV0ocmUpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJlW01BVENIJDFdID0gZmFsc2U7XG4gICAgICByZXR1cm4gIScvLi8nW0tFWV0ocmUpO1xuICAgIH0gY2F0Y2ggKGYpIHsgLyogZW1wdHkgKi8gfVxuICB9IHJldHVybiB0cnVlO1xufTtcblxudmFyIFNUQVJUU19XSVRIID0gJ3N0YXJ0c1dpdGgnO1xudmFyICRzdGFydHNXaXRoID0gJydbU1RBUlRTX1dJVEhdO1xuXG5fZXhwb3J0KF9leHBvcnQuUCArIF9leHBvcnQuRiAqIF9mYWlsc0lzUmVnZXhwKFNUQVJUU19XSVRIKSwgJ1N0cmluZycsIHtcbiAgc3RhcnRzV2l0aDogZnVuY3Rpb24gc3RhcnRzV2l0aChzZWFyY2hTdHJpbmcgLyogLCBwb3NpdGlvbiA9IDAgKi8pIHtcbiAgICB2YXIgdGhhdCA9IF9zdHJpbmdDb250ZXh0KHRoaXMsIHNlYXJjaFN0cmluZywgU1RBUlRTX1dJVEgpO1xuICAgIHZhciBpbmRleCA9IF90b0xlbmd0aChNYXRoLm1pbihhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCwgdGhhdC5sZW5ndGgpKTtcbiAgICB2YXIgc2VhcmNoID0gU3RyaW5nKHNlYXJjaFN0cmluZyk7XG4gICAgcmV0dXJuICRzdGFydHNXaXRoXG4gICAgICA/ICRzdGFydHNXaXRoLmNhbGwodGhhdCwgc2VhcmNoLCBpbmRleClcbiAgICAgIDogdGhhdC5zbGljZShpbmRleCwgaW5kZXggKyBzZWFyY2gubGVuZ3RoKSA9PT0gc2VhcmNoO1xuICB9XG59KTtcblxudmFyIHN0YXJ0c1dpdGggPSBfY29yZS5TdHJpbmcuc3RhcnRzV2l0aDtcblxudmFyIF9zdHJpbmdSZXBlYXQgPSBmdW5jdGlvbiByZXBlYXQoY291bnQpIHtcbiAgdmFyIHN0ciA9IFN0cmluZyhfZGVmaW5lZCh0aGlzKSk7XG4gIHZhciByZXMgPSAnJztcbiAgdmFyIG4gPSBfdG9JbnRlZ2VyKGNvdW50KTtcbiAgaWYgKG4gPCAwIHx8IG4gPT0gSW5maW5pdHkpIHRocm93IFJhbmdlRXJyb3IoXCJDb3VudCBjYW4ndCBiZSBuZWdhdGl2ZVwiKTtcbiAgZm9yICg7biA+IDA7IChuID4+Pj0gMSkgJiYgKHN0ciArPSBzdHIpKSBpZiAobiAmIDEpIHJlcyArPSBzdHI7XG4gIHJldHVybiByZXM7XG59O1xuXG5fZXhwb3J0KF9leHBvcnQuUCwgJ1N0cmluZycsIHtcbiAgLy8gMjEuMS4zLjEzIFN0cmluZy5wcm90b3R5cGUucmVwZWF0KGNvdW50KVxuICByZXBlYXQ6IF9zdHJpbmdSZXBlYXRcbn0pO1xuXG52YXIgcmVwZWF0ID0gX2NvcmUuU3RyaW5nLnJlcGVhdDtcblxudmFyIF9tZXRhID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkge1xudmFyIE1FVEEgPSBfdWlkKCdtZXRhJyk7XG5cblxudmFyIHNldERlc2MgPSBfb2JqZWN0RHAuZjtcbnZhciBpZCA9IDA7XG52YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZSB8fCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0cnVlO1xufTtcbnZhciBGUkVFWkUgPSAhX2ZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGlzRXh0ZW5zaWJsZShPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKTtcbn0pO1xudmFyIHNldE1ldGEgPSBmdW5jdGlvbiAoaXQpIHtcbiAgc2V0RGVzYyhpdCwgTUVUQSwgeyB2YWx1ZToge1xuICAgIGk6ICdPJyArICsraWQsIC8vIG9iamVjdCBJRFxuICAgIHc6IHt9ICAgICAgICAgIC8vIHdlYWsgY29sbGVjdGlvbnMgSURzXG4gIH0gfSk7XG59O1xudmFyIGZhc3RLZXkgPSBmdW5jdGlvbiAoaXQsIGNyZWF0ZSkge1xuICAvLyByZXR1cm4gcHJpbWl0aXZlIHdpdGggcHJlZml4XG4gIGlmICghX2lzT2JqZWN0KGl0KSkgcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJyA/IGl0IDogKHR5cGVvZiBpdCA9PSAnc3RyaW5nJyA/ICdTJyA6ICdQJykgKyBpdDtcbiAgaWYgKCFfaGFzKGl0LCBNRVRBKSkge1xuICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0XG4gICAgaWYgKCFpc0V4dGVuc2libGUoaXQpKSByZXR1cm4gJ0YnO1xuICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhXG4gICAgaWYgKCFjcmVhdGUpIHJldHVybiAnRSc7XG4gICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGFcbiAgICBzZXRNZXRhKGl0KTtcbiAgLy8gcmV0dXJuIG9iamVjdCBJRFxuICB9IHJldHVybiBpdFtNRVRBXS5pO1xufTtcbnZhciBnZXRXZWFrID0gZnVuY3Rpb24gKGl0LCBjcmVhdGUpIHtcbiAgaWYgKCFfaGFzKGl0LCBNRVRBKSkge1xuICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0XG4gICAgaWYgKCFpc0V4dGVuc2libGUoaXQpKSByZXR1cm4gdHJ1ZTtcbiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YVxuICAgIGlmICghY3JlYXRlKSByZXR1cm4gZmFsc2U7XG4gICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGFcbiAgICBzZXRNZXRhKGl0KTtcbiAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHNcbiAgfSByZXR1cm4gaXRbTUVUQV0udztcbn07XG4vLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmdcbnZhciBvbkZyZWV6ZSA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoRlJFRVpFICYmIG1ldGEuTkVFRCAmJiBpc0V4dGVuc2libGUoaXQpICYmICFfaGFzKGl0LCBNRVRBKSkgc2V0TWV0YShpdCk7XG4gIHJldHVybiBpdDtcbn07XG52YXIgbWV0YSA9IG1vZHVsZS5leHBvcnRzID0ge1xuICBLRVk6IE1FVEEsXG4gIE5FRUQ6IGZhbHNlLFxuICBmYXN0S2V5OiBmYXN0S2V5LFxuICBnZXRXZWFrOiBnZXRXZWFrLFxuICBvbkZyZWV6ZTogb25GcmVlemVcbn07XG59KTtcbnZhciBfbWV0YV8xID0gX21ldGEuS0VZO1xudmFyIF9tZXRhXzIgPSBfbWV0YS5ORUVEO1xudmFyIF9tZXRhXzMgPSBfbWV0YS5mYXN0S2V5O1xudmFyIF9tZXRhXzQgPSBfbWV0YS5nZXRXZWFrO1xudmFyIF9tZXRhXzUgPSBfbWV0YS5vbkZyZWV6ZTtcblxudmFyIGRlZiA9IF9vYmplY3REcC5mO1xuXG52YXIgVEFHID0gX3drcygndG9TdHJpbmdUYWcnKTtcblxudmFyIF9zZXRUb1N0cmluZ1RhZyA9IGZ1bmN0aW9uIChpdCwgdGFnLCBzdGF0KSB7XG4gIGlmIChpdCAmJiAhX2hhcyhpdCA9IHN0YXQgPyBpdCA6IGl0LnByb3RvdHlwZSwgVEFHKSkgZGVmKGl0LCBUQUcsIHsgY29uZmlndXJhYmxlOiB0cnVlLCB2YWx1ZTogdGFnIH0pO1xufTtcblxudmFyIGYkMyA9IF93a3M7XG5cbnZhciBfd2tzRXh0ID0ge1xuXHRmOiBmJDNcbn07XG5cbnZhciBfbGlicmFyeSA9IGZhbHNlO1xuXG52YXIgZGVmaW5lUHJvcGVydHkgPSBfb2JqZWN0RHAuZjtcbnZhciBfd2tzRGVmaW5lID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgdmFyICRTeW1ib2wgPSBfY29yZS5TeW1ib2wgfHwgKF9jb3JlLlN5bWJvbCA9IF9saWJyYXJ5ID8ge30gOiBfZ2xvYmFsLlN5bWJvbCB8fCB7fSk7XG4gIGlmIChuYW1lLmNoYXJBdCgwKSAhPSAnXycgJiYgIShuYW1lIGluICRTeW1ib2wpKSBkZWZpbmVQcm9wZXJ0eSgkU3ltYm9sLCBuYW1lLCB7IHZhbHVlOiBfd2tzRXh0LmYobmFtZSkgfSk7XG59O1xuXG4vLyBhbGwgZW51bWVyYWJsZSBvYmplY3Qga2V5cywgaW5jbHVkZXMgc3ltYm9sc1xuXG5cblxudmFyIF9lbnVtS2V5cyA9IGZ1bmN0aW9uIChpdCkge1xuICB2YXIgcmVzdWx0ID0gX29iamVjdEtleXMoaXQpO1xuICB2YXIgZ2V0U3ltYm9scyA9IF9vYmplY3RHb3BzLmY7XG4gIGlmIChnZXRTeW1ib2xzKSB7XG4gICAgdmFyIHN5bWJvbHMgPSBnZXRTeW1ib2xzKGl0KTtcbiAgICB2YXIgaXNFbnVtID0gX29iamVjdFBpZS5mO1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIga2V5O1xuICAgIHdoaWxlIChzeW1ib2xzLmxlbmd0aCA+IGkpIGlmIChpc0VudW0uY2FsbChpdCwga2V5ID0gc3ltYm9sc1tpKytdKSkgcmVzdWx0LnB1c2goa2V5KTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcblxudmFyIF9vYmplY3REcHMgPSBfZGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcykge1xuICBfYW5PYmplY3QoTyk7XG4gIHZhciBrZXlzID0gX29iamVjdEtleXMoUHJvcGVydGllcyk7XG4gIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDtcbiAgdmFyIGkgPSAwO1xuICB2YXIgUDtcbiAgd2hpbGUgKGxlbmd0aCA+IGkpIF9vYmplY3REcC5mKE8sIFAgPSBrZXlzW2krK10sIFByb3BlcnRpZXNbUF0pO1xuICByZXR1cm4gTztcbn07XG5cbnZhciBkb2N1bWVudCQxID0gX2dsb2JhbC5kb2N1bWVudDtcbnZhciBfaHRtbCA9IGRvY3VtZW50JDEgJiYgZG9jdW1lbnQkMS5kb2N1bWVudEVsZW1lbnQ7XG5cbi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKVxuXG5cblxudmFyIElFX1BST1RPJDEgPSBfc2hhcmVkS2V5KCdJRV9QUk9UTycpO1xudmFyIEVtcHR5ID0gZnVuY3Rpb24gKCkgeyAvKiBlbXB0eSAqLyB9O1xudmFyIFBST1RPVFlQRSQxID0gJ3Byb3RvdHlwZSc7XG5cbi8vIENyZWF0ZSBvYmplY3Qgd2l0aCBmYWtlIGBudWxsYCBwcm90b3R5cGU6IHVzZSBpZnJhbWUgT2JqZWN0IHdpdGggY2xlYXJlZCBwcm90b3R5cGVcbnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24gKCkge1xuICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1Z1xuICB2YXIgaWZyYW1lID0gX2RvbUNyZWF0ZSgnaWZyYW1lJyk7XG4gIHZhciBpID0gX2VudW1CdWdLZXlzLmxlbmd0aDtcbiAgdmFyIGx0ID0gJzwnO1xuICB2YXIgZ3QgPSAnPic7XG4gIHZhciBpZnJhbWVEb2N1bWVudDtcbiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIF9odG1sLmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gIGlmcmFtZS5zcmMgPSAnamF2YXNjcmlwdDonOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNjcmlwdC11cmxcbiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDtcbiAgLy8gaHRtbC5yZW1vdmVDaGlsZChpZnJhbWUpO1xuICBpZnJhbWVEb2N1bWVudCA9IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50O1xuICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7XG4gIGlmcmFtZURvY3VtZW50LndyaXRlKGx0ICsgJ3NjcmlwdCcgKyBndCArICdkb2N1bWVudC5GPU9iamVjdCcgKyBsdCArICcvc2NyaXB0JyArIGd0KTtcbiAgaWZyYW1lRG9jdW1lbnQuY2xvc2UoKTtcbiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7XG4gIHdoaWxlIChpLS0pIGRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRSQxXVtfZW51bUJ1Z0tleXNbaV1dO1xuICByZXR1cm4gY3JlYXRlRGljdCgpO1xufTtcblxudmFyIF9vYmplY3RDcmVhdGUgPSBPYmplY3QuY3JlYXRlIHx8IGZ1bmN0aW9uIGNyZWF0ZShPLCBQcm9wZXJ0aWVzKSB7XG4gIHZhciByZXN1bHQ7XG4gIGlmIChPICE9PSBudWxsKSB7XG4gICAgRW1wdHlbUFJPVE9UWVBFJDFdID0gX2FuT2JqZWN0KE8pO1xuICAgIHJlc3VsdCA9IG5ldyBFbXB0eSgpO1xuICAgIEVtcHR5W1BST1RPVFlQRSQxXSA9IG51bGw7XG4gICAgLy8gYWRkIFwiX19wcm90b19fXCIgZm9yIE9iamVjdC5nZXRQcm90b3R5cGVPZiBwb2x5ZmlsbFxuICAgIHJlc3VsdFtJRV9QUk9UTyQxXSA9IE87XG4gIH0gZWxzZSByZXN1bHQgPSBjcmVhdGVEaWN0KCk7XG4gIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBfb2JqZWN0RHBzKHJlc3VsdCwgUHJvcGVydGllcyk7XG59O1xuXG4vLyAxOS4xLjIuNyAvIDE1LjIuMy40IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE8pXG5cbnZhciBoaWRkZW5LZXlzID0gX2VudW1CdWdLZXlzLmNvbmNhdCgnbGVuZ3RoJywgJ3Byb3RvdHlwZScpO1xuXG52YXIgZiQ0ID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhPKSB7XG4gIHJldHVybiBfb2JqZWN0S2V5c0ludGVybmFsKE8sIGhpZGRlbktleXMpO1xufTtcblxudmFyIF9vYmplY3RHb3BuID0ge1xuXHRmOiBmJDRcbn07XG5cbi8vIGZhbGxiYWNrIGZvciBJRTExIGJ1Z2d5IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHdpdGggaWZyYW1lIGFuZCB3aW5kb3dcblxudmFyIGdPUE4gPSBfb2JqZWN0R29wbi5mO1xudmFyIHRvU3RyaW5nJDEgPSB7fS50b1N0cmluZztcblxudmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXNcbiAgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW107XG5cbnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uIChpdCkge1xuICB0cnkge1xuICAgIHJldHVybiBnT1BOKGl0KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB3aW5kb3dOYW1lcy5zbGljZSgpO1xuICB9XG59O1xuXG52YXIgZiQ1ID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCkge1xuICByZXR1cm4gd2luZG93TmFtZXMgJiYgdG9TdHJpbmckMS5jYWxsKGl0KSA9PSAnW29iamVjdCBXaW5kb3ddJyA/IGdldFdpbmRvd05hbWVzKGl0KSA6IGdPUE4oX3RvSW9iamVjdChpdCkpO1xufTtcblxudmFyIF9vYmplY3RHb3BuRXh0ID0ge1xuXHRmOiBmJDVcbn07XG5cbnZhciBnT1BEID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcblxudmFyIGYkNiA9IF9kZXNjcmlwdG9ycyA/IGdPUEQgOiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkge1xuICBPID0gX3RvSW9iamVjdChPKTtcbiAgUCA9IF90b1ByaW1pdGl2ZShQLCB0cnVlKTtcbiAgaWYgKF9pZThEb21EZWZpbmUpIHRyeSB7XG4gICAgcmV0dXJuIGdPUEQoTywgUCk7XG4gIH0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxuICBpZiAoX2hhcyhPLCBQKSkgcmV0dXJuIF9wcm9wZXJ0eURlc2MoIV9vYmplY3RQaWUuZi5jYWxsKE8sIFApLCBPW1BdKTtcbn07XG5cbnZhciBfb2JqZWN0R29wZCA9IHtcblx0ZjogZiQ2XG59O1xuXG4vLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltXG5cblxuXG5cblxudmFyIE1FVEEgPSBfbWV0YS5LRVk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbnZhciBnT1BEJDEgPSBfb2JqZWN0R29wZC5mO1xudmFyIGRQJDEgPSBfb2JqZWN0RHAuZjtcbnZhciBnT1BOJDEgPSBfb2JqZWN0R29wbkV4dC5mO1xudmFyICRTeW1ib2wgPSBfZ2xvYmFsLlN5bWJvbDtcbnZhciAkSlNPTiA9IF9nbG9iYWwuSlNPTjtcbnZhciBfc3RyaW5naWZ5ID0gJEpTT04gJiYgJEpTT04uc3RyaW5naWZ5O1xudmFyIFBST1RPVFlQRSQyID0gJ3Byb3RvdHlwZSc7XG52YXIgSElEREVOID0gX3drcygnX2hpZGRlbicpO1xudmFyIFRPX1BSSU1JVElWRSA9IF93a3MoJ3RvUHJpbWl0aXZlJyk7XG52YXIgaXNFbnVtID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7XG52YXIgU3ltYm9sUmVnaXN0cnkgPSBfc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKTtcbnZhciBBbGxTeW1ib2xzID0gX3NoYXJlZCgnc3ltYm9scycpO1xudmFyIE9QU3ltYm9scyA9IF9zaGFyZWQoJ29wLXN5bWJvbHMnKTtcbnZhciBPYmplY3RQcm90byA9IE9iamVjdFtQUk9UT1RZUEUkMl07XG52YXIgVVNFX05BVElWRSA9IHR5cGVvZiAkU3ltYm9sID09ICdmdW5jdGlvbic7XG52YXIgUU9iamVjdCA9IF9nbG9iYWwuUU9iamVjdDtcbi8vIERvbid0IHVzZSBzZXR0ZXJzIGluIFF0IFNjcmlwdCwgaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzE3M1xudmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRSQyXSB8fCAhUU9iamVjdFtQUk9UT1RZUEUkMl0uZmluZENoaWxkO1xuXG4vLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODdcbnZhciBzZXRTeW1ib2xEZXNjID0gX2Rlc2NyaXB0b3JzICYmIF9mYWlscyhmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBfb2JqZWN0Q3JlYXRlKGRQJDEoe30sICdhJywge1xuICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gZFAkMSh0aGlzLCAnYScsIHsgdmFsdWU6IDcgfSkuYTsgfVxuICB9KSkuYSAhPSA3O1xufSkgPyBmdW5jdGlvbiAoaXQsIGtleSwgRCkge1xuICB2YXIgcHJvdG9EZXNjID0gZ09QRCQxKE9iamVjdFByb3RvLCBrZXkpO1xuICBpZiAocHJvdG9EZXNjKSBkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTtcbiAgZFAkMShpdCwga2V5LCBEKTtcbiAgaWYgKHByb3RvRGVzYyAmJiBpdCAhPT0gT2JqZWN0UHJvdG8pIGRQJDEoT2JqZWN0UHJvdG8sIGtleSwgcHJvdG9EZXNjKTtcbn0gOiBkUCQxO1xuXG52YXIgd3JhcCA9IGZ1bmN0aW9uICh0YWcpIHtcbiAgdmFyIHN5bSA9IEFsbFN5bWJvbHNbdGFnXSA9IF9vYmplY3RDcmVhdGUoJFN5bWJvbFtQUk9UT1RZUEUkMl0pO1xuICBzeW0uX2sgPSB0YWc7XG4gIHJldHVybiBzeW07XG59O1xuXG52YXIgaXNTeW1ib2wgPSBVU0VfTkFUSVZFICYmIHR5cGVvZiAkU3ltYm9sLml0ZXJhdG9yID09ICdzeW1ib2wnID8gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCc7XG59IDogZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7XG59O1xuXG52YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCkge1xuICBpZiAoaXQgPT09IE9iamVjdFByb3RvKSAkZGVmaW5lUHJvcGVydHkoT1BTeW1ib2xzLCBrZXksIEQpO1xuICBfYW5PYmplY3QoaXQpO1xuICBrZXkgPSBfdG9QcmltaXRpdmUoa2V5LCB0cnVlKTtcbiAgX2FuT2JqZWN0KEQpO1xuICBpZiAoX2hhcyhBbGxTeW1ib2xzLCBrZXkpKSB7XG4gICAgaWYgKCFELmVudW1lcmFibGUpIHtcbiAgICAgIGlmICghX2hhcyhpdCwgSElEREVOKSkgZFAkMShpdCwgSElEREVOLCBfcHJvcGVydHlEZXNjKDEsIHt9KSk7XG4gICAgICBpdFtISURERU5dW2tleV0gPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoX2hhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pIGl0W0hJRERFTl1ba2V5XSA9IGZhbHNlO1xuICAgICAgRCA9IF9vYmplY3RDcmVhdGUoRCwgeyBlbnVtZXJhYmxlOiBfcHJvcGVydHlEZXNjKDAsIGZhbHNlKSB9KTtcbiAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpO1xuICB9IHJldHVybiBkUCQxKGl0LCBrZXksIEQpO1xufTtcbnZhciAkZGVmaW5lUHJvcGVydGllcyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoaXQsIFApIHtcbiAgX2FuT2JqZWN0KGl0KTtcbiAgdmFyIGtleXMgPSBfZW51bUtleXMoUCA9IF90b0lvYmplY3QoUCkpO1xuICB2YXIgaSA9IDA7XG4gIHZhciBsID0ga2V5cy5sZW5ndGg7XG4gIHZhciBrZXk7XG4gIHdoaWxlIChsID4gaSkgJGRlZmluZVByb3BlcnR5KGl0LCBrZXkgPSBrZXlzW2krK10sIFBba2V5XSk7XG4gIHJldHVybiBpdDtcbn07XG52YXIgJGNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZShpdCwgUCkge1xuICByZXR1cm4gUCA9PT0gdW5kZWZpbmVkID8gX29iamVjdENyZWF0ZShpdCkgOiAkZGVmaW5lUHJvcGVydGllcyhfb2JqZWN0Q3JlYXRlKGl0KSwgUCk7XG59O1xudmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSkge1xuICB2YXIgRSA9IGlzRW51bS5jYWxsKHRoaXMsIGtleSA9IF90b1ByaW1pdGl2ZShrZXksIHRydWUpKTtcbiAgaWYgKHRoaXMgPT09IE9iamVjdFByb3RvICYmIF9oYXMoQWxsU3ltYm9scywga2V5KSAmJiAhX2hhcyhPUFN5bWJvbHMsIGtleSkpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIEUgfHwgIV9oYXModGhpcywga2V5KSB8fCAhX2hhcyhBbGxTeW1ib2xzLCBrZXkpIHx8IF9oYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlO1xufTtcbnZhciAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpIHtcbiAgaXQgPSBfdG9Jb2JqZWN0KGl0KTtcbiAga2V5ID0gX3RvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7XG4gIGlmIChpdCA9PT0gT2JqZWN0UHJvdG8gJiYgX2hhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFfaGFzKE9QU3ltYm9scywga2V5KSkgcmV0dXJuO1xuICB2YXIgRCA9IGdPUEQkMShpdCwga2V5KTtcbiAgaWYgKEQgJiYgX2hhcyhBbGxTeW1ib2xzLCBrZXkpICYmICEoX2hhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKSBELmVudW1lcmFibGUgPSB0cnVlO1xuICByZXR1cm4gRDtcbn07XG52YXIgJGdldE93blByb3BlcnR5TmFtZXMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KSB7XG4gIHZhciBuYW1lcyA9IGdPUE4kMShfdG9Jb2JqZWN0KGl0KSk7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgdmFyIGkgPSAwO1xuICB2YXIga2V5O1xuICB3aGlsZSAobmFtZXMubGVuZ3RoID4gaSkge1xuICAgIGlmICghX2hhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKSByZXN1bHQucHVzaChrZXkpO1xuICB9IHJldHVybiByZXN1bHQ7XG59O1xudmFyICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMoaXQpIHtcbiAgdmFyIElTX09QID0gaXQgPT09IE9iamVjdFByb3RvO1xuICB2YXIgbmFtZXMgPSBnT1BOJDEoSVNfT1AgPyBPUFN5bWJvbHMgOiBfdG9Jb2JqZWN0KGl0KSk7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgdmFyIGkgPSAwO1xuICB2YXIga2V5O1xuICB3aGlsZSAobmFtZXMubGVuZ3RoID4gaSkge1xuICAgIGlmIChfaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIChJU19PUCA/IF9oYXMoT2JqZWN0UHJvdG8sIGtleSkgOiB0cnVlKSkgcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcblxuLy8gMTkuNC4xLjEgU3ltYm9sKFtkZXNjcmlwdGlvbl0pXG5pZiAoIVVTRV9OQVRJVkUpIHtcbiAgJFN5bWJvbCA9IGZ1bmN0aW9uIFN5bWJvbCgpIHtcbiAgICBpZiAodGhpcyBpbnN0YW5jZW9mICRTeW1ib2wpIHRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpO1xuICAgIHZhciB0YWcgPSBfdWlkKGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTtcbiAgICB2YXIgJHNldCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgaWYgKHRoaXMgPT09IE9iamVjdFByb3RvKSAkc2V0LmNhbGwoT1BTeW1ib2xzLCB2YWx1ZSk7XG4gICAgICBpZiAoX2hhcyh0aGlzLCBISURERU4pICYmIF9oYXModGhpc1tISURERU5dLCB0YWcpKSB0aGlzW0hJRERFTl1bdGFnXSA9IGZhbHNlO1xuICAgICAgc2V0U3ltYm9sRGVzYyh0aGlzLCB0YWcsIF9wcm9wZXJ0eURlc2MoMSwgdmFsdWUpKTtcbiAgICB9O1xuICAgIGlmIChfZGVzY3JpcHRvcnMgJiYgc2V0dGVyKSBzZXRTeW1ib2xEZXNjKE9iamVjdFByb3RvLCB0YWcsIHsgY29uZmlndXJhYmxlOiB0cnVlLCBzZXQ6ICRzZXQgfSk7XG4gICAgcmV0dXJuIHdyYXAodGFnKTtcbiAgfTtcbiAgX3JlZGVmaW5lKCRTeW1ib2xbUFJPVE9UWVBFJDJdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5faztcbiAgfSk7XG5cbiAgX29iamVjdEdvcGQuZiA9ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7XG4gIF9vYmplY3REcC5mID0gJGRlZmluZVByb3BlcnR5O1xuICBfb2JqZWN0R29wbi5mID0gX29iamVjdEdvcG5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzO1xuICBfb2JqZWN0UGllLmYgPSAkcHJvcGVydHlJc0VudW1lcmFibGU7XG4gIF9vYmplY3RHb3BzLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xuXG4gIGlmIChfZGVzY3JpcHRvcnMgJiYgIV9saWJyYXJ5KSB7XG4gICAgX3JlZGVmaW5lKE9iamVjdFByb3RvLCAncHJvcGVydHlJc0VudW1lcmFibGUnLCAkcHJvcGVydHlJc0VudW1lcmFibGUsIHRydWUpO1xuICB9XG5cbiAgX3drc0V4dC5mID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICByZXR1cm4gd3JhcChfd2tzKG5hbWUpKTtcbiAgfTtcbn1cblxuX2V4cG9ydChfZXhwb3J0LkcgKyBfZXhwb3J0LlcgKyBfZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgeyBTeW1ib2w6ICRTeW1ib2wgfSk7XG5cbmZvciAodmFyIGVzNlN5bWJvbHMgPSAoXG4gIC8vIDE5LjQuMi4yLCAxOS40LjIuMywgMTkuNC4yLjQsIDE5LjQuMi42LCAxOS40LjIuOCwgMTkuNC4yLjksIDE5LjQuMi4xMCwgMTkuNC4yLjExLCAxOS40LjIuMTIsIDE5LjQuMi4xMywgMTkuNC4yLjE0XG4gICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcydcbikuc3BsaXQoJywnKSwgaiA9IDA7IGVzNlN5bWJvbHMubGVuZ3RoID4gajspX3drcyhlczZTeW1ib2xzW2orK10pO1xuXG5mb3IgKHZhciB3ZWxsS25vd25TeW1ib2xzID0gX29iamVjdEtleXMoX3drcy5zdG9yZSksIGsgPSAwOyB3ZWxsS25vd25TeW1ib2xzLmxlbmd0aCA+IGs7KSBfd2tzRGVmaW5lKHdlbGxLbm93blN5bWJvbHNbaysrXSk7XG5cbl9leHBvcnQoX2V4cG9ydC5TICsgX2V4cG9ydC5GICogIVVTRV9OQVRJVkUsICdTeW1ib2wnLCB7XG4gIC8vIDE5LjQuMi4xIFN5bWJvbC5mb3Ioa2V5KVxuICAnZm9yJzogZnVuY3Rpb24gKGtleSkge1xuICAgIHJldHVybiBfaGFzKFN5bWJvbFJlZ2lzdHJ5LCBrZXkgKz0gJycpXG4gICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV1cbiAgICAgIDogU3ltYm9sUmVnaXN0cnlba2V5XSA9ICRTeW1ib2woa2V5KTtcbiAgfSxcbiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pXG4gIGtleUZvcjogZnVuY3Rpb24ga2V5Rm9yKHN5bSkge1xuICAgIGlmICghaXNTeW1ib2woc3ltKSkgdGhyb3cgVHlwZUVycm9yKHN5bSArICcgaXMgbm90IGEgc3ltYm9sIScpO1xuICAgIGZvciAodmFyIGtleSBpbiBTeW1ib2xSZWdpc3RyeSkgaWYgKFN5bWJvbFJlZ2lzdHJ5W2tleV0gPT09IHN5bSkgcmV0dXJuIGtleTtcbiAgfSxcbiAgdXNlU2V0dGVyOiBmdW5jdGlvbiAoKSB7IHNldHRlciA9IHRydWU7IH0sXG4gIHVzZVNpbXBsZTogZnVuY3Rpb24gKCkgeyBzZXR0ZXIgPSBmYWxzZTsgfVxufSk7XG5cbl9leHBvcnQoX2V4cG9ydC5TICsgX2V4cG9ydC5GICogIVVTRV9OQVRJVkUsICdPYmplY3QnLCB7XG4gIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSlcbiAgY3JlYXRlOiAkY3JlYXRlLFxuICAvLyAxOS4xLjIuNCBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcylcbiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSxcbiAgLy8gMTkuMS4yLjMgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcylcbiAgZGVmaW5lUHJvcGVydGllczogJGRlZmluZVByb3BlcnRpZXMsXG4gIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUClcbiAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLFxuICAvLyAxOS4xLjIuNyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKVxuICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcyxcbiAgLy8gMTkuMS4yLjggT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhPKVxuICBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHNcbn0pO1xuXG4vLyAyNC4zLjIgSlNPTi5zdHJpbmdpZnkodmFsdWUgWywgcmVwbGFjZXIgWywgc3BhY2VdXSlcbiRKU09OICYmIF9leHBvcnQoX2V4cG9ydC5TICsgX2V4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8IF9mYWlscyhmdW5jdGlvbiAoKSB7XG4gIHZhciBTID0gJFN5bWJvbCgpO1xuICAvLyBNUyBFZGdlIGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyB7fVxuICAvLyBXZWJLaXQgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIG51bGxcbiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHNcbiAgcmV0dXJuIF9zdHJpbmdpZnkoW1NdKSAhPSAnW251bGxdJyB8fCBfc3RyaW5naWZ5KHsgYTogUyB9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nO1xufSkpLCAnSlNPTicsIHtcbiAgc3RyaW5naWZ5OiBmdW5jdGlvbiBzdHJpbmdpZnkoaXQpIHtcbiAgICB2YXIgYXJncyA9IFtpdF07XG4gICAgdmFyIGkgPSAxO1xuICAgIHZhciByZXBsYWNlciwgJHJlcGxhY2VyO1xuICAgIHdoaWxlIChhcmd1bWVudHMubGVuZ3RoID4gaSkgYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTtcbiAgICAkcmVwbGFjZXIgPSByZXBsYWNlciA9IGFyZ3NbMV07XG4gICAgaWYgKCFfaXNPYmplY3QocmVwbGFjZXIpICYmIGl0ID09PSB1bmRlZmluZWQgfHwgaXNTeW1ib2woaXQpKSByZXR1cm47IC8vIElFOCByZXR1cm5zIHN0cmluZyBvbiB1bmRlZmluZWRcbiAgICBpZiAoIV9pc0FycmF5KHJlcGxhY2VyKSkgcmVwbGFjZXIgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgaWYgKHR5cGVvZiAkcmVwbGFjZXIgPT0gJ2Z1bmN0aW9uJykgdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTtcbiAgICAgIGlmICghaXNTeW1ib2wodmFsdWUpKSByZXR1cm4gdmFsdWU7XG4gICAgfTtcbiAgICBhcmdzWzFdID0gcmVwbGFjZXI7XG4gICAgcmV0dXJuIF9zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3MpO1xuICB9XG59KTtcblxuLy8gMTkuNC4zLjQgU3ltYm9sLnByb3RvdHlwZVtAQHRvUHJpbWl0aXZlXShoaW50KVxuJFN5bWJvbFtQUk9UT1RZUEUkMl1bVE9fUFJJTUlUSVZFXSB8fCBfaGlkZSgkU3ltYm9sW1BST1RPVFlQRSQyXSwgVE9fUFJJTUlUSVZFLCAkU3ltYm9sW1BST1RPVFlQRSQyXS52YWx1ZU9mKTtcbi8vIDE5LjQuMy41IFN5bWJvbC5wcm90b3R5cGVbQEB0b1N0cmluZ1RhZ11cbl9zZXRUb1N0cmluZ1RhZygkU3ltYm9sLCAnU3ltYm9sJyk7XG4vLyAyMC4yLjEuOSBNYXRoW0BAdG9TdHJpbmdUYWddXG5fc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTtcbi8vIDI0LjMuMyBKU09OW0BAdG9TdHJpbmdUYWddXG5fc2V0VG9TdHJpbmdUYWcoX2dsb2JhbC5KU09OLCAnSlNPTicsIHRydWUpO1xuXG4vLyBnZXR0aW5nIHRhZyBmcm9tIDE5LjEuMy42IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcoKVxuXG52YXIgVEFHJDEgPSBfd2tzKCd0b1N0cmluZ1RhZycpO1xuLy8gRVMzIHdyb25nIGhlcmVcbnZhciBBUkcgPSBfY29mKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJztcblxuLy8gZmFsbGJhY2sgZm9yIElFMTEgU2NyaXB0IEFjY2VzcyBEZW5pZWQgZXJyb3JcbnZhciB0cnlHZXQgPSBmdW5jdGlvbiAoaXQsIGtleSkge1xuICB0cnkge1xuICAgIHJldHVybiBpdFtrZXldO1xuICB9IGNhdGNoIChlKSB7IC8qIGVtcHR5ICovIH1cbn07XG5cbnZhciBfY2xhc3NvZiA9IGZ1bmN0aW9uIChpdCkge1xuICB2YXIgTywgVCwgQjtcbiAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnXG4gICAgLy8gQEB0b1N0cmluZ1RhZyBjYXNlXG4gICAgOiB0eXBlb2YgKFQgPSB0cnlHZXQoTyA9IE9iamVjdChpdCksIFRBRyQxKSkgPT0gJ3N0cmluZycgPyBUXG4gICAgLy8gYnVpbHRpblRhZyBjYXNlXG4gICAgOiBBUkcgPyBfY29mKE8pXG4gICAgLy8gRVMzIGFyZ3VtZW50cyBmYWxsYmFja1xuICAgIDogKEIgPSBfY29mKE8pKSA9PSAnT2JqZWN0JyAmJiB0eXBlb2YgTy5jYWxsZWUgPT0gJ2Z1bmN0aW9uJyA/ICdBcmd1bWVudHMnIDogQjtcbn07XG5cbi8vIDE5LjEuMy42IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcoKVxuXG52YXIgdGVzdCA9IHt9O1xudGVzdFtfd2tzKCd0b1N0cmluZ1RhZycpXSA9ICd6JztcbmlmICh0ZXN0ICsgJycgIT0gJ1tvYmplY3Qgel0nKSB7XG4gIF9yZWRlZmluZShPYmplY3QucHJvdG90eXBlLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gJ1tvYmplY3QgJyArIF9jbGFzc29mKHRoaXMpICsgJ10nO1xuICB9LCB0cnVlKTtcbn1cblxuX3drc0RlZmluZSgnYXN5bmNJdGVyYXRvcicpO1xuXG5fd2tzRGVmaW5lKCdvYnNlcnZhYmxlJyk7XG5cbnZhciBzeW1ib2wgPSBfY29yZS5TeW1ib2w7XG5cbi8vIHRydWUgIC0+IFN0cmluZyNhdFxuLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0XG52YXIgX3N0cmluZ0F0ID0gZnVuY3Rpb24gKFRPX1NUUklORykge1xuICByZXR1cm4gZnVuY3Rpb24gKHRoYXQsIHBvcykge1xuICAgIHZhciBzID0gU3RyaW5nKF9kZWZpbmVkKHRoYXQpKTtcbiAgICB2YXIgaSA9IF90b0ludGVnZXIocG9zKTtcbiAgICB2YXIgbCA9IHMubGVuZ3RoO1xuICAgIHZhciBhLCBiO1xuICAgIGlmIChpIDwgMCB8fCBpID49IGwpIHJldHVybiBUT19TVFJJTkcgPyAnJyA6IHVuZGVmaW5lZDtcbiAgICBhID0gcy5jaGFyQ29kZUF0KGkpO1xuICAgIHJldHVybiBhIDwgMHhkODAwIHx8IGEgPiAweGRiZmYgfHwgaSArIDEgPT09IGwgfHwgKGIgPSBzLmNoYXJDb2RlQXQoaSArIDEpKSA8IDB4ZGMwMCB8fCBiID4gMHhkZmZmXG4gICAgICA/IFRPX1NUUklORyA/IHMuY2hhckF0KGkpIDogYVxuICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7XG4gIH07XG59O1xuXG52YXIgX2l0ZXJhdG9ycyA9IHt9O1xuXG52YXIgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTtcblxuLy8gMjUuMS4yLjEuMSAlSXRlcmF0b3JQcm90b3R5cGUlW0BAaXRlcmF0b3JdKClcbl9oaWRlKEl0ZXJhdG9yUHJvdG90eXBlLCBfd2tzKCdpdGVyYXRvcicpLCBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9KTtcblxudmFyIF9pdGVyQ3JlYXRlID0gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KSB7XG4gIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IF9vYmplY3RDcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUsIHsgbmV4dDogX3Byb3BlcnR5RGVzYygxLCBuZXh0KSB9KTtcbiAgX3NldFRvU3RyaW5nVGFnKENvbnN0cnVjdG9yLCBOQU1FICsgJyBJdGVyYXRvcicpO1xufTtcblxuLy8gMTkuMS4yLjkgLyAxNS4yLjMuMiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTylcblxuXG52YXIgSUVfUFJPVE8kMiA9IF9zaGFyZWRLZXkoJ0lFX1BST1RPJyk7XG52YXIgT2JqZWN0UHJvdG8kMSA9IE9iamVjdC5wcm90b3R5cGU7XG5cbnZhciBfb2JqZWN0R3BvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIChPKSB7XG4gIE8gPSBfdG9PYmplY3QoTyk7XG4gIGlmIChfaGFzKE8sIElFX1BST1RPJDIpKSByZXR1cm4gT1tJRV9QUk9UTyQyXTtcbiAgaWYgKHR5cGVvZiBPLmNvbnN0cnVjdG9yID09ICdmdW5jdGlvbicgJiYgTyBpbnN0YW5jZW9mIE8uY29uc3RydWN0b3IpIHtcbiAgICByZXR1cm4gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7XG4gIH0gcmV0dXJuIE8gaW5zdGFuY2VvZiBPYmplY3QgPyBPYmplY3RQcm90byQxIDogbnVsbDtcbn07XG5cbnZhciBJVEVSQVRPUiA9IF93a3MoJ2l0ZXJhdG9yJyk7XG52YXIgQlVHR1kgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSk7IC8vIFNhZmFyaSBoYXMgYnVnZ3kgaXRlcmF0b3JzIHcvbyBgbmV4dGBcbnZhciBGRl9JVEVSQVRPUiA9ICdAQGl0ZXJhdG9yJztcbnZhciBLRVlTID0gJ2tleXMnO1xudmFyIFZBTFVFUyA9ICd2YWx1ZXMnO1xuXG52YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH07XG5cbnZhciBfaXRlckRlZmluZSA9IGZ1bmN0aW9uIChCYXNlLCBOQU1FLCBDb25zdHJ1Y3RvciwgbmV4dCwgREVGQVVMVCwgSVNfU0VULCBGT1JDRUQpIHtcbiAgX2l0ZXJDcmVhdGUoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpO1xuICB2YXIgZ2V0TWV0aG9kID0gZnVuY3Rpb24gKGtpbmQpIHtcbiAgICBpZiAoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pIHJldHVybiBwcm90b1traW5kXTtcbiAgICBzd2l0Y2ggKGtpbmQpIHtcbiAgICAgIGNhc2UgS0VZUzogcmV0dXJuIGZ1bmN0aW9uIGtleXMoKSB7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07XG4gICAgICBjYXNlIFZBTFVFUzogcmV0dXJuIGZ1bmN0aW9uIHZhbHVlcygpIHsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTtcbiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCkgeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9O1xuICB9O1xuICB2YXIgVEFHID0gTkFNRSArICcgSXRlcmF0b3InO1xuICB2YXIgREVGX1ZBTFVFUyA9IERFRkFVTFQgPT0gVkFMVUVTO1xuICB2YXIgVkFMVUVTX0JVRyA9IGZhbHNlO1xuICB2YXIgcHJvdG8gPSBCYXNlLnByb3RvdHlwZTtcbiAgdmFyICRuYXRpdmUgPSBwcm90b1tJVEVSQVRPUl0gfHwgcHJvdG9bRkZfSVRFUkFUT1JdIHx8IERFRkFVTFQgJiYgcHJvdG9bREVGQVVMVF07XG4gIHZhciAkZGVmYXVsdCA9ICRuYXRpdmUgfHwgZ2V0TWV0aG9kKERFRkFVTFQpO1xuICB2YXIgJGVudHJpZXMgPSBERUZBVUxUID8gIURFRl9WQUxVRVMgPyAkZGVmYXVsdCA6IGdldE1ldGhvZCgnZW50cmllcycpIDogdW5kZWZpbmVkO1xuICB2YXIgJGFueU5hdGl2ZSA9IE5BTUUgPT0gJ0FycmF5JyA/IHByb3RvLmVudHJpZXMgfHwgJG5hdGl2ZSA6ICRuYXRpdmU7XG4gIHZhciBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlO1xuICAvLyBGaXggbmF0aXZlXG4gIGlmICgkYW55TmF0aXZlKSB7XG4gICAgSXRlcmF0b3JQcm90b3R5cGUgPSBfb2JqZWN0R3BvKCRhbnlOYXRpdmUuY2FsbChuZXcgQmFzZSgpKSk7XG4gICAgaWYgKEl0ZXJhdG9yUHJvdG90eXBlICE9PSBPYmplY3QucHJvdG90eXBlICYmIEl0ZXJhdG9yUHJvdG90eXBlLm5leHQpIHtcbiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnNcbiAgICAgIF9zZXRUb1N0cmluZ1RhZyhJdGVyYXRvclByb3RvdHlwZSwgVEFHLCB0cnVlKTtcbiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lc1xuICAgICAgaWYgKCFfbGlicmFyeSAmJiB0eXBlb2YgSXRlcmF0b3JQcm90b3R5cGVbSVRFUkFUT1JdICE9ICdmdW5jdGlvbicpIF9oaWRlKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUiwgcmV0dXJuVGhpcyk7XG4gICAgfVxuICB9XG4gIC8vIGZpeCBBcnJheSN7dmFsdWVzLCBAQGl0ZXJhdG9yfS5uYW1lIGluIFY4IC8gRkZcbiAgaWYgKERFRl9WQUxVRVMgJiYgJG5hdGl2ZSAmJiAkbmF0aXZlLm5hbWUgIT09IFZBTFVFUykge1xuICAgIFZBTFVFU19CVUcgPSB0cnVlO1xuICAgICRkZWZhdWx0ID0gZnVuY3Rpb24gdmFsdWVzKCkgeyByZXR1cm4gJG5hdGl2ZS5jYWxsKHRoaXMpOyB9O1xuICB9XG4gIC8vIERlZmluZSBpdGVyYXRvclxuICBpZiAoKCFfbGlicmFyeSB8fCBGT1JDRUQpICYmIChCVUdHWSB8fCBWQUxVRVNfQlVHIHx8ICFwcm90b1tJVEVSQVRPUl0pKSB7XG4gICAgX2hpZGUocHJvdG8sIElURVJBVE9SLCAkZGVmYXVsdCk7XG4gIH1cbiAgLy8gUGx1ZyBmb3IgbGlicmFyeVxuICBfaXRlcmF0b3JzW05BTUVdID0gJGRlZmF1bHQ7XG4gIF9pdGVyYXRvcnNbVEFHXSA9IHJldHVyblRoaXM7XG4gIGlmIChERUZBVUxUKSB7XG4gICAgbWV0aG9kcyA9IHtcbiAgICAgIHZhbHVlczogREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKFZBTFVFUyksXG4gICAgICBrZXlzOiBJU19TRVQgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChLRVlTKSxcbiAgICAgIGVudHJpZXM6ICRlbnRyaWVzXG4gICAgfTtcbiAgICBpZiAoRk9SQ0VEKSBmb3IgKGtleSBpbiBtZXRob2RzKSB7XG4gICAgICBpZiAoIShrZXkgaW4gcHJvdG8pKSBfcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTtcbiAgICB9IGVsc2UgX2V4cG9ydChfZXhwb3J0LlAgKyBfZXhwb3J0LkYgKiAoQlVHR1kgfHwgVkFMVUVTX0JVRyksIE5BTUUsIG1ldGhvZHMpO1xuICB9XG4gIHJldHVybiBtZXRob2RzO1xufTtcblxudmFyICRhdCA9IF9zdHJpbmdBdCh0cnVlKTtcblxuLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKVxuX2l0ZXJEZWZpbmUoU3RyaW5nLCAnU3RyaW5nJywgZnVuY3Rpb24gKGl0ZXJhdGVkKSB7XG4gIHRoaXMuX3QgPSBTdHJpbmcoaXRlcmF0ZWQpOyAvLyB0YXJnZXRcbiAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgIC8vIG5leHQgaW5kZXhcbi8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KClcbn0sIGZ1bmN0aW9uICgpIHtcbiAgdmFyIE8gPSB0aGlzLl90O1xuICB2YXIgaW5kZXggPSB0aGlzLl9pO1xuICB2YXIgcG9pbnQ7XG4gIGlmIChpbmRleCA+PSBPLmxlbmd0aCkgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICBwb2ludCA9ICRhdChPLCBpbmRleCk7XG4gIHRoaXMuX2kgKz0gcG9pbnQubGVuZ3RoO1xuICByZXR1cm4geyB2YWx1ZTogcG9pbnQsIGRvbmU6IGZhbHNlIH07XG59KTtcblxudmFyIF9pdGVyU3RlcCA9IGZ1bmN0aW9uIChkb25lLCB2YWx1ZSkge1xuICByZXR1cm4geyB2YWx1ZTogdmFsdWUsIGRvbmU6ICEhZG9uZSB9O1xufTtcblxuLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKVxuLy8gMjIuMS4zLjEzIEFycmF5LnByb3RvdHlwZS5rZXlzKClcbi8vIDIyLjEuMy4yOSBBcnJheS5wcm90b3R5cGUudmFsdWVzKClcbi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKVxudmFyIGVzNl9hcnJheV9pdGVyYXRvciA9IF9pdGVyRGVmaW5lKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbiAoaXRlcmF0ZWQsIGtpbmQpIHtcbiAgdGhpcy5fdCA9IF90b0lvYmplY3QoaXRlcmF0ZWQpOyAvLyB0YXJnZXRcbiAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgICAgIC8vIG5leHQgaW5kZXhcbiAgdGhpcy5fayA9IGtpbmQ7ICAgICAgICAgICAgICAgIC8vIGtpbmRcbi8vIDIyLjEuNS4yLjEgJUFycmF5SXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKVxufSwgZnVuY3Rpb24gKCkge1xuICB2YXIgTyA9IHRoaXMuX3Q7XG4gIHZhciBraW5kID0gdGhpcy5faztcbiAgdmFyIGluZGV4ID0gdGhpcy5faSsrO1xuICBpZiAoIU8gfHwgaW5kZXggPj0gTy5sZW5ndGgpIHtcbiAgICB0aGlzLl90ID0gdW5kZWZpbmVkO1xuICAgIHJldHVybiBfaXRlclN0ZXAoMSk7XG4gIH1cbiAgaWYgKGtpbmQgPT0gJ2tleXMnKSByZXR1cm4gX2l0ZXJTdGVwKDAsIGluZGV4KTtcbiAgaWYgKGtpbmQgPT0gJ3ZhbHVlcycpIHJldHVybiBfaXRlclN0ZXAoMCwgT1tpbmRleF0pO1xuICByZXR1cm4gX2l0ZXJTdGVwKDAsIFtpbmRleCwgT1tpbmRleF1dKTtcbn0sICd2YWx1ZXMnKTtcblxuLy8gYXJndW1lbnRzTGlzdFtAQGl0ZXJhdG9yXSBpcyAlQXJyYXlQcm90b192YWx1ZXMlICg5LjQuNC42LCA5LjQuNC43KVxuX2l0ZXJhdG9ycy5Bcmd1bWVudHMgPSBfaXRlcmF0b3JzLkFycmF5O1xuXG5fYWRkVG9VbnNjb3BhYmxlcygna2V5cycpO1xuX2FkZFRvVW5zY29wYWJsZXMoJ3ZhbHVlcycpO1xuX2FkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTtcblxudmFyIElURVJBVE9SJDEgPSBfd2tzKCdpdGVyYXRvcicpO1xudmFyIFRPX1NUUklOR19UQUcgPSBfd2tzKCd0b1N0cmluZ1RhZycpO1xudmFyIEFycmF5VmFsdWVzID0gX2l0ZXJhdG9ycy5BcnJheTtcblxudmFyIERPTUl0ZXJhYmxlcyA9IHtcbiAgQ1NTUnVsZUxpc3Q6IHRydWUsIC8vIFRPRE86IE5vdCBzcGVjIGNvbXBsaWFudCwgc2hvdWxkIGJlIGZhbHNlLlxuICBDU1NTdHlsZURlY2xhcmF0aW9uOiBmYWxzZSxcbiAgQ1NTVmFsdWVMaXN0OiBmYWxzZSxcbiAgQ2xpZW50UmVjdExpc3Q6IGZhbHNlLFxuICBET01SZWN0TGlzdDogZmFsc2UsXG4gIERPTVN0cmluZ0xpc3Q6IGZhbHNlLFxuICBET01Ub2tlbkxpc3Q6IHRydWUsXG4gIERhdGFUcmFuc2Zlckl0ZW1MaXN0OiBmYWxzZSxcbiAgRmlsZUxpc3Q6IGZhbHNlLFxuICBIVE1MQWxsQ29sbGVjdGlvbjogZmFsc2UsXG4gIEhUTUxDb2xsZWN0aW9uOiBmYWxzZSxcbiAgSFRNTEZvcm1FbGVtZW50OiBmYWxzZSxcbiAgSFRNTFNlbGVjdEVsZW1lbnQ6IGZhbHNlLFxuICBNZWRpYUxpc3Q6IHRydWUsIC8vIFRPRE86IE5vdCBzcGVjIGNvbXBsaWFudCwgc2hvdWxkIGJlIGZhbHNlLlxuICBNaW1lVHlwZUFycmF5OiBmYWxzZSxcbiAgTmFtZWROb2RlTWFwOiBmYWxzZSxcbiAgTm9kZUxpc3Q6IHRydWUsXG4gIFBhaW50UmVxdWVzdExpc3Q6IGZhbHNlLFxuICBQbHVnaW46IGZhbHNlLFxuICBQbHVnaW5BcnJheTogZmFsc2UsXG4gIFNWR0xlbmd0aExpc3Q6IGZhbHNlLFxuICBTVkdOdW1iZXJMaXN0OiBmYWxzZSxcbiAgU1ZHUGF0aFNlZ0xpc3Q6IGZhbHNlLFxuICBTVkdQb2ludExpc3Q6IGZhbHNlLFxuICBTVkdTdHJpbmdMaXN0OiBmYWxzZSxcbiAgU1ZHVHJhbnNmb3JtTGlzdDogZmFsc2UsXG4gIFNvdXJjZUJ1ZmZlckxpc3Q6IGZhbHNlLFxuICBTdHlsZVNoZWV0TGlzdDogdHJ1ZSwgLy8gVE9ETzogTm90IHNwZWMgY29tcGxpYW50LCBzaG91bGQgYmUgZmFsc2UuXG4gIFRleHRUcmFja0N1ZUxpc3Q6IGZhbHNlLFxuICBUZXh0VHJhY2tMaXN0OiBmYWxzZSxcbiAgVG91Y2hMaXN0OiBmYWxzZVxufTtcblxuZm9yICh2YXIgY29sbGVjdGlvbnMgPSBfb2JqZWN0S2V5cyhET01JdGVyYWJsZXMpLCBpID0gMDsgaSA8IGNvbGxlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gIHZhciBOQU1FID0gY29sbGVjdGlvbnNbaV07XG4gIHZhciBleHBsaWNpdCA9IERPTUl0ZXJhYmxlc1tOQU1FXTtcbiAgdmFyIENvbGxlY3Rpb24gPSBfZ2xvYmFsW05BTUVdO1xuICB2YXIgcHJvdG8gPSBDb2xsZWN0aW9uICYmIENvbGxlY3Rpb24ucHJvdG90eXBlO1xuICB2YXIga2V5O1xuICBpZiAocHJvdG8pIHtcbiAgICBpZiAoIXByb3RvW0lURVJBVE9SJDFdKSBfaGlkZShwcm90bywgSVRFUkFUT1IkMSwgQXJyYXlWYWx1ZXMpO1xuICAgIGlmICghcHJvdG9bVE9fU1RSSU5HX1RBR10pIF9oaWRlKHByb3RvLCBUT19TVFJJTkdfVEFHLCBOQU1FKTtcbiAgICBfaXRlcmF0b3JzW05BTUVdID0gQXJyYXlWYWx1ZXM7XG4gICAgaWYgKGV4cGxpY2l0KSBmb3IgKGtleSBpbiBlczZfYXJyYXlfaXRlcmF0b3IpIGlmICghcHJvdG9ba2V5XSkgX3JlZGVmaW5lKHByb3RvLCBrZXksIGVzNl9hcnJheV9pdGVyYXRvcltrZXldLCB0cnVlKTtcbiAgfVxufVxuXG52YXIgaXRlcmF0b3IgPSBfd2tzRXh0LmYoJ2l0ZXJhdG9yJyk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L0BmaXJlYmFzZS9wb2x5ZmlsbC9kaXN0L2luZGV4LmVzbS5qc1xuLy8gbW9kdWxlIGlkID0gMzdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuXG52YXIgdHNsaWJfMSA9IHJlcXVpcmUoJ3RzbGliJyk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBGaXJlYmFzZSBjb25zdGFudHMuICBTb21lIG9mIHRoZXNlIChAZGVmaW5lcykgY2FuIGJlIG92ZXJyaWRkZW4gYXQgY29tcGlsZS10aW1lLlxyXG4gKi9cclxudmFyIENPTlNUQU5UUyA9IHtcclxuICAgIC8qKlxyXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBjbGllbnQgTm9kZS5qcyBTREsuXHJcbiAgICAgKi9cclxuICAgIE5PREVfQ0xJRU5UOiBmYWxzZSxcclxuICAgIC8qKlxyXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBBZG1pbiBOb2RlLmpzIFNESy5cclxuICAgICAqL1xyXG4gICAgTk9ERV9BRE1JTjogZmFsc2UsXHJcbiAgICAvKipcclxuICAgICAqIEZpcmViYXNlIFNESyBWZXJzaW9uXHJcbiAgICAgKi9cclxuICAgIFNES19WRVJTSU9OOiAnJHtKU0NPUkVfVkVSU0lPTn0nXHJcbn07XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBwcm92aWRlZCBhc3NlcnRpb24gaXMgZmFsc3lcclxuICogQHBhcmFtIHsqfSBhc3NlcnRpb24gVGhlIGFzc2VydGlvbiB0byBiZSB0ZXN0ZWQgZm9yIGZhbHNpbmVzc1xyXG4gKiBAcGFyYW0geyFzdHJpbmd9IG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdG8gZGlzcGxheSBpZiB0aGUgY2hlY2sgZmFpbHNcclxuICovXHJcbnZhciBhc3NlcnQgPSBmdW5jdGlvbiAoYXNzZXJ0aW9uLCBtZXNzYWdlKSB7XHJcbiAgICBpZiAoIWFzc2VydGlvbikge1xyXG4gICAgICAgIHRocm93IGFzc2VydGlvbkVycm9yKG1lc3NhZ2UpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogUmV0dXJucyBhbiBFcnJvciBvYmplY3Qgc3VpdGFibGUgZm9yIHRocm93aW5nLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZVxyXG4gKiBAcmV0dXJuIHshRXJyb3J9XHJcbiAqL1xyXG52YXIgYXNzZXJ0aW9uRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xyXG4gICAgcmV0dXJuIG5ldyBFcnJvcignRmlyZWJhc2UgRGF0YWJhc2UgKCcgK1xyXG4gICAgICAgIENPTlNUQU5UUy5TREtfVkVSU0lPTiArXHJcbiAgICAgICAgJykgSU5URVJOQUwgQVNTRVJUIEZBSUxFRDogJyArXHJcbiAgICAgICAgbWVzc2FnZSk7XHJcbn07XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgc3RyaW5nVG9CeXRlQXJyYXkgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICAvLyBUT0RPKHVzZXIpOiBVc2UgbmF0aXZlIGltcGxlbWVudGF0aW9ucyBpZi93aGVuIGF2YWlsYWJsZVxyXG4gICAgdmFyIG91dCA9IFtdLCBwID0gMDtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGMgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICBpZiAoYyA8IDEyOCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gNikgfCAxOTI7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKChjICYgMHhmYzAwKSA9PSAweGQ4MDAgJiZcclxuICAgICAgICAgICAgaSArIDEgPCBzdHIubGVuZ3RoICYmXHJcbiAgICAgICAgICAgIChzdHIuY2hhckNvZGVBdChpICsgMSkgJiAweGZjMDApID09IDB4ZGMwMCkge1xyXG4gICAgICAgICAgICAvLyBTdXJyb2dhdGUgUGFpclxyXG4gICAgICAgICAgICBjID0gMHgxMDAwMCArICgoYyAmIDB4MDNmZikgPDwgMTApICsgKHN0ci5jaGFyQ29kZUF0KCsraSkgJiAweDAzZmYpO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDE4KSB8IDI0MDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gMTIpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTIpIHwgMjI0O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0O1xyXG59O1xyXG4vKipcclxuICogVHVybnMgYW4gYXJyYXkgb2YgbnVtYmVycyBpbnRvIHRoZSBzdHJpbmcgZ2l2ZW4gYnkgdGhlIGNvbmNhdGVuYXRpb24gb2YgdGhlXHJcbiAqIGNoYXJhY3RlcnMgdG8gd2hpY2ggdGhlIG51bWJlcnMgY29ycmVzcG9uZC5cclxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBieXRlcyBBcnJheSBvZiBudW1iZXJzIHJlcHJlc2VudGluZyBjaGFyYWN0ZXJzLlxyXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFN0cmluZ2lmaWNhdGlvbiBvZiB0aGUgYXJyYXkuXHJcbiAqL1xyXG52YXIgYnl0ZUFycmF5VG9TdHJpbmcgPSBmdW5jdGlvbiAoYnl0ZXMpIHtcclxuICAgIC8vIFRPRE8odXNlcik6IFVzZSBuYXRpdmUgaW1wbGVtZW50YXRpb25zIGlmL3doZW4gYXZhaWxhYmxlXHJcbiAgICB2YXIgb3V0ID0gW10sIHBvcyA9IDAsIGMgPSAwO1xyXG4gICAgd2hpbGUgKHBvcyA8IGJ5dGVzLmxlbmd0aCkge1xyXG4gICAgICAgIHZhciBjMSA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICBpZiAoYzEgPCAxMjgpIHtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYzEgPiAxOTEgJiYgYzEgPCAyMjQpIHtcclxuICAgICAgICAgICAgdmFyIGMyID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjMSAmIDMxKSA8PCA2KSB8IChjMiAmIDYzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMxID4gMjM5ICYmIGMxIDwgMzY1KSB7XHJcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXHJcbiAgICAgICAgICAgIHZhciBjMiA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgdmFyIGMzID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICB2YXIgYzQgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIHZhciB1ID0gKCgoYzEgJiA3KSA8PCAxOCkgfCAoKGMyICYgNjMpIDw8IDEyKSB8ICgoYzMgJiA2MykgPDwgNikgfCAoYzQgJiA2MykpIC1cclxuICAgICAgICAgICAgICAgIDB4MTAwMDA7XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweGQ4MDAgKyAodSA+PiAxMCkpO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhkYzAwICsgKHUgJiAxMDIzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgYzIgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIHZhciBjMyA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzEgJiAxNSkgPDwgMTIpIHwgKChjMiAmIDYzKSA8PCA2KSB8IChjMyAmIDYzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dC5qb2luKCcnKTtcclxufTtcclxuLy8gU3RhdGljIGxvb2t1cCBtYXBzLCBsYXppbHkgcG9wdWxhdGVkIGJ5IGluaXRfKClcclxudmFyIGJhc2U2NCA9IHtcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBieXRlcyB0byBjaGFyYWN0ZXJzLlxyXG4gICAgICogQHR5cGUge09iamVjdH1cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGJ5dGVUb0NoYXJNYXBfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIGNoYXJhY3RlcnMgdG8gYnl0ZXMuXHJcbiAgICAgKiBAdHlwZSB7T2JqZWN0fVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgY2hhclRvQnl0ZU1hcF86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgYnl0ZXMgdG8gd2Vic2FmZSBjaGFyYWN0ZXJzLlxyXG4gICAgICogQHR5cGUge09iamVjdH1cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGJ5dGVUb0NoYXJNYXBXZWJTYWZlXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyB3ZWJzYWZlIGNoYXJhY3RlcnMgdG8gYnl0ZXMuXHJcbiAgICAgKiBAdHlwZSB7T2JqZWN0fVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgY2hhclRvQnl0ZU1hcFdlYlNhZmVfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldCwgc2hhcmVkIGJldHdlZW5cclxuICAgICAqIEVOQ09ERURfVkFMUyBhbmQgRU5DT0RFRF9WQUxTX1dFQlNBRkVcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIEVOQ09ERURfVkFMU19CQVNFOiAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonICsgJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JyArICcwMTIzNDU2Nzg5JyxcclxuICAgIC8qKlxyXG4gICAgICogT3VyIGRlZmF1bHQgYWxwaGFiZXQuIFZhbHVlIDY0ICg9KSBpcyBzcGVjaWFsOyBpdCBtZWFucyBcIm5vdGhpbmcuXCJcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIGdldCBFTkNPREVEX1ZBTFMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuRU5DT0RFRF9WQUxTX0JBU0UgKyAnKy89JztcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIE91ciB3ZWJzYWZlIGFscGhhYmV0LlxyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgZ2V0IEVOQ09ERURfVkFMU19XRUJTQUZFKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJy1fLic7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBXaGV0aGVyIHRoaXMgYnJvd3NlciBzdXBwb3J0cyB0aGUgYXRvYiBhbmQgYnRvYSBmdW5jdGlvbnMuIFRoaXMgZXh0ZW5zaW9uXHJcbiAgICAgKiBzdGFydGVkIGF0IE1vemlsbGEgYnV0IGlzIG5vdyBpbXBsZW1lbnRlZCBieSBtYW55IGJyb3dzZXJzLiBXZSB1c2UgdGhlXHJcbiAgICAgKiBBU1NVTUVfKiB2YXJpYWJsZXMgdG8gYXZvaWQgcHVsbGluZyBpbiB0aGUgZnVsbCB1c2VyYWdlbnQgZGV0ZWN0aW9uIGxpYnJhcnlcclxuICAgICAqIGJ1dCBzdGlsbCBhbGxvd2luZyB0aGUgc3RhbmRhcmQgcGVyLWJyb3dzZXIgY29tcGlsYXRpb25zLlxyXG4gICAgICpcclxuICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBIQVNfTkFUSVZFX1NVUFBPUlQ6IHR5cGVvZiBhdG9iID09PSAnZnVuY3Rpb24nLFxyXG4gICAgLyoqXHJcbiAgICAgKiBCYXNlNjQtZW5jb2RlIGFuIGFycmF5IG9mIGJ5dGVzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7QXJyYXk8bnVtYmVyPnxVaW50OEFycmF5fSBpbnB1dCBBbiBhcnJheSBvZiBieXRlcyAobnVtYmVycyB3aXRoXHJcbiAgICAgKiAgICAgdmFsdWUgaW4gWzAsIDI1NV0pIHRvIGVuY29kZS5cclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF93ZWJTYWZlIEJvb2xlYW4gaW5kaWNhdGluZyB3ZSBzaG91bGQgdXNlIHRoZVxyXG4gICAgICogICAgIGFsdGVybmF0aXZlIGFscGhhYmV0LlxyXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgYmFzZTY0IGVuY29kZWQgc3RyaW5nLlxyXG4gICAgICovXHJcbiAgICBlbmNvZGVCeXRlQXJyYXk6IGZ1bmN0aW9uIChpbnB1dCwgb3B0X3dlYlNhZmUpIHtcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdlbmNvZGVCeXRlQXJyYXkgdGFrZXMgYW4gYXJyYXkgYXMgYSBwYXJhbWV0ZXInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0XygpO1xyXG4gICAgICAgIHZhciBieXRlVG9DaGFyTWFwID0gb3B0X3dlYlNhZmVcclxuICAgICAgICAgICAgPyB0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1xyXG4gICAgICAgICAgICA6IHRoaXMuYnl0ZVRvQ2hhck1hcF87XHJcbiAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpICs9IDMpIHtcclxuICAgICAgICAgICAgdmFyIGJ5dGUxID0gaW5wdXRbaV07XHJcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTIgPSBpICsgMSA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgdmFyIGJ5dGUyID0gaGF2ZUJ5dGUyID8gaW5wdXRbaSArIDFdIDogMDtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMyA9IGkgKyAyIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTMgPSBoYXZlQnl0ZTMgPyBpbnB1dFtpICsgMl0gOiAwO1xyXG4gICAgICAgICAgICB2YXIgb3V0Qnl0ZTEgPSBieXRlMSA+PiAyO1xyXG4gICAgICAgICAgICB2YXIgb3V0Qnl0ZTIgPSAoKGJ5dGUxICYgMHgwMykgPDwgNCkgfCAoYnl0ZTIgPj4gNCk7XHJcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMyA9ICgoYnl0ZTIgJiAweDBmKSA8PCAyKSB8IChieXRlMyA+PiA2KTtcclxuICAgICAgICAgICAgdmFyIG91dEJ5dGU0ID0gYnl0ZTMgJiAweDNmO1xyXG4gICAgICAgICAgICBpZiAoIWhhdmVCeXRlMykge1xyXG4gICAgICAgICAgICAgICAgb3V0Qnl0ZTQgPSA2NDtcclxuICAgICAgICAgICAgICAgIGlmICghaGF2ZUJ5dGUyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3V0Qnl0ZTMgPSA2NDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvdXRwdXQucHVzaChieXRlVG9DaGFyTWFwW291dEJ5dGUxXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlMl0sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTNdLCBieXRlVG9DaGFyTWFwW291dEJ5dGU0XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvdXRwdXQuam9pbignJyk7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBCYXNlNjQtZW5jb2RlIGEgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpbnB1dCBBIHN0cmluZyB0byBlbmNvZGUuXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfd2ViU2FmZSBJZiB0cnVlLCB3ZSBzaG91bGQgdXNlIHRoZVxyXG4gICAgICogICAgIGFsdGVybmF0aXZlIGFscGhhYmV0LlxyXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgYmFzZTY0IGVuY29kZWQgc3RyaW5nLlxyXG4gICAgICovXHJcbiAgICBlbmNvZGVTdHJpbmc6IGZ1bmN0aW9uIChpbnB1dCwgb3B0X3dlYlNhZmUpIHtcclxuICAgICAgICAvLyBTaG9ydGN1dCBmb3IgTW96aWxsYSBicm93c2VycyB0aGF0IGltcGxlbWVudFxyXG4gICAgICAgIC8vIGEgbmF0aXZlIGJhc2U2NCBlbmNvZGVyIGluIHRoZSBmb3JtIG9mIFwiYnRvYS9hdG9iXCJcclxuICAgICAgICBpZiAodGhpcy5IQVNfTkFUSVZFX1NVUFBPUlQgJiYgIW9wdF93ZWJTYWZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBidG9hKGlucHV0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlQnl0ZUFycmF5KHN0cmluZ1RvQnl0ZUFycmF5KGlucHV0KSwgb3B0X3dlYlNhZmUpO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWRlY29kZSBhIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaW5wdXQgdG8gZGVjb2RlLlxyXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3dlYlNhZmUgVHJ1ZSBpZiB3ZSBzaG91bGQgdXNlIHRoZVxyXG4gICAgICogICAgIGFsdGVybmF0aXZlIGFscGhhYmV0LlxyXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBkZWNvZGVkIHZhbHVlLlxyXG4gICAgICovXHJcbiAgICBkZWNvZGVTdHJpbmc6IGZ1bmN0aW9uIChpbnB1dCwgb3B0X3dlYlNhZmUpIHtcclxuICAgICAgICAvLyBTaG9ydGN1dCBmb3IgTW96aWxsYSBicm93c2VycyB0aGF0IGltcGxlbWVudFxyXG4gICAgICAgIC8vIGEgbmF0aXZlIGJhc2U2NCBlbmNvZGVyIGluIHRoZSBmb3JtIG9mIFwiYnRvYS9hdG9iXCJcclxuICAgICAgICBpZiAodGhpcy5IQVNfTkFUSVZFX1NVUFBPUlQgJiYgIW9wdF93ZWJTYWZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhdG9iKGlucHV0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJ5dGVBcnJheVRvU3RyaW5nKHRoaXMuZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXkoaW5wdXQsIG9wdF93ZWJTYWZlKSk7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBCYXNlNjQtZGVjb2RlIGEgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEluIGJhc2UtNjQgZGVjb2RpbmcsIGdyb3VwcyBvZiBmb3VyIGNoYXJhY3RlcnMgYXJlIGNvbnZlcnRlZCBpbnRvIHRocmVlXHJcbiAgICAgKiBieXRlcy4gIElmIHRoZSBlbmNvZGVyIGRpZCBub3QgYXBwbHkgcGFkZGluZywgdGhlIGlucHV0IGxlbmd0aCBtYXkgbm90XHJcbiAgICAgKiBiZSBhIG11bHRpcGxlIG9mIDQuXHJcbiAgICAgKlxyXG4gICAgICogSW4gdGhpcyBjYXNlLCB0aGUgbGFzdCBncm91cCB3aWxsIGhhdmUgZmV3ZXIgdGhhbiA0IGNoYXJhY3RlcnMsIGFuZFxyXG4gICAgICogcGFkZGluZyB3aWxsIGJlIGluZmVycmVkLiAgSWYgdGhlIGdyb3VwIGhhcyBvbmUgb3IgdHdvIGNoYXJhY3RlcnMsIGl0IGRlY29kZXNcclxuICAgICAqIHRvIG9uZSBieXRlLiAgSWYgdGhlIGdyb3VwIGhhcyB0aHJlZSBjaGFyYWN0ZXJzLCBpdCBkZWNvZGVzIHRvIHR3byBieXRlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaW5wdXQgSW5wdXQgdG8gZGVjb2RlLlxyXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3dlYlNhZmUgVHJ1ZSBpZiB3ZSBzaG91bGQgdXNlIHRoZSB3ZWItc2FmZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4geyFBcnJheTxudW1iZXI+fSBieXRlcyByZXByZXNlbnRpbmcgdGhlIGRlY29kZWQgdmFsdWUuXHJcbiAgICAgKi9cclxuICAgIGRlY29kZVN0cmluZ1RvQnl0ZUFycmF5OiBmdW5jdGlvbiAoaW5wdXQsIG9wdF93ZWJTYWZlKSB7XHJcbiAgICAgICAgdGhpcy5pbml0XygpO1xyXG4gICAgICAgIHZhciBjaGFyVG9CeXRlTWFwID0gb3B0X3dlYlNhZmVcclxuICAgICAgICAgICAgPyB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1xyXG4gICAgICAgICAgICA6IHRoaXMuY2hhclRvQnl0ZU1hcF87XHJcbiAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOykge1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTEgPSBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKyspXTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMiA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMiA9IGhhdmVCeXRlMiA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDA7XHJcbiAgICAgICAgICAgICsraTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMyA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMyA9IGhhdmVCeXRlMyA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDY0O1xyXG4gICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTQgPSBpIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTQgPSBoYXZlQnl0ZTQgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiA2NDtcclxuICAgICAgICAgICAgKytpO1xyXG4gICAgICAgICAgICBpZiAoYnl0ZTEgPT0gbnVsbCB8fCBieXRlMiA9PSBudWxsIHx8IGJ5dGUzID09IG51bGwgfHwgYnl0ZTQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgb3V0Qnl0ZTEgPSAoYnl0ZTEgPDwgMikgfCAoYnl0ZTIgPj4gNCk7XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUxKTtcclxuICAgICAgICAgICAgaWYgKGJ5dGUzICE9IDY0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3V0Qnl0ZTIgPSAoKGJ5dGUyIDw8IDQpICYgMHhmMCkgfCAoYnl0ZTMgPj4gMik7XHJcbiAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMik7XHJcbiAgICAgICAgICAgICAgICBpZiAoYnl0ZTQgIT0gNjQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb3V0Qnl0ZTMgPSAoKGJ5dGUzIDw8IDYpICYgMHhjMCkgfCBieXRlNDtcclxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIExhenkgc3RhdGljIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uLiBDYWxsZWQgYmVmb3JlXHJcbiAgICAgKiBhY2Nlc3NpbmcgYW55IG9mIHRoZSBzdGF0aWMgbWFwIHZhcmlhYmxlcy5cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGluaXRfOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmJ5dGVUb0NoYXJNYXBfKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcF8gPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwXyA9IHt9O1xyXG4gICAgICAgICAgICB0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlXyA9IHt9O1xyXG4gICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlXyA9IHt9O1xyXG4gICAgICAgICAgICAvLyBXZSB3YW50IHF1aWNrIG1hcHBpbmdzIGJhY2sgYW5kIGZvcnRoLCBzbyB3ZSBwcmVjb21wdXRlIHR3byBtYXBzLlxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuRU5DT0RFRF9WQUxTLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ5dGVUb0NoYXJNYXBfW2ldID0gdGhpcy5FTkNPREVEX1ZBTFMuY2hhckF0KGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwX1t0aGlzLmJ5dGVUb0NoYXJNYXBfW2ldXSA9IGk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1tpXSA9IHRoaXMuRU5DT0RFRF9WQUxTX1dFQlNBRkUuY2hhckF0KGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV9bdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV9baV1dID0gaTtcclxuICAgICAgICAgICAgICAgIC8vIEJlIGZvcmdpdmluZyB3aGVuIGRlY29kaW5nIGFuZCBjb3JyZWN0bHkgZGVjb2RlIGJvdGggZW5jb2RpbmdzLlxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gdGhpcy5FTkNPREVEX1ZBTFNfQkFTRS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfW3RoaXMuRU5DT0RFRF9WQUxTX1dFQlNBRkUuY2hhckF0KGkpXSA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV9bdGhpcy5FTkNPREVEX1ZBTFMuY2hhckF0KGkpXSA9IGk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBVUkwtc2FmZSBiYXNlNjQgZW5jb2RpbmdcclxuICogQHBhcmFtIHshc3RyaW5nfSBzdHJcclxuICogQHJldHVybiB7IXN0cmluZ31cclxuICovXHJcbnZhciBiYXNlNjRFbmNvZGUgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICB2YXIgdXRmOEJ5dGVzID0gc3RyaW5nVG9CeXRlQXJyYXkoc3RyKTtcclxuICAgIHJldHVybiBiYXNlNjQuZW5jb2RlQnl0ZUFycmF5KHV0ZjhCeXRlcywgdHJ1ZSk7XHJcbn07XHJcbi8qKlxyXG4gKiBVUkwtc2FmZSBiYXNlNjQgZGVjb2RpbmdcclxuICpcclxuICogTk9URTogRE8gTk9UIHVzZSB0aGUgZ2xvYmFsIGF0b2IoKSBmdW5jdGlvbiAtIGl0IGRvZXMgTk9UIHN1cHBvcnQgdGhlXHJcbiAqIGJhc2U2NFVybCB2YXJpYW50IGVuY29kaW5nLlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyIFRvIGJlIGRlY29kZWRcclxuICogQHJldHVybiB7P3N0cmluZ30gRGVjb2RlZCByZXN1bHQsIGlmIHBvc3NpYmxlXHJcbiAqL1xyXG52YXIgYmFzZTY0RGVjb2RlID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gYmFzZTY0LmRlY29kZVN0cmluZyhzdHIsIHRydWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdiYXNlNjREZWNvZGUgZmFpbGVkOiAnLCBlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERvIGEgZGVlcC1jb3B5IG9mIGJhc2ljIEphdmFTY3JpcHQgT2JqZWN0cyBvciBBcnJheXMuXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWVwQ29weSh2YWx1ZSkge1xyXG4gICAgcmV0dXJuIGRlZXBFeHRlbmQodW5kZWZpbmVkLCB2YWx1ZSk7XHJcbn1cclxuLyoqXHJcbiAqIENvcHkgcHJvcGVydGllcyBmcm9tIHNvdXJjZSB0byB0YXJnZXQgKHJlY3Vyc2l2ZWx5IGFsbG93cyBleHRlbnNpb25cclxuICogb2YgT2JqZWN0cyBhbmQgQXJyYXlzKS4gIFNjYWxhciB2YWx1ZXMgaW4gdGhlIHRhcmdldCBhcmUgb3Zlci13cml0dGVuLlxyXG4gKiBJZiB0YXJnZXQgaXMgdW5kZWZpbmVkLCBhbiBvYmplY3Qgb2YgdGhlIGFwcHJvcHJpYXRlIHR5cGUgd2lsbCBiZSBjcmVhdGVkXHJcbiAqIChhbmQgcmV0dXJuZWQpLlxyXG4gKlxyXG4gKiBXZSByZWN1cnNpdmVseSBjb3B5IGFsbCBjaGlsZCBwcm9wZXJ0aWVzIG9mIHBsYWluIE9iamVjdHMgaW4gdGhlIHNvdXJjZS0gc29cclxuICogdGhhdCBuYW1lc3BhY2UtIGxpa2UgZGljdGlvbmFyaWVzIGFyZSBtZXJnZWQuXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCB0aGUgdGFyZ2V0IGNhbiBiZSBhIGZ1bmN0aW9uLCBpbiB3aGljaCBjYXNlIHRoZSBwcm9wZXJ0aWVzIGluXHJcbiAqIHRoZSBzb3VyY2UgT2JqZWN0IGFyZSBjb3BpZWQgb250byBpdCBhcyBzdGF0aWMgcHJvcGVydGllcyBvZiB0aGUgRnVuY3Rpb24uXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWVwRXh0ZW5kKHRhcmdldCwgc291cmNlKSB7XHJcbiAgICBpZiAoIShzb3VyY2UgaW5zdGFuY2VvZiBPYmplY3QpKSB7XHJcbiAgICAgICAgcmV0dXJuIHNvdXJjZTtcclxuICAgIH1cclxuICAgIHN3aXRjaCAoc291cmNlLmNvbnN0cnVjdG9yKSB7XHJcbiAgICAgICAgY2FzZSBEYXRlOlxyXG4gICAgICAgICAgICAvLyBUcmVhdCBEYXRlcyBsaWtlIHNjYWxhcnM7IGlmIHRoZSB0YXJnZXQgZGF0ZSBvYmplY3QgaGFkIGFueSBjaGlsZFxyXG4gICAgICAgICAgICAvLyBwcm9wZXJ0aWVzIC0gdGhleSB3aWxsIGJlIGxvc3QhXHJcbiAgICAgICAgICAgIHZhciBkYXRlVmFsdWUgPSBzb3VyY2U7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlVmFsdWUuZ2V0VGltZSgpKTtcclxuICAgICAgICBjYXNlIE9iamVjdDpcclxuICAgICAgICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB7fTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIEFycmF5OlxyXG4gICAgICAgICAgICAvLyBBbHdheXMgY29weSB0aGUgYXJyYXkgc291cmNlIGFuZCBvdmVyd3JpdGUgdGhlIHRhcmdldC5cclxuICAgICAgICAgICAgdGFyZ2V0ID0gW107XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIC8vIE5vdCBhIHBsYWluIE9iamVjdCAtIHRyZWF0IGl0IGFzIGEgc2NhbGFyLlxyXG4gICAgICAgICAgICByZXR1cm4gc291cmNlO1xyXG4gICAgfVxyXG4gICAgZm9yICh2YXIgcHJvcCBpbiBzb3VyY2UpIHtcclxuICAgICAgICBpZiAoIXNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGFyZ2V0W3Byb3BdID0gZGVlcEV4dGVuZCh0YXJnZXRbcHJvcF0sIHNvdXJjZVtwcm9wXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGFyZ2V0O1xyXG59XHJcbi8vIFRPRE86IFJlYWxseSBuZWVkZWQgKGZvciBKU0NvbXBpbGVyIHR5cGUgY2hlY2tpbmcpP1xyXG5mdW5jdGlvbiBwYXRjaFByb3BlcnR5KG9iaiwgcHJvcCwgdmFsdWUpIHtcclxuICAgIG9ialtwcm9wXSA9IHZhbHVlO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRGVmZXJyZWQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEZWZlcnJlZCgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgX3RoaXMucmVzb2x2ZSA9IHJlc29sdmU7XHJcbiAgICAgICAgICAgIF90aGlzLnJlamVjdCA9IHJlamVjdDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT3VyIEFQSSBpbnRlcm5hbHMgYXJlIG5vdCBwcm9taXNlaWZpZWQgYW5kIGNhbm5vdCBiZWNhdXNlIG91ciBjYWxsYmFjayBBUElzIGhhdmUgc3VidGxlIGV4cGVjdGF0aW9ucyBhcm91bmRcclxuICAgICAqIGludm9raW5nIHByb21pc2VzIGlubGluZSwgd2hpY2ggUHJvbWlzZXMgYXJlIGZvcmJpZGRlbiB0byBkby4gVGhpcyBtZXRob2QgYWNjZXB0cyBhbiBvcHRpb25hbCBub2RlLXN0eWxlIGNhbGxiYWNrXHJcbiAgICAgKiBhbmQgcmV0dXJucyBhIG5vZGUtc3R5bGUgY2FsbGJhY2sgd2hpY2ggd2lsbCByZXNvbHZlIG9yIHJlamVjdCB0aGUgRGVmZXJyZWQncyBwcm9taXNlLlxyXG4gICAgICogQHBhcmFtIHsoKD9mdW5jdGlvbig/KEVycm9yKSk6ICg/fHVuZGVmaW5lZCkpfCAoP2Z1bmN0aW9uKD8oRXJyb3IpLD89KTogKD98dW5kZWZpbmVkKSkpPX0gY2FsbGJhY2tcclxuICAgICAqIEByZXR1cm4geyFmdW5jdGlvbig/KEVycm9yKSwgPz0pfVxyXG4gICAgICovXHJcbiAgICBEZWZlcnJlZC5wcm90b3R5cGUud3JhcENhbGxiYWNrID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGVycm9yLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5yZXNvbHZlKHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBBdHRhY2hpbmcgbm9vcCBoYW5kbGVyIGp1c3QgaW4gY2FzZSBkZXZlbG9wZXIgd2Fzbid0IGV4cGVjdGluZ1xyXG4gICAgICAgICAgICAgICAgLy8gcHJvbWlzZXNcclxuICAgICAgICAgICAgICAgIF90aGlzLnByb21pc2UuY2F0Y2goZnVuY3Rpb24gKCkgeyB9KTtcclxuICAgICAgICAgICAgICAgIC8vIFNvbWUgb2Ygb3VyIGNhbGxiYWNrcyBkb24ndCBleHBlY3QgYSB2YWx1ZSBhbmQgb3VyIG93biB0ZXN0c1xyXG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0IHRoYXQgdGhlIHBhcmFtZXRlciBsZW5ndGggaXMgMVxyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEZWZlcnJlZDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXR1cm5zIG5hdmlnYXRvci51c2VyQWdlbnQgc3RyaW5nIG9yICcnIGlmIGl0J3Mgbm90IGRlZmluZWQuXHJcbiAqIEByZXR1cm4ge3N0cmluZ30gdXNlciBhZ2VudCBzdHJpbmdcclxuICovXHJcbnZhciBnZXRVQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgIHR5cGVvZiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogRGV0ZWN0IENvcmRvdmEgLyBQaG9uZUdhcCAvIElvbmljIGZyYW1ld29ya3Mgb24gYSBtb2JpbGUgZGV2aWNlLlxyXG4gKlxyXG4gKiBEZWxpYmVyYXRlbHkgZG9lcyBub3QgcmVseSBvbiBjaGVja2luZyBgZmlsZTovL2AgVVJMcyAoYXMgdGhpcyBmYWlscyBQaG9uZUdhcCBpbiB0aGUgUmlwcGxlIGVtdWxhdG9yKSBub3JcclxuICogQ29yZG92YSBgb25EZXZpY2VSZWFkeWAsIHdoaWNoIHdvdWxkIG5vcm1hbGx5IHdhaXQgZm9yIGEgY2FsbGJhY2suXHJcbiAqXHJcbiAqIEByZXR1cm4ge2Jvb2xlYW59IGlzTW9iaWxlQ29yZG92YVxyXG4gKi9cclxudmFyIGlzTW9iaWxlQ29yZG92YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICAhISh3aW5kb3dbJ2NvcmRvdmEnXSB8fCB3aW5kb3dbJ3Bob25lZ2FwJ10gfHwgd2luZG93WydQaG9uZUdhcCddKSAmJlxyXG4gICAgICAgIC9pb3N8aXBob25lfGlwb2R8aXBhZHxhbmRyb2lkfGJsYWNrYmVycnl8aWVtb2JpbGUvaS50ZXN0KGdldFVBKCkpKTtcclxufTtcclxuLyoqXHJcbiAqIERldGVjdCBSZWFjdCBOYXRpdmUuXHJcbiAqXHJcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgUmVhY3ROYXRpdmUgZW52aXJvbm1lbnQgaXMgZGV0ZWN0ZWQuXHJcbiAqL1xyXG52YXIgaXNSZWFjdE5hdGl2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ29iamVjdCcgJiYgbmF2aWdhdG9yWydwcm9kdWN0J10gPT09ICdSZWFjdE5hdGl2ZScpO1xyXG59O1xyXG4vKipcclxuICogRGV0ZWN0IE5vZGUuanMuXHJcbiAqXHJcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgTm9kZS5qcyBlbnZpcm9ubWVudCBpcyBkZXRlY3RlZC5cclxuICovXHJcbnZhciBpc05vZGVTZGsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gQ09OU1RBTlRTLk5PREVfQ0xJRU5UID09PSB0cnVlIHx8IENPTlNUQU5UUy5OT0RFX0FETUlOID09PSB0cnVlO1xyXG59O1xuXG52YXIgRVJST1JfTkFNRSA9ICdGaXJlYmFzZUVycm9yJztcclxudmFyIGNhcHR1cmVTdGFja1RyYWNlID0gRXJyb3JcclxuICAgIC5jYXB0dXJlU3RhY2tUcmFjZTtcclxuLy8gRXhwb3J0IGZvciBmYWtpbmcgaW4gdGVzdHNcclxuZnVuY3Rpb24gcGF0Y2hDYXB0dXJlKGNhcHR1cmVGYWtlKSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gY2FwdHVyZVN0YWNrVHJhY2U7XHJcbiAgICBjYXB0dXJlU3RhY2tUcmFjZSA9IGNhcHR1cmVGYWtlO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG52YXIgRmlyZWJhc2VFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpcmViYXNlRXJyb3IoY29kZSwgbWVzc2FnZSkge1xyXG4gICAgICAgIHRoaXMuY29kZSA9IGNvZGU7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcclxuICAgICAgICAvLyBXZSB3YW50IHRoZSBzdGFjayB2YWx1ZSwgaWYgaW1wbGVtZW50ZWQgYnkgRXJyb3JcclxuICAgICAgICBpZiAoY2FwdHVyZVN0YWNrVHJhY2UpIHtcclxuICAgICAgICAgICAgLy8gUGF0Y2hlcyB0aGlzLnN0YWNrLCBvbWl0dGVkIGNhbGxzIGFib3ZlIEVycm9yRmFjdG9yeSNjcmVhdGVcclxuICAgICAgICAgICAgY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgRXJyb3JGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIC8vIEluIGNhc2Ugb2YgSUUxMSwgc3RhY2sgd2lsbCBiZSBzZXQgb25seSBhZnRlciBlcnJvciBpcyByYWlzZWQuXHJcbiAgICAgICAgICAgICAgICAvLyBodHRwczovL2RvY3MubWljcm9zb2Z0LmNvbS9lbi11cy9zY3JpcHRpbmcvamF2YXNjcmlwdC9yZWZlcmVuY2Uvc3RhY2stcHJvcGVydHktZXJyb3ItamF2YXNjcmlwdFxyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSBFUlJPUl9OQU1FO1xyXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBub24tZW51bWVyYWJsZSBnZXR0ZXIgZm9yIHRoZSBwcm9wZXJ0eS5cclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnc3RhY2snLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnIuc3RhY2s7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRmlyZWJhc2VFcnJvcjtcclxufSgpKTtcclxuLy8gQmFjay1kb29yIGluaGVyaXRhbmNlXHJcbkZpcmViYXNlRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xyXG5GaXJlYmFzZUVycm9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEZpcmViYXNlRXJyb3I7XHJcbkZpcmViYXNlRXJyb3IucHJvdG90eXBlLm5hbWUgPSBFUlJPUl9OQU1FO1xyXG52YXIgRXJyb3JGYWN0b3J5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRXJyb3JGYWN0b3J5KHNlcnZpY2UsIHNlcnZpY2VOYW1lLCBlcnJvcnMpIHtcclxuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMuc2VydmljZU5hbWUgPSBzZXJ2aWNlTmFtZTtcclxuICAgICAgICB0aGlzLmVycm9ycyA9IGVycm9ycztcclxuICAgICAgICAvLyBNYXRjaGVzIHskbmFtZX0sIGJ5IGRlZmF1bHQuXHJcbiAgICAgICAgdGhpcy5wYXR0ZXJuID0gL1xce1xcJChbXn1dKyl9L2c7XHJcbiAgICAgICAgLy8gZW1wdHlcclxuICAgIH1cclxuICAgIEVycm9yRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKGNvZGUsIGRhdGEpIHtcclxuICAgICAgICBpZiAoZGF0YSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHRlbXBsYXRlID0gdGhpcy5lcnJvcnNbY29kZV07XHJcbiAgICAgICAgdmFyIGZ1bGxDb2RlID0gdGhpcy5zZXJ2aWNlICsgJy8nICsgY29kZTtcclxuICAgICAgICB2YXIgbWVzc2FnZTtcclxuICAgICAgICBpZiAodGVtcGxhdGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBtZXNzYWdlID0gJ0Vycm9yJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSB0ZW1wbGF0ZS5yZXBsYWNlKHRoaXMucGF0dGVybiwgZnVuY3Rpb24gKG1hdGNoLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRhdGFba2V5XTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUudG9TdHJpbmcoKSA6ICc8JyArIGtleSArICc/Pic7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTZXJ2aWNlOiBFcnJvciBtZXNzYWdlIChzZXJ2aWNlL2NvZGUpLlxyXG4gICAgICAgIG1lc3NhZ2UgPSB0aGlzLnNlcnZpY2VOYW1lICsgJzogJyArIG1lc3NhZ2UgKyAnICgnICsgZnVsbENvZGUgKyAnKS4nO1xyXG4gICAgICAgIHZhciBlcnIgPSBuZXcgRmlyZWJhc2VFcnJvcihmdWxsQ29kZSwgbWVzc2FnZSk7XHJcbiAgICAgICAgLy8gUG9wdWxhdGUgdGhlIEVycm9yIG9iamVjdCB3aXRoIG1lc3NhZ2UgcGFydHMgZm9yIHByb2dyYW1tYXRpY1xyXG4gICAgICAgIC8vIGFjY2Vzc2VzIChlLmcuLCBlLmZpbGUpLlxyXG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoIWRhdGEuaGFzT3duUHJvcGVydHkocHJvcCkgfHwgcHJvcC5zbGljZSgtMSkgPT09ICdfJykge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZXJyW3Byb3BdID0gZGF0YVtwcm9wXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGVycjtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRXJyb3JGYWN0b3J5O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEV2YWx1YXRlcyBhIEpTT04gc3RyaW5nIGludG8gYSBqYXZhc2NyaXB0IG9iamVjdC5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciBBIHN0cmluZyBjb250YWluaW5nIEpTT04uXHJcbiAqIEByZXR1cm4geyp9IFRoZSBqYXZhc2NyaXB0IG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHNwZWNpZmllZCBKU09OLlxyXG4gKi9cclxuZnVuY3Rpb24ganNvbkV2YWwoc3RyKSB7XHJcbiAgICByZXR1cm4gSlNPTi5wYXJzZShzdHIpO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIEpTT04gcmVwcmVzZW50aW5nIGEgamF2YXNjcmlwdCBvYmplY3QuXHJcbiAqIEBwYXJhbSB7Kn0gZGF0YSBKYXZhc2NyaXB0IG9iamVjdCB0byBiZSBzdHJpbmdpZmllZC5cclxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgSlNPTiBjb250ZW50cyBvZiB0aGUgb2JqZWN0LlxyXG4gKi9cclxuZnVuY3Rpb24gc3RyaW5naWZ5KGRhdGEpIHtcclxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBpbnRvIGNvbnN0aXR1ZW50IHBhcnRzLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIHdpdGggaW52YWxpZCAvIGluY29tcGxldGUgY2xhaW1zIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKlxyXG4gKiBAcGFyYW0gez9zdHJpbmd9IHRva2VuXHJcbiAqIEByZXR1cm4ge3toZWFkZXI6ICosIGNsYWltczogKiwgZGF0YTogKiwgc2lnbmF0dXJlOiBzdHJpbmd9fVxyXG4gKi9cclxudmFyIGRlY29kZSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGhlYWRlciA9IHt9LCBjbGFpbXMgPSB7fSwgZGF0YSA9IHt9LCBzaWduYXR1cmUgPSAnJztcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIHBhcnRzID0gdG9rZW4uc3BsaXQoJy4nKTtcclxuICAgICAgICBoZWFkZXIgPSBqc29uRXZhbChiYXNlNjREZWNvZGUocGFydHNbMF0pIHx8ICcnKTtcclxuICAgICAgICBjbGFpbXMgPSBqc29uRXZhbChiYXNlNjREZWNvZGUocGFydHNbMV0pIHx8ICcnKTtcclxuICAgICAgICBzaWduYXR1cmUgPSBwYXJ0c1syXTtcclxuICAgICAgICBkYXRhID0gY2xhaW1zWydkJ10gfHwge307XHJcbiAgICAgICAgZGVsZXRlIGNsYWltc1snZCddO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHsgfVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBoZWFkZXI6IGhlYWRlcixcclxuICAgICAgICBjbGFpbXM6IGNsYWltcyxcclxuICAgICAgICBkYXRhOiBkYXRhLFxyXG4gICAgICAgIHNpZ25hdHVyZTogc2lnbmF0dXJlXHJcbiAgICB9O1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCBjaGVja3MgdGhlIHZhbGlkaXR5IG9mIGl0cyB0aW1lLWJhc2VkIGNsYWltcy4gV2lsbCByZXR1cm4gdHJ1ZSBpZiB0aGVcclxuICogdG9rZW4gaXMgd2l0aGluIHRoZSB0aW1lIHdpbmRvdyBhdXRob3JpemVkIGJ5IHRoZSAnbmJmJyAobm90LWJlZm9yZSkgYW5kICdpYXQnIChpc3N1ZWQtYXQpIGNsYWltcy5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKlxyXG4gKiBAcGFyYW0gez9zdHJpbmd9IHRva2VuXHJcbiAqIEByZXR1cm4ge2Jvb2xlYW59XHJcbiAqL1xyXG52YXIgaXNWYWxpZFRpbWVzdGFtcCA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zLCBub3cgPSBNYXRoLmZsb29yKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCksIHZhbGlkU2luY2UsIHZhbGlkVW50aWw7XHJcbiAgICBpZiAodHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBpZiAoY2xhaW1zLmhhc093blByb3BlcnR5KCduYmYnKSkge1xyXG4gICAgICAgICAgICB2YWxpZFNpbmNlID0gY2xhaW1zWyduYmYnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKSkge1xyXG4gICAgICAgICAgICB2YWxpZFNpbmNlID0gY2xhaW1zWydpYXQnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnZXhwJykpIHtcclxuICAgICAgICAgICAgdmFsaWRVbnRpbCA9IGNsYWltc1snZXhwJ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0b2tlbiB3aWxsIGV4cGlyZSBhZnRlciAyNGggYnkgZGVmYXVsdFxyXG4gICAgICAgICAgICB2YWxpZFVudGlsID0gdmFsaWRTaW5jZSArIDg2NDAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiAobm93ICYmIHZhbGlkU2luY2UgJiYgdmFsaWRVbnRpbCAmJiBub3cgPj0gdmFsaWRTaW5jZSAmJiBub3cgPD0gdmFsaWRVbnRpbCk7XHJcbn07XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIHJldHVybnMgaXRzIGlzc3VlZCBhdCB0aW1lIGlmIHZhbGlkLCBudWxsIG90aGVyd2lzZS5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBudWxsIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKlxyXG4gKiBAcGFyYW0gez9zdHJpbmd9IHRva2VuXHJcbiAqIEByZXR1cm4gez9udW1iZXJ9XHJcbiAqL1xyXG52YXIgaXNzdWVkQXRUaW1lID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICB2YXIgY2xhaW1zID0gZGVjb2RlKHRva2VuKS5jbGFpbXM7XHJcbiAgICBpZiAodHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKSkge1xyXG4gICAgICAgIHJldHVybiBjbGFpbXNbJ2lhdCddO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn07XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIGNoZWNrcyB0aGUgdmFsaWRpdHkgb2YgaXRzIGZvcm1hdC4gRXhwZWN0cyBhIHZhbGlkIGlzc3VlZC1hdCB0aW1lLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqXHJcbiAqIEBwYXJhbSB7P3N0cmluZ30gdG9rZW5cclxuICogQHJldHVybiB7Ym9vbGVhbn1cclxuICovXHJcbnZhciBpc1ZhbGlkRm9ybWF0ID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICB2YXIgZGVjb2RlZCA9IGRlY29kZSh0b2tlbiksIGNsYWltcyA9IGRlY29kZWQuY2xhaW1zO1xyXG4gICAgcmV0dXJuICEhY2xhaW1zICYmIHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0Jyk7XHJcbn07XHJcbi8qKlxyXG4gKiBBdHRlbXB0cyB0byBwZWVyIGludG8gYW4gYXV0aCB0b2tlbiBhbmQgZGV0ZXJtaW5lIGlmIGl0J3MgYW4gYWRtaW4gYXV0aCB0b2tlbiBieSBsb29raW5nIGF0IHRoZSBjbGFpbXMgcG9ydGlvbi5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKlxyXG4gKiBAcGFyYW0gez9zdHJpbmd9IHRva2VuXHJcbiAqIEByZXR1cm4ge2Jvb2xlYW59XHJcbiAqL1xyXG52YXIgaXNBZG1pbiA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xyXG4gICAgcmV0dXJuIHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltc1snYWRtaW4nXSA9PT0gdHJ1ZTtcclxufTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIFNlZSBodHRwOi8vd3d3LmRldnRob3VnaHQuY29tLzIwMTIvMDEvMTgvYW4tb2JqZWN0LWlzLW5vdC1hLWhhc2gvXHJcbnZhciBjb250YWlucyA9IGZ1bmN0aW9uIChvYmosIGtleSkge1xyXG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7XHJcbn07XHJcbnZhciBzYWZlR2V0ID0gZnVuY3Rpb24gKG9iaiwga2V5KSB7XHJcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSlcclxuICAgICAgICByZXR1cm4gb2JqW2tleV07XHJcbiAgICAvLyBlbHNlIHJldHVybiB1bmRlZmluZWQuXHJcbn07XHJcbi8qKlxyXG4gKiBFbnVtZXJhdGVzIHRoZSBrZXlzL3ZhbHVlcyBpbiBhbiBvYmplY3QsIGV4Y2x1ZGluZyBrZXlzIGRlZmluZWQgb24gdGhlIHByb3RvdHlwZS5cclxuICpcclxuICogQHBhcmFtIHs/T2JqZWN0LjxLLFY+fSBvYmogT2JqZWN0IHRvIGVudW1lcmF0ZS5cclxuICogQHBhcmFtIHshZnVuY3Rpb24oSywgVil9IGZuIEZ1bmN0aW9uIHRvIGNhbGwgZm9yIGVhY2gga2V5IGFuZCB2YWx1ZS5cclxuICogQHRlbXBsYXRlIEssVlxyXG4gKi9cclxudmFyIGZvckVhY2ggPSBmdW5jdGlvbiAob2JqLCBmbikge1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIGZuKGtleSwgb2JqW2tleV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIENvcGllcyBhbGwgdGhlIChvd24pIHByb3BlcnRpZXMgZnJvbSBvbmUgb2JqZWN0IHRvIGFub3RoZXIuXHJcbiAqIEBwYXJhbSB7IU9iamVjdH0gb2JqVG9cclxuICogQHBhcmFtIHshT2JqZWN0fSBvYmpGcm9tXHJcbiAqIEByZXR1cm4geyFPYmplY3R9IG9ialRvXHJcbiAqL1xyXG52YXIgZXh0ZW5kID0gZnVuY3Rpb24gKG9ialRvLCBvYmpGcm9tKSB7XHJcbiAgICBmb3JFYWNoKG9iakZyb20sIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgb2JqVG9ba2V5XSA9IHZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gb2JqVG87XHJcbn07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgY2xvbmUgb2YgdGhlIHNwZWNpZmllZCBvYmplY3QuXHJcbiAqIEBwYXJhbSB7IU9iamVjdH0gb2JqXHJcbiAqIEByZXR1cm4geyFPYmplY3R9IGNsb25lZCBvYmouXHJcbiAqL1xyXG52YXIgY2xvbmUgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICByZXR1cm4gZXh0ZW5kKHt9LCBvYmopO1xyXG59O1xyXG4vKipcclxuICogUmV0dXJucyB0cnVlIGlmIG9iaiBoYXMgdHlwZW9mIFwib2JqZWN0XCIgYW5kIGlzIG5vdCBudWxsLiAgVW5saWtlIGdvb2cuaXNPYmplY3QoKSwgZG9lcyBub3QgcmV0dXJuIHRydWVcclxuICogZm9yIGZ1bmN0aW9ucy5cclxuICpcclxuICogQHBhcmFtIG9iaiB7Kn0gQSBwb3RlbnRpYWwgb2JqZWN0LlxyXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBpdCdzIGFuIG9iamVjdC5cclxuICovXHJcbnZhciBpc05vbk51bGxPYmplY3QgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgb2JqICE9PSBudWxsO1xyXG59O1xyXG52YXIgaXNFbXB0eSA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufTtcclxudmFyIGdldENvdW50ID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgdmFyIHJ2ID0gMDtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICBydisrO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJ2O1xyXG59O1xyXG52YXIgbWFwID0gZnVuY3Rpb24gKG9iaiwgZiwgb3B0X29iaikge1xyXG4gICAgdmFyIHJlcyA9IHt9O1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIHJlc1trZXldID0gZi5jYWxsKG9wdF9vYmosIG9ialtrZXldLCBrZXksIG9iaik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59O1xyXG52YXIgZmluZEtleSA9IGZ1bmN0aW9uIChvYmosIGZuLCBvcHRfdGhpcykge1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChmbi5jYWxsKG9wdF90aGlzLCBvYmpba2V5XSwga2V5LCBvYmopKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBrZXk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcclxufTtcclxudmFyIGZpbmRWYWx1ZSA9IGZ1bmN0aW9uIChvYmosIGZuLCBvcHRfdGhpcykge1xyXG4gICAgdmFyIGtleSA9IGZpbmRLZXkob2JqLCBmbiwgb3B0X3RoaXMpO1xyXG4gICAgcmV0dXJuIGtleSAmJiBvYmpba2V5XTtcclxufTtcclxudmFyIGdldEFueUtleSA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICByZXR1cm4ga2V5O1xyXG4gICAgfVxyXG59O1xyXG52YXIgZ2V0VmFsdWVzID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgdmFyIHJlcyA9IFtdO1xyXG4gICAgdmFyIGkgPSAwO1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIHJlc1tpKytdID0gb2JqW2tleV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59O1xyXG4vKipcclxuICogVGVzdHMgd2hldGhlciBldmVyeSBrZXkvdmFsdWUgcGFpciBpbiBhbiBvYmplY3QgcGFzcyB0aGUgdGVzdCBpbXBsZW1lbnRlZFxyXG4gKiBieSB0aGUgcHJvdmlkZWQgZnVuY3Rpb25cclxuICpcclxuICogQHBhcmFtIHs/T2JqZWN0LjxLLFY+fSBvYmogT2JqZWN0IHRvIHRlc3QuXHJcbiAqIEBwYXJhbSB7IWZ1bmN0aW9uKEssIFYpfSBmbiBGdW5jdGlvbiB0byBjYWxsIGZvciBlYWNoIGtleSBhbmQgdmFsdWUuXHJcbiAqIEB0ZW1wbGF0ZSBLLFZcclxuICovXHJcbnZhciBldmVyeSA9IGZ1bmN0aW9uIChvYmosIGZuKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcclxuICAgICAgICAgICAgaWYgKCFmbihrZXksIG9ialtrZXldKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn07XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyBhIHF1ZXJ5c3RyaW5nLWZvcm1hdHRlZCBzdHJpbmcgKGUuZy4gJmFyZz12YWwmYXJnMj12YWwyKSBmcm9tIGEgcGFyYW1zXHJcbiAqIG9iamVjdCAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcclxuICogTm90ZTogWW91IG11c3QgcHJlcGVuZCBpdCB3aXRoID8gd2hlbiBhZGRpbmcgaXQgdG8gYSBVUkwuXHJcbiAqXHJcbiAqIEBwYXJhbSB7IU9iamVjdH0gcXVlcnlzdHJpbmdQYXJhbXNcclxuICogQHJldHVybiB7c3RyaW5nfVxyXG4gKi9cclxudmFyIHF1ZXJ5c3RyaW5nID0gZnVuY3Rpb24gKHF1ZXJ5c3RyaW5nUGFyYW1zKSB7XHJcbiAgICB2YXIgcGFyYW1zID0gW107XHJcbiAgICBmb3JFYWNoKHF1ZXJ5c3RyaW5nUGFyYW1zLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xyXG4gICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uIChhcnJheVZhbCkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoYXJyYXlWYWwpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHBhcmFtcy5sZW5ndGggPyAnJicgKyBwYXJhbXMuam9pbignJicpIDogJyc7XHJcbn07XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgcXVlcnlzdHJpbmcgKGUuZy4gP2FyZz12YWwmYXJnMj12YWwyKSBpbnRvIGEgcGFyYW1zIG9iamVjdCAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5c3RyaW5nXHJcbiAqIEByZXR1cm4geyFPYmplY3R9XHJcbiAqL1xyXG52YXIgcXVlcnlzdHJpbmdEZWNvZGUgPSBmdW5jdGlvbiAocXVlcnlzdHJpbmcpIHtcclxuICAgIHZhciBvYmogPSB7fTtcclxuICAgIHZhciB0b2tlbnMgPSBxdWVyeXN0cmluZy5yZXBsYWNlKC9eXFw/LywgJycpLnNwbGl0KCcmJyk7XHJcbiAgICB0b2tlbnMuZm9yRWFjaChmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgdmFyIGtleSA9IHRva2VuLnNwbGl0KCc9Jyk7XHJcbiAgICAgICAgICAgIG9ialtrZXlbMF1dID0ga2V5WzFdO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIG9iajtcclxufTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIENvcHlyaWdodCAyMDExIFRoZSBDbG9zdXJlIExpYnJhcnkgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuLy9cclxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuLy9cclxuLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuLy9cclxuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXHJcbi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbi8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBBYnN0cmFjdCBjcnlwdG9ncmFwaGljIGhhc2ggaW50ZXJmYWNlLlxyXG4gKlxyXG4gKiBTZWUgU2hhMSBhbmQgTWQ1IGZvciBzYW1wbGUgaW1wbGVtZW50YXRpb25zLlxyXG4gKlxyXG4gKi9cclxuLyoqXHJcbiAqIENyZWF0ZSBhIGNyeXB0b2dyYXBoaWMgaGFzaCBpbnN0YW5jZS5cclxuICpcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBzdHJ1Y3RcclxuICovXHJcbnZhciBIYXNoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSGFzaCgpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgYmxvY2sgc2l6ZSBmb3IgdGhlIGhhc2hlci5cclxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuYmxvY2tTaXplID0gLTE7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gSGFzaDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBAZmlsZW92ZXJ2aWV3IFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaC5cclxuICogVmFyaWFibGUgbmFtZXMgZm9sbG93IHRoZSBub3RhdGlvbiBpbiBGSVBTIFBVQiAxODAtMzpcclxuICogaHR0cDovL2NzcmMubmlzdC5nb3YvcHVibGljYXRpb25zL2ZpcHMvZmlwczE4MC0zL2ZpcHMxODAtM19maW5hbC5wZGYuXHJcbiAqXHJcbiAqIFVzYWdlOlxyXG4gKiAgIHZhciBzaGExID0gbmV3IHNoYTEoKTtcclxuICogICBzaGExLnVwZGF0ZShieXRlcyk7XHJcbiAqICAgdmFyIGhhc2ggPSBzaGExLmRpZ2VzdCgpO1xyXG4gKlxyXG4gKiBQZXJmb3JtYW5jZTpcclxuICogICBDaHJvbWUgMjM6ICAgfjQwMCBNYml0L3NcclxuICogICBGaXJlZm94IDE2OiAgfjI1MCBNYml0L3NcclxuICpcclxuICovXHJcbi8qKlxyXG4gKiBTSEEtMSBjcnlwdG9ncmFwaGljIGhhc2ggY29uc3RydWN0b3IuXHJcbiAqXHJcbiAqIFRoZSBwcm9wZXJ0aWVzIGRlY2xhcmVkIGhlcmUgYXJlIGRpc2N1c3NlZCBpbiB0aGUgYWJvdmUgYWxnb3JpdGhtIGRvY3VtZW50LlxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGV4dGVuZHMge0hhc2h9XHJcbiAqIEBmaW5hbFxyXG4gKiBAc3RydWN0XHJcbiAqL1xyXG52YXIgU2hhMSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFNoYTEsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBTaGExKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogSG9sZHMgdGhlIHByZXZpb3VzIHZhbHVlcyBvZiBhY2N1bXVsYXRlZCB2YXJpYWJsZXMgYS1lIGluIHRoZSBjb21wcmVzc19cclxuICAgICAgICAgKiBmdW5jdGlvbi5cclxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5jaGFpbl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGJ1ZmZlciBob2xkaW5nIHRoZSBwYXJ0aWFsbHkgY29tcHV0ZWQgaGFzaCByZXN1bHQuXHJcbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMuYnVmXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFuIGFycmF5IG9mIDgwIGJ5dGVzLCBlYWNoIGEgcGFydCBvZiB0aGUgbWVzc2FnZSB0byBiZSBoYXNoZWQuICBSZWZlcnJlZCB0b1xyXG4gICAgICAgICAqIGFzIHRoZSBtZXNzYWdlIHNjaGVkdWxlIGluIHRoZSBkb2NzLlxyXG4gICAgICAgICAqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLldfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ29udGFpbnMgZGF0YSBuZWVkZWQgdG8gcGFkIG1lc3NhZ2VzIGxlc3MgdGhhbiA2NCBieXRlcy5cclxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5wYWRfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5pbmJ1Zl8gPSAwO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlIHtudW1iZXJ9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMudG90YWxfID0gMDtcclxuICAgICAgICBfdGhpcy5ibG9ja1NpemUgPSA1MTIgLyA4O1xyXG4gICAgICAgIF90aGlzLnBhZF9bMF0gPSAxMjg7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBfdGhpcy5ibG9ja1NpemU7ICsraSkge1xyXG4gICAgICAgICAgICBfdGhpcy5wYWRfW2ldID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgX3RoaXMucmVzZXQoKTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBTaGExLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNoYWluX1swXSA9IDB4Njc0NTIzMDE7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMV0gPSAweGVmY2RhYjg5O1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzJdID0gMHg5OGJhZGNmZTtcclxuICAgICAgICB0aGlzLmNoYWluX1szXSA9IDB4MTAzMjU0NzY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bNF0gPSAweGMzZDJlMWYwO1xyXG4gICAgICAgIHRoaXMuaW5idWZfID0gMDtcclxuICAgICAgICB0aGlzLnRvdGFsXyA9IDA7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbnRlcm5hbCBjb21wcmVzcyBoZWxwZXIgZnVuY3Rpb24uXHJcbiAgICAgKiBAcGFyYW0geyFBcnJheTxudW1iZXI+fCFVaW50OEFycmF5fHN0cmluZ30gYnVmIEJsb2NrIHRvIGNvbXByZXNzLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXI9fSBvcHRfb2Zmc2V0IE9mZnNldCBvZiB0aGUgYmxvY2sgaW4gdGhlIGJ1ZmZlci5cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIFNoYTEucHJvdG90eXBlLmNvbXByZXNzXyA9IGZ1bmN0aW9uIChidWYsIG9wdF9vZmZzZXQpIHtcclxuICAgICAgICBpZiAoIW9wdF9vZmZzZXQpIHtcclxuICAgICAgICAgICAgb3B0X29mZnNldCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBXID0gdGhpcy5XXztcclxuICAgICAgICAvLyBnZXQgMTYgYmlnIGVuZGlhbiB3b3Jkc1xyXG4gICAgICAgIGlmICh0eXBlb2YgYnVmID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8odXNlcik6IFtidWcgODE0MDEyMl0gUmVjZW50IHZlcnNpb25zIG9mIFNhZmFyaSBmb3IgTWFjIE9TIGFuZCBpT1NcclxuICAgICAgICAgICAgICAgIC8vIGhhdmUgYSBidWcgdGhhdCB0dXJucyB0aGUgcG9zdC1pbmNyZW1lbnQgKysgb3BlcmF0b3IgaW50byBwcmUtaW5jcmVtZW50XHJcbiAgICAgICAgICAgICAgICAvLyBkdXJpbmcgSklUIGNvbXBpbGF0aW9uLiAgV2UgaGF2ZSBjb2RlIHRoYXQgZGVwZW5kcyBoZWF2aWx5IG9uIFNIQS0xIGZvclxyXG4gICAgICAgICAgICAgICAgLy8gY29ycmVjdG5lc3MgYW5kIHdoaWNoIGlzIGFmZmVjdGVkIGJ5IHRoaXMgYnVnLCBzbyBJJ3ZlIHJlbW92ZWQgYWxsIHVzZXNcclxuICAgICAgICAgICAgICAgIC8vIG9mIHBvc3QtaW5jcmVtZW50ICsrIGluIHdoaWNoIHRoZSByZXN1bHQgdmFsdWUgaXMgdXNlZC4gIFdlIGNhbiByZXZlcnRcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgY2hhbmdlIG9uY2UgdGhlIFNhZmFyaSBidWdcclxuICAgICAgICAgICAgICAgIC8vIChodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTA5MDM2KSBoYXMgYmVlbiBmaXhlZCBhbmRcclxuICAgICAgICAgICAgICAgIC8vIG1vc3QgY2xpZW50cyBoYXZlIGJlZW4gdXBkYXRlZC5cclxuICAgICAgICAgICAgICAgIFdbaV0gPVxyXG4gICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvcHRfb2Zmc2V0KSA8PCAyNCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCArIDEpIDw8IDE2KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvcHRfb2Zmc2V0ICsgMikgPDwgOCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWYuY2hhckNvZGVBdChvcHRfb2Zmc2V0ICsgMyk7XHJcbiAgICAgICAgICAgICAgICBvcHRfb2Zmc2V0ICs9IDQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1ZltvcHRfb2Zmc2V0XSA8PCAyNCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmW29wdF9vZmZzZXQgKyAxXSA8PCAxNikgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmW29wdF9vZmZzZXQgKyAyXSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZltvcHRfb2Zmc2V0ICsgM107XHJcbiAgICAgICAgICAgICAgICBvcHRfb2Zmc2V0ICs9IDQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gZXhwYW5kIHRvIDgwIHdvcmRzXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDE2OyBpIDwgODA7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgdCA9IFdbaSAtIDNdIF4gV1tpIC0gOF0gXiBXW2kgLSAxNF0gXiBXW2kgLSAxNl07XHJcbiAgICAgICAgICAgIFdbaV0gPSAoKHQgPDwgMSkgfCAodCA+Pj4gMzEpKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBhID0gdGhpcy5jaGFpbl9bMF07XHJcbiAgICAgICAgdmFyIGIgPSB0aGlzLmNoYWluX1sxXTtcclxuICAgICAgICB2YXIgYyA9IHRoaXMuY2hhaW5fWzJdO1xyXG4gICAgICAgIHZhciBkID0gdGhpcy5jaGFpbl9bM107XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzLmNoYWluX1s0XTtcclxuICAgICAgICB2YXIgZiwgaztcclxuICAgICAgICAvLyBUT0RPKHVzZXIpOiBUcnkgdG8gdW5yb2xsIHRoaXMgbG9vcCB0byBzcGVlZCB1cCB0aGUgY29tcHV0YXRpb24uXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA4MDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChpIDwgNDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgMjApIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gZCBeIChiICYgKGMgXiBkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4NWE4Mjc5OTk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDZlZDllYmExO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPCA2MCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSAoYiAmIGMpIHwgKGQgJiAoYiB8IGMpKTtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg4ZjFiYmNkYztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSBiIF4gYyBeIGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4Y2E2MmMxZDY7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHQgPSAoKChhIDw8IDUpIHwgKGEgPj4+IDI3KSkgKyBmICsgZSArIGsgKyBXW2ldKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgICAgIGUgPSBkO1xyXG4gICAgICAgICAgICBkID0gYztcclxuICAgICAgICAgICAgYyA9ICgoYiA8PCAzMCkgfCAoYiA+Pj4gMikpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICAgICAgYiA9IGE7XHJcbiAgICAgICAgICAgIGEgPSB0O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoYWluX1swXSA9ICh0aGlzLmNoYWluX1swXSArIGEpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1sxXSA9ICh0aGlzLmNoYWluX1sxXSArIGIpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9ICh0aGlzLmNoYWluX1syXSArIGMpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1szXSA9ICh0aGlzLmNoYWluX1szXSArIGQpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1s0XSA9ICh0aGlzLmNoYWluX1s0XSArIGUpICYgMHhmZmZmZmZmZjtcclxuICAgIH07XHJcbiAgICBTaGExLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoYnl0ZXMsIG9wdF9sZW5ndGgpIHtcclxuICAgICAgICAvLyBUT0RPKGpvaG5sZW56KTogdGlnaHRlbiB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIGFuZCByZW1vdmUgdGhpcyBjaGVja1xyXG4gICAgICAgIGlmIChieXRlcyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9wdF9sZW5ndGggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvcHRfbGVuZ3RoID0gYnl0ZXMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbGVuZ3RoTWludXNCbG9jayA9IG9wdF9sZW5ndGggLSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgLy8gVXNpbmcgbG9jYWwgaW5zdGVhZCBvZiBtZW1iZXIgdmFyaWFibGVzIGdpdmVzIH41JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYuXHJcbiAgICAgICAgdmFyIGJ1ZiA9IHRoaXMuYnVmXztcclxuICAgICAgICB2YXIgaW5idWYgPSB0aGlzLmluYnVmXztcclxuICAgICAgICAvLyBUaGUgb3V0ZXIgd2hpbGUgbG9vcCBzaG91bGQgZXhlY3V0ZSBhdCBtb3N0IHR3aWNlLlxyXG4gICAgICAgIHdoaWxlIChuIDwgb3B0X2xlbmd0aCkge1xyXG4gICAgICAgICAgICAvLyBXaGVuIHdlIGhhdmUgbm8gZGF0YSBpbiB0aGUgYmxvY2sgdG8gdG9wIHVwLCB3ZSBjYW4gZGlyZWN0bHkgcHJvY2VzcyB0aGVcclxuICAgICAgICAgICAgLy8gaW5wdXQgYnVmZmVyIChhc3N1bWluZyBpdCBjb250YWlucyBzdWZmaWNpZW50IGRhdGEpLiBUaGlzIGdpdmVzIH4yNSVcclxuICAgICAgICAgICAgLy8gc3BlZWR1cCBvbiBDaHJvbWUgMjMgYW5kIH4xNSUgc3BlZWR1cCBvbiBGaXJlZm94IDE2LCBidXQgcmVxdWlyZXMgdGhhdFxyXG4gICAgICAgICAgICAvLyB0aGUgZGF0YSBpcyBwcm92aWRlZCBpbiBsYXJnZSBjaHVua3MgKG9yIGluIG11bHRpcGxlcyBvZiA2NCBieXRlcykuXHJcbiAgICAgICAgICAgIGlmIChpbmJ1ZiA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8PSBsZW5ndGhNaW51c0Jsb2NrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnl0ZXMsIG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gKz0gdGhpcy5ibG9ja1NpemU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBieXRlcyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDwgb3B0X2xlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1ZltpbmJ1Zl0gPSBieXRlcy5jaGFyQ29kZUF0KG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICsraW5idWY7XHJcbiAgICAgICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmJ1ZiA9PSB0aGlzLmJsb2NrU2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmJ1ZiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPCBvcHRfbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzW25dO1xyXG4gICAgICAgICAgICAgICAgICAgICsraW5idWY7XHJcbiAgICAgICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmJ1ZiA9PSB0aGlzLmJsb2NrU2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmJ1ZiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5idWZfID0gaW5idWY7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gKz0gb3B0X2xlbmd0aDtcclxuICAgIH07XHJcbiAgICAvKiogQG92ZXJyaWRlICovXHJcbiAgICBTaGExLnByb3RvdHlwZS5kaWdlc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGRpZ2VzdCA9IFtdO1xyXG4gICAgICAgIHZhciB0b3RhbEJpdHMgPSB0aGlzLnRvdGFsXyAqIDg7XHJcbiAgICAgICAgLy8gQWRkIHBhZCAweDgwIDB4MDAqLlxyXG4gICAgICAgIGlmICh0aGlzLmluYnVmXyA8IDU2KSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgNTYgLSB0aGlzLmluYnVmXyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSh0aGlzLnBhZF8sIHRoaXMuYmxvY2tTaXplIC0gKHRoaXMuaW5idWZfIC0gNTYpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQWRkICMgYml0cy5cclxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5ibG9ja1NpemUgLSAxOyBpID49IDU2OyBpLS0pIHtcclxuICAgICAgICAgICAgdGhpcy5idWZfW2ldID0gdG90YWxCaXRzICYgMjU1O1xyXG4gICAgICAgICAgICB0b3RhbEJpdHMgLz0gMjU2OyAvLyBEb24ndCB1c2UgYml0LXNoaWZ0aW5nIGhlcmUhXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29tcHJlc3NfKHRoaXMuYnVmXyk7XHJcbiAgICAgICAgdmFyIG4gPSAwO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAyNDsgaiA+PSAwOyBqIC09IDgpIHtcclxuICAgICAgICAgICAgICAgIGRpZ2VzdFtuXSA9ICh0aGlzLmNoYWluX1tpXSA+PiBqKSAmIDI1NTtcclxuICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGlnZXN0O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTaGExO1xyXG59KEhhc2gpKTtcblxuLyoqXHJcbiAqIEhlbHBlciB0byBtYWtlIGEgU3Vic2NyaWJlIGZ1bmN0aW9uIChqdXN0IGxpa2UgUHJvbWlzZSBoZWxwcyBtYWtlIGFcclxuICogVGhlbmFibGUpLlxyXG4gKlxyXG4gKiBAcGFyYW0gZXhlY3V0b3IgRnVuY3Rpb24gd2hpY2ggY2FuIG1ha2UgY2FsbHMgdG8gYSBzaW5nbGUgT2JzZXJ2ZXJcclxuICogICAgIGFzIGEgcHJveHkuXHJcbiAqIEBwYXJhbSBvbk5vT2JzZXJ2ZXJzIENhbGxiYWNrIHdoZW4gY291bnQgb2YgT2JzZXJ2ZXJzIGdvZXMgdG8gemVyby5cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZVN1YnNjcmliZShleGVjdXRvciwgb25Ob09ic2VydmVycykge1xyXG4gICAgdmFyIHByb3h5ID0gbmV3IE9ic2VydmVyUHJveHkoZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpO1xyXG4gICAgcmV0dXJuIHByb3h5LnN1YnNjcmliZS5iaW5kKHByb3h5KTtcclxufVxyXG4vKipcclxuICogSW1wbGVtZW50IGZhbi1vdXQgZm9yIGFueSBudW1iZXIgb2YgT2JzZXJ2ZXJzIGF0dGFjaGVkIHZpYSBhIHN1YnNjcmliZVxyXG4gKiBmdW5jdGlvbi5cclxuICovXHJcbnZhciBPYnNlcnZlclByb3h5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gZXhlY3V0b3IgRnVuY3Rpb24gd2hpY2ggY2FuIG1ha2UgY2FsbHMgdG8gYSBzaW5nbGUgT2JzZXJ2ZXJcclxuICAgICAqICAgICBhcyBhIHByb3h5LlxyXG4gICAgICogQHBhcmFtIG9uTm9PYnNlcnZlcnMgQ2FsbGJhY2sgd2hlbiBjb3VudCBvZiBPYnNlcnZlcnMgZ29lcyB0byB6ZXJvLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBPYnNlcnZlclByb3h5KGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xyXG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmVzID0gW107XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckNvdW50ID0gMDtcclxuICAgICAgICAvLyBNaWNyby10YXNrIHNjaGVkdWxpbmcgYnkgY2FsbGluZyB0YXNrLnRoZW4oKS5cclxuICAgICAgICB0aGlzLnRhc2sgPSBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICB0aGlzLmZpbmFsaXplZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub25Ob09ic2VydmVycyA9IG9uTm9PYnNlcnZlcnM7XHJcbiAgICAgICAgLy8gQ2FsbCB0aGUgZXhlY3V0b3IgYXN5bmNocm9ub3VzbHkgc28gc3Vic2NyaWJlcnMgdGhhdCBhcmUgY2FsbGVkXHJcbiAgICAgICAgLy8gc3luY2hyb25vdXNseSBhZnRlciB0aGUgY3JlYXRpb24gb2YgdGhlIHN1YnNjcmliZSBmdW5jdGlvblxyXG4gICAgICAgIC8vIGNhbiBzdGlsbCByZWNlaXZlIHRoZSB2ZXJ5IGZpcnN0IHZhbHVlIGdlbmVyYXRlZCBpbiB0aGUgZXhlY3V0b3IuXHJcbiAgICAgICAgdGhpcy50YXNrXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZXhlY3V0b3IoX3RoaXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBfdGhpcy5lcnJvcihlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh2YWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY2xvc2UoZXJyb3IpO1xyXG4gICAgfTtcclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKGZ1bmN0aW9uIChvYnNlcnZlcikge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFN1YnNjcmliZSBmdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGFkZCBhbiBPYnNlcnZlciB0byB0aGUgZmFuLW91dCBsaXN0LlxyXG4gICAgICpcclxuICAgICAqIC0gV2UgcmVxdWlyZSB0aGF0IG5vIGV2ZW50IGlzIHNlbnQgdG8gYSBzdWJzY3JpYmVyIHN5Y2hyb25vdXNseSB0byB0aGVpclxyXG4gICAgICogICBjYWxsIHRvIHN1YnNjcmliZSgpLlxyXG4gICAgICovXHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG9ic2VydmVyO1xyXG4gICAgICAgIGlmIChuZXh0T3JPYnNlcnZlciA9PT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgIGVycm9yID09PSB1bmRlZmluZWQgJiZcclxuICAgICAgICAgICAgY29tcGxldGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgT2JzZXJ2ZXIuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEFzc2VtYmxlIGFuIE9ic2VydmVyIG9iamVjdCB3aGVuIHBhc3NlZCBhcyBjYWxsYmFjayBmdW5jdGlvbnMuXHJcbiAgICAgICAgaWYgKGltcGxlbWVudHNBbnlNZXRob2RzKG5leHRPck9ic2VydmVyLCBbJ25leHQnLCAnZXJyb3InLCAnY29tcGxldGUnXSkpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSBuZXh0T3JPYnNlcnZlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyID0ge1xyXG4gICAgICAgICAgICAgICAgbmV4dDogbmV4dE9yT2JzZXJ2ZXIsXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IsXHJcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogY29tcGxldGVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9ic2VydmVyLm5leHQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0ID0gbm9vcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9ic2VydmVyLmVycm9yID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IgPSBub29wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIuY29tcGxldGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSA9IG5vb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB1bnN1YiA9IHRoaXMudW5zdWJzY3JpYmVPbmUuYmluZCh0aGlzLCB0aGlzLm9ic2VydmVycy5sZW5ndGgpO1xyXG4gICAgICAgIC8vIEF0dGVtcHQgdG8gc3Vic2NyaWJlIHRvIGEgdGVybWluYXRlZCBPYnNlcnZhYmxlIC0gd2VcclxuICAgICAgICAvLyBqdXN0IHJlc3BvbmQgdG8gdGhlIE9ic2VydmVyIHdpdGggdGhlIGZpbmFsIGVycm9yIG9yIGNvbXBsZXRlXHJcbiAgICAgICAgLy8gZXZlbnQuXHJcbiAgICAgICAgaWYgKHRoaXMuZmluYWxpemVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFzay50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmZpbmFsRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoX3RoaXMuZmluYWxFcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbm90aGluZ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvYnNlcnZlcik7XHJcbiAgICAgICAgcmV0dXJuIHVuc3ViO1xyXG4gICAgfTtcclxuICAgIC8vIFVuc3Vic2NyaWJlIGlzIHN5bmNocm9ub3VzIC0gd2UgZ3VhcmFudGVlIHRoYXQgbm8gZXZlbnRzIGFyZSBzZW50IHRvXHJcbiAgICAvLyBhbnkgdW5zdWJzY3JpYmVkIE9ic2VydmVyLlxyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUudW5zdWJzY3JpYmVPbmUgPSBmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVycyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMub2JzZXJ2ZXJzW2ldID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkZWxldGUgdGhpcy5vYnNlcnZlcnNbaV07XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckNvdW50IC09IDE7XHJcbiAgICAgICAgaWYgKHRoaXMub2JzZXJ2ZXJDb3VudCA9PT0gMCAmJiB0aGlzLm9uTm9PYnNlcnZlcnMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnModGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLmZvckVhY2hPYnNlcnZlciA9IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICAvLyBBbHJlYWR5IGNsb3NlZCBieSBwcmV2aW91cyBldmVudC4uLi5qdXN0IGVhdCB0aGUgYWRkaXRpb25hbCB2YWx1ZXMuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU2luY2Ugc2VuZE9uZSBjYWxscyBhc3luY2hyb25vdXNseSAtIHRoZXJlIGlzIG5vIGNoYW5jZSB0aGF0XHJcbiAgICAgICAgLy8gdGhpcy5vYnNlcnZlcnMgd2lsbCBiZWNvbWUgdW5kZWZpbmVkLlxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5zZW5kT25lKGksIGZuKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gQ2FsbCB0aGUgT2JzZXJ2ZXIgdmlhIG9uZSBvZiBpdCdzIGNhbGxiYWNrIGZ1bmN0aW9uLiBXZSBhcmUgY2FyZWZ1bCB0b1xyXG4gICAgLy8gY29uZmlybSB0aGF0IHRoZSBvYnNlcnZlIGhhcyBub3QgYmVlbiB1bnN1YnNjcmliZWQgc2luY2UgdGhpcyBhc3luY2hyb25vdXNcclxuICAgIC8vIGZ1bmN0aW9uIGhhZCBiZWVuIHF1ZXVlZC5cclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLnNlbmRPbmUgPSBmdW5jdGlvbiAoaSwgZm4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIEV4ZWN1dGUgdGhlIGNhbGxiYWNrIGFzeW5jaHJvbm91c2x5XHJcbiAgICAgICAgdGhpcy50YXNrLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMub2JzZXJ2ZXJzICE9PSB1bmRlZmluZWQgJiYgX3RoaXMub2JzZXJ2ZXJzW2ldICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm4oX3RoaXMub2JzZXJ2ZXJzW2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIGV4Y2VwdGlvbnMgcmFpc2VkIGluIE9ic2VydmVycyBvciBtaXNzaW5nIG1ldGhvZHMgb2YgYW5cclxuICAgICAgICAgICAgICAgICAgICAvLyBPYnNlcnZlci5cclxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgdG8gY29uc29sZS4gYi8zMTQwNDgwNlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYgY29uc29sZS5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMuZmluYWxpemVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5maW5hbGl6ZWQgPSB0cnVlO1xyXG4gICAgICAgIGlmIChlcnIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLmZpbmFsRXJyb3IgPSBlcnI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFByb3h5IGlzIG5vIGxvbmdlciBuZWVkZWQgLSBnYXJiYWdlIGNvbGxlY3QgcmVmZXJlbmNlc1xyXG4gICAgICAgIHRoaXMudGFzay50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMub2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBfdGhpcy5vbk5vT2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBPYnNlcnZlclByb3h5O1xyXG59KCkpO1xyXG4vKiogVHVybiBzeW5jaHJvbm91cyBmdW5jdGlvbiBpbnRvIG9uZSBjYWxsZWQgYXN5bmNocm9ub3VzbHkuICovXHJcbmZ1bmN0aW9uIGFzeW5jKGZuLCBvbkVycm9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQcm9taXNlLnJlc29sdmUodHJ1ZSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBmbi5hcHBseSh2b2lkIDAsIGFyZ3MpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgb2JqZWN0IHBhc3NlZCBpbiBpbXBsZW1lbnRzIGFueSBvZiB0aGUgbmFtZWQgbWV0aG9kcy5cclxuICovXHJcbmZ1bmN0aW9uIGltcGxlbWVudHNBbnlNZXRob2RzKG9iaiwgbWV0aG9kcykge1xyXG4gICAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnIHx8IG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIF9pID0gMCwgbWV0aG9kc18xID0gbWV0aG9kczsgX2kgPCBtZXRob2RzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIG1ldGhvZCA9IG1ldGhvZHNfMVtfaV07XHJcbiAgICAgICAgaWYgKG1ldGhvZCBpbiBvYmogJiYgdHlwZW9mIG9ialttZXRob2RdID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiBub29wKCkge1xyXG4gICAgLy8gZG8gbm90aGluZ1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQ2hlY2sgdG8gbWFrZSBzdXJlIHRoZSBhcHByb3ByaWF0ZSBudW1iZXIgb2YgYXJndW1lbnRzIGFyZSBwcm92aWRlZCBmb3IgYSBwdWJsaWMgZnVuY3Rpb24uXHJcbiAqIFRocm93cyBhbiBlcnJvciBpZiBpdCBmYWlscy5cclxuICpcclxuICogQHBhcmFtIHshc3RyaW5nfSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcclxuICogQHBhcmFtIHshbnVtYmVyfSBtaW5Db3VudCBUaGUgbWluaW11bSBudW1iZXIgb2YgYXJndW1lbnRzIHRvIGFsbG93IGZvciB0aGUgZnVuY3Rpb24gY2FsbFxyXG4gKiBAcGFyYW0geyFudW1iZXJ9IG1heENvdW50IFRoZSBtYXhpbXVtIG51bWJlciBvZiBhcmd1bWVudCB0byBhbGxvdyBmb3IgdGhlIGZ1bmN0aW9uIGNhbGxcclxuICogQHBhcmFtIHshbnVtYmVyfSBhcmdDb3VudCBUaGUgYWN0dWFsIG51bWJlciBvZiBhcmd1bWVudHMgcHJvdmlkZWQuXHJcbiAqL1xyXG52YXIgdmFsaWRhdGVBcmdDb3VudCA9IGZ1bmN0aW9uIChmbk5hbWUsIG1pbkNvdW50LCBtYXhDb3VudCwgYXJnQ291bnQpIHtcclxuICAgIHZhciBhcmdFcnJvcjtcclxuICAgIGlmIChhcmdDb3VudCA8IG1pbkNvdW50KSB7XHJcbiAgICAgICAgYXJnRXJyb3IgPSAnYXQgbGVhc3QgJyArIG1pbkNvdW50O1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoYXJnQ291bnQgPiBtYXhDb3VudCkge1xyXG4gICAgICAgIGFyZ0Vycm9yID0gbWF4Q291bnQgPT09IDAgPyAnbm9uZScgOiAnbm8gbW9yZSB0aGFuICcgKyBtYXhDb3VudDtcclxuICAgIH1cclxuICAgIGlmIChhcmdFcnJvcikge1xyXG4gICAgICAgIHZhciBlcnJvciA9IGZuTmFtZSArXHJcbiAgICAgICAgICAgICcgZmFpbGVkOiBXYXMgY2FsbGVkIHdpdGggJyArXHJcbiAgICAgICAgICAgIGFyZ0NvdW50ICtcclxuICAgICAgICAgICAgKGFyZ0NvdW50ID09PSAxID8gJyBhcmd1bWVudC4nIDogJyBhcmd1bWVudHMuJykgK1xyXG4gICAgICAgICAgICAnIEV4cGVjdHMgJyArXHJcbiAgICAgICAgICAgIGFyZ0Vycm9yICtcclxuICAgICAgICAgICAgJy4nO1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBHZW5lcmF0ZXMgYSBzdHJpbmcgdG8gcHJlZml4IGFuIGVycm9yIG1lc3NhZ2UgYWJvdXQgZmFpbGVkIGFyZ3VtZW50IHZhbGlkYXRpb25cclxuICpcclxuICogQHBhcmFtIHshc3RyaW5nfSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcclxuICogQHBhcmFtIHshbnVtYmVyfSBhcmd1bWVudE51bWJlciBUaGUgaW5kZXggb2YgdGhlIGFyZ3VtZW50XHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9uYWwgV2hldGhlciBvciBub3QgdGhlIGFyZ3VtZW50IGlzIG9wdGlvbmFsXHJcbiAqIEByZXR1cm4geyFzdHJpbmd9IFRoZSBwcmVmaXggdG8gYWRkIHRvIHRoZSBlcnJvciB0aHJvd24gZm9yIHZhbGlkYXRpb24uXHJcbiAqL1xyXG5mdW5jdGlvbiBlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkge1xyXG4gICAgdmFyIGFyZ05hbWUgPSAnJztcclxuICAgIHN3aXRjaCAoYXJndW1lbnROdW1iZXIpIHtcclxuICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgIGFyZ05hbWUgPSBvcHRpb25hbCA/ICdmaXJzdCcgOiAnRmlyc3QnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgIGFyZ05hbWUgPSBvcHRpb25hbCA/ICdzZWNvbmQnIDogJ1NlY29uZCc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgYXJnTmFtZSA9IG9wdGlvbmFsID8gJ3RoaXJkJyA6ICdUaGlyZCc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgYXJnTmFtZSA9IG9wdGlvbmFsID8gJ2ZvdXJ0aCcgOiAnRm91cnRoJztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdlcnJvclByZWZpeCBjYWxsZWQgd2l0aCBhcmd1bWVudE51bWJlciA+IDQuICBOZWVkIHRvIHVwZGF0ZSBpdD8nKTtcclxuICAgIH1cclxuICAgIHZhciBlcnJvciA9IGZuTmFtZSArICcgZmFpbGVkOiAnO1xyXG4gICAgZXJyb3IgKz0gYXJnTmFtZSArICcgYXJndW1lbnQgJztcclxuICAgIHJldHVybiBlcnJvcjtcclxufVxyXG4vKipcclxuICogQHBhcmFtIHshc3RyaW5nfSBmbk5hbWVcclxuICogQHBhcmFtIHshbnVtYmVyfSBhcmd1bWVudE51bWJlclxyXG4gKiBAcGFyYW0geyFzdHJpbmd9IG5hbWVzcGFjZVxyXG4gKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbmFsXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVzcGFjZShmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBuYW1lc3BhY2UsIG9wdGlvbmFsKSB7XHJcbiAgICBpZiAob3B0aW9uYWwgJiYgIW5hbWVzcGFjZSlcclxuICAgICAgICByZXR1cm47XHJcbiAgICBpZiAodHlwZW9mIG5hbWVzcGFjZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAvL1RPRE86IEkgc2hvdWxkIGRvIG1vcmUgdmFsaWRhdGlvbiBoZXJlLiBXZSBvbmx5IGFsbG93IGNlcnRhaW4gY2hhcnMgaW4gbmFtZXNwYWNlcy5cclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpICtcclxuICAgICAgICAgICAgJ211c3QgYmUgYSB2YWxpZCBmaXJlYmFzZSBuYW1lc3BhY2UuJyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVDYWxsYmFjayhmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBjYWxsYmFjaywgb3B0aW9uYWwpIHtcclxuICAgIGlmIChvcHRpb25hbCAmJiAhY2FsbGJhY2spXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gJ2Z1bmN0aW9uJylcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpICtcclxuICAgICAgICAgICAgJ211c3QgYmUgYSB2YWxpZCBmdW5jdGlvbi4nKTtcclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUNvbnRleHRPYmplY3QoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgY29udGV4dCwgb3B0aW9uYWwpIHtcclxuICAgIGlmIChvcHRpb25hbCAmJiAhY29udGV4dClcclxuICAgICAgICByZXR1cm47XHJcbiAgICBpZiAodHlwZW9mIGNvbnRleHQgIT09ICdvYmplY3QnIHx8IGNvbnRleHQgPT09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9wdGlvbmFsKSArXHJcbiAgICAgICAgICAgICdtdXN0IGJlIGEgdmFsaWQgY29udGV4dCBvYmplY3QuJyk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIENvZGUgb3JpZ2luYWxseSBjYW1lIGZyb20gZ29vZy5jcnlwdC5zdHJpbmdUb1V0ZjhCeXRlQXJyYXksIGJ1dCBmb3Igc29tZSByZWFzb24gdGhleVxyXG4vLyBhdXRvbWF0aWNhbGx5IHJlcGxhY2VkICdcXHJcXG4nIHdpdGggJ1xcbicsIGFuZCB0aGV5IGRpZG4ndCBoYW5kbGUgc3Vycm9nYXRlIHBhaXJzLFxyXG4vLyBzbyBpdCdzIGJlZW4gbW9kaWZpZWQuXHJcbi8vIE5vdGUgdGhhdCBub3QgYWxsIFVuaWNvZGUgY2hhcmFjdGVycyBhcHBlYXIgYXMgc2luZ2xlIGNoYXJhY3RlcnMgaW4gSmF2YVNjcmlwdCBzdHJpbmdzLlxyXG4vLyBmcm9tQ2hhckNvZGUgcmV0dXJucyB0aGUgVVRGLTE2IGVuY29kaW5nIG9mIGEgY2hhcmFjdGVyIC0gc28gc29tZSBVbmljb2RlIGNoYXJhY3RlcnNcclxuLy8gdXNlIDIgY2hhcmFjdGVycyBpbiBKYXZhc2NyaXB0LiAgQWxsIDQtYnl0ZSBVVEYtOCBjaGFyYWN0ZXJzIGJlZ2luIHdpdGggYSBmaXJzdFxyXG4vLyBjaGFyYWN0ZXIgaW4gdGhlIHJhbmdlIDB4RDgwMCAtIDB4REJGRiAodGhlIGZpcnN0IGNoYXJhY3RlciBvZiBhIHNvLWNhbGxlZCBzdXJyb2dhdGVcclxuLy8gcGFpcikuXHJcbi8vIFNlZSBodHRwOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuMS4zXHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyXHJcbiAqIEByZXR1cm4ge0FycmF5fVxyXG4gKi9cclxudmFyIHN0cmluZ1RvQnl0ZUFycmF5JDEgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICB2YXIgb3V0ID0gW10sIHAgPSAwO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIC8vIElzIHRoaXMgdGhlIGxlYWQgc3Vycm9nYXRlIGluIGEgc3Vycm9nYXRlIHBhaXI/XHJcbiAgICAgICAgaWYgKGMgPj0gMHhkODAwICYmIGMgPD0gMHhkYmZmKSB7XHJcbiAgICAgICAgICAgIHZhciBoaWdoID0gYyAtIDB4ZDgwMDsgLy8gdGhlIGhpZ2ggMTAgYml0cy5cclxuICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICBhc3NlcnQoaSA8IHN0ci5sZW5ndGgsICdTdXJyb2dhdGUgcGFpciBtaXNzaW5nIHRyYWlsIHN1cnJvZ2F0ZS4nKTtcclxuICAgICAgICAgICAgdmFyIGxvdyA9IHN0ci5jaGFyQ29kZUF0KGkpIC0gMHhkYzAwOyAvLyB0aGUgbG93IDEwIGJpdHMuXHJcbiAgICAgICAgICAgIGMgPSAweDEwMDAwICsgKGhpZ2ggPDwgMTApICsgbG93O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYyA8IDEyOCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gNikgfCAxOTI7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCA2NTUzNikge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDEyKSB8IDIyNDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDE4KSB8IDI0MDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gMTIpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0O1xyXG59O1xyXG4vKipcclxuICogQ2FsY3VsYXRlIGxlbmd0aCB3aXRob3V0IGFjdHVhbGx5IGNvbnZlcnRpbmc7IHVzZWZ1bCBmb3IgZG9pbmcgY2hlYXBlciB2YWxpZGF0aW9uLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyXHJcbiAqIEByZXR1cm4ge251bWJlcn1cclxuICovXHJcbnZhciBzdHJpbmdMZW5ndGggPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICB2YXIgcCA9IDA7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgaWYgKGMgPCAxMjgpIHtcclxuICAgICAgICAgICAgcCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgMjA0OCkge1xyXG4gICAgICAgICAgICBwICs9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPj0gMHhkODAwICYmIGMgPD0gMHhkYmZmKSB7XHJcbiAgICAgICAgICAgIC8vIExlYWQgc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXIuICBUaGUgcGFpciB0b2dldGhlciB3aWxsIHRha2UgNCBieXRlcyB0byByZXByZXNlbnQuXHJcbiAgICAgICAgICAgIHAgKz0gNDtcclxuICAgICAgICAgICAgaSsrOyAvLyBza2lwIHRyYWlsIHN1cnJvZ2F0ZS5cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHAgKz0gMztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcDtcclxufTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbmV4cG9ydHMuYXNzZXJ0ID0gYXNzZXJ0O1xuZXhwb3J0cy5hc3NlcnRpb25FcnJvciA9IGFzc2VydGlvbkVycm9yO1xuZXhwb3J0cy5iYXNlNjQgPSBiYXNlNjQ7XG5leHBvcnRzLmJhc2U2NERlY29kZSA9IGJhc2U2NERlY29kZTtcbmV4cG9ydHMuYmFzZTY0RW5jb2RlID0gYmFzZTY0RW5jb2RlO1xuZXhwb3J0cy5DT05TVEFOVFMgPSBDT05TVEFOVFM7XG5leHBvcnRzLmRlZXBDb3B5ID0gZGVlcENvcHk7XG5leHBvcnRzLmRlZXBFeHRlbmQgPSBkZWVwRXh0ZW5kO1xuZXhwb3J0cy5wYXRjaFByb3BlcnR5ID0gcGF0Y2hQcm9wZXJ0eTtcbmV4cG9ydHMuRGVmZXJyZWQgPSBEZWZlcnJlZDtcbmV4cG9ydHMuZ2V0VUEgPSBnZXRVQTtcbmV4cG9ydHMuaXNNb2JpbGVDb3Jkb3ZhID0gaXNNb2JpbGVDb3Jkb3ZhO1xuZXhwb3J0cy5pc05vZGVTZGsgPSBpc05vZGVTZGs7XG5leHBvcnRzLmlzUmVhY3ROYXRpdmUgPSBpc1JlYWN0TmF0aXZlO1xuZXhwb3J0cy5FcnJvckZhY3RvcnkgPSBFcnJvckZhY3Rvcnk7XG5leHBvcnRzLkZpcmViYXNlRXJyb3IgPSBGaXJlYmFzZUVycm9yO1xuZXhwb3J0cy5wYXRjaENhcHR1cmUgPSBwYXRjaENhcHR1cmU7XG5leHBvcnRzLmpzb25FdmFsID0ganNvbkV2YWw7XG5leHBvcnRzLnN0cmluZ2lmeSA9IHN0cmluZ2lmeTtcbmV4cG9ydHMuZGVjb2RlID0gZGVjb2RlO1xuZXhwb3J0cy5pc0FkbWluID0gaXNBZG1pbjtcbmV4cG9ydHMuaXNzdWVkQXRUaW1lID0gaXNzdWVkQXRUaW1lO1xuZXhwb3J0cy5pc1ZhbGlkRm9ybWF0ID0gaXNWYWxpZEZvcm1hdDtcbmV4cG9ydHMuaXNWYWxpZFRpbWVzdGFtcCA9IGlzVmFsaWRUaW1lc3RhbXA7XG5leHBvcnRzLmNsb25lID0gY2xvbmU7XG5leHBvcnRzLmNvbnRhaW5zID0gY29udGFpbnM7XG5leHBvcnRzLmV2ZXJ5ID0gZXZlcnk7XG5leHBvcnRzLmV4dGVuZCA9IGV4dGVuZDtcbmV4cG9ydHMuZmluZEtleSA9IGZpbmRLZXk7XG5leHBvcnRzLmZpbmRWYWx1ZSA9IGZpbmRWYWx1ZTtcbmV4cG9ydHMuZm9yRWFjaCA9IGZvckVhY2g7XG5leHBvcnRzLmdldEFueUtleSA9IGdldEFueUtleTtcbmV4cG9ydHMuZ2V0Q291bnQgPSBnZXRDb3VudDtcbmV4cG9ydHMuZ2V0VmFsdWVzID0gZ2V0VmFsdWVzO1xuZXhwb3J0cy5pc0VtcHR5ID0gaXNFbXB0eTtcbmV4cG9ydHMuaXNOb25OdWxsT2JqZWN0ID0gaXNOb25OdWxsT2JqZWN0O1xuZXhwb3J0cy5tYXAgPSBtYXA7XG5leHBvcnRzLnNhZmVHZXQgPSBzYWZlR2V0O1xuZXhwb3J0cy5xdWVyeXN0cmluZyA9IHF1ZXJ5c3RyaW5nO1xuZXhwb3J0cy5xdWVyeXN0cmluZ0RlY29kZSA9IHF1ZXJ5c3RyaW5nRGVjb2RlO1xuZXhwb3J0cy5TaGExID0gU2hhMTtcbmV4cG9ydHMuYXN5bmMgPSBhc3luYztcbmV4cG9ydHMuY3JlYXRlU3Vic2NyaWJlID0gY3JlYXRlU3Vic2NyaWJlO1xuZXhwb3J0cy5lcnJvclByZWZpeCA9IGVycm9yUHJlZml4O1xuZXhwb3J0cy52YWxpZGF0ZUFyZ0NvdW50ID0gdmFsaWRhdGVBcmdDb3VudDtcbmV4cG9ydHMudmFsaWRhdGVDYWxsYmFjayA9IHZhbGlkYXRlQ2FsbGJhY2s7XG5leHBvcnRzLnZhbGlkYXRlQ29udGV4dE9iamVjdCA9IHZhbGlkYXRlQ29udGV4dE9iamVjdDtcbmV4cG9ydHMudmFsaWRhdGVOYW1lc3BhY2UgPSB2YWxpZGF0ZU5hbWVzcGFjZTtcbmV4cG9ydHMuc3RyaW5nTGVuZ3RoID0gc3RyaW5nTGVuZ3RoO1xuZXhwb3J0cy5zdHJpbmdUb0J5dGVBcnJheSA9IHN0cmluZ1RvQnl0ZUFycmF5JDE7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vQGZpcmViYXNlL3V0aWwvZGlzdC9pbmRleC5janMuanNcbi8vIG1vZHVsZSBpZCA9IDM4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDoge307XG5cbnZhciBlLGdvb2c9Z29vZ3x8e30saD1jb21tb25qc0dsb2JhbDtmdW5jdGlvbiBsKGEpe3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiBhfWZ1bmN0aW9uIG0oYSxiKXthPWEuc3BsaXQoXCIuXCIpO2I9Ynx8aDtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKylpZihiPWJbYVtjXV0sIG51bGw9PWIpcmV0dXJuIG51bGw7cmV0dXJuIGJ9ZnVuY3Rpb24gYWEoKXt9XG5mdW5jdGlvbiBiYShhKXt2YXIgYj10eXBlb2YgYTtpZihcIm9iamVjdFwiPT1iKWlmKGEpe2lmKGEgaW5zdGFuY2VvZiBBcnJheSlyZXR1cm5cImFycmF5XCI7aWYoYSBpbnN0YW5jZW9mIE9iamVjdClyZXR1cm4gYjt2YXIgYz1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSk7aWYoXCJbb2JqZWN0IFdpbmRvd11cIj09YylyZXR1cm5cIm9iamVjdFwiO2lmKFwiW29iamVjdCBBcnJheV1cIj09Y3x8XCJudW1iZXJcIj09dHlwZW9mIGEubGVuZ3RoJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5zcGxpY2UmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLnByb3BlcnR5SXNFbnVtZXJhYmxlJiYhYS5wcm9wZXJ0eUlzRW51bWVyYWJsZShcInNwbGljZVwiKSlyZXR1cm5cImFycmF5XCI7aWYoXCJbb2JqZWN0IEZ1bmN0aW9uXVwiPT1jfHxcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5jYWxsJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5wcm9wZXJ0eUlzRW51bWVyYWJsZSYmIWEucHJvcGVydHlJc0VudW1lcmFibGUoXCJjYWxsXCIpKXJldHVyblwiZnVuY3Rpb25cIn1lbHNlIHJldHVyblwibnVsbFwiO1xuZWxzZSBpZihcImZ1bmN0aW9uXCI9PWImJlwidW5kZWZpbmVkXCI9PXR5cGVvZiBhLmNhbGwpcmV0dXJuXCJvYmplY3RcIjtyZXR1cm4gYn1mdW5jdGlvbiBuKGEpe3JldHVyblwiYXJyYXlcIj09YmEoYSl9ZnVuY3Rpb24gY2EoYSl7dmFyIGI9YmEoYSk7cmV0dXJuXCJhcnJheVwiPT1ifHxcIm9iamVjdFwiPT1iJiZcIm51bWJlclwiPT10eXBlb2YgYS5sZW5ndGh9ZnVuY3Rpb24gcShhKXtyZXR1cm5cImZ1bmN0aW9uXCI9PWJhKGEpfWZ1bmN0aW9uIHIoYSl7dmFyIGI9dHlwZW9mIGE7cmV0dXJuXCJvYmplY3RcIj09YiYmbnVsbCE9YXx8XCJmdW5jdGlvblwiPT1ifXZhciB0PVwiY2xvc3VyZV91aWRfXCIrKDFFOSpNYXRoLnJhbmRvbSgpPj4+MCksZGE9MDtmdW5jdGlvbiBlYShhLGIsYyl7cmV0dXJuIGEuY2FsbC5hcHBseShhLmJpbmQsYXJndW1lbnRzKX1cbmZ1bmN0aW9uIGZhKGEsYixjKXtpZighYSl0aHJvdyBFcnJvcigpO2lmKDI8YXJndW1lbnRzLmxlbmd0aCl7dmFyIGQ9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBmdW5jdGlvbigpe3ZhciBjPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7QXJyYXkucHJvdG90eXBlLnVuc2hpZnQuYXBwbHkoYyxkKTtyZXR1cm4gYS5hcHBseShiLGMpfX1yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShiLGFyZ3VtZW50cyl9fWZ1bmN0aW9uIHUoYSxiLGMpe3U9RnVuY3Rpb24ucHJvdG90eXBlLmJpbmQmJi0xIT1GdW5jdGlvbi5wcm90b3R5cGUuYmluZC50b1N0cmluZygpLmluZGV4T2YoXCJuYXRpdmUgY29kZVwiKT9lYTpmYTtyZXR1cm4gdS5hcHBseShudWxsLGFyZ3VtZW50cyl9XG5mdW5jdGlvbiB2KGEsYil7dmFyIGM9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO3JldHVybiBmdW5jdGlvbigpe3ZhciBiPWMuc2xpY2UoKTtiLnB1c2guYXBwbHkoYixhcmd1bWVudHMpO3JldHVybiBhLmFwcGx5KHRoaXMsYil9fXZhciB3PURhdGUubm93fHxmdW5jdGlvbigpe3JldHVybituZXcgRGF0ZX07ZnVuY3Rpb24geChhLGIpe2Z1bmN0aW9uIGMoKXt9Yy5wcm90b3R5cGU9Yi5wcm90b3R5cGU7YS5MPWIucHJvdG90eXBlO2EucHJvdG90eXBlPW5ldyBjO2EucHJvdG90eXBlLmNvbnN0cnVjdG9yPWE7YS5taD1mdW5jdGlvbihhLGMsZyl7Zm9yKHZhciBkPUFycmF5KGFyZ3VtZW50cy5sZW5ndGgtMiksZj0yO2Y8YXJndW1lbnRzLmxlbmd0aDtmKyspZFtmLTJdPWFyZ3VtZW50c1tmXTtyZXR1cm4gYi5wcm90b3R5cGVbY10uYXBwbHkoYSxkKX07fWZ1bmN0aW9uIHkoYSl7aWYoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcyx5KTtlbHNle3ZhciBiPUVycm9yKCkuc3RhY2s7YiYmKHRoaXMuc3RhY2s9Yik7fWEmJih0aGlzLm1lc3NhZ2U9U3RyaW5nKGEpKTt9eCh5LEVycm9yKTt5LnByb3RvdHlwZS5uYW1lPVwiQ3VzdG9tRXJyb3JcIjtmdW5jdGlvbiBoYShhLGIpe2E9YS5zcGxpdChcIiVzXCIpO2Zvcih2YXIgYz1cIlwiLGQ9YS5sZW5ndGgtMSxmPTA7ZjxkO2YrKyljKz1hW2ZdKyhmPGIubGVuZ3RoP2JbZl06XCIlc1wiKTt5LmNhbGwodGhpcyxjK2FbZF0pO314KGhhLHkpO2hhLnByb3RvdHlwZS5uYW1lPVwiQXNzZXJ0aW9uRXJyb3JcIjtmdW5jdGlvbiBpYShhLGIpe3Rocm93IG5ldyBoYShcIkZhaWx1cmVcIisoYT9cIjogXCIrYTpcIlwiKSxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO31mdW5jdGlvbiB6KCl7MCE9amEmJihrYVt0aGlzW3RdfHwodGhpc1t0XT0rK2RhKV09dGhpcyk7dGhpcy5LYT10aGlzLkthO3RoaXMuUWE9dGhpcy5RYTt9dmFyIGphPTAsa2E9e307ei5wcm90b3R5cGUuS2E9ITE7ei5wcm90b3R5cGUuYmI9ZnVuY3Rpb24oKXtpZighdGhpcy5LYSYmKHRoaXMuS2E9ITAsIHRoaXMuRigpLCAwIT1qYSkpe3ZhciBhPXRoaXNbdF18fCh0aGlzW3RdPSsrZGEpO2lmKDAhPWphJiZ0aGlzLlFhJiYwPHRoaXMuUWEubGVuZ3RoKXRocm93IEVycm9yKHRoaXMrXCIgZGlkIG5vdCBlbXB0eSBpdHMgb25EaXNwb3NlQ2FsbGJhY2tzIHF1ZXVlLiBUaGlzIHByb2JhYmx5IG1lYW5zIGl0IG92ZXJyb2RlIGRpc3Bvc2UoKSBvciBkaXNwb3NlSW50ZXJuYWwoKSB3aXRob3V0IGNhbGxpbmcgdGhlIHN1cGVyY2xhc3MnIG1ldGhvZC5cIik7ZGVsZXRlIGthW2FdO319O3oucHJvdG90eXBlLkY9ZnVuY3Rpb24oKXtpZih0aGlzLlFhKWZvcig7dGhpcy5RYS5sZW5ndGg7KXRoaXMuUWEuc2hpZnQoKSgpO307dmFyIGxhPUFycmF5LnByb3RvdHlwZS5pbmRleE9mP2Z1bmN0aW9uKGEsYil7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoYSxiLHZvaWQgMCl9OmZ1bmN0aW9uKGEsYil7aWYobChhKSlyZXR1cm4gbChiKSYmMT09Yi5sZW5ndGg/YS5pbmRleE9mKGIsMCk6LTE7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspaWYoYyBpbiBhJiZhW2NdPT09YilyZXR1cm4gYztyZXR1cm4tMX0sbWE9QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mP2Z1bmN0aW9uKGEsYil7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZi5jYWxsKGEsYixhLmxlbmd0aC0xKX06ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmxlbmd0aC0xOzA+YyYmKGM9TWF0aC5tYXgoMCxhLmxlbmd0aCtjKSk7aWYobChhKSlyZXR1cm4gbChiKSYmMT09Yi5sZW5ndGg/YS5sYXN0SW5kZXhPZihiLGMpOi0xO2Zvcig7MDw9YztjLS0paWYoYyBpbiBhJiZhW2NdPT09YilyZXR1cm4gYztyZXR1cm4tMX0sbmE9XG5BcnJheS5wcm90b3R5cGUuZm9yRWFjaD9mdW5jdGlvbihhLGIsYyl7QXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChhLGIsYyk7fTpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPWEubGVuZ3RoLGY9bChhKT9hLnNwbGl0KFwiXCIpOmEsZz0wO2c8ZDtnKyspZyBpbiBmJiZiLmNhbGwoYyxmW2ddLGcsYSk7fSxvYT1BcnJheS5wcm90b3R5cGUuc29tZT9mdW5jdGlvbihhLGIpe3JldHVybiBBcnJheS5wcm90b3R5cGUuc29tZS5jYWxsKGEsYix2b2lkIDApfTpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1hLmxlbmd0aCxkPWwoYSk/YS5zcGxpdChcIlwiKTphLGY9MDtmPGM7ZisrKWlmKGYgaW4gZCYmYi5jYWxsKHZvaWQgMCxkW2ZdLGYsYSkpcmV0dXJuITA7cmV0dXJuITF9O1xuZnVuY3Rpb24gcGEoYSl7YTp7dmFyIGI9cWE7Zm9yKHZhciBjPWEubGVuZ3RoLGQ9bChhKT9hLnNwbGl0KFwiXCIpOmEsZj0wO2Y8YztmKyspaWYoZiBpbiBkJiZiLmNhbGwodm9pZCAwLGRbZl0sZixhKSl7Yj1mO2JyZWFrIGF9Yj0tMTt9cmV0dXJuIDA+Yj9udWxsOmwoYSk/YS5jaGFyQXQoYik6YVtiXX1mdW5jdGlvbiByYShhKXtpZighbihhKSlmb3IodmFyIGI9YS5sZW5ndGgtMTswPD1iO2ItLSlkZWxldGUgYVtiXTthLmxlbmd0aD0wO31mdW5jdGlvbiBzYShhLGIpe2I9bGEoYSxiKTt2YXIgYzsoYz0wPD1iKSYmQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGEsYiwxKTtyZXR1cm4gY31mdW5jdGlvbiB0YShhKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmNvbmNhdC5hcHBseShbXSxhcmd1bWVudHMpfWZ1bmN0aW9uIHVhKGEpe3ZhciBiPWEubGVuZ3RoO2lmKDA8Yil7Zm9yKHZhciBjPUFycmF5KGIpLGQ9MDtkPGI7ZCsrKWNbZF09YVtkXTtyZXR1cm4gY31yZXR1cm5bXX1mdW5jdGlvbiB2YShhKXtyZXR1cm4vXltcXHNcXHhhMF0qJC8udGVzdChhKX12YXIgd2E9U3RyaW5nLnByb3RvdHlwZS50cmltP2Z1bmN0aW9uKGEpe3JldHVybiBhLnRyaW0oKX06ZnVuY3Rpb24oYSl7cmV0dXJuL15bXFxzXFx4YTBdKihbXFxzXFxTXSo/KVtcXHNcXHhhMF0qJC8uZXhlYyhhKVsxXX07ZnVuY3Rpb24geGEoYSxiKXtyZXR1cm4gYTxiPy0xOmE+Yj8xOjB9dmFyIEE7YTp7dmFyIHlhPWgubmF2aWdhdG9yO2lmKHlhKXt2YXIgemE9eWEudXNlckFnZW50O2lmKHphKXtBPXphO2JyZWFrIGF9fUE9XCJcIjt9ZnVuY3Rpb24gQihhKXtyZXR1cm4tMSE9QS5pbmRleE9mKGEpfWZ1bmN0aW9uIEFhKGEsYixjKXtmb3IodmFyIGQgaW4gYSliLmNhbGwoYyxhW2RdLGQsYSk7fWZ1bmN0aW9uIEJhKGEpe3ZhciBiPVtdLGM9MCxkO2ZvcihkIGluIGEpYltjKytdPWFbZF07cmV0dXJuIGJ9ZnVuY3Rpb24gQ2EoYSl7dmFyIGI9W10sYz0wLGQ7Zm9yKGQgaW4gYSliW2MrK109ZDtyZXR1cm4gYn1mdW5jdGlvbiBEYShhKXt2YXIgYj17fSxjO2ZvcihjIGluIGEpYltjXT1hW2NdO3JldHVybiBifXZhciBFYT1cImNvbnN0cnVjdG9yIGhhc093blByb3BlcnR5IGlzUHJvdG90eXBlT2YgcHJvcGVydHlJc0VudW1lcmFibGUgdG9Mb2NhbGVTdHJpbmcgdG9TdHJpbmcgdmFsdWVPZlwiLnNwbGl0KFwiIFwiKTtcbmZ1bmN0aW9uIEZhKGEsYil7Zm9yKHZhciBjLGQsZj0xO2Y8YXJndW1lbnRzLmxlbmd0aDtmKyspe2Q9YXJndW1lbnRzW2ZdO2ZvcihjIGluIGQpYVtjXT1kW2NdO2Zvcih2YXIgZz0wO2c8RWEubGVuZ3RoO2crKyljPUVhW2ddLCBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZCxjKSYmKGFbY109ZFtjXSk7fX1mdW5jdGlvbiBHYShhKXtHYVtcIiBcIl0oYSk7cmV0dXJuIGF9R2FbXCIgXCJdPWFhO2Z1bmN0aW9uIEhhKGEsYil7dmFyIGM9SWE7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChjLGEpP2NbYV06Y1thXT1iKGEpfXZhciBKYT1CKFwiT3BlcmFcIiksQz1CKFwiVHJpZGVudFwiKXx8QihcIk1TSUVcIiksS2E9QihcIkVkZ2VcIiksTGE9S2F8fEMsTWE9QihcIkdlY2tvXCIpJiYhKC0xIT1BLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcIndlYmtpdFwiKSYmIUIoXCJFZGdlXCIpKSYmIShCKFwiVHJpZGVudFwiKXx8QihcIk1TSUVcIikpJiYhQihcIkVkZ2VcIiksTmE9LTEhPUEudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwid2Via2l0XCIpJiYhQihcIkVkZ2VcIik7ZnVuY3Rpb24gT2EoKXt2YXIgYT1oLmRvY3VtZW50O3JldHVybiBhP2EuZG9jdW1lbnRNb2RlOnZvaWQgMH12YXIgUGE7XG5hOnt2YXIgUWE9XCJcIixSYT1mdW5jdGlvbigpe3ZhciBhPUE7aWYoTWEpcmV0dXJuL3J2OihbXlxcKTtdKykoXFwpfDspLy5leGVjKGEpO2lmKEthKXJldHVybi9FZGdlXFwvKFtcXGRcXC5dKykvLmV4ZWMoYSk7aWYoQylyZXR1cm4vXFxiKD86TVNJRXxydilbOiBdKFteXFwpO10rKShcXCl8OykvLmV4ZWMoYSk7aWYoTmEpcmV0dXJuL1dlYktpdFxcLyhcXFMrKS8uZXhlYyhhKTtpZihKYSlyZXR1cm4vKD86VmVyc2lvbilbIFxcL10/KFxcUyspLy5leGVjKGEpfSgpO1JhJiYoUWE9UmE/UmFbMV06XCJcIik7aWYoQyl7dmFyIFNhPU9hKCk7aWYobnVsbCE9U2EmJlNhPnBhcnNlRmxvYXQoUWEpKXtQYT1TdHJpbmcoU2EpO2JyZWFrIGF9fVBhPVFhO312YXIgSWE9e307XG5mdW5jdGlvbiBUYShhKXtyZXR1cm4gSGEoYSxmdW5jdGlvbigpe2Zvcih2YXIgYj0wLGM9d2EoU3RyaW5nKFBhKSkuc3BsaXQoXCIuXCIpLGQ9d2EoU3RyaW5nKGEpKS5zcGxpdChcIi5cIiksZj1NYXRoLm1heChjLmxlbmd0aCxkLmxlbmd0aCksZz0wOzA9PWImJmc8ZjtnKyspe3ZhciBrPWNbZ118fFwiXCIscD1kW2ddfHxcIlwiO2Rve2s9LyhcXGQqKShcXEQqKSguKikvLmV4ZWMoayl8fFtcIlwiLFwiXCIsXCJcIixcIlwiXTtwPS8oXFxkKikoXFxEKikoLiopLy5leGVjKHApfHxbXCJcIixcIlwiLFwiXCIsXCJcIl07aWYoMD09a1swXS5sZW5ndGgmJjA9PXBbMF0ubGVuZ3RoKWJyZWFrO2I9eGEoMD09a1sxXS5sZW5ndGg/MDpwYXJzZUludChrWzFdLDEwKSwwPT1wWzFdLmxlbmd0aD8wOnBhcnNlSW50KHBbMV0sMTApKXx8eGEoMD09a1syXS5sZW5ndGgsMD09cFsyXS5sZW5ndGgpfHx4YShrWzJdLHBbMl0pO2s9a1szXTtwPXBbM107fXdoaWxlKDA9PWIpfXJldHVybiAwPD1ifSl9dmFyIFVhO3ZhciBWYT1oLmRvY3VtZW50O1xuVWE9VmEmJkM/T2EoKXx8KFwiQ1NTMUNvbXBhdFwiPT1WYS5jb21wYXRNb2RlP3BhcnNlSW50KFBhLDEwKTo1KTp2b2lkIDA7dmFyIFdhPU9iamVjdC5mcmVlemV8fGZ1bmN0aW9uKGEpe3JldHVybiBhfTt2YXIgWGE9IUN8fDk8PU51bWJlcihVYSksWWE9QyYmIVRhKFwiOVwiKSxaYT1mdW5jdGlvbigpe2lmKCFoLmFkZEV2ZW50TGlzdGVuZXJ8fCFPYmplY3QuZGVmaW5lUHJvcGVydHkpcmV0dXJuITE7dmFyIGE9ITEsYj1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sXCJwYXNzaXZlXCIse2dldDpmdW5jdGlvbigpe2E9ITA7fX0pO3RyeXtoLmFkZEV2ZW50TGlzdGVuZXIoXCJ0ZXN0XCIsYWEsYiksIGgucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRlc3RcIixhYSxiKTt9Y2F0Y2goYyl7fXJldHVybiBhfSgpO2Z1bmN0aW9uIEQoYSxiKXt0aGlzLnR5cGU9YTt0aGlzLmN1cnJlbnRUYXJnZXQ9dGhpcy50YXJnZXQ9Yjt0aGlzLmRlZmF1bHRQcmV2ZW50ZWQ9dGhpcy5FYT0hMTt0aGlzLkJlPSEwO31ELnByb3RvdHlwZS5zdG9wUHJvcGFnYXRpb249ZnVuY3Rpb24oKXt0aGlzLkVhPSEwO307RC5wcm90b3R5cGUucHJldmVudERlZmF1bHQ9ZnVuY3Rpb24oKXt0aGlzLmRlZmF1bHRQcmV2ZW50ZWQ9ITA7dGhpcy5CZT0hMTt9O2Z1bmN0aW9uIEUoYSxiKXtELmNhbGwodGhpcyxhP2EudHlwZTpcIlwiKTt0aGlzLnJlbGF0ZWRUYXJnZXQ9dGhpcy5jdXJyZW50VGFyZ2V0PXRoaXMudGFyZ2V0PW51bGw7dGhpcy5idXR0b249dGhpcy5zY3JlZW5ZPXRoaXMuc2NyZWVuWD10aGlzLmNsaWVudFk9dGhpcy5jbGllbnRYPXRoaXMub2Zmc2V0WT10aGlzLm9mZnNldFg9MDt0aGlzLmtleT1cIlwiO3RoaXMuY2hhckNvZGU9dGhpcy5rZXlDb2RlPTA7dGhpcy5tZXRhS2V5PXRoaXMuc2hpZnRLZXk9dGhpcy5hbHRLZXk9dGhpcy5jdHJsS2V5PSExO3RoaXMuc3RhdGU9bnVsbDt0aGlzLnBvaW50ZXJJZD0wO3RoaXMucG9pbnRlclR5cGU9XCJcIjt0aGlzLmZiPW51bGw7YSYmdGhpcy5LZihhLGIpO314KEUsRCk7dmFyICRhPVdhKHsyOlwidG91Y2hcIiwzOlwicGVuXCIsNDpcIm1vdXNlXCJ9KTtcbkUucHJvdG90eXBlLktmPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy50eXBlPWEudHlwZSxkPWEuY2hhbmdlZFRvdWNoZXM/YS5jaGFuZ2VkVG91Y2hlc1swXTpudWxsO3RoaXMudGFyZ2V0PWEudGFyZ2V0fHxhLnNyY0VsZW1lbnQ7dGhpcy5jdXJyZW50VGFyZ2V0PWI7aWYoYj1hLnJlbGF0ZWRUYXJnZXQpe2lmKE1hKXthOnt0cnl7R2EoYi5ub2RlTmFtZSk7dmFyIGY9ITA7YnJlYWsgYX1jYXRjaChnKXt9Zj0hMTt9Znx8KGI9bnVsbCk7fX1lbHNlXCJtb3VzZW92ZXJcIj09Yz9iPWEuZnJvbUVsZW1lbnQ6XCJtb3VzZW91dFwiPT1jJiYoYj1hLnRvRWxlbWVudCk7dGhpcy5yZWxhdGVkVGFyZ2V0PWI7bnVsbD09PWQ/KHRoaXMub2Zmc2V0WD1OYXx8dm9pZCAwIT09YS5vZmZzZXRYP2Eub2Zmc2V0WDphLmxheWVyWCwgdGhpcy5vZmZzZXRZPU5hfHx2b2lkIDAhPT1hLm9mZnNldFk/YS5vZmZzZXRZOmEubGF5ZXJZLCB0aGlzLmNsaWVudFg9dm9pZCAwIT09YS5jbGllbnRYP2EuY2xpZW50WDphLnBhZ2VYLCB0aGlzLmNsaWVudFk9dm9pZCAwIT09YS5jbGllbnRZP2EuY2xpZW50WTphLnBhZ2VZLCB0aGlzLnNjcmVlblg9YS5zY3JlZW5YfHwwLCB0aGlzLnNjcmVlblk9YS5zY3JlZW5ZfHwwKToodGhpcy5jbGllbnRYPXZvaWQgMCE9PWQuY2xpZW50WD9kLmNsaWVudFg6ZC5wYWdlWCwgdGhpcy5jbGllbnRZPXZvaWQgMCE9PWQuY2xpZW50WT9kLmNsaWVudFk6ZC5wYWdlWSwgdGhpcy5zY3JlZW5YPWQuc2NyZWVuWHx8MCwgdGhpcy5zY3JlZW5ZPWQuc2NyZWVuWXx8MCk7dGhpcy5idXR0b249YS5idXR0b247dGhpcy5rZXlDb2RlPWEua2V5Q29kZXx8MDt0aGlzLmtleT1hLmtleXx8XCJcIjt0aGlzLmNoYXJDb2RlPWEuY2hhckNvZGV8fChcImtleXByZXNzXCI9PWM/YS5rZXlDb2RlOjApO3RoaXMuY3RybEtleT1hLmN0cmxLZXk7dGhpcy5hbHRLZXk9YS5hbHRLZXk7dGhpcy5zaGlmdEtleT1hLnNoaWZ0S2V5O3RoaXMubWV0YUtleT1hLm1ldGFLZXk7dGhpcy5wb2ludGVySWQ9YS5wb2ludGVySWR8fDA7dGhpcy5wb2ludGVyVHlwZT1cbmwoYS5wb2ludGVyVHlwZSk/YS5wb2ludGVyVHlwZTokYVthLnBvaW50ZXJUeXBlXXx8XCJcIjt0aGlzLnN0YXRlPWEuc3RhdGU7dGhpcy5mYj1hO2EuZGVmYXVsdFByZXZlbnRlZCYmdGhpcy5wcmV2ZW50RGVmYXVsdCgpO307RS5wcm90b3R5cGUuc3RvcFByb3BhZ2F0aW9uPWZ1bmN0aW9uKCl7RS5MLnN0b3BQcm9wYWdhdGlvbi5jYWxsKHRoaXMpO3RoaXMuZmIuc3RvcFByb3BhZ2F0aW9uP3RoaXMuZmIuc3RvcFByb3BhZ2F0aW9uKCk6dGhpcy5mYi5jYW5jZWxCdWJibGU9ITA7fTtFLnByb3RvdHlwZS5wcmV2ZW50RGVmYXVsdD1mdW5jdGlvbigpe0UuTC5wcmV2ZW50RGVmYXVsdC5jYWxsKHRoaXMpO3ZhciBhPXRoaXMuZmI7aWYoYS5wcmV2ZW50RGVmYXVsdClhLnByZXZlbnREZWZhdWx0KCk7ZWxzZSBpZihhLnJldHVyblZhbHVlPSExLCBZYSl0cnl7aWYoYS5jdHJsS2V5fHwxMTI8PWEua2V5Q29kZSYmMTIzPj1hLmtleUNvZGUpYS5rZXlDb2RlPS0xO31jYXRjaChiKXt9fTt2YXIgYWI9XCJjbG9zdXJlX2xpc3RlbmFibGVfXCIrKDFFNipNYXRoLnJhbmRvbSgpfDApO2Z1bmN0aW9uIEYoYSl7cmV0dXJuISghYXx8IWFbYWJdKX12YXIgYmI9MDtmdW5jdGlvbiBjYihhLGIsYyxkLGYpe3RoaXMubGlzdGVuZXI9YTt0aGlzLnByb3h5PW51bGw7dGhpcy5zcmM9Yjt0aGlzLnR5cGU9Yzt0aGlzLmNhcHR1cmU9ISFkO3RoaXMuT2I9Zjt0aGlzLmtleT0rK2JiO3RoaXMuU2E9dGhpcy5FYj0hMTt9Y2IucHJvdG90eXBlLlZiPWZ1bmN0aW9uKCl7dGhpcy5TYT0hMDt0aGlzLk9iPXRoaXMuc3JjPXRoaXMucHJveHk9dGhpcy5saXN0ZW5lcj1udWxsO307ZnVuY3Rpb24gZGIoYSl7dGhpcy5zcmM9YTt0aGlzLko9e307dGhpcy54Yj0wO31lPWRiLnByb3RvdHlwZTtlLmFkZD1mdW5jdGlvbihhLGIsYyxkLGYpe3ZhciBnPWEudG9TdHJpbmcoKTthPXRoaXMuSltnXTthfHwoYT10aGlzLkpbZ109W10sIHRoaXMueGIrKyk7dmFyIGs9ZWIoYSxiLGQsZik7LTE8az8oYj1hW2tdLCBjfHwoYi5FYj0hMSkpOihiPW5ldyBjYihiLHRoaXMuc3JjLGcsISFkLGYpLCBiLkViPWMsIGEucHVzaChiKSk7cmV0dXJuIGJ9O2UucmVtb3ZlPWZ1bmN0aW9uKGEsYixjLGQpe2E9YS50b1N0cmluZygpO2lmKCEoYSBpbiB0aGlzLkopKXJldHVybiExO3ZhciBmPXRoaXMuSlthXTtiPWViKGYsYixjLGQpO3JldHVybi0xPGI/KGZbYl0uVmIoKSwgQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGYsYiwxKSwgMD09Zi5sZW5ndGgmJihkZWxldGUgdGhpcy5KW2FdLCB0aGlzLnhiLS0pLCAhMCk6ITF9O1xuZS55ZT1mdW5jdGlvbihhKXt2YXIgYj1hLnR5cGU7YiBpbiB0aGlzLkomJnNhKHRoaXMuSltiXSxhKSYmKGEuVmIoKSwgMD09dGhpcy5KW2JdLmxlbmd0aCYmKGRlbGV0ZSB0aGlzLkpbYl0sIHRoaXMueGItLSkpO307ZS5wYj1mdW5jdGlvbihhKXthPWEmJmEudG9TdHJpbmcoKTt2YXIgYztmb3IoYyBpbiB0aGlzLkopaWYoIWF8fGM9PWEpe2Zvcih2YXIgZD10aGlzLkpbY10sZj0wO2Y8ZC5sZW5ndGg7ZisrKWRbZl0uVmIoKTtkZWxldGUgdGhpcy5KW2NdO3RoaXMueGItLTt9fTtlLmpiPWZ1bmN0aW9uKGEsYixjLGQpe2E9dGhpcy5KW2EudG9TdHJpbmcoKV07dmFyIGY9LTE7YSYmKGY9ZWIoYSxiLGMsZCkpO3JldHVybi0xPGY/YVtmXTpudWxsfTtmdW5jdGlvbiBlYihhLGIsYyxkKXtmb3IodmFyIGY9MDtmPGEubGVuZ3RoOysrZil7dmFyIGc9YVtmXTtpZighZy5TYSYmZy5saXN0ZW5lcj09YiYmZy5jYXB0dXJlPT0hIWMmJmcuT2I9PWQpcmV0dXJuIGZ9cmV0dXJuLTF9dmFyIGZiPVwiY2xvc3VyZV9sbV9cIisoMUU2Kk1hdGgucmFuZG9tKCl8MCksZ2I9e307ZnVuY3Rpb24gaWIoYSxiLGMsZCxmKXtpZihkJiZkLm9uY2UpcmV0dXJuIGpiKGEsYixjLGQsZik7aWYobihiKSl7Zm9yKHZhciBnPTA7ZzxiLmxlbmd0aDtnKyspaWIoYSxiW2ddLGMsZCxmKTtyZXR1cm4gbnVsbH1jPWtiKGMpO3JldHVybiBGKGEpP2EubmIoYixjLHIoZCk/ISFkLmNhcHR1cmU6ISFkLGYpOmxiKGEsYixjLCExLGQsZil9XG5mdW5jdGlvbiBsYihhLGIsYyxkLGYsZyl7aWYoIWIpdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGV2ZW50IHR5cGVcIik7dmFyIGs9cihmKT8hIWYuY2FwdHVyZTohIWYscD1HKGEpO3B8fChhW2ZiXT1wPW5ldyBkYihhKSk7Yz1wLmFkZChiLGMsZCxrLGcpO2lmKGMucHJveHkpcmV0dXJuIGM7ZD1tYigpO2MucHJveHk9ZDtkLnNyYz1hO2QubGlzdGVuZXI9YztpZihhLmFkZEV2ZW50TGlzdGVuZXIpWmF8fChmPWspLCB2b2lkIDA9PT1mJiYoZj0hMSksIGEuYWRkRXZlbnRMaXN0ZW5lcihiLnRvU3RyaW5nKCksZCxmKTtlbHNlIGlmKGEuYXR0YWNoRXZlbnQpYS5hdHRhY2hFdmVudChuYihiLnRvU3RyaW5nKCkpLGQpO2Vsc2UgaWYoYS5hZGRMaXN0ZW5lciYmYS5yZW1vdmVMaXN0ZW5lcilhLmFkZExpc3RlbmVyKGQpO2Vsc2UgdGhyb3cgRXJyb3IoXCJhZGRFdmVudExpc3RlbmVyIGFuZCBhdHRhY2hFdmVudCBhcmUgdW5hdmFpbGFibGUuXCIpO3JldHVybiBjfVxuZnVuY3Rpb24gbWIoKXt2YXIgYT1vYixiPVhhP2Z1bmN0aW9uKGMpe3JldHVybiBhLmNhbGwoYi5zcmMsYi5saXN0ZW5lcixjKX06ZnVuY3Rpb24oYyl7Yz1hLmNhbGwoYi5zcmMsYi5saXN0ZW5lcixjKTtpZighYylyZXR1cm4gY307cmV0dXJuIGJ9ZnVuY3Rpb24gamIoYSxiLGMsZCxmKXtpZihuKGIpKXtmb3IodmFyIGc9MDtnPGIubGVuZ3RoO2crKylqYihhLGJbZ10sYyxkLGYpO3JldHVybiBudWxsfWM9a2IoYyk7cmV0dXJuIEYoYSk/YS5PYyhiLGMscihkKT8hIWQuY2FwdHVyZTohIWQsZik6bGIoYSxiLGMsITAsZCxmKX1mdW5jdGlvbiBwYihhLGIsYyxkLGYpe2lmKG4oYikpZm9yKHZhciBnPTA7ZzxiLmxlbmd0aDtnKyspcGIoYSxiW2ddLGMsZCxmKTtlbHNlIGQ9cihkKT8hIWQuY2FwdHVyZTohIWQsIGM9a2IoYyksIEYoYSk/YS5lZChiLGMsZCxmKTphJiYoYT1HKGEpKSYmKGI9YS5qYihiLGMsZCxmKSkmJnFiKGIpO31cbmZ1bmN0aW9uIHFiKGEpe2lmKFwibnVtYmVyXCIhPXR5cGVvZiBhJiZhJiYhYS5TYSl7dmFyIGI9YS5zcmM7aWYoRihiKSliLkxlKGEpO2Vsc2V7dmFyIGM9YS50eXBlLGQ9YS5wcm94eTtiLnJlbW92ZUV2ZW50TGlzdGVuZXI/Yi5yZW1vdmVFdmVudExpc3RlbmVyKGMsZCxhLmNhcHR1cmUpOmIuZGV0YWNoRXZlbnQ/Yi5kZXRhY2hFdmVudChuYihjKSxkKTpiLmFkZExpc3RlbmVyJiZiLnJlbW92ZUxpc3RlbmVyJiZiLnJlbW92ZUxpc3RlbmVyKGQpOyhjPUcoYikpPyhjLnllKGEpLCAwPT1jLnhiJiYoYy5zcmM9bnVsbCwgYltmYl09bnVsbCkpOmEuVmIoKTt9fX1mdW5jdGlvbiBuYihhKXtyZXR1cm4gYSBpbiBnYj9nYlthXTpnYlthXT1cIm9uXCIrYX1cbmZ1bmN0aW9uIHJiKGEsYixjLGQpe3ZhciBmPSEwO2lmKGE9RyhhKSlpZihiPWEuSltiLnRvU3RyaW5nKCldKWZvcihiPWIuY29uY2F0KCksIGE9MDthPGIubGVuZ3RoO2ErKyl7dmFyIGc9YlthXTtnJiZnLmNhcHR1cmU9PWMmJiFnLlNhJiYoZz1zYihnLGQpLCBmPWYmJiExIT09Zyk7fXJldHVybiBmfWZ1bmN0aW9uIHNiKGEsYil7dmFyIGM9YS5saXN0ZW5lcixkPWEuT2J8fGEuc3JjO2EuRWImJnFiKGEpO3JldHVybiBjLmNhbGwoZCxiKX1cbmZ1bmN0aW9uIG9iKGEsYil7aWYoYS5TYSlyZXR1cm4hMDtpZighWGEpe3ZhciBjPWJ8fG0oXCJ3aW5kb3cuZXZlbnRcIik7Yj1uZXcgRShjLHRoaXMpO3ZhciBkPSEwO2lmKCEoMD5jLmtleUNvZGV8fHZvaWQgMCE9Yy5yZXR1cm5WYWx1ZSkpe2E6e3ZhciBmPSExO2lmKDA9PWMua2V5Q29kZSl0cnl7Yy5rZXlDb2RlPS0xO2JyZWFrIGF9Y2F0Y2goayl7Zj0hMDt9aWYoZnx8dm9pZCAwPT1jLnJldHVyblZhbHVlKWMucmV0dXJuVmFsdWU9ITA7fWM9W107Zm9yKGY9Yi5jdXJyZW50VGFyZ2V0O2Y7Zj1mLnBhcmVudE5vZGUpYy5wdXNoKGYpO2E9YS50eXBlO2ZvcihmPWMubGVuZ3RoLTE7IWIuRWEmJjA8PWY7Zi0tKXtiLmN1cnJlbnRUYXJnZXQ9Y1tmXTt2YXIgZz1yYihjW2ZdLGEsITAsYik7ZD1kJiZnO31mb3IoZj0wOyFiLkVhJiZmPGMubGVuZ3RoO2YrKyliLmN1cnJlbnRUYXJnZXQ9Y1tmXSwgZz1yYihjW2ZdLGEsITEsYiksIGQ9ZCYmZzt9cmV0dXJuIGR9cmV0dXJuIHNiKGEsbmV3IEUoYix0aGlzKSl9XG5mdW5jdGlvbiBHKGEpe2E9YVtmYl07cmV0dXJuIGEgaW5zdGFuY2VvZiBkYj9hOm51bGx9dmFyIHRiPVwiX19jbG9zdXJlX2V2ZW50c19mbl9cIisoMUU5Kk1hdGgucmFuZG9tKCk+Pj4wKTtmdW5jdGlvbiBrYihhKXtpZihxKGEpKXJldHVybiBhO2FbdGJdfHwoYVt0Yl09ZnVuY3Rpb24oYil7cmV0dXJuIGEuaGFuZGxlRXZlbnQoYil9KTtyZXR1cm4gYVt0Yl19ZnVuY3Rpb24gSCgpe3ouY2FsbCh0aGlzKTt0aGlzLmthPW5ldyBkYih0aGlzKTt0aGlzLlBlPXRoaXM7dGhpcy5VYz1udWxsO314KEgseik7SC5wcm90b3R5cGVbYWJdPSEwO2U9SC5wcm90b3R5cGU7ZS5hZGRFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGEsYixjLGQpe2liKHRoaXMsYSxiLGMsZCk7fTtlLnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oYSxiLGMsZCl7cGIodGhpcyxhLGIsYyxkKTt9O1xuZS5kaXNwYXRjaEV2ZW50PWZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcy5VYztpZihjKWZvcihiPVtdO2M7Yz1jLlVjKWIucHVzaChjKTtjPXRoaXMuUGU7dmFyIGQ9YS50eXBlfHxhO2lmKGwoYSkpYT1uZXcgRChhLGMpO2Vsc2UgaWYoYSBpbnN0YW5jZW9mIEQpYS50YXJnZXQ9YS50YXJnZXR8fGM7ZWxzZXt2YXIgZj1hO2E9bmV3IEQoZCxjKTtGYShhLGYpO31mPSEwO2lmKGIpZm9yKHZhciBnPWIubGVuZ3RoLTE7IWEuRWEmJjA8PWc7Zy0tKXt2YXIgaz1hLmN1cnJlbnRUYXJnZXQ9YltnXTtmPWsuTGIoZCwhMCxhKSYmZjt9YS5FYXx8KGs9YS5jdXJyZW50VGFyZ2V0PWMsIGY9ay5MYihkLCEwLGEpJiZmLCBhLkVhfHwoZj1rLkxiKGQsITEsYSkmJmYpKTtpZihiKWZvcihnPTA7IWEuRWEmJmc8Yi5sZW5ndGg7ZysrKWs9YS5jdXJyZW50VGFyZ2V0PWJbZ10sIGY9ay5MYihkLCExLGEpJiZmO3JldHVybiBmfTtcbmUuRj1mdW5jdGlvbigpe0guTC5GLmNhbGwodGhpcyk7dGhpcy5wZygpO3RoaXMuVWM9bnVsbDt9O2UubmI9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMua2EuYWRkKFN0cmluZyhhKSxiLCExLGMsZCl9O2UuT2M9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMua2EuYWRkKFN0cmluZyhhKSxiLCEwLGMsZCl9O2UuZWQ9ZnVuY3Rpb24oYSxiLGMsZCl7dGhpcy5rYS5yZW1vdmUoU3RyaW5nKGEpLGIsYyxkKTt9O2UuTGU9ZnVuY3Rpb24oYSl7dGhpcy5rYS55ZShhKTt9O2UucGc9ZnVuY3Rpb24oKXt0aGlzLmthJiZ0aGlzLmthLnBiKHZvaWQgMCk7fTtcbmUuTGI9ZnVuY3Rpb24oYSxiLGMpe2E9dGhpcy5rYS5KW1N0cmluZyhhKV07aWYoIWEpcmV0dXJuITA7YT1hLmNvbmNhdCgpO2Zvcih2YXIgZD0hMCxmPTA7ZjxhLmxlbmd0aDsrK2Ype3ZhciBnPWFbZl07aWYoZyYmIWcuU2EmJmcuY2FwdHVyZT09Yil7dmFyIGs9Zy5saXN0ZW5lcixwPWcuT2J8fGcuc3JjO2cuRWImJnRoaXMuTGUoZyk7ZD0hMSE9PWsuY2FsbChwLGMpJiZkO319cmV0dXJuIGQmJjAhPWMuQmV9O2UuamI9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMua2EuamIoU3RyaW5nKGEpLGIsYyxkKX07dmFyIHViPWguSlNPTi5zdHJpbmdpZnk7ZnVuY3Rpb24gdmIoYSxiKXt0aGlzLlNmPTEwMDt0aGlzLmVmPWE7dGhpcy51Zz1iO3RoaXMuWmI9MDt0aGlzLlBiPW51bGw7fXZiLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oKXtpZigwPHRoaXMuWmIpe3RoaXMuWmItLTt2YXIgYT10aGlzLlBiO3RoaXMuUGI9YS5uZXh0O2EubmV4dD1udWxsO31lbHNlIGE9dGhpcy5lZigpO3JldHVybiBhfTt2Yi5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKGEpe3RoaXMudWcoYSk7dGhpcy5aYjx0aGlzLlNmJiYodGhpcy5aYisrLCBhLm5leHQ9dGhpcy5QYiwgdGhpcy5QYj1hKTt9O2Z1bmN0aW9uIEkoKXt0aGlzLmxjPXRoaXMuVmE9bnVsbDt9dmFyIHhiPW5ldyB2YihmdW5jdGlvbigpe3JldHVybiBuZXcgd2J9LGZ1bmN0aW9uKGEpe2EucmVzZXQoKTt9KTtJLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLkFmKCk7Yy5zZXQoYSxiKTt0aGlzLmxjP3RoaXMubGMubmV4dD1jOnRoaXMuVmE9Yzt0aGlzLmxjPWM7fTtJLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3RoaXMuVmEmJihhPXRoaXMuVmEsIHRoaXMuVmE9dGhpcy5WYS5uZXh0LCB0aGlzLlZhfHwodGhpcy5sYz1udWxsKSwgYS5uZXh0PW51bGwpO3JldHVybiBhfTtJLnByb3RvdHlwZS53Zz1mdW5jdGlvbihhKXt4Yi5wdXQoYSk7fTtJLnByb3RvdHlwZS5BZj1mdW5jdGlvbigpe3JldHVybiB4Yi5nZXQoKX07ZnVuY3Rpb24gd2IoKXt0aGlzLm5leHQ9dGhpcy5zY29wZT10aGlzLkdjPW51bGw7fVxud2IucHJvdG90eXBlLnNldD1mdW5jdGlvbihhLGIpe3RoaXMuR2M9YTt0aGlzLnNjb3BlPWI7dGhpcy5uZXh0PW51bGw7fTt3Yi5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLm5leHQ9dGhpcy5zY29wZT10aGlzLkdjPW51bGw7fTtmdW5jdGlvbiB5YihhKXtoLnNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aHJvdyBhO30sMCk7fXZhciB6YjtcbmZ1bmN0aW9uIEFiKCl7dmFyIGE9aC5NZXNzYWdlQ2hhbm5lbDtcInVuZGVmaW5lZFwiPT09dHlwZW9mIGEmJlwidW5kZWZpbmVkXCIhPT10eXBlb2Ygd2luZG93JiZ3aW5kb3cucG9zdE1lc3NhZ2UmJndpbmRvdy5hZGRFdmVudExpc3RlbmVyJiYhQihcIlByZXN0b1wiKSYmKGE9ZnVuY3Rpb24oKXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiSUZSQU1FXCIpO2Euc3R5bGUuZGlzcGxheT1cIm5vbmVcIjthLnNyYz1cIlwiO2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChhKTt2YXIgYj1hLmNvbnRlbnRXaW5kb3c7YT1iLmRvY3VtZW50O2Eub3BlbigpO2Eud3JpdGUoXCJcIik7YS5jbG9zZSgpO3ZhciBjPVwiY2FsbEltbWVkaWF0ZVwiK01hdGgucmFuZG9tKCksZD1cImZpbGU6XCI9PWIubG9jYXRpb24ucHJvdG9jb2w/XCIqXCI6Yi5sb2NhdGlvbi5wcm90b2NvbCtcIi8vXCIrYi5sb2NhdGlvbi5ob3N0O2E9dShmdW5jdGlvbihhKXtpZigoXCIqXCI9PWR8fGEub3JpZ2luPT1kKSYmYS5kYXRhPT1cbmMpdGhpcy5wb3J0MS5vbm1lc3NhZ2UoKTt9LHRoaXMpO2IuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIixhLCExKTt0aGlzLnBvcnQxPXt9O3RoaXMucG9ydDI9e3Bvc3RNZXNzYWdlOmZ1bmN0aW9uKCl7Yi5wb3N0TWVzc2FnZShjLGQpO319O30pO2lmKFwidW5kZWZpbmVkXCIhPT10eXBlb2YgYSYmIUIoXCJUcmlkZW50XCIpJiYhQihcIk1TSUVcIikpe3ZhciBiPW5ldyBhLGM9e30sZD1jO2IucG9ydDEub25tZXNzYWdlPWZ1bmN0aW9uKCl7aWYodm9pZCAwIT09Yy5uZXh0KXtjPWMubmV4dDt2YXIgYT1jLnJkO2MucmQ9bnVsbDthKCk7fX07cmV0dXJuIGZ1bmN0aW9uKGEpe2QubmV4dD17cmQ6YX07ZD1kLm5leHQ7Yi5wb3J0Mi5wb3N0TWVzc2FnZSgwKTt9fXJldHVyblwidW5kZWZpbmVkXCIhPT10eXBlb2YgZG9jdW1lbnQmJlwib25yZWFkeXN0YXRlY2hhbmdlXCJpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiU0NSSVBUXCIpP2Z1bmN0aW9uKGEpe3ZhciBiPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJTQ1JJUFRcIik7XG5iLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2Iub25yZWFkeXN0YXRlY2hhbmdlPW51bGw7Yi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpO2I9bnVsbDthKCk7YT1udWxsO307ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGIpO306ZnVuY3Rpb24oYSl7aC5zZXRUaW1lb3V0KGEsMCk7fX12YXIgQmI7ZnVuY3Rpb24gQ2IoKXtpZihoLlByb21pc2UmJmguUHJvbWlzZS5yZXNvbHZlKXt2YXIgYT1oLlByb21pc2UucmVzb2x2ZSh2b2lkIDApO0JiPWZ1bmN0aW9uKCl7YS50aGVuKERiKTt9O31lbHNlIEJiPWZ1bmN0aW9uKCl7dmFyIGE9RGI7IXEoaC5zZXRJbW1lZGlhdGUpfHxoLldpbmRvdyYmaC5XaW5kb3cucHJvdG90eXBlJiYhQihcIkVkZ2VcIikmJmguV2luZG93LnByb3RvdHlwZS5zZXRJbW1lZGlhdGU9PWguc2V0SW1tZWRpYXRlPyh6Ynx8KHpiPUFiKCkpLCB6YihhKSk6aC5zZXRJbW1lZGlhdGUoYSk7fTt9dmFyIEViPSExLEZiPW5ldyBJO2Z1bmN0aW9uIERiKCl7Zm9yKHZhciBhO2E9RmIucmVtb3ZlKCk7KXt0cnl7YS5HYy5jYWxsKGEuc2NvcGUpO31jYXRjaChiKXt5YihiKTt9RmIud2coYSk7fUViPSExO31mdW5jdGlvbiBHYihhLGIpe0guY2FsbCh0aGlzKTt0aGlzLk5hPWF8fDE7dGhpcy53Yj1ifHxoO3RoaXMubmQ9dSh0aGlzLlJnLHRoaXMpO3RoaXMuaWU9dygpO314KEdiLEgpO2U9R2IucHJvdG90eXBlO2UuZW5hYmxlZD0hMTtlLkI9bnVsbDtlLnNldEludGVydmFsPWZ1bmN0aW9uKGEpe3RoaXMuTmE9YTt0aGlzLkImJnRoaXMuZW5hYmxlZD8odGhpcy5zdG9wKCksIHRoaXMuc3RhcnQoKSk6dGhpcy5CJiZ0aGlzLnN0b3AoKTt9O2UuUmc9ZnVuY3Rpb24oKXtpZih0aGlzLmVuYWJsZWQpe3ZhciBhPXcoKS10aGlzLmllOzA8YSYmYTwuOCp0aGlzLk5hP3RoaXMuQj10aGlzLndiLnNldFRpbWVvdXQodGhpcy5uZCx0aGlzLk5hLWEpOih0aGlzLkImJih0aGlzLndiLmNsZWFyVGltZW91dCh0aGlzLkIpLCB0aGlzLkI9bnVsbCksIHRoaXMuZmYoKSwgdGhpcy5lbmFibGVkJiYodGhpcy5zdG9wKCksIHRoaXMuc3RhcnQoKSkpO319O2UuZmY9ZnVuY3Rpb24oKXt0aGlzLmRpc3BhdGNoRXZlbnQoXCJ0aWNrXCIpO307XG5lLnN0YXJ0PWZ1bmN0aW9uKCl7dGhpcy5lbmFibGVkPSEwO3RoaXMuQnx8KHRoaXMuQj10aGlzLndiLnNldFRpbWVvdXQodGhpcy5uZCx0aGlzLk5hKSwgdGhpcy5pZT13KCkpO307ZS5zdG9wPWZ1bmN0aW9uKCl7dGhpcy5lbmFibGVkPSExO3RoaXMuQiYmKHRoaXMud2IuY2xlYXJUaW1lb3V0KHRoaXMuQiksIHRoaXMuQj1udWxsKTt9O2UuRj1mdW5jdGlvbigpe0diLkwuRi5jYWxsKHRoaXMpO3RoaXMuc3RvcCgpO2RlbGV0ZSB0aGlzLndiO307ZnVuY3Rpb24gSGIoYSxiLGMpe2lmKHEoYSkpYyYmKGE9dShhLGMpKTtlbHNlIGlmKGEmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuaGFuZGxlRXZlbnQpYT11KGEuaGFuZGxlRXZlbnQsYSk7ZWxzZSB0aHJvdyBFcnJvcihcIkludmFsaWQgbGlzdGVuZXIgYXJndW1lbnRcIik7cmV0dXJuIDIxNDc0ODM2NDc8TnVtYmVyKGIpPy0xOmguc2V0VGltZW91dChhLGJ8fDApfWZ1bmN0aW9uIEliKGEsYixjKXt6LmNhbGwodGhpcyk7dGhpcy5VZj1udWxsIT1jP3UoYSxjKTphO3RoaXMuTmE9Yjt0aGlzLlhlPXUodGhpcy5mZyx0aGlzKTt0aGlzLnFjPVtdO314KEliLHopO2U9SWIucHJvdG90eXBlO2UuVGE9ITE7ZS5vYj0wO2UuQj1udWxsO2UubWY9ZnVuY3Rpb24oYSl7dGhpcy5xYz1hcmd1bWVudHM7dGhpcy5CfHx0aGlzLm9iP3RoaXMuVGE9ITA6dGhpcy5DYygpO307ZS5zdG9wPWZ1bmN0aW9uKCl7dGhpcy5CJiYoaC5jbGVhclRpbWVvdXQodGhpcy5CKSwgdGhpcy5CPW51bGwsIHRoaXMuVGE9ITEsIHRoaXMucWM9W10pO307ZS5wYXVzZT1mdW5jdGlvbigpe3RoaXMub2IrKzt9O2UucmVzdW1lPWZ1bmN0aW9uKCl7dGhpcy5vYi0tO3RoaXMub2J8fCF0aGlzLlRhfHx0aGlzLkJ8fCh0aGlzLlRhPSExLCB0aGlzLkNjKCkpO307ZS5GPWZ1bmN0aW9uKCl7SWIuTC5GLmNhbGwodGhpcyk7dGhpcy5zdG9wKCk7fTtcbmUuZmc9ZnVuY3Rpb24oKXt0aGlzLkI9bnVsbDt0aGlzLlRhJiYhdGhpcy5vYiYmKHRoaXMuVGE9ITEsIHRoaXMuQ2MoKSk7fTtlLkNjPWZ1bmN0aW9uKCl7dGhpcy5CPUhiKHRoaXMuWGUsdGhpcy5OYSk7dGhpcy5VZi5hcHBseShudWxsLHRoaXMucWMpO307ZnVuY3Rpb24gSmIoYSl7ei5jYWxsKHRoaXMpO3RoaXMuaT1hO3RoaXMubz17fTt9eChKYix6KTt2YXIgS2I9W107ZT1KYi5wcm90b3R5cGU7ZS5uYj1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5UZihhLGIsYyxkKX07ZS5UZj1mdW5jdGlvbihhLGIsYyxkKXtuKGIpfHwoYiYmKEtiWzBdPWIudG9TdHJpbmcoKSksIGI9S2IpO2Zvcih2YXIgZj0wO2Y8Yi5sZW5ndGg7ZisrKXt2YXIgZz1pYihhLGJbZl0sY3x8dGhpcy5oYW5kbGVFdmVudCxkfHwhMSx0aGlzLml8fHRoaXMpO2lmKCFnKWJyZWFrO3RoaXMub1tnLmtleV09Zzt9cmV0dXJuIHRoaXN9O2UuT2M9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuamUoYSxiLGMsZCl9O1xuZS5qZT1mdW5jdGlvbihhLGIsYyxkLGYpe2lmKG4oYikpZm9yKHZhciBnPTA7ZzxiLmxlbmd0aDtnKyspdGhpcy5qZShhLGJbZ10sYyxkLGYpO2Vsc2V7YT1qYihhLGIsY3x8dGhpcy5oYW5kbGVFdmVudCxkLGZ8fHRoaXMuaXx8dGhpcyk7aWYoIWEpcmV0dXJuIHRoaXM7dGhpcy5vW2Eua2V5XT1hO31yZXR1cm4gdGhpc307ZS5lZD1mdW5jdGlvbihhLGIsYyxkLGYpe2lmKG4oYikpZm9yKHZhciBnPTA7ZzxiLmxlbmd0aDtnKyspdGhpcy5lZChhLGJbZ10sYyxkLGYpO2Vsc2UgYz1jfHx0aGlzLmhhbmRsZUV2ZW50LCBkPXIoZCk/ISFkLmNhcHR1cmU6ISFkLCBmPWZ8fHRoaXMuaXx8dGhpcywgYz1rYihjKSwgZD0hIWQsIGI9RihhKT9hLmpiKGIsYyxkLGYpOmE/KGE9RyhhKSk/YS5qYihiLGMsZCxmKTpudWxsOm51bGwsIGImJihxYihiKSwgZGVsZXRlIHRoaXMub1tiLmtleV0pO307XG5lLnBiPWZ1bmN0aW9uKCl7QWEodGhpcy5vLGZ1bmN0aW9uKGEsYil7dGhpcy5vLmhhc093blByb3BlcnR5KGIpJiZxYihhKTt9LHRoaXMpO3RoaXMubz17fTt9O2UuRj1mdW5jdGlvbigpe0piLkwuRi5jYWxsKHRoaXMpO3RoaXMucGIoKTt9O2UuaGFuZGxlRXZlbnQ9ZnVuY3Rpb24oKXt0aHJvdyBFcnJvcihcIkV2ZW50SGFuZGxlci5oYW5kbGVFdmVudCBub3QgaW1wbGVtZW50ZWRcIik7fTtmdW5jdGlvbiBKKGEsYixjKXt0aGlzLnJlc2V0KGEsYixjLHZvaWQgMCx2b2lkIDApO31KLnByb3RvdHlwZS5NZD1udWxsO0oucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKGEsYixjLGQsZil7dGhpcy5tYj1hO2RlbGV0ZSB0aGlzLk1kO307Si5wcm90b3R5cGUuQmc9ZnVuY3Rpb24oYSl7dGhpcy5NZD1hO307Si5wcm90b3R5cGUuR2U9ZnVuY3Rpb24oYSl7dGhpcy5tYj1hO307ZnVuY3Rpb24gTWIoYSl7dGhpcy5wZT1hO3RoaXMuWmQ9dGhpcy51Yz10aGlzLm1iPXRoaXMuJGI9bnVsbDt9ZnVuY3Rpb24gSyhhLGIpe3RoaXMubmFtZT1hO3RoaXMudmFsdWU9Yjt9Sy5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uYW1lfTt2YXIgTmI9bmV3IEsoXCJTRVZFUkVcIiwxRTMpLE9iPW5ldyBLKFwiV0FSTklOR1wiLDkwMCksUGI9bmV3IEsoXCJJTkZPXCIsODAwKSxRYj1uZXcgSyhcIkNPTkZJR1wiLDcwMCksUmI9bmV3IEsoXCJGSU5FXCIsNTAwKTtlPU1iLnByb3RvdHlwZTtlLmdldE5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wZX07ZS5nZXRQYXJlbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kYn07ZS5wZj1mdW5jdGlvbigpe3RoaXMudWN8fCh0aGlzLnVjPXt9KTtyZXR1cm4gdGhpcy51Y307ZS5HZT1mdW5jdGlvbihhKXt0aGlzLm1iPWE7fTtcbmUuUWQ9ZnVuY3Rpb24oKXtpZih0aGlzLm1iKXJldHVybiB0aGlzLm1iO2lmKHRoaXMuJGIpcmV0dXJuIHRoaXMuJGIuUWQoKTtpYShcIlJvb3QgbG9nZ2VyIGhhcyBubyBsZXZlbCBzZXQuXCIpO3JldHVybiBudWxsfTtlLlBmPWZ1bmN0aW9uKGEpe3JldHVybiBhLnZhbHVlPj10aGlzLlFkKCkudmFsdWV9O2UubG9nPWZ1bmN0aW9uKGEsYixjKXt0aGlzLlBmKGEpJiYocShiKSYmKGI9YigpKSwgdGhpcy5nZih0aGlzLnVmKGEsYixjKSkpO307ZS51Zj1mdW5jdGlvbihhLGIsYyl7YT1uZXcgSihhLFN0cmluZyhiKSx0aGlzLnBlKTtjJiZhLkJnKGMpO3JldHVybiBhfTtlLmNhPWZ1bmN0aW9uKGEsYil7dGhpcy5sb2coTmIsYSxiKTt9O2UuVD1mdW5jdGlvbihhLGIpe3RoaXMubG9nKE9iLGEsYik7fTtlLmluZm89ZnVuY3Rpb24oYSxiKXt0aGlzLmxvZyhQYixhLGIpO307ZS5sZj1mdW5jdGlvbihhKXt0aGlzLmxvZyhSYixhLHZvaWQgMCk7fTtcbmUuZ2Y9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXM7YjspYi5XZShhKSwgYj1iLmdldFBhcmVudCgpO307ZS5XZT1mdW5jdGlvbihhKXtpZih0aGlzLlpkKWZvcih2YXIgYj0wLGM7Yz10aGlzLlpkW2JdO2IrKyljKGEpO307ZS5GZz1mdW5jdGlvbihhKXt0aGlzLiRiPWE7fTtlLlFlPWZ1bmN0aW9uKGEsYil7dGhpcy5wZigpW2FdPWI7fTt2YXIgU2I9e30sVGI9bnVsbDtmdW5jdGlvbiBWYihhKXtUYnx8KFRiPW5ldyBNYihcIlwiKSwgU2JbXCJcIl09VGIsIFRiLkdlKFFiKSk7dmFyIGI7aWYoIShiPVNiW2FdKSl7Yj1uZXcgTWIoYSk7dmFyIGM9YS5sYXN0SW5kZXhPZihcIi5cIiksZD1hLnN1YnN0cihjKzEpO2M9VmIoYS5zdWJzdHIoMCxjKSk7Yy5RZShkLGIpO2IuRmcoYyk7U2JbYV09Yjt9cmV0dXJuIGJ9ZnVuY3Rpb24gV2IoYSxiKXthJiZhLmluZm8oYix2b2lkIDApO31mdW5jdGlvbiBMKGEsYil7YSYmYS5sZihiKTt9ZnVuY3Rpb24gWGIoKXt0aGlzLnM9VmIoXCJnb29nLmxhYnMubmV0LndlYkNoYW5uZWwuV2ViQ2hhbm5lbERlYnVnXCIpO3RoaXMuV2M9ITA7fWU9WGIucHJvdG90eXBlO2UuSWQ9ZnVuY3Rpb24oKXt0aGlzLldjPSExO307ZS5UZz1mdW5jdGlvbihhLGIsYyxkLGYpe3ZhciBnPXRoaXM7dGhpcy5pbmZvKGZ1bmN0aW9uKCl7cmV0dXJuXCJYTUxIVFRQIFJFUSAoXCIrYytcIikgW2F0dGVtcHQgXCIrZCtcIl06IFwiK2ErXCJcXG5cIitiK1wiXFxuXCIrZy5YZihmKX0pO307ZS5VZz1mdW5jdGlvbihhLGIsYyxkLGYsZyl7dGhpcy5pbmZvKGZ1bmN0aW9uKCl7cmV0dXJuXCJYTUxIVFRQIFJFU1AgKFwiK2MrXCIpIFsgYXR0ZW1wdCBcIitkK1wiXTogXCIrYStcIlxcblwiK2IrXCJcXG5cIitmK1wiIFwiK2d9KTt9O2UuV2E9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXM7dGhpcy5pbmZvKGZ1bmN0aW9uKCl7cmV0dXJuXCJYTUxIVFRQIFRFWFQgKFwiK2ErXCIpOiBcIitkLm5nKGIpKyhjP1wiIFwiK2M6XCJcIil9KTt9O1xuZS5TZz1mdW5jdGlvbihhKXt0aGlzLmluZm8oZnVuY3Rpb24oKXtyZXR1cm5cIlRJTUVPVVQ6IFwiK2F9KTt9O2UuZGVidWc9ZnVuY3Rpb24oYSl7TCh0aGlzLnMsYSk7fTtlLmNiPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5zO2MmJmMuY2EoYnx8XCJFeGNlcHRpb25cIixhKTt9O2UuaW5mbz1mdW5jdGlvbihhKXtXYih0aGlzLnMsYSk7fTtlLlQ9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zO2ImJmIuVChhLHZvaWQgMCk7fTtlLmNhPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucztiJiZiLmNhKGEsdm9pZCAwKTt9O1xuZS5uZz1mdW5jdGlvbihhKXtpZighdGhpcy5XYylyZXR1cm4gYTtpZighYSlyZXR1cm4gbnVsbDt0cnl7dmFyIGI9SlNPTi5wYXJzZShhKTtpZihiKWZvcih2YXIgYz0wO2M8Yi5sZW5ndGg7YysrKW4oYltjXSkmJnRoaXMuV2YoYltjXSk7cmV0dXJuIHViKGIpfWNhdGNoKGQpe3JldHVybiB0aGlzLmRlYnVnKFwiRXhjZXB0aW9uIHBhcnNpbmcgZXhwZWN0ZWQgSlMgYXJyYXkgLSBwcm9iYWJseSB3YXMgbm90IEpTXCIpLCBhfX07ZS5XZj1mdW5jdGlvbihhKXtpZighKDI+YS5sZW5ndGh8fChhPWFbMV0sICFuKGEpfHwxPmEubGVuZ3RoKSkpe3ZhciBiPWFbMF07aWYoXCJub29wXCIhPWImJlwic3RvcFwiIT1iJiZcImNsb3NlXCIhPWIpZm9yKGI9MTtiPGEubGVuZ3RoO2IrKylhW2JdPVwiXCI7fX07XG5lLlhmPWZ1bmN0aW9uKGEpe2lmKCF0aGlzLldjKXJldHVybiBhO2lmKCFhKXJldHVybiBudWxsO3ZhciBiPVwiXCI7YT1hLnNwbGl0KFwiJlwiKTtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKyl7dmFyIGQ9YVtjXS5zcGxpdChcIj1cIik7aWYoMTxkLmxlbmd0aCl7dmFyIGY9ZFswXTtkPWRbMV07dmFyIGc9Zi5zcGxpdChcIl9cIik7Yj0yPD1nLmxlbmd0aCYmXCJ0eXBlXCI9PWdbMV0/YisoZitcIj1cIitkK1wiJlwiKTpiKyhmK1wiPXJlZGFjdGVkJlwiKTt9fXJldHVybiBifTt2YXIgTT1uZXcgSDtmdW5jdGlvbiBZYihhKXtELmNhbGwodGhpcyxcInNlcnZlcnJlYWNoYWJpbGl0eVwiLGEpO314KFliLEQpO2Z1bmN0aW9uIE4oYSl7TS5kaXNwYXRjaEV2ZW50KG5ldyBZYihNLGEpKTt9ZnVuY3Rpb24gWmIoYSxiKXtELmNhbGwodGhpcyxcInN0YXRldmVudFwiLGEpO3RoaXMuc3RhdD1iO314KFpiLEQpO2Z1bmN0aW9uIE8oYSl7TS5kaXNwYXRjaEV2ZW50KG5ldyBaYihNLGEpKTt9ZnVuY3Rpb24gJGIoYSxiLGMpe0QuY2FsbCh0aGlzLFwidGltaW5nZXZlbnRcIixhKTt0aGlzLnNpemU9Yjt0aGlzLnJ0dD1jO314KCRiLEQpO2Z1bmN0aW9uIGFjKGEsYixjKXtNLmRpc3BhdGNoRXZlbnQobmV3ICRiKE0sYSxiLGMpKTt9ZnVuY3Rpb24gUChhLGIpe2lmKCFxKGEpKXRocm93IEVycm9yKFwiRm4gbXVzdCBub3QgYmUgbnVsbCBhbmQgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO3JldHVybiBoLnNldFRpbWVvdXQoZnVuY3Rpb24oKXthKCk7fSxiKX12YXIgYmM9e05PX0VSUk9SOjAsVmc6MSxiaDoyLGFoOjMsWWc6NCwkZzo1LGRoOjYsTmU6NyxUSU1FT1VUOjgsZ2g6OX07dmFyIGNjPXtYZzpcImNvbXBsZXRlXCIsa2g6XCJzdWNjZXNzXCIsT2U6XCJlcnJvclwiLE5lOlwiYWJvcnRcIixpaDpcInJlYWR5XCIsamg6XCJyZWFkeXN0YXRlY2hhbmdlXCIsVElNRU9VVDpcInRpbWVvdXRcIixlaDpcImluY3JlbWVudGFsZGF0YVwiLGhoOlwicHJvZ3Jlc3NcIixaZzpcImRvd25sb2FkcHJvZ3Jlc3NcIixsaDpcInVwbG9hZHByb2dyZXNzXCJ9O2Z1bmN0aW9uIGRjKCl7fWRjLnByb3RvdHlwZS5wZD1udWxsO2RjLnByb3RvdHlwZS5WZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBkfHwodGhpcy5wZD10aGlzLk1mKCkpfTtmdW5jdGlvbiBlYygpe312YXIgUT17T1BFTjpcImFcIixXZzpcImJcIixPZTpcImNcIixmaDpcImRcIn07ZnVuY3Rpb24gZmMoKXtELmNhbGwodGhpcyxcImRcIik7fXgoZmMsRCk7ZnVuY3Rpb24gZ2MoKXtELmNhbGwodGhpcyxcImNcIik7fXgoZ2MsRCk7dmFyIGhjO2Z1bmN0aW9uIGljKCl7fXgoaWMsZGMpO2ljLnByb3RvdHlwZS5EZD1mdW5jdGlvbigpe3ZhciBhPXRoaXMuV2QoKTtyZXR1cm4gYT9uZXcgQWN0aXZlWE9iamVjdChhKTpuZXcgWE1MSHR0cFJlcXVlc3R9O2ljLnByb3RvdHlwZS5NZj1mdW5jdGlvbigpe3ZhciBhPXt9O3RoaXMuV2QoKSYmKGFbMF09ITAsIGFbMV09ITApO3JldHVybiBhfTtcbmljLnByb3RvdHlwZS5XZD1mdW5jdGlvbigpe2lmKCF0aGlzLmJlJiZcInVuZGVmaW5lZFwiPT10eXBlb2YgWE1MSHR0cFJlcXVlc3QmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBBY3RpdmVYT2JqZWN0KXtmb3IodmFyIGE9W1wiTVNYTUwyLlhNTEhUVFAuNi4wXCIsXCJNU1hNTDIuWE1MSFRUUC4zLjBcIixcIk1TWE1MMi5YTUxIVFRQXCIsXCJNaWNyb3NvZnQuWE1MSFRUUFwiXSxiPTA7YjxhLmxlbmd0aDtiKyspe3ZhciBjPWFbYl07dHJ5e3JldHVybiBuZXcgQWN0aXZlWE9iamVjdChjKSwgdGhpcy5iZT1jfWNhdGNoKGQpe319dGhyb3cgRXJyb3IoXCJDb3VsZCBub3QgY3JlYXRlIEFjdGl2ZVhPYmplY3QuIEFjdGl2ZVggbWlnaHQgYmUgZGlzYWJsZWQsIG9yIE1TWE1MIG1pZ2h0IG5vdCBiZSBpbnN0YWxsZWRcIik7fXJldHVybiB0aGlzLmJlfTtoYz1uZXcgaWM7ZnVuY3Rpb24gUihhLGIsYyxkLGYpe3RoaXMuYj1hO3RoaXMuYT1iO3RoaXMucmE9Yzt0aGlzLlI9ZDt0aGlzLlhjPWZ8fDE7dGhpcy5GYz1uZXcgSmIodGhpcyk7dGhpcy5VYT1qYzthPUxhPzEyNTp2b2lkIDA7dGhpcy5WYz1uZXcgR2IoYSk7dGhpcy5BPW51bGw7dGhpcy5TPSExO3RoaXMuRGE9dGhpcy5wYT10aGlzLnVhPXRoaXMuaWM9dGhpcy5xYj10aGlzLmhkPXRoaXMuR2E9bnVsbDt0aGlzLmJhPVtdO3RoaXMuaD1udWxsO3RoaXMuQmI9MDt0aGlzLkk9dGhpcy5GYT1udWxsO3RoaXMudz0tMTt0aGlzLlphPSExO3RoaXMuUmE9MDt0aGlzLmFjPW51bGw7dGhpcy5sYj10aGlzLkVkPXRoaXMueWM9ITE7fXZhciBqYz00NUUzO1xuZnVuY3Rpb24ga2MoYSxiKXtzd2l0Y2goYSl7Y2FzZSAwOnJldHVyblwiTm9uLTIwMCByZXR1cm4gY29kZSAoXCIrYitcIilcIjtjYXNlIDE6cmV0dXJuXCJYTUxIVFRQIGZhaWx1cmUgKG5vIGRhdGEpXCI7Y2FzZSAyOnJldHVyblwiSHR0cENvbm5lY3Rpb24gdGltZW91dFwiO2RlZmF1bHQ6cmV0dXJuXCJVbmtub3duIGVycm9yXCJ9fXZhciBsYz17fSxtYz17fTtlPVIucHJvdG90eXBlO2UuZ2E9ZnVuY3Rpb24oYSl7dGhpcy5BPWE7fTtlLnNldFRpbWVvdXQ9ZnVuY3Rpb24oYSl7dGhpcy5VYT1hO307ZS5IZT1mdW5jdGlvbihhKXt0aGlzLlJhPWE7fTtlLkdnPWZ1bmN0aW9uKGEpe3RoaXMuYmE9YTt9O2UubGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iYX07ZS5rZD1mdW5jdGlvbihhLGIpe3RoaXMuaWM9MTt0aGlzLnVhPWEuY2xvbmUoKS5VYigpO3RoaXMuRGE9Yjt0aGlzLnljPSEwO3RoaXMuQ2UobnVsbCk7fTtcbmUuamQ9ZnVuY3Rpb24oYSxiLGMpe3RoaXMuaWM9MTt0aGlzLnVhPWEuY2xvbmUoKS5VYigpO3RoaXMuRGE9bnVsbDt0aGlzLnljPWI7dGhpcy5DZShjKTt9O1xuZS5DZT1mdW5jdGlvbihhKXt0aGlzLnFiPXcoKTt0aGlzLmViKCk7dGhpcy5wYT10aGlzLnVhLmNsb25lKCk7dGhpcy5wYS5kYyhcInRcIix0aGlzLlhjKTt0aGlzLkJiPTA7dGhpcy5oPXRoaXMuYi5KYih0aGlzLmIuZmMoKT9hOm51bGwpOzA8dGhpcy5SYSYmKHRoaXMuYWM9bmV3IEliKHUodGhpcy5NZSx0aGlzLHRoaXMuaCksdGhpcy5SYSkpO3RoaXMuRmMubmIodGhpcy5oLFwicmVhZHlzdGF0ZWNoYW5nZVwiLHRoaXMubWcpO2E9dGhpcy5BP0RhKHRoaXMuQSk6e307dGhpcy5EYT8odGhpcy5GYXx8KHRoaXMuRmE9XCJQT1NUXCIpLCBhW1wiQ29udGVudC1UeXBlXCJdPVwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsIHRoaXMuaC5zZW5kKHRoaXMucGEsdGhpcy5GYSx0aGlzLkRhLGEpKToodGhpcy5GYT1cIkdFVFwiLCB0aGlzLmguc2VuZCh0aGlzLnBhLHRoaXMuRmEsbnVsbCxhKSk7TigxKTt0aGlzLmEuVGcodGhpcy5GYSx0aGlzLnBhLHRoaXMuUix0aGlzLlhjLHRoaXMuRGEpO307XG5lLm1nPWZ1bmN0aW9uKGEpe2E9YS50YXJnZXQ7dmFyIGI9dGhpcy5hYztiJiYzPT1hLm1hKCk/KHRoaXMuYS5kZWJ1ZyhcIlRocm90dGxpbmcgcmVhZHlzdGF0ZWNoYW5nZS5cIiksIGIubWYoKSk6dGhpcy5NZShhKTt9O2UuTWU9ZnVuY3Rpb24oYSl7dHJ5e2E9PXRoaXMuaD90aGlzLmhnKCk6dGhpcy5hLlQoXCJDYWxsZWQgYmFjayB3aXRoIGFuIHVuZXhwZWN0ZWQgeG1saHR0cFwiKTt9Y2F0Y2goYyl7aWYodGhpcy5hLmRlYnVnKFwiRmFpbGVkIGNhbGwgdG8gT25YbWxIdHRwUmVhZHlTdGF0ZUNoYW5nZWRfXCIpLCB0aGlzLmgmJnRoaXMuaC55YSgpKXt2YXIgYj10aGlzO3RoaXMuYS5jYihjLGZ1bmN0aW9uKCl7cmV0dXJuXCJSZXNwb25zZVRleHQ6IFwiK2IuaC55YSgpfSk7fWVsc2UgdGhpcy5hLmNiKGMsXCJObyByZXNwb25zZSB0ZXh0XCIpO31maW5hbGx5e319O1xuZS5oZz1mdW5jdGlvbigpe3ZhciBhPXRoaXMuaC5tYSgpLGI9dGhpcy5oLlVkKCksYz10aGlzLmguemEoKTtpZighKDM+YXx8Mz09YSYmIUxhJiYhdGhpcy5oLnlhKCkpKXt0aGlzLlphfHw0IT1hfHw3PT1ifHwoOD09Ynx8MD49Yz9OKDMpOk4oMikpO3RoaXMuRmIoKTt2YXIgZD10aGlzLmguemEoKTt0aGlzLnc9ZDtiPXRoaXMuaC55YSgpO2lmKCFiKXt2YXIgZj10aGlzO3RoaXMuYS5kZWJ1ZyhmdW5jdGlvbigpe3JldHVyblwiTm8gcmVzcG9uc2UgdGV4dCBmb3IgdXJpIFwiK2YucGErXCIgc3RhdHVzIFwiK2R9KTt9dGhpcy5TPTIwMD09ZDt0aGlzLmEuVWcodGhpcy5GYSx0aGlzLnBhLHRoaXMuUix0aGlzLlhjLGEsZCk7aWYodGhpcy5TKXtpZih0aGlzLklnKCkpaWYoYz10aGlzLnNmKCkpdGhpcy5hLldhKHRoaXMuUixjLFwiSW5pdGlhbCBoYW5kc2hha2UgcmVzcG9uc2UgdmlhIFgtSFRUUC1Jbml0aWFsLVJlc3BvbnNlXCIpLCB0aGlzLmxiPSEwLCB0aGlzLlljKGMpO2Vsc2V7dGhpcy5TPSExO1xudGhpcy5JPTM7TygxMik7dGhpcy5hLlQoXCJYTUxIVFRQIE1pc3NpbmcgWF9IVFRQX0lOSVRJQUxfUkVTUE9OU0UgKFwiK3RoaXMuUitcIilcIik7dGhpcy5JYSgpO3RoaXMuS2IoKTtyZXR1cm59dGhpcy55Yz8odGhpcy5GZChhLGIpLCBMYSYmdGhpcy5TJiYzPT1hJiZ0aGlzLk5nKCkpOih0aGlzLmEuV2EodGhpcy5SLGIsbnVsbCksIHRoaXMuWWMoYikpOzQ9PWEmJnRoaXMuSWEoKTt0aGlzLlMmJiF0aGlzLlphJiYoND09YT90aGlzLmIuVGModGhpcyk6KHRoaXMuUz0hMSwgdGhpcy5lYigpKSk7fWVsc2UgNDAwPT1kJiYwPGIuaW5kZXhPZihcIlVua25vd24gU0lEXCIpPyh0aGlzLkk9MywgTygxMiksIHRoaXMuYS5UKFwiWE1MSFRUUCBVbmtub3duIFNJRCAoXCIrdGhpcy5SK1wiKVwiKSk6KHRoaXMuST0wLCBPKDEzKSwgdGhpcy5hLlQoXCJYTUxIVFRQIEJhZCBzdGF0dXMgXCIrZCtcIiAoXCIrdGhpcy5SK1wiKVwiKSksIHRoaXMuSWEoKSwgdGhpcy5LYigpO319O2UuSWc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5FZCYmIXRoaXMubGJ9O1xuZS5zZj1mdW5jdGlvbigpe2lmKHRoaXMuaCl7dmFyIGE9dGhpcy5oLmtiKFwiWC1IVFRQLUluaXRpYWwtUmVzcG9uc2VcIik7aWYoYSYmIXZhKGEpKXJldHVybiBhfXJldHVybiBudWxsfTtlLkFnPWZ1bmN0aW9uKCl7dGhpcy5FZD0hMDt9O1xuZS5GZD1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0hMDshdGhpcy5aYSYmdGhpcy5CYjxiLmxlbmd0aDspe3ZhciBkPXRoaXMudmYoYik7aWYoZD09bWMpezQ9PWEmJih0aGlzLkk9NCwgTygxNCksIGM9ITEpO3RoaXMuYS5XYSh0aGlzLlIsbnVsbCxcIltJbmNvbXBsZXRlIFJlc3BvbnNlXVwiKTticmVha31lbHNlIGlmKGQ9PWxjKXt0aGlzLkk9NDtPKDE1KTt0aGlzLmEuV2EodGhpcy5SLGIsXCJbSW52YWxpZCBDaHVua11cIik7Yz0hMTticmVha31lbHNlIHRoaXMuYS5XYSh0aGlzLlIsZCxudWxsKSwgdGhpcy5ZYyhkKTt9ND09YSYmMD09Yi5sZW5ndGgmJih0aGlzLkk9MSwgTygxNiksIGM9ITEpO3RoaXMuUz10aGlzLlMmJmM7Y3x8KHRoaXMuYS5XYSh0aGlzLlIsYixcIltJbnZhbGlkIENodW5rZWQgUmVzcG9uc2VdXCIpLCB0aGlzLklhKCksIHRoaXMuS2IoKSk7fTtcbmUua2c9ZnVuY3Rpb24oKXtpZih0aGlzLmgpe3ZhciBhPXRoaXMuaC5tYSgpLGI9dGhpcy5oLnlhKCk7dGhpcy5CYjxiLmxlbmd0aCYmKHRoaXMuRmIoKSwgdGhpcy5GZChhLGIpLCB0aGlzLlMmJjQhPWEmJnRoaXMuZWIoKSk7fX07ZS5OZz1mdW5jdGlvbigpe3RoaXMuRmMubmIodGhpcy5WYyxcInRpY2tcIix0aGlzLmtnKTt0aGlzLlZjLnN0YXJ0KCk7fTtlLnZmPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuQmIsYz1hLmluZGV4T2YoXCJcXG5cIixiKTtpZigtMT09YylyZXR1cm4gbWM7Yj1OdW1iZXIoYS5zdWJzdHJpbmcoYixjKSk7aWYoaXNOYU4oYikpcmV0dXJuIGxjO2MrPTE7aWYoYytiPmEubGVuZ3RoKXJldHVybiBtYzthPWEuc3Vic3RyKGMsYik7dGhpcy5CYj1jK2I7cmV0dXJuIGF9O1xuZS55Zz1mdW5jdGlvbihhKXt0aGlzLmljPTI7dGhpcy51YT1hLmNsb25lKCkuVWIoKTthPSExO2gubmF2aWdhdG9yJiZoLm5hdmlnYXRvci5zZW5kQmVhY29uJiYoYT1oLm5hdmlnYXRvci5zZW5kQmVhY29uKHRoaXMudWEudG9TdHJpbmcoKSxcIlwiKSk7IWEmJmguSW1hZ2UmJigobmV3IEltYWdlKS5zcmM9dGhpcy51YSwgYT0hMCk7YXx8KHRoaXMuaD10aGlzLmIuSmIobnVsbCksIHRoaXMuaC5zZW5kKHRoaXMudWEpKTt0aGlzLnFiPXcoKTt0aGlzLmViKCk7fTtlLmNhbmNlbD1mdW5jdGlvbigpe3RoaXMuWmE9ITA7dGhpcy5JYSgpO307ZS50Zz1mdW5jdGlvbihhKXthJiZ0aGlzLnNldFRpbWVvdXQoYSk7dGhpcy5HYSYmKHRoaXMuRmIoKSwgdGhpcy5lYigpKTt9O2UuZWI9ZnVuY3Rpb24oKXt0aGlzLmhkPXcoKSt0aGlzLlVhO3RoaXMuS2UodGhpcy5VYSk7fTtcbmUuS2U9ZnVuY3Rpb24oYSl7aWYobnVsbCE9dGhpcy5HYSl0aHJvdyBFcnJvcihcIldhdGNoRG9nIHRpbWVyIG5vdCBudWxsXCIpO3RoaXMuR2E9UCh1KHRoaXMuZ2csdGhpcyksYSk7fTtlLkZiPWZ1bmN0aW9uKCl7dGhpcy5HYSYmKGguY2xlYXJUaW1lb3V0KHRoaXMuR2EpLCB0aGlzLkdhPW51bGwpO307ZS5nZz1mdW5jdGlvbigpe3RoaXMuR2E9bnVsbDt2YXIgYT13KCk7MDw9YS10aGlzLmhkP3RoaXMuRGYoKToodGhpcy5hLlQoXCJXYXRjaERvZyB0aW1lciBjYWxsZWQgdG9vIGVhcmx5XCIpLCB0aGlzLktlKHRoaXMuaGQtYSkpO307ZS5EZj1mdW5jdGlvbigpe3RoaXMuUyYmdGhpcy5hLmNhKFwiUmVjZWl2ZWQgd2F0Y2hkb2cgdGltZW91dCBldmVuIHRob3VnaCByZXF1ZXN0IGxvYWRlZCBzdWNjZXNzZnVsbHlcIik7dGhpcy5hLlNnKHRoaXMucGEpOzIhPXRoaXMuaWMmJihOKDMpLCBPKDE3KSk7dGhpcy5JYSgpO3RoaXMuST0yO3RoaXMuS2IoKTt9O1xuZS5LYj1mdW5jdGlvbigpe3RoaXMuYi5kZSgpfHx0aGlzLlphfHx0aGlzLmIuVGModGhpcyk7fTtlLklhPWZ1bmN0aW9uKCl7dGhpcy5GYigpO3ZhciBhPXRoaXMuYWM7YSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5iYiYmYS5iYigpO3RoaXMuYWM9bnVsbDt0aGlzLlZjLnN0b3AoKTt0aGlzLkZjLnBiKCk7dGhpcy5oJiYoYT10aGlzLmgsIHRoaXMuaD1udWxsLCBhLmFib3J0KCksIGEuYmIoKSk7fTtlLkhjPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuSX07ZS5ZYz1mdW5jdGlvbihhKXt0cnl7dGhpcy5iLnVlKHRoaXMsYSksIE4oNCk7fWNhdGNoKGIpe3RoaXMuYS5jYihiLFwiRXJyb3IgaW4gaHR0cHJlcXVlc3QgY2FsbGJhY2tcIik7fX07ZnVuY3Rpb24gbmMoYSl7aWYoYS5IJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLkgpcmV0dXJuIGEuSCgpO2lmKGwoYSkpcmV0dXJuIGEuc3BsaXQoXCJcIik7aWYoY2EoYSkpe2Zvcih2YXIgYj1bXSxjPWEubGVuZ3RoLGQ9MDtkPGM7ZCsrKWIucHVzaChhW2RdKTtyZXR1cm4gYn1yZXR1cm4gQmEoYSl9XG5mdW5jdGlvbiBvYyhhLGIsYyl7aWYoYS5mb3JFYWNoJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLmZvckVhY2gpYS5mb3JFYWNoKGIsYyk7ZWxzZSBpZihjYShhKXx8bChhKSluYShhLGIsYyk7ZWxzZXtpZihhLlcmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuVyl2YXIgZD1hLlcoKTtlbHNlIGlmKGEuSCYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5IKWQ9dm9pZCAwO2Vsc2UgaWYoY2EoYSl8fGwoYSkpe2Q9W107Zm9yKHZhciBmPWEubGVuZ3RoLGc9MDtnPGY7ZysrKWQucHVzaChnKTt9ZWxzZSBkPUNhKGEpO2Y9bmMoYSk7Zz1mLmxlbmd0aDtmb3IodmFyIGs9MDtrPGc7aysrKWIuY2FsbChjLGZba10sZCYmZFtrXSxhKTt9fWZ1bmN0aW9uIFMoYSxiKXt0aGlzLkQ9e307dGhpcy5vPVtdO3RoaXMuaj0wO3ZhciBjPWFyZ3VtZW50cy5sZW5ndGg7aWYoMTxjKXtpZihjJTIpdGhyb3cgRXJyb3IoXCJVbmV2ZW4gbnVtYmVyIG9mIGFyZ3VtZW50c1wiKTtmb3IodmFyIGQ9MDtkPGM7ZCs9Mil0aGlzLnNldChhcmd1bWVudHNbZF0sYXJndW1lbnRzW2QrMV0pO31lbHNlIGEmJnRoaXMuYWRkQWxsKGEpO31lPVMucHJvdG90eXBlO2UuQz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2UuSD1mdW5jdGlvbigpe3RoaXMud2MoKTtmb3IodmFyIGE9W10sYj0wO2I8dGhpcy5vLmxlbmd0aDtiKyspYS5wdXNoKHRoaXMuRFt0aGlzLm9bYl1dKTtyZXR1cm4gYX07ZS5XPWZ1bmN0aW9uKCl7dGhpcy53YygpO3JldHVybiB0aGlzLm8uY29uY2F0KCl9O2UudmE9ZnVuY3Rpb24oYSl7cmV0dXJuIFQodGhpcy5ELGEpfTtlLlg9ZnVuY3Rpb24oKXtyZXR1cm4gMD09dGhpcy5qfTtcbmUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLkQ9e307dGhpcy5qPXRoaXMuby5sZW5ndGg9MDt9O2UucmVtb3ZlPWZ1bmN0aW9uKGEpe3JldHVybiBUKHRoaXMuRCxhKT8oZGVsZXRlIHRoaXMuRFthXSwgdGhpcy5qLS0sIHRoaXMuby5sZW5ndGg+Mip0aGlzLmomJnRoaXMud2MoKSwgITApOiExfTtlLndjPWZ1bmN0aW9uKCl7aWYodGhpcy5qIT10aGlzLm8ubGVuZ3RoKXtmb3IodmFyIGE9MCxiPTA7YTx0aGlzLm8ubGVuZ3RoOyl7dmFyIGM9dGhpcy5vW2FdO1QodGhpcy5ELGMpJiYodGhpcy5vW2IrK109Yyk7YSsrO310aGlzLm8ubGVuZ3RoPWI7fWlmKHRoaXMuaiE9dGhpcy5vLmxlbmd0aCl7dmFyIGQ9e307Zm9yKGI9YT0wO2E8dGhpcy5vLmxlbmd0aDspYz10aGlzLm9bYV0sIFQoZCxjKXx8KHRoaXMub1tiKytdPWMsIGRbY109MSksIGErKzt0aGlzLm8ubGVuZ3RoPWI7fX07ZS5nZXQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gVCh0aGlzLkQsYSk/dGhpcy5EW2FdOmJ9O1xuZS5zZXQ9ZnVuY3Rpb24oYSxiKXtUKHRoaXMuRCxhKXx8KHRoaXMuaisrLCB0aGlzLm8ucHVzaChhKSk7dGhpcy5EW2FdPWI7fTtlLmFkZEFsbD1mdW5jdGlvbihhKXtpZihhIGluc3RhbmNlb2YgUylmb3IodmFyIGI9YS5XKCksYz0wO2M8Yi5sZW5ndGg7YysrKXRoaXMuc2V0KGJbY10sYS5nZXQoYltjXSkpO2Vsc2UgZm9yKGIgaW4gYSl0aGlzLnNldChiLGFbYl0pO307ZS5mb3JFYWNoPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXRoaXMuVygpLGQ9MDtkPGMubGVuZ3RoO2QrKyl7dmFyIGY9Y1tkXSxnPXRoaXMuZ2V0KGYpO2EuY2FsbChiLGcsZix0aGlzKTt9fTtlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBTKHRoaXMpfTtmdW5jdGlvbiBUKGEsYil7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhLGIpfXZhciBwYz0vXig/OihbXjovPyMuXSspOik/KD86XFwvXFwvKD86KFteLz8jXSopQCk/KFteLyM/XSo/KSg/OjooWzAtOV0rKSk/KD89Wy8jP118JCkpPyhbXj8jXSspPyg/OlxcPyhbXiNdKikpPyg/OiMoW1xcc1xcU10qKSk/JC87ZnVuY3Rpb24gcWMoYSxiKXtpZihhKXthPWEuc3BsaXQoXCImXCIpO2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKXt2YXIgZD1hW2NdLmluZGV4T2YoXCI9XCIpLGY9bnVsbDtpZigwPD1kKXt2YXIgZz1hW2NdLnN1YnN0cmluZygwLGQpO2Y9YVtjXS5zdWJzdHJpbmcoZCsxKTt9ZWxzZSBnPWFbY107YihnLGY/ZGVjb2RlVVJJQ29tcG9uZW50KGYucmVwbGFjZSgvXFwrL2csXCIgXCIpKTpcIlwiKTt9fX1mdW5jdGlvbiBVKGEsYil7dGhpcy54YT10aGlzLnpiPXRoaXMucWE9XCJcIjt0aGlzLkNhPW51bGw7dGhpcy5pYj10aGlzLks9XCJcIjt0aGlzLk89dGhpcy5RZj0hMTt2YXIgYzthIGluc3RhbmNlb2YgVT8odGhpcy5PPXZvaWQgMCE9PWI/YjphLk8sIHRoaXMudGIoYS5xYSksIHRoaXMuY2QoYS56YiksIHRoaXMucmIoYS54YSksIHRoaXMuc2IoYS5DYSksIHRoaXMuZWMoYS5LKSwgdGhpcy5iZChhLlAuY2xvbmUoKSksIHRoaXMuJGMoYS5pYikpOmEmJihjPVN0cmluZyhhKS5tYXRjaChwYykpPyh0aGlzLk89ISFiLCB0aGlzLnRiKGNbMV18fFwiXCIsITApLCB0aGlzLmNkKGNbMl18fFwiXCIsITApLCB0aGlzLnJiKGNbM118fFwiXCIsITApLCB0aGlzLnNiKGNbNF0pLCB0aGlzLmVjKGNbNV18fFwiXCIsITApLCB0aGlzLmJkKGNbNl18fFwiXCIsITApLCB0aGlzLiRjKGNbN118fFwiXCIsITApKToodGhpcy5PPSEhYiwgdGhpcy5QPW5ldyByYyhudWxsLHRoaXMuTykpO31lPVUucHJvdG90eXBlO1xuZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBhPVtdLGI9dGhpcy5xYTtiJiZhLnB1c2goc2MoYix0YywhMCksXCI6XCIpO3ZhciBjPXRoaXMueGE7aWYoY3x8XCJmaWxlXCI9PWIpYS5wdXNoKFwiLy9cIiksIChiPXRoaXMuemIpJiZhLnB1c2goc2MoYix0YywhMCksXCJAXCIpLCBhLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhjKSkucmVwbGFjZSgvJTI1KFswLTlhLWZBLUZdezJ9KS9nLFwiJSQxXCIpKSwgYz10aGlzLkNhLCBudWxsIT1jJiZhLnB1c2goXCI6XCIsU3RyaW5nKGMpKTtpZihjPXRoaXMuSyl0aGlzLkljKCkmJlwiL1wiIT1jLmNoYXJBdCgwKSYmYS5wdXNoKFwiL1wiKSwgYS5wdXNoKHNjKGMsXCIvXCI9PWMuY2hhckF0KDApP3VjOndjLCEwKSk7KGM9dGhpcy5SZCgpKSYmYS5wdXNoKFwiP1wiLGMpOyhjPXRoaXMuaWIpJiZhLnB1c2goXCIjXCIsc2MoYyx4YykpO3JldHVybiBhLmpvaW4oXCJcIil9O1xuZS5yZXNvbHZlPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2xvbmUoKSxjPWEuSGYoKTtjP2IudGIoYS5xYSk6Yz1hLklmKCk7Yz9iLmNkKGEuemIpOmM9YS5JYygpO2M/Yi5yYihhLnhhKTpjPWEuRmYoKTt2YXIgZD1hLks7aWYoYyliLnNiKGEuQ2EpO2Vsc2UgaWYoYz1hLmFlKCkpe2lmKFwiL1wiIT1kLmNoYXJBdCgwKSlpZih0aGlzLkljKCkmJiF0aGlzLmFlKCkpZD1cIi9cIitkO2Vsc2V7dmFyIGY9Yi5LLmxhc3RJbmRleE9mKFwiL1wiKTstMSE9ZiYmKGQ9Yi5LLnN1YnN0cigwLGYrMSkrZCk7fWY9ZDtpZihcIi4uXCI9PWZ8fFwiLlwiPT1mKWQ9XCJcIjtlbHNlIGlmKC0xIT1mLmluZGV4T2YoXCIuL1wiKXx8LTEhPWYuaW5kZXhPZihcIi8uXCIpKXtkPTA9PWYubGFzdEluZGV4T2YoXCIvXCIsMCk7Zj1mLnNwbGl0KFwiL1wiKTtmb3IodmFyIGc9W10saz0wO2s8Zi5sZW5ndGg7KXt2YXIgcD1mW2srK107XCIuXCI9PXA/ZCYmaz09Zi5sZW5ndGgmJmcucHVzaChcIlwiKTpcIi4uXCI9PXA/KCgxPGcubGVuZ3RofHwxPT1nLmxlbmd0aCYmXG5cIlwiIT1nWzBdKSYmZy5wb3AoKSwgZCYmaz09Zi5sZW5ndGgmJmcucHVzaChcIlwiKSk6KGcucHVzaChwKSwgZD0hMCk7fWQ9Zy5qb2luKFwiL1wiKTt9ZWxzZSBkPWY7fWM/Yi5lYyhkKTpjPWEuR2YoKTtjP2IuYmQoYS5QLmNsb25lKCkpOmM9YS5FZigpO2MmJmIuJGMoYS5pYik7cmV0dXJuIGJ9O2UuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFUodGhpcyl9O2UudGI9ZnVuY3Rpb24oYSxiKXt0aGlzLlUoKTtpZih0aGlzLnFhPWI/eWMoYSwhMCk6YSl0aGlzLnFhPXRoaXMucWEucmVwbGFjZSgvOiQvLFwiXCIpO307ZS5IZj1mdW5jdGlvbigpe3JldHVybiEhdGhpcy5xYX07ZS5jZD1mdW5jdGlvbihhLGIpe3RoaXMuVSgpO3RoaXMuemI9Yj95YyhhKTphO307ZS5JZj1mdW5jdGlvbigpe3JldHVybiEhdGhpcy56Yn07ZS5yYj1mdW5jdGlvbihhLGIpe3RoaXMuVSgpO3RoaXMueGE9Yj95YyhhLCEwKTphO307ZS5JYz1mdW5jdGlvbigpe3JldHVybiEhdGhpcy54YX07XG5lLnNiPWZ1bmN0aW9uKGEpe3RoaXMuVSgpO2lmKGEpe2E9TnVtYmVyKGEpO2lmKGlzTmFOKGEpfHwwPmEpdGhyb3cgRXJyb3IoXCJCYWQgcG9ydCBudW1iZXIgXCIrYSk7dGhpcy5DYT1hO31lbHNlIHRoaXMuQ2E9bnVsbDt9O2UuRmY9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbCE9dGhpcy5DYX07ZS5lYz1mdW5jdGlvbihhLGIpe3RoaXMuVSgpO3RoaXMuSz1iP3ljKGEsITApOmE7fTtlLmFlPWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLkt9O2UuR2Y9ZnVuY3Rpb24oKXtyZXR1cm5cIlwiIT09dGhpcy5QLnRvU3RyaW5nKCl9O2UuYmQ9ZnVuY3Rpb24oYSxiKXt0aGlzLlUoKTthIGluc3RhbmNlb2YgcmM/KHRoaXMuUD1hLCB0aGlzLlAuYWQodGhpcy5PKSk6KGJ8fChhPXNjKGEsemMpKSwgdGhpcy5QPW5ldyByYyhhLHRoaXMuTykpO307ZS5SZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLlAudG9TdHJpbmcoKX07ZS5nZXRRdWVyeT1mdW5jdGlvbigpe3JldHVybiB0aGlzLlJkKCl9O1xuZS5sPWZ1bmN0aW9uKGEsYil7dGhpcy5VKCk7dGhpcy5QLnNldChhLGIpO307ZS5kYz1mdW5jdGlvbihhLGIpe3RoaXMuVSgpO24oYil8fChiPVtTdHJpbmcoYildKTt0aGlzLlAuSWUoYSxiKTt9O2UuJGM9ZnVuY3Rpb24oYSxiKXt0aGlzLlUoKTt0aGlzLmliPWI/eWMoYSk6YTt9O2UuRWY9ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuaWJ9O2UuVWI9ZnVuY3Rpb24oKXt0aGlzLlUoKTt0aGlzLmwoXCJ6eFwiLE1hdGguZmxvb3IoMjE0NzQ4MzY0OCpNYXRoLnJhbmRvbSgpKS50b1N0cmluZygzNikrTWF0aC5hYnMoTWF0aC5mbG9vcigyMTQ3NDgzNjQ4Kk1hdGgucmFuZG9tKCkpXncoKSkudG9TdHJpbmcoMzYpKTtyZXR1cm4gdGhpc307ZS5yZW1vdmVQYXJhbWV0ZXI9ZnVuY3Rpb24oYSl7dGhpcy5VKCk7dGhpcy5QLnJlbW92ZShhKTtyZXR1cm4gdGhpc307ZS5VPWZ1bmN0aW9uKCl7aWYodGhpcy5RZil0aHJvdyBFcnJvcihcIlRyaWVkIHRvIG1vZGlmeSBhIHJlYWQtb25seSBVcmlcIik7fTtcbmUuYWQ9ZnVuY3Rpb24oYSl7dGhpcy5PPWE7dGhpcy5QJiZ0aGlzLlAuYWQoYSk7fTtmdW5jdGlvbiBBYyhhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIFU/YS5jbG9uZSgpOm5ldyBVKGEsdm9pZCAwKX1mdW5jdGlvbiBCYyhhLGIsYyxkKXt2YXIgZj1uZXcgVShudWxsLHZvaWQgMCk7YSYmZi50YihhKTtiJiZmLnJiKGIpO2MmJmYuc2IoYyk7ZCYmZi5lYyhkKTtyZXR1cm4gZn1mdW5jdGlvbiB5YyhhLGIpe3JldHVybiBhP2I/ZGVjb2RlVVJJKGEucmVwbGFjZSgvJTI1L2csXCIlMjUyNVwiKSk6ZGVjb2RlVVJJQ29tcG9uZW50KGEpOlwiXCJ9ZnVuY3Rpb24gc2MoYSxiLGMpe3JldHVybiBsKGEpPyhhPWVuY29kZVVSSShhKS5yZXBsYWNlKGIsQ2MpLCBjJiYoYT1hLnJlcGxhY2UoLyUyNShbMC05YS1mQS1GXXsyfSkvZyxcIiUkMVwiKSksIGEpOm51bGx9XG5mdW5jdGlvbiBDYyhhKXthPWEuY2hhckNvZGVBdCgwKTtyZXR1cm5cIiVcIisoYT4+NCYxNSkudG9TdHJpbmcoMTYpKyhhJjE1KS50b1N0cmluZygxNil9dmFyIHRjPS9bI1xcL1xcP0BdL2csd2M9L1sjXFw/Ol0vZyx1Yz0vWyNcXD9dL2csemM9L1sjXFw/QF0vZyx4Yz0vIy9nO2Z1bmN0aW9uIHJjKGEsYil7dGhpcy5qPXRoaXMubT1udWxsO3RoaXMuamE9YXx8bnVsbDt0aGlzLk89ISFiO31lPXJjLnByb3RvdHlwZTtlLiQ9ZnVuY3Rpb24oKXtpZighdGhpcy5tJiYodGhpcy5tPW5ldyBTLCB0aGlzLmo9MCwgdGhpcy5qYSkpe3ZhciBhPXRoaXM7cWModGhpcy5qYSxmdW5jdGlvbihiLGMpe2EuYWRkKGRlY29kZVVSSUNvbXBvbmVudChiLnJlcGxhY2UoL1xcKy9nLFwiIFwiKSksYyk7fSk7fX07ZS5DPWZ1bmN0aW9uKCl7dGhpcy4kKCk7cmV0dXJuIHRoaXMuan07XG5lLmFkZD1mdW5jdGlvbihhLGIpe3RoaXMuJCgpO3RoaXMuT2EoKTthPXRoaXMuTWEoYSk7dmFyIGM9dGhpcy5tLmdldChhKTtjfHx0aGlzLm0uc2V0KGEsYz1bXSk7Yy5wdXNoKGIpO3RoaXMuais9MTtyZXR1cm4gdGhpc307ZS5yZW1vdmU9ZnVuY3Rpb24oYSl7dGhpcy4kKCk7YT10aGlzLk1hKGEpO3JldHVybiB0aGlzLm0udmEoYSk/KHRoaXMuT2EoKSwgdGhpcy5qLT10aGlzLm0uZ2V0KGEpLmxlbmd0aCwgdGhpcy5tLnJlbW92ZShhKSk6ITF9O2UuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLk9hKCk7dGhpcy5tPW51bGw7dGhpcy5qPTA7fTtlLlg9ZnVuY3Rpb24oKXt0aGlzLiQoKTtyZXR1cm4gMD09dGhpcy5qfTtlLnZhPWZ1bmN0aW9uKGEpe3RoaXMuJCgpO2E9dGhpcy5NYShhKTtyZXR1cm4gdGhpcy5tLnZhKGEpfTtcbmUuZm9yRWFjaD1mdW5jdGlvbihhLGIpe3RoaXMuJCgpO3RoaXMubS5mb3JFYWNoKGZ1bmN0aW9uKGMsZCl7bmEoYyxmdW5jdGlvbihjKXthLmNhbGwoYixjLGQsdGhpcyk7fSx0aGlzKTt9LHRoaXMpO307ZS5XPWZ1bmN0aW9uKCl7dGhpcy4kKCk7Zm9yKHZhciBhPXRoaXMubS5IKCksYj10aGlzLm0uVygpLGM9W10sZD0wO2Q8Yi5sZW5ndGg7ZCsrKWZvcih2YXIgZj1hW2RdLGc9MDtnPGYubGVuZ3RoO2crKyljLnB1c2goYltkXSk7cmV0dXJuIGN9O2UuSD1mdW5jdGlvbihhKXt0aGlzLiQoKTt2YXIgYj1bXTtpZihsKGEpKXRoaXMudmEoYSkmJihiPXRhKGIsdGhpcy5tLmdldCh0aGlzLk1hKGEpKSkpO2Vsc2V7YT10aGlzLm0uSCgpO2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKWI9dGEoYixhW2NdKTt9cmV0dXJuIGJ9O1xuZS5zZXQ9ZnVuY3Rpb24oYSxiKXt0aGlzLiQoKTt0aGlzLk9hKCk7YT10aGlzLk1hKGEpO3RoaXMudmEoYSkmJih0aGlzLmotPXRoaXMubS5nZXQoYSkubGVuZ3RoKTt0aGlzLm0uc2V0KGEsW2JdKTt0aGlzLmorPTE7cmV0dXJuIHRoaXN9O2UuZ2V0PWZ1bmN0aW9uKGEsYil7aWYoIWEpcmV0dXJuIGI7YT10aGlzLkgoYSk7cmV0dXJuIDA8YS5sZW5ndGg/U3RyaW5nKGFbMF0pOmJ9O2UuSWU9ZnVuY3Rpb24oYSxiKXt0aGlzLnJlbW92ZShhKTswPGIubGVuZ3RoJiYodGhpcy5PYSgpLCB0aGlzLm0uc2V0KHRoaXMuTWEoYSksdWEoYikpLCB0aGlzLmorPWIubGVuZ3RoKTt9O1xuZS50b1N0cmluZz1mdW5jdGlvbigpe2lmKHRoaXMuamEpcmV0dXJuIHRoaXMuamE7aWYoIXRoaXMubSlyZXR1cm5cIlwiO2Zvcih2YXIgYT1bXSxiPXRoaXMubS5XKCksYz0wO2M8Yi5sZW5ndGg7YysrKXt2YXIgZD1iW2NdLGY9ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhkKSk7ZD10aGlzLkgoZCk7Zm9yKHZhciBnPTA7ZzxkLmxlbmd0aDtnKyspe3ZhciBrPWY7XCJcIiE9PWRbZ10mJihrKz1cIj1cIitlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGRbZ10pKSk7YS5wdXNoKGspO319cmV0dXJuIHRoaXMuamE9YS5qb2luKFwiJlwiKX07ZS5PYT1mdW5jdGlvbigpe3RoaXMuamE9bnVsbDt9O2UuY2xvbmU9ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcmM7YS5qYT10aGlzLmphO3RoaXMubSYmKGEubT10aGlzLm0uY2xvbmUoKSwgYS5qPXRoaXMuaik7cmV0dXJuIGF9O2UuTWE9ZnVuY3Rpb24oYSl7YT1TdHJpbmcoYSk7dGhpcy5PJiYoYT1hLnRvTG93ZXJDYXNlKCkpO3JldHVybiBhfTtcbmUuYWQ9ZnVuY3Rpb24oYSl7YSYmIXRoaXMuTyYmKHRoaXMuJCgpLCB0aGlzLk9hKCksIHRoaXMubS5mb3JFYWNoKGZ1bmN0aW9uKGEsYyl7dmFyIGI9Yy50b0xvd2VyQ2FzZSgpO2MhPWImJih0aGlzLnJlbW92ZShjKSwgdGhpcy5JZShiLGEpKTt9LHRoaXMpKTt0aGlzLk89YTt9O2UuZXh0ZW5kPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wO2I8YXJndW1lbnRzLmxlbmd0aDtiKyspb2MoYXJndW1lbnRzW2JdLGZ1bmN0aW9uKGEsYil7dGhpcy5hZGQoYixhKTt9LHRoaXMpO307ZnVuY3Rpb24gRmMoKXt9ZnVuY3Rpb24gR2MoKXt9eChHYyxGYyk7ZnVuY3Rpb24gSGMoYSxiKXt0aGlzLmI9YTt0aGlzLmE9Yjt0aGlzLmY9dGhpcy5BPW51bGw7dGhpcy5iYz0hMTt0aGlzLks9bnVsbDt0aGlzLnc9LTE7dGhpcy5BZD10aGlzLm5hPW51bGw7fWU9SGMucHJvdG90eXBlO2UuZz1udWxsO2UuZ2E9ZnVuY3Rpb24oYSl7dGhpcy5BPWE7fTtlLmNvbm5lY3Q9ZnVuY3Rpb24oYSl7dGhpcy5LPWE7YT10aGlzLmIuU2QodGhpcy5LKTtPKDMpO3ZhciBiPXRoaXMuYi5JYi4kZDtudWxsIT1iPyh0aGlzLm5hPXRoaXMuYi4kYShiWzBdKSwgdGhpcy5nPTEsIHRoaXMueGQoKSk6KGEuZGMoXCJNT0RFXCIsXCJpbml0XCIpLCAhdGhpcy5iLnRhJiZ0aGlzLmIuYWEmJmEuZGMoXCJYLUhUVFAtU2Vzc2lvbi1JZFwiLHRoaXMuYi5hYSksIHRoaXMuZj1uZXcgUih0aGlzLHRoaXMuYSx2b2lkIDAsdm9pZCAwLHZvaWQgMCksIHRoaXMuZi5nYSh0aGlzLkEpLCB0aGlzLmYuamQoYSwhMSxudWxsKSwgdGhpcy5nPTApO307XG5lLnhkPWZ1bmN0aW9uKCl7dGhpcy5hLmRlYnVnKFwiVGVzdENvbm5lY3Rpb246IHN0YXJ0aW5nIHN0YWdlIDJcIik7dmFyIGE9dGhpcy5iLkliLm9kO2lmKG51bGwhPWEpdGhpcy5hLmRlYnVnKGZ1bmN0aW9uKCl7cmV0dXJuXCJUZXN0Q29ubmVjdGlvbjogc2tpcHBpbmcgc3RhZ2UgMiwgcHJlY29tcHV0ZWQgcmVzdWx0IGlzIFwiK2E/XCJCdWZmZXJlZFwiOlwiVW5idWZmZXJlZFwifSksIE8oNCksIGE/KE8oMTApLCB0aGlzLmIudWIodGhpcywhMSkpOihPKDExKSwgdGhpcy5iLnViKHRoaXMsITApKTtlbHNle3RoaXMuZj1uZXcgUih0aGlzLHRoaXMuYSx2b2lkIDAsdm9pZCAwLHZvaWQgMCk7dGhpcy5mLmdhKHRoaXMuQSk7dmFyIGI9dGhpcy5iLlBkKHRoaXMubmEsdGhpcy5LKTtPKDQpO2IuZGMoXCJUWVBFXCIsXCJ4bWxodHRwXCIpO3ZhciBjPXRoaXMuYi5hYSxkPXRoaXMuYi5LYztjJiZkJiZiLmwoYyxkKTt0aGlzLmYuamQoYiwhMSx0aGlzLm5hKTt9fTtlLkpiPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmIuSmIoYSl9O1xuZS5hYm9ydD1mdW5jdGlvbigpe3RoaXMuZiYmKHRoaXMuZi5jYW5jZWwoKSwgdGhpcy5mPW51bGwpO3RoaXMudz0tMTt9O2UuZGU9ZnVuY3Rpb24oKXtyZXR1cm4hMX07XG5lLnVlPWZ1bmN0aW9uKGEsYil7dGhpcy53PWEudztpZigwPT10aGlzLmcpaWYodGhpcy5hLmRlYnVnKFwiVGVzdENvbm5lY3Rpb246IEdvdCBkYXRhIGZvciBzdGFnZSAxXCIpLCB0aGlzLnBjKGEpLCBiKXt0cnl7dmFyIGM9dGhpcy5iLmtjLnpjKGIpO31jYXRjaChkKXt0aGlzLmEuY2IoZCk7dGhpcy5iLmRkKHRoaXMpO3JldHVybn10aGlzLm5hPXRoaXMuYi4kYShjWzBdKTt9ZWxzZSB0aGlzLmEuZGVidWcoXCJUZXN0Q29ubmVjdGlvbjogTnVsbCByZXNwb25zZVRleHRcIiksIHRoaXMuYi5kZCh0aGlzKTtlbHNlIDE9PXRoaXMuZyYmKHRoaXMuYmM/Tyg2KTpcIjExMTExXCI9PWI/KE8oNSksIHRoaXMuYmM9ITAsIHRoaXMuWmUoKSYmKHRoaXMudz0yMDAsIHRoaXMuZi5jYW5jZWwoKSwgdGhpcy5hLmRlYnVnKFwiVGVzdCBjb25uZWN0aW9uIHN1Y2NlZWRlZDsgdXNpbmcgc3RyZWFtaW5nIGNvbm5lY3Rpb25cIiksIE8oMTEpLCB0aGlzLmIudWIodGhpcywhMCkpKTooTyg3KSwgdGhpcy5iYz0hMSkpO307XG5lLlRjPWZ1bmN0aW9uKCl7dGhpcy53PXRoaXMuZi53O3RoaXMuZi5TPzA9PXRoaXMuZz8odGhpcy5nPTEsIHRoaXMuYS5kZWJ1ZyhcIlRlc3RDb25uZWN0aW9uOiByZXF1ZXN0IGNvbXBsZXRlIGZvciBpbml0aWFsIGNoZWNrXCIpLCB0aGlzLnhkKCkpOjE9PXRoaXMuZyYmKHRoaXMuYS5kZWJ1ZyhcIlRlc3RDb25uZWN0aW9uOiByZXF1ZXN0IGNvbXBsZXRlIGZvciBzdGFnZSAyXCIpLCB0aGlzLmJjPyh0aGlzLmEuZGVidWcoXCJUZXN0IGNvbm5lY3Rpb24gc3VjY2VlZGVkOyB1c2luZyBzdHJlYW1pbmcgY29ubmVjdGlvblwiKSwgTygxMSksIHRoaXMuYi51Yih0aGlzLCEwKSk6KHRoaXMuYS5kZWJ1ZyhcIlRlc3QgY29ubmVjdGlvbiBmYWlsZWQ7IG5vdCB1c2luZyBzdHJlYW1pbmdcIiksIE8oMTApLCB0aGlzLmIudWIodGhpcywhMSkpKToodGhpcy5hLmRlYnVnKFwiVGVzdENvbm5lY3Rpb246IHJlcXVlc3QgZmFpbGVkLCBpbiBzdGF0ZSBcIit0aGlzLmcpLCAwPT10aGlzLmc/Tyg4KToxPT10aGlzLmcmJk8oOSksIHRoaXMuYi5kZCh0aGlzKSk7fTtlLnBjPWZ1bmN0aW9uKGEpe2lmKCF0aGlzLmIudGEmJihhPWEuaCkpe3ZhciBiPWEua2IoXCJYLUNsaWVudC1XaXJlLVByb3RvY29sXCIpO3RoaXMuQWQ9Yj9iOm51bGw7dGhpcy5iLmFhJiYoKGE9YS5rYihcIlgtSFRUUC1TZXNzaW9uLUlkXCIpKT90aGlzLmIuRmUoYSk6dGhpcy5hLlQoXCJNaXNzaW5nIFhfSFRUUF9TRVNTSU9OX0lEIGluIHRoZSBoYW5kc2hha2UgcmVzcG9uc2VcIikpO319O2UuZmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iLmZjKCl9O2UuQmE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iLkJhKCl9O2UuWmU9ZnVuY3Rpb24oKXtyZXR1cm4hQ3x8MTA8PU51bWJlcihVYSl9O2Z1bmN0aW9uIEljKCl7dGhpcy5vZD10aGlzLiRkPW51bGw7fWZ1bmN0aW9uIEpjKGEpe3RoaXMuRD1uZXcgUzthJiZ0aGlzLmFkZEFsbChhKTt9ZnVuY3Rpb24gS2MoYSl7dmFyIGI9dHlwZW9mIGE7cmV0dXJuXCJvYmplY3RcIj09YiYmYXx8XCJmdW5jdGlvblwiPT1iP1wib1wiKyhhW3RdfHwoYVt0XT0rK2RhKSk6Yi5zdWJzdHIoMCwxKSthfWU9SmMucHJvdG90eXBlO2UuQz1mdW5jdGlvbigpe3JldHVybiB0aGlzLkQuQygpfTtlLmFkZD1mdW5jdGlvbihhKXt0aGlzLkQuc2V0KEtjKGEpLGEpO307ZS5hZGRBbGw9ZnVuY3Rpb24oYSl7YT1uYyhhKTtmb3IodmFyIGI9YS5sZW5ndGgsYz0wO2M8YjtjKyspdGhpcy5hZGQoYVtjXSk7fTtlLnBiPWZ1bmN0aW9uKGEpe2E9bmMoYSk7Zm9yKHZhciBiPWEubGVuZ3RoLGM9MDtjPGI7YysrKXRoaXMucmVtb3ZlKGFbY10pO307ZS5yZW1vdmU9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuRC5yZW1vdmUoS2MoYSkpfTtlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5ELmNsZWFyKCk7fTtlLlg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ELlgoKX07XG5lLmNvbnRhaW5zPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLkQudmEoS2MoYSkpfTtlLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ELkgoKX07ZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgSmModGhpcyl9O2Z1bmN0aW9uIExjKGEsYil7dGhpcy5QYz1hO3RoaXMubWFwPWI7dGhpcy5jb250ZXh0PW51bGw7fWZ1bmN0aW9uIE1jKGEpe3RoaXMubWU9YXx8TmM7aC5QZXJmb3JtYW5jZU5hdmlnYXRpb25UaW1pbmc/KGE9aC5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlKFwibmF2aWdhdGlvblwiKSwgYT0wPGEubGVuZ3RoJiYoXCJocVwiPT1hWzBdLm5leHRIb3BQcm90b2NvbHx8XCJoMlwiPT1hWzBdLm5leHRIb3BQcm90b2NvbCkpOmE9ISEoaC52YyYmaC52Yy5rZSYmaC52Yy5rZSgpJiZoLnZjLmtlKCkubmgpO3RoaXMuWGI9YT90aGlzLm1lOjE7dGhpcy52PW51bGw7MTx0aGlzLlhiJiYodGhpcy52PW5ldyBKYyk7dGhpcy5mPW51bGw7dGhpcy5iYT1bXTt9dmFyIE5jPTEwO2U9TWMucHJvdG90eXBlO2UubGQ9ZnVuY3Rpb24oYSl7dGhpcy52fHwtMT09YS5pbmRleE9mKFwic3BkeVwiKSYmLTE9PWEuaW5kZXhPZihcInF1aWNcIikmJi0xPT1hLmluZGV4T2YoXCJoMlwiKXx8KHRoaXMuWGI9dGhpcy5tZSwgdGhpcy52PW5ldyBKYywgdGhpcy5mJiYodGhpcy5vYyh0aGlzLmYpLCB0aGlzLmY9bnVsbCkpO307XG5lLmVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZj8hMDp0aGlzLnY/dGhpcy52LkMoKT49dGhpcy5YYjohMX07ZS54Zj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmY/MTp0aGlzLnY/dGhpcy52LkMoKTowfTtlLkpjPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmY/dGhpcy5mPT1hOnRoaXMudj90aGlzLnYuY29udGFpbnMoYSk6ITF9O2Uub2M9ZnVuY3Rpb24oYSl7dGhpcy52P3RoaXMudi5hZGQoYSk6dGhpcy5mPWE7fTtlLnplPWZ1bmN0aW9uKGEpe3RoaXMuZiYmdGhpcy5mPT1hP3RoaXMuZj1udWxsOnRoaXMudiYmdGhpcy52LmNvbnRhaW5zKGEpJiZ0aGlzLnYucmVtb3ZlKGEpO307ZS5jYW5jZWw9ZnVuY3Rpb24oKXt0aGlzLmJhPXRoaXMubGEoKTt0aGlzLmY/KHRoaXMuZi5jYW5jZWwoKSwgdGhpcy5mPW51bGwpOnRoaXMudiYmIXRoaXMudi5YKCkmJihuYSh0aGlzLnYuSCgpLGZ1bmN0aW9uKGEpe2EuY2FuY2VsKCk7fSksIHRoaXMudi5jbGVhcigpKTt9O1xuZS5sYT1mdW5jdGlvbigpe2lmKG51bGwhPXRoaXMuZilyZXR1cm4gdGhpcy5iYS5jb25jYXQodGhpcy5mLmxhKCkpO2lmKG51bGwhPXRoaXMudiYmIXRoaXMudi5YKCkpe3ZhciBhPXRoaXMuYmE7bmEodGhpcy52LkgoKSxmdW5jdGlvbihiKXthPWEuY29uY2F0KGIubGEoKSk7fSk7cmV0dXJuIGF9cmV0dXJuIHVhKHRoaXMuYmEpfTtlLlJlPWZ1bmN0aW9uKGEpe3RoaXMuYmE9dGhpcy5iYS5jb25jYXQoYSk7fTtlLiRlPWZ1bmN0aW9uKCl7dGhpcy5iYS5sZW5ndGg9MDt9O2Z1bmN0aW9uIE9jKCl7dGhpcy54Zz10aGlzLnJnPXZvaWQgMDt9T2MucHJvdG90eXBlLnN0cmluZ2lmeT1mdW5jdGlvbihhKXtyZXR1cm4gaC5KU09OLnN0cmluZ2lmeShhLHRoaXMucmcpfTtPYy5wcm90b3R5cGUucGFyc2U9ZnVuY3Rpb24oYSl7cmV0dXJuIGguSlNPTi5wYXJzZShhLHRoaXMueGcpfTtmdW5jdGlvbiBQYygpe3RoaXMuamc9bmV3IE9jO31QYy5wcm90b3R5cGUuaGY9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWN8fFwiXCI7dHJ5e29jKGEsZnVuY3Rpb24oYSxjKXt2YXIgZj1hO3IoYSkmJihmPXViKGEpKTtiLnB1c2goZCtjK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudChmKSk7fSk7fWNhdGNoKGYpe3Rocm93IGIucHVzaChkK1widHlwZT1cIitlbmNvZGVVUklDb21wb25lbnQoXCJfYmFkbWFwXCIpKSwgZjt9fTtQYy5wcm90b3R5cGUuamY9ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD0tMTs7KXt2YXIgZj1bXCJjb3VudD1cIitiXTstMT09ZD8wPGI/KGQ9YVswXS5QYywgZi5wdXNoKFwib2ZzPVwiK2QpKTpkPTA6Zi5wdXNoKFwib2ZzPVwiK2QpO2Zvcih2YXIgZz0hMCxrPTA7azxiO2srKyl7dmFyIHA9YVtrXS5QYyxVYj1hW2tdLm1hcDtwLT1kO2lmKDA+cClkPU1hdGgubWF4KDAsYVtrXS5QYy0xMDApLCBnPSExO2Vsc2UgdHJ5e3RoaXMuaGYoVWIsZixcInJlcVwiK3ArXCJfXCIpO31jYXRjaChtZCl7YyYmYyhVYik7fX1pZihnKXJldHVybiBmLmpvaW4oXCImXCIpfX07XG5QYy5wcm90b3R5cGUuemM9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuamcucGFyc2UoYSl9O2Z1bmN0aW9uIFFjKGEsYil7dmFyIGM9bmV3IFhiO2MuZGVidWcoXCJUZXN0TG9hZEltYWdlOiBsb2FkaW5nIFwiK2EpO3ZhciBkPW5ldyBJbWFnZTtkLm9ubG9hZD12KFJjLGMsZCxcIlRlc3RMb2FkSW1hZ2U6IGxvYWRlZFwiLCEwLGIpO2Qub25lcnJvcj12KFJjLGMsZCxcIlRlc3RMb2FkSW1hZ2U6IGVycm9yXCIsITEsYik7ZC5vbmFib3J0PXYoUmMsYyxkLFwiVGVzdExvYWRJbWFnZTogYWJvcnRcIiwhMSxiKTtkLm9udGltZW91dD12KFJjLGMsZCxcIlRlc3RMb2FkSW1hZ2U6IHRpbWVvdXRcIiwhMSxiKTtoLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtpZihkLm9udGltZW91dClkLm9udGltZW91dCgpO30sMUU0KTtkLnNyYz1hO31mdW5jdGlvbiBSYyhhLGIsYyxkLGYpe3RyeXthLmRlYnVnKGMpLCBiLm9ubG9hZD1udWxsLCBiLm9uZXJyb3I9bnVsbCwgYi5vbmFib3J0PW51bGwsIGIub250aW1lb3V0PW51bGwsIGYoZCk7fWNhdGNoKGcpe2EuY2IoZyk7fX12YXIgU2M9aC5KU09OLnBhcnNlO2Z1bmN0aW9uIFYoYSl7SC5jYWxsKHRoaXMpO3RoaXMuaGVhZGVycz1uZXcgUzt0aGlzLlhhPWF8fG51bGw7dGhpcy5oYT0hMTt0aGlzLm1jPXRoaXMuYz1udWxsO3RoaXMuZ2U9dGhpcy5UYj1cIlwiO3RoaXMuUGE9MDt0aGlzLkk9XCJcIjt0aGlzLkFhPXRoaXMuTGM9dGhpcy5RYj10aGlzLkVjPSExO3RoaXMudmI9MDt0aGlzLmhjPW51bGw7dGhpcy5BZT1UYzt0aGlzLmpjPXRoaXMubGc9dGhpcy5BYj0hMTt9eChWLEgpO3ZhciBUYz1cIlwiO1YucHJvdG90eXBlLnM9VmIoXCJnb29nLm5ldC5YaHJJb1wiKTt2YXIgVWM9L15odHRwcz8kL2ksVmM9W1wiUE9TVFwiLFwiUFVUXCJdO2U9Vi5wcm90b3R5cGU7ZS5KZT1mdW5jdGlvbihhKXt0aGlzLkFiPWE7fTtcbmUuc2VuZD1mdW5jdGlvbihhLGIsYyxkKXtpZih0aGlzLmMpdGhyb3cgRXJyb3IoXCJbZ29vZy5uZXQuWGhySW9dIE9iamVjdCBpcyBhY3RpdmUgd2l0aCBhbm90aGVyIHJlcXVlc3Q9XCIrdGhpcy5UYitcIjsgbmV3VXJpPVwiK2EpO2I9Yj9iLnRvVXBwZXJDYXNlKCk6XCJHRVRcIjt0aGlzLlRiPWE7dGhpcy5JPVwiXCI7dGhpcy5QYT0wO3RoaXMuZ2U9Yjt0aGlzLkVjPSExO3RoaXMuaGE9ITA7dGhpcy5jPXRoaXMuZGYoKTt0aGlzLm1jPXRoaXMuWGE/dGhpcy5YYS5WZCgpOmhjLlZkKCk7dGhpcy5jLm9ucmVhZHlzdGF0ZWNoYW5nZT11KHRoaXMudGUsdGhpcyk7dGhpcy5sZyYmXCJvbnByb2dyZXNzXCJpbiB0aGlzLmMmJih0aGlzLmMub25wcm9ncmVzcz11KGZ1bmN0aW9uKGEpe3RoaXMucmUoYSwhMCk7fSx0aGlzKSwgdGhpcy5jLnVwbG9hZCYmKHRoaXMuYy51cGxvYWQub25wcm9ncmVzcz11KHRoaXMucmUsdGhpcykpKTt0cnl7TCh0aGlzLnMsdGhpcy5kYShcIk9wZW5pbmcgWGhyXCIpKSwgdGhpcy5MYz1cbiEwLCB0aGlzLmMub3BlbihiLFN0cmluZyhhKSwhMCksIHRoaXMuTGM9ITE7fWNhdGNoKGcpe0wodGhpcy5zLHRoaXMuZGEoXCJFcnJvciBvcGVuaW5nIFhocjogXCIrZy5tZXNzYWdlKSk7dGhpcy5MZChnKTtyZXR1cm59YT1jfHxcIlwiO3ZhciBmPXRoaXMuaGVhZGVycy5jbG9uZSgpO2QmJm9jKGQsZnVuY3Rpb24oYSxiKXtmLnNldChiLGEpO30pO2Q9cGEoZi5XKCkpO2M9aC5Gb3JtRGF0YSYmYSBpbnN0YW5jZW9mIGguRm9ybURhdGE7ISgwPD1sYShWYyxiKSl8fGR8fGN8fGYuc2V0KFwiQ29udGVudC1UeXBlXCIsXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD11dGYtOFwiKTtmLmZvckVhY2goZnVuY3Rpb24oYSxiKXt0aGlzLmMuc2V0UmVxdWVzdEhlYWRlcihiLGEpO30sdGhpcyk7dGhpcy5BZSYmKHRoaXMuYy5yZXNwb25zZVR5cGU9dGhpcy5BZSk7XCJ3aXRoQ3JlZGVudGlhbHNcImluIHRoaXMuYyYmdGhpcy5jLndpdGhDcmVkZW50aWFscyE9PXRoaXMuQWImJih0aGlzLmMud2l0aENyZWRlbnRpYWxzPVxudGhpcy5BYik7dHJ5e3RoaXMueWQoKSwgMDx0aGlzLnZiJiYodGhpcy5qYz1XYyh0aGlzLmMpLCBMKHRoaXMucyx0aGlzLmRhKFwiV2lsbCBhYm9ydCBhZnRlciBcIit0aGlzLnZiK1wibXMgaWYgaW5jb21wbGV0ZSwgeGhyMiBcIit0aGlzLmpjKSksIHRoaXMuamM/KHRoaXMuYy50aW1lb3V0PXRoaXMudmIsIHRoaXMuYy5vbnRpbWVvdXQ9dSh0aGlzLlVhLHRoaXMpKTp0aGlzLmhjPUhiKHRoaXMuVWEsdGhpcy52Yix0aGlzKSksIEwodGhpcy5zLHRoaXMuZGEoXCJTZW5kaW5nIHJlcXVlc3RcIikpLCB0aGlzLlFiPSEwLCB0aGlzLmMuc2VuZChhKSwgdGhpcy5RYj0hMTt9Y2F0Y2goZyl7TCh0aGlzLnMsdGhpcy5kYShcIlNlbmQgZXJyb3I6IFwiK2cubWVzc2FnZSkpLCB0aGlzLkxkKGcpO319O2Z1bmN0aW9uIFdjKGEpe3JldHVybiBDJiZUYSg5KSYmXCJudW1iZXJcIj09dHlwZW9mIGEudGltZW91dCYmdm9pZCAwIT09YS5vbnRpbWVvdXR9XG5mdW5jdGlvbiBxYShhKXtyZXR1cm5cImNvbnRlbnQtdHlwZVwiPT1hLnRvTG93ZXJDYXNlKCl9ZS5kZj1mdW5jdGlvbigpe3JldHVybiB0aGlzLlhhP3RoaXMuWGEuRGQoKTpoYy5EZCgpfTtlLlVhPWZ1bmN0aW9uKCl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGdvb2cmJnRoaXMuYyYmKHRoaXMuST1cIlRpbWVkIG91dCBhZnRlciBcIit0aGlzLnZiK1wibXMsIGFib3J0aW5nXCIsIHRoaXMuUGE9OCwgTCh0aGlzLnMsdGhpcy5kYSh0aGlzLkkpKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwidGltZW91dFwiKSwgdGhpcy5hYm9ydCg4KSk7fTtlLkxkPWZ1bmN0aW9uKGEpe3RoaXMuaGE9ITE7dGhpcy5jJiYodGhpcy5BYT0hMCwgdGhpcy5jLmFib3J0KCksIHRoaXMuQWE9ITEpO3RoaXMuST1hO3RoaXMuUGE9NTt0aGlzLkpkKCk7dGhpcy5HYigpO307ZS5KZD1mdW5jdGlvbigpe3RoaXMuRWN8fCh0aGlzLkVjPSEwLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJjb21wbGV0ZVwiKSwgdGhpcy5kaXNwYXRjaEV2ZW50KFwiZXJyb3JcIikpO307XG5lLmFib3J0PWZ1bmN0aW9uKGEpe3RoaXMuYyYmdGhpcy5oYSYmKEwodGhpcy5zLHRoaXMuZGEoXCJBYm9ydGluZ1wiKSksIHRoaXMuaGE9ITEsIHRoaXMuQWE9ITAsIHRoaXMuYy5hYm9ydCgpLCB0aGlzLkFhPSExLCB0aGlzLlBhPWF8fDcsIHRoaXMuZGlzcGF0Y2hFdmVudChcImNvbXBsZXRlXCIpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJhYm9ydFwiKSwgdGhpcy5HYigpKTt9O2UuRj1mdW5jdGlvbigpe3RoaXMuYyYmKHRoaXMuaGEmJih0aGlzLmhhPSExLCB0aGlzLkFhPSEwLCB0aGlzLmMuYWJvcnQoKSwgdGhpcy5BYT0hMSksIHRoaXMuR2IoITApKTtWLkwuRi5jYWxsKHRoaXMpO307ZS50ZT1mdW5jdGlvbigpe3RoaXMuS2F8fCh0aGlzLkxjfHx0aGlzLlFifHx0aGlzLkFhP3RoaXMuc2UoKTp0aGlzLmVnKCkpO307ZS5lZz1mdW5jdGlvbigpe3RoaXMuc2UoKTt9O1xuZS5zZT1mdW5jdGlvbigpe2lmKHRoaXMuaGEmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBnb29nKWlmKHRoaXMubWNbMV0mJjQ9PXRoaXMubWEoKSYmMj09dGhpcy56YSgpKUwodGhpcy5zLHRoaXMuZGEoXCJMb2NhbCByZXF1ZXN0IGVycm9yIGRldGVjdGVkIGFuZCBpZ25vcmVkXCIpKTtlbHNlIGlmKHRoaXMuUWImJjQ9PXRoaXMubWEoKSlIYih0aGlzLnRlLDAsdGhpcyk7ZWxzZSBpZih0aGlzLmRpc3BhdGNoRXZlbnQoXCJyZWFkeXN0YXRlY2hhbmdlXCIpLCB0aGlzLk1jKCkpe0wodGhpcy5zLHRoaXMuZGEoXCJSZXF1ZXN0IGNvbXBsZXRlXCIpKTt0aGlzLmhhPSExO3RyeXt0aGlzLlJmKCk/KHRoaXMuZGlzcGF0Y2hFdmVudChcImNvbXBsZXRlXCIpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJzdWNjZXNzXCIpKToodGhpcy5QYT02LCB0aGlzLkk9dGhpcy5ZZCgpK1wiIFtcIit0aGlzLnphKCkrXCJdXCIsIHRoaXMuSmQoKSk7fWZpbmFsbHl7dGhpcy5HYigpO319fTtcbmUucmU9ZnVuY3Rpb24oYSxiKXt0aGlzLmRpc3BhdGNoRXZlbnQoWGMoYSxcInByb2dyZXNzXCIpKTt0aGlzLmRpc3BhdGNoRXZlbnQoWGMoYSxiP1wiZG93bmxvYWRwcm9ncmVzc1wiOlwidXBsb2FkcHJvZ3Jlc3NcIikpO307ZnVuY3Rpb24gWGMoYSxiKXtyZXR1cm57dHlwZTpiLGxlbmd0aENvbXB1dGFibGU6YS5sZW5ndGhDb21wdXRhYmxlLGxvYWRlZDphLmxvYWRlZCx0b3RhbDphLnRvdGFsfX1lLkdiPWZ1bmN0aW9uKGEpe2lmKHRoaXMuYyl7dGhpcy55ZCgpO3ZhciBiPXRoaXMuYyxjPXRoaXMubWNbMF0/YWE6bnVsbDt0aGlzLm1jPXRoaXMuYz1udWxsO2F8fHRoaXMuZGlzcGF0Y2hFdmVudChcInJlYWR5XCIpO3RyeXtiLm9ucmVhZHlzdGF0ZWNoYW5nZT1jO31jYXRjaChkKXsoYT10aGlzLnMpJiZhLmNhKFwiUHJvYmxlbSBlbmNvdW50ZXJlZCByZXNldHRpbmcgb25yZWFkeXN0YXRlY2hhbmdlOiBcIitkLm1lc3NhZ2Usdm9pZCAwKTt9fX07XG5lLnlkPWZ1bmN0aW9uKCl7dGhpcy5jJiZ0aGlzLmpjJiYodGhpcy5jLm9udGltZW91dD1udWxsKTt0aGlzLmhjJiYoaC5jbGVhclRpbWVvdXQodGhpcy5oYyksIHRoaXMuaGM9bnVsbCk7fTtlLkJhPWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLmN9O2UuTWM9ZnVuY3Rpb24oKXtyZXR1cm4gND09dGhpcy5tYSgpfTtlLlJmPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy56YSgpO2E6c3dpdGNoKGEpe2Nhc2UgMjAwOmNhc2UgMjAxOmNhc2UgMjAyOmNhc2UgMjA0OmNhc2UgMjA2OmNhc2UgMzA0OmNhc2UgMTIyMzp2YXIgYj0hMDticmVhayBhO2RlZmF1bHQ6Yj0hMTt9cmV0dXJuIGJ8fDA9PT1hJiYhdGhpcy5PZigpfTtcbmUuT2Y9ZnVuY3Rpb24oKXt2YXIgYT1TdHJpbmcodGhpcy5UYikubWF0Y2gocGMpWzFdfHxudWxsOyFhJiZoLnNlbGYmJmguc2VsZi5sb2NhdGlvbiYmKGE9aC5zZWxmLmxvY2F0aW9uLnByb3RvY29sLCBhPWEuc3Vic3RyKDAsYS5sZW5ndGgtMSkpO3JldHVybiBVYy50ZXN0KGE/YS50b0xvd2VyQ2FzZSgpOlwiXCIpfTtlLm1hPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYz90aGlzLmMucmVhZHlTdGF0ZTowfTtlLnphPWZ1bmN0aW9uKCl7dHJ5e3JldHVybiAyPHRoaXMubWEoKT90aGlzLmMuc3RhdHVzOi0xfWNhdGNoKGEpe3JldHVybi0xfX07ZS5ZZD1mdW5jdGlvbigpe3RyeXtyZXR1cm4gMjx0aGlzLm1hKCk/dGhpcy5jLnN0YXR1c1RleHQ6XCJcIn1jYXRjaChhKXtyZXR1cm4gTCh0aGlzLnMsXCJDYW4gbm90IGdldCBzdGF0dXM6IFwiK2EubWVzc2FnZSksIFwiXCJ9fTtcbmUueWE9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHRoaXMuYz90aGlzLmMucmVzcG9uc2VUZXh0OlwiXCJ9Y2F0Y2goYSl7cmV0dXJuIEwodGhpcy5zLFwiQ2FuIG5vdCBnZXQgcmVzcG9uc2VUZXh0OiBcIithLm1lc3NhZ2UpLCBcIlwifX07ZS55Zj1mdW5jdGlvbihhKXtpZih0aGlzLmMpe3ZhciBiPXRoaXMuYy5yZXNwb25zZVRleHQ7YSYmMD09Yi5pbmRleE9mKGEpJiYoYj1iLnN1YnN0cmluZyhhLmxlbmd0aCkpO3JldHVybiBTYyhiKX19O2UuZ2V0UmVzcG9uc2VIZWFkZXI9ZnVuY3Rpb24oYSl7aWYodGhpcy5jJiZ0aGlzLk1jKCkpcmV0dXJuIGE9dGhpcy5jLmdldFJlc3BvbnNlSGVhZGVyKGEpLCBudWxsPT09YT92b2lkIDA6YX07ZS5nZXRBbGxSZXNwb25zZUhlYWRlcnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jJiZ0aGlzLk1jKCk/dGhpcy5jLmdldEFsbFJlc3BvbnNlSGVhZGVycygpfHxcIlwiOlwiXCJ9O1xuZS5rYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jP3RoaXMuYy5nZXRSZXNwb25zZUhlYWRlcihhKTpudWxsfTtlLlVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuUGF9O2UuSGM9ZnVuY3Rpb24oKXtyZXR1cm4gbCh0aGlzLkkpP3RoaXMuSTpTdHJpbmcodGhpcy5JKX07ZS5kYT1mdW5jdGlvbihhKXtyZXR1cm4gYStcIiBbXCIrdGhpcy5nZStcIiBcIit0aGlzLlRiK1wiIFwiK3RoaXMuemEoKStcIl1cIn07ZnVuY3Rpb24gWWMoYSl7dmFyIGI9XCJcIjtBYShhLGZ1bmN0aW9uKGEsZCl7Yis9ZDtiKz1cIjpcIjtiKz1hO2IrPVwiXFxyXFxuXCI7fSk7cmV0dXJuIGJ9ZnVuY3Rpb24gWmMoYSxiLGMpe2E6e2ZvcihkIGluIGMpe3ZhciBkPSExO2JyZWFrIGF9ZD0hMDt9aWYoZClyZXR1cm4gYTtjPVljKGMpO2lmKGwoYSkpe2I9ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhiKSk7Yz1udWxsIT1jP1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoYykpOlwiXCI7aWYoYis9Yyl7Yz1hLmluZGV4T2YoXCIjXCIpOzA+YyYmKGM9YS5sZW5ndGgpO2Q9YS5pbmRleE9mKFwiP1wiKTtpZigwPmR8fGQ+Yyl7ZD1jO3ZhciBmPVwiXCI7fWVsc2UgZj1hLnN1YnN0cmluZyhkKzEsYyk7YT1bYS5zdWJzdHIoMCxkKSxmLGEuc3Vic3RyKGMpXTtjPWFbMV07YVsxXT1iP2M/YytcIiZcIitiOmI6YzthPWFbMF0rKGFbMV0/XCI/XCIrYVsxXTpcIlwiKSthWzJdO31yZXR1cm4gYX1hLmwoYixjKTtyZXR1cm4gYX1mdW5jdGlvbiAkYyhhKXt0aGlzLkJkPTIyO3RoaXMuRGU9MDt0aGlzLk09W107dGhpcy5hPW5ldyBYYjt0aGlzLkliPW5ldyBJYzt0aGlzLm5hPXRoaXMubWQ9dGhpcy5oYj10aGlzLks9dGhpcy51PXRoaXMuS2M9dGhpcy5hYT10aGlzLmdiPXRoaXMuTj10aGlzLlJiPXRoaXMuQT1udWxsO3RoaXMuVGU9ITA7dGhpcy5hZz10aGlzLlliPTA7dGhpcy5rZj0hIW0oXCJpbnRlcm5hbENoYW5uZWxQYXJhbXMuZmFpbEZhc3RcIixhKTt0aGlzLmZkPXRoaXMuSmE9dGhpcy53YT10aGlzLmlhPXRoaXMuZWE9dGhpcy5pPW51bGw7dGhpcy5TZT0hMDt0aGlzLnc9dGhpcy5oZT10aGlzLlNiPS0xO3RoaXMucmM9dGhpcy5IYT10aGlzLkxhPTA7dGhpcy5WZT1tKFwiaW50ZXJuYWxDaGFubmVsUGFyYW1zLmJhc2VSZXRyeURlbGF5TXNcIixhKXx8NUUzO3RoaXMudmc9bShcImludGVybmFsQ2hhbm5lbFBhcmFtcy5yZXRyeURlbGF5U2VlZE1zXCIsYSl8fDFFNDt0aGlzLm5mPW0oXCJpbnRlcm5hbENoYW5uZWxQYXJhbXMuZm9yd2FyZENoYW5uZWxNYXhSZXRyaWVzXCIsXG5hKXx8Mjt0aGlzLk9kPW0oXCJpbnRlcm5hbENoYW5uZWxQYXJhbXMuZm9yd2FyZENoYW5uZWxSZXF1ZXN0VGltZW91dE1zXCIsYSl8fDJFNDt0aGlzLlhhPWEmJmEub2h8fHZvaWQgMDt0aGlzLkRiPXZvaWQgMDt0aGlzLlJhPTA7dGhpcy5nYz1hJiZhLnN1cHBvcnRzQ3Jvc3NEb21haW5YaHJ8fCExO3RoaXMucmE9XCJcIjt0aGlzLkc9bmV3IE1jKGEmJmEuY29uY3VycmVudFJlcXVlc3RMaW1pdCk7dGhpcy5rYz1uZXcgUGM7dGhpcy50YT1hJiZ2b2lkIDAhPT1hLmJhY2tncm91bmRDaGFubmVsVGVzdD9hLmJhY2tncm91bmRDaGFubmVsVGVzdDohMDsodGhpcy5OZD1hJiZhLmZhc3RIYW5kc2hha2V8fCExKSYmIXRoaXMudGEmJih0aGlzLmEuVChcIkZvcmNlIGJhY2tncm91bmRDaGFubmVsVGVzdCB3aGVuIGZhc3RIYW5kc2hha2UgaXMgZW5hYmxlZC5cIiksIHRoaXMudGE9ITApO2EmJmEuSWQmJnRoaXMuYS5JZCgpO31lPSRjLnByb3RvdHlwZTtlLnRjPTg7ZS5nPTE7XG5lLmNvbm5lY3Q9ZnVuY3Rpb24oYSxiLGMsZCxmKXt0aGlzLmEuZGVidWcoXCJjb25uZWN0KClcIik7TygwKTt0aGlzLks9Yjt0aGlzLmdiPWN8fHt9O2QmJnZvaWQgMCE9PWYmJih0aGlzLmdiLk9TSUQ9ZCwgdGhpcy5nYi5PQUlEPWYpO3RoaXMudGEmJih0aGlzLmEuZGVidWcoXCJjb25uZWN0KCkgYnlwYXNzZWQgY2hhbm5lbC10ZXN0LlwiKSwgdGhpcy5JYi4kZD1bXSwgdGhpcy5JYi5vZD0hMSk7dGhpcy5iZihhKTt9O2UuZGlzY29ubmVjdD1mdW5jdGlvbigpe3RoaXMuYS5kZWJ1ZyhcImRpc2Nvbm5lY3QoKVwiKTt0aGlzLnFkKCk7aWYoMz09dGhpcy5nKXt2YXIgYT10aGlzLlliKyssYj10aGlzLmhiLmNsb25lKCk7Yi5sKFwiU0lEXCIsdGhpcy5yYSk7Yi5sKFwiUklEXCIsYSk7Yi5sKFwiVFlQRVwiLFwidGVybWluYXRlXCIpO3RoaXMuWWEoYik7KG5ldyBSKHRoaXMsdGhpcy5hLHRoaXMucmEsYSx2b2lkIDApKS55ZyhiKTt9dGhpcy5xZSgpO307XG5lLmJmPWZ1bmN0aW9uKGEpe3RoaXMuYS5kZWJ1ZyhcImNvbm5lY3RUZXN0XygpXCIpO3RoaXMuSmE9bmV3IEhjKHRoaXMsdGhpcy5hKTtudWxsPT09dGhpcy5OJiZ0aGlzLkphLmdhKHRoaXMuQSk7dmFyIGI9YTt0aGlzLk4mJnRoaXMuQSYmKGI9WmMoYSx0aGlzLk4sdGhpcy5BKSk7dGhpcy5KYS5jb25uZWN0KGIpO307ZS5hZj1mdW5jdGlvbigpe3RoaXMuYS5kZWJ1ZyhcImNvbm5lY3RDaGFubmVsXygpXCIpO3RoaXMuaGI9dGhpcy5TZCh0aGlzLkspO3RoaXMuRGMoKTt9O2UucWQ9ZnVuY3Rpb24oKXt0aGlzLkphJiYodGhpcy5KYS5hYm9ydCgpLCB0aGlzLkphPW51bGwpO3RoaXMudSYmKHRoaXMudS5jYW5jZWwoKSwgdGhpcy51PW51bGwpO3RoaXMuaWEmJihoLmNsZWFyVGltZW91dCh0aGlzLmlhKSwgdGhpcy5pYT1udWxsKTt0aGlzLkhiKCk7dGhpcy5HLmNhbmNlbCgpO3RoaXMuZWEmJihoLmNsZWFyVGltZW91dCh0aGlzLmVhKSwgdGhpcy5lYT1udWxsKTt9O1xuZS5nYT1mdW5jdGlvbihhKXt0aGlzLkE9YTt9O2UuRWc9ZnVuY3Rpb24oYSl7dGhpcy5SYj1hO307ZS5DZz1mdW5jdGlvbihhKXt0aGlzLk49YTt9O2UuRGc9ZnVuY3Rpb24oYSl7dGhpcy5hYT1hO307ZS5GZT1mdW5jdGlvbihhKXt0aGlzLktjPWE7fTtlLkhlPWZ1bmN0aW9uKGEpe3RoaXMuUmE9YTt9O2UuSGc9ZnVuY3Rpb24oKXt0aGlzLmdjPSEwO307ZS5FZT1mdW5jdGlvbihhKXt0aGlzLmk9YTt9O2UuTmY9ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5mZH07ZS5aYz1mdW5jdGlvbihhKXsxRTM9PXRoaXMuTS5sZW5ndGgmJnRoaXMuYS5jYShmdW5jdGlvbigpe3JldHVyblwiQWxyZWFkeSBoYXZlIDEwMDAgcXVldWVkIG1hcHMgdXBvbiBxdWV1ZWluZyBcIit1YihhKX0pO3RoaXMuTS5wdXNoKG5ldyBMYyh0aGlzLmFnKyssYSkpOzM9PXRoaXMuZyYmdGhpcy5EYygpO307ZS5xZj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmtmPzA6dGhpcy5uZn07ZS5kZT1mdW5jdGlvbigpe3JldHVybiAwPT10aGlzLmd9O1xuZS5nZXRTdGF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmd9O2UuRGM9ZnVuY3Rpb24oKXt0aGlzLkcuZWUoKXx8dGhpcy5lYXx8KHRoaXMuZWE9UCh1KHRoaXMud2UsdGhpcyksMCksIHRoaXMuTGE9MCk7fTtlLllmPWZ1bmN0aW9uKGEpe2lmKHRoaXMuRy54ZigpPj10aGlzLkcuWGItKHRoaXMuZWE/MTowKSlyZXR1cm4gdGhpcy5hLmNhKFwiVW5leHBlY3RlZCByZXRyeSByZXF1ZXN0IGlzIHNjaGVkdWxlZC5cIiksICExO2lmKHRoaXMuZWEpcmV0dXJuIHRoaXMuYS5kZWJ1ZyhcIlVzZSB0aGUgcmV0cnkgcmVxdWVzdCB0aGF0IGlzIGFscmVhZHkgc2NoZWR1bGVkLlwiKSwgdGhpcy5NPWEubGEoKS5jb25jYXQodGhpcy5NKSwgITA7aWYoMT09dGhpcy5nfHwyPT10aGlzLmd8fHRoaXMuTGE+PXRoaXMucWYoKSlyZXR1cm4hMTt0aGlzLmEuZGVidWcoXCJHb2luZyB0byByZXRyeSBQT1NUXCIpO3RoaXMuZWE9UCh1KHRoaXMud2UsdGhpcyxhKSx0aGlzLlhkKHRoaXMuTGEpKTt0aGlzLkxhKys7cmV0dXJuITB9O1xuZS53ZT1mdW5jdGlvbihhKXt0aGlzLmVhPW51bGw7dGhpcy5NZyhhKTt9O2UuTWc9ZnVuY3Rpb24oYSl7dGhpcy5hLmRlYnVnKFwic3RhcnRGb3J3YXJkQ2hhbm5lbF9cIik7MT09dGhpcy5nP2E/dGhpcy5hLmNhKFwiTm90IHN1cHBvc2VkIHRvIHJldHJ5IHRoZSBvcGVuXCIpOih0aGlzLmlnKCksIHRoaXMuZz0yKTozPT10aGlzLmcmJihhP3RoaXMubGUoYSk6MD09dGhpcy5NLmxlbmd0aD90aGlzLmEuZGVidWcoXCJzdGFydEZvcndhcmRDaGFubmVsXyByZXR1cm5lZDogbm90aGluZyB0byBzZW5kXCIpOnRoaXMuRy5lZSgpP3RoaXMuYS5jYShcInN0YXJ0Rm9yd2FyZENoYW5uZWxfIHJldHVybmVkOiBjb25uZWN0aW9uIGFscmVhZHkgaW4gcHJvZ3Jlc3NcIik6KHRoaXMubGUoKSwgdGhpcy5hLmRlYnVnKFwic3RhcnRGb3J3YXJkQ2hhbm5lbF8gZmluaXNoZWQsIHNlbnQgcmVxdWVzdFwiKSkpO307XG5lLmlnPWZ1bmN0aW9uKCl7dGhpcy5hLmRlYnVnKFwib3Blbl8oKVwiKTt0aGlzLlliPU1hdGguZmxvb3IoMUU1Kk1hdGgucmFuZG9tKCkpO3ZhciBhPXRoaXMuWWIrKyxiPW5ldyBSKHRoaXMsdGhpcy5hLFwiXCIsYSx2b2lkIDApLGM9dGhpcy5BO3RoaXMuUmImJihjPyhjPURhKGMpLCBGYShjLHRoaXMuUmIpKTpjPXRoaXMuUmIpO251bGw9PT10aGlzLk4mJmIuZ2EoYyk7dmFyIGQ9dGhpcy5IZChiKSxmPXRoaXMuaGIuY2xvbmUoKTtmLmwoXCJSSURcIixhKTswPHRoaXMuQmQmJmYubChcIkNWRVJcIix0aGlzLkJkKTt0aGlzLnRhJiZ0aGlzLmFhJiZmLmwoXCJYLUhUVFAtU2Vzc2lvbi1JZFwiLHRoaXMuYWEpO3RoaXMuWWEoZik7dGhpcy5OJiZjJiZaYyhmLHRoaXMuTixjKTt0aGlzLkcub2MoYik7dGhpcy5OZD8oZi5sKFwiJHJlcVwiLGQpLCBmLmwoXCJTSURcIixcIm51bGxcIiksIGIuQWcoKSwgYi5rZChmLG51bGwpKTpiLmtkKGYsZCk7fTtcbmUubGU9ZnVuY3Rpb24oYSl7dmFyIGI9YT9hLlI6dGhpcy5ZYisrO3ZhciBjPXRoaXMuaGIuY2xvbmUoKTtjLmwoXCJTSURcIix0aGlzLnJhKTtjLmwoXCJSSURcIixiKTtjLmwoXCJBSURcIix0aGlzLlNiKTt0aGlzLllhKGMpO3RoaXMuTiYmdGhpcy5BJiZaYyhjLHRoaXMuTix0aGlzLkEpO2I9bmV3IFIodGhpcyx0aGlzLmEsdGhpcy5yYSxiLHRoaXMuTGErMSk7bnVsbD09PXRoaXMuTiYmYi5nYSh0aGlzLkEpO2EmJnRoaXMuc2coYSk7YT10aGlzLkhkKGIpO2Iuc2V0VGltZW91dChNYXRoLnJvdW5kKC41KnRoaXMuT2QpK01hdGgucm91bmQoLjUqdGhpcy5PZCpNYXRoLnJhbmRvbSgpKSk7dGhpcy5HLm9jKGIpO2Iua2QoYyxhKTt9O2UuWWE9ZnVuY3Rpb24oYSl7dGhpcy5pJiZvYyh7fSxmdW5jdGlvbihiLGMpe2EubChjLGIpO30pO307XG5lLkhkPWZ1bmN0aW9uKGEpe3ZhciBiPU1hdGgubWluKHRoaXMuTS5sZW5ndGgsMUUzKSxjPXRoaXMuaT91KHRoaXMuaS5VZSx0aGlzLmksdGhpcyk6bnVsbDtjPXRoaXMua2MuamYodGhpcy5NLGIsYyk7YS5HZyh0aGlzLk0uc3BsaWNlKDAsYikpO3JldHVybiBjfTtlLnNnPWZ1bmN0aW9uKGEpe3RoaXMuTT1hLmxhKCkuY29uY2F0KHRoaXMuTSk7fTtlLktkPWZ1bmN0aW9uKCl7aWYoIXRoaXMudSYmIXRoaXMuaWEpe3RoaXMucmM9MTt2YXIgYT10aGlzLnZlO0JifHxDYigpO0VifHwoQmIoKSwgRWI9ITApO0ZiLmFkZChhLHRoaXMpO3RoaXMuSGE9MDt9fTtcbmUuUWM9ZnVuY3Rpb24oKXtpZih0aGlzLnV8fHRoaXMuaWEpcmV0dXJuIHRoaXMuYS5jYShcIlJlcXVlc3QgYWxyZWFkeSBpbiBwcm9ncmVzc1wiKSwgITE7aWYoMzw9dGhpcy5IYSlyZXR1cm4hMTt0aGlzLmEuZGVidWcoXCJHb2luZyB0byByZXRyeSBHRVRcIik7dGhpcy5yYysrO3RoaXMuaWE9UCh1KHRoaXMudmUsdGhpcyksdGhpcy5YZCh0aGlzLkhhKSk7dGhpcy5IYSsrO3JldHVybiEwfTtlLnZlPWZ1bmN0aW9uKCl7dGhpcy5pYT1udWxsO3RoaXMuS2coKTt9O1xuZS5LZz1mdW5jdGlvbigpe3RoaXMuYS5kZWJ1ZyhcIkNyZWF0aW5nIG5ldyBIdHRwUmVxdWVzdFwiKTt0aGlzLnU9bmV3IFIodGhpcyx0aGlzLmEsdGhpcy5yYSxcInJwY1wiLHRoaXMucmMpO251bGw9PT10aGlzLk4mJnRoaXMudS5nYSh0aGlzLkEpO3RoaXMudS5IZSh0aGlzLlJhKTt2YXIgYT10aGlzLm1kLmNsb25lKCk7YS5sKFwiUklEXCIsXCJycGNcIik7YS5sKFwiU0lEXCIsdGhpcy5yYSk7YS5sKFwiQ0lcIix0aGlzLmZkP1wiMFwiOlwiMVwiKTthLmwoXCJBSURcIix0aGlzLlNiKTt0aGlzLllhKGEpO2EubChcIlRZUEVcIixcInhtbGh0dHBcIik7dGhpcy5OJiZ0aGlzLkEmJlpjKGEsdGhpcy5OLHRoaXMuQSk7dGhpcy5EYiYmdGhpcy51LnNldFRpbWVvdXQodGhpcy5EYik7dGhpcy51LmpkKGEsITAsdGhpcy5uYSk7dGhpcy5hLmRlYnVnKFwiTmV3IFJlcXVlc3QgY3JlYXRlZFwiKTt9O1xuZS51Yj1mdW5jdGlvbihhLGIpe3RoaXMuYS5kZWJ1ZyhcIlRlc3QgQ29ubmVjdGlvbiBGaW5pc2hlZFwiKTt2YXIgYz1hLkFkO2MmJnRoaXMuRy5sZChjKTt0aGlzLmZkPXRoaXMuU2UmJmI7dGhpcy53PWEudzt0aGlzLmFmKCk7fTtlLmRkPWZ1bmN0aW9uKGEpe3RoaXMuYS5kZWJ1ZyhcIlRlc3QgQ29ubmVjdGlvbiBGYWlsZWRcIik7dGhpcy53PWEudzt0aGlzLnNhKDIpO307XG5lLnVlPWZ1bmN0aW9uKGEsYil7aWYoMCE9dGhpcy5nJiYodGhpcy51PT1hfHx0aGlzLkcuSmMoYSkpKWlmKHRoaXMudz1hLncsICFhLmxiJiZ0aGlzLkcuSmMoYSkmJjM9PXRoaXMuZyl7dHJ5e3ZhciBjPXRoaXMua2MuemMoYik7fWNhdGNoKGQpe2M9bnVsbDt9bihjKSYmMz09Yy5sZW5ndGg/dGhpcy5DZihjLGEpOih0aGlzLmEuZGVidWcoXCJCYWQgUE9TVCByZXNwb25zZSBkYXRhIHJldHVybmVkXCIpLCB0aGlzLnNhKDExKSk7fWVsc2UoYS5sYnx8dGhpcy51PT1hKSYmdGhpcy5IYigpLCB2YShiKXx8KGM9dGhpcy5rYy56YyhiKSwgdGhpcy5kZyhjLGEpKTt9O1xuZS5DZj1mdW5jdGlvbihhLGIpezA9PWFbMF0/dGhpcy5CZihiKToodGhpcy5oZT1hWzFdLCBiPXRoaXMuaGUtdGhpcy5TYiwgMDxiJiYoYT1hWzJdLCB0aGlzLmEuZGVidWcoYStcIiBieXRlcyAoaW4gXCIrYitcIiBhcnJheXMpIGFyZSBvdXRzdGFuZGluZyBvbiB0aGUgQmFja0NoYW5uZWxcIiksIHRoaXMuSmcoYSkmJiF0aGlzLndhJiYodGhpcy53YT1QKHUodGhpcy5iZyx0aGlzKSw2RTMpKSkpO307XG5lLkJmPWZ1bmN0aW9uKGEpe3RoaXMuYS5kZWJ1ZyhcIlNlcnZlciBjbGFpbXMgb3VyIGJhY2tjaGFubmVsIGlzIG1pc3NpbmcuXCIpO2lmKHRoaXMuaWEpdGhpcy5hLmRlYnVnKFwiQnV0IHdlIGFyZSBjdXJyZW50bHkgc3RhcnRpbmcgdGhlIHJlcXVlc3QuXCIpO2Vsc2V7aWYodGhpcy51KWlmKHRoaXMudS5xYiszRTM8YS5xYil0aGlzLkhiKCksIHRoaXMudS5jYW5jZWwoKSwgdGhpcy51PW51bGw7ZWxzZSByZXR1cm47ZWxzZSB0aGlzLmEuVChcIldlIGRvIG5vdCBoYXZlIGEgQmFja0NoYW5uZWwgZXN0YWJsaXNoZWRcIik7dGhpcy5RYygpO08oMTgpO319O2UuSmc9ZnVuY3Rpb24oYSl7cmV0dXJuIDM3NTAwPmEmJiF0aGlzLk5mKCkmJjA9PXRoaXMuSGF9O2UuJGE9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuVGU/dGhpcy5pP3RoaXMuaS4kYShhKTphOm51bGx9O1xuZS5iZz1mdW5jdGlvbigpe251bGwhPXRoaXMud2EmJih0aGlzLndhPW51bGwsIHRoaXMudS5jYW5jZWwoKSwgdGhpcy51PW51bGwsIHRoaXMuUWMoKSwgTygxOSkpO307ZS5IYj1mdW5jdGlvbigpe251bGwhPXRoaXMud2EmJihoLmNsZWFyVGltZW91dCh0aGlzLndhKSwgdGhpcy53YT1udWxsKTt9O1xuZS5UYz1mdW5jdGlvbihhKXt0aGlzLmEuZGVidWcoXCJSZXF1ZXN0IGNvbXBsZXRlXCIpO3ZhciBiPW51bGw7aWYodGhpcy51PT1hKXt0aGlzLkhiKCk7dGhpcy51PW51bGw7dmFyIGM9Mjt9ZWxzZSBpZih0aGlzLkcuSmMoYSkpYj1hLmxhKCksIHRoaXMuRy56ZShhKSwgYz0xO2Vsc2UgcmV0dXJuO3RoaXMudz1hLnc7aWYoMCE9dGhpcy5nKWlmKGEuUykxPT1jPyhhYyhhLkRhP2EuRGEubGVuZ3RoOjAsdygpLWEucWIsdGhpcy5MYSksIHRoaXMuRGMoKSk6dGhpcy5LZCgpO2Vsc2V7dmFyIGQ9YS5IYygpO2lmKDM9PWR8fDA9PWQmJjA8dGhpcy53KXRoaXMuYS5kZWJ1ZyhcIk5vdCByZXRyeWluZyBkdWUgdG8gZXJyb3IgdHlwZVwiKTtlbHNle3ZhciBmPXRoaXM7dGhpcy5hLmRlYnVnKGZ1bmN0aW9uKCl7cmV0dXJuXCJNYXliZSByZXRyeWluZywgbGFzdCBlcnJvcjogXCIra2MoZCxmLncpfSk7aWYoMT09YyYmdGhpcy5ZZihhKXx8Mj09YyYmdGhpcy5RYygpKXJldHVybjt0aGlzLmEuZGVidWcoXCJFeGNlZWRlZCBtYXggbnVtYmVyIG9mIHJldHJpZXNcIik7fWImJlxuMDxiLmxlbmd0aCYmdGhpcy5HLlJlKGIpO3RoaXMuYS5kZWJ1ZyhcIkVycm9yOiBIVFRQIHJlcXVlc3QgZmFpbGVkXCIpO3N3aXRjaChkKXtjYXNlIDE6dGhpcy5zYSg1KTticmVhaztjYXNlIDQ6dGhpcy5zYSgxMCk7YnJlYWs7Y2FzZSAzOnRoaXMuc2EoNik7YnJlYWs7ZGVmYXVsdDp0aGlzLnNhKDIpO319fTtlLlhkPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuVmUrTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnRoaXMudmcpO3RoaXMuQmEoKXx8KHRoaXMuYS5kZWJ1ZyhcIkluYWN0aXZlIGNoYW5uZWxcIiksIGIqPTIpO3JldHVybiBiKmF9O2UucGM9ZnVuY3Rpb24oYSl7aWYodGhpcy50YSYmKGE9YS5oKSl7dmFyIGI9YS5rYihcIlgtQ2xpZW50LVdpcmUtUHJvdG9jb2xcIik7YiYmdGhpcy5HLmxkKGIpO3RoaXMuYWEmJigoYT1hLmtiKFwiWC1IVFRQLVNlc3Npb24tSWRcIikpPyh0aGlzLkZlKGEpLCB0aGlzLmhiLmwodGhpcy5hYSxhKSk6dGhpcy5hLlQoXCJNaXNzaW5nIFhfSFRUUF9TRVNTSU9OX0lEIGluIHRoZSBoYW5kc2hha2UgcmVzcG9uc2VcIikpO319O1xuZS5kZz1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz10aGlzLmkmJnRoaXMuaS5zYz9bXTpudWxsLGQ9MDtkPGEubGVuZ3RoO2QrKyl7dmFyIGY9YVtkXTt0aGlzLlNiPWZbMF07Zj1mWzFdO2lmKDI9PXRoaXMuZylpZihcImNcIj09ZlswXSl7dGhpcy5yYT1mWzFdO3RoaXMubmE9dGhpcy4kYShmWzJdKTt2YXIgZz1mWzNdO251bGwhPWcmJih0aGlzLnRjPWcsIHRoaXMuYS5pbmZvKFwiVkVSPVwiK3RoaXMudGMpKTtnPWZbNF07bnVsbCE9ZyYmKHRoaXMuRGU9ZywgdGhpcy5hLmluZm8oXCJTVkVSPVwiK3RoaXMuRGUpKTtmPWZbNV07bnVsbCE9ZiYmXCJudW1iZXJcIj09dHlwZW9mIGYmJjA8ZiYmKHRoaXMuRGI9Zio9MS41LCB0aGlzLmEuaW5mbyhcImJhY2tDaGFubmVsUmVxdWVzdFRpbWVvdXRNc189XCIrZikpO3RoaXMucGMoYik7dGhpcy5nPTM7dGhpcy5pJiZ0aGlzLmkud2QoKTt0aGlzLkxnKGIpO31lbHNlXCJzdG9wXCIhPWZbMF0mJlwiY2xvc2VcIiE9ZlswXXx8dGhpcy5zYSg3KTtlbHNlIDM9PXRoaXMuZyYmXG4oXCJzdG9wXCI9PWZbMF18fFwiY2xvc2VcIj09ZlswXT8oYyYmMCE9Yy5sZW5ndGgmJih0aGlzLmkuc2ModGhpcyxjKSwgYy5sZW5ndGg9MCksIFwic3RvcFwiPT1mWzBdP3RoaXMuc2EoNyk6dGhpcy5kaXNjb25uZWN0KCkpOlwibm9vcFwiIT1mWzBdJiYoYz9jLnB1c2goZik6dGhpcy5pJiZ0aGlzLmkudWQoZikpLCB0aGlzLkhhPTApO31jJiYwIT1jLmxlbmd0aCYmdGhpcy5pLnNjKHRoaXMsYyk7fTtlLkxnPWZ1bmN0aW9uKGEpe3RoaXMubWQ9dGhpcy5QZCh0aGlzLm5hLHRoaXMuSyk7YS5sYj8odGhpcy5hLmRlYnVnKFwiVXBncmFkZSB0aGUgaGFuZHNoYWtlIHJlcXVlc3QgdG8gYSBiYWNrY2hhbm5lbC5cIiksIHRoaXMuRy56ZShhKSwgYS50Zyh0aGlzLkRiKSwgdGhpcy51PWEpOnRoaXMuS2QoKTt9O1xuZS5zYT1mdW5jdGlvbihhKXt0aGlzLmEuaW5mbyhcIkVycm9yIGNvZGUgXCIrYSk7aWYoMj09YSl7dmFyIGI9bnVsbDt0aGlzLmkmJihiPW51bGwpO3ZhciBjPXUodGhpcy5QZyx0aGlzKTtifHwoYj1uZXcgVShcIi8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2NsZWFyZG90LmdpZlwiKSwgaC5sb2NhdGlvbiYmXCJodHRwXCI9PWgubG9jYXRpb24ucHJvdG9jb2x8fGIudGIoXCJodHRwc1wiKSwgYi5VYigpKTtRYyhiLnRvU3RyaW5nKCksYyk7fWVsc2UgTygyKTt0aGlzLmNnKGEpO307ZS5QZz1mdW5jdGlvbihhKXthPyh0aGlzLmEuaW5mbyhcIlN1Y2Nlc3NmdWxseSBwaW5nZWQgZ29vZ2xlLmNvbVwiKSwgTygyKSk6KHRoaXMuYS5pbmZvKFwiRmFpbGVkIHRvIHBpbmcgZ29vZ2xlLmNvbVwiKSwgTygxKSk7fTtlLmNnPWZ1bmN0aW9uKGEpe3RoaXMuYS5kZWJ1ZyhcIkh0dHBDaGFubmVsOiBlcnJvciAtIFwiK2EpO3RoaXMuZz0wO3RoaXMuaSYmdGhpcy5pLnRkKGEpO3RoaXMucWUoKTt0aGlzLnFkKCk7fTtcbmUucWU9ZnVuY3Rpb24oKXt0aGlzLmc9MDt0aGlzLnc9LTE7aWYodGhpcy5pKXt2YXIgYT10aGlzLkcubGEoKTtpZigwIT1hLmxlbmd0aHx8MCE9dGhpcy5NLmxlbmd0aCl7dmFyIGI9dGhpczt0aGlzLmEuZGVidWcoZnVuY3Rpb24oKXtyZXR1cm5cIk51bWJlciBvZiB1bmRlbGl2ZXJlZCBtYXBzLCBwZW5kaW5nOiBcIithLmxlbmd0aCtcIiwgb3V0Z29pbmc6IFwiK2IuTS5sZW5ndGh9KTt0aGlzLkcuJGUoKTt1YSh0aGlzLk0pO3RoaXMuTS5sZW5ndGg9MDt9dGhpcy5pLnNkKCk7fX07ZS5TZD1mdW5jdGlvbihhKXthPXRoaXMuQ2QobnVsbCxhKTt0aGlzLmEuZGVidWcoXCJHZXRGb3J3YXJkQ2hhbm5lbFVyaTogXCIrYSk7cmV0dXJuIGF9O2UuUGQ9ZnVuY3Rpb24oYSxiKXthPXRoaXMuQ2QodGhpcy5mYygpP2E6bnVsbCxiKTt0aGlzLmEuZGVidWcoXCJHZXRCYWNrQ2hhbm5lbFVyaTogXCIrYSk7cmV0dXJuIGF9O1xuZS5DZD1mdW5jdGlvbihhLGIpe3ZhciBjPUFjKGIpO2lmKFwiXCIhPWMueGEpYSYmYy5yYihhK1wiLlwiK2MueGEpLCBjLnNiKGMuQ2EpO2Vsc2V7dmFyIGQ9aC5sb2NhdGlvbjtjPUJjKGQucHJvdG9jb2wsYT9hK1wiLlwiK2QuaG9zdG5hbWU6ZC5ob3N0bmFtZSwrZC5wb3J0LGIpO310aGlzLmdiJiZBYSh0aGlzLmdiLGZ1bmN0aW9uKGEsYil7Yy5sKGIsYSk7fSk7YT10aGlzLmFhO2I9dGhpcy5LYzthJiZiJiZjLmwoYSxiKTtjLmwoXCJWRVJcIix0aGlzLnRjKTt0aGlzLllhKGMpO3JldHVybiBjfTtlLkpiPWZ1bmN0aW9uKGEpe2lmKGEmJiF0aGlzLmdjKXRocm93IEVycm9yKFwiQ2FuJ3QgY3JlYXRlIHNlY29uZGFyeSBkb21haW4gY2FwYWJsZSBYaHJJbyBvYmplY3QuXCIpO2E9bmV3IFYodGhpcy5YYSk7YS5KZSh0aGlzLmdjKTtyZXR1cm4gYX07ZS5CYT1mdW5jdGlvbigpe3JldHVybiEhdGhpcy5pJiZ0aGlzLmkuQmEoKX07ZS5mYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdjfTtmdW5jdGlvbiBhZCgpe31lPWFkLnByb3RvdHlwZTtlLnNjPW51bGw7ZS53ZD1mdW5jdGlvbigpe307ZS51ZD1mdW5jdGlvbigpe307ZS50ZD1mdW5jdGlvbigpe307ZS5zZD1mdW5jdGlvbigpe307ZS5CYT1mdW5jdGlvbigpe3JldHVybiEwfTtlLlVlPWZ1bmN0aW9uKCl7fTtlLiRhPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtmdW5jdGlvbiBiZChhKXtmb3IodmFyIGI9YXJndW1lbnRzWzBdLGM9MTtjPGFyZ3VtZW50cy5sZW5ndGg7YysrKXt2YXIgZD1hcmd1bWVudHNbY107aWYoMD09ZC5sYXN0SW5kZXhPZihcIi9cIiwwKSliPWQ7ZWxzZXt2YXIgZjsoZj1cIlwiPT1iKXx8KGY9Yi5sZW5ndGgtMSwgZj0wPD1mJiZiLmluZGV4T2YoXCIvXCIsZik9PWYpO2I9Zj9iK2Q6YisoXCIvXCIrZCk7fX1yZXR1cm4gYn1mdW5jdGlvbiBjZCgpe2lmKEMmJiEoMTA8PU51bWJlcihVYSkpKXRocm93IEVycm9yKFwiRW52aXJvbm1lbnRhbCBlcnJvcjogbm8gYXZhaWxhYmxlIHRyYW5zcG9ydC5cIik7fWNkLnByb3RvdHlwZS5jZj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVyhhLGIpfTtcbmZ1bmN0aW9uIFcoYSxiKXtILmNhbGwodGhpcyk7dGhpcy5iPW5ldyAkYyhiKTt0aGlzLnliPWE7dGhpcy5RZz1iJiZiLnRlc3RVcmw/Yi50ZXN0VXJsOmJkKHRoaXMueWIsXCJ0ZXN0XCIpO3RoaXMucz1WYihcImdvb2cubGFicy5uZXQud2ViQ2hhbm5lbC5XZWJDaGFubmVsQmFzZVRyYW5zcG9ydFwiKTt0aGlzLlJjPWImJmIubWVzc2FnZVVybFBhcmFtc3x8bnVsbDthPWImJmIubWVzc2FnZUhlYWRlcnN8fG51bGw7YiYmYi5jbGllbnRQcm90b2NvbEhlYWRlclJlcXVpcmVkJiYoYT9hW1wiWC1DbGllbnQtUHJvdG9jb2xcIl09XCJ3ZWJjaGFubmVsXCI6YT17XCJYLUNsaWVudC1Qcm90b2NvbFwiOlwid2ViY2hhbm5lbFwifSk7dGhpcy5iLmdhKGEpO2E9YiYmYi5pbml0TWVzc2FnZUhlYWRlcnN8fG51bGw7YiYmYi5tZXNzYWdlQ29udGVudFR5cGUmJihhP2FbXCJYLVdlYkNoYW5uZWwtQ29udGVudC1UeXBlXCJdPWIubWVzc2FnZUNvbnRlbnRUeXBlOmE9e1wiWC1XZWJDaGFubmVsLUNvbnRlbnQtVHlwZVwiOmIubWVzc2FnZUNvbnRlbnRUeXBlfSk7XG5iJiZiLnpkJiYoYT9hW1wiWC1XZWJDaGFubmVsLUNsaWVudC1Qcm9maWxlXCJdPWIuemQ6YT17XCJYLVdlYkNoYW5uZWwtQ2xpZW50LVByb2ZpbGVcIjpiLnpkfSk7dGhpcy5iLkVnKGEpOyhhPWImJmIuaHR0cEhlYWRlcnNPdmVyd3JpdGVQYXJhbSkmJiF2YShhKSYmdGhpcy5iLkNnKGEpO3RoaXMuT2c9YiYmYi5zdXBwb3J0c0Nyb3NzRG9tYWluWGhyfHwhMTt0aGlzLnpnPWImJmIuc2VuZFJhd0pzb258fCExOyhiPWImJmIuaHR0cFNlc3Npb25JZFBhcmFtKSYmIXZhKGIpJiYodGhpcy5iLkRnKGIpLCBhPXRoaXMuUmMsIG51bGwhPT1hJiZiIGluIGEmJihhPXRoaXMuUmMsIGIgaW4gYSYmZGVsZXRlIGFbYl0sIChhPXRoaXMucykmJmEuVChcIklnbm9yZSBodHRwU2Vzc2lvbklkUGFyYW0gYWxzbyBzcGVjaWZpZWQgd2l0aCBtZXNzYWdlVXJsUGFyYW1zOiBcIitiLHZvaWQgMCkpKTt0aGlzLnZkPW5ldyBYKHRoaXMpO314KFcsSCk7ZT1XLnByb3RvdHlwZTtcbmUuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyxkKXtXLkwuYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsYSxiLGMsZCk7fTtlLnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oYSxiLGMsZCl7Vy5MLnJlbW92ZUV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLGEsYixjLGQpO307ZS5vcGVuPWZ1bmN0aW9uKCl7dGhpcy5iLkVlKHRoaXMudmQpO3RoaXMuT2cmJnRoaXMuYi5IZygpO3RoaXMuYi5jb25uZWN0KHRoaXMuUWcsdGhpcy55Yix0aGlzLlJjfHx2b2lkIDApO307ZS5jbG9zZT1mdW5jdGlvbigpe3RoaXMuYi5kaXNjb25uZWN0KCk7fTtlLnNlbmQ9ZnVuY3Rpb24oYSl7aWYobChhKSl7dmFyIGI9e307Yi5fX2RhdGFfXz1hO3RoaXMuYi5aYyhiKTt9ZWxzZSB0aGlzLnpnPyhiPXt9LCBiLl9fZGF0YV9fPXViKGEpLCB0aGlzLmIuWmMoYikpOnRoaXMuYi5aYyhhKTt9O1xuZS5GPWZ1bmN0aW9uKCl7dGhpcy5iLkVlKG51bGwpO2RlbGV0ZSB0aGlzLnZkO3RoaXMuYi5kaXNjb25uZWN0KCk7ZGVsZXRlIHRoaXMuYjtXLkwuRi5jYWxsKHRoaXMpO307ZnVuY3Rpb24gZGQoYSl7ZmMuY2FsbCh0aGlzKTt2YXIgYj1hLl9fc21fXztpZihiKXthOntmb3IodmFyIGMgaW4gYil7YT1jO2JyZWFrIGF9YT12b2lkIDA7fWlmKHRoaXMubmU9YSlhPXRoaXMubmUsIGI9bnVsbCE9PWImJmEgaW4gYj9iW2FdOnZvaWQgMDt0aGlzLmRhdGE9Yjt9ZWxzZSB0aGlzLmRhdGE9YTt9eChkZCxmYyk7ZnVuY3Rpb24gZWQoYSl7Z2MuY2FsbCh0aGlzKTt0aGlzLnN0YXR1cz0xO3RoaXMuZXJyb3JDb2RlPWE7fXgoZWQsZ2MpO2Z1bmN0aW9uIFgoYSl7dGhpcy5iPWE7fXgoWCxhZCk7WC5wcm90b3R5cGUud2Q9ZnVuY3Rpb24oKXtXYih0aGlzLmIucyxcIldlYkNoYW5uZWwgb3BlbmVkIG9uIFwiK3RoaXMuYi55Yik7dGhpcy5iLmRpc3BhdGNoRXZlbnQoXCJhXCIpO307WC5wcm90b3R5cGUudWQ9ZnVuY3Rpb24oYSl7dGhpcy5iLmRpc3BhdGNoRXZlbnQobmV3IGRkKGEpKTt9O1xuWC5wcm90b3R5cGUudGQ9ZnVuY3Rpb24oYSl7V2IodGhpcy5iLnMsXCJXZWJDaGFubmVsIGFib3J0ZWQgb24gXCIrdGhpcy5iLnliK1wiIGR1ZSB0byBjaGFubmVsIGVycm9yOiBcIithKTt0aGlzLmIuZGlzcGF0Y2hFdmVudChuZXcgZWQoYSkpO307WC5wcm90b3R5cGUuc2Q9ZnVuY3Rpb24oKXtXYih0aGlzLmIucyxcIldlYkNoYW5uZWwgY2xvc2VkIG9uIFwiK3RoaXMuYi55Yik7dGhpcy5iLmRpc3BhdGNoRXZlbnQoXCJiXCIpO307dmFyIGZkPXYoZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKCl7fWMucHJvdG90eXBlPWEucHJvdG90eXBlO3ZhciBkPW5ldyBjO2EuYXBwbHkoZCxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO3JldHVybiBkfSxjZCk7ZnVuY3Rpb24gZ2QoKXt0aGlzLlY9W107dGhpcy5aPVtdO31lPWdkLnByb3RvdHlwZTtlLlZmPWZ1bmN0aW9uKCl7MD09dGhpcy5WLmxlbmd0aCYmKHRoaXMuVj10aGlzLlosIHRoaXMuVi5yZXZlcnNlKCksIHRoaXMuWj1bXSk7fTtlLmVucXVldWU9ZnVuY3Rpb24oYSl7dGhpcy5aLnB1c2goYSk7fTtlLmFiPWZ1bmN0aW9uKCl7dGhpcy5WZigpO3JldHVybiB0aGlzLlYucG9wKCl9O2UuQz1mdW5jdGlvbigpe3JldHVybiB0aGlzLlYubGVuZ3RoK3RoaXMuWi5sZW5ndGh9O2UuWD1mdW5jdGlvbigpe3JldHVybiAwPT10aGlzLlYubGVuZ3RoJiYwPT10aGlzLloubGVuZ3RofTtlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5WPVtdO3RoaXMuWj1bXTt9O2UuY29udGFpbnM9ZnVuY3Rpb24oYSl7cmV0dXJuIDA8PWxhKHRoaXMuVixhKXx8MDw9bGEodGhpcy5aLGEpfTtcbmUucmVtb3ZlPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuVjt2YXIgYz1tYShiLGEpOzA8PWM/KEFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChiLGMsMSksIGI9ITApOmI9ITE7cmV0dXJuIGJ8fHNhKHRoaXMuWixhKX07ZS5IPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9dGhpcy5WLmxlbmd0aC0xOzA8PWI7LS1iKWEucHVzaCh0aGlzLlZbYl0pO3ZhciBjPXRoaXMuWi5sZW5ndGg7Zm9yKGI9MDtiPGM7KytiKWEucHVzaCh0aGlzLlpbYl0pO3JldHVybiBhfTtmdW5jdGlvbiBoZChhLGIpe3ouY2FsbCh0aGlzKTt0aGlzLm9lPWF8fDA7dGhpcy5XYj1ifHwxMDtpZih0aGlzLm9lPnRoaXMuV2IpdGhyb3cgRXJyb3IoaWQpO3RoaXMuZmE9bmV3IGdkO3RoaXMub2E9bmV3IEpjO3RoaXMuQWM9MDt0aGlzLk5jPW51bGw7dGhpcy5DYigpO314KGhkLHopO3ZhciBpZD1cIltnb29nLnN0cnVjdHMuUG9vbF0gTWluIGNhbiBub3QgYmUgZ3JlYXRlciB0aGFuIG1heFwiO2U9aGQucHJvdG90eXBlO2UuTWI9ZnVuY3Rpb24oKXt2YXIgYT13KCk7aWYoIShudWxsIT10aGlzLk5jJiZhLXRoaXMuTmM8dGhpcy5BYykpe3ZhciBiPXRoaXMucWcoKTtiJiYodGhpcy5OYz1hLCB0aGlzLm9hLmFkZChiKSk7cmV0dXJuIGJ9fTtlLm9nPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLm9hLnJlbW92ZShhKT8odGhpcy5uYyhhKSwgITApOiExfTtcbmUucWc9ZnVuY3Rpb24oKXtmb3IodmFyIGE7MDx0aGlzLlRkKCkmJihhPXRoaXMuZmEuYWIoKSwgIXRoaXMuU2MoYSkpOyl0aGlzLkNiKCk7IWEmJnRoaXMuQygpPHRoaXMuV2ImJihhPXRoaXMueGMoKSk7cmV0dXJuIGF9O2UubmM9ZnVuY3Rpb24oYSl7dGhpcy5vYS5yZW1vdmUoYSk7dGhpcy5TYyhhKSYmdGhpcy5DKCk8dGhpcy5XYj90aGlzLmZhLmVucXVldWUoYSk6dGhpcy5CYyhhKTt9O2UuQ2I9ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5mYTt0aGlzLkMoKTx0aGlzLm9lOylhLmVucXVldWUodGhpcy54YygpKTtmb3IoO3RoaXMuQygpPnRoaXMuV2ImJjA8dGhpcy5UZCgpOyl0aGlzLkJjKGEuYWIoKSk7fTtlLnhjPWZ1bmN0aW9uKCl7cmV0dXJue319O2UuQmM9ZnVuY3Rpb24oYSl7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgYS5iYilhLmJiKCk7ZWxzZSBmb3IodmFyIGIgaW4gYSlhW2JdPW51bGw7fTtcbmUuU2M9ZnVuY3Rpb24oYSl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgYS5ZZT9hLlllKCk6ITB9O2UuY29udGFpbnM9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZmEuY29udGFpbnMoYSl8fHRoaXMub2EuY29udGFpbnMoYSl9O2UuQz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZhLkMoKSt0aGlzLm9hLkMoKX07ZS5yZj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9hLkMoKX07ZS5UZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZhLkMoKX07ZS5YPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmEuWCgpJiZ0aGlzLm9hLlgoKX07ZS5GPWZ1bmN0aW9uKCl7aGQuTC5GLmNhbGwodGhpcyk7aWYoMDx0aGlzLnJmKCkpdGhyb3cgRXJyb3IoXCJbZ29vZy5zdHJ1Y3RzLlBvb2xdIE9iamVjdHMgbm90IHJlbGVhc2VkXCIpO2RlbGV0ZSB0aGlzLm9hO2Zvcih2YXIgYT10aGlzLmZhOyFhLlgoKTspdGhpcy5CYyhhLmFiKCkpO2RlbGV0ZSB0aGlzLmZhO307ZnVuY3Rpb24gamQoYSxiKXt0aGlzLmZlPWE7dGhpcy5nZD1iO31qZC5wcm90b3R5cGUuZ2V0S2V5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmV9O2pkLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgamQodGhpcy5mZSx0aGlzLmdkKX07ZnVuY3Rpb24ga2QoYSl7dGhpcy5ZPVtdO2EmJnRoaXMuTGYoYSk7fWU9a2QucHJvdG90eXBlO2UuY2U9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLlk7Yy5wdXNoKG5ldyBqZChhLGIpKTt0aGlzLiRmKGMubGVuZ3RoLTEpO307ZS5MZj1mdW5jdGlvbihhKXtpZihhIGluc3RhbmNlb2Yga2Qpe3ZhciBiPWEuVygpO2E9YS5IKCk7aWYoMD49dGhpcy5DKCkpe2Zvcih2YXIgYz10aGlzLlksZD0wO2Q8Yi5sZW5ndGg7ZCsrKWMucHVzaChuZXcgamQoYltkXSxhW2RdKSk7cmV0dXJufX1lbHNlIGI9Q2EoYSksIGE9QmEoYSk7Zm9yKGQ9MDtkPGIubGVuZ3RoO2QrKyl0aGlzLmNlKGJbZF0sYVtkXSk7fTtlLnJlbW92ZT1mdW5jdGlvbigpe3ZhciBhPXRoaXMuWSxiPWEubGVuZ3RoLGM9YVswXTtpZighKDA+PWIpKXJldHVybiAxPT1iP3JhKGEpOihhWzBdPWEucG9wKCksIHRoaXMuWmYoKSksIGMuZ2R9O1xuZS5aZj1mdW5jdGlvbigpe2Zvcih2YXIgYT0wLGI9dGhpcy5ZLGM9Yi5sZW5ndGgsZD1iW2FdO2E8Yz4+MTspe3ZhciBmPXRoaXMudGYoYSksZz10aGlzLnpmKGEpO2Y9ZzxjJiZiW2ddLmdldEtleSgpPGJbZl0uZ2V0S2V5KCk/ZzpmO2lmKGJbZl0uZ2V0S2V5KCk+ZC5nZXRLZXkoKSlicmVhaztiW2FdPWJbZl07YT1mO31iW2FdPWQ7fTtlLiRmPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLlksYz1iW2FdOzA8YTspe3ZhciBkPXRoaXMud2YoYSk7aWYoYltkXS5nZXRLZXkoKT5jLmdldEtleSgpKWJbYV09YltkXSwgYT1kO2Vsc2UgYnJlYWt9YlthXT1jO307ZS50Zj1mdW5jdGlvbihhKXtyZXR1cm4gMiphKzF9O2UuemY9ZnVuY3Rpb24oYSl7cmV0dXJuIDIqYSsyfTtlLndmPWZ1bmN0aW9uKGEpe3JldHVybiBhLTE+PjF9O2UuSD1mdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLlksYj1bXSxjPWEubGVuZ3RoLGQ9MDtkPGM7ZCsrKWIucHVzaChhW2RdLmdkKTtyZXR1cm4gYn07XG5lLlc9ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5ZLGI9W10sYz1hLmxlbmd0aCxkPTA7ZDxjO2QrKyliLnB1c2goYVtkXS5nZXRLZXkoKSk7cmV0dXJuIGJ9O2UudmE9ZnVuY3Rpb24oYSl7cmV0dXJuIG9hKHRoaXMuWSxmdW5jdGlvbihiKXtyZXR1cm4gYi5nZXRLZXkoKT09YX0pfTtlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBrZCh0aGlzKX07ZS5DPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuWS5sZW5ndGh9O2UuWD1mdW5jdGlvbigpe3JldHVybiAwPT10aGlzLlkubGVuZ3RofTtlLmNsZWFyPWZ1bmN0aW9uKCl7cmEodGhpcy5ZKTt9O2Z1bmN0aW9uIGxkKCl7a2QuY2FsbCh0aGlzKTt9eChsZCxrZCk7bGQucHJvdG90eXBlLmVucXVldWU9ZnVuY3Rpb24oYSxiKXt0aGlzLmNlKGEsYik7fTtsZC5wcm90b3R5cGUuYWI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZW1vdmUoKX07ZnVuY3Rpb24gWShhLGIpe3RoaXMuR2Q9dm9pZCAwO3RoaXMuY2M9bmV3IGxkO2hkLmNhbGwodGhpcyxhLGIpO314KFksaGQpO2U9WS5wcm90b3R5cGU7ZS5NYj1mdW5jdGlvbihhLGIpe2lmKCFhKXJldHVybihhPVkuTC5NYi5jYWxsKHRoaXMpKSYmdGhpcy5BYyYmKHRoaXMuR2Q9aC5zZXRUaW1lb3V0KHUodGhpcy5OYix0aGlzKSx0aGlzLkFjKSksIGE7dGhpcy5jYy5lbnF1ZXVlKHZvaWQgMCE9PWI/YjoxMDAsYSk7dGhpcy5OYigpO307ZS5OYj1mdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmNjOzA8YS5DKCk7KXt2YXIgYj10aGlzLk1iKCk7aWYoYilhLmFiKCkuYXBwbHkodGhpcyxbYl0pO2Vsc2UgYnJlYWt9fTtlLm5jPWZ1bmN0aW9uKGEpe1kuTC5uYy5jYWxsKHRoaXMsYSk7dGhpcy5OYigpO307ZS5DYj1mdW5jdGlvbigpe1kuTC5DYi5jYWxsKHRoaXMpO3RoaXMuTmIoKTt9O1xuZS5GPWZ1bmN0aW9uKCl7WS5MLkYuY2FsbCh0aGlzKTtoLmNsZWFyVGltZW91dCh0aGlzLkdkKTt0aGlzLmNjLmNsZWFyKCk7dGhpcy5jYz1udWxsO307ZnVuY3Rpb24gWihhLGIsYyxkKXt0aGlzLkpmPWE7dGhpcy5BYj0hIWQ7WS5jYWxsKHRoaXMsYixjKTt9eChaLFkpO1oucHJvdG90eXBlLnhjPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IFYsYj10aGlzLkpmO2ImJmIuZm9yRWFjaChmdW5jdGlvbihiLGQpe2EuaGVhZGVycy5zZXQoZCxiKTt9KTt0aGlzLkFiJiZhLkplKCEwKTtyZXR1cm4gYX07Wi5wcm90b3R5cGUuU2M9ZnVuY3Rpb24oYSl7cmV0dXJuIWEuS2EmJiFhLkJhKCl9O2NkLnByb3RvdHlwZS5jcmVhdGVXZWJDaGFubmVsPWNkLnByb3RvdHlwZS5jZjtXLnByb3RvdHlwZS5zZW5kPVcucHJvdG90eXBlLnNlbmQ7Vy5wcm90b3R5cGUub3Blbj1XLnByb3RvdHlwZS5vcGVuO1cucHJvdG90eXBlLmNsb3NlPVcucHJvdG90eXBlLmNsb3NlO2JjLk5PX0VSUk9SPTA7YmMuVElNRU9VVD04O2JjLkhUVFBfRVJST1I9NjtjYy5DT01QTEVURT1cImNvbXBsZXRlXCI7ZWMuRXZlbnRUeXBlPVE7US5PUEVOPVwiYVwiO1EuQ0xPU0U9XCJiXCI7US5FUlJPUj1cImNcIjtRLk1FU1NBR0U9XCJkXCI7SC5wcm90b3R5cGUubGlzdGVuPUgucHJvdG90eXBlLm5iO1oucHJvdG90eXBlLmdldE9iamVjdD1aLnByb3RvdHlwZS5NYjtaLnByb3RvdHlwZS5yZWxlYXNlT2JqZWN0PVoucHJvdG90eXBlLm9nO1YucHJvdG90eXBlLmxpc3Rlbk9uY2U9Vi5wcm90b3R5cGUuT2M7Vi5wcm90b3R5cGUuZ2V0TGFzdEVycm9yPVYucHJvdG90eXBlLkhjO1YucHJvdG90eXBlLmdldExhc3RFcnJvckNvZGU9Vi5wcm90b3R5cGUuVWQ7XG5WLnByb3RvdHlwZS5nZXRTdGF0dXM9Vi5wcm90b3R5cGUuemE7Vi5wcm90b3R5cGUuZ2V0U3RhdHVzVGV4dD1WLnByb3RvdHlwZS5ZZDtWLnByb3RvdHlwZS5nZXRSZXNwb25zZUpzb249Vi5wcm90b3R5cGUueWY7Vi5wcm90b3R5cGUuZ2V0UmVzcG9uc2VUZXh0PVYucHJvdG90eXBlLnlhO1YucHJvdG90eXBlLmdldFJlc3BvbnNlVGV4dD1WLnByb3RvdHlwZS55YTtWLnByb3RvdHlwZS5zZW5kPVYucHJvdG90eXBlLnNlbmQ7dmFyIHNyYz17Y3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydDpmZCxFcnJvckNvZGU6YmMsRXZlbnRUeXBlOmNjLFdlYkNoYW5uZWw6ZWMsWGhySW9Qb29sOlp9O1xudmFyIHNyY18xID0gc3JjLmNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQ7XG52YXIgc3JjXzIgPSBzcmMuRXJyb3JDb2RlO1xudmFyIHNyY18zID0gc3JjLkV2ZW50VHlwZTtcbnZhciBzcmNfNCA9IHNyYy5XZWJDaGFubmVsO1xudmFyIHNyY181ID0gc3JjLlhocklvUG9vbDtcblxuZXhwb3J0IGRlZmF1bHQgc3JjO1xuZXhwb3J0IHsgc3JjXzEgYXMgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCwgc3JjXzIgYXMgRXJyb3JDb2RlLCBzcmNfMyBhcyBFdmVudFR5cGUsIHNyY180IGFzIFdlYkNoYW5uZWwsIHNyY181IGFzIFhocklvUG9vbCB9O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L0BmaXJlYmFzZS93ZWJjaGFubmVsLXdyYXBwZXIvZGlzdC9pbmRleC5lc20uanNcbi8vIG1vZHVsZSBpZCA9IDM5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qXHJcbiAqIFByb3ZpZGVzIGEgZGVjb3JhdG9yIGZ1bmN0b3IgZm9yIGFubm90YXRpbmcgZnVuY3Rpb25zIGluIENvbXBvbmVudCBkZWZpbml0aW9ucyBzbyB0aGF0IHRoZXkgYXJlIGF1dG9tYXRpY2FsbHlcclxuICogYm91bmQgYW5kIHVuYm91bmQgZnJvbSBldmVudHMgd2l0aG91dCBuZWVkaW5nIHRvIGNhbGwgZWwuYWRkRXZlbnRMaXN0ZW5lciBvciBlbC5yZW1vdmVFdmVudExpc3RlbmVyIHlvdXJzZWxmLlxyXG4gKlxyXG4gKiBEZWNvcmF0aW9ucyBzaG91bGQgYmUgbWFkZSBpbiB0aGUgQ29tcG9uZW50cyBkZWZpbml0aW9uIG9iamVjdC4gSGVyZSBpcyB0aGUgc2ltcGxlc3QgZXhhbXBsZTpcclxuICpcclxuICogY29uc3Qge2JpbmRFdmVudH0gPSByZXF1aXJlKCdldmVudC1iaW5kZXInKTtcclxuICpcclxuICogQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KFwiZm9vXCIsIHtcclxuICogICBjb21wb25lbnRjaGFuZ2VkOiBiaW5kRXZlbnQoIGZ1bmN0aW9uKGV2dCkge1xyXG4gKiAgICAgY29uc29sZS5sb2coZXZ0LmRldGFpbCk7XHJcbiAqICAgfSlcclxuICogfSlcclxuICpcclxuICogQnkgZGVmYXVsdCB0aGUgZnVuY3Rpb24gd2lsbCBiZSBib3VuZCB0byBldmVudHMgY29ycmVzcG9uZGluZyB0byBpdHMgcHJvcGVydHkgbmFtZSwgaW4gdGhpcyBjYXNlOiAnY29tcG9uZW50Y2hhbmdlZCcuXHJcbiAqIEl0IHdpbGwgbGlzdGVuIGZvciBldmVudHMgb24gaXRzIHBhcmVudCBlbGVtZW50LCBhbmQgd2lsbCBiZWdpbiBsaXN0ZW5pbmcgb3IgZW5kIGxpc3RlbmluZyB3aGVuIGluaXQgb3IgcmVtb3ZlIGlzXHJcbiAqIGNhbGxlZC4gSG93ZXZlciB0aGlzIGNhbiBhbHNvIGJlIGNvbmZpZ3VyZWQgYnkgcGFzc2luZyBhIGNvbmZpZ3VyYXRpb24gb2JqZWN0OlxyXG4gKlxyXG4gKiBBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoXCJmb29cIiwge1xyXG4gKiAgIHdoZW5TY2VuZUxvYWRzOiBiaW5kRXZlbnQoIHtcclxuICogICAgIGV2ZW50OiBcImxvYWRlZFwiLCAgICAvLyBFdmVudCB0byBsaXN0ZW4gZm9yLiBEZWZhdWx0cyB0byBmdW5jdGlvbnMgcHJvcGVyeSBuYW1lLlxyXG4gKiAgICAgdGFyZ2V0OiBcImEtc2NlbmVcIiwgIC8vIFNlbGVjdG9yIHN0cmluZyBmb3Igd2hpY2ggZWxlbWVudCB0byBsaXN0ZW4gb24sIGRlZmF1bHRzIHRvIHRoaXMuZWxcclxuICogICAgIGxpc3RlbkluOiBcImluaXRcIiwgICAvLyBXaGljaCBmdW5jdGlvbiBhZGRFdmVudExpc3RlbmVyIGlzIGNhbGxlZCBpbiwgZGVmYXVsdHMgdG8gJ2luaXQnXHJcbiAqICAgICByZW1vdmVJbjogXCJyZW1vdmVcIiwgLy8gV2hpY2ggZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lciBpcyBjYWxsZWQgaW4sIGRlZmF1bHRzIHRvICdyZW1vdmUnXHJcbiAqICAgfSwgZnVuY3Rpb24oZXZ0KSB7XHJcbiAqICAgICBjb25zb2xlLmxvZyhldnQuZGV0YWlsKTtcclxuICogICB9KVxyXG4gKiB9KVxyXG4gKlxyXG4gKiBGdW5jdGlvbnMgd2lsbCBvbmx5IGJlIGJvdW5kIHRvIGV2ZW50cyB3aGVuIGEgbmV3IGNvbXBvbmVudCBpcyBjcmVhdGVkLiBEZWNvcmF0aW5nIGEgZnVuY3Rpb24gd2l0aCBiaW5kRXZlbnQoKVxyXG4gKiBpbiBhIGNvbXBvbmVudHMgaW5pdCwgb3IgdGljayBmdW5jdGlvbnMgZm9yIGV4YW1wbGUgd2lsbCBoYXZlIG5vIGVmZmVjdC5cclxuICpcclxuICogRG9uJ3QgYmluZCB0byBhcnJvdyBmdW5jdGlvbnMgYmVjYXVzZSB0aGV5IGRvbid0IGhhdmUgdGhlaXIgb3duIHRoaXMuXHJcbiAqXHJcbiAqL1xyXG5cclxuY29uc3QgZGVjb3JhdGUgPSByZXF1aXJlKCcuL2NvbXBvbmVudC1kZWNvcmF0b3JzJykuZGVjb3JhdGU7XHJcblxyXG4vLyBJbXBsZW1lbnRzIHRoZSBhdXRvbWF0aWMgYmluZGluZyBhbmQgdW5iaW5kaW5nIG9mIHRoZSBjaG9zZW4gZnVuY3Rpb24uIFdyYXBzIGl0cyBsaXN0ZW5JbiBhbmQgcmVtb3ZlSW5cclxuLy8gZnVuY3Rpb25zIHRvIGFkZCBhbmQgcmVtb3ZlIHRoZSBldmVudCBsaXN0ZW5lciBhdCB0aGUgY29ycmVjdCB0aW1lcy5cclxuZnVuY3Rpb24gQmluZFRvRXZlbnREZWNvcmF0b3IoX2V2ZW50LCBfdGFyZ2V0LCBfbGlzdGVuSW4sIF9yZW1vdmVJbikge1xyXG4gIHJldHVybiBmdW5jdGlvbihwcm9wZXJ0eU5hbWUsIGZ1bmMpIHtcclxuICAgIGNvbnN0IHNjb3BlID0gdGhpcztcclxuICAgIGNvbnN0IGV2ZW50ID0gX2V2ZW50IHx8IHByb3BlcnR5TmFtZTtcclxuICAgIGNvbnN0IHRhcmdldCA9ICFfdGFyZ2V0ID8gdGhpcy5lbCA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoX3RhcmdldCk7XHJcbiAgICBpZiAoIXRhcmdldCkge1xyXG4gICAgICBjb25zb2xlLndhcm4oXCJDb3VsZG4ndCBzdWJzY3JpYmUgXCIrdGhpcy5uYW1lK1wiLlwiK3Byb3BlcnR5TmFtZStcIiB0byBcIitldmVudCtcIiBvbiBcIitfdGFyZ2V0XHJcbiAgICAgICAgK1wiIGJlY2F1c2UgcXVlcnlTZWxlY3RvciByZXR1cm5lZCB1bmRlZmluZWQuXCIpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBsaXN0ZW5JbiA9IF9saXN0ZW5JbiB8fCBcImluaXRcIjtcclxuICAgIGNvbnN0IHJlbW92ZUluID0gX3JlbW92ZUluIHx8IFwicmVtb3ZlXCI7XHJcblxyXG4gICAgY29uc3QgbGlzdGVuRnVuYyA9IHRoaXNbbGlzdGVuSW5dO1xyXG4gICAgY29uc3QgcmVtb3ZlRnVuYyA9IHRoaXNbcmVtb3ZlSW5dO1xyXG4gICAgY29uc3QgYm91bmRGdW5jID0gZnVuYy5iaW5kKHRoaXMpO1xyXG4gICAgXHJcbiAgICB0aGlzW2xpc3RlbkluXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAobGlzdGVuRnVuYyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgbGlzdGVuRnVuYy5hcHBseShzY29wZSwgYXJndW1lbnRzKTtcclxuICAgICAgfVxyXG4gICAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgYm91bmRGdW5jKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzW3JlbW92ZUluXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAocmVtb3ZlRnVuYyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmVtb3ZlRnVuYy5hcHBseShzY29wZSwgYXJndW1lbnRzKTtcclxuICAgICAgfVxyXG4gICAgICB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgYm91bmRGdW5jKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZnVuYztcclxuICB9XHJcbn1cclxuXHJcbi8qXHJcbiAqIERlY29yYXRlcyBhIGZ1bmN0aW9uIHdpdGggY29uZmlndXJhdGlvbnMgZm9yIGF1dG9tYXRpY2FsbHkgYmluZGluZyB0byBhbiBldmVudC5cclxuICpcclxuICogQHBhcmFtIHAxIC0gSWYgdGhpcyBpcyBhIGZ1bmN0aW9uIGl0IHdpbGwgYmUgZGVjb3JhdGVkIHdpdGggZGVmYXVsdCBvcHRpb25zIGFuZCBwMiBpcyBpZ25vcmVkLiBPdGhlcndpc2UgdGhpcyBjYW4gYmVcclxuICogICBhbiBvYmplY3Qgd2hpY2ggZmluZSB0dW5lcyB0aGUgYmluZGluZy5cclxuICogQHBhcmFtIHAyIC0gSWYgcDEgaXMgYW4gb2JqZWN0IHRoZW4gdGhpcyB3aWxsIGJlIHRoZSBmdW5jdGlvbiB0byBiaW5kIHRvLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7ZnVuY3Rpb259IERlY29yYXRlZCBmdW5jdGlvbiB3aGljaCB3cmFwcyB0aGUgaW5wdXQgZnVuY3Rpb24uXHJcbiAqL1xyXG5mdW5jdGlvbiBiaW5kRXZlbnQocDEsIHAyKSB7XHJcbiAgaWYgKHR5cGVvZiBwMSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICByZXR1cm4gZGVjb3JhdGUocDEsIEJpbmRUb0V2ZW50RGVjb3JhdG9yKCkpO1xyXG4gIH0gZWxzZSBpZiAodHlwZW9mIHAxID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBwMiA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICByZXR1cm4gZGVjb3JhdGUocDIsIEJpbmRUb0V2ZW50RGVjb3JhdG9yKHAxLmV2ZW50LCBwMS50YXJnZXQsIHAxLmxpc3RlbkluLCBwMS5yZW1vdmVJbikpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJiaW5kRXZlbnQgbXVzdCB0YWtlOiAoZnVuY3Rpb24pLCBvciBhIChbb2JqZWN0XSwgZnVuY3Rpb24pXCIpXHJcbiAgfVxyXG59XHJcblxyXG4vKlxyXG4gKiBDb252ZW5pZW5jZSBmdW5jdGlvbiwgd2lsbCBhbHdheXMgYmluZC91bmJpbmQgbGlzdGVuZXIgaW4gcGxheS9wYXVzZSBmdW5jdGlvbiwgcmF0aGVyIHRoYW4gdGhlIGRlZmF1bHQgaW5pdC9yZW1vdmVcclxuICovXHJcbmZ1bmN0aW9uIGJpbmRFdmVudFBsYXlQYXVzZSAocDEsIHAyKSB7XHJcbiAgaWYgKHR5cGVvZiBwMSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICByZXR1cm4gZGVjb3JhdGUocDEsIEJpbmRUb0V2ZW50RGVjb3JhdG9yKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBcInBsYXlcIiwgXCJwYXVzZVwiKSk7XHJcbiAgfSBlbHNlIGlmICh0eXBlb2YgcDEgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHAyID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgIHJldHVybiBkZWNvcmF0ZShwMiwgQmluZFRvRXZlbnREZWNvcmF0b3IocDEuZXZlbnQsIHAxLnRhcmdldCwgXCJwbGF5XCIsIFwicGF1c2VcIikpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJiaW5kRXZlbnRQbGF5UGF1c2UgbXVzdCB0YWtlOiAoZnVuY3Rpb24pLCBvciBhIChbb2JqZWN0XSwgZnVuY3Rpb24pXCIpXHJcbiAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cy5iaW5kRXZlbnQgPSBiaW5kRXZlbnQ7XHJcbm1vZHVsZS5leHBvcnRzLmJpbmRFdmVudFBsYXlQYXVzZSA9IGJpbmRFdmVudFBsYXlQYXVzZTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMvZXZlbnQtYmluZGVyLmpzXG4vLyBtb2R1bGUgaWQgPSA0MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb20vXG4gKi9cblxuVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscyA9IHtcblxuXHRjb21wdXRlVGFuZ2VudHM6IGZ1bmN0aW9uICggZ2VvbWV0cnkgKSB7XG5cblx0XHR2YXIgaW5kZXggPSBnZW9tZXRyeS5pbmRleDtcblx0XHR2YXIgYXR0cmlidXRlcyA9IGdlb21ldHJ5LmF0dHJpYnV0ZXM7XG5cblx0XHQvLyBiYXNlZCBvbiBodHRwOi8vd3d3LnRlcmF0aG9uLmNvbS9jb2RlL3RhbmdlbnQuaHRtbFxuXHRcdC8vIChwZXIgdmVydGV4IHRhbmdlbnRzKVxuXG5cdFx0aWYgKCBpbmRleCA9PT0gbnVsbCB8fFxuXHRcdFx0IGF0dHJpYnV0ZXMucG9zaXRpb24gPT09IHVuZGVmaW5lZCB8fFxuXHRcdFx0IGF0dHJpYnV0ZXMubm9ybWFsID09PSB1bmRlZmluZWQgfHxcblx0XHRcdCBhdHRyaWJ1dGVzLnV2ID09PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLkJ1ZmZlckdlb21ldHJ5OiBNaXNzaW5nIHJlcXVpcmVkIGF0dHJpYnV0ZXMgKGluZGV4LCBwb3NpdGlvbiwgbm9ybWFsIG9yIHV2KSBpbiBCdWZmZXJHZW9tZXRyeS5jb21wdXRlVGFuZ2VudHMoKScgKTtcblx0XHRcdHJldHVybjtcblxuXHRcdH1cblxuXHRcdHZhciBpbmRpY2VzID0gaW5kZXguYXJyYXk7XG5cdFx0dmFyIHBvc2l0aW9ucyA9IGF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXk7XG5cdFx0dmFyIG5vcm1hbHMgPSBhdHRyaWJ1dGVzLm5vcm1hbC5hcnJheTtcblx0XHR2YXIgdXZzID0gYXR0cmlidXRlcy51di5hcnJheTtcblxuXHRcdHZhciBuVmVydGljZXMgPSBwb3NpdGlvbnMubGVuZ3RoIC8gMztcblxuXHRcdGlmICggYXR0cmlidXRlcy50YW5nZW50ID09PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdGdlb21ldHJ5LmFkZEF0dHJpYnV0ZSggJ3RhbmdlbnQnLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCBuZXcgRmxvYXQzMkFycmF5KCA0ICogblZlcnRpY2VzICksIDQgKSApO1xuXG5cdFx0fVxuXG5cdFx0dmFyIHRhbmdlbnRzID0gYXR0cmlidXRlcy50YW5nZW50LmFycmF5O1xuXG5cdFx0dmFyIHRhbjEgPSBbXSwgdGFuMiA9IFtdO1xuXG5cdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgblZlcnRpY2VzOyBpICsrICkge1xuXG5cdFx0XHR0YW4xWyBpIF0gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHRcdFx0dGFuMlsgaSBdID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuXHRcdH1cblxuXHRcdHZhciB2QSA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXG5cdFx0XHR2QiA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXG5cdFx0XHR2QyA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXG5cblx0XHRcdHV2QSA9IG5ldyBUSFJFRS5WZWN0b3IyKCksXG5cdFx0XHR1dkIgPSBuZXcgVEhSRUUuVmVjdG9yMigpLFxuXHRcdFx0dXZDID0gbmV3IFRIUkVFLlZlY3RvcjIoKSxcblxuXHRcdFx0c2RpciA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXG5cdFx0XHR0ZGlyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuXHRcdGZ1bmN0aW9uIGhhbmRsZVRyaWFuZ2xlKCBhLCBiLCBjICkge1xuXG5cdFx0XHR2QS5mcm9tQXJyYXkoIHBvc2l0aW9ucywgYSAqIDMgKTtcblx0XHRcdHZCLmZyb21BcnJheSggcG9zaXRpb25zLCBiICogMyApO1xuXHRcdFx0dkMuZnJvbUFycmF5KCBwb3NpdGlvbnMsIGMgKiAzICk7XG5cblx0XHRcdHV2QS5mcm9tQXJyYXkoIHV2cywgYSAqIDIgKTtcblx0XHRcdHV2Qi5mcm9tQXJyYXkoIHV2cywgYiAqIDIgKTtcblx0XHRcdHV2Qy5mcm9tQXJyYXkoIHV2cywgYyAqIDIgKTtcblxuXHRcdFx0dmFyIHgxID0gdkIueCAtIHZBLng7XG5cdFx0XHR2YXIgeDIgPSB2Qy54IC0gdkEueDtcblxuXHRcdFx0dmFyIHkxID0gdkIueSAtIHZBLnk7XG5cdFx0XHR2YXIgeTIgPSB2Qy55IC0gdkEueTtcblxuXHRcdFx0dmFyIHoxID0gdkIueiAtIHZBLno7XG5cdFx0XHR2YXIgejIgPSB2Qy56IC0gdkEuejtcblxuXHRcdFx0dmFyIHMxID0gdXZCLnggLSB1dkEueDtcblx0XHRcdHZhciBzMiA9IHV2Qy54IC0gdXZBLng7XG5cblx0XHRcdHZhciB0MSA9IHV2Qi55IC0gdXZBLnk7XG5cdFx0XHR2YXIgdDIgPSB1dkMueSAtIHV2QS55O1xuXG5cdFx0XHR2YXIgciA9IDEuMCAvICggczEgKiB0MiAtIHMyICogdDEgKTtcblxuXHRcdFx0c2Rpci5zZXQoXG5cdFx0XHRcdCggdDIgKiB4MSAtIHQxICogeDIgKSAqIHIsXG5cdFx0XHRcdCggdDIgKiB5MSAtIHQxICogeTIgKSAqIHIsXG5cdFx0XHRcdCggdDIgKiB6MSAtIHQxICogejIgKSAqIHJcblx0XHRcdCk7XG5cblx0XHRcdHRkaXIuc2V0KFxuXHRcdFx0XHQoIHMxICogeDIgLSBzMiAqIHgxICkgKiByLFxuXHRcdFx0XHQoIHMxICogeTIgLSBzMiAqIHkxICkgKiByLFxuXHRcdFx0XHQoIHMxICogejIgLSBzMiAqIHoxICkgKiByXG5cdFx0XHQpO1xuXG5cdFx0XHR0YW4xWyBhIF0uYWRkKCBzZGlyICk7XG5cdFx0XHR0YW4xWyBiIF0uYWRkKCBzZGlyICk7XG5cdFx0XHR0YW4xWyBjIF0uYWRkKCBzZGlyICk7XG5cblx0XHRcdHRhbjJbIGEgXS5hZGQoIHRkaXIgKTtcblx0XHRcdHRhbjJbIGIgXS5hZGQoIHRkaXIgKTtcblx0XHRcdHRhbjJbIGMgXS5hZGQoIHRkaXIgKTtcblxuXHRcdH1cblxuXHRcdHZhciBncm91cHMgPSBnZW9tZXRyeS5ncm91cHM7XG5cblx0XHRpZiAoIGdyb3Vwcy5sZW5ndGggPT09IDAgKSB7XG5cblx0XHRcdGdyb3VwcyA9IFsge1xuXHRcdFx0XHRzdGFydDogMCxcblx0XHRcdFx0Y291bnQ6IGluZGljZXMubGVuZ3RoXG5cdFx0XHR9IF07XG5cblx0XHR9XG5cblx0XHRmb3IgKCB2YXIgaSA9IDAsIGlsID0gZ3JvdXBzLmxlbmd0aDsgaSA8IGlsOyArKyBpICkge1xuXG5cdFx0XHR2YXIgZ3JvdXAgPSBncm91cHNbIGkgXTtcblxuXHRcdFx0dmFyIHN0YXJ0ID0gZ3JvdXAuc3RhcnQ7XG5cdFx0XHR2YXIgY291bnQgPSBncm91cC5jb3VudDtcblxuXHRcdFx0Zm9yICggdmFyIGogPSBzdGFydCwgamwgPSBzdGFydCArIGNvdW50OyBqIDwgamw7IGogKz0gMyApIHtcblxuXHRcdFx0XHRoYW5kbGVUcmlhbmdsZShcblx0XHRcdFx0XHRpbmRpY2VzWyBqICsgMCBdLFxuXHRcdFx0XHRcdGluZGljZXNbIGogKyAxIF0sXG5cdFx0XHRcdFx0aW5kaWNlc1sgaiArIDIgXVxuXHRcdFx0XHQpO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHR2YXIgdG1wID0gbmV3IFRIUkVFLlZlY3RvcjMoKSwgdG1wMiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cdFx0dmFyIG4gPSBuZXcgVEhSRUUuVmVjdG9yMygpLCBuMiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cdFx0dmFyIHcsIHQsIHRlc3Q7XG5cblx0XHRmdW5jdGlvbiBoYW5kbGVWZXJ0ZXgoIHYgKSB7XG5cblx0XHRcdG4uZnJvbUFycmF5KCBub3JtYWxzLCB2ICogMyApO1xuXHRcdFx0bjIuY29weSggbiApO1xuXG5cdFx0XHR0ID0gdGFuMVsgdiBdO1xuXG5cdFx0XHQvLyBHcmFtLVNjaG1pZHQgb3J0aG9nb25hbGl6ZVxuXG5cdFx0XHR0bXAuY29weSggdCApO1xuXHRcdFx0dG1wLnN1Yiggbi5tdWx0aXBseVNjYWxhciggbi5kb3QoIHQgKSApICkubm9ybWFsaXplKCk7XG5cblx0XHRcdC8vIENhbGN1bGF0ZSBoYW5kZWRuZXNzXG5cblx0XHRcdHRtcDIuY3Jvc3NWZWN0b3JzKCBuMiwgdCApO1xuXHRcdFx0dGVzdCA9IHRtcDIuZG90KCB0YW4yWyB2IF0gKTtcblx0XHRcdHcgPSAoIHRlc3QgPCAwLjAgKSA/IC0gMS4wIDogMS4wO1xuXG5cdFx0XHR0YW5nZW50c1sgdiAqIDQgXSA9IHRtcC54O1xuXHRcdFx0dGFuZ2VudHNbIHYgKiA0ICsgMSBdID0gdG1wLnk7XG5cdFx0XHR0YW5nZW50c1sgdiAqIDQgKyAyIF0gPSB0bXAuejtcblx0XHRcdHRhbmdlbnRzWyB2ICogNCArIDMgXSA9IHc7XG5cblx0XHR9XG5cblx0XHRmb3IgKCB2YXIgaSA9IDAsIGlsID0gZ3JvdXBzLmxlbmd0aDsgaSA8IGlsOyArKyBpICkge1xuXG5cdFx0XHR2YXIgZ3JvdXAgPSBncm91cHNbIGkgXTtcblxuXHRcdFx0dmFyIHN0YXJ0ID0gZ3JvdXAuc3RhcnQ7XG5cdFx0XHR2YXIgY291bnQgPSBncm91cC5jb3VudDtcblxuXHRcdFx0Zm9yICggdmFyIGogPSBzdGFydCwgamwgPSBzdGFydCArIGNvdW50OyBqIDwgamw7IGogKz0gMyApIHtcblxuXHRcdFx0XHRoYW5kbGVWZXJ0ZXgoIGluZGljZXNbIGogKyAwIF0gKTtcblx0XHRcdFx0aGFuZGxlVmVydGV4KCBpbmRpY2VzWyBqICsgMSBdICk7XG5cdFx0XHRcdGhhbmRsZVZlcnRleCggaW5kaWNlc1sgaiArIDIgXSApO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0fSxcblxuXHQvKipcblx0ICogQHBhcmFtICB7QXJyYXk8VEhSRUUuQnVmZmVyR2VvbWV0cnk+fSBnZW9tZXRyaWVzXG5cdCAqIEByZXR1cm4ge1RIUkVFLkJ1ZmZlckdlb21ldHJ5fVxuXHQgKi9cblx0bWVyZ2VCdWZmZXJHZW9tZXRyaWVzOiBmdW5jdGlvbiAoIGdlb21ldHJpZXMsIHVzZUdyb3VwcyApIHtcblxuXHRcdHZhciBpc0luZGV4ZWQgPSBnZW9tZXRyaWVzWyAwIF0uaW5kZXggIT09IG51bGw7XG5cblx0XHR2YXIgYXR0cmlidXRlc1VzZWQgPSBuZXcgU2V0KCBPYmplY3Qua2V5cyggZ2VvbWV0cmllc1sgMCBdLmF0dHJpYnV0ZXMgKSApO1xuXHRcdHZhciBtb3JwaEF0dHJpYnV0ZXNVc2VkID0gbmV3IFNldCggT2JqZWN0LmtleXMoIGdlb21ldHJpZXNbIDAgXS5tb3JwaEF0dHJpYnV0ZXMgKSApO1xuXG5cdFx0dmFyIGF0dHJpYnV0ZXMgPSB7fTtcblx0XHR2YXIgbW9ycGhBdHRyaWJ1dGVzID0ge307XG5cblx0XHR2YXIgbWVyZ2VkR2VvbWV0cnkgPSBuZXcgVEhSRUUuQnVmZmVyR2VvbWV0cnkoKTtcblxuXHRcdHZhciBvZmZzZXQgPSAwO1xuXG5cdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgZ2VvbWV0cmllcy5sZW5ndGg7ICsrIGkgKSB7XG5cblx0XHRcdHZhciBnZW9tZXRyeSA9IGdlb21ldHJpZXNbIGkgXTtcblxuXHRcdFx0Ly8gZW5zdXJlIHRoYXQgYWxsIGdlb21ldHJpZXMgYXJlIGluZGV4ZWQsIG9yIG5vbmVcblxuXHRcdFx0aWYgKCBpc0luZGV4ZWQgIT09ICggZ2VvbWV0cnkuaW5kZXggIT09IG51bGwgKSApIHJldHVybiBudWxsO1xuXG5cdFx0XHQvLyBnYXRoZXIgYXR0cmlidXRlcywgZXhpdCBlYXJseSBpZiB0aGV5J3JlIGRpZmZlcmVudFxuXG5cdFx0XHRmb3IgKCB2YXIgbmFtZSBpbiBnZW9tZXRyeS5hdHRyaWJ1dGVzICkge1xuXG5cdFx0XHRcdGlmICggISBhdHRyaWJ1dGVzVXNlZC5oYXMoIG5hbWUgKSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRcdGlmICggYXR0cmlidXRlc1sgbmFtZSBdID09PSB1bmRlZmluZWQgKSBhdHRyaWJ1dGVzWyBuYW1lIF0gPSBbXTtcblxuXHRcdFx0XHRhdHRyaWJ1dGVzWyBuYW1lIF0ucHVzaCggZ2VvbWV0cnkuYXR0cmlidXRlc1sgbmFtZSBdICk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gZ2F0aGVyIG1vcnBoIGF0dHJpYnV0ZXMsIGV4aXQgZWFybHkgaWYgdGhleSdyZSBkaWZmZXJlbnRcblxuXHRcdFx0Zm9yICggdmFyIG5hbWUgaW4gZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzICkge1xuXG5cdFx0XHRcdGlmICggISBtb3JwaEF0dHJpYnV0ZXNVc2VkLmhhcyggbmFtZSApICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdFx0aWYgKCBtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXSA9PT0gdW5kZWZpbmVkICkgbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0gPSBbXTtcblxuXHRcdFx0XHRtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXS5wdXNoKCBnZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXSApO1xuXG5cdFx0XHR9XG5cblx0XHRcdC8vIGdhdGhlciAudXNlckRhdGFcblxuICAgICAgaWYgKG1lcmdlZEdlb21ldHJ5LnVzZXJEYXRhKSB7XG5cbiAgICAgICAgbWVyZ2VkR2VvbWV0cnkudXNlckRhdGEubWVyZ2VkVXNlckRhdGEgPSBtZXJnZWRHZW9tZXRyeS51c2VyRGF0YS5tZXJnZWRVc2VyRGF0YSB8fCBbXTtcbiAgICAgICAgbWVyZ2VkR2VvbWV0cnkudXNlckRhdGEubWVyZ2VkVXNlckRhdGEucHVzaCggZ2VvbWV0cnkudXNlckRhdGEgKTtcblxuICAgICAgfVxuXG5cdFx0XHRpZiAoIHVzZUdyb3VwcyApIHtcblxuXHRcdFx0XHR2YXIgY291bnQ7XG5cblx0XHRcdFx0aWYgKCBpc0luZGV4ZWQgKSB7XG5cblx0XHRcdFx0XHRjb3VudCA9IGdlb21ldHJ5LmluZGV4LmNvdW50O1xuXG5cdFx0XHRcdH0gZWxzZSBpZiAoIGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24gIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHRcdGNvdW50ID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5jb3VudDtcblxuXHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdG1lcmdlZEdlb21ldHJ5LmFkZEdyb3VwKCBvZmZzZXQsIGNvdW50LCBpICk7XG5cblx0XHRcdFx0b2Zmc2V0ICs9IGNvdW50O1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHQvLyBtZXJnZSBpbmRpY2VzXG5cblx0XHRpZiAoIGlzSW5kZXhlZCApIHtcblxuXHRcdFx0dmFyIGluZGV4T2Zmc2V0ID0gMDtcblx0XHRcdHZhciBtZXJnZWRJbmRleCA9IFtdO1xuXG5cdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBnZW9tZXRyaWVzLmxlbmd0aDsgKysgaSApIHtcblxuXHRcdFx0XHR2YXIgaW5kZXggPSBnZW9tZXRyaWVzWyBpIF0uaW5kZXg7XG5cblx0XHRcdFx0Zm9yICggdmFyIGogPSAwOyBqIDwgaW5kZXguY291bnQ7ICsrIGogKSB7XG5cblx0XHRcdFx0XHRtZXJnZWRJbmRleC5wdXNoKCBpbmRleC5nZXRYKCBqICkgKyBpbmRleE9mZnNldCApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpbmRleE9mZnNldCArPSBnZW9tZXRyaWVzWyBpIF0uYXR0cmlidXRlcy5wb3NpdGlvbi5jb3VudDtcblxuXHRcdFx0fVxuXG5cdFx0XHRtZXJnZWRHZW9tZXRyeS5zZXRJbmRleCggbWVyZ2VkSW5kZXggKTtcblxuXHRcdH1cblxuXHRcdC8vIG1lcmdlIGF0dHJpYnV0ZXNcblxuXHRcdGZvciAoIHZhciBuYW1lIGluIGF0dHJpYnV0ZXMgKSB7XG5cblx0XHRcdHZhciBtZXJnZWRBdHRyaWJ1dGUgPSB0aGlzLm1lcmdlQnVmZmVyQXR0cmlidXRlcyggYXR0cmlidXRlc1sgbmFtZSBdICk7XG5cblx0XHRcdGlmICggISBtZXJnZWRBdHRyaWJ1dGUgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0bWVyZ2VkR2VvbWV0cnkuYWRkQXR0cmlidXRlKCBuYW1lLCBtZXJnZWRBdHRyaWJ1dGUgKTtcblxuXHRcdH1cblxuXHRcdC8vIG1lcmdlIG1vcnBoIGF0dHJpYnV0ZXNcblxuXHRcdGZvciAoIHZhciBuYW1lIGluIG1vcnBoQXR0cmlidXRlcyApIHtcblxuXHRcdFx0dmFyIG51bU1vcnBoVGFyZ2V0cyA9IG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdWyAwIF0ubGVuZ3RoO1xuXG5cdFx0XHRpZiAoIG51bU1vcnBoVGFyZ2V0cyA9PT0gMCApIGJyZWFrO1xuXG5cdFx0XHRtZXJnZWRHZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXMgPSBtZXJnZWRHZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXMgfHwge307XG5cdFx0XHRtZXJnZWRHZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXSA9IFtdO1xuXG5cdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBudW1Nb3JwaFRhcmdldHM7ICsrIGkgKSB7XG5cblx0XHRcdFx0dmFyIG1vcnBoQXR0cmlidXRlc1RvTWVyZ2UgPSBbXTtcblxuXHRcdFx0XHRmb3IgKCB2YXIgaiA9IDA7IGogPCBtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXS5sZW5ndGg7ICsrIGogKSB7XG5cblx0XHRcdFx0XHRtb3JwaEF0dHJpYnV0ZXNUb01lcmdlLnB1c2goIG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdWyBqIF1bIGkgXSApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgbWVyZ2VkTW9ycGhBdHRyaWJ1dGUgPSB0aGlzLm1lcmdlQnVmZmVyQXR0cmlidXRlcyggbW9ycGhBdHRyaWJ1dGVzVG9NZXJnZSApO1xuXG5cdFx0XHRcdGlmICggISBtZXJnZWRNb3JwaEF0dHJpYnV0ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRcdG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlc1sgbmFtZSBdLnB1c2goIG1lcmdlZE1vcnBoQXR0cmlidXRlICk7XG5cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdHJldHVybiBtZXJnZWRHZW9tZXRyeTtcblxuXHR9LFxuXG5cdC8qKlxuXHQgKiBAcGFyYW0ge0FycmF5PFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZT59IGF0dHJpYnV0ZXNcblx0ICogQHJldHVybiB7VEhSRUUuQnVmZmVyQXR0cmlidXRlfVxuXHQgKi9cblx0bWVyZ2VCdWZmZXJBdHRyaWJ1dGVzOiBmdW5jdGlvbiAoIGF0dHJpYnV0ZXMgKSB7XG5cblx0XHR2YXIgVHlwZWRBcnJheTtcblx0XHR2YXIgaXRlbVNpemU7XG5cdFx0dmFyIG5vcm1hbGl6ZWQ7XG5cdFx0dmFyIGFycmF5TGVuZ3RoID0gMDtcblxuXHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyArKyBpICkge1xuXG5cdFx0XHR2YXIgYXR0cmlidXRlID0gYXR0cmlidXRlc1sgaSBdO1xuXG5cdFx0XHRpZiAoIGF0dHJpYnV0ZS5pc0ludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdGlmICggVHlwZWRBcnJheSA9PT0gdW5kZWZpbmVkICkgVHlwZWRBcnJheSA9IGF0dHJpYnV0ZS5hcnJheS5jb25zdHJ1Y3Rvcjtcblx0XHRcdGlmICggVHlwZWRBcnJheSAhPT0gYXR0cmlidXRlLmFycmF5LmNvbnN0cnVjdG9yICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdGlmICggaXRlbVNpemUgPT09IHVuZGVmaW5lZCApIGl0ZW1TaXplID0gYXR0cmlidXRlLml0ZW1TaXplO1xuXHRcdFx0aWYgKCBpdGVtU2l6ZSAhPT0gYXR0cmlidXRlLml0ZW1TaXplICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdGlmICggbm9ybWFsaXplZCA9PT0gdW5kZWZpbmVkICkgbm9ybWFsaXplZCA9IGF0dHJpYnV0ZS5ub3JtYWxpemVkO1xuXHRcdFx0aWYgKCBub3JtYWxpemVkICE9PSBhdHRyaWJ1dGUubm9ybWFsaXplZCApIHJldHVybiBudWxsO1xuXG5cdFx0XHRhcnJheUxlbmd0aCArPSBhdHRyaWJ1dGUuYXJyYXkubGVuZ3RoO1xuXG5cdFx0fVxuXG5cdFx0dmFyIGFycmF5ID0gbmV3IFR5cGVkQXJyYXkoIGFycmF5TGVuZ3RoICk7XG5cdFx0dmFyIG9mZnNldCA9IDA7XG5cblx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgKysgaSApIHtcblxuXHRcdFx0YXJyYXkuc2V0KCBhdHRyaWJ1dGVzWyBpIF0uYXJyYXksIG9mZnNldCApO1xuXG5cdFx0XHRvZmZzZXQgKz0gYXR0cmlidXRlc1sgaSBdLmFycmF5Lmxlbmd0aDtcblxuXHRcdH1cblxuXHRcdHJldHVybiBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCBhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQgKTtcblxuXHR9XG5cbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLWdlb21ldHJ5LW1lcmdlci1jb21wb25lbnQvbGliL0J1ZmZlckdlb21ldHJ5VXRpbHMuanNcbi8vIG1vZHVsZSBpZCA9IDQxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogQGF1dGhvciBxaWFvIC8gaHR0cHM6Ly9naXRodWIuY29tL3FpYW9cbiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb21cbiAqIEBhdXRob3IgYWx0ZXJlZHEgLyBodHRwOi8vYWx0ZXJlZHF1YWxpYS5jb20vXG4gKiBAYXV0aG9yIFdlc3RMYW5nbGV5IC8gaHR0cDovL2dpdGh1Yi5jb20vV2VzdExhbmdsZXlcbiAqIEBhdXRob3IgZXJpY2g2NjYgLyBodHRwOi8vZXJpY2hhaW5lcy5jb21cbiAqL1xuXG4vLyBUaGlzIHNldCBvZiBjb250cm9scyBwZXJmb3JtcyBvcmJpdGluZywgZG9sbHlpbmcgKHpvb21pbmcpLCBhbmQgcGFubmluZy5cbi8vIFVubGlrZSBUcmFja2JhbGxDb250cm9scywgaXQgbWFpbnRhaW5zIHRoZSBcInVwXCIgZGlyZWN0aW9uIG9iamVjdC51cCAoK1kgYnkgZGVmYXVsdCkuXG4vL1xuLy8gICAgT3JiaXQgLSBsZWZ0IG1vdXNlIC8gdG91Y2g6IG9uZSBmaW5nZXIgbW92ZVxuLy8gICAgWm9vbSAtIG1pZGRsZSBtb3VzZSwgb3IgbW91c2V3aGVlbCAvIHRvdWNoOiB0d28gZmluZ2VyIHNwcmVhZCBvciBzcXVpc2hcbi8vICAgIFBhbiAtIHJpZ2h0IG1vdXNlLCBvciBhcnJvdyBrZXlzIC8gdG91Y2g6IHRocmVlIGZpbmdlciBzd2lwZVxuXG5USFJFRS5PcmJpdENvbnRyb2xzID0gZnVuY3Rpb24gKCBvYmplY3QsIGRvbUVsZW1lbnQgKSB7XG5cblx0dGhpcy5vYmplY3QgPSBvYmplY3Q7XG5cblx0dGhpcy5kb21FbGVtZW50ID0gKCBkb21FbGVtZW50ICE9PSB1bmRlZmluZWQgKSA/IGRvbUVsZW1lbnQgOiBkb2N1bWVudDtcblxuXHQvLyBTZXQgdG8gZmFsc2UgdG8gZGlzYWJsZSB0aGlzIGNvbnRyb2xcblx0dGhpcy5lbmFibGVkID0gdHJ1ZTtcblxuXHQvLyBcInRhcmdldFwiIHNldHMgdGhlIGxvY2F0aW9uIG9mIGZvY3VzLCB3aGVyZSB0aGUgb2JqZWN0IG9yYml0cyBhcm91bmRcblx0dGhpcy50YXJnZXQgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG5cdC8vIEhvdyBmYXIgeW91IGNhbiBkb2xseSBpbiBhbmQgb3V0ICggUGVyc3BlY3RpdmVDYW1lcmEgb25seSApXG5cdHRoaXMubWluRGlzdGFuY2UgPSAwO1xuXHR0aGlzLm1heERpc3RhbmNlID0gSW5maW5pdHk7XG5cblx0Ly8gSG93IGZhciB5b3UgY2FuIHpvb20gaW4gYW5kIG91dCAoIE9ydGhvZ3JhcGhpY0NhbWVyYSBvbmx5IClcblx0dGhpcy5taW5ab29tID0gMDtcblx0dGhpcy5tYXhab29tID0gSW5maW5pdHk7XG5cblx0Ly8gSG93IGZhciB5b3UgY2FuIG9yYml0IHZlcnRpY2FsbHksIHVwcGVyIGFuZCBsb3dlciBsaW1pdHMuXG5cdC8vIFJhbmdlIGlzIDAgdG8gTWF0aC5QSSByYWRpYW5zLlxuXHR0aGlzLm1pblBvbGFyQW5nbGUgPSAwOyAvLyByYWRpYW5zXG5cdHRoaXMubWF4UG9sYXJBbmdsZSA9IE1hdGguUEk7IC8vIHJhZGlhbnNcblxuXHQvLyBIb3cgZmFyIHlvdSBjYW4gb3JiaXQgaG9yaXpvbnRhbGx5LCB1cHBlciBhbmQgbG93ZXIgbGltaXRzLlxuXHQvLyBJZiBzZXQsIG11c3QgYmUgYSBzdWItaW50ZXJ2YWwgb2YgdGhlIGludGVydmFsIFsgLSBNYXRoLlBJLCBNYXRoLlBJIF0uXG5cdHRoaXMubWluQXppbXV0aEFuZ2xlID0gLSBJbmZpbml0eTsgLy8gcmFkaWFuc1xuXHR0aGlzLm1heEF6aW11dGhBbmdsZSA9IEluZmluaXR5OyAvLyByYWRpYW5zXG5cblx0Ly8gU2V0IHRvIHRydWUgdG8gZW5hYmxlIGRhbXBpbmcgKGluZXJ0aWEpXG5cdC8vIElmIGRhbXBpbmcgaXMgZW5hYmxlZCwgeW91IG11c3QgY2FsbCBjb250cm9scy51cGRhdGUoKSBpbiB5b3VyIGFuaW1hdGlvbiBsb29wXG5cdHRoaXMuZW5hYmxlRGFtcGluZyA9IGZhbHNlO1xuXHR0aGlzLmRhbXBpbmdGYWN0b3IgPSAwLjI1O1xuXG5cdC8vIFRoaXMgb3B0aW9uIGFjdHVhbGx5IGVuYWJsZXMgZG9sbHlpbmcgaW4gYW5kIG91dDsgbGVmdCBhcyBcInpvb21cIiBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuXG5cdC8vIFNldCB0byBmYWxzZSB0byBkaXNhYmxlIHpvb21pbmdcblx0dGhpcy5lbmFibGVab29tID0gdHJ1ZTtcblx0dGhpcy56b29tU3BlZWQgPSAxLjA7XG5cblx0Ly8gU2V0IHRvIGZhbHNlIHRvIGRpc2FibGUgcm90YXRpbmdcblx0dGhpcy5lbmFibGVSb3RhdGUgPSB0cnVlO1xuXHR0aGlzLnJvdGF0ZVNwZWVkID0gMS4wO1xuXG5cdC8vIFNldCB0byBmYWxzZSB0byBkaXNhYmxlIHBhbm5pbmdcblx0dGhpcy5lbmFibGVQYW4gPSB0cnVlO1xuXHR0aGlzLmtleVBhblNwZWVkID0gNy4wO1x0Ly8gcGl4ZWxzIG1vdmVkIHBlciBhcnJvdyBrZXkgcHVzaFxuXG5cdC8vIFNldCB0byB0cnVlIHRvIGF1dG9tYXRpY2FsbHkgcm90YXRlIGFyb3VuZCB0aGUgdGFyZ2V0XG5cdC8vIElmIGF1dG8tcm90YXRlIGlzIGVuYWJsZWQsIHlvdSBtdXN0IGNhbGwgY29udHJvbHMudXBkYXRlKCkgaW4geW91ciBhbmltYXRpb24gbG9vcFxuXHR0aGlzLmF1dG9Sb3RhdGUgPSBmYWxzZTtcblx0dGhpcy5hdXRvUm90YXRlU3BlZWQgPSAyLjA7IC8vIDMwIHNlY29uZHMgcGVyIHJvdW5kIHdoZW4gZnBzIGlzIDYwXG5cblx0Ly8gU2V0IHRvIGZhbHNlIHRvIGRpc2FibGUgdXNlIG9mIHRoZSBrZXlzXG5cdHRoaXMuZW5hYmxlS2V5cyA9IHRydWU7XG5cblx0Ly8gVGhlIGZvdXIgYXJyb3cga2V5c1xuXHR0aGlzLmtleXMgPSB7IExFRlQ6IDM3LCBVUDogMzgsIFJJR0hUOiAzOSwgQk9UVE9NOiA0MCB9O1xuXG5cdC8vIE1vdXNlIGJ1dHRvbnNcblx0dGhpcy5tb3VzZUJ1dHRvbnMgPSB7IE9SQklUOiBUSFJFRS5NT1VTRS5MRUZULCBaT09NOiBUSFJFRS5NT1VTRS5NSURETEUsIFBBTjogVEhSRUUuTU9VU0UuUklHSFQgfTtcblxuXHQvLyBmb3IgcmVzZXRcblx0dGhpcy50YXJnZXQwID0gdGhpcy50YXJnZXQuY2xvbmUoKTtcblx0dGhpcy5wb3NpdGlvbjAgPSB0aGlzLm9iamVjdC5wb3NpdGlvbi5jbG9uZSgpO1xuXHR0aGlzLnpvb20wID0gdGhpcy5vYmplY3Quem9vbTtcblxuXHQvL1xuXHQvLyBwdWJsaWMgbWV0aG9kc1xuXHQvL1xuXG5cdHRoaXMuZ2V0UG9sYXJBbmdsZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHJldHVybiBzcGhlcmljYWwucGhpO1xuXG5cdH07XG5cblx0dGhpcy5nZXRBemltdXRoYWxBbmdsZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHJldHVybiBzcGhlcmljYWwudGhldGE7XG5cblx0fTtcblxuXHR0aGlzLnNhdmVTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHNjb3BlLnRhcmdldDAuY29weSggc2NvcGUudGFyZ2V0ICk7XG5cdFx0c2NvcGUucG9zaXRpb24wLmNvcHkoIHNjb3BlLm9iamVjdC5wb3NpdGlvbiApO1xuXHRcdHNjb3BlLnpvb20wID0gc2NvcGUub2JqZWN0Lnpvb207XG5cblx0fTtcblxuXHR0aGlzLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0c2NvcGUudGFyZ2V0LmNvcHkoIHNjb3BlLnRhcmdldDAgKTtcblx0XHRzY29wZS5vYmplY3QucG9zaXRpb24uY29weSggc2NvcGUucG9zaXRpb24wICk7XG5cdFx0c2NvcGUub2JqZWN0Lnpvb20gPSBzY29wZS56b29tMDtcblxuXHRcdHNjb3BlLm9iamVjdC51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG5cdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggY2hhbmdlRXZlbnQgKTtcblxuXHRcdHNjb3BlLnVwZGF0ZSgpO1xuXG5cdFx0c3RhdGUgPSBTVEFURS5OT05FO1xuXG5cdH07XG5cblx0Ly8gdGhpcyBtZXRob2QgaXMgZXhwb3NlZCwgYnV0IHBlcmhhcHMgaXQgd291bGQgYmUgYmV0dGVyIGlmIHdlIGNhbiBtYWtlIGl0IHByaXZhdGUuLi5cblx0dGhpcy51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHR2YXIgb2Zmc2V0ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuXHRcdC8vIHNvIGNhbWVyYS51cCBpcyB0aGUgb3JiaXQgYXhpc1xuXHRcdHZhciBxdWF0ID0gbmV3IFRIUkVFLlF1YXRlcm5pb24oKS5zZXRGcm9tVW5pdFZlY3RvcnMoIG9iamVjdC51cCwgbmV3IFRIUkVFLlZlY3RvcjMoIDAsIDEsIDAgKSApO1xuXHRcdHZhciBxdWF0SW52ZXJzZSA9IHF1YXQuY2xvbmUoKS5pbnZlcnNlKCk7XG5cblx0XHR2YXIgbGFzdFBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblx0XHR2YXIgbGFzdFF1YXRlcm5pb24gPSBuZXcgVEhSRUUuUXVhdGVybmlvbigpO1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZSgpIHtcblxuXHRcdFx0dmFyIHBvc2l0aW9uID0gc2NvcGUub2JqZWN0LnBvc2l0aW9uO1xuXG5cdFx0XHRvZmZzZXQuY29weSggcG9zaXRpb24gKS5zdWIoIHNjb3BlLnRhcmdldCApO1xuXG5cdFx0XHQvLyByb3RhdGUgb2Zmc2V0IHRvIFwieS1heGlzLWlzLXVwXCIgc3BhY2Vcblx0XHRcdG9mZnNldC5hcHBseVF1YXRlcm5pb24oIHF1YXQgKTtcblxuXHRcdFx0Ly8gYW5nbGUgZnJvbSB6LWF4aXMgYXJvdW5kIHktYXhpc1xuXHRcdFx0c3BoZXJpY2FsLnNldEZyb21WZWN0b3IzKCBvZmZzZXQgKTtcblxuXHRcdFx0aWYgKCBzY29wZS5hdXRvUm90YXRlICYmIHN0YXRlID09PSBTVEFURS5OT05FICkge1xuXG5cdFx0XHRcdHJvdGF0ZUxlZnQoIGdldEF1dG9Sb3RhdGlvbkFuZ2xlKCkgKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRzcGhlcmljYWwudGhldGEgKz0gc3BoZXJpY2FsRGVsdGEudGhldGE7XG5cdFx0XHRzcGhlcmljYWwucGhpICs9IHNwaGVyaWNhbERlbHRhLnBoaTtcblxuXHRcdFx0Ly8gcmVzdHJpY3QgdGhldGEgdG8gYmUgYmV0d2VlbiBkZXNpcmVkIGxpbWl0c1xuXHRcdFx0c3BoZXJpY2FsLnRoZXRhID0gTWF0aC5tYXgoIHNjb3BlLm1pbkF6aW11dGhBbmdsZSwgTWF0aC5taW4oIHNjb3BlLm1heEF6aW11dGhBbmdsZSwgc3BoZXJpY2FsLnRoZXRhICkgKTtcblxuXHRcdFx0Ly8gcmVzdHJpY3QgcGhpIHRvIGJlIGJldHdlZW4gZGVzaXJlZCBsaW1pdHNcblx0XHRcdHNwaGVyaWNhbC5waGkgPSBNYXRoLm1heCggc2NvcGUubWluUG9sYXJBbmdsZSwgTWF0aC5taW4oIHNjb3BlLm1heFBvbGFyQW5nbGUsIHNwaGVyaWNhbC5waGkgKSApO1xuXG5cdFx0XHRzcGhlcmljYWwubWFrZVNhZmUoKTtcblxuXG5cdFx0XHRzcGhlcmljYWwucmFkaXVzICo9IHNjYWxlO1xuXG5cdFx0XHQvLyByZXN0cmljdCByYWRpdXMgdG8gYmUgYmV0d2VlbiBkZXNpcmVkIGxpbWl0c1xuXHRcdFx0c3BoZXJpY2FsLnJhZGl1cyA9IE1hdGgubWF4KCBzY29wZS5taW5EaXN0YW5jZSwgTWF0aC5taW4oIHNjb3BlLm1heERpc3RhbmNlLCBzcGhlcmljYWwucmFkaXVzICkgKTtcblxuXHRcdFx0Ly8gbW92ZSB0YXJnZXQgdG8gcGFubmVkIGxvY2F0aW9uXG5cdFx0XHRzY29wZS50YXJnZXQuYWRkKCBwYW5PZmZzZXQgKTtcblxuXHRcdFx0b2Zmc2V0LnNldEZyb21TcGhlcmljYWwoIHNwaGVyaWNhbCApO1xuXG5cdFx0XHQvLyByb3RhdGUgb2Zmc2V0IGJhY2sgdG8gXCJjYW1lcmEtdXAtdmVjdG9yLWlzLXVwXCIgc3BhY2Vcblx0XHRcdG9mZnNldC5hcHBseVF1YXRlcm5pb24oIHF1YXRJbnZlcnNlICk7XG5cblx0XHRcdHBvc2l0aW9uLmNvcHkoIHNjb3BlLnRhcmdldCApLmFkZCggb2Zmc2V0ICk7XG5cblx0XHRcdHNjb3BlLm9iamVjdC5sb29rQXQoIHNjb3BlLnRhcmdldCApO1xuXG5cdFx0XHRpZiAoIHNjb3BlLmVuYWJsZURhbXBpbmcgPT09IHRydWUgKSB7XG5cblx0XHRcdFx0c3BoZXJpY2FsRGVsdGEudGhldGEgKj0gKCAxIC0gc2NvcGUuZGFtcGluZ0ZhY3RvciApO1xuXHRcdFx0XHRzcGhlcmljYWxEZWx0YS5waGkgKj0gKCAxIC0gc2NvcGUuZGFtcGluZ0ZhY3RvciApO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdHNwaGVyaWNhbERlbHRhLnNldCggMCwgMCwgMCApO1xuXG5cdFx0XHR9XG5cblx0XHRcdHNjYWxlID0gMTtcblx0XHRcdHBhbk9mZnNldC5zZXQoIDAsIDAsIDAgKTtcblxuXHRcdFx0Ly8gdXBkYXRlIGNvbmRpdGlvbiBpczpcblx0XHRcdC8vIG1pbihjYW1lcmEgZGlzcGxhY2VtZW50LCBjYW1lcmEgcm90YXRpb24gaW4gcmFkaWFucyleMiA+IEVQU1xuXHRcdFx0Ly8gdXNpbmcgc21hbGwtYW5nbGUgYXBwcm94aW1hdGlvbiBjb3MoeC8yKSA9IDEgLSB4XjIgLyA4XG5cblx0XHRcdGlmICggem9vbUNoYW5nZWQgfHxcblx0XHRcdFx0bGFzdFBvc2l0aW9uLmRpc3RhbmNlVG9TcXVhcmVkKCBzY29wZS5vYmplY3QucG9zaXRpb24gKSA+IEVQUyB8fFxuXHRcdFx0XHQ4ICogKCAxIC0gbGFzdFF1YXRlcm5pb24uZG90KCBzY29wZS5vYmplY3QucXVhdGVybmlvbiApICkgPiBFUFMgKSB7XG5cblx0XHRcdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggY2hhbmdlRXZlbnQgKTtcblxuXHRcdFx0XHRsYXN0UG9zaXRpb24uY29weSggc2NvcGUub2JqZWN0LnBvc2l0aW9uICk7XG5cdFx0XHRcdGxhc3RRdWF0ZXJuaW9uLmNvcHkoIHNjb3BlLm9iamVjdC5xdWF0ZXJuaW9uICk7XG5cdFx0XHRcdHpvb21DaGFuZ2VkID0gZmFsc2U7XG5cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXG5cdFx0fTtcblxuXHR9KCk7XG5cblx0dGhpcy5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0c2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnY29udGV4dG1lbnUnLCBvbkNvbnRleHRNZW51LCBmYWxzZSApO1xuXHRcdHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlZG93bicsIG9uTW91c2VEb3duLCBmYWxzZSApO1xuXHRcdHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3doZWVsJywgb25Nb3VzZVdoZWVsLCBmYWxzZSApO1xuXG5cdFx0c2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAndG91Y2hzdGFydCcsIG9uVG91Y2hTdGFydCwgZmFsc2UgKTtcblx0XHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd0b3VjaGVuZCcsIG9uVG91Y2hFbmQsIGZhbHNlICk7XG5cdFx0c2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUsIGZhbHNlICk7XG5cblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUsIGZhbHNlICk7XG5cdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBvbk1vdXNlVXAsIGZhbHNlICk7XG5cblx0XHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBvbktleURvd24sIGZhbHNlICk7XG5cblx0XHQvL3Njb3BlLmRpc3BhdGNoRXZlbnQoIHsgdHlwZTogJ2Rpc3Bvc2UnIH0gKTsgLy8gc2hvdWxkIHRoaXMgYmUgYWRkZWQgaGVyZT9cblxuXHR9O1xuXG5cdC8vXG5cdC8vIGludGVybmFsc1xuXHQvL1xuXG5cdHZhciBzY29wZSA9IHRoaXM7XG5cblx0dmFyIGNoYW5nZUV2ZW50ID0geyB0eXBlOiAnY2hhbmdlJyB9O1xuXHR2YXIgc3RhcnRFdmVudCA9IHsgdHlwZTogJ3N0YXJ0JyB9O1xuXHR2YXIgZW5kRXZlbnQgPSB7IHR5cGU6ICdlbmQnIH07XG5cblx0dmFyIFNUQVRFID0geyBOT05FOiAtIDEsIFJPVEFURTogMCwgRE9MTFk6IDEsIFBBTjogMiwgVE9VQ0hfUk9UQVRFOiAzLCBUT1VDSF9ET0xMWTogNCwgVE9VQ0hfUEFOOiA1IH07XG5cblx0dmFyIHN0YXRlID0gU1RBVEUuTk9ORTtcblxuXHR2YXIgRVBTID0gMC4wMDAwMDE7XG5cblx0Ly8gY3VycmVudCBwb3NpdGlvbiBpbiBzcGhlcmljYWwgY29vcmRpbmF0ZXNcblx0dmFyIHNwaGVyaWNhbCA9IG5ldyBUSFJFRS5TcGhlcmljYWwoKTtcblx0dmFyIHNwaGVyaWNhbERlbHRhID0gbmV3IFRIUkVFLlNwaGVyaWNhbCgpO1xuXG5cdHZhciBzY2FsZSA9IDE7XG5cdHZhciBwYW5PZmZzZXQgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHR2YXIgem9vbUNoYW5nZWQgPSBmYWxzZTtcblxuXHR2YXIgcm90YXRlU3RhcnQgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xuXHR2YXIgcm90YXRlRW5kID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcblx0dmFyIHJvdGF0ZURlbHRhID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcblxuXHR2YXIgcGFuU3RhcnQgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xuXHR2YXIgcGFuRW5kID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcblx0dmFyIHBhbkRlbHRhID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcblxuXHR2YXIgZG9sbHlTdGFydCA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cdHZhciBkb2xseUVuZCA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cdHZhciBkb2xseURlbHRhID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcblxuXHRmdW5jdGlvbiBnZXRBdXRvUm90YXRpb25BbmdsZSgpIHtcblxuXHRcdHJldHVybiAyICogTWF0aC5QSSAvIDYwIC8gNjAgKiBzY29wZS5hdXRvUm90YXRlU3BlZWQ7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGdldFpvb21TY2FsZSgpIHtcblxuXHRcdHJldHVybiBNYXRoLnBvdyggMC45NSwgc2NvcGUuem9vbVNwZWVkICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIHJvdGF0ZUxlZnQoIGFuZ2xlICkge1xuXG5cdFx0c3BoZXJpY2FsRGVsdGEudGhldGEgLT0gYW5nbGU7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIHJvdGF0ZVVwKCBhbmdsZSApIHtcblxuXHRcdHNwaGVyaWNhbERlbHRhLnBoaSAtPSBhbmdsZTtcblxuXHR9XG5cblx0dmFyIHBhbkxlZnQgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHR2YXIgdiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHRyZXR1cm4gZnVuY3Rpb24gcGFuTGVmdCggZGlzdGFuY2UsIG9iamVjdE1hdHJpeCApIHtcblxuXHRcdFx0di5zZXRGcm9tTWF0cml4Q29sdW1uKCBvYmplY3RNYXRyaXgsIDAgKTsgLy8gZ2V0IFggY29sdW1uIG9mIG9iamVjdE1hdHJpeFxuXHRcdFx0di5tdWx0aXBseVNjYWxhciggLSBkaXN0YW5jZSApO1xuXG5cdFx0XHRwYW5PZmZzZXQuYWRkKCB2ICk7XG5cblx0XHR9O1xuXG5cdH0oKTtcblxuXHR2YXIgcGFuVXAgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHR2YXIgdiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHRyZXR1cm4gZnVuY3Rpb24gcGFuVXAoIGRpc3RhbmNlLCBvYmplY3RNYXRyaXggKSB7XG5cblx0XHRcdHYuc2V0RnJvbU1hdHJpeENvbHVtbiggb2JqZWN0TWF0cml4LCAxICk7IC8vIGdldCBZIGNvbHVtbiBvZiBvYmplY3RNYXRyaXhcblx0XHRcdHYubXVsdGlwbHlTY2FsYXIoIGRpc3RhbmNlICk7XG5cblx0XHRcdHBhbk9mZnNldC5hZGQoIHYgKTtcblxuXHRcdH07XG5cblx0fSgpO1xuXG5cdC8vIGRlbHRhWCBhbmQgZGVsdGFZIGFyZSBpbiBwaXhlbHM7IHJpZ2h0IGFuZCBkb3duIGFyZSBwb3NpdGl2ZVxuXHR2YXIgcGFuID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0dmFyIG9mZnNldCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHRyZXR1cm4gZnVuY3Rpb24gcGFuKCBkZWx0YVgsIGRlbHRhWSApIHtcblxuXHRcdFx0dmFyIGVsZW1lbnQgPSBzY29wZS5kb21FbGVtZW50ID09PSBkb2N1bWVudCA/IHNjb3BlLmRvbUVsZW1lbnQuYm9keSA6IHNjb3BlLmRvbUVsZW1lbnQ7XG5cblx0XHRcdGlmICggc2NvcGUub2JqZWN0LmlzUGVyc3BlY3RpdmVDYW1lcmEgKSB7XG5cblx0XHRcdFx0Ly8gcGVyc3BlY3RpdmVcblx0XHRcdFx0dmFyIHBvc2l0aW9uID0gc2NvcGUub2JqZWN0LnBvc2l0aW9uO1xuXHRcdFx0XHRvZmZzZXQuY29weSggcG9zaXRpb24gKS5zdWIoIHNjb3BlLnRhcmdldCApO1xuXHRcdFx0XHR2YXIgdGFyZ2V0RGlzdGFuY2UgPSBvZmZzZXQubGVuZ3RoKCk7XG5cblx0XHRcdFx0Ly8gaGFsZiBvZiB0aGUgZm92IGlzIGNlbnRlciB0byB0b3Agb2Ygc2NyZWVuXG5cdFx0XHRcdHRhcmdldERpc3RhbmNlICo9IE1hdGgudGFuKCAoIHNjb3BlLm9iamVjdC5mb3YgLyAyICkgKiBNYXRoLlBJIC8gMTgwLjAgKTtcblxuXHRcdFx0XHQvLyB3ZSBhY3R1YWxseSBkb24ndCB1c2Ugc2NyZWVuV2lkdGgsIHNpbmNlIHBlcnNwZWN0aXZlIGNhbWVyYSBpcyBmaXhlZCB0byBzY3JlZW4gaGVpZ2h0XG5cdFx0XHRcdHBhbkxlZnQoIDIgKiBkZWx0YVggKiB0YXJnZXREaXN0YW5jZSAvIGVsZW1lbnQuY2xpZW50SGVpZ2h0LCBzY29wZS5vYmplY3QubWF0cml4ICk7XG5cdFx0XHRcdHBhblVwKCAyICogZGVsdGFZICogdGFyZ2V0RGlzdGFuY2UgLyBlbGVtZW50LmNsaWVudEhlaWdodCwgc2NvcGUub2JqZWN0Lm1hdHJpeCApO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCBzY29wZS5vYmplY3QuaXNPcnRob2dyYXBoaWNDYW1lcmEgKSB7XG5cblx0XHRcdFx0Ly8gb3J0aG9ncmFwaGljXG5cdFx0XHRcdHBhbkxlZnQoIGRlbHRhWCAqICggc2NvcGUub2JqZWN0LnJpZ2h0IC0gc2NvcGUub2JqZWN0LmxlZnQgKSAvIHNjb3BlLm9iamVjdC56b29tIC8gZWxlbWVudC5jbGllbnRXaWR0aCwgc2NvcGUub2JqZWN0Lm1hdHJpeCApO1xuXHRcdFx0XHRwYW5VcCggZGVsdGFZICogKCBzY29wZS5vYmplY3QudG9wIC0gc2NvcGUub2JqZWN0LmJvdHRvbSApIC8gc2NvcGUub2JqZWN0Lnpvb20gLyBlbGVtZW50LmNsaWVudEhlaWdodCwgc2NvcGUub2JqZWN0Lm1hdHJpeCApO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdC8vIGNhbWVyYSBuZWl0aGVyIG9ydGhvZ3JhcGhpYyBub3IgcGVyc3BlY3RpdmVcblx0XHRcdFx0Y29uc29sZS53YXJuKCAnV0FSTklORzogT3JiaXRDb250cm9scy5qcyBlbmNvdW50ZXJlZCBhbiB1bmtub3duIGNhbWVyYSB0eXBlIC0gcGFuIGRpc2FibGVkLicgKTtcblx0XHRcdFx0c2NvcGUuZW5hYmxlUGFuID0gZmFsc2U7XG5cblx0XHRcdH1cblxuXHRcdH07XG5cblx0fSgpO1xuXG5cdGZ1bmN0aW9uIGRvbGx5SW4oIGRvbGx5U2NhbGUgKSB7XG5cblx0XHRpZiAoIHNjb3BlLm9iamVjdC5pc1BlcnNwZWN0aXZlQ2FtZXJhICkge1xuXG5cdFx0XHRzY2FsZSAvPSBkb2xseVNjYWxlO1xuXG5cdFx0fSBlbHNlIGlmICggc2NvcGUub2JqZWN0LmlzT3J0aG9ncmFwaGljQ2FtZXJhICkge1xuXG5cdFx0XHRzY29wZS5vYmplY3Quem9vbSA9IE1hdGgubWF4KCBzY29wZS5taW5ab29tLCBNYXRoLm1pbiggc2NvcGUubWF4Wm9vbSwgc2NvcGUub2JqZWN0Lnpvb20gKiBkb2xseVNjYWxlICkgKTtcblx0XHRcdHNjb3BlLm9iamVjdC51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG5cdFx0XHR6b29tQ2hhbmdlZCA9IHRydWU7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdXQVJOSU5HOiBPcmJpdENvbnRyb2xzLmpzIGVuY291bnRlcmVkIGFuIHVua25vd24gY2FtZXJhIHR5cGUgLSBkb2xseS96b29tIGRpc2FibGVkLicgKTtcblx0XHRcdHNjb3BlLmVuYWJsZVpvb20gPSBmYWxzZTtcblxuXHRcdH1cblxuXHR9XG5cblx0ZnVuY3Rpb24gZG9sbHlPdXQoIGRvbGx5U2NhbGUgKSB7XG5cblx0XHRpZiAoIHNjb3BlLm9iamVjdC5pc1BlcnNwZWN0aXZlQ2FtZXJhICkge1xuXG5cdFx0XHRzY2FsZSAqPSBkb2xseVNjYWxlO1xuXG5cdFx0fSBlbHNlIGlmICggc2NvcGUub2JqZWN0LmlzT3J0aG9ncmFwaGljQ2FtZXJhICkge1xuXG5cdFx0XHRzY29wZS5vYmplY3Quem9vbSA9IE1hdGgubWF4KCBzY29wZS5taW5ab29tLCBNYXRoLm1pbiggc2NvcGUubWF4Wm9vbSwgc2NvcGUub2JqZWN0Lnpvb20gLyBkb2xseVNjYWxlICkgKTtcblx0XHRcdHNjb3BlLm9iamVjdC51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG5cdFx0XHR6b29tQ2hhbmdlZCA9IHRydWU7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdXQVJOSU5HOiBPcmJpdENvbnRyb2xzLmpzIGVuY291bnRlcmVkIGFuIHVua25vd24gY2FtZXJhIHR5cGUgLSBkb2xseS96b29tIGRpc2FibGVkLicgKTtcblx0XHRcdHNjb3BlLmVuYWJsZVpvb20gPSBmYWxzZTtcblxuXHRcdH1cblxuXHR9XG5cblx0Ly9cblx0Ly8gZXZlbnQgY2FsbGJhY2tzIC0gdXBkYXRlIHRoZSBvYmplY3Qgc3RhdGVcblx0Ly9cblxuXHRmdW5jdGlvbiBoYW5kbGVNb3VzZURvd25Sb3RhdGUoIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZU1vdXNlRG93blJvdGF0ZScgKTtcblxuXHRcdHJvdGF0ZVN0YXJ0LnNldCggZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVNb3VzZURvd25Eb2xseSggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlTW91c2VEb3duRG9sbHknICk7XG5cblx0XHRkb2xseVN0YXJ0LnNldCggZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVNb3VzZURvd25QYW4oIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZU1vdXNlRG93blBhbicgKTtcblxuXHRcdHBhblN0YXJ0LnNldCggZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVNb3VzZU1vdmVSb3RhdGUoIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZU1vdXNlTW92ZVJvdGF0ZScgKTtcblxuXHRcdHJvdGF0ZUVuZC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcblx0XHRyb3RhdGVEZWx0YS5zdWJWZWN0b3JzKCByb3RhdGVFbmQsIHJvdGF0ZVN0YXJ0ICk7XG5cblx0XHR2YXIgZWxlbWVudCA9IHNjb3BlLmRvbUVsZW1lbnQgPT09IGRvY3VtZW50ID8gc2NvcGUuZG9tRWxlbWVudC5ib2R5IDogc2NvcGUuZG9tRWxlbWVudDtcblxuXHRcdC8vIHJvdGF0aW5nIGFjcm9zcyB3aG9sZSBzY3JlZW4gZ29lcyAzNjAgZGVncmVlcyBhcm91bmRcblx0XHRyb3RhdGVMZWZ0KCAyICogTWF0aC5QSSAqIHJvdGF0ZURlbHRhLnggLyBlbGVtZW50LmNsaWVudFdpZHRoICogc2NvcGUucm90YXRlU3BlZWQgKTtcblxuXHRcdC8vIHJvdGF0aW5nIHVwIGFuZCBkb3duIGFsb25nIHdob2xlIHNjcmVlbiBhdHRlbXB0cyB0byBnbyAzNjAsIGJ1dCBsaW1pdGVkIHRvIDE4MFxuXHRcdHJvdGF0ZVVwKCAyICogTWF0aC5QSSAqIHJvdGF0ZURlbHRhLnkgLyBlbGVtZW50LmNsaWVudEhlaWdodCAqIHNjb3BlLnJvdGF0ZVNwZWVkICk7XG5cblx0XHRyb3RhdGVTdGFydC5jb3B5KCByb3RhdGVFbmQgKTtcblxuXHRcdHNjb3BlLnVwZGF0ZSgpO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVNb3VzZU1vdmVEb2xseSggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlTW91c2VNb3ZlRG9sbHknICk7XG5cblx0XHRkb2xseUVuZC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcblxuXHRcdGRvbGx5RGVsdGEuc3ViVmVjdG9ycyggZG9sbHlFbmQsIGRvbGx5U3RhcnQgKTtcblxuXHRcdGlmICggZG9sbHlEZWx0YS55ID4gMCApIHtcblxuXHRcdFx0ZG9sbHlJbiggZ2V0Wm9vbVNjYWxlKCkgKTtcblxuXHRcdH0gZWxzZSBpZiAoIGRvbGx5RGVsdGEueSA8IDAgKSB7XG5cblx0XHRcdGRvbGx5T3V0KCBnZXRab29tU2NhbGUoKSApO1xuXG5cdFx0fVxuXG5cdFx0ZG9sbHlTdGFydC5jb3B5KCBkb2xseUVuZCApO1xuXG5cdFx0c2NvcGUudXBkYXRlKCk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZU1vdXNlTW92ZVBhbiggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlTW91c2VNb3ZlUGFuJyApO1xuXG5cdFx0cGFuRW5kLnNldCggZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSApO1xuXG5cdFx0cGFuRGVsdGEuc3ViVmVjdG9ycyggcGFuRW5kLCBwYW5TdGFydCApO1xuXG5cdFx0cGFuKCBwYW5EZWx0YS54LCBwYW5EZWx0YS55ICk7XG5cblx0XHRwYW5TdGFydC5jb3B5KCBwYW5FbmQgKTtcblxuXHRcdHNjb3BlLnVwZGF0ZSgpO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVNb3VzZVVwKCBldmVudCApIHtcblxuXHRcdC8vIGNvbnNvbGUubG9nKCAnaGFuZGxlTW91c2VVcCcgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlTW91c2VXaGVlbCggZXZlbnQgKSB7XG5cblx0XHQvLyBjb25zb2xlLmxvZyggJ2hhbmRsZU1vdXNlV2hlZWwnICk7XG5cblx0XHRpZiAoIGV2ZW50LmRlbHRhWSA8IDAgKSB7XG5cblx0XHRcdGRvbGx5T3V0KCBnZXRab29tU2NhbGUoKSApO1xuXG5cdFx0fSBlbHNlIGlmICggZXZlbnQuZGVsdGFZID4gMCApIHtcblxuXHRcdFx0ZG9sbHlJbiggZ2V0Wm9vbVNjYWxlKCkgKTtcblxuXHRcdH1cblxuXHRcdHNjb3BlLnVwZGF0ZSgpO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVLZXlEb3duKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVLZXlEb3duJyApO1xuXG5cdFx0c3dpdGNoICggZXZlbnQua2V5Q29kZSApIHtcblxuXHRcdFx0Y2FzZSBzY29wZS5rZXlzLlVQOlxuXHRcdFx0XHRwYW4oIDAsIHNjb3BlLmtleVBhblNwZWVkICk7XG5cdFx0XHRcdHNjb3BlLnVwZGF0ZSgpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBzY29wZS5rZXlzLkJPVFRPTTpcblx0XHRcdFx0cGFuKCAwLCAtIHNjb3BlLmtleVBhblNwZWVkICk7XG5cdFx0XHRcdHNjb3BlLnVwZGF0ZSgpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBzY29wZS5rZXlzLkxFRlQ6XG5cdFx0XHRcdHBhbiggc2NvcGUua2V5UGFuU3BlZWQsIDAgKTtcblx0XHRcdFx0c2NvcGUudXBkYXRlKCk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIHNjb3BlLmtleXMuUklHSFQ6XG5cdFx0XHRcdHBhbiggLSBzY29wZS5rZXlQYW5TcGVlZCwgMCApO1xuXHRcdFx0XHRzY29wZS51cGRhdGUoKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHR9XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZVRvdWNoU3RhcnRSb3RhdGUoIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZVRvdWNoU3RhcnRSb3RhdGUnICk7XG5cblx0XHRyb3RhdGVTdGFydC5zZXQoIGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWCwgZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VZICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZVRvdWNoU3RhcnREb2xseSggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlVG91Y2hTdGFydERvbGx5JyApO1xuXG5cdFx0dmFyIGR4ID0gZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VYIC0gZXZlbnQudG91Y2hlc1sgMSBdLnBhZ2VYO1xuXHRcdHZhciBkeSA9IGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWSAtIGV2ZW50LnRvdWNoZXNbIDEgXS5wYWdlWTtcblxuXHRcdHZhciBkaXN0YW5jZSA9IE1hdGguc3FydCggZHggKiBkeCArIGR5ICogZHkgKTtcblxuXHRcdGRvbGx5U3RhcnQuc2V0KCAwLCBkaXN0YW5jZSApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVUb3VjaFN0YXJ0UGFuKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVUb3VjaFN0YXJ0UGFuJyApO1xuXG5cdFx0cGFuU3RhcnQuc2V0KCBldmVudC50b3VjaGVzWyAwIF0ucGFnZVgsIGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWSApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVUb3VjaE1vdmVSb3RhdGUoIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZVRvdWNoTW92ZVJvdGF0ZScgKTtcblxuXHRcdHJvdGF0ZUVuZC5zZXQoIGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWCwgZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VZICk7XG5cdFx0cm90YXRlRGVsdGEuc3ViVmVjdG9ycyggcm90YXRlRW5kLCByb3RhdGVTdGFydCApO1xuXG5cdFx0dmFyIGVsZW1lbnQgPSBzY29wZS5kb21FbGVtZW50ID09PSBkb2N1bWVudCA/IHNjb3BlLmRvbUVsZW1lbnQuYm9keSA6IHNjb3BlLmRvbUVsZW1lbnQ7XG5cblx0XHQvLyByb3RhdGluZyBhY3Jvc3Mgd2hvbGUgc2NyZWVuIGdvZXMgMzYwIGRlZ3JlZXMgYXJvdW5kXG5cdFx0cm90YXRlTGVmdCggMiAqIE1hdGguUEkgKiByb3RhdGVEZWx0YS54IC8gZWxlbWVudC5jbGllbnRXaWR0aCAqIHNjb3BlLnJvdGF0ZVNwZWVkICk7XG5cblx0XHQvLyByb3RhdGluZyB1cCBhbmQgZG93biBhbG9uZyB3aG9sZSBzY3JlZW4gYXR0ZW1wdHMgdG8gZ28gMzYwLCBidXQgbGltaXRlZCB0byAxODBcblx0XHRyb3RhdGVVcCggMiAqIE1hdGguUEkgKiByb3RhdGVEZWx0YS55IC8gZWxlbWVudC5jbGllbnRIZWlnaHQgKiBzY29wZS5yb3RhdGVTcGVlZCApO1xuXG5cdFx0cm90YXRlU3RhcnQuY29weSggcm90YXRlRW5kICk7XG5cblx0XHRzY29wZS51cGRhdGUoKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlVG91Y2hNb3ZlRG9sbHkoIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZVRvdWNoTW92ZURvbGx5JyApO1xuXG5cdFx0dmFyIGR4ID0gZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VYIC0gZXZlbnQudG91Y2hlc1sgMSBdLnBhZ2VYO1xuXHRcdHZhciBkeSA9IGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWSAtIGV2ZW50LnRvdWNoZXNbIDEgXS5wYWdlWTtcblxuXHRcdHZhciBkaXN0YW5jZSA9IE1hdGguc3FydCggZHggKiBkeCArIGR5ICogZHkgKTtcblxuXHRcdGRvbGx5RW5kLnNldCggMCwgZGlzdGFuY2UgKTtcblxuXHRcdGRvbGx5RGVsdGEuc3ViVmVjdG9ycyggZG9sbHlFbmQsIGRvbGx5U3RhcnQgKTtcblxuXHRcdGlmICggZG9sbHlEZWx0YS55ID4gMCApIHtcblxuXHRcdFx0ZG9sbHlPdXQoIGdldFpvb21TY2FsZSgpICk7XG5cblx0XHR9IGVsc2UgaWYgKCBkb2xseURlbHRhLnkgPCAwICkge1xuXG5cdFx0XHRkb2xseUluKCBnZXRab29tU2NhbGUoKSApO1xuXG5cdFx0fVxuXG5cdFx0ZG9sbHlTdGFydC5jb3B5KCBkb2xseUVuZCApO1xuXG5cdFx0c2NvcGUudXBkYXRlKCk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZVRvdWNoTW92ZVBhbiggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlVG91Y2hNb3ZlUGFuJyApO1xuXG5cdFx0cGFuRW5kLnNldCggZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VYLCBldmVudC50b3VjaGVzWyAwIF0ucGFnZVkgKTtcblxuXHRcdHBhbkRlbHRhLnN1YlZlY3RvcnMoIHBhbkVuZCwgcGFuU3RhcnQgKTtcblxuXHRcdHBhbiggcGFuRGVsdGEueCwgcGFuRGVsdGEueSApO1xuXG5cdFx0cGFuU3RhcnQuY29weSggcGFuRW5kICk7XG5cblx0XHRzY29wZS51cGRhdGUoKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlVG91Y2hFbmQoIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZVRvdWNoRW5kJyApO1xuXG5cdH1cblxuXHQvL1xuXHQvLyBldmVudCBoYW5kbGVycyAtIEZTTTogbGlzdGVuIGZvciBldmVudHMgYW5kIHJlc2V0IHN0YXRlXG5cdC8vXG5cblx0ZnVuY3Rpb24gb25Nb3VzZURvd24oIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRzd2l0Y2ggKCBldmVudC5idXR0b24gKSB7XG5cblx0XHRcdGNhc2Ugc2NvcGUubW91c2VCdXR0b25zLk9SQklUOlxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlUm90YXRlID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRoYW5kbGVNb3VzZURvd25Sb3RhdGUoIGV2ZW50ICk7XG5cblx0XHRcdFx0c3RhdGUgPSBTVEFURS5ST1RBVEU7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2Ugc2NvcGUubW91c2VCdXR0b25zLlpPT006XG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVab29tID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRoYW5kbGVNb3VzZURvd25Eb2xseSggZXZlbnQgKTtcblxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLkRPTExZO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIHNjb3BlLm1vdXNlQnV0dG9ucy5QQU46XG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGhhbmRsZU1vdXNlRG93blBhbiggZXZlbnQgKTtcblxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLlBBTjtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdH1cblxuXHRcdGlmICggc3RhdGUgIT09IFNUQVRFLk5PTkUgKSB7XG5cblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSwgZmFsc2UgKTtcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZXVwJywgb25Nb3VzZVVwLCBmYWxzZSApO1xuXG5cdFx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCBzdGFydEV2ZW50ICk7XG5cblx0XHR9XG5cblx0fVxuXG5cdGZ1bmN0aW9uIG9uTW91c2VNb3ZlKCBldmVudCApIHtcblxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0c3dpdGNoICggc3RhdGUgKSB7XG5cblx0XHRcdGNhc2UgU1RBVEUuUk9UQVRFOlxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlUm90YXRlID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRoYW5kbGVNb3VzZU1vdmVSb3RhdGUoIGV2ZW50ICk7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgU1RBVEUuRE9MTFk6XG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVab29tID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRoYW5kbGVNb3VzZU1vdmVEb2xseSggZXZlbnQgKTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBTVEFURS5QQU46XG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGhhbmRsZU1vdXNlTW92ZVBhbiggZXZlbnQgKTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdH1cblxuXHR9XG5cblx0ZnVuY3Rpb24gb25Nb3VzZVVwKCBldmVudCApIHtcblxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRoYW5kbGVNb3VzZVVwKCBldmVudCApO1xuXG5cdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlLCBmYWxzZSApO1xuXHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZXVwJywgb25Nb3VzZVVwLCBmYWxzZSApO1xuXG5cdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggZW5kRXZlbnQgKTtcblxuXHRcdHN0YXRlID0gU1RBVEUuTk9ORTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gb25Nb3VzZVdoZWVsKCBldmVudCApIHtcblxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgfHwgc2NvcGUuZW5hYmxlWm9vbSA9PT0gZmFsc2UgfHwgKCBzdGF0ZSAhPT0gU1RBVEUuTk9ORSAmJiBzdGF0ZSAhPT0gU1RBVEUuUk9UQVRFICkgKSByZXR1cm47XG5cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggc3RhcnRFdmVudCApO1xuXG5cdFx0aGFuZGxlTW91c2VXaGVlbCggZXZlbnQgKTtcblxuXHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIGVuZEV2ZW50ICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIG9uS2V5RG93biggZXZlbnQgKSB7XG5cblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlIHx8IHNjb3BlLmVuYWJsZUtleXMgPT09IGZhbHNlIHx8IHNjb3BlLmVuYWJsZVBhbiA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRoYW5kbGVLZXlEb3duKCBldmVudCApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBvblRvdWNoU3RhcnQoIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdHN3aXRjaCAoIGV2ZW50LnRvdWNoZXMubGVuZ3RoICkge1xuXG5cdFx0XHRjYXNlIDE6XHQvLyBvbmUtZmluZ2VyZWQgdG91Y2g6IHJvdGF0ZVxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlUm90YXRlID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRoYW5kbGVUb3VjaFN0YXJ0Um90YXRlKCBldmVudCApO1xuXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuVE9VQ0hfUk9UQVRFO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDI6XHQvLyB0d28tZmluZ2VyZWQgdG91Y2g6IGRvbGx5XG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVab29tID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRoYW5kbGVUb3VjaFN0YXJ0RG9sbHkoIGV2ZW50ICk7XG5cblx0XHRcdFx0c3RhdGUgPSBTVEFURS5UT1VDSF9ET0xMWTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAzOiAvLyB0aHJlZS1maW5nZXJlZCB0b3VjaDogcGFuXG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVQYW4gPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGhhbmRsZVRvdWNoU3RhcnRQYW4oIGV2ZW50ICk7XG5cblx0XHRcdFx0c3RhdGUgPSBTVEFURS5UT1VDSF9QQU47XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGRlZmF1bHQ6XG5cblx0XHRcdFx0c3RhdGUgPSBTVEFURS5OT05FO1xuXG5cdFx0fVxuXG5cdFx0aWYgKCBzdGF0ZSAhPT0gU1RBVEUuTk9ORSApIHtcblxuXHRcdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggc3RhcnRFdmVudCApO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRmdW5jdGlvbiBvblRvdWNoTW92ZSggZXZlbnQgKSB7XG5cblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdHN3aXRjaCAoIGV2ZW50LnRvdWNoZXMubGVuZ3RoICkge1xuXG5cdFx0XHRjYXNlIDE6IC8vIG9uZS1maW5nZXJlZCB0b3VjaDogcm90YXRlXG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVSb3RhdGUgPT09IGZhbHNlICkgcmV0dXJuO1xuXHRcdFx0XHRpZiAoIHN0YXRlICE9PSBTVEFURS5UT1VDSF9ST1RBVEUgKSByZXR1cm47IC8vIGlzIHRoaXMgbmVlZGVkPy4uLlxuXG5cdFx0XHRcdGhhbmRsZVRvdWNoTW92ZVJvdGF0ZSggZXZlbnQgKTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAyOiAvLyB0d28tZmluZ2VyZWQgdG91Y2g6IGRvbGx5XG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVab29tID09PSBmYWxzZSApIHJldHVybjtcblx0XHRcdFx0aWYgKCBzdGF0ZSAhPT0gU1RBVEUuVE9VQ0hfRE9MTFkgKSByZXR1cm47IC8vIGlzIHRoaXMgbmVlZGVkPy4uLlxuXG5cdFx0XHRcdGhhbmRsZVRvdWNoTW92ZURvbGx5KCBldmVudCApO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDM6IC8vIHRocmVlLWZpbmdlcmVkIHRvdWNoOiBwYW5cblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVBhbiA9PT0gZmFsc2UgKSByZXR1cm47XG5cdFx0XHRcdGlmICggc3RhdGUgIT09IFNUQVRFLlRPVUNIX1BBTiApIHJldHVybjsgLy8gaXMgdGhpcyBuZWVkZWQ/Li4uXG5cblx0XHRcdFx0aGFuZGxlVG91Y2hNb3ZlUGFuKCBldmVudCApO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRkZWZhdWx0OlxuXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuTk9ORTtcblxuXHRcdH1cblxuXHR9XG5cblx0ZnVuY3Rpb24gb25Ub3VjaEVuZCggZXZlbnQgKSB7XG5cblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0aGFuZGxlVG91Y2hFbmQoIGV2ZW50ICk7XG5cblx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCBlbmRFdmVudCApO1xuXG5cdFx0c3RhdGUgPSBTVEFURS5OT05FO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBvbkNvbnRleHRNZW51KCBldmVudCApIHtcblxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdH1cblxuXHQvL1xuXG5cdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2NvbnRleHRtZW51Jywgb25Db250ZXh0TWVudSwgZmFsc2UgKTtcblxuXHRzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZWRvd24nLCBvbk1vdXNlRG93biwgZmFsc2UgKTtcblx0c2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnd2hlZWwnLCBvbk1vdXNlV2hlZWwsIGZhbHNlICk7XG5cblx0c2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAndG91Y2hzdGFydCcsIG9uVG91Y2hTdGFydCwgZmFsc2UgKTtcblx0c2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAndG91Y2hlbmQnLCBvblRvdWNoRW5kLCBmYWxzZSApO1xuXHRzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaG1vdmUnLCBvblRvdWNoTW92ZSwgZmFsc2UgKTtcblxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBvbktleURvd24sIGZhbHNlICk7XG5cblx0Ly8gZm9yY2UgYW4gdXBkYXRlIGF0IHN0YXJ0XG5cblx0dGhpcy51cGRhdGUoKTtcblxufTtcblxuVEhSRUUuT3JiaXRDb250cm9scy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBUSFJFRS5FdmVudERpc3BhdGNoZXIucHJvdG90eXBlICk7XG5USFJFRS5PcmJpdENvbnRyb2xzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFRIUkVFLk9yYml0Q29udHJvbHM7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKCBUSFJFRS5PcmJpdENvbnRyb2xzLnByb3RvdHlwZSwge1xuXG5cdGNlbnRlcjoge1xuXG5cdFx0Z2V0OiBmdW5jdGlvbiAoKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5jZW50ZXIgaGFzIGJlZW4gcmVuYW1lZCB0byAudGFyZ2V0JyApO1xuXHRcdFx0cmV0dXJuIHRoaXMudGFyZ2V0O1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0Ly8gYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuXG5cdG5vWm9vbToge1xuXG5cdFx0Z2V0OiBmdW5jdGlvbiAoKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5ub1pvb20gaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVab29tIGluc3RlYWQuJyApO1xuXHRcdFx0cmV0dXJuICEgdGhpcy5lbmFibGVab29tO1xuXG5cdFx0fSxcblxuXHRcdHNldDogZnVuY3Rpb24gKCB2YWx1ZSApIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLm5vWm9vbSBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZVpvb20gaW5zdGVhZC4nICk7XG5cdFx0XHR0aGlzLmVuYWJsZVpvb20gPSAhIHZhbHVlO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0bm9Sb3RhdGU6IHtcblxuXHRcdGdldDogZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAubm9Sb3RhdGUgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVSb3RhdGUgaW5zdGVhZC4nICk7XG5cdFx0XHRyZXR1cm4gISB0aGlzLmVuYWJsZVJvdGF0ZTtcblxuXHRcdH0sXG5cblx0XHRzZXQ6IGZ1bmN0aW9uICggdmFsdWUgKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5ub1JvdGF0ZSBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZVJvdGF0ZSBpbnN0ZWFkLicgKTtcblx0XHRcdHRoaXMuZW5hYmxlUm90YXRlID0gISB2YWx1ZTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdG5vUGFuOiB7XG5cblx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLm5vUGFuIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlUGFuIGluc3RlYWQuJyApO1xuXHRcdFx0cmV0dXJuICEgdGhpcy5lbmFibGVQYW47XG5cblx0XHR9LFxuXG5cdFx0c2V0OiBmdW5jdGlvbiAoIHZhbHVlICkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAubm9QYW4gaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVQYW4gaW5zdGVhZC4nICk7XG5cdFx0XHR0aGlzLmVuYWJsZVBhbiA9ICEgdmFsdWU7XG5cblx0XHR9XG5cblx0fSxcblxuXHRub0tleXM6IHtcblxuXHRcdGdldDogZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAubm9LZXlzIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlS2V5cyBpbnN0ZWFkLicgKTtcblx0XHRcdHJldHVybiAhIHRoaXMuZW5hYmxlS2V5cztcblxuXHRcdH0sXG5cblx0XHRzZXQ6IGZ1bmN0aW9uICggdmFsdWUgKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5ub0tleXMgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVLZXlzIGluc3RlYWQuJyApO1xuXHRcdFx0dGhpcy5lbmFibGVLZXlzID0gISB2YWx1ZTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdHN0YXRpY01vdmluZzoge1xuXG5cdFx0Z2V0OiBmdW5jdGlvbiAoKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5zdGF0aWNNb3ZpbmcgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVEYW1waW5nIGluc3RlYWQuJyApO1xuXHRcdFx0cmV0dXJuICEgdGhpcy5lbmFibGVEYW1waW5nO1xuXG5cdFx0fSxcblxuXHRcdHNldDogZnVuY3Rpb24gKCB2YWx1ZSApIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLnN0YXRpY01vdmluZyBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZURhbXBpbmcgaW5zdGVhZC4nICk7XG5cdFx0XHR0aGlzLmVuYWJsZURhbXBpbmcgPSAhIHZhbHVlO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0ZHluYW1pY0RhbXBpbmdGYWN0b3I6IHtcblxuXHRcdGdldDogZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAuZHluYW1pY0RhbXBpbmdGYWN0b3IgaGFzIGJlZW4gcmVuYW1lZC4gVXNlIC5kYW1waW5nRmFjdG9yIGluc3RlYWQuJyApO1xuXHRcdFx0cmV0dXJuIHRoaXMuZGFtcGluZ0ZhY3RvcjtcblxuXHRcdH0sXG5cblx0XHRzZXQ6IGZ1bmN0aW9uICggdmFsdWUgKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5keW5hbWljRGFtcGluZ0ZhY3RvciBoYXMgYmVlbiByZW5hbWVkLiBVc2UgLmRhbXBpbmdGYWN0b3IgaW5zdGVhZC4nICk7XG5cdFx0XHR0aGlzLmRhbXBpbmdGYWN0b3IgPSB2YWx1ZTtcblxuXHRcdH1cblxuXHR9XG5cbn0gKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtb3JiaXQtY29udHJvbHMvbGliL09yYml0Q29udHJvbHMuanNcbi8vIG1vZHVsZSBpZCA9IDQyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gQWxnb2xpYVNlYXJjaENvcmU7XG5cbnZhciBlcnJvcnMgPSByZXF1aXJlKCcuL2Vycm9ycycpO1xudmFyIGV4aXRQcm9taXNlID0gcmVxdWlyZSgnLi9leGl0UHJvbWlzZS5qcycpO1xudmFyIEluZGV4Q29yZSA9IHJlcXVpcmUoJy4vSW5kZXhDb3JlLmpzJyk7XG52YXIgc3RvcmUgPSByZXF1aXJlKCcuL3N0b3JlLmpzJyk7XG5cbi8vIFdlIHdpbGwgYWx3YXlzIHB1dCB0aGUgQVBJIEtFWSBpbiB0aGUgSlNPTiBib2R5IGluIGNhc2Ugb2YgdG9vIGxvbmcgQVBJIEtFWSxcbi8vIHRvIGF2b2lkIHF1ZXJ5IHN0cmluZyBiZWluZyB0b28gbG9uZyBhbmQgZmFpbGluZyBpbiB2YXJpb3VzIGNvbmRpdGlvbnMgKG91ciBzZXJ2ZXIgbGltaXQsIGJyb3dzZXIgbGltaXQsXG4vLyBwcm94aWVzIGxpbWl0KVxudmFyIE1BWF9BUElfS0VZX0xFTkdUSCA9IDUwMDtcbnZhciBSRVNFVF9BUFBfREFUQV9USU1FUiA9XG4gIHByb2Nlc3MuZW52LlJFU0VUX0FQUF9EQVRBX1RJTUVSICYmIHBhcnNlSW50KHByb2Nlc3MuZW52LlJFU0VUX0FQUF9EQVRBX1RJTUVSLCAxMCkgfHxcbiAgNjAgKiAyICogMTAwMDsgLy8gYWZ0ZXIgMiBtaW51dGVzIHJlc2V0IHRvIGZpcnN0IGhvc3RcblxuLypcbiAqIEFsZ29saWEgU2VhcmNoIGxpYnJhcnkgaW5pdGlhbGl6YXRpb25cbiAqIGh0dHBzOi8vd3d3LmFsZ29saWEuY29tL1xuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBsaWNhdGlvbklEIC0gWW91ciBhcHBsaWNhdGlvbklELCBmb3VuZCBpbiB5b3VyIGRhc2hib2FyZFxuICogQHBhcmFtIHtzdHJpbmd9IGFwaUtleSAtIFlvdXIgQVBJIGtleSwgZm91bmQgaW4geW91ciBkYXNoYm9hcmRcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0c11cbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0cy50aW1lb3V0PTIwMDBdIC0gVGhlIHJlcXVlc3QgdGltZW91dCBzZXQgaW4gbWlsbGlzZWNvbmRzLFxuICogYW5vdGhlciByZXF1ZXN0IHdpbGwgYmUgaXNzdWVkIGFmdGVyIHRoaXMgdGltZW91dFxuICogQHBhcmFtIHtzdHJpbmd9IFtvcHRzLnByb3RvY29sPSdodHRwczonXSAtIFRoZSBwcm90b2NvbCB1c2VkIHRvIHF1ZXJ5IEFsZ29saWEgU2VhcmNoIEFQSS5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldCB0byAnaHR0cDonIHRvIGZvcmNlIHVzaW5nIGh0dHAuXG4gKiBAcGFyYW0ge09iamVjdHxBcnJheX0gW29wdHMuaG9zdHM9e1xuICogICAgICAgICAgIHJlYWQ6IFt0aGlzLmFwcGxpY2F0aW9uSUQgKyAnLWRzbi5hbGdvbGlhLm5ldCddLmNvbmNhdChbXG4gKiAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uSUQgKyAnLTEuYWxnb2xpYW5ldC5jb20nLFxuICogICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbklEICsgJy0yLmFsZ29saWFuZXQuY29tJyxcbiAqICAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25JRCArICctMy5hbGdvbGlhbmV0LmNvbSddXG4gKiAgICAgICAgICAgXSksXG4gKiAgICAgICAgICAgd3JpdGU6IFt0aGlzLmFwcGxpY2F0aW9uSUQgKyAnLmFsZ29saWEubmV0J10uY29uY2F0KFtcbiAqICAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25JRCArICctMS5hbGdvbGlhbmV0LmNvbScsXG4gKiAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uSUQgKyAnLTIuYWxnb2xpYW5ldC5jb20nLFxuICogICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbklEICsgJy0zLmFsZ29saWFuZXQuY29tJ11cbiAqICAgICAgICAgICBdKSAtIFRoZSBob3N0cyB0byB1c2UgZm9yIEFsZ29saWEgU2VhcmNoIEFQSS5cbiAqICAgICAgICAgICBJZiB5b3UgcHJvdmlkZSB0aGVtLCB5b3Ugd2lsbCBsZXNzIGJlbmVmaXQgZnJvbSBvdXIgSEEgaW1wbGVtZW50YXRpb25cbiAqL1xuZnVuY3Rpb24gQWxnb2xpYVNlYXJjaENvcmUoYXBwbGljYXRpb25JRCwgYXBpS2V5LCBvcHRzKSB7XG4gIHZhciBkZWJ1ZyA9IHJlcXVpcmUoJ2RlYnVnJykoJ2FsZ29saWFzZWFyY2gnKTtcblxuICB2YXIgY2xvbmUgPSByZXF1aXJlKCcuL2Nsb25lLmpzJyk7XG4gIHZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXNhcnJheScpO1xuICB2YXIgbWFwID0gcmVxdWlyZSgnLi9tYXAuanMnKTtcblxuICB2YXIgdXNhZ2UgPSAnVXNhZ2U6IGFsZ29saWFzZWFyY2goYXBwbGljYXRpb25JRCwgYXBpS2V5LCBvcHRzKSc7XG5cbiAgaWYgKG9wdHMuX2FsbG93RW1wdHlDcmVkZW50aWFscyAhPT0gdHJ1ZSAmJiAhYXBwbGljYXRpb25JRCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuQWxnb2xpYVNlYXJjaEVycm9yKCdQbGVhc2UgcHJvdmlkZSBhbiBhcHBsaWNhdGlvbiBJRC4gJyArIHVzYWdlKTtcbiAgfVxuXG4gIGlmIChvcHRzLl9hbGxvd0VtcHR5Q3JlZGVudGlhbHMgIT09IHRydWUgJiYgIWFwaUtleSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuQWxnb2xpYVNlYXJjaEVycm9yKCdQbGVhc2UgcHJvdmlkZSBhbiBBUEkga2V5LiAnICsgdXNhZ2UpO1xuICB9XG5cbiAgdGhpcy5hcHBsaWNhdGlvbklEID0gYXBwbGljYXRpb25JRDtcbiAgdGhpcy5hcGlLZXkgPSBhcGlLZXk7XG5cbiAgdGhpcy5ob3N0cyA9IHtcbiAgICByZWFkOiBbXSxcbiAgICB3cml0ZTogW11cbiAgfTtcblxuICBvcHRzID0gb3B0cyB8fCB7fTtcblxuICB0aGlzLl90aW1lb3V0cyA9IG9wdHMudGltZW91dHMgfHwge1xuICAgIGNvbm5lY3Q6IDEgKiAxMDAwLCAvLyA1MDBtcyBjb25uZWN0IGlzIEdQUlMgbGF0ZW5jeVxuICAgIHJlYWQ6IDIgKiAxMDAwLFxuICAgIHdyaXRlOiAzMCAqIDEwMDBcbiAgfTtcblxuICAvLyBiYWNrd2FyZCBjb21wYXQsIGlmIG9wdHMudGltZW91dCBpcyBwYXNzZWQsIHdlIHVzZSBpdCB0byBjb25maWd1cmUgYWxsIHRpbWVvdXRzIGxpa2UgYmVmb3JlXG4gIGlmIChvcHRzLnRpbWVvdXQpIHtcbiAgICB0aGlzLl90aW1lb3V0cy5jb25uZWN0ID0gdGhpcy5fdGltZW91dHMucmVhZCA9IHRoaXMuX3RpbWVvdXRzLndyaXRlID0gb3B0cy50aW1lb3V0O1xuICB9XG5cbiAgdmFyIHByb3RvY29sID0gb3B0cy5wcm90b2NvbCB8fCAnaHR0cHM6JztcbiAgLy8gd2hpbGUgd2UgYWR2b2NhdGUgZm9yIGNvbG9uLWF0LXRoZS1lbmQgdmFsdWVzOiAnaHR0cDonIGZvciBgb3B0cy5wcm90b2NvbGBcbiAgLy8gd2UgYWxzbyBhY2NlcHQgYGh0dHBgIGFuZCBgaHR0cHNgLiBJdCdzIGEgY29tbW9uIGVycm9yLlxuICBpZiAoIS86JC8udGVzdChwcm90b2NvbCkpIHtcbiAgICBwcm90b2NvbCA9IHByb3RvY29sICsgJzonO1xuICB9XG5cbiAgaWYgKHByb3RvY29sICE9PSAnaHR0cDonICYmIHByb3RvY29sICE9PSAnaHR0cHM6Jykge1xuICAgIHRocm93IG5ldyBlcnJvcnMuQWxnb2xpYVNlYXJjaEVycm9yKCdwcm90b2NvbCBtdXN0IGJlIGBodHRwOmAgb3IgYGh0dHBzOmAgKHdhcyBgJyArIG9wdHMucHJvdG9jb2wgKyAnYCknKTtcbiAgfVxuXG4gIHRoaXMuX2NoZWNrQXBwSWREYXRhKCk7XG5cbiAgaWYgKCFvcHRzLmhvc3RzKSB7XG4gICAgdmFyIGRlZmF1bHRIb3N0cyA9IG1hcCh0aGlzLl9zaHVmZmxlUmVzdWx0LCBmdW5jdGlvbihob3N0TnVtYmVyKSB7XG4gICAgICByZXR1cm4gYXBwbGljYXRpb25JRCArICctJyArIGhvc3ROdW1iZXIgKyAnLmFsZ29saWFuZXQuY29tJztcbiAgICB9KTtcblxuICAgIC8vIG5vIGhvc3RzIGdpdmVuLCBjb21wdXRlIGRlZmF1bHRzXG4gICAgdmFyIG1haW5TdWZmaXggPSAob3B0cy5kc24gPT09IGZhbHNlID8gJycgOiAnLWRzbicpICsgJy5hbGdvbGlhLm5ldCc7XG4gICAgdGhpcy5ob3N0cy5yZWFkID0gW3RoaXMuYXBwbGljYXRpb25JRCArIG1haW5TdWZmaXhdLmNvbmNhdChkZWZhdWx0SG9zdHMpO1xuICAgIHRoaXMuaG9zdHMud3JpdGUgPSBbdGhpcy5hcHBsaWNhdGlvbklEICsgJy5hbGdvbGlhLm5ldCddLmNvbmNhdChkZWZhdWx0SG9zdHMpO1xuICB9IGVsc2UgaWYgKGlzQXJyYXkob3B0cy5ob3N0cykpIHtcbiAgICAvLyB3aGVuIHBhc3NpbmcgY3VzdG9tIGhvc3RzLCB3ZSBuZWVkIHRvIGhhdmUgYSBkaWZmZXJlbnQgaG9zdCBpbmRleCBpZiB0aGUgbnVtYmVyXG4gICAgLy8gb2Ygd3JpdGUvcmVhZCBob3N0cyBhcmUgZGlmZmVyZW50LlxuICAgIHRoaXMuaG9zdHMucmVhZCA9IGNsb25lKG9wdHMuaG9zdHMpO1xuICAgIHRoaXMuaG9zdHMud3JpdGUgPSBjbG9uZShvcHRzLmhvc3RzKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmhvc3RzLnJlYWQgPSBjbG9uZShvcHRzLmhvc3RzLnJlYWQpO1xuICAgIHRoaXMuaG9zdHMud3JpdGUgPSBjbG9uZShvcHRzLmhvc3RzLndyaXRlKTtcbiAgfVxuXG4gIC8vIGFkZCBwcm90b2NvbCBhbmQgbG93ZXJjYXNlIGhvc3RzXG4gIHRoaXMuaG9zdHMucmVhZCA9IG1hcCh0aGlzLmhvc3RzLnJlYWQsIHByZXBhcmVIb3N0KHByb3RvY29sKSk7XG4gIHRoaXMuaG9zdHMud3JpdGUgPSBtYXAodGhpcy5ob3N0cy53cml0ZSwgcHJlcGFyZUhvc3QocHJvdG9jb2wpKTtcblxuICB0aGlzLmV4dHJhSGVhZGVycyA9IHt9O1xuXG4gIC8vIEluIHNvbWUgc2l0dWF0aW9ucyB5b3UgbWlnaHQgd2FudCB0byB3YXJtIHRoZSBjYWNoZVxuICB0aGlzLmNhY2hlID0gb3B0cy5fY2FjaGUgfHwge307XG5cbiAgdGhpcy5fdWEgPSBvcHRzLl91YTtcbiAgdGhpcy5fdXNlQ2FjaGUgPSBvcHRzLl91c2VDYWNoZSA9PT0gdW5kZWZpbmVkIHx8IG9wdHMuX2NhY2hlID8gdHJ1ZSA6IG9wdHMuX3VzZUNhY2hlO1xuICB0aGlzLl91c2VSZXF1ZXN0Q2FjaGUgPSB0aGlzLl91c2VDYWNoZSAmJiBvcHRzLl91c2VSZXF1ZXN0Q2FjaGU7XG4gIHRoaXMuX3VzZUZhbGxiYWNrID0gb3B0cy51c2VGYWxsYmFjayA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IG9wdHMudXNlRmFsbGJhY2s7XG5cbiAgdGhpcy5fc2V0VGltZW91dCA9IG9wdHMuX3NldFRpbWVvdXQ7XG5cbiAgZGVidWcoJ2luaXQgZG9uZSwgJWonLCB0aGlzKTtcbn1cblxuLypcbiAqIEdldCB0aGUgaW5kZXggb2JqZWN0IGluaXRpYWxpemVkXG4gKlxuICogQHBhcmFtIGluZGV4TmFtZSB0aGUgbmFtZSBvZiBpbmRleFxuICogQHBhcmFtIGNhbGxiYWNrIHRoZSByZXN1bHQgY2FsbGJhY2sgd2l0aCBvbmUgYXJndW1lbnQgKHRoZSBJbmRleCBpbnN0YW5jZSlcbiAqL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLmluaXRJbmRleCA9IGZ1bmN0aW9uKGluZGV4TmFtZSkge1xuICByZXR1cm4gbmV3IEluZGV4Q29yZSh0aGlzLCBpbmRleE5hbWUpO1xufTtcblxuLyoqXG4qIEFkZCBhbiBleHRyYSBmaWVsZCB0byB0aGUgSFRUUCByZXF1ZXN0XG4qXG4qIEBwYXJhbSBuYW1lIHRoZSBoZWFkZXIgZmllbGQgbmFtZVxuKiBAcGFyYW0gdmFsdWUgdGhlIGhlYWRlciBmaWVsZCB2YWx1ZVxuKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5zZXRFeHRyYUhlYWRlciA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIHRoaXMuZXh0cmFIZWFkZXJzW25hbWUudG9Mb3dlckNhc2UoKV0gPSB2YWx1ZTtcbn07XG5cbi8qKlxuKiBHZXQgdGhlIHZhbHVlIG9mIGFuIGV4dHJhIEhUVFAgaGVhZGVyXG4qXG4qIEBwYXJhbSBuYW1lIHRoZSBoZWFkZXIgZmllbGQgbmFtZVxuKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5nZXRFeHRyYUhlYWRlciA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgcmV0dXJuIHRoaXMuZXh0cmFIZWFkZXJzW25hbWUudG9Mb3dlckNhc2UoKV07XG59O1xuXG4vKipcbiogUmVtb3ZlIGFuIGV4dHJhIGZpZWxkIGZyb20gdGhlIEhUVFAgcmVxdWVzdFxuKlxuKiBAcGFyYW0gbmFtZSB0aGUgaGVhZGVyIGZpZWxkIG5hbWVcbiovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUudW5zZXRFeHRyYUhlYWRlciA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgZGVsZXRlIHRoaXMuZXh0cmFIZWFkZXJzW25hbWUudG9Mb3dlckNhc2UoKV07XG59O1xuXG4vKipcbiogQXVnbWVudCBzZW50IHgtYWxnb2xpYS1hZ2VudCB3aXRoIG1vcmUgZGF0YSwgZWFjaCBhZ2VudCBwYXJ0XG4qIGlzIGF1dG9tYXRpY2FsbHkgc2VwYXJhdGVkIGZyb20gdGhlIG90aGVycyBieSBhIHNlbWljb2xvbjtcbipcbiogQHBhcmFtIGFsZ29saWFBZ2VudCB0aGUgYWdlbnQgdG8gYWRkXG4qL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLmFkZEFsZ29saWFBZ2VudCA9IGZ1bmN0aW9uKGFsZ29saWFBZ2VudCkge1xuICBpZiAodGhpcy5fdWEuaW5kZXhPZignOycgKyBhbGdvbGlhQWdlbnQpID09PSAtMSkge1xuICAgIHRoaXMuX3VhICs9ICc7JyArIGFsZ29saWFBZ2VudDtcbiAgfVxufTtcblxuLypcbiAqIFdyYXBwZXIgdGhhdCB0cnkgYWxsIGhvc3RzIHRvIG1heGltaXplIHRoZSBxdWFsaXR5IG9mIHNlcnZpY2VcbiAqL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9qc29uUmVxdWVzdCA9IGZ1bmN0aW9uKGluaXRpYWxPcHRzKSB7XG4gIHRoaXMuX2NoZWNrQXBwSWREYXRhKCk7XG5cbiAgdmFyIHJlcXVlc3REZWJ1ZyA9IHJlcXVpcmUoJ2RlYnVnJykoJ2FsZ29saWFzZWFyY2g6JyArIGluaXRpYWxPcHRzLnVybCk7XG5cblxuICB2YXIgYm9keTtcbiAgdmFyIGNhY2hlSUQ7XG4gIHZhciBhZGRpdGlvbmFsVUEgPSBpbml0aWFsT3B0cy5hZGRpdGlvbmFsVUEgfHwgJyc7XG4gIHZhciBjYWNoZSA9IGluaXRpYWxPcHRzLmNhY2hlO1xuICB2YXIgY2xpZW50ID0gdGhpcztcbiAgdmFyIHRyaWVzID0gMDtcbiAgdmFyIHVzaW5nRmFsbGJhY2sgPSBmYWxzZTtcbiAgdmFyIGhhc0ZhbGxiYWNrID0gY2xpZW50Ll91c2VGYWxsYmFjayAmJiBjbGllbnQuX3JlcXVlc3QuZmFsbGJhY2sgJiYgaW5pdGlhbE9wdHMuZmFsbGJhY2s7XG4gIHZhciBoZWFkZXJzO1xuXG4gIGlmIChcbiAgICB0aGlzLmFwaUtleS5sZW5ndGggPiBNQVhfQVBJX0tFWV9MRU5HVEggJiZcbiAgICBpbml0aWFsT3B0cy5ib2R5ICE9PSB1bmRlZmluZWQgJiZcbiAgICAoaW5pdGlhbE9wdHMuYm9keS5wYXJhbXMgIT09IHVuZGVmaW5lZCB8fCAvLyBpbmRleC5zZWFyY2goKVxuICAgIGluaXRpYWxPcHRzLmJvZHkucmVxdWVzdHMgIT09IHVuZGVmaW5lZCkgLy8gY2xpZW50LnNlYXJjaCgpXG4gICkge1xuICAgIGluaXRpYWxPcHRzLmJvZHkuYXBpS2V5ID0gdGhpcy5hcGlLZXk7XG4gICAgaGVhZGVycyA9IHRoaXMuX2NvbXB1dGVSZXF1ZXN0SGVhZGVycyh7XG4gICAgICBhZGRpdGlvbmFsVUE6IGFkZGl0aW9uYWxVQSxcbiAgICAgIHdpdGhBcGlLZXk6IGZhbHNlLFxuICAgICAgaGVhZGVyczogaW5pdGlhbE9wdHMuaGVhZGVyc1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGhlYWRlcnMgPSB0aGlzLl9jb21wdXRlUmVxdWVzdEhlYWRlcnMoe1xuICAgICAgYWRkaXRpb25hbFVBOiBhZGRpdGlvbmFsVUEsXG4gICAgICBoZWFkZXJzOiBpbml0aWFsT3B0cy5oZWFkZXJzXG4gICAgfSk7XG4gIH1cblxuICBpZiAoaW5pdGlhbE9wdHMuYm9keSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgYm9keSA9IHNhZmVKU09OU3RyaW5naWZ5KGluaXRpYWxPcHRzLmJvZHkpO1xuICB9XG5cbiAgcmVxdWVzdERlYnVnKCdyZXF1ZXN0IHN0YXJ0Jyk7XG4gIHZhciBkZWJ1Z0RhdGEgPSBbXTtcblxuXG4gIGZ1bmN0aW9uIGRvUmVxdWVzdChyZXF1ZXN0ZXIsIHJlcU9wdHMpIHtcbiAgICBjbGllbnQuX2NoZWNrQXBwSWREYXRhKCk7XG5cbiAgICB2YXIgc3RhcnRUaW1lID0gbmV3IERhdGUoKTtcblxuICAgIGlmIChjbGllbnQuX3VzZUNhY2hlICYmICFjbGllbnQuX3VzZVJlcXVlc3RDYWNoZSkge1xuICAgICAgY2FjaGVJRCA9IGluaXRpYWxPcHRzLnVybDtcbiAgICB9XG5cbiAgICAvLyBhcyB3ZSBzb21ldGltZSB1c2UgUE9TVCByZXF1ZXN0cyB0byBwYXNzIHBhcmFtZXRlcnMgKGxpa2UgcXVlcnk9J2FhJyksXG4gICAgLy8gdGhlIGNhY2hlSUQgbXVzdCBhbHNvIGluY2x1ZGUgdGhlIGJvZHkgdG8gYmUgZGlmZmVyZW50IGJldHdlZW4gY2FsbHNcbiAgICBpZiAoY2xpZW50Ll91c2VDYWNoZSAmJiAhY2xpZW50Ll91c2VSZXF1ZXN0Q2FjaGUgJiYgYm9keSkge1xuICAgICAgY2FjaGVJRCArPSAnX2JvZHlfJyArIHJlcU9wdHMuYm9keTtcbiAgICB9XG5cbiAgICAvLyBoYW5kbGUgY2FjaGUgZXhpc3RlbmNlXG4gICAgaWYgKGlzQ2FjaGVWYWxpZFdpdGhDdXJyZW50SUQoIWNsaWVudC5fdXNlUmVxdWVzdENhY2hlLCBjYWNoZSwgY2FjaGVJRCkpIHtcbiAgICAgIHJlcXVlc3REZWJ1Zygnc2VydmluZyByZXNwb25zZSBmcm9tIGNhY2hlJyk7XG5cbiAgICAgIHZhciByZXNwb25zZVRleHQgPSBjYWNoZVtjYWNoZUlEXTtcblxuICAgICAgLy8gQ2FjaGUgcmVzcG9uc2UgbXVzdCBtYXRjaCB0aGUgdHlwZSBvZiB0aGUgb3JpZ2luYWwgb25lXG4gICAgICByZXR1cm4gY2xpZW50Ll9wcm9taXNlLnJlc29sdmUoe1xuICAgICAgICBib2R5OiBKU09OLnBhcnNlKHJlc3BvbnNlVGV4dCksXG4gICAgICAgIHJlc3BvbnNlVGV4dDogcmVzcG9uc2VUZXh0XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBpZiB3ZSByZWFjaGVkIG1heCB0cmllc1xuICAgIGlmICh0cmllcyA+PSBjbGllbnQuaG9zdHNbaW5pdGlhbE9wdHMuaG9zdFR5cGVdLmxlbmd0aCkge1xuICAgICAgaWYgKCFoYXNGYWxsYmFjayB8fCB1c2luZ0ZhbGxiYWNrKSB7XG4gICAgICAgIHJlcXVlc3REZWJ1ZygnY291bGQgbm90IGdldCBhbnkgcmVzcG9uc2UnKTtcbiAgICAgICAgLy8gdGhlbiBzdG9wXG4gICAgICAgIHJldHVybiBjbGllbnQuX3Byb21pc2UucmVqZWN0KG5ldyBlcnJvcnMuQWxnb2xpYVNlYXJjaEVycm9yKFxuICAgICAgICAgICdDYW5ub3QgY29ubmVjdCB0byB0aGUgQWxnb2xpYVNlYXJjaCBBUEkuJyArXG4gICAgICAgICAgJyBTZW5kIGFuIGVtYWlsIHRvIHN1cHBvcnRAYWxnb2xpYS5jb20gdG8gcmVwb3J0IGFuZCByZXNvbHZlIHRoZSBpc3N1ZS4nICtcbiAgICAgICAgICAnIEFwcGxpY2F0aW9uIGlkIHdhczogJyArIGNsaWVudC5hcHBsaWNhdGlvbklELCB7ZGVidWdEYXRhOiBkZWJ1Z0RhdGF9XG4gICAgICAgICkpO1xuICAgICAgfVxuXG4gICAgICByZXF1ZXN0RGVidWcoJ3N3aXRjaGluZyB0byBmYWxsYmFjaycpO1xuXG4gICAgICAvLyBsZXQncyB0cnkgdGhlIGZhbGxiYWNrIHN0YXJ0aW5nIGZyb20gaGVyZVxuICAgICAgdHJpZXMgPSAwO1xuXG4gICAgICAvLyBtZXRob2QsIHVybCBhbmQgYm9keSBhcmUgZmFsbGJhY2sgZGVwZW5kZW50XG4gICAgICByZXFPcHRzLm1ldGhvZCA9IGluaXRpYWxPcHRzLmZhbGxiYWNrLm1ldGhvZDtcbiAgICAgIHJlcU9wdHMudXJsID0gaW5pdGlhbE9wdHMuZmFsbGJhY2sudXJsO1xuICAgICAgcmVxT3B0cy5qc29uQm9keSA9IGluaXRpYWxPcHRzLmZhbGxiYWNrLmJvZHk7XG4gICAgICBpZiAocmVxT3B0cy5qc29uQm9keSkge1xuICAgICAgICByZXFPcHRzLmJvZHkgPSBzYWZlSlNPTlN0cmluZ2lmeShyZXFPcHRzLmpzb25Cb2R5KTtcbiAgICAgIH1cbiAgICAgIC8vIHJlLWNvbXB1dGUgaGVhZGVycywgdGhleSBjb3VsZCBiZSBvbWl0dGluZyB0aGUgQVBJIEtFWVxuICAgICAgaGVhZGVycyA9IGNsaWVudC5fY29tcHV0ZVJlcXVlc3RIZWFkZXJzKHtcbiAgICAgICAgYWRkaXRpb25hbFVBOiBhZGRpdGlvbmFsVUEsXG4gICAgICAgIGhlYWRlcnM6IGluaXRpYWxPcHRzLmhlYWRlcnNcbiAgICAgIH0pO1xuXG4gICAgICByZXFPcHRzLnRpbWVvdXRzID0gY2xpZW50Ll9nZXRUaW1lb3V0c0ZvclJlcXVlc3QoaW5pdGlhbE9wdHMuaG9zdFR5cGUpO1xuICAgICAgY2xpZW50Ll9zZXRIb3N0SW5kZXhCeVR5cGUoMCwgaW5pdGlhbE9wdHMuaG9zdFR5cGUpO1xuICAgICAgdXNpbmdGYWxsYmFjayA9IHRydWU7IC8vIHRoZSBjdXJyZW50IHJlcXVlc3QgaXMgbm93IHVzaW5nIGZhbGxiYWNrXG4gICAgICByZXR1cm4gZG9SZXF1ZXN0KGNsaWVudC5fcmVxdWVzdC5mYWxsYmFjaywgcmVxT3B0cyk7XG4gICAgfVxuXG4gICAgdmFyIGN1cnJlbnRIb3N0ID0gY2xpZW50Ll9nZXRIb3N0QnlUeXBlKGluaXRpYWxPcHRzLmhvc3RUeXBlKTtcblxuICAgIHZhciB1cmwgPSBjdXJyZW50SG9zdCArIHJlcU9wdHMudXJsO1xuICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgYm9keTogcmVxT3B0cy5ib2R5LFxuICAgICAganNvbkJvZHk6IHJlcU9wdHMuanNvbkJvZHksXG4gICAgICBtZXRob2Q6IHJlcU9wdHMubWV0aG9kLFxuICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgIHRpbWVvdXRzOiByZXFPcHRzLnRpbWVvdXRzLFxuICAgICAgZGVidWc6IHJlcXVlc3REZWJ1ZyxcbiAgICAgIGZvcmNlQXV0aEhlYWRlcnM6IHJlcU9wdHMuZm9yY2VBdXRoSGVhZGVyc1xuICAgIH07XG5cbiAgICByZXF1ZXN0RGVidWcoJ21ldGhvZDogJXMsIHVybDogJXMsIGhlYWRlcnM6ICVqLCB0aW1lb3V0czogJWQnLFxuICAgICAgb3B0aW9ucy5tZXRob2QsIHVybCwgb3B0aW9ucy5oZWFkZXJzLCBvcHRpb25zLnRpbWVvdXRzKTtcblxuICAgIGlmIChyZXF1ZXN0ZXIgPT09IGNsaWVudC5fcmVxdWVzdC5mYWxsYmFjaykge1xuICAgICAgcmVxdWVzdERlYnVnKCd1c2luZyBmYWxsYmFjaycpO1xuICAgIH1cblxuICAgIC8vIGByZXF1ZXN0ZXJgIGlzIGFueSBvZiB0aGlzLl9yZXF1ZXN0IG9yIHRoaXMuX3JlcXVlc3QuZmFsbGJhY2tcbiAgICAvLyB0aHVzIGl0IG5lZWRzIHRvIGJlIGNhbGxlZCB1c2luZyB0aGUgY2xpZW50IGFzIGNvbnRleHRcbiAgICByZXR1cm4gcmVxdWVzdGVyLmNhbGwoY2xpZW50LCB1cmwsIG9wdGlvbnMpLnRoZW4oc3VjY2VzcywgdHJ5RmFsbGJhY2spO1xuXG4gICAgZnVuY3Rpb24gc3VjY2VzcyhodHRwUmVzcG9uc2UpIHtcbiAgICAgIC8vIGNvbXB1dGUgdGhlIHN0YXR1cyBvZiB0aGUgcmVzcG9uc2UsXG4gICAgICAvL1xuICAgICAgLy8gV2hlbiBpbiBicm93c2VyIG1vZGUsIHVzaW5nIFhEUiBvciBKU09OUCwgd2UgaGF2ZSBubyBzdGF0dXNDb2RlIGF2YWlsYWJsZVxuICAgICAgLy8gU28gd2UgcmVseSBvbiBvdXIgQVBJIHJlc3BvbnNlIGBzdGF0dXNgIHByb3BlcnR5LlxuICAgICAgLy8gQnV0IGB3YWl0VGFza2AgY2FuIHNldCBhIGBzdGF0dXNgIHByb3BlcnR5IHdoaWNoIGlzIG5vdCB0aGUgc3RhdHVzQ29kZSAoaXQncyB0aGUgdGFzayBzdGF0dXMpXG4gICAgICAvLyBTbyB3ZSBjaGVjayBpZiB0aGVyZSdzIGEgYG1lc3NhZ2VgIGFsb25nIGBzdGF0dXNgIGFuZCBpdCBtZWFucyBpdCdzIGFuIGVycm9yXG4gICAgICAvL1xuICAgICAgLy8gVGhhdCdzIHRoZSBvbmx5IGNhc2Ugd2hlcmUgd2UgaGF2ZSBhIHJlc3BvbnNlLnN0YXR1cyB0aGF0J3Mgbm90IHRoZSBodHRwIHN0YXR1c0NvZGVcbiAgICAgIHZhciBzdGF0dXMgPSBodHRwUmVzcG9uc2UgJiYgaHR0cFJlc3BvbnNlLmJvZHkgJiYgaHR0cFJlc3BvbnNlLmJvZHkubWVzc2FnZSAmJiBodHRwUmVzcG9uc2UuYm9keS5zdGF0dXMgfHxcblxuICAgICAgICAvLyB0aGlzIGlzIGltcG9ydGFudCB0byBjaGVjayB0aGUgcmVxdWVzdCBzdGF0dXNDb2RlIEFGVEVSIHRoZSBib2R5IGV2ZW50dWFsXG4gICAgICAgIC8vIHN0YXR1c0NvZGUgYmVjYXVzZSBzb21lIGltcGxlbWVudGF0aW9ucyAoalF1ZXJ5IFhEb21haW5SZXF1ZXN0IHRyYW5zcG9ydCkgbWF5XG4gICAgICAgIC8vIHNlbmQgc3RhdHVzQ29kZSAyMDAgd2hpbGUgd2UgaGFkIGFuIGVycm9yXG4gICAgICAgIGh0dHBSZXNwb25zZS5zdGF0dXNDb2RlIHx8XG5cbiAgICAgICAgLy8gV2hlbiBpbiBicm93c2VyIG1vZGUsIHVzaW5nIFhEUiBvciBKU09OUFxuICAgICAgICAvLyB3ZSBkZWZhdWx0IHRvIHN1Y2Nlc3Mgd2hlbiBubyBlcnJvciAobm8gcmVzcG9uc2Uuc3RhdHVzICYmIHJlc3BvbnNlLm1lc3NhZ2UpXG4gICAgICAgIC8vIElmIHRoZXJlIHdhcyBhIEpTT04ucGFyc2UoKSBlcnJvciB0aGVuIGJvZHkgaXMgbnVsbCBhbmQgaXQgZmFpbHNcbiAgICAgICAgaHR0cFJlc3BvbnNlICYmIGh0dHBSZXNwb25zZS5ib2R5ICYmIDIwMDtcblxuICAgICAgcmVxdWVzdERlYnVnKCdyZWNlaXZlZCByZXNwb25zZTogc3RhdHVzQ29kZTogJXMsIGNvbXB1dGVkIHN0YXR1c0NvZGU6ICVkLCBoZWFkZXJzOiAlaicsXG4gICAgICAgIGh0dHBSZXNwb25zZS5zdGF0dXNDb2RlLCBzdGF0dXMsIGh0dHBSZXNwb25zZS5oZWFkZXJzKTtcblxuICAgICAgdmFyIGh0dHBSZXNwb25zZU9rID0gTWF0aC5mbG9vcihzdGF0dXMgLyAxMDApID09PSAyO1xuXG4gICAgICB2YXIgZW5kVGltZSA9IG5ldyBEYXRlKCk7XG4gICAgICBkZWJ1Z0RhdGEucHVzaCh7XG4gICAgICAgIGN1cnJlbnRIb3N0OiBjdXJyZW50SG9zdCxcbiAgICAgICAgaGVhZGVyczogcmVtb3ZlQ3JlZGVudGlhbHMoaGVhZGVycyksXG4gICAgICAgIGNvbnRlbnQ6IGJvZHkgfHwgbnVsbCxcbiAgICAgICAgY29udGVudExlbmd0aDogYm9keSAhPT0gdW5kZWZpbmVkID8gYm9keS5sZW5ndGggOiBudWxsLFxuICAgICAgICBtZXRob2Q6IHJlcU9wdHMubWV0aG9kLFxuICAgICAgICB0aW1lb3V0czogcmVxT3B0cy50aW1lb3V0cyxcbiAgICAgICAgdXJsOiByZXFPcHRzLnVybCxcbiAgICAgICAgc3RhcnRUaW1lOiBzdGFydFRpbWUsXG4gICAgICAgIGVuZFRpbWU6IGVuZFRpbWUsXG4gICAgICAgIGR1cmF0aW9uOiBlbmRUaW1lIC0gc3RhcnRUaW1lLFxuICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXNcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoaHR0cFJlc3BvbnNlT2spIHtcbiAgICAgICAgaWYgKGNsaWVudC5fdXNlQ2FjaGUgJiYgIWNsaWVudC5fdXNlUmVxdWVzdENhY2hlICYmIGNhY2hlKSB7XG4gICAgICAgICAgY2FjaGVbY2FjaGVJRF0gPSBodHRwUmVzcG9uc2UucmVzcG9uc2VUZXh0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICByZXNwb25zZVRleHQ6IGh0dHBSZXNwb25zZS5yZXNwb25zZVRleHQsXG4gICAgICAgICAgYm9keTogaHR0cFJlc3BvbnNlLmJvZHlcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgdmFyIHNob3VsZFJldHJ5ID0gTWF0aC5mbG9vcihzdGF0dXMgLyAxMDApICE9PSA0O1xuXG4gICAgICBpZiAoc2hvdWxkUmV0cnkpIHtcbiAgICAgICAgdHJpZXMgKz0gMTtcbiAgICAgICAgcmV0dXJuIHJldHJ5UmVxdWVzdCgpO1xuICAgICAgfVxuXG4gICAgICByZXF1ZXN0RGVidWcoJ3VucmVjb3ZlcmFibGUgZXJyb3InKTtcblxuICAgICAgLy8gbm8gc3VjY2VzcyBhbmQgbm8gcmV0cnkgPT4gZmFpbFxuICAgICAgdmFyIHVucmVjb3ZlcmFibGVFcnJvciA9IG5ldyBlcnJvcnMuQWxnb2xpYVNlYXJjaEVycm9yKFxuICAgICAgICBodHRwUmVzcG9uc2UuYm9keSAmJiBodHRwUmVzcG9uc2UuYm9keS5tZXNzYWdlLCB7ZGVidWdEYXRhOiBkZWJ1Z0RhdGEsIHN0YXR1c0NvZGU6IHN0YXR1c31cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiBjbGllbnQuX3Byb21pc2UucmVqZWN0KHVucmVjb3ZlcmFibGVFcnJvcik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdHJ5RmFsbGJhY2soZXJyKSB7XG4gICAgICAvLyBlcnJvciBjYXNlczpcbiAgICAgIC8vICBXaGlsZSBub3QgaW4gZmFsbGJhY2sgbW9kZTpcbiAgICAgIC8vICAgIC0gQ09SUyBub3Qgc3VwcG9ydGVkXG4gICAgICAvLyAgICAtIG5ldHdvcmsgZXJyb3JcbiAgICAgIC8vICBXaGlsZSBpbiBmYWxsYmFjayBtb2RlOlxuICAgICAgLy8gICAgLSB0aW1lb3V0XG4gICAgICAvLyAgICAtIG5ldHdvcmsgZXJyb3JcbiAgICAgIC8vICAgIC0gYmFkbHkgZm9ybWF0dGVkIEpTT05QIChzY3JpcHQgbG9hZGVkLCBkaWQgbm90IGNhbGwgb3VyIGNhbGxiYWNrKVxuICAgICAgLy8gIEluIGJvdGggY2FzZXM6XG4gICAgICAvLyAgICAtIHVuY2F1Z2h0IGV4Y2VwdGlvbiBvY2N1cnMgKFR5cGVFcnJvcilcbiAgICAgIHJlcXVlc3REZWJ1ZygnZXJyb3I6ICVzLCBzdGFjazogJXMnLCBlcnIubWVzc2FnZSwgZXJyLnN0YWNrKTtcblxuICAgICAgdmFyIGVuZFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgICAgZGVidWdEYXRhLnB1c2goe1xuICAgICAgICBjdXJyZW50SG9zdDogY3VycmVudEhvc3QsXG4gICAgICAgIGhlYWRlcnM6IHJlbW92ZUNyZWRlbnRpYWxzKGhlYWRlcnMpLFxuICAgICAgICBjb250ZW50OiBib2R5IHx8IG51bGwsXG4gICAgICAgIGNvbnRlbnRMZW5ndGg6IGJvZHkgIT09IHVuZGVmaW5lZCA/IGJvZHkubGVuZ3RoIDogbnVsbCxcbiAgICAgICAgbWV0aG9kOiByZXFPcHRzLm1ldGhvZCxcbiAgICAgICAgdGltZW91dHM6IHJlcU9wdHMudGltZW91dHMsXG4gICAgICAgIHVybDogcmVxT3B0cy51cmwsXG4gICAgICAgIHN0YXJ0VGltZTogc3RhcnRUaW1lLFxuICAgICAgICBlbmRUaW1lOiBlbmRUaW1lLFxuICAgICAgICBkdXJhdGlvbjogZW5kVGltZSAtIHN0YXJ0VGltZVxuICAgICAgfSk7XG5cbiAgICAgIGlmICghKGVyciBpbnN0YW5jZW9mIGVycm9ycy5BbGdvbGlhU2VhcmNoRXJyb3IpKSB7XG4gICAgICAgIGVyciA9IG5ldyBlcnJvcnMuVW5rbm93bihlcnIgJiYgZXJyLm1lc3NhZ2UsIGVycik7XG4gICAgICB9XG5cbiAgICAgIHRyaWVzICs9IDE7XG5cbiAgICAgIC8vIHN0b3AgdGhlIHJlcXVlc3QgaW1wbGVtZW50YXRpb24gd2hlbjpcbiAgICAgIGlmIChcbiAgICAgICAgLy8gd2UgZGlkIG5vdCBnZW5lcmF0ZSB0aGlzIGVycm9yLFxuICAgICAgICAvLyBpdCBjb21lcyBmcm9tIGEgdGhyb3cgaW4gc29tZSBvdGhlciBwaWVjZSBvZiBjb2RlXG4gICAgICAgIGVyciBpbnN0YW5jZW9mIGVycm9ycy5Vbmtub3duIHx8XG5cbiAgICAgICAgLy8gc2VydmVyIHNlbnQgdW5wYXJzYWJsZSBKU09OXG4gICAgICAgIGVyciBpbnN0YW5jZW9mIGVycm9ycy5VbnBhcnNhYmxlSlNPTiB8fFxuXG4gICAgICAgIC8vIG1heCB0cmllcyBhbmQgYWxyZWFkeSB1c2luZyBmYWxsYmFjayBvciBubyBmYWxsYmFja1xuICAgICAgICB0cmllcyA+PSBjbGllbnQuaG9zdHNbaW5pdGlhbE9wdHMuaG9zdFR5cGVdLmxlbmd0aCAmJlxuICAgICAgICAodXNpbmdGYWxsYmFjayB8fCAhaGFzRmFsbGJhY2spKSB7XG4gICAgICAgIC8vIHN0b3AgcmVxdWVzdCBpbXBsZW1lbnRhdGlvbiBmb3IgdGhpcyBjb21tYW5kXG4gICAgICAgIGVyci5kZWJ1Z0RhdGEgPSBkZWJ1Z0RhdGE7XG4gICAgICAgIHJldHVybiBjbGllbnQuX3Byb21pc2UucmVqZWN0KGVycik7XG4gICAgICB9XG5cbiAgICAgIC8vIFdoZW4gYSB0aW1lb3V0IG9jY3VyZWQsIHJldHJ5IGJ5IHJhaXNpbmcgdGltZW91dFxuICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIGVycm9ycy5SZXF1ZXN0VGltZW91dCkge1xuICAgICAgICByZXR1cm4gcmV0cnlSZXF1ZXN0V2l0aEhpZ2hlclRpbWVvdXQoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJldHJ5UmVxdWVzdCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJldHJ5UmVxdWVzdCgpIHtcbiAgICAgIHJlcXVlc3REZWJ1ZygncmV0cnlpbmcgcmVxdWVzdCcpO1xuICAgICAgY2xpZW50Ll9pbmNyZW1lbnRIb3N0SW5kZXgoaW5pdGlhbE9wdHMuaG9zdFR5cGUpO1xuICAgICAgcmV0dXJuIGRvUmVxdWVzdChyZXF1ZXN0ZXIsIHJlcU9wdHMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJldHJ5UmVxdWVzdFdpdGhIaWdoZXJUaW1lb3V0KCkge1xuICAgICAgcmVxdWVzdERlYnVnKCdyZXRyeWluZyByZXF1ZXN0IHdpdGggaGlnaGVyIHRpbWVvdXQnKTtcbiAgICAgIGNsaWVudC5faW5jcmVtZW50SG9zdEluZGV4KGluaXRpYWxPcHRzLmhvc3RUeXBlKTtcbiAgICAgIGNsaWVudC5faW5jcmVtZW50VGltZW91dE11bHRpcGxlcigpO1xuICAgICAgcmVxT3B0cy50aW1lb3V0cyA9IGNsaWVudC5fZ2V0VGltZW91dHNGb3JSZXF1ZXN0KGluaXRpYWxPcHRzLmhvc3RUeXBlKTtcbiAgICAgIHJldHVybiBkb1JlcXVlc3QocmVxdWVzdGVyLCByZXFPcHRzKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBpc0NhY2hlVmFsaWRXaXRoQ3VycmVudElEKFxuICAgIHVzZVJlcXVlc3RDYWNoZSxcbiAgICBjdXJyZW50Q2FjaGUsXG4gICAgY3VycmVudENhY2hlSURcbiAgKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIGNsaWVudC5fdXNlQ2FjaGUgJiZcbiAgICAgIHVzZVJlcXVlc3RDYWNoZSAmJlxuICAgICAgY3VycmVudENhY2hlICYmXG4gICAgICBjdXJyZW50Q2FjaGVbY3VycmVudENhY2hlSURdICE9PSB1bmRlZmluZWRcbiAgICApO1xuICB9XG5cblxuICBmdW5jdGlvbiBpbnRlcm9wQ2FsbGJhY2tSZXR1cm4ocmVxdWVzdCwgY2FsbGJhY2spIHtcbiAgICBpZiAoaXNDYWNoZVZhbGlkV2l0aEN1cnJlbnRJRChjbGllbnQuX3VzZVJlcXVlc3RDYWNoZSwgY2FjaGUsIGNhY2hlSUQpKSB7XG4gICAgICByZXF1ZXN0LmNhdGNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBSZWxlYXNlIHRoZSBjYWNoZSBvbiBlcnJvclxuICAgICAgICBkZWxldGUgY2FjaGVbY2FjaGVJRF07XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGluaXRpYWxPcHRzLmNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAvLyBlaXRoZXIgd2UgaGF2ZSBhIGNhbGxiYWNrXG4gICAgICByZXF1ZXN0LnRoZW4oZnVuY3Rpb24gb2tDYihjb250ZW50KSB7XG4gICAgICAgIGV4aXRQcm9taXNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGluaXRpYWxPcHRzLmNhbGxiYWNrKG51bGwsIGNhbGxiYWNrKGNvbnRlbnQpKTtcbiAgICAgICAgfSwgY2xpZW50Ll9zZXRUaW1lb3V0IHx8IHNldFRpbWVvdXQpO1xuICAgICAgfSwgZnVuY3Rpb24gbm9va0NiKGVycikge1xuICAgICAgICBleGl0UHJvbWlzZShmdW5jdGlvbigpIHtcbiAgICAgICAgICBpbml0aWFsT3B0cy5jYWxsYmFjayhlcnIpO1xuICAgICAgICB9LCBjbGllbnQuX3NldFRpbWVvdXQgfHwgc2V0VGltZW91dCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZWl0aGVyIHdlIGFyZSB1c2luZyBwcm9taXNlc1xuICAgICAgcmV0dXJuIHJlcXVlc3QudGhlbihjYWxsYmFjayk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGNsaWVudC5fdXNlQ2FjaGUgJiYgY2xpZW50Ll91c2VSZXF1ZXN0Q2FjaGUpIHtcbiAgICBjYWNoZUlEID0gaW5pdGlhbE9wdHMudXJsO1xuICB9XG5cbiAgLy8gYXMgd2Ugc29tZXRpbWUgdXNlIFBPU1QgcmVxdWVzdHMgdG8gcGFzcyBwYXJhbWV0ZXJzIChsaWtlIHF1ZXJ5PSdhYScpLFxuICAvLyB0aGUgY2FjaGVJRCBtdXN0IGFsc28gaW5jbHVkZSB0aGUgYm9keSB0byBiZSBkaWZmZXJlbnQgYmV0d2VlbiBjYWxsc1xuICBpZiAoY2xpZW50Ll91c2VDYWNoZSAmJiBjbGllbnQuX3VzZVJlcXVlc3RDYWNoZSAmJiBib2R5KSB7XG4gICAgY2FjaGVJRCArPSAnX2JvZHlfJyArIGJvZHk7XG4gIH1cblxuICBpZiAoaXNDYWNoZVZhbGlkV2l0aEN1cnJlbnRJRChjbGllbnQuX3VzZVJlcXVlc3RDYWNoZSwgY2FjaGUsIGNhY2hlSUQpKSB7XG4gICAgcmVxdWVzdERlYnVnKCdzZXJ2aW5nIHJlcXVlc3QgZnJvbSBjYWNoZScpO1xuXG4gICAgdmFyIG1heWJlUHJvbWlzZUZvckNhY2hlID0gY2FjaGVbY2FjaGVJRF07XG5cbiAgICAvLyBJbiBjYXNlIHRoZSBjYWNoZSBpcyB3YXJtdXAgd2l0aCB2YWx1ZSB0aGF0IGlzIG5vdCBhIHByb21pc2VcbiAgICB2YXIgcHJvbWlzZUZvckNhY2hlID0gdHlwZW9mIG1heWJlUHJvbWlzZUZvckNhY2hlLnRoZW4gIT09ICdmdW5jdGlvbidcbiAgICAgID8gY2xpZW50Ll9wcm9taXNlLnJlc29sdmUoe3Jlc3BvbnNlVGV4dDogbWF5YmVQcm9taXNlRm9yQ2FjaGV9KVxuICAgICAgOiBtYXliZVByb21pc2VGb3JDYWNoZTtcblxuICAgIHJldHVybiBpbnRlcm9wQ2FsbGJhY2tSZXR1cm4ocHJvbWlzZUZvckNhY2hlLCBmdW5jdGlvbihjb250ZW50KSB7XG4gICAgICAvLyBJbiBjYXNlIG9mIHRoZSBjYWNoZSByZXF1ZXN0LCByZXR1cm4gdGhlIG9yaWdpbmFsIHZhbHVlXG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShjb250ZW50LnJlc3BvbnNlVGV4dCk7XG4gICAgfSk7XG4gIH1cblxuICB2YXIgcmVxdWVzdCA9IGRvUmVxdWVzdChcbiAgICBjbGllbnQuX3JlcXVlc3QsIHtcbiAgICAgIHVybDogaW5pdGlhbE9wdHMudXJsLFxuICAgICAgbWV0aG9kOiBpbml0aWFsT3B0cy5tZXRob2QsXG4gICAgICBib2R5OiBib2R5LFxuICAgICAganNvbkJvZHk6IGluaXRpYWxPcHRzLmJvZHksXG4gICAgICB0aW1lb3V0czogY2xpZW50Ll9nZXRUaW1lb3V0c0ZvclJlcXVlc3QoaW5pdGlhbE9wdHMuaG9zdFR5cGUpLFxuICAgICAgZm9yY2VBdXRoSGVhZGVyczogaW5pdGlhbE9wdHMuZm9yY2VBdXRoSGVhZGVyc1xuICAgIH1cbiAgKTtcblxuICBpZiAoY2xpZW50Ll91c2VDYWNoZSAmJiBjbGllbnQuX3VzZVJlcXVlc3RDYWNoZSAmJiBjYWNoZSkge1xuICAgIGNhY2hlW2NhY2hlSURdID0gcmVxdWVzdDtcbiAgfVxuXG4gIHJldHVybiBpbnRlcm9wQ2FsbGJhY2tSZXR1cm4ocmVxdWVzdCwgZnVuY3Rpb24oY29udGVudCkge1xuICAgIC8vIEluIGNhc2Ugb2YgdGhlIGZpcnN0IHJlcXVlc3QsIHJldHVybiB0aGUgSlNPTiB2YWx1ZVxuICAgIHJldHVybiBjb250ZW50LmJvZHk7XG4gIH0pO1xufTtcblxuLypcbiogVHJhbnNmb3JtIHNlYXJjaCBwYXJhbSBvYmplY3QgaW4gcXVlcnkgc3RyaW5nXG4qIEBwYXJhbSB7b2JqZWN0fSBhcmdzIGFyZ3VtZW50cyB0byBhZGQgdG8gdGhlIGN1cnJlbnQgcXVlcnkgc3RyaW5nXG4qIEBwYXJhbSB7c3RyaW5nfSBwYXJhbXMgY3VycmVudCBxdWVyeSBzdHJpbmdcbiogQHJldHVybiB7c3RyaW5nfSB0aGUgZmluYWwgcXVlcnkgc3RyaW5nXG4qL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9nZXRTZWFyY2hQYXJhbXMgPSBmdW5jdGlvbihhcmdzLCBwYXJhbXMpIHtcbiAgaWYgKGFyZ3MgPT09IHVuZGVmaW5lZCB8fCBhcmdzID09PSBudWxsKSB7XG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfVxuICBmb3IgKHZhciBrZXkgaW4gYXJncykge1xuICAgIGlmIChrZXkgIT09IG51bGwgJiYgYXJnc1trZXldICE9PSB1bmRlZmluZWQgJiYgYXJncy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBwYXJhbXMgKz0gcGFyYW1zID09PSAnJyA/ICcnIDogJyYnO1xuICAgICAgcGFyYW1zICs9IGtleSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJnc1trZXldKSA9PT0gJ1tvYmplY3QgQXJyYXldJyA/IHNhZmVKU09OU3RyaW5naWZ5KGFyZ3Nba2V5XSkgOiBhcmdzW2tleV0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFyYW1zO1xufTtcblxuLyoqXG4gKiBDb21wdXRlIHRoZSBoZWFkZXJzIGZvciBhIHJlcXVlc3RcbiAqXG4gKiBAcGFyYW0gW3N0cmluZ10gb3B0aW9ucy5hZGRpdGlvbmFsVUEgc2VtaS1jb2xvbiBzZXBhcmF0ZWQgc3RyaW5nIHdpdGggb3RoZXIgdXNlciBhZ2VudHMgdG8gYWRkXG4gKiBAcGFyYW0gW2Jvb2xlYW49dHJ1ZV0gb3B0aW9ucy53aXRoQXBpS2V5IFNlbmQgdGhlIGFwaSBrZXkgYXMgYSBoZWFkZXJcbiAqIEBwYXJhbSBbT2JqZWN0XSBvcHRpb25zLmhlYWRlcnMgRXh0cmEgaGVhZGVycyB0byBzZW5kXG4gKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fY29tcHV0ZVJlcXVlc3RIZWFkZXJzID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICB2YXIgZm9yRWFjaCA9IHJlcXVpcmUoJ2ZvcmVhY2gnKTtcblxuICB2YXIgdWEgPSBvcHRpb25zLmFkZGl0aW9uYWxVQSA/XG4gICAgdGhpcy5fdWEgKyAnOycgKyBvcHRpb25zLmFkZGl0aW9uYWxVQSA6XG4gICAgdGhpcy5fdWE7XG5cbiAgdmFyIHJlcXVlc3RIZWFkZXJzID0ge1xuICAgICd4LWFsZ29saWEtYWdlbnQnOiB1YSxcbiAgICAneC1hbGdvbGlhLWFwcGxpY2F0aW9uLWlkJzogdGhpcy5hcHBsaWNhdGlvbklEXG4gIH07XG5cbiAgLy8gYnJvd3NlciB3aWxsIGlubGluZSBoZWFkZXJzIGluIHRoZSB1cmwsIG5vZGUuanMgd2lsbCB1c2UgaHR0cCBoZWFkZXJzXG4gIC8vIGJ1dCBpbiBzb21lIHNpdHVhdGlvbnMsIHRoZSBBUEkgS0VZIHdpbGwgYmUgdG9vIGxvbmcgKGJpZyBzZWN1cmVkIEFQSSBrZXlzKVxuICAvLyBzbyBpZiB0aGUgcmVxdWVzdCBpcyBhIFBPU1QgYW5kIHRoZSBLRVkgaXMgdmVyeSBsb25nLCB3ZSB3aWxsIGJlIGFza2VkIHRvIG5vdCBwdXRcbiAgLy8gaXQgaW50byBoZWFkZXJzIGJ1dCBpbiB0aGUgSlNPTiBib2R5XG4gIGlmIChvcHRpb25zLndpdGhBcGlLZXkgIT09IGZhbHNlKSB7XG4gICAgcmVxdWVzdEhlYWRlcnNbJ3gtYWxnb2xpYS1hcGkta2V5J10gPSB0aGlzLmFwaUtleTtcbiAgfVxuXG4gIGlmICh0aGlzLnVzZXJUb2tlbikge1xuICAgIHJlcXVlc3RIZWFkZXJzWyd4LWFsZ29saWEtdXNlcnRva2VuJ10gPSB0aGlzLnVzZXJUb2tlbjtcbiAgfVxuXG4gIGlmICh0aGlzLnNlY3VyaXR5VGFncykge1xuICAgIHJlcXVlc3RIZWFkZXJzWyd4LWFsZ29saWEtdGFnZmlsdGVycyddID0gdGhpcy5zZWN1cml0eVRhZ3M7XG4gIH1cblxuICBmb3JFYWNoKHRoaXMuZXh0cmFIZWFkZXJzLCBmdW5jdGlvbiBhZGRUb1JlcXVlc3RIZWFkZXJzKHZhbHVlLCBrZXkpIHtcbiAgICByZXF1ZXN0SGVhZGVyc1trZXldID0gdmFsdWU7XG4gIH0pO1xuXG4gIGlmIChvcHRpb25zLmhlYWRlcnMpIHtcbiAgICBmb3JFYWNoKG9wdGlvbnMuaGVhZGVycywgZnVuY3Rpb24gYWRkVG9SZXF1ZXN0SGVhZGVycyh2YWx1ZSwga2V5KSB7XG4gICAgICByZXF1ZXN0SGVhZGVyc1trZXldID0gdmFsdWU7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gcmVxdWVzdEhlYWRlcnM7XG59O1xuXG4vKipcbiAqIFNlYXJjaCB0aHJvdWdoIG11bHRpcGxlIGluZGljZXMgYXQgdGhlIHNhbWUgdGltZVxuICogQHBhcmFtICB7T2JqZWN0W119ICAgcXVlcmllcyAgQW4gYXJyYXkgb2YgcXVlcmllcyB5b3Ugd2FudCB0byBydW4uXG4gKiBAcGFyYW0ge3N0cmluZ30gcXVlcmllc1tdLmluZGV4TmFtZSBUaGUgaW5kZXggbmFtZSB5b3Ugd2FudCB0byB0YXJnZXRcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcXVlcmllc1tdLnF1ZXJ5XSBUaGUgcXVlcnkgdG8gaXNzdWUgb24gdGhpcyBpbmRleC4gQ2FuIGFsc28gYmUgcGFzc2VkIGludG8gYHBhcmFtc2BcbiAqIEBwYXJhbSB7T2JqZWN0fSBxdWVyaWVzW10ucGFyYW1zIEFueSBzZWFyY2ggcGFyYW0gbGlrZSBoaXRzUGVyUGFnZSwgLi5cbiAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYWxsYmFjayBDYWxsYmFjayB0byBiZSBjYWxsZWRcbiAqIEByZXR1cm4ge1Byb21pc2V8dW5kZWZpbmVkfSBSZXR1cm5zIGEgcHJvbWlzZSBpZiBubyBjYWxsYmFjayBnaXZlblxuICovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24ocXVlcmllcywgb3B0cywgY2FsbGJhY2spIHtcbiAgdmFyIGlzQXJyYXkgPSByZXF1aXJlKCdpc2FycmF5Jyk7XG4gIHZhciBtYXAgPSByZXF1aXJlKCcuL21hcC5qcycpO1xuXG4gIHZhciB1c2FnZSA9ICdVc2FnZTogY2xpZW50LnNlYXJjaChhcnJheU9mUXVlcmllc1ssIGNhbGxiYWNrXSknO1xuXG4gIGlmICghaXNBcnJheShxdWVyaWVzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcih1c2FnZSk7XG4gIH1cblxuICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgb3B0cyA9IHt9O1xuICB9IGVsc2UgaWYgKG9wdHMgPT09IHVuZGVmaW5lZCkge1xuICAgIG9wdHMgPSB7fTtcbiAgfVxuXG4gIHZhciBjbGllbnQgPSB0aGlzO1xuXG4gIHZhciBwb3N0T2JqID0ge1xuICAgIHJlcXVlc3RzOiBtYXAocXVlcmllcywgZnVuY3Rpb24gcHJlcGFyZVJlcXVlc3QocXVlcnkpIHtcbiAgICAgIHZhciBwYXJhbXMgPSAnJztcblxuICAgICAgLy8gYWxsb3cgcXVlcnkucXVlcnlcbiAgICAgIC8vIHNvIHdlIGFyZSBtaW1pY2luZyB0aGUgaW5kZXguc2VhcmNoKHF1ZXJ5LCBwYXJhbXMpIG1ldGhvZFxuICAgICAgLy8ge2luZGV4TmFtZTosIHF1ZXJ5OiwgcGFyYW1zOn1cbiAgICAgIGlmIChxdWVyeS5xdWVyeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHBhcmFtcyArPSAncXVlcnk9JyArIGVuY29kZVVSSUNvbXBvbmVudChxdWVyeS5xdWVyeSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluZGV4TmFtZTogcXVlcnkuaW5kZXhOYW1lLFxuICAgICAgICBwYXJhbXM6IGNsaWVudC5fZ2V0U2VhcmNoUGFyYW1zKHF1ZXJ5LnBhcmFtcywgcGFyYW1zKVxuICAgICAgfTtcbiAgICB9KVxuICB9O1xuXG4gIHZhciBKU09OUFBhcmFtcyA9IG1hcChwb3N0T2JqLnJlcXVlc3RzLCBmdW5jdGlvbiBwcmVwYXJlSlNPTlBQYXJhbXMocmVxdWVzdCwgcmVxdWVzdElkKSB7XG4gICAgcmV0dXJuIHJlcXVlc3RJZCArICc9JyArXG4gICAgICBlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICcvMS9pbmRleGVzLycgKyBlbmNvZGVVUklDb21wb25lbnQocmVxdWVzdC5pbmRleE5hbWUpICsgJz8nICtcbiAgICAgICAgcmVxdWVzdC5wYXJhbXNcbiAgICAgICk7XG4gIH0pLmpvaW4oJyYnKTtcblxuICB2YXIgdXJsID0gJy8xL2luZGV4ZXMvKi9xdWVyaWVzJztcblxuICBpZiAob3B0cy5zdHJhdGVneSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdXJsICs9ICc/c3RyYXRlZ3k9JyArIG9wdHMuc3RyYXRlZ3k7XG4gIH1cblxuICByZXR1cm4gdGhpcy5fanNvblJlcXVlc3Qoe1xuICAgIGNhY2hlOiB0aGlzLmNhY2hlLFxuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIHVybDogdXJsLFxuICAgIGJvZHk6IHBvc3RPYmosXG4gICAgaG9zdFR5cGU6ICdyZWFkJyxcbiAgICBmYWxsYmFjazoge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHVybDogJy8xL2luZGV4ZXMvKicsXG4gICAgICBib2R5OiB7XG4gICAgICAgIHBhcmFtczogSlNPTlBQYXJhbXNcbiAgICAgIH1cbiAgICB9LFxuICAgIGNhbGxiYWNrOiBjYWxsYmFja1xuICB9KTtcbn07XG5cbi8qKlxuKiBTZWFyY2ggZm9yIGZhY2V0IHZhbHVlc1xuKiBodHRwczovL3d3dy5hbGdvbGlhLmNvbS9kb2MvcmVzdC1hcGkvc2VhcmNoI3NlYXJjaC1mb3ItZmFjZXQtdmFsdWVzXG4qIFRoaXMgaXMgdGhlIHRvcC1sZXZlbCBBUEkgZm9yIFNGRlYuXG4qXG4qIEBwYXJhbSB7b2JqZWN0W119IHF1ZXJpZXMgQW4gYXJyYXkgb2YgcXVlcmllcyB0byBydW4uXG4qIEBwYXJhbSB7c3RyaW5nfSBxdWVyaWVzW10uaW5kZXhOYW1lIEluZGV4IG5hbWUsIG5hbWUgb2YgdGhlIGluZGV4IHRvIHNlYXJjaC5cbiogQHBhcmFtIHtvYmplY3R9IHF1ZXJpZXNbXS5wYXJhbXMgUXVlcnkgcGFyYW1ldGVycy5cbiogQHBhcmFtIHtzdHJpbmd9IHF1ZXJpZXNbXS5wYXJhbXMuZmFjZXROYW1lIEZhY2V0IG5hbWUsIG5hbWUgb2YgdGhlIGF0dHJpYnV0ZSB0byBzZWFyY2ggZm9yIHZhbHVlcyBpbi5cbiogTXVzdCBiZSBkZWNsYXJlZCBhcyBhIGZhY2V0XG4qIEBwYXJhbSB7c3RyaW5nfSBxdWVyaWVzW10ucGFyYW1zLmZhY2V0UXVlcnkgUXVlcnkgZm9yIHRoZSBmYWNldCBzZWFyY2hcbiogQHBhcmFtIHtzdHJpbmd9IFtxdWVyaWVzW10ucGFyYW1zLipdIEFueSBzZWFyY2ggcGFyYW1ldGVyIG9mIEFsZ29saWEsXG4qIHNlZSBodHRwczovL3d3dy5hbGdvbGlhLmNvbS9kb2MvYXBpLWNsaWVudC9qYXZhc2NyaXB0L3NlYXJjaCNzZWFyY2gtcGFyYW1ldGVyc1xuKiBQYWdpbmF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQuIFRoZSBwYWdlIGFuZCBoaXRzUGVyUGFnZSBwYXJhbWV0ZXJzIHdpbGwgYmUgaWdub3JlZC5cbiovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuc2VhcmNoRm9yRmFjZXRWYWx1ZXMgPSBmdW5jdGlvbihxdWVyaWVzKSB7XG4gIHZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXNhcnJheScpO1xuICB2YXIgbWFwID0gcmVxdWlyZSgnLi9tYXAuanMnKTtcblxuICB2YXIgdXNhZ2UgPSAnVXNhZ2U6IGNsaWVudC5zZWFyY2hGb3JGYWNldFZhbHVlcyhbe2luZGV4TmFtZSwgcGFyYW1zOiB7ZmFjZXROYW1lLCBmYWNldFF1ZXJ5LCAuLi5wYXJhbXN9fSwgLi4ucXVlcmllc10pJzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBtYXgtbGVuXG5cbiAgaWYgKCFpc0FycmF5KHF1ZXJpZXMpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKHVzYWdlKTtcbiAgfVxuXG4gIHZhciBjbGllbnQgPSB0aGlzO1xuXG4gIHJldHVybiBjbGllbnQuX3Byb21pc2UuYWxsKG1hcChxdWVyaWVzLCBmdW5jdGlvbiBwZXJmb3JtUXVlcnkocXVlcnkpIHtcbiAgICBpZiAoXG4gICAgICAhcXVlcnkgfHxcbiAgICAgIHF1ZXJ5LmluZGV4TmFtZSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICBxdWVyeS5wYXJhbXMuZmFjZXROYW1lID09PSB1bmRlZmluZWQgfHxcbiAgICAgIHF1ZXJ5LnBhcmFtcy5mYWNldFF1ZXJ5ID09PSB1bmRlZmluZWRcbiAgICApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih1c2FnZSk7XG4gICAgfVxuXG4gICAgdmFyIGNsb25lID0gcmVxdWlyZSgnLi9jbG9uZS5qcycpO1xuICAgIHZhciBvbWl0ID0gcmVxdWlyZSgnLi9vbWl0LmpzJyk7XG5cbiAgICB2YXIgaW5kZXhOYW1lID0gcXVlcnkuaW5kZXhOYW1lO1xuICAgIHZhciBwYXJhbXMgPSBxdWVyeS5wYXJhbXM7XG5cbiAgICB2YXIgZmFjZXROYW1lID0gcGFyYW1zLmZhY2V0TmFtZTtcbiAgICB2YXIgZmlsdGVyZWRQYXJhbXMgPSBvbWl0KGNsb25lKHBhcmFtcyksIGZ1bmN0aW9uKGtleU5hbWUpIHtcbiAgICAgIHJldHVybiBrZXlOYW1lID09PSAnZmFjZXROYW1lJztcbiAgICB9KTtcbiAgICB2YXIgc2VhcmNoUGFyYW1ldGVycyA9IGNsaWVudC5fZ2V0U2VhcmNoUGFyYW1zKGZpbHRlcmVkUGFyYW1zLCAnJyk7XG5cbiAgICByZXR1cm4gY2xpZW50Ll9qc29uUmVxdWVzdCh7XG4gICAgICBjYWNoZTogY2xpZW50LmNhY2hlLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICB1cmw6XG4gICAgICAgICcvMS9pbmRleGVzLycgK1xuICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoaW5kZXhOYW1lKSArXG4gICAgICAgICcvZmFjZXRzLycgK1xuICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoZmFjZXROYW1lKSArXG4gICAgICAgICcvcXVlcnknLFxuICAgICAgaG9zdFR5cGU6ICdyZWFkJyxcbiAgICAgIGJvZHk6IHtwYXJhbXM6IHNlYXJjaFBhcmFtZXRlcnN9XG4gICAgfSk7XG4gIH0pKTtcbn07XG5cbi8qKlxuICogU2V0IHRoZSBleHRyYSBzZWN1cml0eSB0YWdGaWx0ZXJzIGhlYWRlclxuICogQHBhcmFtIHtzdHJpbmd8YXJyYXl9IHRhZ3MgVGhlIGxpc3Qgb2YgdGFncyBkZWZpbmluZyB0aGUgY3VycmVudCBzZWN1cml0eSBmaWx0ZXJzXG4gKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5zZXRTZWN1cml0eVRhZ3MgPSBmdW5jdGlvbih0YWdzKSB7XG4gIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGFncykgPT09ICdbb2JqZWN0IEFycmF5XScpIHtcbiAgICB2YXIgc3RyVGFncyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFncy5sZW5ndGg7ICsraSkge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0YWdzW2ldKSA9PT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICB2YXIgb3JlZFRhZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0YWdzW2ldLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgb3JlZFRhZ3MucHVzaCh0YWdzW2ldW2pdKTtcbiAgICAgICAgfVxuICAgICAgICBzdHJUYWdzLnB1c2goJygnICsgb3JlZFRhZ3Muam9pbignLCcpICsgJyknKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0clRhZ3MucHVzaCh0YWdzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGFncyA9IHN0clRhZ3Muam9pbignLCcpO1xuICB9XG5cbiAgdGhpcy5zZWN1cml0eVRhZ3MgPSB0YWdzO1xufTtcblxuLyoqXG4gKiBTZXQgdGhlIGV4dHJhIHVzZXIgdG9rZW4gaGVhZGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gdXNlclRva2VuIFRoZSB0b2tlbiBpZGVudGlmeWluZyBhIHVuaXEgdXNlciAodXNlZCB0byBhcHBseSByYXRlIGxpbWl0cylcbiAqL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLnNldFVzZXJUb2tlbiA9IGZ1bmN0aW9uKHVzZXJUb2tlbikge1xuICB0aGlzLnVzZXJUb2tlbiA9IHVzZXJUb2tlbjtcbn07XG5cbi8qKlxuICogQ2xlYXIgYWxsIHF1ZXJpZXMgaW4gY2xpZW50J3MgY2FjaGVcbiAqIEByZXR1cm4gdW5kZWZpbmVkXG4gKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5jbGVhckNhY2hlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuY2FjaGUgPSB7fTtcbn07XG5cbi8qKlxuKiBTZXQgdGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgYSByZXF1ZXN0IGNhbiB0YWtlIGJlZm9yZSBhdXRvbWF0aWNhbGx5IGJlaW5nIHRlcm1pbmF0ZWQuXG4qIEBkZXByZWNhdGVkXG4qIEBwYXJhbSB7TnVtYmVyfSBtaWxsaXNlY29uZHNcbiovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuc2V0UmVxdWVzdFRpbWVvdXQgPSBmdW5jdGlvbihtaWxsaXNlY29uZHMpIHtcbiAgaWYgKG1pbGxpc2Vjb25kcykge1xuICAgIHRoaXMuX3RpbWVvdXRzLmNvbm5lY3QgPSB0aGlzLl90aW1lb3V0cy5yZWFkID0gdGhpcy5fdGltZW91dHMud3JpdGUgPSBtaWxsaXNlY29uZHM7XG4gIH1cbn07XG5cbi8qKlxuKiBTZXQgdGhlIHRocmVlIGRpZmZlcmVudCAoY29ubmVjdCwgcmVhZCwgd3JpdGUpIHRpbWVvdXRzIHRvIGJlIHVzZWQgd2hlbiByZXF1ZXN0aW5nXG4qIEBwYXJhbSB7T2JqZWN0fSB0aW1lb3V0c1xuKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5zZXRUaW1lb3V0cyA9IGZ1bmN0aW9uKHRpbWVvdXRzKSB7XG4gIHRoaXMuX3RpbWVvdXRzID0gdGltZW91dHM7XG59O1xuXG4vKipcbiogR2V0IHRoZSB0aHJlZSBkaWZmZXJlbnQgKGNvbm5lY3QsIHJlYWQsIHdyaXRlKSB0aW1lb3V0cyB0byBiZSB1c2VkIHdoZW4gcmVxdWVzdGluZ1xuKiBAcGFyYW0ge09iamVjdH0gdGltZW91dHNcbiovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuZ2V0VGltZW91dHMgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMuX3RpbWVvdXRzO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9nZXRBcHBJZERhdGEgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGRhdGEgPSBzdG9yZS5nZXQodGhpcy5hcHBsaWNhdGlvbklEKTtcbiAgaWYgKGRhdGEgIT09IG51bGwpIHRoaXMuX2NhY2hlQXBwSWREYXRhKGRhdGEpO1xuICByZXR1cm4gZGF0YTtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fc2V0QXBwSWREYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICBkYXRhLmxhc3RDaGFuZ2UgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xuICB0aGlzLl9jYWNoZUFwcElkRGF0YShkYXRhKTtcbiAgcmV0dXJuIHN0b3JlLnNldCh0aGlzLmFwcGxpY2F0aW9uSUQsIGRhdGEpO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9jaGVja0FwcElkRGF0YSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgZGF0YSA9IHRoaXMuX2dldEFwcElkRGF0YSgpO1xuICB2YXIgbm93ID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcbiAgaWYgKGRhdGEgPT09IG51bGwgfHwgbm93IC0gZGF0YS5sYXN0Q2hhbmdlID4gUkVTRVRfQVBQX0RBVEFfVElNRVIpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVzZXRJbml0aWFsQXBwSWREYXRhKGRhdGEpO1xuICB9XG5cbiAgcmV0dXJuIGRhdGE7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX3Jlc2V0SW5pdGlhbEFwcElkRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgdmFyIG5ld0RhdGEgPSBkYXRhIHx8IHt9O1xuICBuZXdEYXRhLmhvc3RJbmRleGVzID0ge3JlYWQ6IDAsIHdyaXRlOiAwfTtcbiAgbmV3RGF0YS50aW1lb3V0TXVsdGlwbGllciA9IDE7XG4gIG5ld0RhdGEuc2h1ZmZsZVJlc3VsdCA9IG5ld0RhdGEuc2h1ZmZsZVJlc3VsdCB8fCBzaHVmZmxlKFsxLCAyLCAzXSk7XG4gIHJldHVybiB0aGlzLl9zZXRBcHBJZERhdGEobmV3RGF0YSk7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2NhY2hlQXBwSWREYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICB0aGlzLl9ob3N0SW5kZXhlcyA9IGRhdGEuaG9zdEluZGV4ZXM7XG4gIHRoaXMuX3RpbWVvdXRNdWx0aXBsaWVyID0gZGF0YS50aW1lb3V0TXVsdGlwbGllcjtcbiAgdGhpcy5fc2h1ZmZsZVJlc3VsdCA9IGRhdGEuc2h1ZmZsZVJlc3VsdDtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fcGFydGlhbEFwcElkRGF0YVVwZGF0ZSA9IGZ1bmN0aW9uKG5ld0RhdGEpIHtcbiAgdmFyIGZvcmVhY2ggPSByZXF1aXJlKCdmb3JlYWNoJyk7XG4gIHZhciBjdXJyZW50RGF0YSA9IHRoaXMuX2dldEFwcElkRGF0YSgpO1xuICBmb3JlYWNoKG5ld0RhdGEsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICBjdXJyZW50RGF0YVtrZXldID0gdmFsdWU7XG4gIH0pO1xuXG4gIHJldHVybiB0aGlzLl9zZXRBcHBJZERhdGEoY3VycmVudERhdGEpO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9nZXRIb3N0QnlUeXBlID0gZnVuY3Rpb24oaG9zdFR5cGUpIHtcbiAgcmV0dXJuIHRoaXMuaG9zdHNbaG9zdFR5cGVdW3RoaXMuX2dldEhvc3RJbmRleEJ5VHlwZShob3N0VHlwZSldO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9nZXRUaW1lb3V0TXVsdGlwbGllciA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5fdGltZW91dE11bHRpcGxpZXI7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2dldEhvc3RJbmRleEJ5VHlwZSA9IGZ1bmN0aW9uKGhvc3RUeXBlKSB7XG4gIHJldHVybiB0aGlzLl9ob3N0SW5kZXhlc1tob3N0VHlwZV07XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX3NldEhvc3RJbmRleEJ5VHlwZSA9IGZ1bmN0aW9uKGhvc3RJbmRleCwgaG9zdFR5cGUpIHtcbiAgdmFyIGNsb25lID0gcmVxdWlyZSgnLi9jbG9uZScpO1xuICB2YXIgbmV3SG9zdEluZGV4ZXMgPSBjbG9uZSh0aGlzLl9ob3N0SW5kZXhlcyk7XG4gIG5ld0hvc3RJbmRleGVzW2hvc3RUeXBlXSA9IGhvc3RJbmRleDtcbiAgdGhpcy5fcGFydGlhbEFwcElkRGF0YVVwZGF0ZSh7aG9zdEluZGV4ZXM6IG5ld0hvc3RJbmRleGVzfSk7XG4gIHJldHVybiBob3N0SW5kZXg7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2luY3JlbWVudEhvc3RJbmRleCA9IGZ1bmN0aW9uKGhvc3RUeXBlKSB7XG4gIHJldHVybiB0aGlzLl9zZXRIb3N0SW5kZXhCeVR5cGUoXG4gICAgKHRoaXMuX2dldEhvc3RJbmRleEJ5VHlwZShob3N0VHlwZSkgKyAxKSAlIHRoaXMuaG9zdHNbaG9zdFR5cGVdLmxlbmd0aCwgaG9zdFR5cGVcbiAgKTtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5faW5jcmVtZW50VGltZW91dE11bHRpcGxlciA9IGZ1bmN0aW9uKCkge1xuICB2YXIgdGltZW91dE11bHRpcGxpZXIgPSBNYXRoLm1heCh0aGlzLl90aW1lb3V0TXVsdGlwbGllciArIDEsIDQpO1xuICByZXR1cm4gdGhpcy5fcGFydGlhbEFwcElkRGF0YVVwZGF0ZSh7dGltZW91dE11bHRpcGxpZXI6IHRpbWVvdXRNdWx0aXBsaWVyfSk7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2dldFRpbWVvdXRzRm9yUmVxdWVzdCA9IGZ1bmN0aW9uKGhvc3RUeXBlKSB7XG4gIHJldHVybiB7XG4gICAgY29ubmVjdDogdGhpcy5fdGltZW91dHMuY29ubmVjdCAqIHRoaXMuX3RpbWVvdXRNdWx0aXBsaWVyLFxuICAgIGNvbXBsZXRlOiB0aGlzLl90aW1lb3V0c1tob3N0VHlwZV0gKiB0aGlzLl90aW1lb3V0TXVsdGlwbGllclxuICB9O1xufTtcblxuZnVuY3Rpb24gcHJlcGFyZUhvc3QocHJvdG9jb2wpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHByZXBhcmUoaG9zdCkge1xuICAgIHJldHVybiBwcm90b2NvbCArICcvLycgKyBob3N0LnRvTG93ZXJDYXNlKCk7XG4gIH07XG59XG5cbi8vIFByb3RvdHlwZS5qcyA8IDEuNywgYSB3aWRlbHkgdXNlZCBsaWJyYXJ5LCBkZWZpbmVzIGEgd2VpcmRcbi8vIEFycmF5LnByb3RvdHlwZS50b0pTT04gZnVuY3Rpb24gdGhhdCB3aWxsIGZhaWwgdG8gc3RyaW5naWZ5IG91ciBjb250ZW50XG4vLyBhcHByb3ByaWF0ZWx5XG4vLyByZWZzOlxuLy8gICAtIGh0dHBzOi8vZ3JvdXBzLmdvb2dsZS5jb20vZm9ydW0vIyF0b3BpYy9wcm90b3R5cGUtY29yZS9FLVNBVnZWX1Y5UVxuLy8gICAtIGh0dHBzOi8vZ2l0aHViLmNvbS9zc3RlcGhlbnNvbi9wcm90b3R5cGUvY29tbWl0LzAzOGEyOTg1YTcwNTkzYzFhODZjMjMwZmFkYmRmZTJlNDg5OGE0OGNcbi8vICAgLSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zMTQ4NDQxLzE0NzA3OVxuZnVuY3Rpb24gc2FmZUpTT05TdHJpbmdpZnkob2JqKSB7XG4gIC8qIGVzbGludCBuby1leHRlbmQtbmF0aXZlOjAgKi9cblxuICBpZiAoQXJyYXkucHJvdG90eXBlLnRvSlNPTiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaik7XG4gIH1cblxuICB2YXIgdG9KU09OID0gQXJyYXkucHJvdG90eXBlLnRvSlNPTjtcbiAgZGVsZXRlIEFycmF5LnByb3RvdHlwZS50b0pTT047XG4gIHZhciBvdXQgPSBKU09OLnN0cmluZ2lmeShvYmopO1xuICBBcnJheS5wcm90b3R5cGUudG9KU09OID0gdG9KU09OO1xuXG4gIHJldHVybiBvdXQ7XG59XG5cbmZ1bmN0aW9uIHNodWZmbGUoYXJyYXkpIHtcbiAgdmFyIGN1cnJlbnRJbmRleCA9IGFycmF5Lmxlbmd0aDtcbiAgdmFyIHRlbXBvcmFyeVZhbHVlO1xuICB2YXIgcmFuZG9tSW5kZXg7XG5cbiAgLy8gV2hpbGUgdGhlcmUgcmVtYWluIGVsZW1lbnRzIHRvIHNodWZmbGUuLi5cbiAgd2hpbGUgKGN1cnJlbnRJbmRleCAhPT0gMCkge1xuICAgIC8vIFBpY2sgYSByZW1haW5pbmcgZWxlbWVudC4uLlxuICAgIHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY3VycmVudEluZGV4KTtcbiAgICBjdXJyZW50SW5kZXggLT0gMTtcblxuICAgIC8vIEFuZCBzd2FwIGl0IHdpdGggdGhlIGN1cnJlbnQgZWxlbWVudC5cbiAgICB0ZW1wb3JhcnlWYWx1ZSA9IGFycmF5W2N1cnJlbnRJbmRleF07XG4gICAgYXJyYXlbY3VycmVudEluZGV4XSA9IGFycmF5W3JhbmRvbUluZGV4XTtcbiAgICBhcnJheVtyYW5kb21JbmRleF0gPSB0ZW1wb3JhcnlWYWx1ZTtcbiAgfVxuXG4gIHJldHVybiBhcnJheTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlQ3JlZGVudGlhbHMoaGVhZGVycykge1xuICB2YXIgbmV3SGVhZGVycyA9IHt9O1xuXG4gIGZvciAodmFyIGhlYWRlck5hbWUgaW4gaGVhZGVycykge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoaGVhZGVycywgaGVhZGVyTmFtZSkpIHtcbiAgICAgIHZhciB2YWx1ZTtcblxuICAgICAgaWYgKGhlYWRlck5hbWUgPT09ICd4LWFsZ29saWEtYXBpLWtleScgfHwgaGVhZGVyTmFtZSA9PT0gJ3gtYWxnb2xpYS1hcHBsaWNhdGlvbi1pZCcpIHtcbiAgICAgICAgdmFsdWUgPSAnKipoaWRkZW4gZm9yIHNlY3VyaXR5IHB1cnBvc2VzKionO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSBoZWFkZXJzW2hlYWRlck5hbWVdO1xuICAgICAgfVxuXG4gICAgICBuZXdIZWFkZXJzW2hlYWRlck5hbWVdID0gdmFsdWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ld0hlYWRlcnM7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvQWxnb2xpYVNlYXJjaENvcmUuanNcbi8vIG1vZHVsZSBpZCA9IDQzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBidWlsZFNlYXJjaE1ldGhvZCA9IHJlcXVpcmUoJy4vYnVpbGRTZWFyY2hNZXRob2QuanMnKTtcbnZhciBkZXByZWNhdGUgPSByZXF1aXJlKCcuL2RlcHJlY2F0ZS5qcycpO1xudmFyIGRlcHJlY2F0ZWRNZXNzYWdlID0gcmVxdWlyZSgnLi9kZXByZWNhdGVkTWVzc2FnZS5qcycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEluZGV4Q29yZTtcblxuLypcbiogSW5kZXggY2xhc3MgY29uc3RydWN0b3IuXG4qIFlvdSBzaG91bGQgbm90IHVzZSB0aGlzIG1ldGhvZCBkaXJlY3RseSBidXQgdXNlIGluaXRJbmRleCgpIGZ1bmN0aW9uXG4qL1xuZnVuY3Rpb24gSW5kZXhDb3JlKGFsZ29saWFzZWFyY2gsIGluZGV4TmFtZSkge1xuICB0aGlzLmluZGV4TmFtZSA9IGluZGV4TmFtZTtcbiAgdGhpcy5hcyA9IGFsZ29saWFzZWFyY2g7XG4gIHRoaXMudHlwZUFoZWFkQXJncyA9IG51bGw7XG4gIHRoaXMudHlwZUFoZWFkVmFsdWVPcHRpb24gPSBudWxsO1xuXG4gIC8vIG1ha2Ugc3VyZSBldmVyeSBpbmRleCBpbnN0YW5jZSBoYXMgaXQncyBvd24gY2FjaGVcbiAgdGhpcy5jYWNoZSA9IHt9O1xufVxuXG4vKlxuKiBDbGVhciBhbGwgcXVlcmllcyBpbiBjYWNoZVxuKi9cbkluZGV4Q29yZS5wcm90b3R5cGUuY2xlYXJDYWNoZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmNhY2hlID0ge307XG59O1xuXG4vKlxuKiBTZWFyY2ggaW5zaWRlIHRoZSBpbmRleCB1c2luZyBYTUxIdHRwUmVxdWVzdCByZXF1ZXN0IChVc2luZyBhIFBPU1QgcXVlcnkgdG9cbiogbWluaW1pemUgbnVtYmVyIG9mIE9QVElPTlMgcXVlcmllczogQ3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmcpLlxuKlxuKiBAcGFyYW0ge3N0cmluZ30gW3F1ZXJ5XSB0aGUgZnVsbCB0ZXh0IHF1ZXJ5XG4qIEBwYXJhbSB7b2JqZWN0fSBbYXJnc10gKG9wdGlvbmFsKSBpZiBzZXQsIGNvbnRhaW5zIGFuIG9iamVjdCB3aXRoIHF1ZXJ5IHBhcmFtZXRlcnM6XG4qIC0gcGFnZTogKGludGVnZXIpIFBhZ2luYXRpb24gcGFyYW1ldGVyIHVzZWQgdG8gc2VsZWN0IHRoZSBwYWdlIHRvIHJldHJpZXZlLlxuKiAgICAgICAgICAgICAgICAgICBQYWdlIGlzIHplcm8tYmFzZWQgYW5kIGRlZmF1bHRzIHRvIDAuIFRodXMsXG4qICAgICAgICAgICAgICAgICAgIHRvIHJldHJpZXZlIHRoZSAxMHRoIHBhZ2UgeW91IG5lZWQgdG8gc2V0IHBhZ2U9OVxuKiAtIGhpdHNQZXJQYWdlOiAoaW50ZWdlcikgUGFnaW5hdGlvbiBwYXJhbWV0ZXIgdXNlZCB0byBzZWxlY3QgdGhlIG51bWJlciBvZiBoaXRzIHBlciBwYWdlLiBEZWZhdWx0cyB0byAyMC5cbiogLSBhdHRyaWJ1dGVzVG9SZXRyaWV2ZTogYSBzdHJpbmcgdGhhdCBjb250YWlucyB0aGUgbGlzdCBvZiBvYmplY3QgYXR0cmlidXRlc1xuKiB5b3Ugd2FudCB0byByZXRyaWV2ZSAobGV0IHlvdSBtaW5pbWl6ZSB0aGUgYW5zd2VyIHNpemUpLlxuKiAgIEF0dHJpYnV0ZXMgYXJlIHNlcGFyYXRlZCB3aXRoIGEgY29tbWEgKGZvciBleGFtcGxlIFwibmFtZSxhZGRyZXNzXCIpLlxuKiAgIFlvdSBjYW4gYWxzbyB1c2UgYW4gYXJyYXkgKGZvciBleGFtcGxlIFtcIm5hbWVcIixcImFkZHJlc3NcIl0pLlxuKiAgIEJ5IGRlZmF1bHQsIGFsbCBhdHRyaWJ1dGVzIGFyZSByZXRyaWV2ZWQuIFlvdSBjYW4gYWxzbyB1c2UgJyonIHRvIHJldHJpZXZlIGFsbFxuKiAgIHZhbHVlcyB3aGVuIGFuIGF0dHJpYnV0ZXNUb1JldHJpZXZlIHNldHRpbmcgaXMgc3BlY2lmaWVkIGZvciB5b3VyIGluZGV4LlxuKiAtIGF0dHJpYnV0ZXNUb0hpZ2hsaWdodDogYSBzdHJpbmcgdGhhdCBjb250YWlucyB0aGUgbGlzdCBvZiBhdHRyaWJ1dGVzIHlvdVxuKiAgIHdhbnQgdG8gaGlnaGxpZ2h0IGFjY29yZGluZyB0byB0aGUgcXVlcnkuXG4qICAgQXR0cmlidXRlcyBhcmUgc2VwYXJhdGVkIGJ5IGEgY29tbWEuIFlvdSBjYW4gYWxzbyB1c2UgYW4gYXJyYXkgKGZvciBleGFtcGxlIFtcIm5hbWVcIixcImFkZHJlc3NcIl0pLlxuKiAgIElmIGFuIGF0dHJpYnV0ZSBoYXMgbm8gbWF0Y2ggZm9yIHRoZSBxdWVyeSwgdGhlIHJhdyB2YWx1ZSBpcyByZXR1cm5lZC5cbiogICBCeSBkZWZhdWx0IGFsbCBpbmRleGVkIHRleHQgYXR0cmlidXRlcyBhcmUgaGlnaGxpZ2h0ZWQuXG4qICAgWW91IGNhbiB1c2UgYCpgIGlmIHlvdSB3YW50IHRvIGhpZ2hsaWdodCBhbGwgdGV4dHVhbCBhdHRyaWJ1dGVzLlxuKiAgIE51bWVyaWNhbCBhdHRyaWJ1dGVzIGFyZSBub3QgaGlnaGxpZ2h0ZWQuXG4qICAgQSBtYXRjaExldmVsIGlzIHJldHVybmVkIGZvciBlYWNoIGhpZ2hsaWdodGVkIGF0dHJpYnV0ZSBhbmQgY2FuIGNvbnRhaW46XG4qICAgICAgLSBmdWxsOiBpZiBhbGwgdGhlIHF1ZXJ5IHRlcm1zIHdlcmUgZm91bmQgaW4gdGhlIGF0dHJpYnV0ZSxcbiogICAgICAtIHBhcnRpYWw6IGlmIG9ubHkgc29tZSBvZiB0aGUgcXVlcnkgdGVybXMgd2VyZSBmb3VuZCxcbiogICAgICAtIG5vbmU6IGlmIG5vbmUgb2YgdGhlIHF1ZXJ5IHRlcm1zIHdlcmUgZm91bmQuXG4qIC0gYXR0cmlidXRlc1RvU25pcHBldDogYSBzdHJpbmcgdGhhdCBjb250YWlucyB0aGUgbGlzdCBvZiBhdHRyaWJ1dGVzIHRvIHNuaXBwZXQgYWxvbmdzaWRlXG4qIHRoZSBudW1iZXIgb2Ygd29yZHMgdG8gcmV0dXJuIChzeW50YXggaXMgYGF0dHJpYnV0ZU5hbWU6bmJXb3Jkc2ApLlxuKiAgICBBdHRyaWJ1dGVzIGFyZSBzZXBhcmF0ZWQgYnkgYSBjb21tYSAoRXhhbXBsZTogYXR0cmlidXRlc1RvU25pcHBldD1uYW1lOjEwLGNvbnRlbnQ6MTApLlxuKiAgICBZb3UgY2FuIGFsc28gdXNlIGFuIGFycmF5IChFeGFtcGxlOiBhdHRyaWJ1dGVzVG9TbmlwcGV0OiBbJ25hbWU6MTAnLCdjb250ZW50OjEwJ10pLlxuKiAgICBCeSBkZWZhdWx0IG5vIHNuaXBwZXQgaXMgY29tcHV0ZWQuXG4qIC0gbWluV29yZFNpemVmb3IxVHlwbzogdGhlIG1pbmltdW0gbnVtYmVyIG9mIGNoYXJhY3RlcnMgaW4gYSBxdWVyeSB3b3JkIHRvIGFjY2VwdCBvbmUgdHlwbyBpbiB0aGlzIHdvcmQuXG4qIERlZmF1bHRzIHRvIDMuXG4qIC0gbWluV29yZFNpemVmb3IyVHlwb3M6IHRoZSBtaW5pbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzIGluIGEgcXVlcnkgd29yZFxuKiB0byBhY2NlcHQgdHdvIHR5cG9zIGluIHRoaXMgd29yZC4gRGVmYXVsdHMgdG8gNy5cbiogLSBnZXRSYW5raW5nSW5mbzogaWYgc2V0IHRvIDEsIHRoZSByZXN1bHQgaGl0cyB3aWxsIGNvbnRhaW4gcmFua2luZ1xuKiBpbmZvcm1hdGlvbiBpbiBfcmFua2luZ0luZm8gYXR0cmlidXRlLlxuKiAtIGFyb3VuZExhdExuZzogc2VhcmNoIGZvciBlbnRyaWVzIGFyb3VuZCBhIGdpdmVuXG4qIGxhdGl0dWRlL2xvbmdpdHVkZSAoc3BlY2lmaWVkIGFzIHR3byBmbG9hdHMgc2VwYXJhdGVkIGJ5IGEgY29tbWEpLlxuKiAgIEZvciBleGFtcGxlIGFyb3VuZExhdExuZz00Ny4zMTY2NjksNS4wMTY2NzApLlxuKiAgIFlvdSBjYW4gc3BlY2lmeSB0aGUgbWF4aW11bSBkaXN0YW5jZSBpbiBtZXRlcnMgd2l0aCB0aGUgYXJvdW5kUmFkaXVzIHBhcmFtZXRlciAoaW4gbWV0ZXJzKVxuKiAgIGFuZCB0aGUgcHJlY2lzaW9uIGZvciByYW5raW5nIHdpdGggYXJvdW5kUHJlY2lzaW9uXG4qICAgKGZvciBleGFtcGxlIGlmIHlvdSBzZXQgYXJvdW5kUHJlY2lzaW9uPTEwMCwgdHdvIG9iamVjdHMgdGhhdCBhcmUgZGlzdGFudCBvZlxuKiAgIGxlc3MgdGhhbiAxMDBtIHdpbGwgYmUgY29uc2lkZXJlZCBhcyBpZGVudGljYWwgZm9yIFwiZ2VvXCIgcmFua2luZyBwYXJhbWV0ZXIpLlxuKiAgIEF0IGluZGV4aW5nLCB5b3Ugc2hvdWxkIHNwZWNpZnkgZ2VvbG9jIG9mIGFuIG9iamVjdCB3aXRoIHRoZSBfZ2VvbG9jIGF0dHJpYnV0ZVxuKiAgIChpbiB0aGUgZm9ybSB7XCJfZ2VvbG9jXCI6e1wibGF0XCI6NDguODUzNDA5LCBcImxuZ1wiOjIuMzQ4ODAwfX0pXG4qIC0gaW5zaWRlQm91bmRpbmdCb3g6IHNlYXJjaCBlbnRyaWVzIGluc2lkZSBhIGdpdmVuIGFyZWEgZGVmaW5lZCBieSB0aGUgdHdvIGV4dHJlbWUgcG9pbnRzXG4qIG9mIGEgcmVjdGFuZ2xlIChkZWZpbmVkIGJ5IDQgZmxvYXRzOiBwMUxhdCxwMUxuZyxwMkxhdCxwMkxuZykuXG4qICAgRm9yIGV4YW1wbGUgaW5zaWRlQm91bmRpbmdCb3g9NDcuMzE2NSw0Ljk2NjUsNDcuMzQyNCw1LjAyMDEpLlxuKiAgIEF0IGluZGV4aW5nLCB5b3Ugc2hvdWxkIHNwZWNpZnkgZ2VvbG9jIG9mIGFuIG9iamVjdCB3aXRoIHRoZSBfZ2VvbG9jIGF0dHJpYnV0ZVxuKiAgIChpbiB0aGUgZm9ybSB7XCJfZ2VvbG9jXCI6e1wibGF0XCI6NDguODUzNDA5LCBcImxuZ1wiOjIuMzQ4ODAwfX0pXG4qIC0gbnVtZXJpY0ZpbHRlcnM6IGEgc3RyaW5nIHRoYXQgY29udGFpbnMgdGhlIGxpc3Qgb2YgbnVtZXJpYyBmaWx0ZXJzIHlvdSB3YW50IHRvXG4qIGFwcGx5IHNlcGFyYXRlZCBieSBhIGNvbW1hLlxuKiAgIFRoZSBzeW50YXggb2Ygb25lIGZpbHRlciBpcyBgYXR0cmlidXRlTmFtZWAgZm9sbG93ZWQgYnkgYG9wZXJhbmRgIGZvbGxvd2VkIGJ5IGB2YWx1ZWAuXG4qICAgU3VwcG9ydGVkIG9wZXJhbmRzIGFyZSBgPGAsIGA8PWAsIGA9YCwgYD5gIGFuZCBgPj1gLlxuKiAgIFlvdSBjYW4gaGF2ZSBtdWx0aXBsZSBjb25kaXRpb25zIG9uIG9uZSBhdHRyaWJ1dGUgbGlrZSBmb3IgZXhhbXBsZSBudW1lcmljRmlsdGVycz1wcmljZT4xMDAscHJpY2U8MTAwMC5cbiogICBZb3UgY2FuIGFsc28gdXNlIGFuIGFycmF5IChmb3IgZXhhbXBsZSBudW1lcmljRmlsdGVyczogW1wicHJpY2U+MTAwXCIsXCJwcmljZTwxMDAwXCJdKS5cbiogLSB0YWdGaWx0ZXJzOiBmaWx0ZXIgdGhlIHF1ZXJ5IGJ5IGEgc2V0IG9mIHRhZ3MuIFlvdSBjYW4gQU5EIHRhZ3MgYnkgc2VwYXJhdGluZyB0aGVtIGJ5IGNvbW1hcy5cbiogICBUbyBPUiB0YWdzLCB5b3UgbXVzdCBhZGQgcGFyZW50aGVzZXMuIEZvciBleGFtcGxlLCB0YWdzPXRhZzEsKHRhZzIsdGFnMykgbWVhbnMgdGFnMSBBTkQgKHRhZzIgT1IgdGFnMykuXG4qICAgWW91IGNhbiBhbHNvIHVzZSBhbiBhcnJheSwgZm9yIGV4YW1wbGUgdGFnRmlsdGVyczogW1widGFnMVwiLFtcInRhZzJcIixcInRhZzNcIl1dXG4qICAgbWVhbnMgdGFnMSBBTkQgKHRhZzIgT1IgdGFnMykuXG4qICAgQXQgaW5kZXhpbmcsIHRhZ3Mgc2hvdWxkIGJlIGFkZGVkIGluIHRoZSBfdGFncyoqIGF0dHJpYnV0ZVxuKiAgIG9mIG9iamVjdHMgKGZvciBleGFtcGxlIHtcIl90YWdzXCI6W1widGFnMVwiLFwidGFnMlwiXX0pLlxuKiAtIGZhY2V0RmlsdGVyczogZmlsdGVyIHRoZSBxdWVyeSBieSBhIGxpc3Qgb2YgZmFjZXRzLlxuKiAgIEZhY2V0cyBhcmUgc2VwYXJhdGVkIGJ5IGNvbW1hcyBhbmQgZWFjaCBmYWNldCBpcyBlbmNvZGVkIGFzIGBhdHRyaWJ1dGVOYW1lOnZhbHVlYC5cbiogICBGb3IgZXhhbXBsZTogYGZhY2V0RmlsdGVycz1jYXRlZ29yeTpCb29rLGF1dGhvcjpKb2huJTIwRG9lYC5cbiogICBZb3UgY2FuIGFsc28gdXNlIGFuIGFycmF5IChmb3IgZXhhbXBsZSBgW1wiY2F0ZWdvcnk6Qm9va1wiLFwiYXV0aG9yOkpvaG4lMjBEb2VcIl1gKS5cbiogLSBmYWNldHM6IExpc3Qgb2Ygb2JqZWN0IGF0dHJpYnV0ZXMgdGhhdCB5b3Ugd2FudCB0byB1c2UgZm9yIGZhY2V0aW5nLlxuKiAgIENvbW1hIHNlcGFyYXRlZCBsaXN0OiBgXCJjYXRlZ29yeSxhdXRob3JcImAgb3IgYXJyYXkgYFsnY2F0ZWdvcnknLCdhdXRob3InXWBcbiogICBPbmx5IGF0dHJpYnV0ZXMgdGhhdCBoYXZlIGJlZW4gYWRkZWQgaW4gKiphdHRyaWJ1dGVzRm9yRmFjZXRpbmcqKiBpbmRleCBzZXR0aW5nXG4qICAgY2FuIGJlIHVzZWQgaW4gdGhpcyBwYXJhbWV0ZXIuXG4qICAgWW91IGNhbiBhbHNvIHVzZSBgKmAgdG8gcGVyZm9ybSBmYWNldGluZyBvbiBhbGwgYXR0cmlidXRlcyBzcGVjaWZpZWQgaW4gKiphdHRyaWJ1dGVzRm9yRmFjZXRpbmcqKi5cbiogLSBxdWVyeVR5cGU6IHNlbGVjdCBob3cgdGhlIHF1ZXJ5IHdvcmRzIGFyZSBpbnRlcnByZXRlZCwgaXQgY2FuIGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nIHZhbHVlOlxuKiAgICAtIHByZWZpeEFsbDogYWxsIHF1ZXJ5IHdvcmRzIGFyZSBpbnRlcnByZXRlZCBhcyBwcmVmaXhlcyxcbiogICAgLSBwcmVmaXhMYXN0OiBvbmx5IHRoZSBsYXN0IHdvcmQgaXMgaW50ZXJwcmV0ZWQgYXMgYSBwcmVmaXggKGRlZmF1bHQgYmVoYXZpb3IpLFxuKiAgICAtIHByZWZpeE5vbmU6IG5vIHF1ZXJ5IHdvcmQgaXMgaW50ZXJwcmV0ZWQgYXMgYSBwcmVmaXguIFRoaXMgb3B0aW9uIGlzIG5vdCByZWNvbW1lbmRlZC5cbiogLSBvcHRpb25hbFdvcmRzOiBhIHN0cmluZyB0aGF0IGNvbnRhaW5zIHRoZSBsaXN0IG9mIHdvcmRzIHRoYXQgc2hvdWxkXG4qIGJlIGNvbnNpZGVyZWQgYXMgb3B0aW9uYWwgd2hlbiBmb3VuZCBpbiB0aGUgcXVlcnkuXG4qICAgQ29tbWEgc2VwYXJhdGVkIGFuZCBhcnJheSBhcmUgYWNjZXB0ZWQuXG4qIC0gZGlzdGluY3Q6IElmIHNldCB0byAxLCBlbmFibGUgdGhlIGRpc3RpbmN0IGZlYXR1cmUgKGRpc2FibGVkIGJ5IGRlZmF1bHQpXG4qIGlmIHRoZSBhdHRyaWJ1dGVGb3JEaXN0aW5jdCBpbmRleCBzZXR0aW5nIGlzIHNldC5cbiogICBUaGlzIGZlYXR1cmUgaXMgc2ltaWxhciB0byB0aGUgU1FMIFwiZGlzdGluY3RcIiBrZXl3b3JkOiB3aGVuIGVuYWJsZWRcbiogICBpbiBhIHF1ZXJ5IHdpdGggdGhlIGRpc3RpbmN0PTEgcGFyYW1ldGVyLFxuKiAgIGFsbCBoaXRzIGNvbnRhaW5pbmcgYSBkdXBsaWNhdGUgdmFsdWUgZm9yIHRoZSBhdHRyaWJ1dGVGb3JEaXN0aW5jdCBhdHRyaWJ1dGUgYXJlIHJlbW92ZWQgZnJvbSByZXN1bHRzLlxuKiAgIEZvciBleGFtcGxlLCBpZiB0aGUgY2hvc2VuIGF0dHJpYnV0ZSBpcyBzaG93X25hbWUgYW5kIHNldmVyYWwgaGl0cyBoYXZlXG4qICAgdGhlIHNhbWUgdmFsdWUgZm9yIHNob3dfbmFtZSwgdGhlbiBvbmx5IHRoZSBiZXN0XG4qICAgb25lIGlzIGtlcHQgYW5kIG90aGVycyBhcmUgcmVtb3ZlZC5cbiogLSByZXN0cmljdFNlYXJjaGFibGVBdHRyaWJ1dGVzOiBMaXN0IG9mIGF0dHJpYnV0ZXMgeW91IHdhbnQgdG8gdXNlIGZvclxuKiB0ZXh0dWFsIHNlYXJjaCAobXVzdCBiZSBhIHN1YnNldCBvZiB0aGUgYXR0cmlidXRlc1RvSW5kZXggaW5kZXggc2V0dGluZylcbiogZWl0aGVyIGNvbW1hIHNlcGFyYXRlZCBvciBhcyBhbiBhcnJheVxuKiBAcGFyYW0ge2Z1bmN0aW9ufSBbY2FsbGJhY2tdIHRoZSByZXN1bHQgY2FsbGJhY2sgY2FsbGVkIHdpdGggdHdvIGFyZ3VtZW50czpcbiogIGVycm9yOiBudWxsIG9yIEVycm9yKCdtZXNzYWdlJykuIElmIGZhbHNlLCB0aGUgY29udGVudCBjb250YWlucyB0aGUgZXJyb3IuXG4qICBjb250ZW50OiB0aGUgc2VydmVyIGFuc3dlciB0aGF0IGNvbnRhaW5zIHRoZSBsaXN0IG9mIHJlc3VsdHMuXG4qL1xuSW5kZXhDb3JlLnByb3RvdHlwZS5zZWFyY2ggPSBidWlsZFNlYXJjaE1ldGhvZCgncXVlcnknKTtcblxuLypcbiogLS0gQkVUQSAtLVxuKiBTZWFyY2ggYSByZWNvcmQgc2ltaWxhciB0byB0aGUgcXVlcnkgaW5zaWRlIHRoZSBpbmRleCB1c2luZyBYTUxIdHRwUmVxdWVzdCByZXF1ZXN0IChVc2luZyBhIFBPU1QgcXVlcnkgdG9cbiogbWluaW1pemUgbnVtYmVyIG9mIE9QVElPTlMgcXVlcmllczogQ3Jvc3MtT3JpZ2luIFJlc291cmNlIFNoYXJpbmcpLlxuKlxuKiBAcGFyYW0ge3N0cmluZ30gW3F1ZXJ5XSB0aGUgc2ltaWxhciBxdWVyeVxuKiBAcGFyYW0ge29iamVjdH0gW2FyZ3NdIChvcHRpb25hbCkgaWYgc2V0LCBjb250YWlucyBhbiBvYmplY3Qgd2l0aCBxdWVyeSBwYXJhbWV0ZXJzLlxuKiAgIEFsbCBzZWFyY2ggcGFyYW1ldGVycyBhcmUgc3VwcG9ydGVkIChzZWUgc2VhcmNoIGZ1bmN0aW9uKSwgcmVzdHJpY3RTZWFyY2hhYmxlQXR0cmlidXRlcyBhbmQgZmFjZXRGaWx0ZXJzXG4qICAgYXJlIHRoZSB0d28gbW9zdCB1c2VmdWwgdG8gcmVzdHJpY3QgdGhlIHNpbWlsYXIgcmVzdWx0cyBhbmQgZ2V0IG1vcmUgcmVsZXZhbnQgY29udGVudFxuKi9cbkluZGV4Q29yZS5wcm90b3R5cGUuc2ltaWxhclNlYXJjaCA9IGJ1aWxkU2VhcmNoTWV0aG9kKCdzaW1pbGFyUXVlcnknKTtcblxuLypcbiogQnJvd3NlIGluZGV4IGNvbnRlbnQuIFRoZSByZXNwb25zZSBjb250ZW50IHdpbGwgaGF2ZSBhIGBjdXJzb3JgIHByb3BlcnR5IHRoYXQgeW91IGNhbiB1c2VcbiogdG8gYnJvd3NlIHN1YnNlcXVlbnQgcGFnZXMgZm9yIHRoaXMgcXVlcnkuIFVzZSBgaW5kZXguYnJvd3NlRnJvbShjdXJzb3IpYCB3aGVuIHlvdSB3YW50LlxuKlxuKiBAcGFyYW0ge3N0cmluZ30gcXVlcnkgLSBUaGUgZnVsbCB0ZXh0IHF1ZXJ5XG4qIEBwYXJhbSB7T2JqZWN0fSBbcXVlcnlQYXJhbWV0ZXJzXSAtIEFueSBzZWFyY2ggcXVlcnkgcGFyYW1ldGVyXG4qIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFja10gLSBUaGUgcmVzdWx0IGNhbGxiYWNrIGNhbGxlZCB3aXRoIHR3byBhcmd1bWVudHNcbiogICBlcnJvcjogbnVsbCBvciBFcnJvcignbWVzc2FnZScpXG4qICAgY29udGVudDogdGhlIHNlcnZlciBhbnN3ZXIgd2l0aCB0aGUgYnJvd3NlIHJlc3VsdFxuKiBAcmV0dXJuIHtQcm9taXNlfHVuZGVmaW5lZH0gUmV0dXJucyBhIHByb21pc2UgaWYgbm8gY2FsbGJhY2sgZ2l2ZW5cbiogQGV4YW1wbGVcbiogaW5kZXguYnJvd3NlKCdjb29sIHNvbmdzJywge1xuKiAgIHRhZ0ZpbHRlcnM6ICdwdWJsaWMsY29tbWVudHMnLFxuKiAgIGhpdHNQZXJQYWdlOiA1MDBcbiogfSwgY2FsbGJhY2spO1xuKiBAc2VlIHtAbGluayBodHRwczovL3d3dy5hbGdvbGlhLmNvbS9kb2MvcmVzdF9hcGkjQnJvd3NlfEFsZ29saWEgUkVTVCBBUEkgRG9jdW1lbnRhdGlvbn1cbiovXG5JbmRleENvcmUucHJvdG90eXBlLmJyb3dzZSA9IGZ1bmN0aW9uKHF1ZXJ5LCBxdWVyeVBhcmFtZXRlcnMsIGNhbGxiYWNrKSB7XG4gIHZhciBtZXJnZSA9IHJlcXVpcmUoJy4vbWVyZ2UuanMnKTtcblxuICB2YXIgaW5kZXhPYmogPSB0aGlzO1xuXG4gIHZhciBwYWdlO1xuICB2YXIgaGl0c1BlclBhZ2U7XG5cbiAgLy8gd2UgY2hlY2sgdmFyaWFkaWMgY2FsbHMgdGhhdCBhcmUgbm90IHRoZSBvbmUgZGVmaW5lZFxuICAvLyAuYnJvd3NlKCkvLmJyb3dzZShmbilcbiAgLy8gPT4gcGFnZSA9IDBcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcGFnZSA9IDA7XG4gICAgY2FsbGJhY2sgPSBhcmd1bWVudHNbMF07XG4gICAgcXVlcnkgPSB1bmRlZmluZWQ7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ251bWJlcicpIHtcbiAgICAvLyAuYnJvd3NlKDIpLy5icm93c2UoMiwgMTApLy5icm93c2UoMiwgZm4pLy5icm93c2UoMiwgMTAsIGZuKVxuICAgIHBhZ2UgPSBhcmd1bWVudHNbMF07XG4gICAgaWYgKHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdudW1iZXInKSB7XG4gICAgICBoaXRzUGVyUGFnZSA9IGFyZ3VtZW50c1sxXTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNhbGxiYWNrID0gYXJndW1lbnRzWzFdO1xuICAgICAgaGl0c1BlclBhZ2UgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHF1ZXJ5ID0gdW5kZWZpbmVkO1xuICAgIHF1ZXJ5UGFyYW1ldGVycyA9IHVuZGVmaW5lZDtcbiAgfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0Jykge1xuICAgIC8vIC5icm93c2UocXVlcnlQYXJhbWV0ZXJzKS8uYnJvd3NlKHF1ZXJ5UGFyYW1ldGVycywgY2IpXG4gICAgaWYgKHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNhbGxiYWNrID0gYXJndW1lbnRzWzFdO1xuICAgIH1cbiAgICBxdWVyeVBhcmFtZXRlcnMgPSBhcmd1bWVudHNbMF07XG4gICAgcXVlcnkgPSB1bmRlZmluZWQ7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ3N0cmluZycgJiYgdHlwZW9mIGFyZ3VtZW50c1sxXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIC8vIC5icm93c2UocXVlcnksIGNiKVxuICAgIGNhbGxiYWNrID0gYXJndW1lbnRzWzFdO1xuICAgIHF1ZXJ5UGFyYW1ldGVycyA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8vIG90aGVyd2lzZSBpdCdzIGEgLmJyb3dzZShxdWVyeSkvLmJyb3dzZShxdWVyeSwgcXVlcnlQYXJhbWV0ZXJzKS8uYnJvd3NlKHF1ZXJ5LCBxdWVyeVBhcmFtZXRlcnMsIGNiKVxuXG4gIC8vIGdldCBzZWFyY2ggcXVlcnkgcGFyYW1ldGVycyBjb21iaW5pbmcgdmFyaW91cyBwb3NzaWJsZSBjYWxsc1xuICAvLyB0byAuYnJvd3NlKCk7XG4gIHF1ZXJ5UGFyYW1ldGVycyA9IG1lcmdlKHt9LCBxdWVyeVBhcmFtZXRlcnMgfHwge30sIHtcbiAgICBwYWdlOiBwYWdlLFxuICAgIGhpdHNQZXJQYWdlOiBoaXRzUGVyUGFnZSxcbiAgICBxdWVyeTogcXVlcnlcbiAgfSk7XG5cbiAgdmFyIHBhcmFtcyA9IHRoaXMuYXMuX2dldFNlYXJjaFBhcmFtcyhxdWVyeVBhcmFtZXRlcnMsICcnKTtcblxuICByZXR1cm4gdGhpcy5hcy5fanNvblJlcXVlc3Qoe1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIHVybDogJy8xL2luZGV4ZXMvJyArIGVuY29kZVVSSUNvbXBvbmVudChpbmRleE9iai5pbmRleE5hbWUpICsgJy9icm93c2UnLFxuICAgIGJvZHk6IHtwYXJhbXM6IHBhcmFtc30sXG4gICAgaG9zdFR5cGU6ICdyZWFkJyxcbiAgICBjYWxsYmFjazogY2FsbGJhY2tcbiAgfSk7XG59O1xuXG4vKlxuKiBDb250aW51ZSBicm93c2luZyBmcm9tIGEgcHJldmlvdXMgcG9zaXRpb24gKGN1cnNvciksIG9idGFpbmVkIHZpYSBhIGNhbGwgdG8gYC5icm93c2UoKWAuXG4qXG4qIEBwYXJhbSB7c3RyaW5nfSBxdWVyeSAtIFRoZSBmdWxsIHRleHQgcXVlcnlcbiogQHBhcmFtIHtPYmplY3R9IFtxdWVyeVBhcmFtZXRlcnNdIC0gQW55IHNlYXJjaCBxdWVyeSBwYXJhbWV0ZXJcbiogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrXSAtIFRoZSByZXN1bHQgY2FsbGJhY2sgY2FsbGVkIHdpdGggdHdvIGFyZ3VtZW50c1xuKiAgIGVycm9yOiBudWxsIG9yIEVycm9yKCdtZXNzYWdlJylcbiogICBjb250ZW50OiB0aGUgc2VydmVyIGFuc3dlciB3aXRoIHRoZSBicm93c2UgcmVzdWx0XG4qIEByZXR1cm4ge1Byb21pc2V8dW5kZWZpbmVkfSBSZXR1cm5zIGEgcHJvbWlzZSBpZiBubyBjYWxsYmFjayBnaXZlblxuKiBAZXhhbXBsZVxuKiBpbmRleC5icm93c2VGcm9tKCcxNGxrZnNha2wzMicsIGNhbGxiYWNrKTtcbiogQHNlZSB7QGxpbmsgaHR0cHM6Ly93d3cuYWxnb2xpYS5jb20vZG9jL3Jlc3RfYXBpI0Jyb3dzZXxBbGdvbGlhIFJFU1QgQVBJIERvY3VtZW50YXRpb259XG4qL1xuSW5kZXhDb3JlLnByb3RvdHlwZS5icm93c2VGcm9tID0gZnVuY3Rpb24oY3Vyc29yLCBjYWxsYmFjaykge1xuICByZXR1cm4gdGhpcy5hcy5fanNvblJlcXVlc3Qoe1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIHVybDogJy8xL2luZGV4ZXMvJyArIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmluZGV4TmFtZSkgKyAnL2Jyb3dzZScsXG4gICAgYm9keToge2N1cnNvcjogY3Vyc29yfSxcbiAgICBob3N0VHlwZTogJ3JlYWQnLFxuICAgIGNhbGxiYWNrOiBjYWxsYmFja1xuICB9KTtcbn07XG5cbi8qXG4qIFNlYXJjaCBmb3IgZmFjZXQgdmFsdWVzXG4qIGh0dHBzOi8vd3d3LmFsZ29saWEuY29tL2RvYy9yZXN0LWFwaS9zZWFyY2gjc2VhcmNoLWZvci1mYWNldC12YWx1ZXNcbipcbiogQHBhcmFtIHtzdHJpbmd9IHBhcmFtcy5mYWNldE5hbWUgRmFjZXQgbmFtZSwgbmFtZSBvZiB0aGUgYXR0cmlidXRlIHRvIHNlYXJjaCBmb3IgdmFsdWVzIGluLlxuKiBNdXN0IGJlIGRlY2xhcmVkIGFzIGEgZmFjZXRcbiogQHBhcmFtIHtzdHJpbmd9IHBhcmFtcy5mYWNldFF1ZXJ5IFF1ZXJ5IGZvciB0aGUgZmFjZXQgc2VhcmNoXG4qIEBwYXJhbSB7c3RyaW5nfSBbcGFyYW1zLipdIEFueSBzZWFyY2ggcGFyYW1ldGVyIG9mIEFsZ29saWEsXG4qIHNlZSBodHRwczovL3d3dy5hbGdvbGlhLmNvbS9kb2MvYXBpLWNsaWVudC9qYXZhc2NyaXB0L3NlYXJjaCNzZWFyY2gtcGFyYW1ldGVyc1xuKiBQYWdpbmF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQuIFRoZSBwYWdlIGFuZCBoaXRzUGVyUGFnZSBwYXJhbWV0ZXJzIHdpbGwgYmUgaWdub3JlZC5cbiogQHBhcmFtIGNhbGxiYWNrIChvcHRpb25hbClcbiovXG5JbmRleENvcmUucHJvdG90eXBlLnNlYXJjaEZvckZhY2V0VmFsdWVzID0gZnVuY3Rpb24ocGFyYW1zLCBjYWxsYmFjaykge1xuICB2YXIgY2xvbmUgPSByZXF1aXJlKCcuL2Nsb25lLmpzJyk7XG4gIHZhciBvbWl0ID0gcmVxdWlyZSgnLi9vbWl0LmpzJyk7XG4gIHZhciB1c2FnZSA9ICdVc2FnZTogaW5kZXguc2VhcmNoRm9yRmFjZXRWYWx1ZXMoe2ZhY2V0TmFtZSwgZmFjZXRRdWVyeSwgLi4ucGFyYW1zfVssIGNhbGxiYWNrXSknO1xuXG4gIGlmIChwYXJhbXMuZmFjZXROYW1lID09PSB1bmRlZmluZWQgfHwgcGFyYW1zLmZhY2V0UXVlcnkgPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBFcnJvcih1c2FnZSk7XG4gIH1cblxuICB2YXIgZmFjZXROYW1lID0gcGFyYW1zLmZhY2V0TmFtZTtcbiAgdmFyIGZpbHRlcmVkUGFyYW1zID0gb21pdChjbG9uZShwYXJhbXMpLCBmdW5jdGlvbihrZXlOYW1lKSB7XG4gICAgcmV0dXJuIGtleU5hbWUgPT09ICdmYWNldE5hbWUnO1xuICB9KTtcbiAgdmFyIHNlYXJjaFBhcmFtZXRlcnMgPSB0aGlzLmFzLl9nZXRTZWFyY2hQYXJhbXMoZmlsdGVyZWRQYXJhbXMsICcnKTtcblxuICByZXR1cm4gdGhpcy5hcy5fanNvblJlcXVlc3Qoe1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIHVybDogJy8xL2luZGV4ZXMvJyArXG4gICAgICBlbmNvZGVVUklDb21wb25lbnQodGhpcy5pbmRleE5hbWUpICsgJy9mYWNldHMvJyArIGVuY29kZVVSSUNvbXBvbmVudChmYWNldE5hbWUpICsgJy9xdWVyeScsXG4gICAgaG9zdFR5cGU6ICdyZWFkJyxcbiAgICBib2R5OiB7cGFyYW1zOiBzZWFyY2hQYXJhbWV0ZXJzfSxcbiAgICBjYWxsYmFjazogY2FsbGJhY2tcbiAgfSk7XG59O1xuXG5JbmRleENvcmUucHJvdG90eXBlLnNlYXJjaEZhY2V0ID0gZGVwcmVjYXRlKGZ1bmN0aW9uKHBhcmFtcywgY2FsbGJhY2spIHtcbiAgcmV0dXJuIHRoaXMuc2VhcmNoRm9yRmFjZXRWYWx1ZXMocGFyYW1zLCBjYWxsYmFjayk7XG59LCBkZXByZWNhdGVkTWVzc2FnZShcbiAgJ2luZGV4LnNlYXJjaEZhY2V0KHBhcmFtc1ssIGNhbGxiYWNrXSknLFxuICAnaW5kZXguc2VhcmNoRm9yRmFjZXRWYWx1ZXMocGFyYW1zWywgY2FsbGJhY2tdKSdcbikpO1xuXG5JbmRleENvcmUucHJvdG90eXBlLl9zZWFyY2ggPSBmdW5jdGlvbihwYXJhbXMsIHVybCwgY2FsbGJhY2ssIGFkZGl0aW9uYWxVQSkge1xuICByZXR1cm4gdGhpcy5hcy5fanNvblJlcXVlc3Qoe1xuICAgIGNhY2hlOiB0aGlzLmNhY2hlLFxuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIHVybDogdXJsIHx8ICcvMS9pbmRleGVzLycgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5pbmRleE5hbWUpICsgJy9xdWVyeScsXG4gICAgYm9keToge3BhcmFtczogcGFyYW1zfSxcbiAgICBob3N0VHlwZTogJ3JlYWQnLFxuICAgIGZhbGxiYWNrOiB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgdXJsOiAnLzEvaW5kZXhlcy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuaW5kZXhOYW1lKSxcbiAgICAgIGJvZHk6IHtwYXJhbXM6IHBhcmFtc31cbiAgICB9LFxuICAgIGNhbGxiYWNrOiBjYWxsYmFjayxcbiAgICBhZGRpdGlvbmFsVUE6IGFkZGl0aW9uYWxVQVxuICB9KTtcbn07XG5cbi8qXG4qIEdldCBhbiBvYmplY3QgZnJvbSB0aGlzIGluZGV4XG4qXG4qIEBwYXJhbSBvYmplY3RJRCB0aGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIG9iamVjdCB0byByZXRyaWV2ZVxuKiBAcGFyYW0gYXR0cnMgKG9wdGlvbmFsKSBpZiBzZXQsIGNvbnRhaW5zIHRoZSBhcnJheSBvZiBhdHRyaWJ1dGUgbmFtZXMgdG8gcmV0cmlldmVcbiogQHBhcmFtIGNhbGxiYWNrIChvcHRpb25hbCkgdGhlIHJlc3VsdCBjYWxsYmFjayBjYWxsZWQgd2l0aCB0d28gYXJndW1lbnRzXG4qICBlcnJvcjogbnVsbCBvciBFcnJvcignbWVzc2FnZScpXG4qICBjb250ZW50OiB0aGUgb2JqZWN0IHRvIHJldHJpZXZlIG9yIHRoZSBlcnJvciBtZXNzYWdlIGlmIGEgZmFpbHVyZSBvY2N1cmVkXG4qL1xuSW5kZXhDb3JlLnByb3RvdHlwZS5nZXRPYmplY3QgPSBmdW5jdGlvbihvYmplY3RJRCwgYXR0cnMsIGNhbGxiYWNrKSB7XG4gIHZhciBpbmRleE9iaiA9IHRoaXM7XG5cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgfHwgdHlwZW9mIGF0dHJzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY2FsbGJhY2sgPSBhdHRycztcbiAgICBhdHRycyA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIHZhciBwYXJhbXMgPSAnJztcbiAgaWYgKGF0dHJzICE9PSB1bmRlZmluZWQpIHtcbiAgICBwYXJhbXMgPSAnP2F0dHJpYnV0ZXM9JztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGF0dHJzLmxlbmd0aDsgKytpKSB7XG4gICAgICBpZiAoaSAhPT0gMCkge1xuICAgICAgICBwYXJhbXMgKz0gJywnO1xuICAgICAgfVxuICAgICAgcGFyYW1zICs9IGF0dHJzW2ldO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzLmFzLl9qc29uUmVxdWVzdCh7XG4gICAgbWV0aG9kOiAnR0VUJyxcbiAgICB1cmw6ICcvMS9pbmRleGVzLycgKyBlbmNvZGVVUklDb21wb25lbnQoaW5kZXhPYmouaW5kZXhOYW1lKSArICcvJyArIGVuY29kZVVSSUNvbXBvbmVudChvYmplY3RJRCkgKyBwYXJhbXMsXG4gICAgaG9zdFR5cGU6ICdyZWFkJyxcbiAgICBjYWxsYmFjazogY2FsbGJhY2tcbiAgfSk7XG59O1xuXG4vKlxuKiBHZXQgc2V2ZXJhbCBvYmplY3RzIGZyb20gdGhpcyBpbmRleFxuKlxuKiBAcGFyYW0gb2JqZWN0SURzIHRoZSBhcnJheSBvZiB1bmlxdWUgaWRlbnRpZmllciBvZiBvYmplY3RzIHRvIHJldHJpZXZlXG4qL1xuSW5kZXhDb3JlLnByb3RvdHlwZS5nZXRPYmplY3RzID0gZnVuY3Rpb24ob2JqZWN0SURzLCBhdHRyaWJ1dGVzVG9SZXRyaWV2ZSwgY2FsbGJhY2spIHtcbiAgdmFyIGlzQXJyYXkgPSByZXF1aXJlKCdpc2FycmF5Jyk7XG4gIHZhciBtYXAgPSByZXF1aXJlKCcuL21hcC5qcycpO1xuXG4gIHZhciB1c2FnZSA9ICdVc2FnZTogaW5kZXguZ2V0T2JqZWN0cyhhcnJheU9mT2JqZWN0SURzWywgY2FsbGJhY2tdKSc7XG5cbiAgaWYgKCFpc0FycmF5KG9iamVjdElEcykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IodXNhZ2UpO1xuICB9XG5cbiAgdmFyIGluZGV4T2JqID0gdGhpcztcblxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSB8fCB0eXBlb2YgYXR0cmlidXRlc1RvUmV0cmlldmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICBjYWxsYmFjayA9IGF0dHJpYnV0ZXNUb1JldHJpZXZlO1xuICAgIGF0dHJpYnV0ZXNUb1JldHJpZXZlID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgdmFyIGJvZHkgPSB7XG4gICAgcmVxdWVzdHM6IG1hcChvYmplY3RJRHMsIGZ1bmN0aW9uIHByZXBhcmVSZXF1ZXN0KG9iamVjdElEKSB7XG4gICAgICB2YXIgcmVxdWVzdCA9IHtcbiAgICAgICAgaW5kZXhOYW1lOiBpbmRleE9iai5pbmRleE5hbWUsXG4gICAgICAgIG9iamVjdElEOiBvYmplY3RJRFxuICAgICAgfTtcblxuICAgICAgaWYgKGF0dHJpYnV0ZXNUb1JldHJpZXZlKSB7XG4gICAgICAgIHJlcXVlc3QuYXR0cmlidXRlc1RvUmV0cmlldmUgPSBhdHRyaWJ1dGVzVG9SZXRyaWV2ZS5qb2luKCcsJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXF1ZXN0O1xuICAgIH0pXG4gIH07XG5cbiAgcmV0dXJuIHRoaXMuYXMuX2pzb25SZXF1ZXN0KHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICB1cmw6ICcvMS9pbmRleGVzLyovb2JqZWN0cycsXG4gICAgaG9zdFR5cGU6ICdyZWFkJyxcbiAgICBib2R5OiBib2R5LFxuICAgIGNhbGxiYWNrOiBjYWxsYmFja1xuICB9KTtcbn07XG5cbkluZGV4Q29yZS5wcm90b3R5cGUuYXMgPSBudWxsO1xuSW5kZXhDb3JlLnByb3RvdHlwZS5pbmRleE5hbWUgPSBudWxsO1xuSW5kZXhDb3JlLnByb3RvdHlwZS50eXBlQWhlYWRBcmdzID0gbnVsbDtcbkluZGV4Q29yZS5wcm90b3R5cGUudHlwZUFoZWFkVmFsdWVPcHRpb24gPSBudWxsO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL0luZGV4Q29yZS5qc1xuLy8gbW9kdWxlIGlkID0gNDRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgQWxnb2xpYVNlYXJjaENvcmUgPSByZXF1aXJlKCcuLi8uLi9BbGdvbGlhU2VhcmNoQ29yZS5qcycpO1xudmFyIGNyZWF0ZUFsZ29saWFzZWFyY2ggPSByZXF1aXJlKCcuLi9jcmVhdGVBbGdvbGlhc2VhcmNoLmpzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlQWxnb2xpYXNlYXJjaChBbGdvbGlhU2VhcmNoQ29yZSwgJyhsaXRlKSAnKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9icm93c2VyL2J1aWxkcy9hbGdvbGlhc2VhcmNoTGl0ZS5qc1xuLy8gbW9kdWxlIGlkID0gNDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnZ2xvYmFsJyk7XG52YXIgUHJvbWlzZSA9IGdsb2JhbC5Qcm9taXNlIHx8IHJlcXVpcmUoJ2VzNi1wcm9taXNlJykuUHJvbWlzZTtcblxuLy8gVGhpcyBpcyB0aGUgc3RhbmRhbG9uZSBicm93c2VyIGJ1aWxkIGVudHJ5IHBvaW50XG4vLyBCcm93c2VyIGltcGxlbWVudGF0aW9uIG9mIHRoZSBBbGdvbGlhIFNlYXJjaCBKYXZhU2NyaXB0IGNsaWVudCxcbi8vIHVzaW5nIFhNTEh0dHBSZXF1ZXN0LCBYRG9tYWluUmVxdWVzdCBhbmQgSlNPTlAgYXMgZmFsbGJhY2tcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY3JlYXRlQWxnb2xpYXNlYXJjaChBbGdvbGlhU2VhcmNoLCB1YVN1ZmZpeCkge1xuICB2YXIgaW5oZXJpdHMgPSByZXF1aXJlKCdpbmhlcml0cycpO1xuICB2YXIgZXJyb3JzID0gcmVxdWlyZSgnLi4vZXJyb3JzJyk7XG4gIHZhciBpbmxpbmVIZWFkZXJzID0gcmVxdWlyZSgnLi9pbmxpbmUtaGVhZGVycycpO1xuICB2YXIganNvbnBSZXF1ZXN0ID0gcmVxdWlyZSgnLi9qc29ucC1yZXF1ZXN0Jyk7XG4gIHZhciBwbGFjZXMgPSByZXF1aXJlKCcuLi9wbGFjZXMuanMnKTtcbiAgdWFTdWZmaXggPSB1YVN1ZmZpeCB8fCAnJztcblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZWJ1ZycpIHtcbiAgICByZXF1aXJlKCdkZWJ1ZycpLmVuYWJsZSgnYWxnb2xpYXNlYXJjaConKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFsZ29saWFzZWFyY2goYXBwbGljYXRpb25JRCwgYXBpS2V5LCBvcHRzKSB7XG4gICAgdmFyIGNsb25lRGVlcCA9IHJlcXVpcmUoJy4uL2Nsb25lLmpzJyk7XG5cbiAgICBvcHRzID0gY2xvbmVEZWVwKG9wdHMgfHwge30pO1xuXG4gICAgb3B0cy5fdWEgPSBvcHRzLl91YSB8fCBhbGdvbGlhc2VhcmNoLnVhO1xuXG4gICAgcmV0dXJuIG5ldyBBbGdvbGlhU2VhcmNoQnJvd3NlcihhcHBsaWNhdGlvbklELCBhcGlLZXksIG9wdHMpO1xuICB9XG5cbiAgYWxnb2xpYXNlYXJjaC52ZXJzaW9uID0gcmVxdWlyZSgnLi4vdmVyc2lvbi5qcycpO1xuICBhbGdvbGlhc2VhcmNoLnVhID0gJ0FsZ29saWEgZm9yIHZhbmlsbGEgSmF2YVNjcmlwdCAnICsgdWFTdWZmaXggKyBhbGdvbGlhc2VhcmNoLnZlcnNpb247XG4gIGFsZ29saWFzZWFyY2guaW5pdFBsYWNlcyA9IHBsYWNlcyhhbGdvbGlhc2VhcmNoKTtcblxuICAvLyB3ZSBleHBvc2UgaW50byB3aW5kb3cgbm8gbWF0dGVyIGhvdyB3ZSBhcmUgdXNlZCwgdGhpcyB3aWxsIGFsbG93XG4gIC8vIHVzIHRvIGVhc2lseSBkZWJ1ZyBhbnkgd2Vic2l0ZSBydW5uaW5nIGFsZ29saWFcbiAgZ2xvYmFsLl9fYWxnb2xpYSA9IHtcbiAgICBkZWJ1ZzogcmVxdWlyZSgnZGVidWcnKSxcbiAgICBhbGdvbGlhc2VhcmNoOiBhbGdvbGlhc2VhcmNoXG4gIH07XG5cbiAgdmFyIHN1cHBvcnQgPSB7XG4gICAgaGFzWE1MSHR0cFJlcXVlc3Q6ICdYTUxIdHRwUmVxdWVzdCcgaW4gZ2xvYmFsLFxuICAgIGhhc1hEb21haW5SZXF1ZXN0OiAnWERvbWFpblJlcXVlc3QnIGluIGdsb2JhbFxuICB9O1xuXG4gIGlmIChzdXBwb3J0Lmhhc1hNTEh0dHBSZXF1ZXN0KSB7XG4gICAgc3VwcG9ydC5jb3JzID0gJ3dpdGhDcmVkZW50aWFscycgaW4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gIH1cblxuICBmdW5jdGlvbiBBbGdvbGlhU2VhcmNoQnJvd3NlcigpIHtcbiAgICAvLyBjYWxsIEFsZ29saWFTZWFyY2ggY29uc3RydWN0b3JcbiAgICBBbGdvbGlhU2VhcmNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBpbmhlcml0cyhBbGdvbGlhU2VhcmNoQnJvd3NlciwgQWxnb2xpYVNlYXJjaCk7XG5cbiAgQWxnb2xpYVNlYXJjaEJyb3dzZXIucHJvdG90eXBlLl9yZXF1ZXN0ID0gZnVuY3Rpb24gcmVxdWVzdCh1cmwsIG9wdHMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gd3JhcFJlcXVlc3QocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAvLyBubyBjb3JzIG9yIFhEb21haW5SZXF1ZXN0LCBubyByZXF1ZXN0XG4gICAgICBpZiAoIXN1cHBvcnQuY29ycyAmJiAhc3VwcG9ydC5oYXNYRG9tYWluUmVxdWVzdCkge1xuICAgICAgICAvLyB2ZXJ5IG9sZCBicm93c2VyLCBub3Qgc3VwcG9ydGVkXG4gICAgICAgIHJlamVjdChuZXcgZXJyb3JzLk5ldHdvcmsoJ0NPUlMgbm90IHN1cHBvcnRlZCcpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB1cmwgPSBpbmxpbmVIZWFkZXJzKHVybCwgb3B0cy5oZWFkZXJzKTtcblxuICAgICAgdmFyIGJvZHkgPSBvcHRzLmJvZHk7XG4gICAgICB2YXIgcmVxID0gc3VwcG9ydC5jb3JzID8gbmV3IFhNTEh0dHBSZXF1ZXN0KCkgOiBuZXcgWERvbWFpblJlcXVlc3QoKTtcbiAgICAgIHZhciByZXFUaW1lb3V0O1xuICAgICAgdmFyIHRpbWVkT3V0O1xuICAgICAgdmFyIGNvbm5lY3RlZCA9IGZhbHNlO1xuXG4gICAgICByZXFUaW1lb3V0ID0gc2V0VGltZW91dChvblRpbWVvdXQsIG9wdHMudGltZW91dHMuY29ubmVjdCk7XG4gICAgICAvLyB3ZSBzZXQgYW4gZW1wdHkgb25wcm9ncmVzcyBsaXN0ZW5lclxuICAgICAgLy8gc28gdGhhdCBYRG9tYWluUmVxdWVzdCBvbiBJRTkgaXMgbm90IGFib3J0ZWRcbiAgICAgIC8vIHJlZnM6XG4gICAgICAvLyAgLSBodHRwczovL2dpdGh1Yi5jb20vYWxnb2xpYS9hbGdvbGlhc2VhcmNoLWNsaWVudC1qcy9pc3N1ZXMvNzZcbiAgICAgIC8vICAtIGh0dHBzOi8vc29jaWFsLm1zZG4ubWljcm9zb2Z0LmNvbS9Gb3J1bXMvaWUvZW4tVVMvMzBlZjNhZGQtNzY3Yy00NDM2LWI4YTktZjFjYTE5YjQ4MTJlL2llOS1ydG0teGRvbWFpbnJlcXVlc3QtaXNzdWVkLXJlcXVlc3RzLW1heS1hYm9ydC1pZi1hbGwtZXZlbnQtaGFuZGxlcnMtbm90LXNwZWNpZmllZD9mb3J1bT1pZXdlYmRldmVsb3BtZW50XG4gICAgICByZXEub25wcm9ncmVzcyA9IG9uUHJvZ3Jlc3M7XG4gICAgICBpZiAoJ29ucmVhZHlzdGF0ZWNoYW5nZScgaW4gcmVxKSByZXEub25yZWFkeXN0YXRlY2hhbmdlID0gb25SZWFkeVN0YXRlQ2hhbmdlO1xuICAgICAgcmVxLm9ubG9hZCA9IG9uTG9hZDtcbiAgICAgIHJlcS5vbmVycm9yID0gb25FcnJvcjtcblxuICAgICAgLy8gZG8gbm90IHJlbHkgb24gZGVmYXVsdCBYSFIgYXN5bmMgZmxhZywgYXMgc29tZSBhbmFseXRpY3MgY29kZSBsaWtlIGhvdGphclxuICAgICAgLy8gYnJlYWtzIGl0IGFuZCBzZXQgaXQgdG8gZmFsc2UgYnkgZGVmYXVsdFxuICAgICAgaWYgKHJlcSBpbnN0YW5jZW9mIFhNTEh0dHBSZXF1ZXN0KSB7XG4gICAgICAgIHJlcS5vcGVuKG9wdHMubWV0aG9kLCB1cmwsIHRydWUpO1xuXG4gICAgICAgIC8vIFRoZSBBbmFseXRpY3MgQVBJIG5ldmVyIGFjY2VwdHMgQXV0aCBoZWFkZXJzIGFzIHF1ZXJ5IHN0cmluZ1xuICAgICAgICAvLyB0aGlzIG9wdGlvbiBleGlzdHMgc3BlY2lmaWNhbGx5IGZvciB0aGVtLlxuICAgICAgICBpZiAob3B0cy5mb3JjZUF1dGhIZWFkZXJzKSB7XG4gICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoXG4gICAgICAgICAgICAneC1hbGdvbGlhLWFwcGxpY2F0aW9uLWlkJyxcbiAgICAgICAgICAgIG9wdHMuaGVhZGVyc1sneC1hbGdvbGlhLWFwcGxpY2F0aW9uLWlkJ11cbiAgICAgICAgICApO1xuICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKFxuICAgICAgICAgICAgJ3gtYWxnb2xpYS1hcGkta2V5JyxcbiAgICAgICAgICAgIG9wdHMuaGVhZGVyc1sneC1hbGdvbGlhLWFwaS1rZXknXVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcS5vcGVuKG9wdHMubWV0aG9kLCB1cmwpO1xuICAgICAgfVxuXG4gICAgICAvLyBoZWFkZXJzIGFyZSBtZWFudCB0byBiZSBzZW50IGFmdGVyIG9wZW5cbiAgICAgIGlmIChzdXBwb3J0LmNvcnMpIHtcbiAgICAgICAgaWYgKGJvZHkpIHtcbiAgICAgICAgICBpZiAob3B0cy5tZXRob2QgPT09ICdQT1NUJykge1xuICAgICAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRUUC9BY2Nlc3NfY29udHJvbF9DT1JTI1NpbXBsZV9yZXF1ZXN0c1xuICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdhY2NlcHQnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoYm9keSkge1xuICAgICAgICByZXEuc2VuZChib2R5KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcS5zZW5kKCk7XG4gICAgICB9XG5cbiAgICAgIC8vIGV2ZW50IG9iamVjdCBub3QgcmVjZWl2ZWQgaW4gSUU4LCBhdCBsZWFzdFxuICAgICAgLy8gYnV0IHdlIGRvIG5vdCB1c2UgaXQsIHN0aWxsIGltcG9ydGFudCB0byBub3RlXG4gICAgICBmdW5jdGlvbiBvbkxvYWQoLyogZXZlbnQgKi8pIHtcbiAgICAgICAgLy8gV2hlbiBicm93c2VyIGRvZXMgbm90IHN1cHBvcnRzIHJlcS50aW1lb3V0LCB3ZSBjYW5cbiAgICAgICAgLy8gaGF2ZSBib3RoIGEgbG9hZCBhbmQgdGltZW91dCBldmVudCwgc2luY2UgaGFuZGxlZCBieSBhIGR1bWIgc2V0VGltZW91dFxuICAgICAgICBpZiAodGltZWRPdXQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjbGVhclRpbWVvdXQocmVxVGltZW91dCk7XG5cbiAgICAgICAgdmFyIG91dDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIG91dCA9IHtcbiAgICAgICAgICAgIGJvZHk6IEpTT04ucGFyc2UocmVxLnJlc3BvbnNlVGV4dCksXG4gICAgICAgICAgICByZXNwb25zZVRleHQ6IHJlcS5yZXNwb25zZVRleHQsXG4gICAgICAgICAgICBzdGF0dXNDb2RlOiByZXEuc3RhdHVzLFxuICAgICAgICAgICAgLy8gWERvbWFpblJlcXVlc3QgZG9lcyBub3QgaGF2ZSBhbnkgcmVzcG9uc2UgaGVhZGVyc1xuICAgICAgICAgICAgaGVhZGVyczogcmVxLmdldEFsbFJlc3BvbnNlSGVhZGVycyAmJiByZXEuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwge31cbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgb3V0ID0gbmV3IGVycm9ycy5VbnBhcnNhYmxlSlNPTih7XG4gICAgICAgICAgICBtb3JlOiByZXEucmVzcG9uc2VUZXh0XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3V0IGluc3RhbmNlb2YgZXJyb3JzLlVucGFyc2FibGVKU09OKSB7XG4gICAgICAgICAgcmVqZWN0KG91dCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZShvdXQpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uRXJyb3IoZXZlbnQpIHtcbiAgICAgICAgaWYgKHRpbWVkT3V0KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHJlcVRpbWVvdXQpO1xuXG4gICAgICAgIC8vIGVycm9yIGV2ZW50IGlzIHRyaWdlcnJlZCBib3RoIHdpdGggWERSL1hIUiBvbjpcbiAgICAgICAgLy8gICAtIEROUyBlcnJvclxuICAgICAgICAvLyAgIC0gdW5hbGxvd2VkIGNyb3NzIGRvbWFpbiByZXF1ZXN0XG4gICAgICAgIHJlamVjdChcbiAgICAgICAgICBuZXcgZXJyb3JzLk5ldHdvcmsoe1xuICAgICAgICAgICAgbW9yZTogZXZlbnRcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvblRpbWVvdXQoKSB7XG4gICAgICAgIHRpbWVkT3V0ID0gdHJ1ZTtcbiAgICAgICAgcmVxLmFib3J0KCk7XG5cbiAgICAgICAgcmVqZWN0KG5ldyBlcnJvcnMuUmVxdWVzdFRpbWVvdXQoKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uQ29ubmVjdCgpIHtcbiAgICAgICAgY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHJlcVRpbWVvdXQpO1xuICAgICAgICByZXFUaW1lb3V0ID0gc2V0VGltZW91dChvblRpbWVvdXQsIG9wdHMudGltZW91dHMuY29tcGxldGUpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvblByb2dyZXNzKCkge1xuICAgICAgICBpZiAoIWNvbm5lY3RlZCkgb25Db25uZWN0KCk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uUmVhZHlTdGF0ZUNoYW5nZSgpIHtcbiAgICAgICAgaWYgKCFjb25uZWN0ZWQgJiYgcmVxLnJlYWR5U3RhdGUgPiAxKSBvbkNvbm5lY3QoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBBbGdvbGlhU2VhcmNoQnJvd3Nlci5wcm90b3R5cGUuX3JlcXVlc3QuZmFsbGJhY2sgPSBmdW5jdGlvbiByZXF1ZXN0RmFsbGJhY2sodXJsLCBvcHRzKSB7XG4gICAgdXJsID0gaW5saW5lSGVhZGVycyh1cmwsIG9wdHMuaGVhZGVycyk7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gd3JhcEpzb25wUmVxdWVzdChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGpzb25wUmVxdWVzdCh1cmwsIG9wdHMsIGZ1bmN0aW9uIGpzb25wUmVxdWVzdERvbmUoZXJyLCBjb250ZW50KSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZXNvbHZlKGNvbnRlbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgQWxnb2xpYVNlYXJjaEJyb3dzZXIucHJvdG90eXBlLl9wcm9taXNlID0ge1xuICAgIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0UHJvbWlzZSh2YWwpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCh2YWwpO1xuICAgIH0sXG4gICAgcmVzb2x2ZTogZnVuY3Rpb24gcmVzb2x2ZVByb21pc2UodmFsKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbCk7XG4gICAgfSxcbiAgICBkZWxheTogZnVuY3Rpb24gZGVsYXlQcm9taXNlKG1zKSB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gcmVzb2x2ZU9uVGltZW91dChyZXNvbHZlLyogLCByZWplY3QqLykge1xuICAgICAgICBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYWxsOiBmdW5jdGlvbiBhbGwocHJvbWlzZXMpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBhbGdvbGlhc2VhcmNoO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9icm93c2VyL2NyZWF0ZUFsZ29saWFzZWFyY2guanNcbi8vIG1vZHVsZSBpZCA9IDQ2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBpbmxpbmVIZWFkZXJzO1xuXG52YXIgZW5jb2RlID0gcmVxdWlyZSgncXVlcnlzdHJpbmctZXMzL2VuY29kZScpO1xuXG5mdW5jdGlvbiBpbmxpbmVIZWFkZXJzKHVybCwgaGVhZGVycykge1xuICBpZiAoL1xcPy8udGVzdCh1cmwpKSB7XG4gICAgdXJsICs9ICcmJztcbiAgfSBlbHNlIHtcbiAgICB1cmwgKz0gJz8nO1xuICB9XG5cbiAgcmV0dXJuIHVybCArIGVuY29kZShoZWFkZXJzKTtcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9icm93c2VyL2lubGluZS1oZWFkZXJzLmpzXG4vLyBtb2R1bGUgaWQgPSA0N1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0ganNvbnBSZXF1ZXN0O1xuXG52YXIgZXJyb3JzID0gcmVxdWlyZSgnLi4vZXJyb3JzJyk7XG5cbnZhciBKU09OUENvdW50ZXIgPSAwO1xuXG5mdW5jdGlvbiBqc29ucFJlcXVlc3QodXJsLCBvcHRzLCBjYikge1xuICBpZiAob3B0cy5tZXRob2QgIT09ICdHRVQnKSB7XG4gICAgY2IobmV3IEVycm9yKCdNZXRob2QgJyArIG9wdHMubWV0aG9kICsgJyAnICsgdXJsICsgJyBpcyBub3Qgc3VwcG9ydGVkIGJ5IEpTT05QLicpKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBvcHRzLmRlYnVnKCdKU09OUDogc3RhcnQnKTtcblxuICB2YXIgY2JDYWxsZWQgPSBmYWxzZTtcbiAgdmFyIHRpbWVkT3V0ID0gZmFsc2U7XG5cbiAgSlNPTlBDb3VudGVyICs9IDE7XG4gIHZhciBoZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXTtcbiAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICB2YXIgY2JOYW1lID0gJ2FsZ29saWFKU09OUF8nICsgSlNPTlBDb3VudGVyO1xuICB2YXIgZG9uZSA9IGZhbHNlO1xuXG4gIHdpbmRvd1tjYk5hbWVdID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHJlbW92ZUdsb2JhbHMoKTtcblxuICAgIGlmICh0aW1lZE91dCkge1xuICAgICAgb3B0cy5kZWJ1ZygnSlNPTlA6IExhdGUgYW5zd2VyLCBpZ25vcmluZycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNiQ2FsbGVkID0gdHJ1ZTtcblxuICAgIGNsZWFuKCk7XG5cbiAgICBjYihudWxsLCB7XG4gICAgICBib2R5OiBkYXRhLFxuICAgICAgcmVzcG9uc2VUZXh0OiBKU09OLnN0cmluZ2lmeShkYXRhKS8qICxcbiAgICAgIC8vIFdlIGRvIG5vdCBzZW5kIHRoZSBzdGF0dXNDb2RlLCB0aGVyZSdzIG5vIHN0YXR1c0NvZGUgaW4gSlNPTlAsIGl0IHdpbGwgYmVcbiAgICAgIC8vIGNvbXB1dGVkIHVzaW5nIGRhdGEuc3RhdHVzICYmIGRhdGEubWVzc2FnZSBsaWtlIHdpdGggWERSXG4gICAgICBzdGF0dXNDb2RlKi9cbiAgICB9KTtcbiAgfTtcblxuICAvLyBhZGQgY2FsbGJhY2sgYnkgaGFuZFxuICB1cmwgKz0gJyZjYWxsYmFjaz0nICsgY2JOYW1lO1xuXG4gIC8vIGFkZCBib2R5IHBhcmFtcyBtYW51YWxseVxuICBpZiAob3B0cy5qc29uQm9keSAmJiBvcHRzLmpzb25Cb2R5LnBhcmFtcykge1xuICAgIHVybCArPSAnJicgKyBvcHRzLmpzb25Cb2R5LnBhcmFtcztcbiAgfVxuXG4gIHZhciBvbnRpbWVvdXQgPSBzZXRUaW1lb3V0KHRpbWVvdXQsIG9wdHMudGltZW91dHMuY29tcGxldGUpO1xuXG4gIC8vIHNjcmlwdCBvbnJlYWR5c3RhdGVjaGFuZ2UgbmVlZGVkIG9ubHkgZm9yXG4gIC8vIDw9IElFOFxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyLmpzL2lzc3Vlcy80NTIzXG4gIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSByZWFkeXN0YXRlY2hhbmdlO1xuICBzY3JpcHQub25sb2FkID0gc3VjY2VzcztcbiAgc2NyaXB0Lm9uZXJyb3IgPSBlcnJvcjtcblxuICBzY3JpcHQuYXN5bmMgPSB0cnVlO1xuICBzY3JpcHQuZGVmZXIgPSB0cnVlO1xuICBzY3JpcHQuc3JjID0gdXJsO1xuICBoZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XG5cbiAgZnVuY3Rpb24gc3VjY2VzcygpIHtcbiAgICBvcHRzLmRlYnVnKCdKU09OUDogc3VjY2VzcycpO1xuXG4gICAgaWYgKGRvbmUgfHwgdGltZWRPdXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkb25lID0gdHJ1ZTtcblxuICAgIC8vIHNjcmlwdCBsb2FkZWQgYnV0IGRpZCBub3QgY2FsbCB0aGUgZm4gPT4gc2NyaXB0IGxvYWRpbmcgZXJyb3JcbiAgICBpZiAoIWNiQ2FsbGVkKSB7XG4gICAgICBvcHRzLmRlYnVnKCdKU09OUDogRmFpbC4gU2NyaXB0IGxvYWRlZCBidXQgZGlkIG5vdCBjYWxsIHRoZSBjYWxsYmFjaycpO1xuICAgICAgY2xlYW4oKTtcbiAgICAgIGNiKG5ldyBlcnJvcnMuSlNPTlBTY3JpcHRGYWlsKCkpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWR5c3RhdGVjaGFuZ2UoKSB7XG4gICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gJ2xvYWRlZCcgfHwgdGhpcy5yZWFkeVN0YXRlID09PSAnY29tcGxldGUnKSB7XG4gICAgICBzdWNjZXNzKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY2xlYW4oKSB7XG4gICAgY2xlYXJUaW1lb3V0KG9udGltZW91dCk7XG4gICAgc2NyaXB0Lm9ubG9hZCA9IG51bGw7XG4gICAgc2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgc2NyaXB0Lm9uZXJyb3IgPSBudWxsO1xuICAgIGhlYWQucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZUdsb2JhbHMoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGRlbGV0ZSB3aW5kb3dbY2JOYW1lXTtcbiAgICAgIGRlbGV0ZSB3aW5kb3dbY2JOYW1lICsgJ19sb2FkZWQnXTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB3aW5kb3dbY2JOYW1lXSA9IHdpbmRvd1tjYk5hbWUgKyAnX2xvYWRlZCddID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHRpbWVvdXQoKSB7XG4gICAgb3B0cy5kZWJ1ZygnSlNPTlA6IFNjcmlwdCB0aW1lb3V0Jyk7XG4gICAgdGltZWRPdXQgPSB0cnVlO1xuICAgIGNsZWFuKCk7XG4gICAgY2IobmV3IGVycm9ycy5SZXF1ZXN0VGltZW91dCgpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGVycm9yKCkge1xuICAgIG9wdHMuZGVidWcoJ0pTT05QOiBTY3JpcHQgZXJyb3InKTtcblxuICAgIGlmIChkb25lIHx8IHRpbWVkT3V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY2xlYW4oKTtcbiAgICBjYihuZXcgZXJyb3JzLkpTT05QU2NyaXB0RXJyb3IoKSk7XG4gIH1cbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9icm93c2VyL2pzb25wLXJlcXVlc3QuanNcbi8vIG1vZHVsZSBpZCA9IDQ4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVwcmVjYXRlKGZuLCBtZXNzYWdlKSB7XG4gIHZhciB3YXJuZWQgPSBmYWxzZTtcblxuICBmdW5jdGlvbiBkZXByZWNhdGVkKCkge1xuICAgIGlmICghd2FybmVkKSB7XG4gICAgICAvKiBlc2xpbnQgbm8tY29uc29sZTowICovXG4gICAgICBjb25zb2xlLndhcm4obWVzc2FnZSk7XG4gICAgICB3YXJuZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgcmV0dXJuIGRlcHJlY2F0ZWQ7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2RlcHJlY2F0ZS5qc1xuLy8gbW9kdWxlIGlkID0gNDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZXByZWNhdGVkTWVzc2FnZShwcmV2aW91c1VzYWdlLCBuZXdVc2FnZSkge1xuICB2YXIgZ2l0aHViQW5jaG9yTGluayA9IHByZXZpb3VzVXNhZ2UudG9Mb3dlckNhc2UoKVxuICAgIC5yZXBsYWNlKC9bXFwuXFwoXFwpXS9nLCAnJyk7XG5cbiAgcmV0dXJuICdhbGdvbGlhc2VhcmNoOiBgJyArIHByZXZpb3VzVXNhZ2UgKyAnYCB3YXMgcmVwbGFjZWQgYnkgYCcgKyBuZXdVc2FnZSArXG4gICAgJ2AuIFBsZWFzZSBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2FsZ29saWEvYWxnb2xpYXNlYXJjaC1jbGllbnQtamF2YXNjcmlwdC93aWtpL0RlcHJlY2F0ZWQjJyArIGdpdGh1YkFuY2hvckxpbms7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2RlcHJlY2F0ZWRNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA1MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBQYXJzZSBjbG91ZCBkb2VzIG5vdCBzdXBwb3J0cyBzZXRUaW1lb3V0XG4vLyBXZSBkbyBub3Qgc3RvcmUgYSBzZXRUaW1lb3V0IHJlZmVyZW5jZSBpbiB0aGUgY2xpZW50IGV2ZXJ5dGltZVxuLy8gV2Ugb25seSBmYWxsYmFjayB0byBhIGZha2Ugc2V0VGltZW91dCB3aGVuIG5vdCBhdmFpbGFibGVcbi8vIHNldFRpbWVvdXQgY2Fubm90IGJlIG92ZXJyaWRlIGdsb2JhbGx5IHNhZGx5XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGV4aXRQcm9taXNlKGZuLCBfc2V0VGltZW91dCkge1xuICBfc2V0VGltZW91dChmbiwgMCk7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2V4aXRQcm9taXNlLmpzXG4vLyBtb2R1bGUgaWQgPSA1MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgZm9yZWFjaCA9IHJlcXVpcmUoJ2ZvcmVhY2gnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBtZXJnZShkZXN0aW5hdGlvbi8qICwgc291cmNlcyAqLykge1xuICB2YXIgc291cmNlcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cbiAgZm9yZWFjaChzb3VyY2VzLCBmdW5jdGlvbihzb3VyY2UpIHtcbiAgICBmb3IgKHZhciBrZXlOYW1lIGluIHNvdXJjZSkge1xuICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShrZXlOYW1lKSkge1xuICAgICAgICBpZiAodHlwZW9mIGRlc3RpbmF0aW9uW2tleU5hbWVdID09PSAnb2JqZWN0JyAmJiB0eXBlb2Ygc291cmNlW2tleU5hbWVdID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIGRlc3RpbmF0aW9uW2tleU5hbWVdID0gbWVyZ2Uoe30sIGRlc3RpbmF0aW9uW2tleU5hbWVdLCBzb3VyY2Vba2V5TmFtZV0pO1xuICAgICAgICB9IGVsc2UgaWYgKHNvdXJjZVtrZXlOYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgZGVzdGluYXRpb25ba2V5TmFtZV0gPSBzb3VyY2Vba2V5TmFtZV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBkZXN0aW5hdGlvbjtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvbWVyZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDUyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gY3JlYXRlUGxhY2VzQ2xpZW50O1xuXG52YXIgYnVpbGRTZWFyY2hNZXRob2QgPSByZXF1aXJlKCcuL2J1aWxkU2VhcmNoTWV0aG9kLmpzJyk7XG5cbmZ1bmN0aW9uIGNyZWF0ZVBsYWNlc0NsaWVudChhbGdvbGlhc2VhcmNoKSB7XG4gIHJldHVybiBmdW5jdGlvbiBwbGFjZXMoYXBwSUQsIGFwaUtleSwgb3B0cykge1xuICAgIHZhciBjbG9uZURlZXAgPSByZXF1aXJlKCcuL2Nsb25lLmpzJyk7XG5cbiAgICBvcHRzID0gb3B0cyAmJiBjbG9uZURlZXAob3B0cykgfHwge307XG4gICAgb3B0cy5ob3N0cyA9IG9wdHMuaG9zdHMgfHwgW1xuICAgICAgJ3BsYWNlcy1kc24uYWxnb2xpYS5uZXQnLFxuICAgICAgJ3BsYWNlcy0xLmFsZ29saWFuZXQuY29tJyxcbiAgICAgICdwbGFjZXMtMi5hbGdvbGlhbmV0LmNvbScsXG4gICAgICAncGxhY2VzLTMuYWxnb2xpYW5ldC5jb20nXG4gICAgXTtcblxuICAgIC8vIGFsbG93IGluaXRQbGFjZXMoKSBubyBhcmd1bWVudHMgPT4gY29tbXVuaXR5IHJhdGUgbGltaXRlZFxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwIHx8IHR5cGVvZiBhcHBJRCA9PT0gJ29iamVjdCcgfHwgYXBwSUQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgYXBwSUQgPSAnJztcbiAgICAgIGFwaUtleSA9ICcnO1xuICAgICAgb3B0cy5fYWxsb3dFbXB0eUNyZWRlbnRpYWxzID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgY2xpZW50ID0gYWxnb2xpYXNlYXJjaChhcHBJRCwgYXBpS2V5LCBvcHRzKTtcbiAgICB2YXIgaW5kZXggPSBjbGllbnQuaW5pdEluZGV4KCdwbGFjZXMnKTtcbiAgICBpbmRleC5zZWFyY2ggPSBidWlsZFNlYXJjaE1ldGhvZCgncXVlcnknLCAnLzEvcGxhY2VzL3F1ZXJ5Jyk7XG4gICAgaW5kZXguZ2V0T2JqZWN0ID0gZnVuY3Rpb24ob2JqZWN0SUQsIGNhbGxiYWNrKSB7XG4gICAgICByZXR1cm4gdGhpcy5hcy5fanNvblJlcXVlc3Qoe1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICB1cmw6ICcvMS9wbGFjZXMvJyArIGVuY29kZVVSSUNvbXBvbmVudChvYmplY3RJRCksXG4gICAgICAgIGhvc3RUeXBlOiAncmVhZCcsXG4gICAgICAgIGNhbGxiYWNrOiBjYWxsYmFja1xuICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gaW5kZXg7XG4gIH07XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvcGxhY2VzLmpzXG4vLyBtb2R1bGUgaWQgPSA1M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgZGVidWcgPSByZXF1aXJlKCdkZWJ1ZycpKCdhbGdvbGlhc2VhcmNoOnNyYy9ob3N0SW5kZXhTdGF0ZS5qcycpO1xudmFyIGxvY2FsU3RvcmFnZU5hbWVzcGFjZSA9ICdhbGdvbGlhc2VhcmNoLWNsaWVudC1qcyc7XG5cbnZhciBzdG9yZTtcbnZhciBtb2R1bGVTdG9yZSA9IHtcbiAgc3RhdGU6IHt9LFxuICBzZXQ6IGZ1bmN0aW9uKGtleSwgZGF0YSkge1xuICAgIHRoaXMuc3RhdGVba2V5XSA9IGRhdGE7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGVba2V5XTtcbiAgfSxcbiAgZ2V0OiBmdW5jdGlvbihrZXkpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZVtrZXldIHx8IG51bGw7XG4gIH1cbn07XG5cbnZhciBsb2NhbFN0b3JhZ2VTdG9yZSA9IHtcbiAgc2V0OiBmdW5jdGlvbihrZXksIGRhdGEpIHtcbiAgICBtb2R1bGVTdG9yZS5zZXQoa2V5LCBkYXRhKTsgLy8gYWx3YXlzIHJlcGxpY2F0ZSBsb2NhbFN0b3JhZ2VTdG9yZSB0byBtb2R1bGVTdG9yZSBpbiBjYXNlIG9mIGZhaWx1cmVcblxuICAgIHRyeSB7XG4gICAgICB2YXIgbmFtZXNwYWNlID0gSlNPTi5wYXJzZShnbG9iYWwubG9jYWxTdG9yYWdlW2xvY2FsU3RvcmFnZU5hbWVzcGFjZV0pO1xuICAgICAgbmFtZXNwYWNlW2tleV0gPSBkYXRhO1xuICAgICAgZ2xvYmFsLmxvY2FsU3RvcmFnZVtsb2NhbFN0b3JhZ2VOYW1lc3BhY2VdID0gSlNPTi5zdHJpbmdpZnkobmFtZXNwYWNlKTtcbiAgICAgIHJldHVybiBuYW1lc3BhY2Vba2V5XTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4gbG9jYWxTdG9yYWdlRmFpbHVyZShrZXksIGUpO1xuICAgIH1cbiAgfSxcbiAgZ2V0OiBmdW5jdGlvbihrZXkpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZ2xvYmFsLmxvY2FsU3RvcmFnZVtsb2NhbFN0b3JhZ2VOYW1lc3BhY2VdKVtrZXldIHx8IG51bGw7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZUZhaWx1cmUoa2V5LCBlKTtcbiAgICB9XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGxvY2FsU3RvcmFnZUZhaWx1cmUoa2V5LCBlKSB7XG4gIGRlYnVnKCdsb2NhbFN0b3JhZ2UgZmFpbGVkIHdpdGgnLCBlKTtcbiAgY2xlYW51cCgpO1xuICBzdG9yZSA9IG1vZHVsZVN0b3JlO1xuICByZXR1cm4gc3RvcmUuZ2V0KGtleSk7XG59XG5cbnN0b3JlID0gc3VwcG9ydHNMb2NhbFN0b3JhZ2UoKSA/IGxvY2FsU3RvcmFnZVN0b3JlIDogbW9kdWxlU3RvcmU7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBnZXQ6IGdldE9yU2V0LFxuICBzZXQ6IGdldE9yU2V0LFxuICBzdXBwb3J0c0xvY2FsU3RvcmFnZTogc3VwcG9ydHNMb2NhbFN0b3JhZ2Vcbn07XG5cbmZ1bmN0aW9uIGdldE9yU2V0KGtleSwgZGF0YSkge1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgIHJldHVybiBzdG9yZS5nZXQoa2V5KTtcbiAgfVxuXG4gIHJldHVybiBzdG9yZS5zZXQoa2V5LCBkYXRhKTtcbn1cblxuZnVuY3Rpb24gc3VwcG9ydHNMb2NhbFN0b3JhZ2UoKSB7XG4gIHRyeSB7XG4gICAgaWYgKCdsb2NhbFN0b3JhZ2UnIGluIGdsb2JhbCAmJlxuICAgICAgZ2xvYmFsLmxvY2FsU3RvcmFnZSAhPT0gbnVsbCkge1xuICAgICAgaWYgKCFnbG9iYWwubG9jYWxTdG9yYWdlW2xvY2FsU3RvcmFnZU5hbWVzcGFjZV0pIHtcbiAgICAgICAgLy8gYWN0dWFsIGNyZWF0aW9uIG9mIHRoZSBuYW1lc3BhY2VcbiAgICAgICAgZ2xvYmFsLmxvY2FsU3RvcmFnZS5zZXRJdGVtKGxvY2FsU3RvcmFnZU5hbWVzcGFjZSwgSlNPTi5zdHJpbmdpZnkoe30pKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSBjYXRjaCAoXykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBJbiBjYXNlIG9mIGFueSBlcnJvciBvbiBsb2NhbFN0b3JhZ2UsIHdlIGNsZWFuIG91ciBvd24gbmFtZXNwYWNlLCB0aGlzIHNob3VsZCBoYW5kbGVcbi8vIHF1b3RhIGVycm9ycyB3aGVuIGEgbG90IG9mIGtleXMgKyBkYXRhIGFyZSB1c2VkXG5mdW5jdGlvbiBjbGVhbnVwKCkge1xuICB0cnkge1xuICAgIGdsb2JhbC5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShsb2NhbFN0b3JhZ2VOYW1lc3BhY2UpO1xuICB9IGNhdGNoIChfKSB7XG4gICAgLy8gbm90aGluZyB0byBkb1xuICB9XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvc3RvcmUuanNcbi8vIG1vZHVsZSBpZCA9IDU0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSAnMy4yOS4wJztcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy92ZXJzaW9uLmpzXG4vLyBtb2R1bGUgaWQgPSA1NVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmVydGV4U2hhZGVyIDogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdXZzLnh5ID0gdXYueHk7XG4gICAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XG4gICAgfVxuICBgLFxuXG4gIGZyYWdtZW50U2hhZGVyOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB1bmlmb3JtIHNhbXBsZXIyRCBzcmM7XG5cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICBnbF9GcmFnQ29sb3IgPSB0ZXh0dXJlMkQoc3JjLCB1dnMpO1xuICAgIH1cbmB9O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vYXNzZXRzL3NoYWRlcnMvZmxhdC5qcyIsIm1vZHVsZS5leHBvcnRzID0ge1xuICB2ZXJ0ZXhTaGFkZXIgOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdXZzLnh5ID0gdXYueHk7XG4gICAgICB2ZWM0IHAgPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1xuICAgICAgd29ybGRQb3MgPSAobW9kZWxNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICkpLnh5ejtcbiAgICAgIGdsX1Bvc2l0aW9uID0gcDtcbiAgICB9XG4gIGAsXG5cbiAgZnJhZ21lbnRTaGFkZXI6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB1bmlmb3JtIHZlYzMgdHVubmVsTmVvbjtcbiAgICB1bmlmb3JtIHZlYzMgbGVmdExhc2VyO1xuICAgIHVuaWZvcm0gdmVjMyByaWdodExhc2VyO1xuICAgIHVuaWZvcm0gdmVjMyBmbG9vck5lb247XG4gICAgdW5pZm9ybSB2ZWMzIHRleHRHbG93O1xuICAgIHVuaWZvcm0gc2FtcGxlcjJEIHNyYztcblxuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIGZsb2F0IG1hc2s7XG4gICAgICB2ZWM0IGNvbCA9IHRleHR1cmUyRChzcmMsIHV2cyk7XG5cbiAgICAgIC8vIHR1bm5lbCBuZW9uXG4gICAgICBtYXNrID0gc3RlcCgwLjg3LCB1dnMueCkgKiAgc3RlcCgwLjUsIHV2cy55KSAqICgxLjAgLSBzdGVwKDAuOTM1LCB1dnMueCkpICogKCAxLjAgLSBzdGVwKDAuNzUsIHV2cy55KSk7XG4gICAgICBjb2wueHl6ID0gbWl4KGNvbC54eXosIGNvbC54eXogKiB0dW5uZWxOZW9uLCBtYXNrKTtcblxuICAgICAgLy8gZmxvb3IgJiBjb3JyaWRvciBuZW9uc1xuICAgICAgbWFzayA9IHN0ZXAoMC45MzUsIHV2cy54KSAqIHN0ZXAoMC41LCB1dnMueSkgKiAoIDEuMCAtIHN0ZXAoMC43NSwgdXZzLnkpKTtcbiAgICAgIGNvbC54eXogPSBtaXgoY29sLnh5eiwgY29sLnh5eiAqIGZsb29yTmVvbiwgbWFzayk7XG5cbiAgICAgIC8vIGxlZnQgbGFzZXJcbiAgICAgIG1hc2sgPSBzdGVwKDAuNSwgdXZzLngpICogKDEuMCAtIHN0ZXAoMC42MjUsIHV2cy54KSkgKiAoMS4wIC0gc3RlcCgwLjUsIHV2cy55KSk7XG4gICAgICBjb2wueHl6ID0gbWl4KGNvbC54eXosIGNvbC54eXogKiBsZWZ0TGFzZXIsIG1hc2spO1xuXG4gICAgICAvLyByaWdodCBsYXNlclxuICAgICAgbWFzayA9IHN0ZXAoMC42MjUsIHV2cy54KSAqICgxLjAgLSBzdGVwKDAuNzUsIHV2cy54KSkgKiAoMS4wIC0gc3RlcCgwLjUsIHV2cy55KSk7XG4gICAgICBjb2wueHl6ID0gbWl4KGNvbC54eXosIGNvbC54eXogKiByaWdodExhc2VyLCBtYXNrKTtcblxuICAgICAgLy8gdGV4dCBnbG93c1xuICAgICAgbWFzayA9IHN0ZXAoMC44NywgdXZzLngpICogIHN0ZXAoMC4yNSwgdXZzLnkpICogKDEuMCAtIHN0ZXAoMC45MzUsIHV2cy54KSkgKiAoIDEuMCAtIHN0ZXAoMC41LCB1dnMueSkpO1xuICAgICAgY29sLnh5eiA9IG1peChjb2wueHl6LCBjb2wueHl6ICogdGV4dEdsb3csIG1hc2spO1xuXG4gICAgICBnbF9GcmFnQ29sb3IgPSBjb2w7XG4gICAgfVxuICBgXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vYXNzZXRzL3NoYWRlcnMvc3RhZ2VBZGRpdGl2ZS5qcyIsIm1vZHVsZS5leHBvcnRzID0ge1xuICB2ZXJ0ZXhTaGFkZXIgOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdXZzLnh5ID0gdXYueHk7XG4gICAgICB2ZWM0IHAgPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1xuICAgICAgd29ybGRQb3MgPSAobW9kZWxNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICkpLnh5ejtcbiAgICAgIGdsX1Bvc2l0aW9uID0gcDtcbiAgICB9XG4gIGAsXG5cbiAgZnJhZ21lbnRTaGFkZXI6IGBcbiAgICAjZGVmaW5lIEZPR19SQURJVVMgIDU1LjBcbiAgICAjZGVmaW5lIEZPR19GQUxMT0ZGIDQ4LjBcbiAgICAjZGVmaW5lIEZPR19DT0xPUl9NVUxUIDAuOFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHVuaWZvcm0gdmVjMyBza3lDb2xvcjtcbiAgICB1bmlmb3JtIHZlYzMgYmFja2dsb3dDb2xvcjtcbiAgICB1bmlmb3JtIHNhbXBsZXIyRCBzcmM7XG5cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB2ZWM0IGNvbCA9IHRleHR1cmUyRChzcmMsIHV2cyk7XG4gICAgICBmbG9hdCBtYXNrO1xuXG4gICAgICAvLyBiZ1xuICAgICAgbWFzayA9IHN0ZXAoMC41LCB1dnMueCk7XG4gICAgICBjb2wueHl6ID0gbWl4KGNvbC54eXogKiBza3lDb2xvciwgY29sLnh5eiwgbWFzayk7XG5cbiAgICAgIC8vIGJhY2tnbG93XG4gICAgICBtYXNrID0gc3RlcCgwLjUsIHV2cy54KSAqIHN0ZXAoMC41LCB1dnMueSkgKiAoMS4wIC0gc3RlcCgwLjc1LCB1dnMueCkpO1xuICAgICAgY29sLnh5eiA9IG1peChjb2wueHl6LCBjb2wueHl6ICogYmFja2dsb3dDb2xvciwgbWFzayk7XG5cbiAgICAgIGZsb2F0IGZvZ0RlbnNpdHkgPSAxLjAgLSBwb3coY2xhbXAoZGlzdGFuY2Uod29ybGRQb3MsIHZlYzMoMC4sIDAuLCAtRk9HX1JBRElVUykpIC8gRk9HX0ZBTExPRkYsIDAuMCwgMS4wKSwgMS41KTtcbiAgICAgIGZvZ0RlbnNpdHkgKz0gY2xhbXAoMC4yIC0gcG93KGRpc3RhbmNlKHdvcmxkUG9zLCB2ZWMzKDAuMCwgMC4wLCB3b3JsZFBvcy56KSkgLyAxMC4wLCAyLjApLCAwLjAsIDEuMCk7XG4gICAgICBjb2wueHl6ID0gbWl4KGNvbC54eXosIGJhY2tnbG93Q29sb3IgKiBGT0dfQ09MT1JfTVVMVCwgZm9nRGVuc2l0eSk7XG5cbiAgICAgIGdsX0ZyYWdDb2xvciA9IGNvbDtcbiAgICB9XG4gIGBcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9hc3NldHMvc2hhZGVycy9zdGFnZU5vcm1hbC5qcyIsIi8qKlxuICogQWN0aXZlIGNvbG9yLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2FjdGl2ZS1jb2xvcicsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ21hdGVyaWFsJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgYWN0aXZlOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGNvbG9yOiB7ZGVmYXVsdDogJyNmZmZmZmYnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmRlZmF1bHRDb2xvciA9IHRoaXMuZWwuZ2V0QXR0cmlidXRlKCdtYXRlcmlhbCcpLmNvbG9yO1xuICAgIHRoaXMubWF0ZXJpYWxPYmogPSB7Y29sb3I6IHRoaXMuZGF0YS5jb2xvciwgb3BhY2l0eTogMX07XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcblxuICAgIGlmICh0aGlzLmRhdGEuYWN0aXZlKSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgdGhpcy5tYXRlcmlhbE9iaik7XG4gICAgICBlbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsICdjb2xvcicsIHRoaXMuZGVmYXVsdENvbG9yKTtcbiAgICAgIGlmIChlbC5jb21wb25lbnRzLmFuaW1hdGlvbl9fbW91c2VsZWF2ZSkge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgZWwuZW1pdCgnbW91c2VsZWF2ZScsIG51bGwsIGZhbHNlKTsgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KTtcblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdhY3RpdmUtdGV4dC1jb2xvcicsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ3RleHQnXSxcblxuICBzY2hlbWE6IHtcbiAgICBhY3RpdmU6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgY29sb3I6IHtkZWZhdWx0OiAnIzMzMyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZGVmYXVsdENvbG9yID0gdGhpcy5lbC5nZXRBdHRyaWJ1dGUoJ3RleHQnKS5jb2xvcjtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIGlmICh0aGlzLmRhdGEuYWN0aXZlKSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCAnY29sb3InLCB0aGlzLmRhdGEuY29sb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCAnY29sb3InLCB0aGlzLmRlZmF1bHRDb2xvcik7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2FjdGl2ZS1jb2xvci5qcyIsIlxuY29uc3QgTlVNX1ZBTFVFU19QRVJfQk9YID0gOTA7XG5cbi8qKlxuICogQ29sdW1uIGJhcnMgbW92aW5nIGluIHN5bmMgdG8gdGhlIGF1ZGlvIHZpYSBhdWRpbyBhbmFseXNlci5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdhdWRpby1jb2x1bW5zJywge1xuICBzY2hlbWE6IHtcbiAgICBhbmFseXNlcjoge3R5cGU6ICdzZWxlY3RvcicsIGRlZmF1bHQ6ICcjYXVkaW9BbmFseXNlcid9LFxuICAgIGhlaWdodDoge2RlZmF1bHQ6IDEuMH0sXG4gICAgbWlycm9yOiB7ZGVmYXVsdDogM30sXG4gICAgc2NhbGU6IHtkZWZhdWx0OiA0LjB9LFxuICAgIHNlcGFyYXRpb246IHtkZWZhdWx0OiAwLjN9LFxuICAgIHRoaWNrbmVzczoge2RlZmF1bHQ6IDAuMX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9iakRhdGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXVkaW9jb2x1bW5PYmonKS5kYXRhO1xuICAgIHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuT0JKTG9hZGVyKCk7XG4gICAgdmFyIGNvbHVtbkdlb21ldHJ5ID0gbG9hZGVyLnBhcnNlKG9iakRhdGEpLmNoaWxkcmVuWzBdLmdlb21ldHJ5O1xuXG4gICAgdGhpcy5hbmFseXNlciA9IHRoaXMuZGF0YS5hbmFseXNlci5jb21wb25lbnRzLmF1ZGlvYW5hbHlzZXI7XG5cbiAgICAvLyBOdW1iZXIgb2YgbGV2ZWxzIGlzIGhhbGYgdGhlIEZGVCBzaXplLlxuICAgIHRoaXMuZnJlcXVlbmN5QmluQ291bnQgPSB0aGlzLmFuYWx5c2VyLmRhdGEuZmZ0U2l6ZSAvIDI7XG5cbiAgICAvLyBDcmVhdGUgYm94ZXMgKG9uZSByb3cgb24gZWFjaCBzaWRlIHBlciBsZXZlbCkuXG4gICAgY29uc3QgZ2VvbWV0cmllcyA9IFtdO1xuICAgIGxldCB6UG9zaXRpb24gPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5mcmVxdWVuY3lCaW5Db3VudDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBzaWRlID0gMDsgc2lkZSA8IDI7IHNpZGUrKykge1xuICAgICAgICBjb25zdCBib3ggPSBjb2x1bW5HZW9tZXRyeS5jbG9uZSgpO1xuICAgICAgICB0aGlzLmluaXRCb3goYm94LCBzaWRlID09PSAwID8gMSA6IC0xLCB6UG9zaXRpb24pO1xuICAgICAgICBnZW9tZXRyaWVzLnB1c2goYm94KTtcbiAgICAgICAgLy8gTW92ZSBaIGJhY2suXG4gICAgICAgIHpQb3NpdGlvbiAtPSB0aGlzLmRhdGEuc2VwYXJhdGlvbjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmdlb21ldHJ5ID0gVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscy5tZXJnZUJ1ZmZlckdlb21ldHJpZXMoZ2VvbWV0cmllcyk7XG4gICAgY29uc3QgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKHRoaXMuZ2VvbWV0cnksIHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFscy5zdGFnZU5vcm1hbCk7XG4gICAgdGhpcy5lbC5zZXRPYmplY3QzRCgnbWVzaCcsIG1lc2gpO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBTdGVwIGJ5IDIgc2luY2Ugd2UgY3JlYXRlIG9uZSBib3ggb2YgZWFjaCBzaWRlIHBlciBsZXZlbC5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZnJlcXVlbmN5QmluQ291bnQgKiAyOyBpICs9IDIpIHtcbiAgICAgIGxldCB5U2NhbGUgPSAodGhpcy5kYXRhLmhlaWdodCAvIDIpICsgdGhpcy5hbmFseXNlci5sZXZlbHNbTWF0aC5mbG9vcihpIC8gMildIC8gMjU2LjAgKlxuICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5zY2FsZTtcbiAgICAgIGlmIChpc05hTih5U2NhbGUpKSB7IHJldHVybjsgfVxuICAgICAgdGhpcy5zZXRCb3hIZWlnaHQodGhpcy5mcmVxdWVuY3lCaW5Db3VudCAqIDIgLSBpIC0gMSwgeVNjYWxlKTtcbiAgICAgIHRoaXMuc2V0Qm94SGVpZ2h0KHRoaXMuZnJlcXVlbmN5QmluQ291bnQgKiAyIC0gaSAtIDIsIHlTY2FsZSk7XG4gICAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBib3ggYnkgY2hhbmdpbmcgdmVydGV4IGJ1ZmZlciwgdG8gc2V0IHBvc2l0aW9uIGFuZCBzY2FsZS5cbiAgICovXG4gIGluaXRCb3g6IGZ1bmN0aW9uIChib3gsIGZsaXAsIHpQb3NpdGlvbikge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICAvLyBTZXQgcG9zaXRpb24gYW5kIHNjYWxlIG9mIGJveCB2aWEgdmVydGljZXMuXG4gICAgZm9yIChsZXQgdiA9IDA7IHYgPCBib3guYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheS5sZW5ndGg7IHYgKz0gMykge1xuICAgICAgLy8gQXBwbHkgdGhpY2tuZXNzIHRvIFggYW5kIFouXG4gICAgICAvLyBib3guYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheVt2XSAqPSBkYXRhLnRoaWNrbmVzcztcbiAgICAgIC8vIGJveC5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5W3YgKyAyXSAqPSBkYXRhLnRoaWNrbmVzcztcbi8vIEFwcGx5IHpQb3NpdGlvbi5cbiAgICAgIGJveC5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5W3YgKyAyXSArPSB6UG9zaXRpb247XG5cbiAgICAgIC8vIEFwcGx5IGhlaWdodCB0byBZLlxuICAgICAgYm94LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXlbdiArIDFdICo9IGRhdGEuaGVpZ2h0IC8gMjtcblxuICAgICAgLy8gQ2hhbmdlIFggdmVydGV4IHBvc2l0aW9ucyBmb3IgbWlycm9yaW5nLlxuICAgICAgYm94LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXlbdl0gKz0gZmxpcCAqIGRhdGEubWlycm9yO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogU2V0IFkgb2YgdmVydGljZXMuXG4gICAqL1xuICBzZXRCb3hIZWlnaHQ6IGZ1bmN0aW9uIChib3hOdW1iZXIsIGhlaWdodCkge1xuICAgIGNvbnN0IGJveEluZGV4ID0gYm94TnVtYmVyICogTlVNX1ZBTFVFU19QRVJfQk9YO1xuICAgIGZvciAobGV0IGkgPSBib3hJbmRleDsgaSA8IGJveEluZGV4ICsgTlVNX1ZBTFVFU19QRVJfQk9YOyBpICs9IDMpIHtcbiAgICAgIC8vIFNldCBZLlxuICAgICAgbGV0IHlWYWx1ZSA9IHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheVtpICsgMV07XG4gICAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXlbaSArIDFdID0geVZhbHVlID49IDBcbiAgICAgICAgPyBoZWlnaHRcbiAgICAgICAgOiAtMSAqIGhlaWdodDtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvYXVkaW8tY29sdW1ucy5qcyIsImNvbnN0IEFOSU1FID0gQUZSQU1FLkFOSU1FIHx8IEFGUkFNRS5hbmltZTtcblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdiZWFtcycsIHtcbiAgc2NoZW1hOiB7XG4gICAgaXNQbGF5aW5nOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHBvb2xTaXplOiB7ZGVmYXVsdDogM31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5iZWFtcyA9IFtdO1xuICAgIHRoaXMuY3VycmVudFJlZCA9IDA7XG4gICAgdGhpcy5jdXJyZW50Qmx1ZSA9IDA7XG4gICAgdGhpcy5jbGVhckJlYW1zID0gdGhpcy5jbGVhckJlYW1zLmJpbmQodGhpcyk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsZWFyZ2FtZScsIHRoaXMuY2xlYXJCZWFtcyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJlYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5iZWFtc1tpXS50aW1lKSB7XG4gICAgICAgIHRoaXMuYmVhbXNbaV0udmlzaWJsZSA9IHRoaXMuZGF0YS5pc1BsYXlpbmc7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBCZWFtIHBvb2xzLlxuICAgIC8vY29uc3QgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuUGxhbmVCdWZmZXJHZW9tZXRyeSgwLjQsIDUwKS50cmFuc2xhdGUoMCwgMjUsIDApO1xuXG4gICAgdmFyIG9iakRhdGE7XG4gICAgdmFyIGxvYWRlcjtcbiAgICB2YXIgcmVkR2VvbWV0cnksIGJsdWVHZW9tZXRyeTtcblxuICAgIHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuT0JKTG9hZGVyKCk7XG4gICAgb2JqRGF0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWRiZWFtT2JqJykuZGF0YTtcbiAgICByZWRHZW9tZXRyeSA9IGxvYWRlci5wYXJzZShvYmpEYXRhKS5jaGlsZHJlblswXS5nZW9tZXRyeTtcblxuICAgIG9iakRhdGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmx1ZWJlYW1PYmonKS5kYXRhO1xuICAgIGJsdWVHZW9tZXRyeSA9IGxvYWRlci5wYXJzZShvYmpEYXRhKS5jaGlsZHJlblswXS5nZW9tZXRyeTtcblxuICAgIHRoaXMucmVkQmVhbXMgPSB0aGlzLmNyZWF0ZUJlYW1Qb29sKHJlZEdlb21ldHJ5LCB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbHMuc3RhZ2VBZGRpdGl2ZSk7XG4gICAgdGhpcy5ibHVlQmVhbXMgPSB0aGlzLmNyZWF0ZUJlYW1Qb29sKGJsdWVHZW9tZXRyeSwgdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMubWF0ZXJpYWxzLnN0YWdlQWRkaXRpdmUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBVc2UgdGljayBmb3IgbWFudWFsIEFOSU1FIGFuaW1hdGlvbnMsIGVsc2UgaXQgd2lsbCBjcmVhdGUgUkFGLlxuICAgKi9cbiAgdGljazogZnVuY3Rpb24gKHQsIGR0KSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuaXNQbGF5aW5nKSB7IHJldHVybjsgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5iZWFtcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGJlYW0gPSB0aGlzLmJlYW1zW2ldO1xuICAgICAgLy8gVGllIGFuaW1hdGlvbiBzdGF0ZSB0byBiZWFtIHZpc2liaWxpdHkuXG4gICAgICBpZiAoIWJlYW0udmlzaWJsZSkgeyBjb250aW51ZTsgfVxuICAgICAgYmVhbS50aW1lICs9IGR0O1xuICAgICAgYmVhbS5hbmltYXRpb24udGljayhiZWFtLnRpbWUpO1xuICAgIH1cbiAgfSxcblxuICBjcmVhdGVCZWFtUG9vbDogZnVuY3Rpb24gKGdlb21ldHJ5LCBtYXRlcmlhbCkge1xuICAgIGNvbnN0IGJlYW1zID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGEucG9vbFNpemU7IGkrKykge1xuICAgICAgbGV0IGJlYW0gPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xuICAgICAgYmVhbS52aXNpYmxlID0gZmFsc2U7XG4gICAgICBiZWFtLmFuaW1hdGlvbiA9IEFOSU1FKHtcbiAgICAgICAgYXV0b3BsYXk6IGZhbHNlLFxuICAgICAgICB0YXJnZXRzOiBiZWFtLnNjYWxlLFxuICAgICAgICB4OiAwLjAwMDAxLFxuICAgICAgICBkdXJhdGlvbjogMzAwLFxuICAgICAgICBlYXNpbmc6ICdlYXNlSW5DdWJpYycsXG4gICAgICAgIGNvbXBsZXRlOiAoKSA9PiB7IGJlYW0udmlzaWJsZSA9IGZhbHNlOyB9XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZWwub2JqZWN0M0QuYWRkKGJlYW0pO1xuICAgICAgYmVhbXMucHVzaChiZWFtKTtcbiAgICAgIHRoaXMuYmVhbXMucHVzaChiZWFtKTtcbiAgICB9XG4gICAgcmV0dXJuIGJlYW1zO1xuICB9LFxuXG4gIG5ld0JlYW06IGZ1bmN0aW9uIChjb2xvciwgcG9zaXRpb24pIHtcbiAgICB2YXIgYmVhbTtcbiAgICBpZiAoY29sb3IgPT09ICdyZWQnKSB7XG4gICAgICBiZWFtID0gdGhpcy5yZWRCZWFtc1t0aGlzLmN1cnJlbnRSZWRdO1xuICAgICAgdGhpcy5jdXJyZW50UmVkID0gKHRoaXMuY3VycmVudFJlZCArIDEpICUgdGhpcy5yZWRCZWFtcy5sZW5ndGg7XG4gICAgICAvLyB6IG9mZnNldCB0byBhdm9pZCB6LWZpZ2h0aW5nLlxuICAgICAgYmVhbS5wb3NpdGlvbi5zZXQocG9zaXRpb24ueCwgcG9zaXRpb24ueSwgcG9zaXRpb24ueiArIHRoaXMuY3VycmVudFJlZCAvIDUwLjApO1xuICAgIH0gZWxzZSB7XG4gICAgICBiZWFtID0gdGhpcy5ibHVlQmVhbXNbdGhpcy5jdXJyZW50Qmx1ZV07XG4gICAgICB0aGlzLmN1cnJlbnRCbHVlID0gKHRoaXMuY3VycmVudEJsdWUgKyAxKSAlIHRoaXMuYmx1ZUJlYW1zLmxlbmd0aDtcbiAgICAgIGJlYW0ucG9zaXRpb24uc2V0KHBvc2l0aW9uLngsIHBvc2l0aW9uLnksIHBvc2l0aW9uLnogKyB0aGlzLmN1cnJlbnRCbHVlIC8gNTAuMCk7XG4gICAgfVxuXG4gICAgYmVhbS52aXNpYmxlID0gdHJ1ZTtcbiAgICBiZWFtLnNjYWxlLnggPSAxO1xuICAgIGJlYW0udGltZSA9IDA7XG4gIH0sXG5cbiAgY2xlYXJCZWFtczogZnVuY3Rpb24gKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5iZWFtcy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5iZWFtc1tpXS52aXNpYmxlID0gZmFsc2U7XG4gICAgICB0aGlzLmJlYW1zW2ldLnRpbWUgPSAwO1xuICAgICAgdGhpcy5iZWFtc1tpXS5zY2FsZS54ID0gMTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvYmVhbXMuanMiLCJ2YXIgYXVkaW9Db250ZXh0ID0gbmV3IHdpbmRvdy5BdWRpb0NvbnRleHQoKTtcbnZhciBzb3VyY2VDcmVhdGVkQ2FsbGJhY2s7XG5cbmNvbnN0IExBWUVSX0JPVFRPTSA9ICdib3R0b20nO1xuY29uc3QgTEFZRVJfTUlERExFID0gJ21pZGRsZSc7XG5jb25zdCBMQVlFUl9UT1AgPSAndG9wJztcbmNvbnN0IFZPTFVNRSA9IDAuMjU7XG5cbi8vIEFsbG93cyBmb3IgbW9kaWZ5aW5nIGRldHVuZS4gUFIgaGFzIGJlZW4gc2VudCB0byB0aHJlZS5qcy5cblRIUkVFLkF1ZGlvLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKCkge1xuICBpZiAodGhpcy5pc1BsYXlpbmcgPT09IHRydWUpIHtcbiAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkF1ZGlvOiBBdWRpbyBpcyBhbHJlYWR5IHBsYXlpbmcuJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHRoaXMuaGFzUGxheWJhY2tDb250cm9sID09PSBmYWxzZSkge1xuICAgIGNvbnNvbGUud2FybignVEhSRUUuQXVkaW86IHRoaXMgQXVkaW8gaGFzIG5vIHBsYXliYWNrIGNvbnRyb2wuJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHNvdXJjZSA9IHRoaXMuY29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcbiAgc291cmNlLmJ1ZmZlciA9IHRoaXMuYnVmZmVyO1xuICBzb3VyY2UuZGV0dW5lLnZhbHVlID0gdGhpcy5kZXR1bmU7XG4gIHNvdXJjZS5sb29wID0gdGhpcy5sb29wO1xuICBzb3VyY2Uub25lbmRlZCA9IHRoaXMub25FbmRlZC5iaW5kKHRoaXMpO1xuICBzb3VyY2UucGxheWJhY2tSYXRlLnNldFZhbHVlQXRUaW1lKHRoaXMucGxheWJhY2tSYXRlLCB0aGlzLnN0YXJ0VGltZSk7XG4gIHRoaXMuc3RhcnRUaW1lID0gdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lO1xuICBpZiAoc291cmNlQ3JlYXRlZENhbGxiYWNrKSB7IHNvdXJjZUNyZWF0ZWRDYWxsYmFjayhzb3VyY2UpOyB9XG4gIHNvdXJjZS5zdGFydCh0aGlzLnN0YXJ0VGltZSwgdGhpcy5vZmZzZXQpO1xuXG4gIHRoaXMuaXNQbGF5aW5nID0gdHJ1ZTtcblxuICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgcmV0dXJuIHRoaXMuY29ubmVjdCgpO1xufTtcblxuLyoqXG4gKiBCZWF0IGhpdCBzb3VuZCB1c2luZyBwb3NpdGlvbmFsIGF1ZGlvIGFuZCBhdWRpbyBidWZmZXIgc291cmNlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2JlYXQtaGl0LXNvdW5kJywge1xuICBkaXJlY3Rpb25zVG9Tb3VuZHM6IHtcbiAgICB1cDogJycsXG4gICAgZG93bjogJycsXG4gICAgdXBsZWZ0OiAnbGVmdCcsXG4gICAgdXByaWdodDogJ3JpZ2h0JyxcbiAgICBkb3dubGVmdDogJ2xlZnQnLFxuICAgIGRvd25yaWdodDogJ3JpZ2h0JyxcbiAgICBsZWZ0OiAnbGVmdCcsXG4gICAgcmlnaHQ6ICdyaWdodCdcbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5jdXJyZW50QmVhdEVsID0gbnVsbDtcbiAgICB0aGlzLmN1cnJlbnRDdXREaXJlY3Rpb24gPSAnJztcbiAgICB0aGlzLnByb2Nlc3NTb3VuZCA9IHRoaXMucHJvY2Vzc1NvdW5kLmJpbmQodGhpcyk7XG4gICAgc291cmNlQ3JlYXRlZENhbGxiYWNrID0gdGhpcy5zb3VyY2VDcmVhdGVkQ2FsbGJhY2suYmluZCh0aGlzKTtcblxuICAgIC8vIFNvdW5kIHBvb2xzLlxuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKGBzb3VuZF9fYmVhdGhpdCR7aX1gLCB7XG4gICAgICAgIHBvb2xTaXplOiA0LFxuICAgICAgICBzcmM6IGAjaGl0U291bmQke2l9YCxcbiAgICAgICAgdm9sdW1lOiBWT0xVTUVcbiAgICAgIH0pO1xuICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoYHNvdW5kX19iZWF0aGl0JHtpfWxlZnRgLCB7XG4gICAgICAgIHBvb2xTaXplOiA0LFxuICAgICAgICBzcmM6IGAjaGl0U291bmQke2l9bGVmdGAsXG4gICAgICAgIHZvbHVtZTogVk9MVU1FXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKGBzb3VuZF9fYmVhdGhpdCR7aX1yaWdodGAsIHtcbiAgICAgICAgcG9vbFNpemU6IDQsXG4gICAgICAgIHNyYzogYCNoaXRTb3VuZCR7aX1yaWdodGAsXG4gICAgICAgIHZvbHVtZTogVk9MVU1FXG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIC8vIEtpY2sgdGhyZWUuanMgbG9hZGVyLi4uRG9uJ3Qga25vdyB3aHkgc29tZXRpbWVzIGRvZXNuJ3QgbG9hZC5cbiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSAxMDsgaSsrKSB7XG4gICAgICBpZiAoIXRoaXMuZWwuY29tcG9uZW50c1tgc291bmRfX2JlYXRoaXQke2l9YF0ubG9hZGVkKSB7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKGBzb3VuZF9fYmVhdGhpdCR7aX1gLCAnc3JjJywgJycpO1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZShgc291bmRfX2JlYXRoaXQke2l9YCwgJ3NyYycsIGAjaGl0U291bmQke2l9YCk7XG4gICAgICB9XG4gICAgICBpZiAoIXRoaXMuZWwuY29tcG9uZW50c1tgc291bmRfX2JlYXRoaXQke2l9bGVmdGBdLmxvYWRlZCkge1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZShgc291bmRfX2JlYXRoaXQke2l9bGVmdGAsICdzcmMnLCAnJyk7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKGBzb3VuZF9fYmVhdGhpdCR7aX1sZWZ0YCwgJ3NyYycsIGAjaGl0U291bmQke2l9bGVmdGApO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmVsLmNvbXBvbmVudHNbYHNvdW5kX19iZWF0aGl0JHtpfXJpZ2h0YF0ubG9hZGVkKSB7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKGBzb3VuZF9fYmVhdGhpdCR7aX1yaWdodGAsICdzcmMnLCAnJyk7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKGBzb3VuZF9fYmVhdGhpdCR7aX1yaWdodGAsICdzcmMnLCBgI2hpdFNvdW5kJHtpfXJpZ2h0YCk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHBsYXlTb3VuZDogZnVuY3Rpb24gKGJlYXRFbCwgY3V0RGlyZWN0aW9uKSB7XG4gICAgY29uc3QgcmFuZCA9IDEgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgY29uc3QgZGlyID0gdGhpcy5kaXJlY3Rpb25zVG9Tb3VuZHNbY3V0RGlyZWN0aW9uIHx8ICd1cCddO1xuICAgIGNvbnN0IHNvdW5kUG9vbCA9IHRoaXMuZWwuY29tcG9uZW50c1tgc291bmRfX2JlYXRoaXQke3JhbmR9JHtkaXJ9YF07XG4gICAgdGhpcy5jdXJyZW50QmVhdEVsID0gYmVhdEVsO1xuICAgIHNvdW5kUG9vbC5wbGF5U291bmQodGhpcy5wcm9jZXNzU291bmQpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBTZXQgYXVkaW8gc3R1ZmYgYmVmb3JlIHBsYXlpbmcuXG4gICAqL1xuICBwcm9jZXNzU291bmQ6IGZ1bmN0aW9uIChhdWRpbykge1xuICAgIGF1ZGlvLmRldHVuZSA9IDA7XG4gICAgdGhpcy5jdXJyZW50QmVhdEVsLm9iamVjdDNELmdldFdvcmxkUG9zaXRpb24oYXVkaW8ucG9zaXRpb24pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBGdW5jdGlvbiBjYWxsYmFjayB0byBwcm9jZXNzIHNvdXJjZSBidWZmZXIgb25jZSBjcmVhdGVkLlxuICAgKiBTZXQgZGV0dW5lIGZvciBwaXRjaCBhbmQgaW5mbGVjdGlvbnMuXG4gICAqL1xuICBzb3VyY2VDcmVhdGVkQ2FsbGJhY2s6IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAvLyBQaXRjaCBiYXNlZCBvbiBsYXllci5cbiAgICBjb25zdCBsYXllciA9IHRoaXMuZ2V0TGF5ZXIodGhpcy5jdXJyZW50QmVhdEVsLm9iamVjdDNELnBvc2l0aW9uLnkpO1xuICAgIGlmIChsYXllciA9PT0gTEFZRVJfQk9UVE9NKSB7XG4gICAgICBzb3VyY2UuZGV0dW5lLnNldFZhbHVlQXRUaW1lKC00MDAsIDApO1xuICAgIH0gZWxzZSBpZiAobGF5ZXIgPT09IExBWUVSX1RPUCkge1xuICAgICAgc291cmNlLmRldHVuZS5zZXRWYWx1ZUF0VGltZSgyMDAsIDApO1xuICAgIH1cblxuICAgIC8vIEluZmxlY3Rpb24gb24gc3RyaWtlIGRvd24gb3IgdXAuXG4gICAgaWYgKHRoaXMuY3VycmVudEN1dERpcmVjdGlvbiA9PT0gJ2Rvd24nKSB7XG4gICAgICBzb3VyY2UuZGV0dW5lLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKC00MDAsIDEpO1xuICAgIH1cbiAgICBpZiAodGhpcy5jdXJyZW50Q3V0RGlyZWN0aW9uID09PSAndXAnKSB7XG4gICAgICBzb3VyY2UuZGV0dW5lLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKDQwMCwgMSk7XG4gICAgfVxuXHR9LFxuXG4gIC8qKlxuICAgKiBHZXQgd2hldGhlciBiZWF0IGlzIG9uIGJvdHRvbSwgbWlkZGxlLCBvciB0b3AgbGF5ZXIuXG4gICAqL1xuICBnZXRMYXllcjogZnVuY3Rpb24gKHkpIHtcbiAgICBpZiAoeSA9PT0gMSkgeyByZXR1cm4gTEFZRVJfQk9UVE9NOyB9XG4gICAgaWYgKHkgPT09IDEuNzApIHsgcmV0dXJuIExBWUVSX1RPUDsgfVxuICAgIHJldHVybiBMQVlFUl9NSURETEU7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvYmVhdC1oaXQtc291bmQuanMiLCJpbXBvcnQge0JFQVRfV0FSTVVQX09GRlNFVCwgQkVBVF9XQVJNVVBfU1BFRUQsIEJFQVRfV0FSTVVQX1RJTUV9IGZyb20gJy4uL2NvbnN0YW50cy9iZWF0JztcbmltcG9ydCB1dGlscyBmcm9tICcuLi91dGlscyc7XG5cbmxldCBza2lwRGVidWcgPSBBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdza2lwJykgfHwgMDtcbnNraXBEZWJ1ZyA9IHBhcnNlSW50KHNraXBEZWJ1ZywgMTApO1xuXG4vKipcbiAqIExvYWQgYmVhdCBkYXRhIChhbGwgdGhlIGJlYXRzIGFuZCBzdWNoKS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdiZWF0LWxvYWRlcicsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ3N0YWdlLWNvbG9ycyddLFxuXG4gIHNjaGVtYToge1xuICAgIGJlYXRBbnRpY2lwYXRpb25UaW1lOiB7ZGVmYXVsdDogMS4xfSxcbiAgICBiZWF0U3BlZWQ6IHtkZWZhdWx0OiA4LjB9LFxuICAgIGJlYXRXYXJtdXBUaW1lOiB7ZGVmYXVsdDogQkVBVF9XQVJNVVBfVElNRSAvIDEwMDB9LFxuICAgIGJlYXRXYXJtdXBTcGVlZDoge2RlZmF1bHQ6IEJFQVRfV0FSTVVQX1NQRUVEfSxcbiAgICBjaGFsbGVuZ2VJZDoge3R5cGU6ICdzdHJpbmcnfSwgIC8vIElmIGNsaWNrZWQgcGxheS5cbiAgICBkaWZmaWN1bHR5OiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIGlzUGxheWluZzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBtZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZDoge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIG9yaWVudGF0aW9uc0h1bWFuaXplZDogW1xuICAgICd1cCcsXG4gICAgJ2Rvd24nLFxuICAgICdsZWZ0JyxcbiAgICAncmlnaHQnLFxuICAgICd1cGxlZnQnLFxuICAgICd1cHJpZ2h0JyxcbiAgICAnZG93bmxlZnQnLFxuICAgICdkb3ducmlnaHQnXG4gIF0sXG5cbiAgaG9yaXpvbnRhbFBvc2l0aW9uczogWy0wLjc1LCAtMC4yNSwgMC4yNSwgMC43NV0sXG5cbiAgaG9yaXpvbnRhbFBvc2l0aW9uc0h1bWFuaXplZDoge1xuICAgIDA6ICdsZWZ0JyxcbiAgICAxOiAnbWlkZGxlbGVmdCcsXG4gICAgMjogJ21pZGRsZXJpZ2h0JyxcbiAgICAzOiAncmlnaHQnXG4gIH0sXG5cbiAgcG9zaXRpb25IdW1hbml6ZWQ6IHtcbiAgICB0b3BMZWZ0OiB7bGF5ZXI6IDIsIGluZGV4OiAwfSxcbiAgICB0b3BDZW50ZXJMZWZ0OiB7bGF5ZXI6IDIsIGluZGV4OiAxfSxcbiAgICB0b3BDZW50ZXJSaWdodDoge2xheWVyOiAyLCBpbmRleDogMn0sXG4gICAgdG9wUmlnaHQ6IHtsYXllcjogMiwgaW5kZXg6IDN9LFxuXG4gICAgbWlkZGxlTGVmdDoge2xheWVyOiAxLCBpbmRleDogMH0sXG4gICAgbWlkZGxlQ2VudGVyTGVmdDoge2xheWVyOiAxLCBpbmRleDogMX0sXG4gICAgbWlkZGxlQ2VudGVyUmlnaHQ6IHtsYXllcjogMSwgaW5kZXg6IDJ9LFxuICAgIG1pZGRsZVJpZ2h0OiB7bGF5ZXI6IDEsIGluZGV4OiAzfSxcblxuICAgIGJvdHRvbUxlZnQ6IHtsYXllcjogMCwgaW5kZXg6IDB9LFxuICAgIGJvdHRvbUNlbnRlckxlZnQ6IHtsYXllcjogMCwgaW5kZXg6IDF9LFxuICAgIGJvdHRvbUNlbnRlclJpZ2h0OiB7bGF5ZXI6IDAsIGluZGV4OiAyfSxcbiAgICBib3R0b21SaWdodDoge2xheWVyOiAwLCBpbmRleDogM30sXG4gIH0sXG5cbiAgdmVydGljYWxQb3NpdGlvbnNIdW1hbml6ZWQ6IHtcbiAgICAwOiAnYm90dG9tJyxcbiAgICAxOiAnbWlkZGxlJyxcbiAgICAyOiAndG9wJ1xuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmF1ZGlvQW5hbHlzZXJFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdWRpb2FuYWx5c2VyJyk7XG4gICAgdGhpcy5iZWF0RGF0YSA9IG51bGw7XG4gICAgdGhpcy5iZWF0RGF0YVByb2Nlc3NlZCA9IGZhbHNlO1xuICAgIHRoaXMuYmVhdENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZWF0Q29udGFpbmVyJyk7XG4gICAgdGhpcy5iZWF0c1RpbWUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5iZWF0c1ByZWxvYWRUaW1lID0gMDtcbiAgICB0aGlzLmJlYXRzUHJlbG9hZFRpbWVUb3RhbCA9XG4gICAgICAodGhpcy5kYXRhLmJlYXRBbnRpY2lwYXRpb25UaW1lICsgdGhpcy5kYXRhLmJlYXRXYXJtdXBUaW1lKSAqIDEwMDA7XG4gICAgdGhpcy5icG0gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy54aHIgPSBudWxsO1xuICAgIHRoaXMuc3RhZ2VDb2xvcnMgPSB0aGlzLmVsLmNvbXBvbmVudHNbJ3N0YWdlLWNvbG9ycyddO1xuICAgIC8vIEJlYXRzIGFycml2ZSBhdCBzd29yZCBzdHJva2UgZGlzdGFuY2Ugc3luY2VkIHdpdGggdGhlIG11c2ljLlxuICAgIHRoaXMuc3dvcmRPZmZzZXQgPSAxLjU7XG4gICAgdGhpcy50d2lzdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R3aXN0ZXInKTtcbiAgICB0aGlzLmxlZnRTdGFnZUxhc2VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsZWZ0U3RhZ2VMYXNlcnMnKTtcbiAgICB0aGlzLnJpZ2h0U3RhZ2VMYXNlcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlnaHRTdGFnZUxhc2VycycpO1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGVhcmdhbWUnLCB0aGlzLmNsZWFyQmVhdHMuYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICAvLyBTdGFydCBwbGF5aW5nLlxuICAgIGlmICghb2xkRGF0YS5jaGFsbGVuZ2VJZCAmJiBkYXRhLmNoYWxsZW5nZUlkICYmIHRoaXMuYmVhdERhdGEpIHtcbiAgICAgIHRoaXMucHJvY2Vzc0JlYXRzKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFkYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkIHx8ICFkYXRhLmRpZmZpY3VsdHkpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBQcmVmZXRjaCBiZWF0cy5cbiAgICBpZiAoZGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCAhPT0gb2xkRGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCB8fFxuICAgICAgICBkYXRhLmRpZmZpY3VsdHkgIT09IG9sZERhdGEuZGlmZmljdWx0eSkge1xuICAgICAgdGhpcy5mZXRjaEJlYXRzKCk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBYSFIuIEJlYXQgZGF0YSBpcyBwcmVmZXRjaGVkIHdoZW4gdXNlciBzZWxlY3RzIGEgbWVudSBjaGFsbGVuZ2UsIGFuZCBzdG9yZWQgYXdheVxuICAgKiB0byBiZSBwcm9jZXNzZWQgbGF0ZXIuXG4gICAqL1xuICBmZXRjaEJlYXRzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcblxuICAgIGlmICh0aGlzLnhocikgeyB0aGlzLnhoci5hYm9ydCgpOyB9XG5cbiAgICAvLyBMb2FkIGJlYXRzLlxuICAgIGxldCB1cmwgPSB1dGlscy5nZXRTM0ZpbGVVcmwodGhpcy5kYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCR7dGhpcy5kYXRhLmRpZmZpY3VsdHl9Lmpzb25gKTtcbiAgICBjb25zdCB4aHIgPSB0aGlzLnhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIGVsLmVtaXQoJ2JlYXRsb2FkZXJzdGFydCcpO1xuICAgIGNvbnNvbGUubG9nKGBbYmVhdC1sb2FkZXJdIEZldGNoaW5nICR7dXJsfS4uLmApO1xuICAgIHhoci5vcGVuKCdHRVQnLCB1cmwpO1xuICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuICAgICAgdGhpcy5iZWF0RGF0YSA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICB0aGlzLmJlYXREYXRhUHJvY2Vzc2VkID0gZmFsc2U7XG4gICAgICB0aGlzLnhociA9IG51bGw7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnYmVhdGxvYWRlcmZpbmlzaCcsIG51bGwsIGZhbHNlKTtcbiAgICB9KTtcbiAgICB4aHIuc2VuZCgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBMb2FkIHRoZSBiZWF0IGRhdGEgaW50byB0aGUgZ2FtZS5cbiAgICovXG4gIHByb2Nlc3NCZWF0czogZnVuY3Rpb24gKCkge1xuICAgIC8vIFJlc2V0IHZhcmlhYmxlcyB1c2VkIGR1cmluZyBwbGF5YmFjay5cbiAgICAvLyBCZWF0cyBzcGF3biBhaGVhZCBvZiB0aGUgc29uZyBhbmQgZ2V0IHRvIHRoZSB1c2VyIGluIHN5bmMgd2l0aCB0aGUgbXVzaWMuXG4gICAgdGhpcy5iZWF0c1RpbWUgPSAwO1xuICAgIHRoaXMuYmVhdHNQcmVsb2FkVGltZSA9IDA7XG4gICAgdGhpcy5iZWF0RGF0YS5fZXZlbnRzLnNvcnQobGVzc1RoYW4pO1xuICAgIHRoaXMuYmVhdERhdGEuX29ic3RhY2xlcy5zb3J0KGxlc3NUaGFuKTtcbiAgICB0aGlzLmJlYXREYXRhLl9ub3Rlcy5zb3J0KGxlc3NUaGFuKTtcbiAgICB0aGlzLmJwbSA9IHRoaXMuYmVhdERhdGEuX2JlYXRzUGVyTWludXRlO1xuXG4gICAgLy8gU29tZSBldmVudHMgaGF2ZSBuZWdhdGl2ZSB0aW1lIHN0YW1wIHRvIGluaXRpYWxpemUgdGhlIHN0YWdlLlxuICAgIGNvbnN0IGV2ZW50cyA9IHRoaXMuYmVhdERhdGEuX2V2ZW50cztcbiAgICBpZiAoZXZlbnRzLmxlbmd0aCAmJiBldmVudHNbMF0uX3RpbWUgPCAwKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgZXZlbnRzW2ldLl90aW1lIDwgMDsgaSsrKSB7XG4gICAgICAgIHRoaXMuZ2VuZXJhdGVFdmVudChldmVudHNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuYmVhdERhdGFQcm9jZXNzZWQgPSB0cnVlO1xuICAgIGNvbnNvbGUubG9nKCdbYmVhdC1sb2FkZXJdIEZpbmlzaGVkIHByb2Nlc3NpbmcgYmVhdCBkYXRhLicpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBiZWF0cyBhbmQgc3R1ZmYgYWNjb3JkaW5nIHRvIHRpbWVzdGFtcC5cbiAgICovXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lLCBkZWx0YSkge1xuICAgIGlmICghdGhpcy5kYXRhLmlzUGxheWluZyB8fCAhdGhpcy5kYXRhLmNoYWxsZW5nZUlkIHx8ICF0aGlzLmJlYXREYXRhKSB7IHJldHVybjsgfVxuXG4gICAgY29uc3QgcHJldkJlYXRzVGltZSA9IHRoaXMuYmVhdHNUaW1lICsgc2tpcERlYnVnO1xuICAgIGlmICh0aGlzLmJlYXRzUHJlbG9hZFRpbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gR2V0IGN1cnJlbnQgc29uZyB0aW1lLlxuICAgICAgY29uc3Qgc29uZyA9IHRoaXMuZWwuY29tcG9uZW50cy5zb25nO1xuICAgICAgaWYgKCFzb25nLmlzUGxheWluZykgeyByZXR1cm47IH1cbiAgICAgIHRoaXMuYmVhdHNUaW1lID0gKHNvbmcuZ2V0Q3VycmVudFRpbWUoKSArIHRoaXMuZGF0YS5iZWF0QW50aWNpcGF0aW9uVGltZSArXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuYmVhdFdhcm11cFRpbWUpICogMTAwMDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU29uZyBpcyBub3QgcGxheWluZyBhbmQgaXMgcHJlbG9hZGluZyBiZWF0cywgdXNlIG1haW50YWluZWQgYmVhdCB0aW1lLlxuICAgICAgdGhpcy5iZWF0c1RpbWUgPSB0aGlzLmJlYXRzUHJlbG9hZFRpbWU7XG4gICAgfVxuXG4gICAgLy8gTG9hZCBpbiBzdHVmZiBzY2hlZHVsZWQgYmV0d2VlbiB0aGUgbGFzdCB0aW1lc3RhbXAgYW5kIGN1cnJlbnQgdGltZXN0YW1wLlxuICAgIC8vIEJlYXRzLlxuICAgIGNvbnN0IGJlYXRzVGltZSA9IHRoaXMuYmVhdHNUaW1lICsgc2tpcERlYnVnO1xuICAgIGNvbnN0IGJwbSA9IHRoaXMuYmVhdERhdGEuX2JlYXRzUGVyTWludXRlO1xuICAgIGNvbnN0IG1zUGVyQmVhdCA9IDEwMDAgKiA2MCAvIHRoaXMuYmVhdERhdGEuX2JlYXRzUGVyTWludXRlO1xuICAgIGNvbnN0IG5vdGVzID0gdGhpcy5iZWF0RGF0YS5fbm90ZXM7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub3Rlcy5sZW5ndGg7ICsraSkge1xuICAgICAgbGV0IG5vdGVUaW1lID0gbm90ZXNbaV0uX3RpbWUgKiBtc1BlckJlYXQ7XG4gICAgICBpZiAobm90ZVRpbWUgPiBwcmV2QmVhdHNUaW1lICYmIG5vdGVUaW1lIDw9IGJlYXRzVGltZSkge1xuICAgICAgICBub3Rlc1tpXS50aW1lID0gbm90ZVRpbWU7XG4gICAgICAgIHRoaXMuZ2VuZXJhdGVCZWF0KG5vdGVzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBXYWxscy5cbiAgICBjb25zdCBvYnN0YWNsZXMgPSB0aGlzLmJlYXREYXRhLl9vYnN0YWNsZXM7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYnN0YWNsZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGxldCBub3RlVGltZSA9IG9ic3RhY2xlc1tpXS5fdGltZSAqIG1zUGVyQmVhdDtcbiAgICAgIGlmIChub3RlVGltZSA+IHByZXZCZWF0c1RpbWUgJiYgbm90ZVRpbWUgPD0gYmVhdHNUaW1lKSB7XG4gICAgICAgIHRoaXMuZ2VuZXJhdGVXYWxsKG9ic3RhY2xlc1tpXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU3RhZ2UgZXZlbnRzLlxuICAgIGNvbnN0IGV2ZW50cyA9IHRoaXMuYmVhdERhdGEuX2V2ZW50cztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50cy5sZW5ndGg7ICsraSkge1xuICAgICAgbGV0IG5vdGVUaW1lID0gZXZlbnRzW2ldLl90aW1lICogbXNQZXJCZWF0O1xuICAgICAgaWYgKG5vdGVUaW1lID4gcHJldkJlYXRzVGltZSAmJiBub3RlVGltZSA8PSBiZWF0c1RpbWUpIHtcbiAgICAgICAgdGhpcy5nZW5lcmF0ZUV2ZW50KGV2ZW50c1tpXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYmVhdHNQcmVsb2FkVGltZSA9PT0gdW5kZWZpbmVkKSB7IHJldHVybjsgfVxuXG4gICAgaWYgKHRoaXMuYmVhdHNQcmVsb2FkVGltZSA+PSB0aGlzLmJlYXRzUHJlbG9hZFRpbWVUb3RhbCkge1xuICAgICAgLy8gRmluaXNoZWQgcHJlbG9hZC5cbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdiZWF0bG9hZGVycHJlbG9hZGZpbmlzaCcsIG51bGwsIGZhbHNlKTtcbiAgICAgIHRoaXMuYmVhdHNQcmVsb2FkVGltZSA9IHVuZGVmaW5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ29udGludWUgcHJlbG9hZC5cbiAgICAgIHRoaXMuYmVhdHNQcmVsb2FkVGltZSArPSBkZWx0YTtcbiAgICB9XG4gIH0sXG5cbiAgZ2VuZXJhdGVCZWF0OiAoZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGJlYXRPYmogPSB7fTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAobm90ZUluZm8pIHtcbiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICAgIC8vIGlmIChNYXRoLnJhbmRvbSgpIDwgMC44KSB7IG5vdGVJbmZvLl90eXBlID0gMzsgfSAvLyBUbyBkZWJ1ZyBtaW5lcy5cbiAgICAgIGxldCBjb2xvcjtcbiAgICAgIGxldCB0eXBlID0gbm90ZUluZm8uX2N1dERpcmVjdGlvbiA9PT0gOCA/ICdkb3QnIDogJ2Fycm93JztcbiAgICAgIGlmIChub3RlSW5mby5fdHlwZSA9PT0gMCkge1xuICAgICAgICBjb2xvciA9ICdyZWQnO1xuICAgICAgfSBlbHNlIGlmIChub3RlSW5mby5fdHlwZSA9PT0gMSkge1xuICAgICAgICBjb2xvciA9ICdibHVlJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHR5cGUgPSAnbWluZSc7XG4gICAgICAgIGNvbG9yID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBiZWF0RWwgPSB0aGlzLnJlcXVlc3RCZWF0KHR5cGUsIGNvbG9yKTtcbiAgICAgIGlmICghYmVhdEVsKSB7IHJldHVybjsgfVxuXG4gICAgICAvLyBBcHBseSBzd29yZCBvZmZzZXQuIEJsb2NrcyBhcnJpdmUgb24gYmVhdCBpbiBmcm9udCBvZiB0aGUgdXNlci5cbiAgICAgIGJlYXRPYmouYW50aWNpcGF0aW9uUG9zaXRpb24gPSAtZGF0YS5iZWF0QW50aWNpcGF0aW9uVGltZSAqIGRhdGEuYmVhdFNwZWVkIC0gdGhpcy5zd29yZE9mZnNldDtcbiAgICAgIGJlYXRPYmouY29sb3IgPSBjb2xvcjtcbiAgICAgIGJlYXRPYmouY3V0RGlyZWN0aW9uID0gdGhpcy5vcmllbnRhdGlvbnNIdW1hbml6ZWRbbm90ZUluZm8uX2N1dERpcmVjdGlvbl07XG4gICAgICBiZWF0T2JqLmhvcml6b250YWxQb3NpdGlvbiA9IHRoaXMuaG9yaXpvbnRhbFBvc2l0aW9uc0h1bWFuaXplZFtub3RlSW5mby5fbGluZUluZGV4XTtcbiAgICAgIGJlYXRPYmouc3BlZWQgPSB0aGlzLmRhdGEuYmVhdFNwZWVkO1xuICAgICAgYmVhdE9iai50eXBlID0gdHlwZTtcbiAgICAgIGJlYXRPYmoudmVydGljYWxQb3NpdGlvbiA9IHRoaXMudmVydGljYWxQb3NpdGlvbnNIdW1hbml6ZWRbbm90ZUluZm8uX2xpbmVMYXllcl0sXG4gICAgICBiZWF0T2JqLndhcm11cFBvc2l0aW9uID0gLWRhdGEuYmVhdFdhcm11cFRpbWUgKiBkYXRhLmJlYXRXYXJtdXBTcGVlZDtcbiAgICAgIGJlYXRFbC5zZXRBdHRyaWJ1dGUoJ2JlYXQnLCBiZWF0T2JqKTtcbiAgICAgIGJlYXRFbC5jb21wb25lbnRzLmJlYXQudXBkYXRlUG9zaXRpb24oKTtcblxuICAgICAgYmVhdEVsLnBsYXkoKTtcbiAgICAgIGJlYXRFbC5jb21wb25lbnRzLmJlYXQub25HZW5lcmF0ZSgpO1xuICAgIH07XG4gIH0pKCksXG5cbiAgZ2VuZXJhdGVXYWxsOiAoZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHdhbGxPYmogPSB7fTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAod2FsbEluZm8pIHtcbiAgICAgIGNvbnN0IGVsID0gdGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHMucG9vbF9fd2FsbC5yZXF1ZXN0RW50aXR5KCk7XG5cbiAgICAgIGlmICghZWwpIHsgcmV0dXJuOyB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgICBjb25zdCBzcGVlZCA9IHRoaXMuZGF0YS5iZWF0U3BlZWQ7XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uU2Vjb25kcyA9IDYwICogKHdhbGxJbmZvLl9kdXJhdGlvbiAvIHRoaXMuYnBtKTtcbiAgICAgIHdhbGxPYmouYW50aWNpcGF0aW9uUG9zaXRpb24gPVxuICAgICAgICAtZGF0YS5iZWF0QW50aWNpcGF0aW9uVGltZSAqIGRhdGEuYmVhdFNwZWVkIC0gdGhpcy5zd29yZE9mZnNldDtcbiAgICAgIHdhbGxPYmouZHVyYXRpb25TZWNvbmRzID0gZHVyYXRpb25TZWNvbmRzO1xuICAgICAgd2FsbE9iai5ob3Jpem9udGFsUG9zaXRpb24gPSB0aGlzLmhvcml6b250YWxQb3NpdGlvbnNIdW1hbml6ZWRbd2FsbEluZm8uX2xpbmVJbmRleF07XG4gICAgICB3YWxsT2JqLmlzQ2VpbGluZyA9IHdhbGxJbmZvLl90eXBlID09PSAxO1xuICAgICAgd2FsbE9iai5zcGVlZCA9IHNwZWVkO1xuICAgICAgd2FsbE9iai53YXJtdXBQb3NpdGlvbiA9IC1kYXRhLmJlYXRXYXJtdXBUaW1lICogZGF0YS5iZWF0V2FybXVwU3BlZWQ7XG4gICAgICB3YWxsT2JqLndpZHRoID0gd2FsbEluZm8uX3dpZHRoO1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCd3YWxsJywgd2FsbE9iaik7XG4gICAgICBlbC5wbGF5KCk7XG4gICAgfTtcbiAgfSkoKSxcblxuICBnZW5lcmF0ZUV2ZW50OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBzd2l0Y2goZXZlbnQuX3R5cGUpIHtcbiAgICAgIGNhc2UgMDpcbiAgICAgICAgdGhpcy5zdGFnZUNvbG9ycy5zZXRDb2xvcignYmcnLCBldmVudC5fdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgdGhpcy5zdGFnZUNvbG9ycy5zZXRDb2xvcigndHVubmVsJywgZXZlbnQuX3ZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIHRoaXMuc3RhZ2VDb2xvcnMuc2V0Q29sb3IoJ2xlZnRsYXNlcicsIGV2ZW50Ll92YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICB0aGlzLnN0YWdlQ29sb3JzLnNldENvbG9yKCdyaWdodGxhc2VyJywgZXZlbnQuX3ZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDQ6XG4gICAgICAgIHRoaXMuc3RhZ2VDb2xvcnMuc2V0Q29sb3IoJ2Zsb29yJywgZXZlbnQuX3ZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDg6XG4gICAgICAgIHRoaXMudHdpc3Rlci5jb21wb25lbnRzLnR3aXN0ZXIucHVsc2UoZXZlbnQuX3ZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDk6XG4gICAgICAgIC8vIHpvb20gd2FzIGEgYml0IGRpc3R1cmJpbmdcbiAgICAgICAgdGhpcy50d2lzdGVyLmNvbXBvbmVudHMudHdpc3Rlci5wdWxzZShldmVudC5fdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMTI6XG4gICAgICAgIHRoaXMubGVmdFN0YWdlTGFzZXJzLmNvbXBvbmVudHNbJ3N0YWdlLWxhc2VycyddLnB1bHNlKGV2ZW50Ll92YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxMzpcbiAgICAgICAgdGhpcy5yaWdodFN0YWdlTGFzZXJzLmNvbXBvbmVudHNbJ3N0YWdlLWxhc2VycyddLnB1bHNlKGV2ZW50Ll92YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfSxcblxuICByZXF1ZXN0QmVhdDogZnVuY3Rpb24gKHR5cGUsIGNvbG9yKSB7XG4gICAgdmFyIGJlYXRQb29sTmFtZSA9ICdwb29sX19iZWF0LScgKyB0eXBlO1xuICAgIHZhciBwb29sO1xuICAgIGlmIChjb2xvcikgeyBiZWF0UG9vbE5hbWUgKz0gJy0nICsgY29sb3I7IH1cbiAgICBwb29sID0gdGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHNbYmVhdFBvb2xOYW1lXTtcbiAgICBpZiAoIXBvb2wpIHtcbiAgICAgIGNvbnNvbGUud2FybignUG9vbCAnICsgYmVhdFBvb2xOYW1lICsgJyB1bmF2YWlsYWJsZScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gcG9vbC5yZXF1ZXN0RW50aXR5KCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJlc3RhcnQgYnkgcmV0dXJuaW5nIGFsbCBiZWF0cyB0byBwb29sLlxuICAgKi9cbiAgY2xlYXJCZWF0czogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmVhdHNQcmVsb2FkVGltZSA9IDA7XG4gICAgdGhpcy5iZWF0c1RpbWUgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5iZWF0Q29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgY2hpbGQgPSB0aGlzLmJlYXRDb250YWluZXIuY2hpbGRyZW5baV07XG4gICAgICBpZiAoY2hpbGQuY29tcG9uZW50cy5iZWF0KSB7XG4gICAgICAgIGNoaWxkLmNvbXBvbmVudHMuYmVhdC5yZXR1cm5Ub1Bvb2wodHJ1ZSk7XG4gICAgICB9XG4gICAgICBpZiAoY2hpbGQuY29tcG9uZW50cy53YWxsKSB7XG4gICAgICAgIGNoaWxkLmNvbXBvbmVudHMud2FsbC5yZXR1cm5Ub1Bvb2wodHJ1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9LFxufSk7XG5cbmZ1bmN0aW9uIGxlc3NUaGFuIChhLCBiKSB7IHJldHVybiBhLl90aW1lIC0gYi5fdGltZTsgfVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvYmVhdC1sb2FkZXIuanMiLCJpbXBvcnQge0JFQVRfV0FSTVVQX09GRlNFVCwgQkVBVF9XQVJNVVBfU1BFRUQsIEJFQVRfV0FSTVVQX1RJTUV9IGZyb20gJy4uL2NvbnN0YW50cy9iZWF0JztcbmNvbnN0IENPTE9SUyA9IHJlcXVpcmUoJy4uL2NvbnN0YW50cy9jb2xvcnMuanMnKTtcblxuY29uc3QgYXV4T2JqM0QgPSBuZXcgVEhSRUUuT2JqZWN0M0QoKTtcbmNvbnN0IGNvbGxpc2lvblpUaHJlc2hvbGQgPSAtMS42NTtcbmNvbnN0IEJFQVRfV0FSTVVQX1JPVEFUSU9OX0NIQU5HRSA9IE1hdGguUEkgLyA1O1xuY29uc3QgQkVBVF9XQVJNVVBfUk9UQVRJT05fT0ZGU0VUID0gMC40O1xuY29uc3QgQkVBVF9XQVJNVVBfUk9UQVRJT05fVElNRSA9IDc1MDtcbmNvbnN0IERFU1RST1lFRF9TUEVFRCA9IDEuMDtcbmNvbnN0IE9OQ0UgPSB7b25jZTogdHJ1ZX07XG5cbmNvbnN0IFNDT1JFX1BPT0wgPSB7XG4gIE9LIDogJ3Bvb2xfX2JlYXRzY29yZW9rJyxcbiAgR09PRCA6ICdwb29sX19iZWF0c2NvcmVnb29kJyxcbiAgR1JFQVQgOiAncG9vbF9fYmVhdHNjb3JlZ3JlYXQnLFxuICBTVVBFUiA6ICdwb29sX19iZWF0c2NvcmVzdXBlcidcbn07XG5cbi8qKlxuICogQmVhcnMsIGJlYXRzLCBCYXR0bGVzdGFyIEdhbGFjdGljYS5cbiAqIENyZWF0ZSBiZWF0IGZyb20gcG9vbCwgY29sbGlzaW9uIGRldGVjdGlvbiwgY2xpcHBpbmcgcGxhbmVzLCBtb3ZlbWVudCwgc2NvcmluZy5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdiZWF0Jywge1xuICBzY2hlbWE6IHtcbiAgICBhbnRpY2lwYXRpb25Qb3NpdGlvbjoge2RlZmF1bHQ6IDB9LFxuICAgIGNvbG9yOiB7ZGVmYXVsdDogJ3JlZCcsIG9uZU9mOiBbJ3JlZCcsICdibHVlJ119LFxuICAgIGN1dERpcmVjdGlvbjoge2RlZmF1bHQ6ICdkb3duJ30sXG4gICAgZGVidWc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaG9yaXpvbnRhbFBvc2l0aW9uOiB7ZGVmYXVsdDogJ21pZGRsZWxlZnQnLCBvbmVPZjogWydsZWZ0JywgJ21pZGRsZWxlZnQnLCAnbWlkZGxlcmlnaHQnLCAncmlnaHQnXX0sXG4gICAgc2l6ZToge2RlZmF1bHQ6IDAuNDB9LFxuICAgIHNwZWVkOiB7ZGVmYXVsdDogOC4wfSxcbiAgICB0eXBlOiB7ZGVmYXVsdDogJ2Fycm93Jywgb25lT2Y6IFsnYXJyb3cnLCAnZG90JywgJ21pbmUnXX0sXG4gICAgdmVydGljYWxQb3NpdGlvbjoge2RlZmF1bHQ6ICdtaWRkbGUnLCBvbmVPZjogWydib3R0b20nLCAnbWlkZGxlJywgJ3RvcCddfSxcbiAgICB3YXJtdXBQb3NpdGlvbjoge2RlZmF1bHQ6IDB9LFxuICB9LFxuXG4gIG1hdGVyaWFsQ29sb3I6IHtcbiAgICBibHVlOiBDT0xPUlMuQkVBVF9CTFVFLFxuICAgIHJlZDogQ09MT1JTLkJFQVRfUkVEXG4gIH0sXG5cbiAgY3V0Q29sb3I6IHtcbiAgICBibHVlOiAnI2ZmZicsXG4gICAgcmVkOiAnI2ZmZidcbiAgfSxcblxuICBtb2RlbHM6IHtcbiAgICBhcnJvdzogJ2JlYXRPYmpUZW1wbGF0ZScsXG4gICAgZG90OiAnYmVhdE9ialRlbXBsYXRlJyxcbiAgICBtaW5lOiAnbWluZU9ialRlbXBsYXRlJ1xuICB9LFxuXG4gIHNpZ25Nb2RlbHM6IHtcbiAgICBhcnJvd3JlZDogJ2Fycm93UmVkT2JqVGVtcGxhdGUnLFxuICAgIGFycm93Ymx1ZTogJ2Fycm93Qmx1ZU9ialRlbXBsYXRlJyxcbiAgICBkb3RyZWQ6ICdkb3RSZWRPYmpUZW1wbGF0ZScsXG4gICAgZG90Ymx1ZTogJ2RvdEJsdWVPYmpUZW1wbGF0ZSdcbiAgfSxcblxuICBvcmllbnRhdGlvbnM6IFsxODAsIDAsIDI3MCwgOTAsIDIyNSwgMTM1LCAzMTUsIDQ1LCAwXSxcblxuICByb3RhdGlvbnM6IHtcbiAgICB1cDogMTgwLFxuICAgIGRvd246IDAsXG4gICAgbGVmdDogMjcwLFxuICAgIHJpZ2h0OiA5MCxcbiAgICB1cGxlZnQ6IDIyNSxcbiAgICB1cHJpZ2h0OiAxMzUsXG4gICAgZG93bmxlZnQ6IDMxNSxcbiAgICBkb3ducmlnaHQ6IDQ1XG4gIH0sXG5cbiAgaG9yaXpvbnRhbFBvc2l0aW9uczoge1xuICAgIGxlZnQ6IC0wLjc1LFxuICAgIG1pZGRsZWxlZnQ6IC0wLjI1LFxuICAgIG1pZGRsZXJpZ2h0OiAwLjI1LFxuICAgIHJpZ2h0OiAwLjc1XG4gIH0sXG5cbiAgdmVydGljYWxQb3NpdGlvbnM6IHtcbiAgICBib3R0b206IDAuNzAsXG4gICAgbWlkZGxlOiAxLjIwLFxuICAgIHRvcDogMS43MFxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJhY2tUb1Bvb2wgPSBmYWxzZTtcbiAgICB0aGlzLmJlYW1zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JlYW1zJykuY29tcG9uZW50cy5iZWFtcztcbiAgICB0aGlzLmJlYXRCb3VuZGluZ0JveCA9IG5ldyBUSFJFRS5Cb3gzKCk7XG4gICAgdGhpcy5jdXJyZW50Um90YXRpb25XYXJtdXBUaW1lID0gMDtcbiAgICB0aGlzLmN1dERpcmVjdGlvbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5kZXN0cm95ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmdyYXZpdHlWZWxvY2l0eSA9IDA7XG4gICAgdGhpcy5oaXRFdmVudERldGFpbCA9IHt9O1xuICAgIHRoaXMuaGl0Qm91bmRpbmdCb3ggPSBuZXcgVEhSRUUuQm94MygpO1xuICAgIHRoaXMucG9vbE5hbWUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5yZXR1cm5Ub1Bvb2xUaW1lciA9IDgwMDtcbiAgICB0aGlzLnJvdGF0aW9uQXhpcyA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5zYWJlckVscyA9IHRoaXMuZWwuc2NlbmVFbC5xdWVyeVNlbGVjdG9yQWxsKCdbc2FiZXItY29udHJvbHNdJyk7XG4gICAgdGhpcy5zY29yZUVsID0gbnVsbDtcbiAgICB0aGlzLnNjb3JlRWxUaW1lID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc3RhcnRQb3NpdGlvblogPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzID0gW1xuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKCksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpXG4gICAgXTtcbiAgICB0aGlzLmxlZnRDdXRQbGFuZVBvaW50cyA9IFtcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKCksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKVxuICAgIF07XG5cbiAgICB0aGlzLm1pbmVQYXJ0aWNsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWluZVBhcnRpY2xlcycpO1xuICAgIHRoaXMud3JvbmdFbExlZnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3JvbmdMZWZ0Jyk7XG4gICAgdGhpcy53cm9uZ0VsUmlnaHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3JvbmdSaWdodCcpO1xuICAgIHRoaXMubWlzc0VsTGVmdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzTGVmdCcpO1xuICAgIHRoaXMubWlzc0VsUmlnaHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc1JpZ2h0Jyk7XG4gICAgdGhpcy5wYXJ0aWNsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2FiZXJQYXJ0aWNsZXMnKTtcbiAgICB0aGlzLm1pbmVQYXJ0aWNsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWluZVBhcnRpY2xlcycpO1xuXG4gICAgdGhpcy5zdXBlckN1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3VwZXJDdXRGeCcpO1xuICAgIHRoaXMuc3VwZXJDdXRJZHggPSAwO1xuXG4gICAgdGhpcy5leHBsb2RlRXZlbnREZXRhaWwgPSB7cG9zaXRpb246IG51bGwsIHJvdGF0aW9uOiBudWxsfTtcbiAgICB0aGlzLnNhYmVyQ29sb3JzID0ge3JpZ2h0OiAnYmx1ZScsIGxlZnQ6ICdyZWQnfTtcblxuICAgIHRoaXMub25FbmRTdHJva2UgPSB0aGlzLm9uRW5kU3Ryb2tlLmJpbmQodGhpcyk7XG5cbiAgICB0aGlzLmluaXRCbG9jaygpO1xuICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PT0gJ21pbmUnKSB7XG4gICAgICB0aGlzLmluaXRNaW5lRnJhZ21lbnRzKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaW5pdEZyYWdtZW50cygpO1xuICAgIH07XG4gIH0sXG5cbiAgdXBkYXRlUG9zaXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGVsLm9iamVjdDNELnBvc2l0aW9uLnNldChcbiAgICAgIHRoaXMuaG9yaXpvbnRhbFBvc2l0aW9uc1tkYXRhLmhvcml6b250YWxQb3NpdGlvbl0sXG4gICAgICB0aGlzLnZlcnRpY2FsUG9zaXRpb25zW2RhdGEudmVydGljYWxQb3NpdGlvbl0sXG4gICAgICBkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uICsgZGF0YS53YXJtdXBQb3NpdGlvblxuICAgICk7XG5cbiAgICBlbC5vYmplY3QzRC5yb3RhdGlvbi56ID0gVEhSRUUuTWF0aC5kZWdUb1JhZCh0aGlzLnJvdGF0aW9uc1tkYXRhLmN1dERpcmVjdGlvbl0pO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMudXBkYXRlUG9zaXRpb24oKTtcbiAgICB0aGlzLnVwZGF0ZUJsb2NrKCk7XG4gICAgdGhpcy51cGRhdGVGcmFnbWVudHMoKTtcblxuICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PT0gJ21pbmUnKSB7XG4gICAgICB0aGlzLnBvb2xOYW1lID0gYHBvb2xfX2JlYXQtbWluZWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucG9vbE5hbWUgPSBgcG9vbF9fYmVhdC0ke3RoaXMuZGF0YS50eXBlfS0ke3RoaXMuZGF0YS5jb2xvcn1gO1xuICAgIH1cbiAgfSxcblxuICBwYXVzZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgIGlmICh0aGlzLmRhdGEudHlwZSAhPT0gJ21pbmUnKSB7XG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgdGhpcy5wYXJ0UmlnaHRFbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgfVxuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJsb2NrRWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy5kZXN0cm95ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICB9LFxuXG4gIHRvY2s6IGZ1bmN0aW9uICh0aW1lLCB0aW1lRGVsdGEpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBjb25zdCBwb3NpdGlvbiA9IGVsLm9iamVjdDNELnBvc2l0aW9uO1xuICAgIGNvbnN0IHJvdGF0aW9uID0gZWwub2JqZWN0M0Qucm90YXRpb247XG5cbiAgICBpZiAodGhpcy5kZXN0cm95ZWQpIHtcbiAgICAgIHRoaXMudG9ja0Rlc3Ryb3llZCh0aW1lRGVsdGEpO1xuICAgICAgLy8gQ2hlY2sgdG8gcmVtb3ZlIHNjb3JlIGVudGl0eSBmcm9tIHBvb2wuXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE9ubHkgY2hlY2sgY29sbGlzaW9ucyB3aGVuIGNsb3NlLlxuICAgICAgaWYgKHBvc2l0aW9uLnogPiBjb2xsaXNpb25aVGhyZXNob2xkKSB7IHRoaXMuY2hlY2tDb2xsaXNpb25zKCk7IH1cblxuICAgICAgLy8gTW92ZS5cbiAgICAgIGlmIChwb3NpdGlvbi56IDwgZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbikge1xuICAgICAgICBsZXQgbmV3UG9zaXRpb25aID0gcG9zaXRpb24ueiArIEJFQVRfV0FSTVVQX1NQRUVEICogKHRpbWVEZWx0YSAvIDEwMDApO1xuICAgICAgICAvLyBXYXJtIHVwIC8gd2FycCBpbi5cbiAgICAgICAgaWYgKG5ld1Bvc2l0aW9uWiA8IGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb24pIHtcbiAgICAgICAgICBwb3NpdGlvbi56ID0gbmV3UG9zaXRpb25aO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBvc2l0aW9uLnogPSBkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uO1xuICAgICAgICAgIHRoaXMuYmVhbXMubmV3QmVhbSh0aGlzLmRhdGEuY29sb3IsIHBvc2l0aW9uKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gU3RhbmRhcmQgbW92aW5nLlxuICAgICAgICBwb3NpdGlvbi56ICs9IHRoaXMuZGF0YS5zcGVlZCAqICh0aW1lRGVsdGEgLyAxMDAwKTtcbiAgICAgICAgcm90YXRpb24ueiA9IHRoaXMuc3RhcnRSb3RhdGlvblo7XG4gICAgICB9XG5cbiAgICAgIGlmIChwb3NpdGlvbi56ID4gKGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb24gLSBCRUFUX1dBUk1VUF9ST1RBVElPTl9PRkZTRVQpICYmXG4gICAgICAgICAgdGhpcy5jdXJyZW50Um90YXRpb25XYXJtdXBUaW1lIDwgQkVBVF9XQVJNVVBfUk9UQVRJT05fVElNRSkge1xuICAgICAgICBjb25zdCBwcm9ncmVzcyA9IEFGUkFNRS5BTklNRS5lYXNpbmdzLmVhc2VPdXRCYWNrKFxuICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uV2FybXVwVGltZSAvIEJFQVRfV0FSTVVQX1JPVEFUSU9OX1RJTUUpO1xuICAgICAgICBlbC5vYmplY3QzRC5yb3RhdGlvbi56ID0gdGhpcy5yb3RhdGlvblpTdGFydCArIChwcm9ncmVzcyAqIHRoaXMucm90YXRpb25aQ2hhbmdlKTtcbiAgICAgICAgdGhpcy5jdXJyZW50Um90YXRpb25XYXJtdXBUaW1lICs9IHRpbWVEZWx0YTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2suXG4gICAgICB0aGlzLmJhY2tUb1Bvb2wgPSBwb3NpdGlvbi56ID49IDI7XG4gICAgICBpZiAodGhpcy5iYWNrVG9Qb29sKSB7IHRoaXMubWlzc0hpdCgpOyB9XG4gICAgfVxuICAgIHRoaXMucmV0dXJuVG9Qb29sKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHN1bW1vbmVkIGJ5IGJlYXQtbG9hZGVyLlxuICAgKi9cbiAgb25HZW5lcmF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc3RhcnRSb3RhdGlvblogPSB0aGlzLmVsLm9iamVjdDNELnJvdGF0aW9uLno7XG5cbiAgICAvLyBTZXQgdXAgcm90YXRpb24gd2FybXVwLlxuICAgIHRoaXMuY3VycmVudFJvdGF0aW9uV2FybXVwVGltZSA9IDA7XG4gICAgdGhpcy5yb3RhdGlvblpDaGFuZ2UgPSBCRUFUX1dBUk1VUF9ST1RBVElPTl9DSEFOR0U7XG4gICAgaWYgKE1hdGgucmFuZG9tID4gMC41KSB7IHRoaXMucm90YXRpb25aQ2hhbmdlICo9IC0xOyB9XG4gICAgdGhpcy5lbC5vYmplY3QzRC5yb3RhdGlvbi56IC09IHRoaXMucm90YXRpb25aQ2hhbmdlO1xuICAgIHRoaXMucm90YXRpb25aU3RhcnQgPSB0aGlzLmVsLm9iamVjdDNELnJvdGF0aW9uLno7XG4gICAgLy8gUmVzZXQgbWluZS5cbiAgICBpZiAodGhpcy5kYXRhLnR5cGUgPT0gJ21pbmUnKSB7IHRoaXMucmVzZXRNaW5lRnJhZ21lbnRzKCk7IH1cbiAgfSxcblxuICBpbml0QmxvY2s6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBibG9ja0VsID0gdGhpcy5ibG9ja0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICB2YXIgc2lnbkVsID0gdGhpcy5zaWduRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuXG4gICAgYmxvY2tFbC5zZXRBdHRyaWJ1dGUoJ21peGluJywgJ2JlYXRCbG9jaycpO1xuICAgIGJsb2NrRWwuc2V0QXR0cmlidXRlKCdtaXhpbicsICdiZWF0U2lnbicpO1xuXG4gICAgLy8gU21hbGwgb2Zmc2V0IHRvIHByZXZlbnQgei1maWdodGluZyB3aGVuIHRoZSBibG9ja3MgYXJlIGZhciBhd2F5XG4gICAgc2lnbkVsLm9iamVjdDNELnBvc2l0aW9uLnogKz0gMC4wMjtcbiAgICBibG9ja0VsLmFwcGVuZENoaWxkKHNpZ25FbCk7XG4gICAgZWwuYXBwZW5kQ2hpbGQoYmxvY2tFbCk7XG4gIH0sXG5cbiAgdXBkYXRlQmxvY2s6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBibG9ja0VsID0gdGhpcy5ibG9ja0VsO1xuICAgIGNvbnN0IHNpZ25FbCA9IHRoaXMuc2lnbkVsO1xuICAgIGlmICghYmxvY2tFbCkgeyByZXR1cm47IH1cblxuICAgIGJsb2NrRWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHtcbiAgICAgIG1ldGFsbmVzczogMC43LFxuICAgICAgcm91Z2huZXNzOiAwLjEsXG4gICAgICBzcGhlcmljYWxFbnZNYXA6ICcjZW52bWFwVGV4dHVyZScsXG4gICAgICBlbWlzc2l2ZTogdGhpcy5tYXRlcmlhbENvbG9yW3RoaXMuZGF0YS5jb2xvcl0sXG4gICAgICBlbWlzc2l2ZUludGVuc2l0eTogMC4wNSxcbiAgICAgIGNvbG9yOiB0aGlzLm1hdGVyaWFsQ29sb3JbdGhpcy5kYXRhLmNvbG9yXVxuICAgIH0pO1xuICAgIHRoaXMuc2V0T2JqTW9kZWxGcm9tVGVtcGxhdGUoYmxvY2tFbCwgdGhpcy5tb2RlbHNbdGhpcy5kYXRhLnR5cGVdKTtcblxuICAgIC8vIE1vZGVsIGlzIDAuMjkgc2l6ZS4gV2UgbWFrZSBpdCAxLjAgc28gd2UgY2FuIGVhc2lseSBzY2FsZSBiYXNlZCBvbiAxbSBzaXplLlxuICAgIGJsb2NrRWwub2JqZWN0M0Quc2NhbGUuc2V0KDEsIDEsIDEpO1xuICAgIGJsb2NrRWwub2JqZWN0M0Quc2NhbGUubXVsdGlwbHlTY2FsYXIoMy40NSkubXVsdGlwbHlTY2FsYXIodGhpcy5kYXRhLnNpemUpO1xuXG4gICAgaWYgKHRoaXMuZGF0YS50eXBlID09PSAnbWluZScpIHtcbiAgICAgIGNvbnN0IG1vZGVsID0gYmxvY2tFbC5nZXRPYmplY3QzRCgnbWVzaCcpO1xuICAgICAgaWYgKG1vZGVsKSB7XG4gICAgICAgIG1vZGVsLm1hdGVyaWFsID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMubWF0ZXJpYWxzWydtaW5lTWF0ZXJpYWwnICsgdGhpcy5kYXRhLmNvbG9yXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJsb2NrRWwuYWRkRXZlbnRMaXN0ZW5lcignbW9kZWwtbG9hZGVkJywgKCkgPT4ge1xuICAgICAgICAgIG1vZGVsLm1hdGVyaWFsID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMubWF0ZXJpYWxzWydtaW5lTWF0ZXJpYWwnICsgdGhpcy5kYXRhLmNvbG9yXTtcbiAgICAgICAgfSwgT05DRSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHNpZ25FbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFscycsIHtuYW1lOiAnc3RhZ2VBZGRpdGl2ZSd9KTtcbiAgICAgIHRoaXMuc2V0T2JqTW9kZWxGcm9tVGVtcGxhdGUoc2lnbkVsLCB0aGlzLnNpZ25Nb2RlbHNbdGhpcy5kYXRhLnR5cGUgKyB0aGlzLmRhdGEuY29sb3JdKTtcbiAgICB9XG4gIH0sXG5cbiAgaW5pdEZyYWdtZW50czogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjdXRFbDtcbiAgICB2YXIgcGFydEVsO1xuXG4gICAgcGFydEVsID0gdGhpcy5wYXJ0TGVmdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICBjdXRFbCA9IHRoaXMuY3V0TGVmdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcblxuICAgIHBhcnRFbC5hcHBlbmRDaGlsZChjdXRFbCk7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZChwYXJ0RWwpO1xuXG4gICAgcGFydEVsID0gdGhpcy5wYXJ0UmlnaHRFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG4gICAgY3V0RWwgPSB0aGlzLmN1dFJpZ2h0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuXG4gICAgcGFydEVsLmFwcGVuZENoaWxkKGN1dEVsKTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHBhcnRFbCk7XG5cbiAgICB0aGlzLmluaXRDdXR0aW5nQ2xpcHBpbmdQbGFuZXMoKTtcbiAgfSxcblxuICBpbml0TWluZUZyYWdtZW50czogZnVuY3Rpb24gKCkge1xuICAgIHZhciBmcmFnbWVudDtcbiAgICB2YXIgZnJhZ21lbnRzID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXNbJ21pbmUtZnJhZ21lbnRzLWxvYWRlciddLmZyYWdtZW50cy5jaGlsZHJlbjtcbiAgICB2YXIgbWF0ZXJpYWwgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbHNbJ21pbmVNYXRlcmlhbCcgKyB0aGlzLmRhdGEuY29sb3JdO1xuXG4gICAgdGhpcy5yYW5kVmVjID0gbmV3IFRIUkVFLlZlY3RvcjMoXG4gICAgICBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSxcbiAgICAgIE1hdGgucmFuZG9tKCkgKiBNYXRoLlBJLFxuICAgICAgTWF0aC5yYW5kb20oKSAqIE1hdGguUEkpO1xuXG4gICAgdGhpcy5taW5lRnJhZ21lbnRzID0gW107XG4gICAgdGhpcy5taW5lQnJva2VuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMubWluZUJyb2tlbik7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZyYWdtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgZnJhZ21lbnQgPSBuZXcgVEhSRUUuTWVzaChmcmFnbWVudHNbaV0uZ2VvbWV0cnksIG1hdGVyaWFsKTtcbiAgICAgIGZyYWdtZW50LnNwZWVkID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICAgIGZyYWdtZW50LnNwZWVkLnNldChNYXRoLnJhbmRvbSgpIC0gMC41LCBNYXRoLnJhbmRvbSgpIC0gMC41LCBNYXRoLnJhbmRvbSgpIC0gMC41KTtcbiAgICAgIHRoaXMubWluZUZyYWdtZW50cy5wdXNoKGZyYWdtZW50KTtcbiAgICAgIHRoaXMubWluZUJyb2tlbi5vYmplY3QzRC5hZGQoZnJhZ21lbnQpO1xuICAgIH1cbiAgfSxcblxuICB1cGRhdGVGcmFnbWVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY3V0TGVmdEVsID0gdGhpcy5jdXRMZWZ0RWw7XG4gICAgdmFyIGN1dFJpZ2h0RWwgPSB0aGlzLmN1dFJpZ2h0RWw7XG4gICAgdmFyIHBhcnRMZWZ0RWwgPSB0aGlzLnBhcnRMZWZ0RWw7XG4gICAgdmFyIHBhcnRSaWdodEVsID0gdGhpcy5wYXJ0UmlnaHRFbDtcbiAgICB2YXIgZnJhZ21lbnQ7XG4gICAgaWYgKCFwYXJ0TGVmdEVsKSB7IHJldHVybjsgfVxuICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PT0gJ21pbmUnKSB7XG4gICAgICB0aGlzLnJlc2V0TWluZUZyYWdtZW50cygpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHBhcnRMZWZ0RWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHtcbiAgICAgIG1ldGFsbmVzczogMC43LFxuICAgICAgcm91Z2huZXNzOiAwLjEsXG4gICAgICBzcGhlcmljYWxFbnZNYXA6ICcjZW52bWFwVGV4dHVyZScsXG4gICAgICBlbWlzc2l2ZTogdGhpcy5tYXRlcmlhbENvbG9yW3RoaXMuZGF0YS5jb2xvcl0sXG4gICAgICBlbWlzc2l2ZUludGVuc2l0eTogMC4wNSxcbiAgICAgIGNvbG9yOiB0aGlzLm1hdGVyaWFsQ29sb3JbdGhpcy5kYXRhLmNvbG9yXSxcbiAgICAgIHNpZGU6ICdkb3VibGUnXG4gICAgfSk7XG4gICAgdGhpcy5zZXRPYmpNb2RlbEZyb21UZW1wbGF0ZShwYXJ0TGVmdEVsLCB0aGlzLm1vZGVscy5kb3QpO1xuICAgIHBhcnRMZWZ0RWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgY3V0TGVmdEVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB7XG4gICAgICBzaGFkZXI6ICdmbGF0JyxcbiAgICAgIGNvbG9yOiB0aGlzLmRhdGEuY3V0Q29sb3IsXG4gICAgICBzaWRlOiAnZG91YmxlJ1xuICAgIH0pO1xuICAgIHRoaXMuc2V0T2JqTW9kZWxGcm9tVGVtcGxhdGUoY3V0TGVmdEVsLCB0aGlzLm1vZGVscy5kb3QpO1xuXG4gICAgcGFydFJpZ2h0RWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHtcbiAgICAgIG1ldGFsbmVzczogMC43LFxuICAgICAgcm91Z2huZXNzOiAwLjEsXG4gICAgICBzcGhlcmljYWxFbnZNYXA6ICcjZW52bWFwVGV4dHVyZScsXG4gICAgICBlbWlzc2l2ZTogdGhpcy5tYXRlcmlhbENvbG9yW3RoaXMuZGF0YS5jb2xvcl0sXG4gICAgICBlbWlzc2l2ZUludGVuc2l0eTogMC4wNSxcbiAgICAgIGNvbG9yOiB0aGlzLm1hdGVyaWFsQ29sb3JbdGhpcy5kYXRhLmNvbG9yXSxcbiAgICAgIHNpZGU6ICdkb3VibGUnXG4gICAgfSk7XG4gICAgdGhpcy5zZXRPYmpNb2RlbEZyb21UZW1wbGF0ZShwYXJ0UmlnaHRFbCwgdGhpcy5tb2RlbHMuZG90KTtcbiAgICBwYXJ0UmlnaHRFbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG5cbiAgICBjdXRSaWdodEVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB7XG4gICAgICBzaGFkZXI6ICdmbGF0JyxcbiAgICAgIGNvbG9yOiB0aGlzLmRhdGEuY3V0Q29sb3IsXG4gICAgICBzaWRlOiAnZG91YmxlJ1xuICAgIH0pO1xuICAgIHRoaXMuc2V0T2JqTW9kZWxGcm9tVGVtcGxhdGUoY3V0UmlnaHRFbCwgdGhpcy5tb2RlbHMuZG90KTtcbiAgfSxcblxuICByZXNldE1pbmVGcmFnbWVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kYXRhLnR5cGUgIT09ICdtaW5lJykgeyByZXR1cm47IH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubWluZUZyYWdtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGZyYWdtZW50ID0gdGhpcy5taW5lRnJhZ21lbnRzW2ldO1xuICAgICAgZnJhZ21lbnQudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgZnJhZ21lbnQucG9zaXRpb24uc2V0KDAsIDAsIDApO1xuICAgICAgZnJhZ21lbnQuc2NhbGUuc2V0KDEsIDEsIDEpO1xuICAgICAgZnJhZ21lbnQuc3BlZWQuc2V0KFxuICAgICAgICBNYXRoLnJhbmRvbSgpICogNSAtIDIuNSxcbiAgICAgICAgTWF0aC5yYW5kb20oKSAqIDUgLSAyLjUsXG4gICAgICAgIE1hdGgucmFuZG9tKCkgKiA1IC0gMi41KTtcbiAgICB9XG4gIH0sXG5cbiAgd3JvbmdIaXQ6IGZ1bmN0aW9uIChoYW5kKSB7XG4gICAgdmFyIHdyb25nRWwgPSBoYW5kID09PSAnbGVmdCcgPyB0aGlzLndyb25nRWxMZWZ0IDogdGhpcy53cm9uZ0VsUmlnaHQ7XG4gICAgaWYgKCF3cm9uZ0VsKSB7IHJldHVybjsgfVxuICAgIHdyb25nRWwub2JqZWN0M0QucG9zaXRpb24uY29weSh0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uKTtcbiAgICB3cm9uZ0VsLm9iamVjdDNELnBvc2l0aW9uLnkgKz0gMC4yO1xuICAgIHdyb25nRWwub2JqZWN0M0QucG9zaXRpb24ueiAtPSAwLjU7XG4gICAgd3JvbmdFbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICB3cm9uZ0VsLmVtaXQoJ2JlYXR3cm9uZycsIG51bGwsIHRydWUpO1xuICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcbiAgfSxcblxuICBtaXNzSGl0OiBmdW5jdGlvbiAoaGFuZCkge1xuICAgIHZhciBtaXNzRWwgPSBoYW5kID09PSAnbGVmdCcgPyB0aGlzLm1pc3NFbExlZnQgOiB0aGlzLm1pc3NFbFJpZ2h0O1xuICAgIGlmICghbWlzc0VsIHx8IHRoaXMuZGF0YS50eXBlID09PSAnbWluZScpIHsgcmV0dXJuOyB9XG4gICAgbWlzc0VsLm9iamVjdDNELnBvc2l0aW9uLmNvcHkodGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbik7XG4gICAgbWlzc0VsLm9iamVjdDNELnBvc2l0aW9uLnkgKz0gMC4yO1xuICAgIG1pc3NFbC5vYmplY3QzRC5wb3NpdGlvbi56IC09IDAuNTtcbiAgICBtaXNzRWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgbWlzc0VsLmVtaXQoJ2JlYXRtaXNzJywgbnVsbCwgdHJ1ZSk7XG4gICAgaWYgKEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ3N5bmN0ZXN0JykpIHtcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzLnNvbmcuZ2V0Q3VycmVudFRpbWUoKSk7XG4gICAgfVxuICB9LFxuXG4gIGRlc3Ryb3lCZWF0OiAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBwYXJhbGxlbFBsYW5lTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xuICAgICAgY29sb3I6ICcjMDAwMDhiJyxcbiAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGVcbiAgICB9KTtcbiAgICB2YXIgcGxhbmVNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7Y29sb3I6ICdncmV5Jywgc2lkZTogVEhSRUUuRG91YmxlU2lkZX0pO1xuICAgIHZhciBwb2ludDEgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHZhciBwb2ludDIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHZhciBwb2ludDMgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzYWJlckVsKSB7XG4gICAgICB2YXIgY29wbGFuYXJQb2ludDtcbiAgICAgIHZhciBjdXRUaGlja25lc3MgPSB0aGlzLmN1dFRoaWNrbmVzcyA9IDAuMDI7XG4gICAgICB2YXIgZGlyZWN0aW9uID0gdGhpcy5jdXREaXJlY3Rpb247XG4gICAgICB2YXIgbGVmdEJvcmRlcklubmVyUGxhbmUgPSB0aGlzLmxlZnRCb3JkZXJJbm5lclBsYW5lO1xuICAgICAgdmFyIGxlZnRCb3JkZXJPdXRlclBsYW5lID0gdGhpcy5sZWZ0Qm9yZGVyT3V0ZXJQbGFuZTtcbiAgICAgIHZhciBsZWZ0Q3V0UGxhbmUgPSB0aGlzLmxlZnRDdXRQbGFuZTtcbiAgICAgIHZhciBwbGFuZUdlb21ldHJ5O1xuICAgICAgdmFyIHBsYW5lTWVzaDtcbiAgICAgIHZhciByaWdodEJvcmRlcklubmVyUGxhbmUgPSB0aGlzLnJpZ2h0Qm9yZGVySW5uZXJQbGFuZTtcbiAgICAgIHZhciByaWdodEJvcmRlck91dGVyUGxhbmUgPSB0aGlzLnJpZ2h0Qm9yZGVyT3V0ZXJQbGFuZTtcbiAgICAgIHZhciByaWdodEN1dFBsYW5lID0gdGhpcy5yaWdodEN1dFBsYW5lO1xuICAgICAgdmFyIHRyYWlsUG9pbnRzID0gc2FiZXJFbC5jb21wb25lbnRzLnRyYWlsLnNhYmVyVHJhamVjdG9yeTtcblxuICAgICAgcG9pbnQxLmNvcHkodHJhaWxQb2ludHNbMF0udG9wKTtcbiAgICAgIHBvaW50Mi5jb3B5KHRyYWlsUG9pbnRzWzBdLmNlbnRlcik7XG4gICAgICBwb2ludDMuY29weSh0cmFpbFBvaW50c1t0cmFpbFBvaW50cy5sZW5ndGggLSAxXS50b3ApO1xuICAgICAgZGlyZWN0aW9uLmNvcHkocG9pbnQxKS5zdWIocG9pbnQzKTtcblxuICAgICAgdGhpcy5wYXJ0UmlnaHRFbC5vYmplY3QzRC5wb3NpdGlvbi5zZXQoMCwgMCwgMCk7XG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELnJvdGF0aW9uLnNldCgwLCAwLCAwKTtcbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0QudXBkYXRlTWF0cml4V29ybGQoKTtcblxuICAgICAgdGhpcy5wYXJ0UmlnaHRFbC5vYmplY3QzRC53b3JsZFRvTG9jYWwodGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzWzBdLmNvcHkocG9pbnQxKSk7XG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELndvcmxkVG9Mb2NhbCh0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNbMV0uY29weShwb2ludDIpKTtcbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0Qud29ybGRUb0xvY2FsKHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1syXS5jb3B5KHBvaW50MykpO1xuXG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0QucG9zaXRpb24uc2V0KDAsIDAsIDApO1xuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELnJvdGF0aW9uLnNldCgwLCAwLCAwKTtcbiAgICAgIHRoaXMucGFydExlZnRFbC5vYmplY3QzRC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuXG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0Qud29ybGRUb0xvY2FsKHRoaXMubGVmdEN1dFBsYW5lUG9pbnRzWzBdLmNvcHkocG9pbnQzKSk7XG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0Qud29ybGRUb0xvY2FsKHRoaXMubGVmdEN1dFBsYW5lUG9pbnRzWzFdLmNvcHkocG9pbnQyKSk7XG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0Qud29ybGRUb0xvY2FsKHRoaXMubGVmdEN1dFBsYW5lUG9pbnRzWzJdLmNvcHkocG9pbnQxKSk7XG5cbiAgICAgIHRoaXMuZ2VuZXJhdGVDdXRDbGlwcGluZ1BsYW5lcygpO1xuXG4gICAgICBpZiAodGhpcy5kYXRhLmRlYnVnKSB7XG4gICAgICAgIGNvcGxhbmFyUG9pbnQgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgICAgICBwbGFuZUdlb21ldHJ5ID0gbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoNC4wLCA0LjAsIDEuMCwgMS4wKTtcblxuICAgICAgICByaWdodEN1dFBsYW5lLmNvcGxhbmFyUG9pbnQoY29wbGFuYXJQb2ludCk7XG4gICAgICAgIHBsYW5lR2VvbWV0cnkubG9va0F0KHJpZ2h0Q3V0UGxhbmUubm9ybWFsKTtcbiAgICAgICAgcGxhbmVHZW9tZXRyeS50cmFuc2xhdGUoY29wbGFuYXJQb2ludC54LCBjb3BsYW5hclBvaW50LnksIGNvcGxhbmFyUG9pbnQueik7XG5cbiAgICAgICAgcGxhbmVNZXNoID0gbmV3IFRIUkVFLk1lc2gocGxhbmVHZW9tZXRyeSwgcGxhbmVNYXRlcmlhbCk7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5zZXRPYmplY3QzRCgncmlnaHRDdXRQbGFuZScsIHBsYW5lTWVzaCk7XG5cbiAgICAgICAgcGxhbmVHZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KDQuMCwgNC4wLCAxLjAsIDEuMCk7XG5cbiAgICAgICAgcmlnaHRCb3JkZXJPdXRlclBsYW5lLmNvcGxhbmFyUG9pbnQoY29wbGFuYXJQb2ludCk7XG4gICAgICAgIHBsYW5lR2VvbWV0cnkubG9va0F0KHJpZ2h0Qm9yZGVyT3V0ZXJQbGFuZS5ub3JtYWwpO1xuICAgICAgICBwbGFuZUdlb21ldHJ5LnRyYW5zbGF0ZShjb3BsYW5hclBvaW50LngsIGNvcGxhbmFyUG9pbnQueSwgY29wbGFuYXJQb2ludC56KTtcblxuICAgICAgICBjb25zdCBwYXJhbGxlbFBsYW5lTWVzaCA9IG5ldyBUSFJFRS5NZXNoKHBsYW5lR2VvbWV0cnksIHBhcmFsbGVsUGxhbmVNYXRlcmlhbCk7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5zZXRPYmplY3QzRCgncGxhbmVQYXJhbGxlbCcsIHBhcmFsbGVsUGxhbmVNZXNoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5ibG9ja0VsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcblxuICAgICAgY29uc3QgcGFydFJpZ2h0TWF0ZXJpYWwgPSB0aGlzLnBhcnRSaWdodEVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWw7XG4gICAgICBwYXJ0UmlnaHRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcyA9IHBhcnRSaWdodE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzIHx8IFtdO1xuICAgICAgcGFydFJpZ2h0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMubGVuZ3RoID0gMDtcbiAgICAgIHBhcnRSaWdodE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLnB1c2gocmlnaHRDdXRQbGFuZSk7XG5cbiAgICAgIGNvbnN0IGN1dFJpZ2h0TWF0ZXJpYWwgPSB0aGlzLmN1dFJpZ2h0RWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbDtcbiAgICAgIGN1dFJpZ2h0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMgPSBjdXRSaWdodE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzIHx8IFtdO1xuICAgICAgY3V0UmlnaHRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5sZW5ndGggPSAwO1xuICAgICAgY3V0UmlnaHRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5wdXNoKHJpZ2h0Qm9yZGVyT3V0ZXJQbGFuZSk7XG4gICAgICBjdXRSaWdodE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLnB1c2gocmlnaHRCb3JkZXJJbm5lclBsYW5lKTtcblxuICAgICAgY29uc3QgcGFydExlZnRNYXRlcmlhbCA9IHRoaXMucGFydExlZnRFbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsO1xuICAgICAgcGFydExlZnRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcyA9IHBhcnRMZWZ0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMgfHwgW107XG4gICAgICBwYXJ0TGVmdE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLmxlbmd0aCA9IDA7XG4gICAgICBwYXJ0TGVmdE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLnB1c2gobGVmdEN1dFBsYW5lKTtcblxuICAgICAgY29uc3QgY3V0TGVmdE1hdGVyaWFsID0gdGhpcy5jdXRMZWZ0RWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbDtcbiAgICAgIGN1dExlZnRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcyA9IGN1dExlZnRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcyB8fCBbXTtcbiAgICAgIGN1dExlZnRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5sZW5ndGggPSAwO1xuICAgICAgY3V0TGVmdE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLnB1c2gobGVmdEJvcmRlcklubmVyUGxhbmUpO1xuICAgICAgY3V0TGVmdE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLnB1c2gobGVmdEJvcmRlck91dGVyUGxhbmUpO1xuXG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuXG4gICAgICB0aGlzLmVsLnNjZW5lRWwucmVuZGVyZXIubG9jYWxDbGlwcGluZ0VuYWJsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgdGhpcy5ncmF2aXR5VmVsb2NpdHkgPSAwLjE7XG5cbiAgICAgIHRoaXMucm90YXRpb25BeGlzLmNvcHkodGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzWzBdKS5zdWIodGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzWzFdKTtcblxuICAgICAgdGhpcy5yZXR1cm5Ub1Bvb2xUaW1lciA9IDgwMDtcblxuICAgICAgYXV4T2JqM0QudXAuY29weShyaWdodEN1dFBsYW5lLm5vcm1hbCk7XG4gICAgICBhdXhPYmozRC5sb29rQXQoZGlyZWN0aW9uKTtcbiAgICAgIHRoaXMuZXhwbG9kZUV2ZW50RGV0YWlsLnBvc2l0aW9uID0gdGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbjtcbiAgICAgIHRoaXMuZXhwbG9kZUV2ZW50RGV0YWlsLnJvdGF0aW9uID0gYXV4T2JqM0Qucm90YXRpb247XG4gICAgICB0aGlzLnBhcnRpY2xlcy5lbWl0KCdleHBsb2RlJywgdGhpcy5leHBsb2RlRXZlbnREZXRhaWwsIGZhbHNlKTtcbiAgICB9O1xuICB9KSgpLFxuXG4gIGRlc3Ryb3lNaW5lOiBmdW5jdGlvbiAoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1pbmVGcmFnbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMubWluZUZyYWdtZW50c1tpXS52aXNpYmxlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB0aGlzLmJsb2NrRWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcbiAgICB0aGlzLmdyYXZpdHlWZWxvY2l0eSA9IDAuMTtcbiAgICB0aGlzLnJldHVyblRvUG9vbFRpbWVyID0gODAwO1xuXG4gICAgdGhpcy5leHBsb2RlRXZlbnREZXRhaWwucG9zaXRpb24gPSB0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uO1xuICAgIHRoaXMuZXhwbG9kZUV2ZW50RGV0YWlsLnJvdGF0aW9uID0gdGhpcy5yYW5kVmVjO1xuICAgIHRoaXMubWluZVBhcnRpY2xlcy5lbWl0KCdleHBsb2RlJywgdGhpcy5leHBsb2RlRXZlbnREZXRhaWwsIGZhbHNlKTtcbiAgfSxcblxuICBpbml0Q3V0dGluZ0NsaXBwaW5nUGxhbmVzOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5sZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZCA9IFtcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKCksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKVxuICAgIF07XG4gICAgdGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzV29ybGQgPSBbXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKClcbiAgICBdO1xuXG4gICAgdGhpcy5yaWdodEN1dFBsYW5lID0gbmV3IFRIUkVFLlBsYW5lKCk7XG4gICAgdGhpcy5yaWdodEJvcmRlck91dGVyUGxhbmUgPSBuZXcgVEhSRUUuUGxhbmUoKTtcbiAgICB0aGlzLnJpZ2h0Qm9yZGVySW5uZXJQbGFuZSA9IG5ldyBUSFJFRS5QbGFuZSgpO1xuXG4gICAgdGhpcy5sZWZ0Q3V0UGxhbmUgPSBuZXcgVEhSRUUuUGxhbmUoKTtcbiAgICB0aGlzLmxlZnRCb3JkZXJPdXRlclBsYW5lID0gbmV3IFRIUkVFLlBsYW5lKCk7XG4gICAgdGhpcy5sZWZ0Qm9yZGVySW5uZXJQbGFuZSA9IG5ldyBUSFJFRS5QbGFuZSgpO1xuICB9LFxuXG4gIGdlbmVyYXRlQ3V0Q2xpcHBpbmdQbGFuZXM6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVmdEJvcmRlcklubmVyUGxhbmUgPSB0aGlzLmxlZnRCb3JkZXJJbm5lclBsYW5lO1xuICAgIHZhciBsZWZ0Qm9yZGVyT3V0ZXJQbGFuZSA9IHRoaXMubGVmdEJvcmRlck91dGVyUGxhbmU7XG4gICAgdmFyIGxlZnRDdXRQbGFuZSA9IHRoaXMubGVmdEN1dFBsYW5lO1xuICAgIHZhciBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZCA9IHRoaXMubGVmdEN1dFBsYW5lUG9pbnRzV29ybGQ7XG4gICAgdmFyIHBhcnRMZWZ0RWwgPSB0aGlzLnBhcnRMZWZ0RWw7XG4gICAgdmFyIHBhcnRSaWdodEVsID0gdGhpcy5wYXJ0UmlnaHRFbDtcbiAgICB2YXIgcmlnaHRCb3JkZXJJbm5lclBsYW5lID0gdGhpcy5yaWdodEJvcmRlcklubmVyUGxhbmU7XG4gICAgdmFyIHJpZ2h0Qm9yZGVyT3V0ZXJQbGFuZSA9IHRoaXMucmlnaHRCb3JkZXJPdXRlclBsYW5lO1xuICAgIHZhciByaWdodEN1dFBsYW5lID0gdGhpcy5yaWdodEN1dFBsYW5lO1xuICAgIHZhciByaWdodEN1dFBsYW5lUG9pbnRzV29ybGQgPSB0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZDtcblxuICAgIHBhcnRSaWdodEVsLm9iamVjdDNELnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG4gICAgcGFydFJpZ2h0RWwub2JqZWN0M0QubG9jYWxUb1dvcmxkKFxuICAgICAgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkWzBdLmNvcHkodGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzWzBdKSk7XG4gICAgcGFydFJpZ2h0RWwub2JqZWN0M0QubG9jYWxUb1dvcmxkKFxuICAgICAgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkWzFdLmNvcHkodGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzWzFdKSk7XG4gICAgcGFydFJpZ2h0RWwub2JqZWN0M0QubG9jYWxUb1dvcmxkKFxuICAgICAgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkWzJdLmNvcHkodGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzWzJdKSk7XG5cbiAgICBwYXJ0TGVmdEVsLm9iamVjdDNELnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG4gICAgcGFydExlZnRFbC5vYmplY3QzRC5sb2NhbFRvV29ybGQoXG4gICAgICBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZFswXS5jb3B5KHRoaXMubGVmdEN1dFBsYW5lUG9pbnRzWzBdKSk7XG4gICAgcGFydExlZnRFbC5vYmplY3QzRC5sb2NhbFRvV29ybGQoXG4gICAgICBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZFsxXS5jb3B5KHRoaXMubGVmdEN1dFBsYW5lUG9pbnRzWzFdKSk7XG4gICAgcGFydExlZnRFbC5vYmplY3QzRC5sb2NhbFRvV29ybGQoXG4gICAgICBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZFsyXS5jb3B5KHRoaXMubGVmdEN1dFBsYW5lUG9pbnRzWzJdKSk7XG5cbiAgICByaWdodEN1dFBsYW5lLnNldEZyb21Db3BsYW5hclBvaW50cyhcbiAgICAgIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZFswXSwgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkWzFdLCByaWdodEN1dFBsYW5lUG9pbnRzV29ybGRbMl0pO1xuICAgIHJpZ2h0Qm9yZGVyT3V0ZXJQbGFuZS5zZXQocmlnaHRDdXRQbGFuZS5ub3JtYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodEN1dFBsYW5lLmNvbnN0YW50ICsgdGhpcy5jdXRUaGlja25lc3MpO1xuXG4gICAgbGVmdEN1dFBsYW5lLnNldEZyb21Db3BsYW5hclBvaW50cyhcbiAgICAgIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkWzBdLCBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZFsxXSwgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGRbMl0pO1xuICAgIGxlZnRCb3JkZXJPdXRlclBsYW5lLnNldChsZWZ0Q3V0UGxhbmUubm9ybWFsLCBsZWZ0Q3V0UGxhbmUuY29uc3RhbnQgKyB0aGlzLmN1dFRoaWNrbmVzcyk7XG5cbiAgICByaWdodEJvcmRlcklubmVyUGxhbmUuc2V0RnJvbUNvcGxhbmFyUG9pbnRzKFxuICAgICAgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkWzJdLCByaWdodEN1dFBsYW5lUG9pbnRzV29ybGRbMV0sIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZFswXSk7XG4gICAgbGVmdEJvcmRlcklubmVyUGxhbmUuc2V0RnJvbUNvcGxhbmFyUG9pbnRzKFxuICAgICAgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGRbMl0sIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkWzFdLCBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZFswXSk7XG4gIH0sXG5cbiAgcmV0dXJuVG9Qb29sOiBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgICBpZiAoIXRoaXMuYmFja1RvUG9vbCAmJiAhZm9yY2UpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHNbdGhpcy5wb29sTmFtZV0ucmV0dXJuRW50aXR5KHRoaXMuZWwpO1xuICB9LFxuXG4gIGNoZWNrQ29sbGlzaW9uczogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGN1dERpcmVjdGlvbiA9IHRoaXMuZGF0YS5jdXREaXJlY3Rpb247XG4gICAgY29uc3Qgc2FiZXJDb2xvcnMgPSB0aGlzLnNhYmVyQ29sb3JzO1xuICAgIGNvbnN0IHNhYmVyRWxzID0gdGhpcy5zYWJlckVscztcbiAgICBjb25zdCBoaXRCb3VuZGluZ0JveCA9IHRoaXMuaGl0Q29sbGlkZXJFbCAmJiB0aGlzLmhpdEJvdW5kaW5nQm94LnNldEZyb21PYmplY3QoXG4gICAgICB0aGlzLmhpdENvbGxpZGVyRWwuZ2V0T2JqZWN0M0QoJ21lc2gnKSk7XG4gICAgY29uc3QgYmVhdEJvdW5kaW5nQm94ID0gdGhpcy5iZWF0Qm91bmRpbmdCb3guc2V0RnJvbU9iamVjdChcbiAgICAgIHRoaXMuYmxvY2tFbC5nZXRPYmplY3QzRCgnbWVzaCcpKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2FiZXJFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBzYWJlckJvdW5kaW5nQm94ID0gc2FiZXJFbHNbaV0uY29tcG9uZW50c1snc2FiZXItY29udHJvbHMnXS5ib3VuZGluZ0JveDtcbiAgICAgIGxldCBzYWJlckNvbnRyb2xzO1xuICAgICAgbGV0IG1heEFuZ2xlO1xuXG4gICAgICBpZiAoIXNhYmVyQm91bmRpbmdCb3gpIHsgYnJlYWs7IH1cblxuICAgICAgY29uc3QgaGFuZCA9IHNhYmVyRWxzW2ldLmdldEF0dHJpYnV0ZSgnc2FiZXItY29udHJvbHMnKS5oYW5kO1xuXG4gICAgICBpZiAoc2FiZXJCb3VuZGluZ0JveC5pbnRlcnNlY3RzQm94KGJlYXRCb3VuZGluZ0JveCkpIHtcbiAgICAgICAgLy8gTm90aWZ5IGZvciBoYXB0aWNzLlxuICAgICAgICB0aGlzLmVsLmVtaXQoYGJlYXRjb2xsaWRlJHtoYW5kfWAsIG51bGwsIHRydWUpO1xuXG4gICAgICAgIC8vIFNvdW5kLlxuICAgICAgICB0aGlzLmVsLnBhcmVudE5vZGUuY29tcG9uZW50c1snYmVhdC1oaXQtc291bmQnXS5wbGF5U291bmQodGhpcy5lbCk7XG5cbiAgICAgICAgaWYgKHRoaXMuZGF0YS50eXBlID09PSAnbWluZScpIHtcbiAgICAgICAgICB0aGlzLmVsLmVtaXQoJ21pbmVoaXQnLCBudWxsLCB0cnVlKTtcbiAgICAgICAgICB0aGlzLmRlc3Ryb3lNaW5lKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmRlc3Ryb3lCZWF0KHNhYmVyRWxzW2ldKTtcblxuICAgICAgICBpZiAoc2FiZXJFbHNbaV0uY29tcG9uZW50c1snc2FiZXItY29udHJvbHMnXS5zd2luZ2luZyAmJlxuICAgICAgICAgICAgdGhpcy5kYXRhLmNvbG9yID09PSBzYWJlckNvbG9yc1toYW5kXSkge1xuICAgICAgICAgIHRoaXMuaGl0U2FiZXJFbCA9IHNhYmVyRWxzW2ldO1xuICAgICAgICAgIHRoaXMuaGl0U2FiZXJFbC5hZGRFdmVudExpc3RlbmVyKCdzdHJva2VlbmQnLCB0aGlzLm9uRW5kU3Ryb2tlLCBPTkNFKTtcbiAgICAgICAgICBzYWJlckNvbnRyb2xzID0gc2FiZXJFbHNbaV0uY29tcG9uZW50c1snc2FiZXItY29udHJvbHMnXTtcbiAgICAgICAgICB0aGlzLmhpdEhhbmQgPSBoYW5kO1xuICAgICAgICAgIHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVggPSAwO1xuICAgICAgICAgIHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVkgPSAwO1xuICAgICAgICAgIHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVhZID0gMDtcblxuICAgICAgICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PT0gJ2Fycm93Jykge1xuICAgICAgICAgICAgc2FiZXJDb250cm9scy51cGRhdGVTdHJva2VEaXJlY3Rpb24oKTtcbiAgICAgICAgICAgIGlmICghc2FiZXJDb250cm9scy5zdHJva2VEaXJlY3Rpb25bdGhpcy5kYXRhLmN1dERpcmVjdGlvbl0pIHtcbiAgICAgICAgICAgICAgdGhpcy53cm9uZ0hpdChoYW5kKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjdXREaXJlY3Rpb24gPT09ICd1cCcgfHwgY3V0RGlyZWN0aW9uID09PSAnZG93bicpIHtcbiAgICAgICAgICAgICAgbWF4QW5nbGUgPSBzYWJlckNvbnRyb2xzLm1heEFuZ2xlUGxhbmVYO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjdXREaXJlY3Rpb24gPT09ICdsZWZ0JyB8fCBjdXREaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcbiAgICAgICAgICAgIG1heEFuZ2xlID0gc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG1heEFuZ2xlID0gc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWFk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1heEFuZ2xlID0gTWF0aC5tYXgoc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWCwgc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWFkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmFuZ2xlQmVmb3JlSGl0ID0gbWF4QW5nbGU7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLndyb25nSGl0KGhhbmQpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBvbkVuZFN0cm9rZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjdXREaXJlY3Rpb24gPSB0aGlzLmRhdGEuY3V0RGlyZWN0aW9uO1xuICAgIHZhciBoaXRFdmVudERldGFpbCA9IHRoaXMuaGl0RXZlbnREZXRhaWw7XG4gICAgdmFyIG1heEFuZ2xlO1xuICAgIHZhciBzYWJlckNvbnRyb2xzID0gdGhpcy5oaXRTYWJlckVsLmNvbXBvbmVudHNbJ3NhYmVyLWNvbnRyb2xzJ107XG4gICAgdmFyIHNjb3JlVGV4dDtcblxuICAgIC8vIEhhcmNvZGVkIHRlbXBvcmFyaWx5LlxuICAgIGNvbnN0IHNhYmVyUm90YXRpb24gPSAzLjE0IC8gMTI7XG5cbiAgICBpZiAoY3V0RGlyZWN0aW9uID09PSAndXAnIHx8IGN1dERpcmVjdGlvbiA9PT0gJ2Rvd24nKSB7XG4gICAgICBtYXhBbmdsZSA9IHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVg7XG4gICAgfSBlbHNlIGlmIChjdXREaXJlY3Rpb24gPT09ICdsZWZ0JyB8fCBjdXREaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcbiAgICAgIG1heEFuZ2xlID0gc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWTtcbiAgICB9IGVsc2Uge1xuICAgICAgbWF4QW5nbGUgPSBzYWJlckNvbnRyb2xzLm1heEFuZ2xlUGxhbmVYWTtcbiAgICB9XG5cbiAgICBjb25zdCBhbmdsZUJlZm9yZUhpdCA9IE1hdGgubWF4KDAsICh0aGlzLmFuZ2xlQmVmb3JlSGl0IC0gc2FiZXJSb3RhdGlvbikgKiAxODAgLyBNYXRoLlBJKTtcbiAgICBjb25zdCBhbmdsZUFmdGVySGl0ID0gTWF0aC5tYXgoMCwgKG1heEFuZ2xlIC0gc2FiZXJSb3RhdGlvbikgKiAxODAgLyBNYXRoLlBJKTtcblxuICAgIGxldCBzY29yZSA9IDA7XG4gICAgc2NvcmUgKz0gYW5nbGVCZWZvcmVIaXQgPj0gODUgPyA3MCA6IChhbmdsZUJlZm9yZUhpdCAvIDgwKSAqIDcwO1xuICAgIHNjb3JlICs9IGFuZ2xlQWZ0ZXJIaXQgPj0gNjAgPyAzMCA6IChhbmdsZUFmdGVySGl0IC8gNjApICogMzA7XG5cbiAgICBoaXRFdmVudERldGFpbC5zY29yZSA9IHNjb3JlO1xuICAgIHRoaXMuZWwuZW1pdCgnYmVhdGhpdCcsIGhpdEV2ZW50RGV0YWlsLCB0cnVlKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgndGV4dGdsb3dib2xkJywgbnVsbCwgZmFsc2UpO1xuXG4gICAgbGV0IGJlYXRTY29yZVBvb2w7XG4gICAgaWYgKHNjb3JlIDwgNjApIHsgYmVhdFNjb3JlUG9vbCA9IFNDT1JFX1BPT0wuT0s7IH1cbiAgICBlbHNlIGlmIChzY29yZSA8IDgwKSB7IGJlYXRTY29yZVBvb2wgPSBTQ09SRV9QT09MLkdPT0Q7IH1cbiAgICBlbHNlIGlmIChzY29yZSA8IDEwMCkgeyBiZWF0U2NvcmVQb29sID0gU0NPUkVfUE9PTC5HUkVBVDsgfVxuICAgIGVsc2Uge1xuICAgICAgYmVhdFNjb3JlUG9vbCA9IFNDT1JFX1BPT0wuU1VQRVI7XG5cbiAgICAgIHRoaXMuc3VwZXJDdXRzW3RoaXMuc3VwZXJDdXRJZHhdLmNvbXBvbmVudHMuc3VwZXJjdXRmeC5jcmVhdGVTdXBlckN1dCh0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uKTtcbiAgICAgIHRoaXMuc3VwZXJDdXRJZHggPSAodGhpcy5zdXBlckN1dElkeCArIDEpICUgdGhpcy5zdXBlckN1dHMubGVuZ3RoO1xuICAgIH1cblxuICAgIGNvbnN0IHNjb3JlRWwgPSB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50c1tiZWF0U2NvcmVQb29sXS5yZXF1ZXN0RW50aXR5KCk7XG4gICAgaWYgKHNjb3JlRWwpIHtcbiAgICAgIHNjb3JlRWwub2JqZWN0M0QucG9zaXRpb24uY29weSh0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uKTtcbiAgICAgIHNjb3JlRWwucGxheSgpO1xuICAgICAgc2NvcmVFbC5lbWl0KCdiZWF0c2NvcmVzdGFydCcsIG51bGwsIGZhbHNlKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIERlc3Ryb3llZCBhbmltYXRpb24uXG4gICAqL1xuICB0b2NrRGVzdHJveWVkOiAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBsZWZ0Q3V0Tm9ybWFsID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB2YXIgbGVmdFJvdGF0aW9uID0gMDtcbiAgICB2YXIgcmlnaHRDdXROb3JtYWwgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHZhciByaWdodFJvdGF0aW9uID0gMDtcbiAgICB2YXIgcm90YXRpb25TdGVwID0gMiAqIE1hdGguUEkgLyAxNTA7XG4gICAgdmFyIGZyYWdtZW50O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0aW1lRGVsdGEpIHtcbiAgICAgIC8vIFVwZGF0ZSBncmF2aXR5IHZlbG9jaXR5LlxuICAgICAgdGhpcy5ncmF2aXR5VmVsb2NpdHkgPSBnZXRHcmF2aXR5VmVsb2NpdHkodGhpcy5ncmF2aXR5VmVsb2NpdHksIHRpbWVEZWx0YSk7XG4gICAgICB0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uLnkgKz0gdGhpcy5ncmF2aXR5VmVsb2NpdHkgKiAodGltZURlbHRhIC8gMTAwMCk7XG5cbiAgICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PSAnbWluZScpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1pbmVGcmFnbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBmcmFnbWVudCA9IHRoaXMubWluZUZyYWdtZW50c1tpXTtcbiAgICAgICAgICBpZiAoIWZyYWdtZW50LnZpc2libGUpIHsgY29udGludWU7IH1cbiAgICAgICAgICBmcmFnbWVudC5wb3NpdGlvbi5hZGRTY2FsZWRWZWN0b3IoZnJhZ21lbnQuc3BlZWQsIHRpbWVEZWx0YSAvIDEwMDApO1xuICAgICAgICAgIGZyYWdtZW50LnNjYWxlLm11bHRpcGx5U2NhbGFyKDAuOTcpXG4gICAgICAgICAgaWYgKGZyYWdtZW50LnNjYWxlLnkgPCAwLjEpe1xuICAgICAgICAgICAgZnJhZ21lbnQudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHJpZ2h0Q3V0Tm9ybWFsLmNvcHkodGhpcy5yaWdodEN1dFBsYW5lLm5vcm1hbClcbiAgICAgICAgICAgICAgICAgICAgLm11bHRpcGx5U2NhbGFyKERFU1RST1lFRF9TUEVFRCAqICh0aW1lRGVsdGEgLyA1MDApKTtcbiAgICAgIHJpZ2h0Q3V0Tm9ybWFsLnkgPSAwOyAgLy8gWSBoYW5kbGVkIGJ5IGdyYXZpdHkuXG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELnBvc2l0aW9uLmFkZChyaWdodEN1dE5vcm1hbCk7XG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELnNldFJvdGF0aW9uRnJvbUF4aXNBbmdsZSh0aGlzLnJvdGF0aW9uQXhpcywgcmlnaHRSb3RhdGlvbik7XG4gICAgICByaWdodFJvdGF0aW9uID0gcmlnaHRSb3RhdGlvbiA+PSAyICogTWF0aC5QSSA/IDAgOiByaWdodFJvdGF0aW9uICsgcm90YXRpb25TdGVwO1xuXG4gICAgICBsZWZ0Q3V0Tm9ybWFsLmNvcHkodGhpcy5sZWZ0Q3V0UGxhbmUubm9ybWFsKVxuICAgICAgICAgICAgICAgICAgIC5tdWx0aXBseVNjYWxhcihERVNUUk9ZRURfU1BFRUQgKiAodGltZURlbHRhIC8gNTAwKSk7XG4gICAgICBsZWZ0Q3V0Tm9ybWFsLnkgPSAwOyAgLy8gWSBoYW5kbGVkIGJ5IGdyYXZpdHkuXG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0QucG9zaXRpb24uYWRkKGxlZnRDdXROb3JtYWwpO1xuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELnNldFJvdGF0aW9uRnJvbUF4aXNBbmdsZSh0aGlzLnJvdGF0aW9uQXhpcywgbGVmdFJvdGF0aW9uKTtcbiAgICAgIGxlZnRSb3RhdGlvbiA9IGxlZnRSb3RhdGlvbiA+PSAyICogTWF0aC5QSSA/IDAgOiBsZWZ0Um90YXRpb24gKyByb3RhdGlvblN0ZXA7XG5cbiAgICAgIHRoaXMuZ2VuZXJhdGVDdXRDbGlwcGluZ1BsYW5lcygpO1xuXG4gICAgICB0aGlzLnJldHVyblRvUG9vbFRpbWVyIC09IHRpbWVEZWx0YTtcbiAgICAgIHRoaXMuYmFja1RvUG9vbCA9IHRoaXMucmV0dXJuVG9Qb29sVGltZXIgPD0gMDtcbiAgICB9O1xuICB9KSgpLFxuXG4gIC8qKlxuICAgKiBMb2FkIE9CSiBmcm9tIGFscmVhZHkgcGFyc2VkIGFuZCBsb2FkZWQgT0JKIHRlbXBsYXRlLlxuICAgKi9cbiAgc2V0T2JqTW9kZWxGcm9tVGVtcGxhdGU6IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZ2VvbWV0cmllcyA9IHt9O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlbCwgdGVtcGxhdGVJZCkge1xuICAgICAgaWYgKCFnZW9tZXRyaWVzW3RlbXBsYXRlSWRdKSB7XG4gICAgICAgIGNvbnN0IHRlbXBsYXRlRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0ZW1wbGF0ZUlkKTtcbiAgICAgICAgaWYgKHRlbXBsYXRlRWwuZ2V0T2JqZWN0M0QoJ21lc2gnKSkge1xuICAgICAgICAgIGdlb21ldHJpZXNbdGVtcGxhdGVJZF0gPSB0ZW1wbGF0ZUVsLmdldE9iamVjdDNEKCdtZXNoJykuY2hpbGRyZW5bMF0uZ2VvbWV0cnk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGVtcGxhdGVFbC5hZGRFdmVudExpc3RlbmVyKCdtb2RlbC1sb2FkZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICBnZW9tZXRyaWVzW3RlbXBsYXRlSWRdID0gdGVtcGxhdGVFbC5nZXRPYmplY3QzRCgnbWVzaCcpLmNoaWxkcmVuWzBdLmdlb21ldHJ5O1xuICAgICAgICAgICAgdGhpcy5zZXRPYmpNb2RlbEZyb21UZW1wbGF0ZShlbCwgdGVtcGxhdGVJZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKSkgeyBlbC5zZXRPYmplY3QzRCgnbWVzaCcsIG5ldyBUSFJFRS5NZXNoKCkpOyB9XG4gICAgICBlbC5nZXRPYmplY3QzRCgnbWVzaCcpLmdlb21ldHJ5ID0gZ2VvbWV0cmllc1t0ZW1wbGF0ZUlkXTtcbiAgICB9O1xuICB9KSgpXG59KTtcblxuLyoqXG4gKiBHZXQgdmVsb2NpdHkgZ2l2ZW4gY3VycmVudCB2ZWxvY2l0eSB1c2luZyBncmF2aXR5IGFjY2VsZXJhdGlvbi5cbiAqL1xuZnVuY3Rpb24gZ2V0R3Jhdml0eVZlbG9jaXR5ICh2ZWxvY2l0eSwgdGltZURlbHRhKSB7XG4gIGNvbnN0IEdSQVZJVFkgPSAtOS44O1xuICByZXR1cm4gdmVsb2NpdHkgKyAoR1JBVklUWSAqICh0aW1lRGVsdGEgLyAxMDAwKSk7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9iZWF0LmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdjb25zb2xlLXNob3J0Y3V0cycsIHtcbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHdpbmRvdy4kID0gdmFsID0+IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodmFsKTtcbiAgICB3aW5kb3cuJCQgPSB2YWwgPT4gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWwpO1xuICAgIHdpbmRvdy4kJCQgPSB2YWwgPT4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgWyR7dmFsfV1gKS5nZXRBdHRyaWJ1dGUodmFsKTtcbiAgICB3aW5kb3cuJCQkJCA9IHZhbCA9PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbJHt2YWx9XWApLmNvbXBvbmVudHNbdmFsXTtcbiAgICB3aW5kb3cuc2NlbmUgPSB0aGlzLmVsO1xuICAgIHdpbmRvdy5zdGF0ZSA9IHRoaXMuZWwuc3lzdGVtcy5zdGF0ZS5zdGF0ZTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9jb25zb2xlLXNob3J0Y3V0cy5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnY29weS10ZXh0dXJlJywge1xuICBkZXBlbmRlbmNpZXM6IFsnZ2VvbWV0cnknLCAnbWF0ZXJpYWwnXSxcblxuICBzY2hlbWE6IHtcbiAgICBmcm9tOiB7dHlwZTogJ3NlbGVjdG9yJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGRhdGEuZnJvbS5hZGRFdmVudExpc3RlbmVyKCdtYXRlcmlhbHRleHR1cmVsb2FkZWQnLCAoKSA9PiB7IHRoaXMuY29weVRleHR1cmUoKTsgfSk7XG4gICAgdGhpcy5jb3B5VGV4dHVyZSgpO1xuICB9LFxuXG4gIGNvcHlUZXh0dXJlOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGF0YS5mcm9tO1xuICAgIGNvbnN0IG1hdGVyaWFsID0gZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbDtcblxuICAgIGlmICghdGFyZ2V0LmdldE9iamVjdDNEKCdtZXNoJykpIHsgcmV0dXJuOyB9XG5cbiAgICBtYXRlcmlhbC5tYXAgPSB0YXJnZXQuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5tYXA7XG5cbiAgICBpZiAoIW1hdGVyaWFsLm1hcCkgeyByZXR1cm47IH1cblxuICAgIG1hdGVyaWFsLm1hcC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgbWF0ZXJpYWwubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2NvcHktdGV4dHVyZS5qcyIsIi8qKlxuICogTGFzZXIgYmVhbS5cbiAqIEF1dG9tYXRpY2FsbHkgc2V0IGxlbmd0aCBvbiBpbnRlcnNlY3Rpb24uXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnY3Vyc29yLWxhc2VyJywge1xuICBkZXBlbmRlbmNpZXM6IFsnZ2VvbWV0cnknXSxcblxuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIHRoaXMuc2FiZXJFbCA9IHRoaXMuZWwuY2xvc2VzdCgnLnNhYmVyJyk7XG5cbiAgICAvLyBDYWxjdWxhdGUgc2l6ZSB0byBwb3NpdGlvbiBiZWFtIGF0IHRpcCBvZiBjb250cm9sbGVyLlxuICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5lbC5nZXRBdHRyaWJ1dGUoJ2dlb21ldHJ5Jyk7XG4gICAgZWwub2JqZWN0M0QucG9zaXRpb24ueiA9IC0xICogZ2VvbWV0cnkuaGVpZ2h0IC8gMjtcbiAgICB0aGlzLm9yaWdpbmFsU2l6ZSA9IGdlb21ldHJ5LmhlaWdodDtcbiAgICB0aGlzLmN1cnJlbnRMZW5ndGggPSBnZW9tZXRyeS5oZWlnaHQ7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gdGhpcy5kYXRhLmVuYWJsZWQ7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcblxuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG5cbiAgICBjb25zdCBjdXJzb3IgPSB0aGlzLnNhYmVyRWwuY29tcG9uZW50cy5jdXJzb3I7XG4gICAgaWYgKCFjdXJzb3IpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBUb2dnbGUgYmVhbS5cbiAgICBjb25zdCBpbnRlcnNlY3RlZEVsID0gY3Vyc29yLmludGVyc2VjdGVkRWw7XG5cbiAgICBpZiAoIWludGVyc2VjdGVkRWwpIHtcbiAgICAgIC8vIFJldHJhY3QgdGhlIGJlYW0gaWYgbm90IGludGVyc2VjdGluZy5cbiAgICAgIGVsLm9iamVjdDNELnBvc2l0aW9uLnogPSAtMjU7XG4gICAgICBlbC5vYmplY3QzRC5zY2FsZS54ID0gMC43NTtcbiAgICAgIGVsLmdldE9iamVjdDNEKCdtZXNoJykuc2NhbGUueSA9IDUwO1xuICAgICAgdGhpcy5jdXJyZW50TGVuZ3RoID0gMTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZXQgYXBwcm9wcmlhdGUgbGVuZ3RoIG9mIGJlYW0gb24gaW50ZXJzZWN0aW9uLlxuICAgIGNvbnN0IGludGVyc2VjdGlvbiA9IHRoaXMuc2FiZXJFbC5jb21wb25lbnRzLnJheWNhc3Rlci5pbnRlcnNlY3Rpb25zWzBdO1xuICAgIGlmICghaW50ZXJzZWN0aW9uKSB7IHJldHVybjsgfVxuICAgIGVsLm9iamVjdDNELnNjYWxlLnggPSAxO1xuICAgIGVsLm9iamVjdDNELnBvc2l0aW9uLnogPSAoLWludGVyc2VjdGlvbi5kaXN0YW5jZSAvIDIpO1xuICAgIGVsLmdldE9iamVjdDNEKCdtZXNoJykuc2NhbGUueSA9IHRoaXMuY3VycmVudExlbmd0aCA9IGludGVyc2VjdGlvbi5kaXN0YW5jZTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9jdXJzb3ItbGFzZXIuanMiLCIvKipcbiAqIEN1cnNvciBtZXNoIHRvIHNob3cgYXQgaW50ZXJzZWN0aW9uIHBvaW50IHdpdGggcmVzcGVjdGl2ZSBoYW5kLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2N1cnNvci1tZXNoJywge1xuICBzY2hlbWE6IHtcbiAgICBhY3RpdmU6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBjdXJzb3JFbDoge3R5cGU6ICdzZWxlY3Rvcid9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc2NlbmVQaXZvdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lUGl2b3QnKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0aGlzLmRhdGEuYWN0aXZlO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY3Vyc29yO1xuICAgIHZhciBjdXJzb3JFbCA9IHRoaXMuZGF0YS5jdXJzb3JFbDtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBpbnRlcnNlY3Rpb247XG4gICAgdmFyIGludGVyc2VjdGVkRWw7XG4gICAgdmFyIHNjZW5lUGl2b3RFbCA9IHRoaXMuc2NlbmVQaXZvdEVsO1xuXG4gICAgaWYgKCF0aGlzLmRhdGEuYWN0aXZlKSB7IHJldHVybjsgfVxuXG4gICAgY3Vyc29yID0gY3Vyc29yRWwuY29tcG9uZW50cy5jdXJzb3I7XG4gICAgaWYgKCFjdXJzb3IpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBMb29rIGZvciB2YWxpZCBpbnRlcnNlY3Rpb24gdGFyZ2V0LlxuICAgIGludGVyc2VjdGVkRWwgPSBjdXJzb3JFbC5jb21wb25lbnRzLmN1cnNvci5pbnRlcnNlY3RlZEVsO1xuICAgIGlmIChpbnRlcnNlY3RlZEVsKSB7XG4gICAgICBlbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjdXJzb3IgbWVzaC5cbiAgICBpbnRlcnNlY3Rpb24gPSBjdXJzb3JFbC5jb21wb25lbnRzLnJheWNhc3Rlci5nZXRJbnRlcnNlY3Rpb24oaW50ZXJzZWN0ZWRFbCk7XG4gICAgaWYgKCFpbnRlcnNlY3Rpb24pIHsgcmV0dXJuOyB9XG5cbiAgICBlbC5vYmplY3QzRC5wb3NpdGlvbi5jb3B5KGludGVyc2VjdGlvbi5wb2ludCk7XG5cbiAgICBpZiAoc2NlbmVQaXZvdEVsKSB7XG4gICAgICBlbC5vYmplY3QzRC5yb3RhdGlvbi5jb3B5KHNjZW5lUGl2b3RFbC5vYmplY3QzRC5yb3RhdGlvbik7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2N1cnNvci1tZXNoLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdkZWJ1Zy1iZWF0LWxvYWRlcicsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ2JlYXQtbG9hZGVyJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgYmVhdEVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgc3RhZ2VFbmFibGVkOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmVhdExvYWRlciA9IHRoaXMuZWwuY29tcG9uZW50c1snYmVhdC1sb2FkZXInXTtcbiAgICB0aGlzLnNlbGVjdGVkQmVhdCA9IHtcbiAgICAgIGNvbG9yOiAncmVkJyxcbiAgICAgIHBvc2l0aW9uOiAnbWlkZGxlQ2VudGVyTGVmdCcsXG4gICAgICB0eXBlOiAnYXJyb3cnLFxuICAgICAgb3JpZW50YXRpb246ICd1cCdcbiAgICB9O1xuXG4gICAgdGhpcy5iZWF0cyA9IHt9O1xuXG4gICAgdGhpcy5vbktleURvd24gPSB0aGlzLm9uS2V5RG93bi5iaW5kKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMuZGF0YS5zdGFnZUVuYWJsZWQgfHwgQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWdzdGFnZScpKSB7XG4gICAgICB0aGlzLmFkZERlYnVnU3RhZ2VDb250cm9scygpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEuYmVhdEVuYWJsZWQgfHxcbiAgICAgICAgQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWdzdGF0ZScpLnRyaW0oKSA9PT0gJ2dhbWVwbGF5Jykge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9uS2V5RG93bik7XG4gICAgICB0aGlzLmFkZERlYnVnQmVhdENvbnRyb2xzKCk7XG4gICAgfVxuICB9LFxuXG4gIHNwYXduOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIE9iamVjdC5rZXlzKHRoaXMuYmVhdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgc2VsZi5nZW5lcmF0ZUJlYXQoc2VsZi5iZWF0c1trZXldKTtcbiAgICB9KTtcbiAgfSxcblxuICBnZW5lcmF0ZUJlYXQ6IGZ1bmN0aW9uIChiZWF0SW5mbykge1xuICAgIHZhciB0eXBlO1xuICAgIGlmIChiZWF0SW5mby50eXBlID09PSAnd2FsbCcpIHtcbiAgICAgIHRoaXMuZ2VuZXJhdGVXYWxsKGJlYXRJbmZvKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGJlYXRJbmZvLnR5cGUgPT09ICdtaW5lJykge1xuICAgICAgdHlwZSA9IDM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHR5cGUgPSBiZWF0SW5mby5jb2xvciA9PT0gJ3JlZCcgPyAwIDogMTtcbiAgICB9XG4gICAgdGhpcy5iZWF0TG9hZGVyLmdlbmVyYXRlQmVhdCh7XG4gICAgICBfbGluZUluZGV4OiB0aGlzLmJlYXRMb2FkZXIucG9zaXRpb25IdW1hbml6ZWRbYmVhdEluZm8ucG9zaXRpb25dLmluZGV4LFxuICAgICAgX2xpbmVMYXllcjogdGhpcy5iZWF0TG9hZGVyLnBvc2l0aW9uSHVtYW5pemVkW2JlYXRJbmZvLnBvc2l0aW9uXS5sYXllcixcbiAgICAgIF9jdXREaXJlY3Rpb246IGJlYXRJbmZvLnR5cGUgPT09ICdkb3QnXG4gICAgICAgID8gOFxuICAgICAgICA6IHRoaXMuYmVhdExvYWRlci5vcmllbnRhdGlvbnNIdW1hbml6ZWQuaW5kZXhPZihiZWF0SW5mby5vcmllbnRhdGlvbiksXG4gICAgICBfdHlwZTogdHlwZVxuICAgIH0pO1xuICB9LFxuXG5cbiAgZ2VuZXJhdGVXYWxsOiBmdW5jdGlvbiAod2FsbEluZm8pIHtcbiAgICB0aGlzLmJlYXRMb2FkZXIuYnBtID0gOTA7XG4gICAgdGhpcy5iZWF0TG9hZGVyLmdlbmVyYXRlV2FsbCh7XG4gICAgICBfbGluZUluZGV4OiB0aGlzLmJlYXRMb2FkZXIucG9zaXRpb25IdW1hbml6ZWRbd2FsbEluZm8ucG9zaXRpb25dLmluZGV4LFxuICAgICAgX3dpZHRoOiAxLFxuICAgICAgX2R1cmF0aW9uOiAzXG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERlYnVnIGdlbmVyYXRlIGJlYXRzLlxuICAgKi9cbiAgb25LZXlEb3duOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBjb25zdCBrZXlDb2RlID0gZXZlbnQua2V5Q29kZTtcbiAgICBzd2l0Y2ggKGtleUNvZGUpIHtcbiAgICAgIGNhc2UgMzI6IHsgIC8vIFNwYWNlIGJhci5cbiAgICAgICAgdGhpcy5zcGF3bigpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgYWRkRGVidWdCZWF0Q29udHJvbHM6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBwYXJlbnREaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgIHBhcmVudERpdi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgcGFyZW50RGl2LnN0eWxlLnJpZ2h0ID0gJzAnO1xuICAgIHBhcmVudERpdi5zdHlsZS50b3AgPSAnMCc7XG4gICAgcGFyZW50RGl2LnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XG4gICAgcGFyZW50RGl2LnN0eWxlLndpZHRoID0gJzUwMHB4JztcbiAgICBwYXJlbnREaXYuc3R5bGUuaGVpZ2h0ID0gJzYwMHB4JztcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHBhcmVudERpdik7XG5cbiAgICBhZGRUeXBlQmVhdE1lbnUoKTtcbiAgICBhZGRDb2xvckJlYXRNZW51KCk7XG4gICAgYWRkT3JpZW50YXRpb25NZW51KCk7XG5cbiAgICBzZXRCZWF0QnV0dG9uKCk7XG4gICAgYWRkQmVhdFBvc2l0aW9uTWVudSgpO1xuXG4gICAgYWRkR2VuZXJhdGVCdXR0b24oKTtcblxuICAgIGZ1bmN0aW9uIGFkZE9yaWVudGF0aW9uTWVudSAoKSB7XG4gICAgICBjb25zdCBtZW51RGl2ID0gYWRkTWVudSgnb3JpZW50YXRpb24nKTtcbiAgICAgIGFkZEJ1dHRvbigndG9wJywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ2xlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbigncmlnaHQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignZG93bicsIG1lbnVEaXYpO1xuICAgICAgcGFyZW50RGl2LmFwcGVuZENoaWxkKG1lbnVEaXYpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZENvbG9yQmVhdE1lbnUgKCkge1xuICAgICAgY29uc3QgbWVudURpdiA9IGFkZE1lbnUoJ2NvbG9yJyk7XG4gICAgICBhZGRCdXR0b24oJ2JsdWUnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbigncmVkJywgbWVudURpdik7XG4gICAgICBwYXJlbnREaXYuYXBwZW5kQ2hpbGQobWVudURpdik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkVHlwZUJlYXRNZW51ICgpIHtcbiAgICAgIGNvbnN0IG1lbnVEaXYgPSBhZGRNZW51KCd0eXBlJyk7XG4gICAgICBhZGRCdXR0b24oJ2Fycm93JywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ2RvdCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCdtaW5lJywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ3dhbGwnLCBtZW51RGl2KTtcbiAgICAgIHBhcmVudERpdi5hcHBlbmRDaGlsZChtZW51RGl2KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRCZWF0UG9zaXRpb25NZW51ICgpIHtcbiAgICAgIGNvbnN0IG1lbnVEaXYgPSBhZGRNZW51KCdwb3NpdGlvbicpO1xuICAgICAgYWRkQnV0dG9uKCd0b3BMZWZ0JywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ3RvcENlbnRlckxlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbigndG9wQ2VudGVyUmlnaHQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbigndG9wUmlnaHQnLCBtZW51RGl2KTtcblxuICAgICAgYWRkQnV0dG9uKCdtaWRkbGVMZWZ0JywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ21pZGRsZUNlbnRlckxlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignbWlkZGxlQ2VudGVyUmlnaHQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignbWlkZGxlUmlnaHQnLCBtZW51RGl2KTtcblxuICAgICAgYWRkQnV0dG9uKCdib3R0b21MZWZ0JywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ2JvdHRvbUNlbnRlckxlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignYm90dG9tQ2VudGVyUmlnaHQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignYm90dG9tUmlnaHQnLCBtZW51RGl2KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRNZW51IChuYW1lKSB7XG4gICAgICBjb25zdCBtZW51RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBtZW51RGl2LmlkID0gbmFtZTtcbiAgICAgIG1lbnVEaXYuc3R5bGUubWFyZ2luQm90dG9tID0gJzIwcHgnO1xuICAgICAgbWVudURpdi5zdHlsZS53aWR0aCA9ICc1MDBweCc7XG4gICAgICBtZW51RGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgIHBhcmVudERpdi5hcHBlbmRDaGlsZChtZW51RGl2KTtcbiAgICAgIHJldHVybiBtZW51RGl2O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZEJ1dHRvbiAodGV4dCwgY29udGFpbmVyRWwsIGNsaWNrSGFuZGxlcikge1xuICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBjb25zdCBoYW5kbGVyID0gY2xpY2tIYW5kbGVyIHx8IGZ1bmN0aW9uIG9uQ2xpY2sgKCkge1xuICAgICAgICBjb25zdCBidXR0b25zID0gZGl2LnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJ1dHRvbicpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1dHRvbnMubGVuZ3RoOyBpKyspIHsgYnV0dG9uc1tpXS5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDAnOyB9XG4gICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJyM2NmYnO1xuICAgICAgICBzZWxmLnNlbGVjdGVkQmVhdFtkaXYucGFyZW50RWxlbWVudC5pZF0gPSB0aGlzLmlkO1xuICAgICAgICBzZWxmWydzZWxlY3RlZCcgKyBkaXYucGFyZW50RWxlbWVudC5pZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGRpdi5wYXJlbnRFbGVtZW50LmlkLnNsaWNlKDEpICsgJ0VsJ10gPSB0aGlzO1xuICAgICAgfTtcbiAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdidXR0b24nKTtcbiAgICAgIGRpdi5pZCA9IHRleHQ7XG4gICAgICBkaXYuc3R5bGUud2lkdGggPSAnMTAwcHgnO1xuICAgICAgZGl2LnN0eWxlLmhlaWdodCA9ICczMHB4JztcbiAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDAnO1xuICAgICAgZGl2LnN0eWxlLmNvbG9yID0gJyNmZmYnO1xuICAgICAgZGl2LnN0eWxlLnpJbmRleCA9IDk5OTk5OTk5OTtcbiAgICAgIGRpdi5zdHlsZS5wYWRkaW5nID0gJzVweCc7XG4gICAgICBkaXYuc3R5bGUubWFyZ2luID0gJzVweCc7XG4gICAgICBkaXYuc3R5bGUuZm9udCA9ICcxNHB4IHNhbnMtc2VyaWYnO1xuICAgICAgZGl2LnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xuICAgICAgZGl2LnN0eWxlLmxpbmVIZWlnaHQgPSAnMzBweCc7XG4gICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgICAgZGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgIGRpdi5pbm5lckhUTUwgPSB0ZXh0O1xuICAgICAgY29udGFpbmVyRWwuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZXIpO1xuICAgICAgcmV0dXJuIGRpdjtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gYWRkR2VuZXJhdGVCdXR0b24gKHRleHQsIGNvbnRhaW5lckVsKSB7XG4gICAgICBjb25zdCBidXR0b25FbCA9IGFkZEJ1dHRvbignU3Bhd24gKFNwYWNlIEJhciknLCBwYXJlbnREaXYsICgpID0+IHsgc2VsZi5zcGF3bigpOyB9KTtcbiAgICAgIGJ1dHRvbkVsLnN0eWxlLndpZHRoID0gJzQ2MHB4JztcbiAgICAgIGJ1dHRvbkVsLnN0eWxlLmJvdHRvbU1hcmdpbiA9ICcxMHB4J1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldEJlYXRCdXR0b24odGV4dCwgY29udGFpbmVyRWwpIHtcbiAgICAgIHZhciBidXR0b25FbCA9IGFkZEJ1dHRvbignU2V0IEJlYXQnLCBwYXJlbnREaXYsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gc2VsZi5zZWxlY3RlZEJlYXQudHlwZSAhPT0gJ21pbmUnID8gJyAnICsgc2VsZi5zZWxlY3RlZEJlYXQuY29sb3IgOiAnJztcbiAgICAgICAgdmFyIG9yaWVudGF0aW9uID0gc2VsZi5zZWxlY3RlZEJlYXQudHlwZSAhPT0gJ2Fycm93JyA/ICcnIDogJyAnICsgc2VsZi5zZWxlY3RlZEJlYXQub3JpZW50YXRpb247XG4gICAgICAgIHNlbGYuc2VsZWN0ZWRCZWF0ID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBzZWxmLnNlbGVjdGVkQmVhdC5wb3NpdGlvbixcbiAgICAgICAgICB0eXBlOiBzZWxmLnNlbGVjdGVkQmVhdC50eXBlLFxuICAgICAgICAgIG9yaWVudGF0aW9uOiBzZWxmLnNlbGVjdGVkQmVhdC5vcmllbnRhdGlvbixcbiAgICAgICAgICBjb2xvcjogc2VsZi5zZWxlY3RlZEJlYXQuY29sb3JcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFzZWxmLnNlbGVjdGVkUG9zaXRpb25FbCkgeyByZXR1cm47IH1cbiAgICAgICAgc2VsZi5zZWxlY3RlZFBvc2l0aW9uRWwuaW5uZXJIVE1MID0gc2VsZi5zZWxlY3RlZEJlYXQudHlwZSArIGNvbG9yICsgb3JpZW50YXRpb247XG4gICAgICAgIHNlbGYuYmVhdHNbc2VsZi5zZWxlY3RlZFBvc2l0aW9uRWwuaWRdID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBzZWxmLnNlbGVjdGVkQmVhdC5wb3NpdGlvbixcbiAgICAgICAgICB0eXBlOiBzZWxmLnNlbGVjdGVkQmVhdC50eXBlLFxuICAgICAgICAgIG9yaWVudGF0aW9uOiBzZWxmLnNlbGVjdGVkQmVhdC5vcmllbnRhdGlvbixcbiAgICAgICAgICBjb2xvcjogc2VsZi5zZWxlY3RlZEJlYXQuY29sb3JcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgYnV0dG9uRWwuc3R5bGUud2lkdGggPSAnNDYwcHgnO1xuICAgICAgYnV0dG9uRWwuc3R5bGUuYm90dG9tTWFyZ2luID0gJzEwcHgnXG4gICAgfTtcbiAgfSxcblxuICBhZGREZWJ1Z1N0YWdlQ29udHJvbHM6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY3VyckNvbnRyb2wgPSAwO1xuXG4gICAgY29uc3QgYWRkQ29udHJvbCA9IChpLCBuYW1lLCB0eXBlKSA9PiB7XG4gICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGRpdi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICBkaXYuaWQgPSAnc3RhZ2Vjb250cm9sJyArIGk7XG4gICAgICBkaXYuc3R5bGUud2lkdGggPSAnMTAwcHgnO1xuICAgICAgZGl2LnN0eWxlLmhlaWdodCA9ICczMHB4JztcbiAgICAgIGRpdi5zdHlsZS50b3AgPSB0eXBlID09PSAnZWxlbWVudCcgPyAnMjBweCcgOiAnNzBweCc7XG4gICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICcjMDAwJztcbiAgICAgIGRpdi5zdHlsZS5jb2xvciA9ICcjZmZmJztcbiAgICAgIGRpdi5zdHlsZS56SW5kZXggPSA5OTk5OTk5OTk7XG4gICAgICBkaXYuc3R5bGUucGFkZGluZyA9ICc1cHgnO1xuICAgICAgZGl2LnN0eWxlLmZvbnQgPSAnMTRweCBzYW5zLXNlcmlmJztcbiAgICAgIGRpdi5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJztcbiAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICBkaXYuc3R5bGUubGVmdCA9ICgyMCArIGkgKiAxMjApKydweCc7XG4gICAgICBkaXYuaW5uZXJIVE1MID0gbmFtZTtcbiAgICAgIGlmICh0eXBlID09PSAnZWxlbWVudCcpIHtcbiAgICAgICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFnZWNvbnRyb2wnICsgY3VyckNvbnRyb2wpLnN0eWxlLmJhY2tncm91bmQgPSAnIzAwMCc7XG4gICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnIzY2Zic7XG4gICAgICAgICAgY3VyckNvbnRyb2wgPSBpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICB0aGlzLmJlYXRMb2FkZXIuZ2VuZXJhdGVFdmVudCh7X3R5cGU6IGN1cnJDb250cm9sLCBfdmFsdWU6IGl9KVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaXYpO1xuICAgIH07XG5cbiAgICBbXG4gICAgICAnc2t5JyxcbiAgICAgICd0dW5uZWxOZW9uJyxcbiAgICAgICdsZWZ0U3RhZ2VMYXNlcnMnLFxuICAgICAgJ3JpZ2h0U3RhZ2VMYXNlcnMnLFxuICAgICAgJ2Zsb29yJ1xuICAgIF0uZm9yRWFjaCgoaWQsIGkpID0+IHsgYWRkQ29udHJvbChpLCBpZCwgJ2VsZW1lbnQnKTsgfSk7XG5cbiAgICBbXG4gICAgICAnb2ZmJyxcbiAgICAgICdibHVlJyxcbiAgICAgICdibHVlJyxcbiAgICAgICdibHVlZmFkZScsXG4gICAgICAnJyxcbiAgICAgICdyZWQnLFxuICAgICAgJ3JlZCcsXG4gICAgICAncmVkZmFkZSdcbiAgICBdLmZvckVhY2goKGlkLCBpKSA9PiB7IGFkZENvbnRyb2woaSwgaWQsICd2YWx1ZScpOyB9KTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1iZWF0LWxvYWRlci5qcyIsIi8qKlxuICogS2V5Ym9hcmQgYmluZGluZ3MgdG8gY29udHJvbCBjb250cm9sbGVyLlxuICogUG9zaXRpb24gY29udHJvbGxlciBpbiBmcm9udCBvZiBjYW1lcmEuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZGVidWctY29udHJvbGxlcicsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBwcmltYXJ5SGFuZDtcbiAgICB2YXIgc2Vjb25kYXJ5SGFuZDtcblxuICAgIGlmICghQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWcnKSkgeyByZXR1cm47IH1cblxuICAgIGNvbnNvbGUubG9nKCclYyBkZWJ1Zy1jb250cm9sbGVyIGVuYWJsZWQgJywgJ2JhY2tncm91bmQ6ICMxMTE7IGNvbG9yOiByZWQnKTtcblxuICAgIHRoaXMuaXNDbG9uaW5nID0gZmFsc2U7XG4gICAgdGhpcy5pc0RlbGV0aW5nID0gZmFsc2U7XG4gICAgdGhpcy5pc1RyaWdnZXJEb3duID0gZmFsc2U7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5vbk1vdXNlTW92ZS5iaW5kKHRoaXMpKTtcblxuICAgIHByaW1hcnlIYW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JpZ2h0SGFuZCcpO1xuICAgIHNlY29uZGFyeUhhbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVmdEhhbmQnKTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiB7XG4gICAgICBpZiAoIWV2dC5pc1RydXN0ZWQpIHsgcmV0dXJuOyB9XG4gICAgICBwcmltYXJ5SGFuZC5lbWl0KCd0cmlnZ2VyZG93bicpO1xuICAgICAgcHJpbWFyeUhhbmQuZW1pdCgndHJpZ2dlcnVwJyk7XG4gICAgfSk7XG5cbiAgICBpZiAoQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWcnKSA9PT0gJ29jdWx1cycpIHtcbiAgICAgIHByaW1hcnlIYW5kLmVtaXQoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCB7bmFtZTogJ29jdWx1cy10b3VjaC1jb250cm9scyd9KTtcbiAgICAgIHNlY29uZGFyeUhhbmQuZW1pdCgnY29udHJvbGxlcmNvbm5lY3RlZCcsIHtuYW1lOiAnb2N1bHVzLXRvdWNoLWNvbnRyb2xzJ30pO1xuICAgICAgcHJpbWFyeUhhbmQuc2V0QXR0cmlidXRlKCdjb250cm9sbGVyJywgJ2NvbnRyb2xsZXJUeXBlJywgJ29jdWx1cy10b3VjaC1jb250cm9scycpO1xuICAgICAgc2Vjb25kYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xsZXInLCAnY29udHJvbGxlclR5cGUnLCAnb2N1bHVzLXRvdWNoLWNvbnRyb2xzJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByaW1hcnlIYW5kLmVtaXQoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCB7bmFtZTogJ3ZpdmUtY29udHJvbHMnfSk7XG4gICAgICBzZWNvbmRhcnlIYW5kLmVtaXQoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCB7bmFtZTogJ3ZpdmUtY29udHJvbHMnfSk7XG4gICAgICBwcmltYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xsZXInLCAnY29udHJvbGxlclR5cGUnLCAndml2ZS1jb250cm9scycpO1xuICAgICAgc2Vjb25kYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xsZXInLCAnY29udHJvbGxlclR5cGUnLCAndml2ZS1jb250cm9scycpO1xuICAgIH1cblxuICAgIC8vIEVuYWJsZSByYXljYXN0ZXIuXG4gICAgdGhpcy5lbC5lbWl0KCdlbnRlci12cicsIG51bGwsIGZhbHNlKTtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldnQgPT4ge1xuICAgICAgdmFyIHByaW1hcnlQb3NpdGlvbjtcbiAgICAgIHZhciBwcmltYXJ5Um90YXRpb247XG4gICAgICB2YXIgc2Vjb25kYXJ5UG9zaXRpb247XG4gICAgICB2YXIgc2Vjb25kYXJ5Um90YXRpb247XG5cbiAgICAgIGlmICghZXZ0LnNoaWZ0S2V5KSB7IHJldHVybjsgfVxuXG4gICAgICAvLyA8c3BhY2U+IGZvciB0cmlnZ2VyLlxuICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSAzMikge1xuICAgICAgICBpZiAodGhpcy5pc1RyaWdnZXJEb3duKSB7XG4gICAgICAgICAgcHJpbWFyeUhhbmQuZW1pdCgndHJpZ2dlcnVwJyk7XG4gICAgICAgICAgdGhpcy5pc1RyaWdnZXJEb3duID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcHJpbWFyeUhhbmQuZW1pdCgndHJpZ2dlcmRvd24nKTtcbiAgICAgICAgICB0aGlzLmlzVHJpZ2dlckRvd24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gPHE+IGZvciBzZWNvbmRhcnkgdHJpZ2dlci5cbiAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gODEpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNTZWNvbmRhcnlUcmlnZ2VyRG93bikge1xuICAgICAgICAgIHNlY29uZGFyeUhhbmQuZW1pdCgndHJpZ2dlcnVwJyk7XG4gICAgICAgICAgdGhpcy5pc1NlY29uZGFyeVRyaWdnZXJEb3duID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2Vjb25kYXJ5SGFuZC5lbWl0KCd0cmlnZ2VyZG93bicpO1xuICAgICAgICAgIHRoaXMuaXNTZWNvbmRhcnlUcmlnZ2VyRG93biA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyA8bj4gc2Vjb25kYXJ5IGdyaXAuXG4gICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc4KSB7XG4gICAgICAgIGlmICh0aGlzLnNlY29uZGFyeUdyaXBEb3duKSB7XG4gICAgICAgICAgc2Vjb25kYXJ5SGFuZC5lbWl0KCdncmlwdXAnKTtcbiAgICAgICAgICB0aGlzLnNlY29uZGFyeUdyaXBEb3duID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2Vjb25kYXJ5SGFuZC5lbWl0KCdncmlwZG93bicpO1xuICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5R3JpcERvd24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIDxtPiBwcmltYXJ5IGdyaXAuXG4gICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc3KSB7XG4gICAgICAgIGlmICh0aGlzLnByaW1hcnlHcmlwRG93bikge1xuICAgICAgICAgIHByaW1hcnlIYW5kLmVtaXQoJ2dyaXB1cCcpO1xuICAgICAgICAgIHRoaXMucHJpbWFyeUdyaXBEb3duID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcHJpbWFyeUhhbmQuZW1pdCgnZ3JpcGRvd24nKTtcbiAgICAgICAgICB0aGlzLnByaW1hcnlHcmlwRG93biA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTWVudSBidXR0b24gPDE+LlxuICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA0OSkge1xuICAgICAgICBzZWNvbmRhcnlIYW5kLmVtaXQoJ21lbnVkb3duJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFBvc2l0aW9uIGJpbmRpbmdzLlxuICAgICAgaWYgKGV2dC5jdHJsS2V5KSB7XG4gICAgICAgIHNlY29uZGFyeVBvc2l0aW9uID0gc2Vjb25kYXJ5SGFuZC5nZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJyk7XG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzIpIHsgc2Vjb25kYXJ5UG9zaXRpb24ueCAtPSAwLjAxOyB9ICAvLyBoLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc0KSB7IHNlY29uZGFyeVBvc2l0aW9uLnkgLT0gMC4wMTsgfSAgLy8gai5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA3NSkgeyBzZWNvbmRhcnlQb3NpdGlvbi55ICs9IDAuMDE7IH0gIC8vIGsuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzYpIHsgc2Vjb25kYXJ5UG9zaXRpb24ueCArPSAwLjAxOyB9ICAvLyBsLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDU5IHx8IGV2dC5rZXlDb2RlID09PSAxODYpIHsgc2Vjb25kYXJ5UG9zaXRpb24ueiAtPSAwLjAxOyB9ICAvLyA7LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDIyMikgeyBzZWNvbmRhcnlQb3NpdGlvbi56ICs9IDAuMDE7IH0gIC8vIDsuXG4gICAgICAgIHNlY29uZGFyeUhhbmQuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIEFGUkFNRS51dGlscy5jbG9uZShzZWNvbmRhcnlQb3NpdGlvbikpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJpbWFyeVBvc2l0aW9uID0gcHJpbWFyeUhhbmQuZ2V0QXR0cmlidXRlKCdwb3NpdGlvbicpO1xuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDcyKSB7IHByaW1hcnlQb3NpdGlvbi54IC09IDAuMDE7IH0gIC8vIGguXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzQpIHsgcHJpbWFyeVBvc2l0aW9uLnkgLT0gMC4wMTsgfSAgLy8gai5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA3NSkgeyBwcmltYXJ5UG9zaXRpb24ueSArPSAwLjAxOyB9ICAvLyBrLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc2KSB7IHByaW1hcnlQb3NpdGlvbi54ICs9IDAuMDE7IH0gIC8vIGwuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNTkgfHwgZXZ0LmtleUNvZGUgPT09IDE4NikgeyBwcmltYXJ5UG9zaXRpb24ueiAtPSAwLjAxOyB9ICAvLyA7LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDIyMikgeyBwcmltYXJ5UG9zaXRpb24ueiArPSAwLjAxOyB9ICAvLyA7LlxuICAgICAgICBwcmltYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgQUZSQU1FLnV0aWxzLmNsb25lKHByaW1hcnlQb3NpdGlvbikpO1xuICAgICAgfVxuXG4gICAgICAvLyBSb3RhdGlvbiBiaW5kaW5ncy5cbiAgICAgIGlmIChldnQuY3RybEtleSkge1xuICAgICAgICBzZWNvbmRhcnlSb3RhdGlvbiA9IHNlY29uZGFyeUhhbmQuZ2V0QXR0cmlidXRlKCdyb3RhdGlvbicpO1xuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDg5KSB7IHNlY29uZGFyeVJvdGF0aW9uLnggLT0gMTA7IH0gIC8vIHkuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzkpIHsgc2Vjb25kYXJ5Um90YXRpb24ueCArPSAxMDsgfSAgLy8gby5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA4NSkgeyBzZWNvbmRhcnlSb3RhdGlvbi55IC09IDEwOyB9ICAvLyB1LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDczKSB7IHNlY29uZGFyeVJvdGF0aW9uLnkgKz0gMTA7IH0gIC8vIGkuXG4gICAgICAgIHNlY29uZGFyeUhhbmQuc2V0QXR0cmlidXRlKCdyb3RhdGlvbicsIEFGUkFNRS51dGlscy5jbG9uZShzZWNvbmRhcnlSb3RhdGlvbikpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJpbWFyeVJvdGF0aW9uID0gcHJpbWFyeUhhbmQuZ2V0QXR0cmlidXRlKCdyb3RhdGlvbicpO1xuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDg5KSB7IHByaW1hcnlSb3RhdGlvbi54IC09IDEwOyB9ICAvLyB5LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc5KSB7IHByaW1hcnlSb3RhdGlvbi54ICs9IDEwOyB9ICAvLyBvLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDg1KSB7IHByaW1hcnlSb3RhdGlvbi55IC09IDEwOyB9ICAvLyB1LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDczKSB7IHByaW1hcnlSb3RhdGlvbi55ICs9IDEwOyB9ICAvLyBpLlxuICAgICAgICBwcmltYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ3JvdGF0aW9uJywgQUZSQU1FLnV0aWxzLmNsb25lKHByaW1hcnlSb3RhdGlvbikpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcHJpbWFyeUhhbmQ7XG4gICAgdmFyIHNlY29uZGFyeUhhbmQ7XG5cbiAgICB0aGlzLmJvdW5kcyA9IGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICBpZiAoIUFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2RlYnVnJykpIHsgcmV0dXJuOyB9XG5cbiAgICBwcmltYXJ5SGFuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaWdodEhhbmQnKTtcbiAgICBzZWNvbmRhcnlIYW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xlZnRIYW5kJyk7XG5cbiAgICBzZWNvbmRhcnlIYW5kLm9iamVjdDNELnBvc2l0aW9uLnNldCgtMC4yLCAxLjUsIC0wLjUpO1xuICAgIHByaW1hcnlIYW5kLm9iamVjdDNELnBvc2l0aW9uLnNldCgwLjIsIDEuNSwgLTAuNSk7XG4gICAgc2Vjb25kYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ3JvdGF0aW9uJywge3g6IDM1LCB5OiAwLCB6OiAwfSk7XG4gIH0sXG5cbiAgb25Nb3VzZU1vdmU6IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGlyZWN0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICBjb25zdCBtb3VzZSA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG4gICAgY29uc3QgY2FtZXJhUG9zID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICBjb25zdCBib3VuZHMgPSB0aGlzLmJvdW5kcztcbiAgICAgIGNvbnN0IGNhbWVyYSA9IHRoaXMuZWwuc2NlbmVFbC5jYW1lcmE7XG4gICAgICBjb25zdCBsZWZ0ID0gZXZ0LmNsaWVudFggLSBib3VuZHMubGVmdDtcbiAgICAgIGNvbnN0IHRvcCA9IGV2dC5jbGllbnRZIC0gYm91bmRzLnRvcDtcbiAgICAgIG1vdXNlLnggPSAobGVmdCAvIGJvdW5kcy53aWR0aCkgKiAyIC0gMTtcbiAgICAgIG1vdXNlLnkgPSAoLXRvcCAvIGJvdW5kcy5oZWlnaHQpICogMiAtIDE7XG5cbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW1lcmEnKS5vYmplY3QzRC5nZXRXb3JsZFBvc2l0aW9uKGNhbWVyYVBvcyk7XG4gICAgICBkaXJlY3Rpb24uc2V0KG1vdXNlLngsIG1vdXNlLnksIDAuNSkudW5wcm9qZWN0KGNhbWVyYSkuc3ViKGNhbWVyYVBvcykubm9ybWFsaXplKCk7XG5cbiAgICAgIGNvbnN0IGhhbmRQb3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlnaHRIYW5kJykub2JqZWN0M0QucG9zaXRpb247XG4gICAgICBjb25zdCBkaXN0YW5jZSA9IC1jYW1lcmFQb3MueiAvIGRpcmVjdGlvbi56O1xuICAgICAgY2FtZXJhLmdldFdvcmxkUG9zaXRpb24oaGFuZFBvcykuYWRkKGRpcmVjdGlvbi5tdWx0aXBseVNjYWxhcihkaXN0YW5jZSkpO1xuICAgICAgaGFuZFBvcy55ICs9IDAuODtcbiAgICB9O1xuICB9KSgpXG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2RlYnVnLWNvbnRyb2xsZXIuanMiLCIvKipcbiAqIExvZyBjdXJzb3IgZXZlbnRzLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2RlYnVnLWN1cnNvcicsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZXZ0ID0+IHtcbiAgICAgIHRoaXMubG9nKCdtb3VzZWVudGVyJywgZXZ0LmRldGFpbC5pbnRlcnNlY3RlZEVsLCAnZ3JlZW4nKTtcbiAgICB9KTtcblxuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGV2dCA9PiB7XG4gICAgICB0aGlzLmxvZygnbW91c2VsZWF2ZScsIGV2dC5kZXRhaWwuaW50ZXJzZWN0ZWRFbCwgJ3JlZCcpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiB7XG4gICAgICB0aGlzLmxvZygnY2xpY2snLCBldnQuZGV0YWlsLmludGVyc2VjdGVkRWwsICdibHVlJyk7XG4gICAgfSk7XG4gIH0sXG5cbiAgbG9nOiBmdW5jdGlvbiAoZXZlbnQsIGludGVyc2VjdGVkRWwsIGNvbG9yKSB7XG4gICAgaWYgKGludGVyc2VjdGVkRWwuaWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKGAlY1ske2V2ZW50fV0gJHtpbnRlcnNlY3RlZEVsLmlkfWAsIGBjb2xvcjogJHtjb2xvcn1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coYCVjWyR7ZXZlbnR9XWAsIGBjb2xvcjogJHtjb2xvcn1gKTtcbiAgICAgIGNvbnNvbGUubG9nKGludGVyc2VjdGVkRWwpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1jdXJzb3IuanMiLCIvKipcbiAqIEVtaXQgZXZlbnRzIGZyb20gcXVlcnkgcGFyYW1ldGVyIHRvIHN0YXRlIHRvIGF1dG9tYXRpY2FsbHkgc2V0IHVwIHN0YXRlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2RlYnVnLXNvbmctdGltZScsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ3NvbmcnXSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdkZWJ1Zy1zb25nLXRpbWUnKSkgeyByZXR1cm47IH1cbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyh0aGlzLmVsLmNvbXBvbmVudHMuc29uZy5nZXRDdXJyZW50VGltZSgpKTtcbiAgICB9LCAyNTApO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2RlYnVnLXNvbmctdGltZS5qcyIsIi8qKlxuICogRW1pdCBldmVudHMgZnJvbSBxdWVyeSBwYXJhbWV0ZXIgdG8gc3RhdGUgdG8gYXV0b21hdGljYWxseSBzZXQgdXAgc3RhdGUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZGVidWctc3RhdGUnLCB7XG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBmbGFncyA9IEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2RlYnVnc3RhdGUnKS50cmltKCk7XG4gICAgaWYgKCFmbGFncykgeyByZXR1cm47IH1cblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZmxhZ3Muc3BsaXQoJywnKS5mb3JFYWNoKGZsYWcgPT4ge1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdChgZGVidWcke2ZsYWcudHJpbSgpfWAsIG51bGwsIGZhbHNlKTtcbiAgICAgIH0pO1xuICAgIH0sIDUwMCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvZGVidWctc3RhdGUuanMiLCJpbXBvcnQge2dldEdyaWRVdnN9IGZyb20gJ2FmcmFtZS1hdGxhcy11dnMtY29tcG9uZW50JztcbnJlcXVpcmUoJy4uLy4uL3ZlbmRvci9CdWZmZXJHZW9tZXRyeVV0aWxzJyk7XG5cbmNvbnN0IGNvbG9ySGVscGVyID0gbmV3IFRIUkVFLkNvbG9yKCk7XG5cbmNvbnN0IGdlb21ldHJ5ID0gY3JlYXRlR2VvbWV0cnkoKTtcbmNvbnN0IG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcbiAgYWxwaGFNYXA6IGNyZWF0ZUFscGhhTWFwKCksXG4gIHRyYW5zcGFyZW50OiB0cnVlLFxuICB2ZXJ0ZXhDb2xvcnM6IFRIUkVFLlZlcnRleENvbG9yc1xufSk7XG5cbi8qKlxuICogRmFrZSBnbG93IHVzaW5nIG1lcmdlZCBvdmVybGF5ZWQgY3lsaW5kZXJzIHdpdGggYWxwaGEgbWFwLlxuICogUmVxdWlyZXMgVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscy5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdmYWtlLWdsb3cnLCB7XG4gIHNjaGVtYToge1xuICAgIGNvbG9yOiB7ZGVmYXVsdDogJyNGRkYnfVxuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnNldE9iamVjdDNEKCdtZXNoJywgbmV3IFRIUkVFLk1lc2goY3JlYXRlR2VvbWV0cnkodGhpcy5kYXRhLmNvbG9yKSwgbWF0ZXJpYWwpKTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGNyZWF0ZUFscGhhTWFwICgpIHtcbiAgY29uc3QgYWxwaGFDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgYWxwaGFDYW52YXMuaGVpZ2h0ID0gMTtcbiAgYWxwaGFDYW52YXMud2lkdGggPSA0O1xuXG4gIGNvbnN0IGN0eCA9IGFscGhhQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgLy8gRm9yIGZpcnN0IGNvbG9yLlxuICBjdHguZmlsbFN0eWxlID0gJ3JnYigxMCwgMTAsIDEwKSc7XG4gIGN0eC5maWxsUmVjdCgwLCAwLCAxLCAxKTtcbiAgY3R4LmZpbGxTdHlsZSA9ICdyZ2IoMTUsIDE1LCAxNSknO1xuICBjdHguZmlsbFJlY3QoMSwgMCwgMSwgMSk7XG4gIGN0eC5maWxsU3R5bGUgPSAncmdiKDIzLCAyMyAsMjMpJztcbiAgY3R4LmZpbGxSZWN0KDIsIDAsIDEsIDEpO1xuICBjdHguZmlsbFN0eWxlID0gJ3JnYigyOCwgMjgsIDI4KSc7XG4gIGN0eC5maWxsUmVjdCgzLCAwLCAxLCAxKTtcblxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBhbHBoYUNhbnZhcy5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XG4gICAgYWxwaGFDYW52YXMuc3R5bGUuekluZGV4ID0gOTk5OTk5OTk5OTk5O1xuICAgIGFscGhhQ2FudmFzLnN0eWxlLmxlZnQgPSAwO1xuICAgIGFscGhhQ2FudmFzLnN0eWxlLnRvcCA9IDA7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhbHBoYUNhbnZhcyk7XG4gIH0sIDEwMDApO1xuICByZXR1cm4gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUoYWxwaGFDYW52YXMpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVHZW9tZXRyeSAoY29sb3IpIHtcbiAgY29sb3JIZWxwZXIuc2V0KGNvbG9yKTtcblxuICBjb25zdCBjeWxpbmRlcnMgPSBbXG4gICAge2hlaWdodDogMC4xODMxLCByYWRpdXM6IDAuMDA1NX0sXG4gICAge2hlaWdodDogMC4xODMyLCByYWRpdXM6IDAuMDA2NX0sXG4gICAge2hlaWdodDogMC4xODMzLCByYWRpdXM6IDAuMDA3NX0sXG4gICAge2hlaWdodDogMC4xODM0LCByYWRpdXM6IDAuMDA4NX1cbiAgXTtcblxuICBjb25zdCBnZW9tZXRyaWVzID0gY3lsaW5kZXJzLm1hcCgoY3lsaW5kZXJEYXRhLCBpKSA9PiB7XG4gICAgY29uc3QgY3lsaW5kZXIgPSBuZXcgVEhSRUUuQ3lsaW5kZXJCdWZmZXJHZW9tZXRyeShcbiAgICAgIGN5bGluZGVyRGF0YS5yYWRpdXMsXG4gICAgICBjeWxpbmRlckRhdGEucmFkaXVzLFxuICAgICAgY3lsaW5kZXJEYXRhLmhlaWdodFxuICAgICk7XG5cbiAgICBjb25zdCBjb2xvckFycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjeWxpbmRlci5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5Lmxlbmd0aDsgaSArPSAzKSB7XG4gICAgICBjb2xvckFycmF5W2ldID0gY29sb3JIZWxwZXIucjtcbiAgICAgIGNvbG9yQXJyYXlbaSArIDFdID0gY29sb3JIZWxwZXIuZztcbiAgICAgIGNvbG9yQXJyYXlbaSArIDJdID0gY29sb3JIZWxwZXIuYjtcbiAgICB9XG4gICAgY3lsaW5kZXIuYWRkQXR0cmlidXRlKCdjb2xvcicsIG5ldyBUSFJFRS5GbG9hdDMyQnVmZmVyQXR0cmlidXRlKGNvbG9yQXJyYXksIDMpKTtcblxuICAgIGNvbnN0IGFscGhhVXZzID0gZ2V0R3JpZFV2cygwLCBpLCAxLCA0KTtcbiAgICBjb25zdCB1dnMgPSBjeWxpbmRlci5hdHRyaWJ1dGVzLnV2LmFycmF5O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXZzLmxlbmd0aDsgaSArPSA2KSB7XG4gICAgICB1dnNbaV0gPSBhbHBoYVV2c1swXS54O1xuICAgICAgdXZzW2kgKyAxXSA9IGFscGhhVXZzWzBdLnk7XG5cbiAgICAgIHV2c1tpICsgMl0gPSBhbHBoYVV2c1sxXS54O1xuICAgICAgdXZzW2kgKyAzXSA9IGFscGhhVXZzWzFdLnk7XG5cbiAgICAgIHV2c1tpICsgNF0gPSBhbHBoYVV2c1syXS54O1xuICAgICAgdXZzW2kgKyA1XSA9IGFscGhhVXZzWzJdLnk7XG4gICAgfVxuICAgIGN5bGluZGVyLmF0dHJpYnV0ZXMudXYubmVlZHNVcGRhdGUgPSB0cnVlO1xuXG4gICAgcmV0dXJuIGN5bGluZGVyO1xuICB9KTtcblxuICBjb25zdCBnZW9tZXRyeSA9IFRIUkVFLkJ1ZmZlckdlb21ldHJ5VXRpbHMubWVyZ2VCdWZmZXJHZW9tZXRyaWVzKGdlb21ldHJpZXMpO1xuICByZXR1cm4gZ2VvbWV0cnlcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2Zha2UtZ2xvdy5qcyIsIlxuY29uc3QgQ09MT1JTID0gcmVxdWlyZSgnLi4vY29uc3RhbnRzL2NvbG9ycy5qcycpO1xuY29uc3QgSElUX0NPTE9SID0gbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5ORU9OX1JFRCk7XG5jb25zdCBCT1JERVJfQ09MT1IgPSBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk5FT05fQkxVRSk7XG5cbkFGUkFNRS5yZWdpc3RlclNoYWRlcignZmxvb3JTaGFkZXInLCB7XG4gIHNjaGVtYToge1xuICAgIG5vcm1hbE1hcDoge3R5cGU6ICdtYXAnLCBpczogJ3VuaWZvcm0nfSxcbiAgICBlbnZNYXA6IHt0eXBlOiAnbWFwJywgaXM6ICd1bmlmb3JtJ30sXG4gICAgaGl0UmlnaHQ6IHt0eXBlOiAndmVjMycsIGlzOiAndW5pZm9ybScsIGRlZmF1bHQ6IHt4OiAwLCB5OiAxLCB6OiAwfX0sXG4gICAgaGl0TGVmdDoge3R5cGU6ICd2ZWMzJywgaXM6ICd1bmlmb3JtJywgZGVmYXVsdDoge3g6IDAsIHk6IDAsIHo6IDB9fVxuICB9LFxuXG4gIHZlcnRleFNoYWRlcjogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHV2cy54eSA9IHV2Lnh5O1xuICAgICAgdmVjNCBwID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcbiAgICAgIHdvcmxkUG9zID0gKG1vZGVsTWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApKS54eXo7XG4gICAgICBnbF9Qb3NpdGlvbiA9IHA7XG4gICAgfVxuICBgLFxuXG4gIGZyYWdtZW50U2hhZGVyOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdW5pZm9ybSB2ZWMzIGNvbG9yO1xuICAgIHVuaWZvcm0gc2FtcGxlcjJEIG5vcm1hbE1hcDtcbiAgICB1bmlmb3JtIHNhbXBsZXIyRCBlbnZNYXA7XG4gICAgdW5pZm9ybSB2ZWMzIGhpdFJpZ2h0O1xuICAgIHVuaWZvcm0gdmVjMyBoaXRMZWZ0O1xuXG4gICAgI2RlZmluZSBISVRfQ09MT1IgdmVjMygke0hJVF9DT0xPUi5yfSwgJHtISVRfQ09MT1IuZ30sICR7SElUX0NPTE9SLmJ9KVxuICAgICNkZWZpbmUgQk9SREVSX0NPTE9SIHZlYzMoJHtCT1JERVJfQ09MT1Iucn0sICR7Qk9SREVSX0NPTE9SLmd9LCAke0JPUkRFUl9DT0xPUi5ifSlcblxuICAgIHZlYzMgZHJhd0NpcmNsZSh2ZWMzIHAsIHZlYzMgY2VudGVyLCBmbG9hdCByYWRpdXMsIGZsb2F0IGVkZ2VXaWR0aCwgdmVjMyBjb2xvcikge1xuICAgICAgcmV0dXJuIGNvbG9yKigxLjAtc21vb3Roc3RlcChyYWRpdXMsIHJhZGl1cytlZGdlV2lkdGgsIGxlbmd0aChwLWNlbnRlcikpKTtcbiAgICB9XG5cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB2ZWMyIHAgPSB1dnMueHkgLSAwLjU7XG4gICAgICB2ZWMzIGJvcmRlciA9IHZlYzMoc21vb3Roc3RlcCgwLjQ5LCAwLjQ5NSwgYWJzKHAueCkpICsgc21vb3Roc3RlcCgwLjQ5LCAwLjQ5NSwgYWJzKHAueSkpKTtcbiAgICAgIGJvcmRlciArPSBCT1JERVJfQ09MT1IgKiAoc21vb3Roc3RlcCgwLjQ3NSwgMC40OTUsIGFicyhwLngpKSArIHNtb290aHN0ZXAoMC40NzUsIDAuNDk1LCBhYnMocC55KSkpICogLjc7XG4gICAgICBwKj0gNC4wO1xuXG4gICAgICB2ZWMzIGhpdENvbG9yID0gSElUX0NPTE9SO1xuICAgICAgdmVjMyBoaXQgPSB2ZWMzKDAuMCk7XG5cbiAgICAgIGhpdCArPSBkcmF3Q2lyY2xlKHdvcmxkUG9zLCBoaXRSaWdodCwgMC4wNCwgMC4wNSwgaGl0Q29sb3IpO1xuICAgICAgaGl0ICs9IGRyYXdDaXJjbGUod29ybGRQb3MsIGhpdFJpZ2h0LCAwLjAyLCAwLjAzLCB2ZWMzKDAuNywgMC43LCAwLjcpKTtcbiAgICAgIGhpdCArPSBkcmF3Q2lyY2xlKHdvcmxkUG9zLCBoaXRMZWZ0LCAwLjA0LCAwLjA1LCBoaXRDb2xvcik7XG4gICAgICBoaXQgKz0gZHJhd0NpcmNsZSh3b3JsZFBvcywgaGl0TGVmdCwgMC4wMiwgMC4wMywgdmVjMygwLjcsIDAuNywgMC43KSk7XG5cbiAgICAgIHZlYzMgbm9ybWFsID0gbm9ybWFsaXplKHRleHR1cmUyRChub3JtYWxNYXAsIHV2cykueHl6KTtcblxuICAgICAgLy8gZW52aXJvbm1lbnQgcmVmbGVjdGlvblxuICAgICAgdmVjMyByZWZsZWN0VmVjID0gbm9ybWFsaXplKHJlZmxlY3Qobm9ybWFsaXplKHdvcmxkUG9zIC0gY2FtZXJhUG9zaXRpb24pLCBub3JtYWwpKTtcbiAgICAgIC8vdmVjMyByZWZsZWN0VmlldyA9IG5vcm1hbGl6ZSgodmlld01hdHJpeCAqIHZlYzQocmVmbGVjdFZlYywgMC4wKSkueHl6ICsgdmVjMygwLjAsIDAuMCwgMS4wKSk7XG5cbiAgICAgIHZlYzMgcmVmID0gdGV4dHVyZTJEKGVudk1hcCwgcmVmbGVjdFZlYy54eSAqIHZlYzIoMC4zLCAxLjApICsgdmVjMigwLjc1LCAtY2FtZXJhUG9zaXRpb24ueiAqIDAuMDUpKS54eXogKiAwLjE0O1xuXG4gICAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KHJlZiArIGJvcmRlciArIGhpdCwgMS4wKTtcbiAgICB9XG4gIGBcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvZmxvb3Itc2hhZGVyLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdnYW1lb3ZlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgaXNHYW1lT3Zlcjoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJlYXRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmVhdENvbnRhaW5lcicpO1xuICAgIHRoaXMuZ2FtZU92ZXJFbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbYW5pbWF0aW9uX19nYW1lb3Zlcl0nKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgaWYgKCFvbGREYXRhLmlzR2FtZU92ZXIgJiYgdGhpcy5kYXRhLmlzR2FtZU92ZXIpIHtcbiAgICAgIHRoaXMudHJpZ2dlckFuaW1hdGlvbnMoKTtcbiAgICAgIHRoaXMuY291bnREb3duID0gMTtcbiAgICB9XG4gICAgaWYgKG9sZERhdGEuaXNHYW1lT3ZlciAmJiAhdGhpcy5kYXRhLmlzR2FtZU92ZXIpIHtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuaXNHYW1lT3ZlcikgeyByZXR1cm47IH1cbiAgICBpZiAodGhpcy5jb3VudERvd24gPj0gMCkge1xuICAgICAgdGhpcy5iZWF0Q29udGFpbmVyLm9iamVjdDNELnBvc2l0aW9uLnogPSAtTWF0aC5wb3coMSAtIHRoaXMuY291bnREb3duLCAyKSAqIDEuNTtcbiAgICAgIHRoaXMuY291bnREb3duIC09IGRlbHRhIC8gMTAwMDtcbiAgICB9XG4gIH0sXG5cbiAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJlYXRDb250YWluZXIub2JqZWN0M0QucG9zaXRpb24ueiA9IDA7XG4gICAgdGhpcy5lbC5zY2VuZUVsLnNldEF0dHJpYnV0ZSgnc3RhZ2UtY29sb3JzJywgJ2NvbG9yJywgJ2JsdWUnKTtcbiAgfSxcblxuICB0cmlnZ2VyQW5pbWF0aW9uczogZnVuY3Rpb24gKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5nYW1lT3ZlckVscy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5nYW1lT3ZlckVsc1tpXS5lbWl0KCdnYW1lb3ZlcicsIG51bGwsIGZhbHNlKTtcbiAgICB9XG4gICAgdGhpcy5lbC5lbWl0KCd0ZXh0Z2xvd29mZicsIG51bGwsIGZhbHNlKTtcbiAgICB0aGlzLmVsLmVtaXQoJ2JnY29sb3JnYW1lb3ZlcicsIG51bGwsIGZhbHNlKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9nYW1lb3Zlci5qcyIsImxldCBpID0gMDtcblxuLyoqXG4gKiBQcmVsb2FkIHRleHR1cmVzIHRvIEdQVSB0aGF0IGFyZSBub3QgdmlzaWJsZSBmcm9tIHRoZSBzdGFydC4uXG4gKiB0aHJlZS5qcyByZW5kZXJlciBieSBkZWZhdWx0IHdpbGwgbm90IHVwbG9hZCB0ZXh0dXJlcyBmcm9tIG5vbi12aXNpYmxlIGVudGl0aWVzLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2dwdS1wcmVsb2FkZXInLCB7XG4gIGRlcGVuZGVuY2llczogWydtYXRlcmlhbHMnXSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5wcmVsb2FkTWluZUVudk1hcHMoKTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5wcmVsb2FkQXRsYXMoKTtcbiAgICAgIHRoaXMucHJlbG9hZExvZ28oKTtcbiAgICAgIC8vdGhpcy5wcmVsb2RCZWFtTWFwKCk7XG4gICAgICB0aGlzLnByZWxvYWRCZWF0RW52TWFwKCk7XG4gICAgICB0aGlzLnByZWxvYWRDdXRQYXJ0aWNsZXMoKTtcbiAgICAgIHRoaXMucHJlbG9hZEtleWJvYXJkKCk7XG4gICAgICAvL3RoaXMucHJlbG9hZE1pc3NNYXAoKTtcbiAgICAgIHRoaXMucHJlbG9hZFBsYXlCdXR0b24oKTtcbiAgICAgIHRoaXMucHJlbG9hZFNlYXJjaFByZXZQYWdlKCk7XG4gICAgICAvL3RoaXMucHJlbG9hZFdhbGxNYXAoKTtcbiAgICAgIC8vdGhpcy5wcmVsb2FkV3JvbmdNYXAoKTtcbiAgICAgIHRoaXMucHJlbG9hZEdlbnJlcygpO1xuICAgIH0sIDEwMDApO1xuICB9LFxuXG4gIHByZWxvYWRBdGxhczogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHN0YWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0YWdlT2JqJyk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShzdGFnZS5nZXRPYmplY3QzRCgnbWVzaCcpLmNoaWxkcmVuWzBdLm1hdGVyaWFsLnVuaWZvcm1zLnNyYy52YWx1ZSk7XG4gIH0sXG5cbiAgcHJlbG9hZExvZ286IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBsb2dvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xvZ29Cb2R5Jyk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShsb2dvLmdldE9iamVjdDNEKCdtZXNoJykuY2hpbGRyZW5bMF0ubWF0ZXJpYWwudW5pZm9ybXMuc3JjLnZhbHVlKTtcbiAgfSxcblxuICBwcmVsb2FkQmVhbU1hcDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGJlYW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2JlYW1zXScpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUoYmVhbXMuY29tcG9uZW50cy5iZWFtcy50ZXh0dXJlKTtcbiAgfSxcblxuICBwcmVsb2FkQmVhdEVudk1hcDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGJlYXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYmVhdENvbnRhaW5lciBbbWl4aW5+PVwiYmVhdFwiXScpO1xuICAgIGJlYXQub2JqZWN0M0QudHJhdmVyc2Uobm9kZSA9PiB7XG4gICAgICBpZiAoIW5vZGUubWF0ZXJpYWwpIHsgcmV0dXJuOyB9XG4gICAgICBpZiAobm9kZS5tYXRlcmlhbC5lbnZNYXApIHtcbiAgICAgICAgdGhpcy5wcmVsb2FkVGV4dHVyZShub2RlLm1hdGVyaWFsLmVudk1hcCk7XG4gICAgICB9XG4gICAgICBpZiAobm9kZS5tYXRlcmlhbC5tYXApIHtcbiAgICAgICAgdGhpcy5wcmVsb2FkVGV4dHVyZShub2RlLm1hdGVyaWFsLm1hcCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgcHJlbG9hZEN1dFBhcnRpY2xlczogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHBhcnRpY2xlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzYWJlclBhcnRpY2xlcycpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUocGFydGljbGVzLmNvbXBvbmVudHMucGFydGljbGVwbGF5ZXIubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkS2V5Ym9hcmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBrZXlib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXlib2FyZCcpLmNvbXBvbmVudHNbJ3N1cGVyLWtleWJvYXJkJ107XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShrZXlib2FyZC5rYkltZy5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm1hcCk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShrZXlib2FyZC5rZXlDb2xvclBsYW5lLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkTWluZUVudk1hcHM6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBzdGFnZUNvbG9ycyA9IHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzWydzdGFnZS1jb2xvcnMnXTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignbWluZXJlZGVudm1hcGxvYWRlZCcsICgpID0+IHtcbiAgICAgIHRoaXMucHJlbG9hZFRleHR1cmUoc3RhZ2VDb2xvcnMubWluZUVudk1hcC5yZWQpO1xuICAgIH0pO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5hZGRFdmVudExpc3RlbmVyKCdtaW5lYmx1ZWVudm1hcGxvYWRlZCcsICgpID0+IHtcbiAgICAgIHRoaXMucHJlbG9hZFRleHR1cmUoc3RhZ2VDb2xvcnMubWluZUVudk1hcC5ibHVlKTtcbiAgICB9KTtcbiAgfSxcblxuICBwcmVsb2FkTWlzc01hcDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IG1pc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWlzc0xlZnQnKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKG1pc3MuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5tYXApO1xuICB9LFxuXG4gIHByZWxvYWRQbGF5QnV0dG9uOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgcGxheUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwbGF5QnV0dG9uJyk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShwbGF5QnV0dG9uLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkU2VhcmNoUHJldlBhZ2UgOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgcHJldlBhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2VhcmNoUHJldlBhZ2UnKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKHByZXZQYWdlLmNoaWxkcmVuWzBdLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkV2FsbE1hcDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdhLWVudGl0eVt3YWxsXScpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUod2FsbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLnVuaWZvcm1zLnRleC52YWx1ZSk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZSh3YWxsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwudW5pZm9ybXMuZW52LnZhbHVlKTtcbiAgfSxcblxuICBwcmVsb2FkV3JvbmdNYXA6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB3cm9uZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN3cm9uZ0xlZnQnKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKHdyb25nLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkR2VucmVzOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZ2VucmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdlbnJlSWNvbicpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUoZ2VucmVzLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkVGV4dHVyZTogZnVuY3Rpb24gKHRleHR1cmUpIHtcbiAgICBpZiAoIXRleHR1cmUgfHwgIXRleHR1cmUuaW1hZ2UpIHtcbiAgICAgIGNvbnNvbGUud2FybignW2dwdS1wcmVsb2FkZXJdIEVycm9yIHByZWxvYWRpbmcgdGV4dHVyZScsIHRleHR1cmUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRleHR1cmUuaW1hZ2UuY29tcGxldGUpIHtcbiAgICAgIGNvbnNvbGUud2FybignW2dwdS1wcmVsb2FkZXJdIEVycm9yIHByZWxvYWRpbmcsIGltYWdlIG5vdCBsb2FkZWQnLCB0ZXh0dXJlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5lbC5yZW5kZXJlci5zZXRUZXh0dXJlMkQodGV4dHVyZSwgaSsrICUgOCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvZ3B1LXByZWxvYWRlci5qcyIsImNvbnN0IGV2ZW50cyA9IFtcbiAgJ3RyaWdnZXJkb3duJyxcbiAgJ2dyaXBkb3duJyxcbiAgJ2FidXR0b25kb3duJyxcbiAgJ2JidXR0b25kb3duJyxcbiAgJ3hidXR0b25kb3duJyxcbiAgJ3lidXR0b25kb3duJyxcbiAgJ3RyYWNrcGFkZG93bidcbl07XG5cbi8qKlxuICogU3dhcCBsZWZ0IG9yIHJpZ2h0LWhhbmRlZCBtb2RlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2hhbmQtc3dhcHBlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnN3YXBIYW5kID0gdGhpcy5zd2FwSGFuZC5iaW5kKHRoaXMpO1xuICAgIGV2ZW50cy5mb3JFYWNoKGV2ZW50ID0+IHtcbiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5zd2FwSGFuZCk7XG4gICAgfSk7XG4gIH0sXG5cbiAgc3dhcEhhbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuXG4gICAgLy8gSGFuZGxlZCB2aWEgc3RhdGUuXG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ2FjdGl2ZWhhbmRzd2FwJywgbnVsbCwgZmFsc2UpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2hhbmQtc3dhcHBlci5qcyIsIi8qKlxuICogSGFwdGljcyB3aGVuIHNhYmVycyBjb2xsaWRlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2hhcHRpY3Mtc2FiZXInLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG5cbiAgICB0aGlzLmlzQ29sbGlkaW5nID0gZmFsc2U7XG4gICAgdGhpcy50aWNrID0gQUZSQU1FLnV0aWxzLnRocm90dGxlVGljayh0aGlzLnRpY2suYmluZCh0aGlzKSwgMTAwKTtcblxuICAgIGVsLnNldEF0dHJpYnV0ZSgnaGFwdGljc19fc2FiZXInLCB7ZHVyOiAxMDAsIGZvcmNlOiAwLjA3NX0pO1xuXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGV2dCA9PiB7XG4gICAgICBpZiAoIWV2dC5kZXRhaWwgfHwgIWV2dC5kZXRhaWwuaW50ZXJzZWN0ZWRFbCkgeyByZXR1cm47IH1cblxuICAgICAgY29uc3QgaW50ZXJzZWN0ZWRFbCA9IGV2dC5kZXRhaWwuaW50ZXJzZWN0ZWRFbDtcbiAgICAgIGlmICghaW50ZXJzZWN0ZWRFbC5jbGFzc0xpc3QuY29udGFpbnMoJ2JsYWRlJykgfHwgaW50ZXJzZWN0ZWRFbCA9PT0gZWwpIHtcbiAgICAgICAgdGhpcy5pc0NvbGxpZGluZyA9IGZhbHNlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaXNDb2xsaWRpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5lbC5jb21wb25lbnRzLmhhcHRpY3NfX3NhYmVyLnB1bHNlKCk7XG4gICAgfSk7XG5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgZXZ0ID0+IHtcbiAgICAgIHRoaXMuaXNDb2xsaWRpbmcgPSBmYWxzZTtcbiAgICB9KTtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzQ29sbGlkaW5nKSB7IHJldHVybjsgfVxuICAgIHRoaXMuZWwuY29tcG9uZW50cy5oYXB0aWNzX19zYWJlci5wdWxzZSgpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2hhcHRpY3Mtc2FiZXIuanMiLCIvKipcbiAqIExpc3RlbiB0byBhYWJiLWNvbGxpZGVyIGV2ZW50IGZvciB3YWxsIGhhcHRpY3MuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnaGFwdGljcy13YWxsJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIHRoaXMuaXNIaXR0aW5nV2FsbCA9IGZhbHNlO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnaGFwdGljc19fd2FsbCcsIHtkdXI6IDUwLCBmb3JjZTogMC4wNzV9KTtcblxuICAgIHRoaXMuY2hlY2tJZkhpdHRpbmdXYWxsID0gdGhpcy5jaGVja0lmSGl0dGluZ1dhbGwuYmluZCh0aGlzKTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgdGhpcy5jaGVja0lmSGl0dGluZ1dhbGwpO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLmNoZWNrSWZIaXR0aW5nV2FsbCk7XG5cbiAgICB0aGlzLnRpY2sgPSBBRlJBTUUudXRpbHMudGhyb3R0bGVUaWNrKHRoaXMudGljay5iaW5kKHRoaXMpLCA1MCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIE9uIHJheWNhc3RlciBldmVudCwgY2hlY2sgaWYgd2UgYXJlIHN0aWxsIGhpdHRpbmcgYSB3YWxsLlxuICAgKi9cbiAgY2hlY2tJZkhpdHRpbmdXYWxsOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgaW50ZXJzZWN0ZWRFbHMgPSB0aGlzLmVsLmNvbXBvbmVudHMucmF5Y2FzdGVyX19nYW1lLmludGVyc2VjdGVkRWxzO1xuICAgIHRoaXMuaXNIaXR0aW5nV2FsbCA9IGZhbHNlO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW50ZXJzZWN0ZWRFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChpbnRlcnNlY3RlZEVsc1tpXS5jb21wb25lbnRzLndhbGwpIHtcbiAgICAgICAgdGhpcy5pc0hpdHRpbmdXYWxsID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzSGl0dGluZ1dhbGwpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5jb21wb25lbnRzLmhhcHRpY3NfX3dhbGwucHVsc2UoKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9oYXB0aWNzLXdhbGwuanMiLCIvKipcbiAqIFVwZGF0ZSB3aW5kb3cgdGl0bGUgYW5kIGhpc3RvcnkuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnaGlzdG9yeScsIHtcbiAgc2NoZW1hOiB7XG4gICAgY2hhbGxlbmdlSWQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgc29uZ05hbWU6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgc29uZ1N1Yk5hbWU6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGhpc3RvcnkucHVzaFN0YXRlKFxuICAgICAgJycsXG4gICAgICBkYXRhLnNvbmdOYW1lLFxuICAgICAgdXBkYXRlUXVlcnlQYXJhbSh3aW5kb3cubG9jYXRpb24uaHJlZiwgJ2NoYWxsZW5nZScsIGRhdGEuY2hhbGxlbmdlSWQpXG4gICAgKTtcbiAgICBkb2N1bWVudC50aXRsZSA9IGBTdXBlciBTYWJlciAtICR7ZGF0YS5zb25nTmFtZX1gO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2hpc3RvcnkuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2ludHJvLXNvbmcnLCB7XG4gIHNjaGVtYToge1xuICAgIGlzUGxheWluZzoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGlzU2VhcmNoaW5nOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYW5hbHlzZXJFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdWRpb0FuYWx5c2VyJyk7XG4gICAgdGhpcy5hdWRpbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRyb1NvbmcnKTtcbiAgICB0aGlzLnRpbWVvdXQgPSBudWxsO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICBjb25zdCBhdWRpbyA9IHRoaXMuYXVkaW87XG5cbiAgICBpZiAoIXRoaXMuZWwuc2NlbmVFbC5pc1BsYXlpbmcpIHsgcmV0dXJuOyB9XG5cbiAgICBpZiAoIW9sZERhdGEuaXNTZWFyY2hpbmcgJiYgdGhpcy5kYXRhLmlzU2VhcmNoaW5nKSB7IHJldHVybjsgfVxuXG4gICAgLy8gUGxheS5cbiAgICBpZiAoIW9sZERhdGEuaXNQbGF5aW5nICYmIHRoaXMuZGF0YS5pc1BsYXlpbmcpIHtcbiAgICAgIHRoaXMuYW5hbHlzZXJFbC5jb21wb25lbnRzLmF1ZGlvYW5hbHlzZXIucmVzdW1lQ29udGV4dCgpO1xuICAgICAgdGhpcy5hbmFseXNlckVsLnNldEF0dHJpYnV0ZSgnYXVkaW9hbmFseXNlcicsICdzcmMnLCBhdWRpbyk7XG4gICAgICB0aGlzLmZhZGVJbkF1ZGlvKCk7XG4gICAgfVxuXG4gICAgLy8gUGF1c2UuXG4gICAgaWYgKG9sZERhdGEuaXNQbGF5aW5nICYmICF0aGlzLmRhdGEuaXNQbGF5aW5nKSB7IGF1ZGlvLnBhdXNlKCk7IH1cbiAgfSxcblxuICBwYXVzZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYXVkaW8ucGF1c2UoKTtcbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mYWRlSW5BdWRpbygpO1xuICB9LFxuXG4gIGZhZGVJbkF1ZGlvOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ211dGUnKSkgeyByZXR1cm47IH1cbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5hbmFseXNlckVsLmNvbXBvbmVudHMuYXVkaW9hbmFseXNlci5jb250ZXh0O1xuICAgIGNvbnN0IGdhaW5Ob2RlID0gdGhpcy5hbmFseXNlckVsLmNvbXBvbmVudHMuYXVkaW9hbmFseXNlci5nYWluTm9kZTtcbiAgICBnYWluTm9kZS5nYWluLnNldFZhbHVlQXRUaW1lKDAsIGNvbnRleHQuY3VycmVudFRpbWUpO1xuICAgIHRoaXMuYXVkaW8ucGxheSgpO1xuICAgIGdhaW5Ob2RlLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoMC41LCBjb250ZXh0LmN1cnJlbnRUaW1lICsgMC41KTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9pbnRyby1zb25nLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdrZXlib2FyZC1yYXljYXN0YWJsZScsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ3N1cGVyLWtleWJvYXJkJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgY29uZGl0aW9uOiB7ZGVmYXVsdDogJyd9XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuY29tcG9uZW50c1snc3VwZXIta2V5Ym9hcmQnXS5rYkltZy5zZXRBdHRyaWJ1dGUoJ2JpbmQtdG9nZ2xlX19yYXljYXN0YWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuY29uZGl0aW9uKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9rZXlib2FyZC1yYXljYXN0YWJsZS5qcyIsImNvbnN0IGZpcmViYXNlID0gcmVxdWlyZSgnZmlyZWJhc2UvYXBwJyk7XG5yZXF1aXJlKCdmaXJlYmFzZS9maXJlc3RvcmUnKTtcblxuY29uc3QgTlVNX1NDT1JFU19ESVNQTEFZRUQgPSAxMDtcblxuLyoqXG4gKiBIaWdoIHNjb3JlIHdpdGggRmlyZWJhc2UgY2xvdWQgc3RvcmUuXG4gKiBJbmRleDogY2hhbGxlbmdlSWQgQVNDIGRpZmZpY3VsdHkgQVNDIHNjb3JlIERFU0MgdGltZSBBU0NcbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdsZWFkZXJib2FyZCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgYXBpS2V5OiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIGF1dGhEb21haW46IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgZGF0YWJhc2VVUkw6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgcHJvamVjdElkOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIHN0b3JhZ2VCdWNrZXQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgbWVzc2FnaW5nU2VuZGVySWQ6IHt0eXBlOiAnc3RyaW5nJ30sXG5cbiAgICBjaGFsbGVuZ2VJZDoge2RlZmF1bHQ6ICcnfSxcbiAgICBtZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZDoge2RlZmF1bHQ6ICcnfSxcbiAgICBpc1ZpY3Rvcnk6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5xdWFsaWZ5aW5nSW5kZXggPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zY29yZXMgPSBbXTtcbiAgICB0aGlzLmV2ZW50RGV0YWlsID0ge3Njb3JlczogdGhpcy5zY29yZXN9O1xuICAgIHRoaXMuYWRkRXZlbnREZXRhaWwgPSB7c2NvcmVEYXRhOiB1bmRlZmluZWQsIGluZGV4OiB1bmRlZmluZWR9O1xuXG4gICAgdGhpcy51c2VybmFtZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzdXBlcnNhYmVydXNlcm5hbWUnKSB8fCAnU3VwZXIgWmVhbG90JztcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2xlYWRlcmJvYXJkdXNlcm5hbWUnLCBldnQgPT4ge1xuICAgICAgdGhpcy51c2VybmFtZSA9IGV2dC5kZXRhaWwudmFsdWU7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc3VwZXJzYWJlcnVzZXJuYW1lJywgdGhpcy51c2VybmFtZSk7XG4gICAgfSk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdsZWFkZXJib2FyZHN1Ym1pdCcsIHRoaXMuYWRkU2NvcmUuYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIC8vIEluaXRpYWxpemUgQ2xvdWQgRmlyZXN0b3JlIHRocm91Z2ggRmlyZWJhc2UuXG4gICAgaWYgKCFmaXJlYmFzZS5hcHBzLmxlbmd0aCAmJiB0aGlzLmRhdGEuYXBpS2V5KSB7XG4gICAgICBmaXJlYmFzZS5pbml0aWFsaXplQXBwKHtcbiAgICAgICAgYXBpS2V5OiB0aGlzLmRhdGEuYXBpS2V5LFxuICAgICAgICBhdXRoRG9tYWluOiB0aGlzLmRhdGEuYXV0aERvbWFpbixcbiAgICAgICAgZGF0YWJhc2VVUkw6IHRoaXMuZGF0YS5kYXRhYmFzZVVSTCxcbiAgICAgICAgcHJvamVjdElkOiB0aGlzLmRhdGEucHJvamVjdElkLFxuICAgICAgICBzdG9yYWdlQnVja2V0OiB0aGlzLmRhdGEuc3RvcmFnZUJ1Y2tldCxcbiAgICAgICAgbWVzc2FnaW5nU2VuZGVySWQ6IHRoaXMuZGF0YS5tZXNzYWdpbmdTZW5kZXJJZFxuICAgICAgfSk7XG4gICAgICB0aGlzLmZpcmVzdG9yZSA9IGZpcmViYXNlLmZpcmVzdG9yZSgpO1xuICAgICAgdGhpcy5maXJlc3RvcmUuc2V0dGluZ3Moe3RpbWVzdGFtcHNJblNuYXBzaG90czogdHJ1ZX0pO1xuICAgICAgdGhpcy5kYiA9IHRoaXMuZmlyZXN0b3JlLmNvbGxlY3Rpb24oJ3Njb3JlcycpO1xuICAgIH1cblxuICAgIGlmICghb2xkRGF0YS5pc1ZpY3RvcnkgJiYgdGhpcy5kYXRhLmlzVmljdG9yeSkge1xuICAgICAgdGhpcy5jaGVja0xlYWRlcmJvYXJkUXVhbGlmeSgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgJiZcbiAgICAgICAgb2xkRGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCAhPT0gdGhpcy5kYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkKSB7XG4gICAgICB0aGlzLmZldGNoU2NvcmVzKHRoaXMuZGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS5jaGFsbGVuZ2VJZCAmJiBvbGREYXRhLmNoYWxsZW5nZUlkICE9PSB0aGlzLmRhdGEuY2hhbGxlbmdlSWQpIHtcbiAgICAgIHRoaXMuZmV0Y2hTY29yZXModGhpcy5kYXRhLmNoYWxsZW5nZUlkKTtcbiAgICB9XG4gIH0sXG5cbiAgYWRkU2NvcmU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBzdGF0ZSA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlLnN0YXRlO1xuICAgIGlmICghc3RhdGUuaXNWaWN0b3J5KSB7IHJldHVybjsgfVxuICAgIGNvbnN0IHNjb3JlRGF0YSA9IHtcbiAgICAgIGFjY3VyYWN5OiBzdGF0ZS5zY29yZS5hY2N1cmFjeSxcbiAgICAgIGNoYWxsZW5nZUlkOiBzdGF0ZS5jaGFsbGVuZ2UuaWQsXG4gICAgICBzY29yZTogc3RhdGUuc2NvcmUuc2NvcmUsXG4gICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSxcbiAgICAgIGRpZmZpY3VsdHk6IHN0YXRlLmNoYWxsZW5nZS5kaWZmaWN1bHR5LFxuICAgICAgdGltZTogbmV3IERhdGUoKVxuICAgIH07XG4gICAgdGhpcy5kYi5hZGQoc2NvcmVEYXRhKTtcbiAgICB0aGlzLmFkZEV2ZW50RGV0YWlsLnNjb3JlRGF0YSA9IHNjb3JlRGF0YTtcbiAgICB0aGlzLmVsLmVtaXQoJ2xlYWRlcmJvYXJkc2NvcmVhZGRlZCcsIHRoaXMuYWRkRXZlbnREZXRhaWwsIGZhbHNlKTtcbiAgfSxcblxuICBmZXRjaFNjb3JlczogZnVuY3Rpb24gKGNoYWxsZW5nZUlkKSB7XG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZS5zdGF0ZTtcbiAgICBjb25zdCBxdWVyeSA9IHRoaXMuZGJcbiAgICAgIC53aGVyZSgnY2hhbGxlbmdlSWQnLCAnPT0nLCBjaGFsbGVuZ2VJZClcbiAgICAgIC53aGVyZShcbiAgICAgICAgJ2RpZmZpY3VsdHknLCAnPT0nLFxuICAgICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaWRcbiAgICAgICAgICA/IHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5kaWZmaWN1bHR5XG4gICAgICAgICAgOiBzdGF0ZS5jaGFsbGVuZ2UuZGlmZmljdWx0eSlcbiAgICAgIC5vcmRlckJ5KCdzY29yZScsICdkZXNjJylcbiAgICAgIC5vcmRlckJ5KCd0aW1lJywgJ2FzYycpXG4gICAgICAubGltaXQoMTApO1xuICAgIHF1ZXJ5LmdldCgpLnRoZW4oc25hcHNob3QgPT4ge1xuICAgICAgdGhpcy5ldmVudERldGFpbC5jaGFsbGVuZ2VJZCA9IGNoYWxsZW5nZUlkO1xuICAgICAgdGhpcy5zY29yZXMubGVuZ3RoID0gMDtcbiAgICAgIGlmICghc25hcHNob3QuZW1wdHkpIHtcbiAgICAgICAgc25hcHNob3QuZm9yRWFjaChzY29yZSA9PiB0aGlzLnNjb3Jlcy5wdXNoKHNjb3JlLmRhdGEoKSkpO1xuICAgICAgfVxuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ2xlYWRlcmJvYXJkJywgdGhpcy5ldmVudERldGFpbCwgZmFsc2UpO1xuICAgIH0pLmNhdGNoKGUgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcignW2ZpcmVzdG9yZV0nLCBlKTtcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogSXMgaGlnaCBzY29yZT9cbiAgICovXG4gIGNoZWNrTGVhZGVyYm9hcmRRdWFsaWZ5OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZS5zdGF0ZTtcbiAgICBjb25zdCBzY29yZSA9IHN0YXRlLnNjb3JlLnNjb3JlO1xuXG4gICAgLy8gSWYgbGVzcyB0aGFuIDEwLCB0aGVuIGF1dG9tYXRpYyBoaWdoIHNjb3JlLlxuICAgIGlmICh0aGlzLnNjb3Jlcy5sZW5ndGggPCBOVU1fU0NPUkVTX0RJU1BMQVlFRCkge1xuICAgICAgdGhpcy5xdWFsaWZ5aW5nSW5kZXggPSB0aGlzLnNjb3Jlcy5sZW5ndGg7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbGVhZGVyYm9hcmRxdWFsaWZ5JywgdGhpcy5zY29yZXMubGVuZ3RoLCBmYWxzZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgb3ZlcnRvb2sgYW55IGV4aXN0aW5nIGhpZ2ggc2NvcmUuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNjb3Jlcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHNjb3JlID4gdGhpcy5zY29yZXNbaV0uc2NvcmUpIHtcbiAgICAgICAgdGhpcy5xdWFsaWZ5aW5nSW5kZXggPSBpO1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbGVhZGVyYm9hcmRxdWFsaWZ5JywgaSwgZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2xlYWRlcmJvYXJkLmpzIiwidmFyIE9OQ0UgPSB7b25jZTogdHJ1ZX07XG5cbi8qKlxuICogRGVsYXkgbG9nbyBsaWdodCBzbyBpdCBvbmx5IGFwcGxpZXMgdG8gdGhlIGxvZ28uXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbG9nby1saWdodCcsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubG9nb0JhY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nb0JhY2snKTtcbiAgICB0aGlzLmxvZ29Gcm9udCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvRnJvbnQnKTtcbiAgICB0aGlzLmxvZ29Gcm9udFUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nb0Zyb250VScpO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdsaWdodCcsIHtcbiAgICAgICAgdHlwZTogJ3Nwb3QnLFxuICAgICAgICBwZW51bWJyYTogMSxcbiAgICAgICAgaW50ZW5zaXR5OiA1LFxuICAgICAgICBhbmdsZTogMjBcbiAgICAgIH0pO1xuICAgICAgdGhpcy53YWl0QW5kVXBkYXRlKHRoaXMubG9nb0JhY2spO1xuICAgICAgdGhpcy53YWl0QW5kVXBkYXRlKHRoaXMubG9nb0Zyb250KTtcbiAgICAgIHRoaXMud2FpdEFuZFVwZGF0ZSh0aGlzLmxvZ29Gcm9udFUpO1xuICAgIH0sIDEwMDApO1xuICB9LFxuXG4gIHdhaXRBbmRVcGRhdGU6IGZ1bmN0aW9uIChlbCkge1xuICAgIGlmIChlbC5nZXRPYmplY3QzRCgnbWVzaCcpKSB7XG4gICAgICBlbC5vYmplY3QzRC50cmF2ZXJzZSh0aGlzLnVwZGF0ZU1hdGVyaWFscyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vZGVsLWxvYWRlZCcsICgpID0+IHtcbiAgICAgICAgZWwub2JqZWN0M0QudHJhdmVyc2UodGhpcy51cGRhdGVNYXRlcmlhbHMpO1xuICAgICAgfSwgT05DRSk7XG4gICAgfVxuICB9LFxuXG4gIHVwZGF0ZU1hdGVyaWFsczogZnVuY3Rpb24gKG5vZGUpIHtcbiAgICBpZiAobm9kZS5tYXRlcmlhbCkge1xuICAgICAgbm9kZS5tYXRlcmlhbC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2xvZ28tbGlnaHQuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2xvZ29mbGlja2VyJywge1xuICBzY2hlbWE6IHtcbiAgICBkZWxheToge2RlZmF1bHQ6IDEwMDAuMH0sXG4gICAgYWN0aXZlOiB7ZGVmYXVsdDogdHJ1ZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zZXRPZmYgPSB0aGlzLnNldE9mZi5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc2V0T24gPSB0aGlzLnNldE9uLmJpbmQodGhpcyk7XG4gICAgdGhpcy50aW1lb3V0ID0gMDtcblxuICAgIHRoaXMuc3BhcmtzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ29zcGFya3MnKTtcbiAgICB0aGlzLnNwYXJrUG9zaXRpb25zID0gW1xuICAgICAge3Bvc2l0aW9uOiBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLjEwLCAwKX0sXG4gICAgICB7cG9zaXRpb246IG5ldyBUSFJFRS5WZWN0b3IzKDAuMywgMC44LCAwKX0sXG4gICAgICB7cG9zaXRpb246IG5ldyBUSFJFRS5WZWN0b3IzKC0wLjMsIDAuOCwgMCl9XG4gICAgXTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgaWYgKHRoaXMuZGF0YS5hY3RpdmUgIT09IG9sZERhdGEuYWN0aXZlKSB7XG4gICAgICBpZiAodGhpcy5kYXRhLmFjdGl2ZSkge1xuICAgICAgICB0aGlzLnNldE9uKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgc2V0T2ZmOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5zcGFya3MuZW1pdCgnbG9nb2ZsaWNrZXInLFxuICAgICAgdGhpcy5zcGFya1Bvc2l0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLnNwYXJrUG9zaXRpb25zLmxlbmd0aCldLFxuICAgICAgZmFsc2UpO1xuXG4gICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCh0aGlzLnNldE9uLCA1MCk7XG4gIH0sXG5cbiAgc2V0T246IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQodGhpcy5zZXRPZmYsXG4gICAgICAgICAgICAgICBNYXRoLmZsb29yKCh0aGlzLmRhdGEuZGVsYXkgKiAzIC8gMTApICsgTWF0aC5yYW5kb20oKSAqIHRoaXMuZGF0YS5kZWxheSkpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2xvZ29mbGlja2VyLmpzIiwiY29uc3QgQ09MT1JTID0gcmVxdWlyZSgnLi4vY29uc3RhbnRzL2NvbG9ycy5qcycpO1xuY29uc3QgZmxhdFNoYWRlcnMgPSByZXF1aXJlKCcuLi8uLi9hc3NldHMvc2hhZGVycy9mbGF0LmpzJyk7XG5jb25zdCBzdGFnZUFkZGl0aXZlU2hhZGVycyA9IHJlcXVpcmUoJy4uLy4uL2Fzc2V0cy9zaGFkZXJzL3N0YWdlQWRkaXRpdmUuanMnKTtcbmNvbnN0IHN0YWdlTm9ybWFsU2hhZGVycyA9IHJlcXVpcmUoJy4uLy4uL2Fzc2V0cy9zaGFkZXJzL3N0YWdlTm9ybWFsLmpzJyk7XG5cbkFGUkFNRS5yZWdpc3RlclN5c3RlbSgnbWF0ZXJpYWxzJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdsb2FkaW5nJykge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIHRoaXMuY3JlYXRlTWF0ZXJpYWxzLmJpbmQodGhpcykpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNyZWF0ZU1hdGVyaWFscygpO1xuICAgIH1cbiAgfSxcblxuICBjcmVhdGVNYXRlcmlhbHM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnN0YWdlTm9ybWFsID0gbmV3IFRIUkVFLlNoYWRlck1hdGVyaWFsKHtcbiAgICAgIHVuaWZvcm1zOiB7XG4gICAgICAgIHNreUNvbG9yOiB7dmFsdWU6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuU0tZX0JMVUUpfSxcbiAgICAgICAgYmFja2dsb3dDb2xvcjoge3ZhbHVlOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLkJHX0JMVUUpfSxcbiAgICAgICAgc3JjOiB7XG4gICAgICAgICAgdmFsdWU6IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXRsYXNJbWcnKS5zcmMpXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgdmVydGV4U2hhZGVyOiBzdGFnZU5vcm1hbFNoYWRlcnMudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IHN0YWdlTm9ybWFsU2hhZGVycy5mcmFnbWVudFNoYWRlcixcbiAgICAgIGZvZzogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5zdGFnZUFkZGl0aXZlID0gbmV3IFRIUkVFLlNoYWRlck1hdGVyaWFsKHtcbiAgICAgIHVuaWZvcm1zOiB7XG4gICAgICAgIHR1bm5lbE5lb246IHt2YWx1ZTogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5ORU9OX1JFRCl9LFxuICAgICAgICBmbG9vck5lb246IHt2YWx1ZTogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5ORU9OX1JFRCl9LFxuICAgICAgICBsZWZ0TGFzZXI6IHt2YWx1ZTogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5ORU9OX0JMVUUpfSxcbiAgICAgICAgcmlnaHRMYXNlcjoge3ZhbHVlOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk5FT05fQkxVRSl9LFxuICAgICAgICB0ZXh0R2xvdzoge3ZhbHVlOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLlRFWFRfT0ZGKX0sXG4gICAgICAgIHNyYzoge1xuICAgICAgICAgIHZhbHVlOiBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F0bGFzSW1nJykuc3JjKVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHZlcnRleFNoYWRlcjogc3RhZ2VBZGRpdGl2ZVNoYWRlcnMudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IHN0YWdlQWRkaXRpdmVTaGFkZXJzLmZyYWdtZW50U2hhZGVyLFxuICAgICAgYmxlbmRpbmc6IFRIUkVFLkFkZGl0aXZlQmxlbmRpbmcsXG4gICAgICBmb2c6IGZhbHNlLFxuICAgICAgdHJhbnNwYXJlbnQ6IHRydWVcbiAgICB9KTtcblxuICAgIHRoaXMubG9nbyA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCh7XG4gICAgICB1bmlmb3Jtczoge1xuICAgICAgICBzcmM6IHtcbiAgICAgICAgICB2YWx1ZTogbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvdGV4SW1nJykuc3JjKVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHZlcnRleFNoYWRlcjogZmxhdFNoYWRlcnMudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IGZsYXRTaGFkZXJzLmZyYWdtZW50U2hhZGVyLFxuICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgIGZvZzogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5sb2dvYWRkaXRpdmUgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoe1xuICAgICAgdW5pZm9ybXM6IHtcbiAgICAgICAgc3JjOiB7XG4gICAgICAgICAgdmFsdWU6IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nb3RleEltZycpLnNyYylcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB2ZXJ0ZXhTaGFkZXI6IGZsYXRTaGFkZXJzLnZlcnRleFNoYWRlcixcbiAgICAgIGZyYWdtZW50U2hhZGVyOiBmbGF0U2hhZGVycy5mcmFnbWVudFNoYWRlcixcbiAgICAgIGRlcHRoVGVzdDogZmFsc2UsXG4gICAgICBibGVuZGluZzogVEhSRUUuQWRkaXRpdmVCbGVuZGluZyxcbiAgICAgIGZvZzogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5taW5lTWF0ZXJpYWxyZWQgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoe1xuICAgICAgcm91Z2huZXNzOiAwLjM4LFxuICAgICAgbWV0YWxuZXNzOiAwLjQ4LFxuICAgICAgY29sb3I6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuTUlORV9SRUQpLFxuICAgICAgZW1pc3NpdmU6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuTUlORV9SRURfRU1JU1NJT04pLFxuICAgICAgZW52TWFwOiBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoJ2Fzc2V0cy9pbWcvbWluZWVudmlyby1yZWQuanBnJylcbiAgICB9KTtcblxuICAgIHRoaXMubWluZU1hdGVyaWFsYmx1ZSA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7XG4gICAgICByb3VnaG5lc3M6IDAuMzgsXG4gICAgICBtZXRhbG5lc3M6IDAuNDgsXG4gICAgICBjb2xvcjogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5NSU5FX0JMVUUpLFxuICAgICAgZW1pc3NpdmU6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuTUlORV9CTFVFX0VNSVNTSU9OKSxcbiAgICAgIGVudk1hcDogbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKCdhc3NldHMvaW1nL21pbmVlbnZpcm8tYmx1ZS5qcGcnKVxuICAgIH0pO1xuXG4gIH1cbn0pO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ21hdGVyaWFscycsIHtcbiAgc2NoZW1hOiB7XG4gICAgbmFtZTogeyBkZWZhdWx0OiAnJ30sXG4gICAgcmVjdXJzaXZlOiB7IGRlZmF1bHQ6IHRydWV9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuZGF0YS5uYW1lID09PSAnJykgeyByZXR1cm47IH1cblxuICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5zeXN0ZW1bdGhpcy5kYXRhLm5hbWVdO1xuICAgIGlmICghbWF0ZXJpYWwpIHtcbiAgICAgIGNvbnNvbGUud2FybihgdW5kZWZpbmVkIG1hdGVyaWFsIFwiJHt0aGlzLnN5c3RlbVt0aGlzLmRhdGEubmFtZV19XCJgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBtZXNoID0gdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpO1xuICAgIGlmICghbWVzaCkge1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb2RlbC1sb2FkZWQnLCB0aGlzLmFwcGx5TWF0ZXJpYWwuYmluZCh0aGlzKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYXBwbHlNYXRlcmlhbChtZXNoKTtcbiAgICB9XG4gIH0sXG5cbiAgYXBwbHlNYXRlcmlhbDogZnVuY3Rpb24gKG9iaikge1xuICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5zeXN0ZW1bdGhpcy5kYXRhLm5hbWVdO1xuICAgIGlmIChvYmpbJ2RldGFpbCddKSB7IG9iaiA9IG9iai5kZXRhaWwubW9kZWw7IH1cbiAgICBpZiAodGhpcy5kYXRhLnJlY3Vyc2l2ZSkge1xuICAgICAgb2JqLnRyYXZlcnNlKG8gPT4ge1xuICAgICAgICBpZiAoby50eXBlID09PSAnTWVzaCcpIHtcbiAgICAgICAgICBvLm1hdGVyaWFsID0gbWF0ZXJpYWw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBvYmoubWF0ZXJpYWwgPSBtYXRlcmlhbDtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbWF0ZXJpYWxzLmpzIiwidmFyIGhvdmVyZWRJbmRleDtcbnZhciBrZXlFdmVudHNSZWdpc3RlcmVkID0gZmFsc2U7XG52YXIgcmVzdWx0cyA9IG51bGw7XG5cbmNvbnN0IFBFUl9QQUdFID0gNjtcblxuLyoqXG4gKiBVc2UgbWVudSB3aXRoIHRodW1iLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ21lbnUtY29udHJvbHMnLCB7XG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBwYWdlOiB7ZGVmYXVsdDogMH0sXG4gICAgc2VsZWN0ZWRDaGFsbGVuZ2VJZDoge2RlZmF1bHQ6ICcnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG5cbiAgICByZXN1bHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaFJlc3VsdExpc3QnKS5jaGlsZHJlbjtcblxuICAgIHRoaXMuZ29QcmV2UmVzdWx0ID0gdGhpcy5nb1ByZXZSZXN1bHQuYmluZCh0aGlzKTtcbiAgICB0aGlzLmdvTmV4dFJlc3VsdCA9IHRoaXMuZ29OZXh0UmVzdWx0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZWxlY3QgPSB0aGlzLnNlbGVjdC5iaW5kKHRoaXMpO1xuICAgIHRoaXMudW5zZWxlY3QgPSB0aGlzLnVuc2VsZWN0LmJpbmQodGhpcyk7XG5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0aHVtYnVwc3RhcnQnLCB0aGlzLmdvUHJldlJlc3VsdCk7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigndGh1bWJkb3duc3RhcnQnLCB0aGlzLmdvTmV4dFJlc3VsdCk7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigndGh1bWJsZWZ0c3RhcnQnLCB0aGlzLnVuc2VsZWN0KTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0aHVtYnJpZ2h0c3RhcnQnLCB0aGlzLnNlbGVjdCk7XG5cbiAgICAvLyBXaGVuIHJheWNhc3RlciBiZWNvbWVzIGFjdGl2ZSBhZ2FpbiwgY2FuY2VsLlxuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBldnQgPT4ge1xuICAgICAgaWYgKCFlbC5jb21wb25lbnRzLmN1cnNvci5pbnRlcnNlY3RlZEVsKSB7IHJldHVybjsgfVxuICAgICAgaWYgKGVsLmNvbXBvbmVudHMuY3Vyc29yLmludGVyc2VjdGVkRWwuY2xvc2VzdCgnI3NlYXJjaFJlc3VsdExpc3QnKSkge1xuICAgICAgICB0aGlzLmNhbmNlbE1lbnVDb250cm9scygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2RlYnVnJykgJiYgIWtleUV2ZW50c1JlZ2lzdGVyZWQpIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXZ0ID0+IHtcbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSAzNykgeyB0aGlzLnVuc2VsZWN0KCk7IH1cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSAzOCkgeyB0aGlzLmdvUHJldlJlc3VsdCgpOyB9XG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gMzkpIHsgdGhpcy5zZWxlY3QoKTsgfVxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDQwKSB7IHRoaXMuZ29OZXh0UmVzdWx0KCk7IH1cbiAgICAgIH0pO1xuICAgICAga2V5RXZlbnRzUmVnaXN0ZXJlZCA9IHRydWU7XG4gICAgfVxuICB9LFxuXG4gIGdvUHJldlJlc3VsdDogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG5cbiAgICBpZiAoaG92ZXJlZEluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuaG92ZXJSZXN1bHQoMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChob3ZlcmVkSW5kZXggPiAwKSB7XG4gICAgICBpZiAocmVzdWx0c1tob3ZlcmVkSW5kZXggLSAxXS5kYXRhc2V0LmlkID09PSB0aGlzLmRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCkge1xuICAgICAgICBpZiAoaG92ZXJlZEluZGV4IC0gMiA8IDApIHtcbiAgICAgICAgICB0aGlzLmdvUHJldlBhZ2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmhvdmVyUmVzdWx0KGhvdmVyZWRJbmRleCAtIDIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhvdmVyUmVzdWx0KGhvdmVyZWRJbmRleCAtIDEpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmdvUHJldlBhZ2UoKTtcbiAgICB9XG4gIH0sXG5cbiAgZ29QcmV2UGFnZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaG92ZXJSZXN1bHQoUEVSX1BBR0UgLSAxKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc2VhcmNocHJldnBhZ2UnLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgZ29OZXh0UmVzdWx0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cblxuICAgIGlmIChob3ZlcmVkSW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ob3ZlclJlc3VsdCgwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGhvdmVyZWRJbmRleCA8IFBFUl9QQUdFIC0gMSkge1xuICAgICAgaWYgKHJlc3VsdHNbaG92ZXJlZEluZGV4ICsgMV0uZGF0YXNldC5pZCA9PT0gdGhpcy5kYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQpIHtcbiAgICAgICAgaWYgKGhvdmVyZWRJbmRleCArIDIgPiBQRVJfUEFHRSAtIDEpIHtcbiAgICAgICAgICB0aGlzLmdvTmV4dFBhZ2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmhvdmVyUmVzdWx0KGhvdmVyZWRJbmRleCArIDIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhvdmVyUmVzdWx0KGhvdmVyZWRJbmRleCArIDEpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmdvTmV4dFBhZ2UoKTtcbiAgICB9XG4gIH0sXG5cbiAgZ29OZXh0UGFnZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaG92ZXJSZXN1bHQoMCk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3NlYXJjaG5leHRwYWdlJywgbnVsbCwgZmFsc2UpO1xuICB9LFxuXG4gIHNlbGVjdDogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgaWYgKGhvdmVyZWRJbmRleCA9PT0gdW5kZWZpbmVkKSB7IHJldHVybjsgfVxuICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdtZW51Y2hhbGxlbmdlc2VsZWN0JywgcmVzdWx0c1tob3ZlcmVkSW5kZXhdLmRhdGFzZXQuaWQsIGZhbHNlKTtcbiAgfSxcblxuICB1bnNlbGVjdDogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgaWYgKHRoaXMuZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkKSB7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbWVudWNoYWxsZW5nZXVuc2VsZWN0JywgbnVsbCwgZmFsc2UpO1xuICAgIH1cbiAgfSxcblxuICBob3ZlclJlc3VsdDogZnVuY3Rpb24gKGkpIHtcbiAgICBpZiAoaG92ZXJlZEluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJlc3VsdHNbaG92ZXJlZEluZGV4XS5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoUmVzdWx0QmFja2dyb3VuZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAuZW1pdCgnbW91c2VsZWF2ZScsIG51bGwsIGZhbHNlKTtcbiAgICB9XG4gICAgaG92ZXJlZEluZGV4ID0gaTtcbiAgICByZXN1bHRzW2ldLnF1ZXJ5U2VsZWN0b3IoJy5zZWFyY2hSZXN1bHRCYWNrZ3JvdW5kJylcbiAgICAgICAgICAgICAgLmVtaXQoJ21vdXNlZW50ZXInLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgY2FuY2VsTWVudUNvbnRyb2xzOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGhvdmVyZWRJbmRleCA9PT0gdW5kZWZpbmVkKSB7IHJldHVybjsgfVxuICAgIHJlc3VsdHNbaG92ZXJlZEluZGV4XS5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoUmVzdWx0QmFja2dyb3VuZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgLmVtaXQoJ21vdXNlbGVhdmUnLCBudWxsLCBmYWxzZSk7XG4gICAgaG92ZXJlZEluZGV4ID0gdW5kZWZpbmVkO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL21lbnUtY29udHJvbHMuanMiLCJ2YXIgYmluZEV2ZW50ID0gcmVxdWlyZSgnYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMnKS5iaW5kRXZlbnQ7XG5cbi8qKlxuICogU2VsZWN0IGRpZmZpY3VsdHkuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbWVudS1kaWZmaWN1bHR5LXNlbGVjdCcsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuc2NlbmVFbC5hZGRFdmVudExpc3RlbmVyKCdtZW51Y2hhbGxlbmdlc2VsZWN0JywgKCkgPT4ge1xuICAgICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5lbC5jb21wb25lbnRzLmxheW91dC51cGRhdGUoKTtcbiAgICAgICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICAgIH0sIDE1MCk7XG4gICAgfSk7XG4gIH0sXG5cbiAgY2xpY2s6IGJpbmRFdmVudChmdW5jdGlvbiAoZXZ0KSB7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoXG4gICAgICAnbWVudWRpZmZpY3VsdHlzZWxlY3QnLFxuICAgICAgZXZ0LnRhcmdldC5jbG9zZXN0KCcuZGlmZmljdWx0eU9wdGlvbicpLmRhdGFzZXQuZGlmZmljdWx0eSxcbiAgICAgIGZhbHNlKTtcbiAgfSlcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbWVudS1kaWZmaWN1bHR5LXNlbGVjdC5qcyIsImltcG9ydCB1dGlscyBmcm9tICcuLi91dGlscyc7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbWVudS1zZWxlY3RlZC1jaGFsbGVuZ2UtaW1hZ2UnLCB7XG4gIHNjaGVtYToge1xuICAgIHNlbGVjdGVkQ2hhbGxlbmdlSWQ6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG4gICAgaWYgKCF0aGlzLmRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCkgeyByZXR1cm47IH1cbiAgICBlbC5zZXRBdHRyaWJ1dGUoXG4gICAgICAnbWF0ZXJpYWwnLCAnc3JjJyxcbiAgICAgIHV0aWxzLmdldFMzRmlsZVVybCh0aGlzLmRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCwgJ2ltYWdlLmpwZycpKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9tZW51LXNlbGVjdGVkLWNoYWxsZW5nZS1pbWFnZS5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbWVudS1zbGlkZS1hbmltYXRpb24nLCB7XG4gIHNjaGVtYToge1xuICAgIGlzU2VhcmNoaW5nOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIG1lbnVTZWxlY3RlZENoYWxsZW5nZUlkOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNMZWZ0ID0gZmFsc2U7ICAvLyBNZWFucyB0b2xlZnQuXG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICBpZiAodGhpcy5pc0xlZnQpIHtcbiAgICAgIC8vIFVuc2VsZWN0LlxuICAgICAgaWYgKG9sZERhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgJiYgIWRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgJiZcbiAgICAgICAgICAhZGF0YS5pc1NlYXJjaGluZykgeyB0aGlzLnJpZ2h0TWVudSgpOyB9XG4gICAgICAvLyBLZXlib2FyZCBjbG9zZS5cbiAgICAgIGlmIChvbGREYXRhLmlzU2VhcmNoaW5nICYmICFkYXRhLmlzU2VhcmNoaW5nICYmICFkYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkKSB7XG4gICAgICAgIHRoaXMucmlnaHRNZW51KCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmlzTGVmdCkge1xuICAgICAgLy8gU2VsZWN0LlxuICAgICAgaWYgKCFvbGREYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkICYmIGRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQpIHsgdGhpcy5sZWZ0TWVudSgpOyB9XG4gICAgICAvLyBLZXlib2FyZCBvcGVuLlxuICAgICAgaWYgKCFvbGREYXRhLmlzU2VhcmNoaW5nICYmIGRhdGEuaXNTZWFyY2hpbmcpIHsgdGhpcy5sZWZ0TWVudSgpOyB9XG4gICAgfVxuICB9LFxuXG4gIHJpZ2h0TWVudTogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5pc0xlZnQpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5jb21wb25lbnRzLmFuaW1hdGlvbl9fbWVudXJpZ2h0LmJlZ2luQW5pbWF0aW9uKCk7XG4gICAgdGhpcy5pc0xlZnQgPSBmYWxzZTtcbiAgfSxcblxuICBsZWZ0TWVudTogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmlzTGVmdCkgeyByZXR1cm47IH1cbiAgICB0aGlzLmVsLmNvbXBvbmVudHMuYW5pbWF0aW9uX19tZW51bGVmdC5iZWdpbkFuaW1hdGlvbigpO1xuICAgIHRoaXMuaXNMZWZ0ID0gdHJ1ZTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9tZW51LXNsaWRlLWFuaW1hdGlvbi5qcyIsImNvbnN0IG9iakxvYWRlciA9IG5ldyBUSFJFRS5PQkpMb2FkZXIoKTtcblxuQUZSQU1FLnJlZ2lzdGVyU3lzdGVtKCdtaW5lLWZyYWdtZW50cy1sb2FkZXInLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZyYWdtZW50cyA9IG51bGw7XG4gICAgY29uc3Qgb2JqRGF0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaW5lQnJva2VuT2JqJyk7XG4gICAgb2JqRGF0YS5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWQnLCBldnQgPT4ge1xuICAgICAgdGhpcy5mcmFnbWVudHMgPSBvYmpMb2FkZXIucGFyc2UoZXZ0LnRhcmdldC5kYXRhKTtcbiAgICB9KVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL21pbmUtZnJhZ21lbnRzLWxvYWRlci5qcyIsImNvbnN0IENPTUJPX1BST0dSRVNTX01BUCA9IHtcbiAgMDogMCxcbiAgMTogMC41LFxuICAyOiAwLFxuICAzOiAwLjI1LFxuICA0OiAwLjUsXG4gIDU6IDAuNzUsXG4gIDY6IDAsXG4gIDc6IDAuMTI1LFxuICA4OiAwLjI1LFxuICA5OiAwLjM3NSxcbiAgMTA6IDAuNSxcbiAgMTE6IDAuNjI1LFxuICAxMjogMC43NSxcbiAgMTM6IDAuODc1XG59O1xuXG4vKlxuICogQ29tYm8gbmVlZGVkIHRvdGFsIGZvciBtdWx0aXBsaWVyIGxldmVsOlxuICpcbiAqIDAgLSAxeFxuICogMiAtIDJ4XG4gKiA2IC0gNHhcbiAqIDE0IC0gOHhcbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdtdWx0aXBsaWVyLXJpbmcnLCB7XG4gIGRlcGVuZGVuY2llczogWydnZW9tZXRyeScsICdtYXRlcmlhbCddLFxuXG4gIHNjaGVtYToge1xuICAgIGNvbWJvOiB7ZGVmYXVsdDogMH0sXG4gICAgbXVsdGlwbGllcjoge2RlZmF1bHQ6IDF9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYW5pbWF0aW9uU2V0ID0ge2Zyb206IHVuZGVmaW5lZCwgdG86IHVuZGVmaW5lZH07XG4gICAgdGhpcy5wcm9ncmVzcyA9IHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC51bmlmb3Jtcy5wcm9ncmVzcztcblxuICAgIC8vIFNldCB1cCBhbmltYXRpb24uXG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ2FuaW1hdGlvbicsIHtcbiAgICAgIHByb3BlcnR5OiAnY29tcG9uZW50cy5tYXRlcmlhbC5tYXRlcmlhbC51bmlmb3Jtcy5wcm9ncmVzcy52YWx1ZScsXG4gICAgICBkdXI6IDEwMCxcbiAgICAgIGF1dG9wbGF5OiBmYWxzZVxuICAgIH0pO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMudXBkYXRlUmluZygpO1xuICB9LFxuXG4gIHVwZGF0ZVJpbmc6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcbiAgICBjb25zdCBwcm9ncmVzcyA9IHRoaXMucHJvZ3Jlc3M7XG5cbiAgICBpZiAoZGF0YS5tdWx0aXBsaWVyID09PSA4KSB7XG4gICAgICBwcm9ncmVzcy52YWx1ZSA9IDE7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgYW5pbWF0aW9uU2V0ID0gdGhpcy5hbmltYXRpb25TZXQ7XG4gICAgYW5pbWF0aW9uU2V0LmZyb20gPSBwcm9ncmVzcy52YWx1ZTtcbiAgICBhbmltYXRpb25TZXQudG8gPSBDT01CT19QUk9HUkVTU19NQVBbZGF0YS5jb21ib107XG4gICAgZWwuc2V0QXR0cmlidXRlKCdhbmltYXRpb24nLCBhbmltYXRpb25TZXQpO1xuICAgIGVsLmNvbXBvbmVudHMuYW5pbWF0aW9uLmJlZ2luQW5pbWF0aW9uKCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbXVsdGlwbGllci1yaW5nLmpzIiwiY29uc3QgTlVNX1BMQU5FX1BPU0lUSU9OUyA9IDEyO1xuXG5jb25zdCBCTEVORElOR1MgPSB7XG4gIG5vcm1hbDogVEhSRUUuTm9ybWFsQmxlbmRpbmcsXG4gIGFkZGl0aXZlOiBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nLFxuICBzdWJzdHJhY3RpdmU6IFRIUkVFLlN1YnN0cmFjdGl2ZUJsZW5kaW5nLFxuICBtdWx0aXBseTogVEhSRUUuTXVsdGlwbHlCbGVuZGluZ1xufTtcblxuY29uc3QgU0hBREVSUyA9IHtcbiAgZmxhdDogVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwsXG4gIGxhbWJlcnQ6IFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwsXG4gIHBob25nOiBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCxcbiAgc3RhbmRhcmQ6IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsXG59O1xuXG5jb25zdCBPRkZTQ1JFRU5fVkVDMyA9IG5ldyBUSFJFRS5WZWN0b3IzKC05OTk5OSwgLTk5OTk5LCAtOTk5OTkpO1xuXG4vKipcbiAqIFBhcnRpY2xlIFBsYXllciBjb21wb25lbnQgZm9yIEEtRnJhbWUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgncGFydGljbGVwbGF5ZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGJsZW5kaW5nOiB7XG4gICAgICBkZWZhdWx0OiAnYWRkaXRpdmUnLFxuICAgICAgb25lT2Y6IFsnbm9ybWFsJywgJ2FkZGl0aXZlJywgJ211bHRpcGx5JywgJ3N1YnN0cmFjdGl2ZSddXG4gICAgfSxcbiAgICBjb2xvcjoge2RlZmF1bHQ6ICcjZmZmJywgdHlwZTogJ2NvbG9yJ30sXG4gICAgY291bnQ6IHtkZWZhdWx0OiAnMTAwJSd9LFxuICAgIGRlbGF5OiB7ZGVmYXVsdDogMCwgdHlwZTogJ2ludCd9LFxuICAgIGR1cjoge2RlZmF1bHQ6IDEwMDAsIHR5cGU6ICdpbnQnfSxcbiAgICBpbWc6IHt0eXBlOiAnc2VsZWN0b3InfSxcbiAgICBpbnRlcnBvbGF0ZToge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBsb29wOiB7ZGVmYXVsdDogJ2ZhbHNlJ30sXG4gICAgb246IHtkZWZhdWx0OiAnaW5pdCd9LFxuICAgIHBvb2xTaXplOiB7ZGVmYXVsdDogNSwgdHlwZTogJ2ludCd9LCAvLyBudW1iZXIgb2Ygc2ltdWx0YW5lb3VzIHBhcnRpY2xlIHN5c3RlbXNcbiAgICBwcm90YXRpb246IHt0eXBlOiAndmVjMyd9LFxuICAgIHBzY2FsZToge2RlZmF1bHQ6IDEuMCwgdHlwZTogJ2Zsb2F0J30sXG4gICAgc2NhbGU6IHtkZWZhdWx0OiAxLjAsIHR5cGU6ICdmbG9hdCd9LFxuICAgIGluaXRpYWxTY2FsZToge3R5cGU6ICd2ZWMzJ30sXG4gICAgZmluYWxTY2FsZToge3R5cGU6ICd2ZWMzJ30sXG4gICAgYW5pbWF0ZVNjYWxlOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHNoYWRlcjoge1xuICAgICAgZGVmYXVsdDogJ2ZsYXQnLFxuICAgICAgb25lT2Y6IFsnZmxhdCcsICdsYW1iZXJ0JywgJ3Bob25nJywgJ3N0YW5kYXJkJ11cbiAgICB9LFxuICAgIHNyYzoge3R5cGU6ICdzZWxlY3Rvcid9XG4gIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnJhbWUgPSAwO1xuICAgIHRoaXMuZnJhbWVkYXRhID0gbnVsbDtcbiAgICB0aGlzLmluZGV4UG9vbCA9IG51bGw7XG4gICAgdGhpcy5sYXN0RnJhbWUgPSAwO1xuICAgIHRoaXMubWF0ZXJpYWwgPSBudWxsO1xuICAgIHRoaXMubXNQZXJGcmFtZSA9IDA7XG4gICAgdGhpcy5udW1GcmFtZXMgPSAwO1xuICAgIHRoaXMubnVtUGFydGljbGVzID0gMDsgLy8gdG90YWwgbnVtYmVyIG9mIHBhcnRpY2xlcyBwZXIgc3lzdGVtXG4gICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyA9IFtdO1xuICAgIHRoaXMucGFydGljbGVDb3VudCA9IDA7IC8vIGFjdHVhbCBudW1iZXIgb2YgcGFydGljbGVzIHRvIHNwYXduIHBlciBldmVudCAoZGF0YS5jb3VudClcbiAgICB0aGlzLnBhcnRpY2xlU3lzdGVtcyA9IFtdO1xuICAgIHRoaXMucHJvdGF0aW9uID0gZmFsc2U7XG4gICAgdGhpcy5yZXN0UG9zaXRpb25zID0gW107IC8vIHBvc2l0aW9uIGF0IGZpcnN0IGZyYW1lIGVhY2ggcGFydGljbGUgaXMgYWxpdmVcbiAgICB0aGlzLnJlc3RSb3RhdGlvbnMgPSBbXTtcbiAgICB0aGlzLnNwcml0ZV9yb3RhdGlvbiA9IGZhbHNlO1xuICAgIHRoaXMuc3lzdGVtcyA9IG51bGw7XG4gICAgdGhpcy51c2VSb3RhdGlvbiA9IGZhbHNlO1xuICAgIHRoaXMudXNlQWdlID0gZmFsc2U7XG4gICAgdGhpcy5zY2FsZUFuaW0gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMucGFydFNjYWxlID0gbmV3IFRIUkVFLlZlY3RvcjMoMS4wLCAxLjAsIDEuMCk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICBpZiAoIWRhdGEuc3JjKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG9sZERhdGEub24gIT09IGRhdGEub24pIHtcbiAgICAgIGlmIChvbGREYXRhLm9uKSB7XG4gICAgICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihvbGREYXRhLm9uLCB0aGlzLnN0YXJ0KTtcbiAgICAgIH1cbiAgICAgIGlmIChkYXRhLm9uICE9PSAncGxheScpIHtcbiAgICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKGRhdGEub24sIHRoaXMuc3RhcnQuYmluZCh0aGlzKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5wYXJ0U2NhbGUuc2V0KDEuMCwgMS4wLCAxLjApO1xuXG4gICAgdGhpcy5sb2FkUGFydGljbGVzSlNPTihkYXRhLnNyYywgZGF0YS5zY2FsZSk7XG5cbiAgICB0aGlzLm51bUZyYW1lcyA9IHRoaXMuZnJhbWVkYXRhLmxlbmd0aDtcbiAgICB0aGlzLm51bVBhcnRpY2xlcyA9IHRoaXMubnVtRnJhbWVzID4gMCA/IHRoaXMuZnJhbWVkYXRhWzBdLmxlbmd0aCA6IDA7XG5cbiAgICBpZiAoZGF0YS5jb3VudFtkYXRhLmNvdW50Lmxlbmd0aCAtIDFdID09PSAnJScpIHtcbiAgICAgIHRoaXMucGFydGljbGVDb3VudCA9IE1hdGguZmxvb3IoXG4gICAgICAgIChwYXJzZUludChkYXRhLmNvdW50KSAqIHRoaXMubnVtUGFydGljbGVzKSAvIDEwMC4wXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnBhcnRpY2xlQ291bnQgPSBwYXJzZUludChkYXRhLmNvdW50KTtcbiAgICB9XG4gICAgdGhpcy5wYXJ0aWNsZUNvdW50ID0gTWF0aC5taW4oXG4gICAgICB0aGlzLm51bVBhcnRpY2xlcyxcbiAgICAgIE1hdGgubWF4KDAsIHRoaXMucGFydGljbGVDb3VudClcbiAgICApO1xuXG4gICAgdGhpcy5tc1BlckZyYW1lID0gZGF0YS5kdXIgLyB0aGlzLm51bUZyYW1lcztcblxuICAgIHRoaXMuaW5kZXhQb29sID0gbmV3IEFycmF5KHRoaXMubnVtUGFydGljbGVzKTtcblxuICAgIGNvbnN0IG1hdGVyaWFsUGFyYW1zID0ge1xuICAgICAgY29sb3I6IG5ldyBUSFJFRS5Db2xvcihkYXRhLmNvbG9yKSxcbiAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsXG4gICAgICBibGVuZGluZzogQkxFTkRJTkdTW2RhdGEuYmxlbmRpbmddLFxuICAgICAgbWFwOiBkYXRhLmltZyA/IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZChkYXRhLmltZy5zcmMpIDogbnVsbCxcbiAgICAgIGRlcHRoV3JpdGU6IGZhbHNlLFxuICAgICAgb3BhY2l0eTogZGF0YS5vcGFjaXR5LFxuICAgICAgdHJhbnNwYXJlbnQ6ICEhZGF0YS5pbWcgfHwgZGF0YS5ibGVuZGluZyAhPT0gJ25vcm1hbCcgfHwgZGF0YS5vcGFjaXR5IDwgMVxuICAgIH07XG4gICAgaWYgKFNIQURFUlNbZGF0YS5zaGFkZXJdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMubWF0ZXJpYWwgPSBuZXcgU0hBREVSU1tkYXRhLnNoYWRlcl0obWF0ZXJpYWxQYXJhbXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1hdGVyaWFsID0gbmV3IFNIQURFUlNbJ2ZsYXQnXShtYXRlcmlhbFBhcmFtcyk7XG4gICAgfVxuXG4gICAgdGhpcy5jcmVhdGVQYXJ0aWNsZXMoZGF0YS5wb29sU2l6ZSk7XG5cbiAgICBpZiAoZGF0YS5vbiA9PT0gJ2luaXQnKSB7XG4gICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgfVxuICB9LFxuXG4gIGxvYWRQYXJ0aWNsZXNKU09OOiBmdW5jdGlvbiAoanNvbiwgc2NhbGUpIHtcbiAgICB2YXIgYWxpdmU7XG5cbiAgICB0aGlzLnJlc3RQb3NpdGlvbnMubGVuZ3RoID0gMDtcbiAgICB0aGlzLnJlc3RSb3RhdGlvbnMubGVuZ3RoID0gMDtcblxuICAgIGNvbnN0IGpzb25EYXRhID0gSlNPTi5wYXJzZShqc29uLmRhdGEpO1xuICAgIGNvbnN0IGZyYW1lcyA9IGpzb25EYXRhLmZyYW1lcztcbiAgICBjb25zdCBwcmVjaXNpb24gPSBqc29uRGF0YS5wcmVjaXNpb247XG5cbiAgICB0aGlzLnVzZVJvdGF0aW9uID0ganNvbkRhdGEucm90YXRpb247XG4gICAgdGhpcy51c2VBZ2UgPSBqc29uRGF0YVsnYWdlJ10gIT09IHVuZGVmaW5lZCA/IGpzb25EYXRhLmFnZSA6IGZhbHNlO1xuXG4gICAgaWYgKGpzb25EYXRhLnNwcml0ZV9yb3RhdGlvbiAhPT0gZmFsc2UpIHtcbiAgICAgIHRoaXMuc3ByaXRlX3JvdGF0aW9uID0ge1xuICAgICAgICB4OiBqc29uRGF0YS5zcHJpdGVfcm90YXRpb25bMF0gLyBwcmVjaXNpb24sXG4gICAgICAgIHk6IGpzb25EYXRhLnNwcml0ZV9yb3RhdGlvblsxXSAvIHByZWNpc2lvbixcbiAgICAgICAgejoganNvbkRhdGEuc3ByaXRlX3JvdGF0aW9uWzJdIC8gcHJlY2lzaW9uXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNwcml0ZV9yb3RhdGlvbiA9IGZhbHNlO1xuICAgIH1cblxuICAgIHRoaXMuZnJhbWVkYXRhID0gbmV3IEFycmF5KGZyYW1lcy5sZW5ndGgpO1xuICAgIGZvciAobGV0IGZyYW1lSW5kZXggPSAwOyBmcmFtZUluZGV4IDwgZnJhbWVzLmxlbmd0aDsgZnJhbWVJbmRleCsrKSB7XG4gICAgICB0aGlzLmZyYW1lZGF0YVtmcmFtZUluZGV4XSA9IG5ldyBBcnJheShmcmFtZXNbZnJhbWVJbmRleF0ubGVuZ3RoKTtcbiAgICAgIGZvciAoXG4gICAgICAgIGxldCBwYXJ0aWNsZUluZGV4ID0gMDtcbiAgICAgICAgcGFydGljbGVJbmRleCA8IGZyYW1lc1tmcmFtZUluZGV4XS5sZW5ndGg7XG4gICAgICAgIHBhcnRpY2xlSW5kZXgrK1xuICAgICAgKSB7XG4gICAgICAgIGxldCByYXdQID0gZnJhbWVzW2ZyYW1lSW5kZXhdW3BhcnRpY2xlSW5kZXhdOyAvLyBkYXRhIG9mIHBhcnRpY2xlIGkgaW4gZnJhbWUgZlxuICAgICAgICBhbGl2ZSA9IHJhd1AgIT09IDA7IC8vIDAgbWVhbnMgbm90IGFsaXZlIHlldCB0aGlzIGZyYW1lLlxuXG4gICAgICAgIGxldCBwID0gKHRoaXMuZnJhbWVkYXRhW2ZyYW1lSW5kZXhdW3BhcnRpY2xlSW5kZXhdID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBhbGl2ZVxuICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIHg6IChyYXdQWzBdIC8gcHJlY2lzaW9uKSAqIHNjYWxlLFxuICAgICAgICAgICAgICB5OiAocmF3UFsxXSAvIHByZWNpc2lvbikgKiBzY2FsZSxcbiAgICAgICAgICAgICAgejogKHJhd1BbMl0gLyBwcmVjaXNpb24pICogc2NhbGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgICBhbGl2ZTogYWxpdmVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMudXNlUm90YXRpb24pIHtcbiAgICAgICAgICBwLnJvdGF0aW9uID0gYWxpdmVcbiAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICB4OiByYXdQWzNdIC8gcHJlY2lzaW9uLFxuICAgICAgICAgICAgICB5OiByYXdQWzRdIC8gcHJlY2lzaW9uLFxuICAgICAgICAgICAgICB6OiByYXdQWzVdIC8gcHJlY2lzaW9uXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy51c2VBZ2UpIHtcbiAgICAgICAgICBwLmFnZSA9IGFsaXZlID8gcmF3UFs2XSAvIHByZWNpc2lvbiA6IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWxpdmUgJiYgZnJhbWVJbmRleCA9PT0gMCkge1xuICAgICAgICAgIHRoaXMucmVzdFBvc2l0aW9uc1twYXJ0aWNsZUluZGV4XSA9IHAucG9zaXRpb25cbiAgICAgICAgICAgID8ge3g6IHAucG9zaXRpb24ueSwgeTogcC5wb3NpdGlvbi55LCB6OiBwLnBvc2l0aW9uLnp9XG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgdGhpcy5yZXN0Um90YXRpb25zW3BhcnRpY2xlSW5kZXhdID0gcC5yb3RhdGlvblxuICAgICAgICAgICAgPyB7eDogcC5yb3RhdGlvbi55LCB5OiBwLnJvdGF0aW9uLnksIHo6IHAucm90YXRpb24uen1cbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBjcmVhdGVQYXJ0aWNsZXM6IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgdGVtcEdlb21ldHJpZXMgPSBbXTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAobnVtUGFydGljbGVTeXN0ZW1zKSB7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgdmFyIGxvb3AgPSBwYXJzZUludCh0aGlzLmRhdGEubG9vcCk7XG5cbiAgICAgIHRoaXMucGFydGljbGVTeXN0ZW1zLmxlbmd0aCA9IDA7XG5cbiAgICAgIGlmIChpc05hTihsb29wKSkge1xuICAgICAgICBsb29wID0gdGhpcy5kYXRhLmxvb3AgPT09ICd0cnVlJyA/IE51bWJlci5NQVhfVkFMVUUgOiAwO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVBhcnRpY2xlU3lzdGVtczsgaSsrKSB7XG4gICAgICAgIGxldCBwYXJ0aWNsZVN5c3RlbSA9IHtcbiAgICAgICAgICBhY3RpdmU6IGZhbHNlLFxuICAgICAgICAgIGFjdGl2ZVBhcnRpY2xlSW5kaWNlczogbmV3IEFycmF5KHRoaXMucGFydGljbGVDb3VudCksXG4gICAgICAgICAgbG9vcENvdW50OiAwLFxuICAgICAgICAgIGxvb3BUb3RhbDogbG9vcCxcbiAgICAgICAgICBtZXNoOiBudWxsLFxuICAgICAgICAgIHRpbWU6IDBcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBGaWxsIGFycmF5IG9mIGdlb21ldHJpZXMgdG8gbWVyZ2UuXG4gICAgICAgIGNvbnN0IHJhdGlvID0gZGF0YS5pbWcgPyBkYXRhLmltZy53aWR0aCAvIGRhdGEuaW1nLmhlaWdodCA6IDE7XG4gICAgICAgIHRlbXBHZW9tZXRyaWVzLmxlbmd0aCA9IDA7XG4gICAgICAgIGZvciAobGV0IHAgPSAwOyBwIDwgdGhpcy5udW1QYXJ0aWNsZXM7IHArKykge1xuICAgICAgICAgIGxldCBnZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUJ1ZmZlckdlb21ldHJ5KFxuICAgICAgICAgICAgMC4xICogcmF0aW8gKiBkYXRhLnBzY2FsZSxcbiAgICAgICAgICAgIDAuMSAqIGRhdGEucHNjYWxlXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAodGhpcy5zcHJpdGVfcm90YXRpb24gIT09IGZhbHNlKSB7XG4gICAgICAgICAgICBnZW9tZXRyeS5yb3RhdGVYKHRoaXMuc3ByaXRlX3JvdGF0aW9uLngpO1xuICAgICAgICAgICAgZ2VvbWV0cnkucm90YXRlWSh0aGlzLnNwcml0ZV9yb3RhdGlvbi55KTtcbiAgICAgICAgICAgIGdlb21ldHJ5LnJvdGF0ZVoodGhpcy5zcHJpdGVfcm90YXRpb24ueik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdlb21ldHJ5LnJvdGF0ZVgoKHRoaXMuZGF0YS5wcm90YXRpb24ueCAqIE1hdGguUEkpIC8gMTgwKTtcbiAgICAgICAgICAgIGdlb21ldHJ5LnJvdGF0ZVkoKHRoaXMuZGF0YS5wcm90YXRpb24ueSAqIE1hdGguUEkpIC8gMTgwKTtcbiAgICAgICAgICAgIGdlb21ldHJ5LnJvdGF0ZVooKHRoaXMuZGF0YS5wcm90YXRpb24ueiAqIE1hdGguUEkpIC8gMTgwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGVtcEdlb21ldHJpZXMucHVzaChnZW9tZXRyeSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDcmVhdGUgbWVyZ2VkIGdlb21ldHJ5IGZvciB3aG9sZSBwYXJ0aWNsZSBzeXN0ZW0uXG4gICAgICAgIGxldCBtZXJnZWRCdWZmZXJHZW9tZXRyeSA9IFRIUkVFLkJ1ZmZlckdlb21ldHJ5VXRpbHMubWVyZ2VCdWZmZXJHZW9tZXRyaWVzKFxuICAgICAgICAgIHRlbXBHZW9tZXRyaWVzXG4gICAgICAgICk7XG5cbiAgICAgICAgcGFydGljbGVTeXN0ZW0ubWVzaCA9IG5ldyBUSFJFRS5NZXNoKFxuICAgICAgICAgIG1lcmdlZEJ1ZmZlckdlb21ldHJ5LFxuICAgICAgICAgIHRoaXMubWF0ZXJpYWxcbiAgICAgICAgKTtcbiAgICAgICAgcGFydGljbGVTeXN0ZW0ubWVzaC52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZWwuc2V0T2JqZWN0M0QoYHBhcnRpY2xlcGxheWVyJHtpfWAsIHBhcnRpY2xlU3lzdGVtLm1lc2gpO1xuICAgICAgICBjb3B5QXJyYXkoXG4gICAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgICBtZXJnZWRCdWZmZXJHZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5XG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gSGlkZSBhbGwgcGFydGljbGVzIGJ5IGRlZmF1bHQuXG4gICAgICAgIGZvciAoXG4gICAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICAgIGkgPCBtZXJnZWRCdWZmZXJHZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5Lmxlbmd0aDtcbiAgICAgICAgICBpKytcbiAgICAgICAgKSB7XG4gICAgICAgICAgbWVyZ2VkQnVmZmVyR2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheVtpXSA9IC05OTk5OTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2ldID0gaTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucGFydGljbGVTeXN0ZW1zLnB1c2gocGFydGljbGVTeXN0ZW0pO1xuICAgICAgfVxuICAgIH07XG4gIH0pKCksXG5cbiAgc3RhcnQ6IGZ1bmN0aW9uIChldnQpIHtcbiAgICBpZiAodGhpcy5kYXRhLmRlbGF5ID4gMCkge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnN0YXJ0QWZ0ZXJEZWxheShldnQpLCB0aGlzLmRhdGEuZGVsYXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YXJ0QWZ0ZXJEZWxheShldnQpO1xuICAgIH1cbiAgfSxcblxuICBzdGFydEFmdGVyRGVsYXk6IGZ1bmN0aW9uIChldnQpIHtcbiAgICAvLyBwb3NpdGlvbiwgcm90YXRpb25cbiAgICB2YXIgZm91bmQgPSAtMTtcbiAgICB2YXIgcGFydGljbGVTeXN0ZW07XG4gICAgdmFyIG9sZGVzdFRpbWUgPSAwO1xuICAgIHZhciBwb3NpdGlvbiA9IGV2dCA/IGV2dC5kZXRhaWwucG9zaXRpb24gOiBudWxsO1xuICAgIHZhciByb3RhdGlvbiA9IGV2dCA/IGV2dC5kZXRhaWwucm90YXRpb24gOiBudWxsO1xuXG4gICAgaWYgKCEocG9zaXRpb24gaW5zdGFuY2VvZiBUSFJFRS5WZWN0b3IzKSkge1xuICAgICAgcG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIH1cbiAgICBpZiAoIShyb3RhdGlvbiBpbnN0YW5jZW9mIFRIUkVFLkV1bGVyKSkge1xuICAgICAgcm90YXRpb24gPSBuZXcgVEhSRUUuRXVsZXIoKTtcbiAgICB9XG5cbiAgICAvLyBmaW5kIGF2YWlsYWJsZSAob3Igb2xkZXN0KSBwYXJ0aWNsZSBzeXN0ZW1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGFydGljbGVTeXN0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5wYXJ0aWNsZVN5c3RlbXNbaV0uYWN0aXZlID09PSBmYWxzZSkge1xuICAgICAgICBmb3VuZCA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMucGFydGljbGVTeXN0ZW1zW2ldLnRpbWUgPiBvbGRlc3RUaW1lKSB7XG4gICAgICAgIGZvdW5kID0gaTtcbiAgICAgICAgb2xkZXN0VGltZSA9IHRoaXMucGFydGljbGVTeXN0ZW1zW2ldLnRpbWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZvdW5kID09PSAtMSkgeyByZXR1cm47IH1cblxuICAgIHBhcnRpY2xlU3lzdGVtID0gdGhpcy5wYXJ0aWNsZVN5c3RlbXNbZm91bmRdO1xuICAgIHBhcnRpY2xlU3lzdGVtLmFjdGl2ZSA9IHRydWU7XG4gICAgcGFydGljbGVTeXN0ZW0ubG9vcENvdW50ID0gMTtcbiAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoLnZpc2libGUgPSB0cnVlO1xuICAgIHBhcnRpY2xlU3lzdGVtLm1lc2gucG9zaXRpb24uY29weShwb3NpdGlvbik7XG4gICAgcGFydGljbGVTeXN0ZW0ubWVzaC5yb3RhdGlvbi5jb3B5KHJvdGF0aW9uKTtcbiAgICBwYXJ0aWNsZVN5c3RlbS50aW1lID0gMDtcbiAgICB0aGlzLnJlc2V0UGFydGljbGVzKHBhcnRpY2xlU3lzdGVtKTtcbiAgICByZXR1cm4gcGFydGljbGVTeXN0ZW07XG4gIH0sXG5cbiAgZG9Mb29wOiBmdW5jdGlvbiAocGFydGljbGVTeXN0ZW0pIHtcbiAgICBwYXJ0aWNsZVN5c3RlbS5sb29wQ291bnQrKztcbiAgICBwYXJ0aWNsZVN5c3RlbS5mcmFtZSA9IC0xO1xuICAgIHBhcnRpY2xlU3lzdGVtLnRpbWUgPSAwO1xuICAgIHRoaXMucmVzZXRQYXJ0aWNsZXMocGFydGljbGVTeXN0ZW0pO1xuICB9LFxuXG4gIHJlc2V0UGFydGljbGU6IGZ1bmN0aW9uIChwYXJ0aWNsZVN5c3RlbSwgcGFydGljbGVJbmRleCkge1xuICAgIGNvbnN0IGdlb21ldHJ5ID0gcGFydGljbGVTeXN0ZW0ubWVzaC5nZW9tZXRyeTtcblxuICAgIGlmICh0aGlzLnJlc3RQb3NpdGlvbnNbcGFydGljbGVJbmRleF0pIHtcbiAgICAgIHRyYW5zZm9ybVBsYW5lKFxuICAgICAgICBwYXJ0aWNsZUluZGV4LFxuICAgICAgICBnZW9tZXRyeSxcbiAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgdGhpcy5yZXN0UG9zaXRpb25zW3BhcnRpY2xlSW5kZXhdLFxuICAgICAgICB0aGlzLnVzZVJvdGF0aW9uICYmIHRoaXMucmVzdFJvdGF0aW9uc1twYXJ0aWNsZUluZGV4XSxcbiAgICAgICAgbnVsbFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSGlkZS5cbiAgICAgIHRyYW5zZm9ybVBsYW5lKFxuICAgICAgICBwYXJ0aWNsZUluZGV4LFxuICAgICAgICBnZW9tZXRyeSxcbiAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgT0ZGU0NSRUVOX1ZFQzMsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgbnVsbFxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBUT0RPOiBDYW4gdXBkYXRlIHRyYW5zZm9ybVBsYW5lIGZvciBsb29rQXQuXG4gICAgLy8gbG9va0F0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRlZCBvciB0cmFuc2xhdGVkIHBhcmVudHMhIDpfKFxuICAgIC8vIHBhcnQubG9va0F0KHRoaXMuY2FtZXJhLnBvc2l0aW9uKTtcbiAgfSxcblxuICAvKipcbiAgICogV2hlbiBzdGFydGluZyBvciBmaW5pc2hpbmcgKGxvb3BpbmcpIGFuaW1hdGlvbiwgdGhpcyByZXNldHMgcGFydGljbGVzXG4gICAqIHRvIHRoZWlyIGluaXRpYWwgcG9zaXRpb24gYW5kLCBpZiB1c2VyIGFza2VkIGZvciByZXBsYXlpbmcgbGVzcyB0aGFuIDEwMCVcbiAgICogb2YgcGFydGljbGVzLCByYW5kb21seSBjaG9vc2UgdGhlbS5cbiAgICovXG4gIHJlc2V0UGFydGljbGVzOiBmdW5jdGlvbiAocGFydGljbGVTeXN0ZW0pIHtcbiAgICB2YXIgaTtcbiAgICB2YXIgcmFuZDtcblxuICAgIC8vIG5vIHBpY2tpbmcsIGp1c3QgaGlkZSBhbmQgcmVzZXRcbiAgICBpZiAodGhpcy5wYXJ0aWNsZUNvdW50ID09PSB0aGlzLm51bVBhcnRpY2xlcykge1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMubnVtUGFydGljbGVzOyBpKyspIHtcbiAgICAgICAgdGhpcy5yZXNldFBhcnRpY2xlKHBhcnRpY2xlU3lzdGVtLCBpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBoaWRlIHBhcnRpY2xlcyBmcm9tIGxhc3QgYW5pbWF0aW9uIGFuZCBpbml0aWFsaXplIGluZGV4UG9vbFxuICAgIGNvbnN0IGdlb21ldHJ5ID0gcGFydGljbGVTeXN0ZW0ubWVzaC5nZW9tZXRyeTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5udW1QYXJ0aWNsZXM7IGkrKykge1xuICAgICAgaWYgKGkgPCB0aGlzLnBhcnRpY2xlQ291bnQpIHtcbiAgICAgICAgdHJhbnNmb3JtUGxhbmUoXG4gICAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2ldLFxuICAgICAgICAgIGdlb21ldHJ5LFxuICAgICAgICAgIHRoaXMub3JpZ2luYWxWZXJ0ZXhQb3NpdGlvbnMsXG4gICAgICAgICAgT0ZGU0NSRUVOX1ZFQzMsXG4gICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgIG51bGxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaW5kZXhQb29sW2ldID0gaTtcbiAgICB9XG5cbiAgICAvLyBzY3JhbWJsZSBpbmRleFBvb2xcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5wYXJ0aWNsZUNvdW50OyBpKyspIHtcbiAgICAgIHJhbmQgPSBpICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKHRoaXMubnVtUGFydGljbGVzIC0gaSkpO1xuICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2ldID0gdGhpcy5pbmRleFBvb2xbcmFuZF07XG4gICAgICB0aGlzLmluZGV4UG9vbFtyYW5kXSA9IHRoaXMuaW5kZXhQb29sW2ldO1xuICAgICAgdGhpcy5yZXNldFBhcnRpY2xlKFxuICAgICAgICBwYXJ0aWNsZVN5c3RlbSxcbiAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2ldXG4gICAgICApO1xuICAgIH1cbiAgfSxcblxuICB0aWNrOiAoZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGhlbHBlclBvc2l0aW9uVmVjMyA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgICB2YXIgZnJhbWU7IC8vIGN1cnJlbnQgcGFydGljbGUgc3lzdGVtIGZyYW1lXG4gICAgICB2YXIgZmRhdGE7IC8vIGFsbCBwYXJ0aWNsZXMgZGF0YSBpbiBjdXJyZW50IGZyYW1lXG4gICAgICB2YXIgZmRhdGFOZXh0OyAvLyBuZXh0IGZyYW1lIChmb3IgaW50ZXJwb2xhdGlvbilcbiAgICAgIHZhciB1c2VSb3RhdGlvbiA9IHRoaXMudXNlUm90YXRpb247XG4gICAgICB2YXIgZnJhbWVUaW1lOyAvLyB0aW1lIGluIGN1cnJlbnQgZnJhbWUgKGZvciBpbnRlcnBvbGF0aW9uKVxuICAgICAgdmFyIHJlbFRpbWU7IC8vIGN1cnJlbnQgcGFydGljbGUgc3lzdGVtIHJlbGF0aXZlIHRpbWUgKDAtMSlcbiAgICAgIHZhciBpbnRlcnBvbGF0ZTsgLy8gd2hldGhlciBpbnRlcnBvbGF0ZSBiZXR3ZWVuIGZyYW1lcyBvciBub3RcbiAgICAgIGNvbnN0IHNjYWxlU3lzdGVtID0gdGhpcy5kYXRhLmFuaW1hdGVTY2FsZSAmJiAhdGhpcy51c2VBZ2U7XG4gICAgICBjb25zdCBzY2FsZVBhcnRpY2xlID0gdGhpcy5kYXRhLmFuaW1hdGVTY2FsZSAmJiB0aGlzLnVzZUFnZTtcblxuICAgICAgZm9yIChcbiAgICAgICAgbGV0IHBhcnRpY2xlU3lzdGVtSW5kZXggPSAwO1xuICAgICAgICBwYXJ0aWNsZVN5c3RlbUluZGV4IDwgdGhpcy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO1xuICAgICAgICBwYXJ0aWNsZVN5c3RlbUluZGV4KytcbiAgICAgICkge1xuICAgICAgICBsZXQgcGFydGljbGVTeXN0ZW0gPSB0aGlzLnBhcnRpY2xlU3lzdGVtc1twYXJ0aWNsZVN5c3RlbUluZGV4XTtcbiAgICAgICAgaWYgKCFwYXJ0aWNsZVN5c3RlbS5hY3RpdmUpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIHRoZSBkdXJhdGlvbiBpcyBzbyBzaG9ydCB0aGF0IHRoZXJlJ3Mgbm8gbmVlZCB0byBpbnRlcnBvbGF0ZSwgZG9uJ3QgZG8gaXRcbiAgICAgICAgLy8gZXZlbiBpZiB1c2VyIGFza2VkIGZvciBpdC5cbiAgICAgICAgaW50ZXJwb2xhdGUgPVxuICAgICAgICAgIHRoaXMuZGF0YS5pbnRlcnBvbGF0ZSAmJiB0aGlzLmRhdGEuZHVyIC8gdGhpcy5udW1GcmFtZXMgPiBkZWx0YTtcbiAgICAgICAgcmVsVGltZSA9IHBhcnRpY2xlU3lzdGVtLnRpbWUgLyB0aGlzLmRhdGEuZHVyO1xuICAgICAgICBmcmFtZSA9IHJlbFRpbWUgKiB0aGlzLm51bUZyYW1lcztcbiAgICAgICAgZmRhdGEgPSB0aGlzLmZyYW1lZGF0YVtNYXRoLmZsb29yKGZyYW1lKV07XG4gICAgICAgIGlmIChpbnRlcnBvbGF0ZSkge1xuICAgICAgICAgIGZyYW1lVGltZSA9IGZyYW1lIC0gTWF0aC5mbG9vcihmcmFtZSk7XG4gICAgICAgICAgZmRhdGFOZXh0ID1cbiAgICAgICAgICAgIGZyYW1lIDwgdGhpcy5udW1GcmFtZXMgLSAxXG4gICAgICAgICAgICAgID8gdGhpcy5mcmFtZWRhdGFbTWF0aC5mbG9vcihmcmFtZSkgKyAxXVxuICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2NhbGVTeXN0ZW0pIHtcbiAgICAgICAgICB0aGlzLnBhcnRTY2FsZS5sZXJwVmVjdG9ycyh0aGlzLmRhdGEuaW5pdGlhbFNjYWxlLCB0aGlzLmRhdGEuZmluYWxTY2FsZSwgcmVsVGltZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKFxuICAgICAgICAgIGxldCBhY3RpdmVQYXJ0aWNsZUluZGV4ID0gMDtcbiAgICAgICAgICBhY3RpdmVQYXJ0aWNsZUluZGV4IDwgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzLmxlbmd0aDtcbiAgICAgICAgICBhY3RpdmVQYXJ0aWNsZUluZGV4KytcbiAgICAgICAgKSB7XG4gICAgICAgICAgbGV0IHBhcnRpY2xlSW5kZXggPVxuICAgICAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlUGFydGljbGVJbmRpY2VzW2FjdGl2ZVBhcnRpY2xlSW5kZXhdO1xuICAgICAgICAgIGxldCByb3RhdGlvbiA9IHVzZVJvdGF0aW9uICYmIGZkYXRhW3BhcnRpY2xlSW5kZXhdLnJvdGF0aW9uO1xuXG4gICAgICAgICAgaWYgKHNjYWxlUGFydGljbGUpIHtcbiAgICAgICAgICAgIHRoaXMucGFydFNjYWxlLmxlcnBWZWN0b3JzKHRoaXMuZGF0YS5pbml0aWFsU2NhbGUsIHRoaXMuZGF0YS5maW5hbFNjYWxlLCBmZGF0YVtwYXJ0aWNsZUluZGV4XS5hZ2UpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFRPRE86IEFkZCB2ZXJ0ZXggcG9zaXRpb24gdG8gb3JpZ2luYWwgcG9zaXRpb24gdG8gYWxsIHZlcnRpY2VzIG9mIHBsYW5lLi4uXG4gICAgICAgICAgaWYgKCFmZGF0YVtwYXJ0aWNsZUluZGV4XS5hbGl2ZSkge1xuICAgICAgICAgICAgLy8gSGlkZSBwbGFuZSBvZmYtc2NyZWVuIHdoZW4gbm90IGFsaXZlLlxuICAgICAgICAgICAgdHJhbnNmb3JtUGxhbmUoXG4gICAgICAgICAgICAgIHBhcnRpY2xlSW5kZXgsXG4gICAgICAgICAgICAgIHBhcnRpY2xlU3lzdGVtLm1lc2guZ2VvbWV0cnksXG4gICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxWZXJ0ZXhQb3NpdGlvbnMsXG4gICAgICAgICAgICAgIE9GRlNDUkVFTl9WRUMzLFxuICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgIG51bGxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaW50ZXJwb2xhdGUgJiYgZmRhdGFOZXh0ICYmIGZkYXRhTmV4dFtwYXJ0aWNsZUluZGV4XS5hbGl2ZSkge1xuICAgICAgICAgICAgaGVscGVyUG9zaXRpb25WZWMzLmxlcnBWZWN0b3JzKFxuICAgICAgICAgICAgICBmZGF0YVtwYXJ0aWNsZUluZGV4XS5wb3NpdGlvbixcbiAgICAgICAgICAgICAgZmRhdGFOZXh0W3BhcnRpY2xlSW5kZXhdLnBvc2l0aW9uLFxuICAgICAgICAgICAgICBmcmFtZVRpbWVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1QbGFuZShcbiAgICAgICAgICAgICAgcGFydGljbGVJbmRleCxcbiAgICAgICAgICAgICAgcGFydGljbGVTeXN0ZW0ubWVzaC5nZW9tZXRyeSxcbiAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgICAgICAgaGVscGVyUG9zaXRpb25WZWMzLFxuICAgICAgICAgICAgICByb3RhdGlvbixcbiAgICAgICAgICAgICAgdGhpcy5wYXJ0U2NhbGVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyYW5zZm9ybVBsYW5lKFxuICAgICAgICAgICAgICBwYXJ0aWNsZUluZGV4LFxuICAgICAgICAgICAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoLmdlb21ldHJ5LFxuICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVmVydGV4UG9zaXRpb25zLFxuICAgICAgICAgICAgICBmZGF0YVtwYXJ0aWNsZUluZGV4XS5wb3NpdGlvbixcbiAgICAgICAgICAgICAgcm90YXRpb24sXG4gICAgICAgICAgICAgIHRoaXMucGFydFNjYWxlXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHBhcnRpY2xlU3lzdGVtLnRpbWUgKz0gZGVsdGE7XG4gICAgICAgIGlmIChwYXJ0aWNsZVN5c3RlbS50aW1lID49IHRoaXMuZGF0YS5kdXIpIHtcbiAgICAgICAgICBpZiAocGFydGljbGVTeXN0ZW0ubG9vcENvdW50IDwgcGFydGljbGVTeXN0ZW0ubG9vcFRvdGFsKSB7XG4gICAgICAgICAgICB0aGlzLmVsLmVtaXQoJ3BhcnRpY2xlcGxheWVybG9vcCcsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuZG9Mb29wKHBhcnRpY2xlU3lzdGVtKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbC5lbWl0KCdwYXJ0aWNsZXBsYXllcmZpbmlzaGVkJywgbnVsbCwgZmFsc2UpO1xuICAgICAgICAgICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9KSgpLFxuXG4gIF90cmFuc2Zvcm1QbGFuZTogdHJhbnNmb3JtUGxhbmVcbn0pO1xuXG4vLyBVc2UgdHJpYW5nbGUgZ2VvbWV0cnkgYXMgYSBoZWxwZXIgZm9yIHJvdGF0aW5nLlxuY29uc3QgdHJpID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgdHJpID0gbmV3IFRIUkVFLkdlb21ldHJ5KCk7XG4gIHRyaS52ZXJ0aWNlcy5wdXNoKG5ldyBUSFJFRS5WZWN0b3IzKCkpO1xuICB0cmkudmVydGljZXMucHVzaChuZXcgVEhSRUUuVmVjdG9yMygpKTtcbiAgdHJpLnZlcnRpY2VzLnB1c2gobmV3IFRIUkVFLlZlY3RvcjMoKSk7XG4gIHRyaS5mYWNlcy5wdXNoKG5ldyBUSFJFRS5GYWNlMygwLCAxLCAyKSk7XG4gIHJldHVybiB0cmk7XG59KSgpO1xuXG4vKipcbiAqIEZhY2VzIG9mIGEgcGxhbmUgYXJlIHYwLCB2MiwgdjEgYW5kIHYyLCB2MywgdjEuXG4gKiBQb3NpdGlvbnMgYXJlIDEyIG51bWJlcnM6IFt2MCwgdjEsIHYyLCB2M10uXG4gKi9cbmZ1bmN0aW9uIHRyYW5zZm9ybVBsYW5lIChcbiAgcGFydGljbGVJbmRleCxcbiAgZ2VvbWV0cnksXG4gIG9yaWdpbmFsQXJyYXksXG4gIHBvc2l0aW9uLFxuICByb3RhdGlvbixcbiAgc2NhbGVcbikge1xuICBjb25zdCBhcnJheSA9IGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXk7XG4gIGNvbnN0IGluZGV4ID0gcGFydGljbGVJbmRleCAqIE5VTV9QTEFORV9QT1NJVElPTlM7XG5cbiAgLy8gQ2FsY3VsYXRlIGZpcnN0IGZhY2UgKDAsIDIsIDEpLlxuICB0cmkudmVydGljZXNbMF0uc2V0KFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyAwXSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgMV0sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDJdXG4gICk7XG4gIHRyaS52ZXJ0aWNlc1sxXS5zZXQoXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDNdLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA0XSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgNV1cbiAgKTtcbiAgdHJpLnZlcnRpY2VzWzJdLnNldChcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgNl0sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDddLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA4XVxuICApO1xuICBpZiAoc2NhbGUgIT09IG51bGwpIHtcbiAgICB0cmkuc2NhbGUoc2NhbGUueCwgc2NhbGUueSwgc2NhbGUueik7XG4gIH1cbiAgaWYgKHJvdGF0aW9uKSB7XG4gICAgdHJpLnJvdGF0ZVgocm90YXRpb24ueCk7XG4gICAgdHJpLnJvdGF0ZVkocm90YXRpb24ueSk7XG4gICAgdHJpLnJvdGF0ZVoocm90YXRpb24ueik7XG4gIH1cbiAgdHJpLnZlcnRpY2VzWzBdLmFkZChwb3NpdGlvbik7XG4gIHRyaS52ZXJ0aWNlc1sxXS5hZGQocG9zaXRpb24pO1xuICB0cmkudmVydGljZXNbMl0uYWRkKHBvc2l0aW9uKTtcbiAgYXJyYXlbaW5kZXggKyAwXSA9IHRyaS52ZXJ0aWNlc1swXS54O1xuICBhcnJheVtpbmRleCArIDFdID0gdHJpLnZlcnRpY2VzWzBdLnk7XG4gIGFycmF5W2luZGV4ICsgMl0gPSB0cmkudmVydGljZXNbMF0uejtcbiAgYXJyYXlbaW5kZXggKyAzXSA9IHRyaS52ZXJ0aWNlc1sxXS54O1xuICBhcnJheVtpbmRleCArIDRdID0gdHJpLnZlcnRpY2VzWzFdLnk7XG4gIGFycmF5W2luZGV4ICsgNV0gPSB0cmkudmVydGljZXNbMV0uejtcbiAgYXJyYXlbaW5kZXggKyA2XSA9IHRyaS52ZXJ0aWNlc1syXS54O1xuICBhcnJheVtpbmRleCArIDddID0gdHJpLnZlcnRpY2VzWzJdLnk7XG4gIGFycmF5W2luZGV4ICsgOF0gPSB0cmkudmVydGljZXNbMl0uejtcblxuICAvLyBDYWxjdWxhdGUgc2Vjb25kIGZhY2UgKDIsIDMsIDEpIGp1c3QgZm9yIHRoZSBsYXN0IHZlcnRleC5cbiAgdHJpLnZlcnRpY2VzWzBdLnNldChcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgM10sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDRdLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA1XVxuICApO1xuICB0cmkudmVydGljZXNbMV0uc2V0KFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA2XSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgN10sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDhdXG4gICk7XG4gIHRyaS52ZXJ0aWNlc1syXS5zZXQoXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDldLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyAxMF0sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDExXVxuICApO1xuICBpZiAoc2NhbGUgIT09IG51bGwpIHtcbiAgICB0cmkuc2NhbGUoc2NhbGUueCwgc2NhbGUueSwgc2NhbGUueik7XG4gIH1cbiAgaWYgKHJvdGF0aW9uKSB7XG4gICAgdHJpLnJvdGF0ZVgocm90YXRpb24ueCk7XG4gICAgdHJpLnJvdGF0ZVkocm90YXRpb24ueSk7XG4gICAgdHJpLnJvdGF0ZVoocm90YXRpb24ueik7XG4gIH1cbiAgdHJpLnZlcnRpY2VzWzBdLmFkZChwb3NpdGlvbik7XG4gIHRyaS52ZXJ0aWNlc1sxXS5hZGQocG9zaXRpb24pO1xuICB0cmkudmVydGljZXNbMl0uYWRkKHBvc2l0aW9uKTtcbiAgYXJyYXlbaW5kZXggKyA5XSA9IHRyaS52ZXJ0aWNlc1syXS54O1xuICBhcnJheVtpbmRleCArIDEwXSA9IHRyaS52ZXJ0aWNlc1syXS55O1xuICBhcnJheVtpbmRleCArIDExXSA9IHRyaS52ZXJ0aWNlc1syXS56O1xuXG4gIGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xufVxubW9kdWxlLmV4cG9ydHMudHJhbnNmb3JtUGxhbmUgPSB0cmFuc2Zvcm1QbGFuZTtcblxuZnVuY3Rpb24gY29weUFycmF5IChkZXN0LCBzcmMpIHtcbiAgZGVzdC5sZW5ndGggPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHNyYy5sZW5ndGg7IGkrKykge1xuICAgIGRlc3RbaV0gPSBzcmNbaV07XG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3BhcnRpY2xlcGxheWVyLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdwYXVzZScsIHtcbiAgc2NoZW1hOiB7XG4gICAgaXNQYXVzZWQ6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kYXRhLmlzUGF1c2VkICYmIHRoaXMuZWwuaXNQbGF5aW5nKSB7XG4gICAgICB0aGlzLmVsLnBhdXNlKCk7XG4gICAgfSBlbHNlIGlmICghdGhpcy5kYXRhLmlzUGF1c2VkICYmICF0aGlzLmVsLmlzUGxheWluZyAmJiB0aGlzLmVsLnNjZW5lRWwuaXNQbGF5aW5nKSB7XG4gICAgICB0aGlzLmVsLnBsYXkoKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvcGF1c2UuanMiLCIvKipcbiAqIFRlbGwgYXBwIHRvIHBhdXNlIGdhbWUgaWYgcGxheWluZy5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdwYXVzZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnBhdXNlR2FtZSA9IHRoaXMucGF1c2VHYW1lLmJpbmQodGhpcyk7XG5cbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignY29udHJvbGxlcmNvbm5lY3RlZCcsIGV2dCA9PiB7XG4gICAgICBpZiAoZXZ0LmRldGFpbC5uYW1lID09PSAndml2ZS1jb250cm9scycpIHtcbiAgICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtZW51ZG93bicsIHRoaXMucGF1c2VHYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigndGh1bWJzdGlja2Rvd24nLCB0aGlzLnBhdXNlR2FtZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd2aXNpYmlsaXR5Y2hhbmdlJywgKCkgPT4ge1xuICAgICAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gJ2hpZGRlbicpIHsgdGhpcy5wYXVzZUdhbWUoKTsgfVxuICAgIH0pO1xuICB9LFxuXG4gIHBhdXNlR2FtZTogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3BhdXNlZ2FtZScsIG51bGwsIGZhbHNlKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9wYXVzZXIuanMiLCJ2YXIgU291bmRQb29sID0gcmVxdWlyZSgnLi4vbGliL3NvdW5kcG9vbCcpO1xuXG5BRlJBTUUucmVnaXN0ZXJTeXN0ZW0oJ3BsYXktc291bmQnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmxhc3RTb3VuZFBsYXllZCA9ICcnO1xuICAgIHRoaXMubGFzdFNvdW5kUGxheWVkVGltZSA9IDA7XG4gICAgdGhpcy5wb29scyA9IHt9O1xuICB9LFxuXG4gIGNyZWF0ZVBvb2w6IGZ1bmN0aW9uIChzb3VuZCwgdm9sdW1lKSB7XG4gICAgaWYgKHRoaXMucG9vbHNbc291bmRdKSB7IHJldHVybjsgfVxuICAgIHRoaXMucG9vbHNbc291bmRdID0gbmV3IFNvdW5kUG9vbChzb3VuZCwgdm9sdW1lKTtcbiAgfSxcblxuICBwbGF5U291bmQ6IGZ1bmN0aW9uIChzb3VuZCwgdm9sdW1lKSB7XG4gICAgaWYgKCF0aGlzLnBvb2xzW3NvdW5kXSkge1xuICAgICAgdGhpcy5jcmVhdGVQb29sKHNvdW5kLCB2b2x1bWUpO1xuICAgIH1cbiAgICB0aGlzLnBvb2xzW3NvdW5kXS5wbGF5KCk7XG5cbiAgICB0aGlzLmxhc3RTb3VuZFBsYXllZCA9IHNvdW5kO1xuICAgIHRoaXMubGFzdFNvdW5kVGltZSA9IHRoaXMuZWwudGltZTtcbiAgfVxufSk7XG5cbi8qKlxuICogUGxheSBzb3VuZCBvbiBldmVudC5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdwbGF5LXNvdW5kJywge1xuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZXZlbnQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgc291bmQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgdm9sdW1lOiB7dHlwZTogJ251bWJlcicsIGRlZmF1bHQ6IDF9XG4gIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmRhdGEuZXZlbnQsIGV2dCA9PiB7XG4gICAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgICAgdGhpcy5zeXN0ZW0ucGxheVNvdW5kKHRoaXMuc3JjLCB0aGlzLmRhdGEudm9sdW1lKTtcbiAgICB9KTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnNyYyA9IHRoaXMuZGF0YS5zb3VuZDtcbiAgICBpZiAodGhpcy5kYXRhLnNvdW5kLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgdGhpcy5zcmMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuZGF0YS5zb3VuZCkuZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvcGxheS1zb3VuZC5qcyIsIi8qKlxuICogU2V0IHJheWNhc3QgdGFyZ2V0IGFzIGEgY2hpbGQgaW5kZXBlbmRuZW50IGZyb20gZW50aXR5LlxuICogVXNlZnVsIGZvciBwYWRkaW5nIHRoZSByYXljYXN0IHRhcmdldCBvZiBhIG1lc2ggd2l0aG91dCBjaGFuZ2luZyB0aGUgbWVzaC5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdyYXljYXN0ZXItdGFyZ2V0Jywge1xuICBzY2hlbWE6IHtcbiAgICBiaW5kVG9nZ2xlOiB7ZGVmYXVsdDogJyd9LFxuICAgIGRlcHRoOiB7dHlwZTogJ251bWJlcid9LFxuICAgIGhlaWdodDoge3R5cGU6ICdudW1iZXInfSxcbiAgICBwb3NpdGlvbjoge3R5cGU6ICd2ZWMzJywgZGVmYXVsdDoge3g6IDAsIHk6IDAsIHo6IDB9fSxcbiAgICByb3RhdGlvbjoge3R5cGU6ICd2ZWMzJywgZGVmYXVsdDoge3g6IDAsIHk6IDAsIHo6IDB9fSxcbiAgICB1c2VCb3hUYXJnZXQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgd2lkdGg6IHt0eXBlOiAnbnVtYmVyJ31cbiAgfSxcblxuICBpbml0OiAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBib3hHZW9tZXRyeSA9IHtwcmltaXRpdmU6ICdib3gnfTtcbiAgICB2YXIgcGxhbmVHZW9tZXRyeSA9IHtwcmltaXRpdmU6ICdwbGFuZSd9O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICAgIHZhciBnZW9tZXRyeTtcbiAgICAgIHZhciByYXljYXN0VGFyZ2V0O1xuXG4gICAgICByYXljYXN0VGFyZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICAgIHJheWNhc3RUYXJnZXQuY2xhc3NMaXN0LmFkZCgncmF5Y2FzdGVyVGFyZ2V0Jyk7XG5cbiAgICAgIGlmIChkYXRhLmJpbmRUb2dnbGUpIHtcbiAgICAgICAgcmF5Y2FzdFRhcmdldC5zZXRBdHRyaWJ1dGUoJ2JpbmQtdG9nZ2xlX19yYXljYXN0YWJsZScsIGRhdGEuYmluZFRvZ2dsZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByYXljYXN0VGFyZ2V0LnNldEF0dHJpYnV0ZSgnZGF0YS1yYXljYXN0YWJsZScsICcnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGRhdGEudXNlQm94VGFyZ2V0KSB7XG4gICAgICAgIC8vIDNEIHRhcmdldC5cbiAgICAgICAgZ2VvbWV0cnkgPSBib3hHZW9tZXRyeTtcbiAgICAgICAgZ2VvbWV0cnkuZGVwdGggPSBkYXRhLmRlcHRoO1xuICAgICAgICBnZW9tZXRyeS5oZWlnaHQgPSBkYXRhLmhlaWdodDtcbiAgICAgICAgZ2VvbWV0cnkud2lkdGggPSBkYXRhLndpZHRoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gMkQgdGFyZ2V0LlxuICAgICAgICBnZW9tZXRyeSA9IHBsYW5lR2VvbWV0cnk7XG4gICAgICAgIGdlb21ldHJ5LmhlaWdodCA9IGRhdGEuaGVpZ2h0O1xuICAgICAgICBnZW9tZXRyeS53aWR0aCA9IGRhdGEud2lkdGg7XG4gICAgICB9XG4gICAgICByYXljYXN0VGFyZ2V0LnNldEF0dHJpYnV0ZSgnZ2VvbWV0cnknLCBnZW9tZXRyeSk7XG5cbiAgICAgIHJheWNhc3RUYXJnZXQub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgcmF5Y2FzdFRhcmdldC5vYmplY3QzRC5wb3NpdGlvbi5jb3B5KGRhdGEucG9zaXRpb24pO1xuICAgICAgcmF5Y2FzdFRhcmdldC5vYmplY3QzRC5yb3RhdGlvbi54ID0gVEhSRUUuTWF0aC5kZWdUb1JhZChkYXRhLnJvdGF0aW9uLngpO1xuICAgICAgcmF5Y2FzdFRhcmdldC5vYmplY3QzRC5yb3RhdGlvbi55ID0gVEhSRUUuTWF0aC5kZWdUb1JhZChkYXRhLnJvdGF0aW9uLnkpO1xuICAgICAgcmF5Y2FzdFRhcmdldC5vYmplY3QzRC5yb3RhdGlvbi56ID0gVEhSRUUuTWF0aC5kZWdUb1JhZChkYXRhLnJvdGF0aW9uLnopO1xuXG4gICAgICBlbC5hcHBlbmRDaGlsZChyYXljYXN0VGFyZ2V0KTtcbiAgICB9O1xuICB9KSgpXG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3JheWNhc3Rlci10YXJnZXQuanMiLCIvKipcbiAqIFJlY2VudGVyIGNhbWVyYSBiYWNrIHRvIGZhY2luZyBkb3duIG5lZ2F0aXZlIFogYXhpcyBhdCAwLCAwLCAwLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3JlY2VudGVyJywge1xuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNjZW5lRWwgPSB0aGlzLmVsLnNjZW5lRWw7XG4gICAgdGhpcy5yZWNlbnRlciA9IHRoaXMucmVjZW50ZXIuYmluZCh0aGlzKTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1t0cmFja2VkLWNvbnRyb2xzXScpLmZvckVhY2goY29udHJvbEVsID0+IHtcbiAgICAgIGNvbnRyb2xFbC5hZGRFdmVudExpc3RlbmVyKCdtZW51ZG93bicsIHRoaXMucmVjZW50ZXIpO1xuICAgICAgY29udHJvbEVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RodW1ic3RpY2tkb3duJywgdGhpcy5yZWNlbnRlcik7XG4gICAgfSk7XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3JlY2VudGVyJywgdGhpcy5yZWNlbnRlcik7XG4gIH0sXG5cbiAgcmVjZW50ZXI6IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV1bGVyID0gbmV3IFRIUkVFLkV1bGVyKCk7XG4gICAgdmFyIG1hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KCk7XG4gICAgdmFyIHJvdGF0aW9uTWF0cml4ID0gbmV3IFRIUkVFLk1hdHJpeDQoKTtcbiAgICB2YXIgdHJhbnNsYXRpb25NYXRyaXggPSBuZXcgVEhSRUUuTWF0cml4NCgpO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcblxuICAgICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cblxuICAgICAgY29uc3QgY2FtZXJhID0gZWwuc2NlbmVFbC5jYW1lcmEuZWwub2JqZWN0M0Q7XG5cbiAgICAgIC8vIFJlc2V0IG1hdHJpeC5cbiAgICAgIG1hdHJpeC5pZGVudGl0eSgpO1xuXG4gICAgICAvLyBDcmVhdGUgbWF0cml4IHRvIHJlc2V0IFkgcm90YXRpb24uXG4gICAgICBldWxlci5zZXQoMCwgLTEgKiBjYW1lcmEucm90YXRpb24ueSwgMCk7XG4gICAgICByb3RhdGlvbk1hdHJpeC5tYWtlUm90YXRpb25Gcm9tRXVsZXIoZXVsZXIpO1xuXG4gICAgICAvLyBDcmVhdGUgbWF0cml4IHRvIHplcm8gcG9zaXRpb24uXG4gICAgICB0cmFuc2xhdGlvbk1hdHJpeC5tYWtlVHJhbnNsYXRpb24oLTEgKiBjYW1lcmEucG9zaXRpb24ueCwgMCwgLTEgKiBjYW1lcmEucG9zaXRpb24ueik7XG5cbiAgICAgIC8vIE11bHRpcGx5IGFuZCBkZWNvbXBvc2UgYmFjayB0byBvYmplY3QzRC5cbiAgICAgIG1hdHJpeC5tdWx0aXBseShyb3RhdGlvbk1hdHJpeCkubXVsdGlwbHkodHJhbnNsYXRpb25NYXRyaXgpO1xuICAgICAgbWF0cml4LmRlY29tcG9zZShlbC5vYmplY3QzRC5wb3NpdGlvbiwgZWwub2JqZWN0M0QucXVhdGVybmlvbiwgZWwub2JqZWN0M0Quc2NhbGUpO1xuICAgICAgZWwub2JqZWN0M0QudXBkYXRlTWF0cml4V29ybGQodHJ1ZSk7XG4gICAgICBlbC5lbWl0KCdyZWNlbnRlcmVkJywgbnVsbCwgZmFsc2UpO1xuICAgIH07XG4gIH0pKClcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvcmVjZW50ZXIuanMiLCIvKipcbiAqIENvbnRyb2xsZXIsIGN1cnNvciwgcmF5Y2FzdGVyLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NhYmVyLWNvbnRyb2xzJywge1xuICBzY2hlbWE6IHtcbiAgICBibGFkZUVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaGFuZDoge2RlZmF1bHQ6ICdyaWdodCcsIG9uZU9mOiBbJ2xlZnQnLCAncmlnaHQnXX0sXG4gICAgaXNQYXVzZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgc3Ryb2tlTWluU3BlZWQ6IHtkZWZhdWx0OiAwLjAwMn0sXG4gICAgc3Ryb2tlTWluRHVyYXRpb246IHtkZWZhdWx0OiA0MH1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIHRoaXMuYm91bmRpbmdCb3ggPSBuZXcgVEhSRUUuQm94MygpO1xuICAgIHRoaXMuY29udHJvbGxlclR5cGUgPSAnJztcbiAgICB0aGlzLnhQbGFuZU5vcm1hbCA9IG5ldyBUSFJFRS5WZWN0b3IzKDAsIDEsIDApO1xuICAgIHRoaXMueVBsYW5lTm9ybWFsID0gbmV3IFRIUkVFLlZlY3RvcjMoMSwgMCwgMCk7XG4gICAgdGhpcy54eVBsYW5lTm9ybWFsID0gbmV3IFRIUkVFLlZlY3RvcjMoMSwgMSwgMCk7XG4gICAgdGhpcy5ibGFkZVRpcFBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLmJsYWRlUG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuYmxhZGVWZWN0b3IgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuYmxhZGVUaXBQcmV2aW91c1Bvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLnByb2plY3RlZEJsYWRlVmVjdG9yID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLnNhYmVyUG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuc3dpbmdpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnN0cm9rZUNvdW50ID0gMDtcbiAgICB0aGlzLmRpc3RhbmNlU2FtcGxlcyA9IFtdO1xuICAgIHRoaXMuZGVsdGFTYW1wbGVzID0gW107XG4gICAgdGhpcy5zdGFydFN0cm9rZVBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLnN0cm9rZURpcmVjdGlvblZlY3RvciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5zdHJva2VEaXJlY3Rpb24gPSB7XG4gICAgICBkb3duOiBmYWxzZSxcbiAgICAgIGxlZnQ6IGZhbHNlLFxuICAgICAgcmlnaHQ6IGZhbHNlLFxuICAgICAgdXA6IGZhbHNlXG4gICAgfTtcbiAgICB0aGlzLmFjY3VtdWxhdGVkRGlzdGFuY2UgPSAwO1xuICAgIHRoaXMuYWNjdW11bGF0ZWREZWx0YSA9IDA7XG5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjb250cm9sbGVyY29ubmVjdGVkJywgdGhpcy5pbml0U2FiZXIuYmluZCh0aGlzKSk7XG5cbiAgICBjb25zdCBoYW5kID0ge2hhbmQ6IGRhdGEuaGFuZCwgbW9kZWw6IGZhbHNlfTtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoJ29jdWx1cy10b3VjaC1jb250cm9scycsIGhhbmQpO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgndml2ZS1jb250cm9scycsIGhhbmQpO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnd2luZG93cy1tb3Rpb24tY29udHJvbHMnLCBoYW5kKTtcblxuICAgIHRoaXMuYmxhZGVFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLmJsYWRlJyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGlmICghb2xkRGF0YS5ibGFkZUVuYWJsZWQgJiYgdGhpcy5kYXRhLmJsYWRlRW5hYmxlZCkge1xuICAgICAgdGhpcy5ibGFkZUVsLmVtaXQoJ2RyYXdibGFkZScpO1xuICAgIH1cbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5ibGFkZUVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5ib3VuZGluZ0JveC5zZXRGcm9tT2JqZWN0KHRoaXMuYmxhZGVFbC5nZXRPYmplY3QzRCgnbWVzaCcpKTtcbiAgICB0aGlzLmRldGVjdFN0cm9rZShkZWx0YSk7XG4gIH0sXG5cbiAgZGV0ZWN0U3Ryb2tlOiBmdW5jdGlvbiAoZGVsdGEpIHtcbiAgICB2YXIgZGlzdGFuY2U7XG4gICAgdmFyIGRpc3RhbmNlU2FtcGxlcyA9IHRoaXMuZGlzdGFuY2VTYW1wbGVzO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBkaXJlY3Rpb25DaGFuZ2U7XG5cbiAgICAvLyBUaXAgb2YgdGhlIGJsYWRlIHBvc2l0aW9uIGluIHdvcmxkIGNvb3JkaW5hdGVzLlxuICAgIHRoaXMuYmxhZGVUaXBQb3NpdGlvbi5zZXQoMCwgMCwgLTAuOCk7XG4gICAgdGhpcy5ibGFkZVBvc2l0aW9uLnNldCgwLCAwLCAwKTtcblxuICAgIGNvbnN0IHNhYmVyT2JqID0gdGhpcy5lbC5vYmplY3QzRDtcbiAgICBzYWJlck9iai5wYXJlbnQudXBkYXRlTWF0cml4V29ybGQoKTtcbiAgICBzYWJlck9iai5sb2NhbFRvV29ybGQodGhpcy5ibGFkZVRpcFBvc2l0aW9uKTtcbiAgICBzYWJlck9iai5sb2NhbFRvV29ybGQodGhpcy5ibGFkZVBvc2l0aW9uKTtcblxuICAgIC8vIEFuZ2xlcyBiZXR3ZWVuIHNhYmVyIGFuZCBtYWpvciBwbGFuZXMuXG4gICAgdGhpcy5ibGFkZVZlY3Rvci5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbikuc3ViKHRoaXMuYmxhZGVQb3NpdGlvbikubm9ybWFsaXplKCk7XG4gICAgdmFyIGFuZ2xlUGxhbmVYID0gdGhpcy5wcm9qZWN0ZWRCbGFkZVZlY3Rvci5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbikucHJvamVjdE9uUGxhbmUodGhpcy54UGxhbmVOb3JtYWwpLmFuZ2xlVG8odGhpcy5ibGFkZVZlY3Rvcik7XG4gICAgdmFyIGFuZ2xlUGxhbmVZID0gdGhpcy5wcm9qZWN0ZWRCbGFkZVZlY3Rvci5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbikucHJvamVjdE9uUGxhbmUodGhpcy55UGxhbmVOb3JtYWwpLmFuZ2xlVG8odGhpcy5ibGFkZVZlY3Rvcik7XG4gICAgdmFyIGFuZ2xlUGxhbmVYWSA9IHRoaXMucHJvamVjdGVkQmxhZGVWZWN0b3IuY29weSh0aGlzLmJsYWRlVGlwUG9zaXRpb24pLnByb2plY3RPblBsYW5lKHRoaXMueHlQbGFuZU5vcm1hbCkuYW5nbGVUbyh0aGlzLmJsYWRlVmVjdG9yKTtcblxuICAgIC8vIERpc3RhbmNlIGNvdmVyZWQgYnV0IHRoZSBzYWJlciB0aXAgaW4gb25lIGZyYW1lLlxuICAgIGRpc3RhbmNlID0gdGhpcy5ibGFkZVRpcFByZXZpb3VzUG9zaXRpb24uc3ViKHRoaXMuYmxhZGVUaXBQb3NpdGlvbikubGVuZ3RoKCk7XG5cbiAgICAvLyBTYW1wbGUgZGlzdGFuY2Ugb2YgdGhlIGxhc3QgNSBmcmFtZXMuXG4gICAgaWYgKHRoaXMuZGlzdGFuY2VTYW1wbGVzLmxlbmd0aCA9PT0gNSkge1xuICAgICAgdGhpcy5hY2N1bXVsYXRlZERpc3RhbmNlIC09IHRoaXMuZGlzdGFuY2VTYW1wbGVzLnNoaWZ0KCk7XG4gICAgICB0aGlzLmFjY3VtdWxhdGVkRGVsdGEgLT0gdGhpcy5kZWx0YVNhbXBsZXMuc2hpZnQoKTtcbiAgICB9XG4gICAgdGhpcy5kaXN0YW5jZVNhbXBsZXMucHVzaChkaXN0YW5jZSk7XG4gICAgdGhpcy5hY2N1bXVsYXRlZERpc3RhbmNlICs9IGRpc3RhbmNlO1xuXG4gICAgdGhpcy5kZWx0YVNhbXBsZXMucHVzaChkZWx0YSk7XG4gICAgdGhpcy5hY2N1bXVsYXRlZERlbHRhICs9IGRlbHRhO1xuXG4gICAgLy8gRmlsdGVyIG91dCBzYWJlciBtb3ZlbWVudHMgdGhhdCBhcmUgdG9vIHNsb3cuIFRvbyBzbG93IGlzIGNvbnNpZGVyZWQgd3JvbmcgaGl0LlxuICAgIGlmICh0aGlzLmFjY3VtdWxhdGVkRGlzdGFuY2UgLyB0aGlzLmFjY3VtdWxhdGVkRGVsdGEgPiB0aGlzLmRhdGEuc3Ryb2tlTWluU3BlZWQpIHtcbiAgICAgIC8vIFRoaXMgZmlsdGVycyBvdXQgdW5pbnRlbnRpb25hbCBzd2luZ3MuXG4gICAgICBpZiAoIXRoaXMuc3dpbmdpbmcpIHtcbiAgICAgICAgdGhpcy5zdGFydFN0cm9rZVBvc2l0aW9uLmNvcHkodGhpcy5ibGFkZVRpcFBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5zd2luZ2luZyA9IHRydWU7XG4gICAgICAgIHRoaXMuc3Ryb2tlRHVyYXRpb24gPSAwO1xuICAgICAgICB0aGlzLm1heEFuZ2xlUGxhbmVYID0gMDtcbiAgICAgICAgdGhpcy5tYXhBbmdsZVBsYW5lWSA9IDA7XG4gICAgICAgIHRoaXMubWF4QW5nbGVQbGFuZVhZID0gMDtcbiAgICAgIH1cbiAgICAgIHRoaXMudXBkYXRlU3Ryb2tlRGlyZWN0aW9uKCk7XG4gICAgICB0aGlzLnN0cm9rZUR1cmF0aW9uICs9IGRlbHRhO1xuICAgICAgY29uc3QgYW5nbGVQbGFuZVhJbmNyZWFzZWQgPSBhbmdsZVBsYW5lWCA+IHRoaXMubWF4QW5nbGVQbGFuZVg7XG4gICAgICBjb25zdCBhbmdsZVBsYW5lWUluY3JlYXNlZCA9IGFuZ2xlUGxhbmVZID4gdGhpcy5tYXhBbmdsZVBsYW5lWTtcbiAgICAgIGNvbnN0IGFuZ2xlUGxhbmVYWUluY3JlYXNlZCA9IGFuZ2xlUGxhbmVYWSA+IHRoaXMubWF4QW5nbGVQbGFuZVhZO1xuICAgICAgdGhpcy5tYXhBbmdsZVBsYW5lWCA9IGFuZ2xlUGxhbmVYSW5jcmVhc2VkID8gYW5nbGVQbGFuZVggOiB0aGlzLm1heEFuZ2xlUGxhbmVYO1xuICAgICAgdGhpcy5tYXhBbmdsZVBsYW5lWSA9IGFuZ2xlUGxhbmVZSW5jcmVhc2VkID8gYW5nbGVQbGFuZVkgOiB0aGlzLm1heEFuZ2xlUGxhbmVZO1xuICAgICAgdGhpcy5tYXhBbmdsZVBsYW5lWFkgPSBhbmdsZVBsYW5lWFlJbmNyZWFzZWQgPyBhbmdsZVBsYW5lWFkgOiB0aGlzLm1heEFuZ2xlUGxhbmVYWTtcbiAgICAgIGlmICghYW5nbGVQbGFuZVhJbmNyZWFzZWQgJiYgIWFuZ2xlUGxhbmVZSW5jcmVhc2VkKSB7IHRoaXMuZW5kU3Ryb2tlKCk7IH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbmRTdHJva2UoKTtcbiAgICB9XG5cbiAgICB0aGlzLmJsYWRlVGlwUHJldmlvdXNQb3NpdGlvbi5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbik7XG4gIH0sXG5cbiAgZW5kU3Ryb2tlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLnN3aW5naW5nIHx8IHRoaXMuc3Ryb2tlRHVyYXRpb24gPCB0aGlzLmRhdGEuc3Ryb2tlTWluRHVyYXRpb24pIHsgcmV0dXJuOyB9XG5cbiAgICB0aGlzLmVsLmVtaXQoJ3N0cm9rZWVuZCcpO1xuICAgIHRoaXMuc3dpbmdpbmcgPSBmYWxzZTtcbiAgICAvLyBTdHJva2UgZmluaXNoZXMuIFJlc2V0IHN3aW5naW5nIHN0YXRlLlxuICAgIHRoaXMuYWNjdW11bGF0ZWREaXN0YW5jZSA9IDA7XG4gICAgdGhpcy5hY2N1bXVsYXRlZERlbHRhID0gMDtcbiAgICB0aGlzLm1heEFuZ2xlUGxhbmVYID0gMDtcbiAgICB0aGlzLm1heEFuZ2xlUGxhbmVZID0gMDtcbiAgICB0aGlzLm1heEFuZ2xlUGxhbmVYWSA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRpc3RhbmNlU2FtcGxlcy5sZW5ndGg7IGkrKykgeyB0aGlzLmRpc3RhbmNlU2FtcGxlc1tpXSA9IDA7IH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGVsdGFTYW1wbGVzLmxlbmd0aDsgaSsrKSB7IHRoaXMuZGVsdGFTYW1wbGVzW2ldID0gMDsgfVxuICB9LFxuXG4gIHVwZGF0ZVN0cm9rZURpcmVjdGlvbjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc3Ryb2tlRGlyZWN0aW9uVmVjdG9yLmNvcHkodGhpcy5ibGFkZVRpcFBvc2l0aW9uKS5zdWIodGhpcy5zdGFydFN0cm9rZVBvc2l0aW9uKTtcbiAgICBpZiAodGhpcy5zdHJva2VEaXJlY3Rpb25WZWN0b3IueCA9PT0gMCAmJiB0aGlzLnN0cm9rZURpcmVjdGlvblZlY3Rvci55ID09PSAwKSB7IHJldHVybjsgfVxuICAgIHRoaXMuc3Ryb2tlRGlyZWN0aW9uLnJpZ2h0ID0gdGhpcy5zdHJva2VEaXJlY3Rpb25WZWN0b3IueCA+IDA7XG4gICAgdGhpcy5zdHJva2VEaXJlY3Rpb24ubGVmdCA9IHRoaXMuc3Ryb2tlRGlyZWN0aW9uVmVjdG9yLnggPCAwO1xuICAgIHRoaXMuc3Ryb2tlRGlyZWN0aW9uLnVwID0gdGhpcy5zdHJva2VEaXJlY3Rpb25WZWN0b3IueSA+IDA7XG4gICAgdGhpcy5zdHJva2VEaXJlY3Rpb24uZG93biA9IHRoaXMuc3Ryb2tlRGlyZWN0aW9uVmVjdG9yLnkgPCAwO1xuICB9LFxuXG4gIGluaXRTYWJlcjogZnVuY3Rpb24gKGV2dCkge1xuICAgIHRoaXMuY29udHJvbGxlclR5cGUgPSBldnQuZGV0YWlsLm5hbWU7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ2N1cnNvcicsIHRoaXMuY29uZmlnW3RoaXMuY29udHJvbGxlclR5cGVdLmN1cnNvciB8fCB7fSk7XG4gIH0sXG5cbiAgY29uZmlnOiB7XG4gICAgJ29jdWx1cy10b3VjaC1jb250cm9scyc6IHtcbiAgICAgIGN1cnNvcjoge1xuICAgICAgICBkb3duRXZlbnRzOiBbXG4gICAgICAgICAgJ3RyaWdnZXJkb3duJyxcbiAgICAgICAgICAnZ3JpcGRvd24nLFxuICAgICAgICAgICdhYnV0dG9uZG93bicsXG4gICAgICAgICAgJ2JidXR0b25kb3duJyxcbiAgICAgICAgICAneGJ1dHRvbmRvd24nLFxuICAgICAgICAgICd5YnV0dG9uZG93bidcbiAgICAgICAgXSxcbiAgICAgICAgdXBFdmVudHM6IFtcbiAgICAgICAgICAndHJpZ2dlcnVwJyxcbiAgICAgICAgICAnZ3JpcHVwJyxcbiAgICAgICAgICAnYWJ1dHRvbnVwJyxcbiAgICAgICAgICAnYmJ1dHRvbnVwJyxcbiAgICAgICAgICAneGJ1dHRvbnVwJyxcbiAgICAgICAgICAneWJ1dHRvbnVwJ1xuICAgICAgICBdXG4gICAgICB9XG4gICAgfSxcblxuICAgICd2aXZlLWNvbnRyb2xzJzoge1xuICAgICAgY3Vyc29yOiB7XG4gICAgICAgIGRvd25FdmVudHM6IFsndHJhY2twYWRkb3duJywgJ3RyaWdnZXJkb3duJywgJ2dyaXBkb3duJ10sXG4gICAgICAgIHVwRXZlbnRzOiBbJ3RyYWNrcGFkdXAnLCAndHJpZ2dlcnVwJywgJ2dyaXB1cCddXG4gICAgICB9XG4gICAgfSxcblxuICAgICd3aW5kb3dzLW1vdGlvbi1jb250cm9scyc6IHtcbiAgICAgIGN1cnNvcjoge1xuICAgICAgICBkb3duRXZlbnRzOiBbJ3RyYWNrcGFkZG93bicsICd0cmlnZ2VyZG93bicsICdncmlwZG93biddLFxuICAgICAgICB1cEV2ZW50czogWyd0cmFja3BhZHVwJywgJ3RyaWdnZXJ1cCcsICdncmlwdXAnXVxuICAgICAgfVxuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zYWJlci1jb250cm9scy5qcyIsImNvbnN0IEhJVF9MRUZUID0gJ2hpdExlZnQnO1xuY29uc3QgSElUX1JJR0hUID0gJ2hpdFJpZ2h0JztcbmNvbnN0IExFRlQgPSAnbGVmdCc7XG5jb25zdCBSSUdIVCA9ICdyaWdodCc7XG5cbi8qKlxuICogU2hvdyBwYXJ0aWNsZXMgd2hlbiB0b3VjaGVkIGJ5IHNhYmVyLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NhYmVyLXBhcnRpY2xlcycsIHtcbiAgc2NoZW1hOiB7XG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBoYW5kOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaGlkZGVuSW50ZXJzZWN0aW9uID0ge3g6IDk5OSwgeTogMCwgejogMH07XG4gICAgdGhpcy5pbnRlcnNlY3RlZEVsID0gbnVsbDtcblxuICAgIHRoaXMucGFydGljbGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NwYXJrUGFydGljbGVzJyk7XG4gICAgdGhpcy5wYXJ0aWNsZUV2ZW50RGV0YWlsID0ge3Bvc2l0aW9uOiBuZXcgVEhSRUUuVmVjdG9yMygpLCByb3RhdGlvbjogbmV3IFRIUkVFLkV1bGVyKCl9O1xuICAgIHRoaXMucGFydGljbGVFdmVudCA9IHtkZXRhaWw6IHRoaXMucGFydGljbGVFdmVudERldGFpbH07XG4gICAgdGhpcy5wYXJ0aWNsZVN5c3RlbSA9IG51bGw7XG5cbiAgICB0aGlzLnNhYmVyRW50ZXIgPSB0aGlzLnNhYmVyRW50ZXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNhYmVyTGVhdmUgPSB0aGlzLnNhYmVyTGVhdmUuYmluZCh0aGlzKTtcblxuICB9LFxuXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgdGhpcy5zYWJlckVudGVyKTtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLnNhYmVyTGVhdmUpO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCB0aGlzLnNhYmVyRW50ZXIpO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMuc2FiZXJMZWF2ZSk7XG4gICAgdGhpcy5wYXJ0aWNsZXNEdXIgPSB0aGlzLnBhcnRpY2xlcy5nZXRBdHRyaWJ1dGUoJ3BhcnRpY2xlcGxheWVyJykuZHVyO1xuICB9LFxuXG4gIHNhYmVyRW50ZXI6IGZ1bmN0aW9uIChldnQpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgIGlmIChldnQudGFyZ2V0ICE9PSB0aGlzLmVsKSB7IHJldHVybjsgfVxuICAgIGlmICghZXZ0LmRldGFpbC5pbnRlcnNlY3RlZEVsLmhhc0F0dHJpYnV0ZSgnZGF0YS1zYWJlci1wYXJ0aWNsZXMnKSkgeyByZXR1cm47IH1cbiAgICB0aGlzLmludGVyc2VjdGVkRWwgPSBldnQuZGV0YWlsLmludGVyc2VjdGVkRWw7XG4gIH0sXG5cbiAgc2FiZXJMZWF2ZTogZnVuY3Rpb24gKGV2dCkge1xuICAgIGlmIChldnQuZGV0YWlsLnRhcmdldCAhPT0gdGhpcy5lbCkgeyByZXR1cm47IH1cblxuICAgIC8vIEhpZGUgaGl0IGludGVyc2VjdGlvbiB0ZXh0dXJlLlxuICAgIGlmICh0aGlzLmludGVyc2VjdGVkRWwuY29tcG9uZW50cy53YWxsIHx8IHRoaXMuaW50ZXJzZWN0ZWRFbC5pZCA9PT0gJ2Zsb29yJykge1xuICAgICAgY29uc3QgdW5pZm9ybSA9IHRoaXMuZGF0YS5oYW5kID09PSBSSUdIVCA/IEhJVF9SSUdIVCA6IEhJVF9MRUZUO1xuICAgICAgY29uc3QgbWF0ZXJpYWwgPSB0aGlzLmludGVyc2VjdGVkRWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbDtcbiAgICAgIG1hdGVyaWFsLnVuaWZvcm1zW3VuaWZvcm1dLnZhbHVlID0gdGhpcy5oaWRkZW5JbnRlcnNlY3Rpb247XG4gICAgfVxuICAgIHRoaXMuaW50ZXJzZWN0ZWRFbCA9IG51bGw7XG4gICAgdGhpcy5wYXJ0aWNsZVN5c3RlbSA9IG51bGw7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCB8fCAhdGhpcy5pbnRlcnNlY3RlZEVsKSB7IHJldHVybjsgfVxuXG4gICAgY29uc3QgcmF5Y2FzdGVyID0gdGhpcy5lbC5jb21wb25lbnRzLnJheWNhc3Rlcl9fZ2FtZTtcbiAgICBjb25zdCBpbnRlcnNlY3Rpb24gPSByYXljYXN0ZXIuZ2V0SW50ZXJzZWN0aW9uKHRoaXMuaW50ZXJzZWN0ZWRFbCk7XG5cbiAgICBpZiAoIWludGVyc2VjdGlvbikgeyByZXR1cm47IH1cblxuICAgIC8vIFVwZGF0ZSBpbnRlcnNlY3Rpb24gbWF0ZXJpYWwgaWYgbmVjZXNzYXJ5LlxuICAgIC8qXG4gICAgaWYgKHRoaXMuaW50ZXJzZWN0ZWRFbC5jb21wb25lbnRzLndhbGwgfHwgdGhpcy5pbnRlcnNlY3RlZEVsLmlkID09PSAnZmxvb3InKSB7XG4gICAgICBjb25zdCB1bmlmb3JtID0gdGhpcy5kYXRhLmhhbmQgPT09IFJJR0hUID8gSElUX1JJR0hUIDogSElUX0xFRlQ7XG4gICAgICBjb25zdCBtYXRlcmlhbCA9IHRoaXMuaW50ZXJzZWN0ZWRFbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsO1xuICAgICAgbWF0ZXJpYWwudW5pZm9ybXNbdW5pZm9ybV0udmFsdWUgPSBpbnRlcnNlY3Rpb24ucG9pbnQ7XG4gICAgfVxuICAgICovXG5cbiAgICBpZiAodGhpcy5wYXJ0aWNsZVN5c3RlbSAmJiB0aGlzLnBhcnRpY2xlU3lzdGVtLmFjdGl2ZSkge1xuICAgICAgLy8gVXBkYXRlIHBhcnRpY2xlIHBvc2l0aW9uLlxuICAgICAgdGhpcy5wYXJ0aWNsZVN5c3RlbS5tZXNoLnBvc2l0aW9uLmNvcHkoaW50ZXJzZWN0aW9uLnBvaW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU3RhcnQgcGFydGljbGUgc3lzdGVtLlxuICAgICAgdGhpcy5wYXJ0aWNsZUV2ZW50RGV0YWlsLnBvc2l0aW9uLmNvcHkoaW50ZXJzZWN0aW9uLnBvaW50KTtcbiAgICAgIHRoaXMucGFydGljbGVTeXN0ZW0gPSB0aGlzLnBhcnRpY2xlcy5jb21wb25lbnRzLnBhcnRpY2xlcGxheWVyLnN0YXJ0QWZ0ZXJEZWxheShcbiAgICAgICAgdGhpcy5wYXJ0aWNsZUV2ZW50KTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc2FiZXItcGFydGljbGVzLmpzIiwiLyoqXG4gKiBTY29yZSBiZWF0LCBhdXRvLXJldHVybiB0byBwb29sIGluIDEuMnMuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc2NvcmUtYmVhdCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgdHlwZTogeyB0eXBlOiAnc3RyaW5nJyB9XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMucG9vbENvbXBvbmVudCA9IGBwb29sX19iZWF0c2NvcmUke3RoaXMuZGF0YS50eXBlfWA7XG4gICAgdGhpcy5zdGFydFRpbWUgPSB0aGlzLmVsLnNjZW5lRWwudGltZTtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSkge1xuICAgIGlmICh0aW1lID4gdGhpcy5zdGFydFRpbWUgKyAxMjAwKSB7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50c1t0aGlzLnBvb2xDb21wb25lbnRdLnJldHVybkVudGl0eSh0aGlzLmVsKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc2NvcmUtYmVhdC5qcyIsIi8qKlxuICogU2NvcmUgdGV4dCBmYWRlIGluIGFuaW1hdGlvbi5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzY29yZS10ZXh0cycsIHtcbiAgc2NoZW1hOiB7XG4gICAgaXNTb25nTG9hZGluZzoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnRleHRFbHMgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ1t0ZXh0XScpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRleHRFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMudGV4dEVsc1tpXS5zZXRBdHRyaWJ1dGUoJ2FuaW1hdGlvbl9fZmFkZWluJywge1xuICAgICAgICBhdXRvcGxheTogZmFsc2UsXG4gICAgICAgIHByb3BlcnR5Oidjb21wb25lbnRzLnRleHQubWF0ZXJpYWwudW5pZm9ybXMub3BhY2l0eS52YWx1ZScsXG4gICAgICAgIGRlbGF5OiAyNTAsXG4gICAgICAgIGR1cjogNzUwLFxuICAgICAgICBlYXNpbmc6ICdlYXNlSW5PdXRDdWJpYycsXG4gICAgICAgIGZyb206IDAsXG4gICAgICAgIHRvOiAxXG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIC8vIEZpbmlzaGVkIGxvYWRpbmcuXG4gICAgaWYgKG9sZERhdGEuaXNTb25nTG9hZGluZyAmJiAhdGhpcy5kYXRhLmlzU29uZ0xvYWRpbmcpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50ZXh0RWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMudGV4dEVsc1tpXS5jb21wb25lbnRzWydhbmltYXRpb25fX2ZhZGVpbiddLmJlZ2luQW5pbWF0aW9uKCk7XG4gICAgICB9XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgndGV4dGdsb3dub3JtYWwnLCBudWxsLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgLy8gU3RhcnRlZCBsb2FkaW5nLlxuICAgIGlmICghb2xkRGF0YS5pc1NvbmdMb2FkaW5nICYmIHRoaXMuZGF0YS5pc1NvbmdMb2FkaW5nKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudGV4dEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLnRleHRFbHNbaV0uY29tcG9uZW50cy50ZXh0Lm1hdGVyaWFsLnVuaWZvcm1zLm9wYWNpdHkudmFsdWUgPSAwO1xuICAgICAgfVxuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3RleHRnbG93b2ZmJywgbnVsbCwgZmFsc2UpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zY29yZS10ZXh0cy5qcyIsImltcG9ydCB1dGlscyBmcm9tICcuLi91dGlscyc7XG5cbnZhciBDQU5WQVNfSEVJR0hUID0gNTEyOyAgLy8gUG93ZXItb2YtdHdvLlxudmFyIEhFSUdIVCA9IDY0O1xudmFyIE5VTV9QRVJfUEFHRSA9IDY7XG52YXIgV0lEVEggPSA2NDtcblxuLy8gQXBwbHkgaGVpZ2h0IGZhY3RvciBzaW5jZSB0aGUgaW1hZ2VzIGRvbid0IHJlYWNoIHRoZSBwb3dlci1vZi10d28gaGVpZ2h0LCBuZWVkIHRvIHN0cmV0Y2guXG52YXIgSEVJR0hUX0ZBQ1RPUiA9IENBTlZBU19IRUlHSFQgLyAoSEVJR0hUICogTlVNX1BFUl9QQUdFKTtcbnZhciBJTUFHRV9IRUlHSFRfQ0FOVkFTID0gSEVJR0hUICogSEVJR0hUX0ZBQ1RPUjtcblxuLyoqXG4gKiBDcmVhdGUgdGh1bWJuYWlsIGF0bGFzIGZvciBhbGwgdGhlIHRodW1ibmFpbCBpbWFnZXMgdG9nZXRoZXIgcGVyIHBhZ2UuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc2VhcmNoLXRodW1ibmFpbC1hdGxhcycsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ2dlb21ldHJ5JywgJ21hdGVyaWFsJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgZHVtbXlVcGRhdGVyOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIC8vIENyZWF0ZSBjYW52YXMgZm9yIHRleHR1cmUgYXRsYXMuXG4gICAgY29uc3QgY2FudmFzID0gdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdpZCcsICd0aHVtYm5haWxBdGxhc01hcCcpO1xuICAgIGNhbnZhcy5oZWlnaHQgPSBDQU5WQVNfSEVJR0hUOyAgLy8gUG93ZXItb2YtdHdvLlxuICAgIGNhbnZhcy53aWR0aCA9IFdJRFRIO1xuICAgIHRoaXMuY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgdGhpcy5jbGVhckNhbnZhcygpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKTtcblxuICAgIC8vIEFscGhhIG1hcCBmb3Igd2hlbiBzZWFyY2ggcmVzdWx0cyBkb24ndCBjb250YWluIG1heCBudW1iZXIgb2YgcmVzdWx0cy5cbiAgICBjb25zdCBhbHBoYUNhbnZhcyA9IHRoaXMuYWxwaGFDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICBhbHBoYUNhbnZhcy5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3RodW1ibmFpbEFscGhhTWFwJyk7XG4gICAgYWxwaGFDYW52YXMuaGVpZ2h0ID0gQ0FOVkFTX0hFSUdIVDtcbiAgICBhbHBoYUNhbnZhcy53aWR0aCA9IFdJRFRIO1xuICAgIHRoaXMuYWxwaGFDdHggPSBhbHBoYUNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYWxwaGFDYW52YXMpO1xuXG4gICAgdGhpcy5lbC5jb21wb25lbnRzLm1hdGVyaWFsLm1hdGVyaWFsLmFscGhhTWFwID0gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUoYWxwaGFDYW52YXMpO1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsICdzcmMnLCBjYW52YXMpO1xuICAgIHRoaXMuaW1hZ2VzID0gW107XG5cbiAgICB0aGlzLmxhc3ROdW1SZXN1bHRzID0gTlVNX1BFUl9QQUdFO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG5cbiAgICBjb25zdCByZXN1bHRzID0gZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlLnN0YXRlLnNlYXJjaFJlc3VsdHNQYWdlO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0cy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGltZyA9IHRoaXMuaW1hZ2VzW2ldID0gdGhpcy5pbWFnZXNbaV0gfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgICBpbWcuY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJztcbiAgICAgIGltZy5zcmMgPSB1dGlscy5nZXRTM0ZpbGVVcmwocmVzdWx0c1tpXS5pZCwgJ2ltYWdlLmpwZycpO1xuICAgICAgaWYgKGltZy5jb21wbGV0ZSkge1xuICAgICAgICB0aGlzLmRyYXcoaW1nLCBpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5kcmF3KGltZywgaSk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGFscGhhIG1hcC5cbiAgICBpZiAocmVzdWx0cy5sZW5ndGggIT09IHRoaXMubGFzdE51bVJlc3VsdHMpIHsgdGhpcy51cGRhdGVBbHBoYU1hcChyZXN1bHRzLmxlbmd0aCk7IH1cbiAgICB0aGlzLmxhc3ROdW1SZXN1bHRzID0gcmVzdWx0cy5sZW5ndGg7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERyYXcgdGh1bWJuYWlsIG9uIGNhbnZhcyBhdCByb3cgaS5cbiAgICovXG4gIGRyYXc6IGZ1bmN0aW9uIChpbWcsIGkpIHtcbiAgICB0aGlzLmN0eC5kcmF3SW1hZ2UoXG4gICAgICBpbWcsXG4gICAgICAwLFxuICAgICAgaSAqIElNQUdFX0hFSUdIVF9DQU5WQVMsXG4gICAgICBXSURUSCxcbiAgICAgIElNQUdFX0hFSUdIVF9DQU5WQVMpO1xuICAgIHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5tYXAubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9LFxuXG4gIGNsZWFyQ2FudmFzOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgY2FudmFzID0gdGhpcy5jYW52YXM7XG4gICAgdGhpcy5jdHguZmlsbFN0eWxlID0gJyMxMTEnO1xuICAgIHRoaXMuY3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG4gIH0sXG5cbiAgdXBkYXRlQWxwaGFNYXA6IGZ1bmN0aW9uIChudW1SZXN1bHRzKSB7XG4gICAgY29uc3QgY2FudmFzID0gdGhpcy5hbHBoYUNhbnZhcztcbiAgICBjb25zdCBjdHggPSB0aGlzLmFscGhhQ3R4O1xuICAgIGN0eC5maWxsU3R5bGUgPSAnI0ZGRic7XG4gICAgY3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG4gICAgY3R4LmZpbGxTdHlsZSA9ICcjMDAwJztcbiAgICBjdHguZmlsbFJlY3QoXG4gICAgICAwLFxuICAgICAgbnVtUmVzdWx0cyAqIElNQUdFX0hFSUdIVF9DQU5WQVMsXG4gICAgICBjYW52YXMud2lkdGgsXG4gICAgICBjYW52YXMuaGVpZ2h0IC0gbnVtUmVzdWx0cyAqIElNQUdFX0hFSUdIVF9DQU5WQVMpO1xuICAgIHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5hbHBoYU1hcC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zZWFyY2gtdGh1bWJuYWlsLWF0bGFzLmpzIiwidmFyIGFsZ29saWFzZWFyY2ggPSByZXF1aXJlKCdhbGdvbGlhc2VhcmNoL2xpdGUnKTtcbnZhciBiaW5kRXZlbnQgPSByZXF1aXJlKCdhZnJhbWUtZXZlbnQtZGVjb3JhdG9ycycpLmJpbmRFdmVudDtcblxudmFyIGNsaWVudCA9IGFsZ29saWFzZWFyY2goJ1FVTFRPWTNaV1UnLCAnYmUwNzE2NDE5MjQ3MWRmN2U5N2U2ZmE3MGMxZDA0MWQnKTtcbnZhciBhbGdvbGlhID0gY2xpZW50LmluaXRJbmRleCgnc3VwZXJzYWJlcicpO1xuXG4vKipcbiAqIFNlYXJjaCAoaW5jbHVkaW5nIHRoZSBpbml0aWFsIGxpc3Qgb2YgcG9wdWxhciBzZWFyY2hlcykuXG4gKiBBdHRhY2hlZCB0byBzdXBlci1rZXlib2FyZC5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzZWFyY2gnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmV2ZW50RGV0YWlsID0ge3F1ZXJ5OiAnJywgcmVzdWx0czogW119O1xuICAgIHRoaXMucG9wdWxhckhpdHMgPSBudWxsO1xuICAgIHRoaXMucXVlcnlPYmplY3QgPSB7aGl0c1BlclBhZ2U6IDEwMCwgcXVlcnk6ICcnfTtcblxuICAgIC8vIFBvcHVsYXRlIHBvcHVsYXIuXG4gICAgdGhpcy5zZWFyY2goJycpO1xuXG4gICAgLy8gTGVzcyBoaXRzIG9uIG5vcm1hbCBzZWFyY2hlcy5cbiAgICB0aGlzLnF1ZXJ5T2JqZWN0LmhpdHNQZXJQYWdlID0gMzA7XG5cbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignc2VhcmNoY2xlYXInLCAoKSA9PiB7IHRoaXMuc2VhcmNoKCcnKTsgfSk7XG4gIH0sXG5cbiAgc3VwZXJrZXlib2FyZGNoYW5nZTogYmluZEV2ZW50KGZ1bmN0aW9uIChldnQpIHtcbiAgICBpZiAoZXZ0LnRhcmdldCAhPT0gdGhpcy5lbCkgeyByZXR1cm47IH1cbiAgICB0aGlzLnNlYXJjaChldnQuZGV0YWlsLnZhbHVlKTtcbiAgfSksXG5cbiAgc2VhcmNoOiBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAvLyBVc2UgY2FjaGVkIGZvciBwb3B1bGFyIGhpdHMuXG4gICAgaWYgKCFxdWVyeSAmJiB0aGlzLnBvcHVsYXJIaXRzKSB7XG4gICAgICB0aGlzLmV2ZW50RGV0YWlsLnJlc3VsdHMgPSB0aGlzLnBvcHVsYXJIaXRzO1xuICAgICAgdGhpcy5ldmVudERldGFpbC5xdWVyeSA9ICcnO1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3NlYXJjaHJlc3VsdHMnLCB0aGlzLmV2ZW50RGV0YWlsKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmV2ZW50RGV0YWlsLnF1ZXJ5ID0gcXVlcnk7XG4gICAgdGhpcy5xdWVyeU9iamVjdC5xdWVyeSA9IHF1ZXJ5O1xuICAgIGFsZ29saWEuc2VhcmNoKHRoaXMucXVlcnlPYmplY3QsIChlcnIsIGNvbnRlbnQpID0+IHtcbiAgICAgIC8vIENhY2hlIHBvcHVsYXIgaGl0cy5cbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3NlYXJjaGVycm9yJywgbnVsbCwgZmFsc2UpO1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFxdWVyeSkgeyB0aGlzLnBvcHVsYXJIaXRzID0gY29udGVudC5oaXRzOyB9XG4gICAgICB0aGlzLmV2ZW50RGV0YWlsLnJlc3VsdHMgPSBjb250ZW50LmhpdHM7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc2VhcmNocmVzdWx0cycsIHRoaXMuZXZlbnREZXRhaWwpO1xuICAgIH0pO1xuICB9XG59KTtcblxuLyoqXG4gKiBTZWxlY3QgZ2VucmUgZmlsdGVyLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NlYXJjaC1nZW5yZScsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZXZlbnREZXRhaWwgPSB7aXNHZW5yZVNlYXJjaDogdHJ1ZSwgZ2VucmU6ICcnLCByZXN1bHRzOiBbXX07XG4gICAgdGhpcy5xdWVyeU9iamVjdCA9IHtcbiAgICAgIGZpbHRlcnM6ICcnLFxuICAgICAgaGl0c1BlclBhZ2U6IDEwMFxuICAgIH07XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZ0ID0+IHtcbiAgICAgIHRoaXMuc2VhcmNoKGV2dC50YXJnZXQuY2xvc2VzdCgnLmdlbnJlJykuZGF0YXNldC5iaW5kRm9yS2V5KTtcbiAgICB9KTtcbiAgfSxcblxuICBzZWFyY2g6IGZ1bmN0aW9uIChnZW5yZSkge1xuICAgIGlmIChnZW5yZSA9PT0gJ1ZpZGVvIEdhbWVzJykge1xuICAgICAgdGhpcy5xdWVyeU9iamVjdC5maWx0ZXJzID0gYGdlbnJlOlwiVmlkZW8gR2FtZVwiIE9SIGdlbnJlOlwiVmlkZW8gR2FtZXNcImA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucXVlcnlPYmplY3QuZmlsdGVycyA9IGBnZW5yZTpcIiR7Z2VucmV9XCJgO1xuICAgIH1cbiAgICBhbGdvbGlhLnNlYXJjaCh0aGlzLnF1ZXJ5T2JqZWN0LCAoZXJyLCBjb250ZW50KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzZWFyY2hlcnJvcicsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZXZlbnREZXRhaWwuZ2VucmUgPSBnZW5yZTtcbiAgICAgIHRoaXMuZXZlbnREZXRhaWwucmVzdWx0cyA9IGNvbnRlbnQuaGl0cztcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzZWFyY2hyZXN1bHRzJywgdGhpcy5ldmVudERldGFpbCk7XG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIENsaWNrIGxpc3RlbmVyIGZvciBzZWFyY2ggcmVzdWx0LlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NlYXJjaC1yZXN1bHQtbGlzdCcsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IG9idiA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKG11dGF0aW9ucyA9PiB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG11dGF0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAobXV0YXRpb25zW2ldLmF0dHJpYnV0ZU5hbWUgPT09ICdkYXRhLWluZGV4Jykge1xuICAgICAgICAgIHRoaXMucmVmcmVzaExheW91dCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgb2J2Lm9ic2VydmUodGhpcy5lbCwge2F0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogZmFsc2UsIHN1YnRyZWU6IHRydWV9KTtcbiAgfSxcblxuICByZWZyZXNoTGF5b3V0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5lbWl0KCdsYXlvdXRyZWZyZXNoJywgbnVsbCwgZmFsc2UpO1xuICB9LFxuXG4gIGNsaWNrOiBiaW5kRXZlbnQoZnVuY3Rpb24gKGV2dCkge1xuICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdtZW51Y2hhbGxlbmdlc2VsZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICBldnQudGFyZ2V0LmNsb3Nlc3QoJy5zZWFyY2hSZXN1bHQnKS5kYXRhc2V0LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlKTtcbiAgfSlcbn0pO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NlYXJjaC1zb25nLW5hbWUtc2VsZWN0ZWQnLCB7XG4gIHNjaGVtYToge1xuICAgIGFuY2hvcjoge2RlZmF1bHQ6IDB9LFxuICAgIGluZGV4OiB7ZGVmYXVsdDogMH0sXG4gICAgb2Zmc2V0OiB7ZGVmYXVsdDogMH0sXG4gICAgc2VsZWN0ZWRDaGFsbGVuZ2VJZDoge2RlZmF1bHQ6ICcnfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIGVsLm9iamVjdDNELnZpc2libGUgPSAhIWRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCAmJiBkYXRhLmluZGV4ICE9PSAtMTtcbiAgICBlbC5vYmplY3QzRC5wb3NpdGlvbi55ID0gZGF0YS5pbmRleCAqIGRhdGEub2Zmc2V0ICsgZGF0YS5hbmNob3I7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc2VhcmNoLmpzIiwidmFyIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcblxuY29uc3QgUFJFVklFV19WT0xVTUUgPSAwLjU7XG5cbi8qKlxuICogU29uZyBwcmV2aWV3IHdoZW4gc2VhcmNoIHJlc3VsdCBzZWxlY3RlZCB3aXRoIHNtYXJ0IGxvZ2ljIGZvciBwcmVsb2FkaW5nLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NvbmctcHJldmlldy1zeXN0ZW0nLCB7XG4gIHNjaGVtYToge1xuICAgIGNoYWxsZW5nZUlkOiB7ZGVmYXVsdDogJyd9LFxuICAgIGRlYnVnOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGlzU2VhcmNoaW5nOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGlzU29uZ0xvYWRpbmc6IHtkZWZhdWx0OiBmYWxzZX0sICAvLyBDb250aW51ZSB0byBwbGF5IHByZXZpZXcgc29uZyBkdXJpbmcgbG9hZGluZy5cbiAgICBzZWxlY3RlZENoYWxsZW5nZUlkOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYW5hbHlzZXJFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdWRpb0FuYWx5c2VyJyk7XG4gICAgdGhpcy5hdWRpbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7ICAvLyBEdW1teS5cbiAgICB0aGlzLmF1ZGlvU3RvcmUgPSB7fTtcbiAgICB0aGlzLnByZWxvYWRlZEF1ZGlvSWRzID0gW107XG4gICAgdGhpcy5wcmVsb2FkUXVldWUgPSBbXTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIC8vIFBsYXkgY2xpY2tlZC5cbiAgICAvLyBCdXQgZG9uJ3Qgc3RhcnQgcGxheWluZyBpdCBpZiBpdCB3YXNuJ3QgcGxheWluZyBhbHJlYWR5LlxuICAgIGlmICghb2xkRGF0YS5jaGFsbGVuZ2VJZCAmJiBkYXRhLmNoYWxsZW5nZUlkKSB7XG4gICAgICBpZiAodGhpcy5hbmFseXNlckVsLmNvbXBvbmVudHMuYXVkaW9hbmFseXNlci52b2x1bWUgPT09IDAgfHxcbiAgICAgICAgICB0aGlzLmF1ZGlvLmN1cnJlbnRUaW1lIDwgMSkge1xuICAgICAgICB0aGlzLnN0b3BTb25nKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyB0aGlzLmZhZGVEb3duKCk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVW5zZWxlY3QuXG4gICAgaWYgKG9sZERhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCAmJiAhZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkICYmICFkYXRhLmlzU2VhcmNoaW5nKSB7XG4gICAgICB0aGlzLnN0b3BTb25nKCk7XG4gICAgfVxuXG4gICAgLy8gU29uZyBmaW5pc2hlZCBsb2FkaW5nLlxuICAgIC8vIENvbnRpbnVlIHRvIHBsYXkgcHJldmlldyBzb25nIGR1cmluZyBsb2FkaW5nIHRvIGtlZXAgZW50ZXJ0YWluZWQuXG4gICAgaWYgKG9sZERhdGEuaXNTb25nTG9hZGluZyAmJiAhZGF0YS5pc1NvbmdMb2FkaW5nKSB7XG4gICAgICB0aGlzLnN0b3BTb25nKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gU2VsZWN0ZWQgY2hhbGxlbmdlIElEIHVwZGF0ZWQuXG4gICAgaWYgKGRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCAmJiBvbGREYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQgIT09IGRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCkge1xuICAgICAgaWYgKHRoaXMuYXVkaW8pIHsgdGhpcy5zdG9wU29uZygpOyB9XG5cbiAgICAgIC8vIElmIG5vdCB5ZXQgcHJlbG9hZGVkLCBwYXVzZSB0aGUgcHJlbG9hZCBxdWV1ZSB1bnRpbCB0aGlzIHNvbmcgaXMgbG9hZGVkLlxuICAgICAgaWYgKCF0aGlzLnByZWxvYWRlZEF1ZGlvSWRzLmluY2x1ZGVzKGRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCkgJiZcbiAgICAgICAgICBkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQgIT09IHRoaXMuY3VycmVudExvYWRpbmdJZCkge1xuICAgICAgICB0aGlzLnByaW9yaXRpemVQcmVsb2FkU29uZygpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnBsYXlTb25nKGRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCk7XG4gICAgfVxuICB9LFxuXG4gIGxvZzogZnVuY3Rpb24gKHN0cikge1xuICAgIGlmICghdGhpcy5kYXRhLmRlYnVnKSB7IHJldHVybjsgfVxuICAgIGNvbnNvbGUubG9nKHN0cik7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFNvbmcgd2FzIHNlbGVjdGVkIHNvIHBhdXNlIHByZWxvYWQgcXVldWUsIHByaW9yaXRpemUgaXRzIGxvYWRpbmcsIGFuZCB0cnkgdG8gcGxheSBBU0FQLlxuICAgKi9cbiAgcHJpb3JpdGl6ZVByZWxvYWRTb25nOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBjb25zdCBwcmVsb2FkUXVldWUgPSB0aGlzLnByZWxvYWRRdWV1ZTtcblxuICAgIHRoaXMubG9nKGBbc29uZy1wcmV2aWV3XSBQcmlvcml0aXppbmcgbG9hZGluZyBvZiAke2RhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZH1gKTtcbiAgICB0aGlzLnByaW9yaXR5TG9hZGluZ0NoYWxsZW5nZUlkID0gZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkO1xuXG4gICAgdGhpcy5hdWRpb1N0b3JlW2RhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZF0uYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkZGF0YScsICgpID0+IHtcbiAgICAgIHRoaXMubG9nKGBbc29uZy1wcmV2aWV3XSBGaW5pc2hlZCBsb2FkIG9mIHByaW9yaXR5ICR7ZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkfWApO1xuICAgICAgdGhpcy5wcmVsb2FkZWRBdWRpb0lkcy5wdXNoKGRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCk7XG4gICAgICB0aGlzLnByaW9yaXR5TG9hZGluZ0NoYWxsZW5nZUlkID0gJyc7XG4gICAgICAvLyBSZXN1bWUgcHJlbG9hZGluZyBxdWV1ZS5cbiAgICAgIGlmIChwcmVsb2FkUXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMubG9nKGBbc29uZy1wcmV2aWV3XSBSZXN1bWluZyBxdWV1ZSB3aXRoICR7cHJlbG9hZFF1ZXVlWzBdLmNoYWxsZW5nZUlkfWApO1xuICAgICAgICB0aGlzLnByZWxvYWRNZXRhZGF0YShwcmVsb2FkUXVldWVbMF0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gUHJlbG9hZC5cbiAgICB0aGlzLmF1ZGlvU3RvcmVbZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkXS5zcmMgPVxuICAgICAgdXRpbHMuZ2V0UzNGaWxlVXJsKGRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCwgJ3Nvbmcub2dnJyk7XG5cbiAgICAvLyBSZW1vdmUgZnJvbSBwcmVsb2FkIHF1ZXVlLlxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJlbG9hZFF1ZXVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAocHJlbG9hZFF1ZXVlW2ldLmNoYWxsZW5nZUlkID09PSBkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQpIHtcbiAgICAgICAgcHJlbG9hZFF1ZXVlLnNwbGljZShpLCAxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYW4gYXVkaW8gZWxlbWVudCBhbmQgcXVldWUgdG8gcHJlbG9hZC4gSWYgdGhlIHF1ZXVlIGlzIGVtcHR5LCBwcmVsb2FkIGl0XG4gICAqIGltbWVkaWF0ZWx5LlxuICAgKi9cbiAgcXVldWVQcmVsb2FkU29uZzogZnVuY3Rpb24gKGNoYWxsZW5nZUlkLCBwcmV2aWV3U3RhcnRUaW1lKSB7XG4gICAgaWYgKHRoaXMuYXVkaW9TdG9yZVtjaGFsbGVuZ2VJZF0pIHsgcmV0dXJuOyB9XG5cbiAgICBjb25zdCBhdWRpbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XG4gICAgYXVkaW8uY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJztcbiAgICBhdWRpby5kYXRhc2V0LnByZXZpZXdTdGFydFRpbWUgPSBwcmV2aWV3U3RhcnRUaW1lO1xuICAgIHRoaXMuYXVkaW9TdG9yZVtjaGFsbGVuZ2VJZF0gPSBhdWRpbztcblxuICAgIGxldCBzcmMgPSB1dGlscy5nZXRTM0ZpbGVVcmwoY2hhbGxlbmdlSWQsICdzb25nLm9nZycpO1xuICAgIGlmICh0aGlzLmN1cnJlbnRMb2FkaW5nSWQpIHtcbiAgICAgIC8vIEF1ZGlvIGN1cnJlbnRseSBsb2FkaW5nLCBhZGQgdG8gcXVldWUuXG4gICAgICB0aGlzLnByZWxvYWRRdWV1ZS5wdXNoKHtcbiAgICAgICAgYXVkaW86IGF1ZGlvLFxuICAgICAgICBjaGFsbGVuZ2VJZDogY2hhbGxlbmdlSWQsXG4gICAgICAgIHNyYzogc3JjXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRW1wdHkgcXVldWUsIHByZWxvYWQgbm93LlxuICAgICAgdGhpcy5wcmVsb2FkTWV0YWRhdGEoe1xuICAgICAgICBhdWRpbzogYXVkaW8sXG4gICAgICAgIGNoYWxsZW5nZUlkOiBjaGFsbGVuZ2VJZCxcbiAgICAgICAgc3JjOiBzcmNcbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogUHJlbG9hZCBtZXRhZGF0YSBvZiBhdWRpbyBmaWxlIGZvciBxdWljayBwbGF5LlxuICAgKiBTZXQgYHNyY2AgYW5kIGBwcmVsb2FkYC5cbiAgICogQSBwcmVsb2FkIHF1ZXVlIGlzIHNldCB1cCBzbyB3ZSBvbmx5IHByZWxvYWQgb25lIGF0IGEgdGltZSB0byBub3QgYm9nIGRvd25cbiAgICogdGhlIG5ldHdvcmsuIElmIGEgc29uZyBpcyBzZWxlY3RlZCB0byBwcmV2aWV3LCB3ZSBjYW4gYnVtcCBpdCB0byB0aGUgZnJvbnQgb2YgdGhlXG4gICAqIHF1ZXVlLlxuICAgKi9cbiAgcHJlbG9hZE1ldGFkYXRhOiBmdW5jdGlvbiAocHJlbG9hZEl0ZW0pIHtcbiAgICBjb25zdCBhdWRpbyA9IHByZWxvYWRJdGVtLmF1ZGlvO1xuICAgIHRoaXMubG9nKGBbc29uZy1wcmV2aWV3XSBQcmVsb2FkaW5nIHNvbmcgcHJldmlldyAke3ByZWxvYWRJdGVtLmNoYWxsZW5nZUlkfWApO1xuXG4gICAgYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkbWV0YWRhdGEnLCAoKSA9PiB7XG4gICAgICAvLyBTb25nIHByZWxvYWRlZC5cbiAgICAgIHRoaXMubG9nKGBbc29uZy1wcmV2aWV3XSBGaW5pc2hlZCBwcmVsb2FkaW5nIHNvbmcgcHJldmlldyAke3ByZWxvYWRJdGVtLmNoYWxsZW5nZUlkfWApO1xuICAgICAgdGhpcy5wcmVsb2FkZWRBdWRpb0lkcy5wdXNoKHByZWxvYWRJdGVtLmNoYWxsZW5nZUlkKTtcbiAgICAgIHRoaXMuY3VycmVudExvYWRpbmdJZCA9ICcnO1xuXG4gICAgICAvLyBNb3ZlIG9uIHRvIG5leHQgc29uZyBpbiBxdWV1ZSBpZiBhbnkuXG4gICAgICB0aGlzLmxvZyhgW3NvbmctcHJldmlld10gJHt0aGlzLnByZWxvYWRRdWV1ZS5sZW5ndGh9IGluIHF1ZXVlYCk7XG4gICAgICBpZiAodGhpcy5wcmVsb2FkUXVldWUubGVuZ3RoICYmICF0aGlzLnByaW9yaXR5TG9hZGluZ0NoYWxsZW5nZUlkKSB7XG4gICAgICAgIHRoaXMucHJlbG9hZE1ldGFkYXRhKHRoaXMucHJlbG9hZFF1ZXVlLnNoaWZ0KCkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgYXVkaW8ucHJlbG9hZCA9ICdtZXRhZGF0YSc7XG4gICAgYXVkaW8uc3JjID0gcHJlbG9hZEl0ZW0uc3JjO1xuICAgIHRoaXMuY3VycmVudExvYWRpbmdJZCA9IHByZWxvYWRJdGVtLmNoYWxsZW5nZUlkO1xuICB9LFxuXG4gIHN0b3BTb25nOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmF1ZGlvKSB7IHJldHVybjsgfVxuICAgIGlmICghdGhpcy5hdWRpby5wYXVzZWQpIHsgdGhpcy5hdWRpby5wYXVzZSgpOyB9XG4gIH0sXG5cbiAgcGxheVNvbmc6IGZ1bmN0aW9uIChjaGFsbGVuZ2VJZCkge1xuICAgIGlmICghY2hhbGxlbmdlSWQpIHsgcmV0dXJuOyB9XG5cbiAgICB0aGlzLmF1ZGlvID0gdGhpcy5hdWRpb1N0b3JlW2NoYWxsZW5nZUlkXTtcbiAgICB0aGlzLmF1ZGlvLmxvYWQoKTtcbiAgICB0aGlzLmF1ZGlvLnZvbHVtZSA9IFBSRVZJRVdfVk9MVU1FO1xuICAgIHRoaXMuYXVkaW8uY3VycmVudFRpbWUgPSB0aGlzLmF1ZGlvLmRhdGFzZXQucHJldmlld1N0YXJ0VGltZTtcbiAgICB0aGlzLmFuYWx5c2VyRWwuc2V0QXR0cmlidXRlKCdhdWRpb2FuYWx5c2VyJywgJ3NyYycsIHRoaXMuYXVkaW8pO1xuXG4gICAgY29uc3QgYXVkaW9hbmFseXNlciA9IHRoaXMuYW5hbHlzZXJFbC5jb21wb25lbnRzLmF1ZGlvYW5hbHlzZXI7XG4gICAgYXVkaW9hbmFseXNlci5yZXN1bWVDb250ZXh0KCk7XG5cbiAgICB0aGlzLmF1ZGlvLnBsYXkoKTtcbiAgICAvLyB0aGlzLmZhZGVJbigpO1xuXG4gICAgLy8gUHJlZmV0Y2ggYnVmZmVyIGZvciBwbGF5aW5nLlxuICAgIGlmIChhdWRpb2FuYWx5c2VyLnhocikgeyBhdWRpb2FuYWx5c2VyLnhoci5hYm9ydCgpOyB9XG4gICAgYXVkaW9hbmFseXNlci5mZXRjaEF1ZGlvQnVmZmVyKHV0aWxzLmdldFMzRmlsZVVybChjaGFsbGVuZ2VJZCwgJ3Nvbmcub2dnJykpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBTdG9wIHNvbmcgZnJvbSBwcmVsb2FkaW5nLlxuICAgKi9cbiAgY2xlYXJTb25nOiBmdW5jdGlvbiAoY2hhbGxlbmdlSWQpIHtcbiAgICBsZXQgYXVkaW8gPSB0aGlzLmF1ZGlvU3RvcmVbY2hhbGxlbmdlSWRdO1xuICAgIGF1ZGlvLnByZWxvYWQgPSAnbm9uZSc7XG5cbiAgICAvLyBSZW1vdmUgZnJvbSBxdWV1ZSBpZiBpbiB0aGVyZS5cbiAgICBsZXQgaW5kZXg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByZWxvYWRRdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMucHJlbG9hZFF1ZXVlW2ldLmlkID09PSBjaGFsbGVuZ2VJZCkge1xuICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWluZGV4KSB7IHJldHVybjsgfVxuICAgIHRoaXMucHJlbG9hZFF1ZXVlLnNwbGljZShpbmRleCwgMSk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIERhdGEgY29tcG9uZW50IGF0dGFjaGVkIHRvIHNlYXJjaCByZXN1bHQgZm9yIHNvbmcgcHJldmlldyBzeXN0ZW0uXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc29uZy1wcmV2aWV3Jywge1xuICBzY2hlbWE6IHtcbiAgICBjaGFsbGVuZ2VJZDoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBwcmV2aWV3U3RhcnRUaW1lOiB7dHlwZTogJ251bWJlcid9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGlmIChvbGREYXRhLmNoYWxsZW5nZUlkICYmIHRoaXMuZGF0YS5jaGFsbGVuZ2VJZCAhPT0gb2xkRGF0YS5jaGFsbGVuZ2VJZCkge1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHNbJ3NvbmctcHJldmlldy1zeXN0ZW0nXS5jbGVhclNvbmcob2xkRGF0YS5jaGFsbGVuZ2VJZCk7XG4gICAgfVxuXG4gICAgdGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHNbJ3NvbmctcHJldmlldy1zeXN0ZW0nXS5xdWV1ZVByZWxvYWRTb25nKFxuICAgICAgdGhpcy5kYXRhLmNoYWxsZW5nZUlkLCB0aGlzLmRhdGEucHJldmlld1N0YXJ0VGltZVxuICAgICk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc29uZy1wcmV2aWV3LmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzb25nLXByb2dyZXNzLXJpbmcnLCB7XG4gIGRlcGVuZGVuY2llczogWydnZW9tZXRyeScsICdtYXRlcmlhbCddLFxuXG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy50aWNrID0gQUZSQU1FLnV0aWxzLnRocm90dGxlVGljayh0aGlzLnRpY2suYmluZCh0aGlzKSwgMTAwMCk7XG5cbiAgICB0aGlzLnByb2dyZXNzID0gdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLnVuaWZvcm1zLnByb2dyZXNzO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5hZGRFdmVudExpc3RlbmVyKCdjbGVhcmdhbWUnLCAoKSA9PiB7XG4gICAgICB0aGlzLnByb2dyZXNzLnZhbHVlID0gMDtcbiAgICB9KTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdGhpcy5wcm9ncmVzcy52YWx1ZSA9IDA7XG4gIH0sXG5cbiAgdXBkYXRlUmluZzogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzLnNvbmcuc291cmNlO1xuICAgIGlmICghc291cmNlKSB7IHJldHVybjsgfVxuXG4gICAgY29uc3QgcHJvZ3Jlc3MgPVxuICAgICAgdGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHMuc29uZy5nZXRDdXJyZW50VGltZSgpIC9cbiAgICAgIHNvdXJjZS5idWZmZXIuZHVyYXRpb247XG4gICAgdGhpcy5wcm9ncmVzcy52YWx1ZSA9IHByb2dyZXNzO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgIHRoaXMudXBkYXRlUmluZygpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3NvbmctcHJvZ3Jlc3MtcmluZy5qcyIsImNvbnN0IHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcblxuY29uc3QgR0FNRV9PVkVSX0xFTkdUSCA9IDMuNTtcbmNvbnN0IE9OQ0UgPSB7b25jZTogdHJ1ZX07XG5jb25zdCBCQVNFX1ZPTFVNRSA9IDAuNzU7XG5cbmxldCBza2lwRGVidWcgPSBBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdza2lwJyk7XG5pZiAoISFza2lwRGVidWcpIHsgc2tpcERlYnVnID0gcGFyc2VJbnQoc2tpcERlYnVnKSAvIDEwMDA7IH1cblxuLyoqXG4gKiBBY3RpdmUgY2hhbGxlbmdlIHNvbmcgLyBhdWRpby5cbiAqXG4gKiBPcmRlciBvZiBzb25nIGluaXQgaW4gY29uanVjdGlvbiB3aXRoIGJlYXQtbG9hZGVyOlxuICpcbiAqIDEuIHByZXZpZXdTdGFydFRpbWUgaXMgcGxheWluZ1xuICogMi4gc29uZ2xvYWRmaW5pc2hcbiAqIDMuIGJlYXQtbG9hZGVyIHByZWxvYWRpbmdcbiAqIDQuIHByZWxvYWRlZCBiZWF0cyBnZW5lcmF0ZWRcbiAqIDUuIGJlYXQtbG9hZGVyIHByZWxvYWRpbmcgZmluaXNoXG4gKiA2LiBzdGFydEF1ZGlvIC8gc29uZ1N0YXJ0VGltZSBpcyBzZXRcbiAqIDcuIGJlYXQtbG9hZGVyIGNvbnRpbnVlcyBvZmYgc29uZyBjdXJyZW50IHRpbWVcbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzb25nJywge1xuICBzY2hlbWE6IHtcbiAgICBhbmFseXNlckVsOiB7dHlwZTogJ3NlbGVjdG9yJywgZGVmYXVsdDogJyNhdWRpb0FuYWx5c2VyJ30sXG4gICAgY2hhbGxlbmdlSWQ6IHtkZWZhdWx0OiAnJ30sXG4gICAgaXNCZWF0c1ByZWxvYWRlZDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBpc0dhbWVPdmVyOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGlzUGxheWluZzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBpc1ZpY3Rvcnk6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5hbmFseXNlclNldHRlciA9IHtidWZmZXI6IHRydWV9O1xuICAgIHRoaXMuYXVkaW9BbmFseXNlciA9IHRoaXMuZGF0YS5hbmFseXNlckVsLmNvbXBvbmVudHMuYXVkaW9hbmFseXNlcjtcbiAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmF1ZGlvQW5hbHlzZXIuY29udGV4dDtcbiAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xuICAgIHRoaXMuc29uZ0xvYWRpbmdJbmRpY2F0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc29uZ0xvYWRpbmdJbmRpY2F0b3InKTtcbiAgICB0aGlzLnNvbmdTdGFydFRpbWUgPSAwO1xuXG4gICAgdGhpcy52aWN0b3J5ID0gdGhpcy52aWN0b3J5LmJpbmQodGhpcyk7XG5cbiAgICAvLyBCYXNlIHZvbHVtZS5cbiAgICB0aGlzLmF1ZGlvQW5hbHlzZXIuZ2Fpbk5vZGUuZ2Fpbi52YWx1ZSA9IEJBU0VfVk9MVU1FO1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdnYW1lbWVudXJlc3RhcnQnLCB0aGlzLm9uUmVzdGFydC5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3dhbGxoaXRzdGFydCcsIHRoaXMub25XYWxsSGl0U3RhcnQuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCd3YWxsaGl0ZW5kJywgdGhpcy5vbldhbGxIaXRFbmQuYmluZCh0aGlzKSk7XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCd2aWN0b3J5ZmFrZScsICgpID0+IHtcbiAgICAgICAgdGhpcy5zb3VyY2Uuc3RvcCgpO1xuICAgICAgICB0aGlzLnNvdXJjZS5kaXNjb25uZWN0KCk7XG4gICAgICAgIHRoaXMudmljdG9yeSgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIC8vIEdhbWUgb3Zlciwgc2xvdyBkb3duIGF1ZGlvLCBhbmQgdGhlbiBzdG9wLlxuICAgIGlmICghb2xkRGF0YS5pc0dhbWVPdmVyICYmIGRhdGEuaXNHYW1lT3Zlcikge1xuICAgICAgdGhpcy5vbkdhbWVPdmVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG9sZERhdGEuaXNHYW1lT3ZlciAmJiAhZGF0YS5pc0dhbWVPdmVyKSB7XG4gICAgICB0aGlzLmF1ZGlvQW5hbHlzZXIuZ2Fpbk5vZGUudmFsdWUgPSBCQVNFX1ZPTFVNRTtcbiAgICB9XG5cbiAgICAvLyBPbiB2aWN0b3J5IHNjcmVlbiwgcGxheSBzb25nIGluIGJhY2tncm91bmQuXG4gICAgaWYgKCFvbGREYXRhLmlzVmljdG9yeSAmJiBkYXRhLmlzVmljdG9yeSkge1xuICAgICAgdGhpcy5kYXRhLmFuYWx5c2VyRWwuYWRkRXZlbnRMaXN0ZW5lcignYXVkaW9hbmFseXNlcmJ1ZmZlcnNvdXJjZScsIGV2dCA9PiB7XG4gICAgICAgIHRoaXMuYXVkaW9BbmFseXNlci5yZXN1bWVDb250ZXh0KCk7XG4gICAgICAgIGNvbnN0IGdhaW4gPSB0aGlzLmF1ZGlvQW5hbHlzZXIuZ2Fpbk5vZGUuZ2FpbjtcbiAgICAgICAgZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMoMCk7XG4gICAgICAgIGdhaW4uc2V0VmFsdWVBdFRpbWUoMC4wNSwgMCk7XG4gICAgICAgIHRoaXMuc291cmNlID0gZXZ0LmRldGFpbDtcbiAgICAgICAgdGhpcy5zb3VyY2Uuc3RhcnQoKTtcbiAgICAgIH0sIE9OQ0UpO1xuICAgICAgdGhpcy5hdWRpb0FuYWx5c2VyLnJlZnJlc2hTb3VyY2UoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBOZXcgY2hhbGxlbmdlLCBwbGF5IGlmIHdlIGhhdmUgbG9hZGVkIGFuZCB3ZXJlIHdhaXRpbmcgZm9yIGJlYXRzIHRvIHByZWxvYWQuXG4gICAgaWYgKCFvbGREYXRhLmlzQmVhdHNQcmVsb2FkZWQgJiYgdGhpcy5kYXRhLmlzQmVhdHNQcmVsb2FkZWQgJiYgdGhpcy5zb3VyY2UpIHtcbiAgICAgIHRoaXMuc3RhcnRBdWRpbygpO1xuICAgIH1cblxuICAgIGlmIChvbGREYXRhLmNoYWxsZW5nZUlkICYmICFkYXRhLmNoYWxsZW5nZUlkKSB7XG4gICAgICB0aGlzLnN0b3BBdWRpbygpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIE5ldyBjaGFsbGVuZ2UsIGxvYWQgYXVkaW8gYW5kIHBsYXkgd2hlbiByZWFkeS5cbiAgICBpZiAob2xkRGF0YS5jaGFsbGVuZ2VJZCAhPT0gZGF0YS5jaGFsbGVuZ2VJZCAmJiBkYXRhLmNoYWxsZW5nZUlkKSB7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc29uZ2xvYWRzdGFydCcsIG51bGwsIGZhbHNlKTtcbiAgICAgIHRoaXMuZ2V0QXVkaW8oKS50aGVuKHNvdXJjZSA9PiB7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzb25nbG9hZGZpbmlzaCcsIG51bGwsIGZhbHNlKTtcbiAgICAgIH0pLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICAgIH1cblxuICAgIC8vIFBhdXNlIC8gc3RvcC5cbiAgICBpZiAob2xkRGF0YS5pc1BsYXlpbmcgJiYgIWRhdGEuaXNQbGF5aW5nKSB7XG4gICAgICB0aGlzLmF1ZGlvQW5hbHlzZXIuc3VzcGVuZENvbnRleHQoKTtcbiAgICB9XG5cbiAgICAvLyBSZXN1bWUuXG4gICAgaWYgKCFvbGREYXRhLmlzUGxheWluZyAmJiBkYXRhLmlzUGxheWluZyAmJiB0aGlzLnNvdXJjZSkge1xuICAgICAgdGhpcy5hdWRpb0FuYWx5c2VyLnJlc3VtZUNvbnRleHQoKTtcbiAgICB9XG4gIH0sXG5cbiAgZ2V0QXVkaW86IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICBkYXRhLmFuYWx5c2VyRWwuYWRkRXZlbnRMaXN0ZW5lcignYXVkaW9hbmFseXNlcmJ1ZmZlcnNvdXJjZScsIGV2dCA9PiB7XG4gICAgICAgIC8vIEZpbmlzaGVkIGRlY29kaW5nLlxuICAgICAgICB0aGlzLnNvdXJjZSA9IGV2dC5kZXRhaWw7XG4gICAgICAgIHJlc29sdmUodGhpcy5zb3VyY2UpO1xuICAgICAgfSwgT05DRSk7XG4gICAgICB0aGlzLmFuYWx5c2VyU2V0dGVyLnNyYyA9IHV0aWxzLmdldFMzRmlsZVVybChkYXRhLmNoYWxsZW5nZUlkLCAnc29uZy5vZ2cnKTtcbiAgICAgIGRhdGEuYW5hbHlzZXJFbC5zZXRBdHRyaWJ1dGUoJ2F1ZGlvYW5hbHlzZXInLCB0aGlzLmFuYWx5c2VyU2V0dGVyKTtcblxuICAgICAgLy8gQWxyZWFkeSBsb2FkZWQuXG4gICAgICBpZiAodGhpcy5hdWRpb0FuYWx5c2VyLnhoci5yZXNwb25zZSkge1xuICAgICAgICB0aGlzLnNvbmdMb2FkaW5nSW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAncHJvZ3Jlc3MnLCAxKTtcbiAgICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3NvbmdmZXRjaGZpbmlzaCcsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmF1ZGlvQW5hbHlzZXIueGhyLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgZXZ0ID0+IHtcbiAgICAgICAgdGhpcy5vbkZldGNoUHJvZ3Jlc3MoZXZ0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIHN0b3BBdWRpbzogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5zb3VyY2UpIHtcbiAgICAgIGNvbnNvbGUud2FybignW3NvbmddIFRyaWVkIHRvIHN0b3BBdWRpbywgYnV0IG5vdCBwbGF5aW5nLicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNvdXJjZS5zdG9wKCk7XG4gICAgdGhpcy5zb3VyY2UuZGlzY29ubmVjdCgpO1xuICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xuICB9LFxuXG4gIHZpY3Rvcnk6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5pc1BsYXlpbmcpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3ZpY3RvcnknLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgb25GZXRjaFByb2dyZXNzOiBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBldnQubG9hZGVkIC8gZXZ0LnRvdGFsO1xuICAgIHRoaXMuc29uZ0xvYWRpbmdJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsICdwcm9ncmVzcycsIHByb2dyZXNzKTtcbiAgICBpZiAocHJvZ3Jlc3MgPj0gMSkge1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3NvbmdmZXRjaGZpbmlzaCcsIG51bGwsIGZhbHNlKTtcbiAgICB9XG4gIH0sXG5cbiAgb25HYW1lT3ZlcjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XG5cbiAgICAvLyBQbGF5YmFjayByYXRlLlxuICAgIGNvbnN0IHBsYXliYWNrUmF0ZSA9IHRoaXMuc291cmNlLnBsYXliYWNrUmF0ZTtcbiAgICBwbGF5YmFja1JhdGUuc2V0VmFsdWVBdFRpbWUocGxheWJhY2tSYXRlLnZhbHVlLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpO1xuICAgIHBsYXliYWNrUmF0ZS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSgwLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUgKyBHQU1FX09WRVJfTEVOR1RIKTtcblxuICAgIC8vIEdhaW4uXG4gICAgY29uc3QgZ2FpbiA9IHRoaXMuYXVkaW9BbmFseXNlci5nYWluTm9kZS5nYWluO1xuICAgIGdhaW4uc2V0VmFsdWVBdFRpbWUoZ2Fpbi52YWx1ZSwgdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lKTtcbiAgICBnYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKDAsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSArIEdBTUVfT1ZFUl9MRU5HVEgpO1xuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuZGF0YS5pc0dhbWVPdmVyKSB7IHJldHVybjsgfVxuICAgICAgdGhpcy5zdG9wQXVkaW8oKTtcbiAgICB9LCAzNTAwKTtcbiAgfSxcblxuICBvblJlc3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xuXG4gICAgLy8gUmVzdGFydCwgZ2V0IG5ldyBidWZmZXIgc291cmNlIG5vZGUgYW5kIHBsYXkuXG4gICAgaWYgKHRoaXMuc291cmNlKSB7IHRoaXMuc291cmNlLmRpc2Nvbm5lY3QoKTsgfVxuXG4gICAgLy8gQ2xlYXIgZ2FpbiBpbnRlcnBvbGF0aW9uIHZhbHVlcyBmcm9tIGdhbWUgb3Zlci5cbiAgICBjb25zdCBnYWluID0gdGhpcy5hdWRpb0FuYWx5c2VyLmdhaW5Ob2RlLmdhaW47XG4gICAgZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMoMCk7XG5cbiAgICB0aGlzLmRhdGEuYW5hbHlzZXJFbC5hZGRFdmVudExpc3RlbmVyKCdhdWRpb2FuYWx5c2VyYnVmZmVyc291cmNlJywgZXZ0ID0+IHtcbiAgICAgIHRoaXMuc291cmNlID0gZXZ0LmRldGFpbDtcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzb25nbG9hZGZpbmlzaCcsIG51bGwsIGZhbHNlKTtcbiAgICB9LCBPTkNFKTtcbiAgICB0aGlzLmF1ZGlvQW5hbHlzZXIucmVmcmVzaFNvdXJjZSgpO1xuICB9LFxuXG4gIG9uV2FsbEhpdFN0YXJ0OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZ2FpbiA9IHRoaXMuYXVkaW9BbmFseXNlci5nYWluTm9kZS5nYWluO1xuICAgIGdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoMC4yLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUgKyAwLjEpO1xuICB9LFxuXG4gIG9uV2FsbEhpdEVuZDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGdhaW4gPSB0aGlzLmF1ZGlvQW5hbHlzZXIuZ2Fpbk5vZGUuZ2FpbjtcbiAgICBnYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKEJBU0VfVk9MVU1FLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUgKyAwLjEpO1xuICB9LFxuXG4gIHN0YXJ0QXVkaW86IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBnYWluID0gdGhpcy5hdWRpb0FuYWx5c2VyLmdhaW5Ob2RlLmdhaW47XG4gICAgZ2Fpbi5zZXRWYWx1ZUF0VGltZShCQVNFX1ZPTFVNRSwgdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lKTtcbiAgICB0aGlzLnNvbmdTdGFydFRpbWUgPSB0aGlzLmNvbnRleHQuY3VycmVudFRpbWU7XG4gICAgdGhpcy5zb3VyY2Uub25lbmRlZCA9IHRoaXMudmljdG9yeTtcbiAgICB0aGlzLnNvdXJjZS5zdGFydCgwLCBza2lwRGVidWcpO1xuICAgIHRoaXMuaXNQbGF5aW5nID0gdHJ1ZTtcbiAgfSxcblxuICBnZXRDdXJyZW50VGltZTogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUgLSB0aGlzLnNvbmdTdGFydFRpbWU7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc29uZy5qcyIsImZ1bmN0aW9uICQgKGlkKSB7IHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7IH07XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc3RhZ2UtY29sb3JzJywge1xuICBkZXBlbmRlbmNpZXM6IFsnYmFja2dyb3VuZCddLFxuXG4gIHNjaGVtYToge1xuICAgIGNvbG9yOiB7ZGVmYXVsdDogJ2JsdWUnLCBvbmVPZjogWydibHVlJywgJ3JlZCddfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmNvbG9yQ29kZXMgPSBbJ29mZicsICdibHVlJywgJ2JsdWUnLCAnYmx1ZWZhZGUnLCAnJywgJ3JlZCcsICdyZWQnLCAncmVkZmFkZSddO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xlYXJnYW1lJywgdGhpcy5yZXNldENvbG9ycy5iaW5kKHRoaXMpKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdGhpcy51cGRhdGVDb2xvcnModGhpcy5kYXRhLmNvbG9yKTtcbiAgfSxcblxuICBzZXRDb2xvcjogZnVuY3Rpb24gKHRhcmdldCwgY29kZSkge1xuICAgIHRoaXMuZWwuZW1pdChgJHt0YXJnZXR9Y29sb3Ike3RoaXMuY29sb3JDb2Rlc1tjb2RlXX1gLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgcmVzZXRDb2xvcnM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnVwZGF0ZUNvbG9ycygnYmx1ZScpO1xuICAgIHRoaXMuZWwuZW1pdCgnYmdjb2xvcmJsdWUnLCBudWxsLCBmYWxzZSk7XG4gICAgdGhpcy5lbC5lbWl0KCd0dW5uZWxjb2xvcnJlZCcsIG51bGwsIGZhbHNlKTtcbiAgICB0aGlzLmVsLmVtaXQoJ2Zsb29yY29sb3JyZWQnLCBudWxsLCBmYWxzZSk7XG4gICAgdGhpcy5lbC5lbWl0KCdsZWZ0bGFzZXJjb2xvcmJsdWUnLCBudWxsLCBmYWxzZSk7XG4gICAgdGhpcy5lbC5lbWl0KCdyaWdodGxhc2VyY29sb3JibHVlJywgbnVsbCwgZmFsc2UpO1xuICB9LFxuXG4gIHVwZGF0ZUNvbG9yczogZnVuY3Rpb24gKGNvbG9yKSB7XG4gIH1cblxuLypcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubmVvblJlZCA9IG5ldyBUSFJFRS5Db2xvcigweGZmOTk5OSk7XG4gICAgdGhpcy5uZW9uQmx1ZSA9IG5ldyBUSFJFRS5Db2xvcigweDk5OTlmZik7XG4gICAgdGhpcy5kZWZhdWx0UmVkID0gbmV3IFRIUkVFLkNvbG9yKDB4ZmYwMDAwKTtcbiAgICB0aGlzLmRlZmF1bHRCbHVlID0gbmV3IFRIUkVFLkNvbG9yKDB4MDAwMGZmKTtcbiAgICB0aGlzLm1pbmVFbnZNYXAgPSB7XG4gICAgICByZWQ6IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZCgnYXNzZXRzL2ltZy9taW5lZW52aXJvLXJlZC5qcGcnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdtaW5lcmVkZW52bWFwbG9hZGVkJywgbnVsbCwgZmFsc2UpO1xuICAgICAgfSksXG4gICAgICBibHVlOiBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoJ2Fzc2V0cy9pbWcvbWluZWVudmlyby1ibHVlLmpwZycsICgpID0+IHtcbiAgICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ21pbmVibHVlZW52bWFwbG9hZGVkJywgbnVsbCwgZmFsc2UpO1xuICAgICAgfSlcbiAgICB9O1xuICAgIHRoaXMubWluZUNvbG9yID0ge3JlZDogbmV3IFRIUkVFLkNvbG9yKDB4MDcwMzA0KSwgYmx1ZTogbmV3IFRIUkVFLkNvbG9yKDB4MDMwNDA3KX07XG4gICAgdGhpcy5taW5lRW1pc3Npb24gPSB7cmVkOiBuZXcgVEhSRUUuQ29sb3IoMHgwOTA3MDcpLCBibHVlOiBuZXcgVEhSRUUuQ29sb3IoMHgwNzA3MDkpfTtcbiAgICB0aGlzLm1pbmVNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7XG4gICAgICByb3VnaG5lc3M6IDAuMzgsXG4gICAgICBtZXRhbG5lc3M6IDAuNDgsXG4gICAgICBjb2xvcjogdGhpcy5taW5lQ29sb3JbdGhpcy5kYXRhLmNvbG9yXSxcbiAgICAgIGVtaXNzaXZlOiB0aGlzLm1pbmVFbWlzc2lvblt0aGlzLmRhdGEuY29sb3JdLFxuICAgICAgZW52TWFwOiB0aGlzLm1pbmVFbnZNYXBbdGhpcy5kYXRhLmNvbG9yXVxuICAgIH0pO1xuICAgIHRoaXMuc2t5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NreScpO1xuICAgIHRoaXMuYXV4Q29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoKTtcblxuICAgIHRoaXMudGFyZ2V0cyA9IHt9O1xuICAgIFsnc3RhZ2VOb3JtYWwnLFxuICAgICAndHVubmVsTmVvbicsXG4gICAgICdsZWZ0U3RhZ2VMYXNlcjAnLFxuICAgICAnbGVmdFN0YWdlTGFzZXIxJyxcbiAgICAgJ2xlZnRTdGFnZUxhc2VyMicsXG4gICAgICdyaWdodFN0YWdlTGFzZXIwJyxcbiAgICAgJ3JpZ2h0U3RhZ2VMYXNlcjEnLFxuICAgICAncmlnaHRTdGFnZUxhc2VyMicsXG4gICAgICdmbG9vcicsXG4gICAgICdzdGFnZU5lb24nXS5mb3JFYWNoKGlkID0+IHtcbiAgICAgICAgdGhpcy50YXJnZXRzW2lkXSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICAgfSk7XG5cbiAgICB0aGlzLmNvbG9yQ29kZXMgPSBbJ29mZicsICdibHVlJywgJ2JsdWUnLCAnYmx1ZWZhZGUnLCAnJywgJ3JlZCcsICdyZWQnLCAncmVkZmFkZSddO1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGVhcmdhbWUnLCB0aGlzLnJlc2V0Q29sb3JzLmJpbmQodGhpcykpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB0aGlzLnVwZGF0ZUNvbG9ycyh0aGlzLmRhdGEuY29sb3IpO1xuICB9LFxuXG4gIHNldENvbG9yOiBmdW5jdGlvbiAodGFyZ2V0LCBjb2RlKSB7XG4gICAgY29uc3QgbWVzaCA9IHRoaXMudGFyZ2V0c1t0YXJnZXRdLmdldE9iamVjdDNEKCdtZXNoJyk7XG4gICAgaWYgKG1lc2gpIHsgbWVzaC5tYXRlcmlhbC5vcGFjaXR5ID0gMTsgfVxuICAgIHRoaXMudGFyZ2V0c1t0YXJnZXRdLmVtaXQoJ2NvbG9yJyArIHRoaXMuY29sb3JDb2Rlc1tjb2RlXSwgbnVsbCwgZmFsc2UpO1xuICB9LFxuXG4gIHJlc2V0Q29sb3JzOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy51cGRhdGVDb2xvcnMoJ2JsdWUnKTtcbiAgICBmb3IgKGxldCB0YXJnZXQgaW4gdGhpcy50YXJnZXRzKSB7XG4gICAgICB0aGlzLnRhcmdldHNbdGFyZ2V0XS5lbWl0KCdjb2xvcmJsdWUnLCBudWxsLCBmYWxzZSk7XG4gICAgfVxuICB9LFxuXG4gIHVwZGF0ZUNvbG9yczogZnVuY3Rpb24gKGNvbG9yKSB7XG4gICAgY29uc3QgcmVkID0gY29sb3IgPT09ICdyZWQnO1xuXG4gICAgdGhpcy5za3kuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5jb2xvci5zZXQocmVkID8gJyNmMTAnIDogJyMwMGFjZmMnKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwub2JqZWN0M0QuYmFja2dyb3VuZC5zZXQocmVkID8gJyM3NzAxMDAnIDogJyMxNTI1MmQnKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwub2JqZWN0M0QuZm9nLmNvbG9yLnNldChyZWQgPyAnI2EwMCcgOiAnIzAwN2NiOScpO1xuXG4gICAgdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMubWF0ZXJpYWxzLm5lb24uY29sb3IgPSByZWQgPyB0aGlzLm5lb25SZWQgOiB0aGlzLm5lb25CbHVlO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFscy5kZWZhdWx0LmNvbG9yID0gcmVkID8gdGhpcy5kZWZhdWx0UmVkIDogdGhpcy5kZWZhdWx0Qmx1ZTtcblxuICAgIHRoaXMubWluZU1hdGVyaWFsLmNvbG9yID0gdGhpcy5taW5lQ29sb3JbcmVkID8gJ3JlZCcgOiAnYmx1ZSddO1xuICAgIHRoaXMubWluZU1hdGVyaWFsLmVtaXNzaXZlID0gdGhpcy5taW5lRW1pc3Npb25bcmVkID8gJ3JlZCcgOiAnYmx1ZSddO1xuICAgIHRoaXMubWluZU1hdGVyaWFsLmVudk1hcCA9IHRoaXMubWluZUVudk1hcFtyZWQgPyAncmVkJyA6ICdibHVlJ107XG4gICAgdGhpcy5taW5lTWF0ZXJpYWwubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9XG5cbiAgKi9cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc3RhZ2UtY29sb3JzLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzdGFnZS1sYXNlcnMnLCB7XG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnNwZWVkID0gMDtcbiAgICB0aGlzLmxhc2VycyA9IFtcbiAgICAgIHRoaXMuZWwuY2hpbGRyZW5bMF0ub2JqZWN0M0QsXG4gICAgICB0aGlzLmVsLmNoaWxkcmVuWzFdLm9iamVjdDNELFxuICAgICAgdGhpcy5lbC5jaGlsZHJlblsyXS5vYmplY3QzRFxuICAgIF07XG4gIH0sXG5cbiAgcHVsc2U6IGZ1bmN0aW9uIChzcGVlZCkge1xuICAgIHRoaXMuc3BlZWQgPSBzcGVlZCAvIDg7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgaWYgKHRoaXMuc3BlZWQgPT09IDApIHsgcmV0dXJuOyB9XG4gICAgZGVsdGEgLz0gMTAwMDtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7XG4gICAgICB0aGlzLnNwZWVkICo9IDAuOTc7XG4gICAgICBpZiAoTWF0aC5hYnModGhpcy5zcGVlZCkgPCAwLjAxKSB7XG4gICAgICAgIHRoaXMuc3BlZWQgPSAwO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMubGFzZXJzWzBdLnJvdGF0aW9uLnogKz0gdGhpcy5zcGVlZCAqIGRlbHRhO1xuICAgIHRoaXMubGFzZXJzWzFdLnJvdGF0aW9uLnogLT0gdGhpcy5zcGVlZCAqIGRlbHRhICogMS4wMTtcbiAgICB0aGlzLmxhc2Vyc1syXS5yb3RhdGlvbi56ICs9IHRoaXMuc3BlZWQgKiBkZWx0YSAqIDEuMDI7XG4gIH1cbn0pXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zdGFnZS1sYXNlcnMuanMiLCJBRlJBTUUucmVnaXN0ZXJTaGFkZXIoJ3N0YWdlU2hhZGVyJywge1xuICBzY2hlbWE6IHtcbiAgICBjb2xvcjoge3R5cGU6ICd2ZWMzJywgaXM6ICd1bmlmb3JtJywgZGVmYXVsdDoge3g6IDAsIHk6IDAsIHo6IDB9fSxcbiAgICBmb2dDb2xvcjoge3R5cGU6ICd2ZWMzJywgaXM6ICd1bmlmb3JtJywgZGVmYXVsdDoge3g6IDAsIHk6IDAuNDgsIHo6IDAuNzJ9fSxcbiAgICBzcmM6IHt0eXBlOiAnbWFwJywgaXM6ICd1bmlmb3JtJ30sXG5cbiAgfSxcblxuICB2ZXJ0ZXhTaGFkZXI6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB1dnMueHkgPSB1di54eTtcbiAgICAgIHZlYzQgcCA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XG4gICAgICB3b3JsZFBvcyA9IChtb2RlbE1hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKSkueHl6O1xuICAgICAgZ2xfUG9zaXRpb24gPSBwO1xuICAgIH1cbiAgYCxcblxuICBmcmFnbWVudFNoYWRlcjogYFxuICAgICNkZWZpbmUgRk9HX1JBRElVUyAgNTAuMFxuICAgICNkZWZpbmUgRk9HX0ZBTExPRkYgNDUuMFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHVuaWZvcm0gdmVjMyBjb2xvcjtcbiAgICB1bmlmb3JtIHZlYzMgZm9nQ29sb3I7XG4gICAgdW5pZm9ybSBzYW1wbGVyMkQgc3JjO1xuXG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdmVjNCBjb2wgPSB0ZXh0dXJlMkQoc3JjLCB1dnMpO1xuICAgICAgY29sLnh5eiA9IG1peChmb2dDb2xvciwgY29sLnh5eiwgY2xhbXAoZGlzdGFuY2Uod29ybGRQb3MsIHZlYzMoMC4sIDAuLCAtRk9HX1JBRElVUykpIC8gRk9HX0ZBTExPRkYsIDAuLCAxLikpO1xuICAgICAgZ2xfRnJhZ0NvbG9yID0gY29sO1xuICAgIH1cbiAgYFxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zdGFnZS1zaGFkZXIuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3N0YXRzLXBhcmFtJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ3N0YXRzJykgPT09ICd0cnVlJykge1xuICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3N0YXRzJywgJycpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zdGF0cy1wYXJhbS5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc3RlcGJhY2snLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RlcGJhY2snKTtcbiAgICB0aGlzLmNhbWVyYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW1lcmEnKTtcbiAgICB0aGlzLmxhc3RUaW1lID0gMDtcbiAgICB0aGlzLmxpbWl0ID0gIC0gKHRoaXMuZWwuZ2V0QXR0cmlidXRlKCdnZW9tZXRyeScpLmhlaWdodCAvIDIgLSAwLjYpO1xuICAgIHRoaXMudGhyb3R0bGluZyA9IDMwMDtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICBpZiAodGltZSAtIHRoaXMubGFzdFRpbWUgPCB0aGlzLnRocm90dGxpbmcpIHsgcmV0dXJuOyB9XG5cbiAgICB2YXIgY2FtUG9zID0gdGhpcy5jYW1lcmEub2JqZWN0M0QucG9zaXRpb247XG4gICAgdmFyIG1zZ1BvcyA9IHRoaXMubWVzc2FnZS5vYmplY3QzRC5wb3NpdGlvbjtcblxuICAgIGlmIChjYW1Qb3MueiA8IHRoaXMubGltaXQpIHtcbiAgICAgIHRoaXMudGhyb3R0bGluZyA9IDIwO1xuICAgICAgdGhpcy5tZXNzYWdlLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgICAgdGhpcy5tZXNzYWdlLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwub3BhY2l0eSA9IDEgLSBNYXRoLmFicyhjYW1Qb3MueiAtIG1zZ1Bvcy56KTtcbiAgICAgIG1zZ1Bvcy54ID0gY2FtUG9zLng7XG4gICAgICBtc2dQb3MueSA9IGNhbVBvcy55O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMubWVzc2FnZS5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICB0aGlzLnRocm90dGxpbmcgPSAzMDA7XG4gICAgfVxuXG4gICAgdGhpcy5sYXN0VGltZSA9IHRpbWU7XG4gIH1cblxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zdGVwYmFjay5qcyIsIi8qKlxuICogUHVsbCBhIHN1Ym1lc2ggb3V0IG9mIGEgbW9kZWwgZmlsZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzdWItb2JqZWN0Jywge1xuICBzY2hlbWE6IHtcbiAgICBmcm9tOiB7dHlwZTogJ3NlbGVjdG9yJ30sXG4gICAgbmFtZToge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgZGF0YS5mcm9tLmFkZEV2ZW50TGlzdGVuZXIoJ21vZGVsLWxvYWRlZCcsIGV2dCA9PiB7XG4gICAgICBjb25zdCBtb2RlbCA9IGV2dC5kZXRhaWwubW9kZWw7XG4gICAgICBjb25zdCBzdWJzZXQgPSBtb2RlbC5nZXRPYmplY3RCeU5hbWUoZGF0YS5uYW1lKTtcbiAgICAgIGVsLnNldE9iamVjdDNEKCdtZXNoJywgc3Vic2V0LmNsb25lKCkpO1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsICdzaGFkZXInLCAnZmxhdCcpO1xuICAgICAgZWwuZW1pdCgnc3Vib2JqZWN0bG9hZGVkJywgbnVsbCwgZmFsc2UpO1xuICAgIH0pO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3N1Yi1vYmplY3QuanMiLCIvKiBnbG9iYWwgQUZSQU1FICovXG52YXIgS0VZQk9BUkRTID0ge1xuICBzdXBlcnNhYmVyOiB7d3JhcENvdW50OiAyMCwgaW5wdXRPZmZzZXRZOiAwLjAwOCwgaW5wdXRPZmZzZXRYOiAwLjA4LCBpbWc6ICdrZXlib2FyZC5wbmcnLCBob3ZlckltZzogJ2tleWJvYXJkLWhvdmVyLnBuZycsIGxheW91dDogW3tcImtleVwiOlwiMVwiLCBcInhcIjowLjAxNCwgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiMlwiLCBcInhcIjowLjEwOCwgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiM1wiLCBcInhcIjowLjIwMywgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiNFwiLCBcInhcIjowLjI5OSwgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiNVwiLCBcInhcIjowLjM5NCwgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiNlwiLCBcInhcIjowLjQ4NywgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiN1wiLCBcInhcIjowLjU4MywgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiOFwiLCBcInhcIjowLjY3NywgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiOVwiLCBcInhcIjowLjc3MiwgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiMFwiLCBcInhcIjowLjg2NiwgXCJ5XCI6MC4wMjQsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwicVwiLCBcInhcIjowLjAxNCwgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwid1wiLCBcInhcIjowLjEwOCwgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiZVwiLCBcInhcIjowLjIwMywgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiclwiLCBcInhcIjowLjI5OSwgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwidFwiLCBcInhcIjowLjM5NCwgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwieVwiLCBcInhcIjowLjQ4NywgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiaVwiLCBcInhcIjowLjY3NywgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwidVwiLCBcInhcIjowLjU4MywgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwib1wiLCBcInhcIjowLjc3MiwgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwicFwiLCBcInhcIjowLjg2NiwgXCJ5XCI6MC4yMTUsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiYVwiLCBcInhcIjowLjA2MywgXCJ5XCI6MC40MDUsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwic1wiLCBcInhcIjowLjE1OCwgXCJ5XCI6MC40MDUsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiZFwiLCBcInhcIjowLjI1MywgXCJ5XCI6MC40MDUsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiZlwiLCBcInhcIjowLjM0OSwgXCJ5XCI6MC40MDUsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiZ1wiLCBcInhcIjowLjQ0MywgXCJ5XCI6MC40MDUsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwiaFwiLCBcInhcIjowLjUzNywgXCJ5XCI6MC40MDUsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwialwiLCBcInhcIjowLjYzMywgXCJ5XCI6MC40MDUsIFwid1wiOjAuMDkyLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwia1wiLCBcInhcIjowLjcyNiwgXCJ5XCI6MC40MDUsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4M30sIHtcImtleVwiOlwibFwiLCBcInhcIjowLjgyMSwgXCJ5XCI6MC40MDUsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4M30sIHtcImtleVwiOlwielwiLCBcInhcIjowLjExMSwgXCJ5XCI6MC41OTgsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4MX0sIHtcImtleVwiOlwieFwiLCBcInhcIjowLjIwNSwgXCJ5XCI6MC41OTgsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4MX0sIHtcImtleVwiOlwiY1wiLCBcInhcIjowLjMwMSwgXCJ5XCI6MC41OTgsIFwid1wiOjAuMDk1LCBcImhcIjowLjE4MX0sIHtcImtleVwiOlwidlwiLCBcInhcIjowLjM5NiwgXCJ5XCI6MC41OTgsIFwid1wiOjAuMDkzLCBcImhcIjowLjE4MX0sIHtcImtleVwiOlwiYlwiLCBcInhcIjowLjQ5LCBcInlcIjowLjU5OCwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgxfSwge1wia2V5XCI6XCJuXCIsIFwieFwiOjAuNTg1LCBcInlcIjowLjU5OCwgXCJ3XCI6MC4wOTQsIFwiaFwiOjAuMTgxfSwge1wia2V5XCI6XCJtXCIsIFwieFwiOjAuNjgsIFwieVwiOjAuNTk4LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODF9LCB7XCJrZXlcIjpcIkRlbGV0ZVwiLCBcInhcIjowLjc3NywgXCJ5XCI6MC41OTgsIFwid1wiOjAuMTM3LCBcImhcIjowLjE4MX0sIHtcImtleVwiOlwiIFwiLCBcInhcIjowLjI5NywgXCJ5XCI6MC43ODgsIFwid1wiOjAuMzgxLCBcImhcIjowLjIwMX0sIHtcImtleVwiOlwiRXNjYXBlXCIsIFwieFwiOjAuMDEzLCBcInlcIjowLjc5NywgXCJ3XCI6MC4xMzcsIFwiaFwiOjAuMTgxfSwge1wia2V5XCI6XCJJbnNlcnRcIiwgXCJ4XCI6MC4wMTQsIFwieVwiOi0wLjAwMSwgXCJ3XCI6MC4wMSwgXCJoXCI6MC4wMDV9XX1cbn07XG5cbmlmICh0eXBlb2YgQUZSQU1FID09PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0NvbXBvbmVudCBhdHRlbXB0ZWQgdG8gcmVnaXN0ZXIgYmVmb3JlIEFGUkFNRSB3YXMgYXZhaWxhYmxlLicpO1xufVxuXG52YXIgRm9udEZhY3RvcnMgPSB7XG4gIHJvYm90bzogMTcsXG4gIGFpbGVyb25zZW1pYm9sZDogMjAsXG4gIGRlamF2dTogMjAuNSxcbiAgZXhvMmJvbGQ6IDIwLFxuICBleG8yc2VtaWJvbGQ6IDIwLjMsXG4gIGtlbHNvbnNhbnM6IDIyLjgsXG4gIG1vbm9pZDogMTkuNSxcbiAgbW96aWxsYXZyOiA5LjUsXG4gIHNvdXJjZWNvZGVwcm86IDIwLjNcbn07XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc3VwZXIta2V5Ym9hcmQnLCB7XG4gIHNjaGVtYToge1xuICAgIGFsaWduOiB7ZGVmYXVsdDogJ2xlZnQnLCBvbmVPZjogWydsZWZ0JywgJ2NlbnRlcicsICdyaWdodCddfSxcbiAgICBibGlua2luZ1NwZWVkOiB7dHlwZTogJ2ludCcsIGRlZmF1bHQ6IDQwMH0sXG4gICAgZmlsdGVyczoge3R5cGU6ICdhcnJheSd9LFxuICAgIC8vIHJvYm90byBhaWxlcm9uc2VtaWJvbGQgZGVqYXZ1IGV4bzJib2xkIGV4bzJzZW1pYm9sZCBrZWxzb25zYW5zIG1vbm9pZCBzb3VyY2Vjb2RlcHJvXG4gICAgZm9udDoge2RlZmF1bHQ6ICdhaWxlcm9uc2VtaWJvbGQnfSxcbiAgICBoYW5kOiB7dHlwZTogJ3NlbGVjdG9yJ30sXG4gICAgaW1hZ2VQYXRoOiB7ZGVmYXVsdDogJy4nfSxcbiAgICBpbmplY3RUb1JheWNhc3Rlck9iamVjdHM6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBpbnB1dENvbG9yOiB7dHlwZTogJ2NvbG9yJywgZGVmYXVsdDogJyM2Njk5ZmYnfSxcbiAgICBpbnRlcnZhbDoge3R5cGU6ICdpbnQnLCBkZWZhdWx0OiA1MH0sXG4gICAga2V5QmdDb2xvcjoge3R5cGU6ICdjb2xvcicsIGRlZmF1bHQ6ICcjMDAwJ30sXG4gICAga2V5Q29sb3I6IHt0eXBlOiAnY29sb3InLCBkZWZhdWx0OiAnIzY2OTlmZid9LFxuICAgIGtleUhvdmVyQ29sb3I6IHt0eXBlOiAnY29sb3InLCBkZWZhdWx0OiAnIzFBNDA3Rid9LFxuICAgIGtleVByZXNzQ29sb3I6IHt0eXBlOiAnY29sb3InLCBkZWZhdWx0OiAnIzUyOTBGNid9LFxuICAgIGxhYmVsOiB7dHlwZTogJ3N0cmluZycsIGRlZmF1bHQ6ICcnfSxcbiAgICBsYWJlbENvbG9yOiB7dHlwZTogJ2NvbG9yJywgZGVmYXVsdDogJyNhYWEnfSxcbiAgICBtYXhMZW5ndGg6IHt0eXBlOiAnaW50JywgZGVmYXVsdDogMH0sXG4gICAgbW9kZWw6IHtkZWZhdWx0OiAnYmFzaWMnfSxcbiAgICBzaG93OiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgdmFsdWU6IHt0eXBlOiAnc3RyaW5nJywgZGVmYXVsdDogJyd9LFxuICAgIHdpZHRoOiB7ZGVmYXVsdDogMC44fVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGljay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmNoYW5nZUV2ZW50RGV0YWlsID0ge307XG4gICAgdGhpcy50ZXh0SW5wdXRPYmplY3QgPSB7fTtcblxuICAgIHRoaXMua2V5cyA9IG51bGw7XG4gICAgdGhpcy5mb2N1c2VkID0gZmFsc2U7XG4gICAgdGhpcy5rZXlIb3ZlciA9IG51bGw7XG4gICAgdGhpcy5wcmV2Q2hlY2tUaW1lID0gbnVsbDtcbiAgICB0aGlzLnNoaWZ0ID0gZmFsc2U7XG5cbiAgICB0aGlzLnJhd1ZhbHVlID0gdGhpcy5kYXRhLnZhbHVlO1xuICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gdGhpcy5kYXRhLnZhbHVlO1xuXG4gICAgdGhpcy51c2VyRmlsdGVyRnVuYyA9IG51bGw7XG4gICAgdGhpcy5pbnRlcnZhbElkID0gMDtcblxuICAgIC8vIENyZWF0ZSBrZXlib2FyZCBpbWFnZS5cbiAgICB0aGlzLmtiSW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICB0aGlzLmtiSW1nLmNsYXNzTGlzdC5hZGQoJ2tleWJvYXJkUmF5Y2FzdGFibGUnKTtcbiAgICB0aGlzLmtiSW1nLmNsYXNzTGlzdC5hZGQoJ3N1cGVyS2V5Ym9hcmRJbWFnZScpO1xuICAgIHRoaXMua2JJbWcuYWRkRXZlbnRMaXN0ZW5lcigncmF5Y2FzdGVyLWludGVyc2VjdGVkJywgdGhpcy5ob3Zlci5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmtiSW1nLmFkZEV2ZW50TGlzdGVuZXIoJ3JheWNhc3Rlci1pbnRlcnNlY3RlZC1jbGVhcmVkJywgdGhpcy5ibHVyLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy5rYkltZyk7XG5cbiAgICAvLyBDcmVhdGUgbGFiZWwuXG4gICAgdGhpcy5sYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG4gICAgdGhpcy5sYWJlbC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCB7XG4gICAgICBhbGlnbjogJ2NlbnRlcicsXG4gICAgICBmb250OiB0aGlzLmRhdGEuZm9udCxcbiAgICAgIGJhc2VsaW5lOiAnYm90dG9tJyxcbiAgICAgIGxpbmVIZWlnaHQ6IDQwLFxuICAgICAgc2hhZGVyOiAnbXNkZicsXG4gICAgICBuZWdhdGU6IHRydWUsXG4gICAgICB2YWx1ZTogdGhpcy5kYXRhLmxhYmVsLFxuICAgICAgY29sb3I6IHRoaXMuZGF0YS5sYWJlbENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMuZGF0YS53aWR0aCxcbiAgICAgIHdyYXBDb3VudDogMzB9KTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMubGFiZWwpO1xuXG4gICAgLy8gQ3JlYXRlIGlucHV0LlxuICAgIHRoaXMudGV4dElucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICB0aGlzLnRleHRJbnB1dC5zZXRBdHRyaWJ1dGUoJ21peGluJywgJ3N1cGVyS2V5Ym9hcmRUZXh0SW5wdXQnKTtcbiAgICB0aGlzLnRleHRJbnB1dC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCB7XG4gICAgICBhbGlnbjogdGhpcy5kYXRhLmFsaWduLFxuICAgICAgZm9udDogdGhpcy5kYXRhLmZvbnQsXG4gICAgICBsaW5lSGVpZ2h0OiAzNSxcbiAgICAgIHZhbHVlOiB0aGlzLmRhdGEudmFsdWUsXG4gICAgICBjb2xvcjogdGhpcy5kYXRhLmlucHV0Q29sb3IsXG4gICAgICB3aWR0aDogdGhpcy5kYXRhLndpZHRoLFxuICAgICAgd3JhcENvdW50OiAyMFxuICAgIH0pO1xuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy50ZXh0SW5wdXQpO1xuXG4gICAgdGhpcy5jdXJzb3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgIHRoaXMuY3Vyc29yLm9iamVjdDNELnBvc2l0aW9uLnNldCgwLCAwLCAwLjAwMSk7XG4gICAgdGhpcy5jdXJzb3Iuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHtzaGFkZXI6ICdmbGF0JywgY29sb3I6IHRoaXMuZGF0YS5pbnB1dENvbG9yfSk7XG4gICAgdGhpcy50ZXh0SW5wdXQuYXBwZW5kQ2hpbGQodGhpcy5jdXJzb3IpO1xuICAgIHRoaXMuY3Vyc29yVXBkYXRlZCA9IGZhbHNlO1xuXG4gICAgdGhpcy5rZXlCZ0NvbG9yID0gbmV3IFRIUkVFLkNvbG9yKCk7XG4gICAgdGhpcy5rZXlIb3ZlckNvbG9yID0gbmV3IFRIUkVFLkNvbG9yKCk7XG4gICAgdGhpcy5rZXlQcmVzc0NvbG9yID0gbmV3IFRIUkVFLkNvbG9yKCk7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChldikge1xuICAgICAgaWYgKGV2LmtleSA9PT0gJ3QnKSB7XG4gICAgICAgIHZhciBzcyA9ICcnO1xuICAgICAgICB2YXIgcyA9ICdhYmNkZWZnaGlqa2xtb3BxcnN0dXZRV0lFVVRHQVNETElHS0JYQUNRV0VUTDEwMjM5NDY3NjQ1Nyc7XG4gICAgICAgIHZhciBsID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMjApO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGw7IGkrKykgc3MgKz0gc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzLmxlbmd0aCldO1xuICAgICAgICBzZWxmLmVsLnNldEF0dHJpYnV0ZSgnc3VwZXIta2V5Ym9hcmQnLCB7dmFsdWU6IHNzfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdzaG93JywgdGhpcy5vcGVuLmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy5oYW5kID0gbnVsbDtcbiAgICB0aGlzLmhhbmRMaXN0ZW5lcnNTZXQgPSBmYWxzZTtcbiAgICB0aGlzLnJheWNhc3RlciA9IG51bGw7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHZhciBrYmRhdGEgPSBLRVlCT0FSRFNbdGhpcy5kYXRhLm1vZGVsXTtcbiAgICB2YXIgdyA9IHRoaXMuZGF0YS53aWR0aDtcbiAgICB2YXIgaCA9IHRoaXMuZGF0YS53aWR0aCAvIDI7XG4gICAgdmFyIHcyID0gdyAvIDI7XG4gICAgdmFyIGgyID0gaCAvIDI7XG5cbiAgICBpZiAoa2JkYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ3N1cGVyLWtleWJvYXJkIEVSUk9SOiBtb2RlbCBcIicgKyB0aGlzLmRhdGEubW9kZWwgKyAnXCIgdW5kZWZpbmVkLicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghb2xkRGF0YSB8fCB0aGlzLmRlZmF1bHRWYWx1ZSAhPT0gb2xkRGF0YS5kZWZhdWx0VmFsdWUpIHtcbiAgICAgIHRoaXMucmF3VmFsdWUgPSB0aGlzLmRhdGEudmFsdWU7XG4gICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IHRoaXMuZGF0YS52YWx1ZTtcbiAgICAgIHRoaXMudXBkYXRlVGV4dElucHV0KHRoaXMuZmlsdGVyKHRoaXMuZGF0YS52YWx1ZSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVwZGF0ZVRleHRJbnB1dCh0aGlzLmZpbHRlcih0aGlzLnJhd1ZhbHVlKSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS53aWR0aCAhPT0gb2xkRGF0YS53aWR0aCB8fFxuICAgICAgICB0aGlzLmRhdGEuaGVpZ2h0ICE9PSBvbGREYXRhLmhlaWdodCB8fFxuICAgICAgICB0aGlzLmRhdGEua2V5Q29sb3IgIT09IG9sZERhdGEua2V5Q29sb3IpIHtcbiAgICAgIHRoaXMua2JJbWcuc2V0QXR0cmlidXRlKCdnZW9tZXRyeScsIHtwcmltaXRpdmU6ICdwbGFuZScsIHdpZHRoOiB3LCBoZWlnaHQ6IGh9KTtcbiAgICAgIHRoaXMua2JJbWcuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHtcbiAgICAgICAgc2hhZGVyOiAnZmxhdCcsXG4gICAgICAgIHNyYzogdGhpcy5kYXRhLmltYWdlUGF0aCArICcvJyArIGtiZGF0YS5pbWcsXG4gICAgICAgIGNvbG9yOiB0aGlzLmRhdGEua2V5Q29sb3IsXG4gICAgICAgIHRyYW5zcGFyZW50OiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kYXRhLmxhYmVsICE9PSBvbGREYXRhLmxhYmVsIHx8XG4gICAgICAgIHRoaXMuZGF0YS5sYWJlbENvbG9yICE9PSBvbGREYXRhLmxhYmVsQ29sb3IgfHxcbiAgICAgICAgdGhpcy5kYXRhLndpZHRoICE9PSBvbGREYXRhLndpZHRoKSB7XG4gICAgICB0aGlzLmxhYmVsLnNldEF0dHJpYnV0ZSgndGV4dCcsIHtcbiAgICAgICAgdmFsdWU6IHRoaXMuZGF0YS5sYWJlbCwgY29sb3I6IHRoaXMuZGF0YS5sYWJlbENvbG9yLCB3aWR0aDogdGhpcy5kYXRhLndpZHRofSk7XG4gICAgICB0aGlzLmxhYmVsLm9iamVjdDNELnBvc2l0aW9uLnNldCgwLCAwLjM1ICogdywgLTAuMDIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEud2lkdGggIT09IG9sZERhdGEud2lkdGggfHxcbiAgICAgICAgdGhpcy5kYXRhLmtleUJnQ29sb3IgIT09IG9sZERhdGEua2V5QmdDb2xvcikge1xuICAgICAgdGhpcy5pbml0S2V5Q29sb3JQbGFuZSgpO1xuICAgIH1cblxuICAgIHZhciBpbnB1dHggPSB0aGlzLmRhdGEuYWxpZ24gIT09ICdjZW50ZXInID8ga2JkYXRhLmlucHV0T2Zmc2V0WCAqIHcgOiAwO1xuICAgIGlmICh0aGlzLmRhdGEuYWxpZ24gPT09ICdyaWdodCcpIHsgaW5wdXR4ICo9IC0xOyB9XG5cbiAgICBpZiAodGhpcy5kYXRhLmZvbnQgIT09IG9sZERhdGEuZm9udCB8fFxuICAgICAgICB0aGlzLmRhdGEuaW5wdXRDb2xvciAhPT0gb2xkRGF0YS5pbnB1dENvbG9yIHx8XG4gICAgICAgIHRoaXMuZGF0YS53aWR0aCAhPT0gb2xkRGF0YS53aWR0aCB8fFxuICAgICAgICB0aGlzLmRhdGEuYWxpZ24gIT09IG9sZERhdGEuYWxpZ24pIHtcbiAgICAgIHRoaXMudGV4dElucHV0LnNldEF0dHJpYnV0ZSgndGV4dCcsIHtcbiAgICAgICAgZm9udDogdGhpcy5kYXRhLmZvbnQsXG4gICAgICAgIGNvbG9yOiB0aGlzLmRhdGEuaW5wdXRDb2xvcixcbiAgICAgICAgd2lkdGg6IHcsXG4gICAgICAgIHdyYXBDb3VudDoga2JkYXRhLndyYXBDb3VudCxcbiAgICAgICAgYWxpZ246IHRoaXMuZGF0YS5hbGlnblxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gU29tZSBoYWNrIHdoZXJlIHRoZSBpbnB1dFJlY3QgaXMgc3RvcmVkIGluIHRoZSBJbnNlcnQga2V5LlxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2JkYXRhLmxheW91dC5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGtkYXRhID0ga2JkYXRhLmxheW91dFtpXTtcbiAgICAgIGlmIChrZGF0YS5rZXkgPT09ICdJbnNlcnQnKSB7XG4gICAgICAgIHRoaXMuaW5wdXRSZWN0ID0ga2RhdGE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy50ZXh0SW5wdXQub2JqZWN0M0QucG9zaXRpb24uc2V0KFxuICAgICAgaW5wdXR4LFxuICAgICAgKHcgLyA0KSAtICh0aGlzLmlucHV0UmVjdC55ICsgdGhpcy5pbnB1dFJlY3QuaCAvIDIpICogdyAvIDIgKyBrYmRhdGEuaW5wdXRPZmZzZXRZICogdyxcbiAgICAgIDAuMDAyXG4gICAgKTtcblxuICAgIGlmICh0aGlzLmRhdGEud2lkdGggIT09IG9sZERhdGEud2lkdGgpIHtcbiAgICAgIHRoaXMuY3Vyc29yLnNldEF0dHJpYnV0ZSgnZ2VvbWV0cnknLCB7XG4gICAgICAgIHByaW1pdGl2ZTogJ3BsYW5lJywgd2lkdGg6IDAuMDMgKiB3LCBoZWlnaHQ6IDAuMDEgKiB3fSk7XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVDdXJzb3JQb3NpdGlvbigpO1xuICAgIHRoaXMuc2V0dXBIYW5kKCk7XG5cbiAgICB0aGlzLmtleUJnQ29sb3Iuc2V0KHRoaXMuZGF0YS5rZXlCZ0NvbG9yKTtcbiAgICB0aGlzLmtleUhvdmVyQ29sb3Iuc2V0KHRoaXMuZGF0YS5rZXlIb3ZlckNvbG9yKTtcbiAgICB0aGlzLmtleVByZXNzQ29sb3Iuc2V0KHRoaXMuZGF0YS5rZXlQcmVzc0NvbG9yKTtcblxuICAgIGlmICh0aGlzLmRhdGEuc2hvdykge1xuICAgICAgdGhpcy5vcGVuKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUpIHtcbiAgICB2YXIgaW50ZXJzZWN0aW9uO1xuXG4gICAgaWYgKHRoaXMucHJldkNoZWNrVGltZSAmJiAodGltZSAtIHRoaXMucHJldkNoZWNrVGltZSA8IHRoaXMuZGF0YS5pbnRlcnZhbCkpIHsgcmV0dXJuOyB9XG4gICAgaWYgKCF0aGlzLnByZXZDaGVja1RpbWUpIHtcbiAgICAgIHRoaXMucHJldkNoZWNrVGltZSA9IHRpbWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnJheWNhc3RlcikgeyByZXR1cm47IH1cbiAgICBpZiAoIXRoaXMuZm9jdXNlZCkgeyByZXR1cm47IH1cblxuICAgIGludGVyc2VjdGlvbiA9IHRoaXMucmF5Y2FzdGVyLmdldEludGVyc2VjdGlvbih0aGlzLmtiSW1nKTtcbiAgICBpZiAoIWludGVyc2VjdGlvbikgeyByZXR1cm47IH1cblxuICAgIHZhciB1diA9IGludGVyc2VjdGlvbi51djtcbiAgICB2YXIga2V5cyA9IEtFWUJPQVJEU1t0aGlzLmRhdGEubW9kZWxdLmxheW91dDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBrID0ga2V5c1tpXTtcbiAgICAgIGlmICh1di54ID4gay54ICYmIHV2LnggPCBrLnggKyBrLncgJiYgKDEuMCAtIHV2LnkpID4gay55ICYmICgxLjAgLSB1di55KSA8IGsueSArIGsuaCkge1xuICAgICAgICBpZiAodGhpcy5rZXlIb3ZlciAhPT0gaykge1xuICAgICAgICAgIC8vIFVwZGF0ZSBrZXkgaG92ZXIuXG4gICAgICAgICAgdGhpcy5rZXlIb3ZlciA9IGs7XG4gICAgICAgICAgdGhpcy51cGRhdGVLZXlDb2xvclBsYW5lKHRoaXMua2V5SG92ZXIua2V5LCB0aGlzLmtleUhvdmVyQ29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmN1cnNvclVwZGF0ZWQpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5zdGFydEJsaW5raW5nKCk7XG4gIH0sXG5cbiAgcGF1c2U6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnN0b3BCbGlua2luZygpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUaGUgcGxhbmUgZm9yIHZpc3VhbCBmZWVkYmFjayB3aGVuIGEga2V5IGlzIGhvdmVyZWQgb3IgY2xpY2tlZFxuICAgKi9cbiAgaW5pdEtleUNvbG9yUGxhbmU6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIga2JkYXRhID0gS0VZQk9BUkRTW3RoaXMuZGF0YS5tb2RlbF07XG4gICAgdmFyIGtleUNvbG9yUGxhbmUgPSB0aGlzLmtleUNvbG9yUGxhbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgIGtleUNvbG9yUGxhbmUuY2xhc3NMaXN0LmFkZCgnc3VwZXJLZXlib2FyZEtleUNvbG9yUGxhbmUnKTtcbiAgICBrZXlDb2xvclBsYW5lLm9iamVjdDNELnBvc2l0aW9uLnogPSAwLjAwMTtcbiAgICBrZXlDb2xvclBsYW5lLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICBrZXlDb2xvclBsYW5lLnNldEF0dHJpYnV0ZSgnZ2VvbWV0cnknLCB7cHJpbWl0aXZlOiAncGxhbmUnLCBidWZmZXI6IGZhbHNlfSk7XG4gICAga2V5Q29sb3JQbGFuZS5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywge3NoYWRlcjogJ2ZsYXQnLCBjb2xvcjogdGhpcy5kYXRhLmtleUJnQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zcGFyZW50OiB0cnVlfSk7XG4gICAgaWYgKGtiZGF0YS5ob3ZlckltZykge1xuICAgICAga2V5Q29sb3JQbGFuZS5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywge3NyYzogdGhpcy5kYXRhLmltYWdlUGF0aCArICcvJyArIGtiZGF0YS5ob3ZlckltZ30pO1xuICAgIH1cblxuICAgIGtleUNvbG9yUGxhbmUuYWRkRXZlbnRMaXN0ZW5lcignY29tcG9uZW50aW5pdGlhbGl6ZWQnLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICBpZiAoZXZ0LmRldGFpbC5uYW1lICE9PSAnbWF0ZXJpYWwnKSB7IHJldHVybjsgfVxuICAgICAgaWYgKCFrYmRhdGEuaG92ZXJJbWcpIHtcbiAgICAgICAgdGhpcy5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLmJsZW5kaW5nID0gVEhSRUUuQWRkaXRpdmVCbGVuZGluZztcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKGtleUNvbG9yUGxhbmUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBNb3ZlIGtleSBjb2xvciBwbGFuZSB0byBhcHByb3ByaWF0ZSBwb3NpdGlvbiwgc2NhbGUsIGFuZCBjaGFuZ2UgY29sb3IuXG4gICAqL1xuICB1cGRhdGVLZXlDb2xvclBsYW5lOiBmdW5jdGlvbiAoa2V5LCBjb2xvcikge1xuICAgIHZhciBrYmRhdGEgPSBLRVlCT0FSRFNbdGhpcy5kYXRhLm1vZGVsXTtcbiAgICB2YXIga2V5Q29sb3JQbGFuZSA9IHRoaXMua2V5Q29sb3JQbGFuZTtcblxuICAgIC8vIFVuc2V0LlxuICAgIGlmICgha2V5KSB7XG4gICAgICBrZXlDb2xvclBsYW5lLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtiZGF0YS5sYXlvdXQubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBrZGF0YSA9IGtiZGF0YS5sYXlvdXRbaV07XG4gICAgICBpZiAoa2RhdGEua2V5ICE9PSBrZXkpIHsgY29udGludWU7IH1cbiAgICAgIHZhciB3ID0gdGhpcy5kYXRhLndpZHRoO1xuICAgICAgdmFyIGggPSB0aGlzLmRhdGEud2lkdGggLyAyO1xuICAgICAgdmFyIHcyID0gdyAvIDI7XG4gICAgICB2YXIgaDIgPSBoIC8gMjtcbiAgICAgIHZhciBrZXl3ID0ga2RhdGEudyAqIHc7XG4gICAgICB2YXIga2V5aCA9IGtkYXRhLmggKiBoO1xuICAgICAgLy8gU2l6ZS5cbiAgICAgIGtleUNvbG9yUGxhbmUub2JqZWN0M0Quc2NhbGUueCA9IGtleXc7XG4gICAgICBrZXlDb2xvclBsYW5lLm9iamVjdDNELnNjYWxlLnkgPSBrZXloO1xuICAgICAgLy8gUG9zaXRpb24uXG4gICAgICBrZXlDb2xvclBsYW5lLm9iamVjdDNELnBvc2l0aW9uLnggPSBrZGF0YS54ICogdyAtIHcyICsga2V5dyAvIDI7XG4gICAgICBrZXlDb2xvclBsYW5lLm9iamVjdDNELnBvc2l0aW9uLnkgPSAoMSAtIGtkYXRhLnkpICogaCAtIGgyIC0ga2V5aCAvIDI7XG4gICAgICAvLyBDb2xvci5cbiAgICAgIGtleUNvbG9yUGxhbmUuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5jb2xvci5jb3B5KGNvbG9yKTtcbiAgICAgIC8vIFVWcy5cblxuICAgICAgdmFyIGdlb21ldHJ5ID0ga2V5Q29sb3JQbGFuZS5nZXRPYmplY3QzRCgnbWVzaCcpLmdlb21ldHJ5XG4gICAgICB2YXIgdXZTZXQgPSBnZW9tZXRyeS5mYWNlVmVydGV4VXZzWzBdO1xuICAgICAgdmFyIGtkYXRhWSA9IDEgLSBrZGF0YS55O1xuICAgICAgdXZTZXRbMF1bMF0uc2V0KGtkYXRhLngsIGtkYXRhWSk7XG4gICAgICB1dlNldFswXVsxXS5zZXQoa2RhdGEueCwga2RhdGFZIC0ga2RhdGEuaCk7XG4gICAgICB1dlNldFswXVsyXS5zZXQoa2RhdGEueCArIGtkYXRhLncsIGtkYXRhWSk7XG4gICAgICB1dlNldFsxXVswXS5zZXQoa2RhdGEueCwga2RhdGFZIC0ga2RhdGEuaCk7XG4gICAgICB1dlNldFsxXVsxXS5zZXQoa2RhdGEueCArIGtkYXRhLncsIGtkYXRhWSAtIGtkYXRhLmgpO1xuICAgICAgdXZTZXRbMV1bMl0uc2V0KGtkYXRhLnggKyBrZGF0YS53LCBrZGF0YVkpO1xuICAgICAgZ2VvbWV0cnkudXZzTmVlZFVwZGF0ZSA9IHRydWU7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAga2V5Q29sb3JQbGFuZS5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgfSxcblxuICBzZXR1cEhhbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5oYW5kICYmIHRoaXMuaGFuZC5vd25SYXljYXN0ZXIpIHtcbiAgICAgIHRoaXMuaGFuZC5yZW1vdmVBdHRyaWJ1dGUoJ3JheWNhc3RlcicpO1xuICAgIH1cbiAgICBpZiAodGhpcy5kYXRhLmhhbmQpIHtcbiAgICAgIHRoaXMuaGFuZCA9IHRoaXMuZGF0YS5oYW5kO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhhbmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFtcbiAgICAgICAgJ1tjdXJzb3JdJyxcbiAgICAgICAgJ1t2aXZlLWNvbnRyb2xzXScsXG4gICAgICAgICdbdHJhY2tlZC1jb250cm9sc10nLFxuICAgICAgICAnW29jdWx1cy10b3VjaC1jb250cm9sc10nLFxuICAgICAgICAnW3dpbmRvd3MtbW90aW9uLWNvbnRyb2xzXScsXG4gICAgICAgICdbaGFuZC1jb250cm9sc10nLFxuICAgICAgICAnW2RheWRyZWFtLWNvbnRyb2xzXSBbY3Vyc29yXSA+IFtyYXljYXN0ZXJdJ1xuICAgICAgXS5qb2luKCcsJykpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5oYW5kKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdzdXBlci1rZXlib2FyZDogbm8gY29udHJvbGxlciBmb3VuZC4gQWRkIDxhLWVudGl0eT4gd2l0aCBjb250cm9sbGVyIG9yIHNwZWNpZnkgd2l0aCBzdXBlci1rZXlib2FyZD1cImhhbmQ6ICNzZWxlY3RvclRvQ29udHJvbGxlclwiLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIXRoaXMuaGFuZC5oYXNMb2FkZWQpIHtcbiAgICAgICAgdGhpcy5oYW5kLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZCcsIHRoaXMuc2V0dXBIYW5kLmJpbmQodGhpcykpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgcmF5Y2FzdGVyID0gdGhpcy5oYW5kLmNvbXBvbmVudHNbJ3JheWNhc3RlciddO1xuICAgICAgdmFyIHBhcmFtcyA9IHt9O1xuXG4gICAgICBpZiAoIXJheWNhc3Rlcikge1xuICAgICAgICB0aGlzLmhhbmQub3duUmF5Y2FzdGVyID0gdHJ1ZTtcbiAgICAgICAgcGFyYW1zLnNob3dMaW5lID0gdGhpcy5kYXRhLnNob3c7XG4gICAgICAgIHBhcmFtcy5lbmFibGVkID0gdGhpcy5kYXRhLnNob3c7XG4gICAgICAgIGlmICh0aGlzLmRhdGEuaW5qZWN0VG9SYXljYXN0ZXJPYmplY3RzKSB7XG4gICAgICAgICAgcGFyYW1zLm9iamVjdHMgPSAnLmtleWJvYXJkUmF5Y2FzdGFibGUnO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFuZC5zZXRBdHRyaWJ1dGUoJ3JheWNhc3RlcicsIHBhcmFtcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhhbmQub3duUmF5Y2FzdGVyID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLmRhdGEuaW5qZWN0VG9SYXljYXN0ZXJPYmplY3RzKSB7XG4gICAgICAgICAgdmFyIG9ianMgPSByYXljYXN0ZXIuZGF0YS5vYmplY3RzLnNwbGl0KCcsJyk7XG4gICAgICAgICAgaWYgKG9ianMuaW5kZXhPZignLmtleWJvYXJkUmF5Y2FzdGFibGUnKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIG9ianMucHVzaCgnLmtleWJvYXJkUmF5Y2FzdGFibGUnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcGFyYW1zLm9iamVjdHMgPSBvYmpzLmpvaW4oJywnKS5yZXBsYWNlKC9eLC8sICcnKTtcbiAgICAgICAgICB0aGlzLmhhbmQuc2V0QXR0cmlidXRlKCdyYXljYXN0ZXInLCBwYXJhbXMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMucmF5Y2FzdGVyID0gdGhpcy5oYW5kLmNvbXBvbmVudHMucmF5Y2FzdGVyO1xuICAgIH1cbiAgfSxcblxuICBmaWx0ZXI6IGZ1bmN0aW9uIChzdHIpIHtcbiAgICBpZiAoc3RyID09PSAnJykgeyByZXR1cm4gJyc7IH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZGF0YS5maWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzd2l0Y2ggKHRoaXMuZGF0YS5maWx0ZXJzW2ldKSB7XG4gICAgICAgIGNhc2UgJ2N1c3RvbSc6IHtcbiAgICAgICAgICBpZiAodGhpcy51c2VyRmlsdGVyRnVuYykgc3RyID0gdGhpcy51c2VyRmlsdGVyRnVuYyhzdHIpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ2FsbHVwcGVyJzoge1xuICAgICAgICAgIHN0ciA9IHN0ci50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ2FsbGxvd2VyJzoge1xuICAgICAgICAgIHN0ciA9IHN0ci50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ3RpdGxlJzoge1xuICAgICAgICAgIHN0ciA9IHN0ci5zcGxpdCgnICcpLm1hcChmdW5jdGlvbiAocykgeyByZXR1cm4gc1swXS50b1VwcGVyQ2FzZSgpICsgcy5zdWJzdHIoMSk7IH0pLmpvaW4oJyAnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdudW1iZXJzJzoge1xuICAgICAgICAgIHN0ciA9IHN0ci5zcGxpdCgnJykuZmlsdGVyKGZ1bmN0aW9uIChjKSB7IHJldHVybiAhaXNOYU4ocGFyc2VJbnQoYykpIHx8IGMgPT09ICcuJzsgfSkuam9pbignJyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnZmlyc3QnOiB7XG4gICAgICAgICAgc3RyID0gc3RyWzBdLnRvVXBwZXJDYXNlKCkgKyBzdHIuc3Vic3RyKDEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ3RyaW0nOiB7XG4gICAgICAgICAgc3RyID0gc3RyLnRyaW0oKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5kYXRhLm1heExlbmd0aCA+IDAgPyBzdHIuc3Vic3RyKDAsIHRoaXMuZGF0YS5tYXhMZW5ndGgpIDogc3RyO1xuICB9LFxuXG4gIGNsaWNrOiBmdW5jdGlvbiAoZXYpIHtcbiAgICBpZiAoIXRoaXMua2V5SG92ZXIpIHsgcmV0dXJuOyB9XG5cbiAgICBzd2l0Y2ggKHRoaXMua2V5SG92ZXIua2V5KSB7XG4gICAgICBjYXNlICdFbnRlcic6IHtcbiAgICAgICAgdGhpcy5hY2NlcHQoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdJbnNlcnQnOiB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ0RlbGV0ZSc6IHtcbiAgICAgICAgdGhpcy5yYXdWYWx1ZSA9IHRoaXMucmF3VmFsdWUuc3Vic3RyKDAsIHRoaXMucmF3VmFsdWUubGVuZ3RoIC0gMSk7XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IHRoaXMuZmlsdGVyKHRoaXMucmF3VmFsdWUpO1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnc3VwZXIta2V5Ym9hcmQnLCAndmFsdWUnLCBuZXdWYWx1ZSk7XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dElucHV0KG5ld1ZhbHVlKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VFdmVudERldGFpbC52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICB0aGlzLmVsLmVtaXQoJ3N1cGVya2V5Ym9hcmRjaGFuZ2UnLCB0aGlzLmNoYW5nZUV2ZW50RGV0YWlsKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdTaGlmdCc6IHtcbiAgICAgICAgdGhpcy5zaGlmdCA9ICF0aGlzLnNoaWZ0O1xuICAgICAgICB0aGlzLmtleUhvdmVyLmVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnY29sb3InLFxuICAgICAgICAgIHRoaXMuc2hpZnQgPyB0aGlzLmRhdGEua2V5SG92ZXJDb2xvciA6IHRoaXMuZGF0YS5rZXlCZ0NvbG9yXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnRXNjYXBlJzoge1xuICAgICAgICB0aGlzLmRpc21pc3MoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBkZWZhdWx0OiB7XG4gICAgICAgIGlmICh0aGlzLmRhdGEubWF4TGVuZ3RoID4gMCAmJiB0aGlzLnJhd1ZhbHVlLmxlbmd0aCA+IHRoaXMuZGF0YS5tYXhMZW5ndGgpIHsgYnJlYWs7IH1cbiAgICAgICAgdGhpcy5yYXdWYWx1ZSArPSB0aGlzLnNoaWZ0ID8gdGhpcy5rZXlIb3Zlci5rZXkudG9VcHBlckNhc2UoKSA6IHRoaXMua2V5SG92ZXIua2V5O1xuICAgICAgICB2YXIgbmV3VmFsdWUgPSB0aGlzLmZpbHRlcih0aGlzLnJhd1ZhbHVlKTtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3N1cGVyLWtleWJvYXJkJywgJ3ZhbHVlJywgbmV3VmFsdWUpO1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHRJbnB1dChuZXdWYWx1ZSk7XG4gICAgICAgIHRoaXMuY2hhbmdlRXZlbnREZXRhaWwudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5lbC5lbWl0KCdzdXBlcmtleWJvYXJkY2hhbmdlJywgdGhpcy5jaGFuZ2VFdmVudERldGFpbCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMudXBkYXRlS2V5Q29sb3JQbGFuZSh0aGlzLmtleUhvdmVyLmtleSwgdGhpcy5rZXlQcmVzc0NvbG9yKTtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBzZWxmLnVwZGF0ZUtleUNvbG9yUGxhbmUoc2VsZi5rZXlIb3Zlci5rZXksIHNlbGYua2V5SG92ZXJDb2xvcik7XG4gICAgfSwgMTAwKTtcbiAgICB0aGlzLnVwZGF0ZUN1cnNvclBvc2l0aW9uKCk7XG4gIH0sXG5cbiAgb3BlbjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgaWYgKHRoaXMuaGFuZCAmJiB0aGlzLmhhbmQub3duUmF5Y2FzdGVyKSB7XG4gICAgICB0aGlzLmhhbmQuc2V0QXR0cmlidXRlKCdyYXljYXN0ZXInLCB7c2hvd0xpbmU6IHRydWUsIGVuYWJsZWQ6IHRydWV9KTtcbiAgICB9XG4gIH0sXG5cbiAgY2xvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5oYW5kICYmIHRoaXMuaGFuZC5vd25SYXljYXN0ZXIpIHtcbiAgICAgIHRoaXMuaGFuZC5zZXRBdHRyaWJ1dGUoJ3JheWNhc3RlcicsIHtzaG93TGluZTogZmFsc2UsIGVuYWJsZWQ6IGZhbHNlfSk7XG4gICAgfVxuICB9LFxuXG4gIGFjY2VwdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgIGlmICh0aGlzLmhhbmQgJiYgdGhpcy5oYW5kLm93blJheWNhc3Rlcikge1xuICAgICAgdGhpcy5oYW5kLnNldEF0dHJpYnV0ZSgncmF5Y2FzdGVyJywge3Nob3dMaW5lOiBmYWxzZSwgZW5hYmxlZDogZmFsc2V9KTtcbiAgICB9XG4gICAgdGhpcy5lbC5lbWl0KCdzdXBlcmtleWJvYXJkaW5wdXQnLCB7dmFsdWU6IHRoaXMuZGF0YS52YWx1ZX0pO1xuICAgIHRoaXMuZGF0YS5zaG93ID0gZmFsc2U7XG4gIH0sXG5cbiAgZGlzbWlzczogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZGF0YS52YWx1ZSA9IHRoaXMuZGVmYXVsdFZhbHVlO1xuICAgIHRoaXMudXBkYXRlVGV4dElucHV0KCk7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgaWYgKHRoaXMuaGFuZCAmJiB0aGlzLmhhbmQub3duUmF5Y2FzdGVyKSB7XG4gICAgICB0aGlzLmhhbmQuc2V0QXR0cmlidXRlKCdyYXljYXN0ZXInLCB7c2hvd0xpbmU6IGZhbHNlLCBlbmFibGVkOiBmYWxzZX0pO1xuICAgIH1cbiAgICB0aGlzLmVsLmVtaXQoJ3N1cGVya2V5Ym9hcmRkaXNtaXNzJyk7XG4gICAgdGhpcy5kYXRhLnNob3cgPSBmYWxzZTtcbiAgfSxcblxuICBibHVyOiBmdW5jdGlvbiAoZXYpIHtcbiAgICB0aGlzLmZvY3VzZWQgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5rZXlIb3ZlciAmJiB0aGlzLmtleUhvdmVyLmtleSAhPT0gJ1NoaWZ0Jykge1xuICAgICAgdGhpcy51cGRhdGVLZXlDb2xvclBsYW5lKHRoaXMua2V5SG92ZXIua2V5LCB0aGlzLmtleUJnQ29sb3IpO1xuICAgIH1cbiAgICB0aGlzLmtleUhvdmVyID0gbnVsbDtcbiAgfSxcblxuICBob3ZlcjogZnVuY3Rpb24gKGV2KSB7XG4gICAgdGhpcy5mb2N1c2VkID0gdHJ1ZTtcbiAgfSxcblxuICBzdGFydEJsaW5raW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zdG9wQmxpbmtpbmcoKTtcbiAgICB0aGlzLmludGVydmFsSWQgPSB3aW5kb3cuc2V0SW50ZXJ2YWwodGhpcy5ibGluay5iaW5kKHRoaXMpLCB0aGlzLmRhdGEuYmxpbmtpbmdTcGVlZCk7XG4gIH0sXG5cbiAgc3RvcEJsaW5raW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKTtcbiAgICB0aGlzLmludGVydmFsSWQgPSAwO1xuICB9LFxuXG4gIGJsaW5rOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5jdXJzb3Iub2JqZWN0M0QudmlzaWJsZSA9ICF0aGlzLmN1cnNvci5vYmplY3QzRC52aXNpYmxlO1xuICB9LFxuXG4gIHNldEN1c3RvbUZpbHRlcjogZnVuY3Rpb24gKGYpIHtcbiAgICB0aGlzLnVzZXJGaWx0ZXJGdW5jID0gZjtcbiAgfSxcblxuICBhZGRDdXN0b21Nb2RlbDogZnVuY3Rpb24gKG5hbWUsIG1vZGVsKSB7XG4gICAgaWYgKCFuYW1lKSB7IHJldHVybjsgfVxuICAgIEtFWUJPQVJEU1tuYW1lXSA9IG1vZGVsO1xuICB9LFxuXG4gIHVwZGF0ZUN1cnNvclBvc2l0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGZvbnQgPSB0aGlzLnRleHRJbnB1dC5jb21wb25lbnRzLnRleHQuY3VycmVudEZvbnQ7XG4gICAgaWYgKCFmb250KSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB0aGlzLmN1cnNvci5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYudXBkYXRlQ3Vyc29yUG9zaXRpb24oKTtcbiAgICAgICAgc2VsZi5zdGFydEJsaW5raW5nKCk7XG4gICAgICB9LCA3MDApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciB3ID0gdGhpcy5kYXRhLndpZHRoO1xuICAgIHZhciBrYmRhdGEgPSBLRVlCT0FSRFNbdGhpcy5kYXRhLm1vZGVsXTtcbiAgICB2YXIgcG9zeSA9IC10aGlzLmlucHV0UmVjdC5oIC8gMiAqIHcgLyAyLjQgKyBrYmRhdGEuaW5wdXRPZmZzZXRZICogdztcbiAgICB2YXIgcmF0aW8gPSB0aGlzLmRhdGEud2lkdGggLyB0aGlzLnRleHRJbnB1dC5jb21wb25lbnRzLnRleHQuZGF0YS53cmFwQ291bnQ7XG4gICAgdmFyIHBvcyA9IDA7XG4gICAgdmFyIGZvbnRGYWN0b3IgPSBGb250RmFjdG9yc1t0aGlzLnRleHRJbnB1dC5jb21wb25lbnRzLnRleHQuZGF0YS5mb250XTtcbiAgICBpZiAoZm9udEZhY3RvciA9PT0gdW5kZWZpbmVkKSB7IGZvbnRGYWN0b3IgPSAyMDsgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5kYXRhLnZhbHVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgY2hhciA9IGZpbmRGb250Q2hhcihmb250LmNoYXJzLCB0aGlzLmRhdGEudmFsdWUuY2hhckNvZGVBdChpKSk7XG4gICAgICBwb3MgKz0gY2hhci53aWR0aCArIGNoYXIueGFkdmFuY2UgKiAoY2hhci5pZCA9PT0gMzIgPyAyIDogMSk7XG4gICAgfVxuICAgIGlmICh0aGlzLmRhdGEuYWxpZ24gPT09ICdjZW50ZXInKSB7XG4gICAgICBwb3MgPSBwb3MgKiByYXRpbyAqIGZvbnRGYWN0b3IgKiAwLjAwMTEgLyAyLjAgKyAwLjAyICogdztcbiAgICB9IGVsc2UgaWYgKHRoaXMuZGF0YS5hbGlnbiA9PT0gJ2xlZnQnKSB7XG4gICAgICBwb3MgPSBwb3MgKiByYXRpbyAqIGZvbnRGYWN0b3IgKiAwLjAwMTEgKyAwLjAyICogdztcbiAgICAgIHBvcyAtPSB3IC8gMjtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZGF0YS5hbGlnbiA9PT0gJ3JpZ2h0Jykge1xuICAgICAgcG9zID0gLXBvcyAqIHJhdGlvICogZm9udEZhY3RvciAqIDAuMDAxMSAtIDAuMDIgKiB3O1xuICAgICAgcG9zICs9IHcgLyAyO1xuICAgIH1cbiAgICB0aGlzLmN1cnNvci5vYmplY3QzRC5wb3NpdGlvbi5zZXQocG9zLCBwb3N5LCAwLjAwMSk7XG4gICAgdGhpcy5jdXJzb3JVcGRhdGVkID0gdHJ1ZTtcbiAgfSxcblxuICB1cGRhdGVUZXh0SW5wdXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIHRoaXMudGV4dElucHV0T2JqZWN0LnZhbHVlID0gdmFsdWUgfHwgdGhpcy5kYXRhLnZhbHVlO1xuICAgIHRoaXMudGV4dElucHV0LnNldEF0dHJpYnV0ZSgndGV4dCcsIHRoaXMudGV4dElucHV0T2JqZWN0KTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGZpbmRGb250Q2hhciAoY2hhcnMsIGNvZGUpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChjaGFyc1tpXS5pZCA9PT0gY29kZSkgeyByZXR1cm4gY2hhcnNbaV07IH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3N1cGVyLWtleWJvYXJkLmpzIiwiQUZSQU1FLnJlZ2lzdGVyU2hhZGVyKCdzdXBlckN1dEZ4U2hhZGVyJywge1xuICBzY2hlbWE6IHtcbiAgICBzdGFydFRpbWU6IHt0eXBlOiAnZmxvYXQnLCBpczogJ3VuaWZvcm0nfSxcbiAgICB0aW1lbXM6IHt0eXBlOiAndGltZScsIGlzOiAndW5pZm9ybSd9XG4gIH0sXG5cbiAgdmVydGV4U2hhZGVyOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdXZzLnh5ID0gdXYueHk7XG4gICAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XG4gICAgfVxuICBgLFxuXG4gIGZyYWdtZW50U2hhZGVyOiBgXG4gICAgdW5pZm9ybSBmbG9hdCBzdGFydFRpbWU7XG4gICAgdW5pZm9ybSBmbG9hdCB0aW1lbXM7XG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG5cbiAgICAjZGVmaW5lIENPTE9SIHZlYzMoMCwgMC42NywgMC45OClcblxuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIGZsb2F0IHRpbWUgPSAodGltZW1zIC0gc3RhcnRUaW1lKSAvIDIwMDAuMDtcbiAgICAgIHZlYzIgcCA9IHV2cy54eSAtIDAuNTtcbiAgICAgIGZsb2F0IHIgPSBwLnggKiBwLnggKyBwLnkgKiBwLnk7XG4gICAgICBmbG9hdCBhbHBoYSA9IDEuMCAtIHNtb290aHN0ZXAodGltZSAtIDAuMDEsIHRpbWUsIHIpO1xuICAgICAgYWxwaGEgKj0gc21vb3Roc3RlcCh0aW1lIC0gMC4xLCB0aW1lLCByKTtcbiAgICAgIGFscGhhICo9IDEuMCAtIHRpbWUgKiA1LjU7XG4gICAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KENPTE9SLCBhbHBoYSk7XG4gICAgfVxuICBgXG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3N1cGVyY3V0Zngtc2hhZGVyLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzdXBlcmN1dGZ4Jywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zdGFydFRpbWUgPSAtMTEwMDsgLy8gcGF1c2Ugb24gZmlyc3QgdGlja1xuICB9LFxuXG4gIGNyZWF0ZVN1cGVyQ3V0OiBmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICBjb25zdCBtZXNoID0gdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpO1xuICAgIHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24uY29weShwb3NpdGlvbik7XG4gICAgdGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbi56ID0gLTE7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcblxuICAgIHRoaXMuc3RhcnRUaW1lID0gdGhpcy5lbC5zY2VuZUVsLnRpbWU7XG4gICAgbWVzaC5tYXRlcmlhbC51bmlmb3Jtcy5zdGFydFRpbWUudmFsdWUgPSB0aGlzLnN0YXJ0VGltZSAtIDUwO1xuICAgIHRoaXMuZWwucGxheSgpO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lKSB7XG4gICAgaWYgKHRpbWUgPiB0aGlzLnN0YXJ0VGltZSArIDEwMDApIHtcbiAgICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgdGhpcy5lbC5wYXVzZSgpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zdXBlcmN1dGZ4LmpzIiwiLyoqXG4gKiBBbmltYXRlIHRleHQgbnVtYmVyIHZhbHVlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3RleHQtY291bnRlcicsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ3RleHQnXSxcblxuICBzY2hlbWE6IHtcbiAgICBkZWNpbWFsczoge2RlZmF1bHQ6IDB9LFxuICAgIGR1cjoge2RlZmF1bHQ6IDIwMDAsIHR5cGU6ICdpbnQnfSxcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGVtaXQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgcHJlZml4OiB7ZGVmYXVsdDogJyd9LFxuICAgIHN1ZmZpeDoge2RlZmF1bHQ6ICcnfSxcbiAgICB2YWx1ZToge2RlZmF1bHQ6IDAuMCwgdHlwZTogJ2Zsb2F0J31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5jdXJyZW50VmFsdWUgPSAwO1xuICAgIHRoaXMuaGFzQ29tcGxldGVkID0gZmFsc2U7XG4gICAgdGhpcy50ZXh0VmFsdWUgPSB7dmFsdWUgOiAnJ307XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gMDtcbiAgICB0aGlzLnRleHRWYWx1ZS52YWx1ZSA9IGAke3RoaXMuZGF0YS5wcmVmaXh9JHt0aGlzLmRlY2ltYWxzKDApfSR7dGhpcy5kYXRhLnN1ZmZpeH1gO1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCd0ZXh0JywgdGhpcy50ZXh0VmFsdWUpO1xuICAgIHRoaXMuaGFzQ29tcGxldGVkID0gZmFsc2U7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUsIHRpbWVEZWx0YSkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQgfHwgdGhpcy5oYXNDb21wbGV0ZWQpIHsgcmV0dXJuOyB9XG5cbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSArPSB0aGlzLmRhdGEudmFsdWUgKiAodGltZURlbHRhIC8gdGhpcy5kYXRhLmR1cik7XG5cbiAgICBpZiAodGhpcy5jdXJyZW50VmFsdWUgPj0gdGhpcy5kYXRhLnZhbHVlKSB7XG4gICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHRoaXMuZGF0YS52YWx1ZTtcbiAgICAgIGlmICh0aGlzLmRhdGEuZW1pdCkgeyB0aGlzLmVsLmVtaXQoJ3RleHRjb3VudGVyZG9uZScsIG51bGwsIGZhbHNlKTsgfVxuICAgICAgdGhpcy5oYXNDb21wbGV0ZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIHRoaXMudGV4dFZhbHVlLnZhbHVlID1cbiAgICAgIGAke3RoaXMuZGF0YS5wcmVmaXh9JHt0aGlzLmRlY2ltYWxzKHRoaXMuY3VycmVudFZhbHVlKX0ke3RoaXMuZGF0YS5zdWZmaXh9YDtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgndGV4dCcsIHRoaXMudGV4dFZhbHVlKTtcbiAgfSxcblxuICBkZWNpbWFsczogZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZCA9IE1hdGgucG93KDEwLCB0aGlzLmRhdGEuZGVjaW1hbHMpO1xuICAgIHJldHVybiAocGFyc2VJbnQobiAqIGQpIC8gZCkudG9GaXhlZCh0aGlzLmRhdGEuZGVjaW1hbHMpO1xuICB9XG59KVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdGV4dC1jb3VudGVyLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd0ZXh0LXVwcGVyY2FzZScsIHtcbiAgc2NoZW1hOiB7XG4gICAgdmFsdWU6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgndGV4dCcsICd2YWx1ZScsIHRoaXMuZGF0YS52YWx1ZS50b1VwcGVyQ2FzZSgpKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy90ZXh0LXVwcGVyY2FzZS5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndG9nZ2xlLXBhdXNlLXBsYXknLCB7XG4gIHNjaGVtYToge1xuICAgIGlzUGxheWluZzogeyBkZWZhdWx0OiBmYWxzZSB9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgYWN0aW9uID0gdGhpcy5kYXRhLmlzUGxheWluZyA/ICdwYXVzZScgOiAncGxheSc7XG4gICAgcGFyZW50LnBvc3RNZXNzYWdlKEpTT04uc3RyaW5naWZ5KHsgdmVyaWZ5OiAnZ2FtZS1hY3Rpb24nLCBhY3Rpb24gfSksICcqJyk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdG9nZ2xlLXBhdXNlLXBsYXkuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3RyYWlsJywge1xuICBzY2hlbWE6IHtcbiAgICBjb2xvcjoge3R5cGU6ICdjb2xvcid9LFxuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaGFuZDoge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZ2VvbWV0cnkgPSB0aGlzLmdlb21ldHJ5ID0gbmV3IFRIUkVFLkJ1ZmZlckdlb21ldHJ5KCk7XG4gICAgdmFyIG1heFBvaW50cyA9IHRoaXMubWF4UG9pbnRzID0gMTI7XG4gICAgdmFyIHZlcnRpY2VzID0gdGhpcy52ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkoMzYgKiBtYXhQb2ludHMpO1xuICAgIHZhciBjb2xvcnMgPSB0aGlzLmNvbG9ycyA9IG5ldyBGbG9hdDMyQXJyYXkoNDggKiBtYXhQb2ludHMpO1xuICAgIHZhciBibGFkZUNvbG9yID0gdGhpcy5ibGFkZUNvbG9yID0gbmV3IFRIUkVFLkNvbG9yKHRoaXMuZGF0YS5jb2xvcik7XG5cbiAgICB0aGlzLmJsYWRlQ29sb3IgPSB7XG4gICAgICByZWQ6IGJsYWRlQ29sb3IucixcbiAgICAgIGdyZWVuOiBibGFkZUNvbG9yLmcsXG4gICAgICBibHVlOiBibGFkZUNvbG9yLmIsXG4gICAgICBhbHBoYTogMS4wXG4gICAgfTtcbiAgICB0aGlzLnNhYmVyRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5ibGFkZScpO1xuXG4gICAgdGhpcy5sYXllcnMgPSAwO1xuICAgIHRoaXMuc2FiZXJUcmFqZWN0b3J5ID0gW1xuICAgICAge3RvcDogbmV3IFRIUkVFLlZlY3RvcjMoLTAuNSwgMCwgMCksIGNlbnRlcjogbmV3IFRIUkVFLlZlY3RvcjMoMCwgMCwgMCksIGJvdHRvbTogbmV3IFRIUkVFLlZlY3RvcjMoMC41LCAwLCAwKX0sXG4gICAgICB7dG9wOiBuZXcgVEhSRUUuVmVjdG9yMygtMC41LCAwLjUsIDApLCBjZW50ZXI6IG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAuNSwgMCksIGJvdHRvbTogbmV3IFRIUkVFLlZlY3RvcjMoMC41LCAwLjUsIDApfSxcbiAgICAgIHt0b3A6IG5ldyBUSFJFRS5WZWN0b3IzKC0wLjUsIDEuMCwgMCksIGNlbnRlcjogbmV3IFRIUkVFLlZlY3RvcjMoMCwgMS4wLCAwKSwgYm90dG9tOiBuZXcgVEhSRUUuVmVjdG9yMygwLjUsIDEuMCwgMCl9XG4gICAgXTtcblxuICAgIGdlb21ldHJ5LmFkZEF0dHJpYnV0ZSgncG9zaXRpb24nLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKHZlcnRpY2VzLCAzKS5zZXREeW5hbWljKHRydWUpKTtcbiAgICBnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoJ3ZlcnRleENvbG9yJywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZShjb2xvcnMsIDQpLnNldER5bmFtaWModHJ1ZSkpO1xuXG4gICAgY29uc3QgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoe1xuICAgICAgc2lkZTogVEhSRUUuRG91YmxlU2lkZSxcbiAgICAgIHZlcnRleENvbG9yczogVEhSRUUuVmVydGV4Q29sb3JzLFxuICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICBibGVuZGluZzogVEhSRUUuQWRkaXRpdmVCbGVuZGluZyxcbiAgICAgIHZlcnRleFNoYWRlcjogW1xuICAgICAgICAndmFyeWluZyB2ZWM0IHZDb2xvcjsnLFxuICAgICAgICAnYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7JyxcbiAgICAgICAgJ3ZvaWQgbWFpbigpIHsnLFxuICAgICAgICAndmVjNCBtb2RlbFZpZXdQb3NpdGlvbiA9IG1vZGVsVmlld01hdHJpeCAqIHZlYzQocG9zaXRpb24sIDEuMCk7JyxcbiAgICAgICAgJ3ZDb2xvciA9IHZlcnRleENvbG9yOycsXG4gICAgICAgICdnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdQb3NpdGlvbjsnLFxuICAgICAgICAnfSdcbiAgICAgIF0uam9pbignJyksXG4gICAgICBmcmFnbWVudFNoYWRlcjogW1xuICAgICAgICAndmFyeWluZyB2ZWM0IHZDb2xvcjsnLFxuICAgICAgICAndm9pZCBtYWluKCkgeycsXG4gICAgICAgICdnbF9GcmFnQ29sb3IgPSB2Q29sb3I7JyxcbiAgICAgICAgJ30nXG4gICAgICBdLmpvaW4oJycpXG4gICAgfSk7XG5cbiAgICBjb25zdCBtZXNoID0gdGhpcy5tZXNoID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcbiAgICBtZXNoLmZydXN0dW1DdWxsZWQgPSBmYWxzZTtcbiAgICBtZXNoLnZlcnRpY2VzID0gdmVydGljZXM7XG4gICAgdGhpcy5lbC5zY2VuZUVsLnNldE9iamVjdDNEKGB0cmFpbF9fJHt0aGlzLmRhdGEuaGFuZH1gLCBtZXNoKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgaWYgKCFvbGREYXRhLmVuYWJsZWQgJiYgdGhpcy5kYXRhLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuZW5hYmxlZFRpbWUgPSB0aGlzLmVsLnNjZW5lRWwudGltZTtcbiAgICAgIHRoaXMubWVzaC52aXNpYmxlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKG9sZERhdGEuZW5hYmxlZCAmJiAhdGhpcy5kYXRhLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMubWVzaC52aXNpYmxlID0gZmFsc2U7XG4gICAgfVxuICB9LFxuXG4gIHRvY2s6IGZ1bmN0aW9uICh0aW1lLCBkZWx0YSkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgLy8gRGVsYXkgYmVmb3JlIHNob3dpbmcgYWZ0ZXIgZW5hYmxlZCB0byBwcmV2ZW50IGZsYXNoIGZyb20gb2xkIHNhYmVyIHBvc2l0aW9uLlxuICAgIGlmICghdGhpcy5tZXNoLnZpc2libGUgJiYgdGltZSA+IHRoaXMuZW5hYmxlZFRpbWUgKyAyNTApIHsgdGhpcy5tZXNoLnZpc2libGUgPSB0cnVlOyB9XG4gICAgdGhpcy5zYW1wbGVTYWJlclBvc2l0aW9uKCk7XG4gIH0sXG5cbiAgYWRkTGF5ZXI6IGZ1bmN0aW9uIChsZW5ndGgpIHtcbiAgICB2YXIgc3RhcnRYID0gLTEuMDtcbiAgICB2YXIgc2VnbWVudHMgPSB0aGlzLnNlZ21lbnRzO1xuICAgIHZhciBkeCA9IDIgLyBzZWdtZW50cztcbiAgICB2YXIgY29sb3JzID0gdGhpcy5jb2xvcnM7XG4gICAgdmFyIHZlcnRpY2VzID0gdGhpcy52ZXJ0aWNlcztcbiAgICB2YXIgY29sb3IgPSB0aGlzLmJsYWRlQ29sb3I7XG5cbiAgICBpZiAodGhpcy5sYXllcnMgPj0gdGhpcy5tYXhMYXllcnMpIHsgdGhpcy5sYXllcnMgPSAwOyB9XG5cbiAgICBjb25zdCBib3R0b21MYXllciA9IHRoaXMubGF5ZXJzICogbGVuZ3RoO1xuICAgIGxlbmd0aCA9IGJvdHRvbUxheWVyICsgbGVuZ3RoO1xuICAgIGNvbnN0IGluZGV4T2Zmc2V0ID0gdGhpcy5sYXllcnMgKiBzZWdtZW50cyAqIDE4O1xuICAgIGNvbnN0IGNvbG9yT2Zmc2V0ID0gdGhpcy5sYXllcnMgKiBzZWdtZW50cyAqIDI0O1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWdtZW50czsgKytpKSB7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaV0gPSBzdGFydFggKyBpICogZHg7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDFdID0gYm90dG9tTGF5ZXI7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDJdID0gMC4wO1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpXSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDFdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAyXSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAzXSA9IGNvbG9yLmFscGhhO1xuXG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDNdID0gc3RhcnRYICsgaSAqIGR4O1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyA0XSA9IGxlbmd0aDtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgNV0gPSAwLjA7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyA0XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDVdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyA2XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyA3XSA9IGNvbG9yLmFscGhhO1xuXG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDZdID0gc3RhcnRYICsgaSAqIGR4ICsgZHg7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDddID0gbGVuZ3RoO1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyA4XSA9IDAuMDtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDhdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgOV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDEwXSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxMV0gPSBjb2xvci5hbHBoYTtcblxuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyA5XSA9IHN0YXJ0WCArIGkgKiBkeCArIGR4O1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAxMF0gPSBib3R0b21MYXllcjtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMTFdID0gMC4wO1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMTJdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMTNdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxNF0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMTVdID0gY29sb3IuYWxwaGE7XG5cbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMTJdID0gc3RhcnRYICsgaSAqIGR4O1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAxM10gPSBib3R0b21MYXllcjtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMTRdID0gMC4wO1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMTZdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMTddID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxOF0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMTldID0gY29sb3IuYWxwaGE7XG5cbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMTVdID0gc3RhcnRYICsgaSAqIGR4ICsgZHg7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDE2XSA9IGxlbmd0aDtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMTddID0gMC4wO1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMjBdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMjFdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAyMl0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMjNdID0gY29sb3IuYWxwaGE7XG4gICAgfVxuXG4gICAgdGhpcy5sYXllcnMrKztcbiAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy52ZXJ0ZXhDb2xvci5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnV2Lm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgfSxcblxuICBpbml0R2VvbWV0cnk6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaTtcbiAgICB2YXIgcHJldmlvdXNQb2ludDtcbiAgICB2YXIgY3VycmVudFBvaW50O1xuICAgIHZhciBzYWJlclRyYWplY3RvcnkgPSB0aGlzLnNhYmVyVHJhamVjdG9yeTtcbiAgICB2YXIgdmVydGljZXMgPSB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXk7XG4gICAgdmFyIGNvbG9ycyA9IHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy52ZXJ0ZXhDb2xvci5hcnJheTtcbiAgICB2YXIgY29sb3IgPSB0aGlzLmJsYWRlQ29sb3I7XG4gICAgdmFyIGFscGhhO1xuICAgIHZhciBwcmV2aW91c0FscGhhO1xuXG4gICAgZm9yIChpID0gMTsgaSA8IHNhYmVyVHJhamVjdG9yeS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGkgPT09IDEpIHsgcHJldmlvdXNBbHBoYSA9IGFscGhhOyB9XG4gICAgICBhbHBoYSA9IDEuMCAtICgoc2FiZXJUcmFqZWN0b3J5Lmxlbmd0aCAtIGkpIC8gc2FiZXJUcmFqZWN0b3J5Lmxlbmd0aCk7XG5cbiAgICAgIGN1cnJlbnRQb2ludCA9IHNhYmVyVHJhamVjdG9yeVtpXTtcbiAgICAgIHByZXZpb3VzUG9pbnQgPSBzYWJlclRyYWplY3RvcnlbaSAtIDFdO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGldID0gcHJldmlvdXNQb2ludC5jZW50ZXIueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDFdID0gcHJldmlvdXNQb2ludC5jZW50ZXIueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDJdID0gcHJldmlvdXNQb2ludC5jZW50ZXIuejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGldID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDFdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgMl0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDNdID0gcHJldmlvdXNBbHBoYSAqIDAuMjtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgM10gPSBjdXJyZW50UG9pbnQudG9wLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyA0XSA9IGN1cnJlbnRQb2ludC50b3AueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDVdID0gY3VycmVudFBvaW50LnRvcC56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDRdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDVdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgNl0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDddID0gYWxwaGE7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDZdID0gcHJldmlvdXNQb2ludC50b3AueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDddID0gcHJldmlvdXNQb2ludC50b3AueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDhdID0gcHJldmlvdXNQb2ludC50b3AuejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA4XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA5XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDEwXSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMTFdID0gcHJldmlvdXNBbHBoYTtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgOV0gPSBwcmV2aW91c1BvaW50LmNlbnRlci54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMTBdID0gcHJldmlvdXNQb2ludC5jZW50ZXIueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDExXSA9IHByZXZpb3VzUG9pbnQuY2VudGVyLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgMTJdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDEzXSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDE0XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMTVdID0gcHJldmlvdXNBbHBoYSAqIDAuMjtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgMTJdID0gY3VycmVudFBvaW50LmNlbnRlci54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMTNdID0gY3VycmVudFBvaW50LmNlbnRlci55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMTRdID0gY3VycmVudFBvaW50LmNlbnRlci56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDE2XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxN10gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxOF0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDE5XSA9IGFscGhhICogMC4yO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxNV0gPSBjdXJyZW50UG9pbnQudG9wLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxNl0gPSBjdXJyZW50UG9pbnQudG9wLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxN10gPSBjdXJyZW50UG9pbnQudG9wLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgMjBdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDIxXSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDIyXSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMjNdID0gYWxwaGE7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDE4XSA9IHByZXZpb3VzUG9pbnQuYm90dG9tLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxOV0gPSBwcmV2aW91c1BvaW50LmJvdHRvbS55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjBdID0gcHJldmlvdXNQb2ludC5ib3R0b20uejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyNF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMjVdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgMjZdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyN10gPSAwLjA7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDIxXSA9IGN1cnJlbnRQb2ludC5jZW50ZXIueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDIyXSA9IGN1cnJlbnRQb2ludC5jZW50ZXIueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDIzXSA9IGN1cnJlbnRQb2ludC5jZW50ZXIuejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyOF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMjldID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgMzBdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzMV0gPSBhbHBoYSAqIDAuMjtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjRdID0gcHJldmlvdXNQb2ludC5jZW50ZXIueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDI1XSA9IHByZXZpb3VzUG9pbnQuY2VudGVyLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyNl0gPSBwcmV2aW91c1BvaW50LmNlbnRlci56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDMyXSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzM10gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzNF0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDM1XSA9IHByZXZpb3VzQWxwaGEgKiAwLjI7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDI3XSA9IHByZXZpb3VzUG9pbnQuYm90dG9tLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyOF0gPSBwcmV2aW91c1BvaW50LmJvdHRvbS55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjldID0gcHJldmlvdXNQb2ludC5ib3R0b20uejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzNl0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMzddID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgMzhdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzOV0gPSAwLjA7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDMwXSA9IGN1cnJlbnRQb2ludC5ib3R0b20ueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDMxXSA9IGN1cnJlbnRQb2ludC5ib3R0b20ueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDMyXSA9IGN1cnJlbnRQb2ludC5ib3R0b20uejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA0MF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgNDFdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgNDJdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA0M10gPSAwLjA7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDMzXSA9IGN1cnJlbnRQb2ludC5jZW50ZXIueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDM0XSA9IGN1cnJlbnRQb2ludC5jZW50ZXIueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDM1XSA9IGN1cnJlbnRQb2ludC5jZW50ZXIuejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA0NF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgNDVdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgNDZdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA0N10gPSBhbHBoYSAqIDAuMjtcblxuICAgICAgcHJldmlvdXNBbHBoYSA9IGFscGhhO1xuICAgIH1cblxuICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnZlcnRleENvbG9yLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgfSxcblxuICBzYW1wbGVTYWJlclBvc2l0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNhYmVyRWwgPSB0aGlzLnNhYmVyRWw7XG4gICAgdmFyIHNhYmVyT2JqZWN0O1xuICAgIHZhciBzYW1wbGU7XG5cbiAgICBpZiAodGhpcy5zYWJlclRyYWplY3RvcnkubGVuZ3RoID09PSB0aGlzLm1heFBvaW50cykge1xuICAgICAgLy8gRHVtcCBvbGRlc3QgcG9pbnQuXG4gICAgICBzYW1wbGUgPSB0aGlzLnNhYmVyVHJhamVjdG9yeS5zaGlmdCgpO1xuICAgICAgc2FtcGxlLnRvcC5zZXQoMCwgLTAuNCwgMCk7XG4gICAgICBzYW1wbGUuY2VudGVyLnNldCgwLCAwLCAwKTtcbiAgICAgIHNhbXBsZS5ib3R0b20uc2V0KDAsIDAuNCwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNhbXBsZSA9IHtcbiAgICAgICAgdG9wOiBuZXcgVEhSRUUuVmVjdG9yMygwLCAtMC40LCAwKSxcbiAgICAgICAgY2VudGVyOiBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAwKSxcbiAgICAgICAgYm90dG9tOiBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLjQsIDApXG4gICAgICB9O1xuICAgIH1cblxuICAgIHNhYmVyT2JqZWN0ID0gc2FiZXJFbC5vYmplY3QzRDtcblxuICAgIHNhYmVyT2JqZWN0LnBhcmVudC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgIHNhYmVyT2JqZWN0LmxvY2FsVG9Xb3JsZChzYW1wbGUudG9wKTtcbiAgICBzYWJlck9iamVjdC5sb2NhbFRvV29ybGQoc2FtcGxlLmNlbnRlcik7XG4gICAgc2FiZXJPYmplY3QubG9jYWxUb1dvcmxkKHNhbXBsZS5ib3R0b20pO1xuXG4gICAgdGhpcy5zYWJlclRyYWplY3RvcnkucHVzaChzYW1wbGUpO1xuXG4gICAgdGhpcy5pbml0R2VvbWV0cnkoKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy90cmFpbC5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndHV0b3JpYWwtMmQnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnNjZW5lRWwuY2FudmFzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuc2NlbmVFbC5jYW52YXMuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsMmQnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3R1dG9yaWFsLTJkLmpzIiwiY29uc3QgTlVNX1ZBTFVFU19QRVJfU0VHTUVOVCA9IDc1O1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3R3aXN0ZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgdHdpc3Q6IHtkZWZhdWx0OiAwfSxcbiAgICB2ZXJ0aWNlczoge2RlZmF1bHQ6IDQsIHR5cGU6ICdpbnQnfSxcbiAgICBjb3VudDoge2RlZmF1bHQ6IDEyLCB0eXBlOiAnaW50J30sXG4gICAgcG9zaXRpb25JbmNyZW1lbnQ6IHtkZWZhdWx0OiAxLjR9LFxuICAgIHJhZGl1c0luY3JlbWVudDoge2RlZmF1bHQ6IDAuNDB9LFxuICAgIHRoaWNrbmVzczoge2RlZmF1bHQ6IDAuMzd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY3VycmVudFR3aXN0ID0gMDtcbiAgICB0aGlzLmFuaW1hdGUgPSBmYWxzZTtcbiAgICB0aGlzLmdlb21ldHJ5ID0gbnVsbDtcbiAgfSxcblxuICBwdWxzZTogZnVuY3Rpb24gKHR3aXN0KSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cbiAgICBpZiAodHdpc3QgPT0gMCkgeyB0d2lzdCA9IDAuMDMgKyBNYXRoLnJhbmRvbSgpICogMC4yNTsgfVxuICAgIGVsc2UgdHdpc3QgPSBNYXRoLm1pbih0d2lzdCAqIDAuNCwgMC40KTtcbiAgICB0d2lzdCAqPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gLTEgOiAxOyAvLyByYW5kb20gZGlyZWN0aW9uXG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3R3aXN0ZXInLCB7dHdpc3Q6IHR3aXN0fSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHZhciByYWRpdXMgPSA2O1xuICAgIHZhciBzZWdtZW50cyA9IFtdO1xuXG4gICAgaWYgKE1hdGguYWJzKHRoaXMuZGF0YS50d2lzdCAtIHRoaXMuY3VycmVudFR3aXN0KSA+IDAuMDAxKSB7XG4gICAgICB0aGlzLmFuaW1hdGUgPSB0cnVlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuY2xlYXIoKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5kYXRhLmNvdW50OyBpKyspIHtcbiAgICAgIGxldCBzZWdtZW50ID0gdGhpcy5jcmVhdGVTZWdtZW50KHJhZGl1cyk7XG4gICAgICBzZWdtZW50LnRyYW5zbGF0ZSgwLCB0aGlzLmRhdGEucG9zaXRpb25JbmNyZW1lbnQgKiBpLCAwKTtcbiAgICAgIHNlZ21lbnRzLnB1c2goc2VnbWVudCk7XG4gICAgICByYWRpdXMgKz0gdGhpcy5kYXRhLnJhZGl1c0luY3JlbWVudDtcbiAgICB9XG4gICAgdGhpcy5nZW9tZXRyeSA9IFRIUkVFLkJ1ZmZlckdlb21ldHJ5VXRpbHMubWVyZ2VCdWZmZXJHZW9tZXRyaWVzKHNlZ21lbnRzKTtcbiAgICB2YXIgbWF0ZXJpYWwgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbHMuc3RhZ2VOb3JtYWw7XG4gICAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCh0aGlzLmdlb21ldHJ5LCBtYXRlcmlhbCk7XG4gICAgdGhpcy5lbC5vYmplY3QzRC5hZGQobWVzaCk7XG4gIH0sXG5cbiAgY3JlYXRlU2VnbWVudDogZnVuY3Rpb24gKHJhZGl1cykge1xuICAgIGNvbnN0IFIgPSB0aGlzLmRhdGEudGhpY2tuZXNzO1xuICAgIHZhciBnZW9tZXRyeTtcbiAgICB2YXIgcG9pbnRzID0gW1xuICAgICAgbmV3IFRIUkVFLlZlY3RvcjIocmFkaXVzIC0gUiwgUiksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMihyYWRpdXMgLSBSLCAtUiksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMihyYWRpdXMgKyBSLCAtUiksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMihyYWRpdXMgKyBSLCBSKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IyKHJhZGl1cyAtIFIsIFIpXG4gICAgXTtcbiAgICBnZW9tZXRyeSA9IG5ldyBUSFJFRS5MYXRoZUJ1ZmZlckdlb21ldHJ5KHBvaW50cywgdGhpcy5kYXRhLnZlcnRpY2VzKTtcbiAgICAvLyBtb3ZlIHV2cyB0byBhIHNwZWNpZmljIHBvaW50IGluIGF0bGFzLnBuZ1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2VvbWV0cnkuYXR0cmlidXRlcy51di5hcnJheS5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgZ2VvbWV0cnkuYXR0cmlidXRlcy51di5hcnJheVtpXSA9IDAuNzc7XG4gICAgICBnZW9tZXRyeS5hdHRyaWJ1dGVzLnV2LmFycmF5W2kgKyAxXSA9IDAuMDAxO1xuICAgIH1cbiAgICByZXR1cm4gZ2VvbWV0cnk7XG4gIH0sXG5cbiAgY2xlYXI6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnJlbW92ZSh0aGlzLmVsLm9iamVjdDNELmNoaWxkcmVuWzBdKTtcbiAgICBpZiAodGhpcy5nZW9tZXRyeSkgdGhpcy5nZW9tZXRyeS5kaXNwb3NlKCk7XG4gICAgdGhpcy5nZW9tZXRyeSA9IG5ldyBUSFJFRS5CdWZmZXJHZW9tZXRyeSgpO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lLCBkZWx0YSkge1xuICAgIGlmICghdGhpcy5hbmltYXRlKSB7IHJldHVybjsgfVxuXG4gICAgdmFyIHBvc0FycmF5ID0gdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5O1xuICAgIHZhciByb3RhdGlvbjtcbiAgICB2YXIgeCwgeTtcbiAgICB2YXIgc2luLCBjb3M7XG4gICAgdmFyIGRpZmY7XG5cbiAgICBkZWx0YSAqPSAwLjAwMTtcblxuICAgIGRpZmYgPSAodGhpcy5kYXRhLnR3aXN0IC0gdGhpcy5jdXJyZW50VHdpc3QpICogZGVsdGE7XG5cbiAgICB0aGlzLmN1cnJlbnRUd2lzdCArPSBkaWZmO1xuICAgIHJvdGF0aW9uID0gZGlmZiAqIDMuMDtcblxuICAgIGZvciAodmFyIHMgPSAwOyBzIDwgdGhpcy5kYXRhLmNvdW50OyBzKyspIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTlVNX1ZBTFVFU19QRVJfU0VHTUVOVDsgaSArPSAzKSB7XG4gICAgICAgIGNvcyA9IE1hdGguY29zKHJvdGF0aW9uKTtcbiAgICAgICAgc2luID0gTWF0aC5zaW4ocm90YXRpb24pO1xuICAgICAgICB4ID0gcG9zQXJyYXlbcyAqIE5VTV9WQUxVRVNfUEVSX1NFR01FTlQgKyBpXTtcbiAgICAgICAgeSA9IHBvc0FycmF5W3MgKiBOVU1fVkFMVUVTX1BFUl9TRUdNRU5UICsgaSArIDJdO1xuICAgICAgICBwb3NBcnJheVtzICogTlVNX1ZBTFVFU19QRVJfU0VHTUVOVCArIGldID0geCAqIGNvcyAtIHkgKiBzaW47XG4gICAgICAgIHBvc0FycmF5W3MgKiBOVU1fVkFMVUVTX1BFUl9TRUdNRU5UICsgaSArIDJdID0geSAqIGNvcyArIHggKiBzaW47XG4gICAgICB9XG4gICAgICByb3RhdGlvbiAqPSAxLjA1O1xuICAgIH1cbiAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xuXG4gICAgaWYgKE1hdGguYWJzKHRoaXMuZGF0YS50d2lzdCAtIHRoaXMuY3VycmVudFR3aXN0KSA8IDAuMDAxKXtcbiAgICAgIHRoaXMuYW5pbWF0ZSA9IGZhbHNlO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy90d2lzdGVyLmpzIiwidmFyIGNvbG9ySGVscGVyID0gbmV3IFRIUkVFLkNvbG9yKCk7XG5cbi8qKlxuICogU2V0IGdlb21ldHJ5IHZlcnRleCBjb2xvcnMsIGFsbG93cyBmb3IgZ2VvbWV0cnkgbWVyZ2luZyB1c2luZyBvbmUgbWF0ZXJpYWxcbiAqIHdoaWxlIHJldGFpbmluZyBjb2xvcnMuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndmVydGV4LWNvbG9ycy1idWZmZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGJhc2VDb2xvcjoge3R5cGU6ICdjb2xvcid9LFxuICAgIGl0ZW1TaXplOiB7ZGVmYXVsdDogM31cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGNvbG9ycztcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgaTtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBnZW9tZXRyeTtcbiAgICB2YXIgbWVzaDtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICBtZXNoID0gdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpO1xuXG4gICAgaWYgKCFtZXNoIHx8ICFtZXNoLmdlb21ldHJ5KSB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdvYmplY3QzZHNldCcsIGZ1bmN0aW9uIHJlVXBkYXRlIChldnQpIHtcbiAgICAgICAgaWYgKGV2dC5kZXRhaWwudHlwZSAhPT0gJ21lc2gnKSB7IHJldHVybjsgfVxuICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdvYmplY3QzZHNldCcsIHJlVXBkYXRlKTtcbiAgICAgICAgc2VsZi51cGRhdGUob2xkRGF0YSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBnZW9tZXRyeSA9IG1lc2guZ2VvbWV0cnk7XG5cbiAgICAvLyBFbXB0eSBnZW9tZXRyeS5cbiAgICBpZiAoIWdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24pIHtcbiAgICAgIGNvbnNvbGUud2FybignR2VvbWV0cnkgaGFzIG5vIHZlcnRpY2VzJywgZWwpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghZ2VvbWV0cnkuYXR0cmlidXRlcy5jb2xvcikge1xuICAgICAgZ2VvbWV0cnkuYWRkQXR0cmlidXRlKCdjb2xvcicsXG4gICAgICAgIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoXG4gICAgICAgICAgbmV3IEZsb2F0MzJBcnJheShnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5Lmxlbmd0aCksIDNcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb2xvcnMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzLmNvbG9yLmFycmF5O1xuXG4gICAgLy8gVE9ETzogRm9yIHNvbWUgcmVhc29uLCBpbmNyZW1lbnRpbmcgbG9vcCBieSAzIGRvZXNuJ3Qgd29yay4gTmVlZCB0byBkbyBieSA0IGZvciBnbFRGLlxuICAgIGNvbG9ySGVscGVyLnNldChkYXRhLmJhc2VDb2xvcik7XG4gICAgZm9yIChpID0gMDsgaSA8IGNvbG9ycy5sZW5ndGg7IGkgKz0gZGF0YS5pdGVtU2l6ZSkge1xuICAgICAgY29sb3JzW2ldID0gY29sb3JIZWxwZXIucjtcbiAgICAgIGNvbG9yc1tpICsgMV0gPSBjb2xvckhlbHBlci5nO1xuICAgICAgY29sb3JzW2kgKyAyXSA9IGNvbG9ySGVscGVyLmI7XG4gICAgfVxuXG4gICAgZ2VvbWV0cnkuYXR0cmlidXRlcy5jb2xvci5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdmVydGV4LWNvbG9ycy1idWZmZXIuanMiLCIvKipcbiAqIFRyaWdnZXIgYWNjdXJhY3kgcmluZyBhbmltYXRpb24gb24gdmljdG9yeSBzY3JlZW4uXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndmljdG9yeS1hY2N1cmFjeS1yaW5nJywge1xuICBkZXBlbmRlbmNpZXM6IFsnZ2VvbWV0cnknLCAnbWF0ZXJpYWwnXSxcblxuICBzY2hlbWE6IHtcbiAgICBhY2N1cmFjeToge2RlZmF1bHQ6IDB9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLnVuaWZvcm1zLnByb2dyZXNzLnZhbHVlID0gMDtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnYW5pbWF0aW9uJywgJ3RvJywgdGhpcy5kYXRhLmFjY3VyYWN5IC8gMTAwKTtcbiAgICB0aGlzLmVsLmNvbXBvbmVudHNbJ2FuaW1hdGlvbiddLmJlZ2luQW5pbWF0aW9uKCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdmljdG9yeS1hY2N1cmFjeS1yaW5nLmpzIiwiLyoqXG4gKiBSYW5rIGNvbG9yLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3ZpY3RvcnktcmFuaycsIHtcbiAgc2NoZW1hOiB7XG4gICAgcmFuazoge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHJhbmsgPSB0aGlzLmRhdGEucmFuaztcbiAgICBpZiAoIXJhbmspIHsgcmV0dXJuOyB9XG5cbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgndGV4dCcsICd2YWx1ZScsIHJhbmspO1xuICAgIHN3aXRjaCAocmFua1swXSkge1xuICAgICAgY2FzZSAnUyc6IHtcbiAgICAgICAgdGhpcy5zZXRDb2xvcignI0ZGRicpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ0EnOiB7XG4gICAgICAgIHRoaXMuc2V0Q29sb3IoJyNjMmQwNzYnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdCJzoge1xuICAgICAgICB0aGlzLnNldENvbG9yKCcjMjNmMGM3Jyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnQyc6IHtcbiAgICAgICAgdGhpcy5zZXRDb2xvcignI2ZmZTM0NycpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ0QnOiB7XG4gICAgICAgIHRoaXMuc2V0Q29sb3IoJyNjZTZjNDcnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdGJzoge1xuICAgICAgICB0aGlzLnNldENvbG9yKCcjOTYwMjAwJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBzZXRDb2xvcjogZnVuY3Rpb24gKGNvbG9yKSB7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCAnY29sb3InLCBjb2xvcik7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdmljdG9yeS1yYW5rLmpzIiwiLyoqXG4gKiBDb3VwbGUgdmlzaWJpbGl0eSBhbmQgcmF5Y2FzdGFiaWxpdHkuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndmlzaWJsZS1yYXljYXN0YWJsZScsIHtcbiAgc2NoZW1hOiB7XG4gICAgZGVmYXVsdDogdHJ1ZVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IHRoaXMuZGF0YTtcbiAgICBpZiAodGhpcy5kYXRhKSB7XG4gICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgncmF5Y2FzdGFibGUnLCAnJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWwucmVtb3ZlQXR0cmlidXRlKCdyYXljYXN0YWJsZScsICcnKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdmlzaWJsZS1yYXljYXN0YWJsZS5qcyIsImNvbnN0IENPTE9SUyA9IHJlcXVpcmUoJy4uL2NvbnN0YW50cy9jb2xvcnMuanMnKTtcblxuY29uc3QgV0FMTF9DT0xPUiA9IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuTkVPTl9SRUQpO1xuY29uc3QgV0FMTF9CRyA9IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuU0tZX1JFRCk7XG5cblxuQUZSQU1FLnJlZ2lzdGVyU2hhZGVyKCd3YWxsU2hhZGVyJywge1xuICBzY2hlbWE6IHtcbiAgICBpVGltZToge3R5cGU6ICd0aW1lJywgaXM6ICd1bmlmb3JtJ30sXG4gICAgaGl0UmlnaHQ6IHt0eXBlOiAndmVjMycsIGlzOiAndW5pZm9ybScsIGRlZmF1bHQ6IHt4OiAwLCB5OiAxLCB6OiAwfX0sXG4gICAgaGl0TGVmdDoge3R5cGU6ICd2ZWMzJywgaXM6ICd1bmlmb3JtJywgZGVmYXVsdDoge3g6IDAsIHk6IDAsIHo6IDB9fVxuICB9LFxuXG4gIHZlcnRleFNoYWRlcjogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIG5ybWw7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHV2cy54eSA9IHV2Lnh5O1xuICAgICAgbnJtbC54eXogPSBub3JtYWwueHl6O1xuICAgICAgdmVjNCBwID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcbiAgICAgIHdvcmxkUG9zID0gKG1vZGVsTWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApKS54eXo7XG4gICAgICBnbF9Qb3NpdGlvbiA9IHA7XG4gICAgfVxuICBgLFxuXG4gIGZyYWdtZW50U2hhZGVyOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgbnJtbDtcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdW5pZm9ybSBmbG9hdCBpVGltZTtcbiAgICAvL3VuaWZvcm0gc2FtcGxlcjJEIGVudjtcbiAgICB1bmlmb3JtIHZlYzMgaGl0UmlnaHQ7XG4gICAgdW5pZm9ybSB2ZWMzIGhpdExlZnQ7XG5cbiAgICAjZGVmaW5lIFNFRUQgMTkuMTI1NFxuICAgICNkZWZpbmUgdGltZSAoMy4wICsgaVRpbWUpLzEwMDAuMCAqIDAuMTVcblxuICAgIGZsb2F0IG5vaXNlKHZlYzMgdXYpIHtcbiAgICAgIHJldHVybiBmcmFjdChzaW4odXYueCoxMjMyNDMuICsgdXYueSo0MjQuICsgdXYueio2NDIuICsgU0VFRCkgKiAxNTI0Lik7XG4gICAgfVxuXG4gICAgdmVjMyBkcmF3Q2lyY2xlKHZlYzMgcCwgdmVjMyBjZW50ZXIsIGZsb2F0IHJhZGl1cywgZmxvYXQgZWRnZVdpZHRoLCB2ZWMzIGNvbG9yKSB7XG4gICAgICByZXR1cm4gY29sb3IgKiAoMS4wIC0gc21vb3Roc3RlcChyYWRpdXMsIHJhZGl1cyArIGVkZ2VXaWR0aCwgbGVuZ3RoKHAgLSBjZW50ZXIpKSk7XG4gICAgfVxuXG4gICAgZmxvYXQgc21vb3RoTm9pc2UodmVjMyB1dncsIGZsb2F0IGZyZWMpe1xuICAgICAgdmVjMyBsdXZ3ID0gdmVjMyhzbW9vdGhzdGVwKDAuMCwgMS4wLCBmcmFjdCh1dncueHkgKiBmcmVjKSksIGZyYWN0KHV2dy56ICogZnJlYykpO1xuICAgICAgdmVjMyBpZCA9IGZsb29yKHV2dyAqIGZyZWMpO1xuICAgICAgZmxvYXQgYmx0ID0gbm9pc2UoaWQpO1xuICAgICAgZmxvYXQgYnJ0ID0gbm9pc2UoaWQgKyB2ZWMzKDEuMCwgMC4wLCAwLjApKTtcbiAgICAgIGZsb2F0IHRsdCA9IG5vaXNlKGlkICsgdmVjMygwLjAsIDEuMCwgMC4wKSk7XG4gICAgICBmbG9hdCB0cnQgPSBub2lzZShpZCArIHZlYzMoMS4wLCAxLjAsIDAuMCkpO1xuXG4gICAgICBmbG9hdCBibGIgPSBub2lzZShpZCArIHZlYzMoMC4wLCAwLjAsIDEuMCkpO1xuICAgICAgZmxvYXQgYnJiID0gbm9pc2UoaWQgKyB2ZWMzKDEuMCwgMC4wLCAxLjApKTtcbiAgICAgIGZsb2F0IHRsYiA9IG5vaXNlKGlkICsgdmVjMygwLjAsIDEuMCwgMS4wKSk7XG4gICAgICBmbG9hdCB0cmIgPSBub2lzZShpZCArIHZlYzMoMS4wLCAxLjAsIDEuMCkpO1xuXG4gICAgICBmbG9hdCBhID0gbWl4KGJsdCwgYnJ0LCBsdXZ3LngpO1xuICAgICAgZmxvYXQgYiA9IG1peCh0bHQsIHRydCwgbHV2dy54KTtcbiAgICAgIGZsb2F0IGMgPSBtaXgoYSwgYiwgbHV2dy55KTtcblxuICAgICAgZmxvYXQgZCA9IG1peChibGIsIGJyYiwgbHV2dy54KTtcbiAgICAgIGZsb2F0IGUgPSBtaXgodGxiLCB0cmIsIGx1dncueCk7XG4gICAgICBmbG9hdCBmID0gbWl4KGQsIGUsIGx1dncueSk7XG5cbiAgICAgIHJldHVybiBtaXgoYywgZiwgbHV2dy56KTtcbiAgICB9XG5cbiAgICAjZGVmaW5lIFdBTExfQ09MT1IgdmVjMygke1dBTExfQ09MT1Iucn0sICR7V0FMTF9DT0xPUi5nfSwgJHtXQUxMX0NPTE9SLmJ9KVxuICAgICNkZWZpbmUgV0FMTF9CRyB2ZWMzKCR7V0FMTF9CRy5yfSwgJHtXQUxMX0JHLmd9LCAke1dBTExfQkcuYn0pXG5cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB2ZWMyIHV2MSA9IHV2cy54eS0wLjU7XG4gICAgICBmbG9hdCBhbmdsZSA9IHRpbWUgLyAxMC4wO1xuICAgICAgdmVjMiB1djtcbiAgICAgIHV2LnggPSB1djEueCAqIGNvcyhhbmdsZSkgLSB1djEueSAqIHNpbihhbmdsZSk7XG4gICAgICB1di55ID0gdXYxLnkgKiBjb3MoYW5nbGUpICsgdXYxLnggKiBzaW4oYW5nbGUpO1xuICAgICAgdXYueCArPSBzaW4odXYueSAqIDIuNyArIHRpbWUgLyAxLjcpICogMC4yO1xuICAgICAgdXYueSArPSBzaW4odXYueCAqIDMuMSArIHRpbWUgLyAyLjQpICogMC4zO1xuXG4gICAgICBmbG9hdCB3LCByLCBiZztcbiAgICAgIHIgPSBzbW9vdGhOb2lzZSh2ZWMzKHV2ICsgd29ybGRQb3MueCwgdGltZSAvIDIuMCksIDMuMCkgKiAwLjY1O1xuICAgICAgciArPSBzbW9vdGhOb2lzZSh2ZWMzKHV2LCB0aW1lIC8gNi4wKSwgOC4wKSAqIDAuMztcbiAgICAgIHIgKz0gc21vb3RoTm9pc2UodmVjMyh1diwgdGltZSAvIDE0LjApLCA1MC4wKSAqIDAuMDQ7XG5cbiAgICAgIGJnID0gc21vb3Roc3RlcCgwLjUsIDEuMCwgcikgKyBzbW9vdGhzdGVwKDAuNSwgMC4wLCByKTtcbiAgICAgIHIgPSBzbW9vdGhzdGVwKDAuNCwgMC41MCwgcikgLSBzbW9vdGhzdGVwKDAuNTAsIDAuNiwgcik7XG4gICAgICB3ID0gc21vb3Roc3RlcCgwLjk3LCAxLjAsIHIpO1xuXG5cbiAgICAgIHIgKz0gc21vb3Roc3RlcCgwLjQ0LCAwLjUwLCBhYnModXYxLngpKTtcbiAgICAgIHIgKz0gc21vb3Roc3RlcCgwLjQ0LCAwLjUwLCBhYnModXYxLnkpKTtcblxuICAgICAgdyArPSBzbW9vdGhzdGVwKDAuNDksIDAuNDk4LCBhYnModXYxLngpKTtcbiAgICAgIHcgKz0gc21vb3Roc3RlcCgwLjQ5LCAwLjQ5OCwgYWJzKHV2MS55KSk7XG5cbiAgICAgIHcgKj0gMC45O1xuICAgICAgYmcgKj0gMC41O1xuXG4gICAgICB2ZWMzIENPTCA9IFdBTExfQ09MT1I7XG4gICAgICB2ZWMzIEJHID0gV0FMTF9CRyAqIDAuMTtcblxuICAgICAgdmVjMyBjb2wgPSB2ZWMzKHIgKiBDT0wuciArIHcgKyBCRy5yLCByICogQ09MLmcgKyB3ICsgQkcuZywgciAqIENPTC5iICsgdyArIEJHLmIpO1xuXG4gICAgICB2ZWMzIGhpdDtcbiAgICAgIGhpdCA9IGRyYXdDaXJjbGUod29ybGRQb3MsIGhpdFJpZ2h0LCAwLjA0LCAwLjA1LCBDT0wpO1xuICAgICAgaGl0ICs9IGRyYXdDaXJjbGUod29ybGRQb3MsIGhpdFJpZ2h0LCAwLjAyLCAwLjAzLCB2ZWMzKDAuNywgMC43LCAwLjcpKTtcbiAgICAgIGhpdCArPSBkcmF3Q2lyY2xlKHdvcmxkUG9zLCBoaXRMZWZ0LCAwLjA0LCAwLjA1LCBDT0wpO1xuICAgICAgaGl0ICs9IGRyYXdDaXJjbGUod29ybGRQb3MsIGhpdExlZnQsIDAuMDIsIDAuMDMsIHZlYzMoMC43LCAwLjcsIDAuNykpO1xuXG4gICAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KGNvbCArIGhpdCwgMC43ICsgdyArIGhpdC54KTtcbiAgICB9XG5gXG5cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvd2FsbC1zaGFkZXIuanMiLCJpbXBvcnQge0JFQVRfV0FSTVVQX09GRlNFVCwgQkVBVF9XQVJNVVBfU1BFRUQsIEJFQVRfV0FSTVVQX1RJTUV9IGZyb20gJy4uL2NvbnN0YW50cy9iZWF0JztcblxuLy8gU28gd2FsbCBkb2VzIG5vdCBjbGlwIHRoZSBzdGFnZSBncm91bmQuXG5jb25zdCBSQUlTRV9ZX09GRlNFVCA9IDAuMTtcblxuY29uc3QgV0FMTF9USElDS05FU1MgPSAwLjUwO1xuY29uc3QgQ0VJTElOR19USElDS05FU1MgPSAxLjU7XG5jb25zdCBDRUlMSU5HX0hFSUdIVCA9IDEuNCArIENFSUxJTkdfVEhJQ0tORVNTIC8gMjtcblxuLyoqXG4gKiBXYWxsIHRvIGRvZGdlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3dhbGwnLCB7XG4gIHNjaGVtYToge1xuICAgIGFudGljaXBhdGlvblBvc2l0aW9uOiB7ZGVmYXVsdDogMH0sXG4gICAgZHVyYXRpb25TZWNvbmRzOiB7ZGVmYXVsdDogMH0sXG4gICAgaGVpZ2h0OiB7ZGVmYXVsdDogMS4zfSxcbiAgICBob3Jpem9udGFsUG9zaXRpb246IHtkZWZhdWx0OiAnbWlkZGxlbGVmdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgb25lT2Y6IFsnbGVmdCcsICdtaWRkbGVsZWZ0JywgJ21pZGRsZXJpZ2h0JywgJ3JpZ2h0J119LFxuICAgIGlzQ2VpbGluZzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBzcGVlZDoge2RlZmF1bHQ6IDEuMH0sXG4gICAgd2FybXVwUG9zaXRpb246IHtkZWZhdWx0OiAwfSxcbiAgICB3aWR0aDoge2RlZmF1bHQ6IDF9XG4gIH0sXG5cbiAgaG9yaXpvbnRhbFBvc2l0aW9uczoge1xuICAgIGxlZnQ6IC0wLjc1LFxuICAgIG1pZGRsZWxlZnQ6IC0wLjI1LFxuICAgIG1pZGRsZXJpZ2h0OiAwLjI1LFxuICAgIHJpZ2h0OiAwLjc1XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubWF4WiA9IDEwO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGNvbnN0IHdpZHRoID0gZGF0YS53aWR0aCAqIFdBTExfVEhJQ0tORVNTO1xuXG4gICAgY29uc3QgaGFsZkRlcHRoID0gZGF0YS5kdXJhdGlvblNlY29uZHMgKiBkYXRhLnNwZWVkIC8gMjtcblxuICAgIGlmIChkYXRhLmlzQ2VpbGluZykge1xuICAgICAgZWwub2JqZWN0M0QucG9zaXRpb24uc2V0KFxuICAgICAgICAwLFxuICAgICAgICBDRUlMSU5HX0hFSUdIVCxcbiAgICAgICAgZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbiArIGRhdGEud2FybXVwUG9zaXRpb24gLSBoYWxmRGVwdGhcbiAgICAgICk7XG4gICAgICBlbC5vYmplY3QzRC5zY2FsZS5zZXQoXG4gICAgICAgIHdpZHRoLFxuICAgICAgICBDRUlMSU5HX1RISUNLTkVTUyxcbiAgICAgICAgZGF0YS5kdXJhdGlvblNlY29uZHMgKiBkYXRhLnNwZWVkXG4gICAgICApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEJveCBnZW9tZXRyeSBpcyBjb25zdHJ1Y3RlZCBmcm9tIHRoZSBsb2NhbCAwLDAsMCBncm93aW5nIGluIHRoZSBwb3NpdGl2ZSBhbmQgbmVnYXRpdmVcbiAgICAvLyB4IGFuZCB6IGF4aXMuIFdlIGhhdmUgdG8gc2hpZnQgYnkgaGFsZiB3aWR0aCBhbmQgZGVwdGggdG8gYmUgcG9zaXRpb25lZCBjb3JyZWN0bHkuXG4gICAgZWwub2JqZWN0M0QucG9zaXRpb24uc2V0KFxuICAgICAgdGhpcy5ob3Jpem9udGFsUG9zaXRpb25zW2RhdGEuaG9yaXpvbnRhbFBvc2l0aW9uXSArIHdpZHRoIC8gMiAgLSAwLjI1LFxuICAgICAgZGF0YS5oZWlnaHQgKyBSQUlTRV9ZX09GRlNFVCxcbiAgICAgIGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb24gKyBkYXRhLndhcm11cFBvc2l0aW9uIC0gaGFsZkRlcHRoXG4gICAgKTtcbiAgICBlbC5vYmplY3QzRC5zY2FsZS5zZXQoXG4gICAgICB3aWR0aCxcbiAgICAgIDIuNSxcbiAgICAgIGRhdGEuZHVyYXRpb25TZWNvbmRzICogZGF0YS5zcGVlZFxuICAgICk7XG4gIH0sXG5cbiAgcGF1c2U6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmVsLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1jb2xsaWRhYmxlLWhlYWQnKTtcbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnZGF0YS1jb2xsaWRhYmxlLWhlYWQnLCAnJyk7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2FiZXItcGFydGljbGVzJywgJycpO1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdyYXljYXN0YWJsZS1nYW1lJywgJycpO1xuICB9LFxuXG4gIHRvY2s6IGZ1bmN0aW9uICh0aW1lLCB0aW1lRGVsdGEpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGNvbnN0IGhhbGZEZXB0aCA9IGRhdGEuZHVyYXRpb25TZWNvbmRzICogZGF0YS5zcGVlZCAvIDI7XG4gICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uO1xuXG4gICAgLy8gTW92ZS5cbiAgICBpZiAocG9zaXRpb24ueiA8IChkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uIC0gaGFsZkRlcHRoKSkge1xuICAgICAgbGV0IG5ld1Bvc2l0aW9uWiA9IHBvc2l0aW9uLnogKyBCRUFUX1dBUk1VUF9TUEVFRCAqICh0aW1lRGVsdGEgLyAxMDAwKTtcbiAgICAgIC8vIFdhcm0gdXAgLyB3YXJwIGluLlxuICAgICAgaWYgKG5ld1Bvc2l0aW9uWiA8IChkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uIC0gaGFsZkRlcHRoKSkge1xuICAgICAgICBwb3NpdGlvbi56ID0gbmV3UG9zaXRpb25aO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcG9zaXRpb24ueiA9IGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb24gLSBoYWxmRGVwdGg7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFN0YW5kYXJkIG1vdmluZy5cbiAgICAgIHBvc2l0aW9uLnogKz0gdGhpcy5kYXRhLnNwZWVkICogKHRpbWVEZWx0YSAvIDEwMDApO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uLnogPiAodGhpcy5tYXhaICsgaGFsZkRlcHRoKSkge1xuICAgICAgdGhpcy5yZXR1cm5Ub1Bvb2woKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0sXG5cbiAgcmV0dXJuVG9Qb29sOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHMucG9vbF9fd2FsbC5yZXR1cm5FbnRpdHkodGhpcy5lbCk7XG4gICAgdGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbi56ID0gOTk5OTtcbiAgICB0aGlzLmVsLnBhdXNlKCk7XG4gICAgdGhpcy5lbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtY29sbGlkYWJsZS1oZWFkJyk7XG4gICAgdGhpcy5lbC5yZW1vdmVBdHRyaWJ1dGUoJ3JheWNhc3RhYmxlLWdhbWUnKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy93YWxsLmpzIiwibW9kdWxlLmV4cG9ydHMgPSBbXG4gIHtuYW1lOiAnUG9wJywgcm93OiAxLCBjb2x1bW46IDF9LFxuICB7bmFtZTogJ1ImQicsIHJvdzogMSwgY29sdW1uOiAyfSxcbiAge25hbWU6ICdSYXAnLCByb3c6IDEsIGNvbHVtbjogM30sXG4gIHtuYW1lOiAnUm9jaycsIHJvdzogMSwgY29sdW1uOiA0fSxcbiAge25hbWU6ICdTb3VuZHRyYWNrJywgcm93OiAxLCBjb2x1bW46IDV9LFxuICB7bmFtZTogJ1ZpZGVvIEdhbWVzJywgcm93OiAxLCBjb2x1bW46IDZ9LFxuXG4gIHtuYW1lOiAnRWxlY3Ryb25pYycsIHJvdzogMiwgY29sdW1uOiAxfSxcbiAge25hbWU6ICdIaXAgSG9wJywgcm93OiAyLCBjb2x1bW46IDJ9LFxuICB7bmFtZTogJ0hvdXNlJywgcm93OiAyLCBjb2x1bW46IDN9LFxuICB7bmFtZTogJ0otUG9wJywgcm93OiAyLCBjb2x1bW46IDR9LFxuICB7bmFtZTogJ0stUG9wJywgcm93OiAyLCBjb2x1bW46IDV9LFxuICB7bmFtZTogJ01lbWUnLCByb3c6IDIsIGNvbHVtbjogNn0sXG5cbiAge25hbWU6ICdBbHRlcm5hdGl2ZScsIHJvdzogMywgY29sdW1uOiAxfSxcbiAge25hbWU6ICdBbmltZScsIHJvdzogMywgY29sdW1uOiAyfSxcbiAge25hbWU6ICdDb21lZHknLCByb3c6IDMsIGNvbHVtbjogM30sXG4gIHtuYW1lOiAnRGlzbmV5Jywgcm93OiAzLCBjb2x1bW46IDR9LFxuICB7bmFtZTogJ0R1YnN0ZXAnLCByb3c6IDMsIGNvbHVtbjogNX0sXG4gIHtuYW1lOiAnRURNJywgcm93OiAzLCBjb2x1bW46IDZ9XG5dO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbnN0YW50cy9nZW5yZXMuanMiLCJmdW5jdGlvbiByZXF1aXJlQWxsIChyZXEpIHsgcmVxLmtleXMoKS5mb3JFYWNoKHJlcSk7IH1cblxucmVxdWlyZSgnLi4vdmVuZG9yL0J1ZmZlckdlb21ldHJ5VXRpbHMnKTtcblxucmVxdWlyZSgnYWZyYW1lLWFhYmItY29sbGlkZXItY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtYXRsYXMtdXZzLWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLWF1ZGlvYW5hbHlzZXItY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtZXZlbnQtc2V0LWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLWdlb21ldHJ5LW1lcmdlci1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS1oYXB0aWNzLWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLWxheW91dC1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS1vcmJpdC1jb250cm9scycpO1xucmVxdWlyZSgnYWZyYW1lLXByb3h5LWV2ZW50LWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLXJpbmctc2hhZGVyJyk7XG5yZXF1aXJlKCdhZnJhbWUtc3RhdGUtY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtc2xpY2U5LWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLXRodW1iLWNvbnRyb2xzLWNvbXBvbmVudCcpO1xuXG5yZXF1aXJlQWxsKHJlcXVpcmUuY29udGV4dCgnLi9jb21wb25lbnRzLycsIHRydWUsIC9cXC5qcyQvKSk7XG5yZXF1aXJlQWxsKHJlcXVpcmUuY29udGV4dCgnLi9zdGF0ZS8nLCB0cnVlLCAvXFwuanMkLykpO1xuXG5yZXF1aXJlKCcuL2luZGV4LmNzcycpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2luZGV4LmpzIiwiLyogZ2xvYmFsIEF1ZGlvICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIFNvdW5kUG9vbCAoc3JjLCB2b2x1bWUpIHtcbiAgdmFyIGN1cnJTb3VuZCA9IDA7XG4gIHZhciBwb29sID0gW107XG4gIHZhciBzb3VuZDtcblxuICBzb3VuZCA9IG5ldyBBdWRpbyhzcmMpO1xuICBzb3VuZC52b2x1bWUgPSB2b2x1bWU7XG4gIHBvb2wucHVzaChzb3VuZCk7XG5cbiAgcmV0dXJuIHtcbiAgICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBEeW5hbWljIHNpemUgcG9vbC5cbiAgICAgIGlmIChwb29sW2N1cnJTb3VuZF0uY3VycmVudFRpbWUgIT09IDAgfHwgIXBvb2xbY3VyclNvdW5kXS5lbmRlZCkge1xuICAgICAgICBzb3VuZCA9IG5ldyBBdWRpbyhzcmMpO1xuICAgICAgICBzb3VuZC52b2x1bWUgPSB2b2x1bWU7XG4gICAgICAgIHBvb2wucHVzaChzb3VuZCk7XG4gICAgICAgIGN1cnJTb3VuZCsrO1xuICAgICAgfVxuXG4gICAgICBpZiAocG9vbFtjdXJyU291bmRdLmN1cnJlbnRUaW1lID09PSAwIHx8IHBvb2xbY3VyclNvdW5kXS5lbmRlZCkge1xuICAgICAgICBwb29sW2N1cnJTb3VuZF0ucGxheSgpO1xuICAgICAgfVxuICAgICAgY3VyclNvdW5kID0gKGN1cnJTb3VuZCArIDEpICUgcG9vbC5sZW5ndGg7XG4gICAgfVxuICB9O1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9saWIvc291bmRwb29sLmpzIiwiLyogZ2xvYmFsIGxvY2FsU3RvcmFnZSAqL1xudmFyIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcblxuY29uc3QgY2hhbGxlbmdlRGF0YVN0b3JlID0ge307XG5jb25zdCBOVU1fTEVBREVSQk9BUkRfRElTUExBWSA9IDEwO1xuY29uc3QgU0VBUkNIX1BFUl9QQUdFID0gNjtcbmNvbnN0IFNPTkdfTkFNRV9UUlVOQ0FURSA9IDI0O1xuY29uc3QgU09OR19TVUJfTkFNRV9UUlVOQ0FURSA9IDMyO1xuXG5jb25zdCBEQU1BR0VfREVDQVkgPSAwLjI1O1xuY29uc3QgREFNQUdFX01BWCA9IDEwO1xuXG5jb25zdCBERUJVR19DSEFMTEVOR0UgPSB7XG4gIGF1dGhvcjogJ1N1cGVybWFuJyxcbiAgZGlmZmljdWx0eTogJ0V4cGVydCcsXG4gIGlkOiAnMzEnLFxuICBpbWFnZTogJ2Fzc2V0cy9pbWcvbW9sZXJhdC5qcGcnLFxuICBzb25nTmFtZTogJ0ZyaWRheScsXG4gIHNvbmdMZW5ndGg6IDEwMCxcbiAgc29uZ1N1Yk5hbWU6ICdSZWJlY2NhIEJsYWNrJ1xufTtcblxuLyoqXG4gKiBTdGF0ZSBoYW5kbGVyLlxuICpcbiAqIDEuIGBoYW5kbGVyc2AgaXMgYW4gb2JqZWN0IG9mIGV2ZW50cyB0aGF0IHdoZW4gZW1pdHRlZCB0byB0aGUgc2NlbmUgd2lsbCBydW4gdGhlIGhhbmRsZXIuXG4gKlxuICogMi4gVGhlIGhhbmRsZXIgZnVuY3Rpb24gbW9kaWZpZXMgdGhlIHN0YXRlLlxuICpcbiAqIDMuIEVudGl0aWVzIGFuZCBjb21wb25lbnRzIHRoYXQgYXJlIGBiaW5kYGVkIGF1dG9tYXRpY2FsbHkgdXBkYXRlOlxuICogICAgYGJpbmRfXzxjb21wb25lbnROYW1lPj1cIjxwcm9wZXJ0eU5hbWU+OiBzb21lLml0ZW0uaW4uc3RhdGVcImBcbiAqL1xuQUZSQU1FLnJlZ2lzdGVyU3RhdGUoe1xuICBub25CaW5kZWRTdGF0ZUtleXM6IFsnZ2VucmVzJ10sXG5cbiAgaW5pdGlhbFN0YXRlOiB7XG4gICAgYWN0aXZlSGFuZDogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2hhbmQnKSB8fCAncmlnaHQnLFxuICAgIGNoYWxsZW5nZTogeyAgLy8gQWN0aXZlbHkgcGxheWluZyBjaGFsbGVuZ2UuXG4gICAgICBhdXRob3I6ICcnLFxuICAgICAgZGlmZmljdWx0eTogJycsXG4gICAgICBpZDogQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignY2hhbGxlbmdlJyksICAvLyBXaWxsIGJlIGVtcHR5IHN0cmluZyBpZiBub3QgcGxheWluZy5cbiAgICAgIGltYWdlOiAnJyxcbiAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICBpc0JlYXRzUHJlbG9hZGVkOiBmYWxzZSwgIC8vIFdoZXRoZXIgd2UgaGF2ZSBwYXNzZWQgdGhlIG5lZ2F0aXZlIHRpbWUuXG4gICAgICBudW1CZWF0czogdW5kZWZpbmVkLFxuICAgICAgc29uZ0R1cmF0aW9uOiAwLFxuICAgICAgc29uZ05hbWU6ICcnLFxuICAgICAgc29uZ1N1Yk5hbWU6ICcnXG4gICAgfSxcbiAgICBjb250cm9sbGVyVHlwZTogJycsXG4gICAgZGFtYWdlOiAwLFxuICAgIGdlbnJlOiAnJyxcbiAgICBnZW5yZXM6IHJlcXVpcmUoJy4uL2NvbnN0YW50cy9nZW5yZXMnKSxcbiAgICBnZW5yZU1lbnVPcGVuOiBmYWxzZSxcbiAgICBpblZSOiBmYWxzZSxcbiAgICBpc0dhbWVPdmVyOiBmYWxzZSwgIC8vIEdhbWUgb3ZlciBzY3JlZW4uXG4gICAgaXNQYXVzZWQ6IGZhbHNlLCAgLy8gUGxheWluZywgYnV0IHBhdXNlZC4gTm90IGFjdGl2ZSBkdXJpbmcgbWVudS5cbiAgICBpc1BsYXlpbmc6IGZhbHNlLCAgLy8gQWN0aXZlbHkgcGxheWluZyAoc2xpY2luZyBiZWF0cykuXG4gICAgaXNTZWFyY2hpbmc6IGZhbHNlLCAgLy8gV2hldGhlciBzZWFyY2ggaXMgb3Blbi5cbiAgICBpc1NvbmdGZXRjaGluZzogZmFsc2UsICAvLyBGZXRjaGluZyBzdGFnZS5cbiAgICBpc1NvbmdMb2FkaW5nOiBmYWxzZSwgIC8vIEVpdGhlciBmZXRjaGluZyBvciBkZWNvZGluZy5cbiAgICBpc1ZpY3Rvcnk6IGZhbHNlLCAgLy8gVmljdG9yeSBzY3JlZW4uXG4gICAgbGVhZGVyYm9hcmQ6IFtdLFxuICAgIGxlYWRlcmJvYXJkRmV0Y2hlZDogZmFsc2UsXG4gICAgbGVhZGVyYm9hcmRRdWFsaWZpZWQ6IGZhbHNlLFxuICAgIGxlYWRlcmJvYXJkTmFtZXM6ICcnLFxuICAgIGxlYWRlcmJvYXJkU2NvcmVzOiAnJyxcbiAgICBtZW51QWN0aXZlOiB0cnVlLCAgLy8gTWFpbiBtZW51IGFjdGl2ZS5cbiAgICBtZW51RGlmZmljdWx0aWVzOiBbXSwgIC8vIExpc3Qgb2Ygc3RyaW5ncyBvZiBhdmFpbGFibGUgZGlmZmljdWx0aWVzIGZvciBzZWxlY3RlZC5cbiAgICBtZW51U2VsZWN0ZWRDaGFsbGVuZ2U6IHsgIC8vIEN1cnJlbnRseSBzZWxlY3RlZCBjaGFsbGVuZ2UgaW4gdGhlIG1haW4gbWVudS5cbiAgICAgIGF1dGhvcjogJycsXG4gICAgICBkaWZmaWN1bHR5OiAnJyxcbiAgICAgIGRvd25sb2FkczogJycsXG4gICAgICBkb3dubG9hZHNUZXh0OiAnJyxcbiAgICAgIGdlbnJlOiAnJyxcbiAgICAgIGlkOiAnJyxcbiAgICAgIGluZGV4OiAtMSxcbiAgICAgIGltYWdlOiAnJyxcbiAgICAgIG51bUJlYXRzOiB1bmRlZmluZWQsXG4gICAgICBzb25nRHVyYXRpb246IDAsXG4gICAgICBzb25nSW5mb1RleHQ6ICcnLFxuICAgICAgc29uZ0xlbmd0aDogdW5kZWZpbmVkLFxuICAgICAgc29uZ05hbWU6ICcnLFxuICAgICAgc29uZ1N1Yk5hbWU6ICcnXG4gICAgfSxcbiAgICBzY29yZToge1xuICAgICAgYWNjdXJhY3k6IDAsICAvLyBPdXQgb2YgMTAwLlxuICAgICAgYmVhdHNIaXQ6IDAsXG4gICAgICBiZWF0c01pc3NlZDogMCxcbiAgICAgIGJlYXRzVGV4dDogJycsXG4gICAgICBjb21ibzogMCxcbiAgICAgIG1heENvbWJvOiAwLFxuICAgICAgbXVsdGlwbGllcjogMSxcbiAgICAgIHJhbms6ICcnLCAgLy8gR3JhZGUgKFMgdG8gRikuXG4gICAgICBzY29yZTogMFxuICAgIH0sXG4gICAgc2VhcmNoOiB7XG4gICAgICBhY3RpdmU6IHRydWUsXG4gICAgICBwYWdlOiAwLFxuICAgICAgaGFzRXJyb3I6IGZhbHNlLFxuICAgICAgaGFzTmV4dDogZmFsc2UsXG4gICAgICBoYXNQcmV2OiBmYWxzZSxcbiAgICAgIHF1ZXJ5OiAnJyxcbiAgICAgIHJlc3VsdHM6IFtdLFxuICAgICAgc29uZ05hbWVUZXh0czogJycsICAvLyBBbGwgbmFtZXMgaW4gc2VhcmNoIHJlc3VsdHMgbWVyZ2VkIHRvZ2V0aGVyLlxuICAgICAgc29uZ1N1Yk5hbWVUZXh0czogJycgIC8vIEFsbCBzdWIgbmFtZXMgaW4gc2VhcmNoIHJlc3VsdHMgbWVyZ2VkIHRvZ2V0aGVyLlxuICAgIH0sXG4gICAgc2VhcmNoUmVzdWx0c1BhZ2U6IFtdXG4gIH0sXG5cbiAgaGFuZGxlcnM6IHtcbiAgICAvKipcbiAgICAgKiBTd2FwIGxlZnQtaGFuZGVkIG9yIHJpZ2h0LWhhbmRlZCBtb2RlLlxuICAgICAqL1xuICAgIGFjdGl2ZWhhbmRzd2FwOiBzdGF0ZSA9PiB7XG4gICAgICBzdGF0ZS5hY3RpdmVIYW5kID0gc3RhdGUuYWN0aXZlSGFuZCA9PT0gJ3JpZ2h0JyA/ICdsZWZ0JyA6ICdyaWdodCc7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWN0aXZlSGFuZCcsIHN0YXRlLmFjdGl2ZUhhbmQpO1xuICAgIH0sXG5cbiAgICBiZWF0aGl0OiAoc3RhdGUsIHBheWxvYWQpID0+IHtcbiAgICAgIGlmIChzdGF0ZS5kYW1hZ2UgPiBEQU1BR0VfREVDQVkpIHtcbiAgICAgICAgc3RhdGUuZGFtYWdlIC09IERBTUFHRV9ERUNBWTtcbiAgICAgIH1cbiAgICAgIHN0YXRlLnNjb3JlLmJlYXRzSGl0Kys7XG4gICAgICBzdGF0ZS5zY29yZS5jb21ibysrO1xuICAgICAgaWYgKHN0YXRlLnNjb3JlLmNvbWJvID4gc3RhdGUuc2NvcmUubWF4Q29tYm8pIHtcbiAgICAgICAgc3RhdGUuc2NvcmUubWF4Q29tYm8gPSBzdGF0ZS5zY29yZS5jb21ibztcbiAgICAgIH1cblxuICAgICAgc3RhdGUuc2NvcmUuc2NvcmUgKz0gTWF0aC5mbG9vcihwYXlsb2FkLnNjb3JlICogc3RhdGUuc2NvcmUubXVsdGlwbGllcik7XG5cbiAgICAgIC8vIE1pZ2h0IGJlIGEgbWF0aCBmb3JtdWxhIGZvciB0aGlzLCBidXQgdGhlIG11bHRpcGxpZXIgc3lzdGVtIGlzIGVhc3kgcmVkdWNlZC5cbiAgICAgIGlmIChzdGF0ZS5zY29yZS5jb21ibyA8IDIpIHtcbiAgICAgICAgc3RhdGUuc2NvcmUubXVsdGlwbGllciA9IDE7XG4gICAgICB9IGVsc2UgaWYgKHN0YXRlLnNjb3JlLmNvbWJvIDwgNikge1xuICAgICAgICBzdGF0ZS5zY29yZS5tdWx0aXBsaWVyID0gMjtcbiAgICAgIH0gZWxzZSBpZiAoc3RhdGUuc2NvcmUuY29tYm8gPCAxNCkge1xuICAgICAgICBzdGF0ZS5zY29yZS5tdWx0aXBsaWVyID0gNDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLm11bHRpcGxpZXIgPSA4O1xuICAgICAgfVxuXG4gICAgICB1cGRhdGVTY29yZUFjY3VyYWN5KHN0YXRlKTtcbiAgICB9LFxuXG4gICAgYmVhdG1pc3M6IHN0YXRlID0+IHtcbiAgICAgIHN0YXRlLnNjb3JlLmJlYXRzTWlzc2VkKys7XG4gICAgICB0YWtlRGFtYWdlKHN0YXRlKTtcbiAgICAgIHVwZGF0ZVNjb3JlQWNjdXJhY3koc3RhdGUpO1xuICAgIH0sXG5cbiAgICBiZWF0d3Jvbmc6IHN0YXRlID0+IHtcbiAgICAgIHN0YXRlLnNjb3JlLmJlYXRzTWlzc2VkKys7XG4gICAgICB0YWtlRGFtYWdlKHN0YXRlKTtcbiAgICAgIHVwZGF0ZVNjb3JlQWNjdXJhY3koc3RhdGUpO1xuICAgIH0sXG5cbiAgICBiZWF0bG9hZGVyZmluaXNoOiAoc3RhdGUsIHBheWxvYWQpID0+IHtcbiAgICAgIHN0YXRlLmNoYWxsZW5nZS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgYmVhdGxvYWRlcnByZWxvYWRmaW5pc2g6IChzdGF0ZSkgPT4ge1xuICAgICAgaWYgKHN0YXRlLm1lbnVBY3RpdmUpIHsgcmV0dXJuOyB9ICAvLyBDYW5jZWxsZWQuXG4gICAgICBzdGF0ZS5jaGFsbGVuZ2UuaXNCZWF0c1ByZWxvYWRlZCA9IHRydWU7XG4gICAgfSxcblxuICAgIGJlYXRsb2FkZXJzdGFydDogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5jaGFsbGVuZ2UuaXNCZWF0c1ByZWxvYWRlZCA9IGZhbHNlO1xuICAgICAgc3RhdGUuY2hhbGxlbmdlLmlzTG9hZGluZyA9IHRydWU7XG4gICAgfSxcblxuICAgIGNvbnRyb2xsZXJjb25uZWN0ZWQ6IChzdGF0ZSwgcGF5bG9hZCkgPT4ge1xuICAgICAgc3RhdGUuY29udHJvbGxlclR5cGUgPSBwYXlsb2FkLm5hbWU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFRvIHdvcmsgb24gZ2FtZSBvdmVyIHBhZ2UuXG4gICAgICpcbiAgICAgKiA/ZGVidWdzdGF0ZT1nYW1lcGxheVxuICAgICAqL1xuICAgIGRlYnVnZ2FtZXBsYXk6IHN0YXRlID0+IHtcbiAgICAgIHJlc2V0U2NvcmUoc3RhdGUpO1xuXG4gICAgICAvLyBTZXQgY2hhbGxlbmdlLiBgYmVhdC1sb2FkZXJgIGlzIGxpc3RlbmluZy5cbiAgICAgIE9iamVjdC5hc3NpZ24oc3RhdGUuY2hhbGxlbmdlLCBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UpO1xuXG4gICAgICAvLyBSZXNldCBtZW51LlxuICAgICAgc3RhdGUubWVudUFjdGl2ZSA9IGZhbHNlO1xuICAgICAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmlkID0gJyc7XG5cbiAgICAgIHN0YXRlLmlzU2VhcmNoaW5nID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1NvbmdMb2FkaW5nID0gZmFsc2U7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFRvIHdvcmsgb24gZ2FtZSBvdmVyIHBhZ2UuXG4gICAgICpcbiAgICAgKiA/ZGVidWdzdGF0ZT1nYW1lb3ZlclxuICAgICAqL1xuICAgIGRlYnVnZ2FtZW92ZXI6IHN0YXRlID0+IHtcbiAgICAgIHN0YXRlLmlzR2FtZU92ZXIgPSB0cnVlO1xuICAgICAgc3RhdGUubWVudUFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBUbyB3b3JrIG9uIHZpY3RvcnkgcGFnZS5cbiAgICAgKlxuICAgICAqID9kZWJ1Z3N0YXRlPWxvYWRpbmdcbiAgICAgKi9cbiAgICBkZWJ1Z2xvYWRpbmc6IHN0YXRlID0+IHtcbiAgICAgIERFQlVHX0NIQUxMRU5HRS5pZCA9ICctMSc7XG4gICAgICBPYmplY3QuYXNzaWduKHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZSwgREVCVUdfQ0hBTExFTkdFKTtcbiAgICAgIE9iamVjdC5hc3NpZ24oc3RhdGUuY2hhbGxlbmdlLCBERUJVR19DSEFMTEVOR0UpO1xuICAgICAgc3RhdGUubWVudUFjdGl2ZSA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNTb25nRmV0Y2hpbmcgPSB0cnVlO1xuICAgICAgc3RhdGUuaXNTb25nTG9hZGluZyA9IHRydWU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFRvIHdvcmsgb24gdmljdG9yeSBwYWdlLlxuICAgICAqXG4gICAgICogP2RlYnVnc3RhdGU9dmljdG9yeVxuICAgICAqL1xuICAgIGRlYnVndmljdG9yeTogc3RhdGUgPT4ge1xuICAgICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UsIERFQlVHX0NIQUxMRU5HRSk7XG4gICAgICBPYmplY3QuYXNzaWduKHN0YXRlLmNoYWxsZW5nZSwgREVCVUdfQ0hBTExFTkdFKTtcbiAgICAgIHN0YXRlLmlzVmljdG9yeSA9IHRydWU7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZFF1YWxpZmllZCA9IHRydWU7XG4gICAgICBzdGF0ZS5tZW51QWN0aXZlID0gZmFsc2U7XG4gICAgICBzdGF0ZS5zY29yZS5hY2N1cmFjeSA9IDc0Ljk5O1xuICAgICAgc3RhdGUuc2NvcmUuYmVhdHNIaXQgPSAxMjU7XG4gICAgICBzdGF0ZS5zY29yZS5iZWF0c01pc3NlZCA9IDEyNTtcbiAgICAgIHN0YXRlLnNjb3JlLm1heENvbWJvID0gMTIzO1xuICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdDJztcbiAgICAgIHN0YXRlLnNjb3JlLnNjb3JlID0gOTAwMTtcbiAgICAgIGNvbXB1dGVCZWF0c1RleHQoc3RhdGUpO1xuICAgIH0sXG5cbiAgICBnYW1lbWVudXJlc3VtZTogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5pc1BhdXNlZCA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBnYW1lbWVudXJlc3RhcnQ6IChzdGF0ZSkgPT4ge1xuICAgICAgcmVzZXRTY29yZShzdGF0ZSk7XG4gICAgICBzdGF0ZS5jaGFsbGVuZ2UuaXNCZWF0c1ByZWxvYWRlZCA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNHYW1lT3ZlciA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNQYXVzZWQgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzU29uZ0xvYWRpbmcgPSB0cnVlO1xuICAgICAgc3RhdGUuaXNWaWN0b3J5ID0gZmFsc2U7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZFF1YWxpZmllZCA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBnYW1lbWVudWV4aXQ6IChzdGF0ZSkgPT4ge1xuICAgICAgcmVzZXRTY29yZShzdGF0ZSk7XG4gICAgICBzdGF0ZS5jaGFsbGVuZ2UuaXNCZWF0c1ByZWxvYWRlZCA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNHYW1lT3ZlciA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNQYXVzZWQgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzVmljdG9yeSA9IGZhbHNlO1xuICAgICAgc3RhdGUubWVudUFjdGl2ZSA9IHRydWU7XG4gICAgICBzdGF0ZS5jaGFsbGVuZ2UuaWQgPSAnJztcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkUXVhbGlmaWVkID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGdlbnJlY2xlYXI6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuZ2VucmUgPSAnJztcbiAgICB9LFxuXG4gICAgZ2VucmVtZW51Y2xvc2U6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuZ2VucmVNZW51T3BlbiA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBnZW5yZW1lbnVvcGVuOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmdlbnJlTWVudU9wZW4gPSB0cnVlO1xuICAgIH0sXG5cbiAgICBrZXlib2FyZGNsb3NlOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmlzU2VhcmNoaW5nID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGtleWJvYXJkb3BlbjogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5pc1NlYXJjaGluZyA9IHRydWU7XG4gICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaWQgPSAnJztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogSGlnaCBzY29yZXMuXG4gICAgICovXG4gICAgbGVhZGVyYm9hcmQ6IChzdGF0ZSwgcGF5bG9hZCkgPT4ge1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmQubGVuZ3RoID0gMDtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkRmV0Y2hlZCA9IHRydWU7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZE5hbWVzID0gJyc7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZFNjb3JlcyA9ICcnO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXlsb2FkLnNjb3Jlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgc2NvcmUgPSBwYXlsb2FkLnNjb3Jlc1tpXTtcbiAgICAgICAgc3RhdGUubGVhZGVyYm9hcmQucHVzaChzY29yZSk7XG4gICAgICAgIHN0YXRlLmxlYWRlcmJvYXJkTmFtZXMgKz0gYCR7c2NvcmUudXNlcm5hbWV9ICgke3Njb3JlLmFjY3VyYWN5IHx8IDB9JSlcXG5gO1xuICAgICAgICBzdGF0ZS5sZWFkZXJib2FyZFNjb3JlcyArPSBgJHtzY29yZS5zY29yZX1cXG5gO1xuICAgICAgfVxuICAgICAgc3RhdGUubGVhZGVyYm9hcmRMb2FkaW5nID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGxlYWRlcmJvYXJkcXVhbGlmeTogc3RhdGUgPT4ge1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRRdWFsaWZpZWQgPSB0cnVlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgbmV3IHNjb3JlIGludG8gbGVhZGVyYm9hcmQgbG9jYWxseS5cbiAgICAgKi9cbiAgICBsZWFkZXJib2FyZHNjb3JlYWRkZWQ6IChzdGF0ZSwgcGF5bG9hZCkgPT4ge1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmQuc3BsaWNlKHBheWxvYWQuaW5kZXgsIDAsIHBheWxvYWQuc2NvcmVEYXRhKTtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkTmFtZXMgPSAnJztcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkU2NvcmVzID0gJyc7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE5VTV9MRUFERVJCT0FSRF9ESVNQTEFZOyBpKyspIHtcbiAgICAgICAgbGV0IHNjb3JlID0gc3RhdGUubGVhZGVyYm9hcmRbaV07XG4gICAgICAgIHN0YXRlLmxlYWRlcmJvYXJkTmFtZXMgKz0gYCR7c2NvcmUudXNlcm5hbWV9ICgke3Njb3JlLmFjY3VyYWN5IHx8IDB9JSlcXG5gO1xuICAgICAgICBzdGF0ZS5sZWFkZXJib2FyZFNjb3JlcyArPSBgJHtzY29yZS5zY29yZX1cXG5gO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBsZWFkZXJib2FyZHN1Ym1pdDogc3RhdGUgPT4ge1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRRdWFsaWZpZWQgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU29uZyBjbGlja2VkIGZyb20gbWVudS5cbiAgICAgKi9cbiAgICBtZW51Y2hhbGxlbmdlc2VsZWN0OiAoc3RhdGUsIGlkKSA9PiB7XG4gICAgICAvLyBDb3B5IGZyb20gY2hhbGxlbmdlIHN0b3JlIHBvcHVsYXRlZCBmcm9tIHNlYXJjaCByZXN1bHRzLlxuICAgICAgbGV0IGNoYWxsZW5nZSA9IGNoYWxsZW5nZURhdGFTdG9yZVtpZF07XG4gICAgICBPYmplY3QuYXNzaWduKHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZSwgY2hhbGxlbmdlKTtcblxuICAgICAgLy8gUG9wdWxhdGUgZGlmZmljdWx0eSBvcHRpb25zLlxuICAgICAgc3RhdGUubWVudURpZmZpY3VsdGllcy5sZW5ndGggPSAwO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGFsbGVuZ2UuZGlmZmljdWx0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHN0YXRlLm1lbnVEaWZmaWN1bHRpZXMudW5zaGlmdChjaGFsbGVuZ2UuZGlmZmljdWx0aWVzW2ldKTtcbiAgICAgIH1cbiAgICAgIHN0YXRlLm1lbnVEaWZmaWN1bHRpZXMuc29ydChkaWZmaWN1bHR5Q29tcGFyYXRvcik7XG5cbiAgICAgIC8vIERlZmF1bHQgdG8gZWFzaWVzdCBkaWZmaWN1bHR5LlxuICAgICAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmRpZmZpY3VsdHkgPSBzdGF0ZS5tZW51RGlmZmljdWx0aWVzWzBdO1xuXG4gICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaW1hZ2UgPSB1dGlscy5nZXRTM0ZpbGVVcmwoaWQsICdpbWFnZS5qcGcnKTtcbiAgICAgIHVwZGF0ZU1lbnVTb25nSW5mbyhzdGF0ZSwgY2hhbGxlbmdlKTtcblxuICAgICAgY29tcHV0ZU1lbnVTZWxlY3RlZENoYWxsZW5nZUluZGV4KHN0YXRlKTtcbiAgICAgIHN0YXRlLmlzU2VhcmNoaW5nID0gZmFsc2U7XG5cbiAgICAgIGNsZWFyTGVhZGVyYm9hcmQoc3RhdGUpO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRMb2FkaW5nID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgbWVudWNoYWxsZW5nZXVuc2VsZWN0OiBzdGF0ZSA9PiB7XG4gICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaWQgPSAnJztcbiAgICAgIGNsZWFyTGVhZGVyYm9hcmQoc3RhdGUpO1xuICAgIH0sXG5cbiAgICBtZW51ZGlmZmljdWx0eXNlbGVjdDogKHN0YXRlLCBkaWZmaWN1bHR5KSA9PiB7XG4gICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuZGlmZmljdWx0eSA9IGRpZmZpY3VsdHk7XG4gICAgICB1cGRhdGVNZW51U29uZ0luZm8oc3RhdGUsIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZSk7XG5cbiAgICAgIGNsZWFyTGVhZGVyYm9hcmQoc3RhdGUpO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRMb2FkaW5nID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgbWluZWhpdDogc3RhdGUgPT4ge1xuICAgICAgdGFrZURhbWFnZShzdGF0ZSk7XG4gICAgfSxcblxuICAgIHBhdXNlZ2FtZTogKHN0YXRlKSA9PiB7XG4gICAgICBpZiAoIXN0YXRlLmlzUGxheWluZykgeyByZXR1cm47IH1cbiAgICAgIHN0YXRlLmlzUGF1c2VkID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgY2hhbGxlbmdlLlxuICAgICAqIFRyYW5zZmVyIHN0YWdlZCBjaGFsbGVuZ2UgdG8gdGhlIGFjdGl2ZSBjaGFsbGVuZ2UuXG4gICAgICovXG4gICAgcGxheWJ1dHRvbmNsaWNrOiAoc3RhdGUpID0+IHtcbiAgICAgIHJlc2V0U2NvcmUoc3RhdGUpO1xuXG4gICAgICAvLyBTZXQgY2hhbGxlbmdlLiBgYmVhdC1sb2FkZXJgIGlzIGxpc3RlbmluZy5cbiAgICAgIE9iamVjdC5hc3NpZ24oc3RhdGUuY2hhbGxlbmdlLCBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UpO1xuXG4gICAgICAvLyBSZXNldCBtZW51LlxuICAgICAgc3RhdGUubWVudUFjdGl2ZSA9IGZhbHNlO1xuICAgICAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmlkID0gJyc7XG5cbiAgICAgIHN0YXRlLmlzU2VhcmNoaW5nID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1NvbmdMb2FkaW5nID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgc2VhcmNoZXJyb3I6IChzdGF0ZSwgcGF5bG9hZCkgPT4ge1xuICAgICAgc3RhdGUuc2VhcmNoLmhhc0Vycm9yID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgc2VhcmNocHJldnBhZ2U6IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgaWYgKHN0YXRlLnNlYXJjaC5wYWdlID09PSAwKSB7IHJldHVybjsgfVxuICAgICAgc3RhdGUuc2VhcmNoLnBhZ2UtLTtcbiAgICAgIGNvbXB1dGVTZWFyY2hQYWdpbmF0aW9uKHN0YXRlKTtcbiAgICB9LFxuXG4gICAgc2VhcmNobmV4dHBhZ2U6IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgaWYgKHN0YXRlLnNlYXJjaC5wYWdlID4gTWF0aC5mbG9vcihzdGF0ZS5zZWFyY2gucmVzdWx0cy5sZW5ndGggLyBTRUFSQ0hfUEVSX1BBR0UpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHN0YXRlLnNlYXJjaC5wYWdlKys7XG4gICAgICBjb21wdXRlU2VhcmNoUGFnaW5hdGlvbihzdGF0ZSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBzZWFyY2ggcmVzdWx0cy4gV2lsbCBhdXRvbWF0aWNhbGx5IHJlbmRlciB1c2luZyBgYmluZC1mb3JgIChtZW51Lmh0bWwpLlxuICAgICAqL1xuICAgIHNlYXJjaHJlc3VsdHM6IChzdGF0ZSwgcGF5bG9hZCkgPT4ge1xuICAgICAgdmFyIGk7XG4gICAgICBzdGF0ZS5zZWFyY2guaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgIHN0YXRlLnNlYXJjaC5wYWdlID0gMDtcbiAgICAgIHN0YXRlLnNlYXJjaC5xdWVyeSA9IHBheWxvYWQucXVlcnk7XG4gICAgICBzdGF0ZS5zZWFyY2gucmVzdWx0cyA9IHBheWxvYWQucmVzdWx0cztcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBwYXlsb2FkLnJlc3VsdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHBheWxvYWQucmVzdWx0c1tpXTtcbiAgICAgICAgcmVzdWx0LnNvbmdTdWJOYW1lID0gcmVzdWx0LnNvbmdTdWJOYW1lIHx8ICdVbmtub3duIEFydGlzdCc7XG4gICAgICAgIHJlc3VsdC5zaG9ydFNvbmdOYW1lID0gdHJ1bmNhdGUocmVzdWx0LnNvbmdOYW1lLCBTT05HX05BTUVfVFJVTkNBVEUpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIHJlc3VsdC5zaG9ydFNvbmdTdWJOYW1lID0gdHJ1bmNhdGUocmVzdWx0LnNvbmdTdWJOYW1lLCBTT05HX1NVQl9OQU1FX1RSVU5DQVRFKTtcbiAgICAgICAgY2hhbGxlbmdlRGF0YVN0b3JlW3Jlc3VsdC5pZF0gPSByZXN1bHQ7XG4gICAgICB9XG4gICAgICBjb21wdXRlU2VhcmNoUGFnaW5hdGlvbihzdGF0ZSk7XG5cbiAgICAgIGlmIChwYXlsb2FkLmlzR2VucmVTZWFyY2gpIHtcbiAgICAgICAgc3RhdGUuZ2VucmVNZW51T3BlbiA9IGZhbHNlO1xuICAgICAgICBzdGF0ZS5nZW5yZSA9IHBheWxvYWQuZ2VucmU7XG4gICAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pZCA9ICcnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RhdGUuZ2VucmUgPSAnJztcbiAgICAgICAgY29tcHV0ZU1lbnVTZWxlY3RlZENoYWxsZW5nZUluZGV4KHN0YXRlKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc29uZ2ZldGNoZmluaXNoOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmlzU29uZ0ZldGNoaW5nID0gZmFsc2U7XG4gICAgfSxcblxuICAgIHNvbmdsb2FkY2FuY2VsOiBzdGF0ZSA9PiB7XG4gICAgICBzdGF0ZS5jaGFsbGVuZ2UuaXNCZWF0c1ByZWxvYWRlZCA9IGZhbHNlO1xuICAgICAgc3RhdGUuY2hhbGxlbmdlLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNTb25nTG9hZGluZyA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNTb25nRmV0Y2hpbmcgPSBmYWxzZTtcbiAgICAgIHN0YXRlLm1lbnVBY3RpdmUgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBzb25nbG9hZGZpbmlzaDogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5pc1NvbmdGZXRjaGluZyA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNTb25nTG9hZGluZyA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBzb25nbG9hZHN0YXJ0OiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmlzU29uZ0ZldGNoaW5nID0gdHJ1ZTtcbiAgICAgIHN0YXRlLmlzU29uZ0xvYWRpbmcgPSB0cnVlO1xuICAgIH0sXG5cbiAgICAnZW50ZXItdnInOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmluVlIgPSB0cnVlO1xuICAgIH0sXG5cbiAgICAnZXhpdC12cic6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuaW5WUiA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICB2aWN0b3J5OiBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgIHN0YXRlLmlzVmljdG9yeSA9IHRydWU7XG5cbiAgICAgIC8vIFBlcmNlbnRhZ2UgaXMgc2NvcmUgZGl2aWRlZCBieSB0b3RhbCBwb3NzaWJsZSBzY29yZS5cbiAgICAgIGNvbnN0IGFjY3VyYWN5ID0gKHN0YXRlLnNjb3JlLnNjb3JlIC8gKHN0YXRlLmNoYWxsZW5nZS5udW1CZWF0cyAqIDExMCkpICogMTAwO1xuICAgICAgc3RhdGUuc2NvcmUuYWNjdXJhY3kgPSBpc05hTihhY2N1cmFjeSkgPyAwIDogYWNjdXJhY3k7XG4gICAgICBzdGF0ZS5zY29yZS5zY29yZSA9IGlzTmFOKHN0YXRlLnNjb3JlLnNjb3JlKSA/IDAgOiBzdGF0ZS5zY29yZS5zY29yZTtcblxuICAgICAgaWYgKGFjY3VyYWN5ID49IDk1KSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnUyc7XG4gICAgICB9IGVsc2UgaWYgKGFjY3VyYWN5ID49IDkzKSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQSc7XG4gICAgICB9IGVsc2UgaWYgKGFjY3VyYWN5ID49IDkwKSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQS0nO1xuICAgICAgfSBlbHNlIGlmIChhY2N1cmFjeSA+PSA4OCkge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0IrJztcbiAgICAgIH0gZWxzZSBpZiAoYWNjdXJhY3kgPj0gODMpIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdCJztcbiAgICAgIH0gZWxzZSBpZiAoYWNjdXJhY3kgPj0gODApIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdCLSc7XG4gICAgICB9IGVsc2UgaWYgKGFjY3VyYWN5ID49IDc4KSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQysnO1xuICAgICAgfSBlbHNlIGlmIChhY2N1cmFjeSA+PSA3Mykge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0MnO1xuICAgICAgfSBlbHNlIGlmIChhY2N1cmFjeSA+PSA3MCkge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0MtJztcbiAgICAgIH0gZWxzZSBpZiAoYWNjdXJhY3kgPj0gNjApIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdEJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnRic7XG4gICAgICB9XG5cbiAgICAgIGNvbXB1dGVCZWF0c1RleHQoc3RhdGUpO1xuICAgIH0sXG5cbiAgICB2aWN0b3J5ZmFrZTogZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICBzdGF0ZS5zY29yZS5hY2N1cmFjeSA9ICc3NC45OSc7XG4gICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0MnO1xuICAgIH0sXG5cbiAgICB3YWxsaGl0c3RhcnQ6IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgdGFrZURhbWFnZShzdGF0ZSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBQb3N0LXByb2Nlc3MgdGhlIHN0YXRlIGFmdGVyIGVhY2ggYWN0aW9uLlxuICAgKi9cbiAgY29tcHV0ZVN0YXRlOiAoc3RhdGUpID0+IHtcbiAgICBzdGF0ZS5pc1BsYXlpbmcgPVxuICAgICAgIXN0YXRlLm1lbnVBY3RpdmUgJiYgIXN0YXRlLmlzUGF1c2VkICYmICFzdGF0ZS5pc1ZpY3RvcnkgJiYgIXN0YXRlLmlzR2FtZU92ZXIgJiZcbiAgICAgICFzdGF0ZS5jaGFsbGVuZ2UuaXNMb2FkaW5nICYmICFzdGF0ZS5pc1NvbmdMb2FkaW5nICYmICEhc3RhdGUuY2hhbGxlbmdlLmlkO1xuXG4gICAgY29uc3QgYW55TWVudU9wZW4gPSBzdGF0ZS5tZW51QWN0aXZlIHx8IHN0YXRlLmlzUGF1c2VkIHx8IHN0YXRlLmlzVmljdG9yeSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuaXNHYW1lT3ZlciB8fCBzdGF0ZS5pc1NvbmdMb2FkaW5nIHx8IHN0YXRlLmlzU29uZ0ZldGNoaW5nO1xuICAgIHN0YXRlLmxlZnRSYXljYXN0ZXJBY3RpdmUgPSBhbnlNZW51T3BlbiAmJiBzdGF0ZS5hY3RpdmVIYW5kID09PSAnbGVmdCcgJiYgc3RhdGUuaW5WUjtcbiAgICBzdGF0ZS5yaWdodFJheWNhc3RlckFjdGl2ZSA9IGFueU1lbnVPcGVuICYmIHN0YXRlLmFjdGl2ZUhhbmQgPT09ICdyaWdodCcgJiYgc3RhdGUuaW5WUjtcblxuICAgIC8vIFNvbmcgaXMgZGVjb2RpbmcgaWYgaXQgaXMgbG9hZGluZywgYnV0IG5vdCBmZXRjaGluZy5cbiAgICBpZiAoc3RhdGUuaXNTb25nTG9hZGluZykge1xuICAgICAgc3RhdGUubG9hZGluZ1RleHQgPSBzdGF0ZS5pc1NvbmdGZXRjaGluZyA/ICdEb3dubG9hZGluZyBzb25nLi4uJyA6ICdQcm9jZXNzaW5nIHNvbmcuLi4nO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGF0ZS5sb2FkaW5nVGV4dCA9ICcnO1xuICAgIH1cbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGNvbXB1dGVTZWFyY2hQYWdpbmF0aW9uIChzdGF0ZSkge1xuICBsZXQgbnVtUGFnZXMgPSBNYXRoLmNlaWwoc3RhdGUuc2VhcmNoLnJlc3VsdHMubGVuZ3RoIC8gU0VBUkNIX1BFUl9QQUdFKTtcbiAgc3RhdGUuc2VhcmNoLmhhc1ByZXYgPSBzdGF0ZS5zZWFyY2gucGFnZSA+IDA7XG4gIHN0YXRlLnNlYXJjaC5oYXNOZXh0ID0gc3RhdGUuc2VhcmNoLnBhZ2UgPCBudW1QYWdlcyAtIDE7XG5cbiAgc3RhdGUuc2VhcmNoLnNvbmdOYW1lVGV4dHMgPSAnJztcbiAgc3RhdGUuc2VhcmNoLnNvbmdTdWJOYW1lVGV4dHMgPSAnJztcblxuICBzdGF0ZS5zZWFyY2hSZXN1bHRzUGFnZS5sZW5ndGggPSAwO1xuICBzdGF0ZS5zZWFyY2hSZXN1bHRzUGFnZS5fX2RpcnR5ID0gdHJ1ZTtcbiAgZm9yIChsZXQgaSA9IHN0YXRlLnNlYXJjaC5wYWdlICogU0VBUkNIX1BFUl9QQUdFO1xuICAgICAgIGkgPCBzdGF0ZS5zZWFyY2gucGFnZSAqIFNFQVJDSF9QRVJfUEFHRSArIFNFQVJDSF9QRVJfUEFHRTsgaSsrKSB7XG4gICAgaWYgKCFzdGF0ZS5zZWFyY2gucmVzdWx0c1tpXSkgeyBicmVhazsgfVxuICAgIHN0YXRlLnNlYXJjaFJlc3VsdHNQYWdlLnB1c2goc3RhdGUuc2VhcmNoLnJlc3VsdHNbaV0pO1xuXG4gICAgc3RhdGUuc2VhcmNoLnNvbmdOYW1lVGV4dHMgKz1cbiAgICAgIHRydW5jYXRlKHN0YXRlLnNlYXJjaC5yZXN1bHRzW2ldLnNvbmdOYW1lLCBTT05HX05BTUVfVFJVTkNBVEUpLnRvVXBwZXJDYXNlKCkgKyAnXFxuJztcbiAgICBzdGF0ZS5zZWFyY2guc29uZ1N1Yk5hbWVUZXh0cyArPVxuICAgICAgdHJ1bmNhdGUoc3RhdGUuc2VhcmNoLnJlc3VsdHNbaV0uc29uZ1N1Yk5hbWUsIFNPTkdfU1VCX05BTUVfVFJVTkNBVEUpICsgJ1xcbic7XG4gIH1cblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlLnNlYXJjaFJlc3VsdHNQYWdlLmxlbmd0aDsgaSsrKSB7XG4gICAgc3RhdGUuc2VhcmNoUmVzdWx0c1BhZ2VbaV0uaW5kZXggPSBpO1xuICB9XG5cbiAgY29tcHV0ZU1lbnVTZWxlY3RlZENoYWxsZW5nZUluZGV4KHN0YXRlKTtcbn1cblxuZnVuY3Rpb24gdHJ1bmNhdGUgKHN0ciwgbGVuZ3RoKSB7XG4gIGlmICghc3RyKSB7IHJldHVybiAnJzsgfVxuICBpZiAoc3RyLmxlbmd0aCA+PSBsZW5ndGgpIHtcbiAgICByZXR1cm4gc3RyLnN1YnN0cmluZygwLCBsZW5ndGggLSAzKSArICcuLi4nO1xuICB9XG4gIHJldHVybiBzdHI7XG59XG5cbmNvbnN0IERJRkZJQ1VMVElFUyA9IFsnRWFzeScsICdOb3JtYWwnLCAnSGFyZCcsICdFeHBlcnQnLCAnRXhwZXJ0UGx1cyddO1xuZnVuY3Rpb24gZGlmZmljdWx0eUNvbXBhcmF0b3IgKGEsIGIpIHtcbiAgY29uc3QgYUluZGV4ID0gRElGRklDVUxUSUVTLmluZGV4T2YoYSk7XG4gIGNvbnN0IGJJbmRleCA9IERJRkZJQ1VMVElFUy5pbmRleE9mKGIpO1xuICBpZiAoYUluZGV4IDwgYkluZGV4KSB7IHJldHVybiAtMTsgfVxuICBpZiAoYUluZGV4ID4gYkluZGV4KSB7IHJldHVybiAxOyB9XG4gIHJldHVybiAwO1xufVxuXG5mdW5jdGlvbiB0YWtlRGFtYWdlIChzdGF0ZSkge1xuICBpZiAoIXN0YXRlLmlzUGxheWluZykgeyByZXR1cm47IH1cbiAgc3RhdGUuc2NvcmUuY29tYm8gPSAwO1xuICBzdGF0ZS5zY29yZS5tdWx0aXBsaWVyID0gc3RhdGUuc2NvcmUubXVsdGlwbGllciA+IDFcbiAgICA/IE1hdGguY2VpbChzdGF0ZS5zY29yZS5tdWx0aXBsaWVyIC8gMilcbiAgICA6IDE7XG4gIGlmIChBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdnb2Rtb2RlJykpIHsgcmV0dXJuOyB9XG4gIHN0YXRlLmRhbWFnZSsrO1xuICBjaGVja0dhbWVPdmVyKHN0YXRlKTtcbn1cblxuZnVuY3Rpb24gY2hlY2tHYW1lT3ZlciAoc3RhdGUpIHtcbiAgaWYgKHN0YXRlLmRhbWFnZSA+PSBEQU1BR0VfTUFYKSB7XG4gICAgc3RhdGUuZGFtYWdlID0gMDtcbiAgICBzdGF0ZS5pc0dhbWVPdmVyID0gdHJ1ZTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZXNldFNjb3JlIChzdGF0ZSkge1xuICBzdGF0ZS5kYW1hZ2UgPSAwO1xuICBzdGF0ZS5zY29yZS5iZWF0c0hpdCA9IDA7XG4gIHN0YXRlLnNjb3JlLmJlYXRzTWlzc2VkID0gMDtcbiAgc3RhdGUuc2NvcmUuY29tYm8gPSAwO1xuICBzdGF0ZS5zY29yZS5tYXhDb21ibyA9IDA7XG4gIHN0YXRlLnNjb3JlLnNjb3JlID0gMDtcbiAgc3RhdGUuc2NvcmUubXVsdGlwbGllciA9IDE7XG59XG5cbmZ1bmN0aW9uIGNvbXB1dGVNZW51U2VsZWN0ZWRDaGFsbGVuZ2VJbmRleCAoc3RhdGUpIHtcbiAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmluZGV4ID0gLTE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RhdGUuc2VhcmNoUmVzdWx0c1BhZ2UubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoc3RhdGUuc2VhcmNoUmVzdWx0c1BhZ2VbaV0uaWQgPT09IHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pZCkge1xuICAgICAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmluZGV4ID0gaTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBmb3JtYXRTb25nTGVuZ3RoIChzb25nTGVuZ3RoKSB7XG4gIHNvbmdMZW5ndGggLz0gNjA7XG4gIGNvbnN0IG1pbnV0ZXMgPSBgJHtNYXRoLmZsb29yKHNvbmdMZW5ndGgpfWA7XG4gIHJldHVybiBgJHttaW51dGVzfToke01hdGgucm91bmQoKHNvbmdMZW5ndGggLSBtaW51dGVzKSAqIDYwKX1gO1xufVxuXG5mdW5jdGlvbiBjb21wdXRlQmVhdHNUZXh0IChzdGF0ZSkge1xuICBzdGF0ZS5zY29yZS5iZWF0c1RleHQgPVxuICAgIGAke3N0YXRlLnNjb3JlLmJlYXRzSGl0fSAvICR7c3RhdGUuc2NvcmUuYmVhdHNNaXNzZWQgKyBzdGF0ZS5zY29yZS5iZWF0c0hpdH0gQkVBVFNgO1xufVxuXG5mdW5jdGlvbiBjbGVhckxlYWRlcmJvYXJkIChzdGF0ZSkge1xuICBzdGF0ZS5sZWFkZXJib2FyZC5sZW5ndGggPSAwO1xuICBzdGF0ZS5sZWFkZXJib2FyZC5fX2RpcnR5ID0gdHJ1ZTtcbiAgc3RhdGUubGVhZGVyYm9hcmROYW1lcyA9ICcnO1xuICBzdGF0ZS5sZWFkZXJib2FyZFNjb3JlcyA9ICcnO1xuICBzdGF0ZS5sZWFkZXJib2FyZEZldGNoZWQgPSBmYWxzZTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlTWVudVNvbmdJbmZvIChzdGF0ZSwgY2hhbGxlbmdlKSB7XG4gIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5zb25nSW5mb1RleHQgPSBgQnkgJHt0cnVuY2F0ZShjaGFsbGVuZ2UuYXV0aG9yLCAxMil9ICR7Y2hhbGxlbmdlLmdlbnJlICYmIGNoYWxsZW5nZS5nZW5yZSAhPT0gJ1VuY2F0ZWdvcml6ZWQnID8gJy8gJyArIGNoYWxsZW5nZS5nZW5yZSA6ICcnfVxcbiR7Y2hhbGxlbmdlLmRvd25sb2Fkc30gRG93bmxvYWRzXFxuVXB2b3RlczogJHtjaGFsbGVuZ2UudXB2b3Rlc30gLyBEb3dudm90ZXM6ICR7Y2hhbGxlbmdlLmRvd252b3Rlc31cXG4ke2Zvcm1hdFNvbmdMZW5ndGgoY2hhbGxlbmdlLnNvbmdEdXJhdGlvbil9IC8gJHtjaGFsbGVuZ2UubnVtQmVhdHNbc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmRpZmZpY3VsdHldfSBiZWF0c2A7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVNjb3JlQWNjdXJhY3kgKHN0YXRlKSB7XG4gIC8vIFVwZGF0ZSBsaXZlIGFjY3VyYWN5LlxuICBjb25zdCBjdXJyZW50TnVtQmVhdHMgPSBzdGF0ZS5zY29yZS5iZWF0c0hpdCArIHN0YXRlLnNjb3JlLmJlYXRzTWlzc2VkO1xuICBzdGF0ZS5zY29yZS5hY2N1cmFjeSA9IChzdGF0ZS5zY29yZS5zY29yZSAvIChjdXJyZW50TnVtQmVhdHMgKiAxMTApKSAqIDEwMDtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9zdGF0ZS9pbmRleC5qcyIsInZhciBlc2NhcGUgPSByZXF1aXJlKFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvbGliL3VybC9lc2NhcGUuanNcIik7XG5leHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvbGliL2Nzcy1iYXNlLmpzXCIpKGZhbHNlKTtcbi8vIGltcG9ydHNcblxuXG4vLyBtb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcImh0bWwge1xcbiAgYmFja2dyb3VuZDogIzAwMDtcXG59XFxuXFxuI3ZyQnV0dG9uIHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIGJhY2tncm91bmQ6IHVybChcIiArIGVzY2FwZShyZXF1aXJlKFwiLi4vYXNzZXRzL2ltZy9lbnRlci12ci1idXR0b24tYmFja2dyb3VuZC5wbmdcIikpICsgXCIpIG5vLXJlcGVhdDtcXG4gIGJhY2tncm91bmQtc2l6ZTogY292ZXI7XFxuICBib3JkZXI6IDA7XFxuICBjdXJzb3I6IHBvaW50ZXI7XFxuICByaWdodDogMjBweDtcXG4gIGJvdHRvbTogMjBweDtcXG4gIHotaW5kZXg6IDk5OTk5OTk7XFxuICB3aWR0aDogODRweDtcXG4gIGhlaWdodDogNDdweDtcXG59XFxuXFxuI3ZyQnV0dG9uLmEtaGlkZGVuIHtcXG4gIHZpc2liaWxpdHk6IGhpZGRlbjtcXG59XFxuXFxuI3ZyQnV0dG9uOmFjdGl2ZSB7XFxuICBib3JkZXI6IDA7XFxufVxcblxcbiN2ckJ1dHRvbjpob3ZlciB7XFxuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAwIC01MC41cHg7XFxufVxcblxcbi5hLWxvYWRlci10aXRsZSB7XFxuICBhbmltYXRpb246IGxvYWRlclRpdGxlIDFzIGluZmluaXRlIGFsdGVybmF0ZTtcXG4gIGNvbG9yOiByZ2JhKDAsMCwwLDApO1xcbiAgYmFja2dyb3VuZDogbm9uZTtcXG4gIGJhY2tncm91bmQtaW1hZ2U6IHVybChcIiArIGVzY2FwZShyZXF1aXJlKFwiLi4vYXNzZXRzL2ltZy9sb2FkaW5nTG9nby5qcGdcIikpICsgXCIpO1xcbiAgaGVpZ2h0OiAzNi4ydmg7XFxuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xcbiAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyO1xcbiAgbWFyZ2luLXRvcDogMDtcXG4gIGJhY2tncm91bmQtc2l6ZTogY29udGFpbjtcXG4gIG1hcmdpbi1sZWZ0OiAtMXZoO1xcbn1cXG5cXG5Aa2V5ZnJhbWVzIGxvYWRlclRpdGxlIHtcXG4gIDAlIHsgb3BhY2l0eTogMTsgfVxcbiAgNTAlIHsgb3BhY2l0eTogMC44OyB9XFxuICAxMDAlIHsgb3BhY2l0eTogMTsgfVxcbn1cXG5cXG4jdHV0b3JpYWwyZCB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB3aWR0aDogNjAlO1xcbiAgbGVmdDogMjAlO1xcbiAgdG9wOiAzNSU7XFxufVxcblxcbkBtZWRpYSAobWF4LXdpZHRoOiAxMjgwcHgpIHtcXG4gICN0dXRvcmlhbDJkIHtcXG4gICAgd2lkdGg6IDgwJTtcXG4gICAgbGVmdDogMTAlO1xcbiAgfVxcbn1cXG5cIiwgXCJcIl0pO1xuXG4vLyBleHBvcnRzXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vY3NzLWxvYWRlciEuL3NyYy9pbmRleC5jc3Ncbi8vIG1vZHVsZSBpZCA9IDEzNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKlxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxuXHRBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhXG4qL1xuLy8gY3NzIGJhc2UgY29kZSwgaW5qZWN0ZWQgYnkgdGhlIGNzcy1sb2FkZXJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odXNlU291cmNlTWFwKSB7XG5cdHZhciBsaXN0ID0gW107XG5cblx0Ly8gcmV0dXJuIHRoZSBsaXN0IG9mIG1vZHVsZXMgYXMgY3NzIHN0cmluZ1xuXHRsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG5cdFx0cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHR2YXIgY29udGVudCA9IGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKTtcblx0XHRcdGlmKGl0ZW1bMl0pIHtcblx0XHRcdFx0cmV0dXJuIFwiQG1lZGlhIFwiICsgaXRlbVsyXSArIFwie1wiICsgY29udGVudCArIFwifVwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGNvbnRlbnQ7XG5cdFx0XHR9XG5cdFx0fSkuam9pbihcIlwiKTtcblx0fTtcblxuXHQvLyBpbXBvcnQgYSBsaXN0IG9mIG1vZHVsZXMgaW50byB0aGUgbGlzdFxuXHRsaXN0LmkgPSBmdW5jdGlvbihtb2R1bGVzLCBtZWRpYVF1ZXJ5KSB7XG5cdFx0aWYodHlwZW9mIG1vZHVsZXMgPT09IFwic3RyaW5nXCIpXG5cdFx0XHRtb2R1bGVzID0gW1tudWxsLCBtb2R1bGVzLCBcIlwiXV07XG5cdFx0dmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGlkID0gdGhpc1tpXVswXTtcblx0XHRcdGlmKHR5cGVvZiBpZCA9PT0gXCJudW1iZXJcIilcblx0XHRcdFx0YWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xuXHRcdH1cblx0XHRmb3IoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgaXRlbSA9IG1vZHVsZXNbaV07XG5cdFx0XHQvLyBza2lwIGFscmVhZHkgaW1wb3J0ZWQgbW9kdWxlXG5cdFx0XHQvLyB0aGlzIGltcGxlbWVudGF0aW9uIGlzIG5vdCAxMDAlIHBlcmZlY3QgZm9yIHdlaXJkIG1lZGlhIHF1ZXJ5IGNvbWJpbmF0aW9uc1xuXHRcdFx0Ly8gIHdoZW4gYSBtb2R1bGUgaXMgaW1wb3J0ZWQgbXVsdGlwbGUgdGltZXMgd2l0aCBkaWZmZXJlbnQgbWVkaWEgcXVlcmllcy5cblx0XHRcdC8vICBJIGhvcGUgdGhpcyB3aWxsIG5ldmVyIG9jY3VyIChIZXkgdGhpcyB3YXkgd2UgaGF2ZSBzbWFsbGVyIGJ1bmRsZXMpXG5cdFx0XHRpZih0eXBlb2YgaXRlbVswXSAhPT0gXCJudW1iZXJcIiB8fCAhYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpdGVtWzBdXSkge1xuXHRcdFx0XHRpZihtZWRpYVF1ZXJ5ICYmICFpdGVtWzJdKSB7XG5cdFx0XHRcdFx0aXRlbVsyXSA9IG1lZGlhUXVlcnk7XG5cdFx0XHRcdH0gZWxzZSBpZihtZWRpYVF1ZXJ5KSB7XG5cdFx0XHRcdFx0aXRlbVsyXSA9IFwiKFwiICsgaXRlbVsyXSArIFwiKSBhbmQgKFwiICsgbWVkaWFRdWVyeSArIFwiKVwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGxpc3QucHVzaChpdGVtKTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cdHJldHVybiBsaXN0O1xufTtcblxuZnVuY3Rpb24gY3NzV2l0aE1hcHBpbmdUb1N0cmluZyhpdGVtLCB1c2VTb3VyY2VNYXApIHtcblx0dmFyIGNvbnRlbnQgPSBpdGVtWzFdIHx8ICcnO1xuXHR2YXIgY3NzTWFwcGluZyA9IGl0ZW1bM107XG5cdGlmICghY3NzTWFwcGluZykge1xuXHRcdHJldHVybiBjb250ZW50O1xuXHR9XG5cblx0aWYgKHVzZVNvdXJjZU1hcCAmJiB0eXBlb2YgYnRvYSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdHZhciBzb3VyY2VNYXBwaW5nID0gdG9Db21tZW50KGNzc01hcHBpbmcpO1xuXHRcdHZhciBzb3VyY2VVUkxzID0gY3NzTWFwcGluZy5zb3VyY2VzLm1hcChmdW5jdGlvbiAoc291cmNlKSB7XG5cdFx0XHRyZXR1cm4gJy8qIyBzb3VyY2VVUkw9JyArIGNzc01hcHBpbmcuc291cmNlUm9vdCArIHNvdXJjZSArICcgKi8nXG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gW2NvbnRlbnRdLmNvbmNhdChzb3VyY2VVUkxzKS5jb25jYXQoW3NvdXJjZU1hcHBpbmddKS5qb2luKCdcXG4nKTtcblx0fVxuXG5cdHJldHVybiBbY29udGVudF0uam9pbignXFxuJyk7XG59XG5cbi8vIEFkYXB0ZWQgZnJvbSBjb252ZXJ0LXNvdXJjZS1tYXAgKE1JVClcbmZ1bmN0aW9uIHRvQ29tbWVudChzb3VyY2VNYXApIHtcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG5cdHZhciBiYXNlNjQgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzb3VyY2VNYXApKSkpO1xuXHR2YXIgZGF0YSA9ICdzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCwnICsgYmFzZTY0O1xuXG5cdHJldHVybiAnLyojICcgKyBkYXRhICsgJyAqLyc7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcbi8vIG1vZHVsZSBpZCA9IDEzNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGVzY2FwZSh1cmwpIHtcbiAgICBpZiAodHlwZW9mIHVybCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIHVybFxuICAgIH1cbiAgICAvLyBJZiB1cmwgaXMgYWxyZWFkeSB3cmFwcGVkIGluIHF1b3RlcywgcmVtb3ZlIHRoZW1cbiAgICBpZiAoL15bJ1wiXS4qWydcIl0kLy50ZXN0KHVybCkpIHtcbiAgICAgICAgdXJsID0gdXJsLnNsaWNlKDEsIC0xKTtcbiAgICB9XG4gICAgLy8gU2hvdWxkIHVybCBiZSB3cmFwcGVkP1xuICAgIC8vIFNlZSBodHRwczovL2RyYWZ0cy5jc3N3Zy5vcmcvY3NzLXZhbHVlcy0zLyN1cmxzXG4gICAgaWYgKC9bXCInKCkgXFx0XFxuXS8udGVzdCh1cmwpKSB7XG4gICAgICAgIHJldHVybiAnXCInICsgdXJsLnJlcGxhY2UoL1wiL2csICdcXFxcXCInKS5yZXBsYWNlKC9cXG4vZywgJ1xcXFxuJykgKyAnXCInXG4gICAgfVxuXG4gICAgcmV0dXJuIHVybFxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2Nzcy1sb2FkZXIvbGliL3VybC9lc2NhcGUuanNcbi8vIG1vZHVsZSBpZCA9IDEzNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJcbi8qKlxuICogVGhpcyBpcyB0aGUgY29tbW9uIGxvZ2ljIGZvciBib3RoIHRoZSBOb2RlLmpzIGFuZCB3ZWIgYnJvd3NlclxuICogaW1wbGVtZW50YXRpb25zIG9mIGBkZWJ1ZygpYC5cbiAqXG4gKiBFeHBvc2UgYGRlYnVnKClgIGFzIHRoZSBtb2R1bGUuXG4gKi9cblxuZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZGVidWc7XG5leHBvcnRzLmNvZXJjZSA9IGNvZXJjZTtcbmV4cG9ydHMuZGlzYWJsZSA9IGRpc2FibGU7XG5leHBvcnRzLmVuYWJsZSA9IGVuYWJsZTtcbmV4cG9ydHMuZW5hYmxlZCA9IGVuYWJsZWQ7XG5cbi8qKlxuICogVGhlIGN1cnJlbnRseSBhY3RpdmUgZGVidWcgbW9kZSBuYW1lcywgYW5kIG5hbWVzIHRvIHNraXAuXG4gKi9cblxuZXhwb3J0cy5uYW1lcyA9IFtdO1xuZXhwb3J0cy5za2lwcyA9IFtdO1xuXG4vKipcbiAqIE1hcCBvZiBzcGVjaWFsIFwiJW5cIiBoYW5kbGluZyBmdW5jdGlvbnMsIGZvciB0aGUgZGVidWcgXCJmb3JtYXRcIiBhcmd1bWVudC5cbiAqXG4gKiBWYWxpZCBrZXkgbmFtZXMgYXJlIGEgc2luZ2xlLCBsb3dlcmNhc2VkIGxldHRlciwgaS5lLiBcIm5cIi5cbiAqL1xuXG5leHBvcnRzLmZvcm1hdHRlcnMgPSB7fTtcblxuLyoqXG4gKiBQcmV2aW91c2x5IGFzc2lnbmVkIGNvbG9yLlxuICovXG5cbnZhciBwcmV2Q29sb3IgPSAwO1xuXG4vKipcbiAqIFNlbGVjdCBhIGNvbG9yLlxuICpcbiAqIEByZXR1cm4ge051bWJlcn1cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIHNlbGVjdENvbG9yKCkge1xuICByZXR1cm4gZXhwb3J0cy5jb2xvcnNbcHJldkNvbG9yKysgJSBleHBvcnRzLmNvbG9ycy5sZW5ndGhdO1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIGRlYnVnZ2VyIHdpdGggdGhlIGdpdmVuIGBuYW1lc3BhY2VgLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2VcbiAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5mdW5jdGlvbiBkZWJ1ZyhuYW1lc3BhY2UpIHtcblxuICAvLyBkZWZpbmUgdGhlIGBkaXNhYmxlZGAgdmVyc2lvblxuICBmdW5jdGlvbiBkaXNhYmxlZCgpIHtcbiAgfVxuICBkaXNhYmxlZC5lbmFibGVkID0gZmFsc2U7XG5cbiAgLy8gZGVmaW5lIHRoZSBgZW5hYmxlZGAgdmVyc2lvblxuICBmdW5jdGlvbiBlbmFibGVkKCkge1xuXG4gICAgdmFyIHNlbGYgPSBlbmFibGVkO1xuXG4gICAgLy8gYWRkIHRoZSBgY29sb3JgIGlmIG5vdCBzZXRcbiAgICBpZiAobnVsbCA9PSBzZWxmLnVzZUNvbG9ycykgc2VsZi51c2VDb2xvcnMgPSBleHBvcnRzLnVzZUNvbG9ycygpO1xuICAgIGlmIChudWxsID09IHNlbGYuY29sb3IgJiYgc2VsZi51c2VDb2xvcnMpIHNlbGYuY29sb3IgPSBzZWxlY3RDb2xvcigpO1xuXG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuXG4gICAgYXJnc1swXSA9IGV4cG9ydHMuY29lcmNlKGFyZ3NbMF0pO1xuXG4gICAgaWYgKCdzdHJpbmcnICE9PSB0eXBlb2YgYXJnc1swXSkge1xuICAgICAgLy8gYW55dGhpbmcgZWxzZSBsZXQncyBpbnNwZWN0IHdpdGggJW9cbiAgICAgIGFyZ3MgPSBbJyVvJ10uY29uY2F0KGFyZ3MpO1xuICAgIH1cblxuICAgIC8vIGFwcGx5IGFueSBgZm9ybWF0dGVyc2AgdHJhbnNmb3JtYXRpb25zXG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICBhcmdzWzBdID0gYXJnc1swXS5yZXBsYWNlKC8lKFthLXolXSkvZywgZnVuY3Rpb24obWF0Y2gsIGZvcm1hdCkge1xuICAgICAgLy8gaWYgd2UgZW5jb3VudGVyIGFuIGVzY2FwZWQgJSB0aGVuIGRvbid0IGluY3JlYXNlIHRoZSBhcnJheSBpbmRleFxuICAgICAgaWYgKG1hdGNoID09PSAnJSUnKSByZXR1cm4gbWF0Y2g7XG4gICAgICBpbmRleCsrO1xuICAgICAgdmFyIGZvcm1hdHRlciA9IGV4cG9ydHMuZm9ybWF0dGVyc1tmb3JtYXRdO1xuICAgICAgaWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBmb3JtYXR0ZXIpIHtcbiAgICAgICAgdmFyIHZhbCA9IGFyZ3NbaW5kZXhdO1xuICAgICAgICBtYXRjaCA9IGZvcm1hdHRlci5jYWxsKHNlbGYsIHZhbCk7XG5cbiAgICAgICAgLy8gbm93IHdlIG5lZWQgdG8gcmVtb3ZlIGBhcmdzW2luZGV4XWAgc2luY2UgaXQncyBpbmxpbmVkIGluIHRoZSBgZm9ybWF0YFxuICAgICAgICBhcmdzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIGluZGV4LS07XG4gICAgICB9XG4gICAgICByZXR1cm4gbWF0Y2g7XG4gICAgfSk7XG5cbiAgICBpZiAoJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIGV4cG9ydHMuZm9ybWF0QXJncykge1xuICAgICAgYXJncyA9IGV4cG9ydHMuZm9ybWF0QXJncy5hcHBseShzZWxmLCBhcmdzKTtcbiAgICB9XG4gICAgdmFyIGxvZ0ZuID0gZW5hYmxlZC5sb2cgfHwgZXhwb3J0cy5sb2cgfHwgY29uc29sZS5sb2cuYmluZChjb25zb2xlKTtcbiAgICBsb2dGbi5hcHBseShzZWxmLCBhcmdzKTtcbiAgfVxuICBlbmFibGVkLmVuYWJsZWQgPSB0cnVlO1xuXG4gIHZhciBmbiA9IGV4cG9ydHMuZW5hYmxlZChuYW1lc3BhY2UpID8gZW5hYmxlZCA6IGRpc2FibGVkO1xuXG4gIGZuLm5hbWVzcGFjZSA9IG5hbWVzcGFjZTtcblxuICByZXR1cm4gZm47XG59XG5cbi8qKlxuICogRW5hYmxlcyBhIGRlYnVnIG1vZGUgYnkgbmFtZXNwYWNlcy4gVGhpcyBjYW4gaW5jbHVkZSBtb2Rlc1xuICogc2VwYXJhdGVkIGJ5IGEgY29sb24gYW5kIHdpbGRjYXJkcy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlc1xuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5mdW5jdGlvbiBlbmFibGUobmFtZXNwYWNlcykge1xuICBleHBvcnRzLnNhdmUobmFtZXNwYWNlcyk7XG5cbiAgdmFyIHNwbGl0ID0gKG5hbWVzcGFjZXMgfHwgJycpLnNwbGl0KC9bXFxzLF0rLyk7XG4gIHZhciBsZW4gPSBzcGxpdC5sZW5ndGg7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgIGlmICghc3BsaXRbaV0pIGNvbnRpbnVlOyAvLyBpZ25vcmUgZW1wdHkgc3RyaW5nc1xuICAgIG5hbWVzcGFjZXMgPSBzcGxpdFtpXS5yZXBsYWNlKC9cXCovZywgJy4qPycpO1xuICAgIGlmIChuYW1lc3BhY2VzWzBdID09PSAnLScpIHtcbiAgICAgIGV4cG9ydHMuc2tpcHMucHVzaChuZXcgUmVnRXhwKCdeJyArIG5hbWVzcGFjZXMuc3Vic3RyKDEpICsgJyQnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4cG9ydHMubmFtZXMucHVzaChuZXcgUmVnRXhwKCdeJyArIG5hbWVzcGFjZXMgKyAnJCcpKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBEaXNhYmxlIGRlYnVnIG91dHB1dC5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbmZ1bmN0aW9uIGRpc2FibGUoKSB7XG4gIGV4cG9ydHMuZW5hYmxlKCcnKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIG1vZGUgbmFtZSBpcyBlbmFibGVkLCBmYWxzZSBvdGhlcndpc2UuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAqIEByZXR1cm4ge0Jvb2xlYW59XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbmZ1bmN0aW9uIGVuYWJsZWQobmFtZSkge1xuICB2YXIgaSwgbGVuO1xuICBmb3IgKGkgPSAwLCBsZW4gPSBleHBvcnRzLnNraXBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgaWYgKGV4cG9ydHMuc2tpcHNbaV0udGVzdChuYW1lKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBmb3IgKGkgPSAwLCBsZW4gPSBleHBvcnRzLm5hbWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgaWYgKGV4cG9ydHMubmFtZXNbaV0udGVzdChuYW1lKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBDb2VyY2UgYHZhbGAuXG4gKlxuICogQHBhcmFtIHtNaXhlZH0gdmFsXG4gKiBAcmV0dXJuIHtNaXhlZH1cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIGNvZXJjZSh2YWwpIHtcbiAgaWYgKHZhbCBpbnN0YW5jZW9mIEVycm9yKSByZXR1cm4gdmFsLnN0YWNrIHx8IHZhbC5tZXNzYWdlO1xuICByZXR1cm4gdmFsO1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2RlYnVnL2RlYnVnLmpzXG4vLyBtb2R1bGUgaWQgPSAxMzdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyohXG4gKiBAb3ZlcnZpZXcgZXM2LXByb21pc2UgLSBhIHRpbnkgaW1wbGVtZW50YXRpb24gb2YgUHJvbWlzZXMvQSsuXG4gKiBAY29weXJpZ2h0IENvcHlyaWdodCAoYykgMjAxNCBZZWh1ZGEgS2F0eiwgVG9tIERhbGUsIFN0ZWZhbiBQZW5uZXIgYW5kIGNvbnRyaWJ1dG9ycyAoQ29udmVyc2lvbiB0byBFUzYgQVBJIGJ5IEpha2UgQXJjaGliYWxkKVxuICogQGxpY2Vuc2UgICBMaWNlbnNlZCB1bmRlciBNSVQgbGljZW5zZVxuICogICAgICAgICAgICBTZWUgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3N0ZWZhbnBlbm5lci9lczYtcHJvbWlzZS9tYXN0ZXIvTElDRU5TRVxuICogQHZlcnNpb24gICB2NC4yLjQrMzE0ZTQ4MzFcbiAqL1xuXG4oZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG5cdChnbG9iYWwuRVM2UHJvbWlzZSA9IGZhY3RvcnkoKSk7XG59KHRoaXMsIChmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gb2JqZWN0T3JGdW5jdGlvbih4KSB7XG4gIHZhciB0eXBlID0gdHlwZW9mIHg7XG4gIHJldHVybiB4ICE9PSBudWxsICYmICh0eXBlID09PSAnb2JqZWN0JyB8fCB0eXBlID09PSAnZnVuY3Rpb24nKTtcbn1cblxuZnVuY3Rpb24gaXNGdW5jdGlvbih4KSB7XG4gIHJldHVybiB0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJztcbn1cblxuXG5cbnZhciBfaXNBcnJheSA9IHZvaWQgMDtcbmlmIChBcnJheS5pc0FycmF5KSB7XG4gIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcbn0gZWxzZSB7XG4gIF9pc0FycmF5ID0gZnVuY3Rpb24gKHgpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHgpID09PSAnW29iamVjdCBBcnJheV0nO1xuICB9O1xufVxuXG52YXIgaXNBcnJheSA9IF9pc0FycmF5O1xuXG52YXIgbGVuID0gMDtcbnZhciB2ZXJ0eE5leHQgPSB2b2lkIDA7XG52YXIgY3VzdG9tU2NoZWR1bGVyRm4gPSB2b2lkIDA7XG5cbnZhciBhc2FwID0gZnVuY3Rpb24gYXNhcChjYWxsYmFjaywgYXJnKSB7XG4gIHF1ZXVlW2xlbl0gPSBjYWxsYmFjaztcbiAgcXVldWVbbGVuICsgMV0gPSBhcmc7XG4gIGxlbiArPSAyO1xuICBpZiAobGVuID09PSAyKSB7XG4gICAgLy8gSWYgbGVuIGlzIDIsIHRoYXQgbWVhbnMgdGhhdCB3ZSBuZWVkIHRvIHNjaGVkdWxlIGFuIGFzeW5jIGZsdXNoLlxuICAgIC8vIElmIGFkZGl0aW9uYWwgY2FsbGJhY2tzIGFyZSBxdWV1ZWQgYmVmb3JlIHRoZSBxdWV1ZSBpcyBmbHVzaGVkLCB0aGV5XG4gICAgLy8gd2lsbCBiZSBwcm9jZXNzZWQgYnkgdGhpcyBmbHVzaCB0aGF0IHdlIGFyZSBzY2hlZHVsaW5nLlxuICAgIGlmIChjdXN0b21TY2hlZHVsZXJGbikge1xuICAgICAgY3VzdG9tU2NoZWR1bGVyRm4oZmx1c2gpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzY2hlZHVsZUZsdXNoKCk7XG4gICAgfVxuICB9XG59O1xuXG5mdW5jdGlvbiBzZXRTY2hlZHVsZXIoc2NoZWR1bGVGbikge1xuICBjdXN0b21TY2hlZHVsZXJGbiA9IHNjaGVkdWxlRm47XG59XG5cbmZ1bmN0aW9uIHNldEFzYXAoYXNhcEZuKSB7XG4gIGFzYXAgPSBhc2FwRm47XG59XG5cbnZhciBicm93c2VyV2luZG93ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB1bmRlZmluZWQ7XG52YXIgYnJvd3Nlckdsb2JhbCA9IGJyb3dzZXJXaW5kb3cgfHwge307XG52YXIgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIgPSBicm93c2VyR2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgYnJvd3Nlckdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyO1xudmFyIGlzTm9kZSA9IHR5cGVvZiBzZWxmID09PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYge30udG9TdHJpbmcuY2FsbChwcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nO1xuXG4vLyB0ZXN0IGZvciB3ZWIgd29ya2VyIGJ1dCBub3QgaW4gSUUxMFxudmFyIGlzV29ya2VyID0gdHlwZW9mIFVpbnQ4Q2xhbXBlZEFycmF5ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgaW1wb3J0U2NyaXB0cyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIE1lc3NhZ2VDaGFubmVsICE9PSAndW5kZWZpbmVkJztcblxuLy8gbm9kZVxuZnVuY3Rpb24gdXNlTmV4dFRpY2soKSB7XG4gIC8vIG5vZGUgdmVyc2lvbiAwLjEwLnggZGlzcGxheXMgYSBkZXByZWNhdGlvbiB3YXJuaW5nIHdoZW4gbmV4dFRpY2sgaXMgdXNlZCByZWN1cnNpdmVseVxuICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2N1am9qcy93aGVuL2lzc3Vlcy80MTAgZm9yIGRldGFpbHNcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7XG4gIH07XG59XG5cbi8vIHZlcnR4XG5mdW5jdGlvbiB1c2VWZXJ0eFRpbWVyKCkge1xuICBpZiAodHlwZW9mIHZlcnR4TmV4dCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdmVydHhOZXh0KGZsdXNoKTtcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIHVzZVNldFRpbWVvdXQoKTtcbn1cblxuZnVuY3Rpb24gdXNlTXV0YXRpb25PYnNlcnZlcigpIHtcbiAgdmFyIGl0ZXJhdGlvbnMgPSAwO1xuICB2YXIgb2JzZXJ2ZXIgPSBuZXcgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIoZmx1c2gpO1xuICB2YXIgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTtcbiAgb2JzZXJ2ZXIub2JzZXJ2ZShub2RlLCB7IGNoYXJhY3RlckRhdGE6IHRydWUgfSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBub2RlLmRhdGEgPSBpdGVyYXRpb25zID0gKytpdGVyYXRpb25zICUgMjtcbiAgfTtcbn1cblxuLy8gd2ViIHdvcmtlclxuZnVuY3Rpb24gdXNlTWVzc2FnZUNoYW5uZWwoKSB7XG4gIHZhciBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG4gIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZmx1c2g7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoMCk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHVzZVNldFRpbWVvdXQoKSB7XG4gIC8vIFN0b3JlIHNldFRpbWVvdXQgcmVmZXJlbmNlIHNvIGVzNi1wcm9taXNlIHdpbGwgYmUgdW5hZmZlY3RlZCBieVxuICAvLyBvdGhlciBjb2RlIG1vZGlmeWluZyBzZXRUaW1lb3V0IChsaWtlIHNpbm9uLnVzZUZha2VUaW1lcnMoKSlcbiAgdmFyIGdsb2JhbFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBnbG9iYWxTZXRUaW1lb3V0KGZsdXNoLCAxKTtcbiAgfTtcbn1cblxudmFyIHF1ZXVlID0gbmV3IEFycmF5KDEwMDApO1xuZnVuY3Rpb24gZmx1c2goKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDIpIHtcbiAgICB2YXIgY2FsbGJhY2sgPSBxdWV1ZVtpXTtcbiAgICB2YXIgYXJnID0gcXVldWVbaSArIDFdO1xuXG4gICAgY2FsbGJhY2soYXJnKTtcblxuICAgIHF1ZXVlW2ldID0gdW5kZWZpbmVkO1xuICAgIHF1ZXVlW2kgKyAxXSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGxlbiA9IDA7XG59XG5cbmZ1bmN0aW9uIGF0dGVtcHRWZXJ0eCgpIHtcbiAgdHJ5IHtcbiAgICB2YXIgdmVydHggPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpLnJlcXVpcmUoJ3ZlcnR4Jyk7XG4gICAgdmVydHhOZXh0ID0gdmVydHgucnVuT25Mb29wIHx8IHZlcnR4LnJ1bk9uQ29udGV4dDtcbiAgICByZXR1cm4gdXNlVmVydHhUaW1lcigpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHVzZVNldFRpbWVvdXQoKTtcbiAgfVxufVxuXG52YXIgc2NoZWR1bGVGbHVzaCA9IHZvaWQgMDtcbi8vIERlY2lkZSB3aGF0IGFzeW5jIG1ldGhvZCB0byB1c2UgdG8gdHJpZ2dlcmluZyBwcm9jZXNzaW5nIG9mIHF1ZXVlZCBjYWxsYmFja3M6XG5pZiAoaXNOb2RlKSB7XG4gIHNjaGVkdWxlRmx1c2ggPSB1c2VOZXh0VGljaygpO1xufSBlbHNlIGlmIChCcm93c2VyTXV0YXRpb25PYnNlcnZlcikge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlTXV0YXRpb25PYnNlcnZlcigpO1xufSBlbHNlIGlmIChpc1dvcmtlcikge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlTWVzc2FnZUNoYW5uZWwoKTtcbn0gZWxzZSBpZiAoYnJvd3NlcldpbmRvdyA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiByZXF1aXJlID09PSAnZnVuY3Rpb24nKSB7XG4gIHNjaGVkdWxlRmx1c2ggPSBhdHRlbXB0VmVydHgoKTtcbn0gZWxzZSB7XG4gIHNjaGVkdWxlRmx1c2ggPSB1c2VTZXRUaW1lb3V0KCk7XG59XG5cbmZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcbiAgdmFyIHBhcmVudCA9IHRoaXM7XG5cbiAgdmFyIGNoaWxkID0gbmV3IHRoaXMuY29uc3RydWN0b3Iobm9vcCk7XG5cbiAgaWYgKGNoaWxkW1BST01JU0VfSURdID09PSB1bmRlZmluZWQpIHtcbiAgICBtYWtlUHJvbWlzZShjaGlsZCk7XG4gIH1cblxuICB2YXIgX3N0YXRlID0gcGFyZW50Ll9zdGF0ZTtcblxuXG4gIGlmIChfc3RhdGUpIHtcbiAgICB2YXIgY2FsbGJhY2sgPSBhcmd1bWVudHNbX3N0YXRlIC0gMV07XG4gICAgYXNhcChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gaW52b2tlQ2FsbGJhY2soX3N0YXRlLCBjaGlsZCwgY2FsbGJhY2ssIHBhcmVudC5fcmVzdWx0KTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pO1xuICB9XG5cbiAgcmV0dXJuIGNoaWxkO1xufVxuXG4vKipcbiAgYFByb21pc2UucmVzb2x2ZWAgcmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIGJlY29tZSByZXNvbHZlZCB3aXRoIHRoZVxuICBwYXNzZWQgYHZhbHVlYC4gSXQgaXMgc2hvcnRoYW5kIGZvciB0aGUgZm9sbG93aW5nOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHJlc29sdmUoMSk7XG4gIH0pO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gdmFsdWUgPT09IDFcbiAgfSk7XG4gIGBgYFxuXG4gIEluc3RlYWQgb2Ygd3JpdGluZyB0aGUgYWJvdmUsIHlvdXIgY29kZSBub3cgc2ltcGx5IGJlY29tZXMgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKDEpO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gdmFsdWUgPT09IDFcbiAgfSk7XG4gIGBgYFxuXG4gIEBtZXRob2QgcmVzb2x2ZVxuICBAc3RhdGljXG4gIEBwYXJhbSB7QW55fSB2YWx1ZSB2YWx1ZSB0aGF0IHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGwgYmUgcmVzb2x2ZWQgd2l0aFxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSB0aGF0IHdpbGwgYmVjb21lIGZ1bGZpbGxlZCB3aXRoIHRoZSBnaXZlblxuICBgdmFsdWVgXG4qL1xuZnVuY3Rpb24gcmVzb2x2ZSQxKG9iamVjdCkge1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXG4gIGlmIChvYmplY3QgJiYgdHlwZW9mIG9iamVjdCA9PT0gJ29iamVjdCcgJiYgb2JqZWN0LmNvbnN0cnVjdG9yID09PSBDb25zdHJ1Y3Rvcikge1xuICAgIHJldHVybiBvYmplY3Q7XG4gIH1cblxuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcbiAgcmVzb2x2ZShwcm9taXNlLCBvYmplY3QpO1xuICByZXR1cm4gcHJvbWlzZTtcbn1cblxudmFyIFBST01JU0VfSUQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMik7XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG52YXIgUEVORElORyA9IHZvaWQgMDtcbnZhciBGVUxGSUxMRUQgPSAxO1xudmFyIFJFSkVDVEVEID0gMjtcblxudmFyIFRSWV9DQVRDSF9FUlJPUiA9IHsgZXJyb3I6IG51bGwgfTtcblxuZnVuY3Rpb24gc2VsZkZ1bGZpbGxtZW50KCkge1xuICByZXR1cm4gbmV3IFR5cGVFcnJvcihcIllvdSBjYW5ub3QgcmVzb2x2ZSBhIHByb21pc2Ugd2l0aCBpdHNlbGZcIik7XG59XG5cbmZ1bmN0aW9uIGNhbm5vdFJldHVybk93bigpIHtcbiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoJ0EgcHJvbWlzZXMgY2FsbGJhY2sgY2Fubm90IHJldHVybiB0aGF0IHNhbWUgcHJvbWlzZS4nKTtcbn1cblxuZnVuY3Rpb24gZ2V0VGhlbihwcm9taXNlKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHByb21pc2UudGhlbjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBUUllfQ0FUQ0hfRVJST1IuZXJyb3IgPSBlcnJvcjtcbiAgICByZXR1cm4gVFJZX0NBVENIX0VSUk9SO1xuICB9XG59XG5cbmZ1bmN0aW9uIHRyeVRoZW4odGhlbiQkMSwgdmFsdWUsIGZ1bGZpbGxtZW50SGFuZGxlciwgcmVqZWN0aW9uSGFuZGxlcikge1xuICB0cnkge1xuICAgIHRoZW4kJDEuY2FsbCh2YWx1ZSwgZnVsZmlsbG1lbnRIYW5kbGVyLCByZWplY3Rpb25IYW5kbGVyKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUZvcmVpZ25UaGVuYWJsZShwcm9taXNlLCB0aGVuYWJsZSwgdGhlbiQkMSkge1xuICBhc2FwKGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gICAgdmFyIHNlYWxlZCA9IGZhbHNlO1xuICAgIHZhciBlcnJvciA9IHRyeVRoZW4odGhlbiQkMSwgdGhlbmFibGUsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgaWYgKHNlYWxlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzZWFsZWQgPSB0cnVlO1xuICAgICAgaWYgKHRoZW5hYmxlICE9PSB2YWx1ZSkge1xuICAgICAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGlmIChzZWFsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2VhbGVkID0gdHJ1ZTtcblxuICAgICAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gICAgfSwgJ1NldHRsZTogJyArIChwcm9taXNlLl9sYWJlbCB8fCAnIHVua25vd24gcHJvbWlzZScpKTtcblxuICAgIGlmICghc2VhbGVkICYmIGVycm9yKSB7XG4gICAgICBzZWFsZWQgPSB0cnVlO1xuICAgICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTtcbiAgICB9XG4gIH0sIHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCB0aGVuYWJsZSkge1xuICBpZiAodGhlbmFibGUuX3N0YXRlID09PSBGVUxGSUxMRUQpIHtcbiAgICBmdWxmaWxsKHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuICB9IGVsc2UgaWYgKHRoZW5hYmxlLl9zdGF0ZSA9PT0gUkVKRUNURUQpIHtcbiAgICByZWplY3QocHJvbWlzZSwgdGhlbmFibGUuX3Jlc3VsdCk7XG4gIH0gZWxzZSB7XG4gICAgc3Vic2NyaWJlKHRoZW5hYmxlLCB1bmRlZmluZWQsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIHJldHVybiByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUsIHRoZW4kJDEpIHtcbiAgaWYgKG1heWJlVGhlbmFibGUuY29uc3RydWN0b3IgPT09IHByb21pc2UuY29uc3RydWN0b3IgJiYgdGhlbiQkMSA9PT0gdGhlbiAmJiBtYXliZVRoZW5hYmxlLmNvbnN0cnVjdG9yLnJlc29sdmUgPT09IHJlc29sdmUkMSkge1xuICAgIGhhbmRsZU93blRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUpO1xuICB9IGVsc2Uge1xuICAgIGlmICh0aGVuJCQxID09PSBUUllfQ0FUQ0hfRVJST1IpIHtcbiAgICAgIHJlamVjdChwcm9taXNlLCBUUllfQ0FUQ0hfRVJST1IuZXJyb3IpO1xuICAgICAgVFJZX0NBVENIX0VSUk9SLmVycm9yID0gbnVsbDtcbiAgICB9IGVsc2UgaWYgKHRoZW4kJDEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgZnVsZmlsbChwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgICB9IGVsc2UgaWYgKGlzRnVuY3Rpb24odGhlbiQkMSkpIHtcbiAgICAgIGhhbmRsZUZvcmVpZ25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlLCB0aGVuJCQxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZnVsZmlsbChwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSkge1xuICBpZiAocHJvbWlzZSA9PT0gdmFsdWUpIHtcbiAgICByZWplY3QocHJvbWlzZSwgc2VsZkZ1bGZpbGxtZW50KCkpO1xuICB9IGVsc2UgaWYgKG9iamVjdE9yRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCB2YWx1ZSwgZ2V0VGhlbih2YWx1ZSkpO1xuICB9IGVsc2Uge1xuICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2hSZWplY3Rpb24ocHJvbWlzZSkge1xuICBpZiAocHJvbWlzZS5fb25lcnJvcikge1xuICAgIHByb21pc2UuX29uZXJyb3IocHJvbWlzZS5fcmVzdWx0KTtcbiAgfVxuXG4gIHB1Ymxpc2gocHJvbWlzZSk7XG59XG5cbmZ1bmN0aW9uIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpIHtcbiAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcHJvbWlzZS5fcmVzdWx0ID0gdmFsdWU7XG4gIHByb21pc2UuX3N0YXRlID0gRlVMRklMTEVEO1xuXG4gIGlmIChwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggIT09IDApIHtcbiAgICBhc2FwKHB1Ymxpc2gsIHByb21pc2UpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlamVjdChwcm9taXNlLCByZWFzb24pIHtcbiAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHByb21pc2UuX3N0YXRlID0gUkVKRUNURUQ7XG4gIHByb21pc2UuX3Jlc3VsdCA9IHJlYXNvbjtcblxuICBhc2FwKHB1Ymxpc2hSZWplY3Rpb24sIHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcbiAgdmFyIF9zdWJzY3JpYmVycyA9IHBhcmVudC5fc3Vic2NyaWJlcnM7XG4gIHZhciBsZW5ndGggPSBfc3Vic2NyaWJlcnMubGVuZ3RoO1xuXG5cbiAgcGFyZW50Ll9vbmVycm9yID0gbnVsbDtcblxuICBfc3Vic2NyaWJlcnNbbGVuZ3RoXSA9IGNoaWxkO1xuICBfc3Vic2NyaWJlcnNbbGVuZ3RoICsgRlVMRklMTEVEXSA9IG9uRnVsZmlsbG1lbnQ7XG4gIF9zdWJzY3JpYmVyc1tsZW5ndGggKyBSRUpFQ1RFRF0gPSBvblJlamVjdGlvbjtcblxuICBpZiAobGVuZ3RoID09PSAwICYmIHBhcmVudC5fc3RhdGUpIHtcbiAgICBhc2FwKHB1Ymxpc2gsIHBhcmVudCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcHVibGlzaChwcm9taXNlKSB7XG4gIHZhciBzdWJzY3JpYmVycyA9IHByb21pc2UuX3N1YnNjcmliZXJzO1xuICB2YXIgc2V0dGxlZCA9IHByb21pc2UuX3N0YXRlO1xuXG4gIGlmIChzdWJzY3JpYmVycy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY2hpbGQgPSB2b2lkIDAsXG4gICAgICBjYWxsYmFjayA9IHZvaWQgMCxcbiAgICAgIGRldGFpbCA9IHByb21pc2UuX3Jlc3VsdDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YnNjcmliZXJzLmxlbmd0aDsgaSArPSAzKSB7XG4gICAgY2hpbGQgPSBzdWJzY3JpYmVyc1tpXTtcbiAgICBjYWxsYmFjayA9IHN1YnNjcmliZXJzW2kgKyBzZXR0bGVkXTtcblxuICAgIGlmIChjaGlsZCkge1xuICAgICAgaW52b2tlQ2FsbGJhY2soc2V0dGxlZCwgY2hpbGQsIGNhbGxiYWNrLCBkZXRhaWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYWxsYmFjayhkZXRhaWwpO1xuICAgIH1cbiAgfVxuXG4gIHByb21pc2UuX3N1YnNjcmliZXJzLmxlbmd0aCA9IDA7XG59XG5cbmZ1bmN0aW9uIHRyeUNhdGNoKGNhbGxiYWNrLCBkZXRhaWwpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gY2FsbGJhY2soZGV0YWlsKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIFRSWV9DQVRDSF9FUlJPUi5lcnJvciA9IGU7XG4gICAgcmV0dXJuIFRSWV9DQVRDSF9FUlJPUjtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbnZva2VDYWxsYmFjayhzZXR0bGVkLCBwcm9taXNlLCBjYWxsYmFjaywgZGV0YWlsKSB7XG4gIHZhciBoYXNDYWxsYmFjayA9IGlzRnVuY3Rpb24oY2FsbGJhY2spLFxuICAgICAgdmFsdWUgPSB2b2lkIDAsXG4gICAgICBlcnJvciA9IHZvaWQgMCxcbiAgICAgIHN1Y2NlZWRlZCA9IHZvaWQgMCxcbiAgICAgIGZhaWxlZCA9IHZvaWQgMDtcblxuICBpZiAoaGFzQ2FsbGJhY2spIHtcbiAgICB2YWx1ZSA9IHRyeUNhdGNoKGNhbGxiYWNrLCBkZXRhaWwpO1xuXG4gICAgaWYgKHZhbHVlID09PSBUUllfQ0FUQ0hfRVJST1IpIHtcbiAgICAgIGZhaWxlZCA9IHRydWU7XG4gICAgICBlcnJvciA9IHZhbHVlLmVycm9yO1xuICAgICAgdmFsdWUuZXJyb3IgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdWNjZWVkZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChwcm9taXNlID09PSB2YWx1ZSkge1xuICAgICAgcmVqZWN0KHByb21pc2UsIGNhbm5vdFJldHVybk93bigpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdmFsdWUgPSBkZXRhaWw7XG4gICAgc3VjY2VlZGVkID0gdHJ1ZTtcbiAgfVxuXG4gIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuICAgIC8vIG5vb3BcbiAgfSBlbHNlIGlmIChoYXNDYWxsYmFjayAmJiBzdWNjZWVkZWQpIHtcbiAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgfSBlbHNlIGlmIChmYWlsZWQpIHtcbiAgICByZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuICB9IGVsc2UgaWYgKHNldHRsZWQgPT09IEZVTEZJTExFRCkge1xuICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICB9IGVsc2UgaWYgKHNldHRsZWQgPT09IFJFSkVDVEVEKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbml0aWFsaXplUHJvbWlzZShwcm9taXNlLCByZXNvbHZlcikge1xuICB0cnkge1xuICAgIHJlc29sdmVyKGZ1bmN0aW9uIHJlc29sdmVQcm9taXNlKHZhbHVlKSB7XG4gICAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICB9LCBmdW5jdGlvbiByZWplY3RQcm9taXNlKHJlYXNvbikge1xuICAgICAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZWplY3QocHJvbWlzZSwgZSk7XG4gIH1cbn1cblxudmFyIGlkID0gMDtcbmZ1bmN0aW9uIG5leHRJZCgpIHtcbiAgcmV0dXJuIGlkKys7XG59XG5cbmZ1bmN0aW9uIG1ha2VQcm9taXNlKHByb21pc2UpIHtcbiAgcHJvbWlzZVtQUk9NSVNFX0lEXSA9IGlkKys7XG4gIHByb21pc2UuX3N0YXRlID0gdW5kZWZpbmVkO1xuICBwcm9taXNlLl9yZXN1bHQgPSB1bmRlZmluZWQ7XG4gIHByb21pc2UuX3N1YnNjcmliZXJzID0gW107XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRpb25FcnJvcigpIHtcbiAgcmV0dXJuIG5ldyBFcnJvcignQXJyYXkgTWV0aG9kcyBtdXN0IGJlIHByb3ZpZGVkIGFuIEFycmF5Jyk7XG59XG5cbnZhciBFbnVtZXJhdG9yID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBFbnVtZXJhdG9yKENvbnN0cnVjdG9yLCBpbnB1dCkge1xuICAgIHRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3IgPSBDb25zdHJ1Y3RvcjtcbiAgICB0aGlzLnByb21pc2UgPSBuZXcgQ29uc3RydWN0b3Iobm9vcCk7XG5cbiAgICBpZiAoIXRoaXMucHJvbWlzZVtQUk9NSVNFX0lEXSkge1xuICAgICAgbWFrZVByb21pc2UodGhpcy5wcm9taXNlKTtcbiAgICB9XG5cbiAgICBpZiAoaXNBcnJheShpbnB1dCkpIHtcbiAgICAgIHRoaXMubGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xuICAgICAgdGhpcy5fcmVtYWluaW5nID0gaW5wdXQubGVuZ3RoO1xuXG4gICAgICB0aGlzLl9yZXN1bHQgPSBuZXcgQXJyYXkodGhpcy5sZW5ndGgpO1xuXG4gICAgICBpZiAodGhpcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZnVsZmlsbCh0aGlzLnByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxlbmd0aCA9IHRoaXMubGVuZ3RoIHx8IDA7XG4gICAgICAgIHRoaXMuX2VudW1lcmF0ZShpbnB1dCk7XG4gICAgICAgIGlmICh0aGlzLl9yZW1haW5pbmcgPT09IDApIHtcbiAgICAgICAgICBmdWxmaWxsKHRoaXMucHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZWplY3QodGhpcy5wcm9taXNlLCB2YWxpZGF0aW9uRXJyb3IoKSk7XG4gICAgfVxuICB9XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX2VudW1lcmF0ZSA9IGZ1bmN0aW9uIF9lbnVtZXJhdGUoaW5wdXQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgdGhpcy5fc3RhdGUgPT09IFBFTkRJTkcgJiYgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLl9lYWNoRW50cnkoaW5wdXRbaV0sIGkpO1xuICAgIH1cbiAgfTtcblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fZWFjaEVudHJ5ID0gZnVuY3Rpb24gX2VhY2hFbnRyeShlbnRyeSwgaSkge1xuICAgIHZhciBjID0gdGhpcy5faW5zdGFuY2VDb25zdHJ1Y3RvcjtcbiAgICB2YXIgcmVzb2x2ZSQkMSA9IGMucmVzb2x2ZTtcblxuXG4gICAgaWYgKHJlc29sdmUkJDEgPT09IHJlc29sdmUkMSkge1xuICAgICAgdmFyIF90aGVuID0gZ2V0VGhlbihlbnRyeSk7XG5cbiAgICAgIGlmIChfdGhlbiA9PT0gdGhlbiAmJiBlbnRyeS5fc3RhdGUgIT09IFBFTkRJTkcpIHtcbiAgICAgICAgdGhpcy5fc2V0dGxlZEF0KGVudHJ5Ll9zdGF0ZSwgaSwgZW50cnkuX3Jlc3VsdCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBfdGhlbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLl9yZW1haW5pbmctLTtcbiAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gZW50cnk7XG4gICAgICB9IGVsc2UgaWYgKGMgPT09IFByb21pc2UkMSkge1xuICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBjKG5vb3ApO1xuICAgICAgICBoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsIGVudHJ5LCBfdGhlbik7XG4gICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChwcm9taXNlLCBpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChuZXcgYyhmdW5jdGlvbiAocmVzb2x2ZSQkMSkge1xuICAgICAgICAgIHJldHVybiByZXNvbHZlJCQxKGVudHJ5KTtcbiAgICAgICAgfSksIGkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl93aWxsU2V0dGxlQXQocmVzb2x2ZSQkMShlbnRyeSksIGkpO1xuICAgIH1cbiAgfTtcblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fc2V0dGxlZEF0ID0gZnVuY3Rpb24gX3NldHRsZWRBdChzdGF0ZSwgaSwgdmFsdWUpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcblxuXG4gICAgaWYgKHByb21pc2UuX3N0YXRlID09PSBQRU5ESU5HKSB7XG4gICAgICB0aGlzLl9yZW1haW5pbmctLTtcblxuICAgICAgaWYgKHN0YXRlID09PSBSRUpFQ1RFRCkge1xuICAgICAgICByZWplY3QocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX3JlbWFpbmluZyA9PT0gMCkge1xuICAgICAgZnVsZmlsbChwcm9taXNlLCB0aGlzLl9yZXN1bHQpO1xuICAgIH1cbiAgfTtcblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fd2lsbFNldHRsZUF0ID0gZnVuY3Rpb24gX3dpbGxTZXR0bGVBdChwcm9taXNlLCBpKSB7XG4gICAgdmFyIGVudW1lcmF0b3IgPSB0aGlzO1xuXG4gICAgc3Vic2NyaWJlKHByb21pc2UsIHVuZGVmaW5lZCwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXR1cm4gZW51bWVyYXRvci5fc2V0dGxlZEF0KEZVTEZJTExFRCwgaSwgdmFsdWUpO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIHJldHVybiBlbnVtZXJhdG9yLl9zZXR0bGVkQXQoUkVKRUNURUQsIGksIHJlYXNvbik7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIEVudW1lcmF0b3I7XG59KCk7XG5cbi8qKlxuICBgUHJvbWlzZS5hbGxgIGFjY2VwdHMgYW4gYXJyYXkgb2YgcHJvbWlzZXMsIGFuZCByZXR1cm5zIGEgbmV3IHByb21pc2Ugd2hpY2hcbiAgaXMgZnVsZmlsbGVkIHdpdGggYW4gYXJyYXkgb2YgZnVsZmlsbG1lbnQgdmFsdWVzIGZvciB0aGUgcGFzc2VkIHByb21pc2VzLCBvclxuICByZWplY3RlZCB3aXRoIHRoZSByZWFzb24gb2YgdGhlIGZpcnN0IHBhc3NlZCBwcm9taXNlIHRvIGJlIHJlamVjdGVkLiBJdCBjYXN0cyBhbGxcbiAgZWxlbWVudHMgb2YgdGhlIHBhc3NlZCBpdGVyYWJsZSB0byBwcm9taXNlcyBhcyBpdCBydW5zIHRoaXMgYWxnb3JpdGhtLlxuXG4gIEV4YW1wbGU6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSByZXNvbHZlKDEpO1xuICBsZXQgcHJvbWlzZTIgPSByZXNvbHZlKDIpO1xuICBsZXQgcHJvbWlzZTMgPSByZXNvbHZlKDMpO1xuICBsZXQgcHJvbWlzZXMgPSBbIHByb21pc2UxLCBwcm9taXNlMiwgcHJvbWlzZTMgXTtcblxuICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbihhcnJheSl7XG4gICAgLy8gVGhlIGFycmF5IGhlcmUgd291bGQgYmUgWyAxLCAyLCAzIF07XG4gIH0pO1xuICBgYGBcblxuICBJZiBhbnkgb2YgdGhlIGBwcm9taXNlc2AgZ2l2ZW4gdG8gYGFsbGAgYXJlIHJlamVjdGVkLCB0aGUgZmlyc3QgcHJvbWlzZVxuICB0aGF0IGlzIHJlamVjdGVkIHdpbGwgYmUgZ2l2ZW4gYXMgYW4gYXJndW1lbnQgdG8gdGhlIHJldHVybmVkIHByb21pc2VzJ3NcbiAgcmVqZWN0aW9uIGhhbmRsZXIuIEZvciBleGFtcGxlOlxuXG4gIEV4YW1wbGU6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSByZXNvbHZlKDEpO1xuICBsZXQgcHJvbWlzZTIgPSByZWplY3QobmV3IEVycm9yKFwiMlwiKSk7XG4gIGxldCBwcm9taXNlMyA9IHJlamVjdChuZXcgRXJyb3IoXCIzXCIpKTtcbiAgbGV0IHByb21pc2VzID0gWyBwcm9taXNlMSwgcHJvbWlzZTIsIHByb21pc2UzIF07XG5cbiAgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oYXJyYXkpe1xuICAgIC8vIENvZGUgaGVyZSBuZXZlciBydW5zIGJlY2F1c2UgdGhlcmUgYXJlIHJlamVjdGVkIHByb21pc2VzIVxuICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgIC8vIGVycm9yLm1lc3NhZ2UgPT09IFwiMlwiXG4gIH0pO1xuICBgYGBcblxuICBAbWV0aG9kIGFsbFxuICBAc3RhdGljXG4gIEBwYXJhbSB7QXJyYXl9IGVudHJpZXMgYXJyYXkgb2YgcHJvbWlzZXNcbiAgQHBhcmFtIHtTdHJpbmd9IGxhYmVsIG9wdGlvbmFsIHN0cmluZyBmb3IgbGFiZWxpbmcgdGhlIHByb21pc2UuXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSB0aGF0IGlzIGZ1bGZpbGxlZCB3aGVuIGFsbCBgcHJvbWlzZXNgIGhhdmUgYmVlblxuICBmdWxmaWxsZWQsIG9yIHJlamVjdGVkIGlmIGFueSBvZiB0aGVtIGJlY29tZSByZWplY3RlZC5cbiAgQHN0YXRpY1xuKi9cbmZ1bmN0aW9uIGFsbChlbnRyaWVzKSB7XG4gIHJldHVybiBuZXcgRW51bWVyYXRvcih0aGlzLCBlbnRyaWVzKS5wcm9taXNlO1xufVxuXG4vKipcbiAgYFByb21pc2UucmFjZWAgcmV0dXJucyBhIG5ldyBwcm9taXNlIHdoaWNoIGlzIHNldHRsZWQgaW4gdGhlIHNhbWUgd2F5IGFzIHRoZVxuICBmaXJzdCBwYXNzZWQgcHJvbWlzZSB0byBzZXR0bGUuXG5cbiAgRXhhbXBsZTpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlMSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVzb2x2ZSgncHJvbWlzZSAxJyk7XG4gICAgfSwgMjAwKTtcbiAgfSk7XG5cbiAgbGV0IHByb21pc2UyID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXNvbHZlKCdwcm9taXNlIDInKTtcbiAgICB9LCAxMDApO1xuICB9KTtcblxuICBQcm9taXNlLnJhY2UoW3Byb21pc2UxLCBwcm9taXNlMl0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAvLyByZXN1bHQgPT09ICdwcm9taXNlIDInIGJlY2F1c2UgaXQgd2FzIHJlc29sdmVkIGJlZm9yZSBwcm9taXNlMVxuICAgIC8vIHdhcyByZXNvbHZlZC5cbiAgfSk7XG4gIGBgYFxuXG4gIGBQcm9taXNlLnJhY2VgIGlzIGRldGVybWluaXN0aWMgaW4gdGhhdCBvbmx5IHRoZSBzdGF0ZSBvZiB0aGUgZmlyc3RcbiAgc2V0dGxlZCBwcm9taXNlIG1hdHRlcnMuIEZvciBleGFtcGxlLCBldmVuIGlmIG90aGVyIHByb21pc2VzIGdpdmVuIHRvIHRoZVxuICBgcHJvbWlzZXNgIGFycmF5IGFyZ3VtZW50IGFyZSByZXNvbHZlZCwgYnV0IHRoZSBmaXJzdCBzZXR0bGVkIHByb21pc2UgaGFzXG4gIGJlY29tZSByZWplY3RlZCBiZWZvcmUgdGhlIG90aGVyIHByb21pc2VzIGJlY2FtZSBmdWxmaWxsZWQsIHRoZSByZXR1cm5lZFxuICBwcm9taXNlIHdpbGwgYmVjb21lIHJlamVjdGVkOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXNvbHZlKCdwcm9taXNlIDEnKTtcbiAgICB9LCAyMDApO1xuICB9KTtcblxuICBsZXQgcHJvbWlzZTIgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHJlamVjdChuZXcgRXJyb3IoJ3Byb21pc2UgMicpKTtcbiAgICB9LCAxMDApO1xuICB9KTtcblxuICBQcm9taXNlLnJhY2UoW3Byb21pc2UxLCBwcm9taXNlMl0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAvLyBDb2RlIGhlcmUgbmV2ZXIgcnVuc1xuICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIHJlYXNvbi5tZXNzYWdlID09PSAncHJvbWlzZSAyJyBiZWNhdXNlIHByb21pc2UgMiBiZWNhbWUgcmVqZWN0ZWQgYmVmb3JlXG4gICAgLy8gcHJvbWlzZSAxIGJlY2FtZSBmdWxmaWxsZWRcbiAgfSk7XG4gIGBgYFxuXG4gIEFuIGV4YW1wbGUgcmVhbC13b3JsZCB1c2UgY2FzZSBpcyBpbXBsZW1lbnRpbmcgdGltZW91dHM6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBQcm9taXNlLnJhY2UoW2FqYXgoJ2Zvby5qc29uJyksIHRpbWVvdXQoNTAwMCldKVxuICBgYGBcblxuICBAbWV0aG9kIHJhY2VcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FycmF5fSBwcm9taXNlcyBhcnJheSBvZiBwcm9taXNlcyB0byBvYnNlcnZlXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gYSBwcm9taXNlIHdoaWNoIHNldHRsZXMgaW4gdGhlIHNhbWUgd2F5IGFzIHRoZSBmaXJzdCBwYXNzZWRcbiAgcHJvbWlzZSB0byBzZXR0bGUuXG4qL1xuZnVuY3Rpb24gcmFjZShlbnRyaWVzKSB7XG4gIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG5cbiAgaWYgKCFpc0FycmF5KGVudHJpZXMpKSB7XG4gICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbiAoXywgcmVqZWN0KSB7XG4gICAgICByZXR1cm4gcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYW4gYXJyYXkgdG8gcmFjZS4nKSk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gZW50cmllcy5sZW5ndGg7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIENvbnN0cnVjdG9yLnJlc29sdmUoZW50cmllc1tpXSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICBgUHJvbWlzZS5yZWplY3RgIHJldHVybnMgYSBwcm9taXNlIHJlamVjdGVkIHdpdGggdGhlIHBhc3NlZCBgcmVhc29uYC5cbiAgSXQgaXMgc2hvcnRoYW5kIGZvciB0aGUgZm9sbG93aW5nOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHJlamVjdChuZXcgRXJyb3IoJ1dIT09QUycpKTtcbiAgfSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAvLyBDb2RlIGhlcmUgZG9lc24ndCBydW4gYmVjYXVzZSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCFcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ1dIT09QUydcbiAgfSk7XG4gIGBgYFxuXG4gIEluc3RlYWQgb2Ygd3JpdGluZyB0aGUgYWJvdmUsIHlvdXIgY29kZSBub3cgc2ltcGx5IGJlY29tZXMgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdXSE9PUFMnKSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAvLyBDb2RlIGhlcmUgZG9lc24ndCBydW4gYmVjYXVzZSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCFcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ1dIT09QUydcbiAgfSk7XG4gIGBgYFxuXG4gIEBtZXRob2QgcmVqZWN0XG4gIEBzdGF0aWNcbiAgQHBhcmFtIHtBbnl9IHJlYXNvbiB2YWx1ZSB0aGF0IHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aC5cbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2UgcmVqZWN0ZWQgd2l0aCB0aGUgZ2l2ZW4gYHJlYXNvbmAuXG4qL1xuZnVuY3Rpb24gcmVqZWN0JDEocmVhc29uKSB7XG4gIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKG5vb3ApO1xuICByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cbmZ1bmN0aW9uIG5lZWRzUmVzb2x2ZXIoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYSByZXNvbHZlciBmdW5jdGlvbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQgdG8gdGhlIHByb21pc2UgY29uc3RydWN0b3InKTtcbn1cblxuZnVuY3Rpb24gbmVlZHNOZXcoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJGYWlsZWQgdG8gY29uc3RydWN0ICdQcm9taXNlJzogUGxlYXNlIHVzZSB0aGUgJ25ldycgb3BlcmF0b3IsIHRoaXMgb2JqZWN0IGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBjYWxsZWQgYXMgYSBmdW5jdGlvbi5cIik7XG59XG5cbi8qKlxuICBQcm9taXNlIG9iamVjdHMgcmVwcmVzZW50IHRoZSBldmVudHVhbCByZXN1bHQgb2YgYW4gYXN5bmNocm9ub3VzIG9wZXJhdGlvbi4gVGhlXG4gIHByaW1hcnkgd2F5IG9mIGludGVyYWN0aW5nIHdpdGggYSBwcm9taXNlIGlzIHRocm91Z2ggaXRzIGB0aGVuYCBtZXRob2QsIHdoaWNoXG4gIHJlZ2lzdGVycyBjYWxsYmFja3MgdG8gcmVjZWl2ZSBlaXRoZXIgYSBwcm9taXNlJ3MgZXZlbnR1YWwgdmFsdWUgb3IgdGhlIHJlYXNvblxuICB3aHkgdGhlIHByb21pc2UgY2Fubm90IGJlIGZ1bGZpbGxlZC5cblxuICBUZXJtaW5vbG9neVxuICAtLS0tLS0tLS0tLVxuXG4gIC0gYHByb21pc2VgIGlzIGFuIG9iamVjdCBvciBmdW5jdGlvbiB3aXRoIGEgYHRoZW5gIG1ldGhvZCB3aG9zZSBiZWhhdmlvciBjb25mb3JtcyB0byB0aGlzIHNwZWNpZmljYXRpb24uXG4gIC0gYHRoZW5hYmxlYCBpcyBhbiBvYmplY3Qgb3IgZnVuY3Rpb24gdGhhdCBkZWZpbmVzIGEgYHRoZW5gIG1ldGhvZC5cbiAgLSBgdmFsdWVgIGlzIGFueSBsZWdhbCBKYXZhU2NyaXB0IHZhbHVlIChpbmNsdWRpbmcgdW5kZWZpbmVkLCBhIHRoZW5hYmxlLCBvciBhIHByb21pc2UpLlxuICAtIGBleGNlcHRpb25gIGlzIGEgdmFsdWUgdGhhdCBpcyB0aHJvd24gdXNpbmcgdGhlIHRocm93IHN0YXRlbWVudC5cbiAgLSBgcmVhc29uYCBpcyBhIHZhbHVlIHRoYXQgaW5kaWNhdGVzIHdoeSBhIHByb21pc2Ugd2FzIHJlamVjdGVkLlxuICAtIGBzZXR0bGVkYCB0aGUgZmluYWwgcmVzdGluZyBzdGF0ZSBvZiBhIHByb21pc2UsIGZ1bGZpbGxlZCBvciByZWplY3RlZC5cblxuICBBIHByb21pc2UgY2FuIGJlIGluIG9uZSBvZiB0aHJlZSBzdGF0ZXM6IHBlbmRpbmcsIGZ1bGZpbGxlZCwgb3IgcmVqZWN0ZWQuXG5cbiAgUHJvbWlzZXMgdGhhdCBhcmUgZnVsZmlsbGVkIGhhdmUgYSBmdWxmaWxsbWVudCB2YWx1ZSBhbmQgYXJlIGluIHRoZSBmdWxmaWxsZWRcbiAgc3RhdGUuICBQcm9taXNlcyB0aGF0IGFyZSByZWplY3RlZCBoYXZlIGEgcmVqZWN0aW9uIHJlYXNvbiBhbmQgYXJlIGluIHRoZVxuICByZWplY3RlZCBzdGF0ZS4gIEEgZnVsZmlsbG1lbnQgdmFsdWUgaXMgbmV2ZXIgYSB0aGVuYWJsZS5cblxuICBQcm9taXNlcyBjYW4gYWxzbyBiZSBzYWlkIHRvICpyZXNvbHZlKiBhIHZhbHVlLiAgSWYgdGhpcyB2YWx1ZSBpcyBhbHNvIGFcbiAgcHJvbWlzZSwgdGhlbiB0aGUgb3JpZ2luYWwgcHJvbWlzZSdzIHNldHRsZWQgc3RhdGUgd2lsbCBtYXRjaCB0aGUgdmFsdWUnc1xuICBzZXR0bGVkIHN0YXRlLiAgU28gYSBwcm9taXNlIHRoYXQgKnJlc29sdmVzKiBhIHByb21pc2UgdGhhdCByZWplY3RzIHdpbGxcbiAgaXRzZWxmIHJlamVjdCwgYW5kIGEgcHJvbWlzZSB0aGF0ICpyZXNvbHZlcyogYSBwcm9taXNlIHRoYXQgZnVsZmlsbHMgd2lsbFxuICBpdHNlbGYgZnVsZmlsbC5cblxuXG4gIEJhc2ljIFVzYWdlOlxuICAtLS0tLS0tLS0tLS1cblxuICBgYGBqc1xuICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIC8vIG9uIHN1Y2Nlc3NcbiAgICByZXNvbHZlKHZhbHVlKTtcblxuICAgIC8vIG9uIGZhaWx1cmVcbiAgICByZWplY3QocmVhc29uKTtcbiAgfSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgLy8gb24gZnVsZmlsbG1lbnRcbiAgfSwgZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgLy8gb24gcmVqZWN0aW9uXG4gIH0pO1xuICBgYGBcblxuICBBZHZhbmNlZCBVc2FnZTpcbiAgLS0tLS0tLS0tLS0tLS0tXG5cbiAgUHJvbWlzZXMgc2hpbmUgd2hlbiBhYnN0cmFjdGluZyBhd2F5IGFzeW5jaHJvbm91cyBpbnRlcmFjdGlvbnMgc3VjaCBhc1xuICBgWE1MSHR0cFJlcXVlc3Rgcy5cblxuICBgYGBqc1xuICBmdW5jdGlvbiBnZXRKU09OKHVybCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgICAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG4gICAgICB4aHIub3BlbignR0VUJywgdXJsKTtcbiAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBoYW5kbGVyO1xuICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJztcbiAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgeGhyLnNlbmQoKTtcblxuICAgICAgZnVuY3Rpb24gaGFuZGxlcigpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gdGhpcy5ET05FKSB7XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgIHJlc29sdmUodGhpcy5yZXNwb25zZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ2dldEpTT046IGAnICsgdXJsICsgJ2AgZmFpbGVkIHdpdGggc3RhdHVzOiBbJyArIHRoaXMuc3RhdHVzICsgJ10nKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0SlNPTignL3Bvc3RzLmpzb24nKS50aGVuKGZ1bmN0aW9uKGpzb24pIHtcbiAgICAvLyBvbiBmdWxmaWxsbWVudFxuICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAvLyBvbiByZWplY3Rpb25cbiAgfSk7XG4gIGBgYFxuXG4gIFVubGlrZSBjYWxsYmFja3MsIHByb21pc2VzIGFyZSBncmVhdCBjb21wb3NhYmxlIHByaW1pdGl2ZXMuXG5cbiAgYGBganNcbiAgUHJvbWlzZS5hbGwoW1xuICAgIGdldEpTT04oJy9wb3N0cycpLFxuICAgIGdldEpTT04oJy9jb21tZW50cycpXG4gIF0pLnRoZW4oZnVuY3Rpb24odmFsdWVzKXtcbiAgICB2YWx1ZXNbMF0gLy8gPT4gcG9zdHNKU09OXG4gICAgdmFsdWVzWzFdIC8vID0+IGNvbW1lbnRzSlNPTlxuXG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfSk7XG4gIGBgYFxuXG4gIEBjbGFzcyBQcm9taXNlXG4gIEBwYXJhbSB7RnVuY3Rpb259IHJlc29sdmVyXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQGNvbnN0cnVjdG9yXG4qL1xuXG52YXIgUHJvbWlzZSQxID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKSB7XG4gICAgdGhpc1tQUk9NSVNFX0lEXSA9IG5leHRJZCgpO1xuICAgIHRoaXMuX3Jlc3VsdCA9IHRoaXMuX3N0YXRlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3N1YnNjcmliZXJzID0gW107XG5cbiAgICBpZiAobm9vcCAhPT0gcmVzb2x2ZXIpIHtcbiAgICAgIHR5cGVvZiByZXNvbHZlciAhPT0gJ2Z1bmN0aW9uJyAmJiBuZWVkc1Jlc29sdmVyKCk7XG4gICAgICB0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSA/IGluaXRpYWxpemVQcm9taXNlKHRoaXMsIHJlc29sdmVyKSA6IG5lZWRzTmV3KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gIFRoZSBwcmltYXJ5IHdheSBvZiBpbnRlcmFjdGluZyB3aXRoIGEgcHJvbWlzZSBpcyB0aHJvdWdoIGl0cyBgdGhlbmAgbWV0aG9kLFxuICB3aGljaCByZWdpc3RlcnMgY2FsbGJhY2tzIHRvIHJlY2VpdmUgZWl0aGVyIGEgcHJvbWlzZSdzIGV2ZW50dWFsIHZhbHVlIG9yIHRoZVxuICByZWFzb24gd2h5IHRoZSBwcm9taXNlIGNhbm5vdCBiZSBmdWxmaWxsZWQuXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24odXNlcil7XG4gICAgLy8gdXNlciBpcyBhdmFpbGFibGVcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyB1c2VyIGlzIHVuYXZhaWxhYmxlLCBhbmQgeW91IGFyZSBnaXZlbiB0aGUgcmVhc29uIHdoeVxuICB9KTtcbiAgYGBgXG4gICBDaGFpbmluZ1xuICAtLS0tLS0tLVxuICAgVGhlIHJldHVybiB2YWx1ZSBvZiBgdGhlbmAgaXMgaXRzZWxmIGEgcHJvbWlzZS4gIFRoaXMgc2Vjb25kLCAnZG93bnN0cmVhbSdcbiAgcHJvbWlzZSBpcyByZXNvbHZlZCB3aXRoIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZpcnN0IHByb21pc2UncyBmdWxmaWxsbWVudFxuICBvciByZWplY3Rpb24gaGFuZGxlciwgb3IgcmVqZWN0ZWQgaWYgdGhlIGhhbmRsZXIgdGhyb3dzIGFuIGV4Y2VwdGlvbi5cbiAgIGBgYGpzXG4gIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHJldHVybiB1c2VyLm5hbWU7XG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICByZXR1cm4gJ2RlZmF1bHQgbmFtZSc7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKHVzZXJOYW1lKSB7XG4gICAgLy8gSWYgYGZpbmRVc2VyYCBmdWxmaWxsZWQsIGB1c2VyTmFtZWAgd2lsbCBiZSB0aGUgdXNlcidzIG5hbWUsIG90aGVyd2lzZSBpdFxuICAgIC8vIHdpbGwgYmUgYCdkZWZhdWx0IG5hbWUnYFxuICB9KTtcbiAgIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHRocm93IG5ldyBFcnJvcignRm91bmQgdXNlciwgYnV0IHN0aWxsIHVuaGFwcHknKTtcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIHRocm93IG5ldyBFcnJvcignYGZpbmRVc2VyYCByZWplY3RlZCBhbmQgd2UncmUgdW5oYXBweScpO1xuICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIC8vIGlmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgcmVhc29uYCB3aWxsIGJlICdGb3VuZCB1c2VyLCBidXQgc3RpbGwgdW5oYXBweScuXG4gICAgLy8gSWYgYGZpbmRVc2VyYCByZWplY3RlZCwgYHJlYXNvbmAgd2lsbCBiZSAnYGZpbmRVc2VyYCByZWplY3RlZCBhbmQgd2UncmUgdW5oYXBweScuXG4gIH0pO1xuICBgYGBcbiAgSWYgdGhlIGRvd25zdHJlYW0gcHJvbWlzZSBkb2VzIG5vdCBzcGVjaWZ5IGEgcmVqZWN0aW9uIGhhbmRsZXIsIHJlamVjdGlvbiByZWFzb25zIHdpbGwgYmUgcHJvcGFnYXRlZCBmdXJ0aGVyIGRvd25zdHJlYW0uXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICB0aHJvdyBuZXcgUGVkYWdvZ2ljYWxFeGNlcHRpb24oJ1Vwc3RyZWFtIGVycm9yJyk7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgLy8gbmV2ZXIgcmVhY2hlZFxuICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIC8vIFRoZSBgUGVkZ2Fnb2NpYWxFeGNlcHRpb25gIGlzIHByb3BhZ2F0ZWQgYWxsIHRoZSB3YXkgZG93biB0byBoZXJlXG4gIH0pO1xuICBgYGBcbiAgIEFzc2ltaWxhdGlvblxuICAtLS0tLS0tLS0tLS1cbiAgIFNvbWV0aW1lcyB0aGUgdmFsdWUgeW91IHdhbnQgdG8gcHJvcGFnYXRlIHRvIGEgZG93bnN0cmVhbSBwcm9taXNlIGNhbiBvbmx5IGJlXG4gIHJldHJpZXZlZCBhc3luY2hyb25vdXNseS4gVGhpcyBjYW4gYmUgYWNoaWV2ZWQgYnkgcmV0dXJuaW5nIGEgcHJvbWlzZSBpbiB0aGVcbiAgZnVsZmlsbG1lbnQgb3IgcmVqZWN0aW9uIGhhbmRsZXIuIFRoZSBkb3duc3RyZWFtIHByb21pc2Ugd2lsbCB0aGVuIGJlIHBlbmRpbmdcbiAgdW50aWwgdGhlIHJldHVybmVkIHByb21pc2UgaXMgc2V0dGxlZC4gVGhpcyBpcyBjYWxsZWQgKmFzc2ltaWxhdGlvbiouXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gZmluZENvbW1lbnRzQnlBdXRob3IodXNlcik7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKGNvbW1lbnRzKSB7XG4gICAgLy8gVGhlIHVzZXIncyBjb21tZW50cyBhcmUgbm93IGF2YWlsYWJsZVxuICB9KTtcbiAgYGBgXG4gICBJZiB0aGUgYXNzaW1saWF0ZWQgcHJvbWlzZSByZWplY3RzLCB0aGVuIHRoZSBkb3duc3RyZWFtIHByb21pc2Ugd2lsbCBhbHNvIHJlamVjdC5cbiAgIGBgYGpzXG4gIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHJldHVybiBmaW5kQ29tbWVudHNCeUF1dGhvcih1c2VyKTtcbiAgfSkudGhlbihmdW5jdGlvbiAoY29tbWVudHMpIHtcbiAgICAvLyBJZiBgZmluZENvbW1lbnRzQnlBdXRob3JgIGZ1bGZpbGxzLCB3ZSdsbCBoYXZlIHRoZSB2YWx1ZSBoZXJlXG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvLyBJZiBgZmluZENvbW1lbnRzQnlBdXRob3JgIHJlamVjdHMsIHdlJ2xsIGhhdmUgdGhlIHJlYXNvbiBoZXJlXG4gIH0pO1xuICBgYGBcbiAgIFNpbXBsZSBFeGFtcGxlXG4gIC0tLS0tLS0tLS0tLS0tXG4gICBTeW5jaHJvbm91cyBFeGFtcGxlXG4gICBgYGBqYXZhc2NyaXB0XG4gIGxldCByZXN1bHQ7XG4gICB0cnkge1xuICAgIHJlc3VsdCA9IGZpbmRSZXN1bHQoKTtcbiAgICAvLyBzdWNjZXNzXG4gIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgLy8gZmFpbHVyZVxuICB9XG4gIGBgYFxuICAgRXJyYmFjayBFeGFtcGxlXG4gICBgYGBqc1xuICBmaW5kUmVzdWx0KGZ1bmN0aW9uKHJlc3VsdCwgZXJyKXtcbiAgICBpZiAoZXJyKSB7XG4gICAgICAvLyBmYWlsdXJlXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIHN1Y2Nlc3NcbiAgICB9XG4gIH0pO1xuICBgYGBcbiAgIFByb21pc2UgRXhhbXBsZTtcbiAgIGBgYGphdmFzY3JpcHRcbiAgZmluZFJlc3VsdCgpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAvLyBzdWNjZXNzXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gZmFpbHVyZVxuICB9KTtcbiAgYGBgXG4gICBBZHZhbmNlZCBFeGFtcGxlXG4gIC0tLS0tLS0tLS0tLS0tXG4gICBTeW5jaHJvbm91cyBFeGFtcGxlXG4gICBgYGBqYXZhc2NyaXB0XG4gIGxldCBhdXRob3IsIGJvb2tzO1xuICAgdHJ5IHtcbiAgICBhdXRob3IgPSBmaW5kQXV0aG9yKCk7XG4gICAgYm9va3MgID0gZmluZEJvb2tzQnlBdXRob3IoYXV0aG9yKTtcbiAgICAvLyBzdWNjZXNzXG4gIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgLy8gZmFpbHVyZVxuICB9XG4gIGBgYFxuICAgRXJyYmFjayBFeGFtcGxlXG4gICBgYGBqc1xuICAgZnVuY3Rpb24gZm91bmRCb29rcyhib29rcykge1xuICAgfVxuICAgZnVuY3Rpb24gZmFpbHVyZShyZWFzb24pIHtcbiAgIH1cbiAgIGZpbmRBdXRob3IoZnVuY3Rpb24oYXV0aG9yLCBlcnIpe1xuICAgIGlmIChlcnIpIHtcbiAgICAgIGZhaWx1cmUoZXJyKTtcbiAgICAgIC8vIGZhaWx1cmVcbiAgICB9IGVsc2Uge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZmluZEJvb29rc0J5QXV0aG9yKGF1dGhvciwgZnVuY3Rpb24oYm9va3MsIGVycikge1xuICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgIGZhaWx1cmUoZXJyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgZm91bmRCb29rcyhib29rcyk7XG4gICAgICAgICAgICB9IGNhdGNoKHJlYXNvbikge1xuICAgICAgICAgICAgICBmYWlsdXJlKHJlYXNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2goZXJyb3IpIHtcbiAgICAgICAgZmFpbHVyZShlcnIpO1xuICAgICAgfVxuICAgICAgLy8gc3VjY2Vzc1xuICAgIH1cbiAgfSk7XG4gIGBgYFxuICAgUHJvbWlzZSBFeGFtcGxlO1xuICAgYGBgamF2YXNjcmlwdFxuICBmaW5kQXV0aG9yKCkuXG4gICAgdGhlbihmaW5kQm9va3NCeUF1dGhvcikuXG4gICAgdGhlbihmdW5jdGlvbihib29rcyl7XG4gICAgICAvLyBmb3VuZCBib29rc1xuICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gIH0pO1xuICBgYGBcbiAgIEBtZXRob2QgdGhlblxuICBAcGFyYW0ge0Z1bmN0aW9ufSBvbkZ1bGZpbGxlZFxuICBAcGFyYW0ge0Z1bmN0aW9ufSBvblJlamVjdGVkXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX1cbiAgKi9cblxuICAvKipcbiAgYGNhdGNoYCBpcyBzaW1wbHkgc3VnYXIgZm9yIGB0aGVuKHVuZGVmaW5lZCwgb25SZWplY3Rpb24pYCB3aGljaCBtYWtlcyBpdCB0aGUgc2FtZVxuICBhcyB0aGUgY2F0Y2ggYmxvY2sgb2YgYSB0cnkvY2F0Y2ggc3RhdGVtZW50LlxuICBgYGBqc1xuICBmdW5jdGlvbiBmaW5kQXV0aG9yKCl7XG4gIHRocm93IG5ldyBFcnJvcignY291bGRuJ3QgZmluZCB0aGF0IGF1dGhvcicpO1xuICB9XG4gIC8vIHN5bmNocm9ub3VzXG4gIHRyeSB7XG4gIGZpbmRBdXRob3IoKTtcbiAgfSBjYXRjaChyZWFzb24pIHtcbiAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmdcbiAgfVxuICAvLyBhc3luYyB3aXRoIHByb21pc2VzXG4gIGZpbmRBdXRob3IoKS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuICB9KTtcbiAgYGBgXG4gIEBtZXRob2QgY2F0Y2hcbiAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3Rpb25cbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfVxuICAqL1xuXG5cbiAgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2ggPSBmdW5jdGlvbiBfY2F0Y2gob25SZWplY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0aW9uKTtcbiAgfTtcblxuICAvKipcbiAgICBgZmluYWxseWAgd2lsbCBiZSBpbnZva2VkIHJlZ2FyZGxlc3Mgb2YgdGhlIHByb21pc2UncyBmYXRlIGp1c3QgYXMgbmF0aXZlXG4gICAgdHJ5L2NhdGNoL2ZpbmFsbHkgYmVoYXZlc1xuICBcbiAgICBTeW5jaHJvbm91cyBleGFtcGxlOlxuICBcbiAgICBgYGBqc1xuICAgIGZpbmRBdXRob3IoKSB7XG4gICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IDAuNSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXcgQXV0aG9yKCk7XG4gICAgfVxuICBcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGZpbmRBdXRob3IoKTsgLy8gc3VjY2VlZCBvciBmYWlsXG4gICAgfSBjYXRjaChlcnJvcikge1xuICAgICAgcmV0dXJuIGZpbmRPdGhlckF1dGhlcigpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBhbHdheXMgcnVuc1xuICAgICAgLy8gZG9lc24ndCBhZmZlY3QgdGhlIHJldHVybiB2YWx1ZVxuICAgIH1cbiAgICBgYGBcbiAgXG4gICAgQXN5bmNocm9ub3VzIGV4YW1wbGU6XG4gIFxuICAgIGBgYGpzXG4gICAgZmluZEF1dGhvcigpLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgICByZXR1cm4gZmluZE90aGVyQXV0aGVyKCk7XG4gICAgfSkuZmluYWxseShmdW5jdGlvbigpe1xuICAgICAgLy8gYXV0aG9yIHdhcyBlaXRoZXIgZm91bmQsIG9yIG5vdFxuICAgIH0pO1xuICAgIGBgYFxuICBcbiAgICBAbWV0aG9kIGZpbmFsbHlcbiAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICAgIEByZXR1cm4ge1Byb21pc2V9XG4gICovXG5cblxuICBQcm9taXNlLnByb3RvdHlwZS5maW5hbGx5ID0gZnVuY3Rpb24gX2ZpbmFsbHkoY2FsbGJhY2spIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XG4gICAgdmFyIGNvbnN0cnVjdG9yID0gcHJvbWlzZS5jb25zdHJ1Y3RvcjtcblxuICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfSk7XG4gICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRocm93IHJlYXNvbjtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBQcm9taXNlO1xufSgpO1xuXG5Qcm9taXNlJDEucHJvdG90eXBlLnRoZW4gPSB0aGVuO1xuUHJvbWlzZSQxLmFsbCA9IGFsbDtcblByb21pc2UkMS5yYWNlID0gcmFjZTtcblByb21pc2UkMS5yZXNvbHZlID0gcmVzb2x2ZSQxO1xuUHJvbWlzZSQxLnJlamVjdCA9IHJlamVjdCQxO1xuUHJvbWlzZSQxLl9zZXRTY2hlZHVsZXIgPSBzZXRTY2hlZHVsZXI7XG5Qcm9taXNlJDEuX3NldEFzYXAgPSBzZXRBc2FwO1xuUHJvbWlzZSQxLl9hc2FwID0gYXNhcDtcblxuLypnbG9iYWwgc2VsZiovXG5mdW5jdGlvbiBwb2x5ZmlsbCgpIHtcbiAgdmFyIGxvY2FsID0gdm9pZCAwO1xuXG4gIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxvY2FsID0gZ2xvYmFsO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxvY2FsID0gc2VsZjtcbiAgfSBlbHNlIHtcbiAgICB0cnkge1xuICAgICAgbG9jYWwgPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigncG9seWZpbGwgZmFpbGVkIGJlY2F1c2UgZ2xvYmFsIG9iamVjdCBpcyB1bmF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Jyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIFAgPSBsb2NhbC5Qcm9taXNlO1xuXG4gIGlmIChQKSB7XG4gICAgdmFyIHByb21pc2VUb1N0cmluZyA9IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIHByb21pc2VUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChQLnJlc29sdmUoKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gc2lsZW50bHkgaWdub3JlZFxuICAgIH1cblxuICAgIGlmIChwcm9taXNlVG9TdHJpbmcgPT09ICdbb2JqZWN0IFByb21pc2VdJyAmJiAhUC5jYXN0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgbG9jYWwuUHJvbWlzZSA9IFByb21pc2UkMTtcbn1cblxuLy8gU3RyYW5nZSBjb21wYXQuLlxuUHJvbWlzZSQxLnBvbHlmaWxsID0gcG9seWZpbGw7XG5Qcm9taXNlJDEuUHJvbWlzZSA9IFByb21pc2UkMTtcblxucmV0dXJuIFByb21pc2UkMTtcblxufSkpKTtcblxuXG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVzNi1wcm9taXNlLm1hcFxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2VzNi1wcm9taXNlL2Rpc3QvZXM2LXByb21pc2UuanNcbi8vIG1vZHVsZSBpZCA9IDEzOFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wRGVmYXVsdCAoZXgpIHsgcmV0dXJuIChleCAmJiAodHlwZW9mIGV4ID09PSAnb2JqZWN0JykgJiYgJ2RlZmF1bHQnIGluIGV4KSA/IGV4WydkZWZhdWx0J10gOiBleDsgfVxuXG5yZXF1aXJlKCdAZmlyZWJhc2UvcG9seWZpbGwnKTtcbnZhciBmaXJlYmFzZSA9IF9pbnRlcm9wRGVmYXVsdChyZXF1aXJlKCdAZmlyZWJhc2UvYXBwJykpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmaXJlYmFzZTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9maXJlYmFzZS9hcHAvZGlzdC9pbmRleC5janMuanNcbi8vIG1vZHVsZSBpZCA9IDEzOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgJ0BmaXJlYmFzZS9maXJlc3RvcmUnO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9maXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5lc20uanNcbi8vIG1vZHVsZSBpZCA9IDE0MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgd2luO1xuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbiA9IHdpbmRvdztcbn0gZWxzZSBpZiAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbiA9IGdsb2JhbDtcbn0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIpe1xuICAgIHdpbiA9IHNlbGY7XG59IGVsc2Uge1xuICAgIHdpbiA9IHt9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHdpbjtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9nbG9iYWwvd2luZG93LmpzXG4vLyBtb2R1bGUgaWQgPSAxNDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG4vLyBtb2RpZmllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9lcy1zaGltcy9lczUtc2hpbVxudmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xudmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xudmFyIGlzQXJncyA9IHJlcXVpcmUoJy4vaXNBcmd1bWVudHMnKTtcbnZhciBpc0VudW1lcmFibGUgPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIGhhc0RvbnRFbnVtQnVnID0gIWlzRW51bWVyYWJsZS5jYWxsKHsgdG9TdHJpbmc6IG51bGwgfSwgJ3RvU3RyaW5nJyk7XG52YXIgaGFzUHJvdG9FbnVtQnVnID0gaXNFbnVtZXJhYmxlLmNhbGwoZnVuY3Rpb24gKCkge30sICdwcm90b3R5cGUnKTtcbnZhciBkb250RW51bXMgPSBbXG5cdCd0b1N0cmluZycsXG5cdCd0b0xvY2FsZVN0cmluZycsXG5cdCd2YWx1ZU9mJyxcblx0J2hhc093blByb3BlcnR5Jyxcblx0J2lzUHJvdG90eXBlT2YnLFxuXHQncHJvcGVydHlJc0VudW1lcmFibGUnLFxuXHQnY29uc3RydWN0b3InXG5dO1xudmFyIGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlID0gZnVuY3Rpb24gKG8pIHtcblx0dmFyIGN0b3IgPSBvLmNvbnN0cnVjdG9yO1xuXHRyZXR1cm4gY3RvciAmJiBjdG9yLnByb3RvdHlwZSA9PT0gbztcbn07XG52YXIgZXhjbHVkZWRLZXlzID0ge1xuXHQkYXBwbGljYXRpb25DYWNoZTogdHJ1ZSxcblx0JGNvbnNvbGU6IHRydWUsXG5cdCRleHRlcm5hbDogdHJ1ZSxcblx0JGZyYW1lOiB0cnVlLFxuXHQkZnJhbWVFbGVtZW50OiB0cnVlLFxuXHQkZnJhbWVzOiB0cnVlLFxuXHQkaW5uZXJIZWlnaHQ6IHRydWUsXG5cdCRpbm5lcldpZHRoOiB0cnVlLFxuXHQkb3V0ZXJIZWlnaHQ6IHRydWUsXG5cdCRvdXRlcldpZHRoOiB0cnVlLFxuXHQkcGFnZVhPZmZzZXQ6IHRydWUsXG5cdCRwYWdlWU9mZnNldDogdHJ1ZSxcblx0JHBhcmVudDogdHJ1ZSxcblx0JHNjcm9sbExlZnQ6IHRydWUsXG5cdCRzY3JvbGxUb3A6IHRydWUsXG5cdCRzY3JvbGxYOiB0cnVlLFxuXHQkc2Nyb2xsWTogdHJ1ZSxcblx0JHNlbGY6IHRydWUsXG5cdCR3ZWJraXRJbmRleGVkREI6IHRydWUsXG5cdCR3ZWJraXRTdG9yYWdlSW5mbzogdHJ1ZSxcblx0JHdpbmRvdzogdHJ1ZVxufTtcbnZhciBoYXNBdXRvbWF0aW9uRXF1YWxpdHlCdWcgPSAoZnVuY3Rpb24gKCkge1xuXHQvKiBnbG9iYWwgd2luZG93ICovXG5cdGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykgeyByZXR1cm4gZmFsc2U7IH1cblx0Zm9yICh2YXIgayBpbiB3aW5kb3cpIHtcblx0XHR0cnkge1xuXHRcdFx0aWYgKCFleGNsdWRlZEtleXNbJyQnICsga10gJiYgaGFzLmNhbGwod2luZG93LCBrKSAmJiB3aW5kb3dba10gIT09IG51bGwgJiYgdHlwZW9mIHdpbmRvd1trXSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZSh3aW5kb3dba10pO1xuXHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIGZhbHNlO1xufSgpKTtcbnZhciBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZUlmTm90QnVnZ3kgPSBmdW5jdGlvbiAobykge1xuXHQvKiBnbG9iYWwgd2luZG93ICovXG5cdGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCAhaGFzQXV0b21hdGlvbkVxdWFsaXR5QnVnKSB7XG5cdFx0cmV0dXJuIGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlKG8pO1xuXHR9XG5cdHRyeSB7XG5cdFx0cmV0dXJuIGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlKG8pO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG52YXIga2V5c1NoaW0gPSBmdW5jdGlvbiBrZXlzKG9iamVjdCkge1xuXHR2YXIgaXNPYmplY3QgPSBvYmplY3QgIT09IG51bGwgJiYgdHlwZW9mIG9iamVjdCA9PT0gJ29iamVjdCc7XG5cdHZhciBpc0Z1bmN0aW9uID0gdG9TdHIuY2FsbChvYmplY3QpID09PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuXHR2YXIgaXNBcmd1bWVudHMgPSBpc0FyZ3Mob2JqZWN0KTtcblx0dmFyIGlzU3RyaW5nID0gaXNPYmplY3QgJiYgdG9TdHIuY2FsbChvYmplY3QpID09PSAnW29iamVjdCBTdHJpbmddJztcblx0dmFyIHRoZUtleXMgPSBbXTtcblxuXHRpZiAoIWlzT2JqZWN0ICYmICFpc0Z1bmN0aW9uICYmICFpc0FyZ3VtZW50cykge1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdC5rZXlzIGNhbGxlZCBvbiBhIG5vbi1vYmplY3QnKTtcblx0fVxuXG5cdHZhciBza2lwUHJvdG8gPSBoYXNQcm90b0VudW1CdWcgJiYgaXNGdW5jdGlvbjtcblx0aWYgKGlzU3RyaW5nICYmIG9iamVjdC5sZW5ndGggPiAwICYmICFoYXMuY2FsbChvYmplY3QsIDApKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBvYmplY3QubGVuZ3RoOyArK2kpIHtcblx0XHRcdHRoZUtleXMucHVzaChTdHJpbmcoaSkpO1xuXHRcdH1cblx0fVxuXG5cdGlmIChpc0FyZ3VtZW50cyAmJiBvYmplY3QubGVuZ3RoID4gMCkge1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgb2JqZWN0Lmxlbmd0aDsgKytqKSB7XG5cdFx0XHR0aGVLZXlzLnB1c2goU3RyaW5nKGopKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Zm9yICh2YXIgbmFtZSBpbiBvYmplY3QpIHtcblx0XHRcdGlmICghKHNraXBQcm90byAmJiBuYW1lID09PSAncHJvdG90eXBlJykgJiYgaGFzLmNhbGwob2JqZWN0LCBuYW1lKSkge1xuXHRcdFx0XHR0aGVLZXlzLnB1c2goU3RyaW5nKG5hbWUpKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpZiAoaGFzRG9udEVudW1CdWcpIHtcblx0XHR2YXIgc2tpcENvbnN0cnVjdG9yID0gZXF1YWxzQ29uc3RydWN0b3JQcm90b3R5cGVJZk5vdEJ1Z2d5KG9iamVjdCk7XG5cblx0XHRmb3IgKHZhciBrID0gMDsgayA8IGRvbnRFbnVtcy5sZW5ndGg7ICsraykge1xuXHRcdFx0aWYgKCEoc2tpcENvbnN0cnVjdG9yICYmIGRvbnRFbnVtc1trXSA9PT0gJ2NvbnN0cnVjdG9yJykgJiYgaGFzLmNhbGwob2JqZWN0LCBkb250RW51bXNba10pKSB7XG5cdFx0XHRcdHRoZUtleXMucHVzaChkb250RW51bXNba10pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRyZXR1cm4gdGhlS2V5cztcbn07XG5cbmtleXNTaGltLnNoaW0gPSBmdW5jdGlvbiBzaGltT2JqZWN0S2V5cygpIHtcblx0aWYgKE9iamVjdC5rZXlzKSB7XG5cdFx0dmFyIGtleXNXb3Jrc1dpdGhBcmd1bWVudHMgPSAoZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly8gU2FmYXJpIDUuMCBidWdcblx0XHRcdHJldHVybiAoT2JqZWN0LmtleXMoYXJndW1lbnRzKSB8fCAnJykubGVuZ3RoID09PSAyO1xuXHRcdH0oMSwgMikpO1xuXHRcdGlmICgha2V5c1dvcmtzV2l0aEFyZ3VtZW50cykge1xuXHRcdFx0dmFyIG9yaWdpbmFsS2V5cyA9IE9iamVjdC5rZXlzO1xuXHRcdFx0T2JqZWN0LmtleXMgPSBmdW5jdGlvbiBrZXlzKG9iamVjdCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGZ1bmMtbmFtZS1tYXRjaGluZ1xuXHRcdFx0XHRpZiAoaXNBcmdzKG9iamVjdCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gb3JpZ2luYWxLZXlzKHNsaWNlLmNhbGwob2JqZWN0KSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9yaWdpbmFsS2V5cyhvYmplY3QpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRPYmplY3Qua2V5cyA9IGtleXNTaGltO1xuXHR9XG5cdHJldHVybiBPYmplY3Qua2V5cyB8fCBrZXlzU2hpbTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ga2V5c1NoaW07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vb2JqZWN0LWtleXMvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDE0MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbnZhciB0b1N0ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaXNBcmd1bWVudHModmFsdWUpIHtcblx0dmFyIHN0ciA9IHRvU3RyLmNhbGwodmFsdWUpO1xuXHR2YXIgaXNBcmdzID0gc3RyID09PSAnW29iamVjdCBBcmd1bWVudHNdJztcblx0aWYgKCFpc0FyZ3MpIHtcblx0XHRpc0FyZ3MgPSBzdHIgIT09ICdbb2JqZWN0IEFycmF5XScgJiZcblx0XHRcdHZhbHVlICE9PSBudWxsICYmXG5cdFx0XHR0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmXG5cdFx0XHR0eXBlb2YgdmFsdWUubGVuZ3RoID09PSAnbnVtYmVyJyAmJlxuXHRcdFx0dmFsdWUubGVuZ3RoID49IDAgJiZcblx0XHRcdHRvU3RyLmNhbGwodmFsdWUuY2FsbGVlKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcblx0fVxuXHRyZXR1cm4gaXNBcmdzO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9vYmplY3Qta2V5cy9pc0FyZ3VtZW50cy5qc1xuLy8gbW9kdWxlIGlkID0gMTQzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBzdHJpbmdpZnlQcmltaXRpdmUgPSBmdW5jdGlvbih2KSB7XG4gIHN3aXRjaCAodHlwZW9mIHYpIHtcbiAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgcmV0dXJuIHY7XG5cbiAgICBjYXNlICdib29sZWFuJzpcbiAgICAgIHJldHVybiB2ID8gJ3RydWUnIDogJ2ZhbHNlJztcblxuICAgIGNhc2UgJ251bWJlcic6XG4gICAgICByZXR1cm4gaXNGaW5pdGUodikgPyB2IDogJyc7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuICcnO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaiwgc2VwLCBlcSwgbmFtZSkge1xuICBzZXAgPSBzZXAgfHwgJyYnO1xuICBlcSA9IGVxIHx8ICc9JztcbiAgaWYgKG9iaiA9PT0gbnVsbCkge1xuICAgIG9iaiA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb2JqID09PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBtYXAob2JqZWN0S2V5cyhvYmopLCBmdW5jdGlvbihrKSB7XG4gICAgICB2YXIga3MgPSBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKGspKSArIGVxO1xuICAgICAgaWYgKGlzQXJyYXkob2JqW2tdKSkge1xuICAgICAgICByZXR1cm4gbWFwKG9ialtrXSwgZnVuY3Rpb24odikge1xuICAgICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUodikpO1xuICAgICAgICB9KS5qb2luKHNlcCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ga3MgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9ialtrXSkpO1xuICAgICAgfVxuICAgIH0pLmpvaW4oc2VwKTtcblxuICB9XG5cbiAgaWYgKCFuYW1lKSByZXR1cm4gJyc7XG4gIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG5hbWUpKSArIGVxICtcbiAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUob2JqKSk7XG59O1xuXG52YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKHhzKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeHMpID09PSAnW29iamVjdCBBcnJheV0nO1xufTtcblxuZnVuY3Rpb24gbWFwICh4cywgZikge1xuICBpZiAoeHMubWFwKSByZXR1cm4geHMubWFwKGYpO1xuICB2YXIgcmVzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgeHMubGVuZ3RoOyBpKyspIHtcbiAgICByZXMucHVzaChmKHhzW2ldLCBpKSk7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cblxudmFyIG9iamVjdEtleXMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiAob2JqKSB7XG4gIHZhciByZXMgPSBbXTtcbiAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSByZXMucHVzaChrZXkpO1xuICB9XG4gIHJldHVybiByZXM7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3F1ZXJ5c3RyaW5nLWVzMy9lbmNvZGUuanNcbi8vIG1vZHVsZSBpZCA9IDE0NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gKGdsb2JhbCwgdW5kZWZpbmVkKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpZiAoZ2xvYmFsLnNldEltbWVkaWF0ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG5leHRIYW5kbGUgPSAxOyAvLyBTcGVjIHNheXMgZ3JlYXRlciB0aGFuIHplcm9cbiAgICB2YXIgdGFza3NCeUhhbmRsZSA9IHt9O1xuICAgIHZhciBjdXJyZW50bHlSdW5uaW5nQVRhc2sgPSBmYWxzZTtcbiAgICB2YXIgZG9jID0gZ2xvYmFsLmRvY3VtZW50O1xuICAgIHZhciByZWdpc3RlckltbWVkaWF0ZTtcblxuICAgIGZ1bmN0aW9uIHNldEltbWVkaWF0ZShjYWxsYmFjaykge1xuICAgICAgLy8gQ2FsbGJhY2sgY2FuIGVpdGhlciBiZSBhIGZ1bmN0aW9uIG9yIGEgc3RyaW5nXG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgY2FsbGJhY2sgPSBuZXcgRnVuY3Rpb24oXCJcIiArIGNhbGxiYWNrKTtcbiAgICAgIH1cbiAgICAgIC8vIENvcHkgZnVuY3Rpb24gYXJndW1lbnRzXG4gICAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBhcmdzW2ldID0gYXJndW1lbnRzW2kgKyAxXTtcbiAgICAgIH1cbiAgICAgIC8vIFN0b3JlIGFuZCByZWdpc3RlciB0aGUgdGFza1xuICAgICAgdmFyIHRhc2sgPSB7IGNhbGxiYWNrOiBjYWxsYmFjaywgYXJnczogYXJncyB9O1xuICAgICAgdGFza3NCeUhhbmRsZVtuZXh0SGFuZGxlXSA9IHRhc2s7XG4gICAgICByZWdpc3RlckltbWVkaWF0ZShuZXh0SGFuZGxlKTtcbiAgICAgIHJldHVybiBuZXh0SGFuZGxlKys7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaGFuZGxlKSB7XG4gICAgICAgIGRlbGV0ZSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcnVuKHRhc2spIHtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGFzay5jYWxsYmFjaztcbiAgICAgICAgdmFyIGFyZ3MgPSB0YXNrLmFyZ3M7XG4gICAgICAgIHN3aXRjaCAoYXJncy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodW5kZWZpbmVkLCBhcmdzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcnVuSWZQcmVzZW50KGhhbmRsZSkge1xuICAgICAgICAvLyBGcm9tIHRoZSBzcGVjOiBcIldhaXQgdW50aWwgYW55IGludm9jYXRpb25zIG9mIHRoaXMgYWxnb3JpdGhtIHN0YXJ0ZWQgYmVmb3JlIHRoaXMgb25lIGhhdmUgY29tcGxldGVkLlwiXG4gICAgICAgIC8vIFNvIGlmIHdlJ3JlIGN1cnJlbnRseSBydW5uaW5nIGEgdGFzaywgd2UnbGwgbmVlZCB0byBkZWxheSB0aGlzIGludm9jYXRpb24uXG4gICAgICAgIGlmIChjdXJyZW50bHlSdW5uaW5nQVRhc2spIHtcbiAgICAgICAgICAgIC8vIERlbGF5IGJ5IGRvaW5nIGEgc2V0VGltZW91dC4gc2V0SW1tZWRpYXRlIHdhcyB0cmllZCBpbnN0ZWFkLCBidXQgaW4gRmlyZWZveCA3IGl0IGdlbmVyYXRlZCBhXG4gICAgICAgICAgICAvLyBcInRvbyBtdWNoIHJlY3Vyc2lvblwiIGVycm9yLlxuICAgICAgICAgICAgc2V0VGltZW91dChydW5JZlByZXNlbnQsIDAsIGhhbmRsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdGFzayA9IHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcbiAgICAgICAgICAgIGlmICh0YXNrKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudGx5UnVubmluZ0FUYXNrID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBydW4odGFzayk7XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbW1lZGlhdGUoaGFuZGxlKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zdGFsbE5leHRUaWNrSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsgcnVuSWZQcmVzZW50KGhhbmRsZSk7IH0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhblVzZVBvc3RNZXNzYWdlKCkge1xuICAgICAgICAvLyBUaGUgdGVzdCBhZ2FpbnN0IGBpbXBvcnRTY3JpcHRzYCBwcmV2ZW50cyB0aGlzIGltcGxlbWVudGF0aW9uIGZyb20gYmVpbmcgaW5zdGFsbGVkIGluc2lkZSBhIHdlYiB3b3JrZXIsXG4gICAgICAgIC8vIHdoZXJlIGBnbG9iYWwucG9zdE1lc3NhZ2VgIG1lYW5zIHNvbWV0aGluZyBjb21wbGV0ZWx5IGRpZmZlcmVudCBhbmQgY2FuJ3QgYmUgdXNlZCBmb3IgdGhpcyBwdXJwb3NlLlxuICAgICAgICBpZiAoZ2xvYmFsLnBvc3RNZXNzYWdlICYmICFnbG9iYWwuaW1wb3J0U2NyaXB0cykge1xuICAgICAgICAgICAgdmFyIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXMgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIG9sZE9uTWVzc2FnZSA9IGdsb2JhbC5vbm1lc3NhZ2U7XG4gICAgICAgICAgICBnbG9iYWwub25tZXNzYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcG9zdE1lc3NhZ2VJc0FzeW5jaHJvbm91cyA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShcIlwiLCBcIipcIik7XG4gICAgICAgICAgICBnbG9iYWwub25tZXNzYWdlID0gb2xkT25NZXNzYWdlO1xuICAgICAgICAgICAgcmV0dXJuIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpIHtcbiAgICAgICAgLy8gSW5zdGFsbHMgYW4gZXZlbnQgaGFuZGxlciBvbiBgZ2xvYmFsYCBmb3IgdGhlIGBtZXNzYWdlYCBldmVudDogc2VlXG4gICAgICAgIC8vICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vRE9NL3dpbmRvdy5wb3N0TWVzc2FnZVxuICAgICAgICAvLyAqIGh0dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdvcmsvbXVsdGlwYWdlL2NvbW1zLmh0bWwjY3Jvc3NEb2N1bWVudE1lc3NhZ2VzXG5cbiAgICAgICAgdmFyIG1lc3NhZ2VQcmVmaXggPSBcInNldEltbWVkaWF0ZSRcIiArIE1hdGgucmFuZG9tKCkgKyBcIiRcIjtcbiAgICAgICAgdmFyIG9uR2xvYmFsTWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlID09PSBnbG9iYWwgJiZcbiAgICAgICAgICAgICAgICB0eXBlb2YgZXZlbnQuZGF0YSA9PT0gXCJzdHJpbmdcIiAmJlxuICAgICAgICAgICAgICAgIGV2ZW50LmRhdGEuaW5kZXhPZihtZXNzYWdlUHJlZml4KSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJ1bklmUHJlc2VudCgrZXZlbnQuZGF0YS5zbGljZShtZXNzYWdlUHJlZml4Lmxlbmd0aCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG9uR2xvYmFsTWVzc2FnZSwgZmFsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2xvYmFsLmF0dGFjaEV2ZW50KFwib25tZXNzYWdlXCIsIG9uR2xvYmFsTWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKG1lc3NhZ2VQcmVmaXggKyBoYW5kbGUsIFwiKlwiKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsTWVzc2FnZUNoYW5uZWxJbXBsZW1lbnRhdGlvbigpIHtcbiAgICAgICAgdmFyIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTtcbiAgICAgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIGhhbmRsZSA9IGV2ZW50LmRhdGE7XG4gICAgICAgICAgICBydW5JZlByZXNlbnQoaGFuZGxlKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZShoYW5kbGUpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHZhciBodG1sID0gZG9jLmRvY3VtZW50RWxlbWVudDtcbiAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIDxzY3JpcHQ+IGVsZW1lbnQ7IGl0cyByZWFkeXN0YXRlY2hhbmdlIGV2ZW50IHdpbGwgYmUgZmlyZWQgYXN5bmNocm9ub3VzbHkgb25jZSBpdCBpcyBpbnNlcnRlZFxuICAgICAgICAgICAgLy8gaW50byB0aGUgZG9jdW1lbnQuIERvIHNvLCB0aHVzIHF1ZXVpbmcgdXAgdGhlIHRhc2suIFJlbWVtYmVyIHRvIGNsZWFuIHVwIG9uY2UgaXQncyBiZWVuIGNhbGxlZC5cbiAgICAgICAgICAgIHZhciBzY3JpcHQgPSBkb2MuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7XG4gICAgICAgICAgICAgICAgc2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaHRtbC5yZW1vdmVDaGlsZChzY3JpcHQpO1xuICAgICAgICAgICAgICAgIHNjcmlwdCA9IG51bGw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaHRtbC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbGxTZXRUaW1lb3V0SW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHJ1bklmUHJlc2VudCwgMCwgaGFuZGxlKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBJZiBzdXBwb3J0ZWQsIHdlIHNob3VsZCBhdHRhY2ggdG8gdGhlIHByb3RvdHlwZSBvZiBnbG9iYWwsIHNpbmNlIHRoYXQgaXMgd2hlcmUgc2V0VGltZW91dCBldCBhbC4gbGl2ZS5cbiAgICB2YXIgYXR0YWNoVG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgJiYgT2JqZWN0LmdldFByb3RvdHlwZU9mKGdsb2JhbCk7XG4gICAgYXR0YWNoVG8gPSBhdHRhY2hUbyAmJiBhdHRhY2hUby5zZXRUaW1lb3V0ID8gYXR0YWNoVG8gOiBnbG9iYWw7XG5cbiAgICAvLyBEb24ndCBnZXQgZm9vbGVkIGJ5IGUuZy4gYnJvd3NlcmlmeSBlbnZpcm9ubWVudHMuXG4gICAgaWYgKHt9LnRvU3RyaW5nLmNhbGwoZ2xvYmFsLnByb2Nlc3MpID09PSBcIltvYmplY3QgcHJvY2Vzc11cIikge1xuICAgICAgICAvLyBGb3IgTm9kZS5qcyBiZWZvcmUgMC45XG4gICAgICAgIGluc3RhbGxOZXh0VGlja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICB9IGVsc2UgaWYgKGNhblVzZVBvc3RNZXNzYWdlKCkpIHtcbiAgICAgICAgLy8gRm9yIG5vbi1JRTEwIG1vZGVybiBicm93c2Vyc1xuICAgICAgICBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgfSBlbHNlIGlmIChnbG9iYWwuTWVzc2FnZUNoYW5uZWwpIHtcbiAgICAgICAgLy8gRm9yIHdlYiB3b3JrZXJzLCB3aGVyZSBzdXBwb3J0ZWRcbiAgICAgICAgaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKTtcblxuICAgIH0gZWxzZSBpZiAoZG9jICYmIFwib25yZWFkeXN0YXRlY2hhbmdlXCIgaW4gZG9jLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIikpIHtcbiAgICAgICAgLy8gRm9yIElFIDbigJM4XG4gICAgICAgIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZvciBvbGRlciBicm93c2Vyc1xuICAgICAgICBpbnN0YWxsU2V0VGltZW91dEltcGxlbWVudGF0aW9uKCk7XG4gICAgfVxuXG4gICAgYXR0YWNoVG8uc2V0SW1tZWRpYXRlID0gc2V0SW1tZWRpYXRlO1xuICAgIGF0dGFjaFRvLmNsZWFySW1tZWRpYXRlID0gY2xlYXJJbW1lZGlhdGU7XG59KHR5cGVvZiBzZWxmID09PSBcInVuZGVmaW5lZFwiID8gdHlwZW9mIGdsb2JhbCA9PT0gXCJ1bmRlZmluZWRcIiA/IHRoaXMgOiBnbG9iYWwgOiBzZWxmKSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc2V0aW1tZWRpYXRlL3NldEltbWVkaWF0ZS5qc1xuLy8gbW9kdWxlIGlkID0gMTQ1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG5cbnZhciBzdHlsZXNJbkRvbSA9IHt9O1xuXG52YXJcdG1lbW9pemUgPSBmdW5jdGlvbiAoZm4pIHtcblx0dmFyIG1lbW87XG5cblx0cmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0XHRpZiAodHlwZW9mIG1lbW8gPT09IFwidW5kZWZpbmVkXCIpIG1lbW8gPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdHJldHVybiBtZW1vO1xuXHR9O1xufTtcblxudmFyIGlzT2xkSUUgPSBtZW1vaXplKGZ1bmN0aW9uICgpIHtcblx0Ly8gVGVzdCBmb3IgSUUgPD0gOSBhcyBwcm9wb3NlZCBieSBCcm93c2VyaGFja3Ncblx0Ly8gQHNlZSBodHRwOi8vYnJvd3NlcmhhY2tzLmNvbS8jaGFjay1lNzFkODY5MmY2NTMzNDE3M2ZlZTcxNWMyMjJjYjgwNVxuXHQvLyBUZXN0cyBmb3IgZXhpc3RlbmNlIG9mIHN0YW5kYXJkIGdsb2JhbHMgaXMgdG8gYWxsb3cgc3R5bGUtbG9hZGVyXG5cdC8vIHRvIG9wZXJhdGUgY29ycmVjdGx5IGludG8gbm9uLXN0YW5kYXJkIGVudmlyb25tZW50c1xuXHQvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJwYWNrLWNvbnRyaWIvc3R5bGUtbG9hZGVyL2lzc3Vlcy8xNzdcblx0cmV0dXJuIHdpbmRvdyAmJiBkb2N1bWVudCAmJiBkb2N1bWVudC5hbGwgJiYgIXdpbmRvdy5hdG9iO1xufSk7XG5cbnZhciBnZXRUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0LCBwYXJlbnQpIHtcbiAgaWYgKHBhcmVudCl7XG4gICAgcmV0dXJuIHBhcmVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7XG4gIH1cbiAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0KTtcbn07XG5cbnZhciBnZXRFbGVtZW50ID0gKGZ1bmN0aW9uIChmbikge1xuXHR2YXIgbWVtbyA9IHt9O1xuXG5cdHJldHVybiBmdW5jdGlvbih0YXJnZXQsIHBhcmVudCkge1xuICAgICAgICAgICAgICAgIC8vIElmIHBhc3NpbmcgZnVuY3Rpb24gaW4gb3B0aW9ucywgdGhlbiB1c2UgaXQgZm9yIHJlc29sdmUgXCJoZWFkXCIgZWxlbWVudC5cbiAgICAgICAgICAgICAgICAvLyBVc2VmdWwgZm9yIFNoYWRvdyBSb290IHN0eWxlIGkuZVxuICAgICAgICAgICAgICAgIC8vIHtcbiAgICAgICAgICAgICAgICAvLyAgIGluc2VydEludG86IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9vXCIpLnNoYWRvd1Jvb3QgfVxuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1lbW9bdGFyZ2V0XSA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0dmFyIHN0eWxlVGFyZ2V0ID0gZ2V0VGFyZ2V0LmNhbGwodGhpcywgdGFyZ2V0LCBwYXJlbnQpO1xuXHRcdFx0Ly8gU3BlY2lhbCBjYXNlIHRvIHJldHVybiBoZWFkIG9mIGlmcmFtZSBpbnN0ZWFkIG9mIGlmcmFtZSBpdHNlbGZcblx0XHRcdGlmICh3aW5kb3cuSFRNTElGcmFtZUVsZW1lbnQgJiYgc3R5bGVUYXJnZXQgaW5zdGFuY2VvZiB3aW5kb3cuSFRNTElGcmFtZUVsZW1lbnQpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHQvLyBUaGlzIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uIGlmIGFjY2VzcyB0byBpZnJhbWUgaXMgYmxvY2tlZFxuXHRcdFx0XHRcdC8vIGR1ZSB0byBjcm9zcy1vcmlnaW4gcmVzdHJpY3Rpb25zXG5cdFx0XHRcdFx0c3R5bGVUYXJnZXQgPSBzdHlsZVRhcmdldC5jb250ZW50RG9jdW1lbnQuaGVhZDtcblx0XHRcdFx0fSBjYXRjaChlKSB7XG5cdFx0XHRcdFx0c3R5bGVUYXJnZXQgPSBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRtZW1vW3RhcmdldF0gPSBzdHlsZVRhcmdldDtcblx0XHR9XG5cdFx0cmV0dXJuIG1lbW9bdGFyZ2V0XVxuXHR9O1xufSkoKTtcblxudmFyIHNpbmdsZXRvbiA9IG51bGw7XG52YXJcdHNpbmdsZXRvbkNvdW50ZXIgPSAwO1xudmFyXHRzdHlsZXNJbnNlcnRlZEF0VG9wID0gW107XG5cbnZhclx0Zml4VXJscyA9IHJlcXVpcmUoXCIuL3VybHNcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obGlzdCwgb3B0aW9ucykge1xuXHRpZiAodHlwZW9mIERFQlVHICE9PSBcInVuZGVmaW5lZFwiICYmIERFQlVHKSB7XG5cdFx0aWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50XCIpO1xuXHR9XG5cblx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cblx0b3B0aW9ucy5hdHRycyA9IHR5cGVvZiBvcHRpb25zLmF0dHJzID09PSBcIm9iamVjdFwiID8gb3B0aW9ucy5hdHRycyA6IHt9O1xuXG5cdC8vIEZvcmNlIHNpbmdsZS10YWcgc29sdXRpb24gb24gSUU2LTksIHdoaWNoIGhhcyBhIGhhcmQgbGltaXQgb24gdGhlICMgb2YgPHN0eWxlPlxuXHQvLyB0YWdzIGl0IHdpbGwgYWxsb3cgb24gYSBwYWdlXG5cdGlmICghb3B0aW9ucy5zaW5nbGV0b24gJiYgdHlwZW9mIG9wdGlvbnMuc2luZ2xldG9uICE9PSBcImJvb2xlYW5cIikgb3B0aW9ucy5zaW5nbGV0b24gPSBpc09sZElFKCk7XG5cblx0Ly8gQnkgZGVmYXVsdCwgYWRkIDxzdHlsZT4gdGFncyB0byB0aGUgPGhlYWQ+IGVsZW1lbnRcbiAgICAgICAgaWYgKCFvcHRpb25zLmluc2VydEludG8pIG9wdGlvbnMuaW5zZXJ0SW50byA9IFwiaGVhZFwiO1xuXG5cdC8vIEJ5IGRlZmF1bHQsIGFkZCA8c3R5bGU+IHRhZ3MgdG8gdGhlIGJvdHRvbSBvZiB0aGUgdGFyZ2V0XG5cdGlmICghb3B0aW9ucy5pbnNlcnRBdCkgb3B0aW9ucy5pbnNlcnRBdCA9IFwiYm90dG9tXCI7XG5cblx0dmFyIHN0eWxlcyA9IGxpc3RUb1N0eWxlcyhsaXN0LCBvcHRpb25zKTtcblxuXHRhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpO1xuXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGUgKG5ld0xpc3QpIHtcblx0XHR2YXIgbWF5UmVtb3ZlID0gW107XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcblxuXHRcdFx0ZG9tU3R5bGUucmVmcy0tO1xuXHRcdFx0bWF5UmVtb3ZlLnB1c2goZG9tU3R5bGUpO1xuXHRcdH1cblxuXHRcdGlmKG5ld0xpc3QpIHtcblx0XHRcdHZhciBuZXdTdHlsZXMgPSBsaXN0VG9TdHlsZXMobmV3TGlzdCwgb3B0aW9ucyk7XG5cdFx0XHRhZGRTdHlsZXNUb0RvbShuZXdTdHlsZXMsIG9wdGlvbnMpO1xuXHRcdH1cblxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbWF5UmVtb3ZlLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBtYXlSZW1vdmVbaV07XG5cblx0XHRcdGlmKGRvbVN0eWxlLnJlZnMgPT09IDApIHtcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKykgZG9tU3R5bGUucGFydHNbal0oKTtcblxuXHRcdFx0XHRkZWxldGUgc3R5bGVzSW5Eb21bZG9tU3R5bGUuaWRdO1xuXHRcdFx0fVxuXHRcdH1cblx0fTtcbn07XG5cbmZ1bmN0aW9uIGFkZFN0eWxlc1RvRG9tIChzdHlsZXMsIG9wdGlvbnMpIHtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgaXRlbSA9IHN0eWxlc1tpXTtcblx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcblxuXHRcdGlmKGRvbVN0eWxlKSB7XG5cdFx0XHRkb21TdHlsZS5yZWZzKys7XG5cblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRkb21TdHlsZS5wYXJ0c1tqXShpdGVtLnBhcnRzW2pdKTtcblx0XHRcdH1cblxuXHRcdFx0Zm9yKDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0ZG9tU3R5bGUucGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBwYXJ0cyA9IFtdO1xuXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRwYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcblx0XHRcdH1cblxuXHRcdFx0c3R5bGVzSW5Eb21baXRlbS5pZF0gPSB7aWQ6IGl0ZW0uaWQsIHJlZnM6IDEsIHBhcnRzOiBwYXJ0c307XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIGxpc3RUb1N0eWxlcyAobGlzdCwgb3B0aW9ucykge1xuXHR2YXIgc3R5bGVzID0gW107XG5cdHZhciBuZXdTdHlsZXMgPSB7fTtcblxuXHRmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgaXRlbSA9IGxpc3RbaV07XG5cdFx0dmFyIGlkID0gb3B0aW9ucy5iYXNlID8gaXRlbVswXSArIG9wdGlvbnMuYmFzZSA6IGl0ZW1bMF07XG5cdFx0dmFyIGNzcyA9IGl0ZW1bMV07XG5cdFx0dmFyIG1lZGlhID0gaXRlbVsyXTtcblx0XHR2YXIgc291cmNlTWFwID0gaXRlbVszXTtcblx0XHR2YXIgcGFydCA9IHtjc3M6IGNzcywgbWVkaWE6IG1lZGlhLCBzb3VyY2VNYXA6IHNvdXJjZU1hcH07XG5cblx0XHRpZighbmV3U3R5bGVzW2lkXSkgc3R5bGVzLnB1c2gobmV3U3R5bGVzW2lkXSA9IHtpZDogaWQsIHBhcnRzOiBbcGFydF19KTtcblx0XHRlbHNlIG5ld1N0eWxlc1tpZF0ucGFydHMucHVzaChwYXJ0KTtcblx0fVxuXG5cdHJldHVybiBzdHlsZXM7XG59XG5cbmZ1bmN0aW9uIGluc2VydFN0eWxlRWxlbWVudCAob3B0aW9ucywgc3R5bGUpIHtcblx0dmFyIHRhcmdldCA9IGdldEVsZW1lbnQob3B0aW9ucy5pbnNlcnRJbnRvKVxuXG5cdGlmICghdGFyZ2V0KSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiQ291bGRuJ3QgZmluZCBhIHN0eWxlIHRhcmdldC4gVGhpcyBwcm9iYWJseSBtZWFucyB0aGF0IHRoZSB2YWx1ZSBmb3IgdGhlICdpbnNlcnRJbnRvJyBwYXJhbWV0ZXIgaXMgaW52YWxpZC5cIik7XG5cdH1cblxuXHR2YXIgbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AgPSBzdHlsZXNJbnNlcnRlZEF0VG9wW3N0eWxlc0luc2VydGVkQXRUb3AubGVuZ3RoIC0gMV07XG5cblx0aWYgKG9wdGlvbnMuaW5zZXJ0QXQgPT09IFwidG9wXCIpIHtcblx0XHRpZiAoIWxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wKSB7XG5cdFx0XHR0YXJnZXQuaW5zZXJ0QmVmb3JlKHN0eWxlLCB0YXJnZXQuZmlyc3RDaGlsZCk7XG5cdFx0fSBlbHNlIGlmIChsYXN0U3R5bGVFbGVtZW50SW5zZXJ0ZWRBdFRvcC5uZXh0U2libGluZykge1xuXHRcdFx0dGFyZ2V0Lmluc2VydEJlZm9yZShzdHlsZSwgbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0YXJnZXQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuXHRcdH1cblx0XHRzdHlsZXNJbnNlcnRlZEF0VG9wLnB1c2goc3R5bGUpO1xuXHR9IGVsc2UgaWYgKG9wdGlvbnMuaW5zZXJ0QXQgPT09IFwiYm90dG9tXCIpIHtcblx0XHR0YXJnZXQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLmluc2VydEF0ID09PSBcIm9iamVjdFwiICYmIG9wdGlvbnMuaW5zZXJ0QXQuYmVmb3JlKSB7XG5cdFx0dmFyIG5leHRTaWJsaW5nID0gZ2V0RWxlbWVudChvcHRpb25zLmluc2VydEF0LmJlZm9yZSwgdGFyZ2V0KTtcblx0XHR0YXJnZXQuaW5zZXJ0QmVmb3JlKHN0eWxlLCBuZXh0U2libGluZyk7XG5cdH0gZWxzZSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiW1N0eWxlIExvYWRlcl1cXG5cXG4gSW52YWxpZCB2YWx1ZSBmb3IgcGFyYW1ldGVyICdpbnNlcnRBdCcgKCdvcHRpb25zLmluc2VydEF0JykgZm91bmQuXFxuIE11c3QgYmUgJ3RvcCcsICdib3R0b20nLCBvciBPYmplY3QuXFxuIChodHRwczovL2dpdGh1Yi5jb20vd2VicGFjay1jb250cmliL3N0eWxlLWxvYWRlciNpbnNlcnRhdClcXG5cIik7XG5cdH1cbn1cblxuZnVuY3Rpb24gcmVtb3ZlU3R5bGVFbGVtZW50IChzdHlsZSkge1xuXHRpZiAoc3R5bGUucGFyZW50Tm9kZSA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuXHRzdHlsZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlKTtcblxuXHR2YXIgaWR4ID0gc3R5bGVzSW5zZXJ0ZWRBdFRvcC5pbmRleE9mKHN0eWxlKTtcblx0aWYoaWR4ID49IDApIHtcblx0XHRzdHlsZXNJbnNlcnRlZEF0VG9wLnNwbGljZShpZHgsIDEpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVN0eWxlRWxlbWVudCAob3B0aW9ucykge1xuXHR2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG5cblx0aWYob3B0aW9ucy5hdHRycy50eXBlID09PSB1bmRlZmluZWQpIHtcblx0XHRvcHRpb25zLmF0dHJzLnR5cGUgPSBcInRleHQvY3NzXCI7XG5cdH1cblxuXHRpZihvcHRpb25zLmF0dHJzLm5vbmNlID09PSB1bmRlZmluZWQpIHtcblx0XHR2YXIgbm9uY2UgPSBnZXROb25jZSgpO1xuXHRcdGlmIChub25jZSkge1xuXHRcdFx0b3B0aW9ucy5hdHRycy5ub25jZSA9IG5vbmNlO1xuXHRcdH1cblx0fVxuXG5cdGFkZEF0dHJzKHN0eWxlLCBvcHRpb25zLmF0dHJzKTtcblx0aW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMsIHN0eWxlKTtcblxuXHRyZXR1cm4gc3R5bGU7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUxpbmtFbGVtZW50IChvcHRpb25zKSB7XG5cdHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XG5cblx0aWYob3B0aW9ucy5hdHRycy50eXBlID09PSB1bmRlZmluZWQpIHtcblx0XHRvcHRpb25zLmF0dHJzLnR5cGUgPSBcInRleHQvY3NzXCI7XG5cdH1cblx0b3B0aW9ucy5hdHRycy5yZWwgPSBcInN0eWxlc2hlZXRcIjtcblxuXHRhZGRBdHRycyhsaW5rLCBvcHRpb25zLmF0dHJzKTtcblx0aW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMsIGxpbmspO1xuXG5cdHJldHVybiBsaW5rO1xufVxuXG5mdW5jdGlvbiBhZGRBdHRycyAoZWwsIGF0dHJzKSB7XG5cdE9iamVjdC5rZXlzKGF0dHJzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcblx0XHRlbC5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyc1trZXldKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGdldE5vbmNlKCkge1xuXHRpZiAodHlwZW9mIF9fd2VicGFja19ub25jZV9fID09PSAndW5kZWZpbmVkJykge1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0cmV0dXJuIF9fd2VicGFja19ub25jZV9fO1xufVxuXG5mdW5jdGlvbiBhZGRTdHlsZSAob2JqLCBvcHRpb25zKSB7XG5cdHZhciBzdHlsZSwgdXBkYXRlLCByZW1vdmUsIHJlc3VsdDtcblxuXHQvLyBJZiBhIHRyYW5zZm9ybSBmdW5jdGlvbiB3YXMgZGVmaW5lZCwgcnVuIGl0IG9uIHRoZSBjc3Ncblx0aWYgKG9wdGlvbnMudHJhbnNmb3JtICYmIG9iai5jc3MpIHtcblx0ICAgIHJlc3VsdCA9IHR5cGVvZiBvcHRpb25zLnRyYW5zZm9ybSA9PT0gJ2Z1bmN0aW9uJ1xuXHRcdCA/IG9wdGlvbnMudHJhbnNmb3JtKG9iai5jc3MpIFxuXHRcdCA6IG9wdGlvbnMudHJhbnNmb3JtLmRlZmF1bHQob2JqLmNzcyk7XG5cblx0ICAgIGlmIChyZXN1bHQpIHtcblx0ICAgIFx0Ly8gSWYgdHJhbnNmb3JtIHJldHVybnMgYSB2YWx1ZSwgdXNlIHRoYXQgaW5zdGVhZCBvZiB0aGUgb3JpZ2luYWwgY3NzLlxuXHQgICAgXHQvLyBUaGlzIGFsbG93cyBydW5uaW5nIHJ1bnRpbWUgdHJhbnNmb3JtYXRpb25zIG9uIHRoZSBjc3MuXG5cdCAgICBcdG9iai5jc3MgPSByZXN1bHQ7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgXHQvLyBJZiB0aGUgdHJhbnNmb3JtIGZ1bmN0aW9uIHJldHVybnMgYSBmYWxzeSB2YWx1ZSwgZG9uJ3QgYWRkIHRoaXMgY3NzLlxuXHQgICAgXHQvLyBUaGlzIGFsbG93cyBjb25kaXRpb25hbCBsb2FkaW5nIG9mIGNzc1xuXHQgICAgXHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdCAgICBcdFx0Ly8gbm9vcFxuXHQgICAgXHR9O1xuXHQgICAgfVxuXHR9XG5cblx0aWYgKG9wdGlvbnMuc2luZ2xldG9uKSB7XG5cdFx0dmFyIHN0eWxlSW5kZXggPSBzaW5nbGV0b25Db3VudGVyKys7XG5cblx0XHRzdHlsZSA9IHNpbmdsZXRvbiB8fCAoc2luZ2xldG9uID0gY3JlYXRlU3R5bGVFbGVtZW50KG9wdGlvbnMpKTtcblxuXHRcdHVwZGF0ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZSwgc3R5bGVJbmRleCwgZmFsc2UpO1xuXHRcdHJlbW92ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZSwgc3R5bGVJbmRleCwgdHJ1ZSk7XG5cblx0fSBlbHNlIGlmIChcblx0XHRvYmouc291cmNlTWFwICYmXG5cdFx0dHlwZW9mIFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXG5cdFx0dHlwZW9mIFVSTC5jcmVhdGVPYmplY3RVUkwgPT09IFwiZnVuY3Rpb25cIiAmJlxuXHRcdHR5cGVvZiBVUkwucmV2b2tlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcblx0XHR0eXBlb2YgQmxvYiA9PT0gXCJmdW5jdGlvblwiICYmXG5cdFx0dHlwZW9mIGJ0b2EgPT09IFwiZnVuY3Rpb25cIlxuXHQpIHtcblx0XHRzdHlsZSA9IGNyZWF0ZUxpbmtFbGVtZW50KG9wdGlvbnMpO1xuXHRcdHVwZGF0ZSA9IHVwZGF0ZUxpbmsuYmluZChudWxsLCBzdHlsZSwgb3B0aW9ucyk7XG5cdFx0cmVtb3ZlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0cmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlKTtcblxuXHRcdFx0aWYoc3R5bGUuaHJlZikgVVJMLnJldm9rZU9iamVjdFVSTChzdHlsZS5ocmVmKTtcblx0XHR9O1xuXHR9IGVsc2Uge1xuXHRcdHN0eWxlID0gY3JlYXRlU3R5bGVFbGVtZW50KG9wdGlvbnMpO1xuXHRcdHVwZGF0ZSA9IGFwcGx5VG9UYWcuYmluZChudWxsLCBzdHlsZSk7XG5cdFx0cmVtb3ZlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0cmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlKTtcblx0XHR9O1xuXHR9XG5cblx0dXBkYXRlKG9iaik7XG5cblx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZVN0eWxlIChuZXdPYmopIHtcblx0XHRpZiAobmV3T2JqKSB7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdG5ld09iai5jc3MgPT09IG9iai5jc3MgJiZcblx0XHRcdFx0bmV3T2JqLm1lZGlhID09PSBvYmoubWVkaWEgJiZcblx0XHRcdFx0bmV3T2JqLnNvdXJjZU1hcCA9PT0gb2JqLnNvdXJjZU1hcFxuXHRcdFx0KSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0dXBkYXRlKG9iaiA9IG5ld09iaik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlbW92ZSgpO1xuXHRcdH1cblx0fTtcbn1cblxudmFyIHJlcGxhY2VUZXh0ID0gKGZ1bmN0aW9uICgpIHtcblx0dmFyIHRleHRTdG9yZSA9IFtdO1xuXG5cdHJldHVybiBmdW5jdGlvbiAoaW5kZXgsIHJlcGxhY2VtZW50KSB7XG5cdFx0dGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xuXG5cdFx0cmV0dXJuIHRleHRTdG9yZS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XG5cdH07XG59KSgpO1xuXG5mdW5jdGlvbiBhcHBseVRvU2luZ2xldG9uVGFnIChzdHlsZSwgaW5kZXgsIHJlbW92ZSwgb2JqKSB7XG5cdHZhciBjc3MgPSByZW1vdmUgPyBcIlwiIDogb2JqLmNzcztcblxuXHRpZiAoc3R5bGUuc3R5bGVTaGVldCkge1xuXHRcdHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xuXHR9IGVsc2Uge1xuXHRcdHZhciBjc3NOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKTtcblx0XHR2YXIgY2hpbGROb2RlcyA9IHN0eWxlLmNoaWxkTm9kZXM7XG5cblx0XHRpZiAoY2hpbGROb2Rlc1tpbmRleF0pIHN0eWxlLnJlbW92ZUNoaWxkKGNoaWxkTm9kZXNbaW5kZXhdKTtcblxuXHRcdGlmIChjaGlsZE5vZGVzLmxlbmd0aCkge1xuXHRcdFx0c3R5bGUuaW5zZXJ0QmVmb3JlKGNzc05vZGUsIGNoaWxkTm9kZXNbaW5kZXhdKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3R5bGUuYXBwZW5kQ2hpbGQoY3NzTm9kZSk7XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIGFwcGx5VG9UYWcgKHN0eWxlLCBvYmopIHtcblx0dmFyIGNzcyA9IG9iai5jc3M7XG5cdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcblxuXHRpZihtZWRpYSkge1xuXHRcdHN0eWxlLnNldEF0dHJpYnV0ZShcIm1lZGlhXCIsIG1lZGlhKVxuXHR9XG5cblx0aWYoc3R5bGUuc3R5bGVTaGVldCkge1xuXHRcdHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzcztcblx0fSBlbHNlIHtcblx0XHR3aGlsZShzdHlsZS5maXJzdENoaWxkKSB7XG5cdFx0XHRzdHlsZS5yZW1vdmVDaGlsZChzdHlsZS5maXJzdENoaWxkKTtcblx0XHR9XG5cblx0XHRzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcblx0fVxufVxuXG5mdW5jdGlvbiB1cGRhdGVMaW5rIChsaW5rLCBvcHRpb25zLCBvYmopIHtcblx0dmFyIGNzcyA9IG9iai5jc3M7XG5cdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xuXG5cdC8qXG5cdFx0SWYgY29udmVydFRvQWJzb2x1dGVVcmxzIGlzbid0IGRlZmluZWQsIGJ1dCBzb3VyY2VtYXBzIGFyZSBlbmFibGVkXG5cdFx0YW5kIHRoZXJlIGlzIG5vIHB1YmxpY1BhdGggZGVmaW5lZCB0aGVuIGxldHMgdHVybiBjb252ZXJ0VG9BYnNvbHV0ZVVybHNcblx0XHRvbiBieSBkZWZhdWx0LiAgT3RoZXJ3aXNlIGRlZmF1bHQgdG8gdGhlIGNvbnZlcnRUb0Fic29sdXRlVXJscyBvcHRpb25cblx0XHRkaXJlY3RseVxuXHQqL1xuXHR2YXIgYXV0b0ZpeFVybHMgPSBvcHRpb25zLmNvbnZlcnRUb0Fic29sdXRlVXJscyA9PT0gdW5kZWZpbmVkICYmIHNvdXJjZU1hcDtcblxuXHRpZiAob3B0aW9ucy5jb252ZXJ0VG9BYnNvbHV0ZVVybHMgfHwgYXV0b0ZpeFVybHMpIHtcblx0XHRjc3MgPSBmaXhVcmxzKGNzcyk7XG5cdH1cblxuXHRpZiAoc291cmNlTWFwKSB7XG5cdFx0Ly8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjY2MDM4NzVcblx0XHRjc3MgKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSArIFwiICovXCI7XG5cdH1cblxuXHR2YXIgYmxvYiA9IG5ldyBCbG9iKFtjc3NdLCB7IHR5cGU6IFwidGV4dC9jc3NcIiB9KTtcblxuXHR2YXIgb2xkU3JjID0gbGluay5ocmVmO1xuXG5cdGxpbmsuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG5cblx0aWYob2xkU3JjKSBVUkwucmV2b2tlT2JqZWN0VVJMKG9sZFNyYyk7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc3R5bGUtbG9hZGVyL2xpYi9hZGRTdHlsZXMuanNcbi8vIG1vZHVsZSBpZCA9IDE0NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJcbi8qKlxuICogV2hlbiBzb3VyY2UgbWFwcyBhcmUgZW5hYmxlZCwgYHN0eWxlLWxvYWRlcmAgdXNlcyBhIGxpbmsgZWxlbWVudCB3aXRoIGEgZGF0YS11cmkgdG9cbiAqIGVtYmVkIHRoZSBjc3Mgb24gdGhlIHBhZ2UuIFRoaXMgYnJlYWtzIGFsbCByZWxhdGl2ZSB1cmxzIGJlY2F1c2Ugbm93IHRoZXkgYXJlIHJlbGF0aXZlIHRvIGFcbiAqIGJ1bmRsZSBpbnN0ZWFkIG9mIHRoZSBjdXJyZW50IHBhZ2UuXG4gKlxuICogT25lIHNvbHV0aW9uIGlzIHRvIG9ubHkgdXNlIGZ1bGwgdXJscywgYnV0IHRoYXQgbWF5IGJlIGltcG9zc2libGUuXG4gKlxuICogSW5zdGVhZCwgdGhpcyBmdW5jdGlvbiBcImZpeGVzXCIgdGhlIHJlbGF0aXZlIHVybHMgdG8gYmUgYWJzb2x1dGUgYWNjb3JkaW5nIHRvIHRoZSBjdXJyZW50IHBhZ2UgbG9jYXRpb24uXG4gKlxuICogQSBydWRpbWVudGFyeSB0ZXN0IHN1aXRlIGlzIGxvY2F0ZWQgYXQgYHRlc3QvZml4VXJscy5qc2AgYW5kIGNhbiBiZSBydW4gdmlhIHRoZSBgbnBtIHRlc3RgIGNvbW1hbmQuXG4gKlxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGNzcykge1xuICAvLyBnZXQgY3VycmVudCBsb2NhdGlvblxuICB2YXIgbG9jYXRpb24gPSB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdy5sb2NhdGlvbjtcblxuICBpZiAoIWxvY2F0aW9uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiZml4VXJscyByZXF1aXJlcyB3aW5kb3cubG9jYXRpb25cIik7XG4gIH1cblxuXHQvLyBibGFuayBvciBudWxsP1xuXHRpZiAoIWNzcyB8fCB0eXBlb2YgY3NzICE9PSBcInN0cmluZ1wiKSB7XG5cdCAgcmV0dXJuIGNzcztcbiAgfVxuXG4gIHZhciBiYXNlVXJsID0gbG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyBsb2NhdGlvbi5ob3N0O1xuICB2YXIgY3VycmVudERpciA9IGJhc2VVcmwgKyBsb2NhdGlvbi5wYXRobmFtZS5yZXBsYWNlKC9cXC9bXlxcL10qJC8sIFwiL1wiKTtcblxuXHQvLyBjb252ZXJ0IGVhY2ggdXJsKC4uLilcblx0Lypcblx0VGhpcyByZWd1bGFyIGV4cHJlc3Npb24gaXMganVzdCBhIHdheSB0byByZWN1cnNpdmVseSBtYXRjaCBicmFja2V0cyB3aXRoaW5cblx0YSBzdHJpbmcuXG5cblx0IC91cmxcXHMqXFwoICA9IE1hdGNoIG9uIHRoZSB3b3JkIFwidXJsXCIgd2l0aCBhbnkgd2hpdGVzcGFjZSBhZnRlciBpdCBhbmQgdGhlbiBhIHBhcmVuc1xuXHQgICAoICA9IFN0YXJ0IGEgY2FwdHVyaW5nIGdyb3VwXG5cdCAgICAgKD86ICA9IFN0YXJ0IGEgbm9uLWNhcHR1cmluZyBncm91cFxuXHQgICAgICAgICBbXikoXSAgPSBNYXRjaCBhbnl0aGluZyB0aGF0IGlzbid0IGEgcGFyZW50aGVzZXNcblx0ICAgICAgICAgfCAgPSBPUlxuXHQgICAgICAgICBcXCggID0gTWF0Y2ggYSBzdGFydCBwYXJlbnRoZXNlc1xuXHQgICAgICAgICAgICAgKD86ICA9IFN0YXJ0IGFub3RoZXIgbm9uLWNhcHR1cmluZyBncm91cHNcblx0ICAgICAgICAgICAgICAgICBbXikoXSsgID0gTWF0Y2ggYW55dGhpbmcgdGhhdCBpc24ndCBhIHBhcmVudGhlc2VzXG5cdCAgICAgICAgICAgICAgICAgfCAgPSBPUlxuXHQgICAgICAgICAgICAgICAgIFxcKCAgPSBNYXRjaCBhIHN0YXJ0IHBhcmVudGhlc2VzXG5cdCAgICAgICAgICAgICAgICAgICAgIFteKShdKiAgPSBNYXRjaCBhbnl0aGluZyB0aGF0IGlzbid0IGEgcGFyZW50aGVzZXNcblx0ICAgICAgICAgICAgICAgICBcXCkgID0gTWF0Y2ggYSBlbmQgcGFyZW50aGVzZXNcblx0ICAgICAgICAgICAgICkgID0gRW5kIEdyb3VwXG4gICAgICAgICAgICAgICpcXCkgPSBNYXRjaCBhbnl0aGluZyBhbmQgdGhlbiBhIGNsb3NlIHBhcmVuc1xuICAgICAgICAgICkgID0gQ2xvc2Ugbm9uLWNhcHR1cmluZyBncm91cFxuICAgICAgICAgICogID0gTWF0Y2ggYW55dGhpbmdcbiAgICAgICApICA9IENsb3NlIGNhcHR1cmluZyBncm91cFxuXHQgXFwpICA9IE1hdGNoIGEgY2xvc2UgcGFyZW5zXG5cblx0IC9naSAgPSBHZXQgYWxsIG1hdGNoZXMsIG5vdCB0aGUgZmlyc3QuICBCZSBjYXNlIGluc2Vuc2l0aXZlLlxuXHQgKi9cblx0dmFyIGZpeGVkQ3NzID0gY3NzLnJlcGxhY2UoL3VybFxccypcXCgoKD86W14pKF18XFwoKD86W14pKF0rfFxcKFteKShdKlxcKSkqXFwpKSopXFwpL2dpLCBmdW5jdGlvbihmdWxsTWF0Y2gsIG9yaWdVcmwpIHtcblx0XHQvLyBzdHJpcCBxdW90ZXMgKGlmIHRoZXkgZXhpc3QpXG5cdFx0dmFyIHVucXVvdGVkT3JpZ1VybCA9IG9yaWdVcmxcblx0XHRcdC50cmltKClcblx0XHRcdC5yZXBsYWNlKC9eXCIoLiopXCIkLywgZnVuY3Rpb24obywgJDEpeyByZXR1cm4gJDE7IH0pXG5cdFx0XHQucmVwbGFjZSgvXicoLiopJyQvLCBmdW5jdGlvbihvLCAkMSl7IHJldHVybiAkMTsgfSk7XG5cblx0XHQvLyBhbHJlYWR5IGEgZnVsbCB1cmw/IG5vIGNoYW5nZVxuXHRcdGlmICgvXigjfGRhdGE6fGh0dHA6XFwvXFwvfGh0dHBzOlxcL1xcL3xmaWxlOlxcL1xcL1xcL3xcXHMqJCkvaS50ZXN0KHVucXVvdGVkT3JpZ1VybCkpIHtcblx0XHQgIHJldHVybiBmdWxsTWF0Y2g7XG5cdFx0fVxuXG5cdFx0Ly8gY29udmVydCB0aGUgdXJsIHRvIGEgZnVsbCB1cmxcblx0XHR2YXIgbmV3VXJsO1xuXG5cdFx0aWYgKHVucXVvdGVkT3JpZ1VybC5pbmRleE9mKFwiLy9cIikgPT09IDApIHtcblx0XHQgIFx0Ly9UT0RPOiBzaG91bGQgd2UgYWRkIHByb3RvY29sP1xuXHRcdFx0bmV3VXJsID0gdW5xdW90ZWRPcmlnVXJsO1xuXHRcdH0gZWxzZSBpZiAodW5xdW90ZWRPcmlnVXJsLmluZGV4T2YoXCIvXCIpID09PSAwKSB7XG5cdFx0XHQvLyBwYXRoIHNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYmFzZSB1cmxcblx0XHRcdG5ld1VybCA9IGJhc2VVcmwgKyB1bnF1b3RlZE9yaWdVcmw7IC8vIGFscmVhZHkgc3RhcnRzIHdpdGggJy8nXG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIHBhdGggc2hvdWxkIGJlIHJlbGF0aXZlIHRvIGN1cnJlbnQgZGlyZWN0b3J5XG5cdFx0XHRuZXdVcmwgPSBjdXJyZW50RGlyICsgdW5xdW90ZWRPcmlnVXJsLnJlcGxhY2UoL15cXC5cXC8vLCBcIlwiKTsgLy8gU3RyaXAgbGVhZGluZyAnLi8nXG5cdFx0fVxuXG5cdFx0Ly8gc2VuZCBiYWNrIHRoZSBmaXhlZCB1cmwoLi4uKVxuXHRcdHJldHVybiBcInVybChcIiArIEpTT04uc3RyaW5naWZ5KG5ld1VybCkgKyBcIilcIjtcblx0fSk7XG5cblx0Ly8gc2VuZCBiYWNrIHRoZSBmaXhlZCBjc3Ncblx0cmV0dXJuIGZpeGVkQ3NzO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9zdHlsZS1sb2FkZXIvbGliL3VybHMuanNcbi8vIG1vZHVsZSBpZCA9IDE0N1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgc2NvcGUgPSAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBnbG9iYWwpIHx8XG4gICAgICAgICAgICAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgJiYgc2VsZikgfHxcbiAgICAgICAgICAgIHdpbmRvdztcbnZhciBhcHBseSA9IEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseTtcblxuLy8gRE9NIEFQSXMsIGZvciBjb21wbGV0ZW5lc3NcblxuZXhwb3J0cy5zZXRUaW1lb3V0ID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgVGltZW91dChhcHBseS5jYWxsKHNldFRpbWVvdXQsIHNjb3BlLCBhcmd1bWVudHMpLCBjbGVhclRpbWVvdXQpO1xufTtcbmV4cG9ydHMuc2V0SW50ZXJ2YWwgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBUaW1lb3V0KGFwcGx5LmNhbGwoc2V0SW50ZXJ2YWwsIHNjb3BlLCBhcmd1bWVudHMpLCBjbGVhckludGVydmFsKTtcbn07XG5leHBvcnRzLmNsZWFyVGltZW91dCA9XG5leHBvcnRzLmNsZWFySW50ZXJ2YWwgPSBmdW5jdGlvbih0aW1lb3V0KSB7XG4gIGlmICh0aW1lb3V0KSB7XG4gICAgdGltZW91dC5jbG9zZSgpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBUaW1lb3V0KGlkLCBjbGVhckZuKSB7XG4gIHRoaXMuX2lkID0gaWQ7XG4gIHRoaXMuX2NsZWFyRm4gPSBjbGVhckZuO1xufVxuVGltZW91dC5wcm90b3R5cGUudW5yZWYgPSBUaW1lb3V0LnByb3RvdHlwZS5yZWYgPSBmdW5jdGlvbigpIHt9O1xuVGltZW91dC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5fY2xlYXJGbi5jYWxsKHNjb3BlLCB0aGlzLl9pZCk7XG59O1xuXG4vLyBEb2VzIG5vdCBzdGFydCB0aGUgdGltZSwganVzdCBzZXRzIHVwIHRoZSBtZW1iZXJzIG5lZWRlZC5cbmV4cG9ydHMuZW5yb2xsID0gZnVuY3Rpb24oaXRlbSwgbXNlY3MpIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IG1zZWNzO1xufTtcblxuZXhwb3J0cy51bmVucm9sbCA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IC0xO1xufTtcblxuZXhwb3J0cy5fdW5yZWZBY3RpdmUgPSBleHBvcnRzLmFjdGl2ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuXG4gIHZhciBtc2VjcyA9IGl0ZW0uX2lkbGVUaW1lb3V0O1xuICBpZiAobXNlY3MgPj0gMCkge1xuICAgIGl0ZW0uX2lkbGVUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uIG9uVGltZW91dCgpIHtcbiAgICAgIGlmIChpdGVtLl9vblRpbWVvdXQpXG4gICAgICAgIGl0ZW0uX29uVGltZW91dCgpO1xuICAgIH0sIG1zZWNzKTtcbiAgfVxufTtcblxuLy8gc2V0aW1tZWRpYXRlIGF0dGFjaGVzIGl0c2VsZiB0byB0aGUgZ2xvYmFsIG9iamVjdFxucmVxdWlyZShcInNldGltbWVkaWF0ZVwiKTtcbi8vIE9uIHNvbWUgZXhvdGljIGVudmlyb25tZW50cywgaXQncyBub3QgY2xlYXIgd2hpY2ggb2JqZWN0IGBzZXRpbW1lZGlhdGVgIHdhc1xuLy8gYWJsZSB0byBpbnN0YWxsIG9udG8uICBTZWFyY2ggZWFjaCBwb3NzaWJpbGl0eSBpbiB0aGUgc2FtZSBvcmRlciBhcyB0aGVcbi8vIGBzZXRpbW1lZGlhdGVgIGxpYnJhcnkuXG5leHBvcnRzLnNldEltbWVkaWF0ZSA9ICh0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmLnNldEltbWVkaWF0ZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgKHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgJiYgZ2xvYmFsLnNldEltbWVkaWF0ZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMgJiYgdGhpcy5zZXRJbW1lZGlhdGUpO1xuZXhwb3J0cy5jbGVhckltbWVkaWF0ZSA9ICh0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmLmNsZWFySW1tZWRpYXRlKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICh0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiICYmIGdsb2JhbC5jbGVhckltbWVkaWF0ZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAodGhpcyAmJiB0aGlzLmNsZWFySW1tZWRpYXRlKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi90aW1lcnMtYnJvd3NlcmlmeS9tYWluLmpzXG4vLyBtb2R1bGUgaWQgPSAxNDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBcImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBVTBBQUFHRENBTUFBQUNZekxJeUFBQUNXRkJNVkVVQUFBQUFrUDhBa1A4QWtQOEFrUDhBa1A4QWtQOEFrUDhBa1A4QWtQOEFrUDhCa1A4QWtQOEFrUDhBa1A4QWtQOEJrZjhBa1A4QWtQOERrZjhCa1A4QmtQOEJrZjhWai95NDRQOFJsLy8vZHJiL2RyWngvK24vZHJaeC8rbi9kcmIvZHJaeC8rbi9kcmYvZHJady8rcHUvdXB4LytuL2RyZHgvK2xXdHYvL2RyYi9kcmJMNmY5dy8rcitkcmR4LytuL2RyWncvK3B1L3V0eC8rbGw5ZXhNc3Y5eC8rbHgvK2x3LytyL2RyYi9kcmIvZHJiOGRyZitkcmR4LytuaDh2OXErdXpSN1A5dy8rcGh1Ly9lOGY4d3BmOXMrK3FKelA4RWsvOXcvdXJaN3Y5di91cmw5UDl4LytuOWRyZi9kcmI5ZHJkRHJ2OXgvK2wydy85dXdmOXUvZXBzKytweC8rbXQzUC8vZHJZN3F2Ly9kclo3eHYvMmQ3bWwyUDl4Lytrbm92OXgvK20rNC8vVzdmKzAzLzlJMS9IOGRyZi9kcllydS9pWjAvK0F5UC9CNVAvL2RyWngvK2tYcC90cHZ2L3Q5Lzg2eXZYL2RyYVUwUDhnbnYvK2RyYnA5di8vZHJaK2c5eHgvK21TZ2RaSzJmSEY1djl4LytuV2U4UHkrZjhYcC91UXovLy9kclliblAvMy9QK2YxZjl4LytrVnBmc3h3UFpPM3ZEL2RyYmZlY0FyalBNd2kvSWt0UG5jZXNCeC8rbFY1ZTlXaCtkeC8ra2hqZlk5aXU1K2c5dWNnTk1hanZoeC8rbUR5ZjhLbXY2K2ZjbU9ndGU0ZmNyL2RyYTVmY3BHaWV4T2lPa3BqUFN3ZnMxSjJQRVZwZnVJZ3RrcHVmY291UGovZHJiL2RyYnRlTHpTZThNUG9QeW9mODlLaWVzUG9QenJlTHhnaHVROHkvUngvK24vZHJaeC8ra2t0UG5HZk1jOXpmTkxpZXJsZWI2NGZjdGQ3TzNvZUwxeC8rbi9kclpiNnZqLy8vLy9kclp4Lytsdi9leHIrdkVrS1pxOUFBQUF3M1JTVGxNQWVVS0VXRzlubWxDTUtobzJZSk1WQ2tvbER5RXdPZ2Jmb1hxRVo1UjNabTZFTjB4UEk0eFVrN2lOUk9aRUgxcWNMamFjQ2JSZ2JUOHFZRm9WUDN6eEZlcEt2TytyRDh5Z1Z1MHA4M0VQZFRDeE9zUENIUm5nMnVDdUpjVUsxKzJwb2VIdDNROFpveDdSeCtMdm1FQys5eGF6ejZjRzljVkQ4ZzhpNUxrbStTdk42cVg4MDZsSU55K3NRR1JYTHpmQVNEVzBYRXdoRldmNHlGSXZMQnJtSVZSRFFqWXBZallsVWRqUGJGNVlUaGhzVTB4Sng3ck9XMVJCS1VsQ1BHVFordXhFek95NkFBQkRmRWxFUVZSNDJ1eWN6MDVpU1JUR1oyemFLOW9peVA5SHVBbGIxb1FBb1VQWUVGa1FRb3dCTjhwQ0V3MHJFMk5zWDZKZmh4ZWIrbnUvVy9kVVVWeXdwM3NtZkdhU25obTcrOVN2dm5PcTZsVGhYd2NkZE5CQkJ4MTAwRUVISFhUUS8xZFZLZllMOFhYUXJoenp4UXVpSWxOZWlqUCtqeEd1Q25Qa0RVVURxdjZ5a2VRNXliT3pVdWxTcXlSMUZnbUFkU3gvSU5pcUFLaXg2WWpQckpKRCtmUVFGTW5MMDlOeXVmeE5xcXgwR2lsaURMZ2crMXZRZ21BRTBNUlhVdTQ0TllRQjhiRjhMdEZxVVpQOFZxa2NXVlRoaWpPTzJDYkovbXRvNFVBQUJEL2c0K2JRcWlRa2hzTUhBcUtmZ1BLQ29XUWtCY2pDU1VLRms0SlVnbS9FOWpTRzFxd0luMTJjWUVBSFFNMFA4SXlnQzFwc1VCZ1JHd21JN3NzU0tEbklUT2FjNlpqcEhNcEVpZ0UybkF1eUZ0Y0NyYWE3SFYrc0hyUUF1Z0VhOUxRM01nNkowWURvbmp6empHV0VNc014ZmhYNisrK3ZobzZGQU5sZ3l3U3lFVm9tZ2haMEZXR0lBVk82NEY4R08xSUFDVUFuUHhrdWovdllLakVXRUFYUDNZekpXTEkvU2FKa0ZKbStHUG9iK3NxL1RMd2dDN1JHUFRBS0F1aGlNYU1xU1YxS1JiK3RESDRPZ09BSGRDcGNFVHVFRVltaFJFVEJjMGRqTXBZRkZnZEh5VUZtczlsY1hGbUlNSlpzQ1ZtZ0JWdkR0c1ppUmxWV3d1SUJmRnNBTlBDWjNzZ21wSWNTRWQyRFoxNFlrN0VFeWx3UUJMM213OVdzMzU5ZGpSODZZWE0wN1UwRENJUUIxN0N0VVJBSVdzNldxZ0lkV1NVV0R2QnpBeFF5NmVXRUFvZjRhTVFRUk9neG52blVNSVV4T1V2bHlpQm85cGV0TmRHUDE4ZGh0OTJZVDY3dit2ZFhuWEEwMVlBSldpU1FqYTFXY3NOd29yL0VMeU9CSGZoNUFGSitZZGdaei9wdmQ5ZVQyL2xMbzkwZWRGdXQxbkE0N0M0YUwvUHIvamo4SGtSRXdiTjBWa3dGczhoZ0NtTUtsaXlHWVByV1htK3I0WURCL1hpYlBZU2pVY3kySUd0aGF4Ui9MWTRwamt5dkcyQUhmRzZBaE45OS8yNXl1MndQaG8vK29keis3RWlpNE1udFdheW1nTWxMcGpJbXovQmV2N0hlVVkrdGRxUEdiSHZWYVk2UVFWd0dXN3FVUVFsaUlDZStnTS9sd0dZekhOKy9mVXptalVXTDh2TnIrUEhRK1I3bldVRzJid1h6OHJSeXBJekpXQUxsZm5wbHBsM2VDclJoczBuUWdpMElReFFiNEFGZkRPQ01PYkQyMHU2dVBpUDA0Umc4R1U2UzdYNll5cGhnK2JsYWRkc3Z0Y2xIZnpZR1d1QVZoRGxrVXptZ00xYVBVWk5uTUN1QXQwczQ4Rk0xZk5BOG8yemZFbVpadzJUMTh0ZkFwQVdCMS8xYnRwUzlzYlZzekx3THdvWkdURTJPYnZhekx4WVBScStMQXZnck5aVDUvbFZtKzNZNDh3Wk1zUHdOK3ZIangrdnI0K05xT0dRTDdXcjErTXIrdy9wM2FoaCt6M0djNXdwbmZwdXQwUjhDODAvVWtPTmtQQVhPMGtWMWkzMm1odm05dlQ0b2lmTTlrTmwrd21vbmN0MEhNeHM4ZDljSEVhMVl0aXVjNWMybHMzcHhCcGk5MWZvZ20xb0M1M25HVnpxTFowano2ZXY2b0EwNFVUcWQxaXlWandxcVpyYldOclVuL2F1SHNQTnd4VFlvVDN5SFVsczJ4Qkh0L3lEV2NsaTF1TmFyVncvT0xFcm5abXVldTFmeldnK2JhN1AxVXE4L1Q1djhCTXdQY04zL1JvMWdoOTRYZGpJVHg0ZHA3NzFlTndjMDdVeGFydDhhQnFKMEZsanBkSmt6cjZ6cGdGbWIxZ08yZXlYQ09ZVkx4OUpyZG1aOWRqSlpETmQva0lhTHh1MzEwODl4T09wSmVPZ2pVdVhZT0pwUGJldEVQTXZTQ1hQU1BOZld6RnBndGtPR01pdTZwMHJPSXpUWVJyWU54LzI3MzJUYTRZQjNYUmpBNmJNR0NId3doN1VsSUlpKzEyeTVIakNjTUtjcno0VTFlOVNZUVU2aWpQcGw3QmZpUytnclJXd1lOMjdhVVhqRit4R053V2U3Rmhrc0hIalBBTjVvZ09CSDZkRisxVmM1SUVrMEY5UnJOcHpaamVaVWVRNXJtakMvU0pRWjBxeEZ0NWIwdTBHV29JVnI3NSt1YjE4V3JkZmQ2UTE1LzRRWHdBZkp6d3N3am83YlFpblpTRDBXdHc0T25oMnJPWkhvbDNvSkN0ZW11cjFBSFU4ekp3VjZrOENWUUF5MklPdEdxOW0rMzB5Ym9obis5REZodTRYNWZQblNZQTN4eGFEYjdRNFc3WGFqc1p6WGJpZVQ2K3VQSjdaMmRGajFZL0EwUFNRd0FEcjRHZkJPSU55b0YrUlkyQmdVVDRLemF6Y25FcjF5WkYyQ0d1K3lkU0pSaWl1d2I1QytzcW5Zcjdrb1dUZGE5Q205UWxzVStOd0dwSGZUOUhKYWZrbkp3YWlMYjlYbGZVNG03QmptdENZNnI1bzB6eGVCUHVnTGxPSjY5aEkzc05ZN1dNQUZXUVB0T1dFTHVwNTdSQWpzd004TE1JYVBhY01WYVptTmhBTVZQR0ZQYWs0Y2lNaGU4MHMydVFSTm95YlV0ekovUW5JQm1kZmNBcktNUXMwc01naW1wV2hoVytEMUNlaG8vYVAzekxqYWhDRVpTQUV3K2R3UEF4SmpFVHlWUGVjbW1DdHB6b29sMWJIWDdDY1hvS3pLY3Q2K3Z5aksrNlVxRjE0OGNyRTNOcHBrUVFHTGwzZjlDc1h6OE1MY0xWQ3AvMmw3dWhPdmZqQ2dpQVpGSi9Fa0JnWXBTbUU4OGxrZzU2bnNtYXZiek1tYUg2V0xQRm1Ec05ja3E3bHEzcGN1SkVvcXdaS2hsQ1JGMkliZHpGY29SajJBY1NCamNjV1grSGZyMmdGOHlHQXpHaTRZMlFpbXpIZ1dpL2JIdjVLbnRHYzJtZXRoN290YWh4S1ZNODhUWFZoemF2Nk91dGowOHl6SFBaMmRwUXcrbzk4ckpSTVRyMUFLM0JSbHZCY0NXZ0VYS2pES2tHSUdnUjU5M2tTamNRZHpCSjdXb1RFeWFoK2V3UGtVU0tOOXd5WUpLM3BCckVFdk5NL0Z5c1grUGp2TXZHU3AzOWpJOTBySkpVU3RHR0lRYWdpbnFMVkt4cHVZQ3Y4aTR2OVZ5M3lOaXdKSW9oSGgySU1SUUFWUDEvaVlQeS9MZXU5WXA2bCtMTXlaSjJWVEpQcU5lWjRNY2hvL1NpMzUyMVQwSW5oOUlzdXA3WGxQdHhQNGJrWU9RZzVCanNCNFpxbnBBckJMdHJmaUYwSWtHclljNjNBQ3ZUbk5JUmcxdXpMM2lnNjM0RnhqbXJQSmNlcDFpTkpNN3R4RG1lZnV3MzFlWklMZVNPallnL3JvNm1QZWphN0VYaGUxcDNHdkxvbnFJVVNPcUVhVkg1c0ZuK0t2RXZIbzN4Vk5yOU9mdEZ1aXpmYTZhckd1WWdmQnNHZ1V6MU9uUGM4dXhabWJtUE5ITDFxSHlDTEV2ejE0TXF0bWxPZjJtcG1YVnREUmY1RWsrOHUxVmJVWkg0UWFBaHlSdHp4ejlhbktSRWR0aTZaM1g5c1FEQU9xZVNJWVY2dVNtblBHMXlGZE9Pa2lGTXdUVlhOam5oZk50MTg4K0NhSm5iUkl4UkRnQ0V6VWprS2FwSTJtMW1SQU5VKzliZG5jcTJ5YVcwN1F0QzVDZzNWTVBWRTFrZWNrZkx6OVFuUEFwOGFNRFFHT3dBajJFZElFMFR4dkUwM3RXZk5rd1NEYmFhNHJjOVpkTkwyTFVKdFpVMzF6M2hrK1RsNStsdkE4SE9FYXdZNVBKTk5IVXhQK2xNRTRzNzNJelVuUDNlT05OTTFqNVNSUTUvcFMwUm0rc2dLSjN1UFBFSTdBQ1BhR1dVZ2JEWGlxWUZ5bHB4aVZ3cHFkcHJHa1g2b2x2Yk9PcWM4VEhWWFRIajVhQXFrMEgwbEhZQVQ3dzZRTmlsVEpnbXhITUhSaHVkN29UWndyanhuTldhSWhLdFova0xlSG53dWFMK3ZVcXQwRU9US0NQV0FpVFVMYzVhUkpGcFh0Q01ha1diRmsrZ01JRVpwb2VlQWNpdDJVTTN4WUlTMVBNb0k5WWFZM0pyMWVJTUY0YUNMVDZYYnpiaDNUQ0RTOTRlOC9nclBpM2pCRnhWenVHTXhTdkNjRVRnZk50cnR1NHBXaHJTcGdwMDlyTXNKL04yWnJ4M3FGNnJ3bnpOcnV3WFNuUVk3aVRFOFROWGF5anVsWjB5eVMzZGQrNFVNdmZEbkZlZXUzd1VTdUlGWDJwbWxHVTVjMFQwSFRPQmw0dzE4czV4UCsvTGZSOVk3Z2ZMZlNpVHp4UnpNY3RCdkxScnM3OU9Na3FlS25XVFcvOTBoODc5SkRFMlk0M3hoKys3by9Hc1dmcGM4V0cwZUE5UElyZlo1MFdaOERENy9EaC82a3V4RW5UWlY4dExKOE9NNUN2aFhyVmZhYmptQjZJN1BjNGJmN1U5MzE0cEl0TVVaMDRScEJOczFLbERaUHVtOE1wUDVFVFhUcEhENjFVcVNLZGRmanB4a2Y4Q3JJNGhiSmtsbFplL2p0bjd5dllkNG9DcVFNNk5qcWlSdVNYaW1zNmNtVGJzaFFtdEdJQ2VaQVcwNmNtTnU5YUxiaWdVUTA4L2JNbXRwWWRrVHc4cnJnR0ZlOWZCRGNvUXZiNzlseEpVSTBnRWxZR3RGd3haN0VkRnIyVk1IY1Vwby92VFRSUWxvWmc3VFFqRC94SE5Eb3IyVDArdHBGNjF4LzlKWDVjK0ZNTC9naFZaNDc4NlE3Rmhzd0ZZME94M2dTYzJWWms2YVd1Y1ZwOFo3Mk55bE5GaFNQNlhVTk5VQ1R0S2FNNjJYd1Y5SHJ6M1FYOEdSQ2ZpeGJqR0Ewc09PRUgzYkk4enFsTWpDaWtUZnI3Qi9qU1l6dDFXLzNPNTFiUDAxZlEyNGU2TzVtUG1GTlpCYk4yUGg3cFlxNk1GUDNoMUhuRVRndHQzbkZuZktjbklCV1RSS04xSkcremRTbitrZHlLaUp6U3pzWm9IbThIYzFiMENUV1JHYVJvOFM1dnVQRmRhTCtjUmJSQ0FiMjlEcFBaODdpaGp3ZjFBUFZ0TXdrb3luTGFES3E0eFE4dHp4emkvY0dTWnIzb09scmIxNkRKdTNvdjF1TWliZGZGZjZFQWk5UjlJOWFLV1NpcHRQUTV1c3R6VW1yVGtoZ0ttTnlsdUxGejJVcEZneVBSdkNVazB1elBVek9MV2hlMFo0bHBTbS9kYlNPNlU3UVJPZWQzRFlSR2dLbWpGNytvQ3NsOVdPQTlBaEV2UnBRUDZRMFp4RlZwMDFoQ21PcWFFb3lHZ1J6eG5paVUwOXhOc2pjUmpUSFc5TTA1L2d0d0xjbTYxU1B3TVFIRUVYMHhUejV1VW9sTlFLVjdjbXRaejBhd0lXUEk2MDZGS1kwcGowYVJwVHpGTW1pY0hybUZ2MzBCeTlOdE40ZFJjRlhwOXBvL0ZaRTlGWFh6d09xUklhNGVkM1BuS2c2ZFF0TWZQTFpHazFWOEZTVEM1enV1UVVpWXJpTVNiTUtHenUzcHVicjQ2YnQwMTNrN1pkMUJOb1EyYURwSEVCeEwyc0NacVc4S1JveHVjRHBubHQzK3Q0Um1uUXpSUzh5VURWbG5YcWhDekxDQndzTFR4Z0N0ODFrQUlqTnJhTExtc082aU1iL0V5UHlmSEk1VHFTS2EyNzlOUE9wTGpJUXZ5M1BzenI4RXNKM3ZGclNockJzbEo3SjlUMFZZblpac3hrQUpveHBuMXpnekFhaGUyNUJNNUdXSDVybVdkNTdrWkVGVFNQK3VxVm9LcGc2Zko4aE12STQxU1VEMkhZZFFxSThKL004QzVpK1dZbmpUT2I2TytiV1NmTWFORk5lWkNEKzBMN3hybmo2azhqMjZLZy9UbVRYdHFudVRwUXVwaFl3dlRobHhWZzU1alpPTXp0eWJNblRYV1RRK0pIbnBFbmd0Wlc5ZE02a0hTcmVWSGNueWhpZmRnWk1EMDZWS3NITVBiYzQ0QmlOc3dsb3ByckljTWMvSmYxQUw0bVM4QU8xZWNPd2cxTUltV3d2QnRIVUFxWVhaOW1lNjZNY1VJRm1iM3VhY3pkTnhEOG0xdFI1WHQyMmtTYjlRTTE1azhXbXpPZnZpaTFSd2hSVFN6OFIrV0NtT3JybExwcTNkcG9WQWNyc3hDaE1LaTRhUHpaM2FSdTlxblJTYS8yRUhmeGxFNGxpV3ZNOFE2YldueXFaYzJyT2VxelVGWDJOSWM4bDJ3L1EzQkQvZmNvK0wveGdNK2VjdEZSOVpiTkhyQ256SEZPNzFjOHNVdWJzbUptQ3dwbU9KajVDWU5MTUtKbzRMNGt5RFBXd0JQbk1RSDlLQStvR3JTNWJsczJaeFpxWTJyUnorMzFvSGdiQnlrc3p6WlVsNGpkMytBdUpIUEduSEFCU25lNXhxU3dSMThpeE9kM1V3dW5ZY05QQ3VUL05SM3pnd1BpZU9kbHdvVTZsTStjSlV0M1JsSEdYelZOYjJXbm12cVMzSnJiU09EZVNUTm1KWnR0TzB4MS9UeTNDampybFg1VFJmcVczSjI1aGhhVTBUMUpZazdSOVFsdmhMTzlGazE2bjAwVUkyeU5IWnZwM1NVaDFldXZzcFducmp3Mk1TcDl1YnBsWHNLclRUc1ZPTkJkcmFBaWF6blBxSk1EaEphVklxdnVYSVhlYkJ2c3I5MVQ0NnpBKzRVTTd2THZRSE5ocCt1OUZVc2VQVkErV2p1WUFrZThvM0JGbE0yM1p3UitJNGRGaitFVjZta1pQcHhWUHVqemFUTzRXcUYvK2wrUWRKQmVSWjlsRTJVd2ZqYjF3Tm9BZ0JVM2Z3eG1uRzZhcHkyYjZsejJRWi9xSHFjdW03MlpzOEhrMEIzYWFOVWRlcGhXdEhhaDlvT2s3cGYvRDNwbnNwaEVFWVRpNzdTdzJNVW1BUnhocHJwd1JZaEFSOGdVTkI0U1FaWUV2aGdPV1FENVppaXlTbDhqcjVNWFNLMzgzUmRNend3eDJsa29VSjVIaUZGOVg5VkpkWFhYaEd2NGNsaUc0Wjk2ZTdqOHVaWGV1UHRtQUo2UEpWN0JiVDk2VVJ6eEx4eDAyaVY2YWFSSU8vVnZTN003VmN0eTBwTjI4aDduUWJHNjNsck04VDViK1pUK25xUXJMYUdxYU0vbFA5NlFaYmcramVlS2Izb2djdG43L3JHMGFCcFg4WGdoTHpMV0RacUh6NXZ4SnpadVJZOTcwM0FDbnVCZjZ2NmFYTVBhK0lBM3VMSDlzUi9WbjdEZnZpdHh2ZWpNT2ZYVW84RER3WHowTDNZT21kK3pUNUhyNDh4Zi85bk02ck1uekJoaW9IQStxLzVBWVVpZHpES25zaXlIUkJBNzNLMmx2anB3enZpa1h2Y2VMYndZNXhEY0J3QjNmSk41QTVwWTArWnZ1MlB2enZ5RDJMbGxoZE9pdUJqVEhQcHIrM0dMbnZWRC85Qys1RjFKRDIzTGNDNUYxajF5U1E1Q3k1RGcyT2U4c3c3enZMRS8zdWJOY3BMdXp4SGVEb3p2dUxOT2NCWEdrZDV6VUNyeFBuei82ZmJwTzlvQnYwdnQwMEl3OGNRcHl0cUFuZ1VQbGVzd2VJOWVESmlMUlhBOU1MZjQxazlneE1aUUQ1U0YxSGlVUENVbHlyanlrVkhFV2VncW5DWnh3cnJpNEhMbjJ2amx5cld3NWNpclh1ZS9La1hOc0lxcDBCMElyQTlEMS82RDVtOGVwOGpkN09lVnYwbmNaUXpnS0RSL1NnSnp6VVFiZGNQNHh1Y1Z4MXR4aStEbXRvbGNoZ09oK3pyM2hwRnVrUHlidnZmRTFXOTQ3L1ZnZFBIR2h6a3VMcEhpM1NCTk1ITW5mWkR3NzlKdU1WVUZ2TW1wNkRuOVhKZ3NMT1hrNkp2WElzYWg1M3d2aGlVdm05MEpYeXRHZnpIc2hPWWVma1lDcUp3VG9ZRCtFNTlsdjJVTGk2K1QxMktPOVpidGRtZHFBSjFYR2Vzdlcvazdlc21GbzNkdE5lckNrOFdKNkdOalo1YVZCWGpiNjMxbStQTkE3UzR3dW5YSTg3eXd4dEhoeVRrSTAyRzQ2bzBoMHgrVjdBNHhucTBuZkFDOXZEL0VHV0l4dWFYdVY0TS9rRGJDaitBQU5BTk4zZ2Y1bENCUG5HY3dCSFFzY1Q2by9TNTYrOStuZFE3eFBWMitxTlZBOFR4ZnZxZDN2MDF0VzhZUXlibDNjTlZMOE5IdFkxM3kxRTBpMWdrUFdUZ2dkdFJQVWUvOXpyVTVabDA1UWIvMWR0UlB1N2NJZVdIK2I3aVhkMzltaGc4ckZxT3VCdDZJRXA3T3V4NmZOdWg2TkE5VDEwS1A3NWIxV0IyVTl2cXhMbVcrcjRsTTNpczZRdmFHZkprNXFjeEsrVk1ic3F6blRYUjZkMEpvejU3ck1pNmZtVEMrM21qUFFSbzR1MUxGS3poenJna0pIN2UwMVp4QVl3MmFtNVZuU2FZakw5V1RjV3cvcDFxaEE5SEdqSGhKVHY5aDZTT050MnNqUk5Rb2l2VERLSWVtSzBjRjNvb3daRjNOdnRIODRsblJnUXFpZVBDc210YnBtTzJwMXZkcW8xWFZjY0sydWJRWHF1bXAwaldKZFpxa3VWVnVxNFNockI5T2tqbzdyWDNjbk1XZW5ERGlnWFVjdW9oL0FxdHhtTldoOFUyUWRPVlRCc1NUaTJpaWdUSlFxR2lYcW50blNOdXJJMllkWWU0a09jRU9lOU1sTUQ0dERzaHFIZ2Y0RVRORGVrcXZ2ckhFNDJiUEdvYnQ4WlRRL09qWFY0VCtOZ290OWY0MUQ0dWorYVpOZXFybzNMdjc2bXlPai91WnI4VU9Ydk96TjRlVEVHRExXMy9TVVZvMWFkUUdVaVZWK2svbjQzRjkvYzFlUGpBV216VjNSN05CMTNrdGNHL2JuVUhWbkVxSzdOeFZURzlaZjlqY0sxc1ZoVVJvMmlCS1ZVWVpwRWw5c1lkcjBWQ053R0dlS3VzVTNVNnR1Y1MrK25PUlZ0emhEU2Vyb0lhN3J3c1ZCRUMrQTBsdTN1R1FHcS96VEpnMXhOVjBudmxLNm10ck44VFhyTWp1b3pycTUxdFRPV2k2OUVUVy9xWkxhUHBpYk14dkNBZDVwazNhMGRHNWxjNi8zSHE2SU1hVEhXVlM5ZDN4VzEzMGVwczNFM1ZacjVsNlFmb0RsQVhvUm9HK1lyM3grZTVKWm1XYWI5Q0tBSDVJYmg4Q2FOcW5HcEJNd2pCUFdjN2crR1JYVisrN01FTm5TRG1UejB3WWpDNWoyK1dCTys2ZGoydHpWcFRvZ3hvbVpyZEFlTGdESklLSXY0MGEvUllZVlRJazIrZlZ3Z1ovVEdwOEJiUUtjcW5zdERJajJGd3JDRE9xM1NYOGh4WkdEWkFqUk0zU2pGeWduQzZhNWREdWExY25JT21wMnd6VGg2SjVvZHN0elBNamUrd3Jxazk1WEZlYlhrdU81YXJqTjVBV1JMNXdzbUpiTGxiMjBRWkY2akN4Z3VtcDJUKzNtNlo2MmpTSDFkVXlkMmZ1eVFYM1NsMDJTRkJ6Uk01eTMyVCtHOEQraFlmZDd3VlQwelM1bDFnWXpwam15M25OSzRNOFVyZXd3VGt5ZHNNNzhlZ1lxa25idmRidDl2UlkwN0ViTGJtNmlXYlZCanp2MERFU3pUc2NadXZGMXZRWlZucVUzVGt5ZDZKZEkrMW11cWtuczhpZnBad21TbXFQdTB2MmFDdnRiRFZXMzdKWW1TcnByZHBySmxFR1FHNStPZlRnRkUzN3VXb1A4eGhtNER0TmZ4T2c1ZTYwR0hxRFZJZW0xaWk3MmR1OTFkQW5Sb3YvR1lHcDFsYmUxWWVvTXF3bVV3UVVNT3BWS1U5Y3d0NXNta3VPU0d5ZWk4QkluL2s5WEgrRDZRK2hRZmlyN0FFTjk1bGdDSlVneWpxUko5NmtTTk93R1UzU1ZGMEF0YmNUd0x2dU9Qc0Q5SlpUaFRnNHZSOWQwQXlZMVRXdzJmY1pKbzYraGpwdkJIMmlQYWdXVUVSMWR6b3lBVnpTK2lZZGJlbFRMK3k3MGpUZEI2aWJkN1Y3UW40N2lWbEFmdHBlcWV6aVlXbDNsMlRlRU5tcDRPZEZWd05TWlJIZmZ2bis3aXlhenkxRjlaU2lqZXlyTFQ0V0c4QjhCazVvbTFxQnN4aGxpUjRabTQrNys2WUxFcWowY1hxMXF0ZTM5MDVWVkhwdGQ3RFhIV284QmFEYVF3WUR1NGRjUHJUYStvOVZWbm45VDlLSW4vZE8xbkJKbFZGSUZQcENZTVZ3d1lacVZwT245Rk9kWHRCc1E1bG5lMmR2L3hOUGJuNlBFUDNvT3U3NXFQVlFqYjRPLzZvM3F5QzYrTTRCeUEvMnNCbW5EMnFFTFZlWWNMTFY1NDJoRi9SeW1tY2c0NGV1UTVncDdYTzVVbW1kWjhZVEhZZzB4Vmc0NEpiK1F0VkZxbnd4dXdsVG5xVGt6VW1Wbkpoc3hnVUFicUtOMHNaVlJYZkVsUzB5OU1vdGkvR3VibjhNMEV4a25mTjJReVJMZVRubmFxd2tUc3F2UkN3WStxNXpkZE4vNGNaYVkza05QbXFqbHR3S290VXRRQ29tdkh5eGwzc3JQQVpZdmNQRS9KS0haaTYva21KM3dwaVYweEFhd0lzdU1JNjBKMlROYVcyNjltVkhRWVpVY1phdTZUMXl5djFKQWJRT0ZOc2ZxN2xSK09ZWXk4aVB3aEE3SkVrNk9FeXIxY3p6NzhCcW44blVuVG1PM3FKVXBWYmg5bnBIempCYWNYREJaQXVXcUUvN2FWKzduekVLcGdVS2JGK0l5bmYrQzQ3NDZtRllZU3JERWNhcUgzYjlobWdoWmxOTGV0RXdjQnpId1ZDYzdFWGZFV1Z2RUxKaks4b2M2Vlpzb3NUM3R6L1pHaWFBVU5WQ2hEVUlvL0lzTW0yaTlOY3EzWUltai9qNStUaVByN1oybmJKakF1WTQ3bGhFSFlvSXdtdlk2b01UUktUZTU3MjgxMEhPaERvUkhuN1FGbE5Zb3dkSnljZ3J6TlgybTYvZDFyRVMwODduSkUxNGpJN29JOHZJb3IwQ3FTV3FVam5OZklRWXFnZG9wZTJ6VWhZaEFxa0pwcyt6TlhERFQrRGtOUllXT3VBc3lqckM4S0R1RVZlcVVMcXowbUN4L09tSVNlYytnR082M3dpYlhWRCtKaURSUWd1VVN3MHhod3MvVDRNUkt0SnZuRyt3MnBDREdxeml1U1dJSmp6SDJCVWgxQ1FPRmNuSytoQ0NRaXZrSHNUdzNUTHlNeW5MbjM3N2J5Uk1wWEF3Yll5ZlhUdjQ3eE5ZMFNleUdDcFpxb0xWVHltRmpvUVViRDRWU3NyeUNjbTZZOFBPMEs5SEowZFdGWjQ2U1JGVklGMEZleE5iV0pGT3VPNDF1T0w2K1hIVGllTlI1dUxrY0RNWjNVV0tnbkNlR1d5RGxUTFZvcDdIbW41NUx1Kzh0RXliOFBOVktKRk9aVjY2UEVJNVVMRVlpVllKRGtCMFRxdFVUYkN3UmRVS3l5eW1YZFJaT01Qb3g3aWJiMUN1Z09OaGFhWkFTcERuL09OVzdhQitkWklWSnJ3SGRGR2JUdGlhS2VDNml2RHFDVXh2K0pPZEdUN2Z6VXpRTmgraUFVSzgrVFpLSE1JN0pjQ01ORWw2RHpaclR5MCtlWjROSkxpV0IweUhWVWErbUExMFFaVkMxZHFzemFDYTJ5VmdsdEcwRzIrMUJFa3g3d1UwQ292ZlRaUTBoVVFpY3hqZVZYeWd2endnVE9CRi83alYySzkydC9waTJoaXlXcVlLOFZ5eksyK292cXZCSlA4bE9IY21XUmo3dEIrYWkvQXYvcVMxS0VtVTJPa3Bpb3JORmExVWp3eTJkcGhaMHNNRndHS2IwOG13dzhmZ01UK2RZYkNyaG5QZnQ3dUlXaWZuSlVjN3J5aWJwTEhjczVKVVVMRzBxcmJVWEo4czlHai9NNjFlTXFaYmFWVDFlU0p2MEdDYkN1cGxnMGhhRjhQWWlwQnRyb3lRcjhBdGJQcTdqVTJhUCszcHlEN2k5YUhTYjRhUnhnYkMrMXpDMWwrUCtPNTNneWJHNUZyVUw0ZG50MUkzczlNM2Q0WHRMc0V0VVJQV0p2eDREYUg1eUVXakR4QVBuUGFTOGtaTFNDM05uYWFDVU5rbE9MdWRhY0lJQlVRRVVCcG92UzJXWThISUNNL3RhSkhqMnd6eFJzcTBRVUhLU2VIaDJ2ZzVVbkNuUngydU9GWGVkeG5WdmZaUUhVRXlZT3FGbUx5K25hOUY3TXdPaEZlYUVzaS9NRWlobGdFSjNPOGU3MTRvVThYdVJ6eWs3c3VQeXh6RFFJQ2VlRGNrU2hna3YzeGVuOFBaOGVYYW44SERjZCtsUUtaSUppU0M5a3hGVlFHMEQ3VVQ3c3d6V0xHR1llOEdFOG5MeXRIZ085K0k1NlZpVEpWQnFra20wNGtRbFVHS2c4MjV1TEtsaDV1VHROczkyUmdPZC9KajNqdXpKRWlpRlRhWVlad0VVQnBySEROcUlOMW5tYUpqdzlnMmVXWUJPTG1ORzByUkthWlpBbWNGeFhBWmFqNlAwS0I4WVNzVEJPY3RjRFJOSzJ6dzEwT0cwbVV6UGNERFNKRFZLZURoRm1kbEExZnRZQ1hRZXBVU0pQQyt3aEdiRjhVU0N4bkE0WDR6ZGFrZXp5Mm5BUUlJa1IybE5sdnNxWENJR0NxQkJaeEFsSURtSWdiSlFscFFuVk5aRWp4alRZTFFZWEkvdm14TjJjcHRWQjVjM2k4NG9yaXVPSnhaSkd5VXBVYk8vZ1FLb2VPSFo2bHhIVHBEakcwRVNLSXRsU1hrQ0tNTEJWaUlhb3J3SWZJSWtVQklQejh0QUFSUklwNHZCT094RzdJais3YTRSVFpxendXTFVDdUExMlBjV3pCSTh0UWxBWnlaMmRCZ3hYak8yQnBMNW82UUdDdVdlRzBpSmlLZ1ZuWDhFeXd3dWsza1J0VktyRWNtMkJDbGRBaVJJNW9xU0dxZ0dDdDAyQmh0RERxOHhVUjZDSlhocWxUZFN1SGhBVjR2OGcvV0lBaVNCc2hqdEFCVERUVWNiWG1PR0NEaktRN0NrS211aUw5UU5vQ21LSWg3NG1DUUwxYlZrQWpXUmF0R1hRNXdqQW9CQTZSL3BRb0JLb3NoREUxeTUwTWRuUlpPa1FLVnlRRXBHbTNqTndWSFNvN0lPa1hHb1RMNUllUzhGc1RXUVBKQW81WUFVZzMyTTFFTUJVcEY4RkpTVXFGUWJpV2hHa0pjODJqMms2Q2V3YXJneDJDcmpBNk10U1phZVBRR3BDS1lDcWhRRWVSK0pJdzNmY2FRWWJReTRCUGxVU0ZwTUt5VkxLa3llUFFXcGNDdkZhRU9ld0dqL3FmS2JQVHFtQVFBQWdSZ29nZ0gvVGlFaGVQamhidXJlL3R1MXJrSnVBd0FBQUFBQUFNQ3dkd2FyaVFSQkdMNkVpTEtRUU5qVlZ4Qzh6bGtHRlpmUUYxa1BRV1FQaVplTkJ6MHNuZ1NSMVpmSTYvaGlXMlBiODAxUE1laE14dFVGdjQ0UWtrdnlVZlo0cVBycnhvMnpVYmZJTjNKdXZSS2Y2b2RUUEFseDM5SC9KcmdlblhUNzFEL29xM21rVjlQQ0ZoQUhndDNmY28xbTBTZmFtTlVHZURoUDc5ekJKRDJ2d3RjRHFYNU5CUHRtTDFPekZLQVQ2T3R6KzJGcUNyYWJZTFNzSVF4NjNIM0lFa3M2anQybXphTDJmRzZwUUMwUWYyUUhFbktSNGd1Yk9Nb3lXdGNOK1JiMmdGaFNmbU8zdFlSYS8wWW8rM0xDWDdaQS9Pa0ZNWEVnbWh3dlFoYWpuM1dwaGtXRS9Td0QzTVU0dzRKWHVaaFZWWXZhdkMyMGRlU3BDekJib0dmUDFjWWQ2QkVEak9LeitCeTFVK215dmdVN1pnUDNNVW0vcU1Wc3JGYlFhckZyRFlNSWN6eEVCM2ZxQWxRQ00vMnhJTVltZ044cjl2OExSdkZackRCcmNRNTlQS1Rxa1p4amtwUFNpMW5VZXZlQmR5RmdsNGNab0cwUElUUk9ILzR5Qk9MUHlYTEZZVS9tYUpZemlzK0NoWmthVWJiaGNGQUY1ZGk2VldaUmkxdksxc0hERE5DR09vRW96V01DOFJmTDgvTCtmQmkyZFVieFdUQjhRbHlpTWhyNjdBVXppY0tVU2VuaHJOTU1CcVBlcUFJSnc5bG15ZW5VbHkzQU4xQy9JM2tjZjBwZ2xqKzJ3MVFBR0drOUJMRVZqVklnQm9uZE10V0toTG13bGdVMnE3bnBocTFYbVVmdnY4dW1sY0hJQ1VhdGJ6YmJMWHJaR3lZdmQxZ3JoanZ0VHd2TTl0ZVU0RUNia3lxRDlhMHdsSEhyZHRzWTAzMXJMVjkvOW9kdWJsM0ZmQlNMNkdMdjBUcmNuWXA1RnJuYjlYaldIQXdTWll0WjNLSVd2SzFoOGtLWmZNRTk4QWFXb3dRcWYrLzlYeStUYWZoOFFwU2NtWHgweEtpS29Na3oxR3FYQmhISzN5dStMR0RlRGxzTktkc2ZuVURNV3JoMGxWb3FGekFHUER5b3Y2d0tEQUpaVUxUZXlxVC9HeHQyY21DMk02S204Z2ZLUFJGdFdHb1czMHFLZGpyWnEyMEdnVktMV3d5RDFvWTg5Q1VFanFVQ0c4dXd1OWlWZ0JuaWt4aTBYREp0WWVLeVhCYmRjTmw0MmZiSFE5U2lWNmlLWTdEU1VDZFVZQkJFNzJDNUFDZFRLckJVekV4ODVnamlSR2FjWVVvbzE1bVp0Nk43ZnlLUHNyVTh5NFpTdXhqMkdBaEJwRzc4MGQ4L1BNUmVsd3Z3bkpoTy9wRFlSMDhtTGkvQVpyTlpyZWJ6aFRIeW9GMHM1aXY1d2U1U0VNY3BxUldFdmgvL2FIUWxNcThSUSt3dWkwZE9XMGIrUGR6ZFNHSCtWS3BxV2NaeG1kWEs3Kzd1eGwvMnpzSTNxaUFJNHdTSFFGSWd1QnhXaXBRQ3BSVG9YYUVVS0VFcVNKRWlwVmlSS3dSM0RlN3Vyc0hkM2Y4dFptWjMzOXk5MlhlUHU1SWc0U3VRZC9BZzRjYzNNN3V6RzBab0JVYTdHY3pHT0gxbTRlQjRqUDhpeVFtTU5FeU1VNmYvbkthU2paLy9Ld1pPVHAwKzh3SXBadzYwVHlHZU9HenNvaTZERjQyRkJjcFNYS0UwVzVCS1c3Ui9RZEJ5V0RFUTlYbkZSaCtjZGZ4VFp5TXgzMDRPYmFIRnRXeTlORysrcktRUDdvQnhBemZrNzhnUnNPbGRCenN6Mmo2VUROVlRGUGd2VkRKNG9uYVVWSmRhZXA2ODkwekxKUHVjVlI3b1RDTjdoT29ZTVdLYzN0dG44SlJoc0RPWk9lcnpINlJSTTFOaHdNN3BjVjFHRHlWNDNFY1Uwdk9NbHc2eS9rTXNFL05XUlp6TEdjQ3NRVjE0V2cvSmV3dk5iQjNiZGhrM2JONXZNdTJvRWRoMUFZQWx5d3pBQ0h4ZVRRR2U3V0lmQ2o4UUJ5Y0tjOXJIZ2c2Vnh1UkpVcVloUmwvdS9vNmJMZHUyRm8rY0hvdjlpTlFSdjlxMUhNSGt3UGtBY0xvQnlQd2tQZG12cXNIRFRjeG9NWWt6OXB4cTY4aGFobW1tbklsbUxja2dWbndac0NZcjBiSnI1eStkTm12ZHpJRWJFNmMzQ3Zzbm1BQVhLWDYrQUJtZG1neWo1V3FrNmtseUhqd0hXODNKZ2Q1UXhibWM2ejlrS01Ea0NYd3VxVU5vMWxIUVh2eU9Pcm4zSktpR1AxcWFEejY5cEE4MXc1ZHVtd2lyaFJrekZxeExoWWI0ekJGRGhnd1pNWFBRb05UVUJUT2F6Wm80Y2RxMGJVdWhkZ3lHN0Fmd2dKNElZQW53b2RGMVIvZVV6cUQ0T0FWVm04ZU1lWTYzSEdJM0p3ZDZrNnJXRXBUS282bHBPaVNmY1lINHlBYS9YN2x5NWRpVlk2UkxSdnRBQ0JhNW9oa01Wb2xXOWltbFpNZVo4VWtEUmhKOG9YWHp4VTJsSFZvTFdlWnYwOFRNTytUUnE4dmNBVHVPeldrTmRNeWFNczVuT29PVUNTVWR6L0lZRU5jWjdHR2xWWTRlYTJtdVpGem1TaEtWek9jYzBiT2g3R3JXWDJlSUNPL0p6U2RhcjVSMk90cVAyc1NxeTlOaEk4WUNOL013SjIrSXhGcXpXaDEzQ1NveFRTanozN0tqNU8wQS9QSDE2K1BuenAyN2NlUHFxcmVnKzQ1VzNYZklvbXNaSzUvdnVDYmorVW1XRHF5Skp2MVJCSlAvTk1GRGJyMTc5eTQ5ZmRjMTBGcWp1UkV5bzBNYlI4MmxkdzJXRzZ2TTJjUVM2cnpXSE9ZdVFIWE1BUHE2TkkrNnFYTWxsbTg4Z3RZOE9INGNTRjY5Q2h4Zm91Nnk4Q05DMWJvTXdueWdFeTRYTWk1bCtHV1grVVY1ZGFlMmxncGY0MENDMTdGanh4NnNqcWpjN3QySktPQWNud09hclpTUkFYK2YyYzVZV3g2bkRtU2EyOHdKelE4OUtsVFdJQXgwV2MxVmxNT21WS0dVV2tNc2tlU2VOMjhlUFhyMEhuUW5RdkFSb0Jxa04yN2NPQXlxZC9rS2lNL0VXWkcxMWZuUzN3dzZWdFN0TWtoKzllcGg5TzdhbGY0T1FSTEh6RmFvdmloNnlzek03REdjaVBaTFQrK1ZuRHcrTDg5NitaZEgvZE5hcDVrWXBhN3JrQ3R6Sm1HZ2t6VkxvbjlIYzFyMFk1VHpPWjFrZWVMNHhiTlgzKzdaQXlSVGdsbUJRTnUyYlF0YlJLaXdzSkNZS3ArK2ZYdjE2am5RNjlmQWxLOExPY21mMWNBbGVYY0J2eUt1TjBINjI3OGY0aGRSZHM4RmtwbVpTREcvRFdvQWlwN3lrU29TSmFETVU2aVJPcjdWNjNBWHpxVzE5UFJ2WGlSeFJXOUFOV2lkakhPcVhKNlRONXF1T1hIeDR0a0RDaVdRSkpBdFFWMGpCQitSS1NGOTlPak5uajF2cjU2N2VCejEralZQdFNLWnhRSitDZEZQOC9VYTl3MG1TSGxyUWNBU1VBNUhTd0pJb05pdVhidE9MUGlFVlBPQktBRTFQRFBzVnd2Z2FBZmpWc2I2RUlKRDVrd1NhWk1DZlhyMGZ0TEVlVDNQeHVpYUUrYzNBTXZzRG9RU1NTTEgxcUNlUGN2THkzZnZoaDk2NGtkZ1NrUURnZmNwQ1BUQTJRMFh6NThBUFFDNTcydlZqUzNMWFhHc2pvdEJjNEZsUDJCSktKRWtjdXpjdWFLaWQrL2VaV1ZsOEdORlJlZk95QlNKRWxETnN6akhhczhrc0NmVkZCbnJmUkNucVVPU3Budmwzc1hFdVhsZkd2UDh4UTBIc3JNN3BBQkxRdGtWVVBZc1g3THk5cVR3eHk5YUg4T1RicS9jRFZDSmFHSGJRQ0FycFVPMjRybW1LWWtxR1M4Vy9CUjVLNUV2L1dmTVhwdzhrbGdPenlTVVJMSjMyZmFEenorVXJqNTE2dXZYcjZkT3JTNzk4SHo5OXJMZVJKU0FaaXAvam1SN2lsTmMybk1MYzI0ZDZ0UWhVWVR3OVZwTG83T21FK2Yybk5rVWpGblUzbUhaVXBHOGZlR0xWWk9JS1BCRW9FSGdtWDJnYU1QNUUwMjlycmxLeGI0ek96dW5PTGxYZWovRHNwMGkrWFRDVjVzbVBGVkUyeG1leXA0Wk1WcVYwcHhUc0E2WnhDbUxrRjVUY2Ria09MZEdPUnF6V3dmTmtsQk9ZbnBXb3J1Qkp3QnRHOGdDbnQyeTIyOUlDMDJ0OGl1VU1YczhHZE93UkpSSG1LU1Y2QkVFYW5pU1BUbmE3YjNLUHE0bEo5TzBGYUdva1ZGREtXdHluRnVpSEkwWmRGaEtsRklYVm9KQk1kNkpaM2I3L21taGdsOEIweGl6aDJHNVhhQzBBZDF1ZVBZZ2UzSzBpMWduY3piM291bGJoQWFCTmZYTFNmWW9Qd0F3MFppQ3BZOUJ3WitLcDhJNXAyQnE1V0d5TVpVdm1hVVBUL0tudHFkWHREZENjOHA5OTdpWU5LTzNsUk54UFVWWnM1RUZwb2x5TXFaZzZlUFBaNFluNGl5YVRORmVlWmhrVEtnOWdxVS9UNmhIWUU4ZDdSbVNwcE1LbTlscFJwWDBocnFrRDQ1OGR4Z0dPbWROQ1JPalhCdFRzUFN6NXhMaWlUaTdVYlJQclR4TU5xWmc2Y2VUN0VuUmJzZkpoV1ZhVEcveXZySW0wSnppYW9oUy9XZnlBaVpFT1JwemlhemkvandwZlZKeFo1eVZnNGtaRTR5NXZ2UnJ2Q3BkRC9ac2s0L1JybkJLbWswc2tiNklDUW1hM1BMZ2ZTaXZwaVJNSGVYeEc1UFRKeFYzeHBrd3pGNElNekZqc2owcDJoRm5MOGJwUzVNalhTNDM1MFcrTzFyUUZEQTV5aFBGU2NtVGNCWlV4cG5kQ1dhc2pQbU41WkU5VmJSRExXSjNTcHFEdlBNbTN6SzBaUVd4MGpkYWM1NVdSaXJLeStPTWNsbmNGYzdKY3dvcUUrWTlGTXdKM2hpL0czbndMSVhGRWlWUER2YUVhSEtPblJqNTdqSkRzNUViNW1TR2ljWk1YQmNvZVJMT0lvNzFCSE9taEtrb1NublpVK0drM0ZtY1Z5bWFzdjQzVnpUcnVtZzJEYVVWL1JUTThJVkp0MjdkbWpUcFF0ZzNlV2FsZEVzd2RlWVZlOEIwZy94a0pHaGFjY0l5UGg2YVRhUGZyVXJ2THZDbk9UV1Uxcjk5dDVTc21EQzMzTHE5Qk5aQVNsRHpsNndNeDhKWkdBaDJTQXhuM3Zoa0FWT285TVBUZzBkNlZ5ajFYbzg5a0sreGNlYjJpNjVFU1U1bDJlYTdGN0pYckkycTMxU1Y5NVVNczBNd1VPZ0pjOHR0QkVrTkl4SThFTkd3Rjg2dUxiZ1N4Vi9PKytYR2hGbjZIRUIyaGlZY2lMcWM4QXhJbjYrT2dUTVRLcEhDS1ZjOWNkQ2NHWG52RTJqS1U2UUNnSm5kQVJmdFhlMHd0Nnlrdm9icUQ2T281VW50SlErSGxyZU91eEp4bkdNNXoyU1ljaUVKS0xFL2pNMDMwZ0Q4MEFtQnJ2YkVpYnNpU0oyekswbHpvS3UxckdnbVJjQ2N3eFZvdDQwbDdoa0pKSnhtQkxUZ0VZbWlROE8yM3hOL0plSTRwM0xPTUFWTFJJbU5kdXkway9ybTV5TlNYSmtlWEczRjJXbEFQdURFMURsYjBqenRTNU5iU0N0Y1RROUJreXVRalV4NHBXS0pJTE95Z3NGZ1NrcEtFSlNWRlZCQXdaL2gySldvSUtFNDcyU0RXWG9RV0FKS0FFbm5ha3J3aEVnQnFBZlA3WmJVeWJ2RitiSy9LV2xDaHdTYm9aRzNnVklsVGJLbWR3WGFRc3RIM041Z3N3M1VqUVFQd0pTQWdqK1pwNnhFRk9zSnhYbVpCYVptU2NkcGVPYWJtOXNkdnNQVGNEeDhVenpMSk03U01wTTZPZGI5YWZvMTVHYlVNdDNOSkxjMUM3MWdFa3RBU1NDejIydGxBMUVFQ3BZbW5tSHZTbFRFNXF4Y25KODZRbHZGZkgyUUJrZVRZNVQ2d1RNZXdSRlAzTldmOGtxZEhPdXlrOEUwYS80Y3pWbE1VMWpUVW9IQ1N3Q21ab2tnaTRyNk95b0NvZ0FVL2RuQ25pTjI2MWlQeDV4NU9zNEhRSnhMZzFXQU1ZbGxMb0JNN3dVYWljS0hkRUNhU3p6Qm5oWGJWOXRTcDQ3MUtKcjEzVFRuTTAyLzl1WTBRWE1xV1pNV1IrVzJLRWVZaW1WUi84bHBhV2x6dE5MU0ppTlFhSVlTVDVVOXBhOExoVG45ckduaWZMMkFxWTFKTE5ON2pVeE9UaTR1SG84cUxvYm5rYjNTaWFleXA0ejI5U2JXalRtWjVsalpzNVEwMWF1akkxK2RSelNwODg2ckk3YW1QY3FEaG1Vb0ZDcVlxbFVRQ2lGUTlLZHBpSmFIWmF5ek9lT3dKc1Y1cVlTcGpObFJzU3lHcXpGNUdVcDVPVG5qaXhYUGptaFBqVlBHZXBRNUhacmpmR25hejM4MzEzSmU1VGpYMXR3dFlWS1VBMHhnbVpZV2NwMU5MRWVnNEUvZ0dmU0k5bkxIbktINHJFbHhMbUVxWTQ0aGxxNnpIaUNLUE1lZ1BiMXdkbUp6UnZYVEYvblJsSzEzZTFJb1VDV0lyQ2xnbWlodlR5eVhWMkZ4bWtDZWdGTkZlL25IeXBreng3Rm1tUjJtTWlhekZEekpuaDQ0eXh4ejV0Z1JzZUdxUjlOc0tteHNYWm91RHptcm95V3VBcVJoMHFHRVpNbit4SERYMGQ0Vi94QnB6aUJuemdTdHlUREptSWFsNURrZTdTbHhTbk42aCs4OFFWTXNwdVJCaGdsMFFLRldSeGNzQlRsQVVjN251WGFlbEQzMXhqVHNaYzdROHAvTW1qMHMxbHhkeGpENUFOTGp6Smh4YmovbFpjNmZvcGtVNzBGR2dTcm9samhIRExvTDVMTTFMS0RzaVRoVjZwVG14QTJSQ0hVYkNpOXJIcWxnbU1LWXdwNEdaNmVLOVY3bXpNbGdtcTdyQ1QvWXU1WVZKNklnR3RTTmo0WGdJdUlMUkhDaCtNTHhBVDVRMFlpUEFSMVFVWW5pMjBVaTZxWkpRQkhSTEdZaEFSZVNqYm9jeHZXTVcvMHp1MjduOXVuT3VaZnFtODZNbVdoL1FFT2YxRGxWdDZyT3pVZUw1dnFONmlCakxkRE1FbjNQTTRkbzlzRmtsck42M2tWRHIwSEJtVkQ5WkFHaXg4Y2dvNXFkUVo3dnpvQ3B2Z1Z3RG5LOVk0SXpQaEFKMVQxbzNnT2FnWU1NRUgyUmVGNm8zUXUybXhnWE9LT0I0Q1NxcTBSSGFFSTBkeENZT3B5aUdEMEt6bTBIRXFvRHpiWFhQU1Y1d0NDRGlNNDhMOUlBUXRYcWxzN0k1Q0ZRWFNkNkhGTDVpT3JHb25uczZDV0FXUWpPUzBkajZXd3U5SnYyVmpsM24wNnBqZ1BPSGRyZklEVDFRWWFmNkxQZ3VTNTN5WnY2Y0c0WkRQTnZLZFZWTkZPaWYyYWVtNGdDbURxY3g4SDFESnFmVTZwbjBieFFITTJIZmpUcktkRWpDazNMYy9CVDBjNUVPaEdjb1ByV1lsU3YzVGcwNHlMNkc3UjZhMEdOS01QMUx0QUUxV2NPM1hoQ2FISXJnOFpDcS9Oam9XU25Td1labHA5OW9sT3BTVHhYSGl1ZFZMbEdhVmF2NjdMSlJKZlFUSGsrRmRBa0ZhNmI0RXpSQk5VVDRkeWtOWWFVSWRzSG9KbktKaE05Q3V2ejhvRy80Y2pxOGN2cUJXUlRBT2c0UWhOOTNtSndDdGNSbkVDekErRU1RWk10QkJiTk5RbWFrTTJ0ZTJienFva1VCSElXa1U0Ym5CRm45VjJuOE5Ob3NybmdDazNtdWM1MUJHYzZIdTVDT0FQUVZFZVdmdGxzaUdvaUJRVUg1eURWWDR0dzd0cXJWWnhUYnRuODJRd01UVVI2RXB6Tm40SW1DMmQ1TkYvbURBZDF0MnpPRzlWRUNnb0xUcWI2RHhGT1NrT3FiQ0lMVHlNMFE0TnoyN1EwU2dWTkZzNmgwRHpyUTFPQ3lTV2JzellKY3dyU2c5TkI5ZHZtMTFIVDBCbUxab2ZRaklVdUxEUWh3NEltQzZlZ1dhczhLWUVtajlPUmhMZzhvck5nc1NySlJmVUcwcENDWnYvclNUWVB4RjlQb2FrSHA0MzFWajZwMlYrbjh1UzVncWF5bkhBVmFDYmpOWHc4RXoxOFhaQ29UbWxJaXlWSlFySE80VmxJTXZxTVpBMTZGQjIrSWpvc3dqbnd3dWx0U1ZJZkJzM0xQalNyYVNoRlRwa0RNY09wZmpzdkhRaDJQYVUzZjFFb3hiSVpSblM4VUlLOW0zM2hyMmFhMUY4TmdlYjU3RDBnR0tkYk5DV2wvOGgrKytKMkk1dlg3Z1lTUFZja3pEdmVxS0tacFBUbWZiZHNWa0lmQ0dldThkRk1rbm9ZbXZyaVROWDk3YStIazAyYysxRnk0VFNBczZWZUlHWFJiR215R1M3RUZzMGJwZEc4VEdqS2ZJMTRXUXBOMW80SUpWS1JVM3FMdjkyVWg1V1JwS0dXTFRnRnpVOGpaUHJUZnJtNVBUdkUrRzFxZCtTTW9FZFJZaDFOMlVyb0VacWhTUWpSenRyUmsvNjdRYk9tb2hteWNBZzAzek9hUXprQVVDVXN1dEdzQnhidk9wckJTdHlEZGhDYVpVNlcxZjBXelFaVmh5TkZjeDVkcEZBMGI1bHo1Yjd5YU9JeDUzNmd5ZjFOdFNQSC9jMS9QRGJQV1RTVnVSQjFpeCs3MGZ5dm0wQlRtd0RyYzZFVmt0TVBMMlZPbjl1Z2JNN3d6UEtqZTJhNU11ck4zcExXbTNQS3hxRjJEd1dNZ2YvUFFvS200aUlJMlBXb3FpbzNCdWYwN2xLZTArZG9nWU04d0xRNDY5NURHdDhlMGtLdTlUNTBENm1tOVpDQTVqM1ZKVjFnUjY3dDcyK2VXUG45VFRQSzhQYzNCYzEzcmtSOUJHZ0c3VysyZmIzM0xaUFFlemRFeDYvRHZYZWcrVkJIVTk4dHJycm5RdEdreklVTTBRZlJmSkJGRThkRjU1QWNENjBzOGJHcDZwNVpmaHYxekhMNzM1aFozaHdnT3M4c0JVMWxkT1ozdUxEN3F2ckZ6dE5mVDlvODNTNTdnT2c4VDU5NmJ0RTg3eDMyc0RQd3FxOGxWMm1QNGE3SHNaSzdIcnlJeExKcHgwTHZYdER0VXVSRXBhR2xkNjJyL1hTQzk1Q3dKT2VXelFxaHlleFZWZzd6QzV6VnI4dXdJemRiZGtldUc3d2poNzBaaENidnlNa2dneHR5bTZraFJ6Y0RPUE8vQ09kazcyL3VJRjlHQjdJcGFGSU5TUTA1Tm1YNHovVHR0NU85VzJ4NWpoOEdzam4xaWdIaUZoSVhuUDdPY3Z2clN0aDdiejBZY3U4ZENSM0hTcnYzenVUbFMxTFVFdWtSQ2dCRDliZEZQQm1WNWZaa1BCaXhKd001YU9lMHRWOXRmUFdPRWdzZjA3bEVPczlKM2ZvSTJ0OFZ2eEFzTGlYOVF2dkh4QzhVdjBVRW1LYTZyc1NpSi9VN2dpYUU4K3RiMWNzbTV0LzY4bm5aWE1IWjYyUzliTUNUc1N6Z1pkc1hkNHJObnZhNlZjNXlrdytXM0M5R0Z3bkNDYXE3Zkphd0JoYjFXVzVkSHA4bHZJSHNDOVI4bGpZSHNlVWNsMHVnM0ZTN1NKc2huSmJxSGc4d2JLdmo1Z0dHYjVVOXEzNFA4UDJjUVowYndPd0wxTk9RQ0NlRVFhak8vblMyVkY5TDhCd1BmM3JpcWU0RENvN2ZOSDVxdnorOW03czhZUlB1TWxYdVNDRTB5V3BwYjRjVk9QbnVCTGI3bnhJOHRic1REbzd5N2dRZm5FZXQzOTllbmxDelZ5ZFlyei9kbmVDODJBTzNGcC8xcDNUOW54MHVabTh1RnVWMDN1c0JPTDMzZXV6L1MvZDZtTHNvWnRLTFBmNHdkOTR0VGtSUkZNZHV4TjZTQVVVRkVhSVJiRkZCc0JEamlnMWo3SXFSMkh2RnN2YmVDL2JlUlZFUVVjUS9GRkVDZmk3dmZXWE9KRGVUbHlaNmJCdEJXWDg1NTcyWnQrTTlpL3l4SGdzbzVIcnNUTGtwUGpjeGRBWkJ4eWJrb29uV2tSMmx0L1ZCTTdkV21qbXpZZUJ3T1hObWhaNDVNOTgxYzJaM3MyZk9uTjAyek14SkdZcWhNNk14Y21hb21wRVNQbk1HQTVFUWRONVYzRnU2eG8vYmVtaHZ5Y1IzREoyUk9IL3RyakFQYWNTL21JZWtaL2dFQmlKTkRJeEQwdk43d3VjaDRXQVBRWStKVFFoYnVteHJ3bEU5ZG5VYmRUR3I2Mm1GV1YyVFNtWjFFY3UvT3FzTFkyZWduSmt2TlFIRHVnS2p1aWFZMlZMS21ISS8xOWJrbk11ZzQ4dS9GWnJFd3BveXNBOFZ6NUhiRURKSGpuaGlqaHhKelpFamxuOXhqaHorMDcrY2ZXYUFrc3dZT1l0U3pqMlRjK1NLMEhSZkxaWk5PWEljVVpjSEgvekFoekNueGJtNzBvekR3Y1V6RG9sbDZJekRyUTNQT0p5THBWUE01VE5BMVpCRC9rNGZhWlJWelRpVVFYY3ZtM0plRjZJT2N6WXdmNU1VUG4vellvUHpON0YwbHVOSmVmY0hjRTcyeDI5U3hwbWxIc2I3TzN6K1puaEh4aDZ4YklwckpObkE2TUdjcnRtdzRFbjdFVWJEbXZhbVVaVm53MDZxZXphc0dHY3FobkQ2dzJFeEd0Wk0yR2VhR0xHTjJiQm1Tam1zS1V2V1VtTFpMSHVObEF3MVp3MXppOS92TDVsYi9HNXIwK2NXdTBmdFl0cnU5WnM4dUhqc3RyRUU4dnJYSENaRkU4eUtjNHQ3b3Y4dlZzV3lLVnNEcHdsem9yR0pjVHBtYWdQcHNtWHZTSTNNMUc1OEREUjBNSmU3bjh2cHBSSTB5OExFb2huWWc3eUNhOWwwTjFyQ25Qem56RTcwSDgxN0Z5UEtxeE5vVnByM2poWXhXQk5CRjh1bXEyMFY1alJaeDA3VS9DNkMxbEJpNkExemRSR2N6ZFVOVTNZUm9QVUtleENDam1XemJOVFJCQ3pOV1pKMTRHeGFUMFlwektocGNlMFJrSzYwaTRiMFpOUlhPZ0pqaXA0TVdJeHZ1V1YvT3BiTlNpM1ZjV0ZPazNXQnM1a2RMdEVnU0lLb0M0WlpKWDJMaEZVemxSMHVrMnRKKzIvNkZ0cmhVdG9XV0xLYnhHVUpjRzN0dFZnNmdiT1JmcUdMb2wvSWNHU1FoQkRsMXlWZG9Fd1dUSXZLbXVaeTJtKzZlY3ErTzlrdmhKekxEWDJLTEtnTzM0ZFNCWmwxTEozQVdYLzMxVlBaZlJXTlVxd1Z4OTZtY0p2VVZxZy9rd1hUUHV2R0JZckVhazg3eHNLait3b3dkYzVsby9KbVVaNWVxYll4SWJPT3BSTTQ2KzFsT3lsNzJWcGJxWEZWR1pLOXFDbXFtdjFnZnpKLzYyV1pkbFZNKys3YVJjM1NwdVN1emw0MlltbFNQbExDUkFPdzNJTVFWcWxvQlhOaTZReTRjOFg4Wm5VRzNuMUNqY0M5dTRDamJhcTJKZURCZm04RjF2ZnA4YmNiTis2YXFtZTkxdHNaU0N4RloyQWZDeE01UjlCbituc1FsbSszT2VYU3lUaWpHdWU4OVdUUG12c3NUOG8reXlmUDdqeitkb05JZ2lNakpIV1FvdC9WVUEzVHJsMnZIbi9MSmVpTGtYYk44MHZPbmZFdmZ2OGlwUnp0dGR6K2EyQ0tuSXM5eUczT2VDRms2ZXdmcVA2ZXgybHZxR3VWWVI0OSt2Z3hOWCsvVkNRdHgwREZmenRmNWplQ1RCWFEva1NVV3VWTHVsWlZRYWk3R3RUdkJnMTJyYTdidGJGM1B4OW1lV3ZLY21xM09YRUt6emo5V25xa3ZmWWVZRGFtL2ZyUjBhTkhINzE1UTEzL2JUVkp5NUVaUm95Nkc1bVhGcXRpeWtDSktIWFFuK2VhL3FJZTRDRzZVVG1rQi9qNldXVkw5TllpNWVzSUpqMHFBNWhsclltTFRiYzUwNFZpSmRKcUp5SXo2TFQzREtaOWhPV3BnS3FPNm5mQnUzUHVxTjVkMUZGdFdUNTY5ZWJBaXhlM3IzUTJKQUd5ZXllVzU2VXo4WVdiVjJaVDhlVHk5RjdQNDkvc0RxWUVWRnYwM1BidFZPaC82SkRmVVQxZ0xqcXFqM3o1dVNTWG81THErM1NudnVUbmw1dm9xSjQ3d0hZcTI1U1BJNVp2L1VaL3dKVFdSTkJyTm1kQzdVUmtCbFAwYis4eTJaNktwK2hQNS9yMDNkeWZUaHh0ZjdwWkw5VldUaWhmSFRoQUtLL2N1bXhJK2h5OXpNcFZXNlpOMlZrbzFiRTFhMCtrMHA1aHlrU05SUjh5VURJbzk2ZWJJb3lpL3ZSdFk3VzJGZmVuMno1NllxbFR6aXl2ZHQxT3h1d1dCaFBXeEI3a01LZkV5WCtMVFR2YnM0KzFwODl6VXFEYmY3am85aWVTYkV1VjhVdlhGTW9EbjU4VHluc2R0U2NWU0c5MTZrUnNlc0doNmJGTkM5TWVFMVVlTlVDTlFabm55S0c2a0g2QzZQYW5GNXFrcmFKSEZ6MjNodTg2OUxicjl1M2FtQnFtekxtd3BzT2N5RG8wN1ZUM2lFazcyOVBuMmRwcWVHcWdUSlNSS2pGRTVrZ2dtU1NocEZyL1M5ZUlaVEZLN1VrdnZpbFJxRUd4SFdSU3RxZ0JTankxUVMrTStXRU15a1M1b0lrMW1TQ3k1czVWSkkwdEZ4QkxEcmxoeWNZODkxQWJNOUo5WnI1UUx1ZXdabFhtRkZsbnJkbUx0SmZ3ZkhLVWF1a1ZVRXVVbVZvTllwQk04dE4zWXZtS0ZrdEdTU3p2M1dNREtGTjY2YzM1UXUxS25NaVFSUzFRR1BRMUc1U0FNbEZHeXBwQUVFbkVVWkUwdHB6TkxHY0VXRzZua0J0akxwOVZLTkVjazNOWTAyMU9aTDNNZGFlMnArWko2MmRVRjlNL2VVWkFyL2xFdVovSjF5UmVLUlhKYTY5ZXZYbkR0bFFvTzlwOGU2bFlvWDdGRnA1U1FJVkJ4eXpRUkprcGF6ei94QnlaSkx1U2JNa1puNkgySHMyU2phbFlScER5TWpudjM2VXZXOU5wVG1TOVBNNklzU2Q0OW9sR2lhY0dhb2t5VTRoQk1zbkhoSkwybmVkWHJsd0d5bE10aVVLak9yeURIV29OK3NFM3FDSktTQWtxYVNqOUlJd0VVcEZVdHFUbmt3Z2xzVlNiVHlEa25USTROb0kxVGM3MWVZZFRPRGhobkdza1RrL1pFenk3RU5DUEgxdGI2VVNYZ1JKUjBqWFdKVi8wNHRXang0U1NyNGJNWW1sZHVYQkxvVG1LcGNzWjlORHJDL1N3RERFbFRadzQ4UWVKT1NxU2l4WlBYYmZPb2p3T2xpcmtIb3pwenJrNzY5aUpwRDJEUEFtb0lrb2lxSnJvTTJMNkNGSWs5WVdsajdLZDJuVWFDYmcwNkVKcFVIMVJUOWVoc3k5b3ZhYlhKTHEzNTlNU29PU04zTEJFeUNWTURxYkl1VHZyMklrRXp0WGdhZS9zbUdqdjNuU1VTMVR2QlBTWVJDUnZNRW1nMUxaYzdrRFpzRUdKcHdINm12a1o3U0t0VTZJUDZMVkIyVGJJTXJNbERLYk11VHZySVRzUjRnNmVmR2RuanNqMGNlNDMxbzBiOUYzcEJjbVFES0k4OVdDYW0wM2pLNmdGZXY3cTFhdHYzL284MVM4TTh2anhmb1N5TGFNRXk3MnhnZ09teUxrYnA5eUpKRSsyZ0NGcTlKS3d2clM2L2ZJMmdiUWtmWlJlZGt2aEx5cTJGd1psb0oyWjZIYjZ2SzcyT3g2UWY1RGFxek9qMUN6bGdpbGhjczVoemRwMm92UytVSjY0czdQbmpvU1Z4QWU3V3UySlk3ZDdsaVN1aHY2eVluRVlWSDF5RC8walVTc2NwQnFVbXVYcVdNRU5Fem12ZFNlS2RGbzl4N0ZHYWFMbVNCZUh2RGhiODBuV3VPOU1tWlhJcjEyMXB5V2JYZGx5WXRPcXBVdnorNlpYRFpSNTR1M1dDU0ttUnZ4KzJ3TkFyRCtac00vdWRDb0lFem12ZFNkcUUrbCtLdXlma0ZqcDZjTUhqZFNJQUZxMUNaNEplY25xTHl5bjV6ZGxrOGxPV3QxWm5Zd3k4WlZuOHJPcXU2alhRSEY4eDB4OWRkTWdnK3RQNktjM0o5MHBVaDlNTEowNFJ3bW5zR1Z6MmhMRmVhNkZhRGl5SjVjL3lGY0xjbWxMS3FrWjhsOEw0YThqcHNuTmF3cHU1YlBpN2U1b3hCOGpOUWhOU01vamJlcUVDWnc0NDB0VU5NSEtqS2YrK1pHZ2pLRzhkS3BsNmJTcVBabE5LbzU0Y3d5RzRqZEpNYzNFTjFWQjlQRG12UjZPUkNHRXhyV1V6ekVwcnhNbWNPTDhPVE9sVUZHelltYzJwNWFmOGp4enlMdWFUbmxUQy9mRWtFazN5UmJLdGdHcEVKclZtQ09xUDRDak5GSHk2TXBxTExwbFQrcVVKOTV1SFJvdjNpSXVNSVF4VmNvQnN4NmN0SGIyNjA4NHpkbFVsV3Zlc1gxemRwNHUxS3pwTzVMR2szS1ZNNWNIV3RqYW1DaGJOTXRBM2NxZjJKRmNUVXl0dk5YSjdCN3RTWWN4Y2F3TG1QWGc3TjNGNEVUYS80Wm1aYTBweFE3Y3RsaTkvSzlwV3FJTU5GbDlBbmJPbVRKcldtTE5sRGs0MW5jYTA2WWNYLyt1UjFGNkRpZTRGNlgvQ3M5WkxRYWw5cVFDaWF2RHJrWENWYUltYW9BU3p5eUFOazl6NHNxWVNEa3UydXRSSCt4Rit2NDEwWFNXQVpUNG9pNGVrQ0gxdGxLdjFCME1pQ3FnTUdoeldScGpJdVVDWnYxN2tlSzVNTkZNbEhRcFpGSGlEclUvY2JUUEdiRjZHUEhIOWptbGZwcW9BV29OdXJJcFFMRmdSbUJNa2ZMNjl5S1Zkc3N6bFdnU3lvWEtsa0RKSkJrbGdjU0RoYVNvbHZwWVBjL0pUQTFSQmhvMGFMeEpQS2RvbGpBbVV0NG9UcFgyNXZLY3RSa0pOeWcxeVM1TUVnOFRDdUh4VGlKcWdCWWJ0R1Y2NHl6alBrc1lFekFiVVZRdm5rVThsLzlwMzQ1WkV3YWlPSUJMRjF1b0VDelVmZ1hCMVZuRWxJQmJ5UklrT0NRdTZwQWgwS2xRT3ZSNzkxN3VIdjg3SDRMR1Mwd2gvdzR0blI2Lzl5NllaM0tUWng0NUYwdFFzdVFsVlpHb0JoVURXcXk5V2NyQjlIVGFYYy8zbWdPYS94WWZRL2RpQ2NwcUpxL3BNNEZpUUgxY1FSZnhxYVhId2NScFAvR3NBNXB2WTVLMHBsS1BKU2hySEp4ekF6cVB3K3NwZnhRbDl1Qms2WFV3VWJUcnlhQ2J3L0t5T21kSnlwSk1pUk11S1dzUDZJZ0hsRUNMOEVwS09qVENFcFUxNW9rSE5EYWJvc3pPbHgwZXQ0ZXBnb1FrVVRvWHkxc0xEc1NBQW5RYUplRUZra2tNeWtZdHBTZEtadEdoTXAybVpiTEx2cGE1dW5NN3ZpWGJmUm1sOGR3NFBqbVNMaVU5NElENEdWQ0FxdUxtcTJnWG5vWE05cFVrS0J1MmxKNE1xa1d4ZCtSZ3k0dkZKeVJCS1U2NHJ3RUZLRWdQWlpMTjFxRzZSZi8rWElUNThwaVU2V3FLVTRQUHZRMWJ3cE5IQURXcnVOdGg3SGlkM1Jvay9WUEtBWDNFWmdTa0lucHJKYTQveGxJZW1VWTh4d3lLYjFZTUtvSmxOME5DMGl1bEhGQUdSVzBuelViTGNXcHN5allzNGNrbHU0LzlqMmlmeXhsVlA4NUxGSkFFWlRQVkFSVHRsdDNHcWJGWEJFVFpocVVzbVVWcDdhaFJFYU9JRjN4c3lVWnJEV3hRbTVSRGdoUnl4QUlRbERVNjdRTzBFc1hiVXRxVklsOCthMGNTb054dWtJcHVpMVBUT3FXOFZlWVZHYUdxdk9vODYyQzNCc21Xd3NXQmxHSytTa2ZMQ1pJbDcwRXBSWFhaaEdwblRCRXY3YllaZmdYV3RCdk5mdEMvMEcwdEdRdzZrSWsycGNMdDBEL3U1WWphaU5Sc1JNblV6ZGhBZGtYU01aMEVUaVlxZzI0azRDUGs1djdkL3E5QnQxOVU5RitkNlhhZlBuMzY5T2x6YS80QUhUTUs5Y2xobllBQUFBQUFTVVZPUks1Q1lJST1cIlxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vYXNzZXRzL2ltZy9lbnRlci12ci1idXR0b24tYmFja2dyb3VuZC5wbmdcbi8vIG1vZHVsZSBpZCA9IDE0OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IFwiZGF0YTppbWFnZS9qcGVnO2Jhc2U2NCwvOWovNFFBWVJYaHBaZ0FBU1VrcUFBZ0FBQUFBQUFBQUFBQUFBUC9zQUJGRWRXTnJlUUFCQUFRQUFBQlZBQUQvN2dBT1FXUnZZbVVBWk1BQUFBQUIvOXNBaEFBQ0FRRUJBUUVDQVFFQ0F3SUJBZ01EQWdJQ0FnTURBd01EQXdNREJRTUVCQVFFQXdVRkJRWUdCZ1VGQndjSUNBY0hDZ29LQ2dvTURBd01EQXdNREF3TUFRSUNBZ1FEQkFjRkJRY0tDQWNJQ2d3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBei93QUFSQ0FGWUJEc0RBUkVBQWhFQkF4RUIvOFFBNkFBQUF3RUFBZ01CQVFBQUFBQUFBQUFBQUFFQ0F3Z0pCQVlIQlFvQkFRRUJBQU1CQVFFQUFBQUFBQUFBQUFBQkFnTUVCUVlIQ0JBQUFRTUNBd2NDQWdVR0Jnb01DZ1lMQVFBQ0F3UUZFUklHSVRGQlVSTUhDR0VKY1JTQmthRWlGZEV5UWxJakNyRmlrOU1rRnZEQmNwTFNNNVRVRnhqaDhZSlRjNE9qUkNWRmhaV2lRelJVeERWVmRWWVp3blNFeGRVYXNtT3p3K09rWmVVbVJsY1JBUUFDQVFJREJBWUdDQU1HQlFNRkFRQUJFUUlTQXlFVEJERkJVUVZoY1pHaDBRYUJzY0VpVWhUdzRUSkNraFVXQjJJalUvRnlvdEl6azRMQ1F5UlZZMVFJc25QVE5FUWwvOW9BREFNQkFBSVJBeEVBUHdEK2Y5QUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQVlGQVlGQThwUkxHVW9XTXBRc1pTaFl5bEN4bEtGaktVTEdVb1dNaUZqSWhZeUlXTWlGakloWjVRaFl5aEN4bENGaktFTEdVSVdXUkN4a1FzWkVMR1JDeGtRc1pTaFl5bEN4bEtGaktVTEdVb1dNcFFzWlNoWXlsQ3l3S0tNQ2dFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQmdVRHlsRXNaU2hZeWxDeGtRczhxRmpLRUxBYUZVc1pQUkN6eWVpRmdNS0Zua0tKWjlOeUZqcE9RcytrVUxIUlFzZEZDeDBrU3gwa0xQcERpaFk2UVFzZElJV09rRUIwZ2dmVGJ4UUhUYWdPbTFBZE1jRUIwL2lnT244VUIwL2lnT20zaWdPbTFBZE5xQmRJSURwQkFkSUlEcEJDeDBnaFpkSkN4MGtMSFNSYkhSUXNkSW9XWFNLRmpwbEN5TEhENElXTXBRc3NwNUl0akw2SVdXVDBRc1pRaFl5aFJiR1ZDeXlJV01wUXNaU2hZeWxDeGdVVWtBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VCZ1VEeWxDeGxLSll5SVdlVUlXTW81S3BaNWZSQ3p5bEVzK201Q3o2UlFzZEZDejZRNG9sanBCQSttMUFDTUlIMHh5UVBwK2lxV01ub2haNVNoWXlvV01pRmpLRUxQS0VMR1VJbGpLRUxHQVFHWDBRc1pmUkN4bDlFTEdYMFFzOHZvaFl5bEVzWlNoWXlsQ3hsS0ZqS1VMR1VvV01wUXNaU2hZeWxDeGxLRmpLVUxHVW9XTXBSYkxMNklXTXZvaFl5K2lGakw2SVdNdm9oWXloQ3hsQ0ZqS0VMTEtFV3hsQ0ZqSWhZeWxDeXlZNzBMR1QwUXN1bU9TTFk2WTVLQmRNY1VDNlFRSFNDQmRKQ3dZaWkyUmlLRmtXRUlXTXBRc2kzbUVXeXloQ3hsQ2kyV1JDeGxLRmpLVVd5d0tBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUUNBUVBBb1dNcFJMUEtoWXloQ3p5K2lxV01wUXN3d2xFc3hHVUxNUklXWWlDSlppTUJBd3dja0R5ZWlwWjVTaVdNaUZqS0VMUEtFU3hnT1NCNWZSQ3hnVUxHVW9saktVTFBLVUxHUkN6Nlo5VUxBaktGbjBqeVZTd0lUeVFzK2k3MFFzK2lVU3o2UE1vV09paFk2STVvV09pT2FGam9qbWhaOUVJV09pRUxIUmJ5UXNkRnZKRXNkRnZKQ3o2STVKUlk2STVKUlk2UTVJV2ZTSEpDeTZRNUlXT2lPU1VXT2lPU1VXWFJieVFzZEZ2SkN4MFFpMk9pRUxIUkNGbDBSelFzZEVjMExIUkNGam9vV1hSUE5DeDBTaTJYUmR5UXNqQ2VTRmpwSGtoWmRQNHFMWmRNb1dNaUZqS1VMTEtVTEdVb1dNQ2lsbDlFTEdBUUdVSXRsbENGaktoWkZoUXNpejBVVUZnK0NCR01JRjBrTExwRkZzdW1VTExLVUxMS1VXeGw5RUxMS0ZGc1pRaFpaVUxHVW90a2dFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFRHdLQXlsRXM4b1FzQm9WU3p5bEN6RENVUzFDSW9XWWlSRHlCQXd3Y0FnWVo2S3BaNVNoWXlvV2VVSVdNQWlHQnlRR1VvV01wUkxQSWhaNUVMUHBIa3FsbUluSVdmUlBORXMraU9hRm4wUWhaaUZ2SkVzZElja0xNUmhDejZhcVdmVC9zd1NqVUJHU2lXZlJkeUtVV1loS1VhaDBEeVNpejZId1JMTVFvV2ZSSE5Vc2RCRXNkRkN6NkxmVkN4MFcrcUZqb0JDeDBBaFk2SVFzK2tPU0ZqcERraFk2TGVTRmpvdDVJbG4wZ2haZEZ2SkN4MFc4a1d4MGh5UXNkRWNrTExvaEN4MEFoWTZEVUxIUmI2b1dPaUVMTG9JV09naFk2STVxTFpkQkN5TUJRc3VnZVNMWkdFOGtvMURwTzVGS0xJeGxGc3VtbEdvZE5Gc2pHT1NoWmRJY2tMTG90NUl0Z3doQ3k2S0ZsMGloWmRJOGtXMDlQMFJiSXN3VUxHVkN5eWxDeGdVV3lJNW9EQUlXV1VJdGpLaFl5bEN5eWVpRmtXRGtvcGROcUJHSUlXa3hGRnNpd2hDeXdLTFpZQkFaUW90bGxLRmpBb3BJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFZRW9IbEtKWjVVTEdVS3BaaHBRc3d3bEVzeEdVTFVJa1F3d0lHR0RnRUZaU3FsaktoWjVRaFlSRHdLQXlsRXM4aUZtSXp5VkxNUkhraVdvUWxFc3hEektGbUltb1dZaUhKRXN4SDZJV1lZcWxtSXloWmlJOGtTMUNFb2xtSWZWQ3pFSStLcVdZaEhKQ3o2VGVTRm1JZ0VTeDB3aFpobkpDenlJbGdSNDhFTFBwSGtoWmlGM0pVc2RGM0pFcytpZWFGbUlEeFFzK2dpV1BsMG9zZEJDekZPbEZqNWYwS1VhaDh2NkZLTlErWENVbW8vbHdsR29DbjlFbzFIOHQ2SlJxSHkzb3JScUh5dzVKU2FoOHQ2S1V1b2ZMZWlVYWlOUGh3U2pVUGx3bEdvdmx3bEdvZkwraFNsMUQ1ZjBLVWFnYWRLTEw1ZEN4OHVsRmpvSVdYUWNpMlJoS0ZsMFhja0xCaVBKUmJMcEhraFpkTkN4a1JiSXNIRkN5NllRc2RJRkN5NlE1SXRrWVFoWkdFSXRrWVNvV2t3bmtpMlJpUEpDeTZaUmJMSWhaR1BIZ290cE1RUEJGc2pFT0NGa1lUd1FzakVVV3lNUjVJV1JqVVd5eW9XV1VvV01DaWxnRUJsQ0xaWlVMTEtVTEl0SEVLS1JqQlFTWXVTRmtZeUVXeXlsQ3lJUEZGTEtFTEdWUmJMS1VMTEFvb1FDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQmhwUkxQS0VMTUFEY3FnRFNVTFVHWW9sbUlrUzFDTUlHR0RnRUR5bFZMUEtoWjVRaFl3Q0llQlFHVW9sbmxRc3d6MFZTMUNKM3dRdFFoNWxFc3hFMUMxQm5JSWxtR0twWmhpRnFFSlBCRXN4Q1VTejZQTW9Xb1FoVkxNUkRraFo5TUlsbUdJV1lZaVdZaVBKQ3pFVGxVdFFoS0ZtSUVTekVBNUlXb1UrUEJLVFVZcHp5VnBOUmluUEpLVFVZcHlsR3RRcGlkeVVtcy9sVHlWbzFtS1VwU2F6RktsSnFNVXdDVWFqRk0zaWxHcVQrWEg5Z1ZTMWZMdDVGS1RVUGwyOGlsR29mTGprbEdvZkwraFNqVVlnOUVvMUgwUFJLVFVPaDZKUnFIeTQ1SlJxSHk0NUpScU1VNUcwQktOUTZEdVNVYWlOUHpDVWFoOHVPU1VhaDh1T1NVYWgwUFJLTlJkRDBTalVYeS9vVXBkUStYOUNsR29mTGprbEdvZkx0NUZLTlJHbmJ5U2pVUnAyOFZLV3lOTTNnbExxSTB3U2pVWHl2b2xMcUkwcENVYXkrVlBKU2wxcE5PVW8xa2FjL0ZLWFdYeTVTbDFFYWZIZ2xHb2pUNGJ3cFM2a21BSXRrWUVMU1lTRVd5TVR1U0ZrWXp4Q2kyV1JDeUxBVVd5NllRc2pDT1NMYVRDT0NGa1llUlVXeU1KNElXa3hFY0VXeUxFV3lMRVcwbU1jUW9Xa3hCRnNqRWVDRnBNWjRoRklzVVd5eW9XV1VvV01DaWxnRUJsQ0xaWlVMSXM5RUxJc0NpcE1hQkdKRnRKWVFoWllFSXBFQTcwQmxDaTJSYVVMSkZDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFHQktCaHBSTFBLRUxNRGtxaGhwUkxNUjRvV29SNElpZzBCQXcwcXBaaHZOQ3pBQVJBZ2VVb2xubFFzd3prRlMxQ0ozSkVzeER6S0phaEUwSVdvTUEzQkVzd3hWTE1NUXRRaUozQkV0UWhLSlppRWZGVkxVSWdPQ0ZxRE1FU3pERVN6RVpPNElXb1JGVkxNUW9Xb1FCRXN4QjZiVXBOU2hBZDJDdEpxVUlEOUNVbXRRcHlTbEpyVTJtOUZhVFdvVTNOS1RVWXAyaEtUVW9RTlZTMUNEMFJMVUlUdUFTalVZcDNjQjlpVW1wWHl6MWFOUmlsZWxKck1VampzU2sxcUZHZUtVYXpGRmlyU2ExQ2lQSktUV29VU1Vtc3hSamlsR28vazI4RXBOWi9KaEtOWi9LTjVLMG1vZktNNWZZbEdvL2xHcFJySHlZNUpSckh5WTVKUnJQNVhEZ2xKcU1Vb1BCS05SL0tlaVVhaDhuNkpTYWg4cDZKUzZpTktCd1NqVVJwY2VDVWFpK1RISktYV1BreHlTaldEUnQ0aEtOWkdqWnlTalVScEduZ2xMcUh5WVVvMWthTnVDVWEwL0pwUzZ5TkVsR3RKb2p5U2wxcE5HcFM2eU5HZUNVdXNqU09TbDFwTks0SlJxSTB6OEVwZFJHblBMN0ZLTlNURGp3U2wxRVlCeVJiU1lHb3RwTk9DcFJxU2FiYWxMcVNhYjBTbDFwTlB0VXBkWkdBL3dDMmxMcVNZUFJLWFVrd2VpbExxU1lFV3lNQkNMWkdJb1drc1BFSXRrV0JRc2pHQ2kya3dqa2kya3dvV2t3bjRxTGFUR1J3UmJJc1JiU1dLTFpHTWNRaGFURU9DTFpHSThFVzBtTThrTElzVVd5eW9XV0JDS1NBTFFVTEl0NUl0a1FlS2lrV3RLQ1hSOHRxQ1N6QkZ0SmFRaTJNT2FCRm9VV3l5bEN5UlFnRUFnRUFnRUFnRUFnRUFnRUFBVHVRTU41b2xubENxV1lCTzVBdzA4VVMxQ1Ard29Xb1JoRU1OSEFJS0RTcWxqS0VMTkVOQVpTaVdZYUVMVUdFN2dxaWhFZUtKYWhHMElXb041QkVzdzNtcWxxRFBSRXRRaVB3UkxVSVJ4VkxVSWh5UkxVR1lJbG1HSVdZajVCRXRRaVAwS3BaaUZFdGJZRGpzQ0ZyRk83Z0ZhVFVvVXorU1V6cVUybGR5MnEwbXRiYVIzSktaMUtGUGh2UkxVSVJ3VlMxQ0QwUkxVSUR2d1NrMUtGTzVXalVvVWprcE5haFJua2xNNjFpaitwV2sxckZHT0tVbXRRcEdxMG1wUXBnTnlVbXBiYVlZN0FsSnFVS1VuOUZXazFLRks3a2xKcVY4bTdpRXBOWnRvM0pSclA1SXEwbXRRb1VwT1lvVUI1SlNjeFFvUFJXazVpbTBIb2xKekZDaDlFcE9ZZjRlbEhNTVVHQ3RKekI4ajZKUnpERkJqdyt4S09ZUGtQUS9VbEhNTVc4SGdsSnpERnZQSktUbUg4Z2VTVWN3ZklIa2xITUh5QjVKUnpDTnZTbDVoRzM0Y0NsSE1MNUQwUDFKUzh3R2hTam1GOGo2SlJ6QWFERlNqbUpOdkEzcFM4d3ZrZlJLT1lUcUE4a3BlWWswUG9sTHpFbWdQRUtVdk1TNmkyYkFsTHpFL0pGS1hXVHFNN2xLWFdYeVpTaldrMGhQQktYVWswdUd6QktYVWgxS0J3MnFVdXBKcFFsTHFRYU1LVXVwSm85aVV1dERxUDBTbDFvTkllU2xOYTBtbElTbDFKTk80SlM2a21BamdwUzZrbUQwUXRKaGFpMmt3S0xhVFQraVV1cEJnU210U1RDcFM2a21IMFNsdEJoK3RScTBtRW9Xa3h1Q0xaRm5vb3RrV0l0cE1ZS0ZrWVJ5UmJTWVVXMHVpSVVMUVdJdGtXSXRwTEJ4VVcwbUlGRnRKaklSVWxuTUlGbDVLTFpGcENMWklEQUZBc29SYkl0S0ZwTEI4Q29wR1A2VUVsbUhvaTJXVW9XUkhORkxLRkZzaTA4RUxMY2loQUlCQUlCQUlCQUFFb0tEUnhSTE5WRERTVVN6YXpraGF3em1pS0RlU0Jodk5WTE1OQVJMQ0JnRTdrRHlsRXN3MEtsbUdPTzRJaXhEelJMVUdORzVDMUJwVlN6REVTekVaNEJFdFlpUEZFdFRZd0ZVVUdmUWlXb01RdFFZZUNyTnFFWE5DMUNJSWxxRVhvaVd0c0RpclRPcDVGUGJueW5BREVwU2EzNjF2MG5QVTdtSGFyVE9wK3ZTZHZLcVJvSVo5UVJMZVczdHJWSGFJeVZVdFE3YVZ2Q01vbHJiMnpyaitnZm9TazFHN3RwV05hU1l6ajZxMG1wNGRYb2FlbjJ1WnMrQ1V6T1Q4eXBzVHFjNE9CeDlWYVoxUEZkUnRZY01GYVRVb1U3ZDJDVXpxVzJueEd3SlNhbENsZHlWcE5TeFNPU2sxcUZHclNhMXRvY2VDVXp6RmloOVByVnBPWTBiUmNjRXBuV3R0Ri9ZRmFUV3R0RDZKVE90bzJnSjRLMHpyVUxlZVNVbk1XTGNlV3hXazVpaGJrcE9Zb1c1S1RtS2JiaHkycTBuTVVMY09TVW5NVzIzRDlWS1NkeFF0eC9WVnBPWXNXNDRmbXBTY3dDM0hrbEp6RC9BQTRwUnpERnRjT0FTam1IK0dua0ZhVG1IK0hIa2xITUF0cDVKU2N3L3dBTjlQc1NqbUQ4TVRTYzBmaHZwOWlVY3d2dzQ4a281Z051UEpLWG1FYmFlUVVvNWlUYlhEZ2xMekIrSEZLT1lYNGNlU1Vjd25XNC9xcFN4dUlOdS9pcFM4eExyY0QraXBTOHhKdDdlU1V2TVFiY01keWxMekNkYjBwZVlnMjRwUzh4THJlN2tsTHpFbWdJNEtVdXREcUVqZ2xOYTJicUlEZUZLWFdnMFNVMXJRYUk3OEZLWFdnMFhvbE5hMEdpOUZLWFdnMFpTbXRhWFVoVXBkU0RTbmtsTHFRNmxIRUtVdXBEcVlGS2ExSWRTQWxTbDFNM1VoU210VE4xS2VTbE5Sa2cwNVNsMUpkQzcvYlVwZFNIUTh3aTJrd2hGdEpnVVcwR0QwU210U1RBcFN4a2t3L1VsTHFRWWdvMWFEQ2kya3hGRnRKYVVXeUxRb3RwTE1VTFM2SWZCRnRCaUkzS0xhVEh6Q0xhY3ZKRnNpM21GRnRKakJSYlNZandSYlNXSGlFRWxvNEtMWkZwUXNJcElES0VXeUxTaGFTMEZSVWxoSHFFRWx2MW90cElJUlJ2UUl0NUtMYVNDTjZLRUFnRUREU1VMTU5BUkxOVkREU2lXcHJPWDFvaWd3RGVnb0FuY2dZYnpWU3pSQWdZYVNpV1lhQXFXb05KM0lpMnhmcklscURXamNFUzFCcFZTekRFTFUyTW5jak5xRVhOVXRiWXh3Q0phZ3hFc3d4RXRRakpWUzFDTG1pV3NSaEMxQ0k4RmFadGJZVXBKeVcyRDBWcG1jbWpJQ1Rnak52Tm9iYTZWNERSaXFsdmM5STZFcWJqSTBCbXcraUpiazM0MGVDR3RPOGRkRERRVWp4VHZjMW9kbE8wazdBQU4rS3NSYVJjelVkcm1OcDMySk84TlRiWWE2T3hWcm9aV2g3WEdtZTBrSGNRSDRIQThGMkk2VGNudWVoajVUMU9VWG9uNmFqM1R4ZnJSK3hQM2VBd05oclIvd0FRVnI4bnVlSHZnL2svVmZnOThmRnEzMktlN2cvNmhyUDVBcCtUM1BEM3duOG02cjhIdmo0cUhzV2Qyd1AvQUZGVy93QWdWZnllNTRlK0Uva3ZWZmc5OGZGblVleFQzZ2xhUXl4VmdQckFmN1NmbE56dzk4Si9KZXEvQjc0K0wwTHU3N0YvZi9UbWxhdlVOdnNGWkkybWpkTThOaE9PRFJpZGkzajBHN2xOUkZ6OURlMTh2OWJ1NVJqaHR6TXozUlV6UHFpM1hsM1g3UzM3UU9xYTNTbXBLU1dqdnRGSVlaNmFvamRISXc0WWpGcnNEdEJCSG91dG50empOVEZTODdydWozdWozY3RuZnd5d3p4N2Njb21KanY0eFBvNCtyaTlHbjB6T0g3R2tqNEtVNlU1b09uYWhtMXpjRmFabk12d2lScHdPOUtabk50RFpKSk5nQnhWcG1jM2t4YWFxaU5qRmFabk5aMDNVTjJrZlVyVFBNRGJCSnVJS1V6ekc4V21aMzdoaXJTVHVQSmowbFVrWTlQN0VwbWMycmRJMVg2bjJLMHpPYTI2UnErTFBzU2tuTWpwV3FidmJzK0N0TXp1Sk5na1ljQ0NyVE03aW1XUitQNXFVazdqZUhUVTh1eHJmc1Zwbm1QS1pwR3FjTVJIOWlVbk1XM1I5WCtwOWlVbk1XTkhWZjZuMkswenpBN1NGV3dZWmZzVFNuTVpuVFV6TmpnclNjd00wOUlUZ1FVcE9ZM1pwU29mdUIrMU5LYzFxM1I5V2RtWDdFMHB6VkRSbFh0KzdqOUN0SE1MK3A5VitwOWlhVG1wZHBPb1lNUzA0SnBUbXNuNmVrak8xcCtwTkp6VUd6bHU5djFKcE9hWDRXT1NhVTVwZmhXSi9OVFN2TlV5eHVlZGcreE5KelhrUTZWbGxQM1c0am1tbGVhOG1QUXRWSU1Rd242RTBuTmFmMUJxLzFDbEhNWlM2RnFXL29GVFN2TmVIVTZWbmgvT0c3MFNqbVBFbHNybWNFcGVZeS9DbkU3QXBUWE1XeXhTU0hBREZOSnpIa1I2UnFwUmlHZllsTmN4b2REMWhHSWoyZkJTbDVqQ2ZSdFRIaVN6REQwU2w1andxaXdQaTJ1YnNVcGVZOFY5cndPQUNVMXpBMnp1a09EZHFsTmN4dkhwV29tMnRiajlDVXZNYURSRlk3Ymt4SG9wVFdzbjZGcTk1alAxSlRXdGsvUTFRTnVSU210YkdYUk5VMFlsaEErQ2xMekhoMU9sNm1MWmg5aVUxekhoeVdXVnB3dzJLVXNacEZqbWZzRFNsTlJtdHVtS2gvd0NqOWlsTlJtVHRLVlc4RDdGS2FqTm0vU2RYeGI5aVUzR2JLVFMxU01mdW42QXBUVVp2Rm0wL1VNT0pHQ2xOUmt3ZmFaZ2NNTWZWS1hVUXNVejl6VDlTbExxUCtyZFNSZ0cvWWxOYWt1MHRWbmFHL1lwVFdwbkpwaXNidmI5aVVzWk1KTk9WVGYwZHZFYmxLYWpKNDgxb25pM2dnK3FVMXFlUEpUUGJ2R0tpMnlkRTM0RkZ0RG9Tb3RvZENsTlJrZ3hLVTFHU0hSYzBXMEdKUnEwbUxraTJrc0lRdEphRkZzaXpGRnREb2h4UmJTWWp3VVcwRmg0aEZzaXhGdEpielVXeUxBVVcwT2p3M0lxQzA4VUNMZVNpMldCUlNRQkFPOUFpM2tpMmt0QjNxS2tzSTNJSkxSOUtMYVMwaEZzSUVXOGxGc3NwUXN3MEJWTE5BdzA4VVMxTlllQ0lvTUFRVUFTZ1lhRlVzMFFJR0drb2xxRFFGVXN3MG5jZ3RzWDZ5SmF3QU55SVlhVlV0UWJ5UkxVMk1sRXRiV0FLb3NOS0paaG80SWxxRENWVXRiWSthSW9Sai9iUkxXMklsV2tuSmJZZjdBbE16a3RzUElLMHpPU3hDQnZWUzF0ajVCRXRiWVhIWi9BbE02bm5XKzFQcUhnQVk0ODFhU2NudjJoZTMwOXluWTBNSnhJR0dDdE1UazV1ZUVmZ05xWHV6ZjZCbnlFa2tNMGtjY01UR0V1a2M0N0FBdFk0VGxOUTF0NFpibVVZNHhjeTc3L0JEMjNORCtOdGdvTlM2d3BZYWpYTEdOa3A2TU5CaG9YWUE3VHVmSU9KM0RoelV6M28yK0dQYjQvRDQrejArNzArekhUOW5IUHg4UFJIeDlualBLcGROUWdFQWdFSDVldHRhYVo3ZGFTdUd1TlpWY2RCcGkxd3ZxNnlxbmNHdFl4ZzNETVJpNXh3YTBieVNBTnBYSnRiV1c1bEdPTVhNdTU1ZjBHNzF1OWhzN09NNVo1elVSSDZka2RzejNSeGZ6d2U0UDQ1MjN5Y3VXcXUrbmF1Mi9LeTJxcnFheWx0ekljSlpMUExVdmxFWDNYdmFEVFJIUHZkOTNFQW5qOWw1aDVmbGx0Um4yNVl4eDlQakwraFA3MWZKT2ZXZVU3SFd4OTdxZWwyNHgzSml2djR4RVhNencvWm04bzRYV1U4UERoekQ0bjY5cUc5VDhNbXdPMy9BQmJ2eUw1dW44ZHptL00xSDR2NjN0RksrcHFMYksyRm94TG5SdUErMUtabk44OXJORFMwMVNZblJrU05KQkdHNHEweE9iMlRSSFptK2FwcUd3V21rZlBKczJOYVNyVE01dm9kTDRqZHdERG1OcW14dy8zdDM1RmFabk4rVnFQeGwxcFk2YzFWZGJwWTZkdTl6bU9BMmZFSlRNN2oxYWw3WTFNOVFLZU9JbVFuQURCV21KM0h2Mm5QRmZXOXpoWlBEYkpURzRZZ2lOMkI5ZHl0TTh4N05UZUlHdVMwWnJYTGgvd2J2eUswenpHdzhRTmFnLzhBcXlYK1RQNUVwbm1ORytIK3R5TVJiSmY1TS9rVnBubVBDdXZpWHJPamlMNUxaS0Ivd2J2eUswek80OUYxTDJYdVZua2RIVlV6bzNqZzVwQ1V6ekg0MVAyNW5kTUdpTTc4QXJUTTdqNkZvenhqMW5xR21iVjBGdWxrcDNmcE5ZU1A0RmFabmNlNVVQaHhyeDBZYzYxeS9EcHUvSW1sbm1QSkhoMXJodXo4TG13LzROMzlzSzZVNXBPOFBkYjRIQzF6SC9peitSTktjMTRGeThSOWRSTk9XMVRFY3hHNzhpdWxubXZSdFhkaTlRYVlreTNlaWZCanV6dElUU2s3cndMSjJucmJwVk5wNlNBdm1jY0FHakVxNldlYStoV1B4UTF0VlJ0ZitGeTRIYUQwM1lmd0pwVG5QMjQvRVRXbUdKdGt2OG1meUpwVG5IL3FrYXgvOW5TZnlaL0lycE9hUDlVUFdiaGlMYktSL2NIOGlhVTVyOHk5K0tlcjZHSXl6VzJVTkczSElmeUpwVG12bmVxTzBsVmFIT2pxWVRHOGJ3NXBDYVRtdlM3bnBoMUs4Z2pjbWxPYS9QZmFBSEVZSnBPYXVuc25WT0FHOU5LODE3RHAvUWo2MTRBWmpqNkpwT2ErcDl2L0FCbzFOcTV6V1dtaGZNVGh0YTBsTks4MTlhczN0NTkwNnluRW90Y2dCQTNzUDVFMG5OZm9qMjZPNkovNnNrL3ZEK1JOSzgxK2RldmJyN3J3VTc1VzJ1UXRISmhVMG5PZkZ1NlhqaHFmUTA3b0w1UlBnZU1SOTloQ2FWNXI1TGZkSk9vM2x1WEFmQlRTMXpYNWNOaGRKTGxMZnFUU3NicjJmVFhiNmE0eU1ZeGhMaWRnQVRTdk5mZGUzbmcxM0oxZGJZN25iTFpJK2tlQVd1eUhEbXBwYTVyM0ZudDI5MUJGZ2JYSi9KbE5LeHV2d2RUZTN6M1lvNmQ4emJWSVd0Qkp3WVZLYTVqajkzRDdUM1RTZHdrdDF5Z01kVkdTMXpTTnV4U211WTlCcmJFWTVpM0w5U1UxRzQvUXNla2pWeUFCaEpQb3BUVWJqN2YydDhPZTRQY0MzdHVOaXQ4azFNZjBtc0pIMktVMUc0OS9wdmIxN3FobTIxeWYzaC9JbExHNEpmYjg3cVI3QmFwTVA3Zy9rVXBybU1qN2YvZFE3N1RKL0puOGlVMUc0OFM0ZTMvM1NaRVgvaE1oUC9CbFNtNDNIelR1TDRuNjIwaXg4bDF0c2tVYmQ3aXc0YlBvVXBxTng4b3VYYnlXbnFITWN3akE3c0ZLYWpjZnE2TjdMM3pWRlNLYTFVenBwaitpeHBKK3hTbTR6ZlE3YjRmOXdKV0RQYVp2NU4zNUVwcU0zbU84T3RkaHVKdFV1UDhBd2J2eUtVMUdiQ1R3KzEwUCtxNWY1TXFVMUdid2EveEYxNHhwSXRjcEhEOW03OGlsTlJtOVMxVjR5YTZ0TUQ2bXB0Y3pJRzdTNHh1d1Ntb3pmUDV0QVNOcWpDNWhEd2NDTU9LbE54bTlxMHQ0OWFxdjBJcUxmUVNTd25ibWF3a0tVMUdiMmVuOFV0YXVidHRrdjhtNzhpbE5SbWNuaXJyRnB3TnVsQi80TS9rU200eVp1OFZkWnVHQXRzcC80cy9rVXBxTW5oM0R4VjFuSEdTNjJTN3Y5N1A1RkZ0Nk5yRHNmZTdHSGZPVWo0djdwaEg4S1UxR1Q1emZ0S1BvM3VCWmhncFRXcDY1VlVSamNRUnQ5Vkthako0N29DRXBxTWtHSS9GUnEwT2pIRUl0cE1QSlJiUTZIbUVwWXlRNkpTbW95UTZMQkthakpEb2gvdEtMYUhSY2thdEJhUWhaRUFxS2t0K3BGdExvd2R5S3pMQ0ZGdEphUHBScXlJSVJVbG9LaTJoMFhFSXRwTFNOKzVCSmFvdGtRVVVrQnZRSXQ1SXRrVzgxRlFXY2tFbHYxb1dSYVFpMlNLWWJqOEVTMU5ianNDSXNOQStLQmdFb0tEUUZVc0lnUU1OUEZFdFFBQ3FHMXJuYmtGdGlBM29sckF3M0loaHA0cXBhZzNraVRLMnhFNzBTMXRZQnUzcW9vTlBGRXN3M2tpV29NSlZTMXRqdzNvaXd4RXRiWXlyVE01TGJHRmFabkpxMkxtcXphd3dEY2lLRVpPOUVtV2pJY2R3K2xWbVphc3A4VmFZbko1Rk5TQno4T0NVek9UM0xST25QbktoZ0RjY1NBcXpNdXdMMjZ2YjgxYjMyMUpRQ2p0MGxVSm50RVVNVEM0dTI3enlBM2tuWUZ2RENjcHFITDAreGx2WmFjWXVmcTlNejNSNlhmMzRVK0IraVBGclR0UGNLNktHcjdoR01NZE5FQTZHa0JHMWtPWUFsM04zMUxqM2QrSWpUaDlNK1BxOUh2bnY4SDBHenQ0OVBqcHc0elBibDQraVBDUGZQZlhZNUJMcUlFQWdFQWd4dU54dDlvdDg5MnUwOGRMYTZXTjlSVTFOUTlzY1VNVWJTOThrajNrTmExclFTU1RnQXJqak9VMUhhMWhobG5sR09NWE04SWlPMlpkVFhuZDU5WFh5ODErZTIzYm1XU203RjJtY1BwY3pERyt1bFlDdzFrN1hISEE0dUVURGdRMDRrQnhPSDZENVo1VmowVzNyejQ1ejd2UkgydjZ1L3RkOGlma1B2VEY3K1VmZXk3WXd4L0RIMitNOW5DSDcvQUlTOXViYnFMVjlEWkpvV3V0bFZQQlJ5TmVHdURtVHl0aWVYWndRZGpqamlEOEY3T083eTlqYzNKNDFqTSs1OWwvY25xOGVqNkhQR0k0UmpsTlQzOEo3ZkczTDcvd0NWaDRsdGNURlExekdiY0dOcW84QjZETkVUOXEvTHZ6VStFZS80djRRbnkzWW45MzN6OFhnNnU5cVB3NHZHbktxaXYxSlh4MmtSdmRQTEhWeHRjeU5yU1hIRVFuY0JqdVNPcW53ajMvRXg4cjJKbjluM3o4WDgvSGMzc0xRM1hRLyttL1MxRzJrMDNXWGV2cElhUmhrT1NpYk4wNmFSenFpVjduUEwydmFjb3cyY0Y2MlhUenk0emVyNXY4bVpmeURhODQyc1l4d25keXdtSXV0TVRXT1Y1WlRNek9VWlJPbkdJN0pxSE1qMlNmRXZSbmRudXZEYmRjVXhrc2o0cHBwY2hheDU2VUxwQUd1ZGp0SkhJN1BySEZFUkdHV1U5MGUrNGo3YmZIZVE5RmgxV1c1T2ZHTU1MK25WampIZkhqZjBUd2RyNTl0cnhnTHMzeUZYOE92SGgvOEFzbDUzNXVmQ1BmOEFGNi84cDZmOFB2bjR2bkhsMzdkL2lQcG54dTF0cjY4VytzNmVuYkpkTDNFMXRTR2lTV2pvNUtpTmpza1ljUTU3UTA0RUhidkc5Ync2bWNwaUtqMy9BQlA1WDAyTVRNNDhJNDhabU96NmZqUGhFdW52U0hpdk9OUmFOMVE2bForR2FscDRxOTBNSWtNY016bjUrbU9ybWRnWW5NY01TY1NYWWJBdlczZW5uSEhIS3Yyb2Mzem44bmJ2bGZUZEYxbU9OYmZWN1VaUkVYTVk1ZmhqVmM4Y1p4eWk1bTVuS0k0UTdzTzBYdHkrUHRMMjJzajd0UlZBdTh0SEJQVWROOExHNTVJdzg0TmRHOGpmeEpYVDZ6cVkydDNMREhHS3htdS91K2x5ZFo1RDB1enU1YmNZWHBtcnVlTXh3bWUzeC8yejJ2Wmg3ZTNqa04xSlZmeXNIODB1dCtlbjhNZS80dXIvQUNmcGZ3ZS9MNG4vQVBMMzhjLy9BRFNxL2xZUDVwUHowL2hqMy9FL2svUy9nOStYeFVQYjg4ZFIvd0EwcXY1V0QrYVQ4L1A0WTkveFQrVGRMK0QzNWZGbFdlM2w0NDFzTG9wS1NwMmdnSHFRSEQva2xmejgvaGozL0ZQNUowdjRQZmw4WEdiemo5bXZRdW9PM1Z4MWQya0psdmxGRytvTnZtaWIxSHNhTVRrZkVOcEcvREx1WGM2WGYyOTdMVFAzWm5zdWVIcTlIdlRhK1R0bnJjNDI5bmMwYms5bXVZMHpQZEZ4RWFiN0ltYmpqRjEydXBlbTdIU1VlczNXR3FoTGFtR29OUEl3amExekg1U0Q5SVhQbGhPTTFMODk2M1kzZWwzczluZHhuSFBES2Njb250aVltcGlmVk1VN3FQQVR3UTdOVmZqZlpiN3E2M09mZmFzUGtMNDN0YTB4akFOMllIYURpdURyOTNrVGpqakVYcGlaOWMzUDFVKzkydmwzcG82ZlpuS0puUExDTXN1TS92VE14L3d6ajlOdnRyZkJ6eDlhTUcyNlgrVlovZ0xvL25zdkNQZjhUK24rbC9EUHRrLzlSN3grTyszUy93QW96L0FUODlsNFI3L2luOVBkTCtHZmJKZjZqbmo3di9EcGY1Um4rQW41N0x3ajMvRlA2ZDZYOE0rMlNmNE0rUFR4ZzYyeUgvakdmNENmbjgvQ1AwK2svcDNwUHd6N1orTGhCN3UvaEoyQzB2WjdIUzZNcGFtSFc5MXA3eldSbDh3NlRmdzZrYkxFTUF3REI4anNEdjJjdVByK1d4UFU0NXpNZG5aNzM2RjhwZjJ2OHY4QU52TFBNZC9MSEtOelkycjI2eXI3OHhsTVhkM0gzWXZzNFQ3T0hmdHgrT0ZwN3ErUUZpMDdlWXNiWFUxTWNFcmlOZ0QzWmNkeDRsYyt4dHhNek9VWEVSTXo5RVRQMlB4UDVROHYydk1PdXgyOTJKbmJqSFBMS3BxYXd3eXk3ZlRNUkg2VzdtYVB3RThlS0dCbFBCUjFBWXdCb0pmVDQ0RC9BSWxlTC9NY3Z3NCsvd0NMNjMrbitqLzAvZmw4VzMrb3AyQy84MXFNUDd1RCthVCtZNWZoeDkveFA2ZjZQL1Q5K1h4SCtvcDJCLzhBTktqKy9nL21rL21XWDRjZmY4VS9wN28vd2UvTDRtUEJic0dOMUxVZjM4SDgwbjh5eS9EajcvaWYwOTBmK243OHZpOE84ZUFQWUs2MHpvUGxwbWx3SXhmMEhqRWpZY0JHMytGV1BNWjc4WStpL2pLWmZMZlJaZHVNeDZzcCszVjlYdGNEL2RIOXJLMGR2TkExSGRQUXNiYWl4dzV2bUhSeDVIeEhhUm5BeDJFRGYvc1krbjAyZUhVWXpPUERLTzJKOFBHSjcvMDdYbmRkOGtaWmJHNXZkSmxPWEt4bkxMREt0V21JdkxMR1lxTW94N1ppb21JNDhhbXVvM1hPanhSVk1qQTNBZ25ncnBmblhPZWxUMmZDVXRBOU55YVU1cno3RnB6NW1ZTkxkdVBKTks4NXlHOFh1d00vY2ZXZERZb1ljd2xlMXBBR084Z0xXTzNPVXhFY1psemRQam52N21PM3R4T1dXVXhFUkhiTXpOUkVlbVpkNUhpbjdhWGE3dFpveWhuMW5TQ2E5dmlZK1NqWTNwOUp4QU9Fai96aWVZR0dDODNxdXNqREtjY09OZC9kOUh4Zm8zVGZLV3pzOE4zTFhsMzFOWSttSXJqUCs5Y1gzUjJTKy9VUFkzdERib3VoUzZlb3VudS9hUkNRL1hKbUs4K2Vwem52ZWxqNU4wdVBadHg5ZjF0LzlEdmFyLzRldC84QWtzWDVGT2ZuNHkzL0FDbnB2OVBIMk02bnNyMmxxNFhVODJuYUhwdkdCeTA3R25EMGMwQWo2Q3JIVVorTXBsNVIwc3hYTHg5amh4N3J2dC85dEx6MkJ1L2RmUU5DMml1bG1ZS2l1cFc0dlk2QXV5T2tZWDVuQndjNXVJeHd3MjdNRjZQUmI4N2s2Y3UycG1Qbzd2WmJ5dXYrVnR2ZDI4OHRqN3VXR09XZFRjeE1ZeHF5anZxWXhpWmp1bXE3M1E3M0UwczJsckpvMkQ4MXpodTljT0M3dWwrYzgxNnpaZEttcHF3TU5oT3dZSnBhNXJrejRmOEFqbFc5enU0VnNzTlBGbWJOTEcxeERTY0FYREU0RGtGeTdHeE83bkdNZDh2VjhrOHZ6OHk2dmE2YkRoTzVsRVg0UjM1VDZNWXVaOUVQNkJ1eVBpVjJnN2E5czdUcFdxMC9SeTNPbnAyQ3BsbGlhNTVrSXhMU2VPWGRqeDNyeXZNT3RqTGR5NVhEQ09FZXFPRit1ZTErc2VaZEQwTTcweHNiV01iZU5SandpWm1JaXJtYTR6UGJNK012YlA4QVFUMmQvd0RoeWgva1dycC9tdHp4ZEQrWDlQOEE2ZVA4TWZCblAyQTdLMU1SaHFOTTBENG5EQnpYUU5JSVQ4MXVlSy95L1kvMDhmNFkrRG9hOTRqc0JadTNIbFZxZTNXQ2lqbzdFNmQwMUhUd053WXlGeHhZQjlHMHIzdDJJblRsSGZqRS9UWEgzMithK2VlazIrbDYzR2RyR01jTnphMjhvaUlxSW5UR09YdHp4eW5odzR1Qk44MDMwcTR0QXcycmgwdmtJM1gwRHNGMmp1bmNQWE5uMFpZNEhUM2k3VmRQYjZhS05vYzUwazhvaWJnQ1FONTRrQkl3dDJ1ajJzK3AzY2RyRGpsbE1SSHJtYWYwV2VBWGlsMk4wOTQ5VytWMm5hQ3JsbW5xT2xXVFFSR2FTR0o0Z1laTWdETVRrSk9VWWJWUE9zK1R1eGhod3JHTDRSMjlyOTkrZXZJZWk2RHJZNmJhMnNJamIyOE1aKzdFWGxwNDVUdzdaNzc3MzI3L0FGZk95WC93eGIvNUJxOGY4em40dmp2eVd6K0RIK0dQZ1I4ZXV5RHQrbDdlZi9zN1UvTTUrSitTMmZ3WS93QU1mQXY5WGpzZC93REMxdS95ZHFmbWMvRS9KYlA0TWY0WStDSi9HL3NUVXhtT1hTdHZ5bmZsaERUOWJjQ241blB4SjZMWm45ekgyUStZZDkvYlg4ZE84T2xxdTEyeTNDelh5V040Z25oYzZXSHFGdURlcEhObk9YKzRJUHhXc09weWp0NHVoMUhrdXpuSDNmdXo3dnAvVTZDdkxieG5tN1FkNTd4b1N0cCtoWDBGVE5TenduQTVKSTNscEdMZG13cjBzOE5NMCtXNjNwOCtsM2N0ck9yandtNDQ4WW1KOEpqaTU2K3l4N2MvYXpXa1Vtbys3MURKUGRKYUEzZUtKa3I0akUyV2RrY0RjQU1EakhpODQ4d09DN1hVN01iSFRSdVRGNVpaVjlGUy9aZDM1RDZmeTc1ZjZmcStvd21lbzZqTzR1WmlNZHVjYnhpb21PTThNdVBqWGM3RjJlM3I0d3NHRGJQS0FObi9BSlFmeUx4ZnprL2hqMy9GOGY4QXkzcHY5T1BibC96RzcyOS9HSi81MW9sUC93Qm9kK1JQemMvaGozL0ZmNWQwL3dEcHg3Y3YrWkI5dS94ZGR2czh2K1VPL0luNXVmd3g3L2lmeS9wLzlPUGJsL3pJZDdkSGl5OFlPczAzK1VPL0luNXVmd3g3L2l2NURwLzlPUGJsL3dBejVsNWQrQVhpSm9ueHYxanJxdXNrd0ZvdGxWWFJuNW1VRHFNWmd6RU1BSkdZalppUGl1ejBlOUc1dVJqbGpGZC9iM1JmaTlYeVh5am85L3FjY2R6YmljT001Y2N2MmNZbktmM3ZDSmRCL1lUeDJkMzY3MWpUa1g3TFQ4RG4zQzYxTFIvaTZTRndMdzA3c3p5UTF2cWNkd0s3WFJkSk8vbnA3dS8xT24vYjM1UjNQbVR6TERwbzRiY2Zlem53d2lZdjZadUlqMHpmYzcxUEQvMmwvRmEzOWg5UDNxNVVOZjhBak54cGhWek5kVVJaQTE3M0dQS0hST09CanluYVRqNmJsdytZYm1HenZaWVk0eE1SNDM0Y2UveGU1ODIrUjlCMFBtTzlzZFBoL2w3ZVZSZVdVendpTHVianZ2dWZVLzhBNVhuaW1CZ0tLdHcvK3NRZnpLNlg1djhBd3g3L0FJdm5QeWV4K0NQYmw4VXU5cmZ4UmR2b3E3L0tJZjVsUHpYK0dQZjhWL0tiUDRJOXVYeFQvd0RLejhUOS93QWxYWS8vQUZpSCtaVS9OZjRZOS94WDhycy9najI1ZkZuVisxWjRvMU1Eb20wbGN4NTNPNjhEc051M1lZVS9NeCtHUGY4QUUvSzdQNEk5cy9HWHdEeTM5anJ0M3FuUWxmY2UxTGpYWFdHS1NSdHNxNFkyMUVvYUNjSVpJZ0d1ZnlhV2pIZ2NjQW1PN2pQRHNkVGU4dml2dVg5UDZRL245OHNleDAzYXpYdHcwNCtNczZFajJaWERLVzRFZ2dnN2lGeVRqTVRVdkx5dkdaaWVFdzQ2M3kzOUdZdEl3R08xWkxmbE9wMi9CS2FqSm0rbTlGS2FqSmsrRGw5UlVhaVdUNGNPR0NVMUVvY3dqNEtOUktDd0ZGUTZJajRLTGJOMGYxbzFFb2RHVkc0bERvMUZ0RG8rU0tndElSYlNRRHZVVWkzNmtXME9qQlJVT2pJVVcwRnYxb3RrV2tJdHBJQlVXMHVpNUl0b0xDTjZLbktvdGtRaFpJb1FJdEhCRnRKSE5SVXVaaHRHNUFrRGEzSDRJS0FBMkJBdzNINEtwYWtRSUh2UU1ERDRxcFpvaTJSOFNpVzAzSWhnRXFpZ09TTXFiSGlpVzBEUU55cUtEZWFKYWcza2lXcHJNVlV0VFkrYUlzTVJMVzJJcTB6T1RSc2ZKV21KeWFOaTVxcGEydEEzYjBSYll5ZDZNekxSa0o0REJWbVphc2cvc0t0TXprMlpEaHZWWW1Xall3TnlJOHUyVXhsbkhGVm1aZlpleXVuRzFsMnBtUGJqaTV1ejZWYVpuSi9UZDdJdmFIU3VqdkU2ajFwVDBUVzZvdUVqNFpLdHpRWE5pakF5c1llQUlJSitLNWVzKzV0NFJINzBUTSsyWWo2T0Q3SERwbzZmcE5tWTdkM0djc3Y0c3NZajFWamNlbVpjMEY1anJCQUlCQUlCQjFUKzdsN2xWVDNDdTlkNHk5bEt6TDIzbzVUVGFodWtKSC9TbFZCTHRpamUwbkdtamMwSEVmNHh3eEdMUTBuN3p5RHlpTm1JM2R5UHZ6MlI0UjhmcWZ0dnlIOHAvbDlQVWJzZjV1WDdNZmhpZStmVDlVY08xdzg3VzNhUDV0bFBBY1M1d0wzbmU1M01yMnVvaWNuOVBmTCtXSFQ0eGpqOU0rTHN5OXN2UmhxOVYwdDBlMDlPanA1NjU1M1k3QkEwZjMwZ1AwTHovTzkvbGRCTWQrY3hIMi9ZL0d2NzNlWmFPbnl3L0ZsR1AyejdvYzZWK2N2NVpmRi9jVDdveDluZkIvdWZyblAwNnlPd1Y5dm8zZnBmTTNHRTIrRXRHQnhJZk1IYmp1eE94ZHJvOXZYdVI2TG4yUmYyT3gwMFRjNVJOVGhqbG4vQmpPVWVxNWluVFgyazAvYWF2dGhiZTJkNlpub0txaGJCVnhPeERnNnBZWkpBTXd4QkQzbkE3d1Y5OWgwa1JzWXhQaHgrbC9YUDl1L0tkamYrWDhQTGVvaThOelowNVIzL0FINHVhdnNtSm1hbnRpWWlYT24yUmV6TmRvRFVlcTNYQUF1dE5MQlFsN2NXNW4xTCtwSEpnR243cjQya2dPY1BnVHRiOG41bHQ1YkdFNFQzNWZWSDI2b2Z5REh5OXZlUjduVTlOdmZ0WTcyaSt5NHdpN3J3eWpjeHlqakhxbWV6c1RYaHNPTFB2SzYybDBsNENhcXM5RzRpNjZtcWJYcG1rRFFDWFBxcTVrMGpRTi8zb1luallDZjRSM09pMjV6em11NlByNGZhMU8zbm50Ym1qOXJUVWR2SFhsR0ZjSW44WDA5amlONDY5cjdScnU2V0hUY0xHazIyYWpob1hFQnhiMDNNaURjWGs3SE4yYlR5eFg2TGwwZUduNzNaaFUvUkhiN1lmMDk4NWVSZEwxM2t1eHQ1MVhUWllaWXpWOE1LdU9OeldXTVRIcnFadXFkcmRKVFEwVkxIUjA0RGFlRmpZbzJnQUFOYU1vR0EyYmd2ekRQT2NwbVo3WmZ6RnVaem5sT1U5c3pieE5WWDJEUyttTGxxYXEvOG10MUxVVjBtd243dFBFNlU3QmdUc2F0Yk8zcnpqSHhtSWN2U2JFNys3aHR4KzlsRWUyYWRjT3NQZnB1dWg3L0pwM1VGb3RGUGNHQnI4cnFlN3ZCWThZdGMxMGJpMXcrQjM0amVGOVIxSGxIUmJPV25QY3lpWTlINm42TDV6NVA4c2VWYjg3SFU5WHU0YmtSRTFveW5oTVhFeE1iY3hQMFRQRzQ3WWw5dThHZmRHcGZMZlhwMFBVVzZsRTBzWmtobHRUYXlOMGVYODUwakt6ZXphQmkwN1BWZFBxZkxPbW5ieXkyZHk1eGk1aWVIRDBjSWVIMXZRK1I5UnNaNStYZFhPNW50eGVXT1dNNHpNWEVYRjQ0OWt6SGo5RGwrdm4zeHp3ZFVYUzIyVFROeHZWNWExMW5vNldvcXF0c2pTNXBoaWlkSklDMEIySXlnN01EOEZ5Yk9NNVp4RWRzekZPeDBtM2x1YnVHT0UxbE9VUkhybWVEcEUvcVJSYW83d1UxOG80MnVaV1M0U2x1VWZ0NG41WERBYnZ1Rmg5Y2NlYSt3OHh3am41UkhvK3A0djk3T25pUG1QZXkyNDRidWlmOEF4YWNZbjJ6Ri9TN24reHVuSXRKZG9OT1dDRnVWa0ZCVHVMUmhzZEt6ck9Hd0FiM0ZmTithNTZ1b3o5RTE5R1BDUHFmUSthWTQ0YitXR1A3T0ZZUjZzSWpHUGRIK3g3VXZQZEIxNStRZnZuVy9zWjNDdXVpNTdGUVRRVVZSVVJVa3o1TGc0elU4Yzc0bzVDWVlpMzd3Yml2cHMvS09sMm9pTnpkbkhLWWlhcngraDkvMTNrL2tQbHVqYjYzck05dmR5d3h5bkhsNVRWeDQ0NHpIYmZmYjVUWC9BTHpIYXFON21qVEZzT0hPUzdmekt4L0wraC8xcC9objRPamZ5bi84aG4vMnMvOEFrZmsxbjcwTFFVeHdacFMxbjR5M2IrWlQrWDlEL3JUL0FBejhDL2xQL3dDUXovN1dmL0k5TW8vY3RnOXhyeUZwdFMxRlBUMjZLd1dVME1Wb28vbVh4SHFWeGZKT1RWc2FTWENRTUlHekJvWHE5REhUN1dHamF6MVRNM1BDWSt4KzAvMm84dzhsM052ZjZQb2QvblRONTVYaGxqTmNNYSs5akVURWZhK3RlME4ybS9EKy9SK1lqT2EyVkZWR1hQd2E0R2x6bkU0Y2N6QUYxdHovQUN0bmVud3hyMnpFZlZiK1Rma3J5dWVnNnJ6S01vNDdHTTdYSHRpY3R5TVo0ZU5ZNWVwMm9yNUI3RDBIeWI3eDFYWWJzMWRPNUZ0cG9xeThVcnFhQ2pwYXB4YkZKTFVWREljSEZwYWNBMXhPdzhQcFhvZVY5RkhWYjBZVE5SeHY2SWZRL0szazJIbW5XNGJHZVU0NHpFek14MjFFVFAxMURyOC8vTUt4R3ArWGJiN01kdUdQeXQ2L0t2Vy9JZVgvQU9ybDdKLzVYc2F2ay84QSsvM2Y0TS8vQU9KeTg4RGZPZWw4eXJEVzFueUVOTldVVGVwOHpRT242RW96Z0Z2VHFHNW8zTkQyNzNISEhIWmd1bDVqNWR0YldFYm0xbnF4bWE5TVRWL3B3ZER6dnlyeS9IcDhlcTZEcU9kdFpaYVp1S25HYXZqZFR4LzNZcjB1UXE4WjhxK0orNHBjcVcyK0crdFBtV2RWMVJEUjBrTVpKYm1sbXVNREc3ZDJ3N2R1dzRZTDEvSXNOWFZZL1Q5VXZzLzdmNHhQbTIxcS9ack8vVk9HVVRIMHhOZlMvblo3cDJodnpzeHc0bGVycGZ5VHpuektvcytOUWNCc3hUU2M1N0pvclRmVnFtRERpRTBuT2RrSHM1OW82Ty85KzdSUFhRaVNtaGYxM01lQ1d1RUxETVFRUDRyU3R4bE8xaG5uSENjY1pyMXp3ajYzNlgvYS9aakxxOS9xTy9ZMmNzb20vd0I3S2NkdVBkbk0rdUx1NmR6YStRZmNQaWZucDVTVkhpZjJSZHJ5MWlMOGZxcW1PZ28zVkxPb3lQRnJwSHY2WUlMamczS0J1eEl4WHFlVmRIaHY1enpKckhHTG42b2ZVZkt2bG5TOVh2WlpkVk14czdlTnpYYlBHSWlJNGQ4eituYkhDL3g3OTR2dTczQjd3MmZSVjhyQlBRMXRReUdTQ2UyMFViWHRjN0tXaDFLNFB6WUhaZ2Q2OTZQTHVpM2J4eHh5aWFtcHY5Y3Z1c2ZML2wzcll5MnRuYTNkdmNuR2RNelBDSmlKbjhXWGh4dU94MmVMNDErT3ZnZnVkYTRwTkJlRVd0N3BVdmF5V3BncHJkQm5JR1o5Uld4TklHSkczSm1JdzVjbDZ2azJHcnFJOUVUUHVsNzN5N3VSdGIrZTdsK3p0N1c3bFBxamF6ZnpxYTJweFgxOHJtN1M1eFAycjFkTCtaT2EyMEJvWjliWHNEWThTU01OaWFXdWE3ZGZabThUYWVHNG51bGZhWWZLMjlySklpOXV3ekgvQUJZMitvemZSNnFkVHZmbDlpY3Yzcy91eDZ2M3ArejZYN0I4aGVYL0FKVG85enJzdjI5Mjl2YjlHUDhBNm1YMDhNSW4wNU95eGZMUGJldGFSN202ZjFucmJVbWpySkwxYW5UVDZTbXJuTndMUlBVTWtlV2dqaTNMbFBJZ3J1Ny9BRWVXMXRZWnorL2RlcUtldjEzbEc1MHZUYk85bi82MnFZOVVWOWQzSG9leXJwUElkUmZ2MmR1b1IzcWoxUEZIaSt0b2FkNzhXNEQ3ak9sczU0bHBPUFBGZlM3SDN1bjI1OExqMlRmMnZudjdoNFgwL1JiMC9oM052dC9CbnI3TzcvcXVxWFUrbmNMa1JsMllwcGZtTWJybFY3V0hhcUM4ZDNxM3VIWHhNZmJOSFdxdnZyUk5HWHNOWUtkOFZLQWRqUThTSE8zTWRwYnNIRWRucE5yVnVZeDZZZnFYOW8vSzQ2N3pqRExLTHgydnZmVE0xSDA4YitoMzNlT0ZnL3F6MkkwcmFTMHNjTGRCVU9hUUdrT3FXL01rRUQxZjhlYThQempkNW5VN2srbXZadyt4K2hmT1BXZm12Tk9vM1BIT1k5bkQ3SHV5ODE4MDZZdlB6M0llNm5hL3laMWJvM1RWZGN2d3lqdU5TMkkwZDZxcVdKckhTRjdXc2ppWVdnTmFRTVFkcSt3eTYzYTZlTWR1ZHFNcGpIRzUraUo4SmZwblcvM0w2THlDY09pbnkvYjNzc052YnZPWmlKbWNzTWNwdUoyOHZIeGxYaGw1MCtUUGVDOVhHK1crOVhlM1dLeGlsbXFhaWU5VmxYRk5OUFVDR0tFd3lNREhZaHpqOTdFYk55N0hSNyt4MW1mTG5aaUw3K0h3aDZIeTEvY2J5MzVqNjNEb3R6eXpid2pPTXZ2Uk9NekZSZjRNSmpzN1ltN3AzSjJpb3FxeTAwdFhYTkRLMldHT1NaalB6V3Zjd09jQnRPd0gxWHhXN2pHT1V4SFpFdnlucU1NY056TEhIc2lacjFXOGhZY0xwQjg1TkhVbmZYM0N0UzBJYmpaUHhHYWF2bGoyWVVsTThOSkxtazdYdERXQWpIYVF2ck1lbDFaNFkrR09OL3d3OW5aK1VQNTk4ejdQUlJIM01kclp5M1o3S3h4MnNKeTQrbTR3aWU2Y292c2RpUHRlMldIOEQxWHFPSmhiQVpxSzNRRU1BWUJGRTU3MnRkdTN1YnNHN1p6VDVseTA0N2VIcm42cWZxbjk1UE1jZDNQcDlyR3F4MVRYc2lPSDBTNVdyNU4rSk9PUG50NThXL3dxWlozVmRIQldQdWtjc3VGVjh5QTNJN0szQTA3WGI4RHZIQmV2MEhRN083dHpudTV6akYxSEMrNjMwbmxYUitXUjA4Ny9BSmgxRTdPT3JUaldNNVhOWFBaRTFVVTRnWDc5NUF0Rm5rY3h1bTdjOERtKzZqK0NGZHYrWDlEL0FLMC93ejhIZHY1VC93RGtNLzhBdFovOGoxK3IvZWRiWlRZNGFXdGhQckpkdjVsUDVmMFArdFA4TS9BdjVULytRei83V2Y4QXlQa1htTCs4RjFQbEw0OGFsN0NXYXhVbHNyOVFReDBzZFZiWmJpWnZ1enNreWdUUkJoRGczRGFSNmJWeVlkTjB1emVXM3VUbGxVeEVWUGZGZURqMy9NL0lPaTJkM1BvdXN6M2QvTGJ6d3h4NWVjWE81ak9IQ1p4aXBpTXA3L1JIRitGNG1kcElleWZiWXdWN1d1MXRkekJVWG1WdU94OGpoSEZUNDhvaElSNnVMdUJYditXZE5HMUVZOTg5citrLzdlZklmOUkrUzN1eEg1amRyTGNud245M0Qvd1hQMHpsUFk3eCswOWxHbk8xK25MRmtkRzZrdHREQTVqemk0T1pUTURnZlhIRmZDZGR1YTk3UEx4eW42MzhxK2Y5VitaNjdmM0x2VnVaVDdjcGV3THF2SmNGZTdmdXg5d05CNjh1T2s3QllMWFYwdEpVUzA4VDV4V2g3bXh2TFFYRVNOR09BNUw2ekh5YnBPeWR6SysvaDMreCtuZEg4djhBeS91WmNyUHF0em00OE00akdhakx2aTlGVFUrRXo2M245bGZkVzF0ckx1SGE5TWE5MHZSeFdHNVR4MFRwclMrWVR4U1RPREdQQW1rZXh3Qk8xcHdPSEhaZ2VYZitXdHZsemx0NXpjUmZIL1k5ZnJQN2I5SHVkSm52OUx2WnpPUDRvNFRVWFhaRS9UeDlUbTJ2am40MEVIOHdQdk1RMmVzOHhOZVQyVEthQjExckpHRm03RjhwZTRiemljeE9KeFhzZFpqVzVQMGUydVB2ZWY4QU11M2p0ZGR1WXg2TC93QjZjWW5ML2l0MTg2cnA4dFEvWmlNVjFhZUpHVDExOEFPNVNtNHlaUGlMZCs1R29sbStJSGVvMUVzbndINkZLYWpKaytINkNqY1N5ZkZ6SDBxTlJMTXNJK0NqVVNnc0JSVU9pSTNibEZ0bTZOR29sRG95bzFFb0xGR3JRNk1GRlE1aENMYVNBZDZpa1c0YmtXME9ZMG9xSE13VVcwRm9QeFJxMGtZS0tDQVVHYjJjZUtOSUk0RkFpT2YxcUtSR0NLU0FJQlFTUmdvMFdBUU5BdzNpVlVzMFFJR0JpZ29EQlZrd0NkeURSa1lHMDcwUzFJaGh1Ty9jcWxxQXgyQkVhTVp6M0tzckE0QkJRYmg4VVN6QXgrQ3JOcmF6SDRJaXdPQTNJTGEzZ0ZXWmxveG1IeFZZbVdqSThWV2JhQm9HNUVXMlBIYWR5TXpMU09QSGR1VlptVzBjSVZwbWNtcklSdlZZbVdqV0RnaU5HUXVjclRNNU5vNmY2VmFZbkorcFlxUXZxR25EWmpoaDlLdE1UazVCZU9scVpQcUtoWVJpVEl6NGIxV0psL1VUN1hWbFpaUERYVE1FYmNyWmc2bytKZXhtSjNuaU1GT3ZtNXdqd3hqN1orMStnOWRFWTdQVFl4M2JPUHZtY3Z0Y2hWMEhtaEFJQkFJUFdlOWQ3cU5OZG10VzZqcEpSQlZXK3kzU3RqbmZsTFkzd1VNa29lYytMY0FSanQyTG02ZUwzTVlueGo2M2Q4czI0M09wMnNaaTRuUEdQYk1QNXgrNUY0Yys0UzFlYjcwa3J4dDlDdjFQb3QyTW9mMUIwbTlweWV5ZGlaSksrKzAwT09PWjdSOVpYUHU0Vys1OHI2MnFkei90dWFhRkJwZTYzZDBZeXRpb3FPS1hHTWtPSmxtbGJnUHZqWjB6dHdCOWNObngzelYxSC9UMm83b3VmcDdIOCsvM2s4MDUzVzQ3TWZ1M2xQSHg0Unc5RlQ3ZURrMnZrSDQyNExlLzMzQ2RaZkVLMGRxcVdYSlhhMHY5RFF5c3dlYzlKU0hyeTdzRzdKSFJIYTRidmlSNlhsMkVUT1V6NFY3Wmo3TGVqMGZTUnY3ZWVNL3Z6aGhIcnp6eC93RExHWGg2M1hOMnl1aHFOZDB0TXc0UkI3UUdqWUFNVitqZFBsRzVnL3FyeURyUHkrVVJIQ0hjUjdmV2pxZXlkcDY3VlhTRGF5OFZiR05tQmFTK21vcWFPRmdPWDlXWXpiOXUzbGd2aXZtZmVqTHFJeGo5M0dINGQvZFhxSTNmTlppSys3akVUN1puNnErUGRIM3BmT1B6VjE5ZSticmFscTYzdFQyZ1k4dWxtdVZacWVzZ3hHQWpvWUEybmNXOGNYZFFiL1RianM5bnlyR3VNL2lqM1hNL1kraThoNlNON2QyY1pqOXJleG42TnZITE9mZnB2MXZ6UGJFc0Q5UmR4S09xbFpuaGdsTlU0L3E5Q04wclhjZjAydFgyUG0zVmFPanptTzNLSzl2Nm43UDgzK1l6dGVVYmtYeG1vOXZDZmRic1lYNXEvblo4aTg4dFkvMUc4UTllWGxydzJhYTJ2dGNlTGlDNTF4a2JRNERMdEp3bEp3K3ZaaXZSOG94dnFjUFJOK3ppK2krVTlqbStZN01lR1Yvdzhmc2RHUG01MnlxbjJEVFBjU2dqY1o2ZU5sbXVMMmdPR0JaMW9YT0kyakIyY1k0RWJRTm16SDZEejdaMVZ1ZlJQMlB2L3dEOGlQbGJHT2w2UHpIYmpqakViV2N4NnRXTXozOXVxTDdPTVJ3NFh6RC9BSGZ2dDNMVWR5N2hxeXBqeEZ1dHNyODVhU00wMGpJZ04rQU8zSGp1K2tmUHh1YU52UDhBeFJFZSsvc2ZnUHlubnk4ZC9MOFdPT1B0eWpML0FNanRvWG5QZGZKdk9qV0xkRGVKZXVMMFhoc2t0dmRiR1l1SUxqY0pXVU9BeTdTY0pTY1ByMllyMGZLTWRYVTRlaWI5bkY5RjhwN0hOOHgyWThNci9oNC9ZNnYvQUFWdDU3cDl5M2FjYmpKVXRyb2E2a0RXc0pJbXFHMHNqUTQvZUdPZGp1STJidUs5M0RxWXkzSjNKN0xtZlp4ZUwxTVkrY2VZYlhWWGNiZlVUblArNUV6bjlXTWZiUGZIY3RCQkZUUU1wb0doc0ViUXhqUnVEV2pBQWZRdmtzc3B5bTVjT2VVNVRNejJ5OFBWTjdpMHpwaTQ2am1HTU52cGFpdWVBQzdGc0VUcFRzR0JPN2N0YmVHdktJOFpjblRiTTd1NWpoSDcweEh0bW44N3ZtTm92Vk9zTGwvV25vU1NWTHA1b3BpR2JDNlQ5cGpzd0EyZzhGOUY1em5HZTdNeDJSdzl6WDkwODhlbzZyTGN4N01NdEgvREgyeFA2UTRzYW03WGF4WTl4WlJTay8zSlhrUHlkODcxVHAyL1dhVXR1TUw0aHd6Z2orRkI5MzlzSFVqdFArVHR1bzVIQmpMdFMxVnN4Y0J0T1Z0V0JpZDJKaEdIMWNWMy9MYzYzZlhINjM3Ui9ZVHpLT2wrWWNNSm11ZHQ1NGU3WDllSDJkN3ZpOXRQdDAyeDY2MVZxTnNlRUpoamt6dHhEZXBjWHRxTWZVL2NkOU9LN3ZudVhMMjlQNHNyOWtmcmVyOHllVXg1ZDFubU14d25mNnZWNjRqYmpPLzR0MmI5UFpYZnpEWHlyNUp4cTl5eTZPcU5HYUcwSEEvQ2U4YWxwS2lTSU16T2ZUVUVUNUpzQ1JsQUdkdU9PMzRqRmZRL0x2RGN6eS93MTdYMy93RGI3SFQxRzd1L2h3cjZabVBnNkFkZTZMdUdtdTYxOTB3NkYwQnQxenJhQXd1QUJqK1hxbnhaU0dnRFpsdzJMemM4YXltSDRCNW5zY2pxZDNicXRPZVVWNnBtSGM5N0NXaEtpeWRnYjlxaXRoTFBtcTJPbXBaWERETTBRdGZMaGp3eHlyZlVia3hzWTRmNHBuM1JFZmErODhtenkyL0s4TnVZclZ1NTUrdU5PR01UNnJqS0hQVmVhNUhHSDNQTlNDSFIvYjdRY09QemQ0MVZRMTBnMkFPcExWRStwcUc0a2pEODVwMkhIWnN4M0wzL0FKZjRaNTVmNFpqMnZzdmsvd0R5dnpHOTNZN1V4OU9VeEVmVTZMZThVVFo5UVZwTzBtYVhkL2RsZW5wZng5MUc3L21aZXVmcmZOcExXRFVZakhmeVRTNGVhOXg3ZldwdnpMQzcwVFNjMTJ4ZXlabytKMnNLdTlodXlqdDgwMmJIRDcwa2pJRzdPT0ljNWRYekhQUjA4eCtLWWoyWFB3ZnRQOXRkdWNQTHVyM2Z4NTdlRWZSR1dlWEgrSDlmZDJUTDVkOVk2OGZmcHVlcHJwcC9RK2liRFNTMUZEbnJLeXRkREdYQm5WZkZGRVhPQVA4QXZieGdNRjczbGZEYXpueG1JOWx6OXI2anltSnc2UGNuOGVlTWZ3eE0vYkRyVnNGbTdrZHN0WFV1dXRPMHRRMjhVY2pKYUthbkpqa2luYThQWkkxd0J3TFMzRUwwZG5mamF5dWNianNyMXViRHpuSHl6Y3gzWjIrWmQ0MWRmdFJNVHhxZTYrN3ZmWVA5ZS96MmRUdW1xTmJhbHAyRDlJM0dwZCtSZHpheTZiT2E1T1A2ZlEvUS9LZW02UHJjSXkvS2JlTitxZjhBeXcrY2Q1dkovd0FtKzlXbFg2YTdxYTd2RjYwckJLeXRGcnVkVk5OQVo0d1kyT3l1ZGhpQTg0SEJlbHY5THRiRzNPV0dFUk14WENQRjBmN2grV2RQNWQ4dWRiMU8zdDRiYzh1TU96ak92TEhDb3F2Ry9vdWVGdmgzNFRKVzEyVXR4eEs4S244SFJ1UHUzaTcyWG0xZnF1am9tUWw3UzltSURTU2NUdUdIRXE0NFhOUFY4bTh1M2ZNK3EyK20ydjJ0ektJajBlTXo2SWpqUG9oM3ZlTmZhS2s3SjlvTFZvdU9NTXViWTIxRndMY050UkkwRnpmOXdNRy9Rdm5mTWVxNSs1Y2ZzeHdqMWZyN1g5RGRibHRZempzN1AvUzJzWXd3OVVkL3J5bThwOU12MSs4ZmN1MDluTzExODduWHJBME5tcEpLb1J1Y0c5V1g4eUdMRTdqSkk1ckI2bGRmcHRpZDdjeHdqdmxyeXZvY3V0NmpEWng3Y3ByMVIzejlFY1hGRDJ3ZGUzN1VQZUh1RlNhcG5jN1V0emppdmR4aWZsQitiK1pKcU1XamNXU1ZEbTRjTWNDdnBmUDhzY3RuQ01ZNFl6VWVxdjFQMEg1M25EYzZMWm5iajd1M2xPRWVxdUh0akdITlJmSnZ5OTE5ZStub3B0eTA5cHJVZ2pibmRUMWRMMVAwajh2S3lUS2ZRZGJFZkVyMy9MTTcyY3NmREsvYkg2bmovT1cxTzU1UEdVY2VWdlJmb2pQR1l2Nlp3aVBZNmN0VTZjZUxvN1orbC9iWGJwK05SdU9lWHQ5OXQ2dlIvakhXM0NqakoxUHJXdnBLS21ZMlZvNmtMcXR0SEd3NXNHdHhIVng1ZzdTT0hlNkdzY29tWDlRZjJXOHZqcCtsbmZ5N2R5Wm42TWV6MzI3bUxUYnFlejJxbXRGSUEybHBZbzZhTU5HQURJbUJnQUczZ0Y4VnVaem5sT1U5c3pid2QvZG5kenl6bnR5bVo5cXJoVnN0OUJQWHlZRmtFYjVuWW5LTUdOTGppZUc1WnhpNWlHZHZEWGxHUGpOUDV3L0tQVGVwOWZkNjlTWDZTbGYxcGE2ZkhLMTJHTFg1Tm1Qd1h0K1laNnQ3S2ZUWHM0UG5QblRxT2I1cjFFK0djNC93L2QreHptOEQvRmk3OXI5QWR2dEhhaHRqNDdqcWErVzI0WDhPakRpWUpxanFCcnM0SUdXRnJjUVFSdjJiMTZYbCtYNWZETGM3NHhtWTlqN1grMlBTenNiZlVkYkg3V08zbnAraVB0bjZuYTR2a1hsUHo5V2FtdE9qTk1YSFYxK21iQlpiWlRUVjlWTktjcldSUVJtUnhKQVBBY2x2YnduUEtNWTdaYzNUYkdXL3VZN2VNWE9VeEVmUzZYYUs0dXE5UzN2dWZkZHVvZFMxY2o0bkhITTJtRWhJL094UDMzZmUzN1JndjBYcHRtTmVXZjZWSENIOUYvSkhrVWVXN2ZWK1o3a1Z1OVZuT09IQ3BqYTI1MDQveDFxOU1SakxzcjlzaXdHMmVOREwyLzhBUHZGeXJhNXJzMk9NYkMybWJzR0dHMk1yNVg1aDMrWnZ4SGhqRWZhL0ovN2c5Vk83MTBZL2h3aVBiYy9hNURyd1h3enF2OS82cHVsKzduYVYwMVF4T2twcWExdWM3SU1jSHkxRHp3Mmc0WWJEL2JYcDRUV3hqSGpsbFB1eGg1M3pWbHA2SHA4ZkhQY24zYmNSOXJxbzF6Mm8xZkpLOTBWRktlV0RTdUo4QSthNmo3WWExcEdPZWFHVU1HODVYSVBxSGcxNC93QlJkOVd5ZHo5YTB2OEEwRlozajVLS2RweXkxMzV6Q0FSZ1JFUHZuSDlJdDM3VjdIbG5UWE91ZTc2MzlPLy9BSTIvMjJqempyc3ZNK3F3dnArbW43dDltVzcyeFhkTWJjZmVuL0ZPSGJ4cm5IMnBkUHJ6dVZZTkZVcnZ2M0s1MFZDQmlCaVpaZzNlY2NOdUcxZlQ0WmNuQ2M1OEg5T2YzQTg4akhheWpIc3h1ZlpGdTcxakdSTUVjWURZMmdOYTFvd0FBMkFBQmZtVXpiK0Y1bStNdkh2TnhpdEZvcXJ0TzRNaHBZWmFoN24vQUpvYkd3dkpPSEFBTFdHT3JLSThYSnNiVTdtZU9NZDh4SHRkTy9kalRWUTdWRlhmSnNYelN2YzhPT0pjNXpqanQ1cjdybytuMTV6bFBaYjlVK1ZmbHJMcU9vbkNJKzlubE01VDY1NHZZL0ZiUzlUVitRR2dMRy9FMWxSZTZPcXFTTjdZNmVac2pnTU1kelNUdTMraTlIcnQ3bDdHYy80WmlQWS9Wdm5IZjIraTh1M05qYjdNTU12cG1wajdYYmN2ekovS0R4cnhjSXJSYUtxNnp1RElhV0dXb2U1LzVvYkd3dkpPSERBTFdHT3JLSThYTHNiVTdtZU9NZDh4SHRmeXErNFhxV1RVdmZEVTkybGYxSHpWOVhKbUp6WTR6T0kyOGRuRmV4MW1XcmR5bjB6OWI1LzVoNmpuZVlkUm40N21mczFUWHVjTnRValBVdVBxVjFua3hMOEdTblVwdU1tTDRUOFZLYmpKaytBSGNwVGNaTW54RnFqVVN5ZkVEdlVhaVdiNE1OMjVLYWpKaStJZkFxTnhMSjhZeHdPOVJxSlp1WVcvQlJxSlFXZy9GRlp1WmdvdG9jekhjalVTemMzZ1ZHNGxEbThDbzB6ZkdVVzBxS2t0eDJoRnRKR093b3FIc3dSYlFSd0tpb0lJVWFCR085QkQyWW90b0l3MkZGU1I5U2lrUmg4RVVrQWdXVkZzQnVHL2VoWm9nUU1OeCtDSmF0eXFHMXBjY0FnMGF3TkhxaVdwRU1ONGxWTFdHa296YlJyQU42cUtBSlFVQmdqS2czSGFWVXRiV2NTaUxEY2ZnaVd0ck1kMjVWbVphTmJoc0NyRXkwWkh4TzVWbFlIQUlOR013MmxWbVphc2p4Mm5jak50bVJxc1RMWnJNTjZyQzJ0SlJKbHJIRGp0TzVWaVpic2orcFZpWmJ4eEFiWGJ1UzA0NWwreHA2RXZxV2pEbGdGV1pseVc4V2JYOHpxNjJzdzI5VmcrMVZpWmYxR2VCZHVGdDhUTkd3QUFBMForUDNKWFJmZTJEYjkxZGZySisvNm9qNm42UjV0Tlo3ZVBIN3UxdHh4OUczaSt2cnF2TENBUUNBUWZOL01XNFJXdnhNN21Wa3dKWU5MWDZNWmNNYzB0c21pYnZ3Mll1R0s1K20vNm1Qcmg2bmtjZis5MmY5L0gzVEQrY2ZWOXhGVTVyQitjWlhrL0hNVjl0MFhVYU1uOURiRzlxbVgxWHhMdFQ3dHJpMzBoR0o2ck1mNzVmVDQ1UmxGdnBlZzZxcGQ2L2hucHNhZTdDV3lkelN5b3VVdFJjSkd1WTVtd3lmTHhuQjRhU0hSUk1JT0dCeDJZakFuOHg4ODMrYjFXYytIRDJQNXQrZXV1L05lYTcrWGRHV21QL0R3bjMyK3FMeVh5VHFkL2VCdTZVTnk4ZyszdmEyR1JyNmZUdHJxNy9VTUJkOXlldmxNR1YyMGpFTmlpZHVHOFlrN0FQWDZDS3d2eG42djlyNnZ5T3R1Tm0vM3QyY3ZYR0dGUjc5ejFjSEVyeCtxbTNMV01kY1Q5MkxQSWZRTWpMdDRYMWZsM1VhWnArNDlIdjNFVER2YThXN0c3VDNqdm82aGZzbWx0ZE5YeWpFT3drcm1mT3ZHTFEwYkhTbmg5SjNyNHp6UGQ1blVaNWVuNnVEOEIrYU9zbnF2TU43Y244VXg3UHUvWTk5WFFlQzZpZmRzN2xSNnE4OTZ1eng1alRhVXMxSFptdUpPWHFWV0ZjNGdIa1pIdDViK2VLOXpvbzA0WS9UUHQ0ZlkrNytXOG8ydDdZaWU3RFBMNmM4b3hqM2JjKzF5bDlvdlNoWnB1NTZxY3o3cklJNllPSS9TcUpNK3o2SWpqOFYyUE9PcHZheHc5Ti9wN1h1LzNDNnlQeSsxdFJQN1dWK3lLKzF6Ulh6YjhuY2MvY3oweHEzWC9BR0p0L2IzU0xIdW51ZDJwbjFvano0R2xwNDVIa09EZGhIVUxEOTdaczNjUjYzazFjNjVmYy9JR09FZFpsbmxNUkdPUGY0ek1mWmJpRnFyd3QxYjNBMExYYUZ1RUpaSmNJVEJISTZNdURaZ1ErSjJVZzQ1WkEwN052TGF2dmVwMk5yZHd5eG5QR0xqeGo2UGUvYy9tdnpYcFBOdktON29jODQrL2hNWHdtSXlqampQMFpSRStQRGhVOFhKWDJudkV6VVhqYjJ3dWR6MXJSUG90UzNaME1FY2RRTXNncDRNenNjQ01RSE9jQ09lR1BKZm0zVVRFUkVkL2Uva255N3k2T2o2ZUl5NGJ1VXpPVVhjUkVjTVlxT0YvdFRQYndtT3pqRGxvdXE3VGhwNzJ2YzZEUmZqSmF0Snh5WkxuZkxzSkdOKy85NkNocFpKSC9takxza2tpM240RGlQUjh0blRsbGw0UStvK1d0NmVteDZucWV6bDdPVXg2NjRmVit0eE45bVRURlJxVHlNdDlZR2wxTlNObXJaU0NRQTJDTnoyay93REdaVnFOM1R0NWVwOEw4cWRYT0Vic2Y0Sjk4eGo5VXUzMWVZOUo0dDlzOUxxR3kxZGhyaTRVTmJESlNUR01nUDZjckN4d0JJT0J3Slc5dlBSbEV4M09mcHQrZGpjeDNJcVp4bUppK3k0NHZqbDA5dnJ4cnZWUExTWFMyenkwOHp1bzlwbWFOdU9Pd3RZRjJNdXR6eXU2bTVjZlU1UjFNN2s3c1Jsek1weW01bnRtYjRWTWNQQitMTDdXL2g1TWNaTERNU2VkU2Y4QUJXUHpIb2ozL0Y1MzhxNlQvU2oyNS84QU02OVBlLzhBYjU4WisyRlBvdlRuYVdncXFIWDJvMjMydW1tZk02YUdPbnROdkVyR2htVnY1ODBqY1R0T0RjQmdTRjNlajJ1ZkdYZFQ2THlYNUQyUE9OdmQ1Y1JobGhqTXhXcWJuVGxNUnh5bnZpTzdqMk9zanhIcVJwM3Z4cEM5Ym9vTHRRbVVodVk5SjFRMWttQTU1Q2NFNmJMVHVZejZYd2Z5VDVoK1I4NDZUZTdzZDdDL1ZPVVJQdW1YOUszZ2RhakQyOHU5N2Qveml2YlJNMi9vVVZKR3pZT0gzM3UrSzdIekJ1NnQ2dkNIN1ovY3JxK2Ixc1krRVRQMHpNL1pFUHVhOEorZHZobmszMk0xQjNtN3g2SHVjVWIyNmEwekJkS3lXY01MbUdldFl5QU1HVnBPWUNNTy9nOWZaOHE2ckRZaktjcDdYMnZ5MzVsdGRIMHU5T1dVYXM4c1lydnFMbS9WeHAxLzk2L2FBNzI2czhnTlQ2cTB4WlpwOU5YUzZWVjBocVNXUnRlMnFtTTdqKzFlSGZuUFA1RndiMldPV2N6RXhVejR3L0x2T3ZJK3A2cnE5M2V3akhUbm5PVWZmdzc1dnMxWDduWXI0UStPMVI0eDlocUx0dmNHeHR2SmxmVzFnaEljQkpJeGtlQmNDUVRnekhaczJycWRSbkdVeFhaRVBlNVdHemhodFlUY1lZeEZ4ZFRQYk0xUFpjL0Y5ZVhBeTRDKzVWM1V0TjU4eGRGZHRLQ3JZK3UwZllibnFDdWlqYzV6b1pycTVsQ3lPUVloclNZaTE0M25BakVZWUZmUmVTNHpHTXo0L1krdTZIS2VtOHAzYzVqL0FLdWVPUDBZOGZydUhVcDNiZDgzcTY1dnd4RHFxb1AxeXVYclUvamp6RGMvejl6L0FIcCt1WHBRdHVNdU9HeEtkUG1QYTlGMC9SbllRT1NsTHpIYVg3SGZkS3d4NjcxTjJxdVVzY1dvNnkwVWwwdGtVaHdmTkRTMVVzVTRqMmJTREkwa1k0NERIQWdFangvT0luVEhvbC9SWHlEc3hQeTdHZU1mL3dDalBWOU9HRVJmczRkM3Rka2k4QjdUMXJ1VDJlN2JkM2JleTJkeExWRmNxV0lneGw3cElwRzRITmdKSVhNZmhqd3h3WE50YitlMyt6TG4yK3AzTnVLeG5oZC9TOU1rOEcvRmFWb2EvU01KQUljUDZYY2Q0QkgrL3dEcXVTZXQzSjcvQUttZC9leTNxMXpkVGNldDRPby9BYnhoMUJhWmJWRnA4VUxaR2xvbHBwcFh1YWVmOUpNZyt4YzJ6NW51N2VWOEpmUmVXL052V2RIVVl6RTR4M1RId3FYVS93Q2ZYaTAzeC83cDNYUmxLeitpTmxhNkI0R0RaSUpHaWFOd09BRzFyaGpodU9JNEw3VFByc2VwMk1jc2UvdDlFdzcvQVBldjVvdzMvbERhNWMxTy92NDQ1UmZab3h5eXlpZlZsR1B1bjBUeDgwOW9lU291VFc1TVNUc0dHMWRDbjhXY3gyVGUwMzR6MDF4MWt6V0YzaGE2M1dKa1Z4bWE0YjZtUWtVakNENnRkSi91UnpYbmVZOVJ5OEtqdGwrMi93QnRmTFB5dlM3blg1Ujk3Y3ZiMi9WLzZtVWU3Q0o5T1Rzalh6YjdCeFY5eFB1Ujg5ZnROZGxhT1pwc0ZLMmJYZXRJdDRGc3RUZyttaGs0Wlo1bXVCQi9WQlh0ZVQ3ZkdjNTd2MGw5WjVCWFRiRzd2eiszbC9sNGY3MlhiTWVxUHRoeDU5cWJ1SkxXK1cxYkhYemdWMTlvTGlIaHhPTXN1Y1ZyZ01Edi9aRjIza3VUcnN0V3pNZUUyN25VOVZIVWVXYjJFZjhBcDdzVDZvbUloMllMd1h3N2l4N3Qrai82eGVOMUxkV01MMzBOd0VUOHJRY3NWVFN5Z3VKM2o5b3hnK2xlbjVYbldjeDR3NlhubTN6Zkt1cnc3NHh4empqMzQ1NDMvd0FNNU9sWFZ1bUFMdklBM2M0ajdWN2xQd0dOeDJQZUxHbXBLQys5bWUzZEtNSzZudTluckpHZzV5WTdWU3VtbU8wRFlEZ1NSaGh5NEoxazZObkwweFQreHZsK0k2VHltY0ovZDJOUDB6akVPek5mSVBoR054b0thNlcrZTJWcmMxSFV4dmdsYmpoaXlScFk0WWowSzFqbE9NeE1kemsyZDNMYXpqUEh0eG1KajF3K1FTZUFQaWhQY25YV28wckZKV1BmMW5HU2VvY0M4dXpFa0YrM0U4OWk1cDZuS1p1YTlqcmIyeHRidTVsdVo0WXpPVXpNOE8rZU15K20wMmdkSTB0enByekZSTU4wbzg0cFpuRnpqRUpCbE9VRTRmbTdNY01jRmMrcjNNc2RNendlaHQ5YnViZXpPemhPbmJtb3FJaUk0ZnBmcmZxMUVwZ2dmTTFqcEN4cGNJNDhDNTJBeHdiaVFNVHcycnJ4RHJZNDNNUjJPdmYzUi9KcnZ6cUd4MVBaNnkyS3Awdm9LVEsrdWtyYzN6VnlaMVdpSU9MRzVHTURoamtZNTJiREhOZ01GN1hSYk9HM2xjVEdXWG83SWU3MW5tUFNlUmJNVHRia2IzV2J2M2R1TWV6Q2N1R3FlKzQ3b21JbWV5dTl3NXVkN0Q3OUZSeEgraVVqV3h0R0d6TEUzQWJQb1gyUFVaOG5hcnZsL1Nubm5VWTRSanM0VDl6YnhqR1BWRVZEdCs4SnRPeGFYOFZORVc2TEtUTGJZNjk3bVk3WFZqM1ZaeEoya2pxWWY3Qy9QdXV6MTd1VXY1cithT3A1L1g3dVhwcjJSRWZZK3BycVBBZkwrOFBpQjJUNzY2a2JxdnVOUlRWZDJaRzJCaFpPV05heGd3QUFBSzU4ZW9tTVl4cU9DZFZ0N2ZVNDRZN3VFWlJoZGRzZHMzUFpNUFRhajJ5ZkU2b1AzclRVZ2JzQlVnLy9BS1RDazc4K0VlLzR2T3o4bjZXWjRZVjlPWDJ6TDhiVi90ZWVGMUZwcXZ1dDh0RlFMWFNVODFYVU9kVk5hQkhER1pIRXU2WndBQTVLNGIwek1SVU45UDVGMDJlY1k2THVhN2N1L3dCVXc2bnRSVDJQU09ucWEyV0pqWWFKelgxREdOYUc3S2lWMDJPemYrZHY0cjc3cE5tSmpHSTdJaC9mZnliaHNlUi9MbXhzN0VhY0pqTEtQVmxsT1VYNDhKN2UvdGZVZmJVdGY5Yy9NTFFsRks0Wlk3bCtKak5qdnQ3RFZqODNiaVN6QUxnODkzb3cycHhqdy9VL0l2bmJ6U2N1bDNzcDc4WmoyOFB0ZDFhK0FmemcvQzdvVWR5dVBiZS8yMnp4dWx1MVZiNnlscG1Sak00eVRRT2piZ01EaVFUamd1YnA1aU56R1o3TGg2UGxHV0dQVmJVNXpXTVo0ek0raUp0d3oxWjRYYXp2Ti9ucUtXM1Zab0FUMGMxTE5nVHp3eTRMOUIyZk1Pa3h3aU9aRDk1K1gvbTN5L3kzYTRaNDY4dTJiajR2YnZGL3dmMVZvUHZkYWU1Mm9BYWUyV1dPb2xZSlJsZkxOVXd1aERHdE8wWUFna2tlbS9kNFhuWG1tM3U0emhoTnZrUG0zNXQ2ZnFlbXoyOXZMVmxuTVI2SWlKaWIreVBiMk9YYStWZmtqNTc1WTl3N1YycThhZGNhOHZNN2Flam9iUFd0YkxJY0dpYW9pTk5BTnhIM3BaR2dZakRFcm42V0wzTWZYOVQwdko0LzkxdHpQWmpsR1Urckg3MCs2SmZ5aitSdXNHNmoxWmNMa0hZbWFWNzltN2E0bGQyZUw4MnozSnp5bktlK1h3QytnU3p1SjM0cVVSay9Ka2lMVGdWbHlSTEY4WU85UnFKWVNSYzkvTlNtNGxrNW5BNzFISkVzSklzTm8zY2xHNGxrNXYxS05XemtpQlJxSll2WndjbzNFc1h4a2I5eWpUTnpNTm8zS05SS0NBZDZOTTNzSVJiWnVaajhWR29sbTV1R3dxTnhLU01QZ28wemZIanRDQ0NNRkdpTGNmaWkya2pnVVZENCtJM0lNeU9CVWFTVzRmQkZzbEZTNWdLTGJNdEkrQ0tramtpa1J5VVVrQWdFQWdlOUJTcklRYXNHRFVTVklodEhGVkpVQmlVU1dyQU1NVldWQVluQkJXNUdWTkhGVkpXMW8zbmVpTGFNZHBSSmFNYmo4RldabG8xdkFibFdKbG94Z0F4S3JLd0NkZ1FhTVlCOFZXSmxySEh4TzlHWmx0SEd0TVRMVnJRMzRveXRyTWZpcWt5M2poNGxWaVpieHhxdU9aYnh4WmRwM3FzVExWa1pjY0J2VlltWHNHazZKNzZwbUE0aFdtSnljc1BEMnhQcU5jMjF1WFoxR0hIL0FIUVZjY3kvcUE4VUtGMXU4Y2RIMGo4UVJib25nRVliSkNaQnY5RHY0cnA5VC8xSmZwUG1tVjcrVmQxUjdJaUgwSmNEendnRUFnRUh4ajNFcjEvVi93QUh1NTl5ek1iL0FOQTFsUGpLY0IvU1dpbXdHMGJUbndIcmd1ZnBZdmN4OWIwZktNdFBVN2MrR1Z2NXdidmVTNjRRc2M3RnBjL0Q2WGxmUjRaVkw5YThzODNqTGV5eHY5S2NwL0F5eWZQNnpwN2t5TXlDRXRmbFkwdWNjTnVBSEVyNkxvK3NyR2I3b2ZhZm5JMmR2TGNuc3hpWjlrVzc1TzNHbHhvbnQ5WTlIN005cm9LU2dlNXJRM00rQ0JzYm5ZQnp0cGNDVDk0L0U3MStiYm1lcktaOFpmekp2YnVXN25PZVhibE16UHJuakw5cFljYitmcjNVdTdUdTZQbmQzSTFGREoxS0MzWEIrbktSd2VYc3kycHJiYS9JY0dqQnpxY08yRGp2TzgrM3NmY3h4ajBmVzdmVythUnNaOVB0eCs3aE0veFRjL1ZEMXJ3NXQxeDExcnkxZHVMVzV6TDlxYXRoMDdSeU5Ec1dTM0Y3YVJyOFJnQUdtVE1TZGdBeEs3czd2THhtZlEvVXVsOCswZEJ1WnhQR01acjE5a2UrbjlFMUhTUVVGSkZRMG95MHNMR3hSdEpjNGhyRzVRTVhFazdCdkpYeTh6YjhpbWJhSVA1LysrL2MxdmR6eVcxbDNCcDNab0w1ZnE2cHBUc0g5R2RWUGZDTUdPYzNZMStHd240bGUvdGZkKzc0UkQwcDgzNVhYNDR4UDdHR0dQc2kvcm1YYng3WStsdndIeGxwTHBJd05udU5SSTlyOEc0dWloWTJFQWtiZGp3L2Yvc256L01NN3ppUENIcC9NL21QNXJleHFlR09NUjlQYlAyT1JDNkQ1b0lCQUlQamZmNzNCZkRmeG50VTlmM2E3Z1dtbHVVTWJwVzJhZ3FXWEM2UzRQTVlheWlvakpOOTU0TGN6bWhvSU9KQUJJNXR2cDg4K3lIUHRkTm51VHdoMDJlYy9uVjNDODZPNk1mY3E0VUVsazdXMHNab2RJMldaK2Q4ZEtYWm56eU9hR2gwa3p4bWNRTU1BR2pFTkJQZnl4amF4MFIyejJ1djh5ZWViUFNkSmwwT3pPclBPWW5PZkNwdUkrcjZMdnRjMnZZazdmbUtmVVd1cEc3S2VoaG93Y1hENzFYTUpBY0FNTjBMdDUrdmgxZDNoaDY1K3A1SHkvdHhqMCtXVmNjc3EraUl1ZmZNZXgyT3JxUFlmQWZjUDgwS3Z3ajdSMjN1SmFyWEJlTHJjTGtMY0tPc2xmRXdRTnBaYWlTUUdMRjVJTEdEQUREYjhGMk9uMlkzSm01cUloMitrMnRyTFZPN2xweHhpNW50Y0I3OSs4MDZvczczTlpvRzFQdzNFMWxlUDRHTHMvbGR2OFNmblBLZjllZjRjdmc5YXIvM3FMV3RMc2k3YzJkeDRZMTF3L20xUHl1MytJL09lVS82OC93NWZCOFc3amU1anEvM0hQSU9nN3BhbnN0SHArZzB2WkhXT2l0OXZubG5hNmFxcitzK28vcE9EZzUwWnlISzNjQmlkdUM5dnlYWndqS1lpYjRXL1UvN1hlYWRIK2I1ZXh1YXBqNzAzRXhQZEhmRWZwTDUxMmM4RXZuZTVyZmxiLzhBTFVvcTNTeFJ4MjhucFI5UXZhR2tWQU94dUdDNHN2SzZtZnZlNzliK1RmbS9yOC9LUE9PcDZPTnFwMnQ3UEdLbXVFWlRwbU9IQ0ppcGowTy8zdzdzdFpaUEd6U291UVA0bFhVcnJ2TzRqRE82NFRQckE3REU0WXRrR3orSGV2RDYzY25QZHltZkYreitiOVpuMVhVWmJtYzNNMWZycmo3MzB4ZFY1cjBtUHlRN0ZTZDBuZGtocWloSGRkaitpNnhQa0xLb1NHTHJodVZ3QXhMTm8yN2VDNWVUbHAxVndjdkl6MDZxNFBkbHhPSjR0N3ZGdjA3WmF6VUYyYzVscm9ZSmF5cGZGSExNOXNVTVprZVd4d3RkSThob09EV3RKTzRBbFdJdWFYR0xtb2NFUExYMzRlekhhZXkxMW04ZjdSVTZuMTgxajIwZGZkcWVTa3RFY3JaZ3dHU056NDZxUnBZSE93QVoraU1jU2N2b2JmbDJVL3RjSHZkQjVIbHZaUnFuaDRSMi9CMXg5a2ZJWFczZUh5SDFQM1c3bVhFM0h1QnFLbm5yYnBXT3lzWU1KWXNqR01ZQXhyR05BYUFBQUFBTndDK2k2SGJqSGhENmY1dzJNZWw4cXhpT0VZNXg5VS9wYjVYcXFvTjN2TlZYc0dXT2FhU1VOR09BRDNsMkczYnhYWnAvQjNWZFJHNXU1WlIyVE16N1pmblU5dGUrUWJOcFNuQnpIdGVrckJQTE0wTmFTY1JodlNqbUgzTzFsM0s3Uzl3N0pxUHQ1VjFsdDFaUVUwYzlMWDIyYVdscUtkenBwUmpITFRscjJ1dzQ0NDdlUzh6cTVySi9RdjhBYm56dmM4dTh0eG1JakxEUExMVmpQWlBINitEN2pvbjNzZmNLMHBab3JYVzZtZlhVc0xHUlJTWE8xV3FwbUFZQ01YVHZnYks4bmk2UnppZWE4NmRqYW51ZmR6OHllVlo4Y3RqUEdmUlBELzhBVkgxUFk3Vjc0L201ZHBteXpYOWtiMnVBQWl0Rm9FYnRoeERtdWlPL0VjVk9SdGVEam56L0FNcW4vd0JMY2lQUlYrL0oyWCsybjVVOXkvSzdzalU2djdvMGtFZCtvS2xsR3l2bzR1Z3lyWTZuYkppK01PYzBTQTdYRm1EY0hEQm93T1BTNnJheHdtTlBldlV6c1o0NGJteGVuS0xyTHRqalg2ZHZyY2kxMVhVZFd2dXVUalZua1JjU3lSOGxKVE5nb29tUGRHNXJUVDA3R1NaTWd4QTZ1Y0VPSjJqaHVYMS9sMkducDhQVGMrLzlUNUwrOFBWeGg1WjVic1JseG1kL2NtUFhsaGhqUFpjZnNaZC9HYjRlUEhidGwyNXA1N3NLK3FaL1FhZjl0TGdOcERUc2FQVW5ZUFZkbkxoRnZ4RHl6bzl6cnVvdzJNUDJzNWlQVjZmVkVjWjlEdUQ4UU95Nyt5ZlpPM1dTNlFpTFdGeEF1dDZHR0JaVVR0R1dEYnRBaGpEWThNY01RU042K1I2dmY1dWN6M1A2Z3l4dzJzTU5uYTRiZTFqR09QcWp0bjE1VGN6NjMwcTRWOUZhcUNlNlhHUnNOdnBvMzFFODBod2F5T05wZTV6anlBR0pYV2lMWWlMZGJIZVQrdm11dEFkd2ZKdXFwWi9tKzRkd2RhTlB4U3RlSFFXU2lxSDB0UEdXdUp3YytHRjVkaHNPd2hmVWROaEczdFRGOGYwdDcyNTFuK1p0N01mczdPTTVUNmNwajR6RDVuN2VsSnEvUkhtZm82NlZkTStDam1xcHFDUjhqSEZ1RlhUeVVwSDBpVEFIaHZYbmJzNnNjNGVINUQ1anIyK3IyNS9lMHo3Sm45VHQ1WGpzUGozbnZZSWIvd0NKMnJXeTVXeVVNTk5kR1BreHdiOG5XUlR2d3k4WFJ0YzM2VjJ1aXkwN3NHZUhNMjl6Yi9IdDU0L3hZekgxemJwZzFCb1A4UjdnUjJRdDIxRlhIVGJqL3dDTWxEUDBkdkhndnFZeHQvT2ZRYlhQMzl2Yi9GbEVlMmFjL1BEcTN5YWk4MGRKVVFHTlBZTE5kNzlLd3VibC9wWU51WWNwR0pJY05uMmNWMVBPY3F3cC9XblZkYlhTNTQ5K1ZleUhZSXZsM3k3NFY3a1BlalVuWVh4SDFGci9BRWJjSFd6VnJIMFZQYjZ1SWdTaDc2cGozaVBNQ01URXgrOGJzVjJPbHdqTFBqMk8zMFc3dDdXYzU3bU9ySEhIS1pqeHFKZFFsUjd3SG1jMnNkVFJhNnVwT09VZmZwOStQL0JydjZkdjhMZjlZZVhmL2ErK0haSDdYUGtsNUo5enRSWG50dDVDM0tPNzFjTm9vTlMwVlE5a1lxNlZ0VjAyaW5sZEV5TUU1SGh4RGdTRHhPSzRlczJNY2NZeWlLY3ZWZFQwdlY3T085c1lUaGN6RXhQbzcrOXpOWG5QTWNiUGRRWmJCNHlSMU5jd3Vxbzd4US9LdWFCOTE1am16WThjTWdkOU9DOWJ5V0p5NmpHSHIrUStYWWRiMW16aGwrN25obkU5OFRobEdWeDlFVEhxbVhVOTg2WDNhUWIzeU95ZnlqOG45dGZRK1liL0FETTZmdEh6QjVuR3pqY3p4bVhlN29EVGJOSGFFc21rSXhoSGFxQ2p0clJnMGJLYW5aQ05qUHUvbzhOaStLenkxVE12d2JxTjJkM2N5em52bVo5c3YxMWx3dXVIeWc5OWkrZVB2ZDNVbmJlaDBsYnEraHNkeHJiWkRVelZOWXg4ckthb2RDMTdneGhBTGcwRWpndlF4NlhDb3ZMaTdtZTk1ZHRWanViMHhuVVhHbVpxNHZ0aUpmRjd0KzlCYXN0enl4bmI2MHVJNTF0d0gvMEUvSzdmNG1menZsWCt2UDhBRGw4SHFIY2o5NWU3cjkxdTMrb08yV251M3RycGErL1d5NFdkbGZCV1ZqNUtYNXVrZlQ5ZHJKV1pDWTgyWUIyd2tZRmIyK20yNHlpWXk3M0xzZVkrVjdXZU9lTzlNempNVEVhY3VOY2EvWjczR0xVT3VxcTV6d1VrOGhlNkdPS0J4SjJucHNET0d6Z3YwTEdJMk52ajIwL3JQekhyTXRycDlycDcvd0NuaGpqL0FBNHhIMk9hWHNnMk9iVW5tREJjNDhIUVdPeVhDNHZKYVhZR2ZDaDJIRDdwL2JEYjlIRmZHK2I3MnZHWjhaZmlIejE1bEdpZG1PK3ZydjdIY0F2bkg1WS9FN2dkeHREOXE5TlM2eDdpWE9HMGFYZ2N5T1d0ckhGc1RYUE9EUVNBZDVXc01Kem1vNHQ0WVRuTlFmYi9BTGphRDdxNllnMW4yM3U5TGU5SzFCYzJLdXRzekpvaTVod2N3bGgyT2FkN1RnUnhDWjRUak5Ud004SndtcDdYN1N5dytWZVNubVQyVjhWYUNPcDdveTF6cStlTXpVdERiS0NlZVdkb0R2OEFGeVBES2ZITTNMZ1pRUVNNY0J0WFkyZW15M09NZGpzN0hTNWJzWEZSRWQ4eTZmOEEzZjhBM1pPNHZrZFlZKzFtbGFPWFMvYWg0anEvd21WN0hWdFk1MElQV3JYTWRzWUM0OUpnR0JCekhFNWNPN3Q3TWJVZU15NmZtWG5XeDBlem5zN0V4bnVaeE9PV1hkamoyVEVlbWV5ZlE2bGRlWGVTcnFYa3V4SkoyODBmQ1JMMFd0L2FPT0tqY1M4T1dMWmc3Y28zRXZHbGhMZmh6VWNrU3hmSHdVYmlXTWtXejBVYmlXRDJZYkQ5YXk1SWxsSkZqdEc5UnFKWXViaDhVYmlXYjR3UW9yRjhlR3c3bEc0bGkrUERhTnlqYko3T0lVYWlVRWNDalNIc1FadWJqc0tqVVN6YzNEWW81SWxCR0JVYVE5Z0l4NG9NeU1EZ28wUkdJUVNqU0h0SDBJTS9SUnBKR0JScUNVRXZIMm9zTWtVanNPS2lrUmdjRVVrQWdFRk5IRkVrMVVVd1l1UWFveUVGQVlEQlZsYkI5cUpMVlZEYU9LSktrUlFHT3hWbG9nc0RncXkwWU1BcXhMUmd4MktzeTBSRnhqaWpNdFl4aTVWbHZHTVQ2S3NUTFpnNHFzS2FOcUpMYUZ2RlZpWGtSakVyVEV5M2lic3pjVlhITFZneCtKVlpsNTlCU09sSURRcTQ1bDc5Miswdk5WVlRBMXZFWXF1SnpyOEIreFdvZFU2MnR6N1pTUGxlNlNOa2JZMk9jWE9MZ0FBQU1TdFExdDQ2czRqMHY2TyswK202clIvYkRUMmxxNFphKzMyNmpwYWhwSU9XV09uYTE0eEhBT3hDODdleTFaelBwZmQ3dWV2S2N2RjdBdU5nSUJBSUJCeHY5M2E4d1dIMjV1NTl4cUFUSDhsUVU0eVlZNXFpODBsTzA3U05nYzhZK2k3UFIvOEFVaHliVzd5c295OEg4NE4xdkxIM2FGb2Q5NFluNnppdmF4M0xtWWNubHZuczRkWGx4NzNZMzdNdW1mNjM5MXRQMC9URW5VdUZOSTlqODJEb3FWcnF5VWZjQlA4QWk0bmVuTWdiVnZlNmlkdmJ5OGErdCtxZVovTVBLOHV5eXgvYXlyR08zdjdlendpNThIZG12bVg1Ry9EN242OXRYYXZ0cnFIdWZmV3VmWk5OMnl2djFZeUxFdmRCYjZWOVhJRzRBN1MxaHcyS3hGelRPV1dtSm53ZnlvNjc4aWEvVnJxeldXb0pIVFgrODFOVmM2eVo3WHZjK2FvbWM5N2k2UjduSEZ4SnhjU2VaWHFaNS9lOVQ0N3J1dG5kM3RYaFVPVVhzUDBzM2YzM0l0QzJpYUhyYWUwMDI1Nnh1QXdZektMZlFsbEkvd0RhUHhPV3RrZ09EV3VQb0JpNGI2bmQvd0FwOVowSG11VzUwL0s4WmkvVkhINjZmMFVMeDNPK2QrWEhjNkRzejR3Njk3bXl5OUdlMDJPNFRVa2h5SCtsdnAzUTBvL2FCemRzNzJEYUR2M0hjdVRhaThvaHg3MjVHM2pPVTl6b0I3YU9mZU5lV3VrRzEwa2paU0R5ZTdQdCt0ZWpHNTkrWmZINTlaT1cvT2ZwZjBDK0x1bFdhTThlTkhXQm95dWJiS2Fxa2JpMDRTVmJQbTVCaTBBZm5TSDhwM3J6OS9QVm5NdnNzTTV6aU1wNzN2cTRtblJ2N3Yza1JmOEFVZm1sM0JoMDVlcXltcyttbjBOaWlocGFtZU5yWFV0STJLb0dWMkdHRTRlZnVqQTd4anZQdDlOaE1iRTVSSFk1SXczOHVpNmpxTm1wNUU0M0hvbTc3NDdPSHc3NDRMMy9BTWg5ZU1uY0dha3VZK0ZiTCtWY1A1ckx3aDhmL1ZIVWVHUHNuNHZXYngzanZsN2xFOTR1MVhWemhvWUgxTlE2UndhQ1RsQmRpY01UdVYvTlplaEorWitwbnMweDlFL0Z2b3ZXVnNON2dyYWlNVHpzZUhmMGc5UUFnL3F1eEh3MkxHWFVaNWQ3cGRUNTcxZTlFeE9jeEhvNGZWeGNzN3JTZjZTdEpXclUwSDM1L3V3eW5lZlJjVXZBMjVxYWR1ZnRGZHZQNm1lTkUxM2xpTWRWZEs5eldsd2VNOE5MQXlOcEdiN3BIVWRJTVFQcDREZzM4dXlINkQ1RmY1ZVBYTGxTdUI3RHJJL2VEZGNDdnUrZysxVkc4T3FhV2h1ZC9xb0EwRTVLdVdPa2djU2VHTlBJQU1QcjRkM3A1ckRMMHZJODM2emw3YzRSKzlIMnVsN1dta2JzK3BsYmtmZ00yVTVUdElWdDhicWVnM2JTVjZZUzdwTzJlaFMwMXZwdmgrKzRXSHVYOG5PQ3lPc2hjdzVnUnRqY0pCL0F2VThtM2RQVVkrbTQvVDZYNkwvYTN6TDh0NXp0UmRSbkU0ejlNWEh2aUhZLzJXc2NqNWFpNzBZL3BVdEkxc09YRFpOT0JTczRqRDc3Z2NTdmI2My9BQzlVdkIvdmg1SkhUZk9tT2NSOTNxTWRyZHJoM1JweTl1VzNsTTNVM005MU81elRGa2gwMXBxM2FjcHYvSjdmVFFVVWUwdSs3QkUySWJUZ1RzQytEeW01dDlHODVRZEtkeDdxM3dlV0dwZkpiU2s1RitpMUJmdFQyMXhZWWdhZTJYS0NZTU9YRTVUVEdWcm11eEJBd0lPOWZRWTQzdFZQZzNIV1gwZVdmaGxYMGY3WGNwMjkxeFllNW1oYlIzQzB2S0p0UDNxanA3bFNTTk9QN09vakVnQjNFT2JqZ1FSaUNDRHRYZ1pZMU5PSERPTThZbU95WDZ0UlQwOVpUeVVsWEcyV2xsYTZPV0tSb2N4N0hESzVybXUyRUViQ0NvMjZHUGR0OGJhenh3NytYYlR0SkdXNllyQ2J2WnBNQUErZ3FwSEdNRERERXh1RG9uSEFETTA0Yk1GOUIwKzl6TVludmZvdnl6MWNibTNHTXo5NlBqWCszMXVNWGpWZUttMjYvdWtnY1E0MjJzRGNPTGcwWmQvcXZXNlR0Y1A5Mk4vay9MKzduMzR6SDJ3OWtucENYYldydFUvZ0xXOG0wMi9xVEFGdXhLTmI2OTJiMHhTVFhObFZVeGcwOU8xMVJJTXBQM1ltbVE3QnYyQlRMaEZ1YnA4ZWJ1WTRmaW1JOXN1MWZRM3RzZU0vY3p0aHBQVlBjdXh1ZnJhZXpXNlc0dm81WDA4ZlhscG16eUFNY0NSZzl4QXgyNEw1RGY2L1BMS2V4L1QzbDNrdXowM1Q0N09GNlk0eHg0OFp2dzlMOHZ2SDdXZmhUcGp0WHFQVjAxaHJITXM5c3JydDA0cTE3Qy81T2xmVVpjd2pjUmprdzJBcml4Nm5LWmlPRGszUEs5ckhHWjQ4SWRNanRCWHFEVVV0TFMwYjJ3T21jWTJCcnNHZ3UyRGJ0MkJkMlh6bWRYTmRqdkE5cDN0MU4yLzhOYkpMV1JtT3Z2RlJWWE9ScjI1WEFOY0tKZ09KSnd3Z3hHd2I5M0U5RHFzcnk5VVBydWh5dlp4OVRrb3VzN2JwMjd3NjJmM2IxeGVOY09xUlZVTjF1dDVycUFNRVFZeWttdTlRNkFNRVFHQU1lRHZ2RnppVHRQQWZaOUZFOHJHSDRIL2NIem5jNjNyb3h5bThkckNNY1k4SXVjcDkrVXZzdmdQMklpN2dkNnJQQlhRZFhUTmhhTlRYc0VmY0w0M1piZEE0N1FjODRNam1FYldzOVYwdk5lbzBZNlk3WmUxL2JYeStjdHpQcUpqc2lvKzM3STlyc2tYekw5aVkzQzMwTjJvSjdWYzRtVkZ0cVkzMDlSQkswT1pKRkkwc2V4elRzSUxTUVFyRTFOd1B3Nmp0SjJ6cTdkRFo2cXgwa2xvcHdCVDBza1RYUXhBREFaR0g3cmRtellGeVJ2Wnh4dHZtWmNlTThXRkQyUTdQV3k0d1hlM2FadHNGMHBaR1ZGTlVSVWtMWkk1WTNCN1h0Y0c0Z2dqRUZUbTVlTThYRnQ0UmhlbmhiMmxjYlQxN3UxcGVIVy9helVtanA0VFVSM1cxMTl2NkRNTXp6VVVyNGdHazduWW5ZZUJXOXZMVGxFcE16RWNIVGpwbXpSWGZ1aGFMbzhZOVZyTGc0a2pFT0ZQMXRwSEhOc0srMTZmNzB4TDhSK1hlbS84QSt4amhIWmpuTS93M01mVkRtbjdaZHJndlhrZjNLMVV6STUxaXRWazA4MThiUmpoWEY5d2VIT0p4eERvOFB1N09lMEw1L3dBMjN0V1ZlbCs0YjNVYTkyY083R0k5N200dkhSd1U5Ky9XdFRadkdiVDJqS2N2QXZGMmtxWGxoQWFXMFZLNW1WM0U0bW9CSERaOEYyK2s0WFBvZWQ1bjFFN2UzTVIrOXdkVVhpbDJMcSs2bmZpM1V0eGdjN1N0cmNiM2QzWkM1dnkxSCsyeU8vdTNBTitsZWgwKzF6TTRoOHZ0YldXN25qaGoyNVRFUjlMdDc5cUsxVnQ2MWYzWDduWEdOelJVVjl0c2RMaTNCalJRMHp1cXhoZGljQml6WU1CL2E0L045eUp6MHgyUSs2ejA0Wnp0WWZzN2RZeDlFY2ZlNW1yeUVjTC9BSG90YndXSHRUbzNURDNsczFiYzYyNTRabTRGbERiM1U3c1duZjhBZXEyN2NObjByMWZLTXRPNU9YaEQ2WDVQbWY1anQraU1wbjFSRmZYTU91bnhrb0lPNC9rZG96U0x3WklicnFDMDBEMnRMZ1JISldzenV4YUNRQTBFazRiQXU1MUc3VVRMWHpwNTV6TitOdkdlOTN6TDU1OHd5cmF1T2dvcHE2WUV3d3NmSzhOd3hJWTB1T0dPRzNZaVROUDVvUEtxcnVldSs0OTcxRUdQZEpWVmM4N3N4TDNZeVNGMjF4Mzc5NjlIUExpK0E2M3FPYnU1WmVNdU85NTBOZTZ1ckxXeFB5NDdjR2xZdDFvemUxYVY3VzNUVDFOQjg1VHZGZld2aWRKaTA0c2h6QnpXOHdYYkhINkY2SFFiT3JQRysrWWQzeWpEOHo1aDAvVDkyZTdoRStxY28vMnZlRFVUVTFVWmFqRVBKM0ZmUmVZOVZxbW9mMmw1bjEyaUp5bVhhRCs3dmFZWmN0Vzl4dGZ1SDdXZ29iWloydXdidXJwWDFEaGlmdkRiU2pZTm5QZ3Zrdk1NN3FIODcrYitaL25PczNKaWVFVkR0SlhtT2k0cmU3aGNvbStQTm4wNVV0RHFHNFh1RjFWaTdCM1NwcUtvbXdBMmJDL0lISGxqenhIb2VXNDN1WFBaRVBYOGg2VDh4MW0zaGxlaTVuTDFSRXpYMHpFUlBvdDhJOWt2eU5sc212TldlSDE4a2trdFRuUzZwMHM5K0x4RmhrWlZVNWQ5N1k5aFpJM2MwRnI4ZnZPd1d1dnh1ZFRvZWFmNUhXN216NFR3OVhiSHVka0M4MTEzeFB6czdSV2Z1SDJWdUdwNWFGbFpmZE8wODl3Z2E1b0JmR3lJbHpYT2F4ejhyVGc4akVEQUhFamVPZll5NDFQZThuem5wZWRzelU5bkYvT041ZVcyL3dBR3Vyck5xQ1IwdDFtbWtsbWxlQUM1eGR3RFFBQU53QUFBR3diRjZGUGpzZXluRlRWakh0cVg1a2x5UkwxcXBZTVR6RzVaY3NTOFo3UjlDamNNSHQ0RlJ1SmVOS3pBa2ZTRkhKRXNYZ2ZRc3R3d2tidkJSdUpZdUhEaXN1U0dNdzNPVWJoaTRiVkdvWnlOeHhITkZoZ1Jzd1Vja01YREE0S05NM2pBcU53bHd4R0NLeWNPS2l3emtIRlJ1R2Joc1J1RXFLeWtHQlJZU29xWERBb3NFNFloRlpPRzNGUllTNGJNVWFoS2lrNFloRmhtOFlIRkZTUmlNRUVuYU1WRkpGQ0FRV0JnRldRZzBpR3pGRWxhSWJSaVZVbFc5RWFSamlxeXRCUUdBd1JrMmpiaXFrdEdEaWlMYU1TaVN0Z3hLck10UU9DckRWZzRxc3FRYU5HQVZZbHJFTUJpak10NHhnUFZhY2N0UU1CZ2lMWUZXWmVSRzNBS3NTMmpidzRxdU9aZVEwWUFBS3NQSnBJVEk4QUJWaVh1T2o5TnZyWjJnTjJIK0ZhaHg1UzVXZUpIakRmdTZHb3FXZ29LVno0bnZhSEZyU2Q1dzRLc08vOEE5dUgyK2RMZU51aTZIV3VxNk5yKzRNMGJYMHRQS3dmMEZwR3h4Qi84YVJ0L2lqMTNkVGUzcjRRK2o4dDZIUkd2THRuM09XQzZ6MXdnRUFnRUFnNEcvdkMza2wyODdVZUJ0MzdRWFc2eHhkeWRjVkZ1Z3RObmpMSDFFdExRM0tHNFQxRDJrNW1STjZBYm40dUlhT09IWjZXUHZYNFBPOHk2aU52Q3I0eS9uanVlclFMeFR5NXRoYU1WMjR6cko4cGoxTXh1YW84WGFEN0l2a2RwTHR2M0wwek5mSklHVVZWV2kyVmsxVEtJVzA4ZGJUeVVnbkwzT2F4clkzU0J6aTdabHgzSEFqWFc1NnNJZlp4NXhPOXRiZUU5a1RNL1RWZmJMdk5Ya3V5L0oxNW9uVFhjdlExNjdjYXpwbTF1ajlRVUZYWkx0Unlocm1UMGRkVHVwWjRuQndJSWRHOGdnamlyRTB6bGpHVVRFOWt1dGZWZjdyUDRnMzJ1ay9DZGI2am9iR0hFMGxLOWxEVVNSUmZvc2RLV016NGJzY29YTHpwZUhsNUR0ek42cGNsZmJvOW9meGc5dHFxdXVxZTFMNis5ZDBiM1RtMlYrbzc1SkdaV1VQWGJVR2xwb1lHdFpGRzU4Y2JuNDVuT2MwSEVBQm96bnV6bHdlajBmUTRkUDJYTXVWSzQzZGRmUHY4QTNtSHBidHI0OFUzaWpwbTVReTkzdGZWVkc2dnRzVDhaNlN4VWsvemI2aVFzT01mVm5oalkzTVB2dEVtSDVwWFBzWThiOEhpK2M5VkdHM292alAxT3R6d24wM0ozUThqYkxwV2d3SnE2eWx0MFhJR29uYkEzODBPNThBZmd1YTY0dms5cUp6emlJNzVmMFRVOEVWTEF5bWdHV0NOb2pZM0VuQnJSZ0JpZHU1ZEoraXhGSnJheW10MUZOY0t4MlNqZ1krYVYrQk9WakdsempnM0VuQURnaE0wL2wxN3ZkNXF6dXozQjFsM1F1WnhxTlZYdTZYaWFQYmgvVEtsOHJtbk01N3Z6bk8zdVB4TzlmVitXWXhvcWV5WDZkL2JEb01kM3l2ZG5jaUp4Mzg4cmp4eHJUTVQ3M0czVnRYVTBWMm1wQzRsckhFTmNkbUxUdEIrcGVQMUcxeXM1eDhIOCtmTVBrK1hsZlc3dlRUYzZNcHFaNFhIZFAweFhvOEg1SDRqTGppU1Z3MjhWKzlvKzZ2Wld0T1k0WWhFbDJCZTMvVXhkd2d6UU5RYzhqeTEwUU8zYU5vd1ZoMXR6aE51OUh4RzB0RnBEeHUwaGE0d1AyMUJIY2ljcm1FL1B1TmFNUTg1c1FKQU51RzdjM2NPcHVUY3Ywenl6YTVleGhIb3YyOFgwZFlkNThEOGxmYjY3WStVSGNQOEEwaTY3dVZVeTV0b1liUEJERXlGOGNWUERJK1lCdWNZN1h5T2NmaXVUSGNxS2VYMXZsY2RUbHFuS1lmSjVmWTU4WUtodUZUY0sxNzl1SjZOS04vOEF1U3RjNlhSbjVkMjUvZWw0bFI3RHZpYlUvd0NNcmE3K1NwZjhGT2NmMDd0L2lsd2Q5MWZ3SjdJZUJPdSsyMWQyMnVWVFUzYlVrMXhmVlV0VkJFeGtVRkVhYU5ybXZqSXhMak83WmdkM0RqMk9tMzV4empMd21KY1dHM0hsUFZiTzlqTXpPT2NaZXlZbDlUOEE3TS9XUGNmUTlpaVlaSFZ0N29Iek1HWUg1ZTE1N3ZLY1J1d0ZOdC90Yng5TDU5dXhHRTEzMDdQOXd2TXA4MitjNTQ2c2RqYnd4eDlXblhOZU1Ybmx4NGZIdHVYeGozbnBma2QzRy8wUWVQOEFyYnVtRGxtMDlZcnJlSWNRNDR5MHRGSk5HUHVPYWRyd0JzY1BpTjZ1TVhMaDZqYzVlM2xsNFJMb2E3Szl4VzJldjBiTlVPRDRwYWlwanFZbmhwYTl0eW9aM1lPQnpZNE9jMGZ3NEJmUjdNWHR2TzhzM09aNWZ2NGVFWDdKaDJyZXp6M3ZydFdkb3I5MkMxTFZNbHZ1Z2E3cDJvRjd6TEpZcmdYVkZJNzlwbUxneDJkbUllN0xzWWNNQmo0ZlVZMWs0L0krcTVtM09NOXVQMU9ZYTY3MjNCVDM0ZkdhVHVqNDF3OThySEUrVys2SWM1dHlqanhPYTAxcjJzZkxsR0pQUm1ESEhBZm1GeE94b3c3blI3dWpLcDczZThzNi9Eb2VvdzNzdXk2bWZER2VFMzZJbXA3K3gwc2RrcmRjWGErcm53Tklwb0tlUmxTL2dNN2dHdCtKSSt4ZlU5STczOStQTjlucHZsNmRuS2Z2NzJlTVl4L3V6cXluMVJFVmZqTWVMNkhVVW4zejhWM3FmdzVxZVZaNmNNbUdPNUtUVytrV2JVUDlXOUZYbTV4Zm5SVU03bjRadGtRWisxUDNkdUFqekU4T2V4ZGJySnJheW4wUFk4Z2pWMXUxSCtLSjluRjN5OXZkVmFZMTFvU3phejBWTXlvMGpkS0ttcjdaTkZJeVZycWFlRnNrZUQ0M1BhZnVrYm5INHI0YVg5VzdlVVpZeE1ka3YxYWlucDZ1bmZTVmJHeTBzclhSeXhTTkRtUFk0WU9hNXAyRUViQ0NvM01XK1REd1E4U0JkemZQNmswZjRnWENUL0cxblN6QWc3SXV0MHdObTdMZ3VYbjUrTG96NVpzVE42ZmZQeGZVN1BaN1hwNjFVMWlzbE95bHM5Skd5bnBxYUJvYkhISEczSzFyUU53QUM0NW0zY3h4akdLanNoOFc5dzd5MzAxNGUrTXQ5MTVWMW5TN2pYU0NheGFJb0lBMlNxcTc1V1JHS202VWJpTVd3dWNKWkNkbVZ1QXhjV2c2d3h1WFU2L3FvMk51WnZqM2V0MWM2ZGxpMHhSVXRrMUJLMTM0RFJ4dzNHYUVEQno2S0FObmN3RERITTVwTGVKNDdWOXJ0VnQ3VVRQZEQrWnV2eXk2dnJjNHg3Y3M2ajIxRHROOERPeWRkMmc3RlVsejFUQUllNDJxWE4xQmZHSDg2RHJSZ1V0SGlkdUZQQmxaZ2R6c3krUDZyZm5kem5LWDlHZVFlV1k5RDB1RzNIaCtueDljdnRhNjcyblR6N2lQdWxlU1ZkNUc2anRYamRyT2ZUUGEzVDFRL1ROSWFYcDVhNnFvQ1JWMUJEbXVkdGxlV3RPNHRBNGdydFlZUkVjWWZIK1llY1p4dXpHRTFFY0hHeVgzUmZjYmJVNVIzZ3I4Z083Q0wrYlc5T1BnNlg4NDN2eFM5cTAvN292bmo4K3k1M3J1blhQdDVmRTAwMGZTR0ljNE1PQk1mMGxTTU1mQmNQTnQ2ZjNwZDhHbGIwM1VtbUxicUpveXRyNlduclEzRERBVHhObHd3eFBQbVYwNWZkWVphb2lmRjU2Tk9uaStXeWgwRjMxMUxwVnJXUnMwL2NiM1ptTWphNXJXZkszU1duaUxROFlnT2lBY1BRcjY3b3QzL0ppZlEvTlBJT2pqRHp2ZW1lekdKbVBwbVAxdVlmczJVa2Q3N1Q5d082cm5PZE5mdFhWOUhDUzVyd2FTMlF4eFFFWlRnUDhBR09Id0EzNzE4MzFlZXJOOXo1ZG56WjNOenh5OTBPWWk2cjBueVh5ZzhNdTBmbHcyMHg5MXBiZzJDeWlvRkZIYlpxZUp1TlVZekk1d25obDIvc203c1BWY20zdXpoMk9uMVhSWTlSV3FaNGVEMWZ0UDdhZmpkMll0dDF0K2ltM0JzbDRFTEt1cXFaYUtTYkpBUzVyR0g1WU5BekhFN05xN1d6NWhudFRjVXowZmwrSFRic2J1TXpxanN1dUYvUSt0ZHB1enVnK3ltbTVkTWFCcFBsNk9wcVpyaldUU0VPbXFhbW9kbWZMSzhBWW5jQmdBQUJnRjFOemNuT2JsMjhNSXhtWjc1bVpuMHpMMk90cmFPMjBjdHh1TXJJTGZBeDAwODh6bXNqampZMHVjOTduRUFOQUdKSjNMRFV6VHBUOTREejgwVjVFZDltV250UFdpdTdXYVNvNWJEUjNXSnJUVDNHNFQxSFZycWlta3dCZkUwUnhSTk8wRWd1YWNITDF1ZzI1eGlabDJ2bHJ6WERIZjM5Mko0WWJlbjZjcHUvOEFocjJ2Vi9acll6dVA1NjZGb1oyaVdpbzVMbmVaYzJCRERRMjJhV0YyMGpiMWN1R0c0N2VDNHVxM0x0OHJQVlQxWFdSbFBqTXU5bGVjK2hlRnFTeVE2bDA3WDZjcUpIdzA5d3BwNktTV0U0U01iUEVZaTVoTzRnSEVLeE5NNTQ2c1pqeGNVYTcyWVBGZTRUdnFhcXF1anBaRGk0bDlHZHY4aXVYblM4S2ZsN2FuOTZmY3lvZlpROFJLT29iVUUxOHJtbk5sa05JV2tqbU9qdVRuU1I4djdVZnZTODZyOW5UeFpySkROSyt0NjJKZG1BcE41NC80cGRuRHpIUENZbUlqZzdIbFBrKzM1ZjFPSFU3Y3pPZUUzRjhZdjA5bnJkTGZtZlp0TDl2ZklMVW1qTkt2ejZkdGwydU5CUXlPeWg3NmFuclpJSUhQNmVMUzUwYldrbHV6RTdOaTlTTjZjc1l5eTdYNkg1dDgxNzI3MFdPVzdNYThyN09FVmMxM3ozVTdVUDNkYlRoaThWOVc2OGtpZXlTNzZqZlJzbGNmdVNSVUZGRTV1UUhrNmR3SjNIZHdYaTlUbGVUODg4b3puY2pQT2UvSjJETHJQWGRldnZ4OXoyYVFzT2g3RUhOYTh4WGl2SnpmZnpFMHRPejd1T3dZRiszaXZROHZqakwxdklOM1IxbXFlekhES2ZwdUlqM1RMckM3WWVXV3BmSC9BTDRhUjhoZEhTWTMzVFZmSExVUWw1WTJxcEpDWXBxYVJ3QklaTEc5OFRpTnVEemh0WGI2dkdKaDRIelYxdXJleDNzZjJzZUgwZUgxKzEvUmpvTFcrbmU1V2lMUjNDMGpPMnEwdmU2T251dHZxSTN4eU5mQlZSQ1poelF1ZXc3SGJjcmlNZUs4V1lwellaeG5qRXgyUy9UbmdncW9IMDFTeHNsTkkweHlSeUFPYTVyaGdXdUIyRUVid28xTVc2Qy9lNThUSit4UGQyNHpXK0Z3MDVVZjA2Mnk0RTU2T2R4TWUwN1NXRU9qY2VMbWtyMU5yUFhqYjRUcnVtNUc3T1BkMng2djA0T3JQV2NBNjd2aVZ0MW5xTlEzQjJQRWJGSmN1THhKVzRFaFpja01aUnhVYmg0ODdmMGxHNGVPOEtPU0dNcmVLamNNSkJnN0htbzVJWlNOeEJDamNNSERZbzFETjR4Q2pUQ1FZTytLamNNcFJnY1ZHMlVnMllvMUROUnBEeHRLRE1qRUtOUXlJNEtPUkIyRlJwTWcyWW9NbEdnNGJFV0Vvck43ZUNFSVVhUW8wRUVQR3pCR21hQmNTT2FpcFJRZ2FDbFdRZzFqT0xVU1ZJaHRWU1ZOM29rdFdIWmdxeW9iMEZJeXB2SlZKYU1PekJFVzFFbGNaMnFzUzBidlZZbHF3N0ZVVU5oUWFqYUZYRzJZUVJpRlVsc3c3aXE0NWFJalJoMjRxc3k4aGgyS3VPVzhiZ0NEd1ZjY3QyNzFXWmZwMk9JUG5EZUtyRXVRZmkzMm5yKzUrc2FMVHRzak1rMHoydHdhQ1R0UEFMVGl5ZjBWKzJCN2F1blBIYlJkdDdoZHdLTmo5YVRSUnowRkRJMEg1WU9hSENXVWNaRHZBL1IrTzdxN3U3ZkNIdWVYZVgxV2VmMFI5cm1tdXM5d0lCQUlCQUlPTm51USs1ZjJYOXUvdGcrOGFxbWp1bmVPNXdTU2FXMGxFOGlhcWNEMHhVVkpiajBxWnI5N2pnWFlGck1TRGh2RERVNlBYZGZqMDJQSGpsUFpEK2JYeS84QUt2dTk1VjkxcnIzbjcwM1dTNDZ0dWp5Nzc1TFlvSVc0aUtDQ0w4Mk9HTWJHTkg4SkpQYmpoRlErSjZqcXN0M0tjcG5qTDRMVzMrWjFVSkhPL04ySTYyT1ZTK3MrUFhmVzQ2TTFEUXhzdUQ2Q2lkUEUyYXBZd3ltRmhlR3VlSXdXbDJVSEhMaU1lYTVzWjFSVDBOcmN1SzcrNzF1NGZ0TDc5dmtGMkswUFp0RWQzTzNWRnJlZ29hT21nb2RTMmU3eVVEN2hTTmhBZ2xrYlBCVU9MeXd0SmNXTngyN01UaXVybHN4Zmc3M1RmTWN4akVaWTNUM3VtL2VXTkdTVTdIMUhaeTdzcUMwR1JqTHhFOXJYWWJRSEdqYVNBZU9BK0N4eWZTN1g5U1kvZzk2ais4cmFIRzdzN2VmKzlvZjgwVjVIcGFqNWp3L0RQdGVKZFAzbVBTbFBUUGRhK3pGMXFLNEVCa2M5N2loakpKR09aNG9aQ05tMzgxT1I2VEw1aXg3c2ZmOEFxZktPNjM3d2g1cjkzSXBOTytQV2piRjIvanFUSkcyOFhtb040cktjT3lzamRIMVdzaHhaaTV4TDZWNGRzMmJDSGFqWmlPMlhTMy9tTFA4QWRpSTk4L0J3cDd6NmIxbFRYK3Y3czl4OVFUNnM3b1g2V1N0dTkrck0yWjhzMkRuTmFIT2RnQnV4MmJCZ0EwYkZ5OWtVK2Z5NnVkM0tabDQvaFA1ajEzaVg1SjJQdXczVFQ5VzA5cnFIVjBsamhxRFNQcU1zTDQyRVRpS2ZJV1NPYS9IcHUvTnc5VmpLTGluWTZYcUkyZHlNNWk2ZGtjSDd6VmNaV1p6NC93QndhZVg5Wm5IL0FPNkZ4Y24wdmY4QTZtL3dlLzhBVTlJOGh2M2tYWFBjRHN4cXp0cm8zc2ZYV2JVbW9iUmNiSFIzeDJvWDFCdDh0ZFNQcFcxVFlCYTQ4N29zK2NOenR4STNwR3k0OTc1aTE0VGpHRlhGWGY2blU3RmU2bW50c2R1cXdZNnlNRVRSdTN0a0xpNTRJNWh4SytrNlQ3dUVQNmMrUjlxTmp5enA4SS9CRS94ZmVuM3k5WTFuYTZtNlBqcjZDTjB0VC9pM3NqYVhPSTNnNERiczRyUG1mVDY4WXpqdDdKZm4zOTVmSXNPWHQ5ZmpVVEgzTSs2NG5qalAwVGNUMzhZN29maGYxYjFFZDFCVS93QWhMK1JlTHlzdkNYODkvbXR2OFVlMkg2TmlzV3BZcWxtUzMxT2JFWUFRUzRrOHR5MUcxbjRUN0VucXRyOFdQdGh5UThjdTUydXV5c0Zickdqb3AyMUVOSE95Rm4zbzVUSkpFWTJaUVB2Z2duSGRzVy95MmNSTXpGUkRxVDEreGxuR0VaUk16UGR4ZG9Pay93QjVZMEJiN0hSMk8zOWxMNUZRVVVFVkpBMTk0aGNSSERHSTJnbjVNWW5BTG84cDkxaDh4WVl4RVJod2owL3FmdVIvdkoyaTVHNXY5RGw2SC9hc1ArYUp5V3Y2a3gvQjcvMUIzN3libzBidXpsNVAvYTBQK2FKeVQrcE1md2UvOVNIL0FMeWpvNWd4L3dCRFY2UC9BR3REL21pY2svcVRIOEh2L1U4T3MvZWFOSFVnSi8wSzN0Mkgvd0RWNFIvNkluSlA2a3gvQjcvMU9CZnVPKzQzVitmdmtkWis3VE5MVk9rZEpXS3dzMC9SMjI0VE1xWHZxZm41cXVTZnJOamp4ek5rQUFEZG1YMTI5dnBjSWlhbHorVjlidDlaMXVNNTQvZHFxbmozdmRPd1B1VlUzaGozWTBaM09abytmV2xzcDdYY0pZcmZCWGkzdFpVM0NHT2xaS1p4VFZZTG80eE0wdERmMDk0dzI5L3pTZFdPR1BvZkRlV1piblJlYTlYbnZScXpqY3l4OE95WjQ5blpNVlUxeDdYS09MOTZIcDVHWnoySnF4NmYxb3gvKzZGNHZKOUw3RCtwZjhIdi9VK1JlYi83dzVlL0p6eGwxWjQ4Nlk3UlZPbTducXFtaHQzNDlKcUY5WTJsakZYRk5MalRzdDFPWDU0Mk9qL3hvQXpZbkVES2RZN1ZTNjNWK2ZjN2JuRFJWK245VGh2b25VbDB1ZFpiNkt4WVNWZHZxYUdyWkhtREFZcWFvaU1neGNjQit5RHNQeXI2RG84ZFdOUTRQTFBPTm5vdGpkbmV5ckNjWmkvVGxFeEh2cjY1NE9TWFpYejUxSjRJOTliWjVHV0N3LzFvczFYUjFtbGRSV09PcU5GSlZRVGcxVks1czdZNThqbzVvZzRreE94RGN1ekVFZVYxZTN4ZWY1WDVoUFQ1NnF2dXB5V2ovZWdxYVNQUC9vS3F4NmYxby84QTdRdWx5ZlMrZy9xWC9CNy9BTlQxWHU5Kzh1Nlo3aDl2YjMyMzFaNDkxVmZwZSswVlRhcStBNnFhQzZHcGlNVGkweVdXUm9jTWNXa3RPQkFLc2JWZDdHNTh4Um5qT003ZkNZcnQvVTRQK1BlckxaZisxVVZiRlFHZ3ZqSnBhYTZOa2FRNldvandjSk1YRGFERzVoNUE0Z2JsOWY1ZHVSbnRSNHh3bCtMZlB2bW5XZGQxa1QxTzVPY1k0eEdIZEVZOWxSRWNJNHhOOTg5c3ZZWjVXbDVJNG5GZDU4UlNxV29iRzhFYndxVTlwMDNmMk14Z21jRFRPYTRTdEp3RG84cHp0T0g2emNRdW4xOC81T1QydmwyUC9lN2YwL1ZMMXp4NDl6N3k2OEVybFBvanNocXY1N3RURE5KME5MNm5aOC9Rd0I4aGtJaERzSHg0dUpKTVRtWTQ0bkU3VjhqbGhFdjIvcFBNOTdZaXNaNGVIYzVFVWY3eTE1YlBwV3h5NlUweTZwMkIwZ2pyaGllT0FGUmdGamt3OUgrb2Qzd2hxZjNsenk2aGdES2JTT2tYeVk0bVNyZ3Vyemh5d2hyb2dFNU1IOVE3M2hqNy9pOVcxMys4ZWVmR3FJSFV1bUtmUzJtcFhSdmdiVVd5MlR6dWE1NElFd0Z6cUt0dWRtOEFqTHpCVjVVT1BQei9BSDh1eW85VWZHM3g3UWZlUHVENUNkd2ozcThpOVMxdXNOZlF2cEtHaXFiektaS2VpaE1qV1NmTHdnWldFUmc3VzRieWNBU1N1ZmF3dktJanZsNFBYZGJuTVRubk4xRSs1K04zNThtTmY2RXYxa3JORE5wcWk5L2lNRjlyWTdpQkxUek1vcWx0VEhCTkc0L2Zqa2xiOThFN1FNT0s5cnpUZDA0eGhIZStHK1V1bTFiMDlSbHgwenc5Yy9wNzMyaTMvdkRudVdUTUJxWGFhemNTTFpHUC93QjR2bnVWRDlVL24vVWVNZXdyMSs4RmU1YmM2S1cxVytmVDBGVlVzZFR4elEyNkpzakhTRElITWM1K0FjQ2NRVHVLdktnbno3ZjhZOWppNzNyMVJMcHU2MFdoR1BhWjdIYjZPMzFja0pKYkpXdWkrYXJINGtuSE5VeXlMbjNJcWFmUDdXZXVOWGpMNXMvVnRXWnMyWTRZODF4dVE2L1gxMGxBdE52a3dyT202UnVKd0diQTVOdkRhRWMyM3dpWmMxKzJQdjMrNHRvWFF0bTBIUXk2ZWx0VmtvYVMwVXNsUmJvblN1aG80RzA4WmtjMTRCZGxZTVRnTVNzY3FIcVllZWIrR01SRXhVZWgrM1YvdkRIdVJ4c3hoT204My91eVArY1U1VU5mei9xUEdQWTlBMFo1ZDl6Tzc4MnQrKzNlbDFMRnFxNlhCMXlxWFVPYUtsL1owTEEvSXdsNWJpNW1ZZ0U3VHNBR3hldjAyZWpabjF1THBONnM5N2ZuOXJPTVk5bC9HSDQvaVo3elhuTjRuOXBLVHN2MjRrc2p0SFVjOVRXUkc0VytHYW82bFhLWjVDNlZybUYzM2pzeEd3Yk53QzhuTENKVHAvTnQzWngwNDFYcWZZS1g5NGM5d3lWb0wzYWR4LzhBZGpQNXhUbFE1LzU5MUhqSHNhdS9lRlBjS3d4RHRPLzkycy9uRTVVSDgrNmp4ajJFL3dEZUYvY0tiR0JtMDdtTzNIOE1aajhQOFpnbktnL24yLzZQWXdxUDNoTDNGYW1GOVBUejZlZ2xlMHRiTTIxeEVzSkdBY0E1emhpT0dJSTlFNVVIOCs2anhqMlBubXJmTlh6SDh2NHBYZVRYZEM1UzlzNkdLUjFaYWJDWWJYU1ZMWHNNUlpMSGJvWVluWm1ITDk2SW5CemdDTVRqdkRidWFpSG05WDVydTV4OS9MaDd2WkRpMTMzN2wydWt1OVBZOU53c29ySEJHNDB0SkVYRVJ4dmVRQVM0a2x4eTR1Y1NTNGtrN1N2VDNxMjhJeGh5ZVE5Yk1kTnU1ZCs1bkVmUmpIRDY1ZmJmYTQ5d0NMd1E4Z0plODJvTkhWMnNiUFBZcXF6VXRKYjZobElZYXFxcTRaRFAxSklaZ1FJb25OSUFCSmNOdUFJUGw1NDZuWjZUcjQ2ZmQxVEY4SFl2US92Tk9qSzFvZC9vV3ZiQ2VCdThKLzhBUkZ4Y2w2MzlTWS9nOS82bm1qOTVRMFlSai9vYnZQOEEzdEQvQUpvbkpQNmt4L0I3L3dCUk8vZVVkSE4zZG1yMGYrMW9mODBUa245U1kvZzkvd0NwRC8zbGJSN0c1aDJZdlIvN1doL3pST1Q2VCtwTWZ3ZS85VHdLMzk1eTBoUm5EL1FuZTNjUC9YRUEvd0RRMDVQcFhINWt4bWYyUGY4QXFkTi9kTHZmZHU1V3ZaNzlYTkg0cFZ6T2xmREFIWWRSN2k0dFlOcHd4MkJlanU3bkNJZGZ6THpDZDJNY2U3R0lqMlE1N2UyMTc1ay9neDQxVVhqL0FGZlo2dDFKY0lLMnR1dFZleGZ6UXRua3EzaktHMDM0YlBrREkyTmIvakRpUVRzeHdYUnoyOVV1djBQblVkTnQ2ZEY4YjdmMU9RLy9BT1ovanlaLzlCRmJqeS9yT2Y4QThJV09UNlhjL3FYL0FPbi9BTVg2bkJiM1RQZGN1M25SM0N0V3F6cFNYUk5udGRxaXRFZHFucnhjWFN5Q3NucUpLbnJmTFVwQWNKR015bGh3eTQ0N1NCNkhSWTZJbVhwZVcrYnpuek55dFBDTWUyL0daOFBRNG0wUGMxdGNYVXRRL0dDUUZqeGp3UEwxVGR6dDRmV2RUTzdNMjdJZmJ1OS92dUw0a2VOdHI4ZU80WGJXcDF6RFlaNmxsbHZiTHc2MnZpdHN6eE5IU3ZqZFExZWZweU9rTFg1d0F3dFlHZ01CUFJ5MjdrNlB6eWVudzBUanFyMDE5a3Z2anYzbnVNTXpqc1JXbjAvck9mOEE4SldlVDZYYS9xWC9BT243L3dCVGloN3BIdklXcnp4N1oyelREZTAxVHBEVVZvbmxrRjlsdlF1TEgwVThlRWxPK0g4UHBUajFHeHVhOHlITGc0WlRteEhQc1JwbDUvWCtaeDFWZmNxWTc3djdJZFlXcUs5dFRNOXcza2tydE9tOVlxQ01TZWFrdVRGNGt4R2I0TExraGhJY0FvMndtSURWSEpEeG5sUnVHVWh3Q2pieDVUdUhGU1hKaXllVkc0WU9PMGxSdUdaT0FVYVl5a2JCeFVsckZqS1JoaHhVYmhrODRCR29aS05wa0tETW5pbzB5ZHZVYmhEdDZqY0plY0dvTWxHaU93SUpScEVoMm9NMUdrbmFVYUpRUzg4VVdHU0tSM3FLV1A1VUNSUWdwcDJJa21xaTRqZ2NFR2lNZ0hBNG9MVlpYR2R2MktzdEVGTk9JUkpNSEFxb3Rod0tNdEFjRGlnb0hBNHFzdFFjUmlxNDJzWjIvRlZsU0RTTTRqQlZpV3NUdUNNeTNqUEJhaGpKcTA0aEdWdFBCVkpid3V4R0NyRXQ0endWY2N2SWpkbWI5aXJqZnEyU1lSek5kelZabHltOENQSWkyZVAvQUhncyt2YmpUdHE2U2hxWUtxU0J6ZzBTTmprRHl6TVE3REVEREhBNEpQR0hEbk9tTDhIOUVlaWZmRzl0ZlZXbDdmZTdyM0FiWjcxVndSVDFkcHE3VmZKcHFPWjdBNThENUtXamtoZVdPeEdaamlEd1hSbmJsOUZoNTMwOHhFemxVK0ZUOEg3VFBlWDl0TjR4WjNQZ0kvOEFjK292OHhUbHkxL09lbS9IN3ArQVB2TGUybzNmM09nLzduMUYvbUtjdVQrYzlOK0wzVDhDL3dEbk0rMmwvd0Q5UGcvN24xRi9tS2N1VCtjOU4rUDNUOEhnemU5ZjdjRVVybzJhOGRJeHBJRWpMVGRzcmdEaGlNMU9EZ2ZVQXB5NVovbm5UZmluMlN4bDk3MzIzSVJqSnJxUUQvM1RkZjVoT1hLZnp6cHZ4VDdKZkVQTXY5NHc4WU8zL2JhcnRQaWE2cTFoM3J1RWJxZTFUMUZCTlRXeWdtZVF3U3ppcTZjMHJ4aml5T05oYTRqN3podU9zZHFlOTF1cTgvMjhjZjhBTDR6NnVFT21idlpxZnZGM1gxMWRPOFBrSlhWTng3aVhtVjFmVk91RGc2ZDBqeHNNclc0TllHdEFheU5vQVkwQnVBQXdIWXFueVc1dnp1WlRsTTNNdmcrdlh6VFR2ZHR3Mm96RDBTdUwydk9LQ0xaZEtpbXI0V3NkaGk5Z3grTHNGckdlTGVPZFE1ZjltdTdzK3BMVU8xdC9sZkpVbk0relRQY01JOHNaZTZBbCswQWh1TGNEdjJjUXUxdjdkOFllVnQ1MDhDKzZwdWxscjVLU2ZNSE5jUWZpdW03c1Rid3ozRXJEK2tVR0ZScnlzbFA1NXc0akU3d2NSdVFiV1B1SFgwZGUyUVBJd08vSGdoTVcrMFdtL3dBUGNiUnNscXFqbXFRdzVDVHR4d1duV243c3VQT3VCZDlEYWsrZHBnUlBUU1ppdzdHeU5Ec1N4M280YkNzdTFqTncrZ1dYWGRWVjJxbnFqSVhpUmpYaVE0RE9DTmo4RzdCbUczRGhpbHNTZFpxaWVjWUYzMnBaYjVwM0xwcEtTN3N2Y1F3cHFyN2t1RzRTdEgvMG1qNndWNmZSYnR4cDhIOUIvd0Jwdm1IbmJHWFNaejk3YjQ0K25HWi84cys2WWp1ZVQyNWNKYXlXcU81akEwZkZ4LzJGNnV2aFRvLy9BSkErWmFQTGVuNmVPM2MzSnkrakRHdnJ6anUrbng5MGpsNGNGbC9KTXc4cW1xVEdRUWRuQXF1T1lmcVV0Mi9aT2hrUDdKN1N4dzVod3dPOUppNHFVeG1jTW95anRoNnM3VTFYYXFxU2plLzlwRzRzSkhIQTcvcFh6ZTVob3ltUEIraDdHN0c3aEdVZDhQSVozQXFtZ0RNZGl3NWxmNlJLdjlZb0U3dUZWdUg1eHhRZUxVNjFxSmNRWEhhZzljMW5mNmlTMHVxR25iRTVzaDI3Y01jcC9oWEp0VFdUditWNzNLMzhaZnJ2MVROZXUxRm11eEpkTmJxaW90ejM3aVd2L2JNQk9HMEFiQmhzSHhYbzlaanEyOFo4SnBQbWJhalo4NTNKanMzdHZEYyttSTB6N1ppNXZqOUZQeVJyQ2Rvd0RqaDhWNWJwVThhcjFMUFB0THZodFFwNzk0OTNLYWE5MXRhL0VzaWlEUTdrNTViL0FHZ1Y3M2x2Wkw1RDVtNmljZG5seCs5bDlWL2JUMmJ2TGVwbWFRcXcxMnhrbFBPUHBsTE9KNXVYVTh4MjZ5ZHo1ZTZ2bTdVUlBiSEQyUGtyTlpUdGJobUs4eDlIVENyMVBOTzNBdXhRcDlTOGNid0hhYnVNSkp6aXFEeWVHRG9taiswdmU4cG43ayt0K2UvT09IK2RoUDhBaCsxOUFkV2duZnNYclcrUTBBVmpXN2NVczBOb3JsSzJHV1dKK1hwc0x5Y2NNUmlHNGZhdWw1aFArVGwrbmU5cjVldy85NWhQcitxWEZIdUxxV29icVNxa3piNW40YmZWZkx2MWZGK0RTNjJycVY0ZXgrMGM5bytuRlZwYzJ1cTJkeGU5L3dCNDh0Z1FPZzFSVlZGUzFwY1NjZWFnNUg5Z3J0VTIzU0VOWnREcEpKM2tnNEhENVo4SVAwUGtDN25RNGF0MkhoZWU3M0w2Zk9mR0s5c3ZRZSt1cHBxM1h6b014SXBZSVlRTVJnQzdHYmNQN3NMbDh5eXZkcndod2ZMR3pvNlcvd0FVelAyZlk5V2kxRFVNR0dZL1d2UGZSVTlvN05WVTE5N28yV0NWeEZMQlV0cjVpQ2RrZEdEVk94STI3UXpENlZ5Yk9ONVE2M1Y3bkwyOHA5RDhiVldxNmpVK29LNi8xUlBYclo1YXB3TzhHV1F2dytqRll5bTVtWEp0NGFjWWp3aCtYMXhqaXN0dnc3WmRaSzNVTlpXTko2Y1I2TE4rd05KWnN4NTRFcXVUdWZ2d1grZUliL3RSbWxuVVZSSVEwRWwzRGJpbEQzclhlcjZ6UkhaYWgwcFN5R080WFNROWNjZW1BWFQ0RWZ4aTF2d0s5RHFmOHZieHdkWG9lbzVtM014MlpaVFAxWXg3b2ZLb3IvVVJuRU9YbXUyOGlQVjFYSHVkOXFDLzY1MXU3TnMrS0Evcm5XZnJmYWc4MnkzdXZ1TlN5S01rdmVRQU1lWjJLcEw2enFhOWYxUzBWU2FRalA4QTBoVVphcXN3TzBBYldnL1R0WGY2TGEvZWw0WG1lLzhBdXgzdVBPdWEydTFSM1FmYTZja2lNUXdZNGZtaklIdUorR1lyaTZ6Tzg2OEhyK1dmYzZlUFRjdm8xcHVJdGRQSFNVK0xZWXdHdEJQTG11cTVabTM3Rk5yT29oR0FlUWc4a2EvcXdNQTQ0ZkZBZjZRS3o5WS9XZ1R0ZlZiaGdYSDYwSHBIZUR2SlUyUzBpMFVieitKVmpYQXVCd3lSN2lmaWR3K2xjbUVkN3M5TmpGNnA3bnF2YkNtcUIvOEE1UmNtbnF2QmJTTmRqaUduZS9iekd3TEV6Yk85dWFwZStVK3FLaVBhRDlxanJwdm5jMFdHMlNYR3NjZWt6WTFvTzF6anNBQzFoaHFtblk2WHA1Mzg0eGg4TjF0M0Z1Ri9yNWEycmtMcG5uRWJkZ0hBRDBDN1dlVVl4VVBiNnJkeHd4akREaEVQMmUwVnZyTHcvd0RITGcxMzRiQzdDTU9Cd2xlTisvZTBIZnozYzExSmw0Mjd1OXo2elI2bnFJTmdKK3RSMVhtSFhNekdGejNFTUF4SkoyQWNVSHpMdVYzVW0xRk4rRzBEeUxWR2RyZ1QrMWR6UG9PSDFybnd3cDJkckN1TDBPdHJIU2trN2x0encvT25maTRuZ0ZtWExqRHhYbkg0cU9TR01yc1NvMUR4cDNZdXc0S09TR0R5bzVJWXl1eE9DalVNSEhFNHJMa2hqSzc3dnFWRzRZdVBCRzRaeUhnb3JCeHhPS2praUdUemk1UnBsSWR1Q2pVSVJwbTg0L1Npd3plY0FvMURNbmlvMmhScEVydUNMRE5SU2NlQ0xDVHMyb3JONVVXRUU0QkZTbzBEc0NES1E4RWFTZ1dPekhpVkZTaWhBSUcwNEZFbFNxR0RnY1VHb09JUmswRk5PSVZTVk5QQkdaYXRPSXhWUlRUdFJKTkVXMDdGV1dnT0l4UVUwNGhWSmFSbkVZS3NTMGFlQ01TMUJ4R0txS1ljQ2lTMWFjRGp3VlliTWR4VlptR3pIRDZGWEcwQndPS0RTTjRCVlltSGtNZU40VlltRzhVb0h3SzA0NWg1bEpVZE1najgxR0poN0ZaTlRPcENNRGhodXdWWW1IMy9BTWZ1OXZicTd5d2FQN2lXK2wvRkNHdzIrNXZhSXhKZ01yWVppMGdadURYbmZ1UEFxVER6T3E2ZVkrOWkrN3cwSGJWb3dObnB4ekJ6akQ3Vmg1K3FXbjRiMnovOWowMy9BSVg1VU5VcE5zN1ovd0RzZW0rcDM1VU5jbkhiKzJzVHc5dG5waVJ1RG1sdzVibkVoRFZLS3FsN2R5QWo4Rm92NUNQOGlHcVhqMldvMGRwYTh4M3F6MmlqaHJXT0Rtek1wNHVvd3RPSUxIWlNXa0hrak9Vekx5ZTdGaXBlNGxrZGZyWUFhMXJjWkd0NDdONjB4aGxwbW5HSFcrbXBZSnBJcFdrT0JPT0lXWGFpWHplK1dwMEVoeEd4RzNoV0xUMDF4dXNjdUdGSkM5c2tqai9GT09VWThTdVhhdzFTNDl6T29mUXFhcmtqZTJXSnhiSzBoelhOSkJCQnhCQkM5QjUwdyt0MVYxbys2dWsyNmxoZEczVjlNQzI2MGtMY2dIM2lHeXNiaithNFlFNGJqczVMb2IyM3BuME94czU5ejB5VE5FOHh2eERndUYyRTlRYzBVeExsY0hBN1FnK2dkb2RidnRGeFpGSTc5bVNCOFJ1d1ZjV2VOdjIvSWpTMXF1RnJoMUpCSXhocUJsRFNRQzkySDZJM242RnZIYm5PZURoamVqYmppOUQwaVk2T2daWjJ1SkVUZnVFbkhFRTRuN1RzWFAxR3hvaUpodzlMMVU3bVV4UDBQMk52TmRTbmVwNE9vYlRIZWJQUGIzREY3bWt4blppSkc3V25iNnJrMnM5R1VTOXY1ZDgyeThzNjNiMzhaL1puajZjWjRUSHM5OVMvSTdjc2REYXBYeWpDWXlsaEg5d0FQaHZKWHZZNVhEMS83MytheDFmWDdHM2pONDRiVVRIcnptWjlmWkdQYjdQSDJhS3FjMzFDMWI4U25GNU1WWTA4Y0R5S3R1T2NYa1IxR0c0NEgwVnRpY1hydXRJSHNybVZ6RDkyVnVWMzkwelovQmd2SjYvYnJLTXZGOVI1SHZYdHpoNFQ5YjhYUEp6WFFwN2d6eWMwb0dlVG1sQXp5YzBvWVhLQjlkYnA2TW5IcXh2WU4yOHR3Ry8xVmpnMWhsT014UGc5aDAxWjhmSG1GandXMWIybTR1eEdCSjY1Y0NRUC93QlhnTnE5cmR3MWRQNzNnZWFlWlpiL0FKeHFtYmlJakNQNGYrYTNwTzNtdkVlOFBwUWZWT3dVUW83RlcxeDN6emhnUHBIR1B5cjN2TGYyTGZBL01zM3ZSajRSOWIyRHVhd1hEUmRld0FPeVJPa0kyN21mdEFkbklqRmE4dzI5V0YrRGorWGQvbDcrbWV6TDYzd3Zielh6NzlDRzNtZytxK090WVliZGRJVGhsNnNMaHp4TFhBL3dMMnZLWjRaUGlQbTNDODl1ZlJQMlBwSHp3NXIxcmZJYUI4OTZxMmFFeVY1TVQyTWRnWE5MU01TQWNlZUM2L1U3Zk13bkdIZjhzMy95Ky9qblBaSGE0cWR6b0txbDFKVTA5Wkc2S29FanlXdkJCd0pPQjI4Rjh0bmhPTTFQYS9WZGpkeDNNWXl4bTRsNnpqaHVSeWpFODBINkdtNmFhcnVMSWFkam55bkhCckFYRThkdzlFaUxsblBLTVl1ZURrL291aU5tMHZiNktvWmtyWUkzaDdUaHNkSzRFL1RnMGZhdmM2RHBaMi92WmRyNEx6M3pQSHFKMFljY1ltNW54bDhjMTVYL0FJbnJLNVZtT0lNNzJBNFliSXoweDlnWGxkVmxxM01wOUw2M3l2YTVmVDRSNkk5L0YrVDlLNEhmZSs5aEltVTkzdWQ0a3dKanBmbEk4UUNRK3BlTVNNZDM3Tmp4czVyditYYmVyTy9COC84QU1XL28yWXhqdHluNnYwaDc2OTFJTjBiUDcwTDI2aDhWRTVlTEdSOU4vdmJmNzBLVkRjVGw0eStEUlc1MXRyNitDWC9IZk9WVFhIWitqTzV2RDRMNXJlaXNwOWI5TTZYTFZ0WVQ2SStwcjlLNDNNL1UwYmJHM1RVRU1Vb3pVMGY3YVVIZGxadXgrSndDN0hTN2V2T0hROHozK1Zzek1UeG5oSDBzdTdXcGZ4dlUzeVViaTZqdDdCU01id0VnT2FVLzN4dytoT3MzTlc1UG9iOHQyOUd4akhvZXI1d3VxN3d6aEFad2djZjdSNGFFSDBMdFRSMnUxMVg5WWIzdHA2WUdTS0g5S2FRWVlOYjlKMitpNXRyWnl6bmc2ZlZkVGp0eHhuaTh5L1g2cXZseWx1bGNSMTVUamczWTFvM0FOQjRMMk1NWXhpb2ZON21VNTVUTTk3MFhTbHNmTGVMbnFtb0I2dFhQSkhUbDIvb3NmbEIrbkFmVXZIM1p2S1o5TDZyWmpUdDQ0K2g3Qm1lTnhYSFRRenljMG9HZVRtbEF6eWMwb1pWdGQ4alR1cUpIYkJzQTVuZ0ZyRERWTk01NWFZdDg2dU5scWRjZHdCODRTYlZTeHNmVXVHN0V1TGhIOUl3K2hjbS93bW9jblQ1ekdIcG1YdmNmVGlqYkZFQTJKb0RXdGFNQUFOZ0FBWEFHK1pqR2w3M1lNQXhKUEFCQjZScks0TzFISExUTmNXMHdCRUlKM09HNXgrbjdGM2R2RFRIcFhaM3NzTTR5aDZOb3ZSdHcxcmZEU3Z4anRrRGdheWJmbEdQNWcvak93dysxZGJQSjI5M2RmYTZPbG83ZlN4ME5DeHNWSkUwTWpqWU1BMERnRnh1bTE2ZzVvUFMrNE90V3loOWh0YnprQkxhbVZwSXhJL1FIcHpYTmhqM3ViYjIrOTZWSk1lSlhJN0VROGVXWERhZDZsdVNNWGpTeTV0bkJaY3NRd2trdzJjVWFpR0Vzd2JzNHJMY1E4Wjc4Y1NWSEpFTXBKQVBpbzNFTUpKQnU0cU54REZ6Z0FvNUloakk4T09QQlJ1SVp1STNuY28weGxlTm80bEZpR0wzQUQxVWNrTW5IRGFkNmlzaWNTbzVFdk9BdzRvTW5IRXFMRE9RNGxSdUVPUEJSdUVrNERGRll1T0pSWUpSVWs0bkZHa3ZPekJCa1RpVkdrdVBCRmdsRkp4NElzTW5IRTRvcVhic0VXQ2R2d1VJSkZDQVFDQ3djZmlxeUVGeHZBMkZFbG9pR0RnVlJRUEVJeXRqMVdWZzhRZ29PeDJGRXBRSkNxTGEvRGR1UmxiWGNRZ3RydUkzcXN6RFJyd2QrOVZpWWFNZmdWV2FhQWdoRVUxNWJzNElrdzFZL0RhTnlyRk5vNU9JVlptR3pKUHFWWW1HZ1BFSWpTT1FqYXF4TU40NWNkb1ZZbUc4VXhHN2R5VmNjdzhpT2R3MnRPeFZtWWJ3MTByZU94VmlZZmZ2SGp5RnFibTZIUU90YWtmUDRDSzJWOHgyeW5ZR3dTT1A2WDZwTy9kdnd4a3c4cnErbHI3Mkw3V3l1bDNGMnhZZWN2NXVYOVpBZk55L3JJQTFMeitrZ2t6T2R2S0Q5YlNtcG4yYXJFY3pzYUo1d2MwN2hpckVzNVkyL0k3ejl0S1c1VWgxTFpHQjFQSU1aR3Q0RkpYYno3bkhIV2xCU1VWWWFPYi95amVXamVCNnJlM3Q2dlU3RnZ6NmFTT0Znamh3YXh1d0FMdVJ3Y09XTHlvcXZEZXRXNHB3ZWRRWGVxb3BoVVVjcjRaeHVraWNXT0gwdElLdmE0NXhlYitQM0djNTVaUzkzTndhVDllQ3h5Y1o3am1aUjN0R1hhcE85MzJEOGljakR3U2Q3UHhiUjNHUjI5MzJCWGtZZURqbmV6OFhsMGQycTZWNGtwNUMxNDJndDJGYWpZdzhISGx2NXozdkprdTlWWFNDV3RtZk5OaGx6U3VMemh2d3hjVno0MUhZNnVVVFBhMnBhK1NDUVRRdXdrYnRCMytuRk1vaktLbGpHWnhtNDdYbk0xRGNEdmsvOEZuNUZ4L2xzUEJ5ejFlNzQrNkcwZDlxeitjLzZnMzhpdjViYjhHWjZ6ZDhmZEJ3MWJHa2x1d3VKZTcxTGppVno0eEdNVkRyZFZ2Ym0vbHF6bTVxSStpSXFQYzhxS3Z3NDdGdTNVbkJ2SFd0TzlXM0hPRGVPc1BCeXRzVGdxZDFQV3hkR3Nabml4QkF4STJqNExPZUdPY1ZMZXp1WjdPV3JDYWxETFJZanZoK3Q4bjVWeGZsTnJ3K3QySjh6Nmo4WHVqNE5XMkt3Ty84QUUvOEFoeWY0U3Y1UGE4UGZMTSthZFQrTDNSOEdqZFA2ZU8rbkIvNHlUL0NUOG50ZUgxcy96WHFmeGU2UGcwWnB6VFozMDMvS1MvNFN2NVBhOFBmTE0rYmRUK1AzUjhHamROYVhPK20vNVNYL0FBay9KN1hoNzVaL20vVmZqOTBmQitqVDA5dGd0UXNrVVliYWhGOHNJY1RoMDh1VERFbkhkeHh4WFoweHAwOTNZODdMY3puUG1YOTY3djB2elc5dnRESC9BSmtQNWFvL3cxMS95VzE0ZStYZS9uSFZmajkwZkJUZTNtaFQvd0F4eFA4QXcxUi9ocS9rdHJ3OThwL09lcS9IN28rRDlxeVVsczA5UmZoOW9pNk5KbUw4bVo3dnZPM25GNUpYWTI4TWR1S3g3SG5kVHU1NytXck9ibjZQc2VUVTFGUFhVc2xGVnRENmFacm9wR0hIN3pYREtSczlGcktJeWlwN0hGdDZ0dktNc1pxWWZoanR6Mis0Mi84QTVlcC9uRjF2eVcxK0gzejhYcC96bnEveCs2UGdvZHQrM2gvNWgveTlSL09KK1MydkQzejhVL25YVi9qOTBmQitscCt4NmMwdjF2d0tEb2RmTDFmMmtqODJUSEwvQUl4enNNTXgzTG0ydG5EYXZURlc2ZlY5WHZkVFhNbTY3T0VSMitwK2wrSVI4MXpXNmZMSDRoSHpTemxqOFFad0tXY3RoWHR0ZDBpRUZ6cDQ2bUViUXlkakpHNC9CNElXY29qTHRpM0p0emxoTjR6TWVwK1lkRzl2Ui8xSGIvOEFJNmIvQUFWeDhqYi9BQXg3SWRuODcxSCtwbC9GS1RvN1FIQ3gyLzhBeU9uL0FNQk9SdC9oajJRdjUzcVA5VEwrS2ZpOHlocDdOYVFHMnFrZ3BnQmtIeThVY2VEY2NjUHVBYkZ2SEhISHNpbkR1Wlo3bjdXVXo2NXR1KzR1NXEyeEcyL0xsc3VtWkhtUjl1cFhQY1NYRTA4SkpKM2svZFhGT3poK0dQWkR1WTlYdnhIRFBMMno4V2JySHBiaGJxWC9BQ2VML0JVNU8zK0dQWTErYjMveDVlMldsTEZhN1kxemJkQkhUdGZnWGlDTmtlWWpkamxBeFdzY2NjZXlJaHg3bWVlNSsxTXo2NXRUNjhjMXEyWXdaUHJ5cGJVWVB6cDdiWVpwSFRTMFZPNlY1TDN1TU1aY1hFNGtra2JTU3VLZHJDZTZQWTdlUFVidU1WR2VVUkhwbGcrMTZlSC9BREtuL2tZL3lMUEp3L0RIc2NrZFR2Zmp5OXNsREhiS0o1a29vSTRwQ01DWVkyTUpHT09CTFFGY2NNY2V5SWhNOXpjemlzc3BuMXpidzU3VllKWHVsZlEweGtjUzV6blF4a2tuYVNTUXN6dFlUM1I3SExqMUc3RVZyeTlzdkhmWjlPai9BSmpUL3dBakYrUlo1V0g0WTlqa2pxZDM4ZVh0bGpKYk5QamRSVS84akgrUlRsWWVFZXh1T28zZng1ZTJXRWx1c1hDaWcva1kvd0Fpbkt3OEk5amNiKzcrS2ZiTFA1YTFRSEdHQ0poL2lSc0g4QVRSakhkRFhNM0o3Y3A5cFNWbXpCdXdMVnBHRHg1S2tieWNTcGJjWXZIRlV5bWpiQkRnMkpnRFd0YUJnQUJnQUYxNTZmRHdkMk9xM2ZINm1VbDBuSDVydnNDeitYdzhISkhVN25qOVRGOTNxMjdjK0gwTi9JcCtYdzhHNDZqYzhXRW1vS3h2NWttUCs1YitSVGtZZURjYjJmaXdmcVM1amFKZi9CWitSVGtZZURjYnVmaThPdnZWWFdnQ3FmbURjY293QTMralFGckhDTWV4Wm1jdTE0c1Yxbm9NNXBYQmhrT2Q1eXRKY1FBM0U0amtNRm5MYnhtYmx5WXpNUlVKazFSZGgrYkxnUDdsbjVGamxZK0RraVplTFc2a3VWVkNhZW9telJPM2dOYU1mNzBBcEdHTWRqY1JNdnpKYW5IWndXcmJqRTdkZmE2eHd2Z3RUbXdSeVBkSy9MSEdTNTd0NUpMU1NWeHpoRXVTclhMcjNVdy9NcXYrVGkvd1ZubDR0UmhEeDU5ZmFva2pkRTZyKzQ0RnB3amlCd0l3M2h1SVUwUTNHMUQ4S1NYNjFwelJEeDVaZ0ZMY2tZdkhrbEorQ3k1SWhoSkx3Q2pjUThlV2JEWTNlbzNFTUh2eDNxT1NJWXlTOHQ2alVRd2tseDNmV3Bia2pGaytRTlViaUdFa2hPL2R3Q2pjUXpjN2lWR21Va3ZBYjBhaUdMNU1QVXFOeERKNytKM3FOUkRKemk0cU5SQ1hPdytLS3pjL0ZSWWhtOS9BS054RE56dnJSdUlTVGh0S2lzM3lFN0FpMGhSU0x1QVJZaEpJQVJXYjNrbjFVV2tFZ0lxZDZqUUpBM29NM3Y1YjBhUWdSTzNINmxGU2loQklPQ05LQnhSa0lCQlFkanNPOUVvMVVXeVFqWWR5RFFFRVloR1FDUnVRVURpcXl0ajhDaVUwQkJDcUtEdWFKU2djTm9SRk5keEc5VmxiWEEvRkJiWGZXcWt3MFkvZ1VZbUdqWFlLc1REUnJnNzRxb3ByaTAraUpNTldQNGhWbVlheHk0L0ZWaVlieHlmV3F4TU5HdUIyamVpTFpKZ3F6TU40NWh4M3FzVERlT2JEYXJiRTR0bVRBK2hWWW1HekppMVcySnhmWU5CK1dWNHNObGh0R3FxRTNTb2dCWXl0RS9UbWV3WVpCSm1hNE9jTnVMc2NUc3gyNGt5WWVkdTlCR1UzRTA5aGo4eUxVUi82aGsveXR2OEFOcHBjTTlCUGkwSG1IYWovQU5ReS93Q1ZOL20wMEorUm54VzN5K3RUditvcFA4cWIvTnBvWi9KVDRuSjVjVU9VR0N4UGM3SGM2c0RSaDhSRVZlV241U2ZFbStXa2J2OEEvWC8vQU9lLy9nSzh0bjhyNlhrM0h6TDFSTnBxbzA5WWJiSFJTVHNNWXFwcHZtWFJna2JXTmRHeHVJR0kyNDcvQUUyNmpiWi9LeGR2bFVseW5yWjNWVlhJNldwZWN6NUpIRnpuSG1TZHBYTkRrbkZwSFVrY1ZiWW5GNU1WWHpWdHh6ZzhpS3EvVksxYmpuQjVFVllSdlAxSzI0NXdlVEZXdE84clZ1S2NIa1IxYmVCVnRpY0hrUjFoSEZXM0hPTGVPdTVxMnhPMjhpS3U1RlcySndieDE1NHJWdU9jSGtSVjQ1N1ZiY2M0TjQ2ejFWdGljRzhkYmh4VnRpY0c4ZHd3VnRpZHR2SGNjT0t0c1R0dG83bDZxMjQ1MjI3TGw2cTJ4TzIyWmNHLzdTdHNUdHRXWEQrTXJiTTdiWnR5UFBGVzJPVzBiY2lsczh0bzI1RGlyYk03YlJ0eWJ4S3RwTzIwYmN4K3RzVFV6eTF0dWZJcTZtWjJsTnVaL1cySmFjdFl1WHFyYWNzL3hUMVRVbkxVTG42cHFPVVB4SXBxVGxqOFNLYWpsajhUOVUxTHlpTnp3NHBxT1VSdWVQRkxPV2szSTgwdGVXZzNMSGlwYTh0THJtT2FhbXVVaDF5YnhLbHJ5MmJya09hVzF5MmJybDlhbHRSdHMzM0k0WVlxVzFHMnlmY2ZWTGE1YjdUNDZlT1ZsN3U5dGJ0M0V2RHkrbHRkVWFhcGErNHkyMk9HRVMwVk0xNE5QYmJuSkk1ODlmRzNLSTJnQUVsM0JkUHF1cTVOY0x0N2ZrbmtlWG1PZVdNWlJqcGkreSsyZlhEMys2ZUNsaW9MOXFEVGtGcnJhaTVhZG1yS1c0RjJvSW9vb24wRU5YUFBMSzlsbmxES1hDZ3FXUlRiWFNQanltTm1PSTRjdXZxdUhiSEIzOWo1VjNOelgvbVkxaGxNWmVpb3VKN2UvaHc3bkhtL2R0cTY2OTdhN3RGMnd4dUVzTlRMREhOVlB5c2hoaGUyT1NTZVNGamlXc2U0TXhZd2w3aUExcGM0TlhjejNOTVBuZWoyK2RFVFU4ZXlvdVp2c2lJOFovMnpVT1F1cWZhZzdzYVVzUXYxOU4zb3JmSFNHNDFkVldhY3VNZE5CRzNBRno1QTV4YTBFN1E5clhZYmNxNnNkZGhNMXE5MHZvTno1YjZ6REdjcDJKcUl2OXZIczlYMmU5anBmMmwrOFdydE16YW90RTFaWFdxbGxyS0tyckxiWnErb3BQbUxmTytrcW14U3U2WmV4a3NibWgyVVk0WTRKbjFtR016RXp4ajBTeDBua1BWZFR0WTd1M3N6T09VUk1YbmpFMVBHT0hkNm41OVY3V2Zjai9SblNkMllhNnFoME5jV1VUN2ZkYmhaYmhUMGIveE9lT2xvekpMOTl6R1NTek1HYkljTWR5WWRaaGxOUlBHZlJMWFZlUmRWMDIxbHU3bXpNWTR4YzFuak0xSGJ3NzM2V2t2WjM3MDY3MHhRNncwdys0MTJuYmpDeXFvNnltc1ZjNkdhSjR4YStOem5OSmFkNEpBMkxNOWJoRTFxOTB1YlorWCt0M01ZeXgySnFZdVB2NHZSZGRlMk4zMjBKM0NoMHpxRWZJYWFNSnFxaXN1bEpYMFZhR0NSc0ErWG9wNHMxU1hTeU1ZT2c5MkJjTStVRVk3eDZpTW9tWW1LajlPeDFPcDZIZDZiUERiM05yS004NXJHT0V4TXovaWlhajZhOUZ2b2c5a1R5RGxZSkd4WFhLNFpnZjZ2MXU0N2YxMXhmbmR2OFh1bDZtUHkzMXZmcy84QUhpOVZ2UHRLOXliTjNEbysybHl1azhHcmEwUk5odFV0bnVBdUVyNmlLb25oNlVBeGE1aGpvNTNPY1hqREp1T0lWL000NmRWOFBwY2Y4bzNzZDZObWR1WXp5aVppTldOVkhieGV3MWZzY2VRa0ZPK2N4M2M1R2wyQTA5WGs3Qmp1YThuNmd1TDg3aDQrNlhwNC9MUFVkK0ZmK0xGeCswcjRMOTVyMzVEdTdBWHFuTkhjZmxwSytHc2hocVp6TzFsZkhiQkF5bWRISE9LajVpUU5kRkkxaGFBWEhabEx1U2VvNFdteDh2NVpaNlpuMGVtLzA3MzBydmw3UVBmZnN6MjZyOWUzaUt2REtWaCtYWlcybXJwWXA1OHBkSEIxbkY3V3ZsSXlSZ2pCenlHN01WeDQ5VkdVMUV2WGo1UzRUV1hGK040NWUwOTM0OGllMmxMM0NzZEpYQnRRMktTU0NpdGxWVnRoRlRUeDFrTEpKVzVHOVF3eXNjNW94eWs0RTRnZ1RQcVl4bmk3WFRmSjJFNHhPNXU2Y3Bqc3E2ZWZhL2FDN3RhZzdsM0R0UGFhbXJxZGRXMkYxVFdXcUMwMWpxdUJrZlFMM1RNT0RXdC9wTVdVaHh4eE93WUtUMU1WZHZVajVFNmFNWXp5NmlvbnMrNVBkMjk3OTZxOWlUeWRoamRLYmRkc2pBWE8vd0NocWpjQmlmMDFuODFqNC9XNU1ma25vZS9xNS83Yy9GNmIycTlvWHUvM3R0OWZkZTJqNnk5MEZ1cVJRVmMxdXRkVkl5R1owRWRVMktRdnlZU0NLVmhjQmlBVGhpVnJMZnh4N1pkN2UvdC8wV3hNUm4xbFRNUlBEYnluaE1YSGY0UHorK25zNStVL2FEU00rckpyUFgvSjB6ZXJQTmNyZlYwZEt4ZzNsOVVXdmhpL3VwWE1iemNGTWQvSEthaVhIUHlGMDI3RmRQMWVPV2ZkR1dNNFJQMHp3OXJEc0Y3UDNrTjM0MFlkUjJhaHJuWFNta2JUM1Nqb2FHV3JiUnp5UVIxYllaSldGclMvb3l4dWNHNGdZNFluQlhQZGpDYW1hbDJOMyszdXowbFlkVjFQTDNhaVp4akNjcXZzNHhMeXFUMmN1OE56N3QxZlpTaWxxNU80MURCODNWMlp0c3FqV3hSOU9LYnFPai9ONmVTZG4zcytPSnd3VTV1TlhmRDZYTC9RUFJSdFJ2Zm5QdVhYL1R5dSszc3QraWZZNDcvdjEyZTJ2eTkxT3RXMEF2anFIOEdxTXdvblZCcFJMam13d01nTGQrS3h6OFBIM1M0ZjZPOHUvd0R2Si83ZVh4ZmthVjlsL3ZIcmZYOTg3Y2FhbXJLelZtblN5TzcyNm50ZFU2cW81SGJjSjJIQnJRUVFXa09PTzNkZ3JPNWpFUk44SjlidGJueUgwZTN0NDdzOVg5M082L3k4cjRkdkMzejd5cDlyM3ZoNHozZXdXQzlVdFNMeGZLdW1vV3czT2xsb09teXJjOWpLbk5KbWFZV09qY0pYQS9jMllqYUZjWjEvc3piaG41Q2pmakdlazN1YjkrTVp2R2NkT3ErUEh1NGNmQjlUdGZzTCtSMTUwbFQ2emdwYnQrQXowcmJpMm9ObXFXczZEb3VybndrYzF3R1hidEFQb3NjM0Q4WHVscitrZkw0bXZ6bkgvd0RieStMaEQzaDdmVmZhalhkWm91c3FHMVJneXlRenhaZzJTR1FaNG40UEFJek13T0JHSXh3V3A0UGxmT2ZLcDh1Nm5QWW1kV252OFluakh1ZXBTVklISDZBcGJ6WXhZU1ZCT3diQXBia2pGaStVRGVvM0VNWkp3cGJVWXNIeTQ3T0NsdVNNV1Q1Z055amNReGM4azRuYVZHb2htNTRIeFVhWXZrSjNmV28xRU1ueWNHcU4weWUvRDRvMUVNeVNkNmphSHZBR3hCbTUzMUtOUkRON3lkaWpVUWh6dUFVYmlFT2NCOFVWbTU1Y1VXa3FLa3V4K0NMU1hPRGZpaXMzT3hVV2tsMkc3ZWpWSlVVaWNQaWd6Yy9IY2pTU2NFQ0o1cUtTS1NBUVExd1B4VWFNRWhCUUlLcklRQ0NnN2dVU2pWUlRYbHZ3UWFOY0hEWWpKb0tEc2ZpcWxLYTRoR2FhdGNEOFZVTU93K0NKU2dlU0lvTyt0VkthTmVEdlJGQjNORXBvMlREMUNyTXd0c25KVmlZYU5sNXFzMHRydjFTZ3RzcDRwYk00dFdUSDRoVm1ZYXNuVnRpY1d6SmdkaFZabUZ0ZnlSR2pKbk5WdG1jVzBkUjlhdHNUaTNqcUNPT3hXMkp4YXNuQjNxc1REWmt4RzBIWXJiRTR0NDZybXJiRTR0NDZnRlcySnhiUjFCSEZWaVlieDFRNHEyeE9MZU9wSEFxMjQ1d2JSMVdIRlcySnhieDF1Q3RzVGczanJRVmJZbkJ2SFdjY1ZiWW5CdkhXa2NWcTNIT0RlT3V4M3EyeE8yOGlLdTVGVzJKd2J4VjVIRlczSE9EeUk3Z0R2S3R1T2R0NUVkYzNtdFd4T0RhT3V3M0ZXMkp3Yk11QlZ0aWR0c3k0K3FXeE8yM2p1WHFyYkU3YmFPNUZhdGlkdHN5NURtbHNUdHRtWEVIaXJiRTdiWmx4NUZXMloyMnJMbWVhdHN6dHRHWE04MWRURTdUVmwwOVUxTXp0TkdYVDFWMU16dE5XM1gxVjFNenRMYmR0dTlOVFBLVzI2K3F1cE9VdHQwSE5OU2NwWXVnUEZYVXp5bEM2amdVMUp5akYxSEUvYW1vNVJpNmcvcEpxT1VCZFFOemsxSnlqL0ZmNHl1bzVSZmlnNXFhamxGK0tqbjlxYWw1US9GZlZOUnlrbTZqbnRUVXZLUzY2RG1tcGVVZzNRS2FsNVNYWFgxVFV2S1ptN1lqZXBxYTVTSFhYMVRVc2JUSjEwOVZOVGNiVE4xMDVGVFUxRzA1T2VEL2x2b1BzWjI0dSttZFEzR3F0MTRyNnlTYjVpMjFVOUJVc2hNOXNxMm1HZUdtcVI5NDBMNDN0TFI5MXk2blZkUE85RVZOVTlyeVR6ZVBMZHpQS2NKeWpLSWpoWENwbnhtSDBqVXZ1UGRzYnBEcXo4QnJuMEF2VmRVVnRReHJha0NXbnFMOVM2aGZUeGhzWDdadWFPb2cvYTVNUklYWURNV3EvbC8yT1A3THpvOHkzcjZ6N2t4K1ppbzR4OTN0aTUraVk3SHd6MjN1NUZkcFh6RGw3aFJVWXVzdHV0amJ1K2xmMUhQbmZEcWkxMVRJV3NoWkxJNTg3bWRPTU5ZN0I1Qkl3QlRxUHZSTVhYRDdZZHp5M0w4dm5zNVJqT1V4dXh3aU9NL2N6aWE5VjI3UDlkVmRaNUQ2WTdqK1ZmaWYzTHZvN2MzR21rcWU4WGFEVjFISUxuYjZPbEVncVpiWXk1aHpxVXNaREswTVpHV3lGcm10ZTB0d1hqYlZSbGpxamcvUy9NcHozdW4zdnkyVVR1VGpNVlBHSW11eXI0Uy9ZN0h2MVRaL0JmeVp0VmJYVFVsVWF1TjFLTFZYMVlpb3plOU9VRmRJNmhrRHcrRVNQcWpKK3p5L2VjVHZKWGM2dkNKNml2R3ZlK1QrVk91ei9BSkJsdVk1VE00WTV4RXoyeHB1STlsUGhIblJyVFZmWWIyMExQVjl2N2hWdGJwalZWK25zVkhYMWRYV1VyV1c2WDVlaWptaG5rYzJhS25rZTE4Y2NtWmpYTmFRUHVoWEhHTU43T283T3ozT0dPcDNlczhsNlNOM0tabmVxTTV1cG1LeW1ZdjAwKzVlSjlQcVRWZnRSYWdoMVJyS0hSVTh1cDdmVU91bW9ML1dXS2lvSUJUV21xbW9JcTdQMUtTS1IvVVl4a1pBYVg0QWNGMStvckhkN1BEZytrOGlqUGY4QUs0eGpjbkdmdlJHZmJNVk14RSttb2V2ZVgzZmZzSmYrMW5hcnNoVmF5aTF6ZTdTK1dsck5ZV3lwbW1qdU5WVlVFdEhEYjZHNE1rYytkN1pYdHFIUGpsYzVqYWNPZVE0aGRqb2RtODVuS0t4bjMzM1BBK2R2Tll4NlBIWjJOelh2WVRqbHFpdnV4ajI1VDRUUFpFZDl2Y1BNYUYrb3ZFWHN2ZDY3dVpxTFNtdHFmU2tseWpwckhiTlMzdVM3UEZycDNPbXJaTEZXVXo0K2svRDlyTzV6Y1hrbml1bHN4TXpOWTIreDgyM2RyRGF3NW05TzN4aXVNUnFudzQ5dCtEaHZyenlEOGk5ZjkxZExRYWpxMzMyR1MxeVIxT3U3VE15a3FhVituN1BQUGJXRDhQbGRVUVNTdnFwQzZTUjQ2clNXNEVabDM0MnNjY0ppT01jZVBxaDhYUFg3M1U5Vmh1N3NUdGJtTTQ0eGpVeGNaWlJFOXZidzhIWnAzQjBaYU5jZTRIb1d0aDdxM0t5Nm8wL3AyRy9UOXVxU0t2YlQzZW1wcWx6SFN1cUJWTW96bmZLMXNrYnFkOGhhQVE1bzJyeW9uaDJQMG5MQzl5SjFUd2pzOFhWeDVlZVVtbys1ZnVTYWFvZEsyUzQyRzA2eGRxRzlYaDBzVTFMVlUxTEZhNFdVMERLbUF0ZkZVUTFObGJKS1kzL2RjNHNKT0JYbzdXTll4SGpFL3A3bmg3bTdxM3NzbzRWTVI3UDlybnk3VUhjRHY1cmp1aDRYM3FyTDd0VjZPMDdxTHR0VjNGNzU0djZ4V2lnanE2Z3o5UTdtVk10RklSamk4T2R5SzgvRzhheWZSeGxVdjFmQ0xVT3F1MzNsRWZGS0tWamJSb2JSbFhkOVh1bzNrMDgrcnI3WDAxMXEyTXcyT2JUUnp0WXc4QTdEWmdydVRPWDNwNzNKbkV6OTZlOXdBOW0zdkYzYzdnZTQzb2JUMnRMamNKNlNrWlJ5VFhHb3FLdzFOeW11T2lLKzVWYmEycGtlWDFUWFRVMFVnYktYTmFXdHlnWUxzN3Y3RmVGUGU2di9BUHJUak9NVmpwcmg0eHg5cjdiNWxkMU5hOWpQTTY4OTErd2ZlTzlWK3IzM2kvUlZtazd4Wkw4YkRSQnRubHBwYU9LcXJxNFdxY1J5WmNvamlEbXVPYkg3cFdOcmIxUnhpbzhYSjVWME9QVVlSanZSRzN0OFoxOWx6RWNNYm5neTloZlYzY1M5K1hHdUk5VlFWTm50a05rdU03TFd5c2trb3F2cGl6Tml1RG80WC9LeVN5TmU0aVJqY1F3aHVKQVcrcXhxSTRmcHdlbDgxN1VZN2UzZUVZekU2WW52bkdNY2FtWjdKdnRlZDdPSGVudnIzRjhpYi8ybzdpVmQydlhiRzVXK3ZOeU9vNit1dVZQUFRPcEtPcUZReGx4ZktHWVRWTDQ4WThyU0Rsd3hhblViY1k0Uk5WUDZtZm1IeS9aMk9qMmM4Y05PZkNML0FCUnBpYitpWjdmZzl1OXNpMVM2SjgwTlNXN1MxZlZ0MERTVy91SGJvYVJsWlVtZ3JLV3g2bm9yVmFLdzArZm9PbEZERUdpVU56T2FkK0NkVHh3d21lMlhaK2JkdUo2RG9kN0tQOHpQRExWUGZNWTFHTi9RNG0rRVBkRHVacW4zZGJkbzJ2dTFlNmxaZkxCZDJWMGxaV210cklyaEhEVzFFVlJWUGtNazBEbVJsblJlVEdHc2FBMFlMbTNzWWpibUs3b24yMDdYbW1HT0hRNTdPaUl4d3cyOG9tdU9yS01ibS9UMk9aY0Y4dTAzdWlkek5hTXVsd0Z4dE1lcXJlMEM0Vm5RanQ5cjByUVZVY0RZT3AwbXNaVTFMcFFBM1k4azd5dXRPRWNtSjc3ZU52ZERzNCtTN2U5cC93QXpMZHlpKytvaU9EaHg3VTNlWHVYckh6enVGUGNidFhmaE5ucDdkV2ZOaXNyT3RjSktyVE5kV1ZvdUV6cENhc2lhSmoyaVl1NmVQM2NBVnk3L0FQMDY4Sy9XOWI1Z2pHT2l5dzBSRWJVN2NZekVjZnZZek9mSHZ1WWh6RHNlaUwvN2kvakgycDd4NjFxS2FtMUZvNjQzRFMzZGg5emxhQkhwa1pxNldac2ttM3FUUlFVajJrN1F5VjJKWFh4enkycG1QR0h6SFQ5WjFIbE9lN3RSMjdtR21mVmxVeE1lbXZyZm5kK3ZKVHVSM2Y4QWFGN2c5K0cxbGRiYTI3NnduWlo2YWhxYXFrcUlMVFFhZ2lwNGFQTlR2WkkwUHA2ZkxJd0VZNW5BNzFyWjIvOEFNcVY4cjZHY091eDI5ekc1aTVtUFZGMC9uRjdnZHdkVjl4OVUxV3I5WnlpWFVGWTdxVGxzYlltdHgyaGpXTUFEV3R4d0FBMkRZdXhxdmkvUFBOT3MzZXM2alBkM2Yyc3A0OTMwVjNVL0JmTUJ2UzNSaUdNbFFwYmNZc1h6RXFXM0dMSjA0RzVTMjRoaytVdVVhaUdicFFONmpVUXlmUHlTMm94WXZtK2txTlJETjh4NG42QW8xRU16SVR1VWJpRUY0RzlGWnVseDNJdElkSU9LalVRemM5UnFJUVhmVW8xU0hTRGdpc3k3RkZvaVFONmlwSnhScExuZ0RZZ3pMaVZGUVhjQWpWRW9wT2NBaTB6YzdIZHVSVWsvV2drbjYxRkpGQ0JGMkc3ZWkwV0pVVmtEajhVRnRmanNPOUJTQ2c3SGZ2VlNnaUJBdzdENElsS0JCM0tvYlhGcHhDRFJzZ093NzBTbEloaDNOVktVSGNrU2x0bDVxcFMydUIzSWlnN21pVW9PNUlsS2JKZ3FsTEVnUkZCNkpUUnNwK0lWdG1jVnRsNUsyeE9MUnN2TlZLV0hEaHZSRnRrSTNwYk00dEdUSGdjUXF6TU5XVHEyek9MWmszTlZpWWFOZU9DSTBaTTVxdHN6aTFaVWpqdjlGYlpuRnRIVThpcmJFNE5XVlE0cTJ4T0xWbFR5S1d4T0xabFU0SzJ6T0RabFlPS3RzVGcyWlZBN2lyYkU0dG82c2ppcmJNNHRvNnptcmJFNE5vNndIaXJiRTRObVZmcXJiRTRONDYwamlyYkU0Tm1WdzRxMnhPRFpsYzNtcmJFNE40Ni9rVmJZbkJzeTRIbXJiRTdiVmx4OVZiWm5iYlIzSDFWdGlkdHZIY2p6MksyNDUyMnpMbnpWdGlkdHRIY21uaXJiTTdiWmx3SEFxMnhPMjFaY3VUbGJabmJhdHVSNXBiRTdiUnR6OVZiU2R0b3k2ZXF1cG1kcHF5NmVxYW1KMm1yTHI2N0ZkVE03VFJ0MXdWMU04cGJicU9KVFVuS1VMcU9hdXBPVXNYVWMwMU04cGJibzNjQ21wT1VvWFVmcks2azVSaTZEOVpOUnlsZml2OFpOU2NvQzY0OFUxSnlqRjFQTk5SeWovRlhmcmZhcnFPVVg0cWVhbW81Ukc2L3hrMUx5aS9GZjR5YWpsRWJxUDFrMUx5aU4weC9TVFVjcEJ1cmVhbXBlVWgxMUE0cHFhNVNYWFVGVFV2S1E2N1liaW1wZVVoMTEyYjAxTmNwbTY2ZXFtcFkybVQ3cC9HMnFhbTQybVRycHd4VTFOY3A5bzl1SHZmcC9zTjVGM0x2SGYybDVvSTdUVDBJZkRVendPbnQ5MWh1N281eFJzbG1hMlJqY0E1c2J0dUdPemF1cnUxbE9VVE5YSDIyN2VQV2ZrOHRqT0l2VGxPVlhFWGVNNDhKbmh3YzdPNmZ2SWVQK2xlMFhjZTdhYjB4YnJCcXp1TlQxVkJxMnUweEZxRDhRcklhb3psOFZORGQ2U0NrZ2tsK1psL2FDWDg5NWZrYzc3cTYwZFBqRlhsY1IzY2Jlei9WT1c5cXgyTm1NZHpQdHluTEdZOExuVE16TlI2UHByaTlYOE8vZUIwM2J0QTZsMC8zY3NkRmNkSTYvZ2diZWFDcFpjbVcrb2lwb3ZsS1lzbnRNTlRVUlN4MGpZb0hneFpUMG11RGc3RUxsM29qZm1NcjB6N25pK1NlWi93QW53ejZhY05lM2M4Sm1JbUpudDdhaVltYm50dmpWVTlQOHdmZFQ3YWR5cmpvcng5N2JXS0doMExhcW1LcC9EN1pGVzFFVk5SeDNPRzdWbFU2YTlOaHFxbW9uZEFJeG5pYTNBdU9aNVAzVzFXMVBicW1lMmZlNWZOZXR5Ni9ZalRoRzF0YmQ2WXVPTXpFNHgrendpSXUrRXpMNi9hUGRkOGViUDR0LzZyOWRwRzJWdWtYdGlySyt1cVJxOFRWVjJqWXdtNVNmMEF1RXBsakVtQWZnQ01GeDVkUEU1WHI0K3FYbzdIelp0N2V6R3pHeEdtcXJWaFgxdURuWVR5bjAvcWZ6VjFUM2wxdFdWMTQ3UE9zOE5oczFMY1dWVHkzK2swTG5QYzJrNmxUQ3lwaG9aV3VNWUxoMWNDTUM1Yzg1M2xQR2VNVkR3OHRqYjZQYTJjWnd4bVkzTldVWFVURWF1Rnp3bXB5anQ0Y1BVN0FPNGZ2QytML2RPeTJMVCt1KzNkb3E3UnB1bU50czhEWmRad05wNlZ6R1J1aC9ZVzltWmhiRzBFT3hHeGRiSHB0UFpuN3BmU2Juelp0NzlhOWlKcWJpOHNKcWZhOU8xdjdvSGpyM0I3dk83bGFzc3NNOUE1MXZKMHpIU2FoaXN6b0xaUXVwSUk1SjRxWnRVNTRrZDFjcGdNWndBTHNkaTVZMjRqYjBSbDJ6NE9ybjV4enV0eDZqTGJpc2NhaU5XTjNkMzRlKzNuZDdmZHg3TmQyTy91aFBKS0NqaTAvM1AwTlVDV2txN1BUNmxuRmZDSTN3ZktWcmFpbGdhS2N4eXlnbHJaSGd1R0RUdzRJNmFPK1h2ejh4VG5sRTQ0UkhqOTZPendlcjkxZmNpOFllNWZkNDl6Nnl5UVVGUFdUeFZ0NHNOQkZxZjhNdWNyWkpKWnpVeUdtamxpTWhlMDRReE9hNHRPZkRIYnlZN2N4ak9OOXJ0UjErM3Via1o2WWl2VEQ5blZudSs5bWF2eXAwbjVYNk90dFBZTmU2ZmdyYUN2bzZHTFVzOUJlYWVxcG9LUmphenJVc1pqTU1VT0Vib29ua2svZXdHMWNjZE53cTN0YlhXYmVYZkVNdkdUM2lleXZqWHEzVi9jUzMyeUxVT3ZOWlZFbFZjcnpmNHRRMDlVMXRRR3pWVU1iS1NscVltd3lWZlVtWU13Y0d1RFNBUmdHZlQzMlM5VEhMWjNLL3pJaVBwZXRlUG51aCtMM2pqM2kvMHRhUzAxU1ZWVGJUVS8xVnROVXpVa2RIWVcxUW1oYzJoZTJsbGtrSHkweGhKbFkwZ1k1ZGhXODltY3NZaSt4N081bnM3KzFodHp2ZnMraVh0Ny9lcjhXN2RycTlkMTlPZHRyTFNkMDcxRmNJcWk4R2JWa3BFbHpiaFVTQ0dXZ01ZYzhnRWtOQldQeXN6RmF2cldPaTJzOEl3bnFQdXgzVmxYMVBWL0VMM2lleEhpTlUzWFVHbmROVXQ4MXRkWUk3WSsrM2NhZ3BxdGx2WlR3Um1rYkZUMHRSQ3lQcXdkUVpYWW5IYnR4WEp1OVBybnQrdDYvbXV4c2RkdWF2ekgzWWlJaUp4eTRWRVI0VEhjOGJVM3ZuOW0relhhNjlhUjhhTkMyM1FseTFERTZockx6WW0zS2F2ZEUvN3ZSanFiekZCMHNRNGhybXRrTE1jV3N4VS9MUkg3VXpMclpkRjB1TXhsdjcrVzVHUFpqRVQ3THk3STlVU3J3eDk1UHNWNHA2Y2ZWMnJSTkZXYTVyNmQxRlZWMXhsMUFKNmVqbEREK0hzRlBTMUVQU2pMQTBPWTdGNEFKMnJlOXNjeWJ1bzhIZTg0MnRqekhjalBuYU1ZaUlqQ1l5blR3aUtqaE1kMzB2aGxSN25QYkRRM210YWU3SFk2MEN6MDFvUDQxSFFVVU5WVTA5dWQxS2RzY0VJdWZSbm1qSWlsRXJUa3diT1N3NWdGclRFNDZKbStEbW56RHArVEhSNTdrNXhPTTNsRWNZNHhPTlJOVE1SWHNuZzVHOTd2Zkw4ZVo3VHJEdXRwVFJsc3NuZW5XdHFxYkhmOVMybVM5ejFvcHF5bVpTem1HRzZVbE5SeFNQampZMHlGNVAzVzRoK1VCY0VkTlhiUEI1Y2VYZFB0WXh6ZXAxYldNM3B4aksvVDJ4RVJkY1ordDhnOEFmZFE3SjloYWNkME5WYU1vN2xydXJncWFha3A3aCtMeFFXK0NwcXFvbDFNYmRCVU1rNjFITkRFOTBnYThkUEREREJjMjd0ODJJNDA5UHpUcWRyemJiMjVuZDVjUmQ0MU14MnpVOEw3cWpqeGZyV2IzUnUyK2l1MmZkZnN0MjdsbHNYYWZ1bFZVbFhXMnVpbzd0TysxTWl5UTFOUGI1S2xqUytHcHBZbzRIOVV4bGd6dVlDU0ZuOHRGeE16Mk9MSG9laHkzTnJQYzM1eTB4OTc3czhhdXE5SFpFM1had2U1M3YzaXZIaXE4S1ovRGFIUjF1bzlKQ2luTlBkNDVOVHVxS2U4eU5kS0xzR21pYVhUTnFuZGZBeUFGMjg0TE1kTk1UZXJqOUxwNGVYN1dPOXpmelgzcnU5T1YvVTZpdklQWDloN2pkNWRRYTMweENhZXczS3ArWXBvaTFyQ0dtTm94YzFtd0VrRWtEaXBsbGMyL05QUE9veDZuck4zZHc0WTVaVE1lMTZTK2ZtY0ZtM214aXlkVURncGJVWXNueWwyOUdvaG0rVURlbzFFTW56azd0eWx0Uml5Zk45SlJ1SVpQbHgzbjZGR29obVpDZmdvMUVJTHdFVkRwU2QyNVJhWnVrUzJvaERwQ28xRUljOVJxa09rUlVPZVNpMGtubW9wRjNKRnBEbmdJcUhTRTdsRnBCZHozb3RFWEVvdEVTQW9xSFNBYkFpMGd1SjM3a1ZKS0tSS2lrZ0VDTHVBUmFTU0J2VVZPY29NMGFNTzVvbExhLzZRaUtEZ1VERGlGVXBRY0NoUVJBZ1ljZUtKU2dRVlVNUGMzY2d0c29POUVwWVBKRU1PUEZWS1VIY2tTWVcyVWplaVV0cndkMjlWRkIzTkVvdzdraVVwcjhGVXBZa0JSRnRlaVV0c3BWdG1jVnRsQ3RzemkwYkx6Um1saVJwVlJZa1B4Q0pTMno0SzJ6cGFNcVQvdEpiTTR0V1ZJNXEyek9MUnRRRHZWdG1talplUlJtbWpKM0Rqc1Z0SnhhTXF1YXRzemkyanF1UlMySndhc3F1YXRzVGcxWlVqZ1ZiWm5GcXlxY054eFZ0bWNXekszbXJiRTROV1ZyZWF0c1RnMlpXY2lyYk00TldWeDVwYk00TldWeXRzVHR0R1Z3NXEyek8yMlpXK3F0c3pnMVpYdUhGVzJKd2JNdUI1cTJ4TzIxWmNBbHN6dHRXWEFjMWJZbmJiTXVQSXEyek8yMGJjanpWdG1kdG95NVlKYk03YlZ0ejRZcTZtWjJtamJwNnE2bVoybXJMb2VCVjFNVHROVzNVODAxTXp0TkczVUs2bWVVdHQxSE5OU2NwWXVyZWF1cE9VdHQxYitzbXBubExiZEIrc3JhVHRxRjAvakpxVGxyRjBQNnl1cG5sSCtLK3YycHFPVWY0cWVhYWs1Ui9paDVwcU9VZjRvbW81Umk2a2JNVTFKeWovRlhjMWRSeWlOMEo0cWFqbEovRlBWTlM4b2ZpaDVwcU9VUnVwNXBxT1VSdXY4QUcrMU5TOHBKdWgvV1RVdktTNjZmeGxOUzhwRHJvT0xrMUx5a091cmVKVTFOY3BCdXJlQlRVdktRNjdESGZ0VTFMeW1UN200NDRQOEFvd0NhbW8yMmI3bEordjhBWUZMYWpiWXhYR1drcUgxVkhPK0Nwa0RXeXZnZTZNdkRkMmJJUmpoanN4WEhsaEdYYTU4YnFxaVk5TVJQMXhKM1crMWw1a2lsdXM3cWg4SCtLNnYzZ3c3c1FEc3h3NDcxSXhpREhIVEZSRVJmaEVSOVNMVHFHNDZmWkpGWktoMU5GSzR2a1pEOTFwY2Q3c053SjRrS1RoRFdlTVoxcWlKcnhpSmVDSjJ4MXY0bEc0dHVRZVpoVXRKRTJkd0xTN3FENzJKQnczN2swUlZPV01wN09GZUZSWHM3RzFWcVM4VmNENldxcnFpU21rQmJKRytlVXRjMDdDQ0Nkb0t6eThTSWlKdU1jZjRjZmc4V2t1azlzbGRVVzJkOU5NNXJZM3VwM09qTG10eExRY2hHSUdKd1ZuR0phN2VFeEUrdUluNjdiUDFqcUxoY3FuK1hsL3dsbmx3MUdNZmh4L2h4K0R4VzZtdmNENUpJYTZvYStRNTVDSnBQdk93d3hPM2ZnRk5FT1cvUmovREh3WlNhbnZqcHhVbXVuTlFHbGpYbVdURU5KQkl4eDNFZ0pvaHlZN2t4M1I3SStETTZudmpaWFRpdW42cmdBNTNWZmlRTjNIMVRURGtqZnpqdzlrZkJoUHFHNnl1ZVpheVZ4a2JrZmpJODVtOGp0M2JWTk1PV09xM0k3L2RId1E3Vk43YU1qYTJiS0JoaDFIZmxVcUhMSFc3M2o3bytEQnVwTHpDM3B4VmNyV0RFNEI1M2s0bEtjdVBtTy9INzMxZkJuTnFTOFNzTWN0WEk2Tnd3Y0M0a0VKVGsvbWZVZmluM0lkcW05RFo4NUovZkZSdVBOZXAvSEw4KzRWcHVVZ21yM2RlVWJBNlVCeEErbFNZY2U1MXU5dVRFNVpUTk52NjE2Z2FNcmF5VUFiQjk1TDlMc3g1cDFQNDVlQ3k0MUZQY0Jkb240WElPTWdtd0dmTVJnVGo2cU9MSHE5Mk05Y1pUcVZlOVNYVy9GdjR2T1p3emF3T2EwQUhtQTBBWXBNMjN2ZGJ2YjBWbGxNd21EVmwvb3FkbEpSMWNrZE5HQXhrYkNBR3RHd0FCUzZjMkhtRy9FVkdVc3pxMi9zeVlWa243SWwwZTM4MGtFRWo2eXBjdFI1aHYvaWxuWGF4MURYMHo2T3JxNUpLV1FaWHh1SUlJUEFoSnlueFhMcjk3S0tuS1g1cjUzSGpnbzZsTW5UZ2J5bzFFTTMxT0c1TGFqRm0rcHg0L1VwYlVZc25WQ2x0Uml6ZE1UNnBiV2xEcENkNXdVV2tHUm9SVU9seFVXa09rUzJveFE2UlJxSVE1NmpWSWRKeVJVRnhLTFNTY042aWtYSXRJZElCOFVWRHBDVkZwQmQ5YUxSRnhLTFNTUUZGcExwZVNMU0M4bmVpcExnaTBST0tpaEFrQ0xod1JhSXU1cUtrdjVJSUx1ZTlBc3lMU0E0aFJxakRnVlVvMEREdWFKU212UkZCNEtDZ1NFRkJ3VlNnaUJBdzRoRXBRSUtxR0hGdTVCYlpRZDZKU3dRZHlJWWNlS3FVb081SWxLYklRaVVzU05LcUtEL3BSS1VIaENsQjVWWnBRbDVvVW9Tb2xMYkp5K3hFcFFtS3RzemkwYk1yYk9sYlp2cFJtbGlWcFZSVFpEd09LSlMyemtlaXRwcGFNcUR6UzJaeGFzcVZiWW5GcTJvQlZ0TksyekRtak5MYk9SdUt0cHBhTnFuRGVsczZXamF6NjFiWm5Cb3lzNFlxMnpPRFJ0WjlTV3pPRFJ0WUZiWm5CcXlzNU9WdG1jR3JLMXlXeE9EVmxkelZ0bWNHaksxdk5XMlp3YXNyY09LdHN6ZzFiWG5tbHN6ZzBiY1A3TVZiWm5iVzI0RG5zVnRtZHRveTREbWxzenR0R1hEa1ZiWm5iYU11RHVhV2s3YlJseWR6VnRpZHRvMjVLMm5MYU51WUc5TFpuYlcyNWptcnFUbExGMEhOTFo1YW0zVCtNcmFjdFl1aC9XUzA1YTIzUTgxZFRQS1UyNW5tbXBKMmxpNkhtbXBPVVl1cDUvYXJxVGxLRjJJNC9hbW81Ui9peDRsTlNjb3hkZlZOUnloK0xIbW1vNVJpN0htbXBPU2Y0c2YxdjRFMUhKSTNZODAxSEpMOFdQTk5TOG9qZGZWTlJ5Z2JzZWFhbDVTVGRqeisxTlJ5aU4xUFA3Vk5TOG9uWFE4MDFIS1FibWVhYW11VWgxMFBOVFV2S1FicC9HUzE1YUhYVCtNcGJVYmFYWFFjMDFMeWtHNWptbXBlVWgxelV0ZVd6ZGNqelMydVd6ZGNYYzFMYWpiWnV1QjVxVzFHMnpkY0J6UzJvMjJicmdPYWx0UnRzM1hCUzJ1V2gxd0tXc2JiSjljZWYxS1cxR0ROOWFPSlV0dU1HVHE0Yy9vUzJvd1pPcmlwYlVZTW4xcnVlQ2x0Umd6ZlY4eXBiVVlNblZnUzJvd1E2cktsdFJneWZWOHlwYlVZTTNWYVcxR0NIVlI0S1cxcFp1bngzbllqVk0zVkRWTFhTemZVNGVpbHRSaXlkVTQ4VXRxTVdicWoxK3BTMm94WnVtSi8yVkxhMHBkSnpLTFNES0J1UmFRNllxTFNIU3BiVVlvTXFsdGFVT2s1cU5VbDBxTFNES1R1UmFTWEhpaTBSY0ZGcEpmaDZJVWgwb0c3ZWkwaHp5VkZwSmNQcFJxaUxpVVdrbHdDaTBoMG5KRnBKY1R2M0lKTHVTaTBST0tLU0EzSUVYY2tXaUx1YWlvTCtTQ1M3bnZRb2k0bEZva1VzUWdsUm9JR0hFSWxHSEFvVWFxR0hGRXBUWDh2cVJGQjRPOUJRSkc1QXc3bXFsR2lCQXc0aEVvdzRJVW9PSTNGVkZDVThVU2xDUnBRcFFkeUtKUmgzTlZLVUpPUlJLVUpTTjZKU3hLMVZLVUg0N2tTakQwS1VIbmdxbEtFcDRvbEtFb1JGdGs1SWxMRXhWdEp4VTJaVzJaeGFObjlVdG5Tc1RBNzFVcFFsNUZFcFFtUEJMWjByRlFRcmFhVnRxanpTMG5GbzJyS3RzNldqYXNGTFowcmJVQlcwMHJiT09CUktXMm9jTnhWdG5TMGJWRWIwdE5DMjFnK2xXMlp3YU5yZlg2MWJaME5HMXZCTFowTGJXLzJCVzAwTGJYZXFXem9hTnJ6elZ0bWNGdHJ6elMyZVcwYlhuNkZiVGxyYmNCelMyZVcwYlhqZ1ZiVFEwYmNPVGxiWjBMRnhQUEZMVGxxYmNUekNXazdhaGNTcmJQTFdManMyL3dBS1duTE1YSWMwczVheGNSelZ0bmxxYmNoelRVazdTeGNmVlcwNVppNS94dnRUVW5LTVhMK01sbkxQOFRQNjMycGFjc3hjenpUVWNzL3hOM05OUnl6RnpkelYxSnlqL0UzYzAxSEtING03bW1vNVEvRXp6VFVjb3Z4TjNOVFVjcEp1UjRsTFhsbCtKbjliN1UxSExINGtmMXZ0UzE1WmZpZjhaTlJ5aU55NFk3UGltcGVVazNJYzFMT1dnM0ljQ21wcmxKTnhTMTVhVGNod1V0ZVdsMXhQMGZGTFhscE54UE5MWGxvTnhQUDZsTFhscGRjRCtzbHJHMnpkWGc4ZnRVdHJRemRYam50UzFqQkRyZ0Q4VkxhNWFIVjUzSmE4dG02dlBOUzJ0Q0hWeDNFcGJVWU0zVndPODRxV3VoRHExTGEwSWRXOEZMWFFoMVpqdktsdGFHYnF2MVMyb3dadXFqd1V0clNoMVNlYVd1bG02cEhFcVcxcFE2cUNXdWxtNnI5VkxhMG9kVmxMV01XYnFrODFMYTBvTTdpbHRhVW1VODFGcERwaHhPS0xTVE1PQ2kwaDAzTXBhNlVPbFV0cU1VbVZMYTBvTW9VV2tPbVJhU1pDVVdrbHg0cUxTUzRjRVdpTWdDRklNbzRJdEpNcmlvdElMMFdpTGlpMFJjRkZwSmxBM0l0SU1oS0trdjVsQWk3a290RmlTaWtnQ1FONkJGM0pGcEpjQnZVVkplZUNDUzc2U2kwa3VKUW9JcEZ3NEtMU1NTVVVJQkFJQkFJR0NRZ1ljT0tKUnFvWWNRaVVZa3dRcFFreFJGQjRRUE1WVW93NGNVS01FSGNpQkF3NG9sR0hjMEtNTzVGVkZpVnczb1VvU3RPOUVwUWNPQlJLTU9QRlZLTVBSS1cyVncrQ0pTaEtPS3BTaElPYUpTZzdtaVVZZWlVb1NsVktVSlVLVUprU2xDWDFSS1VKaXJhYVZOblMyWndXMm85VmJUU3RzNEtXenBVSm1xcFNtemNpaVV0c3gvMmt0TksyMUpDdHBwVTJySTRwYVRnMGJXZlVyYk9oWXJCeFMwMEtGVzBsVzAwcUZTMG5ZbHBwVzJwMjdDbHBwVTJxZHdLdHBwVzJyY09LV3pwVTJzUEZMVFF0dGFyYVRndHRkczNwYk00TGJYK29WdE9Xb1Y2V25MVUs1VzA1YW0xL3hTMDVhaFhubWxweTFDNGNpcmFUdHFGd1BOTFRsckZ3UE5MVGxxYmNUejJLMm5MUDhSL3N4UzA1Wmk0NHBaeXovRVVzNVppNUZMVGxuK0lwWnl4K0lqbWxweXgrSWptbG5MTVhGbzQvd3EyY3MveEp2UDhBaFN6bGtiaTNudFVzNVpmaUk1cFp5eCtJam1scnl4K0lwWnkwbTVKYThzRzRrN2tzNWFmeEgrekZMT1dQeEZMT1dsMXdkanZVdGVXazNBODB0ZVdrM0E4MHRlV2wxZjZxV3NiYVRYK3FXdkxRYTRZcGE4c2pYYkZMWGxwTmQ2cGE4dExxNzFTMWpCRHEwODFMWFFoMVpqdU8xTGEwSU5XVHVVdHJRazFaTzRwYTZVT3FpZDVTMTBvTlVPSjJxV3VsSnFnbHJwUWF3S1d1aEpyTmlXdWhEcXoxUzEwSWRWZXFsdFJpZzFEaWx0YVVHWXFXdWxKbUhFb3RJTXdSYVNaMUxYU2t6cGE2VUdaUzEwcE0zcWx0YVVtWlJhUVprV2ttWWxGb2pJVHZRcEpmNnFMUkY0UmFTNlVEaWkwZ3pjbEZwTHBDZDZGSkwwYW9pNG9Va3ZBM3FOVWt5amdoU1RJU2lwTHVaUW9zM0pSYUlrbEZKQUVnSUVYY2tXaUx1WlJhU1hqZ29KTWhRU1hvdEVTU2lqRUJBaTdrb3RKSkozb29RQ0FRQ0FRQ0FRQ0FRQ0I1aWlVWWNPS0ZHQ0R1VlFaaWlVb1B3UXBRa1JERHdVRkJ4NEZDanpjMVVvOFFpVUVEeElRTU81b2xHSERnVlVwUWtjRUZDVWNVU2xDUnZBb1VZZWlVb1BWU2pFbUhGRXBRbWQ4VVNsQ1ljVlNqRW81b2xLRWlKUmg2RktFaUpSaVVxcFNoTWhTaE1FU2xDYjFSS1dKaXJhYVZDbzJwYk9oVGFrcTJtaFFxZWFXbWt4VU5LV2xLRTRWU2xDZjFSS1VKanZ4U3pTb1ZEaDhFdE5LaFZPQ3RwcFUyckkyWXBhYUZ0ckZiWjBLYldmV2xwb1VLd2NVczBuODQxTFRRb1ZiVHhWdE5KaXFHNEpacFVLa2M5cVdtbFFxaWR4UzAwbUtzajlKV3pTb1ZidWFXbWxYemp1YVdtZ0NzZDhVczBLK2RjbHBvSHpwVnMwRDUwcFpvUDUwcFp5eDg4ZU9LV25MVjg4bHB5eDg5aHVLV2NzL256elN6bGo1ODgwczVZK2ZQTkxPV1h6M3FsbkxIenlXdkxTYTV5V2NzZk9sTFhRWHpwU3pRUG5TbG1nR3RLbG1oSnJEaWxyb0kxaEtXYUVtckk0cGE2U05XVHhTMTBwK2J3NHFXYVNOVU9hV3VsUHpZUzEwSk5ZM2dVdGRCR3NHQ2xtaFB6aVd1Z25WbklwYTZFR3MyNzB0ZENEVm5tcGE2RW1wY2xycFNaM2NWTFhTa3pZY1V0ZEpHY2MwV2ttY0l0Sk5RQXBacFNhbExYU2sxSHFscm9TWjFMWFFremVxVzFwU1psRnBKbkNMU1RNU2kwa3lPS0ZKTC9WUmFJdkNMUkdRQkNrbVlJdEpNM0lLTFNUTWVhRkpNaUxSRjZMUkYvcW90Sk1qVVdrbVhraFNTOG9wRndSYUl1UEJRb3NTVVVrQm1DTFJaaWhTUzdtb3BGL0pCSms5ZnFRcEpkeVJhTEVsRklrQkFGM0pSYUxNVUtKRkNBUUNBUUNBUUNBUUNBUUNBUUNBUUNCNWloUUR1YUpSZ2dxb2VKQ0JoNkpTaEovWVVTbEI0NG9LRHVSUU1PUEZWS0dZSVVlSVJEUUdZb2xIbVFvdzlDakVqdUJWU2xDWThVU2pFcmVLRktFZzRGRXBRZXFsR0hvVVlsSTRvbEtFeCtLSlNoTU9LcFNoS09hSlJpUUlsR0hvVVlrUktNU25taFJpVnlxVW9URkNqRTZKUmljYzBLVUorUlZ0TktoT2R5V21sUXFDbHBvVUtrODFiVFFvVktXenBQNWtKWnBNVkRmcFMwMHlmekEvc0twU2hPT0JLSlJpZkhpbGxIMS9WTFRTWW5PR3dwWnBNVkR1ZjJwYWFWZk12VnMwbUtwNldtZ3hWdUcxTFRRZnpya3MwRDUxM0ZMTkIvT2xMTkErY1BOTFRRWXJFczBENTdEY3JhYUQrZVBFcFpvSHozcWxtZy9uZlg3VXMwRDUzMSsxTE5BK2Q5ZnRTelFYejNxbG1nZlBGTE5CZk9wWm9JMWg1cVd1Z2ZPSG1sbWdmT2xMWFFYenJrczBENTF5V2FDK2JLV3VoSnFubExOSkdwZmdscnBJMUR1ZjJxV2FTTTU0bExYU1hYOVVzMHArWTlTbHJSR2NjMEtMNWdLTFJHcGJ3UzEwa2FrSlpwU2FuWnZTMTBwTlNjRkxYUVJuS1d1aEpuUE5MWFNrejh5cGE2VW1jSXRFWjBLU1ppVVdpTXJ1YUZFWkR4S2kwV2RDaUwrYUxSR1FJVWt6RG1pMGt6Y2tXaU14VUtTWkNkNVJhU1hvdEVYcUxTVElFV2lNbzRJVWt5dVJTTWg1b1VrdlVXaG1LRkZpVVVrQmlFS0xNRVdpTGloUkZ3NGxSU01nQ0NUS2Y5cEZwSmVTaFJZa29wRWdJRVhjbEZvRWtvcElCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQVlrSUhtS0pSNWdoUmc4bFVQTVVTakVoQ0ZHSlVLVUpBVVF3OElHSEZWS1BNaFI1Z2hReENJZUpRR1lvbEhtNW9VWWY2cWxLRWpodUtKUmlZOFVTbENWdkZDakVvNW9sR0pQVkNqRDFVb3hJVUtNVEhtaVVvVEZFb3hOekd4Q2pFdytDcVVZbUhOQ2xDVUhpaVVZZmloUjUwS01TWWJpaVVZbGR6VktIV2R6UktQckhraFJpYzhVS01Ub2xHSndoUmlvSE5MVFNZcVBWTE5KaW9QTlcwMG1LZzgwczBtS2dwYWFGQ3BJM0phYUI4MDdpVXMwSDgxNmxXelFQbXZVcFpvUDVzcGFhQjgyVXMwRDVzcFpvUDVyMVN6UVBtdlZMTkIvTkJMVFNQbWh5U3pTUG1oeVN6U1BtaHlTelNScWg4RXMwRDVyMVMxMEQ1cjFTelFYelpTelFQbXlsbWdqVkZMTkErYTlTbHJvSHpYcVVzMEY4MDdtcFpvSTFCU3pRUnFEOEV0ZEJmTUZMWFNScU1ONVN6U1JxTWVLbHJwU2FnYzB0ZElNNkZGMTBLSXpsRm91c1VLTHJPNW9VUmxQTlJhSXllcUZFWG90QXlCQ2ttVWMwS0l6RG1pMFJtQ0xSR1lxRkpNeDVvdEVaVHpRb3VvVVdpem9VUmt3NHFMU1RLM21pMFJsSEJDaU1wUmFTWkR6UUl2K2xSYUxNaFJaaWkwUGlnV0lRTE1FV2htS0ZFWDh5b3RKTHdnUmtRSXlJdEpMeWhRekZDaUpIRkZMTUZGb3N4UW9pU2Q2S0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VCaVVEekZFb1prS1BNRUtNTzVGVktQTVVTakVoUW94S2lVb1NBb0dIamdVRERpcWxIbVFvOHdRb1loRU1Ia2dNeFFvWmlpVWVkQ2p6b1VZbFBOVktNVE9Rb3hNZUlSS01UQkNqRXJlYUZLRWdPNG9sSG5WS1BPVVNqRXBHNUVveE1lYVdhUjF6elFvK3Y4QUJFb3hNaFI5WWNsU2o2dzRvbERyQkNqNnJlYUZHSlFkeUpRNmdRb3cvaUVLUE9oUXpvbERxSVVmVlBOQ2gxVHpRb2RVODBLSFZQTkNoMWp6UW8rczdtcVVPczdtaVVPczdtaFE2enVhRkRyRkNoMW5jMEtIV2R6UW9kWjNOQ2gxanpVV2k2cDVvVU9xZWFGRHFubWhRNnA1b1VPcWVhRkYxRUtHZENoblJhTE9CdlFvdW9FS0hWQVFvdXNPYUxSR1lJVVJtSEJDaDFoeVVXaU02RkYxMEtMcm5taTBETWVhV2FVbVFsQ2lNbk5Gb2pJb3RFWlJ6UW9qSzFGb3VzRUtMcWxDaTZwNW90SjZucWkwUmZpb1VNeUZGbUtGREVvdEVUelFHSVFvc3dSYUdaQ2lMaWkwUmNPSlVDTWdDQ1RMeVJhSXlFb1VXWW9VUlBORkxNRkZvczNKQ2htS0ZGaVVVSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBWWxBOHhSS1BNaFF6QlZLTU9QQW9VWWVVU2pFaFFveEtoUmlVSWhpUUZBODQ1b0huOVZTanpGRW9aMEtHWUlVZVlJbEFIa2dlSlFHWW9sSG1Rb0IrQ0ZHSkNoUjlVODFVb3hNZWFGRHJGQ2o2eDVJbEgxdVlRb2RZY2tLUHJCQ2pFemVhSlE2bzVvVVlrSE5DajZpcVVPb2xtaytvVUtIVmNOeVdtaytzN21Vc29kWjNNcFpRNnp1WlN5aDFuSlpwUHJ1Q1dhUjEzYzBzMGpybm1oUTY1NW9VT3VVczBuMTB0Tkk2NkZEcnBacExybm1sclE2NTVvVU91ZWFGRHJ1U3pTWFdLV2FSMW5jMHMwanJPNWxMS0hXZHpLV1VPczdtVXNvdXE1TE5JNmhSYUxxSlpwSFVSYUl5am1vVVhWSE5DaTZ6ZWFMUU13UW91c09TRkYxdVFRb2RZb3RGMW5jd2hSR1k4MEtIVlBOQ2k2aFVXaUwwS0dZb1VXWW9VTVNpbGlFQm1DTFJaZ2hReklVUmVVS0l2OVZGb0Y0K0tCR1FJRVpVS0xxbEZvdW9VS0l1SlFvaVR4UlN6QkNobVVXaXpGQ2l4SlJRZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VCaVVEekZDaG1LSlF6b1VlWUlVTXc1cXBSaDNxaFI1aWlVZlVjaFI5VW9VT3FoUjlVSWhoNFFNUEhOQTgvcXFsSG1LRkRNaFF6b1VNd1FvOHdRb1pnaVVNUnpRR2IxUW84U2hRekZFb1ppaFI1aWhRem9VZlVQcWhRNm54UW9kVDRvVU9vVUtIVktGQVNubXFVZlZQTkVvZFU4MEtIV1BOQ2gxaWhSOVk4MEtIV2Q2SVVPczcwUW9kWjNvaFE2enZSQ2gxbmN3aFJkWTgwS0hXS0ZEcW5taFE2cDVvVU9xZWFGRjFTb3REcWxDaDFQaWhRNm54UW9kVDRvVVJlVUtHZENobUtGRm1LRkRNVUtHSlJhTE42b1VNUWdNd1Fvc3dSYUdZSVVNNkZETWhSWjhONkZEUDZvVVdjYzFGTHFOUUxxaEF1cWkwUmxLRkVYa29VTXhRb2k3bVVXaUxoeFFvWmdvdEZuUW9aaWhRekZDaXhLS0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VCaVVEekZFb1prS1BNaFF6QkNobjlWVW84L3FoUURpaFI1eU55SlI5UnlGRHF1UW8rcVVLSFdRbytxT0tKUTZvUVBxTlFIVUNCOVFjMERFbnFxVU0vcWlVT3A4RUtHZENqekZDaG1LRkRNVUtHZENoblFvWjBLR2RDaG5Rb1pnaFF6QkNobUNGRE1FS0dZSVVNd1FvWmdoUXpvVU02RkRPaFF6b1VNeUZETVVLR1lvVVdmRGVoUTZud1FvZFQ0SVVNL3FoUmRRYzFGb2RRYzBDNmdRTHFoQWRVSUYxVUtCbEtMUmRVb1VPb1VLSXZjVUtHWW9VV1lvdERONm9VV2IxUW9aZ290RE1FS0xNaFF6RkNoaVVVa0FnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnTVNnTVNnZVlvbERNVUtHWW9VTTZGSG1Rb1pnaFFEZ3FsRFA2b1VZZjZvVU0vcWhReitxRkRQNm9VTS9xaFJoNVJLR1lvVU01UW9kUnlGRHFPUW8rbzVDaDFDaFE2aFFvZFZ5RkRxdVFvZFZ5RkRxRkNoMUNoUmRSeUZEcU9Rb1ozSGVoUXpGQ2htS0ZBdUtGRm45VVdobjlVS0dmMVFvWi9WQ2htOVVLTFA2b1VNd1VXaG1DRkRNaFJaMEtHWW9VTXhRb1ppaFJZbEZHSlFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQXhLQXhLQXhLQXhLQXhLQXhLQXhLQXhLQXhLQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFmL1pcIlxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vYXNzZXRzL2ltZy9sb2FkaW5nTG9nby5qcGdcbi8vIG1vZHVsZSBpZCA9IDE1MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgc3VwcG9ydCA9IHtcbiAgc2VhcmNoUGFyYW1zOiAnVVJMU2VhcmNoUGFyYW1zJyBpbiBzZWxmLFxuICBpdGVyYWJsZTogJ1N5bWJvbCcgaW4gc2VsZiAmJiAnaXRlcmF0b3InIGluIFN5bWJvbCxcbiAgYmxvYjpcbiAgICAnRmlsZVJlYWRlcicgaW4gc2VsZiAmJlxuICAgICdCbG9iJyBpbiBzZWxmICYmXG4gICAgKGZ1bmN0aW9uKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbmV3IEJsb2IoKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9KSgpLFxuICBmb3JtRGF0YTogJ0Zvcm1EYXRhJyBpbiBzZWxmLFxuICBhcnJheUJ1ZmZlcjogJ0FycmF5QnVmZmVyJyBpbiBzZWxmXG59XG5cbmZ1bmN0aW9uIGlzRGF0YVZpZXcob2JqKSB7XG4gIHJldHVybiBvYmogJiYgRGF0YVZpZXcucHJvdG90eXBlLmlzUHJvdG90eXBlT2Yob2JqKVxufVxuXG5pZiAoc3VwcG9ydC5hcnJheUJ1ZmZlcikge1xuICB2YXIgdmlld0NsYXNzZXMgPSBbXG4gICAgJ1tvYmplY3QgSW50OEFycmF5XScsXG4gICAgJ1tvYmplY3QgVWludDhBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQ4Q2xhbXBlZEFycmF5XScsXG4gICAgJ1tvYmplY3QgSW50MTZBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQxNkFycmF5XScsXG4gICAgJ1tvYmplY3QgSW50MzJBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQzMkFycmF5XScsXG4gICAgJ1tvYmplY3QgRmxvYXQzMkFycmF5XScsXG4gICAgJ1tvYmplY3QgRmxvYXQ2NEFycmF5XSdcbiAgXVxuXG4gIHZhciBpc0FycmF5QnVmZmVyVmlldyA9XG4gICAgQXJyYXlCdWZmZXIuaXNWaWV3IHx8XG4gICAgZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIHZpZXdDbGFzc2VzLmluZGV4T2YoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikpID4gLTFcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZU5hbWUobmFtZSkge1xuICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgbmFtZSA9IFN0cmluZyhuYW1lKVxuICB9XG4gIGlmICgvW15hLXowLTlcXC0jJCUmJyorLl5fYHx+XS9pLnRlc3QobmFtZSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGNoYXJhY3RlciBpbiBoZWFkZXIgZmllbGQgbmFtZScpXG4gIH1cbiAgcmV0dXJuIG5hbWUudG9Mb3dlckNhc2UoKVxufVxuXG5mdW5jdGlvbiBub3JtYWxpemVWYWx1ZSh2YWx1ZSkge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHZhbHVlID0gU3RyaW5nKHZhbHVlKVxuICB9XG4gIHJldHVybiB2YWx1ZVxufVxuXG4vLyBCdWlsZCBhIGRlc3RydWN0aXZlIGl0ZXJhdG9yIGZvciB0aGUgdmFsdWUgbGlzdFxuZnVuY3Rpb24gaXRlcmF0b3JGb3IoaXRlbXMpIHtcbiAgdmFyIGl0ZXJhdG9yID0ge1xuICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHZhbHVlID0gaXRlbXMuc2hpZnQoKVxuICAgICAgcmV0dXJuIHtkb25lOiB2YWx1ZSA9PT0gdW5kZWZpbmVkLCB2YWx1ZTogdmFsdWV9XG4gICAgfVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgICBpdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXRlcmF0b3JcbiAgICB9XG4gIH1cblxuICByZXR1cm4gaXRlcmF0b3Jcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIEhlYWRlcnMoaGVhZGVycykge1xuICB0aGlzLm1hcCA9IHt9XG5cbiAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICB0aGlzLmFwcGVuZChuYW1lLCB2YWx1ZSlcbiAgICB9LCB0aGlzKVxuICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaGVhZGVycykpIHtcbiAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24oaGVhZGVyKSB7XG4gICAgICB0aGlzLmFwcGVuZChoZWFkZXJbMF0sIGhlYWRlclsxXSlcbiAgICB9LCB0aGlzKVxuICB9IGVsc2UgaWYgKGhlYWRlcnMpIHtcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHRoaXMuYXBwZW5kKG5hbWUsIGhlYWRlcnNbbmFtZV0pXG4gICAgfSwgdGhpcylcbiAgfVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICB2YWx1ZSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxuICB2YXIgb2xkVmFsdWUgPSB0aGlzLm1hcFtuYW1lXVxuICB0aGlzLm1hcFtuYW1lXSA9IG9sZFZhbHVlID8gb2xkVmFsdWUgKyAnLCAnICsgdmFsdWUgOiB2YWx1ZVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZVsnZGVsZXRlJ10gPSBmdW5jdGlvbihuYW1lKSB7XG4gIGRlbGV0ZSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihuYW1lKSB7XG4gIG5hbWUgPSBub3JtYWxpemVOYW1lKG5hbWUpXG4gIHJldHVybiB0aGlzLmhhcyhuYW1lKSA/IHRoaXMubWFwW25hbWVdIDogbnVsbFxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbihuYW1lKSB7XG4gIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24oY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgZm9yICh2YXIgbmFtZSBpbiB0aGlzLm1hcCkge1xuICAgIGlmICh0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCB0aGlzLm1hcFtuYW1lXSwgbmFtZSwgdGhpcylcbiAgICB9XG4gIH1cbn1cblxuSGVhZGVycy5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaXRlbXMgPSBbXVxuICB0aGlzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICBpdGVtcy5wdXNoKG5hbWUpXG4gIH0pXG4gIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbn1cblxuSGVhZGVycy5wcm90b3R5cGUudmFsdWVzID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpdGVtcyA9IFtdXG4gIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSkge1xuICAgIGl0ZW1zLnB1c2godmFsdWUpXG4gIH0pXG4gIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbn1cblxuSGVhZGVycy5wcm90b3R5cGUuZW50cmllcyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaXRlbXMgPSBbXVxuICB0aGlzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICBpdGVtcy5wdXNoKFtuYW1lLCB2YWx1ZV0pXG4gIH0pXG4gIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbn1cblxuaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgSGVhZGVycy5wcm90b3R5cGVbU3ltYm9sLml0ZXJhdG9yXSA9IEhlYWRlcnMucHJvdG90eXBlLmVudHJpZXNcbn1cblxuZnVuY3Rpb24gY29uc3VtZWQoYm9keSkge1xuICBpZiAoYm9keS5ib2R5VXNlZCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgVHlwZUVycm9yKCdBbHJlYWR5IHJlYWQnKSlcbiAgfVxuICBib2R5LmJvZHlVc2VkID0gdHJ1ZVxufVxuXG5mdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXNvbHZlKHJlYWRlci5yZXN1bHQpXG4gICAgfVxuICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICByZWplY3QocmVhZGVyLmVycm9yKVxuICAgIH1cbiAgfSlcbn1cblxuZnVuY3Rpb24gcmVhZEJsb2JBc0FycmF5QnVmZmVyKGJsb2IpIHtcbiAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoYmxvYilcbiAgcmV0dXJuIHByb21pc2Vcbn1cblxuZnVuY3Rpb24gcmVhZEJsb2JBc1RleHQoYmxvYikge1xuICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxuICB2YXIgcHJvbWlzZSA9IGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gIHJlYWRlci5yZWFkQXNUZXh0KGJsb2IpXG4gIHJldHVybiBwcm9taXNlXG59XG5cbmZ1bmN0aW9uIHJlYWRBcnJheUJ1ZmZlckFzVGV4dChidWYpIHtcbiAgdmFyIHZpZXcgPSBuZXcgVWludDhBcnJheShidWYpXG4gIHZhciBjaGFycyA9IG5ldyBBcnJheSh2aWV3Lmxlbmd0aClcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHZpZXcubGVuZ3RoOyBpKyspIHtcbiAgICBjaGFyc1tpXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUodmlld1tpXSlcbiAgfVxuICByZXR1cm4gY2hhcnMuam9pbignJylcbn1cblxuZnVuY3Rpb24gYnVmZmVyQ2xvbmUoYnVmKSB7XG4gIGlmIChidWYuc2xpY2UpIHtcbiAgICByZXR1cm4gYnVmLnNsaWNlKDApXG4gIH0gZWxzZSB7XG4gICAgdmFyIHZpZXcgPSBuZXcgVWludDhBcnJheShidWYuYnl0ZUxlbmd0aClcbiAgICB2aWV3LnNldChuZXcgVWludDhBcnJheShidWYpKVxuICAgIHJldHVybiB2aWV3LmJ1ZmZlclxuICB9XG59XG5cbmZ1bmN0aW9uIEJvZHkoKSB7XG4gIHRoaXMuYm9keVVzZWQgPSBmYWxzZVxuXG4gIHRoaXMuX2luaXRCb2R5ID0gZnVuY3Rpb24oYm9keSkge1xuICAgIHRoaXMuX2JvZHlJbml0ID0gYm9keVxuICAgIGlmICghYm9keSkge1xuICAgICAgdGhpcy5fYm9keVRleHQgPSAnJ1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYmxvYiAmJiBCbG9iLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICB0aGlzLl9ib2R5QmxvYiA9IGJvZHlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuZm9ybURhdGEgJiYgRm9ybURhdGEucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkpIHtcbiAgICAgIHRoaXMuX2JvZHlGb3JtRGF0YSA9IGJvZHlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5LnRvU3RyaW5nKClcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYXJyYXlCdWZmZXIgJiYgc3VwcG9ydC5ibG9iICYmIGlzRGF0YVZpZXcoYm9keSkpIHtcbiAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkuYnVmZmVyKVxuICAgICAgLy8gSUUgMTAtMTEgY2FuJ3QgaGFuZGxlIGEgRGF0YVZpZXcgYm9keS5cbiAgICAgIHRoaXMuX2JvZHlJbml0ID0gbmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pXG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIChBcnJheUJ1ZmZlci5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSB8fCBpc0FycmF5QnVmZmVyVmlldyhib2R5KSkpIHtcbiAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChib2R5KVxuICAgIH1cblxuICAgIGlmICghdGhpcy5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykpIHtcbiAgICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzLnNldCgnY29udGVudC10eXBlJywgJ3RleHQvcGxhaW47Y2hhcnNldD1VVEYtOCcpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlCbG9iICYmIHRoaXMuX2JvZHlCbG9iLnR5cGUpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzLnNldCgnY29udGVudC10eXBlJywgdGhpcy5fYm9keUJsb2IudHlwZSlcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5zZWFyY2hQYXJhbXMgJiYgVVJMU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCcpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuYmxvYikge1xuICAgIHRoaXMuYmxvYiA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUJsb2IpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKSlcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUZvcm1EYXRhKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyBibG9iJylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlUZXh0XSkpXG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5hcnJheUJ1ZmZlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICByZXR1cm4gY29uc3VtZWQodGhpcykgfHwgUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB0aGlzLnRleHQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKVxuICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICByZXR1cm4gcmVhZEJsb2JBc1RleHQodGhpcy5fYm9keUJsb2IpXG4gICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVhZEFycmF5QnVmZmVyQXNUZXh0KHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikpXG4gICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyB0ZXh0JylcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl9ib2R5VGV4dClcbiAgICB9XG4gIH1cblxuICBpZiAoc3VwcG9ydC5mb3JtRGF0YSkge1xuICAgIHRoaXMuZm9ybURhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKGRlY29kZSlcbiAgICB9XG4gIH1cblxuICB0aGlzLmpzb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihKU09OLnBhcnNlKVxuICB9XG5cbiAgcmV0dXJuIHRoaXNcbn1cblxuLy8gSFRUUCBtZXRob2RzIHdob3NlIGNhcGl0YWxpemF0aW9uIHNob3VsZCBiZSBub3JtYWxpemVkXG52YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXVxuXG5mdW5jdGlvbiBub3JtYWxpemVNZXRob2QobWV0aG9kKSB7XG4gIHZhciB1cGNhc2VkID0gbWV0aG9kLnRvVXBwZXJDYXNlKClcbiAgcmV0dXJuIG1ldGhvZHMuaW5kZXhPZih1cGNhc2VkKSA+IC0xID8gdXBjYXNlZCA6IG1ldGhvZFxufVxuXG5leHBvcnQgZnVuY3Rpb24gUmVxdWVzdChpbnB1dCwgb3B0aW9ucykge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuICB2YXIgYm9keSA9IG9wdGlvbnMuYm9keVxuXG4gIGlmIChpbnB1dCBpbnN0YW5jZW9mIFJlcXVlc3QpIHtcbiAgICBpZiAoaW5wdXQuYm9keVVzZWQpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpXG4gICAgfVxuICAgIHRoaXMudXJsID0gaW5wdXQudXJsXG4gICAgdGhpcy5jcmVkZW50aWFscyA9IGlucHV0LmNyZWRlbnRpYWxzXG4gICAgaWYgKCFvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKGlucHV0LmhlYWRlcnMpXG4gICAgfVxuICAgIHRoaXMubWV0aG9kID0gaW5wdXQubWV0aG9kXG4gICAgdGhpcy5tb2RlID0gaW5wdXQubW9kZVxuICAgIHRoaXMuc2lnbmFsID0gaW5wdXQuc2lnbmFsXG4gICAgaWYgKCFib2R5ICYmIGlucHV0Ll9ib2R5SW5pdCAhPSBudWxsKSB7XG4gICAgICBib2R5ID0gaW5wdXQuX2JvZHlJbml0XG4gICAgICBpbnB1dC5ib2R5VXNlZCA9IHRydWVcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhpcy51cmwgPSBTdHJpbmcoaW5wdXQpXG4gIH1cblxuICB0aGlzLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscyB8fCB0aGlzLmNyZWRlbnRpYWxzIHx8ICdzYW1lLW9yaWdpbidcbiAgaWYgKG9wdGlvbnMuaGVhZGVycyB8fCAhdGhpcy5oZWFkZXJzKSB7XG4gICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICB9XG4gIHRoaXMubWV0aG9kID0gbm9ybWFsaXplTWV0aG9kKG9wdGlvbnMubWV0aG9kIHx8IHRoaXMubWV0aG9kIHx8ICdHRVQnKVxuICB0aGlzLm1vZGUgPSBvcHRpb25zLm1vZGUgfHwgdGhpcy5tb2RlIHx8IG51bGxcbiAgdGhpcy5zaWduYWwgPSBvcHRpb25zLnNpZ25hbCB8fCB0aGlzLnNpZ25hbFxuICB0aGlzLnJlZmVycmVyID0gbnVsbFxuXG4gIGlmICgodGhpcy5tZXRob2QgPT09ICdHRVQnIHx8IHRoaXMubWV0aG9kID09PSAnSEVBRCcpICYmIGJvZHkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdCb2R5IG5vdCBhbGxvd2VkIGZvciBHRVQgb3IgSEVBRCByZXF1ZXN0cycpXG4gIH1cbiAgdGhpcy5faW5pdEJvZHkoYm9keSlcbn1cblxuUmVxdWVzdC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBSZXF1ZXN0KHRoaXMsIHtib2R5OiB0aGlzLl9ib2R5SW5pdH0pXG59XG5cbmZ1bmN0aW9uIGRlY29kZShib2R5KSB7XG4gIHZhciBmb3JtID0gbmV3IEZvcm1EYXRhKClcbiAgYm9keVxuICAgIC50cmltKClcbiAgICAuc3BsaXQoJyYnKVxuICAgIC5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoJz0nKVxuICAgICAgICB2YXIgbmFtZSA9IHNwbGl0LnNoaWZ0KCkucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgIGZvcm0uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChuYW1lKSwgZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKSlcbiAgICAgIH1cbiAgICB9KVxuICByZXR1cm4gZm9ybVxufVxuXG5mdW5jdGlvbiBwYXJzZUhlYWRlcnMocmF3SGVhZGVycykge1xuICB2YXIgaGVhZGVycyA9IG5ldyBIZWFkZXJzKClcbiAgLy8gUmVwbGFjZSBpbnN0YW5jZXMgb2YgXFxyXFxuIGFuZCBcXG4gZm9sbG93ZWQgYnkgYXQgbGVhc3Qgb25lIHNwYWNlIG9yIGhvcml6b250YWwgdGFiIHdpdGggYSBzcGFjZVxuICAvLyBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNzIzMCNzZWN0aW9uLTMuMlxuICB2YXIgcHJlUHJvY2Vzc2VkSGVhZGVycyA9IHJhd0hlYWRlcnMucmVwbGFjZSgvXFxyP1xcbltcXHQgXSsvZywgJyAnKVxuICBwcmVQcm9jZXNzZWRIZWFkZXJzLnNwbGl0KC9cXHI/XFxuLykuZm9yRWFjaChmdW5jdGlvbihsaW5lKSB7XG4gICAgdmFyIHBhcnRzID0gbGluZS5zcGxpdCgnOicpXG4gICAgdmFyIGtleSA9IHBhcnRzLnNoaWZ0KCkudHJpbSgpXG4gICAgaWYgKGtleSkge1xuICAgICAgdmFyIHZhbHVlID0gcGFydHMuam9pbignOicpLnRyaW0oKVxuICAgICAgaGVhZGVycy5hcHBlbmQoa2V5LCB2YWx1ZSlcbiAgICB9XG4gIH0pXG4gIHJldHVybiBoZWFkZXJzXG59XG5cbkJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuZXhwb3J0IGZ1bmN0aW9uIFJlc3BvbnNlKGJvZHlJbml0LCBvcHRpb25zKSB7XG4gIGlmICghb3B0aW9ucykge1xuICAgIG9wdGlvbnMgPSB7fVxuICB9XG5cbiAgdGhpcy50eXBlID0gJ2RlZmF1bHQnXG4gIHRoaXMuc3RhdHVzID0gb3B0aW9ucy5zdGF0dXMgPT09IHVuZGVmaW5lZCA/IDIwMCA6IG9wdGlvbnMuc3RhdHVzXG4gIHRoaXMub2sgPSB0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDBcbiAgdGhpcy5zdGF0dXNUZXh0ID0gJ3N0YXR1c1RleHQnIGluIG9wdGlvbnMgPyBvcHRpb25zLnN0YXR1c1RleHQgOiAnT0snXG4gIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycylcbiAgdGhpcy51cmwgPSBvcHRpb25zLnVybCB8fCAnJ1xuICB0aGlzLl9pbml0Qm9keShib2R5SW5pdClcbn1cblxuQm9keS5jYWxsKFJlc3BvbnNlLnByb3RvdHlwZSlcblxuUmVzcG9uc2UucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgUmVzcG9uc2UodGhpcy5fYm9keUluaXQsIHtcbiAgICBzdGF0dXM6IHRoaXMuc3RhdHVzLFxuICAgIHN0YXR1c1RleHQ6IHRoaXMuc3RhdHVzVGV4dCxcbiAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyh0aGlzLmhlYWRlcnMpLFxuICAgIHVybDogdGhpcy51cmxcbiAgfSlcbn1cblxuUmVzcG9uc2UuZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IDAsIHN0YXR1c1RleHQ6ICcnfSlcbiAgcmVzcG9uc2UudHlwZSA9ICdlcnJvcidcbiAgcmV0dXJuIHJlc3BvbnNlXG59XG5cbnZhciByZWRpcmVjdFN0YXR1c2VzID0gWzMwMSwgMzAyLCAzMDMsIDMwNywgMzA4XVxuXG5SZXNwb25zZS5yZWRpcmVjdCA9IGZ1bmN0aW9uKHVybCwgc3RhdHVzKSB7XG4gIGlmIChyZWRpcmVjdFN0YXR1c2VzLmluZGV4T2Yoc3RhdHVzKSA9PT0gLTEpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW52YWxpZCBzdGF0dXMgY29kZScpXG4gIH1cblxuICByZXR1cm4gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IHN0YXR1cywgaGVhZGVyczoge2xvY2F0aW9uOiB1cmx9fSlcbn1cblxuZXhwb3J0IHZhciBET01FeGNlcHRpb24gPSBzZWxmLkRPTUV4Y2VwdGlvblxudHJ5IHtcbiAgbmV3IERPTUV4Y2VwdGlvbigpXG59IGNhdGNoIChlcnIpIHtcbiAgRE9NRXhjZXB0aW9uID0gZnVuY3Rpb24obWVzc2FnZSwgbmFtZSkge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2VcbiAgICB0aGlzLm5hbWUgPSBuYW1lXG4gICAgdmFyIGVycm9yID0gRXJyb3IobWVzc2FnZSlcbiAgICB0aGlzLnN0YWNrID0gZXJyb3Iuc3RhY2tcbiAgfVxuICBET01FeGNlcHRpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpXG4gIERPTUV4Y2VwdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBET01FeGNlcHRpb25cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZldGNoKGlucHV0LCBpbml0KSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB2YXIgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KGlucHV0LCBpbml0KVxuXG4gICAgaWYgKHJlcXVlc3Quc2lnbmFsICYmIHJlcXVlc3Quc2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgIHJldHVybiByZWplY3QobmV3IERPTUV4Y2VwdGlvbignQWJvcnRlZCcsICdBYm9ydEVycm9yJykpXG4gICAgfVxuXG4gICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpXG5cbiAgICBmdW5jdGlvbiBhYm9ydFhocigpIHtcbiAgICAgIHhoci5hYm9ydCgpXG4gICAgfVxuXG4gICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIHN0YXR1czogeGhyLnN0YXR1cyxcbiAgICAgICAgc3RhdHVzVGV4dDogeGhyLnN0YXR1c1RleHQsXG4gICAgICAgIGhlYWRlcnM6IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwgJycpXG4gICAgICB9XG4gICAgICBvcHRpb25zLnVybCA9ICdyZXNwb25zZVVSTCcgaW4geGhyID8geGhyLnJlc3BvbnNlVVJMIDogb3B0aW9ucy5oZWFkZXJzLmdldCgnWC1SZXF1ZXN0LVVSTCcpXG4gICAgICB2YXIgYm9keSA9ICdyZXNwb25zZScgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dFxuICAgICAgcmVzb2x2ZShuZXcgUmVzcG9uc2UoYm9keSwgb3B0aW9ucykpXG4gICAgfVxuXG4gICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKCdOZXR3b3JrIHJlcXVlc3QgZmFpbGVkJykpXG4gICAgfVxuXG4gICAgeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSlcbiAgICB9XG5cbiAgICB4aHIub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmVqZWN0KG5ldyBET01FeGNlcHRpb24oJ0Fib3J0ZWQnLCAnQWJvcnRFcnJvcicpKVxuICAgIH1cblxuICAgIHhoci5vcGVuKHJlcXVlc3QubWV0aG9kLCByZXF1ZXN0LnVybCwgdHJ1ZSlcblxuICAgIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZScpIHtcbiAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlXG4gICAgfSBlbHNlIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnb21pdCcpIHtcbiAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSBmYWxzZVxuICAgIH1cblxuICAgIGlmICgncmVzcG9uc2VUeXBlJyBpbiB4aHIgJiYgc3VwcG9ydC5ibG9iKSB7XG4gICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InXG4gICAgfVxuXG4gICAgcmVxdWVzdC5oZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKVxuICAgIH0pXG5cbiAgICBpZiAocmVxdWVzdC5zaWduYWwpIHtcbiAgICAgIHJlcXVlc3Quc2lnbmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgYWJvcnRYaHIpXG5cbiAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gRE9ORSAoc3VjY2VzcyBvciBmYWlsdXJlKVxuICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICByZXF1ZXN0LnNpZ25hbC5yZW1vdmVFdmVudExpc3RlbmVyKCdhYm9ydCcsIGFib3J0WGhyKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgeGhyLnNlbmQodHlwZW9mIHJlcXVlc3QuX2JvZHlJbml0ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiByZXF1ZXN0Ll9ib2R5SW5pdClcbiAgfSlcbn1cblxuZmV0Y2gucG9seWZpbGwgPSB0cnVlXG5cbmlmICghc2VsZi5mZXRjaCkge1xuICBzZWxmLmZldGNoID0gZmV0Y2hcbiAgc2VsZi5IZWFkZXJzID0gSGVhZGVyc1xuICBzZWxmLlJlcXVlc3QgPSBSZXF1ZXN0XG4gIHNlbGYuUmVzcG9uc2UgPSBSZXNwb25zZVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3doYXR3Zy1mZXRjaC9mZXRjaC5qc1xuLy8gbW9kdWxlIGlkID0gMTUxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=